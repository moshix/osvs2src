         TITLE 'IKJEE100 - OPERATOR COMMAND PROCESSOR                  *00001000
                        '                                               00002000
         TITLE 'IKJEE100 - OPERATOR COMMAND PROCESSOR'                  00003000
         EJECT                                                          00004000
IKJEE100 CSECT ,                                                   0003 00005000
@MAINENT DS    0H                                                  0003 00006000
         USING *,@15                                               0003 00007000
         B     @PROLOG                                             0003 00008000
         DC    AL1(16)                                             0003 00009000
         DC    C'IKJEE100  75.350'                                 0003 00010000
         DROP  @15                                                      00011000
@PROLOG  ST    @14,12(,@13)                                        0003 00012000
         STM   @00,@12,20(@13)                                     0003 00013000
         BALR  @08,0                                               0003 00014000
@PSTART  LA    @11,4095(,@08)                                      0003 00015000
         USING @PSTART,@08                                         0003 00016000
         USING @PSTART+4095,@11                                    0003 00017000
         L     @00,@SIZDATD                                        0003 00018000
         GETMAIN  R,LV=(0)                                              00019000
         LR    @12,@01                                             0003 00020000
         USING @DATD,@12                                           0003 00021000
         ST    @13,@SA00001+4                                      0003 00022000
         LM    @00,@01,20(@13)                                     0003 00023000
         ST    @12,8(,@13)                                         0003 00024000
         LR    @13,@12                                             0003 00025000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00026000
         MVC   @PC00001(4),0(@01)                                  0003 00027000
         EJECT                                                          00028000
         EJECT                                                          00029000
         EJECT                                                          00030000
         EJECT                                                          00031000
         EJECT                                                          00032000
         EJECT                                                          00033000
         EJECT                                                          00034000
         EJECT                                                          00035000
         EJECT                                                          00036000
*   SAVECPPL=R1;                    /* SAVE PARAMETER ADDR           */ 00037000
         ST    R1,SAVECPPL                                         0179 00038000
*   RESPECIFY                                                      0180 00039000
*    (R1) UNRSTD;                   /* FREE REG FOR COMPILER USAGE   */ 00040000
*   EXITERR='0'B;                   /* INITIALIZE THE EXIT ERROR FLG */ 00041000
*                                                                  0181 00042000
         NI    EXITERR,B'11011111'                                 0181 00043000
*   /*****************************************************************/ 00044000
*   /*                                                               */ 00045000
*   /* THE SERVICE ROUTINES - PUTLINE, GETLINE, STACK AND PTGET ARE  */ 00046000
*   /* LOADED. THE STACK AND GETLINE SERVICE ROUTINES ARE USED ONLY  */ 00047000
*   /* BY THE ATTENTION EXIT ROUTINE, IKJEE150. THE ENTRY POINT      */ 00048000
*   /* ADDRESSES ARE PASSED TO THE EXIT ROUTINE FOR ITS USE ALL ENTRY*/ 00049000
*   /* POINT ADDRESSES OF THE SERVICE ROUTINES ARE SAVED IN THE      */ 00050000
*   /* OPERATOR'S WORKAREA AND USED FOR BRANCHING DIRECTLY TO THE    */ 00051000
*   /* ROUTINE.                                                      */ 00052000
*   /*                                                               */ 00053000
*   /*****************************************************************/ 00054000
*                                                                  0182 00055000
*   RESPECIFY                                                      0182 00056000
*    (R0) RESTRICTED;               /* RESTRICT USAGE ACROSS MACROS  */ 00057000
*   GEN(LOAD EP=IKJPTGT);           /* LOAD PUTGET SERVICE ROUTINE   */ 00058000
         LOAD EP=IKJPTGT                                                00059000
*   WORK2=R0;                       /* SAVE ENTRY POINT OF PUTGET SR */ 00060000
         ST    R0,WORK2                                            0184 00061000
*   GEN(LOAD EP=IKJPUTL);           /* LOAD PUTLINE SERVICE ROUTINE  */ 00062000
         LOAD EP=IKJPUTL                                                00063000
*   WORK6=R0;                       /* SAVE ENTRY POINT PF PUTLINE SR*/ 00064000
         ST    R0,WORK6                                            0186 00065000
*   GEN(LOAD EP=IKJSTCK);           /* LOAD STACK SERVICE ROUTINE    */ 00066000
         LOAD EP=IKJSTCK                                                00067000
*   PTRSTACK=R0;                    /* SAVE ENTRY PNT OF STACK SR    */ 00068000
         ST    R0,PTRSTACK                                         0188 00069000
*   GEN(LOAD EP=IKJGETL);           /* LOAD GETLINE SERVICE ROUTINE  */ 00070000
         LOAD EP=IKJGETL                                                00071000
*   GETLPTR=R0;                     /* SAVE ENTRY PNT OF GETLINE SR  */ 00072000
         ST    R0,GETLPTR                                          0190 00073000
*   RESPECIFY                                                      0191 00074000
*    (R0) UNRSTD;                   /* FREE FOR COMPILER USAGE       */ 00075000
*                                                                  0191 00076000
*   /*****************************************************************/ 00077000
*   /*                                                               */ 00078000
*   /* INITIALIZATION OF FIBPARMS PARAMETER LIST                     */ 00079000
*   /*                                                               */ 00080000
*   /*****************************************************************/ 00081000
*                                                                  0192 00082000
*   FIBMAINP=ADDR(FIBPARMS);        /* PICK UP THE ADDRESS OF SVC  0192 00083000
*                                      LIST                          */ 00084000
         LA    @10,FIBPARMS                                        0192 00085000
         ST    @10,FIBMAINP                                        0192 00086000
*   FIBPARMS=FIBPARMS&&FIBPARMS;    /* CLEAR THE LIST                */ 00087000
         XC    FIBPARMS(32),FIBPARMS                               0193 00088000
*   FIBCPPL=SAVECPPL;               /* INITIALIZE PARAMETER LIST TO     00089000
*                                      SVC 100 WITH ADDR OF CPPL     */ 00090000
         MVC   FIBCPPL(4),SAVECPPL                                 0194 00091000
*   FIBID=FIBOPER;                  /* CODE FOR OPERATOR CALL TO SVC */ 00092000
         MVC   FIBID(2),@CH01132                                   0195 00093000
*   FIBUSER=ADDR(CALLPARM);         /* ADDRESS OF OPERATOR EXTENSION */ 00094000
         LA    @10,CALLPARM                                        0196 00095000
         ST    @10,FIBUSER                                         0196 00096000
*   CALLPARM=CALLPARM&&CALLPARM;    /* CLEAR THE EXTENSION LIST      */ 00097000
         XC    CALLPARM(24),CALLPARM                               0197 00098000
*   FIBHIGH='1'B;                   /* END OF THE PARMAMETER LIST    */ 00099000
         OI    FIBHIGH,B'10000000'                                 0198 00100000
*   FIBLEN=LENGTH(CALLPARM);        /* CALCULATE LENGTH OF EXTENSION */ 00101000
         MVC   FIBLEN(2),@CH00041                                  0199 00102000
*   RECURSON=ZEROS;                 /* RESET THE STAE RECURSION CNTR */ 00103000
         MVC   RECURSON(2),ZEROS+2                                 0200 00104000
*   GEN(EJECT);                                                    0201 00105000
*                                                                  0201 00106000
         EJECT                                                          00107000
*   /*****************************************************************/ 00108000
*   /*                                                               */ 00109000
*   /* INITIALIZE MULTI-LEVEL MESSAGE CHAIN FOR LATER USE BY PUTGET  */ 00110000
*   /* AND PUTLINE SERVICE ROUTINES                                  */ 00111000
*   /*                                                               */ 00112000
*   /*****************************************************************/ 00113000
*                                                                  0202 00114000
*BEGNAGAN:                                                         0202 00115000
*   IOPLUPT=CPPLUPT;                /* INITIALIZE SERVICE RTNS       */ 00116000
BEGNAGAN LA    @10,SRPARM                                          0202 00117000
         L     @09,SAVECPPL                                        0202 00118000
         MVC   IOPLUPT(4,@10),CPPLUPT(@09)                         0202 00119000
*   IOPLECT=CPPLECT;                /* PARAMETERS                    */ 00120000
         MVC   IOPLECT(4,@10),CPPLECT(@09)                         0203 00121000
*   IOPLECB=ADDR(CPECB);            /* ADDR OF CP'S ECB              */ 00122000
         LA    @07,CPECB                                           0204 00123000
         ST    @07,IOPLECB(,@10)                                   0204 00124000
*   NXTLVMSG=ADDR(ENDCHAIN);        /* CHAIN 1ST AND 2ND LEVEL MSGS  */ 00125000
         LA    @10,ENDCHAIN                                        0205 00126000
         ST    @10,NXTLVMSG                                        0205 00127000
*   ENDCHAIN=LASTLVL;               /* SET END OF CHAIN INDICATOR    */ 00128000
         MVC   ENDCHAIN(4),LASTLVL                                 0206 00129000
*   NOMSGSG1=ONE;                   /* ONE MESSAGE SEGMENT FOR 1ST 0207 00130000
*                                      LEV                           */ 00131000
         MVC   @TF00001(4),ONE                                     0207 00132000
         L     @10,@TF00001                                        0207 00133000
         ST    @10,NOMSGSG1                                        0207 00134000
*   NOMSGSG2=ONE;                   /* 1 MSG SEG FOR 2ND LEVEL MSG   */ 00135000
         ST    @10,NOMSGSG2                                        0208 00136000
*   MSGSEG1=ADDR(BUFR1);            /* POINT TO FIRST LEVEL TEXT     */ 00137000
         LA    @10,BUFR1                                           0209 00138000
         ST    @10,MSGSEG1                                         0209 00139000
*   MSGSEG2=ADDR(BUFR2);            /* POINT TO SECOND LEVEL TEXT    */ 00140000
         LA    @10,BUFR2                                           0210 00141000
         ST    @10,MSGSEG2                                         0210 00142000
*   NOMSG='0'B;                     /* CLEAR FLAG                    */ 00143000
         NI    NOMSG,B'10111111'                                   0211 00144000
*   TERMID=ZEROS;                   /* CLEAR ASID FIELD IN PARMLIST     00145000
*                                      TO SVC 100                    */ 00146000
*                                                                  0212 00147000
         L     @10,ZEROS                                           0212 00148000
         STH   @10,TERMID                                          0212 00149000
*   /*****************************************************************/ 00150000
*   /*                                                               */ 00151000
*   /* THE PARAMETER LIST FOR THE ATTENTION AND STAE/STAI EXIT       */ 00152000
*   /* ROUTINES IS INITIALIZED STAE RETRY ROUTINE USES THIS CODE WHEN*/ 00153000
*   /* OPERATOR OR ONE OF ITS SUBCOMMANDS HAS ABENDED TO REINITIALIZE*/ 00154000
*   /* ALL PARAMETER BLOCKS AND ESTABLISH ANOTHER STAE ENVIRONMENT   */ 00155000
*   /*                                                               */ 00156000
*   /*****************************************************************/ 00157000
*                                                                  0213 00158000
*   CSOAPTR=ADDR(CMDSCAN);          /* ADDR OF CMDSCAN OUTPUT AREA   */ 00159000
         LA    @15,CMDSCAN                                         0213 00160000
         ST    @15,CSOAPTR                                         0213 00161000
*   PTRCPPL=SAVECPPL;               /* ADDR OF CPPL                  */ 00162000
         ST    @09,PTRCPPL                                         0214 00163000
*   PTRCPECB=ADDR(CPECB);           /* ADDR OF CP ECB                */ 00164000
         ST    @07,PTRCPECB                                        0215 00165000
*   CPECB=ZEROS;                    /* CLEAR CP'S ECB                */ 00166000
         ST    @10,CPECB                                           0216 00167000
*   PTRPUTL=WORK6;                  /* ADDR OF PUTLINE SR            */ 00168000
         MVC   PTRPUTL(4),WORK6                                    0217 00169000
*   PTRGETL=GETLPTR;                /* ADDR OF GETLINE SR            */ 00170000
         MVC   PTRGETL(4),GETLPTR                                  0218 00171000
*   STAEAREA=ADDR(STAEWORK);        /* ADDR OF STAE EXIT RTN W/A     */ 00172000
         LA    @09,STAEWORK                                        0219 00173000
         ST    @09,STAEAREA                                        0219 00174000
*   ATTNAREA=ADDR(ATTNWORK);        /* ADDR OF ATTN EXIT RTN W/A     */ 00175000
         LA    @09,ATTNWORK                                        0220 00176000
         ST    @09,ATTNAREA                                        0220 00177000
*   ATTNSAVE=ADDR(ATTNSA);          /* ADDR OF ATTN EXIT REGSAVE     */ 00178000
         LA    @09,ATTNSA                                          0221 00179000
         ST    @09,ATTNSAVE                                        0221 00180000
*   STAESAVE=ADDR(STAESA);          /* ADDR OF STAE EXIT REGSAVE     */ 00181000
         LA    @09,STAESA                                          0222 00182000
         ST    @09,STAESAVE                                        0222 00183000
*   EXITFLAG=ZEROS;                 /* CLEAR FLAGS                   */ 00184000
         STC   @10,EXITFLAG                                        0223 00185000
*   REGISTR8=R8;                    /* SAVE DATA BASE                */ 00186000
         ST    R8,REGISTR8                                         0224 00187000
*   RESPECIFY                                                      0225 00188000
*    (R11) RSTD;                    /* RESTRICT REGISTER USAGE       */ 00189000
*   BASE100=R11;                    /* SAVE BASE REG                 */ 00190000
         ST    R11,BASE100                                         0226 00191000
*   RESPECIFY                                                      0227 00192000
*    (R11) UNRSTD;                  /* FREE FOR THE COMPILER         */ 00193000
*   ATCHECB=ZEROS;                  /* ZERO OUT ATTACH HELP ECB      */ 00194000
         ST    @10,ATCHECB                                         0228 00195000
*   ATTACHCB=ADDR(ATCHECB);         /* POINT TO HELP ECB FOR ATTN    */ 00196000
         LA    @09,ATCHECB                                         0229 00197000
         ST    @09,ATTACHCB                                        0229 00198000
*   RESPECIFY                                                      0230 00199000
*    (R13) RSTD;                    /* RESTRICT REGISTER USAGE       */ 00200000
*   SAVE13=R13;                     /* SAVE REGISTER FOR LATER STAE     00201000
*                                      RETRY ROUTINE                 */ 00202000
         ST    R13,SAVE13                                          0231 00203000
*   RESPECIFY                                                      0232 00204000
*    (R13) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 00205000
*   RESPECIFY                                                      0233 00206000
*    (R12) RSTD;                    /* RESTRICT REGISTER USAGE       */ 00207000
*   WORKADDR=R12;                   /* ESTABLISH WORKAREA ADDRESSING    00208000
*                                      FOR STAE ROUTINE              */ 00209000
         ST    R12,WORKADDR                                        0234 00210000
*   RESPECIFY                                                      0235 00211000
*    (R12) UNRSTD;                  /* FREE REGISTER FOR COMPILER    */ 00212000
*   ATTNBUFF=ZEROS;                 /* INDICATE THAT NO BUFFERS HAVE    00213000
*                                      BEEN GOTTEN FOR ATTENTION YET */ 00214000
         ST    @10,ATTNBUFF                                        0236 00215000
*   BUFFPTR=ZEROS;                  /* INITIALIZE BUFFPTR TO ZERO AS    00216000
*                                      THERE ARE NO BUFFERS GOTTEN 0237 00217000
*                                      YET                           */ 00218000
*                                                                  0237 00219000
         ST    @10,BUFFPTR                                         0237 00220000
*   /*****************************************************************/ 00221000
*   /*                                                               */ 00222000
*   /* A STAE ENVIRONMENT IS CREATED FOR THE OPERATOR CP AND ITS     */ 00223000
*   /* SUBCOMMANDS. THE STAE EXIT ROUTINE IS IKJEE1A0 AND THE ADDRESS*/ 00224000
*   /* OF EXITPARM IS PASSED AS A PARAMETER TO THE STAE EXIT ROUTINE.*/ 00225000
*   /* THE STAE IS REQUESTED ACROSS XCTL'S TO PROTECT SVC 100        */ 00226000
*   /*                                                               */ 00227000
*   /*****************************************************************/ 00228000
*                                                                  0238 00229000
*   STAELIST=STAELST;               /* MOVE STAE PARAMETER LIST TO 0238 00230000
*                                      WORKAREA                      */ 00231000
         MVI   STAELIST+12,C' '                                    0238 00232000
         MVC   STAELIST+13(7),STAELIST+12                          0238 00233000
         MVC   STAELIST(12),STAELST                                0238 00234000
*   R5=ADDR(EXITPARM);              /* POINT TO EXIT PARM LIST       */ 00235000
         LA    R5,EXITPARM                                         0239 00236000
*   GEN;                                                           0240 00237000
     STAE  XCTL=YES,PARAM=(5),MF=(E,STAELIST)                           00238000
*   RESPECIFY                                                      0241 00239000
*    (R15) RSTD;                    /* RESTRICT REGISTER USAGE       */ 00240000
*   IF R15^=ZEROS                   /* IF A STAE ENVIRONMENT COULD 0242 00241000
*                                      NOT                           */ 00242000
*     THEN                          /* BE CREATED, THEN SET UP INPUT */ 00243000
         C     R15,ZEROS                                           0242 00244000
         BE    @RF00242                                            0242 00245000
*     DO;                           /* FOR MESSAGE RTN TO ISSUE ERROR   00246000
*                                      MSG AND RETURN TO THE TMP     */ 00247000
*       R6=R15;                     /* SAVE RETURN CODE IN R6        */ 00248000
         LR    R6,R15                                              0244 00249000
*       RESPECIFY                                                  0245 00250000
*        (R15) UNRSTD;              /* FREE REG FOR COMPILER         */ 00251000
*       MSGSEG2B=ADDR(STAESEG);     /* INITIALIZE PUTLINE PARM LIST  */ 00252000
         LA    @10,STAESEG                                         0246 00253000
         ST    @10,MSGSEG2B                                        0246 00254000
*       GO TO MSGRTN4;              /* GO PUT OUT MSG & RETURN TO TMP*/ 00255000
         B     MSGRTN4                                             0247 00256000
*     END;                                                         0248 00257000
*   GEN(EJECT);                                                    0249 00258000
*                                                                  0249 00259000
@RF00242 DS    0H                                                  0249 00260000
         EJECT                                                          00261000
*   /*****************************************************************/ 00262000
*   /*                                                               */ 00263000
*   /* THE FOLLOWING SCHEDULES AN ATTENTION EXIT ROUTINE TO BE GIVEN */ 00264000
*   /* CONTROL WHEN THE USER PRESSES THE ATTENTION KEY WHILE IN      */ 00265000
*   /* OPERATOR MODE. THE ATTENTION EXIT ROUTINE FOR OPERATOR IS     */ 00266000
*   /* IKJEE150. THE ADDRESS OF THE WORK AREA IS PASSED AS A         */ 00267000
*   /* PARAMETER TO THE EXIT ROUTINE. A MODE MESSAGE IS SPECIFIED TO */ 00268000
*   /* BE PUT TO THE TERMINAL WHEN AN ATTENTION INTERRUPT OCCURS TO  */ 00269000
*   /* IDENTIFY THE MODULE IN CONTROL. IT ALSO SPECIFIES A REQUEST TO*/ 00270000
*   /* GET THE NEXT LINE OF INPUT FROM THE TERMINAL. ALL TERMINAL    */ 00271000
*   /* INPUT AND OUTPUT BUFFERS ARE RELEASED AND ANY PREVIOUS STAX   */ 00272000
*   /* FOR THIS TASK WILL BE SUPERSEDED.                             */ 00273000
*   /*                                                               */ 00274000
*   /*****************************************************************/ 00275000
*                                                                  0250 00276000
*   STAXAREA=STAXL;                 /* MOVE STAX PARMS TO DYNAMIC  0250 00277000
*                                      STORAGE                       */ 00278000
         MVC   STAXAREA(20),STAXL                                  0250 00279000
*   MODESEG(1:4)=ATTNMSG;           /* INITIALIZE MSG ISSUED WHEN    */ 00280000
         MVC   MODESEG(4),ATTNMSG                                  0251 00281000
*   MODETEXT(1:8)=ECTPCMD;          /* ATTENTION IS ENTERED, COMMAND    00282000
*                                      NAME IS TAKEN FROM ECT        */ 00283000
         L     @10,SAVECPPL                                        0252 00284000
         L     @10,ECTPTR(,@10)                                    0252 00285000
         MVC   MODETEXT(8),ECTPCMD(@10)                            0252 00286000
*   RFY                                                            0253 00287000
*    (R1,                                                          0253 00288000
*     R3,                                                          0253 00289000
*     R4,                                                          0253 00290000
*     R5,                                                          0253 00291000
*     R7,                                                          0253 00292000
*     R9) RSTD;                     /* RESTRICT REGISTERS FOR MY USE */ 00293000
*   RFY                                                            0254 00294000
*    (R6) RSTD;                     /* RESTRICT REGISTERS FOR MY USE */ 00295000
*   R7=ADDR(IKJEE150);              /* ADDRESS OF ATTENTION EXIT     */ 00296000
         L     R7,@CA00383                                         0255 00297000
*   R5=ADDR(MODETEXT);              /* ADDRESS OF OUTPUT MSG         */ 00298000
         LA    R5,MODETEXT                                         0256 00299000
*   R6=ADDR(EXITPARM);              /* ADDRESS OF WORKAREA           */ 00300000
         LA    R6,EXITPARM                                         0257 00301000
*   R4=ADDR(AXTEXT);                /* BUFFER ADDRESS FOR INPUT LINE */ 00302000
         LA    R4,AXTEXT                                           0258 00303000
*   R1=ADDR(STAXAREA);              /* ADDR OF PARMLIST              */ 00304000
         LA    R1,STAXAREA                                         0259 00305000
*   R3=EIGHT;                       /* VALUE OF EIGHT                */ 00306000
         LA    R3,8                                                0260 00307000
*   R9=BUFLEN;                      /* BUFFER LENGTH                 */ 00308000
         LA    R9,132                                              0261 00309000
*   GEN;                                                           0262 00310000
     STAX  (7),OBUF=((5),(3)),IBUF=((4),(9)),USADDR=(6),MF=(E,(1))      00311000
*   RFY                                                            0263 00312000
*    (R1,                                                          0263 00313000
*     R3,                                                          0263 00314000
*     R4,                                                          0263 00315000
*     R5,                                                          0263 00316000
*     R7,                                                          0263 00317000
*     R9) UNRSTD;                   /* FREE REGISTERS FOR COMPILER   */ 00318000
*                                                                  0264 00319000
*   /*****************************************************************/ 00320000
*   /*                                                               */ 00321000
*   /* . IF THERE ARE OPERANDS ON THE OPER CMD, TELL THE USER THEY   */ 00322000
*   /* ARE NOT ALLOWED . PREPARE PARAMETER LIST FOR SVC 100 TO TEST  */ 00323000
*   /* FOR OPERATOR ABILITY FOR USER . ISSUE SVC 100 . CHECK RETURN  */ 00324000
*   /* CODES FROM SVC 100 - 00 - TERMINAL USER HAS OPERATOR ABILITY  */ 00325000
*   /* 80 - TERMINAL USER DOES NOT HAVE OPERATOR ABILITY             */ 00326000
*   /*                                                               */ 00327000
*   /*****************************************************************/ 00328000
*                                                                  0264 00329000
*   IF ECTNOPD^='1'B                /* OPER CMD HAS NO OPERANDS      */ 00330000
*     THEN                                                         0264 00331000
         L     @10,SAVECPPL                                        0264 00332000
         L     @10,ECTPTR(,@10)                                    0264 00333000
         TM    ECTNOPD(@10),B'10000000'                            0264 00334000
         BNO   @RT00264                                            0264 00335000
*     GO TO MSGRTN1;                /* OPERANDS EXIST ON OPERATOR CMD*/ 00336000
*TESTABIL:                                                         0266 00337000
*   CALL CLEAR;                     /* CLEAR INPUT AND OUTPUT BUFFERS*/ 00338000
TESTABIL BAL   @14,CLEAR                                           0266 00339000
*   AUTHCHK='1'B;                   /* FLAG INDICATES TO ONLY TEST 0267 00340000
*                                      OPERATOR ABILITY              */ 00341000
*   CMDCHK='0'B;                    /* RESET CMD CHECK FLAG TO ZERO  */ 00342000
*   OFFGETBF='0'B;                  /* RESET BUFFER FLAG TO ZERO     */ 00343000
         OI    AUTHCHK,B'10000000'                                 0269 00344000
         NI    CMDCHK,B'10101111'                                  0269 00345000
*   RESPECIFY                                                      0270 00346000
*    (R1,                                                          0270 00347000
*     R15) RSTD;                    /* RESTRICT REGS ACROSS SVC      */ 00348000
*   R1=ADDR(FIBMAINP);              /* POINT TO PARM LIST TO SVC 100 */ 00349000
         LA    R1,FIBMAINP                                         0271 00350000
*   SVC(100);                       /* SVC FOR FIB, PROF AND OPER TSO   00351000
*                                      COMMANDS....IKJEFFS0 PL/S   0272 00352000
*                                      MACRO                         */ 00353000
         SVC   100                                                 0272 00354000
*   IF R15^=FIBOKRC                 /* TERMINAL USER HAVE OPERATOR-  */ 00355000
*     THEN                          /* ABILITY, CONTINUE PROCESSING  */ 00356000
         LTR   R15,R15                                             0273 00357000
         BNZ   @RT00273                                            0273 00358000
*     GO TO MSGRTN2;                /* OTHERWISE, GO TO MSGRTN2      */ 00359000
*   RESPECIFY                                                      0275 00360000
*    (R1,                                                          0275 00361000
*     R15) UNRSTD;                  /* FREE REGS FOR COMPILER USAGE  */ 00362000
*   GEN(EJECT);                                                    0276 00363000
*                                                                  0276 00364000
         EJECT                                                          00365000
*   /*****************************************************************/ 00366000
*   /*                                                               */ 00367000
*   /* SET UP PARAMETERS FOR MESSAGE ROUTINE: ISSUE MODE MESSAGE     */ 00368000
*   /* THROUGH PUT/GET PREPARE TO RECEIVE COMMAND FROM USER MODE     */ 00369000
*   /* MESSAGE = OPERATOR OR OPER MESSAGE ROUTINE = PUT/GET          */ 00370000
*   /*                                                               */ 00371000
*   /*****************************************************************/ 00372000
*                                                                  0277 00373000
*   CALL CLEAR;                     /* CLEAR INPUT/OUTPUT BUFFERS    */ 00374000
         BAL   @14,CLEAR                                           0277 00375000
*   LNGBUF1=LNGMSG2A;               /* INITIALIZE LENGTH OF MODE MSG */ 00376000
         MVC   LNGBUF1(2),LNGMSG2A                                 0278 00377000
*   OUTBUFF1(1)=BLANK;              /* NO MESSAGE IDENTIFIER         */ 00378000
         MVC   OUTBUFF1(1),BLANK                                   0279 00379000
*   OUTBUFF1(2:9)=ECTPCMD;          /* PUT CMD NAME IN BUFFER        */ 00380000
         L     @10,SAVECPPL                                        0280 00381000
         L     @10,ECTPTR(,@10)                                    0280 00382000
         MVC   OUTBUFF1+1(8),ECTPCMD(@10)                          0280 00383000
*   GO TO SCAN;                     /* GO TO CALL COMMAND SCAN TO  0281 00384000
*                                      LINE OF INPUT RECEIVED        */ 00385000
         B     SCAN                                                0281 00386000
*OPERABIL:                                                         0282 00387000
*                                                                  0282 00388000
*/*                                                                0282 00389000
*    THE MODE MESSAGE OPERATOR IS ONLY PUT TO THE TERMINAL WHEN    0282 00390000
*    OPERATOR MODE IS FIRST ENTERED, AFTER AN ATTENTION HAS BEEN   0282 00391000
*    ENTERED, OR OPERATOR OR ONE OF ITS SUBCOMMANDS HAS ABENDED.   0282 00392000
*    ON ALL OTHER CALLS TO PUTGET, A ZERO ADDRESS IS PASSED        0282 00393000
*    INDICATING NOT TO PUT OUT A MODE MESSAGE BUT GET ANOTHER      0282 00394000
*    LINE OF INPUT.                                                0282 00395000
*                                                                    */ 00396000
*                                                                  0282 00397000
*   NOMSG='1'B;                     /* INDICATE NO MSG TO PUT OUT    */ 00398000
OPERABIL OI    NOMSG,B'01000000'                                   0282 00399000
*   GEN(EJECT);                                                    0283 00400000
*                                                                  0283 00401000
         EJECT                                                          00402000
*   /*****************************************************************/ 00403000
*   /*                                                               */ 00404000
*   /* . BRANCH TO PUTGET ROUTINE TO ISSUE MODE MESSAGE IF NECESSARY,*/ 00405000
*   /* AND GET A LINE OF INPUT FROM THE TERMINAL . BRANCH TO COMMAND */ 00406000
*   /* SCAN ROUTINE TO LOCATE THE COMMAND IN THE COMMAND BUFFER .    */ 00407000
*   /* TEST COMMAND SCAN FLAGS TO DETERMINE THE INPUT RECEIVED FROM  */ 00408000
*   /* THE USER                                                      */ 00409000
*   /*                                                               */ 00410000
*   /*****************************************************************/ 00411000
*                                                                  0284 00412000
*SCAN:                                                             0284 00413000
*   RECURSON=ZEROS;                 /* RESET THE STAE RECURSION CNTR */ 00414000
SCAN     MVC   RECURSON(2),ZEROS+2                                 0284 00415000
*   CALL PUTGTRTN;                  /* GO TO PUTGET SUBRTN TO PUT  0285 00416000
*                                      MODE MSG TO TERMINAL IF     0285 00417000
*                                      INDICATED AND GET A LINE OF 0285 00418000
*                                      INPUT                         */ 00419000
         BAL   @14,PUTGTRTN                                        0285 00420000
*   SYNCHK='1'B;                    /* FLAG IN CMD SCAN PARMLST IN-     00421000
*                                      INDICATING NOT TO SYNTAX CHECK   00422000
*                                      COMMAND NAME                  */ 00423000
         OI    SYNCHK,B'10000000'                                  0286 00424000
*   CSPLFLG=ADDR(FLAGWORD);         /* PTR TO CMDSCAN FLAGWORD       */ 00425000
         LA    @10,SRPARM                                          0287 00426000
         LA    @09,FLAGWORD                                        0287 00427000
         ST    @09,CSPLFLG(,@10)                                   0287 00428000
*   CSPLCBUF=ADDR(CMDBUFFR);        /* PTR TO COMMAND BUFFER         */ 00429000
         MVC   CSPLCBUF(4,@10),WORK7                               0288 00430000
*   CSPLOA=CSOAPTR;                 /* PTR TO CMDSCAN OUTPUT AREA    */ 00431000
         MVC   CSPLOA(4,@10),CSOAPTR                               0289 00432000
*   RESPECIFY                                                      0290 00433000
*    (R1,                                                          0290 00434000
*     R15) RSTD;                    /* RESTRICT REGISTER USAGE       */ 00435000
*   R1=ADDR(SRPARM);                /* ADDR OF CMDSCAN PARMS         */ 00436000
         LR    R1,@10                                              0291 00437000
*   GEN REFS(R1);                                                  0292 00438000
     LINK EP=IKJSCAN               LINK TO COMMAND SCAN SERVICE ROUTINE 00439000
*   RESPECIFY                                                      0293 00440000
*    (R1) UNRSTD;                   /* FREE FOR COMPILER USAGE       */ 00441000
*   IF R15^=ZEROS                   /* TEST FOR INVALID PARAMETERS 0294 00442000
*                                      FROM COMMAND SCAN             */ 00443000
*     THEN                          /* IF ERROR, SAVE RETURN CODE    */ 00444000
         C     R15,ZEROS                                           0294 00445000
         BE    @RF00294                                            0294 00446000
*     DO;                           /* AND GO TO ERROR MSG RTN       */ 00447000
*       R6=R15;                     /* SAVE THE RETURN CODE          */ 00448000
         LR    R6,R15                                              0296 00449000
*       RESPECIFY                                                  0297 00450000
*        (R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */ 00451000
*       MSGSEG2B=ADDR(CMDSCNSG);    /* POINT TO COMMAND SCAN SEG     */ 00452000
         LA    @10,CMDSCNSG                                        0298 00453000
         ST    @10,MSGSEG2B                                        0298 00454000
*       GO TO MSGRTN4;              /* GO ISSUE THE MESSAGE          */ 00455000
         B     MSGRTN4                                             0299 00456000
*     END;                          /* END OF CMD SCAN FAIL        0300 00457000
*                                      PROCESSING                    */ 00458000
*SCANTEST:                          /* BRANCH ADDRESS WHEN A NEW   0301 00459000
*                                      COMMAND IS ENTERED DURING AN     00460000
*                                      ATTENTION EXIT AND THE CP ECB    00461000
*                                      IS POSTED. COMMAND WAS SCANNED   00462000
*                                      BY COMMAND SCAN IN THE      0301 00463000
*                                      ATTENTION EXIT RTN.           */ 00464000
*   IF CSOANOC='1'B                 /* CHECK FOR AN EMPTY BUFFER     */ 00465000
*     THEN                                                         0301 00466000
@RF00294 DS    0H                                                  0301 00467000
SCANTEST L     @10,CSOAPTR                                         0301 00468000
         TM    CSOANOC(@10),B'00010000'                            0301 00469000
         BO    @RT00301                                            0301 00470000
*     GO TO OPERABIL;               /* BUFFER EMPTY - GO GET ANOTHER    00471000
*                                      LINE OF INPUT                 */ 00472000
*   IF CSOABAD='1'B                 /* CHK FOR SYNTACTICALLY INVAL 0303 00473000
*                                      CMD                           */ 00474000
*     THEN                          /* SYNTACTICALLY INVALID COMMAND */ 00475000
         TM    CSOABAD(@10),B'00001000'                            0303 00476000
         BO    @RT00303                                            0303 00477000
*     GO TO MSGRTN3;                /* GO TO PUT ERROR MSG TO      0304 00478000
*                                      TERMINAL                      */ 00479000
*/*                                                                0305 00480000
*    A SYNTACTICALLY VALID COMMAND NAME HAS BEEN FOUND, CONTINUE   0305 00481000
*    PROCESSING OF THE COMMAND                                     0305 00482000
*                                                                    */ 00483000
*                                                                  0305 00484000
*   IF CSOALNM<EIGHT                /* IF CMD LENGTH IS LESS THAN 8  */ 00485000
*     THEN                          /* MOVE SUBCOMMAND NAME INTO     */ 00486000
         LH    @09,CSOALNM(,@10)                                   0305 00487000
         CH    @09,@CH00035                                        0305 00488000
         BNL   @RF00305                                            0305 00489000
*     ECTSCMD=CMDNAME(1:CSOALNM);   /* ECT FOR USE ON ABEND CONDITION*/ 00490000
         L     @07,SAVECPPL                                        0306 00491000
         L     @07,ECTPTR(,@07)                                    0306 00492000
         MVI   ECTSCMD+1(@07),C' '                                 0306 00493000
         MVC   ECTSCMD+2(6,@07),ECTSCMD+1(@07)                     0306 00494000
         BCTR  @09,0                                               0306 00495000
         L     @10,CSOACNM(,@10)                                   0306 00496000
         EX    @09,@SM01347                                        0306 00497000
*   ELSE                            /* ELSE MOVE FIRST EIGHT BYTES OF*/ 00498000
*     ECTSCMD=CMDNAME(1:8);         /* SUBCOMMAND NAME INTO ECT      */ 00499000
         B     @RC00305                                            0307 00500000
@RF00305 L     @10,SAVECPPL                                        0307 00501000
         L     @10,ECTPTR(,@10)                                    0307 00502000
         L     @09,CSOAPTR                                         0307 00503000
         L     @09,CSOACNM(,@09)                                   0307 00504000
         MVC   ECTSCMD(8,@10),CMDNAME(@09)                         0307 00505000
*   IF CMDNAME(1:3)=ENDCMD(1:3)&CSOALNM=THREE/* END COMMAND? TEST  0308 00506000
*                                      COMMAND ENTERED BY USER       */ 00507000
*     THEN                          /* REQUEST TP TERMINATE OPERATOR */ 00508000
@RC00305 L     @10,CSOAPTR                                         0308 00509000
         L     @09,CSOACNM(,@10)                                   0308 00510000
         CLC   CMDNAME(3,@09),ENDCMD                               0308 00511000
         BNE   @RF00308                                            0308 00512000
         CLC   CSOALNM(2,@10),@CH00251                             0308 00513000
         BNE   @RF00308                                            0308 00514000
*     DO;                           /* MODE. GO TO STOP ANY ACTIVE MN   00515000
*                                      FUNCTIONS AND RETURN TO TMP   */ 00516000
*       R6=ZEROS;                   /* SET RETURN CODE               */ 00517000
         L     R6,ZEROS                                            0310 00518000
*       GO TO EXITA;                /* GO TO RETURN TO TMP           */ 00519000
         B     EXITA                                               0311 00520000
*     END;                          /* END OF END CMD CHECK          */ 00521000
*   IF CMDNAME(1:4)=HELPCMD(1:4)&CSOALNM=FOUR/* IF USER REQUESTED    */ 00522000
*     THEN                          /* HELP INFO,                    */ 00523000
@RF00308 L     @10,CSOAPTR                                         0313 00524000
         L     @09,CSOACNM(,@10)                                   0313 00525000
         CLC   CMDNAME(4,@09),HELPCMD                              0313 00526000
         BNE   @RF00313                                            0313 00527000
         CLC   CSOALNM(2,@10),@CH00049                             0313 00528000
         BE    @RT00313                                            0313 00529000
*     GO TO HELP;                   /* GO TO ATTACH HELP CP          */ 00530000
*   IF CMDNAME(1)=HELPCMD(1)&CSOALNM=UNO/* CHECK FOR HELP            */ 00531000
*     THEN                          /* ABBREVIATION,                 */ 00532000
@RF00313 L     @10,CSOAPTR                                         0315 00533000
         L     @09,CSOACNM(,@10)                                   0315 00534000
         CLC   CMDNAME(1,@09),HELPCMD                              0315 00535000
         BNE   @RF00315                                            0315 00536000
         CLC   CSOALNM(2,@10),@CH00057                             0315 00537000
         BE    @RT00315                                            0315 00538000
*     GO TO HELP;                   /* GO TO ATTACH HELP CP          */ 00539000
*   IF CMDNAME(1:8)=MONITOR|CMDNAME(1:3)=MN|/* MONITOR CMD?          */ 00540000
*       CMDNAME(1:8)=DISPLAY|CMDNAME(1:2)=D|/* DISPLAY COMMAND?      */ 00541000
*       CMDNAME(1:7)=STOPMN|CMDNAME(1:3)=PM|/* STOPMN COMMAND?       */ 00542000
*       CMDNAME(1:5)=SEND|CMDNAME(1:3)=SE|/* SEND COMMAND?           */ 00543000
*       CMDNAME(1:7)=CANCEL|CMDNAME(1:2)=C/* CANCEL COMMAND?         */ 00544000
*     THEN                          /* ABOVE CMD FOUND-MUST HAVE   0317 00545000
*                                      VALID                         */ 00546000
@RF00315 L     @10,CSOAPTR                                         0317 00547000
         L     @10,CSOACNM(,@10)                                   0317 00548000
         CLC   CMDNAME(8,@10),MONITOR                              0317 00549000
         BE    @RT00317                                            0317 00550000
         CLC   CMDNAME(3,@10),MN                                   0317 00551000
         BE    @RT00317                                            0317 00552000
         CLC   CMDNAME(8,@10),DISPLAY                              0317 00553000
         BE    @RT00317                                            0317 00554000
         CLC   CMDNAME(2,@10),D                                    0317 00555000
         BE    @RT00317                                            0317 00556000
         CLC   CMDNAME(7,@10),STOPMN                               0317 00557000
         BE    @RT00317                                            0317 00558000
         CLC   CMDNAME(3,@10),PM                                   0317 00559000
         BE    @RT00317                                            0317 00560000
         CLC   CMDNAME(5,@10),SEND                                 0317 00561000
         BE    @RT00317                                            0317 00562000
         CLC   CMDNAME(3,@10),SE                                   0317 00563000
         BE    @RT00317                                            0317 00564000
         CLC   CMDNAME(7,@10),CANCEL                               0317 00565000
         BE    @RT00317                                            0317 00566000
         CLC   CMDNAME(2,@10),C                                    0317 00567000
         BNE   @RF00317                                            0317 00568000
@RT00317 DS    0H                                                  0318 00569000
*     DO;                           /* CMD BEFORE CHECKING FOR     0318 00570000
*                                      OPERAND PRESENCE.             */ 00571000
*       IF CSOAVNP='1'B THEN        /* THE ABOVE MUST HAVE OPERANDS  */ 00572000
         L     @10,CSOAPTR                                         0319 00573000
         TM    CSOAVNP(@10),B'01000000'                            0319 00574000
         BO    @RT00319                                            0319 00575000
*         GO TO MSGRTN7;            /* NO OPERAND,ISSUE ERROR MSG    */ 00576000
*     END;                          /* END OF OPERAND CHECK          */ 00577000
*   ELSE                            /* THE COMMAND WAS INVALID SO    */ 00578000
*     GO TO MSGRTN3;                /* ISSUE APPROPRIATE ERROR     0322 00579000
*                                      MESSAGE                       */ 00580000
*   GEN(EJECT);                                                    0323 00581000
*                                                                  0323 00582000
         EJECT                                                          00583000
*   /*****************************************************************/ 00584000
*   /*                                                               */ 00585000
*   /* THE FOLLOWING CODE CREATES A WTO MESSAGE THAT IS TO BE WRITTEN*/ 00586000
*   /* TO THE MASTER CONSOLE OPERATOR WHENEVER A COMMAND IS GOTTEN AT*/ 00587000
*   /* A TERMINAL. THE FORMAT OF THE MESSAGE IS MESSAGE ID TEXT      */ 00588000
*   /* USERID IEF425I DISPLAY A SMITH IF THE TEXT IS LONGER THAT 56  */ 00589000
*   /* (WTO MESSAGE IS RESTRICTED TO 72 CHARACTERS IN LENGTH)        */ 00590000
*   /* ADDITIONAL LINES ARE WRITTEN OUT                              */ 00591000
*   /*                                                               */ 00592000
*   /*****************************************************************/ 00593000
*                                                                  0324 00594000
*   WTOLNGTH=LNGBUFFR-FOUR;         /* CALCULATE LENGTH OF TEXT ONLY */ 00595000
         L     @10,WORK7                                           0324 00596000
         LH    @10,LNGBUFFR(,@10)                                  0324 00597000
         SH    @10,@CH00049                                        0324 00598000
         ST    @10,WTOLNGTH                                        0324 00599000
*BLNKLOOP:                                                         0325 00600000
*                                                                  0325 00601000
*/*                                                                0325 00602000
*    STARTING SEARCH FROM END OF BUFFER, FIND LAST CHARACTER IN    0325 00603000
*    BUFFER, EXCLUDING TRAILING BLANKS                             0325 00604000
*                                                                    */ 00605000
*                                                                  0325 00606000
*   IF CMDDATE(WTOLNGTH)=BLANK      /* IF TRAILING CHARACTER IS BLANK*/ 00607000
*     THEN                          /* YES, IT IS BLANK              */ 00608000
BLNKLOOP L     @10,WTOLNGTH                                        0325 00609000
         L     @09,WORK7                                           0325 00610000
         ALR   @09,@10                                             0325 00611000
         CLC   CMDDATE-1(1,@09),BLANK                              0325 00612000
         BNE   @RF00325                                            0325 00613000
*     DO;                           /* DO:                           */ 00614000
*       WTOLNGTH=WTOLNGTH-UNO;      /* DECREMENT POINTER TO POINT TO    00615000
*                                      NEXT CHARACTER                */ 00616000
         BCTR  @10,0                                               0327 00617000
         ST    @10,WTOLNGTH                                        0327 00618000
*       GO TO BLNKLOOP;             /* GO TO CHECK CHARACTER         */ 00619000
         B     BLNKLOOP                                            0328 00620000
*     END;                          /* END BLANK CHARACTER PROCESSING*/ 00621000
*   WTOLNGTH=WTOLNGTH+UNO;          /* LAST CHARACTER FOUND--ALLOW 0330 00622000
*                                      FOR ONE BLANK                 */ 00623000
@RF00325 LA    @10,1                                               0330 00624000
         L     @09,WTOLNGTH                                        0330 00625000
         ALR   @09,@10                                             0330 00626000
         ST    @09,WTOLNGTH                                        0330 00627000
*   WTOPTR=UNO;                     /* INITIALIZE OFFSET INTO BUFFER */ 00628000
         ST    @10,WTOPTR                                          0331 00629000
*REWTO:                                                            0332 00630000
*   CALL CLEAR;                     /* BLANK OUT BUFFER              */ 00631000
REWTO    BAL   @14,CLEAR                                           0332 00632000
*   LNGOFF1=MCSFLG;                 /* INITIALIZE MCS FLAGS IN WTO 0333 00633000
*                                      EXPANSION TO MASTER CONSOLE,     00634000
*                                      INFORMATIONAL          YM08131*/ 00635000
         MVC   LNGOFF1(2),MCSFLG                                   0333 00636000
*   OUTBUFF1(1:8)=CNSLID;           /* MOVE IN MESSAGE ID            */ 00637000
         MVC   OUTBUFF1(8),CNSLID                                  0334 00638000
*/*                                                                0335 00639000
*    LENGTH OF INPUT COMMAND MUST BE CHECKED BECAUSE A MESSAGE TO  0335 00640000
*    CONSOLE SHOULD NOT BE GREATER THAN 72 CHARACTERS.  THEREFORE  0335 00641000
*    THE LIMIT TO THE LENGTH OF TEXT ON EACH LINE IS 56.  THE      0335 00642000
*    COMMAND MUST ALSO BE TRANSLATED TO UPPER CASE FOR THE WTO.    0335 00643000
*                                                                    */ 00644000
*                                                                  0335 00645000
*   IF WTOLNGTH>FIVESEVN            /* IF THE LENGTH IS GREATER THAN */ 00646000
*     THEN                          /* 57 ( INCLUDING BLANK SEPARATOR*/ 00647000
         L     @10,WTOLNGTH                                        0335 00648000
         CH    @10,@CH00437                                        0335 00649000
         BNH   @RF00335                                            0335 00650000
*     DO;                           /* BETWEEN USERID AND TEXT) SO A    00651000
*                                      A MULTI-LINE WTO IS DONE      */ 00652000
*       LNGBUF1=SEVENSIX;           /* TOTAL LENGTH OF BUFFER      0337 00653000
*                                      INCLUDING LENGTH, MCS FLAGS,     00654000
*                                      TEXT, MSG ID AND USERID       */ 00655000
         MVC   LNGBUF1(2),@CH00439                                 0337 00656000
*       OUTBUFF1(9:64)=CMDDATE(WTOPTR:WTOPTR+SIXTHREE);/* MOVE TEXT     00657000
*                                      1NTO BUFFER                   */ 00658000
         L     @10,WORK7                                           0338 00659000
         AL    @10,WTOPTR                                          0338 00660000
         MVC   OUTBUFF1+8(56),CMDDATE-1(@10)                       0338 00661000
*       OUTBUFF1(66:72)=PSCBUSER;   /* MOVE USERID                   */ 00662000
         L     @10,SAVECPPL                                        0339 00663000
         L     @10,PSCBPTR(,@10)                                   0339 00664000
         MVC   OUTBUFF1+65(7),PSCBUSER(@10)                        0339 00665000
*       OUTBUFF1(73:76)=DESCODE;    /* ZERO OUT WORD FOLLOWING TEXT     00666000
*                                      FOR MCS ROUTING AND DESCRIPTOR   00667000
*                                      CODE                   YM08131*/ 00668000
         MVC   OUTBUFF1+72(4),DESCODE                              0340 00669000
*       R6=FIVEFIVE;                /* SET LENGTH TO BE TRANSLATED   */ 00670000
         LA    R6,55                                               0341 00671000
*       RESPECIFY                                                  0342 00672000
*        (R1) RSTD;                 /* RESTRICT REG FOR WTO          */ 00673000
*       R1=ADDR(OUTBUFF1)+EIGHT;    /* GET ADDRESS OF COMMAND TEXT   */ 00674000
         LA    R1,OUTBUFF1                                         0343 00675000
         AH    R1,@CH00035                                         0343 00676000
*       GEN(EX R6,EXTRNSLT);        /* TRANSLATE TO UPPER CASE       */ 00677000
         EX R6,EXTRNSLT                                                 00678000
*       R1=ADDR(BUFR1);             /* POINT TO WTO PARAMETER LIST   */ 00679000
         LA    R1,BUFR1                                            0345 00680000
*       GEN(WTO MF=(E,(1)));        /* WRITE COMMAND TO CONSOLE      */ 00681000
         WTO MF=(E,(1))                                                 00682000
*       RESPECIFY                                                  0347 00683000
*        (R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */ 00684000
*       WTOLNGTH=WTOLNGTH-FIVESIX;  /* DECREMENT TOTAL LENGTH OF TEXT   00685000
*                                      TO BE WRITTEN OUT             */ 00686000
         LA    @10,56                                              0348 00687000
         L     @09,WTOLNGTH                                        0348 00688000
         SLR   @09,@10                                             0348 00689000
         ST    @09,WTOLNGTH                                        0348 00690000
*       WTOPTR=WTOPTR+FIVESIX;      /* INCREMENT OFFSET INTO TEXT    */ 00691000
         AL    @10,WTOPTR                                          0349 00692000
         ST    @10,WTOPTR                                          0349 00693000
*       GO TO REWTO;                /* GO TO WRITE REMAINING TEXT    */ 00694000
         B     REWTO                                               0350 00695000
*     END;                          /* END OF WTO-LENGTH >57         */ 00696000
*   ELSE                            /* WTO WITH LENGTH <57           */ 00697000
*     DO;                           /* WTO MESSAGE                   */ 00698000
@RF00335 DS    0H                                                  0353 00699000
*       LNGBUF1=WTOLNGTH+NINETEEN;  /* INITIALIZE TOTAL LENGTH OF WTO   00700000
*                                      BUFFER TO SUM OF LENGTH OF  0353 00701000
*                                      TEXT EXCLUDING TRAILING     0353 00702000
*                                      BLANKS, LENGTH FIELD, MCS   0353 00703000
*                                      FLANGS, MSG ID, AND USERID    */ 00704000
         L     @10,WTOLNGTH                                        0353 00705000
         LA    @09,19(,@10)                                        0353 00706000
         STH   @09,LNGBUF1                                         0353 00707000
*       OUTBUFF1(9:WTOLNGTH+EIGHT)=CMDDATE(WTOPTR:WTOPTR+WTOLNGTH-UNO); 00708000
         LR    @09,@10                                             0354 00709000
         BCTR  @09,0                                               0354 00710000
         L     @07,WORK7                                           0354 00711000
         AL    @07,WTOPTR                                          0354 00712000
         EX    @09,@SM01349                                        0354 00713000
*                                   /* MOVE TEXT INTO BUFFER         */ 00714000
*       OUTBUFF1(WTOLNGTH+NINE:WTOLNGTH+FIFTEEN)=PSCBUSER;/* MOVE IN    00715000
*                                      USERID                        */ 00716000
         LA    @07,OUTBUFF1+8(@10)                                 0355 00717000
         L     @01,SAVECPPL                                        0355 00718000
         L     @01,PSCBPTR(,@01)                                   0355 00719000
         MVC   0(7,@07),PSCBUSER(@01)                              0355 00720000
*       OUTBUFF1(WTOLNGTH+SIXTEEN:WTOLNGTH+NINETEEN)=DESCODE;/* MOVE    00721000
*                                      IN FLAGS--ROUTING AND       0356 00722000
*                                      DESCRIPTOR CODES       YM08131*/ 00723000
         L     @07,DESCODE                                         0356 00724000
         ST    @07,@TF00001                                        0356 00725000
         LA    @01,OUTBUFF1+15(@10)                                0356 00726000
         MVC   0(4,@01),@TF00001                                   0356 00727000
*       R6=WTOLNGTH-UNO;            /* SET LENGTH TO BE TRANSLATED   */ 00728000
         LR    R6,@09                                              0357 00729000
*       RESPECIFY                                                  0358 00730000
*        (R1) RSTD;                 /* RESTRICT REG FOR WTO          */ 00731000
*       R1=ADDR(OUTBUFF1)+EIGHT;    /* GET ADDRESS OF COMMAND TEXT   */ 00732000
         LA    R1,OUTBUFF1                                         0359 00733000
         AH    R1,@CH00035                                         0359 00734000
*       GEN(EX R6,EXTRNSLT);        /* TRANSLATE TO UPPER CASE       */ 00735000
         EX R6,EXTRNSLT                                                 00736000
*       R1=ADDR(BUFR1);             /* POINT TO WTO PARAMETER LIST   */ 00737000
         LA    R1,BUFR1                                            0361 00738000
*       GEN(WTO MF=(E,(1)));                                       0362 00739000
         WTO MF=(E,(1))                                                 00740000
*       RESPECIFY                                                  0363 00741000
*        (R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */ 00742000
*     END;                                                         0364 00743000
*   GEN(EJECT);                                                    0365 00744000
*                                                                  0365 00745000
         EJECT                                                          00746000
*   /*****************************************************************/ 00747000
*   /*                                                               */ 00748000
*   /* .PREPARE PARAMETER LIST TO ISSUE SVC 100 TO VALIDITY CHECK    */ 00749000
*   /* OPERATOR COMMANDS .BEFORE PROCESSING CURRENT COMMAND CHECK CP */ 00750000
*   /* ECB TO DETERMINE IF ATTENTION EXIT WAS TAKEN AND A NEW COMMAND*/ 00751000
*   /* WAS ENTERED                                                   */ 00752000
*   /*                                                               */ 00753000
*   /*****************************************************************/ 00754000
*                                                                  0366 00755000
*INIT100:                                                          0366 00756000
*   RFY                                                            0366 00757000
*    (R4,                                                          0366 00758000
*     R5) RSTD;                     /* RESTRICT BEFORE BRANCHING     */ 00759000
INIT100  DS    0H                                                  0367 00760000
*   ABUFFER=ADDR(CMDBUFFR);         /* GET ADDR OF COMMAND BUFFER    */ 00761000
         L     @10,WORK7                                           0367 00762000
         ST    @10,ABUFFER                                         0367 00763000
*   R5=ADDR(CMDBUFFR)+BFOFFSET+FOUR;/* CALCULATE ADDR OF OPERAND IN     00764000
*                                      COMMAND BUFFER                */ 00765000
         LH    R5,BFOFFSET(,@10)                                   0368 00766000
         ALR   R5,@10                                              0368 00767000
         AH    R5,@CH00049                                         0368 00768000
*   ACMDNAME=CSOACNM;               /* POINT TO COMMAND IN BUFFER    */ 00769000
         L     @09,CSOAPTR                                         0369 00770000
         L     @09,CSOACNM(,@09)                                   0369 00771000
         ST    @09,ACMDNAME                                        0369 00772000
*   R4=ADDR(CMDBUFFR)+LNGBUFFR;     /* PTR TO END OF BUFFER          */ 00773000
         LH    R4,LNGBUFFR(,@10)                                   0370 00774000
         ALR   R4,@10                                              0370 00775000
*   AOPRND=R5;                      /* PTR TO OPERAND                */ 00776000
         ST    R5,AOPRND                                           0371 00777000
*   R6=ZEROS;                       /* INITIALIZE COUNTER TO LENGTH     00778000
*                                      OF OPERAND                    */ 00779000
         L     R6,ZEROS                                            0372 00780000
*   IF CMDNAME(1:5)^=SEND&CMDNAME(1:3)^=SE/* SEND COMMAND?           */ 00781000
*     THEN                          /* THE COMMAND IS MN,PM,C, OR D  */ 00782000
         CLC   CMDNAME(5,@09),SEND                                 0373 00783000
         BE    @RF00373                                            0373 00784000
         CLC   CMDNAME(3,@09),SE                                   0373 00785000
         BE    @RF00373                                            0373 00786000
*     CALL CLNGOP;                  /* THEN GO TRANSLATE THE OPERAND */ 00787000
         BAL   @14,CLNGOP                                          0374 00788000
*   IF ECBBIT1='1'B                 /* WHEN ECB IS POSTED            */ 00789000
*     THEN                          /* THEN GO                       */ 00790000
@RF00373 TM    ECBBIT1,B'01000000'                                 0375 00791000
         BO    @RT00375                                            0375 00792000
*     GO TO ATTN;                   /* PROCESS NEW COMMAND           */ 00793000
*   AUTHCHK='0'B;                   /* SET FLAGS TO VALIDITY CHECK   */ 00794000
*   CMDCHK='1'B;                    /* COMMAND ENTERED               */ 00795000
         OI    CMDCHK,B'01000000'                                  0378 00796000
         NI    AUTHCHK,B'01111111'                                 0378 00797000
*   RESPECIFY                                                      0379 00798000
*    (R1,                                                          0379 00799000
*     R15) RSTD;                    /* RESTRICT REGS ACROSS SVC      */ 00800000
*   R1=ADDR(FIBMAINP);              /* POINT TO PARAMETER LIST       */ 00801000
         LA    R1,FIBMAINP                                         0380 00802000
*   SVC(100);                       /* SVC FOR FIB, PROF AND OPER TSO   00803000
*                                      COMMANDS....IKJEFFS0 PL/S   0381 00804000
*                                      MACRO                         */ 00805000
         SVC   100                                                 0381 00806000
*   R6=R15;                         /* SAVE RETURN CODE FOR TESTING  */ 00807000
         LR    R6,R15                                              0382 00808000
*   RESPECIFY                                                      0383 00809000
*    (R1,                                                          0383 00810000
*     R15) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 00811000
*   RFY                                                            0384 00812000
*    (R4,                                                          0384 00813000
*     R5) UNRSTD;                   /* FREE FOR THE COMPILER         */ 00814000
*   IF R6=FIBOKRC                   /* INDICATES SVC IS SUCCESSFUL   */ 00815000
*     THEN                          /* VALID COMMAND PROCESSED, GO   */ 00816000
         LTR   R6,R6                                               0385 00817000
         BZ    @RT00385                                            0385 00818000
*     GO TO OPERABIL;               /* TO GET ANOTHER COMMAND        */ 00819000
*   IF R6=FIBOPCMD                  /* INDICATES INVALID SUBCOMMAND  */ 00820000
*     THEN                          /* GO TO ISSUE ERROR MSG AND GET */ 00821000
         CH    R6,@CH00049                                         0387 00822000
         BE    @RT00387                                            0387 00823000
*     GO TO MSGRTN3;                /* ANOTHER COMMAND               */ 00824000
*   IF R6=FIBOPOPD                  /* INDICATES INVALID OPERAND     */ 00825000
*     THEN                          /* GO TO ISSUE ERROR MSG AND GET */ 00826000
         CH    R6,@CH00035                                         0389 00827000
         BE    @RT00389                                            0389 00828000
*     GO TO MSGRTN5;                /* LINE OF INPUT                 */ 00829000
*   ELSE                            /* FAILED WITH UNUSUAL RETURN  0391 00830000
*                                      CODE                          */ 00831000
*     DO;                           /* PUT OUT GENERALIZED MESSAGE   */ 00832000
*       MSGSEG2B=ADDR(SVC100SG);    /* INDICATE AN SVC ERROR IN MSG  */ 00833000
         LA    @10,SVC100SG                                        0392 00834000
         ST    @10,MSGSEG2B                                        0392 00835000
*       GO TO MSGRTN4;              /* GO PUT OUT THE MESSAGE        */ 00836000
         B     MSGRTN4                                             0393 00837000
*     END;                          /* END GENERALIZED MSG PROCESSING*/ 00838000
*   GEN(EJECT);                                                    0395 00839000
*                                                                  0395 00840000
         EJECT                                                          00841000
*/********************************************************************/ 00842000
*/*      MESSAGE FORMATTING ROUTINES--                               */ 00843000
*/*      . MOVES THE MESSAGES INTO THE BUFFERS                       */ 00844000
*/*      . CALLS PUTLRTN TO ISSUE THE MESSAGE                        */ 00845000
*/*      . BRANCHES TO APPROPRIATE SPOT TO CONTINUE OR TERMINATE     */ 00846000
*/********************************************************************/ 00847000
*/*                                                                0396 00848000
*    ROUTINE 1 INITIALIZES THE WARNING MESSAGE WHEN DATA HAS BEEN  0396 00849000
*    ENTERED ON THE OPERATOR COMMAND                               0396 00850000
*      IKJ550001I DATA IGNORED IN THE OPERAND FIELD                0396 00851000
*                                                                    */ 00852000
*                                                                  0396 00853000
*MSGRTN1:                                                          0396 00854000
*   CALL CLEAR;                     /* CLEAR OUTPUT BUFFERS          */ 00855000
MSGRTN1  BAL   @14,CLEAR                                           0396 00856000
*   LNGBUF1=LNGMSG1A;               /* INITIALIZE LNG OF 1ST M2051   */ 00857000
         MVC   LNGBUF1(2),LNGMSG1A                                 0397 00858000
*   LNGBUF2=LNGMSG1B;               /* AND 2ND LVL MESSAGES          */ 00859000
         MVC   LNGBUF2(2),LNGMSG1B                                 0398 00860000
*   RESPECIFY                                                      0399 00861000
*    (R7,                                                          0399 00862000
*     R9) UNRESTRICTED;             /* ALLOW CMPLR USE OF REGS 7,9   */ 00863000
*   OUTBUFF1(1:44)=MSG0011;         /* INITIALIZE 1ST LVL MSG TEXT   */ 00864000
         MVC   OUTBUFF1(44),MSG0011                                0400 00865000
*   OUTBUFF2(1:50)=MSG0012;         /* INITIALIZE 2ND LEVEL MSG TEXT */ 00866000
         MVC   OUTBUFF2(50),MSG0012                                0401 00867000
*   ECTNOPD='0'B;                   /* TURN OFF ECT BIT SPECIFYING 0402 00868000
*                                      OPERANDS ON CMD - FOR CASE OF    00869000
*                                      RETRY ON ABEND CONDITION TO 0402 00870000
*                                      AVOID PUTTING MESSAGE OUT     */ 00871000
         L     @10,SAVECPPL                                        0402 00872000
         L     @10,ECTPTR(,@10)                                    0402 00873000
         NI    ECTNOPD(@10),B'01111111'                            0402 00874000
*   CALL PUTLRTN;                   /* GO TO PUTLINE RTN             */ 00875000
         BAL   @14,PUTLRTN                                         0403 00876000
*   GO TO TESTABIL;                 /* GO TO TEST FOR OPERATOR     0404 00877000
*                                      ABILITY                       */ 00878000
         B     TESTABIL                                            0404 00879000
*   GEN(EJECT);                                                    0405 00880000
*                                                                  0405 00881000
         EJECT                                                          00882000
*/*                                                                0406 00883000
*    TERMINAL USER IS NOT ELIGIBLE TO ISSUE OPERATOR COMMAND,      0406 00884000
*    ISSUE ERROR MESSAGE TO TERMINAL AND RETURN TO TMP             0406 00885000
*      IKJ55000I OPERATOR COMMAND NOT AUTHORIZED FOR               0406 00886000
*                                                                    */ 00887000
*                                                                  0406 00888000
*MSGRTN2:                                                          0406 00889000
*   LNGBUF1=LNGMSG0A;               /* INITIALIZE LENGTH OF 1ST      */ 00890000
MSGRTN2  MVC   LNGBUF1(2),LNGMSG0A                                 0406 00891000
*   LNGBUF2=LNGMSG0B;               /* AND 2ND LEVEL MESSAGES        */ 00892000
         MVC   LNGBUF2(2),LNGMSG0B                                 0407 00893000
*   OUTBUFF1(1:54)=MSG0001;         /* MOVE 1ST LVL MSG TO BUFR      */ 00894000
         MVC   OUTBUFF1(54),MSG0001                                0408 00895000
*   OUTBUFF1(47:50)=PSCBUSER(1:4);  /* MOVE USER ID INTO             */ 00896000
         L     @10,SAVECPPL                                        0409 00897000
         L     @10,PSCBPTR(,@10)                                   0409 00898000
         MVC   OUTBUFF1+46(4),PSCBUSER(@10)                        0409 00899000
*   OUTBUFF1(51:53)=PSCBUSER(5:7);  /* MSG TEXT                      */ 00900000
         MVC   OUTBUFF1+50(3),PSCBUSER+4(@10)                      0410 00901000
*   OUTBUFF2(1:66)=MSG0002;         /* MOVE 2ND LVL MSG TO BUFR      */ 00902000
         MVC   OUTBUFF2(66),MSG0002                                0411 00903000
*   CALL PUTLRTN;                   /* GO TO PUTLINE SUBROUTINE      */ 00904000
         BAL   @14,PUTLRTN                                         0412 00905000
*   R6=ZEROS;                       /* SET RETURN CODE               */ 00906000
         L     R6,ZEROS                                            0413 00907000
*   GO TO EXITA;                    /* RETURN TO THE TMP             */ 00908000
         B     EXITA                                               0414 00909000
*   GEN(EJECT);                                                    0415 00910000
*                                                                  0415 00911000
         EJECT                                                          00912000
*/*                                                                0416 00913000
*    ROUTINE 3 INITIALIZES THE ERROR MESSAGE FOR INVALID COMMANDS  0416 00914000
*      IKJ550003I INVALID SUBCOMMAND                               0416 00915000
*                                                                    */ 00916000
*                                                                  0416 00917000
*MSGRTN3:                                                          0416 00918000
*   CALL CLEAR;                     /* BLANK OUT BUFFER              */ 00919000
MSGRTN3  BAL   @14,CLEAR                                           0416 00920000
*   IF CSOALNM>MSGLEN-LNGMSG3A      /* IF LENGTH OF 1ST LEVEL MSG IS */ 00921000
*     THEN                          /* GREATER THAN LENGTH OF BUFFER */ 00922000
         L     @10,CSOAPTR                                         0417 00923000
         LA    @09,136                                             0417 00924000
         SH    @09,LNGMSG3A                                        0417 00925000
         CH    @09,CSOALNM(,@10)                                   0417 00926000
         BNL   @RF00417                                            0417 00927000
*     DO;                           /* SUBCOMMAND WILL BE TRUNCATED  */ 00928000
*       RESPECIFY                                                  0419 00929000
*        (R4) RSTD;                 /* RESTRICT REGISTER USAGE       */ 00930000
*       R4=BUFLEN;                  /* SET END OF BUFFER LIMIT       */ 00931000
         LA    R4,132                                              0420 00932000
*       CSOALNM=MSGLEN-LNGMSG3A;    /* INITIALIZE MAXIMUM LENGTH     */ 00933000
         STH   @09,CSOALNM(,@10)                                   0421 00934000
*     END;                          /* SUBCOMMAND TO BE WRITTEN OUT  */ 00935000
*   ELSE                            /* CALCULATE END OF SUBCMD NAME     00936000
*                                      IN                            */ 00937000
*     R4=CSOALNM+THIRTY;            /* OUTPUT BUFFER                 */ 00938000
         B     @RC00417                                            0423 00939000
@RF00417 LA    R4,30                                               0423 00940000
         L     @10,CSOAPTR                                         0423 00941000
         AH    R4,CSOALNM(,@10)                                    0423 00942000
*   OUTBUFF1(1:28)=MSG0031;         /* MOVE MSG IKJ55003I TO BUFFER  */ 00943000
@RC00417 MVC   OUTBUFF1(28),MSG0031                                0424 00944000
*   OUTBUFF1(30:R4)=CMDNAME;        /* MOVE SUBCOMMAND NAME TO MSG   */ 00945000
         LR    @10,R4                                              0425 00946000
         SH    @10,@CH00424                                        0425 00947000
         L     @09,CSOAPTR                                         0425 00948000
         L     @07,CSOACNM(,@09)                                   0425 00949000
         EX    @10,@SM01352                                        0425 00950000
*   LNGBUF1=LNGMSG3A+CSOALNM;       /* INITIALIZE LNG OF 1ST LEVEL 0426 00951000
*                                      MSG                           */ 00952000
         LH    @10,LNGMSG3A                                        0426 00953000
         AH    @10,CSOALNM(,@09)                                   0426 00954000
         STH   @10,LNGBUF1                                         0426 00955000
*   LNGBUF2=LNGMSG3B;               /* INITIALIZE LNG OF 2ND LEVEL 0427 00956000
*                                      MSG                           */ 00957000
         MVC   LNGBUF2(2),LNGMSG3B                                 0427 00958000
*   OUTBUFF1(R4)=PLUSSIGN;          /* PUT PLUS SIGN AT END OF MSG TO   00959000
*                                      INDICATE 2ND LEVEL MSG EXISTS */ 00960000
         LA    @10,OUTBUFF1-1(R4)                                  0428 00961000
         MVC   0(1,@10),PLUSSIGN                                   0428 00962000
*   RESPECIFY                                                      0429 00963000
*    (R4) UNRSTD;                   /* FREE FOR COMPILER USAGE       */ 00964000
*   OUTBUFF2(1:90)=MSG0032;         /* INITIALIZE 2ND LEVEL MSG TEXT */ 00965000
         MVI   OUTBUFF2+78,C' '                                    0430 00966000
         MVC   OUTBUFF2+79(11),OUTBUFF2+78                         0430 00967000
         MVC   OUTBUFF2(78),MSG0032                                0430 00968000
*   CALL PUTLRTN;                   /* GO TO PUTLINE ROUTINE         */ 00969000
         BAL   @14,PUTLRTN                                         0431 00970000
*   GO TO OPERABIL;                 /* GO TO GET ANOTHER LINE OF   0432 00971000
*                                      INPUT                         */ 00972000
         B     OPERABIL                                            0432 00973000
*   GEN(EJECT);                                                    0433 00974000
*                                                                  0433 00975000
         EJECT                                                          00976000
*/*                                                                0434 00977000
*    THE FOLLOWING ROUTINE IS ENTERED WHEN OPERATOR COMMAND        0434 00978000
*    PROCESSOR DETERMINED AN INVALID CONDITION IN PROCESSING AND   0434 00979000
*    WOULD NOT CONTINUE. OPERATOR CP ISSUES AN ERROR MESSAGE TO    0434 00980000
*    THE TERMINAL, RESETS THE INPUT SOURCE STACK TO THE TERMINAL,  0434 00981000
*    CLEARS THE INPUT QUEUE OF ANY TYPED AHEAD COMMANDS AND        0434 00982000
*    RETURNS TO THE TMP WITH AN ERROR RETURN CODE IN REGISTER 15.  0434 00983000
*      IKJ55004I COMMAND SYSTEM ERROR+                             0434 00984000
*      IKJ55004I 'SERVICE RTN' ERROR RETURN CODE IS XXX            0434 00985000
*                                                                    */ 00986000
*                                                                  0434 00987000
*MSGRTN4:                                                          0434 00988000
*   CALL CLEAR;                     /* CLEAR OUTPUT BUFFERS          */ 00989000
MSGRTN4  BAL   @14,CLEAR                                           0434 00990000
*   OUTBUFF1(1:31)=MSG0041;         /* MOVE MSG TEXT TO BUFR MOVE  0435 00991000
*                                      SUBCMD NAME TO MSG            */ 00992000
         MVC   OUTBUFF1(31),MSG0041                                0435 00993000
*   LNGBUF1=LNGMSG4A;               /* INITIALIZE 1ST LVL MSGLN M2051*/ 00994000
         MVC   LNGBUF1(2),LNGMSG4A                                 0436 00995000
*   NOMSGSG2=FOUR;                  /* INITIALIZE PTPB FOR 4 SEGMENTS   00996000
*                                      ON SECOND LVL MESSAGE         */ 00997000
         MVC   NOMSGSG2(4),@CF00049                                0437 00998000
*   MSGSEG2=ADDR(MSGIDHDR);         /* INITIALIZE POINTERS TO SEGMENT*/ 00999000
         LA    @10,MSGIDHDR                                        0438 01000000
         ST    @10,MSGSEG2                                         0438 01001000
*   MSGSEG2C=ADDR(MSG0042);         /* BLOCKS--THE MESSAGE ID, THE   */ 01002000
         LA    @10,MSG0042                                         0439 01003000
         ST    @10,MSGSEG2C                                        0439 01004000
*   MSGSEG2D=ADDR(RTCDESEG);        /* TEXT, AND THE RETURN CODE     */ 01005000
         LA    @10,RTCDESEG                                        0440 01006000
         ST    @10,MSGSEG2D                                        0440 01007000
*   RESPECIFY                                                      0441 01008000
*    (R1,                                                          0441 01009000
*     R4) RSTD;                     /* RESTRICT REGS FOR CONVERT     */ 01010000
*   R4=ADDR(TEXT);                  /* INITIALIZE REGISTER FOR       */ 01011000
         LA    R4,TEXT                                             0442 01012000
*   R1=ADDR(BUFR2)+EIGHT;           /* CONVERTING RETURN CODE        */ 01013000
         LA    R1,BUFR2                                            0443 01014000
         AH    R1,@CH00035                                         0443 01015000
*   GEN;                                                           0444 01016000
     XC 0(H16,R1),0(R1)              CLEAR AREA                         01017000
     CVD   R6,0(R1)                  CONVERT ERROR RETURN CODE TO       01018000
*                                    PACKED DECIMAL FORMAT              01019000
     UNPK  0(H5,R1),H6(H3,R1)        UNPACK RETURN CODE                 01020000
     MVC   0(H3,R4),0(R1)            MOVE TO MESSAGE SEGMENT            01021000
H16 EQU  16                          LENGTH OF TWENTY                   01022000
H5  EQU  5                           LENGTH OF FIVE                     01023000
H6  EQU  6                           DISPLACEMENT OF 6                  01024000
H3  EQU  3                           LENGTH OF THREE                    01025000
*   RESPECIFY                                                      0445 01026000
*    (R1,                                                          0445 01027000
*     R4) UNRSTD;                   /* FREE FOR COMPILER USAGE       */ 01028000
*   HEADER=RTCDE;                   /* MOVE SEGMENT HEADER FOR RETURN   01029000
*                                      CODE SEGMENT TO AREA          */ 01030000
         MVC   HEADER(4),RTCDE                                     0446 01031000
*   CALL PUTLRTN;                   /* GO TO PUTLINE SUBROUTINE      */ 01032000
         BAL   @14,PUTLRTN                                         0447 01033000
*   IOPLIOPB=ADDR(STPB);            /* ADDRESS OF STACK PARAMETER BLK*/ 01034000
         LA    @10,SRPARM                                          0448 01035000
         LA    @09,IOBLOCK                                         0448 01036000
         ST    @09,IOPLIOPB(,@10)                                  0448 01037000
*   STPB=STKL;                      /* MOVE STACK PARAMETERS         */ 01038000
         MVC   STPB(20,@09),STKL                                   0449 01039000
*   RESPECIFY                                                      0450 01040000
*    (R1,                                                          0450 01041000
*     R15) RSTD;                    /* RESTRICT REGS ACROSS STACK    */ 01042000
*   R1=ADDR(IOPL);                  /* ADDRESS IO SERVICE ROUTINES 0451 01043000
*                                      PARAMETER LIST                */ 01044000
         LR    R1,@10                                              0451 01045000
*   R15=PTRSTACK;                   /* ENTRY POINT OF STACK          */ 01046000
         L     R15,PTRSTACK                                        0452 01047000
*   GEN(STACK ENTRY=(15),MF=(E,(1)));/* RESET INPUT SOURCE TO THE  0453 01048000
*                                      TERMINAL                      */ 01049000
         STACK ENTRY=(15),MF=(E,(1))                                    01050000
*   RESPECIFY                                                      0454 01051000
*    (R1,                                                          0454 01052000
*     R15) UNRSTD;                  /* FREE REGS FOR COMPILER        */ 01053000
*   GEN(TCLEARQ INPUT);             /* CLEAR OUT ANY TYPED AHEAD   0455 01054000
*                                      INPUT FROM THE TERMINAL       */ 01055000
         TCLEARQ INPUT                                                  01056000
*   R6=TWELVE;                      /* ERROR RETURN CODE PASSED TO 0456 01057000
*                                      TMP INDICATING ERROR IN     0456 01058000
*                                      OPERATOR PROCESSING           */ 01059000
         LA    R6,12                                               0456 01060000
*   GO TO EXITA;                    /* GO TO RETURN TO TMP           */ 01061000
         B     EXITA                                               0457 01062000
*   GEN(EJECT);                                                    0458 01063000
*                                                                  0458 01064000
         EJECT                                                          01065000
*/*                                                                0459 01066000
*    ROUTINE 5 INITIALIZES THE ERROR MESSAGE FOR INVALID OPERANDS  0459 01067000
*    ON STOPMN, MONITOR, CANCEL, OR DISPLAY COMMANDS               0459 01068000
*      IKJ55005I INVALID OPERAND                                   0459 01069000
*                                                                    */ 01070000
*                                                                  0459 01071000
*MSGRTN5:                                                          0459 01072000
*   CALL CLEAR;                     /* CLEAR OUTPUT BUFFERS          */ 01073000
MSGRTN5  BAL   @14,CLEAR                                           0459 01074000
*   RESPECIFY                                                      0460 01075000
*    (R5) RSTD;                     /* RESTRICT REGISTER USAGE       */ 01076000
*   R5=AOPRND;                      /* POINT TO OPERAND IN BUFFER    */ 01077000
         L     R5,AOPRND                                           0461 01078000
*   OUTBUFF1(1:25)=MSG0051;         /* INITIALIZE BUFFER WITH 1ST  0462 01079000
*                                      LEVEL MESSAGE TEXT            */ 01080000
         MVC   OUTBUFF1(25),MSG0051                                0462 01081000
*   R6=LNGOPRND;                    /* CALCULATE LENGTH OF OPERAND   */ 01082000
         L     R6,LNGOPRND                                         0463 01083000
*   IF R6>BUFLEN-LNGMSG5A           /* IF LENGTH OF 1ST LEVEL MESSAGE   01084000
*                                      > ONE LINE (LENGTH OF BUFFER) */ 01085000
*     THEN                          /* INITIALIZE REGISTERS SUCH THAT*/ 01086000
         LA    @10,132                                             0464 01087000
         LH    @09,LNGMSG5A                                        0464 01088000
         LR    @07,@10                                             0464 01089000
         SLR   @07,@09                                             0464 01090000
         CR    R6,@07                                              0464 01091000
         BNH   @RF00464                                            0464 01092000
*     DO;                           /* ONLY 132 CHAR WILL BE MOVED 0465 01093000
*                                      INTO THE BUFFER               */ 01094000
*       RESPECIFY                                                  0466 01095000
*        (R4) RSTD;                 /* RESTRICT REGISTER USAGE       */ 01096000
*       R4=BUFLEN;                  /* TRUNCATE MESSAGE ATE LENGTH OF   01097000
*                                      BUFFER                        */ 01098000
         LR    R4,@10                                              0467 01099000
*       R6=MSGLEN-LNGMSG5A;         /* FOR INITIALIZATION OF LENGTH     01100000
*                                      OF                            */ 01101000
         LCR   @09,@09                                             0468 01102000
         AH    @09,@CH00426                                        0468 01103000
         LR    R6,@09                                              0468 01104000
*     END;                          /* BUFFER                        */ 01105000
*   ELSE                            /* CALCULATE OFFSET IN BUFFER FOR*/ 01106000
*     R4=R6+TWOSEVEN;               /* END OF OPERAND                */ 01107000
         B     @RC00464                                            0470 01108000
@RF00464 LA    R4,27                                               0470 01109000
         ALR   R4,R6                                               0470 01110000
*   OUTBUFF1(27:R4)=OPERAND(1:R6);  /* MOVE OPERAND INTO MSG TEXT    */ 01111000
@RC00464 LR    @10,R4                                              0471 01112000
         SH    @10,@CH00429                                        0471 01113000
         EX    @10,@SM01354                                        0471 01114000
*   OUTBUFF1(R4)=PLUSSIGN;          /* PUT PLUS SIGN AT END OF MSG TO   01115000
*                                      INDICATE 2ND LEVEL MSG EXISTS */ 01116000
         LA    @10,OUTBUFF1-1(R4)                                  0472 01117000
         MVC   0(1,@10),PLUSSIGN                                   0472 01118000
*   RESPECIFY                                                      0473 01119000
*    (R4,                                                          0473 01120000
*     R5) UNRSTD;                   /* FREE FOR COMPILER USAGE       */ 01121000
*   LNGBUF1=LNGMSG5A+R6;            /* INITIALIZE 1ST AND 2ND        */ 01122000
         LR    @10,R6                                              0474 01123000
         AH    @10,LNGMSG5A                                        0474 01124000
         STH   @10,LNGBUF1                                         0474 01125000
*   LNGBUF2=LNGMSG5B;               /* LEVEL MESSAGE LENGTH          */ 01126000
         MVC   LNGBUF2(2),LNGMSG5B                                 0475 01127000
*   OUTBUFF2(1:84)=MSG0052;         /* MOVE 2ND LVL MSG TEXT TO    0476 01128000
*                                      BUFFER                        */ 01129000
         MVC   OUTBUFF2(84),MSG0052                                0476 01130000
*   CALL PUTLRTN;                   /* GO TO PUTLINE SUBROUTINE      */ 01131000
         BAL   @14,PUTLRTN                                         0477 01132000
*   GO TO OPERABIL;                 /* GO TO GET ANOTHER LINE OF   0478 01133000
*                                      INPUT                         */ 01134000
         B     OPERABIL                                            0478 01135000
*   GEN(EJECT);                                                    0479 01136000
*                                                                  0479 01137000
         EJECT                                                          01138000
*/*                                                                0480 01139000
*    MESSAGES ISSUED WHEN OPERATOR SUBCOMMAND HAS NO OPERAND       0480 01140000
*      IKJ5006I MISSING OPERAND+                                   0480 01141000
*                                                                    */ 01142000
*                                                                  0480 01143000
*MSGRTN7:                                                          0480 01144000
*   CALL CLEAR;                     /* BLANK OUT MESSAGE BUFFERS     */ 01145000
MSGRTN7  BAL   @14,CLEAR                                           0480 01146000
*   OUTBUFF1(1:26)=MSG0061;         /* FIRST LEVEL MESSAGE           */ 01147000
         MVC   OUTBUFF1(26),MSG0061                                0481 01148000
*   OUTBUFF2(1:49)=MSG0062;         /* SECOND LEVEL MESSAGE          */ 01149000
         MVC   OUTBUFF2(49),MSG0062                                0482 01150000
*   LNGBUF1=LNGMSG6A;               /* INDICATE LENGTH OF MSG        */ 01151000
         MVC   LNGBUF1(2),LNGMSG6A                                 0483 01152000
*   LNGBUF2=LNGMSG6B;               /* INDICATE LENGTH OF MSG        */ 01153000
         MVC   LNGBUF2(2),LNGMSG6B                                 0484 01154000
*   CALL PUTLRTN;                   /* USE PUTLINE TO ISSUE MSG TO 0485 01155000
*                                      THE TERMINAL                  */ 01156000
         BAL   @14,PUTLRTN                                         0485 01157000
*   GO TO OPERABIL;                 /* GO GET ANOTHER COMMAND        */ 01158000
         B     OPERABIL                                            0486 01159000
*   GEN(EJECT);                                                    0487 01160000
*                                                                  0487 01161000
         EJECT                                                          01162000
*   /*****************************************************************/ 01163000
*   /*                                                               */ 01164000
*   /* THE FOLLOWING ROUTINE IS ENTERED WHEN A HELP COMMAND WAS      */ 01165000
*   /* ISSUED, REQUESTING ADDITIONAL INFORMATION. THE HELP CP IS     */ 01166000
*   /* ATTACHED                                                      */ 01167000
*   /*                                                               */ 01168000
*   /*****************************************************************/ 01169000
*                                                                  0488 01170000
*HELP:                                                             0488 01171000
*   RESPECIFY                                                      0488 01172000
*    (R4) RSTD;                     /* RESTRICT REG FOR ATTACH       */ 01173000
HELP     DS    0H                                                  0489 01174000
*   R4=ADDR(ATCHECB);               /* GET ADDR OF ATTACH ECB        */ 01175000
         LA    R4,ATCHECB                                          0489 01176000
*   ATTCHPRM=ATTCHPRM&&ATTCHPRM;    /* CLEAR ATTACH PARMLIST WO WA   */ 01177000
         XC    ATTCHPRM(60),ATTCHPRM                               0490 01178000
*   CPPLCBUF=ADDR(CMDBUFFR);        /* INITIALIZE CPPL WITH PTR TO 0491 01179000
*                                      OPERATOR'S COMMAND BUFFER     */ 01180000
         L     @10,SAVECPPL                                        0491 01181000
         MVC   CPPLCBUF(4,@10),WORK7                               0491 01182000
*   ATCHECB=ZEROS;                  /* CLEAR ATTACH ECB              */ 01183000
         MVC   ATCHECB(4),ZEROS                                    0492 01184000
*   RESPECIFY                                                      0493 01185000
*    (R5,                                                          0493 01186000
*     R1,                                                          0493 01187000
*     R15) RSTD;                    /* RESTRICT REGS FOR ATTACH      */ 01188000
*   R5=ADDR(EXITPARM);              /* POINT TO EXIT PARM LIST       */ 01189000
         LA    R5,EXITPARM                                         0494 01190000
*   R6=ADDR(IKJEE1A2);              /* ADDRESS OF THE STAE ROUTINE   */ 01191000
         L     R6,@CV00382                                         0495 01192000
*   R1=SAVECPPL;                    /* POINT TO CPPL                 */ 01193000
         LR    R1,@10                                              0496 01194000
*   R15=ADDR(ATTCHPRM);             /* POINT TO ATTACH PARMLIST      */ 01195000
         LA    R15,ATTCHPRM                                        0497 01196000
*   GEN;                                                           0498 01197000
     ATTACH EP=HELP,ECB=(4),STAI=((R6),(5)),SHSPV=78,SF=(E,(15))        01198000
*   R6=R15;                         /* SAVE THE RETURN CODE          */ 01199000
         LR    R6,R15                                              0499 01200000
*   WORK3=R1;                       /* SAVE ATTACH TCB PTR           */ 01201000
         ST    R1,WORK3                                            0500 01202000
*   RESPECIFY                                                      0501 01203000
*    (R1,                                                          0501 01204000
*     R15) UNRSTD;                  /* FREE FOR THE COMPILER         */ 01205000
*   IF R6^=ZEROS                    /* INVALID RETURN CODE?          */ 01206000
*     THEN                          /* YES,                          */ 01207000
         C     R6,ZEROS                                            0502 01208000
         BE    @RF00502                                            0502 01209000
*     DO;                           /* PUT OUT GENERALIZED ERROR MSG */ 01210000
*       MSGSEG2B=ADDR(STAISEG);     /* INDICATE TYPE FOR 2ND LEVEL   */ 01211000
         LA    @10,STAISEG                                         0504 01212000
         ST    @10,MSGSEG2B                                        0504 01213000
*       GO TO MSGRTN4;              /* PUT OUT ERROR MESSAGE         */ 01214000
         B     MSGRTN4                                             0505 01215000
*     END;                          /* END MSG PROCESSING            */ 01216000
*   GEN(WAIT ECB=(4));              /* WAIT FOR HELP CP TO COMPLETE  */ 01217000
@RF00502 DS    0H                                                  0507 01218000
         WAIT ECB=(4)                                                   01219000
*   RESPECIFY                                                      0508 01220000
*    (R4) UNRSTD;                   /* FREE FOR COMPILER USAGE       */ 01221000
*   IF ECBCC=ZEROS                  /* SUBTASK WAS SUCCESSFUL?       */ 01222000
*     THEN                          /* YES,                          */ 01223000
         L     @10,ECBCC-1                                         0509 01224000
         LA    @10,0(,@10)                                         0509 01225000
         C     @10,ZEROS                                           0509 01226000
         BNE   @RF00509                                            0509 01227000
*     DO;                           /* DETACH IT                     */ 01228000
*       RESPECIFY                                                  0511 01229000
*        (R1) RSTD;                 /* RESTRICT REG FOR DETACH       */ 01230000
*       R1=ADDR(WORK3);             /* GET HELP TCB ADDR             */ 01231000
         LA    R1,WORK3                                            0512 01232000
*       GEN(DETACH (1));            /* DETACH THE HELP TCB           */ 01233000
         DETACH (1)                                                     01234000
*       RESPECIFY                                                  0514 01235000
*        (R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */ 01236000
*     END;                          /* END DETACH PROCESSING         */ 01237000
*/*                                                                0516 01238000
*    INVOKE THE DAIR SERVICE ROUTINE TO MARK ANY DATA SETS         0516 01239000
*    ALLOCATED BY HELP AS ALLOCATABLE BEFORE DETACHING IT.         0516 01240000
*                                                                    */ 01241000
*                                                                  0516 01242000
*   DAPLPSCB=CPPLPSCB;              /* PUT PSCB ADDR IN PARMLIST     */ 01243000
@RF00509 LA    @10,SRPARM                                          0516 01244000
         L     @09,SAVECPPL                                        0516 01245000
         MVC   DAPLPSCB(4,@10),CPPLPSCB(@09)                       0516 01246000
*   DAPLDAPB=ADDR(DAIRPARM);        /* LINK 2C BLOCK TO DAIR PARM  0517 01247000
*                                      LIST                          */ 01248000
         LA    @09,DAIRPARM                                        0517 01249000
         ST    @09,DAPLDAPB(,@10)                                  0517 01250000
*   DA2CFLG='0000'X;                /* SET FLAG FIELD TO ZERO        */ 01251000
         SLR   @07,@07                                             0518 01252000
         STH   @07,DA2CFLG(,@09)                                   0518 01253000
*   DA2CCD='002C'X;                 /* INDICATE CODE 2C              */ 01254000
         MVC   DA2CCD(2,@09),@CB01310                              0519 01255000
*   DA2CTCB=WORK3;                  /* GET HELP TCB ADDR             */ 01256000
         MVC   DA2CTCB(4,@09),WORK3                                0520 01257000
*   RESPECIFY                                                      0521 01258000
*    (R1,                                                          0521 01259000
*     R15) RSTD;                    /* RESTRICT REGS ACROSS DAIR     */ 01260000
*   R1=ADDR(SRPARM);                /* OBTAIN DAIR'S PARAMETER LIST  */ 01261000
         LR    R1,@10                                              0522 01262000
*   GEN(LINK EP=IKJEFD00);          /* LINK TO DAIR                  */ 01263000
         LINK EP=IKJEFD00                                               01264000
*   R6=R15;                         /* SAVE THE DAIR RETURN CODE     */ 01265000
         LR    R6,R15                                              0524 01266000
*   RESPECIFY                                                      0525 01267000
*    (R1,                                                          0525 01268000
*     R15) UNRSTD;                  /* FREE FOR COMPILER             */ 01269000
*   IF R6^=ZEROS                    /* CHECK RETURN CODE FOR       0526 01270000
*                                      SUCCESSFUL COMPLETION         */ 01271000
*     THEN                          /* NON SUCCESSFUL DAIR RETURN  0526 01272000
*                                      CODE                          */ 01273000
         C     R6,ZEROS                                            0526 01274000
         BE    @RF00526                                            0526 01275000
*     DO;                           /* PUT OUT GENERALIZED MESSAGE   */ 01276000
*       MSGSEG2B=ADDR(DAIRSEG);     /* INITIALIZE POINTER TO DAIR  0528 01277000
*                                      MESSAGE SEGMENT FOR ERROR MSG */ 01278000
         LA    @10,DAIRSEG                                         0528 01279000
         ST    @10,MSGSEG2B                                        0528 01280000
*       GO TO MSGRTN4;              /* GO TO ERROR MSG RTN           */ 01281000
         B     MSGRTN4                                             0529 01282000
*     END;                          /* END OF DAIR FAILING PROCESSING*/ 01283000
*   IF ECBBIT1='1'B                 /* CHECK IF ATTN OCCURED         */ 01284000
*     THEN                          /* YES,                          */ 01285000
@RF00526 TM    ECBBIT1,B'01000000'                                 0531 01286000
         BO    @RT00531                                            0531 01287000
*     GO TO ATTN;                   /* GO TO PROCESS NEW COMMAND     */ 01288000
*   GO TO OPERABIL;                 /* GO TO GET ANOTHER LINE OF   0533 01289000
*                                      INPUT                         */ 01290000
         B     OPERABIL                                            0533 01291000
*   GEN(EJECT);                                                    0534 01292000
*                                                                  0534 01293000
         EJECT                                                          01294000
*   /*****************************************************************/ 01295000
*   /*                                                               */ 01296000
*   /* LEAVING OPERATOR MODE - CLEAN-UP TIME . TURN OFF ALL MONITOR  */ 01297000
*   /* BITS BY CALLING ENDRTN . FREE ANY GETMAIND BUFFER BY CALLING  */ 01298000
*   /* ENDRTN . TURN OFF THE EXTRA BUFFER BIT IN THE TSB . DELETE ANY*/ 01299000
*   /* LOADED SERVICE ROUTINES . RETURN TO THE TMP WITH RETURN CODE  */ 01300000
*   /* IN REGISTER 15                                                */ 01301000
*   /*                                                               */ 01302000
*   /*****************************************************************/ 01303000
*                                                                  0535 01304000
*EXITA:                                                            0535 01305000
*   IF EXITERR='0'B THEN            /* HAS USER BEEN THROUGH ENDRTN? */ 01306000
EXITA    TM    EXITERR,B'00100000'                                 0535 01307000
         BNZ   @RF00535                                            0535 01308000
*     CALL ENDRTN;                  /* GENERALIZED END PROCESSING    */ 01309000
         BAL   @14,ENDRTN                                          0536 01310000
*   GEN;                                                           0537 01311000
@RF00535 DS    0H                                                  0537 01312000
*                                  /* DELETE THE I/O SERVICE ROUTINES*/ 01313000
     DELETE EP=IKJPUTL                                                  01314000
     DELETE EP=IKJPTGT                                                  01315000
     DELETE EP=IKJSTCK                                                  01316000
     DELETE EP=IKJGETL                                                  01317000
     STAE  0                                               @ZA08125     01318000
*   RETURN CODE(R6);                /* RETURN TO TMP         @ZA08115*/ 01319000
         L     @13,4(,@13)                                         0538 01320000
         L     @00,@SIZDATD                                        0538 01321000
         LR    @01,@12                                             0538 01322000
         FREEMAIN R,LV=(0),A=(1)                                        01323000
         LR    @15,@06                                             0538 01324000
         L     @14,12(,@13)                                        0538 01325000
         LM    @00,@12,20(@13)                                     0538 01326000
         BR    @14                                                 0538 01327000
*   GEN(EJECT);                                                    0539 01328000
*                                                                  0539 01329000
         EJECT                                                          01330000
*   /*****************************************************************/ 01331000
*   /*                                                               */ 01332000
*   /* ROUTINE USED TO CALL ENDRTN FROM OPERATOR STAE ROUTINE        */ 01333000
*   /*                                                               */ 01334000
*   /*****************************************************************/ 01335000
*                                                                  0540 01336000
*ENDRN:                             /* ROUTINE TO CALL ENDRTN        */ 01337000
*   RESPECIFY                                                      0540 01338000
*    (R14) RSTD;                    /* RESTRICT RETURN ADDR REG      */ 01339000
ENDRN    DS    0H                                                  0541 01340000
*   SVER14=R14;                     /* RETURN ADDRESS TO THE CALLER  */ 01341000
         ST    R14,SVER14                                          0541 01342000
*   RESPECIFY                                                      0542 01343000
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 01344000
*   CALL ENDRTN;                    /* CALL ENDROUTINE               */ 01345000
         BAL   @14,ENDRTN                                          0543 01346000
*   RESPECIFY                                                      0544 01347000
*    (R14) RSTD;                    /* RESTRICT RETURN ADDR REG      */ 01348000
*   R14=SVER14;                     /* RESTORE RETURN ADDRESS        */ 01349000
         L     R14,SVER14                                          0545 01350000
*   RETURN;                         /* RETURN TO CALLER              */ 01351000
@EL00001 L     @13,4(,@13)                                         0546 01352000
@EF00001 L     @00,@SIZDATD                                        0546 01353000
         LR    @01,@12                                             0546 01354000
         FREEMAIN R,LV=(0),A=(1)                                        01355000
@ER00001 L     @14,12(,@13)                                        0546 01356000
         LM    @00,@12,20(@13)                                     0546 01357000
         BR    @14                                                 0546 01358000
*   RESPECIFY                                                      0547 01359000
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 01360000
*   GEN(EJECT);                                                    0548 01361000
*                                                                  0548 01362000
         EJECT                                                          01363000
*   /*****************************************************************/ 01364000
*   /*                                                               */ 01365000
*   /* STAE RETRY ROUTINE R1 = ADDR OF STAE WORKAREA OFFSET 0 - STAE */ 01366000
*   /* EXIT ROUTINE PARMLIST CONTAINING ADDR TO WORKAREA AND ADDR OF */ 01367000
*   /* PARMLST IN STAE EXIT ROUTINE PARAMETER LIST . OFFSET 56 - BASE*/ 01368000
*   /* REGISTER TO IKJEE100 . OFFSET 60 - ADDRESSIBILITY TO WORKAREA */ 01369000
*   /*                                                               */ 01370000
*   /*****************************************************************/ 01371000
*                                                                  0549 01372000
*IKJEE101:                                                         0549 01373000
*   RESPECIFY                                                      0549 01374000
*    (R0,                                                          0549 01375000
*     R1,                                                          0549 01376000
*     R13) RSTD;                    /* RESTRICT REGISTER USAGE       */ 01377000
IKJEE101 DS    0H                                                  0550 01378000
*   GEN;                                                           0550 01379000
     L     R4,0(R1)                 ESTABLISH ADDR. TO PARLIST          01380000
     L     R8,52(R4)                RESTORE DATA BASE REGISTER          01381000
     LM    R11,R12,56(R4)           RESTORE BASE REG AND ADDRESSIBILITY 01382000
*                                   TO WORKAREA                         01383000
H52 EQU  52                         DISPLACEMENT OF 52                  01384000
H56 EQU  56                         DISPLACEMENT OF 56                  01385000
*   R13=SAVE13;                     /* RESTORE REGISTER 13           */ 01386000
         L     R13,SAVE13                                          0551 01387000
*   R0=CIV;                         /* LENGTH OF STAE W/A TO BE FREED*/ 01388000
*                                                                  0552 01389000
         LA    R0,104                                              0552 01390000
*   /*****************************************************************/ 01391000
*   /*                                                               */ 01392000
*   /* R1 CONTAINS ADDR OF AREA                                      */ 01393000
*   /*                                                               */ 01394000
*   /*****************************************************************/ 01395000
*                                                                  0553 01396000
*   GEN(FREEMAIN R,LV=(0),A=(1));   /* ISSUE FREEMIAN                */ 01397000
         FREEMAIN R,LV=(0),A=(1)                                        01398000
*   RESPECIFY                                                      0554 01399000
*    (R0,                                                          0554 01400000
*     R1,                                                          0554 01401000
*     R13) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 01402000
*   GO TO BEGNAGAN;                 /* RETURN TO MAINLINE            */ 01403000
         B     BEGNAGAN                                            0555 01404000
*   GEN(EJECT);                                                    0556 01405000
*                                                                  0556 01406000
         EJECT                                                          01407000
*   /*****************************************************************/ 01408000
*   /*                                                               */ 01409000
*   /* THE FOLLOWING MACROS GENERATE THE PARAMETER LISTS FOR THE I/O */ 01410000
*   /* ROUTINES - GETLINE, PUTLINE, PUTGET MACRO OPTION MEANING      */ 01411000
*   /* GETLINE ISTACK INPUT LINE TO BE OBTAINED FROM CURRENTLY ACTIVE*/ 01412000
*   /* INPUT SOURCE LOGICAL LOGICAL INPUT LINE TO BE OBTAINED EDIT   */ 01413000
*   /* ADDITIONAL EDITING ON LINE WAIT IWAIT IF INPUT BUFFER NOT     */ 01414000
*   /* AVAILABLE PUTLINE TERM OUTPUT LINE PUT TO TERMINAL MULTLVL    */ 01415000
*   /* OUTPUT LINE IS OF MULTIPLE LEVEL INFOR OUTPUT LINE IS AN      */ 01416000
*   /* INFORMATIONAL MSG EDIT SAME WAIT OWAIT IF OUTPUT BUFFERS NOT  */ 01417000
*   /* AVAILABLE NOHOLD PROCESSING CONTINUES FOLLOWING THE PLACING OF*/ 01418000
*   /* OUTPUT ON OUTPUT QUEUE NO BREAK INPUT HAS PRECEDENCE OVER     */ 01419000
*   /* OUTPUT,I.E. MSG IS PLACED ON OUTPUT QUEUE TO BE PRINTED WHEN  */ 01420000
*   /* USER IS NOT ENTERING A LINE PUTGET SINGLE OUTPUT LINE IS OF   */ 01421000
*   /* SINGLE LINE MODE OUTPUT LINE IS A MODE MESSAGE                */ 01422000
*   /* TERMPUT=(EDIT,WAIT,NOHOLD,NOBREAK) EXPLAINED UNDER PUTLINE    */ 01423000
*   /* TERMGET=(EDIT,WAIT) EXPLAINED UNDER GETLINE                   */ 01424000
*   /*                                                               */ 01425000
*   /*****************************************************************/ 01426000
*                                                                  0557 01427000
*   GEN;                                                           0557 01428000
PUTLIST1 PUTLINE ,MF=L                                                  01429000
PGLIST   PUTGET ,MF=L                                                   01430000
         EXTRN IKJEE1A0                                                 01431000
STAELST  STAE IKJEE1A0,MF=L                                             01432000
STAXL    STAX 0,MF=L                                                    01433000
STKL     STACK DELETE=ALL,MF=L                                          01434000
*   GEN(EJECT);                                                    0558 01435000
*                                                                  0558 01436000
         EJECT                                                          01437000
*   /*****************************************************************/ 01438000
*   /*                                                               */ 01439000
*   /* THE FOLLOWING ROUTINE GETS CONTROL WHEN AN ATTN EXIT IS TAKEN */ 01440000
*   /* AND A NEW COMMAND IS ENTERED TO SUPERCEDE THE CURRENT COMMAND.*/ 01441000
*   /* THE CPECB WAS POSTED BY THE ATTN EXIT ROUTINE. THE POINTERS TO*/ 01442000
*   /* THE COMMAND BUFFER AND COMMAND SCAN OUTPUT AREA ARE ADJUSTED  */ 01443000
*   /* TO THE DATA FOR THE NEW COMMAND. PROCESSING FOR THE NEW       */ 01444000
*   /* COMMAND BEGINS AT CHECKING THE OUTPUT FROM COMMAND SCAN       */ 01445000
*   /*                                                               */ 01446000
*   /*****************************************************************/ 01447000
*                                                                  0559 01448000
*ATTN:                                                             0559 01449000
*   CPECB=ZEROS;                    /* CLEAR OPERATOR CP'S ECB       */ 01450000
ATTN     MVC   CPECB(4),ZEROS                                      0559 01451000
*   WORK7=PTRWORK7;                 /* ADJUST PTR TO COMMAND BUFFER  */ 01452000
         MVC   WORK7(4),PTRWORK7                                   0560 01453000
*   CSOAPTR=PTRSCAN;                /* ADJUST PTR TO CMD SCAN OUTPUT    01454000
*                                      AREA                          */ 01455000
         MVC   CSOAPTR(4),PTRSCAN                                  0561 01456000
*   GO TO SCANTEST;                 /* PROCESS NEW COMMAND           */ 01457000
         B     SCANTEST                                            0562 01458000
*                                                                  0563 01459000
*/********************************************************************/ 01460000
*/*  ROUTINE TO CALCULATE LENGTH OF OPERAND ON MONITOR, STOPMN,      */ 01461000
*/*  CANCEL, OR DISPLAY COMMANDS AND THEN TRANSLATE THE OPERAND      */ 01462000
*/*  TO UPPER CASE.                                                  */ 01463000
*/********************************************************************/ 01464000
*                                                                  0563 01465000
*   GEN(EJECT);                                                    0563 01466000
         EJECT                                                          01467000
*CLNGOP:                                                           0564 01468000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* PROC TO CAL LENGTH          */ 01469000
         B     @PB00002                                            0564 01470000
CLNGOP   DS    0H                                                  0565 01471000
*   RFY                                                            0565 01472000
*    (R4,                                                          0565 01473000
*     R5) RSTD;                     /* RESTRICT INPUT/OUTPUT       0565 01474000
*                                      REGISTERS                     */ 01475000
*LOOPSRCH:                                                         0566 01476000
*   IF OPERAND(1)=BLANK             /* IF NEXT CHARACTER IS BLANK    */ 01477000
*     THEN                          /* SCAN COMPLETE, GO TO TRANSLATE   01478000
*                                      OPERAND TO UPPER CASE         */ 01479000
LOOPSRCH CLC   OPERAND(1,R5),BLANK                                 0566 01480000
         BNE   @RF00566                                            0566 01481000
*     DO;                                                          0567 01482000
*       LNGOPRND=R6;                /* GET LENGTH OF OPERAND         */ 01483000
         ST    R6,LNGOPRND                                         0568 01484000
*       R6=R6-UNO;                  /* DECREMENT FOR EXECUTE         */ 01485000
         BCTR  R6,0                                                0569 01486000
*       RESPECIFY                                                  0570 01487000
*        (R1) RSTD;                 /* RESTRICT REG 1 USAGE          */ 01488000
*       R1=AOPRND;                  /* POINT TO BEGINNING OF OPERAND */ 01489000
         L     R1,AOPRND                                           0571 01490000
*       GEN;                                                       0572 01491000
           EX R6,EXTRNSLT           EXECUTE TRANSLATE INSTR             01492000
*       RESPECIFY                                                  0573 01493000
*        (R1) UNRSTD;               /* FREE REG FOR COMPILER         */ 01494000
*       RETURN;                     /* RETURN TO CALLING ROUTINE     */ 01495000
@EL00002 DS    0H                                                  0574 01496000
@EF00002 DS    0H                                                  0574 01497000
@ER00002 BR    @14                                                 0574 01498000
*     END;                                                         0575 01499000
*   ELSE                            /* NON BLANK OPERAND             */ 01500000
*     DO;                                                          0576 01501000
@RF00566 DS    0H                                                  0577 01502000
*       R6=R6+UNO;                  /* INCREMENT POINTER IN BUFFER   */ 01503000
         LA    @10,1                                               0577 01504000
         ALR   R6,@10                                              0577 01505000
*       R5=R5+UNO;                  /* INCREMENT LENGTH OF OPERAND   */ 01506000
         ALR   R5,@10                                              0578 01507000
*       GO TO LOOPSRCH;             /* CONTINUE LOOPING              */ 01508000
         B     LOOPSRCH                                            0579 01509000
*     END;                                                         0580 01510000
*   RFY                                                            0581 01511000
*    (R4,                                                          0581 01512000
*     R5) UNRSTD;                   /* FREE INPUT/OUTPUT REGISTERS   */ 01513000
*   GENERATE;                                                      0582 01514000
EXTRNSLT TR   0(*-*,R1),UPPERTAB    TO CONVERT TO UPPERTABP             01515000
*   END CLNGOP;                                                    0583 01516000
         B     @EL00002                                            0583 01517000
@PB00002 DS    0H                                                  0584 01518000
*   GEN(EJECT);                                                    0584 01519000
*                                                                  0584 01520000
         EJECT                                                          01521000
*/********************************************************************/ 01522000
*/*  THE FOLLOWING ROUTINE PROCESSES THE END COMMAND, A REQUEST      */ 01523000
*/*  TO TERMINATE OPERATOR MODE.  ANY ACTIVE MONITOR FUNCTIONS       */ 01524000
*/*  ARE STOPPED AND CONTROL RETURNS TO THE TMP WITH A RETURN        */ 01525000
*/*  CODE OF 0 IN REGISTER 15.  ANY OUTSTANDING CMD BUFFERS MUST     */ 01526000
*/*  BE FREED BEFORE GIVING UP CONTROL AND RETURNING.                */ 01527000
*/********************************************************************/ 01528000
*                                                                  0585 01529000
*ENDRTN:                                                           0585 01530000
*   PROC OPTIONS(NOSAVEAREA);       /* END ROUTINE PROCEDURE         */ 01531000
         B     @PB00003                                            0585 01532000
ENDRTN   STM   @14,@12,12(@13)                                     0585 01533000
*   RESPECIFY                                                      0586 01534000
*    (R6,                                                          0586 01535000
*     R8) RESTRICTED;                                              0586 01536000
*   IF BUFFPTR^=ZEROS               /* DOES IKJEE100 HAVE BUFFER TO     01537000
*                                      BE FREED?                     */ 01538000
*     THEN                          /* YES,                          */ 01539000
         L     @10,BUFFPTR                                         0587 01540000
         C     @10,ZEROS                                           0587 01541000
         BE    @RF00587                                            0587 01542000
*     DO;                                                          0588 01543000
*       WORK1=SUBPOOL1;             /* PUT SUBPOOL NUMBER IN HIGH  0589 01544000
*                                      ORDER BYTE                    */ 01545000
         MVC   WORK1(4),SUBPOOL1                                   0589 01546000
*       WORK1(3:4)=BUFFAREA(1:2);   /* GET LENGTH TO BE FREED        */ 01547000
         MVC   WORK1+2(2),BUFFAREA(@10)                            0590 01548000
*       RESPECIFY                                                  0591 01549000
*        (R0,                                                      0591 01550000
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */ 01551000
*       R0=WORK1;                                                  0592 01552000
         L     R0,WORK1                                            0592 01553000
*       R1=BUFFPTR;                 /* GET ADDRESS OF AREA           */ 01554000
         LR    R1,@10                                              0593 01555000
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE THE BUFFER AREA         */ 01556000
         FREEMAIN R,LV=(0),A=(1)                                        01557000
*       RESPECIFY                                                  0595 01558000
*        (R0,                                                      0595 01559000
*         R1) UNRSTD;               /* FREE REGS FOR COMPILER USAGE  */ 01560000
*       BUFFPTR=ZEROS;              /* NO BUFFER TO BE FREED         */ 01561000
         MVC   BUFFPTR(4),ZEROS                                    0596 01562000
*     END;                                                         0597 01563000
*   IF ATTNBUFF^=ZEROS              /* DOES STAE HAVE CMD BUFFER TO     01564000
*                                      BE FREED?                     */ 01565000
*     THEN                          /* YES, IT HAS ONE TO BE FREED   */ 01566000
@RF00587 L     @10,ATTNBUFF                                        0598 01567000
         C     @10,ZEROS                                           0598 01568000
         BE    @RF00598                                            0598 01569000
*     DO;                                                          0599 01570000
*       WORK1=SUBPOOL1;             /* PUT SUBPOOL NUMBER IN HIGH  0600 01571000
*                                      ORDER BYTE                    */ 01572000
         MVC   WORK1(4),SUBPOOL1                                   0600 01573000
*       RESPECIFY                                                  0601 01574000
*        (R0,                                                      0601 01575000
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */ 01576000
*       R1=ATTNBUFF;                /* GET ADDRESS OF AREA TO BE   0602 01577000
*                                      FREED                         */ 01578000
         LR    R1,@10                                              0602 01579000
*       GEN(MVC WORK1+2(2),0(R1));  /* UPDATE LENGTH TO BE FREED     */ 01580000
         MVC WORK1+2(2),0(R1)                                           01581000
*       R0=WORK1;                                                  0604 01582000
         L     R0,WORK1                                            0604 01583000
*       GEN(FREEMAIN R,LV=(0),A=(1));                              0605 01584000
         FREEMAIN R,LV=(0),A=(1)                                        01585000
*       RESPECIFY                                                  0606 01586000
*        (R0,                                                      0606 01587000
*         R1) UNRSTD;               /* FREE REGS FOR CONPILER USAGE  */ 01588000
*       ATTNBUFF=ZEROS;             /* ATTN HAS NO MORE COMMAND    0607 01589000
*                                      BUFFERS OUTSTANDING           */ 01590000
         MVC   ATTNBUFF(4),ZEROS                                   0607 01591000
*     END;                                                         0608 01592000
*   RESPECIFY                                                      0609 01593000
*    (R4,                                                          0609 01594000
*     R5) RESTRICTED;                                              0609 01595000
@RF00598 DS    0H                                                  0610 01596000
*   IF FSTFLG='1'B                  /* WHEN EXTRA BUFFERS INDICATOR  */ 01597000
*     THEN                          /* IN TSB IS ON                  */ 01598000
         TM    FSTFLG,B'00001000'                                  0610 01599000
         BNO   @RF00610                                            0610 01600000
*     DO;                           /* YES, IT IS ON SO:             */ 01601000
*       OFFGETBF='1'B;              /* SET FLAG IN CALLPARM FOR SVC     01602000
*                                      100 TO TURN IT OFF            */ 01603000
*       AUTHCHK='0'B;               /* CALL IS NOT FOR AUTHORITY CK  */ 01604000
         OI    OFFGETBF,B'00010000'                                0613 01605000
         NI    AUTHCHK,B'01111111'                                 0613 01606000
*       RESPECIFY                                                  0614 01607000
*        (R1,                                                      0614 01608000
*         R15) RSTD;                /* RESTRICT ACROSS SVC           */ 01609000
*       R1=ADDR(FIBMAINP);          /* POINT TO PARAMETER LIST       */ 01610000
         LA    R1,FIBMAINP                                         0615 01611000
*       SVC(100);                   /* SVC FOR FIB, PROF AND OPER TSO   01612000
*                                      COMMANDS....IKJEFFS0 PL/S   0616 01613000
*                                      MACRO                         */ 01614000
         SVC   100                                                 0616 01615000
*       R6=R15;                     /* SAVE RETURN CODE IN R6        */ 01616000
         LR    R6,R15                                              0617 01617000
*       RESPECIFY                                                  0618 01618000
*        (R1,                                                      0618 01619000
*         R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */ 01620000
*       IF R6^=FIBOKRC THEN         /* WAS SVC 100 SUCCESSFUL ?      */ 01621000
         LTR   R6,R6                                               0619 01622000
         BZ    @RF00619                                            0619 01623000
*         DO;                       /* THE SVC WAS UNSUCCESSFUL      */ 01624000
*           IF ECTATRM='1'B         /* TEST IF END RTN RECEIVED    0621 01625000
*                                      CONTROL FROM STAE ON DETACH 0621 01626000
*                                      FROM TMP                      */ 01627000
*             THEN                  /* YES, AND SVC 100 UNSUCCESSFUL,*/ 01628000
         L     @10,SAVECPPL                                        0621 01629000
         L     @10,ECTPTR(,@10)                                    0621 01630000
         TM    ECTATRM(@10),B'00100000'                            0621 01631000
         BO    @RT00621                                            0621 01632000
*             RETURN;               /* RETURN TO STAE TO TERMINATE   */ 01633000
*           ELSE                    /* NO, BUT SVC 100 UNSUCCESSFUL, */ 01634000
*             DO;                   /* PREPARE TO PUT OUT MESSAGE    */ 01635000
*               MSGSEG2B=ADDR(SVC100SG);/* POINT TO MESSAGE SEGMENT  */ 01636000
         LA    @10,SVC100SG                                        0624 01637000
         ST    @10,MSGSEG2B                                        0624 01638000
*               EXITERR='1'B;       /* DO NOT ENTER ENDRTN AGAIN     */ 01639000
         OI    EXITERR,B'00100000'                                 0625 01640000
*               GO TO MSGRTN4;      /* GO PUT OUT ERROR MESSAGE      */ 01641000
         B     MSGRTN4                                             0626 01642000
*             END;                                                 0627 01643000
*         END;                      /* END UNSUCCESSFUL PROCESSING   */ 01644000
*     END;                          /* END OF GETBF BIT ON PROCESSING*/ 01645000
*   RETURN;                         /* RETURN TO CALLER              */ 01646000
@EL00003 DS    0H                                                  0630 01647000
@EF00003 DS    0H                                                  0630 01648000
@ER00003 LM    @14,@12,12(@13)                                     0630 01649000
         BR    @14                                                 0630 01650000
*   END ENDRTN;                                                    0631 01651000
         B     @EL00003                                            0631 01652000
@PB00003 DS    0H                                                  0632 01653000
*   GEN(EJECT);                                                    0632 01654000
*                                                                  0632 01655000
         EJECT                                                          01656000
*/********************************************************************/ 01657000
*/*                                                                  */ 01658000
*/*  PROCEDURE TO PUT A LINE TO TERMINAL                             */ 01659000
*/*                                                                  */ 01660000
*/********************************************************************/ 01661000
*                                                                  0633 01662000
*PUTLRTN:                                                          0633 01663000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* PUTLINE ROUTINE             */ 01664000
         B     @PB00004                                            0633 01665000
PUTLRTN  DS    0H                                                  0634 01666000
*   RESPECIFY                                                      0634 01667000
*    (R4,                                                          0634 01668000
*     R5,                                                          0634 01669000
*     R6,                                                          0634 01670000
*     R8,                                                          0634 01671000
*     R14) RESTRICTED;                                             0634 01672000
*   SAVE14=R14;                     /* SAVE THE RETURN ADDRESS       */ 01673000
         ST    R14,SAVE14                                          0635 01674000
*   RESPECIFY                                                      0636 01675000
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 01676000
*   IOPLIOPB=ADDR(IOBLOCK);         /* ADDR OF PUTLINE BLOCK         */ 01677000
         LA    @10,SRPARM                                          0637 01678000
         LA    @09,IOBLOCK                                         0637 01679000
         ST    @09,IOPLIOPB(,@10)                                  0637 01680000
*   PTPB(1:12)=PUTLIST1;            /* CLEAR PUTLINE PARM BLOCK      */ 01681000
         MVC   PTPB(12,@09),PUTLIST1                               0638 01682000
*   LNGOFF1=ZEROS;                  /* CLEAR MSG1 OFFSET FIELD       */ 01683000
         L     @09,ZEROS                                           0639 01684000
         STH   @09,LNGOFF1                                         0639 01685000
*   LNGOFF2=ZEROS;                  /* CLEAR MSG2 OFFSET FIELD       */ 01686000
         STH   @09,LNGOFF2                                         0640 01687000
*   R5=ADDR(NXTLVMSG);              /* ADDRESS OUTPUT DESCRIPTOR     */ 01688000
         LA    R5,NXTLVMSG                                         0641 01689000
*   RESPECIFY                                                      0642 01690000
*    (R1,                                                          0642 01691000
*     R15) RSTD;                    /* RESTRICT REGS ACROSS MACRO    */ 01692000
*   R1=ADDR(SRPARM);                /* GET PARM LIST ADDR            */ 01693000
         LR    R1,@10                                              0643 01694000
*   R15=WORK6;                      /* GET PUTLINE ADDRESS           */ 01695000
         L     R15,WORK6                                           0644 01696000
*/*                                                                0645 01697000
*    USE PUTLINE TO ISSUE FIRST LEVEL MSG                          0645 01698000
*                                                                    */ 01699000
*                                                                  0645 01700000
*   GEN(PUTLINE OUTPUT=((5),MULTLVL),ENTRY=(15),MF=(E,(1)));       0645 01701000
*                                                                  0645 01702000
         PUTLINE OUTPUT=((5),MULTLVL),ENTRY=(15),MF=(E,(1))             01703000
*/*                                                                0646 01704000
*    TEST RETURN CODES OF PUTLINE                                  0646 01705000
*      00 - SUCCESSFUL COMPLETION                                  0646 01706000
*      04 - PROCESSING INTERRUPTED BY ATTENTION                    0646 01707000
*      08 - NOWAIT SPECIFIED - OUTPUT NOT SENT                     0646 01708000
*      12 - INVALID PARAMETERS                                     0646 01709000
*      16 - NO SPACE AVAILABLE (GETMAIN FAILURE)                   0646 01710000
*                                                                    */ 01711000
*                                                                  0646 01712000
*   R6=R15;                         /* SAVE RETURN CODE FOR TESTING  */ 01713000
         LR    R6,R15                                              0646 01714000
*   RESPECIFY                                                      0647 01715000
*    (R1,                                                          0647 01716000
*     R15) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 01717000
*   IF R6=ZEROS                     /* WAS PUTLINE SUCCESSFUL?       */ 01718000
*     THEN                          /* YES,                          */ 01719000
         C     R6,ZEROS                                            0648 01720000
         BNE   @RF00648                                            0648 01721000
*     DO;                                                          0649 01722000
*       RESPECIFY                                                  0650 01723000
*        (R14) RSTD;                /* RESTRICT RETURN ADDR REG      */ 01724000
*       R14=SAVE14;                 /* RESTORE RETURN ADDR           */ 01725000
         L     R14,SAVE14                                          0651 01726000
*       RETURN;                     /* RETURN TO CALLER              */ 01727000
@EL00004 DS    0H                                                  0652 01728000
@EF00004 DS    0H                                                  0652 01729000
@ER00004 BR    @14                                                 0652 01730000
*       RESPECIFY                                                  0653 01731000
*        (R14) UNRSTD;              /* FREE FOR COMPILER USAGE       */ 01732000
*     END;                          /* END SUCCESSFUL PROCESSING     */ 01733000
*   IF R6=FOUR                      /* WAS AN ATTENTION ENTERED?     */ 01734000
*     THEN                          /* ATTN EXIT RTN POSTED CP ECB GO*/ 01735000
@RF00648 CH    R6,@CH00049                                         0655 01736000
         BE    @RT00655                                            0655 01737000
*     GO TO ATTN;                   /* PROCESS NEW COMMAND ENTERED   */ 01738000
*   IOPLIOPB=ADDR(STPB);            /* ADDRESS OF STACK PARAMETER BLK*/ 01739000
         LA    @10,SRPARM                                          0657 01740000
         LA    @09,IOBLOCK                                         0657 01741000
         ST    @09,IOPLIOPB(,@10)                                  0657 01742000
*   STPB=STKL;                      /* MOVE STACK PARAMETERS         */ 01743000
         MVC   STPB(20,@09),STKL                                   0658 01744000
*   RESPECIFY                                                      0659 01745000
*    (R1,                                                          0659 01746000
*     R15) RSTD;                    /* RESTRICT REGS ACROSS MACRO    */ 01747000
*   R1=ADDR(IOPL);                  /* ADDRESS IO SERVICE ROUTINES 0660 01748000
*                                      PARAMETER LIST                */ 01749000
         LR    R1,@10                                              0660 01750000
*   R15=PTRSTACK;                   /* ENTRY POINT OF STACK          */ 01751000
         L     R15,PTRSTACK                                        0661 01752000
*   GEN(STACK ENTRY=(15),MF=(E,(1)));/* RESET INPUT SOURCE TO THE  0662 01753000
*                                      TERMINAL                      */ 01754000
         STACK ENTRY=(15),MF=(E,(1))                                    01755000
*   RESPECIFY                                                      0663 01756000
*    (R1,                                                          0663 01757000
*     R15) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 01758000
*   GEN(TCLEARQ INPUT);             /* CLEAR OUT ANY TYPED AHEAD   0664 01759000
*                                      INPUT FROM THE TERMINAL       */ 01760000
         TCLEARQ INPUT                                                  01761000
*   R6=TWELVE;                      /* ERROR RETURN CODE PASSED TO 0665 01762000
*                                      TMP INDICATING ERROR IN     0665 01763000
*                                      OPERATOR PROCESSING           */ 01764000
         LA    R6,12                                               0665 01765000
*   GO TO EXITA;                    /* GO TO RETURN TO TMP           */ 01766000
         B     EXITA                                               0666 01767000
*   END PUTLRTN;                    /* END OF PUTLRTN PROCEDURE      */ 01768000
@PB00004 DS    0H                                                  0668 01769000
*   GEN(EJECT);                                                    0668 01770000
*                                                                  0668 01771000
         EJECT                                                          01772000
*/********************************************************************/ 01773000
*/*                                                                  */ 01774000
*/* PUT AND GET A LINE PROCEDURE                                     */ 01775000
*/*                                                                  */ 01776000
*/********************************************************************/ 01777000
*                                                                  0669 01778000
*PUTGTRTN:                                                         0669 01779000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* PUTGET ROUTINE              */ 01780000
         B     @PB00005                                            0669 01781000
PUTGTRTN DS    0H                                                  0670 01782000
*   RESPECIFY                                                      0670 01783000
*    (R4,                                                          0670 01784000
*     R5,                                                          0670 01785000
*     R6,                                                          0670 01786000
*     R8) RESTRICTED;                                              0670 01787000
*   RESPECIFY                                                      0671 01788000
*    (R14) RSTD;                    /* RESTRICT RETURN ADDR REG      */ 01789000
*   SAVE14=R14;                     /* SAVE THE RETURN ADDRESS       */ 01790000
         ST    R14,SAVE14                                          0672 01791000
*   RESPECIFY                                                      0673 01792000
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */ 01793000
*REPUT:                                                            0674 01794000
*   IOPLIOPB=ADDR(IOBLOCK);         /* ADDR OF PUTGET PARMS          */ 01795000
REPUT    LA    @10,SRPARM                                          0674 01796000
         LA    @09,IOBLOCK                                         0674 01797000
         ST    @09,IOPLIOPB(,@10)                                  0674 01798000
*   PGPB(1:16)=PGLIST;                                             0675 01799000
         MVC   PGPB(16,@09),PGLIST                                 0675 01800000
*   IF NOMSG='1'B                   /* CHECK IF NO MSG SHOULD BE   0676 01801000
*                                      ISSUED                        */ 01802000
*     THEN                          /* YES,                          */ 01803000
         TM    NOMSG,B'01000000'                                   0676 01804000
         BNO   @RF00676                                            0676 01805000
*     DO;                                                          0677 01806000
*       RESPECIFY                                                  0678 01807000
*        (R1,                                                      0678 01808000
*         R15) RSTD;                /* RESTRICT REGS ACROSS MACRO    */ 01809000
*       R1=ADDR(SRPARM);            /* GET PARM LIST ADDR            */ 01810000
         LR    R1,@10                                              0679 01811000
*       R15=WORK2;                  /* ENTRY PNT ADDR OF PUTGET      */ 01812000
         L     R15,WORK2                                           0680 01813000
*       GEN(PUTGET OUTPUT=(0,MODE),ENTRY=(15),MF=(E,(1)));         0681 01814000
         PUTGET OUTPUT=(0,MODE),ENTRY=(15),MF=(E,(1))                   01815000
*       R6=R15;                     /* SAVE RETURN CODE FOR TESTING  */ 01816000
         LR    R6,R15                                              0682 01817000
*       RESPECIFY                                                  0683 01818000
*        (R1,                                                      0683 01819000
*         R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */ 01820000
*     END;                                                         0684 01821000
*   ELSE                            /* NO,                           */ 01822000
*     DO;                                                          0685 01823000
         B     @RC00676                                            0685 01824000
@RF00676 DS    0H                                                  0686 01825000
*       LNGOFF1=ZEROS;              /* INITIALIZE OFFSET LENGTHS IN     01826000
*                                      BUFFERS                       */ 01827000
         L     @10,ZEROS                                           0686 01828000
         STH   @10,LNGOFF1                                         0686 01829000
*       LNGOFF2=ZEROS;                                             0687 01830000
         STH   @10,LNGOFF2                                         0687 01831000
*       R4=ADDR(NOMSGSG1);                                         0688 01832000
         LA    R4,NOMSGSG1                                         0688 01833000
*       RESPECIFY                                                  0689 01834000
*        (R1,                                                      0689 01835000
*         R15) RSTD;                /* RESTRICT REGS ACROSS MACRO    */ 01836000
*       R1=ADDR(SRPARM);            /* GET PARM LIST ADDR            */ 01837000
         LA    R1,SRPARM                                           0690 01838000
*       R15=WORK2;                  /* ENTRY PT ADDR OF PUTGET       */ 01839000
         L     R15,WORK2                                           0691 01840000
*       GEN(PUTGET OUTPUT=((R4),MODE),ENTRY=(15),MF=(E,(1)));      0692 01841000
         PUTGET OUTPUT=((R4),MODE),ENTRY=(15),MF=(E,(1))                01842000
*       R6=R15;                     /* SAVE RETURN CODE FOR TESTING  */ 01843000
         LR    R6,R15                                              0693 01844000
*       RESPECIFY                                                  0694 01845000
*        (R1,                                                      0694 01846000
*         R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */ 01847000
*     END;                                                         0695 01848000
*                                                                  0695 01849000
*/*                                                                0696 01850000
*    TEST RETURN CODES FROM PUTGET                                 0696 01851000
*      00 - SUCCESSFUL COMPLETION                                  0696 01852000
*      04 - INPUT LINE RETURNED IS NOT FROM TERMINAL               0696 01853000
*      08 - NO INPUT RETURNED - ATTENTION INTERRUPT OCCURRED AND   0696 01854000
*              COMMUNICATIONS ECB IS POSTED                        0696 01855000
*      12 - NO INPUT LINE RETURNED                                 0696 01856000
*              INPUT IS NOT FROM TERMINAL, SECOND LEVEL MESSAGES   0696 01857000
*              ARE CHAINED AND THE USER HAS SPECIFIED NO PAUSE     0696 01858000
*      16 - NOWAIT SPECIFIED - OUTPUT NOT SENT                     0696 01859000
*      20 - NOWAIT SPECIFIED - NO INPUT RETURNED                   0696 01860000
*      24 - INVALID PARAMETERS                                     0696 01861000
*      28 - NO SPACE AVAILABLE (GETMAIN FAILURE)                   0696 01862000
*                                                                    */ 01863000
*                                                                  0696 01864000
*   IF BUFFPTR^=ZEROS               /* ARE THERE BUFFERS TO BE FREED */ 01865000
*     THEN                          /* YES, THERE ARE                */ 01866000
@RC00676 L     @10,BUFFPTR                                         0696 01867000
         C     @10,ZEROS                                           0696 01868000
         BE    @RF00696                                            0696 01869000
*     DO;                                                          0697 01870000
*       WORK1(3:4)=BUFFAREA(1:2);   /* GET LNGTH TO BE FREED         */ 01871000
         MVC   WORK1+2(2),BUFFAREA(@10)                            0698 01872000
*       RESPECIFY                                                  0699 01873000
*        (R0,                                                      0699 01874000
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */ 01875000
*       R0=WORK1;                                                  0700 01876000
         L     R0,WORK1                                            0700 01877000
*       R1=BUFFPTR;                 /* GET ADDRESS OF BUFFER         */ 01878000
         LR    R1,@10                                              0701 01879000
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE THE BUFFER              */ 01880000
         FREEMAIN R,LV=(0),A=(1)                                        01881000
*       RESPECIFY                                                  0703 01882000
*        (R0,                                                      0703 01883000
*         R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */ 01884000
*       BUFFPTR=ZEROS;              /* NO BUFFERS TO BE FREED        */ 01885000
         MVC   BUFFPTR(4),ZEROS                                    0704 01886000
*     END;                                                         0705 01887000
*   IF R6=ZEROS|R6=FOUR             /* WAS PUTGET SUCCESSFUL ?       */ 01888000
*     THEN                          /* YES,                          */ 01889000
@RF00696 C     R6,ZEROS                                            0706 01890000
         BE    @RT00706                                            0706 01891000
         CH    R6,@CH00049                                         0706 01892000
         BNE   @RF00706                                            0706 01893000
@RT00706 DS    0H                                                  0707 01894000
*     DO;                           /* MOVE INPUT TO OWN BUFFER      */ 01895000
*       WORK7=PGPBIBUF;             /* CMD BUFFER BASED ON PTR TO  0708 01896000
*                                      PUTGET BUFFER                 */ 01897000
         LA    @10,IOBLOCK                                         0708 01898000
         L     @10,PGPBIBUF(,@10)                                  0708 01899000
         ST    @10,WORK7                                           0708 01900000
*/*                                                                0709 01901000
*          GET OWN BUFFER AREA AND MOVE COMMAND BUFFER INTO IT TO  0709 01902000
*          ENSURE COMMAND IS DELIMITED BY BLANKS FOR SVC 34 SYNTAX 0709 01903000
*          CHECK. FREE BUFFER OBTAINED BY PUTGET                   0709 01904000
*                                                                    */ 01905000
*                                                                  0709 01906000
*       WORK1=SUBPOOL1;             /* SET SUBPOOL NUMBER            */ 01907000
         MVC   WORK1(4),SUBPOOL1                                   0709 01908000
*       WORK1(3:4)=LNGBUFFR+EIGHT;  /* SET TO NEXT DOUBLEWORD LEN TO    01909000
*                                      ALLOW FOR TRAILING BLANK      */ 01910000
         LA    @09,8                                               0710 01911000
         AH    @09,LNGBUFFR(,@10)                                  0710 01912000
         ST    @09,@TF00001                                        0710 01913000
         MVC   WORK1+2(2),@TF00001+2                               0710 01914000
*       RESPECIFY                                                  0711 01915000
*        (R0,                                                      0711 01916000
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */ 01917000
*       R0=WORK1;                                                  0712 01918000
         L     R0,WORK1                                            0712 01919000
*       GEN(GETMAIN R,LV=(0));      /* GET NEEDED BUFFER AREA        */ 01920000
         GETMAIN R,LV=(0)                                               01921000
*       BUFFPTR=R1;                 /* SAVE THE ADDRESS              */ 01922000
         ST    R1,BUFFPTR                                          0714 01923000
*       RESPECIFY                                                  0715 01924000
*        (R0,                                                      0715 01925000
*         R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */ 01926000
*       BUFFAREA(1:LNGBUFFR)=CMDBUFFR(1:LNGBUFFR);/* MOVE CMD INTO 0716 01927000
*                                      NEW AREA                      */ 01928000
         L     @10,BUFFPTR                                         0716 01929000
         L     @09,WORK7                                           0716 01930000
         LH    @07,LNGBUFFR(,@09)                                  0716 01931000
         LR    @15,@07                                             0716 01932000
         BCTR  @15,0                                               0716 01933000
         EX    @15,@SM01357                                        0716 01934000
*       BUFFAREA(LNGBUFFR+UNO:LNGBUFFR+EIGHT)='';/* BLANK OUT REST   */ 01935000
         ALR   @07,@10                                             0717 01936000
         MVI   BUFFAREA(@07),C' '                                  0717 01937000
         MVC   BUFFAREA+1(7,@07),BUFFAREA(@07)                     0717 01938000
*       BUFFAREA(1:2)=LNGBUFFR+EIGHT;/* SET THE NEW LENGTH           */ 01939000
         L     @09,WORK7                                           0718 01940000
         LH    @09,LNGBUFFR(,@09)                                  0718 01941000
         LA    @07,8                                               0718 01942000
         ALR   @07,@09                                             0718 01943000
         ST    @07,@TF00001                                        0718 01944000
         MVC   BUFFAREA(2,@10),@TF00001+2                          0718 01945000
*       WORK1=SUBPOOL1;             /* SET SUBPOOL NUMBER TO 1       */ 01946000
         MVC   WORK1(4),SUBPOOL1                                   0719 01947000
*       WORK1(3:4)=LNGBUFFR;        /* GET LENGTH FROM BUFFER HEADER */ 01948000
         ST    @09,@TF00001                                        0720 01949000
         MVC   WORK1+2(2),@TF00001+2                               0720 01950000
*       RESPECIFY                                                  0721 01951000
*        (R0,                                                      0721 01952000
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */ 01953000
*       R0=WORK1;                                                  0722 01954000
         L     R0,WORK1                                            0722 01955000
*       R1=PGPBIBUF;                /* GET ADDRESS OF BUFFER         */ 01956000
         LA    @10,IOBLOCK                                         0723 01957000
         L     R1,PGPBIBUF(,@10)                                   0723 01958000
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE BUFFER                  */ 01959000
         FREEMAIN R,LV=(0),A=(1)                                        01960000
*       RESPECIFY                                                  0725 01961000
*        (R0,                                                      0725 01962000
*         R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */ 01963000
*       WORK7=BUFFPTR;              /* RESET CMDBUFFR BASE VALUE     */ 01964000
         MVC   WORK7(4),BUFFPTR                                    0726 01965000
*       RESPECIFY                                                  0727 01966000
*        (R14) RSTD;                /* RESTRICT RETURN ADDR REG      */ 01967000
*       R14=SAVE14;                 /* RESTOR RETURN ADDRESS         */ 01968000
         L     R14,SAVE14                                          0728 01969000
*       RETURN;                     /* RETURN TO CALLER              */ 01970000
@EL00005 DS    0H                                                  0729 01971000
@EF00005 DS    0H                                                  0729 01972000
@ER00005 BR    @14                                                 0729 01973000
*       RESPECIFY                                                  0730 01974000
*        (R14) UNRSTD;              /* FREE FOR COMPILER USAGE       */ 01975000
*     END;                                                         0731 01976000
*   IF R6=EIGHT                     /* WAS THERE AN ATTENTION ?      */ 01977000
*     THEN                          /* ATTEN EXIT RTN POSTED CPECB GO*/ 01978000
@RF00706 CH    R6,@CH00035                                         0732 01979000
         BE    @RT00732                                            0732 01980000
*     GO TO ATTN;                   /* PROCESS NEW COMMAND ENTERED   */ 01981000
*   IF R6=TWELVE                    /* NO INPUT ?                    */ 01982000
*     THEN                          /* DELETE 2ND LVL MSG CHAIN      */ 01983000
         CH    R6,@CH00037                                         0734 01984000
         BNE   @RF00734                                            0734 01985000
*     DO;                                                          0735 01986000
*       ECTMSGF='1'B;               /* SETS SWITCH TO DELETE 2ND   0736 01987000
*                                      LEVEL MESSAGE CHAIN           */ 01988000
         L     @10,SAVECPPL                                        0736 01989000
         L     @10,ECTPTR(,@10)                                    0736 01990000
         MVI   ECTMSGF(@10),B'10000000'                            0736 01991000
*       GO TO REPUT;                /* RETURN TO REISSUE PUTGET      */ 01992000
         B     REPUT                                               0737 01993000
*     END;                                                         0738 01994000
*   MSGSEG2B=ADDR(PTGTSEG);         /* INITIALIZE PTPB FOR ERROR MSG    01995000
*                                      FOR PUTLINE                   */ 01996000
@RF00734 LA    @10,PTGTSEG                                         0739 01997000
         ST    @10,MSGSEG2B                                        0739 01998000
*   GO TO MSGRTN4;                  /* GO TO PUT OUT ERROR MSG       */ 01999000
         B     MSGRTN4                                             0740 02000000
*   END PUTGTRTN;                   /* END OF PUTGET PROCEDURE       */ 02001000
@PB00005 DS    0H                                                  0742 02002000
*   GEN(EJECT);                                                    0742 02003000
*                                                                  0742 02004000
         EJECT                                                          02005000
*/********************************************************************/ 02006000
*/*                                                                  */ 02007000
*/*  PROCEDURE TO CLEAR A BUFFER                                     */ 02008000
*/*                                                                  */ 02009000
*/********************************************************************/ 02010000
*                                                                  0743 02011000
*CLEAR:                                                            0743 02012000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* BUFFER CLEARING PROC        */ 02013000
         B     @PB00006                                            0743 02014000
CLEAR    DS    0H                                                  0744 02015000
*   RESPECIFY                                                      0744 02016000
*    (R4,                                                          0744 02017000
*     R5,                                                          0744 02018000
*     R6,                                                          0744 02019000
*     R8) RESTRICTED;                                              0744 02020000
*   OUTBUFF1=BLANK;                 /* CLEAR FIRST OUTPUT BUFFER     */ 02021000
         MVI   OUTBUFF1+1,C' '                                     0745 02022000
         MVC   OUTBUFF1+2(130),OUTBUFF1+1                          0745 02023000
         MVC   OUTBUFF1(1),BLANK                                   0745 02024000
*   OUTBUFF2=OUTBUFF1;              /* CLEAR THE SECOND OUTPUT BUFFER*/ 02025000
         MVC   OUTBUFF2(132),OUTBUFF1                              0746 02026000
*   END CLEAR;                      /* END OF CLEAR PROCEDURE        */ 02027000
@EL00006 DS    0H                                                  0747 02028000
@EF00006 DS    0H                                                  0747 02029000
@ER00006 BR    @14                                                 0747 02030000
*/*IKJEE100:     CHART                                               */ 02031000
*/*HEADER                                                          0748 02032000
*/*                                                                0748 02033000
*/*                                             PAGE #             0748 02034000
*/*                                                                0748 02035000
*/*                                                                  */ 02036000
*/*E ENTRY                                                           */ 02037000
*/*P INITIALIZE NUMBER OF TITLES                                     */ 02038000
*/*%A5: I READ A FILE FROM TAPE                                      */ 02039000
*/* P INCREMENT NUMBER OF TITLES                                     */ 02040000
*/* D (YES,SORT,NO,) END OF INPUT?                                   */ 02041000
*/* P INITIALIZE POSITION IN TITLE                                   */ 02042000
*/*%A1: P INITIALIZE POSITION IN KEYWORD                             */ 02043000
*/*%A2: P INCREMENT POSITION IN TITLE                                */ 02044000
*/* P INCREMENT POSITION IN KEYWORD                                  */ 02045000
*/* D (YES,,NO,%A2) WORD DELIMITER?                                  */ 02046000
*/* D (YES,%A1,NO,) KEYWORD POSITION = 1 & = DELIMITER ?             */ 02047000
*/* P DECREMENT BOTH COUNTERS BY ONE                                 */ 02048000
*/* P INITIALIZE DICTIONARY POSITION TO BEGINNING                    */ 02049000
*/*%A3: P INCREMENT DICTIONARY POSITION BY LENGTH                    */ 02050000
*/* P INITIALIZE ARRAY OF CORRESPONDING DICTIONARY WORD LENGTHS      */ 02051000
*/* D (YES,%A4,NO,) MATCH OF DICTIONARY WORD?                        */ 02052000
*/* P PICK UP LENGTH OF NEXT DICTIONARY WORD                         */ 02053000
*/* D (YES,,NO,%A3) END OF DICTIONARY ?                              */ 02054000
*/* P PLACE THE KEYWORD LENGTH IN FIRST PART OF OUTFILE              */ 02055000
*/* P PLACE TITLE WORDS BEFORE COMPARISON WORD ON LEFT SIDE          */ 02056000
*/* P PLACE REMAINDER OF TITLE ON RIGHT SIDE OF OUTFILE              */ 02057000
*/*%A4: D (YES,%A5,NO,) HIT THE END OF PRESENT TITLE?                */ 02058000
*/* P (,%A1) INCREMENT TO NEXT WORD                                  */ 02059000
*/*SORT: D (YES,PRINT,NO,) END OF TITLES-- I> NO. OF TITLES?         */ 02060000
*/* D (YES,,NO,%B1) IS KEYWORD(I) < KEYWORD(I+1) ?                   */ 02061000
*/* P EXCHANGE TITLE(I) AND TITLE(I+1)                               */ 02062000
*/* P (,SORT) RESET I TO THE BEGINNING                               */ 02063000
*/*%B1: P (,SORT) INCREMENT I BY ONE                                 */ 02064000
*/*PRINT: I PRINT THE SORTED LIST OMITTING THE LENGTHS               */ 02065000
*/*IKJEE100:    END                                                  */ 02066000
*                                                                  0748 02067000
*   END IKJEE100                    /* END OF IKJEE100 (OPERATOR)    */ 02068000
*                                                                  0748 02069000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02070000
*/*%INCLUDE SYSLIB  (IEZATTCH)                                       */ 02071000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 02072000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 02073000
*/*%INCLUDE SYSLIB  (IKJEFFIB)                                       */ 02074000
*/*%INCLUDE SYSLIB  (IKJPSCB )                                       */ 02075000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 02076000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */ 02077000
*/*%INCLUDE SYSLIB  (IKJPGPB )                                       */ 02078000
*/*%INCLUDE SYSLIB  (IKJPTPB )                                       */ 02079000
*/*%INCLUDE SYSLIB  (IKJCSPL )                                       */ 02080000
*/*%INCLUDE SYSLIB  (IKJCSOA )                                       */ 02081000
*/*%INCLUDE SYSLIB  (IKJDAPL )                                       */ 02082000
*/*%INCLUDE SYSLIB  (IKJDAP2C)                                       */ 02083000
*/*%INCLUDE SYSLIB  (IKJSTPB )                                       */ 02084000
*/*%INCLUDE SYSLIB  (IKJEFFS0)                                       */ 02085000
*/*%INCLUDE SYSLIB  (IKJEFFS0)                                       */ 02086000
*/*%INCLUDE SYSLIB  (IKJEFFS0)                                       */ 02087000
*                                                                  0748 02088000
*       ;                                                          0748 02089000
         B     @EL00001                                            0748 02090000
@DATA    DS    0H                                                       02091000
@CH00057 DC    H'1'                                                     02092000
@CH00251 DC    H'3'                                                     02093000
@CH00035 DC    H'8'                                                     02094000
@CH00037 DC    H'12'                                                    02095000
@CH00041 DC    H'24'                                                    02096000
@CH00429 DC    H'27'                                                    02097000
@CH00424 DC    H'30'                                                    02098000
@CH00437 DC    H'57'                                                    02099000
@CH00439 DC    H'76'                                                    02100000
@CH00426 DC    H'136'                                                   02101000
@CH01132 DC    XL2'0004'                                                02102000
@SM01347 MVC   ECTSCMD(0,@07),CMDNAME(@10)                              02103000
@SM01349 MVC   OUTBUFF1+8(0),CMDDATE-1(@07)                             02104000
@SM01352 MVC   OUTBUFF1+29(0),CMDNAME(@07)                              02105000
@SM01354 MVC   OUTBUFF1+26(0),OPERAND(R5)                               02106000
@SM01357 MVC   BUFFAREA(0,@10),CMDBUFFR(@09)                            02107000
@DATD    DSECT                                                          02108000
         DS    0F                                                       02109000
@SA00001 DS    18F                                                      02110000
@PC00001 DS    1F                                                       02111000
@TF00001 DS    F                                                        02112000
@ZTEMPS  DS    C                                                        02113000
@ZTEMPND EQU   *                                                        02114000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         02115000
IKJEE100 CSECT                                                          02116000
         DS    0F                                                       02117000
@CF00049 DC    F'4'                                                     02118000
@CH00049 EQU   @CF00049+2                                               02119000
@DATD    DSECT                                                          02120000
         DS    0D                                                       02121000
BUFFPTR  DS    A                                                        02122000
ATCHECB  DS    F                                                        02123000
ATTCHPTR DS    A                                                        02124000
WTOPTR   DS    F                                                        02125000
WTOLNGTH DS    F                                                        02126000
SAVECPPL DS    A                                                        02127000
SAVE13   DS    F                                                        02128000
SAVE14   DS    F                                                        02129000
SVER14   DS    A                                                        02130000
FIBMAINP DS    AL4                                                      02131000
         ORG   FIBMAINP                                                 02132000
FIBHIGH  DS    BL1                                                      02133000
         ORG   FIBMAINP+4                                               02134000
CSOAPTR  DS    A                                                        02135000
FIBPTR   DS    A                                                        02136000
ENDNAME  DS    H                                                        02137000
         DS    CL2                                                      02138000
SRPARM   DS    CL24                                                     02139000
IOBLOCK  DS    CL20                                                     02140000
DAIRPARM DS    CL8                                                      02141000
CMDSCAN  DS    CL8                                                      02142000
STAXAREA DS    CL20                                                     02143000
WORKAREA DS    CL36                                                     02144000
         ORG   WORKAREA                                                 02145000
WORK1    DS    CL4                                                      02146000
WORK2    DS    FL4                                                      02147000
WORK3    DS    AL4                                                      02148000
WORK4    DS    FL4                                                      02149000
WORK5    DS    FL4                                                      02150000
WORK7    DS    AL4                                                      02151000
WORK6    DS    AL4                                                      02152000
WORKFLGS DS    CL1                                                      02153000
         ORG   WORKFLGS                                                 02154000
@NM00001 DS    BL1                                                      02155000
NOMSG    EQU   WORKFLGS+0                                               02156000
EXITERR  EQU   WORKFLGS+0                                               02157000
ENDCMDFG EQU   WORKFLGS+0                                               02158000
         ORG   WORKAREA+32                                              02159000
GETLPTR  DS    AL4                                                      02160000
         ORG   WORKAREA+36                                              02161000
AXBUF    DS    CL136                                                    02162000
         ORG   AXBUF                                                    02163000
AXLEN    DS    FL2                                                      02164000
AXOFF    DS    FL2                                                      02165000
AXTEXT   DS    CL132                                                    02166000
         ORG   AXBUF+136                                                02167000
MODESEG  DS    CL26                                                     02168000
         ORG   MODESEG                                                  02169000
MODELEN  DS    FL2                                                      02170000
MODEOFF  DS    FL2                                                      02171000
MODETEXT DS    CL22                                                     02172000
         ORG   MODESEG+26                                               02173000
FLAGWORD DS    CL4                                                      02174000
         ORG   FLAGWORD                                                 02175000
SYNCHK   DS    BL1                                                      02176000
NOFLAG   EQU   FLAGWORD+0                                               02177000
RESWORD  DS    AL3                                                      02178000
         ORG   FLAGWORD+4                                               02179000
         DS    CL2                                                      02180000
MSGCHAIN DS    CL36                                                     02181000
         ORG   MSGCHAIN                                                 02182000
NXTLVMSG DS    AL4                                                      02183000
NOMSGSG1 DS    FL4                                                      02184000
MSGSEG1  DS    AL4                                                      02185000
ENDCHAIN DS    FL4                                                      02186000
NOMSGSG2 DS    FL4                                                      02187000
MSGSEG2  DS    AL4                                                      02188000
MSGSEG2B DS    AL4                                                      02189000
MSGSEG2C DS    AL4                                                      02190000
MSGSEG2D DS    AL4                                                      02191000
         ORG   MSGCHAIN+36                                              02192000
         DS    CL4                                                      02193000
BUFR1    DS    CL136                                                    02194000
         ORG   BUFR1                                                    02195000
LNGBUF1  DS    FL2                                                      02196000
LNGOFF1  DS    FL2                                                      02197000
OUTBUFF1 DS    CL132                                                    02198000
         ORG   BUFR1+136                                                02199000
BUFR2    DS    CL136                                                    02200000
         ORG   BUFR2                                                    02201000
LNGBUF2  DS    FL2                                                      02202000
LNGOFF2  DS    FL2                                                      02203000
OUTBUFF2 DS    CL132                                                    02204000
         ORG   BUFR2+136                                                02205000
EXITPARM DS    CL68                                                     02206000
         ORG   EXITPARM                                                 02207000
PTRCPPL  DS    AL4                                                      02208000
PTRCPECB DS    AL4                                                      02209000
PTRPUTL  DS    AL4                                                      02210000
PTRGETL  DS    AL4                                                      02211000
STAEAREA DS    AL4                                                      02212000
ATTNAREA DS    AL4                                                      02213000
PTRWORK7 DS    AL4                                                      02214000
PTRSCAN  DS    AL4                                                      02215000
@NM00002 DS    FL4                                                      02216000
         ORG   @NM00002                                                 02217000
EXITFLAG DS    BL1                                                      02218000
         ORG   EXITFLAG                                                 02219000
RSVD1    DS    BL1                                                      02220000
RSVD2    EQU   EXITFLAG+0                                               02221000
@NM00003 EQU   EXITFLAG+0                                               02222000
NOWORK   EQU   EXITFLAG+0                                               02223000
         ORG   @NM00002+1                                               02224000
@NM00004 DS    CL1                                                      02225000
RECURSON DS    FL2                                                      02226000
         ORG   EXITPARM+36                                              02227000
PTRSTACK DS    AL4                                                      02228000
ATTNSAVE DS    AL4                                                      02229000
STAESAVE DS    AL4                                                      02230000
ATTACHCB DS    AL4                                                      02231000
REGISTR8 DS    AL4                                                      02232000
BASE100  DS    AL4                                                      02233000
WORKADDR DS    AL4                                                      02234000
ATTNBUFF DS    AL4                                                      02235000
         ORG   EXITPARM+68                                              02236000
         DS    CL4                                                      02237000
STAEWORK DS    CL88                                                     02238000
ATTNWORK DS    CL80                                                     02239000
ATTNSA   DS    CL72                                                     02240000
STAESA   DS    CL80                                                     02241000
RTCDESEG DS    CL7                                                      02242000
         ORG   RTCDESEG                                                 02243000
HEADER   DS    FL4                                                      02244000
TEXT     DS    CL3                                                      02245000
         ORG   RTCDESEG+7                                               02246000
         DS    CL1                                                      02247000
ATTCHPRM DS    CL60                                                     02248000
STAELIST DS    CL20                                                     02249000
CPECB    DS    CL4                                                      02250000
         ORG   CPECB                                                    02251000
ECBBIT0  DS    BL1                                                      02252000
ECBBIT1  EQU   CPECB+0                                                  02253000
ECBBITS  EQU   CPECB+0                                                  02254000
ECBCC    DS    CL3                                                      02255000
         ORG   CPECB+4                                                  02256000
FIBPARMS DS    CL32                                                     02257000
         ORG   FIBPARMS                                                 02258000
FIBCPPL  DS    AL4                                                      02259000
FIBUSER  DS    AL4                                                      02260000
FIBCODE  DS    AL4                                                      02261000
FIBMACRO DS    CL8                                                      02262000
FIBID    DS    FL2                                                      02263000
FIBLEN   DS    FL2                                                      02264000
@NM00023 DS    AL4                                                      02265000
@NM00024 DS    AL4                                                      02266000
         ORG   FIBPARMS+32                                              02267000
CALLPARM DS    CL24                                                     02268000
         ORG   CALLPARM                                                 02269000
AOPRND   DS    AL4                                                      02270000
LNGOPRND DS    FL4                                                      02271000
ACMDNAME DS    AL4                                                      02272000
ABUFFER  DS    AL4                                                      02273000
CNTRLFLG DS    FL2                                                      02274000
         ORG   CNTRLFLG                                                 02275000
AUTHCHK  DS    BL1                                                      02276000
CMDCHK   EQU   CNTRLFLG+0                                               02277000
@NM00025 EQU   CNTRLFLG+0                                               02278000
OFFGETBF EQU   CNTRLFLG+0                                               02279000
FSTFLG   EQU   CNTRLFLG+0                                               02280000
         ORG   CALLPARM+18                                              02281000
TERMID   DS    FL2                                                      02282000
@NM00026 DS    AL4                                                      02283000
         ORG   CALLPARM+24                                              02284000
IKJEE100 CSECT                                                          02285000
         DS    0F                                                       02286000
@SIZDATD DC    AL1(1)                                                   02287000
         DC    AL3(@ENDDATD-@DATD)                                      02288000
@CV00382 DC    V(IKJEE1A2)                                              02289000
@CA00383 DC    A(IKJEE150)                                              02290000
@CV00381 DC    V(IKJEE1A0)                                              02291000
         DS    0D                                                       02292000
RTCDE    DC    XL4'0007000A'                                            02293000
ZEROS    DC    XL4'00000000'                                            02294000
DESCODE  DC    XL4'00004100'                                            02295000
LNGMSG4A DC    XL2'24'                                                  02296000
LNGMSG0A DC    XL2'3A'                                                  02297000
LNGMSG0B DC    XL2'46'                                                  02298000
LNGMSG1A DC    XL2'30'                                                  02299000
LNGMSG1B DC    XL2'36'                                                  02300000
LNGMSG2A DC    XL2'0D'                                                  02301000
LNGMSG3A DC    XL2'22'                                                  02302000
LNGMSG3B DC    XL2'5E'                                                  02303000
LNGMSG5A DC    XL2'1F'                                                  02304000
LNGMSG5B DC    XL2'58'                                                  02305000
LNGMSG6A DC    XL2'1E'                                                  02306000
LNGMSG6B DC    XL2'35'                                                  02307000
@CB01310 DC    X'002C'                                                  02308000
MSG0001  DC    CL54'IKJ55000I OPERATOR COMMAND NOT AUTHORIZED FOR      C02309000
                 +'                                                     02310000
MSG0002  DC    CL66'IKJ55000I YOUR INSTALLATION MUST AUTHORIZE USE OF OC02311000
               PERATOR COMMAND'                                         02312000
MSG0011  DC    CL44'IKJ55001I DATA IGNORED IN THE OPERAND FIELD+'       02313000
MSG0012  DC    CL50'IKJ55001I OPERATOR COMMAND SHOULD HAVE NO OPERANDS' 02314000
MSG0031  DC    CL28'IKJ55003I INVALID SUBCOMMAND'                       02315000
MSG0032  DC    CL78'IKJ55003I OPERATOR SUBCOMMANDS ARE CANCEL|DISPLAY|MC02316000
               ONITOR|SEND|STOPMN|END|HELP'                             02317000
MSG0051  DC    CL25'IKJ55005I INVALID OPERAND'                          02318000
MSG0052  DC    CL84'IKJ55005I OPERAND SYNTACTICALLY INCORRECT OR VALID C02319000
               ONLY FROM SYSTEM OPERATOR CONSOLE'                       02320000
MSG0061  DC    CL26'IKJ5006I MISSING OPERAND+'                          02321000
MSG0062  DC    CL49'IKJ55006I OPERATOR SUBCOMMANDS MUST HAVE OPERANDS'  02322000
MSG0041  DC    CL31'IKJ55004I COMMAND SYSTEM ERROR+'                    02323000
         DS    CL3                                                      02324000
@NM00005 DS    CL14                                                     02325000
         ORG   @NM00005                                                 02326000
MSGIDHDR DC    XL4'000E0000'                                            02327000
MSGIDTXT DC    CL10'IKJ55004I'                                          02328000
         ORG   @NM00005+14                                              02329000
         DS    CL2                                                      02330000
@NM00006 DS    CL11                                                     02331000
         ORG   @NM00006                                                 02332000
SVC100SG DC    XL4'000B000A'                                            02333000
SVC100TX DC    CL7'SVC100 '                                             02334000
         ORG   @NM00006+11                                              02335000
         DS    CL1                                                      02336000
@NM00007 DS    CL11                                                     02337000
         ORG   @NM00007                                                 02338000
PTGTSEG  DC    XL4'000B000A'                                            02339000
PTGTTXT  DC    CL7'PUTGET '                                             02340000
         ORG   @NM00007+11                                              02341000
         DS    CL1                                                      02342000
@NM00008 DS    CL9                                                      02343000
         ORG   @NM00008                                                 02344000
DAIRSEG  DC    XL4'0009000A'                                            02345000
DAIRTXT  DC    CL5'DAIR '                                               02346000
         ORG   @NM00008+9                                               02347000
         DS    CL3                                                      02348000
@NM00009 DS    CL9                                                      02349000
         ORG   @NM00009                                                 02350000
STAESEG  DC    XL4'0009000A'                                            02351000
STAETXT  DC    CL5'STAE '                                               02352000
         ORG   @NM00009+9                                               02353000
         DS    CL3                                                      02354000
@NM00010 DS    CL17                                                     02355000
         ORG   @NM00010                                                 02356000
CMDSCNSG DC    XL4'0011000A'                                            02357000
CMDSCNTX DC    CL13'COMMAND SCAN '                                      02358000
         ORG   @NM00010+17                                              02359000
         DS    CL3                                                      02360000
@NM00011 DS    CL9                                                      02361000
         ORG   @NM00011                                                 02362000
STAISEG  DC    XL4'0009000A'                                            02363000
STAITXT  DC    CL5'STAI '                                               02364000
         ORG   @NM00011+9                                               02365000
         DS    CL3                                                      02366000
@NM00012 DS    CL18                                                     02367000
         ORG   @NM00012                                                 02368000
MSG0042  DC    XL4'0012000A'                                            02369000
MSG42TXT DC    CL14'ERROR CODE IS '                                     02370000
         ORG   @NM00012+18                                              02371000
LASTLVL  DC    X'FF000000'                                              02372000
ONE      DC    X'00000001'                                              02373000
MCSFLG   DC    X'A000'                                                  02374000
ATTNMSG  DS    CL4                                                      02375000
         ORG   ATTNMSG                                                  02376000
ATTNLEN  DC    H'12'                                                    02377000
ATTNOFF  DC    H'0'                                                     02378000
         ORG   ATTNMSG+4                                                02379000
CNSLID   DC    CL8'IKJ000I '                                            02380000
BLANK    DC    CL1' '                                                   02381000
FLGNOCHK DC    X'80'                                                    02382000
ENDCMD   DC    CL3'END'                                                 02383000
HELPCMD  DC    CL4'HELP'                                                02384000
COMMA    DC    CL1','                                                   02385000
PLUSSIGN DC    CL1'+'                                                   02386000
STOPMN   DC    CL7'STOPMN '                                             02387000
PM       DC    CL3'PM '                                                 02388000
DISPLAY  DC    CL8'DISPLAY '                                            02389000
D        DC    CL2'D '                                                  02390000
MONITOR  DC    CL8'MONITOR '                                            02391000
MN       DC    CL3'MN '                                                 02392000
CANCEL   DC    CL7'CANCEL '                                             02393000
C        DC    CL2'C '                                                  02394000
SEND     DC    CL5'SEND '                                               02395000
SE       DC    CL3'SE '                                                 02396000
         DS    CL1                                                      02397000
SUBPOOL1 DC    X'01000000'                                              02398000
IKJEE100 CSECT                                                          02399000
UPPERTAB DC 256AL1(*-UPPERTAB)       GENERATE BASIC TABLE               02400000
         ORG  UPPERTAB+C'A'-X'40'    POSITION INST. CTR. TO SMALL A-Z   02401000
         DC   (C'Z'-C'A'+1)AL1(*-UPPERTAB+X'40') RAISE LOWER TO UPPER   02402000
         ORG  UPPERTAB+256           RESET INSTRUCTION COUNTER          02403000
@DATD    DSECT                                                          02404000
*                                  /* PATCH AREA FOR THE MODULE      */ 02405000
PTCHAREA DC CL50'OOOOOOOOOOOOOOPATCH AREA FOR OPERATOROOOOOOOOOOOOO'    02406000
@DATD    DSECT                                                          02407000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02408000
@ENDDATD EQU   *                                                        02409000
IKJEE100 CSECT                                                          02410000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02411000
@01      EQU   01                                                       02412000
@02      EQU   02                                                       02413000
@03      EQU   03                                                       02414000
@04      EQU   04                                                       02415000
@05      EQU   05                                                       02416000
@06      EQU   06                                                       02417000
@07      EQU   07                                                       02418000
@08      EQU   08                                                       02419000
@09      EQU   09                                                       02420000
@10      EQU   10                                                       02421000
@11      EQU   11                                                       02422000
@12      EQU   12                                                       02423000
@13      EQU   13                                                       02424000
@14      EQU   14                                                       02425000
@15      EQU   15                                                       02426000
R0       EQU   @00                                                      02427000
R1       EQU   @01                                                      02428000
R3       EQU   @03                                                      02429000
R4       EQU   @04                                                      02430000
R5       EQU   @05                                                      02431000
R6       EQU   @06                                                      02432000
R7       EQU   @07                                                      02433000
R8       EQU   @08                                                      02434000
R9       EQU   @09                                                      02435000
R11      EQU   @11                                                      02436000
R12      EQU   @12                                                      02437000
R13      EQU   @13                                                      02438000
R14      EQU   @14                                                      02439000
R15      EQU   @15                                                      02440000
         ENTRY ENDRN                                                    02441000
         ENTRY IKJEE101                                                 02442000
         EXTRN IKJEE150                                                 02443000
BUFFAREA EQU   0                                                        02444000
CMDBUFFR EQU   0                                                        02445000
LNGBUFFR EQU   CMDBUFFR                                                 02446000
BFOFFSET EQU   CMDBUFFR+2                                               02447000
CMDDATE  EQU   CMDBUFFR+4                                               02448000
ATTCHLST EQU   0                                                        02449000
ATPGNADA EQU   ATTCHLST                                                 02450000
ATDEFLAG EQU   ATPGNADA                                                 02451000
ATDCBADA EQU   ATTCHLST+4                                               02452000
ATECBADR EQU   ATTCHLST+8                                               02453000
ATECBFLG EQU   ATECBADR                                                 02454000
ATGSFLDA EQU   ATTCHLST+12                                              02455000
ATGSFLAG EQU   ATGSFLDA                                                 02456000
ATSHFLDA EQU   ATTCHLST+16                                              02457000
ATSHFLAG EQU   ATSHFLDA                                                 02458000
ATETXRA  EQU   ATTCHLST+20                                              02459000
ATROLL   EQU   ATETXRA                                                  02460000
ATINDS2  EQU   ATROLL                                                   02461000
ATINDS   EQU   ATTCHLST+27                                              02462000
ATJSCBAD EQU   ATTCHLST+36                                              02463000
ATSTAIAD EQU   ATTCHLST+40                                              02464000
ATSTAIEX EQU   ATTCHLST+44                                              02465000
ATSTAIF  EQU   ATSTAIEX                                                 02466000
ATFLAGS1 EQU   ATTCHLST+52                                              02467000
OPERAND  EQU   0                                                        02468000
CVTPTR   EQU   0                                                        02469000
CVTMAP   EQU   0                                                        02470000
CVTDAR   EQU   CVTMAP+72                                                02471000
CVTFLGS1 EQU   CVTDAR                                                   02472000
CVTDCB   EQU   CVTMAP+116                                               02473000
CVTIERLC EQU   CVTMAP+144                                               02474000
CVTOPTA  EQU   CVTMAP+182                                               02475000
CVTOPTB  EQU   CVTMAP+183                                               02476000
CVTGTF   EQU   CVTMAP+236                                               02477000
CVTGTFST EQU   CVTGTF                                                   02478000
CVTGTFS  EQU   CVTGTFST                                                 02479000
CVTSTATE EQU   CVTGTFST                                                 02480000
CVTTMODE EQU   CVTGTFST                                                 02481000
CVTFORM  EQU   CVTGTFST                                                 02482000
CVTAQAVT EQU   CVTMAP+240                                               02483000
CVTTCMFG EQU   CVTAQAVT                                                 02484000
CVTVOLM2 EQU   CVTMAP+244                                               02485000
CVTTATA  EQU   CVTVOLM2                                                 02486000
CVTTSKS  EQU   CVTTATA                                                  02487000
CVTVOLF2 EQU   CVTTSKS                                                  02488000
CVTTAT   EQU   CVTTATA+1                                                02489000
CVTATER  EQU   CVTMAP+248                                               02490000
CVTEXT1  EQU   CVTMAP+252                                               02491000
CVTPURG  EQU   CVTMAP+260                                               02492000
CVTQMSG  EQU   CVTMAP+268                                               02493000
CVTDMSR  EQU   CVTMAP+272                                               02494000
CVTERPV  EQU   CVTMAP+316                                               02495000
CVTINTLA EQU   CVTMAP+320                                               02496000
CVTAPF   EQU   CVTMAP+324                                               02497000
CVTEXT2  EQU   CVTMAP+328                                               02498000
CVTHJES  EQU   CVTMAP+332                                               02499000
CVTPGSIA EQU   CVTMAP+348                                               02500000
CVTA1F1  EQU   CVTMAP+356                                               02501000
CVTSYSK  EQU   CVTMAP+357                                               02502000
CVTVOLM1 EQU   CVTMAP+380                                               02503000
CVTVOLF1 EQU   CVTVOLM1                                                 02504000
CVTATMCT EQU   CVTMAP+388                                               02505000
CVTXTNT1 EQU   0                                                        02506000
CVTXTNT2 EQU   0                                                        02507000
CVTDSSV  EQU   CVTXTNT2                                                 02508000
CVTFLGBT EQU   CVTXTNT2+5                                               02509000
CVTQID   EQU   CVTXTNT2+24                                              02510000
CVTRV400 EQU   CVTXTNT2+52                                              02511000
CVTRV409 EQU   CVTXTNT2+53                                              02512000
CVTATCVT EQU   CVTXTNT2+64                                              02513000
CVTRV429 EQU   CVTXTNT2+84                                              02514000
CVTRV438 EQU   CVTXTNT2+85                                              02515000
CVTRV457 EQU   CVTXTNT2+112                                             02516000
CVTRV466 EQU   CVTXTNT2+113                                             02517000
CVTFIX   EQU   0                                                        02518000
CVTRELNO EQU   CVTFIX+252                                               02519000
CPPL     EQU   0                                                        02520000
CPPLCBUF EQU   CPPL                                                     02521000
CPPLUPT  EQU   CPPL+4                                                   02522000
CPPLPSCB EQU   CPPL+8                                                   02523000
CPPLECT  EQU   CPPL+12                                                  02524000
PSCB     EQU   0                                                        02525000
PSCBUSER EQU   PSCB                                                     02526000
PSCBATR1 EQU   PSCB+16                                                  02527000
ECT      EQU   0                                                        02528000
ECTMSGF  EQU   ECT+8                                                    02529000
ECTPCMD  EQU   ECT+12                                                   02530000
ECTSCMD  EQU   ECT+20                                                   02531000
ECTSWS   EQU   ECT+28                                                   02532000
ECTNOPD  EQU   ECTSWS                                                   02533000
ECTATRM  EQU   ECTSWS                                                   02534000
IOPL     EQU   0                                                        02535000
IOPLUPT  EQU   IOPL                                                     02536000
IOPLECT  EQU   IOPL+4                                                   02537000
IOPLECB  EQU   IOPL+8                                                   02538000
IOPLIOPB EQU   IOPL+12                                                  02539000
PGPB     EQU   0                                                        02540000
PGPBIBUF EQU   PGPB+12                                                  02541000
PTPB     EQU   0                                                        02542000
CSPL     EQU   0                                                        02543000
CSPLFLG  EQU   CSPL+12                                                  02544000
CSPLOA   EQU   CSPL+16                                                  02545000
CSPLCBUF EQU   CSPL+20                                                  02546000
CSOA     EQU   0                                                        02547000
CSOACNM  EQU   CSOA                                                     02548000
CSOALNM  EQU   CSOA+4                                                   02549000
CSOAFLG  EQU   CSOA+6                                                   02550000
CSOAVNP  EQU   CSOAFLG                                                  02551000
CSOANOC  EQU   CSOAFLG                                                  02552000
CSOABAD  EQU   CSOAFLG                                                  02553000
DAPL     EQU   0                                                        02554000
DAPLPSCB EQU   DAPL+12                                                  02555000
DAPLDAPB EQU   DAPL+16                                                  02556000
DAPB2C   EQU   0                                                        02557000
DA2CCD   EQU   DAPB2C                                                   02558000
DA2CFLG  EQU   DAPB2C+2                                                 02559000
DA2CTCB  EQU   DAPB2C+4                                                 02560000
STPB     EQU   0                                                        02561000
@NM00039 EQU   STPB                                                     02562000
CMDNAME  EQU   0                                                        02563000
ATMCT    EQU   0                                                        02564000
CVTS01   EQU   CVTPGSIA                                                 02565000
CVTLPDIA EQU   CVTS01+12                                                02566000
CVTDIRST EQU   CVTLPDIA                                                 02567000
CVTSLIDA EQU   CVTS01+24                                                02568000
CVTCTLFG EQU   CVTS01+50                                                02569000
CVTRV210 EQU   CVTS01+424                                               02570000
CVTRV219 EQU   CVTS01+425                                               02571000
CVTRV228 EQU   CVTS01+426                                               02572000
CVTRV237 EQU   CVTS01+427                                               02573000
CVTMFRTR EQU   CVTS01+452                                               02574000
CVTRV262 EQU   CVTS01+468                                               02575000
CVTRV271 EQU   CVTS01+469                                               02576000
CVTRV280 EQU   CVTS01+470                                               02577000
CVTRV289 EQU   CVTS01+471                                               02578000
CVTGSDA  EQU   CVTS01+600                                               02579000
PSCBPTR  EQU   CPPLPSCB                                                 02580000
ECTPTR   EQU   CPPLECT                                                  02581000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02582000
CVTRV628 EQU   CVTS01+728                                               02583000
CVTRV627 EQU   CVTS01+724                                               02584000
CVTRV626 EQU   CVTS01+720                                               02585000
CVTRV625 EQU   CVTS01+716                                               02586000
CVTRV624 EQU   CVTS01+712                                               02587000
CVTRV623 EQU   CVTS01+708                                               02588000
CVTRV622 EQU   CVTS01+704                                               02589000
CVTRV621 EQU   CVTS01+700                                               02590000
CVTRV620 EQU   CVTS01+696                                               02591000
CVTRV619 EQU   CVTS01+692                                               02592000
CVTRV618 EQU   CVTS01+688                                               02593000
CVTRV617 EQU   CVTS01+684                                               02594000
CVTRV616 EQU   CVTS01+680                                               02595000
CVTRV615 EQU   CVTS01+676                                               02596000
CVTRV614 EQU   CVTS01+672                                               02597000
CVTRV613 EQU   CVTS01+668                                               02598000
CVTRV612 EQU   CVTS01+664                                               02599000
CVTRV611 EQU   CVTS01+660                                               02600000
CVTRV610 EQU   CVTS01+656                                               02601000
CVTRV609 EQU   CVTS01+652                                               02602000
CVTRV608 EQU   CVTS01+648                                               02603000
CVTRV607 EQU   CVTS01+644                                               02604000
CVTRV606 EQU   CVTS01+640                                               02605000
CVTRV605 EQU   CVTS01+636                                               02606000
CVTRV604 EQU   CVTS01+632                                               02607000
CVTEFF02 EQU   CVTS01+628                                               02608000
CVTCBBR  EQU   CVTS01+624                                               02609000
CVTSSCR  EQU   CVTS01+620                                               02610000
CVTEVENT EQU   CVTS01+616                                               02611000
CVTCRCA  EQU   CVTS01+612                                               02612000
CVTTPIO  EQU   CVTS01+608                                               02613000
CVTADV   EQU   CVTS01+604                                               02614000
CVTGSDAB EQU   CVTGSDA                                                  02615000
CVTQV3   EQU   CVTS01+596                                               02616000
CVTQV2   EQU   CVTS01+592                                               02617000
CVTQV1   EQU   CVTS01+588                                               02618000
CVTRPT   EQU   CVTS01+584                                               02619000
CVTSSRB  EQU   CVTS01+580                                               02620000
CVTCSDRL EQU   CVTS01+576                                               02621000
CVTEXP1  EQU   CVTS01+572                                               02622000
CVTRMPMT EQU   CVTS01+568                                               02623000
CVTRMPTT EQU   CVTS01+564                                               02624000
CVTVPSA  EQU   CVTS01+560                                               02625000
CVTVSTOP EQU   CVTS01+556                                               02626000
CVTGTFR8 EQU   CVTS01+552                                               02627000
CVTQUIT  EQU   CVTS01+548                                               02628000
CVTVACR  EQU   CVTS01+544                                               02629000
CVTWTCB  EQU   CVTS01+540                                               02630000
CVTSTPRS EQU   CVTS01+536                                               02631000
CVT0PT02 EQU   CVTS01+532                                               02632000
CVTDARCM EQU   CVTS01+528                                               02633000
CVTIRECM EQU   CVTS01+524                                               02634000
CVTJRECM EQU   CVTS01+520                                               02635000
CVTVEMS0 EQU   CVTS01+516                                               02636000
CVTSPFRR EQU   CVTS01+512                                               02637000
CVTRLSTG EQU   CVTS01+508                                               02638000
CVT0TC0A EQU   CVTS01+504                                               02639000
CVTGMBR  EQU   CVTS01+500                                               02640000
CVTLFRM  EQU   CVTS01+496                                               02641000
CVTRMBR  EQU   CVTS01+492                                               02642000
CVTVIOP  EQU   CVTS01+488                                               02643000
CVTRV307 EQU   CVTS01+486                                               02644000
CVTRV306 EQU   CVTS01+484                                               02645000
CVTRV305 EQU   CVTS01+482                                               02646000
CVTRV304 EQU   CVTS01+480                                               02647000
CVTRV303 EQU   CVTS01+478                                               02648000
CVTRV302 EQU   CVTS01+476                                               02649000
CVTTRCA  EQU   CVTS01+472                                               02650000
CVTRV297 EQU   CVTRV289                                                 02651000
CVTRV296 EQU   CVTRV289                                                 02652000
CVTRV295 EQU   CVTRV289                                                 02653000
CVTRV294 EQU   CVTRV289                                                 02654000
CVTRV293 EQU   CVTRV289                                                 02655000
CVTRV292 EQU   CVTRV289                                                 02656000
CVTRV291 EQU   CVTRV289                                                 02657000
CVTRV290 EQU   CVTRV289                                                 02658000
CVTRV288 EQU   CVTRV280                                                 02659000
CVTRV287 EQU   CVTRV280                                                 02660000
CVTRV286 EQU   CVTRV280                                                 02661000
CVTRV285 EQU   CVTRV280                                                 02662000
CVTRV284 EQU   CVTRV280                                                 02663000
CVTRV283 EQU   CVTRV280                                                 02664000
CVTRV282 EQU   CVTRV280                                                 02665000
CVTRV281 EQU   CVTRV280                                                 02666000
CVTRV279 EQU   CVTRV271                                                 02667000
CVTRV278 EQU   CVTRV271                                                 02668000
CVTRV277 EQU   CVTRV271                                                 02669000
CVTRV276 EQU   CVTRV271                                                 02670000
CVTRV275 EQU   CVTRV271                                                 02671000
CVTRV274 EQU   CVTRV271                                                 02672000
CVTRV273 EQU   CVTRV271                                                 02673000
CVTRV272 EQU   CVTRV271                                                 02674000
CVTRV270 EQU   CVTRV262                                                 02675000
CVTRV269 EQU   CVTRV262                                                 02676000
CVTRV268 EQU   CVTRV262                                                 02677000
CVTRV267 EQU   CVTRV262                                                 02678000
CVTRV266 EQU   CVTRV262                                                 02679000
CVTRV265 EQU   CVTRV262                                                 02680000
CVTRV264 EQU   CVTRV262                                                 02681000
CVTRV263 EQU   CVTRV262                                                 02682000
CVTVFP   EQU   CVTS01+464                                               02683000
CVTVSI   EQU   CVTS01+460                                               02684000
CVTVPSIB EQU   CVTS01+456                                               02685000
CVTMFACT EQU   CVTMFRTR                                                 02686000
CVTMFCTL EQU   CVTS01+448                                               02687000
CVTPVBP  EQU   CVTS01+444                                               02688000
CVTPWI   EQU   CVTS01+440                                               02689000
CVTRV254 EQU   CVTS01+438                                               02690000
CVTRV253 EQU   CVTS01+436                                               02691000
CVTRV252 EQU   CVTS01+434                                               02692000
CVTRV251 EQU   CVTS01+433                                               02693000
CVTRV250 EQU   CVTS01+432                                               02694000
CVTRV249 EQU   CVTS01+431                                               02695000
CVTRV248 EQU   CVTS01+430                                               02696000
CVTRV247 EQU   CVTS01+429                                               02697000
CVTRV246 EQU   CVTS01+428                                               02698000
CVTRV245 EQU   CVTRV237                                                 02699000
CVTRV244 EQU   CVTRV237                                                 02700000
CVTRV243 EQU   CVTRV237                                                 02701000
CVTRV242 EQU   CVTRV237                                                 02702000
CVTRV241 EQU   CVTRV237                                                 02703000
CVTRV240 EQU   CVTRV237                                                 02704000
CVTRV239 EQU   CVTRV237                                                 02705000
CVTRV238 EQU   CVTRV237                                                 02706000
CVTRV236 EQU   CVTRV228                                                 02707000
CVTRV235 EQU   CVTRV228                                                 02708000
CVTRV234 EQU   CVTRV228                                                 02709000
CVTRV233 EQU   CVTRV228                                                 02710000
CVTRV232 EQU   CVTRV228                                                 02711000
CVTRV231 EQU   CVTRV228                                                 02712000
CVTRV230 EQU   CVTRV228                                                 02713000
CVTRV229 EQU   CVTRV228                                                 02714000
CVTRV227 EQU   CVTRV219                                                 02715000
CVTRV226 EQU   CVTRV219                                                 02716000
CVTRV225 EQU   CVTRV219                                                 02717000
CVTRV224 EQU   CVTRV219                                                 02718000
CVTRV223 EQU   CVTRV219                                                 02719000
CVTRV222 EQU   CVTRV219                                                 02720000
CVTRV221 EQU   CVTRV219                                                 02721000
CVTRV220 EQU   CVTRV219                                                 02722000
CVTRV218 EQU   CVTRV210                                                 02723000
CVTRV217 EQU   CVTRV210                                                 02724000
CVTRV216 EQU   CVTRV210                                                 02725000
CVTRV215 EQU   CVTRV210                                                 02726000
CVTRV214 EQU   CVTRV210                                                 02727000
CVTRV213 EQU   CVTRV210                                                 02728000
CVTRV212 EQU   CVTRV210                                                 02729000
CVTRV211 EQU   CVTRV210                                                 02730000
CVTLCCAT EQU   CVTS01+420                                               02731000
CVTPCCAT EQU   CVTS01+416                                               02732000
CVTIPCRP EQU   CVTS01+412                                               02733000
CVTIPCRI EQU   CVTS01+408                                               02734000
CVTIPCDS EQU   CVTS01+404                                               02735000
CVTAIDVT EQU   CVTS01+400                                               02736000
CVTSSAP  EQU   CVTS01+396                                               02737000
CVTEHCIR EQU   CVTS01+392                                               02738000
CVTEHDEF EQU   CVTS01+388                                               02739000
CVTDAIR  EQU   CVTS01+384                                               02740000
CVTPERFM EQU   CVTS01+380                                               02741000
CVT044R2 EQU   CVTS01+376                                               02742000
CVTFETCH EQU   CVTS01+372                                               02743000
CVTRSTWD EQU   CVTS01+368                                               02744000
CVTSPOST EQU   CVTS01+364                                               02745000
CVTIOBP  EQU   CVTS01+360                                               02746000
CVTASMVT EQU   CVTS01+356                                               02747000
CVTRECRQ EQU   CVTS01+352                                               02748000
CVTWSAC  EQU   CVTS01+348                                               02749000
CVTRV149 EQU   CVTS01+344                                               02750000
CVTWSAL  EQU   CVTS01+340                                               02751000
CVTSPSA  EQU   CVTS01+336                                               02752000
CVTGLMN  EQU   CVTS01+332                                               02753000
CVTVEAC0 EQU   CVTS01+328                                               02754000
CVT062R1 EQU   CVTS01+324                                               02755000
CVTRPOST EQU   CVTS01+320                                               02756000
CVTDQIQE EQU   CVTS01+316                                               02757000
CVTCSD   EQU   CVTS01+312                                               02758000
CVTLKRMA EQU   CVTS01+308                                               02759000
CVTRSPIE EQU   CVTS01+304                                               02760000
CVTRENQ  EQU   CVTS01+300                                               02761000
CVTLQCB  EQU   CVTS01+296                                               02762000
CVTFQCB  EQU   CVTS01+292                                               02763000
CVTQCS01 EQU   CVTS01+288                                               02764000
CVTAPFT  EQU   CVTS01+284                                               02765000
CVTPARRL EQU   CVTS01+280                                               02766000
CVTVWAIT EQU   CVTS01+276                                               02767000
CVTGSPL  EQU   CVTS01+272                                               02768000
CVTLSMQ  EQU   CVTS01+268                                               02769000
CVTGSMQ  EQU   CVTS01+264                                               02770000
CVTEXPRO EQU   CVTS01+260                                               02771000
CVTOPCTP EQU   CVTS01+256                                               02772000
CVTSIC   EQU   CVTS01+252                                               02773000
CVTTPIOS EQU   CVTS01+248                                               02774000
CVTRTMS  EQU   CVTS01+244                                               02775000
CVTSDBF  EQU   CVTS01+240                                               02776000
CVTSCBP  EQU   CVTS01+236                                               02777000
CVTSDMP  EQU   CVTS01+232                                               02778000
CVTSV60  EQU   CVTS01+228                                               02779000
CVTRTMCT EQU   CVTS01+224                                               02780000
CVTASCBL EQU   CVTS01+220                                               02781000
CVTASCBH EQU   CVTS01+216                                               02782000
CVTGDA   EQU   CVTS01+212                                               02783000
CVTASVT  EQU   CVTS01+208                                               02784000
CVTVVMDI EQU   CVTS01+204                                               02785000
CVTAQTOP EQU   CVTS01+200                                               02786000
CVTIOSCS EQU   CVTS01+196                                               02787000
CVTSDRM  EQU   CVTS01+192                                               02788000
CVTOPTE  EQU   CVTS01+188                                               02789000
CVTSTXU  EQU   CVTS01+184                                               02790000
CVTQUIS  EQU   CVTS01+180                                               02791000
CVTPARS  EQU   CVTS01+176                                               02792000
CVTS1EE  EQU   CVTS01+172                                               02793000
CVTFRAS  EQU   CVTS01+168                                               02794000
CVTQSAS  EQU   CVTS01+164                                               02795000
CVTCRAS  EQU   CVTS01+160                                               02796000
CVTCRMN  EQU   CVTS01+156                                               02797000
CVTDELCP EQU   CVTS01+152                                               02798000
CVTFRECL EQU   CVTS01+148                                               02799000
CVTGETCL EQU   CVTS01+144                                               02800000
CVTBLDCP EQU   CVTS01+140                                               02801000
CVTAUTHL EQU   CVTS01+136                                               02802000
CVTSCAN  EQU   CVTS01+132                                               02803000
CVTRV144 EQU   CVTS01+130                                               02804000
CVTMAXMP EQU   CVTS01+128                                               02805000
CVTSTCK  EQU   CVTS01+124                                               02806000
CVTRV139 EQU   CVTS01+123                                               02807000
CVTDSSAC EQU   CVTS01+122                                               02808000
CVTRV513 EQU   CVTS01+121                                               02809000
CVTIOSPL EQU   CVTS01+120                                               02810000
CVTPTGT  EQU   CVTS01+116                                               02811000
CVTCSPIE EQU   CVTS01+112                                               02812000
CVTSMFEX EQU   CVTS01+108                                               02813000
CVTOLT0A EQU   CVTS01+104                                               02814000
CVTSRBRT EQU   CVTS01+100                                               02815000
CVTPUTL  EQU   CVTS01+96                                                02816000
CVTRV519 EQU   CVTS01+92                                                02817000
CVTRV327 EQU   CVTS01+88                                                02818000
CVTRV326 EQU   CVTS01+84                                                02819000
CVTRV325 EQU   CVTS01+80                                                02820000
CVTRV324 EQU   CVTS01+76                                                02821000
CVT0VL01 EQU   CVTS01+72                                                02822000
CVTSHRVM EQU   CVTS01+68                                                02823000
CVTRV332 EQU   CVTS01+64                                                02824000
CVTTAS   EQU   CVTS01+60                                                02825000
CVTRSCN  EQU   CVTS01+56                                                02826000
CVTTRAC2 EQU   CVTS01+54                                                02827000
CVTTRACE EQU   CVTS01+52                                                02828000
CVTAPG   EQU   CVTS01+51                                                02829000
CVTSDTRC EQU   CVTCTLFG                                                 02830000
CVTGTRCE EQU   CVTCTLFG                                                 02831000
CVTNOMP  EQU   CVTCTLFG                                                 02832000
CVTRSV79 EQU   CVTCTLFG                                                 02833000
CVTDSTAT EQU   CVTCTLFG                                                 02834000
CVTRSV78 EQU   CVTCTLFG                                                 02835000
CVTRV333 EQU   CVTCTLFG                                                 02836000
CVTRV323 EQU   CVTCTLFG                                                 02837000
CVTSPVLK EQU   CVTS01+49                                                02838000
CVTRSV77 EQU   CVTS01+48                                                02839000
CVTRV331 EQU   CVTS01+44                                                02840000
CVTRV330 EQU   CVTS01+40                                                02841000
CVTRV329 EQU   CVTS01+36                                                02842000
CVTRV328 EQU   CVTS01+32                                                02843000
CVTRV322 EQU   CVTS01+28                                                02844000
CVTSLID  EQU   CVTSLIDA+1                                               02845000
CVTSYLK  EQU   CVTSLIDA                                                 02846000
CVTRV321 EQU   CVTS01+20                                                02847000
CVTRV320 EQU   CVTS01+16                                                02848000
CVTLPDIR EQU   CVTLPDIA+1                                               02849000
CVTRSV69 EQU   CVTDIRST                                                 02850000
CVTRSV68 EQU   CVTDIRST                                                 02851000
CVTRSV67 EQU   CVTDIRST                                                 02852000
CVTRSV66 EQU   CVTDIRST                                                 02853000
CVTRSV65 EQU   CVTDIRST                                                 02854000
CVTRSV64 EQU   CVTDIRST                                                 02855000
CVTRSV63 EQU   CVTDIRST                                                 02856000
CVTDICOM EQU   CVTDIRST                                                 02857000
CVTPVTP  EQU   CVTS01+8                                                 02858000
CVTLPDSR EQU   CVTS01+4                                                 02859000
CVTGETL  EQU   CVTS01                                                   02860000
STPBMBRN EQU   STPB+16                                                  02861000
STPBOTDD EQU   STPB+12                                                  02862000
STPBINDD EQU   STPB+8                                                   02863000
STPBALSD EQU   STPB+4                                                   02864000
@NM00042 EQU   @NM00039+1                                               02865000
SPBFLUSH EQU   @NM00039+1                                               02866000
@NM00041 EQU   @NM00039+1                                               02867000
@NM00040 EQU   @NM00039                                                 02868000
DA2CDDN  EQU   DAPB2C+8                                                 02869000
DAPLECB  EQU   DAPL+8                                                   02870000
DAPLECT  EQU   DAPL+4                                                   02871000
DAPLUPT  EQU   DAPL                                                     02872000
@NM00038 EQU   CSOA+7                                                   02873000
@NM00037 EQU   CSOAFLG                                                  02874000
@NM00036 EQU   CSOAFLG                                                  02875000
CSOAEXEC EQU   CSOAFLG                                                  02876000
CSOAQM   EQU   CSOAFLG                                                  02877000
CSOAVWP  EQU   CSOAFLG                                                  02878000
CSPLECB  EQU   CSPL+8                                                   02879000
CSPLECT  EQU   CSPL+4                                                   02880000
CSPLUPT  EQU   CSPL                                                     02881000
PTPBFLN  EQU   PTPB+8                                                   02882000
PTPBOPUT EQU   PTPB+4                                                   02883000
@NM00035 EQU   PTPB                                                     02884000
@NM00034 EQU   PGPB                                                     02885000
ECTBKPB  EQU   ECT+36                                                   02886000
ECTUSER  EQU   ECT+32                                                   02887000
ECTDDNUM EQU   ECT+29                                                   02888000
ECTATTN  EQU   ECTSWS                                                   02889000
ECTBKGRD EQU   ECTSWS                                                   02890000
ECTNNOT  EQU   ECTSWS                                                   02891000
ECTNMAL  EQU   ECTSWS                                                   02892000
ECTLOGF  EQU   ECTSWS                                                   02893000
@NM00033 EQU   ECTSWS                                                   02894000
ECTSMSG  EQU   ECT+9                                                    02895000
ECTIOWA  EQU   ECT+4                                                    02896000
ECTRTCD  EQU   ECT+1                                                    02897000
ECTRCDF  EQU   ECT                                                      02898000
PSCBU    EQU   PSCB+64                                                  02899000
PSCBRSZ  EQU   PSCB+60                                                  02900000
PSCBLINE EQU   PSCB+59                                                  02901000
PSCBCHAR EQU   PSCB+58                                                  02902000
PSCBUPTL EQU   PSCB+56                                                  02903000
PSCBUPT  EQU   PSCB+52                                                  02904000
PSCBRLGB EQU   PSCB+48                                                  02905000
PSCBDEST EQU   PSCB+40                                                  02906000
@NM00032 EQU   PSCB+36                                                  02907000
@NM00031 EQU   PSCB+32                                                  02908000
@NM00030 EQU   PSCB+28                                                  02909000
PSCBLTI2 EQU   PSCB+24                                                  02910000
PSCBLTIM EQU   PSCB+20                                                  02911000
PSCBATR2 EQU   PSCB+18                                                  02912000
@NM00029 EQU   PSCBATR1                                                 02913000
@NM00028 EQU   PSCBATR1                                                 02914000
@NM00027 EQU   PSCBATR1                                                 02915000
PSCBATTN EQU   PSCBATR1                                                 02916000
PSCBVMNT EQU   PSCBATR1                                                 02917000
PSCBJCL  EQU   PSCBATR1                                                 02918000
PSCBACCT EQU   PSCBATR1                                                 02919000
PSCBCTRL EQU   PSCBATR1                                                 02920000
PSCBGPNM EQU   PSCB+8                                                   02921000
PSCBUSRL EQU   PSCB+7                                                   02922000
CVTLEVL  EQU   CVTRELNO+2                                               02923000
CVTNUMB  EQU   CVTRELNO                                                 02924000
CVTMDL   EQU   CVTFIX+250                                               02925000
@NM00022 EQU   CVTFIX+248                                               02926000
@NM00021 EQU   CVTFIX                                                   02927000
CVTRV482 EQU   CVTXTNT2+128                                             02928000
CVTRV481 EQU   CVTXTNT2+124                                             02929000
CVTRV480 EQU   CVTXTNT2+120                                             02930000
CVTRV479 EQU   CVTXTNT2+118                                             02931000
CVTRV478 EQU   CVTXTNT2+117                                             02932000
CVTRV477 EQU   CVTXTNT2+116                                             02933000
CVTRV476 EQU   CVTXTNT2+115                                             02934000
CVTRV475 EQU   CVTXTNT2+114                                             02935000
CVTRV474 EQU   CVTRV466                                                 02936000
CVTRV473 EQU   CVTRV466                                                 02937000
CVTRV472 EQU   CVTRV466                                                 02938000
CVTRV471 EQU   CVTRV466                                                 02939000
CVTRV470 EQU   CVTRV466                                                 02940000
CVTRV469 EQU   CVTRV466                                                 02941000
CVTRV468 EQU   CVTRV466                                                 02942000
CVTRV467 EQU   CVTRV466                                                 02943000
CVTRV465 EQU   CVTRV457                                                 02944000
CVTRV464 EQU   CVTRV457                                                 02945000
CVTRV463 EQU   CVTRV457                                                 02946000
CVTRV462 EQU   CVTRV457                                                 02947000
CVTRV461 EQU   CVTRV457                                                 02948000
CVTRV460 EQU   CVTRV457                                                 02949000
CVTRV459 EQU   CVTRV457                                                 02950000
CVTRV458 EQU   CVTRV457                                                 02951000
CVTRV456 EQU   CVTXTNT2+108                                             02952000
CVTRV455 EQU   CVTXTNT2+104                                             02953000
CVTRV454 EQU   CVTXTNT2+100                                             02954000
CVTRV453 EQU   CVTXTNT2+96                                              02955000
CVTRV452 EQU   CVTXTNT2+94                                              02956000
CVTRV451 EQU   CVTXTNT2+92                                              02957000
CVTRV450 EQU   CVTXTNT2+90                                              02958000
CVTRV449 EQU   CVTXTNT2+88                                              02959000
CVTRV448 EQU   CVTXTNT2+87                                              02960000
CVTRV447 EQU   CVTXTNT2+86                                              02961000
CVTRV446 EQU   CVTRV438                                                 02962000
CVTRV445 EQU   CVTRV438                                                 02963000
CVTRV444 EQU   CVTRV438                                                 02964000
CVTRV443 EQU   CVTRV438                                                 02965000
CVTRV442 EQU   CVTRV438                                                 02966000
CVTRV441 EQU   CVTRV438                                                 02967000
CVTRV440 EQU   CVTRV438                                                 02968000
CVTRV439 EQU   CVTRV438                                                 02969000
CVTRV437 EQU   CVTRV429                                                 02970000
CVTRV436 EQU   CVTRV429                                                 02971000
CVTRV435 EQU   CVTRV429                                                 02972000
CVTRV434 EQU   CVTRV429                                                 02973000
CVTRV433 EQU   CVTRV429                                                 02974000
CVTRV432 EQU   CVTRV429                                                 02975000
CVTRV431 EQU   CVTRV429                                                 02976000
CVTRV430 EQU   CVTRV429                                                 02977000
CVTRV428 EQU   CVTXTNT2+80                                              02978000
CVTRV427 EQU   CVTXTNT2+76                                              02979000
CVTRV426 EQU   CVTXTNT2+72                                              02980000
CVTRV425 EQU   CVTXTNT2+68                                              02981000
CVTATACT EQU   CVTATCVT                                                 02982000
CVTRV423 EQU   CVTXTNT2+62                                              02983000
CVTRV422 EQU   CVTXTNT2+60                                              02984000
CVTRV421 EQU   CVTXTNT2+58                                              02985000
CVTRV420 EQU   CVTXTNT2+56                                              02986000
CVTRV419 EQU   CVTXTNT2+55                                              02987000
CVTRV418 EQU   CVTXTNT2+54                                              02988000
CVTRV417 EQU   CVTRV409                                                 02989000
CVTRV416 EQU   CVTRV409                                                 02990000
CVTRV415 EQU   CVTRV409                                                 02991000
CVTRV414 EQU   CVTRV409                                                 02992000
CVTRV413 EQU   CVTRV409                                                 02993000
CVTRV412 EQU   CVTRV409                                                 02994000
CVTRV411 EQU   CVTRV409                                                 02995000
CVTRV410 EQU   CVTRV409                                                 02996000
CVTRV408 EQU   CVTRV400                                                 02997000
CVTRV407 EQU   CVTRV400                                                 02998000
CVTRV406 EQU   CVTRV400                                                 02999000
CVTRV405 EQU   CVTRV400                                                 03000000
CVTRV404 EQU   CVTRV400                                                 03001000
CVTRV403 EQU   CVTRV400                                                 03002000
CVTRV402 EQU   CVTRV400                                                 03003000
CVTRV401 EQU   CVTRV400                                                 03004000
CVTICB   EQU   CVTXTNT2+48                                              03005000
CVTSKTA  EQU   CVTXTNT2+44                                              03006000
CVTRSV99 EQU   CVTXTNT2+40                                              03007000
CVTRSV98 EQU   CVTXTNT2+36                                              03008000
CVTRSV97 EQU   CVTXTNT2+34                                              03009000
CVTRSV96 EQU   CVTXTNT2+32                                              03010000
CVTOLTEP EQU   CVTXTNT2+28                                              03011000
CVTQIDA  EQU   CVTQID+1                                                 03012000
CVTRSV95 EQU   CVTQID                                                   03013000
CVTRSV94 EQU   CVTXTNT2+20                                              03014000
CVTRSV93 EQU   CVTXTNT2+16                                              03015000
CVTRSV92 EQU   CVTXTNT2+12                                              03016000
CVTDEBVR EQU   CVTXTNT2+8                                               03017000
CVTRSV91 EQU   CVTXTNT2+6                                               03018000
CVTRSV9H EQU   CVTFLGBT                                                 03019000
CVTRSV9G EQU   CVTFLGBT                                                 03020000
CVTRSV9F EQU   CVTFLGBT                                                 03021000
CVTRSV9E EQU   CVTFLGBT                                                 03022000
CVTRSV9D EQU   CVTFLGBT                                                 03023000
CVTRSV9C EQU   CVTFLGBT                                                 03024000
CVTVME   EQU   CVTFLGBT                                                 03025000
CVTNPE   EQU   CVTFLGBT                                                 03026000
CVTNUCLS EQU   CVTXTNT2+4                                               03027000
CVTDSSVA EQU   CVTDSSV+1                                                03028000
CVTRSV89 EQU   CVTDSSV                                                  03029000
CVTRSV88 EQU   CVTXTNT1+8                                               03030000
CVTRSV87 EQU   CVTXTNT1+4                                               03031000
CVTFACHN EQU   CVTXTNT1                                                 03032000
CVTRV488 EQU   CVTMAP+412                                               03033000
CVTRV487 EQU   CVTMAP+408                                               03034000
CVTRV486 EQU   CVTMAP+404                                               03035000
CVTRV485 EQU   CVTMAP+400                                               03036000
CVTACTAP EQU   CVTMAP+396                                               03037000
CVTAUTH  EQU   CVTMAP+392                                               03038000
CVTATMCA EQU   CVTATMCT+1                                               03039000
CVTATMST EQU   CVTATMCT                                                 03040000
CVTRSV61 EQU   CVTMAP+384                                               03041000
CVTVOLT1 EQU   CVTVOLM1+1                                               03042000
CVTVOLI1 EQU   CVTVOLF1                                                 03043000
CVTSTOA  EQU   CVTMAP+376                                               03044000
CVTRSV58 EQU   CVTMAP+374                                               03045000
CVTRSV57 EQU   CVTMAP+372                                               03046000
CVTDDCE  EQU   CVTMAP+368                                               03047000
CVTPNWFR EQU   CVTMAP+364                                               03048000
CVTSMF   EQU   CVTMAP+360                                               03049000
CVTSULK  EQU   CVTMAP+358                                               03050000
CVTSLKO  EQU   CVTSYSK                                                  03051000
CVTSLKP  EQU   CVTSYSK                                                  03052000
CVTSLKQ  EQU   CVTSYSK                                                  03053000
CVTSLKR  EQU   CVTSYSK                                                  03054000
CVTRSV56 EQU   CVTSYSK                                                  03055000
CVTRSV55 EQU   CVTSYSK                                                  03056000
CVTRSV54 EQU   CVTSYSK                                                  03057000
CVTRSV53 EQU   CVTSYSK                                                  03058000
CVTRSV52 EQU   CVTA1F1                                                  03059000
CVTRSV51 EQU   CVTA1F1                                                  03060000
CVTRSV50 EQU   CVTA1F1                                                  03061000
CVTRSV49 EQU   CVTA1F1                                                  03062000
CVTRSV48 EQU   CVTA1F1                                                  03063000
CVTRSV47 EQU   CVTA1F1                                                  03064000
CVTSRSW  EQU   CVTA1F1                                                  03065000
CVTPFSW  EQU   CVTA1F1                                                  03066000
CVTPCVT  EQU   CVTMAP+352                                               03067000
CVTRSV46 EQU   CVTMAP+344                                               03068000
CVTRSV45 EQU   CVTMAP+340                                               03069000
CVTRSV44 EQU   CVTMAP+338                                               03070000
CVTRSV43 EQU   CVTMAP+336                                               03071000
CVTHJESA EQU   CVTHJES+1                                                03072000
CVTRSV42 EQU   CVTHJES                                                  03073000
CVTEXT2A EQU   CVTEXT2+1                                                03074000
CVTRSV41 EQU   CVTEXT2                                                  03075000
CVTAPFA  EQU   CVTAPF+1                                                 03076000
CVTRSV40 EQU   CVTAPF                                                   03077000
CVTRV518 EQU   CVTINTLA                                                 03078000
CVTRV517 EQU   CVTERPV                                                  03079000
CVTEORM  EQU   CVTMAP+312                                               03080000
CVTMCHPR EQU   CVTMAP+308                                               03081000
CVTTZ    EQU   CVTMAP+304                                               03082000
CVTJEPS  EQU   CVTMAP+300                                               03083000
CVTJESCT EQU   CVTMAP+296                                               03084000
CVTMODE  EQU   CVTMAP+292                                               03085000
CVTPTRV  EQU   CVTMAP+288                                               03086000
CVTREAL  EQU   CVTMAP+284                                               03087000
CVTRSV39 EQU   CVTMAP+280                                               03088000
CVTRSV38 EQU   CVTMAP+276                                               03089000
CVTDMSRA EQU   CVTDMSR+1                                                03090000
CVTRSV37 EQU   CVTDMSR                                                  03091000
CVTQMSGA EQU   CVTQMSG+1                                                03092000
CVTRSV36 EQU   CVTQMSG                                                  03093000
CVTAMFF  EQU   CVTMAP+264                                               03094000
CVTPURGA EQU   CVTPURG+1                                                03095000
CVTRSV35 EQU   CVTPURG                                                  03096000
CVTCBSP  EQU   CVTMAP+256                                               03097000
CVTATERA EQU   CVTATER+1                                                03098000
CVTSYST  EQU   CVTATER                                                  03099000
CVTVOLT2 EQU   CVTTAT                                                   03100000
CVTVOLI2 EQU   CVTVOLF2                                                 03101000
CVTAQAVB EQU   CVTAQAVT+1                                               03102000
CVTRSV34 EQU   CVTTCMFG                                                 03103000
CVTRSV33 EQU   CVTTCMFG                                                 03104000
CVTRSV32 EQU   CVTTCMFG                                                 03105000
CVTRSV31 EQU   CVTTCMFG                                                 03106000
CVTRSV30 EQU   CVTTCMFG                                                 03107000
CVTRSV29 EQU   CVTTCMFG                                                 03108000
CVTRSV28 EQU   CVTTCMFG                                                 03109000
CVTTCRDY EQU   CVTTCMFG                                                 03110000
CVTGTFA  EQU   CVTGTF+1                                                 03111000
CVTRSV27 EQU   CVTGTFST                                                 03112000
CVTRNIO  EQU   CVTGTFST                                                 03113000
CVTUSR   EQU   CVTGTFST                                                 03114000
CVTRV318 EQU   CVTFORM                                                  03115000
CVTRV317 EQU   CVTTMODE                                                 03116000
CVTRV316 EQU   CVTSTATE                                                 03117000
CVTRV315 EQU   CVTGTFS                                                  03118000
CVTGTFAV EQU   CVTGTFS                                                  03119000
CVT0SCR1 EQU   CVTMAP+232                                               03120000
CVTRV515 EQU   CVTMAP+228                                               03121000
CVTRMS   EQU   CVTMAP+224                                               03122000
CVTPATCH EQU   CVTMAP+220                                               03123000
CVTTSCE  EQU   CVTMAP+216                                               03124000
CVTLNKSC EQU   CVTMAP+214                                               03125000
CVTQABST EQU   CVTMAP+212                                               03126000
CVTMDLDS EQU   CVTMAP+208                                               03127000
CVTUSER  EQU   CVTMAP+204                                               03128000
CVTABEND EQU   CVTMAP+200                                               03129000
CVTSMCA  EQU   CVTMAP+196                                               03130000
CVTRSV18 EQU   CVTMAP+192                                               03131000
CVTQLPAQ EQU   CVTMAP+188                                               03132000
CVTQCDSR EQU   CVTMAP+184                                               03133000
CVTRSV17 EQU   CVTOPTB                                                  03134000
CVTRSV16 EQU   CVTOPTB                                                  03135000
CVTFP    EQU   CVTOPTB                                                  03136000
CVTAPTHR EQU   CVTOPTB                                                  03137000
CVTNLOG  EQU   CVTOPTB                                                  03138000
CVTTOD   EQU   CVTOPTB                                                  03139000
CVTCTIMS EQU   CVTOPTB                                                  03140000
CVTPROT  EQU   CVTOPTB                                                  03141000
CVTXPFP  EQU   CVTOPTA                                                  03142000
CVTASCII EQU   CVTOPTA                                                  03143000
CVTRSV13 EQU   CVTOPTA                                                  03144000
CVTRSV12 EQU   CVTOPTA                                                  03145000
CVTNIP   EQU   CVTOPTA                                                  03146000
CVTDDR   EQU   CVTOPTA                                                  03147000
CVTAPR   EQU   CVTOPTA                                                  03148000
CVTCCH   EQU   CVTOPTA                                                  03149000
CVTSNCTR EQU   CVTMAP+180                                               03150000
CVTQMWR  EQU   CVTMAP+176                                               03151000
CVTQOCR  EQU   CVTMAP+172                                               03152000
CVT1EF00 EQU   CVTMAP+168                                               03153000
CVTMZ00  EQU   CVTMAP+164                                               03154000
CVTHEAD  EQU   CVTMAP+160                                               03155000
CVTRSV11 EQU   CVTMAP+156                                               03156000
CVT0PT01 EQU   CVTMAP+152                                               03157000
CVTMSER  EQU   CVTMAP+148                                               03158000
CVTRV516 EQU   CVTIERLC                                                 03159000
CVTILCH  EQU   CVTMAP+140                                               03160000
CVT0DS   EQU   CVTMAP+136                                               03161000
CVTFBOSV EQU   CVTMAP+132                                               03162000
CVTNUCB  EQU   CVTMAP+128                                               03163000
CVTIXAVL EQU   CVTMAP+124                                               03164000
CVTIOQET EQU   CVTMAP+120                                               03165000
CVTDCBA  EQU   CVTMAP+117                                               03166000
CVTMVS2  EQU   CVTDCB                                                   03167000
CVT6DAT  EQU   CVTDCB                                                   03168000
CVT4MPS  EQU   CVTDCB                                                   03169000
CVTRSV09 EQU   CVTDCB                                                   03170000
CVT4MS1  EQU   CVTDCB                                                   03171000
CVT2SPS  EQU   CVTDCB                                                   03172000
CVT1SSS  EQU   CVTDCB                                                   03173000
CVTRSV08 EQU   CVTDCB                                                   03174000
CVTSTB   EQU   CVTMAP+112                                               03175000
CVTQTD00 EQU   CVTMAP+108                                               03176000
CVTQTE00 EQU   CVTMAP+104                                               03177000
CVTCUCB  EQU   CVTMAP+100                                               03178000
CVTSJQ   EQU   CVTMAP+96                                                03179000
CVTPBLDL EQU   CVTMAP+92                                                03180000
CVTTPC   EQU   CVTMAP+88                                                03181000
CVTSVDCB EQU   CVTMAP+84                                                03182000
CVTBRET  EQU   CVTMAP+82                                                03183000
CVTEXIT  EQU   CVTMAP+80                                                03184000
CVT0FN00 EQU   CVTMAP+76                                                03185000
CVTDARA  EQU   CVTDAR+1                                                 03186000
CVTRSV07 EQU   CVTFLGS1                                                 03187000
CVTRSV06 EQU   CVTFLGS1                                                 03188000
CVTRSV05 EQU   CVTFLGS1                                                 03189000
CVTRSV04 EQU   CVTFLGS1                                                 03190000
CVTRSV03 EQU   CVTFLGS1                                                 03191000
CVTRSV02 EQU   CVTFLGS1                                                 03192000
CVTRSV01 EQU   CVTFLGS1                                                 03193000
CVTDMPLK EQU   CVTFLGS1                                                 03194000
CVTXITP  EQU   CVTMAP+68                                                03195000
CVTZDTAB EQU   CVTMAP+64                                                03196000
CVTMSLT  EQU   CVTMAP+60                                                03197000
CVTDATE  EQU   CVTMAP+56                                                03198000
CVTBTERM EQU   CVTMAP+52                                                03199000
CVTSYSAD EQU   CVTMAP+48                                                03200000
CVTXTLER EQU   CVTMAP+44                                                03201000
CVTILK2  EQU   CVTMAP+40                                                03202000
CVTILK1  EQU   CVTMAP+36                                                03203000
CVTPRLTV EQU   CVTMAP+32                                                03204000
CVTPCNVT EQU   CVTMAP+28                                                03205000
CVT0VL00 EQU   CVTMAP+24                                                03206000
CVTXAPG  EQU   CVTMAP+20                                                03207000
CVTBUF   EQU   CVTMAP+16                                                03208000
CVTJOB   EQU   CVTMAP+12                                                03209000
CVTLINK  EQU   CVTMAP+8                                                 03210000
CVT0EF00 EQU   CVTMAP+4                                                 03211000
CVTTCBP  EQU   CVTMAP                                                   03212000
CVT      EQU   CVTMAP                                                   03213000
ATTNSHLV EQU   ATTCHLST+56                                              03214000
ATTPLNG  EQU   ATTCHLST+54                                              03215000
@NM00020 EQU   ATTCHLST+53                                              03216000
@NM00019 EQU   ATFLAGS1                                                 03217000
ATNSHRSP EQU   ATFLAGS1                                                 03218000
ATTASKLB EQU   ATTCHLST+48                                              03219000
ATSTAIXT EQU   ATSTAIEX+1                                               03220000
ATPURGE  EQU   ATSTAIF                                                  03221000
ATSYNCH  EQU   ATSTAIF                                                  03222000
ATESTAI  EQU   ATSTAIF                                                  03223000
ATTERM   EQU   ATSTAIF                                                  03224000
@NM00018 EQU   ATSTAIF                                                  03225000
ATSTAIA  EQU   ATSTAIAD+1                                               03226000
ATTID    EQU   ATSTAIAD                                                 03227000
ATJSCBA  EQU   ATJSCBAD+1                                               03228000
ATLSQA   EQU   ATJSCBAD                                                 03229000
ATPRGNM  EQU   ATTCHLST+28                                              03230000
ATMODE   EQU   ATINDS                                                   03231000
ATJSTCB  EQU   ATINDS                                                   03232000
ATSVAREA EQU   ATINDS                                                   03233000
ATSZERO  EQU   ATINDS                                                   03234000
ATKEY    EQU   ATINDS                                                   03235000
ATJPQ    EQU   ATINDS                                                   03236000
ATJSCB   EQU   ATINDS                                                   03237000
ATDISP   EQU   ATINDS                                                   03238000
ATLPMOD  EQU   ATTCHLST+26                                              03239000
ATDPMOD  EQU   ATTCHLST+24                                              03240000
ATETXRB  EQU   ATETXRA+1                                                03241000
ATRLLOUT EQU   ATINDS2                                                  03242000
ATRLABLE EQU   ATINDS2                                                  03243000
@NM00017 EQU   ATINDS2                                                  03244000
ATEXTN   EQU   ATINDS2                                                  03245000
ATNFPRSA EQU   ATINDS2                                                  03246000
ATNTQE   EQU   ATINDS2                                                  03247000
ATSHFLDB EQU   ATSHFLDA+1                                               03248000
ATSHARSP EQU   ATSHFLAG                                                 03249000
@NM00016 EQU   ATSHFLAG                                                 03250000
ATGSFLDB EQU   ATGSFLDA+1                                               03251000
ATGIVESP EQU   ATGSFLAG                                                 03252000
@NM00015 EQU   ATGSFLAG                                                 03253000
ATECBADB EQU   ATECBADR+1                                               03254000
ATTSTAI  EQU   ATECBFLG                                                 03255000
ATTSKLB  EQU   ATECBFLG                                                 03256000
ATLOGON  EQU   ATECBFLG                                                 03257000
ATEXTN2  EQU   ATECBFLG                                                 03258000
@NM00014 EQU   ATECBFLG                                                 03259000
ATDCBADB EQU   ATDCBADA+1                                               03260000
ATHARCHY EQU   ATDCBADA                                                 03261000
ATPGNADB EQU   ATPGNADA+1                                               03262000
@NM00013 EQU   ATDEFLAG                                                 03263000
ATDENTRY EQU   ATDEFLAG                                                 03264000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03265000
@RT00264 EQU   MSGRTN1                                                  03266000
@RT00273 EQU   MSGRTN2                                                  03267000
@RT00301 EQU   OPERABIL                                                 03268000
@RT00303 EQU   MSGRTN3                                                  03269000
@RT00313 EQU   HELP                                                     03270000
@RT00315 EQU   HELP                                                     03271000
@RT00319 EQU   MSGRTN7                                                  03272000
@RF00317 EQU   MSGRTN3                                                  03273000
@RT00375 EQU   ATTN                                                     03274000
@RT00385 EQU   OPERABIL                                                 03275000
@RT00387 EQU   MSGRTN3                                                  03276000
@RT00389 EQU   MSGRTN5                                                  03277000
@RT00531 EQU   ATTN                                                     03278000
@RT00621 EQU   @EL00003                                                 03279000
@RF00610 EQU   @EL00003                                                 03280000
@RF00619 EQU   @EL00003                                                 03281000
@RT00655 EQU   ATTN                                                     03282000
@RT00732 EQU   ATTN                                                     03283000
@PB00006 EQU   @EL00001                                                 03284000
@ENDDATA EQU   *                                                        03285000
         END   IKJEE100,(C'PLS1814',0701,75350)                         03286000
