         TITLE 'IKJEFA00  --  ACCOUNT EXECUTOR ROUTINE                 *00001000
                        '                                               00002000
IKJEFA00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFA00  74.038'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
*          CPPLPTR = R1;              /* SET PTR TO TMP PARM LIST    */ 00022000
         LR    CPPLPTR,R1                                          0059 00023000
*          RFY R1 UNRSTD;             /* RELEASE INPUT POINTER       */ 00024000
*          ACCTECB = 0;               /* CLEAR ACCOUNT ECB           */ 00025000
         SLR   @10,@10                                             0061 00026000
         ST    @10,ACCTECB                                         0061 00027000
*          ACCTLF = 0;                /* CLEAR CONTROL FLAG AREA     */ 00028000
         STH   @10,ACCTLF                                          0062 00029000
*          ECTPTR = CPPLECT;          /* PTR TO ECT                  */ 00030000
         L     @09,CPPLECT(,CPPLPTR)                               0063 00031000
         LR    ECTPTR,@09                                          0063 00032000
*          /* BUILD PARAMETER LIST FOR SEND INTERFACE ROUTINE        */ 00033000
*          SNDPPL(1:16) = CPPL;       /* INITIALIZE SEND PARM LIST   */ 00034000
         MVC   SNDPPL(16),CPPL(CPPLPTR)                            0064 00035000
*          SPLUDL = 0;                /* CLEAR PTR TO UDL            */ 00036000
         ST    @10,SPLUDL                                          0065 00037000
*          SPLECB = ADDR(ACCTECB);    /* SET PTR TO ACCOUNT ECB      */ 00038000
         LA    @03,ACCTECB                                         0066 00039000
         ST    @03,SPLECB                                          0066 00040000
*          /* SET UP PARAMETER LIST BASE VALUES                      */ 00041000
*          BASUPTP = CPPLUPT;         /* SET UP CURRENT UPT LOC      */ 00042000
         L     @15,CPPLUPT(,CPPLPTR)                               0067 00043000
         ST    @15,BASUPTP                                         0067 00044000
*          BASECTP = CPPLECT;         /* SET UP CURRENT ECT LOC      */ 00045000
         ST    @09,BASECTP                                         0068 00046000
*          ACCTECBP = ADDR(ACCTECB);  /* SET UP ACCOUNT ECB LOC      */ 00047000
         ST    @03,ACCTECBP                                        0069 00048000
*          UIDLPTR = 0;               /* CLEAR RESPONSE AREA PTR     */ 00049000
         ST    @10,UIDLPTR                                         0070 00050000
*          /* SET POINTERS TO SERVICE ROUTINE PARAMETER BLOCKS       */ 00051000
*          IOPLPTR = ADDR(IOPL1);     /* SET PTR TO IO PARM LIST     */ 00052000
         LA    IOPLPTR,IOPL1                                       0071 00053000
*          IOPL(1:12) = ACCTPL;       /* SET PL BASE PTRS            */ 00054000
         MVC   IOPL(12,IOPLPTR),ACCTPL                             0072 00055000
*          /* SET BASE PTRS IN COMMAND SCAN PCL                      */ 00056000
*          CSPLPTR = ADDR(CSPL1);     /* SET PTR TO COMMAND SCAN PL  */ 00057000
         LA    CSPLPTR,CSPL1                                       0073 00058000
*          CSPL(1:12)=ACCTPL;         /* SET PARM LIST PTRS          */ 00059000
         MVC   CSPL(12,CSPLPTR),ACCTPL                             0074 00060000
*          CSPLFLG = ADDR(CSFLGWD);   /* SET PTR TO INDICATOR AREA   */ 00061000
         LA    @10,CSFLGWD                                         0075 00062000
         ST    @10,CSPLFLG(,CSPLPTR)                               0075 00063000
*          CSPLOA = ADDR(CSOA1);      /* SET PTR TO RESPONSE AREA    */ 00064000
         LA    @10,CSOA1                                           0076 00065000
         ST    @10,CSPLOA(,CSPLPTR)                                0076 00066000
*          CSOAPTR = CSPLOA;          /* SET RESPONSE AREA BASE PTR  */ 00067000
         LR    CSOAPTR,@10                                         0077 00068000
*          /* INITIALIZE DAIR PARAMETER LIST,PARM BLOCK              */ 00069000
*          DAPLPTR  =  ADDR(DAPL1);   /* SET PARM LIST PTR           */ 00070000
         LA    @10,DAPL1                                           0078 00071000
         ST    @10,DAPLPTR                                         0078 00072000
*          DAPL(1:12) = ACCTPL;       /* SET UPT,ECT,ECB PTRS        */ 00073000
         MVC   DAPL(12,@10),ACCTPL                                 0079 00074000
*          DAPLPSCB  =  CPPLPSCB;     /* SET PSCB PTR                */ 00075000
         L     @09,CPPLPSCB(,CPPLPTR)                              0080 00076000
         ST    @09,DAPLPSCB(,@10)                                  0080 00077000
*          DAPLDAPB  =  ADDR(DAPB2C1);/* SET DAIR PARM BLOCK PTR     */ 00078000
         LA    @09,DAPB2C1                                         0081 00079000
         ST    @09,DAPLDAPB(,@10)                                  0081 00080000
*          DAPB2C(1:4) = '002C0000'X; /* SET NOT-IN-USE CODE PB      */ 00081000
         L     @10,DAPB2PTR(,@10)                                  0082 00082000
         MVC   DAPB2C(4,@10),@CB00329                              0082 00083000
*          /* INITIALIZE DAIRFAIL PARAMETER LIST                     */ 00084000
*          DARCPTR = ADDR(RTNCODE);   /* SET POINTER TO RETURN CODE  */ 00085000
         LA    @10,RTNCODE                                         0083 00086000
         ST    @10,DARCPTR                                         0083 00087000
*          DAWRENT = ADDR(ZERO);      /* SET POINTER TO ZERO ADDRESS */ 00088000
         LA    @10,ZERO                                            0084 00089000
         ST    @10,DAWRENT                                         0084 00090000
*          DAIDENT = ADDR(IDENT);     /* SET POINTER TO IDENTIFIER   */ 00091000
         LA    @10,IDENT                                           0085 00092000
         ST    @10,DAIDENT                                         0085 00093000
*          /* INITIALIZE PARM LIST FOR STACK ROUTINE                 */ 00094000
*          STPLPTR = ADDR(STPL1);     /* SET PTR TO STACK PL         */ 00095000
         LA    STPLPTR,STPL1                                       0086 00096000
*          STPL(1:12) = ACCTPL;       /* INITIALIZE PARM LIST PTRS   */ 00097000
         MVC   STPL(12,STPLPTR),ACCTPL                             0087 00098000
*          STPLSTPB = ADDR(STACL1);   /* SET PTR TO PARM BLOCK       */ 00099000
         LA    @10,STACL1                                          0088 00100000
         ST    @10,STPLSTPB(,STPLPTR)                              0088 00101000
*          /* BUILD PARAMETER LIST FOR HELP                          */ 00102000
*          HLPPPL = CPPL;             /* INITIALIZE HELP PARM LIST   */ 00103000
         MVC   HLPPPL(16),CPPL(CPPLPTR)                            0089 00104000
*          /* MOVE MODEL PARAMETER LISTS INTO DYNAMIC STORAGE        */ 00105000
*          CMDID = CMDIDMDL;          /* SET PARM LIST PTR           */ 00106000
         MVC   CMDID(8),CMDIDMDL                                   0090 00107000
*          CPLS(1:MCPLLNG) = MCPLS(1:MCPLLNG);                     0091 00108000
         L     @10,MCPLLNG                                         0091 00109000
         BCTR  @10,0                                               0091 00110000
         EX    @10,@SM00395                                        0091 00111000
*          GEN (STM  R13,R12,8(R13)); /* INITIALIZE ACCOUNT SAVE AREA*/ 00112000
         STM  R13,R12,8(R13)                                            00113000
*/********************************************************************/ 00114000
*/*    INITIALIZE THE PARAMETER LIST FOR STAE.                       */ 00115000
*/*    SET UP THE STAE ENVIORNMENT.                                  */ 00116000
*/*    CHECK THE RETURN CODE FROM STAE, IF AN ERROR OCCURED GO TO    */ 00117000
*/*      SYSTEM ERROR TERMINATION.                                   */ 00118000
*/********************************************************************/ 00119000
*          /* CALL STAE                                              */ 00120000
*          GEN (STAE  PARAM=(R13),MF=(E,STAEL))                    0093 00121000
*             REFS(R13) FLOWS(STAEXIN);                            0093 00122000
         STAE  PARAM=(R13),MF=(E,STAEL)                                 00123000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00124000
*          RTNCODE = R15;             /* RESERVE RETURN CODE         */ 00125000
         ST    R15,RTNCODE                                         0095 00126000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00127000
*          IF RTNCODE ^= 0            /* CHK IF STAE SUCCESSFUL      */ 00128000
*            THEN                     /* NO,                         */ 00129000
         L     @10,RTNCODE                                         0097 00130000
         LTR   @10,@10                                             0097 00131000
         BZ    @RF00097                                            0097 00132000
*              DO;                                                 0098 00133000
*              IF RTNCODE = 4         /* CHK FOR LACK OF SPACE       */ 00134000
*                THEN                 /* YES,                        */ 00135000
         CH    @10,@CH00144                                        0099 00136000
         BE    @RT00099                                            0099 00137000
*                  GOTO  NOSPAZ;      /* GO TO ISSUE NO SPACE MSG    */ 00138000
*              MSGNO = 7;             /* SET MESSAGE INDEX           */ 00139000
         LA    MSGNO,7                                             0101 00140000
*              CALL SYSERRD;          /* TO ISSUE SYSTEM ERROR MSG   */ 00141000
         BAL   @14,SYSERRD                                         0102 00142000
*              GOTO DOEND;            /* TERMINATE                   */ 00143000
         B     DOEND                                               0103 00144000
*              END;                                                0104 00145000
*/********************************************************************/ 00146000
*/*    SET FLAG INDICATING STAE IS ACTIVE.                           */ 00147000
*/*    ESTABLISH AUTHORITY AND VALIDITY OF ACCOUNT COMMAND ENTRY.    */ 00148000
*/*    IF THE USER IS NOT AUTHORIZED TO USE THE ACCOUNT COMMAND,     */ 00149000
*/*      ISSUE A MESSAGE TO THAT EFFECT AND TERMINATE.               */ 00150000
*/********************************************************************/ 00151000
*          STASET = '1'B;             /* SET STAE READY FLAG         */ 00152000
@RF00097 OI    STASET,B'00010000'                                  0105 00153000
*          IF PSCBACCT = '0'B         /* CHK IF USER IS ACCOUNT USER */ 00154000
*            THEN                     /* NO,                         */ 00155000
         L     @10,PSCBPTR(,CPPLPTR)                               0106 00156000
         TM    PSCBACCT(@10),B'01000000'                           0106 00157000
         BNZ   @RF00106                                            0106 00158000
*              DO;                                                 0107 00159000
*              TMSGTIN1 = PSCBUSER;   /* SET USER NAME IMAGE         */ 00160000
         MVI   TMSGTIN1+7,C' '                                     0108 00161000
         MVC   TMSGTIN1+8(32),TMSGTIN1+7                           0108 00162000
         MVC   TMSGTIN1(7),PSCBUSER(@10)                           0108 00163000
*              TMSGTIL1 = PSCBUSRL+4; /* SET LENGTH OF SEGMENT       */ 00164000
         LA    @07,4                                               0109 00165000
         SLR   @04,@04                                             0109 00166000
         IC    @04,PSCBUSRL(,@10)                                  0109 00167000
         ALR   @07,@04                                             0109 00168000
         STH   @07,TMSGTIL1                                        0109 00169000
*              GENERR = '1'B;         /* SET GENERAL ERROR FLAG      */ 00170000
         OI    GENERR,B'00000010'                                  0110 00171000
*              MSGNO = 2;             /* SET MESSAGE INDEX           */ 00172000
         LA    MSGNO,2                                             0111 00173000
*              CALL  MSGFNDR;         /* GO TO LOCATE MESSAGE TEXT   */ 00174000
         BAL   @14,MSGFNDR                                         0112 00175000
*              TMSGNP12 = ADDR(TMSGTIX1); /* SET SEGMENT POINTER     */ 00176000
         LA    @10,TMSGTIX1                                        0113 00177000
         ST    @10,TMSGNP12                                        0113 00178000
*              TMSGTIO1 = 37;         /* SET INSERT OFFSET           */ 00179000
         MVC   TMSGTIO1(2),@CH00336                                0114 00180000
*              CALL  DOPUTL;          /* GO TO ISSUE PUTLINE         */ 00181000
         BAL   @14,DOPUTL                                          0115 00182000
*              GOTO  DOEND;           /* GO TO EXIT                  */ 00183000
         B     DOEND                                               0116 00184000
*              END;                                                0117 00185000
*/********************************************************************/ 00186000
*/*    INITIALIZE THE ACCOUNT MODE MESSAGE.                          */ 00187000
*/*    IF ACCOUNT IS RUNNING IN THE FOREGROUND, SET UP THE STAX      */ 00188000
*/*      ENVIORNMENT.                                                */ 00189000
*/*      CHECK THE RETURN CODE FROM STAX, IF AN ERROR OCCURED GO TO  */ 00190000
*/*      SYSTEM ERROR TERMINATION, OTHERWIZE SET FLAG INDICATING STAX*/ 00191000
*/*      IS ACTIVE.                                                  */ 00192000
*/********************************************************************/ 00193000
*          MOFFNO=ADDR(ANDXL);         /* FORM PTR TO MODE MESSAGE   */ 00194000
@RF00106 L     MOFFNO,@CV00165                                     0118 00195000
*          MSGPTR = MOFFNC + ADDR(ANDXL); /* FORM PTR TO TEXT        */ 00196000
         L     MSGPTR,@CV00165                                     0119 00197000
         AH    MSGPTR,MOFFNC(,MOFFNO)                              0119 00198000
*          TMSGMDS(1:8) = MSGMODL1(1:8);/* SET NUM OF SEG. & PTR.    */ 00199000
         MVC   TMSGMDS(8),MSGMODL1(MSGPTR)                         0120 00200000
*          IOPLIOPB = ADDR(PGPBM);     /* SET POINTER TO PUTGET PB   */ 00201000
         LA    @10,PGPBM                                           0121 00202000
         ST    @10,IOPLIOPB(,IOPLPTR)                              0121 00203000
*          PGPBOBUF = ADDR(TMSGMDS);   /* SET PTR TO MODE MESSAGE    */ 00204000
         LA    @10,TMSGMDS                                         0122 00205000
         ST    @10,PGPBOBUF                                        0122 00206000
*          GEN (STAX  STAXXIN,USADDR=(R13),MF=(E,STAXL))           0123 00207000
*             FLOWS(STAXXIN);         /* CREATE STAX CALL            */ 00208000
         STAX  STAXXIN,USADDR=(R13),MF=(E,STAXL)                        00209000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00210000
*          RTNCODE = R15;             /* RESERVE RETURN CODE         */ 00211000
         ST    R15,RTNCODE                                         0125 00212000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00213000
*          IF RTNCODE ^= 0            /* CHK IF STAX SUCCESSFUL      */ 00214000
*            THEN                     /* NO,                         */ 00215000
         L     @10,RTNCODE                                         0127 00216000
         LTR   @10,@10                                             0127 00217000
         BZ    @RF00127                                            0127 00218000
*              DO;                                                 0128 00219000
*              MSGNO = 8;             /* SET MESSAGE INDEX           */ 00220000
         LA    MSGNO,8                                             0129 00221000
*              CALL SYSERRD;          /* TO ISSUE SYSTEM ERROR MSG   */ 00222000
         BAL   @14,SYSERRD                                         0130 00223000
*              GOTO DOEND;            /* TERMINATE                   */ 00224000
         B     DOEND                                               0131 00225000
*              END;                                                0132 00226000
*          STXSET = '1'B;             /* SET STAX READY FLAG         */ 00227000
@RF00127 OI    STXSET,B'00100000'                                  0133 00228000
*/********************************************************************/ 00229000
*/*    CHECK THE VALIDITY OF THE ACCOUNT COMMAND.                    */ 00230000
*/*    IF ANY DATA HAS BEEN ENTERED WITH THE COMMAND, ISSUE A MESSAGE*/ 00231000
*/*      INDICATING THAT THE DATA WILL BE IGNORED.                   */ 00232000
*/********************************************************************/ 00233000
*          BUFFPTR = CPPLCBUF;        /* SET PTR TO ACCOUNT INPUT    */ 00234000
         L     @10,CPPLCBUF(,CPPLPTR)                              0134 00235000
         ST    @10,BUFFPTR                                         0134 00236000
*          IF ECTNOPD = '0'B          /* CHK IF ANY OPERANDS ENTERED */ 00237000
*            THEN                     /* YES,                        */ 00238000
         TM    ECTNOPD(ECTPTR),B'10000000'                         0135 00239000
         BNZ   @RF00135                                            0135 00240000
*              DO;                                                 0136 00241000
*              MSGNO = 4;             /* SET MESSAGE INDEX           */ 00242000
         LA    MSGNO,4                                             0137 00243000
*              CALL  MSGFNDR;         /* GO TO LOCATE MESSAGE TEXT   */ 00244000
         BAL   @14,MSGFNDR                                         0138 00245000
*              TMSGTIO1 = 10;         /* SET TEXT OFFSET             */ 00246000
         MVC   TMSGTIO1(2),@CH00338                                0139 00247000
*              TMSGTIL1 = ICBFLN-ICBFOF;/* SET DATA LENGTH           */ 00248000
         L     @10,BUFFPTR                                         0140 00249000
         LH    @09,ICBFLN(,@10)                                    0140 00250000
         SH    @09,ICBFOF(,@10)                                    0140 00251000
         STH   @09,TMSGTIL1                                        0140 00252000
*              IF TMSGTIL1 > 44       /* CHK EXCESSIVE ENTRY LENGTH  */ 00253000
*                THEN                 /* YES,                        */ 00254000
         LA    @10,44                                              0141 00255000
         CR    @09,@10                                             0141 00256000
         BNH   @RF00141                                            0141 00257000
*                  TMSGTIL1 = 44;     /* SET SEGMENT LENGTH          */ 00258000
         STH   @10,TMSGTIL1                                        0142 00259000
*                ELSE                                              0143 00260000
*                  TMSGNNO1 = 2;      /* EXCLUDE ETC SEGMENT         */ 00261000
         B     @RC00141                                            0143 00262000
@RF00141 MVC   TMSGNNO1(4),@CF00073                                0143 00263000
*              TMSGTIN1(1:TMSGTIL1) = /* MOVE INPUT DATA TO BUFFER   */ 00264000
*                ICBFDA(ICBFOF+1:TMSGTIL1);                        0144 00265000
@RC00141 LH    @10,TMSGTIL1                                        0144 00266000
         BCTR  @10,0                                               0144 00267000
         L     @09,BUFFPTR                                         0144 00268000
         LH    @07,ICBFOF(,@09)                                    0144 00269000
         ALR   @09,@07                                             0144 00270000
         EX    @10,@SM00400                                        0144 00271000
*              TMSGNP12 = ADDR(TMSGTIX1); /* SET PTR TO INSERT BUFFER*/ 00272000
         LA    @10,TMSGTIX1                                        0145 00273000
         ST    @10,TMSGNP12                                        0145 00274000
*              CALL  DOPUTL;          /* GO TO ISSUE PUTLINE         */ 00275000
         BAL   @14,DOPUTL                                          0146 00276000
*              END;                                                0147 00277000
*          GOTO GETCMD;               /* SKIP FREEMAIN FOR COMMAND   */ 00278000
         B     GETCMD                                              0148 00279000
*/********************************************************************/ 00280000
*/* READY: FREE THE PREVIOUS COMMAND BUFFER.                         */ 00281000
*/*    CHECK THE ECB POSTED BY THE ACCOUNT SUBCOMMANDS, IF AN ERROR  */ 00282000
*/*      HAS OCCURED, IF SO CLEAR THE INPUT STACK AND REISSUE THE    */ 00283000
*/*      MODE MESSAGE.                                               */ 00284000
*/********************************************************************/ 00285000
*READY:    /* EXECUTE FREEMAIN                                       */ 00286000
*          GEN (FREEMAIN  A=BUFFPTR,MF=(E,FMLST))                  0149 00287000
*              REFS(BUFFPTR,BUFFLEN);                              0149 00288000
READY    FREEMAIN  A=BUFFPTR,MF=(E,FMLST)                               00289000
*          IF ERRTN ^= '000'B         /* CHK FOR ERROR OCCURRED FLAG */ 00290000
*            THEN                     /* YES,                        */ 00291000
         TM    ERRTN,B'00001110'                                   0150 00292000
         BNZ   @RT00150                                            0150 00293000
*              GOTO DOEND;            /* GO TO TERMINATION           */ 00294000
*          IF ECBCODE ^= '0'B         /* CHK FOR SUBCOMMAND ERROR    */ 00295000
*            THEN                     /* YES,                        */ 00296000
         ICM   @10,7,ECBCODE                                       0152 00297000
         BZ    @RF00152                                            0152 00298000
*              DO;                                                 0153 00299000
*              PGPBOBUF = ADDR(TMSGMDS); /* SET PTR TO MODE MESSAGE  */ 00300000
         LA    @10,TMSGMDS                                         0154 00301000
         ST    @10,PGPBOBUF                                        0154 00302000
*              CALL  CLRSTAC;         /* GO TO CLEAR INPUT STACK     */ 00303000
         BAL   @14,CLRSTAC                                         0155 00304000
*              END;                                                0156 00305000
*/********************************************************************/ 00306000
*/*    CHECK IF A COMMAND HAS BEEN ENTERED FROM THE ATTENTION ROUTINE*/ 00307000
*/*      IF SO RESET THE ATTENTION FLAG AND SKIP THE PUTGET.         */ 00308000
*/*      IF NOT ISSUE PUTGET TO GET THE NEXT COMMAND. IF A SECOND    */ 00309000
*/*      LEVEL MESSAGE IS WAITING DELETE IT AND REISSUE THE PUTGET.  */ 00310000
*/*    SAVE THE POINTER TO THE COMMAND BUFFER AND SET UP FOR COMMAND */ 00311000
*/*      SCAN.                                                       */ 00312000
*/********************************************************************/ 00313000
*          ACCTECB = '0'B;            /* RESET ECB                   */ 00314000
@RF00152 SLR   @10,@10                                             0157 00315000
         ST    @10,ACCTECB                                         0157 00316000
*GETCMD:   IF ATNCMD = '0'B           /* IS ATTENTION FLAG SET       */ 00317000
*              THEN                   /* NO,                         */ 00318000
GETCMD   TM    ATNCMD,B'10000000'                                  0158 00319000
         BNZ   @RF00158                                            0158 00320000
*                DO;                                               0159 00321000
*                CALL  DOPTGT;        /* GO TO ISSUE PUTGET          */ 00322000
         BAL   @14,DOPTGT                                          0160 00323000
*                IF RTNCODE = 12 &    /* CHK FOR 2ND LEVEL MESSAGES  */ 00324000
*                 ECTMSG1 = '0'B      /*  AND MSG DELETE FLAG NOT SET*/ 00325000
*                  THEN               /* YES,                        */ 00326000
         CLC   RTNCODE(4),@CF00109                                 0161 00327000
         BNE   @RF00161                                            0161 00328000
         TM    ECTMSG1(ECTPTR),B'10000000'                         0161 00329000
         BNZ   @RF00161                                            0161 00330000
*                    DO;                                           0162 00331000
*                    ECTMSG1 = '1'B;  /* SET MESSAGE DELETE FLAG     */ 00332000
         OI    ECTMSG1(ECTPTR),B'10000000'                         0163 00333000
*                    CALL DOPTGT;     /* GO TO REISSUE PUTGET        */ 00334000
         BAL   @14,DOPTGT                                          0164 00335000
*                    END;                                          0165 00336000
*                BUFFPTR = PGPBIBUF;  /* SAVE INPUT POINTER          */ 00337000
@RF00161 L     @10,PGPBPTR(,IOPLPTR)                               0166 00338000
         L     @10,PGPBIBUF(,@10)                                  0166 00339000
         ST    @10,BUFFPTR                                         0166 00340000
*                END;                                              0167 00341000
*              ELSE                   /* INPUT RECEIVED FROM ATT EXIT*/ 00342000
*                DO;                                               0168 00343000
         B     @RC00158                                            0168 00344000
@RF00158 DS    0H                                                  0169 00345000
*PUTGATTN:       BUFFPTR = ATTNBUFP;  /* POINT TO ATTENTION INPUT    */ 00346000
PUTGATTN L     @10,ATTNBUFP                                        0169 00347000
         ST    @10,BUFFPTR                                         0169 00348000
*                PGPBOBUF = 0;        /* DO NOT REISSUE MODE MESSAGE */ 00349000
         SLR   @10,@10                                             0170 00350000
         ST    @10,PGPBOBUF                                        0170 00351000
*                ATNCMD = '0'B;       /* RESET FLAG                  */ 00352000
         NI    ATNCMD,B'01111111'                                  0171 00353000
*                CALL  CLRSTAC;       /* GO TO CLEAR INPUT STACK     */ 00354000
         BAL   @14,CLRSTAC                                         0172 00355000
*                END;                                              0173 00356000
*          BUFFLEN = ICBFLN;          /* SAVE LENGTH FOR FREEMAIN    */ 00357000
@RC00158 L     @10,BUFFPTR                                         0174 00358000
         LH    @09,ICBFLN(,@10)                                    0174 00359000
         ST    @09,BUFFLEN                                         0174 00360000
*          CSPLCBUF = BUFFPTR;        /* POINT TO COMMAND FOR SCAN   */ 00361000
         ST    @10,CSPLCBUF(,CSPLPTR)                              0175 00362000
*          BUFPTR = BUFFPTR;          /* POINT TO COMMAND FOR SUB-CMD*/ 00363000
         ST    @10,BUFPTR                                          0176 00364000
*/********************************************************************/ 00365000
*/*    CALL COMMAND SCAN TO VALIDATE THE COMMAND BUFFER AND CHECK    */ 00366000
*/*      THE RETURN CODE. IF AN ERROR OCCURED CHECK IF NO CORE WAS   */ 00367000
*/*      AVAILABLE ISSUE THE MESSAGE OTHERWISE  GO TO SYSTEM ERROR   */ 00368000
*/*      TERMINATION.                                                */ 00369000
*/*    IF A NULL LINE WAS ENTERED GO GET A NEW COMMAND.              */ 00370000
*/*    IF AN INVALID COMMAND WAS ENTERED ISSUE THE MESSAGE AND THEN  */ 00371000
*/*      GO GET A NEW COMMAND.                                       */ 00372000
*/********************************************************************/ 00373000
*          /* LINK TO COMMAND SCAN                                   */ 00374000
*          GEN (LINK  EP=IKJSCAN,MF=(E,CSPL1),SF=(E,LNKCPL));      0177 00375000
         LINK  EP=IKJSCAN,MF=(E,CSPL1),SF=(E,LNKCPL)                    00376000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00377000
*          RTNCODE = R15;             /* RESERVE RETURN CODE         */ 00378000
         ST    R15,RTNCODE                                         0179 00379000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00380000
*          IF RTNCODE ^= 0            /* CHK FOR BAD RETURN CODE     */ 00381000
*            THEN                     /* YES,                        */ 00382000
         L     @10,RTNCODE                                         0181 00383000
         LTR   @10,@10                                             0181 00384000
         BZ    @RF00181                                            0181 00385000
*              DO;                                                 0182 00386000
*              IF RTNCODE = 8         /* CHK FOR GETMAIN FAILURE     */ 00387000
*                THEN                 /* YES,                        */ 00388000
         CH    @10,@CH00077                                        0183 00389000
         BE    @RT00183                                            0183 00390000
*                  GOTO  NOSPAZ;      /* GO TO ISSUE NOSPACE MSG     */ 00391000
*              MSGNO = 5;             /* BAD RETURN CODE FROM SCAN   */ 00392000
         LA    MSGNO,5                                             0185 00393000
*              CALL SYSERRD;          /* TO ISSUE SYSTEM ERROR MSG   */ 00394000
         BAL   @14,SYSERRD                                         0186 00395000
*              GOTO DOEND;            /* TERMINATE                   */ 00396000
         B     DOEND                                               0187 00397000
*              END;                                                0188 00398000
*          IF CSOANOC = '1'B          /* CHK FOR NULL LINE           */ 00399000
*            THEN                     /* YES,                        */ 00400000
@RF00181 TM    CSOANOC(CSOAPTR),B'00010000'                        0189 00401000
         BNO   @RF00189                                            0189 00402000
*              DO;                                                 0190 00403000
*              PGPBOBUF = ADDR(TMSGMDS); /* SET PTR TO MODE MESSAGE  */ 00404000
         LA    @10,TMSGMDS                                         0191 00405000
         ST    @10,PGPBOBUF                                        0191 00406000
*              GOTO  READY;           /* GO TO GET NEW COMMAND       */ 00407000
         B     READY                                               0192 00408000
*              END;                                                0193 00409000
*          IF CSOABAD = '1'B          /* CHK FOR INVALID CMD FLAG    */ 00410000
*            THEN                     /* YES,                        */ 00411000
@RF00189 TM    CSOABAD(CSOAPTR),B'00001000'                        0194 00412000
         BNO   @RF00194                                            0194 00413000
*              DO;                                                 0195 00414000
*              MSGNO = 10;            /* SET MESSAGE INDEX           */ 00415000
         LA    MSGNO,10                                            0196 00416000
*              CALL  MSGFNDR;         /* GO TO LOCATE MESSAGE TEXT   */ 00417000
         BAL   @14,MSGFNDR                                         0197 00418000
*              CALL  DOPUTL;          /* GO TO ISSUE PUTLINE         */ 00419000
         BAL   @14,DOPUTL                                          0198 00420000
*              GOTO READY;            /* GO TO ISSUE MESSAGE         */ 00421000
         B     READY                                               0199 00422000
*              END;                                                0200 00423000
*/********************************************************************/ 00424000
*/*    IDENTIFY THE COMMAND ENTERED AND INITIALIZE THE LINK LIST     */ 00425000
*/*      TO REQUEST THAT COMMAND.                                    */ 00426000
*/*    IF ADD, CHANGE, DELETE, LIST OR LISTIDS WAS ENTERED GO TO     */ 00427000
*/*      ISSUE THE LINK SVC.                                         */ 00428000
*/*    IF END WAS ENTERED GO TO TERMINATION.                         */ 00429000
*/*    IF SYNC WAS ENTERED LINK TO IKJRBBCR AND ON RETURN GO GET A   */ 00430000
*/*      NEW COMMAND.                                                */ 00431000
*/********************************************************************/ 00432000
*          IF CMDLOC(1:CSOALNM) = ADDDEF(1:CSOALNM) /* CHK FOR ADD   */ 00433000
*            THEN                     /* YES,                        */ 00434000
@RF00194 L     @10,CSOACNM(,CSOAPTR)                               0201 00435000
         LH    @09,CSOALNM(,CSOAPTR)                               0201 00436000
         BCTR  @09,0                                               0201 00437000
         EX    @09,@SC00404                                        0201 00438000
         BNE   @RF00201                                            0201 00439000
*              DO;                                                 0202 00440000
*              ECTSCMD = ADDDEF;      /* IDENTIFY ADD                */ 00441000
         MVC   ECTSCMD(8,ECTPTR),ADDDEF                            0203 00442000
*              CMDNU = '1';           /* MODIFY LIST FORM OF LINK    */ 00443000
         MVI   CMDNU,C'1'                                          0204 00444000
*              GO TO LINK;                                         0205 00445000
         B     LINK                                                0205 00446000
*              END;                                                0206 00447000
*          IF CMDLOC(1:CSOALNM) = CHGDEF(1:CSOALNM) /* CHK FOR CHANGE*/ 00448000
*            THEN                     /* YES,                        */ 00449000
@RF00201 L     @10,CSOACNM(,CSOAPTR)                               0207 00450000
         LH    @09,CSOALNM(,CSOAPTR)                               0207 00451000
         BCTR  @09,0                                               0207 00452000
         EX    @09,@SC00406                                        0207 00453000
         BNE   @RF00207                                            0207 00454000
*              DO;                                                 0208 00455000
*              ECTSCMD = CHGDEF;      /* IDENTIFY CHANGE             */ 00456000
         MVC   ECTSCMD(8,ECTPTR),CHGDEF                            0209 00457000
*              CMDNU = '2';           /* MODIFY LIST FORM OF LINK    */ 00458000
         MVI   CMDNU,C'2'                                          0210 00459000
*              GO TO LINK;                                         0211 00460000
         B     LINK                                                0211 00461000
*              END;                                                0212 00462000
*          IF CMDLOC(1:CSOALNM) = DELDEF(1:CSOALNM) /* CHK FOR DELETE*/ 00463000
*            THEN                     /* YES,                        */ 00464000
@RF00207 L     @10,CSOACNM(,CSOAPTR)                               0213 00465000
         LH    @09,CSOALNM(,CSOAPTR)                               0213 00466000
         BCTR  @09,0                                               0213 00467000
         EX    @09,@SC00408                                        0213 00468000
         BNE   @RF00213                                            0213 00469000
*              DO;                                                 0214 00470000
*              ECTSCMD = DELDEF;      /* IDENTIFY DELETE             */ 00471000
         MVC   ECTSCMD(8,ECTPTR),DELDEF                            0215 00472000
*              CMDNU = '3';           /* MODIFY LIST FORM OF LINK    */ 00473000
         MVI   CMDNU,C'3'                                          0216 00474000
*              GO TO LINK;                                         0217 00475000
         B     LINK                                                0217 00476000
*              END;                                                0218 00477000
*          IF CMDLOC(1:CSOALNM) = ENDDEF(1:CSOALNM) /* CHK FOR END   */ 00478000
*            THEN                     /* YES,                        */ 00479000
@RF00213 L     @10,CSOACNM(,CSOAPTR)                               0219 00480000
         LH    @09,CSOALNM(,CSOAPTR)                               0219 00481000
         BCTR  @09,0                                               0219 00482000
         EX    @09,@SC00410                                        0219 00483000
         BE    @RT00219                                            0219 00484000
*              GOTO  DOEND;           /* GO TO CALL END              */ 00485000
*          IF CMDLOC(1:CSOALNM) = LSTDEF(1:CSOALNM) /* CHK FOR LIST  */ 00486000
*            THEN                     /* YES,                        */ 00487000
         EX    @09,@SC00412                                        0221 00488000
         BNE   @RF00221                                            0221 00489000
*              DO;                                                 0222 00490000
*              ECTSCMD = LSTDEF;      /* IDENTIFY LIST               */ 00491000
         MVC   ECTSCMD(8,ECTPTR),LSTDEF                            0223 00492000
*              CMDNU = '4';           /* MODIFY LIST FORM OF LINK    */ 00493000
         MVI   CMDNU,C'4'                                          0224 00494000
*              GO TO LINK;                                         0225 00495000
         B     LINK                                                0225 00496000
*              END;                                                0226 00497000
*          IF CMDLOC(1:CSOALNM) = LSTIDEF(1:CSOALNM) /* CHK FOR LISTI*/ 00498000
*            THEN                     /* YES,                        */ 00499000
@RF00221 L     @10,CSOACNM(,CSOAPTR)                               0227 00500000
         LH    @09,CSOALNM(,CSOAPTR)                               0227 00501000
         BCTR  @09,0                                               0227 00502000
         EX    @09,@SC00414                                        0227 00503000
         BNE   @RF00227                                            0227 00504000
*              DO;                                                 0228 00505000
*              UIDLPTR = 1;           /* SET LISTIDS FLAG            */ 00506000
         MVC   UIDLPTR(4),@CF00032                                 0229 00507000
*              ECTSCMD = LSTIDEF;     /* IDENTIFY LISTIDS            */ 00508000
         MVC   ECTSCMD(8,ECTPTR),LSTIDEF                           0230 00509000
*              CMDNU = '4';           /* MODIFY LIST FORM OF LINK    */ 00510000
         MVI   CMDNU,C'4'                                          0231 00511000
*              GO TO LINK;                                         0232 00512000
         B     LINK                                                0232 00513000
*              END;                                                0233 00514000
*          IF CMDLOC(1:CSOALNM) = SYNDEF(1:CSOALNM) /* CHK FOR SYNC  */ 00515000
*            THEN                     /* YES,                        */ 00516000
@RF00227 L     @10,CSOACNM(,CSOAPTR)                               0234 00517000
         LH    @09,CSOALNM(,CSOAPTR)                               0234 00518000
         BCTR  @09,0                                               0234 00519000
         EX    @09,@SC00416                                        0234 00520000
         BNE   @RF00234                                            0234 00521000
*              DO;                                                 0235 00522000
*              ECTSCMD = SYNDEF;      /* IDENTIFY SYNC               */ 00523000
         MVC   ECTSCMD(8,ECTPTR),SYNDEF                            0236 00524000
*              GEN (LINK  EP=IKJRBBCR,MF=(E,SNDPPL),SF=(E,LNKCPL));     00525000
         LINK  EP=IKJRBBCR,MF=(E,SNDPPL),SF=(E,LNKCPL)                  00526000
*              GOTO  READY;           /* GO TO GET NEXT COMMAND      */ 00527000
         B     READY                                               0238 00528000
*              END;                                                0239 00529000
*/********************************************************************/ 00530000
*/*    IF HELP WAS REQUESTED SET HELP ACTIVE FLAG AND ATTACH HELP.   */ 00531000
*/*    CHECK THE RETURN CODE FROM ATTACH, IF IT IS NOT 0 GO TO SYSTEM*/ 00532000
*/*      ERROR TERMINATION.                                          */ 00533000
*/*    WAIT FOR HELP TO COMPLETE AND THEN FREE THE HELP DATA SET,    */ 00534000
*/*      DETACH HELP, RESET THE HELP ACTIVE FLAG AND GO GET A NEW    */ 00535000
*/*      COMMAND.                                                    */ 00536000
*/********************************************************************/ 00537000
*          IF CMDLOC(1:CSOALNM) = HLPDEF(1:CSOALNM) /* CHK FOR HELP  */ 00538000
*            THEN                     /* YES,                        */ 00539000
@RF00234 L     @10,CSOACNM(,CSOAPTR)                               0240 00540000
         LH    @09,CSOALNM(,CSOAPTR)                               0240 00541000
         BCTR  @09,0                                               0240 00542000
         EX    @09,@SC00418                                        0240 00543000
         BNE   @RF00240                                            0240 00544000
*              DO;                                                 0241 00545000
*              HWTCTL = '0'B;         /* CLEAR WAIT CONTROL FLAGS    */ 00546000
         NI    HWTCTL,B'00111111'                                  0242 00547000
*              ECTSCMD = HLPDEF;      /* IDENTIFY HELP               */ 00548000
         MVC   ECTSCMD(8,ECTPTR),HLPDEF                            0243 00549000
*              HLPCBUF = CSPLCBUF;    /* SET PTR TO COMMAND BUFFER   */ 00550000
         L     @10,CSPLCBUF(,CSPLPTR)                              0244 00551000
         ST    @10,HLPCBUF                                         0244 00552000
*              RFY (R1,R15) RSTD;     /* RESTRICT REGS. FOR ATTACH   */ 00553000
*              R1 = ADDR(HLPPPL);     /* POINT TO HELP PARM LIST     */ 00554000
         LA    R1,HLPPPL                                           0246 00555000
*              R15 = ADDR(HLPCPL);    /* POINT TO ATTACH LIST FORM   */ 00556000
         LA    R15,HLPCPL                                          0247 00557000
*              HLPNOW = '1'B;         /* SET HELP-IN-PROCESS FLAG    */ 00558000
         OI    HLPNOW,B'01000000'                                  0248 00559000
*              /* ATTACH HELP                                        */ 00560000
*   GEN (ATTACH STAI=(STAEXIN,(R13)),ECB=HLPECB,MF=(E,(1)),SF=(E,(15))) 00561000
*              REFS(HLPECB,HLPTCB,HLPPPL) FLOWS(STAXXIN);          0249 00562000
         ATTACH STAI=(STAEXIN,(R13)),ECB=HLPECB,MF=(E,(1)),SF=(E,(15))  00563000
*              HLPTCB = R1;           /* SAVE HELP TCB ADDRESS       */ 00564000
         ST    R1,HLPTCB                                           0250 00565000
*              RTNCODE = R15;         /* RESERVE RETURN CODE         */ 00566000
         ST    R15,RTNCODE                                         0251 00567000
*              RFY (R1,R15) UNRSTD;   /* RELEASE TCB AND RETURN CODE */ 00568000
*              IF RTNCODE ^= 0        /* CHK FOR NONZERO CODE        */ 00569000
*                THEN                 /* YES, ERROR                  */ 00570000
         L     @10,RTNCODE                                         0253 00571000
         LTR   @10,@10                                             0253 00572000
         BZ    @RF00253                                            0253 00573000
*                  DO;                                             0254 00574000
*                  MSGNO = 13;        /* SET MESSAGE INDEX           */ 00575000
         LA    MSGNO,13                                            0255 00576000
*                  CALL SYSERRD;      /* TO ISSUE SYSTEM ERROR MSG   */ 00577000
         BAL   @14,SYSERRD                                         0256 00578000
*                  GOTO DOEND;        /* TERMINATE                   */ 00579000
         B     DOEND                                               0257 00580000
*                  END;                                            0258 00581000
*              GEN (WAIT  ECB=HLPECB);/* WAIT FOR HELP TO COMPLETE   */ 00582000
@RF00253 DS    0H                                                  0259 00583000
         WAIT  ECB=HLPECB                                               00584000
*              IF HLPNOW = '1'B       /* DID STAX EXIT DETACH HELP?  */ 00585000
*                THEN                 /* NO,                         */ 00586000
         TM    HLPNOW,B'01000000'                                  0260 00587000
         BNO   @RF00260                                            0260 00588000
*                  DO;                                             0261 00589000
*                  DA2CTCB = HLPTCB;  /* SET TCB PTR IN DAIR PB      */ 00590000
         L     @10,DAPLPTR                                         0262 00591000
         L     @10,DAPB2PTR(,@10)                                  0262 00592000
         L     @09,HLPTCB                                          0262 00593000
         ST    @09,DA2CTCB(,@10)                                   0262 00594000
*                  CALL DODAR2C;      /* FREE HELP DATA SET          */ 00595000
         BAL   @14,DODAR2C                                         0263 00596000
*                  GEN (DETACH HLPTCB);/* DETACH HELP                */ 00597000
         DETACH HLPTCB                                                  00598000
*                  HLPNOW = '0'B;     /* SET HELP NOT ACTIVE FLAG    */ 00599000
         NI    HLPNOW,B'10111111'                                  0265 00600000
*                  END;                                            0266 00601000
*              GOTO  READY;           /* GO TO GET SUBCOMMAND        */ 00602000
         B     READY                                               0267 00603000
*              END;                                                0268 00604000
*/********************************************************************/ 00605000
*/*    AT THIS POINT NO MATCH HAS BEEN FOUND FOR THE COMMAND ENTERED.*/ 00606000
*/*    ISSUE A MESSAGE TO THE USER THAT THE COMMAND IS INVALID AND   */ 00607000
*/*      GO TO GET A NEW COMMAND.                                    */ 00608000
*/********************************************************************/ 00609000
*          MSGNO = 3;                 /* SET MESSAGE INDEX           */ 00610000
@RF00240 LA    MSGNO,3                                             0269 00611000
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */ 00612000
         BAL   @14,MSGFNDR                                         0270 00613000
*          TMSGTIO1 = 29;             /* SET TEXT OFFSET             */ 00614000
         MVC   TMSGTIO1(2),@CH00355                                0271 00615000
*          TMSGTIL1 = CSOALNM+4;      /* SET NAME SEGMENT LENGTH     */ 00616000
         LH    @10,CSOALNM(,CSOAPTR)                               0272 00617000
         LA    @09,4                                               0272 00618000
         ALR   @09,@10                                             0272 00619000
         STH   @09,TMSGTIL1                                        0272 00620000
*          TMSGTIN1(1:CSOALNM) = CMDLOC;/* INSERT CMD NAME           */ 00621000
         BCTR  @10,0                                               0273 00622000
         L     @09,CSOACNM(,CSOAPTR)                               0273 00623000
         EX    @10,@SM00423                                        0273 00624000
*          TMSGNP12 = ADDR(TMSGTIX1); /* SET PTR TO ACTIVE INSERT    */ 00625000
         LA    @10,TMSGTIX1                                        0274 00626000
         ST    @10,TMSGNP12                                        0274 00627000
*          CALL  DOPUTL;              /* GO TO ISSUE PUTLINE         */ 00628000
         BAL   @14,DOPUTL                                          0275 00629000
*          GOTO  READY;               /* GO TO GET NEXT SUBCOMMAND   */ 00630000
         B     READY                                               0276 00631000
*/********************************************************************/ 00632000
*/* LINK: LINK TO THE ACCOUNT SUBCOMMAND.                            */ 00633000
*/*    IF NO USERID'S WERE MODIFIED GO GET A NEW COMMAND.            */ 00634000
*/*    IF ANY USERID HAS BEEN MODIFIED SET THE SEND ACTIVE FLAG      */ 00635000
*/*      AND ATTACH SEND TO UPDATE THE BROADCAST DATA SET.           */ 00636000
*/*    CHECK THE RETURN CODE FROM ATTACH, IF IT IS NOT 0 GO TO SYSTEM*/ 00637000
*/*      ERROR TERMINATION.                                          */ 00638000
*/*    WAIT FOR SEND TO COMPLETE AND THEN FREE THE BROADCAST DATA    */ 00639000
*/*      SET, DETACH SEND AND RESET THE SEND ACTIVE FLAG.            */ 00640000
*/********************************************************************/ 00641000
*          /* LINK TO ACCOUNT SUBCOMMAND                             */ 00642000
*LINK:     GEN (LINK  ,EPLOC=CMDID,MF=(E,ACCTPL),SF=(E,LNKCPL));   0277 00643000
LINK     LINK  ,EPLOC=CMDID,MF=(E,ACCTPL),SF=(E,LNKCPL)                 00644000
*          IF UIDLPTR = 0             /* CHK IF ANY USERID LIST PTR  */ 00645000
*            THEN                     /* NO,                         */ 00646000
         L     @10,UIDLPTR                                         0278 00647000
         LTR   @10,@10                                             0278 00648000
         BZ    @RT00278                                            0278 00649000
*              GOTO  READY;           /* SKIP LINKAGE TO SEND        */ 00650000
*          SPLUDL = UIDLPTR;          /* INIT UIDL POINTER FOR SEND  */ 00651000
         ST    @10,SPLUDL                                          0280 00652000
*          SWTCTL = '0'B;             /* CLEAR WAIT CONTROL FLAGS    */ 00653000
         NI    SWTCTL,B'00111111'                                  0281 00654000
*          ECTSCMD = SNDDEF;          /* IDENTIFY SEND               */ 00655000
         MVC   ECTSCMD(8,ECTPTR),SNDDEF                            0282 00656000
*          RFY (R1,R15) RSTD;         /* RESTRICT REGS. FOR ATTACH   */ 00657000
*          R1 = ADDR(SNDPPL);         /* POINT TO SEND PARM LIST     */ 00658000
         LA    R1,SNDPPL                                           0284 00659000
*          R15 = ADDR(SNDCPL);        /* POINT TO ATTACH LIST FORM   */ 00660000
         LA    R15,SNDCPL                                          0285 00661000
*          SNDNOW = '1'B;             /* SET SEND-IN-PROCESS FLAG    */ 00662000
         OI    SNDNOW,B'10000000'                                  0286 00663000
*          /* ATTACH SEND FOR UPDATE BROADCAST DATA SET ROUTINE      */ 00664000
*   GEN (ATTACH STAI=(STAEXIN,(R13)),ECB=SNDECB,MF=(E,(1)),SF=(E,(15))) 00665000
*          REFS(SNDECB,SNDTCB,SNDPPL) FLOWS(STAXXIN);              0287 00666000
         ATTACH STAI=(STAEXIN,(R13)),ECB=SNDECB,MF=(E,(1)),SF=(E,(15))  00667000
*          SNDTCB = R1;               /* SAVE SEND TCB ADDRESS       */ 00668000
         ST    R1,SNDTCB                                           0288 00669000
*          RTNCODE = R15;             /* RESERVE RETURN CODE         */ 00670000
         ST    R15,RTNCODE                                         0289 00671000
*          RFY (R1,R15) UNRSTD;       /* RELEASE TCB AND RETURN CODE */ 00672000
*          IF RTNCODE ^= 0            /* CHK FOR NONZERO CODE        */ 00673000
*            THEN                     /* YES, ERROR                  */ 00674000
         L     @10,RTNCODE                                         0291 00675000
         LTR   @10,@10                                             0291 00676000
         BZ    @RF00291                                            0291 00677000
*              DO;                                                 0292 00678000
*              MSGNO = 13;            /* SET MESSAGE INDEX           */ 00679000
         LA    MSGNO,13                                            0293 00680000
*              CALL SYSERRD;          /* TO ISSUE SYSTEM ERROR MSG   */ 00681000
         BAL   @14,SYSERRD                                         0294 00682000
*              GOTO DOEND;            /* TERMINATE                   */ 00683000
         B     DOEND                                               0295 00684000
*              END;                                                0296 00685000
*          GEN (WAIT  ECB=SNDECB);    /* WAIT FOR SEND TO COMPLETE   */ 00686000
@RF00291 DS    0H                                                  0297 00687000
         WAIT  ECB=SNDECB                                               00688000
*          DA2CTCB  =  SNDTCB;        /* SET TCB ADDRESS FOR DAIR    */ 00689000
         L     @10,DAPLPTR                                         0298 00690000
         L     @10,DAPB2PTR(,@10)                                  0298 00691000
         L     @09,SNDTCB                                          0298 00692000
         ST    @09,DA2CTCB(,@10)                                   0298 00693000
*          CALL DODAR2C;              /* GO TO CALL DAIR TO FREE   0299 00694000
*                                          BROADCAST DATA SET        */ 00695000
         BAL   @14,DODAR2C                                         0299 00696000
*          GEN (DETACH SNDTCB);       /* DETACH SEND                 */ 00697000
         DETACH SNDTCB                                                  00698000
*          SNDNOW = '0'B;             /* CLEAR SEND-IN-PROCESS FLAG  */ 00699000
         NI    SNDNOW,B'01111111'                                  0301 00700000
*/********************************************************************/ 00701000
*/*    FREE CORE GOTTEN FOR THE UDLS AND GO GET A NEW COMMAND.       */ 00702000
*/********************************************************************/ 00703000
*          DO WHILE UIDLPTR ^= 0;     /* TEST POINTER TO NEXT UIDL   */ 00704000
         B     @DE00302                                            0302 00705000
@DL00302 DS    0H                                                  0303 00706000
*            FREEUID(1) = UIDLPTR;    /* AREA TO BE FREED            */ 00707000
         L     @10,UIDLPTR                                         0303 00708000
         ST    @10,FREEUID                                         0303 00709000
*            FREEUID(2) = (UIDLCT*8)+8; /*DETERMINE LENGTH OF UIDL   */ 00710000
         SLR   @09,@09                                             0304 00711000
         ICM   @09,3,UIDLCT(@10)                                   0304 00712000
         SLA   @09,3                                               0304 00713000
         AH    @09,@CH00077                                        0304 00714000
         ST    @09,FREEUID+4                                       0304 00715000
*            UIDLPTR = UIDLNEX;       /* UPDATE UDL ITEM PTR         */ 00716000
         L     @10,UIDLNEX(,@10)                                   0305 00717000
         ST    @10,UIDLPTR                                         0305 00718000
*            /* ISSUE FREEMAIN                                       */ 00719000
*            GEN (FREEMAIN  A=FREEUID,MF=(E,FMLST))                0306 00720000
*                REFS(FREEUID);                                    0306 00721000
         FREEMAIN  A=FREEUID,MF=(E,FMLST)                               00722000
*          END;                                                    0307 00723000
@DE00302 L     @10,UIDLPTR                                         0307 00724000
         LTR   @10,@10                                             0307 00725000
         BNZ   @DL00302                                            0307 00726000
*          GOTO  READY;                /* GO TO GET COMMAND          */ 00727000
         B     READY                                               0308 00728000
*/********************************************************************/ 00729000
*/* NOSPAZ: AT THIS POINT A CONDITIONAL GETMAIN HAS FAILED.          */ 00730000
*/*    SET THE GENERAL ERROR FLAG AND ISSUE THE 'NOT ENOUGH CORE'    */ 00731000
*/*      MESSAGE.                                                    */ 00732000
*/********************************************************************/ 00733000
*NOSPAZ:   MSGNO = 6;                 /* SET MESSAGE INDEX           */ 00734000
NOSPAZ   LA    MSGNO,6                                             0309 00735000
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */ 00736000
         BAL   @14,MSGFNDR                                         0310 00737000
*          CALL  DOPUTL;              /* GO TO ISSUE PUTLINE         */ 00738000
         BAL   @14,DOPUTL                                          0311 00739000
*          GENERR = '1'B;             /* SET GENERAL ERROR FLAG      */ 00740000
         OI    GENERR,B'00000010'                                  0312 00741000
*/********************************************************************/ 00742000
*/* DOEND: AT THIS POINT AN END COMMAND HAS BEEN RECEIVED OR AN      */ 00743000
*/*      ERROR HAS BEEN DETECTED THAT HAS FORCED TERMINATION.        */ 00744000
*/*    IF STAX IS ACTIVE CANCEL IT.                                  */ 00745000
*/*    IF STAE IS ACTIVE CANCEL IT.                                  */ 00746000
*/*    IF ANY ERROR OCCURED SET THE RETURN CODE TO 12, OTHERWISE SET */ 00747000
*/*      THE RETURN CODE TO 0.                                       */ 00748000
*/*    RETURN TO CALLER.                                             */ 00749000
*/********************************************************************/ 00750000
*DOEND:    IF STXSET = '1'B           /* IS STAX ACTIVE              */ 00751000
*            THEN                     /* YES,                        */ 00752000
DOEND    TM    STXSET,B'00100000'                                  0313 00753000
         BNO   @RF00313                                            0313 00754000
*              GEN (STAX);            /* CANCEL ACCOUNT STAX         */ 00755000
         STAX                                                           00756000
*          IF STASET = '1'B           /* IS STAE ACTIVE              */ 00757000
*            THEN                     /* YES,                        */ 00758000
@RF00313 TM    STASET,B'00010000'                                  0315 00759000
         BNO   @RF00315                                            0315 00760000
*              GEN (STAE  0);         /* CANCEL ACCOUNT STAE         */ 00761000
         STAE  0                                                        00762000
*          IF ERRTN ^= '000'B         /* CHK FOR ERROR OCCURRED FLAG */ 00763000
*            THEN                     /* YES,                        */ 00764000
@RF00315 TM    ERRTN,B'00001110'                                   0317 00765000
         BZ    @RF00317                                            0317 00766000
*              DO;                                                 0318 00767000
*              CALL  CLRSTAC;         /* GO TO CLEAR INPUT STACK     */ 00768000
         BAL   @14,CLRSTAC                                         0319 00769000
*              RETURN CODE(12);       /* SET ERROR RETURN CODE       */ 00770000
         L     @13,4(,@13)                                         0320 00771000
         L     @00,@SIZDATD                                        0320 00772000
         LR    @01,@11                                             0320 00773000
         FREEMAIN R,LV=(0),A=(1)                                        00774000
         LA    @15,12                                              0320 00775000
         L     @14,12(,@13)                                        0320 00776000
         LM    @00,@12,20(@13)                                     0320 00777000
         BR    @14                                                 0320 00778000
*              END;                                                0321 00779000
*          RETURN CODE(0);            /* RETURN TO CALLER            */ 00780000
@RF00317 L     @13,4(,@13)                                         0322 00781000
         L     @00,@SIZDATD                                        0322 00782000
         LR    @01,@11                                             0322 00783000
         FREEMAIN R,LV=(0),A=(1)                                        00784000
         SLR   @15,@15                                             0322 00785000
         L     @14,12(,@13)                                        0322 00786000
         LM    @00,@12,20(@13)                                     0322 00787000
         BR    @14                                                 0322 00788000
*/* END OF ACCOUNT CP                                                */ 00789000
*/********************************************************************/ 00790000
*/* MSGFNDR: ENTRY TO RETRIEVE MESSAGE TEXT.                         */ 00791000
*/*    MOVE FIRST LEVEL OF MESSAGE INTO DYNAMIC STORAGE.             */ 00792000
*/*    IF THERE IS A SECOND LEVEL MESSAGE POINTER IN THE MESSAGE,    */ 00793000
*/*      MOVE THE SECOND LEVEL INTO DYNAMIC STORAGE ALSO.            */ 00794000
*/*    RETURN TO CALLER.                                             */ 00795000
*/********************************************************************/ 00796000
*MSGFNDR:  PROC ;                                                  0323 00797000
@EL00001 L     @13,4(,@13)                                         0323 00798000
@EF00001 L     @00,@SIZDATD                                        0323 00799000
         LR    @01,@11                                             0323 00800000
         FREEMAIN R,LV=(0),A=(1)                                        00801000
@ER00001 LM    @14,@12,12(@13)                                     0323 00802000
         BR    @14                                                 0323 00803000
@PB00001 DS    0H                                                  0323 00804000
MSGFNDR  STM   @14,@12,12(@13)                                     0323 00805000
*          MOFFNO=(MSGNO*2)+ADDR(ANDXL)-2;  /* FORM PTR TO OFFSET    */ 00806000
         LR    MOFFNO,MSGNO                                        0324 00807000
         ALR   MOFFNO,MOFFNO                                       0324 00808000
         L     @10,@CV00165                                        0324 00809000
         ALR   MOFFNO,@10                                          0324 00810000
         BCTR  MOFFNO,0                                            0324 00811000
         BCTR  MOFFNO,0                                            0324 00812000
*          MSGPTR = MOFFNC + ADDR(ANDXL); /* FORM PTR TO TEXT        */ 00813000
         L     MSGPTR,@CV00165                                     0325 00814000
         AH    MSGPTR,MOFFNC(,MOFFNO)                              0325 00815000
*          MSGLNG = (SEG1*4)+8;       /* LENGTH =(NO. OF SEG X 4) + 8*/ 00816000
         LA    @10,8                                               0326 00817000
         L     MSGLNG,SEG1(,MSGPTR)                                0326 00818000
         SLA   MSGLNG,2                                            0326 00819000
         ALR   MSGLNG,@10                                          0326 00820000
*          TMSGNS1(1:MSGLNG) = MSGMODL1;/* COPY FIRST LEVEL MSG      */ 00821000
         LR    @15,MSGLNG                                          0327 00822000
         BCTR  @15,0                                               0327 00823000
         EX    @15,@SM00425                                        0327 00824000
*          IF MODX1 ^= 0              /* IS THERE A SECOND LEVEL?    */ 00825000
*            THEN                     /* YES,                        */ 00826000
         L     @02,MODX1(,MSGPTR)                                  0328 00827000
         LTR   @02,@02                                             0328 00828000
         BZ    @RF00328                                            0328 00829000
*              DO;                                                 0329 00830000
*              MSGLNG = (SEG2*4)+8;   /* LENGTH =(NO. OF SEG X 4) + 8*/ 00831000
         L     @15,MODX1(,MSGPTR)                                  0330 00832000
         L     MSGLNG,SEG2(,@15)                                   0330 00833000
         SLA   MSGLNG,2                                            0330 00834000
         ALR   MSGLNG,@10                                          0330 00835000
*              TMSGNS2(1:MSGLNG) = MSGMODL2;/* COPY SECOND LEVEL MSG */ 00836000
         LR    @10,MSGLNG                                          0331 00837000
         BCTR  @10,0                                               0331 00838000
         EX    @10,@SM00427                                        0331 00839000
*              TMSGNPTR = ADDR(TMSGNS2);/* SET PTR TO SECOND LEVEL   */ 00840000
         LA    @10,TMSGNS2                                         0332 00841000
         ST    @10,TMSGNPTR                                        0332 00842000
*              END;                                                0333 00843000
*          END  MSGFNDR;              /* RETURN TO CALLER            */ 00844000
@EL00002 DS    0H                                                  0334 00845000
@EF00002 DS    0H                                                  0334 00846000
@ER00002 LM    @14,@12,12(@13)                                     0334 00847000
         BR    @14                                                 0334 00848000
*/********************************************************************/ 00849000
*/* CLRSTAC: ENTRY TO CLEAR THE INPUT STACK.                         */ 00850000
*/*    ISSUE THE STACK SVC TO CLEAR THE INPUT STACK AND RETURN TO    */ 00851000
*/*      CALLER.                                                     */ 00852000
*/********************************************************************/ 00853000
*CLRSTAC:  PROC ;                                                  0335 00854000
CLRSTAC  STM   @14,@12,@SA00003                                    0335 00855000
*          GEN (TCLEARQ INPUT);       /* CLEAR TERMINAL INPUT QUEUE  */ 00856000
         TCLEARQ INPUT                                                  00857000
*          GEN (STACK ,MF=(E,STPL1)); /* CLEAR STACK                 */ 00858000
         STACK ,MF=(E,STPL1)                                            00859000
*          END  CLRSTAC;              /* RETURN TO CALLER            */ 00860000
@EL00003 DS    0H                                                  0338 00861000
@EF00003 DS    0H                                                  0338 00862000
@ER00003 LM    @14,@12,@SA00003                                    0338 00863000
         BR    @14                                                 0338 00864000
*/********************************************************************/ 00865000
*/* DODAR2C: ENTRY TO FREE DYNAMICALLY ALLOCATED DATA SETS.          */ 00866000
*/*    LINK TO DAIR TO DEALLOCATE THE DATA SET.                      */ 00867000
*/*    CHECK THE RETURN CODE FROM DAIR, IF IT IS NOT 0 LINK TO       */ 00868000
*/*      DAIRFAIL TO ISSUE THE ERROR MESSAGE.                        */ 00869000
*/*    RETURN TO CALLER.                                             */ 00870000
*/********************************************************************/ 00871000
*DODAR2C:  PROC ;                                                  0339 00872000
DODAR2C  STM   @14,@12,@SA00004                                    0339 00873000
*          /* LINK TO DAIR                                           */ 00874000
*          GEN (LINK  EP=IKJDAIR,MF=(E,DAPL1),SF=(E,LNKCPL))       0340 00875000
*            REFS(DAPL1,LNKCPL);                                   0340 00876000
         LINK  EP=IKJDAIR,MF=(E,DAPL1),SF=(E,LNKCPL)                    00877000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00878000
*          RTNCODE  =  R15;           /* RESERVE RETURN CODE         */ 00879000
         ST    R15,RTNCODE                                         0342 00880000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00881000
*          IF RTNCODE ^= 0            /* CHECK FOR FAILURE CODE      */ 00882000
*            THEN                     /* YES,                        */ 00883000
         L     @10,RTNCODE                                         0344 00884000
         LTR   @10,@10                                             0344 00885000
         BZ    @RF00344                                            0344 00886000
*              DO;                                                 0345 00887000
*              GENERR='1'B;           /* WILL CAUSE RETURN CODE TO BE   00888000
*                                        SET TO 12 BEFORE RETURN     */ 00889000
         OI    GENERR,B'00000010'                                  0346 00890000
*              GEN (LINK  EP=IKJEFF18,MF=(E,DAIRFPPL),SF=(E,LNKCPL))    00891000
*                REFS(DAIRFPPL,LNKCPL);                            0347 00892000
         LINK  EP=IKJEFF18,MF=(E,DAIRFPPL),SF=(E,LNKCPL)                00893000
*              END;                                                0348 00894000
*          END  DODAR2C;              /* RETURN TO CALLER            */ 00895000
@EL00004 DS    0H                                                  0349 00896000
@EF00004 DS    0H                                                  0349 00897000
@ER00004 LM    @14,@12,@SA00004                                    0349 00898000
         BR    @14                                                 0349 00899000
*/********************************************************************/ 00900000
*/* DOPUTL: ENTRY TO ISSUE PUTLINE SVC.                              */ 00901000
*/*    IF ACCOUNT IS ACTIVE IN THE BACKGROUND SET THE GENERAL ERROR  */ 00902000
*/*      FLAG.                                                       */ 00903000
*/*    ISSUE PUTLINE TO ISSUE AN ERROR MESSAGE.                      */ 00904000
*/*    CHECK THE RETURN CODE, IF THE RETURN CODE FROM PUTLINE IS     */ 00905000
*/*      GREATER THAN EIGHT SET THE PUTLINE FAILED FLAG. IF THE      */ 00906000
*/*      RETURN CODE IS 16 ISSUE THE 'NOT ENOUGH CORE' MESSAGE,      */ 00907000
*/*      OTHERWISE ISSUE THE 'COMMAND SYSTEM ERROR' MESSAGE.         */ 00908000
*/*    RETURN TO CALLER.                                             */ 00909000
*/********************************************************************/ 00910000
*DOPUTL:   PROC ;                                                  0350 00911000
DOPUTL   STM   @14,@12,@SA00005                                    0350 00912000
*          IF ECTBKGRD='1'B           /* IS ACCOUNT IN BACKGROUND    */ 00913000
*            THEN                     /* YES,                        */ 00914000
         TM    ECTBKGRD(ECTPTR),B'00000010'                        0351 00915000
         BNO   @RF00351                                            0351 00916000
*              GENERR='1'B;           /* WILL CAUSE RETURN CODE TO BE   00917000
*                                        SET TO 12 BEFORE RETURN     */ 00918000
         OI    GENERR,B'00000010'                                  0352 00919000
*          IOPLIOPB = ADDR(PLPB);     /* POINT TO PUTLINE PARM BLOCK */ 00920000
@RF00351 LA    @10,PLPB                                            0353 00921000
         ST    @10,IOPLIOPB(,IOPLPTR)                              0353 00922000
*          PTPBOPUT = ADDR(TMSGNS1);  /* POINT TO MESSAGE            */ 00923000
         L     @10,PTPBPTR(,IOPLPTR)                               0354 00924000
         LA    @07,TMSGNS1                                         0354 00925000
         ST    @07,PTPBOPUT(,@10)                                  0354 00926000
*          GEN (PUTLINE  ,MF=(E,IOPL1))                            0355 00927000
*            REFS(IOPL1);                                          0355 00928000
         PUTLINE  ,MF=(E,IOPL1)                                         00929000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00930000
*          RTNCODE = R15;             /* RESERVE RETURN CODE         */ 00931000
         ST    R15,RTNCODE                                         0357 00932000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00933000
*          IF RTNCODE > 8             /* CHK FOR SUCESSFUL PUTLINE   */ 00934000
*            THEN                     /* NO,                         */ 00935000
         L     @10,RTNCODE                                         0359 00936000
         CH    @10,@CH00077                                        0359 00937000
         BNH   @RF00359                                            0359 00938000
*              DO;                                                 0360 00939000
*              IF PLFAIL = '0'B       /* CHK FOR PREVIOUS FAILURE    */ 00940000
*                THEN                 /* NO,                         */ 00941000
         TM    PLFAIL,B'00001000'                                  0361 00942000
         BNZ   @RF00361                                            0361 00943000
*                  DO;                                             0362 00944000
*                  PLFAIL = '1'B;     /* SET PUTLINE FAILURE FLAG    */ 00945000
         OI    PLFAIL,B'00001000'                                  0363 00946000
*                  IF RTNCODE = 16    /* INSUFFICIENT SPACE?         */ 00947000
*                    THEN             /* YES,                        */ 00948000
         CH    @10,@CH00163                                        0364 00949000
         BNE   @RF00364                                            0364 00950000
*                      RETURN TO  NOSPAZ; /* GO ISSUE NO SPACE MSG   */ 00951000
         LA    @14,NOSPAZ                                          0365 00952000
         LM    @15,@12,@SA00005+4                                  0365 00953000
         BR    @14                                                 0365 00954000
*                  MSGNO = 11;        /* SET MESSAGE INDEX           */ 00955000
@RF00364 LA    MSGNO,11                                            0366 00956000
*                  CALL SYSERRD;      /* TO ISSUE SYSTEM ERROR MSG   */ 00957000
         BAL   @14,SYSERRD                                         0367 00958000
*                  RETURN TO DOEND;   /* TERMINATE                   */ 00959000
         LA    @14,DOEND                                           0368 00960000
         LM    @15,@12,@SA00005+4                                  0368 00961000
         BR    @14                                                 0368 00962000
*                  END;                                            0369 00963000
*              END;                                                0370 00964000
@RF00361 DS    0H                                                  0371 00965000
*          PLFAIL = '0'B;             /* CLEAR PUTLINE FAILURE FLAG  */ 00966000
@RF00359 NI    PLFAIL,B'11110111'                                  0371 00967000
*          IOPLIOPB = ADDR(PGPBM);    /* RESET POINTER TO PUTGET PB  */ 00968000
         LA    @10,PGPBM                                           0372 00969000
         ST    @10,IOPLIOPB(,IOPLPTR)                              0372 00970000
*          PGPBOBUF = ADDR(TMSGMDS);  /* SET PTR TO MODE MESSAGE     */ 00971000
         LA    @10,TMSGMDS                                         0373 00972000
         ST    @10,PGPBOBUF                                        0373 00973000
*          END  DOPUTL;               /* RETURN TO CALLER            */ 00974000
@EL00005 DS    0H                                                  0374 00975000
@EF00005 DS    0H                                                  0374 00976000
@ER00005 LM    @14,@12,@SA00005                                    0374 00977000
         BR    @14                                                 0374 00978000
*/********************************************************************/ 00979000
*/* DOPTGT: ENTRY TO ISSUE THE ACCOUNT MODE MESSAGE AND RETRIEVE     */ 00980000
*/*      A COMMAND.                                                  */ 00981000
*/*    ISSUE PUTGET.                                                 */ 00982000
*/*    CHECK THE RETURN CODE, IF THE RETURN CODE FROM PUTGET IS      */ 00983000
*/*      GREATER THAN 16 SET THE PUTGET FAILED FLAG. IF THE          */ 00984000
*/*      RETURN CODE IS 28 ISSUE THE 'NOT ENOUGH CORE' MESSAGE,      */ 00985000
*/*      OTHERWISE ISSUE THE 'COMMAND SYSTEM ERROR' MESSAGE.         */ 00986000
*/*    RETURN TO CALLER.                                             */ 00987000
*/********************************************************************/ 00988000
*DOPTGT:   PROC ;                                                  0375 00989000
DOPTGT   STM   @14,@12,@SA00006                                    0375 00990000
*          GEN (PUTGET  MF=(E,IOPL1)) /* ISSUE PUTGET                */ 00991000
*            REFS(IOPL1);                                          0376 00992000
         PUTGET  MF=(E,IOPL1)                                           00993000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00994000
*          RTNCODE = R15;             /* RESERVE RETURN CODE         */ 00995000
         ST    R15,RTNCODE                                         0378 00996000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00997000
*          IF RTNCODE = 8             /* CHK FOR ATTENTION INTERUPT  */ 00998000
*            THEN                     /* YES,                        */ 00999000
         L     @10,RTNCODE                                         0380 01000000
         CH    @10,@CH00077                                        0380 01001000
         BNE   @RF00380                                            0380 01002000
*              DO;                                                 0381 01003000
*              ATTENTN = '0'B;        /* RESET ECB FOR ATTENTION     */ 01004000
         NI    ATTENTN,B'10111111'                                 0382 01005000
*              RETURN TO PUTGATTN;    /* RETURN TO PROCESS ATTENTION    01006000
*                                        INPUT                       */ 01007000
         LA    @14,PUTGATTN                                        0383 01008000
         LM    @15,@12,@SA00006+4                                  0383 01009000
         BR    @14                                                 0383 01010000
*              END;                                                0384 01011000
*          IF RTNCODE > 16            /* CHK FOR PUTGET FAILURE      */ 01012000
*            THEN                     /* YES,                        */ 01013000
@RF00380 L     @10,RTNCODE                                         0385 01014000
         CH    @10,@CH00163                                        0385 01015000
         BNH   @RF00385                                            0385 01016000
*              DO;                                                 0386 01017000
*              IF PGFAIL = '0'B       /* CHK FOR PREVIOUS FAILURE    */ 01018000
*                THEN                 /* NO,                         */ 01019000
         TM    PGFAIL,B'00000100'                                  0387 01020000
         BNZ   @RF00387                                            0387 01021000
*                  DO;                                             0388 01022000
*                  PGFAIL = '1'B;     /* SET PUTGET FAILURE FLAG     */ 01023000
         OI    PGFAIL,B'00000100'                                  0389 01024000
*                  IF RTNCODE = 28    /* CHK FOR INSUFFICIENT SPACE  */ 01025000
*                    THEN             /* YES,                        */ 01026000
         CH    @10,@CH00285                                        0390 01027000
         BNE   @RF00390                                            0390 01028000
*                      RETURN TO  NOSPAZ; /* GO ISSUE NO SPACE MSG   */ 01029000
         LA    @14,NOSPAZ                                          0391 01030000
         LM    @15,@12,@SA00006+4                                  0391 01031000
         BR    @14                                                 0391 01032000
*                  MSGNO = 12;        /* SET MESSAGE INDEX           */ 01033000
@RF00390 LA    MSGNO,12                                            0392 01034000
*                  CALL SYSERRD;      /* TO ISSUE SYSTEM ERROR MSG   */ 01035000
         BAL   @14,SYSERRD                                         0393 01036000
*                  RETURN TO DOEND;   /* TERMINATE                   */ 01037000
         LA    @14,DOEND                                           0394 01038000
         LM    @15,@12,@SA00006+4                                  0394 01039000
         BR    @14                                                 0394 01040000
*                  END;                                            0395 01041000
*              END;                                                0396 01042000
*            ELSE                                                  0397 01043000
*              PGFAIL = '0'B;         /* CLEAR PUTGET FAILURE FLAG   */ 01044000
         B     @RC00385                                            0397 01045000
@RF00385 NI    PGFAIL,B'11111011'                                  0397 01046000
*          PGPBOBUF = 0;              /* DO NOT REISSUE MODE MESSAGE */ 01047000
@RC00385 SLR   @10,@10                                             0398 01048000
         ST    @10,PGPBOBUF                                        0398 01049000
*          END  DOPTGT;                                            0399 01050000
@EL00006 DS    0H                                                  0399 01051000
@EF00006 DS    0H                                                  0399 01052000
@ER00006 LM    @14,@12,@SA00006                                    0399 01053000
         BR    @14                                                 0399 01054000
*/********************************************************************/ 01055000
*/* SYSERRD: AT THIS POINT AN UNUSUAL ERROR HAS BEEN DETECTED BY A   */ 01056000
*/*      SERVICE ROUTINE. THE RETURN CODE WAS SAVED IN 'RTNCODE'.    */ 01057000
*/*    SET THE GENERAL ERROR FLAG AND CONVERT THE RETURN CODE TO     */ 01058000
*/*      PRINTABLE DECIMAL CHARACTERS.                               */ 01059000
*/*    ISSUE THE 'COMMAND SYSTEM ERROR' MESSAGE AND RETURN.          */ 01060000
*/********************************************************************/ 01061000
*SYSERRD:  PROC;                                                   0400 01062000
SYSERRD  STM   @14,@12,@SA00007                                    0400 01063000
*          GENERR = '1'B;             /* SET GENERAL ERROR FLAG      */ 01064000
         OI    GENERR,B'00000010'                                  0401 01065000
*          CALL MSGFNDR;              /* GO TO LOCATE MESSAGE        */ 01066000
         BAL   @14,MSGFNDR                                         0402 01067000
*          CVD  (RTNCODE,DBLWORD);    /* CONVERT CODE TO DECIMAL     */ 01068000
         L     @10,RTNCODE                                         0403 01069000
         CVD   @10,DBLWORD                                         0403 01070000
*          UNPK (TMSGTIN1(1:2),DBLWORD(6:8)); /* UNPACK INTO MESSAGE */ 01071000
         UNPK  TMSGTIN1(2),DBLWORD+5(3)                            0404 01072000
*          TMSGTIN1(2) = TMSGTIN1(2)|'F0'X; /* REMOVE SIGN           */ 01073000
         OI    TMSGTIN1+1,X'F0'                                    0405 01074000
*          TMSGNP23 = ADDR(TMSGTIX1); /* SET MESSAGE POINTER         */ 01075000
         LA    @10,TMSGTIX1                                        0406 01076000
         ST    @10,TMSGNP23                                        0406 01077000
*          TMSGTIL1 = 6;              /* SET LENGTH OF SEGMENT       */ 01078000
         MVC   TMSGTIL1(2),@CH00223                                0407 01079000
*          TMSGTIO1 = 23;             /* SET INSERT OFFSET           */ 01080000
         MVC   TMSGTIO1(2),@CH00381                                0408 01081000
*          CALL  DOPUTL;              /* GO TO ISSUE MESSAGE         */ 01082000
         BAL   @14,DOPUTL                                          0409 01083000
*          END SYSERRD;                                            0410 01084000
@EL00007 DS    0H                                                  0410 01085000
@EF00007 DS    0H                                                  0410 01086000
@ER00007 LM    @14,@12,@SA00007                                    0410 01087000
         BR    @14                                                 0410 01088000
*/********************************************************************/ 01089000
*/* STAXXIN: ENTRY POINT FOR ATTENTION INTERUPT HANDLING.            */ 01090000
*/*    RESTORE ACCOUNT'S REGISTERS FROM THE STAX PARAMETER LIST.     */ 01091000
*/*    IF A NULL LINE WAS ENTERED RETURN TO PROCESSING.              */ 01092000
*/*    ISSUE PUTGET TO RETRIEVE THE INPUT LINE                       */ 01093000
*/*    IF SEND IS NOT ACTIVE ISSUE STATUS TO TERMINATE ANY ATTACHED  */ 01094000
*/*      ACTIVITY AND DETACH HELP IF IT IS ACTIVE.                   */ 01095000
*/*    POST THE ACCOUNT ECB AND SET THE ATTENTION COMMAND FLAG.      */ 01096000
*/*    RETURN TO THE ATTENTION HANDLER.                              */ 01097000
*/********************************************************************/ 01098000
*STAXXIN:  PROC OPTIONS(NOSAVEAREA);                               0411 01099000
STAXXIN  STM   @14,@12,12(@13)                                     0411 01100000
*          RFY (R1,R2,R13) RSTD;      /* RESTRICT STAX INPUT POINTER */ 01101000
*          R2 = STXUSR13;             /* GET SAVE AREA POINTER       */ 01102000
         L     R2,STXUSR13(,R1)                                    0413 01103000
*          GEN (LM  R2,R12,28(R2));   /* RELOAD ACCOUNT'S REGISTERS  */ 01104000
         LM  R2,R12,28(R2)                                              01105000
*          RFY (R1,R2) UNRSTD;                                     0415 01106000
*          STAXSAVE = R13;            /* SAVE STAX SAVE AREA PTR     */ 01107000
         LR    STAXSAVE,R13                                        0416 01108000
*          R13 = ADDR(SAVEARA);       /* USE NEW SAVE AREA           */ 01109000
         LA    R13,SAVEARA                                         0417 01110000
*          IOPLIOPB = ADDR(PGPBA);    /* SET PTR TO PARAMETER BLOCK  */ 01111000
         LA    @10,PGPBA                                           0418 01112000
         ST    @10,IOPLIOPB(,IOPLPTR)                              0418 01113000
*          ATTENTN='0'B;              /* RESET ATTENTION FLAG        */ 01114000
         NI    ATTENTN,B'10111111'                                 0419 01115000
*          CALL  DOPTGT;              /* GO TO ISSUE PUTGET          */ 01116000
         BAL   @14,DOPTGT                                          0420 01117000
*          IOPLIOPB = ADDR(PGPBM);    /* RESET PTR TO PUTGET PB      */ 01118000
         LA    @10,PGPBM                                           0421 01119000
         ST    @10,IOPLIOPB(,IOPLPTR)                              0421 01120000
*          IF INPLEN = 4              /* IS BUFFER LENGTH EQUAL TO 4?*/ 01121000
*            THEN                     /* YES, MUST BE NULL LINE      */ 01122000
         L     @10,ATTNBUFP                                        0422 01123000
         CLC   INPLEN(2,@10),@CH00144                              0422 01124000
         BE    @RT00422                                            0422 01125000
*              GOTO STAXEND;          /* RETURN TO STAX              */ 01126000
*          IF SNDNOW = '0'B           /* CHK SEND ACTIVE FLAG        */ 01127000
*            THEN                     /* NO,                         */ 01128000
         TM    SNDNOW,B'10000000'                                  0424 01129000
         BNZ   @RF00424                                            0424 01130000
*              GEN (STATUS STOP);     /* EXECUTE STOP EXCEPT FOR SEND*/ 01131000
         STATUS STOP                                                    01132000
*          IF HLPNOW = '1'B           /* CHK FOR ACTIVE HELP FLAG    */ 01133000
*            THEN                     /* YES,                        */ 01134000
@RF00424 TM    HLPNOW,B'01000000'                                  0426 01135000
         BNO   @RF00426                                            0426 01136000
*              DO;                                                 0427 01137000
*              DA2CTCB = HLPTCB;      /* SET TCB PTR IN DAIR PB      */ 01138000
         L     @10,DAPLPTR                                         0428 01139000
         L     @10,DAPB2PTR(,@10)                                  0428 01140000
         L     @06,HLPTCB                                          0428 01141000
         ST    @06,DA2CTCB(,@10)                                   0428 01142000
*              CALL DODAR2C;          /* FREE HELP DATA SET          */ 01143000
         BAL   @14,DODAR2C                                         0429 01144000
*              GEN (DETACH HLPTCB);   /* DETACH HELP                 */ 01145000
         DETACH HLPTCB                                                  01146000
*              HLPNOW = '0'B;         /* SET HELP NOT ACTIVE FLAG    */ 01147000
         NI    HLPNOW,B'10111111'                                  0431 01148000
*              END;                                                0432 01149000
*          ATTENTN = '1'B;            /* POST ECB FOR ATTENTION      */ 01150000
@RF00426 OI    ATTENTN,B'01000000'                                 0433 01151000
*          ATNCMD = '1'B;             /* SET ATTENTION COMMAND FLAG  */ 01152000
         OI    ATNCMD,B'10000000'                                  0434 01153000
*STAXEND:  R13 = STAXSAVE;            /* RESTORE STAX SAVE AREA PTR  */ 01154000
STAXEND  LR    R13,STAXSAVE                                        0435 01155000
*          RETURN CODE(0);            /* RETURN TO ATTENTION HANDLER */ 01156000
         SLR   @15,@15                                             0436 01157000
         L     @14,12(,@13)                                        0436 01158000
         LM    @00,@12,20(@13)                                     0436 01159000
         BR    @14                                                 0436 01160000
*          END  STAXXIN;                                           0437 01161000
*/********************************************************************/ 01162000
*/* STAEXIN: ENTRY POINT FOR STAE EXIT.                              */ 01163000
*/*    RESTORE ACCOUNT'S REGISTERS FROM THE STAE WORK AREA.          */ 01164000
*/*    BUILD THE 'ENDED DUE TO ERROR' MESSAGE, CONVERT THE ABEND     */ 01165000
*/*      CODE TO DECIMAL AND ISSUE THE MESSAGE.                      */ 01166000
*/*    CLEAR THE INPUT STACK, POST THE ACCOUNT ECB AND RETURN TO     */ 01167000
*/*      STAE WITH NO RETRY SCHEDULED.                               */ 01168000
*/********************************************************************/ 01169000
*STAEXIN:  PROC OPTIONS(DONTSAVE(15,0),NOSAVEAREA);                0438 01170000
STAEXIN  ST    @14,12(,@13)                                        0438 01171000
         STM   @01,@12,24(@13)                                     0438 01172000
*          /* ESTABLISH ENTRY ADDRESSABILITY                         */ 01173000
*          RFY (R1,R2,R13) RSTD;      /* RESTRICT STAE REGISTERS     */ 01174000
*          R2 = STAUSR13;             /* GET SAVE AREA POINTER       */ 01175000
         L     R2,STAUSR13(,R1)                                    0440 01176000
*          GEN (LM  R2,R12,28(R2));   /* RELOAD ACCOUNT'S REGISTERS  */ 01177000
         LM  R2,R12,28(R2)                                              01178000
*          RFY R2 UNRSTD;             /* RELEASE WORK REGISTERS      */ 01179000
*          RTNCODE = SABND;           /* PRESERVE ABEND RETURN CODE  */ 01180000
         L     @10,SABND(,R1)                                      0443 01181000
         ST    @10,RTNCODE                                         0443 01182000
*          ECTRTCD = RTNCODE;         /* RESERVE ABEND CODE          */ 01183000
         STCM  @10,7,ECTRTCD(ECTPTR)                               0444 01184000
*          ECTRCDF = '80'X;           /* SET ABEND CODE FLAG         */ 01185000
         MVI   ECTRCDF(ECTPTR),X'80'                               0445 01186000
*          IF STANOW = '1'B           /* CHK IF ABEND RE-ENTRY       */ 01187000
*           | ECTATRM = '1'B          /* CHK FOR ECT QUIT FLAG       */ 01188000
*            THEN                     /* YES,                        */ 01189000
         TM    STANOW,B'00000001'                                  0446 01190000
         BO    @RT00446                                            0446 01191000
         TM    ECTATRM(ECTPTR),B'00100000'                         0446 01192000
         BNO   @RF00446                                            0446 01193000
@RT00446 DS    0H                                                  0447 01194000
*              RETURN CODE(0);        /* GO TO IMMEDIATE EXIT        */ 01195000
         SLR   @15,@15                                             0447 01196000
@EL00009 DS    0H                                                  0447 01197000
@EF00009 DS    0H                                                  0447 01198000
@ER00009 L     @14,12(,@13)                                        0447 01199000
         LM    @01,@12,24(@13)                                     0447 01200000
         BR    @14                                                 0447 01201000
*          STANOW = '1'B;             /* SET ABEND ACTIVE FLAG       */ 01202000
@RF00446 OI    STANOW,B'00000001'                                  0448 01203000
*          STAESAVE = R13;            /* SAVE STAE SAVE AREA PTR     */ 01204000
         LR    STAESAVE,R13                                        0449 01205000
*          R13 = STAUSR13;            /* USE INPUT PARM FOR SAVE PTR */ 01206000
         L     R13,STAUSR13(,R1)                                   0450 01207000
*          RFY R1 UNRSTD;             /* RELEASE STAE REGISTERS      */ 01208000
*          MSGNO = 9;                 /* SET MESSAGE INDEX FOR ABEND */ 01209000
         LA    MSGNO,9                                             0452 01210000
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */ 01211000
         BAL   @14,MSGFNDR                                         0453 01212000
*          TMSGNP12 = ADDR(TMSGTIX1); /* SET PTR TO 1ST TEXT SEGMENT */ 01213000
         LA    @10,TMSGTIX1                                        0454 01214000
         ST    @10,TMSGNP12                                        0454 01215000
*          TMSGNP22 = ADDR(TMSGTIX2); /* SET PTR TO 2ND TEXT SEGMENT */ 01216000
         LA    @10,TMSGTIX2                                        0455 01217000
         ST    @10,TMSGNP22                                        0455 01218000
*          IF ECTSCMD(1) = ' '        /* CHK FOR BLANK IN SUBCOMMAND */ 01219000
*            THEN                     /* YES,                        */ 01220000
         CLI   ECTSCMD(ECTPTR),C' '                                0456 01221000
         BNE   @RF00456                                            0456 01222000
*              TMSGTIN1 = ECTPCMD;    /* SET UP COMMAND NAME         */ 01223000
         MVI   TMSGTIN1+8,C' '                                     0457 01224000
         MVC   TMSGTIN1+9(31),TMSGTIN1+8                           0457 01225000
         MVC   TMSGTIN1(8),ECTPCMD(ECTPTR)                         0457 01226000
*            ELSE                                                  0458 01227000
*              TMSGTIN1 = ECTSCMD;    /* SET UP SUBCOMMAND NAME      */ 01228000
         B     @RC00456                                            0458 01229000
@RF00456 MVI   TMSGTIN1+8,C' '                                     0458 01230000
         MVC   TMSGTIN1+9(31),TMSGTIN1+8                           0458 01231000
         MVC   TMSGTIN1(8),ECTSCMD(ECTPTR)                         0458 01232000
*          DO TSTLNG = 8              /* INITIALIZE SCAN LENGTH      */ 01233000
*            WHILE TMSGTIN1(TSTLNG)   /* CHK FOR BLANK               */ 01234000
*            = ' ' BY -1;                                          0459 01235000
@RC00456 LA    TSTLNG,8                                            0459 01236000
         B     @DE00459                                            0459 01237000
@DL00459 DS    0H                                                  0460 01238000
*          END;                                                    0460 01239000
         BCTR  TSTLNG,0                                            0460 01240000
@DE00459 LA    @10,TMSGTIN1-1(TSTLNG)                              0460 01241000
         CLI   0(@10),C' '                                         0460 01242000
         BE    @DL00459                                            0460 01243000
*          TMSGTIL1 = TSTLNG+4;       /* SET TEXT SEGMENT LENGTH     */ 01244000
         LA    @10,4                                               0461 01245000
         ALR   @10,TSTLNG                                          0461 01246000
         STH   @10,TMSGTIL1                                        0461 01247000
*          TMSGTIO1 = 10;             /* SET TEXT OFFSET             */ 01248000
         MVC   TMSGTIO1(2),@CH00338                                0462 01249000
*          UNPK (TMSGTIN2(1:5),ABENDCD);/* UNPACK THE ABEND CODE     */ 01250000
         UNPK  TMSGTIN2(5),ABENDCD(3)                              0463 01251000
*          GEN (TR    TMSGTIN2(3),HEXTBL-240); /* CONVERT CODE TO BCD*/ 01252000
         TR    TMSGTIN2(3),HEXTBL-240                                   01253000
*          TMSGTIL2 = 7;              /* SET TEXT SEGMENT LENGTH     */ 01254000
         MVC   TMSGTIL2(2),@CH00114                                0465 01255000
*          TMSGTIO2 = 33;             /* SET TEXT OFFSET             */ 01256000
         MVC   TMSGTIO2(2),@CH00394                                0466 01257000
*          CALL  DOPUTL;              /* GO TO ISSUE PUTLINE         */ 01258000
         BAL   @14,DOPUTL                                          0467 01259000
*          CALL  CLRSTAC;             /* GO TO CLEAR INPUT STACK     */ 01260000
         BAL   @14,CLRSTAC                                         0468 01261000
*          GEN (POST ACCTECB,20)      /* POST ACCOUNT ECB            */ 01262000
*               SETS(ACCTECB);                                     0469 01263000
         POST ACCTECB,20                                                01264000
*          R13 = STAESAVE;            /* RESTORE STAE SAVE AREA PTR  */ 01265000
         LR    R13,STAESAVE                                        0470 01266000
*          RETURN CODE(0);            /* RETURN TO STAE ROUTINE      */ 01267000
         SLR   @15,@15                                             0471 01268000
         L     @14,12(,@13)                                        0471 01269000
         LM    @01,@12,24(@13)                                     0471 01270000
         BR    @14                                                 0471 01271000
*          END  STAEXIN;                                           0472 01272000
*          END  IKJEFA00                                           0473 01273000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01274000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        * 01275000
*/*%INCLUDE SYSLIB  (IKJCSOA )                                        * 01276000
*/*%INCLUDE SYSLIB  (IKJCSPL )                                        * 01277000
*/*%INCLUDE SYSLIB  (IKJDAPL )                                        * 01278000
*/*%INCLUDE SYSLIB  (IKJDAP2C)                                        * 01279000
*/*%INCLUDE SYSLIB  (IKJECT  )                                        * 01280000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        * 01281000
*/*%INCLUDE SYSLIB  (IKJPGPB )                                        * 01282000
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        * 01283000
*/*%INCLUDE SYSLIB  (IKJPTPB )                                        * 01284000
*/*%INCLUDE SYSLIB  (IKJSTPL )                                        * 01285000
*/*%INCLUDE SYSLIB  (IKJEFUDL)                                        * 01286000
*;                                                                 0473 01287000
@DATA    DS    0H                                                       01288000
@CH00144 DC    H'4'                                                     01289000
@CH00223 DC    H'6'                                                     01290000
@CH00114 DC    H'7'                                                     01291000
@CH00077 DC    H'8'                                                     01292000
@CH00338 DC    H'10'                                                    01293000
@CH00163 DC    H'16'                                                    01294000
@CH00381 DC    H'23'                                                    01295000
@CH00285 DC    H'28'                                                    01296000
@CH00355 DC    H'29'                                                    01297000
@CH00394 DC    H'33'                                                    01298000
@CH00336 DC    H'37'                                                    01299000
@SM00395 MVC   CPLS(0),MCPLS                                            01300000
@SM00400 MVC   TMSGTIN1(0),ICBFDA(@09)                                  01301000
@SC00404 CLC   CMDLOC(0,@10),ADDDEF                                     01302000
@SC00406 CLC   CMDLOC(0,@10),CHGDEF                                     01303000
@SC00408 CLC   CMDLOC(0,@10),DELDEF                                     01304000
@SC00410 CLC   CMDLOC(0,@10),ENDDEF                                     01305000
@SC00412 CLC   CMDLOC(0,@10),LSTDEF                                     01306000
@SC00414 CLC   CMDLOC(0,@10),LSTIDEF                                    01307000
@SC00416 CLC   CMDLOC(0,@10),SYNDEF                                     01308000
@SC00418 CLC   CMDLOC(0,@10),HLPDEF                                     01309000
@SM00423 MVC   TMSGTIN1(0),CMDLOC(@09)                                  01310000
@SM00425 MVC   TMSGNS1(0),MSGMODL1(MSGPTR)                              01311000
@SM00427 MVC   TMSGNS2(0),MSGMODL2(@15)                                 01312000
@DATD    DSECT                                                          01313000
         DS    0F                                                       01314000
@SA00001 DS    18F                                                      01315000
@SA00007 DS    15F                                                      01316000
@SA00005 DS    15F                                                      01317000
@SA00003 DS    15F                                                      01318000
@SA00006 DS    15F                                                      01319000
@SA00004 DS    15F                                                      01320000
IKJEFA00 CSECT                                                          01321000
         DS    0F                                                       01322000
@CF00032 DC    F'1'                                                     01323000
@CF00073 DC    F'2'                                                     01324000
@CF00109 DC    F'12'                                                    01325000
@DATD    DSECT                                                          01326000
         DS    0D                                                       01327000
ACCTECB  DS    AL4                                                      01328000
         ORG   ACCTECB                                                  01329000
@NM00016 DS    AL1                                                      01330000
         ORG   @NM00016                                                 01331000
@NM00017 DS    BL1                                                      01332000
ATTENTN  EQU   @NM00016+0                                               01333000
         ORG   ACCTECB+1                                                01334000
ECBCODE  DS    AL3                                                      01335000
         ORG   ACCTECB+4                                                01336000
BUFFPTR  DS    A                                                        01337000
BUFFLEN  DS    A                                                        01338000
RTNCODE  DS    F                                                        01339000
HLPTCB   DS    A                                                        01340000
HLPECB   DS    FL4                                                      01341000
         ORG   HLPECB                                                   01342000
HWTCTL   DS    BL1                                                      01343000
         ORG   HLPECB+4                                                 01344000
SNDTCB   DS    A                                                        01345000
SNDECB   DS    FL4                                                      01346000
         ORG   SNDECB                                                   01347000
SWTCTL   DS    BL1                                                      01348000
         ORG   SNDECB+4                                                 01349000
ACCTLF   DS    AL2                                                      01350000
         ORG   ACCTLF                                                   01351000
SNDNOW   DS    BL1                                                      01352000
HLPNOW   EQU   ACCTLF+0                                                 01353000
STXSET   EQU   ACCTLF+0                                                 01354000
STASET   EQU   ACCTLF+0                                                 01355000
ERRTN    EQU   ACCTLF+0                                                 01356000
         ORG   ERRTN                                                    01357000
PLFAIL   EQU   ERRTN+0                                                  01358000
PGFAIL   EQU   ERRTN+0                                                  01359000
GENERR   EQU   ERRTN+0                                                  01360000
         ORG   ACCTLF+0                                                 01361000
STANOW   EQU   ACCTLF+0                                                 01362000
         DS    CL1                                                      01363000
ATNCMD   DS    BL1                                                      01364000
         ORG   ACCTLF+2                                                 01365000
         DS    CL2                                                      01366000
ACCTPL   DS    CL20                                                     01367000
         ORG   ACCTPL                                                   01368000
BASUPTP  DS    AL4                                                      01369000
BASECTP  DS    AL4                                                      01370000
ACCTECBP DS    AL4                                                      01371000
BUFPTR   DS    AL4                                                      01372000
UIDLPTR  DS    AL4                                                      01373000
         ORG   ACCTPL+20                                                01374000
CSOA1    DS    CL8                                                      01375000
CSPL1    DS    CL24                                                     01376000
DAPB2C1  DS    CL16                                                     01377000
DAPL1    DS    CL20                                                     01378000
IOPL1    DS    CL16                                                     01379000
STPL1    DS    CL16                                                     01380000
CSFLGWD  DS    BL4                                                      01381000
CMDID    DS    CL8                                                      01382000
         ORG   CMDID                                                    01383000
@NM00019 DS    CL6                                                      01384000
CMDNU    DS    CL1                                                      01385000
@NM00020 DS    CL1                                                      01386000
         ORG   CMDID+8                                                  01387000
SAVEARA  DS    CL72                                                     01388000
HLPPPL   DS    CL16                                                     01389000
         ORG   HLPPPL                                                   01390000
HLPCBUF  DS    AL4                                                      01391000
@NM00022 DS    3A                                                       01392000
         ORG   HLPPPL+16                                                01393000
SNDPPL   DS    CL24                                                     01394000
         ORG   SNDPPL                                                   01395000
@NM00023 DS    4A                                                       01396000
SPLUDL   DS    AL4                                                      01397000
SPLECB   DS    AL4                                                      01398000
         ORG   SNDPPL+24                                                01399000
DAIRFPPL DS    CL20                                                     01400000
         ORG   DAIRFPPL                                                 01401000
DAPLPTR  DS    AL4                                                      01402000
DARCPTR  DS    AL4                                                      01403000
DAWRENT  DS    AL4                                                      01404000
DAIDENT  DS    AL4                                                      01405000
@NM00024 DS    AL4                                                      01406000
         ORG   DAIRFPPL+20                                              01407000
TMSGMDS  DS    CL8                                                      01408000
         ORG   TMSGMDS                                                  01409000
@NM00025 DS    2A                                                       01410000
         ORG   TMSGMDS+8                                                01411000
TMSGNS1  DS    CL40                                                     01412000
         ORG   TMSGNS1                                                  01413000
TMSGNPTR DS    AL4                                                      01414000
TMSGNNO1 DS    AL4                                                      01415000
@NM00026 DS    AL4                                                      01416000
TMSGNP12 DS    AL4                                                      01417000
@NM00027 DS    6A                                                       01418000
         ORG   TMSGNS1+40                                               01419000
TMSGNS2  DS    CL40                                                     01420000
         ORG   TMSGNS2                                                  01421000
@NM00028 DS    3A                                                       01422000
TMSGNP22 DS    AL4                                                      01423000
TMSGNP23 DS    AL4                                                      01424000
@NM00029 DS    5A                                                       01425000
         ORG   TMSGNS2+40                                               01426000
TMSGTIX1 DS    CL44                                                     01427000
         ORG   TMSGTIX1                                                 01428000
TMSGTIL1 DS    AL2                                                      01429000
TMSGTIO1 DS    AL2                                                      01430000
TMSGTIN1 DS    CL40                                                     01431000
         ORG   TMSGTIX1+44                                              01432000
TMSGTIX2 DS    CL12                                                     01433000
         ORG   TMSGTIX2                                                 01434000
TMSGTIL2 DS    AL2                                                      01435000
TMSGTIO2 DS    AL2                                                      01436000
TMSGTIN2 DS    CL8                                                      01437000
         ORG   TMSGTIX2+12                                              01438000
         DS    CL4                                                      01439000
DBLWORD  DS    CL8                                                      01440000
FREEUID  DS    2A                                                       01441000
IKJEFA00 CSECT                                                          01442000
         DS    0F                                                       01443000
@SIZDATD DC    AL1(1)                                                   01444000
         DC    AL3(@ENDDATD-@DATD)                                      01445000
@CV00165 DC    V(ANDXL)                                                 01446000
         DS    0D                                                       01447000
ZERO     DC    A(0)                                                     01448000
IDENT    DC    AL2(1)                                                   01449000
@CB00329 DC    X'002C0000'                                              01450000
ACCDEF   DC    CL8'ACCOUNT'                                             01451000
ADDDEF   DC    CL8'ADD'                                                 01452000
CHGDEF   DC    CL8'CHANGE'                                              01453000
DELDEF   DC    CL8'DELETE'                                              01454000
ENDDEF   DC    CL8'END'                                                 01455000
HLPDEF   DC    CL8'HELP'                                                01456000
LSTDEF   DC    CL8'LIST'                                                01457000
LSTIDEF  DC    CL8'LISTIDS'                                             01458000
SNDDEF   DC    CL8'SEND'                                                01459000
SYNDEF   DC    CL8'SYNC'                                                01460000
CMDIDMDL DC    CL8'IKJEFA00'                                            01461000
HEXTBL   DC    CL16'0123456789ABCDEF'                                   01462000
@DATD    DSECT                                                          01463000
IKJEFA00 CSECT                                                          01464000
MCPLS    DS    0F                                                       01465000
         ATTACH   EP=HELP,STAI=(STAEXIN),PURGE=NONE,SHSPV=78,SF=L       01466000
         ATTACH   EP=IKJEES40,STAI=(STAEXIN),PURGE=NONE,SHSPV=78,SF=L   01467000
         FREEMAIN V,SP=1,MF=L                                           01468000
         LINK     ,SF=L                            FOR DYNAMIC LINKING  01469000
         PUTGET   OUTPUT=(0,SINGLE,ATTN),MF=L      FOR PUTGET ATTEN.    01470000
         PUTGET   OUTPUT=(0,SINGLE,MODE),MF=L      FOR PUTGET MODE MSG  01471000
         PUTLINE  OUTPUT=(0,,MULTLVL),MF=L         FOR PUTLINE          01472000
         STACK    DELETE=ALL,MF=L                  TO CLEAR STACK       01473000
         STAE     STAEXIN,PURGE=NONE,MF=L          FOR ABEND EXIT       01474000
         STAX     STAXXIN,OBUF=(ACCDEF,7),MF=L FOR ATTEN.               01475000
MCPLLNG  DC    A(*-MCPLS)             LENGTH OF MODEL PARAMETER LISTS   01476000
@DATD    DSECT                        RE-ESTABLISH AUTOMATIC DSECT      01477000
CPLS     DS    0F                                                       01478000
HLPCPL   ATTACH  ,SF=L                FOR ATTACH OF HELP                01479000
SNDCPL   ATTACH  ,SF=L                FOR ATTACH OF SEND                01480000
FMLST    FREEMAIN  ,MF=L              FOR FREEMAIN                      01481000
LNKCPL   LINK     ,SF=L               FOR DYNAMIC LINKING               01482000
PGPBA    PUTGET   ,MF=L               FOR PUTGET ATTENTION              01483000
PGPBM    PUTGET   ,MF=L               FOR PUTGET MODE                   01484000
PLPB     PUTLINE  ,MF=L               FOR PUTLINE                       01485000
STACL1   STACK ,MF=L                  FOR STACK CALL TO DELETE ALL      01486000
STAEL    STAE  STAEXIN,MF=L           FOR ABEND EXIT                    01487000
STAXL    STAX  STAXXIN,MF=L           FOR ATTENTION EXIT                01488000
IKJEFA00 CSECT                                                          01489000
         DS   0H                                                        01490000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   01491000
@DATD    DSECT                                                          01492000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01493000
@ENDDATD EQU   *                                                        01494000
IKJEFA00 CSECT                                                          01495000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01496000
@01      EQU   01                                                       01497000
@02      EQU   02                                                       01498000
@03      EQU   03                                                       01499000
@04      EQU   04                                                       01500000
@05      EQU   05                                                       01501000
@06      EQU   06                                                       01502000
@07      EQU   07                                                       01503000
@08      EQU   08                                                       01504000
@09      EQU   09                                                       01505000
@10      EQU   10                                                       01506000
@11      EQU   11                                                       01507000
@12      EQU   12                                                       01508000
@13      EQU   13                                                       01509000
@14      EQU   14                                                       01510000
@15      EQU   15                                                       01511000
MSGPTR   EQU   @03                                                      01512000
MSGLNG   EQU   @02                                                      01513000
MOFFNO   EQU   @07                                                      01514000
MSGNO    EQU   @02                                                      01515000
STAXSAVE EQU   @07                                                      01516000
STAESAVE EQU   @04                                                      01517000
TSTLNG   EQU   @02                                                      01518000
STPLPTR  EQU   @07                                                      01519000
IOPLPTR  EQU   @06                                                      01520000
ECTPTR   EQU   @05                                                      01521000
CSPLPTR  EQU   @08                                                      01522000
CSOAPTR  EQU   @04                                                      01523000
CPPLPTR  EQU   @02                                                      01524000
R1       EQU   @01                                                      01525000
R2       EQU   @02                                                      01526000
R13      EQU   @13                                                      01527000
R15      EQU   @15                                                      01528000
R12      EQU   @12                                                      01529000
CPPL     EQU   0                                                        01530000
CPPLCBUF EQU   CPPL                                                     01531000
CPPLUPT  EQU   CPPL+4                                                   01532000
CPPLPSCB EQU   CPPL+8                                                   01533000
CPPLECT  EQU   CPPL+12                                                  01534000
CSOA     EQU   0                                                        01535000
CSOACNM  EQU   CSOA                                                     01536000
CSOALNM  EQU   CSOA+4                                                   01537000
CSOAFLG  EQU   CSOA+6                                                   01538000
CSOANOC  EQU   CSOAFLG                                                  01539000
CSOABAD  EQU   CSOAFLG                                                  01540000
CSPL     EQU   0                                                        01541000
CSPLFLG  EQU   CSPL+12                                                  01542000
CSPLOA   EQU   CSPL+16                                                  01543000
CSPLCBUF EQU   CSPL+20                                                  01544000
DAPL     EQU   0                                                        01545000
DAPLPSCB EQU   DAPL+12                                                  01546000
DAPLDAPB EQU   DAPL+16                                                  01547000
DAPB2C   EQU   0                                                        01548000
DA2CTCB  EQU   DAPB2C+4                                                 01549000
ECT      EQU   0                                                        01550000
ECTRCDF  EQU   ECT                                                      01551000
ECTRTCD  EQU   ECT+1                                                    01552000
ECTMSGF  EQU   ECT+8                                                    01553000
ECTPCMD  EQU   ECT+12                                                   01554000
ECTSCMD  EQU   ECT+20                                                   01555000
ECTSWS   EQU   ECT+28                                                   01556000
ECTNOPD  EQU   ECTSWS                                                   01557000
ECTATRM  EQU   ECTSWS                                                   01558000
ECTBKGRD EQU   ECTSWS                                                   01559000
IOPL     EQU   0                                                        01560000
IOPLIOPB EQU   IOPL+12                                                  01561000
PGPB     EQU   0                                                        01562000
PGPBIBUF EQU   PGPB+12                                                  01563000
PSCB     EQU   0                                                        01564000
PSCBUSER EQU   PSCB                                                     01565000
PSCBUSRL EQU   PSCB+7                                                   01566000
PSCBATR1 EQU   PSCB+16                                                  01567000
PSCBACCT EQU   PSCBATR1                                                 01568000
PTPB     EQU   0                                                        01569000
PTPBOPUT EQU   PTPB+4                                                   01570000
STPL     EQU   0                                                        01571000
STPLSTPB EQU   STPL+12                                                  01572000
DUIDL    EQU   0                                                        01573000
UIDLNEX  EQU   DUIDL                                                    01574000
UIDLSWS  EQU   DUIDL+4                                                  01575000
UIDLCT   EQU   DUIDL+6                                                  01576000
CMDLOC   EQU   0                                                        01577000
@NM00018 EQU   0                                                        01578000
ICBFLN   EQU   @NM00018                                                 01579000
ICBFOF   EQU   @NM00018+2                                               01580000
ICBFDA   EQU   @NM00018+4                                               01581000
INPLEN   EQU   0                                                        01582000
STAEWA   EQU   0                                                        01583000
STAUSR13 EQU   STAEWA                                                   01584000
SABND    EQU   STAEWA+4                                                 01585000
STAXWA   EQU   0                                                        01586000
STXUSR13 EQU   STAXWA+8                                                 01587000
MOFFNC   EQU   0                                                        01588000
MSGMODL1 EQU   0                                                        01589000
MODX1    EQU   MSGMODL1                                                 01590000
SEG1     EQU   MSGMODL1+4                                               01591000
MSGMODL2 EQU   0                                                        01592000
SEG2     EQU   MSGMODL2+4                                               01593000
DAPB2PTR EQU   DAPLDAPB                                                 01594000
PGPBPTR  EQU   IOPLIOPB                                                 01595000
PSCBPTR  EQU   CPPLPSCB                                                 01596000
PTPBPTR  EQU   IOPLIOPB                                                 01597000
ATTNBUFP EQU   PGPBA+12                                                 01598000
ECTMSG1  EQU   ECTMSGF                                                  01599000
PGPBOBUF EQU   PGPBM+4                                                  01600000
ABENDCD  EQU   RTNCODE+1                                                01601000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01602000
@NM00030 EQU   MSGMODL2                                                 01603000
@NM00021 EQU   STAXWA                                                   01604000
UIDUSER  EQU   DUIDL+8                                                  01605000
@NM00015 EQU   UIDLSWS                                                  01606000
UIDCHG   EQU   UIDLSWS                                                  01607000
UIDDEL   EQU   UIDLSWS                                                  01608000
UIDADD   EQU   UIDLSWS                                                  01609000
STPLECB  EQU   STPL+8                                                   01610000
STPLECT  EQU   STPL+4                                                   01611000
STPLUPT  EQU   STPL                                                     01612000
PTPBFLN  EQU   PTPB+8                                                   01613000
@NM00014 EQU   PTPB                                                     01614000
PSCBU    EQU   PSCB+64                                                  01615000
PSCBRSZ  EQU   PSCB+60                                                  01616000
PSCBLINE EQU   PSCB+59                                                  01617000
PSCBCHAR EQU   PSCB+58                                                  01618000
PSCBUPTL EQU   PSCB+56                                                  01619000
PSCBUPT  EQU   PSCB+52                                                  01620000
PSCBRLGB EQU   PSCB+48                                                  01621000
PSCBDEST EQU   PSCB+40                                                  01622000
@NM00013 EQU   PSCB+36                                                  01623000
@NM00012 EQU   PSCB+32                                                  01624000
@NM00011 EQU   PSCB+28                                                  01625000
PSCBLTI2 EQU   PSCB+24                                                  01626000
PSCBLTIM EQU   PSCB+20                                                  01627000
PSCBATR2 EQU   PSCB+18                                                  01628000
@NM00010 EQU   PSCBATR1                                                 01629000
@NM00009 EQU   PSCBATR1                                                 01630000
@NM00008 EQU   PSCBATR1                                                 01631000
PSCBATTN EQU   PSCBATR1                                                 01632000
PSCBVMNT EQU   PSCBATR1                                                 01633000
PSCBJCL  EQU   PSCBATR1                                                 01634000
PSCBCTRL EQU   PSCBATR1                                                 01635000
PSCBGPNM EQU   PSCB+8                                                   01636000
@NM00007 EQU   PGPB                                                     01637000
IOPLECB  EQU   IOPL+8                                                   01638000
IOPLECT  EQU   IOPL+4                                                   01639000
IOPLUPT  EQU   IOPL                                                     01640000
ECTBKPB  EQU   ECT+36                                                   01641000
ECTUSER  EQU   ECT+32                                                   01642000
ECTDDNUM EQU   ECT+29                                                   01643000
@NM00006 EQU   ECTSWS                                                   01644000
ECTNNOT  EQU   ECTSWS                                                   01645000
ECTNMAL  EQU   ECTSWS                                                   01646000
ECTLOGF  EQU   ECTSWS                                                   01647000
@NM00005 EQU   ECTSWS                                                   01648000
ECTSMSG  EQU   ECT+9                                                    01649000
ECTIOWA  EQU   ECT+4                                                    01650000
DA2CDDN  EQU   DAPB2C+8                                                 01651000
DA2CFLG  EQU   DAPB2C+2                                                 01652000
DA2CCD   EQU   DAPB2C                                                   01653000
DAPLECB  EQU   DAPL+8                                                   01654000
DAPLECT  EQU   DAPL+4                                                   01655000
DAPLUPT  EQU   DAPL                                                     01656000
CSPLECB  EQU   CSPL+8                                                   01657000
CSPLECT  EQU   CSPL+4                                                   01658000
CSPLUPT  EQU   CSPL                                                     01659000
@NM00004 EQU   CSOA+7                                                   01660000
@NM00003 EQU   CSOAFLG                                                  01661000
@NM00002 EQU   CSOAFLG                                                  01662000
@NM00001 EQU   CSOAFLG                                                  01663000
CSOAQM   EQU   CSOAFLG                                                  01664000
CSOAVNP  EQU   CSOAFLG                                                  01665000
CSOAVWP  EQU   CSOAFLG                                                  01666000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01667000
@RT00099 EQU   NOSPAZ                                                   01668000
@RF00135 EQU   GETCMD                                                   01669000
@RT00150 EQU   DOEND                                                    01670000
@RT00183 EQU   NOSPAZ                                                   01671000
@RT00219 EQU   DOEND                                                    01672000
@RF00260 EQU   READY                                                    01673000
@RT00278 EQU   READY                                                    01674000
@RF00328 EQU   @EL00002                                                 01675000
@RF00344 EQU   @EL00004                                                 01676000
@RF00387 EQU   @RC00385                                                 01677000
@RT00422 EQU   STAXEND                                                  01678000
@PB00009 EQU   @EL00001                                                 01679000
@PB00008 EQU   @PB00009                                                 01680000
@PB00007 EQU   @PB00008                                                 01681000
@PB00006 EQU   @PB00007                                                 01682000
@PB00005 EQU   @PB00006                                                 01683000
@PB00004 EQU   @PB00005                                                 01684000
@PB00003 EQU   @PB00004                                                 01685000
@PB00002 EQU   @PB00003                                                 01686000
@ENDDATA EQU   *                                                        01687000
         END   IKJEFA00                                                 01688000
