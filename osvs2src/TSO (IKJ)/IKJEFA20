         TITLE 'IKJEFA20  --  CHANGE COMMAND PROCESSOR                 *00001000
                        '                                               00002000
IKJEFA20 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFA20  78.174'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
*         CTRLTAB = CTRLTAB&&CTRLTAB; /* CLEAR CONTROL TABLE         */ 00022000
         XC    CTRLTAB(40),CTRLTAB                                 0040 00023000
*         ACIOPARM = ACIOPARM&&ACIOPARM;/* CLEAR I/O PARM LIST       */ 00024000
         XC    ACIOPARM(24),ACIOPARM                               0041 00025000
*         ACCTPLP = R1;               /* ADDR OF ACCOUNT PARMLIST    */ 00026000
         ST    R1,ACCTPLP                                          0042 00027000
*         RFY R1 UNRSTD;              /* RELEASE CPPL POINTER        */ 00028000
*         DLSTTAB = DLSTTAB&&DLSTTAB; /* CLEAR DATALIST TABLE        */ 00029000
         XC    DLSTTAB(108),DLSTTAB                                0044 00030000
*         DATALPTR = ADDR(DLSTTAB);   /* SET PTR TO DATA LIST TABLE  */ 00031000
         LA    @10,DLSTTAB                                         0045 00032000
         ST    @10,DATALPTR                                        0045 00033000
*         CFLAGS = '0'B;              /* INITIALIZE CONTROL FLAGS    */ 00034000
         XC    CFLAGS+1(2),CFLAGS+1                                0046 00035000
         MVI   CFLAGS,B'00000000'                                  0046 00036000
*         MSGNO = 0;                  /* INIT MESSAGE NUMDER         */ 00037000
         SLR   MSGNO,MSGNO                                         0047 00038000
*         /* ASSIGN GENERATED PARAMETER BLOCKS TO DYNAMIC STORAGE    */ 00039000
*         CPLS(1:MCPLNG) = MCPLS(1:MCPLNG);                        0048 00040000
         L     @10,MCPLNG                                          0048 00041000
         BCTR  @10,0                                               0048 00042000
         EX    @10,@SM00429                                        0048 00043000
*         UADSDCB = UADSBLK;          /* INIT DYNAMIC DCB BLK - BSAM */ 00044000
         MVC   UADSDCB(88),UADSBLK                                 0049 00045000
*         /* BUILD THE PARAMETER LIST FOR 'PUTLINE'                  */ 00046000
*         PLPLIST(1:12) = ACCTPL(1:12);/* ADDR OF THE UPT, ECT & ECB */ 00047000
         L     @10,ACCTPLP                                         0050 00048000
         MVC   PLPLIST(12),ACCTPL(@10)                             0050 00049000
*         PBLKADR = ADDR(PBLOK);      /* ADDR OF THE PARM BLOCK      */ 00050000
         LA    @10,PBLOK                                           0051 00051000
         ST    @10,PBLKADR                                         0051 00052000
*         INSRTO1 = 10;               /* INIT FIRST SEGMENT LENGTH   */ 00053000
         LA    @10,10                                              0052 00054000
         STH   @10,INSRTO1                                         0052 00055000
*         INSRTO2 = 10;               /* INIT SECOND SEGMENT LENGTH  */ 00056000
         STH   @10,INSRTO2                                         0053 00057000
*         /***********************************************************/ 00058000
*         /*                                                         */ 00059000
*         /*            PARSING OF THE INPUT COMMAND                 */ 00060000
*         /*                                                         */ 00061000
*         /***********************************************************/ 00062000
*         NODELPTR = ADDR(NLSTTAB);   /* INSERT PTR TO NODELIST TAB  */ 00063000
         LA    @10,NLSTTAB                                         0054 00064000
         ST    @10,NODELPTR                                        0054 00065000
*         RFY R1 RSTD;                /* RESTRICT PARAMETER REG      */ 00066000
*         R1 = ADDR(CTRLTAB);         /* PTR TO CHANGE CNTRL TABLE   */ 00067000
         LA    R1,CTRLTAB                                          0056 00068000
*         /* PASS CONTROL TO THE CHANGE/PARSE INTERFACE ROUTINE.     */ 00069000
*         CALL IKJEFA24;                                           0057 00070000
         L     @15,@CV00148                                        0057 00071000
         BALR  @14,@15                                             0057 00072000
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REG       */ 00073000
*         /* CHECK WHETHER THE ECB WAS POSTED (ATTENTION INTERRUPT)  */ 00074000
*         /* WHILE IKJEFA24 WAS IN CONTROL.                          */ 00075000
*         IF ATTENTN = '1'B                                        0059 00076000
*           THEN                      /* YES,                        */ 00077000
         L     @10,ACCTPLP                                         0059 00078000
         L     @10,ACCTECBP(,@10)                                  0059 00079000
         TM    ATTENTN(@10),B'01000000'                            0059 00080000
         BO    @RT00059                                            0059 00081000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN TO THE    00082000
*                                        ACCOUNT COMMAND PROCESSOR   */ 00083000
*         /* CHECK THE RETURN CODE SET BY IKJEFA24. IF IT IS NOT     */ 00084000
*         /* ZERO, THEN ISSUE THE INDICATED ERROR MESSAGE.           */ 00085000
*         IF RETCODE ^= 0             /* SUCCESSFUL COMPLETION?      */ 00086000
*           THEN                      /* NO,                         */ 00087000
         L     @10,RETCODE                                         0061 00088000
         LTR   @10,@10                                             0061 00089000
         BZ    @RF00061                                            0061 00090000
*             DO;                                                  0062 00091000
*             /* PARSE RETURN CODE = 4 OR 8?                         */ 00092000
*             IF RETCODE = 4          /* UNABLE TO PROMPT            */ 00093000
*              | RETCODE = 8          /* ATTENTION INTERUPT          */ 00094000
*               THEN                  /* YES,                        */ 00095000
         C     @10,@CF00049                                        0063 00096000
         BE    @RT00063                                            0063 00097000
         C     @10,@CF00040                                        0063 00098000
         BE    @RT00063                                            0063 00099000
*                 GOTO ACCTRET;       /* GO CLEAN UP & RETURN TO   0064 00100000
*                                        ACCOUNT                     */ 00101000
*             IF RETCODE = 16         /* GETMAIN FAILURE             */ 00102000
*               THEN                  /* YES,                        */ 00103000
         C     @10,@CF00042                                        0065 00104000
         BNE   @RF00065                                            0065 00105000
*                 DO;                                              0066 00106000
*                 MSGNO = 3;          /* SET ERROR MSG NUMBER        */ 00107000
         LA    MSGNO,3                                             0067 00108000
*                 GOTO TMSGA;         /* GO ISSUE THE MSG            */ 00109000
         B     TMSGA                                               0068 00110000
*                 END;                                             0069 00111000
*             MSGNO = 21;             /* SET MESSAGE NUMBER          */ 00112000
@RF00065 LA    MSGNO,21                                            0070 00113000
*             GOTO MLMSG;             /* GO CONSTRUCT THE MSG        */ 00114000
         B     MLMSG                                               0071 00115000
*             END;                                                 0072 00116000
*         /* CHECK THE MESSAGE NUMBER SET BY IKJEFA24. IF IT IS NOT  */ 00117000
*         /* ZERO, THEN ISSUE THE INDICATED ERROR MESSAGE.           */ 00118000
*         IF MSGNMBR ^= 0             /* SUCCESSFUL COMPLETION?      */ 00119000
*           THEN                      /* NO,                         */ 00120000
@RF00061 CLI   MSGNMBR,0                                           0073 00121000
         BE    @RF00073                                            0073 00122000
*             DO;                                                  0074 00123000
*             MSGNO = MSGNMBR;        /* SET ERROR MSG NUMBER        */ 00124000
         SLR   MSGNO,MSGNO                                         0075 00125000
         IC    MSGNO,MSGNMBR                                       0075 00126000
*             GOTO TMSGA;             /* GO ISSUE THE MSG            */ 00127000
         B     TMSGA                                               0076 00128000
*             END;                                                 0077 00129000
*         /***********************************************************/ 00130000
*         /*                                                         */ 00131000
*         /* PARSING OF THE INPUT COMMAND HAS BEEN COMPLETED.        */ 00132000
*         /* PROCESSING CONTINUES WITH THE SPECIFIED USERID OR       */ 00133000
*         /* WITH THE FIRST USERID IN THE UADS DIRECTORY IF THE      */ 00134000
*         /* NODELIST USERID IS AN ASTERISK.                         */ 00135000
*         /*                                                         */ 00136000
*         /***********************************************************/ 00137000
*         GEN (ENQ   ,MF=(E,UADENQ))                               0078 00138000
*           REFS(MAJNAME,MINNAME,UADENQ);                          0078 00139000
@RF00073 DS    0H                                                  0078 00140000
         ENQ   ,MF=(E,UADENQ)                                           00141000
*         ENQUAFLG = '1'B;            /* 1- UADS IS ENQ'ED           */ 00142000
         OI    ENQUAFLG,B'00000010'                                0079 00143000
*         /* PREPARE TO OPEN THE BPAM DCB.                           */ 00144000
*         RFY R2 RSTD;                /* RESTRICT DSECT POINTER      */ 00145000
*         GEN (USING IHADCB,R2)                                    0081 00146000
*           REFS(R2);                                              0081 00147000
         USING IHADCB,R2                                                00148000
*         /* ESTABLISH ADDRESSABILITY FOR DCB LABELS.                */ 00149000
*         R2 = ADDR(UADDCB2);         /* SET BASE PTR FOR LABLES     */ 00150000
         LA    R2,UADDCB2                                          0082 00151000
*         GEN (OPEN  ((R2),UPDAT),MF=(E,OPENUAD))                  0083 00152000
*           REFS(R2,OPENUAD);                                      0083 00153000
         OPEN  ((R2),UPDAT),MF=(E,OPENUAD)                              00154000
*         /* IF 'OPEN' WAS NOT SUCCESSFUL, ISSUE AN ERROR MSG,       */ 00155000
*         /* TERMINATE AND RETURN TO ACCOUNT.                        */ 00156000
*         IF DCBOFLAG = '0'B          /* WAS 'OPEN' SUCCESSFUL?      */ 00157000
*           THEN                      /* NO,                         */ 00158000
         TM    DCBOFLAG,B'00010000'                                0084 00159000
         BNZ   @RF00084                                            0084 00160000
*             DO;                                                  0085 00161000
*               MSGNO = 16;           /* SET MSG NUMBER              */ 00162000
         LA    MSGNO,16                                            0086 00163000
*               GOTO TMSGA;           /* GO CONSTRUCT THE MSG        */ 00164000
         B     TMSGA                                               0087 00165000
*             END;                                                 0088 00166000
*         ACIOFLGS = '00'X;           /* SET ALL FLAGS TO ZERO       */ 00167000
@RF00084 MVI   ACIOFLGS,X'00'                                      0089 00168000
*         ACIODCBA = ADDR(UADDCB2);   /* ADDR OF THE BPAM DCB        */ 00169000
         LA    @10,UADDCB2                                         0090 00170000
         STCM  @10,7,ACIODCBA                                      0090 00171000
*         ACIOPUTL = ACCTPLP;         /* PTR TO ACCOUNT PARMLIST     */ 00172000
         MVC   ACIOPUTL(3),ACCTPLP+1                               0091 00173000
*         MSGID = '7';                /* CHANGE MSG ID - READ WILL 0092 00174000
*                                        ISSUE I/O ERROR MESSAGES    */ 00175000
         MVI   MSGID,C'7'                                          0092 00176000
*         /***********************************************************/ 00177000
*         /* DOES THE COMMAND NODELIST SPECIFY A USERID OR AN ASTER- */ 00178000
*         /* ISK? IF USERID, GET THE SPECIFIED USERID TREE BY CALL-  */ 00179000
*         /* ING THE 'READ' ROUTINE (IKJEFA51). IF ASTERISK, OPEN    */ 00180000
*         /* THE BSAM DCB & PROVIDE THE READ RTNE WITH A DIRECTORY   */ 00181000
*         /* WORK AREA. THE READ RTNE WILL PROCESS THE DIRECTORY &   */ 00182000
*         /* READ ONE USERID TREE AT A TIME INTO A TREE BUFFER.      */ 00183000
*         /***********************************************************/ 00184000
*         IF USRID(1) ^= '*'          /* IS A USERID SPECIFIED IN  0093 00185000
*                                        THE NODELIST?               */ 00186000
*           THEN                      /* YES                         */ 00187000
         CLI   USRID,C'*'                                          0093 00188000
         BE    @RF00093                                            0093 00189000
*             DO;                                                  0094 00190000
*             USIND = '0'B;           /* SET INDICATOR TO 0: NO MORE    00191000
*                                        USERIDS TO BE PROCESSED     */ 00192000
         NI    USIND,B'01111111'                                   0095 00193000
*             ACIOMPTR = ADDR(USRID); /* SET PTR TO THE USERID       */ 00194000
         LA    @10,USRID                                           0096 00195000
         ST    @10,ACIOMPTR                                        0096 00196000
*             USRID(USRLEN+1) = '0';  /* SET INDEX LEVEL             */ 00197000
         SLR   @10,@10                                             0097 00198000
         IC    @10,USRLEN                                          0097 00199000
         LA    @05,USRID(@10)                                      0097 00200000
         MVI   0(@05),C'0'                                         0097 00201000
*             GOTO READ;              /* GET THE SPECIFIED USERID  0098 00202000
*                                        TREE FROM THE UADS          */ 00203000
         B     READ                                                0098 00204000
*             END;                                                 0099 00205000
*         /* PREPARE TO OPEN THE BSAM DCB.                           */ 00206000
*         R2 = ADDR(UADSDCB);         /* SET BASE PTR FOR LABELS     */ 00207000
@RF00093 LA    R2,UADSDCB                                          0100 00208000
*         GEN (OPEN  ((R2),(INPUT)),MF=(E,OPENUAD))                0101 00209000
*           REFS(R2,OPENUAD);                                      0101 00210000
         OPEN  ((R2),(INPUT)),MF=(E,OPENUAD)                            00211000
*         /* IF 'OPEN' WAS NOT SUCCESSFUL, ISSUE AN ERROR MESSAGE,   */ 00212000
*         /* TERMINATE 'CHANGE' AND RETURN TO 'ACCOUNT'.             */ 00213000
*         IF DCBOFLAG = '0'B          /* WAS 'OPEN' SUCCESSFUL?      */ 00214000
*           THEN                      /* NO,                         */ 00215000
         TM    DCBOFLAG,B'00010000'                                0102 00216000
         BNZ   @RF00102                                            0102 00217000
*             DO;                                                  0103 00218000
*               MSGNO = 16;           /* SET MSG NUMBER              */ 00219000
         LA    MSGNO,16                                            0104 00220000
*               GOTO TMSGA;           /* GO CONSTRUCT THE MSG        */ 00221000
         B     TMSGA                                               0105 00222000
*             END;                                                 0106 00223000
*         RFY R2 UNRSTD;              /* RELEASE DCB POINTERS        */ 00224000
@RF00102 DS    0H                                                  0108 00225000
*         /* THE NODELIST USERID = '*', THEN ACIOMPTR IN THE PARMLIST*/ 00226000
*         /* POINTS TO A MEMBER NAME IN THE DIRECTORY WORK AREA.     */ 00227000
*         ACIOMPTR = 0;               /* SET MEMBER NAME PTR TO 0    */ 00228000
         SLR   @10,@10                                             0108 00229000
         ST    @10,ACIOMPTR                                        0108 00230000
*         USIND = '1'B;               /* MORE USERS TO BE PROCESSED  */ 00231000
         OI    USIND,B'10000000'                                   0109 00232000
*         ACIOFL03 = '1'B;            /* DIRECTORY READ REQUESTED    */ 00233000
         OI    ACIOFL03,B'00100000'                                0110 00234000
*         ACIODRCT = ADDR(DIRYWA);    /* SET PTR TO DIRECTRY W/A     */ 00235000
         LA    @10,DIRYWA                                          0111 00236000
         ST    @10,ACIODRCT                                        0111 00237000
*         GOTO READ;                  /* READ THE DIRECTORY & FIRST     00238000
*                                        USERID                      */ 00239000
         B     READ                                                0112 00240000
*MORUS:   /* BEFORE REQUESTING A USERID TREE, CHECK WHETHER THE      */ 00241000
*         /* BUFFER FOR A PREVIOUSLY USED TREE HAS TO BE FREED.      */ 00242000
*         IF FREEFLG = '1'B                                        0113 00243000
*           THEN                      /* YES, BUFFER MUST BE FREED   */ 00244000
MORUS    TM    FREEFLG,B'00000001'                                 0113 00245000
         BNO   @RF00113                                            0113 00246000
*             DO;                                                  0114 00247000
*               ACIOFL05='0'B;        /* DO NOT WRITE BLOCK          */ 00248000
         NI    ACIOFL05,B'11110111'                                0115 00249000
*               RFY R1 RSTD;          /* RESTRICT PARAMETER REG      */ 00250000
*               R1 = ADDR(ACIOPARM);  /* PTR TO READ/WRITE PARMLIST  */ 00251000
         LA    R1,ACIOPARM                                         0117 00252000
*               /* PASS CONTROL TO THE WRITE RTNE TO DO THE FREEMAIN */ 00253000
*               CALL IKJEFA52;                                     0118 00254000
         L     @15,@CV00150                                        0118 00255000
         BALR  @14,@15                                             0118 00256000
*               RFY R1 UNRSTD;        /* RELEASE PARAMETER REG       */ 00257000
*               FREEFLG = '0'B;       /* SET FLAG TO 0- BUFFER FREED */ 00258000
         NI    FREEFLG,B'11111110'                                 0120 00259000
*             END;                                                 0121 00260000
*         /* CHECK FOR MORE USERIDS TO BE PROCESSED.                 */ 00261000
*         IF USIND = '0'B                                          0122 00262000
*           THEN                      /* ARE THERE MORE USERIDS?     */ 00263000
@RF00113 TM    USIND,B'10000000'                                   0122 00264000
         BZ    @RT00122                                            0122 00265000
*             GOTO CHKCHNG;           /* NO                          */ 00266000
*         /* CHECK WHETHER THE ECB WAS POSTED (ATTENTION INTERRUPT)  */ 00267000
*READ:    IF ATTENTN = '1'B                                        0124 00268000
*           THEN                      /* YES,                        */ 00269000
READ     L     @10,ACCTPLP                                         0124 00270000
         L     @10,ACCTECBP(,@10)                                  0124 00271000
         TM    ATTENTN(@10),B'01000000'                            0124 00272000
         BO    @RT00124                                            0124 00273000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN TO THE    00274000
*                                        ACCOUNT COMMAND PROCESSOR   */ 00275000
*         /* PREPARE TO CALL THE READ ROUTINE                        */ 00276000
*         RFY R1 RSTD;                /* RESTRICT PARAMETER REG      */ 00277000
*         R1 = ADDR(ACIOPARM);        /* 'READ' EXPECTS THE ADDRESS     00278000
*                                        OF THE PARMLIST IN REG1     */ 00279000
         LA    R1,ACIOPARM                                         0127 00280000
*         CALL  IKJEFA51;                                          0128 00281000
         L     @15,@CV00149                                        0128 00282000
         BALR  @14,@15                                             0128 00283000
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REG       */ 00284000
*         RFY R15 RSTD;               /* RESTRICT RETURN CODE REG    */ 00285000
*         RETCODE = R15;              /* ASSIGN THE RETURN CODE      */ 00286000
         ST    R15,RETCODE                                         0131 00287000
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */ 00288000
*         IF USIND = '1'B &           /* IF USERID IS '*' AND        */ 00289000
*           ACIOLINK ^= 0             /*   ACIOLINK HAS BEEN SET     */ 00290000
*           THEN                                                   0133 00291000
         TM    USIND,B'10000000'                                   0133 00292000
         BNO   @RF00133                                            0133 00293000
         L     @10,ACIOLINK                                        0133 00294000
         LTR   @10,@10                                             0133 00295000
         BZ    @RF00133                                            0133 00296000
*             DO;                                                  0134 00297000
*             USRID = MEMNAME;        /* GET NAME FROM BLDL LIST     */ 00298000
         MVC   USRID(8),MEMNAME(@10)                               0135 00299000
*             USRLEN = 8;             /* GET MAXIMUM LENGTH OF USERID*/ 00300000
         MVI   USRLEN,X'08'                                        0136 00301000
*             DO WHILE USRID(USRLEN) = ' '; /* IS CHAR A BLANK       */ 00302000
         B     @DE00137                                            0137 00303000
@DL00137 DS    0H                                                  0138 00304000
*               USRLEN = USRLEN-1;    /* DECREMENT USERID LENGTH     */ 00305000
         SLR   @10,@10                                             0138 00306000
         IC    @10,USRLEN                                          0138 00307000
         BCTR  @10,0                                               0138 00308000
         STC   @10,USRLEN                                          0138 00309000
*               END;                                               0139 00310000
@DE00137 SLR   @10,@10                                             0139 00311000
         IC    @10,USRLEN                                          0139 00312000
         LA    @05,USRID-1(@10)                                    0139 00313000
         CLI   0(@05),C' '                                         0139 00314000
         BE    @DL00137                                            0139 00315000
*             USRLEN = USRLEN-1;      /* DECREMENT FOR SEQ. CHAR     */ 00316000
         BCTR  @10,0                                               0140 00317000
         STC   @10,USRLEN                                          0140 00318000
*             END;                                                 0141 00319000
*         /* CHECK THE READ RETURN CODE.                             */ 00320000
*         IF RETCODE ^= 0             /* WAS READ SUCCESSFUL?        */ 00321000
*           THEN                      /* NO,                         */ 00322000
@RF00133 L     @10,RETCODE                                         0142 00323000
         LTR   @10,@10                                             0142 00324000
         BZ    @RF00142                                            0142 00325000
*             DO;                                                  0143 00326000
*             IF RETCODE = 4          /* SPECIFIED USERID NOT FOUND? */ 00327000
*               THEN                  /* YES,                        */ 00328000
         C     @10,@CF00049                                        0144 00329000
         BNE   @RF00144                                            0144 00330000
*                 DO;                                              0145 00331000
*                 MSGNO = 9;          /* SET MSG NUMBER              */ 00332000
         LA    MSGNO,9                                             0146 00333000
*                 GOTO MPREP2;        /* GO CONSTRUCT THE MSG        */ 00334000
         B     MPREP2                                              0147 00335000
*                 END;                                             0148 00336000
*             IF RETCODE = 8          /* BLDL I/O ERROR?             */ 00337000
*               THEN                  /* YES,                        */ 00338000
@RF00144 CLC   RETCODE(4),@CF00040                                 0149 00339000
         BNE   @RF00149                                            0149 00340000
*                 DO;                                              0150 00341000
*                 MSGNO = 17;         /* SET MSG NUMBER              */ 00342000
         LA    MSGNO,17                                            0151 00343000
*                 GOTO MLMSG;         /* GO CONSTRUCT THE MSG        */ 00344000
         B     MLMSG                                               0152 00345000
*                 END;                                             0153 00346000
*             IF RETCODE = 12         /* GETMAIN FAILURE?            */ 00347000
*               THEN                  /* YES,                        */ 00348000
@RF00149 L     @10,RETCODE                                         0154 00349000
         C     @10,@CF00350                                        0154 00350000
         BE    @RT00154                                            0154 00351000
*                 GOTO MSG3;          /* GO CONSTRUCT THE MSG        */ 00352000
*             IF RETCODE = 20         /* I/O ERR, MSG ISSUED?        */ 00353000
*               THEN                  /* YES,                        */ 00354000
         C     @10,@CF00070                                        0156 00355000
         BE    @RT00156                                            0156 00356000
*                 GOTO ACCTRET;       /* GO CLEAN UP AND RETURN      */ 00357000
*             IF RETCODE = 24         /* END OF THE DIRECTORY?       */ 00358000
*               THEN                  /* YES,                        */ 00359000
         C     @10,@CF00077                                        0158 00360000
         BE    @RT00158                                            0158 00361000
*                 GOTO CHKCHNG;       /* GO SET INDICATORS & RETURN  */ 00362000
*               ELSE                  /* I/O ERROR - THE READ RTNE 0160 00363000
*                                        WAS NOT ABLE TO ISSUE THE 0160 00364000
*                                        I/O ERROR MESSAGE           */ 00365000
*                 MSGNO = 25;         /* SET MSG NUMBER              */ 00366000
         LA    MSGNO,25                                            0160 00367000
*                 GOTO MLMSG;         /* GO CONSTRUCT THE MSG        */ 00368000
         B     MLMSG                                               0161 00369000
*         END;                                                     0162 00370000
*         /* A USERID TREE IS NOW IN WORKING STORAGE.                */ 00371000
*         SRCHFLG = '0'B;             /* RE-INIT THE SEARCH FLAG     */ 00372000
@RF00142 NI    SRCHFLG,B'11110111'                                 0163 00373000
*         FREEFLG = '1'B;             /* SET FREEMAIN FLAG           */ 00374000
         OI    FREEFLG,B'00000001'                                 0164 00375000
*         STGFLG = '0'B;              /* INIT 'SIZE>MAXSIZE' FLAG    */ 00376000
         NI    STGFLG,B'11101111'                                  0165 00377000
*         TRCHGE = '0'B;              /* INIT 'CHANGED TREE' INDIC.  */ 00378000
         NI    TRCHGE,B'01111111'                                  0166 00379000
*         HEDBPTR = ACIOBUFR;         /* ADDR OF THE BUFFER INTO WHICH  00380000
*                                        THE USERID TREE WAS READ    */ 00381000
         L     HEDBPTR,ACIOBUFR-1                                  0167 00382000
         LA    HEDBPTR,0(,HEDBPTR)                                 0167 00383000
*         /* DOES THE COMMAND SPECIFY USER HEADER DATA ITEMS? IF SO, */ 00384000
*         /* CHANGE THE SPECIFIED ITEMS IN THE USER HEADER.          */ 00385000
*         IF OPERKEY(16) = '1'B       /* IS 'OPER' SPECIFIED?        */ 00386000
*           THEN                      /* YES,                        */ 00387000
         L     @10,CHPDLPTR                                        0168 00388000
         TM    OPERKEY+1(@10),B'00000001'                          0168 00389000
         BNO   @RF00168                                            0168 00390000
*             USATR00 = '1'B;         /* SET BIT TO 1 - OPER         */ 00391000
         OI    USATR00(HEDBPTR),B'10000000'                        0169 00392000
*           ELSE                      /* NO,                         */ 00393000
*             IF OPERKEY(15) = '1'B   /* IS 'NOOPER' SPECIFIED?      */ 00394000
*               THEN                  /* YES,                        */ 00395000
         B     @RC00168                                            0170 00396000
@RF00168 L     @10,CHPDLPTR                                        0170 00397000
         TM    OPERKEY+1(@10),B'00000010'                          0170 00398000
         BNO   @RF00170                                            0170 00399000
*                 USATR00 = '0'B;     /* SET BIT TO 0 - NOOPER       */ 00400000
         NI    USATR00(HEDBPTR),B'01111111'                        0171 00401000
*         IF ACCTKEY(16) = '1'B       /* IS 'ACCT' SPECIFIED?        */ 00402000
*           THEN                      /* YES,                        */ 00403000
@RF00170 DS    0H                                                  0172 00404000
@RC00168 L     @10,CHPDLPTR                                        0172 00405000
         TM    ACCTKEY+1(@10),B'00000001'                          0172 00406000
         BNO   @RF00172                                            0172 00407000
*             USATR01 = '1'B;         /* SET BIT TO 1 - ACCT         */ 00408000
         OI    USATR01(HEDBPTR),B'01000000'                        0173 00409000
*           ELSE                      /* NO,                         */ 00410000
*             IF ACCTKEY(15) = '1'B   /* IS 'NOACCT' SPECIFIED?      */ 00411000
*               THEN                  /* YES,                        */ 00412000
         B     @RC00172                                            0174 00413000
@RF00172 L     @10,CHPDLPTR                                        0174 00414000
         TM    ACCTKEY+1(@10),B'00000010'                          0174 00415000
         BNO   @RF00174                                            0174 00416000
*                 USATR01 = '0'B;     /* SET BIT TO 0 - NOACCT       */ 00417000
         NI    USATR01(HEDBPTR),B'10111111'                        0175 00418000
*         IF JCLKEY(16) = '1'B        /* IS 'JCL' SPECIFIED?         */ 00419000
*           THEN                      /* YES,                        */ 00420000
@RF00174 DS    0H                                                  0176 00421000
@RC00172 L     @10,CHPDLPTR                                        0176 00422000
         TM    JCLKEY+1(@10),B'00000001'                           0176 00423000
         BNO   @RF00176                                            0176 00424000
*             USATR02 = '1'B;         /* SET BIT TO 1 - JCL          */ 00425000
         OI    USATR02(HEDBPTR),B'00100000'                        0177 00426000
*           ELSE                      /* NO,                         */ 00427000
*             IF JCLKEY(15) = '1'B    /* IS 'NOJCL' SPECIFIED?       */ 00428000
*               THEN                  /* YES,                        */ 00429000
         B     @RC00176                                            0178 00430000
@RF00176 L     @10,CHPDLPTR                                        0178 00431000
         TM    JCLKEY+1(@10),B'00000010'                           0178 00432000
         BNO   @RF00178                                            0178 00433000
*                 USATR02 = '0'B;     /* SET BIT TO 0 - NOJCL        */ 00434000
         NI    USATR02(HEDBPTR),B'11011111'                        0179 00435000
*         IF MONTKEY(16) = '1'B       /* IS 'MOUNT' SPECIFIED?       */ 00436000
*           THEN                      /* YES,                        */ 00437000
@RF00178 DS    0H                                                  0180 00438000
@RC00176 L     @10,CHPDLPTR                                        0180 00439000
         TM    MONTKEY+1(@10),B'00000001'                          0180 00440000
         BNO   @RF00180                                            0180 00441000
*             USATR03 = '1'B;         /* SET BIT TO 1 - MOUNT  Y02678*/ 00442000
         OI    USATR03(HEDBPTR),B'00010000'                        0181 00443000
*           ELSE                      /* NO,                         */ 00444000
*             IF MONTKEY(15) = '1'B   /* IS 'NOMOUNT' SPECIFIED?     */ 00445000
*               THEN                  /* YES,                        */ 00446000
         B     @RC00180                                            0182 00447000
@RF00180 L     @10,CHPDLPTR                                        0182 00448000
         TM    MONTKEY+1(@10),B'00000010'                          0182 00449000
         BNO   @RF00182                                            0182 00450000
*                 USATR03 = '0'B;     /* SET BIT TO 0 - NOMOUNTY02678*/ 00451000
         NI    USATR03(HEDBPTR),B'11101111'                        0183 00452000
*         IF USDAKEY(16)='1'B         /* IS USERDATA SPECIFIED?      */ 00453000
*           THEN                      /* YES,                        */ 00454000
@RF00182 DS    0H                                                  0184 00455000
@RC00180 L     @10,CHPDLPTR                                        0184 00456000
         TM    USDAKEY+1(@10),B'00000001'                          0184 00457000
         BNO   @RF00184                                            0184 00458000
*             UADSINST=USERDATA;      /* MOVE USERDATA INTO HEADER   */ 00459000
         MVC   UADSINST(2,HEDBPTR),USERDATA(@10)                   0185 00460000
*          IF DESTKEY(16)='1'B        /* WAS DESTINATION SPECIFIED?  */ 00461000
*            THEN                     /* YES,                        */ 00462000
@RF00184 L     @10,CHPDLPTR                                        0186 00463000
         TM    DESTKEY+1(@10),B'00000001'                          0186 00464000
         BNO   @RF00186                                            0186 00465000
*              DO;                    /* TEST FOR EXPANDED HEADER  0187 00466000
*                                                              Y02678*/ 00467000
*              IF UADSEXPF = '1'B     /* IS THIS A NEW HEADER?       */ 00468000
*                THEN                 /* YES,                        */ 00469000
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0188 00470000
         BNO   @RF00188                                            0188 00471000
*                  UADSDEST =         /* MOVE DESTINATION INTO       */ 00472000
*                    DEST(1:DESTLNG); /* HEADER BLOCK          Y02678*/ 00473000
         MVI   UADSDEST+1(HEDBPTR),C' '                            0189 00474000
         MVC   UADSDEST+2(6,HEDBPTR),UADSDEST+1(HEDBPTR)           0189 00475000
         LH    @05,DESTLNG(,@10)                                   0189 00476000
         BCTR  @05,0                                               0189 00477000
         L     @10,DESTADR(,@10)                                   0189 00478000
         EX    @05,@SM00443                                        0189 00479000
*                ELSE                 /* NO,                   Y02678*/ 00480000
*                  DO;                /* MEMBER IS OLD FORMAT  Y02678*/ 00481000
         B     @RC00188                                            0190 00482000
@RF00188 DS    0H                                                  0191 00483000
*                  MSGNO = 19;        /* INFORM USER           Y02678*/ 00484000
         LA    MSGNO,19                                            0191 00485000
*                  GOTO MPREP1;       /* GO TO ISSUE MESSAGE   Y02678*/ 00486000
         B     MPREP1                                              0192 00487000
*                  END;                                            0193 00488000
*              END;                                                0194 00489000
*            ELSE                                                  0195 00490000
*              IF DESTKEY(15)='1'B    /* WAS NODEST SPECIFIED?       */ 00491000
*                THEN                 /* YES,                        */ 00492000
         B     @RC00186                                            0195 00493000
@RF00186 L     @10,CHPDLPTR                                        0195 00494000
         TM    DESTKEY+1(@10),B'00000010'                          0195 00495000
         BNO   @RF00195                                            0195 00496000
*                  DO;                /* TEST FOR EXPANDED HEADER  0196 00497000
*                                                              Y02678*/ 00498000
*                  IF UADSEXPF = '1'B /* IS THIS A NEW HEADER?       */ 00499000
*                    THEN             /* YES,                        */ 00500000
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0197 00501000
         BNO   @RF00197                                            0197 00502000
*                      UADSDEST =     /* ZERO OUT DESTINATION  Y02678*/ 00503000
*                       '0000000000000000'X;                       0198 00504000
         MVC   UADSDEST(8,HEDBPTR),@CB00373                        0198 00505000
*                    ELSE             /* NO,                   Y02678*/ 00506000
*                      DO;            /* MEMBER IS OLD FORMAT  Y02678*/ 00507000
         B     @RC00197                                            0199 00508000
@RF00197 DS    0H                                                  0200 00509000
*                      MSGNO = 19;    /* INFORM USER           Y02678*/ 00510000
         LA    MSGNO,19                                            0200 00511000
*                      GOTO MPREP1;   /* GO TO ISSUE MESSAGE   Y02678*/ 00512000
         B     MPREP1                                              0201 00513000
*                      END;                                        0202 00514000
*                  END;                                            0203 00515000
@RC00197 DS    0H                                                  0204 00516000
*          IF PERFKEY(16)='1'B        /* WAS PERF GROUP SPECIFIED?   */ 00517000
*            THEN                     /* YES,                        */ 00518000
@RF00195 DS    0H                                                  0204 00519000
@RC00186 L     @10,CHPDLPTR                                        0204 00520000
         TM    PERFKEY+1(@10),B'00000001'                          0204 00521000
         BNO   @RF00204                                            0204 00522000
*              DO;                    /* TEST FOR EXPANDED HEADER  0205 00523000
*                                                              Y02678*/ 00524000
*              IF UADSEXPF = '1'B     /* IS THIS A NEW HEADER?       */ 00525000
*                THEN                 /* YES,                        */ 00526000
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0206 00527000
         BNO   @RF00206                                            0206 00528000
*                  DO;                /* MOVE PERF GROUPS TO MEMBER     00529000
*                                                              Y02678*/ 00530000
*                  IF UADSPERP = 0    /* DOES THIS USER HAVE PERF  0208 00531000
*                                        GROUPS                      */ 00532000
*                    THEN             /* NO,                   Y02678*/ 00533000
         L     @10,UADSPERP(,HEDBPTR)                              0208 00534000
         LTR   @10,@10                                             0208 00535000
         BNZ   @RF00208                                            0208 00536000
*                      DO;            /* GET SPACE IN UADS FOR PERF     00537000
*                                        GROUPS                Y02678*/ 00538000
*                      SPACMPTR = HEDBPTR;/* POINT TO BUFFER   Y02678*/ 00539000
         ST    HEDBPTR,SPACMPTR                                    0210 00540000
*                      SPACMCNT = ACIONMBR;/* GET NO. OF BLOCKSY02678*/ 00541000
         SLR   @10,@10                                             0211 00542000
         IC    @10,ACIONMBR                                        0211 00543000
         STH   @10,SPACMCNT                                        0211 00544000
*                      SPACLNTH = 32; /* SET LENGTH OF PERF GROUPS 0212 00545000
*                                                              Y02678*/ 00546000
         MVC   SPACLNTH(2),@CH00249                                0212 00547000
*                      RFY R1 RSTD;   /* RESTRICT PARM REG     Y02678*/ 00548000
*                      R1 = ADDR(SPACPARM);/* POINT TO GETSPACE PARM    00549000
*                                             LIST             Y02678*/ 00550000
         LA    R1,SPACPARM                                         0214 00551000
*                      CALL IKJEFA53; /* CALL GETSPACE         Y02678*/ 00552000
         L     @15,@CV00151                                        0215 00553000
         BALR  @14,@15                                             0215 00554000
*                      RFY R1 UNRSTD; /* RELEASE PARM REG      Y02678*/ 00555000
*                      RFY R15 RSTD;  /* RESTRICT RETURN REG   Y02678*/ 00556000
*                      RETCODE = R15; /* SAVE THE RETURN CODE  Y02678*/ 00557000
         ST    R15,RETCODE                                         0218 00558000
*                      RFY R15 UNRSTD;/* RELEASE RETURN REG    Y02678*/ 00559000
*                      IF RETCODE ^=0 /* WAS GETSPACE SUCCESSFUL?    */ 00560000
*                        THEN         /* NO,                         */ 00561000
         L     @10,RETCODE                                         0220 00562000
         LTR   @10,@10                                             0220 00563000
         BZ    @RF00220                                            0220 00564000
*                          DO;        /*                       Y02678*/ 00565000
*                          MSGNO = 23;/* SET ERROR MSG NO.     Y02678*/ 00566000
         LA    MSGNO,23                                            0222 00567000
*                          GOTO MPREP1;/* GO TO ISSUE MESSAGE  Y02678*/ 00568000
         B     MPREP1                                              0223 00569000
*                          END;       /*                       Y02678*/ 00570000
*                      UADSPERP = SPACOFST;/* SET POINTER TO PERF  0225 00571000
*                                             GROUPS IN UADS   Y02678*/ 00572000
@RF00220 L     @10,SPACOFST                                        0225 00573000
         ST    @10,UADSPERP(,HEDBPTR)                              0225 00574000
*                      END;                                        0226 00575000
*                  PERFPTR=           /* POINT TO PERFORMANCE  GROUP */ 00576000
*                    HEDBPTR+UADSPERP;/* IN MEMBER             Y02678*/ 00577000
@RF00208 LR    PERFPTR,HEDBPTR                                     0227 00578000
         AL    PERFPTR,UADSPERP(,HEDBPTR)                          0227 00579000
*                  UADSPERG=PERFGRP;  /* MOVE PERF GROUP TO MEMBER 0228 00580000
*                                          BLOCK               Y02678*/ 00581000
         MVC   UADSPERG(32,PERFPTR),PERFGRP                        0228 00582000
*                  END;                                            0229 00583000
*                ELSE                 /* NO,                   Y02678*/ 00584000
*                  DO;                /* MEMBER IS OLD FORMAT  Y02678*/ 00585000
         B     @RC00206                                            0230 00586000
@RF00206 DS    0H                                                  0231 00587000
*                  MSGNO = 20;        /* INFORM USER           Y02678*/ 00588000
         LA    MSGNO,20                                            0231 00589000
*                  GOTO MPREP1;       /* GO TO ISSUE MESSAGE   Y02678*/ 00590000
         B     MPREP1                                              0232 00591000
*                  END;                                            0233 00592000
*              END;                                                0234 00593000
@RC00206 DS    0H                                                  0235 00594000
*          IF PERFKEY(15)='1'B        /* WAS NOPERFORM SPECIFIED?    */ 00595000
*            THEN                     /* YES,                        */ 00596000
@RF00204 L     @10,CHPDLPTR                                        0235 00597000
         TM    PERFKEY+1(@10),B'00000010'                          0235 00598000
         BNO   @RF00235                                            0235 00599000
*              DO;                    /* TEST FOR EXPANDED HEADER  0236 00600000
*                                                              Y02678*/ 00601000
*              IF UADSEXPF = '1'B     /* IS THIS A NEW HEADER?       */ 00602000
*                THEN                 /* YES,                        */ 00603000
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0237 00604000
         BNO   @RF00237                                            0237 00605000
*                  DO;                /* CHECK FOR EXISTING GROUPS 0238 00606000
*                                                              Y02678*/ 00607000
*                  IF UADSPERP ^= 0   /* DOES THIS USER HAVE PERF  0239 00608000
*                                        GROUPS                      */ 00609000
*                    THEN             /* YES,                  Y02678*/ 00610000
         L     @10,UADSPERP(,HEDBPTR)                              0239 00611000
         LTR   @10,@10                                             0239 00612000
         BZ    @RF00239                                            0239 00613000
*                      DO;            /* FREE SPACE IN UADS FOR PERF    00614000
*                                        GROUPS                Y02678*/ 00615000
*                      SPACMPTR = HEDBPTR;/* POINT TO BUFFER   Y02678*/ 00616000
         ST    HEDBPTR,SPACMPTR                                    0241 00617000
*                      SPACMCNT = ACIONMBR;/* GET NO. OF BLOCKSY02678*/ 00618000
         SLR   @05,@05                                             0242 00619000
         IC    @05,ACIONMBR                                        0242 00620000
         STH   @05,SPACMCNT                                        0242 00621000
*                      SPACLNTH = 32; /* SET LENGTH OF PERF GROUPS 0243 00622000
*                                                              Y02678*/ 00623000
         MVC   SPACLNTH(2),@CH00249                                0243 00624000
*                      SPACOFST = UADSPERP;/* POINT TO PERF GROUP AREA  00625000
*                                                              Y02678*/ 00626000
         ST    @10,SPACOFST                                        0244 00627000
*                      RFY R1 RSTD;   /* RESTRICT PARM REG     Y02678*/ 00628000
*                      R1 = ADDR(SPACPARM);/* POINT TO GETSPACE PARM    00629000
*                                             LIST             Y02678*/ 00630000
         LA    R1,SPACPARM                                         0246 00631000
*                      CALL IKJEFA54; /* CALL FREESPACE        Y02678*/ 00632000
         L     @15,@CV00152                                        0247 00633000
         BALR  @14,@15                                             0247 00634000
*                      RFY R1 UNRSTD; /* RELEASE PARM REG      Y02678*/ 00635000
*                      RFY R15 RSTD;  /* RESTRICT RETURN REG   Y02678*/ 00636000
*                      RETCODE = R15; /* SAVE THE RETURN CODE  Y02678*/ 00637000
         ST    R15,RETCODE                                         0250 00638000
*                      RFY R15 UNRSTD;/* RELEASE RETURN REG    Y02678*/ 00639000
*                      IF RETCODE ^=0 /* WAS FREESPACE SUCCESSFUL?   */ 00640000
*                        THEN         /* NO,                         */ 00641000
         L     @10,RETCODE                                         0252 00642000
         LTR   @10,@10                                             0252 00643000
         BZ    @RF00252                                            0252 00644000
*                          DO;        /*                       Y02678*/ 00645000
*                          MSGNO = 24;/* SET ERROR MSG NO.     Y02678*/ 00646000
         LA    MSGNO,24                                            0254 00647000
*                          GOTO MLMSG;/* GO TO ISSUE MESSAGE   Y02678*/ 00648000
         B     MLMSG                                               0255 00649000
*                          END;       /*                       Y02678*/ 00650000
*                      UADSPERP = 0;  /* SET POINTER TO 0      Y02678*/ 00651000
@RF00252 SLR   @10,@10                                             0257 00652000
         ST    @10,UADSPERP(,HEDBPTR)                              0257 00653000
*                      END;                                        0258 00654000
*                  END;                                            0259 00655000
*                ELSE                 /* NO,                   Y02678*/ 00656000
*                  DO;                /* MEMBER IS OLD FORMAT  Y02678*/ 00657000
         B     @RC00237                                            0260 00658000
@RF00237 DS    0H                                                  0261 00659000
*                  MSGNO = 20;        /* INFORM USER           Y02678*/ 00660000
         LA    MSGNO,20                                            0261 00661000
*                  GOTO MPREP1;       /* GO TO ISSUE MESSAGE   Y02678*/ 00662000
         B     MPREP1                                              0262 00663000
*                  END;                                            0263 00664000
*              END;                                                0264 00665000
@RC00237 DS    0H                                                  0265 00666000
*         IF MAXSKEY(16) = '1'B       /* IS 'MAXSIZE' SPECIFIED?     */ 00667000
*           THEN                      /* YES,                        */ 00668000
@RF00235 L     @10,CHPDLPTR                                        0265 00669000
         TM    MAXSKEY+1(@10),B'00000001'                          0265 00670000
         BNO   @RF00265                                            0265 00671000
*             UADSMAXC = MAXSHEX;     /* PUT NEW MAXSIZE INTO HEADER */ 00672000
         LH    @10,MAXSHEX(,@10)                                   0266 00673000
         N     @10,@CF00445                                        0266 00674000
         STH   @10,UADSMAXC(,HEDBPTR)                              0266 00675000
*           ELSE                      /* NO,                         */ 00676000
*             IF MAXSKEY(15) = '1'B   /* IS 'NOLIM' SPECIFIED?       */ 00677000
*               THEN                  /* YES,                        */ 00678000
         B     @RC00265                                            0267 00679000
@RF00265 L     @10,CHPDLPTR                                        0267 00680000
         TM    MAXSKEY+1(@10),B'00000010'                          0267 00681000
         BNO   @RF00267                                            0267 00682000
*                 UADSMAXC = 0;       /* SET MAXSIZE TO 0 - NOLIM    */ 00683000
         SLR   @10,@10                                             0268 00684000
         STH   @10,UADSMAXC(,HEDBPTR)                              0268 00685000
*         IF CHLEVL = 1               /* IS CHANGE LEVEL THE USERID? */ 00686000
*           THEN                      /* YES,                        */ 00687000
@RF00267 DS    0H                                                  0269 00688000
@RC00265 CLI   CHLEVL,1                                            0269 00689000
         BE    @RT00269                                            0269 00690000
*             GOTO CHKMAX;            /* GO CHECK MAXSIZE VS PROCSIZE   00691000
*                                        BEFORE CHANGING THE USERID  */ 00692000
*         /***********************************************************/ 00693000
*         /* THIS SECTION WILL SEARCH FOR THE PASSWORD SPECIFIED IN  */ 00694000
*         /* THE NODELIST OF THE CHANGE COMMAND. IF NONE WAS SPECI-  */ 00695000
*         /* FIED ('*' IN THE PASSWORD POSITION), THEN THE CHANGE    */ 00696000
*         /* LEVEL (CHLEVL) WILL DETERMINE WHERE PROCESSING IS TO    */ 00697000
*         /* CONTINUE.                                               */ 00698000
*         /***********************************************************/ 00699000
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF THE 1ST PASSWORD OBLK 0271 00700000
*                                        UNDER THIS USERID           */ 00701000
         LR    DPOBPTR,HEDBPTR                                     0271 00702000
         AL    DPOBPTR,UADSPWD1(,HEDBPTR)                          0271 00703000
*         PASSADDR = DPOBPTR;         /* SAVE ADDRESS OF THIS OBLK   */ 00704000
         ST    DPOBPTR,PASSADDR                                    0272 00705000
*         /* ARE PASSWORDS SUPPORTED FOR THIS USER?                  */ 00706000
*         IF UADSPDAT ^= 0                                         0273 00707000
*           THEN                      /* NO,                         */ 00708000
         L     @10,UADSPDAT(,DPOBPTR)                              0273 00709000
         LTR   @10,@10                                             0273 00710000
         BNZ   @RT00273                                            0273 00711000
*             GOTO PWSPRT;            /* CONTINUE NORMALLY           */ 00712000
*         /* PASSWORDS ARE NOT SUPPORTED FOR THIS USER. IF THE     0275 00713000
*            CHANGE LEVEL IS THE PASSWORD LEVEL, THEN THE COMMAND  0275 00714000
*            IS INVALID FOR THIS USERID.                             */ 00715000
*         IF CHLEVL ^= 2              /* CHANGE LVL = PASSWD LVL?    */ 00716000
*           THEN                      /* NO,                         */ 00717000
         CLI   CHLEVL,2                                            0275 00718000
         BE    @RF00275                                            0275 00719000
*             DO;                                                  0276 00720000
*             /* PASSWORDS ARE NOT SUPPORTED, BUT THE CHANGE LEVEL 0277 00721000
*                IS NOT THE PASSWORD LEVEL. IF A PASSWORD IS       0277 00722000
*                SPECIFIED, CONTINUE THE SEARCH IN THE NEXT USERID 0277 00723000
*                TREE. IF NOT, CONTINUE AT THE ACCTNMBR LEVEL.       */ 00724000
*             IF PASSWD(1) = '*'                                   0277 00725000
*               THEN                  /* PASSWORD NOT SPECIFIED,     */ 00726000
         CLI   PASSWD,C'*'                                         0277 00727000
         BE    @RT00277                                            0277 00728000
*                 GOTO ACLEVL;        /* GO CONTINUE WITH ACCTNMBR   */ 00729000
*               ELSE                  /* PASSWORD SPECIFIED,         */ 00730000
*                 GOTO MORUS;         /* CONTINUE WITH NEXT USERID   */ 00731000
         B     MORUS                                               0279 00732000
*             END;                                                 0280 00733000
*         /* THE COMMAND IS INVALID FOR THIS USERID. IF THE        0281 00734000
*            NODELIST USERID = '*', PROCESSING CONTINUES WITH THE  0281 00735000
*            NEXT USRID. IF NOT, AN ERROR MESSAGE IS PUT OUT.        */ 00736000
*         IF USIND = '1'B                                          0281 00737000
*           THEN                      /* USERID IS NOT SPECIFIED     */ 00738000
@RF00275 TM    USIND,B'10000000'                                   0281 00739000
         BO    @RT00281                                            0281 00740000
*             GOTO MORUS;             /* CONTINUE WITH NEXT USERID   */ 00741000
*         MSGNO = 7;                  /* SET ERROR MESSAGE NUMBER    */ 00742000
         LA    MSGNO,7                                             0283 00743000
*         GOTO MPREP2;                /* GO CONSTRUCT THE MESSAGE    */ 00744000
         B     MPREP2                                              0284 00745000
*PWSPRT:  /* PASSWORDS ARE SUPPORTED FOR THIS USER. SET FLAG         */ 00746000
*         /* TO INDICATE THAT PASSWORD SUPPORT EXISTS IN THE UADS    */ 00747000
*         /* FOR AT LEAST ONE USER.                                  */ 00748000
*         PWSUPFLG = '1'B;                                         0285 00749000
PWSPRT   OI    PWSUPFLG,B'00001000'                                0285 00750000
*         /* CHECK WHETHER A PASSWORD WAS SPECIFIED IN THE NODELIST. */ 00751000
*         /* IF YES, THEN ENTER THE PASSWORD SEARCH LOOP.            */ 00752000
*         IF PASSWD(1:2) = '* '                                    0286 00753000
*           THEN                      /* PASSWORD NOT SPECIFIED,     */ 00754000
         CLC   PASSWD(2),@CC00380                                  0286 00755000
         BNE   @RF00286                                            0286 00756000
*             /* IF THE PASSWORD LEVEL IS ALSO THE CHANGE LEVEL, THEN   00757000
*                NO SEARCH IS REQUIRED, SINCE PASSWORD = '*'.        */ 00758000
*             IF CHLEVL = 2                                        0287 00759000
*               THEN                  /* CHGE LEVL = PASSWD LEVL,    */ 00760000
         CLI   CHLEVL,2                                            0287 00761000
         BE    @RT00287                                            0287 00762000
*                 GOTO WORKER;        /* GO TO PASSWD/ACCTNMBR RTNE     00763000
*                                        TO MAKE REQUIRED CHANGES    */ 00764000
*               ELSE                                               0289 00765000
*                 GOTO ACLEVL;        /* CONTINUE ON ACTNBR LEVEL    */ 00766000
         B     ACLEVL                                              0289 00767000
*         /* SEARCH FOR THE PASSWORD SPECIFIED IN THE NODELIST       */ 00768000
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */ 00769000
@RF00286 NI    LOOPFLG,B'01111111'                                 0290 00770000
*         DO WHILE LOOPFLG = '0'B;                                 0291 00771000
         B     @DE00291                                            0291 00772000
@DL00291 DS    0H                                                  0292 00773000
*         /* CHECK THE CHAIN FLAG. IF IT IS '1', INDICATING END OF   */ 00774000
*         /* LATERAL CHAIN, THEN THE SPECIFIED PASSWORD DOES NOT     */ 00775000
*         /* EXIST IN THIS USERID TREE.                              */ 00776000
*           UADSPPTR = HEDBPTR+UADSPDAT;/* REFERENCE THE PASSWORD DATA  00777000
*                                          BLOCK IN THE UADS         */ 00778000
         LR    UADSPPTR,HEDBPTR                                    0292 00779000
         AL    UADSPPTR,UADSPDAT(,DPOBPTR)                         0292 00780000
*           /* COMPARE THE UADS-PASSWORD TO THE NODELIST-PASSWORD    */ 00781000
*           IF UADSPPWD = PASSWD      /* ARE THEY EQUAL?             */ 00782000
*             THEN                    /* YES, THE SPECIFIED PASSWORD    00783000
*                                        HAS BEEN FOUND              */ 00784000
         CLC   UADSPPWD(8,UADSPPTR),PASSWD                         0293 00785000
         BNE   @RF00293                                            0293 00786000
*               DO;                                                0294 00787000
*                 PWFNDFLG = '1'B;    /* INDICATE PASSWORD EXISTS    */ 00788000
         OI    PWFNDFLG,B'01000000'                                0295 00789000
*                 PASSADDR = DPOBPTR; /* PUT PTR TO PASSWD OBLK INTO    00790000
*                                         CHANGE CONTROL TABLE       */ 00791000
         ST    DPOBPTR,PASSADDR                                    0296 00792000
*                 /* IF THE PASSWORD LEVEL IS ALSO THE CHANGE LEVEL, */ 00793000
*                 /* THEN PASS CONTROL TO THE WORKER RTNE (IKJEFA22).*/ 00794000
*                 IF CHLEVL = 2                                    0297 00795000
*                   THEN              /* PASSWORD = CHANGE LEVEL     */ 00796000
         CLI   CHLEVL,2                                            0297 00797000
         BE    @RT00297                                            0297 00798000
*                     GOTO WORKER;    /* WORKER WILL MAKE THE REQUIRED  00799000
*                                        CHANGES TO THIS TREE        */ 00800000
*                   ELSE                                           0299 00801000
*                     GOTO ACLEVL;    /* THE SPECIFIED PASSWORD HAS     00802000
*                                        BEEN FOUND. GO TO SEARCH  0299 00803000
*                                        FOR ACCTNMBR                */ 00804000
         B     ACLEVL                                              0299 00805000
*               END;                                               0300 00806000
*           IF PFLG01 = '1'B          /* IS THIS THE LAST PASSWORD?  */ 00807000
*             THEN                    /* YES,                        */ 00808000
@RF00293 TM    PFLG01(DPOBPTR),B'10000000'                         0301 00809000
         BNO   @RF00301                                            0301 00810000
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */ 00811000
         OI    LOOPFLG,B'10000000'                                 0302 00812000
*             ELSE                                                 0303 00813000
*               DPOBPTR =             /* ADDR OF NEXT OFFSET BLOCK = */ 00814000
*                 HEDBPTR+UADSPNEX;   /* ..ADDR OF USERID HEADER + 0303 00815000
*                                        OFFSET TO BROTHER           */ 00816000
         B     @RC00301                                            0303 00817000
@RF00301 LR    @10,HEDBPTR                                         0303 00818000
         L     @02,UADSPNEX-1(,DPOBPTR)                            0303 00819000
         LA    @02,0(,@02)                                         0303 00820000
         ALR   @10,@02                                             0303 00821000
         LR    DPOBPTR,@10                                         0303 00822000
*         END;                                                     0304 00823000
@RC00301 DS    0H                                                  0304 00824000
@DE00291 TM    LOOPFLG,B'10000000'                                 0304 00825000
         BZ    @DL00291                                            0304 00826000
*         /* CHECK WHETHER THERE ARE MORE USERIDS TO BE PROCESSED.   */ 00827000
*         GOTO MORUS;                 /* SEARCH FOR THIS PASSWORD  0305 00828000
*                                        UNDER THE NEXT USERID       */ 00829000
         B     MORUS                                               0305 00830000
*ACLEVL:  /***********************************************************/ 00831000
*         /* THIS SECTION WILL SEARCH FOR THE ACCTNMBR SPECIFIED IN  */ 00832000
*         /* THE NODELIST OF THE CHANGE COMMAND. IF NONE WAS SPECI-  */ 00833000
*         /* FIED ('*' IN THE ACCTNMBR POSITION), THEN THE CHANGE    */ 00834000
*         /* LEVEL (CHLEVL) WILL DETERMINE WHERE PROCESSING IS TO    */ 00835000
*         /* CONTINUE.                                               */ 00836000
*         /***********************************************************/ 00837000
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF THE 1ST ACCTNMBR OBLK 0306 00838000
*                                        IN THE LOCAL CHAIN          */ 00839000
ACLEVL   LR    DNOBPTR,HEDBPTR                                     0306 00840000
         AL    DNOBPTR,UADSPSUB(,DPOBPTR)                          0306 00841000
*         ACCTADDR = DNOBPTR;         /* SAVE ADDRESS OF THIS OBLK   */ 00842000
         ST    DNOBPTR,ACCTADDR                                    0307 00843000
*         /* ARE ACCOUNT NUMBERS SUPPORTED FOR THIS USERID?          */ 00844000
*         IF UADSADAT ^= 0                                         0308 00845000
*           THEN                      /* YES,                        */ 00846000
         L     @10,UADSADAT(,DNOBPTR)                              0308 00847000
         LTR   @10,@10                                             0308 00848000
         BNZ   @RT00308                                            0308 00849000
*             GOTO ACSPRT;            /* CONTINUE NORMALLY           */ 00850000
*         /* ACCTNMBRS ARE NOT SUPPORTED FOR THIS USER. IF THE       */ 00851000
*         /* CHANGE LEVEL IS THE ACCTNMBR LEVEL, THEN THE COMMAND    */ 00852000
*         /* IS INVALID FOR THIS USERID.                             */ 00853000
*         IF CHLEVL = 3               /* CHANGE LVL = ACCTNO LVL?    */ 00854000
*           THEN                      /* YES,                        */ 00855000
         CLI   CHLEVL,3                                            0310 00856000
         BNE   @RF00310                                            0310 00857000
*             DO;                                                  0311 00858000
*             /* THE COMMAND IS INVALID FOR THIS USERID. IF THE    0312 00859000
*                NODELIST USERID = '*', PROCESSING CONTINUES WITH THE   00860000
*                NEXT USRID. IF NOT, AN ERROR MESSAGE IS PUT OUT.    */ 00861000
*             IF USIND = '1'B                                      0312 00862000
*               THEN                  /* USERID IS NOT SPECIFIED     */ 00863000
         TM    USIND,B'10000000'                                   0312 00864000
         BO    @RT00312                                            0312 00865000
*                 GOTO MORUS;         /* CONTINUE WITH NEXT USERID   */ 00866000
*             MSGNO = 8;              /* SET ERROR MESSAGE NUMBER    */ 00867000
         LA    MSGNO,8                                             0314 00868000
*             GOTO MPREP2;            /* GO CONSTRUCT THE MESSAGE    */ 00869000
         B     MPREP2                                              0315 00870000
*             END;                                                 0316 00871000
*         /* ACCTNMBRS ARE NOT SUPPORTED, BUT THE CHANGE LEVEL IS  0317 00872000
*            THE PROCNAME LEVEL. IF AN ACCTNMBR IS SPECIFIED, CON- 0317 00873000
*            TINUE THE SEARCH IN THE NEXT USERID TREE. IF NOT, CON-     00874000
*            TINUE AT THE PROCNAME LEVEL.                            */ 00875000
*         IF ACCTNO(1:2) = '* '                                    0317 00876000
*           THEN                      /* ACCTNMBR NOT SPECIFIED,     */ 00877000
@RF00310 CLC   ACCTNO(2),@CC00380                                  0317 00878000
         BE    @RT00317                                            0317 00879000
*             GOTO PRLEVL;            /* GO CONTINUE WITH PROCNAME   */ 00880000
*           ELSE                      /* ACCTNMBR SPECIFIED,         */ 00881000
*             GOTO MORUS;             /* CONTINUE WITH NEXT USERID   */ 00882000
         B     MORUS                                               0319 00883000
*ACSPRT:  /* ACCOUNT NUMBERS ARE SUPPORTED FOR THIS USER. SET FLAG   */ 00884000
*         /* TO INDICATE THAT ACCTNMBR SUPPORT EXISTS IN THE UADS    */ 00885000
*         /* FOR AT LEAST ONE USER.                                  */ 00886000
*         ACSUPFLG = '1'B;                                         0320 00887000
ACSPRT   OI    ACSUPFLG,B'00000100'                                0320 00888000
*         /* CHECK WHETHER AN ACCTNMBR WAS SPECIFIED IN THE NODELIST */ 00889000
*         /* IF YES, THEN ENTER THE ACCTNMBR SEARCH LOOP.            */ 00890000
*         IF ACCTNO(1:2) = '* '                                    0321 00891000
*           THEN                      /* ACCTNMBR NOT SPECIFIED,     */ 00892000
         CLC   ACCTNO(2),@CC00380                                  0321 00893000
         BNE   @RF00321                                            0321 00894000
*             DO;                                                  0322 00895000
*             /* IF THE ACCTNMBR LEVEL IS ALSO THE CHANGE LEVEL, THEN   00896000
*                NO SEARCH IS REQUIRED, SINCE ACCTNMBR = '*'.        */ 00897000
*             IF CHLEVL = 3                                        0323 00898000
*               THEN                  /* CHGE LEVL = ACTNBR LEVL,    */ 00899000
         CLI   CHLEVL,3                                            0323 00900000
         BE    @RT00323                                            0323 00901000
*                 GOTO WORKER;        /* GO TO PASSWD/ACCTNMBR RTNE     00902000
*                                        TO MAKE REQUIRED CHANGES    */ 00903000
*               ELSE                                               0325 00904000
*                 GOTO PRLEVL;        /* CONTINUE ON PROCNAME LEVEL  */ 00905000
         B     PRLEVL                                              0325 00906000
*         END;                                                     0326 00907000
*         /* SEARCH FOR THE ACCOUNT NUMBER SPECIFIED IN THE NODELIST */ 00908000
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */ 00909000
@RF00321 NI    LOOPFLG,B'01111111'                                 0327 00910000
*         DO WHILE LOOPFLG = '0'B;    /* LOOP TILL END OF CHAIN      */ 00911000
         B     @DE00328                                            0328 00912000
@DL00328 DS    0H                                                  0329 00913000
*           UADSAPTR = HEDBPTR+UADSADAT;/* REFERENCE THE ACCTNMBR  0329 00914000
*                                          DATA BLOCK IN THE UADS    */ 00915000
         LR    UADSAPTR,HEDBPTR                                    0329 00916000
         AL    UADSAPTR,UADSADAT(,DNOBPTR)                         0329 00917000
*           /* COMPARE THE LENGTHS IN THE DATA BLOCK AND NODELIST. IF   00918000
*              THE LENGTHS ARE NOT EQUAL, A COMPARISON OF THE ACCOUNT   00919000
*              NUMBERS IS UNNECESSARY                                */ 00920000
*           IF UADSALEN = ACTLEN      /* LENGTHS EQUAL?              */ 00921000
*             & UADSANUM(1:UADSALEN)= /* ACCTNMBRS EQUAL?            */ 00922000
*                ACCTNO(1:UADSALEN)                                0330 00923000
*               THEN                  /* THEY ARE EQUAL              */ 00924000
         CLC   UADSALEN(1,UADSAPTR),ACTLEN                         0330 00925000
         BNE   @RF00330                                            0330 00926000
         SLR   @10,@10                                             0330 00927000
         IC    @10,UADSALEN(,UADSAPTR)                             0330 00928000
         BCTR  @10,0                                               0330 00929000
         EX    @10,@SC00448                                        0330 00930000
         BNE   @RF00330                                            0330 00931000
*                 DO;                                              0331 00932000
*                   ACFNDFLG = '1'B;  /* INDICATE ACCTNMBR EXISTS    */ 00933000
         OI    ACFNDFLG,B'00100000'                                0332 00934000
*                   PASSADDR = DPOBPTR;/* PUT PTR TO PASSWD OBLK INTO   00935000
*                                         CHANGE CONTROL TABLE       */ 00936000
         ST    DPOBPTR,PASSADDR                                    0333 00937000
*                   ACCTADDR = DNOBPTR;/* PUT PTR TO ACCTNO OBLK INTO   00938000
*                                         CHANGE CONTROL TABLE       */ 00939000
         ST    DNOBPTR,ACCTADDR                                    0334 00940000
*                   /* IF THE ACCTNMBR LEVEL IS ALSO THE CHANGE      */ 00941000
*                   /* LEVEL, THEN PASS CONTROL TO THE WORKER        */ 00942000
*                   /* ROUTINE (IKJEFA22).                           */ 00943000
*                   IF CHLEVL = 3                                  0335 00944000
*                     THEN            /* ACCTNMBR = CHANGE LEVEL     */ 00945000
         CLI   CHLEVL,3                                            0335 00946000
         BE    @RT00335                                            0335 00947000
*                       GOTO WORKER;  /* WORKER WILL MAKE THE REQUIRED  00948000
*                                        CHANGES TO THIS TREE        */ 00949000
*                   GOTO PRLEVL;      /* THE SPECIFIED ACCTNMBR HAS     00950000
*                                        BEEN FOUND. START PROCESSING   00951000
*                                        THE PROCNAME                */ 00952000
         B     PRLEVL                                              0337 00953000
*                 END;                                             0338 00954000
*           IF AFLG01 = '1'B          /* IS THIS THE LAST ACCTNO. ?  */ 00955000
*             THEN                    /* YES,                        */ 00956000
@RF00330 TM    AFLG01(DNOBPTR),B'10000000'                         0339 00957000
         BNO   @RF00339                                            0339 00958000
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */ 00959000
         OI    LOOPFLG,B'10000000'                                 0340 00960000
*             ELSE                                                 0341 00961000
*               DNOBPTR =             /* REFERENCE THE NEXT OFFSET   */ 00962000
*                 HEDBPTR+UADSANEX;   /*   BLOCK IN THIS CHAIN     0341 00963000
*                                          CONTINUE THE SEARCH       */ 00964000
         B     @RC00339                                            0341 00965000
@RF00339 LR    @10,HEDBPTR                                         0341 00966000
         L     @07,UADSANEX-1(,DNOBPTR)                            0341 00967000
         LA    @07,0(,@07)                                         0341 00968000
         ALR   @10,@07                                             0341 00969000
         LR    DNOBPTR,@10                                         0341 00970000
*         END;                                                     0342 00971000
@RC00339 DS    0H                                                  0342 00972000
@DE00328 TM    LOOPFLG,B'10000000'                                 0342 00973000
         BZ    @DL00328                                            0342 00974000
*         /* CHECK THE CHAIN FLAG IN THE PASSWORD OFFSET BLOCK.      */ 00975000
*         IF PASSWD(1:2) = '* '       /* IF NODELIST PASSWORD = *    */ 00976000
*           & PFLG01 = '0'B           /* AND THERE ARE MORE PASSWORDS*/ 00977000
*             THEN                    /* YES                         */ 00978000
         CLC   PASSWD(2),@CC00380                                  0343 00979000
         BNE   @RF00343                                            0343 00980000
         TM    PFLG01(DPOBPTR),B'10000000'                         0343 00981000
         BNZ   @RF00343                                            0343 00982000
*               DO;                                                0344 00983000
*               DPOBPTR = HEDBPTR     /* REF NEXT PASSWORD OBLK      */ 00984000
*                 +UADSPNEX;                                       0345 00985000
         LR    @10,HEDBPTR                                         0345 00986000
         L     @02,UADSPNEX-1(,DPOBPTR)                            0345 00987000
         LA    @02,0(,@02)                                         0345 00988000
         ALR   @10,@02                                             0345 00989000
         LR    DPOBPTR,@10                                         0345 00990000
*               GOTO ACLEVL;          /* CONTINUE THE SEARCH FOR THIS   00991000
*                                        ACCTNMBR UNDER THE NEXT PASS-  00992000
*                                        WORD                        */ 00993000
         B     ACLEVL                                              0346 00994000
*               END;                                               0347 00995000
*         /* CHECK WHETHER THIS TREE HAS BEEN CHANGED. IF NOT, THEN  */ 00996000
*         /* THIS WAS THE FIRST SEARCH FOR THE NODELIST ACCTNMBR     */ 00997000
*         /* IN THIS TREE AND IT DOES NOT EXIST THERE.               */ 00998000
*         IF TRCHGE = '1'B            /* HAS THE TREE BEEN CHANGED?  */ 00999000
*           THEN                      /* YES,                        */ 01000000
@RF00343 TM    TRCHGE,B'10000000'                                  0348 01001000
         BO    @RT00348                                            0348 01002000
*             GOTO CHKMAX;            /* WRITE THIS TREE BACK INTO 0349 01003000
*                                        THE UADS                    */ 01004000
*         /* CHECK WHETHER THERE ARE MORE USERIDS TO BE PROCESSED.   */ 01005000
*         GOTO MORUS;                 /* CONTINUE THE SEARCH FOR THIS   01006000
*                                        ACCTNMBR UNDER THE NEXT   0350 01007000
*                                        USERID                      */ 01008000
         B     MORUS                                               0350 01009000
*PRLEVL:  /***********************************************************/ 01010000
*         /* THIS SECTION WILL SEARCH FOR THE NODELIST PROCNAME, IF  */ 01011000
*         /* ONE WAS SPECIFIED. IF AN '*' WAS ENTERED IN THE PROC-   */ 01012000
*         /* NAME POSITION, OR AFTER THE SPECIFIED PROCNAME HAS      */ 01013000
*         /* BEEN FOUND, CONTROL WILL BE PASSED TO THE PROCNAME      */ 01014000
*         /* ROUTINE (IKJEFA23).                                     */ 01015000
*         /***********************************************************/ 01016000
*         DROBPTR = HEDBPTR+UADSASUB; /* REF THE 1ST PROCNAME OBLK 0351 01017000
*                                        IN THE LOCAL CHAIN          */ 01018000
PRLEVL   LR    DROBPTR,HEDBPTR                                     0351 01019000
         AL    DROBPTR,UADSASUB(,DNOBPTR)                          0351 01020000
*         PROCADDR = DROBPTR;         /* SAVE ADDR OF THIS OBLK      */ 01021000
         ST    DROBPTR,PROCADDR                                    0352 01022000
*         /* CHECK WHETHER A PROCNAME WAS SPECIFIED IN THE NODELIST. */ 01023000
*         IF PROCNM(1) = '*'                                       0353 01024000
*           THEN                      /* AN '*' WAS SPECIFIED,       */ 01025000
         CLI   PROCNM,C'*'                                         0353 01026000
         BE    @RT00353                                            0353 01027000
*             GOTO WORKER;            /* GO TO THE PROCNAME RTNE TO     01028000
*                                        MAKE THE REQUIRED CHANGES   */ 01029000
*         /* THIS SECTION OF CODE WILL SEARCH FOR THE NODELIST PROC- */ 01030000
*         /* NAME.                                                   */ 01031000
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */ 01032000
         NI    LOOPFLG,B'01111111'                                 0355 01033000
*         DO WHILE LOOPFLG = '0'B;    /* LOOP TILL END OF CHAIN      */ 01034000
         B     @DE00356                                            0356 01035000
@DL00356 DS    0H                                                  0357 01036000
*           UADSRPTR = HEDBPTR+UADSRDAT;/* REFERENCE THE DATA FIELD  */ 01037000
         LR    UADSRPTR,HEDBPTR                                    0357 01038000
         AL    UADSRPTR,UADSRDAT(,DROBPTR)                         0357 01039000
*           /* COMPARE THE NODELIST PROCNAME TO THE PROCNAME IN THE     01040000
*              DATA FIELD.                                           */ 01041000
*           IF PROCNM = UADSRNAM      /* IS THIS THE NODELST PROCNM? */ 01042000
*             THEN                    /* YES,                        */ 01043000
         CLC   PROCNM(8),UADSRNAM(UADSRPTR)                        0358 01044000
         BNE   @RF00358                                            0358 01045000
*               DO;                                                0359 01046000
*               PRFNDFLG = '1'B;      /* INDICATE PROCNAME EXISTS    */ 01047000
         OI    PRFNDFLG,B'00010000'                                0360 01048000
*               PASSADDR = DPOBPTR;    /* PUT PTR TO PASSWD OBLK INTO   01049000
*                                         CHANGE CONTROL TABLE       */ 01050000
         ST    DPOBPTR,PASSADDR                                    0361 01051000
*               ACCTADDR = DNOBPTR;    /* PUT PTR TO ACCTNO OBLK INTO   01052000
*                                         CHANGE CONTROL TABLE       */ 01053000
         ST    DNOBPTR,ACCTADDR                                    0362 01054000
*               PROCADDR = DROBPTR;   /* PUT PTR TO PROC OBLK INTO 0363 01055000
*                                        CHANGE CONTROL TABLE        */ 01056000
         ST    DROBPTR,PROCADDR                                    0363 01057000
*               GOTO WORKER;          /* THE PROCNAME RTNE WILL MAKE    01058000
*                                        THE NECESSARY CHANGES       */ 01059000
         B     WORKER                                              0364 01060000
*             END;                                                 0365 01061000
*           IF FLGR01 = '1'B          /* IS THIS THE LAST PROCEDURE? */ 01062000
*             THEN                    /* YES,                        */ 01063000
@RF00358 TM    FLGR01(DROBPTR),B'10000000'                         0366 01064000
         BNO   @RF00366                                            0366 01065000
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */ 01066000
         OI    LOOPFLG,B'10000000'                                 0367 01067000
*             ELSE                                                 0368 01068000
*               DROBPTR =             /* REFERENCE THE NEXT PROCNAME */ 01069000
*                 HEDBPTR+UADSRNEX;   /*  OFFSET BLOCK AND CONTINUE     01070000
*                                         THE SEARCH                 */ 01071000
         B     @RC00366                                            0368 01072000
@RF00366 LR    @10,HEDBPTR                                         0368 01073000
         L     @07,UADSRNEX-1(,DROBPTR)                            0368 01074000
         LA    @07,0(,@07)                                         0368 01075000
         ALR   @10,@07                                             0368 01076000
         LR    DROBPTR,@10                                         0368 01077000
*         END;                                                     0369 01078000
@RC00366 DS    0H                                                  0369 01079000
@DE00356 TM    LOOPFLG,B'10000000'                                 0369 01080000
         BZ    @DL00356                                            0369 01081000
*         /* ARE THERE MORE ACCTNMBRS TO BE PROCESSED IN THIS LOCAL  */ 01082000
*         /* ACCTNMBR CHAIN?                                         */ 01083000
*         /* IF AN ACCTNMBR WAS SPECIFIED, THEN GO CHECK FOR MORE    */ 01084000
*         /* PASSWORDS.                                              */ 01085000
*         IF ACCTNO(1:2) = '* '       /* IS ACCTNMBR SPECIFIED?      */ 01086000
*           & AFLG01 = '0'B           /* MORE ACCTNMBRS IN THIS    0370 01087000
*                                        LOCAL CHAIN?                */ 01088000
*               THEN                  /* YES,                        */ 01089000
         CLC   ACCTNO(2),@CC00380                                  0370 01090000
         BNE   @RF00370                                            0370 01091000
         TM    AFLG01(DNOBPTR),B'10000000'                         0370 01092000
         BNZ   @RF00370                                            0370 01093000
*                 DO;                                              0371 01094000
*                   DNOBPTR = HEDBPTR /* REFERENCE THE NEXT ACCTNMBR */ 01095000
*                     +UADSANEX;      /* ..OFFSET BLOCK AND..        */ 01096000
         LR    @10,HEDBPTR                                         0372 01097000
         L     @07,UADSANEX-1(,DNOBPTR)                            0372 01098000
         LA    @07,0(,@07)                                         0372 01099000
         ALR   @10,@07                                             0372 01100000
         LR    DNOBPTR,@10                                         0372 01101000
*                   GOTO PRLEVL;      /* GO SEARCH UNDER NEXT ACTNMR */ 01102000
         B     PRLEVL                                              0373 01103000
*                 END;                                             0374 01104000
*         /* IF A PASSWORD WAS SPECIFIED, THEN THE PROCNAME WAS      */ 01105000
*         /* NOT FOUND IN THIS TREE (OR NOT FOUND AGAIN).            */ 01106000
*         IF PASSWD(1:2) = '* '       /* IS PASSWORD SPECIFIED?      */ 01107000
*           & PFLG01 = '0'B           /* MORE PASSWORDS?             */ 01108000
*               THEN                  /* YES,                        */ 01109000
@RF00370 CLC   PASSWD(2),@CC00380                                  0375 01110000
         BNE   @RF00375                                            0375 01111000
         TM    PFLG01(DPOBPTR),B'10000000'                         0375 01112000
         BNZ   @RF00375                                            0375 01113000
*                 DO;                                              0376 01114000
*                   DPOBPTR = HEDBPTR /* REFERENCE THE NEXT PASSWORD */ 01115000
*                     +UADSPNEX;      /* ..OFFSET BLOCK AND..        */ 01116000
         LR    @10,HEDBPTR                                         0377 01117000
         L     @02,UADSPNEX-1(,DPOBPTR)                            0377 01118000
         LA    @02,0(,@02)                                         0377 01119000
         ALR   @10,@02                                             0377 01120000
         LR    DPOBPTR,@10                                         0377 01121000
*                   GOTO ACLEVL;      /* GO SEARCH UNDER NEXT PASSWD */ 01122000
         B     ACLEVL                                              0378 01123000
*                 END;                                             0379 01124000
*         /* CHECK WHETHER THIS TREE HAS BEEN CHANGED. IF NOT, THEN  */ 01125000
*         /* THIS WAS THE FIRST SEARCH FOR THE NODELIST PROCNAME     */ 01126000
*         /* IN THIS TREE AND IT DOES NOT EXIST THERE.               */ 01127000
*         IF TRCHGE = '1'B            /* HAS THE TREE BEEN CHANGED?  */ 01128000
*           THEN                      /* YES,                        */ 01129000
@RF00375 TM    TRCHGE,B'10000000'                                  0380 01130000
         BO    @RT00380                                            0380 01131000
*             GOTO CHKMAX;            /* WRITE THIS TREE BACK INTO 0381 01132000
*                                        THE UADS                    */ 01133000
*         GOTO MORUS;                 /* CHECK FOR MORE USERS        */ 01134000
         B     MORUS                                               0382 01135000
*WORKER:  /***********************************************************/ 01136000
*         /*                                                         */ 01137000
*         /* THE PASSWORD/ACCTNMBR RTNE (IKJEFA22) AND THE PROCNAME  */ 01138000
*         /* ROUTINE (IKJEFA23) WILL MAKE THE REQUIRED CHANGES AT    */ 01139000
*         /* ALL LEVELS BELOW THE USERID LEVEL.                      */ 01140000
*         /*                                                         */ 01141000
*         /***********************************************************/ 01142000
*         /* BUILD THE CONTROL TABLE FOR IKJEFA22/23.                */ 01143000
*         BLOKCNT = ACIONMBR;         /* NO. OF BLOCKS READ IN       */ 01144000
WORKER   IC    @10,ACIONMBR                                        0383 01145000
         STC   @10,BLOKCNT                                         0383 01146000
*         HEADADDR = HEDBPTR;         /* PTR TO THE USER HEADER      */ 01147000
         STCM  HEDBPTR,7,HEADADDR                                  0384 01148000
*         RFY R1 RSTD;                /* RESTRICT PARAMETER REGISTER */ 01149000
*         R1 = ADDR(CTRLTAB);         /* ADDR OF THE CONTROL TABLE   */ 01150000
         LA    R1,CTRLTAB                                          0386 01151000
*         /* CHECK WHICH ROUTINE IS TO BE CALLED.                    */ 01152000
*         IF CHLEVL = 4               /* CHANGE LEVEL = PROCNAME?    */ 01153000
*           THEN                      /* YES,                        */ 01154000
         CLI   CHLEVL,4                                            0387 01155000
         BNE   @RF00387                                            0387 01156000
*             CALL IKJEFA23;          /* GO TO PROCNAME RTNE         */ 01157000
         L     @15,@CV00147                                        0388 01158000
         BALR  @14,@15                                             0388 01159000
*           ELSE                      /* NO, PASSWORD OR ACCTNMBR    */ 01160000
*             CALL IKJEFA22;          /* GO TO PASSWD/ACTNMBR RTNE   */ 01161000
         B     @RC00387                                            0389 01162000
@RF00387 L     @15,@CV00146                                        0389 01163000
         BALR  @14,@15                                             0389 01164000
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REGISTER  */ 01165000
@RC00387 DS    0H                                                  0391 01166000
*         /* CHECK WHETHER A SEARCH LOOP HAS TO BE REENTERED.        */ 01167000
*         /* ARE THERE MORE ACCTNMBRS TO BE PROCESSED IN THIS LOCAL  */ 01168000
*         /* ACCTNMBR CHAIN?                                         */ 01169000
*         IF SRCHIND = 2              /* IS ACCTNMBR SEARCH NEEDED?  */ 01170000
*           THEN                      /* YES,                        */ 01171000
         CLI   SRCHIND,2                                           0391 01172000
         BNE   @RF00391                                            0391 01173000
*             DO;                                                  0392 01174000
*             DNOBPTR = ACCTADDR;     /* REFERENCE THE NEXT ACCTNMBR    01175000
*                                        ..OFFSET BLOCK AND..        */ 01176000
         L     DNOBPTR,ACCTADDR                                    0393 01177000
*             GOTO PRLEVL;            /* GO SEARCH UNDER NEXT ACTNMR */ 01178000
         B     PRLEVL                                              0394 01179000
*             END;                                                 0395 01180000
*         /* IF A PASSWORD WAS SPECIFIED, THEN THE PROCNAME WAS      */ 01181000
*         /* NOT FOUND IN THIS TREE (OR NOT FOUND AGAIN).            */ 01182000
*         IF SRCHIND = 1              /* IS PASSWORD SEARCH NEEDED?  */ 01183000
*           THEN                      /* YES,                        */ 01184000
@RF00391 CLI   SRCHIND,1                                           0396 01185000
         BNE   @RF00396                                            0396 01186000
*             DO;                                                  0397 01187000
*             DPOBPTR = PASSADDR;     /* REFERENCE THE NEXT PASSWORD    01188000
*                                        ..OFFSET BLOCK AND..        */ 01189000
         L     DPOBPTR,PASSADDR                                    0398 01190000
*             GOTO ACLEVL;            /* GO SEARCH UNDER NEXT PASSWD */ 01191000
         B     ACLEVL                                              0399 01192000
*             END;                                                 0400 01193000
*MSGCHK:  /* CHECK THE MESSAGE NUMBER SET BY IKJEFA22/23. IF IT IS   */ 01194000
*         /* NOT ZERO, THEN ISSUE THE INDICATED ERROR MESSAGE.       */ 01195000
*         IF MSGNMBR = 0              /* SUCCESSFUL COMPLETION?      */ 01196000
*           THEN                      /* YES,                        */ 01197000
@RF00396 DS    0H                                                  0401 01198000
MSGCHK   CLI   MSGNMBR,0                                           0401 01199000
         BE    @RT00401                                            0401 01200000
*             GOTO CHKMAX;            /* CONTINUE PROCESSING         */ 01201000
*         /* CHECK WHETHER THE NEW PROCSIZE WAS REDUCED TO MAXSIZE.  */ 01202000
*         /* THE USER WILL BE INFORMED OF THIS ACTION AFTER THE TREE */ 01203000
*         /* HAS BEEN WRITTEN BACK SUCCESSFULLY. IT IS NOT AN ERROR. */ 01204000
*         IF MSGNMBR = 14                                          0403 01205000
*           THEN                      /* PROCSIZE WAS REDUCED,       */ 01206000
         CLI   MSGNMBR,14                                          0403 01207000
         BNE   @RF00403                                            0403 01208000
*             DO;                                                  0404 01209000
*               STGFLG = '1'B;        /* MSG WILL BE ISSUED LATER    */ 01210000
         OI    STGFLG,B'00010000'                                  0405 01211000
*               GOTO CHKMAX;          /* CONTINUE NORMALLY           */ 01212000
         B     CHKMAX                                              0406 01213000
*             END;                                                 0407 01214000
*         /* ACCOUNT FREESPACE FAILURE?                              */ 01215000
*         IF MSGNMBR = 24                                          0408 01216000
*           THEN                      /* FREESPACE FAILURE           */ 01217000
@RF00403 CLI   MSGNMBR,24                                          0408 01218000
         BNE   @RF00408                                            0408 01219000
*             DO;                                                  0409 01220000
*               MSGNO = 24;           /* SET MSG NUMBER              */ 01221000
         LA    MSGNO,24                                            0410 01222000
*               GOTO MLMSG;           /* GO CONSTRUCT THE MSG        */ 01223000
         B     MLMSG                                               0411 01224000
*             END;                                                 0412 01225000
*         /* ERROR IS NOT SERIOUS - PROCESSING CAN CONTINUE          */ 01226000
*         MSGNO = MSGNMBR;            /* SET MSG NUMBER              */ 01227000
@RF00408 SLR   MSGNO,MSGNO                                         0413 01228000
         IC    MSGNO,MSGNMBR                                       0413 01229000
*         GOTO MPREP1;                /* CONTINUE MSG CONSTRUCTION   */ 01230000
         B     MPREP1                                              0414 01231000
*CHKMAX:  /* ALL REQUIRED CHANGES, EXCLUDING THE USERID ITSELF, HAVE */ 01232000
*         /* NOW BEEN MADE. ONE LAST CHECK, HOWEVER, IS NECESSARY.   */ 01233000
*         /* IF THE VALUE OF MAXSIZE WAS DECREASED, THEN IT IS POS-  */ 01234000
*         /* SIBLE THAT A PROCSIZE IS NOW LARGER THAN THE NEW VALUE  */ 01235000
*         /* OF MAXSIZE. IF THIS CONDITION EXISTS, AN ERROR MESSAGE  */ 01236000
*         /* WILL BE ISSUED AND THIS TREE WILL NOT BE WRITTEN BACK   */ 01237000
*         /* INTO THE UADS.                                          */ 01238000
*         /* IF MAXSIZE IS 'NOLIM', OR IF IT WAS NOT CHANGED, THEN   */ 01239000
*         /* THE TEST IS NOT NECESSARY.                              */ 01240000
*         IF UADSMAXC = 0             /* MAXSIZE = 'NOLIM'?          */ 01241000
*          | MAXSKEY(16) = '0'B       /* OR UNCHANGED?               */ 01242000
*           THEN                      /* YES, ONE OF THE ABOVE       */ 01243000
CHKMAX   LH    @10,UADSMAXC(,HEDBPTR)                              0415 01244000
         N     @10,@CF00445                                        0415 01245000
         LTR   @10,@10                                             0415 01246000
         BZ    @RT00415                                            0415 01247000
         L     @10,CHPDLPTR                                        0415 01248000
         TM    MAXSKEY+1(@10),B'00000001'                          0415 01249000
         BZ    @RT00415                                            0415 01250000
*             GOTO ENQUSER;           /* BYPASS PROCSIZE COMPARISON  */ 01251000
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF 1ST PASSWORD OBLK       */ 01252000
         LR    DPOBPTR,HEDBPTR                                     0417 01253000
         AL    DPOBPTR,UADSPWD1(,HEDBPTR)                          0417 01254000
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF 1ST ACCTNMBR OBLK       */ 01255000
         LR    DNOBPTR,HEDBPTR                                     0418 01256000
         AL    DNOBPTR,UADSPSUB(,DPOBPTR)                          0418 01257000
*         DROBPTR = HEDBPTR+UADSASUB; /* REF 1ST PROCNAME OBLK       */ 01258000
         LR    DROBPTR,HEDBPTR                                     0419 01259000
         AL    DROBPTR,UADSASUB(,DNOBPTR)                          0419 01260000
*         /* BEGINNING OF PROCSIZE COMPARISON LOOP.                  */ 01261000
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */ 01262000
         NI    LOOPFLG,B'01111111'                                 0420 01263000
*         DO WHILE LOOPFLG = '0'B;    /* LOOP TILL END OF CHAIN      */ 01264000
         B     @DE00421                                            0421 01265000
@DL00421 DS    0H                                                  0422 01266000
*           UADSRPTR = HEDBPTR+UADSRDAT;/* REF PROCNAME DATA FIELD   */ 01267000
         LR    UADSRPTR,HEDBPTR                                    0422 01268000
         AL    UADSRPTR,UADSRDAT(,DROBPTR)                         0422 01269000
*           /* IS THIS PROCSIZE LARGER THAN MAXSIZE?                 */ 01270000
*           IF UADSRSIZ > UADSMAXC                                 0423 01271000
*             THEN                    /* YES,                        */ 01272000
         CLC   UADSRSIZ(2,UADSRPTR),UADSMAXC(HEDBPTR)              0423 01273000
         BNH   @RF00423                                            0423 01274000
*               DO;                                                0424 01275000
*               MSGNO = 13;           /* SET MSG NUMBER              */ 01276000
         LA    MSGNO,13                                            0425 01277000
*               CNTNFLG = '1'B;       /* TURN CONTINUATION FLAG ON   */ 01278000
         OI    CNTNFLG,B'00100000'                                 0426 01279000
*               CALL MSGFNDR;         /* GO CALCULATE THE MSG ADDR   */ 01280000
         BAL   @14,MSGFNDR                                         0427 01281000
*               INSRTL2 = MAXSLNG+4;  /* LENGTH OF MSG SEGMENT       */ 01282000
         L     @10,CHPDLPTR                                        0428 01283000
         LH    @05,MAXSLNG(,@10)                                   0428 01284000
         LA    @01,4(,@05)                                         0428 01285000
         STH   @01,INSRTL2                                         0428 01286000
*               INSRTT2(1:MAXSLNG) = MAXSIZE;/* INSERT MAXSIZE IN MSG*/ 01287000
         BCTR  @05,0                                               0429 01288000
         L     @10,MAXSADR(,@10)                                   0429 01289000
         EX    @05,@SM00450                                        0429 01290000
*               SEGPTR15 = ADDR(INSRT2);/* SET PTR TO ACTIVE INSERT  */ 01291000
         LA    @10,INSRT2                                          0430 01292000
         ST    @10,SEGPTR15                                        0430 01293000
*               GOTO MPREP3;          /* CONTINUE MSG CONSTRUCTION   */ 01294000
         B     MPREP3                                              0431 01295000
*               END;                                               0432 01296000
*           IF UADSRNEX = 0           /* IS THIS THE LAST PROCEDURE? */ 01297000
*             THEN                    /* YES,                        */ 01298000
@RF00423 L     @10,UADSRNEX-1(,DROBPTR)                            0433 01299000
         LA    @10,0(,@10)                                         0433 01300000
         LTR   @10,@10                                             0433 01301000
         BNZ   @RF00433                                            0433 01302000
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */ 01303000
         OI    LOOPFLG,B'10000000'                                 0434 01304000
*             ELSE                                                 0435 01305000
*               DROBPTR =             /* REFERENCE THE NEXT PROCNAME */ 01306000
*                 HEDBPTR+UADSRNEX;   /*  OFFSET BLOCK AND CONTINUE     01307000
*                                         THE SEARCH                 */ 01308000
         B     @RC00433                                            0435 01309000
@RF00433 LR    @10,HEDBPTR                                         0435 01310000
         L     @05,UADSRNEX-1(,DROBPTR)                            0435 01311000
         LA    @05,0(,@05)                                         0435 01312000
         ALR   @10,@05                                             0435 01313000
         LR    DROBPTR,@10                                         0435 01314000
*         END;                                                     0436 01315000
@RC00433 DS    0H                                                  0436 01316000
@DE00421 TM    LOOPFLG,B'10000000'                                 0436 01317000
         BZ    @DL00421                                            0436 01318000
*         /* ALL PROCSIZES HAVE BEEN COMPARED TO MAXSIZE. THE ABOVE  */ 01319000
*         /* DESCRIBED ERROR CONDITION DOES NOT EXIST AND PROCESSING */ 01320000
*         /* CONTINUES NORMALLY.                                     */ 01321000
*ENQUSER: /***********************************************************/ 01322000
*         /* THIS USERID TREE HAS BEEN CHANGED SUCCESSFULLY.         */ 01323000
*         /* CONTROL WILL BE PASSED TO THE WRITE ROUTINE (IKJEFA52)  */ 01324000
*         /* TO WRITE THIS TREE BACK INTO THE UADS. AFTER RETURN     */ 01325000
*         /* FROM IKJEFA52, IT WILL BE DETERMINED WHETHER ANY MORE   */ 01326000
*         /* USERID TREES MUST BE CHANGED ('*' IN THE USERID POSI-   */ 01327000
*         /* TION OF THE NODELIST).                                  */ 01328000
*         /***********************************************************/ 01329000
*         /* CHECK WHETHER THE ECB WAS POSTED (ATTENTION INTERRUPT)  */ 01330000
*         IF ATTENTN = '1'B                                        0437 01331000
*           THEN                      /* YES,                        */ 01332000
ENQUSER  L     @10,ACCTPLP                                         0437 01333000
         L     @10,ACCTECBP(,@10)                                  0437 01334000
         TM    ATTENTN(@10),B'01000000'                            0437 01335000
         BO    @RT00437                                            0437 01336000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN TO THE    01337000
*                                        ACCOUNT COMMAND PROCESSOR   */ 01338000
*         /* ENQ ON THIS USERID BEFORE WRITING THE TREE BACK INTO    */ 01339000
*         /* THE UADS. THE REQUEST IS FOR EXCLUSIVE CONTROL.         */ 01340000
*         GEN (ENQ   (,USRLEN),MF=(E,USERENQ))                     0439 01341000
*           REFS(MAJNAME,USRLEN,USERENQ);                          0439 01342000
         ENQ   (,USRLEN),MF=(E,USERENQ)                                 01343000
*         /* IF REGISTER 15 IS NOT 0, THEN THIS USERID IS IN USE.    */ 01344000
*         /* A MESSAGE TO THIS EFFECT WILL BE ISSUED AND PROCESSING  */ 01345000
*         /* WILL CONTINUE WITH THE NEXT USERID (IF ANY). RETURN     */ 01346000
*         /* CODE 8 IS NOT POSSIBLE SINCE THIS RTNE ISSUES ONLY ONE  */ 01347000
*         /* ENQ REQUEST FOR EACH USERID.                            */ 01348000
*         RFY R15 RSTD;               /* RESTRICT RETURN CODE REG    */ 01349000
*         IF R15 ^= 0                                              0441 01350000
*           THEN                      /* USERID IS IN USE            */ 01351000
         LTR   R15,R15                                             0441 01352000
         BZ    @RF00441                                            0441 01353000
*             DO;                                                  0442 01354000
*               MSGNO = 5;            /* SET MESSAGE NUMBER          */ 01355000
         LA    MSGNO,5                                             0443 01356000
*               GOTO MPREP1;          /* CONTINUE MSG CONSTRUCTION   */ 01357000
         B     MPREP1                                              0444 01358000
*             END;                                                 0445 01359000
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */ 01360000
@RF00441 DS    0H                                                  0447 01361000
*         ENQFLG = '1'B;              /* 1- USERID IS ENQ'ED ON      */ 01362000
         OI    ENQFLG,B'00000001'                                  0447 01363000
*         IF DUSRLEN = 0              /* NEW USERID SPECIFIED?       */ 01364000
*           THEN                      /* NO,                         */ 01365000
         CLI   DUSRLEN,0                                           0448 01366000
         BE    @RT00448                                            0448 01367000
*             GOTO WRTREE;                                         0449 01368000
*          IF UADSEXPF = '1'B         /* IS UADS EXPANDED?           */ 01369000
*            THEN                     /* YES,                       1*/ 01370000
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0450 01371000
         BNO   @RF00450                                            0450 01372000
*              DO;                                                 0451 01373000
*              UPTPTR = HEDBPTR+UADSUPTP;/* POINT TO UPT IN UADS    1*/ 01374000
         LR    UPTPTR,HEDBPTR                                      0452 01375000
         AL    UPTPTR,UADSUPTP(,HEDBPTR)                           0452 01376000
*              UPTPREFX = DUSRID(1:7);/* CHANGE USERID IN UPT       1*/ 01377000
         MVC   UPTPREFX(7,UPTPTR),DUSRID                           0453 01378000
*              UPTPREFL = DUSRLEN;    /* SET LENGTH OF NEW USERID   1*/ 01379000
         IC    @10,DUSRLEN                                         0454 01380000
         STC   @10,UPTPREFL(,UPTPTR)                               0454 01381000
*              END;                                                0455 01382000
*         /* THE USERID WILL BE CHANGED IN THE USER HEADER DATA      */ 01383000
*         /* BLOCK AND IN THE DIRECTORY. THE STOW MACRO WILL BE      */ 01384000
*         /* USED REPEATEDLY UNTIL ALL EXISTING EXTENTS OF THIS      */ 01385000
*         /* USERID HAVE BEEN CHANGED IN THE DIRECTORY.              */ 01386000
*         DUSRID(DUSRLEN+1) = '0';    /* INIT NEW USERID INDEX TO 0  */ 01387000
@RF00450 SLR   @10,@10                                             0456 01388000
         IC    @10,DUSRLEN                                         0456 01389000
         LA    @02,DUSRID(@10)                                     0456 01390000
         MVI   0(@02),C'0'                                         0456 01391000
*         OLDUSER = USRID;            /* PUT OLD USERID INTO STOWLST */ 01392000
         MVC   OLDUSER(8),USRID                                    0457 01393000
*         OLDUSER(USRLEN+1) = '0';    /* SET EXTENT NUMBER TO 0 FOR     01394000
*                                        FIRST STOW                  */ 01395000
         SLR   @02,@02                                             0458 01396000
         IC    @02,USRLEN                                          0458 01397000
         LA    @01,OLDUSER(@02)                                    0458 01398000
         MVI   0(@01),C'0'                                         0458 01399000
*         NEWUSER = DUSRID;           /* PUT NEW USERID INTO LIST    */ 01400000
         MVC   NEWUSER(8),DUSRID                                   0459 01401000
*         NEWINDP = ADDR(NEWUSER)+DUSRLEN;/* POINT TO NEW INDEX      */ 01402000
         LA    NEWINDP,NEWUSER                                     0460 01403000
         ALR   NEWINDP,@10                                         0460 01404000
*         OLDINDP = ADDR(OLDUSER)+USRLEN;/* POINT TO OLD INDEX       */ 01405000
         LA    OLDINDP,OLDUSER                                     0461 01406000
         ALR   OLDINDP,@02                                         0461 01407000
*         INDEX = 'F0'X;              /* INIT INDEX TO ZERO          */ 01408000
         LA    INDEX,240                                           0462 01409000
*         DO WHILE INDEX<(ACIONMBR|'F0'X);/* LOOP TILL LAST MEMBER   */ 01410000
         B     @DE00463                                            0463 01411000
@DL00463 DS    0H                                                  0464 01412000
*           /* ISSUE STOW MACRO TO CHANGE THE USERID IN THE UADS   0464 01413000
*              DIRECTORY. IF IT IS SUCCESSFUL, INCREMENT THE EXTENT     01414000
*              NUMBER AND REPEAT THE PROCESS UNTIL ALL MEMBER BLOCKS    01415000
*              HAVE BEEN CHANGED.  */                              0464 01416000
*           UADSUSER = NEWUSER;       /* INSERT THE NEW USERID INTO     01417000
*                                        THE HEADER                  */ 01418000
         MVC   UADSUSER(8,HEDBPTR),NEWUSER                         0464 01419000
*           HEDBPTR = HEDBPTR+        /* POINT TO NEXT SUB-HEADER    */ 01420000
*             UADSBLNG;                                            0465 01421000
         AH    HEDBPTR,UADSBLNG(,HEDBPTR)                          0465 01422000
*           GEN (STOW  UADDCB2,STOWLIST,C)                         0466 01423000
*             REFS(STOWLIST,UADDCB2);                              0466 01424000
         STOW  UADDCB2,STOWLIST,C                                       01425000
*           RFY R15 RSTD;             /* RESTRICT RETURN CODE REG    */ 01426000
*           RETCODE = R15;            /* SAVE THE RETURN CODE        */ 01427000
         ST    R15,RETCODE                                         0468 01428000
*           RFY R15 UNRSTD;           /* RELEASE RETURN CODE REG     */ 01429000
*           INDEX = INDEX+1;          /* INCREMENT USERID INDEX      */ 01430000
         LA    INDEX,1(,INDEX)                                     0470 01431000
*           OLDIND = INDEX;           /* PUT INDEX INTO OLD NAME     */ 01432000
         STC   INDEX,OLDIND(,OLDINDP)                              0471 01433000
*           NEWIND = INDEX;           /* PUT INDEX INTO NEW NAME     */ 01434000
         STC   INDEX,NEWIND(,NEWINDP)                              0472 01435000
*           /* CHECK FOR ERROR CONDITION.                            */ 01436000
*           IF RETCODE = 4            /* NEW USERID ALREADY IN THE 0473 01437000
*                                        DIRECTORY?                  */ 01438000
*             THEN                    /* YES,                        */ 01439000
         L     @10,RETCODE                                         0473 01440000
         C     @10,@CF00049                                        0473 01441000
         BNE   @RF00473                                            0473 01442000
*               DO;                                                0474 01443000
*               USRLEN = DUSRLEN;     /* SWITCH LENGTH OF NEW USERID */ 01444000
         IC    @10,DUSRLEN                                         0475 01445000
         STC   @10,USRLEN                                          0475 01446000
*               USRID = DUSRID;       /* SWITCH NAME OF NEW USERID   */ 01447000
         MVC   USRID(8),DUSRID                                     0476 01448000
*               MSGNO = 6;            /* SET MESSAGE NUMBER          */ 01449000
         LA    MSGNO,6                                             0477 01450000
*               GOTO MPREP2;          /* GO CONSTRUCT THE MSG        */ 01451000
         B     MPREP2                                              0478 01452000
*               END;                                               0479 01453000
*           IF RETCODE ^= 0           /* CHECK FOR ANY ERROR         */ 01454000
*             THEN                    /* NO, THIS IS A STOW ERROR    */ 01455000
@RF00473 L     @10,RETCODE                                         0480 01456000
         LTR   @10,@10                                             0480 01457000
         BZ    @RF00480                                            0480 01458000
*               DO;                                                0481 01459000
*               MSGNO = 18;           /* SET MESSAGE NUMBER          */ 01460000
         LA    MSGNO,18                                            0482 01461000
*               GOTO MLMSG;           /* GO CONSTRUCT THE MSG        */ 01462000
         B     MLMSG                                               0483 01463000
*               END;                                               0484 01464000
*           END;                                                   0485 01465000
@RF00480 DS    0H                                                  0485 01466000
@DE00463 LA    @10,240                                             0485 01467000
         SLR   @02,@02                                             0485 01468000
         IC    @02,ACIONMBR                                        0485 01469000
         OR    @10,@02                                             0485 01470000
         CR    INDEX,@10                                           0485 01471000
         BL    @DL00463                                            0485 01472000
*         NEWUSFLG='1'B;              /* INDICATE USERID WAS CHANGED */ 01473000
         OI    NEWUSFLG,B'00000100'                                0486 01474000
*WRTREE:  /* PREPARE TO CALL THE WRITE ROUTINE (IKJEFA52).           */ 01475000
*         ACIOFL05 = '1'B;            /* 1- WRITE OPERATION REQUESTD */ 01476000
WRTREE   OI    ACIOFL05,B'00001000'                                0487 01477000
*         RFY R1 RSTD;                /* RESTRICT PARAMETER REGISTER */ 01478000
*         R1 = ADDR(ACIOPARM);        /* PTR TO 'WRITE' PARMLIST     */ 01479000
         LA    R1,ACIOPARM                                         0489 01480000
*         /* PASS CONTROL TO THE ACCOUNT/WRITE ROUTINE.              */ 01481000
*         CALL IKJEFA52;                                           0490 01482000
         L     @15,@CV00150                                        0490 01483000
         BALR  @14,@15                                             0490 01484000
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REGISTER  */ 01485000
*         RFY R15 RSTD;               /* RESTRICT RETURN CODE REG    */ 01486000
*         RETCODE = R15;              /* ASSIGN THE RETURN CODE      */ 01487000
         ST    R15,RETCODE                                         0493 01488000
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */ 01489000
*         /* DEQ FROM THE USERID.                                    */ 01490000
*         GEN (DEQ   (,USRLEN),MF=(E,USERDEQ))                     0495 01491000
*            REFS(MAJNAME,USRLEN,USERDEQ);                         0495 01492000
         DEQ   (,USRLEN),MF=(E,USERDEQ)                                 01493000
*         ENQFLG = '0'B;              /* 0- USERID IS NOT ENQ'ED ON  */ 01494000
         NI    ENQFLG,B'11111110'                                  0496 01495000
*         FREEFLG = '0'B;             /* 0- READ BUFFER HAS BEEN   0497 01496000
*                                        FREED BY THE WRITE RTNE     */ 01497000
         NI    FREEFLG,B'11111110'                                 0497 01498000
*         /* CHECK THE WRITE RTNE RETURN CODE.                       */ 01499000
*         IF RETCODE ^= 0             /* SUCCESSFUL?                 */ 01500000
*           THEN                      /* NO, I/O ERROR,              */ 01501000
         L     @10,RETCODE                                         0498 01502000
         LTR   @10,@10                                             0498 01503000
         BNZ   @RT00498                                            0498 01504000
*             GOTO ACCTRET;           /* WRITE ISSUES I/O ERROR MSGS */ 01505000
*         TREEFLG = '1'B;             /* 1- A TREE HAS BEEN CHANGED  */ 01506000
         OI    TREEFLG,B'01000000'                                 0500 01507000
*         /* CHECK WHETHER THE NEW PROCSIZE WAS REDUCED TO MAXSIZE.  */ 01508000
*         /* THE USER WILL BE INFORMED OF THIS ACTION.               */ 01509000
*         IF STGFLG = '1'B                                         0501 01510000
*           THEN                      /* YES, ISSUE MSG              */ 01511000
         TM    STGFLG,B'00010000'                                  0501 01512000
         BNO   @RF00501                                            0501 01513000
*             DO;                                                  0502 01514000
*               CNTNFLG = '1'B;       /* TURN CONTINUATION FLAG ON   */ 01515000
         OI    CNTNFLG,B'00100000'                                 0503 01516000
*               MSGNO = 14;           /* SET MESSAGE NUMBER          */ 01517000
         LA    MSGNO,14                                            0504 01518000
*               CALL MSGFNDR;         /* GO CALCULATE THE MSG ADDR   */ 01519000
         BAL   @14,MSGFNDR                                         0505 01520000
*               INSRTL1 = RSIZLNG+4;  /* LENGTH OF MSG SEGMENT       */ 01521000
         LA    @10,4                                               0506 01522000
         L     @05,CHPDLPTR                                        0506 01523000
         LH    @15,RSIZLNG(,@05)                                   0506 01524000
         LR    @14,@15                                             0506 01525000
         ALR   @14,@10                                             0506 01526000
         STH   @14,INSRTL1                                         0506 01527000
*               INSRTT1(1:RSIZLNG) = SIZE;/* INSERT SIZE INTO MSG    */ 01528000
         BCTR  @15,0                                               0507 01529000
         L     @05,RSIZADR(,@05)                                   0507 01530000
         EX    @15,@SM00452                                        0507 01531000
*               SEGPTR13 = ADDR(INSRT1);/* ACTIVE SIZE INSERT ADDR   */ 01532000
         LA    @05,INSRT1                                          0508 01533000
         ST    @05,SEGPTR13                                        0508 01534000
*               INSRTL2 = USRLEN+4;   /* LENGTH OF MSG SEGMENT       */ 01535000
         SLR   @05,@05                                             0509 01536000
         IC    @05,USRLEN                                          0509 01537000
         ALR   @10,@05                                             0509 01538000
         STH   @10,INSRTL2                                         0509 01539000
*               INSRTT2(1:USRLEN) = USRID;/* INSERT THE USERID       */ 01540000
         BCTR  @05,0                                               0510 01541000
         EX    @05,@SM00454                                        0510 01542000
*               SEGPTR15 = ADDR(INSRT2);/* SET PTR TO THIS SEGMENT   */ 01543000
         LA    @10,INSRT2                                          0511 01544000
         ST    @10,SEGPTR15                                        0511 01545000
*               GOTO PUTMSG;          /* CONTINUE MSG CONSTRUCTION   */ 01546000
         B     PUTMSG                                              0512 01547000
*             END;                                                 0513 01548000
*           ELSE                      /* NO,                         */ 01549000
*             GOTO MORUS;             /* GO CHECK FOR MORE USERIDS   */ 01550000
*         /***********************************************************/ 01551000
*         /*                                                         */ 01552000
*         /*                 MESSAGE  HANDLING                       */ 01553000
*         /*                                                         */ 01554000
*         /***********************************************************/ 01555000
*MSG3:    /* CONTROL PASSED HERE TO DETERMINE WHETHER THIS PARTICU-  */ 01556000
*         /* LAR MESSAGE REQUIRES USERID INSERTION OR NOT.           */ 01557000
*         IF USIND = '1'B             /* INSERTION REQUIRED?         */ 01558000
*          & ACIOLINK ^= 0            /* AND DIRECTORY READ          */ 01559000
*           THEN                      /* YES,                        */ 01560000
MSG3     TM    USIND,B'10000000'                                   0515 01561000
         BNO   @RF00515                                            0515 01562000
         L     @10,ACIOLINK                                        0515 01563000
         LTR   @10,@10                                             0515 01564000
         BZ    @RF00515                                            0515 01565000
*             DO;                                                  0516 01566000
*             MSGNO = 4;              /* SET MESSAGE NUMBER          */ 01567000
         LA    MSGNO,4                                             0517 01568000
*             GOTO MPREP1;            /* CONTINUE MSG CONSTRUCTION   */ 01569000
         B     MPREP1                                              0518 01570000
*             END;                                                 0519 01571000
*           ELSE                      /* NO,                         */ 01572000
*             MSGNO = 3;              /* SET MESSAGE NUMBER          */ 01573000
@RF00515 LA    MSGNO,3                                             0520 01574000
*TMSGA:   CALL MSGFNDR;               /* GO CALCULATE MSG ADDR       */ 01575000
TMSGA    BAL   @14,MSGFNDR                                         0521 01576000
*         GOTO PUTMSG;                /* GO ISSUE THE MSG            */ 01577000
         B     PUTMSG                                              0522 01578000
*MLMSG:   /* CONTROL PASSED HERE FOR MULTI-LEVEL MESSAGES.           */ 01579000
*         CALL MSGFNDR;               /* GO CALCULATE MSG ADDR       */ 01580000
MLMSG    BAL   @14,MSGFNDR                                         0523 01581000
*         CVD (RETCODE,DECRTCD);      /* CONVERT CODE TO DECIMAL     */ 01582000
         L     @10,RETCODE                                         0524 01583000
         CVD   @10,DECRTCD                                         0524 01584000
*         UNPK (INSRTT1(1:2),DECRTCD(6:8));/* UNPACK INTO MSG.       */ 01585000
         UNPK  INSRTT1(2),DECRTCD+5(3)                             0525 01586000
*         INSRTL1 = 6;                /* SET LENGTH OF SEGMENT       */ 01587000
         MVC   INSRTL1(2),@CH00398                                 0526 01588000
*         INSRTT1(2) = INSRTT1(2)|'F0'X; /* REMOVE SIGN              */ 01589000
         OI    INSRTT1+1,X'F0'                                     0527 01590000
*         SEGPTR23 = ADDR(INSRT1);    /* SET PTR TO ACTIVE INSERT    */ 01591000
         LA    @10,INSRT1                                          0528 01592000
         ST    @10,SEGPTR23                                        0528 01593000
*         GOTO PUTMSG;                /* GO ISSUE THE MESSAGE        */ 01594000
         B     PUTMSG                                              0529 01595000
*MPREP1:  CNTNFLG = '1'B;             /* TURN CONTINUATION FLAG ON   */ 01596000
MPREP1   OI    CNTNFLG,B'00100000'                                 0530 01597000
*MPREP2:  /* CONTROL IS PASSED TO APPROPRIATE PARTS OF THIS SECTION  */ 01598000
*         /* TO COMPLETE THE CONSTRUCTION OF INSERTION-TYPE MESSAGES */ 01599000
*         CALL MSGFNDR;               /* GO CALCULATE THE MSG ADDR   */ 01600000
MPREP2   BAL   @14,MSGFNDR                                         0531 01601000
*MPREP3:  /* INITIALIZE THE USERID INSERT SEGMENT.                   */ 01602000
*         INSRTL1 = USRLEN+4;         /* LENGTH OF MSG SEGMENT       */ 01603000
MPREP3   SLR   @10,@10                                             0532 01604000
         IC    @10,USRLEN                                          0532 01605000
         LA    @10,4(,@10)                                         0532 01606000
         STH   @10,INSRTL1                                         0532 01607000
*         INSRTT1 = USRID;            /* INSERT THE USERID           */ 01608000
         MVC   INSRTT1(8),USRID                                    0533 01609000
*         SEGPTR13 = ADDR(INSRT1);    /* SET PTR TO ACTIVE INSERT    */ 01610000
         LA    @10,INSRT1                                          0534 01611000
         ST    @10,SEGPTR13                                        0534 01612000
*         GOTO PUTMSG;                /* GO ISSUE THE MSG            */ 01613000
         B     PUTMSG                                              0535 01614000
*MPREP4:  CALL MSGFNDR;               /* GO CALCULATE THE MSG ADDR   */ 01615000
MPREP4   BAL   @14,MSGFNDR                                         0536 01616000
*         SEGPTR13 = ADDR(INSRT2);    /* SET PTR TO ACTIVE INSERT    */ 01617000
         LA    @10,INSRT2                                          0537 01618000
         ST    @10,SEGPTR13                                        0537 01619000
*PUTMSG:  /* PREPARE TO CALL THE PUTLINE SERVICE ROUTINE.            */ 01620000
*         GEN (PUTLINE OUTPUT=(AMSGHDR1,,MULTLVL),MF=(E,PLPLIST))  0538 01621000
*           REFS(AMSGHDR1,PLPLIST);                                0538 01622000
PUTMSG   PUTLINE OUTPUT=(AMSGHDR1,,MULTLVL),MF=(E,PLPLIST)              01623000
*         RFY R15 RSTD;               /* RESTRICT ENTRY POINT REG    */ 01624000
*         RETCODE = R15;              /* ASSIGN THE RETURN CODE      */ 01625000
         ST    R15,RETCODE                                         0540 01626000
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */ 01627000
*         /* CHECK THE PUTLINE RETURN CODE.                          */ 01628000
*         IF RETCODE ^= 0             /* SUCCESSFUL?                 */ 01629000
*           THEN                      /* NO,                         */ 01630000
         L     @10,RETCODE                                         0542 01631000
         LTR   @10,@10                                             0542 01632000
         BZ    @RF00542                                            0542 01633000
*             DO;                                                  0543 01634000
*             IF RETCODE = 4          /* ATTENTION INTERRUPT?        */ 01635000
*                | PUTLFLG = '1'B     /* OR SECOND ATTEMPT TO PUT OUT   01636000
*                                        A MESSAGE?                  */ 01637000
*               THEN                  /* YES, ONE OF THE ABOVE       */ 01638000
         C     @10,@CF00049                                        0544 01639000
         BE    @RT00544                                            0544 01640000
         TM    PUTLFLG,B'00000010'                                 0544 01641000
         BO    @RT00544                                            0544 01642000
*                 GOTO ACCTRET;       /* RETURN TO ACCOUNT           */ 01643000
*             PUTLFLG = '1'B;         /* SET FLAG - ONE ATTEMPT HAS     01644000
*                                        BEEN MADE TO PUT OUT A MSG  */ 01645000
         OI    PUTLFLG,B'00000010'                                 0546 01646000
*             POSTFLG = '0'B;         /* AN ERROR OCCURRED - THE ECB    01647000
*                                        WILL BE POSTED              */ 01648000
         NI    POSTFLG,B'01111111'                                 0547 01649000
*             IF RETCODE = 16         /* GETMAIN FAILURE?            */ 01650000
*               THEN                  /* YES,                        */ 01651000
         C     @10,@CF00042                                        0548 01652000
         BE    @RT00548                                            0548 01653000
*                 GOTO MSG3;          /* GO CONSTRUCT THE MESSAGE    */ 01654000
*               ELSE                  /* NO, RETCODE = 12            */ 01655000
*                 DO;                                              0550 01656000
*                   MSGNO = 22;       /* SET MSG NUMBER              */ 01657000
         LA    MSGNO,22                                            0551 01658000
*                   GOTO MLMSG;       /* GO CONSTRUCT THE MSG        */ 01659000
         B     MLMSG                                               0552 01660000
*                 END;                                             0553 01661000
*             END;                                                 0554 01662000
*         /* PUTLINE WAS SUCCESSFUL. CHECK WHETHER TO CONTINUE WITH  */ 01663000
*         /* ANOTHER USERID OR TO RETURN.                            */ 01664000
*         IF CNTNFLG = '0'B                                        0555 01665000
*           THEN                      /* FINISHED,                   */ 01666000
@RF00542 TM    CNTNFLG,B'00100000'                                 0555 01667000
         BZ    @RT00555                                            0555 01668000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN        */ 01669000
*         CNTNFLG = '0'B;             /* RESET THE CONTINUATION FLAG */ 01670000
         NI    CNTNFLG,B'11011111'                                 0557 01671000
*         GOTO MORUS;                 /* GO CHECK FOR MORE USERIDS   */ 01672000
         B     MORUS                                               0558 01673000
*         /* CHECK WHETHER A PREVIOUS USERID TREE WAS SUCCESSFULLY   */ 01674000
*         /* CHANGED ('*' IN THE USERID POSITION OF THE NODELIST).   */ 01675000
*         /* IF SO, THEN THE MODE MSG 'CHANGED' WILL BE ISSUED, IN-  */ 01676000
*         /* DICATING SUCCESSFUL COMPLETION.                         */ 01677000
*CHKCHNG: IF TREEFLG = '1'B                                        0559 01678000
*           THEN                      /* PREVIOUS TREE WAS CHANGED,  */ 01679000
CHKCHNG  TM    TREEFLG,B'01000000'                                 0559 01680000
         BNO   @RF00559                                            0559 01681000
*             DO;                                                  0560 01682000
*             POSTFLG = '1'B;         /* CHANGE WAS SUCCESSFUL - DO     01683000
*                                        NOT POST THE ECB            */ 01684000
         OI    POSTFLG,B'10000000'                                 0561 01685000
*             MSGNO =1;               /* SET MESSAGE NUMBER          */ 01686000
         LA    MSGNO,1                                             0562 01687000
*             GOTO TMSGA;             /* ISSUE MODE MSG              */ 01688000
         B     TMSGA                                               0563 01689000
*             END;                                                 0564 01690000
*         IF CHLEVL = 1               /* CHANGE LVL = USERID LELEL?  */ 01691000
*           THEN                      /* YES,                        */ 01692000
@RF00559 CLI   CHLEVL,1                                            0565 01693000
         BE    @RT00565                                            0565 01694000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN        */ 01695000
*         /* IF THE CHANGE LEVEL IS THE PASSWORD LEVEL AND NO USER   */ 01696000
*         /* IN THE UADS WAS FOUND WITH PASSWORD SUPPORT, AND THE    */ 01697000
*         /* NODELIST PASSWORD = '*', THEN A MESSAGE TO THIS EFFECT  */ 01698000
*         /* WILL BE ISSUED TO THE TERMINAL.                         */ 01699000
*         IF (CHLEVL = 2              /* CHANGE LVL = PASSWORD LVL?  */ 01700000
*          | PASSWD(1:2) ^= '* ')     /* OR A PASSWORD WAS SPECIFIED?*/ 01701000
*          & PWSUPFLG = '0'B          /* AND PASSWORDS NOT SUPPORTED?*/ 01702000
*          & USIND = '1'B             /* AND USERID = *?             */ 01703000
*          & MSGNO = 0                /* AND NO ERROR MESSAGE?       */ 01704000
*           THEN                      /* YES,                        */ 01705000
         CLI   CHLEVL,2                                            0567 01706000
         BE    @GL00011                                            0567 01707000
         CLC   PASSWD(2),@CC00380                                  0567 01708000
         BE    @RF00567                                            0567 01709000
@GL00011 TM    USIND,B'10000000'                                   0567 01710000
         BNO   @RF00567                                            0567 01711000
         TM    PWSUPFLG,B'00001000'                                0567 01712000
         BNZ   @RF00567                                            0567 01713000
         LTR   MSGNO,MSGNO                                         0567 01714000
         BNZ   @RF00567                                            0567 01715000
*             DO;                                                  0568 01716000
*             MSGNO = 26;             /* SET ERROR MESSAGE NUMBER    */ 01717000
         LA    MSGNO,26                                            0569 01718000
*             GOTO TMSGA;             /* GO ISSUE THE MESSAGE        */ 01719000
         B     TMSGA                                               0570 01720000
*             END;                                                 0571 01721000
*         IF PASSWD(1:2) ^= '* '      /* WAS A PASSWORD SPECIFIED?   */ 01722000
*          & PWFNDFLG = '0'B          /* AND PASSWORD NOT FOUND?     */ 01723000
*           THEN                      /* YES,                        */ 01724000
@RF00567 CLC   PASSWD(2),@CC00380                                  0572 01725000
         BE    @RF00572                                            0572 01726000
         TM    PWFNDFLG,B'01000000'                                0572 01727000
         BNZ   @RF00572                                            0572 01728000
*             DO;                                                  0573 01729000
*             MSGNO = 10;             /* SET MSG NUMBER              */ 01730000
         LA    MSGNO,10                                            0574 01731000
*             INSRTL2 = 12;           /* LENGTH OF MSG SEGMENT       */ 01732000
         MVC   INSRTL2(2),@CH00350                                 0575 01733000
*             INSRTT2(1:8) = PASSWD;  /* INSERT THE PASSWORD         */ 01734000
         MVC   INSRTT2(8),PASSWD                                   0576 01735000
*             GOTO MPREP4;            /* GO TO ISSUE MESSAGE         */ 01736000
         B     MPREP4                                              0577 01737000
*             END;                                                 0578 01738000
*         /* IF THE CHANGE LEVEL IS THE PASSWORD LEVEL, THEN BYPASS  */ 01739000
*         /* THE MODE MESSAGE SINCE NO USEFUL WORK WAS DONE. IF NOT, */ 01740000
*         /* THEN FURTHER CHECKING IS NECESSARY ON THE ACCTNMBR      */ 01741000
*         /* AND/OR PROCNAME LEVEL.                                  */ 01742000
*         IF CHLEVL = 2               /* CHANGE LVL = PASSWORD LVL?  */ 01743000
*           THEN                      /* YES,                        */ 01744000
@RF00572 CLI   CHLEVL,2                                            0579 01745000
         BE    @RT00579                                            0579 01746000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN        */ 01747000
*         /* IF THE CHANGE LEVEL IS THE ACCTNMBR LEVEL AND NO USER   */ 01748000
*         /* IN THE UADS WAS FOUND WITH ACCTNMBR SUPPORT, AND THE    */ 01749000
*         /* NODELIST ACCTNMBR = '*', THEN A MESSAGE TO THIS EFFECT  */ 01750000
*         /* WILL BE ISSUED TO THE TERMINAL.                         */ 01751000
*         IF (CHLEVL = 3               /* CHANGE LVL = ACCTNMBR LVL?  * 01752000
*          | ACCTNO(1:2) ^= '* ')     /* OR AN ACCTNMBR SPECIFIED?   */ 01753000
*          & ACSUPFLG = '0'B          /* AND ACCTNMBRS NOT SUPPORTED?*/ 01754000
*          & USIND = '1'B             /* AND USERID = *?             */ 01755000
*          & MSGNO = 0                /* AND NO ERROR MESSAGE?       */ 01756000
*           THEN                      /* YES,                        */ 01757000
         CLI   CHLEVL,3                                            0581 01758000
         BE    @GL00015                                            0581 01759000
         CLC   ACCTNO(2),@CC00380                                  0581 01760000
         BE    @RF00581                                            0581 01761000
@GL00015 TM    USIND,B'10000000'                                   0581 01762000
         BNO   @RF00581                                            0581 01763000
         TM    ACSUPFLG,B'00000100'                                0581 01764000
         BNZ   @RF00581                                            0581 01765000
         LTR   MSGNO,MSGNO                                         0581 01766000
         BNZ   @RF00581                                            0581 01767000
*             DO;                                                  0582 01768000
*             MSGNO = 27;             /* SET ERROR MESSAGE NUMBER    */ 01769000
         LA    MSGNO,27                                            0583 01770000
*             GOTO TMSGA;             /* GO ISSUE THE MESSAGE        */ 01771000
         B     TMSGA                                               0584 01772000
*             END;                                                 0585 01773000
*         IF ACCTNO(1:2) ^= '* '      /* WAS AN ACCTNMBR SPECIFIED?  */ 01774000
*          & ACFNDFLG = '0'B          /* AND ACCTNMBR NOT FOUND?     */ 01775000
*           THEN                      /* YES,                        */ 01776000
@RF00581 CLC   ACCTNO(2),@CC00380                                  0586 01777000
         BE    @RF00586                                            0586 01778000
         TM    ACFNDFLG,B'00100000'                                0586 01779000
         BNZ   @RF00586                                            0586 01780000
*             DO;                                                  0587 01781000
*             MSGNO = 11;             /* SET MSG NUMBER              */ 01782000
         LA    MSGNO,11                                            0588 01783000
*             INSRTL2 = ACTLEN+4;     /* LENGTH OF MSG SEGMENT       */ 01784000
         SLR   @10,@10                                             0589 01785000
         IC    @10,ACTLEN                                          0589 01786000
         LA    @05,4(,@10)                                         0589 01787000
         STH   @05,INSRTL2                                         0589 01788000
*             INSRTT2(1:ACTLEN) = ACCTNO;/* INSERT THE ACCTNMBR      */ 01789000
         BCTR  @10,0                                               0590 01790000
         EX    @10,@SM00456                                        0590 01791000
*             GOTO MPREP4;            /* GO TO ISSUE MESSAGE         */ 01792000
         B     MPREP4                                              0591 01793000
*             END;                                                 0592 01794000
*         /* NO TREE WAS CHANGED - THE ACCOUNT ECB WILL BE POSTED. 0593 01795000
*            IF THE CHANGE LEVEL IS THE ACCTNMBR LEVEL & THE NODE- 0593 01796000
*            LIST SPECIFIES AN ACCTNMBR, THEN GO CHECK WHETHER THIS     01797000
*            ACCTNMBR WAS FOUND.                                     */ 01798000
*         IF CHLEVL = 3               /* CHANGE LVL = ACCTNMBR LVL?  */ 01799000
*           THEN                      /* YES,                        */ 01800000
@RF00586 CLI   CHLEVL,3                                            0593 01801000
         BE    @RT00593                                            0593 01802000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN        */ 01803000
*         IF PROCNM(1) = '*'          /* WAS PROCNAME SPECIFIED?     */ 01804000
*           THEN                      /* YES, GO CHECK WHETHER THE.. */ 01805000
         CLI   PROCNM,C'*'                                         0595 01806000
         BE    @RT00595                                            0595 01807000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN        */ 01808000
*         /* THE SPECIFIED PROCNAME MAY HAVE BEEN FOUND IN ONE OR    */ 01809000
*         /* MORE TREES, BUT NO CHANGES WERE MADE BECAUSE OF ERROR   */ 01810000
*         /* CONDITION(S). THE MODE MESSAGE WILL NOT BE ISSUED,      */ 01811000
*         /* INDICATING THAT NO USEFUL WORK WAS DONE.                */ 01812000
*         IF PRFNDFLG = '1'B          /* PROCNAME FOUND?             */ 01813000
*           THEN                      /* YES,                        */ 01814000
         TM    PRFNDFLG,B'00010000'                                0597 01815000
         BO    @RT00597                                            0597 01816000
*             GOTO ACCTRET;           /* GO CLEAN UP & RETURN        */ 01817000
*           ELSE                      /* PROCNAME DOES NOT EXIST,    */ 01818000
*             DO;                                                  0599 01819000
*               MSGNO = 12;           /* SET MSG NUMBER              */ 01820000
         LA    @10,12                                              0600 01821000
         LR    MSGNO,@10                                           0600 01822000
*               INSRTL2 = 12;         /* LENGTH OF SEGMENT           */ 01823000
         STH   @10,INSRTL2                                         0601 01824000
*               INSRTT2(1:8) = PROCNM;/* INSERT THE PROCNAME         */ 01825000
         MVC   INSRTT2(8),PROCNM                                   0602 01826000
*               GOTO MPREP4;          /* GO TO ISSUE MESSAGE         */ 01827000
         B     MPREP4                                              0603 01828000
*             END;                                                 0604 01829000
*ACCTRET: /***********************************************************/ 01830000
*         /*                                                         */ 01831000
*         /*        PERFORM THE NECESSARY CLEANUP AND                */ 01832000
*         /*        RETURN TO THE ACCOUNT COMMAND PROCESSOR          */ 01833000
*         /*                                                         */ 01834000
*         /***********************************************************/ 01835000
*         IF ENQUAFLG = '1'B          /* IS THE UADS ENQUEUED ON     */ 01836000
*           THEN                      /* YES,                        */ 01837000
ACCTRET  TM    ENQUAFLG,B'00000010'                                0605 01838000
         BNO   @RF00605                                            0605 01839000
*             DO;                                                  0606 01840000
*             GEN (DEQ   ,MF=(E,UADDEQ))  /* DEQ FROM THE UADS.      */ 01841000
*               REFS(MAJNAME,MINNAME,UADDEQ);                      0607 01842000
         DEQ   ,MF=(E,UADDEQ)                                           01843000
*             ENQUAFLG = '0'B;        /* RE-INIT UADS ENQ FLAG       */ 01844000
         NI    ENQUAFLG,B'11111101'                                0608 01845000
*             END;                                                 0609 01846000
*         IF ENQFLG = '1'B            /* IS THE USERID STILL ENQ'ED  */ 01847000
*           THEN                      /* YES,                        */ 01848000
@RF00605 TM    ENQFLG,B'00000001'                                  0610 01849000
         BNO   @RF00610                                            0610 01850000
*             DO;                                                  0611 01851000
*             GEN (DEQ   (,USRLEN),MF=(E,USERDEQ))                 0612 01852000
*               REFS(MAJNAME,USRLEN,USERDEQ);                      0612 01853000
         DEQ   (,USRLEN),MF=(E,USERDEQ)                                 01854000
*             ENQFLG = '0'B;          /* 0- USERID IS NOT ENQ'ED ON  */ 01855000
         NI    ENQFLG,B'11111110'                                  0613 01856000
*             END;                                                 0614 01857000
*         /* CHECK WHETHER THE BUFFER OBTAINED BY THE READ ROUTINE   */ 01858000
*         /* FOR THE USERID TREE HAS TO BE FREED. IF YES, THEN PASS  */ 01859000
*         /* CONTROL TO THE WRITE ROUTINE (IKJEFA52) TO FREEMAIN     */ 01860000
*         /* THE BUFFER.                                             */ 01861000
*         IF FREEFLG ^= '0'B          /* DOES THE BUFFER HAVE TO BE     01862000
*                                        FREED?                      */ 01863000
*           THEN                      /* YES,                        */ 01864000
@RF00610 TM    FREEFLG,B'00000001'                                 0615 01865000
         BZ    @RF00615                                            0615 01866000
*             DO;                                                  0616 01867000
*             ACIOFL05 = '0'B;        /* 0- WRITE OPERATION NOT    0617 01868000
*                                        REQUESTED - FREEMAIN ONLY   */ 01869000
         NI    ACIOFL05,B'11110111'                                0617 01870000
*             RFY R1 RSTD;            /* RESTRICT PARAMETER REGISTER */ 01871000
*             R1 = ADDR(ACIOPARM);    /* PTR TO THE PARMLIST         */ 01872000
         LA    R1,ACIOPARM                                         0619 01873000
*             CALL IKJEFA52;                                       0620 01874000
         L     @15,@CV00150                                        0620 01875000
         BALR  @14,@15                                             0620 01876000
*             RFY R1 UNRSTD;          /* RELEASE PARAMETER REGISTER  */ 01877000
*             END;                                                 0622 01878000
*         /* CLOSE THE UADS DCB'S, BPAM AND BSAM.                    */ 01879000
*         RFY R2 RSTD;                                             0623 01880000
@RF00615 DS    0H                                                  0624 01881000
*         R2 = ADDR(UADDCB2);         /* ADDR OF THE DCB             */ 01882000
         LA    R2,UADDCB2                                          0624 01883000
*         /* IS THE BPAM DCB OPEN?                                   */ 01884000
*         IF DCBOFLAG = '1'B                                       0625 01885000
*           THEN                      /* YES,                        */ 01886000
         TM    DCBOFLAG,B'00010000'                                0625 01887000
         BNO   @RF00625                                            0625 01888000
*             GEN (CLOSE ((R2),REREAD),MF=(E,CLOSUAD))             0626 01889000
*               REFS(R2,CLOSUAD);                                  0626 01890000
         CLOSE ((R2),REREAD),MF=(E,CLOSUAD)                             01891000
*         /* IS THE BSAM DCB OPEN?                                   */ 01892000
*         R2 = ADDR(UADSDCB);         /* SET BASE PTR FOR LABELS     */ 01893000
@RF00625 LA    R2,UADSDCB                                          0627 01894000
*         IF DCBOFLAG = '1'B                                       0628 01895000
*           THEN                      /* YES,                        */ 01896000
         TM    DCBOFLAG,B'00010000'                                0628 01897000
         BNO   @RF00628                                            0628 01898000
*             GEN (CLOSE ((R2),REREAD),MF=(E,CLOSUAD))             0629 01899000
*               REFS(R2,CLOSUAD);                                  0629 01900000
         CLOSE ((R2),REREAD),MF=(E,CLOSUAD)                             01901000
*         RFY R2 UNRSTD;                                           0630 01902000
@RF00628 DS    0H                                                  0631 01903000
*         /* WHENEVER A USERID IS CHANGED IN THE UADS, A USERID      */ 01904000
*         /* DATA LIST (UIDL) MUST BE BUILT FOR ACCOUNT.             */ 01905000
*         /* CHECK WHETHER A USERID WAS CHANGED.                     */ 01906000
*         IF NEWUSFLG = '0'B                                       0631 01907000
*          | TREEFLG = '0'B                                        0631 01908000
*           THEN                      /* YES,                        */ 01909000
         TM    NEWUSFLG,B'01000100'                                0631 01910000
         BO    @RF00631                                            0631 01911000
*             DO;                                                  0632 01912000
*             UIDLPTR = 0;            /* SET PTR TO UIDL TO 0,       */ 01913000
         L     @10,ACCTPLP                                         0633 01914000
         SLR   @15,@15                                             0633 01915000
         ST    @15,UIDLPTR(,@10)                                   0633 01916000
*             GOTO FREEPDL;           /* AND BYPASS UIDL SECTION     */ 01917000
         B     FREEPDL                                             0634 01918000
*             END;                                                 0635 01919000
*         /* BUILD THE USERID DATA LIST (UIDL).                      */ 01920000
*         UIDLADR = 0;                /* INITIALIZE THE PTR TO MAKE     01921000
*                                        SURE THE HIGH-ORDER BYTE  0636 01922000
*                                        WILL BE ZERO                */ 01923000
@RF00631 SLR   @10,@10                                             0636 01924000
         ST    @10,UIDLADR                                         0636 01925000
*         GEN (GETMAIN ,LV=24,A=UIDLADR,MF=(E,DYNGTLST))           0637 01926000
*           SETS(UIDLADR) REFS(DYNGTLST);                          0637 01927000
         GETMAIN ,LV=24,A=UIDLADR,MF=(E,DYNGTLST)                       01928000
*         RFY R15 RSTD;               /* RESTRICT RETURN CODE REG    */ 01929000
*         RETCODE = R15;              /* SAVE GETMAIN RETURN CODE    */ 01930000
         ST    R15,RETCODE                                         0639 01931000
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */ 01932000
*         /* CHECK THE GETMAIN RETURN CODE.                          */ 01933000
*         IF RETCODE ^= 0                                          0641 01934000
*           THEN                      /* GETMAIN FAILED              */ 01935000
         L     @10,RETCODE                                         0641 01936000
         SLR   @15,@15                                             0641 01937000
         CR    @10,@15                                             0641 01938000
         BNE   @RT00641                                            0641 01939000
*             GOTO MSG3;              /* GO CONSTRUCT THE MESSAGE    */ 01940000
*         /* GETMAIN WAS SUCCESSFUL, BUILD THE USERID DATA LIST.     */ 01941000
*         UIDLPTR = UIDLADR;          /* TRANSFER PTR TO ACCT PLIST  */ 01942000
         L     @10,UIDLADR                                         0643 01943000
         L     @01,ACCTPLP                                         0643 01944000
         ST    @10,UIDLPTR(,@01)                                   0643 01945000
*         UIDLNEX = 0;                /* THIS IS THE ONLY LIST       */ 01946000
         ST    @15,UIDLNEX(,@10)                                   0644 01947000
*         UIDLSWS = '0000'X;          /* SET FLAGS TEMPORARILY TO 0  */ 01948000
         MVC   UIDLSWS(2,@10),@CB00420                             0645 01949000
*         UIDCHG = '1'B;              /* SIGNAL TO ACCOUNT THAT THIS    01950000
*                                        LIST WAS BUILT BY IKJEFA20  */ 01951000
         OI    UIDCHG(@10),B'00100000'                             0646 01952000
*         UIDLCT = 2;                 /* COUNT = 2 FOR ONE PAIR OF 0647 01953000
*                                        USERID'S (OLD & NEW)        */ 01954000
         MVC   UIDLCT(2,@10),@CH00113                              0647 01955000
*         UIDUSER(1) = USRID(1:USRLEN);/* INSERT THE OLD USERID      */ 01956000
         MVI   UIDUSER+1(@10),C' '                                 0648 01957000
         MVC   UIDUSER+2(6,@10),UIDUSER+1(@10)                     0648 01958000
         SLR   @15,@15                                             0648 01959000
         IC    @15,USRLEN                                          0648 01960000
         BCTR  @15,0                                               0648 01961000
         EX    @15,@SM00459                                        0648 01962000
*         UIDUSER(2) = DUSRID(1:DUSRLEN);/* INSERT THE NEW USERID    */ 01963000
         MVI   UIDUSER+9(@10),C' '                                 0649 01964000
         MVC   UIDUSER+10(6,@10),UIDUSER+9(@10)                    0649 01965000
         SLR   @15,@15                                             0649 01966000
         IC    @15,DUSRLEN                                         0649 01967000
         BCTR  @15,0                                               0649 01968000
         EX    @15,@SM00461                                        0649 01969000
*FREEPDL: /* RELEASE THE PDL SPACE, IF NECESSARY.                    */ 01970000
*         IF CHPDLPTR ^= 0            /* IS THERE A PDL TO FREE?     */ 01971000
*           THEN                      /* YES,                        */ 01972000
FREEPDL  L     @10,CHPDLPTR                                        0650 01973000
         LTR   @10,@10                                             0650 01974000
         BZ    @RF00650                                            0650 01975000
*             GEN (IKJRLSA CHPDLPTR)  /* FREE THE PDL SPACE          */ 01976000
*                REFS(CHPDLPTR);                                   0651 01977000
         IKJRLSA CHPDLPTR                                               01978000
*         /* IF CHANGE WAS UNSUCCESSFUL, THE ECB IS POSTED TO SIGNAL */ 01979000
*         /* TO ACCOUNT TO ISSUE THE 'ACCOUNT' MESSAGE.              */ 01980000
*         IF POSTFLG = '0'B                                        0652 01981000
*           THEN                      /* CHANGE WAS NOT SUCCESSFUL   */ 01982000
@RF00650 TM    POSTFLG,B'10000000'                                 0652 01983000
         BNZ   @RF00652                                            0652 01984000
*             ACCTECB = '40FFFFFF'X;                               0653 01985000
         L     @10,ACCTPLP                                         0653 01986000
         L     @10,ACCTECBP(,@10)                                  0653 01987000
         MVC   ACCTECB(4,@10),@CF00422                             0653 01988000
*         RETURN;                                                  0654 01989000
@EL00001 L     @13,4(,@13)                                         0654 01990000
@EF00001 L     @00,@SIZDATD                                        0654 01991000
         LR    @01,@11                                             0654 01992000
         FREEMAIN R,LV=(0),A=(1)                                        01993000
@ER00001 LM    @14,@12,12(@13)                                     0654 01994000
         BR    @14                                                 0654 01995000
*         /* END OF CHANGE COMMAND PROCEDURE                         */ 01996000
*         /***********************************************************/ 01997000
*         /* THIS SUBROUTINE CALCULATES THE ADDRESS OF A MESSAGE IN  */ 01998000
*         /* THE CHANGE MESSAGE CSECT IKJEFA21.                      */ 01999000
*         /***********************************************************/ 02000000
*MSGFNDR: PROC;                                                    0655 02001000
         B     @EL00001                                            0655 02002000
MSGFNDR  STM   @14,@12,12(@13)                                     0655 02003000
*         MSGFIND = (MSGNO*2)-2       /* CALCULATE ADDR OF OFFSET TO */ 02004000
*           +ADDR(CHMSG);             /* MSG IN THE MSG CSECT        */ 02005000
         LR    MSGFIND,MSGNO                                       0656 02006000
         ALR   MSGFIND,MSGFIND                                     0656 02007000
         BCTR  MSGFIND,0                                           0656 02008000
         BCTR  MSGFIND,0                                           0656 02009000
         L     @10,@CV00145                                        0656 02010000
         ALR   MSGFIND,@10                                         0656 02011000
*         MSGPTR = MOFFSET+ADDR(CHMSG);/* CALCULATE ADDR OF MSG    0657 02012000
*                                         HEADER IN THE MSG CSECT    */ 02013000
         L     MSGPTR,@CV00145                                     0657 02014000
         AH    MSGPTR,MOFFSET(,MSGFIND)                            0657 02015000
*         MINDX = (SGNO1*4)+8;        /* NUMBER OF BYTES IN MSGHEADR */ 02016000
         LA    @10,8                                               0658 02017000
         L     MINDX,SGNO1(,MSGPTR)                                0658 02018000
         SLA   MINDX,2                                             0658 02019000
         ALR   MINDX,@10                                           0658 02020000
*         AMSGHDR1(1:MINDX) =         /* TRANSFER MSG HEADER TO..    */ 02021000
*           PTRMASK1;                 /* ..DYNAMIC HEADER AREA       */ 02022000
         LR    @05,MINDX                                           0659 02023000
         BCTR  @05,0                                               0659 02024000
         EX    @05,@SM00463                                        0659 02025000
*         /* IF THIS IS NOT A MULTI-LEVEL MESSAGE, THEN BYPASS THE   */ 02026000
*         /* MESSAGE HEADER TRANSFER.                                */ 02027000
*         IF NXTLADR1 ^= '0'B                                      0660 02028000
*           THEN                      /* YES, MULTI-LEVEL MSG        */ 02029000
         L     @05,NXTLADR1(,MSGPTR)                               0660 02030000
         LTR   @05,@05                                             0660 02031000
         BZ    @RF00660                                            0660 02032000
*             DO;                                                  0661 02033000
*             LEVPTR1 = ADDR(AMSGHDR2);/* POINT TO 2ND LEVEL MSG     */ 02034000
         LA    @15,AMSGHDR2                                        0662 02035000
         ST    @15,LEVPTR1                                         0662 02036000
*             MINDX = (SGNO2*4)+8;    /* NUMBER OF BYTES IN MSGHEADR */ 02037000
         L     MINDX,SGNO2(,@05)                                   0663 02038000
         SLA   MINDX,2                                             0663 02039000
         ALR   MINDX,@10                                           0663 02040000
*             AMSGHDR2(1:MINDX) =     /* TRANSFER MSG HEADER TO..    */ 02041000
*               PTRMASK2;             /* ..DYNAMIC HEADER AREA       */ 02042000
         LR    @10,MINDX                                           0664 02043000
         BCTR  @10,0                                               0664 02044000
         EX    @10,@SM00465                                        0664 02045000
*             END;                                                 0665 02046000
*         END MSGFNDR;                /* RETURN TO POINT OF CALL     */ 02047000
@EL00002 DS    0H                                                  0666 02048000
@EF00002 DS    0H                                                  0666 02049000
@ER00002 LM    @14,@12,12(@13)                                     0666 02050000
         BR    @14                                                 0666 02051000
*         END IKJEFA20                                             0667 02052000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02053000
*/*%INCLUDE SYSLIB  (IKJEFUAD)                                        * 02054000
*/*%INCLUDE SYSLIB  (IKJEFUDL)                                        * 02055000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        * 02056000
*;                                                                 0667 02057000
@DATA    DS    0H                                                       02058000
@CH00113 DC    H'2'                                                     02059000
@CH00398 DC    H'6'                                                     02060000
@CH00249 DC    H'32'                                                    02061000
@SM00429 MVC   CPLS(0),MCPLS                                            02062000
@SM00443 MVC   UADSDEST(0,HEDBPTR),DEST(@10)                            02063000
@SC00448 CLC   UADSANUM(0,UADSAPTR),ACCTNO                              02064000
@SM00450 MVC   INSRTT2(0),MAXSIZE(@10)                                  02065000
@SM00452 MVC   INSRTT1(0),SIZE(@05)                                     02066000
@SM00454 MVC   INSRTT2(0),USRID                                         02067000
@SM00456 MVC   INSRTT2(0),ACCTNO                                        02068000
@SM00459 MVC   UIDUSER(0,@10),USRID                                     02069000
@SM00461 MVC   UIDUSER+8(0,@10),DUSRID                                  02070000
@SM00463 MVC   AMSGHDR1(0),PTRMASK1(MSGPTR)                             02071000
@SM00465 MVC   AMSGHDR2(0),PTRMASK2(@05)                                02072000
@DATD    DSECT                                                          02073000
         DS    0F                                                       02074000
@SA00001 DS    18F                                                      02075000
IKJEFA20 CSECT                                                          02076000
         DS    0F                                                       02077000
@CF00049 DC    F'4'                                                     02078000
@CF00040 DC    F'8'                                                     02079000
@CF00350 DC    F'12'                                                    02080000
@CH00350 EQU   @CF00350+2                                               02081000
@CF00042 DC    F'16'                                                    02082000
@CF00070 DC    F'20'                                                    02083000
@CF00077 DC    F'24'                                                    02084000
@CF00422 DC    XL4'40FFFFFF'                                            02085000
@CF00445 DC    XL4'0000FFFF'                                            02086000
@DATD    DSECT                                                          02087000
         DS    0D                                                       02088000
UIDLADR  DS    A                                                        02089000
CTRLTAB  DS    CL40                                                     02090000
         ORG   CTRLTAB                                                  02091000
ACCTPLP  DS    AL4                                                      02092000
CHPDLPTR DS    AL4                                                      02093000
DATALPTR DS    AL4                                                      02094000
NODELPTR DS    AL4                                                      02095000
BLOKCNT  DS    FL1                                                      02096000
HEADADDR DS    AL3                                                      02097000
PASSADDR DS    AL4                                                      02098000
ACCTADDR DS    AL4                                                      02099000
PROCADDR DS    AL4                                                      02100000
RETCODE  DS    FL4                                                      02101000
CHLEVL   DS    FL1                                                      02102000
SRCHIND  DS    FL1                                                      02103000
MSGNMBR  DS    FL1                                                      02104000
TRCHGE   DS    BL1                                                      02105000
@NM00020 EQU   CTRLTAB+39                                               02106000
@NM00021 EQU   CTRLTAB+39                                               02107000
         ORG   CTRLTAB+40                                               02108000
CFLAGS   DS    CL3                                                      02109000
         ORG   CFLAGS                                                   02110000
USIND    DS    BL1                                                      02111000
PWFNDFLG EQU   CFLAGS+0                                                 02112000
ACFNDFLG EQU   CFLAGS+0                                                 02113000
PRFNDFLG EQU   CFLAGS+0                                                 02114000
PWSUPFLG EQU   CFLAGS+0                                                 02115000
ACSUPFLG EQU   CFLAGS+0                                                 02116000
PUTLFLG  EQU   CFLAGS+0                                                 02117000
FREEFLG  EQU   CFLAGS+0                                                 02118000
POSTFLG  DS    BL1                                                      02119000
TREEFLG  EQU   CFLAGS+1                                                 02120000
CNTNFLG  EQU   CFLAGS+1                                                 02121000
STGFLG   EQU   CFLAGS+1                                                 02122000
SRCHFLG  EQU   CFLAGS+1                                                 02123000
NEWUSFLG EQU   CFLAGS+1                                                 02124000
ENQUAFLG EQU   CFLAGS+1                                                 02125000
ENQFLG   EQU   CFLAGS+1                                                 02126000
LOOPFLG  DS    BL1                                                      02127000
         ORG   CFLAGS+3                                                 02128000
NLSTTAB  DS    CL66                                                     02129000
         ORG   NLSTTAB                                                  02130000
USRLEN   DS    FL1                                                      02131000
USRID    DS    CL8                                                      02132000
PASSWD   DS    CL8                                                      02133000
ACTLEN   DS    FL1                                                      02134000
ACCTNO   DS    CL40                                                     02135000
PROCNM   DS    CL8                                                      02136000
         ORG   NLSTTAB+66                                               02137000
         DS    CL1                                                      02138000
DLSTTAB  DS    CL108                                                    02139000
         ORG   DLSTTAB                                                  02140000
DUSRLEN  DS    FL1                                                      02141000
DUSRID   DS    CL8                                                      02142000
@NM00034 DS    CL8                                                      02143000
@NM00035 DS    FL1                                                      02144000
@NM00036 DS    CL40                                                     02145000
@NM00037 DS    CL8                                                      02146000
@NM00038 DS    FL2                                                      02147000
@NM00039 DS    CL8                                                      02148000
PERFGRP  DS    CL32                                                     02149000
         ORG   DLSTTAB+108                                              02150000
         DS    CL2                                                      02151000
DIRYWA   DS    CL344                                                    02152000
         ORG   DIRYWA                                                   02153000
UADSDCB  DS    CL88                                                     02154000
         ORG   DIRYWA+344                                               02155000
ACIOPARM DS    CL24                                                     02156000
         ORG   ACIOPARM                                                 02157000
ACIOFLGS DS    CL1                                                      02158000
         ORG   ACIOFLGS                                                 02159000
@NM00042 DS    BL1                                                      02160000
ACIOFL03 EQU   ACIOFLGS+0                                               02161000
@NM00043 EQU   ACIOFLGS+0                                               02162000
ACIOFL05 EQU   ACIOFLGS+0                                               02163000
@NM00044 EQU   ACIOFLGS+0                                               02164000
         ORG   ACIOPARM+1                                               02165000
ACIODCBA DS    AL3                                                      02166000
ACIOMPTR DS    AL4                                                      02167000
ACIODRCT DS    AL4                                                      02168000
ACIOLINK DS    AL4                                                      02169000
ACIONMBR DS    AL1                                                      02170000
ACIOBUFR DS    AL3                                                      02171000
MSGID    DS    CL1                                                      02172000
ACIOPUTL DS    AL3                                                      02173000
         ORG   ACIOPARM+24                                              02174000
SPACPARM DS    CL12                                                     02175000
         ORG   SPACPARM                                                 02176000
SPACMPTR DS    AL4                                                      02177000
SPACMCNT DS    FL2                                                      02178000
SPACLNTH DS    FL2                                                      02179000
SPACOFST DS    AL4                                                      02180000
         ORG   SPACPARM+12                                              02181000
         DS    CL4                                                      02182000
DECRTCD  DS    CL8                                                      02183000
STOWLIST DS    CL16                                                     02184000
         ORG   STOWLIST                                                 02185000
OLDUSER  DS    CL8                                                      02186000
NEWUSER  DS    CL8                                                      02187000
         ORG   STOWLIST+16                                              02188000
PLPLIST  DS    CL16                                                     02189000
         ORG   PLPLIST                                                  02190000
@NM00045 DS    3A                                                       02191000
PBLKADR  DS    AL4                                                      02192000
         ORG   PLPLIST+16                                               02193000
AMSGHDR1 DS    CL32                                                     02194000
         ORG   AMSGHDR1                                                 02195000
LEVPTR1  DS    AL4                                                      02196000
@NM00047 DS    3A                                                       02197000
SEGPTR13 DS    AL4                                                      02198000
@NM00048 DS    AL4                                                      02199000
SEGPTR15 DS    AL4                                                      02200000
@NM00049 DS    AL4                                                      02201000
         ORG   AMSGHDR1+32                                              02202000
AMSGHDR2 DS    CL32                                                     02203000
         ORG   AMSGHDR2                                                 02204000
@NM00050 DS    AL4                                                      02205000
@NM00051 DS    3A                                                       02206000
SEGPTR23 DS    AL4                                                      02207000
@NM00052 DS    3A                                                       02208000
         ORG   AMSGHDR2+32                                              02209000
INSRT1   DS    CL12                                                     02210000
         ORG   INSRT1                                                   02211000
INSRTL1  DS    AL2                                                      02212000
INSRTO1  DS    AL2                                                      02213000
INSRTT1  DS    CL8                                                      02214000
         ORG   INSRT1+12                                                02215000
INSRT2   DS    CL44                                                     02216000
         ORG   INSRT2                                                   02217000
INSRTL2  DS    AL2                                                      02218000
INSRTO2  DS    AL2                                                      02219000
INSRTT2  DS    CL40                                                     02220000
         ORG   INSRT2+44                                                02221000
IKJEFA20 CSECT                                                          02222000
         DS    0F                                                       02223000
@SIZDATD DC    AL1(1)                                                   02224000
         DC    AL3(@ENDDATD-@DATD)                                      02225000
@CV00145 DC    V(CHMSG)                                                 02226000
@CV00146 DC    V(IKJEFA22)                                              02227000
@CV00147 DC    V(IKJEFA23)                                              02228000
@CV00148 DC    V(IKJEFA24)                                              02229000
@CV00149 DC    V(IKJEFA51)                                              02230000
@CV00150 DC    V(IKJEFA52)                                              02231000
@CV00151 DC    V(IKJEFA53)                                              02232000
@CV00152 DC    V(IKJEFA54)                                              02233000
         DS    0D                                                       02234000
@CC00380 DC    C'* '                                                    02235000
@CB00373 DC    X'0000000000000000'                                      02236000
@CB00420 EQU   @CB00373                                                 02237000
MAJNAME  DC    CL8'SYSIKJUA'                                            02238000
MINNAME  DC    CL8'OPENUADS'                                            02239000
@DATD    DSECT                                                          02240000
IKJEFA20 CSECT                                                          02241000
MCPLS    DS   0D                                                        02242000
         CLOSE (,),MF=L                                                 02243000
         DCB   DDNAME=SYSUADS,RECFM=FB,DSORG=PO,MACRF=(R,W),OPTCD=W,   *02244000
               NCP=10                                                   02245000
         DEQ   (MAJNAME,MINNAME,8,SYSTEM),RET=HAVE,MF=L                 02246000
         DEQ   (MAJNAME,,,SYSTEM),RET=HAVE,MF=L                         02247000
         ENQ   (MAJNAME,MINNAME,E,8,SYSTEM),RET=HAVE,MF=L               02248000
         ENQ   (MAJNAME,,E,,SYSTEM),RET=USE,MF=L                        02249000
         GETMAIN EC,SP=1,MF=L                                           02250000
         OPEN  (,),MF=L                                                 02251000
         PUTLINE OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L                     02252000
MCPLNG   DC    A(*-MCPLS)               LENGTH OF MODEL PARAMETER LIST  02253000
UADSBLK  DCB   DDNAME=SYSUADS,BLKSIZE=256,DSORG=PS,MACRF=(R),RECFM=F    02254000
         DCBD  DSORG=(PO),DEVD=(DA)                                     02255000
@DATD    DSECT                          REESTABLISH AUTOMATIC DSECT     02256000
CPLS     DS    0D                                                       02257000
CLOSUAD  CLOSE (,),MF=L                                                 02258000
UADDCB2  DCB   DDNAME=SYSUADS,RECFM=FB,DSORG=PO,MACRF=(R,W),OPTCD=W,   *02259000
               NCP=10                                                   02260000
UADDEQ   DEQ   (MAJNAME,MINNAME,8,SYSTEM),RET=HAVE,MF=L                 02261000
USERDEQ  DEQ   (MAJNAME,,0,SYSTEM),RET=HAVE,MF=L                        02262000
UADENQ   ENQ   (MAJNAME,MINNAME,E,8,SYSTEM),RET=HAVE,MF=L               02263000
USERENQ  ENQ   (MAJNAME,,E,0,SYSTEM),RET=USE,MF=L                       02264000
DYNGTLST GETMAIN EC,SP=1,MF=L                                           02265000
OPENUAD  OPEN  (,),MF=L                                                 02266000
PBLOK    PUTLINE OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L                     02267000
IKJEFA20 CSECT                                                          02268000
         DS   0H                                                        02269000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   02270000
@DATD    DSECT                                                          02271000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02272000
@ENDDATD EQU   *                                                        02273000
IKJEFA20 CSECT                                                          02274000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02275000
@01      EQU   01                                                       02276000
@02      EQU   02                                                       02277000
@03      EQU   03                                                       02278000
@04      EQU   04                                                       02279000
@05      EQU   05                                                       02280000
@06      EQU   06                                                       02281000
@07      EQU   07                                                       02282000
@08      EQU   08                                                       02283000
@09      EQU   09                                                       02284000
@10      EQU   10                                                       02285000
@11      EQU   11                                                       02286000
@12      EQU   12                                                       02287000
@13      EQU   13                                                       02288000
@14      EQU   14                                                       02289000
@15      EQU   15                                                       02290000
MINDX    EQU   @03                                                      02291000
MSGNO    EQU   @04                                                      02292000
MSGPTR   EQU   @02                                                      02293000
MSGFIND  EQU   @03                                                      02294000
PERFPTR  EQU   @02                                                      02295000
NEWINDP  EQU   @07                                                      02296000
OLDINDP  EQU   @06                                                      02297000
INDEX    EQU   @05                                                      02298000
UPTPTR   EQU   @02                                                      02299000
UADSRPTR EQU   @07                                                      02300000
UADSAPTR EQU   @02                                                      02301000
UADSPPTR EQU   @02                                                      02302000
DROBPTR  EQU   @02                                                      02303000
DNOBPTR  EQU   @06                                                      02304000
DPOBPTR  EQU   @05                                                      02305000
HEDBPTR  EQU   @03                                                      02306000
R1       EQU   @01                                                      02307000
R2       EQU   @02                                                      02308000
R15      EQU   @15                                                      02309000
DHED     EQU   0                                                        02310000
UADSMHDR EQU   DHED                                                     02311000
UADSBLNG EQU   UADSMHDR                                                 02312000
UADSUSER EQU   UADSMHDR+4                                               02313000
UADSBN01 EQU   UADSMHDR+12                                              02314000
UADSEXPF EQU   UADSBN01+1                                               02315000
UADSMAXC EQU   UADSMHDR+14                                              02316000
UADSATTR EQU   DHED+16                                                  02317000
USATR00  EQU   UADSATTR                                                 02318000
USATR01  EQU   UADSATTR                                                 02319000
USATR02  EQU   UADSATTR                                                 02320000
USATR03  EQU   UADSATTR                                                 02321000
UADSINST EQU   DHED+18                                                  02322000
UADSUPTP EQU   DHED+20                                                  02323000
UADSPWD1 EQU   DHED+24                                                  02324000
UADSPERP EQU   DHED+28                                                  02325000
UADSDEST EQU   DHED+32                                                  02326000
DPOB     EQU   0                                                        02327000
PFLG01   EQU   DPOB                                                     02328000
UADSPNEX EQU   DPOB+1                                                   02329000
UADSPSUB EQU   DPOB+4                                                   02330000
UADSPDAT EQU   DPOB+8                                                   02331000
DNOB     EQU   0                                                        02332000
AFLG01   EQU   DNOB                                                     02333000
UADSANEX EQU   DNOB+1                                                   02334000
UADSASUB EQU   DNOB+4                                                   02335000
UADSADAT EQU   DNOB+8                                                   02336000
DROB     EQU   0                                                        02337000
FLGR01   EQU   DROB                                                     02338000
UADSRNEX EQU   DROB+1                                                   02339000
UADSRDAT EQU   DROB+8                                                   02340000
DPOBD    EQU   0                                                        02341000
UADSPPWD EQU   DPOBD+4                                                  02342000
DNOBD    EQU   0                                                        02343000
UADSALEN EQU   DNOBD+44                                                 02344000
UADSANUM EQU   DNOBD+45                                                 02345000
DROBD    EQU   0                                                        02346000
UADSRNAM EQU   DROBD+4                                                  02347000
UADSRSIZ EQU   DROBD+14                                                 02348000
DUIDL    EQU   0                                                        02349000
UIDLNEX  EQU   DUIDL                                                    02350000
UIDLSWS  EQU   DUIDL+4                                                  02351000
UIDCHG   EQU   UIDLSWS                                                  02352000
UIDLCT   EQU   DUIDL+6                                                  02353000
UIDUSER  EQU   DUIDL+8                                                  02354000
UPT      EQU   0                                                        02355000
UPTSWS   EQU   UPT+12                                                   02356000
UPTPREFX EQU   UPT+16                                                   02357000
UPTPREFL EQU   UPT+23                                                   02358000
ACCTPL   EQU   0                                                        02359000
ACCTECBP EQU   ACCTPL+8                                                 02360000
UIDLPTR  EQU   ACCTPL+16                                                02361000
ACCTECB  EQU   0                                                        02362000
ATTENTN  EQU   ACCTECB                                                  02363000
@NM00022 EQU   0                                                        02364000
OPERKEY  EQU   @NM00022+16                                              02365000
ACCTKEY  EQU   @NM00022+18                                              02366000
JCLKEY   EQU   @NM00022+20                                              02367000
MONTKEY  EQU   @NM00022+22                                              02368000
USDAKEY  EQU   @NM00022+24                                              02369000
DESTKEY  EQU   @NM00022+26                                              02370000
PERFKEY  EQU   @NM00022+28                                              02371000
MAXSKEY  EQU   @NM00022+30                                              02372000
USERDATA EQU   @NM00022+46                                              02373000
DESTADR  EQU   @NM00022+48                                              02374000
DESTLNG  EQU   @NM00022+52                                              02375000
MAXSADR  EQU   @NM00022+68                                              02376000
MAXSLNG  EQU   @NM00022+72                                              02377000
MAXSHEX  EQU   @NM00022+74                                              02378000
RSIZADR  EQU   @NM00022+76                                              02379000
RSIZLNG  EQU   @NM00022+80                                              02380000
DEST     EQU   0                                                        02381000
MAXSIZE  EQU   0                                                        02382000
SIZE     EQU   0                                                        02383000
@NM00040 EQU   0                                                        02384000
MEMNAME  EQU   @NM00040+4                                               02385000
OLDIND   EQU   0                                                        02386000
NEWIND   EQU   0                                                        02387000
UADSPERG EQU   0                                                        02388000
MOFFSET  EQU   0                                                        02389000
PTRMASK1 EQU   0                                                        02390000
NXTLADR1 EQU   PTRMASK1                                                 02391000
SGNO1    EQU   PTRMASK1+4                                               02392000
PTRMASK2 EQU   0                                                        02393000
SGNO2    EQU   PTRMASK2+4                                               02394000
DCBOFLAG EQU   DCBOFLGS                                                 02395000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02396000
@NM00053 EQU   DCBOFLGS                                                 02397000
@NM00046 EQU   PTRMASK2                                                 02398000
@NM00041 EQU   @NM00040                                                 02399000
@NM00033 EQU   @NM00022+82                                              02400000
@NM00032 EQU   @NM00022+56                                              02401000
@NM00031 EQU   @NM00022+54                                              02402000
@NM00030 EQU   @NM00022+44                                              02403000
@NM00029 EQU   @NM00022+40                                              02404000
@NM00028 EQU   @NM00022+38                                              02405000
@NM00027 EQU   @NM00022+36                                              02406000
@NM00026 EQU   @NM00022+34                                              02407000
@NM00025 EQU   @NM00022+32                                              02408000
@NM00024 EQU   @NM00022+8                                               02409000
@NM00023 EQU   @NM00022                                                 02410000
@NM00019 EQU   ACCTECB                                                  02411000
@NM00018 EQU   ACCTPL+12                                                02412000
@NM00017 EQU   ACCTPL                                                   02413000
@NM00016 EQU   UPT+15                                                   02414000
UPTLDEL  EQU   UPT+14                                                   02415000
UPTCDEL  EQU   UPT+13                                                   02416000
UPTWTP   EQU   UPTSWS                                                   02417000
UPTMODE  EQU   UPTSWS                                                   02418000
UPTALD   EQU   UPTSWS                                                   02419000
UPTPAUS  EQU   UPTSWS                                                   02420000
UPTNCOM  EQU   UPTSWS                                                   02421000
UPTMID   EQU   UPTSWS                                                   02422000
UPTNPRM  EQU   UPTSWS                                                   02423000
UPTRCVR  EQU   UPTSWS                                                   02424000
UPTUSER  EQU   UPT+2                                                    02425000
@NM00015 EQU   UPT                                                      02426000
@NM00014 EQU   UIDLSWS                                                  02427000
UIDDEL   EQU   UIDLSWS                                                  02428000
UIDADD   EQU   UIDLSWS                                                  02429000
UADSUNAM EQU   DROBD+16                                                 02430000
@NM00013 EQU   DROBD+12                                                 02431000
@NM00012 EQU   DROBD+1                                                  02432000
UADSRCTR EQU   DROBD                                                    02433000
UADSADRF EQU   DNOBD+4                                                  02434000
@NM00011 EQU   DNOBD+1                                                  02435000
UADSACTR EQU   DNOBD                                                    02436000
@NM00010 EQU   DPOBD+1                                                  02437000
UADSPCTR EQU   DPOBD                                                    02438000
@NM00009 EQU   DROB+4                                                   02439000
@NM00008 EQU   DROB                                                     02440000
@NM00007 EQU   DNOB                                                     02441000
@NM00006 EQU   DPOB                                                     02442000
@NM00005 EQU   DHED+44                                                  02443000
UADSSOUT EQU   DHED+43                                                  02444000
UADSSUBM EQU   DHED+42                                                  02445000
UADSSUBC EQU   DHED+41                                                  02446000
UADSSUBH EQU   DHED+40                                                  02447000
@NM00004 EQU   UADSATTR                                                 02448000
USATR04  EQU   UADSATTR                                                 02449000
@NM00003 EQU   UADSATTR                                                 02450000
@NM00002 EQU   UADSBN01+1                                               02451000
UADSXUSD EQU   UADSBN01+1                                               02452000
UADSXBLK EQU   UADSBN01+1                                               02453000
UADSNUSP EQU   UADSBN01+1                                               02454000
@NM00001 EQU   UADSBN01                                                 02455000
UADSFSQP EQU   UADSMHDR+2                                               02456000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02457000
@RT00059 EQU   ACCTRET                                                  02458000
@RT00063 EQU   ACCTRET                                                  02459000
@RT00122 EQU   CHKCHNG                                                  02460000
@RT00124 EQU   ACCTRET                                                  02461000
@RT00154 EQU   MSG3                                                     02462000
@RT00156 EQU   ACCTRET                                                  02463000
@RT00158 EQU   CHKCHNG                                                  02464000
@RC00188 EQU   @RC00186                                                 02465000
@RF00239 EQU   @RC00237                                                 02466000
@RT00269 EQU   CHKMAX                                                   02467000
@RT00273 EQU   PWSPRT                                                   02468000
@RT00277 EQU   ACLEVL                                                   02469000
@RF00277 EQU   MORUS                                                    02470000
@RT00281 EQU   MORUS                                                    02471000
@RT00287 EQU   WORKER                                                   02472000
@RF00287 EQU   ACLEVL                                                   02473000
@RT00297 EQU   WORKER                                                   02474000
@RF00297 EQU   ACLEVL                                                   02475000
@RT00308 EQU   ACSPRT                                                   02476000
@RT00312 EQU   MORUS                                                    02477000
@RT00317 EQU   PRLEVL                                                   02478000
@RF00317 EQU   MORUS                                                    02479000
@RT00323 EQU   WORKER                                                   02480000
@RF00323 EQU   PRLEVL                                                   02481000
@RT00335 EQU   WORKER                                                   02482000
@RT00348 EQU   CHKMAX                                                   02483000
@RT00353 EQU   WORKER                                                   02484000
@RT00380 EQU   CHKMAX                                                   02485000
@RT00401 EQU   CHKMAX                                                   02486000
@RT00415 EQU   ENQUSER                                                  02487000
@RT00437 EQU   ACCTRET                                                  02488000
@RT00448 EQU   WRTREE                                                   02489000
@RT00498 EQU   ACCTRET                                                  02490000
@RF00501 EQU   MORUS                                                    02491000
@RT00544 EQU   ACCTRET                                                  02492000
@RT00548 EQU   MSG3                                                     02493000
@RT00555 EQU   ACCTRET                                                  02494000
@RT00565 EQU   ACCTRET                                                  02495000
@RT00579 EQU   ACCTRET                                                  02496000
@RT00593 EQU   ACCTRET                                                  02497000
@RT00595 EQU   ACCTRET                                                  02498000
@RT00597 EQU   ACCTRET                                                  02499000
@RT00641 EQU   MSG3                                                     02500000
@RF00652 EQU   @EL00001                                                 02501000
@RF00660 EQU   @EL00002                                                 02502000
@ENDDATA EQU   *                                                        02503000
         END   IKJEFA20,(C'PLS1014',0701,78174)                         02504000
