         TITLE 'IKJEFA24  --  CHANGE PARSE INTERFACE ROUTINE           *00001000
                        '                                               00002000
IKJEFA24 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFA24  73.360'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
*         CTABPTR = R1;               /* PTR TO THE CHANGE CNTRL TAB    00022000
*                                        IS PASSED IN REG1           */ 00023000
         LR    CTABPTR,R1                                          0021 00024000
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REG       */ 00025000
*         /* MOVE MACRO MODELS TO DYNAMIC STORAGE                    */ 00026000
*         DYNLFORM(1:INLINLNG) = INLINLFM(1:INLINLNG);             0023 00027000
         L     @10,INLINLNG                                        0023 00028000
         BCTR  @10,0                                               0023 00029000
         EX    @10,@SM00217                                        0023 00030000
*         /* OBTAIN DYNAMIC STORAGE FOR PARSE PARAMETER CONTROL LIST */ 00031000
*         PCLPTR = 0;                 /* INIT PTR TO PCL             */ 00032000
         SLR   @10,@10                                             0024 00033000
         ST    @10,PCLPTR                                          0024 00034000
*         PLENGTH = PCLLNGTH;         /* GET LENGTH OF PARSE PCL     */ 00035000
         L     @10,PCLMDLAD                                        0025 00036000
         LH    @10,PCLLNGTH(,@10)                                  0025 00037000
         ST    @10,PLENGTH                                         0025 00038000
*         RFY R0 RSTD;                /* RESTRICT GETMAIN LENGTH REG */ 00039000
*         R0 = PLENGTH;               /* SET LENGTH FOR GETMAIN      */ 00040000
         LR    R0,@10                                              0027 00041000
*         GEN (GETMAIN EC,LV=(R0),A=PCLPTR,MF=(E,DYNGTLST))        0028 00042000
*           SETS(PCLPTR) REFS(DYNGTLST);                           0028 00043000
         GETMAIN EC,LV=(R0),A=PCLPTR,MF=(E,DYNGTLST)                    00044000
*         RFY R15 RSTD;               /* RESERVE RETURN CODE REGISTER*/ 00045000
*         RETNCODE = R15;             /* ASSIGN THE RETURN CODE      */ 00046000
         LR    RETNCODE,R15                                        0030 00047000
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REGISTER*/ 00048000
*         /* CHECK THE RETURN CODE                                   */ 00049000
*         IF RETNCODE ^= 0            /* GETMAIN SUCCESSFUL?         */ 00050000
*           THEN                      /* NO, SPACE UNAVAILABLE       */ 00051000
         LTR   RETNCODE,RETNCODE                                   0032 00052000
         BZ    @RF00032                                            0032 00053000
*             DO;                                                  0033 00054000
*               MSGNMBR = 3;          /* SET ERROR MSG NUMBER AND..  */ 00055000
         MVI   MSGNMBR(CTABPTR),X'03'                              0034 00056000
*               RETURN;               /* RETURN TO IKJEFA20          */ 00057000
@EL00001 L     @13,4(,@13)                                         0035 00058000
@EF00001 L     @00,@SIZDATD                                        0035 00059000
         LR    @01,@11                                             0035 00060000
         FREEMAIN R,LV=(0),A=(1)                                        00061000
@ER00001 LM    @14,@12,12(@13)                                     0035 00062000
         BR    @14                                                 0035 00063000
*             END;                                                 0036 00064000
*         /* INITIALIZE THE PARSE PCL FROM THE MODEL.                */ 00065000
*         /* PCL MUST BE MOVED INTO DYNAMIC STORAGE SINCE IT WILL BE */ 00066000
*         /* MODIFIED IN THE NODELIST VALIDITY CHECK EXIT ROUTINE -  */ 00067000
*         /* IKJEFA25.                                               */ 00068000
*          RFY (R1,R14,R15) RSTD;     /* RESTRICT WORK REGISTERS     */ 00069000
@RF00032 DS    0H                                                  0038 00070000
*          R0=PCLPTR;                 /* GET TO ADDRESS              */ 00071000
         L     R0,PCLPTR                                           0038 00072000
*          R1=PLENGTH;                /* LOAD R1 WITH LENGTH         */ 00073000
         L     @10,PLENGTH                                         0039 00074000
         LR    R1,@10                                              0039 00075000
*          R14=PCLMDLAD;              /* GET FROM ADDRESS            */ 00076000
         L     R14,PCLMDLAD                                        0040 00077000
*          R15=PLENGTH;               /* LOAD R15 WITH LENGTH        */ 00078000
         LR    R15,@10                                             0041 00079000
*          GEN (MVCL  R0,R14)         /* MOVE PCL TO GOTTEN CORE     */ 00080000
*            REFS(R0,R1,R14,R15);                                  0042 00081000
         MVCL  R0,R14                                                   00082000
*          RFY (R0,R1,R14,R15) UNRSTD;/* RELEASE WORK REGISTERS      */ 00083000
*         EXITADD = ADDR(IKJEFA25);   /* SET PTR TO EXIT ADDRESS     */ 00084000
         LA    @10,IKJEFA25                                        0044 00085000
         ST    @10,EXITADD                                         0044 00086000
*         RFY R13 RSTD;               /* RESTRICT SAVE AREA PTR      */ 00087000
*         SAVARAD = R13;              /* POINT TO SAVE AREA          */ 00088000
         ST    R13,SAVARAD                                         0046 00089000
*         NODEPTR = NODELPTR;         /* POINT TO ANSWER PLACE       */ 00090000
         L     @10,NODELPTR(,CTABPTR)                              0047 00091000
         ST    @10,NODEPTR                                         0047 00092000
*         PERFPTR = ADDR(PERFGRP);    /* POINT TO PERF GRP AREA      */ 00093000
         L     @10,DATALPTR(,CTABPTR)                              0048 00094000
         LA    @10,PERFGRP(,@10)                                   0048 00095000
         ST    @10,PERFPTR                                         0048 00096000
*         CMDIND = 2;                 /* INDICATE CHANGE SUBCOMMAND  */ 00097000
         MVI   CMDIND,X'02'                                        0049 00098000
*         /* BUILD PARSE PARAMETER LIST (PPL).                       */ 00099000
*         CHNPDLAD = 0;               /* INIT PTR TO PDL             */ 00100000
         SLR   @10,@10                                             0050 00101000
         ST    @10,CHNPDLAD                                        0050 00102000
*         PARSLIST(1:12) = ACCTPL;    /* 1ST 3 WORDS OF ACCOUNT    0051 00103000
*                                        PARAMETER LIST              */ 00104000
         L     @10,ACCTPLP(,CTABPTR)                               0051 00105000
         MVC   PARSLIST(12),ACCTPL(@10)                            0051 00106000
*         PPLPTR = ADDR(PARSLIST);    /* PPL ADDRESSABILITY          */ 00107000
         LA    @07,PARSLIST                                        0052 00108000
         ST    @07,PPLPTR                                          0052 00109000
*         PPLPCL = PCLPTR;            /* ADDR OF DYNAMIC PCL         */ 00110000
         L     @15,PCLPTR                                          0053 00111000
         ST    @15,PPLPCL(,@07)                                    0053 00112000
*         PPLANS = ADDR(CHNPDLAD);    /* CHNPDLAD WILL CONTAIN ADDR     00113000
*                                        OF PDL AFTER PARSE          */ 00114000
         LA    @15,CHNPDLAD                                        0054 00115000
         ST    @15,PPLANS(,@07)                                    0054 00116000
*         PPLCBUF = BUFPTR;           /* PTR TO CHANGE CMND  BUFFER  */ 00117000
         L     @10,BUFPTR(,@10)                                    0055 00118000
         ST    @10,PPLCBUF(,@07)                                   0055 00119000
*         PPLUWA = ADDR(VCHKPL);      /* ADDR OF THE PARAMETER  LIST    00120000
*                                        FOR IKJEFA55                */ 00121000
         LA    @10,VCHKPL                                          0056 00122000
         ST    @10,PPLUWA(,@07)                                    0056 00123000
*         /* LINK TO THE PARSE SERVICE ROUTINE.                      */ 00124000
*         GEN (LINK  EP=IKJPARS,MF=(E,PARSLIST))                   0057 00125000
*           FLOWS(IKJEFA25) REFS(PARSLIST);                        0057 00126000
         LINK  EP=IKJPARS,MF=(E,PARSLIST)                               00127000
*         RFY R15 RSTD;               /* RESTRICT THE RETURN CODE REG*/ 00128000
*         RETNCODE = R15;             /* SAVE THE RETURN CODE        */ 00129000
         LR    RETNCODE,R15                                        0059 00130000
*         RFY R15 UNRSTD;             /* RELEASE THE RETURN CODE REG */ 00131000
*         /* CHECK THE PARSE RETURN CODE.                            */ 00132000
*         IF RETNCODE ^= 0            /* SUCCESSFUL COMPLETION?      */ 00133000
*           THEN                      /* NO,                         */ 00134000
         LTR   RETNCODE,RETNCODE                                   0061 00135000
         BZ    @RF00061                                            0061 00136000
*             DO;                                                  0062 00137000
*             IF RETNCODE = 20        /* DID THE VALIDITY CHECK ROUTINE 00138000
*                                          DISCOVER THE ERROR        */ 00139000
*               THEN                  /* YES,                        */ 00140000
         CH    RETNCODE,@CH00195                                   0063 00141000
         BNE   @RF00063                                            0063 00142000
*                 RETCODE = EXITRTCD; /* SAVE THE VALIDITY CODE      */ 00143000
         L     @10,EXITRTCD                                        0064 00144000
         ST    @10,RETCODE(,CTABPTR)                               0064 00145000
*               ELSE                  /* NO,                         */ 00146000
*                 RETCODE = RETNCODE; /* SAVE THE RETURN CODE        */ 00147000
         B     @RC00063                                            0065 00148000
@RF00063 ST    RETNCODE,RETCODE(,CTABPTR)                          0065 00149000
*             GOTO FREEPCL;           /* FREE PCL AND RETURN TO EFA20*/ 00150000
         B     FREEPCL                                             0066 00151000
*             END;                                                 0067 00152000
*           IF SIZEKEY(16) = '1'B     /* WAS SIZE SPECIFIED?         */ 00153000
*             THEN                    /* YES,                        */ 00154000
@RF00061 L     @10,CHNPDLAD                                        0068 00155000
         TM    SIZEKEY+1(@10),B'00000001'                          0068 00156000
         BNO   @RF00068                                            0068 00157000
*               DO;                                                0069 00158000
*               SIZE = SIZEHEX;       /* SAVE SIZE VALUE IN DATALIST    00159000
*                                        TABLE                       */ 00160000
         L     @07,DATALPTR(,CTABPTR)                              0070 00161000
         SLR   @15,@15                                             0070 00162000
         ICM   @15,3,SIZEHEX(@10)                                  0070 00163000
         STH   @15,SIZE(,@07)                                      0070 00164000
*               SIZESW = '1'B;        /* SET SIZE SPECIFIED SWITCH   */ 00165000
         OI    SIZESW(CTABPTR),B'01000000'                         0071 00166000
*               END;                                               0072 00167000
*           IF UNITKEY(16) = '1'B     /* WAS UNIT SPECIFIED?         */ 00168000
*             THEN                    /* YES,                        */ 00169000
@RF00068 L     @10,CHNPDLAD                                        0073 00170000
         TM    UNITKEY+1(@10),B'00000001'                          0073 00171000
         BNO   @RF00073                                            0073 00172000
*               DO;                                                0074 00173000
*               UNITNAM =             /* SAVE UNIT NAME IN DATALIST  */ 00174000
*                 UNIT(1:UNITLNG);    /* TABLE                       */ 00175000
         L     @07,DATALPTR(,CTABPTR)                              0075 00176000
         MVI   UNITNAM+1(@07),C' '                                 0075 00177000
         MVC   UNITNAM+2(6,@07),UNITNAM+1(@07)                     0075 00178000
         LH    @15,UNITLNG(,@10)                                   0075 00179000
         BCTR  @15,0                                               0075 00180000
         L     @10,UNITPTR(,@10)                                   0075 00181000
         EX    @15,@SM00220                                        0075 00182000
*               UNITSW = '1'B;        /* SET UNIT SPECIFIED SWITCH   */ 00183000
         OI    UNITSW(CTABPTR),B'00100000'                         0076 00184000
*               END;                                               0077 00185000
*         /* CHECK THE COMMAND FOR POSSIBLE OMISSION OF REQUIRED     */ 00186000
*         /* DATA NOT CHECKED BY PARSE, SUCH AS (1)- IF THE CHANGE   */ 00187000
*         /* LEVEL IS THE USERID LEVEL, THEN EITHER A NEW USERID     */ 00188000
*         /* (DATALIST), OR DATA ITEMS, OR BOTH, MUST BE SPECIFIED.  */ 00189000
*         /* (2)- IF THE CHANGE LEVEL IS THE PROCNAME LEVEL, THEN    */ 00190000
*         /* EITHER A NEW PROCNAME, OR DATA ITEMS, OR BOTH, MUST BE  */ 00191000
*         /* SPECIFIED. IF THESE CONDITIONS ARE NOT MET, THE COMMAND */ 00192000
*         /* WILL BE REJECTED.                                       */ 00193000
*         IF NUMOFLV = 1              /* IS THE LEVEL THE USERID     */ 00194000
*           THEN                      /* YES,                        */ 00195000
@RF00073 CLI   NUMOFLV,1                                           0078 00196000
         BNE   @RF00078                                            0078 00197000
*             DO;                                                  0079 00198000
*             IF OPERKEY(15:16) = '00'B /*  IS OPER SPECIFIED        */ 00199000
*             &ACCTKEY(15:16) = '00'B /*  OR ACCT                    */ 00200000
*             &JCLKEY(15:16)  = '00'B /*  OR JCL                     */ 00201000
*             &MONTKEY(15:16) = '00'B /*  OR MOUNT             Y02678*/ 00202000
*             &USDAKEY(15:16) = '00'B /*  OR USERDATA                */ 00203000
*             &DESTKEY(15:16) = '00'B /*  OR DESTINATION       Y02678*/ 00204000
*             &PERFKEY(15:16) = '00'B /*  OR PERFORMANCE GROUPSY02678*/ 00205000
*             &MAXSKEY(15:16) = '00'B /*  OR MAXSIZE                 */ 00206000
*             &DATAKEY(15:16) = '00'B /*  OR A NEW USERID            */ 00207000
*               THEN                  /* NO, NO DATA ITEMS SPECIFIED */ 00208000
         L     @10,CHNPDLAD                                        0080 00209000
         TM    OPERKEY+1(@10),B'00000011'                          0080 00210000
         BNZ   @RF00080                                            0080 00211000
         TM    ACCTKEY+1(@10),B'00000011'                          0080 00212000
         BNZ   @RF00080                                            0080 00213000
         TM    JCLKEY+1(@10),B'00000011'                           0080 00214000
         BNZ   @RF00080                                            0080 00215000
         TM    MONTKEY+1(@10),B'00000011'                          0080 00216000
         BNZ   @RF00080                                            0080 00217000
         TM    USDAKEY+1(@10),B'00000011'                          0080 00218000
         BNZ   @RF00080                                            0080 00219000
         TM    DESTKEY+1(@10),B'00000011'                          0080 00220000
         BNZ   @RF00080                                            0080 00221000
         TM    PERFKEY+1(@10),B'00000011'                          0080 00222000
         BNZ   @RF00080                                            0080 00223000
         TM    MAXSKEY+1(@10),B'00000011'                          0080 00224000
         BNZ   @RF00080                                            0080 00225000
         TM    DATAKEY+1(@10),B'00000011'                          0080 00226000
         BNZ   @RF00080                                            0080 00227000
*                 DO;                                              0081 00228000
*                 MSGNMBR = 2;        /* SET MESSAGE NUMBER          */ 00229000
         MVI   MSGNMBR(CTABPTR),X'02'                              0082 00230000
*                 GOTO FREEPCL;       /* FREE PCL AND RETURN TO EFA20*/ 00231000
         B     FREEPCL                                             0083 00232000
*                 END;                                             0084 00233000
*             IF DLFLG1 = '1'B       /* WAS A NEW USERID SPECIFIED? */  00234000
*               THEN                  /* YES,                        */ 00235000
@RF00080 L     @10,CHNPDLAD                                        0085 00236000
         TM    DLFLG1(@10),B'10000000'                             0085 00237000
         BNO   @RF00085                                            0085 00238000
*                 DO;                                              0086 00239000
*                 DUSRLEN = DATALNG1; /* GET LENGTH OF NEW USERID    */ 00240000
         L     @07,DATALPTR(,CTABPTR)                              0087 00241000
         LH    @15,DATALNG1(,@10)                                  0087 00242000
         STC   @15,DUSRLEN(,@07)                                   0087 00243000
*                 DUSRID =            /* GET NEW USERID              */ 00244000
*                   DLUSID(1:DATALNG1);                            0088 00245000
         MVI   DUSRID+1(@07),C' '                                  0088 00246000
         MVC   DUSRID+2(6,@07),DUSRID+1(@07)                       0088 00247000
         BCTR  @15,0                                               0088 00248000
         L     @10,DLPTR1(,@10)                                    0088 00249000
         EX    @15,@SM00223                                        0088 00250000
*                 END;                                             0089 00251000
*             GOTO PARSOK;            /* COMPLETE CONTROL TABLE      */ 00252000
         B     PARSOK                                              0090 00253000
*             END;                                                 0091 00254000
*         /* IT IS POSSIBLE THAT THE DATA SUBFIELD ITEM (NEW NAME)   */ 00255000
*         /* IS IDENTICAL TO THE CORRESPONDING NODELIST ITEM (OLD    */ 00256000
*         /* NAME). SINCE THIS WOULD RESULT IN A MEANINGLESS CHANGE, */ 00257000
*         /* THE COMMAND WILL BE REJECTED WITH AN EXPLANATORY MSG.   */ 00258000
*         IF NUMOFLV = 2              /* CHANGE LEVEL=PASSWORD LEVEL?*/ 00259000
*           THEN                      /* YES,                        */ 00260000
@RF00078 CLI   NUMOFLV,2                                           0092 00261000
         BNE   @RF00092                                            0092 00262000
*             DO;                                                  0093 00263000
*             IF DLFLG2  = '0'B       /* WAS PASSWORD SPECIFIED?     */ 00264000
*               THEN                  /* THE COMMAND IS INVALID      */ 00265000
         L     @10,CHNPDLAD                                        0094 00266000
         TM    DLFLG2(@10),B'10000000'                             0094 00267000
         BNZ   @RF00094                                            0094 00268000
*                 DO;                                              0095 00269000
*                 MSGNMBR = 2;        /* SET MESSAGE NUMBER          */ 00270000
         MVI   MSGNMBR(CTABPTR),X'02'                              0096 00271000
*                 GOTO FREEPCL;       /* FREE PCL AND RETURN TO EFA20*/ 00272000
         B     FREEPCL                                             0097 00273000
*                 END;                                             0098 00274000
*             DPASSWD =               /* SAVE DATALIST PASSWORD      */ 00275000
*               DLPASS(1:DATALNG2);                                0099 00276000
@RF00094 L     @10,DATALPTR(,CTABPTR)                              0099 00277000
         MVI   DPASSWD+1(@10),C' '                                 0099 00278000
         MVC   DPASSWD+2(6,@10),DPASSWD+1(@10)                     0099 00279000
         L     @07,CHNPDLAD                                        0099 00280000
         LH    @15,DATALNG2(,@07)                                  0099 00281000
         BCTR  @15,0                                               0099 00282000
         L     @07,DLPTR2(,@07)                                    0099 00283000
         EX    @15,@SM00225                                        0099 00284000
*             IF PASSWD = DPASSWD                                  0100 00285000
*               THEN                  /* OLD & NEW NAME ARE THE SAME */ 00286000
         L     @07,NODELPTR(,CTABPTR)                              0100 00287000
         CLC   PASSWD(8,@07),DPASSWD(@10)                          0100 00288000
         BNE   @RF00100                                            0100 00289000
*                 DO;                                              0101 00290000
*                 MSGNMBR = 29;       /* SET ERROR MSG NUMBER        */ 00291000
         MVI   MSGNMBR(CTABPTR),X'1D'                              0102 00292000
*                 GOTO FREEPCL;       /* FREE PCL AND RETURN TO EFA20*/ 00293000
         B     FREEPCL                                             0103 00294000
*                 END;                                             0104 00295000
*             GOTO PARSOK;            /* COMPLETE CONTROL TABLE      */ 00296000
         B     PARSOK                                              0105 00297000
*             END;                                                 0106 00298000
*         /* CHANGE LEVEL = ACCTNMBR LEVEL?                          */ 00299000
*         /* IF THE CHANGE LEVEL IS THE ACTNO LEVEL, THEN MAKE SURE  */ 00300000
*         /* THAT THE NEW ACTNO IS NOT '*'. WHILE THE '*' IS A VALID */ 00301000
*         /* CHARACTER IN AN ACTNO, IT IS NOT VALID BY ITSELF.       */ 00302000
*         IF NUMOFLV = 3              /* CHANGE LVL = ACTNO LVL?     */ 00303000
*           THEN                      /* YES,                        */ 00304000
@RF00092 CLI   NUMOFLV,3                                           0107 00305000
         BNE   @RF00107                                            0107 00306000
*             DO;                                                  0108 00307000
*             IF DLFLG3  = '0'B       /* WAS ACCTNO. SPECIFIED?      */ 00308000
*               THEN                  /* THE COMMAND IS INVALID      */ 00309000
         L     @10,CHNPDLAD                                        0109 00310000
         TM    DLFLG3(@10),B'10000000'                             0109 00311000
         BNZ   @RF00109                                            0109 00312000
*                 DO;                                              0110 00313000
*                 MSGNMBR = 2;        /* SET MESSAGE NUMBER          */ 00314000
         MVI   MSGNMBR(CTABPTR),X'02'                              0111 00315000
*                 GOTO FREEPCL;       /* FREE PCL AND RETURN TO EFA20*/ 00316000
         B     FREEPCL                                             0112 00317000
*                 END;                                             0113 00318000
*             DACTLEN = DATALNG3;     /* SAVE LENGTH OF ACCT NUMBER  */ 00319000
@RF00109 L     @10,DATALPTR(,CTABPTR)                              0114 00320000
         L     @07,CHNPDLAD                                        0114 00321000
         LH    @15,DATALNG3(,@07)                                  0114 00322000
         STC   @15,DACTLEN(,@10)                                   0114 00323000
*             DACCTNO(1:DATALNG3) =   /* SAVE DATALIST ACCOUNT NUMBER*/ 00324000
*               DLACTNO(1:DATALNG3);                               0115 00325000
         BCTR  @15,0                                               0115 00326000
         L     @07,DLPTR3(,@07)                                    0115 00327000
         EX    @15,@SM00227                                        0115 00328000
*             IF DACCTNO(1:2) = '* '  /* DOES THE NEW ACCTNMBR = '*'?*/ 00329000
*             THEN                    /* YES,                        */ 00330000
         CLC   DACCTNO(2,@10),@CC00202                             0116 00331000
         BNE   @RF00116                                            0116 00332000
*               DO;                                                0117 00333000
*               MSGNMBR = 28;         /* SET ERROR MESSAGE NUMBER    */ 00334000
         MVI   MSGNMBR(CTABPTR),X'1C'                              0118 00335000
*               GOTO FREEPCL;         /* FREE PCL AND RETURN TO EFA20*/ 00336000
         B     FREEPCL                                             0119 00337000
*               END;                                               0120 00338000
*             IF DACTLEN = ACTLEN                                  0121 00339000
*               & ACCTNO(1:ACTLEN) = DACCTNO(1:ACTLEN)             0121 00340000
*               THEN                  /* OLD & NEW NAME ARE THE SAME */ 00341000
@RF00116 L     @10,DATALPTR(,CTABPTR)                              0121 00342000
         L     @07,NODELPTR(,CTABPTR)                              0121 00343000
         CLC   DACTLEN(1,@10),ACTLEN(@07)                          0121 00344000
         BNE   @RF00121                                            0121 00345000
         SLR   @15,@15                                             0121 00346000
         IC    @15,ACTLEN(,@07)                                    0121 00347000
         BCTR  @15,0                                               0121 00348000
         EX    @15,@SC00229                                        0121 00349000
         BNE   @RF00121                                            0121 00350000
*                 DO;                                              0122 00351000
*                 MSGNMBR = 29;       /* SET ERROR MSG NUMBER        */ 00352000
         MVI   MSGNMBR(CTABPTR),X'1D'                              0123 00353000
*                 GOTO FREEPCL;       /* FREE PCL AND RETURN TO EFA20*/ 00354000
         B     FREEPCL                                             0124 00355000
*                 END;                                             0125 00356000
*             GOTO PARSOK;            /* COMPLETE CONTROL TABLE      */ 00357000
         B     PARSOK                                              0126 00358000
*             END;                                                 0127 00359000
*         /* IS THE CHANGE LEVEL THE PROCNAME LEVEL?                 */ 00360000
*         IF NUMOFLV = 4                                           0128 00361000
*           THEN                                                   0128 00362000
@RF00107 CLI   NUMOFLV,4                                           0128 00363000
         BNE   @RF00128                                            0128 00364000
*             DO;                                                  0129 00365000
*             IF UNITKEY(16) = '0'B   /* WAS UNIT NAME SPECIFIED?    */ 00366000
*              & SIZEKEY(16) = '0'B   /* OR SIZE?                    */ 00367000
*              & DATAKEY(16) = '0'B   /* OR A NEW PROC NAME          */ 00368000
*               THEN                  /* THE COMMAND IS INVALID      */ 00369000
         L     @10,CHNPDLAD                                        0130 00370000
         TM    UNITKEY+1(@10),B'00000001'                          0130 00371000
         BNZ   @RF00130                                            0130 00372000
         TM    SIZEKEY+1(@10),B'00000001'                          0130 00373000
         BNZ   @RF00130                                            0130 00374000
         TM    DATAKEY+1(@10),B'00000001'                          0130 00375000
         BNZ   @RF00130                                            0130 00376000
*               DO;                                                0131 00377000
*               MSGNMBR = 2;          /* SET MESSAGE NUMBER          */ 00378000
         MVI   MSGNMBR(CTABPTR),X'02'                              0132 00379000
*               GOTO FREEPCL;         /* FREE PCL AND RETURN TO EFA20*/ 00380000
         B     FREEPCL                                             0133 00381000
*               END;                                               0134 00382000
*             IF DLFLG4 = '1'B        /* WAS A NEW PROC NAME SPEC. ? */ 00383000
*               THEN                  /* YES,                        */ 00384000
@RF00130 L     @10,CHNPDLAD                                        0135 00385000
         TM    DLFLG4(@10),B'10000000'                             0135 00386000
         BNO   @RF00135                                            0135 00387000
*                 DO;                                              0136 00388000
*                 DPROCNM = DLPROC(1:DATALNG4);                    0137 00389000
         L     @07,DATALPTR(,CTABPTR)                              0137 00390000
         MVI   DPROCNM+1(@07),C' '                                 0137 00391000
         MVC   DPROCNM+2(6,@07),DPROCNM+1(@07)                     0137 00392000
         LH    @15,DATALNG4(,@10)                                  0137 00393000
         BCTR  @15,0                                               0137 00394000
         L     @10,DLPTR4(,@10)                                    0137 00395000
         EX    @15,@SM00231                                        0137 00396000
*                 IF PROCNM = DPROCNM /* ARE OLD & NEW NAME THE SAME?*/ 00397000
*                   THEN                                           0138 00398000
         L     @10,NODELPTR(,CTABPTR)                              0138 00399000
         CLC   PROCNM(8,@10),DPROCNM(@07)                          0138 00400000
         BNE   @RF00138                                            0138 00401000
*                     DO;                                          0139 00402000
*                     MSGNMBR = 29;   /* SET ERROR MSG NUMBER        */ 00403000
         MVI   MSGNMBR(CTABPTR),X'1D'                              0140 00404000
*                     GOTO FREEPCL;   /* FREE PCL AND RETURN TO EFA20*/ 00405000
         B     FREEPCL                                             0141 00406000
*                     END;                                         0142 00407000
*                 END;                                             0143 00408000
@RF00138 DS    0H                                                  0144 00409000
*             END;                                                 0144 00410000
@RF00135 DS    0H                                                  0145 00411000
*PARSOK:  /* FILL IN THE APPROPRIATE FIELDS IN THE CHANGE CONTROL  0145 00412000
*            TABLE AND RETURN TO IKJEFA20.                           */ 00413000
*         CHLEVL = NUMOFLV;           /* NO. OF ITEMS FOUND IN THE 0145 00414000
*                                        NODELIST = CHANGE LEVEL     */ 00415000
@RF00128 DS    0H                                                  0145 00416000
PARSOK   MVC   CHLEVL(1,CTABPTR),NUMOFLV                           0145 00417000
*         MSGNMBR = 0;                /* 0- SUCCESSFUL COMPLETION    */ 00418000
         MVI   MSGNMBR(CTABPTR),X'00'                              0146 00419000
*FREEPCL: /* RELEASE DYNAMIC STORAGE OBTAINED FOR PARSE PCL.         */ 00420000
*         /* ISSUE FREEMAIN MACRO TO RELEASE DYNAMIC PCL             */ 00421000
*         CHPDLPTR = CHNPDLAD;        /* PTR TO THE PDL              */ 00422000
FREEPCL  L     @10,CHNPDLAD                                        0147 00423000
         ST    @10,CHPDLPTR(,CTABPTR)                              0147 00424000
*         IF PCLPTR ^= 0              /* IS THERE A PCL TO FREE?     */ 00425000
*           THEN                      /* YES,                        */ 00426000
         L     @10,PCLPTR                                          0148 00427000
         LTR   @10,@10                                             0148 00428000
         BZ    @RF00148                                            0148 00429000
*             GEN (FREEMAIN A=PCLPTR,MF=(E,DYNFRLST))              0149 00430000
*               REFS(DYNFRLST,PCLPTR,PLENGTH);                     0149 00431000
         FREEMAIN A=PCLPTR,MF=(E,DYNFRLST)                              00432000
*         RETURN;                     /* RETURN TO IKJEFA20 WITH THE    00433000
*                                        PARSE RETURN CODE           */ 00434000
         B     @EL00001                                            0150 00435000
*IKJEFA25:/***********************************************************/ 00436000
*         /* NODELIST VALIDITY CHECK EXIT ROUTINE -                  */ 00437000
*         /*   . CHECKS THE NUMBER OF ITEMS IN THE NODELIST          */ 00438000
*         /*   . IF THE COUNT IS 1 (USERID ONLY) AND THE USERID IS   */ 00439000
*         /*     '*', THE PARSE PCL WILL BE MODIFIED SO THAT THE     */ 00440000
*         /*     KEYWORDS 'SIZE', 'UNIT' & 'DATA' ARE BYPASSED LATER */ 00441000
*         /*     ON IN THE PARSING PROCESS. IF THE USERID IS NOT '*' */ 00442000
*         /*     THE PARSE PCL WILL BE MODIFIED SO THAT ONLY 'SIZE'  */ 00443000
*         /*     & 'UNIT' ARE BYPASSED. ALSO, THE SUBFIELD OFFSET    */ 00444000
*         /*     OF THE 'DATA' NAME PCE IS MODIFIED TO LOCATE A SUB- */ 00445000
*         /*     FIELD WITH A USERID DEFINITION.                     */ 00446000
*         /*   . IF THE COUNT IS 2, THE PCL WILL BE MODIFIED SO THAT */ 00447000
*         /*     THE 'SIZE' & 'UNIT' KEYWORDS ARE BYPASSED AND THE   */ 00448000
*         /*     'DATA' SUBFIELD LOCATES A PASSWORD DEFINITION.      */ 00449000
*         /*   . IF THE COUNT IS 3, THE PCL WILL BE MODIFIED SO THAT */ 00450000
*         /*     THE 'SIZE' & 'UNIT' KEYWORDS ARE BYPASSED AND THE   */ 00451000
*         /*     'DATA' SUBFIELD LOCATES AN ACCTNMBR DEFINITION.     */ 00452000
*         /*   . IF THE COUNT IS 4, THE PCL WILL BE MODIFIED SO THAT */ 00453000
*         /*     'DATA' SUBFIELD LOCATES A PROCNAME DEFINITION.      */ 00454000
*         /***********************************************************/ 00455000
*         PROC OPTIONS(NOSAVEAREA);                                0151 00456000
IKJEFA25 STM   @14,@12,12(@13)                                     0151 00457000
*         RFY (R1,R2) RSTD;                                        0152 00458000
*         R2 = R1;                    /* GET SAVE AREA PTR           */ 00459000
         LR    R2,R1                                               0153 00460000
*         GEN (LM  R2,R12,28(R2));    /* RESTORE REGISTERS           */ 00461000
         LM  R2,R12,28(R2)                                              00462000
*         SAVE13 = R13;               /* SAVE IKJEFA55 SAVE AREA PTR */ 00463000
         LR    SAVE13,R13                                          0155 00464000
*         R13 = R1;                   /* SET SAVE AREA PTR           */ 00465000
         LR    R13,R1                                              0156 00466000
*         RFY (R1,R2) UNRSTD;                                      0157 00467000
*         SUBFPTR = PCLPTR+DATSUBFO;  /* POINT TO DATA SUBFIELD OFF. */ 00468000
         L     @10,PCLPTR                                          0158 00469000
         LH    SUBFPTR,DATSUBFO                                    0158 00470000
         ALR   SUBFPTR,@10                                         0158 00471000
*         DATAPTR = PCLPTR+DATAOF;    /* POINT TO DATA KEYWORD PCE   */ 00472000
         LH    DATAPTR,DATAOF                                      0159 00473000
         ALR   DATAPTR,@10                                         0159 00474000
*         IF NUMOFLV = 1              /* IS THE CHANGE LEVEL USERID? */ 00475000
*           THEN                      /* YES,                        */ 00476000
         CLI   NUMOFLV,1                                           0160 00477000
         BNE   @RF00160                                            0160 00478000
*             DO;                                                  0161 00479000
*             IF USRID(1) = '*'       /* IS THE USERID AN ASTERISK?  */ 00480000
*               THEN                  /* YES,                        */ 00481000
         L     @05,NODELPTR(,CTABPTR)                              0162 00482000
         CLI   USRID(@05),C'*'                                     0162 00483000
         BNE   @RF00162                                            0162 00484000
*                 DO;                                              0163 00485000
*                 PCEPTR = PCLPTR+NOLIMLNO; /* POINT TO NOLIM PCE    */ 00486000
         AH    @10,NOLIMLNO                                        0164 00487000
         LR    PCEPTR,@10                                          0164 00488000
*                 PCELNG = SZUNDASK;  /* MODIFY 'NOLIM' PCE LENGTH SO   00489000
*                                        THAT PARSE WILL BYPASS THE     00490000
*                                        SIZE, UNIT, & DATA KEYWORDS */ 00491000
         LH    @10,SZUNDASK                                        0165 00492000
         STH   @10,PCELNG(,PCEPTR)                                 0165 00493000
*                 GOTO CLEANUP;       /* GO CLEAN UP AND EXIT        */ 00494000
         B     CLEANUP                                             0166 00495000
*                 END;                                             0167 00496000
*             DATAFLG(5) = '0'B;      /* TURN OFF DEFAULT BIT FOR THE   00497000
*                                        'DATA' KEYWORD - THIS MAKES    00498000
*                                        THE KEYWORD OPTIONAL        */ 00499000
@RF00162 NI    DATAFLG(DATAPTR),B'11110111'                        0168 00500000
*             SUBFOF = USSUBOF;       /* SET SUBFIELD OFFSET TO    0169 00501000
*                                        USERID IKJSUBF & IKJIDENT   */ 00502000
         LH    @10,USSUBOF                                         0169 00503000
         STH   @10,SUBFOF(,SUBFPTR)                                0169 00504000
*             GOTO SKIPSZUN;          /* GO SET BYPASS OF SZE & UNIT */ 00505000
         B     SKIPSZUN                                            0170 00506000
*             END;                                                 0171 00507000
*         IF NUMOFLV = 2              /* IS THE CHANGE LEVEL PASSWD? */ 00508000
*           THEN                      /* YES,                        */ 00509000
@RF00160 CLI   NUMOFLV,2                                           0172 00510000
         BNE   @RF00172                                            0172 00511000
*             DO;                                                  0173 00512000
*             SUBFOF = PASUBOF;       /* SET SUBFIELD OFFSET TO    0174 00513000
*                                        PASSWORD IKJSUBF & IKJIDENT */ 00514000
         LH    @10,PASUBOF                                         0174 00515000
         STH   @10,SUBFOF(,SUBFPTR)                                0174 00516000
*             GOTO SKIPSZUN;          /* GO SET BYPASS OF SZE & UNIT */ 00517000
         B     SKIPSZUN                                            0175 00518000
*             END;                                                 0176 00519000
*         IF NUMOFLV = 3              /* IS THE CHANGE LEVEL ACCTNM? */ 00520000
*           THEN                      /* YES,                        */ 00521000
@RF00172 CLI   NUMOFLV,3                                           0177 00522000
         BNE   @RF00177                                            0177 00523000
*             DO;                                                  0178 00524000
*             SUBFOF = ACSUBOF;       /* SET SUBFIELD OFFSET TO    0179 00525000
*                                        ACCTNMBR IKJSUBF & IKJIDENT */ 00526000
         LH    @10,ACSUBOF                                         0179 00527000
         STH   @10,SUBFOF(,SUBFPTR)                                0179 00528000
*             GOTO SKIPSZUN;          /* GO SET BYPASS OF SZE & UNIT */ 00529000
         B     SKIPSZUN                                            0180 00530000
*             END;                                                 0181 00531000
*         DATAFLG(5) = '0'B;          /* TURN OFF DEFAULT BIT FOR THE   00532000
*                                        'DATA' KEYWORD - THIS MAKES    00533000
*                                        THE KEYWORD OPTIONAL        */ 00534000
@RF00177 NI    DATAFLG(DATAPTR),B'11110111'                        0182 00535000
*         GOTO CLEANUP;               /* GO CLEAN UP AND EXIT        */ 00536000
         B     CLEANUP                                             0183 00537000
*SKIPSZUN:/* SET 'NOLIM' NAME PCE LENGTH SO THAT PARSE BYPASSES      */ 00538000
*         /* THE SIZE AND UNIT KEYWORD DEFINITIONS.                  */ 00539000
*         PCEPTR = PCLPTR+NOLIMLNO;   /* POINT TO NOLIM PCE          */ 00540000
SKIPSZUN LH    PCEPTR,NOLIMLNO                                     0184 00541000
         AL    PCEPTR,PCLPTR                                       0184 00542000
*         PCELNG = SZUNSKIP;          /* FOR USERID, PASSWORD, AND 0185 00543000
*                                        ACCTNMBR                    */ 00544000
         LH    @10,SZUNSKIP                                        0185 00545000
         STH   @10,PCELNG(,PCEPTR)                                 0185 00546000
*CLEANUP: /* THE PARSE PCL HAS BEEN MODIFIED TO MATCH THE NODELIST   */ 00547000
*         PCEPTR = PCLPTR+SUBFOF;     /* POINT TO ACTIVE PCE         */ 00548000
CLEANUP  LH    PCEPTR,SUBFOF(,SUBFPTR)                             0186 00549000
         AL    PCEPTR,PCLPTR                                       0186 00550000
*         PCELNG = PCLLNGTH-1;        /* POINT TO END OF PCL TO TELL    00551000
*                                        PARSE THIS IS THE ONLY PCE  */ 00552000
         L     @10,PCLMDLAD                                        0187 00553000
         LH    @10,PCLLNGTH(,@10)                                  0187 00554000
         BCTR  @10,0                                               0187 00555000
         STH   @10,PCELNG(,PCEPTR)                                 0187 00556000
*         R13 = SAVE13;               /* ADDR OF CALLER'S SAVE AREA  */ 00557000
         LR    R13,SAVE13                                          0188 00558000
*         RETURN CODE(0);                                          0189 00559000
         SLR   @15,@15                                             0189 00560000
         L     @14,12(,@13)                                        0189 00561000
         LM    @00,@12,20(@13)                                     0189 00562000
         BR    @14                                                 0189 00563000
*         END IKJEFA25;                                            0190 00564000
*         END IKJEFA24                                             0191 00565000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00566000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 00567000
*;                                                                 0191 00568000
@DATA    DS    0H                                                       00569000
@CH00195 DC    H'20'                                                    00570000
@SM00217 MVC   DYNLFORM(0),INLINLFM                                     00571000
@SM00220 MVC   UNITNAM(0,@07),UNIT(@10)                                 00572000
@SM00223 MVC   DUSRID(0,@07),DLUSID(@10)                                00573000
@SM00225 MVC   DPASSWD(0,@10),DLPASS(@07)                               00574000
@SM00227 MVC   DACCTNO(0,@10),DLACTNO(@07)                              00575000
@SC00229 CLC   ACCTNO(0,@07),DACCTNO(@10)                               00576000
@SM00231 MVC   DPROCNM(0,@07),DLPROC(@10)                               00577000
@DATD    DSECT                                                          00578000
         DS    0F                                                       00579000
@SA00001 DS    18F                                                      00580000
IKJEFA24 CSECT                                                          00581000
         DS    0F                                                       00582000
@DATD    DSECT                                                          00583000
         DS    0D                                                       00584000
CHNPDLAD DS    A                                                        00585000
VCHKPL   DS    CL26                                                     00586000
         ORG   VCHKPL                                                   00587000
EXITADD  DS    AL4                                                      00588000
EXITRTCD DS    AL4                                                      00589000
NODEPTR  DS    AL4                                                      00590000
PERFPTR  DS    AL4                                                      00591000
PPLPTR   DS    AL4                                                      00592000
SAVARAD  DS    AL4                                                      00593000
CMDIND   DS    FL1                                                      00594000
NUMOFLV  DS    FL1                                                      00595000
         ORG   VCHKPL+26                                                00596000
         DS    CL2                                                      00597000
PARSLIST DS    CL28                                                     00598000
@NM00009 DS    CL8                                                      00599000
         ORG   @NM00009                                                 00600000
PCLPTR   DS    AL4                                                      00601000
PLENGTH  DS    AL4                                                      00602000
         ORG   @NM00009+8                                               00603000
IKJEFA24 CSECT                                                          00604000
         DS    0F                                                       00605000
@SIZDATD DC    AL1(1)                                                   00606000
         DC    AL3(@ENDDATD-@DATD)                                      00607000
         DS    0D                                                       00608000
PCLMDLAD DC    AL4(PCLMODEL)                                            00609000
SZUNSKIP DC    AL2(DATAPCE-NOLIMPCE)                                    00610000
SZUNDASK DC    AL2(SUBFPCES-NOLIMPCE)                                   00611000
DATAOF   DC    AL2(DATAPCE-PCLSTART)                                    00612000
ACSUBOF  DC    AL2(ACCTPCE-PCLSTART+1)                                  00613000
PASUBOF  DC    AL2(PASSPCE-PCLSTART+1)                                  00614000
USSUBOF  DC    AL2(USERPCE-PCLSTART+1)                                  00615000
NOLIMLNO DC    AL2(NOLIMPCE-PCLSTART+2)                                 00616000
DATSUBFO DC    AL2(SUBFPCES-PCLSTART-2)                                 00617000
@CC00202 DC    C'* '                                                    00618000
@DATD    DSECT                                                          00619000
IKJEFA24 CSECT                                                          00620000
         EXTRN ACCTEXTR                 ADDR OF PARSE VALIDCK EXIT      00621000
         EXTRN IKJEFA55                 ADDR OF PARSE VALIDCK EXIT      00622000
         EXTRN PASSEXTR                 ADDR OF PARSE VALIDCK EXIT      00623000
         EXTRN PERFEXIT                 ADDR OF PARSE VALIDCK EXIT      00624000
         EXTRN PROCEXTR                 ADDR OF PARSE VALIDCK EXIT      00625000
         EXTRN SIZEEXIT                 ADDR OF PARSE VALIDCK EXIT      00626000
         EXTRN USDAEXIT                 ADDR OF PARSE VALIDCK EXIT      00627000
         EXTRN USIDEXTR                 ADDR OF PARSE VALIDCK EXIT      00628000
PCLMODEL CSECT                                                          00629000
PCLSTART EQU   *                                                        00630000
PCLMODEL IKJPARM  DSECT=CHNGPDLD                                        00631000
NODEPDE  IKJPOSIT PSTRING,PROMPT='(NODELIST)',VALIDCK=IKJEFA55,        *00632000
               HELP=('NODELIST - FORMAT IS (USERID / PASSWORD / ACCOUNT*00633000
                NUMBER / PROCEDURE NAME)')                              00634000
OPERPDE  IKJKEYWD                                                       00635000
         IKJNAME  'OPER'                                                00636000
         IKJNAME  'NOOPER'                                              00637000
ACCTPDE  IKJKEYWD                                                       00638000
         IKJNAME  'ACCT'                                                00639000
         IKJNAME  'NOACCT'                                              00640000
JCLPDE   IKJKEYWD                                                       00641000
         IKJNAME  'JCL'                                                 00642000
         IKJNAME  'NOJCL'                                               00643000
MONTPDE  IKJKEYWD                                                       00644000
         IKJNAME  'MOUNT'                                               00645000
         IKJNAME  'NOMOUNT'                                             00646000
USERPDE  IKJKEYWD                                                       00647000
         IKJNAME  'USERDATA',SUBFLD=USDASUB                             00648000
DESTPDE  IKJKEYWD                                                       00649000
         IKJNAME  'DESTINATION',SUBFLD=DESTSUB                          00650000
         IKJNAME  'NODEST'                                              00651000
PERFPDE  IKJKEYWD                                                       00652000
         IKJNAME  'PERFORM',SUBFLD=PERFSUB                              00653000
         IKJNAME  'NOPERFORM'                                           00654000
MAXSZPDE IKJKEYWD                                                       00655000
         IKJNAME  'MAXSIZE',SUBFLD=MAXSUB                               00656000
NOLIMPCE EQU      *             THIS STATEMENT MUST IMMEDIATELY PRECEDE*00657000
                                THE NOLIM GROUP SINCE THE PCE LENGTH OF*00658000
                                THE 'NOLIM' PCE MAY BE MODIFIED TO      00659000
*                               OVERLAP 'SIZEPDE', 'UNITPDE' AND       *00660000
                                POSSIBLY 'DATAPDE' - SEE IKJEFA25       00661000
         IKJNAME  'NOLIM'                                               00662000
SIZEPDE  IKJKEYWD                                                       00663000
         IKJNAME  'SIZE',SUBFLD=SIZESUB                                 00664000
UNITPDE  IKJKEYWD                                                       00665000
         IKJNAME  'UNIT',SUBFLD=UNITSUB                                 00666000
DATAPCE  EQU      *                                                     00667000
DATAPDE  IKJKEYWD DEFAULT='DATA'                                        00668000
         IKJNAME  'DATA',SUBFLD=PROCSUB                                 00669000
SUBFPCES EQU      *                                                     00670000
USDASUB  IKJSUBF                                                        00671000
USERDAT  IKJIDENT 'INSTALLATION DATA',MAXLNTH=4,FIRST=ALPHANUM,        *00672000
               OTHER=ALPHANUM,VALIDCK=USDAEXIT,                        *00673000
               HELP=('FOUR EBCDIC CHARACTERS REPRESENTING HEX DIGITS'),*00674000
               PROMPT='INSTALLATION DATA'                               00675000
DESTSUB  IKJSUBF                                                        00676000
DESTNAM  IKJIDENT 'DESTINATION',MAXLNTH=7,FIRST=ALPHA,                 *00677000
               OTHER=ALPHANUM,PROMPT='DESTINATION NAME',               *00678000
               HELP=('A SEVEN CHARACTER USERID DESTINATION')            00679000
PERFSUB  IKJSUBF                                                        00680000
PERFNAM  IKJIDENT 'PERFORMANCE GROUP',LIST,MAXLNTH=3,FIRST=NUMERIC,    *00681000
               OTHER=NUMERIC,VALIDCK=PERFEXIT,                         *00682000
               PROMPT='PERFORMANCE GROUP(S)',                          *00683000
               HELP=('A LIST OF NUMBERS BETWEEN 1 AND 255')             00684000
MAXSUB   IKJSUBF                                                        00685000
MAXSZ    IKJIDENT 'MAXSIZE VALUE',MAXLNTH=5,FIRST=NUMERIC,             *00686000
               OTHER=NUMERIC,                                          *00687000
               PROMPT='MAXIMUM REGION SIZE FOR THIS USERID',           *00688000
               HELP=('A NUMBER LESS THAN 65535'),VALIDCK=SIZEEXIT       00689000
SIZESUB  IKJSUBF                                                        00690000
SIZNO    IKJIDENT 'SIZE VALUE',MAXLNTH=5,FIRST=NUMERIC,OTHER=NUMERIC,  *00691000
               PROMPT='REGION SIZE FOR PROCEDURE(S)',                  *00692000
               HELP=('A NUMBER LESS THAN 65535'),VALIDCK=SIZEEXIT       00693000
UNITSUB  IKJSUBF                                                        00694000
UNITNAME IKJIDENT 'UNIT NAME',MAXLNTH=8,FIRST=ALPHANUM,                *00695000
               HELP=('AN EIGHT CHARACTER DEVICE GROUP GENERIC NAME'),  *00696000
               OTHER=ALPHANUM,PROMPT='DEVICE GROUP GENERIC NAME'        00697000
PROCSUB  IKJSUBF                                                        00698000
PROCD    IKJIDENT 'DATALIST-PROCEDURE NAME',MAXLNTH=8,FIRST=ANY,       *00699000
               OTHER=ALPHANUM,VALIDCK=PROCEXTR,                        *00700000
               PROMPT='NEW PROCEDURE NAME'                              00701000
ACCTPCE  EQU      *                                                     00702000
ACCTSUB  IKJSUBF                                                        00703000
ACCTD    IKJIDENT 'DATALIST-ACCOUNT NUMBER',MAXLNTH=40,FIRST=ANY,      *00704000
               OTHER=ANY,VALIDCK=ACCTEXTR,PROMPT='NEW ACCOUNT NUMBER'   00705000
PASSPCE  EQU      *                                                     00706000
PASSSUB  IKJSUBF                                                        00707000
PASSD    IKJIDENT 'DATALIST-PASSWORD',MAXLNTH=8,FIRST=ANY,             *00708000
               OTHER=ALPHANUM,VALIDCK=PASSEXTR,PROMPT='NEW PASSWORD'    00709000
USERPCE  EQU      *                                                     00710000
USERSUB  IKJSUBF                                                        00711000
USERNAM  IKJIDENT 'DATALIST-USERID',MAXLNTH=7,FIRST=ANY,               *00712000
               OTHER=ALPHANUM,VALIDCK=USIDEXTR,PROMPT='NEW USERID'      00713000
         IKJENDP                                                        00714000
@DATD    DSECT                                                          00715000
IKJEFA24 CSECT                                                          00716000
INLINLFM DS    0F                                                       00717000
         FREEMAIN V,SP=1,MF=L             LENGTH & ADD SET BY E         00718000
         GETMAIN  EC,SP=1,MF=L            LENGTH & ANS PTR SET BY E     00719000
INLINLNG DC    A(*-INLINLFM)              LENGTH OF L-FORM MACROS       00720000
@DATD    DSECT                                                          00721000
DYNLFORM DS    0F                                                       00722000
DYNFRLST FREEMAIN V,SP=1,MF=L             LENGTH & ADD SET BY E         00723000
DYNGTLST GETMAIN  EC,MF=L                 WILL BE INIT'D FROM INLINGTM  00724000
IKJEFA24 CSECT                                                          00725000
         DS   0H                                                        00726000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   00727000
@DATD    DSECT                                                          00728000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00729000
@ENDDATD EQU   *                                                        00730000
IKJEFA24 CSECT                                                          00731000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00732000
@01      EQU   01                                                       00733000
@02      EQU   02                                                       00734000
@03      EQU   03                                                       00735000
@04      EQU   04                                                       00736000
@05      EQU   05                                                       00737000
@06      EQU   06                                                       00738000
@07      EQU   07                                                       00739000
@08      EQU   08                                                       00740000
@09      EQU   09                                                       00741000
@10      EQU   10                                                       00742000
@11      EQU   11                                                       00743000
@12      EQU   12                                                       00744000
@13      EQU   13                                                       00745000
@14      EQU   14                                                       00746000
@15      EQU   15                                                       00747000
SUBFPTR  EQU   @03                                                      00748000
DATAPTR  EQU   @04                                                      00749000
PCEPTR   EQU   @02                                                      00750000
SAVE13   EQU   @07                                                      00751000
RETNCODE EQU   @04                                                      00752000
CTABPTR  EQU   @06                                                      00753000
R0       EQU   @00                                                      00754000
R1       EQU   @01                                                      00755000
R2       EQU   @02                                                      00756000
R13      EQU   @13                                                      00757000
R14      EQU   @14                                                      00758000
R15      EQU   @15                                                      00759000
R12      EQU   @12                                                      00760000
PPL      EQU   0                                                        00761000
PPLPCL   EQU   PPL+12                                                   00762000
PPLANS   EQU   PPL+16                                                   00763000
PPLCBUF  EQU   PPL+20                                                   00764000
PPLUWA   EQU   PPL+24                                                   00765000
ACCTPL   EQU   0                                                        00766000
BUFPTR   EQU   ACCTPL+12                                                00767000
CTRLTAB  EQU   0                                                        00768000
ACCTPLP  EQU   CTRLTAB                                                  00769000
CHPDLPTR EQU   CTRLTAB+4                                                00770000
DATALPTR EQU   CTRLTAB+8                                                00771000
NODELPTR EQU   CTRLTAB+12                                               00772000
RETCODE  EQU   CTRLTAB+32                                               00773000
CHLEVL   EQU   CTRLTAB+36                                               00774000
MSGNMBR  EQU   CTRLTAB+38                                               00775000
SIZESW   EQU   CTRLTAB+39                                               00776000
UNITSW   EQU   CTRLTAB+39                                               00777000
PCLLNGTH EQU   0                                                        00778000
PCELNG   EQU   0                                                        00779000
DATAFLG  EQU   0                                                        00780000
SUBFOF   EQU   0                                                        00781000
@NM00010 EQU   0                                                        00782000
OPERKEY  EQU   @NM00010+16                                              00783000
ACCTKEY  EQU   @NM00010+18                                              00784000
JCLKEY   EQU   @NM00010+20                                              00785000
MONTKEY  EQU   @NM00010+22                                              00786000
USDAKEY  EQU   @NM00010+24                                              00787000
DESTKEY  EQU   @NM00010+26                                              00788000
PERFKEY  EQU   @NM00010+28                                              00789000
MAXSKEY  EQU   @NM00010+30                                              00790000
SIZEKEY  EQU   @NM00010+32                                              00791000
UNITKEY  EQU   @NM00010+34                                              00792000
DATAKEY  EQU   @NM00010+36                                              00793000
SIZEHEX  EQU   @NM00010+82                                              00794000
UNITPTR  EQU   @NM00010+84                                              00795000
UNITLNG  EQU   @NM00010+88                                              00796000
DLPTR4   EQU   @NM00010+92                                              00797000
DATALNG4 EQU   @NM00010+96                                              00798000
DLFLG4   EQU   @NM00010+98                                              00799000
DLPTR3   EQU   @NM00010+100                                             00800000
DATALNG3 EQU   @NM00010+104                                             00801000
DLFLG3   EQU   @NM00010+106                                             00802000
DLPTR2   EQU   @NM00010+108                                             00803000
DATALNG2 EQU   @NM00010+112                                             00804000
DLFLG2   EQU   @NM00010+114                                             00805000
DLPTR1   EQU   @NM00010+116                                             00806000
DATALNG1 EQU   @NM00010+120                                             00807000
DLFLG1   EQU   @NM00010+122                                             00808000
DLUSID   EQU   0                                                        00809000
DLPASS   EQU   0                                                        00810000
DLACTNO  EQU   0                                                        00811000
DLPROC   EQU   0                                                        00812000
UNIT     EQU   0                                                        00813000
NLSTTAB  EQU   0                                                        00814000
USRID    EQU   NLSTTAB+1                                                00815000
PASSWD   EQU   NLSTTAB+9                                                00816000
ACTLEN   EQU   NLSTTAB+17                                               00817000
ACCTNO   EQU   NLSTTAB+18                                               00818000
PROCNM   EQU   NLSTTAB+58                                               00819000
DLSTTAB  EQU   0                                                        00820000
DUSRLEN  EQU   DLSTTAB                                                  00821000
DUSRID   EQU   DLSTTAB+1                                                00822000
DPASSWD  EQU   DLSTTAB+9                                                00823000
DACTLEN  EQU   DLSTTAB+17                                               00824000
DACCTNO  EQU   DLSTTAB+18                                               00825000
DPROCNM  EQU   DLSTTAB+58                                               00826000
SIZE     EQU   DLSTTAB+66                                               00827000
UNITNAM  EQU   DLSTTAB+68                                               00828000
PERFGRP  EQU   DLSTTAB+76                                               00829000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00830000
@NM00026 EQU   NLSTTAB                                                  00831000
@NM00025 EQU   @NM00010+122                                             00832000
@NM00024 EQU   @NM00010+114                                             00833000
@NM00023 EQU   @NM00010+106                                             00834000
@NM00022 EQU   @NM00010+98                                              00835000
@NM00021 EQU   @NM00010+90                                              00836000
@NM00020 EQU   @NM00010+90                                              00837000
@NM00019 EQU   @NM00010+80                                              00838000
@NM00018 EQU   @NM00010+76                                              00839000
@NM00017 EQU   @NM00010+68                                              00840000
@NM00016 EQU   @NM00010+56                                              00841000
@NM00015 EQU   @NM00010+48                                              00842000
@NM00014 EQU   @NM00010+40                                              00843000
@NM00013 EQU   @NM00010+38                                              00844000
@NM00012 EQU   @NM00010+8                                               00845000
@NM00011 EQU   @NM00010                                                 00846000
@NM00008 EQU   CTRLTAB+39                                               00847000
@NM00007 EQU   CTRLTAB+37                                               00848000
@NM00006 EQU   CTRLTAB+28                                               00849000
@NM00005 EQU   CTRLTAB+24                                               00850000
@NM00004 EQU   CTRLTAB+20                                               00851000
@NM00003 EQU   CTRLTAB+16                                               00852000
@NM00002 EQU   ACCTPL+16                                                00853000
@NM00001 EQU   ACCTPL                                                   00854000
PPLECB   EQU   PPL+8                                                    00855000
PPLECT   EQU   PPL+4                                                    00856000
PPLUPT   EQU   PPL                                                      00857000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00858000
@RC00063 EQU   FREEPCL                                                  00859000
@RF00085 EQU   PARSOK                                                   00860000
@RF00100 EQU   PARSOK                                                   00861000
@RF00121 EQU   PARSOK                                                   00862000
@RF00148 EQU   @EL00001                                                 00863000
@PB00002 EQU   @EL00001                                                 00864000
@ENDDATA EQU   *                                                        00865000
         END   IKJEFA24                                                 00866000
