         TITLE 'IKJEFA30  --  ACCOUNT/DELETE COMMAND PROCEDURE         *00001000
                        '                                               00002000
IKJEFA30 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFA30  74.071'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
*          ACCTPLP = R1;              /* SAVE INPUT REGISTER 1       */ 00022000
         LR    ACCTPLP,R1                                          0044 00023000
*          RFY R1 UNRSTD;             /* RELEASE PARM POINTER        */ 00024000
*          DELECF = '0'B;             /* CLEAR DELETE CONTROL FLAGS  */ 00025000
         MVI   DELECF,B'00000000'                                  0046 00026000
*          IOPLPTR = ADDR(PLOUT);     /* INITIALIZE PUTLINE POINTER  */ 00027000
         LA    IOPLPTR,PLOUT                                       0047 00028000
*          PLOUT = ACCTPL;            /* INITIALIZE COMMUNICATION PL */ 00029000
         MVC   PLOUT(16),ACCTPL(ACCTPLP)                           0048 00030000
*          IOPLIOPB = ADDR(PTPBK);    /* POINT TO MULTILINE PARM     */ 00031000
         LA    @10,PTPBK                                           0049 00032000
         ST    @10,IOPLIOPB(,IOPLPTR)                              0049 00033000
*          UIDLPTR  =  0;             /* CLEAR UDL PTR               */ 00034000
         SLR   @10,@10                                             0050 00035000
         ST    @10,UIDLPTR(,ACCTPLP)                               0050 00036000
*          /* INITIALIZE COMMUNICATION REGION                        */ 00037000
*          COMAREA = COMAREA && COMAREA; /* CLEAR PARM BLOCK         */ 00038000
         XC    COMAREA(11),COMAREA                                 0051 00039000
*          DPL = DPL&&DPL;            /* CLEAR DELETE POINT LIST     */ 00040000
         XC    DPL(121),DPL                                        0052 00041000
*          NDLSTPDE = NDLSTPDE&&NDLSTPDE;/* CLEAR DUMMY PDE AREA     */ 00042000
         XC    NDLSTPDE(36),NDLSTPDE                               0053 00043000
*          /* INITIALIZE PARAMETER BLOCKS FOR ENQUEUE, OPEN, CLOSE,  */ 00044000
*          /*            DEQUEUE AND DATA CONTROL BLOCK              */ 00045000
*          CPLS(1:MCPLLNG) = MCPLS(1:MCPLLNG);                     0054 00046000
         L     @05,MCPLLNG                                         0054 00047000
         BCTR  @05,0                                               0054 00048000
         EX    @05,@SM00437                                        0054 00049000
*          DIRDCB = MDIRDCB;          /* MOVE DIRECTORY DCB TO DIRWA */ 00050000
         MVC   DIRDCB(88),MDIRDCB                                  0055 00051000
*          /* INITIALIZE READ/WRITE PARAMETER BLOCK                  */ 00052000
*          ACIOPTR = ADDR(ACIOPARM);  /* POINT TO PARAMETER BLOCK    */ 00053000
         LA    @05,ACIOPARM                                        0056 00054000
         ST    @05,ACIOPTR                                         0056 00055000
*          ACIOPARM = ACIOPARM&&ACIOPARM;/* CLEAR PARM BLOCK         */ 00056000
         XC    ACIOPARM(24),ACIOPARM                               0057 00057000
*          ACIODCBA = ADDR(DELDCB);   /* SET PTR TO UADS DCB         */ 00058000
         LA    @05,DELDCB                                          0058 00059000
         STCM  @05,7,ACIODCBA                                      0058 00060000
*          ACIOPUTL = ACCTPLP;        /* SET PTR TO ACCOUNT  P L     */ 00061000
         ST    ACCTPLP,ACIOPUTL                                    0059 00062000
*          MSGID = '8';               /* SET DELETE IDENTIFIER       */ 00063000
         MVI   MSGID,C'8'                                          0060 00064000
*          /* INITIALIZE PARSE PARAMETER CONTROL LIST (PCL) FR. MODEL*/ 00065000
*          /* PCL MUST BE MOVED INTO DYNAMIC STORAGE SINCE IT WILL BE*/ 00066000
*          /* MODIFIED IN THE NODELIST VALIDITY CK EXIT RTNE-NLSTEXIT*/ 00067000
*          PCLPTR = 0;                /* SET PTR T0 0                */ 00068000
         ST    @10,PCLPTR                                          0061 00069000
*          RFY R0 RSTD;               /* RESERVE REG. FOR GETMAIN    */ 00070000
*          R0=PCLLNGTH;               /* SET LENGTH = PCL SIZE       */ 00071000
         L     @10,PCLMDLAD                                        0063 00072000
         LH    R0,PCLLNGTH(,@10)                                   0063 00073000
*          PLENGTH=R0;                /* SAVE LENGTH FOR FREEMAIN    */ 00074000
         ST    R0,PLENGTH                                          0064 00075000
*          /* USE OS/360 GETMAIN MACRO TO OBTAIN WORK AREA.          */ 00076000
*          GEN (GETMAIN EC,LV=(R0),A=PCLPTR,MF=(E,GMLST))          0065 00077000
*            SETS(PCLPTR) REFS(R0,GMLST);                          0065 00078000
         GETMAIN EC,LV=(R0),A=PCLPTR,MF=(E,GMLST)                       00079000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00080000
*          RETNCODE=R15;              /* SAVE GETMAIN RETURN CODE    */ 00081000
         LR    RETNCODE,R15                                        0067 00082000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00083000
*          IF RETNCODE^=0             /* GETMAIN FAILED?             */ 00084000
*            THEN                     /* YES,                        */ 00085000
         LTR   RETNCODE,RETNCODE                                   0069 00086000
         BNZ   @RT00069                                            0069 00087000
*              GOTO NOSPAZ;           /* GO PUT OUT MESSAGE & LEAVE  */ 00088000
*          RFY (R1,R14,R15) RSTD;     /* RESTRICT WORK REGISTERS     */ 00089000
*          R0=PCLPTR;                 /* GET TO ADDRESS              */ 00090000
         L     R0,PCLPTR                                           0072 00091000
*          R1=PLENGTH;                /* LOAD R1 WITH LENGTH         */ 00092000
         L     @10,PLENGTH                                         0073 00093000
         LR    R1,@10                                              0073 00094000
*          R14=PCLMDLAD;              /* GET FROM ADDRESS            */ 00095000
         L     R14,PCLMDLAD                                        0074 00096000
*          R15=PLENGTH;               /* LOAD R15 WITH LENGTH        */ 00097000
         LR    R15,@10                                             0075 00098000
*          GEN (MVCL  R0,R14)         /* MOVE PCL TO GOTTEN CORE     */ 00099000
*            REFS(R0,R1,R14,R15);                                  0076 00100000
         MVCL  R0,R14                                                   00101000
*          RFY (R0,R1,R14,R15) UNRSTD;/* RELEASE WORK REGISTERS      */ 00102000
*          PPLPTR=ADDR(PARSLIST);     /* ESTABLISH PPL ADDRESSABLTY  */ 00103000
         LA    @10,PARSLIST                                        0078 00104000
         ST    @10,PPLPTR                                          0078 00105000
*          EXITADD=ADDR(NLSTEXIT);    /* POINT TO ADD'S EXIT         */ 00106000
         LA    @15,NLSTEXIT                                        0079 00107000
         ST    @15,EXITADD                                         0079 00108000
*          NODEPTR=ADDR(NLSTTAB);     /* POINT TO THE NODELIST TAB   */ 00109000
         LA    @15,NLSTTAB                                         0080 00110000
         ST    @15,NODEPTR                                         0080 00111000
*          CMDIND=3;                  /* INDICATE DEL CMD NODELIST   */ 00112000
         MVI   CMDIND,X'03'                                        0081 00113000
*          RFY R13 RSTD;              /* RESTRICT SAVE AREA POINTER  */ 00114000
*          SAVARAD=R13;               /* POINT TO DELETE'S SAVEAREA  */ 00115000
         ST    R13,SAVARAD                                         0083 00116000
*          /* INITIALIZE PARSE PARAMETER LIST                        */ 00117000
*          DELPDLAD = 0;              /* INIT PTR TO 0               */ 00118000
         SLR   @15,@15                                             0084 00119000
         ST    @15,DELPDLAD                                        0084 00120000
*          PARSLIST(1:12)=ACCTPL;     /* FIRST THREE WORDS FROM    0085 00121000
*                                        ACCOUNT PARAMETER LIST      */ 00122000
         MVC   PARSLIST(12),ACCTPL(ACCTPLP)                        0085 00123000
*          PPLPCL=PCLPTR;             /* ADDRESS OF DYNAMIC PCL      */ 00124000
         L     @15,PCLPTR                                          0086 00125000
         ST    @15,PPLPCL(,@10)                                    0086 00126000
*          PPLANS=ADDR(DELPDLAD);     /* ADDPDLAD WILL CONTAIN ADD.     00127000
*                                        OF PDL AFTER PARSE EXECUTES */ 00128000
         LA    @15,DELPDLAD                                        0087 00129000
         ST    @15,PPLANS(,@10)                                    0087 00130000
*          PPLCBUF=CMDBUFAD;          /* ADDR OF ADD COMMAND BUFFER  */ 00131000
         L     @15,CMDBUFAD(,ACCTPLP)                              0088 00132000
         ST    @15,PPLCBUF(,@10)                                   0088 00133000
*          PPLUWA=ADDR(VCHKPL);       /* ADDRESS OF EXIT ROUTINE   0089 00134000
*                                          PARAMETER LIST            */ 00135000
         LA    @15,VCHKPL                                          0089 00136000
         ST    @15,PPLUWA(,@10)                                    0089 00137000
*          /*  LINK TO PARSE SERVICE ROUTINE                         */ 00138000
*          GEN (LINK  EP=IKJPARS,MF=(E,PARSLIST))                  0090 00139000
*            FLOWS(IKJEFA55,NLSTEXIT) REFS(PARSLIST);              0090 00140000
         LINK  EP=IKJPARS,MF=(E,PARSLIST)                               00141000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00142000
*          RETNCODE=R15;              /* SAVE RETURN CODE            */ 00143000
         LR    RETNCODE,R15                                        0092 00144000
*          RFY R15 UNRSTD;            /* RELEASE THE RETURN CODE REG */ 00145000
*          IF RETNCODE ^= 0           /* PARSE SUCCESSFUL?           */ 00146000
*            THEN                     /* NO,                         */ 00147000
         LTR   RETNCODE,RETNCODE                                   0094 00148000
         BZ    @RF00094                                            0094 00149000
*              DO;                                                 0095 00150000
*              /* CHECK THE PARSE RETURN CODE.                       */ 00151000
*              IF RETNCODE = 20       /* DID THE VALIDITY CHECK ROUTINE 00152000
*                                          DISCOVER THE ERROR        */ 00153000
*                THEN                 /* YES,                        */ 00154000
         CH    RETNCODE,@CH00355                                   0096 00155000
         BNE   @RF00096                                            0096 00156000
*                  RETNCODE = EXITRTCD;/* SAVE THE VALIDITY CODE     */ 00157000
         L     RETNCODE,EXITRTCD                                   0097 00158000
*              IF RETNCODE = 16       /* CHK FOR NO SPACE CODE       */ 00159000
*                THEN                 /* YES,                        */ 00160000
@RF00096 CH    RETNCODE,@CH00044                                   0098 00161000
         BE    @RT00098                                            0098 00162000
*                  GOTO  NOSPAZ;      /* GO TO ISSUE NO SPACE MSG    */ 00163000
*              IF RETNCODE = 4 |      /* NO PROMPT? OR               */ 00164000
*                RETNCODE = 8         /* ATTENTION INTERUPT?         */ 00165000
*                THEN                 /* YES,                        */ 00166000
         CH    RETNCODE,@CH00066                                   0100 00167000
         BE    @RT00100                                            0100 00168000
         CH    RETNCODE,@CH00046                                   0100 00169000
         BNE   @RF00100                                            0100 00170000
@RT00100 DS    0H                                                  0101 00171000
*                  DO;                                             0101 00172000
*                  DELERR = '1'B;     /* SET NO SUCCESS MESSAGE FLAG */ 00173000
         OI    DELERR,B'00100000'                                  0102 00174000
*                  GOTO  DOCLOS;      /* GO TO EXIT                  */ 00175000
         B     DOCLOS                                              0103 00176000
*                  END;                                            0104 00177000
*              MSGNO  =  20;          /* PARSE COMMAND SYSTEM ERROR  */ 00178000
@RF00100 MVC   MSGNO(2),@CH00355                                   0105 00179000
*              GOTO  SYSERRD;         /* GO TO ISSUE MESSAGE         */ 00180000
         B     SYSERRD                                             0106 00181000
*              END;                                                0107 00182000
*          IF DATAKEY(16) = '1'B      /* IS DATA LIST PRESENT?       */ 00183000
*            THEN                     /* YES                         */ 00184000
@RF00094 L     @10,DELPDLAD                                        0108 00185000
         TM    DATAKEY+1(@10),B'00000001'                          0108 00186000
         BNO   @RF00108                                            0108 00187000
*              DATLIN = '1'B;         /* SET DATALIST FLAG           */ 00188000
         OI    DATLIN,B'01000000'                                  0109 00189000
*          UPDE = ADDR(USRID);        /* SAVE USERID PDE             */ 00190000
@RF00108 LA    @10,USRID                                           0110 00191000
         ST    @10,UPDE                                            0110 00192000
*          ULEN = USRLEN;             /* SAVE LENGTH OF USERID       */ 00193000
         SLR   @10,@10                                             0111 00194000
         IC    @10,USRLEN                                          0111 00195000
         STH   @10,ULEN                                            0111 00196000
*          IF NUMOFLV > 1             /* IS PASSWORD PRESENT?        */ 00197000
*            THEN                     /* YES                         */ 00198000
         CLI   NUMOFLV,1                                           0112 00199000
         BNH   @RF00112                                            0112 00200000
*              DO;                                                 0113 00201000
*              PWDNTR = '1'B;         /* SET PASSWORD FLAG           */ 00202000
         OI    PWDNTR,B'00000100'                                  0114 00203000
*              PPDE = ADDR(PASSWD);   /* SAVE PASSWORD PDE           */ 00204000
         LA    @10,PASSWD                                          0115 00205000
         ST    @10,PPDE                                            0115 00206000
*              END;                                                0116 00207000
*          IF NUMOFLV > 2             /* IS ACCTNMBR PRESENT?        */ 00208000
*            THEN                     /* YES                         */ 00209000
@RF00112 CLI   NUMOFLV,2                                           0117 00210000
         BNH   @RF00117                                            0117 00211000
*              DO;                                                 0118 00212000
*              ACNNTR = '1'B;         /* SET ACCTNMBR FLAG           */ 00213000
         OI    ACNNTR,B'10000000'                                  0119 00214000
*              APDE = ADDR(ACCTNO);   /* SAVE ACCTNMBR PDE           */ 00215000
         LA    @10,ACCTNO                                          0120 00216000
         ST    @10,APDE                                            0120 00217000
*              END;                                                0121 00218000
*          DPLPTR = ADDR(DPL);        /* POINT TO DELETE POINT LIST  */ 00219000
@RF00117 LA    @10,DPL                                             0122 00220000
         ST    @10,DPLPTR                                          0122 00221000
*          /* USERID ENTRY SYNTAX CHECK                              */ 00222000
*          IF PWDNTR = '0'B           /* CHK FOR PASSWD ENTRY OR     */ 00223000
*           & DATLIN = '0'B           /* DATALIST ENTRY              */ 00224000
*            THEN                     /* NEITHER,                    */ 00225000
         TM    PWDNTR,B'01000100'                                  0123 00226000
         BNZ   @RF00123                                            0123 00227000
*              DADP = ADDR(DUSRID1);  /* SET ASSIGNED DELETE POINT   */ 00228000
         LA    @10,DUSRID1                                         0124 00229000
         ST    @10,DADP                                            0124 00230000
*          DUSRID1 = ADDR(UPDE);      /* SET PTR TO FIRST NAME PDE   */ 00231000
@RF00123 LA    @10,UPDE                                            0125 00232000
         ST    @10,DUSRID1                                         0125 00233000
*          DUSRIDN = ADDR(UPDE);      /* SET PTR TO CURRENT NAME PDE */ 00234000
         ST    @10,DUSRIDN                                         0126 00235000
*          IF USRID(1) = '*'          /* WAS * ENTERED FOR USERID?   */ 00236000
*            THEN                     /* YES,                        */ 00237000
         CLI   USRID,C'*'                                          0127 00238000
         BNE   @RF00127                                            0127 00239000
*              DUCLSF1 = '1'B;        /* SET FLAG FOR ORIGINAL *     */ 00240000
         OI    DUCLSF1,B'10000000'                                 0128 00241000
*            ELSE                                                  0129 00242000
*              DO;                                                 0129 00243000
         B     @RC00127                                            0129 00244000
@RF00127 DS    0H                                                  0130 00245000
*              DUSRDTN = 1;           /* SET TOTAL NAME COUNT        */ 00246000
         LA    @10,1                                               0130 00247000
         STH   @10,DUSRDTN                                         0130 00248000
*              DUSRDCN = 1;           /* SET CURRENT NAME NUMBER     */ 00249000
         STH   @10,DUSRDCN                                         0131 00250000
*              END;                                                0132 00251000
*          /* PASSWORD ENTRY SYNTAX CHECK                            */ 00252000
*          /* CHK IF PASSWORD ENTERED                                */ 00253000
*          IF PWDNTR = '0'B           /* CHK ENTRY FLAG              */ 00254000
*            THEN                     /* NO,                         */ 00255000
@RC00127 TM    PWDNTR,B'00000100'                                  0133 00256000
         BZ    @RT00133                                            0133 00257000
*              GOTO  DATLCHK;         /* GO TO CHK FOR DATA LIST     */ 00258000
*          IF ACNNTR = '0'B           /* CHK FOR ACCTNMBR ENTRY OR   */ 00259000
*           & DATLIN = '0'B           /* DATALIST ENTRY              */ 00260000
*            THEN                     /* NEITHER,                    */ 00261000
         TM    ACNNTR,B'11000000'                                  0135 00262000
         BNZ   @RF00135                                            0135 00263000
*              DADP = ADDR(DPASWD1);  /* SET ASSIGNED DP             */ 00264000
         LA    @10,DPASWD1                                         0136 00265000
         ST    @10,DADP                                            0136 00266000
*          DPASWD1 = ADDR(PPDE);      /* SET PTR TO FIRST PASSWORD   */ 00267000
@RF00135 LA    @10,PPDE                                            0137 00268000
         ST    @10,DPASWD1                                         0137 00269000
*          DPASWDN = ADDR(PPDE);      /* SET PTR TO CURRENT NAME PDE */ 00270000
         ST    @10,DPASWDN                                         0138 00271000
*          IF PASSWD(1) = '*'         /* WAS * ENTERED FOR PASSWORD  */ 00272000
*            THEN                     /* YES,                        */ 00273000
         CLI   PASSWD,C'*'                                         0139 00274000
         BNE   @RF00139                                            0139 00275000
*              DPCLSF1 = '1'B;        /* SET * (NOT NAME) FLAG       */ 00276000
         OI    DPCLSF1,B'10000000'                                 0140 00277000
*            ELSE                     /* NO, NOT ASTERISK            */ 00278000
*              DO;                                                 0141 00279000
         B     @RC00139                                            0141 00280000
@RF00139 DS    0H                                                  0142 00281000
*              PLEN = 8;              /* SET LENGTH OF PASSWORD      */ 00282000
         MVC   PLEN(2),@CH00046                                    0142 00283000
*              DPSWDTN = 1;           /* SET TOTAL PSWD COUNT TO 1   */ 00284000
         LA    @10,1                                               0143 00285000
         STH   @10,DPSWDTN                                         0143 00286000
*              DPSWDCN = 1;           /* SET CURRENT PSWD NMBR TO 1  */ 00287000
         STH   @10,DPSWDCN                                         0144 00288000
*              END;                                                0145 00289000
*          /* ACCOUNT NUMBER ENTRY SYNTAX CHECK                      */ 00290000
*          IF ACNNTR = '0'B           /* WAS ACCNT NUM SPECIFIED?    */ 00291000
*            THEN                     /* NO,                         */ 00292000
@RC00139 TM    ACNNTR,B'10000000'                                  0146 00293000
         BZ    @RT00146                                            0146 00294000
*              GOTO  DATLCHK;         /* GO TO CHK FOR DATA LIST     */ 00295000
*          IF DATLIN = '0'B           /* WAS DATALIST ENTERED        */ 00296000
*            THEN                     /* NO,                         */ 00297000
         TM    DATLIN,B'01000000'                                  0148 00298000
         BNZ   @RF00148                                            0148 00299000
*              DADP = ADDR(DACCTN1);  /* SET ASSIGNED DP             */ 00300000
         LA    @10,DACCTN1                                         0149 00301000
         ST    @10,DADP                                            0149 00302000
*          DACCTN1 = ADDR(APDE);      /* SET PTR TO FIRST NAME PDE   */ 00303000
@RF00148 LA    @10,APDE                                            0150 00304000
         ST    @10,DACCTN1                                         0150 00305000
*          DACCTNN = ADDR(APDE);      /* SET PTR TO CURRENT NAME PDE */ 00306000
         ST    @10,DACCTNN                                         0151 00307000
*          IF ACCTNO(1:2) = '* '      /* WAS * ENTERED FOR ACCT NMBR?*/ 00308000
*            THEN                     /* YES,                        */ 00309000
         CLC   ACCTNO(2),@CC00361                                  0152 00310000
         BNE   @RF00152                                            0152 00311000
*              DACLSF1 = '1'B;        /* SET * (NOT NAME) FLAG       */ 00312000
         OI    DACLSF1,B'10000000'                                 0153 00313000
*            ELSE                     /* NO, NOT ASTERISK            */ 00314000
*              DO;                                                 0154 00315000
         B     @RC00152                                            0154 00316000
@RF00152 DS    0H                                                  0155 00317000
*              ALEN = ACTLEN;         /* GET LENGTH OF ACCT NO.      */ 00318000
         SLR   @10,@10                                             0155 00319000
         IC    @10,ACTLEN                                          0155 00320000
         STH   @10,ALEN                                            0155 00321000
*              DACCTTN = 1;           /* SET TOTAL ACCT COUNT TO 1   */ 00322000
         LA    @10,1                                               0156 00323000
         STH   @10,DACCTTN                                         0156 00324000
*              DACCTCN = 1;           /* SET CURRENT ACCT NMBR TO 1  */ 00325000
         STH   @10,DACCTCN                                         0157 00326000
*              END;                                                0158 00327000
*DATLCHK:  /* PROCESS DATALIST IF ANY DATALIST ENTRY                 */ 00328000
*          IF DATLIN = '1'B           /* IF DATA LIST PRESENT        */ 00329000
*            THEN                                                  0159 00330000
@RC00152 DS    0H                                                  0159 00331000
DATLCHK  TM    DATLIN,B'01000000'                                  0159 00332000
         BNO   @RF00159                                            0159 00333000
*              DO;                                                 0160 00334000
*              IF ACNNTR = '1'B       /* IF ACCT NUM SUPPLIED        */ 00335000
*                THEN                 /* YES,                        */ 00336000
         TM    ACNNTR,B'10000000'                                  0161 00337000
         BNO   @RF00161                                            0161 00338000
*                  DO;                                             0162 00339000
*                  PDEPTR = ADDR(PROCPDE);/* PTR TO DATALIST BUFFER  */ 00340000
         L     PDEPTR,DELPDLAD                                     0163 00341000
         LA    PDEPTR,PROCPDE(,PDEPTR)                             0163 00342000
*                  DADP = ADDR(DROCNM1);/* SET ASSIGNED DELETE POINT */ 00343000
         LA    @10,DROCNM1                                         0164 00344000
         ST    @10,DADP                                            0164 00345000
*                  CALL  COLLCT;      /* GO TO COLLECT COUNT         */ 00346000
         BAL   @14,COLLCT                                          0165 00347000
*                  GOTO  DENQ;        /* GO TO ENQUEUE ON SYSUADS    */ 00348000
         B     DENQ                                                0166 00349000
*                  END;                                            0167 00350000
*              IF PWDNTR = '1'B       /* WAS PASSWORD SUPPLIED?      */ 00351000
*                THEN                 /* YES,                        */ 00352000
@RF00161 TM    PWDNTR,B'00000100'                                  0168 00353000
         BNO   @RF00168                                            0168 00354000
*                  DO;                                             0169 00355000
*                  PDEPTR = ADDR(ACCTPDE);/* PTR TO DATALIST BUFFER  */ 00356000
         L     PDEPTR,DELPDLAD                                     0170 00357000
         LA    PDEPTR,ACCTPDE(,PDEPTR)                             0170 00358000
*                  DADP = ADDR(DACCTN1);/* SET ASSIGNED DP           */ 00359000
         LA    @10,DACCTN1                                         0171 00360000
         ST    @10,DADP                                            0171 00361000
*                  CALL  COLLCT;      /* GO TO COLLECT COUNT         */ 00362000
         BAL   @14,COLLCT                                          0172 00363000
*                  GOTO  DENQ;        /* GO TO ENQUEUE ON SYSUADS    */ 00364000
         B     DENQ                                                0173 00365000
*                  END;                                            0174 00366000
*                ELSE                 /* NO,                         */ 00367000
*                  DO;                                             0175 00368000
@RF00168 DS    0H                                                  0176 00369000
*                  PDEPTR = ADDR(PASSPDE);/* PTR TO DATALIST BUFFER  */ 00370000
         L     PDEPTR,DELPDLAD                                     0176 00371000
         LA    PDEPTR,PASSPDE(,PDEPTR)                             0176 00372000
*                  DADP = ADDR(DPASWD1);/* SET ASSIGNED DP           */ 00373000
         LA    @10,DPASWD1                                         0177 00374000
         ST    @10,DADP                                            0177 00375000
*                  CALL  COLLCT;      /* GO TO COLLECT COUNT         */ 00376000
         BAL   @14,COLLCT                                          0178 00377000
*                  END;                                            0179 00378000
*              END;                                                0180 00379000
*DENQ:     /* ENQUEUE SYSUADS-OPEN                                   */ 00380000
*          DCDP = DADP;               /* FROM ASSIGNED DP            */ 00381000
@RF00159 DS    0H                                                  0181 00382000
DENQ     L     @10,DADP                                            0181 00383000
         ST    @10,DCDP                                            0181 00384000
*          GEN (ENQ   ,MF=(E,NQOPN))                               0182 00385000
*            REFS(EQNAM1,ERNAM1,NQOPN);                            0182 00386000
         ENQ   ,MF=(E,NQOPN)                                            00387000
*          ENQFLG = '1'B;             /* SET ENQUEUE FLAG            */ 00388000
         OI    ENQFLG,B'00010000'                                  0183 00389000
*          /* CHK IF USERID ENTERED AS ASTERISK, IF SO, OPEN DCB     */ 00390000
*          /*      FOR DIRECTORY READ                                */ 00391000
*          /* ESTABLISH DSECT ADDRESSABILITY                         */ 00392000
*          RFY R2 RSTD;               /* RESTRICT DSECT REGISTER     */ 00393000
*          GEN (USING IHADCB,R2)                                   0185 00394000
*            REFS(R2);                                             0185 00395000
         USING IHADCB,R2                                                00396000
*          IF DUCLSF1 = '1'B          /* CHK FOR ASTERISK FLAG       */ 00397000
*            THEN                     /* YES, OPEN DCB               */ 00398000
         TM    DUCLSF1,B'10000000'                                 0186 00399000
         BNO   @RF00186                                            0186 00400000
*              DO;                                                 0187 00401000
*              R2 = ADDR(DIRDCB);     /* SET PTR TO DCB              */ 00402000
         LA    R2,DIRDCB                                           0188 00403000
*              /* ISSUE OPEN                                         */ 00404000
*              GEN (OPEN  ((R2),INPUT),MF=(E,DLOPNL))              0189 00405000
*                REFS(DLOPNL,R2);                                  0189 00406000
         OPEN  ((R2),INPUT),MF=(E,DLOPNL)                               00407000
*              IF DCBOFLG = '0'B      /* WAS OPEN SUCCESFUL?         */ 00408000
*                THEN                 /* NO,                         */ 00409000
         TM    DCBOFLG,B'00010000'                                 0190 00410000
         BNZ   @RF00190                                            0190 00411000
*                  DO;                                             0191 00412000
*                  MSGNO  =  3;       /* SET MESSAGE INDEX           */ 00413000
         MVC   MSGNO(2),@CH00211                                   0192 00414000
*                  GOTO  ERRMSG;      /* GO TO SET ERROR MESSAGE     */ 00415000
         B     ERRMSG                                              0193 00416000
*                  END;                                            0194 00417000
*              /* DO PRIME-READ TO IDENTIFY FIRST MEMBER NAME        */ 00418000
*              ACIOFL03  =  '1'B;     /* SET WORK AREA INDICATOR     */ 00419000
@RF00190 OI    ACIOFL03,B'00100000'                                0195 00420000
*              ACIODRCT = ADDR(DIRWA);/* PTR TO DIRECTORY WORK AREA  */ 00421000
         LA    @10,DIRWA                                           0196 00422000
         ST    @10,ACIODRCT                                        0196 00423000
*              END;                                                0197 00424000
*            ELSE                     /* USERID WAS SPECIFIED        */ 00425000
*              DO;                                                 0198 00426000
         B     @RC00186                                            0198 00427000
@RF00186 DS    0H                                                  0199 00428000
*              ACIOMPTR = ADDR(USRID);/* PTR TO SPECIFIC USERID      */ 00429000
         LA    @10,USRID                                           0199 00430000
         ST    @10,ACIOMPTR                                        0199 00431000
*              USRID(USRLEN+1) = '0'; /* ZERO FOR FIRST MEMBER       */ 00432000
         SLR   @10,@10                                             0200 00433000
         IC    @10,USRLEN                                          0200 00434000
         LA    @03,USRID(@10)                                      0200 00435000
         MVI   0(@03),C'0'                                         0200 00436000
*              END;                                                0201 00437000
*          R2 = ADDR(DELDCB);         /* SET PTR TO DCB              */ 00438000
@RC00186 LA    R2,DELDCB                                           0202 00439000
*          /* OPEN UADS DCB FOR READ/WRITE MEMBER                    */ 00440000
*          GEN (OPEN  ((R2),UPDAT),MF=(E,DLOPNL))                  0203 00441000
*            REFS(DLOPNL,R2);                                      0203 00442000
         OPEN  ((R2),UPDAT),MF=(E,DLOPNL)                               00443000
*          IF DCBOFLG = '0'B          /* WAS OPEN SUCCESSFUL?        */ 00444000
*            THEN                     /* NO,                         */ 00445000
         TM    DCBOFLG,B'00010000'                                 0204 00446000
         BNZ   @RF00204                                            0204 00447000
*              DO;                                                 0205 00448000
*              MSGNO  =  3;           /* SET MESSAGE INDEX           */ 00449000
         MVC   MSGNO(2),@CH00211                                   0206 00450000
*              GOTO  ERRMSG;          /* GO TO SET ERROR MESSAGE     */ 00451000
         B     ERRMSG                                              0207 00452000
*              END;                                                0208 00453000
*          /* DROP DSECT ADDRESSABILITY                             */  00454000
*          GEN REFS(R2) (DROP R2);                                 0209 00455000
@RF00204 DS    0H                                                  0209 00456000
         DROP R2                                                        00457000
*          RFY R2 UNRSTD;             /* RELEASE DSECT POINTER       */ 00458000
*          GOTO READ;                 /* SKIP CHECK FOR MORE USERS   */ 00459000
         B     READ                                                0211 00460000
*QUITCHK:  /* CHECK IF USERID WAS SPECIFIED AS '*'                   */ 00461000
*          IF DUCLSF1 = '0'B          /* USERID WAS SPECIFIED        */ 00462000
*            THEN                     /* YES,                        */ 00463000
QUITCHK  TM    DUCLSF1,B'10000000'                                 0212 00464000
         BZ    @RT00212                                            0212 00465000
*              GOTO  DELCHK;          /* TERMINATE DELETE ACTIVITY   */ 00466000
*READ:     /* CHK IF TERMINATION IS INDICATED BY ACCOUNT             */ 00467000
*          IF ATTENTN = '1'B          /* CHK ECB COMPLETE FLAG       */ 00468000
*            THEN                     /* YES,                        */ 00469000
READ     L     @10,ACCTECBP(,ACCTPLP)                              0214 00470000
         TM    ATTENTN(@10),B'01000000'                            0214 00471000
         BO    @RT00214                                            0214 00472000
*              GOTO  DOCLOS;          /* TERMINATE DELETE ACTIVITY   */ 00473000
*          /* CHK IF NECESSARY TO FREE READ BUFFER                   */ 00474000
*          IF RDDONE = '1'B           /* CHK FOR READ BUFFER FLAG    */ 00475000
*            THEN                     /* NO,                         */ 00476000
         TM    RDDONE,B'00000010'                                  0216 00477000
         BNO   @RF00216                                            0216 00478000
*              DO;                                                 0217 00479000
*              ACIOFL05 = '0'B;       /* SET NO-WRITE FLAG           */ 00480000
         NI    ACIOFL05,B'11110111'                                0218 00481000
*              CALL DOWRITE;          /* GO TO FREE READ BUFFER      */ 00482000
         BAL   @14,DOWRITE                                         0219 00483000
*              END;                                                0220 00484000
*          CALL DOREAD;               /* READ USER                   */ 00485000
@RF00216 BAL   @14,DOREAD                                          0221 00486000
*          /* ENQUEUE ON THE USER NAME.  IF ENQUEUE FAILS, GO TO ISSUE  00487000
*          ERROR TERMINATION MESSAGE.  IF ENQUEUE SUCCEEDS, WRITE  0222 00488000
*          REVISED MEMBER BACK INTO UADS.   DEQUEUE THE MEMBER     0222 00489000
*          NAME AND GO TO CHECK IF MORE ACTIVITY IS SCHEDULED BY   0222 00490000
*          THIS COMMAND ENTRY                                        */ 00491000
*          /* ENQUEUE SYSUADS-MEMBERNAME                             */ 00492000
*          GEN  (ENQ   (,USRLEN),MF=(E,NQMBR))                     0222 00493000
*            REFS(EQNAM1,NQMBR,USRLEN);                            0222 00494000
         ENQ   (,USRLEN),MF=(E,NQMBR)                                   00495000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00496000
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */ 00497000
         LR    RETNCODE,R15                                        0224 00498000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00499000
*          IF RETNCODE ^= 0           /* IS CODE UNSUCCESSFUL CODE   */ 00500000
*            THEN                                                  0226 00501000
         LTR   RETNCODE,RETNCODE                                   0226 00502000
         BZ    @RF00226                                            0226 00503000
*              DO;                                                 0227 00504000
*              IF RCLC1 = 4           /* IF USERID ALREADY ENQUEUED  */ 00505000
*                THEN                 /* YES,                        */ 00506000
         CLI   RCLC1(RETNCODE),4                                   0228 00507000
         BE    @RT00228                                            0228 00508000
*                  GOTO  ENQERR;      /* INDICATE USERID ACTIVE      */ 00509000
*                ELSE                 /* BAD RETURN CODE FROM ENQUEUE*/ 00510000
*                  DO;                                             0230 00511000
*                  RETNCODE = RCLC1;  /* SAVE ENQUEUE RETURN CODE    */ 00512000
         SLR   @10,@10                                             0231 00513000
         IC    @10,RCLC1(,RETNCODE)                                0231 00514000
         LR    RETNCODE,@10                                        0231 00515000
*                  MSGNO = 18;        /* SET MESSAGE INDEX           */ 00516000
         MVC   MSGNO(2),@CH00376                                   0232 00517000
*                  GOTO SYSERRD;      /* GO TO ISSUE ERROR MESSAGE   */ 00518000
         B     SYSERRD                                             0233 00519000
*                  END;                                            0234 00520000
*              END;                                                0235 00521000
*          IF DADP = ADDR(DUSRID1)    /* IS USERID THE DELETE LEVEL? */ 00522000
*            THEN                     /* YES                         */ 00523000
@RF00226 LA    @10,DUSRID1                                         0236 00524000
         C     @10,DADP                                            0236 00525000
         BNE   @RF00236                                            0236 00526000
*              DO;                                                 0237 00527000
*              CALL DELSTO;           /* STOW DELETE THE USERID      */ 00528000
         BAL   @14,DELSTO                                          0238 00529000
*              GOTO DOCLOS;           /* GO TO TERMINATION           */ 00530000
         B     DOCLOS                                              0239 00531000
*              END;                                                0240 00532000
*          RFY R1 RSTD;               /* RESTRICT REG 1              */ 00533000
@RF00236 DS    0H                                                  0242 00534000
*          R1  =  ADDR(COMAREA);      /* POINT TO COMMUNICATION AREA */ 00535000
         LA    R1,COMAREA                                          0242 00536000
*          CALL IKJEFA32;             /* FIND DELETE POINT           */ 00537000
         L     @15,@CV00070                                        0243 00538000
         BALR  @14,@15                                             0243 00539000
*          RFY R1 UNRSTD;             /* RELEASE REG 1               */ 00540000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 00541000
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */ 00542000
         LR    RETNCODE,R15                                        0246 00543000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 00544000
*          IF MSGNO ^= 0              /* IS CODE SUCCESSFUL CODE     */ 00545000
*            THEN                     /* NO,                         */ 00546000
         LH    @10,MSGNO                                           0248 00547000
         LTR   @10,@10                                             0248 00548000
         BZ    @RF00248                                            0248 00549000
*              DO;                                                 0249 00550000
*              ACIOFL05 = '0'B;       /* CLEAR WRITE REQUEST FLAG    */ 00551000
         NI    ACIOFL05,B'11110111'                                0250 00552000
*              CALL DOWRITE;          /* GO TO FREE/DEQUEUE          */ 00553000
         BAL   @14,DOWRITE                                         0251 00554000
*              IF MSGNO = 25          /* WAS SYSTEM ERROR DETECTED   */ 00555000
*                THEN                 /* YES,                        */ 00556000
         LH    @10,MSGNO                                           0252 00557000
         CH    @10,@CH00378                                        0252 00558000
         BE    @RT00252                                            0252 00559000
*                  GOTO SYSERRD;                                   0253 00560000
*              /* CHK FOR USERID ASTERISK ENTRY                      */ 00561000
*              IF DUCLSF1 = '1'B      /* CHK FOR USERID ASTERISK     */ 00562000
*                THEN                 /* YES,                        */ 00563000
         TM    DUCLSF1,B'10000000'                                 0254 00564000
         BO    @RT00254                                            0254 00565000
*                  GOTO  READ;        /* GO TO GET NEXT MEMBER       */ 00566000
*              IF MSGNO = 10          /* WAS PASSWORD NOT SUPPORTED? */ 00567000
*               | MSGNO = 11          /* OR ACCNT NUM NOT SUPPORTED? */ 00568000
*                THEN                 /* YES,                        */ 00569000
         CH    @10,@CH00379                                        0256 00570000
         BE    @RT00256                                            0256 00571000
         CH    @10,@CH00380                                        0256 00572000
         BNE   @RF00256                                            0256 00573000
@RT00256 DS    0H                                                  0257 00574000
*                  DO;                                             0257 00575000
*                  CALL MSGFNDR;      /* GO TO LOCATE MESSAGE TEXT   */ 00576000
         BAL   @14,MSGFNDR                                         0258 00577000
*                  TMSGTIL1 = USRLEN+4;/* SET LENGTH OF INSERT       */ 00578000
         SLR   @10,@10                                             0259 00579000
         IC    @10,USRLEN                                          0259 00580000
         LA    @15,4                                               0259 00581000
         ALR   @15,@10                                             0259 00582000
         STH   @15,TMSGTIL1                                        0259 00583000
*                  TMSGTIO1 = 26;     /* SET TEXT OFFSET             */ 00584000
         MVC   TMSGTIO1(2),@CH00382                                0260 00585000
*                  TMSGTIN1(1:USRLEN) = USRID;/* INSERT NAME IN SEG  */ 00586000
         BCTR  @10,0                                               0261 00587000
         EX    @10,@SM00445                                        0261 00588000
*                  SEGPTR13 = ADDR(TMSGTIX1);/* SET PTR TO SEGMENT   */ 00589000
         LA    @10,TMSGTIX1                                        0262 00590000
         ST    @10,SEGPTR13                                        0262 00591000
*                  GOTO  MSGNGRM;     /* GO TO ERROR EXIT            */ 00592000
         B     MSGNGRM                                             0263 00593000
*                  END;                                            0264 00594000
*              GOTO DELCHK;           /* CHECK RESULTS               */ 00595000
         B     DELCHK                                              0265 00596000
*              END;                                                0266 00597000
*          ACIOFL05  =  '1'B;         /* SET WRITE REQUEST FLAG      */ 00598000
@RF00248 OI    ACIOFL05,B'00001000'                                0267 00599000
*          IF DELUSER = '1'B          /* CHK FOR USERID DELETION     */ 00600000
*            THEN                     /* NONE                        */ 00601000
         TM    DELUSER,B'10000000'                                 0268 00602000
         BNO   @RF00268                                            0268 00603000
*              CALL DELSTO;           /* GO TO DELETE MEMBER         */ 00604000
         BAL   @14,DELSTO                                          0269 00605000
*            ELSE                     /* SUBLEVEL REMAINS            */ 00606000
*              CALL DOWRITE;          /* GO TO WRITE UPDATED MEMBER  */ 00607000
         B     @RC00268                                            0270 00608000
@RF00268 BAL   @14,DOWRITE                                         0270 00609000
*          GOTO QUITCHK;              /* GO TO TEST FOR MORE USERIDS */ 00610000
         B     QUITCHK                                             0271 00611000
*DELCHK:   /* EP TO INDICATE DELETE STATUS OF NAME ITEM              */ 00612000
*          /* CHK FOR PASSWORD SUPPORT FAILURE                       */ 00613000
*          IF DUCLSF1 = '1'B          /* CHK FOR USERID = *          */ 00614000
*           & DPCLSF1 = '0'B          /* AND FOR SPECIFIC PASSWORD   */ 00615000
*           & GPWDSP = '0'B           /* AND SUPPORT FLAG NOT SET    */ 00616000
*            THEN                     /* YES,                        */ 00617000
DELCHK   TM    DUCLSF1,B'10000000'                                 0272 00618000
         BNO   @RF00272                                            0272 00619000
         TM    DPCLSF1,B'10000000'                                 0272 00620000
         BNZ   @RF00272                                            0272 00621000
         TM    GPWDSP,B'01000000'                                  0272 00622000
         BNZ   @RF00272                                            0272 00623000
*              DO;                                                 0273 00624000
*              MSGNO = 12;            /* SET MESSAGE INDEX           */ 00625000
         MVC   MSGNO(2),@CH00130                                   0274 00626000
*              GOTO ERRMSG;           /* GO TO ISSUE ERROR MSG       */ 00627000
         B     ERRMSG                                              0275 00628000
*              END;                                                0276 00629000
*          /* CHK FOR ACCOUNT NUMBER SUPPORT FAILURE                 */ 00630000
*          IF DUCLSF1 = '1'B          /* CHK FOR USERID = *          */ 00631000
*           & DACLSF1 = '0'B          /* AND FOR SPECIFIC ACCTNUM    */ 00632000
*           & GACNSP = '0'B           /* AND SUPPORT FLAG NOT SET    */ 00633000
*            THEN                     /* YES,                        */ 00634000
@RF00272 TM    DUCLSF1,B'10000000'                                 0277 00635000
         BNO   @RF00277                                            0277 00636000
         TM    DACLSF1,B'10000000'                                 0277 00637000
         BNZ   @RF00277                                            0277 00638000
         TM    GACNSP,B'00100000'                                  0277 00639000
         BNZ   @RF00277                                            0277 00640000
*              DO;                                                 0278 00641000
*              MSGNO = 13;            /* SET MESSAGE INDEX           */ 00642000
         MVC   MSGNO(2),@CH00042                                   0279 00643000
*              GOTO ERRMSG;           /* GO TO ISSUE ERROR MSG       */ 00644000
         B     ERRMSG                                              0280 00645000
*              END;                                                0281 00646000
*          DNMIDP = ADDR(DPASWD1);    /* SET PROTO-DPL PTR TO LEVEL  */ 00647000
@RF00277 LA    DNMIDP,DPASWD1                                      0282 00648000
*          MSGNO = 15;                /* SET PASSWORD MESSAGE INDEX  */ 00649000
         MVC   MSGNO(2),@CH00109                                   0283 00650000
*          DO WHILE DNMIDP <= DADP;   /* LOOP FOR EACH LEVEL         */ 00651000
         B     @DE00284                                            0284 00652000
@DL00284 DS    0H                                                  0285 00653000
*            TSTCTN = 0;              /* CLEAR TEST COUNTER          */ 00654000
         SLR   TSTCTN,TSTCTN                                       0285 00655000
*            PDEPTR = NAMID1;         /* SET PDE PTR TO INITIAL PDE  */ 00656000
         L     PDEPTR,NAMID1(,DNMIDP)                              0286 00657000
*            DO WHILE TSTCTN < NMDTN1 /* LOOP FOR ALL ITEMS          */ 00658000
*             & NMFLG11 = '0'B;       /* WITH NAME SUPPLIED          */ 00659000
         B     @DE00287                                            0287 00660000
@DL00287 DS    0H                                                  0288 00661000
*              TSTCTN = TSTCTN+1;     /* STEP COUNTER                */ 00662000
         AH    TSTCTN,@CH00032                                     0288 00663000
*              IF NAMFLGF = '0'B      /* CHK FOR SUCCESSFUL FIND     */ 00664000
*                THEN                 /* NO,                         */ 00665000
         TM    NAMFLGF(PDEPTR),B'00000010'                         0289 00666000
         BNZ   @RF00289                                            0289 00667000
*                  DO;                                             0290 00668000
*                  DELERR = '1'B;     /* SET ERROR FLAG              */ 00669000
         OI    DELERR,B'00100000'                                  0291 00670000
*                  CALL  MSGFNDR;     /* GO TO LOCATE MESSAGE TEXT   */ 00671000
         BAL   @14,MSGFNDR                                         0292 00672000
*                  /* SET UP NAME IMAGE                              */ 00673000
*                  TMSGTIL1 = NAMLNG+4; /* EXTRACT LENGTH            */ 00674000
         SLR   @10,@10                                             0293 00675000
         ICM   @10,3,NAMLNG(PDEPTR)                                0293 00676000
         LA    @15,4                                               0293 00677000
         ALR   @15,@10                                             0293 00678000
         STH   @15,TMSGTIL1                                        0293 00679000
*                  TMSGTIO1 = 11;     /* SET INSERTION OFFSET        */ 00680000
         MVC   TMSGTIO1(2),@CH00380                                0294 00681000
*                  TMSGTIN1(1:NAMLNG) = NAMPTRC; /* SET NAME IN SEG  */ 00682000
         BCTR  @10,0                                               0295 00683000
         L     @01,NAMPTR1(,PDEPTR)                                0295 00684000
         EX    @10,@SM00448                                        0295 00685000
*                  SEGPTR13 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEG */ 00686000
         LA    @10,TMSGTIX1                                        0296 00687000
         ST    @10,SEGPTR13                                        0296 00688000
*                  CALL DOPUTL;       /* GO TO ISSUE ERROR MSG       */ 00689000
         BAL   @14,DOPUTL                                          0297 00690000
*                  END;                                            0298 00691000
*              PDEPTR = NPTRNEX;      /* POINT TO NEXT PDE           */ 00692000
@RF00289 SLR   @10,@10                                             0299 00693000
         ICM   @10,7,NPTRNEX(PDEPTR)                               0299 00694000
         LR    PDEPTR,@10                                          0299 00695000
*            END;                                                  0300 00696000
@DE00287 SLR   @10,@10                                             0300 00697000
         ICM   @10,3,NMDTN1(DNMIDP)                                0300 00698000
         CLR   TSTCTN,@10                                          0300 00699000
         BNL   @DC00287                                            0300 00700000
         TM    NMFLG11(DNMIDP),B'10000000'                         0300 00701000
         BZ    @DL00287                                            0300 00702000
@DC00287 DS    0H                                                  0301 00703000
*            IF DELERR = '1'B         /* HAS AN ERROR BEEN DETECTED? */ 00704000
*              THEN                   /* YES,                        */ 00705000
         TM    DELERR,B'00100000'                                  0301 00706000
         BO    @RT00301                                            0301 00707000
*                GOTO DOCLOS;         /* GO TO TERMINATION           */ 00708000
*            MSGNO = MSGNO+1;         /* INCREMENT MESSAGE NUMBER    */ 00709000
         LA    @10,1                                               0303 00710000
         AH    @10,MSGNO                                           0303 00711000
         STH   @10,MSGNO                                           0303 00712000
*            DNMIDP = DNMIDP+LSPAN;   /* STEP TO THE NEXT LEVEL      */ 00713000
         AL    DNMIDP,LSPAN                                        0304 00714000
*            END;                                                  0305 00715000
@DE00284 C     DNMIDP,DADP                                         0305 00716000
         BNH   @DL00284                                            0305 00717000
*          GOTO DOCLOS;               /* GO TO TERMINATION           */ 00718000
         B     DOCLOS                                              0306 00719000
*NOSPAZ:   /* GETMAIN FAILURE INDICATOR                              */ 00720000
*          /* CHK IF USERID ENTRY WAS ASTERISK                       */ 00721000
*          IF DUCLSF1 = '0'B          /* CHK FOR ASTERISK            */ 00722000
*           | ACIOLINK = 0            /* OR BLDL FAILED              */ 00723000
*            THEN                     /* NO,                         */ 00724000
NOSPAZ   TM    DUCLSF1,B'10000000'                                 0307 00725000
         BZ    @RT00307                                            0307 00726000
         L     @10,ACIOLINK                                        0307 00727000
         LTR   @10,@10                                             0307 00728000
         BNZ   @RF00307                                            0307 00729000
@RT00307 DS    0H                                                  0308 00730000
*              DO;                                                 0308 00731000
*              MSGNO = 1;             /* SET MESSAGE INDEX           */ 00732000
         MVC   MSGNO(2),@CH00032                                   0309 00733000
*              CALL  MSGFNDR;         /* GO TO LOCATE MESSAGE TEXT   */ 00734000
         BAL   @14,MSGFNDR                                         0310 00735000
*              GOTO  MSGNGRM;         /* GO TO ERROR EXIT            */ 00736000
         B     MSGNGRM                                             0311 00737000
*              END;                                                0312 00738000
*          MSGNO = 22;                /* SET MESSAGE INDEX           */ 00739000
@RF00307 MVC   MSGNO(2),@CH00387                                   0313 00740000
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */ 00741000
         BAL   @14,MSGFNDR                                         0314 00742000
*          TMSGTIL1 = USRLEN+4;       /* SET LENGTH OF INSERT        */ 00743000
         SLR   @10,@10                                             0315 00744000
         IC    @10,USRLEN                                          0315 00745000
         LA    @05,4                                               0315 00746000
         ALR   @05,@10                                             0315 00747000
         STH   @05,TMSGTIL1                                        0315 00748000
*          TMSGTIO1 = 37;             /* SET TEXT OFFSET             */ 00749000
         MVC   TMSGTIO1(2),@CH00388                                0316 00750000
*          TMSGTIN1(1:USRLEN) = USRID;/* INSERT NAME IN SEGMENT      */ 00751000
         BCTR  @10,0                                               0317 00752000
         EX    @10,@SM00445                                        0317 00753000
*          SEGPTR13 = ADDR(TMSGTIX1); /* SET PTR TO SEGMENT          */ 00754000
         LA    @10,TMSGTIX1                                        0318 00755000
         ST    @10,SEGPTR13                                        0318 00756000
*          CALL  DOPUTL;              /* GO TO ISSUE PUTLINE         */ 00757000
         BAL   @14,DOPUTL                                          0319 00758000
*          GOTO  QUITCHK;             /* GO TO EXIT                  */ 00759000
         B     QUITCHK                                             0320 00760000
*ENQERR:   /* INDICATE ENQUEUE FAILURE                               */ 00761000
*          MSGNO  = 6;                /* SET MESSAGE INDEX           */ 00762000
ENQERR   MVC   MSGNO(2),@CH00389                                   0321 00763000
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */ 00764000
         BAL   @14,MSGFNDR                                         0322 00765000
*          TMSGTIL1 = USRLEN+4;       /* SET LENGTH OF INSERT        */ 00766000
         SLR   @10,@10                                             0323 00767000
         IC    @10,USRLEN                                          0323 00768000
         LA    @15,4                                               0323 00769000
         ALR   @15,@10                                             0323 00770000
         STH   @15,TMSGTIL1                                        0323 00771000
*          TMSGTIO1 = 35;             /* SET INSERTION OFFSET        */ 00772000
         MVC   TMSGTIO1(2),@CH00391                                0324 00773000
*          TMSGTIN1(1:USRLEN) =       /* SET NAME IN SEGMENT AREA    */ 00774000
*            USRID(1:USRLEN);                                      0325 00775000
         BCTR  @10,0                                               0325 00776000
         EX    @10,@SM00445                                        0325 00777000
*          SEGPTR12 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEGMENT     */ 00778000
         LA    @10,TMSGTIX1                                        0326 00779000
         ST    @10,SEGPTR12                                        0326 00780000
*          IF DUCLSF1 = '0'B          /* CHK FOR USERID ASTERISK     */ 00781000
*            THEN                     /* NO,                         */ 00782000
         TM    DUCLSF1,B'10000000'                                 0327 00783000
         BZ    @RT00327                                            0327 00784000
*              GOTO  MSGNGRM;         /* GO TO ERROR EXIT            */ 00785000
*          CALL  DOPUTL;              /* GO TO ISSUE MESSAGE         */ 00786000
         BAL   @14,DOPUTL                                          0329 00787000
*          GOTO  QUITCHK;             /* GO TO GET NEXT MEMBER       */ 00788000
         B     QUITCHK                                             0330 00789000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00790000
* /*  S Y S E R R D :   CALL MSGFNDR TO OBTAIN PTR TO THE MESSAGE    */ 00791000
* /*     SEGMENT LIST.  UNPACK THE THREE RETURN CODE CHARACTERS      */ 00792000
* /*     OUT OF THE RETURN CODE SAVE AREA (RETNCODE)  INTO THE       */ 00793000
* /*     INSERT TEXT AREA (TMSGTIN1) AND TRANSLATE THEM INTO EBCDIC  */ 00794000
* /*     CHARACTERS.                                                 */ 00795000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00796000
*SYSERRD:  /* SYSTEM ERROR MESSAGE ROUTINE EP                        */ 00797000
*          CALL MSGFNDR;              /* GO TO LOCATE MESSAGE        */ 00798000
SYSERRD  BAL   @14,MSGFNDR                                         0331 00799000
*          RFY R1 RSTD;               /* RESTRICT REG 1              */ 00800000
*          R1 = RETNCODE;             /* GET RETURN CODE             */ 00801000
         LR    R1,RETNCODE                                         0333 00802000
*          /* UNPACK AND TRANSLATE HEXIDECIMAL CHARACTERS            */ 00803000
*          CVD  (RETNCODE,DBLWORD);                                0334 00804000
         CVD   RETNCODE,DBLWORD                                    0334 00805000
*          UNPK (TMSGTIN1(1:2),DBLWORD(6:8));                      0335 00806000
         UNPK  TMSGTIN1(2),DBLWORD+5(3)                            0335 00807000
*          TMSGTIN1(2) = TMSGTIN1(2)|'F0'X;                        0336 00808000
         OI    TMSGTIN1+1,X'F0'                                    0336 00809000
*          SEGPTR23 = ADDR(TMSGTIX1); /* SET MESSAGE POINTER         */ 00810000
         LA    @10,TMSGTIX1                                        0337 00811000
         ST    @10,SEGPTR23                                        0337 00812000
*          TMSGTIL1 = 6;              /* SET LENGTH OF SEGMENT       */ 00813000
         MVC   TMSGTIL1(2),@CH00389                                0338 00814000
*          TMSGTIO1 = 22;             /* SET INSERT OFFSET           */ 00815000
         MVC   TMSGTIO1(2),@CH00387                                0339 00816000
*          GOTO MSGNGRM;              /* GO TO ISSUE MESSAGE         */ 00817000
         B     MSGNGRM                                             0340 00818000
*ERRMSG:   /* ENTRY POINT TO ISSUE ERROR MESSAGE                     */ 00819000
*          CALL MSGFNDR;              /* BUILD MESSAGE               */ 00820000
ERRMSG   BAL   @14,MSGFNDR                                         0341 00821000
*MSGNGRM:  /* ENTRY POINT TO ISSUE COMPLETED ERROR MESSAGE           */ 00822000
*          CALL  DOPUTL;              /* GO TO ISSUE MESSAGE         */ 00823000
MSGNGRM  BAL   @14,DOPUTL                                          0342 00824000
*          DELERR = '1'B;             /* SET NO SUCCESS MESSAGE FLAG */ 00825000
         OI    DELERR,B'00100000'                                  0343 00826000
*DOCLOS:   /* EP TO DO CLOSE UADS DCB AND DIRECTORY DCB              */ 00827000
*          /* CHK IF NECESSARY TO FREE READ BUFFER                   */ 00828000
*          IF RDDONE = '1'B           /* CHK FOR READ BUFFER FLAG    */ 00829000
*            THEN                     /* NO,                         */ 00830000
DOCLOS   TM    RDDONE,B'00000010'                                  0344 00831000
         BNO   @RF00344                                            0344 00832000
*              DO;                                                 0345 00833000
*              ACIOFL05 = '0'B;       /* SET NO-WRITE FLAG           */ 00834000
         NI    ACIOFL05,B'11110111'                                0346 00835000
*              CALL DOWRITE;          /* GO TO FREE READ BUFFER      */ 00836000
         BAL   @14,DOWRITE                                         0347 00837000
*              END;                                                0348 00838000
*          IF DELPDLAD ^= 0           /* IS THERE A PDL TO FREE?     */ 00839000
*            THEN                     /* YES,                        */ 00840000
@RF00344 L     @10,DELPDLAD                                        0349 00841000
         LTR   @10,@10                                             0349 00842000
         BZ    @RF00349                                            0349 00843000
*              /* ISSUE IKJRLSA MACRO TO RELEASE PDL                 */ 00844000
*              GEN (IKJRLSA DELPDLAD) /* FREE THE PDL SPACE          */ 00845000
*                REFS(DELPDLAD);                                   0350 00846000
         IKJRLSA DELPDLAD                                               00847000
*          DELPDLAD = 0;              /* CLEAR PDL POINTER           */ 00848000
@RF00349 SLR   @10,@10                                             0351 00849000
         ST    @10,DELPDLAD                                        0351 00850000
*          IF PCLPTR ^= 0             /* IS THERE A PCL TO FREE?     */ 00851000
*            THEN                     /* YES,                        */ 00852000
         C     @10,PCLPTR                                          0352 00853000
         BE    @RF00352                                            0352 00854000
*              /* ISSUE FREEMAIN MACRO TO RELEASE DYNAMIC PCL        */ 00855000
*              GEN (FREEMAIN A=PCLPTR,MF=(E,FMLST))                0353 00856000
*                REFS(FMLST,PCLPTR,PLENGTH);                       0353 00857000
         FREEMAIN A=PCLPTR,MF=(E,FMLST)                                 00858000
*          PCLPTR = 0;                /* CLEAR PCL POINTER           */ 00859000
@RF00352 SLR   @10,@10                                             0354 00860000
         ST    @10,PCLPTR                                          0354 00861000
*          RFY R2 RSTD;               /* RESTRICT DSECT REGISTER     */ 00862000
*          /* ESTABLISH DESECT ADDRESSABILITY                        */ 00863000
*          GEN (USING IHADCB,R2)      /* ESTABLISH DSECT ADDRESSABILI*/ 00864000
*            REFS(R2);                                             0356 00865000
         USING IHADCB,R2                                                00866000
*          R2 = ADDR(DIRDCB);         /* SET PTR TO DCB              */ 00867000
         LA    R2,DIRDCB                                           0357 00868000
*          IF DCBOFLG = '1'B          /* CHK FOR OPEN FLAG IN DCB    */ 00869000
*            THEN                     /* YES, CLOSE                  */ 00870000
         TM    DCBOFLG,B'00010000'                                 0358 00871000
         BNO   @RF00358                                            0358 00872000
*              /* CLOSE DIRECTORY DCB                                */ 00873000
*              GEN (CLOSE ((R2),),MF=(E,DLCLSL))                   0359 00874000
*                REFS(DLCLSL,R2);                                  0359 00875000
         CLOSE ((R2),),MF=(E,DLCLSL)                                    00876000
*          R2 = ADDR(DELDCB);         /* SET PTR TO UADS DCB         */ 00877000
@RF00358 LA    R2,DELDCB                                           0360 00878000
*          IF DCBOFLG = '1'B          /* CHK FOR OPEN FLAG IN DCB    */ 00879000
*            THEN                     /* YES, CLOSE                  */ 00880000
         TM    DCBOFLG,B'00010000'                                 0361 00881000
         BNO   @RF00361                                            0361 00882000
*              /* CLOSE UADS DCB                                     */ 00883000
*              GEN (CLOSE ((R2),),MF=(E,DLCLSL))                   0362 00884000
*                REFS(DLCLSL,R2);                                  0362 00885000
         CLOSE ((R2),),MF=(E,DLCLSL)                                    00886000
*          /* DROP DSECT ADDRESSABILITY                              */ 00887000
*          GEN (DROP R2);                                          0363 00888000
@RF00361 DS    0H                                                  0363 00889000
         DROP R2                                                        00890000
*          RFY R2 UNRSTD;             /* RELEASE DSECT POINTER       */ 00891000
*          IF ENQFLG = '1'B           /* IS UADS ENQUEUED?           */ 00892000
*            THEN                     /* YES,                        */ 00893000
         TM    ENQFLG,B'00010000'                                  0365 00894000
         BNO   @RF00365                                            0365 00895000
*              GEN (DEQ   (,ERNAM1,8),MF=(E,DQLST))                0366 00896000
*                REFS(DQLST,EQNAM1,ERNAM1); /* DEQ SYSIKJUA-OPENUADS */ 00897000
         DEQ   (,ERNAM1,8),MF=(E,DQLST)                                 00898000
*          IF DELERR = '1'B           /* CHK FOR ERROR FLAG          */ 00899000
*            THEN                     /* YES,                        */ 00900000
@RF00365 TM    DELERR,B'00100000'                                  0367 00901000
         BNO   @RF00367                                            0367 00902000
*              ACCTECB = '40FFFFFF'X;/* POST ACCOUNT ECB WITH ERR*/     00903000
         L     @10,ACCTECBP(,ACCTPLP)                              0368 00904000
         MVC   ACCTECB(4,@10),@CF00399                             0368 00905000
*            ELSE                                                  0369 00906000
*              IF DUCLSF1='1'B        /* IS USERID *?                */ 00907000
*               | DELUSER='0'B        /* OR NO USERID DELETED?       */ 00908000
*                THEN                 /* YES,                        */ 00909000
         B     @RC00367                                            0369 00910000
@RF00367 TM    DUCLSF1,B'10000000'                                 0369 00911000
         BO    @RT00369                                            0369 00912000
         TM    DELUSER,B'10000000'                                 0369 00913000
         BNZ   @RF00369                                            0369 00914000
@RT00369 DS    0H                                                  0370 00915000
*                  DO;                /* ISSUE DELETED MESSAGE       */ 00916000
*                  MSGNO = 8;         /* SET MESSAGE INDEX           */ 00917000
         MVC   MSGNO(2),@CH00046                                   0371 00918000
*                  CALL  MSGFNDR;     /* GO TO LOCATE MESSAGE TEXT   */ 00919000
         BAL   @14,MSGFNDR                                         0372 00920000
*                  CALL  DOPUTL;      /* GO TO ISSUE PUTLINE         */ 00921000
         BAL   @14,DOPUTL                                          0373 00922000
*                  END;                                            0374 00923000
*          RETURN CODE(0);            /* GO TO EXIT TO CALLER        */ 00924000
@RF00369 DS    0H                                                  0375 00925000
@RC00367 L     @13,4(,@13)                                         0375 00926000
         L     @00,@SIZDATD                                        0375 00927000
         LR    @01,@11                                             0375 00928000
         FREEMAIN R,LV=(0),A=(1)                                        00929000
         SLR   @15,@15                                             0375 00930000
         L     @14,12(,@13)                                        0375 00931000
         LM    @00,@12,20(@13)                                     0375 00932000
         BR    @14                                                 0375 00933000
*          /* END OF DELETE  C P                                     */ 00934000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00935000
* /*                                                                 */ 00936000
* /*  D E L S T O :   EXECUTE STOW-DELETE TO REMOVE A DELETED        */ 00937000
* /*    USERID MEMBER FROM THE UADS DIRECTORY                        */ 00938000
* /*                                                                 */ 00939000
* /*    FORM THE FIRST UADS-TYPE USERID NAME BY ADDING A CHARACTER   */ 00940000
* /*    OF ZERO  DIRECTLY AFTER  THE BASIC NAME  CHARACTER STRING.   */ 00941000
* /*    EXECUTE A STOW-DELETE ON THAT MODIFIED NAME.  IF THE STOW    */ 00942000
* /*    IS SUCCESSFUL (RETURN CODE OF 0), ADD A VALUE OF 1 TO THE    */ 00943000
* /*    APPENDED CHARACTER  IN THE USERID NAME  AND RE-ISSUE THE     */ 00944000
* /*    STOW-DELETE.  REPEAT THIS SUCCESSFUL PROCESS UNTIL 9 MEMBER  */ 00945000
* /*    BLOCKS (APPENDED CHARACTER 9) HAVE BEEN REMOVED,  THEN GO    */ 00946000
* /*    TO DOBLDU TO EXIT                                            */ 00947000
* /*                                                                 */ 00948000
* /*    IF A RETURN CODE OF 8 IS RETURNED BEFORE NINE MEMBERS HAVE   */ 00949000
* /*    BEEN REMOVED, CHECK IF APPENDED CHARACTER IS ZERO (FIRST     */ 00950000
* /*    MEMBER) SIGNIFYING NO SUCH MEMBER NAME EXISTS IN THE UADS.   */ 00951000
* /*    IF YES, GO TO ISSUE AN ERROR MESSAGE AND RETURN.  IF EXTENT  */ 00952000
* /*    CHARACTER IS NOT ZERO, ALL MEMBER NAMES OF THAT USERID HAVE  */ 00953000
* /*    BEEN REMOVED FROM THE DIRECTORY.  GO TO DOBLDU TO RETURN     */ 00954000
* /*                                                                 */ 00955000
* /*    IF RETURN CODE IS OTHER THAN 8,  ISSUE THE SYSTEM COMMAND    */ 00956000
* /*    ERROR MESSAGE WITH STOW ERROR CODE                           */ 00957000
* /*                                                                 */ 00958000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00959000
*DELSTO:   /* EP TO STOW AND BUILD UDL ROUTINE                       */ 00960000
*          PROC ;                                                  0376 00961000
@EL00001 L     @13,4(,@13)                                         0376 00962000
@EF00001 L     @00,@SIZDATD                                        0376 00963000
         LR    @01,@11                                             0376 00964000
         FREEMAIN R,LV=(0),A=(1)                                        00965000
@ER00001 LM    @14,@12,12(@13)                                     0376 00966000
         BR    @14                                                 0376 00967000
@PB00001 DS    0H                                                  0376 00968000
DELSTO   STM   @14,@03,@SA00002                                    0376 00969000
         STM   @05,@12,@SA00002+24                                 0376 00970000
*          STOLST = MEMNAME;          /* SET UP USERID NAME          */ 00971000
         L     @10,ACIOLINK                                        0377 00972000
         MVC   STOLST(8),MEMNAME(@10)                              0377 00973000
*          /* SET UP NAME IMAGE                                      */ 00974000
*          TMSGTIL1 = USRLEN+4;       /* EXTRACT LENGTH              */ 00975000
         SLR   @05,@05                                             0378 00976000
         IC    @05,USRLEN                                          0378 00977000
         LA    @00,4                                               0378 00978000
         ALR   @00,@05                                             0378 00979000
         STH   @00,TMSGTIL1                                        0378 00980000
*          TMSGTIN1(1:USRLEN) = MEMNAME; /* SET NAME IN SEG.         */ 00981000
         BCTR  @05,0                                               0379 00982000
         EX    @05,@SM00450                                        0379 00983000
*          /* DELETE CURRENT USERID FROM UADS                        */ 00984000
*          /* EXECUTE STOW-DELETE                                    */ 00985000
*          DO WHILE RETNCODE = 0;                                  0380 00986000
         B     @DE00380                                            0380 00987000
@DL00380 DS    0H                                                  0381 00988000
*            GEN (STOW  DELDCB,STOLST,D)                           0381 00989000
*              REFS(DELDCB,STOLST);                                0381 00990000
         STOW  DELDCB,STOLST,D                                          00991000
*            RFY R15 RSTD;            /* RESTRICT RETURN CODE REG    */ 00992000
*            RETNCODE = R15;          /* RESERVE RETURN CODE         */ 00993000
         LR    RETNCODE,R15                                        0383 00994000
*            RFY R15 UNRSTD;          /* RELEASE RETURN CODE REG     */ 00995000
*            STOLST(USRLEN+1) =                                    0385 00996000
*             STOLST(USRLEN+1)+1;     /* INCREMENT EXTENT NUMBER     */ 00997000
         SLR   @10,@10                                             0385 00998000
         IC    @10,USRLEN                                          0385 00999000
         LA    @05,1                                               0385 01000000
         SLR   @00,@00                                             0385 01001000
         IC    @00,STOLST(@10)                                     0385 01002000
         ALR   @05,@00                                             0385 01003000
         STC   @05,STOLST(@10)                                     0385 01004000
*          END;                                                    0386 01005000
@DE00380 LTR   RETNCODE,RETNCODE                                   0386 01006000
         BZ    @DL00380                                            0386 01007000
*          IF RETNCODE ^= 8           /* CHK FOR FAILURE TO FIND ID  */ 01008000
*            THEN                     /* YES,                        */ 01009000
         CH    RETNCODE,@CH00046                                   0387 01010000
         BE    @RF00387                                            0387 01011000
*              DO;                                                 0388 01012000
*              IF RETNCODE = 16       /* IS THIS AN I/O ERROR        */ 01013000
*                THEN                 /* YES                         */ 01014000
         CH    RETNCODE,@CH00044                                   0389 01015000
         BNE   @RF00389                                            0389 01016000
*                  DO;                                             0390 01017000
*                  MSGNO = 7;         /* PUT OUT ERROR MESSAGE       */ 01018000
         MVC   MSGNO(2),@CH00159                                   0391 01019000
*                  RETURN TO ERRMSG;  /* GO TO ISSUE MESSAGE         */ 01020000
         LA    @14,ERRMSG                                          0392 01021000
         LM    @15,@03,@SA00002+4                                  0392 01022000
         LM    @05,@12,@SA00002+24                                 0392 01023000
         BR    @14                                                 0392 01024000
*                  END;                                            0393 01025000
*                ELSE                                              0394 01026000
*                  DO;                /* INVALID STOW RETURN CODE    */ 01027000
@RF00389 DS    0H                                                  0395 01028000
*                  MSGNO = 14;        /* SET MESSAGE INDEX           */ 01029000
         MVC   MSGNO(2),@CH00403                                   0395 01030000
*                  RETURN TO  SYSERRD;/* GO TO ISSUE MESSAGE         */ 01031000
         LA    @14,SYSERRD                                         0396 01032000
         LM    @15,@03,@SA00002+4                                  0396 01033000
         LM    @05,@12,@SA00002+24                                 0396 01034000
         BR    @14                                                 0396 01035000
*                  END;                                            0397 01036000
*              END;                                                0398 01037000
*          IF STOLST(USRLEN+1) = '0'  /* CHK IF FIRST EXTENT         */ 01038000
*            THEN                     /* YES,                        */ 01039000
@RF00387 SLR   @10,@10                                             0399 01040000
         IC    @10,USRLEN                                          0399 01041000
         LA    @15,STOLST(@10)                                     0399 01042000
         CLI   0(@15),C'0'                                         0399 01043000
         BNE   @RF00399                                            0399 01044000
*              DO;                                                 0400 01045000
*              MSGNO = 5;             /* SET USERID MESSAGE INDEX    */ 01046000
         MVC   MSGNO(2),@CH00183                                   0401 01047000
*              CALL  MSGFNDR;         /* THEN LOCATE MESSAGE TEXT    */ 01048000
         BAL   @14,MSGFNDR                                         0402 01049000
*              TMSGTIO1 = 11;         /* SET INSERTION OFFSET        */ 01050000
         MVC   TMSGTIO1(2),@CH00380                                0403 01051000
*              SEGPTR13 = ADDR(TMSGTIX1);/* SET PTR TO NAME SEG.     */ 01052000
         LA    @10,TMSGTIX1                                        0404 01053000
         ST    @10,SEGPTR13                                        0404 01054000
*              RETURN TO MSGNGRM;     /* GO TO ISSUE MESSAGE         */ 01055000
         LA    @14,MSGNGRM                                         0405 01056000
         LM    @15,@03,@SA00002+4                                  0405 01057000
         LM    @05,@12,@SA00002+24                                 0405 01058000
         BR    @14                                                 0405 01059000
*              END;                                                0406 01060000
*          ACIOFL05 = '0'B;           /* CLEAR WRITE REQUEST FLAG    */ 01061000
@RF00399 NI    ACIOFL05,B'11110111'                                0407 01062000
*          CALL DOWRITE;              /* CALL IKJEFA52 TO FREE CORE  */ 01063000
         BAL   @14,DOWRITE                                         0408 01064000
*          IF DELUSER = '0'B          /* IS USERID THE DELETE LEVEL? */ 01065000
*            THEN                     /* YES,                        */ 01066000
         TM    DELUSER,B'10000000'                                 0409 01067000
         BZ    @RT00409                                            0409 01068000
*              GOTO DOBLDU;           /* SKIP USERID DELETED MESSAGE */ 01069000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01070000
* /*     ISSUE THE USERID DELETED MESSAGE.                           */ 01071000
* /*     IF THE USERID IS AN ASTERISK, BACKSPACE AND REREAD THE      */ 01072000
* /*     DIRECTORY.                                                  */ 01073000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01074000
*          /* ISSUE USERID DELETED MESSAGE                           */ 01075000
*          MSGNO  =  9;               /* SET MESSAGE INDEX           */ 01076000
         MVC   MSGNO(2),@CH00405                                   0411 01077000
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */ 01078000
         BAL   @14,MSGFNDR                                         0412 01079000
*          TMSGTIO1 = 17;             /* SET INSERT OFFSET           */ 01080000
         MVC   TMSGTIO1(2),@CH00406                                0413 01081000
*          SEGPTR12 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEG.        */ 01082000
         LA    @10,TMSGTIX1                                        0414 01083000
         ST    @10,SEGPTR12                                        0414 01084000
*          CALL  DOPUTL;              /* GO TO ISSUE PUTLINE         */ 01085000
         BAL   @14,DOPUTL                                          0415 01086000
*          IF DUCLSF1 = '0'B          /* USERID WAS SPECIFIED        */ 01087000
*            THEN                     /* YES,                        */ 01088000
         TM    DUCLSF1,B'10000000'                                 0416 01089000
         BZ    @RT00416                                            0416 01090000
*              GOTO  DOBLDU;          /* GO TO CREATE THE UIDL       */ 01091000
*          NEXTNAME = NEXTUSER;       /* SAVE THE USERID OF THE NEXT    01092000
*                                        USER TO BE PROCESSED        */ 01093000
         L     @10,ACIOMPTR                                        0418 01094000
         MVC   NEXTNAME(8),NEXTUSER(@10)                           0418 01095000
*BKSP:     /* SET TO REREAD PDS DIRECTORY BLOCK                      */ 01096000
*          GEN REFS(DIRDCB) (BSP   DIRDCB);                        0419 01097000
BKSP     BSP   DIRDCB                                                   01098000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 01099000
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */ 01100000
         LR    RETNCODE,R15                                        0421 01101000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 01102000
*          IF RETNCODE ^= 0           /* CHK FOR ZERO CODE           */ 01103000
*            THEN                     /* NO,                         */ 01104000
         LTR   RETNCODE,RETNCODE                                   0423 01105000
         BZ    @RF00423                                            0423 01106000
*              DO;                                                 0424 01107000
*              MSGNO = 27;            /* SET MESSAGE INDEX           */ 01108000
         MVC   MSGNO(2),@CH00409                                   0425 01109000
*              RETURN TO  SYSERRD;    /* GO TO ISSUE MESSAGE         */ 01110000
         LA    @14,SYSERRD                                         0426 01111000
         LM    @15,@03,@SA00002+4                                  0426 01112000
         LM    @05,@12,@SA00002+24                                 0426 01113000
         BR    @14                                                 0426 01114000
*              END;                                                0427 01115000
*          ACIOFL06 = '1'B;           /* READ DIRECTORY ONLY FLAG    */ 01116000
@RF00423 OI    ACIOFL06,B'00000100'                                0428 01117000
*          ACIODRCT = ADDR(DIRWA);    /* SET PTR TO WORK AREA        */ 01118000
         LA    @10,DIRWA                                           0429 01119000
         ST    @10,ACIODRCT                                        0429 01120000
*          CALL  DOREAD;              /* GO TO GET DIRECTORY BLOCK   */ 01121000
         BAL   @14,DOREAD                                          0430 01122000
*          ACIOFL06 = '0'B;           /* CLEAR DIRECTORY ONLY FLAG   */ 01123000
         NI    ACIOFL06,B'11111011'                                0431 01124000
*          DIRBDAP = ADDR(DIRBNAM1);  /* SET DYN PTR TO 1ST NAME     */ 01125000
         LA    DIRBDAP,DIRBNAM1                                    0432 01126000
*          /* CHK IF NEXT NAME IN CURRENT BLOCK                      */ 01127000
*          IF DIRBNAM > NEXTNAME      /* CHK IF 1ST NAME HIGHER      */ 01128000
*            THEN                     /* YES,                        */ 01129000
         CLC   DIRBNAM(8,DIRBDAP),NEXTNAME                         0433 01130000
         BH    @RT00433                                            0433 01131000
*              GOTO  BKSP;            /* GO TO GET PREVIOUS BLOCK    */ 01132000
*          /* IF CURRENT NEXT NAME FOUND, GO TO READ MEMBER          */ 01133000
*          DO WHILE DIRBNAM ^= NEXTNAME;/* CHK FOR FIRST LEVEL       */ 01134000
         B     @DE00435                                            0435 01135000
@DL00435 DS    0H                                                  0436 01136000
*            DIRBDAP = DIRBDAP+       /* POINT TO NEXT ITEM          */ 01137000
*              (DIRBC & '1F'X)*2+12;                               0436 01138000
         LA    @10,31                                              0436 01139000
         SLR   @03,@03                                             0436 01140000
         IC    @03,DIRBC(,DIRBDAP)                                 0436 01141000
         NR    @10,@03                                             0436 01142000
         ALR   @10,@10                                             0436 01143000
         ALR   @10,DIRBDAP                                         0436 01144000
         AH    @10,@CH00130                                        0436 01145000
         LR    DIRBDAP,@10                                         0436 01146000
*            END;                                                  0437 01147000
@DE00435 CLC   DIRBNAM(8,DIRBDAP),NEXTNAME                         0437 01148000
         BNE   @DL00435                                            0437 01149000
*          ACIOMPTR = DIRBDAP;        /* SET PTR TO CURRENT NAME     */ 01150000
         ST    DIRBDAP,ACIOMPTR                                    0438 01151000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01152000
* /*  DOBLDU:  SET THE DELETED FLAG IN THE USERID PDE.  EXECUTE      */ 01153000
* /*    GETMAIN TO GET SPACE FOR THE USER IDENTITY LIST (UDL).  IF   */ 01154000
* /*    GETMAIN FAILS, GO TO ISSUE THE INSUFFICIENT MAIN STORAGE     */ 01155000
* /*    ERROR MESSAGE.  LOCATE THE NEXT SEQUENTIAL POSITION IN UDL   */ 01156000
* /*    CHAIN AND LINK IN NEW ENTRY.                                 */ 01157000
* /*                                                                 */ 01158000
* /*    BUILD THE ENTRY FROM DELETE INDICATOR FLAG, A COUNT OF THE   */ 01159000
* /*    DELETED MEMBER NAMES INCLUDED IN THIS ENTRY, AND THE CHAR-   */ 01160000
* /*    ACTER STRINGS FOR THE NAMES                                  */ 01161000
* /*                                                                 */ 01162000
* /*    RETURN TO CALLER                                             */ 01163000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01164000
*DOBLDU:   /* SET USERID DELETED FLAG AND STOW-DONE FLAG             */ 01165000
*          /* GET SPACE FOR UDL ENTRY                                */ 01166000
*          /* ISSUE GETMAIN                                          */ 01167000
*          GEN  (GETMAIN  ,A=GOTMNP,MF=(E,BLDUDL))                 0439 01168000
*             REFS(GOTMNP,BLDUDL);                                 0439 01169000
DOBLDU   GETMAIN  ,A=GOTMNP,MF=(E,BLDUDL)                               01170000
*          /* CHK FOR SUCCESSFUL GETMAIN                             */ 01171000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 01172000
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */ 01173000
         LR    RETNCODE,R15                                        0441 01174000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 01175000
*          IF RETNCODE = 4            /* CHK FOR FAILURE CODE        */ 01176000
*            THEN                     /* YES,                        */ 01177000
         CH    RETNCODE,@CH00066                                   0443 01178000
         BNE   @RF00443                                            0443 01179000
*              RETURN TO  NOSPAZ;     /* GO TO ISSUE NO SPACE MSG    */ 01180000
         LA    @14,NOSPAZ                                          0444 01181000
         LM    @15,@03,@SA00002+4                                  0444 01182000
         LM    @05,@12,@SA00002+24                                 0444 01183000
         BR    @14                                                 0444 01184000
*          GOTMSPZ = '0'B;            /* CLEAR FIRST 8 BYTES OF NEW     01185000
*                                           UDL ENTRY                */ 01186000
@RF00443 L     @10,GOTMNP                                          0445 01187000
         XC    GOTMSPZ+1(7,@10),GOTMSPZ+1(@10)                     0445 01188000
         MVI   GOTMSPZ(@10),B'00000000'                            0445 01189000
*          IF UIDLPTR = 0             /* IS THIS THE FIRST UIDL?     */ 01190000
*            THEN                     /* YES,                        */ 01191000
         L     @07,UIDLPTR(,ACCTPLP)                               0446 01192000
         LTR   @07,@07                                             0446 01193000
         BNZ   @RF00446                                            0446 01194000
*              UIDLPTR = GOTMNP;      /* INIT UIDL PTR               */ 01195000
         ST    @10,UIDLPTR(,ACCTPLP)                               0447 01196000
*            ELSE                     /* NO,                         */ 01197000
*              DO;                                                 0448 01198000
         B     @RC00446                                            0448 01199000
@RF00446 DS    0H                                                  0449 01200000
*              UIDLCHP = UIDLPTR;     /* INITIALIZE WITH FIRST PTR   */ 01201000
         L     UIDLCHP,UIDLPTR(,ACCTPLP)                           0449 01202000
*              /* LOCATE NEXT POSITION IN UDL CHAIN                  */ 01203000
*              RFY DUIDL BASED(UIDLCHP);                           0450 01204000
*              DO WHILE UIDLNEX ^= 0; /* 0 = LAST PTR                */ 01205000
         B     @DE00451                                            0451 01206000
@DL00451 DS    0H                                                  0452 01207000
*                UIDLCHP = UIDLNEX;   /* STEP PTR                    */ 01208000
         L     UIDLCHP,UIDLNEX(,UIDLCHP)                           0452 01209000
*                END;                                              0453 01210000
@DE00451 L     @10,UIDLNEX(,UIDLCHP)                               0453 01211000
         LTR   @10,@10                                             0453 01212000
         BNZ   @DL00451                                            0453 01213000
*              UIDLNEX = GOTMNP;      /* SET NEW SPACE LOC IN PTR    */ 01214000
         L     @10,GOTMNP                                          0454 01215000
         ST    @10,UIDLNEX(,UIDLCHP)                               0454 01216000
*              END;                                                0455 01217000
*          RFY DUIDL BASED(GOTMNP);                                0456 01218000
@RC00446 DS    0H                                                  0457 01219000
*          UIDDEL = '1'B;             /* SET DELETE RESULT FLAG      */ 01220000
         L     @10,GOTMNP                                          0457 01221000
         OI    UIDDEL(@10),B'01000000'                             0457 01222000
*          UIDLCT = 1;                /* SET MEMBER COUNT            */ 01223000
         MVC   UIDLCT(2,@10),@CH00032                              0458 01224000
*          UIDUSER(1) = USRID(1:USRLEN);/* SET MEMBER NAME IN ENTRY  */ 01225000
         MVI   UIDUSER+1(@10),C' '                                 0459 01226000
         MVC   UIDUSER+2(6,@10),UIDUSER+1(@10)                     0459 01227000
         SLR   @07,@07                                             0459 01228000
         IC    @07,USRLEN                                          0459 01229000
         BCTR  @07,0                                               0459 01230000
         EX    @07,@SM00453                                        0459 01231000
*          END  DELSTO;               /* RETURN TO CALLER            */ 01232000
@EL00002 DS    0H                                                  0460 01233000
@EF00002 DS    0H                                                  0460 01234000
@ER00002 LM    @14,@03,@SA00002                                    0460 01235000
         LM    @05,@12,@SA00002+24                                 0460 01236000
         BR    @14                                                 0460 01237000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01238000
* /*                                                                 */ 01239000
* /*  M S G F N D R :   EP TO LOCATE ERROR MESSAGE ROUTINE.          */ 01240000
* /*    FORM A POINTER TO THE MESSAGE OFFSET BY SUBTRACTING 2 FROM   */ 01241000
* /*    TH SUM OF THE LOCATION OF THE MESSAGE CSECT (ANDXL) AND THE  */ 01242000
* /*    THE VALUE OF THE MESSAGE INDEX NUMBER (MSGN0) TIMES 2.       */ 01243000
* /*    ADD THAT LOCATED OFFSET VALUE (MOFFNC) TO THE LOCATION OF    */ 01244000
* /*    THE MESSAGE CSECT (ANDXL) TO FORM A POINTER TO THE MESSAGE   */ 01245000
* /*    SEGMENT LIST IN MSGPTR.  RETURN TO CALLER                    */ 01246000
* /*                                                                 */ 01247000
* /*    AT ENTRY, MSGNO CONTAINS THE MESSAGE INDEX NUMBER            */ 01248000
* /*                                                                 */ 01249000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01250000
*MSGFNDR: /* LOCATE MESSAGE TEXT ROUTINE EP                          */ 01251000
*         PROC ;                                                   0461 01252000
MSGFNDR  STM   @14,@12,12(@13)                                     0461 01253000
*         MSGFIND = (MSGNO*2)+        /* FORM PTR TO OFFSET          */ 01254000
*              ADDR(ANDXL)-2;                                      0462 01255000
         LH    MSGFIND,MSGNO                                       0462 01256000
         ALR   MSGFIND,MSGFIND                                     0462 01257000
         L     @10,@CV00069                                        0462 01258000
         ALR   MSGFIND,@10                                         0462 01259000
         BCTR  MSGFIND,0                                           0462 01260000
         BCTR  MSGFIND,0                                           0462 01261000
*         MSGPTR = MOFFSET +          /* FORM PTR TO TEXT            */ 01262000
*              ADDR(ANDXL);                                        0463 01263000
         L     MSGPTR,@CV00069                                     0463 01264000
         AH    MSGPTR,MOFFSET(,MSGFIND)                            0463 01265000
*         MINDX = (SGNO1*4)+8;        /* NUMBER OF BYTES IN MSGHEADR */ 01266000
         LA    @10,8                                               0464 01267000
         L     MINDX,SGNO1(,MSGPTR)                                0464 01268000
         SLA   MINDX,2                                             0464 01269000
         ALR   MINDX,@10                                           0464 01270000
*         AMSGHDR1(1:MINDX) =         /* TRANSFER MSG HEADER TO..    */ 01271000
*           PTRMASK1;                 /* ..DYNAMIC HEADER AREA       */ 01272000
         LR    @15,MINDX                                           0465 01273000
         BCTR  @15,0                                               0465 01274000
         EX    @15,@SM00455                                        0465 01275000
*         /* IF THIS IS NOT A MULTI-LEVEL MESSAGE, THEN BYPASS THE   */ 01276000
*         /* MESSAGE HEADER TRANSFER.                                */ 01277000
*         IF NXTLADR1 ^= '0'B                                      0466 01278000
*           THEN                      /* YES, MULTI-LEVEL MSG        */ 01279000
         L     @03,NXTLADR1(,MSGPTR)                               0466 01280000
         LTR   @03,@03                                             0466 01281000
         BZ    @RF00466                                            0466 01282000
*             DO;                                                  0467 01283000
*             LEVPTR1 = ADDR(AMSGHDR2);/* POINT TO 2ND LEVEL MSG     */ 01284000
         LA    @00,AMSGHDR2                                        0468 01285000
         ST    @00,LEVPTR1                                         0468 01286000
*             MINDX = (SGNO2*4)+8;    /* NUMBER OF BYTES IN MSGHEADR */ 01287000
         L     @15,NXTLADR1(,MSGPTR)                               0469 01288000
         L     MINDX,SGNO2(,@15)                                   0469 01289000
         SLA   MINDX,2                                             0469 01290000
         ALR   MINDX,@10                                           0469 01291000
*             AMSGHDR2(1:MINDX) =     /* TRANSFER MSG HEADER TO..    */ 01292000
*               PTRMASK2;             /* ..DYNAMIC HEADER AREA       */ 01293000
         LR    @10,MINDX                                           0470 01294000
         BCTR  @10,0                                               0470 01295000
         EX    @10,@SM00457                                        0470 01296000
*             END;                                                 0471 01297000
*         END  MSGFNDR;               /* RETURN TO CALLER            */ 01298000
@EL00003 DS    0H                                                  0472 01299000
@EF00003 DS    0H                                                  0472 01300000
@ER00003 LM    @14,@12,12(@13)                                     0472 01301000
         BR    @14                                                 0472 01302000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01303000
* /*                                                                 */ 01304000
* /*  C O L L C T :   INITIALIZE COUNTER (NAMCTR) TO ZERO.  CLEAR    */ 01305000
* /*     DELETE CONTROL FLAGS IN EACH PDE AND STEP NAMCTR BY 1 FOR   */ 01306000
* /*     EACH PDE IN CHAIN.  SAVE ACCUMULATED COUNT IN TOTAL COUNT   */ 01307000
* /*     FIELD (NMDTN1)  AND  CURRENT COUNT FIELD (NMDCN1)  FOR      */ 01308000
* /*     CURRENT LEVEL OF DPL                                        */ 01309000
* /*                                                                 */ 01310000
* /*     AT ENTRY,  DNMIDP  POINTS  TO CURRENT LEVEL OF DPL  AND     */ 01311000
* /*     NAMPTR POINTS TO FIRST PDE OF CURRENT CHAIN                 */ 01312000
* /*                                                                 */ 01313000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01314000
*COLLCT:   /* NAME OF PDE COUNT COLLECTOR ROUTINE                    */ 01315000
*          PROC ;                                                  0473 01316000
COLLCT   STM   @14,@12,12(@13)                                     0473 01317000
*          DNMIDP = DADP;             /* SET POINTER TO DPL LEVEL    */ 01318000
         L     DNMIDP,DADP                                         0474 01319000
*          NAMCTR = 1;                /* INITIALIZE COUNTER          */ 01320000
         LA    NAMCTR,1                                            0475 01321000
*          NAMID1 = PDEPTR;           /* SET PTR TO 1ST PDE          */ 01322000
         ST    PDEPTR,NAMID1(,DNMIDP)                              0476 01323000
*          NAMIDN1 = PDEPTR;          /* SET PTR TO CURRENT PDE      */ 01324000
         ST    PDEPTR,NAMIDN1(,DNMIDP)                             0477 01325000
*          DO WHILE NPTRNEX ^= 0;     /* CHECK FOR END OF LIST       */ 01326000
         B     @DE00478                                            0478 01327000
@DL00478 DS    0H                                                  0479 01328000
*            NAMCTR = NAMCTR+1;       /* STEP COUNTER                */ 01329000
         AH    NAMCTR,@CH00032                                     0479 01330000
*            NAMFLGD = '0'B;          /* CLEAR DELETED FLAG          */ 01331000
         NI    NAMFLGD(PDEPTR),B'11111110'                         0480 01332000
*            PDEPTR = NPTRNEX;        /* STEP PTR TO NEXT ELEMENT    */ 01333000
         SLR   @10,@10                                             0481 01334000
         ICM   @10,7,NPTRNEX(PDEPTR)                               0481 01335000
         LR    PDEPTR,@10                                          0481 01336000
*            END;                                                  0482 01337000
@DE00478 ICM   @10,7,NPTRNEX(PDEPTR)                               0482 01338000
         BNZ   @DL00478                                            0482 01339000
*          NMDTN1 = NAMCTR;           /* SAVE TOTAL COUNT            */ 01340000
         STH   NAMCTR,NMDTN1(,DNMIDP)                              0483 01341000
*          NMDCN1 = 1;                /* SET CURRENT COUNT           */ 01342000
         MVC   NMDCN1(2,DNMIDP),@CH00032                           0484 01343000
*          /* RETURN TO CALLER                                       */ 01344000
*          END  COLLCT;                                            0485 01345000
@EL00004 DS    0H                                                  0485 01346000
@EF00004 DS    0H                                                  0485 01347000
@ER00004 LM    @14,@12,12(@13)                                     0485 01348000
         BR    @14                                                 0485 01349000
*DOPUTL:   /* SET UP FOR PUTLINE SERVICE ROUTINE                     */ 01350000
*          PROC ;                                                  0486 01351000
DOPUTL   STM   @14,@03,@SA00005                                    0486 01352000
         STM   @05,@12,@SA00005+24                                 0486 01353000
*          PTPBOPUT = ADDR(AMSGHDR1); /* POINT TO OLDS               */ 01354000
         L     @10,PTPBPTR(,IOPLPTR)                               0487 01355000
         LA    @05,AMSGHDR1                                        0487 01356000
         ST    @05,PTPBOPUT(,@10)                                  0487 01357000
*          /* CREATE LINK TO PUTLINE                                 */ 01358000
*          GEN (PUTLINE ,MF=(E,PLOUT))                             0488 01359000
*              REFS(PLOUT);                                        0488 01360000
         PUTLINE ,MF=(E,PLOUT)                                          01361000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 01362000
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */ 01363000
         LR    RETNCODE,R15                                        0490 01364000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 01365000
*          IF RETNCODE > 8            /* CHK FOR SUCESSFUL PUTLINE   */ 01366000
*            THEN                     /* NO,                         */ 01367000
         CH    RETNCODE,@CH00046                                   0492 01368000
         BNH   @RF00492                                            0492 01369000
*              DO;                                                 0493 01370000
*              IF PLFAIL = '0'B       /* CHK FOR PREVIOUS FAILURE    */ 01371000
*                THEN                 /* NO,                         */ 01372000
         TM    PLFAIL,B'00001000'                                  0494 01373000
         BNZ   @RF00494                                            0494 01374000
*                  DO;                                             0495 01375000
*                  PLFAIL = '1'B;     /* SET PUTLINE FAILURE FLAG    */ 01376000
         OI    PLFAIL,B'00001000'                                  0496 01377000
*                  IF RETNCODE = 16   /* INSUFFICIENT SPACE?         */ 01378000
*                    THEN             /* YES,                        */ 01379000
         CH    RETNCODE,@CH00044                                   0497 01380000
         BNE   @RF00497                                            0497 01381000
*                      RETURN TO  NOSPAZ; /* GO ISSUE NO SPACE MSG   */ 01382000
         LA    @14,NOSPAZ                                          0498 01383000
         LM    @15,@03,@SA00005+4                                  0498 01384000
         LM    @05,@12,@SA00005+24                                 0498 01385000
         BR    @14                                                 0498 01386000
*                  MSGNO = 2;         /* SET MESSAGE INDEX           */ 01387000
@RF00497 MVC   MSGNO(2),@CH00037                                   0499 01388000
*                  RETURN TO SYSERRD; /* TO ISSUE SYSTEM ERROR MSG   */ 01389000
         LA    @14,SYSERRD                                         0500 01390000
         LM    @15,@03,@SA00005+4                                  0500 01391000
         LM    @05,@12,@SA00005+24                                 0500 01392000
         BR    @14                                                 0500 01393000
*                  END;                                            0501 01394000
*              END;                                                0502 01395000
@RF00494 DS    0H                                                  0503 01396000
*          PLFAIL = '0'B;             /* CLEAR PUTLINE FAILURE FLAG  */ 01397000
@RF00492 NI    PLFAIL,B'11110111'                                  0503 01398000
*          END  DOPUTL;               /* RETURN TO CALLER            */ 01399000
@EL00005 DS    0H                                                  0504 01400000
@EF00005 DS    0H                                                  0504 01401000
@ER00005 LM    @14,@03,@SA00005                                    0504 01402000
         LM    @05,@12,@SA00005+24                                 0504 01403000
         BR    @14                                                 0504 01404000
*DOREAD:   /* EP TO READ SPECIFIED USER MEMBER                       */ 01405000
*          PROC ;                                                  0505 01406000
DOREAD   STM   @14,@03,@SA00006                                    0505 01407000
         STM   @05,@12,@SA00006+24                                 0505 01408000
*          ACIOFL05 = '0'B;           /* CLEAR WRITE FLAG            */ 01409000
         NI    ACIOFL05,B'11110111'                                0506 01410000
*          RFY R1 RSTD;               /* RESTRICT REG 1              */ 01411000
*          R1 = ADDR(ACIOPARM);       /* PTR TO READ  PARAMETER BLOCK*/ 01412000
         LA    R1,ACIOPARM                                         0508 01413000
*          /* LINK TO READ ROUTINE                                   */ 01414000
*          CALL  IKJEFA51;            /* GO TO READ ROUTINE          */ 01415000
         L     @15,@CV00071                                        0509 01416000
         BALR  @14,@15                                             0509 01417000
*          RFY R1 UNRSTD;             /* RELEASE REG 1               */ 01418000
*          /* CHK FOR SUCCESSFUL OPERATION                           */ 01419000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 01420000
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */ 01421000
         LR    RETNCODE,R15                                        0512 01422000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 01423000
*          /* CHK FOR ORIGINAL USERID ASTERISK ENTRY                 */ 01424000
*          IF DUCLSF1 = '1'B          /* CHK FOR ASTERISK FLAG       */ 01425000
*           & ACIOLINK ^= 0           /* AND BLDL OK                 */ 01426000
*            THEN                     /* YES,                        */ 01427000
         TM    DUCLSF1,B'10000000'                                 0514 01428000
         BNO   @RF00514                                            0514 01429000
         L     @10,ACIOLINK                                        0514 01430000
         LTR   @10,@10                                             0514 01431000
         BZ    @RF00514                                            0514 01432000
*              DO;                                                 0515 01433000
*              USRID = MEMNAME;       /* RESERVE NEW MEMBER NAME     */ 01434000
         MVC   USRID(8),MEMNAME(@10)                               0516 01435000
*              USRLEN = 8;            /* INITIALIZE LENGTH COUNT     */ 01436000
         MVI   USRLEN,X'08'                                        0517 01437000
*              /* FIND LENGTH OF NEW NAME                            */ 01438000
*              DO WHILE USRID(USRLEN) = ' ';/* TEST FOR BLANK        */ 01439000
         B     @DE00518                                            0518 01440000
@DL00518 DS    0H                                                  0519 01441000
*                USRLEN = USRLEN-1;   /* STEP LENGTH COUNT           */ 01442000
         SLR   @10,@10                                             0519 01443000
         IC    @10,USRLEN                                          0519 01444000
         BCTR  @10,0                                               0519 01445000
         STC   @10,USRLEN                                          0519 01446000
*                END;                                              0520 01447000
@DE00518 SLR   @10,@10                                             0520 01448000
         IC    @10,USRLEN                                          0520 01449000
         LA    @05,USRID-1(@10)                                    0520 01450000
         CLI   0(@05),C' '                                         0520 01451000
         BE    @DL00518                                            0520 01452000
*              USRLEN = USRLEN-1;     /* STEP PAST INDEX             */ 01453000
         BCTR  @10,0                                               0521 01454000
         STC   @10,USRLEN                                          0521 01455000
*              END;                                                0522 01456000
*          IF RETNCODE ^= 0           /* CHK FOR SUCCESS CODE        */ 01457000
*            THEN                                                  0523 01458000
@RF00514 LTR   RETNCODE,RETNCODE                                   0523 01459000
         BZ    @RF00523                                            0523 01460000
*              DO;                                                 0524 01461000
*              IF RETNCODE = 4        /* CHK FOR NOT FOUND AND       */ 01462000
*               & DUCLSF1 = '0'B      /*   SPECIFIC USER ENTERED     */ 01463000
*                THEN                 /* YES,                        */ 01464000
         CH    RETNCODE,@CH00066                                   0525 01465000
         BNE   @RF00525                                            0525 01466000
         TM    DUCLSF1,B'10000000'                                 0525 01467000
         BNZ   @RF00525                                            0525 01468000
*                  DO;                                             0526 01469000
*                  MSGNO = 5;         /* SET USERID MESSAGE INDEX    */ 01470000
         MVC   MSGNO(2),@CH00183                                   0527 01471000
*                  CALL  MSGFNDR;     /* THEN LOCATE MESSAGE TEXT    */ 01472000
         BAL   @14,MSGFNDR                                         0528 01473000
*                  /* SET UP NAME IMAGE                              */ 01474000
*                  TMSGTIL1 = USRLEN+4;/* EXTRACT LENGTH             */ 01475000
         LA    @10,4                                               0529 01476000
         SLR   @15,@15                                             0529 01477000
         IC    @15,USRLEN                                          0529 01478000
         ALR   @10,@15                                             0529 01479000
         STH   @10,TMSGTIL1                                        0529 01480000
*                  TMSGTIO1 = 11;     /* SET INSERTION OFFSET        */ 01481000
         MVC   TMSGTIO1(2),@CH00380                                0530 01482000
*                  TMSGTIN1 = USRID;  /* SET NAME IN SEG.            */ 01483000
         MVC   TMSGTIN1(8),USRID                                   0531 01484000
*                  SEGPTR13 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEG.*/ 01485000
         LA    @10,TMSGTIX1                                        0532 01486000
         ST    @10,SEGPTR13                                        0532 01487000
*                  RETURN TO MSGNGRM; /* GO TO ISSUE ERROR MSG       */ 01488000
         LA    @14,MSGNGRM                                         0533 01489000
         LM    @15,@03,@SA00006+4                                  0533 01490000
         LM    @05,@12,@SA00006+24                                 0533 01491000
         BR    @14                                                 0533 01492000
*                  END;                                            0534 01493000
*              IF RETNCODE = 8        /* CHK FOR BLDL I/O ERR        */ 01494000
*                THEN                 /* YES,                        */ 01495000
@RF00525 CH    RETNCODE,@CH00046                                   0535 01496000
         BNE   @RF00535                                            0535 01497000
*                  DO;                                             0536 01498000
*                  MSGNO = 4;         /* SET MESSAGE INDEX           */ 01499000
         MVC   MSGNO(2),@CH00066                                   0537 01500000
*                  RETURN TO ERRMSG;  /* GO TO ISSUE ERROR MSG       */ 01501000
         LA    @14,ERRMSG                                          0538 01502000
         LM    @15,@03,@SA00006+4                                  0538 01503000
         LM    @05,@12,@SA00006+24                                 0538 01504000
         BR    @14                                                 0538 01505000
*                  END;                                            0539 01506000
*              IF RETNCODE = 12       /* CHK FOR GETMAIN FAILURE     */ 01507000
*                THEN                                              0540 01508000
@RF00535 CH    RETNCODE,@CH00130                                   0540 01509000
         BNE   @RF00540                                            0540 01510000
*                  RETURN TO  NOSPAZ; /* GO TO ISSUE MESSAGE         */ 01511000
         LA    @14,NOSPAZ                                          0541 01512000
         LM    @15,@03,@SA00006+4                                  0541 01513000
         LM    @05,@12,@SA00006+24                                 0541 01514000
         BR    @14                                                 0541 01515000
*              IF RETNCODE = 20       /* CHK FOR ERROR CODE          */ 01516000
*                THEN                 /* YES,                        */ 01517000
@RF00540 CH    RETNCODE,@CH00355                                   0542 01518000
         BNE   @RF00542                                            0542 01519000
*                  DO;                /* IKJEFA51 ISSUED MESSAGE     */ 01520000
*                  DELERR = '1'B;     /* SET NO SUCCESS MESSAGE FLAG */ 01521000
         OI    DELERR,B'00100000'                                  0544 01522000
*                  RETURN TO  DOCLOS; /* GO TO EXIT                  */ 01523000
         LA    @14,DOCLOS                                          0545 01524000
         LM    @15,@03,@SA00006+4                                  0545 01525000
         LM    @05,@12,@SA00006+24                                 0545 01526000
         BR    @14                                                 0545 01527000
*                  END;                                            0546 01528000
*              IF RETNCODE = 24       /* CHK FOR EOF CODE            */ 01529000
*                THEN                 /* YES,                        */ 01530000
@RF00542 CH    RETNCODE,@CH00124                                   0547 01531000
         BNE   @RF00547                                            0547 01532000
*                  RETURN TO DELCHK;  /* FINISHED, GO TO EXIT        */ 01533000
         LA    @14,DELCHK                                          0548 01534000
         LM    @15,@03,@SA00006+4                                  0548 01535000
         LM    @05,@12,@SA00006+24                                 0548 01536000
         BR    @14                                                 0548 01537000
*              /* ISSUE READ ERROR MESSAGE                       */     01538000
*              MSGNO = 24;            /* SET MESSAGE INDEX           */ 01539000
@RF00547 MVC   MSGNO(2),@CH00124                                   0549 01540000
*              RETURN TO  SYSERRD;    /* GO TO ISSUE MESSAGE         */ 01541000
         LA    @14,SYSERRD                                         0550 01542000
         LM    @15,@03,@SA00006+4                                  0550 01543000
         LM    @05,@12,@SA00006+24                                 0550 01544000
         BR    @14                                                 0550 01545000
*              END;                                                0551 01546000
*          IF ACIOFL06 = '1'B         /* DIRECTORY READ?             */ 01547000
*            THEN                     /* YES,                        */ 01548000
@RF00523 TM    ACIOFL06,B'00000100'                                0552 01549000
         BO    @RT00552                                            0552 01550000
*              RETURN;                                             0553 01551000
*          RDDONE = '1'B;             /* SET READ DONE FLAG          */ 01552000
         OI    RDDONE,B'00000010'                                  0554 01553000
*          END DOREAD;                                             0555 01554000
@EL00006 DS    0H                                                  0555 01555000
@EF00006 DS    0H                                                  0555 01556000
@ER00006 LM    @14,@03,@SA00006                                    0555 01557000
         LM    @05,@12,@SA00006+24                                 0555 01558000
         BR    @14                                                 0555 01559000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01560000
* /*                                                                 */ 01561000
* /*  D O W R I T E:                                                 */ 01562000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 01563000
*DOWRITE:   /* EP TO WRITE NEW MEMBER                                */ 01564000
*          PROC ;                                                  0556 01565000
DOWRITE  STM   @14,@03,@SA00007                                    0556 01566000
         STM   @05,@12,@SA00007+24                                 0556 01567000
*          RFY R1 RSTD;               /* RESTRICT REG 1              */ 01568000
*          R1  =  ADDR(ACIOPARM);     /* SET PTR TO WRITE  P B       */ 01569000
         LA    R1,ACIOPARM                                         0558 01570000
*          CALL  IKJEFA52;            /* GO TO WRITE ROUTINE         */ 01571000
         L     @15,@CV00072                                        0559 01572000
         BALR  @14,@15                                             0559 01573000
*          RFY R1 UNRSTD;             /* RELEASE REG 1               */ 01574000
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */ 01575000
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */ 01576000
         LR    RETNCODE,R15                                        0562 01577000
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */ 01578000
*          IF RETNCODE ^= 0           /* CHK FOR ERROR               */ 01579000
*            THEN                     /* YES,                        */ 01580000
         LTR   RETNCODE,RETNCODE                                   0564 01581000
         BZ    @RF00564                                            0564 01582000
*              DO;                                                 0565 01583000
*              /* WRITE UNSUCCESSFUL, WAS ERROR MESSAGE ISSUED?      */ 01584000
*              IF RETNCODE = 20       /* MESSAGE WAS ISSUED          */ 01585000
*                THEN                                              0566 01586000
         CH    RETNCODE,@CH00355                                   0566 01587000
         BNE   @RF00566                                            0566 01588000
*                  RETURN TO  DOCLOS; /* GO TO EXIT                  */ 01589000
         LA    @14,DOCLOS                                          0567 01590000
         LM    @15,@03,@SA00007+4                                  0567 01591000
         LM    @05,@12,@SA00007+24                                 0567 01592000
         BR    @14                                                 0567 01593000
*              MSGNO = 26;            /* SET MESSAGE INDEX           */ 01594000
@RF00566 MVC   MSGNO(2),@CH00382                                   0568 01595000
*              RETURN TO  SYSERRD;    /* GO TO ISSUE MESSAGE         */ 01596000
         LA    @14,SYSERRD                                         0569 01597000
         LM    @15,@03,@SA00007+4                                  0569 01598000
         LM    @05,@12,@SA00007+24                                 0569 01599000
         BR    @14                                                 0569 01600000
*              END;                                                0570 01601000
*          IF ACIOFL05 = '1'B         /* CHK FOR WRITE FLAG          */ 01602000
*            THEN                     /* YES,                        */ 01603000
@RF00564 TM    ACIOFL05,B'00001000'                                0571 01604000
         BNO   @RF00571                                            0571 01605000
*              WRTDON = '1'B;         /* SET WORK DONE FLAG          */ 01606000
         OI    WRTDON,B'00000001'                                  0572 01607000
*          RDDONE = '0'B;             /* CLEAR READ OK FLAG          */ 01608000
@RF00571 NI    RDDONE,B'11111101'                                  0573 01609000
*          GEN (DEQ   (,USRLEN,0),MF=(E,DQLST))                    0574 01610000
*            REFS(DQLST,EQNAM1,USRLEN); /* DEQ SYSUADS-MEMBERNAME    */ 01611000
         DEQ   (,USRLEN,0),MF=(E,DQLST)                                 01612000
*          END DOWRITE;                                            0575 01613000
@EL00007 DS    0H                                                  0575 01614000
@EF00007 DS    0H                                                  0575 01615000
@ER00007 LM    @14,@03,@SA00007                                    0575 01616000
         LM    @05,@12,@SA00007+24                                 0575 01617000
         BR    @14                                                 0575 01618000
*NLSTEXIT: /**********************************************************/ 01619000
*          /* NLSTEXIT: CONTROL PASSED HERE FROM IKJEFA55 TO ALLOW   */ 01620000
*          /* MODIFICATION OF THE PARSE PCL DEPENDING ON THE NUMBER  */ 01621000
*          /* OF ITEMS IN THE NODELIST                               */ 01622000
*          /**********************************************************/ 01623000
*          PROC OPTIONS(NOSAVEAREA);                               0576 01624000
NLSTEXIT STM   @14,@12,12(@13)                                     0576 01625000
*          /* FIX UP ADDRESSABILITY                                  */ 01626000
*         RFY (R1,R2) RSTD;                                        0577 01627000
*         R2 = R1;                    /* GET SAVE AREA PTR           */ 01628000
         LR    R2,R1                                               0578 01629000
*         GEN (LM  R2,R12,28(R2));    /* RESTORE REGISTERS           */ 01630000
         LM  R2,R12,28(R2)                                              01631000
*         SAVE13 = R13;               /* SAVE IKJEFA55 SAVEAREA PTR  */ 01632000
         LR    SAVE13,R13                                          0580 01633000
*         R13 = R1;                   /* SET SAVE AREA PTR           */ 01634000
         LR    R13,R1                                              0581 01635000
*         RFY (R1,R2) UNRSTD;                                      0582 01636000
*         SUBFPTR = PCLPTR+DATSUBFO;  /* POINT TO DATA SUBFIELD OFF. */ 01637000
         L     @10,PCLPTR                                          0583 01638000
         LH    SUBFPTR,DATSUBFO                                    0583 01639000
         ALR   SUBFPTR,@10                                         0583 01640000
*         DATAPTR = PCLPTR+DATAOF;    /* POINT TO DATA KEYWORD PCE   */ 01641000
         AH    @10,DATAOF                                          0584 01642000
         LR    DATAPTR,@10                                         0584 01643000
*         IF NUMOFLV = 1              /* IS THE DELETE LEVEL USERID? */ 01644000
*           THEN                      /* YES,                        */ 01645000
         CLI   NUMOFLV,1                                           0585 01646000
         BNE   @RF00585                                            0585 01647000
*             DO;                                                  0586 01648000
*             SUBFOF = PASUBOF;       /* SET SUBFIELD OFFSET TO    0587 01649000
*                                        PASSWORD IKJSUBF & IKJIDENT */ 01650000
         LH    @10,PASUBOF                                         0587 01651000
         STH   @10,SUBFOF(,SUBFPTR)                                0587 01652000
*             IF USRID(1) ^= '*'      /* IS THE USERID AN ASTERISK?  */ 01653000
*               THEN                  /* NO,                         */ 01654000
         CLI   USRID,C'*'                                          0588 01655000
         BE    @RF00588                                            0588 01656000
*                 DATAFLG(5) = '0'B;  /* TURN OFF DEFAULT BIT FOR THE   01657000
*                                        'DATA' KEYWORD - THIS MAKES    01658000
*                                        THE KEYWORD OPTIONAL        */ 01659000
         NI    DATAFLG(DATAPTR),B'11110111'                        0589 01660000
*             GOTO CLEANUP;           /* GO CLEAN UP AND EXIT        */ 01661000
         B     CLEANUP                                             0590 01662000
*             END;                                                 0591 01663000
*         IF NUMOFLV = 2              /* IS THE DELETE LEVEL PASSWD? */ 01664000
*           THEN                      /* YES,                        */ 01665000
@RF00585 CLI   NUMOFLV,2                                           0592 01666000
         BNE   @RF00592                                            0592 01667000
*             DO;                                                  0593 01668000
*             SUBFOF = ACSUBOF;       /* SET SUBFIELD OFFSET TO    0594 01669000
*                                        ACCTNMBR IKJSUBF & IKJIDENT */ 01670000
         LH    @10,ACSUBOF                                         0594 01671000
         STH   @10,SUBFOF(,SUBFPTR)                                0594 01672000
*             IF PASSWD(1) ^= '*'     /* IS THE PASSWORD AN ASTERISK?*/ 01673000
*               THEN                  /* NO,                         */ 01674000
         CLI   PASSWD,C'*'                                         0595 01675000
         BE    @RF00595                                            0595 01676000
*                 DATAFLG(5) = '0'B;  /* MAKE THE 'DATA' KEYWORD   0596 01677000
*                                        OPTIONAL                    */ 01678000
         NI    DATAFLG(DATAPTR),B'11110111'                        0596 01679000
*             GOTO CLEANUP;           /* GO CLEAN UP AND EXIT        */ 01680000
         B     CLEANUP                                             0597 01681000
*             END;                                                 0598 01682000
*         IF NUMOFLV = 3              /* IS THE DELETE LEVEL ACCTNM? */ 01683000
*           THEN                      /* YES,                        */ 01684000
@RF00592 CLI   NUMOFLV,3                                           0599 01685000
         BNE   @RF00599                                            0599 01686000
*             DO;                                                  0600 01687000
*             IF ACCTNO(1:2) ^= '* '  /* IS THE ACCTNMBR AN ASTERISK?*/ 01688000
*               THEN                  /* NO,                         */ 01689000
         CLC   ACCTNO(2),@CC00361                                  0601 01690000
         BE    @RF00601                                            0601 01691000
*                 DATAFLG(5) = '0'B;  /* MAKE THE 'DATA' KEYWORD   0602 01692000
*                                        OPTIONAL                    */ 01693000
         NI    DATAFLG(DATAPTR),B'11110111'                        0602 01694000
*             GOTO CLEANUP;           /* GO CLEAN UP AND EXIT        */ 01695000
         B     CLEANUP                                             0603 01696000
*             END;                                                 0604 01697000
*CLEANUP: /* THE PARSE PCL HAS BEEN MODIFIED TO MATCH THE NODELIST   */ 01698000
*         PCEPTR = PCLPTR+SUBFOF;     /* POINT TO ACTIVE PCE         */ 01699000
@RF00599 DS    0H                                                  0605 01700000
CLEANUP  LH    PCEPTR,SUBFOF(,SUBFPTR)                             0605 01701000
         AL    PCEPTR,PCLPTR                                       0605 01702000
*         PCELNG = PCLLNGTH-1;        /* POINT TO END OF PCL TO TELL    01703000
*                                        PARSE THIS IS THE ONLY PCE  */ 01704000
         L     @10,PCLMDLAD                                        0606 01705000
         LH    @10,PCLLNGTH(,@10)                                  0606 01706000
         BCTR  @10,0                                               0606 01707000
         STH   @10,PCELNG(,PCEPTR)                                 0606 01708000
*         R13 = SAVE13;               /* ADDR OF CALLER'S SAVE AREA  */ 01709000
         LR    R13,SAVE13                                          0607 01710000
*         RETURN CODE(0);                                          0608 01711000
         SLR   @15,@15                                             0608 01712000
         L     @14,12(,@13)                                        0608 01713000
         LM    @00,@12,20(@13)                                     0608 01714000
         BR    @14                                                 0608 01715000
*         END NLSTEXIT;                                            0609 01716000
*         END IKJEFA30                                             0610 01717000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01718000
*/*%INCLUDE SYSLIB  (IKJEFUDL)                                        * 01719000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        * 01720000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 01721000
*/*%INCLUDE SYSLIB  (IKJPTPB )                                        * 01722000
*;                                                                 0610 01723000
@DATA    DS    0H                                                       01724000
@CH00032 DC    H'1'                                                     01725000
@CH00037 DC    H'2'                                                     01726000
@CH00211 DC    H'3'                                                     01727000
@CH00066 DC    H'4'                                                     01728000
@CH00183 DC    H'5'                                                     01729000
@CH00389 DC    H'6'                                                     01730000
@CH00159 DC    H'7'                                                     01731000
@CH00046 DC    H'8'                                                     01732000
@CH00405 DC    H'9'                                                     01733000
@CH00379 DC    H'10'                                                    01734000
@CH00380 DC    H'11'                                                    01735000
@CH00130 DC    H'12'                                                    01736000
@CH00042 DC    H'13'                                                    01737000
@CH00403 DC    H'14'                                                    01738000
@CH00109 DC    H'15'                                                    01739000
@CH00044 DC    H'16'                                                    01740000
@CH00406 DC    H'17'                                                    01741000
@CH00376 DC    H'18'                                                    01742000
@CH00355 DC    H'20'                                                    01743000
@CH00387 DC    H'22'                                                    01744000
@CH00124 DC    H'24'                                                    01745000
@CH00378 DC    H'25'                                                    01746000
@CH00382 DC    H'26'                                                    01747000
@CH00409 DC    H'27'                                                    01748000
@CH00391 DC    H'35'                                                    01749000
@CH00388 DC    H'37'                                                    01750000
@SM00437 MVC   CPLS(0),MCPLS                                            01751000
@SM00445 MVC   TMSGTIN1(0),USRID                                        01752000
@SM00448 MVC   TMSGTIN1(0),NAMPTRC(@01)                                 01753000
@SM00450 MVC   TMSGTIN1(0),MEMNAME(@10)                                 01754000
@SM00453 MVC   UIDUSER(0,@10),USRID                                     01755000
@SM00455 MVC   AMSGHDR1(0),PTRMASK1(MSGPTR)                             01756000
@SM00457 MVC   AMSGHDR2(0),PTRMASK2(@15)                                01757000
@DATD    DSECT                                                          01758000
         DS    0F                                                       01759000
@SA00001 DS    18F                                                      01760000
@SA00007 DS    14F                                                      01761000
@SA00006 DS    14F                                                      01762000
@SA00002 DS    14F                                                      01763000
@SA00005 DS    14F                                                      01764000
IKJEFA30 CSECT                                                          01765000
         DS    0F                                                       01766000
@CF00399 DC    XL4'40FFFFFF'                                            01767000
@DATD    DSECT                                                          01768000
         DS    0D                                                       01769000
GOTMNP   DS    A                                                        01770000
DELPDLAD DS    A                                                        01771000
LEVLP    DS    A                                                        01772000
VCHKPL   DS    CL26                                                     01773000
         ORG   VCHKPL                                                   01774000
EXITADD  DS    AL4                                                      01775000
EXITRTCD DS    AL4                                                      01776000
NODEPTR  DS    AL4                                                      01777000
@NM00005 DS    AL4                                                      01778000
PPLPTR   DS    AL4                                                      01779000
SAVARAD  DS    AL4                                                      01780000
CMDIND   DS    FL1                                                      01781000
NUMOFLV  DS    FL1                                                      01782000
         ORG   VCHKPL+26                                                01783000
NLSTTAB  DS    CL66                                                     01784000
         ORG   NLSTTAB                                                  01785000
USRLEN   DS    FL1                                                      01786000
USRID    DS    CL8                                                      01787000
PASSWD   DS    CL8                                                      01788000
ACTLEN   DS    FL1                                                      01789000
ACCTNO   DS    CL40                                                     01790000
@NM00006 DS    CL8                                                      01791000
         ORG   NLSTTAB+66                                               01792000
COMAREA  DS    CL11                                                     01793000
         ORG   COMAREA                                                  01794000
DPLPTR   DS    AL4                                                      01795000
ACIOPTR  DS    AL4                                                      01796000
MSGNO    DS    AL2                                                      01797000
DELUSER  DS    BL1                                                      01798000
GPWDSP   EQU   COMAREA+10                                               01799000
GACNSP   EQU   COMAREA+10                                               01800000
         ORG   COMAREA+11                                               01801000
         DS    CL1                                                      01802000
DPL      DS    CL121                                                    01803000
         ORG   DPL                                                      01804000
DADP     DS    AL4                                                      01805000
DCDP     DS    AL4                                                      01806000
DUSRID1  DS    AL4                                                      01807000
DUSRIDN  DS    AL4                                                      01808000
@NM00007 DS    AL4                                                      01809000
@NM00008 DS    AL4                                                      01810000
@NM00009 DS    AL4                                                      01811000
@NM00010 DS    CL1                                                      01812000
         ORG   @NM00010                                                 01813000
DUCLSF1  DS    BL1                                                      01814000
         ORG   DPL+29                                                   01815000
@NM00011 DS    AL3                                                      01816000
DUSRDTN  DS    AL2                                                      01817000
DUSRDCN  DS    AL2                                                      01818000
DPASWD1  DS    AL4                                                      01819000
DPASWDN  DS    AL4                                                      01820000
@NM00012 DS    CL12                                                     01821000
@NM00013 DS    CL1                                                      01822000
         ORG   @NM00013                                                 01823000
DPCLSF1  DS    BL1                                                      01824000
         ORG   DPL+57                                                   01825000
@NM00014 DS    AL3                                                      01826000
DPSWDTN  DS    AL2                                                      01827000
DPSWDCN  DS    AL2                                                      01828000
DACCTN1  DS    AL4                                                      01829000
DACCTNN  DS    AL4                                                      01830000
@NM00015 DS    CL12                                                     01831000
@NM00016 DS    CL1                                                      01832000
         ORG   @NM00016                                                 01833000
DACLSF1  DS    BL1                                                      01834000
         ORG   DPL+85                                                   01835000
@NM00017 DS    AL3                                                      01836000
DACCTTN  DS    AL2                                                      01837000
DACCTCN  DS    AL2                                                      01838000
DROCNM1  DS    AL4                                                      01839000
@NM00018 DS    AL4                                                      01840000
@NM00019 DS    CL12                                                     01841000
@NM00020 DS    CL1                                                      01842000
@NM00021 DS    AL3                                                      01843000
@NM00022 DS    AL2                                                      01844000
@NM00023 DS    AL2                                                      01845000
@NM00024 DS    BL1                                                      01846000
         ORG   DPL+121                                                  01847000
         DS    CL3                                                      01848000
ACIOPARM DS    CL24                                                     01849000
         ORG   ACIOPARM                                                 01850000
@NM00046 DS    BL1                                                      01851000
ACIOFL03 EQU   ACIOPARM+0                                               01852000
@NM00047 EQU   ACIOPARM+0                                               01853000
ACIOFL05 EQU   ACIOPARM+0                                               01854000
ACIOFL06 EQU   ACIOPARM+0                                               01855000
@NM00048 EQU   ACIOPARM+0                                               01856000
ACIODCBA DS    AL3                                                      01857000
ACIOMPTR DS    AL4                                                      01858000
ACIODRCT DS    AL4                                                      01859000
ACIOLINK DS    AL4                                                      01860000
@NM00049 DS    AL1                                                      01861000
@NM00050 DS    AL3                                                      01862000
ACIOPUTL DS    AL4                                                      01863000
         ORG   ACIOPUTL                                                 01864000
MSGID    DS    CL1                                                      01865000
         ORG   ACIOPARM+24                                              01866000
NEXTNAME DS    CL8                                                      01867000
DIRWA    DS    CL344                                                    01868000
         ORG   DIRWA                                                    01869000
DIRDCB   DS    CL88                                                     01870000
@NM00055 DS    CL256                                                    01871000
         ORG   @NM00055                                                 01872000
@NM00056 DS    CL2                                                      01873000
DIRBNAM1 DS    CL8                                                      01874000
         ORG   DIRWA+344                                                01875000
STOLST   DS    CL8                                                      01876000
DELECF   DS    CL1                                                      01877000
         ORG   DELECF                                                   01878000
ACNNTR   DS    BL1                                                      01879000
DATLIN   EQU   DELECF+0                                                 01880000
DELERR   EQU   DELECF+0                                                 01881000
ENQFLG   EQU   DELECF+0                                                 01882000
PLFAIL   EQU   DELECF+0                                                 01883000
PWDNTR   EQU   DELECF+0                                                 01884000
RDDONE   EQU   DELECF+0                                                 01885000
WRTDON   EQU   DELECF+0                                                 01886000
         ORG   DELECF+1                                                 01887000
         DS    CL7                                                      01888000
DBLWORD  DS    CL8                                                      01889000
PLOUT    DS    CL16                                                     01890000
AMSGHDR1 DS    CL32                                                     01891000
         ORG   AMSGHDR1                                                 01892000
LEVPTR1  DS    AL4                                                      01893000
@NM00060 DS    2A                                                       01894000
SEGPTR12 DS    AL4                                                      01895000
SEGPTR13 DS    AL4                                                      01896000
@NM00061 DS    3A                                                       01897000
         ORG   AMSGHDR1+32                                              01898000
AMSGHDR2 DS    CL32                                                     01899000
         ORG   AMSGHDR2                                                 01900000
@NM00062 DS    AL4                                                      01901000
@NM00063 DS    3A                                                       01902000
SEGPTR23 DS    AL4                                                      01903000
@NM00064 DS    3A                                                       01904000
         ORG   AMSGHDR2+32                                              01905000
TMSGTIX1 DS    CL12                                                     01906000
         ORG   TMSGTIX1                                                 01907000
TMSGTIL1 DS    AL2                                                      01908000
TMSGTIO1 DS    AL2                                                      01909000
TMSGTIN1 DS    CL8                                                      01910000
         ORG   TMSGTIX1+12                                              01911000
PARSLIST DS    CL28                                                     01912000
@NM00065 DS    CL8                                                      01913000
         ORG   @NM00065                                                 01914000
PCLPTR   DS    AL4                                                      01915000
PLENGTH  DS    AL4                                                      01916000
         ORG   @NM00065+8                                               01917000
NDLSTPDE DS    CL36                                                     01918000
         ORG   NDLSTPDE                                                 01919000
UPDE     DS    AL4                                                      01920000
ULEN     DS    FL2                                                      01921000
@NM00066 DS    BL2                                                      01922000
@NM00067 DS    AL4                                                      01923000
PPDE     DS    AL4                                                      01924000
PLEN     DS    FL2                                                      01925000
@NM00068 DS    BL2                                                      01926000
@NM00069 DS    AL4                                                      01927000
APDE     DS    AL4                                                      01928000
ALEN     DS    FL2                                                      01929000
@NM00070 DS    BL2                                                      01930000
@NM00071 DS    AL4                                                      01931000
         ORG   NDLSTPDE+36                                              01932000
IKJEFA30 CSECT                                                          01933000
         DS    0F                                                       01934000
@SIZDATD DC    AL1(1)                                                   01935000
         DC    AL3(@ENDDATD-@DATD)                                      01936000
@CV00069 DC    V(ANDXL)                                                 01937000
@CV00070 DC    V(IKJEFA32)                                              01938000
@CV00071 DC    V(IKJEFA51)                                              01939000
@CV00072 DC    V(IKJEFA52)                                              01940000
@CV00073 DC    V(IKJEFA55)                                              01941000
         DS    0D                                                       01942000
LSPAN    DC    AL4(DPASWD1-DUSRID1)                                     01943000
PCLMDLAD DC    AL4(PCLMODEL)                                            01944000
DATAOF   DC    AL2(DATAPCE-PCLSTART)                                    01945000
ACSUBOF  DC    AL2(ACCTPCE-PCLSTART+1)                                  01946000
PASUBOF  DC    AL2(PASSPCE-PCLSTART+1)                                  01947000
DATSUBFO DC    AL2(SUBFPCES-PCLSTART-2)                                 01948000
@CC00361 DC    C'* '                                                    01949000
EQNAM1   DC    CL8'SYSIKJUA'                                            01950000
ERNAM1   DC    CL8'OPENUADS'                                            01951000
@DATD    DSECT                                                          01952000
IKJEFA30 CSECT                                                          01953000
         EXTRN ACCTEXTR                 ADDR OF PARSE VALIDCK EXIT      01954000
         EXTRN IKJEFA55                 ADDR OF PARSE VALIDCK EXIT      01955000
         EXTRN PASSEXTR                 ADDR OF PARSE VALIDCK EXIT      01956000
         EXTRN PROCEXTR                 ADDR OF PARSE VALIDCK EXIT      01957000
PCLMODEL CSECT                                                          01958000
PCLSTART EQU   *                                                        01959000
PCLMODEL IKJPARM  DSECT=DELPDLD                                         01960000
NODEPDE  IKJPOSIT PSTRING,PROMPT='(NODELIST)',VALIDCK=IKJEFA55,        *01961000
               HELP=('NODELIST - FORMAT IS (USERID / PASSWORD / ACCOUNT*01962000
                NUMBER)')                                               01963000
DATAPCE  EQU      *                                                     01964000
DATAPDE  IKJKEYWD DEFAULT='DATA'                                        01965000
         IKJNAME  'DATA',SUBFLD=PROCSUB                                 01966000
SUBFPCES EQU   *                                                        01967000
PROCSUB  IKJSUBF                                                        01968000
PROCD    IKJIDENT 'DATALIST-PROCEDURE NAME',LIST,MAXLNTH=8,            *01969000
               FIRST=ANY,OTHER=ALPHANUM,VALIDCK=PROCEXTR,              *01970000
               PROMPT='DATALIST- PROCEDURE NAME'                        01971000
ACCTPCE  EQU   *                                                        01972000
ACCTSUB  IKJSUBF                                                        01973000
ACCTD    IKJIDENT 'DATALIST-ACCOUNT NUMBER',LIST,MAXLNTH=40,FIRST=ANY, *01974000
               OTHER=ANY,VALIDCK=ACCTEXTR,PROMPT='DATALIST-ACCOUNT NUMB*01975000
               ER'                                                      01976000
PASSPCE  EQU      *                                                     01977000
PASSSUB  IKJSUBF                                                        01978000
PASSD    IKJIDENT 'DATALIST-PASSWORD',LIST,MAXLNTH=8,FIRST=ANY,        *01979000
               OTHER=ALPHANUM,VALIDCK=PASSEXTR,PROMPT='DATALIST-PASSWOR*01980000
               D'                                                       01981000
         IKJENDP                                                        01982000
@DATD    DSECT                                                          01983000
IKJEFA30 CSECT                                                          01984000
MCPLS    DS    0F                                                       01985000
         CLOSE (,REREAD),MF=L         FOR CLOSE                         01986000
         DCB   DSORG=PO,DDNAME=SYSUADS,MACRF=(R,W),RECFM=FB,NCP=10      01987000
         DEQ   (EQNAM1,ERNAM1,8,SYSTEM),RET=HAVE,MF=L    FOR DEQ        01988000
         ENQ   (EQNAM1,,E,0,SYSTEM),RET=USE,MF=L         FOR USER ENQ   01989000
         ENQ   (EQNAM1,ERNAM1,E,8,SYSTEM),RET=HAVE,MF=L  FOR OPEN ENQ   01990000
         FREEMAIN V,SP=1,MF=L         FOR FREEMAIN                      01991000
         GETMAIN  EC,LV=16,SP=1,MF=L                                    01992000
         GETMAIN  VC,SP=1,MF=L        FOR GETMAIN                       01993000
         OPEN  (,),MF=L               FOR OPEN                          01994000
         PUTLINE  OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L   FOR PUTLINE      01995000
MCPLLNG  DC    A(*-MCPLS)             LENGTH OF MODEL PARAMETER BLOCKS  01996000
MDIRDCB  DCB   DDNAME=SYSUADS,DSORG=PS,MACRF=(R),RECFM=F,BLKSIZE=256    01997000
         DCBD  DSORG=PO               MASK FOR UADS DCB                 01998000
@DATD    DSECT                        RE-ESTABLISH AUTOMATIC DSECT      01999000
CPLS     DS    0F                                                       02000000
DLCLSL   CLOSE (,),MF=L               FOR CLOSE                         02001000
DELDCB   DCB   DSORG=PO,DDNAME=SYSUADS,MACRF=(R,W),RECFM=FB,NCP=10      02002000
DQLST    DEQ   (,,,),MF=L             FOR DEQUEUE                       02003000
NQMBR    ENQ   (,,,,),MF=L            FOR USER ENQUEUE                  02004000
NQOPN    ENQ   (,,,,),MF=L            FOR OPEN ENQUEUE                  02005000
FMLST    FREEMAIN V,MF=L              FOR FREEMAIN                      02006000
BLDUDL   GETMAIN  EC,LV=16,MF=L                                         02007000
GMLST    GETMAIN  VC,MF=L             FOR GETMAIN                       02008000
DLOPNL   OPEN  (,),MF=L               FOR OPEN                          02009000
PTPBK    PUTLINE  ,MF=L               FOR PUTLINE                       02010000
IKJEFA30 CSECT                                                          02011000
         DS   0H                                                        02012000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   02013000
@DATD    DSECT                                                          02014000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02015000
@ENDDATD EQU   *                                                        02016000
IKJEFA30 CSECT                                                          02017000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02018000
@01      EQU   01                                                       02019000
@02      EQU   02                                                       02020000
@03      EQU   03                                                       02021000
@04      EQU   04                                                       02022000
@05      EQU   05                                                       02023000
@06      EQU   06                                                       02024000
@07      EQU   07                                                       02025000
@08      EQU   08                                                       02026000
@09      EQU   09                                                       02027000
@10      EQU   10                                                       02028000
@11      EQU   11                                                       02029000
@12      EQU   12                                                       02030000
@13      EQU   13                                                       02031000
@14      EQU   14                                                       02032000
@15      EQU   15                                                       02033000
SUBFPTR  EQU   @04                                                      02034000
DATAPTR  EQU   @03                                                      02035000
PCEPTR   EQU   @02                                                      02036000
SAVE13   EQU   @06                                                      02037000
MINDX    EQU   @03                                                      02038000
MSGPTR   EQU   @02                                                      02039000
MSGFIND  EQU   @03                                                      02040000
RETNCODE EQU   @04                                                      02041000
TSTCTN   EQU   @05                                                      02042000
NAMCTR   EQU   @04                                                      02043000
UIDLCHP  EQU   @02                                                      02044000
DIRBDAP  EQU   @02                                                      02045000
PDEPTR   EQU   @02                                                      02046000
DNMIDP   EQU   @03                                                      02047000
ACCTPLP  EQU   @06                                                      02048000
IOPLPTR  EQU   @07                                                      02049000
R0       EQU   @00                                                      02050000
R1       EQU   @01                                                      02051000
R2       EQU   @02                                                      02052000
R13      EQU   @13                                                      02053000
R14      EQU   @14                                                      02054000
R15      EQU   @15                                                      02055000
R12      EQU   @12                                                      02056000
DUIDL    EQU   0                                                        02057000
UIDLNEX  EQU   DUIDL                                                    02058000
UIDLSWS  EQU   DUIDL+4                                                  02059000
UIDDEL   EQU   UIDLSWS                                                  02060000
UIDLCT   EQU   DUIDL+6                                                  02061000
UIDUSER  EQU   DUIDL+8                                                  02062000
IOPL     EQU   0                                                        02063000
IOPLIOPB EQU   IOPL+12                                                  02064000
PPL      EQU   0                                                        02065000
PPLPCL   EQU   PPL+12                                                   02066000
PPLANS   EQU   PPL+16                                                   02067000
PPLCBUF  EQU   PPL+20                                                   02068000
PPLUWA   EQU   PPL+24                                                   02069000
PTPB     EQU   0                                                        02070000
PTPBOPUT EQU   PTPB+4                                                   02071000
ACCTPL   EQU   0                                                        02072000
ACCTECBP EQU   ACCTPL+8                                                 02073000
CMDBUFAD EQU   ACCTPL+12                                                02074000
UIDLPTR  EQU   ACCTPL+16                                                02075000
ACCTECB  EQU   0                                                        02076000
ATTENTN  EQU   ACCTECB                                                  02077000
@NM00025 EQU   0                                                        02078000
NAMID1   EQU   @NM00025                                                 02079000
NAMIDN1  EQU   @NM00025+4                                               02080000
@NM00026 EQU   @NM00025+8                                               02081000
NMFLG11  EQU   @NM00026                                                 02082000
@NM00033 EQU   @NM00025+24                                              02083000
NMDTN1   EQU   @NM00033                                                 02084000
NMDCN1   EQU   @NM00033+2                                               02085000
NAMPDE   EQU   0                                                        02086000
NAMPTR1  EQU   NAMPDE                                                   02087000
NAMLNG   EQU   NAMPDE+4                                                 02088000
NAMFLGF  EQU   NAMPDE+6                                                 02089000
NAMFLGD  EQU   NAMPDE+6                                                 02090000
NPTRNEX  EQU   NAMPDE+9                                                 02091000
NAMPTRC  EQU   0                                                        02092000
NEXTUSER EQU   0                                                        02093000
@NM00051 EQU   0                                                        02094000
DIRBNAM  EQU   @NM00051                                                 02095000
DIRBC    EQU   @NM00051+11                                              02096000
@NM00053 EQU   0                                                        02097000
MEMNAME  EQU   @NM00053+4                                               02098000
GOTMSPZ  EQU   0                                                        02099000
@NM00057 EQU   0                                                        02100000
RCLC1    EQU   @NM00057+3                                               02101000
MOFFSET  EQU   0                                                        02102000
PTRMASK1 EQU   0                                                        02103000
NXTLADR1 EQU   PTRMASK1                                                 02104000
SGNO1    EQU   PTRMASK1+4                                               02105000
PTRMASK2 EQU   0                                                        02106000
SGNO2    EQU   PTRMASK2+4                                               02107000
PCLLNGTH EQU   0                                                        02108000
PCELNG   EQU   0                                                        02109000
DATAFLG  EQU   0                                                        02110000
SUBFOF   EQU   0                                                        02111000
@NM00072 EQU   0                                                        02112000
DATAKEY  EQU   @NM00072+16                                              02113000
PROCPDE  EQU   @NM00072+20                                              02114000
ACCTPDE  EQU   @NM00072+32                                              02115000
PASSPDE  EQU   @NM00072+44                                              02116000
DCBOFLG  EQU   DCBOFLGS                                                 02117000
PTPBPTR  EQU   IOPLIOPB                                                 02118000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02119000
@NM00085 EQU   DCBOFLGS                                                 02120000
@NM00084 EQU   @NM00072+52                                              02121000
@NM00083 EQU   @NM00072+50                                              02122000
@NM00082 EQU   @NM00072+48                                              02123000
@NM00081 EQU   @NM00072+40                                              02124000
@NM00080 EQU   @NM00072+38                                              02125000
@NM00079 EQU   @NM00072+36                                              02126000
@NM00078 EQU   @NM00072+28                                              02127000
@NM00077 EQU   @NM00072+26                                              02128000
@NM00076 EQU   @NM00072+24                                              02129000
@NM00075 EQU   @NM00072+18                                              02130000
@NM00074 EQU   @NM00072+8                                               02131000
@NM00073 EQU   @NM00072                                                 02132000
@NM00059 EQU   PTRMASK2                                                 02133000
@NM00058 EQU   @NM00057                                                 02134000
@NM00054 EQU   @NM00053                                                 02135000
@NM00052 EQU   @NM00051+8                                               02136000
@NM00045 EQU   NAMPDE+8                                                 02137000
@NM00044 EQU   NAMPDE+7                                                 02138000
@NM00043 EQU   NAMPDE+6                                                 02139000
@NM00042 EQU   NAMPDE+6                                                 02140000
@NM00041 EQU   @NM00025+54                                              02141000
@NM00040 EQU   @NM00025+52                                              02142000
@NM00039 EQU   @NM00025+49                                              02143000
@NM00038 EQU   @NM00025+48                                              02144000
@NM00037 EQU   @NM00025+48                                              02145000
@NM00036 EQU   @NM00025+36                                              02146000
@NM00035 EQU   @NM00025+32                                              02147000
@NM00034 EQU   @NM00025+28                                              02148000
@NM00032 EQU   @NM00025+21                                              02149000
@NM00031 EQU   @NM00025+20                                              02150000
@NM00030 EQU   @NM00026+8                                               02151000
@NM00029 EQU   @NM00026+4                                               02152000
@NM00028 EQU   @NM00026+1                                               02153000
@NM00027 EQU   @NM00026                                                 02154000
@NM00004 EQU   ACCTECB                                                  02155000
@NM00003 EQU   ACCTPL                                                   02156000
PTPBFLN  EQU   PTPB+8                                                   02157000
@NM00002 EQU   PTPB                                                     02158000
PPLECB   EQU   PPL+8                                                    02159000
PPLECT   EQU   PPL+4                                                    02160000
PPLUPT   EQU   PPL                                                      02161000
IOPLECB  EQU   IOPL+8                                                   02162000
IOPLECT  EQU   IOPL+4                                                   02163000
IOPLUPT  EQU   IOPL                                                     02164000
@NM00001 EQU   UIDLSWS                                                  02165000
UIDCHG   EQU   UIDLSWS                                                  02166000
UIDADD   EQU   UIDLSWS                                                  02167000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02168000
@RT00069 EQU   NOSPAZ                                                   02169000
@RT00098 EQU   NOSPAZ                                                   02170000
@RT00133 EQU   DATLCHK                                                  02171000
@RT00146 EQU   DATLCHK                                                  02172000
@RT00212 EQU   DELCHK                                                   02173000
@RT00214 EQU   DOCLOS                                                   02174000
@RT00228 EQU   ENQERR                                                   02175000
@RT00252 EQU   SYSERRD                                                  02176000
@RT00254 EQU   READ                                                     02177000
@RF00256 EQU   DELCHK                                                   02178000
@RC00268 EQU   QUITCHK                                                  02179000
@RT00301 EQU   DOCLOS                                                   02180000
@RT00327 EQU   MSGNGRM                                                  02181000
@RT00409 EQU   DOBLDU                                                   02182000
@RT00416 EQU   DOBLDU                                                   02183000
@RT00433 EQU   BKSP                                                     02184000
@RF00466 EQU   @EL00003                                                 02185000
@RT00552 EQU   @EL00006                                                 02186000
@RF00588 EQU   CLEANUP                                                  02187000
@RF00595 EQU   CLEANUP                                                  02188000
@RF00601 EQU   CLEANUP                                                  02189000
@PB00008 EQU   @EL00001                                                 02190000
@PB00007 EQU   @PB00008                                                 02191000
@PB00006 EQU   @PB00007                                                 02192000
@PB00005 EQU   @PB00006                                                 02193000
@PB00004 EQU   @PB00005                                                 02194000
@PB00003 EQU   @PB00004                                                 02195000
@PB00002 EQU   @PB00003                                                 02196000
@ENDDATA EQU   *                                                        02197000
         END   IKJEFA30                                                 02198000
