         TITLE 'IKJEFATT          ATTRIB COMMAND PROCESSOR             *00001000
                        '                                               00002000
         TITLE 'IKJEFATT        ATTRIB COMMAND PROCESSOR'               00003000
IKJEFATT CSECT ,                                                   0002 00004000
@MAINENT DS    0H                                                  0002 00005000
         USING *,@15                                               0002 00006000
         B     @PROLOG                                             0002 00007000
         DC    AL1(16)                                             0002 00008000
         DC    C'IKJEFATT  77.124'                                 0002 00009000
         DROP  @15                                                      00010000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00011000
         BALR  @11,0                                               0002 00012000
@PSTART  DS    0H                                                  0002 00013000
         USING @PSTART,@11                                         0002 00014000
         L     @00,@SIZDATD                                        0002 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @12,@01                                             0002 00017000
         USING @DATD,@12                                           0002 00018000
         ST    @13,@SA00001+4                                      0002 00019000
         LM    @00,@01,20(@13)                                     0002 00020000
         ST    @12,8(,@13)                                         0002 00021000
         LR    @13,@12                                             0002 00022000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00023000
         MVC   @PC00001(4),0(@01)                                  0002 00024000
*                                      AND INPUT REGISTER            */ 00025000
*   CPPLPTR=R1;                     /* ADDRESS OF TMP INPUT SET UP 0100 00026000
*                                      SERVICE ROUTINE PARMS         */ 00027000
         ST    R1,CPPLPTR                                          0100 00028000
*   RESPECIFY                                                      0101 00029000
*    (R1) UNRSTD;                   /* FREE INPUT REGISTER           */ 00030000
*   SERVRPTR=ADDR(SERTEPRM);        /* ADDRESSIBILITY TO POINTERS    */ 00031000
         LA    @10,SERTEPRM                                        0102 00032000
         ST    @10,SERVRPTR                                        0102 00033000
*   ADUPT=CPPLUPT;                  /* PTR TO UPT                    */ 00034000
         L     @10,CPPLPTR                                         0103 00035000
         MVC   ADUPT(4),CPPLUPT(@10)                               0103 00036000
*   ADECT=CPPLECT;                  /* PTR TO ECT                    */ 00037000
         MVC   ADECT(4),CPPLECT(@10)                               0104 00038000
*   ADECB=ADDR(COMMECB);            /* PTR TO ECB                    */ 00039000
         LA    @10,COMMECB                                         0105 00040000
         ST    @10,ADECB                                           0105 00041000
*   COMMECB=0;                      /* ZERO OUT THE COMMUNICATION ECB*/ 00042000
         SLR   @10,@10                                             0106 00043000
         ST    @10,COMMECB                                         0106 00044000
*   RTRNCODE=0;                     /* INITIALIZE THE RTRNCODE       */ 00045000
         L     @06,RGSVAREA(,R13)                                  0107 00046000
         ST    @10,RTRNCODE(,@06)                                  0107 00047000
*   PARMCORE=PARMCORE&&PARMCORE;    /* ZERO OUT PARM CORE            */ 00048000
         XC    PARMCORE(153),PARMCORE                              0108 00049000
*   GTPLPTR=ADDR(PARMCORE);         /* ADDRESSIBILITY TO GENTRANS LST*/ 00050000
         LA    @10,PARMCORE                                        0109 00051000
         ST    @10,GTPLPTR                                         0109 00052000
*   GTPLABLK=ADDR(ADBKAREA);        /* SET THE ADDRESS OF ADDBLOCK TO   00053000
*                                      THE BEGINNING OF GOTTEN CORE     00054000
*                                      PLUS LENGTH OF GENTRANS LIST  */ 00055000
         LA    @06,ADBKAREA                                        0110 00056000
         ST    @06,GTPLABLK(,@10)                                  0110 00057000
*   ADDBKLN=7;                      /* NUMBER OF ADDBLOCK ADDRESSES  */ 00058000
*                                                                  0111 00059000
         MVC   ADDBKLN(2,@06),@CH00065                             0111 00060000
*   /*****************************************************************/ 00061000
*   /*                                                               */ 00062000
*   /* DIVIDE THE CORE INTO TEXT UNITS AND OBTAIN THEIR              */ 00063000
*   /* ADDRESSIBILITY                                                */ 00064000
*   /*                                                               */ 00065000
*   /*****************************************************************/ 00066000
*                                                                  0112 00067000
*   DO D=1 TO 7 BY 1;                                              0112 00068000
         LA    @10,1                                               0112 00069000
         ST    @10,D                                               0112 00070000
@DL00112 DS    0H                                                  0113 00071000
*     ADBKPTR(D)=ADDR(TEXTAREA)+((D-1)*11);                        0113 00072000
         LR    @06,@10                                             0113 00073000
         SLA   @06,2                                               0113 00074000
         L     @02,GTPLPTR                                         0113 00075000
         L     @02,GTPLABLK(,@02)                                  0113 00076000
         LA    @15,TEXTAREA                                        0113 00077000
         LR    @14,@10                                             0113 00078000
         BCTR  @14,0                                               0113 00079000
         MH    @14,@CH00034                                        0113 00080000
         ALR   @15,@14                                             0113 00081000
         ST    @15,ADBKPTR-4(@06,@02)                              0113 00082000
*   END;                                                           0114 00083000
         AH    @10,@CH00033                                        0114 00084000
         ST    @10,D                                               0114 00085000
         CH    @10,@CH00065                                        0114 00086000
         BNH   @DL00112                                            0114 00087000
*   GEN(EJECT);                                                    0115 00088000
*                                                                  0115 00089000
         EJECT                                                          00090000
*   /*****************************************************************/ 00091000
*   /*                                                               */ 00092000
*   /* SCANNING THE COMMAND . SET UP THE PROPER PARAMETERS FOR THE   */ 00093000
*   /* IKJPARSE SERVICE RTN. . INVOKE IKJPARSE TO SCAN THE COMMAND. .*/ 00094000
*   /* VALIDITY CHECK DEN, BUFOFF, BLKSIZE, BUFL, KEYLEN, BUFNO, AND */ 00095000
*   /* LRECL IN PARSE VALIDITY CHECK EXITS. . UPON RETURN,           */ 00096000
*   /* INTERROGATE THE RETURN CODE. .0 INDICATES THAT IKJPARSE WAS   */ 00097000
*   /* SUCCESSFUL .>O INDICATES A FAILURE .IF IKJPARSE DID NOT ISSUE */ 00098000
*   /* A DIAGNOSTIC, DO SO PRIOR TO TERMINATING .TERMINATE           */ 00099000
*   /*                                                               */ 00100000
*   /*****************************************************************/ 00101000
*                                                                  0116 00102000
*   PPLPCL=ADCNATTR;                /* ADDRESS OF ATTRIB PCL         */ 00103000
         L     @10,PPLPTR                                          0116 00104000
         MVC   PPLPCL(4,@10),ADCNATTR                              0116 00105000
*   PPLANS=ADDR(PDLADDR);           /* ADDRESS OF ANSWER PLACE       */ 00106000
         LA    @06,PDLADDR                                         0117 00107000
         ST    @06,PPLANS(,@10)                                    0117 00108000
*   PPLCBUF=CPPLCBUF;               /* PTR TO COMMAND BUFFER         */ 00109000
         L     @06,CPPLPTR                                         0118 00110000
         MVC   PPLCBUF(4,@10),CPPLCBUF(@06)                        0118 00111000
*   GENERATE;                                                      0119 00112000
    STM R2,R12,VALCKWA                 STORE MAINLINE ATTR REGS         00113000
*   PPLUWA=ADDR(VALCKWA);           /* PTR TO WORK AREA              */ 00114000
         L     @10,PPLPTR                                          0120 00115000
         LA    @06,VALCKWA                                         0120 00116000
         ST    @06,PPLUWA(,@10)                                    0120 00117000
*   RESPECIFY                                                      0121 00118000
*    (R1) RSTD;                     /* RESTRICT R1 USAGE FOR PTR     */ 00119000
*   R1=PPLPTR;                      /* SERVICE ROUTINE PARM LIST     */ 00120000
         LR    R1,@10                                              0122 00121000
*   GEN(LINK EP=IKJPARS)                                           0123 00122000
*   REFS(R1);                       /* LINK TO PARSE TO SCAN BUFFER  */ 00123000
         LINK EP=IKJPARS                                                00124000
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */ 00125000
*    (R15) RESTRICTED;              /* RETURN CODE REG RESTRICTED    */ 00126000
*   RESPECIFY                                                      0125 00127000
*    (R1) UNRSTD;                   /* FREE R1 USAGE FOR COMPILER    */ 00128000
*   RCODESV=R15;                    /* SAVE RETURN CODE              */ 00129000
         ST    R15,RCODESV                                         0126 00130000
*   RESPECIFY                       /* FREE REGISTER FOR COMPILER    */ 00131000
*    (R15) UNRSTD;                  /* REGISTER 15 FREED             */ 00132000
*   IF RCODESV^=0                   /* A O INDICATES PARSE COMPLETED */ 00133000
*     THEN                          /* PARSE COMPLETED OK SO,        */ 00134000
         L     @10,RCODESV                                         0128 00135000
         LTR   @10,@10                                             0128 00136000
         BZ    @RF00128                                            0128 00137000
*     DO;                           /* SKIP THE ERROR CODE PATHS     */ 00138000
*       IF RCODESV=4                /* IF RETURN CODE=4 FROM PARSE,  */ 00139000
*         THEN                      /* WHICH INDICATES NOPROMPT USER */ 00140000
         CH    @10,@CH00266                                        0130 00141000
         BNE   @RF00130                                            0130 00142000
*         RTRNCODE=12;              /* TWELVE RETURN CODE TO THE TMP */ 00143000
         L     @10,RGSVAREA(,R13)                                  0131 00144000
         MVC   RTRNCODE(4,@10),@CF00035                            0131 00145000
*       ELSE                        /* OTHERWISE ISSUE MESSAGE THAT  */ 00146000
*         DO;                       /* ATTRIB CAN NOT CONTINUE       */ 00147000
         B     @RC00130                                            0132 00148000
@RF00130 DS    0H                                                  0133 00149000
*           SEG1=ADDR(MSG01);       /* 1ST LEVEL OF MESSAGE          */ 00150000
         LA    @10,MSG01                                           0133 00151000
         ST    @10,SEG1                                            0133 00152000
*           SEG2=0;                 /* END OF 1ST LEVEL MSG.         */ 00153000
         SLR   @10,@10                                             0134 00154000
         ST    @10,SEG2                                            0134 00155000
*           IF RCODESV=16           /* INDICATE NOT ENOUGH MAIN      */ 00156000
*             THEN                  /* STORAGE                       */ 00157000
         CLC   RCODESV(4),@CF00444                                 0135 00158000
         BNE   @RF00135                                            0135 00159000
*             DO;                   /* PUT OUT MESSAGE TO EFFECT     */ 00160000
*               SEG1=ADDR(MSG02);   /* NOT ENOUGH MAIN STORAGE       */ 00161000
         LA    @06,MSG02                                           0137 00162000
         ST    @06,SEG1                                            0137 00163000
*               SEG3=0;             /* END OF MESSAGE                */ 00164000
         ST    @10,SEG3                                            0138 00165000
*             END;                  /* END OF STORAGE MSG-GO ISSUE IT*/ 00166000
*           ELSE                    /* OTHERWISE IT WAS AN I/O ERROR */ 00167000
*             DO;                   /* SO BUILD A GENERALIZED MSG    */ 00168000
         B     @RC00135                                            0140 00169000
@RF00135 DS    0H                                                  0141 00170000
*               SEG3=ADDR(MSG04);   /* MESSAGE ID SEGMENT OF MESSAGE */ 00171000
         LA    @10,MSG04                                           0141 00172000
         ST    @10,SEG3                                            0141 00173000
*               SEG4=ADDR(PARSE);   /* 'PARSE' SEGMENT               */ 00174000
         LA    @10,PARSE                                           0142 00175000
         ST    @10,SEG4                                            0142 00176000
*               SEG5=ADDR(MSG03);   /* 'RETURN CODE IS' SEGMENT      */ 00177000
         LA    @10,MSG03                                           0143 00178000
         ST    @10,SEG5                                            0143 00179000
*               SEG6=ADDR(RTCDLEN); /* DECIMAL RETURN CODE SEGMENT   */ 00180000
         LA    @10,RTCDLEN                                         0144 00181000
         ST    @10,SEG6                                            0144 00182000
*               SEG7=0;             /* END OF SECOND LEVEL MESSAGE   */ 00183000
         SLR   @10,@10                                             0145 00184000
         ST    @10,SEG7                                            0145 00185000
*               RFY                                                0146 00186000
*                (R4) RSTD;         /* RESTRICT CVD REGISTER         */ 00187000
*               R4=RCODESV;         /* SET RETURN CODE IN REG 4      */ 00188000
         L     R4,RCODESV                                          0147 00189000
*               CVD(R4,UNPACK);     /* CONVERT TO DECIMAL            */ 00190000
         CVD   R4,UNPACK                                           0148 00191000
*               UNPK(RTCDAREA,UNPACK);/* UNPACK TO ZONED DECIMAL     */ 00192000
         UNPK  RTCDAREA(8),UNPACK(8)                               0149 00193000
*               RFY                                                0150 00194000
*                (R4) UNRSTD;       /* REGISTER 4 NO LONGER NEEDED   */ 00195000
*               FZERO=FZERO|'F0'X;  /* 'OR' IN F IN LAST BYTE        */ 00196000
         OI    FZERO,X'F0'                                         0151 00197000
*               RTCDLEN=4;          /* LENGTH OF RETURN CODE         */ 00198000
         MVC   RTCDLEN(2),@CH00266                                 0152 00199000
*             END;                  /* END GENERALIZED MSG-GO ISSUE  */ 00200000
*           RTRNCODE=12;            /* INDICATE TO TMP ATTRIB FAILED */ 00201000
@RC00135 L     @10,RGSVAREA(,R13)                                  0154 00202000
         MVC   RTRNCODE(4,@10),@CF00035                            0154 00203000
*           CALL PUTINTFC;          /* ISSUE THE APPROPRIATE MESSAGE */ 00204000
         BAL   @14,PUTINTFC                                        0155 00205000
*         END;                      /* END MESSAGE PROCESSING        */ 00206000
*     END;                          /* END OF ERROR PROCESSING       */ 00207000
*                                                                  0158 00208000
*   /*****************************************************************/ 00209000
*   /*                                                               */ 00210000
*   /* SET UP INTERFACE TO AND USE GENTRANS TO BUILD THE TEXT UNITS. */ 00211000
*   /* . SET UP INTERFACE TO THE GENTRANS ROUTINE. . GO TO THE       */ 00212000
*   /* GENTRANS ROUTINE. . CHECK THE RETURN CODE. . IF IT FAILED THEN*/ 00213000
*   /* ISSUE THE APPROPRIATE MESSAGE IF NECESSARY.                   */ 00214000
*   /*                                                               */ 00215000
*   /*****************************************************************/ 00216000
*                                                                  0158 00217000
*   ELSE                            /* NO ERROR--CONTINUE PROCESSING */ 00218000
*     DO;                           /* INITIALIZE FOR GENTRANS       */ 00219000
         B     @RC00128                                            0158 00220000
@RF00128 DS    0H                                                  0159 00221000
*       RFY                                                        0159 00222000
*         S99TUNIT BASED(ADBKPTR(1));/* PICK UP PROPER TEXT UNIT     */ 00223000
*       S99TUKEY=DALDUMMY;          /* FILL IN THE KEY FOR DUMMY     */ 00224000
         L     @10,GTPLPTR                                         0160 00225000
         L     @10,GTPLABLK(,@10)                                  0160 00226000
         L     @06,ADBKPTR(,@10)                                   0160 00227000
         MVC   S99TUKEY(2,@06),@CB00515                            0160 00228000
*       S99TUNUM=0;                 /* NUMBER OF LENGTH+PARM ENTRIES */ 00229000
         SLR   @02,@02                                             0161 00230000
         ST    @02,@TF00001                                        0161 00231000
         MVC   S99TUNUM(2,@06),@TF00001+2                          0161 00232000
*       RFY                                                        0162 00233000
*         S99TUNIT BASED(ADBKPTR(2));/* PICK UP PROPER TEXT UNIT     */ 00234000
*       S99TUKEY=DALPERMA;          /* FILL IN THE KEY FOR         0163 00235000
*                                      PERMANENTLY ALLOCATED         */ 00236000
         L     @06,ADBKPTR+4(,@10)                                 0163 00237000
         MVC   S99TUKEY(2,@06),@CB00607                            0163 00238000
*       S99TUNUM=0;                 /* NUMBER OF LENGTH+PARM ENTRIES */ 00239000
         SLR   @02,@02                                             0164 00240000
         ST    @02,@TF00001                                        0164 00241000
         MVC   S99TUNUM(2,@06),@TF00001+2                          0164 00242000
*       IF DSORGWD=1                /* WAS DSORG SPECIFIED?          */ 00243000
*         THEN                      /* YES, WAS SPECIFIED ON THE CMD */ 00244000
         LA    @06,1                                               0165 00245000
         L     @02,PDLADDR                                         0165 00246000
         CH    @06,DSORGWD(,@02)                                   0165 00247000
         BNE   @RF00165                                            0165 00248000
*         DO;                       /* DO THE FOLLOWING:             */ 00249000
*           RFY                                                    0167 00250000
*             S99TUNIT BASED(ADBKPTR(7));/* PICK UP THE RIGHT TEXT 0167 00251000
*                                      UNIT                          */ 00252000
*           S99TUKEY=DALDSORG;      /* FILL IN THE KEY FOR DATA SET     00253000
*                                      ORGANIZATION                  */ 00254000
         L     @10,ADBKPTR+24(,@10)                                0168 00255000
         MVC   S99TUKEY(2,@10),@CB00563                            0168 00256000
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */ 00257000
         MVC   S99TUNUM(2,@10),@CH00033                            0169 00258000
*           S99TULNG=2;             /* LENGTH OF FIRST PARM          */ 00259000
         MVC   S99TULNG(2,@10),@CH00063                            0170 00260000
*           IF DSORGSUB=1 THEN      /* IS THE DSORG DA?              */ 00261000
         CH    @06,DSORGSUB(,@02)                                  0171 00262000
         BNE   @RF00171                                            0171 00263000
*             S99TUPAR(1:2)='2000'X;/* STORE PROPER CODE IN TEXT UNIT*/ 00264000
         MVC   S99TUPAR(2,@10),@CB00869                            0172 00265000
*           ELSE                    /* DA IS NOT SPECIFIED           */ 00266000
*             IF DSORGSUB=2 THEN    /* IS THE DSORG DAU?             */ 00267000
         B     @RC00171                                            0173 00268000
@RF00171 L     @10,PDLADDR                                         0173 00269000
         CLC   DSORGSUB(2,@10),@CH00063                            0173 00270000
         BNE   @RF00173                                            0173 00271000
*               S99TUPAR(1:2)='2100'X;/* STORE PROPER CODE IN TEXT 0174 00272000
*                                      UNIT                          */ 00273000
         L     @10,GTPLPTR                                         0174 00274000
         L     @10,GTPLABLK(,@10)                                  0174 00275000
         L     @10,ADBKPTR+24(,@10)                                0174 00276000
         MVC   S99TUPAR(2,@10),@CB00870                            0174 00277000
*             ELSE                  /* DA AND DAU ARE NOT SPECIFIED  */ 00278000
*               IF DSORGSUB=3 THEN  /* IS THE DSORG PO?              */ 00279000
         B     @RC00173                                            0175 00280000
@RF00173 L     @10,PDLADDR                                         0175 00281000
         CLC   DSORGSUB(2,@10),@CH00293                            0175 00282000
         BNE   @RF00175                                            0175 00283000
*                 S99TUPAR(1:2)='0200'X;/* STORE PROPER CODE IN TEXT */ 00284000
         L     @10,GTPLPTR                                         0176 00285000
         L     @10,GTPLABLK(,@10)                                  0176 00286000
         L     @10,ADBKPTR+24(,@10)                                0176 00287000
         MVC   S99TUPAR(2,@10),@CB00871                            0176 00288000
*               ELSE                /* DA,PO,DAU ARE NOT SPECIFIED   */ 00289000
*                 IF DSORGSUB=4 THEN/* IS THE DSORG POU?             */ 00290000
         B     @RC00175                                            0177 00291000
@RF00175 L     @10,PDLADDR                                         0177 00292000
         CLC   DSORGSUB(2,@10),@CH00266                            0177 00293000
         BNE   @RF00177                                            0177 00294000
*                   S99TUPAR(1:2)='0300'X;/* STORE PROPER CODE IN  0178 00295000
*                                      TEXT                          */ 00296000
         L     @10,GTPLPTR                                         0178 00297000
         L     @10,GTPLABLK(,@10)                                  0178 00298000
         L     @10,ADBKPTR+24(,@10)                                0178 00299000
         MVC   S99TUPAR(2,@10),@CB00872                            0178 00300000
*                 ELSE              /* DA,DAU,PO,POU NOT SPECIFIED   */ 00301000
*                   IF DSORGSUB=5 THEN/* IS THE DSORG PS?            */ 00302000
         B     @RC00177                                            0179 00303000
@RF00177 L     @10,PDLADDR                                         0179 00304000
         CLC   DSORGSUB(2,@10),@CH00250                            0179 00305000
         BNE   @RF00179                                            0179 00306000
*                     S99TUPAR(1:2)='4000'X;/* STORE PROPER CODE IN     00307000
*                                      TEXT                          */ 00308000
         L     @10,GTPLPTR                                         0180 00309000
         L     @10,GTPLABLK(,@10)                                  0180 00310000
         L     @10,ADBKPTR+24(,@10)                                0180 00311000
         MVC   S99TUPAR(2,@10),@CB00873                            0180 00312000
*                   ELSE            /* MUST BE DSORG OF PSU          */ 00313000
*                     S99TUPAR(1:2)='4100'X;/* STORE PROPER CODE IN     00314000
*                                      TEXT                          */ 00315000
         B     @RC00179                                            0181 00316000
@RF00179 L     @10,GTPLPTR                                         0181 00317000
         L     @10,GTPLABLK(,@10)                                  0181 00318000
         L     @10,ADBKPTR+24(,@10)                                0181 00319000
         MVC   S99TUPAR(2,@10),@CB00874                            0181 00320000
*           DSORGWD=0;              /* LET GENTRANS THINK THAT DSORG    00321000
*                                      WASN'T SPECIFIED              */ 00322000
@RC00179 DS    0H                                                  0182 00323000
@RC00177 DS    0H                                                  0182 00324000
@RC00175 DS    0H                                                  0182 00325000
@RC00173 DS    0H                                                  0182 00326000
@RC00171 L     @10,PDLADDR                                         0182 00327000
         SLR   @06,@06                                             0182 00328000
         STH   @06,DSORGWD(,@10)                                   0182 00329000
*         END;                      /* END DSORG PROCESSING          */ 00330000
*       DENSITWD=0;                 /* LET GENTRANS THINK THAT     0184 00331000
*                                      DENSITY WASN'T SPECIFIED IF IT   00332000
*                                      WAS                           */ 00333000
@RF00165 SLR   @10,@10                                             0184 00334000
         L     @06,PDLADDR                                         0184 00335000
         STH   @10,DENSITWD(,@06)                                  0184 00336000
*       LRECLKWD=0;                 /* LET GENTRANS THINK THAT LRECL    00337000
*                                      WASN'T SPECIFIED IF IT WAS    */ 00338000
         STH   @10,LRECLKWD(,@06)                                  0185 00339000
*       IF EXPDTKWD=1               /* WAS EXPDT SPECIFIED?          */ 00340000
*         THEN                      /* YES, WAS SPECIFIED ON THE CMD */ 00341000
         CLC   EXPDTKWD(2,@06),@CH00033                            0186 00342000
         BNE   @RF00186                                            0186 00343000
*         EXPDTKWD=0;               /* LET GENTRANS THINK THAT EXPDT    00344000
*                                      WASN'T SPECIFIED              */ 00345000
         STH   @10,EXPDTKWD(,@06)                                  0187 00346000
*       IF RETPDWD=2                /* WAS RETPD SPECIFIED?          */ 00347000
*         THEN                      /* YES, WAS SPECIFIED ON THE CMD */ 00348000
@RF00186 L     @10,PDLADDR                                         0188 00349000
         CLC   RETPDWD(2,@10),@CH00063                             0188 00350000
         BNE   @RF00188                                            0188 00351000
*         DO;                       /* ZERO OUT EXPDT IF SPECIFIED   */ 00352000
*           RFY                                                    0190 00353000
*             S99TUNIT BASED(ADBKPTR(5));/* GET RIGHT TEXT UNIT      */ 00354000
*           S99TUKEY=ZEROKEY;       /* ZERO OUT THE KEY IN TEXT UNIT */ 00355000
         L     @10,GTPLPTR                                         0191 00356000
         L     @10,GTPLABLK(,@10)                                  0191 00357000
         L     @10,ADBKPTR+16(,@10)                                0191 00358000
         MVC   S99TUKEY(2,@10),@CB00751                            0191 00359000
*         END;                      /* END SPECIAL PROC. FOR RETPD   */ 00360000
*       BUFOFFWD=0;                 /* LET GENTRANS THINK THAT BUFOFF   00361000
*                                      WASN'T SPECIFIED IF IT WAS    */ 00362000
@RF00188 L     @10,PDLADDR                                         0193 00363000
         SLR   @06,@06                                             0193 00364000
         STH   @06,BUFOFFWD(,@10)                                  0193 00365000
*       GTPLPDL=PDLADDR;            /* ADDRESS OF ANSWER PLACE       */ 00366000
         L     @06,GTPLPTR                                         0194 00367000
         ST    @10,GTPLPDL(,@06)                                   0194 00368000
*       GTPLPCL=ADCNATTR;           /* ADDRESS OF ATTRIB'S PCL       */ 00369000
         MVC   GTPLPCL(4,@06),ADCNATTR                             0195 00370000
*       IF TRTCHWD=2 THEN           /* WAS TRTCH, NOT KEYLENGTH    0196 00371000
*                                      SPECIFIED?                    */ 00372000
         CLC   TRTCHWD(2,@10),@CH00063                             0196 00373000
         BNE   @RF00196                                            0196 00374000
*         GTPLKLST=ADDR(KYLIST);    /* ADDRESS OF THE KEYLIST TABLE  */ 00375000
         LA    @10,KYLIST                                          0197 00376000
         ST    @10,GTPLKLST(,@06)                                  0197 00377000
*       ELSE                        /* KEYLENGTH WAS SPECIFIED       */ 00378000
*         GTPLKLST=ADDR(KEYLIST);   /* ADDRESS OF THE KEYLIST TABLE  */ 00379000
         B     @RC00196                                            0198 00380000
@RF00196 LA    @10,KEYLIST                                         0198 00381000
         L     @06,GTPLPTR                                         0198 00382000
         ST    @10,GTPLKLST(,@06)                                  0198 00383000
*       GTPLTBLE=ADDR(KEYTABLE);    /* ADDRESS OF THE KEYTABLE LIST  */ 00384000
@RC00196 L     @10,GTPLPTR                                         0199 00385000
         LA    @06,KEYTABLE                                        0199 00386000
         ST    @06,GTPLTBLE(,@10)                                  0199 00387000
*       RESPECIFY                                                  0200 00388000
*        (R1) RSTD;                 /* RESTRICT R1 USAGE AS PTR      */ 00389000
*       R1=GTPLPTR;                 /* SERVICE ROUTINE PARM LIST     */ 00390000
         LR    R1,@10                                              0201 00391000
*       RESPECIFY                   /* RESTRICT REGISTER USAGE       */ 00392000
*        (R15) RESTRICTED;          /* RETURN CODE REG RESTRICTED    */ 00393000
*       GEN(LINK EP=IKJCB831)                                      0203 00394000
*       REFS(R1);                   /* LINK TO GENTRANS TO BUILD THE    00395000
*                                      TEXT UNITS                    */ 00396000
         LINK EP=IKJCB831                                               00397000
*       RESPECIFY                                                  0204 00398000
*        (R1) UNRSTD;               /* FREE R1 USAGE FOR COMPILER    */ 00399000
*       RCODESV=R15;                /* SAVE GENTRANS RETURN CODE     */ 00400000
         ST    R15,RCODESV                                         0205 00401000
*       RESPECIFY                   /* RELEASE REG FOR COMPILER      */ 00402000
*        (R15) UNRSTD;              /* FREE REGISTER 15              */ 00403000
*       IF RCODESV^=0               /* WAS GENTRANS SUCCESSFUL?      */ 00404000
*         THEN                      /* IT WAS NOT SUCCESSFUL SO      */ 00405000
         L     @10,RCODESV                                         0207 00406000
         SLR   @06,@06                                             0207 00407000
         CR    @10,@06                                             0207 00408000
         BE    @RF00207                                            0207 00409000
*         DO;                       /* CLEAN UP, ISSUE MESSAGE IF  0208 00410000
*                                      NECESSARY AND RETURN TO TMP   */ 00411000
*           SEG1=ADDR(MSG01);       /* OTHERWISE ISSUE MESSAGE THAT     00412000
*                                      ATTRIB CAN NOT CONTINUE       */ 00413000
         LA    @02,MSG01                                           0209 00414000
         ST    @02,SEG1                                            0209 00415000
*           SEG2=0;                 /* END OF 1ST LEVEL MSG.         */ 00416000
         ST    @06,SEG2                                            0210 00417000
*           IF RCODESV=12           /* INDICATE NOT ENOUGH MAIN      */ 00418000
*             THEN                  /* PUT OUT MESSAGE TO THAT EFFECT*/ 00419000
         CH    @10,@CH00035                                        0211 00420000
         BNE   @RF00211                                            0211 00421000
*             DO;                   /* SET UP MESSAGE BY INDICATING: */ 00422000
*               SEG1=ADDR(MSG02);   /* NOT ENOUGH MAIN STORAGE       */ 00423000
         LA    @10,MSG02                                           0213 00424000
         ST    @10,SEG1                                            0213 00425000
*               SEG3=0;             /* END OF MESSAGE                */ 00426000
         ST    @06,SEG3                                            0214 00427000
*             END;                  /* END MSG SETUP-GO ISSUE IT     */ 00428000
*           ELSE                    /* OTHERWISE, THE ERROR WAS A    */ 00429000
*             DO;                   /* RESULT OF AN INVALID PARM LIST   00430000
*                                      OR AN UNSUPPORTED PARM IN PCL */ 00431000
         B     @RC00211                                            0216 00432000
@RF00211 DS    0H                                                  0217 00433000
*               SEG3=ADDR(MSG04);   /* MESSAGE ID SEGMENT OF MESSAGE */ 00434000
         LA    @10,MSG04                                           0217 00435000
         ST    @10,SEG3                                            0217 00436000
*               SEG4=ADDR(GENTRANS);/* 'GENTRANS' MESSAGE SEGMENT    */ 00437000
         LA    @10,GENTRANS                                        0218 00438000
         ST    @10,SEG4                                            0218 00439000
*               SEG5=ADDR(MSG03);   /* 'RETURN CODE IS' SEGMENT      */ 00440000
         LA    @10,MSG03                                           0219 00441000
         ST    @10,SEG5                                            0219 00442000
*               SEG6=ADDR(RTCDLEN); /* DECIMAL RETURN CODE           */ 00443000
         LA    @10,RTCDLEN                                         0220 00444000
         ST    @10,SEG6                                            0220 00445000
*               SEG7=0;             /* END OF SECOND LEVEL MESSAGE   */ 00446000
         SLR   @10,@10                                             0221 00447000
         ST    @10,SEG7                                            0221 00448000
*               RFY                                                0222 00449000
*                (R4) RSTD;         /* RESTRICT CVD REGISTER         */ 00450000
*               R4=RCODESV;         /* SET RETURN CODE IN REGISTER 4 */ 00451000
         L     R4,RCODESV                                          0223 00452000
*               CVD(R4,UNPACK);     /* CONVERT TO DECIMAL            */ 00453000
         CVD   R4,UNPACK                                           0224 00454000
*               UNPK(RTCDAREA,UNPACK);/* UNPACK TO ZONED DECIMAL     */ 00455000
         UNPK  RTCDAREA(8),UNPACK(8)                               0225 00456000
*               RFY                                                0226 00457000
*                (R4) UNRSTD;       /* REGISTER 4 IS NO LONGER NEEDED*/ 00458000
*               FZERO=FZERO|'F0'X;  /* 'OR' IN F IN THE LAST BYTE    */ 00459000
         OI    FZERO,X'F0'                                         0227 00460000
*               RTCDLEN=4;          /* LENGHT OF RETURN CODE         */ 00461000
         MVC   RTCDLEN(2),@CH00266                                 0228 00462000
*             END;                  /* END OF GENERAL MESSAGE        */ 00463000
*           RTRNCODE=12;            /* INDICATE TO TMP ATTRIB FAILED */ 00464000
@RC00211 L     @10,RGSVAREA(,R13)                                  0230 00465000
         MVC   RTRNCODE(4,@10),@CF00035                            0230 00466000
*           CALL PUTINTFC;          /* ISSUE THE MESSAGE             */ 00467000
         BAL   @14,PUTINTFC                                        0231 00468000
*           R3=ADDR(PDLADDR);       /* PDL ADDRESS                   */ 00469000
         LA    R3,PDLADDR                                          0232 00470000
*           GENERATE;                                              0233 00471000
*                                   /* FREE THE PDL RETURNED BY PARSE*/ 00472000
             IKJRLSA (3)               MACRO TO FREE PDLS               00473000
*         END;                      /* END OF FAILING PROCESSING     */ 00474000
*                                                                  0235 00475000
*       /*************************************************************/ 00476000
*       /*                                                           */ 00477000
*       /* SET UP DYNAMIC ALLOCATION INTERFACE TO PLACE ATTRIBUTES ON*/ 00478000
*       /* ATTRIB CHAIN. . COMPLETE DYNAMIC ALLOCATION PARAMETER     */ 00479000
*       /* LIST. . INVOKE DYNAMIC ALLOCATION. . CHECK THE DYNAMIC    */ 00480000
*       /* ALLOCATION RETURN CODE. . IF DYNAMIC ALLOCATION IS        */ 00481000
*       /* UNSUCCESSFUL THEN: .LINK TO DAIRFAIL TO ISSUE MESSAGE.    */ 00482000
*       /* .RETURN TO THE TMP WITH A FAILING RETURN CODE.            */ 00483000
*       /*                                                           */ 00484000
*       /*************************************************************/ 00485000
*                                                                  0235 00486000
*       ELSE                        /* NO ERROR SO CONTINUE          */ 00487000
*         DO;                       /* BUILD THE PARM LIST AND GO  0235 00488000
*                                      DYNAMIC ALLOCATION            */ 00489000
         B     @RC00207                                            0235 00490000
@RF00207 DS    0H                                                  0236 00491000
*           S99RBPTR=ADDR(S99RB);   /* ADDRESS OF THE REQUEST BLOCK  */ 00492000
         LA    @10,S99RB                                           0236 00493000
         ST    @10,S99RBPTR                                        0236 00494000
*           S99RBPND='1'B;          /* SET THE HIGH ORDER BIT ON     */ 00495000
         OI    S99RBPND,B'10000000'                                0237 00496000
*           S99RB=S99RB&&S99RB;     /* ZERO OUT THE REQUEST BLOCK    */ 00497000
         XC    S99RB(20),S99RB                                     0238 00498000
*           S99RBLN=LENGTH(S99RB);  /* LENGTH OF THE REQUEST BLOCK   */ 00499000
         MVI   S99RBLN,X'14'                                       0239 00500000
*           S99VERB=S99VRBAL;       /* FUNCTION TO BE PERFORMED      */ 00501000
         MVI   S99VERB,X'01'                                       0240 00502000
*           S99TXTPP=ADDR(TXDTPTR); /* POINTER TO THE POINTERS TO THE   00503000
*                                      UNITS                         */ 00504000
         L     @10,GTPLPTR                                         0241 00505000
         L     @10,GTPLOUTA(,@10)                                  0241 00506000
         LA    @10,TXDTPTR(,@10)                                   0241 00507000
         ST    @10,S99TXTPP                                        0241 00508000
*           RESPECIFY               /* RESTRICT REGISTER USAGE       */ 00509000
*            (R1,                   /* RESTRICT INPUT REG USAGE      */ 00510000
*             R15) RESTRICTED;      /* RESTRICT RETURN CODE REG      */ 00511000
*           R1=ADDR(S99RBPTR);      /* ADDRESS OF POINTER TO RB      */ 00512000
*                                                                  0243 00513000
         LA    R1,S99RBPTR                                         0243 00514000
*           /*********************************************************/ 00515000
*           /*                                                       */ 00516000
*           /* MACDATE Y-2 73082                                     */ 00517000
*           /*                                                       */ 00518000
*           /*********************************************************/ 00519000
*                                                                  0244 00520000
*           SVC(99);                /* SVC 99 TO BUILD THE ATTR-LIST */ 00521000
         SVC   99                                                  0244 00522000
*           RCODESV=R15;            /* SAVE SVC 99'S RETURN CODE     */ 00523000
         ST    R15,RCODESV                                         0245 00524000
*           RESPECIFY               /* RELEASE REGS FOR COMPILER USE */ 00525000
*            (R1,                   /* RELEASE INPUT REGISTER        */ 00526000
*             R15) UNRESTRICTED;    /* RELEASE RETURN CODE REG       */ 00527000
*           IF RCODESV^=0           /* WAS ALLOCATION UNSUCCESSFUL?  */ 00528000
*             THEN                  /* YES,                          */ 00529000
         L     @10,RCODESV                                         0247 00530000
         LTR   @10,@10                                             0247 00531000
         BZ    @RF00247                                            0247 00532000
*             DO;                   /* SVC 99 WAS NOT SUCCESSFUL SO  */ 00533000
*               DFCPPLP=CPPLPTR;    /* MOVE CPPL POINTER IN PARMLIST */ 00534000
         MVC   DFCPPLP(4),CPPLPTR                                  0249 00535000
*               DFIDP=ADDR(CALLERID);/* ADDRESS OF THE CALLER ID     */ 00536000
         LA    @10,CALLERID                                        0250 00537000
         ST    @10,DFIDP                                           0250 00538000
*               DFJEFF02=ADDR(MSGWTR);/* MSG WRITER ADDRESS IS     0251 00539000
*                                      UNKNOWN                       */ 00540000
         LA    @10,MSGWTR                                          0251 00541000
         ST    @10,DFJEFF02                                        0251 00542000
*               DFRCP=ADDR(RCODESV);/* POINTER TO DYNAMIC ALLOCATION    00543000
*                                      RETURN CODE                   */ 00544000
         LA    @10,RCODESV                                         0252 00545000
         ST    @10,DFRCP                                           0252 00546000
*               DFS99RBP=S99RBPTR;  /* POINTER TO DYNAMIC ALLOCATION    00547000
*                                      REQUEST BLOCK                 */ 00548000
         MVC   DFS99RBP(4),S99RBPTR                                0253 00549000
*               RESPECIFY           /* RESTRICT REGISTER USAGE       */ 00550000
*                (R1) RESTRICTED;   /* RESTRICT INPUT REGISTER       */ 00551000
*               R1=ADDR(DFPARMS);   /* LOAD ADDRESS OF PARMLIST IN R1*/ 00552000
         LA    R1,DFPARMS                                          0255 00553000
*               GEN(LINK EP=IKJEFF18);/* ISSUE DIAGNOSTIC MESSAGE    */ 00554000
         LINK EP=IKJEFF18                                               00555000
*               RESPECIFY           /* RELEASE REG FOR COMPILER USE  */ 00556000
*                (R1) UNRESTRICTED; /* RELEASE INPUT REGISTER        */ 00557000
*               RTRNCODE=12;        /* SET A FAILING RETURN CODE     */ 00558000
         L     @10,RGSVAREA(,R13)                                  0258 00559000
         MVC   RTRNCODE(4,@10),@CF00035                            0258 00560000
*             END;                  /* END OF DAIR RETURN CODE CHECK */ 00561000
*           R3=ADDR(PDLADDR);       /* PDL ADDRESS                   */ 00562000
@RF00247 LA    R3,PDLADDR                                          0260 00563000
*           GENERATE;                                              0261 00564000
*                                   /* FREE THE PDL RETURNED BY PARSE*/ 00565000
        IKJRLSA (3)                    MACRO TO FREE PDLS               00566000
*           RESPECIFY                                              0262 00567000
*            (R3,                                                  0262 00568000
*             R4,                                                  0262 00569000
*             R5) RSTD;             /* RESTRICT REGS FOR FREEMAIN    */ 00570000
*           R3=TXDTLNGH;            /* LENGTH OF CORE TO BE FREED    */ 00571000
         L     @10,GTPLPTR                                         0263 00572000
         L     @10,GTPLOUTA(,@10)                                  0263 00573000
         L     R3,TXDTLNGH-1(,@10)                                 0263 00574000
         LA    R3,0(,R3)                                           0263 00575000
*           R4=GTPLOUTA;            /* ADDRESS OF THE CORE TO FREE   */ 00576000
         LR    R4,@10                                              0264 00577000
*           R5=TXDTSBPL;            /* SUBPOOL NUMBER                */ 00578000
         SLR   R5,R5                                               0265 00579000
         IC    R5,TXDTSBPL(,@10)                                   0265 00580000
*           GEN(FREEMAIN R,LV=(3),A=(4),SP=(5))                    0266 00581000
*           REFS(R3,R4,R5);         /* FREE THE GENTRANS CORE        */ 00582000
         FREEMAIN R,LV=(3),A=(4),SP=(5)                                 00583000
*           RESPECIFY                                              0267 00584000
*            (R3,                                                  0267 00585000
*             R4,                                                  0267 00586000
*             R5) UNRSTD;           /* RELEASE REGS FOR COMPILER USE */ 00587000
*         END;                                                     0268 00588000
*     END;                                                         0269 00589000
@RC00207 DS    0H                                                  0270 00590000
*   GEN(EJECT);                                                    0270 00591000
*                                                                  0270 00592000
@RC00128 DS    0H                                                  0270 00593000
         EJECT                                                          00594000
*   /*****************************************************************/ 00595000
*   /*                                                               */ 00596000
*   /* RETURN: 1) IF ERROR RETURN, REG 15 WILL CONTAIN A 12 2) IF    */ 00597000
*   /* SUCCESSFUL RETURN, REG 15 WILL BE SET TO ZERO 3) RETURN TO TMP*/ 00598000
*   /*                                                               */ 00599000
*   /*****************************************************************/ 00600000
*                                                                  0271 00601000
*   IF RTRNCODE=12 THEN             /* IF RETURN CODE 12 DO THE      */ 00602000
         L     @10,RGSVAREA(,R13)                                  0271 00603000
         CLC   RTRNCODE(4,@10),@CF00035                            0271 00604000
         BNE   @RF00271                                            0271 00605000
*     DO;                           /* FOLLOWING AND THEN EXIT       */ 00606000
*       RESPECIFY                                                  0273 00607000
*        (R2) RESTRICTED;           /* RESTRICT PARAMETER REGISTER   */ 00608000
*       R2=ADDR(STACKLSD);          /* REG 2 ADDRESS OF STACK LIST   */ 00609000
         LA    R2,STACKLSD                                         0274 00610000
*       RESPECIFY                   /* RESTRICT REGISTER USAGE       */ 00611000
*        (R1,                       /* RESTRICT INPUT REGISTER       */ 00612000
*         R15) RESTRICTED;          /* RESTRICT RETURN CODE REG      */ 00613000
*       R1=STPLPTR;                 /* REG1 STACK PARM LIST          */ 00614000
         L     R1,STPLPTR                                          0276 00615000
*       STACKLSD=STACKLST;          /* LENGTH OF STACK PARM BLOCK    */ 00616000
         MVC   STACKLSD(20),STACKLST                               0277 00617000
*       GEN(STACK PARM=(R2),DELETE=ALL,MF=(E,(1)));                0278 00618000
         STACK PARM=(R2),DELETE=ALL,MF=(E,(1))                          00619000
*       RCODESV=R15;                /* SAVE RETURN CODE              */ 00620000
         ST    R15,RCODESV                                         0279 00621000
*       RESPECIFY                   /* RELEASE REGISTER USAGE        */ 00622000
*        (R1,                       /* RELEASE INPUT REGISTER        */ 00623000
*         R15) UNRESTRICTED;        /* RELEASE RETURN CODE REG       */ 00624000
*       GEN(TCLEARQ INPUT);         /* CLEAR GETLINE INPUT QUEUE     */ 00625000
         TCLEARQ INPUT                                                  00626000
*       RESPECIFY                                                  0282 00627000
*        (R2) UNRESTRICTED;         /* RELEASE REGISTER 2            */ 00628000
*     END;                          /* END FAILURE EXIT PROCESSING   */ 00629000
*   RETURN;                         /* RETURN TO THE CALLER(TMP)     */ 00630000
@EL00001 L     @13,4(,@13)                                         0284 00631000
@EF00001 L     @00,@SIZDATD                                        0284 00632000
         LR    @01,@12                                             0284 00633000
         FREEMAIN R,LV=(0),A=(1)                                        00634000
@ER00001 LM    @14,@12,12(@13)                                     0284 00635000
         BR    @14                                                 0284 00636000
*   GEN(EJECT);                                                    0285 00637000
*                                                                  0285 00638000
         EJECT                                                          00639000
*   /*****************************************************************/ 00640000
*   /*                                                               */ 00641000
*   /* THIS SUBROUTINE CONVERTS EBCDIC INTEGERS TO BINARY FORM       */ 00642000
*   /*                                                               */ 00643000
*   /*****************************************************************/ 00644000
*                                                                  0286 00645000
*   RESPECIFY                                                      0286 00646000
*    (R1,                                                          0286 00647000
*     R5,                                                          0286 00648000
*     R15) RSTD;                    /* RESTRICT R1,R5,R14 FOR OWN USE*/ 00649000
*CONVERT:                           /* CONVERT ENTRANCE              */ 00650000
*   R5=VALUELEN-1;                  /* SUBTRACT 1 FROM NO. INTEGERS  */ 00651000
CONVERT  LH    R5,VALUELEN(,R7)                                    0287 00652000
         BCTR  R5,0                                                0287 00653000
*   R1=VALUEPTR;                    /* PTR TO VALUE                  */ 00654000
         L     R1,VALUEPTR(,R7)                                    0288 00655000
*CONVERTA:                          /* ENTER WHEN I SET UP REGISTERS */ 00656000
*   GENERATE;                                                      0289 00657000
CONVERTA DS    0H                                                  0289 00658000
    EX  R5,PACDEC                   CONVERT INTEGER TO PACKED DECIMAL   00659000
    CVB R1,DECSIZE                  CONVERT INTEGER TO BINARY FORM      00660000
*   RESPECIFY                                                      0290 00661000
*    (R1,                                                          0290 00662000
*     R5) UNRESTRICTED;             /* REGISTERS 1,5 NO LONGER NEEDED*/ 00663000
*   RESPECIFY                       /* RESTRICT REGISTER USAGEN      */ 00664000
*    (R14) RESTRICTED;              /* RESTRICT RETURN ADDR REG      */ 00665000
*   GO TO RETPOINT;                 /* RETURN TO CALLER              */ 00666000
         BR    R14                                                 0292 00667000
*   RESPECIFY                       /* RELEASE REG FOR COMPILER      */ 00668000
*    (R14) UNRESTRICTED;            /* RELEASE RETURN ADDR REG       */ 00669000
*   GENERATE;                                                      0294 00670000
PACDEC PACK DECSIZE(AEIGHT),AZER(EIN,R1) CONVERT TO PACKED DECIMAL      00671000
AEIGHT EQU 8                           LENGTH OF EIGHT                  00672000
EIN    EQU 1                           1                                00673000
AZER   EQU 0                           OFFSET OF 0                      00674000
*   GEN(EJECT);                                                    0295 00675000
*                                                                  0295 00676000
         EJECT                                                          00677000
*/********************************************************************/ 00678000
*/* PUTINTFC ROUTINE:                                                */ 00679000
*/*    FORMATS MESSAGES TO BE PUT OUT TO THE TERMINAL AND ISSUES     */ 00680000
*/*    THE CALL TO THE PUTLINE SERVICE ROUTINE. INPUT IS A LIST      */ 00681000
*/*    OF SEGMENT ADDRESSES, THE SEGMENTS MAKE UP THE MESSAGE.       */ 00682000
*/*    THE END OF THE LIST IS SIGNIFIED BY A WORD OF ZEROS.          */ 00683000
*/********************************************************************/ 00684000
*                                                                  0296 00685000
*PUTINTFC:                                                         0296 00686000
*   RESPECIFY                       /* RELEASE REGISTER FOR COMPILER */ 00687000
*    (R14) RESTRICTED;              /* RESTRICT RETURN ADDR REG      */ 00688000
PUTINTFC DS    0H                                                  0297 00689000
*   R14SAVE3=R14;                   /* SAVE RETURN ADDRESS           */ 00690000
         ST    R14,R14SAVE3                                        0297 00691000
*   RESPECIFY                                                      0298 00692000
*    (I,                                                           0298 00693000
*     X,                                                           0298 00694000
*     Y) RESTRICTED;                /* RESTRICT REGISTERS 6,5,4, AND */ 00695000
*   RESPECIFY                                                      0299 00696000
*    (R2) RESTRICTED;               /* 2 FOR FORMATTING MESSAGES     */ 00697000
*   RESPECIFY                       /* RELEASE REG FOR COMPILER USE  */ 00698000
*    (R14) UNRESTRICTED;            /* RELEASE RETURN ADDRESS REG    */ 00699000
*   I=0;                            /* TABLE SUBSCRIPT INITIALIZE    */ 00700000
         SLR   I,I                                                 0301 00701000
*   Y=ADDR(FORMTBUF);               /* PTR TO MESSAGE BUFFER         */ 00702000
         LA    Y,FORMTBUF                                          0302 00703000
*   ADSEG1=ADDR(MSGBUFER);          /* PTR TO COMPLETE MSG BUFFER    */ 00704000
         LA    @14,MSGBUFER                                        0303 00705000
         ST    @14,ADSEG1                                          0303 00706000
*   SEGNUM1=1;                      /* NUMBER OF SEGMENTS            */ 00707000
         MVC   SEGNUM1(4),@CF00033                                 0304 00708000
*   R2=ADDR(RETURNX);               /* RETURN POINT ADDRESS          */ 00709000
         LA    R2,RETURNX                                          0305 00710000
*   GO TO FRMTLOOP;                 /* FORMAT MESSAGE SS             */ 00711000
         B     FRMTLOOP                                            0306 00712000
*RETURNX:                                                          0307 00713000
*   Y=Y-ADDR(FORMTBUF);             /* DETERMINE LENGTH OF MESG      */ 00714000
RETURNX  LA    @14,FORMTBUF                                        0307 00715000
         SLR   Y,@14                                               0307 00716000
*   Y=Y+4;                          /* ACCOUNT FOR HEADER LENGTH     */ 00717000
         AH    Y,@CH00266                                          0308 00718000
*   LENOFMSG=Y;                     /* STORE IN PARM LIST            */ 00719000
         STH   Y,LENOFMSG                                          0309 00720000
*   OFFSET=0;                       /* OFFSET FOR SEGMENT            */ 00721000
         SLR   @14,@14                                             0310 00722000
         STH   @14,OFFSET                                          0310 00723000
*   I=I+1;                          /* INCREMENT SUBSCRIPT           */ 00724000
         AL    I,@CF00033                                          0311 00725000
*   X=SEGTABLE(I);                  /* NEXT SEGMENT ADDRESS          */ 00726000
         LR    @10,I                                               0312 00727000
         SLA   @10,2                                               0312 00728000
         LA    @03,MSGSGMTS                                        0312 00729000
         AL    @03,@CF00948                                        0312 00730000
         L     X,SEGTABLE(@10,@03)                                 0312 00731000
*   IF X=0 THEN                     /* IF 0, THEN NO 2ND LEVEL       */ 00732000
         CR    X,@14                                               0313 00733000
         BNE   @RF00313                                            0313 00734000
*     DO;                           /* MESSAGE, SO                   */ 00735000
*       PTRLEVL2=PDECMPRE;          /* INDICATE NO 2ND LEVEL         */ 00736000
         MVC   PTRLEVL2(4),PDECMPRE                                0315 00737000
*       GO TO PUTISSUE;             /* ISSUE PUTLINE                 */ 00738000
         B     PUTISSUE                                            0316 00739000
*     END;                          /* END MESSAGE ROUTINE           */ 00740000
*   PTRLEVL2=ADDR(LEVELTWO);        /* ADDRESS OF 2ND LEVEL          */ 00741000
@RF00313 LA    @14,LEVELTWO                                        0318 00742000
         ST    @14,PTRLEVL2                                        0318 00743000
*   SEGNUM2=1;                      /* SEGMENT NUMBER                */ 00744000
         MVC   SEGNUM2(4),@CF00033                                 0319 00745000
*   Y=ADDR(FORMBUF2);               /* BUFFER ADDRESS                */ 00746000
         LA    Y,FORMBUF2                                          0320 00747000
*   ADSEG2=ADDR(MSGBUF2);           /* MESSAGE BUFFER 2              */ 00748000
         LA    @14,MSGBUF2                                         0321 00749000
         ST    @14,ADSEG2                                          0321 00750000
*   ADNEXT=PDECMPRE;                /* INDICATE NO 3RD LEVEL         */ 00751000
         MVC   ADNEXT(4),PDECMPRE                                  0322 00752000
*   R2=ADDR(RETURNY);               /* RETURN ADDRESS                */ 00753000
         LA    R2,RETURNY                                          0323 00754000
*   GO TO FRMT1;                    /* FORMAT MESSAGE                */ 00755000
         B     FRMT1                                               0324 00756000
*   RESPECIFY                                                      0325 00757000
*    (R2) RESTRICTED;               /* RESTRICT REG 2 FOR MY USE     */ 00758000
*FRMTLOOP:                                                         0326 00759000
*   I=I+1;                          /* INCREMENT SUBSCRIPT           */ 00760000
FRMTLOOP AL    I,@CF00033                                          0326 00761000
*   X=SEGTABLE(I);                  /* PTR TO MESSAGE SEGMENT        */ 00762000
         LR    @14,I                                               0327 00763000
         SLA   @14,2                                               0327 00764000
         LA    @10,MSGSGMTS                                        0327 00765000
         AL    @10,@CF00948                                        0327 00766000
         L     X,SEGTABLE(@14,@10)                                 0327 00767000
*   IF X=0 THEN                     /* IF 0, END OF SEGMENT TEST     */ 00768000
         LTR   X,X                                                 0328 00769000
         BZ    @RT00328                                            0328 00770000
*     GO TO FRMTEND;                /* BRANCH TO R2POINT VIA FRMTEND */ 00771000
*FRMT1:                                                            0330 00772000
*   MSGBUF(1:MESSLEN)=              /* MOVE SEGMENT OF MESSAGE       */ 00773000
*       MESSTXT(1:MESSLEN);                                        0330 00774000
FRMT1    LH    @14,MESSLEN(,X)                                     0330 00775000
         LR    @10,@14                                             0330 00776000
         BCTR  @10,0                                               0330 00777000
         EX    @10,@SM00949                                        0330 00778000
*   Y=Y+MESSLEN;                    /* INCREMENT POINTER             */ 00779000
         ALR   Y,@14                                               0331 00780000
*   GO TO FRMTLOOP;                 /* CONTINUE WITH MESSAGE         */ 00781000
         B     FRMTLOOP                                            0332 00782000
*FRMTEND:                                                          0333 00783000
*   GO TO R2POINT;                  /* RETURN                        */ 00784000
FRMTEND  BR    R2                                                  0333 00785000
*RETURNY:                                                          0334 00786000
*   Y=Y-ADDR(FORMBUF2);             /* LENGTH OF MESSAGE             */ 00787000
RETURNY  LA    @14,FORMBUF2                                        0334 00788000
         SLR   Y,@14                                               0334 00789000
*   Y=Y+4;                          /* ACCOUNT FOR HEADER LTH        */ 00790000
         AH    Y,@CH00266                                          0335 00791000
*   LENMSG2=Y;                      /* STORE IN PARM LIST            */ 00792000
         STH   Y,LENMSG2                                           0336 00793000
*   OFFSET2=0;                      /* OFFSET                        */ 00794000
         SLR   @14,@14                                             0337 00795000
         STH   @14,OFFSET2                                         0337 00796000
*   RESPECIFY                                                      0338 00797000
*    (R2) UNRESTRICTED;             /* RELEASE REGISTERS 6,5,4, AND  */ 00798000
*   RESPECIFY                                                      0339 00799000
*    (I,                                                           0339 00800000
*     X,                                                           0339 00801000
*     Y) UNRESTRICTED;              /* 2 FOR COMPILERS USE           */ 00802000
*PUTISSUE:                          /* ISSUE THE PUTLINE MACRO       */ 00803000
*   PSIZE=PUTLEN;                   /* SIZE OF PUTLINE LIST          */ 00804000
PUTISSUE MVC   PSIZE(3),PUTLEN+1                                   0340 00805000
*   SUBPOOLN='01'X;                 /* SUBPOOL ONE SPECIFIED         */ 00806000
         MVI   SUBPOOLN,X'01'                                      0341 00807000
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */ 00808000
*    (R0,                           /* RESTRICT REQUEST REGISTER     */ 00809000
*     R1) RESTRICTED;               /* RESTRICT CORE ADDR REGISTER   */ 00810000
*   R0=CORE;                        /* LOAD SIZE AND SUBPOOL NBR.    */ 00811000
         L     R0,CORE                                             0343 00812000
*   GENERATE;                                                      0344 00813000
*                                   /* GET CORE FOR PUTLINE LIST     */ 00814000
               GETMAIN R,LV=(0)                                         00815000
*   RESPECIFY                       /* RELEASE REGISTER FOR COMPILER */ 00816000
*    (R0) UNRSTD;                   /* RELEASE GETMAIN INPUT REG     */ 00817000
*   IOPLIOPB=R1;                    /* ADDRESS OF CORE IN IOPL       */ 00818000
         L     @14,IOPLPTR                                         0346 00819000
         ST    R1,IOPLIOPB(,@14)                                   0346 00820000
*   R1=IOPLPTR;                     /* ADDRESS OF IOPL IN R1         */ 00821000
         LR    R1,@14                                              0347 00822000
*   COREGOT(1:PUTLEN)=PUTLIST(1:PUTLEN);/* MOVE MESSAGE              */ 00823000
         L     @14,IOPLPTR                                         0348 00824000
         L     @14,IOPLIOPB(,@14)                                  0348 00825000
         L     @10,PUTLEN                                          0348 00826000
         BCTR  @10,0                                               0348 00827000
         EX    @10,@SM00951                                        0348 00828000
*   OUTADDR=ADDR(MSGPARMS);         /* LOAD THE MESSAGE ADDRESS      */ 00829000
         LA    @10,MSGPARMS                                        0349 00830000
         ST    @10,OUTADDR(,@14)                                   0349 00831000
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */ 00832000
*    (R15) RESTRICTED;              /* RESTRICT RETURN CODE REG      */ 00833000
*   GENERATE;                                                      0351 00834000
*                                   /* ISSUE MESSAGE WITH PUTLINE    */ 00835000
               PUTLINE MF=(E,(1))                                       00836000
*   RCODESV=R15;                    /* SAVE RETURN CODE              */ 00837000
         ST    R15,RCODESV                                         0352 00838000
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */ 00839000
*    (R0,                           /* RESTRICT REQUEST REGISTER     */ 00840000
*     R1) RESTRICTED;               /* RESTRICT INPUT REG            */ 00841000
*   RESPECIFY                       /* RELEASE REG FOR COMPILER      */ 00842000
*    (R15) UNRSTD;                  /* RELEASE RETURN CODE REG       */ 00843000
*   R0=CORE;                        /* LOAD FREEMAIN PARM REGS       */ 00844000
         L     R0,CORE                                             0355 00845000
*   R1=IOPLIOPB;                    /* ADDRESS OF PUTLIST            */ 00846000
         L     @10,IOPLPTR                                         0356 00847000
         L     R1,IOPLIOPB(,@10)                                   0356 00848000
*   GENERATE;                                                      0357 00849000
*                                   /* FREE PUTLIST CORE             */ 00850000
               FREEMAIN R,LV=(0),A=(1)                                  00851000
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */ 00852000
*    (R14) RESTRICTED;              /* RESTRICT RETURN ADDR REG      */ 00853000
*   RESPECIFY                       /* RELEASE REGISTERS FOR COMPILER*/ 00854000
*    (R0,                           /* RELEASE FREEMAIN INPUT REG    */ 00855000
*     R1) UNRSTD;                   /* RELEASE FREEMAIN INPUT REG    */ 00856000
*   R14=R14SAVE3;                   /* RESTORE RETURN POINT          */ 00857000
         L     R14,R14SAVE3                                        0360 00858000
*   GO TO RETPOINT;                 /* RETURN TO CALLER VIA REG 14   */ 00859000
         BR    R14                                                 0361 00860000
*   RESPECIFY                       /* RELEASE REG FOR COMPILER USE  */ 00861000
*    (R14) UNRESTRICTED;            /* RELEASE RETURN ADDRESS REG    */ 00862000
*   GENERATE;                                                      0363 00863000
PUTLIST  PUTLINE OUTPUT=(PUTLIST,MULTLVL),MF=L                          00864000
PUTEND   EQU   *                       END OF PUTLIST IS HERE           00865000
PUTLEN   DC    A(PUTEND-PUTLIST)       LENGTH OF PUTLIST                00866000
PUTADCON DC    A(PUTLIST)              ADDRESS OF PUTLIST               00867000
*   GEN(EJECT);                                                    0364 00868000
*                                                                  0364 00869000
         EJECT                                                          00870000
*/********************************************************************/ 00871000
*/* THE FOLLOWING IS THE PARSE CONTROL LIST FOR THE ATTRIB COMMAND.  */ 00872000
*/********************************************************************/ 00873000
*                                                                  0365 00874000
*   GENERATE;                                                      0365 00875000
IKJEFAT1 IKJPARM DSECT=PCL                                              00876000
ATTRNAME IKJIDENT  'ATTR-LIST-NAME',                                   X00877000
               MAXLNTH=8,                                              X00878000
               FIRST=ALPHA,OTHER=ALPHANUM,                             X00879000
               PROMPT='ATTR-LIST-NAME',                                X00880000
               VALIDCK=ATTRNMCK,                                       X00881000
               HELP='A CORRECT NONDUPLICATE ATTR-LIST-NAME'             00882000
BFALN    IKJKEYWD                                                       00883000
         IKJNAME    'BFALN',SUBFLD=ALLIGN                               00884000
BFTEK    IKJKEYWD                                                       00885000
         IKJNAME    'BFTEK',SUBFLD=TYPE                                 00886000
BLKSIZE  IKJKEYWD                                                       00887000
         IKJNAME    'BLKSIZE',SUBFLD=SIZE                               00888000
BUFL     IKJKEYWD                                                       00889000
         IKJNAME    'BUFL',SUBFLD=BUFLNGTH                              00890000
BUFNO    IKJKEYWD                                                       00891000
         IKJNAME    'BUFNO',SUBFLD=BUFNBR                               00892000
BUFOFF   IKJKEYWD                                                       00893000
         IKJNAME    'BUFOFF',SUBFLD=BFFLNGTH                            00894000
EROPT    IKJKEYWD                                                       00895000
         IKJNAME    'EROPT',SUBFLD=OPTIONS                              00896000
KEYTRTCH IKJKEYWD                                                       00897000
         IKJNAME    'KEYLEN',SUBFLD=KEYLNGTH                            00898000
         IKJNAME    'TRTCH',SUBFLD=TRTCHLTH                             00899000
LRECL    IKJKEYWD                                                       00900000
         IKJNAME    'LRECL',SUBFLD=RECLNGTH                             00901000
NCP      IKJKEYWD                                                       00902000
         IKJNAME    'NCP',SUBFLD=NUMBER                                 00903000
OPTCD    IKJKEYWD                                                       00904000
         IKJNAME    'OPTCD',SUBFLD=CODE                                 00905000
RECFM    IKJKEYWD                                                       00906000
         IKJNAME    'RECFM',SUBFLD=FORMAT                               00907000
INOUT    IKJKEYWD                                                       00908000
         IKJNAME    'INPUT'                                             00909000
         IKJNAME    'OUTPUT'                                            00910000
EXPRETOT IKJKEYWD                                                       00911000
         IKJNAME    'EXPDT',SUBFLD=DATE                                 00912000
         IKJNAME    'RETPD',SUBFLD=DAYS                                 00913000
DIAGNS   IKJKEYWD                                                       00914000
         IKJNAME    'DIAGNS',SUBFLD=DIAGNSS                             00915000
DENSITY  IKJKEYWD                                                       00916000
         IKJNAME    'DEN',SUBFLD=DENS                                   00917000
LIMCT    IKJKEYWD                                                       00918000
         IKJNAME    'LIMCT',SUBFLD=LIMLNGTH                             00919000
DSORG    IKJKEYWD                                                       00920000
         IKJNAME    'DSORG',SUBFLD=ORGANIZA                             00921000
ALLIGN   IKJSUBF                                                        00922000
BFALNFLD IKJKEYWD                                                       00923000
         IKJNAME   'F'                                                  00924000
         IKJNAME   'D'                                                  00925000
TYPE     IKJSUBF                                                        00926000
BFTEKFLD IKJKEYWD                                                       00927000
         IKJNAME   'S'                                                  00928000
         IKJNAME   'E'                                                  00929000
         IKJNAME   'A'                                                  00930000
         IKJNAME   'R'                                                  00931000
SIZE     IKJSUBF                                                        00932000
BLKSZFLD IKJIDENT  'BLOCKSIZE',                                        X00933000
               MAXLNTH=5,                                              X00934000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X00935000
               PROMPT='BLOCKSIZE',                                     X00936000
               VALIDCK=BLKBUFCK,                                       X00937000
               HELP='A DECIMAL NUMBER FROM 0 TO 32760'                  00938000
BFFLNGTH IKJSUBF                                                        00939000
BFFLNFLD IKJIDENT   'BUFFER OFFSET',                                   X00940000
               MAXLNTH=2,                                              X00941000
               FIRST=ALPHANUM,OTHER=NUMERIC,                           X00942000
               PROMPT='BUFFER OFFSET',                                 X00943000
               VALIDCK=BUFCK,                                          X00944000
               HELP='A DECIMAL NUMBER FROM 0 TO 99 OR A CHARACTER L'    00945000
BUFLNGTH IKJSUBF                                                        00946000
BUFLNFLD IKJIDENT   'BUFFER LENGTH',                                   X00947000
               MAXLNTH=5,                                              X00948000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X00949000
               PROMPT='BUFFER LENGTH',                                 X00950000
               VALIDCK=BLKBUFCK,                                       X00951000
               HELP='A DECIMAL NUMBER FROM 0 TO 32760'                  00952000
BUFNBR   IKJSUBF                                                        00953000
BUFNBFLD IKJIDENT   'BUFFER NUMBER',                                   X00954000
               MAXLNTH=3,                                              X00955000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X00956000
               PROMPT='NUMBER OF BUFFERS',                             X00957000
               VALIDCK=KEYBUFCK,                                       X00958000
               HELP='A DECIMAL NUMBER FROM 0 TO 255'                    00959000
KEYLNGTH IKJSUBF                                                        00960000
KEYLNFLD IKJIDENT   'KEY LENGTH',                                      X00961000
               MAXLNTH=3,                                              X00962000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X00963000
               PROMPT='KEY LENGTH',                                    X00964000
               VALIDCK=KEYBUFCK,                                       X00965000
               HELP='A DECIMAL NUMBER FROM 0 TO 255'                    00966000
RECLNGTH IKJSUBF                                                        00967000
RECLNFLD IKJIDENT   'LOGICAL RECORD LENGTH',                           X00968000
               MAXLNTH=5,                                              X00969000
               FIRST=ALPHANUM,OTHER=NUMERIC,                           X00970000
               PROMPT='LOGICAL RECORD LENGTH',                         X00971000
               VALIDCK=LRECLCK,                                        X00972000
               HELP='A DECIMAL NUMBER FROM 0 TO 32760 OR A CHARACTER X' 00973000
NUMBER   IKJSUBF                                                        00974000
NUMBEFLD IKJIDENT   'MAXIMUM NUMBER OF READ OR WRITE MACROS',          X00975000
               MAXLNTH=2,                                              X00976000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X00977000
               PROMPT='MAXIMUM NUMBER OF READ OR WRITE MACROS',        X00978000
               HELP='A DECIMAL NUMBER FROM 0 TO 99'                     00979000
DATE     IKJSUBF                                                        00980000
DATEFLD  IKJIDENT   'EXPIRATION DATE',                                 X00981000
               MAXLNTH=5,                                              X00982000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X00983000
               PROMPT='EXPIRATION DATE',                               X00984000
               VALIDCK=EXPDTCK,                                        X00985000
               HELP='A JULIAN DATE IN YYDDD FORMAT'                     00986000
DAYS     IKJSUBF                                                        00987000
DAYSFLD  IKJIDENT   'RETENTION PERIOD',                                X00988000
               MAXLNTH=4,                                              X00989000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X00990000
               PROMPT='RETENTION PERIOD',                              X00991000
               HELP='A DECIMAL NUMBER FROM 0 TO 9999'                   00992000
DENS     IKJSUBF                                                        00993000
DENFLD   IKJIDENT   'MAGNETIC TAPE DENSITY',                           X00994000
               MAXLNTH=1,                                              X00995000
               FIRST=NUMERIC,                                          X00996000
               PROMPT='MAGNETIC TAPE DENSITY',                         X00997000
               VALIDCK=DENSCK,                                         X00998000
               HELP='A NUMBER FROM 0 TO 4'                              00999000
LIMLNGTH IKJSUBF                                                        01000000
LIMLNFLD IKJIDENT   'SEARCH LENGTH',                                   X01001000
               MAXLNTH=5,                                              X01002000
               FIRST=NUMERIC,OTHER=NUMERIC,                            X01003000
               PROMPT='SEARCH LENGTH',                                 X01004000
               VALIDCK=BLKBUFCK,                                       X01005000
               HELP='A DECIMAL NUMBER FROM 0 TO 32760'                  01006000
OPTIONS  IKJSUBF                                                        01007000
OPTIOFLD IKJKEYWD                                                       01008000
         IKJNAME    'SKP'                                               01009000
         IKJNAME    'ACC'                                               01010000
         IKJNAME    'ABE'                                               01011000
TRTCHLTH IKJSUBF                                                        01012000
TRTCHFLD IKJKEYWD                                                       01013000
         IKJNAME    'C'                                                 01014000
         IKJNAME    'E'                                                 01015000
         IKJNAME    'ET'                                                01016000
         IKJNAME    'T'                                                 01017000
CODE     IKJSUBF                                                        01018000
CODEFLD1 IKJKEYWD                                                       01019000
         IKJNAME    'C'                                                 01020000
CODEFLD2 IKJKEYWD                                                       01021000
         IKJNAME    'T'                                                 01022000
CODEFLD3 IKJKEYWD                                                       01023000
         IKJNAME    'W'                                                 01024000
CODEFLD4 IKJKEYWD                                                       01025000
         IKJNAME    'Q'                                                 01026000
CODEFLD5 IKJKEYWD                                                       01027000
         IKJNAME    'A'                                                 01028000
CODEFLD6 IKJKEYWD                                                       01029000
         IKJNAME    'B'                                                 01030000
CODEFLD7 IKJKEYWD                                                       01031000
         IKJNAME    'E'                                                 01032000
CODEFLD8 IKJKEYWD                                                       01033000
         IKJNAME    'F'                                                 01034000
CODEFLD9 IKJKEYWD                                                       01035000
         IKJNAME    'H'                                                 01036000
CODEFL10 IKJKEYWD                                                       01037000
         IKJNAME    'Z'                                                 01038000
CODEFL11 IKJKEYWD                                                       01039000
         IKJNAME    'R'                                                 01040000
DIAGNSS  IKJSUBF                                                        01041000
DIAGNFLD IKJKEYWD                                                       01042000
         IKJNAME    'TRACE'                                             01043000
ORGANIZA IKJSUBF                                                        01044000
ORGANFLD IKJKEYWD                                                       01045000
         IKJNAME    'DA'                                                01046000
         IKJNAME    'DAU'                                               01047000
         IKJNAME    'PO'                                                01048000
         IKJNAME    'POU'                                               01049000
         IKJNAME    'PS'                                                01050000
         IKJNAME    'PSU'                                               01051000
FORMAT   IKJSUBF                                                        01052000
FORMFLD1 IKJKEYWD                                                       01053000
         IKJNAME    'A'                                                 01054000
FORMFLD2 IKJKEYWD                                                       01055000
         IKJNAME    'B'                                                 01056000
FORMFLD3 IKJKEYWD                                                       01057000
         IKJNAME    'F'                                                 01058000
FORMFLD4 IKJKEYWD                                                       01059000
         IKJNAME    'M'                                                 01060000
FORMFLD5 IKJKEYWD                                                       01061000
         IKJNAME    'S'                                                 01062000
FORMFLD6 IKJKEYWD                                                       01063000
         IKJNAME    'T'                                                 01064000
FORMFLD7 IKJKEYWD                                                       01065000
         IKJNAME    'U'                                                 01066000
FORMFLD8 IKJKEYWD                                                       01067000
         IKJNAME    'V'                                                 01068000
FORMFLD9 IKJKEYWD                                                       01069000
         IKJNAME    'D'                                                 01070000
         IKJENDP                                                        01071000
ADCNATTR DC    A(IKJEFAT1)             ADDRESS OF PARSE PCL             01072000
*   GENERATE;                                                      0366 01073000
         DS   0F                                                        01074000
LISTB    EQU  *                        START ADDRESS STACK PARM LIST    01075000
STACKLST STACK MF=L                                                     01076000
LISTE    EQU  *                        END OF STACK LIST                01077000
*   GEN(EJECT);                                                    0367 01078000
*                                                                  0367 01079000
         EJECT                                                          01080000
*/********************************************************************/ 01081000
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR DEN         */ 01082000
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */ 01083000
*/*        FOR DEN.  THE RANGE OF VALUES IS FROM ZERO TO FOUR.       */ 01084000
*/*      . IF THE LIMIT IS EXCEEDED PARSE WILL PROMPT THE USER,      */ 01085000
*/*        OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */ 01086000
*/********************************************************************/ 01087000
*                                                                  0368 01088000
*DENSCK:                            /* ENTRY POINT FOR DENSITY NUMBER   01089000
*                                      VALIDITY CHECK EXIT ROUTINE   */ 01090000
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */ 01091000
         B     @PB00002                                            0368 01092000
DENSCK   STM   @14,@12,12(@13)                                     0368 01093000
*   RESPECIFY                                                      0369 01094000
*    (R1,                                                          0369 01095000
*     R7) RESTRICTED;               /* RESTRICT REGS 1,7 FOR MY USE  */ 01096000
*   GENERATE;                                                      0370 01097000
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS  01098000
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS    01099000
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA    01100000
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE    01101000
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES     01102000
    LR R13,R14                       NOW USE MY SAVE AREA               01103000
AEIGHTT  EQU 8                       OFFSET OF EIGHT                    01104000
AFOR     EQU 4                       OFFSET OF 4                        01105000
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */ 01106000
         ST    R1,VALPARMS                                         0371 01107000
*   R7=PDEADR;                      /* PARAMETERS                    */ 01108000
         L     @10,VALPARMS                                        0372 01109000
         L     R7,PDEADR(,@10)                                     0372 01110000
*   CALL CONVERT;                   /* GO CONVERT VALUE TO BINARY    */ 01111000
         BAL   @14,CONVERT                                         0373 01112000
*   CDENSITY=R1;                    /* SAVE THE CONVERTED DENSITY    */ 01113000
         ST    R1,CDENSITY                                         0374 01114000
*   IF CDENSITY>4 THEN              /* IF VALUE EXCEEDS FOUR         */ 01115000
         L     @10,CDENSITY                                        0375 01116000
         LA    @06,4                                               0375 01117000
         CR    @10,@06                                             0375 01118000
         BNH   @RF00375                                            0375 01119000
*     RTRNCODE=4;                   /* INDICATE A FAILING RETURN CODE*/ 01120000
         L     @10,RGSVAREA(,R13)                                  0376 01121000
         ST    @06,RTRNCODE(,@10)                                  0376 01122000
*   ELSE                            /* OTHERWISE                     */ 01123000
*     DO;                           /* DO THE FOLLOWING:             */ 01124000
         B     @RC00375                                            0377 01125000
@RF00375 DS    0H                                                  0378 01126000
*       RTRNCODE=0;                 /* INDICATE ACCEPTABLE VALUE     */ 01127000
         SLR   @10,@10                                             0378 01128000
         L     @06,RGSVAREA(,R13)                                  0378 01129000
         ST    @10,RTRNCODE(,@06)                                  0378 01130000
*       RFY                                                        0379 01131000
*         S99TUNIT BASED(ADBKPTR(3));/* PICK UP PROPER TEXT UNIT     */ 01132000
*       S99TUKEY=DALDEN;            /* FILL IN THE KEY FOR DENSITY   */ 01133000
         L     @06,GTPLPTR                                         0380 01134000
         L     @06,GTPLABLK(,@06)                                  0380 01135000
         L     @06,ADBKPTR+8(,@06)                                 0380 01136000
         MVC   S99TUKEY(2,@06),@CB00561                            0380 01137000
*       S99TUNUM=1;                 /* NUMBER OF LENGTH+PARM ENTRIES */ 01138000
         MVC   S99TUNUM(2,@06),@CH00033                            0381 01139000
*       S99TULNG=1;                 /* LENGTH OF FIRST PARM          */ 01140000
         MVC   S99TULNG(2,@06),@CH00033                            0382 01141000
*       IF CDENSITY=0 THEN          /* IS THE DENSITY EQUAL TO ZERO  */ 01142000
         C     @10,CDENSITY                                        0383 01143000
         BNE   @RF00383                                            0383 01144000
*         S99TUPAR(1)='03'X;        /* STORE PROPER KEY IN TEXT UNIT */ 01145000
         MVI   S99TUPAR(@06),X'03'                                 0384 01146000
*       ELSE                        /* NOT A DENSITY OF 0            */ 01147000
*         IF CDENSITY=1 THEN        /* IS THE DENSITY EQUAL TO ONE   */ 01148000
         B     @RC00383                                            0385 01149000
@RF00383 CLC   CDENSITY(4),@CF00033                                0385 01150000
         BNE   @RF00385                                            0385 01151000
*           S99TUPAR(1)='43'X;      /* STORE PROPER KEY IN TEXT UNIT */ 01152000
         L     @10,GTPLPTR                                         0386 01153000
         L     @10,GTPLABLK(,@10)                                  0386 01154000
         L     @10,ADBKPTR+8(,@10)                                 0386 01155000
         MVI   S99TUPAR(@10),X'43'                                 0386 01156000
*         ELSE                      /* NOT A DENSITY OF 0 OR 1       */ 01157000
*           IF CDENSITY=2 THEN      /* IS THE DENSITY EQUAL TO TWO   */ 01158000
         B     @RC00385                                            0387 01159000
@RF00385 CLC   CDENSITY(4),@CF00063                                0387 01160000
         BNE   @RF00387                                            0387 01161000
*             S99TUPAR(1)='83'X;    /* STORE PROPER KEY IN TEXT UNIT */ 01162000
         L     @10,GTPLPTR                                         0388 01163000
         L     @10,GTPLABLK(,@10)                                  0388 01164000
         L     @10,ADBKPTR+8(,@10)                                 0388 01165000
         MVI   S99TUPAR(@10),X'83'                                 0388 01166000
*           ELSE                    /* NOT A DENSITY OF 0, 1 OR 2    */ 01167000
*             IF CDENSITY=3 THEN    /* IS THE DENSITY EQUAL TO THREE */ 01168000
         B     @RC00387                                            0389 01169000
@RF00387 CLC   CDENSITY(4),@CF00293                                0389 01170000
         BNE   @RF00389                                            0389 01171000
*               S99TUPAR(1)='C3'X;  /* STORE PROPER KEY IN TEXT UNIT */ 01172000
         L     @10,GTPLPTR                                         0390 01173000
         L     @10,GTPLABLK(,@10)                                  0390 01174000
         L     @10,ADBKPTR+8(,@10)                                 0390 01175000
         MVI   S99TUPAR(@10),X'C3'                                 0390 01176000
*             ELSE                  /* NOT A DENSITY OF 0, 1, 2 OR 3 */ 01177000
*               S99TUPAR(1)='D3'X;  /* STORE PROPER KEY IN TEXT UNIT */ 01178000
         B     @RC00389                                            0391 01179000
@RF00389 L     @10,GTPLPTR                                         0391 01180000
         L     @10,GTPLABLK(,@10)                                  0391 01181000
         L     @10,ADBKPTR+8(,@10)                                 0391 01182000
         MVI   S99TUPAR(@10),X'D3'                                 0391 01183000
*     END;                          /* END ACCEPTABLE VALUE        0392 01184000
*                                      PROCESSING                    */ 01185000
@RC00389 DS    0H                                                  0392 01186000
@RC00387 DS    0H                                                  0392 01187000
@RC00385 DS    0H                                                  0392 01188000
@RC00383 DS    0H                                                  0393 01189000
*   RESPECIFY                                                      0393 01190000
*    (R1,                                                          0393 01191000
*     R7) UNRESTRICTED;             /* RELEASE REGS 1,7 FOR COMPILER */ 01192000
@RC00375 DS    0H                                                  0394 01193000
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */ 01194000
         L R13,SAVEAR01+AFOR                                            01195000
*   END;                            /* END OF DEN PARSE VALIDITY   0395 01196000
*                                      CHECK EXIT                    */ 01197000
@EL00002 DS    0H                                                  0395 01198000
@EF00002 DS    0H                                                  0395 01199000
@ER00002 LM    @14,@12,12(@13)                                     0395 01200000
         BR    @14                                                 0395 01201000
@PB00002 DS    0H                                                  0396 01202000
*   GEN(EJECT);                                                    0396 01203000
*                                                                  0396 01204000
         EJECT                                                          01205000
*/********************************************************************/ 01206000
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR BUFL,       */ 01207000
*/*  BLKSIZE, AND LIMCT.                                             */ 01208000
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */ 01209000
*/*        FOR BUFL, LIMCT, AND BLKSIZE. THE MAXIMUM VALUE IS 32,760.*/ 01210000
*/*      . IF THE LIMIT IS EXCEEDED PARSE WILL PROMPT THE USER,      */ 01211000
*/*        OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */ 01212000
*/********************************************************************/ 01213000
*                                                                  0397 01214000
*BLKBUFCK:                          /* ENTRY POINT FOR BUFLN, LIMCT,    01215000
*                                      AND BLKSIZE VALUE VALIDITY  0397 01216000
*                                      CHECK EXIT ROUTINE            */ 01217000
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */ 01218000
         B     @PB00003                                            0397 01219000
BLKBUFCK STM   @14,@12,12(@13)                                     0397 01220000
*   RESPECIFY                                                      0398 01221000
*    (R1,                                                          0398 01222000
*     R7) RESTRICTED;               /* RESTRICT REGS 1,7 FOR MY USE  */ 01223000
*   GENERATE;                                                      0399 01224000
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS  01225000
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS    01226000
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA    01227000
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE    01228000
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES     01229000
    LR R13,R14                       NOW USE MY SAVE AREA               01230000
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */ 01231000
         ST    R1,VALPARMS                                         0400 01232000
*   R7=PDEADR;                      /* PARAMETERS                    */ 01233000
         L     @10,VALPARMS                                        0401 01234000
         L     R7,PDEADR(,@10)                                     0401 01235000
*   CALL CONVERT;                   /* GO CONVERT VALUE TO BINARY    */ 01236000
         BAL   @14,CONVERT                                         0402 01237000
*   IF R1>32760 THEN                /* IF VALUE EXCEEDS 32,760       */ 01238000
         CH    R1,@CH00908                                         0403 01239000
         BNH   @RF00403                                            0403 01240000
*     RTRNCODE=4;                   /* INDICATE A FAILING RETURN CODE*/ 01241000
         L     @10,RGSVAREA(,R13)                                  0404 01242000
         MVC   RTRNCODE(4,@10),@CF00266                            0404 01243000
*   ELSE                            /* OTHERWISE                     */ 01244000
*     RTRNCODE=0;                   /* INDICATE ACCEPTABLE VALUE     */ 01245000
         B     @RC00403                                            0405 01246000
@RF00403 L     @10,RGSVAREA(,R13)                                  0405 01247000
         SLR   @06,@06                                             0405 01248000
         ST    @06,RTRNCODE(,@10)                                  0405 01249000
*   RESPECIFY                                                      0406 01250000
*    (R1,                                                          0406 01251000
*     R7) UNRESTRICTED;             /* RELEASE REGS 1,7 FOR COMPILER */ 01252000
@RC00403 DS    0H                                                  0407 01253000
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */ 01254000
         L R13,SAVEAR01+AFOR                                            01255000
*   END;                            /* END BUFL, LIMCT, AND BLKSIZE     01256000
*                                      PARSE VALIDITY CHECK EXIT     */ 01257000
@EL00003 DS    0H                                                  0408 01258000
@EF00003 DS    0H                                                  0408 01259000
@ER00003 LM    @14,@12,12(@13)                                     0408 01260000
         BR    @14                                                 0408 01261000
@PB00003 DS    0H                                                  0409 01262000
*   GEN(EJECT);                                                    0409 01263000
*                                                                  0409 01264000
         EJECT                                                          01265000
*/********************************************************************/ 01266000
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR KEYLEN      */ 01267000
*/*  AND BUFNO SUBFIELDS.                                            */ 01268000
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */ 01269000
*/*        FOR KEYLEN OR BUFNO. THE MAXIMUM VALUE IS 255.            */ 01270000
*/*      . IF THE LIMIT IS EXCEEDED PARSE WILL PROMPT THE USER,      */ 01271000
*/*        OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */ 01272000
*/********************************************************************/ 01273000
*                                                                  0410 01274000
*KEYBUFCK:                          /* ENTRY POINT FOR KEYLEN AND  0410 01275000
*                                      BUFNO VALUE VALIDITY CHECK  0410 01276000
*                                      EXIT ROUTINE                  */ 01277000
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */ 01278000
         B     @PB00004                                            0410 01279000
KEYBUFCK STM   @14,@12,12(@13)                                     0410 01280000
*   GENERATE;                                                      0411 01281000
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS  01282000
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS    01283000
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA    01284000
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE    01285000
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES     01286000
    LR R13,R14                       NOW USE MY SAVE AREA               01287000
*   RESPECIFY                                                      0412 01288000
*    (R1,                                                          0412 01289000
*     R7) RESTRICTED;               /* RESTRICT REGS 1,7 FOR MY USE  */ 01290000
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */ 01291000
         ST    R1,VALPARMS                                         0413 01292000
*   R7=PDEADR;                      /* PARAMETERS                    */ 01293000
         L     @10,VALPARMS                                        0414 01294000
         L     R7,PDEADR(,@10)                                     0414 01295000
*   CALL CONVERT;                   /* CONVERT VALUE TO BINARY       */ 01296000
         BAL   @14,CONVERT                                         0415 01297000
*   IF R1>255 THEN                  /* IF VALUE EXCEEDS 255          */ 01298000
         CH    R1,@CH00913                                         0416 01299000
         BNH   @RF00416                                            0416 01300000
*     RTRNCODE=4;                   /* INDICATE A FAILING RETURN CODE*/ 01301000
         L     @10,RGSVAREA(,R13)                                  0417 01302000
         MVC   RTRNCODE(4,@10),@CF00266                            0417 01303000
*   ELSE                            /* OTHERWISE                     */ 01304000
*     RTRNCODE=0;                   /* INDICATE ACCEPT VALUE         */ 01305000
         B     @RC00416                                            0418 01306000
@RF00416 L     @10,RGSVAREA(,R13)                                  0418 01307000
         SLR   @06,@06                                             0418 01308000
         ST    @06,RTRNCODE(,@10)                                  0418 01309000
*   RESPECIFY                                                      0419 01310000
*    (R1,                                                          0419 01311000
*     R7) UNRESTRICTED;             /* RELEASE REG 1,7 FOR COMPILER  */ 01312000
@RC00416 DS    0H                                                  0420 01313000
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */ 01314000
         L R13,SAVEAR01+AFOR                                            01315000
*   END;                            /* END OF KEYLNCK AND BUFNO PARSE   01316000
*                                      VALIDITY CHECK EXIT           */ 01317000
@EL00004 DS    0H                                                  0421 01318000
@EF00004 DS    0H                                                  0421 01319000
@ER00004 LM    @14,@12,12(@13)                                     0421 01320000
         BR    @14                                                 0421 01321000
@PB00004 DS    0H                                                  0422 01322000
*   GEN(EJECT);                                                    0422 01323000
*                                                                  0422 01324000
         EJECT                                                          01325000
*/********************************************************************/ 01326000
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR LRECL.      */ 01327000
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */ 01328000
*/*        FOR LRECL. MAXIMUM VALUE IS 32,760 UNLESS LRECL(X) IS     */ 01329000
*/*        SPECIFIED.                                                */ 01330000
*/*      . IF THE LIMIT IS EXCEEDED  OR AN X IS NOT SPECIFIED, THEN  */ 01331000
*/*        PARSE WILL PROMPT THE USER, OTHERWISE, THE VALUE WILL BE  */ 01332000
*/*        ACCEPTED.                                                 */ 01333000
*/********************************************************************/ 01334000
*                                                                  0423 01335000
*LRECLCK:                           /* ENTRY POINT FOR LRECL VALUE 0423 01336000
*                                      VALIDITY CHECK EXIT ROUTINE   */ 01337000
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */ 01338000
         B     @PB00005                                            0423 01339000
LRECLCK  STM   @14,@12,12(@13)                                     0423 01340000
*   RESPECIFY                                                      0424 01341000
*    (R1,                                                          0424 01342000
*     R7) RESTRICTED;               /* RESTRICT REG 1,7 FOR MY USE   */ 01343000
*   GENERATE;                                                      0425 01344000
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS  01345000
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS    01346000
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA    01347000
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE    01348000
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES     01349000
    LR R13,R14                       NOW USE MY SAVE AREA               01350000
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */ 01351000
         ST    R1,VALPARMS                                         0426 01352000
*   R7=PDEADR;                      /* PARAMETERS                    */ 01353000
         L     @10,VALPARMS                                        0427 01354000
         L     R7,PDEADR(,@10)                                     0427 01355000
*   IF LRECLX=CHARX THEN            /* TEST FOR CHAR X               */ 01356000
         L     @10,VALUEPTR(,R7)                                   0428 01357000
         CLC   LRECLX(1,@10),CHARX                                 0428 01358000
         BNE   @RF00428                                            0428 01359000
*     DO;                           /* X IS SPECIFIED IN THE FIRST   */ 01360000
*       IF VALUELEN=1 THEN          /* POSITION, IS THAT ALL?        */ 01361000
         CLC   VALUELEN(2,R7),@CH00033                             0430 01362000
         BNE   @RF00430                                            0430 01363000
*         DO;                       /* ONLY AN "X" WAS SPECIFIED SO  */ 01364000
*           RFY                                                    0432 01365000
*             S99TUNIT BASED(ADBKPTR(4));/* PICK UP THE RIGHT TEXT 0432 01366000
*                                      UNIT                          */ 01367000
*           S99TUKEY=DALLRECL;      /* FILL IN THE KEY FOR LRECL     */ 01368000
         L     @10,GTPLPTR                                         0433 01369000
         L     @10,GTPLABLK(,@10)                                  0433 01370000
         L     @10,ADBKPTR+12(,@10)                                0433 01371000
         MVC   S99TUKEY(2,@10),@CB00575                            0433 01372000
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */ 01373000
         MVC   S99TUNUM(2,@10),@CH00033                            0434 01374000
*           S99TULNG=2;             /* LENGTH OF FIRST PARM          */ 01375000
         MVC   S99TULNG(2,@10),@CH00063                            0435 01376000
*           S99TUPAR(1:2)='8000'X;  /* STORE GIVEN VALUE IN TEXT UNIT*/ 01377000
         MVC   S99TUPAR(2,@10),@CB00920                            0436 01378000
*           RTRNCODE=0;             /* ACCEPT VALUE RETURN CODE      */ 01379000
         L     @10,RGSVAREA(,R13)                                  0437 01380000
         SLR   @06,@06                                             0437 01381000
         ST    @06,RTRNCODE(,@10)                                  0437 01382000
*         END;                      /* CHECK NEXT FIELD              */ 01383000
*       ELSE                        /* "X" IN FIRST CHAR BUT FIELD   */ 01384000
*         RTRNCODE=4;               /* IS TOO LONG, SO SET A RETURN  */ 01385000
         B     @RC00430                                            0439 01386000
@RF00430 L     @10,RGSVAREA(,R13)                                  0439 01387000
         MVC   RTRNCODE(4,@10),@CF00266                            0439 01388000
*     END;                          /* CODE FOR PARSE AND RETURN     */ 01389000
*   ELSE                            /* OTHERWISE, NO X WAS SPECIFIED */ 01390000
*     DO;                           /* CHECK TO SEE THAT THE FIRST   */ 01391000
         B     @RC00428                                            0441 01392000
@RF00428 DS    0H                                                  0442 01393000
*       IF HALFLREC^='1111'B THEN   /* CHARACTER IS NUMERIC          */ 01394000
         L     @10,VALUEPTR(,R7)                                   0442 01395000
         TM    HALFLREC(@10),B'11110000'                           0442 01396000
         BO    @RF00442                                            0442 01397000
*         RTRNCODE=4;               /* SET ERROR RETURN CODE         */ 01398000
         L     @10,RGSVAREA(,R13)                                  0443 01399000
         MVC   RTRNCODE(4,@10),@CF00266                            0443 01400000
*       ELSE                        /* OTHERWISE, IT WAS NUMERIC SO  */ 01401000
*         DO;                       /* DO THE FOLLOWING:             */ 01402000
         B     @RC00442                                            0444 01403000
@RF00442 DS    0H                                                  0445 01404000
*           CALL CONVERT;           /* CONVERT VALUE TO BINARY       */ 01405000
         BAL   @14,CONVERT                                         0445 01406000
*           IF R1>32760 THEN        /* SEE IF GREATER THAN 32760     */ 01407000
         CH    R1,@CH00908                                         0446 01408000
         BNH   @RF00446                                            0446 01409000
*             RTRNCODE=4;           /* YES, INDICATE BAD RETURN CODE */ 01410000
         L     @10,RGSVAREA(,R13)                                  0447 01411000
         MVC   RTRNCODE(4,@10),@CF00266                            0447 01412000
*           ELSE                    /* OTHERWISE THE VALUE IS WITHIN */ 01413000
*             DO;                   /* THE VALID NUMERIC RANGE       */ 01414000
         B     @RC00446                                            0448 01415000
@RF00446 DS    0H                                                  0449 01416000
*               RTRNCODE=0;         /* INDICATE ACCEPT VALUE         */ 01417000
         L     @10,RGSVAREA(,R13)                                  0449 01418000
         SLR   @06,@06                                             0449 01419000
         ST    @06,RTRNCODE(,@10)                                  0449 01420000
*               RFY                                                0450 01421000
*                 S99TUNIT BASED(ADBKPTR(4));/* PICK UP THE RIGHT  0450 01422000
*                                      TEXT UNIT                     */ 01423000
*               S99TUKEY=DALLRECL;  /* FILL IN THE KEY FOR LRECL     */ 01424000
         L     @10,GTPLPTR                                         0451 01425000
         L     @10,GTPLABLK(,@10)                                  0451 01426000
         L     @10,ADBKPTR+12(,@10)                                0451 01427000
         MVC   S99TUKEY(2,@10),@CB00575                            0451 01428000
*               S99TUNUM=1;         /* NUMBER OF LENGTH+PARM ENTRIES */ 01429000
         MVC   S99TUNUM(2,@10),@CH00033                            0452 01430000
*               S99TULNG=2;         /* LENGTH OF FIRST PARM          */ 01431000
         MVC   S99TULNG(2,@10),@CH00063                            0453 01432000
*               S99TUPAR(1:2)=R1;   /* PLACE GIVEN VALUE INTO TEXT   */ 01433000
         ST    R1,@TF00001                                         0454 01434000
         MVC   S99TUPAR(2,@10),@TF00001+2                          0454 01435000
*             END;                  /* RETURN TO PARSE               */ 01436000
*         END;                      /* END VALID NUMERIC TESTING     */ 01437000
@RC00446 DS    0H                                                  0457 01438000
*     END;                          /* END OF ALL NUMERIC TESTING    */ 01439000
@RC00442 DS    0H                                                  0458 01440000
*   RESPECIFY                                                      0458 01441000
*    (R1,                                                          0458 01442000
*     R7) UNRESTRICTED;             /* RELEASE REG 1.7 FOR COMPILER  */ 01443000
@RC00428 DS    0H                                                  0459 01444000
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */ 01445000
         L R13,SAVEAR01+AFOR                                            01446000
*   END;                            /* END OF LRECL PARSE VALIDITY 0460 01447000
*                                      CHECK EXIT                    */ 01448000
@EL00005 DS    0H                                                  0460 01449000
@EF00005 DS    0H                                                  0460 01450000
@ER00005 LM    @14,@12,12(@13)                                     0460 01451000
         BR    @14                                                 0460 01452000
@PB00005 DS    0H                                                  0461 01453000
*   GEN(EJECT);                                                    0461 01454000
*                                                                  0461 01455000
         EJECT                                                          01456000
*/********************************************************************/ 01457000
*/*  PARSE VALIDITY CHECK ROUTINE FOR EXPDT.                         */ 01458000
*/*      . THIS ROUTINE PERFORMS CHECKING ON VALUES SUPPLIED FOR     */ 01459000
*/*        EXPDT. THE VALUE MUST BE 5 CHARACTERS.                    */ 01460000
*/*      . THE DAY VALUE MUST BE LESS THAN 366.                      */ 01461000
*/*      . IF THE LENGTH IS LESS THAN 5 OR THE DAY VALUE IS          */ 01462000
*/*        INVALID, PARSE WILL PROMPT THE USER.                      */ 01463000
*/*      . OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */ 01464000
*/********************************************************************/ 01465000
*                                                                  0462 01466000
*EXPDTCK:                           /* ENTRY POINT FOR EXPDT VALUE 0462 01467000
*                                      VALIDITY CHECK EXIT ROUTINE   */ 01468000
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */ 01469000
         B     @PB00006                                            0462 01470000
EXPDTCK  STM   @14,@12,12(@13)                                     0462 01471000
*   RESPECIFY                                                      0463 01472000
*    (R1,                                                          0463 01473000
*     R5,                                                          0463 01474000
*     R7) RSTD;                     /* RESTRICT R1,R5,R7 FOR MY USE  */ 01475000
*   GENERATE;                                                      0464 01476000
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS  01477000
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS    01478000
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA    01479000
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE    01480000
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES     01481000
    LR R13,R14                       NOW USE MY SAVE AREA               01482000
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */ 01483000
         ST    R1,VALPARMS                                         0465 01484000
*   R7=PDEADR;                      /* PARAMETERS                    */ 01485000
         L     @10,VALPARMS                                        0466 01486000
         L     R7,PDEADR(,@10)                                     0466 01487000
*   IF VALUELEN<5 THEN              /* IF EXPDT IS LESS THAN 5       */ 01488000
         LH    @10,VALUELEN(,R7)                                   0467 01489000
         CH    @10,@CH00250                                        0467 01490000
         BNL   @RF00467                                            0467 01491000
*     RTRNCODE=4;                   /* INDICATE FAILING RETURN CODE  */ 01492000
         L     @10,RGSVAREA(,R13)                                  0468 01493000
         MVC   RTRNCODE(4,@10),@CF00266                            0468 01494000
*   ELSE                            /* OTHERWISE, LENGTH IS CORRECT  */ 01495000
*     DO;                           /* SO DO THE FOLLOWING           */ 01496000
         B     @RC00467                                            0469 01497000
@RF00467 DS    0H                                                  0470 01498000
*       R5=2;                       /* ONLY CONVERT DAYS NOT YEAR    */ 01499000
         LA    @10,2                                               0470 01500000
         LR    R5,@10                                              0470 01501000
*       R1=VALUEPTR+2;              /* YEAR MAY GO TO 99             */ 01502000
         AL    @10,VALUEPTR(,R7)                                   0471 01503000
         LR    R1,@10                                              0471 01504000
*       CALL CONVERTA;              /* CONVERT DAYS TO BINARY        */ 01505000
         BAL   @14,CONVERTA                                        0472 01506000
*       IF R1>366|R1=0              /* IF VALUE EXCEEDS 366 DAYS     */ 01507000
*         THEN                      /* OR 0 DAYS             @ZA19313*/ 01508000
         CH    R1,@CH00928                                         0473 01509000
         BH    @RT00473                                            0473 01510000
         LTR   R1,R1                                               0473 01511000
         BNZ   @RF00473                                            0473 01512000
@RT00473 DS    0H                                                  0474 01513000
*         RTRNCODE=4;               /* INDICATE FAILING RETURN CODE  */ 01514000
         L     @10,RGSVAREA(,R13)                                  0474 01515000
         MVC   RTRNCODE(4,@10),@CF00266                            0474 01516000
*       ELSE                        /* VALUE IS ACCEPTABLE           */ 01517000
*         DO;                       /* SO DO THE FOLLOWING:          */ 01518000
         B     @RC00473                                            0475 01519000
@RF00473 DS    0H                                                  0476 01520000
*           RTRNCODE=0;             /* INDICATE ACCEPT VALUE         */ 01521000
         L     @10,RGSVAREA(,R13)                                  0476 01522000
         SLR   @06,@06                                             0476 01523000
         ST    @06,RTRNCODE(,@10)                                  0476 01524000
*           RFY                                                    0477 01525000
*             S99TUNIT BASED(ADBKPTR(5));/* PICK UP THE RIGHT TEXT 0477 01526000
*                                      UNIT                          */ 01527000
*           S99TUKEY=DALEXPDT;      /* FILL IN THE KEY FOR EXPDT     */ 01528000
         L     @10,GTPLPTR                                         0478 01529000
         L     @10,GTPLABLK(,@10)                                  0478 01530000
         L     @10,ADBKPTR+16(,@10)                                0478 01531000
         MVC   S99TUKEY(2,@10),@CB00511                            0478 01532000
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */ 01533000
         MVC   S99TUNUM(2,@10),@CH00033                            0479 01534000
*           S99TULNG=5;             /* LENGTH OF FIRST PARM          */ 01535000
         MVC   S99TULNG(2,@10),@CH00250                            0480 01536000
*           S99TUPAR(1:5)=VALNAME(1:5);/* STORE VALUE                */ 01537000
         L     @06,VALUEPTR(,R7)                                   0481 01538000
         MVC   S99TUPAR(5,@10),VALNAME(@06)                        0481 01539000
*         END;                      /* END OF VALID DATE PROCESSING  */ 01540000
*     END;                          /* END OF EXPDT DATE PROCESSING  */ 01541000
@RC00473 DS    0H                                                  0484 01542000
*   RESPECIFY                                                      0484 01543000
*    (R1,                                                          0484 01544000
*     R5,                                                          0484 01545000
*     R7) UNRSTD;                   /* RELEASE REG 7,1,5 FOR COMPILER*/ 01546000
@RC00467 DS    0H                                                  0485 01547000
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */ 01548000
         L R13,SAVEAR01+AFOR                                            01549000
*   END;                            /* END OF EXPDT PARSE VALIDITY 0486 01550000
*                                      CHECK EXIT                    */ 01551000
@EL00006 DS    0H                                                  0486 01552000
@EF00006 DS    0H                                                  0486 01553000
@ER00006 LM    @14,@12,12(@13)                                     0486 01554000
         BR    @14                                                 0486 01555000
@PB00006 DS    0H                                                  0487 01556000
*   GEN(EJECT);                                                    0487 01557000
*                                                                  0487 01558000
         EJECT                                                          01559000
*/********************************************************************/ 01560000
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR BUFOFF.     */ 01561000
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */ 01562000
*/*        FOR BUFOFF. MAXIMUM VALUE IS 99 UNLESS BUFOFF(L) IS       */ 01563000
*/*        SPECIFIED.                                                */ 01564000
*/*      . IF THE LIMIT IS EXCEEDED OR AN L IS NOT SPECIFIED, THEN   */ 01565000
*/*        PARSE WILL PROMPT THE USER, OTHERWISE, THE VALUE WILL BE  */ 01566000
*/*        ACCEPTED.                                                 */ 01567000
*/********************************************************************/ 01568000
*                                                                  0488 01569000
*BUFCK:                             /* ENTRY POINT FOR BUFOFF VALUE     01570000
*                                      VALIDITY CHECK EXIT ROUTINE   */ 01571000
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */ 01572000
         B     @PB00007                                            0488 01573000
BUFCK    STM   @14,@12,12(@13)                                     0488 01574000
*   RESPECIFY                                                      0489 01575000
*    (R1,                                                          0489 01576000
*     R7) RESTRICTED;               /* RESTRICT REG 1,7 FOR MY USE   */ 01577000
*   GENERATE;                                                      0490 01578000
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS  01579000
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS    01580000
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA    01581000
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE    01582000
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES     01583000
    LR R13,R14                       NOW USE MY SAVE AREA               01584000
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */ 01585000
         ST    R1,VALPARMS                                         0491 01586000
*   R7=PDEADR;                      /* PARAMETERS                    */ 01587000
         L     @10,VALPARMS                                        0492 01588000
         L     R7,PDEADR(,@10)                                     0492 01589000
*   IF BUFOFFL=CHARL THEN           /* TEST FOR CHAR L               */ 01590000
         L     @10,VALUEPTR(,R7)                                   0493 01591000
         CLC   BUFOFFL(1,@10),CHARL                                0493 01592000
         BNE   @RF00493                                            0493 01593000
*     DO;                           /* L IS SPECIFIED IN THE FIRST   */ 01594000
*       IF VALUELEN=1 THEN          /* POSITION, IS THAT ALL?        */ 01595000
         CLC   VALUELEN(2,R7),@CH00033                             0495 01596000
         BNE   @RF00495                                            0495 01597000
*         DO;                       /* ONLY AN "N" WAS SPECIFIED SO  */ 01598000
*           RFY                                                    0497 01599000
*             S99TUNIT BASED(ADBKPTR(6));/* PICK UP THE RIGHT TEXT 0497 01600000
*                                      UNIT                          */ 01601000
*           S99TUKEY=DALBUFOF;      /* FILL IN THE KEY FOR BUFOFF    */ 01602000
         L     @10,GTPLPTR                                         0498 01603000
         L     @10,GTPLABLK(,@10)                                  0498 01604000
         L     @10,ADBKPTR+20(,@10)                                0498 01605000
         MVC   S99TUKEY(2,@10),@CB00549                            0498 01606000
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */ 01607000
         MVC   S99TUNUM(2,@10),@CH00033                            0499 01608000
*           S99TULNG=1;             /* LENGTH OF FIRST PARM          */ 01609000
         MVC   S99TULNG(2,@10),@CH00033                            0500 01610000
*           S99TUPAR(1)='80'X;      /* STORE GIVEN VALUE IN TEXT UNIT*/ 01611000
         MVI   S99TUPAR(@10),X'80'                                 0501 01612000
*           RTRNCODE=0;             /* ACCEPT VALUE                  */ 01613000
         L     @10,RGSVAREA(,R13)                                  0502 01614000
         SLR   @06,@06                                             0502 01615000
         ST    @06,RTRNCODE(,@10)                                  0502 01616000
*         END;                      /* CHECK NEXT FIELD              */ 01617000
*       ELSE                        /* "L" IN FIRST CHAR BUT FIELD   */ 01618000
*         RTRNCODE=4;               /* IS TOO LONG, SO SET A RETURN  */ 01619000
         B     @RC00495                                            0504 01620000
@RF00495 L     @10,RGSVAREA(,R13)                                  0504 01621000
         MVC   RTRNCODE(4,@10),@CF00266                            0504 01622000
*     END;                          /* FOR PARSE AND RETURN          */ 01623000
*   ELSE                            /* OTHERWISE,NO L WAS SPECIFIED  */ 01624000
*     DO;                           /* CHECK TO SEE THAT THE FIRST   */ 01625000
         B     @RC00493                                            0506 01626000
@RF00493 DS    0H                                                  0507 01627000
*       IF HALFLREC^='1111'B THEN   /* CHARACTER IS NUMERIC          */ 01628000
         L     @10,VALUEPTR(,R7)                                   0507 01629000
         TM    HALFLREC(@10),B'11110000'                           0507 01630000
         BO    @RF00507                                            0507 01631000
*         RTRNCODE=4;               /* SET ERROR RETURN CODE         */ 01632000
         L     @10,RGSVAREA(,R13)                                  0508 01633000
         MVC   RTRNCODE(4,@10),@CF00266                            0508 01634000
*       ELSE                        /* OTHERWISE, IT WAS NUMERIC SO  */ 01635000
*         DO;                       /* DO THE FOLLOWING:             */ 01636000
         B     @RC00507                                            0509 01637000
@RF00507 DS    0H                                                  0510 01638000
*           CALL CONVERT;           /* CONVERT VALUE TO BINARY       */ 01639000
         BAL   @14,CONVERT                                         0510 01640000
*           RTRNCODE=0;             /* INDICATE ACCEPT VALUE         */ 01641000
         L     @10,RGSVAREA(,R13)                                  0511 01642000
         SLR   @06,@06                                             0511 01643000
         ST    @06,RTRNCODE(,@10)                                  0511 01644000
*           RFY                                                    0512 01645000
*             S99TUNIT BASED(ADBKPTR(6));/* PICK UP THE RIGHT TEXT 0512 01646000
*                                      UNIT                          */ 01647000
*           S99TUKEY=DALBUFOF;      /* FILL IN THE KEY FOR BUFOFF    */ 01648000
         L     @10,GTPLPTR                                         0513 01649000
         L     @10,GTPLABLK(,@10)                                  0513 01650000
         L     @10,ADBKPTR+20(,@10)                                0513 01651000
         MVC   S99TUKEY(2,@10),@CB00549                            0513 01652000
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */ 01653000
         MVC   S99TUNUM(2,@10),@CH00033                            0514 01654000
*           S99TULNG=1;             /* LENGTH OF FIRST PARM          */ 01655000
         MVC   S99TULNG(2,@10),@CH00033                            0515 01656000
*           S99TUPAR(1)=R1;         /* STORE GIVEN VALUE IN TEXT UNIT*/ 01657000
         STC   R1,S99TUPAR(,@10)                                   0516 01658000
*         END;                      /* END VALID NUMERIC TESTING     */ 01659000
*     END;                          /* END OF ALL NUMERIC TESTING    */ 01660000
@RC00507 DS    0H                                                  0519 01661000
*   RESPECIFY                                                      0519 01662000
*    (R1,                                                          0519 01663000
*     R7) UNRESTRICTED;             /* RELEASE REG 7,1 FOR COMPILER  */ 01664000
@RC00493 DS    0H                                                  0520 01665000
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */ 01666000
         L R13,SAVEAR01+AFOR                                            01667000
*   END;                            /* END OF BUFOFF PARSE VALIDITY     01668000
*                                      CHECK EXIT                    */ 01669000
@EL00007 DS    0H                                                  0521 01670000
@EF00007 DS    0H                                                  0521 01671000
@ER00007 LM    @14,@12,12(@13)                                     0521 01672000
         BR    @14                                                 0521 01673000
@PB00007 DS    0H                                                  0522 01674000
*   GEN(EJECT);                                                    0522 01675000
*                                                                  0522 01676000
         EJECT                                                          01677000
*/********************************************************************/ 01678000
*/*  ATTR-LIST-NAME PARSE VALIDITY CHECK EXIT ROUTINE.               */ 01679000
*/*     . SETS UP INTERFACE WITH DYNAMIC ALLOCATION TO DETERMINE     */ 01680000
*/*       IF THE ATTR-LIST-NAME IS UNIQUE.                           */ 01681000
*/*     . IF DYNAMIC ALLOCATION DOES NOT FIND THE ATTR-LIST-NAME     */ 01682000
*/*       THEN A SUCCESSFUL RETURN CODE WILL BE RETURNED TO PARSE.   */ 01683000
*/*     . IF DYNAMIC ALLOCATION FIND A MATCH TO THE ATTR-LIST-       */ 01684000
*/*       NAME THEN A RETURN CODE WILL BE PASSED TO PARSE INDICAT-   */ 01685000
*/*       ING TO WRITE AN ERROR MESSAGE TO THE USER AND PROMPT FOR   */ 01686000
*/*       A NEW NAME.                                                */ 01687000
*/********************************************************************/ 01688000
*                                                                  0523 01689000
*ATTRNMCK:                          /* ENTRY POINT FOR ATTR-LIST-NAME   01690000
*                                      VALIDITY CHECK EXIT ROUTINE   */ 01691000
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */ 01692000
         B     @PB00008                                            0523 01693000
ATTRNMCK STM   @14,@12,12(@13)                                     0523 01694000
*   RESPECIFY                                                      0524 01695000
*    (R1,                                                          0524 01696000
*     R7) RESTRICTED;               /* RESTRICT REG 1,7 FOR MY USE   */ 01697000
*   GENERATE;                                                      0525 01698000
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS  01699000
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS    01700000
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA    01701000
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE    01702000
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES     01703000
    LR R13,R14                       NOW USE MY SAVE AREA               01704000
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */ 01705000
         ST    R1,VALPARMS                                         0526 01706000
*   R7=PDEADR;                      /* PARAMETERS                    */ 01707000
         L     @10,VALPARMS                                        0527 01708000
         L     R7,PDEADR(,@10)                                     0527 01709000
*   S99RBPTR=ADDR(S99RB);           /* ADDRESS OF THE REQUEST BLOCK  */ 01710000
         LA    @10,S99RB                                           0528 01711000
         ST    @10,S99RBPTR                                        0528 01712000
*   S99RBPND='1'B;                  /* INDICATE THE END OF THIS LIST */ 01713000
         OI    S99RBPND,B'10000000'                                0529 01714000
*   S99RB=S99RB&&S99RB;             /* ZERO OUT THE REQUEST BLOCK    */ 01715000
         XC    S99RB(20),S99RB                                     0530 01716000
*   S99TXTPP=ADDR(ATNMCORE);        /* POINTER TO THE POINTERS TO THE   01717000
*                                      TEXT UNITS                    */ 01718000
         LA    @10,ATNMCORE                                        0531 01719000
         ST    @10,S99TXTPP                                        0531 01720000
*   RFY                                                            0532 01721000
*     S99TUP BASED(S99TXTPP);       /* GET ADDRESSIBILITY TO THE   0532 01722000
*                                      RIGHT TEXT UNIT POINTER       */ 01723000
*   S99TUP=ADDR(ATNMCORE)+4;        /* ADDRESSIBILITY TO THE CORE    */ 01724000
         LA    @06,4                                               0533 01725000
         ALR   @06,@10                                             0533 01726000
         ST    @06,S99TUP(,@10)                                    0533 01727000
*   S99TUPND='1'B;                  /* SET THE HIGH ORDER BIT ON     */ 01728000
         OI    S99TUPND(@10),B'10000000'                           0534 01729000
*   RFY                                                            0535 01730000
*     S99TUNIT BASED(S99TUP);       /* GET ADDRESSIBILITY TO THE TEXT   01731000
*                                      UNIT                          */ 01732000
*   S99TUKEY=DINDDNAM;              /* SET THE PROPER TEXT KEY       */ 01733000
         L     @10,S99TUP(,@10)                                    0536 01734000
         MVC   S99TUKEY(2,@10),@CB00445                            0536 01735000
*   S99TUNUM=1;                     /* TEXT NUMBER OF ONE            */ 01736000
         MVC   S99TUNUM(2,@10),@CH00033                            0537 01737000
*   S99TULNG=VALUELEN;              /* LENGTH OF PARM FIELD          */ 01738000
         LH    @06,VALUELEN(,R7)                                   0538 01739000
         ST    @06,@TF00001                                        0538 01740000
         MVC   S99TULNG(2,@10),@TF00001+2                          0538 01741000
*   S99TUPAR(1:VALUELEN)=VALNAME(1:VALUELEN);/* MOVE THE NAME IN     */ 01742000
         BCTR  @06,0                                               0539 01743000
         L     @15,VALUEPTR(,R7)                                   0539 01744000
         EX    @06,@SM00953                                        0539 01745000
*   S99RBLN=LENGTH(S99RB);          /* LENGTH OF THE REQUEST BLOCK   */ 01746000
         MVI   S99RBLN,X'14'                                       0540 01747000
*   S99VERB=S99VRBIN;               /* FUNCTION TO BE PERFORMED      */ 01748000
         MVI   S99VERB,X'07'                                       0541 01749000
*   R1=ADDR(S99RBPTR);              /* ADDRESS OF POINTER TO RB      */ 01750000
         LA    R1,S99RBPTR                                         0542 01751000
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */ 01752000
*    (R15) RESTRICTED;              /* RESTRICT RETURN CODE REG      */ 01753000
*                                                                  0543 01754000
*   /*****************************************************************/ 01755000
*   /*                                                               */ 01756000
*   /* MACDATE Y-2 73082                                             */ 01757000
*   /*                                                               */ 01758000
*   /*****************************************************************/ 01759000
*                                                                  0544 01760000
*   SVC(99);                        /* SVC 99 TO CHECK THE ATTR-LIST    01761000
*                                      NAME                          */ 01762000
         SVC   99                                                  0544 01763000
*   RCODESV=R15;                    /* SAVE SVC 99 RETURN CODE       */ 01764000
         ST    R15,RCODESV                                         0545 01765000
*   RESPECIFY                       /* RELEASE REGISTER FOR COMPILER */ 01766000
*    (R15) UNRSTD;                  /* RELEASE RETURN CODE REG       */ 01767000
*   IF RCODESV=0 THEN               /* DYNAMIC ALLOCATION SUCCESSFUL?*/ 01768000
         L     @10,RCODESV                                         0547 01769000
         LTR   @10,@10                                             0547 01770000
         BNZ   @RF00547                                            0547 01771000
*     RTRNCODE=4;                   /* A MATCH OF ATTRNAME WAS FOUND */ 01772000
         L     @10,RGSVAREA(,R13)                                  0548 01773000
         MVC   RTRNCODE(4,@10),@CF00266                            0548 01774000
*   ELSE                            /* COULD BE AN ERROR OR NO MATCH */ 01775000
*     IF S99ERROR^='0438'X          /* WAS IT AN DYNAMIC ALLOC ERROR?*/ 01776000
*       THEN                        /* IT WAS AN ERROR               */ 01777000
         B     @RC00547                                            0549 01778000
@RF00547 CLC   S99ERROR(2),@CB00946                                0549 01779000
         BE    @RF00549                                            0549 01780000
*       DO;                         /* LET DAIRFAIL ISSUE ERROR MSG  */ 01781000
*         DFCPPLP=CPPLPTR;          /* MOVE CPPL POINTER IN PARMLIST */ 01782000
         MVC   DFCPPLP(4),CPPLPTR                                  0551 01783000
*         DFJEFF02=ADDR(MSGWTR);    /* MSG WRITER ADDRESS IS UNKNOWN */ 01784000
         LA    @10,MSGWTR                                          0552 01785000
         ST    @10,DFJEFF02                                        0552 01786000
*         DFIDP=ADDR(CALLERID);     /* ADDRESS OF THE CALLER ID      */ 01787000
         LA    @10,CALLERID                                        0553 01788000
         ST    @10,DFIDP                                           0553 01789000
*         DFRCP=ADDR(RCODESV);      /* POINTER TO DYNAMIC ALLOCATION    01790000
*                                      RETURN CODE                   */ 01791000
         LA    @10,RCODESV                                         0554 01792000
         ST    @10,DFRCP                                           0554 01793000
*         DFS99RBP=S99RBPTR;        /* POINTER TO DYNAMIC ALLOCATION    01794000
*                                      REQUEST BLOCK                 */ 01795000
         MVC   DFS99RBP(4),S99RBPTR                                0555 01796000
*         R1=ADDR(DFPARMS);         /* LOAD ADDRESS OF PARMLIST IN R1*/ 01797000
         LA    R1,DFPARMS                                          0556 01798000
*         GEN(LINK EP=IKJEFF18);    /* ISSUE DIAGNOSTIC MESSAGE      */ 01799000
         LINK EP=IKJEFF18                                               01800000
*         RTRNCODE=12;              /* SET A FAILING RETURN CODE     */ 01801000
         L     @10,RGSVAREA(,R13)                                  0558 01802000
         MVC   RTRNCODE(4,@10),@CF00035                            0558 01803000
*       END;                        /* END OF DAIRFAIL PROCESSING    */ 01804000
*     ELSE                          /* NO MATCH OF ATTR-LIST-NAME    */ 01805000
*       RTRNCODE=0;                 /* SUCCESSFUL PARSE RETURN CODE  */ 01806000
         B     @RC00549                                            0560 01807000
@RF00549 L     @10,RGSVAREA(,R13)                                  0560 01808000
         SLR   @06,@06                                             0560 01809000
         ST    @06,RTRNCODE(,@10)                                  0560 01810000
*   RESPECIFY                                                      0561 01811000
*    (R1,                                                          0561 01812000
*     R7) UNRSTD;                   /* RELEASE REG 1, 7 FOR COMPILER */ 01813000
@RC00549 DS    0H                                                  0561 01814000
@RC00547 DS    0H                                                  0562 01815000
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */ 01816000
         L R13,SAVEAR01+AFOR                                            01817000
*   END;                            /* RETURN TO PARSE               */ 01818000
@EL00008 DS    0H                                                  0563 01819000
@EF00008 DS    0H                                                  0563 01820000
@ER00008 LM    @14,@12,12(@13)                                     0563 01821000
         BR    @14                                                 0563 01822000
@PB00008 DS    0H                                                  0564 01823000
*   GEN(EJECT);                                                    0564 01824000
*                                                                  0564 01825000
         EJECT                                                          01826000
*/*IKJEFATT: CHART                                                   */ 01827000
*/*HEADER                                                          0565 01828000
*/*                             IKJEFATT                           0565 01829000
*/*                       8-17-72                                  0565 01830000
*/*                  ATTRIB COMMAND PROCESSOR                      0565 01831000
*/*                             PAGE #                               */ 01832000
*/*IKJEFATT: E ENTRY TO ATTRIB FROM TMP                              */ 01833000
*/*          M INITIALIZE                                            */ 01834000
*/*          L GETMAIN CORE FOR TEXT UNITS, ETC.                     */ 01835000
*/*          M SET UP FOR PARSE AND VALIDITY CHECK EXIT ROUTINES     */ 01836000
*/*          L PARSE TO SYNTAX CHECK OPERANDS                        */ 01837000
*/*          D (NO,,YES,%PARSEOK) PARSE SUCCESSFUL?                  */ 01838000
*/*          P INDICATE COMMAND ERROR TO TMP                         */ 01839000
*/*%ERRPATH: D (NO,,YES,%A1) PARSE RC=4,USER IN PROMPT MODE?         */ 01840000
*/*          L PUTLINE TO ISSUE ERROR MESSAGE                        */ 01841000
*/*%A1:      D (YES,,NO,%M2) ERROR RETURN CODE?                      */ 01842000
*/*          L IKJSTACK TO FLUSH COMMAND STACK                       */ 01843000
*/*%M2:      R RETURN TO THE TMP                                     */ 01844000
*/*%PARSEOK: D (NO,%A3,YES,) DEN,DSORG, LRECL,EXPDT, OR BUFOFF SPEC? */ 01845000
*/*          P BUILD A TEXT UNIT FOR SPECIFIED ONES                  */ 01846000
*/*          P INDICATE IN PARSE OUTPUT--VALUES NOT FOUND            */ 01847000
*/*%A3:      P BUILD A TEXT UNIT FOR DUMMY AND PERM ALLOC            */ 01848000
*/*          M SET UP FOR GENTRANS                                   */ 01849000
*/*          L GENTRANS TO BUILD TEXT UNITS FROM PDE                 */ 01850000
*/*          D (NO,%M1,YES,) GENTRANS SUCCESSFUL?                    */ 01851000
*/*%A4:      M SET UP FOR SVC 99, ALLOCATION                         */ 01852000
*/*          L SVC 99 -> DUMMY ALLOCATION WITH ATTRIBUTES            */ 01853000
*/*          D (NO,,YES,%A5) ALLOCATION SUCCESSFUL?                  */ 01854000
*/*          M SET UP FOR DAIRFAIL                                   */ 01855000
*/*          L DAIRFAIL TO DOCUMENT ERROR TO THE USER                */ 01856000
*/*          P INDICATE COMMAND ERROR TO TMP                         */ 01857000
*/*%M3:      L (,%A1) FREEMAIN PDL AND OTHER GETMAINED CORE          */ 01858000
*/*%A5:      P (,%M3) INDICATE COMMAND SUCCESSFUL TO THE TMP         */ 01859000
*/*%M1:      L PUTLINE TO ISSUE ERROR MESSAGE                        */ 01860000
*/*          L (,%A1) FREEMAIN GENTRANS CORE                         */ 01861000
*/*ATTRNMCK: E ENTRY FROM PARSE                                      */ 01862000
*/*          P BUILD A TEXT UNIT TO GO TO SVC 99                     */ 01863000
*/*          P BUILD A PARAMETER LIST FOR SVC 99                     */ 01864000
*/*          L SVC 99 -> INFORMATION RETRIEVAL                       */ 01865000
*/*          D (NO,%M4,YES,) WAS SVC 99 SUCCESSFUL?                  */ 01866000
*/*          D (NO,,YES,%NGA1) IS THE NAME A DUPLICATE ?             */ 01867000
*/*          P (,%RA2) INDICATE TO PARSE NAME IS VALID               */ 01868000
*/*%M4:      L DAIRFAIL TO DOCUMENT ERROR TO THE USER                */ 01869000
*/*          P (,%RA2) SET FAILING RETURN CODE TO PARSE              */ 01870000
*/*%NGA1:    P INDICATE TO PARSE NAME IS INVALID                     */ 01871000
*/*%RA2:     R RETURN TO PARSE                                       */ 01872000
*/*BLKBUFCK: E ENTRY FROM PARSE                                      */ 01873000
*/*          D (NO,,YES,%NG1) SUPPLIED VALUE EXCEED LIMIT?           */ 01874000
*/*          P (,%R2) INDICATE TO PARSE VALUE IS VALID               */ 01875000
*/*%NG1:     P INDICATE TO PARSE VALUE IS INVALID                    */ 01876000
*/*%R2:      R RETURN TO PARSE                                       */ 01877000
*/*KEYBUFCK: E ENTRY FROM PARSE                                      */ 01878000
*/*          D (NO,,YES,%NG2) SUPPLIED VALUE EXCEED LIMIT?           */ 01879000
*/*          P (,%R3) INDICATE TO PARSE VALUE IS VALID               */ 01880000
*/*%NG2:     P INDICATE TO PARSE VALUE IS INVALID                    */ 01881000
*/*%R3:      R RETURN TO PARSE                                       */ 01882000
*/*DENSCK:   E ENTRY FROM PARSE                                      */ 01883000
*/*          D (NO,,YES,%NG3) SUPPLIED VALUE EXCEED LIMIT?           */ 01884000
*/*          P INDICATE VALID VALUE IN TEXT UNIT                     */ 01885000
*/*          P (,%R4) INDICATE TO PARSE VALUE IS VALID               */ 01886000
*/*%NG3:     P INDICATE TO PARSE VALUE IS INVALID                    */ 01887000
*/*%R4:      R RETURN TO PARSE                                       */ 01888000
*/*EXPDTCK:  E ENTRY FROM PARSE                                      */ 01889000
*/*          D (NO,,YES,%NG4) NUMBER LENGTH LESS THAN 5?             */ 01890000
*/*          D (YES,,NO,%NG4) DAY NUMBER VALID?                      */ 01891000
*/*          P INDICATE VALID DAY AND YEAR IN TEXT UNIT              */ 01892000
*/*          P (,%R5) INDICATE TO PARSE VALUE IS VALID               */ 01893000
*/*%NG4:     P INDICATE TO PARSE VALUE IS INVALID                    */ 01894000
*/*%R5:      R RETURN TO PARSE                                       */ 01895000
*/*LRECLCK:  E ENTRY FROM PARSE                                      */ 01896000
*/*          D (NO,%B1,YES,) THE VALUE IS X ?                        */ 01897000
*/*          D (NO,%B2,YES,) THE VALUE IS ONLY ONE DIGIT LONG?       */ 01898000
*/*          P INDICATE A VALID CHARACTER X IN TEXT UNIT             */ 01899000
*/*%B3:      P INDICATE TO PARSE THAT THE VALUE IS VALID             */ 01900000
*/*%B4:      R RETURN TO PARSE                                       */ 01901000
*/*%B1:      D (NO,,YES,%B5) IS THE FIRST CHARACTER NUMERIC?         */ 01902000
*/*%B2:      P (,%B4) INDICATE TO PARSE THAT THE VALUE IS INVALID    */ 01903000
*/*%B5:      D (NO,%B6,YES,%B2) SUPPLIED VALUE EXCEED LIMIT?         */ 01904000
*/*%B6:      P (,%B3) INDICATE A VALID NUMBER IN TEXT UNIT           */ 01905000
*/*BUFCK:    E ENTRY FROM PARSE                                      */ 01906000
*/*          D (NO,%T1,YES,) THE VALUE IS L ?                        */ 01907000
*/*          D (NO,%T2,YES,) THE VALUE IS ONLY ONE DIGIT LONG?       */ 01908000
*/*          P INDICATE A VALID CHARACTER L IN TEXT UNIT             */ 01909000
*/*%T3:      P INDICATE TO PARSE THAT THE VALUE IS VALID             */ 01910000
*/*%T4:      R RETURN TO PARSE                                       */ 01911000
*/*%T1:      D (NO,,YES,%T5) IS THE FIRST CHARACTER NUMERIC?         */ 01912000
*/*%T2:      P (,%T4) INDICATE TO PARSE THAT THE VALUE IS INVALID    */ 01913000
*/*%T5:      P (,%T3) INDICATE A VALID NUMBER IN TEXT UNIT           */ 01914000
*/*IKJEFATT: END                                                     */ 01915000
*                                                                  0565 01916000
*   END IKJEFATT                                                   0565 01917000
*                                                                  0565 01918000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01919000
*/*%INCLUDE SYSLIB  (IKJZB831)                                       */ 01920000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */ 01921000
*/*%INCLUDE SYSLIB  (IKJSTPL )                                       */ 01922000
*/*%INCLUDE SYSLIB  (IKJSTPB )                                       */ 01923000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 01924000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */ 01925000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */ 01926000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */ 01927000
*/*%INCLUDE SYSLIB  (IKJEFFDF)                                       */ 01928000
*                                                                  0565 01929000
*       ;                                                          0565 01930000
         B     @EL00001                                            0565 01931000
@DATA    DS    0H                                                       01932000
@CH00250 DC    H'5'                                                     01933000
@CH00065 DC    H'7'                                                     01934000
@CH00034 DC    H'11'                                                    01935000
@CH00913 DC    H'255'                                                   01936000
@CH00928 DC    H'366'                                                   01937000
@CH00908 DC    H'32760'                                                 01938000
@SM00949 MVC   MSGBUF(0,Y),MESSTXT(X)                                   01939000
@SM00951 MVC   COREGOT(0,@14),PUTLIST                                   01940000
@SM00953 MVC   S99TUPAR(0,@10),VALNAME(@15)                             01941000
@DATD    DSECT                                                          01942000
         DS    0F                                                       01943000
@SA00001 DS    18F                                                      01944000
@PC00001 DS    1F                                                       01945000
@TF00001 DS    F                                                        01946000
@ZTEMPS  DS    C                                                        01947000
@ZTEMPND EQU   *                                                        01948000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01949000
IKJEFATT CSECT                                                          01950000
         DS    0F                                                       01951000
@CF00033 DC    F'1'                                                     01952000
@CH00033 EQU   @CF00033+2                                               01953000
@CF00063 DC    F'2'                                                     01954000
@CH00063 EQU   @CF00063+2                                               01955000
@CF00293 DC    F'3'                                                     01956000
@CH00293 EQU   @CF00293+2                                               01957000
@CF00266 DC    F'4'                                                     01958000
@CH00266 EQU   @CF00266+2                                               01959000
@CF00035 DC    F'12'                                                    01960000
@CH00035 EQU   @CF00035+2                                               01961000
@CF00444 DC    F'16'                                                    01962000
@CF00948 DC    F'-4'                                                    01963000
@DATD    DSECT                                                          01964000
         DS    0D                                                       01965000
SERVRPTR DS    A                                                        01966000
GTPLPTR  DS    A                                                        01967000
VALPARMS DS    A                                                        01968000
CPPLPTR  DS    A                                                        01969000
RCODESV  DS    F                                                        01970000
CDENSITY DS    F                                                        01971000
S99TUFP  DS    A                                                        01972000
R14SAVE3 DS    F                                                        01973000
D        DS    F                                                        01974000
S99RBPTR DS    AL4                                                      01975000
         ORG   S99RBPTR                                                 01976000
S99RBPND DS    BL1                                                      01977000
         ORG   S99RBPTR+4                                               01978000
WORKAREA DS    CL209                                                    01979000
         ORG   WORKAREA                                                 01980000
PARSPARM DS    CL4                                                      01981000
         ORG   PARSPARM                                                 01982000
PDLADDR  DS    AL4                                                      01983000
         ORG   WORKAREA+4                                               01984000
SCORE    DS    CL20                                                     01985000
SERTEPRM DS    CL28                                                     01986000
         ORG   SERTEPRM                                                 01987000
ADUPT    DS    AL4                                                      01988000
ADECT    DS    AL4                                                      01989000
ADECB    DS    AL4                                                      01990000
@NM00002 DS    AL4                                                      01991000
@NM00003 DS    AL4                                                      01992000
@NM00004 DS    AL4                                                      01993000
@NM00005 DS    AL4                                                      01994000
         ORG   WORKAREA+52                                              01995000
COMMECB  DS    FL4                                                      01996000
PARMCORE DS    CL153                                                    01997000
         ORG   PARMCORE                                                 01998000
GTPLAREA DS    CL24                                                     01999000
ADBKAREA DS    CL32                                                     02000000
TEXTAREA DS    CL77                                                     02001000
ATNMCORE DS    CL20                                                     02002000
         ORG   WORKAREA+209                                             02003000
         DS    CL3                                                      02004000
CORE     DS    CL4                                                      02005000
         ORG   CORE                                                     02006000
SUBPOOLN DS    CL1                                                      02007000
PSIZE    DS    AL3                                                      02008000
         ORG   CORE+4                                                   02009000
STACKLSD DS    CL20                                                     02010000
MSGPARMS DS    CL202                                                    02011000
         ORG   MSGPARMS                                                 02012000
LEVELONE DS    CL12                                                     02013000
         ORG   LEVELONE                                                 02014000
PTRLEVL2 DS    AL4                                                      02015000
SEGNUM1  DS    AL4                                                      02016000
ADSEG1   DS    AL4                                                      02017000
         ORG   MSGPARMS+12                                              02018000
LEVELTWO DS    CL12                                                     02019000
         ORG   LEVELTWO                                                 02020000
ADNEXT   DS    AL4                                                      02021000
SEGNUM2  DS    AL4                                                      02022000
ADSEG2   DS    AL4                                                      02023000
         ORG   MSGPARMS+24                                              02024000
MSGBUFER DS    CL124                                                    02025000
         ORG   MSGBUFER                                                 02026000
LENOFMSG DS    FL2                                                      02027000
OFFSET   DS    FL2                                                      02028000
FORMTBUF DS    CL120                                                    02029000
         ORG   MSGPARMS+148                                             02030000
MSGBUF2  DS    CL54                                                     02031000
         ORG   MSGBUF2                                                  02032000
LENMSG2  DS    FL2                                                      02033000
OFFSET2  DS    FL2                                                      02034000
FORMBUF2 DS    CL50                                                     02035000
         ORG   MSGPARMS+202                                             02036000
         DS    CL2                                                      02037000
MSGSGMTS DS    CL40                                                     02038000
         ORG   MSGSGMTS                                                 02039000
SEG1     DS    AL4                                                      02040000
SEG2     DS    AL4                                                      02041000
SEG3     DS    AL4                                                      02042000
SEG4     DS    AL4                                                      02043000
SEG5     DS    AL4                                                      02044000
SEG6     DS    AL4                                                      02045000
SEG7     DS    AL4                                                      02046000
SEG8     DS    AL4                                                      02047000
SEG9     DS    AL4                                                      02048000
SEGEND   DS    AL4                                                      02049000
         ORG   MSGSGMTS+40                                              02050000
RTCDAREA DS    CL8                                                      02051000
         ORG   RTCDAREA                                                 02052000
@NM00016 DS    CL2                                                      02053000
RTCDLEN  DS    FL2                                                      02054000
RETDEC   DS    CL4                                                      02055000
         ORG   RETDEC                                                   02056000
@NM00017 DS    CL3                                                      02057000
FZERO    DS    CL1                                                      02058000
         ORG   RTCDAREA+8                                               02059000
UNPACK   DS    CL8                                                      02060000
S99RB    DS    CL20                                                     02061000
         ORG   S99RB                                                    02062000
S99RBLN  DS    CL1                                                      02063000
S99VERB  DS    CL1                                                      02064000
S99FLAG1 DS    CL2                                                      02065000
         ORG   S99FLAG1                                                 02066000
S99FLG11 DS    CL1                                                      02067000
         ORG   S99FLG11                                                 02068000
S99ONCNV DS    BL1                                                      02069000
S99NOCNV EQU   S99FLG11+0                                               02070000
S99NOMNT EQU   S99FLG11+0                                               02071000
S99JBSYS EQU   S99FLG11+0                                               02072000
         ORG   S99FLAG1+1                                               02073000
S99FLG12 DS    CL1                                                      02074000
         ORG   S99RB+4                                                  02075000
S99RSC   DS    CL4                                                      02076000
         ORG   S99RSC                                                   02077000
S99ERROR DS    CL2                                                      02078000
S99INFO  DS    CL2                                                      02079000
         ORG   S99RB+8                                                  02080000
S99TXTPP DS    AL4                                                      02081000
S99RSV01 DS    FL4                                                      02082000
S99FLAG2 DS    CL4                                                      02083000
         ORG   S99FLAG2                                                 02084000
S99FLG21 DS    CL1                                                      02085000
         ORG   S99FLG21                                                 02086000
S99WTVOL DS    BL1                                                      02087000
S99WTDSN EQU   S99FLG21+0                                               02088000
S99NORES EQU   S99FLG21+0                                               02089000
S99WTUNT EQU   S99FLG21+0                                               02090000
S99OFFLN EQU   S99FLG21+0                                               02091000
S99TIONQ EQU   S99FLG21+0                                               02092000
S99CATLG EQU   S99FLG21+0                                               02093000
S99MOUNT EQU   S99FLG21+0                                               02094000
         ORG   S99FLAG2+1                                               02095000
S99FLG22 DS    CL1                                                      02096000
         ORG   S99FLG22                                                 02097000
S99UDEVT DS    BL1                                                      02098000
S99PCINT EQU   S99FLG22+0                                               02099000
         ORG   S99FLAG2+2                                               02100000
S99FLG23 DS    CL1                                                      02101000
S99FLG24 DS    CL1                                                      02102000
         ORG   S99RB+20                                                 02103000
DFPARMS  DS    CL20                                                     02104000
         ORG   DFPARMS                                                  02105000
DFS99RBP DS    AL4                                                      02106000
         ORG   DFS99RBP                                                 02107000
DFDAPLP  DS    AL4                                                      02108000
         ORG   DFPARMS+4                                                02109000
DFRCP    DS    AL4                                                      02110000
DFJEFF02 DS    AL4                                                      02111000
DFIDP    DS    AL4                                                      02112000
DFCPPLP  DS    AL4                                                      02113000
         ORG   DFPARMS+20                                               02114000
DECSIZE  DS    CL8                                                      02115000
VALCKWA  DS    10A                                                      02116000
SAVEAR01 DS    18A                                                      02117000
IKJEFATT CSECT                                                          02118000
         DS    0F                                                       02119000
@SIZDATD DC    AL1(1)                                                   02120000
         DC    AL3(@ENDDATD-@DATD)                                      02121000
         DS    0D                                                       02122000
MSGWTR   DC    F'0'                                                     02123000
CALLERID DC    H'50'                                                    02124000
@CB00445 DC    X'0001'                                                  02125000
@CB00511 DC    X'0022'                                                  02126000
@CB00515 DC    X'0024'                                                  02127000
@CB00549 DC    X'0035'                                                  02128000
@CB00561 DC    X'003B'                                                  02129000
@CB00563 DC    X'003C'                                                  02130000
@CB00575 DC    X'0042'                                                  02131000
@CB00607 DC    X'0052'                                                  02132000
@CB00751 DC    X'0000'                                                  02133000
@CB00869 DC    X'2000'                                                  02134000
@CB00870 DC    X'2100'                                                  02135000
@CB00871 DC    X'0200'                                                  02136000
@CB00872 DC    X'0300'                                                  02137000
@CB00873 DC    X'4000'                                                  02138000
@CB00874 DC    X'4100'                                                  02139000
@CB00920 DC    X'8000'                                                  02140000
@CB00946 DC    X'0438'                                                  02141000
PDECMPRE DC    X'FF000000'                                              02142000
CHARX    DC    CL1'X'                                                   02143000
CHARL    DC    CL1'L'                                                   02144000
MSG01    DS    CL33                                                     02145000
         ORG   MSG01                                                    02146000
MSGO1LEN DC    H'31'                                                    02147000
MSGO1TXT DC    CL31'IKJ60743I COMMAND SYSTEM ERROR+'                    02148000
         ORG   MSG01+33                                                 02149000
         DS    CL1                                                      02150000
MSG02    DS    CL54                                                     02151000
         ORG   MSG02                                                    02152000
MSGO2LEN DC    H'52'                                                    02153000
MSGO2TXT DC    CL52'IKJ60741I NOT ENOUGH MAIN STORAGE TO EXECUTE COMMANC02154000
               D'                                                       02155000
         ORG   MSG02+54                                                 02156000
MSG03    DS    CL20                                                     02157000
         ORG   MSG03                                                    02158000
MSG03LEN DC    H'18'                                                    02159000
MSG03TXT DC    CL18' RETURN CODE IS '                                   02160000
         ORG   MSG03+20                                                 02161000
MSG04    DS    CL12                                                     02162000
         ORG   MSG04                                                    02163000
MSG06LEN DC    H'10'                                                    02164000
MSG06TXT DC    CL10'IKJ60639I '                                         02165000
         ORG   MSG04+12                                                 02166000
PARSE    DS    CL7                                                      02167000
         ORG   PARSE                                                    02168000
@NM00012 DC    H'5'                                                     02169000
@NM00013 DC    CL5'PARSE'                                               02170000
         ORG   PARSE+7                                                  02171000
         DS    CL1                                                      02172000
GENTRANS DS    CL10                                                     02173000
         ORG   GENTRANS                                                 02174000
@NM00014 DC    H'8'                                                     02175000
@NM00015 DC    CL8'GENTRANS'                                            02176000
         ORG   GENTRANS+10                                              02177000
KEYTABLE DS    CL70                                                     02178000
         ORG   KEYTABLE                                                 02179000
BFALNTAB DS    CL6                                                      02180000
         ORG   BFALNTAB                                                 02181000
BFALNKEY DC    X'002E'                                                  02182000
BFALNCNT DC    AL2(2)                                                   02183000
BFALNF   DC    X'01'                                                    02184000
BFALND   DC    X'02'                                                    02185000
         ORG   KEYTABLE+6                                               02186000
BFTEKTAB DS    CL8                                                      02187000
         ORG   BFTEKTAB                                                 02188000
BFTEKKEY DC    X'002F'                                                  02189000
BFTEKCNT DC    AL2(4)                                                   02190000
BFTEKS   DC    X'40'                                                    02191000
BFTEKE   DC    X'10'                                                    02192000
BFTEKA   DC    X'60'                                                    02193000
BFTEKR   DC    X'20'                                                    02194000
         ORG   KEYTABLE+14                                              02195000
EROPTTAB DS    CL7                                                      02196000
         ORG   EROPTTAB                                                 02197000
EROPTKEY DC    X'003D'                                                  02198000
EROPTCNT DC    AL2(3)                                                   02199000
EROPTSKP DC    X'40'                                                    02200000
EROPTACC DC    X'80'                                                    02201000
EROPTABE DC    X'20'                                                    02202000
         ORG   KEYTABLE+21                                              02203000
OPTCDTAB DS    CL15                                                     02204000
         ORG   OPTCDTAB                                                 02205000
OPTCDKEY DC    X'0045'                                                  02206000
OPTCDCNT DC    AL2(11)                                                  02207000
OPTCDC   DC    X'20'                                                    02208000
OPTCDT   DC    X'02'                                                    02209000
OPTCDW   DC    X'80'                                                    02210000
OPTCDQ   DC    X'08'                                                    02211000
OPTCDA   DC    X'08'                                                    02212000
OPTCDB   DC    X'40'                                                    02213000
OPTCDE   DC    X'20'                                                    02214000
OPTCDF   DC    X'10'                                                    02215000
OPTCDH   DC    X'10'                                                    02216000
OPTCDZ   DC    X'04'                                                    02217000
OPTCDR   DC    X'01'                                                    02218000
         ORG   KEYTABLE+36                                              02219000
TRTCHTAB DS    CL8                                                      02220000
         ORG   TRTCHTAB                                                 02221000
TRTCHKEY DC    X'004F'                                                  02222000
TRTCHCNT DC    AL2(4)                                                   02223000
TRTCHC   DC    X'13'                                                    02224000
TRTCHE   DC    X'23'                                                    02225000
TRTCHET  DC    X'2B'                                                    02226000
TRTCHT   DC    X'3B'                                                    02227000
         ORG   KEYTABLE+44                                              02228000
INOUTTAB DS    CL6                                                      02229000
         ORG   INOUTTAB                                                 02230000
INOUTKEY DC    X'0021'                                                  02231000
INOUTCNT DC    AL2(2)                                                   02232000
INPUTSET DC    X'80'                                                    02233000
OUTPTSET DC    X'40'                                                    02234000
         ORG   KEYTABLE+50                                              02235000
DIAGNTAB DS    CL5                                                      02236000
         ORG   DIAGNTAB                                                 02237000
DIAGNKEY DC    X'0054'                                                  02238000
DIAGNCNT DC    AL2(1)                                                   02239000
DIAGNSTR DC    X'00'                                                    02240000
         ORG   KEYTABLE+55                                              02241000
RECFMTAB DS    CL13                                                     02242000
         ORG   RECFMTAB                                                 02243000
RECFMKEY DC    X'0049'                                                  02244000
RECFMCNT DC    AL2(9)                                                   02245000
RECFMA   DC    X'04'                                                    02246000
RECFMB   DC    X'10'                                                    02247000
RECFMF   DC    X'80'                                                    02248000
RECFMM   DC    X'02'                                                    02249000
RECFMS   DC    X'08'                                                    02250000
RECFMT   DC    X'20'                                                    02251000
RECFMU   DC    X'C0'                                                    02252000
RECFMV   DC    X'40'                                                    02253000
RECFMD   DC    X'20'                                                    02254000
         ORG   KEYTABLE+68                                              02255000
ENDTAB   DC    X'FFFF'                                                  02256000
         ORG   KEYTABLE+70                                              02257000
KEYLIST  DS    CL76                                                     02258000
         ORG   KEYLIST                                                  02259000
KEYATTRM DC    X'0001'                                                  02260000
KEYATTRS DC    X'0000'                                                  02261000
KEYBFALM DC    X'0000'                                                  02262000
KEYBFALS DC    X'002E'                                                  02263000
KEYBFTEM DC    X'0000'                                                  02264000
KEYBFTES DC    X'002F'                                                  02265000
KEYBLKSM DC    X'0000'                                                  02266000
KEYBLKSS DC    X'0030'                                                  02267000
KEYBUFLM DC    X'0000'                                                  02268000
KEYBUFLS DC    X'0032'                                                  02269000
KEYBUFNM DC    X'0000'                                                  02270000
KEYBUFNS DC    X'0034'                                                  02271000
KEYBUFOM DC    X'0000'                                                  02272000
KEYBUFOS DC    X'0035'                                                  02273000
KEYEROPM DC    X'0000'                                                  02274000
KEYEROPS DC    X'003D'                                                  02275000
KEYKEYLM DC    X'0000'                                                  02276000
KEYKEYLS DC    X'0040'                                                  02277000
KEYLRECM DC    X'0000'                                                  02278000
KEYLRECS DC    X'0042'                                                  02279000
KEYNCPM  DC    X'0000'                                                  02280000
KEYNCPS  DC    X'0044'                                                  02281000
KEYOPTCM DC    X'0000'                                                  02282000
KEYOPTCS DC    X'0045'                                                  02283000
KEYRECFM DC    X'0000'                                                  02284000
KEYRECFS DC    X'0049'                                                  02285000
KEYINOTM DC    X'0021'                                                  02286000
KEYINOTS DC    X'0000'                                                  02287000
KEYRETPM DC    X'0000'                                                  02288000
KEYRETPS DC    X'0023'                                                  02289000
KEYDIAGM DC    X'0000'                                                  02290000
KEYDIAGS DC    X'0054'                                                  02291000
KEYDENM  DC    X'0000'                                                  02292000
KEYDENS  DC    X'003B'                                                  02293000
KEYLIMCM DC    X'0000'                                                  02294000
KEYLIMCS DC    X'0041'                                                  02295000
KEYDSORM DC    X'0000'                                                  02296000
KEYDSORS DC    X'003C'                                                  02297000
         ORG   KEYLIST+76                                               02298000
KYLIST   DS    CL76                                                     02299000
         ORG   KYLIST                                                   02300000
KYATTRM  DC    X'0001'                                                  02301000
KYATTRS  DC    X'0000'                                                  02302000
KYBFALM  DC    X'0000'                                                  02303000
KYBFALS  DC    X'002E'                                                  02304000
KYBFTEM  DC    X'0000'                                                  02305000
KYBFTES  DC    X'002F'                                                  02306000
KYBLKSM  DC    X'0000'                                                  02307000
KYBLKSS  DC    X'0030'                                                  02308000
KYBUFLM  DC    X'0000'                                                  02309000
KYBUFLS  DC    X'0032'                                                  02310000
KYBUFNM  DC    X'0000'                                                  02311000
KYBUFNS  DC    X'0034'                                                  02312000
KYBUFOM  DC    X'0000'                                                  02313000
KYBUFOS  DC    X'0035'                                                  02314000
KYEROPM  DC    X'0000'                                                  02315000
KYEROPS  DC    X'003D'                                                  02316000
KYTRTCM  DC    X'0000'                                                  02317000
KYTRTCS  DC    X'004F'                                                  02318000
KYLRECM  DC    X'0000'                                                  02319000
KYLRECS  DC    X'0042'                                                  02320000
KYNCPM   DC    X'0000'                                                  02321000
KYNCPS   DC    X'0044'                                                  02322000
KYOPTCM  DC    X'0000'                                                  02323000
KYOPTCS  DC    X'0045'                                                  02324000
KYRECFM  DC    X'0000'                                                  02325000
KYRECFS  DC    X'0049'                                                  02326000
KYINOTM  DC    X'0021'                                                  02327000
KYINOTS  DC    X'0000'                                                  02328000
KYRETPM  DC    X'0000'                                                  02329000
KYRETPS  DC    X'0023'                                                  02330000
KYDIAGM  DC    X'0000'                                                  02331000
KYDIAGS  DC    X'0054'                                                  02332000
KYDENM   DC    X'0000'                                                  02333000
KYDENS   DC    X'003B'                                                  02334000
KYLIMCM  DC    X'0000'                                                  02335000
KYLIMCS  DC    X'0041'                                                  02336000
KYDSORM  DC    X'0000'                                                  02337000
KYDSORS  DC    X'003C'                                                  02338000
         ORG   KYLIST+76                                                02339000
IKJEFATT CSECT                                                          02340000
         DS   0H                                                        02341000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   02342000
@DATD    DSECT                                                          02343000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02344000
@ENDDATD EQU   *                                                        02345000
IKJEFATT CSECT                                                          02346000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02347000
@01      EQU   01                                                       02348000
@02      EQU   02                                                       02349000
@03      EQU   03                                                       02350000
@04      EQU   04                                                       02351000
@05      EQU   05                                                       02352000
@06      EQU   06                                                       02353000
@07      EQU   07                                                       02354000
@08      EQU   08                                                       02355000
@09      EQU   09                                                       02356000
@10      EQU   10                                                       02357000
@11      EQU   11                                                       02358000
@12      EQU   12                                                       02359000
@13      EQU   13                                                       02360000
@14      EQU   14                                                       02361000
@15      EQU   15                                                       02362000
R0       EQU   @00                                                      02363000
R1       EQU   @01                                                      02364000
R2       EQU   @02                                                      02365000
R3       EQU   @03                                                      02366000
R4       EQU   @04                                                      02367000
R5       EQU   @05                                                      02368000
R7       EQU   @07                                                      02369000
R13      EQU   @13                                                      02370000
R14      EQU   @14                                                      02371000
R15      EQU   @15                                                      02372000
I        EQU   @06                                                      02373000
X        EQU   @05                                                      02374000
Y        EQU   @04                                                      02375000
R11      EQU   @11                                                      02376000
R12      EQU   @12                                                      02377000
GTPL     EQU   0                                                        02378000
GTPLPDL  EQU   GTPL                                                     02379000
GTPLPCL  EQU   GTPL+4                                                   02380000
GTPLKLST EQU   GTPL+8                                                   02381000
GTPLTBLE EQU   GTPL+12                                                  02382000
GTPLABLK EQU   GTPL+16                                                  02383000
GTPLOUTA EQU   GTPL+20                                                  02384000
ADDBLOCK EQU   0                                                        02385000
ADDBKLN  EQU   ADDBLOCK                                                 02386000
ADBKPTR  EQU   ADDBLOCK+4                                               02387000
ATTRPDL  EQU   0                                                        02388000
ATNPDE   EQU   ATTRPDL+8                                                02389000
ATNFLAGS EQU   ATNPDE+6                                                 02390000
BUFOFFWD EQU   ATTRPDL+26                                               02391000
KEYLEKWD EQU   ATTRPDL+30                                               02392000
TRTCHWD  EQU   KEYLEKWD                                                 02393000
LRECLKWD EQU   ATTRPDL+32                                               02394000
INPUTKWD EQU   ATTRPDL+40                                               02395000
EXPDTKWD EQU   ATTRPDL+42                                               02396000
RETPDWD  EQU   EXPDTKWD                                                 02397000
DENSITWD EQU   ATTRPDL+46                                               02398000
DSORGWD  EQU   ATTRPDL+50                                               02399000
BLKSISUB EQU   ATTRPDL+56                                               02400000
BLKSFLAG EQU   BLKSISUB+6                                               02401000
BUFOFSUB EQU   ATTRPDL+64                                               02402000
BUFFFLAG EQU   BUFOFSUB+6                                               02403000
BUFLSUB  EQU   ATTRPDL+72                                               02404000
BUFLFLAG EQU   BUFLSUB+6                                                02405000
BUFNOSUB EQU   ATTRPDL+80                                               02406000
BUFNFLAG EQU   BUFNOSUB+6                                               02407000
KEYLESUB EQU   ATTRPDL+88                                               02408000
KEYLFLAG EQU   KEYLESUB+6                                               02409000
LRECLSUB EQU   ATTRPDL+96                                               02410000
LRECFLAG EQU   LRECLSUB+6                                               02411000
NCPSUB   EQU   ATTRPDL+104                                              02412000
NCPFLAG  EQU   NCPSUB+6                                                 02413000
EXPDTSUB EQU   ATTRPDL+112                                              02414000
EXPDFLAG EQU   EXPDTSUB+6                                               02415000
RETPD    EQU   ATTRPDL+120                                              02416000
RETPFLAG EQU   RETPD+6                                                  02417000
DENSUB   EQU   ATTRPDL+128                                              02418000
DENFLAG  EQU   DENSUB+6                                                 02419000
LIMCTSUB EQU   ATTRPDL+136                                              02420000
LIMCFLAG EQU   LIMCTSUB+6                                               02421000
DSORGSUB EQU   ATTRPDL+172                                              02422000
EXITLIST EQU   0                                                        02423000
PDEADR   EQU   EXITLIST                                                 02424000
VALUEPDE EQU   0                                                        02425000
VALUEPTR EQU   VALUEPDE                                                 02426000
VALUELEN EQU   VALUEPDE+4                                               02427000
VALNAME  EQU   0                                                        02428000
IOPL     EQU   0                                                        02429000
IOPLIOPB EQU   IOPL+12                                                  02430000
COREGOT  EQU   0                                                        02431000
OUTADDR  EQU   4                                                        02432000
RGSVAREA EQU   4                                                        02433000
RTRNCODE EQU   16                                                       02434000
RETPOINT EQU   0                                                        02435000
LRECLX   EQU   0                                                        02436000
HALFLREC EQU   LRECLX                                                   02437000
BUFOFFL  EQU   0                                                        02438000
R2POINT  EQU   0                                                        02439000
STPL     EQU   0                                                        02440000
STPLSTPB EQU   STPL+12                                                  02441000
STPB     EQU   0                                                        02442000
@NM00008 EQU   STPB                                                     02443000
MSGBUF   EQU   0                                                        02444000
MESSAGES EQU   0                                                        02445000
MESSLEN  EQU   MESSAGES                                                 02446000
MESSTXT  EQU   MESSAGES+2                                               02447000
SEGTABLE EQU   0                                                        02448000
CPPL     EQU   0                                                        02449000
CPPLCBUF EQU   CPPL                                                     02450000
CPPLUPT  EQU   CPPL+4                                                   02451000
CPPLECT  EQU   CPPL+12                                                  02452000
S99TUPL  EQU   0                                                        02453000
S99TUPTR EQU   S99TUPL                                                  02454000
S99TUP   EQU   0                                                        02455000
S99TUPND EQU   S99TUP                                                   02456000
S99TUNIT EQU   0                                                        02457000
S99TUKEY EQU   S99TUNIT                                                 02458000
S99TUNUM EQU   S99TUNIT+2                                               02459000
S99TUENT EQU   S99TUNIT+4                                               02460000
S99TULNG EQU   S99TUENT                                                 02461000
S99TUPAR EQU   S99TUENT+2                                               02462000
S99TUFLD EQU   0                                                        02463000
PPL      EQU   0                                                        02464000
PPLPCL   EQU   PPL+12                                                   02465000
PPLANS   EQU   PPL+16                                                   02466000
PPLCBUF  EQU   PPL+20                                                   02467000
PPLUWA   EQU   PPL+24                                                   02468000
TEXTDATA EQU   0                                                        02469000
TXDTSBPL EQU   TEXTDATA                                                 02470000
TXDTLNGH EQU   TEXTDATA+1                                               02471000
TXDTPTR  EQU   TEXTDATA+8                                               02472000
DFID     EQU   0                                                        02473000
@NM00019 EQU   DFID                                                     02474000
DFMSGWTP EQU   0                                                        02475000
DFRC     EQU   0                                                        02476000
TMCTPARM EQU   0                                                        02477000
IOPLPTR  EQU   SERVRPTR                                                 02478000
STPLPTR  EQU   SERVRPTR                                                 02479000
PPLPTR   EQU   SERVRPTR                                                 02480000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02481000
IDNUM    EQU   DFID+1                                                   02482000
@NM00020 EQU   @NM00019                                                 02483000
DFWTP    EQU   @NM00019                                                 02484000
@NM00018 EQU   TEXTDATA+6                                               02485000
TXDTNUMB EQU   TEXTDATA+4                                               02486000
PPLECB   EQU   PPL+8                                                    02487000
PPLECT   EQU   PPL+4                                                    02488000
PPLUPT   EQU   PPL                                                      02489000
S99TUPRM EQU   S99TUFLD+2                                               02490000
S99TULEN EQU   S99TUFLD                                                 02491000
S99TUPLN EQU   S99TUPTR                                                 02492000
CPPLPSCB EQU   CPPL+8                                                   02493000
STPBMBRN EQU   STPB+16                                                  02494000
STPBOTDD EQU   STPB+12                                                  02495000
STPBINDD EQU   STPB+8                                                   02496000
STPBALSD EQU   STPB+4                                                   02497000
@NM00011 EQU   @NM00008+1                                               02498000
SPBFLUSH EQU   @NM00008+1                                               02499000
@NM00010 EQU   @NM00008+1                                               02500000
@NM00009 EQU   @NM00008                                                 02501000
STPLECB  EQU   STPL+8                                                   02502000
STPLECT  EQU   STPL+4                                                   02503000
STPLUPT  EQU   STPL                                                     02504000
HALFBUFO EQU   BUFOFFL                                                  02505000
IOPLECB  EQU   IOPL+8                                                   02506000
IOPLECT  EQU   IOPL+4                                                   02507000
IOPLUPT  EQU   IOPL                                                     02508000
VALUEFLG EQU   VALUEPDE+6                                               02509000
VALMSG   EQU   EXITLIST+8                                               02510000
USERWORD EQU   EXITLIST+4                                               02511000
RECFSUB9 EQU   ATTRPDL+190                                              02512000
RECFSUB8 EQU   ATTRPDL+188                                              02513000
RECFSUB7 EQU   ATTRPDL+186                                              02514000
RECFSUB6 EQU   ATTRPDL+184                                              02515000
RECFSUB5 EQU   ATTRPDL+182                                              02516000
RECFSUB4 EQU   ATTRPDL+180                                              02517000
RECFSUB3 EQU   ATTRPDL+178                                              02518000
RECFSUB2 EQU   ATTRPDL+176                                              02519000
RECFSUB1 EQU   ATTRPDL+174                                              02520000
DIAGNSUB EQU   ATTRPDL+170                                              02521000
OPTCSU11 EQU   ATTRPDL+168                                              02522000
OPTCSU10 EQU   ATTRPDL+166                                              02523000
OPTCSUB9 EQU   ATTRPDL+164                                              02524000
OPTCSUB8 EQU   ATTRPDL+162                                              02525000
OPTCSUB7 EQU   ATTRPDL+160                                              02526000
OPTCSUB6 EQU   ATTRPDL+158                                              02527000
OPTCSUB5 EQU   ATTRPDL+156                                              02528000
OPTCSUB4 EQU   ATTRPDL+154                                              02529000
OPTCSUB3 EQU   ATTRPDL+152                                              02530000
OPTCSUB2 EQU   ATTRPDL+150                                              02531000
OPTCSUB1 EQU   ATTRPDL+148                                              02532000
TRTCHSUB EQU   ATTRPDL+146                                              02533000
EROPTSUB EQU   ATTRPDL+144                                              02534000
LIMCRESV EQU   LIMCTSUB+7                                               02535000
RSVLIMCT EQU   LIMCFLAG                                                 02536000
LIMCPRES EQU   LIMCFLAG                                                 02537000
LIMCLEN  EQU   LIMCTSUB+4                                               02538000
LIMCPTR  EQU   LIMCTSUB                                                 02539000
DENRESV  EQU   DENSUB+7                                                 02540000
RSVDEN   EQU   DENFLAG                                                  02541000
DENPRES  EQU   DENFLAG                                                  02542000
DENLEN   EQU   DENSUB+4                                                 02543000
DENPTR   EQU   DENSUB                                                   02544000
RETPRESV EQU   RETPD+7                                                  02545000
RSVRETPD EQU   RETPFLAG                                                 02546000
RETPPRES EQU   RETPFLAG                                                 02547000
RETPLEN  EQU   RETPD+4                                                  02548000
RETPPTR  EQU   RETPD                                                    02549000
EXPDRESV EQU   EXPDTSUB+7                                               02550000
RSVEXPDT EQU   EXPDFLAG                                                 02551000
EXPDPRES EQU   EXPDFLAG                                                 02552000
EXPDTLEN EQU   EXPDTSUB+4                                               02553000
EXPDPTR  EQU   EXPDTSUB                                                 02554000
NCPRESV  EQU   NCPSUB+7                                                 02555000
RSVNCP   EQU   NCPFLAG                                                  02556000
NCPPRES  EQU   NCPFLAG                                                  02557000
NCPLEN   EQU   NCPSUB+4                                                 02558000
NCPPTR   EQU   NCPSUB                                                   02559000
LRELRESV EQU   LRECLSUB+7                                               02560000
LRECRESV EQU   LRECFLAG                                                 02561000
LRECPRES EQU   LRECFLAG                                                 02562000
LRECLLEN EQU   LRECLSUB+4                                               02563000
LRECLPTR EQU   LRECLSUB                                                 02564000
KEYLRESV EQU   KEYLESUB+7                                               02565000
RSVKEYLE EQU   KEYLFLAG                                                 02566000
KEYLPRES EQU   KEYLFLAG                                                 02567000
KEYLLEN  EQU   KEYLESUB+4                                               02568000
KEYLEPTR EQU   KEYLESUB                                                 02569000
BUFNRESV EQU   BUFNOSUB+7                                               02570000
RSVBUFNO EQU   BUFNFLAG                                                 02571000
BUFNPRES EQU   BUFNFLAG                                                 02572000
BUFNOLEN EQU   BUFNOSUB+4                                               02573000
BUFNOPTR EQU   BUFNOSUB                                                 02574000
BUFLRESV EQU   BUFLSUB+7                                                02575000
RSVBUFL  EQU   BUFLFLAG                                                 02576000
BUFLPRES EQU   BUFLFLAG                                                 02577000
BUFLLEN  EQU   BUFLSUB+4                                                02578000
BUFLPTR  EQU   BUFLSUB                                                  02579000
BUFFRESV EQU   BUFOFSUB+7                                               02580000
RSVBUFOF EQU   BUFFFLAG                                                 02581000
BUFFPRES EQU   BUFFFLAG                                                 02582000
BUFOFLEN EQU   BUFOFSUB+4                                               02583000
BUFOFPTR EQU   BUFOFSUB                                                 02584000
BLKSRESV EQU   BLKSISUB+7                                               02585000
RSVBLKSI EQU   BLKSFLAG                                                 02586000
BLKSPRES EQU   BLKSFLAG                                                 02587000
BLKSILEN EQU   BLKSISUB+4                                               02588000
BLKSIPTR EQU   BLKSISUB                                                 02589000
BFTEKSUB EQU   ATTRPDL+54                                               02590000
BFALNSUB EQU   ATTRPDL+52                                               02591000
LIMCTWD  EQU   ATTRPDL+48                                               02592000
DIAGNSWD EQU   ATTRPDL+44                                               02593000
OUTPTWD  EQU   INPUTKWD                                                 02594000
RECFMKWD EQU   ATTRPDL+38                                               02595000
OPTCDKWD EQU   ATTRPDL+36                                               02596000
NCPKWD   EQU   ATTRPDL+34                                               02597000
EROPTKWD EQU   ATTRPDL+28                                               02598000
BUFNOKWD EQU   ATTRPDL+24                                               02599000
BUFLKWD  EQU   ATTRPDL+22                                               02600000
BLKSIKWD EQU   ATTRPDL+20                                               02601000
BFTEKWD  EQU   ATTRPDL+18                                               02602000
BFALNKWD EQU   ATTRPDL+16                                               02603000
ATTRRSVD EQU   ATNPDE+7                                                 02604000
RSVATN   EQU   ATNFLAGS                                                 02605000
ATNPRES  EQU   ATNFLAGS                                                 02606000
ATNLEN   EQU   ATNPDE+4                                                 02607000
ATNPTR   EQU   ATNPDE                                                   02608000
@NM00007 EQU   ATTRPDL+4                                                02609000
@NM00006 EQU   ATTRPDL                                                  02610000
@NM00001 EQU   ADDBLOCK+2                                               02611000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02612000
@RC00130 EQU   @RC00128                                                 02613000
@RF00271 EQU   @EL00001                                                 02614000
@RT00328 EQU   FRMTEND                                                  02615000
@RC00430 EQU   @RC00428                                                 02616000
@RC00495 EQU   @RC00493                                                 02617000
@ENDDATA EQU   *                                                        02618000
         END   IKJEFATT,(C'PLS2104',0701,77124)                         02619000
