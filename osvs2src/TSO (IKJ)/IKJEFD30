         TITLE 'ALLOCATE COMMAND PROCESSOR                             *00001000
                        '                                               00002000
IKJEFD30 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFD30  76.163'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @12,0                                               0001 00012000
@PSTART  DS    0H                                                  0001 00013000
         USING @PSTART,@12                                         0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @11,@01                                             0001 00017000
         USING @DATD,@11                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @11,8(,@13)                                         0001 00021000
         LR    @13,@11                                             0001 00022000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00023000
         MVC   @PC00001(4),0(@01)                                  0001 00024000
*        AWAPTR = ADDR(WACORE);         /* PTR TO WORK AREA          */ 00025000
         LA    AWAPTR,WACORE                                       0067 00026000
*        WACORE = WACORE && WACORE;     /* ZERO OUT WORKAREA         */ 00027000
         XC    WACORE(192),WACORE                                  0068 00028000
*        CPPLPTR = R1;                  /* GET INPUT PARAMETERS      */ 00029000
         ST    R1,CPPLPTR(,AWAPTR)                                 0069 00030000
*        CALL INITIAL;                  /* PERFORM INITIALIZATION    */ 00031000
         BAL   @14,INITIAL                                         0070 00032000
*        CALL COMMSCAN;                 /* SYNTAX CHECK THE COMMAND  */ 00033000
*                                                                  0071 00034000
         BAL   @14,COMMSCAN                                        0071 00035000
*        IF RBCODE12 = '0'B THEN        /* IF SUCCESSFUL,            */ 00036000
         TM    RBCODE12(AWAPTR),B'10000000'                        0072 00037000
         BNZ   @RF00072                                            0072 00038000
*          CALL REQTYPE;                /* PROCESS REQUEST           */ 00039000
*                                                                  0073 00040000
         BAL   @14,REQTYPE                                         0073 00041000
*        CALL EXIT1;                    /* PERFORM CLEAN-UP          */ 00042000
@RF00072 BAL   @14,EXIT1                                           0074 00043000
*        RETURN CODE(RTRNCODE);         /* RETURN TO CALLER          */ 00044000
         L     @10,RGSVAREA(,R13)                                  0075 00045000
         L     @10,RTRNCODE(,@10)                                  0075 00046000
         L     @13,4(,@13)                                         0075 00047000
         L     @00,@SIZDATD                                        0075 00048000
         LR    @01,@11                                             0075 00049000
         FREEMAIN R,LV=(0),A=(1)                                        00050000
         LR    @15,@10                                             0075 00051000
         L     @14,12(,@13)                                        0075 00052000
         LM    @00,@12,20(@13)                                     0075 00053000
         BR    @14                                                 0075 00054000
*/********************************************************************/ 00055000
*/*                                                                  */ 00056000
*/* SEGMENT NAME -                                                   */ 00057000
*/*      INITIAL                                                     */ 00058000
*/*                                                                  */ 00059000
*/* FUNCTION -                                                       */ 00060000
*/*      THIS ROUTINE INITIALIZES THE ALLOCATE WORKAREA              */ 00061000
*/*      AND THE GENTRANS PARAMETER LIST.                            */ 00062000
*/*                                                                  */ 00063000
*/* OPERATION -                                                      */ 00064000
*/*      KNOWN FIELDS IN THE WORKAREA ARE FILLED IN AT THIS TIME.    */ 00065000
*/*      THE GENTRANS PARAMETER LIST IS FILLED IN AS MUCH AS         */ 00066000
*/*      POSSIBLE.                                                   */ 00067000
*/*                                                                  */ 00068000
*/* INPUT -                                                          */ 00069000
*/*      CPPL                                                        */ 00070000
*/*                                                                  */ 00071000
*/* OUTPUT -                                                         */ 00072000
*/*      WORKAREA AND GENTRANS PARAMETER LIST                        */ 00073000
*/*                                                                  */ 00074000
*/********************************************************************/ 00075000
*                                                                  0076 00076000
*    INITIAL: PROC;                                                0076 00077000
INITIAL  STM   @14,@12,12(@13)                                     0076 00078000
*        TXT = ADDR(ADDUNIT);          /* INIT ADDBLOCK PTR          */ 00079000
         LA    @10,ADDUNIT                                         0077 00080000
         ST    @10,TXT(,AWAPTR)                                    0077 00081000
*        PTRMSGS = ADDR(IKJEFD31);     /* PTR TO MESSAGE MODULE      */ 00082000
         L     @10,@CV00044                                        0078 00083000
         ST    @10,PTRMSGS(,AWAPTR)                                0078 00084000
*        MSGPTR = ADDR(MSGAREA);       /* PTR TO MSG AREA            */ 00085000
         LA    @10,MSGAREA                                         0079 00086000
         ST    @10,MSGPTR(,AWAPTR)                                 0079 00087000
*        MSGAREA = ''X;                /* ZERO MSG AREA      @YM05479*/ 00088000
         XC    MSGAREA(64),MSGAREA                                 0080 00089000
*    /* SET UP GENTRANS PARAMETER LIST                               */ 00090000
*        GTPLPTR = ADDR(GTPLAREA);     /* PTR TO PARM LIST           */ 00091000
         LA    @10,GTPLAREA                                        0081 00092000
         ST    @10,GTPLPTR(,AWAPTR)                                0081 00093000
*        KEY2 = KEY1;                  /* COPY KEYLIST               */ 00094000
         MVC   KEY2(80),KEY1                                       0082 00095000
*        GTPLKLST = ADDR(KEYLIST);     /* KEYLIST ADDRESS            */ 00096000
         LA    @03,KEYLIST                                         0083 00097000
         ST    @03,GTPLKLST(,@10)                                  0083 00098000
*        GTPLTBLE = ADDR(KEYWDTAB);    /* KEYWORD TABLE ADDRESS      */ 00099000
         LA    @03,KEYWDTAB                                        0084 00100000
         ST    @03,GTPLTBLE(,@10)                                  0084 00101000
*        GTPLABLK = ADDR(TEXTCORE);    /* ADDBLOCK ADDRESS           */ 00102000
         LA    @03,TEXTCORE                                        0085 00103000
         ST    @03,GTPLABLK(,@10)                                  0085 00104000
*        GTPLOUTA = 0;                 /* OUTPUT ADDRESS -SET TO 0   */ 00105000
         SLR   @03,@03                                             0086 00106000
         ST    @03,GTPLOUTA(,@10)                                  0086 00107000
*        ADDNUM = 0;                   /* INIT ADDBLOCK COUNTER      */ 00108000
         STH   @03,ADDNUM                                          0087 00109000
*    END INITIAL;                                                  0088 00110000
@EL00002 DS    0H                                                  0088 00111000
@EF00002 DS    0H                                                  0088 00112000
@ER00002 LM    @14,@12,12(@13)                                     0088 00113000
         BR    @14                                                 0088 00114000
*                                                                  0089 00115000
*                                                                  0089 00116000
*/********************************************************************/ 00117000
*/*                                                                  */ 00118000
*/* SEGMENT NAME -                                                   */ 00119000
*/*      COMMSCAN                                                    */ 00120000
*/*                                                                  */ 00121000
*/* FUNCTION -                                                       */ 00122000
*/*      THIS ROUTINE INVOKES THE PARSE SERVICE ROUTINE AND EXAMINES */ 00123000
*/*      THE RETURN CODE FROM PARSE.                                 */ 00124000
*/*                                                                  */ 00125000
*/* OPERATION -                                                      */ 00126000
*/*      THE PARSE PARAMETER LIST IS SET UP, AND PARSE IS INVOKED.   */ 00127000
*/*      IF THE RETURN CODE FROM PARSE IS 0, ROUTINE REQTYPE IS      */ 00128000
*/*      INVOKED. IF THE RETURN CODE IS 4 (NO PROMPT MODE),          */ 00129000
*/*      TERMINATE. IF RETURN CODE IS 16, ISSUE MESSAGE INDICATING   */ 00130000
*/*      NOT ENOUGH MAIN STORAGE TO EXECUTE COMMAND, AND TERMINATE.  */ 00131000
*/*      FOR ANY OTHER NON-ZERO RETURN CODE, ISSUE A MESSAGE GIVING  */ 00132000
*/*      THE RETURN CODE, AND TERMINATE.                             */ 00133000
*/*                                                                  */ 00134000
*/* INPUT -                                                          */ 00135000
*/*      WORKAREA                                                    */ 00136000
*/*                                                                  */ 00137000
*/* OUTPUT -                                                         */ 00138000
*/*      COMMAND PROCESSED OR                                        */ 00139000
*/*      ERROR MESSAGE                                               */ 00140000
*/*                                                                  */ 00141000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */ 00142000
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */ 00143000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */ 00144000
*/********************************************************************/ 00145000
*   COMMSCAN:  PROC;                                               0089 00146000
COMMSCAN STM   @14,@12,@SA00003                                    0089 00147000
*        PPLPTR = ADDR(PPLCORE);       /* PTR TO PPL                 */ 00148000
         LA    @10,PPLCORE                                         0090 00149000
         ST    @10,PPLPTR(,AWAPTR)                                 0090 00150000
*        PPLUPT = CPPLUPT;             /* UPT IN PPL                 */ 00151000
         L     @03,CPPLPTR(,AWAPTR)                                0091 00152000
         MVC   PPLUPT(4,@10),CPPLUPT(@03)                          0091 00153000
*        PPLECT = CPPLECT;             /* ECT IN PPL                 */ 00154000
         MVC   PPLECT(4,@10),CPPLECT(@03)                          0092 00155000
*        PPLECB = ADDR(COMMECB);       /* ECB IN PPL                 */ 00156000
         LA    @03,COMMECB(,AWAPTR)                                0093 00157000
         ST    @03,PPLECB(,@10)                                    0093 00158000
*        COMMECB = 0;                  /* SET ECB TO 0               */ 00159000
         SLR   @10,@10                                             0094 00160000
         ST    @10,COMMECB(,AWAPTR)                                0094 00161000
*        ENTRYCD = 1;                  /* INDICATE MAIN CALL TO PARSE*/ 00162000
         MVC   ENTRYCD(2,AWAPTR),@CH00034                          0095 00163000
*        R1 = AWAPTR;                  /* WORKAREA PTR IN REG 1      */ 00164000
         LR    R1,AWAPTR                                           0096 00165000
*        CALL IKJEFD37;                /* INVOKE PARSE               */ 00166000
         L     @15,@CV00047                                        0097 00167000
         BALR  @14,@15                                             0097 00168000
*        IF RCODESV > 0 THEN           /* IF PARSE FAILED,           */ 00169000
         L     @10,RCODESV(,AWAPTR)                                0098 00170000
         LTR   @10,@10                                             0098 00171000
         BNP   @RF00098                                            0098 00172000
*          DO;                         /* THEN                       */ 00173000
*            IF AWARSV1 = '1'B THEN    /* IF MSG ALREADY ISSUED,     */ 00174000
         TM    AWARSV1(AWAPTR),B'00000010'                         0100 00175000
         BNO   @RF00100                                            0100 00176000
*              DO;                     /*                    @YM05479*/ 00177000
*                AWARSV1 = '0'B;       /* TURN OFF INDICATOR         */ 00178000
*                RBCODE12 = '1'B;      /* INDICATE ALLOC ERR @YM05479*/ 00179000
         OI    RBCODE12(AWAPTR),B'10000000'                        0103 00180000
         NI    AWARSV1(AWAPTR),B'11111101'                         0103 00181000
*              END;                    /*                    @YM05479*/ 00182000
*            ELSE                                                  0105 00183000
*              DO;                     /* OTHERWISE,                 */ 00184000
         B     @RC00100                                            0105 00185000
@RF00100 DS    0H                                                  0106 00186000
*            ENTRYCD = 2;              /* INDICATE PARSE ERROR       */ 00187000
         MVC   ENTRYCD(2,AWAPTR),@CH00067                          0106 00188000
*            R1 = AWAPTR;              /* PTR TO WORKAREA IN REG 1   */ 00189000
         LR    R1,AWAPTR                                           0107 00190000
*            CALL IKJEFD35;            /* ISSUE ERROR MESSAGE        */ 00191000
         L     @15,@CV00048                                        0108 00192000
         BALR  @14,@15                                             0108 00193000
*              END;                                                0109 00194000
*          END;                                                    0110 00195000
*        ELSE                          /* IF PARSE SUCCESSFUL,       */ 00196000
*          DO;                                                     0111 00197000
         B     @RC00098                                            0111 00198000
@RF00098 DS    0H                                                  0112 00199000
*            GTPLPDL = PTRPDL;         /* PDL ADDRESS IN GTPL        */ 00200000
         L     @10,GTPLPTR(,AWAPTR)                                0112 00201000
         MVC   GTPLPDL(4,@10),PTRPDL(AWAPTR)                       0112 00202000
*            GTPLPCL = PPLPCL;         /* PCL ADDRESS IN GTPL        */ 00203000
         L     @03,PPLPTR(,AWAPTR)                                 0113 00204000
         MVC   GTPLPCL(4,@10),PPLPCL(@03)                          0113 00205000
*          END;                                                    0114 00206000
*   END  COMMSCAN;                                                 0115 00207000
@EL00003 DS    0H                                                  0115 00208000
@EF00003 DS    0H                                                  0115 00209000
@ER00003 LM    @14,@12,@SA00003                                    0115 00210000
         BR    @14                                                 0115 00211000
*/********************************************************************/ 00212000
*/*                                                                  */ 00213000
*/* SEGMENT NAME -                                                   */ 00214000
*/*      REQTYPE                                                     */ 00215000
*/*                                                                  */ 00216000
*/* FUNCTION -                                                       */ 00217000
*/*      THIS ROUTINE DETERMINES THE TYPE OF ALLOCATION REQUEST      */ 00218000
*/*      BEING MADE, AND ROUTES CONTROL TO THE APPROPRIATE           */ 00219000
*/*      PROCESSOR.                                                  */ 00220000
*/*                                                                  */ 00221000
*/* OPERATION -                                                      */ 00222000
*/*      IF STATUS WAS NOT ENTERED, BUT SPACE PARAMETERS ARE ENTERED */ 00223000
*/*      THEN THE STATUS IS DEFAULTED TO NEW. IF STATUS NOT ENTERED  */ 00224000
*/*      BUT DATASET NAME SPECIFIED, STATUS IS DEFAULTED TO OLD.     */ 00225000
*/*      OTHERWISE, THE USER IS PROMPTED TO ENTER STATUS.  IF THE    */ 00226000
*/*      REQUEST IS FOR A DUMMY DATA SET, INVOKE DMMYREQ. IF REQUEST */ 00227000
*/*      IS FOR DATA SET CONCATENATION, INVOKE CONCATRQ. IF REQUEST  */ 00228000
*/*      IS FOR TERMINAL, INVOKE TERMREQ. IF REQUEST IS FOR SYSOUT   */ 00229000
*/*      DATA SET, INVOKE SYSOTREQ.  OTHERWISE, DETERMINE DATA SET   */ 00230000
*/*      STATUS.                                                     */ 00231000
*/*                                                                  */ 00232000
*/* INPUT -                                                          */ 00233000
*/*      PTR TO PDL                                                  */ 00234000
*/*                                                                  */ 00235000
*/* OUTPUT -                                                         */ 00236000
*/*      REQUEST PROCESSED                                           */ 00237000
*/*                                                                  */ 00238000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */ 00239000
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */ 00240000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */ 00241000
*/********************************************************************/ 00242000
*REQTYPE: PROC;                                                    0116 00243000
REQTYPE  STM   @14,@12,@SA00004                                    0116 00244000
*   IF VLISTCTR > 255 THEN             /* IF OVER 255 VOLSERS        */ 00245000
         LH    @10,VLISTCTR(,AWAPTR)                               0117 00246000
         CH    @10,@CH00804                                        0117 00247000
         BNH   @RF00117                                            0117 00248000
*     DO;                              /* THEN                       */ 00249000
*       MSGID = '112A';                /* SET MESSAGE ID             */ 00250000
         L     @10,MSGPTR(,AWAPTR)                                 0119 00251000
         MVC   MSGID(4,@10),@CC00805                               0119 00252000
*       CALL PUTMSG;                   /* ISSUE ERROR MESSAGE        */ 00253000
         BAL   @14,PUTMSG                                          0120 00254000
*     END;                                                         0121 00255000
*   ELSE                               /* ELSE                       */ 00256000
*     IF MBRPRES = '1'B &              /* IF MEMBER NAME SPECIFIED   */ 00257000
*        DSNNEXT = PDECMPRE &          /* AND NOT CONCAT REQUEST     */ 00258000
*        DISPPDE = 2 THEN              /* AND DELETE SPECIFIED       */ 00259000
         B     @RC00117                                            0122 00260000
@RF00117 L     @10,PTRPDL(,AWAPTR)                                 0122 00261000
         TM    MBRPRES(@10),B'10000000'                            0122 00262000
         BNO   @RF00122                                            0122 00263000
         CLC   DSNNEXT(4,@10),PDECMPRE                             0122 00264000
         BNE   @RF00122                                            0122 00265000
         CLC   DISPPDE(2,@10),@CH00067                             0122 00266000
         BNE   @RF00122                                            0122 00267000
*       DO;                            /* THEN                       */ 00268000
*         ENTRYCD = 5;                 /* SET ENTRY CODE             */ 00269000
         MVC   ENTRYCD(2,AWAPTR),@CH00070                          0124 00270000
*         R1 = AWAPTR;                 /* WORKAREA PTR IN REG 1      */ 00271000
         LR    R1,AWAPTR                                           0125 00272000
*         CALL IKJEFD35;               /* ISSUE ERROR MESSAGE        */ 00273000
         L     @15,@CV00048                                        0126 00274000
         BALR  @14,@15                                             0126 00275000
*       END;                                                       0127 00276000
*     ELSE                             /* ELSE                       */ 00277000
*       DO;                                                        0128 00278000
         B     @RC00122                                            0128 00279000
@RF00122 DS    0H                                                  0129 00280000
*         S99RB = S99RB && S99RB;      /* INIT REQUEST BLOCK         */ 00281000
         XC    S99RB(20),S99RB                                     0129 00282000
*         S99RBLN = LENGTH(S99RB);     /* LENGTH OF RB IN RB         */ 00283000
         MVI   S99RBLN,X'14'                                       0130 00284000
*         S99VERB = S99VRBAL;          /* VERB CODE IN RB            */ 00285000
         MVI   S99VERB,X'01'                                       0131 00286000
*         S99RBPTR = ADDR(S99RB);      /* PTR TO REQUEST BLOCK       */ 00287000
         LA    @10,S99RB                                           0132 00288000
         ST    @10,S99RBPTR                                        0132 00289000
*         PTRS99RB = S99RBPTR;         /* PTR TO RB IN WORKAREA      */ 00290000
         ST    @10,PTRS99RB(,AWAPTR)                               0133 00291000
*         IF STATSPDE = 0 THEN         /* IF STATUS NOT SPECIFIED,   */ 00292000
         SLR   @10,@10                                             0134 00293000
         L     @03,PTRPDL(,AWAPTR)                                 0134 00294000
         CH    @10,STATSPDE(,@03)                                  0134 00295000
         BNE   @RF00134                                            0134 00296000
*           DO;                        /* THEN                       */ 00297000
*             IF BLOKPDE > 0 |         /* IF BLOCK,                  */ 00298000
*                SPACEPDE > 0 |        /* SPACE, OR                  */ 00299000
*                DIRPDE > 0 THEN       /* DIR PARAMETERS SPECIFIED,  */ 00300000
         CH    @10,BLOKPDE(,@03)                                   0136 00301000
         BL    @RT00136                                            0136 00302000
         CH    @10,SPACEPDE(,@03)                                  0136 00303000
         BL    @RT00136                                            0136 00304000
         CH    @10,DIRPDE(,@03)                                    0136 00305000
         BNL   @RF00136                                            0136 00306000
@RT00136 DS    0H                                                  0137 00307000
*               STATSPDE = 4;          /* DEFAULT STATUS TO NEW      */ 00308000
         L     @10,PTRPDL(,AWAPTR)                                 0137 00309000
         MVC   STATSPDE(2,@10),@CH00322                            0137 00310000
*             ELSE                     /* ELSE                       */ 00311000
*               IF DSPDE > 0 THEN      /* IF DSNAME SPECIFIED,       */ 00312000
         B     @RC00136                                            0138 00313000
@RF00136 L     @10,PTRPDL(,AWAPTR)                                 0138 00314000
         LH    @03,DSPDE(,@10)                                     0138 00315000
         LTR   @03,@03                                             0138 00316000
         BNP   @RF00138                                            0138 00317000
*                 STATSPDE = 1;        /* DEFAULT STATUS TO OLD      */ 00318000
         MVC   STATSPDE(2,@10),@CH00034                            0139 00319000
*               ELSE                   /* ELSE                       */ 00320000
*                 CALL PRMPTSTS;       /* PROMPT FOR STATUS          */ 00321000
         B     @RC00138                                            0140 00322000
@RF00138 BAL   @14,PRMPTSTS                                        0140 00323000
*           END;                                                   0141 00324000
@RC00138 DS    0H                                                  0141 00325000
@RC00136 DS    0H                                                  0142 00326000
*         IF RBCODE12 = '0'B THEN      /* IF STATUS PROMPT SUCCESSFUL*/ 00327000
@RF00134 TM    RBCODE12(AWAPTR),B'10000000'                        0142 00328000
         BNZ   @RF00142                                            0142 00329000
*           DO;                        /* THEN                       */ 00330000
*             IF DSPDE = 1 &           /* IF CONCATENATION REQUEST   */ 00331000
*                DSNNEXT ^= PDECMPRE THEN                          0144 00332000
         L     @10,PTRPDL(,AWAPTR)                                 0144 00333000
         CLC   DSPDE(2,@10),@CH00034                               0144 00334000
         BNE   @RF00144                                            0144 00335000
         CLC   DSNNEXT(4,@10),PDECMPRE                             0144 00336000
         BE    @RF00144                                            0144 00337000
*               DO;                                                0145 00338000
*               R1 = AWAPTR;           /* WORKAREA PTR IN REG 1      */ 00339000
         LR    R1,AWAPTR                                           0146 00340000
*                                      /* CALL CONCAT ROUTINE        */ 00341000
*               CALL IKJEFD34;                                     0147 00342000
         L     @15,@CV00046                                        0147 00343000
         BALR  @14,@15                                             0147 00344000
*               END;                                               0148 00345000
*             ELSE                     /* ELSE                       */ 00346000
*               DO;                                                0149 00347000
         B     @RC00144                                            0149 00348000
@RF00144 DS    0H                                                  0150 00349000
*               R1 = AWAPTR;           /* WORKAREA PTR IN REG 1      */ 00350000
         LR    R1,AWAPTR                                           0150 00351000
*                                      /* CALL OTHER REQUEST ROUTINE */ 00352000
*               CALL IKJEFD32;                                     0151 00353000
         L     @15,@CV00045                                        0151 00354000
         BALR  @14,@15                                             0151 00355000
*               END;                                               0152 00356000
*           END;                                                   0153 00357000
*       END;                                                       0154 00358000
*END REQTYPE;                                                      0155 00359000
@EL00004 DS    0H                                                  0155 00360000
@EF00004 DS    0H                                                  0155 00361000
@ER00004 LM    @14,@12,@SA00004                                    0155 00362000
         BR    @14                                                 0155 00363000
*/********************************************************************/ 00364000
*/*                                                                  */ 00365000
*/* SEGMENT NAME -                                                   */ 00366000
*/*      EXIT1                                                       */ 00367000
*/*                                                                  */ 00368000
*/* FUNCTION -                                                       */ 00369000
*/*      THIS ROUTINE PERFORMS CLEAN-UP BEFORE RETURNING TO TMP.     */ 00370000
*/*                                                                  */ 00371000
*/* OPERATION -                                                      */ 00372000
*/*      IF THE POINTER TO THE PDL IS NON-ZERO, THEN THE PDL STORAGE */ 00373000
*/*      IS RELEASED. IF ALLOCATE WAS UNSUCCESSFUL, THE STACK IS     */ 00374000
*/*      FLUSHED AND THE RETURN CODE IS SET TO 12.                   */ 00375000
*/*                                                                  */ 00376000
*/* INPUT -                                                          */ 00377000
*/*      PTR TO PDL                                                  */ 00378000
*/*      RBCODE12 = 1 - ALLOCATE UNSUCCESSFUL                        */ 00379000
*/*                                                                  */ 00380000
*/* OUTPUT -                                                         */ 00381000
*/*      PDL STORAGE RELEASED, AND                                   */ 00382000
*/*      STACK FLUSHED,IF NECESSARY                                  */ 00383000
*/*      RETURN CODE = 0 - SUCCESSFUL                                */ 00384000
*/*                   12 - UNSUCCESSFUL                              */ 00385000
*/*                                                                  */ 00386000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */ 00387000
*/*        BE INCORPORATED AS AN INLCUDED CODE SEGMENT WHEN THE      */ 00388000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */ 00389000
*/*                                                                  */ 00390000
*/********************************************************************/ 00391000
*    EXIT1: PROC;                                                  0156 00392000
EXIT1    STM   @14,@12,@SA00005                                    0156 00393000
*        IF PTRPDL ^= 0 THEN           /* IF PDL CREATED,            */ 00394000
         L     @10,PTRPDL(,AWAPTR)                                 0157 00395000
         LTR   @10,@10                                             0157 00396000
         BZ    @RF00157                                            0157 00397000
*          DO;                                                     0158 00398000
*            R3 = ADDR(PTRPDL);        /* PUT ADDRESS IN REG 3       */ 00399000
         LA    R3,PTRPDL(,AWAPTR)                                  0159 00400000
*            GEN (IKJRLSA (3));        /* RELEASE THE PDL            */ 00401000
         IKJRLSA (3)                                                    00402000
*          END;                                                    0161 00403000
*        IF GTPLOUTA ^= 0 THEN         /* IF TEXT CORE TO FREE,      */ 00404000
@RF00157 L     @10,GTPLPTR(,AWAPTR)                                0162 00405000
         L     @10,GTPLOUTA(,@10)                                  0162 00406000
         LTR   @10,@10                                             0162 00407000
         BZ    @RF00162                                            0162 00408000
*          DO;                                                     0163 00409000
*            R0 = SBPLSIZE;            /* SUPBOOL AND SIZE IN REG 0  */ 00410000
         L     R0,SBPLSIZE(,@10)                                   0164 00411000
*            R1 = GTPLOUTA;            /* ADDRESS IN REG 1           */ 00412000
         LR    R1,@10                                              0165 00413000
*            GEN (FREEMAIN R,LV=(0),A=(1));  /* ISSUE FREEMAIN       */ 00414000
         FREEMAIN R,LV=(0),A=(1)                                        00415000
*          END;                                                    0167 00416000
*        IF RBCODE12 = '1'B THEN       /* IF ALLOCATE FAILED,        */ 00417000
@RF00162 TM    RBCODE12(AWAPTR),B'10000000'                        0168 00418000
         BNO   @RF00168                                            0168 00419000
*          DO;                         /* FLUSH THE STACK            */ 00420000
*        GEN DATA;                                                 0170 00421000
*/* MOVE LIST FORM INTO GEN DATA AREA                                */ 00422000
*            GEN (MVC STACKLSD(LISTE-LISTB),STACKLST);             0171 00423000
         MVC STACKLSD(LISTE-LISTB),STACKLST                             00424000
*            STPLPTR = ADDR(STPLAREA);                             0172 00425000
         LA    STPLPTR,STPLAREA                                    0172 00426000
*            STPLUPT = CPPLUPT;                                    0173 00427000
         L     @10,CPPLPTR(,AWAPTR)                                0173 00428000
         MVC   STPLUPT(4,STPLPTR),CPPLUPT(@10)                     0173 00429000
*            STPLECT = CPPLECT;                                    0174 00430000
         MVC   STPLECT(4,STPLPTR),CPPLECT(@10)                     0174 00431000
*            STPLECB = ADDR(COMMECB);                              0175 00432000
         LA    @10,COMMECB(,AWAPTR)                                0175 00433000
         ST    @10,STPLECB(,STPLPTR)                               0175 00434000
*            COMMECB = 0;                                          0176 00435000
         SLR   @10,@10                                             0176 00436000
         ST    @10,COMMECB(,AWAPTR)                                0176 00437000
*            R3 = ADDR(STACKLSD);                                  0177 00438000
         LA    R3,STACKLSD                                         0177 00439000
*            R1 = STPLPTR;                                         0178 00440000
         LR    R1,STPLPTR                                          0178 00441000
*            GEN (STACK PARM=(R3),DELETE=ALL,MF=(E,(1)));          0179 00442000
         STACK PARM=(R3),DELETE=ALL,MF=(E,(1))                          00443000
*            GEN (TCLEARQ INPUT);                                  0180 00444000
         TCLEARQ INPUT                                                  00445000
*            RTRNCODE = 12;            /* SET RETURN CODE TO 12      */ 00446000
         L     @10,RGSVAREA(,R13)                                  0181 00447000
         MVC   RTRNCODE(4,@10),@CF00812                            0181 00448000
*          END;                                                    0182 00449000
*        ELSE                          /* ELSE,                      */ 00450000
*          RTRNCODE = 0;               /* SET RETURN CODE TO 0       */ 00451000
         B     @RC00168                                            0183 00452000
@RF00168 L     @10,RGSVAREA(,R13)                                  0183 00453000
         SLR   @15,@15                                             0183 00454000
         ST    @15,RTRNCODE(,@10)                                  0183 00455000
*   END EXIT1;                                                     0184 00456000
@EL00005 DS    0H                                                  0184 00457000
@EF00005 DS    0H                                                  0184 00458000
@ER00005 LM    @14,@12,@SA00005                                    0184 00459000
         BR    @14                                                 0184 00460000
*/********************************************************************/ 00461000
*/*                                                                  */ 00462000
*/* SEGMENT NAME -                                                   */ 00463000
*/*      PRMPTSTS                                                    */ 00464000
*/*                                                                  */ 00465000
*/* FUNCTION -                                                       */ 00466000
*/*      THIS ROUTINE PROMPTS THE USER FOR A STATUS WHEN IT IS       */ 00467000
*/*      REQUIRED.                                                   */ 00468000
*/*                                                                  */ 00469000
*/* OPERATION -                                                      */ 00470000
*/*      PARSE IS INVOKED WITH A SECONDARY PCL AND PDL ADDRESS.  IF  */ 00471000
*/*      PARSE SUCCESSFUL, SAVE THE PARAMETER ENTERED AND RELEASE    */ 00472000
*/*      THE SECONDARY PDL.                                          */ 00473000
*/*                                                                  */ 00474000
*/* INPUT -                                                          */ 00475000
*/*      PTR TO PDL                                                  */ 00476000
*/*                                                                  */ 00477000
*/* OUTPUT -                                                         */ 00478000
*/*      PDL OVERLAID WITH PROMPT DATA                               */ 00479000
*/*                                                                  */ 00480000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCITON AND CAN    */ 00481000
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */ 00482000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */ 00483000
*/********************************************************************/ 00484000
*     PRMPTSTS: PROC;                                              0185 00485000
PRMPTSTS STM   @14,@12,@SA00006                                    0185 00486000
*        ENTRYCD = 2;                  /* INDICATE PROMPT FOR STATUS */ 00487000
         MVC   ENTRYCD(2,AWAPTR),@CH00067                          0186 00488000
*        R1 = AWAPTR;                  /* WORKAREA PTR IN REG 1      */ 00489000
         LR    R1,AWAPTR                                           0187 00490000
*        CALL IKJEFD37;                /* INVOKE PARSE               */ 00491000
         L     @15,@CV00047                                        0188 00492000
         BALR  @14,@15                                             0188 00493000
*        IF RCODESV > 0 THEN           /* IF PARSE FAILED,           */ 00494000
         L     @10,RCODESV(,AWAPTR)                                0189 00495000
         LTR   @10,@10                                             0189 00496000
         BNP   @RF00189                                            0189 00497000
*          DO;                         /* THEN                       */ 00498000
*            ENTRYCD = 2;              /* INDICATE PARSE ERROR       */ 00499000
         MVC   ENTRYCD(2,AWAPTR),@CH00067                          0191 00500000
*            R1 = AWAPTR;              /* WROKAREA PTR IN REG 1      */ 00501000
         LR    R1,AWAPTR                                           0192 00502000
*            CALL IKJEFD35;            /* ISSUE ERROR MESSAGE        */ 00503000
         L     @15,@CV00048                                        0193 00504000
         BALR  @14,@15                                             0193 00505000
*          END;                                                    0194 00506000
*        ELSE                                                      0195 00507000
*          DO;                         /* ELSE,                      */ 00508000
         B     @RC00189                                            0195 00509000
@RF00189 DS    0H                                                  0196 00510000
*            RFY R5 RSTD;              /* RESTRICT REG 5             */ 00511000
*            R5 = ADDR(PMPTPDL);       /* PDL ADDRESS IN REG 5       */ 00512000
         LA    R5,PMPTPDL(,AWAPTR)                                 0197 00513000
*            GEN (IKJRLSA (5));        /* RELEASE PDL                */ 00514000
         IKJRLSA (5)                                                    00515000
*            RFY R5 UNRSTD;            /* UNRESTRICT REG 5           */ 00516000
*          END;                                                    0200 00517000
*    END PRMPTSTS;                                                 0201 00518000
@EL00006 DS    0H                                                  0201 00519000
@EF00006 DS    0H                                                  0201 00520000
@ER00006 LM    @14,@12,@SA00006                                    0201 00521000
         BR    @14                                                 0201 00522000
*/********************************************************************/ 00523000
*/*                                                                  */ 00524000
*/* SEGMENT NAME -                                                   */ 00525000
*/*      PUTMSG                                                      */ 00526000
*/*                                                                  */ 00527000
*/* FUNCTION -                                                       */ 00528000
*/*      THIS ROUTINE INVOKES IKJEFF02 TO ISSUE MESSAGES             */ 00529000
*/*                                                                  */ 00530000
*/* OPERATION -                                                       * 00531000
*/*      THE PARAMETER LIST FOR THE MESSAGE PROCESSOR IKJEFF02 IS    */ 00532000
*/*      COMPLETED. IKJEFF02 IS LINKED TO. AN INDICATOR IS SET       */ 00533000
*/*      SHOWING ALLOCATE HAS FAILED.                                */ 00534000
*/*                                                                  */ 00535000
*/* INPUT -                                                          */ 00536000
*/*      IKJEFF02 PARAMETER LIST                                     */ 00537000
*/*                                                                  */ 00538000
*/* OUTPUT -                                                         */ 00539000
*/*      MESSAGE ISSUED                                              */ 00540000
*/*                                                                  */ 00541000
*/********************************************************************/ 00542000
*PUTMSG: PROC;                                                     0202 00543000
PUTMSG   STM   @14,@12,@SA00007                                    0202 00544000
*   LISTPTR = ADDR(MSGCSECT);                                      0203 00545000
         L     @10,MSGPTR(,AWAPTR)                                 0203 00546000
         LA    @03,MSGCSECT(,@10)                                  0203 00547000
         ST    @03,LISTPTR(,@10)                                   0203 00548000
*   MTCPPL = CPPLPTR;                                              0204 00549000
         MVC   MTCPPL(4,@10),CPPLPTR(AWAPTR)                       0204 00550000
*   ECBPTR = ADDR(COMMECB);            /* POINTER TO ECB             */ 00551000
         LA    @03,COMMECB(,AWAPTR)                                0205 00552000
         ST    @03,ECBPTR(,@10)                                    0205 00553000
*   COMMECB = 0;                       /* INIT ECB TO 0              */ 00554000
         SLR   @03,@03                                             0206 00555000
         ST    @03,COMMECB(,AWAPTR)                                0206 00556000
*   MTHIGH = '1'B;                     /* HIGH ORDER BIT ON          */ 00557000
         OI    MTHIGH(@10),B'10000000'                             0207 00558000
*   MTPUTLSW = '1'B;                   /* INDICATE PUTLINE           */ 00559000
         OI    MTPUTLSW(@10),B'01000000'                           0208 00560000
*   MSGCSECT = PTRMSGS;                /* ADDRESS OF MSG CSECT       */ 00561000
*                                                                  0209 00562000
         MVC   MSGCSECT(4,@10),PTRMSGS(AWAPTR)                     0209 00563000
*   VAR1 = DSNPTR;                     /* PTR TO DSNAME VARIABLE     */ 00564000
         L     @03,PTRPDL(,AWAPTR)                                 0210 00565000
         MVC   VAR1(3,@10),DSNPTR+1(@03)                           0210 00566000
*   L1 = DSNLENGH;                     /* LENGTH OF DSNAME VARIABLE  */ 00567000
         MVC   L1(1,@10),DSNLENGH+1(@03)                           0211 00568000
*   R1 = ADDR(MSGTABLE);                                           0212 00569000
         LR    R1,@10                                              0212 00570000
*   GEN (LINK EP=IKJEFF02);                                        0213 00571000
*                                                                  0213 00572000
         LINK EP=IKJEFF02                                               00573000
*   RBCODE12 = '1'B;                   /* INDICATE ALLOC FAILED      */ 00574000
         OI    RBCODE12(AWAPTR),B'10000000'                        0214 00575000
*END PUTMSG;                                                       0215 00576000
@EL00007 DS    0H                                                  0215 00577000
@EF00007 DS    0H                                                  0215 00578000
@ER00007 LM    @14,@12,@SA00007                                    0215 00579000
         BR    @14                                                 0215 00580000
*        GENERATE;                                                 0216 00581000
         DS 0F                                                          00582000
LISTB    EQU *                                                          00583000
STACKLST STACK MF=L                                                     00584000
LISTE    EQU *                                                          00585000
*    END IKJEFD30                                                  0217 00586000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00587000
*/*%INCLUDE SYSLIB  (IKJZT430)                                        * 00588000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                        * 00589000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        * 00590000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 00591000
*/*%INCLUDE SYSLIB  (IKJSTPL )                                        * 00592000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                        * 00593000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                        * 00594000
*/*%INCLUDE SYSLIB  (IKJZB831)                                        * 00595000
*;                                                                 0217 00596000
@EL00001 L     @13,4(,@13)                                         0217 00597000
@EF00001 L     @00,@SIZDATD                                        0217 00598000
         LR    @01,@11                                             0217 00599000
         FREEMAIN R,LV=(0),A=(1)                                        00600000
@ER00001 L     @14,12(,@13)                                        0217 00601000
         LM    @00,@12,20(@13)                                     0217 00602000
         BR    @14                                                 0217 00603000
@DATA    DS    0H                                                       00604000
@CH00034 DC    H'1'                                                     00605000
@CH00067 DC    H'2'                                                     00606000
@CH00322 DC    H'4'                                                     00607000
@CH00070 DC    H'5'                                                     00608000
@CH00804 DC    H'255'                                                   00609000
@DATD    DSECT                                                          00610000
         DS    0F                                                       00611000
@SA00001 DS    18F                                                      00612000
@PC00001 DS    1F                                                       00613000
@SA00004 DS    15F                                                      00614000
@SA00005 DS    15F                                                      00615000
@SA00007 DS    15F                                                      00616000
@SA00006 DS    15F                                                      00617000
@SA00003 DS    0F                                                       00618000
         DS    15F                                                      00619000
@ZTEMPS  DS    C                                                        00620000
@ZTEMPND EQU   *                                                        00621000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00622000
IKJEFD30 CSECT                                                          00623000
         DS    0F                                                       00624000
@CF00812 DC    F'12'                                                    00625000
@DATD    DSECT                                                          00626000
         DS    0D                                                       00627000
S99RBPTR DS    AL4                                                      00628000
         ORG   S99RBPTR                                                 00629000
S99RBPND DS    BL1                                                      00630000
         ORG   S99RBPTR+4                                               00631000
S99TUFP  DS    A                                                        00632000
WACORE   DS    CL192                                                    00633000
MSGAREA  DS    CL64                                                     00634000
PPLCORE  DS    CL28                                                     00635000
STPLAREA DS    CL16                                                     00636000
TEXTCORE DS    CL96                                                     00637000
         ORG   TEXTCORE                                                 00638000
ADDNUM   DS    FL2                                                      00639000
@NM00012 DS    FL2                                                      00640000
ADDTEXT  DS    8AL4                                                     00641000
ADDUNIT  DS    CL60                                                     00642000
         ORG   TEXTCORE+96                                              00643000
S99RB    DS    CL20                                                     00644000
         ORG   S99RB                                                    00645000
S99RBLN  DS    CL1                                                      00646000
S99VERB  DS    CL1                                                      00647000
S99FLAG1 DS    CL2                                                      00648000
         ORG   S99FLAG1                                                 00649000
S99FLG11 DS    CL1                                                      00650000
         ORG   S99FLG11                                                 00651000
S99ONCNV DS    BL1                                                      00652000
S99NOCNV EQU   S99FLG11+0                                               00653000
S99NOMNT EQU   S99FLG11+0                                               00654000
S99JBSYS EQU   S99FLG11+0                                               00655000
         ORG   S99FLAG1+1                                               00656000
S99FLG12 DS    CL1                                                      00657000
         ORG   S99RB+4                                                  00658000
S99RSC   DS    CL4                                                      00659000
         ORG   S99RSC                                                   00660000
S99ERROR DS    CL2                                                      00661000
S99INFO  DS    CL2                                                      00662000
         ORG   S99RB+8                                                  00663000
S99TXTPP DS    AL4                                                      00664000
S99RSV01 DS    FL4                                                      00665000
S99FLAG2 DS    CL4                                                      00666000
         ORG   S99FLAG2                                                 00667000
S99FLG21 DS    CL1                                                      00668000
         ORG   S99FLG21                                                 00669000
S99WTVOL DS    BL1                                                      00670000
S99WTDSN EQU   S99FLG21+0                                               00671000
S99NORES EQU   S99FLG21+0                                               00672000
S99WTUNT EQU   S99FLG21+0                                               00673000
S99OFFLN EQU   S99FLG21+0                                               00674000
S99TIONQ EQU   S99FLG21+0                                               00675000
S99CATLG EQU   S99FLG21+0                                               00676000
S99MOUNT EQU   S99FLG21+0                                               00677000
         ORG   S99FLAG2+1                                               00678000
S99FLG22 DS    CL1                                                      00679000
         ORG   S99FLG22                                                 00680000
S99UDEVT DS    BL1                                                      00681000
S99PCINT EQU   S99FLG22+0                                               00682000
         ORG   S99FLAG2+2                                               00683000
S99FLG23 DS    CL1                                                      00684000
S99FLG24 DS    CL1                                                      00685000
         ORG   S99RB+20                                                 00686000
GTPLAREA DS    CL24                                                     00687000
KEYLIST  DS    40H                                                      00688000
IKJEFD30 CSECT                                                          00689000
         DS    0F                                                       00690000
@SIZDATD DC    AL1(1)                                                   00691000
         DC    AL3(@ENDDATD-@DATD)                                      00692000
@CV00044 DC    V(IKJEFD31)                                              00693000
@CV00045 DC    V(IKJEFD32)                                              00694000
@CV00046 DC    V(IKJEFD34)                                              00695000
@CV00047 DC    V(IKJEFD37)                                              00696000
@CV00048 DC    V(IKJEFD35)                                              00697000
         DS    0D                                                       00698000
@CC00805 DC    C'112A'                                                  00699000
PDECMPRE DC    X'FF000000'                                              00700000
KEYWDTAB DS    CL77                                                     00701000
         ORG   KEYWDTAB                                                 00702000
STATSTB  DS    CL8                                                      00703000
         ORG   STATSTB                                                  00704000
STSKEY   DC    X'0004'                                                  00705000
STSCNT   DC    AL2(4)                                                   00706000
STATS1   DC    X'01'                                                    00707000
STATS2   DC    X'08'                                                    00708000
STATS3   DC    X'02'                                                    00709000
STATS4   DC    X'04'                                                    00710000
         ORG   KEYWDTAB+8                                               00711000
DISPTB   DS    CL8                                                      00712000
         ORG   DISPTB                                                   00713000
DSPKEY   DC    X'0005'                                                  00714000
DSPCNT   DC    AL2(4)                                                   00715000
DISP1    DC    X'08'                                                    00716000
DISP2    DC    X'04'                                                    00717000
DISP3    DC    X'02'                                                    00718000
DISP4    DC    X'01'                                                    00719000
         ORG   KEYWDTAB+16                                              00720000
TRKSTB   DS    CL7                                                      00721000
         ORG   TRKSTB                                                   00722000
TRKSKEY  DC    X'0007'                                                  00723000
TRKSCNT  DC    AL2(3)                                                   00724000
TRKS1    DC    X'FF'                                                    00725000
TRKS2    DC    X'FF'                                                    00726000
TRKS3    DC    X'00'                                                    00727000
         ORG   KEYWDTAB+23                                              00728000
CYLSTB   DS    CL8                                                      00729000
         ORG   CYLSTB                                                   00730000
CYLSKEY  DC    X'0008'                                                  00731000
CYLSCNT  DC    AL2(4)                                                   00732000
CYLS1    DC    X'FF'                                                    00733000
CYLS2    DC    X'FF'                                                    00734000
CYLS3    DC    X'FF'                                                    00735000
CYLS4    DC    X'00'                                                    00736000
         ORG   KEYWDTAB+31                                              00737000
RLSETB   DS    CL5                                                      00738000
         ORG   RLSETB                                                   00739000
RLSEKEY  DC    X'000D'                                                  00740000
RLSECNT  DC    AL2(1)                                                   00741000
RLSE1    DC    X'00'                                                    00742000
         ORG   KEYWDTAB+36                                              00743000
RNDTB    DS    CL5                                                      00744000
         ORG   RNDTB                                                    00745000
RNDKEY   DC    X'000F'                                                  00746000
RNDCNT   DC    AL2(1)                                                   00747000
RND1     DC    X'00'                                                    00748000
         ORG   KEYWDTAB+41                                              00749000
PRIVTB   DS    CL5                                                      00750000
         ORG   PRIVTB                                                   00751000
PRIVKEY  DC    X'0011'                                                  00752000
PRIVCNT  DC    AL2(1)                                                   00753000
PRIV1    DC    X'00'                                                    00754000
         ORG   KEYWDTAB+46                                              00755000
PARLTB   DS    CL6                                                      00756000
         ORG   PARLTB                                                   00757000
PARLKEY  DC    X'0017'                                                  00758000
PARLCNT  DC    AL2(2)                                                   00759000
PARL1    DC    X'FF'                                                    00760000
PARL2    DC    X'00'                                                    00761000
         ORG   KEYWDTAB+52                                              00762000
LABLTB   DS    CL12                                                     00763000
         ORG   LABLTB                                                   00764000
LABLKEY  DC    X'001E'                                                  00765000
LABLCNT  DC    AL2(8)                                                   00766000
LABL1    DC    X'02'                                                    00767000
LABL2    DC    X'0A'                                                    00768000
LABL3    DC    X'40'                                                    00769000
LABL4    DC    X'48'                                                    00770000
LABL5    DC    X'01'                                                    00771000
LABL6    DC    X'04'                                                    00772000
LABL7    DC    X'21'                                                    00773000
LABL8    DC    X'10'                                                    00774000
         ORG   KEYWDTAB+64                                              00775000
DUMMYTB  DS    CL6                                                      00776000
         ORG   DUMMYTB                                                  00777000
DMYKEY   DC    X'0024'                                                  00778000
CMYCNT   DC    AL2(2)                                                   00779000
DMY1     DC    X'FF'                                                    00780000
DMY2     DC    X'00'                                                    00781000
         ORG   KEYWDTAB+70                                              00782000
HOLDTB   DS    CL5                                                      00783000
         ORG   HOLDTB                                                   00784000
HOLDKEY  DC    X'0059'                                                  00785000
HOLDCNT  DC    AL2(1)                                                   00786000
HOLD1    DC    X'00'                                                    00787000
         ORG   KEYWDTAB+75                                              00788000
ENDTB    DS    CL2                                                      00789000
         ORG   ENDTB                                                    00790000
ENDKEY   DC    X'FFFF'                                                  00791000
         ORG   KEYWDTAB+77                                              00792000
         DS    CL1                                                      00793000
KYLIST   DC    XL2'0024'                                                00794000
         DC    XL2'0002'                                                00795000
         DC    XL2'0000'                                                00796000
         DC    XL2'0001'                                                00797000
         DC    XL2'0004'                                                00798000
         DC    XL2'0018'                                                00799000
         DC    XL2'0000'                                                00800000
         DC    XL2'0010'                                                00801000
         DC    XL2'0000'                                                00802000
         DC    XL2'0009'                                                00803000
         DC    XL2'0000'                                                00804000
         DC    XL2'000A'                                                00805000
         DC    XL2'0000'                                                00806000
         DC    XL2'000C'                                                00807000
         DC    XL2'0000'                                                00808000
         DC    XL2'002D'                                                00809000
         DC    XL2'0000'                                                00810000
         DC    XL2'0058'                                                00811000
         DC    XL2'0059'                                                00812000
         DC    XL2'0000'                                                00813000
         DC    XL2'0000'                                                00814000
         DC    XL2'0015'                                                00815000
         DC    XL2'0017'                                                00816000
         DC    XL2'0016'                                                00817000
         DC    XL2'0000'                                                00818000
         DC    XL2'001E'                                                00819000
         DC    XL2'0000'                                                00820000
         DC    XL2'001F'                                                00821000
         DC    XL2'0000'                                                00822000
         DC    XL2'0013'                                                00823000
         DC    XL2'0011'                                                00824000
         DC    XL2'0000'                                                00825000
         DC    XL2'0000'                                                00826000
         DC    XL2'0012'                                                00827000
         DC    XL2'000D'                                                00828000
         DC    XL2'0000'                                                00829000
         DC    XL2'000F'                                                00830000
         DC    XL2'0000'                                                00831000
         DC    XL2'0005'                                                00832000
         DC    XL2'0000'                                                00833000
         DS    CL2                                                      00834000
PATCH    DC    25F'0'                                                   00835000
@DATD    DSECT                                                          00836000
         DS    0F                                                       00837000
STACKLSD STACK MF=L                                                     00838000
@DATD    DSECT                                                          00839000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00840000
@ENDDATD EQU   *                                                        00841000
IKJEFD30 CSECT                                                          00842000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00843000
@01      EQU   01                                                       00844000
@02      EQU   02                                                       00845000
@03      EQU   03                                                       00846000
@04      EQU   04                                                       00847000
@05      EQU   05                                                       00848000
@06      EQU   06                                                       00849000
@07      EQU   07                                                       00850000
@08      EQU   08                                                       00851000
@09      EQU   09                                                       00852000
@10      EQU   10                                                       00853000
@11      EQU   11                                                       00854000
@12      EQU   12                                                       00855000
@13      EQU   13                                                       00856000
@14      EQU   14                                                       00857000
@15      EQU   15                                                       00858000
STPLPTR  EQU   @04                                                      00859000
AWAPTR   EQU   @02                                                      00860000
R0       EQU   @00                                                      00861000
R1       EQU   @01                                                      00862000
R3       EQU   @03                                                      00863000
R5       EQU   @05                                                      00864000
R13      EQU   @13                                                      00865000
R14      EQU   @14                                                      00866000
R15      EQU   @15                                                      00867000
ALLOCWA  EQU   0                                                        00868000
CPPLPTR  EQU   ALLOCWA                                                  00869000
PTRPDL   EQU   ALLOCWA+4                                                00870000
GTPLPTR  EQU   ALLOCWA+8                                                00871000
SWITCH   EQU   ALLOCWA+12                                               00872000
RBCODE12 EQU   SWITCH                                                   00873000
AWARSV1  EQU   SWITCH                                                   00874000
SWITCH2  EQU   ALLOCWA+13                                               00875000
ENTRYCD  EQU   ALLOCWA+14                                               00876000
TXT      EQU   ALLOCWA+16                                               00877000
PTRS99RB EQU   ALLOCWA+20                                               00878000
RCODESV  EQU   ALLOCWA+24                                               00879000
VLISTCTR EQU   ALLOCWA+28                                               00880000
PTRMSGS  EQU   ALLOCWA+32                                               00881000
VCFLAGS  EQU   ALLOCWA+36                                               00882000
PMPTPDL  EQU   ALLOCWA+40                                               00883000
MSGPTR   EQU   ALLOCWA+48                                               00884000
CMDTWO   EQU   ALLOCWA+60                                               00885000
COMMECB  EQU   ALLOCWA+160                                              00886000
PPLPTR   EQU   ALLOCWA+172                                              00887000
ALLOCPDL EQU   0                                                        00888000
DSPDE    EQU   ALLOCPDL+8                                               00889000
STATSPDE EQU   ALLOCPDL+12                                              00890000
BLOKPDE  EQU   ALLOCPDL+16                                              00891000
SPACEPDE EQU   ALLOCPDL+18                                              00892000
DIRPDE   EQU   ALLOCPDL+20                                              00893000
DISPPDE  EQU   ALLOCPDL+46                                              00894000
DSNPDE   EQU   ALLOCPDL+48                                              00895000
DSNPTR   EQU   DSNPDE                                                   00896000
DSNLENGH EQU   DSNPDE+4                                                 00897000
DSNFLAGS EQU   DSNPDE+6                                                 00898000
MBRPTR   EQU   DSNPDE+8                                                 00899000
MBRFLAGS EQU   DSNPDE+14                                                00900000
MBRPRES  EQU   MBRFLAGS                                                 00901000
PASSPTR  EQU   DSNPDE+16                                                00902000
PASSFLAG EQU   DSNPDE+22                                                00903000
DSNNEXT  EQU   DSNPDE+24                                                00904000
DDNMEPDE EQU   ALLOCPDL+76                                              00905000
DDNPTR   EQU   DDNMEPDE                                                 00906000
DDNFLAGS EQU   DDNMEPDE+6                                               00907000
CLASPDE  EQU   ALLOCPDL+84                                              00908000
CLASPTR  EQU   CLASPDE                                                  00909000
CLASFLG  EQU   CLASPDE+6                                                00910000
SERPDE   EQU   ALLOCPDL+92                                              00911000
SERPTR   EQU   SERPDE                                                   00912000
SERFLAGS EQU   SERPDE+6                                                 00913000
BLKPDE   EQU   ALLOCPDL+104                                             00914000
BLKPTR   EQU   BLKPDE                                                   00915000
BLKFLAGS EQU   BLKPDE+6                                                 00916000
ABLKPDE  EQU   ALLOCPDL+112                                             00917000
ABLKPTR  EQU   ABLKPDE                                                  00918000
ABLKFLG  EQU   ABLKPDE+6                                                00919000
SPACPDE  EQU   ALLOCPDL+120                                             00920000
SPACEPTR EQU   SPACPDE                                                  00921000
SPACEFLG EQU   SPACPDE+6                                                00922000
SPACPDE2 EQU   ALLOCPDL+128                                             00923000
SPACPTR2 EQU   SPACPDE2                                                 00924000
SPACFLG2 EQU   SPACPDE2+6                                               00925000
DIRECPDE EQU   ALLOCPDL+136                                             00926000
DIRPTR   EQU   DIRECPDE                                                 00927000
DIRFLAGS EQU   DIRECPDE+6                                               00928000
ATTRPDE  EQU   ALLOCPDL+144                                             00929000
ATTRPTR  EQU   ATTRPDE                                                  00930000
ATTRFLAG EQU   ATTRPDE+6                                                00931000
USIDPDE  EQU   ALLOCPDL+152                                             00932000
USIDPTR  EQU   USIDPDE                                                  00933000
USIDFLAG EQU   USIDPDE+6                                                00934000
UTYPPDE  EQU   ALLOCPDL+160                                             00935000
UTYPPTR  EQU   UTYPPDE                                                  00936000
UTYPFLAG EQU   UTYPPDE+6                                                00937000
UNCNTPDE EQU   ALLOCPDL+168                                             00938000
UCNTPTR  EQU   UNCNTPDE                                                 00939000
UCNTFLAG EQU   UNCNTPDE+6                                               00940000
POSTPDE  EQU   ALLOCPDL+180                                             00941000
POSPTR   EQU   POSTPDE                                                  00942000
POSFLAG  EQU   POSTPDE+6                                                00943000
MXVOLPDE EQU   ALLOCPDL+188                                             00944000
MXVOLPTR EQU   MXVOLPDE                                                 00945000
MXVOLFLG EQU   MXVOLPDE+6                                               00946000
VOLSQPDE EQU   ALLOCPDL+196                                             00947000
VOLSQPTR EQU   VOLSQPDE                                                 00948000
VOLSQFLG EQU   VOLSQPDE+6                                               00949000
MSVGPDE  EQU   ALLOCPDL+204                                             00950000
MSVGPTR  EQU   MSVGPDE                                                  00951000
MSVGFLG  EQU   MSVGPDE+6                                                00952000
DSNBUF   EQU   0                                                        00953000
MSGTABLE EQU   0                                                        00954000
LISTPTR  EQU   MSGTABLE                                                 00955000
TMCTPTR  EQU   MSGTABLE+4                                               00956000
MTCPPL   EQU   TMCTPTR                                                  00957000
ECBPTR   EQU   MSGTABLE+8                                               00958000
@NM00007 EQU   MSGTABLE+12                                              00959000
MTHIGH   EQU   @NM00007                                                 00960000
MSGCSECT EQU   MSGTABLE+16                                              00961000
SW       EQU   MSGTABLE+20                                              00962000
MTPUTLSW EQU   SW                                                       00963000
RETMSG   EQU   MSGTABLE+21                                              00964000
SW2      EQU   MSGTABLE+24                                              00965000
MSGID    EQU   MSGTABLE+40                                              00966000
MTINSRTS EQU   MSGTABLE+44                                              00967000
L1       EQU   MTINSRTS                                                 00968000
VAR1     EQU   MTINSRTS+1                                               00969000
L2       EQU   MTINSRTS+4                                               00970000
L3       EQU   MTINSRTS+8                                               00971000
L4       EQU   MTINSRTS+12                                              00972000
RET      EQU   0                                                        00973000
CPPL     EQU   0                                                        00974000
CPPLUPT  EQU   CPPL+4                                                   00975000
CPPLECT  EQU   CPPL+12                                                  00976000
RGSVAREA EQU   4                                                        00977000
RTRNCODE EQU   16                                                       00978000
PPL      EQU   0                                                        00979000
PPLUPT   EQU   PPL                                                      00980000
PPLECT   EQU   PPL+4                                                    00981000
PPLECB   EQU   PPL+8                                                    00982000
PPLPCL   EQU   PPL+12                                                   00983000
STPL     EQU   0                                                        00984000
STPLUPT  EQU   STPL                                                     00985000
STPLECT  EQU   STPL+4                                                   00986000
STPLECB  EQU   STPL+8                                                   00987000
TEXTRET  EQU   0                                                        00988000
SBPLSIZE EQU   TEXTRET                                                  00989000
S99TUPL  EQU   0                                                        00990000
S99TUPTR EQU   S99TUPL                                                  00991000
S99TUP   EQU   0                                                        00992000
S99TUNIT EQU   0                                                        00993000
S99TUENT EQU   S99TUNIT+4                                               00994000
S99TUFLD EQU   0                                                        00995000
GTPL     EQU   0                                                        00996000
GTPLPDL  EQU   GTPL                                                     00997000
GTPLPCL  EQU   GTPL+4                                                   00998000
GTPLKLST EQU   GTPL+8                                                   00999000
GTPLTBLE EQU   GTPL+12                                                  01000000
GTPLABLK EQU   GTPL+16                                                  01001000
GTPLOUTA EQU   GTPL+20                                                  01002000
ABLKBUF  EQU   0                                                        01003000
ATTRBUF  EQU   0                                                        01004000
BLKBUF   EQU   0                                                        01005000
CLASSBUF EQU   0                                                        01006000
DDNBUF   EQU   0                                                        01007000
DIRBUF   EQU   0                                                        01008000
MBRBUF   EQU   0                                                        01009000
MSGECB   EQU   0                                                        01010000
MSGTMCT  EQU   0                                                        01011000
MSVGBUF  EQU   0                                                        01012000
MXVOLBUF EQU   0                                                        01013000
PASSBUF  EQU   0                                                        01014000
POSTBUF  EQU   0                                                        01015000
SERBUF   EQU   0                                                        01016000
SPACBUF2 EQU   0                                                        01017000
SPACEBUF EQU   0                                                        01018000
UCNTBUF  EQU   0                                                        01019000
USIDBUF  EQU   0                                                        01020000
UTYPBUF  EQU   0                                                        01021000
VSEQBUF  EQU   0                                                        01022000
TMCTPARM EQU   0                                                        01023000
KEY2     EQU   KEYLIST                                                  01024000
KEY1     EQU   KYLIST                                                   01025000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01026000
S99TUPRM EQU   S99TUFLD+2                                               01027000
S99TULEN EQU   S99TUFLD                                                 01028000
S99TUPAR EQU   S99TUENT+2                                               01029000
S99TULNG EQU   S99TUENT                                                 01030000
S99TUNUM EQU   S99TUNIT+2                                               01031000
S99TUKEY EQU   S99TUNIT                                                 01032000
S99TUPND EQU   S99TUP                                                   01033000
S99TUPLN EQU   S99TUPTR                                                 01034000
STPLSTPB EQU   STPL+12                                                  01035000
PPLUWA   EQU   PPL+24                                                   01036000
PPLCBUF  EQU   PPL+20                                                   01037000
PPLANS   EQU   PPL+16                                                   01038000
CPPLPSCB EQU   CPPL+8                                                   01039000
CPPLCBUF EQU   CPPL                                                     01040000
RETCHAR  EQU   RET+2                                                    01041000
RETSIZE  EQU   RET                                                      01042000
MSGRTN   EQU   MSGTABLE+60                                              01043000
VAR4     EQU   MTINSRTS+13                                              01044000
HIGHL4   EQU   L4                                                       01045000
VAR3     EQU   MTINSRTS+9                                               01046000
HIGHL3   EQU   L3                                                       01047000
VAR2     EQU   MTINSRTS+5                                               01048000
HIGHL2   EQU   L2                                                       01049000
HIGHL1   EQU   L1                                                       01050000
@NM00011 EQU   MSGTABLE+36                                              01051000
@NM00010 EQU   MSGTABLE+32                                              01052000
MTOLDPTR EQU   MSGTABLE+28                                              01053000
@NM00009 EQU   MSGTABLE+25                                              01054000
@NM00008 EQU   SW2                                                      01055000
MTPGMSW  EQU   SW2                                                      01056000
MTNPLMSW EQU   SW2                                                      01057000
MTNOXQSW EQU   SW2                                                      01058000
MTDOMSW  EQU   SW2                                                      01059000
MT2OLDSW EQU   SW2                                                      01060000
MTNHEXSW EQU   SW                                                       01061000
MTWTPSW  EQU   SW                                                       01062000
MTJOBISW EQU   SW                                                       01063000
MTKEY1SW EQU   SW                                                       01064000
MTHEXSW  EQU   SW                                                       01065000
MTWTOSW  EQU   SW                                                       01066000
MTNOIDSW EQU   SW                                                       01067000
DSNTERM  EQU   DSNBUF                                                   01068000
MSVGRSV2 EQU   MSVGPDE+7                                                01069000
MSVGRSV1 EQU   MSVGFLG                                                  01070000
MSVGPRES EQU   MSVGFLG                                                  01071000
MSVGLEN  EQU   MSVGPDE+4                                                01072000
VOLRSV2  EQU   VOLSQPDE+7                                               01073000
VOLRSV1  EQU   VOLSQFLG                                                 01074000
VOLPRES  EQU   VOLSQFLG                                                 01075000
VOLSQLEN EQU   VOLSQPDE+4                                               01076000
MXVRSV2  EQU   MXVOLPDE+7                                               01077000
MXVRSV1  EQU   MXVOLFLG                                                 01078000
MXVPRES  EQU   MXVOLFLG                                                 01079000
MXVOLLEN EQU   MXVOLPDE+4                                               01080000
POSRSV2  EQU   POSTPDE+7                                                01081000
POSRSV1  EQU   POSFLAG                                                  01082000
POSPRES  EQU   POSFLAG                                                  01083000
POSLEN   EQU   POSTPDE+4                                                01084000
LABLRSV1 EQU   ALLOCPDL+178                                             01085000
LABELPDE EQU   ALLOCPDL+176                                             01086000
UCNTRSV2 EQU   UNCNTPDE+7                                               01087000
UCNTRSV1 EQU   UCNTFLAG                                                 01088000
UCNTPRES EQU   UCNTFLAG                                                 01089000
UCNTLEN  EQU   UNCNTPDE+4                                               01090000
UTYPRSV2 EQU   UTYPPDE+7                                                01091000
UTYPRSV1 EQU   UTYPFLAG                                                 01092000
UTYPPRES EQU   UTYPFLAG                                                 01093000
UTYPLEN  EQU   UTYPPDE+4                                                01094000
USIDRSV2 EQU   USIDPDE+7                                                01095000
USIDRSV1 EQU   USIDFLAG                                                 01096000
USIDPRES EQU   USIDFLAG                                                 01097000
USIDLEN  EQU   USIDPDE+4                                                01098000
ATTRRSV2 EQU   ATTRPDE+7                                                01099000
ATTRRSV1 EQU   ATTRFLAG                                                 01100000
ATTRPRES EQU   ATTRFLAG                                                 01101000
ATTRLEN  EQU   ATTRPDE+4                                                01102000
DIRRSV2  EQU   DIRECPDE+7                                               01103000
DIRRSV1  EQU   DIRFLAGS                                                 01104000
DIRPRES  EQU   DIRFLAGS                                                 01105000
DIRLEN   EQU   DIRECPDE+4                                               01106000
SPCRSV22 EQU   SPACPDE2+7                                               01107000
SPCRSV12 EQU   SPACFLG2                                                 01108000
SPCPRES2 EQU   SPACFLG2                                                 01109000
SPACLEN2 EQU   SPACPDE2+4                                               01110000
SPACRSV2 EQU   SPACPDE+7                                                01111000
SPACRSV1 EQU   SPACEFLG                                                 01112000
SPACPRES EQU   SPACEFLG                                                 01113000
SPACELEN EQU   SPACPDE+4                                                01114000
ABLKRSV2 EQU   ABLKPDE+7                                                01115000
ABLKRSV1 EQU   ABLKFLG                                                  01116000
ABLKPRES EQU   ABLKFLG                                                  01117000
ABLKLEN  EQU   ABLKPDE+4                                                01118000
BLKRSV2  EQU   BLKPDE+7                                                 01119000
BLKRSV1  EQU   BLKFLAGS                                                 01120000
BLKPRES  EQU   BLKFLAGS                                                 01121000
BLKLEN   EQU   BLKPDE+4                                                 01122000
SERNEXT  EQU   SERPDE+8                                                 01123000
SERRSV2  EQU   SERPDE+7                                                 01124000
SERRSV1  EQU   SERFLAGS                                                 01125000
SERPRES  EQU   SERFLAGS                                                 01126000
SERLEN   EQU   SERPDE+4                                                 01127000
CLASRSV2 EQU   CLASPDE+7                                                01128000
CLASRSV1 EQU   CLASFLG                                                  01129000
CLASPRES EQU   CLASFLG                                                  01130000
CLASLEN  EQU   CLASPDE+4                                                01131000
DDNRSV2  EQU   DDNMEPDE+7                                               01132000
DDNRSV1  EQU   DDNFLAGS                                                 01133000
DDNPRES  EQU   DDNFLAGS                                                 01134000
DDNLEN   EQU   DDNMEPDE+4                                               01135000
PASSRSV2 EQU   DSNPDE+23                                                01136000
PASSRSV1 EQU   PASSFLAG                                                 01137000
PASSPRES EQU   PASSFLAG                                                 01138000
PASSLEN  EQU   DSNPDE+20                                                01139000
MBRRSV2  EQU   DSNPDE+15                                                01140000
MBRRSV1  EQU   MBRFLAGS                                                 01141000
MBRLEN   EQU   DSNPDE+12                                                01142000
DSNRSV2  EQU   DSNPDE+7                                                 01143000
DSNRSV1  EQU   DSNFLAGS                                                 01144000
DSNQUOT  EQU   DSNFLAGS                                                 01145000
DSNPRES  EQU   DSNFLAGS                                                 01146000
RNDPDE   EQU   ALLOCPDL+44                                              01147000
RLSEPDE  EQU   ALLOCPDL+42                                              01148000
VSEQPDE  EQU   ALLOCPDL+40                                              01149000
PRIVPDE  EQU   ALLOCPDL+38                                              01150000
MAXVPDE  EQU   ALLOCPDL+36                                              01151000
POSPDE   EQU   ALLOCPDL+34                                              01152000
LABLPDE  EQU   ALLOCPDL+32                                              01153000
UCNTPDE  EQU   ALLOCPDL+30                                              01154000
UNITPDE  EQU   ALLOCPDL+28                                              01155000
HOLDPDE  EQU   ALLOCPDL+26                                              01156000
DESTPDE  EQU   ALLOCPDL+24                                              01157000
USINGPDE EQU   ALLOCPDL+22                                              01158000
VOLPDE   EQU   ALLOCPDL+14                                              01159000
FILEPDE  EQU   ALLOCPDL+10                                              01160000
@NM00006 EQU   ALLOCPDL+4                                               01161000
@NM00005 EQU   ALLOCPDL                                                 01162000
FIRSTPTR EQU   ALLOCWA+176                                              01163000
NBLKBUF1 EQU   ALLOCWA+164                                              01164000
PDLADDR3 EQU   ALLOCWA+156                                              01165000
PPLTWO   EQU   ALLOCWA+128                                              01166000
CMDTWOBF EQU   CMDTWO+4                                                 01167000
CMDTWOOF EQU   CMDTWO+2                                                 01168000
CMDTWOLN EQU   CMDTWO                                                   01169000
Q        EQU   ALLOCWA+56                                               01170000
P        EQU   ALLOCWA+52                                               01171000
PRCODE   EQU   ALLOCWA+44                                               01172000
@NM00004 EQU   ALLOCWA+38                                               01173000
NCLASBUF EQU   ALLOCWA+37                                               01174000
@NM00003 EQU   VCFLAGS                                                  01175000
SPACE2   EQU   VCFLAGS                                                  01176000
SPACE1   EQU   VCFLAGS                                                  01177000
AVBLK    EQU   VCFLAGS                                                  01178000
DSNCTR   EQU   ALLOCWA+30                                               01179000
@NM00002 EQU   SWITCH2                                                  01180000
DSEXISTS EQU   SWITCH2                                                  01181000
@NM00001 EQU   SWITCH2                                                  01182000
FIRSTPDE EQU   SWITCH                                                   01183000
ASTRSK   EQU   SWITCH                                                   01184000
TERMOPT  EQU   SWITCH                                                   01185000
CONT     EQU   SWITCH                                                   01186000
PROMPT   EQU   SWITCH                                                   01187000
DSOVRLAY EQU   SWITCH                                                   01188000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01189000
@RC00098 EQU   @EL00003                                                 01190000
@RC00122 EQU   @EL00004                                                 01191000
@RC00117 EQU   @EL00004                                                 01192000
@RF00142 EQU   @EL00004                                                 01193000
@RC00144 EQU   @EL00004                                                 01194000
@RC00168 EQU   @EL00005                                                 01195000
@RC00189 EQU   @EL00006                                                 01196000
@RC00100 EQU   @RC00098                                                 01197000
@ENDDATA EQU   *                                                        01198000
         END   IKJEFD30,(C'PLS2056',0701,76163)                         01199000
