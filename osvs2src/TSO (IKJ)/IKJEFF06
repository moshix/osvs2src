         TITLE 'IKJEFF06 - JCL CARD CONTROL ROUTINE                    *00001000
                       '                                                00002000
IKJEFF06 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFF06  73.230'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0025 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* PROCESS A JCL CARD - ORIGINAL ENTRY IS FROM IKJEFF05 (AFTER IT*/ 00026000
*   /* READS A NEW CARD) - REENTERED FROM IKJEFF08 (TO PROCESS A     */ 00027000
*   /* GENERATED JOB CARD) - REENTERED FROM IKJEFF09 (IF INSTALLATION*/ 00028000
*   /* EXIT CHANGED OR GENERATED A CARD) - REENTERED FROM IKJEFF13   */ 00029000
*   /* (IF CHANGES THE JOB CARD BECAUSE THE JOBNAME WAS THE TSO      */ 00030000
*   /* USERID)                                                       */ 00031000
*   /*                                                               */ 00032000
*   /*****************************************************************/ 00033000
*                                                                  0025 00034000
*   CONLIST=CONPTR;                 /* INTERNAL PTR TO CONTROL TABLE */ 00035000
         L     @10,@PC00001                                        0025 00036000
         L     CONLIST,CONPTR(,@10)                                0025 00037000
*   HTPTR=HISTPT;                   /* INTERNAL PTR TO HISTORY TABLE */ 00038000
         L     HTPTR,HISTPT(,CONLIST)                              0026 00039000
*   INCONTRL=INCONTRL+1;            /* INCRE CONTROL CTR             */ 00040000
         LA    @10,1                                               0027 00041000
         SLR   @15,@15                                             0027 00042000
         IC    @15,INCONTRL(,HTPTR)                                0027 00043000
         AR    @10,@15                                             0027 00044000
         STC   @10,INCONTRL(,HTPTR)                                0027 00045000
*   CALL CODECHK;                   /* CHECK FOR ZERO STMT PTR OR  0028 00046000
*                                      QUIT RIGHT AWAY               */ 00047000
*                                                                  0028 00048000
         BAL   @14,CODECHK                                         0028 00049000
*   /*****************************************************************/ 00050000
*   /*                                                               */ 00051000
*   /* IDENTIFY THIS JCL CARD                                        */ 00052000
*   /*                                                               */ 00053000
*   /*****************************************************************/ 00054000
*                                                                  0029 00055000
*   CALL IKJEFF07(HISTFLD,STMTPT,NEXTNAME);                        0029 00056000
         ST    HTPTR,@AL00001                                      0029 00057000
         LA    @10,STMTPT(,CONLIST)                                0029 00058000
         ST    @10,@AL00001+4                                      0029 00059000
         L     @10,JOBNAMPT(,CONLIST)                              0029 00060000
         LA    @10,NEXTNAME(,@10)                                  0029 00061000
         ST    @10,@AL00001+8                                      0029 00062000
         L     @15,@CV00171                                        0029 00063000
         LA    @01,@AL00001                                        0029 00064000
         BALR  @14,@15                                             0029 00065000
*   IF FLUSH='1'B&CJOB='0'B THEN    /* FORGET EVERYTHING EXCEPT JOBS    00066000
*                                      IF FLUSH IS ON (MEANS PRIOR 0030 00067000
*                                      CARD WAS A NULL)              */ 00068000
         TM    FLUSH(HTPTR),B'01000000'                            0030 00069000
         BNO   @RF00030                                            0030 00070000
         TM    CJOB(HTPTR),B'00010000'                             0030 00071000
         BZ    @RT00030                                            0030 00072000
*     GO TO FINISH;                 /* PREPARE TO GET NEXT CARD      */ 00073000
*                                                                  0031 00074000
*   /*****************************************************************/ 00075000
*   /*                                                               */ 00076000
*   /* DATA CARD (PUT IT)                                            */ 00077000
*   /*                                                               */ 00078000
*   /*****************************************************************/ 00079000
*                                                                  0032 00080000
*   IF FIRST='0'B&CDATA='1'B THEN                                  0032 00081000
@RF00030 TM    FIRST(HTPTR),B'00100000'                            0032 00082000
         BNZ   @RF00032                                            0032 00083000
         TM    CDATA(HTPTR),B'01000000'                            0032 00084000
         BO    @RT00032                                            0032 00085000
*     GO TO PUTCARD;                /* IF THIS IS DATA, SUBMIT THE 0033 00086000
*                                      CARD (UNLESS NO JOB CARD YET) */ 00087000
*                                                                  0033 00088000
*   /*****************************************************************/ 00089000
*   /*                                                               */ 00090000
*   /* JOB CARD (CALL PROMPTJOB)                                     */ 00091000
*   /*                                                               */ 00092000
*   /*****************************************************************/ 00093000
*                                                                  0034 00094000
*   IF CJOB='1'B&CVERBCOP='0'B THEN                                0034 00095000
@RF00032 TM    CJOB(HTPTR),B'00010000'                             0034 00096000
         BNO   @RF00034                                            0034 00097000
         TM    CVERBCOP(HTPTR),B'00001000'                         0034 00098000
         BNZ   @RF00034                                            0034 00099000
*     DO;                           /* CALL PROMPTJOB FOR ORIGINAL 0035 00100000
*                                      (NOT CONTINUATIONS OF) JOB  0035 00101000
*                                      CARDS                         */ 00102000
*       CALL IKJEFF13(MSGLISPT,STMTPT,USERID,CONTABPT,NEXTNAME,HISTFLD) 00103000
*           ;                       /* CHECKS FOR JOBNAME=USERID     */ 00104000
         LA    @10,MSGLISPT(,CONLIST)                              0036 00105000
         ST    @10,@AL00001                                        0036 00106000
         LA    @10,STMTPT(,CONLIST)                                0036 00107000
         ST    @10,@AL00001+4                                      0036 00108000
         L     @10,USERIDPT(,CONLIST)                              0036 00109000
         ST    @10,@AL00001+8                                      0036 00110000
         LA    @10,CONTABPT(,CONLIST)                              0036 00111000
         ST    @10,@AL00001+12                                     0036 00112000
         L     @10,JOBNAMPT(,CONLIST)                              0036 00113000
         LA    @10,NEXTNAME(,@10)                                  0036 00114000
         ST    @10,@AL00001+16                                     0036 00115000
         ST    HTPTR,@AL00001+20                                   0036 00116000
         L     @15,@CV00175                                        0036 00117000
         LA    @01,@AL00001                                        0036 00118000
         BALR  @14,@15                                             0036 00119000
*       CALL CODECHK;               /* CHECK FOR ERROR RETURN        */ 00120000
         BAL   @14,CODECHK                                         0037 00121000
*     END;                                                         0038 00122000
*                                                                  0038 00123000
*   /*****************************************************************/ 00124000
*   /*                                                               */ 00125000
*   /* NON-DATA CARD (CALL EXIT)                                     */ 00126000
*   /*                                                               */ 00127000
*   /*****************************************************************/ 00128000
*                                                                  0039 00129000
*   IF INEXIT='0'B THEN                                            0039 00130000
@RF00034 TM    INEXIT(HTPTR),B'00100000'                           0039 00131000
         BNZ   @RF00039                                            0039 00132000
*     DO;                           /* CALL EXIT IF NOT ALREADY IN 0040 00133000
*                                      EXIT -NOTE THE VERY FIRST TIME   00134000
*                                      06 IS ENTERED ONLY JOBX IS ON */ 00135000
*       IF CJOB='1'B&JOBX='1'B THEN /* IF HAVE JOB CARD AND EXIT   0041 00136000
*                                      WANTS TO SEE IT               */ 00137000
         TM    CJOB(HTPTR),B'00010000'                             0041 00138000
         BNO   @RF00041                                            0041 00139000
         TM    JOBX(HTPTR),B'10000000'                             0041 00140000
         BO    @RT00041                                            0041 00141000
*         GO TO CALLEX;             /* CALL EXIT FOR JOB             */ 00142000
*       IF CEXEC='1'B&EXECX='1'B THEN/* IF HAVE EXEC AND EXIT WANTS  */ 00143000
@RF00041 TM    CEXEC(HTPTR),B'00001000'                            0043 00144000
         BNO   @RF00043                                            0043 00145000
         TM    EXECX(HTPTR),B'01000000'                            0043 00146000
         BO    @RT00043                                            0043 00147000
*         GO TO CALLEX;             /* CALL EXIT FOR EXEC            */ 00148000
*       IF CDD='1'B&DDX='1'B THEN   /* IF HAVE DD AND EXIT WANTS     */ 00149000
@RF00043 TM    CDD(HTPTR),B'00000100'                              0045 00150000
         BNO   @RF00045                                            0045 00151000
         TM    DDX(HTPTR),B'00100000'                              0045 00152000
         BO    @RT00045                                            0045 00153000
*         GO TO CALLEX;             /* CALL EXIT FOR DD              */ 00154000
*       IF CCOMMAND='1'B&CMDX='1'B THEN/* IF HAVE COMMAND CARD ...   */ 00155000
@RF00045 TM    CCOMMAND(HTPTR),B'00000010'                         0047 00156000
         BNO   @RF00047                                            0047 00157000
         TM    CMDX(HTPTR),B'00010000'                             0047 00158000
         BO    @RT00047                                            0047 00159000
*         GO TO CALLEX;             /* CALL EXIT FOR CMD             */ 00160000
*       IF CNULL='1'B&NULLX='1'B THEN/* IF HAVE NULL CARD ...        */ 00161000
@RF00047 TM    CNULL(HTPTR),B'00100000'                            0049 00162000
         BNO   @RF00049                                            0049 00163000
         TM    NULLX(HTPTR),B'00001000'                            0049 00164000
         BO    @RT00049                                            0049 00165000
*         GO TO CALLEX;             /* CALL EXIT FOR NULL            */ 00166000
*     END;                                                         0051 00167000
*                                                                  0051 00168000
@RF00049 DS    0H                                                  0052 00169000
*   /*****************************************************************/ 00170000
*   /*                                                               */ 00171000
*   /* SUBMIT LAST JOB                                               */ 00172000
*   /*                                                               */ 00173000
*   /*****************************************************************/ 00174000
*                                                                  0052 00175000
*AFTEX:                                                            0052 00176000
*   IF FIRST='0'B THEN                                             0052 00177000
@RF00039 DS    0H                                                  0052 00178000
AFTEX    TM    FIRST(HTPTR),B'00100000'                            0052 00179000
         BNZ   @RF00052                                            0052 00180000
*     DO;                           /* IF NOT FIRST, MAY NEED TO   0053 00181000
*                                      SUBMIT LAST JOB IF THIS IS A     00182000
*                                      NULL OR A JOB CARD (WHICH IS     00183000
*                                      NOT PRECEDED BY A NULL)       */ 00184000
*       IF CNULL='1'B|(CJOB='1'B&CVERBCOP='0'B&FLUSH='0'B)THEN/* IF     00185000
*                                      AT END OF A JOB               */ 00186000
         TM    CNULL(HTPTR),B'00100000'                            0054 00187000
         BO    @RT00054                                            0054 00188000
         TM    CJOB(HTPTR),B'00010000'                             0054 00189000
         BNO   @RF00054                                            0054 00190000
         TM    CVERBCOP(HTPTR),B'00001000'                         0054 00191000
         BNZ   @RF00054                                            0054 00192000
         TM    FLUSH(HTPTR),B'01000000'                            0054 00193000
         BNZ   @RF00054                                            0054 00194000
@RT00054 DS    0H                                                  0055 00195000
*DOSUBMIT:                          /* LABEL FOR DO/END GROUP        */ 00196000
*         DO;                                                      0055 00197000
DOSUBMIT DS    0H                                                  0056 00198000
*           HTCODE=EREQCODE;        /* WRMG WILL TELL JOB ENTRY    0056 00199000
*                                      SUBSYS. ARE SUBMITTING THIS 0056 00200000
*                                      JOB, THEN PRINT 'JOB        0056 00201000
*                                      SUBMITTED' MSG                */ 00202000
         MVI   HTCODE(HTPTR),X'03'                                 0056 00203000
*           PT=ADDR(AFTSUBMT);                                     0057 00204000
         LA    PT,AFTSUBMT                                         0057 00205000
*           GO TO CALLWRMG;         /* CALL WRITER-MANAGER           */ 00206000
         B     CALLWRMG                                            0058 00207000
*         END DOSUBMIT;                                            0059 00208000
*     END;                                                         0060 00209000
@RF00054 DS    0H                                                  0061 00210000
*AFTSUBMT:                          /* CAN BRANCH HERE INDIRECTLY    */ 00211000
*   IF CJOB='1'B&CVERBCOP='0'B THEN /* LOOK FOR LAST CONTINUATION OF    00212000
*                                      NEW JOB CARD                  */ 00213000
@RF00052 DS    0H                                                  0061 00214000
AFTSUBMT TM    CJOB(HTPTR),B'00010000'                             0061 00215000
         BNO   @RF00061                                            0061 00216000
         TM    CVERBCOP(HTPTR),B'00001000'                         0061 00217000
         BNZ   @RF00061                                            0061 00218000
*     DO;                                                          0062 00219000
*       CURRNAME=NEXTNAME;          /* NOW NEW JOB HAS BEEN ACCEPTED    00220000
*                                      SO COPY THE JOB NAME JUST   0063 00221000
*                                      IDENTIFIED TO THE JOBNAME   0063 00222000
*                                      FIELD                         */ 00223000
         L     @10,JOBNAMPT(,CONLIST)                              0063 00224000
         MVC   CURRNAME(8,@10),NEXTNAME(@10)                       0063 00225000
*       FLUSH='0'B;                 /* SET FLUSH OFF                 */ 00226000
*       FIRST='0'B;                 /* SET FIRST SW OFF-HAVE FOUND 0065 00227000
*                                      THE FIRST JOB CARD            */ 00228000
         NI    FLUSH(HTPTR),B'10011111'                            0065 00229000
*     END;                                                         0066 00230000
*                                                                  0066 00231000
*   /*****************************************************************/ 00232000
*   /*                                                               */ 00233000
*   /* NULL CARD (FLUSH TO NEXT JOB)                                 */ 00234000
*   /*                                                               */ 00235000
*   /*****************************************************************/ 00236000
*                                                                  0067 00237000
*   IF CNULL='1'B THEN                                             0067 00238000
@RF00061 TM    CNULL(HTPTR),B'00100000'                            0067 00239000
         BNO   @RF00067                                            0067 00240000
*     DO;                                                          0068 00241000
*       FLUSH='1'B;                 /* IF THIS IS A NULL, SET THE  0069 00242000
*                                      FLUSH SW ON AND RETURN --   0069 00243000
*                                      NOTICE THAT THE NULL CARD   0069 00244000
*                                      ITSELF DOES NOT ACTUALLY    0069 00245000
*                                      APPEAR IN THE OUTPUT DATA SET */ 00246000
         OI    FLUSH(HTPTR),B'01000000'                            0069 00247000
*       GO TO FINISH;               /* PREPARE TO GET NEXT CARD      */ 00248000
         B     FINISH                                              0070 00249000
*     END;                                                         0071 00250000
*                                                                  0071 00251000
*   /*****************************************************************/ 00252000
*   /*                                                               */ 00253000
*   /* GENERATE A JOB CARD IF NECESSARY                              */ 00254000
*   /*                                                               */ 00255000
*   /*****************************************************************/ 00256000
*                                                                  0072 00257000
*   IF FIRST='1'B THEN                                             0072 00258000
@RF00067 TM    FIRST(HTPTR),B'00100000'                            0072 00259000
         BNO   @RF00072                                            0072 00260000
*     DO;                           /* IF FIRST IS STILL ON (AFTER 0073 00261000
*                                      CHECKING FOR JOB) THEN THIS IS   00262000
*                                      NOT A JOB CARD SO WILL NEED TO   00263000
*                                      CALL THE GENJOB ROUTINE       */ 00264000
*       IF INGEN^=0&INEXIT='0'B THEN/* IF ALREADY IN GENJOB EXIT MUST   00265000
*                                      BE MODIFYING JOB CARDS -- IF     00266000
*                                      DELETING THEM, EXIT IS NO   0074 00267000
*                                      LONGER ACTIVE AND SO WE BETTER   00268000
*                                      QUIT -- IF CHANGING THEM, EXIT   00269000
*                                      IS STILL ACTIVE AND WILL BE 0074 00270000
*                                      BY-PASSED NEXT TIME AROUND, 0074 00271000
*                                      LETTING THE GENERATED JOB CARD   00272000
*                                      GO THROUGH                    */ 00273000
         CLI   INGEN(HTPTR),0                                      0074 00274000
         BE    @RF00074                                            0074 00275000
         TM    INEXIT(HTPTR),B'00100000'                           0074 00276000
         BNZ   @RF00074                                            0074 00277000
*         DO;                                                      0075 00278000
*POSTOUT:                           /* EXIT IF ECB WAS POSTED        */ 00279000
*           QUIT='1'B;                                             0076 00280000
POSTOUT  OI    QUIT(HTPTR),B'10000000'                             0076 00281000
*           GO TO FINISH;           /* TAKE ERROR EXIT               */ 00282000
         B     FINISH                                              0077 00283000
*         END;                      /* IF THE FIRST CARD IS A NULL,     00284000
*                                      SKIP GENERATING A JOB CARD --    00285000
*                                      IT WOULD ONLY GET CUT OFF BY     00286000
*                                      THE NULL                      */ 00287000
*       CALL IKJEFF08(HISTFLD,STMTPT,USERID,CONTABPT,MSGLISPT);/*  0079 00288000
*                                      CALL GENJOB AND RETURN - NO 0079 00289000
*                                      NEED TO PROCESS FURTHER     0079 00290000
*                                      BECAUSE GENJOB HAS          0079 00291000
*                                      RE-PROCESSED THE ORIGINAL   0079 00292000
*                                      NON-JOB CARD                  */ 00293000
@RF00074 ST    HTPTR,@AL00001                                      0079 00294000
         LA    @10,STMTPT(,CONLIST)                                0079 00295000
         ST    @10,@AL00001+4                                      0079 00296000
         L     @10,USERIDPT(,CONLIST)                              0079 00297000
         ST    @10,@AL00001+8                                      0079 00298000
         LA    @10,CONTABPT(,CONLIST)                              0079 00299000
         ST    @10,@AL00001+12                                     0079 00300000
         LA    @10,MSGLISPT(,CONLIST)                              0079 00301000
         ST    @10,@AL00001+16                                     0079 00302000
         L     @15,@CV00172                                        0079 00303000
         LA    @01,@AL00001                                        0079 00304000
         BALR  @14,@15                                             0079 00305000
*       GO TO FINISH;               /* DONE(CARD INDIRECTLY        0080 00306000
*                                      PROCESSED)                    */ 00307000
         B     FINISH                                              0080 00308000
*     END;                          /* OTHERWISE FALL THRU TO PUTCARD*/ 00309000
*                                                                  0081 00310000
*   /*****************************************************************/ 00311000
*   /*                                                               */ 00312000
*   /* PUTCARD SUBROUTINE (PUTS CARD INTO INTERNAL READER)           */ 00313000
*   /*                                                               */ 00314000
*   /*****************************************************************/ 00315000
*                                                                  0082 00316000
*PUTCARD:                                                          0082 00317000
*   HTCODE=PUTCODE;                 /* TELL WRMGR TO PASS THIS CARD     00318000
*                                      TO THE JOB ENTRY SUBSYSTEM    */ 00319000
@RF00072 DS    0H                                                  0082 00320000
PUTCARD  MVI   HTCODE(HTPTR),X'02'                                 0082 00321000
*   PT=ADDR(FINISH);                /* THEN 06 WILL BE DONE WITH CARD*/ 00322000
         LA    PT,FINISH                                           0083 00323000
*   GO TO CALLWRMG;                 /* CALL THE WRITER MANAGER       */ 00324000
*                                                                  0084 00325000
         B     CALLWRMG                                            0084 00326000
*   /*****************************************************************/ 00327000
*   /*                                                               */ 00328000
*   /* CALLEX SUBROUTINE (CALLS INSTALLATION EXIT INTERFACE)         */ 00329000
*   /*                                                               */ 00330000
*   /*****************************************************************/ 00331000
*                                                                  0085 00332000
*CALLEX:                            /* CALL EXIT INTERFACE           */ 00333000
*   CALL IKJEFF09(STMTPT,USERID,HISTFLD,MSGLISPT,CONTABPT,EXWORD,EXITAD 00334000
*       ,CTCMDNM);                  /* AFTER EXIT DO CODE CHECK      */ 00335000
CALLEX   LA    @10,STMTPT(,CONLIST)                                0085 00336000
         ST    @10,@AL00001                                        0085 00337000
         L     @10,USERIDPT(,CONLIST)                              0085 00338000
         ST    @10,@AL00001+4                                      0085 00339000
         ST    HTPTR,@AL00001+8                                    0085 00340000
         LA    @10,MSGLISPT(,CONLIST)                              0085 00341000
         ST    @10,@AL00001+12                                     0085 00342000
         LA    @10,CONTABPT(,CONLIST)                              0085 00343000
         ST    @10,@AL00001+16                                     0085 00344000
         LA    @10,EXWORD(,CONLIST)                                0085 00345000
         ST    @10,@AL00001+20                                     0085 00346000
         LA    @10,EXITAD(,CONLIST)                                0085 00347000
         ST    @10,@AL00001+24                                     0085 00348000
         LA    @10,CTCMDNM(,CONLIST)                               0085 00349000
         ST    @10,@AL00001+28                                     0085 00350000
         L     @15,@CV00173                                        0085 00351000
         LA    @01,@AL00001                                        0085 00352000
         BALR  @14,@15                                             0085 00353000
*   CALL CODECHK;                   /* CHECK FOR ERROR RETURN        */ 00354000
         BAL   @14,CODECHK                                         0086 00355000
*   GO TO AFTEX;                    /* BRANCH BACK TO MAIN LOGIC     */ 00356000
*                                                                  0087 00357000
         B     AFTEX                                               0087 00358000
*   /*****************************************************************/ 00359000
*   /*                                                               */ 00360000
*   /* CALLWRMG SUBROUTINE (INTERFACE TO JOB ENTRY SUBSYSTEM)        */ 00361000
*   /*                                                               */ 00362000
*   /*****************************************************************/ 00363000
*                                                                  0088 00364000
*CALLWRMG:                                                         0088 00365000
*   CALL IKJEFF12(CONTAB);          /* PARAMETER IS THE SUBMIT     0088 00366000
*                                      CONTROL TABLE - SEE IKJEFF12     00367000
*                                      FOR ALL FIELDS USED - 06 SETS    00368000
*                                      UP HTCODE                     */ 00369000
CALLWRMG ST    CONLIST,@AL00001                                    0088 00370000
         L     @15,@CV00174                                        0088 00371000
         LA    @01,@AL00001                                        0088 00372000
         BALR  @14,@15                                             0088 00373000
*   CALL CODECHK;                   /* CHECK FOR ERROR RETURN        */ 00374000
         BAL   @14,CODECHK                                         0089 00375000
*   GO TO INDIRECT;                 /* RETURN TO CALLER OF THIS    0090 00376000
*                                                             SEGMENT*/ 00377000
*                                                                  0090 00378000
         BR    PT                                                  0090 00379000
*   /*****************************************************************/ 00380000
*   /*                                                               */ 00381000
*   /* FINISH SUBROUTINE (CLEANS UP AND RETURNS TO CALLER)           */ 00382000
*   /*                                                               */ 00383000
*   /*****************************************************************/ 00384000
*                                                                  0091 00385000
*FINISH:                                                           0091 00386000
*   STMTPT=0;                       /* ZERO THE STMT PTR WHEN ALL  0091 00387000
*                                      DONE PROCESSING THIS CARD     */ 00388000
FINISH   SLR   @10,@10                                             0091 00389000
         ST    @10,STMTPT(,CONLIST)                                0091 00390000
*   INCONTRL=INCONTRL-1;            /* DECRE CONTROL CTR AND RETURN     00391000
*                                      TO CALLER                     */ 00392000
*                                                                  0092 00393000
         SLR   @10,@10                                             0092 00394000
         IC    @10,INCONTRL(,HTPTR)                                0092 00395000
         BCTR  @10,0                                               0092 00396000
         STC   @10,INCONTRL(,HTPTR)                                0092 00397000
*   /*****************************************************************/ 00398000
*   /*                                                               */ 00399000
*   /* CODECHK INTERNAL PROCEDURE - CHECKS WHETHER DONE WITH         */ 00400000
*   /* IKJEFF06'S PROCESSING                                         */ 00401000
*   /*                                                               */ 00402000
*   /*****************************************************************/ 00403000
*                                                                  0093 00404000
*CODECHK:                                                          0093 00405000
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0093 00406000
         B     @PB00002                                            0093 00407000
CODECHK  DS    0H                                                  0094 00408000
*   IF QUIT='1'B THEN               /* CHECK FOR ERROR TERMINATION   */ 00409000
         TM    QUIT(HTPTR),B'10000000'                             0094 00410000
         BNO   @RF00094                                            0094 00411000
*     RETURN TO FINISH;             /* COMPLETELY DONE - ERROR       */ 00412000
         LA    @14,FINISH                                          0095 00413000
@EL00002 DS    0H                                                  0095 00414000
@EF00002 DS    0H                                                  0095 00415000
@ER00002 BR    @14                                                 0095 00416000
*   IF POSTBIT='1'B THEN            /* CHECK FOR ATTENTION           */ 00417000
@RF00094 L     @10,COMECBPT(,CONLIST)                              0096 00418000
         TM    POSTBIT(@10),B'01000000'                            0096 00419000
         BNO   @RF00096                                            0096 00420000
*     RETURN TO POSTOUT;            /* COMPLETELY DONE               */ 00421000
         LA    @14,POSTOUT                                         0097 00422000
         BR    @14                                                 0097 00423000
*   IF STMTPT=0 THEN                /* CHECK CARD PROCESSED          */ 00424000
@RF00096 L     @10,STMTPT(,CONLIST)                                0098 00425000
         LTR   @10,@10                                             0098 00426000
         BNZ   @RF00098                                            0098 00427000
*     RETURN TO FINISH;             /* DONE W/ THIS JCL OR DATA CARD */ 00428000
         LA    @14,FINISH                                          0099 00429000
         BR    @14                                                 0099 00430000
*   END CODECHK;                                                   0100 00431000
         B     @EL00002                                            0100 00432000
*   END IKJEFF06                                                   0101 00433000
*                                                                  0101 00434000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00435000
*/*%INCLUDE SYSLIB  (IKJEFFHT)                                       */ 00436000
*/*%INCLUDE SYSLIB  (IKJEFFCT)                                       */ 00437000
*                                                                  0101 00438000
*       ;                                                          0101 00439000
@EL00001 L     @13,4(,@13)                                         0101 00440000
@EF00001 L     @00,@SIZDATD                                        0101 00441000
         LR    @01,@11                                             0101 00442000
         FREEMAIN R,LV=(0),A=(1)                                        00443000
@ER00001 LM    @14,@12,12(@13)                                     0101 00444000
         BR    @14                                                 0101 00445000
@DATA    DS    0H                                                       00446000
@DATD    DSECT                                                          00447000
         DS    0F                                                       00448000
@SA00001 DS    18F                                                      00449000
@PC00001 DS    1F                                                       00450000
@AL00001 DS    8A                                                       00451000
IKJEFF06 CSECT                                                          00452000
         DS    0F                                                       00453000
@DATD    DSECT                                                          00454000
         DS    0D                                                       00455000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00456000
@ENDDATD EQU   *                                                        00457000
IKJEFF06 CSECT                                                          00458000
         DS    0F                                                       00459000
@SIZDATD DC    AL1(0)                                                   00460000
         DC    AL3(@ENDDATD-@DATD)                                      00461000
@CV00171 DC    V(IKJEFF07)                                              00462000
@CV00172 DC    V(IKJEFF08)                                              00463000
@CV00173 DC    V(IKJEFF09)                                              00464000
@CV00174 DC    V(IKJEFF12)                                              00465000
@CV00175 DC    V(IKJEFF13)                                              00466000
         DS    0D                                                       00467000
PATCH    DS    CL51                                                     00468000
         ORG   PATCH                                                    00469000
PTCHINIT DC    17CL3'ZAP'                                               00470000
         ORG   PATCH+51                                                 00471000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00472000
@01      EQU   01                                                       00473000
@02      EQU   02                                                       00474000
@03      EQU   03                                                       00475000
@04      EQU   04                                                       00476000
@05      EQU   05                                                       00477000
@06      EQU   06                                                       00478000
@07      EQU   07                                                       00479000
@08      EQU   08                                                       00480000
@09      EQU   09                                                       00481000
@10      EQU   10                                                       00482000
@11      EQU   11                                                       00483000
@12      EQU   12                                                       00484000
@13      EQU   13                                                       00485000
@14      EQU   14                                                       00486000
@15      EQU   15                                                       00487000
PT       EQU   @04                                                      00488000
HTPTR    EQU   @02                                                      00489000
CONLIST  EQU   @03                                                      00490000
HISTORY  EQU   0                                                        00491000
WHATMOD  EQU   HISTORY+12                                               00492000
INCONTRL EQU   WHATMOD                                                  00493000
INGEN    EQU   WHATMOD+2                                                00494000
INEXIT   EQU   WHATMOD+3                                                00495000
JCLSWITS EQU   HISTORY+16                                               00496000
PRIORJCL EQU   JCLSWITS                                                 00497000
PVERB    EQU   PRIORJCL                                                 00498000
PDTYPE   EQU   PRIORJCL+2                                               00499000
PMISC    EQU   PRIORJCL+3                                               00500000
CURRJCL  EQU   JCLSWITS+4                                               00501000
CVERB    EQU   CURRJCL                                                  00502000
CDATA    EQU   CVERB                                                    00503000
CNULL    EQU   CVERB                                                    00504000
CJOB     EQU   CVERB                                                    00505000
CEXEC    EQU   CVERB                                                    00506000
CDD      EQU   CVERB                                                    00507000
CCOMMAND EQU   CVERB                                                    00508000
CDTYPE   EQU   CURRJCL+2                                                00509000
CMISC    EQU   CURRJCL+3                                                00510000
CVERBCOP EQU   CMISC                                                    00511000
STATICSW EQU   HISTORY+24                                               00512000
GENL     EQU   STATICSW                                                 00513000
QUIT     EQU   GENL                                                     00514000
FLUSH    EQU   GENL                                                     00515000
FIRST    EQU   GENL                                                     00516000
TAKEXITS EQU   STATICSW+1                                               00517000
JOBX     EQU   TAKEXITS                                                 00518000
EXECX    EQU   TAKEXITS                                                 00519000
DDX      EQU   TAKEXITS                                                 00520000
CMDX     EQU   TAKEXITS                                                 00521000
NULLX    EQU   TAKEXITS                                                 00522000
CODEFLD  EQU   STATICSW+3                                               00523000
HTCODE   EQU   CODEFLD                                                  00524000
DLMONJCL EQU   HISTORY+32                                               00525000
HTSWITCH EQU   HISTORY+34                                               00526000
HTACCNTP EQU   HISTORY+40                                               00527000
CONTAB   EQU   0                                                        00528000
CONTABPT EQU   CONTAB+12                                                00529000
STMTPT   EQU   CONTAB+16                                                00530000
HISTPT   EQU   CONTAB+24                                                00531000
JOBNAMPT EQU   CONTAB+32                                                00532000
MSGLISPT EQU   CONTAB+36                                                00533000
USERIDPT EQU   CONTAB+40                                                00534000
EXWORD   EQU   CONTAB+48                                                00535000
EXITAD   EQU   CONTAB+52                                                00536000
COMECBPT EQU   CONTAB+60                                                00537000
CTCMDNM  EQU   CONTAB+76                                                00538000
JOBNAME  EQU   0                                                        00539000
CURRNAME EQU   JOBNAME                                                  00540000
NEXTNAME EQU   JOBNAME+8                                                00541000
HISTFLD  EQU   0                                                        00542000
INDIRECT EQU   0                                                        00543000
USERID   EQU   0                                                        00544000
COMMECB  EQU   0                                                        00545000
POSTBIT  EQU   COMMECB                                                  00546000
HTACCNTI EQU   0                                                        00547000
CONPTR   EQU   0                                                        00548000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00549000
@NM00006 EQU   COMMECB                                                  00550000
CTACBPT  EQU   CONTAB+72                                                00551000
CTRPLPT  EQU   CONTAB+68                                                00552000
INITSAVE EQU   CONTAB+64                                                00553000
DDPTR    EQU   CONTAB+56                                                00554000
TMCTPT   EQU   CONTAB+44                                                00555000
CTNDSNPT EQU   CONTAB+28                                                00556000
CLOSERPT EQU   CONTAB+20                                                00557000
TABID    EQU   CONTAB                                                   00558000
@NM00005 EQU   HISTORY+50                                               00559000
HTACNTC2 EQU   HISTORY+48                                               00560000
HTACNTC1 EQU   HISTORY+46                                               00561000
HTACCNTL EQU   HISTORY+44                                               00562000
@NM00004 EQU   HISTORY+36                                               00563000
@NM00003 EQU   HISTORY+35                                               00564000
@NM00002 EQU   HTSWITCH                                                 00565000
HTDLMSW  EQU   HTSWITCH                                                 00566000
HTDLM    EQU   DLMONJCL                                                 00567000
@NM00001 EQU   HISTORY+28                                               00568000
OPOFF    EQU   STATICSW+2                                               00569000
NONOTIFY EQU   GENL                                                     00570000
CDLMFND  EQU   CMISC                                                    00571000
CNOTHING EQU   CMISC                                                    00572000
CCOMCON  EQU   CMISC                                                    00573000
CNAME    EQU   CMISC                                                    00574000
CCONERR  EQU   CMISC                                                    00575000
COPCONEX EQU   CMISC                                                    00576000
CCONEX   EQU   CMISC                                                    00577000
CDDDATA  EQU   CDTYPE                                                   00578000
CDDAST   EQU   CDTYPE                                                   00579000
CCOMMENT EQU   CVERB                                                    00580000
CDELIM   EQU   CVERB                                                    00581000
PDLMFND  EQU   PMISC                                                    00582000
PNOTHING EQU   PMISC                                                    00583000
PCOMCON  EQU   PMISC                                                    00584000
PVERBCOP EQU   PMISC                                                    00585000
PNAME    EQU   PMISC                                                    00586000
PCONERR  EQU   PMISC                                                    00587000
POPCONEX EQU   PMISC                                                    00588000
PCONEX   EQU   PMISC                                                    00589000
PDDDATA  EQU   PDTYPE                                                   00590000
PDDAST   EQU   PDTYPE                                                   00591000
PCOMMENT EQU   PVERB                                                    00592000
PCOMMAND EQU   PVERB                                                    00593000
PDD      EQU   PVERB                                                    00594000
PEXEC    EQU   PVERB                                                    00595000
PJOB     EQU   PVERB                                                    00596000
PNULL    EQU   PVERB                                                    00597000
PDATA    EQU   PVERB                                                    00598000
PDELIM   EQU   PVERB                                                    00599000
INOINIT  EQU   WHATMOD+3                                                00600000
INCOMPIN EQU   WHATMOD+3                                                00601000
INMSG    EQU   WHATMOD+3                                                00602000
INDAIRIN EQU   WHATMOD+3                                                00603000
INWRMGR  EQU   WHATMOD+3                                                00604000
INIDENT  EQU   WHATMOD+3                                                00605000
INREAD   EQU   WHATMOD+3                                                00606000
INPROMPT EQU   WHATMOD+1                                                00607000
SUBTAB   EQU   HISTORY                                                  00608000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00609000
@RT00030 EQU   FINISH                                                   00610000
@RT00032 EQU   PUTCARD                                                  00611000
@RT00041 EQU   CALLEX                                                   00612000
@RT00043 EQU   CALLEX                                                   00613000
@RT00045 EQU   CALLEX                                                   00614000
@RT00047 EQU   CALLEX                                                   00615000
@RT00049 EQU   CALLEX                                                   00616000
@RF00098 EQU   @EL00002                                                 00617000
@PB00002 EQU   @EL00001                                                 00618000
@ENDDATA EQU   *                                                        00619000
         END   IKJEFF06,(C'PL/S-II',0502,73230)                         00620000
