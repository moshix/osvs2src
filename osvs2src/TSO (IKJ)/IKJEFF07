         TITLE 'IKJEFF07 - JCL IDENTIFY ROUTINE                        *00001000
                        '                                               00002000
IKJEFF07 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFF07  75.344'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         LM    @00,@01,20(@13)                                     0001 00018000
         MVC   @PC00001(12),0(@01)                                 0001 00019000
*                                      TWO AND THREE           Y02993*/ 00020000
*                                                                  0032 00021000
*   /*****************************************************************/ 00022000
*   /*                                                               */ 00023000
*   /* END OF THE IKJEFFHT MAPPING MACRO                             */ 00024000
*   /*                                                               */ 00025000
*   /*****************************************************************/ 00026000
*                                                                  0033 00027000
*                                                                  0033 00028000
*   /*****************************************************************/ 00029000
*   /*                                                               */ 00030000
*   /* INITIALIZATION FOR SCAN OF INPUT CARD                         */ 00031000
*   /*                                                               */ 00032000
*   /*****************************************************************/ 00033000
*                                                                  0033 00034000
*   HTPTR=ADDR(HIST);               /* LOCAL POINTER TO HISTORY TABLE*/ 00035000
         L     HTPTR,@PC00001                                      0033 00036000
*   INIDENT='1'B;                   /* INDICATE IN THIS MODULE       */ 00037000
         OI    INIDENT(HTPTR),B'01000000'                          0034 00038000
*   ENDCOL=71;                      /* INITIALIZE THE ENDCOL         */ 00039000
         LA    ENDCOL,71                                           0035 00040000
*   WORK=WORK&&WORK;                /* ZERO INTERNAL WORK AREA       */ 00041000
         XC    WORK(4),WORK                                        0036 00042000
*   CARDPTR=STMTPTR;                /* LOCAL POINTER TO INPUT CARD   */ 00043000
         L     @10,@PC00001+4                                      0037 00044000
         L     CARDPTR,STMTPTR(,@10)                               0037 00045000
*   OPOFF=0;                        /* ZERO THE OPERAND OFFSET       */ 00046000
*                                                                  0038 00047000
         MVI   OPOFF(HTPTR),X'00'                                  0038 00048000
*   /*****************************************************************/ 00049000
*   /*                                                               */ 00050000
*   /* CHECK FOR TYPE OF JCL CARD. NOTE THAT MODULE IKJEFF05 DOES A  */ 00051000
*   /* PRE-SCAN AND PROCESSES DATA CARDS ITSELF, FOR EFFICIENCY      */ 00052000
*   /* (DUPLICATION OF LINES 283600-352000 AND 742932,742936). ALL   */ 00053000
*   /* THE ABOVE LINES ARE STILL NEEDED IN MODULE IKJEFF07 AS PART OF*/ 00054000
*   /* THE JCL CARD PROCESSING.                                      */ 00055000
*   /*                                                               */ 00056000
*   /*****************************************************************/ 00057000
*                                                                  0039 00058000
*   IF HTDLMSW=OFF|CCONEX=ON THEN   /* CHECK FOR DLM= NOT FOUND ON A    00059000
*                                      PRIOR // DD * OR DD DATA CARD    00060000
*                                      OR CONTINUATION OF A // CARD  */ 00061000
         TM    HTDLMSW(HTPTR),B'10000000'                          0039 00062000
         BZ    @RT00039                                            0039 00063000
         TM    CCONEX(HTPTR),B'10000000'                           0039 00064000
         BNO   @RF00039                                            0039 00065000
@RT00039 DS    0H                                                  0040 00066000
*NODLM:                             /* NORMAL CASE CODE              */ 00067000
*     DO;                                                          0040 00068000
*                                                                  0040 00069000
NODLM    DS    0H                                                  0041 00070000
*       /*************************************************************/ 00071000
*       /*                                                           */ 00072000
*       /* CHECK FOR // JCL CARD                                     */ 00073000
*       /*                                                           */ 00074000
*       /*************************************************************/ 00075000
*                                                                  0041 00076000
*       IF CARD(1:2)='//' THEN      /* MAKE BASIC TEST TO DISTINGUISH   00077000
*                                      BETWEEN JCL AND NON-JCL STMTS */ 00078000
         CLC   CARD(2,CARDPTR),@CC00225                            0041 00079000
         BE    @RT00041                                            0041 00080000
*         GO TO JCL;                /* SPECIAL PROCESSING FOR JCL    */ 00081000
*                                                                  0043 00082000
*       /*************************************************************/ 00083000
*       /*                                                           */ 00084000
*       /* SLASH-ASTERISK CARD                                       */ 00085000
*       /*                                                           */ 00086000
*       /*************************************************************/ 00087000
*                                                                  0043 00088000
*       IF CARD(1:2)='/*' THEN                                     0043 00089000
         CLC   CARD(2,CARDPTR),@CC00227                            0043 00090000
         BNE   @RF00043                                            0043 00091000
*         DO;                                                      0044 00092000
*           IF CARD(3)=' ' THEN     /* NOTE - JOB ENTRY SUBSYSTEM  0045 00093000
*                                      CARDS MAY BE SLASH-ASTERISK-     00094000
*                                      NONBLANK               @Y02064*/ 00095000
         CLI   CARD+2(CARDPTR),C' '                                0045 00096000
         BNE   @RF00045                                            0045 00097000
*             DO;                                                  0046 00098000
*                                                                  0046 00099000
*               /*****************************************************/ 00100000
*               /*                                                   */ 00101000
*               /* SLASH-ASTERISK-BLANK DELIMITER CARD               */ 00102000
*               /*                                                   */ 00103000
*               /*****************************************************/ 00104000
*                                                                  0047 00105000
*               IF CDATA=ON THEN    /* THIS SLASH-ASTERISK-BLANK CARD   00106000
*                                      WAS USED AS A DELIMITER, SO 0047 00107000
*                                      COPY THE DATA SWITCH, IF ANY     00108000
*                                      -- ALWAYS SET DELIMITER SWITCH   00109000
*                                      ON                            */ 00110000
         TM    CDATA(HTPTR),B'01000000'                            0047 00111000
         BNO   @RF00047                                            0047 00112000
*                 WDATA=ON;                                        0048 00113000
         OI    WDATA,B'01000000'                                   0048 00114000
*               WDELIM=ON;                                         0049 00115000
@RF00047 OI    WDELIM,B'10000000'                                  0049 00116000
*             END;                                                 0050 00117000
*                                                                  0050 00118000
*           /*********************************************************/ 00119000
*           /*                                                       */ 00120000
*           /* SLASH-ASTERISK-NONBLANK JOB ENTRY SUBSYSTEM CONTROL   */ 00121000
*           /* CARD                                                  */ 00122000
*           /*                                                       */ 00123000
*           /*********************************************************/ 00124000
*                                                                  0051 00125000
*           ELSE                                                   0051 00126000
*             IF CDDDATA=ON|CDDAST=ON THEN/* IF THIS CARD IS IN A  0051 00127000
*                                      DATA STREAM                   */ 00128000
         B     @RC00045                                            0051 00129000
@RF00045 TM    CDDDATA(HTPTR),B'11000000'                          0051 00130000
         BNZ   @RT00051                                            0051 00131000
*               GO TO SETDATA;      /* DON'T DO ANY JCL CHECKING - 0052 00132000
*                                      JUST PROCESS AS DATA          */ 00133000
*           GO TO CHKCON;           /* GO CHECK FOR CONTINUATION   0053 00134000
*                                      EXPECTED FOR SLASH-ASTERISK 0053 00135000
*                                      CARD                   @Y02064*/ 00136000
         B     CHKCON                                              0053 00137000
*         END;                                                     0054 00138000
*     END NODLM;                                                   0055 00139000
*                                                                  0056 00140000
*   /*****************************************************************/ 00141000
*   /*                                                               */ 00142000
*   /* DLM= DATA CARD (COULD BE //)                                  */ 00143000
*   /*                                                               */ 00144000
*   /*****************************************************************/ 00145000
*                                                                  0056 00146000
*   ELSE                            /* KNOW HTDLMSW IS ON            */ 00147000
*     DO;                                                          0056 00148000
*                                                                  0056 00149000
         B     @RC00039                                            0056 00150000
@RF00039 DS    0H                                                  0057 00151000
*       /*************************************************************/ 00152000
*       /*                                                           */ 00153000
*       /* HAVE FOUND THE DLM= DELIMITER?                            */ 00154000
*       /*                                                           */ 00155000
*       /*************************************************************/ 00156000
*                                                                  0057 00157000
*       IF CARD(1:2)=HTDLM|(CDDAST=ON&CARD(1:2)='//') THEN/* NOTE  0057 00158000
*                                      THAT // CAN ALSO BE DELIM FOR    00159000
*                                      // DD * DATA STREAM           */ 00160000
         CLC   CARD(2,CARDPTR),HTDLM(HTPTR)                        0057 00161000
         BE    @RT00057                                            0057 00162000
         TM    CDDAST(HTPTR),B'10000000'                           0057 00163000
         BNO   @RF00057                                            0057 00164000
         CLC   CARD(2,CARDPTR),@CC00225                            0057 00165000
         BNE   @RF00057                                            0057 00166000
@RT00057 DS    0H                                                  0058 00167000
*         DO;                       /* IF SO,                        */ 00168000
*           HTDLMSW=OFF;            /* STOP LOOKING FOR IT           */ 00169000
         NI    HTDLMSW(HTPTR),B'01111111'                          0059 00170000
*           IF CARD(1:2)='//' THEN  /* IF JCL CARD (AS WELL AS A DLM=   00171000
*                                      DELIMITER)                    */ 00172000
         CLC   CARD(2,CARDPTR),@CC00225                            0060 00173000
         BE    @RT00060                                            0060 00174000
*             GO TO JCL;            /* SCAN THE JCL CARD             */ 00175000
*           ELSE                    /* IF ANY OTHER DELIMITER        */ 00176000
*             DO;                                                  0062 00177000
*               WDATA=ON;           /* SAY THIS IS A DATA CARD       */ 00178000
*               WDELIM=ON;          /* SAY THIS IS A DELIMITER CARD  */ 00179000
         OI    WDATA,B'11000000'                                   0064 00180000
*               GO TO CHKCON;       /* TAKE NORMAL EXIT FROM IKJEFF07*/ 00181000
         B     CHKCON                                              0065 00182000
*             END;                                                 0066 00183000
*         END;                      /* END OF DLM=VALUE FOUND CODE   */ 00184000
*       ELSE                        /* THIS CARD WASN'T THE DELIMITER   00185000
*                                      FOR DLM=                      */ 00186000
*         GO TO SETDATA;            /* PROCESS CARD AS DATA          */ 00187000
*     END;                                                         0069 00188000
*                                                                  0070 00189000
*   /*****************************************************************/ 00190000
*   /*                                                               */ 00191000
*   /* DATA CARD                                                     */ 00192000
*   /*                                                               */ 00193000
*   /*****************************************************************/ 00194000
*                                                                  0070 00195000
*   IF CDDAST=ON THEN               /* DATA SWITCH (DD *) ON         */ 00196000
@RC00039 TM    CDDAST(HTPTR),B'10000000'                           0070 00197000
         BO    @RT00070                                            0070 00198000
*     GO TO SETDATA;                /* FINISH PROCESSING DATA CARD   */ 00199000
*   IF CDDDATA=ON THEN              /* DATA SWITCH (DD DATA) ON      */ 00200000
         TM    CDDDATA(HTPTR),B'01000000'                          0072 00201000
         BO    @RT00072                                            0072 00202000
*     GO TO SETDATA;                /* FINISH PROCESSING DATA CARD   */ 00203000
*   WDDAST=ON;                      /* IF NO TYPE OF DATA SWITCH IS     00204000
*                                      ON, SYSTEM GENERATES A //SYSIN   00205000
*                                      DD * STMT, SO SET SWITCHES TO    00206000
*                                      SHOW SUCH A 'GENERATION'      */ 00207000
         OI    WDDAST,B'10000000'                                  0074 00208000
*   WDATA=ON;                                                      0075 00209000
*                                                                  0075 00210000
         OI    WDATA,B'01000000'                                   0075 00211000
*   /*****************************************************************/ 00212000
*   /*                                                               */ 00213000
*   /* IF EXPECTING CONTINUATION, TURN ON ERROR SWITCH               */ 00214000
*   /*                                                               */ 00215000
*   /*****************************************************************/ 00216000
*                                                                  0076 00217000
*CHKCON:                            /* CONTINUATION IS NOT EXPECTED-    00218000
*                                      ENTERED FROM EITHER NODLM CODE   00219000
*                                      FOR SLASH-ASTERISK OR DLM CODE   00220000
*                                      IF DLM=DELIMETER FOUND        */ 00221000
*   IF CCONEX=ON THEN               /* IF CONTINUATION EXPECTED TURN    00222000
*                                      ERROR SWITCH ON               */ 00223000
CHKCON   TM    CCONEX(HTPTR),B'10000000'                           0076 00224000
         BNO   @RF00076                                            0076 00225000
*     WCONERR=ON;                                                  0077 00226000
*                                                                  0077 00227000
         OI    WCONERR,B'00100000'                                 0077 00228000
*   /*****************************************************************/ 00229000
*   /*                                                               */ 00230000
*   /* CHECK FOR JOB ENTRY SUBSYSTEM CONTROL CARD                    */ 00231000
*   /*                                                               */ 00232000
*   /*****************************************************************/ 00233000
*                                                                  0078 00234000
*   IF CARD(1:2)='/*'&CARD(3)^=' ' THEN/* SCAN FOR JOB ENTRY       0078 00235000
*                                      SUBSYSTEM CONTROL CARD. NOTE     00236000
*                                      JES3 CARD COULD BE          0078 00237000
*                                      SLASH-SLASH-ASTERISK, INSTEAD.   00238000
*                                                             @Y02064*/ 00239000
@RF00076 CLC   CARD(2,CARDPTR),@CC00227                            0078 00240000
         BNE   @RF00078                                            0078 00241000
         CLI   CARD+2(CARDPTR),C' '                                0078 00242000
         BE    @RF00078                                            0078 00243000
*     DO;                           /*                       @ZA06659*/ 00244000
*       WJES=ON;                    /* ON IF SLASH-ASTERISK-NONBLANK    00245000
*                                      CARD                   @Y02064*/ 00246000
         OI    WJES,B'10000000'                                    0080 00247000
*       K=2;                        /* INITIALIZE COLUMN     @ZA06659*/ 00248000
         LA    K,2                                                 0081 00249000
*       CALL SKIPTO;                /* GO TO NEXT BLANK      @ZA06659*/ 00250000
         BAL   @14,SKIPTO                                          0082 00251000
*       CALL SKIPOVER;              /* SKIP OVER BLANKS TO VERB    0083 00252000
*                                                            @ZA06659*/ 00253000
         BAL   @14,SKIPOVER                                        0083 00254000
*       OPOFF=K;                    /* SAVE OPERAND OFFSET FOR     0084 00255000
*                                      INSTALLATION EXIT     @ZA06659*/ 00256000
         STC   K,OPOFF(,HTPTR)                                     0084 00257000
*     END;                          /* END JES LOGIC         @ZA06659*/ 00258000
*   GO TO UPDATE;                   /* EXIT FROM IKJEFF07            */ 00259000
*                                                                  0086 00260000
         B     UPDATE                                              0086 00261000
*   /*****************************************************************/ 00262000
*   /*                                                               */ 00263000
*   /* SET UP HISTORY TABLE INFORMATION FOR DATA CARD                */ 00264000
*   /*                                                               */ 00265000
*   /*****************************************************************/ 00266000
*                                                                  0087 00267000
*SETDATA:                           /* ENTER FOR DD DATA OR DD * DATA*/ 00268000
*   WDTYPE=CDTYPE;                  /* COPY TYPE OF DATA             */ 00269000
SETDATA  MVC   WDTYPE(1),CDTYPE(HTPTR)                             0087 00270000
*   WDATA=ON;                       /* INDICATE DATA CARD            */ 00271000
         OI    WDATA,B'01000000'                                   0088 00272000
*   GO TO UPDATE;                   /* AND EXIT                      */ 00273000
         B     UPDATE                                              0089 00274000
*                                                                  0090 00275000
*   /*****************************************************************/ 00276000
*   /*                                                               */ 00277000
*   /* ANY // CARD                                                   */ 00278000
*   /*                                                               */ 00279000
*   /*****************************************************************/ 00280000
*                                                                  0090 00281000
*JCL:                               /* COME HERE TO START PROCESSING    00282000
*                                      FOR SLASH-SLASH JCL CARDS     */ 00283000
*   IF CDDDATA=ON THEN                                             0090 00284000
JCL      TM    CDDDATA(HTPTR),B'01000000'                          0090 00285000
         BNO   @RF00090                                            0090 00286000
*     DO;                           /* IF DD DATA SW IS ON AND     0091 00287000
*                                      CONTINUATION IS NOT EXPECTED,    00288000
*                                      THEN THIS IS THE DATA ITSELF  */ 00289000
*       IF CCONEX=OFF THEN          /* IF DON'T NEED CONTINUATION OF    00290000
*                                      // DD DATA CARD               */ 00291000
         TM    CCONEX(HTPTR),B'10000000'                           0092 00292000
         BZ    @RT00092                                            0092 00293000
*         GO TO SETDATA;            /* TREAT // CARD AS DATA CARD    */ 00294000
*     END;                          /* IF CDDAST IS ON AND CCONEXP IS   00295000
*                                      OFF SHOULD GENERATE A       0094 00296000
*                                      SLASH-AST                     */ 00297000
*   K=2;                            /* INITIALIZE KOLUMN INDEX       */ 00298000
@RF00090 LA    K,2                                                 0095 00299000
*   IF CCONEX=ON THEN               /* IF CONTINUATION       @ZA06659*/ 00300000
         TM    CCONEX(HTPTR),B'10000000'                           0096 00301000
         BNO   @RF00096                                            0096 00302000
*     CCOMMENT=OFF;                 /* DON'T PROPAGATE COMMENT INFO     00303000
*                                                            @ZA06659*/ 00304000
*                                                                  0097 00305000
         NI    CCOMMENT(HTPTR),B'11111110'                         0097 00306000
*   /*****************************************************************/ 00307000
*   /*                                                               */ 00308000
*   /* CHECK FOR //* CARD                                            */ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0098 00312000
*   IF CARD(3)='*' THEN             /* CHECK FOR //* (COMMENT CARD)  */ 00313000
@RF00096 CLI   CARD+2(CARDPTR),C'*'                                0098 00314000
         BNE   @RF00098                                            0098 00315000
*     DO;                           /*                       @ZA06659*/ 00316000
*       IF CCONEX=ON THEN           /* ALLOWED TO HAVE COMMENT WITHIN   00317000
*                                      CONTINUATION IN MVS   @ZA06659*/ 00318000
         TM    CCONEX(HTPTR),B'10000000'                           0100 00319000
         BNO   @RF00100                                            0100 00320000
*         DO;                       /*                       @ZA06659*/ 00321000
*           WORK=CURRJCL;           /* KEEP STATEMENT INFO   @ZA06659*/ 00322000
         MVC   WORK(4),CURRJCL(HTPTR)                              0102 00323000
*           WVERBCOP=ON;            /* REMEMBER VERB IS BEING      0103 00324000
*                                      CONTINUED             @ZA06659*/ 00325000
         OI    WVERBCOP,B'00001000'                                0103 00326000
*         END;                      /* END CONTIN. LOGIC     @ZA06659*/ 00327000
*       CALL SKIPTO;                /* GO TO NEXT BLANK      @ZA06659*/ 00328000
@RF00100 BAL   @14,SKIPTO                                          0105 00329000
*       CALL SKIPOVER;              /* SKIP OVER BLANKS TO VERB    0106 00330000
*                                                            @ZA06659*/ 00331000
         BAL   @14,SKIPOVER                                        0106 00332000
*       OPOFF=K;                    /* SAVE OPERAND OFFSET FOR     0107 00333000
*                                      INSTALLATION EXIT     @ZA06659*/ 00334000
         STC   K,OPOFF(,HTPTR)                                     0107 00335000
*       WCOMMENT=ON;                /* NOTE COULD ALSO BE JES3     0108 00336000
*                                      CONTROL CARD           @Y02064*/ 00337000
         OI    WCOMMENT,B'00000001'                                0108 00338000
*       GO TO UPDATE;               /* UPDATE HISTORY TABLE FOR JCL     00339000
*                                      CARD                          */ 00340000
         B     UPDATE                                              0109 00341000
*     END;                          /* END COMMENT LOGIC     @ZA06659*/ 00342000
*                                                                  0110 00343000
*   /*****************************************************************/ 00344000
*   /*                                                               */ 00345000
*   /* CHECK FOR // CARD WITH NAME FIELD                             */ 00346000
*   /*                                                               */ 00347000
*   /*****************************************************************/ 00348000
*                                                                  0111 00349000
*   IF CARD(3)^=' ' THEN            /* CHECK FOR A NAME ON // CARD   */ 00350000
@RF00098 CLI   CARD+2(CARDPTR),C' '                                0111 00351000
         BE    @RF00111                                            0111 00352000
*     DO;                                                          0112 00353000
*       WNAME=ON;                                                  0113 00354000
         OI    WNAME,B'00010000'                                   0113 00355000
*       IF CCONEX=ON THEN           /* NOT ALLOWED TO HAVE NAME FIELD   00356000
*                                      ON CONTINUATION CARD          */ 00357000
         TM    CCONEX(HTPTR),B'10000000'                           0114 00358000
         BNO   @RF00114                                            0114 00359000
*         WCONERR=ON;               /* INDICATE CONTINUATION ERROR   */ 00360000
         OI    WCONERR,B'00100000'                                 0115 00361000
*     END;                                                         0116 00362000
@RF00114 DS    0H                                                  0117 00363000
*                                                                  0117 00364000
*   /*****************************************************************/ 00365000
*   /*                                                               */ 00366000
*   /* LOOK FOR VERB FIELD                                           */ 00367000
*   /*                                                               */ 00368000
*   /*****************************************************************/ 00369000
*                                                                  0117 00370000
*   CALL SKIPTO;                    /* GO TO NEXT BLANK              */ 00371000
@RF00111 BAL   @14,SKIPTO                                          0117 00372000
*   CALL SKIPOVER;                  /* SKIP OVER BLANKS TO VERB      */ 00373000
*                                                                  0118 00374000
         BAL   @14,SKIPOVER                                        0118 00375000
*   /*****************************************************************/ 00376000
*   /*                                                               */ 00377000
*   /* IF NO VERB FIELD                                              */ 00378000
*   /*                                                               */ 00379000
*   /*****************************************************************/ 00380000
*                                                                  0119 00381000
*   IF K=0 THEN                     /* IF NO NEXT (VERB) FIELD       */ 00382000
         LTR   K,K                                                 0119 00383000
         BNZ   @RF00119                                            0119 00384000
*     DO;                                                          0120 00385000
*                                                                  0120 00386000
*       /*************************************************************/ 00387000
*       /*                                                           */ 00388000
*       /* 'NOTHING' CARD - //NAME NOOPERAND                         */ 00389000
*       /*                                                           */ 00390000
*       /*************************************************************/ 00391000
*                                                                  0121 00392000
*       IF WNAME=ON THEN            /* THEN IF NAMED, IT IS NOTHING  */ 00393000
         TM    WNAME,B'00010000'                                   0121 00394000
         BNO   @RF00121                                            0121 00395000
*         DO;                                                      0122 00396000
*           WNOTHING=ON;            /* NOTE WCONERR SWITCH ALREADY ON   00397000
*                                      IF EXPECTED CONTINUATION CARD */ 00398000
         OI    WNOTHING,B'00000010'                                0123 00399000
*           GO TO UPDATE;           /* EXIT FROM IKJEFF07            */ 00400000
         B     UPDATE                                              0124 00401000
*         END;                                                     0125 00402000
*                                                                  0125 00403000
*       /*************************************************************/ 00404000
*       /*                                                           */ 00405000
*       /* NULL CARD                                                 */ 00406000
*       /*                                                           */ 00407000
*       /*************************************************************/ 00408000
*                                                                  0126 00409000
*       IF CCONEX=OFF THEN          /* THEN IF BLANK, AND NOT      0126 00410000
*                                      CONTINUATION                  */ 00411000
@RF00121 TM    CCONEX(HTPTR),B'10000000'                           0126 00412000
         BNZ   @RF00126                                            0126 00413000
*         DO;                                                      0127 00414000
*           WNULL=ON;               /* IT IS NULL                    */ 00415000
         OI    WNULL,B'00100000'                                   0128 00416000
*           GO TO UPDATE;           /* EXIT FROM IKJEFF07            */ 00417000
         B     UPDATE                                              0129 00418000
*         END;                                                     0130 00419000
*       ELSE                        /* NULL CARD USED FOR CONTINUING */ 00420000
*         DO;                                                      0131 00421000
@RF00126 DS    0H                                                  0132 00422000
*           WVERB=CVERB;            /* THEN BLANK AND CONTINUATION   */ 00423000
         MVC   WVERB(2),CVERB(HTPTR)                               0132 00424000
*           WVERBCOP=ON;            /* COPY THE VERB                 */ 00425000
         OI    WVERBCOP,B'00001000'                                0133 00426000
*           WDTYPE=CDTYPE;                                         0134 00427000
         MVC   WDTYPE(1),CDTYPE(HTPTR)                             0134 00428000
*           IF COPCONEX=ON THEN     /* ERROR IF OPERAND CONTINUATION */ 00429000
         TM    COPCONEX(HTPTR),B'01000000'                         0135 00430000
         BNO   @RF00135                                            0135 00431000
*             WCONERR=ON;           /* EXPECTED BUT NOT FOUND        */ 00432000
         OI    WCONERR,B'00100000'                                 0136 00433000
*           GO TO SCANEXIT;         /* END SCAN OF // NULL CARD      */ 00434000
         B     SCANEXIT                                            0137 00435000
*         END;                                                     0138 00436000
*     END;                          /* END CODE FOR NO NEXT (VERB) 0139 00437000
*                                      FIELD                         */ 00438000
*                                                                  0140 00439000
*   /*****************************************************************/ 00440000
*   /*                                                               */ 00441000
*   /* // CARD WITH VERB FIELD                                       */ 00442000
*   /*                                                               */ 00443000
*   /*****************************************************************/ 00444000
*                                                                  0140 00445000
*   A=K+3;                                                         0140 00446000
@RF00119 LA    A,3                                                 0140 00447000
         ALR   A,K                                                 0140 00448000
*   IF CARD(K:A)='JOB ' THEN        /* VERB = JOB                    */ 00449000
         LR    @10,A                                               0141 00450000
         SLR   @10,K                                               0141 00451000
         LR    @01,CARDPTR                                         0141 00452000
         ALR   @01,K                                               0141 00453000
         BCTR  @01,0                                               0141 00454000
         EX    @10,@SC00299                                        0141 00455000
         BNE   @RF00141                                            0141 00456000
*     DO;                                                          0142 00457000
*       IF WNAME=ON THEN            /* NEED TO SAVE THE JOB NAME FOR    00458000
*                                      USE IN MESSAGES               */ 00459000
         TM    WNAME,B'00010000'                                   0143 00460000
         BNO   @RF00143                                            0143 00461000
*         DO;                                                      0144 00462000
*           IF CCOMCON='1'B THEN    /* IF LAST STMT SAYS THIS SHOULD    00463000
*                                      BE TREATED AS A COMMENT       */ 00464000
         TM    CCOMCON(HTPTR),B'00000100'                          0145 00465000
         BO    @RT00145                                            0145 00466000
*             GO TO SCANOP;         /* FORGET THE NAME               */ 00467000
*           NAME=' ';               /* BLANK OUT THE RECEIVING FIELD    00468000
*                                      FOR THE STMT NAME             */ 00469000
         MVI   NAME+1,C' '                                         0147 00470000
         MVC   NAME+2(6),NAME+1                                    0147 00471000
         MVI   NAME,C' '                                           0147 00472000
*           A=K-1;                                                 0148 00473000
         LR    A,K                                                 0148 00474000
         BCTR  A,0                                                 0148 00475000
*           IF K>10 THEN            /* MAXIMUM NAME LENGTH IS 8      */ 00476000
         C     K,@CF00240                                          0149 00477000
         BNH   @RF00149                                            0149 00478000
*             NAME=CARD(3:10);                                     0150 00479000
         MVC   NAME(8),CARD+2(CARDPTR)                             0150 00480000
*           ELSE                    /* PICK UP SHORTER NAME          */ 00481000
*             NAME=CARD(3:A);                                      0151 00482000
         B     @RC00149                                            0151 00483000
@RF00149 MVI   NAME+1,C' '                                         0151 00484000
         MVC   NAME+2(6),NAME+1                                    0151 00485000
         LR    @10,A                                               0151 00486000
         SL    @10,@CF00106                                        0151 00487000
         EX    @10,@SM00301                                        0151 00488000
*           WJOB=ON;                                               0152 00489000
@RC00149 OI    WJOB,B'00010000'                                    0152 00490000
*           JOBNAME=NAME;           /* SAVE THE NAME ON THE JOB CARD */ 00491000
         L     @10,@PC00001+8                                      0153 00492000
         MVC   JOBNAME(8,@10),NAME                                 0153 00493000
*           GO TO SCANOP;           /* NOW SCAN THE OPERAND FIELD    */ 00494000
         B     SCANOP                                              0154 00495000
*         END;                                                     0155 00496000
*     END;                                                         0156 00497000
@RF00143 DS    0H                                                  0157 00498000
*   IF WNAME=OFF THEN               /* IF NO NAME FIELD ON THIS // 0157 00499000
*                                      CARD                          */ 00500000
@RF00141 TM    WNAME,B'00010000'                                   0157 00501000
         BNZ   @RF00157                                            0157 00502000
*     DO;                                                          0158 00503000
*       IF CCONEX=OFF THEN          /* IF NOT CONTINUATION           */ 00504000
         TM    CCONEX(HTPTR),B'10000000'                           0159 00505000
         BZ    @RT00159                                            0159 00506000
*         GO TO CHKEXEC;            /* STILL CHECK THE VERB FIELD    */ 00507000
*       WVERB=CVERB;                /* IF NO NAME AND CONTINUED      */ 00508000
         MVC   WVERB(2),CVERB(HTPTR)                               0161 00509000
*       WDTYPE=CDTYPE;              /* COPY DATA TYPE                */ 00510000
         MVC   WDTYPE(1),CDTYPE(HTPTR)                             0162 00511000
*       WVERBCOP=ON;                /* INDICATE VALID CONTINUATION   */ 00512000
         OI    WVERBCOP,B'00001000'                                0163 00513000
*       GO TO CHKOP16;              /* CHECK FOR VALID OPERAND       */ 00514000
         B     CHKOP16                                             0164 00515000
*     END;                                                         0165 00516000
*CHKEXEC:                           /* CHECK FOR VERB = EXEC         */ 00517000
*   A=K+4;                                                         0166 00518000
@RF00157 DS    0H                                                  0166 00519000
CHKEXEC  LA    A,4                                                 0166 00520000
         ALR   A,K                                                 0166 00521000
*   IF CARD(K:A)='EXEC ' THEN       /* EXEC                          */ 00522000
         LR    @10,A                                               0167 00523000
         SLR   @10,K                                               0167 00524000
         LR    @01,CARDPTR                                         0167 00525000
         ALR   @01,K                                               0167 00526000
         BCTR  @01,0                                               0167 00527000
         EX    @10,@SC00303                                        0167 00528000
         BNE   @RF00167                                            0167 00529000
*     DO;                                                          0168 00530000
*       WEXEC=ON;                                                  0169 00531000
         OI    WEXEC,B'00001000'                                   0169 00532000
*       GO TO SCANOP;               /* NOW CHECK OPERAND FIELD       */ 00533000
         B     SCANOP                                              0170 00534000
*     END;                                                         0171 00535000
*   A=K+2;                                                         0172 00536000
@RF00167 LA    A,2                                                 0172 00537000
         ALR   A,K                                                 0172 00538000
*   IF CARD(K:A)^='DD ' THEN        /* CHECK FOR NOT DD              */ 00539000
         LR    @10,A                                               0173 00540000
         SLR   @10,K                                               0173 00541000
         LR    @01,CARDPTR                                         0173 00542000
         ALR   @01,K                                               0173 00543000
         BCTR  @01,0                                               0173 00544000
         EX    @10,@SC00305                                        0173 00545000
         BE    @RF00173                                            0173 00546000
*     DO;                                                          0174 00547000
*       WCOMMAND=ON;                /* IF A COMMAND (DEFAULT VERB  0175 00548000
*                                      TYPE - COULD BE PROC OR PEND     00549000
*                                                            @ZA06659*/ 00550000
         OI    WCOMMAND,B'00000010'                                0175 00551000
*     END;                          /* NOW CHECK OPERAND     @ZA06659*/ 00552000
*   ELSE                            /* DD                            */ 00553000
*     WDD=ON;                                                      0177 00554000
         B     @RC00173                                            0177 00555000
@RF00173 OI    WDD,B'00000100'                                     0177 00556000
*                                                                  0178 00557000
*   /*****************************************************************/ 00558000
*   /*                                                               */ 00559000
*   /* // CARD WITH OPERAND FIELD                                    */ 00560000
*   /*                                                               */ 00561000
*   /*****************************************************************/ 00562000
*                                                                  0178 00563000
*SCANOP:                                                           0178 00564000
*   CALL SKIPTO;                    /* GO TO NEXT BLANK              */ 00565000
@RC00173 DS    0H                                                  0178 00566000
SCANOP   BAL   @14,SKIPTO                                          0178 00567000
*   CALL SKIPOVER;                  /* GO TO NEXT (OPERAND) FIELD    */ 00568000
*                                                                  0179 00569000
         BAL   @14,SKIPOVER                                        0179 00570000
*   /*****************************************************************/ 00571000
*   /*                                                               */ 00572000
*   /* EXIT IF NO OPERAND FIELD                                      */ 00573000
*   /*                                                               */ 00574000
*   /*****************************************************************/ 00575000
*                                                                  0180 00576000
*   IF K=0 THEN                     /* IF NO OPERAND FIELD           */ 00577000
         LTR   K,K                                                 0180 00578000
         BZ    @RT00180                                            0180 00579000
*     GO TO SCANEXIT;               /* CLEAN UP AND EXIT             */ 00580000
*   GO TO CHKOP;                    /* GO CHECK OPERAND              */ 00581000
*                                                                  0182 00582000
         B     CHKOP                                               0182 00583000
*   /*****************************************************************/ 00584000
*   /*                                                               */ 00585000
*   /* PROCESS CONTINUATION CARDS HERE                               */ 00586000
*   /*                                                               */ 00587000
*   /*****************************************************************/ 00588000
*                                                                  0183 00589000
*CHKOP16:                           /* CONTINUATIONS COME HERE --  0183 00590000
*                                      SHOULD BE IN OR PRIOR TO COL16*/ 00591000
*                                                                  0183 00592000
*   /*****************************************************************/ 00593000
*   /*                                                               */ 00594000
*   /* ERROR IF DON'T EXPECT OPERAND CONTINUATION                    */ 00595000
*   /*                                                               */ 00596000
*   /*****************************************************************/ 00597000
*                                                                  0183 00598000
*   IF COPCONEX=OFF THEN                                           0183 00599000
CHKOP16  TM    COPCONEX(HTPTR),B'01000000'                         0183 00600000
         BZ    @RT00183                                            0183 00601000
*     GO TO SCANEXIT;               /* CLEAN UP AND EXIT             */ 00602000
*                                                                  0184 00603000
*   /*****************************************************************/ 00604000
*   /*                                                               */ 00605000
*   /* ERROR IF CONTINUATION STARTS AFTER COLUMN 16                  */ 00606000
*   /*                                                               */ 00607000
*   /*****************************************************************/ 00608000
*                                                                  0185 00609000
*   IF K>16 THEN                    /* THIS IS A CONERR IF THE     0185 00610000
*                                      OPERAND CONTINUATION STARTS 0185 00611000
*                                      BEYOND COL 16 -- THE READER/     00612000
*                                      INTERPRETER WILL THINK IT A 0185 00613000
*                                      COMMENT WHEN IT IS NOT        */ 00614000
         C     K,@CF00249                                          0185 00615000
         BNH   @RF00185                                            0185 00616000
*     DO;                                                          0186 00617000
*       WCONERR=ON;                                                0187 00618000
         OI    WCONERR,B'00100000'                                 0187 00619000
*       GO TO SCANEXIT;             /* CLEAN UP AND EXIT             */ 00620000
         B     SCANEXIT                                            0188 00621000
*     END;                                                         0189 00622000
*                                                                  0190 00623000
*   /*****************************************************************/ 00624000
*   /*                                                               */ 00625000
*   /* RE-SCAN OPERAND FIELD TO CHECK FOR PAIRED QUOTES              */ 00626000
*   /*                                                               */ 00627000
*   /*****************************************************************/ 00628000
*                                                                  0190 00629000
*CHKOP:                                                            0190 00630000
*   S=K;                            /* HOLD START OF FIELD           */ 00631000
@RF00185 DS    0H                                                  0190 00632000
CHKOP    LR    S,K                                                 0190 00633000
*   OPOFF=K;                        /* MARK THE OPERAND OFFSET       */ 00634000
         STC   K,OPOFF(,HTPTR)                                     0191 00635000
*MOREQ:                             /* FIND END OF FIELD AND QUOTES  */ 00636000
*   Q=K;                            /* HOLD START OF FIELD           */ 00637000
MOREQ    LR    Q,K                                                 0192 00638000
*   CALL SKIPTO;                    /* SKIP K TO NEXT BLANK          */ 00639000
         BAL   @14,SKIPTO                                          0193 00640000
*   IF K=0 THEN                     /* IF NO BLANK FOUND             */ 00641000
         LTR   K,K                                                 0194 00642000
         BNZ   @RF00194                                            0194 00643000
*     L=72;                                                        0195 00644000
         LA    L,72                                                0195 00645000
*   ELSE                            /* BLANK BEFORE OR AT END        */ 00646000
*     L=K;                          /* FIND BLANK OR END             */ 00647000
         B     @RC00194                                            0196 00648000
@RF00194 LR    L,K                                                 0196 00649000
*   K=Q;                            /* THEN START OVER AND           */ 00650000
@RC00194 LR    K,Q                                                 0197 00651000
*   CALL SKIPTOQ;                   /* FIND A QUOTE                  */ 00652000
         BAL   @14,SKIPTOQ                                         0198 00653000
*   IF K=0 THEN                     /* NO MORE BLANKS ON CARD        */ 00654000
         LTR   K,K                                                 0199 00655000
         BZ    @RT00199                                            0199 00656000
*     GO TO NOQ;                    /* SO HAVE NO QUOTE              */ 00657000
*   IF L<K THEN                     /* OR BLANK COMES FIRST          */ 00658000
         CR    L,K                                                 0201 00659000
         BL    @RT00201                                            0201 00660000
*     GO TO NOQ;                    /* CONSIDER HAVE NO QUOTE        */ 00661000
*   K=K+1;                          /* PT TO CHAR AFTER THE QUOTE    */ 00662000
         AL    K,@CF00042                                          0203 00663000
*   CALL SKIPTOQ;                   /* FIND NEXT QUOTE               */ 00664000
         BAL   @14,SKIPTOQ                                         0204 00665000
*   IF K=0 THEN                     /* IF NO QUOTE FOUND             */ 00666000
         LTR   K,K                                                 0205 00667000
         BZ    @RT00205                                            0205 00668000
*     GO TO NOQ;                    /* CONTINUE                      */ 00669000
*   GO TO MOREQ;                    /* OTHERWISE GO AGAIN            */ 00670000
*                                                                  0207 00671000
         B     MOREQ                                               0207 00672000
*   /*****************************************************************/ 00673000
*   /*                                                               */ 00674000
*   /* // CARD ENDING WITH COMMA                                     */ 00675000
*   /*                                                               */ 00676000
*   /*****************************************************************/ 00677000
*                                                                  0208 00678000
*NOQ:                               /* S = START OF FIELD. L = CHAR     00679000
*                                      AFTER FIELD                   */ 00680000
*   A=L-1;                                                         0208 00681000
NOQ      LR    A,L                                                 0208 00682000
         BCTR  A,0                                                 0208 00683000
*   IF CARD(A)=COMMA THEN           /* IF THE OPERAND ENDS WITH A  0209 00684000
*                                      COMMA THEN SET THE OPERAND CON   00685000
*                                      EXPECTED SW ON                */ 00686000
         LR    @10,CARDPTR                                         0209 00687000
         ALR   @10,A                                               0209 00688000
         BCTR  @10,0                                               0209 00689000
         CLI   CARD(@10),C','                                      0209 00690000
         BNE   @RF00209                                            0209 00691000
*     DO;                                                          0210 00692000
*       WOPCONEX=ON;                                               0211 00693000
*       WCONEX=ON;                                                 0212 00694000
         OI    WOPCONEX,B'11000000'                                0212 00695000
*     END;                                                         0213 00696000
*                                                                  0214 00697000
*/********************************************************************/ 00698000
*/*          // DD *                                                 */ 00699000
*/*      OR  // DD DATA   CARD                                       */ 00700000
*/********************************************************************/ 00701000
*                                                                  0214 00702000
*   IF WDD=ON THEN                  /* IF DD CARD (OR DD           0214 00703000
*                                      CONTINUATION)                 */ 00704000
@RF00209 TM    WDD,B'00000100'                                     0214 00705000
         BNO   @RF00214                                            0214 00706000
*DDCODE:                            /* SPECIAL PROCESSING FOR OPERAND   00707000
*                                      OF DD CARD                    */ 00708000
*     DO;                                                          0215 00709000
DDCODE   DS    0H                                                  0216 00710000
*       IF WVERBCOP=OFF THEN        /* CHECK FOR DD * OR DD DATA IF     00711000
*                                      NOT A CONTINUATION CARD       */ 00712000
         TM    WVERBCOP,B'00001000'                                0216 00713000
         BNZ   @RF00216                                            0216 00714000
*         DO;                                                      0217 00715000
*           IF CARD(S)='*' THEN     /* CHECK FOR // DD *             */ 00716000
         LR    @10,CARDPTR                                         0218 00717000
         ALR   @10,S                                               0218 00718000
         BCTR  @10,0                                               0218 00719000
         CLI   CARD(@10),C'*'                                      0218 00720000
         BNE   @RF00218                                            0218 00721000
*             WDDAST=ON;                                           0219 00722000
         OI    WDDAST,B'10000000'                                  0219 00723000
*           ELSE                    /* CHECK FOR // DD DATA          */ 00724000
*             DO;                                                  0220 00725000
         B     @RC00218                                            0220 00726000
@RF00218 DS    0H                                                  0221 00727000
*               L=S+3;                                             0221 00728000
         LA    L,3                                                 0221 00729000
         ALR   L,S                                                 0221 00730000
*               IF CARD(S:L)='DATA' THEN/* IF FOUND // DD DATA       */ 00731000
         LR    @10,L                                               0222 00732000
         SLR   @10,S                                               0222 00733000
         LR    @05,CARDPTR                                         0222 00734000
         ALR   @05,S                                               0222 00735000
         BCTR  @05,0                                               0222 00736000
         EX    @10,@SC00308                                        0222 00737000
         BNE   @RF00222                                            0222 00738000
*                 WDDDATA=ON;       /* REMEMBER IT                   */ 00739000
         OI    WDDDATA,B'01000000'                                 0223 00740000
*             END;                                                 0224 00741000
@RF00222 DS    0H                                                  0225 00742000
*         END;                                                     0225 00743000
@RC00218 DS    0H                                                  0226 00744000
*       IF(WDDAST=ON|WDDDATA=ON)&HTDLMSW=OFF THEN/* IF THIS IS A DD *   00745000
*                                      OR DD DATA CARD AND HAVEN'T 0226 00746000
*                                      FOUND A DLM= KEYWORD YET    0226 00747000
*                                      (COULD BE CONTINUATION OF THE    00748000
*                                      DD CARD)                      */ 00749000
*                                                                  0226 00750000
@RF00216 TM    WDDAST,B'11000000'                                  0226 00751000
         BZ    @RF00226                                            0226 00752000
         TM    HTDLMSW(HTPTR),B'10000000'                          0226 00753000
         BNZ   @RF00226                                            0226 00754000
*         /***********************************************************/ 00755000
*         /*                                                         */ 00756000
*         /* FF07SDLM CODE - SEARCHES FOR DLM= KEYWORD ON DD CARD    */ 00757000
*         /*                                                         */ 00758000
*         /***********************************************************/ 00759000
*                                                                  0227 00760000
*CHKDLM:                                                           0227 00761000
*         DO;                                                      0227 00762000
CHKDLM   DS    0H                                                  0228 00763000
*           DLMWORK=DLMWORK&&DLMWORK;/* ZERO OUT SWITCH AREA         */ 00764000
         XC    DLMWORK(1),DLMWORK                                  0228 00765000
*           DO S=S TO A BY 1 WHILE WDLMFND=OFF;/* SEARCH IS FROM   0229 00766000
*                                      FIRST TO LAST COLUMN OF     0229 00767000
*                                      OPERAND FIELD, AND END SEARCH    00768000
*                                      WHEN FIND DLM=                */ 00769000
         B     @DE00229                                            0229 00770000
@DL00229 TM    WDLMFND,B'00000001'                                 0229 00771000
         BNZ   @DC00229                                            0229 00772000
*             PREVCOL=S-1;          /* WILL CHECK COLUMN BEFORE DLM= */ 00773000
         LR    PREVCOL,S                                           0230 00774000
         BCTR  PREVCOL,0                                           0230 00775000
*             D=S+3;                /* POINT TO END CHARACTER OF DLM=*/ 00776000
*                                                                  0231 00777000
         LA    D,3                                                 0231 00778000
         ALR   D,S                                                 0231 00779000
*             /*******************************************************/ 00780000
*             /*                                                     */ 00781000
*             /* CODE FOR 'DLM=' FOUND                               */ 00782000
*             /*                                                     */ 00783000
*             /*******************************************************/ 00784000
*                                                                  0232 00785000
*             IF CARD(S:D)='DLM=' THEN/* FIRST CHECK FOR DLM=KEYWORD */ 00786000
         LR    @10,D                                               0232 00787000
         SLR   @10,S                                               0232 00788000
         LR    @09,CARDPTR                                         0232 00789000
         ALR   @09,S                                               0232 00790000
         BCTR  @09,0                                               0232 00791000
         EX    @10,@SC00310                                        0232 00792000
         BNE   @RF00232                                            0232 00793000
*               IF CARD(PREVCOL)=COMMA|CARD(PREVCOL)=BLANK THEN/*  0233 00794000
*                                      O.K. IF ',DLM=' OR ' DLM='    */ 00795000
         LR    @10,CARDPTR                                         0233 00796000
         ALR   @10,PREVCOL                                         0233 00797000
         BCTR  @10,0                                               0233 00798000
         CLI   CARD(@10),C','                                      0233 00799000
         BE    @RT00233                                            0233 00800000
         LR    @10,CARDPTR                                         0233 00801000
         ALR   @10,PREVCOL                                         0233 00802000
         BCTR  @10,0                                               0233 00803000
         CLI   CARD(@10),C' '                                      0233 00804000
         BNE   @RF00233                                            0233 00805000
@RT00233 DS    0H                                                  0234 00806000
*DLMCODE:                           /* SPECIAL PROCESSING FOR DLM=   */ 00807000
*                 DO;                                              0234 00808000
DLMCODE  DS    0H                                                  0235 00809000
*                   WDLMFND=ON;     /* INDICATE END OF SEARCH        */ 00810000
         OI    WDLMFND,B'00000001'                                 0235 00811000
*                   D=D+1;          /* POINT TO VALUE (MUST CHECK IT    00812000
*                                      FOR ERRORS)                   */ 00813000
*                                                                  0236 00814000
         LA    @10,1                                               0236 00815000
         ALR   D,@10                                               0236 00816000
*                   /*************************************************/ 00817000
*                   /*                                               */ 00818000
*                   /* DLM= VALUE IN QUOTES (CONTAINS SPECIAL        */ 00819000
*                   /* CHARACTERS)                                   */ 00820000
*                   /*                                               */ 00821000
*                   /*************************************************/ 00822000
*                                                                  0237 00823000
*                   IF CARD(D)=QUOTE THEN                          0237 00824000
         LR    @09,CARDPTR                                         0237 00825000
         ALR   @09,D                                               0237 00826000
         BCTR  @09,0                                               0237 00827000
         CLI   CARD(@09),C''''                                     0237 00828000
         BNE   @RF00237                                            0237 00829000
*                     DO;                                          0238 00830000
*                       D=D+1;      /* SKIP OVER LEFT QUOTE          */ 00831000
         ALR   D,@10                                               0239 00832000
*                       IF CARD(D)=QUOTE|CARD(D)=AMPRSAND THEN/*   0240 00833000
*                                      CHECK FOR AMPERSAND OR QUOTE     00834000
*                                      AS FIRST DLM= CHARACTER (THEY    00835000
*                                      NEED SPECIAL CHECKS, SINCE '     00836000
*                                      AND & ARE REPRESENTED AS '' 0240 00837000
*                                      AND && IN VALUE FIELD)        */ 00838000
         LR    @10,CARDPTR                                         0240 00839000
         ALR   @10,D                                               0240 00840000
         BCTR  @10,0                                               0240 00841000
         CLI   CARD(@10),C''''                                     0240 00842000
         BE    @RT00240                                            0240 00843000
         LR    @10,CARDPTR                                         0240 00844000
         ALR   @10,D                                               0240 00845000
         BCTR  @10,0                                               0240 00846000
         CLI   CARD(@10),C'&&'                                     0240 00847000
         BNE   @RF00240                                            0240 00848000
@RT00240 DS    0H                                                  0241 00849000
*                         DO;                                      0241 00850000
*                           PREVCOL=D;/* SAVE THIS COLUMN NUMBER     */ 00851000
         LR    PREVCOL,D                                           0242 00852000
*                           D=D+1;  /* SKIP DUPLICATE CHAR ON LEFT   */ 00853000
         AL    D,@CF00042                                          0243 00854000
*                           IF CARD(PREVCOL)^=CARD(D) THEN/* IF NOT     00855000
*                                      DOUBLE QUOTE OR DOUBLE      0244 00856000
*                                      AMPERSAND                     */ 00857000
         LR    @10,CARDPTR                                         0244 00858000
         ALR   @10,PREVCOL                                         0244 00859000
         BCTR  @10,0                                               0244 00860000
         LR    @09,CARDPTR                                         0244 00861000
         ALR   @09,D                                               0244 00862000
         BCTR  @09,0                                               0244 00863000
         CLC   CARD(1,@10),CARD(@09)                               0244 00864000
         BE    @RF00244                                            0244 00865000
*                             DLMERR=ON;/* BAD DLM= VALUE            */ 00866000
         OI    DLMERR,B'01000000'                                  0245 00867000
*                         END;                                     0246 00868000
@RF00244 DS    0H                                                  0247 00869000
*                       IF DLMERR=OFF THEN/* IF NO ERROR YET         */ 00870000
@RF00240 TM    DLMERR,B'01000000'                                  0247 00871000
         BNZ   @RF00247                                            0247 00872000
*CHAR2:                             /* CHECK SECOND CHAR OF VALUE    */ 00873000
*                         DO;                                      0248 00874000
CHAR2    DS    0H                                                  0249 00875000
*                           N=D+1;  /* POINT TO SECOND DLM= CHAR     */ 00876000
         LA    N,1                                                 0249 00877000
         ALR   N,D                                                 0249 00878000
*                           IF CARD(N)=QUOTE|CARD(N)=AMPRSAND THEN/*    00879000
*                                      CHECK FOR AMPERSAND OR QUOTE     00880000
*                                      AS SECOND DLM= CHARACTER      */ 00881000
         LR    @10,CARDPTR                                         0250 00882000
         ALR   @10,N                                               0250 00883000
         BCTR  @10,0                                               0250 00884000
         CLI   CARD(@10),C''''                                     0250 00885000
         BE    @RT00250                                            0250 00886000
         LR    @10,CARDPTR                                         0250 00887000
         ALR   @10,N                                               0250 00888000
         BCTR  @10,0                                               0250 00889000
         CLI   CARD(@10),C'&&'                                     0250 00890000
         BNE   @RF00250                                            0250 00891000
@RT00250 DS    0H                                                  0251 00892000
*                             DO;                                  0251 00893000
*                               PREVCOL=N;/* SAVE THIS COLUMN NUMBER */ 00894000
         LR    PREVCOL,N                                           0252 00895000
*                               N=N+1;/* SKIP DUPLICATE CHAR ON LEFT */ 00896000
         AL    N,@CF00042                                          0253 00897000
*                               IF CARD(PREVCOL)^=CARD(N) THEN/* IF     00898000
*                                      NOT DOUBLE QUOTE OR DOUBLE  0254 00899000
*                                      AMPERSAND                     */ 00900000
         LR    @10,CARDPTR                                         0254 00901000
         ALR   @10,PREVCOL                                         0254 00902000
         BCTR  @10,0                                               0254 00903000
         LR    @09,CARDPTR                                         0254 00904000
         ALR   @09,N                                               0254 00905000
         BCTR  @09,0                                               0254 00906000
         CLC   CARD(1,@10),CARD(@09)                               0254 00907000
         BE    @RF00254                                            0254 00908000
*                                 DLMERR=ON;/* BAD DLM= VALUE        */ 00909000
         OI    DLMERR,B'01000000'                                  0255 00910000
*                             END;                                 0256 00911000
@RF00254 DS    0H                                                  0257 00912000
*                           IF DLMERR=OFF THEN/* IF NO ERROR, CHECK     00913000
*                                      FOR END                       */ 00914000
@RF00250 TM    DLMERR,B'01000000'                                  0257 00915000
         BNZ   @RF00257                                            0257 00916000
*                             DO;                                  0258 00917000
*                               N=N+1;/* POINT TO CHAR AFTER DLM=  0259 00918000
*                                      VALUE                         */ 00919000
         AL    N,@CF00042                                          0259 00920000
*                               IF CARD(N)^=QUOTE THEN/* NEED AN END    00921000
*                                      QUOTE AFTER THE VALUE         */ 00922000
         LR    @10,CARDPTR                                         0260 00923000
         ALR   @10,N                                               0260 00924000
         BCTR  @10,0                                               0260 00925000
         CLI   CARD(@10),C''''                                     0260 00926000
         BE    @RF00260                                            0260 00927000
*                                 DLMERR=ON;/* REMEMBER HAVE BAD   0261 00928000
*                                      VALUE                         */ 00929000
         OI    DLMERR,B'01000000'                                  0261 00930000
*                               ELSE/* IF ENTIRE DLM= VALUE O.K.     */ 00931000
*                                 N=N+1;/* POINT TO COLUMN AFTER   0262 00932000
*                                      QUOTE                         */ 00933000
         B     @RC00260                                            0262 00934000
@RF00260 AL    N,@CF00042                                          0262 00935000
*                             END;                                 0263 00936000
*                         END CHAR2;                               0264 00937000
*                     END;          /* END CODE FOR VALUE IN QUOTES  */ 00938000
*                                                                  0265 00939000
*                   /*************************************************/ 00940000
*                   /*                                               */ 00941000
*                   /* DLM= VALUE NOT SPECIAL CHARACTERS             */ 00942000
*                   /*                                               */ 00943000
*                   /*************************************************/ 00944000
*                                                                  0266 00945000
*                   ELSE                                           0266 00946000
*                     DO;                                          0266 00947000
         B     @RC00237                                            0266 00948000
@RF00237 DS    0H                                                  0267 00949000
*                       DO I=DIM(DLMCH) TO 1 BY-1 WHILE DLMEND=OFF;/*   00950000
*                                      CHECK FOR FIRST CHARACTER   0267 00951000
*                                      ALPHAMERIC OR NATIONAL        */ 00952000
         LA    I,39                                                0267 00953000
@DL00267 TM    DLMEND,B'10000000'                                  0267 00954000
         BNZ   @DC00267                                            0267 00955000
*                         IF CARD(D)=DLMCH(I) THEN/* EXIT IF MATCH   */ 00956000
         LR    @10,CARDPTR                                         0268 00957000
         ALR   @10,D                                               0268 00958000
         BCTR  @10,0                                               0268 00959000
         LA    @09,DLMCH-1(I)                                      0268 00960000
         CLC   CARD(1,@10),0(@09)                                  0268 00961000
         BNE   @RF00268                                            0268 00962000
*                           DLMEND=ON;                             0269 00963000
         OI    DLMEND,B'10000000'                                  0269 00964000
*                       END;                                       0270 00965000
@RF00268 BCTR  I,0                                                 0270 00966000
         LTR   I,I                                                 0270 00967000
         BP    @DL00267                                            0270 00968000
@DC00267 DS    0H                                                  0271 00969000
*                       IF DLMEND=ON THEN/* IF FIRST CHAR O.K. CHECK    00970000
*                                      NEXT                          */ 00971000
         TM    DLMEND,B'10000000'                                  0271 00972000
         BNO   @RF00271                                            0271 00973000
*                         DO;                                      0272 00974000
*                           N=D+1;  /* POINT TO SECOND CHAR          */ 00975000
         LA    N,1                                                 0273 00976000
         ALR   N,D                                                 0273 00977000
*                           DO I=DIM(DLMCH) TO 1 BY-1 WHILE DLMEND=ON;  00978000
         LA    I,39                                                0274 00979000
@DL00274 TM    DLMEND,B'10000000'                                  0274 00980000
         BNO   @DC00274                                            0274 00981000
*                                   /* CHECK FOR VALID CHARACTER     */ 00982000
*                             IF CARD(N)=DLMCH(I) THEN/* EXIT IF   0275 00983000
*                                      MATCH                         */ 00984000
         LR    @10,CARDPTR                                         0275 00985000
         ALR   @10,N                                               0275 00986000
         BCTR  @10,0                                               0275 00987000
         LA    @09,DLMCH-1(I)                                      0275 00988000
         CLC   CARD(1,@10),0(@09)                                  0275 00989000
         BNE   @RF00275                                            0275 00990000
*                               DLMEND=OFF;                        0276 00991000
         NI    DLMEND,B'01111111'                                  0276 00992000
*                           END;                                   0277 00993000
@RF00275 BCTR  I,0                                                 0277 00994000
         LTR   I,I                                                 0277 00995000
         BP    @DL00274                                            0277 00996000
@DC00274 DS    0H                                                  0278 00997000
*                           IF DLMEND=OFF THEN/* IF BOTH CHARS O.K.  */ 00998000
         TM    DLMEND,B'10000000'                                  0278 00999000
         BNZ   @RF00278                                            0278 01000000
*                             N=N+1;/* POINT TO CHAR AFTER VALUE     */ 01001000
         AL    N,@CF00042                                          0279 01002000
*                           ELSE    /* IF SECOND CHAR BAD            */ 01003000
*                             DLMERR=ON;/* REMEMBER                  */ 01004000
         B     @RC00278                                            0280 01005000
@RF00278 OI    DLMERR,B'01000000'                                  0280 01006000
*                         END;      /* END OF CODE - FIRST CHAR O.K. */ 01007000
*                       ELSE        /* IF FIRST CHAR BAD             */ 01008000
*                         DLMERR=ON;/* REMEMBER                      */ 01009000
         B     @RC00271                                            0282 01010000
@RF00271 OI    DLMERR,B'01000000'                                  0282 01011000
*                     END;          /* END CODE FOR NON-SPECIAL DLM= */ 01012000
*                                                                  0283 01013000
@RC00271 DS    0H                                                  0284 01014000
*                   /*************************************************/ 01015000
*                   /*                                               */ 01016000
*                   /* IF NO ERRORS, SAVE DLM= VALUE                 */ 01017000
*                   /*                                               */ 01018000
*                   /*************************************************/ 01019000
*                                                                  0284 01020000
*                   IF DLMERR=OFF THEN/* PROCEED IF NO ERROR FOUND 0284 01021000
*                                      YET                           */ 01022000
@RC00237 TM    DLMERR,B'01000000'                                  0284 01023000
         BNZ   @RF00284                                            0284 01024000
*                     DO;           /* - CHECK FOR DLM= KWD LEN O.K. */ 01025000
*                       IF CARD(N)=BLANK|CARD(N)=COMMA THEN/* IF HAVE   01026000
*                                      VALID DLM= KEYWORD (AND VALUE)*/ 01027000
         LR    @10,CARDPTR                                         0286 01028000
         ALR   @10,N                                               0286 01029000
         BCTR  @10,0                                               0286 01030000
         CLI   CARD(@10),C' '                                      0286 01031000
         BE    @RT00286                                            0286 01032000
         LR    @10,CARDPTR                                         0286 01033000
         ALR   @10,N                                               0286 01034000
         BCTR  @10,0                                               0286 01035000
         CLI   CARD(@10),C','                                      0286 01036000
         BNE   @RF00286                                            0286 01037000
@RT00286 DS    0H                                                  0287 01038000
*                         DO;                                      0287 01039000
*                           HTDLMSW=ON;/* INDICATE SEARCH FOR DELIM     01040000
*                                      NOW                           */ 01041000
         OI    HTDLMSW(HTPTR),B'10000000'                          0288 01042000
*                           HTDLM=CARD(D:D+1);/* SAVE DLM= VALUE     */ 01043000
         LR    @10,CARDPTR                                         0289 01044000
         ALR   @10,D                                               0289 01045000
         BCTR  @10,0                                               0289 01046000
         MVC   HTDLM(2,HTPTR),CARD(@10)                            0289 01047000
*                         END;                                     0290 01048000
*                     END;                                         0291 01049000
@RF00286 DS    0H                                                  0292 01050000
*                 END DLMCODE;      /* END CHECKING OF DLM= VALUE    */ 01051000
@RF00284 DS    0H                                                  0293 01052000
*           END;                    /* END SCAN FOR DLM= KEYWORD     */ 01053000
@RF00233 DS    0H                                                  0293 01054000
@RF00232 AL    S,@CF00042                                          0293 01055000
@DE00229 CR    S,A                                                 0293 01056000
         BNH   @DL00229                                            0293 01057000
@DC00229 DS    0H                                                  0294 01058000
*         END CHKDLM;               /* END SEARCH FOR DLM= KEYWORD   */ 01059000
*     END DDCODE;                                                  0295 01060000
@RF00226 DS    0H                                                  0296 01061000
*                                                                  0296 01062000
*   /*****************************************************************/ 01063000
*   /*                                                               */ 01064000
*   /* END THE SCAN OF // CARD - DO SPECIAL PROCESSING IF            */ 01065000
*   /* CONTINUATION                                                  */ 01066000
*   /*                                                               */ 01067000
*   /*****************************************************************/ 01068000
*                                                                  0296 01069000
*SCANEXIT:                                                         0296 01070000
*   IF CARD(72)^=' ' THEN                                          0296 01071000
@RF00214 DS    0H                                                  0296 01072000
SCANEXIT CLI   CARD+71(CARDPTR),C' '                               0296 01073000
         BE    @RF00296                                            0296 01074000
*     WCONEX=ON;                    /* NEXT CARD SHOULD CONTINUE THIS   01075000
*                                      CARD                          */ 01076000
         OI    WCONEX,B'10000000'                                  0297 01077000
*   IF CCOMCON='1'B THEN            /* PRIOR STMT SAYS THIS ONE    0298 01078000
*                                      SHOULD BECOME A COMMENT AND A    01079000
*                                      CONTINUATION CHECKED FOR -- 0298 01080000
*                                      THIS SITUATION ARISES WHEN  0298 01081000
*                                      PROMPTJOB HAS NO ROOM TO    0298 01082000
*                                      CHANGE A JOB CARD -- IT CALLS    01083000
*                                      GENJOB AND THEN TURNS THE   0298 01084000
*                                      ORIGINAL JOB CARD INTO A    0298 01085000
*                                      COMMENT, SO ALL FURTHER     0298 01086000
*                                      CONTINUATIONS OF THE ORIGINAL    01087000
*                                      MUST ALSO BECOME COMMENT CARDS   01088000
*                                      (COMMENTS CANNOT BY THEMSELVES   01089000
*                                      BE CONTINUED)                 */ 01090000
@RF00296 TM    CCOMCON(HTPTR),B'00000100'                          0298 01091000
         BNO   @RF00298                                            0298 01092000
*     DO;                                                          0299 01093000
*       CARD(3:4)='* ';                                            0300 01094000
         MVC   CARD+2(2,CARDPTR),@CC00270                          0300 01095000
*       WCOMMENT='1'B;                                             0301 01096000
*       WJOB='0'B;                                                 0302 01097000
         OI    WCOMMENT,B'00000001'                                0302 01098000
         NI    WJOB,B'11101111'                                    0302 01099000
*       IF WCONEX='1'B THEN         /* IF THIS CARD IS CONTINUED     */ 01100000
         TM    WCONEX,B'10000000'                                  0303 01101000
         BNO   @RF00303                                            0303 01102000
*         WCOMCON='1'B;             /* MAKE NEXT CARD A COMMENT, TOO */ 01103000
         OI    WCOMCON,B'00000100'                                 0304 01104000
*     END;                                                         0305 01105000
*                                                                  0305 01106000
@RF00303 DS    0H                                                  0306 01107000
*   /*****************************************************************/ 01108000
*   /*                                                               */ 01109000
*   /* UPDATE HISTORY TABLE FOR THIS CARD, THEN RETURN TO CALLER     */ 01110000
*   /*                                                               */ 01111000
*   /*****************************************************************/ 01112000
*                                                                  0306 01113000
*UPDATE:                            /* CURR BECOMES PRIOR AND WORK 0306 01114000
*                                      BECOMES CURR                  */ 01115000
*   PRIORJCL=CURRJCL;                                              0306 01116000
@RF00298 DS    0H                                                  0306 01117000
UPDATE   MVC   PRIORJCL(4,HTPTR),CURRJCL(HTPTR)                    0306 01118000
*   CURRJCL=WORK;                                                  0307 01119000
         MVC   CURRJCL(4,HTPTR),WORK                               0307 01120000
*   INIDENT='0'B;                   /* INDICATE EXITED FROM THIS   0308 01121000
*                                      MODULE                        */ 01122000
         NI    INIDENT(HTPTR),B'10111111'                          0308 01123000
*                                                                  0309 01124000
*/********************************************************************/ 01125000
*/* INTERNAL PROCEDURES USED TO SCAN CARD                            */ 01126000
*/********************************************************************/ 01127000
*                                                                  0309 01128000
*SKIPTOQ:                                                          0309 01129000
*                                                                  0309 01130000
*   /*****************************************************************/ 01131000
*   /*                                                               */ 01132000
*   /* SKIPTOQ -- PROC TO SKIP K (COLUMN POINTER) TO A QUOTE         */ 01133000
*   /*                                                               */ 01134000
*   /*****************************************************************/ 01135000
*                                                                  0309 01136000
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0309 01137000
@EL00001 DS    0H                                                  0309 01138000
@EF00001 L     @00,@SIZDATD                                        0309 01139000
         LR    @01,@11                                             0309 01140000
         FREEMAIN R,LV=(0),A=(1)                                        01141000
@ER00001 LM    @14,@12,12(@13)                                     0309 01142000
         BR    @14                                                 0309 01143000
SKIPTOQ  DS    0H                                                  0310 01144000
*   IF K^=0 THEN                    /* DO THE SCAN IF NOT AT END OF     01145000
*                                      CARD                          */ 01146000
         LTR   K,K                                                 0310 01147000
         BZ    @RF00310                                            0310 01148000
*     DO;                                                          0311 01149000
*       DO K=K TO ENDCOL;           /* SCAN COLUMNS OF CARD          */ 01150000
         B     @DE00312                                            0312 01151000
@DL00312 DS    0H                                                  0313 01152000
*         IF CARD(K)='''' THEN      /* CHECK FOR QUOTE               */ 01153000
         LR    @10,CARDPTR                                         0313 01154000
         ALR   @10,K                                               0313 01155000
         BCTR  @10,0                                               0313 01156000
         CLI   CARD(@10),C''''                                     0313 01157000
         BE    @RT00313                                            0313 01158000
*           GO TO ENDSKIPQ;         /* SCAN SUCCESSFUL               */ 01159000
*       END;                        /* END OF SCAN THRU COLUMNS      */ 01160000
         AL    K,@CF00042                                          0315 01161000
@DE00312 CR    K,ENDCOL                                            0315 01162000
         BNH   @DL00312                                            0315 01163000
*       K=0;                        /* SCAN FAILED                   */ 01164000
         SLR   K,K                                                 0316 01165000
*     END;                                                         0317 01166000
*ENDSKIPQ:                          /* NORMAL EXIT FROM THIS PROC    */ 01167000
*   END SKIPTOQ;                                                   0318 01168000
*                                                                  0318 01169000
@EL00002 DS    0H                                                  0318 01170000
@EF00002 DS    0H                                                  0318 01171000
@ER00002 BR    @14                                                 0318 01172000
*   /*****************************************************************/ 01173000
*   /*                                                               */ 01174000
*   /* SKIPTO -- PROC TO SKIP K TO NEXT BLANK                        */ 01175000
*   /*                                                               */ 01176000
*   /*****************************************************************/ 01177000
*                                                                  0319 01178000
*SKIPTO:                                                           0319 01179000
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0319 01180000
SKIPTO   DS    0H                                                  0320 01181000
*   IF K^=0 THEN                    /* DO THE SCAN IF NOT AT END OF     01182000
*                                      CARD                          */ 01183000
         LTR   K,K                                                 0320 01184000
         BZ    @RF00320                                            0320 01185000
*     DO;                                                          0321 01186000
*       DO K=K TO ENDCOL;           /* SCAN THRU COLUMNS OF CARD     */ 01187000
         B     @DE00322                                            0322 01188000
@DL00322 DS    0H                                                  0323 01189000
*         IF CARD(K)=' ' THEN       /* CHECK FOR BLANK               */ 01190000
         LR    @10,CARDPTR                                         0323 01191000
         ALR   @10,K                                               0323 01192000
         BCTR  @10,0                                               0323 01193000
         CLI   CARD(@10),C' '                                      0323 01194000
         BE    @RT00323                                            0323 01195000
*           GO TO ENDTO;            /* SCAN SUCCESSFUL               */ 01196000
*       END;                                                       0325 01197000
         AL    K,@CF00042                                          0325 01198000
@DE00322 CR    K,ENDCOL                                            0325 01199000
         BNH   @DL00322                                            0325 01200000
*       K=0;                        /* SCAN FAILED                   */ 01201000
         SLR   K,K                                                 0326 01202000
*     END;                                                         0327 01203000
*ENDTO:                             /* NORMAL EXIT FROM THIS PROC    */ 01204000
*   END SKIPTO;                                                    0328 01205000
@EL00003 DS    0H                                                  0328 01206000
@EF00003 DS    0H                                                  0328 01207000
@ER00003 BR    @14                                                 0328 01208000
*                                                                  0329 01209000
*   /*****************************************************************/ 01210000
*   /*                                                               */ 01211000
*   /* SKIPOVER -- PROC TO SKIP K OVER BLANKS TO NEXT NON-BLANK      */ 01212000
*   /*                                                               */ 01213000
*   /*****************************************************************/ 01214000
*                                                                  0329 01215000
*SKIPOVER:                                                         0329 01216000
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0329 01217000
SKIPOVER DS    0H                                                  0330 01218000
*   IF K^=0 THEN                    /* DO THE SCAN IF NOT AT END OF     01219000
*                                      CARD                          */ 01220000
         LTR   K,K                                                 0330 01221000
         BZ    @RF00330                                            0330 01222000
*     DO;                                                          0331 01223000
*       DO K=K TO ENDCOL;           /* SCAN THRU COLUMNS OF CARD     */ 01224000
         B     @DE00332                                            0332 01225000
@DL00332 DS    0H                                                  0333 01226000
*         IF CARD(K)^=' ' THEN      /* CHECK FOR NON-BLANK CHAR      */ 01227000
         LR    @10,CARDPTR                                         0333 01228000
         ALR   @10,K                                               0333 01229000
         BCTR  @10,0                                               0333 01230000
         CLI   CARD(@10),C' '                                      0333 01231000
         BNE   @RT00333                                            0333 01232000
*           GO TO ENDOVER;          /* SCAN SUCCESSFUL               */ 01233000
*       END;                                                       0335 01234000
         AL    K,@CF00042                                          0335 01235000
@DE00332 CR    K,ENDCOL                                            0335 01236000
         BNH   @DL00332                                            0335 01237000
*       K=0;                        /* SCAN FAILED                   */ 01238000
         SLR   K,K                                                 0336 01239000
*     END;                                                         0337 01240000
*ENDOVER:                           /* NORMAL EXIT FROM THIS PROC    */ 01241000
*   END SKIPOVER;                                                  0338 01242000
@EL00004 DS    0H                                                  0338 01243000
@EF00004 DS    0H                                                  0338 01244000
@ER00004 BR    @14                                                 0338 01245000
*   END IKJEFF07                                                   0339 01246000
*                                                                  0339 01247000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01248000
*/*%INCLUDE SYSUT5  (FF07PRLG)                                       */ 01249000
*/*%INCLUDE SYSUT5  (FF07DCLS)                                       */ 01250000
*/*%INCLUDE SYSLIB  (IKJEFFHT)                                       */ 01251000
*/*%INCLUDE SYSUT5  (FF07SDLM)                                       */ 01252000
*                                                                  0339 01253000
*       ;                                                          0339 01254000
@DATA    DS    0H                                                       01255000
@SC00299 CLC   CARD(0,@01),@CC00238                                     01256000
@SM00301 MVC   NAME(0),CARD+2(CARDPTR)                                  01257000
@SC00303 CLC   CARD(0,@01),@CC00244                                     01258000
@SC00305 CLC   CARD(0,@01),@CC00245                                     01259000
@SC00308 CLC   CARD(0,@05),@CC00259                                     01260000
@SC00310 CLC   CARD(0,@09),@CC00262                                     01261000
@DATD    DSECT                                                          01262000
         DS    0F                                                       01263000
@PC00001 DS    3F                                                       01264000
IKJEFF07 CSECT                                                          01265000
         DS    0F                                                       01266000
@CF00042 DC    F'1'                                                     01267000
@CF00106 DC    F'3'                                                     01268000
@CF00240 DC    F'10'                                                    01269000
@CF00249 DC    F'16'                                                    01270000
@DATD    DSECT                                                          01271000
         DS    0D                                                       01272000
NAME     DS    CL8                                                      01273000
WORK     DS    CL4                                                      01274000
         ORG   WORK                                                     01275000
WVERB    DS    CL2                                                      01276000
         ORG   WVERB                                                    01277000
WDELIM   DS    BL1                                                      01278000
WDATA    EQU   WVERB+0                                                  01279000
WNULL    EQU   WVERB+0                                                  01280000
WJOB     EQU   WVERB+0                                                  01281000
WEXEC    EQU   WVERB+0                                                  01282000
WDD      EQU   WVERB+0                                                  01283000
WCOMMAND EQU   WVERB+0                                                  01284000
WCOMMENT EQU   WVERB+0                                                  01285000
WJES     DS    BL1                                                      01286000
@NM00001 EQU   WVERB+1                                                  01287000
         ORG   WORK+2                                                   01288000
WDTYPE   DS    CL1                                                      01289000
         ORG   WDTYPE                                                   01290000
WDDAST   DS    BL1                                                      01291000
WDDDATA  EQU   WDTYPE+0                                                 01292000
         ORG   WORK+3                                                   01293000
WMISC    DS    CL1                                                      01294000
         ORG   WMISC                                                    01295000
WCONEX   DS    BL1                                                      01296000
WOPCONEX EQU   WMISC+0                                                  01297000
WCONERR  EQU   WMISC+0                                                  01298000
WNAME    EQU   WMISC+0                                                  01299000
WVERBCOP EQU   WMISC+0                                                  01300000
WCOMCON  EQU   WMISC+0                                                  01301000
WNOTHING EQU   WMISC+0                                                  01302000
WDLMFND  EQU   WMISC+0                                                  01303000
         ORG   WORK+4                                                   01304000
DLMWORK  DS    CL1                                                      01305000
         ORG   DLMWORK                                                  01306000
DLMEND   DS    BL1                                                      01307000
DLMERR   EQU   DLMWORK+0                                                01308000
DLMQUOTE EQU   DLMWORK+0                                                01309000
DLMAMP   EQU   DLMWORK+0                                                01310000
         ORG   DLMWORK+1                                                01311000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01312000
@ENDDATD EQU   *                                                        01313000
IKJEFF07 CSECT                                                          01314000
         DS    0F                                                       01315000
@SIZDATD DC    AL1(0)                                                   01316000
         DC    AL3(@ENDDATD-@DATD)                                      01317000
         DS    0D                                                       01318000
@CC00244 DC    C'EXEC '                                                 01319000
@CC00238 DC    C'JOB '                                                  01320000
@CC00259 DC    C'DATA'                                                  01321000
@CC00262 DC    C'DLM='                                                  01322000
@CC00245 DC    C'DD '                                                   01323000
@CC00225 DC    C'//'                                                    01324000
@CC00227 DC    C'/*'                                                    01325000
@CC00270 DC    C'* '                                                    01326000
DLMVALCH DC    CL39'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789#$@'            01327000
         ORG   DLMVALCH                                                 01328000
DLMCH    DS    39CL1                                                    01329000
         ORG   DLMVALCH+39                                              01330000
PATCH    DC    17CL3'ZAP'                                               01331000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01332000
@01      EQU   01                                                       01333000
@02      EQU   02                                                       01334000
@03      EQU   03                                                       01335000
@04      EQU   04                                                       01336000
@05      EQU   05                                                       01337000
@06      EQU   06                                                       01338000
@07      EQU   07                                                       01339000
@08      EQU   08                                                       01340000
@09      EQU   09                                                       01341000
@10      EQU   10                                                       01342000
@11      EQU   11                                                       01343000
@12      EQU   12                                                       01344000
@13      EQU   13                                                       01345000
@14      EQU   14                                                       01346000
@15      EQU   15                                                       01347000
HTPTR    EQU   @04                                                      01348000
I        EQU   @05                                                      01349000
PREVCOL  EQU   @05                                                      01350000
N        EQU   @06                                                      01351000
D        EQU   @02                                                      01352000
S        EQU   @08                                                      01353000
A        EQU   @07                                                      01354000
K        EQU   @02                                                      01355000
L        EQU   @09                                                      01356000
Q        EQU   @07                                                      01357000
ENDCOL   EQU   @05                                                      01358000
CARDPTR  EQU   @03                                                      01359000
CARD     EQU   0                                                        01360000
HISTORY  EQU   0                                                        01361000
WHATMOD  EQU   HISTORY+12                                               01362000
INIDENT  EQU   WHATMOD+3                                                01363000
JCLSWITS EQU   HISTORY+16                                               01364000
PRIORJCL EQU   JCLSWITS                                                 01365000
PVERB    EQU   PRIORJCL                                                 01366000
PDTYPE   EQU   PRIORJCL+2                                               01367000
PMISC    EQU   PRIORJCL+3                                               01368000
CURRJCL  EQU   JCLSWITS+4                                               01369000
CVERB    EQU   CURRJCL                                                  01370000
CDATA    EQU   CVERB                                                    01371000
CCOMMENT EQU   CVERB                                                    01372000
CDTYPE   EQU   CURRJCL+2                                                01373000
CDDAST   EQU   CDTYPE                                                   01374000
CDDDATA  EQU   CDTYPE                                                   01375000
CMISC    EQU   CURRJCL+3                                                01376000
CCONEX   EQU   CMISC                                                    01377000
COPCONEX EQU   CMISC                                                    01378000
CCOMCON  EQU   CMISC                                                    01379000
STATICSW EQU   HISTORY+24                                               01380000
GENL     EQU   STATICSW                                                 01381000
TAKEXITS EQU   STATICSW+1                                               01382000
OPOFF    EQU   STATICSW+2                                               01383000
CODEFLD  EQU   STATICSW+3                                               01384000
DLMONJCL EQU   HISTORY+32                                               01385000
HTDLM    EQU   DLMONJCL                                                 01386000
HTSWITCH EQU   HISTORY+34                                               01387000
HTDLMSW  EQU   HTSWITCH                                                 01388000
HTACCNTP EQU   HISTORY+40                                               01389000
HTACCNTI EQU   0                                                        01390000
HIST     EQU   0                                                        01391000
STMTPTR  EQU   0                                                        01392000
JOBNAME  EQU   0                                                        01393000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01394000
@NM00011 EQU   HISTORY+50                                               01395000
HTACNTC2 EQU   HISTORY+48                                               01396000
HTACNTC1 EQU   HISTORY+46                                               01397000
HTACCNTL EQU   HISTORY+44                                               01398000
@NM00010 EQU   HISTORY+36                                               01399000
@NM00009 EQU   HISTORY+35                                               01400000
@NM00008 EQU   HTSWITCH                                                 01401000
@NM00007 EQU   HISTORY+28                                               01402000
HTCODE   EQU   CODEFLD                                                  01403000
@NM00006 EQU   TAKEXITS                                                 01404000
COMNTX   EQU   TAKEXITS                                                 01405000
JESX     EQU   TAKEXITS                                                 01406000
NULLX    EQU   TAKEXITS                                                 01407000
CMDX     EQU   TAKEXITS                                                 01408000
DDX      EQU   TAKEXITS                                                 01409000
EXECX    EQU   TAKEXITS                                                 01410000
JOBX     EQU   TAKEXITS                                                 01411000
NONOTIFY EQU   GENL                                                     01412000
FIRST    EQU   GENL                                                     01413000
FLUSH    EQU   GENL                                                     01414000
QUIT     EQU   GENL                                                     01415000
CDLMFND  EQU   CMISC                                                    01416000
CNOTHING EQU   CMISC                                                    01417000
CVERBCOP EQU   CMISC                                                    01418000
CNAME    EQU   CMISC                                                    01419000
CCONERR  EQU   CMISC                                                    01420000
@NM00005 EQU   CVERB+1                                                  01421000
@NM00004 EQU   CVERB+1                                                  01422000
CJES     EQU   CVERB+1                                                  01423000
CCOMMAND EQU   CVERB                                                    01424000
CDD      EQU   CVERB                                                    01425000
CEXEC    EQU   CVERB                                                    01426000
CJOB     EQU   CVERB                                                    01427000
CNULL    EQU   CVERB                                                    01428000
CDELIM   EQU   CVERB                                                    01429000
PDLMFND  EQU   PMISC                                                    01430000
PNOTHING EQU   PMISC                                                    01431000
PCOMCON  EQU   PMISC                                                    01432000
PVERBCOP EQU   PMISC                                                    01433000
PNAME    EQU   PMISC                                                    01434000
PCONERR  EQU   PMISC                                                    01435000
POPCONEX EQU   PMISC                                                    01436000
PCONEX   EQU   PMISC                                                    01437000
PDDDATA  EQU   PDTYPE                                                   01438000
PDDAST   EQU   PDTYPE                                                   01439000
@NM00003 EQU   PVERB+1                                                  01440000
@NM00002 EQU   PVERB+1                                                  01441000
PJES     EQU   PVERB+1                                                  01442000
PCOMMENT EQU   PVERB                                                    01443000
PCOMMAND EQU   PVERB                                                    01444000
PDD      EQU   PVERB                                                    01445000
PEXEC    EQU   PVERB                                                    01446000
PJOB     EQU   PVERB                                                    01447000
PNULL    EQU   PVERB                                                    01448000
PDATA    EQU   PVERB                                                    01449000
PDELIM   EQU   PVERB                                                    01450000
INOINIT  EQU   WHATMOD+3                                                01451000
INCOMPIN EQU   WHATMOD+3                                                01452000
INMSG    EQU   WHATMOD+3                                                01453000
INDAIRIN EQU   WHATMOD+3                                                01454000
INWRMGR  EQU   WHATMOD+3                                                01455000
INEXIT   EQU   WHATMOD+3                                                01456000
INREAD   EQU   WHATMOD+3                                                01457000
INGEN    EQU   WHATMOD+2                                                01458000
INPROMPT EQU   WHATMOD+1                                                01459000
INCONTRL EQU   WHATMOD                                                  01460000
SUBTAB   EQU   HISTORY                                                  01461000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01462000
@RT00041 EQU   JCL                                                      01463000
@RT00051 EQU   SETDATA                                                  01464000
@RC00045 EQU   CHKCON                                                   01465000
@RF00043 EQU   @RC00039                                                 01466000
@RT00060 EQU   JCL                                                      01467000
@RF00057 EQU   SETDATA                                                  01468000
@RT00070 EQU   SETDATA                                                  01469000
@RT00072 EQU   SETDATA                                                  01470000
@RF00078 EQU   UPDATE                                                   01471000
@RT00092 EQU   SETDATA                                                  01472000
@RF00135 EQU   SCANEXIT                                                 01473000
@RT00145 EQU   SCANOP                                                   01474000
@RT00159 EQU   CHKEXEC                                                  01475000
@RT00180 EQU   SCANEXIT                                                 01476000
@RT00183 EQU   SCANEXIT                                                 01477000
@RT00199 EQU   NOQ                                                      01478000
@RT00201 EQU   NOQ                                                      01479000
@RT00205 EQU   NOQ                                                      01480000
@RF00247 EQU   @RC00237                                                 01481000
@RF00257 EQU   @RC00237                                                 01482000
@RC00260 EQU   @RC00237                                                 01483000
@RC00278 EQU   @RC00271                                                 01484000
@RF00310 EQU   @EL00002                                                 01485000
ENDSKIPQ EQU   @EL00002                                                 01486000
@RF00320 EQU   @EL00003                                                 01487000
ENDTO    EQU   @EL00003                                                 01488000
@RF00330 EQU   @EL00004                                                 01489000
ENDOVER  EQU   @EL00004                                                 01490000
@PB00004 EQU   @EL00001                                                 01491000
@RT00313 EQU   ENDSKIPQ                                                 01492000
@RT00323 EQU   ENDTO                                                    01493000
@PB00003 EQU   @PB00004                                                 01494000
@RT00333 EQU   ENDOVER                                                  01495000
@PB00002 EQU   @PB00003                                                 01496000
@ENDDATA EQU   *                                                        01497000
         END   IKJEFF07,(C'PLS1749',0701,75344)                         01498000
