         TITLE 'IKJEFF08 - GEN JOB CARD ROUTINE                        *00001000
                       '                                                00002000
IKJEFF08 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFF08  73.293'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(20),0(@01)                                 0001 00022000
DUMMYLBL DS    0H                                                  0003 00023000
*                                                                  0033 00024000
*   /*****************************************************************/ 00025000
*   /*                                                               */ 00026000
*   /* END OF IKJEFFMT MAPPING MACRO                                 */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                                  0034 00030000
*                                                                  0034 00031000
*   /*****************************************************************/ 00032000
*   /*                                                               */ 00033000
*   /* INITIALIZATION BEFORE GENERATE JOB STATEMENT                  */ 00034000
*   /*                                                               */ 00035000
*   /*****************************************************************/ 00036000
*                                                                  0034 00037000
*   HTPTR=ADDR(HIST);               /* USE LOCAL POINTER TO HISTORY     00038000
*                                      TABLE                         */ 00039000
         L     HTPTR,@PC00001                                      0034 00040000
*   INGEN=INGEN+1;                  /* INDICATE IN IKJEFF08          */ 00041000
         LA    @10,1                                               0035 00042000
         SLR   @04,@04                                             0035 00043000
         IC    @04,INGEN(,HTPTR)                                   0035 00044000
         AR    @10,@04                                             0035 00045000
         STC   @10,INGEN(,HTPTR)                                   0035 00046000
*   HOLD=STMTPTR;                   /* HOLD THE POINTER TO THE     0036 00047000
*                                      ORIGINAL INPUT CARD TO ONE  0036 00048000
*                                      SIDE WHILE THE GENERATED CARD    00049000
*                                      IS BUILT AND PROCESSED        */ 00050000
         L     @10,@PC00001+4                                      0036 00051000
         L     HOLD,STMTPTR(,@10)                                  0036 00052000
*   PASS=PCONTAB;                   /* SAVE CONTROL TABLE POINTER TO    00053000
*                                      PASS TO IKJEFF06              */ 00054000
         L     @10,@PC00001+12                                     0037 00055000
         L     @10,PCONTAB(,@10)                                   0037 00056000
         ST    @10,PASS                                            0037 00057000
*   CURRJCL=PRIORJCL;                                              0038 00058000
         MVC   CURRJCL(4,HTPTR),PRIORJCL(HTPTR)                    0038 00059000
*   CT=7;                           /* SET THE COUNTER FOR 7 LOOPS TO   00060000
*                                      CLEAR AND GENERATE A JOB CARD    00061000
*                                      AND CONTINUATIONS -- NOTE THAT   00062000
*                                      6 CARDS MAY BE BUILT; THEN THE   00063000
*                                      ORIGINAL NON-JOB STATEMENT IS    00064000
*                                      PROCESSED                     */ 00065000
         LA    CT,7                                                0039 00066000
*   GO TO BLANK;                    /* INITIALIZE THE FIRST CARD     */ 00067000
*                                                                  0040 00068000
         B     BLANK                                               0040 00069000
*   /*****************************************************************/ 00070000
*   /*                                                               */ 00071000
*   /* LOOP TO GENERATE JOB CARD AND CONTINUATIONS                   */ 00072000
*   /*                                                               */ 00073000
*   /*****************************************************************/ 00074000
*                                                                  0041 00075000
*COUNT:                                                            0041 00076000
*   IF CT=0 THEN                    /* IF THE LOOP COUNTER IS DOWN TO   00077000
*                                      ZERO, THEN RE-PROCESS THE   0041 00078000
*                                      ORIGINAL NON-JOB            0041 00079000
*                                      STATEMENT--HAVE ALREADY     0041 00080000
*                                      HANDLED JOB CARDS IN THE LOOP */ 00081000
COUNT    LTR   CT,CT                                               0041 00082000
         BNZ   @RF00041                                            0041 00083000
*     DO;                                                          0042 00084000
*       STMTPTR=HOLD;               /* RESTORE THE ORIGINAL CARD     */ 00085000
         L     @10,@PC00001+4                                      0043 00086000
         ST    HOLD,STMTPTR(,@10)                                  0043 00087000
*       CALL IKJEFF06(PASS);        /* IKJEFF06 IS JCL CARD        0044 00088000
*                                      CONTROLLER                    */ 00089000
         LA    @10,PASS                                            0044 00090000
         ST    @10,@AL00001                                        0044 00091000
         L     @15,@CV00065                                        0044 00092000
         LA    @01,@AL00001                                        0044 00093000
         BALR  @14,@15                                             0044 00094000
*       INGEN=INGEN-1;                                             0045 00095000
         SLR   @10,@10                                             0045 00096000
         IC    @10,INGEN(,HTPTR)                                   0045 00097000
         BCTR  @10,0                                               0045 00098000
         STC   @10,INGEN(,HTPTR)                                   0045 00099000
*       RETURN;                     /* RETURN TO WHOEVER CALLED '08  */ 00100000
@EL00001 L     @13,4(,@13)                                         0046 00101000
@EF00001 L     @00,@SIZDATD                                        0046 00102000
         LR    @01,@11                                             0046 00103000
         FREEMAIN R,LV=(0),A=(1)                                        00104000
@ER00001 LM    @14,@12,12(@13)                                     0046 00105000
         BR    @14                                                 0046 00106000
*     END;                                                         0047 00107000
*                                                                  0048 00108000
*   /*****************************************************************/ 00109000
*   /*                                                               */ 00110000
*   /* FIRST CARD HAS JOBNAME AND ACCOUNTING INFORMATION             */ 00111000
*   /*                                                               */ 00112000
*   /*****************************************************************/ 00113000
*                                                                  0048 00114000
*   IF CT=6 THEN                                                   0048 00115000
@RF00041 CH    CT,@CH00122                                         0048 00116000
         BNE   @RF00048                                            0048 00117000
*     DO;                           /* PREPARE FOR THE FIRST CARD -- */ 00118000
*       CARD(3:10)=USERID;          /* JOBNAME=USERID                */ 00119000
         L     @10,@PC00001+8                                      0050 00120000
         MVC   CARD+2(8),USERID(@10)                               0050 00121000
*       CARD(13:15)='JOB';          /* TWO BLANKS BEFORE 'JOB'       */ 00122000
         MVC   CARD+12(3),@CC00257                                 0051 00123000
*       IF HTACCNTL^=0 THEN         /* INSERT USER'S ACCOUNTING    0052 00124000
*                                      INFORMATION IF HAVE ANY       */ 00125000
         SLR   @10,@10                                             0052 00126000
         LH    @04,HTACCNTL(,HTPTR)                                0052 00127000
         CR    @04,@10                                             0052 00128000
         BE    @RF00052                                            0052 00129000
*         DO;                                                      0053 00130000
*           IF HTACNTC1=0 THEN      /* SIMPLE CASE IF ALL THE ACCOUNT   00131000
*                                      INFO FITS ON ONE CARD         */ 00132000
         CH    @10,HTACNTC1(,HTPTR)                                0054 00133000
         BNE   @RF00054                                            0054 00134000
*             KOL=HTACCNTL;         /* GET LENGTH OF INFO            */ 00135000
         ST    @04,KOL                                             0055 00136000
*           ELSE                    /* ACCOUNTING INFO WON'T ALL FIT    00137000
*                                      ON THE FIRST CARD             */ 00138000
*             KOL=HTACNTC1;         /* FILL CARD (EXCEPT COMMA)      */ 00139000
         B     @RC00054                                            0056 00140000
@RF00054 LH    @10,HTACNTC1(,HTPTR)                                0056 00141000
         ST    @10,KOL                                             0056 00142000
*           IF KOL>HTC1MAX THEN     /* ERROR EXIT IF ACCOUNT INFO  0057 00143000
*                                      WON'T FIT ON GENERATED JOB  0057 00144000
*                                      CARD                          */ 00145000
@RC00054 CLC   KOL(4),@CF00200                                     0057 00146000
         BNH   @RF00057                                            0057 00147000
*             DO;                                                  0058 00148000
*               CALL ACNTIBAD;      /* ISSUE ERROR MSG AND TURN QUIT    00149000
*                                      BIT ON                        */ 00150000
         BAL   @14,ACNTIBAD                                        0059 00151000
*               KOL=HTC1MAX;        /* CONTINUE UNTIL CALL IKJEFF06  */ 00152000
         MVC   KOL(4),@CF00200                                     0060 00153000
*             END;                                                 0061 00154000
*           KOL=KOL+OPRNDCOL;       /* LAST COLUMN FOR MOVE =LENGTH +   00155000
*                                      (BEGINCOL-1)                  */ 00156000
@RF00057 LA    @10,16                                              0062 00157000
         A     @10,KOL                                             0062 00158000
         ST    @10,KOL                                             0062 00159000
*           CARD(17:KOL)=HTACCNTI;  /* PUT USER'S ACCOUNT INFORMATION   00160000
*                                      ON THE JOB CARD               */ 00161000
         SH    @10,@CH00060                                        0063 00162000
         L     @04,HTACCNTP(,HTPTR)                                0063 00163000
         EX    @10,@SM00287                                        0063 00164000
*         END;                      /* END OF INSERTING              */ 00165000
*       ELSE                        /* IF NO ACCOUNTING INFO         */ 00166000
*         KOL=OPRNDCOL;             /* WILL PUT COMMA IN 17          */ 00167000
         B     @RC00052                                            0065 00168000
@RF00052 MVC   KOL(4),@CF00069                                     0065 00169000
*     END;                                                         0066 00170000
*                                                                  0066 00171000
@RC00052 DS    0H                                                  0067 00172000
*   /*****************************************************************/ 00173000
*   /*                                                               */ 00174000
*   /* SECOND CARD HAS CONTINUATION OF ACCOUNTING INFORMATION        */ 00175000
*   /*                                                               */ 00176000
*   /*****************************************************************/ 00177000
*                                                                  0067 00178000
*   IF CT=5 THEN                                                   0067 00179000
@RF00048 CH    CT,@CH00259                                         0067 00180000
         BNE   @RF00067                                            0067 00181000
*     DO;                                                          0068 00182000
*       IF HTACNTC1=0 THEN          /* IF DON'T NEED TO CONTINUE   0069 00183000
*                                      ACCOUNTING INFO ONTO THIS CARD*/ 00184000
         SLR   @10,@10                                             0069 00185000
         CH    @10,HTACNTC1(,HTPTR)                                0069 00186000
         BE    @RT00069                                            0069 00187000
*         GO TO SKIP;               /* DON'T PUT OUT THIS CARD       */ 00188000
*       IF HTACNTC2=0 THEN          /* ACCOUNT INFO WILL FIT ON THIS    00189000
*                                      CARD                          */ 00190000
         CH    @10,HTACNTC2(,HTPTR)                                0071 00191000
         BNE   @RF00071                                            0071 00192000
*         KOL=HTACCNTL;             /* GET END COL OF INSERT         */ 00193000
         LH    @10,HTACCNTL(,HTPTR)                                0072 00194000
         ST    @10,KOL                                             0072 00195000
*       ELSE                        /* ACCOUNT INFO WILL BE CONTINUED*/ 00196000
*         KOL=HTACNTC2;             /* GET END COL OF INSERT SECTION */ 00197000
         B     @RC00071                                            0073 00198000
@RF00071 LH    @10,HTACNTC2(,HTPTR)                                0073 00199000
         ST    @10,KOL                                             0073 00200000
*       KOL=(KOL-HTACNTC1)+2;       /* LAST COLUMN FOR MOVE        0074 00201000
*                                      =LENGTH(COL-1) + (BEGINCOL-1) */ 00202000
@RC00071 L     @10,KOL                                             0074 00203000
         SH    @10,HTACNTC1(,HTPTR)                                0074 00204000
         AH    @10,@CH00110                                        0074 00205000
         ST    @10,KOL                                             0074 00206000
*       IF KOL>CARDMAX THEN         /* ERROR EXIT IF ACCOUNT INFO  0075 00207000
*                                      WON'T FIT ON JOB CARD         */ 00208000
         CH    @10,@CH00067                                        0075 00209000
         BNH   @RF00075                                            0075 00210000
*         DO;                                                      0076 00211000
*           CALL ACNTIBAD;          /* ISSUE ERROR MSG AND TURN QUIT    00212000
*                                      BIT ON                        */ 00213000
         BAL   @14,ACNTIBAD                                        0077 00214000
*           KOL=CARDMAX;            /* CONTINUE UNTIL CALL IKJEFF06  */ 00215000
         MVC   KOL(4),@CF00067                                     0078 00216000
*         END;                                                     0079 00217000
*       ACNTIPTR=ADDR(HTACCNTI)+HTACNTC1+1;/* POINTER TO FIRST COL OF   00218000
*                                      INSERT SECTION                */ 00219000
@RF00075 LH    ACNTIPTR,HTACNTC1(,HTPTR)                           0080 00220000
         A     ACNTIPTR,HTACCNTP(,HTPTR)                           0080 00221000
         AH    ACNTIPTR,@CH00106                                   0080 00222000
*       CARD(4:KOL)=ACNTINST;       /* PUT CONTINUATION OF ACCOUNTING   00223000
*                                      INFORMATION ON CARD (NOTE SKIP   00224000
*                                      OVER COMMA IN HTACCNTI)       */ 00225000
         L     @10,KOL                                             0081 00226000
         SH    @10,@CH00094                                        0081 00227000
         EX    @10,@SM00289                                        0081 00228000
*     END;                                                         0082 00229000
*                                                                  0082 00230000
*   /*****************************************************************/ 00231000
*   /*                                                               */ 00232000
*   /* THIRD CARD HAS CONTINUATION OF ACCOUNTING INFORMATION         */ 00233000
*   /*                                                               */ 00234000
*   /*****************************************************************/ 00235000
*                                                                  0083 00236000
*   IF CT=4 THEN                                                   0083 00237000
@RF00067 CH    CT,@CH00094                                         0083 00238000
         BNE   @RF00083                                            0083 00239000
*     DO;                                                          0084 00240000
*       IF HTACNTC2=0 THEN          /* IF DON'T NEED TO CONTINUE   0085 00241000
*                                      ACCOUNTING INFO ONTO THIS CARD*/ 00242000
         LH    @10,HTACNTC2(,HTPTR)                                0085 00243000
         LTR   @10,@10                                             0085 00244000
         BZ    @RT00085                                            0085 00245000
*         GO TO SKIP;               /* DON'T PUT OUT THIS CARD       */ 00246000
*       KOL=(HTACCNTL-HTACNTC2)+2;  /* LAST COLUMN FOR MOVE        0087 00247000
*                                      =LENGTH(COL-1) + (BEGINCOL-1) */ 00248000
         LCR   @10,@10                                             0087 00249000
         AH    @10,HTACCNTL(,HTPTR)                                0087 00250000
         AH    @10,@CH00110                                        0087 00251000
         ST    @10,KOL                                             0087 00252000
*       IF KOL>CARDMAX THEN         /* ERROR EXIT IF ACCOUNT INFO  0088 00253000
*                                      WON'T FIT ON JOB CARD         */ 00254000
         CH    @10,@CH00067                                        0088 00255000
         BNH   @RF00088                                            0088 00256000
*         DO;                                                      0089 00257000
*           CALL ACNTIBAD;          /* ISSUE ERROR MSG AND TURN QUIT    00258000
*                                      BIT ON                        */ 00259000
         BAL   @14,ACNTIBAD                                        0090 00260000
*           KOL=CARDMAX;            /* CONTINUE UNTIL CALL IKJEFF06  */ 00261000
         MVC   KOL(4),@CF00067                                     0091 00262000
*         END;                                                     0092 00263000
*       ACNTIPTR=ADDR(HTACCNTI)+HTACNTC2+1;/* POINTER TO FIRST COL OF   00264000
*                                      INSERT SECTION                */ 00265000
@RF00088 LH    ACNTIPTR,HTACNTC2(,HTPTR)                           0093 00266000
         A     ACNTIPTR,HTACCNTP(,HTPTR)                           0093 00267000
         AH    ACNTIPTR,@CH00106                                   0093 00268000
*       CARD(4:KOL)=ACNTINST;       /* PUT CONTINUATION OF ACCOUNTING   00269000
*                                      INFORMATION ON CARD (NOTE SKIP   00270000
*                                      OVER COMMA IN HTACCNTI)       */ 00271000
         L     @10,KOL                                             0094 00272000
         SH    @10,@CH00094                                        0094 00273000
         EX    @10,@SM00289                                        0094 00274000
*     END;                                                         0095 00275000
*                                                                  0096 00276000
*   /*****************************************************************/ 00277000
*   /*                                                               */ 00278000
*   /* NEXT CARD HAS PROGRAMMER NAME=USERID                          */ 00279000
*   /*                                                               */ 00280000
*   /*****************************************************************/ 00281000
*                                                                  0096 00282000
*   IF CT=3 THEN                                                   0096 00283000
@RF00083 CH    CT,@CH00061                                         0096 00284000
         BNE   @RF00096                                            0096 00285000
*     DO;                           /* FILL IN THIS CARD             */ 00286000
*       CARD(OPRNDCOL:23)=USERID;   /* USE USERID AS PGMR NAME       */ 00287000
         L     @10,@PC00001+8                                      0098 00288000
         MVC   CARD+15(8),USERID(@10)                              0098 00289000
*       CARD(31:53)='GENERATED JOB STATEMENT';                     0099 00290000
         MVC   CARD+30(23),@CC00263                                0099 00291000
*       KOL=OPRNDCOL;                                              0100 00292000
         MVC   KOL(4),@CF00069                                     0100 00293000
*     END;                                                         0101 00294000
*                                                                  0101 00295000
*   /*****************************************************************/ 00296000
*   /*                                                               */ 00297000
*   /* NEXT CARD HAS NOTIFY=USERID                                   */ 00298000
*   /*                                                               */ 00299000
*   /*****************************************************************/ 00300000
*                                                                  0102 00301000
*   IF CT=2 THEN                    /* FILL IN THIRD CARD            */ 00302000
@RF00096 CH    CT,@CH00110                                         0102 00303000
         BNE   @RF00102                                            0102 00304000
*     DO;                                                          0103 00305000
*       IF NONOTIFY='1'B THEN       /* ADD 'NOTIFY=' UNLESS NONO WAS    00306000
*                                      SPECIFIED -- IN THAT CASE THIS   00307000
*                                      CARD IS SIMPLY SKIPPED        */ 00308000
         TM    NONOTIFY(HTPTR),B'00010000'                         0104 00309000
         BO    @RT00104                                            0104 00310000
*         GO TO SKIP;               /* NONOTIFY WAS SPECIFIED        */ 00311000
*       CARD(OPRNDCOL:22)='NOTIFY=';                               0106 00312000
         MVC   CARD+15(7),@CC00267                                 0106 00313000
*       CARD(23:30)=USERID;                                        0107 00314000
         L     @10,@PC00001+8                                      0107 00315000
         MVC   CARD+22(8),USERID(@10)                              0107 00316000
*       KOL=23;                                                    0108 00317000
         MVC   KOL(4),@CF00261                                     0108 00318000
*     END;                                                         0109 00319000
*                                                                  0109 00320000
*   /*****************************************************************/ 00321000
*   /*                                                               */ 00322000
*   /* LAST CARD HAS MSGLEVEL=(1,1)                                  */ 00323000
*   /*                                                               */ 00324000
*   /*****************************************************************/ 00325000
*                                                                  0110 00326000
*   IF CT=1 THEN                                                   0110 00327000
@RF00102 CH    CT,@CH00106                                         0110 00328000
         BNE   @RF00110                                            0110 00329000
*     DO;                           /* PUT 'MSGLEVEL=' ON THE LAST 0111 00330000
*                                      CARD AND GO STRAIGHT TO HAVE     00331000
*                                      IT PROCESSED WITHOUT ADDING A    00332000
*                                      CONTINUATION COMMA            */ 00333000
*       CARD(OPRNDCOL:29)='MSGLEVEL=(1,1)';                        0112 00334000
         MVC   CARD+15(14),@CC00270                                0112 00335000
*       GO TO PROCESS;              /* WILL CALL PROCESSING RTN      */ 00336000
         B     PROCESS                                             0113 00337000
*     END;                                                         0114 00338000
*                                                                  0115 00339000
*   /*****************************************************************/ 00340000
*   /*                                                               */ 00341000
*   /* PUT COMMA AFTER OPERAND FIELD ON CARD                         */ 00342000
*   /*                                                               */ 00343000
*   /*****************************************************************/ 00344000
*                                                                  0115 00345000
*COMMA:                             /* PUT A COMMA AT THE NEXT BLANK    00346000
*                                      ON THE CARD BEING BUILT       */ 00347000
*   KOL=KOL+1;                                                     0115 00348000
@RF00110 DS    0H                                                  0115 00349000
COMMA    LA    @10,1                                               0115 00350000
         A     @10,KOL                                             0115 00351000
         ST    @10,KOL                                             0115 00352000
*   IF CARD(KOL)^=' ' THEN          /* IF NOT BLANK,                 */ 00353000
         LA    @04,CARD-1(@10)                                     0116 00354000
         CLI   0(@04),C' '                                         0116 00355000
         BNE   @RT00116                                            0116 00356000
*     GO TO COMMA;                  /* KEEP LOOKING                  */ 00357000
*   CARD(KOL)=',';                                                 0118 00358000
*                                                                  0118 00359000
         LA    @04,CARD-1(@10)                                     0118 00360000
         MVI   0(@04),C','                                         0118 00361000
*   /*****************************************************************/ 00362000
*   /*                                                               */ 00363000
*   /* CALL OTHER SUBMIT ROUTINE TO PROCESS THIS CARD                */ 00364000
*   /*                                                               */ 00365000
*   /*****************************************************************/ 00366000
*                                                                  0119 00367000
*PROCESS:                           /* NOW CALL THE CONTROL ROUTINE     00368000
*                                      TO PROCESS THE GENERATED CARD */ 00369000
*   STMTPTR=ADDR(CARD);                                            0119 00370000
PROCESS  L     @10,@PC00001+4                                      0119 00371000
         LA    @04,CARD                                            0119 00372000
         ST    @04,STMTPTR(,@10)                                   0119 00373000
*   CALL IKJEFF06(PASS);            /* 06 WILL GET CARD SUBMITTED    */ 00374000
*                                                                  0120 00375000
         LA    @10,PASS                                            0120 00376000
         ST    @10,@AL00001                                        0120 00377000
         L     @15,@CV00065                                        0120 00378000
         LA    @01,@AL00001                                        0120 00379000
         BALR  @14,@15                                             0120 00380000
*   /*****************************************************************/ 00381000
*   /*                                                               */ 00382000
*   /* SUBROUTINE TO BLANK AND INITIALIZE THE NEXT CARD              */ 00383000
*   /*                                                               */ 00384000
*   /*****************************************************************/ 00385000
*                                                                  0121 00386000
*BLANK:                             /* BLANK OUT THE WORKING AREA  0121 00387000
*                                      WHERE GENERATED CARDS ARE   0121 00388000
*                                      BUILT - ADD A SLASH-SLASH - 0121 00389000
*                                      AND DECREMENT THE LOOP COUNTER*/ 00390000
*   CARD=' ';                                                      0121 00391000
BLANK    MVI   CARD+1,C' '                                         0121 00392000
         MVC   CARD+2(78),CARD+1                                   0121 00393000
         MVI   CARD,C' '                                           0121 00394000
*   CARD(1:2)='//';                                                0122 00395000
*                                                                  0122 00396000
         MVC   CARD(2),@CC00279                                    0122 00397000
*   /*****************************************************************/ 00398000
*   /*                                                               */ 00399000
*   /* SUBROUTINE TO SKIP TO NEXT CARD IN LOOP                       */ 00400000
*   /*                                                               */ 00401000
*   /*****************************************************************/ 00402000
*                                                                  0123 00403000
*SKIP:                              /* SKIP OVER A CONTINUATION CARD */ 00404000
*   CT=CT-1;                                                       0123 00405000
SKIP     BCTR  CT,0                                                0123 00406000
*   GO TO COUNT;                    /* GO TO TOP OF LOOP TO GEN CARDS*/ 00407000
         B     COUNT                                               0124 00408000
*                                                                  0125 00409000
*   /*****************************************************************/ 00410000
*   /*                                                               */ 00411000
*   /* ACNTIBAD INTERNAL PROCEDURE - ISSUES ERROR MESSAGE AND TURNS  */ 00412000
*   /* SUBMIT QUIT SWITCH ON (TELLS IKJEFF06 NOT TO CONTINUE)        */ 00413000
*   /*                                                               */ 00414000
*   /*****************************************************************/ 00415000
*                                                                  0125 00416000
*ACNTIBAD:                                                         0125 00417000
*   PROC;                                                          0125 00418000
ACNTIBAD STM   @14,@12,@SA00002                                    0125 00419000
*   QUIT='1'B;                      /* TURN SUBMIT QUIT SWITCH ON    */ 00420000
         OI    QUIT(HTPTR),B'10000000'                             0126 00421000
*   MSGID='04B';                    /* 'ACCOUNT INFO WON'T FIT ON JOB   00422000
*                                      CARD' ERROR MESSAGE           */ 00423000
         L     @10,@PC00001+16                                     0127 00424000
         L     @10,MSGPTR(,@10)                                    0127 00425000
         MVI   MSGID+3(@10),C' '                                   0127 00426000
         MVC   MSGID(3,@10),@CC00284                               0127 00427000
*   L1=LENGTH(CTCMDNM);             /* INSERT COMMAND NAME INTO MSG  */ 00428000
         MVI   L1(@10),X'08'                                       0128 00429000
*   VAR1=ADDR(CTCMDNM);                                            0129 00430000
         L     @02,@PC00001+12                                     0129 00431000
         L     @02,CONLIST(,@02)                                   0129 00432000
         LA    @02,CTCMDNM(,@02)                                   0129 00433000
         STCM  @02,7,VAR1(@10)                                     0129 00434000
*   RFY                                                            0130 00435000
*     R1 RSTD;                                                     0130 00436000
*   R1=ADDR(MSGTABLE);              /* POINT TO IKJEFF02'S PARAM LIST*/ 00437000
         LR    R1,@10                                              0131 00438000
*   CALL IKJEFF02;                  /* CALL MESSAGE ISSUER MODULE    */ 00439000
         L     @15,MSGRTN(,@10)                                    0132 00440000
         BALR  @14,@15                                             0132 00441000
*   RFY                                                            0133 00442000
*     R1 UNRSTD;                                                   0133 00443000
*   END ACNTIBAD;                                                  0134 00444000
@EL00002 DS    0H                                                  0134 00445000
@EF00002 DS    0H                                                  0134 00446000
@ER00002 LM    @14,@12,@SA00002                                    0134 00447000
         BR    @14                                                 0134 00448000
*                                                                  0135 00449000
*/*IKJEFF08:    CHART                                                */ 00450000
*/*HEADER                                                          0135 00451000
*/*IKJEFF08                    GENJOB ROUTINE                        */ 00452000
*/*E ENTER FROM CALLER                                               */ 00453000
*/*P INCREMENT THE 'IN GENJOB' CTR                                   */ 00454000
*/*P HOLD ASIDE THE ORIGINAL INPUT CARD                              */ 00455000
*/*P SET CTR TO SEVEN                                                */ 00456000
*/*N THIS CTR COUNTS JCL CARDS--6 GENERATED,1 ORIGINAL CARD          */ 00457000
*/*BLANK: P INITIALIZE FIRST AND SECOND COLS OF NEWLY FORMED CARD WITH  00458000
*/* //                                                               */ 00459000
*/*P SUBTRACT ONE FROM CTR                                           */ 00460000
*/*COUNT: D (YES,,NO,%H2) IS THE CTR 0                               */ 00461000
*/*P REPROCESS THE ORIGINAL CARD                                     */ 00462000
*/*S IKJEFF06: CALL IKJEFF06 CONTROL RTN                             */ 00463000
*/*P DECREMENT THE 'IN GENJOB' CTR                                   */ 00464000
*/*R END IKJEFF08-RETURN TO CALLER                                   */ 00465000
*/*%H2: P IF THE CTR IS 6 PLACE USERID, VERB JOB, AND ACCOUNT INFO 0135 00466000
*/*ON CARD                                                           */ 00467000
*/*P IF THE CTR IS 3 PLACE USERID AS PGMR NAME                       */ 00468000
*/*D (YES,,NO,%D4) IS THE CTR 2                                      */ 00469000
*/*D (NO,,YES,BLANK) IS NONOTIFY SPECIFIED                           */ 00470000
*/*N WHEN NONOTIFY IS SPECIFIED, ONLY THREE NEW JCL CARDS ARE GENERATED 00471000
*/*                                                                  */ 00472000
*/*P (,%D4) PLACE NOTIFY ON THE CARD                                 */ 00473000
*/*%D4: D (YES,,NO,COMMA) IS THE CTR 1                               */ 00474000
*/*P PLACE MSGLEVEL=1 (1,1) ON LAST CARD                             */ 00475000
*/*PROCESS: S (,BLANK) IKJEFF06: CALL IKJEFF06 CONTROL RTN           */ 00476000
*/*COMMA: P (,PROCESS) FIND LAST NONBLANK CHAR & PLACE COMMA FOR CONT   00477000
*/*                                                                  */ 00478000
*/*IKJEFF08:  END                                                    */ 00479000
*                                                                  0135 00480000
*   END IKJEFF08                                                   0135 00481000
*                                                                  0135 00482000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00483000
*/*%INCLUDE SYSLIB  (IKJEFFCT)                                       */ 00484000
*/*%INCLUDE SYSLIB  (IKJEFFHT)                                       */ 00485000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                       */ 00486000
*                                                                  0135 00487000
*       ;                                                          0135 00488000
         B     @EL00001                                            0135 00489000
@DATA    DS    0H                                                       00490000
@CH00106 DC    H'1'                                                     00491000
@CH00110 DC    H'2'                                                     00492000
@CH00061 DC    H'3'                                                     00493000
@CH00094 DC    H'4'                                                     00494000
@CH00259 DC    H'5'                                                     00495000
@CH00122 DC    H'6'                                                     00496000
@CH00060 DC    H'17'                                                    00497000
@SM00287 MVC   CARD+16(0),HTACCNTI(@04)                                 00498000
@SM00289 MVC   CARD+3(0),ACNTINST(ACNTIPTR)                             00499000
@DATD    DSECT                                                          00500000
         DS    0F                                                       00501000
@SA00001 DS    18F                                                      00502000
@PC00001 DS    5F                                                       00503000
@SA00002 DS    15F                                                      00504000
@AL00001 DS    1A                                                       00505000
IKJEFF08 CSECT                                                          00506000
         DS    0F                                                       00507000
@CF00069 DC    F'16'                                                    00508000
@CF00261 DC    F'23'                                                    00509000
@CF00200 DC    F'54'                                                    00510000
@CF00067 DC    F'70'                                                    00511000
@CH00067 EQU   @CF00067+2                                               00512000
@DATD    DSECT                                                          00513000
         DS    0D                                                       00514000
KOL      DS    A                                                        00515000
PASS     DS    F                                                        00516000
TEMPHOLD DS    A                                                        00517000
CARD     DS    CL80                                                     00518000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00519000
@ENDDATD EQU   *                                                        00520000
IKJEFF08 CSECT                                                          00521000
         DS    0F                                                       00522000
@SIZDATD DC    AL1(0)                                                   00523000
         DC    AL3(@ENDDATD-@DATD)                                      00524000
@CV00065 DC    V(IKJEFF06)                                              00525000
         DS    0D                                                       00526000
@CC00279 DC    C'//'                                                    00527000
@CC00257 DC    C'JOB'                                                   00528000
@CC00284 DC    C'04B'                                                   00529000
@CC00267 DC    C'NOTIFY='                                               00530000
@CC00270 DC    C'MSGLEVEL=(1,1)'                                        00531000
@CC00263 DC    C'GENERATED JOB STATEMENT'                               00532000
PATCH    DS    CL51                                                     00533000
         ORG   PATCH                                                    00534000
PTCHINIT DC    17CL3'ZAP'                                               00535000
         ORG   PATCH+51                                                 00536000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00537000
@01      EQU   01                                                       00538000
@02      EQU   02                                                       00539000
@03      EQU   03                                                       00540000
@04      EQU   04                                                       00541000
@05      EQU   05                                                       00542000
@06      EQU   06                                                       00543000
@07      EQU   07                                                       00544000
@08      EQU   08                                                       00545000
@09      EQU   09                                                       00546000
@10      EQU   10                                                       00547000
@11      EQU   11                                                       00548000
@12      EQU   12                                                       00549000
@13      EQU   13                                                       00550000
@14      EQU   14                                                       00551000
@15      EQU   15                                                       00552000
HTPTR    EQU   @03                                                      00553000
ACNTIPTR EQU   @04                                                      00554000
CT       EQU   @02                                                      00555000
HOLD     EQU   @05                                                      00556000
R1       EQU   @01                                                      00557000
ACNTINST EQU   0                                                        00558000
IKJEFF02 EQU   0                                                        00559000
CONTAB   EQU   0                                                        00560000
CTCMDNM  EQU   CONTAB+76                                                00561000
HISTORY  EQU   0                                                        00562000
WHATMOD  EQU   HISTORY+12                                               00563000
INGEN    EQU   WHATMOD+2                                                00564000
JCLSWITS EQU   HISTORY+16                                               00565000
PRIORJCL EQU   JCLSWITS                                                 00566000
PVERB    EQU   PRIORJCL                                                 00567000
PDTYPE   EQU   PRIORJCL+2                                               00568000
PMISC    EQU   PRIORJCL+3                                               00569000
CURRJCL  EQU   JCLSWITS+4                                               00570000
CVERB    EQU   CURRJCL                                                  00571000
CDTYPE   EQU   CURRJCL+2                                                00572000
CMISC    EQU   CURRJCL+3                                                00573000
STATICSW EQU   HISTORY+24                                               00574000
GENL     EQU   STATICSW                                                 00575000
QUIT     EQU   GENL                                                     00576000
NONOTIFY EQU   GENL                                                     00577000
TAKEXITS EQU   STATICSW+1                                               00578000
CODEFLD  EQU   STATICSW+3                                               00579000
DLMONJCL EQU   HISTORY+32                                               00580000
HTSWITCH EQU   HISTORY+34                                               00581000
HTACCNTP EQU   HISTORY+40                                               00582000
HTACCNTL EQU   HISTORY+44                                               00583000
HTACNTC1 EQU   HISTORY+46                                               00584000
HTACNTC2 EQU   HISTORY+48                                               00585000
HTACCNTI EQU   0                                                        00586000
MSGTABLE EQU   0                                                        00587000
TMCTPTR  EQU   MSGTABLE+4                                               00588000
ECBPTR   EQU   MSGTABLE+8                                               00589000
@NM00011 EQU   MSGTABLE+12                                              00590000
SW       EQU   MSGTABLE+20                                              00591000
RETMSG   EQU   MSGTABLE+21                                              00592000
SW2      EQU   MSGTABLE+24                                              00593000
MSGID    EQU   MSGTABLE+40                                              00594000
MTINSRTS EQU   MSGTABLE+44                                              00595000
L1       EQU   MTINSRTS                                                 00596000
VAR1     EQU   MTINSRTS+1                                               00597000
L2       EQU   MTINSRTS+4                                               00598000
L3       EQU   MTINSRTS+8                                               00599000
L4       EQU   MTINSRTS+12                                              00600000
MSGRTN   EQU   MSGTABLE+60                                              00601000
RET      EQU   0                                                        00602000
MSGECB   EQU   0                                                        00603000
MSGTMCT  EQU   0                                                        00604000
HIST     EQU   0                                                        00605000
STMTPTR  EQU   0                                                        00606000
USERID   EQU   0                                                        00607000
PCONTAB  EQU   0                                                        00608000
MSGPTR   EQU   0                                                        00609000
CONLIST  EQU   PCONTAB                                                  00610000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00611000
RETCHAR  EQU   RET+2                                                    00612000
RETSIZE  EQU   RET                                                      00613000
VAR4     EQU   MTINSRTS+13                                              00614000
HIGHL4   EQU   L4                                                       00615000
VAR3     EQU   MTINSRTS+9                                               00616000
HIGHL3   EQU   L3                                                       00617000
VAR2     EQU   MTINSRTS+5                                               00618000
HIGHL2   EQU   L2                                                       00619000
HIGHL1   EQU   L1                                                       00620000
@NM00015 EQU   MSGTABLE+36                                              00621000
@NM00014 EQU   MSGTABLE+32                                              00622000
MTOLDPTR EQU   MSGTABLE+28                                              00623000
@NM00013 EQU   MSGTABLE+25                                              00624000
@NM00012 EQU   SW2                                                      00625000
MTDOMSW  EQU   SW2                                                      00626000
MT2OLDSW EQU   SW2                                                      00627000
MTNHEXSW EQU   SW                                                       00628000
MTWTPSW  EQU   SW                                                       00629000
MTJOBISW EQU   SW                                                       00630000
MTKEY1SW EQU   SW                                                       00631000
MTHEXSW  EQU   SW                                                       00632000
MTWTOSW  EQU   SW                                                       00633000
MTPUTLSW EQU   SW                                                       00634000
MTNOIDSW EQU   SW                                                       00635000
MSGCSECT EQU   MSGTABLE+16                                              00636000
MTHIGH   EQU   @NM00011                                                 00637000
MTCPPL   EQU   TMCTPTR                                                  00638000
LISTPTR  EQU   MSGTABLE                                                 00639000
@NM00010 EQU   HISTORY+50                                               00640000
@NM00009 EQU   HISTORY+36                                               00641000
@NM00008 EQU   HISTORY+35                                               00642000
@NM00007 EQU   HTSWITCH                                                 00643000
HTDLMSW  EQU   HTSWITCH                                                 00644000
HTDLM    EQU   DLMONJCL                                                 00645000
@NM00006 EQU   HISTORY+28                                               00646000
HTCODE   EQU   CODEFLD                                                  00647000
OPOFF    EQU   STATICSW+2                                               00648000
@NM00005 EQU   TAKEXITS                                                 00649000
COMNTX   EQU   TAKEXITS                                                 00650000
JESX     EQU   TAKEXITS                                                 00651000
NULLX    EQU   TAKEXITS                                                 00652000
CMDX     EQU   TAKEXITS                                                 00653000
DDX      EQU   TAKEXITS                                                 00654000
EXECX    EQU   TAKEXITS                                                 00655000
JOBX     EQU   TAKEXITS                                                 00656000
FIRST    EQU   GENL                                                     00657000
FLUSH    EQU   GENL                                                     00658000
CDLMFND  EQU   CMISC                                                    00659000
CNOTHING EQU   CMISC                                                    00660000
CCOMCON  EQU   CMISC                                                    00661000
CVERBCOP EQU   CMISC                                                    00662000
CNAME    EQU   CMISC                                                    00663000
CCONERR  EQU   CMISC                                                    00664000
COPCONEX EQU   CMISC                                                    00665000
CCONEX   EQU   CMISC                                                    00666000
CDDDATA  EQU   CDTYPE                                                   00667000
CDDAST   EQU   CDTYPE                                                   00668000
@NM00004 EQU   CVERB+1                                                  00669000
@NM00003 EQU   CVERB+1                                                  00670000
CJES     EQU   CVERB+1                                                  00671000
CCOMMENT EQU   CVERB                                                    00672000
CCOMMAND EQU   CVERB                                                    00673000
CDD      EQU   CVERB                                                    00674000
CEXEC    EQU   CVERB                                                    00675000
CJOB     EQU   CVERB                                                    00676000
CNULL    EQU   CVERB                                                    00677000
CDATA    EQU   CVERB                                                    00678000
CDELIM   EQU   CVERB                                                    00679000
PDLMFND  EQU   PMISC                                                    00680000
PNOTHING EQU   PMISC                                                    00681000
PCOMCON  EQU   PMISC                                                    00682000
PVERBCOP EQU   PMISC                                                    00683000
PNAME    EQU   PMISC                                                    00684000
PCONERR  EQU   PMISC                                                    00685000
POPCONEX EQU   PMISC                                                    00686000
PCONEX   EQU   PMISC                                                    00687000
PDDDATA  EQU   PDTYPE                                                   00688000
PDDAST   EQU   PDTYPE                                                   00689000
@NM00002 EQU   PVERB+1                                                  00690000
@NM00001 EQU   PVERB+1                                                  00691000
PJES     EQU   PVERB+1                                                  00692000
PCOMMENT EQU   PVERB                                                    00693000
PCOMMAND EQU   PVERB                                                    00694000
PDD      EQU   PVERB                                                    00695000
PEXEC    EQU   PVERB                                                    00696000
PJOB     EQU   PVERB                                                    00697000
PNULL    EQU   PVERB                                                    00698000
PDATA    EQU   PVERB                                                    00699000
PDELIM   EQU   PVERB                                                    00700000
INOINIT  EQU   WHATMOD+3                                                00701000
INCOMPIN EQU   WHATMOD+3                                                00702000
INMSG    EQU   WHATMOD+3                                                00703000
INDAIRIN EQU   WHATMOD+3                                                00704000
INWRMGR  EQU   WHATMOD+3                                                00705000
INEXIT   EQU   WHATMOD+3                                                00706000
INIDENT  EQU   WHATMOD+3                                                00707000
INREAD   EQU   WHATMOD+3                                                00708000
INPROMPT EQU   WHATMOD+1                                                00709000
INCONTRL EQU   WHATMOD                                                  00710000
SUBTAB   EQU   HISTORY                                                  00711000
CTACBPT  EQU   CONTAB+72                                                00712000
CTRPLPT  EQU   CONTAB+68                                                00713000
INITSAVE EQU   CONTAB+64                                                00714000
COMECBPT EQU   CONTAB+60                                                00715000
DDPTR    EQU   CONTAB+56                                                00716000
EXITAD   EQU   CONTAB+52                                                00717000
EXWORD   EQU   CONTAB+48                                                00718000
TMCTPT   EQU   CONTAB+44                                                00719000
USERIDPT EQU   CONTAB+40                                                00720000
MSGLISPT EQU   CONTAB+36                                                00721000
JOBNAMPT EQU   CONTAB+32                                                00722000
CTNDSNPT EQU   CONTAB+28                                                00723000
HISTPT   EQU   CONTAB+24                                                00724000
CLOSERPT EQU   CONTAB+20                                                00725000
STMTPT   EQU   CONTAB+16                                                00726000
CONTABPT EQU   CONTAB+12                                                00727000
TABID    EQU   CONTAB                                                   00728000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00729000
@RT00069 EQU   SKIP                                                     00730000
@RT00085 EQU   SKIP                                                     00731000
@RT00104 EQU   SKIP                                                     00732000
@RT00116 EQU   COMMA                                                    00733000
@PB00002 EQU   @EL00001                                                 00734000
@ENDDATA EQU   *                                                        00735000
         END   IKJEFF08,(C'PL/S-II',0502,73293)                         00736000
