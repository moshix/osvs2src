         TITLE 'IKJEFF12 - SUBMIT WRITER MANAGER                       *00001000
                       '                                                00002000
IKJEFF12 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFF12  73.230'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
DUMMYLBL DS    0H                                                  0003 00023000
*                                                                  0047 00024000
*   /*****************************************************************/ 00025000
*   /*                                                               */ 00026000
*   /* INITIALIZATION                                                */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                                  0047 00030000
*   CONLIST=ADDR(CTLTAB);           /* PTR TO SUBMIT'S CONTROL TABLE    00031000
*                                      (USE LOCAL PTR FOR EFFICIENCY)*/ 00032000
         L     CONLIST,@PC00001                                    0047 00033000
*   HTPTR=HISTPT;                   /* PTR TO SUBMIT'S HISTORY TABLE */ 00034000
         L     HTPTR,HISTPT(,CONLIST)                              0048 00035000
*   INWRMGR=ON;                     /* SET BIT IN HISTORY TABLE    0049 00036000
*                                      SAYING IN IKJEFF12            */ 00037000
         OI    INWRMGR(HTPTR),B'00010000'                          0049 00038000
*   R2=CTRPLPT;                     /* GET RPL ADDR FOR PUT OR ENDREQ*/ 00039000
         L     R2,CTRPLPT(,CONLIST)                                0050 00040000
*   RFY                                                            0051 00041000
*     IFGRPL BASED(R2);             /* USE MAP MACRO FOR REENT RPL   */ 00042000
*                                                                  0051 00043000
*   /*****************************************************************/ 00044000
*   /*                                                               */ 00045000
*   /* CHECK FOR PUT ENTRY CODE                                      */ 00046000
*   /*                                                               */ 00047000
*   /*****************************************************************/ 00048000
*                                                                  0052 00049000
*   IF HTCODE=PUTCODE THEN          /* NEED TO PUT JCL STMT IN INTRDR   00050000
*                                      (PASS IT TO THE JOB ENTRY   0052 00051000
*                                      SUBSYSTEM - SEE NOTES IN    0052 00052000
*                                      PROLOGUE)                     */ 00053000
         CLI   HTCODE(HTPTR),2                                     0052 00054000
         BNE   @RF00052                                            0052 00055000
*DOPUT:                             /* BLOCK OF CODE TO ISSUE PUT    */ 00056000
*     DO;                                                          0053 00057000
DOPUT    DS    0H                                                  0054 00058000
*       RPLAREA=STMTPT;             /* PUT THE JCL STATEMENT'S     0054 00059000
*                                      ADDRESS IN THE RPL            */ 00060000
         L     @10,STMTPT(,CONLIST)                                0054 00061000
         ST    @10,RPLAREA(,R2)                                    0054 00062000
*       GEN(PUT  RPL=(R2)                 PUT JCL RECORD INTO INTRDR);  00063000
         PUT  RPL=(R2)                 PUT JCL RECORD INTO INTRDR       00064000
*       RFY                                                        0056 00065000
*         R15 RSTD;                                                0056 00066000
*                                                                  0056 00067000
*       /*************************************************************/ 00068000
*       /*                                                           */ 00069000
*       /* ERROR IF PUT FAILED                                       */ 00070000
*       /*                                                           */ 00071000
*       /*************************************************************/ 00072000
*                                                                  0057 00073000
*       IF R15^=PUTRCOK THEN                                       0057 00074000
         LTR   R15,R15                                             0057 00075000
         BZ    @RF00057                                            0057 00076000
*         DO;                       /* ISSUE PUT ERROR MESSAGE       */ 00077000
*           MSGPTR=MSGLISPT;        /* PTR TO SUBMIT'S MESSAGE TABLE    00078000
*                                      (USE LOCAL PTR FOR EFFICIENCY)*/ 00079000
         L     MSGPTR,MSGLISPT(,CONLIST)                           0059 00080000
*           GFPARMS=GFPARMS&&GFPARMS;/* ZERO OUT VSAMFAIL PARAMETER     00081000
*                                      LIST (GENERAL FAIL LIST)      */ 00082000
         XC    GFPARMS(44),GFPARMS                                 0060 00083000
*           GFCALLID=GFPUT;         /* INDICATE A PUT MACRO FAILED   */ 00084000
         MVC   GFCALLID(2),@CH00056                                0061 00085000
*           CALL RPLERMSG;          /* ISSUE THE ERROR MESSAGE       */ 00086000
         BAL   @14,RPLERMSG                                        0062 00087000
*           RFY                                                    0063 00088000
*             R15 UNRSTD;                                          0063 00089000
*         END;                                                     0064 00090000
*     END DOPUT;                                                   0065 00091000
*   ELSE                            /* HAVE EITHER ENDREQ OR INVALID    00092000
*                                      CODE                          */ 00093000
*DONOTPUT:                          /* BLOCK OF CODE TO CHECK CODE   */ 00094000
*     DO;                                                          0066 00095000
         B     @RC00052                                            0066 00096000
@RF00052 DS    0H                                                  0066 00097000
DONOTPUT DS    0H                                                  0067 00098000
*       MSGPTR=MSGLISPT;            /* PTR TO SUBMIT'S MESSAGE TABLE    00099000
*                                      (USE LOCAL PTR FOR EFFICIENCY)*/ 00100000
*                                                                  0067 00101000
         L     MSGPTR,MSGLISPT(,CONLIST)                           0067 00102000
*       /*************************************************************/ 00103000
*       /*                                                           */ 00104000
*       /* ENDREQ REQUEST                                            */ 00105000
*       /*                                                           */ 00106000
*       /*************************************************************/ 00107000
*                                                                  0068 00108000
*       IF HTCODE=EREQCODE THEN                                    0068 00109000
         CLI   HTCODE(HTPTR),3                                     0068 00110000
         BNE   @RF00068                                            0068 00111000
*DOENDREQ:                          /* BLOCK OF CODE TO DO ENDREQ    */ 00112000
*         DO;                                                      0069 00113000
DOENDREQ DS    0H                                                  0070 00114000
*           GEN(ENDREQ RPL=(R2)                 END OF SUBMITTED JOB);  00115000
         ENDREQ RPL=(R2)                 END OF SUBMITTED JOB           00116000
*           RFY                                                    0071 00117000
*             R15 RSTD;                                            0071 00118000
*                                                                  0071 00119000
*           /*********************************************************/ 00120000
*           /*                                                       */ 00121000
*           /* ERROR IF ENDREQ FAILED                                */ 00122000
*           /*                                                       */ 00123000
*           /*********************************************************/ 00124000
*                                                                  0072 00125000
*           IF R15^=EREQRCOK THEN                                  0072 00126000
         LTR   R15,R15                                             0072 00127000
         BZ    @RF00072                                            0072 00128000
*             DO;                                                  0073 00129000
*               GFPARMS=GFPARMS&&GFPARMS;/* ZERO OUT VSAMFAIL      0074 00130000
*                                      PARAMETER LIST (GENERAL FAIL     00131000
*                                      LIST)                         */ 00132000
         XC    GFPARMS(44),GFPARMS                                 0074 00133000
*               GFCALLID=GFENDREQ;  /* INDICATE ENDREQ MACRO FAILED  */ 00134000
         MVC   GFCALLID(2),@CH00053                                0075 00135000
*               CALL RPLERMSG;      /* ISSUE THE ERROR MESSAGE       */ 00136000
         BAL   @14,RPLERMSG                                        0076 00137000
*               RFY                                                0077 00138000
*                 R15 UNRSTD;                                      0077 00139000
*             END;                                                 0078 00140000
*                                                                  0078 00141000
*           /*********************************************************/ 00142000
*           /*                                                       */ 00143000
*           /* ISSUE 'JOB JOBNAME(JOBID) SUBMITTED' MESSAGE          */ 00144000
*           /*                                                       */ 00145000
*           /*********************************************************/ 00146000
*                                                                  0079 00147000
*           ELSE                                                   0079 00148000
*             DO;                                                  0079 00149000
         B     @RC00072                                            0079 00150000
@RF00072 DS    0H                                                  0080 00151000
*               JOBNAREA=JOBNAME;   /* JOBNAME IS INPUT PARAMETER    */ 00152000
         L     @10,JOBNAMPT(,CONLIST)                              0080 00153000
         MVC   JOBNAREA(8),JOBNAME(@10)                            0080 00154000
*               JOBLPREN='(';                                      0081 00155000
         MVI   JOBLPREN,C'('                                       0081 00156000
*               JOBIAREA=RPLRBAR;   /* JOBID IS RETURNED FROM ENDREQ    00157000
*                                      (JOBID IS SUBSYSTEM'S JOB   0082 00158000
*                                      IDENT)                        */ 00159000
         MVC   JOBIAREA(8),RPLRBAR(R2)                             0082 00160000
*               JOBRPREN=')';                                      0083 00161000
         MVI   JOBRPREN,C')'                                       0083 00162000
*               L1=LENGTH(JOBINSRT);/* MSG INSERT IS JOBNAME (JOBID )*/ 00163000
         MVI   L1(MSGPTR),X'12'                                    0084 00164000
*               VAR1=ADDR(JOBINSRT);                               0085 00165000
         LA    @10,JOBINSRT                                        0085 00166000
         STCM  @10,7,VAR1(MSGPTR)                                  0085 00167000
*               MTJOBISW=ON;        /* TELL IKJEFF02 TO COMPRESS   0086 00168000
*                                      BLANKS OUT OF JOBNAME(JOBID) -   00169000
*                                      NEEDN'T TURN SWITCH OFF       */ 00170000
         OI    MTJOBISW(MSGPTR),B'00000100'                        0086 00171000
*               MSGID='12B';        /* ID FOR JOB SUBMITTED MESSAGE  */ 00172000
         MVI   MSGID+3(MSGPTR),C' '                                0087 00173000
         MVC   MSGID(3,MSGPTR),@CC00407                            0087 00174000
*               RFY                                                0088 00175000
*                 R1 RSTD;                                         0088 00176000
*               R1=ADDR(MSGTABLE);  /* PTR TO IKJEFF02'S PARM LIST   */ 00177000
         LR    R1,MSGPTR                                           0089 00178000
*               CALL IKJEFF02;      /* ISSUE THE JOB SUBMITTED MSG   */ 00179000
         L     @15,MSGRTN(,MSGPTR)                                 0090 00180000
         BALR  @14,@15                                             0090 00181000
*               RFY                                                0091 00182000
*                 R1 UNRSTD;                                       0091 00183000
*               RFY                                                0092 00184000
*                 R15 RSTD;                                        0092 00185000
*               IF R15^=MSGRCOK THEN/* END SUBMIT IF COULDN'T ISSUE     00186000
*                                      PUTLINE                       */ 00187000
         LTR   R15,R15                                             0093 00188000
         BZ    @RF00093                                            0093 00189000
*                 QUIT=ON;                                         0094 00190000
         OI    QUIT(HTPTR),B'10000000'                             0094 00191000
*               RFY                                                0095 00192000
*                 R15 UNRSTD;                                      0095 00193000
@RF00093 DS    0H                                                  0096 00194000
*             END;                                                 0096 00195000
*         END DOENDREQ;                                            0097 00196000
*                                                                  0097 00197000
*       /*************************************************************/ 00198000
*       /*                                                           */ 00199000
*       /* ERROR IF HTCODE ^= PUTCODE OR EREQCODE                    */ 00200000
*       /*                                                           */ 00201000
*       /*************************************************************/ 00202000
*                                                                  0098 00203000
*       ELSE                                                       0098 00204000
*         DO;                                                      0098 00205000
         B     @RC00068                                            0098 00206000
@RF00068 DS    0H                                                  0099 00207000
*           MSGID='12C';            /* MSG FOR INVALID ENTRY CODE    */ 00208000
         MVI   MSGID+3(MSGPTR),C' '                                0099 00209000
         MVC   MSGID(3,MSGPTR),@CC00408                            0099 00210000
*           L1=LENGTH(JOBNAME);     /* INSERT THE CURRENT JOBNAME    */ 00211000
         MVI   L1(MSGPTR),X'08'                                    0100 00212000
*           VAR1=ADDR(JOBNAME);                                    0101 00213000
         MVC   VAR1(3,MSGPTR),JOBNAMPT+1(CONLIST)                  0101 00214000
*           L2=LENGTH(INSRTMOD);    /* INSERT MODULE NAME = IKJEFF12 */ 00215000
         MVI   L2(MSGPTR),X'08'                                    0102 00216000
*           VAR2=ADDR(INSRTMOD);                                   0103 00217000
         LA    @10,INSRTMOD                                        0103 00218000
         STCM  @10,7,VAR2(MSGPTR)                                  0103 00219000
*           RFY                                                    0104 00220000
*             R1 RSTD;                                             0104 00221000
*           R1=ADDR(MSGTABLE);      /* PTR TO IKJEFF02'S PARAM LIST  */ 00222000
         LR    R1,MSGPTR                                           0105 00223000
*           CALL IKJEFF02;          /* ISSUE THE ERROR MESSAGE       */ 00224000
         L     @15,MSGRTN(,MSGPTR)                                 0106 00225000
         BALR  @14,@15                                             0106 00226000
*           RFY                                                    0107 00227000
*             R1 UNRSTD;                                           0107 00228000
*           QUIT=ON;                /* INDICATE SUBMIT FAILED        */ 00229000
         OI    QUIT(HTPTR),B'10000000'                             0108 00230000
*         END;                                                     0109 00231000
*     END DONOTPUT;                                                0110 00232000
@RC00068 DS    0H                                                  0111 00233000
*   INWRMGR=OFF;                    /* INDICATE NOT IN IKJEFF12      */ 00234000
@RC00052 NI    INWRMGR(HTPTR),B'11101111'                          0111 00235000
*                                                                  0112 00236000
*   /*****************************************************************/ 00237000
*   /*                                                               */ 00238000
*   /* RPLERMSG INTERNAL PROCEDURE - CALLS IKJEFF19 TO ISSUE VSAMFAIL*/ 00239000
*   /* MESSAGE FOR PUT OR ENDREQ MACRO (CODE CALLING RPLERMSG MUST   */ 00240000
*   /* ZERO GFPARMS AND SET GFCALLID)                                */ 00241000
*   /*                                                               */ 00242000
*   /*****************************************************************/ 00243000
*                                                                  0112 00244000
*RPLERMSG:                                                         0112 00245000
*   PROC;                                                          0112 00246000
         B     @PB00002                                            0112 00247000
RPLERMSG STM   @14,@12,@SA00002                                    0112 00248000
*   DCL                                                            0113 00249000
*     INTRDRDS CHAR(6)INIT('INTRDR');/* INTRDR D.S.=SUBMIT'S OUTPUT     00250000
*                                      DATA SET                      */ 00251000
*   RFY                                                            0114 00252000
*     R15 RSTD;                                                    0114 00253000
*   GFRCODE=R15;                    /* SAVE MACRO RETURN CODE        */ 00254000
         ST    R15,GFRCODE                                         0115 00255000
*   RFY                                                            0116 00256000
*     R15 UNRSTD;                                                  0116 00257000
*   GFCBPTR=ADDR(IFGRPL);           /* RPL IS FAILING VSAM C.B.      */ 00258000
         ST    R2,GFCBPTR                                          0117 00259000
*   GFKEYN08=ON;                    /* TELL IKJEFF19 TO DO MODESET   */ 00260000
         OI    GFKEYN08,B'10000000'                                0118 00261000
*   GF02PTR=ADDR(IKJEFF02);         /* HAVE ADDRESS OF MSG ISSUER    */ 00262000
         L     @10,MSGRTN(,MSGPTR)                                 0119 00263000
         ST    @10,GF02PTR                                         0119 00264000
*   GFSUBSYS=ON;                    /* USING VSAM SUBSYSTEM INTERFACE*/ 00265000
         OI    GFSUBSYS,B'01000000'                                0120 00266000
*   GFCPPLP=MTCPPL;                 /* PASS PTR TO TMP'S CPPL C.B. 0121 00267000
*                                      (NEED FOR PUTLINE)            */ 00268000
         L     @10,MTCPPL(,MSGPTR)                                 0121 00269000
         ST    @10,GFCPPLP                                         0121 00270000
*   GFECBP=ECBPTR;                  /* USE SUBMIT-SUPPLIED ECB FOR 0122 00271000
*                                      PUTLINE                       */ 00272000
         L     @10,ECBPTR(,MSGPTR)                                 0122 00273000
         ST    @10,GFECBP                                          0122 00274000
*   GFDSNLEN=LENGTH(INTRDRDS);      /* PASS 'INTRDR' NAME TO IKJEFF19   00275000
*                                      FOR DATA SET NAME MSG INSERT  */ 00276000
         MVC   GFDSNLEN(2),@CH00122                                0123 00277000
*   GFDSNP=ADDR(INTRDRDS);                                         0124 00278000
*                                                                  0124 00279000
         LA    @10,INTRDRDS                                        0124 00280000
         ST    @10,GFDSNP                                          0124 00281000
*   /*****************************************************************/ 00282000
*   /*                                                               */ 00283000
*   /* CALL VSAMFAIL                                                 */ 00284000
*   /*                                                               */ 00285000
*   /*****************************************************************/ 00286000
*                                                                  0125 00287000
*   RFY                                                            0125 00288000
*     R0 RSTD;                                                     0125 00289000
*   GEN(LOAD  EP=IKJEFF19);         /* LOAD THE VSAMFAIL ROUTINE     */ 00290000
         LOAD  EP=IKJEFF19                                              00291000
*   CALL IKJEFF19(GFPARMS);         /* ISSUE THE ERROR MESSAGE       */ 00292000
         LA    @10,GFPARMS                                         0127 00293000
         ST    @10,@AL00001                                        0127 00294000
         LR    @15,R0                                              0127 00295000
         LA    @01,@AL00001                                        0127 00296000
         BALR  @14,@15                                             0127 00297000
*   GEN(DELETE EP=IKJEFF19);        /* DELETE THE VSAMFAIL MODULE    */ 00298000
         DELETE EP=IKJEFF19                                             00299000
*   RFY                                                            0129 00300000
*     R0 UNRSTD;                                                   0129 00301000
*                                                                  0129 00302000
*   /*****************************************************************/ 00303000
*   /*                                                               */ 00304000
*   /* ISSUE 'SUBMIT TERMINATED ON JOB JOBNAME' MESSAGE              */ 00305000
*   /*                                                               */ 00306000
*   /*****************************************************************/ 00307000
*                                                                  0130 00308000
*   MSGID='12D';                    /* MSG FOR SUBMIT TERMINATED     */ 00309000
         MVI   MSGID+3(MSGPTR),C' '                                0130 00310000
         MVC   MSGID(3,MSGPTR),@CC00414                            0130 00311000
*   L1=LENGTH(CTCMDNM);             /* INSERT COMMAND NAME           */ 00312000
         MVI   L1(MSGPTR),X'08'                                    0131 00313000
*   VAR1=ADDR(CTCMDNM);                                            0132 00314000
         LA    @10,CTCMDNM(,CONLIST)                               0132 00315000
         STCM  @10,7,VAR1(MSGPTR)                                  0132 00316000
*   L2=LENGTH(JOBNAME);             /* INSERT THE CURRENT JOBNAME    */ 00317000
         MVI   L2(MSGPTR),X'08'                                    0133 00318000
*   VAR2=ADDR(JOBNAME);                                            0134 00319000
         MVC   VAR2(3,MSGPTR),JOBNAMPT+1(CONLIST)                  0134 00320000
*   RFY                                                            0135 00321000
*     R1 RSTD;                                                     0135 00322000
*   R1=ADDR(MSGTABLE);              /* PTR TO IKJEFF02'S PARAM LIST  */ 00323000
         LR    R1,MSGPTR                                           0136 00324000
*   CALL IKJEFF02;                  /* ISSUE THE ERROR MESSAGE       */ 00325000
         L     @15,MSGRTN(,MSGPTR)                                 0137 00326000
         BALR  @14,@15                                             0137 00327000
*   RFY                                                            0138 00328000
*     R1 UNRSTD;                                                   0138 00329000
*   QUIT=ON;                        /* INDICATE SUBMIT FAILED        */ 00330000
         OI    QUIT(HTPTR),B'10000000'                             0139 00331000
*   END RPLERMSG;                                                  0140 00332000
@EL00002 DS    0H                                                  0140 00333000
@EF00002 DS    0H                                                  0140 00334000
@ER00002 LM    @14,@12,@SA00002                                    0140 00335000
         BR    @14                                                 0140 00336000
*   END IKJEFF12                    /* ERROR EXIT IF QUIT SWITCH ON  */ 00337000
*                                                                  0141 00338000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00339000
*/*%INCLUDE SYSLIB  (IKJEFFCT)                                       */ 00340000
*/*%INCLUDE SYSLIB  (IKJEFFGF)                                       */ 00341000
*/*%INCLUDE SYSLIB  (IKJEFFHT)                                       */ 00342000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                       */ 00343000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 00344000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                       */ 00345000
*                                                                  0141 00346000
*       ;                                                          0141 00347000
@EL00001 L     @13,4(,@13)                                         0141 00348000
@EF00001 L     @00,@SIZDATD                                        0141 00349000
         LR    @01,@11                                             0141 00350000
         FREEMAIN R,LV=(0),A=(1)                                        00351000
@ER00001 LM    @14,@12,12(@13)                                     0141 00352000
         BR    @14                                                 0141 00353000
@DATA    DS    0H                                                       00354000
@CH00053 DC    H'3'                                                     00355000
@CH00122 DC    H'6'                                                     00356000
@CH00056 DC    H'8'                                                     00357000
@DATD    DSECT                                                          00358000
         DS    0F                                                       00359000
@SA00001 DS    18F                                                      00360000
@PC00001 DS    1F                                                       00361000
@SA00002 DS    15F                                                      00362000
@AL00001 DS    1A                                                       00363000
IKJEFF12 CSECT                                                          00364000
         DS    0F                                                       00365000
@DATD    DSECT                                                          00366000
         DS    0D                                                       00367000
RETCODE  DS    F                                                        00368000
JOBINSRT DS    CL18                                                     00369000
         ORG   JOBINSRT                                                 00370000
JOBNAREA DS    CL8                                                      00371000
JOBLPREN DS    CL1                                                      00372000
JOBIAREA DS    CL8                                                      00373000
JOBRPREN DS    CL1                                                      00374000
         ORG   JOBINSRT+18                                              00375000
         DS    CL2                                                      00376000
GFPARMS  DS    CL44                                                     00377000
         ORG   GFPARMS                                                  00378000
GFCBPTR  DS    AL4                                                      00379000
GFRCODE  DS    FL4                                                      00380000
GF02PTR  DS    AL4                                                      00381000
GFCALLID DS    FL2                                                      00382000
GFBITS   DS    BL1                                                      00383000
         ORG   GFBITS                                                   00384000
GFKEYN08 DS    BL1                                                      00385000
GFSUBSYS EQU   GFBITS+0                                                 00386000
GFWTPSW  EQU   GFBITS+0                                                 00387000
@NM00001 EQU   GFBITS+0                                                 00388000
         ORG   GFPARMS+15                                               00389000
@NM00002 DS    AL1                                                      00390000
GFCPPLP  DS    AL4                                                      00391000
GFECBP   DS    AL4                                                      00392000
GFDSNLEN DS    FL2                                                      00393000
GFPGMNL  DS    FL2                                                      00394000
GFDSNP   DS    AL4                                                      00395000
GFPGMNP  DS    AL4                                                      00396000
@NM00003 DS    AL4                                                      00397000
@NM00004 DS    AL4                                                      00398000
         ORG   GFPARMS+44                                               00399000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00400000
@ENDDATD EQU   *                                                        00401000
IKJEFF12 CSECT                                                          00402000
         DS    0F                                                       00403000
@SIZDATD DC    AL1(0)                                                   00404000
         DC    AL3(@ENDDATD-@DATD)                                      00405000
         DS    0D                                                       00406000
@CC00407 DC    C'12B'                                                   00407000
@CC00408 DC    C'12C'                                                   00408000
@CC00414 DC    C'12D'                                                   00409000
PATCH    DS    CL51                                                     00410000
         ORG   PATCH                                                    00411000
PTCHINIT DC    17CL3'ZAP'                                               00412000
         ORG   PATCH+51                                                 00413000
INSRTMOD DC    CL8'IKJEFF12'                                            00414000
INTRDRDS DC    CL6'INTRDR'                                              00415000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00416000
@01      EQU   01                                                       00417000
@02      EQU   02                                                       00418000
@03      EQU   03                                                       00419000
@04      EQU   04                                                       00420000
@05      EQU   05                                                       00421000
@06      EQU   06                                                       00422000
@07      EQU   07                                                       00423000
@08      EQU   08                                                       00424000
@09      EQU   09                                                       00425000
@10      EQU   10                                                       00426000
@11      EQU   11                                                       00427000
@12      EQU   12                                                       00428000
@13      EQU   13                                                       00429000
@14      EQU   14                                                       00430000
@15      EQU   15                                                       00431000
MSGPTR   EQU   @04                                                      00432000
HTPTR    EQU   @06                                                      00433000
CONLIST  EQU   @05                                                      00434000
R0       EQU   @00                                                      00435000
R1       EQU   @01                                                      00436000
R2       EQU   @02                                                      00437000
R15      EQU   @15                                                      00438000
IKJEFF02 EQU   0                                                        00439000
IKJEFF19 EQU   0                                                        00440000
JOBNAME  EQU   0                                                        00441000
CONTAB   EQU   0                                                        00442000
STMTPT   EQU   CONTAB+16                                                00443000
HISTPT   EQU   CONTAB+24                                                00444000
JOBNAMPT EQU   CONTAB+32                                                00445000
MSGLISPT EQU   CONTAB+36                                                00446000
CTRPLPT  EQU   CONTAB+68                                                00447000
CTCMDNM  EQU   CONTAB+76                                                00448000
HISTORY  EQU   0                                                        00449000
WHATMOD  EQU   HISTORY+12                                               00450000
INWRMGR  EQU   WHATMOD+3                                                00451000
JCLSWITS EQU   HISTORY+16                                               00452000
PRIORJCL EQU   JCLSWITS                                                 00453000
PVERB    EQU   PRIORJCL                                                 00454000
PDTYPE   EQU   PRIORJCL+2                                               00455000
PMISC    EQU   PRIORJCL+3                                               00456000
CURRJCL  EQU   JCLSWITS+4                                               00457000
CVERB    EQU   CURRJCL                                                  00458000
CDTYPE   EQU   CURRJCL+2                                                00459000
CMISC    EQU   CURRJCL+3                                                00460000
STATICSW EQU   HISTORY+24                                               00461000
GENL     EQU   STATICSW                                                 00462000
QUIT     EQU   GENL                                                     00463000
TAKEXITS EQU   STATICSW+1                                               00464000
CODEFLD  EQU   STATICSW+3                                               00465000
HTCODE   EQU   CODEFLD                                                  00466000
DLMONJCL EQU   HISTORY+32                                               00467000
HTSWITCH EQU   HISTORY+34                                               00468000
HTACCNTP EQU   HISTORY+40                                               00469000
MSGTABLE EQU   0                                                        00470000
TMCTPTR  EQU   MSGTABLE+4                                               00471000
MTCPPL   EQU   TMCTPTR                                                  00472000
ECBPTR   EQU   MSGTABLE+8                                               00473000
@NM00010 EQU   MSGTABLE+12                                              00474000
SW       EQU   MSGTABLE+20                                              00475000
MTJOBISW EQU   SW                                                       00476000
RETMSG   EQU   MSGTABLE+21                                              00477000
SW2      EQU   MSGTABLE+24                                              00478000
MSGID    EQU   MSGTABLE+40                                              00479000
MTINSRTS EQU   MSGTABLE+44                                              00480000
L1       EQU   MTINSRTS                                                 00481000
VAR1     EQU   MTINSRTS+1                                               00482000
L2       EQU   MTINSRTS+4                                               00483000
VAR2     EQU   MTINSRTS+5                                               00484000
L3       EQU   MTINSRTS+8                                               00485000
L4       EQU   MTINSRTS+12                                              00486000
MSGRTN   EQU   MSGTABLE+60                                              00487000
RET      EQU   0                                                        00488000
IFGRPL   EQU   0                                                        00489000
RPLCOMN  EQU   IFGRPL                                                   00490000
RPLIDWD  EQU   RPLCOMN                                                  00491000
RPLLEN   EQU   RPLIDWD+3                                                00492000
RPLECB   EQU   RPLCOMN+8                                                00493000
RPLFDBK  EQU   RPLCOMN+13                                               00494000
RPLRTNCD EQU   RPLFDBK                                                  00495000
RPLCNDCD EQU   RPLFDBK+1                                                00496000
RPLCMPON EQU   RPLCNDCD                                                 00497000
RPLERRCD EQU   RPLCNDCD+1                                               00498000
RPLKEYLE EQU   RPLCOMN+16                                               00499000
RPLAREA  EQU   RPLCOMN+32                                               00500000
RPLARG   EQU   RPLCOMN+36                                               00501000
RPLOPTCD EQU   RPLCOMN+40                                               00502000
RPLOPT1  EQU   RPLOPTCD                                                 00503000
RPLECBSW EQU   RPLOPT1                                                  00504000
RPLOPT2  EQU   RPLOPTCD+1                                               00505000
RPLADR   EQU   RPLOPT2                                                  00506000
RPLOPT3  EQU   RPLOPTCD+2                                               00507000
RPLNXTRP EQU   RPLCOMN+44                                               00508000
RPLOPTC2 EQU   RPLCOMN+56                                               00509000
RPLOPT5  EQU   RPLOPTC2                                                 00510000
RPLWRTYP EQU   RPLOPT5                                                  00511000
RPLOPT6  EQU   RPLOPTC2+1                                               00512000
RPLUNTYP EQU   RPLOPT6                                                  00513000
RPLOPT7  EQU   RPLOPTC2+2                                               00514000
RPLCNOPT EQU   RPLOPT7                                                  00515000
RPLOPT8  EQU   RPLOPTC2+3                                               00516000
RPLRBAR  EQU   RPLCOMN+60                                               00517000
RPL6RBA  EQU   RPLRBAR+2                                                00518000
RPLEXTDS EQU   RPLCOMN+68                                               00519000
RPLEXTD1 EQU   RPLEXTDS                                                 00520000
HTACCNTI EQU   0                                                        00521000
MSGECB   EQU   0                                                        00522000
MSGTMCT  EQU   0                                                        00523000
STMT     EQU   0                                                        00524000
CTLTAB   EQU   0                                                        00525000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00526000
RPLERMSA EQU   RPLCOMN+72                                               00527000
RPLEMLEN EQU   RPLCOMN+70                                               00528000
RPLACTIV EQU   RPLCOMN+69                                               00529000
RPLBRANC EQU   RPLEXTD1                                                 00530000
RPLNIB   EQU   RPLEXTD1                                                 00531000
RPLGVNT  EQU   RPLEXTD1                                                 00532000
RPLLVNT  EQU   RPLEXTD1                                                 00533000
RPLEXIT  EQU   RPLEXTD1                                                 00534000
RPLNEXIT EQU   RPLEXTD1                                                 00535000
RPLEXSCH EQU   RPLEXTD1                                                 00536000
RPLDDDD  EQU   RPL6RBA+2                                                00537000
RPLS2S2  EQU   RPL6RBA                                                  00538000
RPLS1S1  EQU   RPLRBAR                                                  00539000
RPLRSV88 EQU   RPLOPT8                                                  00540000
RPLUNCON EQU   RPLOPT8                                                  00541000
RPLACTV  EQU   RPLOPT8                                                  00542000
RPLSESS  EQU   RPLOPT8                                                  00543000
RPLPEND  EQU   RPLOPT8                                                  00544000
RPLODPRM EQU   RPLOPT8                                                  00545000
RPLODACP EQU   RPLOPT8                                                  00546000
RPLODACQ EQU   RPLOPT8                                                  00547000
RPLRSV78 EQU   RPLOPT7                                                  00548000
RPLRSV77 EQU   RPLOPT7                                                  00549000
RPLRLSOP EQU   RPLOPT7                                                  00550000
RPLRSV75 EQU   RPLOPT7                                                  00551000
RPLQOPT  EQU   RPLOPT7                                                  00552000
RPLCNIMM EQU   RPLCNOPT                                                 00553000
RPLCNANY EQU   RPLCNOPT                                                 00554000
RPLCNALL EQU   RPLCNOPT                                                 00555000
RPLRSV68 EQU   RPLOPT6                                                  00556000
RPLRSV67 EQU   RPLOPT6                                                  00557000
RPLLOCK  EQU   RPLOPT6                                                  00558000
RPLNCOND EQU   RPLOPT6                                                  00559000
RPLCOND  EQU   RPLOPT6                                                  00560000
RPLEOT   EQU   RPLUNTYP                                                 00561000
RPLEOM   EQU   RPLUNTYP                                                 00562000
RPLEOB   EQU   RPLUNTYP                                                 00563000
RPLWROPT EQU   RPLOPT5                                                  00564000
RPLNODE  EQU   RPLOPT5                                                  00565000
RPLERACE EQU   RPLWRTYP                                                 00566000
RPLEAU   EQU   RPLWRTYP                                                 00567000
RPLNERAS EQU   RPLWRTYP                                                 00568000
RPLPSOPT EQU   RPLOPT5                                                  00569000
RPLSSNIN EQU   RPLOPT5                                                  00570000
RPLDLGIN EQU   RPLOPT5                                                  00571000
RPLBUFL  EQU   RPLCOMN+52                                               00572000
RPLRLEN  EQU   RPLCOMN+48                                               00573000
RPLCHAIN EQU   RPLNXTRP                                                 00574000
RPLOPT4  EQU   RPLOPTCD+3                                               00575000
RPLALIGN EQU   RPLOPT3                                                  00576000
RPLFMT   EQU   RPLOPT3                                                  00577000
RPLFLD   EQU   RPLOPT3                                                  00578000
RPLVFY   EQU   RPLOPT3                                                  00579000
RPLBLK   EQU   RPLOPT3                                                  00580000
RPLSFORM EQU   RPLOPT3                                                  00581000
RPLEODS  EQU   RPLOPT3                                                  00582000
RPLNSP   EQU   RPLOPT2                                                  00583000
RPLUPD   EQU   RPLOPT2                                                  00584000
@NM00015 EQU   RPLOPT2                                                  00585000
RPLCNV   EQU   RPLOPT2                                                  00586000
RPLADD   EQU   RPLADR                                                   00587000
RPLKEY   EQU   RPLOPT2                                                  00588000
RPLECBIN EQU   RPLECBSW                                                 00589000
RPLGEN   EQU   RPLOPT1                                                  00590000
RPLKGE   EQU   RPLOPT1                                                  00591000
RPLASY   EQU   RPLOPT1                                                  00592000
RPLSKP   EQU   RPLOPT1                                                  00593000
RPLSEQ   EQU   RPLOPT1                                                  00594000
RPLDIR   EQU   RPLOPT1                                                  00595000
RPLLOC   EQU   RPLOPT1                                                  00596000
RPLDAF   EQU   RPLARG+2                                                 00597000
RPLSAF   EQU   RPLARG                                                   00598000
RPLTCBPT EQU   RPLCOMN+28                                               00599000
RPLDACB  EQU   RPLCOMN+24                                               00600000
RPLCCHAR EQU   RPLCOMN+20                                               00601000
RPLSTRID EQU   RPLCOMN+18                                               00602000
RPLKEYL  EQU   RPLKEYLE                                                 00603000
RPLFDB3  EQU   RPLERRCD                                                 00604000
RPLFDB2  EQU   RPLCMPON                                                 00605000
RPLERREG EQU   RPLRTNCD                                                 00606000
RPLSTAT  EQU   RPLCOMN+12                                               00607000
RPLPOST  EQU   RPLECB                                                   00608000
RPLWAIT  EQU   RPLECB                                                   00609000
RPLPLHPT EQU   RPLCOMN+4                                                00610000
RPLLEN2  EQU   RPLLEN                                                   00611000
RPLREQ   EQU   RPLIDWD+2                                                00612000
RPLSTYP  EQU   RPLIDWD+1                                                00613000
RPLID    EQU   RPLIDWD                                                  00614000
RETCHAR  EQU   RET+2                                                    00615000
RETSIZE  EQU   RET                                                      00616000
VAR4     EQU   MTINSRTS+13                                              00617000
HIGHL4   EQU   L4                                                       00618000
VAR3     EQU   MTINSRTS+9                                               00619000
HIGHL3   EQU   L3                                                       00620000
HIGHL2   EQU   L2                                                       00621000
HIGHL1   EQU   L1                                                       00622000
@NM00014 EQU   MSGTABLE+36                                              00623000
@NM00013 EQU   MSGTABLE+32                                              00624000
MTOLDPTR EQU   MSGTABLE+28                                              00625000
@NM00012 EQU   MSGTABLE+25                                              00626000
@NM00011 EQU   SW2                                                      00627000
MTDOMSW  EQU   SW2                                                      00628000
MT2OLDSW EQU   SW2                                                      00629000
MTNHEXSW EQU   SW                                                       00630000
MTWTPSW  EQU   SW                                                       00631000
MTKEY1SW EQU   SW                                                       00632000
MTHEXSW  EQU   SW                                                       00633000
MTWTOSW  EQU   SW                                                       00634000
MTPUTLSW EQU   SW                                                       00635000
MTNOIDSW EQU   SW                                                       00636000
MSGCSECT EQU   MSGTABLE+16                                              00637000
MTHIGH   EQU   @NM00010                                                 00638000
LISTPTR  EQU   MSGTABLE                                                 00639000
@NM00009 EQU   HISTORY+50                                               00640000
HTACNTC2 EQU   HISTORY+48                                               00641000
HTACNTC1 EQU   HISTORY+46                                               00642000
HTACCNTL EQU   HISTORY+44                                               00643000
@NM00008 EQU   HISTORY+36                                               00644000
@NM00007 EQU   HISTORY+35                                               00645000
@NM00006 EQU   HTSWITCH                                                 00646000
HTDLMSW  EQU   HTSWITCH                                                 00647000
HTDLM    EQU   DLMONJCL                                                 00648000
@NM00005 EQU   HISTORY+28                                               00649000
OPOFF    EQU   STATICSW+2                                               00650000
NULLX    EQU   TAKEXITS                                                 00651000
CMDX     EQU   TAKEXITS                                                 00652000
DDX      EQU   TAKEXITS                                                 00653000
EXECX    EQU   TAKEXITS                                                 00654000
JOBX     EQU   TAKEXITS                                                 00655000
NONOTIFY EQU   GENL                                                     00656000
FIRST    EQU   GENL                                                     00657000
FLUSH    EQU   GENL                                                     00658000
CDLMFND  EQU   CMISC                                                    00659000
CNOTHING EQU   CMISC                                                    00660000
CCOMCON  EQU   CMISC                                                    00661000
CVERBCOP EQU   CMISC                                                    00662000
CNAME    EQU   CMISC                                                    00663000
CCONERR  EQU   CMISC                                                    00664000
COPCONEX EQU   CMISC                                                    00665000
CCONEX   EQU   CMISC                                                    00666000
CDDDATA  EQU   CDTYPE                                                   00667000
CDDAST   EQU   CDTYPE                                                   00668000
CCOMMENT EQU   CVERB                                                    00669000
CCOMMAND EQU   CVERB                                                    00670000
CDD      EQU   CVERB                                                    00671000
CEXEC    EQU   CVERB                                                    00672000
CJOB     EQU   CVERB                                                    00673000
CNULL    EQU   CVERB                                                    00674000
CDATA    EQU   CVERB                                                    00675000
CDELIM   EQU   CVERB                                                    00676000
PDLMFND  EQU   PMISC                                                    00677000
PNOTHING EQU   PMISC                                                    00678000
PCOMCON  EQU   PMISC                                                    00679000
PVERBCOP EQU   PMISC                                                    00680000
PNAME    EQU   PMISC                                                    00681000
PCONERR  EQU   PMISC                                                    00682000
POPCONEX EQU   PMISC                                                    00683000
PCONEX   EQU   PMISC                                                    00684000
PDDDATA  EQU   PDTYPE                                                   00685000
PDDAST   EQU   PDTYPE                                                   00686000
PCOMMENT EQU   PVERB                                                    00687000
PCOMMAND EQU   PVERB                                                    00688000
PDD      EQU   PVERB                                                    00689000
PEXEC    EQU   PVERB                                                    00690000
PJOB     EQU   PVERB                                                    00691000
PNULL    EQU   PVERB                                                    00692000
PDATA    EQU   PVERB                                                    00693000
PDELIM   EQU   PVERB                                                    00694000
INOINIT  EQU   WHATMOD+3                                                00695000
INCOMPIN EQU   WHATMOD+3                                                00696000
INMSG    EQU   WHATMOD+3                                                00697000
INDAIRIN EQU   WHATMOD+3                                                00698000
INEXIT   EQU   WHATMOD+3                                                00699000
INIDENT  EQU   WHATMOD+3                                                00700000
INREAD   EQU   WHATMOD+3                                                00701000
INGEN    EQU   WHATMOD+2                                                00702000
INPROMPT EQU   WHATMOD+1                                                00703000
INCONTRL EQU   WHATMOD                                                  00704000
SUBTAB   EQU   HISTORY                                                  00705000
CTACBPT  EQU   CONTAB+72                                                00706000
INITSAVE EQU   CONTAB+64                                                00707000
COMECBPT EQU   CONTAB+60                                                00708000
DDPTR    EQU   CONTAB+56                                                00709000
EXITAD   EQU   CONTAB+52                                                00710000
EXWORD   EQU   CONTAB+48                                                00711000
TMCTPT   EQU   CONTAB+44                                                00712000
USERIDPT EQU   CONTAB+40                                                00713000
CTNDSNPT EQU   CONTAB+28                                                00714000
CLOSERPT EQU   CONTAB+20                                                00715000
CONTABPT EQU   CONTAB+12                                                00716000
TABID    EQU   CONTAB                                                   00717000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00718000
@RF00057 EQU   @RC00052                                                 00719000
@RC00072 EQU   @RC00068                                                 00720000
@PB00002 EQU   @EL00001                                                 00721000
@ENDDATA EQU   *                                                        00722000
         END   IKJEFF12,(C'PL/S-II',0502,73230)                         00723000
