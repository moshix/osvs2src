         TITLE 'IKJEFF15 - SUBMIT OUTPUT D.S. INITIALIZER              *00001000
                        '                                               00002000
IKJEFF15 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEFF15  73.324'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
DUMMYLBL DS    0H                                                  0003 00023000
*                                                                  0090 00024000
*   /*****************************************************************/ 00025000
*   /*                                                               */ 00026000
*   /* SET UP LOCAL POINTERS TO SUBMIT'S TABLES - FOR EFFICIENCY     */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                                  0090 00030000
*   CONLIST=ADDR(CTLTAB);           /* PTR TO SUBMIT'S CONTROL TABLE */ 00031000
         L     CONLIST,@PC00001                                    0090 00032000
*   HTPTR=HISTPT;                   /* PTR TO SUBMIT'S HISTORY TABLE */ 00033000
         L     HTPTR,HISTPT(,CONLIST)                              0091 00034000
*   MSGPTR=MSGLISPT;                /* PTR TO SUBMIT'S MESSAGE TABLE */ 00035000
         L     MSGPTR,MSGLISPT(,CONLIST)                           0092 00036000
*   INOINIT=ON;                     /* SET BIT IN HISTORY TABLE    0093 00037000
*                                      SAYING IN IKJEFF15            */ 00038000
*                                                                  0093 00039000
         OI    INOINIT(HTPTR),B'00000001'                          0093 00040000
*   /*****************************************************************/ 00041000
*   /*                                                               */ 00042000
*   /* CHECK FOR OPEN ENTRY CODE                                     */ 00043000
*   /*                                                               */ 00044000
*   /*****************************************************************/ 00045000
*                                                                  0094 00046000
*   IF HTCODE=OPENCODE THEN         /* NEED TO ALLOC AND OPEN INTRDR    00047000
*                                      IF ENTERED FROM IKJEFF04      */ 00048000
         CLI   HTCODE(HTPTR),1                                     0094 00049000
         BNE   @RF00094                                            0094 00050000
*     DO;                           /* DOALLOC DO/END GROUP          */ 00051000
*/********************************************************************/ 00052000
*/*     DYNAMICALLY ALLOCATE THE OUTPUT DATA SET (INTERNAL READER)   */ 00053000
*/*                        - SYSOUT PROGRAM (WRITER) IS INTRDR       */ 00054000
*/*                              //  DD  SYSOUT=(,INTRDR)            */ 00055000
*/*                        - UNALLOCATE AT CLOSE                     */ 00056000
*/*                        - RETURN THE DDNAME                       */ 00057000
*/********************************************************************/ 00058000
*/*                                                                  */ 00059000
*/*     PARAMETERS FOR DYNAMIC ALLOCATION:                           */ 00060000
*/*                                                                  */ 00061000
*/*      R1 -> S99RBPTR -> S99RB      -> TXTPLIST -> TEXT UNITS      */ 00062000
*/*                        (DYN ALLOC               (DESCRIBE THE    */ 00063000
*/*                         PARAMETER                ALLOCATION      */ 00064000
*/*                         LIST)                    REQUEST)        */ 00065000
*/*                                                                  */ 00066000
*/********************************************************************/ 00067000
*                                                                  0096 00068000
*       S99RBPTR=ADDR(S99RB);       /* *** PTR TO DYNALLOC PARM LIST */ 00069000
         LA    @10,S99RB                                           0096 00070000
         ST    @10,S99RBPTR                                        0096 00071000
*       S99RBPND=ON;                /* H-O BIT ON = STANDARD LINKAGE */ 00072000
         OI    S99RBPND,B'10000000'                                0097 00073000
*       S99RB=S99RB&&S99RB;         /* ZERO THE PARM LIST            */ 00074000
         XC    S99RB(20),S99RB                                     0098 00075000
*       S99RBLN=LENGTH(S99RB);      /* *** INIT THE DYNALLOC PARM  0099 00076000
*                                      LIST                          */ 00077000
         MVI   S99RBLN,X'14'                                       0099 00078000
*       S99VERB=S99VRBAL;           /* THIS IS AN ALLOCATION REQUEST */ 00079000
         MVI   S99VERB,X'01'                                       0100 00080000
*       S99TXTPP=ADDR(TXTPLIST);    /* POINTER TO LIST OF TEXT UNITS    00081000
*                                      POINTERS                      */ 00082000
         LA    @10,TXTPLIST                                        0101 00083000
         ST    @10,S99TXTPP                                        0101 00084000
*       ALLOCTXT=NRTEXT;            /* COPY TEXT UNITS INTO REENTRANT   00085000
*                                      CORE                          */ 00086000
         MVC   ALLOCTXT(34),NRTEXT                                 0102 00087000
*       TPSPGNM=ADDR(RENSPGNM);     /* PTR TO WTR = INTRDR TEXT UNIT */ 00088000
         LA    @10,RENSPGNM                                        0103 00089000
         ST    @10,TPSPGNM                                         0103 00090000
*       TPSYSOU=ADDR(RENSYSOU);     /* PTR TO SYSOUT REQUEST T.U.    */ 00091000
         LA    @10,RENSYSOU                                        0104 00092000
         ST    @10,TPSYSOU                                         0104 00093000
*       TPCLOSE=ADDR(RENCLOSE);     /* PTR TO UNALLOC AT CLOSE T.U.  */ 00094000
         LA    @10,RENCLOSE                                        0105 00095000
         ST    @10,TPCLOSE                                         0105 00096000
*       TPRTDDN=ADDR(RENRTDDN);     /* PTR TO RETURN-THE-DDNAME TEXT    00097000
*                                      UNIT (NEED THE DDNAME TO OPEN    00098000
*                                      THE INTRDR)                   */ 00099000
         LA    @10,RENRTDDN                                        0106 00100000
         ST    @10,TPRTDDN                                         0106 00101000
*       TPEND=ON;                   /* END OF TEXT UNIT POINTER LIST */ 00102000
         OI    TPEND,B'10000000'                                   0107 00103000
*       RFY                                                        0108 00104000
*         R1 RSTD;                                                 0108 00105000
*       R1=ADDR(S99RBPTR);          /* PTR TO PTR TO DYNALLOC PARMLST*/ 00106000
*                                                                  0109 00107000
         LA    R1,S99RBPTR                                         0109 00108000
*       /*************************************************************/ 00109000
*       /*                                                           */ 00110000
*       /* MACDATE Y-2 73082                                         */ 00111000
*       /*                                                           */ 00112000
*       /*************************************************************/ 00113000
*                                                                  0110 00114000
*       SVC(99);                    /* ISSUE DYNAMIC ALLOCATION SVC  */ 00115000
         SVC   99                                                  0110 00116000
*       RFY                                                        0111 00117000
*         R1 UNRSTD;                                               0111 00118000
*       RFY                                                        0112 00119000
*         R15 RSTD;                                                0112 00120000
*       RFY                                                        0113 00121000
*         S99TUNIT BASED(TPRTDDN);  /* POINT TO TEXT UNIT FOR      0113 00122000
*                                      RETURNED DDNAME (NEED DDNAME     00123000
*                                      IN ACB TO OPEN THE INTRDR DATA   00124000
*                                      SET)                          */ 00125000
*                                                                  0113 00126000
*       /*************************************************************/ 00127000
*       /*                                                           */ 00128000
*       /* ERROR IF DYNAMIC ALLOCATION FAILED - HAVE DAIRFAIL ISSUE  */ 00129000
*       /* ERROR MESSAGE (CHANGE FROM KEY 1 TO 0 IN CASE SECOND LEVEL*/ 00130000
*       /* MESSAGE ISSUED - STORED IN TMP'S KEY 8 SUBPOOL 78)        */ 00131000
*       /*                                                           */ 00132000
*       /*************************************************************/ 00133000
*                                                                  0114 00134000
*       IF R15^=ALLOCROK THEN                                      0114 00135000
         LTR   R15,R15                                             0114 00136000
         BZ    @RF00114                                            0114 00137000
*         DO;                                                      0115 00138000
*           RETCODE=R15;            /* SAVE DYNALLOC RETURN CODE     */ 00139000
         ST    R15,RETCODE                                         0116 00140000
*           RFY                                                    0117 00141000
*             R15 UNRSTD;                                          0117 00142000
*           RFY                                                    0118 00143000
*             R0 RSTD;                                             0118 00144000
*           GEN(LOAD EP=IKJEFF18);  /* DAIRFAIL                      */ 00145000
         LOAD EP=IKJEFF18                                               00146000
*           GEN;                                                   0120 00147000
*                                      /* CHANGE TO KEY 0 */            00148000
SETKEY0   MODESET EXTKEY=SUPR,RELATED=(KEY0,IKJEFF15(SETKEY1))          00149000
*           CALL IKJEFF18           /* DAIRFAIL ROUTINE              */ 00150000
*               (S99RB,             /* NEEDS DYNALLOC PARAMETER LIST */ 00151000
*               RETCODE,            /* AND DYNALLOC RETURN CODE      */ 00152000
*               MSGRTN,             /* AND ADDR OF IKJEFF02 (OR 0)   */ 00153000
*               CALLERID,           /* AND ID (WANT DYNALLOC INTFC)  */ 00154000
*               CPPL);              /* AND CPPL (FOR PUTLINE)        */ 00155000
         LA    @10,S99RB                                           0121 00156000
         ST    @10,@AL00001                                        0121 00157000
         LA    @10,RETCODE                                         0121 00158000
         ST    @10,@AL00001+4                                      0121 00159000
         LA    @10,MSGRTN(,MSGPTR)                                 0121 00160000
         ST    @10,@AL00001+8                                      0121 00161000
         LA    @10,CALLERID                                        0121 00162000
         ST    @10,@AL00001+12                                     0121 00163000
         L     @10,MTCPPL(,MSGPTR)                                 0121 00164000
         ST    @10,@AL00001+16                                     0121 00165000
         LR    @15,R0                                              0121 00166000
         LA    @01,@AL00001                                        0121 00167000
         BALR  @14,@15                                             0121 00168000
*           GEN;                                                   0122 00169000
*                                   /* CHANGE BACK TO SCHEDULER KEY 1*/ 00170000
SETKEY1   MODESET EXTKEY=SCHED,RELATED=(KEY1,IKJEFF15(SETKEY0))         00171000
*           GEN(DELETE EP=IKJEFF18);                               0123 00172000
         DELETE EP=IKJEFF18                                             00173000
*           RFY                                                    0124 00174000
*             R0 UNRSTD;                                           0124 00175000
*           QUIT=ON;                                               0125 00176000
         OI    QUIT(HTPTR),B'10000000'                             0125 00177000
*         END;                                                     0126 00178000
*       ELSE                                                       0127 00179000
*         DO;                       /* ALLOCOK DO/END GROUP          */ 00180000
*                                                                  0127 00181000
         B     @RC00114                                            0127 00182000
@RF00114 DS    0H                                                  0128 00183000
*           /*********************************************************/ 00184000
*           /*                                                       */ 00185000
*           /* OPEN THE OUTPUT DATA SET (INTRDR D.S.)                */ 00186000
*           /*                                                       */ 00187000
*           /*********************************************************/ 00188000
*                                                                  0128 00189000
*           REENTACB(1:LENACB)=IRDRACB(1:LENACB);/* COPY ACB TO    0128 00190000
*                                      REENTRANT CORE                */ 00191000
         L     @10,LENACB                                          0128 00192000
         BCTR  @10,0                                               0128 00193000
         EX    @10,@SM00857                                        0128 00194000
*           RFY                                                    0129 00195000
*             R2 RESTRICTED;                                       0129 00196000
*           R2=ADDR(REENTACB);      /* GET ACB ADDRESS FOR OPEN      */ 00197000
         LA    R2,REENTACB                                         0130 00198000
*           RFY                                                    0131 00199000
*             IFGACB BASED(R2);     /* USE MAP MACRO FOR REENT ACB   */ 00200000
*           ACBDDNM=S99TUPAR(1:S99TULNG);/* PUT THE INTRDR'S DDNAME     00201000
*                                      INTO THE ACB                  */ 00202000
         MVI   ACBDDNM+1(R2),C' '                                  0132 00203000
         MVC   ACBDDNM+2(6,R2),ACBDDNM+1(R2)                       0132 00204000
         L     @10,TPRTDDN                                         0132 00205000
         LH    @07,S99TULNG(,@10)                                  0132 00206000
         BCTR  @07,0                                               0132 00207000
         EX    @07,@SM00859                                        0132 00208000
*           RENOPENL(1:LENOPEN)=OPENLIST(1:LENOPEN);/* COPY LIST FORM   00209000
*                                      OF OPEN MACRO TO REENTRANT  0133 00210000
*                                      CORE                          */ 00211000
         L     @10,LENOPEN                                         0133 00212000
         BCTR  @10,0                                               0133 00213000
         EX    @10,@SM00861                                        0133 00214000
*           RFY                                                    0134 00215000
*             R1 RSTD;                                             0134 00216000
*           R1=ADDR(RENOPENL);                                     0135 00217000
         LA    R1,RENOPENL                                         0135 00218000
*           GEN(OPEN  ((R2)),MF=(E,(R1)));/* OPEN THE ACB FOR INTRDR */ 00219000
         OPEN  ((R2)),MF=(E,(R1))                                       00220000
*           RFY                                                    0137 00221000
*             R1 UNRSTD;                                           0137 00222000
*           RFY                                                    0138 00223000
*             R15 RSTD;                                            0138 00224000
*                                                                  0138 00225000
*           /*********************************************************/ 00226000
*           /*                                                       */ 00227000
*           /* ERROR IF OPEN FAILED                                  */ 00228000
*           /*                                                       */ 00229000
*           /*********************************************************/ 00230000
*                                                                  0139 00231000
*           IF R15^=OPENRCOK THEN                                  0139 00232000
         LTR   R15,R15                                             0139 00233000
         BZ    @RF00139                                            0139 00234000
*             DO;                   /* ISSUE OPEN ERROR MESSAGE    0140 00235000
*                                      WHETHER OR NOT ACBOPEN BIT IS    00236000
*                                      ON                            */ 00237000
*               GFPARMS=GFPARMS&&GFPARMS;/* ZERO OUT VSAMFAIL      0141 00238000
*                                      PARAMETER LIST (GENERAL FAIL     00239000
*                                      LIST)                         */ 00240000
         XC    GFPARMS(44),GFPARMS                                 0141 00241000
*               GFCALLID=GFOPEN;    /* INDICATE OPEN MACRO FAILED    */ 00242000
         MVC   GFCALLID(2),@CH00549                                0142 00243000
*               CALL ACBERMSG;      /* ISSUE THE ERROR MESSAGE       */ 00244000
         BAL   @14,ACBERMSG                                        0143 00245000
*               RFY                                                0144 00246000
*                 R15 UNRSTD;                                      0144 00247000
*             END;                                                 0145 00248000
*           ELSE                                                   0146 00249000
*             DO;                   /* OPENOK DO/END GROUP           */ 00250000
*                                                                  0146 00251000
         B     @RC00139                                            0146 00252000
@RF00139 DS    0H                                                  0147 00253000
*               /*****************************************************/ 00254000
*               /*                                                   */ 00255000
*               /* NOW READ AND PROCESS INPUT DATA SETS (CALL        */ 00256000
*               /* IKJEFF05)                                         */ 00257000
*               /*                                                   */ 00258000
*               /*****************************************************/ 00259000
*                                                                  0147 00260000
*               CTACBPT=R2;         /* SAVE ADDRESS OF INTRDR'S ACB     00261000
*                                      (STAI RTN IKJEFF20 CHECKS IT) */ 00262000
         ST    R2,CTACBPT(,CONLIST)                                0147 00263000
*               REENTRPL(1:LENRPL)=IRDRRPL(1:LENRPL);/* COPY RPL TO     00264000
*                                      REENTRANT CORE                */ 00265000
         L     @10,LENRPL                                          0148 00266000
         BCTR  @10,0                                               0148 00267000
         EX    @10,@SM00863                                        0148 00268000
*               RFY                                                0149 00269000
*                 IFGRPL BASED(ADDR(REENTRPL));/* USE MAP MACRO FOR     00270000
*                                      REENT RPL                     */ 00271000
*               RPLDACB=R2;         /* PUT ADDRESS OF OPENED ACB INTO   00272000
*                                      RPL                           */ 00273000
         LA    @10,REENTRPL                                        0150 00274000
         ST    R2,RPLDACB(,@10)                                    0150 00275000
*               RPLID='C0'X;        /* SET ID SINCE RPL MACRO DOESN'T*/ 00276000
         MVI   RPLID(@10),X'C0'                                    0151 00277000
*               CTRPLPT=ADDR(REENTRPL);/* SAVE ADDRESS OF INTRDR'S 0152 00278000
*                                      RPL (IKJEFF12 USES FOR PUTS 0152 00279000
*                                      AND ENDREQS)                  */ 00280000
         ST    @10,CTRPLPT(,CONLIST)                               0152 00281000
*               RFY                                                0153 00282000
*                 R2 UNRESTRICTED;                                 0153 00283000
*               INOINIT=OFF;        /* EXITING FROM IKJEFF15         */ 00284000
         NI    INOINIT(HTPTR),B'11111110'                          0154 00285000
*               CALL IKJEFF05       /* GO TO SUBMIT READER MODULE    */ 00286000
*                   (CONTAB);       /* PASS SUBMIT CONTROL TABLE     */ 00287000
         ST    CONLIST,@AL00001                                    0155 00288000
         L     @15,@CV00069                                        0155 00289000
         LA    @01,@AL00001                                        0155 00290000
         BALR  @14,@15                                             0155 00291000
*               INOINIT=ON;         /* INDICATE IN IKJEFF15 NOW      */ 00292000
         OI    INOINIT(HTPTR),B'00000001'                          0156 00293000
*               HTCODE=CLOSCODE;    /* NOW WILL CLOSE THE INTRDR D.S.*/ 00294000
         MVI   HTCODE(HTPTR),X'04'                                 0157 00295000
*             END;                  /* OPENOK DO/END GROUP           */ 00296000
*         END;                      /* ALLOCOK DO/END GROUP          */ 00297000
@RC00139 DS    0H                                                  0160 00298000
*     END;                          /* DOALLOC DO/END GROUP        0160 00299000
*                                      (OPENCODE)                  0160 00300000
*                                                                    */ 00301000
@RC00114 DS    0H                                                  0161 00302000
*                                                                  0161 00303000
*   /*****************************************************************/ 00304000
*   /*                                                               */ 00305000
*   /* CLOSE THE INTRDR DATA SET                                     */ 00306000
*   /*                                                               */ 00307000
*   /*****************************************************************/ 00308000
*                                                                  0161 00309000
*   IF HTCODE=CLOSCODE THEN         /* THE STAI ROUTINE (IKJEFF20) 0161 00310000
*                                      AND THIS MODULE SET CLOSCODE  */ 00311000
@RF00094 CLI   HTCODE(HTPTR),4                                     0161 00312000
         BNE   @RF00161                                            0161 00313000
*     DO;                           /* DOCLOSE DO/END GROUP          */ 00314000
*       RFY                                                        0163 00315000
*        (R1,                                                      0163 00316000
*         R2) RESTRICTED;                                          0163 00317000
*       R2=CTACBPT;                 /* MUST GET ACB ADDRESS FROM   0164 00318000
*                                      CONTROL TABLE, NOT          0164 00319000
*                                      ADDR(REENTACB), SINCE STAI  0164 00320000
*                                      ROUTINE IKJEFF20 COULD CALL 0164 00321000
*                                      IKJEFF15 TO CLOSE ORIGINAL ACB*/ 00322000
         L     R2,CTACBPT(,CONLIST)                                0164 00323000
*       CTACBPT=ZEROADDR;           /* INDICATE CLOSE IS DONE (STAI     00324000
*                                      ROUTINE IKJEFF20 CHECKS THIS     00325000
*                                      FIELD AND DON'T WANT 20 TO  0165 00326000
*                                      RETRY CLOSE IF CLOSE ABENDS)  */ 00327000
         SLR   @10,@10                                             0165 00328000
         ST    @10,CTACBPT(,CONLIST)                               0165 00329000
*       RENOPENL(1:LENOPEN)=OPENLIST(1:LENOPEN);/* COPY LIST FORM OF    00330000
*                                      OPEN MACRO TO REENTRANT CORE  */ 00331000
         L     @10,LENOPEN                                         0166 00332000
         BCTR  @10,0                                               0166 00333000
         EX    @10,@SM00861                                        0166 00334000
*       R1=ADDR(RENOPENL);          /* CAN USE OPEN LIST FOR CLOSE   */ 00335000
         LA    R1,RENOPENL                                         0167 00336000
*       GEN(CLOSE ((R2)),MF=(E,(R1)));/* CLOSE THE ACB FOR INTRDR    */ 00337000
         CLOSE ((R2)),MF=(E,(R1))                                       00338000
*       RFY                                                        0169 00339000
*         R1 UNRESTRICTED;                                         0169 00340000
*       RFY                                                        0170 00341000
*         R15 RSTD;                                                0170 00342000
*                                                                  0170 00343000
*       /*************************************************************/ 00344000
*       /*                                                           */ 00345000
*       /* ERROR IF CLOSE FAILED                                     */ 00346000
*       /*                                                           */ 00347000
*       /*************************************************************/ 00348000
*                                                                  0171 00349000
*       IF R15^=CLOSRCOK THEN                                      0171 00350000
         LTR   R15,R15                                             0171 00351000
         BZ    @RF00171                                            0171 00352000
*         DO;                                                      0172 00353000
*           GFPARMS=GFPARMS&&GFPARMS;/* ZERO OUT VSAMFAIL PARAMETER     00354000
*                                      LIST (GENERAL FAIL LIST)      */ 00355000
         XC    GFPARMS(44),GFPARMS                                 0173 00356000
*           GFCALLID=GFCLOSE;       /* INDICATE A CLOSE MACRO FAILED */ 00357000
         MVC   GFCALLID(2),@CH00083                                0174 00358000
*           CALL ACBERMSG;          /* ISSUE THE ERROR MESSAGE       */ 00359000
         BAL   @14,ACBERMSG                                        0175 00360000
*           RFY                                                    0176 00361000
*            (R2,                                                  0176 00362000
*             R15) UNRSTD;                                         0176 00363000
*         END;                                                     0177 00364000
*     END;                          /* DOCLOSE DO/END GROUP        0178 00365000
*                                                                    */ 00366000
@RF00171 DS    0H                                                  0179 00367000
*                                                                  0179 00368000
*   /*****************************************************************/ 00369000
*   /*                                                               */ 00370000
*   /* ERROR IF INVALID ENTRY CODE                                   */ 00371000
*   /*                                                               */ 00372000
*   /*****************************************************************/ 00373000
*                                                                  0179 00374000
*   IF^(HTCODE=OPENCODE|HTCODE=CLOSCODE) THEN                      0179 00375000
@RF00161 CLI   HTCODE(HTPTR),1                                     0179 00376000
         BE    @RF00179                                            0179 00377000
         CLI   HTCODE(HTPTR),4                                     0179 00378000
         BE    @RF00179                                            0179 00379000
*     DO;                                                          0180 00380000
*       MSGID='12C';                /* MESSAGE FOR INVALID ENTRY CODE*/ 00381000
         MVI   MSGID+3(MSGPTR),C' '                                0181 00382000
         MVC   MSGID(3,MSGPTR),@CC00850                            0181 00383000
*       L1=ZEROLEN;                 /* DON'T INSERT A JOB NAME       */ 00384000
         MVI   L1(MSGPTR),X'00'                                    0182 00385000
*       L2=LENGTH(MODNAME);         /* INSERT THE MODULE NAME        */ 00386000
         MVI   L2(MSGPTR),X'08'                                    0183 00387000
*       VAR2=ADDR(MODNAME);                                        0184 00388000
         LA    @10,MODNAME                                         0184 00389000
         STCM  @10,7,VAR2(MSGPTR)                                  0184 00390000
*       RFY                                                        0185 00391000
*         R1 RSTD;                                                 0185 00392000
*       R1=ADDR(MSGTABLE);          /* PTR TO IKJEFF02'S PARAM LIST  */ 00393000
         LR    R1,MSGPTR                                           0186 00394000
*       CALL IKJEFF02;              /* ISSUE THE ERROR MESSAGE       */ 00395000
         L     @15,MSGRTN(,MSGPTR)                                 0187 00396000
         BALR  @14,@15                                             0187 00397000
*       RFY                                                        0188 00398000
*         R1 UNRSTD;                                               0188 00399000
*       QUIT=ON;                    /* INDICATE SUBMIT FAILED        */ 00400000
         OI    QUIT(HTPTR),B'10000000'                             0189 00401000
*     END;                                                         0190 00402000
*   INOINIT=OFF;                    /* INDICATE NOT IN IKJEFF15    0191 00403000
*                                                                    */ 00404000
@RF00179 NI    INOINIT(HTPTR),B'11111110'                          0191 00405000
*                                                                  0192 00406000
*   /*****************************************************************/ 00407000
*   /*                                                               */ 00408000
*   /* ACBERMSG INTERNAL PROCEDURE - CALLS IKJEFF19 TO ISSUE VSAMFAIL*/ 00409000
*   /* MESSAGE FOR OPEN OR CLOSE MACRO (CODE CALLING ACBERMSG MUST   */ 00410000
*   /* ZERO GFPARMS AND SET GFCALLID)                                */ 00411000
*   /*                                                               */ 00412000
*   /*****************************************************************/ 00413000
*                                                                  0192 00414000
*ACBERMSG:                                                         0192 00415000
*   PROC;                                                          0192 00416000
@EL00001 L     @13,4(,@13)                                         0192 00417000
@EF00001 L     @00,@SIZDATD                                        0192 00418000
         LR    @01,@11                                             0192 00419000
         FREEMAIN R,LV=(0),A=(1)                                        00420000
@ER00001 LM    @14,@12,12(@13)                                     0192 00421000
         BR    @14                                                 0192 00422000
@PB00001 DS    0H                                                  0192 00423000
ACBERMSG STM   @14,@12,@SA00002                                    0192 00424000
*   RFY                                                            0193 00425000
*    (R2,                                                          0193 00426000
*     R15) RSTD;                                                   0193 00427000
*   GFRCODE=R15;                    /* SAVE MACRO RETURN CODE        */ 00428000
         ST    R15,GFRCODE                                         0194 00429000
*   GFCBPTR=R2;                     /* ACB IS FAILING VSAM C.B.      */ 00430000
         ST    R2,GFCBPTR                                          0195 00431000
*   RFY                                                            0196 00432000
*    (R2,                                                          0196 00433000
*     R15) UNRSTD;                                                 0196 00434000
*   IF MTKEY1SW=ON THEN             /* IF RUNNING IN SCHEDULER KEY   */ 00435000
         TM    MTKEY1SW(MSGPTR),B'00001000'                        0197 00436000
         BNO   @RF00197                                            0197 00437000
*     GFKEYN08=ON;                  /* TELL IKJEFF19 TO DO MODESET   */ 00438000
         OI    GFKEYN08,B'10000000'                                0198 00439000
*   GF02PTR=ADDR(IKJEFF02);         /* HAVE ADDRESS OF MSG ISSUER    */ 00440000
@RF00197 L     @10,MSGRTN(,MSGPTR)                                 0199 00441000
         ST    @10,GF02PTR                                         0199 00442000
*   GFSUBSYS=ON;                    /* USING VSAM SUBSYSTEM INTERFACE*/ 00443000
         OI    GFSUBSYS,B'01000000'                                0200 00444000
*   GFCPPLP=MTCPPL;                 /* PASS PTR TO TMP'S CPPL C.B. 0201 00445000
*                                      (NEED FOR PUTLINE)            */ 00446000
         L     @10,MTCPPL(,MSGPTR)                                 0201 00447000
         ST    @10,GFCPPLP                                         0201 00448000
*   GFECBP=ECBPTR;                  /* USE SUBMIT-SUPPLIED ECB FOR 0202 00449000
*                                      PUTLINE                       */ 00450000
         L     @10,ECBPTR(,MSGPTR)                                 0202 00451000
         ST    @10,GFECBP                                          0202 00452000
*   GFDSNLEN=LENGTH(INTRDRDS);      /* PASS 'INTRDR' NAME TO IKJEFF19   00453000
*                                      FOR DATA SET NAME MSG INSERT  */ 00454000
         MVC   GFDSNLEN(2),@CH00549                                0203 00455000
*   GFDSNP=ADDR(INTRDRDS);                                         0204 00456000
         LA    @10,INTRDRDS                                        0204 00457000
         ST    @10,GFDSNP                                          0204 00458000
*   GFPGMNL=LENGTH(CTCMDNM);        /* WILL INSERT COMMAND NAME      */ 00459000
         MVC   GFPGMNL(2),@CH00042                                 0205 00460000
*   GFPGMNP=ADDR(CTCMDNM);                                         0206 00461000
*                                                                  0206 00462000
         LA    @10,CTCMDNM(,CONLIST)                               0206 00463000
         ST    @10,GFPGMNP                                         0206 00464000
*   /*****************************************************************/ 00465000
*   /*                                                               */ 00466000
*   /* CALL VSAMFAIL                                                 */ 00467000
*   /*                                                               */ 00468000
*   /*****************************************************************/ 00469000
*                                                                  0207 00470000
*   RFY                                                            0207 00471000
*     R0 RSTD;                                                     0207 00472000
*   GEN(LOAD  EP=IKJEFF19);         /* LOAD THE VSAMFAIL ROUTINE     */ 00473000
         LOAD  EP=IKJEFF19                                              00474000
*   CALL IKJEFF19(GFPARMS);         /* ISSUE THE ERROR MESSAGE       */ 00475000
         LA    @10,GFPARMS                                         0209 00476000
         ST    @10,@AL00001                                        0209 00477000
         LR    @15,R0                                              0209 00478000
         LA    @01,@AL00001                                        0209 00479000
         BALR  @14,@15                                             0209 00480000
*   GEN(DELETE EP=IKJEFF19);        /* DELETE THE VSAMFAIL MODULE    */ 00481000
         DELETE EP=IKJEFF19                                             00482000
*   RFY                                                            0211 00483000
*     R0 UNRSTD;                                                   0211 00484000
*   QUIT=ON;                        /* INDICATE SUBMIT FAILED        */ 00485000
         OI    QUIT(HTPTR),B'10000000'                             0212 00486000
*   END ACBERMSG;                                                  0213 00487000
@EL00002 DS    0H                                                  0213 00488000
@EF00002 DS    0H                                                  0213 00489000
@ER00002 LM    @14,@12,@SA00002                                    0213 00490000
         BR    @14                                                 0213 00491000
*   END IKJEFF15                    /* QUIT SWITCH ON IF ERROR IN 15    00492000
*                                                                    */ 00493000
*                                                                  0214 00494000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00495000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */ 00496000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */ 00497000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 00498000
*/*%INCLUDE SYSLIB  (IFGACBVT)                                       */ 00499000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 00500000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                       */ 00501000
*/*%INCLUDE SYSLIB  (IKJEFFCT)                                       */ 00502000
*/*%INCLUDE SYSLIB  (IKJEFFDF)                                       */ 00503000
*/*%INCLUDE SYSLIB  (IKJEFFGF)                                       */ 00504000
*/*%INCLUDE SYSLIB  (IKJEFFHT)                                       */ 00505000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                       */ 00506000
*                                                                  0214 00507000
*       ;                                                          0214 00508000
@DATA    DS    0H                                                       00509000
@CH00083 DC    H'2'                                                     00510000
@CH00549 DC    H'6'                                                     00511000
@CH00042 DC    H'8'                                                     00512000
@SM00857 MVC   REENTACB(0),IRDRACB                                      00513000
@SM00859 MVC   ACBDDNM(0,R2),S99TUPAR(@10)                              00514000
@SM00861 MVC   RENOPENL(0),OPENLIST                                     00515000
@SM00863 MVC   REENTRPL(0),IRDRRPL                                      00516000
@DATD    DSECT                                                          00517000
         DS    0F                                                       00518000
@SA00001 DS    18F                                                      00519000
@PC00001 DS    1F                                                       00520000
@SA00002 DS    15F                                                      00521000
@AL00001 DS    5A                                                       00522000
IKJEFF15 CSECT                                                          00523000
         DS    0F                                                       00524000
@DATD    DSECT                                                          00525000
         DS    0D                                                       00526000
RETCODE  DS    F                                                        00527000
S99RBPTR DS    AL4                                                      00528000
         ORG   S99RBPTR                                                 00529000
S99RBPND DS    BL1                                                      00530000
         ORG   S99RBPTR+4                                               00531000
S99RB    DS    CL20                                                     00532000
         ORG   S99RB                                                    00533000
S99RBLN  DS    CL1                                                      00534000
S99VERB  DS    CL1                                                      00535000
S99FLAG1 DS    CL2                                                      00536000
         ORG   S99FLAG1                                                 00537000
S99FLG11 DS    CL1                                                      00538000
         ORG   S99FLG11                                                 00539000
S99ONCNV DS    BL1                                                      00540000
S99NOCNV EQU   S99FLG11+0                                               00541000
S99NOMNT EQU   S99FLG11+0                                               00542000
         ORG   S99FLAG1+1                                               00543000
S99FLG12 DS    CL1                                                      00544000
         ORG   S99RB+4                                                  00545000
S99RSC   DS    CL4                                                      00546000
         ORG   S99RSC                                                   00547000
S99ERROR DS    CL2                                                      00548000
S99INFO  DS    CL2                                                      00549000
         ORG   S99RB+8                                                  00550000
S99TXTPP DS    AL4                                                      00551000
S99RSV01 DS    FL4                                                      00552000
S99FLAG2 DS    CL4                                                      00553000
         ORG   S99FLAG2                                                 00554000
S99FLG21 DS    CL1                                                      00555000
         ORG   S99FLG21                                                 00556000
S99WTVOL DS    BL1                                                      00557000
S99WTDSN EQU   S99FLG21+0                                               00558000
S99NORES EQU   S99FLG21+0                                               00559000
S99WTUNT EQU   S99FLG21+0                                               00560000
S99OFFLN EQU   S99FLG21+0                                               00561000
S99TIONQ EQU   S99FLG21+0                                               00562000
S99CATLG EQU   S99FLG21+0                                               00563000
S99MOUNT EQU   S99FLG21+0                                               00564000
         ORG   S99FLAG2+1                                               00565000
S99FLG22 DS    CL1                                                      00566000
S99FLG23 DS    CL1                                                      00567000
S99FLG24 DS    CL1                                                      00568000
         ORG   S99RB+20                                                 00569000
GFPARMS  DS    CL44                                                     00570000
         ORG   GFPARMS                                                  00571000
GFCBPTR  DS    AL4                                                      00572000
GFRCODE  DS    FL4                                                      00573000
GF02PTR  DS    AL4                                                      00574000
GFCALLID DS    FL2                                                      00575000
GFBITS   DS    BL1                                                      00576000
         ORG   GFBITS                                                   00577000
GFKEYN08 DS    BL1                                                      00578000
GFSUBSYS EQU   GFBITS+0                                                 00579000
GFWTPSW  EQU   GFBITS+0                                                 00580000
@NM00014 EQU   GFBITS+0                                                 00581000
         ORG   GFPARMS+15                                               00582000
@NM00015 DS    AL1                                                      00583000
GFCPPLP  DS    AL4                                                      00584000
GFECBP   DS    AL4                                                      00585000
GFDSNLEN DS    FL2                                                      00586000
GFPGMNL  DS    FL2                                                      00587000
GFDSNP   DS    AL4                                                      00588000
GFPGMNP  DS    AL4                                                      00589000
@NM00016 DS    AL4                                                      00590000
@NM00017 DS    AL4                                                      00591000
         ORG   GFPARMS+44                                               00592000
TXTPLIST DS    CL16                                                     00593000
         ORG   TXTPLIST                                                 00594000
TPSPGNM  DS    AL4                                                      00595000
TPSYSOU  DS    AL4                                                      00596000
TPCLOSE  DS    AL4                                                      00597000
TPRTDDN  DS    AL4                                                      00598000
         ORG   TPRTDDN                                                  00599000
TPEND    DS    BL1                                                      00600000
         ORG   TXTPLIST+16                                              00601000
ALLOCTXT DS    CL34                                                     00602000
         ORG   ALLOCTXT                                                 00603000
RENSPGNM DS    CL12                                                     00604000
RENSYSOU DS    CL4                                                      00605000
RENCLOSE DS    CL4                                                      00606000
RENRTDDN DS    CL14                                                     00607000
         ORG   ALLOCTXT+34                                              00608000
IKJEFF15 CSECT                                                          00609000
         DS    0F                                                       00610000
@SIZDATD DC    AL1(0)                                                   00611000
         DC    AL3(@ENDDATD-@DATD)                                      00612000
@CV00069 DC    V(IKJEFF05)                                              00613000
         DS    0D                                                       00614000
CALLERID DC    H'50'                                                    00615000
@CC00850 DC    C'12C'                                                   00616000
MODNAME  DC    CL8'IKJEFF15'                                            00617000
PATCH    DS    CL51                                                     00618000
         ORG   PATCH                                                    00619000
PTCHINIT DC    17CL3'ZAP'                                               00620000
         ORG   PATCH+51                                                 00621000
NRTEXT   DS    CL34                                                     00622000
         ORG   NRTEXT                                                   00623000
TXTSPGNM DS    CL12                                                     00624000
         ORG   TXTSPGNM                                                 00625000
@NM00033 DC    X'0019'                                                  00626000
@NM00034 DC    AL2(1)                                                   00627000
@NM00035 DC    AL2(6)                                                   00628000
INTRDRDS DC    CL6'INTRDR'                                              00629000
         ORG   NRTEXT+12                                                00630000
TXTSYSOU DS    CL4                                                      00631000
         ORG   TXTSYSOU                                                 00632000
@NM00036 DC    X'0018'                                                  00633000
@NM00037 DC    AL2(0)                                                   00634000
         ORG   NRTEXT+16                                                00635000
TXTCLOSE DS    CL4                                                      00636000
         ORG   TXTCLOSE                                                 00637000
@NM00038 DC    X'001C'                                                  00638000
@NM00039 DC    AL2(0)                                                   00639000
         ORG   NRTEXT+20                                                00640000
TXTRTDDN DS    CL14                                                     00641000
         ORG   TXTRTDDN                                                 00642000
@NM00040 DC    X'0055'                                                  00643000
@NM00041 DC    AL2(1)                                                   00644000
@NM00042 DC    AL2(8)                                                   00645000
@NM00043 DC    CL8'        '                                            00646000
         ORG   NRTEXT+34                                                00647000
IKJEFF15 CSECT                                                          00648000
*********************************************************************** 00649000
*********************************************************************** 00650000
IRDRACB  ACB   DDNAME=WILLCHNG,MACRF=(ADR,SEQ,OUT)                      00651000
*              - GET DDNAME FROM DYNAMIC ALLOCATION OF INTRDR D.S.      00652000
*              - ADR = ADDRESSED DATA ACCESSING, NO INDEX REFERENCES    00653000
*              - SEQ = SEQUENTIAL PROCESSING (IMPLIES USE OF POINT      00654000
*                      ONLY FOR VSAM, NOT SDI)                          00655000
*              - OUT = WRITE DATA                                       00656000
ENDACB   EQU   *                        *USE TO COMPUTE LENGTH OF ACB   00657000
LENACB   DC    A(ENDACB-IRDRACB)        *LENGTH OF ACB                  00658000
*********************************************************************** 00659000
*********************************************************************** 00660000
IRDRRPL  RPL   OPTCD=(ADR,SEQ,SYN,NUP),RECLEN=80                        00661000
*              ****************************************************     00662000
*              **   RPL IS USED FOR PUTS AND ENDREQS TO INTRDR   **     00663000
*              ****************************************************     00664000
*              - ADR, SEQ HAVE SAME MEANING AS FOR ACB                  00665000
*              - SYN = SYNCHRONOUS REQUEST.  RETURN CONTROL AFTER       00666000
*                      COMPLETION OF THIS REQUEST.                      00667000
*              - NUP = NONUPDATE MODE.  PUT RECORDS AT END OF D.S.      00668000
*              - RECLEN = 80.  LENGTH OF SUBMITTED JCL RECORD.          00669000
*              - WILL LATER SPECIFY THE ACB ADDRESS, AND ADDRESS OF     00670000
*                      JCL RECORD.                                      00671000
ENDRPL   EQU   *                        *USE TO COMPUTE LENGTH OF RPL   00672000
LENRPL   DC    A(ENDRPL-IRDRRPL)        *LENGTH OF RPL                  00673000
*********************************************************************** 00674000
*********************************************************************** 00675000
OPENLIST OPEN  (R2),MF=L                *FOR OPENING THE INTRDR         00676000
ENDOPENL EQU   *                        *USE TO COMPUTE LENGTH OF OPENL 00677000
LENOPEN  DC    A(ENDOPENL-OPENLIST)     *LENGTH OF OPENLIST             00678000
*********************************************************************** 00679000
*********************************************************************** 00680000
@DATD    DSECT                                                          00681000
REENTACB DS    0F                    NEED FULLWORD BOUNDARY             00682000
         DS    CL(ENDACB-IRDRACB)    WILL COPY ACB HERE                 00683000
REENTRPL DS    0F                    FULLWORD BOUNDARY                  00684000
         DS    CL(ENDRPL-IRDRRPL)    WILL COPY RPL HERE                 00685000
RENOPENL DS    0F                    FULLWORD BOUNDARY                  00686000
         DS    CL(ENDOPENL-OPENLIST) WILL COPY LIST FORM OF OPEN HERE   00687000
@DATD    DSECT                                                          00688000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00689000
@ENDDATD EQU   *                                                        00690000
IKJEFF15 CSECT                                                          00691000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00692000
@01      EQU   01                                                       00693000
@02      EQU   02                                                       00694000
@03      EQU   03                                                       00695000
@04      EQU   04                                                       00696000
@05      EQU   05                                                       00697000
@06      EQU   06                                                       00698000
@07      EQU   07                                                       00699000
@08      EQU   08                                                       00700000
@09      EQU   09                                                       00701000
@10      EQU   10                                                       00702000
@11      EQU   11                                                       00703000
@12      EQU   12                                                       00704000
@13      EQU   13                                                       00705000
@14      EQU   14                                                       00706000
@15      EQU   15                                                       00707000
MSGPTR   EQU   @05                                                      00708000
HTPTR    EQU   @04                                                      00709000
CONLIST  EQU   @06                                                      00710000
R0       EQU   @00                                                      00711000
R1       EQU   @01                                                      00712000
R2       EQU   @02                                                      00713000
R15      EQU   @15                                                      00714000
IKJEFF02 EQU   0                                                        00715000
IKJEFF18 EQU   0                                                        00716000
IKJEFF19 EQU   0                                                        00717000
CPPL     EQU   0                                                        00718000
S99TUP   EQU   0                                                        00719000
S99TUPL  EQU   0                                                        00720000
S99TUPTR EQU   S99TUPL                                                  00721000
S99TUNIT EQU   0                                                        00722000
S99TUKEY EQU   S99TUNIT                                                 00723000
S99TUNUM EQU   S99TUNIT+2                                               00724000
S99TUENT EQU   S99TUNIT+4                                               00725000
S99TULNG EQU   S99TUENT                                                 00726000
S99TUPAR EQU   S99TUENT+2                                               00727000
S99TUFLD EQU   0                                                        00728000
IFGACB   EQU   0                                                        00729000
ACBCOMN  EQU   IFGACB                                                   00730000
ACBLENG  EQU   ACBCOMN+2                                                00731000
ACBLENG2 EQU   ACBLENG                                                  00732000
ACBAMBL  EQU   ACBCOMN+4                                                00733000
ACBIXLST EQU   ACBAMBL                                                  00734000
ACBJWA   EQU   ACBIXLST                                                 00735000
ACBMACRF EQU   ACBCOMN+12                                               00736000
ACBMACR1 EQU   ACBMACRF                                                 00737000
ACBADR   EQU   ACBMACR1                                                 00738000
ACBCNV   EQU   ACBMACR1                                                 00739000
ACBMACR2 EQU   ACBMACRF+1                                               00740000
ACBLFB   EQU   ACBCOMN+20                                               00741000
ACBBUFPL EQU   ACBLFB                                                   00742000
ACBRECFM EQU   ACBCOMN+24                                               00743000
ACBCCTYP EQU   ACBCOMN+25                                               00744000
ACBOPT   EQU   ACBCOMN+26                                               00745000
ACBDSORG EQU   ACBOPT                                                   00746000
ACBCROPS EQU   ACBDSORG                                                 00747000
ACBEXLST EQU   ACBCOMN+36                                               00748000
ACBDDNM  EQU   ACBCOMN+40                                               00749000
ACBAMETH EQU   ACBDDNM+3                                                00750000
ACBOFLGS EQU   ACBCOMN+48                                               00751000
ACBEXFG  EQU   ACBOFLGS                                                 00752000
ACBIOSFG EQU   ACBOFLGS                                                 00753000
ACBINFLG EQU   ACBCOMN+50                                               00754000
ACBUJFCB EQU   ACBCOMN+52                                               00755000
ACBWAPTR EQU   ACBUJFCB                                                 00756000
IFGRPL   EQU   0                                                        00757000
RPLCOMN  EQU   IFGRPL                                                   00758000
RPLIDWD  EQU   RPLCOMN                                                  00759000
RPLID    EQU   RPLIDWD                                                  00760000
RPLLEN   EQU   RPLIDWD+3                                                00761000
RPLECB   EQU   RPLCOMN+8                                                00762000
RPLFDBK  EQU   RPLCOMN+13                                               00763000
RPLRTNCD EQU   RPLFDBK                                                  00764000
RPLCNDCD EQU   RPLFDBK+1                                                00765000
RPLCMPON EQU   RPLCNDCD                                                 00766000
RPLERRCD EQU   RPLCNDCD+1                                               00767000
RPLKEYLE EQU   RPLCOMN+16                                               00768000
RPLDACB  EQU   RPLCOMN+24                                               00769000
RPLARG   EQU   RPLCOMN+36                                               00770000
RPLOPTCD EQU   RPLCOMN+40                                               00771000
RPLOPT1  EQU   RPLOPTCD                                                 00772000
RPLECBSW EQU   RPLOPT1                                                  00773000
RPLOPT2  EQU   RPLOPTCD+1                                               00774000
RPLADR   EQU   RPLOPT2                                                  00775000
RPLOPT3  EQU   RPLOPTCD+2                                               00776000
RPLNXTRP EQU   RPLCOMN+44                                               00777000
RPLOPTC2 EQU   RPLCOMN+56                                               00778000
RPLOPT5  EQU   RPLOPTC2                                                 00779000
RPLWRTYP EQU   RPLOPT5                                                  00780000
RPLOPT6  EQU   RPLOPTC2+1                                               00781000
RPLUNTYP EQU   RPLOPT6                                                  00782000
RPLOPT7  EQU   RPLOPTC2+2                                               00783000
RPLCNOPT EQU   RPLOPT7                                                  00784000
RPLOPT8  EQU   RPLOPTC2+3                                               00785000
RPLRBAR  EQU   RPLCOMN+60                                               00786000
RPL6RBA  EQU   RPLRBAR+2                                                00787000
RPLEXTDS EQU   RPLCOMN+68                                               00788000
RPLEXTD1 EQU   RPLEXTDS                                                 00789000
CONTAB   EQU   0                                                        00790000
HISTPT   EQU   CONTAB+24                                                00791000
MSGLISPT EQU   CONTAB+36                                                00792000
CTRPLPT  EQU   CONTAB+68                                                00793000
CTACBPT  EQU   CONTAB+72                                                00794000
CTCMDNM  EQU   CONTAB+76                                                00795000
DFPARMS  EQU   0                                                        00796000
DFS99RBP EQU   DFPARMS                                                  00797000
DFRCP    EQU   DFPARMS+4                                                00798000
DFJEFF02 EQU   DFPARMS+8                                                00799000
DFIDP    EQU   DFPARMS+12                                               00800000
DFID     EQU   0                                                        00801000
@NM00012 EQU   DFID                                                     00802000
HISTORY  EQU   0                                                        00803000
WHATMOD  EQU   HISTORY+12                                               00804000
INOINIT  EQU   WHATMOD+3                                                00805000
JCLSWITS EQU   HISTORY+16                                               00806000
PRIORJCL EQU   JCLSWITS                                                 00807000
PVERB    EQU   PRIORJCL                                                 00808000
PDTYPE   EQU   PRIORJCL+2                                               00809000
PMISC    EQU   PRIORJCL+3                                               00810000
CURRJCL  EQU   JCLSWITS+4                                               00811000
CVERB    EQU   CURRJCL                                                  00812000
CDTYPE   EQU   CURRJCL+2                                                00813000
CMISC    EQU   CURRJCL+3                                                00814000
STATICSW EQU   HISTORY+24                                               00815000
GENL     EQU   STATICSW                                                 00816000
QUIT     EQU   GENL                                                     00817000
TAKEXITS EQU   STATICSW+1                                               00818000
CODEFLD  EQU   STATICSW+3                                               00819000
HTCODE   EQU   CODEFLD                                                  00820000
DLMONJCL EQU   HISTORY+32                                               00821000
HTSWITCH EQU   HISTORY+34                                               00822000
HTACCNTP EQU   HISTORY+40                                               00823000
MSGTABLE EQU   0                                                        00824000
TMCTPTR  EQU   MSGTABLE+4                                               00825000
MTCPPL   EQU   TMCTPTR                                                  00826000
ECBPTR   EQU   MSGTABLE+8                                               00827000
@NM00028 EQU   MSGTABLE+12                                              00828000
SW       EQU   MSGTABLE+20                                              00829000
MTKEY1SW EQU   SW                                                       00830000
RETMSG   EQU   MSGTABLE+21                                              00831000
SW2      EQU   MSGTABLE+24                                              00832000
MSGID    EQU   MSGTABLE+40                                              00833000
MTINSRTS EQU   MSGTABLE+44                                              00834000
L1       EQU   MTINSRTS                                                 00835000
L2       EQU   MTINSRTS+4                                               00836000
VAR2     EQU   MTINSRTS+5                                               00837000
L3       EQU   MTINSRTS+8                                               00838000
L4       EQU   MTINSRTS+12                                              00839000
MSGRTN   EQU   MSGTABLE+60                                              00840000
RET      EQU   0                                                        00841000
DFMSGWTP EQU   0                                                        00842000
DFRC     EQU   0                                                        00843000
HTACCNTI EQU   0                                                        00844000
MSGECB   EQU   0                                                        00845000
MSGTMCT  EQU   0                                                        00846000
CTLTAB   EQU   0                                                        00847000
S99TUFP  EQU   S99TUP                                                   00848000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00849000
RETCHAR  EQU   RET+2                                                    00850000
RETSIZE  EQU   RET                                                      00851000
VAR4     EQU   MTINSRTS+13                                              00852000
HIGHL4   EQU   L4                                                       00853000
VAR3     EQU   MTINSRTS+9                                               00854000
HIGHL3   EQU   L3                                                       00855000
HIGHL2   EQU   L2                                                       00856000
VAR1     EQU   MTINSRTS+1                                               00857000
HIGHL1   EQU   L1                                                       00858000
@NM00032 EQU   MSGTABLE+36                                              00859000
@NM00031 EQU   MSGTABLE+32                                              00860000
MTOLDPTR EQU   MSGTABLE+28                                              00861000
@NM00030 EQU   MSGTABLE+25                                              00862000
@NM00029 EQU   SW2                                                      00863000
MTDOMSW  EQU   SW2                                                      00864000
MT2OLDSW EQU   SW2                                                      00865000
MTNHEXSW EQU   SW                                                       00866000
MTWTPSW  EQU   SW                                                       00867000
MTJOBISW EQU   SW                                                       00868000
MTHEXSW  EQU   SW                                                       00869000
MTWTOSW  EQU   SW                                                       00870000
MTPUTLSW EQU   SW                                                       00871000
MTNOIDSW EQU   SW                                                       00872000
MSGCSECT EQU   MSGTABLE+16                                              00873000
MTHIGH   EQU   @NM00028                                                 00874000
LISTPTR  EQU   MSGTABLE                                                 00875000
@NM00027 EQU   HISTORY+50                                               00876000
HTACNTC2 EQU   HISTORY+48                                               00877000
HTACNTC1 EQU   HISTORY+46                                               00878000
HTACCNTL EQU   HISTORY+44                                               00879000
@NM00026 EQU   HISTORY+36                                               00880000
@NM00025 EQU   HISTORY+35                                               00881000
@NM00024 EQU   HTSWITCH                                                 00882000
HTDLMSW  EQU   HTSWITCH                                                 00883000
HTDLM    EQU   DLMONJCL                                                 00884000
@NM00023 EQU   HISTORY+28                                               00885000
OPOFF    EQU   STATICSW+2                                               00886000
@NM00022 EQU   TAKEXITS                                                 00887000
COMNTX   EQU   TAKEXITS                                                 00888000
JESX     EQU   TAKEXITS                                                 00889000
NULLX    EQU   TAKEXITS                                                 00890000
CMDX     EQU   TAKEXITS                                                 00891000
DDX      EQU   TAKEXITS                                                 00892000
EXECX    EQU   TAKEXITS                                                 00893000
JOBX     EQU   TAKEXITS                                                 00894000
NONOTIFY EQU   GENL                                                     00895000
FIRST    EQU   GENL                                                     00896000
FLUSH    EQU   GENL                                                     00897000
CDLMFND  EQU   CMISC                                                    00898000
CNOTHING EQU   CMISC                                                    00899000
CCOMCON  EQU   CMISC                                                    00900000
CVERBCOP EQU   CMISC                                                    00901000
CNAME    EQU   CMISC                                                    00902000
CCONERR  EQU   CMISC                                                    00903000
COPCONEX EQU   CMISC                                                    00904000
CCONEX   EQU   CMISC                                                    00905000
CDDDATA  EQU   CDTYPE                                                   00906000
CDDAST   EQU   CDTYPE                                                   00907000
@NM00021 EQU   CVERB+1                                                  00908000
@NM00020 EQU   CVERB+1                                                  00909000
CJES     EQU   CVERB+1                                                  00910000
CCOMMENT EQU   CVERB                                                    00911000
CCOMMAND EQU   CVERB                                                    00912000
CDD      EQU   CVERB                                                    00913000
CEXEC    EQU   CVERB                                                    00914000
CJOB     EQU   CVERB                                                    00915000
CNULL    EQU   CVERB                                                    00916000
CDATA    EQU   CVERB                                                    00917000
CDELIM   EQU   CVERB                                                    00918000
PDLMFND  EQU   PMISC                                                    00919000
PNOTHING EQU   PMISC                                                    00920000
PCOMCON  EQU   PMISC                                                    00921000
PVERBCOP EQU   PMISC                                                    00922000
PNAME    EQU   PMISC                                                    00923000
PCONERR  EQU   PMISC                                                    00924000
POPCONEX EQU   PMISC                                                    00925000
PCONEX   EQU   PMISC                                                    00926000
PDDDATA  EQU   PDTYPE                                                   00927000
PDDAST   EQU   PDTYPE                                                   00928000
@NM00019 EQU   PVERB+1                                                  00929000
@NM00018 EQU   PVERB+1                                                  00930000
PJES     EQU   PVERB+1                                                  00931000
PCOMMENT EQU   PVERB                                                    00932000
PCOMMAND EQU   PVERB                                                    00933000
PDD      EQU   PVERB                                                    00934000
PEXEC    EQU   PVERB                                                    00935000
PJOB     EQU   PVERB                                                    00936000
PNULL    EQU   PVERB                                                    00937000
PDATA    EQU   PVERB                                                    00938000
PDELIM   EQU   PVERB                                                    00939000
INCOMPIN EQU   WHATMOD+3                                                00940000
INMSG    EQU   WHATMOD+3                                                00941000
INDAIRIN EQU   WHATMOD+3                                                00942000
INWRMGR  EQU   WHATMOD+3                                                00943000
INEXIT   EQU   WHATMOD+3                                                00944000
INIDENT  EQU   WHATMOD+3                                                00945000
INREAD   EQU   WHATMOD+3                                                00946000
INGEN    EQU   WHATMOD+2                                                00947000
INPROMPT EQU   WHATMOD+1                                                00948000
INCONTRL EQU   WHATMOD                                                  00949000
SUBTAB   EQU   HISTORY                                                  00950000
IDNUM    EQU   DFID+1                                                   00951000
@NM00013 EQU   @NM00012                                                 00952000
DFWTP    EQU   @NM00012                                                 00953000
DFCPPLP  EQU   DFPARMS+16                                               00954000
DFDAPLP  EQU   DFS99RBP                                                 00955000
CTIDLN   EQU   CONTAB+84                                                00956000
INITSAVE EQU   CONTAB+64                                                00957000
COMECBPT EQU   CONTAB+60                                                00958000
DDPTR    EQU   CONTAB+56                                                00959000
EXITAD   EQU   CONTAB+52                                                00960000
EXWORD   EQU   CONTAB+48                                                00961000
TMCTPT   EQU   CONTAB+44                                                00962000
USERIDPT EQU   CONTAB+40                                                00963000
JOBNAMPT EQU   CONTAB+32                                                00964000
CTNDSNPT EQU   CONTAB+28                                                00965000
CLOSERPT EQU   CONTAB+20                                                00966000
STMTPT   EQU   CONTAB+16                                                00967000
CONTABPT EQU   CONTAB+12                                                00968000
TABID    EQU   CONTAB                                                   00969000
RPLERMSA EQU   RPLCOMN+72                                               00970000
RPLEMLEN EQU   RPLCOMN+70                                               00971000
RPLACTIV EQU   RPLCOMN+69                                               00972000
RPLBRANC EQU   RPLEXTD1                                                 00973000
RPLNIB   EQU   RPLEXTD1                                                 00974000
RPLGVNT  EQU   RPLEXTD1                                                 00975000
RPLLVNT  EQU   RPLEXTD1                                                 00976000
RPLEXIT  EQU   RPLEXTD1                                                 00977000
RPLNEXIT EQU   RPLEXTD1                                                 00978000
RPLEXSCH EQU   RPLEXTD1                                                 00979000
RPLDDDD  EQU   RPL6RBA+2                                                00980000
RPLS2S2  EQU   RPL6RBA                                                  00981000
RPLS1S1  EQU   RPLRBAR                                                  00982000
RPLRSV88 EQU   RPLOPT8                                                  00983000
RPLUNCON EQU   RPLOPT8                                                  00984000
RPLACTV  EQU   RPLOPT8                                                  00985000
RPLSESS  EQU   RPLOPT8                                                  00986000
RPLPEND  EQU   RPLOPT8                                                  00987000
RPLODPRM EQU   RPLOPT8                                                  00988000
RPLODACP EQU   RPLOPT8                                                  00989000
RPLODACQ EQU   RPLOPT8                                                  00990000
RPLRSV78 EQU   RPLOPT7                                                  00991000
RPLRSV77 EQU   RPLOPT7                                                  00992000
RPLRLSOP EQU   RPLOPT7                                                  00993000
RPLRSV75 EQU   RPLOPT7                                                  00994000
RPLQOPT  EQU   RPLOPT7                                                  00995000
RPLCNIMM EQU   RPLCNOPT                                                 00996000
RPLCNANY EQU   RPLCNOPT                                                 00997000
RPLCNALL EQU   RPLCNOPT                                                 00998000
RPLRSV68 EQU   RPLOPT6                                                  00999000
RPLRSV67 EQU   RPLOPT6                                                  01000000
RPLLOCK  EQU   RPLOPT6                                                  01001000
RPLNCOND EQU   RPLOPT6                                                  01002000
RPLCOND  EQU   RPLOPT6                                                  01003000
RPLEOT   EQU   RPLUNTYP                                                 01004000
RPLEOM   EQU   RPLUNTYP                                                 01005000
RPLEOB   EQU   RPLUNTYP                                                 01006000
RPLWROPT EQU   RPLOPT5                                                  01007000
RPLNODE  EQU   RPLOPT5                                                  01008000
RPLERACE EQU   RPLWRTYP                                                 01009000
RPLEAU   EQU   RPLWRTYP                                                 01010000
RPLNERAS EQU   RPLWRTYP                                                 01011000
RPLPSOPT EQU   RPLOPT5                                                  01012000
RPLSSNIN EQU   RPLOPT5                                                  01013000
RPLDLGIN EQU   RPLOPT5                                                  01014000
RPLBUFL  EQU   RPLCOMN+52                                               01015000
RPLRLEN  EQU   RPLCOMN+48                                               01016000
RPLCHAIN EQU   RPLNXTRP                                                 01017000
RPLOPT4  EQU   RPLOPTCD+3                                               01018000
RPLALIGN EQU   RPLOPT3                                                  01019000
RPLFMT   EQU   RPLOPT3                                                  01020000
RPLFLD   EQU   RPLOPT3                                                  01021000
RPLVFY   EQU   RPLOPT3                                                  01022000
RPLBLK   EQU   RPLOPT3                                                  01023000
RPLSFORM EQU   RPLOPT3                                                  01024000
RPLEODS  EQU   RPLOPT3                                                  01025000
RPLNSP   EQU   RPLOPT2                                                  01026000
RPLUPD   EQU   RPLOPT2                                                  01027000
@NM00011 EQU   RPLOPT2                                                  01028000
RPLCNV   EQU   RPLOPT2                                                  01029000
RPLADD   EQU   RPLADR                                                   01030000
RPLKEY   EQU   RPLOPT2                                                  01031000
RPLECBIN EQU   RPLECBSW                                                 01032000
RPLGEN   EQU   RPLOPT1                                                  01033000
RPLKGE   EQU   RPLOPT1                                                  01034000
RPLASY   EQU   RPLOPT1                                                  01035000
RPLSKP   EQU   RPLOPT1                                                  01036000
RPLSEQ   EQU   RPLOPT1                                                  01037000
RPLDIR   EQU   RPLOPT1                                                  01038000
RPLLOC   EQU   RPLOPT1                                                  01039000
RPLDAF   EQU   RPLARG+2                                                 01040000
RPLSAF   EQU   RPLARG                                                   01041000
RPLAREA  EQU   RPLCOMN+32                                               01042000
RPLTCBPT EQU   RPLCOMN+28                                               01043000
RPLCCHAR EQU   RPLCOMN+20                                               01044000
RPLSTRID EQU   RPLCOMN+18                                               01045000
RPLKEYL  EQU   RPLKEYLE                                                 01046000
RPLFDB3  EQU   RPLERRCD                                                 01047000
RPLFDB2  EQU   RPLCMPON                                                 01048000
RPLERREG EQU   RPLRTNCD                                                 01049000
RPLSTAT  EQU   RPLCOMN+12                                               01050000
RPLPOST  EQU   RPLECB                                                   01051000
RPLWAIT  EQU   RPLECB                                                   01052000
RPLPLHPT EQU   RPLCOMN+4                                                01053000
RPLLEN2  EQU   RPLLEN                                                   01054000
RPLREQ   EQU   RPLIDWD+2                                                01055000
RPLSTYP  EQU   RPLIDWD+1                                                01056000
ACBAPID  EQU   ACBCOMN+72                                               01057000
ACBCBMWA EQU   ACBCOMN+68                                               01058000
ACBUAPTR EQU   ACBCOMN+64                                               01059000
ACBLRECL EQU   ACBCOMN+62                                               01060000
ACBBLKSZ EQU   ACBCOMN+60                                               01061000
ACBBUFSP EQU   ACBCOMN+56                                               01062000
@NM00010 EQU   ACBWAPTR+1                                               01063000
ACBOPTN  EQU   ACBWAPTR                                                 01064000
ACBCAT   EQU   ACBINFLG                                                 01065000
ACBIJRQE EQU   ACBINFLG                                                 01066000
ACBJEPS  EQU   ACBINFLG                                                 01067000
@NM00009 EQU   ACBINFLG                                                 01068000
ACBERFLG EQU   ACBCOMN+49                                               01069000
ACBBUSY  EQU   ACBIOSFG                                                 01070000
ACBLOCK  EQU   ACBEXFG                                                  01071000
@NM00008 EQU   ACBOFLGS                                                 01072000
ACBDSERR EQU   ACBOFLGS                                                 01073000
ACBOPEN  EQU   ACBOFLGS                                                 01074000
ACBEOV   EQU   ACBOFLGS                                                 01075000
@NM00007 EQU   ACBOFLGS                                                 01076000
ACBDEB   EQU   ACBDDNM+5                                                01077000
ACBERFL  EQU   ACBDDNM+4                                                01078000
ACBAM    EQU   ACBAMETH                                                 01079000
ACBINFL  EQU   ACBDDNM+2                                                01080000
ACBTIOT  EQU   ACBDDNM                                                  01081000
ACBUEL   EQU   ACBEXLST                                                 01082000
ACBPASSW EQU   ACBCOMN+32                                               01083000
@NM00006 EQU   ACBCOMN+28                                               01084000
@NM00005 EQU   ACBDSORG+1                                               01085000
ACBDORGA EQU   ACBDSORG+1                                               01086000
@NM00004 EQU   ACBDSORG                                                 01087000
ACBCRNRE EQU   ACBCROPS                                                 01088000
ACBCRNCK EQU   ACBCROPS                                                 01089000
ACBASA   EQU   ACBCCTYP                                                 01090000
@NM00003 EQU   ACBCCTYP                                                 01091000
ACBRECAF EQU   ACBRECFM                                                 01092000
ACBJBUF  EQU   ACBBUFPL+2                                               01093000
@NM00002 EQU   ACBBUFPL                                                 01094000
ACBBUFNI EQU   ACBCOMN+18                                               01095000
ACBBUFND EQU   ACBCOMN+16                                               01096000
ACBSTRNO EQU   ACBCOMN+14                                               01097000
@NM00001 EQU   ACBMACR2                                                 01098000
ACBLOGON EQU   ACBMACR2                                                 01099000
ACBSKP   EQU   ACBMACR2                                                 01100000
ACBCHN   EQU   ACBMACR2                                                 01101000
ACBCBRD  EQU   ACBMACR2                                                 01102000
ACBCBOPN EQU   ACBMACR2                                                 01103000
ACBUBF   EQU   ACBMACR1                                                 01104000
ACBOUT   EQU   ACBMACR1                                                 01105000
ACBIN    EQU   ACBMACR1                                                 01106000
ACBDIR   EQU   ACBMACR1                                                 01107000
ACBSEQ   EQU   ACBMACR1                                                 01108000
ACBBLK   EQU   ACBCNV                                                   01109000
ACBADD   EQU   ACBADR                                                   01110000
ACBKEY   EQU   ACBMACR1                                                 01111000
ACBINRTN EQU   ACBCOMN+8                                                01112000
ACBIBCT  EQU   ACBJWA                                                   01113000
ACBLEN2  EQU   ACBLENG2                                                 01114000
ACBSTYP  EQU   ACBCOMN+1                                                01115000
ACBID    EQU   ACBCOMN                                                  01116000
S99TUPRM EQU   S99TUFLD+2                                               01117000
S99TULEN EQU   S99TUFLD                                                 01118000
S99TUPLN EQU   S99TUPTR                                                 01119000
S99TUPND EQU   S99TUP                                                   01120000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01121000
@PB00002 EQU   @EL00001                                                 01122000
@ENDDATA EQU   *                                                        01123000
         END   IKJEFF15,(C'PL/S-II',0503,73324)                         01124000
