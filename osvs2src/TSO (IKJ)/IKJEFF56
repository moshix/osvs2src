         TITLE 'IKJEFF56 - CANCEL/STATUS LEAD AND CLEAN-UP ROUTINE     *00001000
                        '                                               00002000
IKJEFF56 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'IKJEFF56  74.114'                                 0001 00009000
IKJEFFCA DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00109-IKJEFFCA)                                   00013000
         ENTRY IKJEFFCA                                                 00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00016000
         BALR  @12,0                                               0001 00017000
@PSTART  DS    0H                                                  0001 00018000
         USING @PSTART,@12                                         0001 00019000
         L     @00,@SIZDATD                                        0001 00020000
         GETMAIN R,LV=(0)                                               00021000
         LR    @11,@01                                             0001 00022000
         USING @DATD,@11                                           0001 00023000
         ST    @13,@SA00001+4                                      0001 00024000
         LM    @15,@01,16(@13)                                     0001 00025000
         ST    @11,8(,@13)                                         0001 00026000
         LR    @13,@11                                             0001 00027000
         AH    @15,4(,@15)                                         0001 00028000
         BR    @15                                                 0001 00029000
@EP00001 MVC   @PC00001(4),0(@01)                                  0001 00030000
*                                                                  0045 00031000
*   /*****************************************************************/ 00032000
*   /*                                                               */ 00033000
*   /* ENTRY POINT FOR STATUS COMMAND                                */ 00034000
*   /*                                                               */ 00035000
*   /*****************************************************************/ 00036000
*                                                                  0045 00037000
*   SWITCHES=0;                                                    0045 00038000
         MVI   SWITCHES,X'00'                                      0045 00039000
*   STATUSSW='1'B;                  /* COMMAND IS STATUS, NOT CANCEL */ 00040000
*                                                                  0046 00041000
         OI    STATUSSW,B'01000000'                                0046 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* USE SVC 100 TO CHANGE TO PROTECT KEY 1 AND ATTACH NEXT        */ 00045000
*   /* CANCEL/STATUS MODULE WITH STAI EXIT = IKJEFF20                */ 00046000
*   /*                                                               */ 00047000
*   /*****************************************************************/ 00048000
*                                                                  0047 00049000
*BEGIN:                             /* CODE COMMON TO CANCEL AND   0047 00050000
*                                      STATUS COMMANDS               */ 00051000
*   RFY                                                            0047 00052000
*     R1 RSTD;                                                     0047 00053000
BEGIN    DS    0H                                                  0048 00054000
*   CPPLPTR=R1;                     /* PICK UP POINTER TO CPPL       */ 00055000
         LR    CPPLPTR,R1                                          0048 00056000
*   RFY                                                            0049 00057000
*     R1 UNRSTD;                                                   0049 00058000
*   FIBPARMS=FIBPARMS&&FIBPARMS;    /* ZERO OUT FIB PARAMETER AREA   */ 00059000
         XC    FIBPARMS(32),FIBPARMS                               0050 00060000
*   FIBMACRO=' ';                   /* BLANK ERROR MACRO NAME        */ 00061000
         MVI   FIBMACRO+1,C' '                                     0051 00062000
         MVC   FIBMACRO+2(6),FIBMACRO+1                            0051 00063000
         MVI   FIBMACRO,C' '                                       0051 00064000
*   FIBCPPL=CPPLPTR;                /* PUT A POINTER TO CPPL IN    0052 00065000
*                                      FIBCPPL FIELD                 */ 00066000
         ST    CPPLPTR,FIBCPPL                                     0052 00067000
*   IF STATUSSW='1'B THEN           /* IF STATUS WAS ENTERED THEN    */ 00068000
         TM    STATUSSW,B'01000000'                                0053 00069000
         BNO   @RF00053                                            0053 00070000
*     FIBID=FIBST;                  /* TELL SVC 100 TO ATTACH STATUS    00071000
*                                      MODULE                        */ 00072000
         MVC   FIBID(2),@CH00092                                   0054 00073000
*   ELSE                            /* ELSE, CANCEL MODULE           */ 00074000
*     FIBID=FIBCANCL;                                              0055 00075000
         B     @RC00053                                            0055 00076000
@RF00053 MVC   FIBID(2),@CH00086                                   0055 00077000
*   FIBMAINP=ADDR(FIBPARMS);        /* POINTER TO FIB PARM LIST      */ 00078000
@RC00053 LA    @10,FIBPARMS                                        0056 00079000
         ST    @10,FIBMAINP                                        0056 00080000
*   FIBHIGH='1'B;                   /* STANDARD LINKAGE CONVENTION   */ 00081000
         OI    FIBHIGH,B'10000000'                                 0057 00082000
*   RFY                                                            0058 00083000
*     R1 RSTD;                                                     0058 00084000
*   R1=ADDR(FIBMAINP);              /* REGISTER 1 -> PTR -> FIBPARMS */ 00085000
         LA    R1,FIBMAINP                                         0059 00086000
*   SVC(100);                       /* SVC FOR FIB, PROF AND OPER TSO   00087000
*                                      COMMANDS....IKJEFFS0 PL/S   0060 00088000
*                                      MACRO                         */ 00089000
         SVC   100                                                 0060 00090000
*   RFY                                                            0061 00091000
*     R1 UNRSTD;                                                   0061 00092000
*                                                                  0062 00093000
*   /*****************************************************************/ 00094000
*   /*                                                               */ 00095000
*   /* CHECK RETURN CODE FROM SVC 100 AND CANCEL/STATUS MODULES      */ 00096000
*   /*                                                               */ 00097000
*   /*****************************************************************/ 00098000
*                                                                  0062 00099000
*   RFY                                                            0062 00100000
*     R15 RSTD;                                                    0062 00101000
*   RETCODE=R15;                    /* SAVE RETURN CODE              */ 00102000
         ST    R15,RETCODE                                         0063 00103000
*   RFY                                                            0064 00104000
*     R15 UNRSTD;                                                  0064 00105000
*   IF RETCODE^=RCOK THEN           /* CHECK FIRST FOR NON-ZERO R.C. */ 00106000
         L     @10,RETCODE                                         0065 00107000
         LTR   @10,@10                                             0065 00108000
         BZ    @RF00065                                            0065 00109000
*BADRC:                                                            0066 00110000
*     DO;                           /* CODE FOR NON-ZERO R.C.        */ 00111000
BADRC    DS    0H                                                  0067 00112000
*       CPECB=0;                    /* ZERO COMMUNICATIONS ECB       */ 00113000
         SLR   @10,@10                                             0067 00114000
         ST    @10,CPECB                                           0067 00115000
*/********************************************************************/ 00116000
*/*                                                                  */ 00117000
*/* ISSUE AN ERROR MESSAGE IF A MESSAGE WASN'T ISSUED ALREADY.       */ 00118000
*/*                                                                  */ 00119000
*/*  RETURN CODE = 12 MEANS ANOTHER CANCEL/STATUS MODULE DETECTED    */ 00120000
*/*  AN ERROR AND ISSUED A MESSAGE.  RCABEND AREA IN RETURN CODE     */ 00121000
*/*  NON-ZERO (AND OTHER FIELDS ZERO) MEANS AN ABEND OCCURRED AND    */ 00122000
*/*  SVC 100 RETURNED CONTROL TO THIS MODULE AFTER THE RECOVERY      */ 00123000
*/*  PROCESSING - BUT CONTROL SHOULD BE RETURNED TO THE CALLER       */ 00124000
*/*  OF THE CANCEL/STATUS CP, NOT HERE.                              */ 00125000
*/*                                                                  */ 00126000
*/********************************************************************/ 00127000
*                                                                  0068 00128000
*       IF^((RETCODE=RCCALLEE)|(RCABEND^='000000000000'B&RCHIGH=0& 0068 00129000
*           RCRETCOD='000000000000'B)) THEN/* CHECK FOR OTHER FIELDS    00130000
*                                      ZERO ON ABEND TO RULE OUT CASE   00131000
*                                      OF VERY HIGH RETURN CODE      */ 00132000
         CLC   RETCODE(4),@CF00044                                 0068 00133000
         BE    @RF00068                                            0068 00134000
         MVC   @TS00001(2),RCABEND                                 0068 00135000
         NC    @TS00001(2),@CB00214                                0068 00136000
         BZ    @RT00068                                            0068 00137000
         CLI   RCHIGH,0                                            0068 00138000
         BNE   @RT00068                                            0068 00139000
         MVC   @TS00001(2),RCRETCOD                                0068 00140000
         NC    @TS00001(2),@CB00216                                0068 00141000
         BZ    @RF00068                                            0068 00142000
@RT00068 DS    0H                                                  0069 00143000
*ERRMSG:                            /* LABEL FOR DO/END GROUP        */ 00144000
*         DO;                                                      0069 00145000
ERRMSG   DS    0H                                                  0070 00146000
*           MSGTABLE=MSGTABLE&&MSGTABLE;/* CLEAR MSGPARM AREA        */ 00147000
         XC    MSGTABLE(64),MSGTABLE                               0070 00148000
*           IF RETCODE=FIBNOFIB THEN/* IF USER UNAUTHORIZED TO USE 0071 00149000
*                                      THE FIB COMMANDS              */ 00150000
         CLC   RETCODE(4),@CF00097                                 0071 00151000
         BNE   @RF00071                                            0071 00152000
*             MSGID=IDMSGA;         /* ID OF MSG FOR UNAUTHORIZED    */ 00153000
         MVC   MSGID(4),@CC00048                                   0072 00154000
*           ELSE                    /* ELSE MACRO ERROR IN SVC100 (OR   00155000
*                                      UNEXPECTED RETURN CODE)       */ 00156000
*             DO;                                                  0073 00157000
         B     @RC00071                                            0073 00158000
@RF00071 DS    0H                                                  0074 00159000
*               IF RETCODE^=FIBBADMC THEN/* PUT THE UNEXPECTED R.C.     00160000
*                                      IN MSG 259I-FIBMACRO IS BLANK */ 00161000
         L     @10,RETCODE                                         0074 00162000
         CH    @10,@CH00099                                        0074 00163000
         BE    @RF00074                                            0074 00164000
*                 FIBCODE=RETCODE;                                 0075 00165000
         ST    @10,FIBCODE                                         0075 00166000
*               MSGID=IDMSGB;       /* ID OF MSG TO BE PUT OUT       */ 00167000
@RF00074 MVC   MSGID(4),@CC00050                                   0076 00168000
*               L2=LENGTH(FIBMACRO);                               0077 00169000
         MVI   L2,X'08'                                            0077 00170000
*               VAR2=ADDR(FIBMACRO);/* PUT ADDR OF MACRO NAME IN   0078 00171000
*                                      MSGLIST                       */ 00172000
         LA    @10,FIBMACRO                                        0078 00173000
         STCM  @10,7,VAR2                                          0078 00174000
*               L3=RCHEX;           /* INDICATE LENGTH OF VARIABLE IS   00175000
*                                      FOUR AND NEEDS CONVERSION     */ 00176000
         MVI   L3,X'84'                                            0079 00177000
*               VAR3=ADDR(FIBCODE); /* PICK UP ADDRESS OF THE BAD  0080 00178000
*                                      RETURN CODE                   */ 00179000
         LA    @10,FIBCODE                                         0080 00180000
         STCM  @10,7,VAR3                                          0080 00181000
*             END;                                                 0081 00182000
*                                                                  0082 00183000
*           /*********************************************************/ 00184000
*           /*                                                       */ 00185000
*           /* ISSUE ERROR MESSAGE - 251I OR 259I                    */ 00186000
*           /*                                                       */ 00187000
*           /*********************************************************/ 00188000
*                                                                  0082 00189000
*           L1=LENGTH(ECTPCMD);                                    0082 00190000
@RC00071 MVI   L1,X'08'                                            0082 00191000
*           VAR1=ADDR(ECTPCMD);     /* COMMAND NAME                  */ 00192000
         L     @10,ECTPTR(,CPPLPTR)                                0083 00193000
         LA    @10,ECTPCMD(,@10)                                   0083 00194000
         STCM  @10,7,VAR1                                          0083 00195000
*           MTCPPL=FIBCPPL;         /* PUT CPPL POINTER IN MSGLIST   */ 00196000
         L     @10,FIBCPPL                                         0084 00197000
         ST    @10,MTCPPL                                          0084 00198000
*           MTPUTLSW='1'B;          /* INDICATES PUTLINE, NOT PUTGET */ 00199000
         OI    MTPUTLSW,B'01000000'                                0085 00200000
*           ECBPTR=ADDR(CPECB);     /* PICK UP ADDR OF COMMUNICATIONS   00201000
*                                      ECB                           */ 00202000
         LA    @10,CPECB                                           0086 00203000
         ST    @10,ECBPTR                                          0086 00204000
*           LISTPTR=ADDR(MSGCSECT); /* PICK UP POINTER TO THE MESSAGE   00205000
*                                      SECTION OF MSGTABLE           */ 00206000
         LA    @10,MSGCSECT                                        0087 00207000
         ST    @10,LISTPTR                                         0087 00208000
*           RFY                                                    0088 00209000
*            (R0,                                                  0088 00210000
*             R1) RSTD;                                            0088 00211000
*           GEN(LOAD EP=IKJEFF55);  /* ONLY LOAD IF NEED ERROR MSG   */ 00212000
         LOAD EP=IKJEFF55                                               00213000
*           MSGCSECT=R0;            /* SAVE ADDRESS OF MSG CSECT     */ 00214000
         ST    R0,MSGCSECT                                         0090 00215000
*           MTHIGH='1'B;            /* FOR STANDARD LINKAGE CONVEN.  */ 00216000
         OI    MTHIGH,B'10000000'                                  0091 00217000
*           R1=ADDR(MSGTABLE);      /* PICK UP ADDR OF MSG PARMS     */ 00218000
         LA    R1,MSGTABLE                                         0092 00219000
*           GEN(LINK EP=IKJEFF02);  /* ISSUE THE ERROR MESSAGE       */ 00220000
         LINK EP=IKJEFF02                                               00221000
*           RFY                                                    0094 00222000
*            (R0,                                                  0094 00223000
*             R1) UNRSTD;                                          0094 00224000
*           GEN(DELETE EP=IKJEFF55);/* UNLOAD THE MESSAGE CSECT      */ 00225000
         DELETE EP=IKJEFF55                                             00226000
*           RETCODE=RCTMPBAD;       /* SET RETURN CODE FOR ERRORS  0096 00227000
*                                      DETECTED WITHIN THE MODULE    */ 00228000
         MVC   RETCODE(4),@CF00044                                 0096 00229000
*         END ERRMSG;                                              0097 00230000
*                                                                  0098 00231000
*       /*************************************************************/ 00232000
*       /*                                                           */ 00233000
*       /* FLUSH CLIST STACK IF ANY ERROR FOUND                      */ 00234000
*       /*                                                           */ 00235000
*       /*************************************************************/ 00236000
*                                                                  0098 00237000
*       RFY                                                        0098 00238000
*        (STPLPTR) RSTD;            /* RESTRICT R1                   */ 00239000
@RF00068 DS    0H                                                  0099 00240000
*       STPLPTR=ADDR(STPLCORE);     /* PICK UP ADDR OF STACK PARAM 0099 00241000
*                                      LIST=I/O PARAMETER LIST (IOPL)*/ 00242000
         LA    STPLPTR,STPLCORE                                    0099 00243000
*       STPLUPT=CPPLUPT;            /* PICK UP UPT ADDR OUT OF CPPL  */ 00244000
         L     @10,CPPLUPT(,CPPLPTR)                               0100 00245000
         ST    @10,STPLUPT(,STPLPTR)                               0100 00246000
*       STPLECT=CPPLECT;            /* PICK UP ECT ADDR OUT OF CPPL  */ 00247000
         L     @10,CPPLECT(,CPPLPTR)                               0101 00248000
         ST    @10,STPLECT(,STPLPTR)                               0101 00249000
*       STPLECB=ADDR(CPECB);        /* PICK UP ADDR OF COMM ECB      */ 00250000
         LA    @10,CPECB                                           0102 00251000
         ST    @10,STPLECB(,STPLPTR)                               0102 00252000
*       STPLSTPB=ADDR(STPBCORE);    /* PT TO AREA FOR STACK PARAM  0103 00253000
*                                      BLOCK                         */ 00254000
         LA    @10,STPBCORE                                        0103 00255000
         ST    @10,STPLSTPB(,STPLPTR)                              0103 00256000
*       STPBCORE=STPBLIST;          /* COPY LIST FORM OF STACK (STPB)   00257000
*                                      INTO REENTRANT CORE           */ 00258000
         MVC   STPBCORE(16),STPBLIST                               0104 00259000
*       GENERATE;                                                  0105 00260000
*                                   /* FLUSH STACK AND CLEAR INPUT */   00261000
            STACK MF=(E,(1))        FLUSH STACK         (DELETE=ALL)    00262000
            TCLEARQ INPUT           CLEAR INPUT                         00263000
*       RFY                                                        0106 00264000
*        (STPLPTR) UNRSTD;          /* UNRESTRICT R1                 */ 00265000
*     END BADRC;                                                   0107 00266000
*   RETURN CODE(RETCODE);           /* PASS RETURN CODE BACK TO    0108 00267000
*                                      CALLER                        */ 00268000
*                                                                  0108 00269000
@RF00065 L     @10,RETCODE                                         0108 00270000
         L     @13,4(,@13)                                         0108 00271000
         L     @00,@SIZDATD                                        0108 00272000
         LR    @01,@11                                             0108 00273000
         FREEMAIN R,LV=(0),A=(1)                                        00274000
         LR    @15,@10                                             0108 00275000
         L     @14,12(,@13)                                        0108 00276000
         LM    @00,@12,20(@13)                                     0108 00277000
         BR    @14                                                 0108 00278000
*   /*****************************************************************/ 00279000
*   /*                                                               */ 00280000
*   /* ENTRY POINT FOR CANCEL COMMAND                                */ 00281000
*   /*                                                               */ 00282000
*   /*****************************************************************/ 00283000
*                                                                  0109 00284000
*IKJEFFCA:                                                         0109 00285000
*   ENTRY(DUMMY);                   /* ENTRY FOR CANCEL              */ 00286000
@EP00109 MVC   @PC00001(4),0(@01)                                  0109 00287000
*   SWITCHES=0;                     /* INITIALIZE SWITCHES           */ 00288000
         MVI   SWITCHES,X'00'                                      0110 00289000
*   CANCELSW='1'B;                  /* TURN ON SWITCH TO SAY CANCEL     00290000
*                                      IS CALLER                     */ 00291000
         OI    CANCELSW,B'10000000'                                0111 00292000
*   GO TO BEGIN;                    /* GO INTO MOTHER PROCEDURE      */ 00293000
         B     BEGIN                                               0112 00294000
*   END IKJEFF56                                                   0113 00295000
*                                                                  0113 00296000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00297000
*/*%INCLUDE SYSLIB  (IKJEFFIB)                                       */ 00298000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                       */ 00299000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 00300000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 00301000
*/*%INCLUDE SYSLIB  (IKJSTPL )                                       */ 00302000
*/*%INCLUDE SYSLIB  (IKJSTPB )                                       */ 00303000
*/*%INCLUDE SYSLIB  (IKJEFFS0)                                       */ 00304000
*                                                                  0113 00305000
*       ;                                                          0113 00306000
@DATA    DS    0H                                                       00307000
@CH00099 DC    H'84'                                                    00308000
@CH00086 DC    XL2'0002'                                                00309000
@CH00092 DC    XL2'0005'                                                00310000
@DATD    DSECT                                                          00311000
         DS    0F                                                       00312000
@SA00001 DS    18F                                                      00313000
@PC00001 DS    1F                                                       00314000
IKJEFF56 CSECT                                                          00315000
         DS    0F                                                       00316000
@CF00044 DC    F'12'                                                    00317000
@CF00097 DC    F'80'                                                    00318000
@DATD    DSECT                                                          00319000
         DS    0D                                                       00320000
RETCODE  DS    AL4                                                      00321000
         ORG   RETCODE                                                  00322000
RCHIGH   DS    AL1                                                      00323000
RCABEND  DS    BL2                                                      00324000
RCRETCOD EQU   RETCODE+2                                                00325000
         ORG   RETCODE+4                                                00326000
CPECB    DS    F                                                        00327000
FIBMAINP DS    AL4                                                      00328000
         ORG   FIBMAINP                                                 00329000
FIBHIGH  DS    BL1                                                      00330000
         ORG   FIBMAINP+4                                               00331000
SWITCHES DS    AL1                                                      00332000
         ORG   SWITCHES                                                 00333000
CANCELSW DS    BL1                                                      00334000
STATUSSW EQU   SWITCHES+0                                               00335000
@NM00001 EQU   SWITCHES+0                                               00336000
         ORG   SWITCHES+1                                               00337000
@TS00001 DS    CL2                                                      00338000
         DS    CL1                                                      00339000
FIBPARMS DS    CL32                                                     00340000
         ORG   FIBPARMS                                                 00341000
FIBCPPL  DS    AL4                                                      00342000
FIBUSER  DS    AL4                                                      00343000
FIBCODE  DS    AL4                                                      00344000
FIBMACRO DS    CL8                                                      00345000
FIBID    DS    FL2                                                      00346000
FIBLEN   DS    FL2                                                      00347000
@NM00002 DS    AL4                                                      00348000
@NM00003 DS    AL4                                                      00349000
         ORG   FIBPARMS+32                                              00350000
MSGTABLE DS    CL64                                                     00351000
         ORG   MSGTABLE                                                 00352000
LISTPTR  DS    AL4                                                      00353000
TMCTPTR  DS    AL4                                                      00354000
         ORG   TMCTPTR                                                  00355000
MTCPPL   DS    AL4                                                      00356000
         ORG   MSGTABLE+8                                               00357000
ECBPTR   DS    AL4                                                      00358000
@NM00004 DS    AL4                                                      00359000
         ORG   @NM00004                                                 00360000
MTHIGH   DS    BL1                                                      00361000
         ORG   MSGTABLE+16                                              00362000
MSGCSECT DS    AL4                                                      00363000
SW       DS    AL1                                                      00364000
         ORG   SW                                                       00365000
MTNOIDSW DS    BL1                                                      00366000
MTPUTLSW EQU   SW+0                                                     00367000
MTWTOSW  EQU   SW+0                                                     00368000
MTHEXSW  EQU   SW+0                                                     00369000
MTKEY1SW EQU   SW+0                                                     00370000
MTJOBISW EQU   SW+0                                                     00371000
MTWTPSW  EQU   SW+0                                                     00372000
MTNHEXSW EQU   SW+0                                                     00373000
         ORG   MSGTABLE+21                                              00374000
RETMSG   DS    AL3                                                      00375000
SW2      DS    AL1                                                      00376000
         ORG   SW2                                                      00377000
MT2OLDSW DS    BL1                                                      00378000
MTDOMSW  EQU   SW2+0                                                    00379000
MTNOXQSW EQU   SW2+0                                                    00380000
MTNPLMSW EQU   SW2+0                                                    00381000
MTPGMSW  EQU   SW2+0                                                    00382000
@NM00005 EQU   SW2+0                                                    00383000
         ORG   MSGTABLE+25                                              00384000
@NM00006 DS    AL3                                                      00385000
MTOLDPTR DS    AL4                                                      00386000
@NM00007 DS    AL4                                                      00387000
@NM00008 DS    AL4                                                      00388000
MSGID    DS    CL4                                                      00389000
MTINSRTS DS    CL16                                                     00390000
         ORG   MTINSRTS                                                 00391000
L1       DS    AL1                                                      00392000
         ORG   L1                                                       00393000
HIGHL1   DS    BL1                                                      00394000
         ORG   MTINSRTS+1                                               00395000
VAR1     DS    AL3                                                      00396000
L2       DS    AL1                                                      00397000
         ORG   L2                                                       00398000
HIGHL2   DS    BL1                                                      00399000
         ORG   MTINSRTS+5                                               00400000
VAR2     DS    AL3                                                      00401000
L3       DS    AL1                                                      00402000
         ORG   L3                                                       00403000
HIGHL3   DS    BL1                                                      00404000
         ORG   MTINSRTS+9                                               00405000
VAR3     DS    AL3                                                      00406000
L4       DS    AL1                                                      00407000
         ORG   L4                                                       00408000
HIGHL4   DS    BL1                                                      00409000
         ORG   MTINSRTS+13                                              00410000
VAR4     DS    AL3                                                      00411000
         ORG   MSGTABLE+60                                              00412000
MSGRTN   DS    AL4                                                      00413000
         ORG   MSGTABLE+64                                              00414000
STPLCORE DS    CL16                                                     00415000
STPBCORE DS    CL16                                                     00416000
IKJEFF56 CSECT                                                          00417000
         DS    0F                                                       00418000
@SIZDATD DC    AL1(0)                                                   00419000
         DC    AL3(@ENDDATD-@DATD)                                      00420000
         DS    0D                                                       00421000
@CC00048 DC    C'251I'                                                  00422000
@CC00050 DC    C'259I'                                                  00423000
@CB00214 DC    B'1111111111110000'                                      00424000
@CB00216 DC    B'0000111111111111'                                      00425000
PATCH    DS    CL36                                                     00426000
         ORG   PATCH                                                    00427000
PTCHINIT DC    12CL3'ZAP'                                               00428000
         ORG   PATCH+36                                                 00429000
IKJEFF56 CSECT                                                          00430000
*                                   /* NOW CREATE STPBLIST */           00431000
STPBLIST  STACK DELETE=ALL,MF=L     CREATES NON-REENT STPB              00432000
@DATD    DSECT                                                          00433000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00434000
@ENDDATD EQU   *                                                        00435000
IKJEFF56 CSECT                                                          00436000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00437000
@01      EQU   01                                                       00438000
@02      EQU   02                                                       00439000
@03      EQU   03                                                       00440000
@04      EQU   04                                                       00441000
@05      EQU   05                                                       00442000
@06      EQU   06                                                       00443000
@07      EQU   07                                                       00444000
@08      EQU   08                                                       00445000
@09      EQU   09                                                       00446000
@10      EQU   10                                                       00447000
@11      EQU   11                                                       00448000
@12      EQU   12                                                       00449000
@13      EQU   13                                                       00450000
@14      EQU   14                                                       00451000
@15      EQU   15                                                       00452000
CPPLPTR  EQU   @04                                                      00453000
R0       EQU   @00                                                      00454000
R1       EQU   @01                                                      00455000
STPLPTR  EQU   @01                                                      00456000
R15      EQU   @15                                                      00457000
RET      EQU   0                                                        00458000
CPPL     EQU   0                                                        00459000
CPPLUPT  EQU   CPPL+4                                                   00460000
CPPLECT  EQU   CPPL+12                                                  00461000
ECT      EQU   0                                                        00462000
ECTPCMD  EQU   ECT+12                                                   00463000
ECTSWS   EQU   ECT+28                                                   00464000
STPL     EQU   0                                                        00465000
STPLUPT  EQU   STPL                                                     00466000
STPLECT  EQU   STPL+4                                                   00467000
STPLECB  EQU   STPL+8                                                   00468000
STPLSTPB EQU   STPL+12                                                  00469000
STPB     EQU   0                                                        00470000
MSGECB   EQU   0                                                        00471000
MSGTMCT  EQU   0                                                        00472000
DUMMY    EQU   0                                                        00473000
ECTPTR   EQU   CPPLECT                                                  00474000
STPBPTR  EQU   STPLSTPB                                                 00475000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00476000
STPBOTDD EQU   STPB+12                                                  00477000
STPBINDD EQU   STPB+8                                                   00478000
STPBALSD EQU   STPB+4                                                   00479000
@NM00011 EQU   STPB                                                     00480000
ECTBKPB  EQU   ECT+36                                                   00481000
ECTUSER  EQU   ECT+32                                                   00482000
ECTDDNUM EQU   ECT+29                                                   00483000
@NM00010 EQU   ECTSWS                                                   00484000
ECTBKGRD EQU   ECTSWS                                                   00485000
ECTNNOT  EQU   ECTSWS                                                   00486000
ECTNMAL  EQU   ECTSWS                                                   00487000
ECTLOGF  EQU   ECTSWS                                                   00488000
ECTATRM  EQU   ECTSWS                                                   00489000
@NM00009 EQU   ECTSWS                                                   00490000
ECTNOPD  EQU   ECTSWS                                                   00491000
ECTSCMD  EQU   ECT+20                                                   00492000
ECTSMSG  EQU   ECT+9                                                    00493000
ECTMSGF  EQU   ECT+8                                                    00494000
ECTIOWA  EQU   ECT+4                                                    00495000
ECTRTCD  EQU   ECT+1                                                    00496000
ECTRCDF  EQU   ECT                                                      00497000
CPPLPSCB EQU   CPPL+8                                                   00498000
CPPLCBUF EQU   CPPL                                                     00499000
RETCHAR  EQU   RET+2                                                    00500000
RETSIZE  EQU   RET                                                      00501000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00502000
@ENDDATA EQU   *                                                        00503000
         END   IKJEFF56,(C'PL/S-II',0503,74114)                         00504000
