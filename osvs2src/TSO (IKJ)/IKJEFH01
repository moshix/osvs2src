         TITLE 'IKJEFH01 HELP INITIALIZATION                           *00001000
                        '                                               00002000
IKJEFH01 CSECT ,                                                   0001 00003000
@PROLOG  ST    @14,12(,@13)                                        0001 00004000
         STM   @00,@12,20(@13)                                     0001 00005000
         BALR  @12,0                                               0001 00006000
@PSTART  DS    0H                                                  0001 00007000
         USING @PSTART,@12                                         0001 00008000
         L     @00,@SIZDATD                                        0001 00009000
         GETMAIN  R,LV=(0)                                              00010000
         LR    @11,@01                                             0001 00011000
         USING @DATD,@11                                           0001 00012000
         ST    @13,@SA00001+4                                      0001 00013000
         LM    @00,@01,20(@13)                                     0001 00014000
         ST    @11,8(,@13)                                         0001 00015000
         LR    @13,@11                                             0001 00016000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00017000
*                                                                  0088 00018000
*        MSGPTR=ADDR(MSGTABLE);   /* MSGTABLE PARM LIST ADDR @Y02668*/  00019000
         LA    @10,MSGTABLE                                        0089 00020000
         ST    @10,MSGPTR                                          0089 00021000
*      MSGTABLE=MSGTABLE&&MSGTABLE; /* ZERO MSG TABLE        @Y02668*/  00022000
         XC    MSGTABLE(64),MSGTABLE                               0090 00023000
*      MTHIGH='1'B;               /* INDICATE END OF PLIST   @Y002688*/ 00024000
         OI    MTHIGH,B'10000000'                                  0091 00025000
*        TMPINTP=TMPPARMP;          /* GET ADDRESS OF PARAMETERS   0092 00026000
*                                      PASSED FROM THE TMP */      0092 00027000
         L     @10,CALLSAVE+4(,REG13)                              0092 00028000
         L     @10,TMPPARMP+24(,@10)                               0092 00029000
         ST    @10,TMPINTP                                         0092 00030000
*        CPPLPTR=TMPINTP;           /* ESTABLISH ADDRESS OF PARAMETER   00031000
*                                      LIST FROM TMP OR CP */      0093 00032000
         LR    CPPLPTR,@10                                         0093 00033000
*        MTCPPL=CPPLPTR;          /* GET ADDR OF CPPL        @Y02668*/  00034000
         ST    CPPLPTR,MTCPPL                                      0094 00035000
*        ECBPTR = ADDR(COMECB);   /* ADDR OF ECB             @Y02668*/  00036000
         LA    @10,COMECB                                          0095 00037000
         ST    @10,ECBPTR                                          0095 00038000
*        LISTPTR=ADDR(MSGCSECT);  /* GET ADDR OF MSG CSECT   @Y02668*/  00039000
         LA    @10,MSGCSECT                                        0096 00040000
         ST    @10,LISTPTR                                         0096 00041000
*        CONFLICT='0'B;  /* INIT SWITCH  */                        0097 00042000
         NI    CONFLICT,B'01111111'                                0097 00043000
*        SWITCHES=SWITCHES&&SWITCHES;                              0098 00044000
         XC    SWITCHES(4),SWITCHES                                0098 00045000
*                                   /* INITIALIZE SWITCHES TO 0'S */    00046000
*        PARSINDX=1;                /* INIT TO FIRST STRUCTURE   */     00047000
         LA    PARSINDX,1                                          0099 00048000
*        CONTRLCH=' ';              /* BLANK OUT PARSE TABLE */    0100 00049000
         LA    @10,PARSETAB                                        0100 00050000
         MVI   CONTRLCH+1(@10),C' '                                0100 00051000
         MVC   CONTRLCH+2(12,@10),CONTRLCH+1(@10)                  0100 00052000
         MVI   CONTRLCH(@10),C' '                                  0100 00053000
*        CONEND='FFFF'X;            /* INITIALIZE END OF PARSE TABLE */ 00054000
         MVC   CONEND(2),@CB00386                                  0101 00055000
*        COMECB=COMECB&&COMECB;     /* SET HELP'S COMMUNICATION ECB     00056000
*                                      TO 0'S */                   0102 00057000
         XC    COMECB(4),COMECB                                    0102 00058000
*        MSGCSECT=ADDR(IKJEFH00);    /* SET ADDRESS OF MESSAGE CSECT    00059000
*                                      FOR IKJEFF02          @Y02668*/  00060000
         L     @10,@CV00359                                        0103 00061000
         ST    @10,MSGCSECT                                        0103 00062000
*        PPLPTR=ADDR(PPLLN);                                       0104 00063000
         LA    @10,PPLLN                                           0104 00064000
         ST    @10,PPLPTR                                          0104 00065000
*        DAPLPTR=ADDR(PPLLN);       /* PUT PARSE AND DAIR PARM LIST     00066000
*                                      IN SAME STORAGE, CAN NOW    0105 00067000
*                                      REFERENCE */                0105 00068000
         ST    @10,DAPLPTR                                         0105 00069000
*        DAPB2PTR=ADDR(DAPB24LN);   /* SET UP STORAGE FOR DAIR MACRO    00070000
*                                      */                          0106 00071000
         LA    DAPB2PTR,DAPB24LN                                   0106 00072000
*        GENERATE;                                                 0107 00073000
         MVC   DYNOPN(DYNOPNL),DCBOPNM  LIST FORM OF OPEN INTO CODE     00074000
         MVC   DYNDCB(DYNDCBL),READDCBM  PUT DCB INTO CODE              00075000
*        REG2=ADDR(READDCB);        /* SET UP ADDRESS OF DCB */    0108 00076000
         LA    REG2,READDCB                                        0108 00077000
*        READDCBP=REG2;             /* FILL IN PARAMETER LIST */   0109 00078000
         ST    REG2,READDCBP                                       0109 00079000
*        GENERATE;                                                 0110 00080000
*                                                                  0110 00081000
*                                                                  0110 00082000
         USING IHADCB,REG2           ADDRESSIBILITY OF DCB LABELS       00083000
         LOAD  EP=IKJPUTL          LOAD ADDRESS OF PUTLINE              00084000
*        /************************************************************/ 00085000
*        /*                                                          */ 00086000
*        /*  SET UP PARAMETERS REQUIRED TO CALL BOTH PARSE AND DAIR  */ 00087000
*        /*                                                          */ 00088000
*        /************************************************************/ 00089000
*                                                                  0111 00090000
*        DAPLUPT=CPPLUPT;           /* ADDRESS OF UPT */           0111 00091000
         L     @10,DAPLPTR                                         0111 00092000
         MVC   DAPLUPT(4,@10),CPPLUPT(CPPLPTR)                     0111 00093000
*        DAPLECT=CPPLECT;           /* ADDRESS OF ECT */           0112 00094000
         MVC   DAPLECT(4,@10),CPPLECT(CPPLPTR)                     0112 00095000
*        DAPLECB=ADDR(COMECB);      /* ADDRESS OF HELP'S           0113 00096000
*                                      COMMUNICATION ECB */        0113 00097000
*                                                                  0113 00098000
*                                                                  0113 00099000
         LA    @09,COMECB                                          0113 00100000
         ST    @09,DAPLECB(,@10)                                   0113 00101000
*        /************************************************************/ 00102000
*        /*                                                          */ 00103000
*        /*  SET UP PARAMETERS TO CALL DAIR                          */ 00104000
*        /*                                                          */ 00105000
*        /************************************************************/ 00106000
*                                                                  0114 00107000
*        DAPB24=DAPB24&&DAPB24;     /* INITIALIZE DAIR PARAMETER   0114 00108000
*                                      BLOCK TO 0'S */             0114 00109000
         XC    DAPB24(84,DAPB2PTR),DAPB24(DAPB2PTR)                0114 00110000
*        DA24CD='0024'X;            /* SET DAIR CODE */            0115 00111000
         MVC   DA24CD(2,DAPB2PTR),@CB00387                         0115 00112000
*        DA24PDSN=ADDR(DSNAM);      /* SET ADDRESS OF DSLENGTH AND 0116 00113000
*                                      DSNAME */                   0116 00114000
         LA    @09,DSNAM                                           0116 00115000
         ST    @09,DA24PDSN(,DAPB2PTR)                             0116 00116000
*        DSNLEN='0000000000001001'B;                               0117 00117000
         MVC   DSNLEN(2),@CB00388                                  0117 00118000
*                                   /* DSNAME LENGTH 9 */          0118 00119000
*        DSNAMED='SYS1.HELP';       /* DSNAME SYS1 HELP */         0118 00120000
         MVI   DSNAMED+9,C' '                                      0118 00121000
         MVC   DSNAMED+10(34),DSNAMED+9                            0118 00122000
         MVC   DSNAMED(9),@CC00390                                 0118 00123000
*        DA24DDN='SYSHELP';         /* DDNAME SYSHELP */           0119 00124000
         MVI   DA24DDN+7(DAPB2PTR),C' '                            0119 00125000
         MVC   DA24DDN(7,DAPB2PTR),@CC00392                        0119 00126000
*        DA24UNIT='        ';       /* UNIT NAME */                0120 00127000
         MVC   DA24UNIT(8,DAPB2PTR),@CC00393                       0120 00128000
*        DA24SER='        ';        /* SERIAL NAME */              0121 00129000
         MVC   DA24SER(8,DAPB2PTR),@CC00393                        0121 00130000
*        DA24MNM='        ';        /* MEMBER NAME OMITTED */      0122 00131000
         MVC   DA24MNM(8,DAPB2PTR),@CC00393                        0122 00132000
*        DA24PSWD='        ';       /* PASSWORD OMITTED */         0123 00133000
         MVC   DA24PSWD(8,DAPB2PTR),@CC00393                       0123 00134000
*        DA24SHR='1'B;              /* STATUS OF DATA SET - SHR */ 0124 00135000
         OI    DA24SHR(DAPB2PTR),B'00001000'                       0124 00136000
*        DA24KEEP='1'B;             /* DISPOSITION - KEEP */       0125 00137000
         OI    DA24KEEP(DAPB2PTR),B'00001000'                      0125 00138000
*        DA24KEP='1'B;              /* CINDITIONAL DISPOSITION - KEEP   00139000
*                                      */                          0126 00140000
         OI    DA24KEP(DAPB2PTR),B'00001000'                       0126 00141000
*        DAPLPSCB=PSCBPTR;          /* SET UP REST OF PARAMETER BLOCK   00142000
*                                      */                          0127 00143000
         MVC   DAPLPSCB(4,@10),PSCBPTR(CPPLPTR)                    0127 00144000
*        DAPLDAPB=DAPB2PTR;                                        0128 00145000
*                                                                  0128 00146000
*                                                                  0128 00147000
         ST    DAPB2PTR,DAPLDAPB(,@10)                             0128 00148000
*        /************************************************************/ 00149000
*        /*                                                          */ 00150000
*        /*  LINK TO DAIR                                            */ 00151000
*        /*                                                          */ 00152000
*        /************************************************************/ 00153000
*                                                                  0129 00154000
*        GENERATE;                                                 0129 00155000
*                                                                  0129 00156000
         LINK  EP=IKJDAIR,MF=(E,PPLLN)                                  00157000
*        DAIRCODE=REG15;            /* SAVE RETURN CODE FROM DAIR */    00158000
         ST    REG15,DAIRCODE                                      0130 00159000
*        IF REG15=0 THEN                                           0131 00160000
         LTR   REG15,REG15                                         0131 00161000
         BZ    @RT00131                                            0131 00162000
*          GO TO ORGTST;          /* ALLOCATION SUCCESSFUL */      0132 00163000
*                                                                  0132 00164000
*        SWERRMSG='1'B;             /* ERROR IN ALLOCATION - SET   0133 00165000
*                                      SWITCHES TO INDICATE AN ERROR    00166000
*                                      OCCURRED */                 0133 00167000
         OI    SWERRMSG,B'00000001'                                0133 00168000
*        /************************************************************/ 00169000
*        /*                                                          */ 00170000
*        /*  PUT OUT DAIR ERROR MESSAGE                              */ 00171000
*        /*                                                          */ 00172000
*        /************************************************************/ 00173000
*        GENERATE;                                                 0134 00174000
         LOAD  EP=IKJEFF18          GET DAIR ERROR ROUTINE              00175000
*        CALL MSGDAIR (DAPL,DAIRCODE,ADDRF02,ONE);                 0135 00176000
         L     @10,DAPLPTR                                         0135 00177000
         ST    @10,@AL00001                                        0135 00178000
         LA    @10,DAIRCODE                                        0135 00179000
         ST    @10,@AL00001+4                                      0135 00180000
         LA    @10,ADDRF02                                         0135 00181000
         ST    @10,@AL00001+8                                      0135 00182000
         LA    @10,ONE                                             0135 00183000
         ST    @10,@AL00001+12                                     0135 00184000
         LR    @15,REG0                                            0135 00185000
         LA    @01,@AL00001                                        0135 00186000
         BALR  @14,@15                                             0135 00187000
*                                   /* PUT OUT ERROR MESSAGE */    0136 00188000
*        GENERATE;                                                 0136 00189000
         DELETE  EP=IKJEFF18        GET RID OF ERROR ROUTINE            00190000
*        GO TO RT;                  /* QUIT AFTER ERROR MESSAGE PUT     00191000
*                                      OUT */                      0137 00192000
*                                                                  0137 00193000
         B     RT                                                  0137 00194000
*    ORGTST:                                                       0138 00195000
*                                                                  0138 00196000
*        IF DA24DSO^='02'X THEN     /* NOT PARTITIONED DATA SET */ 0138 00197000
ORGTST   CLI   DA24DSO(DAPB2PTR),X'02'                             0138 00198000
         BE    @RF00138                                            0138 00199000
*          DO;                                                     0139 00200000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0140 00201000
         OI    SWERRMSG,B'00000001'                                0140 00202000
*            MSGID='100T';          /* SET MESSAGE ID */           0141 00203000
         MVC   MSGID(4),@CC00399                                   0141 00204000
*            MTPUTLSW = '1'B;     /* DO A PUTLINE NOT PUTGET @Y002668*/ 00205000
         OI    MTPUTLSW,B'01000000'                                0142 00206000
*            GO TO CALMSG;          /* PUT OUT ERROR MSG */        0143 00207000
         B     CALMSG                                              0143 00208000
*          END;                                                    0144 00209000
*    OPENHELP:                                                     0145 00210000
*                                                                  0145 00211000
*        /************************************************************/ 00212000
*        /*                                                          */ 00213000
*        /*  OPEN HELP DATA SET                                      */ 00214000
*        /*                                                          */ 00215000
*        /************************************************************/ 00216000
*                                                                  0145 00217000
*        DCBDNAME=DA24DDN;          /* FILL IN DDNAME RETURNED FROM     00218000
*                                      DAIR FOR OPEN */            0145 00219000
@RF00138 DS    0H                                                  0145 00220000
OPENHELP LA    @10,DCBDDNAM                                        0145 00221000
         MVC   DCBDNAME(8,@10),DA24DDN(DAPB2PTR)                   0145 00222000
*        DCBEXP1=ADDR(BADOPEN);     /* TAKE CARE OF OPEN ERRORS */ 0146 00223000
         LA    @10,BADOPEN                                         0146 00224000
         ST    @10,@TF00001                                        0146 00225000
         MVC   DCBEXP1(3),@TF00001+1                               0146 00226000
*        DCBEXCD1='89'X;                                           0147 00227000
         MVI   DCBEXCD1,X'89'                                      0147 00228000
*        EXITLST=ADDR(DCBLKEX);     /* SET ADDRESS OF EXIT LIST IN 0148 00229000
*                                      DCB */                      0148 00230000
*                                                                  0148 00231000
         LA    @10,DCBEXLST                                        0148 00232000
         LA    @09,DCBLKEX                                         0148 00233000
         ST    @09,@TF00001                                        0148 00234000
         MVC   EXITLST(3,@10),@TF00001+1                           0148 00235000
*        GENERATE;                                                 0149 00236000
*                                                                  0149 00237000
         OPEN  ((2),INPUT),MF=(E,DCBOPN)                                00238000
         B     BADOPEN                                                  00239000
DCBOPNM  OPEN  (,),MF=L                                                 00240000
READDCBM DCB   DSORG=PO,RECFM=FB,MACRF=(R),BUFNO=0                      00241000
*    BADOPEN:                                                      0150 00242000
*        IF OPNFLAG ^= '1'B THEN                                   0150 00243000
BADOPEN  LA    @10,DCBOFLGS                                        0150 00244000
         TM    OPNFLAG(@10),B'00010000'                            0150 00245000
         BO    @RF00150                                            0150 00246000
*                                   /* ERROR IN OPEN */            0151 00247000
*          DO;                                                     0151 00248000
*            SWERRMSG='1'B;         /* INDICATE ERROR HAS OCCURRED */   00249000
         OI    SWERRMSG,B'00000001'                                0152 00250000
*            MSGID='100B';          /* SET MESSAGE ID NUMBER */    0153 00251000
         MVC   MSGID(4),@CC00405                                   0153 00252000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0154 00253000
*                                      OUT ERROR MESSAGE */        0154 00254000
         B     CALMSG                                              0154 00255000
*          END;                                                    0155 00256000
*                                                                  0155 00257000
*        SWCLOSE='1'B;              /* INDICATE OPEN SUCCESSFUL-MUST    00258000
*                                      CLOSE DATA SET BEFORE       0156 00259000
*                                      RETURNING TO THE SYSTEM */  0156 00260000
*                                                                  0156 00261000
*                                                                  0156 00262000
@RF00150 OI    SWCLOSE,B'10000000'                                 0156 00263000
*        IF DCBLREC^=80 THEN                                       0157 00264000
         LA    @10,DCBLRECL                                        0157 00265000
         CLC   DCBLREC(2,@10),@CH00328                             0157 00266000
         BE    @RF00157                                            0157 00267000
*          DO;                      /* IF INCORRECT LOGICAL RECORD 0158 00268000
*                                      LENGTH IN HELP DATA SET ISSUE    00269000
*                                      ERROR MESSAGE AND QUIT */   0158 00270000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0159 00271000
         OI    SWERRMSG,B'00000001'                                0159 00272000
*            MSGID='100E';          /* SET MESSAGE ID NUMBER */    0160 00273000
         MVC   MSGID(4),@CC00406                                   0160 00274000
*            MTPUTLSW = '1'B;     /* DO A PUTLINE NOT PUTGET @Y002668*/ 00275000
         OI    MTPUTLSW,B'01000000'                                0161 00276000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0162 00277000
*                                      OUT ERROR MESSAGE */        0162 00278000
         B     CALMSG                                              0162 00279000
*          END;                                                    0163 00280000
*                                                                  0163 00281000
*                                                                  0163 00282000
*        /************************************************************/ 00283000
*        /*                                                          */ 00284000
*        /*  SET UP PARAMETERS REQUIRED TO CALL PARSE                */ 00285000
*        /*                                                          */ 00286000
*        /************************************************************/ 00287000
*                                                                  0164 00288000
*                                   /* THE FIRST THREE WORDS OF PARAM   00289000
*                                      LIST SET UP BEFORE CALLING  0164 00290000
*                                      DAIR */                     0164 00291000
*        PPLPCL=ADDR(HELPPCL);      /* SET UP POINTER TO PCL */    0164 00292000
@RF00157 L     @10,PPLPTR                                          0164 00293000
         L     @09,@CV00274                                        0164 00294000
         ST    @09,PPLPCL(,@10)                                    0164 00295000
*        PPLANS=ADDR(PARSPDLP);     /* POINT TO AN AREA IN WHICH   0165 00296000
*                                      PARSE WILL PLACE THE ADDRESS     00297000
*                                      OF THE PDL IT CREATES */    0165 00298000
         LA    @09,PARSPDLP                                        0165 00299000
         ST    @09,PPLANS(,@10)                                    0165 00300000
*        PPLCBUF=CPPLCBUF;          /* SET POINTER TO COMMAND BUFFER    00301000
*                                      */                          0166 00302000
*                                                                  0166 00303000
*                                                                  0166 00304000
         MVC   PPLCBUF(4,@10),CPPLCBUF(CPPLPTR)                    0166 00305000
*        /************************************************************/ 00306000
*        /*                                                          */ 00307000
*        /*  LINK TO PARSE ROUTINE                                   */ 00308000
*        /*                                                          */ 00309000
*        /************************************************************/ 00310000
*                                                                  0167 00311000
*        GENERATE;                                                 0167 00312000
*                                                                  0167 00313000
         LINK  EP=IKJPARS,MF=(E,PPLLN)                                  00314000
*        RTNCODE=REG15;             /* SAVE RETURN CODE FROM PARSE */   00315000
         LR    RTNCODE,REG15                                       0168 00316000
*        IF RTNCODE =0 THEN                                        0169 00317000
         LTR   RTNCODE,RTNCODE                                     0169 00318000
         BNZ   @RF00169                                            0169 00319000
*                                   /* PARSE SUCCESSFUL, THEN SET  0170 00320000
*                                      SWITCH */                   0170 00321000
*          SWPARS='1'B;                                            0170 00322000
         OI    SWPARS,B'01000000'                                  0170 00323000
*        ELSE                                                      0171 00324000
*                                   /* ERROR IN PARSE */           0171 00325000
*          DO;                                                     0171 00326000
         B     @RC00169                                            0171 00327000
@RF00169 DS    0H                                                  0172 00328000
*            SWERRMSG='1'B;         /* INDICATE AN ERROR HAS OCCURRED   00329000
*                                      */                          0172 00330000
         OI    SWERRMSG,B'00000001'                                0172 00331000
*            MTPUTLSW = '1'B;   /* USE PUTLINE NOT PUTGET   Y02668*/    00332000
         OI    MTPUTLSW,B'01000000'                                0173 00333000
*            IF RTNCODE>8 THEN      /* SYSTEM ERROR MESSAGE */     0174 00334000
         CH    RTNCODE,@CH00089                                    0174 00335000
         BNH   @RF00174                                            0174 00336000
*              DO;                                                 0175 00337000
*                MSGID='100S';      /* SET MESSAGE ID */           0176 00338000
         MVC   MSGID(4),@CC00407                                   0176 00339000
*                INSERT='PARSE';    /* SET MESSAGE PART */         0177 00340000
         MVI   INSERT+5,C' '                                       0177 00341000
         MVC   INSERT+6(2),INSERT+5                                0177 00342000
         MVC   INSERT(5),@CC00408                                  0177 00343000
*                VAR1=ADDR(INSERT);                        /*@Y02668*/  00344000
         LA    @10,INSERT                                          0178 00345000
         ST    @10,@TF00001                                        0178 00346000
         MVC   VAR1(3),@TF00001+1                                  0178 00347000
*                                   /* SET ADDRESS OF NAME PARSE */     00348000
*                L1='05'X;      /* SET LENGTH                @Y02668*/  00349000
         MVI   L1,X'05'                                            0179 00350000
*                INSERT0=RTNCODE;   /* SET ERROR CODE */           0180 00351000
         ST    RTNCODE,INSERT0                                     0180 00352000
*                VAR2=ADDR(INSERT0);                       /*@Y02668*/  00353000
         LA    @10,INSERT0                                         0181 00354000
         ST    @10,@TF00001                                        0181 00355000
         MVC   VAR2(3),@TF00001+1                                  0181 00356000
*                                   /* POINT TO ERROR CODE */      0182 00357000
*                L2='10000100'B;                           /*@Y02668*/  00358000
         MVI   L2,X'84'                                            0182 00359000
*                                   /* LENGTH OF ERROR CODE,       0183 00360000
*                                      INDICATES NB CONVERSION */  0183 00361000
*            MTPUTLSW = '1'B;     /* DO A PUTLINE NOT PUTGET @Y002668*/ 00362000
         OI    MTPUTLSW,B'01000000'                                0183 00363000
*                GO TO CALMSG;      /* GO TO PUT OUT MESSAGE */    0184 00364000
         B     CALMSG                                              0184 00365000
*              END;                                                0185 00366000
*            GO TO RT;              /* OTHER ERRORS, JUST QUIT */  0186 00367000
         B     RT                                                  0186 00368000
*          END;                                                    0187 00369000
*                                                                  0187 00370000
*        REG4=PARSPDLP;             /* MAKE LOCAL COPY OF PARSE    0188 00371000
*                                      OUTPUT */                   0188 00372000
@RC00169 L     REG4,PARSPDLP                                       0188 00373000
*        PARSNAME=' ';              /* INITIALIZE SPACE FOR NAME   0189 00374000
*                                      OF COMMAND OR SUBCOMMAND  */     00375000
         MVI   PARSNAME+1,C' '                                     0189 00376000
         MVC   PARSNAME+2(6),PARSNAME+1                            0189 00377000
         MVI   PARSNAME,C' '                                       0189 00378000
*        IF PDLNAMEO^='0'B THEN                                    0190 00379000
         TM    PDLNAMEO(REG4),B'10000000'                          0190 00380000
         BZ    @RF00190                                            0190 00381000
*                                   /* IF A COMMAND OR SUBCOMMAND IS    00382000
*                                      ENTERED MOVE IT TO AN 8 BYTE     00383000
*                                      PLACE*/                     0191 00384000
*          PARSNAME=PDLNAME(1:PDLNAMEL);                           0191 00385000
*                                                                  0191 00386000
*                                                                  0191 00387000
         MVI   PARSNAME+1,C' '                                     0191 00388000
         MVC   PARSNAME+2(6),PARSNAME+1                            0191 00389000
         MVC   @ZT00002+2(2),PDLNAMEL(REG4)                        0191 00390000
         L     @10,@ZT00002                                        0191 00391000
         BCTR  @10,0                                               0191 00392000
         L     @09,PDLNAMEP(,REG4)                                 0191 00393000
         EX    @10,@SM00475                                        0191 00394000
*        /************************************************************/ 00395000
*        /*                                                          */ 00396000
*        /*  DETERMINE NAME OF MEMBER TO BE SEARCHED FOR             */ 00397000
*        /*                                                          */ 00398000
*        /************************************************************/ 00399000
*                                                                  0192 00400000
*        IF ECTPCMD=H THEN                                         0192 00401000
@RF00190 MVC   @TF00001(4),ECTPTR(CPPLPTR)                         0192 00402000
         L     @10,@TF00001                                        0192 00403000
         CLC   ECTPCMD(8,@10),H                                    0192 00404000
         BE    @RT00192                                            0192 00405000
*                                   /* ENTERED FROM TMP - COMMAND  0193 00406000
*                                      MODE, WITH ABREVIATION */   0193 00407000
*          GO TO COMTST;                                           0193 00408000
*        IF ECTPCMD=HELP THEN                                      0194 00409000
         CLC   ECTPCMD(8,@10),HELP                                 0194 00410000
         BNE   @RF00194                                            0194 00411000
*                                   /* ENTERED FROM TMP-COMMAND MODE    00412000
*                                      WITHOUT ABREVIATION */      0195 00413000
*          DO;                                                     0195 00414000
*                                                                  0195 00415000
*    COMTST:                                                       0196 00416000
*            IF PDLNAMEO='0'B THEN                                 0196 00417000
COMTST   TM    PDLNAMEO(REG4),B'10000000'                          0196 00418000
         BNZ   @RF00196                                            0196 00419000
*                                   /* IF IN COMMAND MODE &'HELP'  0197 00420000
*                                      ENTERED, WANT LIST OF COMMANDS   00421000
*                                      AND DESCRIPTION OF EACH */  0197 00422000
*              MEMBER=COMMANDS;                                    0197 00423000
         MVC   MEMBER(8),COMMANDS                                  0197 00424000
*            ELSE                                                  0198 00425000
*              MEMBER=PARSNAME;     /* IF IN COMMAND MODE & 'HELP  0198 00426000
*                                      COMMANDNAME' ENTERED, SEARCH     00427000
*                                      ON COMMANDNAME FROM PARSE */     00428000
         B     @RC00196                                            0198 00429000
@RF00196 MVC   MEMBER(8),PARSNAME                                  0198 00430000
*          END;                                                    0199 00431000
*        ELSE                                                      0200 00432000
*                                   /* ENTERED FROM CP-SUBCOMMAND  0200 00433000
*                                      MODE*/                      0200 00434000
*          DO;                                                     0200 00435000
         B     @RC00194                                            0200 00436000
@RF00194 DS    0H                                                  0201 00437000
*            IF PARSNAME=HELP THEN                                 0201 00438000
         CLC   PARSNAME(8),HELP                                    0201 00439000
         BNE   @RF00201                                            0201 00440000
*              MEMBER=HELP;         /*'HELP HELP' ENTERED IN       0202 00441000
*                                      SUBCOMMAND MODE-SEARCH HELP 0202 00442000
*                                      MEMBER FOR HELP */          0202 00443000
         MVC   MEMBER(8),HELP                                      0202 00444000
*            ELSE                                                  0203 00445000
*              MEMBER=ECTPCMD;      /* HELP ENTERED IN SUBCOMMAND  0203 00446000
*                                      MODE SEARCH ON COMMAND      0203 00447000
*                                      ATTACHED BY TMP */          0203 00448000
         B     @RC00201                                            0203 00449000
@RF00201 MVC   @TF00001(4),ECTPTR(CPPLPTR)                         0203 00450000
         L     @10,@TF00001                                        0203 00451000
         MVC   MEMBER(8),ECTPCMD(@10)                              0203 00452000
*            IF PARSNAME=H THEN                                    0204 00453000
@RC00201 CLC   PARSNAME(8),H                                       0204 00454000
         BNE   @RF00204                                            0204 00455000
*                                   /* 'HELP HELP' ENTERED IN      0205 00456000
*                                      SUBCOMMAND MODE - VIA       0205 00457000
*                                      ABREVIATION H - SEARCH HELP 0205 00458000
*                                      MEMBER FOR HELP */          0205 00459000
*              MEMBER=H;                                           0205 00460000
         MVC   MEMBER(8),H                                         0205 00461000
*          END;                                                    0206 00462000
*                                                                  0206 00463000
@RF00204 DS    0H                                                  0207 00464000
*        DO I=1 TO 8;               /* DETERMINE LENGTH OF MEMBER, 0207 00465000
*                                      MAX 8 */                    0207 00466000
@RC00194 LA    I,1                                                 0207 00467000
@DL00207 DS    0H                                                  0208 00468000
*          IF MEMBER(I)=' ' THEN                                   0208 00469000
         LA    @10,MEMBER-1(I)                                     0208 00470000
         CLI   0(@10),C' '                                         0208 00471000
         BNE   @RF00208                                            0208 00472000
*                                   /* BLANK INDICATES END OF EMEBER    00473000
*                                      NAME */                     0209 00474000
*            DO;                                                   0209 00475000
*              MEMLEN=I-1;          /* SET LENGTH */               0210 00476000
         LR    @10,I                                               0210 00477000
         BCTR  @10,0                                               0210 00478000
         STC   @10,MEMLEN                                          0210 00479000
*              GO TO DOFIND;        /* GO TO FIND MACRO */         0211 00480000
         B     DOFIND                                              0211 00481000
*            END;                                                  0212 00482000
*        END;                                                      0213 00483000
*                                                                  0213 00484000
@RF00208 AH    I,@CH00038                                          0213 00485000
         CH    I,@CH00089                                          0213 00486000
         BNH   @DL00207                                            0213 00487000
*        MEMLEN='00001000'B;        /* SET MAX LENGTH TO 8 */      0214 00488000
*                                                                  0214 00489000
*                                                                  0214 00490000
         MVI   MEMLEN,B'00001000'                                  0214 00491000
*    DOFIND:                                                       0215 00492000
*        ;                                                         0215 00493000
*                                                                  0215 00494000
DOFIND   DS    0H                                                  0216 00495000
*        /************************************************************/ 00496000
*        /*                                                          */ 00497000
*        /*  DO A FIND USING MEMBER NAME JUST DETERMINED             */ 00498000
*        /*                                                          */ 00499000
*        /************************************************************/ 00500000
*                                                                  0216 00501000
*    RFY REG1 RSTD;               /* RESTRICT FOR MACRO      @Y02668*/  00502000
*        GENERATE;                                                 0217 00503000
         FIND READDCB,MEMBER,D                                          00504000
*    RFY REG1 UNRSTD;             /* RELEASE FOR CMPLR USE   @Y02668*/  00505000
*        RTNCODE=REG15;             /* SAVE RETURN CODE */         0219 00506000
*                                                                  0219 00507000
*                                                                  0219 00508000
         LR    RTNCODE,REG15                                       0219 00509000
*        /************************************************************/ 00510000
*        /*                                                          */ 00511000
*        /*  CHECK FOR FIND ERRORS                                   */ 00512000
*        /*                                                          */ 00513000
*        /************************************************************/ 00514000
*                                                                  0220 00515000
*        IF RTNCODE=0 THEN                                         0220 00516000
         LTR   RTNCODE,RTNCODE                                     0220 00517000
         BZ    @RT00220                                            0220 00518000
*          GO TO FINDSUCS;          /* FIND SUCCESSFUL SKIP ERROR  0221 00519000
*                                      MESSAGES */                 0221 00520000
*                                                                  0221 00521000
*        SWERRMSG='1'B;             /* INDICATE AN ERROR HAS OCCURRED*/ 00522000
         OI    SWERRMSG,B'00000001'                                0222 00523000
*        MTPUTLSW = '1'B;   /* USE PUTLINE NOT PUTGET   Y02668*/   0223 00524000
         OI    MTPUTLSW,B'01000000'                                0223 00525000
*        VAR1=ADDR(MEMBER);    /* SET ADDRESS OF MEMBER NAME @Y02668*/  00526000
         LA    @10,MEMBER                                          0224 00527000
         ST    @10,@TF00001                                        0224 00528000
         MVC   VAR1(3),@TF00001+1                                  0224 00529000
*        L1=MEMLEN;             /* LENGTH OF MEMBER NAME     @Y02668*/  00530000
*                                                                  0225 00531000
         MVC   L1(1),MEMLEN                                        0225 00532000
*        IF RTNCODE=8 THEN                                         0226 00533000
         CH    RTNCODE,@CH00089                                    0226 00534000
         BNE   @RF00226                                            0226 00535000
*          DO;                      /* FIND I/O ERROR IF RETURN CODE    00536000
*                                      8*/                         0227 00537000
*            MSGID='100C';          /* SET MESSAGE ID NUMBER */    0228 00538000
         MVC   MSGID(4),@CC00417                                   0228 00539000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0229 00540000
*                                      OUT ERROR MESSAGE */        0229 00541000
         B     CALMSG                                              0229 00542000
*          END;                                                    0230 00543000
*                                                                  0230 00544000
*                                   /* RETURN CODE = 4, SO MEMBER NOT   00545000
*                                      FOUND IN HELP DATA SET */   0231 00546000
*        IF ECTPCMD^=H THEN                                        0231 00547000
@RF00226 MVC   @TF00001(4),ECTPTR(CPPLPTR)                         0231 00548000
         L     @10,@TF00001                                        0231 00549000
         CLC   ECTPCMD(8,@10),H                                    0231 00550000
         BE    @RF00231                                            0231 00551000
*                                   /* ENTERED FROM A CP I.E. HELP OR   00552000
*                                      ABREVIATION H NOT IN ECT */ 0232 00553000
*          IF ECTPCMD^=HELP THEN                                   0232 00554000
         CLC   ECTPCMD(8,@10),HELP                                 0232 00555000
         BE    @RF00232                                            0232 00556000
*            DO;                    /* NAME OF COMMAND FROM INPUT  0233 00557000
*                                      BUFFER NOT FOUND */         0233 00558000
*                                                                  0233 00559000
*    M100H:                                                        0234 00560000
*              MSGID='100H';        /* SET MESSAGE ID NUMBER */    0234 00561000
M100H    MVC   MSGID(4),@CC00419                                   0234 00562000
*              GO TO CALMSG;        /* CALL MESSAGE ROUTINE TO PUT 0235 00563000
*                                      OUT ERROR MESSAGE */        0235 00564000
         B     CALMSG                                              0235 00565000
*          END;                                                    0236 00566000
*                                                                  0236 00567000
*        IF MEMBER=HELP THEN                                       0237 00568000
@RF00232 DS    0H                                                  0237 00569000
@RF00231 CLC   MEMBER(8),HELP                                      0237 00570000
         BE    @RT00237                                            0237 00571000
*                                   /* HELP HELP ENTERED FROM TMP */    00572000
*          GO TO M100H;             /* GO TO PUT OUT MESSAGE THAT  0238 00573000
*                                      COMMAND HELP NOT FOUND */   0238 00574000
*                                                                  0238 00575000
*        IF MEMBER=COMMANDS THEN                                   0239 00576000
         CLC   MEMBER(8),COMMANDS                                  0239 00577000
         BNE   @RF00239                                            0239 00578000
*                                   /* ENTERED FROM TMP AND LIST OF     00579000
*                                      COMMANDS NOT FOUND */       0240 00580000
*          DO;                                                     0240 00581000
*            MSGID='100I';          /* SET MESSAGE ID NUMBER */    0241 00582000
         MVC   MSGID(4),@CC00421                                   0241 00583000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0242 00584000
*                                      OUT ERROR MESSAGE */        0242 00585000
         B     CALMSG                                              0242 00586000
*          END;                                                    0243 00587000
*                                                                  0243 00588000
*        ELSE                                                      0244 00589000
*                                   /* ENTERED FROM TMP AND        0244 00590000
*                                      COMMANDNAME FROM PARSE NOT  0244 00591000
*                                      FOUND */                    0244 00592000
*          DO;                                                     0244 00593000
@RF00239 DS    0H                                                  0245 00594000
*            MSGID='100G';          /* SET MESSAGE ID NUMBER */    0245 00595000
         MVC   MSGID(4),@CC00422                                   0245 00596000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0246 00597000
*                                      OUT ERROR MESSAGE */        0246 00598000
         B     CALMSG                                              0246 00599000
*          END;                                                    0247 00600000
*                                                                  0247 00601000
*                                                                  0247 00602000
*                                                                  0247 00603000
*    FINDSUCS:                                                     0248 00604000
*        ;                                                         0248 00605000
*                                                                  0248 00606000
FINDSUCS DS    0H                                                  0249 00607000
*        /************************************************************/ 00608000
*        /*                                                          */ 00609000
*        /* FIND SUCCESSFUL DO A GETMAIN FOR THE CORE NEEDED TO HOLD */ 00610000
*        /* A BLOCK OF DATA FROM THE HELP DATA SET                   */ 00611000
*        /*                                                          */ 00612000
*        /************************************************************/ 00613000
*                                                                  0249 00614000
*    RFY REG1 RSTD;               /* RESTRICT FOR GETMAIN    @Y02668*/  00615000
*    RFY REG0 RSTD;               /* RESTRICT FOR GETMAIN    @Y02668*/  00616000
*        REG0=DCBBLKS;              /* BLOCK SIZE FROM DCB */      0251 00617000
         LA    @10,DCBBLKSI                                        0251 00618000
         LH    REG0,DCBBLKS(,@10)                                  0251 00619000
*        GENERATE;                                                 0252 00620000
         GETMAIN R,LV=(0)                                               00621000
*        COREGOTP=REG1;             /* SAVE ADDRESS OF GOTTEN CORE 0253 00622000
*                                      FOR THE FREEMAIN */         0253 00623000
         LR    COREGOTP,REG1                                       0253 00624000
*        DATAREAP=REG1;             /* FILL IN PARAMETER FOR IKJEFH02   00625000
*                                      */                          0254 00626000
         ST    REG1,DATAREAP                                       0254 00627000
*    RFY REG1 UNRSTD;             /* RELEASE FOR CMPLR       @Y02668*/  00628000
*    RFY REG0 UNRSTD;             /* RELASE FOR CMPLR        @Y02668*/  00629000
*                                                                  0256 00630000
*                                                                  0256 00631000
*        /************************************************************/ 00632000
*        /*                                                          */ 00633000
*        /*  SET SWITCHES AND FILL IN PARSE TABLE FOR IKJEFH02       */ 00634000
*        /*                                                          */ 00635000
*        /************************************************************/ 00636000
*                                                                  0257 00637000
*        IF MEMBER=COMMANDS THEN                                   0257 00638000
         CLC   MEMBER(8),COMMANDS                                  0257 00639000
         BNE   @RF00257                                            0257 00640000
*                                   /* COMMANDS MEMBER FOUND */    0258 00641000
*          DO;                                                     0258 00642000
*            SWCOMAND='1'B;         /* INDICATE MEMBER SEARCHING FOR    00643000
*                                      IS LIST OF COMMANDS */      0259 00644000
         OI    SWCOMAND,B'00100000'                                0259 00645000
*            GO TO HELPROCS;        /* SKIP TABLE CONSTRUCTION AND GO   00646000
*                                      TO CALL HELP PROCESSOR */   0260 00647000
         B     HELPROCS                                            0260 00648000
*          END;                                                    0261 00649000
*                                                                  0261 00650000
*                                                                  0261 00651000
*        /************************************************************/ 00652000
*        /*                                                          */ 00653000
*        /*  CONSTRUCT PARSE TABLE                                   */ 00654000
*        /*                                                          */ 00655000
*        /************************************************************/ 00656000
*                                                                  0262 00657000
*       IF (PDLOPER=1 | PDLFUN=1 | PDLALL=1 | PDLSYN=1 | PDLOPER=1) &   00658000
*           PDLMSGID=1 THEN   /* IF CONFLICTING KEYWORDS   */      0262 00659000
@RF00257 LA    @10,1                                               0262 00660000
         LH    @09,PDLOPER(,REG4)                                  0262 00661000
         CR    @09,@10                                             0262 00662000
         BE    @GL00001                                            0262 00663000
         CH    @10,PDLFUN(,REG4)                                   0262 00664000
         BE    @GL00001                                            0262 00665000
         CH    @10,PDLALL(,REG4)                                   0262 00666000
         BE    @GL00001                                            0262 00667000
         CH    @10,PDLSYN(,REG4)                                   0262 00668000
         BE    @GL00001                                            0262 00669000
         CR    @09,@10                                             0262 00670000
         BNE   @RF00262                                            0262 00671000
@GL00001 CLC   PDLMSGID(2,REG4),@CH00038                           0262 00672000
         BNE   @RF00262                                            0262 00673000
*        DO;                                                       0263 00674000
*          CONFLICT='1'B;     /* INDICATE CONFLICTING KEYWORDS  */ 0264 00675000
         OI    CONFLICT,B'10000000'                                0264 00676000
*          GOTO ENDDATA;      /* ISSUE MSG AND QUIT         */     0265 00677000
         B     ENDDATA                                             0265 00678000
*        END;                                                      0266 00679000
*      ELSE                                                        0267 00680000
*        DO;                                                       0267 00681000
@RF00262 DS    0H                                                  0268 00682000
*          IF PDLMSGID=1 THEN   /* IF NO CONFLICT  IN KEYWORDS  */ 0268 00683000
         CLC   PDLMSGID(2,REG4),@CH00038                           0268 00684000
         BNE   @RF00268                                            0268 00685000
*            PARSINDX=2;  /* BASE DSECT ON  MSGID PDL */           0269 00686000
         LA    PARSINDX,2                                          0269 00687000
*          ELSE                                                    0270 00688000
*            PARSINDX=1; /* BASE DSECT ON OPERAND PDL */           0270 00689000
         B     @RC00268                                            0270 00690000
@RF00268 LA    PARSINDX,1                                          0270 00691000
*        END;                                                      0271 00692000
@RC00268 DS    0H                                                  0272 00693000
*        IF PDLKEYP(PARSINDX)=0 THEN                               0272 00694000
         LR    @10,PARSINDX                                        0272 00695000
         MH    @10,@CH00467                                        0272 00696000
         L     @10,PDLKEYP-12(@10,REG4)                            0272 00697000
         LTR   @10,@10                                             0272 00698000
         BNZ   @RF00272                                            0272 00699000
*          KEYPTR='FF000000'X;      /* SIGNIFY NO KEYWORDS ENTERED */   00700000
         MVC   KEYPTR(4),@CF00426                                  0273 00701000
*        ELSE                                                      0274 00702000
*          KEYPTR=ADDR(PDLKEYP(PARSINDX));    /* OTHERWISE SET OPINTER  00703000
*                           IN PARSE   INFORMATION TABLE TO BEGINNING   00704000
*                                      OF KEYWORD LIST FROM PARSE */    00705000
*                                                                  0274 00706000
*                                                                  0274 00707000
         B     @RC00272                                            0274 00708000
@RF00272 LR    @10,PARSINDX                                        0274 00709000
         MH    @10,@CH00467                                        0274 00710000
         LA    @10,PDLKEYP-12(@10,REG4)                            0274 00711000
         ST    @10,KEYPTR                                          0274 00712000
*        IF ECTPCMD^=H THEN                                        0275 00713000
@RC00272 MVC   @TF00001(4),ECTPTR(CPPLPTR)                         0275 00714000
         L     @10,@TF00001                                        0275 00715000
         CLC   ECTPCMD(8,@10),H                                    0275 00716000
         BE    @RF00275                                            0275 00717000
*                                   /* HELP ENTERED FROM A CP */   0276 00718000
*          IF ECTPCMD^=HELP THEN                                   0276 00719000
         CLC   ECTPCMD(8,@10),HELP                                 0276 00720000
         BE    @RF00276                                            0276 00721000
*            DO;                                                   0277 00722000
*              IF PDLNAMEO='0'B THEN                               0278 00723000
         TM    PDLNAMEO(REG4),B'10000000'                          0278 00724000
         BNZ   @RF00278                                            0278 00725000
*                                   /* HELP BLANK ENTERED FOR A LIST    00726000
*                                      OF SUBCOMMANDS */           0279 00727000
*                DO;                                               0279 00728000
*                  CONTRL(1)=TABS;  /* PUT SUBCOMMAND LIST CONTROL 0280 00729000
*                                      CHARACTER IN PARSE INFORMATION   00730000
*                                      TABLE */                    0280 00731000
         MVC   CONTRL(2),TABS                                      0280 00732000
*                  SWSUBCOM='1'B;   /* INDICATE SUBCOMMAND LIST    0281 00733000
*                                      REQUESTED */                0281 00734000
         OI    SWSUBCOM,B'00010000'                                0281 00735000
*                  GO TO HELPROCS;  /* GO TO CALL HELP PROCESSOR */     00736000
         B     HELPROCS                                            0282 00737000
*                END;                                              0283 00738000
*                                                                  0283 00739000
*              IF MEMBER^=H THEN                                   0284 00740000
@RF00278 CLC   MEMBER(8),H                                         0284 00741000
         BE    @RF00284                                            0284 00742000
*                IF MEMBER^=HELP THEN                              0285 00743000
         CLC   MEMBER(8),HELP                                      0285 00744000
         BE    @RF00285                                            0285 00745000
*                                   /* 'HELP HELP' OR ABREVIATION NOT   00746000
*                                      ENTERED IN SUBCOMMAND MODE */    00747000
*                  IF MEMBER=PARSNAME THEN                         0286 00748000
         CLC   MEMBER(8),PARSNAME                                  0286 00749000
         BE    @RT00286                                            0286 00750000
*                                   /* HELP ON COMMAND ASKED FOR */     00751000
*                    GO TO FUNTEST; /* SKIP SUBCOMMAND SEARCH */   0287 00752000
*                                                                  0287 00753000
*                                                                  0287 00754000
*    SUBSERCH:                                                     0288 00755000
*                                                                  0288 00756000
*                                                                  0288 00757000
*        /************************************************************/ 00758000
*        /*                                                          */ 00759000
*        /*  SEARCH FOR SUBCOMMAND INFORMATION WITHIN A MEMBER       */ 00760000
*        /*                                                          */ 00761000
*        /************************************************************/ 00762000
*                                                                  0288 00763000
*              SWSUBSER='1'B;       /* INDICATE SEARCHING FOR A    0288 00764000
*                                      SUBCOMMAND */               0288 00765000
*                                                                  0288 00766000
@RF00285 DS    0H                                                  0288 00767000
@RF00284 DS    0H                                                  0288 00768000
SUBSERCH OI    SWSUBSER,B'00000010'                                0288 00769000
*    SUB1:                                                         0289 00770000
*              CALL IKJEFH03 (COMMON);                             0289 00771000
SUB1     LA    @10,COMMON                                          0289 00772000
         ST    @10,@AL00001                                        0289 00773000
         L     @15,@CV00431                                        0289 00774000
         LA    @01,@AL00001                                        0289 00775000
         BALR  @14,@15                                             0289 00776000
*                                   /* CALL READ ROUTINE */        0290 00777000
*              IF SWEOD='1'B THEN                                  0290 00778000
         TM    SWEOD,B'00001000'                                   0290 00779000
         BO    @RT00290                                            0290 00780000
*                                   /* IF END OF DATA FOUND GO TO  0291 00781000
*                                      EXIT ROUTINE */             0291 00782000
*                GO TO ENDDATA;                                    0291 00783000
*              IF SWERRMSG='1'B THEN                               0292 00784000
         TM    SWERRMSG,B'00000001'                                0292 00785000
         BO    @RT00292                                            0292 00786000
*                                   /* IF ERROR OCCURRED, GO TO EXIT    00787000
*                                      ROUTINE */                  0293 00788000
*                GO TO ENDDATA;                                    0293 00789000
*              IF DATAREA(1)^='=' THEN                             0294 00790000
         L     @10,DATAREAP                                        0294 00791000
         CLI   DATAREA(@10),C'='                                   0294 00792000
         BNE   @RT00294                                            0294 00793000
*                                   /* HELP DATA DOES NOT CONTAIN A     00794000
*                                      SUBCOMMAND NAME */          0295 00795000
*                GO TO SUB1;        /* GET NEXT DATA */            0295 00796000
*              I=1;                 /* INITIALIZE LEFT HAND COUNTER     00797000
*                                      */                          0296 00798000
*                                                                  0296 00799000
         LA    I,1                                                 0296 00800000
*    REPSUB:                                                       0297 00801000
*              DO J=I+1 TO I+9;     /* LOOK FOR SUBCOMMAND NAME */ 0297 00802000
REPSUB   LA    J,1                                                 0297 00803000
         ALR   J,I                                                 0297 00804000
         B     @DE00297                                            0297 00805000
@DL00297 DS    0H                                                  0298 00806000
*                IF DATAREA(J)='=' THEN                            0298 00807000
         L     @10,DATAREAP                                        0298 00808000
         LR    @09,@10                                             0298 00809000
         ALR   @09,J                                               0298 00810000
         BCTR  @09,0                                               0298 00811000
         CLI   DATAREA(@09),C'='                                   0298 00812000
         BE    @RT00298                                            0298 00813000
*                                   /* '=' DELIMETER */            0299 00814000
*                  GO TO OUTSUB;                                   0299 00815000
*                IF DATAREA(J)=' ' THEN                            0300 00816000
         ALR   @10,J                                               0300 00817000
         BCTR  @10,0                                               0300 00818000
         CLI   DATAREA(@10),C' '                                   0300 00819000
         BE    @RT00300                                            0300 00820000
*                                   /* BLANK DELIMETER */          0301 00821000
*                  GO TO OUTSUB;                                   0301 00822000
*              END;                                                0302 00823000
*                                                                  0302 00824000
         AH    J,@CH00038                                          0302 00825000
@DE00297 LA    @10,9                                               0302 00826000
         ALR   @10,I                                               0302 00827000
         CR    J,@10                                               0302 00828000
         BNH   @DL00297                                            0302 00829000
*    OUTSUB:                                                       0303 00830000
*            SAVEDATA=DATAREA(I+1:J-1);                            0303 00831000
OUTSUB   MVI   SAVEDATA+1,C' '                                     0303 00832000
         MVC   SAVEDATA+2(6),SAVEDATA+1                            0303 00833000
         LR    @10,J                                               0303 00834000
         SLR   @10,I                                               0303 00835000
         BCTR  @10,0                                               0303 00836000
         BCTR  @10,0                                               0303 00837000
         L     @09,DATAREAP                                        0303 00838000
         LR    @01,@09                                             0303 00839000
         ALR   @01,I                                               0303 00840000
         EX    @10,@SM00480                                        0303 00841000
*                                   /* EXPAND SUBCOMMAND NAME TO 8 0304 00842000
*                                      CHAR */                     0304 00843000
*            IF SAVEDATA^=PARSNAME THEN                            0304 00844000
         CLC   SAVEDATA(8),PARSNAME                                0304 00845000
         BE    @RF00304                                            0304 00846000
*                                   /* SUBCOMMAND NAME FROM DATA SET    00847000
*                                      NOT NAME FROM PARSE */      0305 00848000
*              IF DATAREA(J)='=' THEN                              0305 00849000
         ALR   @09,J                                               0305 00850000
         BCTR  @09,0                                               0305 00851000
         CLI   DATAREA(@09),C'='                                   0305 00852000
         BNE   @RF00305                                            0305 00853000
*                                   /* IF NOT LAST SUBCOMMAND NAME ON   00854000
*                                      CARD IMAGE THEN GO TO LOOK AT    00855000
*                                      NEXT NAME */                0306 00856000
*                DO;                                               0306 00857000
*                  I=J;             /* RESET LEFT HAND COUNTER */  0307 00858000
         LR    I,J                                                 0307 00859000
*                  GO TO REPSUB;                                   0308 00860000
         B     REPSUB                                              0308 00861000
*              END;                                                0309 00862000
*            ELSE                                                  0310 00863000
*              GO TO SUB1;          /* IF LAST ON CARD THEN GO TO GET   00864000
*                                      NEXT CARD IMAGE */          0310 00865000
*            ELSE                                                  0311 00866000
*              SWSUBSER='0'B;       /* FOUND SUBCOMMAND NAME WANTED     00867000
*                                      TURN OFF SWITCH IN SUBSERSCH     00868000
*                                      ROUTINE */                  0311 00869000
@RF00304 NI    SWSUBSER,B'11111101'                                0311 00870000
*          END;                                                    0312 00871000
*                                                                  0312 00872000
*                                                                  0312 00873000
*        /************************************************************/ 00874000
*        /*                                                          */ 00875000
*        /*  SET UP TABLE FROM PARSE INFORMATION                     */ 00876000
*        /*                                                          */ 00877000
*        /************************************************************/ 00878000
*                                                                  0313 00879000
*                                                                  0313 00880000
*    FUNTEST:                                                      0313 00881000
*                                   /* TEST FOR CONTROL CHARACTERS */   00882000
*        IF PDLFUN=1 THEN                                          0313 00883000
@RF00276 DS    0H                                                  0313 00884000
@RF00275 DS    0H                                                  0313 00885000
FUNTEST  CLC   PDLFUN(2,REG4),@CH00038                             0313 00886000
         BNE   @RF00313                                            0313 00887000
*                                   /* FUNCTION INDICATED FROM PARSE    00888000
*                                      */                          0314 00889000
*          DO;                                                     0314 00890000
*            CONTRL(2)=TABF;        /* FILL IN PARSE INFORMATION   0315 00891000
*                                      TABLE */                    0315 00892000
         MVC   CONTRL+2(2),TABF                                    0315 00893000
*            SWPARSE='1'B;          /* INDICATE ENTRY IN PARSE TABLE    00894000
*                                      */                          0316 00895000
         OI    SWPARSE,B'00001000'                                 0316 00896000
*          END;                                                    0317 00897000
*                                                                  0317 00898000
*        IF PDLSYN=1 THEN                                          0318 00899000
@RF00313 CLC   PDLSYN(2,REG4),@CH00038                             0318 00900000
         BNE   @RF00318                                            0318 00901000
*                                   /* SYNTAX INDICATED FROM PARSE */   00902000
*          DO;                                                     0319 00903000
*            CONTRL(3)=TABX;        /* FILL IN PARSE INFORMATION   0320 00904000
*                                      TABLE */                    0320 00905000
         MVC   CONTRL+4(2),TABX                                    0320 00906000
*            SWPARSE='1'B;          /* INDICATE ENTRY IN PARSE TABLE    00907000
*                                      */                          0321 00908000
         OI    SWPARSE,B'00001000'                                 0321 00909000
*          END;                                                    0322 00910000
*                                                                  0322 00911000
*       IF (PDLOPER=1 | PDLFUN=1 | PDLALL=1 | PDLSYN=1 | PDLOPER=1) &   00912000
*           PDLMSGID=1 THEN        /* IF CONFLICTING KEYWORDS  */  0323 00913000
@RF00318 LA    @10,1                                               0323 00914000
         LH    @09,PDLOPER(,REG4)                                  0323 00915000
         CR    @09,@10                                             0323 00916000
         BE    @GL00006                                            0323 00917000
         CH    @10,PDLFUN(,REG4)                                   0323 00918000
         BE    @GL00006                                            0323 00919000
         CH    @10,PDLALL(,REG4)                                   0323 00920000
         BE    @GL00006                                            0323 00921000
         CH    @10,PDLSYN(,REG4)                                   0323 00922000
         BE    @GL00006                                            0323 00923000
         CR    @09,@10                                             0323 00924000
         BNE   @RF00323                                            0323 00925000
@GL00006 CLC   PDLMSGID(2,REG4),@CH00038                           0323 00926000
         BNE   @RF00323                                            0323 00927000
*          DO;                                                     0324 00928000
*            CONFLICT = '1'B;       /* INDICATE CONFLICTING KEYWORDS */ 00929000
         OI    CONFLICT,B'10000000'                                0325 00930000
*            GOTO ENDDATA;                                         0326 00931000
         B     ENDDATA                                             0326 00932000
*          END;                                                    0327 00933000
*        ELSE                                                      0328 00934000
*        IF PDLMSGID=1 THEN       /* IF MSGID ENTERED        */    0328 00935000
@RF00323 CLC   PDLMSGID(2,REG4),@CH00038                           0328 00936000
         BNE   @RF00328                                            0328 00937000
*          DO;                                                     0329 00938000
*            SWPARSE='1'B;        /* INDICATE ENTRY IN PARSE TABLE   */ 00939000
         OI    SWPARSE,B'00001000'                                 0330 00940000
*            PARSINDX=2; /* BASE DSECT ON MSGID PDL */             0331 00941000
         LA    PARSINDX,2                                          0331 00942000
*            IF PDLKEYP(PARSINDX)=0 THEN /* IF NO KEYWORDS ON LIST  */  00943000
         LR    @10,PARSINDX                                        0332 00944000
         MH    @10,@CH00467                                        0332 00945000
         L     @10,PDLKEYP-12(@10,REG4)                            0332 00946000
         LTR   @10,@10                                             0332 00947000
         BNZ   @RF00332                                            0332 00948000
*             CONTRL(5)=TABM;           /* DEFAULT TO ALL MSGIDS   */   00949000
         MVC   CONTRL+8(2),TABM                                    0333 00950000
*          END;                                                    0334 00951000
*        ELSE                                                      0335 00952000
*        IF PDLOPER=1 THEN                                         0335 00953000
         B     @RC00328                                            0335 00954000
@RF00328 LA    @10,1                                               0335 00955000
         CH    @10,PDLOPER(,REG4)                                  0335 00956000
         BNE   @RF00335                                            0335 00957000
*          DO;                                                     0336 00958000
*            PARSINDX=1; /* BASE DSECT ON OPERAND PDL */           0337 00959000
         LR    PARSINDX,@10                                        0337 00960000
*            SWPARSE='1'B;        /* INDICATE ENTRY IN PARSE TABLE   */ 00961000
         OI    SWPARSE,B'00001000'                                 0338 00962000
*            IF PDLKEYP(PARSINDX)=0 THEN     /* NO KEYWORDS IN LIST */  00963000
         LR    @10,PARSINDX                                        0339 00964000
         MH    @10,@CH00467                                        0339 00965000
         L     @10,PDLKEYP-12(@10,REG4)                            0339 00966000
         LTR   @10,@10                                             0339 00967000
         BNZ   @RF00339                                            0339 00968000
*              CONTRL(4)=TABO;      /* FILL IN OPERANDS IN PARSE   0340 00969000
*                                      TABLE, THIS WILL CAUSE ALL  0340 00970000
*                                      KEYWORDS TO BE PUT OUT */   0340 00971000
         MVC   CONTRL+6(2),TABO                                    0340 00972000
*          END;                                                    0341 00973000
@RF00339 DS    0H                                                  0342 00974000
*        IF SWPARSE='1'B THEN                                      0342 00975000
@RF00335 DS    0H                                                  0342 00976000
@RC00328 TM    SWPARSE,B'00001000'                                 0342 00977000
         BNO   @RF00342                                            0342 00978000
*                                   /* ALL NOT SPECIFIED OR DEFAULT,    00979000
*                                      THEN FINISHED SETTING PARSE 0343 00980000
*                                      TABLE */                    0343 00981000
*          IF PDLALL^=1 THEN                                       0343 00982000
         CLC   PDLALL(2,REG4),@CH00038                             0343 00983000
         BNE   @RT00343                                            0343 00984000
*            GO TO HELPROCS;                                       0344 00985000
*        CONTLST=WHOLTAB;           /* ALL SPECIFIED OR DEFAULT, FILL   00986000
*                                      IN WHOLE TABLE */           0345 00987000
*                                                                  0345 00988000
*                                                                  0345 00989000
@RF00342 LA    @10,PARSETAB                                        0345 00990000
         MVI   CONTLST+8(@10),C' '                                 0345 00991000
         MVI   CONTLST+9(@10),C' '                                 0345 00992000
         MVC   CONTLST(8,@10),WHOLTAB                              0345 00993000
*    HELPROCS:                                                     0346 00994000
*                                                                  0346 00995000
*        /************************************************************/ 00996000
*        /*                                                          */ 00997000
*        /*  PROCESS MEMBER                                          */ 00998000
*        /*                                                          */ 00999000
*        /************************************************************/ 01000000
*                                                                  0346 01001000
*        CALL IKJEFH02(COMMON,PARSETAB);                           0346 01002000
HELPROCS LA    @10,COMMON                                          0346 01003000
         ST    @10,@AL00001                                        0346 01004000
         LA    @10,PARSETAB                                        0346 01005000
         ST    @10,@AL00001+4                                      0346 01006000
         L     @15,@CV00440                                        0346 01007000
         LA    @01,@AL00001                                        0346 01008000
         BALR  @14,@15                                             0346 01009000
*                                   /* CALL HELP PROCESSING ROUTINE     01010000
*                                      */                          0347 01011000
*                                                                  0347 01012000
*    ENDDATA:                                                      0347 01013000
*                                                                  0347 01014000
*        /************************************************************/ 01015000
*        /*                                                          */ 01016000
*        /*  FINISHED PROCESSING MEMBER                              */ 01017000
*        /*                                                          */ 01018000
*        /************************************************************/ 01019000
*                                                                  0347 01020000
*        /************************************************************/ 01021000
*        /*                                                          */ 01022000
*        /*  FREE CORE GOTTEN TO HOLD BLOCK OF DATA FROM HELP DATA   */ 01023000
*        /*  SET                                                     */ 01024000
*        /*                                                          */ 01025000
*        /************************************************************/ 01026000
*        REG0=DCBBLKS;              /* BLOCK SIZE FROM DCB */      0347 01027000
ENDDATA  LA    @10,DCBBLKSI                                        0347 01028000
         LH    REG0,DCBBLKS(,@10)                                  0347 01029000
*     RFY REG1 RSTD;              /* RESTRICT FOR FREEMAIN   @Y02668*/  01030000
*        REG1=COREGOTP;             /* ADDRESS OF GOTTEN CORE */   0349 01031000
         LR    REG1,COREGOTP                                       0349 01032000
*        GENERATE;                                                 0350 01033000
         FREEMAIN R,LV=(0),A=(1)                                        01034000
*    RFY REG1 UNRSTD;             /* RELEASE FOR CMPLR USE   @Y02668*/  01035000
*                                                                  0351 01036000
*        IF SWERRMSG='1'B THEN                                     0352 01037000
         TM    SWERRMSG,B'00000001'                                0352 01038000
         BO    @RT00352                                            0352 01039000
*                                   /* IF AN ERROR OCCURRED, THEN  0353 01040000
*                                       RETURN */                  0353 01041000
*          GO TO RT;                                               0353 01042000
*                                                                  0353 01043000
*                                                                  0353 01044000
*        /************************************************************/ 01045000
*        /*                                                          */ 01046000
*        /*  DETERMINE ERROR MESSAGES NECESSARY                      */ 01047000
*        /*                                                          */ 01048000
*        /************************************************************/ 01049000
*                                                                  0354 01050000
*        IF SWSUBSER='1'B THEN                                     0354 01051000
         TM    SWSUBSER,B'00000010'                                0354 01052000
         BNO   @RF00354                                            0354 01053000
*                                   /* SUBCOMMAND NOT FOUND IN MEMBER   01054000
*                                      PUT OUT ERROR MESSAGE */    0355 01055000
*          DO;                                                     0355 01056000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0356 01057000
         OI    SWERRMSG,B'00000001'                                0356 01058000
*            SW=0;                  /* INIT JEFF02 PARMS     @ZA11850*/ 01059000
         MVI   SW,X'00'                                            0357 01060000
*            SW2=0;                 /* MORE PARMS TO INIT    @ZA11850*/ 01061000
         MVI   SW2,X'00'                                           0358 01062000
*            MTNOIDSW='0'B;         /* INDICATE MSGID PRESENT@ZA11850*/ 01063000
*            MTPUTLSW='1'B;         /* REQ. PUTLINE ONLY     @ZA11850*/ 01064000
         OI    MTPUTLSW,B'01000000'                                0360 01065000
         NI    MTNOIDSW,B'01111111'                                0360 01066000
*            IF PARSNAME=HELP THEN                                 0361 01067000
         CLC   PARSNAME(8),HELP                                    0361 01068000
         BNE   @RF00361                                            0361 01069000
*                                   /* SUBCOMMAND HELP NOT FOUND */     01070000
*              DO;                                                 0362 01071000
*                MSGID='100L';      /* SET MESSAGE ID NUMBER */    0363 01072000
         MVC   MSGID(4),@CC00443                                   0363 01073000
*                GO TO CALMSG;      /* CALL MESSAGE ROUTINE TO PUT 0364 01074000
*                                      OUT ERROR MESSAGE */        0364 01075000
         B     CALMSG                                              0364 01076000
*              END;                                                0365 01077000
*            ELSE                                                  0366 01078000
*                                   /* ANY SUBCOMMAND BUT HELP NOT 0366 01079000
*                                      FOUND TELL TERMINAL USER    0366 01080000
*                                      'HELP' CAN BE ENTERED FOR MORE   01081000
*                                      INFORMATION */              0366 01082000
*              DO;                                                 0366 01083000
@RF00361 DS    0H                                                  0367 01084000
*                VAR1=ADDR(PARSNAME);                      /*@Y02668*/  01085000
         LA    @10,PARSNAME                                        0367 01086000
         ST    @10,@TF00001                                        0367 01087000
         MVC   VAR1(3),@TF00001+1                                  0367 01088000
*                                   /* ADDRESS OF NAME OF COMMAND OR    01089000
*                                      SUBCOMMAND FROM PARSE */    0368 01090000
*                L1=PDLNAMER;   /* LENGTH OF VARIABLE FOR MESSAGE  0368 01091000
*                                                            @Y02668*/  01092000
         MVC   L1(1),PDLNAMER(REG4)                                0368 01093000
*                MSGID='100K';      /* SET MESSAGE ID NUMBER */    0369 01094000
         MVC   MSGID(4),@CC00444                                   0369 01095000
*                GO TO CALMSG;      /* CALL MESSAGE ROUTINE TO PUT 0370 01096000
*                                      OUT ERROR MESSAGE */        0370 01097000
         B     CALMSG                                              0370 01098000
*              END;                                                0371 01099000
*          END;                                                    0372 01100000
*        SW=0;                    /* ZERO MSGTABLE SWITCHES  @Y02668*/  01101000
@RF00354 MVI   SW,X'00'                                            0373 01102000
*        SW2=0;                   /* ZERO MSGTABLE SWITCHES  @Y02668*/  01103000
         MVI   SW2,X'00'                                           0374 01104000
*        MTNOIDSW='0'B;           /* INDICATE MSGID PRESENT  @Y02668*/  01105000
*        MTPUTLSW='1'B;           /* DO PUTLINE NOT PUTGET   @Y02668*/  01106000
*                                                                  0376 01107000
         OI    MTPUTLSW,B'01000000'                                0376 01108000
         NI    MTNOIDSW,B'01111111'                                0376 01109000
*        IF CONFLICT='1'B THEN   /* IF CONFLICTING KEYWORDS  */    0377 01110000
         TM    CONFLICT,B'10000000'                                0377 01111000
         BNO   @RF00377                                            0377 01112000
*          DO;                                                     0378 01113000
*            MSGID='100U';         /* ISSUE MSG                  */     01114000
         MVC   MSGID(4),@CC00445                                   0379 01115000
*            SWERRMSG='1'B;   /* INDICATE ERROR  */                0380 01116000
         OI    SWERRMSG,B'00000001'                                0380 01117000
*            GOTO CALMSG;         /* CALL MSG WRITER            */ 0381 01118000
         B     CALMSG                                              0381 01119000
*          END;                                                    0382 01120000
*        IF SWCOMAND='1'B THEN                                     0383 01121000
@RF00377 TM    SWCOMAND,B'00100000'                                0383 01122000
         BNO   @RF00383                                            0383 01123000
*                                   /* AFTER LIST OF COMMANDS */   0384 01124000
*          DO;                                                     0384 01125000
*            MSGID='100N';          /* SET MESSAGE ID NUMBER */    0385 01126000
         MVC   MSGID(4),@CC00446                                   0385 01127000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0386 01128000
*                                      OUT ERROR MESSAGE */        0386 01129000
         B     CALMSG                                              0386 01130000
*          END;                                                    0387 01131000
*                                                                  0387 01132000
*        IF SWSUBCOM='1'B THEN                                     0388 01133000
@RF00383 TM    SWSUBCOM,B'00010000'                                0388 01134000
         BNO   @RF00388                                            0388 01135000
*                                   /* SUBCOMMAND LIST REQUESTED */     01136000
*          DO;                                                     0389 01137000
*            IF SWFOUND='1'B THEN                                  0390 01138000
         TM    SWFOUND,B'10000000'                                 0390 01139000
         BNO   @RF00390                                            0390 01140000
*                                   /* SUBCOMMAND LIST FOUND-TELL  0391 01141000
*                                      TERMINAL USER 'HELP HELP' OR     01142000
*                                      'HELP SUBCOMMANDNAME' CAN BE     01143000
*                                      ENTERED FOR MORE INFORMATION     01144000
*                                      */                          0391 01145000
*              DO;                                                 0391 01146000
*                MSGID='100O';      /* SET MESSAGE ID NUMBER */    0392 01147000
         MVC   MSGID(4),@CC00447                                   0392 01148000
*                GO TO CALMSG;      /* CALL MESSAGE ROUTINE TO PUT 0393 01149000
*                                      OUT ERROR MESSAGE */        0393 01150000
         B     CALMSG                                              0393 01151000
*              END;                                                0394 01152000
*            ELSE                                                  0395 01153000
*                                   /* SUBCOMMAND LIST NOT FOUND */     01154000
*              DO;                                                 0395 01155000
@RF00390 DS    0H                                                  0396 01156000
*                SWERRMSG='1'B;     /* INDICATE ERROR OCCURRED */  0396 01157000
         OI    SWERRMSG,B'00000001'                                0396 01158000
*                MSGID='100M';      /* SET MESSAGE ID NUMBER */    0397 01159000
         MVC   MSGID(4),@CC00448                                   0397 01160000
*                VAR1=ADDR(MEMBER);                        /*@Y02668*/  01161000
         LA    @10,MEMBER                                          0398 01162000
         ST    @10,@TF00001                                        0398 01163000
         MVC   VAR1(3),@TF00001+1                                  0398 01164000
*                                   /* ADDRESS OF NAME OF COMMAND  0399 01165000
*                                      SEARCHED FOR */             0399 01166000
*                L1=MEMLEN;     /* LENGTH OF VARIABLE FOR MESSAGE  0399 01167000
*                                                            @Y02668*/  01168000
         MVC   L1(1),MEMLEN                                        0399 01169000
*                GO TO CALMSG;      /* CALL MESSAGE ROUTINE TO PUT 0400 01170000
*                                      OUT ERROR MESSAGE */        0400 01171000
         B     CALMSG                                              0400 01172000
*              END;                                                0401 01173000
*          END;                                                    0402 01174000
*                                                                  0402 01175000
*                                                                  0402 01176000
*        /************************************************************/ 01177000
*        /*                                                          */ 01178000
*        /*  SEE IF NECESSARY TO CHECK PARSE INFORMATION TABLE TO    */ 01179000
*        /*  SEE IF  EVERYTHING REQUESTED HAS BEEN FOUND             */ 01180000
*        /*                                                          */ 01181000
*        /************************************************************/ 01182000
*                                                                  0403 01183000
*        IF SWFOUND='1'B THEN                                      0403 01184000
@RF00388 TM    SWFOUND,B'10000000'                                 0403 01185000
         BO    @RT00403                                            0403 01186000
*                                   /* IF EVERYTHING FOUND RETURN */    01187000
*          GO TO RT;                                               0404 01188000
*                                                                  0404 01189000
*        /************************************************************/ 01190000
*        /*                                                          */ 01191000
*        /*  CHECK PARSE INFORMATION TABLE TO SEE IF EVERYTHING      */ 01192000
*        /*  REQUESTED HAS BEEN FOUND                                */ 01193000
*        /*                                                          */ 01194000
*        /************************************************************/ 01195000
*                                                                  0405 01196000
*                                                                  0405 01197000
*        VAR1=ADDR(PARSNAME);  /* EACH OF THE FOLLOWING MESSAGES   0405 01198000
*                                      WILL CONTAIN THE NAME OF THE     01199000
*                                      COMMAND OR SUBCOMMAND FROM  0405 01200000
*                                      PARSE                 @Y02668*/  01201000
         LA    @10,PARSNAME                                        0405 01202000
         ST    @10,@TF00001                                        0405 01203000
         MVC   VAR1(3),@TF00001+1                                  0405 01204000
*        L1=PDLNAMER;           /* SET LENGTH OF NAME        @Y02668*/  01205000
         MVC   L1(1),PDLNAMER(REG4)                                0406 01206000
*        MSGID='100P';              /* SET MESSAGE ID NUMBER */    0407 01207000
         MVC   MSGID(4),@CC00449                                   0407 01208000
*        SWMSGLOP='1'B;             /* INDICATE MIGHT WANT TO PUT OUT   01209000
*                                      MORE THAN ONE MESSAGE */    0408 01210000
         OI    SWMSGLOP,B'00010000'                                0408 01211000
*        VAR2=ADDR(INSERT);    /* SET ADDRESS OF VARIABLE    @Y02668*/  01212000
*                                                                  0409 01213000
         LA    @10,INSERT                                          0409 01214000
         ST    @10,@TF00001                                        0409 01215000
         MVC   VAR2(3),@TF00001+1                                  0409 01216000
*      IF CONTRL(5)=')M' THEN    /* IF MSGID INFO NOT FOUND  */    0410 01217000
         CLC   CONTRL+8(2),@CC00382                                0410 01218000
         BNE   @RF00410                                            0410 01219000
*         DO;                                                      0411 01220000
*           SWERRMSG='1'B;     /* INDICATE ERROR   */              0412 01221000
         OI    SWERRMSG,B'00000001'                                0412 01222000
*           INSERT='MSGID';  /* PUT  "MSGID" INSERT INTO MSG */    0413 01223000
         MVI   INSERT+5,C' '                                       0413 01224000
         MVC   INSERT+6(2),INSERT+5                                0413 01225000
         MVC   INSERT(5),@CC00450                                  0413 01226000
*           L2='00000101'B; /* LENGTH OF VARIABLE FOR MSG */       0414 01227000
         MVI   L2,X'05'                                            0414 01228000
*           SWMSGLOP='0'B;   /* INDICATE NO MORE PARSE ENTRIES */  0415 01229000
         NI    SWMSGLOP,B'11101111'                                0415 01230000
*           GOTO CALMSG;     /* CALL MSG WRITER  */                0416 01231000
         B     CALMSG                                              0416 01232000
*         END;                                                     0417 01233000
*                                                                  0417 01234000
*        IF CONTRL(2)=')F' THEN                                    0418 01235000
@RF00410 CLC   CONTRL+2(2),@CC00376                                0418 01236000
         BNE   @RF00418                                            0418 01237000
*                                   /* FUNCTION INFORMATION NOT FOUND   01238000
*                                      */                          0419 01239000
*          DO;                                                     0419 01240000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0420 01241000
         OI    SWERRMSG,B'00000001'                                0420 01242000
*            INSERT='FUNCTION';     /* SET VARIABLE */             0421 01243000
         MVC   INSERT(8),@CC00452                                  0421 01244000
*            L2='00001000'B;    /* LENGTH OF VARIABLE FOR MESSAGE  0422 01245000
*                                                            @Y02668*/  01246000
         MVI   L2,X'08'                                            0422 01247000
*            LABLP=ADDR(CKX);       /* AFTER PUTTING OUT MESSAGE GO     01248000
*                                      TO CHECK SYNTAX INFORMATION */   01249000
         LA    @10,CKX                                             0423 01250000
         ST    @10,LABLP                                           0423 01251000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0424 01252000
*                                      OUT ERROR MESSAGE */        0424 01253000
         B     CALMSG                                              0424 01254000
*          END;                                                    0425 01255000
*                                                                  0425 01256000
*                                                                  0425 01257000
*    CKX:                                                          0426 01258000
*        IF CONTRL(3)=')X' THEN                                    0426 01259000
@RF00418 DS    0H                                                  0426 01260000
CKX      CLC   CONTRL+4(2),@CC00378                                0426 01261000
         BNE   @RF00426                                            0426 01262000
*                                   /* SYNTAX INFORMATION NOT FOUND     01263000
*                                      */                          0427 01264000
*          DO;                                                     0427 01265000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0428 01266000
         OI    SWERRMSG,B'00000001'                                0428 01267000
*            INSERT='SYNTAX';       /* SET VARIABLE */             0429 01268000
         MVI   INSERT+6,C' '                                       0429 01269000
         MVI   INSERT+7,C' '                                       0429 01270000
         MVC   INSERT(6),@CC00454                                  0429 01271000
*            L2='00000110'B;    /* LENGTH OF VARIABLE FOR MESSAGE  0430 01272000
*                                                            @Y02668*/  01273000
         MVI   L2,X'06'                                            0430 01274000
*            LABLP=ADDR(CKO);       /* AFTER PUTTING OUT MESSAGE GO     01275000
*                                      TO CHECK OPERANDS INFORMATION    01276000
*                                      */                          0431 01277000
         LA    @10,CKO                                             0431 01278000
         ST    @10,LABLP                                           0431 01279000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0432 01280000
*                                      OUT ERROR MESSAGE */        0432 01281000
         B     CALMSG                                              0432 01282000
*          END;                                                    0433 01283000
*                                                                  0433 01284000
*                                                                  0433 01285000
*                                                                  0433 01286000
*    CKO:                                                          0434 01287000
*        IF CONTRL(4)=')O' THEN                                    0434 01288000
@RF00426 DS    0H                                                  0434 01289000
CKO      CLC   CONTRL+6(2),@CC00380                                0434 01290000
         BNE   @RF00434                                            0434 01291000
*                                   /* OPERANDS INFORMATION NOT FOUND   01292000
*                                      */                          0435 01293000
*          DO;                                                     0435 01294000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0436 01295000
         OI    SWERRMSG,B'00000001'                                0436 01296000
*            INSERT='OPERANDS';     /* SET VARIABLE */             0437 01297000
         MVC   INSERT(8),@CC00457                                  0437 01298000
*            L2='00001000'B;    /* LENGTH OF VARIABLE FOR MESSAGE  0438 01299000
*                                                            @Y02668*/  01300000
         MVI   L2,X'08'                                            0438 01301000
*            LABLP=ADDR(CKKY);      /* AFTER PUTTING OUT MESSAGE GO     01302000
*                                      TO CHECK KEYWORD INFORMATION*/   01303000
         LA    @10,CKKY                                            0439 01304000
         ST    @10,LABLP                                           0439 01305000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0440 01306000
*                                      OUT ERROR MESSAGE */        0440 01307000
         B     CALMSG                                              0440 01308000
*          END;                                                    0441 01309000
*                                                                  0441 01310000
*                                                                  0441 01311000
*    CKKY:                                                         0442 01312000
*        IF PDLKEYP(PARSINDX)=0 THEN                               0442 01313000
@RF00434 DS    0H                                                  0442 01314000
CKKY     LR    @10,PARSINDX                                        0442 01315000
         MH    @10,@CH00467                                        0442 01316000
         L     @09,PDLKEYP-12(@10,REG4)                            0442 01317000
         LTR   @09,@09                                             0442 01318000
         BZ    @RT00442                                            0442 01319000
*                                   /* NO KEYWORD LIST SKIP TO     0443 01320000
*                                      CLEANUP */                  0443 01321000
*          GO TO RT;                                               0443 01322000
*        LISTP=ADDR(PDLKEYP(PARSINDX));       /* OTHERWISE POINT TO     01323000
*                                     BEGINNING OF KEYWORD LIST */ 0444 01324000
*                                                                  0444 01325000
*                                                                  0444 01326000
         LA    @10,PDLKEYP-12(@10,REG4)                            0444 01327000
         ST    @10,LISTP                                           0444 01328000
*    CKKYEND:                                                      0445 01329000
*        IF KWRD='1'B THEN                                         0445 01330000
CKKYEND  L     @10,LISTP                                           0445 01331000
         TM    KWRD(@10),B'10000000'                               0445 01332000
         BNO   @RF00445                                            0445 01333000
*                                   /* A KEYWORD NOT FOUND */      0446 01334000
*          DO;                                                     0446 01335000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0447 01336000
         OI    SWERRMSG,B'00000001'                                0447 01337000
*            MSGID='100Q';          /* SET MESSAGE ID NUMBER */    0448 01338000
         MVC   MSGID(4),@CC00461                                   0448 01339000
*            VAR2=KWRDP;       /* SET VARIABLE TO POINT TO   @Y02668    01340000
*                                      KEYWORD MISSING */          0449 01341000
         MVC   VAR2(3),KWRDP+1(@10)                                0449 01342000
*            L2=KWRDLEN;        /* LENGTH OF VARIABLE FOR MESSAGE  0450 01343000
*                                                            @Y02668*/  01344000
         MVC   L2(1),KWRDLEN(@10)                                  0450 01345000
*            LABLP=ADDR(CKKYAGN);   /* AFTER PUTTING OUT MESSAGE GO     01346000
*                                      TO CHECK NEXT KEYWORD */    0451 01347000
         LA    @10,CKKYAGN                                         0451 01348000
         ST    @10,LABLP                                           0451 01349000
*            GO TO CALMSG;          /* CALL MESSAGE ROUTINE TO PUT 0452 01350000
*                                      OUT ERROR MESSAGE */        0452 01351000
         B     CALMSG                                              0452 01352000
*          END;                                                    0453 01353000
*                                                                  0453 01354000
*    CKKYAGN:                                                      0454 01355000
*        LISTP=NXTLSTP;             /* POINT TO NEXT KEYWORD */    0454 01356000
@RF00445 DS    0H                                                  0454 01357000
CKKYAGN  L     @10,LISTP                                           0454 01358000
         L     @10,NXTLSTP(,@10)                                   0454 01359000
         ST    @10,LISTP                                           0454 01360000
*        IF LISTP='FF000000'X THEN                                 0455 01361000
         CL    @10,@CF00426                                        0455 01362000
         BE    @RT00455                                            0455 01363000
*                                   /* END OF LIST QUIT */         0456 01364000
*          GO TO RT;                                               0456 01365000
*        GO TO CKKYEND;             /* OTHERWISE REPEAT PROCESS */ 0457 01366000
*                                                                  0457 01367000
         B     CKKYEND                                             0457 01368000
*    CALMSG:                                                       0458 01369000
*                                                                  0458 01370000
*        /************************************************************/ 01371000
*        /*                                                          */ 01372000
*        /*  CALL IKJEFF02 - MESSAGE ROUTINE                         */ 01373000
*        /*                                                          */ 01374000
*        /************************************************************/ 01375000
*                                                                  0458 01376000
*    RFY REG1 RSTD;               /* RESTRICT FOR CALL       @Y02668*/  01377000
CALMSG   DS    0H                                                  0459 01378000
*    REG1 = ADDR(MSGTABLE);       /* PARM FOR IKJEFF02       @Y02668*/  01379000
         LA    REG1,MSGTABLE                                       0459 01380000
*        CALL IKJEFF02;                                    /*@Y02668*/  01381000
         L     @15,@CV00363                                        0460 01382000
         BALR  @14,@15                                             0460 01383000
*                                   /* PUT OUT ERROR MESSAGE */    0461 01384000
*    RFY REG1 UNRSTD;             /* RELEASE REG1            @Y02668*/  01385000
*        IF REG15^=0 THEN                                          0462 01386000
         LTR   REG15,REG15                                         0462 01387000
         BZ    @RF00462                                            0462 01388000
*          DO;                      /* IF MESSAGE ROUTINE IS NOT   0463 01389000
*                                      SUCCESSFUL FOR ANY REASON QUIT   01390000
*                                      */                          0463 01391000
*            SWERRMSG='1'B;         /* INDICATE ERROR OCCURRED */  0464 01392000
         OI    SWERRMSG,B'00000001'                                0464 01393000
*            GO TO RT;              /* GO TO CLEANUP */            0465 01394000
         B     RT                                                  0465 01395000
*          END;                                                    0466 01396000
*        IF SWMSGLOP='1'B THEN                                     0467 01397000
@RF00462 TM    SWMSGLOP,B'00010000'                                0467 01398000
         BNO   @RF00467                                            0467 01399000
*                                   /* IF CHECKING PARSE INFORMATION    01400000
*                                      TABLE TO SEE IF ALL         0468 01401000
*                                      INFORMATION FOUND, GO TO CHECK   01402000
*                                      THE NEXT ITEM */            0468 01403000
*          GO TO CKAGN;                                            0468 01404000
*                                                                  0468 01405000
*                                                                  0468 01406000
*                                                                  0468 01407000
         L     @10,LABLP                                           0468 01408000
         BR    @10                                                 0468 01409000
*    RT:                                                           0469 01410000
*                                                                  0469 01411000
*        /************************************************************/ 01412000
*        /*                                                          */ 01413000
*        /*  CLOSE HELP DATA SET                                     */ 01414000
*        /*                                                          */ 01415000
*        /************************************************************/ 01416000
*                                                                  0469 01417000
*        IF SWCLOSE='0'B THEN                                      0469 01418000
@RF00467 DS    0H                                                  0469 01419000
RT       TM    SWCLOSE,B'10000000'                                 0469 01420000
         BZ    @RT00469                                            0469 01421000
*                                   /* IF NEVER OPENED SKIP CLOSE AND   01422000
*                                                 RELEASE OF PDL     */ 01423000
*          GO TO RETRN;                                    /*@Y02668*/  01424000
*    RFY REG1 RSTD;               /* RESTRICT FOR CLOSE      @Y02668*/  01425000
*        GENERATE;                                                 0472 01426000
         CLOSE ((2)),MF=(E,DCBOPN)                                      01427000
*    RFY REG1 UNRSTD;             /* RELEASE FOR CMPLR       @Y02668*/  01428000
*                                                                  0473 01429000
*                                                                  0473 01430000
*        /************************************************************/ 01431000
*        /*                                                          */ 01432000
*        /*  RELEASE PDL                                             */ 01433000
*        /*                                                          */ 01434000
*        /************************************************************/ 01435000
*                                                                  0474 01436000
*        IF SWPARS='0'B THEN                                       0474 01437000
         TM    SWPARS,B'01000000'                                  0474 01438000
         BZ    @RT00474                                            0474 01439000
*                                   /* PARSE CORE NEVER GOTTEN, SKIP    01440000
*                                      RELEASE OF STORAGE */       0475 01441000
*          GO TO RETRN;                                    /*@Y02668*/  01442000
*                                                                  0475 01443000
*        GENERATE;                                                 0476 01444000
*                                                                  0476 01445000
*                                                                  0476 01446000
         IKJRLSA  PARSPDLP                                              01447000
*    RETRN:                                                        0477 01448000
*                                                                  0477 01449000
*        /************************************************************/ 01450000
*        /*                                                          */ 01451000
*        /*  RETURN - ISSUE STACK AND TCLEARQ ON ERROR               */ 01452000
*        /*                                                          */ 01453000
*        /************************************************************/ 01454000
*                                                                  0477 01455000
*                                   /* DELETE ADDRESS OF PUTLINE */     01456000
*        GENERATE;                                                 0477 01457000
RETRN    DS    0H                                                  0477 01458000
         DELETE  EP=IKJPUTL                                             01459000
*        RTNCODE=0;                 /* INITIALIZE RETURN CODE */   0478 01460000
         SLR   RTNCODE,RTNCODE                                     0478 01461000
*        IF SWERRMSG='1'B THEN      /* ERROR OCCURRED */           0479 01462000
         TM    SWERRMSG,B'00000001'                                0479 01463000
         BNO   @RF00479                                            0479 01464000
*          DO;                                                     0480 01465000
*            RTNCODE=12;            /* SET RETURN CODE = 12 */     0481 01466000
         LA    RTNCODE,12                                          0481 01467000
*            IOPLPTR=ADDR(PPLLN);   /* USE STORAGE USED BY PARSE AND    01468000
*                                      DAIR PARAM LISTS BEFORE- PARTLY  01469000
*                                      FILLED IN */                0482 01470000
         LA    IOPLPTR,PPLLN                                       0482 01471000
*            STPBPTR=ADDR(STPBAREA);                               0483 01472000
         LA    STPBPTR,STPBAREA                                    0483 01473000
*                                   /* ADDRESSABILITY TO STPB */   0484 01474000
*            IOPLIOPB=ADDR(STPB);   /* PUT PTR TO STPB IN IOPL */  0484 01475000
         ST    STPBPTR,IOPLIOPB(,IOPLPTR)                          0484 01476000
*        GENERATE;                                                 0485 01477000
         STACK   DELETE=ALL,MF=(E,PPLLN)                                01478000
         TCLEARQ INPUT                                                  01479000
*          END;                                                    0486 01480000
*                                                                  0486 01481000
*        REG15=RTNCODE;             /* PUT RETURN CODE IN REGISTER 15   01482000
*                                      */                          0487 01483000
@RF00479 LR    REG15,RTNCODE                                       0487 01484000
*        RETURN;                                                   0488 01485000
*                                                                  0488 01486000
*                                                                  0488 01487000
@EL00001 L     @13,4(,@13)                                         0488 01488000
@EF00001 L     @00,@SIZDATD                                        0488 01489000
         LR    @01,@11                                             0488 01490000
         FREEMAIN R,LV=(0),A=(1)                                        01491000
@ER00001 L     @14,12(,@13)                                        0488 01492000
         LM    @00,@12,20(@13)                                     0488 01493000
         BR    @14                                                 0488 01494000
*        GENERATE DATA DEFS(KYWDLST,MSGLST);                       0489 01495000
*/*IKJEFH01: CHART */                                              0490 01496000
*/*%START: E START */                                              0490 01497000
*/* P INITIALIZE */                                                0490 01498000
*/* P SET UP DAIR PARAMETERS */                                    0490 01499000
*/* S IKJDAIR:CODE X'24' */                                        0490 01500000
*/* D (NO,%DARMSG,YES,) DAIR SUCCESSFUL ? */                       0490 01501000
*/* D (NO,%ERRM,YES,) HELP DATA SET PARTITIONED ? */               0490 01502000
*/*%OPEN: P OPEN HELP DATA SET */                                  0490 01503000
*/* D (NO,%ERRM,YES,) OPEN SUCCESSFUL ? */                         0490 01504000
*/*%PARSE: P SET UP PARSE PARAMETERS */                            0490 01505000
*/* S IKJPARS:CALL PARSE */                                        0490 01506000
*/* D (NO,%ERRM,YES,%NAME:BT) PARSE SUCCESSFUL ? */                0490 01507000
*/*%NAME: P DETERMINE MEMBER NAME */                               0490 01508000
*/* P DO FIND ON MEMBER NAME */                                    0490 01509000
*/* D (NO,%ERRM,YES,) FIND SUCCESSFUL ? */                         0490 01510000
*/*%GET: P GETMAIN CORE FOR A BLOCK OF HELP DATA */                0490 01511000
*/* D (NO,%CONPAR,YES,) SUBCOMMAND INFORMATION WANTED ? */         0490 01512000
*/*%SUBRD: S IKJEFH03:READ ONE CARD IMAGE */                       0490 01513000
*/* D (NO,%SUBRD,YES,) FOUND SUBCOMMAND WANTED? */                 0490 01514000
*/*%CONPAR: P CONSTRUCT PARSE TABLE */                             0490 01515000
*/* S IKJEFH02: PROCESSING ROUTINE */                              0490 01516000
*/* P FREEMAIN BLOCK OF HELP DATA */                               0490 01517000
*/* D (NO,,YES,%CLOSE) ERROR IN IKJEFH02 OR IKJEFH03 ? */          0490 01518000
*/* D (YES,%ERRM,NO,) SUBCOMMAND DATA NOT FOUND ? */               0490 01519000
*/*%MORE: D (NO,,YES,%CLOSE) EVERYTHING REQUESTED FOUND? */        0490 01520000
*/*%ENDPARS: D (NO,,YES,%CLOSE:RL) END OF PARSE TABLE ? */         0490 01521000
*/* D (NO,%ERR,YES,) ITEM FOUND IN PARSE TABLE? */                 0490 01522000
*/* P (,%ENDPARS) POINT TO NEXT ITEM IN PARSE TABLE? */            0490 01523000
*/*%ERR: P SET UP ERROR MSG */                                     0490 01524000
*/* P (,%CALF02) POINT TO NEXT ITEM IN PARSE TABLE */              0490 01525000
*/*%ERRM: P (,%CALF02) SET UP ERROR MSG */                         0490 01526000
*/*%CALF02: S IKJEFH02:PUT OUT MSG */                              0490 01527000
*/* D (NO,%CLOSE,YES,%ENDPARS) CHECKING PARSE TABLE? */            0490 01528000
*/*%DARMSG: P SET UP IKJEFF18 PARAMETERS */                        0490 01529000
*/* S (,%CLOSE) IKJEFF18: PUT OUT DAIR ERROR MSG */                0490 01530000
*/*%CLOSE: D (YES,,NO,%PARSUC) HELP DATA SET OPEN ? */             0490 01531000
*/* P CLOSE HELP DATA SET */                                       0490 01532000
*/*%PARSUC: D (YES,,NO,%RET) PARSE SUCCESSFUL? */                  0490 01533000
*/* P RELEASE PDL */                                               0490 01534000
*/*%RET: D (NO,%GOBAK,YES,) ERROR OCCURRED ? */                    0490 01535000
*/* P ISSUE TCLEARQ & STACK */                                     0490 01536000
*/*%GOBAK: R RETURN */                                             0490 01537000
*/*IKJEFH01: END */                                                0490 01538000
*        END IKJEFH01                                              0490 01539000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01540000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                        * 01541000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        * 01542000
*/*%INCLUDE SYSLIB  (IKJECT  )                                        * 01543000
*/*%INCLUDE SYSLIB  (IKJDAPL )                                        * 01544000
*/*%INCLUDE SYSLIB  (IKJDAP24)                                        * 01545000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 01546000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        * 01547000
*/*%INCLUDE SYSLIB  (IKJSTPB )                                        * 01548000
*;                                                                 0490 01549000
         B     @EL00001                                            0490 01550000
@DATA    DS    0H                                                       01551000
@CH00038 DC    H'1'                                                     01552000
@CH00089 DC    H'8'                                                     01553000
@CH00467 DC    H'12'                                                    01554000
@CH00328 DC    H'80'                                                    01555000
@SM00475 MVC   PARSNAME(0),PDLNAME(@09)                                 01556000
@SM00480 MVC   SAVEDATA(0),DATAREA(@01)                                 01557000
@DATD    DSECT                                                          01558000
         DS    0F                                                       01559000
@SA00001 DS    18F                                                      01560000
@AL00001 DS    4A                                                       01561000
@TF00001 DS    F                                                        01562000
@ZTEMPS  DS    0F                                                       01563000
@ZT00002 DC    F'0'                                                     01564000
@ZTEMPND EQU   *                                                        01565000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01566000
IKJEFH01 CSECT                                                          01567000
         DS    0F                                                       01568000
@CF00426 DC    XL4'FF000000'                                            01569000
@DATD    DSECT                                                          01570000
         DS    0D                                                       01571000
DAPLPTR  DS    A                                                        01572000
PPLPTR   DS    A                                                        01573000
PARSPDLP DS    A                                                        01574000
LISTP    DS    A                                                        01575000
LABLP    DS    A                                                        01576000
INSERT0  DS    FL4                                                      01577000
         ORG   INSERT0                                                  01578000
@NM00047 DS    FL2                                                      01579000
INSERT2  DS    FL2                                                      01580000
         ORG   INSERT0+4                                                01581000
DAIRCODE DS    F                                                        01582000
COMMON   DS    CL26                                                     01583000
         ORG   COMMON                                                   01584000
TMPINTP  DS    AL4                                                      01585000
SWITCHES DS    BL4                                                      01586000
         ORG   SWITCHES                                                 01587000
SWCLOSE  DS    BL1                                                      01588000
SWPARS   EQU   SWITCHES+0                                               01589000
SWCOMAND EQU   SWITCHES+0                                               01590000
SWSUBCOM EQU   SWITCHES+0                                               01591000
SWPARSE  EQU   SWITCHES+0                                               01592000
SWPRINT  EQU   SWITCHES+0                                               01593000
SWSUBSER EQU   SWITCHES+0                                               01594000
SWERRMSG EQU   SWITCHES+0                                               01595000
SWFOUND  DS    BL1                                                      01596000
SWREAD   EQU   SWITCHES+1                                               01597000
SWKEY    EQU   SWITCHES+1                                               01598000
SWMSGLOP EQU   SWITCHES+1                                               01599000
SWEOD    EQU   SWITCHES+1                                               01600000
SWMOVOR  EQU   SWITCHES+1                                               01601000
SWFIRST  EQU   SWITCHES+1                                               01602000
SWBLK    EQU   SWITCHES+1                                               01603000
         ORG   COMMON+8                                                 01604000
DATAREAP DS    AL4                                                      01605000
READDCBP DS    AL4                                                      01606000
MSGPTR   DS    AL4                                                      01607000
COMECB   DS    CL4                                                      01608000
TOTALEX  DS    FL2                                                      01609000
         ORG   COMMON+26                                                01610000
         DS    CL2                                                      01611000
MSGTABLE DS    CL64                                                     01612000
         ORG   MSGTABLE                                                 01613000
LISTPTR  DS    AL4                                                      01614000
TMCTPTR  DS    AL4                                                      01615000
         ORG   TMCTPTR                                                  01616000
MTCPPL   DS    AL4                                                      01617000
         ORG   MSGTABLE+8                                               01618000
ECBPTR   DS    AL4                                                      01619000
@NM00001 DS    AL4                                                      01620000
         ORG   @NM00001                                                 01621000
MTHIGH   DS    BL1                                                      01622000
         ORG   MSGTABLE+16                                              01623000
MSGCSECT DS    AL4                                                      01624000
SW       DS    AL1                                                      01625000
         ORG   SW                                                       01626000
MTNOIDSW DS    BL1                                                      01627000
MTPUTLSW EQU   SW+0                                                     01628000
MTWTOSW  EQU   SW+0                                                     01629000
MTHEXSW  EQU   SW+0                                                     01630000
MTKEY1SW EQU   SW+0                                                     01631000
MTJOBISW EQU   SW+0                                                     01632000
MTWTPSW  EQU   SW+0                                                     01633000
MTNHEXSW EQU   SW+0                                                     01634000
         ORG   MSGTABLE+21                                              01635000
RETMSG   DS    AL3                                                      01636000
SW2      DS    AL1                                                      01637000
         ORG   SW2                                                      01638000
MT2OLDSW DS    BL1                                                      01639000
MTDOMSW  EQU   SW2+0                                                    01640000
MTNOXQSW EQU   SW2+0                                                    01641000
MTNPLMSW EQU   SW2+0                                                    01642000
MTPGMSW  EQU   SW2+0                                                    01643000
@NM00002 EQU   SW2+0                                                    01644000
         ORG   MSGTABLE+25                                              01645000
@NM00003 DS    AL3                                                      01646000
MTOLDPTR DS    AL4                                                      01647000
@NM00004 DS    AL4                                                      01648000
@NM00005 DS    AL4                                                      01649000
MSGID    DS    CL4                                                      01650000
MTINSRTS DS    CL16                                                     01651000
         ORG   MTINSRTS                                                 01652000
L1       DS    AL1                                                      01653000
         ORG   L1                                                       01654000
HIGHL1   DS    BL1                                                      01655000
         ORG   MTINSRTS+1                                               01656000
VAR1     DS    AL3                                                      01657000
L2       DS    AL1                                                      01658000
         ORG   L2                                                       01659000
HIGHL2   DS    BL1                                                      01660000
         ORG   MTINSRTS+5                                               01661000
VAR2     DS    AL3                                                      01662000
L3       DS    AL1                                                      01663000
         ORG   L3                                                       01664000
HIGHL3   DS    BL1                                                      01665000
         ORG   MTINSRTS+9                                               01666000
VAR3     DS    AL3                                                      01667000
L4       DS    AL1                                                      01668000
         ORG   L4                                                       01669000
HIGHL4   DS    BL1                                                      01670000
         ORG   MTINSRTS+13                                              01671000
VAR4     DS    AL3                                                      01672000
         ORG   MSGTABLE+60                                              01673000
MSGRTN   DS    AL4                                                      01674000
         ORG   MSGTABLE+64                                              01675000
DAPB24LN DS    CL84                                                     01676000
DSNAM    DS    CL46                                                     01677000
         ORG   DSNAM                                                    01678000
DSNLEN   DS    BL2                                                      01679000
DSNAMED  DS    CL44                                                     01680000
         ORG   DSNAM+46                                                 01681000
         DS    CL2                                                      01682000
DCBLKEX  DS    CL4                                                      01683000
         ORG   DCBLKEX                                                  01684000
DCBEXCD1 DS    BL1                                                      01685000
DCBEXP1  DS    AL3                                                      01686000
         ORG   DCBLKEX+4                                                01687000
PPLLN    DS    CL28                                                     01688000
CONFLICT DS    BL1                                                      01689000
PARSNAME DS    CL8                                                      01690000
         DS    CL3                                                      01691000
PARSETAB DS    CL16                                                     01692000
         ORG   PARSETAB                                                 01693000
KEYPTR   DS    AL4                                                      01694000
CONTRL   DS    CL2                                                      01695000
         ORG   CONTRL+0                                                 01696000
PAREN    DS    CL1                                                      01697000
CONCHAR  DS    CL1                                                      01698000
         ORG   PARSETAB+14                                              01699000
CONEND   DS    BL2                                                      01700000
         ORG   PARSETAB+16                                              01701000
MEMLEN   DS    BL1                                                      01702000
MEMBER   DS    CL8                                                      01703000
         DS    CL3                                                      01704000
STPBAREA DS    CL20                                                     01705000
INSERT   DS    CL8                                                      01706000
SAVEDATA DS    CL8                                                      01707000
IKJEFH01 CSECT                                                          01708000
         DS    0F                                                       01709000
@SIZDATD DC    AL1(0)                                                   01710000
         DC    AL3(@ENDDATD-@DATD)                                      01711000
@CV00274 DC    V(HELPPCL)                                               01712000
@CV00359 DC    V(IKJEFH00)                                              01713000
@CV00363 DC    V(IKJEFF02)                                              01714000
@CV00431 DC    V(IKJEFH03)                                              01715000
@CV00440 DC    V(IKJEFH02)                                              01716000
         DS    0D                                                       01717000
ADDRF02  DC    VL4(IKJEFF02)                                            01718000
ONE      DC    H'1'                                                     01719000
@CC00390 DC    C'SYS1.HELP'                                             01720000
@CC00393 DC    C'        '                                              01721000
@CC00452 DC    C'FUNCTION'                                              01722000
@CC00457 DC    C'OPERANDS'                                              01723000
@CC00392 DC    C'SYSHELP'                                               01724000
@CC00454 DC    C'SYNTAX'                                                01725000
@CC00408 DC    C'PARSE'                                                 01726000
@CC00450 DC    C'MSGID'                                                 01727000
@CC00399 DC    C'100T'                                                  01728000
@CC00405 DC    C'100B'                                                  01729000
@CC00406 DC    C'100E'                                                  01730000
@CC00407 DC    C'100S'                                                  01731000
@CC00417 DC    C'100C'                                                  01732000
@CC00419 DC    C'100H'                                                  01733000
@CC00421 DC    C'100I'                                                  01734000
@CC00422 DC    C'100G'                                                  01735000
@CC00443 DC    C'100L'                                                  01736000
@CC00444 DC    C'100K'                                                  01737000
@CC00445 DC    C'100U'                                                  01738000
@CC00446 DC    C'100N'                                                  01739000
@CC00447 DC    C'100O'                                                  01740000
@CC00448 DC    C'100M'                                                  01741000
@CC00449 DC    C'100P'                                                  01742000
@CC00461 DC    C'100Q'                                                  01743000
@CC00376 DC    C')F'                                                    01744000
@CC00378 DC    C')X'                                                    01745000
@CC00380 DC    C')O'                                                    01746000
@CC00382 DC    C')M'                                                    01747000
@CB00386 DC    X'FFFF'                                                  01748000
@CB00387 DC    X'0024'                                                  01749000
@CB00388 DC    B'0000000000001001'                                      01750000
H        DC    CL8'H       '                                            01751000
HELP     DC    CL8'HELP    '                                            01752000
COMMANDS DC    CL8'COMMANDS'                                            01753000
WHOLTAB  DS    CL8                                                      01754000
         ORG   WHOLTAB                                                  01755000
TABS     DC    CL2')S'                                                  01756000
TABF     DC    CL2')F'                                                  01757000
TABX     DC    CL2')X'                                                  01758000
TABO     DC    CL2')O'                                                  01759000
         ORG   WHOLTAB+8                                                01760000
TABM     DC    CL2')M'                                                  01761000
@DATD    DSECT                                                          01762000
DYNOPN   EQU   *                                                        01763000
DCBOPN   OPEN  (,),MF=L                                                 01764000
DYNOPNL  EQU   *-DYNOPN                                                 01765000
DYNDCB   EQU   *                                                        01766000
READDCB  DCB   DSORG=PO,RECFM=FB,MACRF=(R),BUFNO=0                      01767000
DYNDCBL  EQU   *-DYNDCB                                                 01768000
         DCBD  DSORG=(PO),DEVD=(DA)                                     01769000
IKJEFH01 CSECT                                                          01770000
HELPPCL  IKJPARM   DSECT=HELPPDL                                        01771000
NAME     IKJIDENT  'COMMANDNAME/SUBCOMMANDNAME',MAXLNTH=8,             X01772000
               FIRST=ANY,OTHER=ANY                                      01773000
F        IKJKEYWD                                                       01774000
         IKJNAME   'FUNCTION'                                           01775000
S        IKJKEYWD                                                       01776000
         IKJNAME   'SYNTAX'                                             01777000
A        IKJKEYWD                                                       01778000
         IKJNAME   'ALL'                                                01779000
O        IKJKEYWD                                                       01780000
         IKJNAME   'OPERANDS',SUBFLD=WRDS                               01781000
M        IKJKEYWD                                                       01782000
         IKJNAME   'MSGID',SUBFLD=MSG                                   01783000
WRDS     IKJSUBF                                                        01784000
KYWDLST  IKJIDENT  'KEYWORD LIST',LIST,FIRST=ANY,OTHER=ANY              01785000
MSG      IKJSUBF                                                        01786000
MSGLST   IKJIDENT  'MSGID LIST',LIST,FIRST=ALPHA,OTHER=ALPHANUM,       *01787000
               PROMPT='MSGID',HELP='MSGID OF MSG IN QUESTION'           01788000
         IKJENDP                                                        01789000
@DATD    DSECT                                                          01790000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01791000
@ENDDATD EQU   *                                                        01792000
IKJEFH01 CSECT                                                          01793000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01794000
@01      EQU   01                                                       01795000
@02      EQU   02                                                       01796000
@03      EQU   03                                                       01797000
@04      EQU   04                                                       01798000
@05      EQU   05                                                       01799000
@06      EQU   06                                                       01800000
@07      EQU   07                                                       01801000
@08      EQU   08                                                       01802000
@09      EQU   09                                                       01803000
@10      EQU   10                                                       01804000
@11      EQU   11                                                       01805000
@12      EQU   12                                                       01806000
@13      EQU   13                                                       01807000
@14      EQU   14                                                       01808000
@15      EQU   15                                                       01809000
IOPLPTR  EQU   @08                                                      01810000
STPBPTR  EQU   @07                                                      01811000
COREGOTP EQU   @07                                                      01812000
PARSINDX EQU   @08                                                      01813000
DAPB2PTR EQU   @07                                                      01814000
REG0     EQU   @00                                                      01815000
REG1     EQU   @01                                                      01816000
REG2     EQU   @02                                                      01817000
I        EQU   @03                                                      01818000
REG4     EQU   @04                                                      01819000
CPPLPTR  EQU   @05                                                      01820000
RTNCODE  EQU   @06                                                      01821000
J        EQU   @06                                                      01822000
REG13    EQU   @13                                                      01823000
REG15    EQU   @15                                                      01824000
CALLSAVE EQU   0                                                        01825000
TMPPARMP EQU   0                                                        01826000
TMPINT   EQU   0                                                        01827000
PSCBPTR  EQU   TMPINT+8                                                 01828000
ECTPTR   EQU   TMPINT+12                                                01829000
RET      EQU   0                                                        01830000
CPPL     EQU   0                                                        01831000
CPPLCBUF EQU   CPPL                                                     01832000
CPPLUPT  EQU   CPPL+4                                                   01833000
CPPLECT  EQU   CPPL+12                                                  01834000
ECT      EQU   0                                                        01835000
ECTPCMD  EQU   ECT+12                                                   01836000
ECTSWS   EQU   ECT+28                                                   01837000
ECTSWS2  EQU   ECT+40                                                   01838000
ECTSWS21 EQU   ECTSWS2                                                  01839000
DAPL     EQU   0                                                        01840000
DAPLUPT  EQU   DAPL                                                     01841000
DAPLECT  EQU   DAPL+4                                                   01842000
DAPLECB  EQU   DAPL+8                                                   01843000
DAPLPSCB EQU   DAPL+12                                                  01844000
DAPLDAPB EQU   DAPL+16                                                  01845000
DAPB24   EQU   0                                                        01846000
DA24CD   EQU   DAPB24                                                   01847000
DA24FLG  EQU   DAPB24+2                                                 01848000
DA24PDSN EQU   DAPB24+8                                                 01849000
DA24DDN  EQU   DAPB24+12                                                01850000
DA24UNIT EQU   DAPB24+20                                                01851000
DA24SER  EQU   DAPB24+28                                                01852000
DA24MNM  EQU   DAPB24+52                                                01853000
DA24PSWD EQU   DAPB24+60                                                01854000
DA24DSP1 EQU   DAPB24+68                                                01855000
DA24SHR  EQU   DA24DSP1                                                 01856000
DA24DPS2 EQU   DAPB24+69                                                01857000
DA24KEEP EQU   DA24DPS2                                                 01858000
DA24DPS3 EQU   DAPB24+70                                                01859000
DA24KEP  EQU   DA24DPS3                                                 01860000
DA24CTL  EQU   DAPB24+71                                                01861000
DA24DSO  EQU   DAPB24+75                                                01862000
@NM00032 EQU   0                                                        01863000
EXITLST  EQU   @NM00032+1                                               01864000
@NM00034 EQU   0                                                        01865000
OPNFLAG  EQU   @NM00034                                                 01866000
DCBBLKS  EQU   0                                                        01867000
DCBLREC  EQU   0                                                        01868000
DCBDNAME EQU   0                                                        01869000
PPL      EQU   0                                                        01870000
PPLPCL   EQU   PPL+12                                                   01871000
PPLANS   EQU   PPL+16                                                   01872000
PPLCBUF  EQU   PPL+20                                                   01873000
PARSPDL  EQU   0                                                        01874000
PDLNAMEP EQU   PARSPDL+8                                                01875000
PDLNAME2 EQU   PARSPDL+12                                               01876000
PDLNAMEL EQU   PDLNAME2                                                 01877000
PDLNAMER EQU   PDLNAMEL+1                                               01878000
@NM00039 EQU   PDLNAME2+2                                               01879000
PDLNAMEO EQU   @NM00039                                                 01880000
PDLFUN   EQU   PARSPDL+16                                               01881000
PDLSYN   EQU   PARSPDL+18                                               01882000
PDLALL   EQU   PARSPDL+20                                               01883000
PDLOPER  EQU   PARSPDL+22                                               01884000
PDLMSGID EQU   PARSPDL+24                                               01885000
PDLMAP   EQU   PARSPDL+28                                               01886000
PDLKEYP  EQU   PDLMAP                                                   01887000
PDLNAME  EQU   0                                                        01888000
LIST     EQU   0                                                        01889000
KWRDP    EQU   LIST                                                     01890000
@NM00041 EQU   LIST+4                                                   01891000
KWRDL    EQU   @NM00041                                                 01892000
KWRDLEN  EQU   KWRDL+1                                                  01893000
KWRDF    EQU   @NM00041+2                                               01894000
KWRD     EQU   KWRDF                                                    01895000
NXTLSTP  EQU   LIST+8                                                   01896000
CONTRLCH EQU   0                                                        01897000
CONTLST  EQU   CONTRLCH+4                                               01898000
DATAREA  EQU   0                                                        01899000
CKAGN    EQU   0                                                        01900000
IOPL     EQU   0                                                        01901000
IOPLIOPB EQU   IOPL+12                                                  01902000
STPB     EQU   0                                                        01903000
@NM00043 EQU   STPB                                                     01904000
MSGDAIR  EQU   0                                                        01905000
KEYWORD  EQU   0                                                        01906000
MSGECB   EQU   0                                                        01907000
MSGTMCT  EQU   0                                                        01908000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01909000
STPBMBRN EQU   STPB+16                                                  01910000
STPBOTDD EQU   STPB+12                                                  01911000
STPBINDD EQU   STPB+8                                                   01912000
STPBALSD EQU   STPB+4                                                   01913000
@NM00046 EQU   @NM00043+1                                               01914000
SPBFLUSH EQU   @NM00043+1                                               01915000
@NM00045 EQU   @NM00043+1                                               01916000
@NM00044 EQU   @NM00043                                                 01917000
IOPLECB  EQU   IOPL+8                                                   01918000
IOPLECT  EQU   IOPL+4                                                   01919000
IOPLUPT  EQU   IOPL                                                     01920000
@NM00042 EQU   CONTRLCH                                                 01921000
KWRDEXT  EQU   KWRDL                                                    01922000
PDLNEXTP EQU   PDLMAP+8                                                 01923000
@NM00040 EQU   PDLMAP+4                                                 01924000
@NM00038 EQU   PDLNAMEL                                                 01925000
@NM00037 EQU   PARSPDL+4                                                01926000
@NM00036 EQU   PARSPDL                                                  01927000
PPLUWA   EQU   PPL+24                                                   01928000
PPLECB   EQU   PPL+8                                                    01929000
PPLECT   EQU   PPL+4                                                    01930000
PPLUPT   EQU   PPL                                                      01931000
@NM00035 EQU   @NM00034                                                 01932000
@NM00033 EQU   @NM00032                                                 01933000
DA24ALN  EQU   DAPB24+76                                                01934000
@NM00031 EQU   DAPB24+72                                                01935000
@NM00030 EQU   DA24CTL                                                  01936000
DA24ATRL EQU   DA24CTL                                                  01937000
DA24DMMY EQU   DA24CTL                                                  01938000
DA24PERM EQU   DA24CTL                                                  01939000
DA24RLSE EQU   DA24CTL                                                  01940000
DA24UID  EQU   DA24CTL                                                  01941000
DA24ABKL EQU   DA24CTL                                                  01942000
DA24TRKS EQU   DA24CTL                                                  01943000
DA24UNCT EQU   DA24DPS3                                                 01944000
DA24CATL EQU   DA24DPS3                                                 01945000
DA24DELE EQU   DA24DPS3                                                 01946000
@NM00029 EQU   DA24DPS3                                                 01947000
@NM00028 EQU   DA24DPS3                                                 01948000
@NM00027 EQU   DA24DPS3                                                 01949000
@NM00026 EQU   DA24DPS3                                                 01950000
DA24UCAT EQU   DA24DPS2                                                 01951000
DA24CAT  EQU   DA24DPS2                                                 01952000
DA24DEL  EQU   DA24DPS2                                                 01953000
@NM00025 EQU   DA24DPS2                                                 01954000
@NM00024 EQU   DA24DPS2                                                 01955000
@NM00023 EQU   DA24DPS2                                                 01956000
@NM00022 EQU   DA24DPS2                                                 01957000
DA24OLD  EQU   DA24DSP1                                                 01958000
DA24MOD  EQU   DA24DSP1                                                 01959000
DA24NEW  EQU   DA24DSP1                                                 01960000
@NM00021 EQU   DA24DSP1                                                 01961000
@NM00020 EQU   DA24DSP1                                                 01962000
@NM00019 EQU   DA24DSP1                                                 01963000
@NM00018 EQU   DA24DSP1                                                 01964000
DA24DQTY EQU   DAPB24+48                                                01965000
DA24SQTY EQU   DAPB24+44                                                01966000
DA24PQTY EQU   DAPB24+40                                                01967000
DA24BLK  EQU   DAPB24+36                                                01968000
DA24CTRC EQU   DAPB24+6                                                 01969000
DA24DARC EQU   DAPB24+4                                                 01970000
@NM00017 EQU   DA24FLG                                                  01971000
@NM00016 EQU   DA24FLG                                                  01972000
@NM00015 EQU   DA24FLG                                                  01973000
DA24DMY  EQU   DA24FLG                                                  01974000
@NM00014 EQU   DA24FLG                                                  01975000
@NM00013 EQU   DA24FLG                                                  01976000
@NM00012 EQU   DA24FLG                                                  01977000
DA24FPE  EQU   DA24FLG                                                  01978000
@NM00011 EQU   ECT+52                                                   01979000
@NM00010 EQU   ECT+48                                                   01980000
@NM00009 EQU   ECT+44                                                   01981000
@NM00008 EQU   ECTSWS2+1                                                01982000
@NM00007 EQU   ECTSWS21                                                 01983000
ECTTABND EQU   ECTSWS21                                                 01984000
ECTDEFCS EQU   ECTSWS21                                                 01985000
ECTBKPB  EQU   ECT+36                                                   01986000
ECTUSER  EQU   ECT+32                                                   01987000
ECTDDNUM EQU   ECT+29                                                   01988000
ECTATTN  EQU   ECTSWS                                                   01989000
ECTBKGRD EQU   ECTSWS                                                   01990000
ECTNNOT  EQU   ECTSWS                                                   01991000
ECTNMAL  EQU   ECTSWS                                                   01992000
ECTLOGF  EQU   ECTSWS                                                   01993000
ECTATRM  EQU   ECTSWS                                                   01994000
@NM00006 EQU   ECTSWS                                                   01995000
ECTNOPD  EQU   ECTSWS                                                   01996000
ECTSCMD  EQU   ECT+20                                                   01997000
ECTSMSG  EQU   ECT+9                                                    01998000
ECTMSGF  EQU   ECT+8                                                    01999000
ECTIOWA  EQU   ECT+4                                                    02000000
ECTRTCD  EQU   ECT+1                                                    02001000
ECTRCDF  EQU   ECT                                                      02002000
CPPLPSCB EQU   CPPL+8                                                   02003000
RETCHAR  EQU   RET+2                                                    02004000
RETSIZE  EQU   RET                                                      02005000
UPTPTR   EQU   TMPINT+4                                                 02006000
CBUFPTR  EQU   TMPINT                                                   02007000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02008000
@RT00131 EQU   ORGTST                                                   02009000
@RF00174 EQU   RT                                                       02010000
@RT00192 EQU   COMTST                                                   02011000
@RC00196 EQU   @RC00194                                                 02012000
@RT00220 EQU   FINDSUCS                                                 02013000
@RT00237 EQU   M100H                                                    02014000
@RT00286 EQU   FUNTEST                                                  02015000
@RT00290 EQU   ENDDATA                                                  02016000
@RT00292 EQU   ENDDATA                                                  02017000
@RT00294 EQU   SUB1                                                     02018000
@RT00298 EQU   OUTSUB                                                   02019000
@RT00300 EQU   OUTSUB                                                   02020000
@RF00305 EQU   SUB1                                                     02021000
@RF00332 EQU   @RC00328                                                 02022000
@RT00343 EQU   HELPROCS                                                 02023000
@RT00352 EQU   RT                                                       02024000
@RT00403 EQU   RT                                                       02025000
@RT00442 EQU   RT                                                       02026000
@RT00455 EQU   RT                                                       02027000
@RT00469 EQU   RETRN                                                    02028000
@RT00474 EQU   RETRN                                                    02029000
@ENDDATA EQU   *                                                        02030000
         END   IKJEFH01,(C'PLS1028',0701,76181)                         02031000
