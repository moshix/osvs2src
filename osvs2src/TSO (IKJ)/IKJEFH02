         TITLE 'IKJEFH02 PROCESSING ROUTINE                          '  00001000
IKJEFH02 CSECT ,                                                   0001 00002000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00003000
         BALR  @12,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@12                                         0001 00006000
         L     @00,@SIZDATD                                        0001 00007000
         GETMAIN R,LV=(0)                                               00008000
         LR    @11,@01                                             0001 00009000
         USING @DATD,@11                                           0001 00010000
         ST    @13,@SA00001+4                                      0001 00011000
         LM    @00,@01,20(@13)                                     0001 00012000
         ST    @11,8(,@13)                                         0001 00013000
         LR    @13,@11                                             0001 00014000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00015000
         MVC   @PC00001(8),0(@01)                                  0001 00016000
*                                                                  0021 00017000
*                                                                  0021 00018000
*        PARMPTR1=ADDR(COMMON);     /* SET LOCAL ADDRESS OF        0022 00019000
*                                      PARAMETERS */               0022 00020000
         L     PARMPTR1,@PC00001                                   0022 00021000
*        PARMPTR2=ADDR(TABLE(1));   /* SET LOCAL ADDRESS OF        0023 00022000
*                                      PARAMETERS */               0023 00023000
*                                                                  0023 00024000
         L     PARMPTR2,@PC00001+4                                 0023 00025000
*    BEGIN:                                                        0024 00026000
*                                                                  0024 00027000
*        /************************************************************/ 00028000
*        /*                                                          */ 00029000
*        /*  READ 80 BYTES                                           */ 00030000
*        /*                                                          */ 00031000
*        /************************************************************/ 00032000
*                                                                  0024 00033000
*                                                                  0024 00034000
*        CALL IKJEFH03 (COMMON);    /* CALL READ ROUTINE TO PASS BACK   00035000
*                                      80 BYTES OF THE HELP DATA SET    00036000
*                                      */                          0024 00037000
*                                                                  0024 00038000
*                                                                  0024 00039000
BEGIN    L     @14,@PC00001                                        0024 00040000
         ST    @14,@AL00001                                        0024 00041000
         L     @15,@CV00148                                        0024 00042000
         LA    @01,@AL00001                                        0024 00043000
         BALR  @14,@15                                             0024 00044000
*        /************************************************************/ 00045000
*        /*                                                          */ 00046000
*        /*  EXAMINE SWITCHES TO DETERMINE ACTION TO BE TAKEN        */ 00047000
*        /*                                                          */ 00048000
*        /************************************************************/ 00049000
*                                                                  0025 00050000
*        IF SWEOD='1'B THEN                                        0025 00051000
         TM    SWEOD(PARMPTR1),B'00001000'                         0025 00052000
         BO    @RT00025                                            0025 00053000
*                                   /* IF END OF DATA OCCURED RETURN    00054000
*                                      TO CALLER */                0026 00055000
*          RETURN;                                                 0026 00056000
*                                                                  0026 00057000
*        IF SWERRMSG='1'B THEN                                     0027 00058000
         TM    SWERRMSG(PARMPTR1),B'00000001'                      0027 00059000
         BO    @RT00027                                            0027 00060000
*                                   /* IF ERROR MESSAGE PUT OUT    0028 00061000
*                                      RETURN TO CALLER */         0028 00062000
*          RETURN;                                                 0028 00063000
*                                                                  0028 00064000
*        IF SWCOMAND='1'B THEN                                     0029 00065000
         TM    SWCOMAND(PARMPTR1),B'00100000'                      0029 00066000
         BO    @RT00029                                            0029 00067000
*                                   /* IF DONT WANT TO CHECK FOR   0030 00068000
*                                      CONTROL CHARACTERS SKIP TO PUT   00069000
*                                      OUT INFORMATION */          0030 00070000
*          GO TO PUTOUT;                                           0030 00071000
*                                                                  0030 00072000
*                                                                  0030 00073000
*        /************************************************************/ 00074000
*        /*                                                          */ 00075000
*        /*  EXAMINE THE DATA RETURNED FROM IKJEFH03                 */ 00076000
*        /*                                                          */ 00077000
*        /************************************************************/ 00078000
*                                                                  0031 00079000
*        IF DATAREA(1)='=' THEN                                    0031 00080000
         L     @14,DATAREAP(,PARMPTR1)                             0031 00081000
         CLI   DATAREA(@14),C'='                                   0031 00082000
         BE    @RT00031                                            0031 00083000
*                                   /* BEGINNING OF NEXT SUBCOMMAND     00084000
*                                      IN MEMBER QUIT */           0032 00085000
*          RETURN;                                                 0032 00086000
*                                                                  0032 00087000
*        IF DATAREA(1)=')' THEN                                    0033 00088000
         CLI   DATAREA(@14),C')'                                   0033 00089000
         BNE   @RF00033                                            0033 00090000
*          IF DATAREA(2)^=BLANK THEN                               0034 00091000
         CLC   DATAREA+1(1,@14),BLANK                              0034 00092000
         BE    @RF00034                                            0034 00093000
*            IF DATAREA(3)=BLANK THEN                              0035 00094000
         CLC   DATAREA+2(1,@14),BLANK                              0035 00095000
         BE    @RT00035                                            0035 00096000
*                                   /* COLUMNS 1-3 OF THE CARD IMAGE    00097000
*                                      MEAN A CONTROL CHARACTER NOT     00098000
*                                      INDICATING A KEYWORD */     0036 00099000
*              GO TO CTRLCHAR;      /* PROCESS THE CONTROL CHARACTER    00100000
*                                      */                          0036 00101000
*                                                                  0036 00102000
*        IF DATAREA(1:2)='))' THEN                                 0037 00103000
@RF00034 DS    0H                                                  0037 00104000
@RF00033 L     @14,DATAREAP(,PARMPTR1)                             0037 00105000
         CLC   DATAREA(2,@14),@CC00156                             0037 00106000
         BE    @RT00037                                            0037 00107000
*                                   /* COLUMNS 1+2 OF THE CARD IMAGE    00108000
*                                      INDICATE A KEYWORD */       0038 00109000
*          GO TO KEYCHAR;           /* GO TO PROCESS KEYWORD */    0038 00110000
*                                                                  0038 00111000
*        IF SWPRINT='1'B THEN                                      0039 00112000
         TM    SWPRINT(PARMPTR1),B'00000100'                       0039 00113000
         BO    @RT00039                                            0039 00114000
*                                   /* WHEN NOT CONTROL CHARACTER OR    00115000
*                                      KEYWORD IS PROGRMM IN THE   0040 00116000
*                                      MIDST OF RRINTING REQUESTED 0040 00117000
*                                      INFORMATION */              0040 00118000
*          GO TO PUTOUT;            /* YES, GO TO PUT LINE OUT */  0040 00119000
*        GO TO BEGIN;               /* NOT PRINTING, REPEAT PROCESS     00120000
*                                      */                          0041 00121000
*                                                                  0041 00122000
*                                                                  0041 00123000
*                                                                  0041 00124000
         B     BEGIN                                               0041 00125000
*    KEYCHAR:                                                      0042 00126000
*                                                                  0042 00127000
*        /************************************************************/ 00128000
*        /*                                                          */ 00129000
*        /*  PROCESS KEYWORD                                         */ 00130000
*        /*                                                          */ 00131000
*        /************************************************************/ 00132000
*                                                                  0042 00133000
*                                                                  0042 00134000
*        SWPRINT='0'B;              /* TURN OFF PRINT SWITCH */    0042 00135000
KEYCHAR  NI    SWPRINT(PARMPTR1),B'11111011'                       0042 00136000
*        I=1;                       /* INITIALIZE INDEX THROUGH PARSE   00137000
*                                      INFORMATION TABLE */        0043 00138000
*                                                                  0043 00139000
*                                                                  0043 00140000
         LA    I,1                                                 0043 00141000
*    OPERTST:                                                      0044 00142000
*                                   /* CHECK FOR OPERAND INFORMATION    00143000
*                                      REQUESTED */                0044 00144000
*        IF CONTRL(I)=' O' THEN                                    0044 00145000
OPERTST  LR    @14,I                                               0044 00146000
         AR    @14,@14                                             0044 00147000
         ST    @14,@TF00001                                        0044 00148000
         ALR   @14,PARMPTR2                                        0044 00149000
         CLC   CONTRL-2(2,@14),@CC00161                            0044 00150000
         BE    @RT00044                                            0044 00151000
*                                   /* ALL OPERAND INFORMATION WANTED   00152000
*                                      */                          0045 00153000
*          GO TO BLANKOUT;          /* GO TO PUT OUT THE INFORMATION    00154000
*                                      REMOVING THE '))' */        0045 00155000
*                                                                  0045 00156000
*        IF CONTRL(I)='FFFF'X THEN                                 0046 00157000
         LR    @14,PARMPTR2                                        0046 00158000
         AL    @14,@TF00001                                        0046 00159000
         CLC   CONTRL-2(2,@14),@CB00164                            0046 00160000
         BE    @RT00046                                            0046 00161000
*                                   /* END OF CONTROL CHARACTER LIST    00162000
*                                      AND ALL OPERANDS NOT SPECIFIED   00163000
*                                      */                          0047 00164000
*          GO TO FOUNDTST;          /* THEN GO TO CHECK TO SEE IF THE   00165000
*                                      PARTICULAR KEYWORD HAS BEEN 0047 00166000
*                                      REQUESTED */                0047 00167000
*                                                                  0047 00168000
*        I=I+1;                     /* OTHERWISE LOOK AT NEXT ITEM IN   00169000
*                                      PARSE TABLE */              0048 00170000
         AH    I,@CH00048                                          0048 00171000
*        GO TO OPERTST;             /* CONTINUE SEARCH FOR OPERAND 0049 00172000
*                                      CONTROL CHARACTER */        0049 00173000
*                                                                  0049 00174000
*                                                                  0049 00175000
         B     OPERTST                                             0049 00176000
*    FOUNDTST:                                                     0050 00177000
*        IF SWFOUND='1'B THEN                                      0050 00178000
FOUNDTST TM    SWFOUND(PARMPTR1),B'10000000'                       0050 00179000
         BO    @RT00050                                            0050 00180000
*                                   /* ALL INFORMATION REQUESTED HAS    00181000
*                                      BEEN FOUND */               0051 00182000
*          RETURN;                  /* YES, FINISHED PROCESSING SO 0051 00183000
*                                      RETURN */                   0051 00184000
*                                                                  0051 00185000
*        IF KEYPTR='FF000000'X THEN                                0052 00186000
         L     @14,KEYPTR(,PARMPTR2)                               0052 00187000
         CL    @14,@CF00167                                        0052 00188000
         BE    @RT00052                                            0052 00189000
*                                   /* NO KEYWORDS SPECIFIED IN PARSE   00190000
*                                      TABLE BUT HAVEN'T FOUND ALL 0053 00191000
*                                      CONTROL CHARACTER INFORMATION    00192000
*                                      THEN REPEAT PROCESS */      0053 00193000
*                                                                  0053 00194000
*          GO TO BEGIN;                                            0053 00195000
*        LISTP=KEYPTR;              /* POINT TO BEGINNING OF KEYWORD    00196000
*                                      LIST TO START SEARCH FOR    0054 00197000
*                                      KEYWORD */                  0054 00198000
*                                                                  0054 00199000
*                                                                  0054 00200000
         LR    LISTP,@14                                           0054 00201000
*    COMPKEY:                                                      0055 00202000
*                                   /* LOOK THROUGH LIST FOR THE   0055 00203000
*                                      KEYWORD READ FROM THE CARD */    00204000
*        IF KWRD='0'B THEN                                         0055 00205000
COMPKEY  TM    KWRD(LISTP),B'10000000'                             0055 00206000
         BZ    @RT00055                                            0055 00207000
*                                   /* KEYWORD ALREADY FOUND THEN  0056 00208000
*                                      SKIP TO LOOK AT NEXT ONE */ 0056 00209000
*          GO TO NEXTK;                                            0056 00210000
*        IF KEYWORD(1:KWRDL)=DATAREA(3:KWRDL+2) THEN               0057 00211000
         L     @14,KWRDP(,LISTP)                                   0057 00212000
         L     @10,DATAREAP(,PARMPTR1)                             0057 00213000
         MVC   @ZT00002+2(2),KWRDL(LISTP)                          0057 00214000
         L     @06,@ZT00002                                        0057 00215000
         BCTR  @06,0                                               0057 00216000
         EX    @06,@SC00204                                        0057 00217000
         BNE   @RF00057                                            0057 00218000
*                                   /* COMPARE KEYWORDS USING LENGTH    00219000
*                                      OF KEYWORD AT TERMINAL AS BASE   00220000
*                                      - THIS ALLOWS INFORMATION ON     00221000
*                                      ABREVIATIONS */             0058 00222000
*          DO;                                                     0058 00223000
*            IF SWFIRST='0'B THEN                                  0059 00224000
         TM    SWFIRST(PARMPTR1),B'00000010'                       0059 00225000
         BNZ   @RF00059                                            0059 00226000
*              DO;                                                 0060 00227000
*                SWFIRST='1'B;      /* FIRST KEYWORD FOUND */      0061 00228000
*                SWBLK='1'B;        /* INDICATE THAT MUST PUT IN   0062 00229000
*                                      BLANK LINE BEFORE KEYWORD INFO   00230000
*                                      PUT OUT */                  0062 00231000
         OI    SWFIRST(PARMPTR1),B'00000011'                       0062 00232000
*              END;                                                0063 00233000
*            KWRD='0'B;             /* IF EQUAL INDICATE KEYWORD   0064 00234000
*                                      FOUND*/                     0064 00235000
@RF00059 NI    KWRD(LISTP),B'01111111'                             0064 00236000
*            SWKEY='1'B;            /* SET SWITCH INDICATING THE   0065 00237000
*                                      KEYWORD HAS BEEN FOUND AND  0065 00238000
*                                      CHECK THROUGH THE REST OF THE    00239000
*                                      LIST FOR DUPLICATES */      0065 00240000
         OI    SWKEY(PARMPTR1),B'00100000'                         0065 00241000
*          END;                                                    0066 00242000
*                                                                  0066 00243000
*                                                                  0066 00244000
*    NEXTK:                                                        0067 00245000
*        IF NXTLSTP='FF000000'X THEN                               0067 00246000
@RF00057 DS    0H                                                  0067 00247000
NEXTK    CLC   NXTLSTP(4,LISTP),@CF00167                           0067 00248000
         BNE   @RF00067                                            0067 00249000
*                                   /* AT END OF KEYWORD LIST */   0068 00250000
*          DO;                                                     0068 00251000
*            IF SWKEY='1'B THEN                                    0069 00252000
         TM    SWKEY(PARMPTR1),B'00100000'                         0069 00253000
         BNO   @RF00069                                            0069 00254000
*                                   /* FOUND KEYWORD NEEDED */     0070 00255000
*              DO;                                                 0070 00256000
*                SWKEY='0'B;        /* REINITIALIZE SWITCH WHICH   0071 00257000
*                                      INDICATED THE KEYWORD WAS   0071 00258000
*                                      FOUND- SO IT CAN BE USED AGAIN   00259000
*                                      */                          0071 00260000
         NI    SWKEY(PARMPTR1),B'11011111'                         0071 00261000
*                GO TO CKFOUND;     /* GO TO SEE IF ALL NEEDED     0072 00262000
*                                      INFORMATION HAS BEEN FOUND */    00263000
         B     CKFOUND                                             0072 00264000
*              END;                                                0073 00265000
*                                                                  0073 00266000
*            ELSE                                                  0074 00267000
*                                   /* AT END OF KEYWORD LIST AND  0074 00268000
*                                      HAVEN'T FOUND KEYWORD WANTED     00269000
*                                      */                          0074 00270000
*              GO TO BEGIN;         /* REPEAT PROCESS */           0074 00271000
*          END;                                                    0075 00272000
*                                                                  0075 00273000
*        LISTP=NXTLSTP;             /* NOT AT END OF KEYWORD LIST, 0076 00274000
*                                      POINT TO NEXT KEYWORD */    0076 00275000
@RF00067 L     LISTP,NXTLSTP(,LISTP)                               0076 00276000
*        GO TO COMPKEY;             /* REPEAT COMPARISON */        0077 00277000
*                                                                  0077 00278000
*                                                                  0077 00279000
         B     COMPKEY                                             0077 00280000
*    CTRLCHAR:                                                     0078 00281000
*                                                                  0078 00282000
*        /************************************************************/ 00283000
*        /*                                                          */ 00284000
*        /*  PROCESS CONTROL CHARACTERS                              */ 00285000
*        /*                                                          */ 00286000
*        /************************************************************/ 00287000
*                                                                  0078 00288000
*                                                                  0078 00289000
*                                                                  0078 00290000
*                                                                  0078 00291000
*        SWPRINT='0'B;              /* HAVE FOUND A CONTROL CHARACTER   00292000
*                                      SO TURN OFF PRINT SWITCH*/  0078 00293000
*                                                                  0078 00294000
CTRLCHAR NI    SWPRINT(PARMPTR1),B'11111011'                       0078 00295000
*        IF SWFOUND='1'B THEN                                      0079 00296000
         TM    SWFOUND(PARMPTR1),B'10000000'                       0079 00297000
         BO    @RT00079                                            0079 00298000
*                                   /* ALL REQUESTED INFORMATION HAS    00299000
*                                      BEEN FOUND */               0080 00300000
*          RETURN;                  /* THEN FINISHED PROCESSING SO 0080 00301000
*                                      RETURN, HAVE READ ONE EXTRA 0080 00302000
*                                      CONTROL CHARACTER */        0080 00303000
*                                                                  0080 00304000
*        I=1;                       /* INITIALIZE PARSE TABLE INDEX     00305000
*                                      */                          0081 00306000
*                                                                  0081 00307000
*                                                                  0081 00308000
         LA    I,1                                                 0081 00309000
*    CNTRLTST:                                                     0082 00310000
*                                   /* SEARCH FOR CONTROL CHARACTERS    00311000
*                                      IN PARSE INFORMATION TABLE */    00312000
*        IF CONTRL(I)=DATAREA(1:2) THEN                            0082 00313000
CNTRLTST LR    @14,I                                               0082 00314000
         AR    @14,@14                                             0082 00315000
         L     @10,DATAREAP(,PARMPTR1)                             0082 00316000
         ST    @14,@TF00001                                        0082 00317000
         ALR   @14,PARMPTR2                                        0082 00318000
         CLC   CONTRL-2(2,@14),DATAREA(@10)                        0082 00319000
         BE    @RT00082                                            0082 00320000
*          GO TO FOUND;             /* WHEN FIND CHARACTER WANTED, GO   00321000
*                                      TO CONTINUE PROCESSING */   0083 00322000
*                                                                  0083 00323000
*        IF CONTRL(I)='FFFF'X THEN                                 0084 00324000
         LR    @14,PARMPTR2                                        0084 00325000
         AL    @14,@TF00001                                        0084 00326000
         CLC   CONTRL-2(2,@14),@CB00164                            0084 00327000
         BE    @RT00084                                            0084 00328000
*          GO TO BEGIN;             /* IF GET TO END OF PARSE TABLE     00329000
*                                      WITHOUT FINDING CHARACTER,  0085 00330000
*                                      THEN DON'T WANT THE         0085 00331000
*                                      INFORMATION ON THE CARD IMAGE    00332000
*                                      - GO TO REPEAT PROCESS */   0085 00333000
*                                                                  0085 00334000
*        I=I+1;                     /* CONSIDER NEXT ITEM IN PARSE 0086 00335000
*                                      TABLE */                    0086 00336000
         AH    I,@CH00048                                          0086 00337000
*        GO TO CNTRLTST;            /* CONTINUE SEARCH */          0087 00338000
*                                                                  0087 00339000
*                                                                  0087 00340000
         B     CNTRLTST                                            0087 00341000
*    FOUND:                                                        0088 00342000
*        PAREN(I)=BLANK;            /* INDICATE FOUND IN PARSE     0088 00343000
*                                      INFORMATION TABLE */        0088 00344000
FOUND    LR    @14,I                                               0088 00345000
         AR    @14,@14                                             0088 00346000
         ALR   @14,PARMPTR2                                        0088 00347000
         MVC   PAREN-2(1,@14),BLANK                                0088 00348000
*        SWMOVOR='1'B;                                             0089 00349000
*                                                                  0089 00350000
*                                                                  0089 00351000
         OI    SWMOVOR(PARMPTR1),B'00000100'                       0089 00352000
*    CKFOUND:                                                      0090 00353000
*                                                                  0090 00354000
*        /************************************************************/ 00355000
*        /*                                                          */ 00356000
*        /*  CHECK TO SEE IF ALL OF THE INFORMATION IN THE PARSE     */ 00357000
*        /*  TABLE HAS BEEN FOUND                                    */ 00358000
*        /*                                                          */ 00359000
*        /************************************************************/ 00360000
*                                                                  0090 00361000
*        I=1;                       /* INITIALIZE INDEX */         0090 00362000
*                                                                  0090 00363000
*                                                                  0090 00364000
CKFOUND  LA    I,1                                                 0090 00365000
*    CKAGN:                                                        0091 00366000
*                                   /* CHECK CONTROL CHARACTER     0091 00367000
*                                      INFORMATION */              0091 00368000
*                                                                  0091 00369000
*        IF CONTRL(I)='FFFF'X THEN                                 0091 00370000
CKAGN    LR    @14,I                                               0091 00371000
         AR    @14,@14                                             0091 00372000
         ST    @14,@TF00001                                        0091 00373000
         ALR   @14,PARMPTR2                                        0091 00374000
         CLC   CONTRL-2(2,@14),@CB00164                            0091 00375000
         BE    @RT00091                                            0091 00376000
*                                   /* END OF CONTROL CHARACTERS WITH   00377000
*                                      EVERYTHING FOUND, GO TO CHECK    00378000
*                                      KEYWORD LIST */             0092 00379000
*          GO TO CKKEYWD;                                          0092 00380000
*                                                                  0092 00381000
*        IF PAREN(I)^=BLANK THEN                                   0093 00382000
         LR    @14,PARMPTR2                                        0093 00383000
         AL    @14,@TF00001                                        0093 00384000
         CLC   PAREN-2(1,@14),BLANK                                0093 00385000
         BNE   @RT00093                                            0093 00386000
*                                   /* IF NOT ALL CONTROL CHARACTER     00387000
*                                      INFORMATION IN TABLE FOUND  0094 00388000
*                                      THEN DON'T SET FOUND SWITCH */   00389000
*          GO TO BLANKOUT;          /* BUT GO TO PUT OUT INFORMATION    00390000
*                                      */                          0094 00391000
*                                                                  0094 00392000
*        I=I+1;                     /* LOOK AT NEXT CONTROL CHARACTER   00393000
*                                      */                          0095 00394000
         AH    I,@CH00048                                          0095 00395000
*        GO TO CKAGN;               /* REPEAT CHECKING */          0096 00396000
*                                                                  0096 00397000
*                                                                  0096 00398000
         B     CKAGN                                               0096 00399000
*    CKKEYWD:                                                      0097 00400000
*                                   /* CHECK KEYWORDS FOUND */     0097 00401000
*        LISTP=KEYPTR;              /* POINT TO BEGINING OF KEYWORD     00402000
*                                      CHAIN */                    0097 00403000
*                                                                  0097 00404000
*                                                                  0097 00405000
CKKEYWD  L     LISTP,KEYPTR(,PARMPTR2)                             0097 00406000
*    CKNKEYWD:                                                     0098 00407000
*        IF LISTP='FF000000'X THEN                                 0098 00408000
CKNKEYWD CL    LISTP,@CF00167                                      0098 00409000
         BNE   @RF00098                                            0098 00410000
*                                   /* END OF KEYWORD CHAIN AND    0099 00411000
*                                      EVERYTHING FOUND TURN ON FOUND   00412000
*                                      SWITCH */                   0099 00413000
*          DO;                                                     0099 00414000
*            SWFOUND='1'B;          /* TURN ON FOUND SWITCH */     0100 00415000
         OI    SWFOUND(PARMPTR1),B'10000000'                       0100 00416000
*            GO TO BLANKOUT;        /* GO TO PUT OUT INFORMATION */     00417000
         B     BLANKOUT                                            0101 00418000
*          END;                                                    0102 00419000
*                                                                  0102 00420000
*        IF KWRD='1'B THEN                                         0103 00421000
@RF00098 TM    KWRD(LISTP),B'10000000'                             0103 00422000
         BO    @RT00103                                            0103 00423000
*                                   /* IF SOME KEYWORD EXISTS FOR  0104 00424000
*                                      WHICH INFORMATION HAS NOT BEEN   00425000
*                                      FOUND, DON'T TURN ON FOUND  0104 00426000
*                                      SWITCH */                   0104 00427000
*          GO TO BLANKOUT;          /* GO TO PUT OUT INFORMATION */     00428000
*                                                                  0104 00429000
*        LISTP=NXTLSTP;             /* POINT TO NEXT KEYWORD */    0105 00430000
         L     LISTP,NXTLSTP(,LISTP)                               0105 00431000
*        GO TO CKNKEYWD;            /* REPEAT CHECK */             0106 00432000
*                                                                  0106 00433000
*                                                                  0106 00434000
         B     CKNKEYWD                                            0106 00435000
*    BLANKOUT:                                                     0107 00436000
*                                                                  0107 00437000
*        /************************************************************/ 00438000
*        /*                                                          */ 00439000
*        /*  REMOVE CONTROL CHARACTERS FROM CARD IMAGE               */ 00440000
*        /*                                                          */ 00441000
*        /************************************************************/ 00442000
*                                                                  0107 00443000
*                                                                  0107 00444000
*        DATAREA(1:2)='  ';         /* BLANK OUT FIRST TWO CHARACTERS   00445000
*                                      OF DATA TO BE PUT OUT TO    0107 00446000
*                                      TERMINAL */                 0107 00447000
*                                                                  0107 00448000
BLANKOUT L     @14,DATAREAP(,PARMPTR1)                             0107 00449000
         MVC   DATAREA(2,@14),@CC00185                             0107 00450000
*        SWPRINT='1'B;              /* TURN ON PRINT SWITCH SO THAT     00451000
*                                      SUCCESDING CARD IMAGES WILL BE   00452000
*                                      PUT OUT UNTIL ANOTHER CONTROL    00453000
*                                      CHARACTER IS ENCOUNTERED */ 0108 00454000
*                                                                  0108 00455000
*                                                                  0108 00456000
         OI    SWPRINT(PARMPTR1),B'00000100'                       0108 00457000
*    PUTOUT:                                                       0109 00458000
*                                                                  0109 00459000
*        /************************************************************/ 00460000
*        /*                                                          */ 00461000
*        /*  PUT OUT CARD IMAGE TO THE TERMINAL USING IKJEFF02       */ 00462000
*        /*                                                          */ 00463000
*        /************************************************************/ 00464000
*                                                                  0109 00465000
*        SW=0;                  /* INIT SWITCHES TO ZERO  Y02668*/ 0109 00466000
PUTOUT   L     @14,MSGPTR(,PARMPTR1)                               0109 00467000
         MVI   SW(@14),X'00'                                       0109 00468000
*        SW2=0;                 /* INIT SWITCHES TO ZERO  Y02668*/ 0110 00469000
         MVI   SW2(@14),X'00'                                      0110 00470000
*        MTNOIDSW='1'B;        /* SET SWITCHES TO PUT OUT DATA     0111 00471000
*                                      NOT A MESSAGE Y02668*/      0111 00472000
*        MTPUTLSW='1'B;           /* USE PUTLINE  Y02668*/         0112 00473000
         OI    MTNOIDSW(@14),B'11000000'                           0112 00474000
*        MSGID='200Z';              /* SET MESSAGE ID NUMBER */    0113 00475000
         MVC   MSGID(4,@14),@CC00189                               0113 00476000
*        IF SWBLK='1'B THEN                                        0114 00477000
         TM    SWBLK(PARMPTR1),B'00000001'                         0114 00478000
         BO    @RT00114                                            0114 00479000
*          GO TO BLKLINE;                                          0115 00480000
*        IF SWMOVOR='1'B THEN                                      0116 00481000
         TM    SWMOVOR(PARMPTR1),B'00000100'                       0116 00482000
         BNO   @RF00116                                            0116 00483000
*          DO;                      /* PUT OUT BLANK LINE TO FORMAT     00484000
*                                      HELP DATA */                0117 00485000
*                                                                  0117 00486000
*    BLKLINE:                                                      0118 00487000
*            VAR1=ADDR(BLANK);      /* MSG IS BLANK LINE     Y02668*/   00488000
BLKLINE  L     @14,MSGPTR(,PARMPTR1)                               0118 00489000
         LA    @10,BLANK                                           0118 00490000
         ST    @10,@TF00001                                        0118 00491000
         MVC   VAR1(3,@14),@TF00001+1                              0118 00492000
*            L1='01'X;              /* ONE CHAR LONG         Y02668*/   00493000
         MVI   L1(@14),X'01'                                       0119 00494000
*            GO TO CALMSG;                                         0120 00495000
         B     CALMSG                                              0120 00496000
*          END;                                                    0121 00497000
*                                                                  0121 00498000
*    SETMSG:                                                       0122 00499000
*                                   /* PUT OUT HELP DATA */        0122 00500000
*        VAR1=DATAREAP;        /* ADDRESS OF HELP DATA Y02668*/    0122 00501000
@RF00116 DS    0H                                                  0122 00502000
SETMSG   L     @14,MSGPTR(,PARMPTR1)                               0122 00503000
         L     @10,DATAREAP(,PARMPTR1)                             0122 00504000
         ST    @10,@TF00001                                        0122 00505000
         MVC   VAR1(3,@14),@TF00001+1                              0122 00506000
*        L1='01000111'B;        /* LENGTH OF HELP DATA = 71 Y02668*/    00507000
         MVI   L1(@14),X'47'                                       0123 00508000
*        IF SWMOVOR='1'B THEN                                      0124 00509000
         TM    SWMOVOR(PARMPTR1),B'00000100'                       0124 00510000
         BNO   @RF00124                                            0124 00511000
*          DO;                                                     0125 00512000
*            VAR1=VAR1+3; /* SKIP CONTROL CHARACTERS Y02668*/      0126 00513000
         AH    @10,@CH00154                                        0126 00514000
         ST    @10,@TF00001                                        0126 00515000
         MVC   VAR1(3,@14),@TF00001+1                              0126 00516000
*            L1='01000100'B;    /* CHANGE LENGTH OF HELP DATA TO   0127 00517000
*                                      68 - SO SEQUENCE NUMBERS ARE     00518000
*                                      NOT PUT OUT Y02668*/        0127 00519000
         MVI   L1(@14),X'44'                                       0127 00520000
*          END;                                                    0128 00521000
*        SWBLK='0'B;                /* RE-INITIALIZE */            0129 00522000
@RF00124 DS    0H                                                  0130 00523000
*        SWMOVOR='0'B;                                             0130 00524000
*                                                                  0130 00525000
         NI    SWBLK(PARMPTR1),B'11111010'                         0130 00526000
*    CALMSG:                                                       0131 00527000
*        REG1 = ADDR(MSGTABLE);             /*  Y02668*/           0131 00528000
CALMSG   L     REG1,MSGPTR(,PARMPTR1)                              0131 00529000
*        CALL IKJEFF02;                                            0132 00530000
         L     @15,@CV00199                                        0132 00531000
         BALR  @14,@15                                             0132 00532000
*                                   /* CALL MESSAGE ROUTINE */     0133 00533000
*                                                                  0133 00534000
*                                                                  0133 00535000
*        /************************************************************/ 00536000
*        /*                                                          */ 00537000
*        /*  CHECK RETURN CODE FROM MESSAGE ROUTINE                  */ 00538000
*        /*                                                          */ 00539000
*        /************************************************************/ 00540000
*                                                                  0133 00541000
*        IF REG15^=0 THEN                                          0133 00542000
         LTR   REG15,REG15                                         0133 00543000
         BZ    @RF00133                                            0133 00544000
*                                   /* IF MESSAGE ROUTINE NOT      0134 00545000
*                                      SUCCESSFUL FOR ANY REASON THEN   00546000
*                                      QUIT */                     0134 00547000
*          DO;                                                     0134 00548000
*            SWERRMSG='1'B;         /* INDICATE WILL SKIP FURTHER  0135 00549000
*                                      PROCESSING */               0135 00550000
         OI    SWERRMSG(PARMPTR1),B'00000001'                      0135 00551000
*            RETURN;                                               0136 00552000
@EL00001 L     @13,4(,@13)                                         0136 00553000
@EF00001 L     @00,@SIZDATD                                        0136 00554000
         LR    @01,@11                                             0136 00555000
         FREEMAIN R,LV=(0),A=(1)                                        00556000
@ER00001 LM    @14,@12,12(@13)                                     0136 00557000
         BR    @14                                                 0136 00558000
*          END;                                                    0137 00559000
*                                                                  0137 00560000
*                                                                  0137 00561000
*        IF SWBLK='1'B THEN                                        0138 00562000
@RF00133 TM    SWBLK(PARMPTR1),B'00000001'                         0138 00563000
         BO    @RT00138                                            0138 00564000
*          GO TO SETMSG;            /* IF JUST PUT OUT BLANK LINE GO    00565000
*                                      BACK TO PUT OUT HELP DATA */     00566000
*        IF SWMOVOR='1'B THEN                                      0140 00567000
         TM    SWMOVOR(PARMPTR1),B'00000100'                       0140 00568000
         BO    @RT00140                                            0140 00569000
*          GO TO SETMSG;                                           0141 00570000
*                                                                  0141 00571000
*                                                                  0141 00572000
*        /************************************************************/ 00573000
*        /*                                                          */ 00574000
*        /*  REPEAT PROCESS                                          */ 00575000
*        /*                                                          */ 00576000
*        /************************************************************/ 00577000
*        GO TO BEGIN;               /* REPEAT PROCESS */           0142 00578000
         B     BEGIN                                               0142 00579000
*        RETURN;                                                   0143 00580000
*        GENERATE;                                                 0144 00581000
        DS    90C                 FOR MAINTANENCE                       00582000
*/*IKJEFH02: CHART */                                              0145 00583000
*/*%START: E START */                                              0145 00584000
*/*%CALH03: S IKJEFH03:READ A CARD IMAGE */                        0145 00585000
*/* D (NO,,YES,%RET:LT) DID EOD OCCUR IN IKJEFH03 ? */             0145 00586000
*/* D (NO,,YES,%RET:LT) DID AN ERROR OCCUR ? */                    0145 00587000
*/* D (NO,,YES,%DATA:LT) IS THE MEMBER THE COMMANDS MEMBER ? */    0145 00588000
*/* D (NO,,YES,%RET:LT) BEGINNING OF A SUBCOM ? */                 0145 00589000
*/* D (YES,,NO,%KEY) DOES CARD HAVE A CONTROL CHARACTER ON IT ? */ 0145 00590000
*/* D (YES,%RET:RT,NO,) FOUND EVERYTHING LOOKING FOR ? */          0145 00591000
*/* D (NO,%CALH03:LL,YES,%PARFND) CHARACTER IN PARSE TABLE? */     0145 00592000
*/*%KEY: D (NO,%OUT,YES,) DOES CARD HAVE A KEYWORD ON IT? */       0145 00593000
*/* D (NO,%FNDALL,YES,%BLK:LL) IS ALL OPER INFO WANTED ? */        0145 00594000
*/*%OUT: D (NO,%CALH03:RL,YES,%DATA:TT) SHOULD CARD BE PUT OUT ? */     00595000
*/*%FNDALL: D (YES,%RET:RT,N0,) HAS HELP CP FOUND AL INFO REQ ? */ 0145 00596000
*/* D (NO,%CALH03:BL,YES,%PARFND) IS KEYWORD ON CARD IN PARSE TABLE?*/  00597000
*/*%PARFND: P INDICATE ITEM FOUND IN PARSE TABLE */                0145 00598000
*/*%BLK: P REMOVE CONTROL CHARACTERS FROM HELP DATA */             0145 00599000
*/*%DATA: P SET UP HELP DATA TO BE PUT OUT */                      0145 00600000
*/* S IKJEFF02:PUT OUT DATA TO TERMINAL */                         0145 00601000
*/* D (YES,%CALH03:RL,NO,) IKJEFF02 SUCCESSFUL ? */                0145 00602000
*/* P INDICATE ERROR OCCURED */                                    0145 00603000
*/*%RET: R RETURN */                                               0145 00604000
*/*IKJEFH02: END */                                                0145 00605000
*        END IKJEFH02                                              0145 00606000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00607000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        * 00608000
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                        * 00609000
*;                                                                 0145 00610000
         B     @EL00001                                            0145 00611000
@DATA    DS    0H                                                       00612000
@CH00048 DC    H'1'                                                     00613000
@CH00154 DC    H'3'                                                     00614000
@SC00204 CLC   KEYWORD(0,@14),DATAREA+2(@10)                            00615000
@DATD    DSECT                                                          00616000
         DS    0F                                                       00617000
@SA00001 DS    18F                                                      00618000
@PC00001 DS    2F                                                       00619000
@AL00001 DS    1A                                                       00620000
@TF00001 DS    F                                                        00621000
@ZTEMPS  DS    0F                                                       00622000
@ZT00002 DC    F'0'                                                     00623000
@ZTEMPND EQU   *                                                        00624000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00625000
IKJEFH02 CSECT                                                          00626000
         DS    0F                                                       00627000
@CF00167 DC    XL4'FF000000'                                            00628000
@DATD    DSECT                                                          00629000
         DS    0D                                                       00630000
FULWRD   DS    F                                                        00631000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00632000
@ENDDATD EQU   *                                                        00633000
IKJEFH02 CSECT                                                          00634000
         DS    0F                                                       00635000
@SIZDATD DC    AL1(0)                                                   00636000
         DC    AL3(@ENDDATD-@DATD)                                      00637000
@CV00148 DC    V(IKJEFH03)                                              00638000
@CV00199 DC    V(IKJEFF02)                                              00639000
         DS    0D                                                       00640000
@CC00156 DC    C'))'                                                    00641000
@CC00161 DC    C' O'                                                    00642000
@CC00185 DC    C'  '                                                    00643000
@CC00189 DC    C'200Z'                                                  00644000
@CB00164 DC    X'FFFF'                                                  00645000
BLANK    DC    CL1' '                                                   00646000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00647000
@01      EQU   01                                                       00648000
@02      EQU   02                                                       00649000
@03      EQU   03                                                       00650000
@04      EQU   04                                                       00651000
@05      EQU   05                                                       00652000
@06      EQU   06                                                       00653000
@07      EQU   07                                                       00654000
@08      EQU   08                                                       00655000
@09      EQU   09                                                       00656000
@10      EQU   10                                                       00657000
@11      EQU   11                                                       00658000
@12      EQU   12                                                       00659000
@13      EQU   13                                                       00660000
@14      EQU   14                                                       00661000
@15      EQU   15                                                       00662000
LISTP    EQU   @02                                                      00663000
REG15    EQU   @15                                                      00664000
REG1     EQU   @01                                                      00665000
PARMPTR1 EQU   @05                                                      00666000
PARMPTR2 EQU   @07                                                      00667000
I        EQU   @03                                                      00668000
SAVEPARM EQU   0                                                        00669000
CPPLPTR  EQU   SAVEPARM                                                 00670000
SWITCHES EQU   SAVEPARM+4                                               00671000
SWCOMAND EQU   SWITCHES                                                 00672000
SWPRINT  EQU   SWITCHES                                                 00673000
SWERRMSG EQU   SWITCHES                                                 00674000
SWFOUND  EQU   SWITCHES+1                                               00675000
SWKEY    EQU   SWITCHES+1                                               00676000
SWEOD    EQU   SWITCHES+1                                               00677000
SWMOVOR  EQU   SWITCHES+1                                               00678000
SWFIRST  EQU   SWITCHES+1                                               00679000
SWBLK    EQU   SWITCHES+1                                               00680000
DATAREAP EQU   SAVEPARM+8                                               00681000
MSGPTR   EQU   SAVEPARM+16                                              00682000
CPPL     EQU   0                                                        00683000
MSGTABLE EQU   0                                                        00684000
TMCTPTR  EQU   MSGTABLE+4                                               00685000
ECBPTR   EQU   MSGTABLE+8                                               00686000
@NM00001 EQU   MSGTABLE+12                                              00687000
SW       EQU   MSGTABLE+20                                              00688000
MTNOIDSW EQU   SW                                                       00689000
MTPUTLSW EQU   SW                                                       00690000
RETMSG   EQU   MSGTABLE+21                                              00691000
SW2      EQU   MSGTABLE+24                                              00692000
MSGID    EQU   MSGTABLE+40                                              00693000
MTINSRTS EQU   MSGTABLE+44                                              00694000
L1       EQU   MTINSRTS                                                 00695000
VAR1     EQU   MTINSRTS+1                                               00696000
L2       EQU   MTINSRTS+4                                               00697000
L3       EQU   MTINSRTS+8                                               00698000
L4       EQU   MTINSRTS+12                                              00699000
RET      EQU   0                                                        00700000
PARSETAB EQU   0                                                        00701000
KEYPTR   EQU   PARSETAB                                                 00702000
CONTRL   EQU   PARSETAB+4                                               00703000
PAREN    EQU   CONTRL                                                   00704000
LIST     EQU   0                                                        00705000
KWRDP    EQU   LIST                                                     00706000
@NM00007 EQU   LIST+4                                                   00707000
KWRDL    EQU   @NM00007                                                 00708000
KWRDF    EQU   @NM00007+2                                               00709000
KWRD     EQU   KWRDF                                                    00710000
NXTLSTP  EQU   LIST+8                                                   00711000
KEYWORD  EQU   0                                                        00712000
DATAREA  EQU   0                                                        00713000
MSGECB   EQU   0                                                        00714000
MSGTMCT  EQU   0                                                        00715000
COMMON   EQU   0                                                        00716000
TABLE    EQU   0                                                        00717000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00718000
CONCHAR  EQU   CONTRL+1                                                 00719000
RETCHAR  EQU   RET+2                                                    00720000
RETSIZE  EQU   RET                                                      00721000
MSGRTN   EQU   MSGTABLE+60                                              00722000
VAR4     EQU   MTINSRTS+13                                              00723000
HIGHL4   EQU   L4                                                       00724000
VAR3     EQU   MTINSRTS+9                                               00725000
HIGHL3   EQU   L3                                                       00726000
VAR2     EQU   MTINSRTS+5                                               00727000
HIGHL2   EQU   L2                                                       00728000
HIGHL1   EQU   L1                                                       00729000
@NM00006 EQU   MSGTABLE+36                                              00730000
@NM00005 EQU   MSGTABLE+32                                              00731000
MTOLDPTR EQU   MSGTABLE+28                                              00732000
@NM00004 EQU   MSGTABLE+25                                              00733000
@NM00003 EQU   SW2                                                      00734000
MT2OLDSW EQU   SW2                                                      00735000
@NM00002 EQU   SW                                                       00736000
MTJOBISW EQU   SW                                                       00737000
MTKEY1SW EQU   SW                                                       00738000
MTHEXSW  EQU   SW                                                       00739000
MTWTOSW  EQU   SW                                                       00740000
MSGCSECT EQU   MSGTABLE+16                                              00741000
MTHIGH   EQU   @NM00001                                                 00742000
MTCPPL   EQU   TMCTPTR                                                  00743000
LISTPTR  EQU   MSGTABLE                                                 00744000
CPPLECT  EQU   CPPL+12                                                  00745000
CPPLPSCB EQU   CPPL+8                                                   00746000
CPPLUPT  EQU   CPPL+4                                                   00747000
CPPLCBUF EQU   CPPL                                                     00748000
TOTALEX  EQU   SAVEPARM+24                                              00749000
COMECB   EQU   SAVEPARM+20                                              00750000
READCBP  EQU   SAVEPARM+12                                              00751000
SWMSGLOP EQU   SWITCHES+1                                               00752000
SWREAD   EQU   SWITCHES+1                                               00753000
SWSUBSER EQU   SWITCHES                                                 00754000
SWPARSE  EQU   SWITCHES                                                 00755000
SWSUBCOM EQU   SWITCHES                                                 00756000
SWPARS   EQU   SWITCHES                                                 00757000
SWCLOSE  EQU   SWITCHES                                                 00758000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00759000
@RT00025 EQU   @EL00001                                                 00760000
@RT00027 EQU   @EL00001                                                 00761000
@RT00029 EQU   PUTOUT                                                   00762000
@RT00031 EQU   @EL00001                                                 00763000
@RT00035 EQU   CTRLCHAR                                                 00764000
@RT00037 EQU   KEYCHAR                                                  00765000
@RT00039 EQU   PUTOUT                                                   00766000
@RT00044 EQU   BLANKOUT                                                 00767000
@RT00046 EQU   FOUNDTST                                                 00768000
@RT00050 EQU   @EL00001                                                 00769000
@RT00052 EQU   BEGIN                                                    00770000
@RT00055 EQU   NEXTK                                                    00771000
@RF00069 EQU   BEGIN                                                    00772000
@RT00079 EQU   @EL00001                                                 00773000
@RT00082 EQU   FOUND                                                    00774000
@RT00084 EQU   BEGIN                                                    00775000
@RT00091 EQU   CKKEYWD                                                  00776000
@RT00093 EQU   BLANKOUT                                                 00777000
@RT00103 EQU   BLANKOUT                                                 00778000
@RT00114 EQU   BLKLINE                                                  00779000
@RT00138 EQU   SETMSG                                                   00780000
@RT00140 EQU   SETMSG                                                   00781000
@ENDDATA EQU   *                                                        00782000
         END   IKJEFH02                                                 00783000
