         TITLE 'IKJEFLE, PHASE I PROMPTER                              *00001000
                        '                                               00002000
IKJEFLE  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'IKJEFLE   78.177'                                 0001 00009000
IKJEFLES DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00171-IKJEFLES)                                   00013000
         ENTRY IKJEFLES                                                 00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00016000
         BALR  @12,0                                               0001 00017000
@PSTART  LA    @10,4095(,@12)                                      0001 00018000
         LA    @09,4095(,@10)                                      0001 00019000
         USING @PSTART,@12                                         0001 00020000
         USING @PSTART+4095,@10                                    0001 00021000
         USING @PSTART+8190,@09                                    0001 00022000
         L     @00,@SIZDATD                                        0001 00023000
         GETMAIN  R,LV=(0)                                              00024000
         LR    @11,@01                                             0001 00025000
         USING @DATD,@11                                           0001 00026000
         ST    @13,@SA00001+4                                      0001 00027000
         LM    @15,@01,16(@13)                                     0001 00028000
         ST    @11,8(,@13)                                         0001 00029000
         LR    @13,@11                                             0001 00030000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00031000
         AH    @15,4(,@15)                                         0001 00032000
         BR    @15                                                 0001 00033000
@EP00001 MVC   @PC00001(4),0(@01)                                  0001 00034000
LWASWAR  EQU   4                                                        00035000
LWAMSPE  EQU   16                                                       00036000
INITDONE EQU  4                                                         00037000
NQUSERID EQU  8                                                         00038000
DQUSERID EQU  12                                                        00039000
SCHEDULE EQU  16                                                        00040000
BCDONE   EQU  20                                                        00041000
TERMINAT EQU  24                                                        00042000
NQDQ0    EQU  0                                                         00043000
NQDQ4    EQU  4                                                         00044000
NQDQ8    EQU  8                                                         00045000
STARTP2  EQU  16                                                        00046000
INITRDY  EQU  20                                                        00047000
ENDTASK  EQU  24                                                        00048000
JSCBDISP EQU 188                                                        00049000
JSCBAOS1 EQU  72                                                        00050000
JSCBAOS2 EQU 192                                                        00051000
*/********************************************************************/ 00052000
*/*                                                                  */ 00053000
*/*MODULE-                                                           */ 00054000
*/*          IKJEFLE                                                 */ 00055000
*/*                                                                  */ 00056000
*/*FUNCTION-                                                         */ 00057000
*/*          ENTRY POINT TO LOGON FOR IKJEFLC                        */ 00058000
*/*                                                                  */ 00059000
*/********************************************************************/ 00060000
*                                                                  0166 00061000
*   LWAPTR   = ADDR(LOGONWA);        /* ADDRESS OF LWA       @Z40NQKC*/ 00062000
         L     @08,@PC00001                                        0166 00063000
         ST    @08,LWAPTR                                          0166 00064000
*   LWPPTR   = ADDR($LWP);           /* AREA FOR LOGON DATA  @Z40NQKC*/ 00065000
         LA    @08,$LWP                                            0167 00066000
         ST    @08,LWPPTR                                          0167 00067000
*   MODE     = LOGON;             /* ENTERED FROM IKJEFLC    @Z40NQKC*/ 00068000
*                                                                  0168 00069000
         MVI   MODE,X'00'                                          0168 00070000
*   CALL MAINLINE;                   /* PROCEED WITH LOGON   @Z40NQKC*/ 00071000
*                                                                  0169 00072000
         BAL   @14,MAINLINE                                        0169 00073000
*   RETURN;                       /* RETURN TO IKJEFLC       @Z40NQKC*/ 00074000
@EL00001 L     @13,4(,@13)                                         0170 00075000
@EF00001 L     @00,@SIZDATD                                        0170 00076000
         LR    @01,@11                                             0170 00077000
         FREEMAIN R,LV=(0),A=(1)                                        00078000
@ER00001 LM    @14,@12,12(@13)                                     0170 00079000
         BR    @14                                                 0170 00080000
*/********************************************************************/ 00081000
*/*                                                                  */ 00082000
*/*MODULE-                                                           */ 00083000
*/*          IKJEFLES                                                */ 00084000
*/*                                                                  */ 00085000
*/*FUNCTION-                                                         */ 00086000
*/*          ENTRY POINT TO LOGON FOR SUBMIT                         */ 00087000
*/*                                                                  */ 00088000
*/********************************************************************/ 00089000
*                                                                  0171 00090000
*IKJEFLES:                                                         0171 00091000
*        ENTRY(SUBLOGON,SUBITEMS,SUBECT,SUBUPT);                   0171 00092000
*                                                                  0171 00093000
@EP00171 MVC   @PC00001+4(16),0(@01)                               0171 00094000
*   RESPECIFY (GPR02P,GPR03P,GPR04P,GPR05P) RSTD;                  0172 00095000
*   GPR02P = ADDR($DUMMY);           /* ZERO OUT CNTL BLOCKS @Z40NQKC*/ 00096000
         LA    GPR02P,$DUMMY                                       0173 00097000
*   GPR03P = LENGTH($DUMMY);                               /*@Z40NQKC*/ 00098000
         LA    GPR03P,1084                                         0174 00099000
*   GPR04P = ZERO;                   /* PADD WITH ZEROES     @Z40NQKC*/ 00100000
         SLR   GPR04P,GPR04P                                       0175 00101000
*   GPR05P = ZERO;                                         /*@Z40NQKC*/ 00102000
         SLR   GPR05P,GPR05P                                       0176 00103000
*   GEN(MVCL GPR02P,GPR04P);                               /*@Z40NQKC*/ 00104000
         MVCL GPR02P,GPR04P                                             00105000
*   RESPECIFY (GPR02P,GPR03P,GPR04P,GPR05P) UNRSTD;                0178 00106000
*                                                                  0178 00107000
*   LWAPTR   = ADDR($LWA);           /* INITIALIZE LWA       @Z40NQKC*/ 00108000
         LA    @08,$LWA                                            0179 00109000
         ST    @08,LWAPTR                                          0179 00110000
*   LWAPECT  = ADDR($ECT);                                 /*@Z40NQKC*/ 00111000
         LA    @15,$ECT                                            0180 00112000
         ST    @15,LWAPECT(,@08)                                   0180 00113000
*   LWAJSEL  = ADDR($JSEL);                                /*@Z40NQKC*/ 00114000
         LA    @15,$JSEL                                           0181 00115000
         ST    @15,LWAJSEL(,@08)                                   0181 00116000
*   LWAPSCB  = ADDR($PSCB);                                /*@Z40NQKC*/ 00117000
         LA    @14,$PSCB                                           0182 00118000
         ST    @14,LWAPSCB(,@08)                                   0182 00119000
*   LWAPASCB = ADDR($ASCB);                                /*@Z40NQKC*/ 00120000
         LA    @07,$ASCB                                           0183 00121000
         ST    @07,LWAPASCB(,@08)                                  0183 00122000
*   LWAILGN  = YES;                                        /*@Z40NQKC*/ 00123000
*                                                                  0184 00124000
         OI    LWAILGN(@08),B'00000001'                            0184 00125000
*   MODE     = SUBMIT;               /* IN SUBMIT MODE       @Z40NQKC*/ 00126000
*                                                                  0185 00127000
         MVI   MODE,X'01'                                          0185 00128000
*   LWPPTR   = ADDR(SUBITEMS);       /* AREA FOR LOGON DATA  @Z40NQKC*/ 00129000
*                                                                  0186 00130000
         L     @08,@PC00001+8                                      0186 00131000
         ST    @08,LWPPTR                                          0186 00132000
*   ASCBTSB  = ADDR($TSB);           /* INITIALIZE ASCB      @Z40NQKC*/ 00133000
         LA    @08,$TSB                                            0187 00134000
         ST    @08,ASCBTSB(,@07)                                   0187 00135000
*   ASCBASXB = ADDR($ASXB);                                /*@Z40NQKC*/ 00136000
*                                                                  0188 00137000
         LA    @08,$ASXB                                           0188 00138000
         ST    @08,ASCBASXB(,@07)                                  0188 00139000
*   JSELCSCB = ADDR($CSCB);          /* INITIALIZE JSEL      @Z40NQKC*/ 00140000
*                                                                  0189 00141000
         LA    @08,$CSCB                                           0189 00142000
         ST    @08,JSELCSCB(,@15)                                  0189 00143000
*   $UPT     = SUBUPT(1:LENGTH(UPT));/* USE SUBMIT UPT       @Z40NQKC*/ 00144000
         L     @08,@PC00001+16                                     0190 00145000
         MVC   $UPT(24),SUBUPT(@08)                                0190 00146000
*   PSCBUPT  = ADDR($UPT);           /* INITIALIZE UPT       @Z40NQKC*/ 00147000
         LA    @08,$UPT                                            0191 00148000
         ST    @08,PSCBUPT(,@14)                                   0191 00149000
*   PSCBUPTL = LENGTH($UPT);                               /*@Z40NQKC*/ 00150000
*                                                                  0192 00151000
         MVC   PSCBUPTL(2,@14),@CH00080                            0192 00152000
*   $ECT     = SUBECT(1:LENGTH(ECT));/* USE SUBMIT ECT       @Z40NQKC*/ 00153000
         L     @08,@PC00001+12                                     0193 00154000
         MVC   $ECT(56),SUBECT(@08)                                0193 00155000
*   INBUF    = ADDR(SUBLOGON);       /* THE LOGON COMMAND    @Z40NQKC*/ 00156000
         L     @08,@PC00001+4                                      0194 00157000
         ST    @08,INBUF                                           0194 00158000
*   CALL MAINLINE;                   /* PROCEED WITH LOGON   @Z40NQKC*/ 00159000
         BAL   @14,MAINLINE                                        0195 00160000
*   RETURN CODE(RTNREG);             /* RETURN TO SUBMIT     @Z40NQKC*/ 00161000
         LR    @08,@15                                             0196 00162000
         L     @13,4(,@13)                                         0196 00163000
         L     @00,@SIZDATD                                        0196 00164000
         LR    @01,@11                                             0196 00165000
         FREEMAIN R,LV=(0),A=(1)                                        00166000
         LR    @15,@08                                             0196 00167000
         L     @14,12(,@13)                                        0196 00168000
         LM    @00,@12,20(@13)                                     0196 00169000
         BR    @14                                                 0196 00170000
*/********************************************************************/ 00171000
*/*                                                                  */ 00172000
*/*SEGMENT-                                                          */ 00173000
*/*          MAINLINE                                                */ 00174000
*/*                                                                  */ 00175000
*/*FUNCTION-                                                         */ 00176000
*/*          NORMAL LOGON PARSING AND PROMPTING                      */ 00177000
*/*                                                                  */ 00178000
*/********************************************************************/ 00179000
*                                                                  0197 00180000
*MAINLINE:                                                         0197 00181000
*        PROCEDURE;                                                0197 00182000
*                                                                  0197 00183000
MAINLINE STM   @14,@12,@SA00002                                    0197 00184000
*   LWALE = '1'B;                 /*INDICATE LE HAS CONTROL    Y02669*/ 00185000
         L     @08,LWAPTR                                          0198 00186000
         OI    LWALE(@08),B'00010000'                              0198 00187000
*   PTRINBUF = ADDR(INBUF);       /* INITIALIZE POINTER TO INPUT   0199 00188000
*                                    BUFFER POINTER                  */ 00189000
         LA    @15,INBUF                                           0199 00190000
         ST    @15,PTRINBUF                                        0199 00191000
*   PTRYS = 0;                    /* INDICATE THAT USER HAS NOT BEEN    00192000
*                                    PROMPTED YET.                   */ 00193000
         SLR   @15,@15                                             0200 00194000
         ST    @15,PTRYS                                           0200 00195000
*   TSBPTR=ASCBTSB;               /* SET POINTER TO TSB        Y02669*/ 00196000
         L     @01,LWAPASCB(,@08)                                  0201 00197000
         L     @14,ASCBTSB(,@01)                                   0201 00198000
         ST    @14,TSBPTR                                          0201 00199000
*   SAVEPERP = 0;                 /*INIT OFFSET TO PERFORM     Y02669*/ 00200000
         ST    @15,SAVEPERP                                        0202 00201000
*                                 /*GROUP DATA IN UADS         Y02669*/ 00202000
*   STATUS = CONTINUE;            /* STATUS IS CONTINUE      @Z40RQKC*/ 00203000
*                                                                  0203 00204000
         ST    @15,STATUS                                          0203 00205000
*   /*****************************************************************/ 00206000
*   /*       INITIALIZE IKJEFLI'S PARAMETER LIST                     */ 00207000
*   /*****************************************************************/ 00208000
*                                                                  0204 00209000
*   PTRLWA = LWAPTR;              /* SET UP POINTER TO LWA           */ 00210000
         ST    @08,PTRLWA                                          0204 00211000
*   PTRBUF = ADDR(IKJEFLWP);      /* ADDR OF LOGON PARMS     @Z40NQKC*/ 00212000
         L     @15,LWPPTR                                          0205 00213000
         ST    @15,PTRBUF                                          0205 00214000
*   PTRIOLST = ADDR(MSGLST);      /* INTIALIZE ADDRESS OF MESSAGE  0206 00215000
*                                    MODULE PARAMETER LIST.          */ 00216000
         LA    @15,MSGLST                                          0206 00217000
         ST    @15,PTRIOLST                                        0206 00218000
*   FUNCPTR = ADDR(PRMTSWC);      /* INDICATES FUNCTION TO BE      0207 00219000
*                                    PERFORMED BY IKJEFLEA           */ 00220000
*                                                                  0207 00221000
         LA    @15,PRMTSWC                                         0207 00222000
         ST    @15,FUNCPTR                                         0207 00223000
*   /*****************************************************************/ 00224000
*   /*       INITIALIZE MESSAGE MODULE'S PARAMETER LIST (IKJEFLGM)   */ 00225000
*   /*****************************************************************/ 00226000
*                                                                  0208 00227000
*   UPTPTR2 = PSCBUPT;            /* INITIALIZE POINTER TO UPT.      */ 00228000
         L     @01,LWAPSCB(,@08)                                   0208 00229000
         L     @15,PSCBUPT(,@01)                                   0208 00230000
         ST    @15,UPTPTR2                                         0208 00231000
*   ECTPTR2 = LWAPECT;            /* INITIALIZE POINTER TO ECT.      */ 00232000
         L     @15,LWAPECT(,@08)                                   0209 00233000
         ST    @15,ECTPTR2                                         0209 00234000
*   ECBPTR = ADDR(CHCECB);        /* INITIALIZE CANCEL ECB POINTER.  */ 00235000
         L     @08,LWAJSEL(,@08)                                   0210 00236000
         L     @08,JSELCSCB(,@08)                                  0210 00237000
         LA    @08,CHCECB(,@08)                                    0210 00238000
         ST    @08,ECBPTR                                          0210 00239000
*   MSGNMPTR = ADDR(PMSGNM);      /* INITIALIZE ADDRESS OF MESSAGE 0211 00240000
*                                    NUMBER.                         */ 00241000
         LA    @08,PMSGNM                                          0211 00242000
         ST    @08,MSGNMPTR                                        0211 00243000
*   SEGS1PTR = ADDR(TEXTINT1(1) );/* FIRST TEXT INSERTION POINTER.   */ 00244000
         LA    @08,TEXTINT1                                        0212 00245000
         ST    @08,SEGS1PTR                                        0212 00246000
*   SEGS2PTR = ADDR(TEXTINT1(1) );/* SECOND TEXT INSERTION POINTER   */ 00247000
*                                                                  0213 00248000
         ST    @08,SEGS2PTR                                        0213 00249000
*   /*****************************************************************/ 00250000
*   /*       INITIALIZE LIST FORMS OF MACRO INSTRUCTIONS             */ 00251000
*   /*****************************************************************/ 00252000
*                                                                  0214 00253000
*   GEN(MVC    MOVEMACS(MACLEN),MACSTRT);                          0214 00254000
*                                                                  0214 00255000
         MVC    MOVEMACS(MACLEN),MACSTRT                                00256000
*CNTPRMPT:                                                         0215 00257000
*                                                                  0215 00258000
*   /*****************************************************************/ 00259000
*   /*       INITIALIZE THE PSCB USERID LENGTH FIELD TO ZERO         */ 00260000
*   /*       INITIALIZE ECT DEFAULT VALUES (MAIL NOTICES)            */ 00261000
*   /*****************************************************************/ 00262000
*                                                                  0215 00263000
*   IKJEFLWP = ''B;               /* ZERO OUT LOGON DATA     @Z40NQKC*/ 00264000
CNTPRMPT L     @08,LWPPTR                                          0215 00265000
         XC    IKJEFLWP(188,@08),IKJEFLWP(@08)                     0215 00266000
*   LWPPSWD = '';                 /* INIT PSWD BUFFER        @Z40NQKC   00267000
*                                    BLANKS                          */ 00268000
         MVI   LWPPSWD(@08),C' '                                   0216 00269000
         MVC   LWPPSWD+1(7,@08),LWPPSWD(@08)                       0216 00270000
*   LWPUSERM = PSCBUSRL;          /* SAVE USERID LENGTH      @Z40NQKC*/ 00271000
         L     @15,LWAPTR                                          0217 00272000
         L     @14,LWAPSCB(,@15)                                   0217 00273000
         SLR   @07,@07                                             0217 00274000
         IC    @07,PSCBUSRL(,@14)                                  0217 00275000
         STH   @07,LWPUSERM(,@08)                                  0217 00276000
*   ROIDLEN = ''B;                /* ZERO LENGTH FIELD       @G32OPKU*/ 00277000
         SLR   @07,@07                                             0218 00278000
         STC   @07,ROIDLEN                                         0218 00279000
*   ROIDDATA = '';                /* BLANK TEXT FIELD        @G32OPKU*/ 00280000
         MVI   ROIDDATA,C' '                                       0219 00281000
         MVC   ROIDDATA+1(254),ROIDDATA                            0219 00282000
*   LWPUSER = PSCBUSER;           /* SAVE USERID FROM PSCB   @Z40NQKC*/ 00283000
         MVC   LWPUSER(7,@08),PSCBUSER(@14)                        0220 00284000
*   PSCBUSRL = 0;                 /* INITIALIZE USERID LENGTH TO ZERO   00285000
*                                    IN PSCB, INDICATING THAT WE HAVE   00286000
*                                    NOT FOUND A VALID USERID YET.   */ 00287000
         MVI   PSCBUSRL(@14),X'00'                                 0221 00288000
*   JSELJCL = 0;                  /* INDICATE THAT NO JCLS'S HAVE  0222 00289000
*                                    BEEN CONSTRUCTED FOR THIS USER. */ 00290000
         SLR   @08,@08                                             0222 00291000
         L     @01,LWAJSEL(,@15)                                   0222 00292000
         ST    @08,JSELJCL(,@01)                                   0222 00293000
*   READBUF = 0;                  /* INITIALIZE POINTER TO UADS    0223 00294000
*                                    INPUT BUFFER TO ZERO.           */ 00295000
         ST    @08,READBUF                                         0223 00296000
*   ECTNMAL = '0'B;               /* SET MAIL AS DEFAULT VALUE       */ 00297000
*   ECTNNOT = '0'B;               /* SET NOTICES AS DEFAULT VAULE    */ 00298000
         L     @01,LWAPECT(,@15)                                   0225 00299000
         NI    ECTNMAL(@01),B'11110011'                            0225 00300000
*   SWCS = SWCS && SWCS;          /* INITIALIZE IKJEFLE'S INTERNAL 0226 00301000
*                                    COMMUNICATION SWITCHES TO ZERO     00302000
*                                    BITS.                           */ 00303000
         XC    SWCS(1),SWCS                                        0226 00304000
*   IF MODE ^= SUBMIT             /* NORMAL TYPE LOGON       @Z40NQKC*/ 00305000
*     THEN INBUF = ZERO;          /* INSURE NO COMMAND YET   @Z40NQKC*/ 00306000
*                                                                  0227 00307000
         CLI   MODE,X'01'                                          0227 00308000
         BE    @RF00227                                            0227 00309000
         ST    @08,INBUF                                           0228 00310000
*   /********************************************************@G32OPKU*/ 00311000
*   /*   INITIALIZE OIDCARD VERIFY ROUTINE POINTERS          @G32OPKU*/ 00312000
*   /********************************************************@G32OPKU*/ 00313000
*                                                                  0229 00314000
*   OIDPTR = ''B;                 /* CLEAR OIDCD BFR POINTER @G32OPKU*/ 00315000
@RF00227 SLR   @08,@08                                             0229 00316000
         ST    @08,OIDPTR                                          0229 00317000
*   OIDLEN = ''B;                 /* CLEAR OIDCD LEN PTR     @G32OPKU*/ 00318000
*                                                                  0230 00319000
         STH   @08,OIDLEN                                          0230 00320000
*   /*****************************************************************/ 00321000
*   /*   TEST LWAILGN BIT IN LWA TO DETERMINE IF INITIAL LOGON,      */ 00322000
*   /*     RELOGON, OR ATTENTION PROCESSING.                         */ 00323000
*   /*     IF LWAILGN BIT IS ONE, THIS IS INITIAL LOGON.             */ 00324000
*   /*     OTHERWISE, IT MAY BE RE-LOGON OR REINITIATION OF LOGON    */ 00325000
*   /*     PROMPTING DUE TO ATTENTION BEING STRUCK.                  */ 00326000
*   /*****************************************************************/ 00327000
*                                                                  0231 00328000
*   IF LWAILGN = '1'B             /* IF INITIAL LOGON, GO TO SEE IF     00329000
*                                    AN INSTALLATION EXIT (IKJEFLD)     00330000
*                                    EXISTS.                         */ 00331000
*     THEN DO;                       /* INITIA LOGON                 */ 00332000
         L     @08,LWAPTR                                          0231 00333000
         TM    LWAILGN(@08),B'00000001'                            0231 00334000
         BNO   @RF00231                                            0231 00335000
*       IF TSBVTAM = '1'B            /* VTAM NOT TCAM        @Z40DQKC*/ 00336000
*         THEN CALL IKTXLOG(INBUF);  /* IKTXLOG WILL SET...  @Z40DQKC*/ 00337000
         L     @08,TSBPTR                                          0233 00338000
         TM    TSBVTAM(@08),B'00000001'                            0233 00339000
         BNO   @RF00233                                            0233 00340000
         LA    @08,INBUF                                           0234 00341000
         ST    @08,@AL00001                                        0234 00342000
         L     @15,@CV00276                                        0234 00343000
         LA    @01,@AL00001                                        0234 00344000
         BALR  @14,@15                                             0234 00345000
*                                    /* ...INBUF=ADDR(BUF)   @Z40DQKC*/ 00346000
*       GO TO GOTOIER;               /* CHECK FOR IKJEFLD            */ 00347000
         B     GOTOIER                                             0235 00348000
*       END;                                                       0236 00349000
*    LWADEST2 = '0000000000000000'X; /*CLEAR LWA DEST        @ZA19323*/ 00350000
@RF00231 L     @08,LWAPTR                                          0237 00351000
         MVC   LWADEST2(8,@08),@CB02921                            0237 00352000
*    PSCBDEST = '0000000000000000'X; /*CLEAR PSCB DEST       @ZA19323*/ 00353000
*                                                                  0238 00354000
         L     @08,LWAPSCB(,@08)                                   0238 00355000
         MVC   PSCBDEST(8,@08),@CB02921                            0238 00356000
*   CALL SCAN1;                   /* CALL IKJEFLEA TO COPY         0239 00357000
*                                    RELOGON BUFFER                  */ 00358000
         BAL   @14,SCAN1                                           0239 00359000
*   LWAILGN = '0'B;               /* INDICATE THAT IT IS NOLONGER  0240 00360000
*                                    INITIAL LOGON                   */ 00361000
*                                                                  0240 00362000
         L     @08,LWAPTR                                          0240 00363000
         NI    LWAILGN(@08),B'11111110'                            0240 00364000
*GOTOIER:                                                          0241 00365000
*                                                                  0241 00366000
*   /*****************************************************************/ 00367000
*   /*       SET UP USER PROFILE TABLE (UPT)                         */ 00368000
*   /*****************************************************************/ 00369000
*                                                                  0241 00370000
*   IF MODE ^= SUBMIT             /* NORMAL LOGON            @Z40NQKC*/ 00371000
*     THEN UPT(1:PSCBUPTL) =      /* ZERO OUT THE UPT                */ 00372000
GOTOIER  CLI   MODE,X'01'                                          0241 00373000
         BE    @RF00241                                            0241 00374000
*          UPT(1:PSCBUPTL) && UPT(1:PSCBUPTL);                     0242 00375000
         L     @08,LWAPTR                                          0242 00376000
         L     @08,LWAPSCB(,@08)                                   0242 00377000
         L     @01,PSCBUPT(,@08)                                   0242 00378000
         LH    @08,PSCBUPTL(,@08)                                  0242 00379000
         BCTR  @08,0                                               0242 00380000
         EX    @08,@SX03252                                        0242 00381000
*   UPTMID = '1'B;                /* INDICATE THAT MESSAGE ID'S WILL    00382000
*                                    BE PRINTER DURING LOGON.        */ 00383000
*                                                                  0243 00384000
*                                                                  0243 00385000
@RF00241 L     @08,LWAPTR                                          0243 00386000
         L     @08,LWAPSCB(,@08)                                   0243 00387000
         L     @08,PSCBUPT(,@08)                                   0243 00388000
         OI    UPTMID(@08),B'00100000'                             0243 00389000
*    IF ADDR(IKJEFLD) ^= 0 &      /* THERE IS LOGON EXIT     @Z40NQKC*/ 00390000
*       MODE ^= SUBMIT            /* NOT INVOKED BY SUBMIT   @Z40NQKC*/ 00391000
*     THEN                                                         0244 00392000
         L     @08,@CV00270                                        0244 00393000
         LTR   @08,@08                                             0244 00394000
         BZ    @RF00244                                            0244 00395000
         CLI   MODE,X'01'                                          0244 00396000
         BE    @RF00244                                            0244 00397000
*       DO;                                                        0245 00398000
*                                                                  0245 00399000
*         /***********************************************************/ 00400000
*   /*       SET UP TO GO TO INSTALLATION EXIT ROUTINE               */ 00401000
*         /***********************************************************/ 00402000
*                                                                  0246 00403000
*        RESPECIFY (GPR01P) RSTD;                          /*@Z40NQKC*/ 00404000
*        GPR01P = ADDR(PARMLST);  /* PARMS FOR IKJEFLI       @Z40NQKC*/ 00405000
         LA    GPR01P,PARMLST                                      0247 00406000
*         CALL  IKJEFLI;      /*  &&&&&&&&*/                       0248 00407000
         L     @15,@CV00273                                        0248 00408000
         BALR  @14,@15                                             0248 00409000
*        RESPECIFY (GPR01P) UNRSTD;                        /*@Z40NQKC*/ 00410000
*       END;                                                       0250 00411000
*                                                                  0250 00412000
*   /*****************************************************************/ 00413000
*   /*       RESET LWA FAIL BITS                                     */ 00414000
*   /*****************************************************************/ 00415000
*                                                                  0251 00416000
*   LWAUFAI = '0'B;               /* RESET USERID ENQ FAIL BIT       */ 00417000
@RF00244 DS    0H                                                  0252 00418000
*   LWAFAIL = '0'B;               /* RESET SYSTEM RESOURCE FAIL BIT  */ 00419000
*                                                                  0252 00420000
         L     @08,LWAPTR                                          0252 00421000
         NI    LWAUFAI(@08),B'01011111'                            0252 00422000
*   /*****************************************************************/ 00423000
*   /*    IF LOGON TO TERMINATE THE TERMINAL SESSION, GO TO SET      */ 00424000
*   /*    DISCONNECT INDICATOR AND CLEANUP RESOURCES.                */ 00425000
*   /*****************************************************************/ 00426000
*                                                                  0253 00427000
*   IF LWADISC = '1'B                                              0253 00428000
*     THEN                                                         0253 00429000
         TM    LWADISC(@08),B'00010000'                            0253 00430000
         BO    @RT00253                                            0253 00431000
*       GOTO CLEANUP4;                                             0254 00432000
*                                                                  0254 00433000
*                                                                  0254 00434000
*   /*****************************************************************/ 00435000
*   /*   IF CANCEL ECB HAS BEEN POSTED, GOTO SET DISCONNECT          */ 00436000
*   /*   INDICATOR AND CLEAN UP RESOURCES.                           */ 00437000
*   /*****************************************************************/ 00438000
*                                                                  0255 00439000
*   IF CHCECB ^= 0                                                 0255 00440000
*     THEN                                                         0255 00441000
         L     @01,LWAJSEL(,@08)                                   0255 00442000
         L     @01,JSELCSCB(,@01)                                  0255 00443000
         L     @15,CHCECB(,@01)                                    0255 00444000
         LTR   @15,@15                                             0255 00445000
         BZ    @RF00255                                            0255 00446000
*       DO;                                                        0256 00447000
*         LWAILGN = '0'B;         /* INDICATE THAT IT IS NO LONGER 0257 00448000
*                                    INITIAL LOGON                   */ 00449000
         NI    LWAILGN(@08),B'11111110'                            0257 00450000
*         GOTO CLEANUP4;                                           0258 00451000
         B     CLEANUP4                                            0258 00452000
*       END;                                                       0259 00453000
*                                                                  0259 00454000
*                                                                  0259 00455000
*   IF LWANOPR = '1'B             /* IF INSTALLATION SUPPLIED PARMS  */ 00456000
*     THEN                                                         0260 00457000
@RF00255 L     @08,LWAPTR                                          0260 00458000
         TM    LWANOPR(@08),B'00001000'                            0260 00459000
         BNO   @RF00260                                            0260 00460000
*       DO;                                                        0261 00461000
*         LWAILGN = '0'B;         /* INDICATE THAT IT IS NO LONGER 0262 00462000
*                                    INITIAL LOGON                   */ 00463000
*                                                                  0262 00464000
*                                                                  0262 00465000
         NI    LWAILGN(@08),B'11111110'                            0262 00466000
*         IF LWANUAD = '1'B       /* IF UADS NOT TO BE ACCESSED      */ 00467000
*           THEN                                                   0263 00468000
         TM    LWANUAD(@08),B'00000100'                            0263 00469000
         BO    @RT00263                                            0263 00470000
*             GOTO BUILDJCL;      /* GO TO SEE IF JCL TO BE BUILT    */ 00471000
*         GOTO OPEN;              /* GO TO CHECK AUTHORIZATION OF  0265 00472000
*                                    INSTALLATION SUPPLIED PARAMETERS*/ 00473000
         B     OPEN                                                0265 00474000
*       END;                                                       0266 00475000
*                                                                  0266 00476000
*     ELSE                        /* IF INSTALLATION HAS NOT SUPPLIED   00477000
*                                    PARMS                           */ 00478000
*       DO;                                                        0267 00479000
*                                                                  0267 00480000
*                                                                  0267 00481000
@RF00260 DS    0H                                                  0268 00482000
*         IF LWAILGN = '1'B       /* INITIAL LOGON, SEE IF WE MUST 0268 00483000
*                                    GET LINE                        */ 00484000
*           THEN                                                   0268 00485000
         L     @08,LWAPTR                                          0268 00486000
         TM    LWAILGN(@08),B'00000001'                            0268 00487000
         BNO   @RF00268                                            0268 00488000
*             DO;                                                  0269 00489000
*               LWAILGN = '0'B;   /* INDICATE NOT INITIAL LOGON    0270 00490000
*                                    ANY MORE                        */ 00491000
         NI    LWAILGN(@08),B'11111110'                            0270 00492000
*               PMSGNM = 0;       /* SET MESSAGE NUMBER TO ZERO TO 0271 00493000
*                                    INDICATE GETLINE                */ 00494000
*                                                                  0271 00495000
         SLR   @08,@08                                             0271 00496000
         STH   @08,PMSGNM                                          0271 00497000
*               IF INBUF = 0      /* IF NO INPUT LINE RETURNED BY  0272 00498000
*                                    INSTALLATION, GET FIRST LINE     * 00499000
*                 THEN                                             0272 00500000
         C     @08,INBUF                                           0272 00501000
         BNE   @RF00272                                            0272 00502000
*                   CALL LGM;     /* CALL IKJEFLGM TO GET LINE       */ 00503000
         BAL   @14,LGM                                             0273 00504000
*             END;                                                 0274 00505000
@RF00272 DS    0H                                                  0275 00506000
*       END;                                                       0275 00507000
*                                                                  0275 00508000
@RF00268 DS    0H                                                  0276 00509000
*SCANCMND:                                                         0276 00510000
*                                                                  0276 00511000
*                                                                  0276 00512000
*   CALL SCAN2;                   /* CALL IKJEFLEA TO SCAN INPUT LINE   00513000
*                                    FOR LOGON OR LOGOFF            */  00514000
*                                                                  0276 00515000
SCANCMND BAL   @14,SCAN2                                           0276 00516000
*STRTLOGN:                                                         0277 00517000
*                                                                  0277 00518000
*   /*****************************************************************/ 00519000
*   /*       PREPARE TO EXAMINE USERID                               */ 00520000
*   /*****************************************************************/ 00521000
*                                                                  0277 00522000
*   PRMTSWC =  1 ;                /* SET PROMPTING SWITCHES TO     0277 00523000
*                                    INDICATE PROMPTING IS FOR     0277 00524000
*                                    USERID.                         */ 00525000
STRTLOGN MVC   PRMTSWC(2),@CH00037                                 0277 00526000
*   PMSGNM = 7;                   /* INDICATE USERID NOT AUTHORIZED     00527000
*                                    MESSAGE TO BE LISTED.           */ 00528000
         MVC   PMSGNM(2),@CH00133                                  0278 00529000
*   CALL PROMPT1;                 /* PARSE FOR USERID                */ 00530000
*                                                                  0279 00531000
         BAL   @14,PROMPT1                                         0279 00532000
*   IF MODE = SUBMIT              /* IF INVOKED BY SUBMIT... @Z40NQKC*/ 00533000
*     THEN RETURN CODE(RTNREG);   /*   THEN RETURN TO SUBMIT @Z40NQKC*/ 00534000
         CLI   MODE,X'01'                                          0280 00535000
         BNE   @RF00280                                            0280 00536000
         L     @14,@SA00002                                        0281 00537000
         LM    @00,@12,@SA00002+8                                  0281 00538000
         BR    @14                                                 0281 00539000
*   IF LWPRECON = YES              /* IF RECONNECT REQUESTED  @G32OPKU* 00540000
*     THEN CALL RECONECT;          /*  AND NOT SUBMIT         @G32OPKU* 00541000
@RF00280 L     @08,LWPPTR                                          0282 00542000
         TM    LWPRECON(@08),B'10000000'                           0282 00543000
         BNO   @RF00282                                            0282 00544000
         BAL   @14,RECONECT                                        0283 00545000
*                                  /*  THEN TRY TO RECONNECT          * 00546000
*OPEN:                                                             0284 00547000
*                                                                  0284 00548000
*   /*****************************************************************/ 00549000
*   /*       SET NO PASSWORD REQUIRED BIT ON                         */ 00550000
*   /*        ENQUEUE ON AND OPEN UADS                               */ 00551000
*   /*****************************************************************/ 00552000
*                                                                  0284 00553000
*   JSCBPASS = '1'B;              /* SET NO PASSWORD REQUIRED BIT  0284 00554000
*                                    ON IN THE JSCB.          A41867 */ 00555000
@RF00282 DS    0H                                                  0284 00556000
OPEN     L     @08,CVTPTR                                          0284 00557000
         L     @08,CVTTCBP(,@08)                                   0284 00558000
         L     @08,TCBCPTR(,@08)                                   0284 00559000
         L     @08,TCBJSCB(,@08)                                   0284 00560000
         OI    JSCBPASS(@08),B'10000000'                           0284 00561000
*   CALL ENQUADS;                 /* ENQ ON SYS1.UADS        @Z40NQKC*/ 00562000
*                                                                  0285 00563000
         BAL   @14,ENQUADS                                         0285 00564000
*   GEN(OPEN   (UADSDCB,INPUT),MF=(E,OPENUADS)); /* OPEN UADS        */ 00565000
*                                                                  0286 00566000
*                                                                  0286 00567000
         OPEN   (UADSDCB,INPUT),MF=(E,OPENUADS)                         00568000
*   IF DCBOFLGS(4) ^= '1'B        /* IF DCB HAS NOT BEEN OPENED    0287 00569000
*                                    SUCCESSFULLY, GO TO SYSTEM    0287 00570000
*                                    TROUBLE ROUTINE.                */ 00571000
*     THEN                                                         0287 00572000
         TM    DCBOFLGS,B'00010000'                                0287 00573000
         BNO   @RT00287                                            0287 00574000
*       GOTO NOOPEN;              /* GOTO SEND TERMINATION MESSAGE 0288 00575000
*                                    TO TERMINAL USER.               */ 00576000
*   LWAPDCB=ADDR(UADSDCB);        /*POINT TO DCB - USED IN     Y02653*/ 00577000
         LA    @08,UADSDCB                                         0289 00578000
         L     @01,LWAPTR                                          0289 00579000
         ST    @08,LWAPDCB(,@01)                                   0289 00580000
*                                 /*STAI PROCESSING            Y02653*/ 00581000
*                                                                  0290 00582000
*CKUSER:                                                           0290 00583000
*                                                                  0290 00584000
*   /*****************************************************************/ 00585000
*   /*       CHECK AUTHORIZATION OF USER                             */ 00586000
*   /*****************************************************************/ 00587000
*                                                                  0290 00588000
*   FINDNAME = LWPUSER;           /* INIT NAME TO FIND       @Z40NQKC*/ 00589000
CKUSER   MVI   FINDNAME+7,C' '                                     0290 00590000
         L     @08,LWPPTR                                          0290 00591000
         MVC   FINDNAME(7),LWPUSER(@08)                            0290 00592000
*   FINDNAME(LWPUSERL+1) = '0';   /* 1ST PHYSICAL BLOCK      @Z40NQKC   00593000
*                                    BLOCK FOR THIS USERID           */ 00594000
         LH    @08,LWPUSERL(,@08)                                  0291 00595000
         LA    @01,FINDNAME(@08)                                   0291 00596000
         MVI   0(@01),C'0'                                         0291 00597000
*   GEN(FIND  UADSDCB,FINDNAME,D); /* SEARCH DIRECTORY FOR USERID    */ 00598000
         FIND  UADSDCB,FINDNAME,D                                       00599000
*   RESPECIFY (GPR15P,SVRTN) RSTD;                         /*@Z40NQKC*/ 00600000
*   SVRTN = GPR15P;               /* SAVE FIND RETURN CODE   @Z40NQKC*/ 00601000
         LR    SVRTN,GPR15P                                        0294 00602000
*   RESPECIFY (GPR15P) UNRSTD;                             /*@Z40NQKC*/ 00603000
*   /*****************************************************************/ 00604000
*   /*  TEST RETURN CODES FROM FIND.                                 */ 00605000
*   /*  RETURN CODE               CONDITION                          */ 00606000
*   /*      0       USERID IS AUTHORIZED TO SYSTEM - CONTINUE        */ 00607000
*   /*              LOGON PROCESSING                                 */ 00608000
*   /*      4       USERID NOT AUTHORIZED - PROMPT USER FOR A        */ 00609000
*   /*              NEW USERID                                       */ 00610000
*   /*      8       I/O ERROR ON UADS DIRECTORY - TRANSMIT  ERROR    */ 00611000
*   /*              MESSAGE TO TERMINAL AND SYSTEM OPERATOR, THEN    */ 00612000
*   /*              DISCONNECT TERMINAL.                             */ 00613000
*   /*****************************************************************/ 00614000
*                                                                  0296 00615000
*   IF SVRTN ^= 0                 /* IF USERID NOT AUTHORIZED,     0296 00616000
*                                    DETERMINE REASON FOR FAILURE.   */ 00617000
*     THEN                                                         0296 00618000
         LTR   SVRTN,SVRTN                                         0296 00619000
         BZ    @RF00296                                            0296 00620000
*       DO;                                                        0297 00621000
*         GEN(CLOSE (UADSDCB),MF=(E,CLOSUADS) ); /* CLOSE UADS DCB   */ 00622000
         CLOSE (UADSDCB),MF=(E,CLOSUADS)                                00623000
*         JSCBPASS = '0'B;        /* SET NO PASSWORD REQUIRED BIT  0299 00624000
*                                    OFF IN THE JSCB.         A41867 */ 00625000
         L     @08,CVTPTR                                          0299 00626000
         L     @08,CVTTCBP(,@08)                                   0299 00627000
         L     @08,TCBCPTR(,@08)                                   0299 00628000
         L     @08,TCBJSCB(,@08)                                   0299 00629000
         NI    JSCBPASS(@08),B'01111111'                           0299 00630000
*         LWAPDCB=0;              /* INDICATE NO DCB IS OPEN   Y02653*/ 00631000
*                                                                  0300 00632000
         L     @08,LWAPTR                                          0300 00633000
         SLR   @06,@06                                             0300 00634000
         ST    @06,LWAPDCB(,@08)                                   0300 00635000
*         CALL DEQUADS;           /* DEQ FROM SYS1.UADS      @Z40NQKC*/ 00636000
*                                                                  0301 00637000
         BAL   @14,DEQUADS                                         0301 00638000
*         IF SVRTN = 4            /* IF USERID NOT AUTHORIZED, PROMPT   00639000
*                                    USER FOR A NEW USERID.          */ 00640000
*           THEN                                                   0302 00641000
         C     SVRTN,@CF00098                                      0302 00642000
         BNE   @RF00302                                            0302 00643000
*             DO;                                                  0303 00644000
*               TEXTINT1(1) = ADDR(LWPUSERI); /* GET ADDRESS @Z40NQKC   00645000
*                                    USERID TEXT INSERTION BUFFER.   */ 00646000
         L     @08,LWPPTR                                          0304 00647000
         LA    @08,LWPUSERI(,@08)                                  0304 00648000
         ST    @08,TEXTINT1                                        0304 00649000
*               PRMTSWC =  1 ;    /* SET PROMPTING SWITCH TO ONE,  0305 00650000
*                                    INDICATING PROMPT FOR USERID.   */ 00651000
         MVC   PRMTSWC(2),@CH00037                                 0305 00652000
*               CALL PROMPT;      /* PROMPT FOR A NEW USERID         */ 00653000
         BAL   @14,PROMPT                                          0306 00654000
*               GOTO OPEN;        /* CHECK AUTHORIZATION OF USERID.  */ 00655000
         B     OPEN                                                0307 00656000
*             END;                                                 0308 00657000
*         GOTO IOERROR;           /* I/O ERROR ON UADS DIRECTORY.  0309 00658000
*                                    GOTO TERMINATE SESSION.         */ 00659000
         B     IOERROR                                             0309 00660000
*       END;                                                       0310 00661000
*   RESPECIFY (SVRTN) UNRSTD;                                      0311 00662000
*                                                                  0311 00663000
@RF00296 DS    0H                                                  0312 00664000
*                                                                  0312 00665000
*   /*****************************************************************/ 00666000
*   /*       PUT USERID AND USERID LENGTH INTO THE PSCB              */ 00667000
*   /*****************************************************************/ 00668000
*                                                                  0312 00669000
*   FINDNAME(LWPUSERL+1) = '';    /* BLANK THE NAME          @Z40NQKC*/ 00670000
         L     @08,LWPPTR                                          0312 00671000
         LH    @08,LWPUSERL(,@08)                                  0312 00672000
         LA    @01,FINDNAME(@08)                                   0312 00673000
         MVI   0(@01),C' '                                         0312 00674000
*   PSCBUSER(1:7) = FINDNAME;     /* MOVE USERID TO PSCB USERID FIELD*/ 00675000
         L     @15,LWAPTR                                          0313 00676000
         L     @14,LWAPSCB(,@15)                                   0313 00677000
         MVC   PSCBUSER(7,@14),FINDNAME                            0313 00678000
*   LWARNM = FINDNAME(1:7);       /* USERID TO LWA                   */ 00679000
         MVC   LWARNM(7,@15),FINDNAME                              0314 00680000
*   PSCBUSRL = LWPUSERL;          /* SAVE LENGTH OF USERID.  @Z40NQKC*/ 00681000
         STC   @08,PSCBUSRL(,@14)                                  0315 00682000
*   LWARNML = LWPUSERL;           /* USERID LENGTH TO LWA            */ 00683000
         STC   @08,LWARNML(,@15)                                   0316 00684000
*   RESPECIFY (WECBPTR) RSTD;                                      0317 00685000
*                                                                  0317 00686000
*  DO;  /*ENQ (SYSIKJUA,LWARNM,E,LWARNML,SYSTEM) TCB(LWASTCB->LOGONTCB) 00687000
*RET(USE)*/                                                        0318 00688000
*  RESPECIFY (GPR01P) RESTRICTED;                                  0319 00689000
*  I056(1:20)=I056(1:20) &&I056(1:20);  /*ZERO OUT THE TABLE*/     0320 00690000
         XC    I056(20),I056                                       0320 00691000
*  I05604(1)=LWARNML;  /*LENGTH OF MINOR RESOURCE NAME*/           0321 00692000
         STC   @08,I05604                                          0321 00693000
*  I05606(1)=ADDR(SYSIKJUA);  /*ADDRESS OF MAJOR RESOURCE NAME*/   0322 00694000
         LA    @08,SYSIKJUA                                        0322 00695000
         ST    @08,I05606                                          0322 00696000
*  I05607(1)=ADDR(LWARNM);  /*ADDRESS OF MINOR RESOURCE NAME*/     0323 00697000
         LA    @08,LWARNM(,@15)                                    0323 00698000
         ST    @08,I05607                                          0323 00699000
*  I05603(1)='00000001'B;  /*SET BIT STRING 1 FOR RESOURCE ELEMENT*/    00700000
         MVI   I05603,B'00000001'                                  0324 00701000
*  I05605(1)='01000011'B;  /*SET BIT STRING 2 FOR RESOURCE ELEMENT*/    00702000
         MVI   I05605,B'01000011'                                  0325 00703000
*  I05601=ADDR(LWASTCB->LOGONTCB);  /*TCB ADDRESS*/                0326 00704000
         L     @08,LWASTCB(,@15)                                   0326 00705000
         ST    @08,I05601                                          0326 00706000
*  I05603(1,1)='1'B;  /*SET END OF LIST BIT*/                      0327 00707000
         OI    I05603,B'10000000'                                  0327 00708000
*  GPR01P=ADDR(I05602);  /*LOAD LIST ADDRESS*/                     0328 00709000
         LA    GPR01P,I05602                                       0328 00710000
*  SVC (56);  /*ISSUE ENQ SVC*/                                    0329 00711000
         SVC   56                                                  0329 00712000
*  RESPECIFY (GPR01P) UNRESTRICTED;                                0330 00713000
*  END;  /*ENQ (SYSIKJUA,LWARNM,E,LWARNML,SYSTEM) TCB(LWASTCB->LOGONTCB 00714000
* RET(USE)*/                                                       0331 00715000
*   RESPECIFY (WECBPTR) UNRSTD;                                    0332 00716000
*   /*****************************************************************/ 00717000
*   /*       IF ENQUEUE UNSUCCESSFUL, THEN SET ENQUEUE FAIL BIT      */ 00718000
*   /*       IN CONTROL BIT STRING (LWA)                             */ 00719000
*   /*       CLOSE UADS DCB                                          */ 00720000
*   /*       SET NO PASSWORD REQUIRED BIT OFF                        */ 00721000
*   /*       SEND ERROR MESSAGE TO TERMINAL & PROMPT FOR LOGON       */ 00722000
*   /*       OR LOGOFF                                               */ 00723000
*   /*****************************************************************/ 00724000
*                                                                  0333 00725000
*   IF I05655(1) ^= 0             /* IF ENQ ON USERID FAILED @Z40RQKC   00726000
*                                    SET BIT IN CONTROL BIT STRING TO   00727000
*                                    INDICATE UNSUCCESSFUL ENQUEUE.  */ 00728000
*     THEN                                                         0333 00729000
         CLI   I05655,0                                            0333 00730000
         BE    @RF00333                                            0333 00731000
*       DO;                                                        0334 00732000
*         CALL DEQUADS;           /* DEQ FROM SYS1.UADS      @Z40NQKC*/ 00733000
         BAL   @14,DEQUADS                                         0335 00734000
*                                 /* AFTER I05655 ENQ CHECK  @Z40NQKC*/ 00735000
*         LWAUFAI = '1'B;         /* TURN ENQUEUE FAIL BIT ON        */ 00736000
         L     @08,LWAPTR                                          0336 00737000
         OI    LWAUFAI(@08),B'10000000'                            0336 00738000
*         GEN(CLOSE (UADSDCB),MF=(E,CLOSUADS) ); /* CLOSE UADS DCB   */ 00739000
         CLOSE (UADSDCB),MF=(E,CLOSUADS)                                00740000
*         JSCBPASS = '0'B;        /* SET NO PASSWORD REQUIRED BIT  0338 00741000
*                                    OFF IN THE JSCB.         A41867 */ 00742000
         L     @08,CVTPTR                                          0338 00743000
         L     @08,CVTTCBP(,@08)                                   0338 00744000
         L     @08,TCBCPTR(,@08)                                   0338 00745000
         L     @08,TCBJSCB(,@08)                                   0338 00746000
         NI    JSCBPASS(@08),B'01111111'                           0338 00747000
*         LWAPDCB=0;              /* INDICATE NO DCB IS OPEN   Y02653*/ 00748000
*                                                                  0339 00749000
         L     @08,LWAPTR                                          0339 00750000
         SLR   @15,@15                                             0339 00751000
         ST    @15,LWAPDCB(,@08)                                   0339 00752000
*UENQFAIL:                                                         0340 00753000
*                                                                  0340 00754000
*         PMSGNM = 24;            /* SET MESSAGE NUMBER TO USERID  0340 00755000
*                                    IN USE MESSAGE.                 */ 00756000
UENQFAIL MVC   PMSGNM(2),@CH00080                                  0340 00757000
*         TEXTINT1(1) = ADDR(LWPUSERI); /* ADDR OF USERID    @Z40NQKC   00758000
*                                    INSERTION BUFFER.               */ 00759000
         L     @08,LWPPTR                                          0341 00760000
         LA    @08,LWPUSERI(,@08)                                  0341 00761000
         ST    @08,TEXTINT1                                        0341 00762000
*         CALL LGM;               /* CALL MESSAGE MODULE TO        0342 00763000
*                                    SEND MESSAGE TO TERMINAL.       */ 00764000
*                                                                  0342 00765000
         BAL   @14,LGM                                             0342 00766000
*         /***********************************************************/ 00767000
*         /*  ZERO OUT 'PSCBUSRL' FIELD SO THAT WE DO NOT TRY TO     */ 00768000
*         /*  DEQUEUE FROM IT IN ERROR CLEANUP ROUTINE. REINITIALIZE */ 00769000
*         /*  'USERID', 'PASSWORD', 'ACCOUNT NUMBER', ETC., BUFFER.  */ 00770000
*         /*  FREE ANY 'JCLS' BUILT BY MODULE IKJEFLI.               */ 00771000
*         /***********************************************************/ 00772000
*                                                                  0343 00773000
*         PSCBUSRL = 0;           /* INDICATE NO 'USERID' FOUND YET  */ 00774000
         L     @08,LWAPTR                                          0343 00775000
         L     @01,LWAPSCB(,@08)                                   0343 00776000
         MVI   PSCBUSRL(@01),X'00'                                 0343 00777000
*         IKJEFLWP = ''B;         /* ZERO LOGON DATA         @Z40NQKC   00778000
*                                    ACCOUNT NUMBER, ETC., BUFFER.   */ 00779000
         L     @15,LWPPTR                                          0344 00780000
         XC    IKJEFLWP(188,@15),IKJEFLWP(@15)                     0344 00781000
*         LWPPSWD = ' ';          /* BLANK THE PASSWORD      @Z40NQKC*/ 00782000
         MVI   LWPPSWD+1(@15),C' '                                 0345 00783000
         MVC   LWPPSWD+2(6,@15),LWPPSWD+1(@15)                     0345 00784000
         MVI   LWPPSWD(@15),C' '                                   0345 00785000
*         ECTNMAL = '0'B;         /* RESET DEFAULT OF 'MAIL'         */ 00786000
*         ECTNNOT = '0'B;         /* RESET DEFAULT OF 'NOTICES'      */ 00787000
         L     @08,LWAPECT(,@08)                                   0347 00788000
         NI    ECTNMAL(@08),B'11110011'                            0347 00789000
*         CALL FREEJCLS;          /* FREE ANY JCLS BUILT BY IKJEFLI  */ 00790000
         BAL   @14,FREEJCLS                                        0348 00791000
*         GOTO GOTOIER;           /* GOTO INSTALLATION EXIT ROUTINE. */ 00792000
         B     GOTOIER                                             0349 00793000
*       END;                                                       0350 00794000
*     ELSE CALL DEQUADS;          /* DEQUE FROM UADS DIR     @Z40NQKC*/ 00795000
*                                                                  0351 00796000
@RF00333 BAL   @14,DEQUADS                                         0351 00797000
*   /*****************************************************************/ 00798000
*   /*       USERID IS VALID, SO CONTINUE VALIDITY CHECKING          */ 00799000
*   /*       REMAINING LOGON PARAMETERS.                             */ 00800000
*   /*       PUT USERID INTO CSCB.                                   */ 00801000
*   /*****************************************************************/ 00802000
*   CHKEY = FINDNAME;             /* MOVE USERID TO THE CSCB         */ 00803000
         L     @08,LWAPTR                                          0352 00804000
         L     @01,LWAJSEL(,@08)                                   0352 00805000
         L     @15,JSELCSCB(,@01)                                  0352 00806000
         MVC   CHKEY(8,@15),FINDNAME                               0352 00807000
*   ASCBJBNS=ADDR(CHKEY);         /*PUT PTR TO USERID IN ASCB  Y02669*/ 00808000
*                                                                  0353 00809000
         L     @08,LWAPASCB(,@08)                                  0353 00810000
         LA    @15,CHKEY(,@15)                                     0353 00811000
         ST    @15,ASCBJBNS(,@08)                                  0353 00812000
*   /*****************************************************************/ 00813000
*   /*       OBTAIN BUFFER FOR UADS MEMBER                           */ 00814000
*   /*       READ IN HEADER BLOCK FOR THIS USER                      */ 00815000
*   /*****************************************************************/ 00816000
*                                                                  0354 00817000
*   RESPECIFY (LENBUF) RSTD;                                       0354 00818000
*   LENBUF = DCBBLKSI;            /* GET LENGTH OF BLOCKSIZE NEEDED     00819000
*                                    FOR UADS MEMBER RECORD          */ 00820000
         LH    LENBUF,DCBBLKSI                                     0355 00821000
*   GEN(GETMAIN  R,SP=1,LV=(LENBUF)); /* OBTAIN CORE FOR ONE BUFFER  */ 00822000
         GETMAIN  R,SP=1,LV=(LENBUF)                                    00823000
*   RESPECIFY (GTMNPTR) RSTD;                                      0357 00824000
*   READBUF = GTMNPTR;            /* SAVE ADDRESS OF UADS BUFFER     */ 00825000
         ST    GTMNPTR,READBUF                                     0358 00826000
*   RESPECIFY (GTMNPTR,LENBUF) UNRSTD;                             0359 00827000
*   UADSNDAT = 0;                                                  0360 00828000
         SLR   @08,@08                                             0360 00829000
         ST    @08,UADSNDAT                                        0360 00830000
*   CALL FIND1;                   /* READ IN FIRST PHYSICAL MEMBER 0361 00831000
*                                    FROM UADS FOR THIS USERID       */ 00832000
*                                                                  0361 00833000
         BAL   @14,FIND1                                           0361 00834000
*   IF UADSEXPF='1'B              /*IF EXPANDED FORMAT UADS    Y02669*/ 00835000
*     THEN                        /*THEN                       Y02669*/ 00836000
         L     @08,READBUF                                         0362 00837000
         TM    UADSEXPF(@08),B'01000000'                           0362 00838000
         BNO   @RF00362                                            0362 00839000
*       DO;                       /*                           Y02669*/ 00840000
*         EXPUADS='1'B;           /*SAVE INDICATOR FOR EXPUADS Y02669*/ 00841000
         OI    EXPUADS,B'00001000'                                 0364 00842000
*         SAVEPERP=UADSPERP;      /*SAVE OFFSET TO             Y02669*/ 00843000
         L     @15,UADSPERP(,@08)                                  0365 00844000
         ST    @15,SAVEPERP                                        0365 00845000
*                                 /*PERFORMANCE GROUP DATA     Y02669*/ 00846000
*         IF LWADEST='0'B &       /*IF INSTALLATION DID NOT    Y02664*/ 00847000
*                                 /*SUPPLY DEST AND            Y02664*/ 00848000
*                                 /*DEST IS NOT DEFAULT DEST   Y02664*/ 00849000
*            UADSDEST^='0000000000000000'X  /* THEN            Y02664*/ 00850000
*          THEN                   /*HAVE SUBSYSTEM VERIFY DEST Y02664*/ 00851000
         L     @01,LWAPTR                                          0366 00852000
         TM    LWADEST(@01),B'00000100'                            0366 00853000
         BNZ   @RF00366                                            0366 00854000
         CLC   UADSDEST(8,@08),@CB02921                            0366 00855000
         BE    @RF00366                                            0366 00856000
*            DO;                  /*                           Y02664*/ 00857000
*              SSOB=SSOB&&SSOB;   /*CLEAR CONTROL BLOCK        Y02664*/ 00858000
         XC    SSOB(20),SSOB                                       0368 00859000
*              SSOBID='SSOB';     /*SET CNTL BLOCK ID          Y02664*/ 00860000
         MVC   SSOBID(4),@CC02957                                  0369 00861000
*              SSOBLEN=LENGTH(SSOB); /*SET CNTL BLOCK LENGTH   Y02664*/ 00862000
         MVC   SSOBLEN(2),@CH00340                                 0370 00863000
*              SSOBFUNC=SSOBUSER; /*SET FUNCTION ID            Y02664*/ 00864000
         MVC   SSOBFUNC(2),@CH00033                                0371 00865000
*              SSOBINDV=ADDR(SSUS);  /*SET PTR TO FNCTION AREA Y02664*/ 00866000
         LA    @03,SSUS                                            0372 00867000
         ST    @03,SSOBINDV                                        0372 00868000
*              SSUS=SSUS&&SSUS;   /*CLEAR CONTROL BLOCK        Y02664*/ 00869000
         XC    SSUS(16),SSUS                                       0373 00870000
*              SSUSLEN=LENGTH(SSUS); /*SET LEN OF FUNCTN AREA  Y02664*/ 00871000
         MVC   SSUSLEN(2),@CH00145                                 0374 00872000
*              SSUSUSER=UADSDEST; /*INDICATE DESTINATION FROM  Y02664*/ 00873000
         MVC   SSUSUSER(8),UADSDEST(@08)                           0375 00874000
*                                 /*UADS TO BE VERIFIED        Y02664*/ 00875000
*                                                                  0376 00876000
*              SSIBPTR=ADDR(DUMYSSIB);  /*POINT TO SSIB        Y02664*/ 00877000
         LA    SSIBPTR,DUMYSSIB                                    0376 00878000
*              SSOBSSIB=SSIBPTR;  /*POINT SSOB TO SSIB         Y02664*/ 00879000
         ST    SSIBPTR,SSOBSSIB                                    0377 00880000
*              SSIB=SSIB&&SSIB;   /*CLEAR SSIB                 Y02664*/ 00881000
         XC    SSIB(36,SSIBPTR),SSIB(SSIBPTR)                      0378 00882000
*              SSIBID='SSIB';     /*SET CNTL BLK ID            Y02664*/ 00883000
         MVC   SSIBID(4,SSIBPTR),@CC02958                          0379 00884000
*              SSIBLEN=LENGTH(SSIB); /*SET CNTL BLOCK LEN      Y02664*/ 00885000
         MVC   SSIBLEN(2,SSIBPTR),@CH00497                         0380 00886000
*              SSIBSSNM=JESPJESN; /*SET SUBSYSTEM NAME         Y02664*/ 00887000
*                                                                  0381 00888000
*                                                                  0381 00889000
         L     @08,CVTPTR                                          0381 00890000
         L     @08,CVTJESCT(,@08)                                  0381 00891000
         MVC   SSIBSSNM(4,SSIBPTR),JESPJESN(@08)                   0381 00892000
*               /* ? IEFSSREQ  (SSOB);*/                           0382 00893000
*/*                                           */                   0382 00894000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO   */                   0382 00895000
*/*  PROCESS REQUEST -                        */                   0382 00896000
*/*                                           */                   0382 00897000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-    */                   0382 00898000
*/*            WORD PARAMETER LIST WHICH      */                   0382 00899000
*/*            POINTS TO THE SSOB             */                   0382 00900000
*/*                                           */                   0382 00901000
*CALL SSREQ(SSOB);   /*INVOKE SUBSYSTEM           Y02664*/         0382 00902000
*                                                                  0382 00903000
         LA    @15,SSOB                                            0382 00904000
         ST    @15,@AL00001                                        0382 00905000
         MVI   @AL00001,X'80'                                      0382 00906000
         L     @15,JESSSREQ(,@08)                                  0382 00907000
         LA    @01,@AL00001                                        0382 00908000
         BALR  @14,@15                                             0382 00909000
*              RESPECIFY (RTNREG) RSTD;  /*                    Y02664*/ 00910000
*              IF RTNREG = 0         /*IF SUBSYSTEM INTERFACE  Y02664*/ 00911000
*                THEN                /*WAS VALID               Y02664*/ 00912000
         SLR   @14,@14                                             0384 00913000
         CR    RTNREG,@14                                          0384 00914000
         BNE   @RF00384                                            0384 00915000
*                 DO;                /*THEN                    Y02664*/ 00916000
*                   IF SSOBRETN=SSUSRTOK   /*IF DEST WAS VALID Y02664*/ 00917000
*                     THEN DO;               /* SAVE DEST            */ 00918000
         C     @14,SSOBRETN                                        0386 00919000
         BNE   @RF00386                                            0386 00920000
*                       LWADEST2 = UADSDEST;                       0388 00921000
         L     @14,LWAPTR                                          0388 00922000
         L     @08,READBUF                                         0388 00923000
         MVC   LWADEST2(8,@14),UADSDEST(@08)                       0388 00924000
*                       PSCBDEST = UADSDEST;               /*@ZA07487*/ 00925000
         L     @14,LWAPSCB(,@14)                                   0389 00926000
         MVC   PSCBDEST(8,@14),UADSDEST(@08)                       0389 00927000
*                       END;                                       0390 00928000
*                      ELSE             /*IF DEST NOT VALID    Y02664*/ 00929000
*                        IF SSOBRETN=SSUSNOUS /*IF UNDEFINED   Y02664*/ 00930000
*                          THEN         /* THEN                Y02664*/ 00931000
         B     @RC00386                                            0391 00932000
@RF00386 CLC   SSOBRETN(4),@CF00098                                0391 00933000
         BNE   @RF00391                                            0391 00934000
*                            DO;  /*PUT OUT MSG-'INVALID DEST, Y02664*/ 00935000
*                                 /*  DEFAULT DEST TO BE USED' Y02664*/ 00936000
*                              PMSGNM=49;  /*                  Y02664*/ 00937000
         MVC   PMSGNM(2),@CH02959                                  0393 00938000
*                                /*SET UP TEXT INSERT FOR DEST Y02664*/ 00939000
*                              TEXTINT1(1)=ADDR(TEXTSEGS(1));/*Y02664*/ 00940000
         LA    @14,TEXTSEGS                                        0394 00941000
         ST    @14,TEXTINT1                                        0394 00942000
*                              TEXTSLEN(1)=12;       /*        Y02664*/ 00943000
         MVC   TEXTSLEN(2),@CH00034                                0395 00944000
*                              TEXTSTXT(1)=UADSDEST; /*        Y02664*/ 00945000
         MVI   TEXTSTXT+8,C' '                                     0396 00946000
         MVC   TEXTSTXT+9(11),TEXTSTXT+8                           0396 00947000
         L     @14,READBUF                                         0396 00948000
         MVC   TEXTSTXT(8),UADSDEST(@14)                           0396 00949000
*                              CALL LGM;  /*SEND MSG TO TERM   Y02664*/ 00950000
         BAL   @14,LGM                                             0397 00951000
*                            END;         /*                   Y02664*/ 00952000
*                                                                  0398 00953000
*                        ELSE     /*IF SUBSYSTEM ERROR CODE    Y02664*/ 00954000
*                          DO;    /*PUT OUT ERROR MSG          Y02664*/ 00955000
         B     @RC00391                                            0399 00956000
@RF00391 DS    0H                                                  0400 00957000
*                                 /*AND TERMINATE              Y02664*/ 00958000
*                            RESPECIFY (SUBSYSRC) RSTD;    /*@Z40RQKC*/ 00959000
*                            SUBSYSRC=SSOBRETN; /*PREPARE CVD  Y02664*/ 00960000
         L     SUBSYSRC,SSOBRETN                                   0401 00961000
*                            GENERATE;    /*                   Y02664*/ 00962000
                             CVD SUBSYSRC,CONVERT   CONVERT RC Y02664   00963000
                             UNPK ZONEDEC(8),CONVERT(8)        Y02664   00964000
                             OI   ZONEDEC+7,X'F0' FIX SIGN     Y02664   00965000
*                                 /*PUT RETURN CODE IN MSG      02664*/ 00966000
*                            RESPECIFY (SUBSYSRC) UNRSTD;  /*@Z40RQKC*/ 00967000
*                            TEXTSLEN(2)=7;  /*SET TEXT LEN    Y02664*/ 00968000
         MVC   TEXTSLEN+24(2),@CH00133                             0404 00969000
*                            TEXTSTXT(2,1:3)=ZONEDEC(6:8); /*  Y02664*/ 00970000
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            0405 00971000
*                            TEXTSLEN(1)=8;  /*SET TEXT LEN    Y02664*/ 00972000
         MVC   TEXTSLEN(2),@CH00046                                0406 00973000
*                            TEXTSTXT(1,1:4)=JESPJESN; /*PUT   Y02664*/ 00974000
         L     @14,CVTPTR                                          0407 00975000
         L     @14,CVTJESCT(,@14)                                  0407 00976000
         MVC   TEXTSTXT(4),JESPJESN(@14)                           0407 00977000
*                                         /*IN SUBSYSTEM NAME  Y02664*/ 00978000
*                            GO TO SETUPMSG; /*SEND OUT MSG    Y02664*/ 00979000
         B     SETUPMSG                                            0408 00980000
*                          END;         /*                     Y02664*/ 00981000
*                  END;                 /*                     Y02664*/ 00982000
*                                                                  0410 00983000
*              ELSE               /*IF SUBSYSTEM INTERFACE     Y02664*/ 00984000
*                DO;              /*PROBLEM, PUT OUT MSG       Y02664*/ 00985000
         B     @RC00384                                            0411 00986000
@RF00384 DS    0H                                                  0412 00987000
*                  GENERATE;          /*                       Y02664*/ 00988000
*                                                                  0412 00989000
                   CVD RTNREG,CONVERT CONVERT RC               Y02664   00990000
                   UNPK ZONEDEC(8),CONVERT(8)                  Y02664   00991000
                   OI   ZONEDEC+7,X'F0'  FIX SIGN              Y02664   00992000
*                  TEXTSLEN(2)=7; /*SET TEXT LEN               Y02664*/ 00993000
         MVC   TEXTSLEN+24(2),@CH00133                             0413 00994000
*                  TEXTSTXT(2,1:3)=ZONEDEC(6:8);  /*           Y02664*/ 00995000
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            0414 00996000
*                  TEXTSTXT(1,1:5)=JESPJESN; /*PUT IN          Y02664*/ 00997000
         MVI   TEXTSTXT+4,C' '                                     0415 00998000
         L     @14,CVTPTR                                          0415 00999000
         L     @14,CVTJESCT(,@14)                                  0415 01000000
         MVC   TEXTSTXT(4),JESPJESN(@14)                           0415 01001000
*                                 /*SUBSYSTEM NAME             Y02664*/ 01002000
*                  TEXTSTXT(1,6:14)='INTERFACE'; /*            Y02664*/ 01003000
         MVC   TEXTSTXT+5(9),@CC02962                              0416 01004000
*                  TEXTSLEN(1)=18;  /*SET TEXT LEN             Y02664*/ 01005000
         MVC   TEXTSLEN(2),@CH00090                                0417 01006000
*                  GO TO SETUPMSG;  /*SEND OUT ERROR MSG       Y02664*/ 01007000
         B     SETUPMSG                                            0418 01008000
*                END;             /*                           Y02664*/ 01009000
*           END;                  /*                           Y02664*/ 01010000
@RC00384 DS    0H                                                  0421 01011000
*      END;                       /*                           Y02664*/ 01012000
@RF00366 DS    0H                                                  0422 01013000
*                RESPECIFY (RTNREG) UNRSTD; /*                 Y02664*/ 01014000
*                                                                  0422 01015000
@RF00362 DS    0H                                                  0423 01016000
*   IF UADSMAXC = 0               /* IF MAXIMUM CORE SIZE IN UADS IS    01017000
*                                    ZERO, INDICATE NO MAXIMUM SIZE. */ 01018000
*     THEN                                                         0423 01019000
         L     @08,READBUF                                         0423 01020000
         LH    @08,UADSMAXC(,@08)                                  0423 01021000
         N     @08,@CF03257                                        0423 01022000
         LTR   @08,@08                                             0423 01023000
         BNZ   @RF00423                                            0423 01024000
*       MAXCORE = 32767;          /* DEFAULT MAXIMUM REGION SIZE     */ 01025000
         MVC   MAXCORE(2),@CH02964                                 0424 01026000
*     ELSE                                                         0425 01027000
*       MAXCORE = UADSMAXC;       /* RECORD MAXIMUM FROM UADS HEADER */ 01028000
*                                                                  0425 01029000
*                                                                  0425 01030000
         B     @RC00423                                            0425 01031000
@RF00423 L     @08,READBUF                                         0425 01032000
         LH    @08,UADSMAXC(,@08)                                  0425 01033000
         N     @08,@CF03257                                        0425 01034000
         STH   @08,MAXCORE                                         0425 01035000
*   IF LWAATR1 = '0'B             /* IF INSTALLATION EXIT DID NOT  0426 01036000
*                                    SUPPLY FIRST ATTRIBUTE BIT    0426 01037000
*                                    STRING, THEN RECORD IT FROM UADS*/ 01038000
*     THEN                                                         0426 01039000
@RC00423 L     @08,LWAPTR                                          0426 01040000
         TM    LWAATR1(@08),B'10000000'                            0426 01041000
         BNZ   @RF00426                                            0426 01042000
*         PSCBATR1 = UADSATR;                                      0427 01043000
*                                                                  0427 01044000
         L     @08,LWAPSCB(,@08)                                   0427 01045000
         L     @01,READBUF                                         0427 01046000
         MVC   PSCBATR1(2,@08),UADSATR(@01)                        0427 01047000
*   IF LWAATR2 = '0'B             /* IF INSTALLATION EXIT DIDNOT   0428 01048000
*                                    SUPPLY SECOND ATTRIBUTE BIT   0428 01049000
*                                    STRING, RECORD IT FROM UADS.    */ 01050000
*     THEN                                                         0428 01051000
@RF00426 L     @08,LWAPTR                                          0428 01052000
         TM    LWAATR2(@08),B'01000000'                            0428 01053000
         BNZ   @RF00428                                            0428 01054000
*       PSCBATR2 = UADSINST;                                       0429 01055000
*                                                                  0429 01056000
         L     @08,LWAPSCB(,@08)                                   0429 01057000
         L     @01,READBUF                                         0429 01058000
         MVC   PSCBATR2(2,@08),UADSINST(@01)                       0429 01059000
*    PSCBSUBH = UADSSUBH;         /* HOLD CLASS              @DZ04005*/ 01060000
@RF00428 L     @08,LWAPTR                                          0430 01061000
         L     @15,LWAPSCB(,@08)                                   0430 01062000
         L     @14,READBUF                                         0430 01063000
         MVC   PSCBSUBH(1,@15),UADSSUBH(@14)                       0430 01064000
*    PSCBSUBC = UADSSUBC;         /* JOB CLASS               @DZ04005*/ 01065000
         MVC   PSCBSUBC(1,@15),UADSSUBC(@14)                       0431 01066000
*    PSCBSUBM = UADSSUBM;         /* MESSAGE CLASS           @DZ04005*/ 01067000
         MVC   PSCBSUBM(1,@15),UADSSUBM(@14)                       0432 01068000
*    PSCBSOUT = UADSSOUT;         /* SYSOUT CLASS            @DZ04005*/ 01069000
*                                                                  0433 01070000
         MVC   PSCBSOUT(1,@15),UADSSOUT(@14)                       0433 01071000
*   UADSNSUB = UADSPWD1;          /* SAVE OFFSET TO THE FIRST      0434 01072000
*                                    PASSWORD OFFSET BLOCK.          */ 01073000
*                                                                  0434 01074000
*                                                                  0434 01075000
         L     @15,UADSPWD1(,@14)                                  0434 01076000
         ST    @15,UADSNSUB                                        0434 01077000
*   IF LWABUPT = '0'B             /* IF INSTALLATION EXIT DID NOT  0435 01078000
*                                    SUPPLY UPT IMAGE, RECORD IT FROM   01079000
*                                    THE UADS.                       */ 01080000
*     THEN                                                         0435 01081000
         TM    LWABUPT(@08),B'00010000'                            0435 01082000
         BNZ   @RF00435                                            0435 01083000
*       DO;                                                        0436 01084000
*         UADSNDAT = UADSUPTP;    /* SET UP FIND PROCEDURE INTERFACE    01085000
*                                    TO READ UPT FROM UADS.          */ 01086000
         L     @08,UADSUPTP(,@14)                                  0437 01087000
         ST    @08,UADSNDAT                                        0437 01088000
*         CALL FIND1;             /* CALL FIND TO READ UPT FROM UADS.*/ 01089000
         BAL   @14,FIND1                                           0438 01090000
*         IF EXPUADS = '1'B       /*IF EXPANDED FORMAT UADS    Y02669*/ 01091000
*           THEN                  /*                           Y02669*/ 01092000
         TM    EXPUADS,B'00001000'                                 0439 01093000
         BNO   @RF00439                                            0439 01094000
*             UPT=UADSBUFR->UPT;  /*THEN READ EXPANDED UPT     Y02669*/ 01095000
         L     @08,LWAPTR                                          0440 01096000
         L     @08,LWAPSCB(,@08)                                   0440 01097000
         L     @08,PSCBUPT(,@08)                                   0440 01098000
         L     @01,UADSBUFR                                        0440 01099000
         MVC   UPT(24,@08),UPT(@01)                                0440 01100000
*                                 /*ELSE READ OLD FORMAT UPT   Y02669*/ 01101000
*         ELSE UPT(1:16)=UADSBUFR->UPT;                    /*@Z40RQKC*/ 01102000
*                                                                  0441 01103000
         B     @RC00439                                            0441 01104000
@RF00439 L     @08,LWAPTR                                          0441 01105000
         L     @08,LWAPSCB(,@08)                                   0441 01106000
         L     @08,PSCBUPT(,@08)                                   0441 01107000
         L     @01,UADSBUFR                                        0441 01108000
         MVC   UPT(16,@08),UPT(@01)                                0441 01109000
*         PSCBCHAR=UPTCDEL;       /*PUT CHAR DEL CHAR IN PSCB  Y02669*/ 01110000
@RC00439 L     @08,LWAPTR                                          0442 01111000
         L     @08,LWAPSCB(,@08)                                   0442 01112000
         L     @15,PSCBUPT(,@08)                                   0442 01113000
         MVC   PSCBCHAR(1,@08),UPTCDEL(@15)                        0442 01114000
*         PSCBLINE=UPTLDEL;       /*PUT LINE DEL CHAR IN PSCB  Y02669*/ 01115000
         MVC   PSCBLINE(1,@08),UPTLDEL(@15)                        0443 01116000
*         IF UPTALD = '1'B        /* IF ATTN INDICATOR IS ON   Y02669*/ 01117000
*           THEN PSCBATTN = '1'B; /* IN UPT, COPY TO PSCB      Y02669*/ 01118000
*                                                                  0444 01119000
         TM    UPTALD(@15),B'00000100'                             0444 01120000
         BNO   @RF00444                                            0444 01121000
         OI    PSCBATTN(@08),B'00001000'                           0445 01122000
*       END;                                                       0446 01123000
*                                                                  0446 01124000
@RF00444 DS    0H                                                  0447 01125000
*   IF EXPUADS = '1'B             /*IF EXPANDED FORMAT UADS    Y02669*/ 01126000
*     THEN                        /* THEN                      Y02669*/ 01127000
@RF00435 TM    EXPUADS,B'00001000'                                 0447 01128000
         BNO   @RF00447                                            0447 01129000
*       DO;                       /* READ USER'S               Y02669*/ 01130000
*                                 /* VALID PERFORMANCE GROUPS  Y02669*/ 01131000
*         IF SAVEPERP ^= 0        /* IF PERFORMANCE GROUPS     Y02669*/ 01132000
*                                 /* AUTHORIZED FOR USERID     Y02669*/ 01133000
*           THEN                  /* THEN                      Y02669*/ 01134000
         L     @08,SAVEPERP                                        0449 01135000
         LTR   @08,@08                                             0449 01136000
         BZ    @RF00449                                            0449 01137000
*             DO;                 /*                           Y02669*/ 01138000
*               UADSNDAT=SAVEPERP; /* SET UP FIND INTERFACE TO Y02669*/ 01139000
         ST    @08,UADSNDAT                                        0451 01140000
*                                 /*READ PERFORM GRP FROM UADS Y02669*/ 01141000
*               CALL FIND1;       /* CALL FIND TO READ         Y02669*/ 01142000
         BAL   @14,FIND1                                           0452 01143000
*                                 /* AUTHORIZED PERFORM GROUPS Y02669*/ 01144000
*               UADSPFG1=UADSBUFR->UADSPG; /* MOVE PERFORM     Y02669*/ 01145000
         L     @08,UADSBUFR                                        0453 01146000
         MVC   UADSPFG1(32),UADSPG(@08)                            0453 01147000
*                                 /* GROUP DATA FROM UADS      Y02669*/ 01148000
*                                 /* TO WORK AREA              Y02669*/ 01149000
*             END;                                                 0454 01150000
*         ELSE NOPERFRM='1'B;     /* ELSE INDICATE NO PERFORM  Y02669*/ 01151000
         B     @RC00449                                            0455 01152000
@RF00449 OI    NOPERFRM,B'00010000'                                0455 01153000
*                                 /* GROUP IS VALID FOR USERID Y02669*/ 01154000
*       END;                      /*                           Y02669*/ 01155000
*                                                                  0456 01156000
*   ELSE                          /* IF PRE-VS2/2 UADS FORMAT  Y02669*/ 01157000
*     DO;                         /* PROVIDE DEFAULTS FOR DEST Y02669*/ 01158000
         B     @RC00447                                            0457 01159000
@RF00447 DS    0H                                                  0458 01160000
*                                 /* AND PERFORM GROUPS        Y02669*/ 01161000
*       IF LWADEST = '0'B         /* IF INSTALLATION DID NOT   Y02669*/ 01162000
*                                 /* SUPPLY DEST FIELD         Y02669*/ 01163000
*         THEN                    /* THEN SUPPLY DEFAULT DEST  Y02669*/ 01164000
         L     @08,LWAPTR                                          0458 01165000
         TM    LWADEST(@08),B'00000100'                            0458 01166000
         BNZ   @RF00458                                            0458 01167000
*           LWADEST2='0000000000000000'X;                   /* Y02669*/ 01168000
         MVC   LWADEST2(8,@08),@CB02921                            0459 01169000
*       NOPERFRM='1'B;            /* INDICATE NO PERFORMANCE   Y02669*/ 01170000
@RF00458 OI    NOPERFRM,B'00010000'                                0460 01171000
*                                 /* GROUPS ARE VALID          Y02669*/ 01172000
*       IF LWABUPT = '0'B         /* IF INSTALLATION DID NOT   Y02669*/ 01173000
*                                 /* SUPPLY UPT                Y02669*/ 01174000
*         THEN                    /* THEN                      Y02669*/ 01175000
         L     @08,LWAPTR                                          0461 01176000
         TM    LWABUPT(@08),B'00010000'                            0461 01177000
         BNZ   @RF00461                                            0461 01178000
*           DO;                   /*                           Y02669*/ 01179000
*             UPTPREFX=PSCBUSER;  /*INITIALIZE DSNAME PREFIX   Y02669*/ 01180000
         L     @08,LWAPSCB(,@08)                                   0463 01181000
         L     @15,PSCBUPT(,@08)                                   0463 01182000
         MVC   UPTPREFX(7,@15),PSCBUSER(@08)                       0463 01183000
*                                 /*FIELD IN UPT TO 'USERID'   Y02669*/ 01184000
*             UPTPREFL=PSCBUSRL;  /*INITIALIZE DSNAME PREFIX   Y02669*/ 01185000
         IC    @14,PSCBUSRL(,@08)                                  0464 01186000
         STC   @14,UPTPREFL(,@15)                                  0464 01187000
*           END;                                                   0465 01188000
*     END;                                                         0466 01189000
@RF00461 DS    0H                                                  0467 01190000
*/********************************************************************/ 01191000
*/*                                                                  */ 01192000
*/*SEGMENT-                                                          */ 01193000
*/*          FNDPSWD                                                 */ 01194000
*/*                                                                  */ 01195000
*/*FUNCTION-                                                         */ 01196000
*/*          INTERFACE WITH RACF THEN CHECK PASSWORD                 */ 01197000
*/*                                                                  */ 01198000
*/********************************************************************/ 01199000
*                                                                  0467 01200000
*   IF LWPOIDCD = YES &           /* IF IODCARD KEYWORD AND  @G32OPKU*/ 01201000
*               CVTRAC ^= ZERO &  /* RACF AND                @G32OPKU*/ 01202000
*               RCVTRID0 ^= ZERO  /* OIDCD VERIFY RTN IS     @G32OPKU*/ 01203000
*     THEN DO;                    /* PRESENT                 @G32OPKU*/ 01204000
@RC00447 L     @08,LWPPTR                                          0467 01205000
         TM    LWPOIDCD(@08),B'00010000'                           0467 01206000
         BNO   @RF00467                                            0467 01207000
         SLR   @08,@08                                             0467 01208000
         L     @01,CVTPTR                                          0467 01209000
         L     @15,CVTRAC(,@01)                                    0467 01210000
         CR    @15,@08                                             0467 01211000
         BE    @RF00467                                            0467 01212000
         C     @08,RCVTRID0(,@15)                                  0467 01213000
         BE    @RF00467                                            0467 01214000
*       PMSGNM = MSG56437;        /* ENTER OIDCARD MESSAGE   @G32OPKU*/ 01215000
         MVC   PMSGNM(2),@CH00385                                  0469 01216000
*       CALL OIDVERFY;            /* PROMPT FOR OIDCARD      @G32OPKU*/ 01217000
         BAL   @14,OIDVERFY                                        0470 01218000
*       END;                      /*                         @G32OPKU*/ 01219000
*   CALL RACVERFY;                /* INTERFACE WITH RACF     @Z40RQKC*/ 01220000
*                                                                  0472 01221000
@RF00467 BAL   @14,RACVERFY                                        0472 01222000
*   UADSSAVE = UADSNSUB;          /* SAVE OFFSET TO FIRST PROC OFFSET   01223000
*                                    BLOCK                           */ 01224000
         L     @08,UADSNSUB                                        0473 01225000
         LR    UADSSAVE,@08                                        0473 01226000
*   UADSNNEX = UADSNSUB;          /* SET UP OFFSET IMAGE TO FIND FIRST  01227000
*                                    PASSWORD OFFSET AND DATA FIELDS */ 01228000
         ST    @08,@TF00001                                        0474 01229000
         MVC   UADSNNEX(3),@TF00001+1                              0474 01230000
*   CALL FIND;                    /* GET FIRST PASSWORD OFFSET AND 0475 01231000
*                                    DATA BLOCKS                     */ 01232000
         BAL   @14,FIND                                            0475 01233000
*   IF LWARACF = YES              /* RACF USER               @Z40RQKC*/ 01234000
*     THEN GO TO RCDPSWD;         /* PSWD ALREADY CHECKED    @Z40RQKC*/ 01235000
*                                                                  0476 01236000
         L     @08,LWAPTR                                          0476 01237000
         TM    LWARACF(@08),B'01000000'                            0476 01238000
         BO    @RT00476                                            0476 01239000
*   PMSGNM = 0;                   /* INDICATE PARAMETER NOT SUPPLIED.*/ 01240000
         SLR   @08,@08                                             0478 01241000
         STH   @08,PMSGNM                                          0478 01242000
*   PRMTSWC =  2 ;                                                 0479 01243000
*                                                                  0479 01244000
*                                                                  0479 01245000
         MVC   PRMTSWC(2),@CH00135                                 0479 01246000
*   IF UADSNDAT = 0               /* IF PASSWORD NOT SUPPORTED IN  0480 01247000
*                                   UADS, RECORD SUPPLIED PSWD     0480 01248000
*                                   INTO TSB.                  Y02669*/ 01249000
*     THEN                                                         0480 01250000
         C     @08,UADSNDAT                                        0480 01251000
         BE    @RT00480                                            0480 01252000
*       GO TO RCDPSWD;                                       /*Y02669*/ 01253000
*                                                                  0481 01254000
*                                                                  0481 01255000
*   IF LWPPSWDL = 0               /* IF PASSWORD NOT SUPPLIED, GOTO     01256000
*                                    PROMPT USER FOR A NEW ONE.      */ 01257000
*     THEN                                                         0482 01258000
         L     @04,LWPPTR                                          0482 01259000
         CH    @08,LWPPSWDL(,@04)                                  0482 01260000
         BE    @RT00482                                            0482 01261000
*       GOTO PRMTPSWD;                                             0483 01262000
*                                                                  0483 01263000
*CKPSWD:                                                           0484 01264000
*                                                                  0484 01265000
*                                                                  0484 01266000
*   IF LWPPSWD = UADSPPWD         /* IF PASSWORD AUTHORIZED  @Z40NQKC   01267000
*                                    THEN GO TO RECORD IT INTO THE 0484 01268000
*                                    TSB                       Y02669*/ 01269000
*     THEN                                                         0484 01270000
CKPSWD   L     @08,LWPPTR                                          0484 01271000
         L     @04,UADSBUFR                                        0484 01272000
         CLC   LWPPSWD(8,@08),UADSPPWD(@04)                        0484 01273000
         BE    @RT00484                                            0484 01274000
*       GOTO RCDPSWD;                                              0485 01275000
*                                                                  0485 01276000
*                                                                  0485 01277000
*   IF UADSNFLG ^= '1'B           /* IF MORE PASSWORDS ON THE CHAIN     01278000
*                                    FIND NEXT PASSWORD AUTHORIZED TO   01279000
*                                    THIS USER.                      */ 01280000
*     THEN                                                         0486 01281000
         TM    UADSNFLG,B'10000000'                                0486 01282000
         BO    @RF00486                                            0486 01283000
*       DO;                                                        0487 01284000
*FNDPSWD1:                                                         0488 01285000
*         CALL FIND;              /* GET NEXT PASSWORD OFFSET AND DATA  01286000
*                                    DATA BLOCKS.                    */ 01287000
FNDPSWD1 BAL   @14,FIND                                            0488 01288000
*         GOTO CKPSWD;            /* GO TO CHECK VALIDITY OF       0489 01289000
*                                    PASSWORD THAT HAS BEEN SUPPLIED.*/ 01290000
         B     CKPSWD                                              0489 01291000
*       END;                                                       0490 01292000
*                                                                  0490 01293000
*                                                                  0490 01294000
*   PMSGNM = 8;                   /* INDICATE PSWD NOT AUTHORIZED  0491 01295000
*                                    MESSAGE TO BE LISTED.           */ 01296000
*                                                                  0491 01297000
@RF00486 MVC   PMSGNM(2),@CH00046                                  0491 01298000
*PRMTPSWD:                                                         0492 01299000
*                                                                  0492 01300000
*                                                                  0492 01301000
*   CALL PROMPT;                  /* PROMPT FOR NEW PASSWORD.        */ 01302000
PRMTPSWD BAL   @14,PROMPT                                          0492 01303000
*   UADSNNEX = UADSSAVE;          /* SET PASSWORD OFFSET USED BY FIND   01304000
*                                    ROUTINE BACK TO OFFSET OF FIRST    01305000
*                                    PASSWORD OFFSET BLOCK FOR THIS     01306000
*                                    CHAIN (IN UADS).                */ 01307000
         ST    UADSSAVE,@TF00001                                   0493 01308000
         MVC   UADSNNEX(3),@TF00001+1                              0493 01309000
*   GOTO FNDPSWD1;                /* BRANCH TO RESTART PASSWORD    0494 01310000
*                                    CHECKING.                       */ 01311000
*                                                                  0494 01312000
         B     FNDPSWD1                                            0494 01313000
*RCDPSWD:                                                          0495 01314000
*                                                                  0495 01315000
*  CALL SETLOCK;                  /* OBTAIN CMS LOCK         @G32OPKU*/ 01316000
*                                                                  0495 01317000
RCDPSWD  BAL   @14,SETLOCK                                         0495 01318000
*  IF LWPNPSWL ^= ZERO &          /* IF NEW PASSWORD         @G32OPKU*/ 01319000
*     LWARACF = YES               /* AND RACF HAS OK'ED IT   @G32OPKU*/ 01320000
*    THEN                         /*                         @G32OPKU*/ 01321000
         L     @08,LWPPTR                                          0496 01322000
         LH    @15,LWPNPSWL(,@08)                                  0496 01323000
         LTR   @15,@15                                             0496 01324000
         BZ    @RF00496                                            0496 01325000
         L     @01,LWAPTR                                          0496 01326000
         TM    LWARACF(@01),B'01000000'                            0496 01327000
         BNO   @RF00496                                            0496 01328000
*      TSBPSWD=LWPNPSWD;          /* MOVE PASSWORD TO TSB    @Z40NQKC*/ 01329000
         L     @01,TSBPTR                                          0497 01330000
         MVC   TSBPSWD(8,@01),LWPNPSWD(@08)                        0497 01331000
*    ELSE                         /* OTHERWISE SET           @G32OPKU*/ 01332000
*      TSBPSWD = LWPPSWD;         /* PASSWORD IN TSB         @G32OPKU*/ 01333000
*                                                                  0498 01334000
         B     @RC00496                                            0498 01335000
@RF00496 L     @08,TSBPTR                                          0498 01336000
         L     @01,LWPPTR                                          0498 01337000
         MVC   TSBPSWD(8,@08),LWPPSWD(@01)                         0498 01338000
*  CALL RELLOCK;                  /* RELEASE CMS/LOCAL LOCKS @G32OPKU*/ 01339000
*                                                                  0499 01340000
@RC00496 BAL   @14,RELLOCK                                         0499 01341000
*  IF LWPNPSWL ^= ZERO &             /* NEW PASSWORD ENTERED @Z40RQKC*/ 01342000
*     LWARACF = NO                   /* NON RACF USER        @Z40RQKC*/ 01343000
*    THEN DO;                                                      0500 01344000
         SLR   @08,@08                                             0500 01345000
         L     @01,LWPPTR                                          0500 01346000
         CH    @08,LWPNPSWL(,@01)                                  0500 01347000
         BE    @RF00500                                            0500 01348000
         L     @01,LWAPTR                                          0500 01349000
         TM    LWARACF(@01),B'01000000'                            0500 01350000
         BNZ   @RF00500                                            0500 01351000
*      IF CVTRAC = ZERO           /* RACF NOT IN SYSTEM      @Z40RQKC*/ 01352000
*        THEN PMSGNM = MSG56426;  /* UNSUPPORTED-KEYWORD MSG @Z40RQKC*/ 01353000
         L     @01,CVTPTR                                          0502 01354000
         C     @08,CVTRAC(,@01)                                    0502 01355000
         BNE   @RF00502                                            0502 01356000
         MVC   PMSGNM(2),@CH00786                                  0503 01357000
*        ELSE PMSGNM = MSG56419;  /* UNAUTHORIZED-USER MSG   @Z40RQKC*/ 01358000
*                                                                  0504 01359000
         B     @RC00502                                            0504 01360000
@RF00502 MVC   PMSGNM(2),@CH00925                                  0504 01361000
*     TEXTINT1(1) = ADDR(INSNPSWD);  /* NEW-PSWD INSERT      @Z40RQKC*/ 01362000
*                                                                  0505 01363000
@RC00502 LA    @08,INSNPSWD                                        0505 01364000
         ST    @08,TEXTINT1                                        0505 01365000
*     CALL LGM;                      /* SEND MESSAGE         @Z40RQKC*/ 01366000
*                                                                  0506 01367000
         BAL   @14,LGM                                             0506 01368000
*     LWPNPSWL = ZERO;               /* INDICATE NO NEW-PSWD @Z40RQKC*/ 01369000
         L     @08,LWPPTR                                          0507 01370000
         SLR   @15,@15                                             0507 01371000
         STH   @15,LWPNPSWL(,@08)                                  0507 01372000
*     END;                                                         0508 01373000
*                                                                  0508 01374000
*   IF (ROIDLEN ^= 0 |               /* OIDCARD ENTERED  AND @G32OPKU*/ 01375000
*       LWPOIDCD = YES) &            /*                      @G32OPKU*/ 01376000
*              LWARACF = NO          /* NON RACF USER        @G32OPKU*/ 01377000
*     THEN DO;                       /*                      @G32OPKU*/ 01378000
@RF00500 CLI   ROIDLEN,0                                           0509 01379000
         BNE   @GL00007                                            0509 01380000
         L     @08,LWPPTR                                          0509 01381000
         TM    LWPOIDCD(@08),B'00010000'                           0509 01382000
         BNO   @RF00509                                            0509 01383000
@GL00007 L     @08,LWAPTR                                          0509 01384000
         TM    LWARACF(@08),B'01000000'                            0509 01385000
         BNZ   @RF00509                                            0509 01386000
*       IF CVTRAC = ZERO             /* RACF NOT IN SYSTEM   @G32OPKU*/ 01387000
*         THEN                                                     0511 01388000
         L     @08,CVTPTR                                          0511 01389000
         L     @08,CVTRAC(,@08)                                    0511 01390000
         LTR   @08,@08                                             0511 01391000
         BNZ   @RF00511                                            0511 01392000
*           PMSGNM = MSG56426;       /* UNSUPPORTED KEYWORD  @G32OPKU*/ 01393000
         MVC   PMSGNM(2),@CH00786                                  0512 01394000
*         ELSE                                                     0513 01395000
*           PMSGNM = MSG56419;       /* UNAUTHORIZED USER MSG@G32OPKU*/ 01396000
         B     @RC00511                                            0513 01397000
@RF00511 MVC   PMSGNM(2),@CH00925                                  0513 01398000
*       TEXTINT1(1) = ADDR(INSOIDCD);/* SET OIDCARD INSERT   @G32OPKU*/ 01399000
*                                                                  0514 01400000
@RC00511 LA    @08,INSOIDCD                                        0514 01401000
         ST    @08,TEXTINT1                                        0514 01402000
*       CALL LGM;                    /* PUT OUT MSG          @G32OPKU*/ 01403000
         BAL   @14,LGM                                             0515 01404000
*       ROIDLEN = ZERO;              /* INDICATE NO OIDCARD  @G32OPKU*/ 01405000
         MVI   ROIDLEN,X'00'                                       0516 01406000
*       END;                                                       0517 01407000
*FNDACCT:                                                          0518 01408000
*                                                                  0518 01409000
*   /*****************************************************************/ 01410000
*   /*       CHECK ACCOUNT NUMBER                                    */ 01411000
*   /*****************************************************************/ 01412000
*                                                                  0518 01413000
*   UADSACCT = UADSNSUB;                                           0518 01414000
@RF00509 DS    0H                                                  0518 01415000
FNDACCT  L     @08,UADSNSUB                                        0518 01416000
         ST    @08,UADSACCT                                        0518 01417000
*   UADSNNEX = UADSACCT;          /* INITIALIZE OFFSET BLOCK IMAGE TO   01418000
*                                    CHECK ACCOUNT NUMBER IN UADS    */ 01419000
*                                                                  0519 01420000
         ST    @08,@TF00001                                        0519 01421000
         MVC   UADSNNEX(3),@TF00001+1                              0519 01422000
*KEYWORD:                                                          0520 01423000
*                                                                  0520 01424000
*   CALL FIND;                    /* FIND FIRST ACCOUNT NUMBER OFFSET   01425000
*                                    AND DATA BLOCKS.                */ 01426000
KEYWORD  BAL   @14,FIND                                            0520 01427000
*   PMSGNM = 0;                   /* INDICATE PARAMETER NOT SUPPLIED.*/ 01428000
         SLR   @08,@08                                             0521 01429000
         STH   @08,PMSGNM                                          0521 01430000
*   TEXTINT1(1) = ADDR(LWPACCTI); /* GET ADDR OF ACCT#       @Z40NQKC   01431000
*                                    TEXT INSERTION BUFFER.          */ 01432000
         L     @15,LWPPTR                                          0522 01433000
         LA    @14,LWPACCTI(,@15)                                  0522 01434000
         ST    @14,TEXTINT1                                        0522 01435000
*   PRMTSWC =  3 ;                /* INDICATE PROMPT IS FOR        0523 01436000
*                                    ACCOUNT NUMBER                  */ 01437000
         MVC   PRMTSWC(2),@CH00087                                 0523 01438000
*   RESPECIFY (LENSTR) RSTD;                                       0524 01439000
*   LENSTR = LWPACCTL;            /* ACCT# LENGTH            @Z40NQKC*/ 01440000
*                                                                  0525 01441000
         LH    LENSTR,LWPACCTL(,@15)                               0525 01442000
*   IF UADSNDAT = 0               /* IF ACCOUNT NUMBERS ARE NOT    0526 01443000
*                                    SUPPORTED IN UADS, GOTO CHECK 0526 01444000
*                                    PROC NAME.                      */ 01445000
*     THEN                                                         0526 01446000
         C     @08,UADSNDAT                                        0526 01447000
         BE    @RT00526                                            0526 01448000
*       GOTO FNDPROC;                                              0527 01449000
*                                                                  0527 01450000
*   IF LENSTR = 0                 /* IF ACCOUNT NUMBER NOT SUPPLIED,    01451000
*                                    CHECK FOR DEFAULT ACCOUNT NUMBER*/ 01452000
*     THEN                                                         0528 01453000
         CR    LENSTR,@08                                          0528 01454000
         BE    @RT00528                                            0528 01455000
*       GOTO ACCTEND;                                              0529 01456000
*                                                                  0529 01457000
*CKACCT:                                                           0530 01458000
*   IF LENSTR = UADSALEN          /* CHECK IF ACCOUNT NUMBER         */ 01459000
*     THEN                        /* IS SAME AS UADS ACCOUNT         */ 01460000
CKACCT   L     @08,UADSBUFR                                        0530 01461000
         MVC   @ZT00003+3(1),UADSALEN(@08)                         0530 01462000
         C     LENSTR,@ZT00003                                     0530 01463000
         BNE   @RF00530                                            0530 01464000
*       IF LWPACCT(1:LENSTR) = UADSANUM(1:LENSTR)          /*@Z40NQKC*/ 01465000
*         THEN                                                     0531 01466000
         LR    @05,LENSTR                                          0531 01467000
         BCTR  @05,0                                               0531 01468000
         L     @01,LWPPTR                                          0531 01469000
         EX    @05,@SC03258                                        0531 01470000
         BNE   @RF00531                                            0531 01471000
*           DO;                                                    0532 01472000
*             LWATCPU=TOTLCPU;    /*PUT CUMULATIVE CPU TIME    Y02669*/ 01473000
         L     @05,LWAPTR                                          0533 01474000
         L     @15,TOTLCPU(,@08)                                   0533 01475000
         ST    @15,LWATCPU(,@05)                                   0533 01476000
*             LWATCPU1=TOTLCPU1;  /*IN LWA                     Y02669*/ 01477000
         L     @15,TOTLCPU1(,@08)                                  0534 01478000
         ST    @15,LWATCPU1(,@05)                                  0534 01479000
*             LWATCON=TOTLCON;    /*PUT CUMULATIVE CONNECT     Y02669*/ 01480000
         L     @15,TOTLCON(,@08)                                   0535 01481000
         ST    @15,LWATCON(,@05)                                   0535 01482000
*             LWATCON1=TOTLCON1;  /*TIME IN LWA                Y02669*/ 01483000
         L     @15,TOTLCON1(,@08)                                  0536 01484000
         ST    @15,LWATCON1(,@05)                                  0536 01485000
*             LWATSRU=TOTLSU;     /*PUT CUMULATIVE SERVICE     Y02669*/ 01486000
         L     @15,TOTLSU(,@08)                                    0537 01487000
         ST    @15,LWATSRU(,@05)                                   0537 01488000
*             LWATSRU1=TOTLSU1;   /*UNITS IN LWA               Y02669*/ 01489000
         L     @08,TOTLSU1(,@08)                                   0538 01490000
         ST    @08,LWATSRU1(,@05)                                  0538 01491000
*             GOTO FNDPROC;                                        0539 01492000
         B     FNDPROC                                             0539 01493000
*           END;                                                   0540 01494000
*                                                                  0540 01495000
*   IF UADSNFLG ^= '1'B |         /* IF MORE ACCOUNT NUMBERS ON    0541 01496000
*                                    ACCOUNT CHAIN, FIND NEXT ONE.   */ 01497000
*      (LWARACF = YES &           /* FOR RACF ALL ACCT#S     @Z40RQKC*/ 01498000
*       UADSNNEX > 0)             /* ARE VALID               @Z40RQKC*/ 01499000
*     THEN                                                         0541 01500000
@RF00531 DS    0H                                                  0541 01501000
@RF00530 TM    UADSNFLG,B'10000000'                                0541 01502000
         BNO   @RT00541                                            0541 01503000
         L     @08,LWAPTR                                          0541 01504000
         TM    LWARACF(@08),B'01000000'                            0541 01505000
         BNO   @RF00541                                            0541 01506000
         L     @08,UADSNNEX-1                                      0541 01507000
         LA    @08,0(,@08)                                         0541 01508000
         LTR   @08,@08                                             0541 01509000
         BNP   @RF00541                                            0541 01510000
@RT00541 DS    0H                                                  0542 01511000
*       DO;                                                        0542 01512000
*FNDACCT1:                                                         0543 01513000
*         CALL FIND;              /* FIND NEXT ACCOUNT OFFSET AND  0543 01514000
*                                    DATA BLOCKS.                    */ 01515000
FNDACCT1 BAL   @14,FIND                                            0543 01516000
*         GOTO CKACCT;            /* GO TO CHECK VALIDITY OF SUPPLIED   01517000
*                                    ACCOUNT NUMBER.                 */ 01518000
         B     CKACCT                                              0544 01519000
*       END;                                                       0545 01520000
*                                                                  0545 01521000
*   PMSGNM = 9;                   /* INDICATE ACCTNUM NOT AUTHORIZED    01522000
*                                    MESSAGE TO BE LISTED.           */ 01523000
*                                                                  0546 01524000
@RF00541 MVC   PMSGNM(2),@CH00036                                  0546 01525000
*PRMTACCT:                                                         0547 01526000
*                                                                  0547 01527000
*                                                                  0547 01528000
*   CALL PROMPT;                  /* PROMPT FOR NEW LOGON PARAMETER  */ 01529000
PRMTACCT BAL   @14,PROMPT                                          0547 01530000
*   UADSNNEX = UADSACCT;          /* SET ACCOUNT OFFSET USED BY FIND    01531000
*                                    ROUTINE BACK TO OFFSET OF FIRST    01532000
*                                    ACCOUNT NUMBER OFFSET BLOCK FOR    01533000
*                                    THIS CHAIN (IN UADS).           */ 01534000
         MVC   UADSNNEX(3),UADSACCT+1                              0548 01535000
*   GOTO KEYWORD;                 /* BRANCH TO RESTART ACCOUNT NUMBER   01536000
*                                    CHECKING.                       */ 01537000
         B     KEYWORD                                             0549 01538000
*   RESPECIFY (LENSTR) UNRSTD;                                     0550 01539000
*                                                                  0550 01540000
*ACCTEND:                                                          0551 01541000
*                                                                  0551 01542000
*                                                                  0551 01543000
*   IF UADSNFLG = '0'B  |         /* IF MORE THAN ONE ACCOUNT NUMBER    01544000
*                                    ON CHAIN, USER MUST BE PROMPTED    01545000
*                                    TO ENTER ONE.           @ZA12418*/ 01546000
*      (LWARACF = YES &             /* FOR RACF ALL ACCT NOS @ZA12418*/ 01547000
*       UADSNNEX  > 0)              /* ARE VALID             @ZA12418*/ 01548000
*     THEN                                                         0551 01549000
ACCTEND  TM    UADSNFLG,B'10000000'                                0551 01550000
         BZ    @RT00551                                            0551 01551000
         L     @08,LWAPTR                                          0551 01552000
         TM    LWARACF(@08),B'01000000'                            0551 01553000
         BNO   @RF00551                                            0551 01554000
         L     @08,UADSNNEX-1                                      0551 01555000
         LA    @08,0(,@08)                                         0551 01556000
         LTR   @08,@08                                             0551 01557000
         BP    @RT00551                                            0551 01558000
*       GOTO PRMTACCT;                                             0552 01559000
*                                                                  0552 01560000
*                                                                  0552 01561000
*   LWPACCTL = UADSALEN;          /* ACCT# LENGTH            @Z40NQKC*/ 01562000
@RF00551 L     @08,LWPPTR                                          0553 01563000
         L     @15,UADSBUFR                                        0553 01564000
         SLR   @14,@14                                             0553 01565000
         IC    @14,UADSALEN(,@15)                                  0553 01566000
         STH   @14,LWPACCTL(,@08)                                  0553 01567000
*   LWPACCT(1:LWPACCTL) = UADSANUM; /* MOVE LEN FROM UADS TO @Z40NQKC   01568000
*                                    THE ACCOUNT BUFFER.             */ 01569000
*                                                                  0554 01570000
         BCTR  @14,0                                               0554 01571000
         EX    @14,@SM03260                                        0554 01572000
*FNDPROC:                                                          0555 01573000
*                                                                  0555 01574000
*   /*****************************************************************/ 01575000
*   /*            CHECK PROCEDURE NAME FIELD IN UADS.                */ 01576000
*   /*****************************************************************/ 01577000
*                                                                  0555 01578000
*   LWAACCT = UADSNDAT;                                            0555 01579000
FNDPROC  L     @08,UADSNDAT                                        0555 01580000
         L     @01,LWAPTR                                          0555 01581000
         ST    @08,LWAACCT(,@01)                                   0555 01582000
*   UADSNNEX = UADSNSUB;          /* PREPARE TO SCAN PROC OFFSET   0556 01583000
*                                    CHAIN                           */ 01584000
         MVC   UADSNNEX(3),UADSNSUB+1                              0556 01585000
*   CALL FIND;                    /* GET FIRST PROC OFFSET AND DATA     01586000
*                                    FIELDS.                         */ 01587000
         BAL   @14,FIND                                            0557 01588000
*   PMSGNM = 0;                   /*INDICATE PARAMETER NOT SUPPLIED. */ 01589000
         SLR   @08,@08                                             0558 01590000
         STH   @08,PMSGNM                                          0558 01591000
*   TEXTINT1(1) = ADDR(LWPPROCI); /* GET ADDR OF PROCNAME    @Z40NQKC   01592000
*                                    TEXT INSERTION BUFFER.          */ 01593000
         L     @15,LWPPTR                                          0559 01594000
         LA    @14,LWPPROCI(,@15)                                  0559 01595000
         ST    @14,TEXTINT1                                        0559 01596000
*   PRMTSWC =  4 ;                /* INDICATE PROMPT FOR PROC NAME   */ 01597000
*                                                                  0560 01598000
*                                                                  0560 01599000
         MVC   PRMTSWC(2),@CH00098                                 0560 01600000
*   IF LWPPROCL = 0               /* NO PROCNAME SUPPLIED    @Z40NQKC   01601000
*                                    GOTO CHECK FOR DEFAULT PROC   0561 01602000
*                                    IN THE UADS.                    */ 01603000
*     THEN                                                         0561 01604000
         CH    @08,LWPPROCL(,@15)                                  0561 01605000
         BE    @RT00561                                            0561 01606000
*       GOTO PROCEND;                                              0562 01607000
*                                                                  0562 01608000
*CKPROC:                                                           0563 01609000
*                                                                  0563 01610000
*                                                                  0563 01611000
*   IF LWPPROC = UADSRNAM         /* PROC IS IN UADS         @Z40NQKC   01612000
*                                    RECORD IT INTO THE CSCB.        */ 01613000
*     THEN                                                         0563 01614000
CKPROC   L     @08,LWPPTR                                          0563 01615000
         L     @01,UADSBUFR                                        0563 01616000
         CLC   LWPPROC(8,@08),UADSRNAM(@01)                        0563 01617000
         BE    @RT00563                                            0563 01618000
*       GOTO RCDPROC;                                              0564 01619000
*                                                                  0564 01620000
*                                                                  0564 01621000
*   IF UADSNFLG = '0'B            /* IF MORE PROCNAMES ON THIS CHAIN,   01622000
*                                    FIND NEXT PROCNAME AUTHORIZED 0565 01623000
*                                    TO USER.                        */ 01624000
*     THEN                                                         0565 01625000
         TM    UADSNFLG,B'10000000'                                0565 01626000
         BNZ   @RF00565                                            0565 01627000
*       DO;                                                        0566 01628000
*FNDPROC1:                                                         0567 01629000
*         CALL FIND;              /* FIND NEXT PROCNAME OFFSET AND 0567 01630000
*                                    DATA BLOCKS.                    */ 01631000
FNDPROC1 BAL   @14,FIND                                            0567 01632000
*         GOTO CKPROC;            /* GOTO CHECK VALIDITY OF PROCNAME */ 01633000
         B     CKPROC                                              0568 01634000
*       END;                                                       0569 01635000
*                                                                  0569 01636000
*   PMSGNM = 10;                  /* SET MESSAGE NUMBER TO PROCEDURE    01637000
*                                    NAME NOT AUTHORIZED MESSAGE     */ 01638000
@RF00565 MVC   PMSGNM(2),@CH00035                                  0570 01639000
*   GOTO PRMTACCT;                /* GO TO PROMPT FOR PROCEDURE      */ 01640000
*                                                                  0571 01641000
         B     PRMTACCT                                            0571 01642000
*PROCEND:                                                          0572 01643000
*                                                                  0572 01644000
*                                                                  0572 01645000
*   IF UADSNFLG = '0'B            /* IF MORE THAN ONE PROC,        0572 01646000
*                                    EITHER TERMINATE OR PROMPT.     */ 01647000
*     THEN                                                         0572 01648000
PROCEND  TM    UADSNFLG,B'10000000'                                0572 01649000
         BZ    @RT00572                                            0572 01650000
*       GOTO PRMTACCT;                                             0573 01651000
*                                                                  0573 01652000
*                                                                  0573 01653000
*   LWPPROC = UADSRNAM;           /* SAVE DEFAULT PROCNAME   @Z40NQKC   01654000
*                                    IN PROCEDURE BUFFER             */ 01655000
*                                                                  0574 01656000
         L     @08,LWPPTR                                          0574 01657000
         L     @01,UADSBUFR                                        0574 01658000
         MVC   LWPPROC(8,@08),UADSRNAM(@01)                        0574 01659000
*   /*****************************************************************/ 01660000
*   /*       DETERMINE LENGTH OF PROCNAME IN CHARACTERS              */ 01661000
*   /*****************************************************************/ 01662000
*                                                                  0575 01663000
*   DO SCANINDX = 2 TO 8 BY 1;                                     0575 01664000
         LA    SCANINDX,2                                          0575 01665000
@DL00575 DS    0H                                                  0576 01666000
*     IF LWPPROC(SCANINDX) = ' '                           /*@Z40NQKC*/ 01667000
*       THEN                                                       0576 01668000
         L     @08,LWPPTR                                          0576 01669000
         ALR   @08,SCANINDX                                        0576 01670000
         CLI   LWPPROC-1(@08),C' '                                 0576 01671000
         BE    @RT00576                                            0576 01672000
*         GOTO RCDPROCL;                                           0577 01673000
*   END;                                                           0578 01674000
*                                                                  0578 01675000
         AL    SCANINDX,@CF00037                                   0578 01676000
         C     SCANINDX,@CF00046                                   0578 01677000
         BNH   @DL00575                                            0578 01678000
*RCDPROCL:                                                         0579 01679000
*                                                                  0579 01680000
*   LWPPROCL = SCANINDX - 1;                               /*@Z40NQKC*/ 01681000
RCDPROCL L     @08,LWPPTR                                          0579 01682000
         LR    @03,SCANINDX                                        0579 01683000
         BCTR  @03,0                                               0579 01684000
         STH   @03,LWPPROCL(,@08)                                  0579 01685000
*   LWPPROCM = LWPPROCL + 4;                               /*@Z40NQKC*/ 01686000
*                                                                  0580 01687000
         AL    @03,@CF00098                                        0580 01688000
         STH   @03,LWPPROCM(,@08)                                  0580 01689000
*RCDPROC:                                                          0581 01690000
*                                                                  0581 01691000
*                                                                  0581 01692000
*   CHCLS = UADSRNAM;             /* RECORD PROC NAME IN CSCB        */ 01693000
*                                                                  0581 01694000
*                                                                  0581 01695000
RCDPROC  L     @08,LWAPTR                                          0581 01696000
         L     @01,LWAJSEL(,@08)                                   0581 01697000
         L     @01,JSELCSCB(,@01)                                  0581 01698000
         L     @15,UADSBUFR                                        0581 01699000
         MVC   CHCLS(8,@01),UADSRNAM(@15)                          0581 01700000
*   IF LWAUNIT = '0'B             /* IF INSTALLATION DIDNOT SUPPLY 0582 01701000
*                                    UNIT TYPE, RECORD FROM UADS.    */ 01702000
*     THEN                                                         0582 01703000
         TM    LWAUNIT(@08),B'00100000'                            0582 01704000
         BNZ   @RF00582                                            0582 01705000
*       PSCBGPNM = UADSUNAM;      /* MOVE UNIT TYPE TO PSCB          */ 01706000
*                                                                  0583 01707000
         L     @08,LWAPSCB(,@08)                                   0583 01708000
         MVC   PSCBGPNM(8,@08),UADSUNAM(@15)                       0583 01709000
*FNDRGN:                                                           0584 01710000
*                                                                  0584 01711000
*   /*****************************************************************/ 01712000
*   /*            CHECK VALIDITY OF REGION SIZE                      */ 01713000
*   /*****************************************************************/ 01714000
*                                                                  0584 01715000
*   RESPECIFY (REGION) RSTD;                                       0584 01716000
@RF00582 DS    0H                                                  0584 01717000
FNDRGN   DS    0H                                                  0585 01718000
*   REGION = MAXCORE;             /* GET MAXIMUM ALLOWABLE REGION  0585 01719000
*                                    SIZE                            */ 01720000
         LH    REGION,MAXCORE                                      0585 01721000
*   SCANINDX = 2;                 /* SET TEXT POINTER TO FIRST TEXT     01722000
*                                    BUFFER                          */ 01723000
         LA    SCANINDX,2                                          0586 01724000
*   CALL CNVRGN;                  /* CONVERT TO EBCDIC               */ 01725000
         BAL   @14,CNVRGN                                          0587 01726000
*   RESPECIFY (REGION) UNRSTD;                                     0588 01727000
*   PMSGNM = 11;                  /* INDICATE REGION SIZE EXCEEDS  0589 01728000
*                                    MAXIMUM ALLOWABLE REGION SIZE 0589 01729000
*                                    MESSAGE IS TO BE LISTED.        */ 01730000
         MVC   PMSGNM(2),@CH00033                                  0589 01731000
*   PRMTSWC =  5;                 /* INDICATE THAT PROMPT IS FOR   0590 01732000
*                                    REGION SIZE.                    */ 01733000
*                                                                  0590 01734000
*                                                                  0590 01735000
         MVC   PRMTSWC(2),@CH00209                                 0590 01736000
*   IF LWANOPR = '0'B             /* IF INSTALLATION DID NOT SUPPLY     01737000
*                                    REGION SIZE, CHECK TO SEE IF  0591 01738000
*                                    USER DID.                       */ 01739000
*     THEN                                                         0591 01740000
         L     @08,LWAPTR                                          0591 01741000
         TM    LWANOPR(@08),B'00001000'                            0591 01742000
         BNZ   @RF00591                                            0591 01743000
*       DO;                                                        0592 01744000
*                                                                  0592 01745000
*                                                                  0592 01746000
*         IF LWPREGNX = 0         /* REGION SIZE NOT SUPPLIED@Z40NQKC   01747000
*                                    SIZE, USE REGION SIZE ASSOCIATED   01748000
*                                    WITH PROCNAME IN UADS.          */ 01749000
*           THEN                                                   0593 01750000
         L     @08,LWPPTR                                          0593 01751000
         L     @08,LWPREGNX(,@08)                                  0593 01752000
         LTR   @08,@08                                             0593 01753000
         BZ    @RT00593                                            0593 01754000
*             GOTO UADRGN;                                         0594 01755000
*       END;                                                       0595 01756000
*                                                                  0595 01757000
*CKRGN:                                                            0596 01758000
*                                                                  0596 01759000
*                                                                  0596 01760000
*   IF LWPREGNX <= MAXCORE        /* LARGER THAN THE MAXIMUM @Z40NQKC   01761000
*                                    ALLOWED FOR THIS USER, EITHER 0596 01762000
*                                    PROMPT IF USER SUPPLIED, OR   0596 01763000
*                                    TERMINATE IF INSTALLATION     0596 01764000
*                                    SUPPLIED.                       */ 01765000
*     THEN                                                         0596 01766000
@RF00591 DS    0H                                                  0596 01767000
CKRGN    L     @08,LWPPTR                                          0596 01768000
         L     @08,LWPREGNX(,@08)                                  0596 01769000
         CH    @08,MAXCORE                                         0596 01770000
         BNH   @RT00596                                            0596 01771000
*       GOTO RCDRGN;                                               0597 01772000
*                                                                  0597 01773000
*PRMTRGN:                                                          0598 01774000
*                                                                  0598 01775000
*   /*****************************************************************/ 01776000
*   /*           PROMPT USER FOR A NEW REGION SIZE                   */ 01777000
*   /*****************************************************************/ 01778000
*                                                                  0598 01779000
*   SCANINDX = 1;                                                  0598 01780000
PRMTRGN  LA    SCANINDX,1                                          0598 01781000
*   RESPECIFY (REGION) RSTD;                                       0599 01782000
*   REGION = LWPREGNX;            /* COPY REGION SIZE        @Z40NQKC*/ 01783000
         L     @03,LWPPTR                                          0600 01784000
         L     REGION,LWPREGNX(,@03)                               0600 01785000
*   CALL CNVRGN;                                                   0601 01786000
         BAL   @14,CNVRGN                                          0601 01787000
*   RESPECIFY (REGION) UNRSTD;                                     0602 01788000
*   GOTO PRMTACCT;                  /* PROMPT FOR NEW REGION SIZE.   */ 01789000
*                                                                  0603 01790000
         B     PRMTACCT                                            0603 01791000
*UADRGN:                                                           0604 01792000
*                                                                  0604 01793000
*                                                                  0604 01794000
*   LWPREGNX = UADSRSIZ;          /* COPY UADS REGION SIZE   @Z40NQKC*/ 01795000
*                                                                  0604 01796000
UADRGN   L     @08,UADSBUFR                                        0604 01797000
         LH    @08,UADSRSIZ(,@08)                                  0604 01798000
         N     @08,@CF03257                                        0604 01799000
         L     @01,LWPPTR                                          0604 01800000
         ST    @08,LWPREGNX(,@01)                                  0604 01801000
*RCDRGN:                                                           0605 01802000
*                                                                  0605 01803000
*                                                                  0605 01804000
*   PSCBRSZ = (LWPREGNX + 1)/2;   /* REGION IN PSCB MUST BE  @Z40NQKC   01805000
*                                    NUMBER OF 2K BLOCKS OF CORE   0605 01806000
*                                    NEEDED.                         */ 01807000
RCDRGN   L     @08,LWAPTR                                          0605 01808000
         L     @08,LWAPSCB(,@08)                                   0605 01809000
         LA    @00,1                                               0605 01810000
         L     @15,LWPPTR                                          0605 01811000
         AL    @00,LWPREGNX(,@15)                                  0605 01812000
         SRDA  @00,32                                              0605 01813000
         D     @00,@CF00135                                        0605 01814000
         ST    @01,PSCBRSZ(,@08)                                   0605 01815000
*CHKPFGRP:                                                   /*Y02669*/ 01816000
*                                                                  0606 01817000
*   /*****************************************************************/ 01818000
*   /*            CHECK VALIDITY OF PERFORMANCE GROUP          Y02669*/ 01819000
*   /*****************************************************************/ 01820000
*                                                                  0606 01821000
*   IF LWPPERFX ^= 0              /*IF PERFORMANCE GROUP     @Z40NQKC*/ 01822000
*                                 /*IS SUPPLIED                Y02669*/ 01823000
*     THEN                                                   /*Y02669*/ 01824000
CHKPFGRP L     @08,LWPPTR                                          0606 01825000
         L     @00,LWPPERFX(,@08)                                  0606 01826000
         LTR   @00,@00                                             0606 01827000
         BZ    @RF00606                                            0606 01828000
*       DO;                                                  /*Y02669*/ 01829000
*         PRMTSWC=6;              /*INDICATE PROMPT IS FOR     Y02669*/ 01830000
         MVC   PRMTSWC(2),@CH00178                                 0608 01831000
*                                 /*PERFORMANCE GROUP          Y02669*/ 01832000
*         IF NOPERFRM='1'B        /*IF USER NOT AUTHORIZED     Y02669*/ 01833000
*                                 /*TO USE PERFORMANCE GROUPS  Y02669*/ 01834000
*           THEN                  /*THEN                       Y02669*/ 01835000
         TM    NOPERFRM,B'00010000'                                0609 01836000
         BNO   @RF00609                                            0609 01837000
*             DO;                                            /*Y02669*/ 01838000
*               IF LWANOPR='1'B   /*IF INSTALLATION SUPPLIED   Y02669*/ 01839000
*                 THEN            /*PERFORM GROUP, TERMINATE   Y02669*/ 01840000
         L     @15,LWAPTR                                          0611 01841000
         TM    LWANOPR(@15),B'00001000'                            0611 01842000
         BO    @RT00611                                            0611 01843000
*                   GO TO PROMPTPF;  /*SESSION                 Y02669*/ 01844000
*                                                                  0612 01845000
*               ELSE              /*ELSE WAS SUPPLIED ON       Y02669*/ 01846000
*                 DO;             /*LOGON COMMAND              Y02669*/ 01847000
*                   PMSGNM=44;    /*SET MSG NUMBER TO          Y02669*/ 01848000
         MVC   PMSGNM(2),@CH00175                                  0614 01849000
*                                 /*'PERFORM GROUP NOT         Y02669*/ 01850000
*                                 /*AUTHORIZED FOR USERID' MSG Y02669*/ 01851000
*                   TEXTINT1(1)=ADDR(LWPUSERI);   /*SET PTR  @Z40RQKC*/ 01852000
         LA    @08,LWPUSERI(,@08)                                  0615 01853000
         ST    @08,TEXTINT1                                        0615 01854000
*                                 /*TO TEXT INSERT FOR USERID  Y02669*/ 01855000
*                   CALL LGM;     /*PUT OUT 'NOT AUTHORIZED'   Y02669*/ 01856000
         BAL   @14,LGM                                             0616 01857000
*                                 /*MESSAGE                    Y02669*/ 01858000
*                   LWPPERFX=0;   /*NO PERFM GRP TO BE USED  @Z40NQKC*/ 01859000
         L     @08,LWPPTR                                          0617 01860000
         SLR   @00,@00                                             0617 01861000
         ST    @00,LWPPERFX(,@08)                                  0617 01862000
*                   GO TO BUILDJCL;/* VERIFY GROUP           @Z40RQKC*/ 01863000
         B     BUILDJCL                                            0618 01864000
*                 END;                                       /*Y02669*/ 01865000
*             END;                                           /*Y02669*/ 01866000
*                                                                  0620 01867000
*         /*IF A PERFORMANCE GROUP IS VALID FOR THE USER,      Y02669*/ 01868000
*         /* CHECK TO SEE IF THE PERFORM GROUP HE ENTERED IS   Y02669*/ 01869000
*         /* VALID FOR HIM.  IN THE UADS, A 256-BIT FIELD IS   Y02669*/ 01870000
*         /* USED TO DESIGNATE PERFORM GROUP.  IF THE FIRST    Y02669*/ 01871000
*         /* BIT IN THIS FIELD IS ON, THE USER IS AUTHORIZED   Y02669*/ 01872000
*         /* TO USE PERFORM GROUP 1, AND SO ON TO 255.         Y02669*/ 01873000
*                                                                  0621 01874000
*         THEBYTE=((LWPPERFX-1)/8) +1; /*FIND CORRECT BYTE   @Z40NQKC*/ 01875000
@RF00609 LA    @08,1                                               0621 01876000
         L     @15,LWPPTR                                          0621 01877000
         L     @15,LWPPERFX(,@15)                                  0621 01878000
         BCTR  @15,0                                               0621 01879000
         LR    @04,@15                                             0621 01880000
         SRDA  @04,32                                              0621 01881000
         D     @04,@CF00046                                        0621 01882000
         ALR   @05,@08                                             0621 01883000
         LR    THEBYTE,@05                                         0621 01884000
*         THEBIT=((LWPPERFX-1)//8) +1; /*FIND CORRECT BIT    @Z40NQKC*/ 01885000
*                                                                  0622 01886000
         LR    @04,@15                                             0622 01887000
         SRDA  @04,32                                              0622 01888000
         D     @04,@CF00046                                        0622 01889000
         ALR   @04,@08                                             0622 01890000
         LR    THEBIT,@04                                          0622 01891000
*         RESPECIFY (BITPOS,BYTEPOS) RSTD;                   /*Y02669*/ 01892000
*         BITPOS=TMARRAY(THEBIT);/*FIND TM OPERAND TO TEST BIT Y02669*/ 01893000
         SLR   BITPOS,BITPOS                                       0624 01894000
         IC    BITPOS,TMARRAY-1(THEBIT)                            0624 01895000
*         BYTEPOS=ADDR(UADSPFGR(THEBYTE)); /*FIND BYTE TO TEST Y02669*/ 01896000
         LA    BYTEPOS,UADSPFGR-1(THEBYTE)                         0625 01897000
*         GEN REFS(TM)(EX  BITPOS,TM);  /*TEST BIT IN UADS   @Z40RQKC*/ 01898000
         EX  BITPOS,TM                                                  01899000
*         BC(1,UADSPFOK);                                  /*@Z40NQKC*/ 01900000
         BC    1,UADSPFOK                                          0627 01901000
*         RESPECIFY (BITPOS,BYTEPOS) UNRSTD;                       0628 01902000
*                                                                  0628 01903000
*         PMSGNM=45;           /*SET MSG NUMBER TO PRFRM GROUP Y02669*/ 01904000
         MVC   PMSGNM(2),@CH03017                                  0629 01905000
*         RESPECIFY (PRFRMGP) RSTD;                          /*Y02669*/ 01906000
*         PRFRMGP=LWPPERFX;                                /*@Z40NQKC*/ 01907000
         L     @15,LWPPTR                                          0631 01908000
         L     PRFRMGP,LWPPERFX(,@15)                              0631 01909000
*         CALL CNVPRFRM;       /*CALL SUBROUTINE TO CONVERT    Y02669*/ 01910000
         BAL   @14,CNVPRFRM                                        0632 01911000
*                              /*PERFORM GROUP TO EBCDIC -     Y02669*/ 01912000
*                              /*FOR TEXT INSERTION            Y02669*/ 01913000
*         RESPECIFY (PRFRMGP) UNRSTD;                        /*Y02669*/ 01914000
*                                                                  0633 01915000
*         TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*POINT TO TEXT       Y02669*/ 01916000
         LA    @08,TEXTSEGS                                        0634 01917000
         ST    @08,TEXTINT1                                        0634 01918000
*                              /*INSERTION POINTERS            Y02669*/ 01919000
*         TEXTINT1(2)=ADDR(LWPUSERI);                      /*@Z40RQKC*/ 01920000
         L     @08,LWPPTR                                          0635 01921000
         LA    @08,LWPUSERI(,@08)                                  0635 01922000
         ST    @08,TEXTINT1+4                                      0635 01923000
*         GO TO PROMPTPF;      /*PROMPT FOR NEW PERFORM GROUP  Y02669*/ 01924000
*                                                                  0636 01925000
         B     PROMPTPF                                            0636 01926000
*UADSPFOK:                                                         0637 01927000
*                              /*CALL OPTIMIZER TO VALIDATE    Y02669*/ 01928000
*                              /*PERFORMANCE GROUP             Y02669*/ 01929000
*         OPTMZRPM=0;          /*INIT PARM TO OPTIMIZER        Y02669*/ 01930000
UADSPFOK SLR   @08,@08                                             0637 01931000
         ST    @08,OPTMZRPM                                        0637 01932000
*         OPTMZPF=GROUP;       /*PUT PERFORM GROUP TO BE       Y02669*/ 01933000
         L     @08,LWPPTR                                          0638 01934000
         IC    @00,GROUP(,@08)                                     0638 01935000
         STC   @00,OPTMZPF                                         0638 01936000
*                              /*VALIDATED IN PARM             Y02669*/ 01937000
*         RESPECIFY (PARMPTR) RSTD;                          /*Y02669*/ 01938000
*         PARMPTR=OPTMZRPM;    /*INPUT TO OPT IS REG 1         Y02669*/ 01939000
         L     PARMPTR,OPTMZRPM                                    0640 01940000
*         GEN (SYSEVENT VERIFYPG);   /*VERIFY PERFORM GROUP    Y02669*/ 01941000
*                                                                  0641 01942000
         SYSEVENT VERIFYPG                                              01943000
*         OPTMZRPM=PARMPTR;    /*OUTPUT FROM OPT IS REG 1      Y02669*/ 01944000
         ST    PARMPTR,OPTMZRPM                                    0642 01945000
*         RESPECIFY (PARMPTR) UNRSTD;                        /*Y02669*/ 01946000
*         IF OPTMZCD=0         /*IF PERFORM GROUP IS VALID     Y02669*/ 01947000
*           THEN                                             /*Y02669*/ 01948000
         CLI   OPTMZCD,0                                           0644 01949000
         BE    @RT00644                                            0644 01950000
*             GO TO BUILDJCL;                                      0645 01951000
*                              /*ELSE PUT OUT 'PERFORM GROUP   Y02669*/ 01952000
*                              /*NOT DEFINED TO SYSTEM' MSG    Y02669*/ 01953000
*         PMSGNM=46;           /*SET MSG NUMBER TO 'NOT DEF'D' Y02669*/ 01954000
         MVC   PMSGNM(2),@CH03019                                  0646 01955000
*         RESPECIFY (PRFRMGP) RSTD;                          /*Y02669*/ 01956000
*         PRFRMGP=LWPPERFX;                                /*@Z40NQKC*/ 01957000
         L     @01,LWPPTR                                          0648 01958000
         L     PRFRMGP,LWPPERFX(,@01)                              0648 01959000
*         CALL CNVPRFRM;       /*CALL SUBROUTINE TO CONVERT    Y02669*/ 01960000
         BAL   @14,CNVPRFRM                                        0649 01961000
*                              /*PERFORM GROUP TO EBCDIC -     Y02669*/ 01962000
*                              /*FOR TEXT INSERTION            Y02669*/ 01963000
*         RESPECIFY (PRFRMGP) UNRSTD;                        /*Y02669*/ 01964000
*         TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*POINT TO TEXT       Y02669*/ 01965000
         LA    @08,TEXTSEGS                                        0651 01966000
         ST    @08,TEXTINT1                                        0651 01967000
*                              /*INSERTION POINTERS            Y02669*/ 01968000
*                                                                  0652 01969000
*PROMPTPF:                     /*PROMPT FOR NEW PERFORM GROUP  Y02669*/ 01970000
*         LWPPERFX=0;          /*INDICATE NO VALID PERFORM   @Z40NQKC*/ 01971000
PROMPTPF L     @08,LWPPTR                                          0652 01972000
         SLR   @15,@15                                             0652 01973000
         ST    @15,LWPPERFX(,@08)                                  0652 01974000
*                              /*GROUP YET FOR USER            Y02669*/ 01975000
*         CALL PROMPT;         /*PROMPT FOR NEW LOGON PARM     Y02669*/ 01976000
         BAL   @14,PROMPT                                          0653 01977000
*         GO TO CHKPFGRP;      /*BRANCH TO RESTART PERFORM     Y02669*/ 01978000
         B     CHKPFGRP                                            0654 01979000
*                              /*GROUP CHECKING                Y02669*/ 01980000
*       TM:  GEN(TM 0(BYTEPOS),0);                                 0655 01981000
TM       TM 0(BYTEPOS),0                                                01982000
*       END;                                                 /*Y02669*/ 01983000
*/********************************************************************/ 01984000
*/*                                                                  */ 01985000
*/*SEGMENT-                                                          */ 01986000
*/*          BUILDJCL                                                */ 01987000
*/*                                                                  */ 01988000
*/*FUNCTION-                                                         */ 01989000
*/*          IF IKJEFLD DID NOT SUPPLY THE JCL CARDS THEN THEY MUST  */ 01990000
*/*          BE BUILT                                                */ 01991000
*/*                                                                  */ 01992000
*/********************************************************************/ 01993000
*                                                                  0657 01994000
*BUILDJCL:                                                         0657 01995000
*                                                                  0657 01996000
*   IF LWANUAD = NO               /* NO IKJEFLD DATA         @Z40RQKC*/ 01997000
*     THEN CALL VERGROUP;         /* VERIFY GROUP            @Z40RQKC*/ 01998000
*                                                                  0657 01999000
@RF00606 DS    0H                                                  0657 02000000
BUILDJCL L     @08,LWAPTR                                          0657 02001000
         TM    LWANUAD(@08),B'00000100'                            0657 02002000
         BNZ   @RF00657                                            0657 02003000
         BAL   @14,VERGROUP                                        0658 02004000
*   IF LWARACF = NO               /* NON RACF USER           @Z40RQKC*/ 02005000
*     THEN DO;                                                     0659 02006000
@RF00657 L     @08,LWAPTR                                          0659 02007000
         TM    LWARACF(@08),B'01000000'                            0659 02008000
         BNZ   @RF00659                                            0659 02009000
*       DUMMYRAC = YES;           /* DO DUMMY RACINIT        @Z40RQKC*/ 02010000
*                                                                  0661 02011000
         OI    DUMMYRAC,B'00000010'                                0661 02012000
*       CALL RACINIT;             /* DO THE RACINIT          @Z40RQKC*/ 02013000
*                                                                  0662 02014000
         BAL   @14,RACINIT                                         0662 02015000
*       DUMMYRAC = NO;            /* NO MORE DUMMY RACF      @Z40RQKC*/ 02016000
*                                                                  0663 02017000
         NI    DUMMYRAC,B'11111101'                                0663 02018000
*       IF RETCODE ^= ZERO &      /* RACF ERROR              @Z40RQKC*/ 02019000
*          RETCODE ^= NORACF      /* RACF IS ACTIVE          @Z40RQKC*/ 02020000
*         THEN GO TO CLEANUP4;    /* TERMINATE               @Z40RQKC*/ 02021000
         L     @08,RETCODE                                         0664 02022000
         LTR   @08,@08                                             0664 02023000
         BZ    @RF00664                                            0664 02024000
         C     @08,@CF00357                                        0664 02025000
         BNE   @RT00664                                            0664 02026000
*       END;                                                       0666 02027000
*                                                                  0666 02028000
@RF00664 DS    0H                                                  0667 02029000
*   IF LWAJJCL = '0'B             /* IF THE INSTALLATION DID NOT   0667 02030000
*                                    SUPPLY JCL CARD IMAGES, CALL  0667 02031000
*                                    MODULE IKJEFLEA TO BUILD THEM.  */ 02032000
*     THEN                                                         0667 02033000
@RF00659 L     @08,LWAPTR                                          0667 02034000
         TM    LWAJJCL(@08),B'00000010'                            0667 02035000
         BNZ   @RF00667                                            0667 02036000
*       CALL JCLBLD;                                               0668 02037000
*                                                                  0668 02038000
         BAL   @14,JCLBLD                                          0668 02039000
*   IF LWABUPT='1'B &             /*IF INSTALLATION SUPPLIED   Y02669*/ 02040000
*                                 /*UPT TO BE USED AND         Y02669*/ 02041000
*      UPTPREFX(1)='00'X          /*DSNAME PREFIX FIELD WAS    Y02669*/ 02042000
*                                 /*NOT INITIALIZED,           Y02669*/ 02043000
*     THEN                        /*THEN                       Y02669*/ 02044000
@RF00667 L     @08,LWAPTR                                          0669 02045000
         TM    LWABUPT(@08),B'00010000'                            0669 02046000
         BNO   @RF00669                                            0669 02047000
         L     @08,LWAPSCB(,@08)                                   0669 02048000
         L     @15,PSCBUPT(,@08)                                   0669 02049000
         CLI   UPTPREFX(@15),X'00'                                 0669 02050000
         BNE   @RF00669                                            0669 02051000
*       DO;                       /*                           Y02669*/ 02052000
*         UPTPREFX=PSCBUSER;      /*INIT DS NAME TO USERID     Y02669*/ 02053000
         MVC   UPTPREFX(7,@15),PSCBUSER(@08)                       0671 02054000
*         UPTPREFL=PSCBUSRL;      /*INIT LEN TO LEN OF USERID  Y02669*/ 02055000
         IC    @14,PSCBUSRL(,@08)                                  0672 02056000
         STC   @14,UPTPREFL(,@15)                                  0672 02057000
*       END;                      /*                           Y02669*/ 02058000
*   IF LWADEST = '1'B             /* DEST PROVIDED BY INST   @ZA15332*/ 02059000
*     THEN                        /* EXIT ? YES, MOVE IT INTO@ZA15332*/ 02060000
@RF00669 L     @08,LWAPTR                                          0674 02061000
         TM    LWADEST(@08),B'00000100'                            0674 02062000
         BNO   @RF00674                                            0674 02063000
*       PSCBDEST = LWPDEST;       /* THE PSCB                @ZA15332*/ 02064000
         L     @08,LWAPSCB(,@08)                                   0675 02065000
         L     @01,LWPPTR                                          0675 02066000
         MVC   PSCBDEST(8,@08),LWPDEST(@01)                        0675 02067000
*   /*****************************************************************/ 02068000
*   /*       SEND 'LOGON IN PROGRESS' MESSAGE TO TERMINAL USER       */ 02069000
*   /*****************************************************************/ 02070000
*                                                                  0676 02071000
*   TEXTINT1(1) = ADDR(LWPUSERI); /* POINT TO USERID         @Z40NQKC   02072000
*                                    POINTER                         */ 02073000
@RF00674 L     @08,LWPPTR                                          0676 02074000
         LA    @08,LWPUSERI(,@08)                                  0676 02075000
         ST    @08,TEXTINT1                                        0676 02076000
*   TEXTINT1(2) = ADDR(TEXTSEGS(1)); /* SET TIME OF DAY TEXT       0677 02077000
*                                    INSERTION BUFFER ADDRESS        */ 02078000
         LA    @08,TEXTSEGS                                        0677 02079000
         ST    @08,TEXTINT1+4                                      0677 02080000
*   TEXTINT1(3) = ADDR(TEXTSEGS(2)); /* SET MONTH AND YEAR TEXT    0678 02081000
*                                    INSERTION BUFFER ADDRESS        */ 02082000
         LA    @08,TEXTSEGS+24                                     0678 02083000
         ST    @08,TEXTINT1+8                                      0678 02084000
*   CALL IKJEFLPA                 /* BUILD TOD,DATE INSERTS  @Z40RQKC*/ 02085000
*          (TEXTSEGS(1),TEXTSEGS(2));                      /*@Z40RQKC*/ 02086000
         LA    @08,TEXTSEGS                                        0679 02087000
         ST    @08,@AL00001                                        0679 02088000
         LA    @08,TEXTSEGS+24                                     0679 02089000
         ST    @08,@AL00001+4                                      0679 02090000
         L     @15,@CV00274                                        0679 02091000
         LA    @01,@AL00001                                        0679 02092000
         BALR  @14,@15                                             0679 02093000
*   PMSGNM = 27;                  /* SET MESSAGE NUMBER TO LOGON IN     02094000
*                                    PROCESS MESSAGE.                */ 02095000
         MVC   PMSGNM(2),@CH03025                                  0680 02096000
*   CALL LGM;                     /* SEND MESSAGE TO TERMINAL        */ 02097000
         BAL   @14,LGM                                             0681 02098000
*   GOTO CLEANUP;                                                  0682 02099000
*                                                                  0682 02100000
         B     CLEANUP                                             0682 02101000
*/********************************************************************/ 02102000
*/*                                                                  */ 02103000
*/*SEGMENT-                                                          */ 02104000
*/*          CLEANUP4                                                */ 02105000
*/*                                                                  */ 02106000
*/*FUNCTION-                                                         */ 02107000
*/*          CLEANUP FOR ABNORMAL LOGON/LOGOFF TERMINATION           */ 02108000
*/*                                                                  */ 02109000
*/*REASONS-                                                          */ 02110000
*/*          LOGON INSTALLATION EXIT SET LWADISC                     */ 02111000
*/*                                                                  */ 02112000
*/*          CHCECB POSTED                                           */ 02113000
*/*                                                                  */ 02114000
*/*          SERVICE ROUTINE ERROR                                   */ 02115000
*/*                                                                  */ 02116000
*/*          RACINIT ERROR                                           */ 02117000
*/*                                                                  */ 02118000
*/********************************************************************/ 02119000
*                                                                  0683 02120000
*CLEANUP4:                                                         0683 02121000
*                                                                  0683 02122000
*   IF STATUS = RACERROR          /* RACINIT ERROR           @Z40RQKC*/ 02123000
*     THEN CALL HANDLRAC;         /* SEND OUT MESSAGE        @Z40RQKC*/ 02124000
*                                                                  0683 02125000
CLEANUP4 CLC   STATUS(4),@CF00037                                  0683 02126000
         BNE   @RF00683                                            0683 02127000
         BAL   @14,HANDLRAC                                        0684 02128000
*   LWADISC='1'B;                 /* SET DISCONNECT INDICATOR  Y02669*/ 02129000
@RF00683 L     @08,LWAPTR                                          0685 02130000
         OI    LWADISC(@08),B'00010000'                            0685 02131000
*ECBPOSTD:                                                         0686 02132000
*   NOPRMPT = '0'B;               /* MAKE SURE NO-PROMPT BIT IS OFF  */ 02133000
*                                                                  0686 02134000
ECBPOSTD NI    NOPRMPT,B'11011111'                                 0686 02135000
*CLEANUP0:                        /* CLEANUP ENTRY FOR NO-PROMPT   0687 02136000
*                                    PROCESSING                      */ 02137000
*                                                                  0687 02138000
*                                                                  0687 02139000
*   /*****************************************************************/ 02140000
*   /*   IF THE USERID LENGTH FIELD IN THE PSCB IS ZERO,             */ 02141000
*   /*   WE HAVE NOT ENQUEUED ON A USERID AND THEREFORE MUST         */ 02142000
*   /*   NOT TRY TO DEQUEUE FROM THE USERID.                         */ 02143000
*   /*   IF THE LENGTH FIELD IS NONE ZERO, WE HAVE ENQUEUED          */ 02144000
*   /*   ON THE USERID AND THEREFORE MUST DEQUEUE FROM IT.           */ 02145000
*   /*****************************************************************/ 02146000
*                                                                  0687 02147000
*   IF LWARNML  ^= 0 &            /* IF USER LENGTH NON-ZERO,        */ 02148000
*        LWPRECON ^= '1'B         /* AND NOT RECONNECTING    @ZM44318*/ 02149000
*     THEN                        /* THEN                            */ 02150000
CLEANUP0 L     @08,LWAPTR                                          0687 02151000
         CLI   LWARNML(@08),0                                      0687 02152000
         BE    @RF00687                                            0687 02153000
         L     @01,LWPPTR                                          0687 02154000
         TM    LWPRECON(@01),B'10000000'                           0687 02155000
         BO    @RF00687                                            0687 02156000
*       DO; /* DEQ (SYSIKJUA,LWARNM,LWARNML,SYSTEM) RET(HAVE) TCB(LWAST 02157000
*B->LOGONTCB)*/                                                    0688 02158000
*          I048(1:20)=I048(1:20)&&I048(1:20);                      0689 02159000
         XC    I048(20),I048                                       0689 02160000
*          RFY GPR01F RESTRICTED;                                  0690 02161000
*          I04804(1)='10000001'B;     /*LISTEND BYTE*/             0691 02162000
         MVI   I04804,B'10000001'                                  0691 02163000
*          I04805(1)=LWARNML;   /*SET LENGTH*/                     0692 02164000
         IC    @00,LWARNML(,@08)                                   0692 02165000
         STC   @00,I04805                                          0692 02166000
*          I04806(1)='01000001'B;    /*OPTIONS*/                   0693 02167000
         MVI   I04806,B'01000001'                                  0693 02168000
*          I04807(1)=ADDR(SYSIKJUA);   /*QNAME ADDRESS*/           0694 02169000
         LA    @00,SYSIKJUA                                        0694 02170000
         ST    @00,I04807                                          0694 02171000
*          I04808(1)=ADDR(LWARNM);   /*RNAME ADDRESS*/             0695 02172000
         LA    @00,LWARNM(,@08)                                    0695 02173000
         ST    @00,I04808                                          0695 02174000
*          I04801=ADDR(LWASTCB->LOGONTCB);   /*TCB ADDRESS*/       0696 02175000
         L     @08,LWASTCB(,@08)                                   0696 02176000
         ST    @08,I04801                                          0696 02177000
*          GPR01F=ADDR(I04802);                                    0697 02178000
         LA    GPR01F,I04802                                       0697 02179000
*          SVC  (48);                                              0698 02180000
         SVC   48                                                  0698 02181000
*          RFY GPR01F UNRESTRICTED;                                0699 02182000
*       END; /* DEQ (SYSIKJUA,LWARNM,LWARNML,SYSTEM) RET(HAVE) TCB(LWAS 02183000
*CB->LOGONTCB)*/                                                   0700 02184000
*                                                                  0700 02185000
*   /*****************************************************************/ 02186000
*   /*       FREEJCLS:  FREE ANY JCLS THAT HAVE BEEN CONSTRUCTED     */ 02187000
*   /*****************************************************************/ 02188000
*                                                                  0701 02189000
*   CALL FREEJCLS;                                                 0701 02190000
*                                                                  0701 02191000
@RF00687 BAL   @14,FREEJCLS                                        0701 02192000
*CLEANUP:                                                          0702 02193000
*                                                                  0702 02194000
*   /*****************************************************************/ 02195000
*   /*  IF THE UADS HAVE BEEN ACCESSED, THERE IS AN INPUT BUFFER     */ 02196000
*   /*  WHICH MUST BE FREED.                                         */ 02197000
*   /*****************************************************************/ 02198000
*                                                                  0702 02199000
*   IF READBUF ^= 0               /* IF THE POINTER TO THE UADS INPUT   02200000
*                                    BUFFER IS NON-ZERO, THEN THE  0702 02201000
*                                    BUFFER HAS BEEN OBTAINED AND MUST  02202000
*                                    BE FREED.                       */ 02203000
*     THEN                                                         0702 02204000
CLEANUP  L     @08,READBUF                                         0702 02205000
         LTR   @08,@08                                             0702 02206000
         BZ    @RF00702                                            0702 02207000
*       DO;                                                        0703 02208000
*         RESPECIFY (LENSTR) RSTD;                                 0704 02209000
*         LENSTR = DCBBLKSI;      /* GET LENGTH IN BYTES OF        0705 02210000
*                                    INPUT BUFFER.                   */ 02211000
         LH    LENSTR,DCBBLKSI                                     0705 02212000
*         GEN(FREEMAIN R,SP=1,LV=(LENSTR),A=READBUF); /* FREE CORE 0706 02213000
*                                    OCCUPIED BY INPUT BUFFER        */ 02214000
         FREEMAIN R,SP=1,LV=(LENSTR),A=READBUF                          02215000
*         RESPECIFY (LENSTR) UNRSTD;                               0707 02216000
*       END;                                                       0708 02217000
*                                                                  0708 02218000
*                                                                  0708 02219000
*   /*****************************************************************/ 02220000
*   /*  IF THE UADS DCB IS CURRENTLY OPEN, IT MUST BE CLOSED.        */ 02221000
*   /*****************************************************************/ 02222000
*                                                                  0709 02223000
*   IF DCBOFLGS(4) = '1'B         /* IF UADS DCB IS OPEN, CLOSE IT.  */ 02224000
*     THEN                                                         0709 02225000
@RF00702 TM    DCBOFLGS,B'00010000'                                0709 02226000
         BNO   @RF00709                                            0709 02227000
*       DO;                                                        0710 02228000
*         GEN(CLOSE (UADSDCB),MF=(E,CLOSUADS) );                   0711 02229000
         CLOSE (UADSDCB),MF=(E,CLOSUADS)                                02230000
*         JSCBPASS = '0'B;        /* SET NO PASSWORD REQUIRED BIT  0712 02231000
*                                    OFF IN THE JSCB.         A41867 */ 02232000
         L     @08,CVTPTR                                          0712 02233000
         L     @08,CVTTCBP(,@08)                                   0712 02234000
         L     @08,TCBCPTR(,@08)                                   0712 02235000
         L     @08,TCBJSCB(,@08)                                   0712 02236000
         NI    JSCBPASS(@08),B'01111111'                           0712 02237000
*         LWAPDCB=0;              /* INDICATE NO DCB IS OPEN   Y02653*/ 02238000
*                                                                  0713 02239000
         L     @08,LWAPTR                                          0713 02240000
         SLR   @15,@15                                             0713 02241000
         ST    @15,LWAPDCB(,@08)                                   0713 02242000
*       END;                                                       0714 02243000
*                                                                  0714 02244000
*   /*****************************************************************/ 02245000
*   /*       DEQUEUE FROM THE UADS IF CURRENTLY ENQUEUED ON          */ 02246000
*   /*****************************************************************/ 02247000
*                                                                  0715 02248000
*   CALL DEQUADS;                 /* DEQ FROM SYS1.UADS      @Z40NQKC*/ 02249000
*                                                                  0715 02250000
*                                                                  0715 02251000
@RF00709 BAL   @14,DEQUADS                                         0715 02252000
*   IF INBUF ^= 0                 /* IF COMMAND BUFFER EXISTS,     0716 02253000
*                                    (POINTER TO IT NOT ZERO)      0716 02254000
*                                    THEN FREE THE CORE IT OCCUPIES. */ 02255000
*     THEN                                                         0716 02256000
         L     @08,INBUF                                           0716 02257000
         LTR   @08,@08                                             0716 02258000
         BZ    @RF00716                                            0716 02259000
*       DO;                                                        0717 02260000
*         RESPECIFY (LENSTR) RSTD;                                 0718 02261000
*         LENSTR = CMNDLNG;       /* GET LENGTH OF BUFFER TO BE FREED*/ 02262000
         LH    LENSTR,CMNDLNG(,@08)                                0719 02263000
*         GEN(FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF); /* FREE COMMAND     02264000
*                                    BUFFER CORE.                    */ 02265000
         FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF                            02266000
*         RESPECIFY (LENSTR) UNRSTD;                               0721 02267000
*       END;                                                       0722 02268000
*                                                                  0722 02269000
*   IF NOPRMPT = '1'B             /* CHECK FOR NOPROMPT PROCESSING   */ 02270000
*     THEN                                                         0723 02271000
@RF00716 TM    NOPRMPT,B'00100000'                                 0723 02272000
         BO    @RT00723                                            0723 02273000
*       GOTO CNTPRMPT;                                             0724 02274000
*                                                                  0724 02275000
*                                                                  0724 02276000
*   LWARTCD = 0;                  /* ZERO RETURN CODE FIELD IN LWA   */ 02277000
         L     @08,LWAPTR                                          0725 02278000
         SLR   @15,@15                                             0725 02279000
         ST    @15,LWARTCD(,@08)                                   0725 02280000
*   LWABEND='0'B;                 /*TURN OFF ABEND INDICATOR   Y02669*/ 02281000
         NI    LWABEND(@08),B'11111101'                            0726 02282000
*                                 /*IN CASE OF PREVIOUS ABEND. Y02669*/ 02283000
*                                 /*THEN B WILL NOT REATTACH C Y02669*/ 02284000
*   LWALE = '0'B;                 /* INDICATE LE IS LOSING     Y02669*/ 02285000
         NI    LWALE(@08),B'11101111'                              0727 02286000
*                                 /* CONTROL                   Y02669*/ 02287000
*                                                                  0728 02288000
*   /*****************************************************************/ 02289000
*   /*     RETURN TO IKJEFLC                                         */ 02290000
*   /*****************************************************************/ 02291000
*                                                                  0728 02292000
*   RETURN;                                                        0728 02293000
@EL00002 DS    0H                                                  0728 02294000
@EF00002 DS    0H                                                  0728 02295000
@ER00002 LM    @14,@12,@SA00002                                    0728 02296000
         BR    @14                                                 0728 02297000
*                                                                  0729 02298000
*                                                                  0729 02299000
*                                                                  0729 02300000
*NOOPEN:                                                           0729 02301000
*                                                                  0729 02302000
*   /*****************************************************************/ 02303000
*   /*  AN ATTEMPT TO OPEN THE UADS DATA SET HAS FAILED.             */ 02304000
*   /*  SEND TERMINATION MESSAGE TO TERMINAL AND SYSTEM OPERATOR.    */ 02305000
*   /*****************************************************************/ 02306000
*                                                                  0729 02307000
*   TEXTSLEN(1) = 8;              /* TEXT MESSAGE IS FOUR CHARACTERS.*/ 02308000
NOOPEN   MVC   TEXTSLEN(2),@CH00046                                0729 02309000
*   TEXTSTXT(1,1:4) = 'OPEN';     /* OPEN ERROR TO BE INSERTED.      */ 02310000
         MVC   TEXTSTXT(4),@CC03046                                0730 02311000
*   GOTO CMNIOERR;                /* GOTO PROCESS REMAINDER OF MESSAG*/ 02312000
*                                                                  0731 02313000
*                                                                  0731 02314000
         B     CMNIOERR                                            0731 02315000
*IOERROR:                                                          0732 02316000
*                                                                  0732 02317000
*   /*****************************************************************/ 02318000
*   /*  AN UNCORRECTABLE I/O ERROR HAS OCCURED EITHER ON THE         */ 02319000
*   /*  UADS DIRECTORY OR ONE OF ITS MEMBERS.  AN ERROR              */ 02320000
*   /*  ERROR MESSAGE WILL BE SENT TO THE TERMINAL USER AND          */ 02321000
*   /*  TO THE SYSTEM OPERATOR, AFTER WHICH THE TERMINAL WILL        */ 02322000
*   /*  WILL BE DISCONNECTED.                                        */ 02323000
*   /*****************************************************************/ 02324000
*                                                                  0732 02325000
*   TEXTSLEN(1) = 7;              /* LENGTH OF INSERTED TEXT IS    0732 02326000
*                                    THREE CHARACTERS.               */ 02327000
IOERROR  MVC   TEXTSLEN(2),@CH00133                                0732 02328000
*   TEXTSTXT(1,1:3) = 'I/O';      /* I/O ERROR TEXT TO BE INSERTED.  */ 02329000
         MVC   TEXTSTXT(3),@CC03049                                0733 02330000
*CMNIOERR:                        /* REMAINDER OF CODE IS USED FOR BOTH 02331000
*                                    I/O AND OPEN ERRORS ON UADS.    */ 02332000
*                                                                  0734 02333000
*   PMSGNM = 18;                  /* SET MESSAGE NUMBER TO IO ERROR  */ 02334000
CMNIOERR MVC   PMSGNM(2),@CH00090                                  0734 02335000
*   TEXTSLEN(2) = 11;             /* LENGTH OF INSERTED TEXT IS    0735 02336000
*                                    SEVEN CHARACTERS.               */ 02337000
         MVC   TEXTSLEN+24(2),@CH00033                             0735 02338000
*   TEXTSTXT(2,1:7) = 'SYSUADS';  /* SYSUADS DDNAME TEXT TO BE     0736 02339000
*                                    INSERTED.                       */ 02340000
*                                                                  0736 02341000
         MVC   TEXTSTXT+24(7),@CC03051                             0736 02342000
*                                 /*SET UP TEXT INSERT FOR     Y02669*/ 02343000
*                                 /*TERMINAL MSG.  WTO MSG IS  Y02669*/ 02344000
*                                /*OPEN OR I/O ERROR. TERMINAL Y02669*/ 02345000
*                                 /*MSG IS LOGON TERMINATED.   Y02669*/ 02346000
*   TEXTSLN2=14;                  /*LEN OF INSERTED TEXT IS 10 Y02669*/ 02347000
         MVC   TEXTSLN2(2),@CH02961                                0737 02348000
*   TEXTOFF2=0;                   /*PUT IN OFFSET              Y02669*/ 02349000
         SLR   @08,@08                                             0738 02350000
         STH   @08,TEXTOFF2                                        0738 02351000
*   TEXTXT2='TERMINATED';         /*PUT IN TEXT                Y02669*/ 02352000
*                                                                  0739 02353000
         MVI   TEXTXT2+10,C' '                                     0739 02354000
         MVC   TEXTXT2+11(7),TEXTXT2+10                            0739 02355000
         MVC   TEXTXT2(10),@CC03052                                0739 02356000
*   TEXTINT2(1)=ADDR(TEXTSEG2); /*POINT TO 'TERMINATED' INSERT Y02669*/ 02357000
         LA    @08,TEXTSEG2                                        0740 02358000
         ST    @08,TEXTINT2                                        0740 02359000
*   SEGS2PTR=ADDR(TEXTINT2);      /*POINT TO INSERT POINTER    Y02669*/ 02360000
*                                                                  0741 02361000
         LA    @08,TEXTINT2                                        0741 02362000
         ST    @08,SEGS2PTR                                        0741 02363000
*ERRGTMN:                                                          0742 02364000
*                                                                  0742 02365000
*   TEXTINT1(1) = ADDR(TEXTSEGS(1));                               0742 02366000
ERRGTMN  LA    @08,TEXTSEGS                                        0742 02367000
         ST    @08,TEXTINT1                                        0742 02368000
*   TEXTINT1(2) = ADDR(TEXTSEGS(2));                               0743 02369000
         LA    @08,TEXTSEGS+24                                     0743 02370000
         ST    @08,TEXTINT1+4                                      0743 02371000
*   TEXTINT1(3) = 0;              /* IN CASE USERID IS UNKNOWN,    0744 02372000
*                                    SET TEXT SEGMENT POINTER TO ZERO*/ 02373000
         SLR   @08,@08                                             0744 02374000
         ST    @08,TEXTINT1+8                                      0744 02375000
*   TEXTINT1(4) = 0;              /* IN CASE PROCNAME IS UNKNOWN,  0745 02376000
*                                    SET TEXT SEGMENT POINTER TO ZERO*/ 02377000
*                                                                  0745 02378000
         ST    @08,TEXTINT1+12                                     0745 02379000
*   IF LWPUSERL ^= 0              /* IS THERE USERID         @Z40NQKC   02380000
*                                    USERID TEXT SEGMENT.            */ 02381000
*     THEN                                                         0746 02382000
         L     @15,LWPPTR                                          0746 02383000
         CH    @08,LWPUSERL(,@15)                                  0746 02384000
         BE    @RF00746                                            0746 02385000
*       TEXTINT1(3) = ADDR(LWPUSERI);                      /*@Z40NQKC*/ 02386000
*                                                                  0747 02387000
         LA    @08,LWPUSERI(,@15)                                  0747 02388000
         ST    @08,TEXTINT1+8                                      0747 02389000
*   IF LWPPROCL ^= 0              /* IS THERE PROCNAME       @Z40NQKC   02390000
*                                    PROCNAME TEXT SEGMENT.          */ 02391000
*     THEN                                                         0748 02392000
@RF00746 L     @08,LWPPTR                                          0748 02393000
         LH    @15,LWPPROCL(,@08)                                  0748 02394000
         LTR   @15,@15                                             0748 02395000
         BZ    @RF00748                                            0748 02396000
*       TEXTINT1(4) = ADDR(LWPPROCI);                      /*@Z40NQKC*/ 02397000
*                                                                  0749 02398000
*                                                                  0749 02399000
         LA    @08,LWPPROCI(,@08)                                  0749 02400000
         ST    @08,TEXTINT1+12                                     0749 02401000
*   RESPECIFY (PARMPTR) RSTD;                                      0750 02402000
@RF00748 DS    0H                                                  0751 02403000
*   ECBPTR = ADDR(DUMMYECB);                                       0751 02404000
         LA    @08,DUMMYECB                                        0751 02405000
         ST    @08,ECBPTR                                          0751 02406000
*   PARMPTR = ADDR(UPTPTR2);      /* GET ADDRESS OF PARAMETER LIST 0752 02407000
*                                    FOR MESSAGE FORMATING MODULE.   */ 02408000
         LA    PARMPTR,UPTPTR2                                     0752 02409000
*   CALL IKJEFLGM;                /* CALL MESSAGE MODULE TO        0753 02410000
*                                    SEND MESSAGE TO TERMINAL.       */ 02411000
         L     @15,@CV00272                                        0753 02412000
         BALR  @14,@15                                             0753 02413000
*   RESPECIFY (PARMPTR) UNRSTD;                                    0754 02414000
*   SEGS2PTR=ADDR(TEXTINT1(1));   /*RESTORE PTR TO TEXT INSERT Y02669*/ 02415000
         LA    @08,TEXTINT1                                        0755 02416000
         ST    @08,SEGS2PTR                                        0755 02417000
*   RESPECIFY (SVRTN) RSTD;                                        0756 02418000
*                                                                  0756 02419000
*SRERROR:                                                          0757 02420000
*                                                                  0757 02421000
*   /*****************************************************************/ 02422000
*   /*  IN CASE OF UNSUCCESSFUL RETURN CODE FROM IKJEFLGM OR         */ 02423000
*   /*  IKJEFLEA, WE RETURN HERE. REGISTER 15 WILL CONTAIN THE       */ 02424000
*   /*  NONZERO RETURN CODE.                                         */ 02425000
*   /*****************************************************************/ 02426000
*   RFY (RTNREG) RSTD;                                     /*@Z40RQKC*/ 02427000
SRERROR  DS    0H                                                  0758 02428000
*   SVRTN = RTNREG;               /* SAVE RETURN CODE FROM PARSE     */ 02429000
         LR    SVRTN,RTNREG                                        0758 02430000
*   RFY (RTNREG) UNRSTD;                                   /*@Z40RQKC*/ 02431000
*                                                                  0759 02432000
*   IF MSGSWC = '1'B              /* IF HERE FOR GETMAIN ERROR MESSAGE, 02433000
*                                    ERROR RECOVERY ALREADY ATTEMPTED.  02434000
*                                    DONOT CHECK RETURN CODES - GO 0760 02435000
*                                    DIRECTLY TO CLEANUP.            */ 02436000
*     THEN                                                         0760 02437000
         TM    MSGSWC,B'01000000'                                  0760 02438000
         BO    @RT00760                                            0760 02439000
*       GOTO CLEANUP4;                                             0761 02440000
*                                                                  0761 02441000
*                                                                  0761 02442000
*   IF SVRTN = 8 &                /* IF COMMUNICATIONS ECB   @ZA10809*/ 02443000
*      CHCECB ^= 0                /* POSTED, GOTO CLEANUP    @ZA10809*/ 02444000
*     THEN                                                         0762 02445000
         C     SVRTN,@CF00046                                      0762 02446000
         BNE   @RF00762                                            0762 02447000
         L     @08,LWAPTR                                          0762 02448000
         L     @08,LWAJSEL(,@08)                                   0762 02449000
         L     @08,JSELCSCB(,@08)                                  0762 02450000
         L     @08,CHCECB(,@08)                                    0762 02451000
         LTR   @08,@08                                             0762 02452000
         BNZ   @RT00762                                            0762 02453000
*       GOTO ECBPOSTD;                                             0763 02454000
*   IF SVRTN = 8 &                /* IF ECB NOT POSTED, RC IS@ZA10809*/ 02455000
*      CHCECB = 0                 /* 8, THEN LINE DROPPED,   @ZA10809*/ 02456000
*     THEN                        /* DISCONNECT TERMINAL AND @ZA10809*/ 02457000
@RF00762 C     SVRTN,@CF00046                                      0764 02458000
         BNE   @RF00764                                            0764 02459000
         L     @08,LWAPTR                                          0764 02460000
         L     @08,LWAJSEL(,@08)                                   0764 02461000
         L     @08,JSELCSCB(,@08)                                  0764 02462000
         L     @08,CHCECB(,@08)                                    0764 02463000
         LTR   @08,@08                                             0764 02464000
         BZ    @RT00764                                            0764 02465000
*        GOTO CLEANUP4;           /* CLEANUP                 @ZA10809*/ 02466000
*                                                                  0765 02467000
*                                                                  0765 02468000
*   IF SVRTN = 16                 /* IF GETMAIN FAILURE, BRANCH TO 0766 02469000
*                                    SEND TERMINATION MESSAGE AND  0766 02470000
*                                    DISCONNECT TERMINAL.            */ 02471000
*     THEN                                                         0766 02472000
@RF00764 C     SVRTN,@CF00145                                      0766 02473000
         BE    @RT00766                                            0766 02474000
*       GOTO GTMNERR;                                              0767 02475000
*                                                                  0767 02476000
*                                                                  0767 02477000
*   IF SVRTN = 4                  /* IF UNABLE TO PROMPT, LOGON CAN     02478000
*                                    NOT CONTINUE. MUST TERMINATE  0768 02479000
*                                    CURRENT SESSION AND PROMPT FOR     02480000
*                                    LOGON|LOGOFF COMMAND.           */ 02481000
*     THEN                                                         0768 02482000
         C     SVRTN,@CF00098                                      0768 02483000
         BNE   @RF00768                                            0768 02484000
*       DO;                                                        0769 02485000
*         NOPRMPT = '1'B;         /* SET NOPROMPT SWITCH ON          */ 02486000
         OI    NOPRMPT,B'00100000'                                 0770 02487000
*         GOTO CLEANUP0;                                           0771 02488000
         B     CLEANUP0                                            0771 02489000
*       END;                                                       0772 02490000
*                                                                  0772 02491000
*                                                                  0772 02492000
*                                                                  0772 02493000
*   IF SVRTN = 12                 /* IF WE GAVE A SERVICE ROUTINE BAD   02494000
*                                    PARAMETERS, WE'RE IN TROUBLE.   */ 02495000
*     THEN                                                         0773 02496000
@RF00768 C     SVRTN,@CF00034                                      0773 02497000
         BNE   @RF00773                                            0773 02498000
*       DO;                                                        0774 02499000
*         TEXTSTXT(2,1:3) = '012';                                 0775 02500000
         MVC   TEXTSTXT+24(3),@CC03059                             0775 02501000
*         GOTO BADPARMS;                                           0776 02502000
         B     BADPARMS                                            0776 02503000
*       END;                                                       0777 02504000
*   GOTO CLEANUP4;               /* GO HANDLE DISCONNECTION        0778 02505000
*                                   OF TERMINAL.                     */ 02506000
         B     CLEANUP4                                            0778 02507000
*   RESPECIFY (SVRTN) UNRSTD;                                      0779 02508000
*                                                                  0779 02509000
*GTMNERR:                                                          0780 02510000
*                                                                  0780 02511000
*   /*****************************************************************/ 02512000
*   /*  AN UNCONDITIONAL GETMAIN WAS ISSUED AND THERE WAS            */ 02513000
*   /*  INSUFFICIENT STORAGE TO SATISFY THE REQUEST.                 */ 02514000
*   /*  SEND ERROR MESSAGE TO THE TERMINAL AND OPERATOR'S CONSOLE,   */ 02515000
*   /*  THEN TERMINATE THE TERMINAL SESSION.                         */ 02516000
*   /*****************************************************************/ 02517000
*                                                                  0780 02518000
*   PTYPE = 1;                    /* INDICATE 'GETMAIN TEXT INSERTION*/ 02519000
GTMNERR  MVC   PTYPE(2),@CH00037                                   0780 02520000
*   TEXTSTXT(2,1:3) = '004';      /* INDICATE GETMAIN FAILURE NUMBER.*/ 02521000
*                                                                  0781 02522000
         MVC   TEXTSTXT+24(3),@CC03062                             0781 02523000
*BADPARMS:                                                         0782 02524000
*                                                                  0782 02525000
*   /*****************************************************************/ 02526000
*   /*    IF RECEIVED BAD PARAMETER RETURN CODE FROM SOME MODULE     */ 02527000
*   /*    (IKJEFLGM, IKJEFLEA, ETC.) OR IF GETMAIN FAILURE,          */ 02528000
*   /*    SET UP TEXT INSERTION BUFFERS FOR 'SRNAME' ERROR MESSAGE   */ 02529000
*   /*****************************************************************/ 02530000
*                                                                  0782 02531000
*   TEXTSLEN(1) = 12;             /*                           Y02669*/ 02532000
BADPARMS MVC   TEXTSLEN(2),@CH00034                                0782 02533000
*   TEXTSTXT(1,1:8) = SRNAMES(PTYPE);  /*                      Y02669*/ 02534000
*                                                                  0783 02535000
         LH    @08,PTYPE                                           0783 02536000
         SLA   @08,3                                               0783 02537000
         LA    @01,SRNAMES-8(@08)                                  0783 02538000
         MVC   TEXTSTXT(8),0(@01)                                  0783 02539000
*   TEXTSLEN(2) = 7;              /* LENGTH OF TEXT PLUS LENGTH    0784 02540000
*                                    OF HEADER.                      */ 02541000
         MVC   TEXTSLEN+24(2),@CH00133                             0784 02542000
*SETUPMSG:                                                         0785 02543000
*   MSGSWC = '1'B;                /* SET MESSAGE SWITCH TO ONE. THIS    02544000
*                                    WILL PREVENT AN UNENDING LOOP 0785 02545000
*                                    FROM OCCURING WHEN TESTING    0785 02546000
*                                    ERROR CONDITIONS AT 'SRERROR'   */ 02547000
*                                                                  0785 02548000
SETUPMSG OI    MSGSWC,B'01000000'                                  0785 02549000
*   PMSGNM = 20;                  /* SET MESSAGE NUMBER TO 'SRNAME'     02550000
*                                    ERROR.                          */ 02551000
         MVC   PMSGNM(2),@CH00340                                  0786 02552000
*   GOTO ERRGTMN;                 /* GO TO SEND SRNAME ERROR MESSAGE */ 02553000
*                                                                  0787 02554000
*                                                                  0787 02555000
         B     ERRGTMN                                             0787 02556000
*END MAINLINE;                                                     0788 02557000
*   /*****************************************************************/ 02558000
*   /*  ISSUE ALL NECESSARY LIST FORMS OF MACROS.                    */ 02559000
*   /*****************************************************************/ 02560000
*                                                                  0789 02561000
*GEN DATA;                                                         0789 02562000
*                                                                  0789 02563000
*GEN;                                                              0790 02564000
*                                                                  0790 02565000
         DS    0F                                                       02566000
MACSTRT  EQU   *                                                        02567000
OPENUADD OPEN  (UADSDCBD),MF=L                                          02568000
CLOSUADD CLOSE (UADSDCBD),MF=L                                          02569000
UADSDCBD DCB   DDNAME=SYSUADS,MACRF=R,DSORG=PO,SYNAD=SYNAD,KEYLEN=0     02570000
READUADD READ  UADSDECD,SF,,,,'S',,MF=L                                 02571000
MACLEN   EQU   *-MACSTRT                                                02572000
*CNVRGN:  PROC   OPTIONS(NOSAVEAREA);                              0791 02573000
*                                                                  0791 02574000
*                                                                  0791 02575000
         B     @PB00003                                            0791 02576000
CNVRGN   STM   @14,@12,12(@13)                                     0791 02577000
*   RESPECIFY(REGION) RSTD;                                        0792 02578000
*                                                                  0792 02579000
*   /*****************************************************************/ 02580000
*   /*       CONVERT REGION SIZE TO EBCDIC STRING                    */ 02581000
*   /*****************************************************************/ 02582000
*                                                                  0793 02583000
*   GEN(CVD   REGION,CONVERT);                                     0793 02584000
         CVD   REGION,CONVERT                                           02585000
*   GEN(UNPK  CONVERT(5),CONVERT+5(3));                            0794 02586000
         UNPK  CONVERT(5),CONVERT+5(3)                                  02587000
*   CONVERT(5) = CONVERT(5) | 'F0'X;                               0795 02588000
*                                                                  0795 02589000
         OI    CONVERT+4,X'F0'                                     0795 02590000
*   /*****************************************************************/ 02591000
*   /*       SET UP TEXT INSERTION BUFFER FOR REGION SIZE            */ 02592000
*   /*****************************************************************/ 02593000
*                                                                  0796 02594000
*   TEXTSTXT(SCANINDX,1:5) = CONVERT(1:5); /* MOVE REGION SIZE     0796 02595000
*                                    CHARACTER STRING TO TEXT      0796 02596000
*                                    INSERTION BUFFER                */ 02597000
         LR    @03,SCANINDX                                        0796 02598000
         MH    @03,@CH00080                                        0796 02599000
         LA    @01,TEXTSTXT-24(@03)                                0796 02600000
         MVC   0(5,@01),CONVERT                                    0796 02601000
*   TEXTSLEN(SCANINDX) = 9;       /* LENGTH OF REGION SIZE CHARACTER    02602000
*                                    STRING PLUS LENGTH OF HEADER(4).*/ 02603000
         LA    @15,9                                               0797 02604000
         STH   @15,TEXTSLEN-24(@03)                                0797 02605000
*   TEXTINT1(SCANINDX) = ADDR(TEXTSEGS(SCANINDX)); /* GET ADDRESS OF    02606000
*                                    TEXT INSERTION BUFFER.          */ 02607000
         LR    @15,SCANINDX                                        0798 02608000
         SLA   @15,2                                               0798 02609000
         LA    @03,TEXTSEGS-24(@03)                                0798 02610000
         ST    @03,TEXTINT1-4(@15)                                 0798 02611000
*   RESPECIFY (REGION) UNRSTD;                                     0799 02612000
*   /*****************************************************************/ 02613000
*   /*       RETURN TO CALLER                                        */ 02614000
*   /*****************************************************************/ 02615000
*                                                                  0800 02616000
*END CNVRGN;                                                       0800 02617000
@EL00003 DS    0H                                                  0800 02618000
@EF00003 DS    0H                                                  0800 02619000
@ER00003 LM    @14,@12,12(@13)                                     0800 02620000
         BR    @14                                                 0800 02621000
*CNVPRFRM:  PROC   OPTIONS(NOSAVEAREA);                      /*Y02669*/ 02622000
*                                                                  0801 02623000
*                                                                  0801 02624000
CNVPRFRM STM   @14,@12,12(@13)                                     0801 02625000
*   RESPECIFY(PRFRMGP) RSTD;                                 /*Y02669*/ 02626000
*                                                                  0802 02627000
*   /*****************************************************************/ 02628000
*   /*       CONVERT PERFORMANCE GROUP TO EBCDIC STRING        Y02669*/ 02629000
*   /*****************************************************************/ 02630000
*                                                                  0803 02631000
*   GEN(CVD   PRFRMGP,CONVERT);                              /*Y02669*/ 02632000
         CVD   PRFRMGP,CONVERT                                          02633000
*   GEN(UNPK  CONVERT(3),CONVERT+6(2));                      /*Y02669*/ 02634000
         UNPK  CONVERT(3),CONVERT+6(2)                                  02635000
*   CONVERT(3) = CONVERT(3) | 'F0'X;                         /*Y02669*/ 02636000
*                                                                  0805 02637000
         OI    CONVERT+2,X'F0'                                     0805 02638000
*   /*****************************************************************/ 02639000
*   /*       SET UP TEXT INSERTION BUFFER FOR PERFORMANCE GROUP Y02669* 02640000
*   /*****************************************************************/ 02641000
*                                                                  0806 02642000
*   TEXTSLEN(1)=7;                 /*SET UP LENGTH OF TEXT     Y02669*/ 02643000
         MVC   TEXTSLEN(2),@CH00133                                0806 02644000
*   TEXTSOST(1)=0;                 /*SET UP OFFSET             Y02669*/ 02645000
         SLR   @15,@15                                             0807 02646000
         STH   @15,TEXTSOST                                        0807 02647000
*   TEXTSTXT(1,1:3)=CONVERT(1:3);  /*PUT IN PERFORM GROUP      Y02669*/ 02648000
*                                                                  0808 02649000
         MVC   TEXTSTXT(3),CONVERT                                 0808 02650000
*   RESPECIFY (PRFRMGP) UNRSTD;                              /*Y02669*/ 02651000
*                                  /*RETURN TO CALLER          Y02669*/ 02652000
*END CNVPRFRM;                                               /*Y02669*/ 02653000
@EL00004 DS    0H                                                  0810 02654000
@EF00004 DS    0H                                                  0810 02655000
@ER00004 LM    @14,@12,12(@13)                                     0810 02656000
         BR    @14                                                 0810 02657000
*FREEJCLS:  PROC   OPTIONS(NOSAVEAREA);                            0811 02658000
FREEJCLS STM   @14,@12,12(@13)                                     0811 02659000
*   RESPECIFY (JCLSPTR) RSTD;                                      0812 02660000
*                                                                  0812 02661000
*                                                                  0812 02662000
*FREEJCL:                                                          0813 02663000
*                                                                  0813 02664000
*   JCLSPTR = JSELJCL;            /* POINT TO FIRST JCLS             */ 02665000
FREEJCL  L     @08,LWAPTR                                          0813 02666000
         L     @08,LWAJSEL(,@08)                                   0813 02667000
         L     JCLSPTR,JSELJCL(,@08)                               0813 02668000
*   IF JCLSPTR = 0                /* IF NO JCLS                      */ 02669000
*     THEN                                                         0814 02670000
         LTR   JCLSPTR,JCLSPTR                                     0814 02671000
         BZ    @RT00814                                            0814 02672000
*       RETURN;                   /* THEN RETURN TO CALLER           */ 02673000
*                                                                  0815 02674000
*   JSELJCL = JCLSJCLS;           /* SET JSELJCL TO ADDR OF NEXT JCLS*/ 02675000
         L     @05,JCLSJCLS(,JCLSPTR)                              0816 02676000
         ST    @05,JSELJCL(,@08)                                   0816 02677000
*   GEN(FREEMAIN  R,SP=1,LV=88,A=(JCLSPTR)); /* FREE CURRENT JCLS    */ 02678000
         FREEMAIN  R,SP=1,LV=88,A=(JCLSPTR)                             02679000
*   GOTO FREEJCL;                                                  0818 02680000
         B     FREEJCL                                             0818 02681000
*   RESPECIFY (JCLSPTR) UNRSTD;                                    0819 02682000
*END FREEJCLS;                                                     0820 02683000
@EL00005 DS    0H                                                  0820 02684000
@EF00005 DS    0H                                                  0820 02685000
@ER00005 LM    @14,@12,12(@13)                                     0820 02686000
         BR    @14                                                 0820 02687000
*LGM:  PROC  OPTIONS(NOSAVE,NOSAVEAREA);                           0821 02688000
LGM      DS    0H                                                  0822 02689000
*   RFY (R14) RSTD;                                        /*@Z40RQKC*/ 02690000
*   SAVEBK = R14;                                                  0823 02691000
         LR    SAVEBK,R14                                          0823 02692000
*   RFY (R14) UNRSTD;                                      /*@Z40RQKC*/ 02693000
*   /*****************************************************************/ 02694000
*   /*       SET ERROR CODE TO 'IKJEFLGM'                            */ 02695000
*   /*       CALL LOGON MESSAGE MODULE                               */ 02696000
*   /*****************************************************************/ 02697000
*                                                                  0825 02698000
*   PTYPE = 4;                                                     0825 02699000
         MVC   PTYPE(2),@CH00098                                   0825 02700000
*   RESPECIFY (PARMPTR) RSTD;                                      0826 02701000
*   PARMPTR = ADDR(UPTPTR2);                                       0827 02702000
         LA    PARMPTR,UPTPTR2                                     0827 02703000
*   CALL IKJEFLGM;                                                 0828 02704000
         L     @15,@CV00272                                        0828 02705000
         BALR  @14,@15                                             0828 02706000
*   RESPECIFY (R14) RSTD;                                  /*@Z40RQKC*/ 02707000
*   R14 = SAVEBK;                                                  0830 02708000
         LR    R14,SAVEBK                                          0830 02709000
*   RFY (PARMPTR,R14) UNRSTD;                              /*@Z40RQKC*/ 02710000
*   IF RTNREG = 0                 /* IF NO ERROR FROM LGM            */ 02711000
*     THEN                                                         0832 02712000
         LTR   RTNREG,RTNREG                                       0832 02713000
         BZ    @RT00832                                            0832 02714000
*       RETURN;                   /* THEN RETURN TO CALLER           */ 02715000
*                                                                  0833 02716000
*                                                                  0833 02717000
*   RETURN TO SRERROR;                                             0834 02718000
         LA    @14,SRERROR                                         0834 02719000
@EL00006 DS    0H                                                  0834 02720000
@EF00006 DS    0H                                                  0834 02721000
@ER00006 BR    @14                                                 0834 02722000
*END LGM;                                                          0835 02723000
         B     @EL00006                                            0835 02724000
*PROMPT:  PROC  OPTIONS(NOSAVE,NOSAVEAREA);                        0836 02725000
*                                                                  0836 02726000
PROMPT   DS    0H                                                  0837 02727000
*   /*****************************************************************/ 02728000
*   /*       SET TYPE TO 'PROMPT'                                    */ 02729000
*   /*****************************************************************/ 02730000
*                                                                  0837 02731000
*   PTYPE = 1;                                                     0837 02732000
         MVC   PTYPE(2),@CH00037                                   0837 02733000
*   GOTO LEA;                                                      0838 02734000
         B     LEA                                                 0838 02735000
*PROMPT1: ENTRY;                                                   0839 02736000
*                                                                  0839 02737000
PROMPT1  DS    0H                                                  0840 02738000
*   /*****************************************************************/ 02739000
*   /*       SET TYPE TO 'PROMPT1'                                   */ 02740000
*   /*****************************************************************/ 02741000
*                                                                  0840 02742000
*   PTYPE = 2;                                                     0840 02743000
         MVC   PTYPE(2),@CH00135                                   0840 02744000
*   GOTO LEA;                                                      0841 02745000
         B     LEA                                                 0841 02746000
*SCAN1:  ENTRY;                                                    0842 02747000
*                                                                  0842 02748000
SCAN1    DS    0H                                                  0843 02749000
*   /*****************************************************************/ 02750000
*   /*       SET TYPE TO SCAN OF RE-LOGON BUFFER                     */ 02751000
*   /*****************************************************************/ 02752000
*                                                                  0843 02753000
*   PTYPE =3;                                                      0843 02754000
         MVC   PTYPE(2),@CH00087                                   0843 02755000
*   GOTO LEA;                                                      0844 02756000
         B     LEA                                                 0844 02757000
*SCAN2:  ENTRY;                                                    0845 02758000
*                                                                  0845 02759000
SCAN2    DS    0H                                                  0846 02760000
*   /*****************************************************************/ 02761000
*   /*       SET TYPE TO SCAN AND PROMPT FOR LOGON | LOGOFF          */ 02762000
*   /*****************************************************************/ 02763000
*                                                                  0846 02764000
*   PTYPE = 4;                                                     0846 02765000
         MVC   PTYPE(2),@CH00098                                   0846 02766000
*   GOTO LEA;                                                      0847 02767000
         B     LEA                                                 0847 02768000
*JCLBLD:  ENTRY;                                                   0848 02769000
*                                                                  0848 02770000
JCLBLD   DS    0H                                                  0849 02771000
*   /*****************************************************************/ 02772000
*   /*       SET TYPE TO BUILD JCLS                                  */ 02773000
*   /*****************************************************************/ 02774000
*                                                                  0849 02775000
*   PTYPE = 5;                                                     0849 02776000
         MVC   PTYPE(2),@CH00209                                   0849 02777000
*LEA:                                                              0850 02778000
*                                                                  0850 02779000
*   /*****************************************************************/ 02780000
*   /*       PERFORM 'SCAN', 'PROMPT', OR JCLS BUILD                 */ 02781000
*   /*****************************************************************/ 02782000
*   RESPECIFY (R14,RTNREG,PARMPTR) RSTD;                   /*@Z40RQKC*/ 02783000
LEA      DS    0H                                                  0851 02784000
*   SAVEBK = R14;                                                  0851 02785000
         LR    SAVEBK,R14                                          0851 02786000
*   PARMPTR = ADDR(PARMLST);                                       0852 02787000
         LA    PARMPTR,PARMLST                                     0852 02788000
*   RESPECIFY (R14) UNRSTD;                                /*@Z40RQKC*/ 02789000
*   CALL IKJEFLEA;                                                 0854 02790000
         L     @15,@CV00271                                        0854 02791000
         BALR  @14,@15                                             0854 02792000
*   RESPECIFY (R14) RSTD;                                  /*@Z40RQKC*/ 02793000
*   R14 = SAVEBK;                                                  0856 02794000
*                                                                  0856 02795000
*                                                                  0856 02796000
         LR    R14,SAVEBK                                          0856 02797000
*   IF RTNREG = 0 |               /* IF NO ERROR FROM IKJEFLEA       */ 02798000
*      MODE = SUBMIT              /* OR CALLED FROM SUBMIT  @Z40NQKC*/  02799000
*     THEN                                                         0857 02800000
         LTR   RTNREG,RTNREG                                       0857 02801000
         BZ    @RT00857                                            0857 02802000
         CLI   MODE,X'01'                                          0857 02803000
         BNE   @RF00857                                            0857 02804000
@RT00857 DS    0H                                                  0858 02805000
*       RETURN CODE(RTNREG);      /* THEN RETURN TO CALLER           */ 02806000
*                                                                  0858 02807000
@EL00007 DS    0H                                                  0858 02808000
@EF00007 DS    0H                                                  0858 02809000
@ER00007 BR    @14                                                 0858 02810000
*   RESPECIFY (R14,RTNREG,PARMPTR) UNRSTD;                 /*@Z40RQKC*/ 02811000
@RF00857 DS    0H                                                  0860 02812000
*   RETURN TO SRERROR;                                             0860 02813000
         LA    @14,SRERROR                                         0860 02814000
         BR    @14                                                 0860 02815000
*END PROMPT;                                                       0861 02816000
*                                                                  0862 02817000
*   /*****************************************************************/ 02818000
*   /*      THIS SUBROUTINE LOCATES ANY DATA FROM THE UADS           */ 02819000
*   /*      WHICH IS REQUIRED BY MODULE IKJEFLE                      */ 02820000
*   /*****************************************************************/ 02821000
*                                                                  0862 02822000
*FIND: PROC;                                                       0862 02823000
*                                                                  0862 02824000
*                                                                  0862 02825000
*                                                                  0862 02826000
FIND     STM   @14,@12,@SA00008                                    0862 02827000
*   /*****************************************************************/ 02828000
*   /*          REGISTER VARIABLES USED BY 'FIND'                    */ 02829000
*   /*****************************************************************/ 02830000
*                                                                  0863 02831000
*   DCL NEXTADDR PTR(24) REG(3);  /* PTR FOR LABEL VARIABLE          */ 02832000
*   DCL DCBPTR PTR(24) REG(4);    /* PTR TO UADS DCB                 */ 02833000
*   DCL DATAADDR PTR(24) REG(4);  /* ADDR WORK AREA                  */ 02834000
*   DCL BLOCKNUM PTR(31) REG(4);  /* EXTENT BLOCK NUMBER             */ 02835000
*   DCL MEMBRPTR PTR(24) REG(5);  /* PTR TO UADS MEMBER NAME         */ 02836000
*   DCL NBLKNUM PTR(31) REG(6);   /* NEW BLOCK NUMBER ADDRESS        */ 02837000
*   DCL BUFRPTR PTR(24) REG (7);  /* PTR TO THE INPUT BUFFER         */ 02838000
*                                                                  0869 02839000
*   DCL INDIRECT LABEL BASED(NEXTADDR); /* GENERAL LABEL FOR       0870 02840000
*                                    BRANCHES IN ROUTINE             */ 02841000
*   DCL FIELD CHAR(12) BASED(DATAADDR); /* DUMMY DATA FIELD          */ 02842000
*   DCL STRBLKNM CHAR(1) BASED(NBLKNUM); /* USED TO STORE EXTENT   0872 02843000
*                                    NUMBER INTO USERID MEMBER NAME     02844000
*                                    FIELD                           */ 02845000
*   DCL SAVBLKNM CHAR(1);         /* USED TO CHANGE EXTENT NUMBER  0873 02846000
*                                    IN USERID MEMBER NAME FIELD   0873 02847000
*                                    FROM HEX ('00' TO '09') TO    0873 02848000
*                                    EBCDIC (0 TO 9)                 */ 02849000
*   DCL STOREIT PTR(8) DEFINED(SAVBLKNM); /* SAVE EXTENT NUMBER      */ 02850000
*   /*****************************************************************/ 02851000
*   /*          DECLARE BRANCH LABELS USED IN 'FIND'                 */ 02852000
*   /*****************************************************************/ 02853000
*                                                                  0875 02854000
*   DCL STOREOFF LABEL;                                            0875 02855000
*   DCL STORDATA LABEL;                                            0876 02856000
*   DCL ENDFIND LABEL;                                             0877 02857000
*   RESPECIFY(DATAADDR,NEXTADDR) RSTD;                             0878 02858000
*                                                                  0878 02859000
*   /*****************************************************************/ 02860000
*   /*       GET POINTER TO NEXT OFFSET BLOCK                        */ 02861000
*   /*****************************************************************/ 02862000
*                                                                  0879 02863000
*   DATAADDR = UADSNNEX;          /* GET PTR TO NEXT OFFSET BLOCK    */ 02864000
         L     DATAADDR,UADSNNEX-1                                 0879 02865000
         LA    DATAADDR,0(,DATAADDR)                               0879 02866000
*   NEXTADDR = ADDR(STOREOFF);    /* GET ADDR OF ROUTINE TO        0880 02867000
*                                    STORE THE OFFSET BLOCK          */ 02868000
         LA    NEXTADDR,STOREOFF                                   0880 02869000
*   RESPECIFY(BUFRPTR) RSTD;                                       0881 02870000
*FINDBLOK:                                                         0882 02871000
*                                                                  0882 02872000
*   /*****************************************************************/ 02873000
*   /*       GET POINTER TO INPUT BUFFER                             */ 02874000
*   /*****************************************************************/ 02875000
*                                                                  0882 02876000
*   BUFRPTR = READBUF;            /* GET PTR TO THE INPUT BUFFER     */ 02877000
FINDBLOK L     BUFRPTR,READBUF                                     0882 02878000
*   RESPECIFY(BLOCKNUM)RSTD;                                       0883 02879000
*                                                                  0883 02880000
*   /*****************************************************************/ 02881000
*   /*       GET EXTENT NUMBER FOR THIS OFFSET BLOCK                 */ 02882000
*   /*****************************************************************/ 02883000
*                                                                  0884 02884000
*   BLOCKNUM = DATAADDR/DCBBLKSI; /* GET EXTENT BLOCK NUMBER       0884 02885000
*                                    OF DATA FIELD                   */ 02886000
         LR    @01,DATAADDR                                        0884 02887000
         SLR   @00,@00                                             0884 02888000
         LH    @08,DCBBLKSI                                        0884 02889000
         DR    @00,@08                                             0884 02890000
         LR    BLOCKNUM,@01                                        0884 02891000
*   RESPECIFY(NBLKNUM) RSTD;                                       0885 02892000
*   NBLKNUM = ADDR(FINDNAME(LWPUSERL+1)); /* ADDR OF EXTENT  @Z40NQKC   02893000
*                                    IN USERID MEMBER-NAME FIELD     */ 02894000
         L     @08,LWPPTR                                          0886 02895000
         LH    NBLKNUM,LWPUSERL(,@08)                              0886 02896000
         LA    NBLKNUM,FINDNAME(NBLKNUM)                           0886 02897000
*   STOREIT = BLOCKNUM;           /* SAVE EXTENT NUMBER              */ 02898000
         STC   BLOCKNUM,STOREIT                                    0887 02899000
*   SAVBLKNM = SAVBLKNM | '0';                                     0888 02900000
         OI    SAVBLKNM,C'0'                                       0888 02901000
*   IF SAVBLKNM ^= STRBLKNM       /* IF DATA BLOCK IS NOT IN CORE, 0889 02902000
*                                    READ THE DATA BLOCK INTO CORE 0889 02903000
*                                    FROM THE UADS.                  */ 02904000
*     THEN                                                         0889 02905000
         CLC   SAVBLKNM(1),STRBLKNM(NBLKNUM)                       0889 02906000
         BE    @RF00889                                            0889 02907000
*       DO;                                                        0890 02908000
*                                                                  0890 02909000
*   /*****************************************************************/ 02910000
*   /*       ENQUEUE ON UADS DIRECTORY                               */ 02911000
*   /*       FIND EXTENT WHICH CONTAINS OFFSET BLOCK                 */ 02912000
*   /*       DEQUEUE FROM UADS                                       */ 02913000
*   /*****************************************************************/ 02914000
*                                                                  0891 02915000
*         STRBLKNM = SAVBLKNM;    /* STORE EXTENT BLOCK NUMBER IN  0891 02916000
*                                    FIND NAME AREA                  */ 02917000
         MVC   STRBLKNM(1,NBLKNUM),SAVBLKNM                        0891 02918000
*         RESPECIFY (NBLKNUM) UNRSTD;                              0892 02919000
*         RESPECIFY(DCBPTR) RSTD;                                  0893 02920000
*         DCBPTR = ADDR(UADSDCB); /* GET UADS DCB ADDRESS IN REGISTER*/ 02921000
         LA    DCBPTR,UADSDCB                                      0894 02922000
*         RESPECIFY(MEMBRPTR) RSTD;                                0895 02923000
*         MEMBRPTR = ADDR(FINDNAME); /* GET ADDRESS OF THE MEMBER  0896 02924000
*                                    NAME INTO A REGISTER.           */ 02925000
*                                                                  0896 02926000
         LA    MEMBRPTR,FINDNAME                                   0896 02927000
*         CALL ENQUADS;           /* ENQ ON SYS1.UADS        @Z40NQKC*/ 02928000
*                                                                  0897 02929000
         BAL   @14,ENQUADS                                         0897 02930000
*         RFY (RTNREG) RSTD;                               /*@Z40RQKC*/ 02931000
*         GEN(FIND  UADSDCB,FINDNAME,D); /* FIND MEMBER ADDR ON D.A.    02932000
*                                    DEVICE                          */ 02933000
         FIND  UADSDCB,FINDNAME,D                                       02934000
*         RETCODE = RTNREG;       /* SAVE RETURN CODE FROM FIND      */ 02935000
         ST    RTNREG,RETCODE                                      0900 02936000
*         RFY (RTNREG) UNRSTD;                             /*@Z40RQKC*/ 02937000
*         CALL DEQUADS;           /* DEQ FROM SYS1.UADS      @Z40NQKC*/ 02938000
*                                                                  0902 02939000
*                                                                  0902 02940000
         BAL   @14,DEQUADS                                         0902 02941000
*         IF RETCODE ^= 0         /* IF MEMBER WAS NOT LOCATED,    0903 02942000
*                                    TEST FOR ERROR CONDITIONS       */ 02943000
*           THEN                                                   0903 02944000
         L     @08,RETCODE                                         0903 02945000
         LTR   @08,@08                                             0903 02946000
         BZ    @RF00903                                            0903 02947000
*             DO;                                                  0904 02948000
*                                                                  0904 02949000
*                                                                  0904 02950000
*               IF RETCODE = 4    /* IF MEMBER WAS NOT FOUND,      0905 02951000
*                                    SEND 'INCONSISTENT AUTHORIZATION   02952000
*                                    DATA' MESSAGE TO TERMINAL USER  */ 02953000
*                 THEN                                             0905 02954000
         C     @08,@CF00098                                        0905 02955000
         BNE   @RF00905                                            0905 02956000
*                   DO;                                            0906 02957000
*                                                                  0906 02958000
*                     TEXTINT1(1) = ADDR(LWPUSERI);        /*@Z40NQKC*/ 02959000
*                                                                  0907 02960000
         L     @08,LWPPTR                                          0907 02961000
         LA    @08,LWPUSERI(,@08)                                  0907 02962000
         ST    @08,TEXTINT1                                        0907 02963000
*                     PMSGNM = 33;                                 0908 02964000
         MVC   PMSGNM(2),@CH03117                                  0908 02965000
*                     CALL LGM;   /* SEND ERROR MESSAGE              */ 02966000
         BAL   @14,LGM                                             0909 02967000
*                     NOPRMPT = '1'B; /* NO PROMPT PROCESSING TO BE     02968000
*                                    PERFORMED SO THAT NECESSARY   0910 02969000
*                                    CLEANUP CALL BE PERFORMED       */ 02970000
         OI    NOPRMPT,B'00100000'                                 0910 02971000
*                     RETURN TO CLEANUP0;                          0911 02972000
         LA    @14,CLEANUP0                                        0911 02973000
         LM    @15,@12,@SA00008+4                                  0911 02974000
         BR    @14                                                 0911 02975000
*                   END;                                           0912 02976000
*                 ELSE                                             0913 02977000
*                   GOTO RTNIOERR; /* IF I/O ERROR IN FIND,        0913 02978000
*                                    RETURN TO I/O ERROR ROUTINE     */ 02979000
*             END;                                                 0914 02980000
*                                                                  0914 02981000
*                                                                  0914 02982000
*         IOSWC = '0'B;           /* INITIALIZE IOSWC TO ZERO,     0915 02983000
*                                    INDICATING THAT NO I/O ERROR  0915 02984000
*                                    HAS OCCURED.                    */ 02985000
@RF00903 NI    IOSWC,B'01111111'                                   0915 02986000
*         GEN(READ  UADSDECB,SF,(DCBPTR),(BUFRPTR),,,,MF=E); /*    0916 02987000
*                                    READ UADS MEMBER FROM UADS      */ 02988000
         READ  UADSDECB,SF,(DCBPTR),(BUFRPTR),,,,MF=E                   02989000
*         GEN(CHECK UADSDECB);    /* CHECK READ FOR COMPLETION       */ 02990000
*                                                                  0917 02991000
         CHECK UADSDECB                                                 02992000
*         /***********************************************************/ 02993000
*         /*      IF WE HAD AN I/O ERROR IN TRYING TO READ A         */ 02994000
*         /*      RECORD, THE SYNAD ROUTINE SET IOSWC BIT TO ONE.    */ 02995000
*         /*      IN THAT CASE RETURN TO SEND ERROR MESSAGE TO       */ 02996000
*         /*      TERMINAL AND CANCEL SESSION.                       */ 02997000
*         /***********************************************************/ 02998000
*                                                                  0918 02999000
*         IF IOSWC = '1'B         /* IF IOSWC SET BY SYNAD ROUTINE   */ 03000000
*           THEN                                                   0918 03001000
         TM    IOSWC,B'10000000'                                   0918 03002000
         BNO   @RF00918                                            0918 03003000
*RTNIOERR:                                                         0919 03004000
*                                                                  0919 03005000
*             RETURN TO IOERROR;  /* THEN RETURN TO IO ERROR         */ 03006000
RTNIOERR LA    @14,IOERROR                                         0919 03007000
         LM    @15,@12,@SA00008+4                                  0919 03008000
         BR    @14                                                 0919 03009000
*       END;                                                       0920 03010000
*                                                                  0920 03011000
*                                                                  0920 03012000
@RF00918 DS    0H                                                  0921 03013000
*   GO TO INDIRECT;               /* BRANCH TO PREDETERMINED       0921 03014000
*                                    ROUTINE                         */ 03015000
@RF00889 BR    NEXTADDR                                            0921 03016000
*STOREOFF:                                                         0922 03017000
*                                                                  0922 03018000
*         /***********************************************************/ 03019000
*       /*    LOCATE OFFSET BLOCK                                    */ 03020000
*         /***********************************************************/ 03021000
*                                                                  0922 03022000
*   DATAADDR = BUFRPTR + (UADSNNEX//DCBBLKSI); /* GET ADDRESS OF   0922 03023000
*                                    OFFSET BLOCK                    */ 03024000
STOREOFF L     @00,UADSNNEX-1                                      0922 03025000
         N     @00,@CF03266                                        0922 03026000
         SRDA  @00,32                                              0922 03027000
         LH    DATAADDR,DCBBLKSI                                   0922 03028000
         DR    @00,DATAADDR                                        0922 03029000
         ALR   @00,BUFRPTR                                         0922 03030000
         LR    DATAADDR,@00                                        0922 03031000
*   UADSNODE(1:12) = FIELD;       /* MOVE OFFSET DATA FROM UADS    0923 03032000
*                                    BUFFER TO OFFSET IMAGE BLOCK    */ 03033000
*                                                                  0923 03034000
*                                                                  0923 03035000
         MVC   UADSNODE(12),FIELD(DATAADDR)                        0923 03036000
*   IF UADSNDAT = 0               /* IF INSTALLATION DOES NOT      0924 03037000
*                                    SUPPORT THIS FIELD, RETURN TO 0924 03038000
*                                    IKJEFLE                         */ 03039000
*     THEN                                                         0924 03040000
         L     @08,UADSNDAT                                        0924 03041000
         LTR   @08,@08                                             0924 03042000
         BZ    @RT00924                                            0924 03043000
*       GO TO ENDFIND;                                             0925 03044000
*                                                                  0926 03045000
*   /*****************************************************************/ 03046000
*   /*         SECOND ENTRY TO FIND TO GET DATA ONLY                 */ 03047000
*   /*****************************************************************/ 03048000
*                                                                  0926 03049000
*FIND1: ENTRY;                                                     0926 03050000
*                                                                  0926 03051000
         B     @EC00926                                            0926 03052000
FIND1    STM   @14,@12,@SA00008                                    0926 03053000
@EC00926 DS    0H                                                  0927 03054000
*   DATAADDR = UADSNDAT;          /* GET OFFSET TO DATA FIELD        */ 03055000
         L     DATAADDR,UADSNDAT                                   0927 03056000
*   NEXTADDR = ADDR(STORDATA);    /* GET ADDRESS OF ROUTINE TO STORE    03057000
*                                    THE IN-BUFFER DATA ADDRESS      */ 03058000
         LA    NEXTADDR,STORDATA                                   0928 03059000
*   GO TO FINDBLOK;               /* BRANCH TO READ DATA BLOCK       */ 03060000
         B     FINDBLOK                                            0929 03061000
*STORDATA:                                                         0930 03062000
*                                                                  0930 03063000
*   /*****************************************************************/ 03064000
*   /*       LOCATE DATA BLOCK                                       */ 03065000
*   /*****************************************************************/ 03066000
*                                                                  0930 03067000
*   UADSBUFR = UADSNDAT//DCBBLKSI;/* FIND OFFSET OF DATA BLOCK     0930 03068000
*                                    INTO THE UADS INPUT BUFFER      */ 03069000
STORDATA L     @00,UADSNDAT                                        0930 03070000
         SRDA  @00,32                                              0930 03071000
         LH    @08,DCBBLKSI                                        0930 03072000
         DR    @00,@08                                             0930 03073000
         ST    @00,UADSBUFR                                        0930 03074000
*   UADSBUFR = UADSBUFR + BUFRPTR;/* FIND ACTUAL IN-CORE ADDRESS   0931 03075000
*                                    OF THE DATA BLOCK               */ 03076000
         ALR   @00,BUFRPTR                                         0931 03077000
         ST    @00,UADSBUFR                                        0931 03078000
*   RESPECIFY (DATAADDR,NEXTADDR,BUFRPTR,BLOCKNUM,NBLKNUM,DCBPTR,  0932 03079000
*             MEMBRPTR) UNRSTD;                                    0932 03080000
*ENDFIND:                                                          0933 03081000
*                                                                  0933 03082000
*   RETURN;                       /* RETURN TO CALLER                */ 03083000
*                                                                  0933 03084000
@EL00008 DS    0H                                                  0933 03085000
@EF00008 DS    0H                                                  0933 03086000
@ER00008 LM    @14,@12,@SA00008                                    0933 03087000
         BR    @14                                                 0933 03088000
*   /*****************************************************************/ 03089000
*   /*                   SYNAD ERROR ROUTINE --                      */ 03090000
*   /*****************************************************************/ 03091000
*   /*     A PERMANENT I/O ERROR HAS OCCURED WHILE TRYING TO READ    */ 03092000
*   /*     A RECORD FROM THE UADS IN THE INTERNAL PROCEDURE, FIND.   */ 03093000
*   /*     NO ERROR MESSAGES WILL BE SENT TO THE USER'S TERMINAL     */ 03094000
*   /*     NOR TO THE OPERATORS CONSOLE FROM THIS ROUTINE. A SWITCH  */ 03095000
*   /*     WILL BE SET WHICH FIND EXAMINES AFTER ISSUING THE CHECK   */ 03096000
*   /*     MACRO. FIND WILL THEN RETURN TO A ROUTINE WHICH WILL      */ 03097000
*   /*     PROCESS THE ERROR.                                        */ 03098000
*   /*****************************************************************/ 03099000
*                                                                  0934 03100000
*SYNAD:                                                            0934 03101000
*                                                                  0934 03102000
*   IOSWC = '1'B;                 /* SET I/O ERROR SWITCH TO INDICATE   03103000
*                                    THAT AN I/O ERROR HAS OCCURED.  */ 03104000
*                                                                  0934 03105000
SYNAD    OI    IOSWC,B'10000000'                                   0934 03106000
*   /*****************************************************************/ 03107000
*/*           R  RETURN TO SUPERVISOR                                */ 03108000
*   /*****************************************************************/ 03109000
*                                                                  0935 03110000
*   GEN(BR    @14);               /* RETURN TO CHECK ROUTINE.        */ 03111000
*                                                                  0935 03112000
         BR    @14                                                      03113000
*END FIND;                        /* END OF INTERNAL PROCEDURE FIND  */ 03114000
         B     @EL00008                                            0936 03115000
*/********************************************************************/ 03116000
*/*                                                                  */ 03117000
*/*SEGMENT-                                                          */ 03118000
*/*          ENQUADS                                                 */ 03119000
*/*                                                                  */ 03120000
*/*FUNCTION-                                                         */ 03121000
*/*          ENQUE ON SYSIKJUA.OPENUADS WHILE READING SYS1.UADS.     */ 03122000
*/*                                                                  */ 03123000
*/*CHANGE ACTIVITY-                                                  */ 03124000
*/*      @Z40NQKC-                                                   */ 03125000
*/*          SEPARATE SEGMENT CREATED DUE TO THE PHYSICAL NUMBER OF  */ 03126000
*/*          ENQS IN THIS MODULE                                     */ 03127000
*/*                                                                  */ 03128000
*/********************************************************************/ 03129000
*                                                                  0937 03130000
*ENQUADS:                                                          0937 03131000
*        PROCEDURE;                                                0937 03132000
*                                                                  0937 03133000
ENQUADS  STM   @14,@12,12(@13)                                     0937 03134000
*   DO;  /*ENQ (SYSIKJUA,OPENENQ,S,LENGTH(OPENENQ),SYSTEM)*/       0938 03135000
*   RESPECIFY (GPR01P) RESTRICTED;                                 0939 03136000
*   I056(1:20)=I056(1:20) &&I056(1:20);  /*ZERO OUT THE TABLE*/    0940 03137000
         XC    I056(20),I056                                       0940 03138000
*   I05604(1)=LENGTH(OPENENQ);  /*LENGTH OF MINOR RESOURCE NAME*/  0941 03139000
         MVI   I05604,X'08'                                        0941 03140000
*   I05606(1)=ADDR(SYSIKJUA);  /*ADDRESS OF MAJOR RESOURCE NAME*/  0942 03141000
         LA    @08,SYSIKJUA                                        0942 03142000
         ST    @08,I05606                                          0942 03143000
*   I05607(1)=ADDR(OPENENQ);  /*ADDRESS OF MINOR RESOURCE NAME*/   0943 03144000
         LA    @08,OPENENQ                                         0943 03145000
         ST    @08,I05607                                          0943 03146000
*   I05603(1)='01000000'B;  /*SET BIT STRING 1 FOR RESOURCE ELEMENT*/   03147000
         MVI   I05603,B'01000000'                                  0944 03148000
*   I05605(1)='11000000'B;  /*SET BIT STRING 2 FOR RESOURCE ELEMENT*/   03149000
         MVI   I05605,B'11000000'                                  0945 03150000
*   I05603(1,1)='1'B;  /*SET END OF LIST BIT*/                     0946 03151000
         OI    I05603,B'10000000'                                  0946 03152000
*   GPR01P=ADDR(I05602);  /*LOAD LIST ADDRESS*/                    0947 03153000
         LA    GPR01P,I05602                                       0947 03154000
*   SVC (56);  /*ISSUE ENQ SVC*/                                   0948 03155000
         SVC   56                                                  0948 03156000
*   RESPECIFY (GPR01P) UNRESTRICTED;                               0949 03157000
*   END;  /*ENQ (SYSIKJUA,OPENENQ,S,LENGTH(OPENENQ),SYSTEM)*/      0950 03158000
*                                                                  0950 03159000
*END ENQUADS;                                                      0951 03160000
@EL00009 DS    0H                                                  0951 03161000
@EF00009 DS    0H                                                  0951 03162000
@ER00009 LM    @14,@12,12(@13)                                     0951 03163000
         BR    @14                                                 0951 03164000
*/********************************************************************/ 03165000
*/*                                                                  */ 03166000
*/*SEGMENT-                                                          */ 03167000
*/*          DEQUADS                                                 */ 03168000
*/*                                                                  */ 03169000
*/*FUNCTION-                                                         */ 03170000
*/*          CONDITIONALLY DEQ FROM SYSIKJUA.OPENUADS                */ 03171000
*/*                                                                  */ 03172000
*/*CHANGE ACTIVITY-                                                  */ 03173000
*/*      @Z40NQKC-                                                   */ 03174000
*/*          SEPARATE SEGMENT CREATED DUE TO THE PHYSICAL NUMBER OF  */ 03175000
*/*          DEQS IN THIS MODULE                                     */ 03176000
*/*                                                                  */ 03177000
*/********************************************************************/ 03178000
*                                                                  0952 03179000
*DEQUADS:                                                          0952 03180000
*        PROCEDURE;                                                0952 03181000
*                                                                  0952 03182000
DEQUADS  STM   @14,@12,12(@13)                                     0952 03183000
*   DO; /* DEQ (SYSIKJUA,OPENENQ,LENGTH(OPENENQ),SYSTEM) RET(HAVE)*/    03184000
*      I048(1:20)=I048(1:20)&&I048(1:20);                          0954 03185000
         XC    I048(20),I048                                       0954 03186000
*      RFY GPR01F RESTRICTED;                                      0955 03187000
*      I04804(1)='11000000'B;     /*LISTEND BYTE*/                 0956 03188000
         MVI   I04804,B'11000000'                                  0956 03189000
*      I04805(1)=LENGTH(OPENENQ);   /*SET LENGTH*/                 0957 03190000
         MVI   I04805,X'08'                                        0957 03191000
*      I04806(1)='01000001'B;    /*OPTIONS*/                       0958 03192000
         MVI   I04806,B'01000001'                                  0958 03193000
*      I04807(1)=ADDR(SYSIKJUA);   /*QNAME ADDRESS*/               0959 03194000
         LA    @08,SYSIKJUA                                        0959 03195000
         ST    @08,I04807                                          0959 03196000
*      I04808(1)=ADDR(OPENENQ);   /*RNAME ADDRESS*/                0960 03197000
         LA    @08,OPENENQ                                         0960 03198000
         ST    @08,I04808                                          0960 03199000
*      GPR01F=ADDR(I04802);                                        0961 03200000
         LA    GPR01F,I04802                                       0961 03201000
*      SVC  (48);                                                  0962 03202000
         SVC   48                                                  0962 03203000
*      RFY GPR01F UNRESTRICTED;                                    0963 03204000
*   END; /* DEQ (SYSIKJUA,OPENENQ,LENGTH(OPENENQ),SYSTEM) RET(HAVE)*/   03205000
*                                                                  0964 03206000
*END DEQUADS;                                                      0965 03207000
@EL00010 DS    0H                                                  0965 03208000
@EF00010 DS    0H                                                  0965 03209000
@ER00010 LM    @14,@12,12(@13)                                     0965 03210000
         BR    @14                                                 0965 03211000
*/********************************************************************/ 03212000
*/*                                                                  */ 03213000
*/*SEGMENT-                                                          */ 03214000
*/*          RACVERFY                                                */ 03215000
*/*                                                                  */ 03216000
*/*FUNCTION-                                                         */ 03217000
*/*          INTERFACE WITH RACINIT TO VERIFY USERID,PASSWORD,GROUP  */ 03218000
*/*          AND NEW PASSWORD                                        */ 03219000
*/*                                                                  */ 03220000
*/*CHANGE ACTIVITY-                                                  */ 03221000
*/*      @Z40RQKC-                                                   */ 03222000
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */ 03223000
*/*                                                                  */ 03224000
*/********************************************************************/ 03225000
*RACVERFY:                                                         0966 03226000
*        PROCEDURE;                                                0966 03227000
*                                                                  0966 03228000
*                                                                  0966 03229000
RACVERFY STM   @14,@12,@SA00011                                    0966 03230000
*   CALL RACINIT;                    /* INVOKE RACINIT               */ 03231000
*                                                                  0967 03232000
         BAL   @14,RACINIT                                         0967 03233000
* ONCEMORE:                          /*                      @G32OPKU*/ 03234000
*   DO WHILE RETCODE = OIDREQD |     /* OIDCARD REQUIRED     @G32OPKU*/ 03235000
*            RETCODE = OIDINV;       /* OIDCARD INVALID      @G32OPKU*/ 03236000
ONCEMORE B     @DE00968                                            0968 03237000
@DL00968 DS    0H                                                  0969 03238000
*     IF LWANORDR = NO  &            /* IF TERMINAL TYPE     @G32OPKU*/ 03239000
*               BADVERFY = NO        /* SUPPORTS OIDCARD RDR @G32OPKU*/ 03240000
*       THEN DO;                     /* AND NOT BAD VERIFY   @G32OPKU*/ 03241000
         L     @08,LWAPTR                                          0969 03242000
         TM    LWANORDR(@08),B'01000000'                           0969 03243000
         BNZ   @RF00969                                            0969 03244000
         TM    BADVERFY,B'00000001'                                0969 03245000
         BNZ   @RF00969                                            0969 03246000
*         IF RETCODE = OIDREQD       /* CHECK FOR MESSAGE    @G32OPKU*/ 03247000
*           THEN                     /*                      @G32OPKU*/ 03248000
         CLC   RETCODE(4),@CF00499                                 0971 03249000
         BNE   @RF00971                                            0971 03250000
*             PMSGNM = MSG56434;     /* OIDCARD REQ'D MSG    @G32OPKU*/ 03251000
         MVC   PMSGNM(2),@CH00937                                  0972 03252000
*           ELSE                     /* ASSUME OIDCARD       @G32OPKU*/ 03253000
*             PMSGNM = MSG56433;     /* NOT AUTHORIZED MSG   @G32OPKU*/ 03254000
*                                                                  0973 03255000
         B     @RC00971                                            0973 03256000
@RF00971 MVC   PMSGNM(2),@CH00935                                  0973 03257000
*         CALL OIDVERFY;             /* VERIFY OIDCARD       @G32OPKU*/ 03258000
*                                                                  0974 03259000
@RC00971 BAL   @14,OIDVERFY                                        0974 03260000
*         IF OIDVERRC = ZERO         /* OIDCARD OK ??        @G32OPKU*/ 03261000
*           THEN                     /* YES, NEXT GIVE RACF  @G32OPKU*/ 03262000
         L     @08,OIDVERRC                                        0975 03263000
         LTR   @08,@08                                             0975 03264000
         BNZ   @RF00975                                            0975 03265000
*             CALL RACINIT;          /* A CRACK AT IT        @G32OPKU*/ 03266000
         BAL   @14,RACINIT                                         0976 03267000
*           ELSE                     /* NO,                  @G32OPKU*/ 03268000
*             GOTO CLEANUP4;         /* GOTO ERROR EXIT      @G32OPKU*/ 03269000
*       END;                                                       0978 03270000
*     ELSE                           /*                      @G32OPKU*/ 03271000
*       GOTO CLEANUP4;               /* NO SUPPORT FOR RDR   @G32OPKU*/ 03272000
*   END;                             /* END LOOP FOR OIDCARD @G32OPKU*/ 03273000
@DE00968 L     @08,RETCODE                                         0980 03274000
         C     @08,@CF00499                                        0980 03275000
         BE    @DL00968                                            0980 03276000
         C     @08,@CF00175                                        0980 03277000
         BE    @DL00968                                            0980 03278000
*   LWANORDR = NO;                   /* TURN OFF NO OID RDR  @G32OPKU*/ 03279000
         L     @08,LWAPTR                                          0981 03280000
         NI    LWANORDR(@08),B'10111111'                           0981 03281000
*   BADVERFY = NO;                   /* AND BAD VERIFY       @G32OPKU*/ 03282000
         NI    BADVERFY,B'11111110'                                0982 03283000
*                                    /* RETURN CODE BITS AS THERE    */ 03284000
*                                    /* WILL NOT BE ANOTHER OIDCARD  */ 03285000
*                                    /* CHECK ---- AS PER SPECS      */ 03286000
*   DO WHILE RETCODE ^= ZERO &       /* NOT SUCCESSFUL               */ 03287000
*            RETCODE ^= NORACF &     /* RACF IS ACTIVE               */ 03288000
*            RETCODE ^= NOPROF;      /* PROFILE FOR USERID           */ 03289000
*                                                                  0983 03290000
         B     @DE00983                                            0983 03291000
@DL00983 DS    0H                                                  0984 03292000
*     IF RETCODE = INVPSWD           /* INVALID PASSWORD             */ 03293000
*       THEN DO;                                                   0984 03294000
         CLC   RETCODE(4),@CF00046                                 0984 03295000
         BNE   @RF00984                                            0984 03296000
*         IF LWPPSWDL = ZERO         /* NO PSWD GOTTEN FROM USER     */ 03297000
*           THEN PMSGNM = ZERO;      /* REQUEST PSWD FROM USER       */ 03298000
         SLR   @08,@08                                             0986 03299000
         L     @01,LWPPTR                                          0986 03300000
         CH    @08,LWPPSWDL(,@01)                                  0986 03301000
         BNE   @RF00986                                            0986 03302000
         STH   @08,PMSGNM                                          0987 03303000
*           ELSE PMSGNM = MSG56421;  /* TRUELY AN INVALID PSWD       */ 03304000
*                                                                  0988 03305000
         B     @RC00986                                            0988 03306000
@RF00986 MVC   PMSGNM(2),@CH00046                                  0988 03307000
*         PRMTSWC =  2 ;             /* PROMPT FOR ANOTHER PASSWORD  */ 03308000
@RC00986 MVC   PRMTSWC(2),@CH00135                                 0989 03309000
*         END;                                                     0990 03310000
*                                                                  0990 03311000
*       ELSE                                                       0991 03312000
*         IF RETCODE = PSWDEXP       /* CURRENT PASSWORD EXPIRED     */ 03313000
*           THEN DO;                                               0991 03314000
         B     @RC00984                                            0991 03315000
@RF00984 CLC   RETCODE(4),@CF00034                                 0991 03316000
         BNE   @RF00991                                            0991 03317000
*             PMSGNM = MSG56415;     /* PASSWORD-EXPIRED MSG         */ 03318000
         MVC   PMSGNM(2),@CH00919                                  0993 03319000
*             PRMTSWC = PNPSWD;      /* PROMPT FOR NEW-PASSWORD      */ 03320000
         MVC   PRMTSWC(2),@CH00133                                 0994 03321000
*             END;                                                 0995 03322000
*                                                                  0995 03323000
*           ELSE                                                   0996 03324000
*             IF RETCODE = INVNPSWD  /* INVALID NEW PASSWORD         */ 03325000
*               THEN DO;                                           0996 03326000
         B     @RC00991                                            0996 03327000
@RF00991 CLC   RETCODE(4),@CF00145                                 0996 03328000
         BNE   @RF00996                                            0996 03329000
*                 PMSGNM = MSG56414; /* INVALID NEW-PASSWORD MSG     */ 03330000
         MVC   PMSGNM(2),@CH00601                                  0998 03331000
*                 PRMTSWC = PNPSWD;  /* PROMPT FOR NEW-PASSWORD      */ 03332000
         MVC   PRMTSWC(2),@CH00133                                 0999 03333000
*                 END;                                             1000 03334000
*                                                                  1000 03335000
*               ELSE                                               1001 03336000
*                 IF RETCODE = INVGROUP /* INVALID GROUP             */ 03337000
*                   THEN DO;                                       1001 03338000
         B     @RC00996                                            1001 03339000
@RF00996 CLC   RETCODE(4),@CF00340                                 1001 03340000
         BNE   @RF01001                                            1001 03341000
*                     PRMTSWC = PGROUP; /* PROMPT FOR GROUP          */ 03342000
         MVC   PRMTSWC(2),@CH00046                                 1003 03343000
*                     TEXTINT1(1) = ADDR(LWPGRPI); /* GROUP INSERT   */ 03344000
         L     @08,LWPPTR                                          1004 03345000
         LA    @08,LWPGRPI(,@08)                                   1004 03346000
         ST    @08,TEXTINT1                                        1004 03347000
*                     PMSGNM = MSG56417;/* INVALID GROUP MSG         */ 03348000
         MVC   PMSGNM(2),@CH00923                                  1005 03349000
*                     END;                                         1006 03350000
*                                                                  1006 03351000
*                   ELSE                   /*                @G32OPKU*/ 03352000
*                     IF RETCODE = GROUPREV/* IF GROUP ACCESS REVOKED*/ 03353000
*                       THEN DO;           /* PROMPT FOR NEW GROUP   */ 03354000
         B     @RC01001                                            1007 03355000
@RF01001 CLC   RETCODE(4),@CF00497                                 1007 03356000
         BNE   @RF01007                                            1007 03357000
*                         PRMTSWC = PGROUP;/* WANT PROMPT FOR GR     */ 03358000
         MVC   PRMTSWC(2),@CH00046                                 1009 03359000
*                         PMSGNM = MSG56438;/* GROUP REVOKED MSG     */ 03360000
         MVC   PMSGNM(2),@CH00944                                  1010 03361000
*                         END;             /*                @G32POKU*/ 03362000
*                       ELSE               /*                @G32OPKU*/ 03363000
*                         IF RETCODE = OIDREQD | /* OID REQD?@G32OPKU*/ 03364000
*                            RETCODE = OIDINV /* OR INVALID ?@G32OPKU*/ 03365000
*                              THEN           /* YES ,START  @G32OPKU*/ 03366000
         B     @RC01007                                            1012 03367000
@RF01007 L     @08,RETCODE                                         1012 03368000
         C     @08,@CF00499                                        1012 03369000
         BE    @RT01012                                            1012 03370000
         C     @08,@CF00175                                        1012 03371000
         BE    @RT01012                                            1012 03372000
*                                GOTO ONCEMORE;/* OVER AT TOP@G32OPKU*/ 03373000
*                              ELSE GO TO CLEANUP4;                1014 03374000
         B     CLEANUP4                                            1014 03375000
*      CALL PROMPT;                  /* PROMPT THE USER              */ 03376000
*                                                                  1015 03377000
@RC01007 DS    0H                                                  1015 03378000
@RC01001 DS    0H                                                  1015 03379000
@RC00996 DS    0H                                                  1015 03380000
@RC00991 DS    0H                                                  1015 03381000
@RC00984 BAL   @14,PROMPT                                          1015 03382000
*      CALL RACINIT;                 /* INVOKE RACINIT AGAIN         */ 03383000
         BAL   @14,RACINIT                                         1016 03384000
*    END;                                                          1017 03385000
*                                                                  1017 03386000
@DE00983 L     @08,RETCODE                                         1017 03387000
         LTR   @08,@08                                             1017 03388000
         BZ    @DC00983                                            1017 03389000
         C     @08,@CF00357                                        1017 03390000
         BE    @DC00983                                            1017 03391000
         C     @08,@CF00098                                        1017 03392000
         BNE   @DL00983                                            1017 03393000
@DC00983 DS    0H                                                  1018 03394000
*END RACVERFY;                                                     1018 03395000
@EL00011 DS    0H                                                  1018 03396000
@EF00011 DS    0H                                                  1018 03397000
@ER00011 LM    @14,@12,@SA00011                                    1018 03398000
         BR    @14                                                 1018 03399000
*/********************************************************************/ 03400000
*/*                                                                  */ 03401000
*/*SEGMENT-                                                          */ 03402000
*/*          RACINIT                                                 */ 03403000
*/*                                                                  */ 03404000
*/*FUNCTION-                                                         */ 03405000
*/*          INVOKE RACF TO BUILD SECURITY RELATED CNTL BLOCKS       */ 03406000
*/*                                                                  */ 03407000
*/*OPERATION-                                                        */ 03408000
*/*          THE GROUP-ID WILL ARBITRARILY BE CHANGED AFTER UADS     */ 03409000
*/*          VERIFICATION IS COMPLETE JUST IN CASE A NEW GROUP WAS   */ 03410000
*/*          ENTERED WHEN THE USER WAS BEING PROMPTED FOR SOMETHING  */ 03411000
*/*          ELSE                                                    */ 03412000
*/*                                                                  */ 03413000
*/*          A DUMMY RACINIT WILL BE DONE AFTER UADS-VERIFICATION    */ 03414000
*/*          IS COMPLETE IF THE USER IS NOT RACF DEFINED             */ 03415000
*/*                                                                  */ 03416000
*/*          RACINITS WITH USERID,PASSWORD,GROUP,AND NEW PASSWORD    */ 03417000
*/*          WILL BE DONE DEPENDING ON WHAT IS IN IKJEFLWP WHICH     */ 03418000
*/*          REFLECTS WHAT WAS ENTERED ON THE LOGON COMMAND          */ 03419000
*/*                                                                  */ 03420000
*/*CHANGE ACTIVITY-                                                  */ 03421000
*/*      @Z40RQKC-                                                   */ 03422000
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */ 03423000
*/*                                                                  */ 03424000
*/********************************************************************/ 03425000
*RACINIT:                                                          1019 03426000
*        PROCEDURE;                                                1019 03427000
*                                                                  1019 03428000
RACINIT  STM   @14,@12,@SA00012                                    1019 03429000
*   RFY (GPR15P) RSTD;                                             1020 03430000
*   STATUS = ZERO;                   /* ZERO FOR STATUS              */ 03431000
*                                                                  1021 03432000
         SLR   @14,@14                                             1021 03433000
         ST    @14,STATUS                                          1021 03434000
*   DO; /* RACINIT  MF(M,RACLST,COMPLETE)*/                        1022 03435000
*   RACLST = RACLST && RACLST;/*INIT. LIST*/                       1023 03436000
         XC    RACLST(48),RACLST                                   1023 03437000
*   RACLST01 = 48;/*PARM LIST LENGTH*/                             1024 03438000
         MVI   RACLST01,X'30'                                      1024 03439000
*   RACLST02 = '00000000'B;/*RESERVED FIELD*/                      1025 03440000
         MVI   RACLST02,B'00000000'                                1025 03441000
*   RACLST03 = '00000000'B;/*RESERVED FIELD*/                      1026 03442000
         MVI   RACLST03,B'00000000'                                1026 03443000
*   RACLST04 = '00000000'B; /*SET ENVIR FLAGS*/                    1027 03444000
         MVI   RACLST04,B'00000000'                                1027 03445000
*   END; /* RACINIT  MF(M,RACLST,COMPLETE)*/                       1028 03446000
*                                                                  1028 03447000
*   IF CHKGROUP = YES                                              1029 03448000
*     THEN DO;                                                     1029 03449000
         TM    CHKGROUP,B'00000100'                                1029 03450000
         BNO   @RF01029                                            1029 03451000
*       DO; /* RACINIT  MF(E,RACLST,COMPLETE) GROUP(RACGROUP) ENVIR(CHA 03452000
*GE)*/  RACLST = RACLST && RACLST;/*INIT. LIST*/                   1031 03453000
         XC    RACLST(48),RACLST                                   1032 03454000
*       RACLST01 = 48;/*PARM LIST LENGTH*/                         1033 03455000
         MVI   RACLST01,X'30'                                      1033 03456000
*       RACLST02 = '00000000'B;/*RESERVED FIELD*/                  1034 03457000
         MVI   RACLST02,B'00000000'                                1034 03458000
*       RACLST03 = '00000000'B;/*RESERVED FIELD*/                  1035 03459000
         MVI   RACLST03,B'00000000'                                1035 03460000
*       RACLST04 = '01000000'B; /*SET ENVIR FLAGS*/                1036 03461000
         MVI   RACLST04,B'01000000'                                1036 03462000
*       RACLST09 = ADDR(RACGROUP); /*ADDR OF GROUP*/               1037 03463000
         L     @08,LWPPTR                                          1037 03464000
         LA    @08,RACGROUP(,@08)                                  1037 03465000
         ST    @08,RACLST09                                        1037 03466000
*       RESPECIFY GPR01P RESTRICTED;                               1038 03467000
*       GPR01P = ADDR(RACLST); /*ADDR OF RACINIT LIST*/            1039 03468000
         LA    GPR01P,RACLST                                       1039 03469000
*       IF CVTRAC^=0 & RCVTRNA='0'B THEN/*RACF ACTIVE*/            1040 03470000
         L     @08,CVTPTR                                          1040 03471000
         L     @08,CVTRAC(,@08)                                    1040 03472000
         CR    @08,@14                                             1040 03473000
         BE    @RF01040                                            1040 03474000
         TM    RCVTRNA(@08),B'10000000'                            1040 03475000
         BNZ   @RF01040                                            1040 03476000
*       SVC (131); /*ISSUE RACINIT SVC*/                           1041 03477000
         SVC   131                                                 1041 03478000
*       ELSE/*RACF NOT ACTIVE*/                                    1042 03479000
*       DO;                                                        1042 03480000
         B     @RC01040                                            1042 03481000
@RF01040 DS    0H                                                  1043 03482000
*       RFY GPR15P RSTD;                                           1043 03483000
*       GPR15P=32;/*SET RACF NOT ACTIVE RET CODE*/                 1044 03484000
         LA    GPR15P,32                                           1044 03485000
*       RFY GPR15P UNRSTD;                                         1045 03486000
*       END;                                                       1046 03487000
*       RESPECIFY GPR01P UNRESTRICTED;                             1047 03488000
@RC01040 DS    0H                                                  1048 03489000
*       END; /* RACINIT  MF(E,RACLST,COMPLETE) GROUP(RACGROUP) ENVIR(CH 03490000
*NGE)*/                                                            1048 03491000
*       RETCODE = GPR15P;            /* SAVE RETURN CODE             */ 03492000
         ST    GPR15P,RETCODE                                      1049 03493000
*       END;                                                       1050 03494000
*                                                                  1050 03495000
*     ELSE DO;                                                     1051 03496000
         B     @RC01029                                            1051 03497000
@RF01029 DS    0H                                                  1052 03498000
*       IF DUMMYRAC ^= YES           /* DO NORMAL RACINIT            */ 03499000
*         THEN DO;                                                 1052 03500000
         TM    DUMMYRAC,B'00000010'                                1052 03501000
         BO    @RF01052                                            1052 03502000
*           DO; /* RACINIT  MF(M,RACLST) USERID(LWANAME) ENVIR(CREATE)* 03503000
*           RACLST04 = '00000000'B; /*SET ENVIR FLAGS*/            1055 03504000
         MVI   RACLST04,B'00000000'                                1055 03505000
*           RACLST05 = ADDR(LWANAME); /*ADDR OF USERID*/           1056 03506000
         L     @08,LWAPTR                                          1056 03507000
         LA    @08,LWANAME(,@08)                                   1056 03508000
         ST    @08,RACLST05                                        1056 03509000
*           END; /* RACINIT  MF(M,RACLST) USERID(LWANAME) ENVIR(CREATE) 03510000
*/                                                                 1057 03511000
*                                                                  1057 03512000
*           IF LWPPSWDL ^= ZERO      /* PSWD ON LOGON COMMAND        */ 03513000
*             THEN DO;                                             1058 03514000
         SLR   @08,@08                                             1058 03515000
         L     @15,LWPPTR                                          1058 03516000
         CH    @08,LWPPSWDL(,@15)                                  1058 03517000
         BE    @RF01058                                            1058 03518000
*               DO; /* RACINIT  MF(M,RACLST) PASSWRD(RACPSWD)*/    1060 03519000
*               RACLST06 = ADDR(RACPSWD); /*ADDR OF PASSWORD*/     1061 03520000
         LA    @14,RACPSWD(,@15)                                   1061 03521000
         ST    @14,RACLST06                                        1061 03522000
*               END; /* RACINIT  MF(M,RACLST) PASSWRD(RACPSWD)*/   1062 03523000
*                                                                  1062 03524000
*               IF LWPNPSWL ^= ZERO   /* NEW-PSWD ON LOGON CMND      */ 03525000
*                 THEN                                             1063 03526000
         CH    @08,LWPNPSWL(,@15)                                  1063 03527000
         BE    @RF01063                                            1063 03528000
*                   DO; /* RACINIT  MF(M,RACLST) NEWPASS(RACNPSWD)*/    03529000
*                   RACLST10 = ADDR(RACNPSWD); /*ADDR OF NEW PASSWORD*/ 03530000
         LA    @08,RACNPSWD(,@15)                                  1065 03531000
         ST    @08,RACLST10                                        1065 03532000
*                   END; /* RACINIT  MF(M,RACLST) NEWPASS(RACNPSWD)*/   03533000
*               END;                                               1067 03534000
*                                                                  1067 03535000
@RF01063 DS    0H                                                  1068 03536000
*           IF ROIDLEN ^= ZERO       /* OIDCARD AVAILABLE    @G32OPKU*/ 03537000
*             THEN                   /*                      @G32OPKU*/ 03538000
@RF01058 CLI   ROIDLEN,0                                           1068 03539000
         BE    @RF01068                                            1068 03540000
*                 DO; /* RACINIT  MF(M,RACLST) OIDCARD(RACOID)*/   1069 03541000
*                 RACLST13 = ADDR(RACOID); /*ADDR OF MAGNETIC STRIP INF 03542000
**/               END; /* RACINIT  MF(M,RACLST) OIDCARD(RACOID)*//*     03543000
*G32OPKU*/                                                         1070 03544000
*                                                                  1070 03545000
         LA    @08,RACOID                                          1070 03546000
         ST    @08,RACLST13                                        1070 03547000
*           IF LWPGRPL ^= ZERO       /* GROUP ON LOGON COMMAND       */ 03548000
*             THEN                                                 1072 03549000
@RF01068 L     @08,LWPPTR                                          1072 03550000
         LH    @15,LWPGRPL(,@08)                                   1072 03551000
         LTR   @15,@15                                             1072 03552000
         BZ    @RF01072                                            1072 03553000
*               DO; /* RACINIT  MF(M,RACLST) GROUP(RACGROUP)*/     1073 03554000
*               RACLST09 = ADDR(RACGROUP); /*ADDR OF GROUP*/       1074 03555000
         LA    @08,RACGROUP(,@08)                                  1074 03556000
         ST    @08,RACLST09                                        1074 03557000
*               END; /* RACINIT  MF(M,RACLST) GROUP(RACGROUP)*/    1075 03558000
*           END;                                                   1076 03559000
*                                                                  1076 03560000
@RF01072 DS    0H                                                  1077 03561000
*       DO; /* RACINIT  MF(M,RACLST) TERMID(TSBTRMID)*/            1077 03562000
@RF01052 DS    0H                                                  1078 03563000
*       RACLST14 = ADDR(TSBTRMID); /*ADDR OF TERMINAL ID INFO*/    1078 03564000
         L     @08,TSBPTR                                          1078 03565000
         LA    @08,TSBTRMID(,@08)                                  1078 03566000
         ST    @08,RACLST14                                        1078 03567000
*       END; /* RACINIT  MF(M,RACLST) TERMID(TSBTRMID)*//*         1079 03568000
*G32OPKU*/                                                         1079 03569000
*                                                                  1079 03570000
*       DO; /* RACINIT  MF(E,RACLST)*/                             1080 03571000
*       RACLST01 = 48;/*PARM LIST LENGTH*/                         1081 03572000
         MVI   RACLST01,X'30'                                      1081 03573000
*       RACLST02 = '00000000'B;/*RESERVED FIELD*/                  1082 03574000
         MVI   RACLST02,B'00000000'                                1082 03575000
*       RACLST03 = '00000000'B;/*RESERVED FIELD*/                  1083 03576000
         MVI   RACLST03,B'00000000'                                1083 03577000
*       RACLST04 = '00000000'B; /*SET ENVIR FLAGS*/                1084 03578000
         MVI   RACLST04,B'00000000'                                1084 03579000
*       RESPECIFY GPR01P RESTRICTED;                               1085 03580000
*       GPR01P = ADDR(RACLST); /*ADDR OF RACINIT LIST*/            1086 03581000
         LA    GPR01P,RACLST                                       1086 03582000
*       IF CVTRAC^=0 & RCVTRNA='0'B THEN/*RACF ACTIVE*/            1087 03583000
         L     @08,CVTPTR                                          1087 03584000
         L     @08,CVTRAC(,@08)                                    1087 03585000
         LTR   @08,@08                                             1087 03586000
         BZ    @RF01087                                            1087 03587000
         TM    RCVTRNA(@08),B'10000000'                            1087 03588000
         BNZ   @RF01087                                            1087 03589000
*       SVC (131); /*ISSUE RACINIT SVC*/                           1088 03590000
         SVC   131                                                 1088 03591000
*       ELSE/*RACF NOT ACTIVE*/                                    1089 03592000
*       DO;                                                        1089 03593000
         B     @RC01087                                            1089 03594000
@RF01087 DS    0H                                                  1090 03595000
*       RFY GPR15P RSTD;                                           1090 03596000
*       GPR15P=32;/*SET RACF NOT ACTIVE RET CODE*/                 1091 03597000
         LA    GPR15P,32                                           1091 03598000
*       RFY GPR15P UNRSTD;                                         1092 03599000
*       END;                                                       1093 03600000
*       RESPECIFY GPR01P UNRESTRICTED;                             1094 03601000
@RC01087 DS    0H                                                  1095 03602000
*       END; /* RACINIT  MF(E,RACLST)*/                            1095 03603000
*                                                                  1095 03604000
*       RETCODE = GPR15P;            /* SAVE RACINIT ERROR           */ 03605000
         ST    GPR15P,RETCODE                                      1096 03606000
*       END;                                                       1097 03607000
*   RESPECIFY (GPR15P) UNRSTD;                                     1098 03608000
*                                                                  1098 03609000
@RC01029 DS    0H                                                  1099 03610000
*   IF RETCODE ^= ZERO               /* ERROR IN RACINIT             */ 03611000
*     THEN DO;                                                     1099 03612000
         L     @08,RETCODE                                         1099 03613000
         LTR   @08,@08                                             1099 03614000
         BZ    @RF01099                                            1099 03615000
*       IF RETCODE = NOPROF |        /* NON RACF USER                */ 03616000
*          RETCODE = NORACF          /* RACF IS NOT ACTIVE           */ 03617000
*         THEN STATUS = CONTINUE;    /* NOT A RACF ERROR             */ 03618000
         C     @08,@CF00098                                        1101 03619000
         BE    @RT01101                                            1101 03620000
         C     @08,@CF00357                                        1101 03621000
         BNE   @RF01101                                            1101 03622000
@RT01101 DS    0H                                                  1102 03623000
         SLR   @08,@08                                             1102 03624000
         ST    @08,STATUS                                          1102 03625000
*         ELSE STATUS = RACERROR;    /* A RACF ERROR                 */ 03626000
*                                                                  1103 03627000
         B     @RC01101                                            1103 03628000
@RF01101 MVC   STATUS(4),@CF00037                                  1103 03629000
*       LWARACF = NO;                /* NON RACF USER                */ 03630000
@RC01101 L     @08,LWAPTR                                          1104 03631000
         NI    LWARACF(@08),B'10111111'                            1104 03632000
*       END;                                                       1105 03633000
*                                                                  1105 03634000
*     ELSE DO;                                                     1106 03635000
         B     @RC01099                                            1106 03636000
@RF01099 DS    0H                                                  1107 03637000
*       STATUS = CONTINUE;           /* EVERYTHING IS OK             */ 03638000
         SLR   @08,@08                                             1107 03639000
         ST    @08,STATUS                                          1107 03640000
*       LWARACF = YES;               /* A RACF USER                  */ 03641000
*                                                                  1108 03642000
         L     @08,LWAPTR                                          1108 03643000
         OI    LWARACF(@08),B'01000000'                            1108 03644000
*       CALL SETLOCK;                /* GET CMS LOCK FOR TSB @G32OPKU*/ 03645000
         BAL   @14,SETLOCK                                         1109 03646000
*       TSBSF1 = ACEEGRPN;           /* MOVE IN GROUP NAME   @G32OPKU*/ 03647000
         L     @08,TSBPTR                                          1110 03648000
         L     @01,LWAPTR                                          1110 03649000
         L     @01,LWAPASCB(,@01)                                  1110 03650000
         L     @01,ASCBASXB(,@01)                                  1110 03651000
         L     @01,ACEEPTR(,@01)                                   1110 03652000
         MVC   TSBSF1(8,@08),ACEEGRPN(@01)                         1110 03653000
*       CALL RELLOCK;                /* RELEASE LOCAL/CMS LOC@G32OPKU*/ 03654000
*                                                                  1111 03655000
         BAL   @14,RELLOCK                                         1111 03656000
*       LWPGRPL=ZERO;                /* ZERO RACF GROUP LENGTH FIELD    03657000
*                                       TO PREVENT REDUNDANT RACINIT    03658000
*                                       FOR GROUP AT THE END @Z40RPKU*/ 03659000
         L     @08,LWPPTR                                          1112 03660000
         SLR   @15,@15                                             1112 03661000
         STH   @15,LWPGRPL(,@08)                                   1112 03662000
*       END;                                                       1113 03663000
*                                                                  1113 03664000
*END RACINIT;                                                      1114 03665000
@EL00012 DS    0H                                                  1114 03666000
@EF00012 DS    0H                                                  1114 03667000
@ER00012 LM    @14,@12,@SA00012                                    1114 03668000
         BR    @14                                                 1114 03669000
*/********************************************************************/ 03670000
*/*                                                                  */ 03671000
*/*SEGMENT-                                                          */ 03672000
*/*          VERGROUP                                                */ 03673000
*/*                                                                  */ 03674000
*/*FUNCTION-                                                         */ 03675000
*/*          VERIFY ONLY THE GROUP-ID                                */ 03676000
*/*                                                                  */ 03677000
*/*OPERATION-                                                        */ 03678000
*/*          IF THERE IS A GROUP-ID AND THE USER IS A RACF USER      */ 03679000
*/*          THEN DO A RACINIT TO CHECK THE GROUP-ID.THIS WILL BE    */ 03680000
*/*          AN ENVIRONMENT=CHANGE VERIFICATION.THIS RACINIT IS      */ 03681000
*/*          DONE JUST IN CASE THE GROUP-ID HAS CHANGED DUE TO A     */ 03682000
*/*          PROMPT FOR SOME OTHER KEYWORD AFTER THE INITIAL RACINIT */ 03683000
*/*                                                                  */ 03684000
*/*          IF THE GROUP-ID TO BE VERIFIED IS NOT AUTHORIZED THEN   */ 03685000
*/*          PROMPT FOR A NEW GROUP AND GO TO THE TOP TO REVERIFY    */ 03686000
*/*          EVERYTHING                                              */ 03687000
*/*                                                                  */ 03688000
*/*          IF THE USER IS NOT A RACF USER THEN ISSUE A MESSAGE     */ 03689000
*/*          AND CONTINUE                                            */ 03690000
*/*                                                                  */ 03691000
*/*MESSAGES-                                                         */ 03692000
*/*      IKJ56419-                                                   */ 03693000
*/*          GROUP KEYWORD IS IGNORED FOR NON RACF USER              */ 03694000
*/*                                                                  */ 03695000
*/*      IKJ56426-                                                   */ 03696000
*/*          GROUP IGNORED,RACF NOT IN SYSTEM                        */ 03697000
*/*                                                                  */ 03698000
*/*CHANGE ACTIVITY-                                                  */ 03699000
*/*      @Z40RQKC-                                                   */ 03700000
*/*          NEW SEGMENT FOR VS2 RELEASE 4                           */ 03701000
*/*                                                                  */ 03702000
*/********************************************************************/ 03703000
*VERGROUP:                                                         1115 03704000
*        PROCEDURE;                                                1115 03705000
*                                                                  1115 03706000
VERGROUP STM   @14,@12,@SA00013                                    1115 03707000
*   IF LWPGRPL ^= ZERO               /* GROUP KEYWORD ENTERED        */ 03708000
*     THEN                                                         1116 03709000
         L     @08,LWPPTR                                          1116 03710000
         LH    @08,LWPGRPL(,@08)                                   1116 03711000
         LTR   @08,@08                                             1116 03712000
         BZ    @RF01116                                            1116 03713000
*       IF LWARACF = YES             /* A RACF USER                  */ 03714000
*         THEN DO;                                                 1117 03715000
         L     @08,LWAPTR                                          1117 03716000
         TM    LWARACF(@08),B'01000000'                            1117 03717000
         BNO   @RF01117                                            1117 03718000
*           CHKGROUP = YES;          /* RACINIT WILL CHECK ONLY GROUP*/ 03719000
*                                                                  1119 03720000
         OI    CHKGROUP,B'00000100'                                1119 03721000
*           CALL RACINIT;            /* DO THE RACINIT               */ 03722000
*                                                                  1120 03723000
         BAL   @14,RACINIT                                         1120 03724000
*           CHKGROUP = NO;           /* NO MORE CHECK GROUP          */ 03725000
*                                                                  1121 03726000
         NI    CHKGROUP,B'11111011'                                1121 03727000
*           IF RETCODE = INVGROUP |  /* GROUP IS INVALID FOR USERID  */ 03728000
*                 RETCODE = GROUPREV /* OR GRP ACCESS REVOKED@G32OPKU*/ 03729000
*             THEN DO;                                             1122 03730000
         L     @08,RETCODE                                         1122 03731000
         C     @08,@CF00340                                        1122 03732000
         BE    @RT01122                                            1122 03733000
         C     @08,@CF00497                                        1122 03734000
         BNE   @RF01122                                            1122 03735000
@RT01122 DS    0H                                                  1123 03736000
*               LWARACF = YES;       /* STILL A VALID RACF USER      */ 03737000
         L     @08,LWAPTR                                          1124 03738000
         OI    LWARACF(@08),B'01000000'                            1124 03739000
*               STATUS = CONTINUE;   /* NO RACF ERRORS               */ 03740000
         SLR   @08,@08                                             1125 03741000
         ST    @08,STATUS                                          1125 03742000
*               IF RETCODE = GROUPREV/* GROUP ACCESS REVKED ?@G32OPKU*/ 03743000
*                 THEN               /* PUT OUT MSG - GROUP  @G32OPKU*/ 03744000
         CLC   RETCODE(4),@CF00497                                 1126 03745000
         BNE   @RF01126                                            1126 03746000
*                   PMSGNM = MSG56438;/* ACCESS REVOKED      @G32OPKU*/ 03747000
         MVC   PMSGNM(2),@CH00944                                  1127 03748000
*                 ELSE               /*                      @G32OPKU*/ 03749000
*                   PMSGNM = MSG56417;/* INVALID GROUP MSG           */ 03750000
         B     @RC01126                                            1128 03751000
@RF01126 MVC   PMSGNM(2),@CH00923                                  1128 03752000
*               PRMTSWC = PGROUP;    /* IKJEFLEA WILL PROMPT FOR GRP */ 03753000
@RC01126 MVC   PRMTSWC(2),@CH00046                                 1129 03754000
*               TEXTINT1(1) = ADDR(LWPGRPI);  /* GROUP INSERT        */ 03755000
         L     @08,LWPPTR                                          1130 03756000
         LA    @08,LWPGRPI(,@08)                                   1130 03757000
         ST    @08,TEXTINT1                                        1130 03758000
*               GO TO PRMTACCT;      /* PROMPT AND REVERIFY ALL      */ 03759000
         B     PRMTACCT                                            1131 03760000
*               END;                                               1132 03761000
*                                                                  1132 03762000
*             ELSE                                                 1133 03763000
*               IF RETCODE ^= ZERO   /* ERROR IN RACINIT             */ 03764000
*                 THEN GO TO CLEANUP4; /* TERMINATE                  */ 03765000
@RF01122 L     @08,RETCODE                                         1133 03766000
         LTR   @08,@08                                             1133 03767000
         BNZ   @RT01133                                            1133 03768000
*           END;                                                   1135 03769000
*                                                                  1135 03770000
*         ELSE DO;                                                 1136 03771000
         B     @RC01117                                            1136 03772000
@RF01117 DS    0H                                                  1137 03773000
*           IF CVTRAC = ZERO         /* RACF NOT IN SYSTEM           */ 03774000
*             THEN PMSGNM = MSG56426;/* UNSUPPORTED-KEYWORD MSG      */ 03775000
         L     @08,CVTPTR                                          1137 03776000
         L     @08,CVTRAC(,@08)                                    1137 03777000
         LTR   @08,@08                                             1137 03778000
         BNZ   @RF01137                                            1137 03779000
         MVC   PMSGNM(2),@CH00786                                  1138 03780000
*             ELSE PMSGNM = MSG56419;/* UNAUTHORIZED-USER MSG        */ 03781000
*                                                                  1139 03782000
         B     @RC01137                                            1139 03783000
@RF01137 MVC   PMSGNM(2),@CH00925                                  1139 03784000
*           TEXTINT1(1) = ADDR(INSGROUP); /* GROUP INSERT            */ 03785000
*                                                                  1140 03786000
@RC01137 LA    @08,INSGROUP                                        1140 03787000
         ST    @08,TEXTINT1                                        1140 03788000
*           CALL LGM;                /* SEND MESSAGE                 */ 03789000
         BAL   @14,LGM                                             1141 03790000
*           END;                                                   1142 03791000
*                                                                  1142 03792000
*END VERGROUP;                                                     1143 03793000
@EL00013 DS    0H                                                  1143 03794000
@EF00013 DS    0H                                                  1143 03795000
@ER00013 LM    @14,@12,@SA00013                                    1143 03796000
         BR    @14                                                 1143 03797000
*/********************************************************************/ 03798000
*/*                                                                  */ 03799000
*/*SEGMENT-                                                          */ 03800000
*/*          BLDNUMB                                                 */ 03801000
*/*                                                                  */ 03802000
*/*FUNCTION-                                                         */ 03803000
*/*          BUILD A RETURN CODE TEXT INSERT                         */ 03804000
*/*                                                                  */ 03805000
*/*OPERATION-                                                        */ 03806000
*/*          CONVERT THE RETURN CODE FROM BINARY TO PACKED DECIMAL   */ 03807000
*/*                                                                  */ 03808000
*/*          EDMK WILL CONVERT THE RETURN CODE FROM PACKED DECIMAL   */ 03809000
*/*          TO ZONED DECIMAL AND POINT REGISTER ONE TO THE FIRST    */ 03810000
*/*          SIGNIFICANT CHARACTER                                   */ 03811000
*/*                                                                  */ 03812000
*/*          LEFT JUSTIFY THE RETURN CODE IN THE TEXT FIELD AND      */ 03813000
*/*          UPDATE THE TEXT INSER LENGTH                            */ 03814000
*/*                                                                  */ 03815000
*/*CHANGE ACTIVITY-                                                  */ 03816000
*/*      @Z40RQKC-                                                   */ 03817000
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */ 03818000
*/*                                                                  */ 03819000
*/********************************************************************/ 03820000
*                                                                  1144 03821000
*BLDNUMB:                                                          1144 03822000
*        PROCEDURE(BLD#,BLDINS);                                   1144 03823000
*                                                                  1144 03824000
BLDNUMB  STM   @14,@12,@SA00014                                    1144 03825000
         MVC   @PC00014(8),0(@01)                                  1144 03826000
*DECLARE                                                           1145 03827000
*  1 BLDINS,                         /* THE INSERT                   */ 03828000
*    2 BLDHEAD,                                                    1145 03829000
*      3 BLDLEN FIXED(15),                                         1145 03830000
*      3 BLDOFF FIXED(15),                                         1145 03831000
*    2 BLDTEXT CHAR(16);                                           1145 03832000
*                                                                  1145 03833000
*   CVD(BLD#,CONVERT);               /* BINARY TO PACKED DECIMAL     */ 03834000
         L     @08,@PC00014                                        1146 03835000
         L     @08,BLD#(,@08)                                      1146 03836000
         CVD   @08,CONVERT                                         1146 03837000
*   BLDTEXT = EDITMASK;              /* INITIALIZE THE EDIT MASK     */ 03838000
*                                                                  1147 03839000
         L     @08,@PC00014+4                                      1147 03840000
         MVC   BLDTEXT(16,@08),@CB00466                            1147 03841000
*   RESPECIFY (GPR01P) RSTD;                                       1148 03842000
*   GPR01P = ADDR(BLDTEXT);          /* THE TEXT FIELD               */ 03843000
         LA    GPR01P,BLDTEXT(,@08)                                1149 03844000
*   GEN REFS(CONVERT)                /* EDIT THE RETURN CODE         */ 03845000
*       (EDMK 0(16,1),CONVERT);                                    1150 03846000
         EDMK 0(16,1),CONVERT                                           03847000
*   BLDLEN = LENGTH(BLDTEXT) -       /* ORIGINAL LENGTH              */ 03848000
*            (GPR01P -               /* FIRST NON-ZERO DIGIT         */ 03849000
*             ADDR(BLDTEXT));        /* FIRST ZERO DIGIT             */ 03850000
         L     @08,@PC00014+4                                      1151 03851000
         LA    @15,BLDTEXT(,@08)                                   1151 03852000
         LR    @00,@15                                             1151 03853000
         SLR   @00,GPR01P                                          1151 03854000
         AL    @00,@CF00145                                        1151 03855000
         STH   @00,BLDLEN(,@08)                                    1151 03856000
*   BLDTEXT(1:BLDLEN) =              /* LEFT JUSTIFY THE RETURN CODE */ 03857000
*       BLDTEXT(GPR01P-ADDR(BLDTEXT)+1:LENGTH(BLDTEXT));           1152 03858000
         LR    @14,@00                                             1152 03859000
         BCTR  @14,0                                               1152 03860000
         LCR   @15,@15                                             1152 03861000
         ALR   @15,GPR01P                                          1152 03862000
         ALR   @15,@08                                             1152 03863000
         MVC   @TS00001(16),BLDTEXT(@15)                           1152 03864000
         EX    @14,@SM03270                                        1152 03865000
*   RESPECIFY (GPR01P) UNRSTD;                                     1153 03866000
*                                                                  1153 03867000
*   BLDLEN = BLDLEN +                /* RETURN CODE LENGTH           */ 03868000
*            LENGTH(BLDHEAD);        /* TEXT INSERT HEADER LENGTH    */ 03869000
*                                                                  1154 03870000
         AL    @00,@CF00098                                        1154 03871000
         STH   @00,BLDLEN(,@08)                                    1154 03872000
*END BLDNUMB;                                                      1155 03873000
@EL00014 DS    0H                                                  1155 03874000
@EF00014 DS    0H                                                  1155 03875000
@ER00014 LM    @14,@12,@SA00014                                    1155 03876000
         BR    @14                                                 1155 03877000
*/********************************************************************/ 03878000
*/*                                                                  */ 03879000
*/*SEGMENT-                                                          */ 03880000
*/*          HANDLRAC                                                */ 03881000
*/*                                                                  */ 03882000
*/*FUNCTION-                                                         */ 03883000
*/*          HANDLE RACF ERRORS                                      */ 03884000
*/*                                                                  */ 03885000
*/*MESSAGES-                                                         */ 03886000
*/*      IKJ56413-                                                   */ 03887000
*/*          RACINIT FAILED BY RACINIT-INSTALLATION-EXIT             */ 03888000
*/*                                                                  */ 03889000
*/*      IKJ56414-                                                   */ 03890000
*/*          USER ACCESS REVOKED DUE TO BUSY PROFILE                 */ 03891000
*/*                                                                  */ 03892000
*/*      IKJ56416-                                                   */ 03893000
*/*          ERROR IN RACINIT                                        */ 03894000
*/*                                                                  */ 03895000
*/*CHANGE ACTIVITY-                                                  */ 03896000
*/*      @Z40RQKC-                                                   */ 03897000
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */ 03898000
*/*                                                                  */ 03899000
*/********************************************************************/ 03900000
*HANDLRAC:                                                         1156 03901000
*        PROCEDURE;                                                1156 03902000
*                                                                  1156 03903000
HANDLRAC STM   @14,@12,@SA00015                                    1156 03904000
*   IF RETCODE = RACEXIT                  /* RACF EXIT FAILED RACINIT*/ 03905000
*     THEN                                                         1157 03906000
         CLC   RETCODE(4),@CF00080                                 1157 03907000
         BNE   @RF01157                                            1157 03908000
*       IF LWPRECON = YES                 /* RECONNECT PUTOUT@G32OPKU*/ 03909000
*         THEN                            /* YES, FAIL RECON @G32OPKU*/ 03910000
         L     @08,LWPPTR                                          1158 03911000
         TM    LWPRECON(@08),B'10000000'                           1158 03912000
         BNO   @RF01158                                            1158 03913000
*           PMSGNM = MSG56442;            /* MSG             @G32OPKU*/ 03914000
         MVC   PMSGNM(2),@CH00952                                  1159 03915000
*         ELSE                            /*                 @G32OPKU*/ 03916000
*           PMSGNM = MSG56413;            /* FAIL RACF INIT  @G32OPKU*/ 03917000
         B     @RC01158                                            1160 03918000
@RF01158 MVC   PMSGNM(2),@CH00053                                  1160 03919000
*     ELSE                                                         1161 03920000
*       IF RETCODE = REVOKE               /* PROFILE ALREADY IN USE  */ 03921000
*         THEN                                                     1161 03922000
         B     @RC01157                                            1161 03923000
@RF01157 CLC   RETCODE(4),@CF00490                                 1161 03924000
         BNE   @RF01161                                            1161 03925000
*           IF LWPRECON = YES             /* RECONNECT PUTOUT@G32OPKU*/ 03926000
*             THEN                        /* YES, PUT OUT MSG@G32OPKU*/ 03927000
         L     @08,LWPPTR                                          1162 03928000
         TM    LWPRECON(@08),B'10000000'                           1162 03929000
         BNO   @RF01162                                            1162 03930000
*               PMSGNM = MSG56443;        /* USER REVOKED    @G32OPKU*/ 03931000
         MVC   PMSGNM(2),@CH00954                                  1163 03932000
*             ELSE                        /*                 @G32OPKU*/ 03933000
*               PMSGNM = MSG56425;        /* ACCESS REVOKED  @G32OPKU*/ 03934000
         B     @RC01162                                            1164 03935000
@RF01162 MVC   PMSGNM(2),@CH00928                                  1164 03936000
*         ELSE                              /*               @G32OPKU*/ 03937000
*           IF LWANORDR = YES &             /* NO OIDCARD RDR@G32OPKU*/ 03938000
*              (OIDVERRC = NOTOIDRD |       /* SUPPORT AND OIDCARD   */ 03939000
*               RETCODE = OIDREQD  |        /* REQ'D BY RACINIT      */ 03940000
*               RETCODE = OIDINV)           /* THEN SET MSG  @G32OPKU*/ 03941000
*             THEN                          /* LOGON TERMINATED,OIDCD*/ 03942000
         B     @RC01161                                            1165 03943000
@RF01161 L     @08,LWAPTR                                          1165 03944000
         TM    LWANORDR(@08),B'01000000'                           1165 03945000
         BNO   @RF01165                                            1165 03946000
         CLC   OIDVERRC(4),@CF00098                                1165 03947000
         BE    @RT01165                                            1165 03948000
         L     @08,RETCODE                                         1165 03949000
         C     @08,@CF00499                                        1165 03950000
         BE    @RT01165                                            1165 03951000
         C     @08,@CF00175                                        1165 03952000
         BNE   @RF01165                                            1165 03953000
@RT01165 DS    0H                                                  1166 03954000
*               PMSGNM = MSG56436;          /* NOT SUPPORTED ON THIS */ 03955000
         MVC   PMSGNM(2),@CH00941                                  1166 03956000
*                                           /* TERMINAL      @G32OPKU*/ 03957000
*             ELSE                        /*                 @G32OPKU*/ 03958000
*               IF RETCODE = NOTERMID     /* TERMINAL NOT OK @G32OPKU*/ 03959000
*                 THEN                    /* FOR USER        @G32OPKU*/ 03960000
         B     @RC01165                                            1167 03961000
@RF01165 CLC   RETCODE(4),@CF00502                                 1167 03962000
         BNE   @RF01167                                            1167 03963000
*                   IF LWPRECON = YES     /* RECON REJECTED  @G32OPKU*/ 03964000
*                     THEN                /* PUT OUT MSG     @G32OPKU*/ 03965000
         L     @08,LWPPTR                                          1168 03966000
         TM    LWPRECON(@08),B'10000000'                           1168 03967000
         BNO   @RF01168                                            1168 03968000
*                       PMSGNM = MSG56432;/* USER NOT AUTH   @G32OPKU*/ 03969000
         MVC   PMSGNM(2),@CH00933                                  1169 03970000
*                     ELSE                /* PUT OUT MSG     @G32OPKU*/ 03971000
*                       PMSGNM = MSG56431;/* USER NOT AUTH   @G32OPKU*/ 03972000
*                                                                  1170 03973000
         B     @RC01168                                            1170 03974000
@RF01168 MVC   PMSGNM(2),@CH00931                                  1170 03975000
*                 ELSE DO;                                         1171 03976000
         B     @RC01167                                            1171 03977000
@RF01167 DS    0H                                                  1172 03978000
*                   PMSGNM = MSG56416;    /* A RACINIT ERROR         */ 03979000
         MVC   PMSGNM(2),@CH00921                                  1172 03980000
*                   TEXTINT1(3) =         /* LOGON TERMINATED        */ 03981000
*                      ADDR(INSLOGON);                             1173 03982000
         LA    @08,INSLOGON                                        1173 03983000
         ST    @08,TEXTINT1+8                                      1173 03984000
*                   TEXTINT1(2) =         /* SEND MSG WITH RET CODE  */ 03985000
*                      ADDR(TEXTSEGS(1));                          1174 03986000
         LA    @08,TEXTSEGS                                        1174 03987000
         ST    @08,TEXTINT1+4                                      1174 03988000
*                   IF BADVERFY = YES     /* BAD OID RC ?? @G32OPKU  */ 03989000
*                     THEN DO;                                     1175 03990000
         TM    BADVERFY,B'00000001'                                1175 03991000
         BNO   @RF01175                                            1175 03992000
*                       TEXTINT1(1) = ADDR(INSOIDCD); /* OIDCARD NAME*/ 03993000
         LA    @08,INSOIDCD                                        1177 03994000
         ST    @08,TEXTINT1                                        1177 03995000
*                       CALL BLDNUMB(OIDVERRC,TEXTSEGS(1));/*INSERT  */ 03996000
         LA    @08,OIDVERRC                                        1178 03997000
         ST    @08,@AL00001                                        1178 03998000
         LA    @08,TEXTSEGS                                        1178 03999000
         ST    @08,@AL00001+4                                      1178 04000000
         LA    @01,@AL00001                                        1178 04001000
         BAL   @14,BLDNUMB                                         1178 04002000
*                       END;              /*                 @G32OPKU*/ 04003000
*                     ELSE DO;                                     1180 04004000
         B     @RC01175                                            1180 04005000
@RF01175 DS    0H                                                  1181 04006000
*                       TEXTINT1(1) = ADDR(INSRINIT);/* SAY RACINIT  */ 04007000
         LA    @08,INSRINIT                                        1181 04008000
         ST    @08,TEXTINT1                                        1181 04009000
*                       CALL BLDNUMB(RETCODE,TEXTSEGS(1));         1182 04010000
         LA    @08,RETCODE                                         1182 04011000
         ST    @08,@AL00001                                        1182 04012000
         LA    @08,TEXTSEGS                                        1182 04013000
         ST    @08,@AL00001+4                                      1182 04014000
         LA    @01,@AL00001                                        1182 04015000
         BAL   @14,BLDNUMB                                         1182 04016000
*                                                     /*BUILD RC TEXT*/ 04017000
*                       END;                /* INSERT                */ 04018000
*                   END;                                           1184 04019000
*                                                                  1184 04020000
@RC01175 DS    0H                                                  1185 04021000
*   CALL LGM;                        /* SEND RACF ERROR MESSAGES     */ 04022000
*                                                                  1185 04023000
@RC01167 DS    0H                                                  1185 04024000
@RC01165 DS    0H                                                  1185 04025000
@RC01161 DS    0H                                                  1185 04026000
@RC01157 BAL   @14,LGM                                             1185 04027000
*END HANDLRAC;                                                     1186 04028000
@EL00015 DS    0H                                                  1186 04029000
@EF00015 DS    0H                                                  1186 04030000
@ER00015 LM    @14,@12,@SA00015                                    1186 04031000
         BR    @14                                                 1186 04032000
*/********************************************************************/ 04033000
*/*                                                                  */ 04034000
*/*SEGMENT-                                                          */ 04035000
*/*          RECONNECT                                               */ 04036000
*/*                                                                  */ 04037000
*/*RECONNECT RETURN CODES-                                           */ 04038000
*/*      RC=0-                                                       */ 04039000
*/*          RECONNECT TO PREVIOUS MEMORY WAS SUCCESSFUL,LOGON WILL  */ 04040000
*/*          TERMINATE IN THIS MEMORY                                */ 04041000
*/*                                                                  */ 04042000
*/*      RC=4-                                                       */ 04043000
*/*          PASSWORDS DO NOT MATCH--EITHER THE ONE SUPPLIED IS      */ 04044000
*/*          INCORRECT OR NO PASSWORD WAS SUPPLIED AT XXX.USER IS    */ 04045000
*/*          REPROMPTED FOR A PASSWORD AND THE RECONNECT IS TRIED    */ 04046000
*/*          AGAIN                                                   */ 04047000
*/*                                                                  */ 04048000
*/*      RC=8-                                                       */ 04049000
*/*          USERID NOT VALID--EITHER IT WAS NOT FOUND OR IT WAS     */ 04050000
*/*          FOUND TO BE IN USE I.E.THE LINE HAD NOT DROPPED.THE     */ 04051000
*/*          USER WILL BE PROMPTED FOR A NEW LOGON COMMAND           */ 04052000
*/*                                                                  */ 04053000
*/*      RC>8-                                                       */ 04054000
*/*          SOME SORT OF RECONNECT ERROR--ISSUE AN ERROR MESSAGE    */ 04055000
*/*          AND TERMINATE                                           */ 04056000
*/*                                                                  */ 04057000
*/*CHANGE ACTIVITY-                                                  */ 04058000
*/*      @G32OPKU-                                                   */ 04059000
*/*          THIS SEGMENT FOR RECONNECT ACTIVITY WAS MOVED FROM      */ 04060000
*/*          MODULE IKJEFLEA TO MODULE IKJFELE FOR RACF VERSION 2    */ 04061000
*/*          SUPPORT                                                 */ 04062000
*/*                                                                  */ 04063000
*/********************************************************************/ 04064000
*RECONECT:                                                         1187 04065000
*        PROCEDURE;                                                1187 04066000
*                                                                  1187 04067000
RECONECT STM   @14,@12,@SA00016                                    1187 04068000
*                                  /*RECONNECT WAS          @G32OPKU*/  04069000
*                                  /*REQUESTED ON LOGON             */  04070000
*                                                                  1188 04071000
*         IF LWPACCTL ^= 0 |       /* IF ANY OTHER KEYWORDS  @Z40NQKC*/ 04072000
*            LWPPROCL ^= 0 |       /* WERE ENTERED ON THE    @Z40NQKC*/ 04073000
*            LWPREGNX ^= 0 |       /* LOGON COMMAND PUT OUT  @Z40NQKC*/ 04074000
*            LWPPERFX ^= 0 |       /* WARNING MESSAGE        @Z40NQKC*/ 04075000
*            LWPMAIL  ^= NO |      /*'RECONNECT SPECIFIED-   @G32OPKU*/ 04076000
*            LWPNOTIC ^= NO |      /*OTHER OPERANDS IGNORED' @G32OPKU*/ 04077000
*            LWPOIDCD ^= NO        /* IGNORE OIDCARD ALSO    @G32OPKU*/ 04078000
*         THEN                     /*                          Y02669*/ 04079000
         SLR   @08,@08                                             1188 04080000
         L     @15,LWPPTR                                          1188 04081000
         CH    @08,LWPACCTL(,@15)                                  1188 04082000
         BNE   @RT01188                                            1188 04083000
         CH    @08,LWPPROCL(,@15)                                  1188 04084000
         BNE   @RT01188                                            1188 04085000
         C     @08,LWPREGNX(,@15)                                  1188 04086000
         BNE   @RT01188                                            1188 04087000
         C     @08,LWPPERFX(,@15)                                  1188 04088000
         BNE   @RT01188                                            1188 04089000
         TM    LWPMAIL(@15),B'01110000'                            1188 04090000
         BZ    @RF01188                                            1188 04091000
@RT01188 DS    0H                                                  1189 04092000
*           DO;                                                    1189 04093000
*             PMSGNM = 38;         /*SET 'IGNORED' MSG NUMBER  Y02669*/ 04094000
         MVC   PMSGNM(2),@CH03168                                  1190 04095000
*             CALL LGM;            /*PUT OUT 'IGNORED' MSG   @G32OPKU*/ 04096000
         BAL   @14,LGM                                             1191 04097000
*           END;                                                   1192 04098000
*                                                                  1192 04099000
*         LWARNML = LWPUSERL;      /* USERID LENGTH TO LWA   @ZM44318*/ 04100000
@RF01188 L     @08,LWAPTR                                          1193 04101000
         L     @15,LWPPTR                                          1193 04102000
         LH    @14,LWPUSERL(,@15)                                  1193 04103000
         STC   @14,LWARNML(,@08)                                   1193 04104000
*         LWARNM = '';             /* INIT TO BLANKS         @ZM44318*/ 04105000
         MVI   LWARNM(@08),C' '                                    1194 04106000
         MVC   LWARNM+1(6,@08),LWARNM(@08)                         1194 04107000
*         LWARNM(1:LWARNML) = LWPUSER;/* GET USERID          @ZM44318*/ 04108000
*                                                                  1195 04109000
         BCTR  @14,0                                               1195 04110000
         EX    @14,@SM03272                                        1195 04111000
*         CALL FDOLDTSB;           /* GET OLD TSB ADDR       @G32OPKU*/ 04112000
*                                                                  1196 04113000
         BAL   @14,FDOLDTSB                                        1196 04114000
*         CALL RECONRAC;           /* RACINIT FOR USER       @G32OPKU*/ 04115000
*                                                                  1197 04116000
         BAL   @14,RECONRAC                                        1197 04117000
*         IF LWPNPSWL ^= ZERO &    /* IF NEW PASSWRD ENTERED @G32OPKU*/ 04118000
*            LWARACF = NO          /* AND RACF DIDN'T LIKE IT@G32OPKU*/ 04119000
*           THEN DO;                                               1198 04120000
         SLR   @08,@08                                             1198 04121000
         L     @01,LWPPTR                                          1198 04122000
         CH    @08,LWPNPSWL(,@01)                                  1198 04123000
         BE    @RF01198                                            1198 04124000
         L     @01,LWAPTR                                          1198 04125000
         TM    LWARACF(@01),B'01000000'                            1198 04126000
         BNZ   @RF01198                                            1198 04127000
*             IF CVTRAC = ZERO     /* RACF NOT IN SYS        @G32OPKU*/ 04128000
*               THEN               /*                        @G32OPKU*/ 04129000
         L     @01,CVTPTR                                          1200 04130000
         C     @08,CVTRAC(,@01)                                    1200 04131000
         BNE   @RF01200                                            1200 04132000
*                 PMSGNM = MSG56426; /* UNSUPPORTED KEYWD MSG@G32OPKU*/ 04133000
         MVC   PMSGNM(2),@CH00786                                  1201 04134000
*               ELSE               /*                        @G32OPKU*/ 04135000
*                 PMSGNM = MSG56419; /* UNAUTH USER MSG      @G32OPKU*/ 04136000
         B     @RC01200                                            1202 04137000
@RF01200 MVC   PMSGNM(2),@CH00925                                  1202 04138000
*             TEXTINT1(1) = ADDR(INSNPSWD);/* NEW PASWD INSRT@G32OPKU*/ 04139000
@RC01200 LA    @08,INSNPSWD                                        1203 04140000
         ST    @08,TEXTINT1                                        1203 04141000
*             CALL LGM;            /* PUTOUT MSG             @G32OPKU*/ 04142000
         BAL   @14,LGM                                             1204 04143000
*             LWPNPSWL = ZERO;     /* ZERO FOR LATER REF     @G32OPKU*/ 04144000
         L     @08,LWPPTR                                          1205 04145000
         SLR   @15,@15                                             1205 04146000
         STH   @15,LWPNPSWL(,@08)                                  1205 04147000
*             END;                 /*                        @G32OPKU*/ 04148000
*                                                                  1206 04149000
*                                  /*CALL TIOC TO SEARCH TSB   Y02669*/ 04150000
*                                  /*TABLE FOR USERID AND/OR   Y02669*/ 04151000
*                                  /*PASSWORD TO BE            Y02669*/ 04152000
*                                  /*RECONNECTED               Y02669*/ 04153000
*         USER = LWPUSER;            /*MOVE USERID FROM LE'S @Z40NQKC*/ 04154000
@RF01198 MVI   USER+7,C' '                                         1207 04155000
         L     @08,LWPPTR                                          1207 04156000
         MVC   USER(7),LWPUSER(@08)                                1207 04157000
*                                  /*PARM LIST TO EIGHT BYTE   Y02669*/ 04158000
*                                  /*FIELD FOR TIOC            Y02669*/ 04159000
*         IF LWPPSWDL = 0           /*IF NO PASSWORD SUPPLIED@Z40NQKC*/ 04160000
*           THEN                   /*THEN SET FIELD TO         Y02669*/ 04161000
         LH    @08,LWPPSWDL(,@08)                                  1208 04162000
         LTR   @08,@08                                             1208 04163000
         BNZ   @RF01208                                            1208 04164000
*             PASSWORD=' ';        /*BLANKS                    Y02669*/ 04165000
*                                                                  1209 04166000
         MVI   PASSWORD+1,C' '                                     1209 04167000
         MVC   PASSWORD+2(6),PASSWORD+1                            1209 04168000
         MVI   PASSWORD,C' '                                       1209 04169000
*           ELSE PASSWORD=LWPPSWD;   /*ELSE PUT IN PASSWORD  @Z40NQKC*/ 04170000
*                                                                  1210 04171000
         B     @RC01208                                            1210 04172000
@RF01208 L     @08,LWPPTR                                          1210 04173000
         MVC   PASSWORD(8),LWPPSWD(@08)                            1210 04174000
*         PTRUSER=ADDR(USER);      /*POINT TO USERID           Y02669*/ 04175000
@RC01208 LA    @08,USER                                            1211 04176000
         ST    @08,PTRUSER                                         1211 04177000
*         PTRPSWRD=ADDR(PASSWORD); /*POINT TO PASSWORD         Y02669*/ 04178000
         LA    @08,PASSWORD                                        1212 04179000
         ST    @08,PTRPSWRD                                        1212 04180000
*CALLTIOC:                                                   /*Y02669*/ 04181000
*        IF TSBVTAM = '1'B         /* FOR SNA/VTAM           @Z40DQKC*/ 04182000
*          THEN DO;                /* VTAM RECONNECT         @Z40DQKC*/ 04183000
CALLTIOC L     @08,TSBPTR                                          1213 04184000
         TM    TSBVTAM(@08),B'00000001'                            1213 04185000
         BNO   @RF01213                                            1213 04186000
*            RFY GPR01P RSTD;                              /*@Z40DQKC*/ 04187000
*            GPR01P = ADDR(TIOCPARM); /* VTAM PARMLIST ADDR  @Z40DQKC*/ 04188000
         LA    GPR01P,TIOCPARM                                     1216 04189000
*            CALL IKTLOGR;            /* PERFORM RECONNECT   @Z40DQKC*/ 04190000
         L     @15,@CV00277                                        1217 04191000
         BALR  @14,@15                                             1217 04192000
*            RFY GPR01P UNRSTD;                            /*@Z40DQKC*/ 04193000
*            END;                                          /*@Z40DQKC*/ 04194000
*          ELSE DO;                /* TCAM RECONNECT         @Z40DQKC*/ 04195000
         B     @RC01213                                            1220 04196000
@RF01213 DS    0H                                                  1221 04197000
*            RFY GPR15P RSTD;                              /*@Z40DQKC*/ 04198000
*            GPR15P = ADDR(TIOCPARM); /* QTIP PARMLIST ADDR  @Z40DQKC*/ 04199000
         LA    GPR15P,TIOCPARM                                     1222 04200000
*            GEN(QTIP 1);             /* PERFORM RECONNECT   @Z40DQKC*/ 04201000
         QTIP 1                                                         04202000
*            RFY GPR15P UNRSTD;                            /*@Z40DQKC*/ 04203000
*            END;                                          /*@Z40DQKC*/ 04204000
*                                                                  1225 04205000
*         RESPECIFY (REASONCD,RTNREG) RSTD;                  /*Y02669*/ 04206000
@RC01213 DS    0H                                                  1227 04207000
*         IF RTNREG = 0            /*IF SUCCESSFUL RETURN-     Y02669*/ 04208000
*                                  /*USER HAS BEEN             Y02669*/ 04209000
*                                  /* RECONNECTED              Y02669*/ 04210000
*           THEN DO;               /*                        @G32OPKU*/ 04211000
*                                                                  1227 04212000
         SLR   @14,@14                                             1227 04213000
         CR    RTNREG,@14                                          1227 04214000
         BNE   @RF01227                                            1227 04215000
*             IF LWPNPSWL ^= ZERO  /* IF NEW PASSWORD        @G32OPKU*/ 04216000
*                & LWARACF = YES   /* AND DEFINED TO RACF    @ZM44711*/ 04217000
*               THEN DO;           /* HAS BEEN GIVEN         @G32OPKU*/ 04218000
         L     @08,LWPPTR                                          1229 04219000
         CH    @14,LWPNPSWL(,@08)                                  1229 04220000
         BE    @RF01229                                            1229 04221000
         L     @14,LWAPTR                                          1229 04222000
         TM    LWARACF(@14),B'01000000'                            1229 04223000
         BNO   @RF01229                                            1229 04224000
*                 CALL SETLOCK;    /* OBTAIN CMS LOCK        @G32OPKU*/ 04225000
         BAL   @14,SETLOCK                                         1231 04226000
*                 ROLDTSB->TSBPSWD = LWPNPSWD;/* MOVE PASSWD @G32OPKU*/ 04227000
         L     @14,ROLDTSB                                         1232 04228000
         L     @08,LWPPTR                                          1232 04229000
         MVC   TSBPSWD(8,@14),LWPNPSWD(@08)                        1232 04230000
*                 CALL RELLOCK;    /* FREE LOCKS             @G32OPKU*/ 04231000
         BAL   @14,RELLOCK                                         1233 04232000
*                 END;             /*                        @G32OPKU*/ 04233000
*            GOTO CLEANUP4;        /* PACK IT IN-HOME FREE   @G32OPKU*/ 04234000
         B     CLEANUP4                                            1235 04235000
*            END;                  /*                        @G32OPKU*/ 04236000
*                                                                  1236 04237000
*         IF RTNREG = 4            /*IF PASSWORD DID NOT       Y02669*/ 04238000
*                                  /*MATCH PREVIOUS SESSION'S  Y02669*/ 04239000
*           THEN                                                   1237 04240000
@RF01227 C     RTNREG,@CF00098                                     1237 04241000
         BNE   @RF01237                                            1237 04242000
*             DO;                                                  1238 04243000
*               IF LWARACF = YES   /* IF RACF ENVIRONMENT    @G32OPKU*/ 04244000
*                 THEN DO;         /*                        @G32OPKU*/ 04245000
         L     @14,LWAPTR                                          1239 04246000
         TM    LWARACF(@14),B'01000000'                            1239 04247000
         BNO   @RF01239                                            1239 04248000
*                   CALL RACFDEL;  /* DELETE ENVIORNMENT     @G32OPKU*/ 04249000
         BAL   @14,RACFDEL                                         1241 04250000
*                   PMSGNM = MSG56440;/* RECON REJECTED MSG  @G32OPKU*/ 04251000
         MVC   PMSGNM(2),@CH00948                                  1242 04252000
*                   CALL LGM;      /* PUT OUT MSG            @G32OPKU*/ 04253000
         BAL   @14,LGM                                             1243 04254000
*                   STATUS = CONTINUE;/* OK TO TRY AGAIN     @G32OPKU*/ 04255000
         SLR   @14,@14                                             1244 04256000
         ST    @14,STATUS                                          1244 04257000
*                   NOPRMPT = YES; /* TRY AGAIN BIT ON       @G32OPKU*/ 04258000
         OI    NOPRMPT,B'00100000'                                 1245 04259000
*                   GOTO CLEANUP4; /* LET'S CLEAN UP FIRST   @G32OPKU*/ 04260000
         B     CLEANUP4                                            1246 04261000
*                   END;           /*                        @G32OPKU*/ 04262000
*               IF PASSWORD=' '    /*IF NO PASSWORD ENTERED    Y02669*/ 04263000
*                 THEN PMSGNM=40;  /*ISSUE PASSWORD REQUIRED @G32OPKU*/ 04264000
@RF01239 CLI   PASSWORD,C' '                                       1248 04265000
         BNE   @RF01248                                            1248 04266000
         MVC   PMSGNM(2),@CH00499                                  1249 04267000
*                 ELSE PMSGNM=39;  /*ISSUE PASSWORK INVALID  @G32OPKU*/ 04268000
*                                                                  1250 04269000
         B     @RC01248                                            1250 04270000
@RF01248 MVC   PMSGNM(2),@CH03174                                  1250 04271000
*               PRMTSWC =  2 ;     /*PROMPT FOR ANOTHER      @G32OPKU*/ 04272000
@RC01248 MVC   PRMTSWC(2),@CH00135                                 1251 04273000
*                                  /*PASSWORD                        */ 04274000
*               CALL PROMPT;       /*PROMPT USER             @G32OPKU*/ 04275000
*                                                                  1252 04276000
         BAL   @14,PROMPT                                          1252 04277000
*               PASSWORD = LWPPSWD;  /*SET NEW PASSWORD      @G32OPKU*/ 04278000
         L     @14,LWPPTR                                          1253 04279000
         MVC   PASSWORD(8),LWPPSWD(@14)                            1253 04280000
*                                    /*AND TRY AGAIN         @G32OPKU*/ 04281000
*               GO TO CALLTIOC;                             /* Y02669*/ 04282000
         B     CALLTIOC                                            1254 04283000
*              END;                                         /* Y02669*/ 04284000
*                                                                  1255 04285000
*                                                                  1255 04286000
*     IF RTNREG = 8                /*IF USERID NOT VALID       Y02669*/ 04287000
*      THEN                        /*THEN                      Y02669*/ 04288000
@RF01237 C     RTNREG,@CF00046                                     1256 04289000
         BNE   @RF01256                                            1256 04290000
*       DO;                        /*SET UP ERROR MESSAGE      Y02669*/ 04291000
*                                                                  1257 04292000
*        IF REASONCD=0             /*IF USERID NOT FOUND       Y02669*/ 04293000
*           THEN                   /*THEN                      Y02669*/ 04294000
         LTR   REASONCD,REASONCD                                   1258 04295000
         BNZ   @RF01258                                            1258 04296000
*             PMSGNM=42;           /*SET MSG NUMBER TO 'USERID Y02669*/ 04297000
         MVC   PMSGNM(2),@CH03175                                  1259 04298000
*                                  /*NOT FOUND' MESSAGE        Y02669*/ 04299000
*           ELSE PMSGNM=43;        /*ELSE SET MSG NUMBER TO    Y02669*/ 04300000
         B     @RC01258                                            1260 04301000
@RF01258 MVC   PMSGNM(2),@CH03176                                  1260 04302000
*                                  /*'USERID IN USE' MSG       Y02669*/ 04303000
*         TEXTINT1(1)=ADDR(LWPUSERI);/*GET USERID INSERT FOR @G32OPKU*/ 04304000
@RC01258 L     @14,LWPPTR                                          1261 04305000
         LA    @14,LWPUSERI(,@14)                                  1261 04306000
         ST    @14,TEXTINT1                                        1261 04307000
*                                  /*MESSAGE BUFFER                  */ 04308000
*                                                                  1262 04309000
*         CALL LGM;                /*PUT OUT ERROR MESSAGE   @G32OPKU*/ 04310000
*                                                                  1262 04311000
         BAL   @14,LGM                                             1262 04312000
*         CALL RACFDEL;            /* DELETE ENVIRONMENT BEFOR EXIT     04313000
*                                                            @G32OPKU*/ 04314000
         BAL   @14,RACFDEL                                         1263 04315000
*         STATUS = CONTINUE;       /* OK TO GO ON            @G32OPKU*/ 04316000
         SLR   @14,@14                                             1264 04317000
         ST    @14,STATUS                                          1264 04318000
*         NOPRMPT = YES;           /*I AM NOT SURE OF THIS   @G32OPKU*/ 04319000
         OI    NOPRMPT,B'00100000'                                 1265 04320000
*                                  /*BUT IT GETS PROCESSED AS BEFORE */ 04321000
*         GO TO CLEANUP0;          /*GO TO CLEANUP ENTRY     @G32OPKU*/ 04322000
         B     CLEANUP0                                            1266 04323000
*                                  /*FOR NO-PROMPT           @G32OPKU*/ 04324000
*                                  /*PROCESSING AS PREVIOUSLY DONE   */ 04325000
*       END;                                                       1267 04326000
*                                                                  1267 04327000
*    ELSE                          /*MUST BE QTIP ERROR       Y02669*/  04328000
*      DO;                         /*SET UP ERROR MESSAGE     Y02669*/  04329000
@RF01256 DS    0H                                                  1269 04330000
*        GEN;                      /*PREPARE RTN CODE FOR MSG  Y02669*/ 04331000
*                                                                  1269 04332000
         CVD RTNREG,PACKDEC                CONVERT TO DECIMAL  Y02669   04333000
         UNPK ZONEDEC(8),PACKDEC(8)                            Y02669   04334000
         OI   ZONEDEC+7,X'F0'              CHANGE SIGN         Y02669   04335000
*        STATUS = CONTINUE;        /* OK TO GO ON            @G32OPKU*/ 04336000
*                                                                  1270 04337000
         SLR   @14,@14                                             1270 04338000
         ST    @14,STATUS                                          1270 04339000
*        PMSGNM=20;                /*SET MSG NUMBER TO       @G32OPKU*/ 04340000
         MVC   PMSGNM(2),@CH00340                                  1271 04341000
*                                  /*SERVICE RTN ERROR         Y02669*/ 04342000
*        TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*GET ADDR OF ERROR    Y02669*/ 04343000
         LA    @08,TEXTSEGS                                        1272 04344000
         ST    @08,TEXTINT1                                        1272 04345000
*                                  /*ROUTINE SEGMENT           Y02669*/ 04346000
*        TEXTSLEN(1)=8;            /*SET LEN OF TEXT           Y02669*/ 04347000
         MVC   TEXTSLEN(2),@CH00046                                1273 04348000
*        TEXTSOST(1)=0;            /*SET OFFSET OF TEXT        Y02669*/ 04349000
         STH   @14,TEXTSOST                                        1274 04350000
*        IF TSBVTAM = YES          /*IF THIS WAS VTAM SET IN @G32OPKU*/ 04351000
*           THEN TEXTSTXT(1,1:7)='IKTLOGR';/*ERR MOD NAME    @G32OPKU*/ 04352000
         L     @14,TSBPTR                                          1275 04353000
         TM    TSBVTAM(@14),B'00000001'                            1275 04354000
         BNO   @RF01275                                            1275 04355000
         MVC   TEXTSTXT(7),@CC03177                                1276 04356000
*           ELSE TEXTSTXT(1,1:4)='QTIP';/*OR QTIP ERR        @G32OPKU*/ 04357000
*                                                                  1277 04358000
         B     @RC01275                                            1277 04359000
@RF01275 MVC   TEXTSTXT(4),@CC03178                                1277 04360000
*        TEXTINT1(2)=ADDR(TEXTSEGS(2)); /*GET ADDR OF ERROR    Y02669*/ 04361000
@RC01275 LA    @14,TEXTSEGS+24                                     1278 04362000
         ST    @14,TEXTINT1+4                                      1278 04363000
*                                  /*RETURN CODE SEGMENT       Y02669*/ 04364000
*        TEXTSLEN(2)=7;            /*SET LEN OF TEXT           Y02669*/ 04365000
         MVC   TEXTSLEN+24(2),@CH00133                             1279 04366000
*        TEXTSOST(2)=0;            /*SET OFFSET OF TEXT        Y02669*/ 04367000
         SLR   @14,@14                                             1280 04368000
         STH   @14,TEXTSOST+24                                     1280 04369000
*        TEXTSTXT(2,1:3)=ZONEDEC(6:8); /*PUT IN RETURN CODE    Y02669*/ 04370000
*                                                                  1281 04371000
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1281 04372000
*         IF LWPUSERL ^=0           /*IF USERID IS KNOWN,    @Z40NQKC*/ 04373000
*           THEN                   /* THEN POINT TO USERID SEG Y02669*/ 04374000
         L     @08,LWPPTR                                          1282 04375000
         CH    @14,LWPUSERL(,@08)                                  1282 04376000
         BE    @RF01282                                            1282 04377000
*             TEXTINT1(3)=ADDR(LWPUSERI);                  /*@Z40NQKC*/ 04378000
         LA    @14,LWPUSERI(,@08)                                  1283 04379000
         ST    @14,TEXTINT1+8                                      1283 04380000
*                                  /*ELSE USERID IS UNKNOWN    Y02669*/ 04381000
*             ELSE TEXTINT1(3)=0;                            /*Y02669*/ 04382000
*                                                                  1284 04383000
         B     @RC01282                                            1284 04384000
@RF01282 SLR   @14,@14                                             1284 04385000
         ST    @14,TEXTINT1+8                                      1284 04386000
*         IF LWPPROCL ^=0           /*IF PROCNAME IS KNOWN   @Z40NQKC*/ 04387000
*           THEN                   /*THEN POINT TO PROC SGMENT Y02669*/ 04388000
@RC01282 L     @14,LWPPTR                                          1285 04389000
         LH    @08,LWPPROCL(,@14)                                  1285 04390000
         LTR   @08,@08                                             1285 04391000
         BZ    @RF01285                                            1285 04392000
*             TEXTINT1(4)=ADDR(LWPPROCI);                  /*@Z40NQKC*/ 04393000
         LA    @14,LWPPROCI(,@14)                                  1286 04394000
         ST    @14,TEXTINT1+12                                     1286 04395000
*                                  /*ELSE PROC IS UNKNOWN      Y02669*/ 04396000
*           ELSE TEXTINT1(4)=0;                                    1287 04397000
         B     @RC01285                                            1287 04398000
@RF01285 SLR   @14,@14                                             1287 04399000
         ST    @14,TEXTINT1+12                                     1287 04400000
*         CALL LGM;                /*PUT OUT ERROR MESSAGE     Y02669*/ 04401000
@RC01285 BAL   @14,LGM                                             1288 04402000
*         GO TO CLEANUP4;          /*AND CLOSE OUT LOGON     @G32OPKU*/ 04403000
         B     CLEANUP4                                            1289 04404000
*       END;                                                 /*Y02669*/ 04405000
*                                                                  1290 04406000
* RESPECIFY (REASONCD,RTNREG) UNRSTD; /*                     @G32OPKU*/ 04407000
*                                                                  1291 04408000
*                                                                  1291 04409000
*END RECONECT;                                                     1292 04410000
*/********************************************************************/ 04411000
*/*                                                                  */ 04412000
*/*SEGMENT-                                                          */ 04413000
*/*          SETLOCK                                                 */ 04414000
*/*                                                                  */ 04415000
*/*FUNCTION-                                                         */ 04416000
*/*          OBTAIN THE LOCAL AND CMS LOCKS TO ACCESS THE TSB        */ 04417000
*/*                                                                  */ 04418000
*/*OPERATION-                                                        */ 04419000
*/*          FIRST THE LOCAL LOCK IS OBTAINED.IF SUCCESSFUL,THEN     */ 04420000
*/*          THE CMS LOCK IS OBTAINED                                */ 04421000
*/*                                                                  */ 04422000
*/*          IF EITHER OBTAIN LOCK FAILS,A MESSAGE IS SENT TO THE    */ 04423000
*/*          OPERATOR WITH THE ERROR RETURN CODE.ALSO,THE USERID     */ 04424000
*/*          AND PROC ARE INCLUDED IF AVAILABLE                      */ 04425000
*/*                                                                  */ 04426000
*/*      @G32OPKU-                                                   */ 04427000
*/*          NEW SEGMENT FOR RACF VERSION 2 SUPPORT                  */ 04428000
*/*                                                                  */ 04429000
*/********************************************************************/ 04430000
*SETLOCK:                                                          1293 04431000
*        PROCEDURE;                                                1293 04432000
*                                                                  1293 04433000
SETLOCK  STM   @14,@12,@SA00017                                    1293 04434000
*   RFY (RTNREG) RSTD;                                             1294 04435000
*   GEN REFS(PSALITA,FLC);             /* OBTAIN THE LOCAL LOCK      */ 04436000
  SETLOCK  OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,RELATED=(TSB,RELLOCK) 04437000
*   LOCKRC = RTNREG;                   /* SAVE SETLOCK RETURN CODE   */ 04438000
*                                                                  1296 04439000
         LR    LOCKRC,RTNREG                                       1296 04440000
*   IF LOCKRC = ZERO                   /* IF ZERO RETURN CODE        */ 04441000
*     THEN DO;                         /* AQUIRE THE CMS LOCK        */ 04442000
         LTR   LOCKRC,LOCKRC                                       1297 04443000
         BNZ   @RF01297                                            1297 04444000
*       GEN REFS(PSALITA,FLC);                                     1299 04445000
  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,RELATED=(TSB,RELLOCK)    04446000
*       LOCKRC=RTNREG;                 /* SAVE SETLOCK RETURN CODE   */ 04447000
         LR    LOCKRC,RTNREG                                       1300 04448000
*       END;                                                       1301 04449000
*  RFY (RTNREG) UNRSTD;                /* RETURN REG TO THE COMPILER */ 04450000
*                                                                  1302 04451000
@RF01297 DS    0H                                                  1303 04452000
*  IF LOCKRC ^= ZERO                   /* IF ONE OF THE LOCKS DID NOT*/ 04453000
*    THEN                              /* WORK SO VERY RED HOT START */ 04454000
         LTR   LOCKRC,LOCKRC                                       1303 04455000
         BZ    @RF01303                                            1303 04456000
*      DO;                             /* PUTTING A MSG TOGETHER     */ 04457000
*        CVD(LOCKRC,PACKDEC);          /* CONVERT THE RET CODE       */ 04458000
         CVD   LOCKRC,PACKDEC                                      1305 04459000
*        UNPK(ZONEDEC,PACKDEC);        /* TO PRINTABLE               */ 04460000
         UNPK  ZONEDEC(8),PACKDEC(8)                               1306 04461000
*        GEN(OI ZONEDEC+7,X'F0');      /* HIT THE ZONE BYTE          */ 04462000
*                                                                  1307 04463000
         OI ZONEDEC+7,X'F0'                                             04464000
*        PMSGNM = 20;                  /* SET ERROR MSG NUMBER       */ 04465000
*                                                                  1308 04466000
         MVC   PMSGNM(2),@CH00340                                  1308 04467000
*        TEXTINT1(1) = ADDR(TEXTSEGS(1)); /* POINT TO INSERT SEGMENT */ 04468000
         LA    @08,TEXTSEGS                                        1309 04469000
         ST    @08,TEXTINT1                                        1309 04470000
*        TEXTSLEN(1) = 15;                /* SET UP MSG LENGTH,      */ 04471000
         MVC   TEXTSLEN(2),@CH00053                                1310 04472000
*        TEXTSOST(1) = 0;                 /* OFFSET,                 */ 04473000
         SLR   @08,@08                                             1311 04474000
         STH   @08,TEXTSOST                                        1311 04475000
*        TEXTSTXT(1,1:11) = 'OBTAIN LOCK';/* AND MSG TEXT            */ 04476000
*                                                                  1312 04477000
         MVC   TEXTSTXT(11),@CC03183                               1312 04478000
*        TEXTINT1(2) = ADDR(TEXTSEGS(2)); /* POINT TO SECOND INSERT  */ 04479000
         LA    @15,TEXTSEGS+24                                     1313 04480000
         ST    @15,TEXTINT1+4                                      1313 04481000
*        TEXTSLEN(2) = 7;                 /* SET UP MSG LENGTH,      */ 04482000
         MVC   TEXTSLEN+24(2),@CH00133                             1314 04483000
*        TEXTSOST(2) = 0;                 /* OFFSET,                 */ 04484000
         STH   @08,TEXTSOST+24                                     1315 04485000
*        TEXTSTXT(2,1:3) = ZONEDEC(6:8);  /* AND ERROR RET CODE      */ 04486000
*                                                                  1316 04487000
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1316 04488000
*        IF LWPUSERL ^= 0                 /* IS THER A USERID ???    */ 04489000
*          THEN                                                    1317 04490000
         L     @15,LWPPTR                                          1317 04491000
         CH    @08,LWPUSERL(,@15)                                  1317 04492000
         BE    @RF01317                                            1317 04493000
*            TEXTINT1(3) = ADDR(LWPUSERI);/* YES, PLUG IT IN         */ 04494000
         LA    @08,LWPUSERI(,@15)                                  1318 04495000
         ST    @08,TEXTINT1+8                                      1318 04496000
*          ELSE                                                    1319 04497000
*            TEXTINT1(3) = 0;             /* OTHERWISE ZERO PTR      */ 04498000
         B     @RC01317                                            1319 04499000
@RF01317 SLR   @08,@08                                             1319 04500000
         ST    @08,TEXTINT1+8                                      1319 04501000
*        IF LWPPROCL ^= 0                 /* IS THERE A PROC NAME ?? */ 04502000
*          THEN                                                    1320 04503000
@RC01317 L     @08,LWPPTR                                          1320 04504000
         LH    @15,LWPPROCL(,@08)                                  1320 04505000
         LTR   @15,@15                                             1320 04506000
         BZ    @RF01320                                            1320 04507000
*            TEXTINT1(4) = ADDR(LWPPROCI);/* YES, PLUG IT IN         */ 04508000
         LA    @08,LWPPROCI(,@08)                                  1321 04509000
         ST    @08,TEXTINT1+12                                     1321 04510000
*          ELSE                                                    1322 04511000
*            TEXTINT1(4) = 0;             /* OTHERWISE ZERO PTR      */ 04512000
         B     @RC01320                                            1322 04513000
@RF01320 SLR   @08,@08                                             1322 04514000
         ST    @08,TEXTINT1+12                                     1322 04515000
*        CALL LGM;                        /* PUT OUT ERROR MSG       */ 04516000
*                                                                  1323 04517000
@RC01320 BAL   @14,LGM                                             1323 04518000
*        GOTO CLEANUP4;                   /* RETURN FOR ERROR        */ 04519000
         B     CLEANUP4                                            1324 04520000
*      END;                                                        1325 04521000
*  RETURN;                                                         1326 04522000
*                                                                  1326 04523000
*                                                                  1326 04524000
*                                                                  1326 04525000
@EL00017 DS    0H                                                  1326 04526000
@EF00017 DS    0H                                                  1326 04527000
@ER00017 LM    @14,@12,@SA00017                                    1326 04528000
         BR    @14                                                 1326 04529000
*END SETLOCK;                                                      1327 04530000
         B     @EL00017                                            1327 04531000
*/********************************************************************/ 04532000
*/*                                                                  */ 04533000
*/*SEGMENT-                                                          */ 04534000
*/*          RELLOCK                                                 */ 04535000
*/*                                                                  */ 04536000
*/*FUNCTION-                                                         */ 04537000
*/*          RELEASE CMS AND LOCAL LOCKS AFTER ACCESSING THE TSB     */ 04538000
*/*                                                                  */ 04539000
*/*OPERATION-                                                        */ 04540000
*/*          FIRST THE CMS LOCK IS RELEASED.IF SUCCESSFUL THE LOCAL  */ 04541000
*/*          LOCK IS THEN RELEASED                                   */ 04542000
*/*                                                                  */ 04543000
*/*          IF EITHER RELEASE LOCK FAILS,A MESSAGE IS SENT TO THE   */ 04544000
*/*          OPERATOR WITH THE ERROR RETURN CODE.ALSO,THE USERID     */ 04545000
*/*          AND PROC NAME ARE INCLUDED IF AVAILABLE                 */ 04546000
*/*                                                                  */ 04547000
*/*      @G32OPKU-                                                   */ 04548000
*/*          NEW SEGMENT FOR RACF VERSION2 SUPPORT                   */ 04549000
*/*                                                                  */ 04550000
*/********************************************************************/ 04551000
*RELLOCK:                                                          1328 04552000
*        PROCEDURE;                                                1328 04553000
*                                                                  1328 04554000
RELLOCK  STM   @14,@12,@SA00018                                    1328 04555000
*  RFY (RTNREG) RSTD;                                              1329 04556000
*  GENERATE REFS(PSALITA,FLC);     /* RELEASE CMS LOCK               */ 04557000
     SETLOCK RELEASE,TYPE=CMS,REGS=USE,RELATED=(TSB,SETLOCK)            04558000
*  LOCKRC = RTNREG;                /* SAVE RET CODE                  */ 04559000
         LR    LOCKRC,RTNREG                                       1331 04560000
*        GEN REFS(PSALITA,FLC);                                    1332 04561000
*                                                                  1332 04562000
     SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,RELATED=(TSB,SETLOCK)          04563000
* IF LOCKRC ^= ZERO | RTNREG ^= ZERO   /* IF ONE OF THE LOCKS DID NOT*/ 04564000
*   THEN                               /* WORK SO VERY RED HOT       */ 04565000
         SLR   @14,@14                                             1333 04566000
         CR    LOCKRC,@14                                          1333 04567000
         BNE   @RT01333                                            1333 04568000
         CR    RTNREG,@14                                          1333 04569000
         BE    @RF01333                                            1333 04570000
@RT01333 DS    0H                                                  1334 04571000
*     DO;                               /* START PUTTING MSG TOGETHER*/ 04572000
*       IF LOCKRC = ZERO                /* IF FAILURE NO IN CMS LOCK */ 04573000
*         THEN                          /* IT MUST BE IN LOCAL LOCK  */ 04574000
         LTR   LOCKRC,LOCKRC                                       1335 04575000
         BNZ   @RF01335                                            1335 04576000
*           LOCKRC = RTNREG;            /* SAVE LOCAL LOCK RET CODE  */ 04577000
         LR    LOCKRC,RTNREG                                       1336 04578000
*       RFY (RTNREG) UNRSTD;            /* RELEASE  REG R15          */ 04579000
@RF01335 DS    0H                                                  1338 04580000
*       CVD(LOCKRC,PACKDEC);            /* CONVERT THE RET CODE      */ 04581000
         CVD   LOCKRC,PACKDEC                                      1338 04582000
*       UNPK(ZONEDEC,PACKDEC);          /* TO PRINTABLE              */ 04583000
         UNPK  ZONEDEC(8),PACKDEC(8)                               1339 04584000
*       GEN(OI ZONEDEC+7,X'F0');        /* HIT THE ZONE BYTE         */ 04585000
*                                                                  1340 04586000
         OI ZONEDEC+7,X'F0'                                             04587000
*       PMSGNM = 20;                    /* SET ERROR MSG NUMBER      */ 04588000
*                                                                  1341 04589000
         MVC   PMSGNM(2),@CH00340                                  1341 04590000
*       TEXTINT1(1) = ADDR(TEXTSEGS(1));/* POINT TO INSERT SEGMENT   */ 04591000
         LA    @08,TEXTSEGS                                        1342 04592000
         ST    @08,TEXTINT1                                        1342 04593000
*       TEXTSLEN(1) = 16;               /* SET UP MSG LENGTH,        */ 04594000
         MVC   TEXTSLEN(2),@CH00145                                1343 04595000
*       TEXTSOST(1) = 0;                /* OFFSET,                   */ 04596000
         SLR   @08,@08                                             1344 04597000
         STH   @08,TEXTSOST                                        1344 04598000
*       TEXTSTXT(1,1:12) = 'RELEASE LOCK';/* AND MSG TEXT            */ 04599000
*                                                                  1345 04600000
         MVC   TEXTSTXT(12),@CC03188                               1345 04601000
*       TEXTINT1(2) = ADDR(TEXTSEGS(2));/* POINT TO SECOND INSERT    */ 04602000
         LA    @15,TEXTSEGS+24                                     1346 04603000
         ST    @15,TEXTINT1+4                                      1346 04604000
*       TEXTSLEN(2) = 7;                /* SET UP MSG LENGTH,        */ 04605000
         MVC   TEXTSLEN+24(2),@CH00133                             1347 04606000
*       TEXTSOST(2) = 0;                /* OFFSET,                   */ 04607000
         STH   @08,TEXTSOST+24                                     1348 04608000
*       TEXTSTXT(2,1:3) = ZONEDEC(6:8); /* AND ERROR RET CODE        */ 04609000
*                                                                  1349 04610000
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1349 04611000
*       IF LWPUSERL ^= 0                /* IS THER A USERID ???      */ 04612000
*         THEN                                                     1350 04613000
         L     @15,LWPPTR                                          1350 04614000
         CH    @08,LWPUSERL(,@15)                                  1350 04615000
         BE    @RF01350                                            1350 04616000
*           TEXTINT1(3) = ADDR(LWPUSERI);/* YES, PLUG IT IN          */ 04617000
         LA    @08,LWPUSERI(,@15)                                  1351 04618000
         ST    @08,TEXTINT1+8                                      1351 04619000
*         ELSE                                                     1352 04620000
*           TEXTINT1(3) = 0;            /* OTHERWISE ZERO PTR        */ 04621000
         B     @RC01350                                            1352 04622000
@RF01350 SLR   @08,@08                                             1352 04623000
         ST    @08,TEXTINT1+8                                      1352 04624000
*       IF LWPPROCL ^= 0                /* IS THERE A PROC NAME ??   */ 04625000
*         THEN                                                     1353 04626000
@RC01350 L     @08,LWPPTR                                          1353 04627000
         LH    @15,LWPPROCL(,@08)                                  1353 04628000
         LTR   @15,@15                                             1353 04629000
         BZ    @RF01353                                            1353 04630000
*           TEXTINT1(4) = ADDR(LWPPROCI);/* YES, PLUG IT IN          */ 04631000
         LA    @08,LWPPROCI(,@08)                                  1354 04632000
         ST    @08,TEXTINT1+12                                     1354 04633000
*         ELSE                                                     1355 04634000
*           TEXTINT1(4) = 0;            /* OTHERWISE ZERO PTR        */ 04635000
         B     @RC01353                                            1355 04636000
@RF01353 SLR   @08,@08                                             1355 04637000
         ST    @08,TEXTINT1+12                                     1355 04638000
*       CALL LGM;                       /* PUT OUT ERROR MSG         */ 04639000
*                                                                  1356 04640000
@RC01353 BAL   @14,LGM                                             1356 04641000
*       GOTO CLEANUP4;                  /* RETURN FOR ERROR          */ 04642000
         B     CLEANUP4                                            1357 04643000
*     END;                                                         1358 04644000
*  RETURN;                                                         1359 04645000
*                                                                  1359 04646000
*                                                                  1359 04647000
*                                                                  1359 04648000
@EL00018 DS    0H                                                  1359 04649000
@EF00018 DS    0H                                                  1359 04650000
@ER00018 LM    @14,@12,@SA00018                                    1359 04651000
         BR    @14                                                 1359 04652000
*END RELLOCK;                                                      1360 04653000
         B     @EL00018                                            1360 04654000
*/********************************************************************/ 04655000
*/*                                                                  */ 04656000
*/*SEGMENT-                                                          */ 04657000
*/*          OIDVERFY                                                */ 04658000
*/*                                                                  */ 04659000
*/*FUNCTION-                                                         */ 04660000
*/*          VERIFY OIDCARD                                          */ 04661000
*/*                                                                  */ 04662000
*/*OPERATION-                                                        */ 04663000
*/*          IF OIDCARD WAS ENTERED ON LOGON COMMAND,IT WILL BE      */ 04664000
*/*          PROMPTED FOR NOW.IF RACINIT REQUIRES AN OIDCARD AND     */ 04665000
*/*          NONE WAS ENTERED OR THE USER ENTERED AN INVALID         */ 04666000
*/*          OIDCARD,A PROMPT WILL BE ISSUED.                        */ 04667000
*/*                                                                  */ 04668000
*/*          IF AN OIDCARD IS REQUIRED BY RACINIT AND THE USER IS    */ 04669000
*/*          ON A TERMINAL THAT DOES NOT SUPPORT AN OIDCARD READER,  */ 04670000
*/*          LOGON WILL TERMINATE.                                   */ 04671000
*/*                                                                  */ 04672000
*/*          IKJEFLGM WILL HANDLE PROMPTING BECAUSE THE OIDCARD      */ 04673000
*/*          MUST BE READ ASIS.ICHRID00 WILL BE CALLED TO HANDLE     */ 04674000
*/*          OIDCARD CHECKING.                                       */ 04675000
*/*                                                                  */ 04676000
*/*      @G32OPKU-                                                   */ 04677000
*/*          THIS SEGMENT WAS ADDED TO SUPPORT RACF VERSION2         */ 04678000
*/*                                                                  */ 04679000
*/********************************************************************/ 04680000
*OIDVERFY:                                                         1361 04681000
*        PROCEDURE;                                                1361 04682000
*                                                                  1361 04683000
*                                                                  1361 04684000
OIDVERFY STM   @14,@12,@SA00019                                    1361 04685000
*DCL HOLDLEN FIXED(31);           /* TEMP SAVE AREA FOR BUFFER LEN   */ 04686000
*OIDVERRC = BADOID;               /* INITIALIZE FOR DO LOOP          */ 04687000
*                                                                  1363 04688000
         MVC   OIDVERRC(4),@CF00046                                1363 04689000
*DO WHILE OIDVERRC = BADOID;      /* AS LONG AS OIDCD NOT GOOD     1364 04690000
*                                    KEEP PROMPTING                  */ 04691000
         B     @DE01364                                            1364 04692000
@DL01364 DS    0H                                                  1365 04693000
*  PTRYS = PTRYS+1;               /* INCREASE NUMBER OF TRYS         */ 04694000
         LA    @08,1                                               1365 04695000
         AL    @08,PTRYS                                           1365 04696000
         ST    @08,PTRYS                                           1365 04697000
*  IF PTRYS >= LP0PRMT            /* IF USER HAS HAD TOO MANY TRYS   */ 04698000
*    THEN DO;                     /* TO LOGON                        */ 04699000
         L     @15,@CV00275                                        1366 04700000
         C     @08,LP0PRMT(,@15)                                   1366 04701000
         BL    @RF01366                                            1366 04702000
*      PMSGNM = MSGTOOAT;         /* PUT OUT THE ERROR MSG WITH      */ 04703000
         MVC   PMSGNM(2),@CH00483                                  1368 04704000
*      TEXTINT1(1) = ADDR(LWPUSERI);/* USERID                        */ 04705000
         L     @08,LWPPTR                                          1369 04706000
         LA    @08,LWPUSERI(,@08)                                  1369 04707000
         ST    @08,TEXTINT1                                        1369 04708000
*      CALL LGM;                  /* SEND IT                         */ 04709000
         BAL   @14,LGM                                             1370 04710000
*      GOTO CLEANUP4;             /* AND THEN EXIT STAGE LEFT---     */ 04711000
         B     CLEANUP4                                            1371 04712000
*      END;                                                        1372 04713000
*  CALL LGM;                      /* IF OK, PROMPT FOR OIDCARD       */ 04714000
*                                                                  1373 04715000
@RF01366 BAL   @14,LGM                                             1373 04716000
*  HOLDLEN = CMNDLNG;             /* SAVE BUFFER LEN FOR FREEMAIN    */ 04717000
         L     @08,INBUF                                           1374 04718000
         LH    @15,CMNDLNG(,@08)                                   1374 04719000
         LR    HOLDLEN,@15                                         1374 04720000
*  CMNDLNG = CMNDLNG - 4;         /* DECRIMENT FOR VERIFY ROUTINE    */ 04721000
         SL    @15,@CF00098                                        1375 04722000
         STH   @15,CMNDLNG(,@08)                                   1375 04723000
*  INOID = ADDR(CMNDTEXT);        /* POINT TO OID BUFFER             */ 04724000
         LA    @04,CMNDTEXT(,@08)                                  1376 04725000
         ST    @04,INOID                                           1376 04726000
*  INLENOID = ADDR(CMNDLNG);      /* POINT TO OIDCARD LENGTH         */ 04727000
         ST    @08,INLENOID                                        1377 04728000
*  OUTOID = ADDR(OIDPTR);         /* PTR TO OUTPUT OIDCARD           */ 04729000
         LA    @08,OIDPTR                                          1378 04730000
         ST    @08,OUTOID                                          1378 04731000
*  OUTLENID = ADDR(OIDLEN);       /* PTR TO OUTPUTOIDCARD LENGTH     */ 04732000
*                                                                  1379 04733000
         LA    @08,OIDLEN                                          1379 04734000
         ST    @08,OUTLENID                                        1379 04735000
*  RFY (PARMPTR,RTNREG) RSTD;                                      1380 04736000
*  PARMPTR = ADDR(OIDPARM);       /* POINT TO PARM LIST              */ 04737000
         LA    PARMPTR,OIDPARM                                     1381 04738000
*  CALL ICHRID00;                 /* OIDCARD VERIFY ROUTINE INVOKED  */ 04739000
*                                                                  1382 04740000
         L     @08,CVTPTR                                          1382 04741000
         L     @08,CVTRAC(,@08)                                    1382 04742000
         L     @15,RCVTRID0(,@08)                                  1382 04743000
         BALR  @14,@15                                             1382 04744000
*  OIDVERRC = RTNREG;             /* SAVE RET CODE                   */ 04745000
*                                                                  1383 04746000
         ST    RTNREG,OIDVERRC                                     1383 04747000
*  RFY (PARMPTR,RTNREG) UNRSTD;                                    1384 04748000
*  IF OIDVERRC = ZERO             /* OIDCARD WAS OK                  */ 04749000
*    THEN DO;                                                      1385 04750000
         L     @08,OIDVERRC                                        1385 04751000
         LTR   @08,@08                                             1385 04752000
         BNZ   @RF01385                                            1385 04753000
*      ROIDDATA(1:OIDLEN) = OIDPTR->CMNDBUFR(1:OIDLEN);/* MOVE DATA  */ 04754000
         LH    @08,OIDLEN                                          1387 04755000
         BCTR  @08,0                                               1387 04756000
         L     @04,OIDPTR                                          1387 04757000
         EX    @08,@SM03274                                        1387 04758000
*      ROIDLEN = CDLEN;           /* SET OID LEN FIELD               */ 04759000
         IC    @08,CDLEN                                           1388 04760000
         STC   @08,ROIDLEN                                         1388 04761000
*      END;                                                        1389 04762000
*    ELSE                                                          1390 04763000
*      IF OIDVERRC = NOTOIDRD     /* IF TERM DOES NOT SUPPORT OID    */ 04764000
*        THEN                                                      1390 04765000
         B     @RC01385                                            1390 04766000
@RF01385 CLC   OIDVERRC(4),@CF00098                                1390 04767000
         BNE   @RF01390                                            1390 04768000
*          LWANORDR = YES;        /* TELL THE WORLD ABOUT IT         */ 04769000
         L     @08,LWAPTR                                          1391 04770000
         OI    LWANORDR(@08),B'01000000'                           1391 04771000
*        ELSE                                                      1392 04772000
*          IF OIDVERRC = BADOID   /* IF OIDCD INVALIDLY SETUP        */ 04773000
*            THEN                                                  1392 04774000
         B     @RC01390                                            1392 04775000
@RF01390 CLC   OIDVERRC(4),@CF00046                                1392 04776000
         BNE   @RF01392                                            1392 04777000
*              PMSGNM = MSG56435; /* PROMPT FOR ANOTHER OIDCARD      */ 04778000
         MVC   PMSGNM(2),@CH00939                                  1393 04779000
*            ELSE                                                  1394 04780000
*              BADVERFY = YES;    /* PACK UP YOUR TENT ALIBABA       */ 04781000
*                                                                  1394 04782000
*                                                                  1394 04783000
         B     @RC01392                                            1394 04784000
@RF01392 OI    BADVERFY,B'00000001'                                1394 04785000
*  /******************************************************************/ 04786000
*  /*  FREE BUFFER GOTTEN ON THE OIDCARD PROMPT                      */ 04787000
*  /******************************************************************/ 04788000
*                                                                  1395 04789000
*  IF INBUF ^= ZERO               /* IF BUFFER EXISTS - FREE IT      */ 04790000
*    THEN DO;                                                      1395 04791000
@RC01392 DS    0H                                                  1395 04792000
@RC01390 DS    0H                                                  1395 04793000
@RC01385 L     @08,INBUF                                           1395 04794000
         LTR   @08,@08                                             1395 04795000
         BZ    @RF01395                                            1395 04796000
*      RFY (LENSTR) RSTD;                                          1397 04797000
*      LENSTR = HOLDLEN;          /* LENGTH TO BE FREED              */ 04798000
         LR    LENSTR,HOLDLEN                                      1398 04799000
*      GEN(FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF); /* DOIT TOIT        */ 04800000
         FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF                            04801000
*      INBUF = '0'X;              /* ZERO BUFFER PTR         @ZM44311*/ 04802000
         SLR   @08,@08                                             1400 04803000
         ST    @08,INBUF                                           1400 04804000
*      RFY (LENSTR) UNRSTD;                                        1401 04805000
*      END;                                                        1402 04806000
*END;                                                              1403 04807000
*                                                                  1403 04808000
@RF01395 DS    0H                                                  1403 04809000
@DE01364 CLC   OIDVERRC(4),@CF00046                                1403 04810000
         BE    @DL01364                                            1403 04811000
*END OIDVERFY;                                                     1404 04812000
@EL00019 DS    0H                                                  1404 04813000
@EF00019 DS    0H                                                  1404 04814000
@ER00019 LM    @14,@12,@SA00019                                    1404 04815000
         BR    @14                                                 1404 04816000
*/********************************************************************/ 04817000
*/*                                                                  */ 04818000
*/*SEGMENT-                                                          */ 04819000
*/*          RECONRAC                                                */ 04820000
*/*                                                                  */ 04821000
*/*FUNCTION-                                                         */ 04822000
*/*          THIS SEGMENT HANDLES RACINIT FOR LOGON RECONNECT        */ 04823000
*/*                                                                  */ 04824000
*/*      @G32OPKU-                                                   */ 04825000
*/*          THIS SEGMENT ADDED FOR RACF VERSION 2 SUPPORT           */ 04826000
*/*                                                                  */ 04827000
*/********************************************************************/ 04828000
*RECONRAC:                                                         1405 04829000
*        PROCEDURE;                                                1405 04830000
*                                                                  1405 04831000
*                                                                  1405 04832000
RECONRAC STM   @14,@12,@SA00020                                    1405 04833000
*CALL RACINIT;                                                     1406 04834000
*                                                                  1406 04835000
         BAL   @14,RACINIT                                         1406 04836000
*ONCEAGAN:                                                         1407 04837000
*                                                                  1407 04838000
*DO WHILE RETCODE = OIDREQD |        /* OIDCARD REQUIRED             */ 04839000
*         RETCODE = OIDINV;          /* OIDCARD INVALID              */ 04840000
ONCEAGAN B     @DE01407                                            1407 04841000
@DL01407 DS    0H                                                  1408 04842000
*  IF LWANORDR = NO  &               /* IF TERMINAL TYPE             */ 04843000
*            BADVERFY = NO           /* SUPPORTS OIDCARD RDR         */ 04844000
*    THEN DO;                        /* AND NOT BAD VERIFY           */ 04845000
         L     @08,LWAPTR                                          1408 04846000
         TM    LWANORDR(@08),B'01000000'                           1408 04847000
         BNZ   @RF01408                                            1408 04848000
         TM    BADVERFY,B'00000001'                                1408 04849000
         BNZ   @RF01408                                            1408 04850000
*      IF RETCODE = OIDREQD          /* CHECK FOR MESSAGE            */ 04851000
*        THEN                        /*                              */ 04852000
         CLC   RETCODE(4),@CF00499                                 1410 04853000
         BNE   @RF01410                                            1410 04854000
*          PMSGNM = MSG56434;        /* OIDCARD REQ'D MSG            */ 04855000
         MVC   PMSGNM(2),@CH00937                                  1411 04856000
*        ELSE                        /* ASSUME OIDCARD               */ 04857000
*          PMSGNM = MSG56433;        /* NOT AUTHORIZED MSG           */ 04858000
*                                                                  1412 04859000
         B     @RC01410                                            1412 04860000
@RF01410 MVC   PMSGNM(2),@CH00935                                  1412 04861000
*      CALL OIDVERFY;                /* VERIFY OIDCARD               */ 04862000
*                                                                  1413 04863000
@RC01410 BAL   @14,OIDVERFY                                        1413 04864000
*      IF OIDVERRC = ZERO            /* OIDCARD OK ??                */ 04865000
*        THEN                        /* YES, NEXT GIVE RACF          */ 04866000
         L     @08,OIDVERRC                                        1414 04867000
         LTR   @08,@08                                             1414 04868000
         BNZ   @RF01414                                            1414 04869000
*          CALL RACINIT;             /* A CRACK AT IT                */ 04870000
         BAL   @14,RACINIT                                         1415 04871000
*        ELSE                        /* NO,                          */ 04872000
*          GOTO CLEANUP4;            /* GOTO ERROR EXIT              */ 04873000
*    END;                                                          1417 04874000
*END;                                                              1418 04875000
*                                                                  1418 04876000
@RF01408 DS    0H                                                  1418 04877000
@DE01407 L     @08,RETCODE                                         1418 04878000
         C     @08,@CF00499                                        1418 04879000
         BE    @DL01407                                            1418 04880000
         C     @08,@CF00175                                        1418 04881000
         BE    @DL01407                                            1418 04882000
*DO WHILE RETCODE = PSWDEXP |        /* OLD PASSWORD EXPIRED         */ 04883000
*         RETCODE = INVNPSWD |       /* NEW PASSWORD INVALID         */ 04884000
*         RETCODE = INVPSWD;         /* ENTERED PASSWD INVALID       */ 04885000
*                                                                  1419 04886000
         B     @DE01419                                            1419 04887000
@DL01419 DS    0H                                                  1420 04888000
*  IF RETCODE = PSWDEXP                                            1420 04889000
*    THEN DO;                                                      1420 04890000
         CLC   RETCODE(4),@CF00034                                 1420 04891000
         BNE   @RF01420                                            1420 04892000
*      PMSGNM = MSG56415;            /* PASSWORD EXPIRED MSG         */ 04893000
         MVC   PMSGNM(2),@CH00919                                  1422 04894000
*      PRMTSWC = PNPSWD;             /* PROMPT FOR NEW PASSWORD      */ 04895000
         MVC   PRMTSWC(2),@CH00133                                 1423 04896000
*      END;                                                        1424 04897000
*    ELSE                                                          1425 04898000
*      IF RETCODE = INVNPSWD         /* INVALID NEW PASSWORD         */ 04899000
*        THEN DO;                                                  1425 04900000
         B     @RC01420                                            1425 04901000
@RF01420 CLC   RETCODE(4),@CF00145                                 1425 04902000
         BNE   @RF01425                                            1425 04903000
*        PRMTSWC = PNPSWD;           /* PROMPT FOR NEW PASSWORD      */ 04904000
         MVC   PRMTSWC(2),@CH00133                                 1427 04905000
*        PMSGNM = MSG56414;          /* INVALID NEW PASSWORD MSG     */ 04906000
         MVC   PMSGNM(2),@CH00601                                  1428 04907000
*        END;                                                      1429 04908000
*      ELSE DO;                                                    1430 04909000
         B     @RC01425                                            1430 04910000
@RF01425 DS    0H                                                  1431 04911000
*        IF LWPPSWDL = ZERO          /* IF NO PASSWORD GIVEN         */ 04912000
*          THEN PMSGNM = ZERO;       /* REQUEST PASSWORD FROM USER   */ 04913000
         SLR   @08,@08                                             1431 04914000
         L     @01,LWPPTR                                          1431 04915000
         CH    @08,LWPPSWDL(,@01)                                  1431 04916000
         BNE   @RF01431                                            1431 04917000
         STH   @08,PMSGNM                                          1432 04918000
*          ELSE PMSGNM = MSG56421;   /* TRUELY AN INVALID PASSWORD   */ 04919000
         B     @RC01431                                            1433 04920000
@RF01431 MVC   PMSGNM(2),@CH00046                                  1433 04921000
*        PRMTSWC = 2;                /* PROMPT FOR ANOTHER PASSWORD  */ 04922000
@RC01431 MVC   PRMTSWC(2),@CH00135                                 1434 04923000
*        END;                                                      1435 04924000
*                                                                  1435 04925000
*  CALL PROMPT;                      /* PROMPT USER FOR NEW PASSWORD */ 04926000
*                                                                  1436 04927000
@RC01425 DS    0H                                                  1436 04928000
@RC01420 BAL   @14,PROMPT                                          1436 04929000
*  CALL RACINIT;                     /* TEST IT OUT ON RACINIT AGAIN */ 04930000
*                                                                  1437 04931000
         BAL   @14,RACINIT                                         1437 04932000
*  END;                                                            1438 04933000
@DE01419 L     @08,RETCODE                                         1438 04934000
         C     @08,@CF00034                                        1438 04935000
         BE    @DL01419                                            1438 04936000
         C     @08,@CF00145                                        1438 04937000
         BE    @DL01419                                            1438 04938000
         C     @08,@CF00046                                        1438 04939000
         BE    @DL01419                                            1438 04940000
*IF RETCODE ^= ZERO &                /* IF UNSUCCESSFUL AND          */ 04941000
*   RETCODE ^= NORACF                /* RACF IS ACTIVE, CHECK FOR ERR*/ 04942000
*  THEN DO;                                                        1439 04943000
         LTR   @08,@08                                             1439 04944000
         BZ    @RF01439                                            1439 04945000
         C     @08,@CF00357                                        1439 04946000
         BE    @RF01439                                            1439 04947000
*    IF RETCODE = NOPROF             /* USERID NOT DEFINED TO RACF   */ 04948000
*      THEN DO;                                                    1441 04949000
         C     @08,@CF00098                                        1441 04950000
         BNE   @RF01441                                            1441 04951000
*        DUMMYRAC = YES;             /* DO DUMMY RACINIT             */ 04952000
*                                                                  1443 04953000
         OI    DUMMYRAC,B'00000010'                                1443 04954000
*        CALL RACINIT;                                             1444 04955000
*                                                                  1444 04956000
         BAL   @14,RACINIT                                         1444 04957000
*        DUMMYRAC = NO;              /* TURN OFF DUMMY SWITCH        */ 04958000
         NI    DUMMYRAC,B'11111101'                                1445 04959000
*        LWPNPSWL = 0;               /* USER NOT DEFINED TO RACF   1446 04960000
*                                       CAN'T USE NEW PASSWD @ZM44711*/ 04961000
         SLR   @08,@08                                             1446 04962000
         L     @01,LWPPTR                                          1446 04963000
         STH   @08,LWPNPSWL(,@01)                                  1446 04964000
*        IF RETCODE ^= ZERO &        /* IF NOT SUCCESSFUL AND        */ 04965000
*           RETCODE ^= NORACF        /* RACF IS ACTIVE               */ 04966000
*          THEN                                                    1447 04967000
         L     @15,RETCODE                                         1447 04968000
         CR    @15,@08                                             1447 04969000
         BE    @RF01447                                            1447 04970000
         C     @15,@CF00357                                        1447 04971000
         BNE   @RT01447                                            1447 04972000
*            GOTO CLEANUP4;          /* BUZZ OFF IN PEACE            */ 04973000
*      END;                                                        1449 04974000
*    ELSE DO;                        /* USER IS DEFINED TO RACF      */ 04975000
         B     @RC01441                                            1450 04976000
@RF01441 DS    0H                                                  1451 04977000
*      IF RETCODE = INVGROUP         /* BUT GROUP NOT AUTHORIZED     */ 04978000
*        THEN                        /* SEND MSG                     */ 04979000
         CLC   RETCODE(4),@CF00340                                 1451 04980000
         BNE   @RF01451                                            1451 04981000
*          PMSGNM = MSG56441;        /* RECON REJECT GROUP INVALID   */ 04982000
         MVC   PMSGNM(2),@CH00950                                  1452 04983000
*        ELSE                        /* ANOTHER POSSIBILITY IS...    */ 04984000
*          IF RETCODE = GROUPREV     /* USERS GROUP  REVOKED         */ 04985000
*            THEN                    /* TELL THE POOR SLOB RECONECT  */ 04986000
         B     @RC01451                                            1453 04987000
@RF01451 CLC   RETCODE(4),@CF00497                                 1453 04988000
         BNE   @RF01453                                            1453 04989000
*              PMSGNM = MSG56444;    /* REJECTED - GROUP REVOKED     */ 04990000
         MVC   PMSGNM(2),@CH00956                                  1454 04991000
*            ELSE                    /* IF NON OF THE ABOVE...       */ 04992000
*              IF RETCODE = OIDREQD | /* OID REQD?                   */ 04993000
*                 RETCODE = OIDINV   /* OR INVALID ?                 */ 04994000
*                THEN                /* YES ,START                   */ 04995000
         B     @RC01453                                            1455 04996000
@RF01453 L     @08,RETCODE                                         1455 04997000
         C     @08,@CF00499                                        1455 04998000
         BE    @RT01455                                            1455 04999000
         C     @08,@CF00175                                        1455 05000000
         BE    @RT01455                                            1455 05001000
*                  GOTO ONCEAGAN;    /* OVER AT TOP                  */ 05002000
*                ELSE                                              1457 05003000
*                  GOTO CLEANUP4;    /* SELL YOUR WAR BONDS          */ 05004000
         B     CLEANUP4                                            1457 05005000
*      CALL LGM;                     /* PUT OUT THE MSG              */ 05006000
*                                                                  1458 05007000
@RC01453 DS    0H                                                  1458 05008000
@RC01451 BAL   @14,LGM                                             1458 05009000
*      NOPRMPT = YES;                /* SET UP  FOR ANOTHER LOGON    */ 05010000
         OI    NOPRMPT,B'00100000'                                 1459 05011000
*      STATUS = CONTINUE;            /* OK TO TRY AGAIN              */ 05012000
         SLR   @08,@08                                             1460 05013000
         ST    @08,STATUS                                          1460 05014000
*      GOTO CLEANUP0;                /* I KNEW WE WOULD BE EXITING   */ 05015000
         B     CLEANUP0                                            1461 05016000
*      END;                          /* SOONER OR LATER  BUT THIS ?? */ 05017000
*  END;                                                            1463 05018000
*                                                                  1463 05019000
*                                                                  1463 05020000
*END RECONRAC;                                                     1464 05021000
@EL00020 DS    0H                                                  1464 05022000
@EF00020 DS    0H                                                  1464 05023000
@ER00020 LM    @14,@12,@SA00020                                    1464 05024000
         BR    @14                                                 1464 05025000
*/********************************************************************/ 05026000
*/*                                                                  */ 05027000
*/*SEGMENT-                                                          */ 05028000
*/*          RACFDEL                                                 */ 05029000
*/*                                                                  */ 05030000
*/*FUNCTION-                                                         */ 05031000
*/*          SEGMENT ISSUES RACINIT TO DELETE SECURITY RELATED       */ 05032000
*/*          CONTROL BLOCKS                                          */ 05033000
*/*                                                                  */ 05034000
*/*      @G32OPKU-                                                   */ 05035000
*/*          NEW SEGMENT ADDED FOR RACF VERSION 2 SUPPORT            */ 05036000
*/*                                                                  */ 05037000
*/********************************************************************/ 05038000
*RACFDEL:                                                          1465 05039000
*        PROCEDURE;                                                1465 05040000
*                                                                  1465 05041000
*                                                                  1465 05042000
RACFDEL  STM   @14,@12,@SA00021                                    1465 05043000
*IF LWARACF = YES                    /* IF RACF ENVIRONMENT EXISTED  */ 05044000
*  THEN DO;                                                        1466 05045000
         L     @08,LWAPTR                                          1466 05046000
         TM    LWARACF(@08),B'01000000'                            1466 05047000
         BNO   @RF01466                                            1466 05048000
*    LWARACF = NO;                   /* TURN OFF BIT AND DELETE RACF */ 05049000
         NI    LWARACF(@08),B'10111111'                            1468 05050000
*    RFY (GPR15P) RSTD;                                            1469 05051000
*      DO; /* RACINIT  MF(E,RACLST,COMPLETE) ENVIR(DELETE)*/       1470 05052000
*      RACLST = RACLST && RACLST;/*INIT. LIST*/                    1471 05053000
         XC    RACLST(48),RACLST                                   1471 05054000
*      RACLST01 = 48;/*PARM LIST LENGTH*/                          1472 05055000
         MVI   RACLST01,X'30'                                      1472 05056000
*      RACLST02 = '00000000'B;/*RESERVED FIELD*/                   1473 05057000
         MVI   RACLST02,B'00000000'                                1473 05058000
*      RACLST03 = '00000000'B;/*RESERVED FIELD*/                   1474 05059000
         MVI   RACLST03,B'00000000'                                1474 05060000
*      RACLST04 = '10000000'B; /*SET ENVIR FLAGS*/                 1475 05061000
         MVI   RACLST04,B'10000000'                                1475 05062000
*      RESPECIFY GPR01P RESTRICTED;                                1476 05063000
*      GPR01P = ADDR(RACLST); /*ADDR OF RACINIT LIST*/             1477 05064000
         LA    GPR01P,RACLST                                       1477 05065000
*      IF CVTRAC^=0 & RCVTRNA='0'B THEN/*RACF ACTIVE*/             1478 05066000
         L     @14,CVTPTR                                          1478 05067000
         L     @14,CVTRAC(,@14)                                    1478 05068000
         LTR   @14,@14                                             1478 05069000
         BZ    @RF01478                                            1478 05070000
         TM    RCVTRNA(@14),B'10000000'                            1478 05071000
         BNZ   @RF01478                                            1478 05072000
*      SVC (131); /*ISSUE RACINIT SVC*/                            1479 05073000
         SVC   131                                                 1479 05074000
*      ELSE/*RACF NOT ACTIVE*/                                     1480 05075000
*      DO;                                                         1480 05076000
         B     @RC01478                                            1480 05077000
@RF01478 DS    0H                                                  1481 05078000
*      RFY GPR15P RSTD;                                            1481 05079000
*      GPR15P=32;/*SET RACF NOT ACTIVE RET CODE*/                  1482 05080000
         LA    GPR15P,32                                           1482 05081000
*      RFY GPR15P UNRSTD;                                          1483 05082000
*      END;                                                        1484 05083000
*      RESPECIFY GPR01P UNRESTRICTED;                              1485 05084000
@RC01478 DS    0H                                                  1486 05085000
*      END; /* RACINIT  MF(E,RACLST,COMPLETE) ENVIR(DELETE)*/      1486 05086000
*                                                                  1486 05087000
*    RETCODE = GPR15P;               /* SAVE RETURN CODE             */ 05088000
         ST    GPR15P,RETCODE                                      1487 05089000
*    RFY (GPR15P) UNRSTD;                                          1488 05090000
*                                                                  1488 05091000
*    IF RETCODE ^= ZERO              /* IF RETURN CODE WAS BAD       */ 05092000
*      THEN DO;                      /* SEE YA 'ROUND CHARLIE        */ 05093000
         L     @08,RETCODE                                         1489 05094000
         LTR   @08,@08                                             1489 05095000
         BZ    @RF01489                                            1489 05096000
*        PMSGNM = MSG56416;          /* RACINIT ERROR, SET INSERTS   */ 05097000
         MVC   PMSGNM(2),@CH00921                                  1491 05098000
*        TEXTINT1(3) = ADDR(INSLOGON);/* LOGON TERMINATE             */ 05099000
         LA    @08,INSLOGON                                        1492 05100000
         ST    @08,TEXTINT1+8                                      1492 05101000
*        TEXTINT1(1) = ADDR(INSRINIT);/* RACINIT ERROR               */ 05102000
         LA    @08,INSRINIT                                        1493 05103000
         ST    @08,TEXTINT1                                        1493 05104000
*        TEXTINT1(2) = ADDR(TEXTSEGS(1));/* ERROR RETURN CODE        */ 05105000
         LA    @08,TEXTSEGS                                        1494 05106000
         ST    @08,TEXTINT1+4                                      1494 05107000
*        CALL BLDNUMB(RETCODE,TEXTSEGS(1));/*CONVERT RET CODE        */ 05108000
*                                                                  1495 05109000
         LA    @08,RETCODE                                         1495 05110000
         ST    @08,@AL00001                                        1495 05111000
         LA    @08,TEXTSEGS                                        1495 05112000
         ST    @08,@AL00001+4                                      1495 05113000
         LA    @01,@AL00001                                        1495 05114000
         BAL   @14,BLDNUMB                                         1495 05115000
*        CALL LGM;                   /* SEND ERROR MESSAGE           */ 05116000
*                                                                  1496 05117000
         BAL   @14,LGM                                             1496 05118000
*        CALL CLEANUP4;              /* EXIT STAGE RIGHT             */ 05119000
         BAL   @14,CLEANUP4                                        1497 05120000
*        END;                                                      1498 05121000
*    END;                                                          1499 05122000
*                                                                  1499 05123000
*                                                                  1499 05124000
*END RACFDEL;                                                      1500 05125000
@EL00021 DS    0H                                                  1500 05126000
@EF00021 DS    0H                                                  1500 05127000
@ER00021 LM    @14,@12,@SA00021                                    1500 05128000
         BR    @14                                                 1500 05129000
*/********************************************************************/ 05130000
*/*                                                                  */ 05131000
*/*SEGMENT-                                                          */ 05132000
*/*          FDOLDTSB                                                */ 05133000
*/*                                                                  */ 05134000
*/*FUNCTION-                                                         */ 05135000
*/*          THIS SEGMENT CALLS TSBSRCH TO SEARCH OLD TSBS FOR       */ 05136000
*/*          RECONNECT                                               */ 05137000
*/*                                                                  */ 05138000
*/*      @G32OPKU-                                                   */ 05139000
*/*          NEW SEGMENT ADDED FOR RACF VERSION 2 SUPPORT            */ 05140000
*/*                                                                  */ 05141000
*/********************************************************************/ 05142000
*FDOLDTSB:                                                         1501 05143000
*        PROCEDURE;                                                1501 05144000
*                                                                  1501 05145000
*                                                                  1501 05146000
FDOLDTSB STM   @14,@12,@SA00022                                    1501 05147000
*RETCODE = RPSWDBAD;                 /* INIT FOR LOOP                */ 05148000
         MVC   RETCODE(4),@CF00098                                 1502 05149000
*RECONUSR = LWPUSER;                 /* USERID FOR RECONNECT         */ 05150000
         MVI   RECONUSR+7,C' '                                     1503 05151000
         L     @08,LWPPTR                                          1503 05152000
         MVC   RECONUSR(7),LWPUSER(@08)                            1503 05153000
*IF LWPPSWDL = 0                     /* IF NO PASSWORD               */ 05154000
*  THEN                                                            1504 05155000
         LH    @08,LWPPSWDL(,@08)                                  1504 05156000
         LTR   @08,@08                                             1504 05157000
         BNZ   @RF01504                                            1504 05158000
*    RECONPSW = '';                  /* BLANK FIELD                  */ 05159000
         MVI   RECONPSW,C' '                                       1505 05160000
         MVC   RECONPSW+1(7),RECONPSW                              1505 05161000
*  ELSE                                                            1506 05162000
*    RECONPSW = LWPPSWD;             /* FILL IN PASSWORD             */ 05163000
         B     @RC01504                                            1506 05164000
@RF01504 L     @08,LWPPTR                                          1506 05165000
         MVC   RECONPSW(8),LWPPSWD(@08)                            1506 05166000
*DO WHILE RETCODE = RPSWDBAD;        /* TRY FOR MATCHING PASSWORD    */ 05167000
@RC01504 B     @DE01507                                            1507 05168000
@DL01507 DS    0H                                                  1508 05169000
*  RECUSRID = ADDR(RECONUSR);        /* PTR TO USERID                */ 05170000
         LA    @08,RECONUSR                                        1508 05171000
         ST    @08,RECUSRID                                        1508 05172000
*  RECPSWD = ADDR(RECONPSW);         /* PTR TO PASSWORD              */ 05173000
         LA    @08,RECONPSW                                        1509 05174000
         ST    @08,RECPSWD                                         1509 05175000
*  ROLDTSB = ''B;                    /* ZERO RETURN FIELD            */ 05176000
         SLR   @08,@08                                             1510 05177000
         ST    @08,ROLDTSB                                         1510 05178000
*  RFY (PARMPTR,RTNREG) RSTD;                                      1511 05179000
*                                                                  1511 05180000
*  PARMPTR = ADDR(XSFPARM);          /* SET UP PARM LIST             */ 05181000
         LA    PARMPTR,XSFPARM                                     1512 05182000
*  CALL TSBSRCH;                                                   1513 05183000
         BAL   @14,TSBSRCH                                         1513 05184000
*  RETCODE = RTNREG;                 /* SAVE RETURN CODE             */ 05185000
         ST    RTNREG,RETCODE                                      1514 05186000
*  RFY (PARMPTR,RTNREG) UNRSTD;                                    1515 05187000
*  IF RETCODE = ZERO                 /* SUCCESSFUL                   */ 05188000
*    THEN DO;                                                      1516 05189000
         L     @08,RETCODE                                         1516 05190000
         LTR   @08,@08                                             1516 05191000
         BNZ   @RF01516                                            1516 05192000
*      CALL SETLOCK;                 /* GET CMS LOCK FOR TSB         */ 05193000
         BAL   @14,SETLOCK                                         1518 05194000
*      LWPGRP = ROLDTSB->TSBSF1;     /* GET OLD MEMORY GROUP NAME    */ 05195000
         L     @08,LWPPTR                                          1519 05196000
         L     @01,ROLDTSB                                         1519 05197000
         MVC   LWPGRP(8,@08),TSBSF1(@01)                           1519 05198000
*      CALL RELLOCK;                 /* RELEASE LOCAL/CMS LOCKS      */ 05199000
*                                                                  1520 05200000
         BAL   @14,RELLOCK                                         1520 05201000
*      LWPGRPL = LENGTH(LWPGRP);     /* PRIME FOR LEN=8 CASE @ZM44318*/ 05202000
         LA    @08,8                                               1521 05203000
         L     @01,LWPPTR                                          1521 05204000
         STH   @08,LWPGRPL(,@01)                                   1521 05205000
*      DO I = LENGTH(LWPGRP) TO 1 BY -1 /* FIND LEN OF GROUP NAME    */ 05206000
*        WHILE LWPGRP(I) = ' ';      /*                      @ZM44318*/ 05207000
         LR    I,@08                                               1522 05208000
@DL01522 L     @08,LWPPTR                                          1522 05209000
         LR    @03,@08                                             1522 05210000
         ALR   @03,I                                               1522 05211000
         CLI   LWPGRP-1(@03),C' '                                  1522 05212000
         BNE   @DC01522                                            1522 05213000
*        LWPGRPL = I - 1;            /* SET LENGTH OF GROUP          */ 05214000
         LR    @03,I                                               1523 05215000
         BCTR  @03,0                                               1523 05216000
         STH   @03,LWPGRPL(,@08)                                   1523 05217000
*        END;                                                      1524 05218000
         BCTR  I,0                                                 1524 05219000
         LTR   I,I                                                 1524 05220000
         BP    @DL01522                                            1524 05221000
@DC01522 DS    0H                                                  1525 05222000
*      LWPGRPM = I+4;                /* SET GROUP LEN PLUS 4 @ZM44318*/ 05223000
         LA    @08,4                                               1525 05224000
         ALR   @08,I                                               1525 05225000
         L     @03,LWPPTR                                          1525 05226000
         STH   @08,LWPGRPM(,@03)                                   1525 05227000
*    END;                                                          1526 05228000
*                                                                  1526 05229000
*    ELSE                                                          1527 05230000
*      IF RETCODE = RPSWDBAD         /* PASSWORD DID NOT MATCH       */ 05231000
*        THEN DO;                                                  1527 05232000
         B     @RC01516                                            1527 05233000
@RF01516 CLC   RETCODE(4),@CF00098                                 1527 05234000
         BNE   @RF01527                                            1527 05235000
*          IF RECONPSW = ' '         /* IF NO PASSWORD               */ 05236000
*            THEN                    /* PUT OUT MSG                  */ 05237000
         CLI   RECONPSW,C' '                                       1529 05238000
         BNE   @RF01529                                            1529 05239000
*              PMSGNM = 40;          /* PASSWORD REQUIRED            */ 05240000
         MVC   PMSGNM(2),@CH00499                                  1530 05241000
*            ELSE                    /* IF PASSWORD INVALID          */ 05242000
*              PMSGNM = 39;          /* ISSUE PASSWORD INVALID MSG   */ 05243000
         B     @RC01529                                            1531 05244000
@RF01529 MVC   PMSGNM(2),@CH03174                                  1531 05245000
*          PRMTSWC = 2;              /* PROMPT FOR PASSWORD          */ 05246000
*                                                                  1532 05247000
@RC01529 MVC   PRMTSWC(2),@CH00135                                 1532 05248000
*          CALL PROMPT;              /* PROMPT USER                  */ 05249000
*                                                                  1533 05250000
         BAL   @14,PROMPT                                          1533 05251000
*          RECONPSW = LWPPSWD;       /* SET IN NEW PASSWORD          */ 05252000
         L     @08,LWPPTR                                          1534 05253000
         MVC   RECONPSW(8),LWPPSWD(@08)                            1534 05254000
*          END;                                                    1535 05255000
*                                                                  1535 05256000
*        ELSE                                                      1536 05257000
*          IF RETCODE = RUIDNOT |    /* IF USERID NOT FOUND          */ 05258000
*             RETCODE = RUIDUSED     /* OR ALREADY IN USE            */ 05259000
*            THEN DO;                                              1536 05260000
         B     @RC01527                                            1536 05261000
@RF01527 L     @08,RETCODE                                         1536 05262000
         C     @08,@CF00046                                        1536 05263000
         BE    @RT01536                                            1536 05264000
         C     @08,@CF00034                                        1536 05265000
         BNE   @RF01536                                            1536 05266000
@RT01536 DS    0H                                                  1537 05267000
*              IF RETCODE = RUIDNOT  /* IF USERID NOT FOUND          */ 05268000
*                THEN                                              1538 05269000
         CLC   RETCODE(4),@CF00046                                 1538 05270000
         BNE   @RF01538                                            1538 05271000
*                  PMSGNM = 42;      /* USERID NOT FOUND MSG         */ 05272000
         MVC   PMSGNM(2),@CH03175                                  1539 05273000
*                ELSE                                              1540 05274000
*                  PMSGNM = 43;      /* USERID IN USE MSG            */ 05275000
         B     @RC01538                                            1540 05276000
@RF01538 MVC   PMSGNM(2),@CH03176                                  1540 05277000
*              TEXTINT1(1) = ADDR(LWPUSERI);/* MOVE IN USERID        */ 05278000
@RC01538 L     @08,LWPPTR                                          1541 05279000
         LA    @08,LWPUSERI(,@08)                                  1541 05280000
         ST    @08,TEXTINT1                                        1541 05281000
*              CALL LGM;             /* GO TELL USER                 */ 05282000
         BAL   @14,LGM                                             1542 05283000
*              NOPRMPT = YES;        /* TELL LOGON TO START AGAIN    */ 05284000
         OI    NOPRMPT,B'00100000'                                 1543 05285000
*              GOTO CLEANUP4;        /* PACK IT IN JETHROW           */ 05286000
         B     CLEANUP4                                            1544 05287000
*              END;                                                1545 05288000
*                                                                  1545 05289000
*            ELSE DO;                /* SET UP ERROR MESSAGE         */ 05290000
@RF01536 DS    0H                                                  1547 05291000
*              RFY (RTNREG) RSTD;                                  1547 05292000
*              RTNREG = RETCODE;     /* SETUP FOR CVD INST           */ 05293000
         L     RTNREG,RETCODE                                      1548 05294000
*              GEN REFS(RTNREG,PACKDEC);/* PREPARE RTN CODE FOR MSG  */ 05295000
         CVD   RTNREG,PACKDEC               CONVERT TO DECIMAL          05296000
         UNPK  ZONEDEC(8),PACKDEC(8)        UNPACK                      05297000
         OI    ZONEDEC+7,X'F0'              CHANGE SIGN                 05298000
*              RFY (RTNREG) UNRSTD;                                1550 05299000
*                                                                  1550 05300000
*              STATUS = CONTINUE;    /* OK TO GO ON                  */ 05301000
*                                                                  1551 05302000
         SLR   @08,@08                                             1551 05303000
         ST    @08,STATUS                                          1551 05304000
*              PMSGNM=20;            /*SET MSG NUMBER TO             */ 05305000
         MVC   PMSGNM(2),@CH00340                                  1552 05306000
*                                    /*SERVICE RTN ERROR             */ 05307000
*              TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*GET ADDR OF ERROR    */ 05308000
         LA    @15,TEXTSEGS                                        1553 05309000
         ST    @15,TEXTINT1                                        1553 05310000
*                                    /*ROUTINE SEGMENT               */ 05311000
*              TEXTSLEN(1)=8;        /*SET LEN OF TEXT               */ 05312000
         MVC   TEXTSLEN(2),@CH00046                                1554 05313000
*              TEXTSOST(1)=0;        /*SET OFFSET OF TEXT            */ 05314000
         STH   @08,TEXTSOST                                        1555 05315000
*              TEXTSTXT(1,1:7)='IKJEFLE';/*ERR MOD NAME              */ 05316000
*                                                                  1556 05317000
         MVC   TEXTSTXT(7),@CC03209                                1556 05318000
*              TEXTINT1(2)=ADDR(TEXTSEGS(2)); /*GET ADDR OF ERROR    */ 05319000
         LA    @15,TEXTSEGS+24                                     1557 05320000
         ST    @15,TEXTINT1+4                                      1557 05321000
*                                    /*RETURN CODE SEGMENT           */ 05322000
*              TEXTSLEN(2)=7;        /*SET LEN OF TEXT               */ 05323000
         MVC   TEXTSLEN+24(2),@CH00133                             1558 05324000
*              TEXTSOST(2)=0;        /*SET OFFSET OF TEXT            */ 05325000
         STH   @08,TEXTSOST+24                                     1559 05326000
*              TEXTSTXT(2,1:3)=ZONEDEC(6:8); /*PUT IN RETURN CODE    */ 05327000
*                                                                  1560 05328000
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1560 05329000
*              IF LWPUSERL ^=0       /*IF USERID IS KNOWN,           */ 05330000
*                THEN                /* THEN POINT TO USERID SEG     */ 05331000
         L     @15,LWPPTR                                          1561 05332000
         CH    @08,LWPUSERL(,@15)                                  1561 05333000
         BE    @RF01561                                            1561 05334000
*                  TEXTINT1(3)=ADDR(LWPUSERI);                     1562 05335000
         LA    @08,LWPUSERI(,@15)                                  1562 05336000
         ST    @08,TEXTINT1+8                                      1562 05337000
*                                    /*ELSE USERID IS UNKNOWN        */ 05338000
*                  ELSE TEXTINT1(3)=0;                             1563 05339000
*                                                                  1563 05340000
         B     @RC01561                                            1563 05341000
@RF01561 SLR   @08,@08                                             1563 05342000
         ST    @08,TEXTINT1+8                                      1563 05343000
*              IF LWPPROCL ^=0       /*IF PROCNAME IS KNOWN          */ 05344000
*                THEN                /*THEN POINT TO PROC SGMENT     */ 05345000
@RC01561 L     @08,LWPPTR                                          1564 05346000
         LH    @15,LWPPROCL(,@08)                                  1564 05347000
         LTR   @15,@15                                             1564 05348000
         BZ    @RF01564                                            1564 05349000
*                  TEXTINT1(4)=ADDR(LWPPROCI);                     1565 05350000
         LA    @08,LWPPROCI(,@08)                                  1565 05351000
         ST    @08,TEXTINT1+12                                     1565 05352000
*                                    /*ELSE PROC IS UNKNOWN          */ 05353000
*                ELSE TEXTINT1(4)=0;                               1566 05354000
         B     @RC01564                                            1566 05355000
@RF01564 SLR   @08,@08                                             1566 05356000
         ST    @08,TEXTINT1+12                                     1566 05357000
*              CALL LGM;             /*PUT OUT ERROR MESSAGE         */ 05358000
@RC01564 BAL   @14,LGM                                             1567 05359000
*              GO TO CLEANUP4;       /*AND CLOSE OUT LOGON           */ 05360000
         B     CLEANUP4                                            1568 05361000
*            END;                                                  1569 05362000
*END;                                                              1570 05363000
@RC01527 DS    0H                                                  1570 05364000
@RC01516 DS    0H                                                  1570 05365000
@DE01507 CLC   RETCODE(4),@CF00098                                 1570 05366000
         BE    @DL01507                                            1570 05367000
*TSBSRCH:                                                          1571 05368000
*   PROC OPTIONS(NOSAVE(15));                                      1571 05369000
         B     @PB00023                                            1571 05370000
TSBSRCH  ST    @14,@SA00023                                        1571 05371000
         STM   @00,@12,@SA00023+4                                  1571 05372000
*   /*****************************************************************/ 05373000
*   /*                                                               */ 05374000
*   /* REGISTER DECLARES                                             */ 05375000
*   /*                                                               */ 05376000
*   /*****************************************************************/ 05377000
*   DCL                                                            1572 05378000
*     RPTPTR REG(5);                /* HOLDS ADDRESS OF TIOCRPT      */ 05379000
*   /*****************************************************************/ 05380000
*   /*                                                               */ 05381000
*   /* TEMPORARY AND AUTOMATIC VARIABLES                             */ 05382000
*   /*                                                               */ 05383000
*   /*****************************************************************/ 05384000
*   DCL                                                            1573 05385000
*    (NEWTSB,                       /* USED TO HOLD THE ADDRESS OF 1573 05386000
*                                      THE NEW TSB                   */ 05387000
*     TSBPTR2,                      /* USED TO HOLD @ OF CURRENT VTAM   05388000
*                                      TSB                           */ 05389000
*     LASTTSB,                      /* USED TO HOLD ADDRESS OF LAST     05390000
*                                      TCAM TSB                      */ 05391000
*     EXTNTPTR) PTR(31);            /* HOLDS ADDRESS OF TSB EXTENT   */ 05392000
*   DCL                                                            1574 05393000
*    (SIZETSB,                      /* HOLDS THE TSB SIZE            */ 05394000
*     RETRNCD)                      /* HOLDS THE RETURN CODE         */ 05395000
*         FIXED(31);                                               1574 05396000
*   /*****************************************************************/ 05397000
*   /*                                                               */ 05398000
*   /* THE TIOCRPT DOES NOT HAVE PLS VERSION. THE MACRO IS INVOKED   */ 05399000
*   /* HERE                                                          */ 05400000
*   /*                                                               */ 05401000
*   /*****************************************************************/ 05402000
*   GEN DATA DEFS(TIOCRPT,TIOCNTSB,TIOCTSBS,TIOCTSB);              1575 05403000
*   DCL                                                            1576 05404000
*     TIOCRPT GEND,                 /* TIOC REFERENCE POINTER TABLE  */ 05405000
*     TIOCNTSB GEND FIXED(15),      /* THE NUMBER OF TSBS            */ 05406000
*     TIOCTSBS GEND FIXED(8),       /* THE TSB SIZE                  */ 05407000
*     TIOCTSB GEND PTR(24);         /* PTR TO FIRST TIOC TSB         */ 05408000
*   NEWTSB=ASCBTSB;                                                1577 05409000
         L     @08,LWAPTR                                          1577 05410000
         L     @08,LWAPASCB(,@08)                                  1577 05411000
         L     NEWTSB,ASCBTSB(,@08)                                1577 05412000
*   RETRNCD = 8;                    /* PRIME THE PUMP FOR LOOPS      */ 05413000
         LA    RETRNCD,8                                           1578 05414000
*   CALL SETLOCK;                   /* OBTAIN LOCAL/CMS LOCK         */ 05415000
         BAL   @14,SETLOCK                                         1579 05416000
*   IF NEWTSB -> TSBVTAM = '0'B THEN/* IF NOT VTAM CHECK TCAM TSBS   */ 05417000
         TM    TSBVTAM(NEWTSB),B'00000001'                         1580 05418000
         BNZ   @RF01580                                            1580 05419000
*     DO;                                                          1581 05420000
*       RFY                                                        1582 05421000
*         ASCB BASED(TSBASCBA);                                    1582 05422000
*       RFY                                                        1583 05423000
*         CHAIN BASED(ASCBCSCB);    /* LOOK AT THE CURRENT CHCB      */ 05424000
*       RFY                                                        1584 05425000
*         RPTPTR RSTD;                                             1584 05426000
*       RPTPTR=TCXRPT;              /* ADDRESS OF TIOCRPT            */ 05427000
         L     @08,CVTPTR                                          1585 05428000
         L     @08,TCXPTR(,@08)                                    1585 05429000
         L     RPTPTR,TCXRPT(,@08)                                 1585 05430000
*       GEN(USING TIOCRPT,RPTPTR);                                 1586 05431000
         USING TIOCRPT,RPTPTR                                           05432000
*       TSBPTR=TIOCTSB;             /* START OF TCAM TSBS            */ 05433000
         L     @08,TIOCTSB-1                                       1587 05434000
         LA    @08,0(,@08)                                         1587 05435000
         ST    @08,TSBPTR                                          1587 05436000
*       SIZETSB=TIOCTSBS;           /* SIZE OF A TSB                 */ 05437000
         SLR   SIZETSB,SIZETSB                                     1588 05438000
         IC    SIZETSB,TIOCTSBS                                    1588 05439000
*       LASTTSB=TSBPTR+(SIZETSB*(TIOCNTSB-1));/* CALCULATE THE END OF   05440000
*                                      THE TCAM TSBS                 */ 05441000
         LH    @01,TIOCNTSB                                        1589 05442000
         BCTR  @01,0                                               1589 05443000
         MR    @00,SIZETSB                                         1589 05444000
         ALR   @08,@01                                             1589 05445000
         LR    LASTTSB,@08                                         1589 05446000
*       RFY                                                        1590 05447000
*         RPTPTR UNRSTD;            /* TIOCRPT @ NO LONGER NEEDED    */ 05448000
*       GEN(DROP RPTPTR);                                          1591 05449000
         DROP RPTPTR                                                    05450000
*       DO UNTIL(TSBPTR>LASTTSB|RETRNCD^=8);                       1592 05451000
@DL01592 DS    0H                                                  1593 05452000
*         IF(TSBPTR^=NEWTSB&TSBASCBA^=0) THEN /* IF THIS ISN'T THE NEW  05453000
*                                      TSB AND ASCB @ IS VALID       */ 05454000
         L     @08,TSBPTR                                          1593 05455000
         CR    @08,NEWTSB                                          1593 05456000
         BE    @RF01593                                            1593 05457000
         L     @07,TSBASCBA(,@08)                                  1593 05458000
         LTR   @07,@07                                             1593 05459000
         BZ    @RF01593                                            1593 05460000
*           IF RECONUSR=CHKEY THEN  /* IF USERID'S MATCH             */ 05461000
         L     @07,ASCBCSCB(,@07)                                  1594 05462000
         CLC   RECONUSR(8),CHKEY(@07)                              1594 05463000
         BNE   @RF01594                                            1594 05464000
*             IF TSBHUNG='0'B THEN  /* IF THIS IS OLD TSB            */ 05465000
         TM    TSBHUNG(@08),B'00010000'                            1595 05466000
         BNZ   @RF01595                                            1595 05467000
*               RETRNCD=12;                                        1596 05468000
         LA    RETRNCD,12                                          1596 05469000
*             ELSE                                                 1597 05470000
*               IF RECONPSW=TSBPSWD THEN/* IF PASSWORDS MATCH        */ 05471000
         B     @RC01595                                            1597 05472000
@RF01595 L     @08,TSBPTR                                          1597 05473000
         CLC   RECONPSW(8),TSBPSWD(@08)                            1597 05474000
         BNE   @RF01597                                            1597 05475000
*                 DO;                                              1598 05476000
*                   RETRNCD=0;      /* SUCCESSFUL RETURN CODE        */ 05477000
         SLR   RETRNCD,RETRNCD                                     1599 05478000
*                   ROLDTSB=TSBPTR;                                1600 05479000
         ST    @08,ROLDTSB                                         1600 05480000
*                 END;                                             1601 05481000
*               ELSE                                               1602 05482000
*                 RETRNCD=4;        /* PASSWORDS DON'T MATCH         */ 05483000
         B     @RC01597                                            1602 05484000
@RF01597 LA    RETRNCD,4                                           1602 05485000
*         TSBPTR=TSBPTR+SIZETSB;    /* POINT TO NEXT TCAM TSB        */ 05486000
@RC01597 DS    0H                                                  1603 05487000
@RC01595 DS    0H                                                  1603 05488000
@RF01594 DS    0H                                                  1603 05489000
@RF01593 LR    @08,SIZETSB                                         1603 05490000
         AL    @08,TSBPTR                                          1603 05491000
         ST    @08,TSBPTR                                          1603 05492000
*       END;                                                       1604 05493000
@DE01592 C     LASTTSB,TSBPTR                                      1604 05494000
         BL    @DC01592                                            1604 05495000
         C     RETRNCD,@CF00046                                    1604 05496000
         BE    @DL01592                                            1604 05497000
@DC01592 DS    0H                                                  1605 05498000
*       TSBPTR=NEWTSB;              /* RESTORE TSBPTR        @ZM44986*/ 05499000
         ST    NEWTSB,TSBPTR                                       1605 05500000
*     END;                                                         1606 05501000
*   ELSE                            /* IF THIS IS A VTAM TSB         */ 05502000
*     DO;                                                          1607 05503000
         B     @RC01580                                            1607 05504000
@RF01580 DS    0H                                                  1608 05505000
*       /*************************************************************/ 05506000
*       /*                                                           */ 05507000
*       /* CHECK VTAM TSBS                                           */ 05508000
*       /*                                                           */ 05509000
*       /*************************************************************/ 05510000
*       RFY                                                        1608 05511000
*         TSB BASED(TSBPTR2);                                      1608 05512000
*       TSBPTR2=TCASTSB;            /* PTR TO START OF VTAM TSBS     */ 05513000
         L     @08,CVTPTR                                          1609 05514000
         L     @08,TCASTPTR(,@08)                                  1609 05515000
         L     TSBPTR2,TCASTSB(,@08)                               1609 05516000
*       DO UNTIL(TSBPTR2=0|RETRNCD^=8);                            1610 05517000
@DL01610 DS    0H                                                  1611 05518000
*         EXTNTPTR=TSBEXTNT;        /* GET ADDRESS OF TSB EXTENT     */ 05519000
         L     EXTNTPTR,TSBEXTNT(,TSBPTR2)                         1611 05520000
*         RFY                                                      1612 05521000
*           TSBX BASED(EXTNTPTR);                                  1612 05522000
*         IF TSBPTR2^=NEWTSB THEN   /* IF THIS ISN'T THE NEW TSB     */ 05523000
         CR    TSBPTR2,NEWTSB                                      1613 05524000
         BE    @RF01613                                            1613 05525000
*           IF RECONUSR=TSBXUID THEN/* IF USER ID'S MATCH            */ 05526000
         CLC   RECONUSR(8),TSBXUID(EXTNTPTR)                       1614 05527000
         BNE   @RF01614                                            1614 05528000
*             IF TSBXWREC='0'B THEN /* IF USER IS STILL RUNNING      */ 05529000
         TM    TSBXWREC(EXTNTPTR),B'00010000'                      1615 05530000
         BNZ   @RF01615                                            1615 05531000
*               RETRNCD=12;         /* USER ALREADY LOGGED ON        */ 05532000
         LA    RETRNCD,12                                          1616 05533000
*             ELSE                                                 1617 05534000
*               IF RECONPSW=TSBPSWD THEN/* PASSWORD'S MATCH          */ 05535000
         B     @RC01615                                            1617 05536000
@RF01615 CLC   RECONPSW(8),TSBPSWD(TSBPTR2)                        1617 05537000
         BNE   @RF01617                                            1617 05538000
*                 DO;                                              1618 05539000
*                   RETRNCD=0;      /* SUCCESSFUL                    */ 05540000
         SLR   RETRNCD,RETRNCD                                     1619 05541000
*                   ROLDTSB=TSBPTR2;/* RETURN TSB ADDRESS            */ 05542000
         ST    TSBPTR2,ROLDTSB                                     1620 05543000
*                 END;                                             1621 05544000
*               ELSE                                               1622 05545000
*                 RETRNCD=4;        /* PASSWORDS DON'T MATCH         */ 05546000
         B     @RC01617                                            1622 05547000
@RF01617 LA    RETRNCD,4                                           1622 05548000
*         TSBPTR2=TSBXFWD;          /* ADDRESS OF NEXT VTAM TSB      */ 05549000
@RC01617 DS    0H                                                  1623 05550000
@RC01615 DS    0H                                                  1623 05551000
@RF01614 DS    0H                                                  1623 05552000
@RF01613 L     TSBPTR2,TSBXFWD(,EXTNTPTR)                          1623 05553000
*       END;                                                       1624 05554000
@DE01610 LTR   TSBPTR2,TSBPTR2                                     1624 05555000
         BZ    @DC01610                                            1624 05556000
         C     RETRNCD,@CF00046                                    1624 05557000
         BE    @DL01610                                            1624 05558000
@DC01610 DS    0H                                                  1625 05559000
*     END;                                                         1625 05560000
*   CALL RELLOCK;                   /* RELEASE LOCAL/CMS LOCKS       */ 05561000
@RC01580 BAL   @14,RELLOCK                                         1626 05562000
*   RETURN CODE(RETRNCD);           /* PUT RC IN REG 15              */ 05563000
         LR    @15,RETRNCD                                         1627 05564000
@EL00023 DS    0H                                                  1627 05565000
@EF00023 DS    0H                                                  1627 05566000
@ER00023 L     @14,@SA00023                                        1627 05567000
         LM    @00,@12,@SA00023+4                                  1627 05568000
         BR    @14                                                 1627 05569000
*   END TSBSRCH;                                                   1628 05570000
*                                                                  1628 05571000
*                                                                  1628 05572000
*END FDOLDTSB;                                                     1629 05573000
@EL00022 DS    0H                                                  1629 05574000
@EF00022 DS    0H                                                  1629 05575000
@ER00022 LM    @14,@12,@SA00022                                    1629 05576000
         BR    @14                                                 1629 05577000
@PB00022 DS    0H                                                  1630 05578000
*/********************************************************************/ 05579000
*/*                                                                  */ 05580000
*/*DECLARE-                                                          */ 05581000
*/*          PATCH AREA                                              */ 05582000
*/*                                                                  */ 05583000
*/********************************************************************/ 05584000
*   DCL PATCHLOC FIXED(31) STATIC;                                 1630 05585000
*  GEN DATA DEFS(PATCHLOC);                                        1631 05586000
*/********************************************************************/ 05587000
*/*                                                                  */ 05588000
*/*DECLARE-                                                          */ 05589000
*/*          EPILOG                                                  */ 05590000
*/*                                                                  */ 05591000
*/********************************************************************/ 05592000
*                                                                  1632 05593000
*                                                                  1632 05594000
*  DECLARE /*GENERAL PURPOSE REGISTERS */                          1632 05595000
*    GPR01F FIXED(31) REG(1),                                      1632 05596000
*    GPR01P PTR(31) REG(1),                                        1632 05597000
*    GPR15P PTR(31) REG(15);                                       1632 05598000
*  DCL 1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),  /*LIST FOR ENQ*/  1633 05599000
*    3 I05600 PTR(31),  /*TCB ADDR IF BOTH TCB AND ECB*/           1633 05600000
*    3 I05601 PTR(31),  /*TCB OR ECB ADDRESS*/                     1633 05601000
*    3 I05602 (*) CHAR(12) BDY(WORD),  /*ARRAY OF RESOURCE ELEMENTS*/   05602000
*      5 I05603 BIT(8),  /*BIT FLAGS 1*/                           1633 05603000
*      5 I05604 PTR(8),  /*MINOR RESOURCE NAME LENGTH*/            1633 05604000
*      5 I05605 BIT(8),  /*BIT FLAGS 2*/                           1633 05605000
*      5 I05655 CHAR(1),  /*CONTROL PGM USE*/                      1633 05606000
*      5 I05606 PTR(31),  /*MAJOR RESOURCE NAME ADDR*/             1633 05607000
*      5 I05607 PTR(31);  /*MINOR RESOURCE NAME ADDR*/             1633 05608000
*  DCL 1 I048 DEF(ILIST) CHAR(32767) BDY(WORD),                    1634 05609000
*     3 I04801 PTR(31) , /* TCB ADDR */                            1634 05610000
*     3 I04802(*) CHAR(12) BDY(WORD),                              1634 05611000
*        5 I04803 PTR(31), /* UCB @ IN LAST ENTRY */               1634 05612000
*           7 I04804 BIT(8),   /* FLAGS */                         1634 05613000
*           7 I04805 PTR(8),   /*MINOR RESOURCE NAME LENGTH*/      1634 05614000
*           7 I04806 BIT(8),   /* FLAGS */                         1634 05615000
*           7 *      CHAR(1),  /* CONTROL PROGRAM USE */           1634 05616000
*        5 I04807 PTR(31),  /* MAJOR RESOURCE NAME @ */            1634 05617000
*        5 I04808 PTR(31); /* MINOR RESOURCE NAME @ */             1634 05618000
*                                                                  1634 05619000
*  DECLARE ILIST CHAR(20) BDY(DWORD); /*STANDARD LIST*/            1635 05620000
*                                                                  1635 05621000
*  DECLARE /* COMMON VARIABLES */                                  1636 05622000
*    I256C CHAR(256) BASED,                                        1636 05623000
*    I031F FIXED(31) BASED,                                        1636 05624000
*    I031P PTR(31)   BASED,                                        1636 05625000
*    I015F FIXED(15) BASED,                                        1636 05626000
*    I015P PTR(15)   BASED,                                        1636 05627000
*    I008P PTR(8)    BASED,                                        1636 05628000
*    I001C CHAR(1)   BASED;                                        1636 05629000
*END IKJEFLE                                                       1637 05630000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 05631000
*/*%INCLUDE SYSLIB  (TTCXD   )                                        * 05632000
*/*%INCLUDE SYSLIB  (IKTTCAST)                                        * 05633000
*/*%INCLUDE SYSLIB  (ICHPRCVT)                                        * 05634000
*/*%INCLUDE SYSLIB  (IHAACEE )                                        * 05635000
*/*%INCLUDE SYSLIB  (IKJEFLWP)                                        * 05636000
*/*%INCLUDE SYSLIB  (IKJTSB  )                                        * 05637000
*/*%INCLUDE SYSLIB  (IKTTSBX )                                        * 05638000
*/*%INCLUDE SYSLIB  (IEFJCLS )                                        * 05639000
*/*%INCLUDE SYSLIB  (IKJEFLWA)                                        * 05640000
*/*%INCLUDE SYSLIB  (IKJEFLP0)                                        * 05641000
*/*%INCLUDE SYSLIB  (IKJECT  )                                        * 05642000
*/*%INCLUDE SYSLIB  (IEFVJSEL)                                        * 05643000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                        * 05644000
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        * 05645000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        * 05646000
*/*%INCLUDE SYSLIB  (IHAASCB )                                        * 05647000
*/*%INCLUDE SYSLIB  (IHAASXB )                                        * 05648000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 05649000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        * 05650000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                        * 05651000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        * 05652000
*/*%INCLUDE SYSLIB  (IKJEFUAD)                                        * 05653000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                        * 05654000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                        * 05655000
*/*%INCLUDE SYSLIB  (IEFJSSIB)                                        * 05656000
*;                                                                 1637 05657000
         B     @EL00001                                            1637 05658000
@DATA    DS    0H                                                       05659000
@CH00087 DC    H'3'                                                     05660000
@CH00209 DC    H'5'                                                     05661000
@CH00178 DC    H'6'                                                     05662000
@CH00133 DC    H'7'                                                     05663000
@CH00036 DC    H'9'                                                     05664000
@CH00035 DC    H'10'                                                    05665000
@CH00033 DC    H'11'                                                    05666000
@CH00601 DC    H'13'                                                    05667000
@CH02961 DC    H'14'                                                    05668000
@CH00053 DC    H'15'                                                    05669000
@CH00090 DC    H'18'                                                    05670000
@CH00483 DC    H'23'                                                    05671000
@CH03025 DC    H'27'                                                    05672000
@CH03117 DC    H'33'                                                    05673000
@CH03168 DC    H'38'                                                    05674000
@CH03174 DC    H'39'                                                    05675000
@CH03175 DC    H'42'                                                    05676000
@CH03176 DC    H'43'                                                    05677000
@CH03017 DC    H'45'                                                    05678000
@CH03019 DC    H'46'                                                    05679000
@CH02959 DC    H'49'                                                    05680000
@CH00928 DC    H'51'                                                    05681000
@CH00919 DC    H'52'                                                    05682000
@CH00921 DC    H'53'                                                    05683000
@CH00923 DC    H'54'                                                    05684000
@CH00925 DC    H'55'                                                    05685000
@CH00786 DC    H'56'                                                    05686000
@CH00931 DC    H'57'                                                    05687000
@CH00933 DC    H'58'                                                    05688000
@CH00935 DC    H'59'                                                    05689000
@CH00937 DC    H'60'                                                    05690000
@CH00939 DC    H'61'                                                    05691000
@CH00941 DC    H'62'                                                    05692000
@CH00385 DC    H'63'                                                    05693000
@CH00944 DC    H'64'                                                    05694000
@CH00948 DC    H'66'                                                    05695000
@CH00950 DC    H'67'                                                    05696000
@CH00952 DC    H'68'                                                    05697000
@CH00954 DC    H'69'                                                    05698000
@CH00956 DC    H'70'                                                    05699000
@CH02964 DC    H'32767'                                                 05700000
@SX03252 XC    UPT(0,@01),UPT(@01)                                      05701000
@SC03258 CLC   LWPACCT(0,@01),UADSANUM(@08)                             05702000
@SM03260 MVC   LWPACCT(0,@08),UADSANUM(@15)                             05703000
@SM03270 MVC   BLDTEXT(0,@08),@TS00001                                  05704000
@SM03272 MVC   LWARNM(0,@08),LWPUSER(@15)                               05705000
@SM03274 MVC   ROIDDATA(0),CMNDBUFR(@04)                                05706000
@DATD    DSECT                                                          05707000
         DS    0F                                                       05708000
@SA00001 DS    18F                                                      05709000
@PC00001 DS    5F                                                       05710000
@SA00008 DS    15F                                                      05711000
@SA00002 DS    15F                                                      05712000
@SA00016 DS    18F                                                      05713000
@SA00019 DS    15F                                                      05714000
@SA00011 DS    15F                                                      05715000
@SA00017 DS    15F                                                      05716000
@SA00018 DS    15F                                                      05717000
@SA00013 DS    15F                                                      05718000
@SA00012 DS    15F                                                      05719000
@SA00015 DS    15F                                                      05720000
@SA00014 DS    15F                                                      05721000
@PC00014 DS    2F                                                       05722000
@SA00022 DS    15F                                                      05723000
@SA00020 DS    15F                                                      05724000
@SA00021 DS    15F                                                      05725000
@SA00023 DS    14F                                                      05726000
@AL00001 DS    2A                                                       05727000
@TF00001 DS    F                                                        05728000
@ZTEMPS  DS    0F                                                       05729000
@ZT00003 DC    F'0'                                                     05730000
@ZTEMPND EQU   *                                                        05731000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         05732000
IKJEFLE  CSECT                                                          05733000
         DS    0F                                                       05734000
@CF00037 DC    F'1'                                                     05735000
@CH00037 EQU   @CF00037+2                                               05736000
@CF00135 DC    F'2'                                                     05737000
@CH00135 EQU   @CF00135+2                                               05738000
@CF00098 DC    F'4'                                                     05739000
@CH00098 EQU   @CF00098+2                                               05740000
@CF00046 DC    F'8'                                                     05741000
@CH00046 EQU   @CF00046+2                                               05742000
@CF00034 DC    F'12'                                                    05743000
@CH00034 EQU   @CF00034+2                                               05744000
@CF00145 DC    F'16'                                                    05745000
@CH00145 EQU   @CF00145+2                                               05746000
@CF00340 DC    F'20'                                                    05747000
@CH00340 EQU   @CF00340+2                                               05748000
@CF00080 DC    F'24'                                                    05749000
@CH00080 EQU   @CF00080+2                                               05750000
@CF00490 DC    F'28'                                                    05751000
@CF00357 DC    F'32'                                                    05752000
@CF00497 DC    F'36'                                                    05753000
@CH00497 EQU   @CF00497+2                                               05754000
@CF00499 DC    F'40'                                                    05755000
@CH00499 EQU   @CF00499+2                                               05756000
@CF00175 DC    F'44'                                                    05757000
@CH00175 EQU   @CF00175+2                                               05758000
@CF00502 DC    F'48'                                                    05759000
@CF03266 DC    F'16777215'                                              05760000
@CF03257 DC    XL4'0000FFFF'                                            05761000
@DATD    DSECT                                                          05762000
         DS    0D                                                       05763000
LWAPTR   DS    A                                                        05764000
LWPPTR   DS    A                                                        05765000
OIDVERRC DS    F                                                        05766000
STATUS   DS    A                                                        05767000
RETCODE  DS    A                                                        05768000
TSBPTR   DS    A                                                        05769000
SAVEPERP DS    A                                                        05770000
OPTMZRPM DS    FL4                                                      05771000
         ORG   OPTMZRPM                                                 05772000
@NM00033 DS    AL2                                                      05773000
OPTMZCD  DS    AL1                                                      05774000
OPTMZPF  DS    AL1                                                      05775000
         ORG   OPTMZRPM+4                                               05776000
UADSACCT DS    A                                                        05777000
READBUF  DS    A                                                        05778000
OIDPTR   DS    F                                                        05779000
INBUF    DS    A                                                        05780000
MAXCORE  DS    H                                                        05781000
OIDLEN   DS    FL2                                                      05782000
         ORG   OIDLEN                                                   05783000
@NM00037 DS    AL1                                                      05784000
CDLEN    DS    AL1                                                      05785000
         ORG   OIDLEN+2                                                 05786000
@TS00001 DS    CL16                                                     05787000
SWCS     DS    BL1                                                      05788000
         ORG   SWCS                                                     05789000
IOSWC    DS    BL1                                                      05790000
MSGSWC   EQU   SWCS+0                                                   05791000
NOPRMPT  EQU   SWCS+0                                                   05792000
NOPERFRM EQU   SWCS+0                                                   05793000
EXPUADS  EQU   SWCS+0                                                   05794000
CHKGROUP EQU   SWCS+0                                                   05795000
DUMMYRAC EQU   SWCS+0                                                   05796000
BADVERFY EQU   SWCS+0                                                   05797000
         ORG   SWCS+1                                                   05798000
         DS    CL3                                                      05799000
INTTEXT  DS    CL16                                                     05800000
         ORG   INTTEXT                                                  05801000
TEXTINT1 DS    4A                                                       05802000
         ORG   INTTEXT+16                                               05803000
INTTEXT2 DS    CL16                                                     05804000
         ORG   INTTEXT2                                                 05805000
TEXTINT2 DS    4A                                                       05806000
         ORG   INTTEXT2+16                                              05807000
TEXTSEG2 DS    CL22                                                     05808000
         ORG   TEXTSEG2                                                 05809000
TEXTSLN2 DS    FL2                                                      05810000
TEXTOFF2 DS    FL2                                                      05811000
TEXTXT2  DS    CL18                                                     05812000
         ORG   TEXTSEG2+22                                              05813000
         DS    CL2                                                      05814000
PARMLST  DS    CL16                                                     05815000
         ORG   PARMLST                                                  05816000
PTRLWA   DS    AL4                                                      05817000
PTRBUF   DS    AL4                                                      05818000
PTRIOLST DS    AL4                                                      05819000
FUNCPTR  DS    AL4                                                      05820000
         ORG   PARMLST+16                                               05821000
@NM00032 DS    CL13                                                     05822000
         ORG   @NM00032                                                 05823000
PRMTSWC  DS    FL2                                                      05824000
PMSGNM   DS    FL2                                                      05825000
PTYPE    DS    FL2                                                      05826000
         DS    CL2                                                      05827000
PTRYS    DS    FL4                                                      05828000
MODE     DS    CL1                                                      05829000
         ORG   @NM00032+13                                              05830000
         DS    CL3                                                      05831000
CONVERT  DS    CL8                                                      05832000
ZONEDEC  DS    CL8                                                      05833000
PACKDEC  DS    CL8                                                      05834000
UADSNODE DS    CL16                                                     05835000
         ORG   UADSNODE                                                 05836000
UADSNNEL DS    BL1                                                      05837000
         ORG   UADSNNEL                                                 05838000
UADSNFLG DS    BL1                                                      05839000
@NM00036 EQU   UADSNNEL+0                                               05840000
         ORG   UADSNODE+1                                               05841000
UADSNNEX DS    AL3                                                      05842000
UADSNSUB DS    AL4                                                      05843000
UADSNDAT DS    AL4                                                      05844000
UADSBUFR DS    AL4                                                      05845000
         ORG   UADSNODE+16                                              05846000
FINDNAME DS    CL8                                                      05847000
TIOCPARM DS    CL8                                                      05848000
         ORG   TIOCPARM                                                 05849000
PTRUSER  DS    AL4                                                      05850000
PTRPSWRD DS    AL4                                                      05851000
         ORG   TIOCPARM+8                                               05852000
USER     DS    CL8                                                      05853000
PASSWORD DS    CL8                                                      05854000
OIDPARM  DS    CL16                                                     05855000
         ORG   OIDPARM                                                  05856000
INOID    DS    AL4                                                      05857000
INLENOID DS    AL4                                                      05858000
OUTOID   DS    AL4                                                      05859000
OUTLENID DS    AL4                                                      05860000
         ORG   OIDPARM+16                                               05861000
XSFPARM  DS    CL12                                                     05862000
         ORG   XSFPARM                                                  05863000
RECUSRID DS    AL4                                                      05864000
RECPSWD  DS    AL4                                                      05865000
ROLDTSB  DS    AL4                                                      05866000
         ORG   XSFPARM+12                                               05867000
RECONUSR DS    CL8                                                      05868000
RECONPSW DS    CL8                                                      05869000
RACOID   DS    CL256                                                    05870000
         ORG   RACOID                                                   05871000
ROIDLEN  DS    AL1                                                      05872000
ROIDDATA DS    CL255                                                    05873000
         ORG   RACOID+256                                               05874000
RACLST   DS    CL48                                                     05875000
         ORG   RACLST                                                   05876000
RACLST01 DS    AL1                                                      05877000
RACLST02 DS    BL1                                                      05878000
RACLST03 DS    BL1                                                      05879000
RACLST04 DS    BL1                                                      05880000
RACLST05 DS    AL4                                                      05881000
RACLST06 DS    AL4                                                      05882000
RACLST07 DS    AL4                                                      05883000
RACLST08 DS    AL4                                                      05884000
RACLST09 DS    AL4                                                      05885000
RACLST10 DS    AL4                                                      05886000
RACLST11 DS    AL4                                                      05887000
RACLST12 DS    AL4                                                      05888000
RACLST13 DS    AL4                                                      05889000
RACLST14 DS    AL4                                                      05890000
RACLST15 DS    AL4                                                      05891000
         ORG   RACLST+48                                                05892000
MSGLST   DS    CL28                                                     05893000
         ORG   MSGLST                                                   05894000
UPTPTR2  DS    AL4                                                      05895000
ECTPTR2  DS    AL4                                                      05896000
ECBPTR   DS    AL4                                                      05897000
MSGNMPTR DS    AL4                                                      05898000
PTRINBUF DS    AL4                                                      05899000
SEGS1PTR DS    AL4                                                      05900000
SEGS2PTR DS    AL4                                                      05901000
         ORG   MSGLST+28                                                05902000
$LWP     DS    CL188                                                    05903000
$DUMMY   DS    CL1084                                                   05904000
         ORG   $DUMMY                                                   05905000
$ASCB    DS    CL208                                                    05906000
$ASXB    DS    CL232                                                    05907000
$CSCB    DS    CL176                                                    05908000
$TSB     DS    CL120                                                    05909000
$JSEL    DS    CL24                                                     05910000
$LWA     DS    CL172                                                    05911000
$PSCB    DS    CL72                                                     05912000
$UPT     DS    CL24                                                     05913000
$ECT     DS    CL56                                                     05914000
         ORG   $DUMMY+1084                                              05915000
SSOB     DS    CL20                                                     05916000
         ORG   SSOB                                                     05917000
SSOBID   DS    CL4                                                      05918000
SSOBLEN  DS    FL2                                                      05919000
SSOBFUNC DS    FL2                                                      05920000
SSOBSSIB DS    AL4                                                      05921000
SSOBRETN DS    AL4                                                      05922000
SSOBINDV DS    AL4                                                      05923000
         ORG   SSOB+20                                                  05924000
SSUS     DS    CL16                                                     05925000
         ORG   SSUS                                                     05926000
SSUSLEN  DS    FL2                                                      05927000
@NM00156 DS    FL2                                                      05928000
@NM00157 DS    FL4                                                      05929000
SSUSUSER DS    CL8                                                      05930000
         ORG   SSUS+16                                                  05931000
DUMYSSIB DS    CL36                                                     05932000
SAVBLKNM DS    CL1                                                      05933000
         DS    CL7                                                      05934000
ILIST    DS    CL20                                                     05935000
TEXTSEGS DS    CL24                                                     05936000
         ORG   TEXTSEGS+0                                               05937000
TEXTSLEN DS    FL2                                                      05938000
TEXTSOST DS    FL2                                                      05939000
TEXTSTXT DS    CL20                                                     05940000
         ORG   TEXTSEGS+48                                              05941000
UADSPFGR DS    32CL1                                                    05942000
IKJEFLE  CSECT                                                          05943000
         DS    0F                                                       05944000
@SIZDATD DC    AL1(1)                                                   05945000
         DC    AL3(@ENDDATD-@DATD)                                      05946000
@CV00270 DC    V(IKJEFLD)                                               05947000
@CV00271 DC    V(IKJEFLEA)                                              05948000
@CV00272 DC    V(IKJEFLGM)                                              05949000
@CV00273 DC    V(IKJEFLI)                                               05950000
@CV00274 DC    V(IKJEFLPA)                                              05951000
@CV00275 DC    V(IKJEFLP0)                                              05952000
@CV00276 DC    V(IKTXLOG)                                               05953000
@CV00277 DC    V(IKTLOGR)                                               05954000
         DS    0D                                                       05955000
DUMMYECB DC    F'0'                                                     05956000
@CC03188 DC    C'RELEASE LOCK'                                          05957000
@CC03183 DC    C'OBTAIN LOCK'                                           05958000
@CC03052 DC    C'TERMINATED'                                            05959000
@CC02962 DC    C'INTERFACE'                                             05960000
@CC03051 DC    C'SYSUADS'                                               05961000
@CC03177 DC    C'IKTLOGR'                                               05962000
@CC03209 DC    C'IKJEFLE'                                               05963000
@CC02957 DC    C'SSOB'                                                  05964000
@CC02958 DC    C'SSIB'                                                  05965000
@CC03046 DC    C'OPEN'                                                  05966000
@CC03178 DC    C'QTIP'                                                  05967000
@CC03049 DC    C'I/O'                                                   05968000
@CC03059 DC    C'012'                                                   05969000
@CC03062 DC    C'004'                                                   05970000
@CB00466 DC    X'40202020202020202020202020202020'                      05971000
@CB02921 DC    X'0000000000000000'                                      05972000
OPENENQ  DC    CL8'OPENUADS'                                            05973000
INSLOGON DS    CL9                                                      05974000
         ORG   INSLOGON                                                 05975000
@NM00043 DC    H'9'                                                     05976000
@NM00044 DS    FL2                                                      05977000
@NM00045 DC    CL5'LOGON'                                               05978000
         ORG   INSLOGON+9                                               05979000
         DS    CL1                                                      05980000
INSGROUP DS    CL9                                                      05981000
         ORG   INSGROUP                                                 05982000
@NM00046 DC    H'9'                                                     05983000
@NM00047 DC    H'0'                                                     05984000
@NM00048 DC    CL5'GROUP'                                               05985000
         ORG   INSGROUP+9                                               05986000
         DS    CL1                                                      05987000
INSNPSWD DS    CL17                                                     05988000
         ORG   INSNPSWD                                                 05989000
@NM00049 DC    H'17'                                                    05990000
@NM00050 DC    H'0'                                                     05991000
@NM00051 DC    CL13'/NEW-PASSWORD'                                      05992000
         ORG   INSNPSWD+17                                              05993000
         DS    CL1                                                      05994000
INSOIDCD DS    CL11                                                     05995000
         ORG   INSOIDCD                                                 05996000
@NM00052 DC    H'11'                                                    05997000
@NM00053 DC    H'0'                                                     05998000
@NM00054 DC    CL7'OIDCARD'                                             05999000
         ORG   INSOIDCD+11                                              06000000
         DS    CL1                                                      06001000
INSRINIT DS    CL11                                                     06002000
         ORG   INSRINIT                                                 06003000
@NM00055 DC    H'11'                                                    06004000
@NM00056 DC    H'0'                                                     06005000
@NM00057 DC    CL7'RACINIT'                                             06006000
         ORG   INSRINIT+11                                              06007000
SYSIKJUA DC    CL8'SYSIKJUA'                                            06008000
TMARRAY  DC    X'80'                                                    06009000
         DC    X'40'                                                    06010000
         DC    X'20'                                                    06011000
         DC    X'10'                                                    06012000
         DC    X'08'                                                    06013000
         DC    X'04'                                                    06014000
         DC    X'02'                                                    06015000
         DC    X'01'                                                    06016000
SRNAMES  DC    CL8'GETMAIN'                                             06017000
         DC    CL8'IKJPARS'                                             06018000
         DC    CL8'IKJSCAN'                                             06019000
         DC    CL8'IKJEFLGM'                                            06020000
         DC    CL8'IKJEFLEA'                                            06021000
@DATD    DSECT                                                          06022000
         DS    0F                                                       06023000
MOVEMACS EQU   *                                                        06024000
OPENUADS OPEN  (UADSDCBD),MF=L                                          06025000
CLOSUADS CLOSE (UADSDCBD),MF=L                                          06026000
UADSDCB  DCB   DDNAME=SYSUADS,MACRF=R,DSORG=PO                          06027000
READUADS READ  UADSDECB,SF,,,,'S',,MF=L                                 06028000
@DATD    DSECT                                                          06029000
          IKJTIOCP                                                      06030000
IKJEFLE  CSECT                                                          06031000
         DS   0H                                                        06032000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   06033000
@DATD    DSECT                                                          06034000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06035000
@ENDDATD EQU   *                                                        06036000
IKJEFLE  CSECT                                                          06037000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06038000
@01      EQU   01                                                       06039000
@02      EQU   02                                                       06040000
@03      EQU   03                                                       06041000
@04      EQU   04                                                       06042000
@05      EQU   05                                                       06043000
@06      EQU   06                                                       06044000
@07      EQU   07                                                       06045000
@08      EQU   08                                                       06046000
@09      EQU   09                                                       06047000
@10      EQU   10                                                       06048000
@11      EQU   11                                                       06049000
@12      EQU   12                                                       06050000
@13      EQU   13                                                       06051000
@14      EQU   14                                                       06052000
@15      EQU   15                                                       06053000
RETRNCD  EQU   @02                                                      06054000
SIZETSB  EQU   @03                                                      06055000
EXTNTPTR EQU   @04                                                      06056000
LASTTSB  EQU   @04                                                      06057000
TSBPTR2  EQU   @03                                                      06058000
NEWTSB   EQU   @06                                                      06059000
HOLDLEN  EQU   @05                                                      06060000
I        EQU   @02                                                      06061000
UADSSAVE EQU   @05                                                      06062000
SCANINDX EQU   @02                                                      06063000
SSIBPTR  EQU   @02                                                      06064000
THEBYTE  EQU   @03                                                      06065000
THEBIT   EQU   @02                                                      06066000
SAVEBK   EQU   @04                                                      06067000
LOCKRC   EQU   @02                                                      06068000
PARMPTR  EQU   @01                                                      06069000
GTMNPTR  EQU   @01                                                      06070000
GPR02P   EQU   @02                                                      06071000
GPR03P   EQU   @03                                                      06072000
GPR04P   EQU   @04                                                      06073000
GPR05P   EQU   @05                                                      06074000
REGION   EQU   @08                                                      06075000
PRFRMGP  EQU   @08                                                      06076000
SUBSYSRC EQU   @08                                                      06077000
JCLSPTR  EQU   @04                                                      06078000
WECBPTR  EQU   @04                                                      06079000
LENSTR   EQU   @04                                                      06080000
ADRSTR   EQU   @05                                                      06081000
LENBUF   EQU   @05                                                      06082000
BITPOS   EQU   @05                                                      06083000
BYTEPOS  EQU   @07                                                      06084000
SVRTN    EQU   @07                                                      06085000
R14      EQU   @14                                                      06086000
RTNREG   EQU   @15                                                      06087000
REASONCD EQU   @00                                                      06088000
GPR01P   EQU   @01                                                      06089000
GPR15P   EQU   @15                                                      06090000
GPR01F   EQU   @01                                                      06091000
NEXTADDR EQU   @03                                                      06092000
DCBPTR   EQU   @04                                                      06093000
DATAADDR EQU   @04                                                      06094000
BLOCKNUM EQU   @04                                                      06095000
MEMBRPTR EQU   @05                                                      06096000
NBLKNUM  EQU   @06                                                      06097000
BUFRPTR  EQU   @07                                                      06098000
RPTPTR   EQU   @05                                                      06099000
PECBPTR  EQU   @04                                                      06100000
CVTPTR   EQU   16                                                       06101000
PSA      EQU   0                                                        06102000
FLCRNPSW EQU   PSA                                                      06103000
FLCROPSW EQU   PSA+8                                                    06104000
FLCICCW2 EQU   PSA+16                                                   06105000
PSAEEPSW EQU   PSA+132                                                  06106000
PSAESPSW EQU   PSA+136                                                  06107000
FLCSVILC EQU   PSAESPSW+1                                               06108000
PSAEPPSW EQU   PSA+140                                                  06109000
FLCPIILC EQU   PSAEPPSW+1                                               06110000
FLCPICOD EQU   PSAEPPSW+2                                               06111000
PSAPICOD EQU   FLCPICOD+1                                               06112000
FLCTEA   EQU   PSAEPPSW+4                                               06113000
FLCPER   EQU   PSA+152                                                  06114000
FLCMCLA  EQU   PSA+168                                                  06115000
FLCIOEL  EQU   FLCMCLA+4                                                06116000
FLCIOA   EQU   FLCMCLA+16                                               06117000
FLCFSA   EQU   FLCMCLA+80                                               06118000
PSASUPER EQU   PSA+552                                                  06119000
PSASUP1  EQU   PSASUPER                                                 06120000
PSASUP2  EQU   PSASUPER+1                                               06121000
PSASUP3  EQU   PSASUPER+2                                               06122000
PSASUP4  EQU   PSASUPER+3                                               06123000
PSACLHT  EQU   PSA+640                                                  06124000
PSALKSA  EQU   PSA+696                                                  06125000
PSAHLHI  EQU   PSA+760                                                  06126000
PSALITA  EQU   PSA+764                                                  06127000
PSADSSFL EQU   PSA+836                                                  06128000
PSADSSF1 EQU   PSADSSFL                                                 06129000
PSADSSF3 EQU   PSADSSFL+2                                               06130000
PSADSSF4 EQU   PSADSSFL+3                                               06131000
PSARSVT  EQU   PSA+896                                                  06132000
IEDQTCXD EQU   0                                                        06133000
TCXATTEN EQU   IEDQTCXD+4                                               06134000
TCXFLAG1 EQU   IEDQTCXD+34                                              06135000
TCXRPT   EQU   IEDQTCXD+36                                              06136000
TCXBUFA  EQU   IEDQTCXD+80                                              06137000
TCXDSAVE EQU   IEDQTCXD+104                                             06138000
TCAST    EQU   0                                                        06139000
TCASUSER EQU   TCAST+4                                                  06140000
TCASTSB  EQU   TCAST+68                                                 06141000
TCASFLG1 EQU   TCAST+88                                                 06142000
TCASFLG2 EQU   TCAST+89                                                 06143000
RCVT     EQU   0                                                        06144000
RCVTSTAT EQU   RCVT+53                                                  06145000
RCVTRNA  EQU   RCVTSTAT                                                 06146000
RCVTSTA1 EQU   RCVT+150                                                 06147000
RCVTAUOP EQU   RCVT+151                                                 06148000
RCVTFLGS EQU   RCVT+153                                                 06149000
RCVTEROP EQU   RCVT+154                                                 06150000
RCVTRID0 EQU   RCVT+168                                                 06151000
ACEE     EQU   0                                                        06152000
ACEECORE EQU   ACEE+4                                                   06153000
ACEEUSER EQU   ACEE+20                                                  06154000
ACEEGRP  EQU   ACEE+29                                                  06155000
ACEEGRPN EQU   ACEEGRP+1                                                06156000
ACEEFLG1 EQU   ACEE+38                                                  06157000
ACEEFLG2 EQU   ACEE+39                                                  06158000
ACEEFLG3 EQU   ACEE+40                                                  06159000
ACEEFLG4 EQU   ACEE+56                                                  06160000
ICHRID00 EQU   0                                                        06161000
UADSPG   EQU   0                                                        06162000
CMNDBUFR EQU   0                                                        06163000
CMNDLNG  EQU   CMNDBUFR                                                 06164000
CMNDTEXT EQU   CMNDBUFR+4                                               06165000
IKJEFLWP EQU   0                                                        06166000
LWPUSERS EQU   IKJEFLWP                                                 06167000
LWPUSERI EQU   LWPUSERS+4                                               06168000
LWPUSERM EQU   LWPUSERI                                                 06169000
LWPUSERL EQU   LWPUSERI+2                                               06170000
LWPUSER  EQU   LWPUSERI+4                                               06171000
LWPPSWDS EQU   IKJEFLWP+16                                              06172000
LWPPSWDI EQU   LWPPSWDS+4                                               06173000
LWPPSWDL EQU   LWPPSWDI+2                                               06174000
LWPPSWD  EQU   LWPPSWDI+4                                               06175000
LWPPROCS EQU   IKJEFLWP+32                                              06176000
LWPPROCI EQU   LWPPROCS+4                                               06177000
LWPPROCM EQU   LWPPROCI                                                 06178000
LWPPROCL EQU   LWPPROCI+2                                               06179000
LWPPROC  EQU   LWPPROCI+4                                               06180000
LWPACCTS EQU   IKJEFLWP+48                                              06181000
LWPACCTI EQU   LWPACCTS+4                                               06182000
LWPACCTL EQU   LWPACCTI+2                                               06183000
LWPACCT  EQU   LWPACCTI+4                                               06184000
@NM00039 EQU   IKJEFLWP+96                                              06185000
LWPREGNI EQU   @NM00039+4                                               06186000
LWPREGNX EQU   LWPREGNI+12                                              06187000
@NM00040 EQU   IKJEFLWP+116                                             06188000
LWPPERFI EQU   @NM00040+4                                               06189000
LWPPERFX EQU   LWPPERFI+12                                              06190000
LWPDESTS EQU   IKJEFLWP+136                                             06191000
LWPDESTI EQU   LWPDESTS+4                                               06192000
LWPDEST  EQU   LWPDESTI+4                                               06193000
LWPNPSWS EQU   IKJEFLWP+152                                             06194000
LWPNPSWI EQU   LWPNPSWS+4                                               06195000
LWPNPSWL EQU   LWPNPSWI+2                                               06196000
LWPNPSWD EQU   LWPNPSWI+4                                               06197000
LWPGRPS  EQU   IKJEFLWP+168                                             06198000
LWPGRPI  EQU   LWPGRPS+4                                                06199000
LWPGRPM  EQU   LWPGRPI                                                  06200000
LWPGRPL  EQU   LWPGRPI+2                                                06201000
LWPGRP   EQU   LWPGRPI+4                                                06202000
LWPFLAGS EQU   IKJEFLWP+184                                             06203000
LWPFLGS1 EQU   LWPFLAGS                                                 06204000
LWPRECON EQU   LWPFLGS1                                                 06205000
LWPMAIL  EQU   LWPFLGS1                                                 06206000
LWPNOTIC EQU   LWPFLGS1                                                 06207000
LWPOIDCD EQU   LWPFLGS1                                                 06208000
TSB      EQU   0                                                        06209000
TSBASCBA EQU   TSB                                                      06210000
TSBSTAT  EQU   TSBASCBA                                                 06211000
TSBFLG1  EQU   TSB+4                                                    06212000
TSBFLG2  EQU   TSB+16                                                   06213000
TSBFLG3  EQU   TSB+24                                                   06214000
TSBFLG5  EQU   TSB+25                                                   06215000
TSBVTAM  EQU   TSBFLG5                                                  06216000
TSBTERMC EQU   TSB+26                                                   06217000
TSBTERM1 EQU   TSBTERMC                                                 06218000
TSBTERM2 EQU   TSBTERMC+1                                               06219000
TSBSTCC  EQU   TSB+34                                                   06220000
TSBFLG4  EQU   TSB+41                                                   06221000
TSBHUNG  EQU   TSBFLG4                                                  06222000
TSBRCB   EQU   TSB+64                                                   06223000
TSBLINKA EQU   TSBRCB+4                                                 06224000
TSBTPOST EQU   TSB+72                                                   06225000
TSBTPFLG EQU   TSBTPOST                                                 06226000
TSBMINL  EQU   TSB+84                                                   06227000
TSBPSWD  EQU   TSB+88                                                   06228000
TSBEXTNT EQU   TSB+96                                                   06229000
TSBTRMID EQU   TSB+104                                                  06230000
TSBSF1   EQU   TSB+112                                                  06231000
TSBX     EQU   0                                                        06232000
TSBXFWD  EQU   TSBX                                                     06233000
TSBXUID  EQU   TSBX+24                                                  06234000
TSBXFLG1 EQU   TSBX+32                                                  06235000
TSBXWREC EQU   TSBXFLG1                                                 06236000
TSBXTERM EQU   TSBX+72                                                  06237000
JCLS     EQU   0                                                        06238000
JCLSHDR  EQU   JCLS                                                     06239000
JCLSJCLS EQU   JCLSHDR                                                  06240000
JCLSCARD EQU   JCLS+8                                                   06241000
LWA      EQU   0                                                        06242000
LWAPASCB EQU   LWA+16                                                   06243000
LWAACCT  EQU   LWA+20                                                   06244000
LWAPSCB  EQU   LWA+24                                                   06245000
LWAJSEL  EQU   LWA+28                                                   06246000
LWAPECT  EQU   LWA+32                                                   06247000
LWAAECB  EQU   LWA+36                                                   06248000
LWAPECB  EQU   LWA+40                                                   06249000
LWASECB  EQU   LWA+44                                                   06250000
LWAPDCB  EQU   LWA+52                                                   06251000
LWAFLGS  EQU   LWA+56                                                   06252000
@NM00085 EQU   LWAFLGS                                                  06253000
LWALE    EQU   @NM00085                                                 06254000
@NM00086 EQU   LWAFLGS+1                                                06255000
@NM00088 EQU   LWAFLGS+2                                                06256000
LWARACF  EQU   @NM00088                                                 06257000
LWAFLGS4 EQU   LWAFLGS+3                                                06258000
LWANORDR EQU   LWAFLGS4                                                 06259000
LWAILGN  EQU   LWAFLGS4                                                 06260000
LWACTLS  EQU   LWA+64                                                   06261000
LWAUFAI  EQU   LWACTLS                                                  06262000
LWAFAIL  EQU   LWACTLS                                                  06263000
LWADISC  EQU   LWACTLS                                                  06264000
LWANOPR  EQU   LWACTLS                                                  06265000
LWANUAD  EQU   LWACTLS                                                  06266000
LWAJJCL  EQU   LWACTLS                                                  06267000
LWAATR1  EQU   LWACTLS+1                                                06268000
LWAATR2  EQU   LWACTLS+1                                                06269000
LWAUNIT  EQU   LWACTLS+1                                                06270000
LWABUPT  EQU   LWACTLS+1                                                06271000
LWADEST  EQU   LWACTLS+1                                                06272000
LWABEND  EQU   LWACTLS+1                                                06273000
LWARTCD  EQU   LWA+68                                                   06274000
LWANAME  EQU   LWA+72                                                   06275000
LWARNML  EQU   LWANAME                                                  06276000
LWARNM   EQU   LWANAME+1                                                06277000
LWAELST  EQU   LWA+92                                                   06278000
LWAPECBP EQU   LWAELST+4                                                06279000
LWATCPU  EQU   LWA+104                                                  06280000
LWATCPU1 EQU   LWA+108                                                  06281000
LWATSRU  EQU   LWA+112                                                  06282000
LWATSRU1 EQU   LWA+116                                                  06283000
LWATCON  EQU   LWA+120                                                  06284000
LWATCON1 EQU   LWA+124                                                  06285000
LWASTCB  EQU   LWA+128                                                  06286000
LWADEST2 EQU   LWA+132                                                  06287000
LOGONTCB EQU   0                                                        06288000
@NM00094 EQU   0                                                        06289000
LP0PRMT  EQU   @NM00094+8                                               06290000
ECT      EQU   0                                                        06291000
ECTSWS   EQU   ECT+28                                                   06292000
ECTNMAL  EQU   ECTSWS                                                   06293000
ECTNNOT  EQU   ECTSWS                                                   06294000
ECTSWS2  EQU   ECT+40                                                   06295000
ECTSWS21 EQU   ECTSWS2                                                  06296000
JSEL     EQU   0                                                        06297000
JSELCSCB EQU   JSEL+8                                                   06298000
JSELJCL  EQU   JSEL+12                                                  06299000
JSELASCB EQU   JSEL+20                                                  06300000
CHAIN    EQU   0                                                        06301000
CHFLG    EQU   CHAIN+4                                                  06302000
CHSTS    EQU   CHFLG+2                                                  06303000
CHACT    EQU   CHFLG+3                                                  06304000
CHKEY    EQU   CHAIN+8                                                  06305000
CHPARM   EQU   CHKEY                                                    06306000
CHCLS    EQU   CHAIN+16                                                 06307000
CHPKE    EQU   CHAIN+28                                                 06308000
CHTJID   EQU   CHAIN+30                                                 06309000
CHPROCSN EQU   CHAIN+32                                                 06310000
CHACT1   EQU   CHPROCSN+3                                               06311000
CHASM    EQU   CHAIN+40                                                 06312000
CHCIBP   EQU   CHASM+4                                                  06313000
CHRGNSZ  EQU   CHASM+8                                                  06314000
CHCECB   EQU   CHASM+20                                                 06315000
CHSTEP   EQU   CHASM+24                                                 06316000
CHSWT    EQU   CHSTEP                                                   06317000
CHSHORT  EQU   CHASM+32                                                 06318000
PSCB     EQU   0                                                        06319000
PSCBUSER EQU   PSCB                                                     06320000
PSCBUSRL EQU   PSCB+7                                                   06321000
PSCBGPNM EQU   PSCB+8                                                   06322000
PSCBATR1 EQU   PSCB+16                                                  06323000
PSCBATTN EQU   PSCBATR1                                                 06324000
PSCBATR2 EQU   PSCB+18                                                  06325000
PSCBSUBH EQU   PSCB+28                                                  06326000
PSCBSUBC EQU   PSCB+29                                                  06327000
PSCBSUBM EQU   PSCB+30                                                  06328000
PSCBSOUT EQU   PSCB+31                                                  06329000
PSCBDEST EQU   PSCB+40                                                  06330000
PSCBUPT  EQU   PSCB+52                                                  06331000
PSCBUPTL EQU   PSCB+56                                                  06332000
PSCBCHAR EQU   PSCB+58                                                  06333000
PSCBLINE EQU   PSCB+59                                                  06334000
PSCBRSZ  EQU   PSCB+60                                                  06335000
UPT      EQU   0                                                        06336000
UPTSWS   EQU   UPT+12                                                   06337000
UPTMID   EQU   UPTSWS                                                   06338000
UPTALD   EQU   UPTSWS                                                   06339000
UPTCDEL  EQU   UPT+13                                                   06340000
UPTLDEL  EQU   UPT+14                                                   06341000
UPTPREFX EQU   UPT+16                                                   06342000
UPTPREFL EQU   UPT+23                                                   06343000
ASCB     EQU   0                                                        06344000
ASCBCSCB EQU   ASCB+56                                                  06345000
ASCBTSB  EQU   ASCB+60                                                  06346000
ASCBFW1  EQU   ASCB+100                                                 06347000
ASCBRCTF EQU   ASCBFW1+2                                                06348000
ASCBFLG1 EQU   ASCBFW1+3                                                06349000
ASCBASXB EQU   ASCB+108                                                 06350000
ASCBDSP1 EQU   ASCB+114                                                 06351000
ASCBFLG2 EQU   ASCB+115                                                 06352000
ASCBJBNS EQU   ASCB+176                                                 06353000
ASXB     EQU   0                                                        06354000
ASXBAEQ  EQU   ASXB+168                                                 06355000
ASXBSECR EQU   ASXB+199                                                 06356000
ASCBSFLG EQU   ASXBSECR                                                 06357000
ASXBSENV EQU   ASXBSECR+1                                               06358000
ASXBCASW EQU   ASXB+216                                                 06359000
ASXBCRB1 EQU   ASXBCASW                                                 06360000
CVTMAP   EQU   0                                                        06361000
CVTTCBP  EQU   CVTMAP                                                   06362000
CVTDAR   EQU   CVTMAP+72                                                06363000
CVTFLGS1 EQU   CVTDAR                                                   06364000
CVTDCB   EQU   CVTMAP+116                                               06365000
CVTIOQET EQU   CVTMAP+120                                               06366000
CVTIERLC EQU   CVTMAP+144                                               06367000
CVTHEAD  EQU   CVTMAP+160                                               06368000
CVTSV76C EQU   CVTHEAD                                                  06369000
CVTOPTA  EQU   CVTMAP+182                                               06370000
CVTOPTB  EQU   CVTMAP+183                                               06371000
CVTGTF   EQU   CVTMAP+236                                               06372000
CVTGTFST EQU   CVTGTF                                                   06373000
CVTGTFS  EQU   CVTGTFST                                                 06374000
CVTSTATE EQU   CVTGTFST                                                 06375000
CVTTMODE EQU   CVTGTFST                                                 06376000
CVTFORM  EQU   CVTGTFST                                                 06377000
CVTAQAVT EQU   CVTMAP+240                                               06378000
CVTTCMFG EQU   CVTAQAVT                                                 06379000
CVTVOLM2 EQU   CVTMAP+244                                               06380000
CVTTATA  EQU   CVTVOLM2                                                 06381000
CVTTSKS  EQU   CVTTATA                                                  06382000
CVTVOLF2 EQU   CVTTSKS                                                  06383000
CVTTAT   EQU   CVTTATA+1                                                06384000
CVTATER  EQU   CVTMAP+248                                               06385000
CVTEXT1  EQU   CVTMAP+252                                               06386000
CVTPURG  EQU   CVTMAP+260                                               06387000
CVTQMSG  EQU   CVTMAP+268                                               06388000
CVTDMSR  EQU   CVTMAP+272                                               06389000
CVTRSV37 EQU   CVTDMSR                                                  06390000
CVTDMSRF EQU   CVTRSV37                                                 06391000
CVTJESCT EQU   CVTMAP+296                                               06392000
CVTERPV  EQU   CVTMAP+316                                               06393000
CVTINTLA EQU   CVTMAP+320                                               06394000
CVTAPF   EQU   CVTMAP+324                                               06395000
CVTEXT2  EQU   CVTMAP+328                                               06396000
CVTHJES  EQU   CVTMAP+332                                               06397000
CVTPGSIA EQU   CVTMAP+348                                               06398000
CVTA1F1  EQU   CVTMAP+356                                               06399000
CVTSYSK  EQU   CVTMAP+357                                               06400000
CVTVOLM1 EQU   CVTMAP+380                                               06401000
CVTVOLF1 EQU   CVTVOLM1                                                 06402000
CVTATMCT EQU   CVTMAP+388                                               06403000
CVTXTNT1 EQU   0                                                        06404000
CVTXTNT2 EQU   0                                                        06405000
CVTDSSV  EQU   CVTXTNT2                                                 06406000
CVTFLGBT EQU   CVTXTNT2+5                                               06407000
CVTQID   EQU   CVTXTNT2+24                                              06408000
CVTRV400 EQU   CVTXTNT2+52                                              06409000
CVTRV409 EQU   CVTXTNT2+53                                              06410000
CVTATCVT EQU   CVTXTNT2+64                                              06411000
CVTRV429 EQU   CVTXTNT2+84                                              06412000
CVTRV438 EQU   CVTXTNT2+85                                              06413000
CVTRV457 EQU   CVTXTNT2+112                                             06414000
CVTRV466 EQU   CVTXTNT2+113                                             06415000
CVTFIX   EQU   0                                                        06416000
CVTRELNO EQU   CVTFIX+252                                               06417000
TCBPTRS  EQU   0                                                        06418000
TCBCPTR  EQU   TCBPTRS+4                                                06419000
TCBFIX   EQU   0                                                        06420000
TCBFRS   EQU   TCBFIX                                                   06421000
TCB      EQU   0                                                        06422000
TCBPIE   EQU   TCB+4                                                    06423000
TCBPMASK EQU   TCBPIE                                                   06424000
TCBCMP   EQU   TCB+16                                                   06425000
TCBCMPF  EQU   TCBCMP                                                   06426000
TCBCPP   EQU   TCBCMPF                                                  06427000
TCBSTCC  EQU   TCBCMPF                                                  06428000
TCBCDBL  EQU   TCBCMPF                                                  06429000
TCBCWTO  EQU   TCBCMPF                                                  06430000
TCBCIND  EQU   TCBCMPF                                                  06431000
TCBCMSG  EQU   TCBCMPF                                                  06432000
TCBTRN   EQU   TCB+20                                                   06433000
TCBABF   EQU   TCBTRN                                                   06434000
TCBMSS   EQU   TCB+24                                                   06435000
TCBPKF   EQU   TCB+28                                                   06436000
TCBFLGS  EQU   TCB+29                                                   06437000
TCBFLGS1 EQU   TCBFLGS                                                  06438000
TCBFLGS2 EQU   TCBFLGS+1                                                06439000
TCBFLGS3 EQU   TCBFLGS+2                                                06440000
TCBFLGS4 EQU   TCBFLGS+3                                                06441000
TCBFLGS5 EQU   TCBFLGS+4                                                06442000
TCBABWF  EQU   TCBFLGS5                                                 06443000
TCBJPQ   EQU   TCB+44                                                   06444000
TCBPURGE EQU   TCBJPQ                                                   06445000
TCBGRS   EQU   TCB+48                                                   06446000
TCBFSA   EQU   TCB+112                                                  06447000
TCBTME   EQU   TCB+120                                                  06448000
TCBJSTCB EQU   TCB+124                                                  06449000
TCBTSFLG EQU   TCB+148                                                  06450000
TCBTSTSK EQU   TCBTSFLG                                                 06451000
TCBSTAB  EQU   TCB+160                                                  06452000
TCBNSTAE EQU   TCBSTAB                                                  06453000
TCBTCT   EQU   TCB+164                                                  06454000
TCBTCTGF EQU   TCBTCT                                                   06455000
TCBSCNDY EQU   TCB+172                                                  06456000
TCBNDSP  EQU   TCBSCNDY                                                 06457000
TCBNDSP1 EQU   TCBNDSP+1                                                06458000
TCBNDSP2 EQU   TCBNDSP+2                                                06459000
TCBNDSP3 EQU   TCBNDSP+3                                                06460000
TCBJSCB  EQU   TCB+180                                                  06461000
TCBRECDE EQU   TCBJSCB                                                  06462000
TCBEXT1  EQU   TCB+196                                                  06463000
TCBBITS  EQU   TCB+200                                                  06464000
TCBNDSP4 EQU   TCBBITS                                                  06465000
TCBNDSP5 EQU   TCBBITS+1                                                06466000
TCBFLGS6 EQU   TCBBITS+2                                                06467000
TCBFLGS7 EQU   TCBBITS+3                                                06468000
TCBDAR   EQU   TCB+204                                                  06469000
TCBDARC  EQU   TCBDAR                                                   06470000
TCBEXT2  EQU   TCB+208                                                  06471000
TCBFOE   EQU   TCB+244                                                  06472000
TCBESTAE EQU   TCB+264                                                  06473000
TCBESTRM EQU   TCBESTAE+1                                               06474000
TCBFBYT1 EQU   TCB+276                                                  06475000
TCBFBYT2 EQU   TCB+277                                                  06476000
TCBRV124 EQU   TCB+278                                                  06477000
TCBRV133 EQU   TCB+279                                                  06478000
TCBXTNT2 EQU   0                                                        06479000
TCBGTF   EQU   TCBXTNT2                                                 06480000
TCBTFLG  EQU   TCBGTF                                                   06481000
TCBRV146 EQU   TCBXTNT2+28                                              06482000
TCBRV155 EQU   TCBXTNT2+29                                              06483000
TCBRV164 EQU   TCBXTNT2+30                                              06484000
TCBRV173 EQU   TCBXTNT2+31                                              06485000
IEZJSCB  EQU   0                                                        06486000
JSCBSEC1 EQU   IEZJSCB+188                                              06487000
JSCHPCE  EQU   JSCBSEC1+4                                               06488000
JSCBDCB  EQU   JSCBSEC1+36                                              06489000
JSCBOPTS EQU   JSCBSEC1+48                                              06490000
JSCBSWT1 EQU   JSCBSEC1+55                                              06491000
JSCBPASS EQU   JSCBSWT1                                                 06492000
JSCBWTP  EQU   JSCBSEC1+64                                              06493000
JSCBWTFG EQU   JSCBWTP                                                  06494000
JSCBEND1 EQU   IEZJSCB+260                                              06495000
DHED     EQU   0                                                        06496000
UADSMHDR EQU   DHED                                                     06497000
UADSBN01 EQU   UADSMHDR+12                                              06498000
UADSEXPF EQU   UADSBN01+1                                               06499000
UADSMAXC EQU   UADSMHDR+14                                              06500000
UADSATTR EQU   DHED+16                                                  06501000
UADSINST EQU   DHED+18                                                  06502000
UADSUPTP EQU   DHED+20                                                  06503000
UADSPWD1 EQU   DHED+24                                                  06504000
UADSPERP EQU   DHED+28                                                  06505000
UADSDEST EQU   DHED+32                                                  06506000
UADSSUBH EQU   DHED+40                                                  06507000
UADSSUBC EQU   DHED+41                                                  06508000
UADSSUBM EQU   DHED+42                                                  06509000
UADSSOUT EQU   DHED+43                                                  06510000
DPOBD    EQU   0                                                        06511000
UADSPPWD EQU   DPOBD+4                                                  06512000
DNOBD    EQU   0                                                        06513000
UADSADRF EQU   DNOBD+4                                                  06514000
UADSALEN EQU   DNOBD+44                                                 06515000
UADSANUM EQU   DNOBD+45                                                 06516000
DROBD    EQU   0                                                        06517000
UADSRNAM EQU   DROBD+4                                                  06518000
UADSRSIZ EQU   DROBD+14                                                 06519000
UADSUNAM EQU   DROBD+16                                                 06520000
JESCT    EQU   0                                                        06521000
JESWAA   EQU   JESCT+8                                                  06522000
JESSSREQ EQU   JESCT+20                                                 06523000
JESPJESN EQU   JESCT+28                                                 06524000
JESALLOC EQU   JESCT+32                                                 06525000
JESUNALC EQU   JESCT+36                                                 06526000
JESCATL  EQU   JESCT+40                                                 06527000
SSREQ    EQU   0                                                        06528000
SSIB     EQU   0                                                        06529000
SSIBID   EQU   SSIB                                                     06530000
SSIBLEN  EQU   SSIB+4                                                   06531000
SSIBFLG1 EQU   SSIB+6                                                   06532000
SSIBSSNM EQU   SSIB+8                                                   06533000
INDIRECT EQU   0                                                        06534000
FIELD    EQU   0                                                        06535000
STRBLKNM EQU   0                                                        06536000
IEFAB4F5 EQU   0                                                        06537000
IEFBB410 EQU   0                                                        06538000
IEFW21SD EQU   0                                                        06539000
I001C    EQU   0                                                        06540000
I008P    EQU   0                                                        06541000
I015F    EQU   0                                                        06542000
I015P    EQU   0                                                        06543000
I031F    EQU   0                                                        06544000
I031P    EQU   0                                                        06545000
I256C    EQU   0                                                        06546000
STRING   EQU   0                                                        06547000
SWAMGR   EQU   0                                                        06548000
LOGONWA  EQU   0                                                        06549000
SUBLOGON EQU   0                                                        06550000
SUBITEMS EQU   0                                                        06551000
SUBECT   EQU   0                                                        06552000
SUBUPT   EQU   0                                                        06553000
BLD#     EQU   0                                                        06554000
BLDINS   EQU   0                                                        06555000
BLDHEAD  EQU   BLDINS                                                   06556000
BLDLEN   EQU   BLDHEAD                                                  06557000
BLDTEXT  EQU   BLDINS+4                                                 06558000
TCXPTR   EQU   CVTAQAVT                                                 06559000
CVTS01   EQU   CVTPGSIA                                                 06560000
CVTLPDIA EQU   CVTS01+12                                                06561000
CVTDIRST EQU   CVTLPDIA                                                 06562000
CVTSLIDA EQU   CVTS01+24                                                06563000
CVTCTLFG EQU   CVTS01+50                                                06564000
CVTRV210 EQU   CVTS01+424                                               06565000
CVTRV219 EQU   CVTS01+425                                               06566000
CVTRV228 EQU   CVTS01+426                                               06567000
CVTRV237 EQU   CVTS01+427                                               06568000
CVTMFRTR EQU   CVTS01+452                                               06569000
CVTRV262 EQU   CVTS01+468                                               06570000
CVTRV271 EQU   CVTS01+469                                               06571000
CVTRV280 EQU   CVTS01+470                                               06572000
CVTRV289 EQU   CVTS01+471                                               06573000
CVTGSDA  EQU   CVTS01+600                                               06574000
CVTRAC   EQU   CVTS01+644                                               06575000
CVTTCASP EQU   CVTS01+664                                               06576000
TCASTPTR EQU   CVTTCASP                                                 06577000
ACEEPTR  EQU   ASXBSENV                                                 06578000
UADSPFG1 EQU   UADSPFGR                                                 06579000
PRFGRP   EQU   LWPPERFX                                                 06580000
GROUP    EQU   PRFGRP+3                                                 06581000
DCBBLKSI EQU   UADSDCB+62                                               06582000
DCBOFLGS EQU   UADSDCB+48                                               06583000
ACCTINFO EQU   UADSADRF                                                 06584000
TOTLCPU  EQU   ACCTINFO                                                 06585000
TOTLCPU1 EQU   ACCTINFO+4                                               06586000
TOTLCON  EQU   ACCTINFO+8                                               06587000
TOTLCON1 EQU   ACCTINFO+12                                              06588000
TOTLSU   EQU   ACCTINFO+16                                              06589000
TOTLSU1  EQU   ACCTINFO+20                                              06590000
UADSATR  EQU   UADSATTR                                                 06591000
RACPSWD  EQU   LWPPSWDL+1                                               06592000
RACNPSWD EQU   LWPNPSWL+1                                               06593000
RACGROUP EQU   LWPGRPL+1                                                06594000
CHAINS01 EQU   CHASM                                                    06595000
CHTYPE   EQU   CHAINS01+124                                             06596000
CHTRSTAT EQU   CHAINS01+125                                             06597000
CHCSYSO  EQU   CHAINS01+134                                             06598000
FLC      EQU   PSA                                                      06599000
PSARSVTE EQU   PSARSVT                                                  06600000
JSCBSEC2 EQU   JSCBEND1                                                 06601000
JSCBSEC3 EQU   JSCBEND1                                                 06602000
JSCBJCT  EQU   JSCBSEC3                                                 06603000
JSCBJCTA EQU   JSCBJCT+1                                                06604000
JSCBASID EQU   JSCBSEC3+8                                               06605000
JSCBFBYT EQU   JSCBSEC3+10                                              06606000
JSCBJNL  EQU   JSCBSEC3+28                                              06607000
JSCBJJSB EQU   JSCBJNL                                                  06608000
JSCBSUB  EQU   JSCBSEC3+40                                              06609000
JSCSCT   EQU   JSCBSEC3+68                                              06610000
JSCRSV45 EQU   JSCBSEC3+112                                             06611000
JSCRSV46 EQU   JSCRSV45                                                 06612000
JSCRSV47 EQU   JSCRSV45+2                                               06613000
I056     EQU   ILIST                                                    06614000
I05601   EQU   I056+4                                                   06615000
I05602   EQU   I056+8                                                   06616000
I05603   EQU   I05602                                                   06617000
I05604   EQU   I05602+1                                                 06618000
I05605   EQU   I05602+2                                                 06619000
I05655   EQU   I05602+3                                                 06620000
I05606   EQU   I05602+4                                                 06621000
I05607   EQU   I05602+8                                                 06622000
I048     EQU   ILIST                                                    06623000
I04801   EQU   I048                                                     06624000
I04802   EQU   I048+4                                                   06625000
I04803   EQU   I04802                                                   06626000
I04804   EQU   I04803                                                   06627000
I04805   EQU   I04803+1                                                 06628000
I04806   EQU   I04803+2                                                 06629000
I04807   EQU   I04802+4                                                 06630000
I04808   EQU   I04802+8                                                 06631000
STOREIT  EQU   SAVBLKNM                                                 06632000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06633000
@NM00160 EQU   I04803+3                                                 06634000
I05600   EQU   I056                                                     06635000
JSCBEND3 EQU   JSCBSEC3+120                                             06636000
JSCRSV52 EQU   JSCBSEC3+116                                             06637000
JSCRSV51 EQU   JSCRSV47+1                                               06638000
JSCRSV50 EQU   JSCRSV47                                                 06639000
JSCRSV49 EQU   JSCRSV46+1                                               06640000
JSCRSV48 EQU   JSCRSV46                                                 06641000
JSCRSV44 EQU   JSCBSEC3+108                                             06642000
JSCRSV43 EQU   JSCBSEC3+104                                             06643000
JSCRSV42 EQU   JSCBSEC3+100                                             06644000
JSCBASWA EQU   JSCBSEC3+96                                              06645000
JSCBUFPT EQU   JSCBSEC3+92                                              06646000
JSCBACT  EQU   JSCBSEC3+88                                              06647000
JSCBSWSP EQU   JSCBSEC3+87                                              06648000
JSCRSV33 EQU   JSCBSEC3+86                                              06649000
JSCDDNUM EQU   JSCBSEC3+84                                              06650000
JSCRSV53 EQU   JSCBSEC3+82                                              06651000
JSCDDNNO EQU   JSCBSEC3+80                                              06652000
JSCBVATA EQU   JSCBSEC3+76                                              06653000
JSCTMCOR EQU   JSCBSEC3+72                                              06654000
JSCSCTP  EQU   JSCSCT+1                                                 06655000
JSCRSV55 EQU   JSCSCT                                                   06656000
JSCRSV54 EQU   JSCBSEC3+64                                              06657000
JSCDSABQ EQU   JSCBSEC3+60                                              06658000
JSCBSSIB EQU   JSCBSEC3+56                                              06659000
JSCBFRBA EQU   JSCBSEC3+48                                              06660000
JSCRSV28 EQU   JSCBSEC3+46                                              06661000
JSCBSONO EQU   JSCBSEC3+44                                              06662000
JSCBSUBA EQU   JSCBSUB+1                                                06663000
JSCRSV31 EQU   JSCBSUB                                                  06664000
JSCBSMLR EQU   JSCBSEC3+36                                              06665000
JSCBJNLR EQU   JSCBSEC3+32                                              06666000
JSCBJNLA EQU   JSCBJNL+1                                                06667000
JSCBJSBT EQU   JSCBJJSB                                                 06668000
JSCBJSBX EQU   JSCBJJSB                                                 06669000
JSCBJSBA EQU   JSCBJJSB                                                 06670000
JSCBJSBI EQU   JSCBJJSB                                                 06671000
@NM00146 EQU   JSCBJJSB                                                 06672000
JSCBJNLE EQU   JSCBJJSB                                                 06673000
JSCBJNLF EQU   JSCBJJSB                                                 06674000
JSCBJNLN EQU   JSCBJJSB                                                 06675000
@NM00145 EQU   JSCBSEC3+24                                              06676000
JSCBJRBA EQU   JSCBSEC3+16                                              06677000
JSCBIECB EQU   JSCBSEC3+12                                              06678000
JSCBRV08 EQU   JSCBSEC3+11                                              06679000
JSCBRV07 EQU   JSCBFBYT                                                 06680000
JSCBRV06 EQU   JSCBFBYT                                                 06681000
JSCBRV05 EQU   JSCBFBYT                                                 06682000
JSCBRV04 EQU   JSCBFBYT                                                 06683000
JSCBRV03 EQU   JSCBFBYT                                                 06684000
JSCBRV02 EQU   JSCBFBYT                                                 06685000
JSCBADSP EQU   JSCBFBYT                                                 06686000
JSCBRV01 EQU   JSCBFBYT                                                 06687000
JSCBTJID EQU   JSCBASID                                                 06688000
JSCBPSCB EQU   JSCBSEC3+4                                               06689000
JSCJCTP  EQU   JSCBJCTA                                                 06690000
JSCRSV24 EQU   JSCBJCT                                                  06691000
JSCBEND2 EQU   JSCBSEC2                                                 06692000
PSARSAV  EQU   PSARSVTE+60                                              06693000
PSARSTK  EQU   PSARSVTE+56                                              06694000
PSAESAV3 EQU   PSARSVTE+52                                              06695000
PSAESTK3 EQU   PSARSVTE+48                                              06696000
PSAESAV2 EQU   PSARSVTE+44                                              06697000
PSAESTK2 EQU   PSARSVTE+40                                              06698000
PSAESAV1 EQU   PSARSVTE+36                                              06699000
PSAESTK1 EQU   PSARSVTE+32                                              06700000
PSAPSAV  EQU   PSARSVTE+28                                              06701000
PSAPSTK  EQU   PSARSVTE+24                                              06702000
PSAMSAV  EQU   PSARSVTE+20                                              06703000
PSAMSTK  EQU   PSARSVTE+16                                              06704000
PSASSAV  EQU   PSARSVTE+12                                              06705000
PSASSTK  EQU   PSARSVTE+8                                               06706000
PSANSTK  EQU   PSARSVTE+4                                               06707000
PSACSTK  EQU   PSARSVTE                                                 06708000
CHLAST   EQU   CHAINS01+136                                             06709000
CHSPA    EQU   CHAINS01+135                                             06710000
CHUSERID EQU   CHCSYSO                                                  06711000
CHJB     EQU   CHCSYSO                                                  06712000
CHDUMP   EQU   CHCSYSO                                                  06713000
CHQUE    EQU   CHCSYSO                                                  06714000
CHHOLD   EQU   CHCSYSO                                                  06715000
CHOUT    EQU   CHCSYSO                                                  06716000
CHINN    EQU   CHCSYSO                                                  06717000
CHALL    EQU   CHCSYSO                                                  06718000
CHINC    EQU   CHAINS01+132                                             06719000
CHPEND   EQU   CHAINS01+128                                             06720000
CHARID   EQU   CHAINS01+127                                             06721000
CHCNID   EQU   CHAINS01+126                                             06722000
@NM00106 EQU   CHTRSTAT                                                 06723000
CHTSL    EQU   CHTRSTAT                                                 06724000
CHTS     EQU   CHTRSTAT                                                 06725000
CHINITL  EQU   CHTRSTAT                                                 06726000
CHINIT   EQU   CHTRSTAT                                                 06727000
CHJOBSL  EQU   CHTRSTAT                                                 06728000
CHJOBS   EQU   CHTRSTAT                                                 06729000
CHDEF    EQU   CHTYPE                                                   06730000
CHHIAR   EQU   CHTYPE                                                   06731000
CHARSV29 EQU   CHTYPE                                                   06732000
CHARSV28 EQU   CHTYPE                                                   06733000
CHARSV27 EQU   CHTYPE                                                   06734000
CHARSV26 EQU   CHTYPE                                                   06735000
CHARSV25 EQU   CHTYPE                                                   06736000
CHDSTAT  EQU   CHTYPE                                                   06737000
CHBUF    EQU   CHAINS01                                                 06738000
@NM00035 EQU   PRFGRP+2                                                 06739000
@NM00034 EQU   PRFGRP                                                   06740000
CVTRV628 EQU   CVTS01+728                                               06741000
CVTRV627 EQU   CVTS01+724                                               06742000
CVTRV626 EQU   CVTS01+720                                               06743000
CVTRV625 EQU   CVTS01+716                                               06744000
CVTRV624 EQU   CVTS01+712                                               06745000
CVTRV623 EQU   CVTS01+708                                               06746000
CVTRV622 EQU   CVTS01+704                                               06747000
CVTRV621 EQU   CVTS01+700                                               06748000
CVTIHASU EQU   CVTS01+696                                               06749000
CVTRV619 EQU   CVTS01+692                                               06750000
CVTRV618 EQU   CVTS01+688                                               06751000
CVTRV617 EQU   CVTS01+684                                               06752000
CVTRV616 EQU   CVTS01+680                                               06753000
CVTRV615 EQU   CVTS01+676                                               06754000
CVTRV614 EQU   CVTS01+672                                               06755000
CVTRV613 EQU   CVTS01+668                                               06756000
CVT0PT03 EQU   CVTS01+660                                               06757000
CVT0PT0E EQU   CVTS01+656                                               06758000
CVTRV609 EQU   CVTS01+652                                               06759000
CVTCGK   EQU   CVTS01+648                                               06760000
CVTHSM   EQU   CVTS01+640                                               06761000
CVTRV605 EQU   CVTS01+636                                               06762000
CVTRV604 EQU   CVTS01+632                                               06763000
CVTEFF02 EQU   CVTS01+628                                               06764000
CVTCBBR  EQU   CVTS01+624                                               06765000
CVTSSCR  EQU   CVTS01+620                                               06766000
CVTEVENT EQU   CVTS01+616                                               06767000
CVTCRCA  EQU   CVTS01+612                                               06768000
CVTTPIO  EQU   CVTS01+608                                               06769000
CVTADV   EQU   CVTS01+604                                               06770000
CVTGSDAB EQU   CVTGSDA                                                  06771000
CVTQV3   EQU   CVTS01+596                                               06772000
CVTQV2   EQU   CVTS01+592                                               06773000
CVTQV1   EQU   CVTS01+588                                               06774000
CVTRPT   EQU   CVTS01+584                                               06775000
CVTSSRB  EQU   CVTS01+580                                               06776000
CVTCSDRL EQU   CVTS01+576                                               06777000
CVTEXP1  EQU   CVTS01+572                                               06778000
CVTRMPMT EQU   CVTS01+568                                               06779000
CVTRMPTT EQU   CVTS01+564                                               06780000
CVTVPSA  EQU   CVTS01+560                                               06781000
CVTVSTOP EQU   CVTS01+556                                               06782000
CVTGTFR8 EQU   CVTS01+552                                               06783000
CVTQUIT  EQU   CVTS01+548                                               06784000
CVTVACR  EQU   CVTS01+544                                               06785000
CVTWTCB  EQU   CVTS01+540                                               06786000
CVTSTPRS EQU   CVTS01+536                                               06787000
CVT0PT02 EQU   CVTS01+532                                               06788000
CVTDARCM EQU   CVTS01+528                                               06789000
CVTIRECM EQU   CVTS01+524                                               06790000
CVTJRECM EQU   CVTS01+520                                               06791000
CVTVEMS0 EQU   CVTS01+516                                               06792000
CVTSPFRR EQU   CVTS01+512                                               06793000
CVTRLSTG EQU   CVTS01+508                                               06794000
CVT0TC0A EQU   CVTS01+504                                               06795000
CVTGMBR  EQU   CVTS01+500                                               06796000
CVTLFRM  EQU   CVTS01+496                                               06797000
CVTRMBR  EQU   CVTS01+492                                               06798000
CVTVIOP  EQU   CVTS01+488                                               06799000
CVTRV307 EQU   CVTS01+486                                               06800000
CVTRV306 EQU   CVTS01+484                                               06801000
CVTRV305 EQU   CVTS01+482                                               06802000
CVTRV304 EQU   CVTS01+480                                               06803000
CVTRV303 EQU   CVTS01+478                                               06804000
CVTRV302 EQU   CVTS01+476                                               06805000
CVTTRCA  EQU   CVTS01+472                                               06806000
CVTRV297 EQU   CVTRV289                                                 06807000
CVTRV296 EQU   CVTRV289                                                 06808000
CVTRV295 EQU   CVTRV289                                                 06809000
CVTRV294 EQU   CVTRV289                                                 06810000
CVTRV293 EQU   CVTRV289                                                 06811000
CVTRV292 EQU   CVTRV289                                                 06812000
CVTRV291 EQU   CVTRV289                                                 06813000
CVTRV290 EQU   CVTRV289                                                 06814000
CVTRV288 EQU   CVTRV280                                                 06815000
CVTRV287 EQU   CVTRV280                                                 06816000
CVTRV286 EQU   CVTRV280                                                 06817000
CVTRV285 EQU   CVTRV280                                                 06818000
CVTRV284 EQU   CVTRV280                                                 06819000
CVTRV283 EQU   CVTRV280                                                 06820000
CVTRV282 EQU   CVTRV280                                                 06821000
CVTRV281 EQU   CVTRV280                                                 06822000
CVTRV279 EQU   CVTRV271                                                 06823000
CVTRV278 EQU   CVTRV271                                                 06824000
CVTRV277 EQU   CVTRV271                                                 06825000
CVTRV276 EQU   CVTRV271                                                 06826000
CVTRV275 EQU   CVTRV271                                                 06827000
CVTRV274 EQU   CVTRV271                                                 06828000
CVTRV273 EQU   CVTRV271                                                 06829000
CVTRV272 EQU   CVTRV271                                                 06830000
CVTRV270 EQU   CVTRV262                                                 06831000
CVTRV269 EQU   CVTRV262                                                 06832000
CVTRV268 EQU   CVTRV262                                                 06833000
CVTRV267 EQU   CVTRV262                                                 06834000
CVTRV266 EQU   CVTRV262                                                 06835000
CVTRV265 EQU   CVTRV262                                                 06836000
CVTRV264 EQU   CVTRV262                                                 06837000
CVTRV263 EQU   CVTRV262                                                 06838000
CVTVFP   EQU   CVTS01+464                                               06839000
CVTVSI   EQU   CVTS01+460                                               06840000
CVTVPSIB EQU   CVTS01+456                                               06841000
CVTMFACT EQU   CVTMFRTR                                                 06842000
CVTMFCTL EQU   CVTS01+448                                               06843000
CVTPVBP  EQU   CVTS01+444                                               06844000
CVTPWI   EQU   CVTS01+440                                               06845000
CVTRV254 EQU   CVTS01+438                                               06846000
CVTRV253 EQU   CVTS01+436                                               06847000
CVTRV252 EQU   CVTS01+434                                               06848000
CVTRV251 EQU   CVTS01+433                                               06849000
CVTRV250 EQU   CVTS01+432                                               06850000
CVTRV249 EQU   CVTS01+431                                               06851000
CVTRV248 EQU   CVTS01+430                                               06852000
CVTRV247 EQU   CVTS01+429                                               06853000
CVTRV246 EQU   CVTS01+428                                               06854000
CVTRV245 EQU   CVTRV237                                                 06855000
CVTRV244 EQU   CVTRV237                                                 06856000
CVTRV243 EQU   CVTRV237                                                 06857000
CVTRV242 EQU   CVTRV237                                                 06858000
CVTRV241 EQU   CVTRV237                                                 06859000
CVTRV240 EQU   CVTRV237                                                 06860000
CVTRV239 EQU   CVTRV237                                                 06861000
CVTRV238 EQU   CVTRV237                                                 06862000
CVTRV236 EQU   CVTRV228                                                 06863000
CVTRV235 EQU   CVTRV228                                                 06864000
CVTRV234 EQU   CVTRV228                                                 06865000
CVTRV233 EQU   CVTRV228                                                 06866000
CVTRV232 EQU   CVTRV228                                                 06867000
CVTRV231 EQU   CVTRV228                                                 06868000
CVTRV230 EQU   CVTRV228                                                 06869000
CVTRV229 EQU   CVTRV228                                                 06870000
CVTRV227 EQU   CVTRV219                                                 06871000
CVTRV226 EQU   CVTRV219                                                 06872000
CVTRV225 EQU   CVTRV219                                                 06873000
CVTRV224 EQU   CVTRV219                                                 06874000
CVTRV223 EQU   CVTRV219                                                 06875000
CVTRV222 EQU   CVTRV219                                                 06876000
CVTRV221 EQU   CVTRV219                                                 06877000
CVTRV220 EQU   CVTRV219                                                 06878000
CVTRV218 EQU   CVTRV210                                                 06879000
CVTRV217 EQU   CVTRV210                                                 06880000
CVTRV216 EQU   CVTRV210                                                 06881000
CVTRV215 EQU   CVTRV210                                                 06882000
CVTRV214 EQU   CVTRV210                                                 06883000
CVTRV213 EQU   CVTRV210                                                 06884000
CVTRV212 EQU   CVTRV210                                                 06885000
CVTRV211 EQU   CVTRV210                                                 06886000
CVTLCCAT EQU   CVTS01+420                                               06887000
CVTPCCAT EQU   CVTS01+416                                               06888000
CVTIPCRP EQU   CVTS01+412                                               06889000
CVTIPCRI EQU   CVTS01+408                                               06890000
CVTIPCDS EQU   CVTS01+404                                               06891000
CVTAIDVT EQU   CVTS01+400                                               06892000
CVTSSAP  EQU   CVTS01+396                                               06893000
CVTEHCIR EQU   CVTS01+392                                               06894000
CVTEHDEF EQU   CVTS01+388                                               06895000
CVTDAIR  EQU   CVTS01+384                                               06896000
CVTPERFM EQU   CVTS01+380                                               06897000
CVT044R2 EQU   CVTS01+376                                               06898000
CVTFETCH EQU   CVTS01+372                                               06899000
CVTRSTWD EQU   CVTS01+368                                               06900000
CVTSPOST EQU   CVTS01+364                                               06901000
CVTIOBP  EQU   CVTS01+360                                               06902000
CVTASMVT EQU   CVTS01+356                                               06903000
CVTRECRQ EQU   CVTS01+352                                               06904000
CVTWSAC  EQU   CVTS01+348                                               06905000
CVTRV149 EQU   CVTS01+344                                               06906000
CVTWSAL  EQU   CVTS01+340                                               06907000
CVTSPSA  EQU   CVTS01+336                                               06908000
CVTGLMN  EQU   CVTS01+332                                               06909000
CVTVEAC0 EQU   CVTS01+328                                               06910000
CVT062R1 EQU   CVTS01+324                                               06911000
CVTRPOST EQU   CVTS01+320                                               06912000
CVTDQIQE EQU   CVTS01+316                                               06913000
CVTCSD   EQU   CVTS01+312                                               06914000
CVTLKRMA EQU   CVTS01+308                                               06915000
CVTRSPIE EQU   CVTS01+304                                               06916000
CVTRENQ  EQU   CVTS01+300                                               06917000
CVTLQCB  EQU   CVTS01+296                                               06918000
CVTFQCB  EQU   CVTS01+292                                               06919000
CVTQCS01 EQU   CVTS01+288                                               06920000
CVTAPFT  EQU   CVTS01+284                                               06921000
CVTPARRL EQU   CVTS01+280                                               06922000
CVTVWAIT EQU   CVTS01+276                                               06923000
CVTGSPL  EQU   CVTS01+272                                               06924000
CVTLSMQ  EQU   CVTS01+268                                               06925000
CVTGSMQ  EQU   CVTS01+264                                               06926000
CVTEXPRO EQU   CVTS01+260                                               06927000
CVTOPCTP EQU   CVTS01+256                                               06928000
CVTSIC   EQU   CVTS01+252                                               06929000
CVTTPIOS EQU   CVTS01+248                                               06930000
CVTRTMS  EQU   CVTS01+244                                               06931000
CVTSDBF  EQU   CVTS01+240                                               06932000
CVTSCBP  EQU   CVTS01+236                                               06933000
CVTSDMP  EQU   CVTS01+232                                               06934000
CVTSV60  EQU   CVTS01+228                                               06935000
CVTRTMCT EQU   CVTS01+224                                               06936000
CVTASCBL EQU   CVTS01+220                                               06937000
CVTASCBH EQU   CVTS01+216                                               06938000
CVTGDA   EQU   CVTS01+212                                               06939000
CVTASVT  EQU   CVTS01+208                                               06940000
CVTVVMDI EQU   CVTS01+204                                               06941000
CVTAQTOP EQU   CVTS01+200                                               06942000
CVTIOSCS EQU   CVTS01+196                                               06943000
CVTSDRM  EQU   CVTS01+192                                               06944000
CVTOPTE  EQU   CVTS01+188                                               06945000
CVTSTXU  EQU   CVTS01+184                                               06946000
CVTQUIS  EQU   CVTS01+180                                               06947000
CVTPARS  EQU   CVTS01+176                                               06948000
CVTS1EE  EQU   CVTS01+172                                               06949000
CVTFRAS  EQU   CVTS01+168                                               06950000
CVTQSAS  EQU   CVTS01+164                                               06951000
CVTCRAS  EQU   CVTS01+160                                               06952000
CVTCRMN  EQU   CVTS01+156                                               06953000
CVTDELCP EQU   CVTS01+152                                               06954000
CVTFRECL EQU   CVTS01+148                                               06955000
CVTGETCL EQU   CVTS01+144                                               06956000
CVTBLDCP EQU   CVTS01+140                                               06957000
CVTAUTHL EQU   CVTS01+136                                               06958000
CVTSCAN  EQU   CVTS01+132                                               06959000
CVTRV144 EQU   CVTS01+130                                               06960000
CVTMAXMP EQU   CVTS01+128                                               06961000
CVTSTCK  EQU   CVTS01+124                                               06962000
CVTRV139 EQU   CVTS01+123                                               06963000
CVTDSSAC EQU   CVTS01+122                                               06964000
CVTRV513 EQU   CVTS01+121                                               06965000
CVTIOSPL EQU   CVTS01+120                                               06966000
CVTPTGT  EQU   CVTS01+116                                               06967000
CVTCSPIE EQU   CVTS01+112                                               06968000
CVTSMFEX EQU   CVTS01+108                                               06969000
CVTOLT0A EQU   CVTS01+104                                               06970000
CVTSRBRT EQU   CVTS01+100                                               06971000
CVTPUTL  EQU   CVTS01+96                                                06972000
CVTASCRL EQU   CVTS01+92                                                06973000
CVTASCRF EQU   CVTS01+88                                                06974000
CVTRV326 EQU   CVTS01+84                                                06975000
CVTRV325 EQU   CVTS01+80                                                06976000
CVTRV324 EQU   CVTS01+76                                                06977000
CVT0VL01 EQU   CVTS01+72                                                06978000
CVTSHRVM EQU   CVTS01+68                                                06979000
CVTRV332 EQU   CVTS01+64                                                06980000
CVTTAS   EQU   CVTS01+60                                                06981000
CVTRSCN  EQU   CVTS01+56                                                06982000
CVTTRAC2 EQU   CVTS01+54                                                06983000
CVTTRACE EQU   CVTS01+52                                                06984000
CVTAPG   EQU   CVTS01+51                                                06985000
CVTSDTRC EQU   CVTCTLFG                                                 06986000
CVTGTRCE EQU   CVTCTLFG                                                 06987000
CVTNOMP  EQU   CVTCTLFG                                                 06988000
CVTRSV79 EQU   CVTCTLFG                                                 06989000
CVTDSTAT EQU   CVTCTLFG                                                 06990000
CVTRSV78 EQU   CVTCTLFG                                                 06991000
CVTRV333 EQU   CVTCTLFG                                                 06992000
CVTRV323 EQU   CVTCTLFG                                                 06993000
CVTSPVLK EQU   CVTS01+49                                                06994000
CVTRSV77 EQU   CVTS01+48                                                06995000
CVTRV331 EQU   CVTS01+44                                                06996000
CVTRV330 EQU   CVTS01+40                                                06997000
CVTRV329 EQU   CVTS01+36                                                06998000
CVTRV328 EQU   CVTS01+32                                                06999000
CVTRV322 EQU   CVTS01+28                                                07000000
CVTSLID  EQU   CVTSLIDA+1                                               07001000
CVTSYLK  EQU   CVTSLIDA                                                 07002000
CVTRV321 EQU   CVTS01+20                                                07003000
CVTRV320 EQU   CVTS01+16                                                07004000
CVTLPDIR EQU   CVTLPDIA+1                                               07005000
CVTRSV69 EQU   CVTDIRST                                                 07006000
CVTRSV68 EQU   CVTDIRST                                                 07007000
CVTRSV67 EQU   CVTDIRST                                                 07008000
CVTRSV66 EQU   CVTDIRST                                                 07009000
CVTRSV65 EQU   CVTDIRST                                                 07010000
CVTRSV64 EQU   CVTDIRST                                                 07011000
CVTRSV63 EQU   CVTDIRST                                                 07012000
CVTDICOM EQU   CVTDIRST                                                 07013000
CVTPVTP  EQU   CVTS01+8                                                 07014000
CVTLPDSR EQU   CVTS01+4                                                 07015000
CVTGETL  EQU   CVTS01                                                   07016000
BLDOFF   EQU   BLDHEAD+2                                                07017000
SSIBSUSE EQU   SSIB+32                                                  07018000
SSIBRSV1 EQU   SSIB+28                                                  07019000
SSIBDEST EQU   SSIB+20                                                  07020000
SSIBJBID EQU   SSIB+12                                                  07021000
SSIBRESV EQU   SSIB+7                                                   07022000
@NM00159 EQU   SSIBFLG1                                                 07023000
SSIBPJES EQU   SSIBFLG1                                                 07024000
JESSSCT  EQU   JESCT+24                                                 07025000
JESRESQM EQU   JESCT+16                                                 07026000
JESQMGR  EQU   JESCT+12                                                 07027000
JESUNITS EQU   JESCT+4                                                  07028000
@NM00158 EQU   JESCT                                                    07029000
@NM00155 EQU   DROBD+12                                                 07030000
@NM00154 EQU   DROBD+1                                                  07031000
UADSRCTR EQU   DROBD                                                    07032000
@NM00153 EQU   DNOBD+1                                                  07033000
UADSACTR EQU   DNOBD                                                    07034000
@NM00152 EQU   DPOBD+1                                                  07035000
UADSPCTR EQU   DPOBD                                                    07036000
@NM00151 EQU   DHED+44                                                  07037000
@NM00150 EQU   UADSATTR                                                 07038000
USATR04  EQU   UADSATTR                                                 07039000
@NM00149 EQU   UADSATTR                                                 07040000
USATR03  EQU   UADSATTR                                                 07041000
USATR02  EQU   UADSATTR                                                 07042000
USATR01  EQU   UADSATTR                                                 07043000
USATR00  EQU   UADSATTR                                                 07044000
@NM00148 EQU   UADSBN01+1                                               07045000
UADSXUSD EQU   UADSBN01+1                                               07046000
UADSXBLK EQU   UADSBN01+1                                               07047000
UADSNUSP EQU   UADSBN01+1                                               07048000
@NM00147 EQU   UADSBN01                                                 07049000
UADSUSER EQU   UADSMHDR+4                                               07050000
UADSFSQP EQU   UADSMHDR+2                                               07051000
UADSBLNG EQU   UADSMHDR                                                 07052000
JSCBCSCB EQU   JSCBSEC1+68                                              07053000
JSCBPMG  EQU   JSCBWTP+2                                                07054000
JSCBWTSP EQU   JSCBWTP+1                                                07055000
JSCRSV23 EQU   JSCBWTFG                                                 07056000
JSCRSV22 EQU   JSCBWTFG                                                 07057000
JSCRSV21 EQU   JSCBWTFG                                                 07058000
JSCRSV20 EQU   JSCBWTFG                                                 07059000
JSCRSV19 EQU   JSCBWTFG                                                 07060000
JSCRSV18 EQU   JSCBWTFG                                                 07061000
JSCBRET  EQU   JSCBWTFG                                                 07062000
JSCBIOFG EQU   JSCBWTFG                                                 07063000
@NM00144 EQU   JSCBSEC1+60                                              07064000
JSCBQMPI EQU   JSCBSEC1+56                                              07065000
JSCBPMSG EQU   JSCBSWT1                                                 07066000
JSCRSV16 EQU   JSCBSWT1                                                 07067000
JSCRSV15 EQU   JSCBSWT1                                                 07068000
JSCRSV14 EQU   JSCBSWT1                                                 07069000
JSCRSV13 EQU   JSCBSWT1                                                 07070000
JSCRSV12 EQU   JSCBSWT1                                                 07071000
JSCRSV11 EQU   JSCBSWT1                                                 07072000
JSCBTTTR EQU   JSCBSEC1+52                                              07073000
JSCRSV10 EQU   JSCBSEC1+49                                              07074000
JSCBAUTH EQU   JSCBOPTS                                                 07075000
JSCSIOTS EQU   JSCBOPTS                                                 07076000
JSCRSV08 EQU   JSCBOPTS                                                 07077000
JSCRSV07 EQU   JSCBOPTS                                                 07078000
JSCRSV06 EQU   JSCBOPTS                                                 07079000
JSCBLONG EQU   JSCBOPTS                                                 07080000
JSCRSV05 EQU   JSCBOPTS                                                 07081000
JSCRSV04 EQU   JSCBOPTS                                                 07082000
JSCBSECB EQU   JSCBSEC1+44                                              07083000
JSCRSV03 EQU   JSCBSEC1+41                                              07084000
JSCBSTEP EQU   JSCBSEC1+40                                              07085000
JSCBDCBA EQU   JSCBDCB+1                                                07086000
JSCRSV02 EQU   JSCBDCB                                                  07087000
JSCBID   EQU   JSCBSEC1+32                                              07088000
JSCBDBTB EQU   JSCBSEC1+28                                              07089000
JSCBIJSC EQU   JSCBSEC1+24                                              07090000
JSCBTCBP EQU   JSCBSEC1+20                                              07091000
JSCBPCC  EQU   JSCBSEC1+16                                              07092000
JSCBTCP  EQU   JSCBSEC1+12                                              07093000
JSCBSHR  EQU   JSCBSEC1+8                                               07094000
JSCHPCEA EQU   JSCHPCE+1                                                07095000
JSCRSV32 EQU   JSCHPCE                                                  07096000
JSCRSV01 EQU   JSCBSEC1                                                 07097000
@NM00143 EQU   IEZJSCB                                                  07098000
@NM00142 EQU   TCBXTNT2+32                                              07099000
TCBRV181 EQU   TCBRV173                                                 07100000
TCBRV180 EQU   TCBRV173                                                 07101000
TCBRV179 EQU   TCBRV173                                                 07102000
TCBRV178 EQU   TCBRV173                                                 07103000
TCBRV177 EQU   TCBRV173                                                 07104000
TCBRV176 EQU   TCBRV173                                                 07105000
TCBRV175 EQU   TCBRV173                                                 07106000
TCBRV174 EQU   TCBRV173                                                 07107000
TCBRV172 EQU   TCBRV164                                                 07108000
TCBRV171 EQU   TCBRV164                                                 07109000
TCBRV170 EQU   TCBRV164                                                 07110000
TCBRV169 EQU   TCBRV164                                                 07111000
TCBRV168 EQU   TCBRV164                                                 07112000
TCBRV167 EQU   TCBRV164                                                 07113000
TCBRV166 EQU   TCBRV164                                                 07114000
TCBRV165 EQU   TCBRV164                                                 07115000
TCBRV163 EQU   TCBRV155                                                 07116000
TCBRV162 EQU   TCBRV155                                                 07117000
TCBRV161 EQU   TCBRV155                                                 07118000
TCBRV160 EQU   TCBRV155                                                 07119000
TCBRV159 EQU   TCBRV155                                                 07120000
TCBRV158 EQU   TCBRV155                                                 07121000
TCBRV157 EQU   TCBRV155                                                 07122000
TCBRV156 EQU   TCBRV155                                                 07123000
TCBRV154 EQU   TCBRV146                                                 07124000
TCBRV153 EQU   TCBRV146                                                 07125000
TCBRV152 EQU   TCBRV146                                                 07126000
TCBRV151 EQU   TCBRV146                                                 07127000
TCBRV150 EQU   TCBRV146                                                 07128000
TCBRV149 EQU   TCBRV146                                                 07129000
TCBRV148 EQU   TCBRV146                                                 07130000
TCBRV147 EQU   TCBRV146                                                 07131000
TCBRV145 EQU   TCBXTNT2+26                                              07132000
TCBRV144 EQU   TCBXTNT2+24                                              07133000
TCBCAUF  EQU   TCBXTNT2+20                                              07134000
TCBRV142 EQU   TCBXTNT2+16                                              07135000
TCBRSV49 EQU   TCBXTNT2+12                                              07136000
TCBEVENT EQU   TCBXTNT2+8                                               07137000
TCBRCMP  EQU   TCBXTNT2+5                                               07138000
TCBRSVAB EQU   TCBXTNT2+4                                               07139000
TCBGTFA  EQU   TCBGTF+1                                                 07140000
TCBRSV47 EQU   TCBTFLG                                                  07141000
TCBRSV46 EQU   TCBTFLG                                                  07142000
TCBRSV45 EQU   TCBTFLG                                                  07143000
TCBRSV44 EQU   TCBTFLG                                                  07144000
TCBRSV43 EQU   TCBTFLG                                                  07145000
TCBDSPIT EQU   TCBTFLG                                                  07146000
TCBERRTN EQU   TCBTFLG                                                  07147000
TCBASYNC EQU   TCBTFLG                                                  07148000
@NM00141 EQU   TCB+296                                                  07149000
TCBSVCA2 EQU   TCB+292                                                  07150000
TCBSWASA EQU   TCB+288                                                  07151000
TCBDBTB  EQU   TCB+284                                                  07152000
TCBRPT   EQU   TCB+280                                                  07153000
TCBRV141 EQU   TCBRV133                                                 07154000
TCBRV140 EQU   TCBRV133                                                 07155000
TCBRV139 EQU   TCBRV133                                                 07156000
TCBRV138 EQU   TCBRV133                                                 07157000
TCBRV137 EQU   TCBRV133                                                 07158000
TCBRV136 EQU   TCBRV133                                                 07159000
TCBRV135 EQU   TCBRV133                                                 07160000
TCBRV134 EQU   TCBRV133                                                 07161000
TCBRV132 EQU   TCBRV124                                                 07162000
TCBRV131 EQU   TCBRV124                                                 07163000
TCBRV130 EQU   TCBRV124                                                 07164000
TCBRV129 EQU   TCBRV124                                                 07165000
TCBRV128 EQU   TCBRV124                                                 07166000
TCBRV127 EQU   TCBRV124                                                 07167000
TCBRV126 EQU   TCBRV124                                                 07168000
TCBRV125 EQU   TCBRV124                                                 07169000
TCBRV123 EQU   TCBFBYT2                                                 07170000
TCBRV122 EQU   TCBFBYT2                                                 07171000
TCBECBNV EQU   TCBFBYT2                                                 07172000
TCBSSSYN EQU   TCBFBYT2                                                 07173000
TCBFPRAP EQU   TCBFBYT2                                                 07174000
TCBFDW   EQU   TCBFBYT2                                                 07175000
TCBFMW   EQU   TCBFBYT2                                                 07176000
TCBCNCB  EQU   TCBFBYT2                                                 07177000
TCBLLH   EQU   TCBFBYT1                                                 07178000
TCBRV113 EQU   TCBFBYT1                                                 07179000
TCBEOT   EQU   TCBFBYT1                                                 07180000
TCBRTM2  EQU   TCBFBYT1                                                 07181000
TCBPGNLY EQU   TCBFBYT1                                                 07182000
TCBNDIOS EQU   TCBFBYT1                                                 07183000
TCBACTIV EQU   TCBFBYT1                                                 07184000
TCBEOTFM EQU   TCBFBYT1                                                 07185000
TCBAFFN  EQU   TCB+274                                                  07186000
TCBCCPVI EQU   TCB+272                                                  07187000
TCBUKYSP EQU   TCB+268                                                  07188000
TCBMODE  EQU   TCBESTAE+3                                               07189000
TCBERTYP EQU   TCBESTAE+2                                               07190000
TCBRV314 EQU   TCBESTRM                                                 07191000
TCBRV313 EQU   TCBESTRM                                                 07192000
TCBRV312 EQU   TCBESTRM                                                 07193000
TCBRV311 EQU   TCBESTRM                                                 07194000
TCBRV310 EQU   TCBESTRM                                                 07195000
TCBRV309 EQU   TCBESTRM                                                 07196000
TCBRV308 EQU   TCBESTRM                                                 07197000
TCBETERM EQU   TCBESTRM                                                 07198000
TCBSCBKY EQU   TCBESTAE                                                 07199000
TCBRTM12 EQU   TCB+260                                                  07200000
TCBTCBID EQU   TCB+256                                                  07201000
TCBRSV96 EQU   TCB+252                                                  07202000
TCBSWA   EQU   TCB+248                                                  07203000
TCBFOEA  EQU   TCBFOE+1                                                 07204000
TCBRSV42 EQU   TCBFOE                                                   07205000
TCBRV306 EQU   TCB+240                                                  07206000
TCBRSV41 EQU   TCB+239                                                  07207000
TCBTID   EQU   TCB+238                                                  07208000
TCBRSVAA EQU   TCB+237                                                  07209000
TCBABCUR EQU   TCB+236                                                  07210000
TCBTMSAV EQU   TCB+232                                                  07211000
TCBIOTIM EQU   TCB+228                                                  07212000
TCBRTWA  EQU   TCB+224                                                  07213000
TCBBACK  EQU   TCB+220                                                  07214000
TCBTIRB  EQU   TCB+216                                                  07215000
TCBAECB  EQU   TCB+212                                                  07216000
TCBEXT2A EQU   TCBEXT2+1                                                07217000
TCBRSV39 EQU   TCBEXT2                                                  07218000
TCBSTMCT EQU   TCB+207                                                  07219000
TCBSYSCT EQU   TCB+206                                                  07220000
TCBRSV37 EQU   TCB+205                                                  07221000
TCBEXSVC EQU   TCBDAR                                                   07222000
TCBDARMS EQU   TCBDAR                                                   07223000
TCBDARWT EQU   TCBDAR                                                   07224000
TCBDARO  EQU   TCBDAR                                                   07225000
TCBDARMC EQU   TCBDARC                                                  07226000
TCBDARD  EQU   TCBDAR                                                   07227000
TCBDARS  EQU   TCBDAR                                                   07228000
TCBDARP  EQU   TCBDAR                                                   07229000
TCBGTOFM EQU   TCBFLGS7                                                 07230000
TCBADMP  EQU   TCBFLGS7                                                 07231000
TCBRSTSK EQU   TCBFLGS7                                                 07232000
TCBSVCS  EQU   TCBFLGS7                                                 07233000
TCBSTACK EQU   TCBFLGS7                                                 07234000
TCBRSV34 EQU   TCBFLGS7                                                 07235000
TCBRSV33 EQU   TCBFLGS7                                                 07236000
TCBGPECB EQU   TCBFLGS7                                                 07237000
TCBNTJS  EQU   TCBFLGS6                                                 07238000
TCBAPG   EQU   TCBFLGS6                                                 07239000
TCBMIGR  EQU   TCBFLGS6                                                 07240000
TCBRV303 EQU   TCBFLGS6                                                 07241000
TCBSPVLK EQU   TCBFLGS6                                                 07242000
TCBCPU   EQU   TCBFLGS6                                                 07243000
TCBPIE17 EQU   TCBFLGS6                                                 07244000
TCBRV    EQU   TCBFLGS6                                                 07245000
TCBRSV79 EQU   TCBNDSP5                                                 07246000
TCBRSV78 EQU   TCBNDSP5                                                 07247000
TCBRSV77 EQU   TCBNDSP5                                                 07248000
TCBRSV76 EQU   TCBNDSP5                                                 07249000
TCBRSV75 EQU   TCBNDSP5                                                 07250000
TCBRSV74 EQU   TCBNDSP5                                                 07251000
TCBRSV95 EQU   TCBNDSP5                                                 07252000
TCBRSV94 EQU   TCBNDSP5                                                 07253000
TCBRSV93 EQU   TCBNDSP4                                                 07254000
TCBRSV92 EQU   TCBNDSP4                                                 07255000
TCBRSV91 EQU   TCBNDSP4                                                 07256000
TCBRSV90 EQU   TCBNDSP4                                                 07257000
TCBRSV89 EQU   TCBNDSP4                                                 07258000
TCBRSV88 EQU   TCBNDSP4                                                 07259000
TCBRSV87 EQU   TCBNDSP4                                                 07260000
TCBRSV86 EQU   TCBNDSP4                                                 07261000
TCBEXT1A EQU   TCBEXT1+1                                                07262000
TCBRSV32 EQU   TCBEXT1                                                  07263000
TCBEXCPD EQU   TCB+192                                                  07264000
TCBIOBRC EQU   TCB+188                                                  07265000
TCBDDWTC EQU   TCB+186                                                  07266000
TCBDDEXC EQU   TCB+184                                                  07267000
TCBJSCBB EQU   TCBJSCB+1                                                07268000
@NM00140 EQU   TCBRECDE                                                 07269000
TCBREC   EQU   TCBRECDE                                                 07270000
TCBMDIDS EQU   TCB+176                                                  07271000
TCBNDINT EQU   TCBNDSP3                                                 07272000
TCBRSV27 EQU   TCBNDSP3                                                 07273000
TCBRSV26 EQU   TCBNDSP3                                                 07274000
TCBRSV25 EQU   TCBNDSP3                                                 07275000
TCBRSV24 EQU   TCBNDSP3                                                 07276000
TCBSRBND EQU   TCBNDSP3                                                 07277000
TCBRV302 EQU   TCBNDSP3                                                 07278000
TCBLJSND EQU   TCBNDSP3                                                 07279000
TCBABE   EQU   TCBNDSP2                                                 07280000
TCBDSS   EQU   TCBNDSP2                                                 07281000
TCBOWAIT EQU   TCBNDSP2                                                 07282000
TCBIWAIT EQU   TCBNDSP2                                                 07283000
TCBNDTS  EQU   TCBNDSP2                                                 07284000
TCBNDSVC EQU   TCBNDSP2                                                 07285000
TCBSTPP  EQU   TCBNDSP2                                                 07286000
TCBABD   EQU   TCBNDSP2                                                 07287000
TCBRSV22 EQU   TCBNDSP1                                                 07288000
TCBPIEND EQU   TCBNDSP1                                                 07289000
TCBTPSP  EQU   TCBNDSP1                                                 07290000
TCBDDRND EQU   TCBNDSP1                                                 07291000
TCBRSPND EQU   TCBNDSP1                                                 07292000
TCBRSTND EQU   TCBNDSP1                                                 07293000
TCBDARPN EQU   TCBNDSP1                                                 07294000
TCBDARTN EQU   TCBNDSP1                                                 07295000
TCBNDSP0 EQU   TCBNDSP                                                  07296000
TCBUSER  EQU   TCB+168                                                  07297000
TCBTCTB  EQU   TCBTCT+1                                                 07298000
TCBRSV9C EQU   TCBTCTGF                                                 07299000
TCBRSV9B EQU   TCBTCTGF                                                 07300000
TCBRSV9A EQU   TCBTCTGF                                                 07301000
TCBRSV99 EQU   TCBTCTGF                                                 07302000
TCBRSV98 EQU   TCBTCTGF                                                 07303000
TCBRSV97 EQU   TCBTCTGF                                                 07304000
TCBRSV20 EQU   TCBTCTGF                                                 07305000
TCBSMFGF EQU   TCBTCTGF                                                 07306000
TCBSTABB EQU   TCBSTAB+1                                                07307000
TCBSTCUR EQU   TCBNSTAE                                                 07308000
TCBRV301 EQU   TCBNSTAE                                                 07309000
TCBSYNCH EQU   TCBNSTAE                                                 07310000
TCBHALT  EQU   TCBNSTAE                                                 07311000
TCBPPSUP EQU   TCBNSTAE                                                 07312000
TCB33E   EQU   TCBNSTAE                                                 07313000
TCBQUIES EQU   TCBNSTAE                                                 07314000
TCBSTABE EQU   TCBNSTAE                                                 07315000
TCBAQE   EQU   TCB+156                                                  07316000
TCBPQE   EQU   TCB+152                                                  07317000
TCBTSDP  EQU   TCB+151                                                  07318000
TCBTSLP  EQU   TCB+150                                                  07319000
TCBSTPCT EQU   TCB+149                                                  07320000
TCBCPUBN EQU   TCBTSFLG                                                 07321000
TCBDYDSP EQU   TCBTSFLG                                                 07322000
TCBRSV18 EQU   TCBTSFLG                                                 07323000
TCBRSV17 EQU   TCBTSFLG                                                 07324000
TCBTIOTG EQU   TCBTSFLG                                                 07325000
TCBATT   EQU   TCBTSFLG                                                 07326000
TCBSTPPR EQU   TCBTSFLG                                                 07327000
TCBRV300 EQU   TCBTSTSK                                                 07328000
TCBECB   EQU   TCB+144                                                  07329000
TCBIQE   EQU   TCB+140                                                  07330000
TCBLTC   EQU   TCB+136                                                  07331000
TCBOTC   EQU   TCB+132                                                  07332000
TCBNTC   EQU   TCB+128                                                  07333000
TCBJSTCA EQU   TCBJSTCB+1                                               07334000
TCBRSV16 EQU   TCBJSTCB                                                 07335000
TCBTQET  EQU   TCBTME                                                   07336000
TCBTCB   EQU   TCB+116                                                  07337000
TCBFSAB  EQU   TCBFSA+1                                                 07338000
TCBQEL   EQU   TCBFSA                                                   07339000
TCBGRS15 EQU   TCBGRS+60                                                07340000
TCBGRS14 EQU   TCBGRS+56                                                07341000
TCBGRS13 EQU   TCBGRS+52                                                07342000
TCBGRS12 EQU   TCBGRS+48                                                07343000
TCBGRS11 EQU   TCBGRS+44                                                07344000
TCBGRS10 EQU   TCBGRS+40                                                07345000
TCBGRS9  EQU   TCBGRS+36                                                07346000
TCBGRS8  EQU   TCBGRS+32                                                07347000
TCBGRS7  EQU   TCBGRS+28                                                07348000
TCBGRS6  EQU   TCBGRS+24                                                07349000
TCBGRS5  EQU   TCBGRS+20                                                07350000
TCBGRS4  EQU   TCBGRS+16                                                07351000
TCBGRS3  EQU   TCBGRS+12                                                07352000
TCBGRS2  EQU   TCBGRS+8                                                 07353000
TCBGRS1  EQU   TCBGRS+4                                                 07354000
TCBGRS0  EQU   TCBGRS                                                   07355000
TCBJPQB  EQU   TCBJPQ+1                                                 07356000
TCBRSV15 EQU   TCBPURGE                                                 07357000
TCBRSV14 EQU   TCBPURGE                                                 07358000
TCBRSV13 EQU   TCBPURGE                                                 07359000
TCBRSV12 EQU   TCBPURGE                                                 07360000
TCBRSV11 EQU   TCBPURGE                                                 07361000
TCBRSV10 EQU   TCBPURGE                                                 07362000
TCBRSV09 EQU   TCBPURGE                                                 07363000
TCBJPQF  EQU   TCBPURGE                                                 07364000
TCBJLB   EQU   TCB+40                                                   07365000
TCBLLS   EQU   TCB+36                                                   07366000
TCBDSP   EQU   TCB+35                                                   07367000
TCBLMP   EQU   TCB+34                                                   07368000
TCBPNDSP EQU   TCBFLGS5                                                 07369000
TCBFCD1  EQU   TCBFLGS5                                                 07370000
TCBSTP   EQU   TCBFLGS5                                                 07371000
TCBSYS   EQU   TCBFLGS5                                                 07372000
TCBANDSP EQU   TCBFLGS5                                                 07373000
TCBPAGE  EQU   TCBFLGS5                                                 07374000
TCBUXNDF EQU   TCBABWF                                                  07375000
TCBFC    EQU   TCBFLGS5                                                 07376000
TCBONDSP EQU   TCBFLGS4                                                 07377000
TCBMPCND EQU   TCBFLGS4                                                 07378000
TCBMPCVQ EQU   TCBFLGS4                                                 07379000
TCBUXNDV EQU   TCBFLGS4                                                 07380000
TCBHNDSP EQU   TCBFLGS4                                                 07381000
TCBRQENA EQU   TCBFLGS4                                                 07382000
TCBSER   EQU   TCBFLGS4                                                 07383000
TCBNDUMP EQU   TCBFLGS4                                                 07384000
TCBDWSTA EQU   TCBFLGS3                                                 07385000
TCBRSV08 EQU   TCBFLGS3                                                 07386000
TCBRSV07 EQU   TCBFLGS3                                                 07387000
TCBRSV06 EQU   TCBFLGS3                                                 07388000
TCBABGM  EQU   TCBFLGS3                                                 07389000
TCBABTRM EQU   TCBFLGS3                                                 07390000
TCBADINP EQU   TCBFLGS3                                                 07391000
TCBFSM   EQU   TCBFLGS3                                                 07392000
TCBFTS   EQU   TCBFLGS2                                                 07393000
TCBFETXR EQU   TCBFLGS2                                                 07394000
TCBFDSOP EQU   TCBFLGS2                                                 07395000
TCBFJMC  EQU   TCBFLGS2                                                 07396000
TCBFSMC  EQU   TCBFLGS2                                                 07397000
TCBFABOP EQU   TCBFLGS2                                                 07398000
TCBFSTI  EQU   TCBFLGS2                                                 07399000
TCBFOINP EQU   TCBFLGS2                                                 07400000
TCBFX    EQU   TCBFLGS1                                                 07401000
TCBFS    EQU   TCBFLGS1                                                 07402000
TCBFT    EQU   TCBFLGS1                                                 07403000
TCBPDUMP EQU   TCBFLGS1                                                 07404000
TCBNONPR EQU   TCBFLGS1                                                 07405000
TCBFERA  EQU   TCBFLGS1                                                 07406000
TCBFE    EQU   TCBFLGS1                                                 07407000
TCBFA    EQU   TCBFLGS1                                                 07408000
TCBZERO  EQU   TCBPKF                                                   07409000
TCBFLAG  EQU   TCBPKF                                                   07410000
TCBMSSB  EQU   TCBMSS+1                                                 07411000
TCBRSV03 EQU   TCBMSS                                                   07412000
TCBTRNB  EQU   TCBTRN+1                                                 07413000
TCBRSV02 EQU   TCBABF                                                   07414000
TCBOLTEP EQU   TCBABF                                                   07415000
TCBTCP   EQU   TCBABF                                                   07416000
TCBTCPP  EQU   TCBABF                                                   07417000
TCBRSV01 EQU   TCBABF                                                   07418000
TCBGRPH  EQU   TCBABF                                                   07419000
TCBNOCHK EQU   TCBABF                                                   07420000
TCBMOD91 EQU   TCBABF                                                   07421000
TCBCMPC  EQU   TCBCMP+1                                                 07422000
TCBRV318 EQU   TCBCMSG                                                  07423000
TCBRV317 EQU   TCBCIND                                                  07424000
TCBRV316 EQU   TCBCWTO                                                  07425000
TCBCASID EQU   TCBCDBL                                                  07426000
TCBNOCC  EQU   TCBSTCC                                                  07427000
TCBDMPO  EQU   TCBCPP                                                   07428000
TCBCSTEP EQU   TCBCMPF                                                  07429000
TCBCREQ  EQU   TCBCMPF                                                  07430000
TCBTIO   EQU   TCB+12                                                   07431000
TCBDEB   EQU   TCB+8                                                    07432000
TCBPIEA  EQU   TCBPIE+1                                                 07433000
TCBPM    EQU   TCBPMASK                                                 07434000
@NM00139 EQU   TCBPMASK                                                 07435000
TCBRBP   EQU   TCB                                                      07436000
TCBFRS6  EQU   TCBFRS+24                                                07437000
TCBFRS4  EQU   TCBFRS+16                                                07438000
TCBFRS2  EQU   TCBFRS+8                                                 07439000
TCBFRS0  EQU   TCBFRS                                                   07440000
TCBNPTR  EQU   TCBPTRS                                                  07441000
CVTLEVL  EQU   CVTRELNO+2                                               07442000
CVTNUMB  EQU   CVTRELNO                                                 07443000
CVTMDL   EQU   CVTFIX+250                                               07444000
@NM00114 EQU   CVTFIX+248                                               07445000
@NM00113 EQU   CVTFIX                                                   07446000
CVTRV482 EQU   CVTXTNT2+128                                             07447000
CVTRV481 EQU   CVTXTNT2+124                                             07448000
CVTRV480 EQU   CVTXTNT2+120                                             07449000
CVTRV479 EQU   CVTXTNT2+118                                             07450000
CVTRV478 EQU   CVTXTNT2+117                                             07451000
CVTRV477 EQU   CVTXTNT2+116                                             07452000
CVTRV476 EQU   CVTXTNT2+115                                             07453000
CVTRV475 EQU   CVTXTNT2+114                                             07454000
CVTRV474 EQU   CVTRV466                                                 07455000
CVTRV473 EQU   CVTRV466                                                 07456000
CVTRV472 EQU   CVTRV466                                                 07457000
CVTRV471 EQU   CVTRV466                                                 07458000
CVTRV470 EQU   CVTRV466                                                 07459000
CVTRV469 EQU   CVTRV466                                                 07460000
CVTRV468 EQU   CVTRV466                                                 07461000
CVTRV467 EQU   CVTRV466                                                 07462000
CVTRV465 EQU   CVTRV457                                                 07463000
CVTRV464 EQU   CVTRV457                                                 07464000
CVTRV463 EQU   CVTRV457                                                 07465000
CVTRV462 EQU   CVTRV457                                                 07466000
CVTRV461 EQU   CVTRV457                                                 07467000
CVTRV460 EQU   CVTRV457                                                 07468000
CVTRV459 EQU   CVTRV457                                                 07469000
CVTRV458 EQU   CVTRV457                                                 07470000
CVTRV456 EQU   CVTXTNT2+108                                             07471000
CVTRV455 EQU   CVTXTNT2+104                                             07472000
CVTRV454 EQU   CVTXTNT2+100                                             07473000
CVTRV453 EQU   CVTXTNT2+96                                              07474000
CVTRV452 EQU   CVTXTNT2+94                                              07475000
CVTRV451 EQU   CVTXTNT2+92                                              07476000
CVTRV450 EQU   CVTXTNT2+90                                              07477000
CVTRV449 EQU   CVTXTNT2+88                                              07478000
CVTRV448 EQU   CVTXTNT2+87                                              07479000
CVTRV447 EQU   CVTXTNT2+86                                              07480000
CVTRV446 EQU   CVTRV438                                                 07481000
CVTRV445 EQU   CVTRV438                                                 07482000
CVTRV444 EQU   CVTRV438                                                 07483000
CVTRV443 EQU   CVTRV438                                                 07484000
CVTRV442 EQU   CVTRV438                                                 07485000
CVTRV441 EQU   CVTRV438                                                 07486000
CVTRV440 EQU   CVTRV438                                                 07487000
CVTRV439 EQU   CVTRV438                                                 07488000
CVTRV437 EQU   CVTRV429                                                 07489000
CVTRV436 EQU   CVTRV429                                                 07490000
CVTRV435 EQU   CVTRV429                                                 07491000
CVTRV434 EQU   CVTRV429                                                 07492000
CVTRV433 EQU   CVTRV429                                                 07493000
CVTRV432 EQU   CVTRV429                                                 07494000
CVTRV431 EQU   CVTRV429                                                 07495000
CVTRV430 EQU   CVTRV429                                                 07496000
CVTRV428 EQU   CVTXTNT2+80                                              07497000
CVTRV427 EQU   CVTXTNT2+76                                              07498000
CVTRV426 EQU   CVTXTNT2+72                                              07499000
CVTRV425 EQU   CVTXTNT2+68                                              07500000
CVTATACT EQU   CVTATCVT                                                 07501000
CVTRV423 EQU   CVTXTNT2+62                                              07502000
CVTRV422 EQU   CVTXTNT2+60                                              07503000
CVTRV421 EQU   CVTXTNT2+58                                              07504000
CVTRV420 EQU   CVTXTNT2+56                                              07505000
CVTRV419 EQU   CVTXTNT2+55                                              07506000
CVTRV418 EQU   CVTXTNT2+54                                              07507000
CVTRV417 EQU   CVTRV409                                                 07508000
CVTRV416 EQU   CVTRV409                                                 07509000
CVTRV415 EQU   CVTRV409                                                 07510000
CVTRV414 EQU   CVTRV409                                                 07511000
CVTRV413 EQU   CVTRV409                                                 07512000
CVTRV412 EQU   CVTRV409                                                 07513000
CVTRV411 EQU   CVTRV409                                                 07514000
CVTRV410 EQU   CVTRV409                                                 07515000
CVTRV408 EQU   CVTRV400                                                 07516000
CVTRV407 EQU   CVTRV400                                                 07517000
CVTRV406 EQU   CVTRV400                                                 07518000
CVTRV405 EQU   CVTRV400                                                 07519000
CVTRV404 EQU   CVTRV400                                                 07520000
CVTRV403 EQU   CVTRV400                                                 07521000
CVTRV402 EQU   CVTRV400                                                 07522000
CVTRV401 EQU   CVTRV400                                                 07523000
CVTICB   EQU   CVTXTNT2+48                                              07524000
CVTSKTA  EQU   CVTXTNT2+44                                              07525000
CVTCCVT  EQU   CVTXTNT2+40                                              07526000
CVTRSV98 EQU   CVTXTNT2+36                                              07527000
CVTRSV97 EQU   CVTXTNT2+34                                              07528000
CVTRSV96 EQU   CVTXTNT2+32                                              07529000
CVTOLTEP EQU   CVTXTNT2+28                                              07530000
CVTQIDA  EQU   CVTQID+1                                                 07531000
CVTRSV95 EQU   CVTQID                                                   07532000
CVTRSV94 EQU   CVTXTNT2+20                                              07533000
CVTRSV93 EQU   CVTXTNT2+16                                              07534000
CVTRSV92 EQU   CVTXTNT2+12                                              07535000
CVTDEBVR EQU   CVTXTNT2+8                                               07536000
CVTRSV91 EQU   CVTXTNT2+6                                               07537000
CVTRSV9H EQU   CVTFLGBT                                                 07538000
CVTRSV9G EQU   CVTFLGBT                                                 07539000
CVTRSV9F EQU   CVTFLGBT                                                 07540000
CVTRSV9E EQU   CVTFLGBT                                                 07541000
CVTRSV9D EQU   CVTFLGBT                                                 07542000
CVTRSV9C EQU   CVTFLGBT                                                 07543000
CVTVME   EQU   CVTFLGBT                                                 07544000
CVTNPE   EQU   CVTFLGBT                                                 07545000
CVTNUCLS EQU   CVTXTNT2+4                                               07546000
CVTDSSVA EQU   CVTDSSV+1                                                07547000
CVTRSV89 EQU   CVTDSSV                                                  07548000
CVTRSV88 EQU   CVTXTNT1+8                                               07549000
CVTRSV87 EQU   CVTXTNT1+4                                               07550000
CVTFACHN EQU   CVTXTNT1                                                 07551000
CVTRV488 EQU   CVTMAP+412                                               07552000
CVTRV487 EQU   CVTMAP+408                                               07553000
CVTRV486 EQU   CVTMAP+404                                               07554000
CVTRV485 EQU   CVTMAP+400                                               07555000
CVTACTAP EQU   CVTMAP+396                                               07556000
CVTAUTH  EQU   CVTMAP+392                                               07557000
CVTATMCA EQU   CVTATMCT+1                                               07558000
CVTATMST EQU   CVTATMCT                                                 07559000
CVTRSV61 EQU   CVTMAP+384                                               07560000
CVTVOLT1 EQU   CVTVOLM1+1                                               07561000
CVTVOLI1 EQU   CVTVOLF1                                                 07562000
CVTSTOA  EQU   CVTMAP+376                                               07563000
CVTRSV58 EQU   CVTMAP+374                                               07564000
CVTRSV57 EQU   CVTMAP+372                                               07565000
CVTDDCE  EQU   CVTMAP+368                                               07566000
CVTPNWFR EQU   CVTMAP+364                                               07567000
CVTSMF   EQU   CVTMAP+360                                               07568000
CVTSULK  EQU   CVTMAP+358                                               07569000
CVTSLKO  EQU   CVTSYSK                                                  07570000
CVTSLKP  EQU   CVTSYSK                                                  07571000
CVTSLKQ  EQU   CVTSYSK                                                  07572000
CVTSLKR  EQU   CVTSYSK                                                  07573000
CVTRSV56 EQU   CVTSYSK                                                  07574000
CVTRSV55 EQU   CVTSYSK                                                  07575000
CVTRSV54 EQU   CVTSYSK                                                  07576000
CVTRSV53 EQU   CVTSYSK                                                  07577000
CVTRSV52 EQU   CVTA1F1                                                  07578000
CVTRSV51 EQU   CVTA1F1                                                  07579000
CVTRSV50 EQU   CVTA1F1                                                  07580000
CVTRSV49 EQU   CVTA1F1                                                  07581000
CVTRSV48 EQU   CVTA1F1                                                  07582000
CVTRSV47 EQU   CVTA1F1                                                  07583000
CVTSRSW  EQU   CVTA1F1                                                  07584000
CVTPFSW  EQU   CVTA1F1                                                  07585000
CVTPCVT  EQU   CVTMAP+352                                               07586000
CVTRSV46 EQU   CVTMAP+344                                               07587000
CVTRSV45 EQU   CVTMAP+340                                               07588000
CVTRSV44 EQU   CVTMAP+338                                               07589000
CVTRSV43 EQU   CVTMAP+336                                               07590000
CVTHJESA EQU   CVTHJES+1                                                07591000
CVTRSV42 EQU   CVTHJES                                                  07592000
CVTEXT2A EQU   CVTEXT2+1                                                07593000
CVTRSV41 EQU   CVTEXT2                                                  07594000
CVTAPFA  EQU   CVTAPF+1                                                 07595000
CVTRSV40 EQU   CVTAPF                                                   07596000
CVTRV518 EQU   CVTINTLA                                                 07597000
CVTRV517 EQU   CVTERPV                                                  07598000
CVTEORM  EQU   CVTMAP+312                                               07599000
CVTMCHPR EQU   CVTMAP+308                                               07600000
CVTTZ    EQU   CVTMAP+304                                               07601000
CVTJEPS  EQU   CVTMAP+300                                               07602000
CVTMODE  EQU   CVTMAP+292                                               07603000
CVTPTRV  EQU   CVTMAP+288                                               07604000
CVTREAL  EQU   CVTMAP+284                                               07605000
CVTRSV39 EQU   CVTMAP+280                                               07606000
CVTRSV38 EQU   CVTMAP+276                                               07607000
CVTDMSRA EQU   CVTDMSR+1                                                07608000
CVTRV634 EQU   CVTDMSRF                                                 07609000
CVTRV633 EQU   CVTDMSRF                                                 07610000
CVTRV632 EQU   CVTDMSRF                                                 07611000
CVTRV631 EQU   CVTDMSRF                                                 07612000
CVTRV630 EQU   CVTDMSRF                                                 07613000
CVTRV629 EQU   CVTDMSRF                                                 07614000
CVTUDUMP EQU   CVTDMSRF                                                 07615000
CVTSDUMP EQU   CVTDMSRF                                                 07616000
CVTQMSGA EQU   CVTQMSG+1                                                07617000
CVTRSV36 EQU   CVTQMSG                                                  07618000
CVTAMFF  EQU   CVTMAP+264                                               07619000
CVTPURGA EQU   CVTPURG+1                                                07620000
CVTRSV35 EQU   CVTPURG                                                  07621000
CVTCBSP  EQU   CVTMAP+256                                               07622000
CVTATERA EQU   CVTATER+1                                                07623000
CVTSYST  EQU   CVTATER                                                  07624000
CVTVOLT2 EQU   CVTTAT                                                   07625000
CVTVOLI2 EQU   CVTVOLF2                                                 07626000
CVTAQAVB EQU   CVTAQAVT+1                                               07627000
CVTRSV34 EQU   CVTTCMFG                                                 07628000
CVTRSV33 EQU   CVTTCMFG                                                 07629000
CVTRSV32 EQU   CVTTCMFG                                                 07630000
CVTRSV31 EQU   CVTTCMFG                                                 07631000
CVTRSV30 EQU   CVTTCMFG                                                 07632000
CVTRSV29 EQU   CVTTCMFG                                                 07633000
CVTRSV28 EQU   CVTTCMFG                                                 07634000
CVTTCRDY EQU   CVTTCMFG                                                 07635000
CVTGTFA  EQU   CVTGTF+1                                                 07636000
CVTRSV27 EQU   CVTGTFST                                                 07637000
CVTRNIO  EQU   CVTGTFST                                                 07638000
CVTUSR   EQU   CVTGTFST                                                 07639000
CVTRV318 EQU   CVTFORM                                                  07640000
CVTRV317 EQU   CVTTMODE                                                 07641000
CVTRV316 EQU   CVTSTATE                                                 07642000
CVTRV315 EQU   CVTGTFS                                                  07643000
CVTGTFAV EQU   CVTGTFS                                                  07644000
CVT0SCR1 EQU   CVTMAP+232                                               07645000
CVTRV515 EQU   CVTMAP+228                                               07646000
CVTRMS   EQU   CVTMAP+224                                               07647000
CVTPATCH EQU   CVTMAP+220                                               07648000
CVTTSCE  EQU   CVTMAP+216                                               07649000
CVTLNKSC EQU   CVTMAP+214                                               07650000
CVTQABST EQU   CVTMAP+212                                               07651000
CVTMDLDS EQU   CVTMAP+208                                               07652000
CVTUSER  EQU   CVTMAP+204                                               07653000
CVTABEND EQU   CVTMAP+200                                               07654000
CVTSMCA  EQU   CVTMAP+196                                               07655000
CVTRSV18 EQU   CVTMAP+192                                               07656000
CVTQLPAQ EQU   CVTMAP+188                                               07657000
CVTQCDSR EQU   CVTMAP+184                                               07658000
CVTRSV17 EQU   CVTOPTB                                                  07659000
CVTRSV16 EQU   CVTOPTB                                                  07660000
CVTFP    EQU   CVTOPTB                                                  07661000
CVTAPTHR EQU   CVTOPTB                                                  07662000
CVTNLOG  EQU   CVTOPTB                                                  07663000
CVTTOD   EQU   CVTOPTB                                                  07664000
CVTCTIMS EQU   CVTOPTB                                                  07665000
CVTPROT  EQU   CVTOPTB                                                  07666000
CVTXPFP  EQU   CVTOPTA                                                  07667000
CVTASCII EQU   CVTOPTA                                                  07668000
CVTRSV13 EQU   CVTOPTA                                                  07669000
CVTRSV12 EQU   CVTOPTA                                                  07670000
CVTNIP   EQU   CVTOPTA                                                  07671000
CVTDDR   EQU   CVTOPTA                                                  07672000
CVTAPR   EQU   CVTOPTA                                                  07673000
CVTCCH   EQU   CVTOPTA                                                  07674000
CVTSNCTR EQU   CVTMAP+180                                               07675000
CVTQMWR  EQU   CVTMAP+176                                               07676000
CVTQOCR  EQU   CVTMAP+172                                               07677000
CVT1EF00 EQU   CVTMAP+168                                               07678000
CVTMZ00  EQU   CVTMAP+164                                               07679000
CVTSV76Q EQU   CVTSV76C                                                 07680000
CVTRSV11 EQU   CVTMAP+156                                               07681000
CVT0PT01 EQU   CVTMAP+152                                               07682000
CVTMSER  EQU   CVTMAP+148                                               07683000
CVTRV516 EQU   CVTIERLC                                                 07684000
CVTILCH  EQU   CVTMAP+140                                               07685000
CVT0DS   EQU   CVTMAP+136                                               07686000
CVTFBOSV EQU   CVTMAP+132                                               07687000
CVTNUCB  EQU   CVTMAP+128                                               07688000
CVTIXAVL EQU   CVTMAP+124                                               07689000
CVTSV76M EQU   CVTIOQET                                                 07690000
CVTDCBA  EQU   CVTMAP+117                                               07691000
CVTMVS2  EQU   CVTDCB                                                   07692000
CVT6DAT  EQU   CVTDCB                                                   07693000
CVT4MPS  EQU   CVTDCB                                                   07694000
CVTRSV09 EQU   CVTDCB                                                   07695000
CVT4MS1  EQU   CVTDCB                                                   07696000
CVT2SPS  EQU   CVTDCB                                                   07697000
CVT1SSS  EQU   CVTDCB                                                   07698000
CVTRSV08 EQU   CVTDCB                                                   07699000
CVTSTB   EQU   CVTMAP+112                                               07700000
CVTQTD00 EQU   CVTMAP+108                                               07701000
CVTQTE00 EQU   CVTMAP+104                                               07702000
CVTCUCB  EQU   CVTMAP+100                                               07703000
CVTSJQ   EQU   CVTMAP+96                                                07704000
CVTPBLDL EQU   CVTMAP+92                                                07705000
CVTTPC   EQU   CVTMAP+88                                                07706000
CVTSVDCB EQU   CVTMAP+84                                                07707000
CVTBRET  EQU   CVTMAP+82                                                07708000
CVTEXIT  EQU   CVTMAP+80                                                07709000
CVT0FN00 EQU   CVTMAP+76                                                07710000
CVTDARA  EQU   CVTDAR+1                                                 07711000
CVTRSV07 EQU   CVTFLGS1                                                 07712000
CVTRSV06 EQU   CVTFLGS1                                                 07713000
CVTRSV05 EQU   CVTFLGS1                                                 07714000
CVTRSV04 EQU   CVTFLGS1                                                 07715000
CVTRSV03 EQU   CVTFLGS1                                                 07716000
CVTRSV02 EQU   CVTFLGS1                                                 07717000
CVTRSV01 EQU   CVTFLGS1                                                 07718000
CVTDMPLK EQU   CVTFLGS1                                                 07719000
CVTXITP  EQU   CVTMAP+68                                                07720000
CVTZDTAB EQU   CVTMAP+64                                                07721000
CVTMSLT  EQU   CVTMAP+60                                                07722000
CVTDATE  EQU   CVTMAP+56                                                07723000
CVTBTERM EQU   CVTMAP+52                                                07724000
CVTSYSAD EQU   CVTMAP+48                                                07725000
CVTXTLER EQU   CVTMAP+44                                                07726000
CVTILK2  EQU   CVTMAP+40                                                07727000
CVTILK1  EQU   CVTMAP+36                                                07728000
CVTPRLTV EQU   CVTMAP+32                                                07729000
CVTPCNVT EQU   CVTMAP+28                                                07730000
CVT0VL00 EQU   CVTMAP+24                                                07731000
CVTXAPG  EQU   CVTMAP+20                                                07732000
CVTBUF   EQU   CVTMAP+16                                                07733000
CVTJOB   EQU   CVTMAP+12                                                07734000
CVTLINK  EQU   CVTMAP+8                                                 07735000
CVT0EF00 EQU   CVTMAP+4                                                 07736000
CVT      EQU   CVTMAP                                                   07737000
ASXBEND  EQU   ASXB+232                                                 07738000
ASXBRV25 EQU   ASXB+228                                                 07739000
ASXBRV24 EQU   ASXB+224                                                 07740000
ASXBPT0E EQU   ASXB+220                                                 07741000
ASXBCRB4 EQU   ASXBCASW+3                                               07742000
ASXBCRB3 EQU   ASXBCASW+2                                               07743000
ASXBCRB2 EQU   ASXBCASW+1                                               07744000
ASXBCR06 EQU   ASXBCRB1                                                 07745000
ASXBCR05 EQU   ASXBCRB1                                                 07746000
ASXBCR04 EQU   ASXBCRB1                                                 07747000
ASXBCR03 EQU   ASXBCRB1                                                 07748000
ASXBCR02 EQU   ASXBCRB1                                                 07749000
ASXBCR01 EQU   ASXBCRB1                                                 07750000
ASXBTFD  EQU   ASXBCRB1                                                 07751000
ASXBPIP  EQU   ASXBCRB1                                                 07752000
ASXBCTDC EQU   ASXB+212                                                 07753000
ASXBTDCB EQU   ASXB+208                                                 07754000
ASXBRV19 EQU   ASXB+204                                                 07755000
ASXBRV34 EQU   ASCBSFLG                                                 07756000
ASXBRV33 EQU   ASCBSFLG                                                 07757000
ASXBRV32 EQU   ASCBSFLG                                                 07758000
ASXBRV31 EQU   ASCBSFLG                                                 07759000
ASXBRV30 EQU   ASCBSFLG                                                 07760000
ASXBRV29 EQU   ASCBSFLG                                                 07761000
ASXBRV28 EQU   ASCBSFLG                                                 07762000
ASXBRV27 EQU   ASCBSFLG                                                 07763000
ASXBUSER EQU   ASXB+192                                                 07764000
ASXBLSRB EQU   ASXBAEQ+20                                               07765000
ASXBFSRB EQU   ASXBAEQ+16                                               07766000
ASXBLRQE EQU   ASXBAEQ+12                                               07767000
ASXBFRQE EQU   ASXBAEQ+8                                                07768000
ASXBLIQE EQU   ASXBAEQ+4                                                07769000
ASXBFIQE EQU   ASXBAEQ                                                  07770000
ASXBETSK EQU   ASXB+164                                                 07771000
ASXBSIRB EQU   ASXB+160                                                 07772000
ASXBPSWD EQU   ASXB+152                                                 07773000
ASXBPRG  EQU   ASXB+136                                                 07774000
ASXBRV26 EQU   ASXB+132                                                 07775000
ASXBOUSB EQU   ASXB+128                                                 07776000
ASXBDDR  EQU   ASXB+124                                                 07777000
ASXBRCTD EQU   ASXB+120                                                 07778000
ASXBRSMD EQU   ASXB+116                                                 07779000
ASXBSPSA EQU   ASXB+112                                                 07780000
ASXBFRWA EQU   ASXB+108                                                 07781000
ASXBFLSA EQU   ASXB+36                                                  07782000
ASXBIHSA EQU   ASXB+32                                                  07783000
ASXBRV15 EQU   ASXB+28                                                  07784000
ASXBRV14 EQU   ASXB+24                                                  07785000
ASXBLWA  EQU   ASXB+20                                                  07786000
ASXBMPST EQU   ASXB+16                                                  07787000
ASXBRS00 EQU   ASXB+14                                                  07788000
ASXBTCBS EQU   ASXB+12                                                  07789000
ASXBLTCB EQU   ASXB+8                                                   07790000
ASXBFTCB EQU   ASXB+4                                                   07791000
ASXBASXB EQU   ASXB                                                     07792000
ASXBEGIN EQU   ASXB                                                     07793000
ASCBEND  EQU   ASCB+208                                                 07794000
ASCBSRBT EQU   ASCB+200                                                 07795000
ASCBSWTL EQU   ASCB+196                                                 07796000
ASCBRS14 EQU   ASCB+195                                                 07797000
ASCBSMCT EQU   ASCB+194                                                 07798000
ASCBRS12 EQU   ASCB+192                                                 07799000
ASCBPCTT EQU   ASCB+188                                                 07800000
ASCBVGTT EQU   ASCB+184                                                 07801000
ASCBLGCB EQU   ASCB+180                                                 07802000
ASCBJBNI EQU   ASCB+172                                                 07803000
ASCBMCC  EQU   ASCB+168                                                 07804000
ASCBRTWA EQU   ASCB+164                                                 07805000
ASCBIQEA EQU   ASCB+160                                                 07806000
ASCBXMPQ EQU   ASCB+156                                                 07807000
ASCBRS01 EQU   ASCB+154                                                 07808000
ASCBFMCT EQU   ASCB+152                                                 07809000
ASCBOUXB EQU   ASCB+148                                                 07810000
ASCBOUCB EQU   ASCB+144                                                 07811000
ASCBMECB EQU   ASCB+140                                                 07812000
ASCBQECB EQU   ASCB+136                                                 07813000
ASCBCMSB EQU   ASCB+132                                                 07814000
ASCBCMSF EQU   ASCB+128                                                 07815000
ASCBTCBS EQU   ASCB+124                                                 07816000
ASCBNVSC EQU   ASCB+122                                                 07817000
ASCBVSC  EQU   ASCB+120                                                 07818000
ASCBSRBS EQU   ASCB+118                                                 07819000
ASCBSSRB EQU   ASCB+116                                                 07820000
ASCBRV06 EQU   ASCBFLG2                                                 07821000
ASCBRV05 EQU   ASCBFLG2                                                 07822000
ASCBRV04 EQU   ASCBFLG2                                                 07823000
ASCBSNQS EQU   ASCBFLG2                                                 07824000
ASCBS2S  EQU   ASCBFLG2                                                 07825000
ASCBCEXT EQU   ASCBFLG2                                                 07826000
ASCBPXMT EQU   ASCBFLG2                                                 07827000
ASCBXMPT EQU   ASCBFLG2                                                 07828000
ASCBRF07 EQU   ASCBDSP1                                                 07829000
ASCBRF06 EQU   ASCBDSP1                                                 07830000
ASCBRF05 EQU   ASCBDSP1                                                 07831000
ASCBRF04 EQU   ASCBDSP1                                                 07832000
ASCBRF03 EQU   ASCBDSP1                                                 07833000
ASCBRF02 EQU   ASCBDSP1                                                 07834000
ASCBFAIL EQU   ASCBDSP1                                                 07835000
ASCBNOQ  EQU   ASCBDSP1                                                 07836000
ASCBSWCT EQU   ASCB+112                                                 07837000
ASCBTMCH EQU   ASCB+104                                                 07838000
ASCBNSWP EQU   ASCBFLG1                                                 07839000
ASCBTYP1 EQU   ASCBFLG1                                                 07840000
ASCBSTND EQU   ASCBFLG1                                                 07841000
ASCBABNT EQU   ASCBFLG1                                                 07842000
ASCBTERM EQU   ASCBFLG1                                                 07843000
ASCBS3S  EQU   ASCBFLG1                                                 07844000
ASCBCMSH EQU   ASCBFLG1                                                 07845000
ASCBTOFF EQU   ASCBFLG1                                                 07846000
ASCBRF01 EQU   ASCBRCTF                                                 07847000
ASCBTMLW EQU   ASCBRCTF                                                 07848000
ASCBOUT  EQU   ASCBRCTF                                                 07849000
ASCBWAIT EQU   ASCBRCTF                                                 07850000
ASCBRV08 EQU   ASCBRCTF                                                 07851000
ASCBFQU  EQU   ASCBRCTF                                                 07852000
ASCBFRS  EQU   ASCBRCTF                                                 07853000
ASCBTMNO EQU   ASCBRCTF                                                 07854000
ASCBAFFN EQU   ASCBFW1                                                  07855000
ASCBDUMP EQU   ASCB+96                                                  07856000
ASCBQSVC EQU   ASCB+92                                                  07857000
ASCBUBET EQU   ASCB+88                                                  07858000
ASCBECB  EQU   ASCB+84                                                  07859000
ASCBJSTL EQU   ASCB+80                                                  07860000
ASCBEWST EQU   ASCB+72                                                  07861000
ASCBEJST EQU   ASCB+64                                                  07862000
ASCBRSM  EQU   ASCB+52                                                  07863000
ASCBLDA  EQU   ASCB+48                                                  07864000
ASCBSTOR EQU   ASCB+44                                                  07865000
ASCBDP   EQU   ASCB+43                                                  07866000
ASCBRV07 EQU   ASCB+42                                                  07867000
ASCBIOSM EQU   ASCB+40                                                  07868000
ASCBSEQN EQU   ASCB+38                                                  07869000
ASCBASID EQU   ASCB+36                                                  07870000
ASCBCPUS EQU   ASCB+32                                                  07871000
ASCBSPL  EQU   ASCB+28                                                  07872000
ASCBLSLQ EQU   ASCB+24                                                  07873000
ASCBFSLQ EQU   ASCB+20                                                  07874000
ASCBIOSP EQU   ASCB+16                                                  07875000
ASCBLOCK EQU   ASCB+12                                                  07876000
ASCBBWDP EQU   ASCB+8                                                   07877000
ASCBFWDP EQU   ASCB+4                                                   07878000
ASCBASCB EQU   ASCB                                                     07879000
ASCBEGIN EQU   ASCB                                                     07880000
@NM00112 EQU   UPT+15                                                   07881000
UPTWTP   EQU   UPTSWS                                                   07882000
UPTMODE  EQU   UPTSWS                                                   07883000
UPTPAUS  EQU   UPTSWS                                                   07884000
UPTNCOM  EQU   UPTSWS                                                   07885000
UPTNPRM  EQU   UPTSWS                                                   07886000
UPTRCVR  EQU   UPTSWS                                                   07887000
UPTUSER  EQU   UPT+2                                                    07888000
@NM00111 EQU   UPT                                                      07889000
PSCBU    EQU   PSCB+64                                                  07890000
PSCBRLGB EQU   PSCB+48                                                  07891000
@NM00110 EQU   PSCB+36                                                  07892000
@NM00109 EQU   PSCB+32                                                  07893000
PSCBLTI2 EQU   PSCB+24                                                  07894000
PSCBLTIM EQU   PSCB+20                                                  07895000
@NM00108 EQU   PSCBATR1                                                 07896000
@NM00107 EQU   PSCBATR1                                                 07897000
PSCBRCVR EQU   PSCBATR1                                                 07898000
PSCBVMNT EQU   PSCBATR1                                                 07899000
PSCBJCL  EQU   PSCBATR1                                                 07900000
PSCBACCT EQU   PSCBATR1                                                 07901000
PSCBCTRL EQU   PSCBATR1                                                 07902000
CHARSV16 EQU   CHSHORT+100                                              07903000
CHARSV15 EQU   CHSHORT+96                                               07904000
CHJSCBVS EQU   CHSHORT+92                                               07905000
CHUSCVS  EQU   CHSHORT+88                                               07906000
@NM00105 EQU   CHSHORT+84                                               07907000
@NM00104 EQU   CHSHORT+80                                               07908000
CHSQA    EQU   CHSHORT+44                                               07909000
CHQPA    EQU   CHSHORT+8                                                07910000
CHJCL    EQU   CHSHORT+4                                                07911000
CHSPC    EQU   CHSHORT                                                  07912000
CHSPB    EQU   CHSTEP+4                                                 07913000
CHTCB    EQU   CHSTEP+1                                                 07914000
CHARSV23 EQU   CHSWT                                                    07915000
CHARSV22 EQU   CHSWT                                                    07916000
CHARSV21 EQU   CHSWT                                                    07917000
CHAC     EQU   CHSWT                                                    07918000
CHPSF    EQU   CHSWT                                                    07919000
CHPSD    EQU   CHSWT                                                    07920000
CHJCT    EQU   CHSWT                                                    07921000
CHARSV20 EQU   CHSWT                                                    07922000
CHECB    EQU   CHASM+16                                                 07923000
CHRGNAD  EQU   CHASM+12                                                 07924000
CHARSV18 EQU   CHRGNSZ+1                                                07925000
CHRPRTY  EQU   CHRGNSZ                                                  07926000
@NM00103 EQU   CHCIBP                                                   07927000
CHEND    EQU   CHCIBP                                                   07928000
CHECBP   EQU   CHASM                                                    07929000
CHDER    EQU   CHPROCSN+4                                               07930000
CHARSV10 EQU   CHACT1                                                   07931000
CHARSV09 EQU   CHACT1                                                   07932000
CHARSV08 EQU   CHACT1                                                   07933000
CHARSV07 EQU   CHACT1                                                   07934000
CHARSV06 EQU   CHACT1                                                   07935000
CHARSV05 EQU   CHACT1                                                   07936000
CHARSV04 EQU   CHACT1                                                   07937000
CHRDWTR  EQU   CHACT1                                                   07938000
CHARSV30 EQU   CHPROCSN+2                                               07939000
CHQID    EQU   CHPROCSN                                                 07940000
CHASID   EQU   CHTJID                                                   07941000
CHUCMP   EQU   CHAIN+29                                                 07942000
CHTRKID  EQU   CHPKE                                                    07943000
CHCIBCTR EQU   CHAIN+27                                                 07944000
CHUNIT   EQU   CHAIN+24                                                 07945000
CHPCOI   EQU   CHPARM                                                   07946000
CHIFY    EQU   CHACT                                                    07947000
CHAIFX   EQU   CHACT                                                    07948000
CHCLD    EQU   CHACT                                                    07949000
CHCL     EQU   CHACT                                                    07950000
CHDSI    EQU   CHACT                                                    07951000
CHDISC   EQU   CHACT                                                    07952000
CHTERM   EQU   CHACT                                                    07953000
CHSWAP   EQU   CHACT                                                    07954000
CHABTERM EQU   CHSTS                                                    07955000
CHFC     EQU   CHSTS                                                    07956000
CHDL     EQU   CHSTS                                                    07957000
CHAD     EQU   CHSTS                                                    07958000
CHQSPC   EQU   CHSTS                                                    07959000
CHSOUT   EQU   CHSTS                                                    07960000
CHSYS    EQU   CHSTS                                                    07961000
CHAP     EQU   CHSTS                                                    07962000
CHSZE    EQU   CHFLG+1                                                  07963000
CHVCD    EQU   CHFLG                                                    07964000
CHPTR    EQU   CHAIN                                                    07965000
JSELEOL  EQU   JSELASCB                                                 07966000
JSELJSXL EQU   JSEL+16                                                  07967000
JSELJSOL EQU   JSEL+4                                                   07968000
@NM00102 EQU   JSEL                                                     07969000
@NM00101 EQU   ECT+52                                                   07970000
@NM00100 EQU   ECT+48                                                   07971000
@NM00099 EQU   ECT+44                                                   07972000
@NM00098 EQU   ECTSWS2+1                                                07973000
@NM00097 EQU   ECTSWS21                                                 07974000
ECTTABND EQU   ECTSWS21                                                 07975000
ECTDEFCS EQU   ECTSWS21                                                 07976000
ECTBKPB  EQU   ECT+36                                                   07977000
ECTUSER  EQU   ECT+32                                                   07978000
ECTDDNUM EQU   ECT+29                                                   07979000
ECTATTN  EQU   ECTSWS                                                   07980000
ECTBKGRD EQU   ECTSWS                                                   07981000
ECTLOGF  EQU   ECTSWS                                                   07982000
ECTATRM  EQU   ECTSWS                                                   07983000
@NM00096 EQU   ECTSWS                                                   07984000
ECTNOPD  EQU   ECTSWS                                                   07985000
ECTSCMD  EQU   ECT+20                                                   07986000
ECTPCMD  EQU   ECT+12                                                   07987000
ECTSMSG  EQU   ECT+9                                                    07988000
ECTMSGF  EQU   ECT+8                                                    07989000
ECTIOWA  EQU   ECT+4                                                    07990000
ECTRTCD  EQU   ECT+1                                                    07991000
ECTRCDF  EQU   ECT                                                      07992000
LP0MWAT  EQU   @NM00094+4                                               07993000
@NM00095 EQU   @NM00094                                                 07994000
@NM00093 EQU   LWA+152                                                  07995000
LWASPF   EQU   LWA+148                                                  07996000
LWASWKA  EQU   LWA+144                                                  07997000
LWAGBWKA EQU   LWA+140                                                  07998000
LWARCDE  EQU   LWA+100                                                  07999000
LWAEOEL  EQU   LWAPECBP                                                 08000000
LWAAECBP EQU   LWAELST                                                  08001000
LWANQDQ  EQU   LWA+80                                                   08002000
@NM00092 EQU   LWACTLS+1                                                08003000
LWANONQ  EQU   LWACTLS+1                                                08004000
@NM00091 EQU   LWACTLS                                                  08005000
LWAMOUNT EQU   LWACTLS                                                  08006000
LWAPTID  EQU   LWA+60                                                   08007000
LWAINX1  EQU   LWAFLGS4                                                 08008000
LWATNBT  EQU   LWAFLGS4                                                 08009000
LWALTBC  EQU   LWAFLGS4                                                 08010000
LWASICSP EQU   LWAFLGS4                                                 08011000
LWAQTIP  EQU   LWAFLGS4                                                 08012000
@NM00090 EQU   LWAFLGS4                                                 08013000
LWABND   EQU   @NM00088                                                 08014000
LWAMCK   EQU   @NM00088                                                 08015000
LWAPCK   EQU   @NM00088                                                 08016000
LWAPSW   EQU   @NM00088                                                 08017000
LWAPHASE EQU   @NM00088                                                 08018000
LWAVTAM  EQU   @NM00088                                                 08019000
@NM00089 EQU   @NM00088                                                 08020000
@NM00087 EQU   @NM00086                                                 08021000
LWALS    EQU   @NM00086                                                 08022000
LWALGB   EQU   @NM00086                                                 08023000
LWALG    EQU   @NM00086                                                 08024000
LWALK    EQU   @NM00086                                                 08025000
LWALJ    EQU   @NM00086                                                 08026000
LWALGM   EQU   @NM00086                                                 08027000
LWALL    EQU   @NM00085                                                 08028000
LWALH    EQU   @NM00085                                                 08029000
LWALI    EQU   @NM00085                                                 08030000
LWALEA   EQU   @NM00085                                                 08031000
LWALC    EQU   @NM00085                                                 08032000
LWALB    EQU   @NM00085                                                 08033000
LWALA    EQU   @NM00085                                                 08034000
LWALPCNT EQU   LWA+48                                                   08035000
LWASBCE  EQU   LWASECB+3                                                08036000
@NM00084 EQU   LWASECB                                                  08037000
LWAPBCE  EQU   LWAPECB+3                                                08038000
@NM00083 EQU   LWAPECB                                                  08039000
LWAABCE  EQU   LWAAECB+3                                                08040000
@NM00082 EQU   LWAAECB                                                  08041000
LWATEST  EQU   LWA+12                                                   08042000
LWALWA   EQU   LWA+4                                                    08043000
LWAPPTR  EQU   LWA                                                      08044000
JCLSSEQ  EQU   JCLSCARD+72                                              08045000
JCLSCNTN EQU   JCLSCARD+71                                              08046000
JCLSBODY EQU   JCLSCARD+15                                              08047000
JCLSTYPE EQU   JCLSCARD+10                                              08048000
JCLSLABL EQU   JCLSCARD+2                                               08049000
JCLSLASH EQU   JCLSCARD                                                 08050000
@NM00081 EQU   JCLSHDR+4                                                08051000
TSBXEND  EQU   TSBX+88                                                  08052000
@NM00080 EQU   TSBX+80                                                  08053000
TSBXRPL  EQU   TSBX+76                                                  08054000
TSBXTMBF EQU   TSBXTERM+2                                               08055000
@NM00079 EQU   TSBXTERM+1                                               08056000
TSBXTMTP EQU   TSBXTERM                                                 08057000
TSBXAIND EQU   TSBX+70                                                  08058000
@NM00078 EQU   TSBX+68                                                  08059000
TSBXLBUF EQU   TSBX+64                                                  08060000
TSBXCSAP EQU   TSBX+60                                                  08061000
TSBXSRB  EQU   TSBX+56                                                  08062000
TSBXSRBI EQU   TSBX+52                                                  08063000
@NM00077 EQU   TSBX+48                                                  08064000
TSBXTOM  EQU   TSBX+44                                                  08065000
TSBXTIM  EQU   TSBX+40                                                  08066000
TSBXTVWA EQU   TSBX+36                                                  08067000
@NM00076 EQU   TSBX+33                                                  08068000
@NM00075 EQU   TSBXFLG1                                                 08069000
TSBXLOGF EQU   TSBXFLG1                                                 08070000
TSBXACTV EQU   TSBXFLG1                                                 08071000
TSBXASCI EQU   TSBXFLG1                                                 08072000
@NM00074 EQU   TSBX+16                                                  08073000
@NM00073 EQU   TSBX+12                                                  08074000
TSBXECB  EQU   TSBX+8                                                   08075000
TSBXBCK  EQU   TSBX+4                                                   08076000
TSBEND   EQU   TSB+120                                                  08077000
TSBALTC  EQU   TSB+103                                                  08078000
TSBALTR  EQU   TSB+102                                                  08079000
TSBPRMC  EQU   TSB+101                                                  08080000
TSBPRMR  EQU   TSB+100                                                  08081000
TSBLECB  EQU   TSBMINL                                                  08082000
TSBLINE  EQU   TSB+82                                                   08083000
TSBSTAX  EQU   TSB+81                                                   08084000
TSBATTNC EQU   TSB+80                                                   08085000
TSBF1V   EQU   TSBTPOST+7                                               08086000
TSBF1M   EQU   TSBTPOST+6                                               08087000
TSBF2V   EQU   TSBTPOST+5                                               08088000
TSBF2M   EQU   TSBTPOST+4                                               08089000
TSBFLAGV EQU   TSBTPOST+3                                               08090000
TSBFLAGM EQU   TSBTPOST+2                                               08091000
@NM00072 EQU   TSBTPOST+1                                               08092000
@NM00071 EQU   TSBTPFLG                                                 08093000
@NM00070 EQU   TSBTPFLG                                                 08094000
@NM00069 EQU   TSBTPFLG                                                 08095000
@NM00068 EQU   TSBTPFLG                                                 08096000
TSBNEWID EQU   TSBTPFLG                                                 08097000
TSBTPAYI EQU   TSBTPFLG                                                 08098000
TSBTPQCB EQU   TSBTPFLG                                                 08099000
TSBPOSTO EQU   TSBTPFLG                                                 08100000
TSBLINKB EQU   TSBLINKA+1                                               08101000
TSBPRI   EQU   TSBLINKA                                                 08102000
TSBRQCB  EQU   TSBRCB                                                   08103000
TSBCTCB  EQU   TSB+60                                                   08104000
TSBERSDS EQU   TSB+56                                                   08105000
TSBAUTOI EQU   TSB+52                                                   08106000
TSBAUTOS EQU   TSB+48                                                   08107000
TSBATNCC EQU   TSB+44                                                   08108000
TSBASRCE EQU   TSB+42                                                   08109000
TSBHLDL  EQU   TSBFLG4                                                  08110000
TSBGETBF EQU   TSBFLG4                                                  08111000
TSBCANC  EQU   TSBFLG4                                                  08112000
TSBHOLD  EQU   TSBFLG4                                                  08113000
TSBOWAIT EQU   TSBFLG4                                                  08114000
TSBIWAIT EQU   TSBFLG4                                                  08115000
TSBOCAB  EQU   TSBFLG4                                                  08116000
TSBLNNO  EQU   TSB+40                                                   08117000
TSBATNTC EQU   TSB+38                                                   08118000
TSBATNLC EQU   TSB+36                                                   08119000
TSBCHDCC EQU   TSBSTCC+1                                                08120000
TSBLNDCC EQU   TSBSTCC                                                  08121000
TSBWTJID EQU   TSB+32                                                   08122000
TSBECB   EQU   TSB+28                                                   08123000
TSBC1050 EQU   TSBTERM2                                                 08124000
@NM00067 EQU   TSBTERM2                                                 08125000
@NM00066 EQU   TSBTERM2                                                 08126000
@NM00065 EQU   TSBTERM2                                                 08127000
@NM00064 EQU   TSBTERM2                                                 08128000
TSBCTWX  EQU   TSBTERM2                                                 08129000
@NM00063 EQU   TSBTERM2                                                 08130000
@NM00062 EQU   TSBTERM2                                                 08131000
@NM00061 EQU   TSBTERM1                                                 08132000
@NM00060 EQU   TSBTERM1                                                 08133000
@NM00059 EQU   TSBTERM1                                                 08134000
TSBC2741 EQU   TSBTERM1                                                 08135000
TSBC5041 EQU   TSBTERM1                                                 08136000
TSBCATTN EQU   TSBTERM1                                                 08137000
TSBCBRK  EQU   TSBTERM1                                                 08138000
TSBCIHBN EQU   TSBTERM1                                                 08139000
TSBKEYS  EQU   TSBFLG5                                                  08140000
@NM00058 EQU   TSBFLG5                                                  08141000
TSBSPF   EQU   TSBFLG5                                                  08142000
TSBATMP  EQU   TSBFLG5                                                  08143000
TSBNFLOP EQU   TSBFLG3                                                  08144000
TSBNOBRK EQU   TSBFLG3                                                  08145000
TSBTPUT  EQU   TSBFLG3                                                  08146000
TSBAWOIP EQU   TSBFLG3                                                  08147000
TSBNBKSP EQU   TSBFLG3                                                  08148000
TSBSPIT  EQU   TSBFLG3                                                  08149000
TSBTJMSG EQU   TSBFLG3                                                  08150000
TSBATTN  EQU   TSBFLG3                                                  08151000
TSBIBFP  EQU   TSB+21                                                   08152000
TSBNIBF  EQU   TSB+20                                                   08153000
TSBITBFP EQU   TSB+17                                                   08154000
TSBSATN2 EQU   TSBFLG2                                                  08155000
TSBSATN1 EQU   TSBFLG2                                                  08156000
TSBSTAUT EQU   TSBFLG2                                                  08157000
TSBAUTOC EQU   TSBFLG2                                                  08158000
TSBAULST EQU   TSBFLG2                                                  08159000
TSBBRKIN EQU   TSBFLG2                                                  08160000
TSBAUTON EQU   TSBFLG2                                                  08161000
TSBBIPI  EQU   TSBFLG2                                                  08162000
TSBOBFP  EQU   TSB+13                                                   08163000
TSBNOBF  EQU   TSB+12                                                   08164000
TSBOTBFP EQU   TSB+9                                                    08165000
TSBLNSZ  EQU   TSB+8                                                    08166000
TSBWTCB  EQU   TSB+5                                                    08167000
TSBTJBF  EQU   TSBFLG1                                                  08168000
TSBTJIP  EQU   TSBFLG1                                                  08169000
TSBTJOW  EQU   TSBFLG1                                                  08170000
TSBIFLSH EQU   TSBFLG1                                                  08171000
TSBWOWIP EQU   TSBFLG1                                                  08172000
TSBOWIP  EQU   TSBFLG1                                                  08173000
TSBOFLSH EQU   TSBFLG1                                                  08174000
TSBANSR  EQU   TSBFLG1                                                  08175000
TSBASCB  EQU   TSBASCBA+1                                               08176000
TSBATNLD EQU   TSBSTAT                                                  08177000
TSB3270  EQU   TSBSTAT                                                  08178000
TSBDISC  EQU   TSBSTAT                                                  08179000
TSBITOFF EQU   TSBSTAT                                                  08180000
TSBNOBUF EQU   TSBSTAT                                                  08181000
TSBDSPLY EQU   TSBSTAT                                                  08182000
TSBLWAIT EQU   TSBSTAT                                                  08183000
TSBINUSE EQU   TSBSTAT                                                  08184000
@NM00042 EQU   LWPFLAGS+1                                               08185000
@NM00041 EQU   LWPFLGS1                                                 08186000
LWPGRPP  EQU   LWPGRPS                                                  08187000
LWPNPSWM EQU   LWPNPSWI                                                 08188000
LWPNPSWP EQU   LWPNPSWS                                                 08189000
LWPDESTL EQU   LWPDESTI+2                                               08190000
LWPDESTM EQU   LWPDESTI                                                 08191000
LWPDESTP EQU   LWPDESTS                                                 08192000
LWPPERF  EQU   LWPPERFI+4                                               08193000
LWPPERFL EQU   LWPPERFI+2                                               08194000
LWPPERFM EQU   LWPPERFI                                                 08195000
LWPPERFP EQU   @NM00040                                                 08196000
LWPREGN  EQU   LWPREGNI+4                                               08197000
LWPREGNL EQU   LWPREGNI+2                                               08198000
LWPREGNM EQU   LWPREGNI                                                 08199000
LWPREGNP EQU   @NM00039                                                 08200000
LWPACCTM EQU   LWPACCTI                                                 08201000
LWPACCTP EQU   LWPACCTS                                                 08202000
LWPPROCP EQU   LWPPROCS                                                 08203000
LWPPSWDM EQU   LWPPSWDI                                                 08204000
LWPPSWDP EQU   LWPPSWDS                                                 08205000
@NM00038 EQU   LWPUSERI+11                                              08206000
LWPUSERP EQU   LWPUSERS                                                 08207000
CMNDOFST EQU   CMNDBUFR+2                                               08208000
ACEEAMP  EQU   ACEE+72                                                  08209000
ACEETRID EQU   ACEE+64                                                  08210000
ACEETRDA EQU   ACEE+60                                                  08211000
ACEETRLV EQU   ACEE+59                                                  08212000
@NM00031 EQU   ACEE+58                                                  08213000
@NM00030 EQU   ACEEFLG4                                                 08214000
ACEETERM EQU   ACEEFLG4                                                 08215000
ACEETAPE EQU   ACEEFLG4                                                 08216000
ACEEDASD EQU   ACEEFLG4                                                 08217000
@NM00029 EQU   ACEEFLG4                                                 08218000
ACEEUATH EQU   ACEEFLG4                                                 08219000
@NM00028 EQU   ACEEFLG4                                                 08220000
@NM00027 EQU   ACEEFLG4                                                 08221000
ACEETRMP EQU   ACEE+52                                                  08222000
ACEEPROC EQU   ACEE+44                                                  08223000
ACEEDATE EQU   ACEE+41                                                  08224000
@NM00026 EQU   ACEEFLG3                                                 08225000
@NM00025 EQU   ACEEFLG3                                                 08226000
@NM00024 EQU   ACEEFLG3                                                 08227000
@NM00023 EQU   ACEEFLG3                                                 08228000
@NM00022 EQU   ACEEFLG3                                                 08229000
@NM00021 EQU   ACEEFLG3                                                 08230000
@NM00020 EQU   ACEEFLG3                                                 08231000
ACEEGRPA EQU   ACEEFLG3                                                 08232000
ACEENONE EQU   ACEEFLG2                                                 08233000
@NM00019 EQU   ACEEFLG2                                                 08234000
@NM00018 EQU   ACEEFLG2                                                 08235000
@NM00017 EQU   ACEEFLG2                                                 08236000
ACEEREAD EQU   ACEEFLG2                                                 08237000
ACEEUPDT EQU   ACEEFLG2                                                 08238000
ACEECNTL EQU   ACEEFLG2                                                 08239000
ACEEALTR EQU   ACEEFLG2                                                 08240000
ACEERACF EQU   ACEEFLG1                                                 08241000
@NM00016 EQU   ACEEFLG1                                                 08242000
@NM00015 EQU   ACEEFLG1                                                 08243000
ACEELOGU EQU   ACEEFLG1                                                 08244000
ACEEAUDT EQU   ACEEFLG1                                                 08245000
ACEEOPER EQU   ACEEFLG1                                                 08246000
ACEEADSP EQU   ACEEFLG1                                                 08247000
ACEESPEC EQU   ACEEFLG1                                                 08248000
ACEEGRPL EQU   ACEEGRP                                                  08249000
ACEEUSRI EQU   ACEEUSER+1                                               08250000
ACEEUSRL EQU   ACEEUSER                                                 08251000
ACEEINST EQU   ACEE+16                                                  08252000
ACEEIEP  EQU   ACEE+12                                                  08253000
@NM00014 EQU   ACEE+8                                                   08254000
ACEELEN  EQU   ACEECORE+1                                               08255000
ACEESP   EQU   ACEECORE                                                 08256000
ACEEACEE EQU   ACEE                                                     08257000
RCVTEXTA EQU   RCVT+173                                                 08258000
RCVTVERS EQU   RCVT+172                                                 08259000
RCVTRCXP EQU   RCVT+164                                                 08260000
RCVTRIXP EQU   RCVT+160                                                 08261000
RCVTRAU0 EQU   RCVT+156                                                 08262000
RCVTPINV EQU   RCVT+155                                                 08263000
@NM00013 EQU   RCVTEROP                                                 08264000
RCVTSAUD EQU   RCVTEROP                                                 08265000
RCVTAVIO EQU   RCVTEROP                                                 08266000
RCVTTUAC EQU   RCVTEROP                                                 08267000
RCVTTERP EQU   RCVTEROP                                                 08268000
RCVTNDUP EQU   RCVTFLGS                                                 08269000
RCVTSHR  EQU   RCVTFLGS                                                 08270000
RCVTRDHD EQU   RCVTFLGS                                                 08271000
RCVTROFF EQU   RCVTFLGS                                                 08272000
RCVTAXTA EQU   RCVT+152                                                 08273000
RCVTATER EQU   RCVTAUOP                                                 08274000
RCVTATAP EQU   RCVTAUOP                                                 08275000
RCVTADAS EQU   RCVTAUOP                                                 08276000
RCVTADAT EQU   RCVTAUOP                                                 08277000
RCVTAUSE EQU   RCVTAUOP                                                 08278000
RCVTAGRO EQU   RCVTAUOP                                                 08279000
@NM00012 EQU   RCVTAUOP                                                 08280000
@NM00011 EQU   RCVTSTA1                                                 08281000
RCVTTAPE EQU   RCVTSTA1                                                 08282000
RCVTUVOL EQU   RCVT+144                                                 08283000
RCVTUADS EQU   RCVT+100                                                 08284000
RCVTDSN  EQU   RCVT+56                                                  08285000
RCVTNREC EQU   RCVT+54                                                  08286000
@NM00010 EQU   RCVTSTAT                                                 08287000
RCVTNTMS EQU   RCVTSTAT                                                 08288000
RCVTNDVS EQU   RCVTSTAT                                                 08289000
RCVTNTVS EQU   RCVTSTAT                                                 08290000
RCVTNDSS EQU   RCVTSTAT                                                 08291000
RCVTNLS  EQU   RCVTSTAT                                                 08292000
RCVTDSNL EQU   RCVT+52                                                  08293000
RCVTISTL EQU   RCVT+48                                                  08294000
RCVTBAM  EQU   RCVT+44                                                  08295000
RCVTXLEN EQU   RCVT+40                                                  08296000
RCVTRUCB EQU   RCVT+36                                                  08297000
RCVTRDX  EQU   RCVT+32                                                  08298000
RCVTRCX  EQU   RCVT+28                                                  08299000
RCVTRIX  EQU   RCVT+24                                                  08300000
RCVTHDR  EQU   RCVT+20                                                  08301000
RCVTTEMP EQU   RCVT+16                                                  08302000
RCVTINDX EQU   RCVT+12                                                  08303000
RCVTDEB  EQU   RCVT+8                                                   08304000
RCVTDCB  EQU   RCVT+4                                                   08305000
RCVTID   EQU   RCVT                                                     08306000
TCASTEND EQU   TCAST+128                                                08307000
@NM00009 EQU   TCAST+120                                                08308000
@NM00008 EQU   TCAST+118                                                08309000
TCASBR14 EQU   TCAST+116                                                08310000
@NM00007 EQU   TCAST+112                                                08311000
TCASASCI EQU   TCAST+108                                                08312000
TCASTTQH EQU   TCAST+104                                                08313000
TCASNIBL EQU   TCAST+102                                                08314000
TCASEXL  EQU   TCAST+100                                                08315000
TCASRPLL EQU   TCAST+98                                                 08316000
TCASACBL EQU   TCAST+96                                                 08317000
TCASASCB EQU   TCAST+92                                                 08318000
@NM00006 EQU   TCAST+90                                                 08319000
@NM00005 EQU   TCASFLG2                                                 08320000
TCASTERM EQU   TCASFLG2                                                 08321000
@NM00004 EQU   TCASFLG1                                                 08322000
TCASNACT EQU   TCASFLG1                                                 08323000
TCASESTA EQU   TCASFLG1                                                 08324000
TCASABND EQU   TCASFLG1                                                 08325000
TCASTPEN EQU   TCASFLG1                                                 08326000
TCASLQIS EQU   TCASFLG1                                                 08327000
TCASLTE  EQU   TCAST+84                                                 08328000
TCASTPND EQU   TCAST+80                                                 08329000
TCASOQM  EQU   TCAST+76                                                 08330000
TCASIQM  EQU   TCAST+72                                                 08331000
TCASTTL  EQU   TCAST+64                                                 08332000
TCASWA   EQU   TCAST+60                                                 08333000
TCASFAIL EQU   TCAST+56                                                 08334000
TCASMSGS EQU   TCAST+52                                                 08335000
TCASTECB EQU   TCAST+48                                                 08336000
TCASMECB EQU   TCAST+44                                                 08337000
TCASXECB EQU   TCAST+40                                                 08338000
TCASTID  EQU   TCAST+32                                                 08339000
@NM00003 EQU   TCAST+31                                                 08340000
TCASCHNL EQU   TCAST+30                                                 08341000
TCASCRSZ EQU   TCAST+28                                                 08342000
TCASLBUF EQU   TCAST+24                                                 08343000
TCASHBUF EQU   TCAST+20                                                 08344000
TCASCLSZ EQU   TCAST+18                                                 08345000
TCASRCON EQU   TCAST+16                                                 08346000
TCASACBP EQU   TCAST+8                                                  08347000
TCASUMAX EQU   TCASUSER+2                                               08348000
TCASUSEC EQU   TCASUSER                                                 08349000
TCASID   EQU   TCAST                                                    08350000
TCXEND   EQU   IEDQTCXD+208                                             08351000
TCXUNUS1 EQU   IEDQTCXD+204                                             08352000
TCXESAVE EQU   IEDQTCXD+132                                             08353000
TCXERPPM EQU   IEDQTCXD+128                                             08354000
TCXERPSV EQU   IEDQTCXD+116                                             08355000
TCXSATTN EQU   IEDQTCXD+112                                             08356000
@NM00002 EQU   TCXDSAVE+4                                               08357000
@NM00001 EQU   TCXDSAVE                                                 08358000
TCXPLCB  EQU   IEDQTCXD+100                                             08359000
TCXBITS  EQU   IEDQTCXD+97                                              08360000
TCXBIT1  EQU   IEDQTCXD+96                                              08361000
TCXCOMPT EQU   IEDQTCXD+92                                              08362000
TCXAVAIL EQU   IEDQTCXD+88                                              08363000
TCXBUFL  EQU   IEDQTCXD+84                                              08364000
TCXTOTE  EQU   TCXBUFA                                                  08365000
TCXCKPM  EQU   IEDQTCXD+79                                              08366000
TCXNCKPR EQU   IEDQTCXD+78                                              08367000
TCXSZAIB EQU   IEDQTCXD+76                                              08368000
TCXAIBC  EQU   IEDQTCXD+72                                              08369000
TCXPEBC  EQU   IEDQTCXD+68                                              08370000
TCXPEWAC EQU   IEDQTCXD+64                                              08371000
TCXQRQ   EQU   IEDQTCXD+60                                              08372000
TCXOCQ   EQU   IEDQTCXD+56                                              08373000
TCXPNTQ  EQU   IEDQTCXD+52                                              08374000
TCXPUTQ  EQU   IEDQTCXD+48                                              08375000
TCXGETQ  EQU   IEDQTCXD+44                                              08376000
TCXTSI   EQU   IEDQTCXD+40                                              08377000
TCXCC3TS EQU   IEDQTCXD+35                                              08378000
TCXAPPL  EQU   TCXFLAG1                                                 08379000
TCXRTM   EQU   TCXFLAG1                                                 08380000
TCXMCPCD EQU   TCXFLAG1                                                 08381000
TCXAUTH  EQU   TCXFLAG1                                                 08382000
TCXASID  EQU   IEDQTCXD+32                                              08383000
TCXASCB  EQU   IEDQTCXD+28                                              08384000
TCXREADY EQU   IEDQTCXD+24                                              08385000
TCXPASWD EQU   IEDQTCXD+16                                              08386000
TCXDISP  EQU   IEDQTCXD+12                                              08387000
TCXTCB   EQU   IEDQTCXD+8                                               08388000
TCXATTLN EQU   TCXATTEN                                                 08389000
TCXAVT   EQU   IEDQTCXD                                                 08390000
@NM00138 EQU   PSA+3668                                                 08391000
PSASTAK  EQU   PSA+3072                                                 08392000
@NM00137 EQU   PSA+1048                                                 08393000
PSAUSEND EQU   PSA+1048                                                 08394000
PSARV062 EQU   PSA+1044                                                 08395000
PSACDAL  EQU   PSA+1040                                                 08396000
PSAWTCOD EQU   PSA+1036                                                 08397000
PSAATCVT EQU   PSA+1032                                                 08398000
PSAPCPSW EQU   PSA+1024                                                 08399000
PSAPIR2  EQU   PSA+1020                                                 08400000
PSARV059 EQU   PSA+1018                                                 08401000
PSASVC13 EQU   PSA+1016                                                 08402000
PSALSFCC EQU   PSA+1012                                                 08403000
PSASFACC EQU   PSA+1008                                                 08404000
PSASTOP  EQU   PSA+992                                                  08405000
PSASTART EQU   PSA+976                                                  08406000
PSARSPSW EQU   PSA+968                                                  08407000
PSASRPSW EQU   PSA+960                                                  08408000
PSARV045 EQU   PSA+892                                                  08409000
PSARV044 EQU   PSA+888                                                  08410000
PSARV043 EQU   PSA+884                                                  08411000
PSARV042 EQU   PSA+880                                                  08412000
PSARV041 EQU   PSA+876                                                  08413000
PSARV040 EQU   PSA+872                                                  08414000
PSARV025 EQU   PSA+868                                                  08415000
PSADSSED EQU   PSA+868                                                  08416000
PSADSSPR EQU   PSA+864                                                  08417000
PSADSSFW EQU   PSA+860                                                  08418000
PSADSS14 EQU   PSA+856                                                  08419000
PSADSSPP EQU   PSA+848                                                  08420000
PSADSSRP EQU   PSA+840                                                  08421000
PSADSS05 EQU   PSADSSF4                                                 08422000
PSADSS10 EQU   PSADSSF4                                                 08423000
PSADSSVE EQU   PSADSSF4                                                 08424000
PSADSSDE EQU   PSADSSF4                                                 08425000
PSADSSC0 EQU   PSADSSF4                                                 08426000
PSADSSIE EQU   PSADSSF4                                                 08427000
PSADSS12 EQU   PSADSSF4                                                 08428000
PSADSSRC EQU   PSADSSF4                                                 08429000
PSARV057 EQU   PSADSSF3                                                 08430000
PSARV056 EQU   PSADSSF3                                                 08431000
PSARV055 EQU   PSADSSF3                                                 08432000
PSADSSMC EQU   PSADSSF3                                                 08433000
PSADSSRW EQU   PSADSSF3                                                 08434000
PSADSSNM EQU   PSADSSF3                                                 08435000
PSADSSES EQU   PSADSSF3                                                 08436000
PSADSSGP EQU   PSADSSF3                                                 08437000
PSADSSF2 EQU   PSADSSFL+1                                               08438000
PSADSSPI EQU   PSADSSF1                                                 08439000
PSADSSOI EQU   PSADSSF1                                                 08440000
PSADSSSP EQU   PSADSSF1                                                 08441000
PSADSSTP EQU   PSADSSF1                                                 08442000
PSADSSDW EQU   PSADSSF1                                                 08443000
PSADSSDD EQU   PSADSSF1                                                 08444000
PSADSSDM EQU   PSADSSF1                                                 08445000
PSADSSMV EQU   PSADSSF1                                                 08446000
PSADSSTS EQU   PSA+816                                                  08447000
PSADSSWK EQU   PSA+812                                                  08448000
PSADSSR3 EQU   PSA+808                                                  08449000
PSADSSR2 EQU   PSA+804                                                  08450000
PSADSSRS EQU   PSA+800                                                  08451000
PSASTOR  EQU   PSA+796                                                  08452000
PSACPUSA EQU   PSA+794                                                  08453000
PSAVSTAP EQU   PSA+792                                                  08454000
PSAWKVAP EQU   PSA+788                                                  08455000
PSAWKRAP EQU   PSA+784                                                  08456000
PSAMCHIC EQU   PSA+783                                                  08457000
PSARV061 EQU   PSA+782                                                  08458000
PSASYMSK EQU   PSA+781                                                  08459000
PSAMCHFL EQU   PSA+780                                                  08460000
PSACR0   EQU   PSA+776                                                  08461000
PSAPSWSV EQU   PSA+768                                                  08462000
PSACLHS  EQU   PSAHLHI                                                  08463000
PSALKR15 EQU   PSALKSA+60                                               08464000
PSALKR14 EQU   PSALKSA+56                                               08465000
PSALKR13 EQU   PSALKSA+52                                               08466000
PSALKR12 EQU   PSALKSA+48                                               08467000
PSALKR11 EQU   PSALKSA+44                                               08468000
PSALKR10 EQU   PSALKSA+40                                               08469000
PSALKR9  EQU   PSALKSA+36                                               08470000
PSALKR8  EQU   PSALKSA+32                                               08471000
PSALKR7  EQU   PSALKSA+28                                               08472000
PSALKR6  EQU   PSALKSA+24                                               08473000
PSALKR5  EQU   PSALKSA+20                                               08474000
PSALKR4  EQU   PSALKSA+16                                               08475000
PSALKR3  EQU   PSALKSA+12                                               08476000
PSALKR2  EQU   PSALKSA+8                                                08477000
PSALKR1  EQU   PSALKSA+4                                                08478000
PSALKR0  EQU   PSALKSA                                                  08479000
PSARV023 EQU   PSACLHT+52                                               08480000
PSALOCAL EQU   PSACLHT+48                                               08481000
PSACMSL  EQU   PSACLHT+44                                               08482000
PSAOPTL  EQU   PSACLHT+40                                               08483000
PSATPACL EQU   PSACLHT+36                                               08484000
PSATPDNL EQU   PSACLHT+32                                               08485000
PSATPNCL EQU   PSACLHT+28                                               08486000
PSAIOSLL EQU   PSACLHT+24                                               08487000
PSAIOSUL EQU   PSACLHT+20                                               08488000
PSAIOSCL EQU   PSACLHT+16                                               08489000
PSAIOSSL EQU   PSACLHT+12                                               08490000
PSASALCL EQU   PSACLHT+8                                                08491000
PSAASML  EQU   PSACLHT+4                                                08492000
PSADISPL EQU   PSACLHT                                                  08493000
PSASRSA  EQU   PSA+636                                                  08494000
PSARV050 EQU   PSA+634                                                  08495000
PSADSSGO EQU   PSA+633                                                  08496000
PSARECUR EQU   PSA+632                                                  08497000
PSAHLHIS EQU   PSA+628                                                  08498000
PSAIPCSA EQU   PSA+624                                                  08499000
@NM00136 EQU   PSA+621                                                  08500000
PSAIPCDM EQU   PSA+620                                                  08501000
PSAIPCD  EQU   PSA+616                                                  08502000
@NM00135 EQU   PSA+613                                                  08503000
PSAIPCRM EQU   PSA+612                                                  08504000
PSAIPCR  EQU   PSA+608                                                  08505000
PSAMCHEX EQU   PSA+600                                                  08506000
PSAMPSW  EQU   PSA+592                                                  08507000
PSAEXPS2 EQU   PSA+584                                                  08508000
PSAEXPS1 EQU   PSA+576                                                  08509000
PSAPIREG EQU   PSA+572                                                  08510000
PSARSREG EQU   PSA+568                                                  08511000
PSAGPREG EQU   PSA+556                                                  08512000
PSARV022 EQU   PSASUP4                                                  08513000
PSARV021 EQU   PSASUP4                                                  08514000
PSARV020 EQU   PSASUP4                                                  08515000
PSARV019 EQU   PSASUP4                                                  08516000
PSARV018 EQU   PSASUP4                                                  08517000
PSARV017 EQU   PSASUP4                                                  08518000
PSARV016 EQU   PSASUP4                                                  08519000
PSARV015 EQU   PSASUP4                                                  08520000
PSARV014 EQU   PSASUP3                                                  08521000
PSARV013 EQU   PSASUP3                                                  08522000
PSARV012 EQU   PSASUP3                                                  08523000
PSAESTA  EQU   PSASUP3                                                  08524000
PSASPR   EQU   PSASUP3                                                  08525000
PSAPSREG EQU   PSASUP3                                                  08526000
PSAPI2   EQU   PSASUP3                                                  08527000
PSAIOSUP EQU   PSASUP3                                                  08528000
PSALCR   EQU   PSASUP2                                                  08529000
PSARTM   EQU   PSASUP2                                                  08530000
PSAACR   EQU   PSASUP2                                                  08531000
PSAIPCE2 EQU   PSASUP2                                                  08532000
PSAIPCES EQU   PSASUP2                                                  08533000
PSAIPCEC EQU   PSASUP2                                                  08534000
PSAGTF   EQU   PSASUP2                                                  08535000
PSAIPCRI EQU   PSASUP2                                                  08536000
PSATYPE6 EQU   PSASUP1                                                  08537000
PSATCTL  EQU   PSASUP1                                                  08538000
PSADISP  EQU   PSASUP1                                                  08539000
PSALOCK  EQU   PSASUP1                                                  08540000
PSAPI    EQU   PSASUP1                                                  08541000
PSAEXT   EQU   PSASUP1                                                  08542000
PSASVC   EQU   PSASUP1                                                  08543000
PSAIO    EQU   PSASUP1                                                  08544000
PSAAOLD  EQU   PSA+548                                                  08545000
PSAANEW  EQU   PSA+544                                                  08546000
PSATOLD  EQU   PSA+540                                                  08547000
PSATNEW  EQU   PSA+536                                                  08548000
PSALCCAR EQU   PSA+532                                                  08549000
PSALCCAV EQU   PSA+528                                                  08550000
PSAPCCAR EQU   PSA+524                                                  08551000
PSAPCCAV EQU   PSA+520                                                  08552000
PSACPULA EQU   PSA+518                                                  08553000
PSACPUPA EQU   PSA+516                                                  08554000
PSAPSA   EQU   PSA+512                                                  08555000
FLCHDEND EQU   PSA+512                                                  08556000
FLCCRSAV EQU   FLCMCLA+280                                              08557000
FLCGRSAV EQU   FLCMCLA+216                                              08558000
FLCFPSAV EQU   FLCMCLA+184                                              08559000
FLCFLA   EQU   FLCMCLA+88                                               08560000
FLCRGNCD EQU   FLCMCLA+84                                               08561000
FLCFSAA  EQU   FLCFSA+1                                                 08562000
@NM00134 EQU   FLCFSA                                                   08563000
@NM00133 EQU   FLCMCLA+72                                               08564000
FLCMCIC  EQU   FLCMCLA+64                                               08565000
@NM00132 EQU   FLCMCLA+20                                               08566000
FLCIOAA  EQU   FLCIOA+1                                                 08567000
@NM00131 EQU   FLCIOA                                                   08568000
@NM00130 EQU   FLCMCLA+15                                               08569000
@NM00129 EQU   FLCMCLA+14                                               08570000
@NM00128 EQU   FLCMCLA+12                                               08571000
FLCLCL   EQU   FLCMCLA+8                                                08572000
FLCIOELA EQU   FLCIOEL+1                                                08573000
@NM00127 EQU   FLCIOEL                                                  08574000
FLCCHNID EQU   FLCMCLA                                                  08575000
@NM00126 EQU   PSA+160                                                  08576000
FLCMTRCD EQU   PSA+157                                                  08577000
@NM00125 EQU   PSA+156                                                  08578000
FLCPERA  EQU   FLCPER+1                                                 08579000
@NM00124 EQU   FLCPER                                                   08580000
@NM00123 EQU   PSA+151                                                  08581000
FLCPERCD EQU   PSA+150                                                  08582000
FLCMCNUM EQU   PSA+149                                                  08583000
@NM00122 EQU   PSA+148                                                  08584000
FLCTEAA  EQU   FLCTEA+1                                                 08585000
@NM00121 EQU   FLCTEA                                                   08586000
PSAPIPC  EQU   PSAPICOD                                                 08587000
PSAPIMC  EQU   PSAPICOD                                                 08588000
PSAPIPER EQU   PSAPICOD                                                 08589000
PSARV049 EQU   FLCPICOD                                                 08590000
FLCPILCB EQU   FLCPIILC                                                 08591000
@NM00120 EQU   FLCPIILC                                                 08592000
@NM00119 EQU   PSAEPPSW                                                 08593000
FLCSVCN  EQU   PSAESPSW+2                                               08594000
FLCSILCB EQU   FLCSVILC                                                 08595000
@NM00118 EQU   FLCSVILC                                                 08596000
@NM00117 EQU   PSAESPSW                                                 08597000
FLCEICOD EQU   PSAEEPSW+2                                               08598000
PSASPAD  EQU   PSAEEPSW                                                 08599000
@NM00116 EQU   PSA+128                                                  08600000
FLCINPSW EQU   PSA+120                                                  08601000
FLCMNPSW EQU   PSA+112                                                  08602000
FLCPNPSW EQU   PSA+104                                                  08603000
FLCSNPSW EQU   PSA+96                                                   08604000
FLCENPSW EQU   PSA+88                                                   08605000
FLCTRACE EQU   PSA+84                                                   08606000
FLCTIMER EQU   PSA+80                                                   08607000
FLCCVT2  EQU   PSA+76                                                   08608000
FLCCAW   EQU   PSA+72                                                   08609000
FLCCSW   EQU   PSA+64                                                   08610000
FLCIOPSW EQU   PSA+56                                                   08611000
FLCMOPSW EQU   PSA+48                                                   08612000
FLCPOPSW EQU   PSA+40                                                   08613000
FLCSOPSW EQU   PSA+32                                                   08614000
FLCEOPSW EQU   PSA+24                                                   08615000
@NM00115 EQU   FLCICCW2+4                                               08616000
FLCCVT   EQU   FLCICCW2                                                 08617000
FLCICCW1 EQU   FLCROPSW                                                 08618000
FLCIPPSW EQU   FLCRNPSW                                                 08619000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08620000
@RF00233 EQU   GOTOIER                                                  08621000
@RT00253 EQU   CLEANUP4                                                 08622000
@RT00263 EQU   BUILDJCL                                                 08623000
@RT00287 EQU   NOOPEN                                                   08624000
@RF00302 EQU   IOERROR                                                  08625000
@RC00391 EQU   @RC00384                                                 08626000
@RC00386 EQU   @RC00384                                                 08627000
@RC00449 EQU   @RC00447                                                 08628000
@RT00476 EQU   RCDPSWD                                                  08629000
@RT00480 EQU   RCDPSWD                                                  08630000
@RT00482 EQU   PRMTPSWD                                                 08631000
@RT00484 EQU   RCDPSWD                                                  08632000
@RT00526 EQU   FNDPROC                                                  08633000
@RT00528 EQU   ACCTEND                                                  08634000
@RT00551 EQU   PRMTACCT                                                 08635000
@RT00561 EQU   PROCEND                                                  08636000
@RT00563 EQU   RCDPROC                                                  08637000
@RT00572 EQU   PRMTACCT                                                 08638000
@RT00576 EQU   RCDPROCL                                                 08639000
@RT00593 EQU   UADRGN                                                   08640000
@RT00596 EQU   RCDRGN                                                   08641000
@RT00611 EQU   PROMPTPF                                                 08642000
@RT00644 EQU   BUILDJCL                                                 08643000
@RT00664 EQU   CLEANUP4                                                 08644000
@RT00723 EQU   CNTPRMPT                                                 08645000
@RT00760 EQU   CLEANUP4                                                 08646000
@RT00762 EQU   ECBPOSTD                                                 08647000
@RT00764 EQU   CLEANUP4                                                 08648000
@RT00766 EQU   GTMNERR                                                  08649000
@RF00773 EQU   CLEANUP4                                                 08650000
@RT00814 EQU   @EL00005                                                 08651000
@RT00832 EQU   @EL00006                                                 08652000
@RF00905 EQU   RTNIOERR                                                 08653000
ENDFIND  EQU   @EL00008                                                 08654000
@RF00975 EQU   CLEANUP4                                                 08655000
@RF00969 EQU   CLEANUP4                                                 08656000
@RT01012 EQU   ONCEMORE                                                 08657000
@RF01012 EQU   CLEANUP4                                                 08658000
@RC01099 EQU   @EL00012                                                 08659000
@RT01133 EQU   CLEANUP4                                                 08660000
@RC01117 EQU   @EL00013                                                 08661000
@RF01116 EQU   @EL00013                                                 08662000
@RC01158 EQU   @RC01157                                                 08663000
@RC01162 EQU   @RC01161                                                 08664000
@RC01168 EQU   @RC01167                                                 08665000
@RF01229 EQU   CLEANUP4                                                 08666000
@RF01303 EQU   @EL00017                                                 08667000
@RF01333 EQU   @EL00018                                                 08668000
@RF01414 EQU   CLEANUP4                                                 08669000
@RT01447 EQU   CLEANUP4                                                 08670000
@RT01455 EQU   ONCEAGAN                                                 08671000
@RF01455 EQU   CLEANUP4                                                 08672000
@RF01439 EQU   @EL00020                                                 08673000
@RC01441 EQU   @EL00020                                                 08674000
@RF01466 EQU   @EL00021                                                 08675000
@RF01489 EQU   @EL00021                                                 08676000
@PB00021 EQU   @PB00022                                                 08677000
@PB00023 EQU   @EL00022                                                 08678000
@RT00924 EQU   ENDFIND                                                  08679000
@RF01447 EQU   @RC01441                                                 08680000
@PB00020 EQU   @PB00021                                                 08681000
@PB00019 EQU   @PB00020                                                 08682000
@PB00018 EQU   @PB00019                                                 08683000
@PB00017 EQU   @PB00018                                                 08684000
@PB00016 EQU   @PB00017                                                 08685000
@PB00015 EQU   @PB00016                                                 08686000
@PB00014 EQU   @PB00015                                                 08687000
@PB00013 EQU   @PB00014                                                 08688000
@PB00012 EQU   @PB00013                                                 08689000
@PB00011 EQU   @PB00012                                                 08690000
@PB00010 EQU   @PB00011                                                 08691000
@PB00009 EQU   @PB00010                                                 08692000
@PB00008 EQU   @PB00009                                                 08693000
@PB00007 EQU   @PB00008                                                 08694000
@PB00006 EQU   @PB00007                                                 08695000
@PB00005 EQU   @PB00006                                                 08696000
@PB00004 EQU   @PB00005                                                 08697000
@PB00003 EQU   @PB00004                                                 08698000
@ENDDATA EQU   *                                                        08699000
         END   IKJEFLE,(C'PLS1746',0701,78177)                          08700000
