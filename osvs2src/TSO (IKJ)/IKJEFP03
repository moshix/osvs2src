         TITLE 'I K J E F P 0 3 -- ADDRESS PCE PROCESSOR'               00020003
*                                                                     * 00020603
*********************************************************************** 00021203
*                                                                     * 00021803
*             P R O L O G U E    F O R    I K J E F P 0 3             * 00022403
*                                                                     * 00023003
*                     PARSE'S ADDRESS PCE PROCESSOR                   * 00023603
*                                                                     * 00024203
*MODULE NAME= IKJEFP03                                                * 00024803
*                                                                     * 00025403
*DESCRIPTIVE NAME= PARSE ADDRESS PCE PROCESSOR                        * 00026003
*                                                                     * 00029003
*COPYRIGHT= N/A                                                       * 00032003
*                                                                     * 00033003
*STATUS= RELEASE 02.                                                  * 00034003
*                                                                     * 00035003
*FUNCTION= THIS MODULE IS RESPONSIBLE FOR SYNTAX CHECKING AND         * 00036003
*        PROCESSING THE ADDRESS PCE (PARAMETER CONTROL ENTRY).        * 00037003
*                                                                     * 00038003
*  OPERATION= WHENEVER THE PARSE MAINLINE ENCOUNTERS AN ADDRESS PCE,  * 00040003
*        CONTROL IS IMMEDIATELY PASSED TO THIS ROUTINE.               * 00040703
*                                                                     * 00041403
*NOTES                                                                * 00042103
*  DEPENDENCIES=                                                      * 00042803
*    CHARACTER-CODE DEPENDENCIES=                                     * 00043503
*       -- CLASS C.  THE OPERATION OF THIS PROGRAM IS DEPENDENT UPON  * 00044203
*        AN INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER SET     * 00044903
*        WHICH IS EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE    * 00046003
*        CODING HAS BEEN ARRANGED SO THAT REDEFINITION OF             * 00046403
*        'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL RESULT IN A       * 00046803
*        CORRECT PROGRAM FOR THE NEW DEFINITION.                      * 00047203
*                                                                     * 00047603
*  (SEE THE PROLOGUE FOR MODULE IKJEFP00, PARSE MAINLINE ROUTINE, FOR * 00047703
*  FURTHER INFORMATION.)                                              * 00047803
*                                                                     * 00048003
*  RESTRICTIONS=  NONE.                                               * 00051003
*  REGISTER-CONVENTIONS= IKJEFP03                                     * 00054003
*  PATCH-LABEL= N/A                                                   * 00054303
*                                                                     * 00054603
*MODULE TYPE= MODULE                                                  * 00055003
*  PROCESSOR= ASSEM                                                   * 00055503
*  MODULE SIZE= N/A                                                   * 00056003
*  ATTRIBUTES= REENTRANT, REFRESHABLE, AND REUSABLE                   * 00056303
*                                                                     * 00056603
*ENTRY POINT= IKJEFP03                                                * 00057203
*  PURPOSE= TO PROCESS THE ADDRESS PCE (PARAMETER CONTROL ENTRY).     * 00057603
*  LINKAGE= STANDARD                                                  * 00057903
*  INPUT=                                                             * 00058403
*        --- REGISTER 6 - XPCE - CONTAINS CURRENT PCE POINTER         * 00058603
*        --- REGISTER 13 - CONTAINS THE PARSE WORKAREA POINTER        * 00059003
*        --- REGISTERS 7, 10, 11 ARE BASE REGISTERS FOR THE MAINLINE  * 00059503
*                    ROUTINE                                          * 00060003
*        --- REGISTER 14 IS THE BASE REGISTER FOR THIS ROUTINE        * 00060503
*        --- REGISTERS 4, 5 - XINPUT, XINPUTB - POINT TO THE          * 00061003
*                    CURRENT CHARACTER BE SCANNED IN THE INPUT BUFFER.* 00061503
*  REGISTERS SAVED= REGISTER 14.                                      * 00062003
*  REGISTER USAGE= REGISTER 14 IS THE BASE REGISTER FOR THIS ROUTINE. * 00062503
*       SINCE THIS ROUTINE CONSTANTLY CALLS OTHER ROUTINES THAT ARE   * 00063003
*       LOCATED IN THE MAINLINE ROUTINE, THE SAME REGISTER CONVENTIONS* 00063203
*       ARE USED.                                                     * 00063403
*  REGISTERS RESTORED= REGISTER 14 IS  RESTORED UPON RETURN FROM ALL  * 00063603
*       OF THE ROUTINES THAT ARE CALLED. THE LINKAGE REGISTER (8 OR 9)* 00064003
*       IS ALSO SAVED BEFORE EXIT TO THE ROUTINE AND IS RESTORED UPON * 00064403
*       RETURN FROM THE  ROUTINE.                                     * 00064803
*                                                                     * 00065003
*EXIT - NORMAL= TO THE POSIT SUBROUTINE OF THE MAINLINE ROUTINE       * 00065503
*  CONDITIONS= WHEN THE PCE IS COMPLETELY PROCESSED AND THE PDE IS    * 00066003
*      READY TO BE BUILT.                                             * 00066403
*        -- LINKAGES TO THE SUBROUTINES OF IKJEFP00 ARE MADE            00066503
*            BY WAY OF THE TWO SUBROUTINES, LINK2OUT AND LINK1OUT.      00066603
*            SINCE LINK2 (REG 8) AND LINK1 (REG 9) ARE USED AS          00066703
*            LINKAGE REGISTERS FOR PARSE, THESE ROUTINES SAVE           00066803
*            THESE REGISTERS AND RESTORE THE PROPER REGISTERS THAT ARE  00077303
*            NEEDED BY THE CALLED ROUTINES. UPON RETURN FROM THESE      00077603
*            ROUTINES, LINK2OUT AND LINK1OUT RESTORE THE BASE           00087403
*            REGISTERS, DETERMINE AND BRANCH TO THE CORRECT OFFSET      00089603
*            IN THIS ROUTINE.                                         * 00090103
*  OUTPUT= A TEMPORARY PDE HAS BEEN BUILT WHICH CONTAINS ALL OF THE   * 00090303
*       VALID DATA NECESSARY FOR BUILDING THE USER'S PDE.             * 00090603
*  RETURN CODES= NONE.                                                * 00091103
*                                                                     * 00092103
*EXIT - ERROR=                                                        * 00092603
*        -- THE ILLADDR SUBROUTINE OF THE MAINLINE ROUTINE IS GIVEN   * 00093103
*      CONTROL AND ISSUES AN INVALID ADDRESS MESSAGE.                 * 00093603
*  CONDITIONS= WHENEVER AN INVALID ADDRESS IS ENCOUNTERED IN THE INPUT* 00094103
*       BUFFER.                                                       * 00095103
*  OUTPUT= NONE.                                                      * 00095603
*  RETURN CODES= NONE                                                 * 00096103
*                                                                     * 00096603
*EXTERNAL REFERENCES=                                                 * 00097103
*  ROUTINES=                                                          * 00098103
*       THE FOLLOWING PARSE MAINLINE SUBROUTINES ARE CALLED.          * 00098603
*        SKIPB _ SKIP SEPARATOR ROUTINE.                              * 00099103
*        LISTT - LIST PROCESSING ROUTINE.                             * 00099503
*        ILLADDR - INVALID ADDRESS MESSAGE ISSUING ROUTINE.           * 00100503
*        TYPETEST - CHARACTER TYPE TESTING ROUTINE.                   * 00100703
*        STALOC - STORAGE ALLOCATION ROUTINE.                         * 00101803
*        TRANSQ - TRANSLATE TO UPPERCASE ROUTINE.                     * 00102303
*        RANGE - RANGE PROCESSING ROUTINE.                            * 00102903
*        POSITX - PDE BUILDING ROUTINE.                               * 00103603
*        PROMPTQ - PROMPTING ROUTINE.                                 * 00104203
*                                                                     * 00104803
*  DATA AREAS=                                                        * 00105403
*        -- MACRO IKJEFPWA IS SHARED BY THIS ROUTINE.                 * 00105903
*                                                                     * 00106403
*  CONTROL BLOCKS= NONE.                                              * 00107003
*                                                                     * 00107603
*TABLES AND WORKAREAS=                                                * 00108303
*        IKJEFPWA - SEE MAPPING MACRO FOR COMPLETE DETAILS.           * 00108803
*        USER PCE.                                                    * 00109303
*        USER PDE.                                                    * 00109803
*                                                                     * 00110303
*MACROS=                                                              * 00111003
*        NONE.                                                        * 00111803
*                                                                     * 00112303
*        SERIALIZATION= N/A                                           * 00112803
*                                                                     * 00113803
*CHANGE ACTIVITY= N/A                                                 * 00114303
*                                                                     * 00114703
*MESSAGES= NONE.                                                      * 00115103
*                                                                     * 00115903
*ABEND CODES= NONE.                                                   * 00116603
*                                                                     * 00117403
*********************************************************************** 00117903
*                                                                     * 00118403
*  RELEASE 3.0  SUPPORT CODE = Y30NQJN                                * 00118903
*                                                                     * 00119403
*********************************************************************** 00119903
*****                                                                 * 00120603
IKJEFP03 CSECT                                                          00121403
*                                                                       00121903
         EXTRN SKIPB,LISTT,ILLADDR,TYPETEST,STALOC              Y30NQJN 00122403
         EXTRN TRANSQ,RANGE,POSITX,PROMPTQ                      Y30NQJN 00123003
         ENTRY ADDRERSC                                         Y30NQJN 00123603
*                                                                       00124403
*       EQUATES FOR PARSE'S ADDRESS PCE PROCESSOR                       00124903
*                                                                       00125803
R0       EQU   0                       USED AS REGISTER ZERO            00126103
R1       EQU   1                       USED AS REGISTER ONE             00126503
R2       EQU   2                       USED AS REGISTER TWO             00127103
R3       EQU   3                       USED AS REGISTER THREE           00128203
XINPUT   EQU   4                       NEXT CHARACTER TO SCAN           00128703
XINPUTB  EQU   5                       LAST CHARACTER SCANNED.          00129203
*                                      USED TO COMPUTE LENGTH OF        00129703
*                                      SCANNED DATA                     00130203
R5       EQU   5                       USED AS REG. 5                   00131203
XPCE     EQU   6                       ALWAYS POINTS TO CURRENT PCE     00131703
BASE3    EQU   14                      BASE REGISTER FOR THIRD CSECT    00132203
LINK2    EQU   8                       LINKAGE REGISTER BETWEEN         00132703
*                                      SUBROUTINES                      00133203
R9       EQU   9                       USED AS REGISTER 9               00133703
BASE2    EQU   10                      BASE REGISTER FOR 2ND CSECT      00134703
BASE1    EQU   11                      MAINLINE BASE REGISTER           00135203
RBASE    EQU   12                      BASE REGISTER FOR CURRENT        00135703
*                                      RECURSIVE WORKAREA               00136203
LINK1    EQU   9                       LINKAGE REGISTER                 00137203
PBASE    EQU   13                      PERMANENT WORKSPACE BASE REGISTR 00137703
R13      EQU   13                                                       00138203
R14      EQU   14                      RETURN REGISTER                  00138703
R15      EQU   15                      CALL REGISTER                    00139203
*                                                                       00139903
*                                                                       00140603
BKCHAR   EQU   C'_'                    BREAK CHARACTER                  00141103
RIGHTPRN EQU   C')'                    RIGHT PARENTHESIS                00141603
PERIOD   EQU   C'.'                    PERIOD                           00142303
PLUS     EQU   C'+'                    PLUS SIGN                        00143103
EBCDIC0  EQU   C'0'                    CHARACTER 0                      00143603
EBCDIC1  EQU   C'1'                    CHARACTER 1                      00144103
EBCDIC2  EQU   C'2'                    CHARACTER 2                      00144603
EBCDIC3  EQU   C'3'                    CHARACTER 3                      00145603
EBCDIC4  EQU   C'4'                    CHARACTER 4                      00146103
EBCDIC5  EQU   C'5'                    CHARACTER 5                      00146603
EBCDIC6  EQU   C'6'                    CHARACTER 6                      00147103
CC7      EQU   7                       CONDITION CODE SEVEN (NZ OR NE)  00147603
CC10     EQU   10                      CONDITION CODE 10 (EQ OR GT)     00147800
*                                                                       00148103
COUNTER  EQU   2                       USED TO CONTROL MAXIMUM SIZE     00149103
LEVELS   EQU   3                       USED TO CONTROL MAXIMUM SIZE     00149603
RELATIVE EQU   C'+'                    DENOTES AN ADDRESS EXPRESSION    00150103
MORE     EQU   RELATIVE                                                 00150603
CHECK    EQU   1                       USED TO INTERFACE WITH TYPETEST  00151103
PERCENT  EQU   C'%'                    DENOTES AN INDIRECT ADDRESS      00151803
LESS     EQU   C'-'                    DENOTES AN ADDRESS EXPRESSION    00152603
PL1BIT   EQU   X'80'                   PL1 REQUIREMENT                  00153103
LOCATPDE EQU   8                       USED TO LOCATE LAST EXPRESSION   00153603
*                                         VALUE ON CHAIN                00154603
D        EQU   C'D'                    USED TO TEST FOR DOUBLE PRECISON 00155203
LOWD     EQU   X'84'                   LOWER CASE IS VALID ALSO         00155803
E        EQU   C'E'                    USED BY ADDRESS RTN TO CHECK     00156203
*                                         FOR SINGLE PRECISION          00156603
LOWE     EQU   X'85'                   LOWER CASE IS ALSO VALID         00157603
R        EQU   C'R'                    USED TO CHECK FOR GENERAL        00158103
*                                         REGISTER                      00158703
LOWR     EQU   X'99'                   LOWER CASE IS ALSO VALID         00159303
NNN      EQU   C'N'                    DENOTES DECIMAL AS OPPOSED TO    00159903
*                                      HEXADECIMAL EXPRESSION VALUE     00160603
LOWNNN   EQU   X'95'                   LOWER CASE IS VALID ALSO         00161203
HFF      EQU   X'FF'                   USED TO MANIPULATE FLAGS         00161803
IPDLMAXE EQU   10                      MAXIMUM INPUT STACKING DEPTH FOR 00162403
*                                      AN INPUT PUSHDOWN STACK          00163003
ZERO     EQU   0                       USED AS ZERO                     00163603
ONE      EQU   1                       USED AS ONE                      00164203
TWO      EQU   2                       USED AS TWO                      00164803
THREE    EQU   3                       USED AS THREE                    00165403
FOUR     EQU   4                       USED AS FOUR                     00166003
FIVE     EQU   5                       USED AS FIVE                     00166603
SIX      EQU   6                       USED AS SIX                      00167203
SEVEN    EQU   7                       USED AS SEVEN                    00167803
EIGHT    EQU   8                       USED AS EIGHT                    00168303
THIRTY5  EQU   35                      USED AS THIRTY FIVE              00168803
THIRTY6  EQU   36                      USED AS THIRTY SIX               00169503
*                                                                       00170003
DATAPRES EQU   X'80'                   PDE FLAG TO INDICATE DATA THERE  00170603
ADDRDATA EQU   0                       POINTER TO ADDRESS STRING        00171203
ADDRLNTH EQU   4                       POINTER TO ADDRESS LENGTH        00171803
ADDRFLGS EQU   8                       INDICATES TYPE OF EXPRESSION     00172403
*                                      VALUE                            00173003
ADDRSIGN EQU   9                       ARITHMETIC SIGN CHARACTER USED   00173603
ADDRCNT  EQU   10                      NUMBER OF LEVELS OF INDIRECT     00174203
*                                      ADDRESSING                       00174803
ADDRPTR  EQU   12                      POINTER TO NEXT EXPRESSION VALUE 00175403
TINYPDE  EQU   1                       R1(TINYPDE) USED AS A POINTER TO 00176003
*                                      CORE GOTTEN FOR ADDRESS          00176603
*                                      EXPRESSION                       00177203
HEXVALUE EQU   X'02'                   USED BY TO DENOTE                00177803
*                                      A HEXADECIMAL EXPRESSION VALUE   00178403
DECVALUE EQU   X'04'                   USED BY TO DENOTE                00179003
*                                      A DECIMAL EXPRESSION VALUE       00179503
SYMADR   EQU   X'80'                   SYMBOLIC ADDRESS FLAG            00180003
RELADR   EQU   X'40'                   RELATIVE ADDRESS FLAG            00180703
ABSADR   EQU   X'00'                   ABSOLUTE ADDRESS FLAG            00181403
REG      EQU   X'20'                   REGISTER NOTATION FLAG           00182103
DPFPR    EQU   X'10'                   USED TO DENOTE DOUBLE PRECISION  00182803
*                                      FLOATING POINT REGISTER          00183103
SPFPR    EQU   X'08'                   USED TO DENOTE SINGLE PRECISION  00183503
*                                      FLOATING POINT REGISTER          00184203
ENTRYNAM EQU   X'04'                   USED TO DENOTE A NON-QUALIFYING  00184903
*                                      ENTRY NAME (PRECEDED BY AN       00185603
EMPTYFLG EQU   X'02'                   INITIAL SETTING OF DATAFLG       00186303
*                                      NO ADDRESS TYPE YET IDENTIFIED   00187003
*                                      OPTIONAL LOADNAME)               00187303
*                                                                       00187703
*  BIT SETTINGS USED BY TYPETEST FOR SYNTAX CHECKING CHARACTERS         00188403
*                                                                       00189103
HEX      EQU   X'80'                   HEX CHARACTER                    00190003
OLETTER  EQU   X'40'                   LETTER NOT A HEX (G-Z)           00190503
NATL     EQU   X'20'                   NATIONAL CHARACTER               00191003
NUMBER   EQU   X'10'                   NUMBER                           00191503
SEPAR    EQU   X'08'                   SEPARATOR                        00192003
NSEPDLIM EQU   X'04'                   DELIMITER, NOT A SEPARATOR       00193003
NDLIMSPC EQU   X'02'                   SPECIAL CHARACTER, NOT A         00193503
*                                      DELIMITER OR SEPARATOR           00194003
CMDDLIM  EQU   X'01'                   COMMAND NAME DELIMITER           00194603
INVALID  EQU   X'00'                   INVALID CHARACTER                00195203
ALPHA    EQU   HEX+OLETTER+NATL        ALPHABETICS                      00196003
DLIMREQD EQU   SEPAR+NSEPDLIM          AN END OF PARAMETER DELIMITER    00196503
*                                      REQUIRED                         00197003
*                                                                       00197503
         EJECT                                                          00198403
* PERMANENT WORKSPACE FLAGS.                                            00198803
*                                                                       00199203
* P F L A G S                                                           00199903
*                                                                       00200703
PFLIST   EQU   X'80'                   CURRENTLY PROCESSING A LIST      00201103
PFDEFLT  EQU   X'40'                   INDICATES A DEFAULT TAKEN        00201503
PFENDF   EQU   X'20'                   END OF INPUT AREA HAS BEEN       00202303
*                                         REACHED                       00203103
ADREXP   EQU   X'10'                   INDICATE ADDR EXPRESSION   M4789 00203503
HEXBIT   EQU   X'08'                   ADDRESS EXPRESSION CONTAINS      00203903
*                                         A HEX CHARACTER               00204703
PFBYPAS  EQU   X'04'                   BYPASS MODE IS TO BE ESTABLISHED 00205503
PFNEW    EQU   X'02'                   USED BY ADDRESS ROUTINE TO       00205903
*                                         DENOTE A NEW VALID ADDRESS    00206303
*                                         ENTRYNAME (WITH OR WITHOUT    00207103
*                                         LOADNAME QUALIFICATION)       00207903
DECBIT   EQU   X'01'                   ADDRESS EXPRESSION IS DECIMAL    00208303
* P F L A G S 2                                                         00208703
PFSKPINV EQU   X'80'                   VALIDITY CHECK ROUTINE REQUESTED 00209503
*                                         A REENTER MESSAGE ONLY        00210303
RNGEVAL1 EQU   X'40'                   ADDRESS ROUTINE PROCESSED FIRST  00210703
*                                         VALUE OF RANGE PARAMETER      00211103
ONERBIT  EQU   X'20'                   CONTROL BIT USED DURING SCAN     00211903
*                                         BY ADDRESS ROUTINE            00212703
TWORBIT  EQU   X'10'                   CONTROL BIT USED DURING SCAN     00213103
*                                         BY ADDRESS ROUTINE            00213503
RNGEVAL2 EQU   X'08'                   ADDRESS ROUTINE PROCESSED        00214303
*                                         SECOND VALUE OF RANGE         00215103
*                                         PARAMETER                     00215603
*                                                                       00216103
REGBIT   EQU   X'04'                   CONTROL BIT USED DURING SCAN     00216603
*                                         BY ADDRESS ROUTINE            00217203
FLTERBIT EQU   X'02'                   CONTROL BIT USED DURING SCAN     00217803
*                                         BY ADDRESS ROUTINE            00218403
BREAKBIT EQU   X'01'                   USED BY ADDRESS ROUTINE TO       00219003
*                                         DENOTE A BREAK CHARACTER IN   00219603
*                                         PARAMETER                     00220203
* P F L A G S 3                                                         00220803
PFSTPRMT EQU   X'80'                   PROMPT FOR STRING                00221403
PFONE    EQU   X'40'                   INDICATES AT LEAST ONE PDE       00222003
*                                         PDE HAS BEEN BUILT            00222603
LOADBIT  EQU   X'20'                   CONTROL BIT USED BY ADDRESS RTN  00223203
*                                         DENOTING LOADNAME DATA        00223803
ENTRYBIT EQU   X'10'                   CONTROL BIT USED BY ADDRESS RTN  00224403
*                                      DENOTING ENTRYNAME DATA          00225003
PFNULL  EQU   X'08'                    INDICATES A NULL LINE WAS        00225603
*                                        ENTERED AFTER A PROMPT         00226603
LPRNFND  EQU   X'04'                   USED TO INDICATE A LEFT PAREN    00228603
*                                         WAS FOUND BY THE ERROR RTN.   00230603
PFSPACE  EQU   X'02'                   USED TO INDICATE A POSITIONAL    00232603
*                                         SPACE PARAMETER WAS           00233003
*                                         ENCOUNTERED SO THAT THE       00233103
*                                         POSITIONAL STRING ROUTINE     00233203
*                                         KNOWS WHEN TO END THE STRING  00238803
PFMORE   EQU   X'01'                   USED TO INDICATE IF THE LEFT     00240803
*                                         PAREN OF A SUBFIELD WAS       00242803
*                                         ALSO USED AS THE LEFT PAREN   00243203
*                                         OF THE LIST WITHIN THE        00243603
*                                         SUBFIELD                      00244003
* P F L A G S 4                                                         00244103
PFENDLIM EQU   X'80'                   INDICATES END DELIMITER          00244203
*                                         FOR A SELF-DELIMITING STRING  00244303
*                                         HAS BEEN FOUND                00258203
PFLSTEND EQU   X'40'                   INDICATES LIST END DELIMITER     00268203
*                                         HAS BEEN FOUND                00270203
PFVCMSG  EQU   X'20'                   INDICATES A VALIDITY CHECK       00270603
*                                         ROUTINE HAS SUPPLIED A SECOND 00271003
*                                       LEVEL MESSAGE                   00271403
PFPDDATA EQU   X'10'                   INDICATE PROCESSING PROMPT OR    00271803
*                                         DEFAULT DATA                  00271903
PFSLASH  EQU   X'08'                   INDICATE DSNAME/USERID ROUTINE   00272003
*                                         IS SCANNING FOR PASSWORD      00272103
PFENDSET EQU   X'04'                   INDICATES BACKUP POINTER FOR     00276703
*                                         ENDINPUT HAS BEEN SET         00278703
PFNOPOP  EQU   X'02'                   INDICATES STACK IS NOT TO  M0911 00280703
*                                         BE POPPED IF ALL SEPARATORS   00281103
*                                         IN PROMPT BUFFER              00281203
CKRANGE  EQU   X'01'                   ADDR ROUTINE SHOULD CHECK  M4789 00281303
*                                         FOR RANGE                     00281403
* P F L A G S 5                                                         00286003
*                                                                       00336103
PFSQSTR  EQU   X'80'                   SPECIAL QSTRING HANDLING DONE    00346103
*                                      AT LEAST ONCE                    00356103
INVPRMPT EQU   X'40'                   CHECK FOR INVALID MSG PROMPT     00366103
*                                      THIS FLAG IS ALSO USED TO TEST   00376103
*                                      THE PROMPT FLAG IN THE UPT TO    00386103
*                                      INDICATE IF THE USER IS IN       00396103
*                                      NOPROMPT MODE OR NOT             00406103
SUBFLG   EQU   X'20'                   INDICATE A SUBFIELD IS BEING PRO 00416103
*                                      CESSED                           00426103
INVFLG   EQU   X'10'                   INVALID DATA WAS FOUND FOR A     00436103
BYPASFLG EQU   X'08'                   INDICATE BYPASS MODE FOR INVALID 00460003
RPRNFND  EQU   X'04'                   RIGHT PAREN FOUND FLAG           00462003
*                                      USER IN NOPROMPT MODE            00464003
PSWDFLG  EQU   X'02'                   INDICATE PASSWORD IS BEING PRO   00466003
*                                      CESSED                           00468003
DSNFLG   EQU   X'01'                   INDICATE DSNAME IS BEING         00470003
*                                      PROCESSED                        00471003
*                                                                       00472003
* P F L A G S 6                                                         00473003
*                                                                       00474003
ALIASFLG EQU   X'80'                   INDICATE AN ALIAS WAS FOUND      00475003
PSWDQFLG EQU   X'40'                   INDICATE QUOTED PASSWORD         00476003
HEXFLG   EQU   X'20'                   HEXADECIMAL PROCESSING           00477003
DECFLG   EQU   X'10'                   DECIMAL VALUE PROCESSING         00478003
BINFLG   EQU   X'08'                   BINARY INTEGER PROCESSING        00479003
CHARFLG  EQU   X'04'                   CHARACTER STRING PROCESSING      00480003
NUMFLG   EQU   X'02'                   NUMERIR VALUE PROCESSING         00482003
PDEFLG   EQU   X'01'                   CONVERTED HEXADECIMAL VALUE      00484003
*                                                                       00486003
* P F L A G S 7                                                         00490003
*                                                                       00491003
VOLSERF  EQU   X'80'                   INDICATE VOLUME SERIAL PROCESING 00492003
VALENDF  EQU   X'40'                   INDICATE END OF BUFFER NOT       00493003
*                                      REACHED, CHECK DELIMITER         00494003
DSNAMEF  EQU   X'08'                   INDICATE DSNAME PROCESSING       00497003
*                                      DURING VALIDITY CHECKING         00498003
*                                                                       00500003
* P F L A G S 8                                                         00507003
*        RESERVED                                                       00514003
         EJECT                                                          00521003
*********************************************************************** 00522003
**                                                                   ** 00523003
*                                                              Y30NQJN* 00524003
*                  POSITIONAL ADDRESS ROUTINE                         * 00528003
*                                                                     * 00535003
* THE PURPOSE OF THIS ROUTINE IS TO SYNTAX CHECK THE ADDRESS PARAMETER* 00542003
* USED BY SUB-COMMANDS OF TEST                                        * 00550003
* A VALID ADDRESS CAN BE SYMBOLIC, RELATIVE, ABSOLUTE OR A REGISTER   * 00580003
* NAME INCLUDING ANY SPECIFICATION OF ONE OR MORE LEVELS OF INDIRECT  * 00610003
* ADDRESSING OR AN EXPRESSION BUILT OF COMBINATIONS OF SYMBOLIC,      * 00640003
* RELATIVE OR ABSOLUTE ADDRESSES, OR GENERAL REGISTER NAMES FOR WHICH * 00670003
* INDIRECT ADDRESSING IS SPECIFIED, AND PLUS OR MINUS DISPLACEMENT    * 00700003
* VALUES                                                              * 00730003
* SYMBOLIC AND RELATIVE ADDRESSES MAY ADDITIONALLY BE QUALIFIED BY    * 00760003
* '.ENTRYNAME.' OR 'LOADNAME.ENTRYNAME.'  IF NO QUALIFIERS ARE        * 00790003
* SPECIFIED, THE QUALIFICATION IS IMPLICIT                            * 00820003
* '.ENTRYNAME'(OPTIONALLY PRECEDED BY LOADNAME)IS ALSO A VALID ADDRESS* 00850003
*                                                                     * 00900003
*********************************************************************** 00950003
*                                                                       01000003
*/*ADDRESS: P GET PDE SIZE */                                           01001003
ADDRESS  DS    0H                      ADDRESS ROUTINE                  01002003
*                                                                       01003003
         LR    R1,BASE3                 SAVE REGISTER 7                 01004003
         BALR  BASE3,ZERO              ESTABLISH ADDRESSABILITY         01005003
         USING *,BASE3                 ADDRESSABILITY TO ROUTINE        01010003
         MODID BRANCH=YES                                               01015003
*                                                                       01020003
*                                                                       01110003
         USING PWORK,PBASE            ADDRESSABILITY TO WORK AREA       01120003
*                                                                       01130003
         ST    R1,ADDRSAVE+EIGHT       SAVE BASE REGISTER CONTENTS      01140003
         ST    R14,ADDRSAVE+FOUR       SAVE THIS RTN'S BASE REGISTER    01145003
         MVI   DATAEXP,HFF             INSURES THAT EXPRESSION VALUE    01150003
*                                         PDE PTR IS X'FF000000'        01200003
         MVI   DATAFLG,EMPTYFLG        INITIALIZE FLAGS TO 'EMPTY'M5957 01250003
         LA    R1,THIRTY5              GET PDE SIZE-1                   01300003
         STC   R1,PPCOUNT              SAVE                             01350003
*/* S SKIPB: SKIP SEPARATORS */                                         01400003
         L     R15,SKIPBP              GET SKIP SEPARATORS RTN. PTR.    01420003
         BAL   LINK2,LINK2OUT          SKIP BLANKS                      01450003
         B     ADDREPRQ                PROMPT IF NECESSARY              01500003
*                                      (NULL PARAMETER)                 01550003
*/* S LISTT: CHECK FOR LIST */                                          01600003
         L     R15,LISTTP              GET LISTT RTN. PTR.              01620003
         BAL   LINK1,LINK1OUT          PROCESS POSSIBLE LIST            01650003
*/* D (YES,,NO,ILLADDR) LIST IS VALID */                                01700003
         B     TURNOFF                +0 RETURN - INVALID LIST          01750003
         LA    R0,LRPAREN+ONE          GET PTR TO DUMMY LIST     A51300 01800003
         CR    R0,XINPUT               PROCESSING DUMMY LIST?    A51300 01850003
         BE    ADDREPRQ                YES, LIST NULL- GO PROMPT A51300 01900003
         SPACE                                                          01950003
*/*ADDRERSC: P SAVE PTR FOR INVALID MSG */                              02000003
ADDRERSC DS    0H                      * * * *                          02050003
         MVC   INVPSAVE,PPOINTR        SAVE PTR FOR INVALID MSG         02100003
         SPACE                                                          02150003
*/*RANGENTR: P ENTRY FOR SECOND VALUE OF RANGE SCAN */                  02200003
RANGENTR DS    0H                      SPECIAL ENTRY TO SCAN SECOND     02250003
*                                      VALUE OF RANGE ADDRESS           02300003
         MVI   DATAEXP,HFF             IF EXPRESSION FOUND, FIELD       02350003
*                                      WILL BE SET AS POINTER TO 1ST    02400003
*                                      EXPRESSION VALUE PDE             02450003
         L     R14,ADDRSAVE+FOUR       RESTORE BASE REG AFTER RETURN.   02458003
*                                      THIS IS IS NEEDED FOR INVALID    02466003
*                                      ADDRESSES, SINCE BASE REG MUST   02474003
*                                      BE RESTORED UPON RE-ENTRY        02482003
*                                      TO THIS ROUTINE.                 02490003
*/*STARTAGN: P SAVE START OF PARAMETER */                               02500003
STARTAGN DS    0H                      * * * *                          02550003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          02600003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              02650003
         ST    XINPUT,PPOINTR          SAVE START OF PARAMETER          02700003
*/* P ZERO A COUNTER FOR SIZE OF PARAMETER */                           02750003
         XR    COUNTER,COUNTER         A WORK REGISTER TO MAINTAIN      02800003
*                                      A TALLY OF SIZE OF PARAMETER     02850003
*/* P ZERO A COUNTER FOR NUMBER OF LEVELS IN ADDRESS */                 02900003
         XR    LEVELS,LEVELS           A WORK REGISTER TO MAINTAIN      02950003
*                                      A TALLY OF THE NUMBER OF LEVELS  03000003
*                                      OF INDIRECT ADDRESSES            03050003
*/* D (YES,ADDREPLS,NO,) ADDRESS IS RELATIVE TYPE */                    03100003
         CLI   ZERO(XINPUT),RELATIVE   IS RELATIVE SPECIFIED            03150003
         BE    ADDREPLS                YES, GO PROCESS                  03200003
*/* D (YES,,NO,NOENTRNM) ENTRYNAME IS SPECIFIED */                      03250003
         CLI   ZERO(XINPUT),PERIOD     IS ENTRYNAME SPECIFIED           03300003
         BNE   NOENTRNM                NO, BRANCH                       03350003
         SPACE                                                          03400003
*/*ENTRYNM: P INCREMENT SCAN PTR AND SET ENTRYBIT ON */                 03450003
ENTRYNM  DS    0H                      * * * *                          03500003
         LA    R1,ONE(XINPUT)          BEGINNING OF ENTRYNAME IS ONE    03550003
         ST    R1,PPOINTR              BYTE PAST PERIOD                 03600003
         OI    PFLAGS2,ENTRYBIT        WORK BIT INDICATING AN           03650003
*                                      ENTRYNAME IS BEING PROCESSED     03700003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          03750003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              03800003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               03850003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 03900003
         SPACE                                                          03950003
*/*NOENTRNM: D (YES,,NO,REGISTER) FIRST CHARACTER IS LETTER OR NATIONAL 04000003
*/* CHAR */                                                             04050003
NOENTRNM DS    0H                      * * * *                          04100003
         LA    CHECK,HEX+OLETTER+NATL  IS FIRST CHARACTER A LETTER      04150003
*                                         OR NATIONAL CHARACTER         04200003
         L     R15,TYPETSTP            GET SYNTAX CHECKING RTN.         04220003
         BAL   LINK1,LINK1OUT          * * * *                          04250003
         B     REGISTER                NO, BRANCH                       04300003
*/* D (YES,ALPHAMER,NO,) PROCESSING AN ENTRYNAME */                     04350003
         TM    PFLAGS2,ENTRYBIT        PROCESSING AN ENTRYNAME          04400003
         BO    ALPHAMER                YES, BRANCH                      04450003
*/* P TURN ON FLTERBIT */                                               04500003
         OI    PFLAGS2,FLTERBIT        TURN BIT ON                      04550003
         LA    CHECK,HEX               HEX CHARACTER                    04600003
*/* S TYPETEST: CHECK FOR HEX CHARACTER */                              04650003
         L     R15,TYPETSTP            GET SYNTAX CHECKING RTN.         04660003
         BAL   LINK1,LINK1OUT          * * * *                          04670003
*/* D (YES,REGLOOP,NO,) CHARACTER IS HEX */                             04750003
         B     ALPHAMER                NO, BRANCH                       04800003
         B     REGLOOP                 BRANCH                           04850003
         SPACE                                                          04900003
*/*ALPHAMER: S TYPETEST: CHECK FOR ALPHAMERIC OR NATIONAL CHARACTER */  04950003
ALPHAMER DS    0H                      * * * *                          05000003
         LA    CHECK,HEX+OLETTER+NATL+NUMBER  ALPHAMERIC OR NATIONAL    05050003
*                                         CHARACTER                     05100003
         L     R15,TYPETSTP            GET SYNTAX CHECKING RTN.         05110003
         BAL   LINK1,LINK1OUT          * * * *                          05120003
*/* D (YES,,NO,BREAK) CHARACTER IS ALPHAMERIC OR NATIONAL */            05200003
         B     BREAK                   NO, BRANCH                       05250003
         SPACE                                                          05300003
*/*TALLYCT: P INCREMENT NO. OF LEVELS AND INCREMENT SCAN PTR */         05350003
TALLYCT  DS    0H                      * * * *                          05400003
         LA    COUNTER,ONE(COUNTER)    YES, INCREMENT TALLY BY ONE      05450003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          05500003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              05550003
*/* S CHEKCEND: CHECK FOR END OF INPUT */                               05600003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 05650003
*/* D (YES,MAXTEST,NO,) PROCESSING A SYMBOLIC ADDRESS */                05700003
         TM    DATAFLG,SYMADR          DEFINITELY PROCESSING A          05750003
*                                      SYMBOLIC ADDRESS                 05800003
         BO    MAXTEST                 YES, IS IT VALID                 05850003
*/* D (YES,,NO,ALPHAMER) NO. OF LEVELS GREATER THAN 8 */                05900003
         CH    COUNTER,DEC9            ADDRESS TALLY GREATER THAN 8     05950003
         BL    ALPHAMER                NO, BRANCH                       06000003
*/* D (YES,TURNOFF,NO,) PROCESSING ENTRYNAME */                         06050003
         TM    PFLAGS2,ENTRYBIT        IS ENTRYNAME BIT ON              06100003
         BO    TURNOFF                 YES, ERROR                       06150003
*/* P TURN ON SYMBOLIC BIT */                                           06200003
         OI    DATAFLG,SYMADR          MUST BE SYMBOLIC                 06250003
         SPACE                                                          06300003
*/*MAXTEST: D (YES,TURNOFF,NO,ALPHAMER) SIZE OF PARAMETER GREATER THAN  06350003
*/* 31 */                                                               06400003
MAXTEST  DS    0H                      * * * *                          06450003
         CH    COUNTER,DEC32           TALLY GREATER THAN 31            06500003
         BE    TURNOFF                 YES, ERROR                       06550003
         B     ALPHAMER                NO, SCAN NEXT CHARACTER          06600003
         SPACE                                                          06650003
*/*BREAK: D (YES,,NO,DILIMITR) CHARACTER IS BREAK CHARACTER */          06700003
BREAK    DS    0H                      * * * *                          06750003
         CLI   ZERO(XINPUT),BKCHAR     BREAK CHARACTER                  06800003
         BNE   DILIMITR                NO, BRANCH                       06850003
*/* D (YES,TALLYCT,NO,) PROCESSING SYMBOLIC ADDRESS */                  06900003
         TM    DATAFLG,SYMADR          DEFINITELY PROCESSING A          06950003
*                                      SYMBOLIC ADDRESS                 07000003
         BO    TALLYCT                 YES, BRANCH                      07050003
*/* P TURN ON BREAKBIT */                                               07100003
         OI    PFLAGS2,BREAKBIT        TURN BIT ON                      07150003
*/* D (,TALLYCT) BRANCH */                                              07200003
         B     TALLYCT                 AND BRANCH                       07250003
         SPACE                                                          07300003
*/*DILIMITR: D (YES,SPECIAL,NO,) PROCESSING SYMBOLIC ADDRESS */         07350003
DILIMITR DS    0H                      * * * *                          07400003
         TM    DATAFLG,SYMADR          ALREADY PROCESSING A SYMBOLIC    07450003
*                                      ADDRESS                          07500003
         BO    SPECIAL                 YES, BRANCH                      07550003
*/* D (YES,FINDOUT,NO,) VALID DELIMITER FOR LOADNAME OR ENTRYNAME */    07600003
         CLI   ZERO(XINPUT),PERIOD     VALID DELIMITER FOR LOADNAME     07650003
*                                      OR ENTRYNAME                     07700003
         BE    FINDOUT                 YES, BRANCH                      07750003
*/* D (YES,,NO,ASBEFORE) PROCESSING ENTRYNAME */                        07800003
         TM    PFLAGS2,ENTRYBIT        CURRENTLY PROCESSING AN          07850003
*                                      ENTRYNAME                        07900003
         BZ    ASBEFORE                NO, BRANCH                       07950003
*/* P TURN ON BIT DENOTING ENTRYNAME ADDRESS */                         08000003
         OI    PFLAGS,PFNEW            TURN ON BIT DENOTING AN          08050003
*                                      ENTRYNAME ADDRESS                08100003
*/* D (,CHARACBK) BRANCH */                                             08150003
         B     CHARACBK                AND BRANCH                       08200003
*/*ASBEFORE: P TURN FILTER BIT OFF */                                   08250003
ASBEFORE DS    0H                      * * * *                          08300003
         NI    PFLAGS2,HFF-FLTERBIT    TURN FILTER BIT OFF              08350003
*/* P TURN ON BIT FOR SYMBOLIC ADDRESS */                               08400003
         MVI   DATAFLG,SYMADR          DENOTE AS SYMBOLIC ADDRESS       08450003
*/* D (,SPECIAL) BRANCH */                                              08500003
         B     SPECIAL                 AND BRANCH                       08550003
         SPACE                                                          08600003
*/*FINDOUT: D (YES,CHARACBK,NO,) PROCESSING ENTRYNAME */                08650003
FINDOUT  DS    0H                      * * * *                          08700003
         TM    PFLAGS2,ENTRYBIT        PROCESSING AN ENTRYNAME          08750003
         BO    CHARACBK                YES, BRANCH                      08800003
         SPACE                                                          08850003
*/*LOADPARM: P TURN ON LOADNAME BIT */                                  08900003
LOADPARM DS    0H                      * * * *                          08950003
         OI    PFLAGS2,LOADBIT         INDICATE LOADNAME DATA TO BE     09000003
*                                      MOVED                            09050003
*/* S MOVEIN: PREPARE TO MOVE DATA INTO PDE */                          09100003
         BAL   LINK2,MOVEIN            BRANCH TO SECTION TO PREPARE     09150003
*                                      TO MOVE DATA INTO PDE            09200003
*/* D (YES,TURNOFF,NO,) LOADNAME PREVIOUSLY SCANNED */                  09250003
         TM    DATAFLA1,PL1BIT         WAS A LOADNAME PREVIOUSLY        09300003
*                                      SCANNED                          09350003
         BO    TURNOFF                 YES, BRANCH                      09400003
*/* P TURN OFF LOADNAME CONTROL BIT */                                  09450003
         NI    PFLAGS2,HFF-LOADBIT     TURN OFF LOADNAME CONTROL BIT    09500003
*/* P MOVE DATA INTO PDE */                                             09550003
         MVC   DATAPTR1+ONE(L'DATAPTR1-ONE),PPOINTR+ONE                 09600003
*                                      MOVE LOADNAME PTR INTO PDE       09650003
         MVC   DATALEN1,PLENGTH        MOVE DATA LENGTH                 09700003
         OI    DATAFLA1,PL1BIT         TURN ON PL1 BIT                  09750003
         LA    XINPUT,ONE(,XINPUT)     INCREMENT SCAN REGISTER          09800003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              09850003
*/* P ZERO SIZE OF PARAMETER */                                         09900003
         XR    COUNTER,COUNTER         CLEAR TALLY REGISTER             09950003
*/* D (,ENTRYNM) PROCESS ENTRYNAME */                                   10000003
         B     ENTRYNM                 GO PROCESS ENTRYNAME             10050003
         SPACE                                                          10100003
*/*CHARACBK: D (YES,TURNOFF,NO,) BREAKBIT IS ON */                      10150003
CHARACBK DS    0H                      * * * *                          10200003
         TM    PFLAGS2,BREAKBIT        IS BREAK CHARACTER BIT ON        10250003
         BO    TURNOFF                 YES, ERROR                       10300003
*/* S MOVEIN: PREPARE TO MOVE DATA INTO PDE */                          10350003
         BAL   LINK2,MOVEIN            MOVE SCANNED DATA INTO PDE       10400003
*/* D (YES,TURNOFF,NO,) ENTRYNAME WAS PREVIOUSLY SCANNED */             10450003
         TM    DATAFLA2,PL1BIT         WAS AN ENTRYNAME PREVIOUSLY      10500003
*                                      SCANNED                          10550003
         BO    TURNOFF                 YES, ERROR, BRANCH               10600003
*/* P TURN ENTRYNAME CONTROL BIT OFF */                                 10650003
         NI    PFLAGS2,HFF-ENTRYBIT    TURN CONTROL BIT OFF             10700003
*/* P MOVE ENTRYNAME DATA INTO PDE */                                   10750003
         MVC   DATAPTR2+ONE(L'DATAPTR2-ONE),PPOINTR+ONE                 10800003
*                                      MOVE ENTRYNAME DATA INTO PDE     10850003
         MVC   DATALEN2,PLENGTH        MOVE DATA LENGTH                 10900003
*/* P TURN ON PL1 BIT */                                                10950003
         OI    DATAFLA2,PL1BIT         TURN ON PL1 BIT                  11000003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REG               11050003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              11100003
*/* D (YES,RANGECK,NO,) SCANNING ENTRYNAME ADDRESS */                   11150003
         TM    PFLAGS,PFNEW            SCANNING AN ENTRYNAME ADDRESS    11200003
         BO    RANGECK                 YES, GO SCAN FOR VALID DELIMITER 11250003
         LA    XINPUT,ONE(XINPUT)      TEMPORARILY INCREMENT SCAN       11300003
*                                      REGISTER                         11350003
*                                      SINCE SYMBOLIC AND RELATIVE      11400003
*                                      ARE THE ONLY ADDRESSES WHICH MAY 11450003
*                                      BE QUALIFIED, THE PERIOD         11500003
*                                      FOLLOWING ENTRYNAME MUST BE      11550003
*                                      FOLLOWED BY EITHER A PLUS(+)     11600003
*                                      SIGN FOR RELATIVE OR A LETTER    11650003
*                                      FOR SYMBOLIC                     11700003
*/* D (YES,REGRESET,NO,) PERIOD FOLLOWED BY A PLUS (+) */               11750003
         CLI   ZERO(XINPUT),RELATIVE   PERIOD FOLLOWED BY A PLUS(+)     11800003
         BE    REGRESET                YES, BRANCH                      11850003
*/* S TYPETEST: CHARACTER IS LETTER OR NATIONAL CHAR */                 11900003
         LA    CHECK,HEX+OLETTER+NATL  FOLLOWED A LETTER OR NATIONAL    11950003
*                                         CHARACTER                     12000003
         L     R15,TYPETSTP            GET SYNTAX CHECKING PTR          12020003
         BAL   LINK1,LINK1OUT          * * * *                          12050003
*/* D (YES,,NO,TURNOFF) VALID CHARACTER */                              12100003
         B     TURNOFF                 + 0 RETURN - NO, ERROR CONDITION 12150003
         SPACE                                                          12200003
*/*REGRESET: D (,STARTAGN) BRANCH TO BEGIN SCAN */                      12250003
REGRESET DS    0H                      * * * *                          12300003
         BCT   XINPUT,STARTAGN         + 4 RETURN - YES, RESTORE SCAN   12350003
*                                      REGISTER TO LAST CHARACTER       12400003
*                                      SCANNED AND BRANCH               12450003
         SPACE                                                          12500003
*/*ADDREPLS: P INDICATE RELATIVE ADDRESS */                             12550003
ADDREPLS DS    0H                      * * * *                          12600003
         MVI   DATAFLG,RELADR          INDICATE RELATIVE ADDRESS        12650003
         LA    R1,ONE(XINPUT)          BEGINNING OF RELATIVE ADDRESS    12700003
         ST    R1,PPOINTR              IS ONE BYTE PAST + SIGN          12750003
         SPACE                                                          12800003
*/*BUMPCTR: P INCREMENT SCAN POINTER */                                 12850003
BUMPCTR  DS    0H                      * * * *                          12900003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          12950003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              13000003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               13050003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 13100003
*/* S TYPETEST: CHECK FOR HEXADECIMAL CHARACTER */                      13150003
         LA    CHECK,HEX+NUMBER        HEXADECIMAL CHARACTER            13200003
         L     R15,TYPETSTP            GET SYNTAX CHECKING RTN PTR      13220003
         BAL   LINK1,LINK1OUT          * * * *                          13250003
*/* D (YES,,NO,SPECIAL) HEX CHARACTER */                                13300003
         B     SPECIAL                 NO, BRANCH                       13350003
*/* P INCREMENT COUNTER FOR SIZE OF PARAMETER */                        13400003
         LA    COUNTER,ONE(COUNTER)    YES, INCREMENT TALLY BY ONE      13450003
*/* D (YES,TURNOFF,NO,) SIZE IS GREATER THAN 6 */                       13500003
         CH    COUNTER,DEC7            DOES TALLY EQUAL SEVEN           13550003
         BE    TURNOFF                 YES, ERROR, MAXIMUM IS 6         13600003
*/* D (YES,TURNOFF,NO,) HEX CHARACTER FOLLOWS PERCENT SIGN */           13650003
         LTR   LEVELS,LEVELS           IF R3(LEVELS)NOT ZERO, THEN      13700003
         BNZ   TURNOFF                 HEXADECIMAL CHARACTER FOLLOWS    13750003
*                                      THE PERCENT SIGN                 13800003
*                                      AND CONSTITUTES AN ERROR         13850003
*/* D (YES,TURNOFF,NO,BUMPCTR) PROCESSING ABSOLUTE ADDRESS */           13900003
         CLI   DATAFLG,ABSADR          PROCESSING AN ABSOLUTE ADDRESS   13950003
*                                                                 M5957 14000003
         BE    TURNOFF                 YES, ERROR, HEXADECIMAL    M5957 14050003
*                                      CHARACTER FOLLOWS DELIMITER      14100003
         B     BUMPCTR                 NO, BRANCH                       14150003
         SPACE                                                          14200003
*/*SPECIAL: D (YES,TURNOFF,NO,) ENTRYBIT IS ON */                       14250003
SPECIAL  DS    0H                      * * * *                          14300003
         TM    PFLAGS2,ENTRYBIT        IF 'ENTRYBIT' IS ON WHEN TESTING 14350003
         BO    TURNOFF                 FOR LEVELS OF INDIRECT           14400003
*                                      ADDRESSING, THE ADDRESS IS NOT   14450003
*                                      VALID                            14500003
*/* D (YES,,NO,GOMOVE) INDIRECT ADDRESSING */                           14550003
         CLI   ZERO(XINPUT),PERCENT    TEST FOR INDIRECT ADDRESSING     14600003
         BNE   GOMOVE                  NO, BRANCH                       14650003
         SPACE                                                          14700003
*/*GENLOOP: P INCREMENT NO. OF LEVELS FOR INDIRECT ADDRESS */           14750003
GENLOOP  DS    0H                      * * * *                          14800003
         LA    LEVELS,ONE(LEVELS)      INCREMENT TALLY OF LEVELS OF     14850003
*                                      INDIRECT ADDRESSES               14900003
*/* D (YES,TURNOFF,NO,BUMPCTR) LEVELS EQUALS 256 */                     14950003
         CH    LEVELS,TWO56            DOES TALLY EQUAL 256             15000003
         BL    BUMPCTR                 NO, CONTINUE SCANNING            15050003
         B     TURNOFF                 YES, ERROR, MAXIMUM IS 255       15100003
         SPACE                                                          15150003
*/*GOMOVE: D (YES,TURNOFF,NO,) LENGTH OF ADDRESS IS ZERO */             15200003
GOMOVE   DS    0H                      * * * *                          15250003
         LTR   COUNTER,COUNTER         IS LENGTH OF ADDRESS ZERO        15300003
         BZ    TURNOFF                 YES, BRANCH, ERROR CONDITION     15350003
*/* S MOVEIN: PREPARE TO MOVE ADDRESS INTO TEMPORARY PDE */             15400003
         BAL   LINK2,MOVEIN            MOVE SCANNED PORTION OF ADDRESS  15450003
*                                      INTO TEMPORARY PDE               15500003
*/* D (YES,EXPRESS,NO,RANGECK) ADDRESS EXPRESSION SPECIFIED */          15550003
         CLI   ZERO(XINPUT),MORE       TEST FOR ADDRESS EXPRESSION      15600003
         BE    EXPRESS                 DENOTED BY A PLUS                15650003
         CLI   ZERO(XINPUT),LESS       OR A MINUS                       15700003
         BNE   RANGECK                 IF NOT, BRANCH                   15750003
         SPACE                                                          15800003
*/*EXPRESS: P MOVE SIGN OF EXPRESSION VALUE TO PDE */                   15850003
EXPRESS  DS    0H                      * * * *                          15900003
         MVC   DATASGN(L'DATASGN),ZERO(XINPUT)                          15950003
*                                      MOVE SIGN OF EXPRESSION VALUE    16000003
*                                      TO PDE                           16050003
*/*RECYCLE: P ZERO SIZE OF PARAMETER AND NUMBER OF LEVELS COUNTERS */   16100003
RECYCLE  DS    0H                      * * * *                          16150003
         XR    COUNTER,COUNTER         A WORK REGISTER TO MAINTAIN A    16200003
*                                      TALLY OF SIZE OF EXPRESSION      16250003
         XR    LEVELS,LEVELS           A WORK REGISTER TO MAINTAIN A    16300003
*                                      TALLY OF THE NUMBER OF LEVELS    16350003
*                                      OF INDIRECT ADDRESSES            16400003
         LA    R1,ONE(XINPUT)          START OF EXPRESSION IS ONE BYTE  16450003
         ST    R1,PPOINTR              PAST PLUS(MINUS)SIGN             16500003
*/* P INDICATE ADDRESS EXPRESSION */                                    16550003
         OI    PFLAGS,ADREXP           INDICATE ADDR EXPRESSION   M4789 16600003
         SPACE                                                          16650003
*/*UPDATE: P INCREMENT SCAN POINTER */                                  16700003
UPDATE   DS    0H                      * * * *                          16750003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          16800003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              16850003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               16900003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 16950003
         SPACE                                                          17000003
         LA    CHECK,HEX               HEX CHARACTER                    17050003
*/* S TYPETEST: CHECK FOR HEX CHARACTER */                              17100003
         L     R15,TYPETSTP            GET SYNTAX CHECKIN RTN. PTR      17120003
         BAL   LINK1,LINK1OUT          * * * *                          17150003
*/* D (YES,,NO,DECIMAL) CHARACTER IS HEX */                             17200003
         B     DECIMAL                 NO, BRANCH                       17250003
*/* P TURN ON HEX BIT */                                                17300003
         OI    PFLAGS,HEXBIT           INDICATE HEX CHARACTER           17350003
*/* D (YES,TURNOFF,NO,RAISECTR) HEX CHARACTER IN DECIMAL EXPRESSION */  17400003
         TM    PFLAGS,DECBIT           HEX CHARACTER IN DECIMAL         17450003
*                                       EXPRESSION                      17500003
         BO    TURNOFF                 YES,BRANCH                       17550003
         B     RAISECTR                * * * *                          17600003
         SPACE                                                          17650003
*/*DECIMAL: S TYPETEST: CHECK FOR NUMERIC CHARACTER */                  17700003
DECIMAL  DS    0H                      * * * *                          17750003
         LA    CHECK,NUMBER            A NUMERIC CHARACTER              17800003
         L     R15,TYPETSTP            GET SYNTAX CHECKING RTN. PTR     17820003
         BAL   LINK1,LINK1OUT          * * * *                          17850003
*/* D (YES,,NO,NTEST) NUMERIC CHARACTER */                              17900003
         B     NTEST                   NO, BRANCH                       17950003
         SPACE                                                          18000003
*/*RAISECTR: P INCREMENT SIZE OF EXPRESSION */                          18050003
RAISECTR DS    0H                      * * * *                          18100003
         LA    COUNTER,ONE(COUNTER)    INCREMENT TALLY BY ONE           18150003
*/* D (YES,TURNOFF,NO,UPDATE) EXPRESSION EXCEEDS SIX DIGITS */          18200003
         CH    COUNTER,DEC7            DOES EXPRESSION EXCEED SIX       18250003
*                                      DIGITS (MAXIMUM)                 18300003
         BE    TURNOFF                 YES, BRANCH                      18350003
         B     UPDATE                  OTHERWISE, SCAN NEXT CHARACTER   18400003
         SPACE                                                          18450003
*/*NTEST: D (YES,TURNOFF,NO,) SIZE OF EXPRESSION IS ZERO */             18500003
NTEST    DS    0H                      * * * *                          18550003
         LTR   COUNTER,COUNTER         IF R2(COUNTER)IS ZERO, THEN      18600003
         BZ    TURNOFF                 ADDRESS EXPRESSION IS INVALID    18650003
*/* D (YES,HEXBITT,NO,) DECIMAL EXPRESSION SPECIFIED */                 18700003
         CLI   ZERO(XINPUT),NNN        IS THIS A DECIMAL EXPRESSION     18750003
         BE    HEXBITT                 YES, BRANCH                      18800003
         CLI   ZERO(XINPUT),LOWNNN     LOW 'N' IS VALID                 18850003
         BE    HEXBITT                 * * * *                          18900003
*/* D (YES,PERCENTT,NO,) COMPLETED SCAN FOR DECIMAL EXPRESSION */       18950003
         TM    PFLAGS,DECBIT           COMPLETED SCAN FOR DECIMAL       19000003
*                                      EXPRESSION                       19050003
         BO    PERCENTT                YES, BRANCH                      19100003
*/* P INDICATE HEXADECIMAL VALUE */                                     19150003
         OI    PFLAGS,HEXBIT           DENTOE AS HEXADECIMAL VALUE      19200003
*/* D (,PERCENTT) CHECK FOR LEVELS OF INDIRECT ADDRESSING */            19250003
         B     PERCENTT                BRANCH AND CHECK FOR LEVELS OF   19300003
*                                      INDIRECT ADDRESSING              19350003
         SPACE                                                          19400003
*/*HEXBITT: D (YES,TURNOFF,NO,) DECIMAL EXPRESSION CONTAINS HEX CHAR */ 19450003
HEXBITT  DS    0H                      * * * *                          19500003
         TM    PFLAGS,HEXBIT           DOES DECIMAL EXPRESSION CONTAIN  19550003
*                                      A HEX CHARACTER                  19600003
         BO    TURNOFF                 YES EXIT --- BRANCH              19650003
         SPACE                                                          19700003
*/* D (YES,TURNOFF,NO,) DECIMAL EXPRESSION ALREADY SPECIFIED */         19750003
         TM    PFLAGS,DECBIT           DECIMAL ADDRESS EXPRESSION       19800003
*                                      ALREADY SPECIFIED                19850003
         BO    TURNOFF                 YES, ERROR, BRANCH               19900003
*/* P INDICATE DECIMAL EXPRESSION */                                    19950003
         OI    PFLAGS,DECBIT           DENOTE AS DECIMAL ADDRESS        20000003
*                                      EXPRESSION                       20050003
*/* D (,UPDATE) SCAN NEXT CHARACTER */                                  20100003
         B     UPDATE                  AND SCAN NEXT CHARACTER          20150003
         SPACE                                                          20200003
*/*PERCENTT: D (YES,,NO,ENDPDE) EXPRESSION HAS LEVELS OF INDIRECT       20250003
*/*ADDRESSING */                                                        20300003
PERCENTT DS    0H                      * * * *                          20350003
         CLI   ZERO(XINPUT),PERCENT    DOES EXPRESSION CONTAIN LEVELS   20400003
*                                      OF INDIRECT ADDRESSING           20450003
         BNE   ENDPDE                  NO, BRANCH                       20500003
*/* P INCREMENT NO. OF LEVELS OF INDIRECT ADDRESSING */                 20550003
         LA    LEVELS,ONE(LEVELS)      INCREMENT TALLY OF LEVELS OF     20600003
*                                      INDIRECT ADDRESSES               20650003
*/* D (YES,TURNOFF,NO,) LEVELS EQUALS 256 */                            20700003
         CH    LEVELS,TWO56            DOES TALLY EQUAL 256             20750003
         BNL   TURNOFF                 YES, ERROR, MAXIMUM IS 255       20800003
*/* P INCREMENT SCAN POINTER */                                         20850003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN POINTER           20900003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              20950003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               21000003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 21050003
*/* D (,PERCENTT) LOOK FOR ANOTHER LEVEL */                             21100003
         B     PERCENTT                CHECK FOR ANOTHER LEVEL          21150003
         SPACE                                                          21200003
*/*ENDPDE: P INDICATE ADDR EXPRESSION COMPLETE */                       21250003
ENDPDE   DS    0H                      * * * *                          21300003
         NI    PFLAGS,HFF-ADREXP       ADDR EXPRESSION COMPLETE   M4789 21350003
         L     TINYPDE,SPLNGTH         SPECIFY SUBPOOL AND AMOUNT OF    21400003
*                                      CORE NEEDED FOR EXPRESSION VALUE 21450003
*                                      PDE AND CLEAR IT                 21500003
*/* S STALOC: GET CORE NEEDED FOR EXPRESSION VALUE PDE */               21550003
         L     R15,STALOCP             GET STORAGE ALLOCATION RTN.      21570003
         BAL   LINK2,LINK2OUT          * * * *                          21600003
*/* P DENOTE AS LAST IN CHAIN */                                        21650003
         MVI   ADDRPTR(TINYPDE),HFF    DENOTE AS LAST IN CHAIN          21700003
*/* D (YES,,NO,SEARCH) JUST SCANNED FIRST EXPRESSION */                 21750003
         CLI   DATAEXP,HFF             JUST SCANNED FIRST EXPRESSION    21800003
         BNE   SEARCH                  NO, BRANCH                       21850003
*/* P SET PTR TO FIRST EXPRESSION VALUE PDE */                          21900003
         ST    TINYPDE,DATAEXP         INITIALIZE POINTER TO 1ST        21950003
*                                      EXPRESSION VALUE PDE             22000003
*/* D (,TRANSLAT) BRANCH */                                             22050003
         B     TRANSLAT                AND BRANCH                       22100003
         SPACE                                                          22150003
*/*SEARCH: P GET PTR TO FIRST EXP VALUE PDE FROM ORIGINAL PDE */        22200003
SEARCH   DS    0H                      * * * *                          22250003
         L     LOCATPDE,DATAEXP        OBTAIN PTR TO FIRST EXPRESSION   22300003
*                                      VALUE PDE FROM ORIGINAL PDE      22350003
*/* D (YES,LASTPTR,NO,) LAST PDE IN CHAIN */                            22400003
         CLI   ADDRPTR(LOCATPDE),HFF   LAST PDE IN CHAIN                22450003
         BE    LASTPTR                 YES, BRANCH                      22500003
         SPACE                                                          22550003
*/*CYCLE: P GET PTR TO NEXT PDE */                                      22600003
CYCLE    DS    0H                      * * * *                          22650003
         L     LOCATPDE,ADDRPTR(LOCATPDE)                               22700003
*                                      LOCATE POINTER TO NEXT PDE       22750003
*/* D (YES,,NO,CYCLE) LAST PDE IN CHAIN */                              22800003
         CLI   ADDRPTR(LOCATPDE),HFF   LAST                             22850003
         BNE   CYCLE                   NO, BRANCH                       22900003
         SPACE                                                          22950003
*/*LASTPTR: P STORE PTR TO NEWEST PDE */                                23000003
LASTPTR  DS    0H                      * * * *                          23050003
         ST    TINYPDE,ADDRPTR(LOCATPDE)                                23100003
*                                      STORE PTR TO NEWEST PDE          23150003
         SPACE                                                          23200003
*/*TRANSLAT: P COMPUTE LENGTH OF ADDRESS */                             23250003
TRANSLAT DS    0H                      * * * *                          23300003
         BCTR  XINPUT,ZERO             BACKUP SCAN AGAIN                23350003
         S     XINPUTB,PPOINTR         COMPUTE LENGTH OF ADDRESS        23400003
         SR    XINPUTB,LEVELS          EXPRESSION(EXCLUDING LEVELS OF   23450003
*                                      INDIRECT ADDRESSING, IF NONE     23500003
*                                      R3(LEVELS)WILL CONTAIN ZEROS)    23550003
         TM    PFLAGS,DECBIT           PROCESSING A DECIMAL EXPRESSION  23600003
*                                      VALUE                            23650003
         BZ    ASITWAS                 NO, BRANCH                       23700003
         BCTR  XINPUTB,ZERO            SUBTRACT ONE TO EXCLUDE THE      23750003
*                                      CHARACTER 'N' FROM THE LENGTH    23800003
*                                      OF THE DECIMAL EXPRESSION VALUE  23850003
         SPACE                                                          23900003
*/*ASITWAS: P STORE DATA LENGTH */                                      23950003
ASITWAS  DS    0H                      * * * *                          24000003
         STH   XINPUTB,PLENGTH         STORE DATA LENGTH                24050003
         ST    TINYPDE,TEMPSAVE        TO TEMPORARILY STORE R1(TINYPDE) 24100003
*                                      BEFORE LINKING TO TRANSQ         24150003
         L     R15,TRANSQP             GET ADDRESS OF TRANSLATE         24200003
*                                         ROUTINE                       24250003
*/* P TRANSLATE TO UPPER CASE */                                        24300003
         BAL   LINK1,LINK1OUT          TRANSLATE TO UPPER CASE          24350003
         L     TINYPDE,TEMPSAVE        RELOAD R1(TINYPDE)               24400003
*/* P STORE DATA IN PDE */                                              24450003
         MVC   ADDRDATA+ONE(THREE,TINYPDE),PPOINTR+ONE                  24500003
*                                       MOVE PTR TO ADDRESS STRING      24550003
         MVC   ADDRLNTH(TWO,TINYPDE),PLENGTH                            24600003
*                                      MOVE LENGTH OF ADDRESS STRING    24650003
*                                      TO PDE                           24700003
         STH   LEVELS,ADDRCNT(TINYPDE) STORE NUMBER OF LEVELS OF        24750003
*                                      INDIRECT ADDRESSING.  IF NONE,   24800003
*                                      THEN R3(LEVELS)WILL BE ZERO      24850003
*                                                                 M4789 24900003
*/* D (YES,,NO,NODESIM) HEX EXPRESSION VALUE */                         24950003
         TM    PFLAGS,DECBIT           HEXIDECIMAL EXPRESSION VALUE     25000003
         BZ    NODESIM                 NO, BRANCH                 M4789 25050003
*/* P TURN OFF DECBIT */                                                25100003
         NI    PFLAGS,HFF-DECBIT       TURN BIT OFF               M4789 25150003
*/* P INDICATE HEX EXPRESSION IN PDE */                                 25200003
         OI    ADDRFLGS(TINYPDE),DECVALUE                         M4789 25250003
*                                      DENOTES A HEXIDECIMAL EXPRESSION 25300003
*/* D (,WHATNEXT) BRANCH */                                             25350003
         B     WHATNEXT                * * * *                          25400003
         SPACE                                                          25450003
*/*NODESIM: P TURN OFF HEX BIT */                                       25500003
NODESIM  DS    0H                      * * * *                          25550003
         NI    PFLAGS,HFF-HEXBIT       TURN BIT OFF               M4789 25600003
*/* P INDICATE DEC EXPRESSION IN PDE */                                 25650003
         OI    ADDRFLGS(TINYPDE),HEXVALUE                         M4789 25700003
*                                      DENOTES A DECIMAL EXPRESSION     25750003
         SPACE                                                          25800003
*/*WHATNEXT: P INCREMENT SCAN POINTER */                                25850003
WHATNEXT DS    0H                      * * * *                          25900003
         LA    XINPUT,ONE(,XINPUT)     INCREMENT SCAN REGISTER          25950003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              26000003
*/* P CHECK FOR RANGE ON ENDINPUT TEST */                               26050003
         OI    PFLAGS4,CKRANGE         CHECK FOR RNGE ON ENDINPUT M4789 26100003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               26150003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 26200003
*/* P TURN OFF BIT FOR RANGE CHECK */                                   26250003
         NI    PFLAGS4,HFF-CKRANGE     ENDINPUT NOT FOUND         M4789 26300003
*/* D (YES,ADDEXP,NO,RANGECK) ANOTHER RELATIVE EXP */                   26350003
         CLI   ZERO(XINPUT),MORE       TEST FOR ANOTHER EXPRESSION (+)  26400003
         BE    ADDEXP                  YES, BRANCH                      26450003
         CLI   ZERO(XINPUT),LESS       (-)                              26500003
         BNE   RANGECK                 NO, BRANCH                       26550003
         SPACE                                                          26600003
*/*ADDEXP: P MOVE SIGN OF NEXT EXP VALUE INTO PDE OF PREVIOUS EXP */    26650003
ADDEXP   DS    0H                      * * * *                          26700003
         MVC   ADDRSIGN(ONE,TINYPDE),ZERO(XINPUT)                       26750003
*                                      MOVE SIGN OF NEXT EXPRESSION     26800003
*                                      VALUE INTO PDE OF PREVIOUS       26850003
*                                      EXPRESSION                       26900003
*/* D (,RECYCLE) BRANCH */                                              26950003
         B     RECYCLE                 * * * *                          27000003
         SPACE                                                          27050003
*/*RANGECK: P TURN OFF BIT FOR RANGE CHECK */                           27100003
RANGECK  DS    0H                      * * * *                          27150003
         NI    PFLAGS4,HFF-CKRANGE     ENDINPUT HAS BEEN FOUND    M4789 27200003
*/* S RANGE: CHECK FOR POSSIBLE RANGE */                                27250003
         L     R15,RANGEP              GET SYNTAX CHECKER PTR.          27270003
         BAL   LINK1,LINK1OUT          PROCESS POSSIBLE RANGE           27300003
*/* D (YES,EXITPREP,NO,) RANGE SPECIFIED */                             27350003
         B     ENDBUFFR                NO, BRANCH                       27400003
         B     EXITPREP                YES, FIRST VALUE OF RANGE        27450003
*                                      PARAMETER DETECTED               27500003
*/*ENDBUFFR: D (YES,,NO,NOTEND) REACHED END OF INPUT */                 27550003
ENDBUFFR DS    0H                      * * * *                          27600003
         C     XINPUT,ENDINPUT         END OF BUFFER                    27650003
*                                      AN END OF BUFFER CONDITION IS    27700003
*                                      CONSIDERED EQUIVALENT TO A       27750003
*                                      VALID DELIMITER                  27800003
         BL    NOTEND                  NO, CONTINUE                     27850003
         SPACE                                                          27900003
*/* P SET END OF FILE INDICATOR */                                      27950003
         OI    PFLAGS,PFENDF           YES, SET END-OF-FILE INDICATOR   28000003
*                                         SO CURRENT STATUS OF SCAN     28050003
*                                         WILL NOT BE SAVED BEFORE      28100003
*                                         PROMPT                        28150003
*/* D (,EXITPREP) BRANCH TO ADDRESS EXIT */                             28200003
         B     EXITPREP                BRANCH TO ADDRESS EXIT           28250003
         SPACE                                                          28300003
*/*NOTEND: S TYPETEST: CHECK FOR DELIMITER CHARACTER */                 28350003
NOTEND   DS    0H                      * * * *                          28400003
         SPACE                                                          28450003
         LA    CHECK,DLIMREQD          DELIMITER CHARACTER        M3098 28500003
         L     R15,TYPETSTP            GET SYNTAX CHECKER PTR.          28520003
         BAL   LINK1,LINK1OUT          * * * *                          28550003
         SPACE                                                          28600003
*/* D (YES,EXITPREP,NO,PAREN) VALID DELIMITER */                        28650003
         B     PAREN                   +0 RETURN - NON-DELIMITER        28700003
         SPACE                                                          28750003
         B     EXITPREP                +4 RETURN - DELIMITER            28800003
         SPACE                                                          28850003
*/*PAREN: D (YES,,NO,TURNOFF) DELIMITER FOR LIST */                     28900003
PAREN    DS    0H                      * * * *                          28950003
         CLI   ZERO(XINPUT),RIGHTPRN   LIST DELIMITER                   29000003
         BE    EXITPREP                 NO, BRANCH(NO REMAINING VALID   29050003
*                                      DELIMITER)                Y02666 29100003
*                                                                YM4738 29104003
         LA    R1,ONE(XINPUT)          GET NEXT CHARACTER PTR.   Y02666 29108003
         C     R1,ENDINPUT             PAST END OF BUFFER?       Y02666 29116003
         BC    CC10,TURNOFF            YES, INVALID CHARACTER     M4540 29124000
         CLC   ZERO(TWO,XINPUT),SLASHAST  COMMENT DELIMITER?     Y02666 29132003
         BNE   TURNOFF                 NO, INVALID CHARACTER     Y02666 29140003
*/*EXITPREP: D (YES,,NO,NORANGE) COMPLETED SCAN FOR FIRST VALUE OF      29150003
*/*RANGE */                                                             29200003
EXITPREP DS    0H                      * * * *                          29250003
         TM    PFLAGS2,RNGEVAL1        JUST COMPLETED SCAN FOR FIRST    29300003
*                                      VALUE OF RANGE PARAMETER         29350003
         BZ    NORANGE                 NO, BRANCH AND EXIT              29400003
*/* P POINT TO BEGINNING OF SECOND VALUE OF RANGE */                    29450003
         LA    LINK2,RANGENTR          INITILAIZE LINK2(R8) TO POINT    29500003
*                                      TO BEGINNING OF SCAN OF SECOND   29550003
*                                      VALUE OF RANGE ADDRESS           29600003
         SPACE                                                          29650003
*/*NORANGE: D (YES,,NO,ADREXIT) ENTRYNAME ADDRESS BIT ON */             29700003
NORANGE  DS    0H                      * * * *                          29750003
         TM    PFLAGS,PFNEW            ENTRYNAME ADDRESS CONTROL BIT ON 29800003
         BZ    ADREXIT                 NO, BRANCH                       29850003
*/* P TURN BIT OFF */                                                   29900003
         NI    PFLAGS,HFF-PFNEW        TURN BIT OFF                     29950003
*/* D (YES,,NO,ADREXIT) PROCESSING A NON-QUALIFYING ENTRYNAME */        30000003
         TM    DATAFLA3,PL1BIT         PROCESSING A NON-QUALIFYING      30050003
*                                      ENTRYNAME                        30100003
         BO    ADREXIT                 NO, BRANCH                       30150003
*/* P INDICATE AS NON-QUALIFYING ENTRYNAME */                           30200003
         MVI   DATAFLG,ENTRYNAM        DENOTE AS NON-QUALIFYING         30250003
*                                      ENTRYNAME(OPTIONALLY PRECEDED    30300003
*                                      BY LOADNAME)                     30350003
*/*ADREXIT: P DECREMENT INPUT POINTER FOR EXIT */                       30400003
ADREXIT  DS    0H                      * * * *                          30450003
         BCTR  XINPUT,ZERO             DECREMENT INPUT POINTER FOR      30500003
*                                         NORMAL EXIT                   30550003
         SPACE                                                          30600003
*/*ADREXIT1: P MOVE 9 WORDS OF DATA TO PDE */                           30650003
ADREXIT1 DS    0H                      * * * *                          30700003
         LA    R1,THIRTY5              HAVE EXIT ROUTINE MOVE 9 WORDS   30750003
*                                         OF DATA TO PDE                30800003
*/* D (,POSITX) EXIT */                                                 30850003
         L     R15,POSITXP             GET EXIT RTN PTR                 30870003
         B     LINK2OUT                EXIT                             30900003
         SPACE                                                          30950003
*/*REGISTER: D (YES,TURNOFF,NO,) REGISTER ADDRESS PRECEDED BY A         31000003
*/*QUALIFIER */                                                         31050003
REGISTER DS    0H                      * * * *                          31100003
         TM    PFLAGS2,ENTRYBIT        A REGISTER ADDRESS PRECEDED      31150003
         BO    TURNOFF                 BY A QUALIFIER IS INVALID        31200003
         TM    DATAFLA2,PL1BIT         THESE INSTRUCTIONS WILL DETECT   31250003
         BO    TURNOFF                 SUCH INVALID ADDRESSES           31300003
         SPACE                                                          31350003
*/* D (YES,COMMON,NO,MAYBE1) CHARACTER IS 0,2,4,6 */                    31400003
         CLI   ZERO(XINPUT),EBCDIC0    IF FIRST CHARACTER IS 0,2,4,6    31450003
         BE    COMMON                  THEN ADDRESS MAY BE FLOATING     31500003
*                                      POINT OR GENERAL REGISTER TYPE   31550003
*                                      ADDRESS                          31600003
         CLI   ZERO(XINPUT),EBCDIC2    * * * *                          31650003
         BE    COMMON                  * * * *                          31700003
         CLI   ZERO(XINPUT),EBCDIC4    * * * *                          31750003
         BE    COMMON                  * * * *                          31800003
         CLI   ZERO(XINPUT),EBCDIC6    * * * *                          31850003
         BNE   MAYBE1                  TEST IF FIRST CHARACTER IS A     31900003
*                                      ONE, HENCE A GENERAL REGISTER    31950003
         SPACE                                                          32000003
*/*COMMON: P INCREMENT SIZE COUNTER AND SCAN POINTER */                 32050003
COMMON   DS    0H                      * * * *                          32100003
*                                      FIRST CHARACTER IS 0,2,4,OR 6    32150003
         LA    COUNTER,ONE(COUNTER)    INCREMENT TALLY BY ONE           32200003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          32250003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              32300003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               32350003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 32400003
*/* D (YES,DOUBLE,NO,SINGLE) DOUBLE PRECISION SPECIFIED */              32450003
         CLI   ZERO(XINPUT),D          DOUBLE PRECISION                 32500003
         BE    DOUBLE                  YES, BRANCH                      32550003
         CLI   ZERO(XINPUT),LOWD       LOWER CASE 'D' IS VALID          32600003
         BNE   SINGLE                  * * * *                          32650003
         SPACE                                                          32700003
*/*DOUBLE: P INDICATE DOUBLE PRECISION FLOATING POINT ADDR */           32750003
DOUBLE   DS    0H                      * * * *                          32800003
         MVI   DATAFLG,DPFPR           DENOTE TYPE OF ADDRESS           32850003
*                                      DOUBLE PRECISION FLOATING POINT  32900003
*/*REPEAT: D (YES,MAYBE1,NO,) NEXT CHARACTER IS PERIOD (ABS. ADDR) */   32950003
REPEAT   DS    0H                      * * * *                          33000003
         CLI   ONE(XINPUT),PERIOD      IS THE NEXT CHARACTER A PERIOD   33050003
*                                         DENOTING A ABSOLUTE ADDRESS   33100003
*                                         OF THE TYPE -- 6D., 4E., ETC. 33150003
         BE    MAYBE1                  IF YES BRANCH TO SAME LOCATION   33200003
*                                         AS IF NOT FLOATING POINT REG  33250003
         SPACE                                                          33300003
*/* P INCREMENT SCAN PTR PAST FLOATING POINT CHAR (D OR E) */           33350003
         LA    XINPUT,ONE(XINPUT)      INCREMENT POINTER PAST FLOATING  33400003
*                                         POINT DESIGNATION --- D OR E  33450003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               33500003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 33550003
*/* S TYPETEST: CHECK FOR ZERO THROUGH F */                             33600003
         LA    CHECK,HEX+NUMBER        HAVE ZERO THROUGH F DIGITS       33650003
*                                         CHECKED FOR                   33700003
         L     R15,TYPETSTP            GET SYNTAX CHECKER PTR.          33720003
         BAL   LINK1,LINK1OUT          TEST THE CHARACTER               33750003
*                                                                       33800003
*/* D (YES,,NO,NOTABS) ABSOLUTE ADDRESS */                              33850003
         B     NOTABS                  NOT ABSOLUTE ADDRESS             33900003
*                                                                       33950003
*/* P ZERO SIZE COUNTER */                                              34000003
         XR    COUNTER,COUNTER         RESET COUNTER                    34050003
*/* P BACK UP TO BEFORE D OR E */                                       34100003
         BCTR  XINPUT,ZERO             BACK UP XINPUT TO THE NUMBER     34150003
         BCTR  XINPUT,ZERO                BEFORE THE D OR E             34200003
         LR    XINPUTB,XINPUT          RESET BACKUP REGISTER            34250003
*/* D (YES,TURNOFF,NO,MAYBE1) REGISTER FORM OF ADDRESS */               34300003
         TM    DATAFLG,REG             IF REG FORM OF ADDRESS FOUND AT  34350003
*                                        THIS POINT AND IS OF THE FORM  34400003
*                                        2R13 OR 13R14 IT IS INVALID    34450003
*                                        AND NOT ABSOLUTE               34500003
         BNZ   TURNOFF                 PROCESS INVALID ADDRESS          34550003
         B     MAYBE1                  BRANCH TO PROCESS ABSOLUTE       34600003
*                                         ADDRESS                       34650003
         SPACE                                                          34700003
*/*NOTABS: S MOVEIN: PREPARE TO MOVE DATA INTO PDE */                   34750003
NOTABS   DS    0H                      * * * *                          34800003
         BCTR  XINPUT,ZERO             ADJUST FOR PREVIOUS INCREMENT    34850003
         BAL   LINK2,MOVEIN            HAVE DATA MOVED INTO PDE         34900003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          34950003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              35000003
*/* D (,RANGECK) LOOK FOR RANGE PARAMETER */                            35050003
         B     RANGECK                 SCAN FOR RANGE PARAMETER         35100003
         SPACE                                                          35150003
*/*SINGLE: D (YES,ONLYONE,NO,GENERAL) SINGLE PRECISION SPECIFIED */     35200003
SINGLE   DS    0H                      * * * *                          35250003
         CLI   ZERO(XINPUT),E          SINGLE PRECISION                 35300003
         BE    ONLYONE                 YES, BRANCH                      35350003
         CLI   ZERO(XINPUT),LOWE       LOWER CASE 'E' IS VALID          35400003
         BNE   GENERAL                 * * * *                          35450003
         SPACE                                                          35500003
*/*ONLYONE: P INDICATE SINGLE PRECISION FLOATING POINT ADDR */          35550003
ONLYONE  DS    0H                      * * * *                          35600003
         MVI   DATAFLG,SPFPR           INDICATE TYPE OF ADDRESS         35650003
*                                      SINGLE PRECISION FLOATING POINT  35700003
*/* D (,REPEAT) BRANCH */                                               35750003
         B     REPEAT                  AND BRANCH                       35800003
         SPACE                                                          35850003
*/*GENERAL: D (YES,GENREG,NO,NOREG) GENERAL REGISTER SPECIFIED */       35900003
GENERAL  DS    0H                      * * * *                          35950003
         CLI   ZERO(XINPUT),R          GENERAL REGISTER                 36000003
         BE    GENREG                  YES, BRANCH                      36050003
         CLI   ZERO(XINPUT),LOWR       LOWER CASE 'R' IS VALID          36100003
         BNE   NOREG                   NOT A GENERAL REGISTER, BRANCH   36150003
*/*GENREG: P INDICATE GENERAL REGISTER ADDRESS */                       36200003
GENREG   DS    0H                      * * * *                          36250003
         MVI   DATAFLG,REG             INDICATE TYPE OF ADDRESS         36300003
*                                      GENERAL REGISTER                 36350003
*                                      UNIQUE FOR ADDRESS '1R'          36400003
*/* P TURN OFF TWORBIT */                                               36450003
         NI    PFLAGS3,HFF-TWORBIT     TWORBIT IS TURNED OFF            36500003
*                                         BEFORE EXITING                36550003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          36600003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               36650003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 36700003
*/* D (YES,GENLOOP,NO,) TEST FOR INDIRECT ADDRESSING */                 36750003
         CLI   ZERO(XINPUT),PERCENT    TEST FOR INDIRECT ADDRESSING     36800003
         BE    GENLOOP                 YES, BRANCH                      36850003
         SPACE                                                          36900003
         BCTR  XINPUT,ZERO             BACKUP SCAN AGAIN                36950003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              37000003
*/* D (,REPEAT) BRANCH */                                               37050003
         B     REPEAT                  AND BRANCH                       37100003
         SPACE                                                          37150003
*/*MAYBE1: D (YES,,NO,DECIMALL) FIRST CHARACTER A ONE */                37200003
MAYBE1   DS    0H                      * * * *                          37250003
         CLI   ZERO(XINPUT),EBCDIC1    * * * *                          37300003
         BNE   DECIMALL                BRANCH, FIRST CHARACTER NOT      37350003
*                                      A ONE                            37400003
*/* P TURN ON TWO CONTROL BITS USED FOR GEN. REGISTER SCAN */           37450003
         OI    PFLAGS3,ONERBIT+TWORBIT TURN ON CONTROL BITS USED        37500003
*                                      DURING SCANNING OF POSSIBLE      37550003
*                                      GENERAL REGISTER ADDRESS         37600003
*/*REGLOOP: P INCREMENT SIZE COUNTER BY ONE */                          37650003
REGLOOP  DS    0H                      * * * *                          37700003
         LA    COUNTER,ONE(COUNTER)    INCREMENT TALLY BY ONE           37750003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN REGISTER          37800003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              37850003
*/* S CHECKEND: CHECK FOR END OF INPUT */                               37900003
         BAL   LINK1,CHECKEND          CHECK FOR END OF INPUT     M4789 37950003
         SPACE                                                          38000003
*/* D (YES,,NO,REGBITT) CONTROL BIT FOR REGISTER SCAN IS ON */          38050003
         TM    PFLAGS3,ONERBIT         IS CONTROL BIT FOR REGISTER      38100003
*                                      PROCESSING ON                    38150003
         BZ    REGBITT                 NO, BRANCH                       38200003
*/* P TURN OFF CONTROL BIT */                                           38250003
         NI    PFLAGS3,HFF-ONERBIT     YES, CLEAR BIT                   38300003
*/* D (,EXCEED) BRANCH */                                               38350003
         B     EXCEED                  AND BRANCH                       38400003
         SPACE                                                          38450003
*/*REGBITT: D (YES,,NO,VARYMAX) REGISTER CONTROL BIT ON */              38500003
REGBITT  DS    0H                      * * * *                          38550003
         TM    PFLAGS2,REGBIT          REGISTER CONTROL BIT ON          38600003
         BZ    VARYMAX                 NO, BRANCH                       38650003
*/* P TURN OFF CONTROL BIT */                                           38700003
         NI    PFLAGS2,HFF-REGBIT      CLEAR BIT                        38750003
         SPACE                                                          38800003
*/*EXCEED: D (YES,TURNOFF,NO,) PARAMETER SIZE GREATER THAN 2 (REG.) */  38850003
EXCEED   DS    0H                      * * * *                          38900003
         CH    COUNTER,H3              IS TALLY FOR REGISTER SCAN       38950003
*                                      GREATER THAN TWO                 39000003
         BNL   TURNOFF                 REGISTER ADDRESS PARAMETER       39050003
*                                      TOO LARGE                        39100003
         SPACE                                                          39150003
*/* D (YES,GENREG,NO,) GENERAL REGISTER ADDRESS */                      39200003
         CLI   ZERO(XINPUT),R          GENERAL REGISTER ADDRESS         39250003
         BE    GENREG                  YES, BRANCH TO RTN PROCESSING    39300003
*                                      A GENERAL REGISTER PARAMETER     39350003
         CLI   ZERO(XINPUT),LOWR       LOWER CASE 'R' IS VALID          39400003
         BE    GENREG                  * * * *                          39450003
         SPACE                                                          39500003
*/*VARYMAX: D (YES,,NO,MAYBEREG) SIZE COUNTER IS EQUAL TO TWO */        39550003
VARYMAX  DS    0H                      * * * *                          39600003
         LA    R15,TWO                 LOAD COMPRAND                    39650003
         CR    COUNTER,R15             IF COUNTER IS EQUAL TO TWO       39700003
*                                         PARAMETER CANNOT BE OF GEN-   39750003
*                                         ERAL REG TYPE.FOR EX.--1AB30  39800003
*                                         WOULD PASS AS A GENERAL REG   39850003
*                                         TYPE IF NOT FOR THESE INSTRS  39900003
         BNE   MAYBEREG                 IF NOT TWO BRANCH               39950003
         SPACE                                                          40000003
*/* P TURN OFF REGISTER CONTROL BIT */                                  40050003
         NI    PFLAGS3,HFF-TWORBIT     TURN OFF CONTROL FLAG SO LATER   40100003
*                                         TEST IN 'NOREG' TAKES BZ      40150003
         SPACE                                                          40200003
*/*MAYBEREG: D (YES,,NO,NOREG) SIZE GREATER THAN MAX FOR ABS. ADDR  */  40250003
MAYBEREG DS    0H                      * * *                            40300003
         CH    COUNTER,DEC7            IS TALLY GREATER THAN MAXIMUM    40350003
*                                      FOR AN ABSOLUTE ADDRESS          40400003
         BL    NOREG                   NO, BRANCH                       40450003
*/* D (YES,,NO,TURNOFF) SCANNING SYMBOLIC ADDRESS */                    40500003
         TM    PFLAGS2,FLTERBIT        ARE WE POSSIBLY SCANNING A       40550003
*                                      SYMBOLIC ADDRESS                 40600003
         BZ    TURNOFF                 IF NOT SCANNING A SYMBOLIC       40650003
*                                      ADDRESS PARAMETER, THEN          40700003
*                                      PARAMETER TOO LONG               40750003
*/* D (YES,,NO,NOREG) SIZE GREATER THAN MAX FOR LOADNAME */             40800003
         CH    COUNTER,DEC9            IS TALLY GREATER THAN MAXIMUM    40850003
*                                      FOR A LOADNAME PARAMETER         40900003
         BL    NOREG                   NO, BRANCH                       40950003
*/* P CLEAR BIT FOR SYMBOLIC ADDRESS */                                 41000003
         NI    PFLAGS2,HFF-FLTERBIT    CLEAR BIT                        41050003
*/* P INDICATE SYMBOLIC ADDRESS */                                      41100003
         MVI   DATAFLG,SYMADR          INDICATE AS SYMBOLIC ADDRESS     41150003
*/* D (,ALPHAMER) BRANCH */                                             41200003
         B     ALPHAMER                AND BRANCH                       41250003
         SPACE                                                          41300003
*/*DECIMALL: P TURN ON REGISTER CONTROL BIT */                          41350003
DECIMALL DS    0H                      * * * *                          41400003
         OI    PFLAGS2,REGBIT          TURN ON REGISTER CONTROL BIT     41450003
         SPACE                                                          41500003
*/*NOREG: S TYPETEST: CHECK IF CHARACTER IS A NUMBER */                 41550003
NOREG    DS    0H                      * * * *                          41600003
         LA    CHECK,NUMBER            IS CHARACTER A NUMBER            41650003
         L     R15,TYPETSTP            GET SYNTAX CHECKER PTR.          41670003
         BAL   LINK1,LINK1OUT         * * * *                           41700003
         SPACE                                                          41750003
*/* D (YES,,NO,NODEC) CHARACTER IS NUMERIC */                           41800003
         B     NODEC                   +0 RETURN - NON-NUMERIC          41850003
         SPACE                                                          41900003
*/* D (YES,,NO,REGLOOP) CONTROL BIT FOR REGISTER PROCESSING IS ON */    41950003
         TM    PFLAGS3,TWORBIT         +4 RETURN - NUMERIC              42000003
         BZ    REGLOOP                 BRANCH IF CONTROL BIT FOR        42050003
*                                      REGISTER PROCESSING IS NOT ON    42100003
*/* P TURN OFF CONTROL BIT */                                           42150003
         NI    PFLAGS3,HFF-TWORBIT     TURN OFF CONTROL BIT             42200003
*                                      TEST IF SECOND NUMERIC CHARACTER 42250003
*                                      IS BETWEEN 0-5                   42300003
*                                      THEREFORE, POSSIBLY A GENERAL    42350003
*                                      REGISTER                         42400003
*/* D (YES,TURNON,NO,REGLOOP) SECOND NUMERIC CHAR IS BETWEEN 0-5 */     42450003
         CLI   ZERO(XINPUT),EBCDIC0    * * * *                          42500003
         BE    TURNON                  YES, BRANCH                      42550003
         SPACE                                                          42600003
         CLI   ZERO(XINPUT),EBCDIC1    * * * *                          42650003
         BE    TURNON                  YES, BRANCH                      42700003
         CLI   ZERO(XINPUT),EBCDIC2    * * * *                          42750003
         BE    TURNON                  YES, BRANCH                      42800003
         SPACE                                                          42850003
         CLI   ZERO(XINPUT),EBCDIC3    * * * *                          42900003
         BE    TURNON                  YES, BRANCH                      42950003
         SPACE                                                          43000003
         CLI   ZERO(XINPUT),EBCDIC4    * * * *                          43050003
         BE    TURNON                  YES, BRANCH                      43100003
         SPACE                                                          43150003
         CLI   ZERO(XINPUT),EBCDIC5    * * * *                          43200003
         BNE   REGLOOP                 * * * *                          43250003
         SPACE                                                          43300003
*/*TURNON: P TURN ON REGISTER CONTROL BIT */                            43350003
TURNON   DS    0H                      * * * *                          43400003
         OI    PFLAGS3,ONERBIT         TURN REGISTER CONTROL BIT ON     43450003
*/* D (,REGLOOP) SCAN NEXT CHARACTER */                                 43500003
         B     REGLOOP                 BRANCH TO SCAN NEXT CHARACTER    43550003
         SPACE                                                          43600003
*/*NODEC: P TURN REGISTER CONTROL BIT OFF */                            43650003
NODEC    DS    0H                      * * * *                          43700003
         NI    PFLAGS2,HFF-REGBIT      TURN CONTROL BIT OFF             43750003
         LA    CHECK,HEX               HEX CHARACTER                    43800003
*/* S TYPETEST: CHECK FOR HEX CHARACTER */                              43850003
         L     R15,TYPETSTP            GET SYNTAX CHECKER PTR.          43870003
         BAL   LINK1,LINK1OUT         * * * *                           43900003
*/* D (YES,REGLOOP,NO,WHATISIT) HEX CHARACTER */                        43950003
         B     WHATISIT                NO, BRANCH                       44000003
         B     REGLOOP                 YES, SCAN NEXT CHARACTER         44050003
         SPACE                                                          44100003
*/*WHATISIT: D (YES,WHICHONE,NO,) DELIMITER FOR ABS. OR LOADNM ADDR */  44150003
WHATISIT DS    0H                      * * * *                          44200003
         CLI   ZERO(XINPUT),PERIOD     VALID DELIMITER FOR ABSOLUTE     44250003
*                                      OR LOADNAME PARAMETER            44300003
         BE    WHICHONE                YES, BRANCH                      44350003
*/* D (YES,ALPHAMER,NO,CKCTRR) VALID SYMBOLIC PARAMETER */              44400003
         TM    PFLAGS2,FLTERBIT        IS FILTER BIT ON                 44450003
         BZ    CKCTRR                  NO, FIRST CHARACTER NOT A        44500003
*                                      LETTER, THEREFORE NOT A VALID    44550003
*                                      SYMBOLIC PARAMETER               44600003
         B     ALPHAMER                AND BRANCH                       44650003
         SPACE                                                          44700003
*/*CKCTRR: D (YES,ADDREPRQ,NO,TURNOFF) SIZE COUNTER ZERO */             44750003
CKCTRR   DS    0H                      * * * *                          44800003
         LTR   COUNTER,COUNTER         IS TALLY COUNT ZERO              44850003
         BNZ   TURNOFF                 NO, ERROR, BRANCH                44900003
         BCT   XINPUT,ADDREPRQ         YES, THEN FIRST CHARACTER OF     44950003
*                                      BUFFER NOT VALID - BACKUP BUFFER 45000003
         SPACE                                                          45050003
*/*WHICHONE: P INCREMENT SCAN POINTER */                                45100003
WHICHONE DS    0H                      * * * *                          45150003
         LA    XINPUT,ONE(XINPUT)      TEMPORARILY INCREMENT SCAN REG   45200003
*/* D (YES,ABSADDR,NO,) REACHED END OF INPUT */                         45250003
*/* S TYPETEST: CHECK IF CHARACTER FOLLOWING DELIMITER IS A LETTER */   45300003
         C     XINPUT,ENDINPUT         ENDINPUT BEEN REACHED      M4789 45350003
         BNL   ABSADDR                 YES, ABSOLUTE ADDRESS      M4789 45400003
         LA    CHECK,HEX+OLETTER+NATL  IS ALPHABETIC OR NATIONAL        45450003
*                                         CHARACTER FOLLOWING           45500003
         L     R15,TYPETSTP            GET SYNTAX CHECKER PTR.          45520003
         BAL   LINK1,LINK1OUT          DELIMITER A LETTER               45550003
         B     ABSADDR                 NO, PARAMETER IS ABSOLUTE        45600003
*                                      YES, PARAMETER IS LOADNAME       45650003
*/* P RESTORE SCAN POINTER */                                           45700003
         BCTR  XINPUT,ZERO             RESTORE PTR TO LAST CHARACTER    45750003
*                                      SCANNNED                         45800003
*/* P TURN OFF SYMBOLIC CONTORL BIT */                                  45850003
         NI    PFLAGS2,HFF-FLTERBIT    YES, TURN IT OFF                 45900003
*/* D (,LOADPARM) PROCESS LOADNAME */                                   45950003
         B     LOADPARM                * * * *                          46000003
         SPACE                                                          46050003
*/*ABSADDR: P RESTORE SCAN POINTER */                                   46100003
ABSADDR  DS    0H                      * * * *                          46150003
         BCTR  XINPUT,ZERO             RESTORE PTR TO LAST CHARACTER    46200003
*                                      SCANNNED                         46250003
*/* P INDICATE ABSOLUTE ADDRESS */                                      46300003
         MVI   DATAFLG,ABSADR          INDICATE AS ABSOLUTE ADDRESS     46350003
*/* D (YES,TURNOFF,NO,) ABSOLUTE ADDRESS HAS QUALIFICATION */           46400003
         TM    DATAFLA2,PL1BIT         IT IS NOT VALID FOR AN ABSOLUTE  46450003
         BO    TURNOFF                 ADDRESS TO HAVE QUALIFICATION    46500003
*/* P TURN SYMBOLIC CONTROL BIT OFF */                                  46550003
         NI    PFLAGS2,HFF-FLTERBIT    TURN CONTROL BIT OFF             46600003
*/* D (YES,BUMPCTR,NO,) ENDINPUT HAS BEEN REACHED */                    46650003
         TM    PFLAGS,PFENDF           HAS ENDINPUT BEEN REACHED  M4789 46700003
         BNO   BUMPCTR                 YES, MOVE DATA IN PDE      M4789 46750003
         CLI   ZERO(XINPUT),PERIOD                               A46773 46800003
         BE    BYONE                   GO INCREMENT              Y00972 46850003
         CLI   ZERO(XINPUT),PERCENT    IS IT A PERCENT SIGN?     Y00972 46900003
         BE    BYONE                   YES, GO INCREMENT         Y00972 46950003
         B     TURNOFF                 NOT KNOWN, SIGNAL ERROR   Y00972 47000003
*/* D (,GOMOVE) INCREMENT SCAN PTR AND BRANCH */                        47050003
BYONE    DS    0H                                                Y00972 47100003
         LA    XINPUT,ONE(XINPUT)      INCREMENT SCAN POINTER     M4789 47150003
         B     GOMOVE                  * * * *                   Y00972 47200003
         SPACE                                                          47250003
*/*ADDREPRQ: S PROMPTQ: CHECK IF PROMPTING IS NECESSARY */              47300003
ADDREPRQ DS    0H                      * * * *                          47350003
         L     R15,PROMPTQP            GET PROMPT RTN PTR               47370003
         BAL   LINK1,LINK1OUT          PROMPT IF NECESSARY              47400003
*                                                                       47450003
*/* D (YES,ADDRERSC,NO,ADREXIT1) DATA RETURNED FROM PROMPT */           47500003
         B     ADDRERSC                +0 RETURN - DATA TO SCAN         47550003
*                                                                       47600003
         B     ADREXIT1                +4 RETURN - NO DATA PRESENT EXIT 47650003
         SPACE                                                          47700003
*/*MOVEIN: E PREPARE DATA TO GO INTO PDE */                             47750003
MOVEIN   DS    0H                      * * * *                          47800003
         BCTR  XINPUT,ZERO             BACK UP SCAN AGAIN               47850003
*/* P COMPUTE LENGTH OF ADDRESS */                                      47900003
         S     XINPUTB,PPOINTR         COMPUTE LENGTH OF ADDRESS        47950003
         SR    XINPUTB,LEVELS          EXCLUDING LEVELS OF INDIRECT     48000003
*                                      ADDRESSING. IF NONE, R3(LEVELS)  48050003
*                                      WILL CONTAIN ZERO                48100003
*/* D (YES,ASITIS,NO,) PROCESSING LOADNAME OR ENTRYNAME QUALIFIER */    48150003
         TM    PFLAGS2,LOADBIT+ENTRYBIT PROCESSING A LOADNAME QUALIFIER 48200003
*                                         OR AN ENTRYNAME QUALIFIER     48250003
         BM    ASITIS                  YES, BRANCH                      48300003
*/* D (YES,LEVELTST,NO,) PROCESSING GENERAL REGISTER ADDRESS */         48350003
         TM    DATAFLG,REG             ARE WE PROCESSING A GENERAL      48400003
*                                      REGISTER ADDRESS                 48450003
         BO    LEVELTST                YES, BRANCH                      48500003
*/* D (YES,SUBTRACT,NO,ASITIS) PROCESSING ABSOLUTE ADDRESS */           48550003
         CLI   DATAFLG,ABSADR          PROCESSING AN ABSOLUTE ADDRESS   48600003
*                                                                 M5957 48650003
         BNE   ASITIS                  NO, BRANCH                 M5957 48700003
         B     SUBTRACT                YES                              48750003
         SPACE                                                          48800003
*/*LEVELTST: D (YES,,NO,ASITIS) ANY LEVELS OF INDIRECT ADDRESSES */     48850003
LEVELTST DS    0H                                                       48900003
         LTR   LEVELS,LEVELS           ANY LEVELS OF INDIRECT           48950003
*                                      ADDRESSES SPECIFIED              49000003
         BZ    ASITIS                  NO, BRANCH ADDRESS LENGTH OK     49050003
         SPACE                                                          49100003
*/*SUBTRACT: P EXCLUDE 'R' FROM LENGTH IF REG OR DELIM IF ABS ADDR */   49150003
SUBTRACT DS    0H                                                       49200003
         BCTR  XINPUTB,ZERO            SUBTRACT ONE TO EXCLUDE THE      49250003
*                                      CHARACTER 'R' FROM THE LENGTH    49300003
*                                      IF REGISTER ADDRESS OR DELIMITER 49350003
*                                      IF  ABSOLUTE ADDRESS             49400003
*/*ASITIS: P STORE DATA LENGTH */                                       49450003
ASITIS   EQU   *                                                        49500003
         STH   XINPUTB,PLENGTH         STORE DATA LENGTH                49550003
         L     R15,TRANSQP             GET ADDRESS OF TRANSLATE         49600003
*                                         ROUTINE                       49650003
*/* P TRANSLATE TO UPPER CASE */                                        49700003
         BAL   LINK1,LINK1OUT          TRANSLATE TO UPPER CASE          49750003
*/* D (YES,,NO,ABC) PREPARING LOADNAME DATA FOR PDE */                  49800003
         TM    PFLAGS2,LOADBIT         ARE WE PREPARING TO MOVE         49850003
*                                      LOADNAME DATA INTO PDE           49900003
*/* R RETURN */                                                         49950003
         BCR   CC7,LINK2               IF YES RETURN                    50000003
         SPACE                                                          50050003
*/*ABC: D (YES,,NO,ABCD) PREPARING ENTRYNAME DATA FOR PDE */            50100003
         TM    PFLAGS2,ENTRYBIT        ARE WE PREPARING TO MOVE         50150003
*                                      ENTRYNAME DATA INTO PDE          50200003
*/* R RETURN */                                                         50250003
         BCR   CC7,LINK2               IF YES RETURN                    50300003
         SPACE                                                          50350003
*/*ABCD: P MOVE DATA PTR TO TEMPORARY PDE */                            50400003
         MVC   DATAPTR3+ONE(L'DATAPTR3-ONE),PPOINTR+ONE                 50450003
*                                      MOVE DATA PTR TO TEMPORARY PDE   50500003
*/* P MOVE DATA LENGTH */                                               50550003
         MVC   DATALEN3,PLENGTH        MOVE DATA LENGTH                 50600003
*/* P TURN ON CONTROL BIT FOR PL1 */                                    50650003
         OI    DATAFLA3,PL1BIT         CONTROL BIT FOR PL1              50700003
*/* P STORE NUMBER OF LEVELS OF INDIRECT ADDRESSING */                  50750003
         STH   LEVELS,DATAICT          STORE NOMBER OF LEVELS OF        50800003
*                                      INDIRECT ADDRESSING. IF NONE,    50850003
*                                      THEN R3(LEVELS)WILL BE ZERO.     50900003
         LA    XINPUT,ONE(,XINPUT)     INCREMENT SCAN REGISTER          50950003
*                                      TO LAST CHARACTER SCANNED        51000003
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER              51050003
*/* R RETURN */                                                         51100003
         BR    LINK2                   AND RETURN                       51150003
         SPACE                                                          51200003
*/*TURNOFF: D (,ILLADDR) BRANCH TO ILLADDR RTN */                       51250003
TURNOFF  DS    0H                      * * * *                          51300003
         L     R15,ILLADDRP            GET INVALID ADRESS RTN. PTR      51320003
         L     R14,ADDRSAVE+EIGHT      RESTORE BASE REGISTER            51330003
         BR    R15                     BRANCH TO ILLADDR RTN            51350003
         SPACE                                                          51400003
* END OF INPUT HAS BEEN REACHED DURNING ADDRESS PARSE. CHECK FLAGS AND* 51450003
* BIT SETTINGS TO SEE IF ADDRESS IS CORRECT. IF ADDRESS IS COMPLETE   * 51500003
* BRANCH TO END PROCESSING ROUTINE, IF NOT INVALID ADDRESS            * 51550003
         SPACE                                                          51600003
*/*CHECKEND: E CHECK FOR END OF INPUT */                                51650003
CHECKEND DS    0H                      * * * *                          51700003
*/* D (YES,ABCDE,NO,) END OF INPUT */                                   51750003
         C     XINPUT,ENDINPUT         END OF INPUT               M4789 51800003
*/* R RETURN AND CONTINUE PROCESSING */                                 51850003
         BL    ZERO(LINK1)             NO, CONTINUE               M4789 51900003
         SPACE                                                          51950003
*/*ABCDE: D (YES,TURNOFF,NO,) INVALID ADDRESS */                        52000003
         LTR   COUNTER,COUNTER         YES CHECK SIZE OF ADDRESS  M4789 52050003
         BZ    TURNOFF                 ZERO,INVALID ADDRESS       M4789 52100003
*                                         A + OR . WAS FOUND OR   M4789 52150003
*                                         A LOADNAME. OR ENTRY.   M4789 52200003
*                                         OR ADDRESS OF THE FORM  M4789 52250003
*                                         7R%+                    M4789 52300003
*/* P SET ENDINPUT INDICATOR */                                         52350003
         OI    PFLAGS,PFENDF           SET ENDINPUT INDICATOR     M4789 52400003
         SPACE                                                          52450003
*/* D (YES,ENDPDE,NO,) PROCESSING EXPRESSION */                         52500003
         TM    PFLAGS,ADREXP           PROCESSING EXPRESSION      M4789 52550003
         BO    ENDPDE                  YES MOVE DATA IN PDE       M4789 52600003
*/* D (YES,RANGECK,NO,) WANT TO CHECK FOR RANGE */                      52650003
         TM    PFLAGS4,CKRANGE         MAKE CHECK FOR RANGE       M4789 52700003
         BO    RANGECK                 YES,BRANCH                 M4789 52750003
         SPACE                                                          52800003
*/* D (YES,NOTABS,NO,) FLAG HAS BEEN SET FOR ANY CORRECT ADDR */        52850003
         TM    DATAFLG,REG+RELADR+SYMADR+DPFPR+SPFPR IF THE FLAG  M4789 52900003
*                                          HAS BEEN SET FOR A REG M4789 52950003
*                                          SYMBOLIC,RELATIVE OR   M4789 53000003
*                                          FLOATING POINT REG     M4789 53050003
*                                          ADDRESS,THE ADDRESS IS M4789 53100003
*                                          CORRECT                M4789 53150003
         BNZ   NOTABS                  YES, MOVE DATA IN PDE      M4789 53200003
         SPACE                                                          53250003
*/* D (YES,DELIMITR,NO,) PROCESSING ENTRYNAME */                        53300003
         TM    PFLAGS2,ENTRYBIT        PROCESSING ENTRYNAME       M5028 53350003
         BO    DILIMITR                YES, MOVE IN PDE           M5028 53400003
*/* D (YES,,NO,CHKABS) FLTERBIT ON */                                   53450003
         TM    PFLAGS2,FLTERBIT        FLTERBIT ON                M4789 53500003
         BNO   CHKABS                  NO CHECK FOR ABSOLUTE      M4789 53550003
*/* P TURN OFF FLTERBIT */                                              53600003
         NI    PFLAGS2,HFF-FLTERBIT    TURN OFF FILTER BIT        M4789 53650003
*/* P INDICATE MUST BE SYMBOLIC ADDRESS */                              53700003
         MVI   DATAFLG,SYMADR          A SYMBOLIC ADDRESS         M4789 53750003
*/* D (,NOTABS) MOVE IN PDE */                                          53800003
         B     NOTABS                  INDICATE AND NOVE IN PDE   M4789 53850003
         SPACE                                                          53900003
*/*CHKABS: D (,WHATISIT) CHECK IF VALID ADDRESS */                      53950003
CHKABS   DS    0H                      * * * *                          54000003
         SPACE                                                          54050003
         CLI   DATAFLG,ABSADR          ABSOLUTE ADDRESS           M5957 54100003
         BE    ABSADDR                                            M5957 54150003
*                                                                A46773 54200003
         BCT   XINPUT,WHATISIT         SEE IF VALID ADDRESS       M4789 54250003
*                                                                       54251003
         EJECT                                                          54252003
*********************************************************************** 54252203
*                                                               Y30NQJN 54252303
***                                                                 *** 54252403
**                                                                   ** 54252603
*                     L  I  N  K  2  O  U  T                          * 54252803
*                                                                     * 54253003
*   THIS SUBROUTINE SERVES AS A LINKAGE ROUTINE TO THE PARSE MAINLINE * 54253203
*   ROUTINE. IT SAVES LINK2, REGISTER 8, WHICH IS THE ADDRESS OF THE  * 54253403
*   OF THE NEXT SEQUENTIAL INSTRUCTION. IT THEN PASSES CONTROL TO     * 54254003
*   THE APPROPRIATE SUBROUTINE IN THE MAINLINE ROUTINE, ITS POINTER IS* 54256003
*   IN REGISTER 15. UPON RETURN FROM  THE MAINLINE ROUTINE, THE       * 54258003
*   APPROPRIATE OFFSET FROM THE NEXT INSTRUCTION IS OBTAINED, THIS    * 54258403
*   ROUTINE'S BASE REGISTER IS RESTORED, AND CONTROL IS PASSED TO     * 54258803
*   CORRECT DISPLACEMENT IN THIS ROUTINE.                             * 54259203
*                                                                     * 54259603
**                                                                   ** 54260003
***                                                                 *** 54260403
*********************************************************************** 54260803
LINK2OUT DS    0H                      LINKAGE TO EXTERNAL SUBROUTINES  54261203
         ST    LINK2,ADDRSAVE          SAVE LINK2 CONTENTS              54262003
LINKOUT  DS    0H                      RESTORE BASE REGISTER            54263003
         BALR  LINK2,R15               GO TO SUBROUTINE                 54264003
         USING *,LINK2                 TEMPORARY ADDRESSABILITY         54268003
         B     ADDRCOMP                GO PROCESS ZERO RETURN           54270003
         B     ADR4COMP                PROCESS +4 RETURN                54272003
         LA    R15,EIGHT               PREPARE FOR +8 RETURN            54274003
LINK2IN  DS    0H                                                       54276003
         L     LINK2,ADDRSAVE          RESTORE LINKAGE RETURN POINT     54280003
         L     R14,ADDRSAVE+FOUR       RESTORE RTN'S BASE REG.          54282003
         AR    R15,LINK2               GET TRUE BRANCH ADDRESS          54284003
         BR    R15                     RETURN TO CONTINUE               54286003
ADR4COMP DS    0H                      +4 RETURN                        54288003
         LA    R15,FOUR                PREPARE FOR RETURN               54291003
         B     LINK2IN                 CONTINUE PROCESS                 54293003
ADDRCOMP DS    0H                                                       54295003
         SR    R15,R15                 SET FOR +0 RETURN                54297003
         B     LINK2IN                 PREPARE FOR RETURN               54300003
         DROP  LINK2                                                    54302003
*                                                                       54304003
         EJECT                                                          54306903
*********************************************************************** 54308903
*                                                               Y30NQJN 54309903
***                                                                 *** 54310903
**                                                                   ** 54312903
*                     L  I  N  K  1  O  U  T                          * 54314903
*                                                                     * 54316903
*   THIS SUBROUTINE SERVES AS A LINKAGE ROUTINE TO THE PARSE MAINLINE * 54317103
*   ROUTINE. IT SAVES LINK1, REGISTER 9, WHICH IS THE ADDRESS OF THE  * 54317303
*   OF THE NEXT SEQUENTIAL INSTRUCTION. IT THEN PASSES CONTROL TO     * 54317503
*   THE APPROPRIATE SUBROUTINE IN THE MAINLINE ROUTINE, ITS POINTER IS* 54317703
*   IN REGISTER 15. UPON RETURN FROM  THE MAINLINE ROUTINE, THE       * 54317903
*   APPROPRIATE OFFSET FROM THE NEXT INSTRUCTION IS OBTAINED, THIS    * 54318103
*   ROUTINE'S BASE REGISTER IS RESTORED, AND CONTROL IS PASSED TO     * 54318303
*   CORRECT DISPLACEMENT IN THIS ROUTINE.                             * 54318903
*                                                                     * 54324903
**                                                                   ** 54325903
***                                                                 *** 54326903
*********************************************************************** 54327903
LINK1OUT DS    0H                      LINKAGE TO EXTERNAL SUBROUTINES  54328903
         ST    LINK1,ADDRSAVE          SAVE LINK2 CONTENTS              54330903
LNKOUT   DS    0H                      RESTORE BASE REGISTER            54336903
         BALR  LINK1,R15               GO TO SUBROUTINE                 54339903
         USING *,LINK1                 TEMPORARY ADDRESSABILITY         54348903
         B     ADD1COMP                GO PROCESS ZERO RETURN           54351903
         B     ADDR4CMP                PROCESS +4 RETURN                54354903
         LA    R15,EIGHT               PREPARE FOR +8 RETURN            54360903
LINK1IN  DS    0H                                                       54366903
         L     LINK1,ADDRSAVE          RESTORE LINKAGE RETURN POINT     54369903
         L     R14,ADDRSAVE+FOUR       RESTORE RTN'S BASE REG.          54372903
         AR    R15,LINK1               GET TRUE BRANCH ADDRESS          54378903
         BR    R15                     RETURN TO CONTINUE               54381903
ADDR4CMP DS    0H                      +4 RETURN                        54388903
         LA    R15,FOUR                PREPARE FOR +4 RETURN            54392903
         B     LINK1IN                 PREPARE FOR RETURN               54396903
ADD1COMP DS    0H                                                       54402903
         SR    R15,R15                 SET FOR +0 RETURN                54405903
         B     LINK1IN                 PREPARE FOR RETURN               54408903
         DROP  LINK1                                                    54414903
*                                                                       54420903
         EJECT                                                          54426903
*       CONSTANTS                                               Y30NQJN 54427903
LRPAREN  DC    C'( )'                  FOR NULL SUBFIELD                54429903
SLASHAST DC    C'/*'                   COMMENT DELIMITER                54432903
H3       DC    H'3'                    USED TO OBTAIN VALIDITY CHECK    54438903
*                                      ROUTINE ADDRESS FROM PCE         54444903
TWO56    DC    H'256'                  EXCEEDS MAXIMUM LEVELS OF        54447903
*                                      INDIRECT ADDRESSING BY ONE       54450903
DEC9     DC    H'9'                    DECIMAL 9                        54456903
DEC32    DC    H'32'                   DECIMAL 32                       54462903
DEC7     DC    H'7'                    DECIMAL 7                        54465903
         DS    0F                      ALLIGN ON FULLWORD BOUNDARY      54468903
SPLNGTH  DC    X'01000010'             CORE USED FOR EXPRESSION         54474903
*                                      VALUE PDE'S                      54480903
         EJECT                                                          54486903
*                                                                       54490903
*                                                               Y30NQJN 54492903
*        ADCONS                                                         54494903
*                                                                       54498903
SKIPBP   DC    A(SKIPB)                SKIP SEPARATORS RTN.             54502903
LISTTP   DC    A(LISTT)                LIST PROCESSING RTN.             54510003
ILLADDRP DC    A(ILLADDR)              INVALID ADDRESS RTN.             54710003
TYPETSTP DC    A(TYPETEST)             SYNTAX CHECKING RTN.             54910003
STALOCP  DC    A(STALOC)               STORAGE ALLOCATION RTN.          55110003
TRANSQP  DC    A(TRANSQ)               TRANSLATE RTN.                   55310003
RANGEP   DC    A(RANGE)                RANGE PROCESSOR RTN.             55510003
POSITXP  DC    A(POSITX)               IKJPOSIT EXIT RTN.               55710003
PROMPTQP DC    A(PROMPTQ)              PROMPTING RTN.                   55910003
         EJECT                                                          56110003
PWORK    IKJEFPWA                                                       56310003
         END                                                            57047303
