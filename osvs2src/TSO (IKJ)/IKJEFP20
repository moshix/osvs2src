P20      TITLE 'IKJEFP20   GENERAL SCAN MODULE FOR PARSE               *00020102
               VERSION FOUR DATE 12/7/72'                               00025902
**********************************************************************  00028802
*                                                                       00031702
* TITLE -- IKJEFP20-  GENERALIZED SCAN MODULE FOR PARSE                 00034602
*                                                                       00037502
* STATUS -- VERSION FOUR                                                00040402
*                                                                       00042001
*                                                                       00043201
* FUNCTION/OPERATION -- GENERALIZED SCAN SYNTAX CHECKS PARAMETERS FOR   00043620
*     PARSE AND ACCORDING TO CONTROL INFORMATION                        00045202
*     SET UP BY THE CALLER FOR THE SCAN. THIS ROUTINE ALSO TRANSLATES   00046820
*     A PARAMETER TO UPPER CASE.                                        00048420
*                                                                       00050020
* ENTRY POINTS -- GENSCAN -- ENTRY POINT AT WHICH SYNTAX CHECKING OF  A 00051620
*     PARAMETER IS DONE ACCORDING TO CONTROL INFORMATION PASSED.        00053220
*    TRANSQ -- ENTRY POINT AT WHICH A PARAMETER IS TRANSLATED TO UPPER- 00054820
*     CASE.                                                             00056420
*    TRANSX -- ENTRY POINT TO TRANSLATE TO UPPERCASE IF PARAMETER       00058020
*     IS KNOWN NOT TO BE DEFAULTED.                                     00059620
*    TRTAB -- ENTRY POINT TO ACCESS TABLE ASSIGNING A CHARACTER CLASS   00061220
*     TO AN EBCIDIC CHARACTER.                                          00062820
*    UPPERTAB -- ENTRY POINT TO ACCESS TRANSLATE TABLE ONLY.            00064420
*                                                                       00066020
* INPUT -- PDWORD CONTAINS A POINTER TO A WORD CONTAINING               00067620
*     CONTROL INFORMATION                                               00069220
*      **********************************************************       00070820
*      / SCAN OPTIONS / FIRST CHARACTER /OTHER CHARACTER/MAXIMUM/       00072420
*      /              /    TYPE         /    TYPE       /LENGTH /       00074020
*      **********************************************************       00075620
*      0              1                 2               3               00077220
*     REGISTER FOUR CONTAINS POINTER TO PARAMETER TO BE SCANNED.        00078820
*     --TRANSLATION FUNCTION - PPOINTER CONTAINS ADDRESS                00080420
*     OF PARAMETER TO BE TRANSLATED                                     00082020
*     PLENGTH CONTAINS LENGTH OF PARAMETER.                             00083620
*                                                                       00085220
* OUTPUT -- THE TRANSLATED PARAMETER IN ITS ORIGINAL BUFFER.            00086820
*                                                                       00088420
* EXTERNAL REFERENCES -- NONE                                           00090020
*                                                                       00091620
* EXITS- NORMAL-- FROM SCAN ROUTINE EXITS TO THE LINK REGISTER          00093220
*     ADDRESS                                                           00094820
*      +0 - IF PARAMETER IS MISSING                                     00096420
*      +4 - IF PARAMETER IS INVALID                                     00098020
*      +8 - IF END OF BUFFER IS ALSO PARAMETER END                      00099620
*      +12- IF PARAMETER NOT AT END OF BUFFER                           00101220
*                                                                       00102820
*      --FROM TRANSLATION ROUTINE EXITS TO LINK REGISTER ADDRESS        00104420
*                                                                       00106020
* EXITS- ERROR-- NONE                                                   00107620
*                                                                       00109220
* TABLES/WORKAREAS -- TRTAB-TABLE WHICH ASSIGNS CHARACTER CLASS TO      00110820
*    EACH EBCIDIC CONFIGURATION                                         00112420
*    CHARTYPE-TABLE WHICH SELECTS MASK FOR TYPE OF CHARACTER REQUIRED   00114020
*    BY ROUTINE WHICH TEST CHARACTER TYPE.                              00115620
*    IKJEFPWA-MACRO MAPPING WORK AREA.                                  00117220
* ATTRIBUTES -- REENTRANT                                               00118820
*                                                                       00120420
* CHARACTER CODE DEPENDENCY -- CLASS C. THE OPERATION OF THIS MODULE    00122020
*     IS DEPENDENT UPON AN INTERNAL REPRESENTATION OF THE EXTERNAL CHAR 00123620
*     ACTER SET WHICH IS EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.   00125220
*     THE CODING HAS BEEN ARRANGED SO THAT REDEFINITION OF 'CHARACTER'  00126820
*     CONSTANTS,BY REASSEMBLY, WILL RESULT IN A CORRECT MODULE FOR THE  00128420
*     NEW DEFINITION.                                                   00130020
*                                                                       00131620
* RELEASE 20 SUPPORT CODE -- 20035                                      00133202
*                                                                       00134820
* NOTES: FLAGGING CODES ARE R=DCRR,A=APAR,M=PTM,F=PTF,S=SUPPORT CODE    00135201
*                                                                       00135601
**********************************************************************  00136420
         EJECT                                                          00138020
IKJEFP20 CSECT                                                          00139620
*A 006796-006799                                                 F41448 00140001
*D 005677-005682                                               @ZA29352 00140203
         EXTRN POSITX1,GETCORE,STALOC,QSTR01,RANGE               Y02666 00140402
         ENTRY GENSCAN,TRANSQ,TRANSX,TRTAB,UPPERTAB                     00141220
         SPACE                                                          00142820
*                                                                       00144420
* REGISTER EQUATES.                                                     00146020
*                                                                       00147620
R0       EQU   0                       SCRATCH/PARAMETER REGISTER --    00149220
*                                         MUST BE 0                     00150820
R1       EQU   1                       SCRATCH/PARAMETER REGISTER --    00152420
*                                         MUST BE 1                     00154020
R2       EQU   2                       GENERAL SCRATCH REGISTER         00155620
R3       EQU   3                       GENERAL SCRATCH REGISTER         00157220
XINPUT   EQU   4                       NEXT CHARACTER TO SCAN           00158820
XINPUTB  EQU   5                       LAST CHARACTER SCANNED USED TO   00160420
*                                         COMPUTE LENGTH OF SCANNED     00162020
*                                         DATA                          00163620
XPCE     EQU   6                       IF CALLED BY PARSE, POINTS TO    00165220
*                                         THE CURRENT PCE. IF CALLED    00166820
*                                         BY COMMAND SCAN, NOT USED.    00168420
R7       EQU   7                       USED BUT RESTORED BASE REG.      00170002
*                                                                Y02666 00170202
R8       EQU   8                       WORK REGISTER                    00170402
LINK2    EQU   8                       SECOND LEVEL RETURN REGISTER     00171620
LINK1    EQU   9                       FIRST LEVEL RETURN REGISTER      00173220
R9       EQU   9                       WORK REGISTER                    00173602
R10      EQU   10                      NOT USED                         00174820
R11      EQU   11                      NOT USED                         00176420
R12      EQU   12                      NOT USED                         00178020
WORKBASE EQU   13                      BASE REGISTER FOR COMMON         00179620
*                                         WORKSPACE -- MUST BE 13       00181220
R14      EQU   14                      SCRATCH REGISTER                 00182820
R15      EQU   15                      REGISTER 15               Y02666 00183202
BASE     EQU   15                      LINKAGE REGISTER USED AS         00184420
*                                         BASE REGISTER                 00186020
*                                                                       00187620
* BIT SETTINGS FOR CHARACTER TYPES USED BY TYPETEST                     00189220
*                                                                       00190820
HEX      EQU   X'80'                   HEX CHARACTER                    00192420
OLETTER  EQU   X'40'                   LETTER NOT A HEX CHARACTER       00194020
NATL     EQU   X'20'                   NATIONAL CHARACTER               00195620
NUMBER   EQU   X'10'                   NUMBER                           00197220
SEPAR    EQU   X'08'                   SEPARATOR                        00198820
NSEPDLIM EQU   X'04'                   DELIMITER THAT IS NOT A          00200420
*                                         A SEPARATOR                   00202020
NDLIMSPC EQU   X'02'                   SPECIAL CHARACTER THAT IS NOT    00203620
*                                         ALSO A DELIMITER OR A         00205220
*                                         SEPARATOR                     00206820
CMDDLIM  EQU   X'01'                   COMMAND NAME DELIMITER           00208420
INVALID  EQU   X'00'                   INVALID CHARACTER                00210020
         SPACE                                                          00211620
*                                                                       00213220
* BIT PATTERNS USED TO TEST THE OPTIONS SELECTED BY THE PARSE USER AND  00214820
* REFLECTED IN VARIOUS BYTES IN THE PCE.                                00216420
*                                                                       00218020
PCEFPRPT EQU   B'00010000'             BIT 3  - PROMPT IS SPECIFIED     00219620
PCEFDFLT EQU   B'00001000'             BIT 4  - DEFAULT IS SPECIFIED    00221220
PCEFSUBF EQU   B'00000100'             BIT 5  - SUBFIELD IS SPECIFIED   00222820
PCEFHELP EQU   B'00000010'             BIT 6  - HELP IS SPECIFIED       00224420
PCEFVCHK EQU   B'00000001'             BIT 7  - VALIDITY CHECK EXIT IS  00226020
*                                         SPECIFIED                     00227620
PCEFLIST EQU   B'10000000'             BIT 8  - LIST IS SPECIFIED       00229220
PCEFASIS EQU   B'01000000'             BIT 9  - NO TRANSLATION REQUIRED 00230820
PCEFRNGE EQU   B'00100000'             BIT 10 - RANGE IS SPECIFIED      00232420
PCEFINST EQU   B'00010000'             BIT 11 - INSERT IS SPECIFIED     00234020
PCEFASTK EQU   B'10000000'             BIT 0 - ASTERISK IS ALLOWED      00235620
PCEFMAXL EQU   B'01000000'             BIT 1  - MAXLNTH IS SPECIFIED    00237220
PCEFINTG EQU   B'00010000'             BIT 3 - INTEGER VALUE     Y02666 00237602
PCEFCHAR EQU   B'00001000'             BIT 4 - CHARACTER VALUE   Y02666 00238002
PCEFHEX  EQU   B'00000100'             BIT 5 - HEXADECIMAL VALUE Y02666 00238402
         SPACE                                                          00238820
*                                                                       00240420
* OFFSETS FOR REQUIRED FIELDS IN PARSE PCE'S.                           00242020
*                                                                       00243620
PCEPCLLN EQU   0                       PCL LENGTH FIELD IN IKJPARM      00245220
PCEPDLLN EQU   2                       PDL LENGTH FIELD IN IKJPARM      00246820
PCEKYEND EQU   4                       IKJKEYWD OR END-OF-FIELD OFFSET  00248420
*                                         IN IKJPARM                    00250020
PCEFLGB1 EQU   0                       FLAG BYTE 1                      00251620
PCEFLGB2 EQU   1                       FLAG BYTE 2                      00253220
PCELEN   EQU   2 - 3                   PCE LENGTH                       00254820
PCEPDEO  EQU   4 - 5                   PDE OFFSET INTO PDL              00256420
PCEPOST  EQU   6                       TYPE OF POSITIONAL PARAMETER     00258020
PCENAML  EQU   4                       LENGTH OF NAME FOR IKJNAME       00259620
PCENAMN  EQU   5 - N                   NAME SPECIFIED                   00261220
PCEOPT   EQU   6                       IKJIDENT OPTION BYTE             00262820
PCEFIRST EQU   7                       IKJIDENT FIRST CHARACTER FLAGS   00264420
PCEOTHER EQU   8                       IKJIDENT OTHER CHARACTER FLAGS   00266020
PCEPARMT EQU   9                       IKJIDENT PARAMETER TYPE SEGMENT  00267620
         EJECT                                                          00269220
*                                                                       00270820
* MISCELLANEOUS EQUATES                                                 00272420
*                                                                       00274020
ZERO     EQU   0                       USED AS A 0                      00275620
ONE      EQU   1                       USED AS A 1                      00277220
TWO      EQU   2                       USED AS A 2                      00278820
THREE    EQU   3                       USED AS 3                 Y02666 00279202
FOUR     EQU   4                       USED AS A 4                      00280420
SIX      EQU   6                       USED AS SIX               Y02666 00280802
EIGHT    EQU   8                       USED AS A 8                      00282020
TWELVE   EQU   12                      USED AS A 12                     00283620
SIXTEEN  EQU   16                      USED AS 16                Y02666 00283702
TWENTY6  EQU   26                      USED AS 26                Y02666 00283802
TWENTY8  EQU   28                      USE TO SHIFT              Y02666 00284002
THIRTY1  EQU   31                      USED AS 31                Y02666 00284402
SEVEN    EQU   X'07'                                             Y02666 00285702
SEVENF   EQU   X'7F'                   FOR PACK INSTR.           Y02666 00288602
THIRTY2  EQU   32                                                Y02666 00289002
CC1      EQU   1                       CONDITION CODE 1                 00289902
CC5      EQU   5                       CONDITION CODE 5                 00291202
CC8      EQU   8                       CONDITION CODE 8                 00292502
CC10     EQU   10                      CONDITION CODE 10 (EQ OR GT)     00293100
CC13     EQU   13                      CONDITION CODE 13                00293802
IPDLMAXE EQU   10                      MAXIMUM INPUT STACKING DEPTH FOR 00295102
*                                         A INPUT PUSHDOWN STACK        00296402
ASTERISK EQU   C'*'                    ASTERISK                         00297702
LEFTPRN  EQU   C'('                    LEFT PARENTHESIS                 00299002
RIGHTPRN EQU   C')'                    RIGHT PARENTHESIS                00300302
QUOTE    EQU   X'7D'                   QUOTE                     Y02666 00301602
HE0      EQU   X'E0'                   USED TO OBTAIN TYPE INDICATOR    00302902
*                                         FROM PCE FLAG BYTE            00304202
HF0      EQU   X'F0'                   EBCDIC ZERO               Y02666 00305502
HF1      EQU   X'F1'                   EBCDIC ONE                Y02666 00306802
HYPHEN   EQU   X'60'                   USED TO CHECK FOR HYPEN IN DATA  00308102
*                                      SET NAME                  Y02666 00309402
TWELVE0  EQU   X'C0'                   USED TO TEST FOR 12-0 MULTIPUNCH 00310702
*                                      IN A DATA SET NAME        Y02666 00312002
HFF      EQU   X'FF'                   USED TO RESET FLAGS       Y02666 00313302
DSNFLG   EQU   X'01'                   DSNAME IN PROCESS         Y02666 00314602
VALTYPE  EQU   X'1C'                   TEST FOR VALUE TYPES      Y02666 00315902
HEXFLG   EQU   X'20'                   HEXADECIMAL SPECIFIED OR ENTERED 00317202
*                                                                Y02666 00318502
DECFLG   EQU   X'10'                   DECIMAL ENTERED           Y02666 00319802
BINFLG   EQU   X'08'                   BINARY ENTERED            Y02666 00321202
CHARFLG  EQU   X'04'                   CHARACTER SPECIFIED       Y02666 00321602
NUMFLG   EQU   X'02'                   INTEGER SPECIFIED         Y02666 00322002
PDEHEX   EQU   X'01'                   INDICATE HEXADECIMAL ENTERED     00322602
VALENDF  EQU   X'40'                   INDICATE THAT END OF BUFFER WAS  00323002
*                                      NOT REACHED DURING HEX AND INTEG 00323402
*                                      PROCESSING                Y02666 00323802
*                                                                Y02666 00326802
BINSTOR  EQU   X'20'                   USED TO INDICATE WHETHER TO      00327202
*                                      STORE A BYTE OR NOT WHEN         00328002
*                                      CONVERTING FROM HEX TO BINARY    00328102
*                                                                Y02666 00329302
         SPACE                                                          00340202
*                                                                       00341402
* PCE TYPE USED TO DETERMINE THE TYPE OF PCE BEING PROCESSED            00342602
*                                                                       00343802
KEYWDPCE EQU   X'40'                   KEYWORD PCE                      00345002
RSVDPCE  EQU   X'A0'                   RESERVED WORD PCE FOR     F41448 00346202
*                                      COBOL                     F41448 00347402
     EJECT                                                              00348602
GENSCAN  DS    0H                      GENERALIZED SCAN ROUTINE         00349802
         SPACE                                                          00351002
*                                                                       00352202
* ESTABLISH ADDRESSABILITY USING THE CALL REGISTER (R15) AS A           00353402
* BASE REGISTER.                                                        00354602
*                                                                       00355802
         USING *,BASE                  ESTABLISH ADDRESSABILITY         00357002
*                                         FOR GENSCAN                   00358202
         MODID BRANCH=YES              FLAG                      Y01886 00359402
         USING PWORK,WORKBASE          ESTABLISH ADDRESSABILITY TO      00360602
*                                         COMMON WORKAREA               00361802
         L     R3,PDWORD               GET PTR TO GENSCAN CONTROL INFO  00363002
         USING GCONTROL,R3             ESTABLISH ADDRESSABILITY TO      00364202
*                                         GENSCAN CONTROL INFORMATION   00365402
         ST    LINK2,PLINKSV1          SAVE RETURN REGISTER      Y02666 00366602
         ST    R7,P20SAVE              SAVE BASE REG.FOR IKJEFP00Y02666 00367002
         LA    XINPUT,ONE(XINPUT)      GET NEXT CHARACTER               00367802
         TM    GOPTIONS,VALTYPE        IS VALUE TYPE PROCESSING         00369002
*                                      REQUIRED?                 Y02666 00370202
         BM    VALPROC                 YES, GO PROCESS IT        Y02666 00371402
         CLC   GFIRST(L'GFIRST+L'GOTHER),H0 IS THIS AN ANY/ANY          00372602
*                                         COMBINATION                   00373802
         BZ    GS02                    IF YES BRANCH --- IF ASTERISK    00375002
*                                         WAS SUPPLIED IT IS REDUNDANT  00376202
*                                         WITH ANY/ANY OPTIONS          00377402
         SPACE                                                          00378602
         TM    GOPTIONS,ASTKALWD       IS AN ASTERISK ALLOWED           00379802
         BZ    GS02                    NO, CONTINUE                     00381002
         SPACE                                                          00382202
         CLI   ZERO(XINPUT),ASTERISK   IS THERE AN ASTERISK IN THE      00383402
*                                         BUFFER                        00384602
         BNE   GS02                    NO, CONTINUE                     00385802
         SPACE                                                          00387002
GS015    DS    0H                      ONE CHARACTER RETURN             00388202
         LA    XINPUT,ONE(XINPUT)      GET NEXT CHARACTER               00389402
         LR    XINPUTB,XINPUT          SET LAST CHAR SCANNED            00390602
         C     XINPUTB,ENDINPUT        IS SCAN AT END OF CURRENT INPUT  00391802
         BNL   VALTST                  YES,RETURN INDICATING THE Y02666 00393002
*                                         PARAMETER IS GOOD AND ENDED   00394202
*                                         AT THE END OF THE BUFFER      00395402
         TM    PFLAGS6,HEXFLG+NUMFLG   PROCESSING HEX OR NUMBER? Y02666 00396602
         BM    VALIDVAL                YES,GO CHECK DELIMITER    Y02666 00397802
         BO    VALIDVAL                                          Y02666 00399002
         SPACE                                                          00400202
GSRET    DS    0H                                                Y02666 00400602
         NI    PFLAGS6,HFF-CHARFLG-HEXFLG-NUMFLG-DECFLG-BINFLG   Y02666 00401002
         B     TWELVE(LINK2)           NO, RETURN +12 INDICATING THE    00401402
*                                         PARAMETER IS GOOD BUT THE     00402602
*                                         DELIMITER MUST BE CHECKED     00403802
         SPACE                                                          00405002
GS02     DS    0H                      CHECK FIRST CHARACTER            00406202
         XR    R2,R2                   CLEAR DEPTH METER                00407402
         XR    R1,R1                   CLEAR WORK REG                   00408602
         TM    PFLAGS6,CHARFLG         CHARACTER VALUE TYPE?     Y02666 00409802
         BO    GS11                    YES, PROCESS 'ANY','ANY'  Y02666 00411002
         TM    PFLAGS6,NUMFLG+HEXFLG      ANY VALUE TYPE PROCESSING?    00412202
*                                                                Y02666 00413402
         BM    GS12                    YES,PROCESS AS 'ANY' TYPE Y02666 00414602
         BO    GS12                                              Y02666 00415802
         IC    R1,GFIRST               GET FIRST CHARACTER TYPE         00417002
*                                         INDICATOR AND USE AS INDEX    00418202
*                                         INTO TYPE DESIRED TABLE       00419402
GS11     DS    0H                                                Y02666 00420602
         IC    R1,CHARTYPE(R1)         SET TYPE DESIRED FOR TYPETEST    00421802
GS12     DS    0H                                                Y02666 00423002
         BAL   LINK1,TYPETEST          TEST FIRST CHARACTER SYNTAX      00424202
         SPACE                                                          00425402
         B     GSMISS                  +0 RETURN - THE FIRST CHARACTER  00426602
*                                         IS INVALID.  RETURN IS TO     00427802
*                                         LINK2+0 INDICATING THE        00429002
*                                         PARAMETER IS MISSING          00430202
*                                                                       00431402
*                                      +4 RETURN - THE FIRST CHARACTER  00432602
*                                         IS VALID, CONTINUE            00433802
         SPACE                                                          00435002
         CLI   ZERO(XINPUT),LEFTPRN    IS THE CHARACTER A LEFT PAREN    00436202
         BNE   GS03                    IF NO SKIP SETTING OF DEPTH      00437402
*                                         METER                         00438602
         SPACE                                                          00439802
         LA    R2,ONE                  SET DEPTH METER TO ONE           00441002
         SPACE                                                          00442202
GS03     DS    0H                      * * * *                          00443402
         ST    XINPUT,PPOINTR          SAVE PTR TO PARM                 00444602
         TM    GOPTIONS,MAXLSPEC       IS A MAX LENGTH SPECIFIED        00445802
         BZ    GS04                    NO, CONTINUE                     00447002
         SPACE                                                          00448202
         CLI   GMAXLNTH,ONE            IS THE MAX LENGTH 1              00449402
         BE    GS015                   YES, RETURN AS WITH ASTERISK     00450602
         SPACE                                                          00451802
         XR    R0,R0                   ZERO LOOP CONTROL REG            00453002
         IC    R0,GMAXLNTH             USE MAXLENGTH FOR CONTROL OF     00454202
*                                         SCAN LOOP                     00455402
         SPACE                                                          00456602
GS04     DS    0H                      * * * *                          00457802
         TM    PFLAGS6,CHARFLG+NUMFLG+HEXFLG SPECIAL VALUE TYPE? Y02666 00459002
         BM    GSLOOP                  YES,INDICATOR ALREADY SET Y02666 00460202
         XR    R1,R1                   CLEAR WORK REG                   00461402
         IC    R1,GOTHER               GET OTHER CHARACTER TYPE         00462602
*                                         INDICATOR AND USE AS INDEX    00463802
*                                         INTO TYPE DESIRED TABLE       00465002
         IC    R1,CHARTYPE(R1)         SET TYPE DESIRED FOR TYPETEST    00466202
         SPACE                                                          00467402
GSLOOP   DS    0H                      OTHER LOOP                       00468602
*                                                                       00468702
*        UPDATE POINTER TO CHECK THE NEXT INPUT CHARACTER        Y02666 00469002
*                                                                       00469402
         LA    XINPUT,ONE(XINPUT)      GET NEXT CHARACTER               00469802
         LR    XINPUTB,XINPUT          SET LAST CHARACTER SCANNED       00471002
         C     XINPUT,ENDINPUT         IS SCAN AT END OF CURRENT INPUT  00472402
         BNL   VALTST                                                   00473802
         LA    R14,ONE(XINPUT)         GET NEXT BYTE ADDRESS     YM3610 00474002
         C     R14,ENDINPUT            IS END OF BUFFER NEXT     YM3610 00474202
         BC    CC10,GSTEST             BYPASS COMMENT DELIM TEST  M4540 00474400
         CLC   ZERO(TWO,XINPUT),SLASHAST COMMENT DELIMITER?      Y02666 00474602
         BNE   GSTEST                  NO, CONTINUE              Y02666 00475002
COMBYPAS DS    0H                                                YM3610 00476002
         TM    PFLAGS6,HEXFLG+NUMFLG   PROCESSING HEX OR INTEGER Y02666 00478302
         BZ    GSRET                   NO,RETURN                 Y02666 00480302
         B     VALIDVAL                GO PROCESS VALUE          Y02666 00480402
         SPACE                                                          00480602
GSTEST   DS    0H                                                Y02666 00481202
         BAL   LINK1,TYPETEST          TEST CHARACTER SYNTAX            00481802
         SPACE                                                          00483002
         B     GS06                   +0 RETURN - THE CHARACTER IS      00484202
*                                         AN INVALID OTHER CHARACTER.   00485402
*                                         SEE IF THE DEPTH METER        00486602
*                                         SHOULD BE CHECKED             00487802
         SPACE                                                          00489002
*                                      +4 RETURN - THE CHARACTER IS     00490202
*                                         A VALID OTHER CHARACTER,      00491402
*                                         CONTINUE                      00492602
         TM    PFLAGS6,CHARFLG         CHARACTER PROCESSING?     Y02666 00493802
         BO    GS09                    PROCESS AS 'ANY' TYPE     Y02666 00495002
         TM    PFLAGS6,HEXFLG+NUMFLG   HEX OR INTEGER?           Y02666 00496202
         BM    GS05                    GET MAXIMUM LENGTH        Y02666 00497402
         BO    GS05                                              Y02666 00498602
         SPACE                                                          00499802
         CLI   GOTHER,ZERO             IS THE OTHER CHARACTER AN ANY    00501002
         BNE   GS05                    IF NO SKIP OVER FURTHER CHECKS   00502202
GS09     DS    0H                                                Y02666 00503402
         SPACE                                                          00504602
         CLI   ZERO(XINPUT),LEFTPRN    IS THE NEXT CHARACTER A LEFT     00505802
*                                         PARENTHESIS                   00507002
         BNE   GS05                    IF NO SKIP SETTING DEPTH METER   00508202
         SPACE                                                          00509402
         LA    R2,ONE(R2)              INCREMENT DEPTH METER BY ONE     00510602
         SPACE                                                          00511802
GS05     DS    0H                      * * * *                          00513002
         TM    GOPTIONS,MAXLSPEC       IS A MAX LENGTH SPECIFIED        00515602
         BZ    GSLOOP                  NO, SCAN NEXT CHAR               00515702
         SPACE                                                          00515802
         BCT   R0,GSLOOP               YES, DECREMENT LENGTH AND TEST   00517202
*                                         FOR 0, IF GREATER THAN 0 SCAN 00518602
*                                         NEXT CHARACTER                00520020
GS4      DS    0H                                                Y02666 00521002
         NI    PFLAGS6,HFF-HEXFLG-CHARFLG-NUMFLG-BINFLG-DECFLG          00522002
*                                      RESET VALUE TYPE FLAGS    Y02666 00524002
         SPACE                                                          00530020
         B     FOUR(LINK2)             IF R0 REACHES 0, THE             00540020
*                                      MAXIMUM LENGTH HAS BEEN          00541020
*                                      EXCEEDED.  RETURN IS TO LINK2+4  00542020
*                                      INDICATING THE PARAMETER IS      00543020
*                                      INVALID                          00544020
VALTST   DS    0H                                                Y02666 00544102
*                                                                       00544402
*      END OF BUFFER WAS REACHED. CHECK FOR PARAMETER TYPE       Y02666 00545202
*                                                                       00545302
         TM    PFLAGS6,NUMFLG+HEXFLG   HEX OR INTEGER?           Y02666 00545402
         BZ    GSRET8                  RETURN + 8, PARAMETER            00545702
*                                         IS GOOD AND ENDED AT          00546002
*                                         THE END OF THE BUFFER  Y02666 00546302
         B     VALINTGR                TEST FOR VALID INTEGER    Y02666 00546602
GSRET8   DS    0H                                                Y02666 00546702
         NI    PFLAGS6,HFF-CHARFLG-HEXFLG-DECFLG-NUMFLG-BINFLG   Y02666 00546802
         B     EIGHT(LINK2)                                             00546902
         SPACE                                                          00567102
GS06     DS    0H                      * * * *                          00567402
         CLI   ZERO(XINPUT),HYPHEN     IS CHARACTER A HYPHEN     Y02666 00568402
         BE    GS05                    YES, CHARACTER IS VALID   Y02666 00568702
         CLI   ZERO(XINPUT),TWELVE0    IS CHARACTER A 12-0 PUNCH Y02666 00569002
         BE    GS05                    YES, CHARACTER IS VALID   Y02666 00569302
GS08     DS    0H                                                       00569602
         TM    PFLAGS6,CHARFLG         CHARACTER VALUE TYPE      Y02666 00569902
         BO    GS10                    YES,PROCESS AS 'ANY' TYPE Y02666 00570202
         TM    PFLAGS6,HEXFLG+NUMFLG  HEXADEC/INTEGER SPECIFIED? Y02666 00570502
         BO    VALIDVAL                PROCESS VALID VALUE       Y02666 00570802
         BM    VALIDVAL                                          Y02666 00571102
         CLI   GOTHER,ZERO             IS THE OTHER CHARACTER AN ANY    00571402
         BNE   GSRET                   RETURN TO LINK2+12 INDICATING    00571702
*                                         THE PARAMETER IS GOOD BUT THE 00572002
*                                         DELIMITER MUST BE CHECKED     00572302
         SPACE                                                          00572602
GS10     DS    0H                                                Y02666 00572902
         CLI   ZERO(XINPUT),RIGHTPRN   IS CHARACTER A RIGHT PAREN       00573202
         BNE   GSRET                   IF NO EXIT                       00573502
         SPACE                                                          00573802
         BCTR  R2,ZERO                 DECREMENT DEPTH METER            00574102
         LTR   R2,R2                   IS THIS THE END OF THE PARAMETER 00574402
         BM    GSRET                   IF YES EXIT                      00574702
         SPACE                                                          00575002
         B     GS05                    NOT PARAMETER END CONTINUE SCAN  00575302
GSMISS   DS    0H                                                       00575602
         NI    PFLAGS6,HFF-CHARFLG-HEXFLG-NUMFLG-DECFLG-BINFLG          00575902
*                                      TURN OFF FLAGS IN CASE NOPROMPT  00576202
         B     ZERO(LINK2)             RETURN TO NSI                    00576502
         EJECT                                                          00576802
*********************************************************************** 00577102
*                                                                     * 00577402
*           ENTRY FOR PROCESSING THE SPECIFIC VALUE TYPES.            * 00577702
*        WHENEVER THE CHAR, HEX, AND INTEG OPERANDS ARE SPECIFIED     * 00578002
*        ON THE IKJIDENT MACRO, THIS ROUTINE WILL GET CONTROL TO      * 00578302
*        PERFORM THE NEEDED PROCESSING. HERE IT IS DETERMINED WHICH OF* 00578602
*        THE OPTIONS WAS SPECIFIED.                                   * 00578902
*                                                                     * 00579202
*********************************************************************** 00579502
VALPROC  DS    0H                                                Y02666 00579802
         TM    GOPTIONS,PCEFINTG       WAS INTEGER OPTION SPEC.? Y02666 00580102
         BO    VALNUMT                 YES, PROCESS INTEGER TYPE Y02666 00580402
         TM    GOPTIONS,PCEFCHAR       IS CHARACTER SPECIFIED?   Y02666 00580702
         BO    VALCHAR                 YES, GO PROCESS           Y02666 00581002
         CLC   ZERO(TWO,XINPUT),EXQTE  IS INPUT A HEX VALUE      Y02666 00581302
         BE    VALHEXT                 YES, PROCESS A HEX  VALUE Y02666 00581602
         CLC   ZERO(TWO,XINPUT),EXXQTE IS INPUT A HEX VALUE      Y02666 00581902
         BE    VALHEXT                 YES, PROCESS A HEX  VALUE Y02666 00582402
*********************************************************************** 00582602
*                                                                     * 00582902
*    A VALUE TYPE IS PROCESSED AS A CHARACTER VALUE IF:               * 00583202
*    1. THE 'CHAR' PARAMETER IS SPECIFIED ON THE IKJIDENT MACRO.      * 00583602
*    2. IF 'HEX' IS SPECIFIED AND THE USER'S INPUT IS NOT DELIMITED   * 00583902
*       BY THE X'...' CHARACTERS.                                     * 00584002
*                                                                     * 00584502
*********************************************************************** 00584602
VALCHAR  DS    0H                                                Y02666 00585102
         OI    PFLAGS6,CHARFLG         INDICATE CHARACTER VALUE TYPE    00585402
*                                      PROCESSING                Y02666 00585702
         CLI   ZERO(XINPUT),QUOTE      IS FIRST CHAR. A QUOTE?   Y02666 00586002
         BE    VAL01                   PROCESS AS QUOTED STRING  Y02666 00586102
         B     GS02                    PROCESS AS 'ANY' TYPE     Y02666 00586602
VAL01    DS    0H                                                Y02666 00586802
*                                                                       00587202
*      PROCESS THE QUOTED STRING BY USING THE QSTRING ROUTINE IN MODULE 00587402
*      IKJEFP00                                                  Y02666 00587802
*                                                                       00588002
         L     R2,QSTRNGAD             GET QSTRING RTN PTR       Y02666 00588402
         ST    R15,P20SAVE+FOUR        SAVE P20 BASE REG.        Y02666 00588602
         BALR  LINK2,R2                GO PROCESS                Y02666 00589002
         L     R15,P20SAVE+FOUR        RESTORE BASE REG.         Y02666 00589202
         L     R3,PDWORD               RESTORE OPTIONS PTR.      Y02666 00589602
*                                      IT WAS DESTROYED BY QSTRING RTN  00589802
         NI    PFLAGS6,HFF-CHARFLG     TURN OFF FLAG             Y02666 00590202
         TM    GOPTIONS,MAXLSPEC       MAXIMUM LENGTH SPECIFIED? Y02666 00590502
         BZ    VALTEXIT                NO, RETURN                Y02666 00590602
         LR    R1,XINPUTB              GET SCAN PTR              Y02666 00590902
         S     R1,PPOINTR              COMPUTE LENGTH            Y02666 00591202
         XR    R0,R0                   CLEAR WORK REG.           Y02666 00591502
         IC    R0,GMAXLNTH             GET MAXIMUM LENGTH        Y02666 00592002
         L     LINK2,PLINKSV1          RESTORE RETURN REG.       Y02666 00592302
         CR    R1,R0                   CHECK LENGTH              Y02666 00592602
         BH    GS4                     IF TO0 LONG, - INVALID    Y02666 00592902
         B     VALEXIT1                NO,RETURN AS VALID        Y02666 00593202
         EJECT                                                          00593502
*********************************************************************** 00593602
*                                                                     * 00594002
*    THIS IS THE HEXADECIMAL NUMBER PROCESSING ROUTINE. CONTROL IS    * 00594402
*   RECEIVED HERE ONLY IF THE NUMBER IS ENTERED IN THE X'...' FORMAT  * 00594702
*   AND THE PARAMETER, 'HEX' OR 'INTEG' WAS SPECIFIED.                * 00595002
*                                                                     * 00595202
*********************************************************************** 00595602
VALHEXT  DS    0H                                                Y02666 00595802
         LA    XINPUT,TWO(XINPUT)      UPDATE PAST HEX INDICATOR Y02666 00596202
         ST    XINPUT,PPOINTR          SAVE PTR TO HEX STRING    Y02666 00596402
         LR    XINPUTB,XINPUT          SET BACKUP REGISTER       Y02666 00596802
         OI    PFLAGS6,HEXFLG          INDICATE HEX PROCESSING   Y02666 00597002
         LA    R1,HEX+NUMBER           GET TABLE INDEX TYPE      Y02666 00597402
         SR    R2,R2                   CLEAR LEVELS CTR          Y02666 00597602
         B     GS12                    GO PROCESS                Y02666 00598002
VALIDHEX DS    0H                                                Y02666 00598202
         SPACE                                                          00598602
*    A VALID HEXADECIMAL VALUE HAS BEEN FOUND.                        * 00598802
         SPACE                                                          00599202
         LR    R7,XINPUTB              GET DATA END PTR          Y02666 00599502
         S     R7,PPOINTR              COMPUTE LENGTH            Y02666 00599802
         STH   R7,P20SAVE+FOUR         SAVE LENGTH               Y02666 00600102
         TM    GOPTIONS,PCEFINTG       PROCESSING INTEGER?       Y02666 00600302
         BZ    HEXNINT                 NO, GET CORE              Y02666 00600502
         BCTR  R1,ZERO                 DECREMENT INTEGER PTR.    Y02666 00600702
         LR    R14,R1                  GET OUTPUT PTR            Y02666 00600902
         TM    PFLAGS6,BINFLG          A BINARY NUMBER?          Y02666 00601102
         BZ    GET16                   NO,GET 16 AS LENGTH       Y02666 00601302
         LA    R7,THIRTY2              YES, GET 32 AS MAXLENGTH  Y02666 00601502
         B     SETLEN                  RESET LENGTH              Y02666 00601702
GET16    DS    0H                                                Y02666 00601902
*      GET LENGTH OF HEX OR DECIMAL INPUT AREA                   Y02666 00602102
         LA    R7,SIXTEEN              GET LENGTH OF INPUT AREA  Y02666 00602302
SETLEN   DS    0H                                                Y02666 00602502
*       SET THE LENGTH OF THE INTEGER                            Y02666 00602702
         LR    R2,R7                   GET LENGTH OF OUTPUT AREA Y02666 00602902
         SR    R8,R8                   CLEAR WORK REG            Y02666 00603102
         B     CONVT1                  GO CONVERT                Y02666 00603302
HEXNINT  DS    0H                                                Y02666 00605202
*      PREPARE TO GET CORE FOR AND CONVERT A HEXADECIMAL NUMBER  Y02666 00605402
         LR    R1,R7                   SAVE LENGTH OF INPUT      Y02666 00605802
         LA    R1,ONE(R1)              COMPUTE LENGTH OF OUTPUT  Y02666 00606002
         SRL   R1,ONE                  DIVIDE BY TWO             Y02666 00606402
         L     R7,P20SAVE              RESTORE IKJEFP00 BASE REG Y02666 00606602
         LR    R3,R15                  SAVE BASE REG. AROUND GETMAIN    00607002
*                                                                Y02666 00607202
         STH   R1,PLENGTH              SAVE LENGTH               Y02666 00607602
         L     R2,STALOCP              GET GETMAIN RTN PTR       Y02666 00607802
         BALR  LINK2,R2                GO TO GET CORE            Y02666 00608202
         LR    R15,R3                  RESTORE BASE REG.         Y02666 00608402
         LH    R7,P20SAVE+FOUR         GET DATA LENGTH           Y02666 00608802
         EJECT                                                          00609002
*********************************************************************** 00609402
*                                                                     * 00609602
*   THIS ROUTINE USES A TABLE TO CONVERT HEXADECIMAL CHARACTERS TO    * 00610002
*    VALID HEXADECIMAL DIGITS. THE LENGTH OF THE VALUE IS NOT         * 00610202
*    LIMITED BY THIS ROUTINE.                                         * 00610602
*                                                                     * 00610802
*********************************************************************** 00611202
CONVERTX DS    0H                                                Y02666 00611402
         L     R3,PDWORD               RESTORE REG. 3            Y02666 00611802
         LH    R2,PLENGTH              GET LENGTH OF STRING      Y02666 00612002
         MVI   ZERO(R1),ZERO           ZERO CORE                 Y02666 00612202
         L     R14,PPOINTR             GET STRING PTR            Y02666 00612402
         BCTR  R14,ZERO                DECREMENT PTR FOR INDEXNG Y02666 00612602
         SR    R8,R8                   CLEAR TEMP. WORK REG.     Y02666 00613302
         BCTR  R1,ZERO                 DECREMENT PTR FOR INDEXNG Y02666 00613602
CONVT1   DS    0H                                                Y02666 00613902
*      GET THE FIRST BYTE FOR FIRST HALF OF THE HEXADECIMAL NUMBER      00614202
*                                                                Y02666 00614502
         IC    R8,ZERO(R7,R14)         GET LOWORDER BYTE         Y02666 00614802
         IC    R8,CONVTAB(R8)          GET TRUE HEX VALUE        Y02666 00615002
         SRDL  R8,THIRTY2              SHIFT DIGIT TO NEXT REG   Y02666 00615402
         BCT   R7,CONVA                DECREMENT LENTH -CONTINUE Y02666 00615602
         LA    R7,ONE                  REST FROM ZERO FOR NEXT          00616002
*                                      DECREMENT                 Y02666 00616202
         B     VALXSTOR                STORE LAST BYTE           Y02666 00616602
CONVA    DS    0H                                                Y02666 00616802
*      GET NEXT BYTE FOR 2ND HALF OF HEXADECIMAL NUMBER          Y02666 00617202
         IC    R8,ZERO(R7,R14)         GET NEXT BYTE             Y02666 00617402
         IC    R8,CONVTAB(R8)          GET TRUE VALUE            Y02666 00617802
VALXSTOR DS    0H                                                Y02666 00618002
*      STORE THE HEXADECIMAL BYTE                                Y02666 00618402
         SLL   R9,TWENTY8              PLACE DIGIT IN HIGH BYTE  Y02666 00618602
         SLDL  R8,FOUR                 MAKE DIGITS CONTIGUOUS    Y02666 00619002
         STC   R8,ZERO(R2,R1)          STORE BYTE                Y02666 00619202
         BCTR  R2,ZERO                 DECREMENT AFTER STORING   Y02666 00619602
         BCT   R7,CONVT1               DECREMENT AND CONTINUE    Y02666 00619802
         LA    R1,ONE(R1)              RESET PTR AFTER DECREMENT Y02666 00620002
         TM    PFLAGS6,NUMFLG          INTEGER VALUE?            Y02666 00620502
         BO    BINCOMP                 YES,GO COMPARE            Y02666 00620702
CONVEND  DS    0H                                                Y02666 00620902
*      PREPARE TO RETURN TO MAINLINE ROUTINE                     Y02666 00621102
         ST    R1,PPOINTR              SAVE PTR TO GOTTEN CORE   Y02666 00621302
         OI    PFLAGS6,PDEHEX          INDICATE HEX INPUT        Y02666 00621502
         B     VALTEXIT                RETURN TO IKJIDENT PROCESSOR     00621702
*                                                                Y02666 00622602
         EJECT                                                          00622802
*********************************************************************** 00623002
*                                                                     * 00623302
*    DETERMINE THE KIND OF INTEGER ENTERED AND SET CONTROL FOR        * 00623702
*    FOR DETERMINING A VALID DECIMAL INTEGER.                         * 00624102
*                                                                     * 00624302
*********************************************************************** 00624502
VALNUMT  DS    0H                                                Y02666 00624702
         OI    PFLAGS6,NUMFLG          INDICATE AN INTEGER       Y02666 00624902
         CLC   ZERO(TWO,XINPUT),BINQTE TEST FO BINARY            Y02666 00625102
         BE    VALBINT                 PROCESS BINARY            Y02666 00625302
         CLC   ZERO(TWO,XINPUT),BINNQTE BINARY?                  Y02666 00625502
         BE    VALBINT                 PROCESS BINARY            Y02666 00626302
         CLC   ZERO(TWO,XINPUT),EXQTE  HEX INTEGER?              Y02666 00626602
         BE    VALHEXT                 PROCESS AS HEX            Y02666 00626902
         CLC   ZERO(TWO,XINPUT),EXXQTE HEX INTEGER               Y02666 00627202
         BE    VALHEXT                 PROCESS HEX               Y02666 00627502
         OI    PFLAGS6,DECFLG          INDICATE A DECIMAL INTEGR Y02666 00627802
         B     VALNUMBR                PROCESS DECIMAL           Y02666 00628302
VALBINT  DS    0H                                                Y02666 00628502
*      INDICATE A BINARY INTEGER IS IN PROCESS                   Y02666 00628702
         OI    PFLAGS6,BINFLG          INDICATE BINARY           Y02666 00628902
         LA    XINPUT,TWO(XINPUT)      BYPASS INDICATOR          Y02666 00629102
VALNUMBR DS    0H                                                Y02666 00629302
*      SET INPUT POINTER AND GO TO VALIDATE CHARACTERS           Y02666 00629502
*      PPOINTER IS USED TO GET THE LENGTH OF THE INPUT           Y02666 00630302
         ST    XINPUT,PPOINTR          RESET PTR TO STRING       Y02666 00630502
         LA    R1,NUMBER               GET TABLE INDEX VALUE     Y02666 00630702
         SR    R2,R2                   CLEAR LEVELS CTR.         Y02666 00630902
         B     GS12                    GO PROCESS                Y02666 00631102
         EJECT                                                          00631302
*********************************************************************** 00631502
*                                                                     * 00632302
*    THIS IS THE ABNORMAL OR ERROR EXIT ROUTINE FOR THE 'INTEG'       * 00632702
*    AND 'HEX' PROCESSING ROUTINES.                                   * 00633102
*                                                                     * 00633302
*********************************************************************** 00633502
VALINV   DS    0H                                                Y02666 00634002
         NI    PFLAGS6,HFF-HEXFLG-NUMFLG-BINFLG-DECFLG-CHARFLG RESET    00634302
         NI    PFLAGS7,HFF-VALENDF     FLAGS                     Y02666 00634402
         L     R7,P20SAVE              RESTORE BASE REG.         Y02666 00634802
         L     LINK2,PLINKSV1          RESTORE RETURN PTR        Y02666 00635202
         L     R2,INVPSAVE             GET PTR TO INPUT          Y02666 00635402
         ST    R2,PPOINTR              RESET DATA PTR            Y02666 00635802
         B     FOUR(LINK2)             RETURN - INVALID          Y02666 00636002
         EJECT                                                          00636402
*********************************************************************** 00636602
*                                                                     * 00637002
*      CONTROL IS RECEIVED HERE FOR THE PURPOSE OF CHECKING THE       * 00637202
*      DELIMITER. IF IT IS VALID, CONTROL IS PASSED TO THE VALINTGR   * 00637602
*      ROUTINE. IF INVALID, CONTROL IS PASSED TO THE VALINV ROUTINE.  * 00637802
*                                                                     * 00638202
*********************************************************************** 00638502
VALIDVAL DS    0H                                                Y02666 00638802
         OI    PFLAGS7,VALENDF         INDICATE NOT END OF BUFFERY02666 00639002
         L     R2,RANGEP               GET RANGE PROCESSOR PTR.  Y02666 00639202
         BALR  LINK1,R2                CHECK FOR POSSIBLE RANGE  Y02666 00639502
         B     VALDELC                 NO RANGE, CHECK DELIMITR  Y02666 00639802
         B     VALNQTE                 YES, SEE IF PERMISSABLE   Y02666 00640102
VALDELC  DS    0H                                                Y02666 00640402
*      THE NEXT CHARACTER IS NOT A COLON. CHECK FOR VALID DELIMITER     00640702
*      OR A SEPARATOR.                                           Y02666 00641002
         LA    R14,ONE(XINPUT)         GET NEXT BYTE ADDRESS     YM3610 00641202
         C     R14,ENDINPUT            IS IT END OF BUFFER       YM3610 00641502
         BC    CC10,COMBYPS2           YES,BYPASS COMMENT DELIM TEST    00641900
*                                                                 M4540 00647900
         CLC   ZERO(TWO,XINPUT),SLASHAST CHECK FOR COMMENT       Y02666 00661902
         BE    VALNQTE                 YES,SEE IF ALLOWED        Y02666 00668402
COMBYPS2 DS    0H                                                YM3610 00668602
         LA    R1,SEPAR+NSEPDLIM       GET INDEX FOR SEPARATOR          00668802
*                                      OR DELIMITER TEST         Y02666 00669002
         BAL   LINK1,TYPETEST          TEST                      Y02666 00669202
         B     VALQTEST                INVALID DELIMITER,TEST FOR QUOTE 00669402
*                                                                Y02666 00669602
VALNQTE  DS    0H                                                Y02666 00669802
*      A VALID DELIMITER OR SEPARATOR WAS FOUND                  Y02666 00670402
         TM    PFLAGS6,HEXFLG+BINFLG   PROCESSING BINARY/HEX?    Y02666 00670802
         BM    VALINV                  NO, DELIMITR IS INVALID   Y02666 00671002
         LR    XINPUTB,XINPUT          GET BACKUP SCAN PTR       Y02666 00671402
         B     VALINTGR                PROCESS VALID INTEGER     Y02666 00671602
         SPACE                                                          00672002
VALQTEST DS    0H                                                Y02666 00672202
*  THE QUOTE IS THE ONLY INVALID DELIMITER ALLOWED. THIS IS SO ONLY IF* 00672402
*    IF THE NUMBER IS BINARY OR HEXADECIMAL.                          * 00672802
         SPACE                                                          00673202
         CLI   ZERO(XINPUT),QUOTE      IS INVALID A QUOTE        Y02666 00673402
         BNE   VALINV                  PROCESS AS INVALID        Y02666 00673602
         TM    PFLAGS6,HEXFLG+BINFLG   IS QUOTE NEEDED?          Y02666 00674002
         BZ    VALINV                  NO,PROCESS AS INVALID     Y02666 00674302
         LR    XINPUTB,XINPUT          SET BACKUP FOR LENGTH     Y02666 00674602
         LA    XINPUT,ONE(XINPUT)      UPDATE PAST QUOTE         Y02666 00674902
         EJECT                                                          00675202
*********************************************************************** 00675502
*                                                                     * 00675802
*    CONTROL IS RECEIVED HERE WHEN IT IS DETERMINED THAT A VALID      * 00676102
*    INTEGER EXISTS. PROCESSING CONTINUES TO VALIDATE THE SIZE AND    * 00676402
*    TO CONVERT THE NUMBER TO A VALID HEXADECIMAL INTEGER WHICH CAN BE* 00676702
*    BE USED IN ANY NUMERIC COMPUTATION OR AS THE USER SEES FIT.      * 00677002
*                                                                     * 00677302
*********************************************************************** 00677602
VALINTGR DS    0H                                                Y02666 00677902
         TM    GOPTIONS,PCEFHEX         A HEX VALUE?             Y02666 00678202
         BO    VALIDHEX                YES, PROCESS AS VALID     Y02666 00678502
         L     R8,PPOINTR              GET DATA PTR              Y02666 00678802
         LR    R2,XINPUTB              GET PTR                   Y02666 00679102
         SR    R2,R8                   COMPUTE DATA LENGTH       Y02666 00679402
         TM    PFLAGS6,BINFLG          BINARY NUMBER             Y02666 00679702
         BZ    CHECKHEX                NO, CHECK DECIMAL         Y02666 00680002
         CH    R2,MAXBINL              IS LENGTH TOO BIG?        Y02666 00680302
         BH    VALINV                  YES, INVALID              Y02666 00680602
         B     BINTST                  CONTINUE BINARY PROCESS   Y02666 00680902
CHECKHEX DS    0H                                                Y02666 00681202
*                                                                       00681502
*      CHECK FOR MAXIMUM HEXADECIMAL INTEGER LENGTH              Y02666 00681802
*                                                                       00682102
         TM    PFLAGS6,HEXFLG          IS HEX NUMBER             Y02666 00682402
         BZ    CHECKDEC                NO,CHECK INTEGER          Y02666 00682702
         CH    R2,MAXHEXL              IS NUMBER TOO BIG         Y02666 00683002
         BH    VALINV                  YES, INVALID.             Y02666 00683302
         B     VALPTR                  CONTINUE HEX PROCESS      Y02666 00683602
CHECKDEC DS    0H                                                Y02666 00683902
*                                                                       00684202
*      CHECK FOR MAXIMUM DECIMAL INTEGER LENGTH                  Y02666 00684502
*                                                                       00684802
         CH    R2,MAXNUML              IS NUMBER TOO LARGE?      Y02666 00685102
         BH    VALINV                  YES, PROCESS AS INVALID   Y02666 00685402
         B     VALPTR                                            Y02666 00685702
BINTST   DS    0H                                                Y02666 00686002
*      THE FOLLOWING CODE INSURES THAT EACH DIGIT IS A VALID BINARY     00686302
*      DIGIT (0-1).                                              Y02666 00686602
         LR    R1,R8                   GET PTR FOR LOOP          Y02666 00686902
         LR    R9,R2                   KEEP LENGTH FOR LOOP CTL. Y02666 00687202
         SPACE                                                          00687502
VALBIN   DS    0H                                                Y02666 00687802
*    DETERMINE IF THE BINARY DIGITS ARE VALID                         * 00688102
         SPACE                                                          00688402
         CLI   ZERO(R1),HF0            IS VALID BINARY CHAR.?    Y02666 00688702
         BE    VALBCT                  YES CONTINUE              Y02666 00689002
         CLI   ZERO(R1),HF1            VALID BINARY CHAR.?       Y02666 00689302
         BNE   VALINV                  PROCESS AS INVALID        Y02666 00689602
VALBCT   DS    0H                                                Y02666 00689902
         LA    R1,ONE(R1)              UPDATE TO NEXT CHARACTER  Y02666 00690102
         BCT   R9,VALBIN               VALID INPUT,CONTINUE      Y02666 00690602
         SPACE                                                          00690802
VALPTR   DS    0H                                                Y02666 00691002
*                                                                       00691202
*    PREPARE TO CONVERT THE NUMBER TO A VALID HEXADECIMAL INTEGER     * 00691402
*                                                                Y02666 00691602
         MVI   INTEGER,HF0             CLEAR CORE                Y02666 00691802
         MVC   INTEGER+ONE(THIRTY1),INTEGER  CLEAR               Y02666 00692002
         TM    PFLAGS6,BINFLG          A BINARY NUMBER?          Y02666 00692202
         BZ    GETLEN                  GO GET MAX LENGTH         Y02666 00692402
         LA    R9,THIRTY2              GET MAX BINARY LENGTH     Y02666 00692602
         B     GETPTR                  GO GET PTR                Y02666 00692802
GETLEN   DS    0H                                                Y02666 00693002
*      IF NOT BINARY, THE MAXIMUM INTEGER LENGTH IS 16.          Y02666 00693202
         LA    R9,SIXTEEN              GET MAX. PACK LENGTH      Y02666 00693402
GETPTR   DS    0H                                                Y02666 00693602
*      INITIALIZE POINTERS FOR PACKING THE INTEGER               Y02666 00693802
         SR    R9,R2                   COMPUTE OFFSET            Y02666 00694002
         LA    R1,INTEGER              GET PTR TO AREA           Y02666 00694202
         AR    R9,R1                   COMPUTE ACTUAL ADDRESS    Y02666 00694402
         BCTR  R2,ZERO                 DECREMENT FOR EX.INSTR.   Y02666 00694602
         EX    R2,MVCDATA              MOVE INPUT TO WORKAREA    Y02666 00694802
         TM    PFLAGS6,HEXFLG+BINFLG   BINARY OR HEX?            Y02666 00695002
         BM    VALIDHEX                BYPASS MAXIMUM TEST       Y02666 00695202
         CLC   INTEGER+FOUR(TWELVE),MAXNUMC MAXIMUM NUMERIC?     Y02666 00695402
         BH    VALINV                  YES, TOO BIG              Y02666 00695602
VALPACK  DS    0H                                                Y02666 00695802
*      USE THE PACK INSTRUCTION TO PACK THE DECIMAL INTEGER      Y02666 00696002
         LA    R2,SEVENF               GET LENGTH FOR EX. PACKINGY02666 00696202
         EX    R2,PACKIT               PACK NUMBER               Y02666 00696402
         LA    R1,INTEGER+EIGHT        GET CONVERTED DATA PTR    Y02666 00696602
         CVB   R2,ZERO(R1)             CONVERT INPUT TO BINARY   Y02666 00696802
         ST    R2,INTEGER+TWELVE       SAVE DATA                 Y02666 00700202
         B     GETSTORE                GET CORE FOR NUMBER       Y02666 00700402
BINCOMP  DS    0H                                                Y02666 00700802
*      PREPARE TO CONVERT HEXADECIMAL DIGITS TO BINARY DIGITS    Y02666 00701002
         TM    PFLAGS6,BINFLG          A BINARY NUMBER?          Y02666 00701402
         BZ    GETSTORE                NO, CONTINUE              Y02666 00701602
         LA    R1,INTEGER              GET WORKAREA PTR.         Y02666 00702002
         BCTR  R1,ZERO                 DECREMENT FOR INDEXING    Y02666 00702202
         LA    R7,THIRTY2              GET LENGTH                Y02666 00702602
         LR    R14,R7                  GET MAX LENGTH            Y02666 00702802
         EJECT                                                          00703202
BINTOHEX DS    0H                                                Y02666 00703402
*********************************************************************** 00703802
*                                                                       00704002
*     THE FOLLOWING CODE IS THE HEX-TO-BINARY CONVERSION ROUTINE Y02666 00704202
*                                                                       00704602
*********************************************************************** 00705002
         OI    PFLAGS7,BINSTOR         SET FOR FIRST DIGITOF BYTEY02666 00705202
         SR    R8,R8                   CLEAR WORK REG.           Y02666 00705602
BINHCONV DS    0H                                                Y02666 00705802
*      BEGIN TO PROCESS A NEW DIGIT.                             Y02666 00706002
         SR    R2,R2                   CLEAR COUNTER             Y02666 00706302
         IC    R8,ZERO(R1,R7)          GET A BYTE                Y02666 00706602
         SRDL  R8,FOUR                 GET FOUR DIGITS           Y02666 00707002
         SRL   R9,TWENTY8              GET LOWORDER BIT          Y02666 00707302
         SLL   R8,ONE                  GET 2ND LOWORDER BIT      Y02666 00707702
         AR    R2,R8                   GET SUM                   Y02666 00707902
         AR    R2,R9                   GET SUM                   Y02666 00708102
         BCT   R7,NEXTBYTE             INCREMENT FOR DECREMENT   Y02666 00708402
         LA    R7,ONE                  INCREMENT FOR DECREMENT   Y02666 00708702
         B     STORBIN                 GO TO STORE LAST DIGIT    Y02666 00709002
NEXTBYTE DS    0H                                                Y02666 00709302
*      BEGIN TO PROCESS THE 2ND HALF OF A DIGIT                  Y02666 00709602
         IC    R8,ZERO(R1,R7)          GET NEXT BYTE FOR NEXT 2 BITS    00709902
*                                                                Y02666 00710202
         SRDL  R8,FOUR                 ISOLATE FOUR DIGITS       Y02666 00710502
         SRL   R9,TWENTY6              GET 3RD LOWORDER BIT      Y02666 00710802
         SLL   R8,THREE                GET 4TH LOWORDER BIT      Y02666 00711102
         AR    R2,R8                   GET SUM                   Y02666 00711402
         AR    R2,R9                   GET SUM                   Y02666 00711702
         TM    PFLAGS7,BINSTOR         SHOULD BYTE BE STORED?    Y02666 00712002
         BZ    STORBIN                 YES,GO STORE              Y02666 00712302
         NI    PFLAGS7,HFF-BINSTOR     INDICATE BYTE IS TO BE STORED    00712602
*                                                                Y02666 00712902
         LR    R3,R2                   SAVE FIRST HALF OF BYTE   Y02666 00713202
         BCT   R7,BINHCONV             POINT TO NEXT BYTE        Y02666 00713502
         LA    R7,ONE                  INCREMENT FOR DECREMENT   Y02666 00713802
STORBIN  DS    0H                                                Y02666 00714102
*      STORE THE DIGITS AS A SINGLE BYTE                         Y02666 00714402
         SLL   R3,TWENTY8              PUT 2ND HALF BYTE I       Y02666 00714702
         SLDL  R2,FOUR                 GET BYTE FOR STORE        Y02666 00715002
         STC   R2,ZERO(R1,R14)         STORE BYTE                Y02666 00715302
         BCTR  R14,ZERO                DECREMENT STORAGE INDEX   Y02666 00715602
         BCT   R7,BINTOHEX             DECREMENT INPUT INDEX     Y02666 00715902
         MVC   INTEGER(SIXTEEN),INTEGER+SIXTEEN ALLIGN DATA      Y02666 00716202
         L     R3,PDWORD               RESTORE  OPTIONS PTR      Y02666 00716502
GETSTORE DS    0H                                                Y02666 00716802
*      GET PERMANENT STORAGE FOR THE CONVERTED DATA              Y02666 00717102
         L     R7,P20SAVE              RESTORE BASE REG.         Y02666 00717402
         LA    R1,FOUR                 GET MAX LENGTH            Y02666 00717702
         STH   R1,PLENGTH              SAVE AS RETURN LENGTH     Y02666 00718002
         L     R14,STALOCP             GET GETMAIN RTN^PTR       Y02666 00718302
         LR    R2,R15                  SAVE ADDRESSABILIYT REG.  Y02666 00718602
         BALR  LINK2,R14               GO GET CORE               Y02666 00718902
         LR    R15,R2                  RESTORE ADDRESS. REG      Y02666 00719202
         LA    R2,INTEGER+TWELVE       GET DATA PTR              Y02666 00719502
         ST    R1,PPOINTR              RESTORE                   Y02666 00719802
         MVC   ZERO(FOUR,R1),ZERO(R2)  MOVE DATA TO NEW AREA     Y02666 00720102
         EJECT                                                          00720402
*********************************************************************** 00720702
*                                                                     * 00721002
*   THIS IS THE NORMAL EXIT ROUTINE FOR THE HEXADECIMAL NUMBER AND THE* 00721302
*    BINARY OR DECIMAL INTEGER PROCESSING ROUTINES. HERE IT IS        * 00721602
*    DETERMINED IF THE END OF BUFFER HAS BEEN REACHED. IF SO, A RETURN* 00721902
*    OF EIGHT PAST THE RETURN ADDRESS IS MADE. IF NOT, A RETURN OF    * 00722202
*    TWELVE PAST THE RETURN ADDRESS IS MADE. A FLAG, VALENDF, IS      * 00722502
*    USED TO MAKE THIS THIS DECISION.                                 * 00722802
*                                                                     * 00723102
*********************************************************************** 00723402
VALTEXIT DS    0H                                                Y02666 00723702
         L     R7,P20SAVE              RESTORE BASE REG          Y02666 00724002
         L     LINK2,PLINKSV1          RESTORE RETURN PTR        Y02666 00724302
VALEXIT1 DS    0H                                                Y02666 00724602
         NI    PFLAGS6,HFF-HEXFLG-BINFLG-CHARFLG-DECFLG   Y02666        00724903
*      DETERMINE IF END OF INPUT WAS REACHED.                    Y02666 00725202
         C     XINPUT,ENDINPUT         END OF INPUT?             Y02666 00725502
         BNL   VAL08                   YES, RETURN,CHECK DELIM.  Y02666 00725802
VALR12   DS    0H                                                Y02666 00726102
*      END OF INPUT WAS NOT REACHED. RETURN +12.                 Y02666 00726402
*                                                                       00726702
         NI    PFLAGS7,HFF-VALENDF     RESET END FLAG            Y02666 00727002
         B     TWELVE(LINK2)           RETURN TO IKJIDENT PROC.  Y02666 00727302
VAL08    DS    0H                                                Y02666 00727602
*      END OF FILE WAS REACHED.RETURN + 8 TO IDENT PCE PROCESSOR.Y02666 00727902
*                                                                       00728202
         B     EIGHT(LINK2)            RETURN +8                 Y02666 00728502
         EJECT                                                          00728802
*********************************************************************** 00729102
*                                                                     * 00729402
*                 CHARACTER TYPE TEST ROUTINE                         * 00729702
*                                                                     * 00730002
* THIS IS AN INTERNAL SUBROUTINE WHICH CHECKS THE CURRENT CHARACTER   * 00730402
* FOR BELONGING TO A SPECIFIED CHARACTER CLASS.                       * 00730802
*                                                                     * 00731002
* INPUT - R1=MASK OF DESIRED CHARACTER CLASS.                         * 00731202
*         XINPUT=POINTER TO CHARACTER TO BE CHECKED.                  * 00731602
*                                                                     * 00732002
* OUTPUT - THE RESULT OF THE TEST IS INDICATED BY THE                 * 00732202
*          LOCATION TO WHICH CONTROL IS RETURNED.                     * 00732402
*                                                                     * 00732802
* EXISTS - LINK1+0=THE CHARACTER DOES NOT BELONG TO THE SPECIFIED     * 00733202
*                  CHARACTER CLASS.                                   * 00733402
*                                                                     * 00733602
*        - LINK1+4=THE CHARACTER BELONGS TO THE CHARACTER CLASS       * 00734002
*                  SPECIFIED.                                         * 00734402
*                                                                     * 00734602
*********************************************************************** 00734802
         SPACE                                                          00735202
TYPETEST DS    0H                      * * * *                          00735602
         XR    R14,R14                 CLEAR WORK REG                   00735802
         IC    R14,ZERO(XINPUT)        USE CURRENT CHARACTER AS         00736002
*                                         OFFSET INTO TESTING TABLE     00736402
         LA    R14,TRTAB(R14)          GET ADDRESS IN TABLE             00736802
*                                         CORRESPONDING TO CHARACTER IN 00737002
*                                         QUESTION                      00737202
         EX    R1,TYPETM               EXECUTE TEST UNDER MASK OF       00737602
*                                         TYPEBYTE FOR CHARACTER        00738002
*                                         SPECIFICATION GIVEN IN R1     00738202
*                                                                       00738402
         BC    CC5,FOUR(LINK1)         TYPE MATCHES, RETURN +4          00738802
*                                                                       00739202
         BR    LINK1                   TYPE DOESN'T MATCH, RETURN +0    00739402
         EJECT                                                          00739602
*********************************************************************** 00740002
*                                                                     * 00740302
*                       TRANSLATE INPUT DATA SUBROUTINE               * 00740602
*                                                                     * 00740902
*   THIS ROUTINE TRANSLATES THE INPUT DATA TO UPPERCASE UNLESS THE    * 00741202
* ASIS OPTION WAS SELECTED BY THE USER. THE INPUT DATA ADDRESS IS     * 00741502
* TAKEN FROM PPOINTR AND THE LENGTH FROM PLENGTH. IF THE DATA LIES    * 00741802
* WITHIN THE PCE (DEFAULTED) NO TRANSLATION TAKES PLACE.              * 00742102
*                                                                     * 00742402
*********************************************************************** 00742702
         SPACE                                                          00743002
TRANSQ   DS    0H                      TRANSLATION SUBROUTINE           00743302
         USING *,BASE                  ESTABLISH ADDRESSABILITY         00743602
*                                         FOR TRANSLATE ROUTINE         00743902
         SPACE                                                          00744202
         MVC   PDWORD(ONE),PCEFLGB1(XPCE) MOVE PCE FLAG                 00744502
*                                         BYTE TO WORKAREA              00744802
         NI    PDWORD,HE0              ISOLATE PCE TYPE INDICATORS      00745102
         CLI   PDWORD,KEYWDPCE         IS IT A KEYWORD PCE              00745402
         BE    TRANS                   YES, TRANSLATE                   00745702
         SPACE                                                          00746002
         CLI   PDWORD,RSVDPCE          IS IT A RESERVED WORD     F41448 00746302
*                                      PCE?                      F41448 00746602
         BO    TRANS                   IF YES, TRANSLATE         F41448 00746902
*                                      REGARDLESS                F41448 00747202
         SPACE                                                          00747502
         TM    PCEFLGB2(XPCE),PCEFASIS SHOULD THE DATA BE TRANSLATED TO 00747802
*                                         UPPERCASE                     00748102
         BCR   CC1,LINK1               NO RETURN TO CALLER              00748402
         SPACE                                                          00748702
TRANS    DS    0H                      BRANCHED TO FOR TRANSLATION OF A 00749002
*                                         KEYWORD PARAMETER             00749302
         NC    PPOINTR+ONE(L'PPOINTR-ONE),PPOINTR+ONE IS THERE ANY DATA 00749602
*                                         TO CONVERT                    00750020
         BCR   CC8,LINK1               IF NO RETURN TO CALLER           00760020
         SPACE                                                          00770020
         CLC   PPOINTR+ONE(L'PPOINTR-ONE),PTABLEAD+ONE DOES THE DATA    00780020
*                                         LIE WITHIN THE PCL            00790020
         BL    TRANS1                  NO BRANCH - CANNOT BE DEFAULT    00800020
         SPACE                                                          00810020
         CLC   PPOINTR+ONE(L'PPOINTR-ONE),PTABLEND+ONE DOES THE DATA    00820020
*                                         LIE WITHIN THE PCL            00830020
         BCR   CC13,LINK1              YES WITHIN PCL MUST BE DEFAULT   00840020
         B     TRANS1                  BRANCH AROUND TRANSX CODE        00841020
         EJECT                                                          00850002
*********************************************************************** 00881020
*                                                                     * 00882020
* IF TRANSLATE ROUTINE IS ENTERED AT ENTRY POINT TRANSX, ADJUST       * 00883020
* THE VALUE OF THE BASE REGISTER (WHICH IS ALSO THE CALL REGISTER)    * 00884020
* SO THAT LOCATIONS ABOVE THIS ENTRY POINT WILL BE ADDRESSABLE        * 00885020
* BY INSTRUCTIONS BELOW THIS ENTRY POINT.                             * 00886020
*********************************************************************** 00887020
         SPACE                                                          00888020
TRANSX   DS    0H                      * * * *                          00890020
         LA    R14,TRANSX-TRANSQ       LOAD SCRATCH REG WITH            00891020
*                                         DIFFERENCE IN ENTRY POINTS    00892020
         SR    BASE,R14                ADJUST VALUE OF BASE REGISTER    00893020
*                                         TO THAT AT ENTRY POINT TRANSQ 00894020
         SPACE                                                          00896020
*                                                                       00896220
* PROCEED TO TRANSLATE DATA TO UPPERCASE.                               00896320
*                                                                       00896420
TRANS1   DS    0H                      * * * *                          00897020
         LH    R14,PLENGTH             LOAD LENGTH OF DATA              00900020
         LTR   R14,R14                 ANY DATA TO TRANSLATE            00910020
         BCR   CC8,LINK1               NO ZERO RETURN TO CALLER         00920020
         SPACE                                                          00930020
         BCTR  R14,ZERO                REDUCE FOR 'EX' INSTRUCTION      00940020
         L     R1,PPOINTR              LOAD ADDRESS OF DATA             00950020
         EX    R14,TRANSTR             TRANSLATE TO UPPERCASE           00960020
         BR    LINK1                   RETURN TO CALLER                 00970020
         EJECT                                                          00980002
H0       DC    H'0'                    HALFWORD OF ZEROES FOR CLC       00981020
         SPACE                                                          00982020
DATE     DC    C'IKJEFP20-8/7/70'      MODULE LEVEL IDENTITY CONSTANT   00983020
         SPACE                                                          00990020
*                                                                       01000020
* TRANSLATION TABLE USED BY TRANSLATE TO UPPERCASE ROUTINE.             01010020
*                                                                       01020020
UPPERTAB DC    256AL1(*-UPPERTAB)      GENERATE BASIC TABLE             01030020
         ORG   UPPERTAB+C'A'-X'40'     POSITION INST. CTR. TO SMALL A-Z 01040020
         DC    (C'Z'-C'A'+1)AL1(*-UPPERTAB+X'40') RAISE LOWER TO UPPER  01050020
         ORG   UPPERTAB+256            RESET INSTRUCTION COUNTER        01060020
         EJECT                                                          01070020
*                                                                       01080020
* THIS 256 BYTE TABLE IS USED TO TEST IF A GIVEN INPUT CHARACTER        01090020
* BELONGS TO A CHARACTER CLASS. EACH EBCIDIC CONFIGURATION IS           01100020
* ASSIGNED A CHARACTER CLASS                                            01110020
*                                                                       01120020
TRTAB    DC    256AL1(INVALID)         INITIALIZE TYPETEST TABLE        01130020
         ORG   TRTAB+X'05'                                              01140020
         DC    AL1(SEPAR+CMDDLIM)      HORIZONTAL TAB = SEPARATOR AND   01150020
*                                         COMMAND DELIMITER             01160020
         ORG   TRTAB+C'
'                                               01170020
         DC    AL1(NSEPDLIM+CMDDLIM)   NEW LINE CHAR = DELIMITER AND    01180020
*                                         COMMAND DELIMITER             01190020
         ORG   TRTAB+C' '                                               01200020
         DC    AL1(SEPAR+CMDDLIM)      BLANK = SEPARATOR AND COMMAND    01210020
*                                         DELIMITER                     01220020
         ORG   TRTAB+C''                                               01230020
         DC    AL1(NDLIMSPC)           CENT SIGN = SPECIAL              01240020
         ORG   TRTAB+C'.'                                               01250020
         DC    AL1(NDLIMSPC+CMDDLIM)   PERIOD = SPECIAL                 01260020
*                                         AND COMMAND DELIMITER         01270020
         ORG   TRTAB+C'<'                                               01280020
         DC    AL1(NDLIMSPC)           LESS THAN = SPECIAL              01290020
         ORG   TRTAB+C'('                                               01300020
         DC    AL1(NDLIMSPC+CMDDLIM)   LEFT PAREN = SPECIAL             01310020
*                                         AND COMMAND DELIMITER         01320020
         ORG   TRTAB+C'+'                                               01330020
         DC    AL1(NDLIMSPC)           PLUS = SPECIAL                   01340020
         ORG   TRTAB+C'|'                                               01350020
         DC    AL1(NDLIMSPC)           OR = SPECIAL                     01360020
         ORG   TRTAB+C'&&'                                              01370020
         DC    AL1(NDLIMSPC+CMDDLIM)   AMPERSAND = SPECIAL              01380020
*                                         AND COMMAND DELIMITER         01390020
         ORG   TRTAB+C'!'                                               01400020
         DC    AL1(NDLIMSPC)           EXCLAMATION = SPECIAL            01410020
         ORG   TRTAB+C'$'                                               01420020
         DC    AL1(NATL)               DOLLAR SIGN = NATIONAL           01430020
         ORG   TRTAB+C'*'                                               01440020
         DC    AL1(NDLIMSPC)           ASTERISK= SPECIAL                01450020
*                                         AND COMMAND DELIMITER         01460020
         ORG   TRTAB+C')'                                               01470020
         DC    AL1(NSEPDLIM+CMDDLIM)   RIGHT PAREN = SPECIAL            01480020
*                                         AND COMMAND DELIMITER         01490020
         ORG   TRTAB+C';'                                               01500020
         DC    AL1(NSEPDLIM+CMDDLIM)   SEMICOLON = DELIMITER            01510020
*                                         AND COMMAND DELIMITER         01520020
         ORG   TRTAB+C'^'                                               01530020
         DC    AL1(NDLIMSPC)           NOT SIGN = SPECIAL               01540020
         ORG   TRTAB+C'-'                                               01550020
         DC    AL1(NDLIMSPC+CMDDLIM)   MINUS = SPECIAL                  01560020
*                                         AND COMMAND DELIMITER         01570020
         ORG   TRTAB+C'/'                                               01580020
         DC    AL1(NDLIMSPC+CMDDLIM)   SLASH = DELIMITER                01590020
*                                         AND COMMAND DELIMITER         01600020
         ORG   TRTAB+C','                                               01610020
         DC    AL1(SEPAR+CMDDLIM)      COMMA = SEPARATOR                01620020
*                                         AND COMMAND DELIMITER         01630020
         ORG   TRTAB+C'%'                                               01640020
         DC    AL1(NDLIMSPC)           PERCENT = SPECIAL                01650020
         ORG   TRTAB+C'_'                                               01660020
         DC    AL1(NDLIMSPC)           DASH = SPECIAL                   01670020
         ORG   TRTAB+C'>'                                               01680020
         DC    AL1(NDLIMSPC)           GREATER-THAN = SPECIAL           01690020
         ORG   TRTAB+C'?'                                               01700020
         DC    AL1(NDLIMSPC)           QUESTION MARK = SPECIAL          01710020
         ORG   TRTAB+C':'                                               01720020
         DC    AL1(NDLIMSPC)           COLON = SPECIAL                  01730020
         ORG   TRTAB+C'#'                                               01740020
         DC    AL1(NATL)               POUND SIGN = NATIONAL            01750020
         ORG   TRTAB+C'@'                                               01760020
         DC    AL1(NATL)               AT SIGN = NATIONAL               01770020
         ORG   TRTAB+C''''             QUOTE                            01780020
         DC    AL1(NDLIMSPC+CMDDLIM)   QUOTE = SPECIAL                  01790020
*                                         AND COMMAND DELIMITER         01800020
         ORG   TRTAB+C'='                                               01810020
         DC    AL1(NDLIMSPC+CMDDLIM)   EQUAL = SPECIAL                  01820020
*                                         AND COMMAND DELIMITER         01830020
         ORG   TRTAB+C'"'                                               01840020
         DC    AL1(NDLIMSPC)           DOUBLE QUOTE = SPECIAL           01850020
         ORG   TRTAB+X'81'                                              01860020
         DC    (C'F'-C'A'+1)AL1(HEX)   SMALL A THRU F = HEX             01870020
         DC    (C'I'-C'G'+1)AL1(OLETTER) SMALL G THRU I = OTHER LETTER  01880020
         ORG   TRTAB+C'J'                                               01890020
         ORG   TRTAB+X'91'                                              01900020
         DC    (C'R'-C'J'+1)AL1(OLETTER) SMALL J THRU R = OTHER LETTER  01910020
         ORG   TRTAB+C'S'                                               01920020
         ORG   TRTAB+X'A2'                                              01930020
         DC    (C'Z'-C'S'+1)AL1(OLETTER) SMALL S THRU Z = OTHER LETTER  01940020
         ORG   TRTAB+C'A'                                               01950020
         DC    (C'F'-C'A'+1)AL1(HEX)   A THRU F = HEX                   01960020
         DC    (C'I'-C'G'+1)AL1(OLETTER) G THRU I = OTHER LETTER        01970020
         ORG   TRTAB+C'J'                                               01980020
         DC    (C'R'-C'J'+1)AL1(OLETTER) J THRU R = OTHER LETTER        01990020
         ORG   TRTAB+C'S'                                               02000020
         DC    (C'Z'-C'S'+1)AL1(OLETTER) S THRU Z = OTHER LETTER        02010020
         ORG   TRTAB+C'0'                                               02020020
         DC    (C'9'-C'0'+1)AL1(NUMBER) 0 THRU 9 = NUMBER               02030020
         ORG   TRTAB+256                                                02030120
         SPACE                                                          02031020
TRANSTR  TR    ZERO(*-*,R1),UPPERTAB   TO CONVERT TO UPPERCASE          02032020
         SPACE                                                          02033020
TYPETM   TM    ZERO(R14),*-*           USED BY TYPETEST TO TEST         02033120
*                                         FOR A CHARACTER TYPE          02033220
         SPACE                                                          02033420
*                                                                       02033520
* TABLE USED BY GENSCAN TO SELECT THE CORRECT MASK TO BE PASSED         02033620
* TO TYPETEST GIVEN THE TYPE OF CHARACTER REQUIRED IN THE FORM          02033720
* OF A HEX NUMBER.                                                      02033820
*                                                                       02033920
CHARTYPE DC    0H'0'                   * * * *                          02034020
ANY      DC    AL1(HEX+OLETTER+NATL+NUMBER+NDLIMSPC) ALL ALPHABETIC     02034120
*                                         NUMERIC,NATIONAL AND          02034220
*                                         ENTERABLE SPECIAL CHARACTERS  02034320
*                                         THAT ARE NOT DELIMITERS       02034420
ALPHA    DC    AL1(HEX+OLETTER+NATL)   ALL ALPHABETIC CHARACTERS        02034520
NUMERIC  DC    AL1(NUMBER)             ALL NUMERIC CHARACTERS           02034620
ALPHANUM DC    AL1(HEX+OLETTER+NATL+NUMBER) ALL ALPHABETIC AND          02034720
*                                         NUMERIC CHARACTERS            02034820
NONATABC DC    AL1(HEX+OLETTER)        ALL ALPHABETICS EXCLUDING  R0301 02035801
*                                      THE NATIONAL CHARACTERS    R0301 02036201
NONATNUM DC    AL1(HEX+OLETTER+NUMBER) ALL ALPHABETICS AND        R0301 02036601
*                                      NUMERICS EXCLUDING THE     R0301 02036701
*                                      NATIONAL CHARACTERS        R0301 02036801
         EJECT                                                          02036902
*                                                                       02037502
*   CONSTANTS FOR VALUE TYPE SUPPORT                             Y02666 02037602
*                                                                       02037702
EXQTE    DC    X'E77D'                 X - QUOTE                 Y02666 02037802
EXXQTE   DC    X'A77D'                 SMALL X - QUOTE           Y02666 02038002
         SPACE                                                          02041402
BINQTE   DC    X'827D'                 SMALL B - QUOTE           Y02666 02057902
BINNQTE  DC    X'C27D'                 B - QUOTE                 Y02666 02107902
MAXNUMC  DC    CL12'002147483647'      MAXIMUM DECIMAL NUMBER    Y02666 02108302
NUMMAX   DC    F'2147483647'           MAXIMUM NUMERIC VALUE     Y02666 02109902
MAXBINL  DC    H'32'                   MAXLENGTH FOR BINARY      Y02666 02111902
MAXNUML  DC    H'10'                   MAXLENGTH FOR INTEGER     Y02666 02114602
MAXHEXL  DC    H'08'                   MAXLENGTH FO HEXADECIMAL  Y02666 02119402
         DS    0F                                                Y02666 02120202
BYTEON   DC    X'80000000'             HIGH ORDER BIT ON         Y02666 02120602
STALOCP  DC    V(STALOC)                                         Y02666 02120902
POSITXP  DC    V(POSITX1)                                        Y02666 02122402
RANGEP   DC    V(RANGE)                                          Y02666 02123902
*        BINARY AND HEX CONVERSION TABLE                         Y02666 02126102
CONVTAB  DC    256AL1(INVALID)         VALUE TYPE CONVERSION TABLE      02126902
*                                                                Y02666 02128402
         ORG   CONVTAB+X'81'                                            02129902
         DC    X'0A0B0C0D0E0F'                                          02131402
         ORG   CONVTAB+X'C1'                                            02132902
         DC    X'0A0B0C0D0E0F'                                          02134402
         ORG   CONVTAB+X'F0'                                            02135902
         DC    X'00010203040506070809'                                  02137402
GETCOREP DC    V(GETCORE)              PTR TO GETMAIN RTN.       Y02666 02138902
QSTRNGAD DC    V(QSTR01)               QUOTED STRING ROUTINE     Y02666 02140402
SLASHAST DC    C'/*'                   COMMENT DELIMITER         Y02666 02143402
*          EXECUTED INSTRUCTIONS                                 Y02666 02144902
PACKIT   PACK  EIGHT(*-*,R1),ZERO(*-*,R1) PACK DATA              Y02666 02146402
MVCDATA  MVC   ZERO(*-*,R9),ZERO(R8)   MOVE DATA TO PACK         Y02666 02147902
         EJECT                                                          02157902
*                                                                       02167902
* MAPPING OF THE CONTROL INFORMATION PASSED TO GENSCAN BY THE CALLER    02177902
* THE ADDRESS OF THE CONTROL INFORMATION IS CONTAINED IN PDWORD         02187902
* IN THE COMMON WORKAREA.                                               02197902
*                                                                       02199902
GCONTROL DSECT                                                          02201902
GOPTIONS DS    X                       FLAG BYTE WHICH INDICATES THE    02203902
*                                         SCAN OPTIONS                  02205902
GFIRST   DS    X                       FIRST CHARACTER TYPE - A HEX     02206302
*                                         NUMBER                        02206702
GOTHER   DS    X                       OTHER CHARACTERS TYPE - A HEX    02207102
*                                         NUMBER                        02207502
GMAXLNTH DS    X                       MAXIMUM LENGTH (OPTIONAL)        02207602
         SPACE                                                          02207702
*                                                                       02207802
* GENSCAN OPTIONS FLAGS.                                                02224502
*                                                                       02234502
ASTKALWD EQU   X'80'                   AN ASTERISK MAY BE SUBSTITUTED   02236502
*                                         FOR THE PARM                  02238502
MAXLSPEC EQU   X'40'                   MAXIMUM LENGTH IS SPECIFIED      02240502
         EJECT                                                          02240902
PWORK    IKJEFPWA                                                       02241202
         END                                                            02257902
