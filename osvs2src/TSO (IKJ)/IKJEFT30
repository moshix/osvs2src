         TITLE 'IKJEFT30, STACK SERVICE ROUTINE - EXEC VERSION         *00001000
                        '                                               00002000
IKJEFT30 CSECT ,                                                   0001 00003000
IKJSTCK  DS    0H                                                  0001 00004000
         ENTRY IKJSTCK                                                  00005000
@MAINENT DS    0H                                                  0001 00006000
         USING *,@15                                               0001 00007000
         B     @PROLOG                                             0001 00008000
         DC    AL2(@EP00001-@MAINENT)                                   00009000
         DC    AL1(16)                                             0001 00010000
         DC    C'IKJEFT30  76.260'                                 0001 00011000
         DROP  @15                                                      00012000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00013000
         BALR  @12,0                                               0001 00014000
@PSTART  LA    @11,4095(,@12)                                      0001 00015000
         USING @PSTART,@12                                         0001 00016000
         USING @PSTART+4095,@11                                    0001 00017000
         L     @00,@SIZDATD                                        0001 00018000
         GETMAIN  R,LV=(0)                                              00019000
         LR    @10,@01                                             0001 00020000
         USING @DATD,@10                                           0001 00021000
         ST    @13,@SA00001+4                                      0001 00022000
         LM    @15,@01,16(@13)                                     0001 00023000
         ST    @10,8(,@13)                                         0001 00024000
         LR    @13,@10                                             0001 00025000
         AH    @15,4(,@15)                                         0001 00026000
         BR    @15                                                 0001 00027000
@EP00001 MVC   @PC00001(16),0(@01)                                 0001 00028000
*                                                                  0053 00029000
*   /*****************************************************************/ 00030000
*   /*                                                               */ 00031000
*   /* stART EXECUTABLE CODE IF THE POINTER TO THE SERVICE ROUTINES  */ 00032000
*   /* I/O WORKAREAS IS ZERO THEN THIS IS THE FIRST TIME STACK HAS   */ 00033000
*   /* BEEN CALLED FOR THE CURRENT TASK , THEREFORE STORAGE MUST BE  */ 00034000
*   /* OBTAINED AND THE INTERNAL TABLES ESTABLISHED                  */ 00035000
*   /*                                                               */ 00036000
*   /*****************************************************************/ 00037000
*                                                                  0053 00038000
*   FRELST=''B;                     /* CLEAR FREEMAIN LIST FORM      */ 00039000
         XC    FRELST(10),FRELST                                   0053 00040000
*   GETLST=''B;                     /* CLEAR GETMAIN LIST FORM       */ 00041000
         XC    GETLST(10),GETLST                                   0054 00042000
*   SWS=''B;                        /* CLEAR SWITCHES                */ 00043000
         MVI   SWS,X'00'                                           0055 00044000
*   IF IOSRLPTR=0 THEN              /* IF THIS IS FIRST ENTRY        */ 00045000
         L     @03,@PC00001+4                                      0056 00046000
         L     @03,IOSRLPTR(,@03)                                  0056 00047000
         LTR   @03,@03                                             0056 00048000
         BNZ   @RF00056                                            0056 00049000
*     DO;                                                          0057 00050000
*       SPOOL=SP78;                 /* INDICATE SHARED SUBPOOL       */ 00051000
         MVI   SPOOL,X'4E'                                         0058 00052000
*       LEN=IOSRLSIZ+STAKSIZE;      /* LENGTH = LENGTH OF STACK +  0059 00053000
*                                      LENGTH OF IOSRL               */ 00054000
         MVC   LEN(3),@CF00551+1                                   0059 00055000
*       RFY                                                        0060 00056000
*        (R0,                                                      0060 00057000
*         R1) RSTD;                 /* RESTRICT REGS                 */ 00058000
*       R0=LNGTH;                   /* PLACE GETMAIN PARM IN REG 0   */ 00059000
         L     R0,LNGTH                                            0061 00060000
*       GEN(GETMAIN R,LV=(0));                                     0062 00061000
         GETMAIN R,LV=(0)                                               00062000
*       IOSRLPTR=R1;                /* SAVE ADDR OF OBTAND    STORAGE*/ 00063000
         L     @03,@PC00001+4                                      0063 00064000
         ST    R1,IOSRLPTR(,@03)                                   0063 00065000
*       RFY                                                        0064 00066000
*        (R0,                                                      0064 00067000
*         R1) UNRSTD;               /* RELEASE REGS                  */ 00068000
*       IOSBELM=IOSRLPTR+IOSRLSIZ;  /* FILL IN PTR TO STACK          */ 00069000
         L     @03,@PC00001+4                                      0065 00070000
         L     @03,IOSRLPTR(,@03)                                  0065 00071000
         LA    @15,16                                              0065 00072000
         ALR   @15,@03                                             0065 00073000
         ST    @15,IOSBELM(,@03)                                   0065 00074000
*       IOSTELM=IOSBELM-ASTAKELM;   /* THIS CAUSES THE POINTER TO THE   00075000
*                                      TOP ELEMENT TO BE ONE WORD  0066 00076000
*                                      LESS THAN THE ACTUAL BOTTOM OF   00077000
*                                      STACK SO THAT THE ADD LOGIC 0066 00078000
*                                      LATER WILL FILL IN THE FIRST     00079000
*                                      ELEMENT AT THE PROPER ADDRESS */ 00080000
         SL    @15,@CF00068                                        0066 00081000
         ST    @15,IOSTELM(,@03)                                   0066 00082000
*       IOSNELM=0;                  /* INITIALIZE NUMBER OF ELMS=0   */ 00083000
         SLR   @15,@15                                             0067 00084000
         STH   @15,IOSNELM(,@03)                                   0067 00085000
*       IOSTLEN=STAKSIZE;           /* INITIALIZE TOTAL STACK LENGH  */ 00086000
         MVC   IOSTLEN(2,@03),@CH00070                             0068 00087000
*     END;                                                         0069 00088000
*                                                                  0069 00089000
*   /*****************************************************************/ 00090000
*   /*                                                               */ 00091000
*   /* DETERMINE FUNCTION -- ADD / DELETE OR CLOSE                   */ 00092000
*   /*                                                               */ 00093000
*   /*****************************************************************/ 00094000
*                                                                  0070 00095000
*   OPENL(1:OPENLEN)=OPENLOC(1:OPENLEN);/* GET LIST FORM OF OPEN     */ 00096000
@RF00056 L     @03,OPENLEN                                         0070 00097000
         BCTR  @03,0                                               0070 00098000
         EX    @03,@SM00776                                        0070 00099000
*   IF SPBCLOS=YES THEN             /* IF CLOSE REQUESTED            */ 00100000
         L     @03,@PC00001+12                                     0071 00101000
         TM    SPBCLOS(@03),B'00000001'                            0071 00102000
         BNO   @RF00071                                            0071 00103000
*     DO;                           /* THEN CALL CLOSE ROUTINE       */ 00104000
*       IF INSDATA=YES THEN         /* IF DATASET ELEMENT            */ 00105000
         L     @03,@PC00001+4                                      0073 00106000
         L     @03,IOSRLPTR(,@03)                                  0073 00107000
         L     @03,IOSTELM(,@03)                                   0073 00108000
         TM    INSDATA(@03),B'10000000'                            0073 00109000
         BNO   @RF00073                                            0073 00110000
*         CALL CLOSERTN;            /* FORCE A RETURN CODE OF ZERO   */ 00111000
         BAL   @14,CLOSERTN                                        0074 00112000
*       RETURN CODE(0);             /* EXIT 1 OF 4                   */ 00113000
@RF00073 L     @13,4(,@13)                                         0075 00114000
         L     @00,@SIZDATD                                        0075 00115000
         LR    @01,@10                                             0075 00116000
         FREEMAIN R,LV=(0),A=(1)                                        00117000
         SLR   @15,@15                                             0075 00118000
         L     @14,12(,@13)                                        0075 00119000
         LM    @00,@12,20(@13)                                     0075 00120000
         BR    @14                                                 0075 00121000
*     END;                          /*                               */ 00122000
*   ISTCKPTR=IOSBELM;               /* POINT TO BOTTOM OF STACK      */ 00123000
@RF00071 L     @03,@PC00001+4                                      0077 00124000
         L     @03,IOSRLPTR(,@03)                                  0077 00125000
         L     @15,IOSBELM(,@03)                                   0077 00126000
         LR    ISTCKPTR,@15                                        0077 00127000
*   IF SPBADD=NO THEN               /* IF FUNCTION ^= BRANCH         */ 00128000
         L     @08,@PC00001+12                                     0078 00129000
         TM    SPBADD(@08),B'10000000'                             0078 00130000
         BZ    @RT00078                                            0078 00131000
*     GOTO DELETE;                  /* TO DELETE SECTION             */ 00132000
*                                                                  0080 00133000
*   /*****************************************************************/ 00134000
*   /*                                                               */ 00135000
*   /* ADD FUNCTION                                                  */ 00136000
*   /*                                                               */ 00137000
*   /*****************************************************************/ 00138000
*                                                                  0080 00139000
*   RFY                                                            0080 00140000
*     LSDPTR BASED(ADDR(SPBADLSD)); /* SET LSD POINTER               */ 00141000
*   IF IOSTELM=IOSBELM+IOSTLEN-ASTAKELM THEN/* IF THE CURRENT STACK     00142000
*                                      IS FULL THEN OBTAIN A LARGER     00143000
*                                      STACK, MOVE CONTENTS OF OLD 0081 00144000
*                                      STACK TO NEW AREA AND FREE OLD   00145000
*                                      AREA                          */ 00146000
         LH    @08,IOSTLEN(,@03)                                   0081 00147000
         ALR   @15,@08                                             0081 00148000
         SL    @15,@CF00068                                        0081 00149000
         C     @15,IOSTELM(,@03)                                   0081 00150000
         BNE   @RF00081                                            0081 00151000
*     DO;                                                          0082 00152000
         ST    @08,@TF00001                                        0082 00153000
*       SPOOL=SP78;                 /* INDICATE SHARED SUBPOOL       */ 00154000
         MVI   SPOOL,X'4E'                                         0083 00155000
*       LEN=IOSTLEN+STAKSIZE;       /* LENGTH FOR NEW STACK          */ 00156000
         L     @03,@TF00001                                        0084 00157000
         LA    @03,32(,@03)                                        0084 00158000
         STCM  @03,7,LEN                                           0084 00159000
*       RFY                                                        0085 00160000
*        (R0,                                                      0085 00161000
*         R1) RSTD;                 /* RESTRICT REGS                 */ 00162000
*       R0=LNGTH;                   /* PLACE GETMAIN PARM IN REG     */ 00163000
         L     R0,LNGTH                                            0086 00164000
*       GEN(GETMAIN  R,LV=(0));                                    0087 00165000
         GETMAIN  R,LV=(0)                                              00166000
*       TEMP31=R1;                  /* SAVE POINTER TO OBTAINED    0088 00167000
*                                      STORAGE                       */ 00168000
         LR    TEMP31,R1                                           0088 00169000
*       RFY                                                        0089 00170000
*        (R0,                                                      0089 00171000
*         R1) UNRSTD;               /* RELEASE REGS                  */ 00172000
*       IOSNELM=((IOSTELM-IOSBELM)/ASTAKELM)+1;/* CALCULATE THE    0090 00173000
*                                      NUMBER OF WORDS TO MOVE       */ 00174000
         L     @03,@PC00001+4                                      0090 00175000
         L     @03,IOSRLPTR(,@03)                                  0090 00176000
         L     @00,IOSTELM(,@03)                                   0090 00177000
         SL    @00,IOSBELM(,@03)                                   0090 00178000
         SRDA  @00,32                                              0090 00179000
         D     @00,@CF00068                                        0090 00180000
         AL    @01,@CF00040                                        0090 00181000
         STH   @01,IOSNELM(,@03)                                   0090 00182000
*       RFY                                                        0091 00183000
*        (R2,                                                      0091 00184000
*         R3,                                                      0091 00185000
*         R4,                                                      0091 00186000
*         R5) RSTD;                 /* RESTRICT REGS FOR MVCL@Z00868 */ 00187000
*       R2=ADDR(DUMYSTAK);          /* POINT TO NEW AREA      @Z00868*/ 00188000
         ST    @03,@TF00001                                        0092 00189000
         LR    R2,TEMP31                                           0092 00190000
*       R4=ADDR(STCK);              /* POINT TO OLD AREA      @Z00868*/ 00191000
         LR    R4,ISTCKPTR                                         0093 00192000
*       R3=IOSTLEN+STAKSIZE;        /* LENGTH OF NEW CORE     @Z00868*/ 00193000
         L     @01,@TF00001                                        0094 00194000
         LH    @15,IOSTLEN(,@01)                                   0094 00195000
         LA    R3,32                                               0094 00196000
         ALR   R3,@15                                              0094 00197000
*       R5=IOSTLEN;                 /* LENGTH OF OLD CORE     @Z00868*/ 00198000
         LR    R5,@15                                              0095 00199000
*       MVCL(R2,R4);                /* ISSUE MOVE LONG        @Z00868*/ 00200000
         MVCL  R2,R4                                               0096 00201000
*       RFY                                                        0097 00202000
*        (R2,                                                      0097 00203000
*         R3,                                                      0097 00204000
*         R4,                                                      0097 00205000
*         R5);                      /* RESTORE REGS           @Z00868*/ 00206000
*                                                                  0097 00207000
*       /*************************************************************/ 00208000
*       /*                                                           */ 00209000
*       /* AT THIS POINT TEMP31 IS POINTING TO THE NEW STACK AND     */ 00210000
*       /* ISTCKPTR IS POINTING TO THE OLD STACK. THE FOLLOWING      */ 00211000
*       /* SEQUENCE OF INSTRUCTIONS IS GEARED TO PREVENT FUTURE FREE */ 00212000
*       /* MAIN ABENDS FROM OCCURING IF AN ATTENTION INTERRUPT OCCURS*/ 00213000
*       /* DURING THEIR EXECUTION                                    */ 00214000
*       /*                                                           */ 00215000
*       /*************************************************************/ 00216000
*                                                                  0098 00217000
*       IOSBELM=TEMP31;             /* POINT TO NEW BOTTOM ELEMENT   */ 00218000
         L     @03,@PC00001+4                                      0098 00219000
         L     @03,IOSRLPTR(,@03)                                  0098 00220000
         ST    TEMP31,IOSBELM(,@03)                                0098 00221000
*       IOSTELM=TEMP31+IOSTLEN-ASTAKELM;/* POINT TO TOP ELEMENT      */ 00222000
         LH    @15,IOSTLEN(,@03)                                   0099 00223000
         LR    @14,TEMP31                                          0099 00224000
         ALR   @14,@15                                             0099 00225000
         SL    @14,@CF00068                                        0099 00226000
         ST    @14,IOSTELM(,@03)                                   0099 00227000
*       LEN=IOSTLEN;                /* SAVE LENGTH OF OLD STACK      */ 00228000
         STCM  @15,7,LEN                                           0100 00229000
*       IOSTLEN=LEN+STAKSIZE;       /* CALC NEW STACK LENGTH         */ 00230000
         AL    @15,@CF00070                                        0101 00231000
         STH   @15,IOSTLEN(,@03)                                   0101 00232000
*       RFY                                                        0102 00233000
*        (R0,                                                      0102 00234000
*         R1) RSTD;                 /* RESTRICT REGS                 */ 00235000
*       R0=LNGTH;                   /* SET UP FREEMAIN PARAMETERS    */ 00236000
         L     R0,LNGTH                                            0103 00237000
*       R1=ISTCKPTR;                                               0104 00238000
         LR    R1,ISTCKPTR                                         0104 00239000
*       GEN(FREEMAIN  R,LV=(0),A=(1));                             0105 00240000
         FREEMAIN  R,LV=(0),A=(1)                                       00241000
*       RFY                                                        0106 00242000
*        (R0,                                                      0106 00243000
*         R1) UNRSTD;               /* RELEASE REGS                  */ 00244000
*       ISTCKPTR=TEMP31;            /* UPDATE THE INTERNAL POINTER TO   00245000
*                                      STACK                         */ 00246000
         LR    ISTCKPTR,TEMP31                                     0107 00247000
*     END;                          /* END OF FULL STACK PROCESSING  */ 00248000
*   IF SPBSTOR=YES THEN             /* IF STORAGE ELEMENT            */ 00249000
@RF00081 L     @03,@PC00001+12                                     0109 00250000
         TM    SPBSTOR(@03),B'01000000'                            0109 00251000
         BNO   @RF00109                                            0109 00252000
*     DO;                                                          0110 00253000
*       IF LSDRCLEN=0 THEN          /* IF VARIABLE LEN RCRDS         */ 00254000
         LA    @03,SPBADLSD(,@03)                                  0111 00255000
         L     @03,LSDPTR(,@03)                                    0111 00256000
         LH    @15,LSDRCLEN(,@03)                                  0111 00257000
         LTR   @15,@15                                             0111 00258000
         BNZ   @RF00111                                            0111 00259000
*         DO;                                                      0112 00260000
*           LNGTH=LSDADATA+LSDTOTLN;/* ESTABLISH END OF LIST         */ 00261000
         LH    @09,LSDTOTLN(,@03)                                  0113 00262000
         AL    @09,LSDADATA(,@03)                                  0113 00263000
         ST    @09,LNGTH                                           0113 00264000
*           TEMP31=LSDANEXT;        /* POINT TO BEGIN OF LIST        */ 00265000
         L     TEMP31,LSDANEXT(,@03)                               0114 00266000
*           DO WHILE TEMP31^=LNGTH;                                0115 00267000
         B     @DE00115                                            0115 00268000
@DL00115 DS    0H                                                  0116 00269000
*             IF RECLEN<MINSIZE THEN/* IF RECORD LENGTH IS TOO SMALL */ 00270000
         ICM   @09,12,RECLEN(TEMP31)                               0116 00271000
         SRA   @09,16                                              0116 00272000
         C     @09,@CF00068                                        0116 00273000
         BL    @RT00116                                            0116 00274000
*               GOTO INVALID;                                      0117 00275000
*             TEMP31=TEMP31+RECLEN; /* POINT TO NEXT RECRD           */ 00276000
         ALR   TEMP31,@09                                          0118 00277000
*             IF TEMP31>LNGTH THEN  /* IF LIST NOT BIG               */ 00278000
         C     TEMP31,LNGTH                                        0119 00279000
         BH    @RT00119                                            0119 00280000
*               GOTO INVALID;       /* ENOUGH                        */ 00281000
*           END;                                                   0121 00282000
@DE00115 C     TEMP31,LNGTH                                        0121 00283000
         BNE   @DL00115                                            0121 00284000
*         END;                                                     0122 00285000
*     END;                          /* END VALIDITY CHECKING         */ 00286000
@RF00111 DS    0H                                                  0124 00287000
*   IOSTELM=IOSTELM+ASTAKELM;       /* INCREMENT COUNT OF ELEMNTS    */ 00288000
@RF00109 L     @03,@PC00001+4                                      0124 00289000
         L     @03,IOSRLPTR(,@03)                                  0124 00290000
         LA    @15,4                                               0124 00291000
         AL    @15,IOSTELM(,@03)                                   0124 00292000
         ST    @15,IOSTELM(,@03)                                   0124 00293000
*   INSCODE=SPBCODE;                /* PLACE CODE IN STACK           */ 00294000
         L     @14,@PC00001+12                                     0125 00295000
         IC    @09,SPBCODE(,@14)                                   0125 00296000
         STC   @09,INSCODE(,@15)                                   0125 00297000
*   IF IOSBELM->INSOTDD=YES THEN    /* IF IN BACKGROUND ,INSURE      */ 00298000
         L     @03,IOSBELM(,@03)                                   0126 00299000
         TM    INSOTDD(@03),B'00010000'                            0126 00300000
         BNO   @RF00126                                            0126 00301000
*     INSOTDD=YES;                  /* OTDD BIT IS PROPAGATED        */ 00302000
         OI    INSOTDD(@15),B'00010000'                            0127 00303000
*   IF SPBSTOR=YES&SPBINDD=NO&SPBOTDD=NO THEN/* ADD STORAGE          */ 00304000
@RF00126 L     @03,@PC00001+12                                     0128 00305000
         TM    SPBSTOR(@03),B'01000000'                            0128 00306000
         BNO   @RF00128                                            0128 00307000
         TM    SPBINDD(@03),B'00110000'                            0128 00308000
         BNZ   @RF00128                                            0128 00309000
*     INSADLSD=SPBADLSD;            /* SET INSADLSD TO ADDR OF LSD   */ 00310000
         L     @15,@PC00001+4                                      0129 00311000
         L     @01,IOSRLPTR(,@15)                                  0129 00312000
         L     @01,IOSTELM(,@01)                                   0129 00313000
         MVC   INSADLSD(3,@01),SPBADLSD+1(@03)                     0129 00314000
*   ELSE                            /* ZERO ELEMENT IMPLIES TERMINAL */ 00315000
*     DO;                           /* ADD A DATASET ELEMENT         */ 00316000
         B     @RC00128                                            0130 00317000
@RF00128 DS    0H                                                  0131 00318000
*       IF IOSBELM->INSINDD=YES THEN/* IF IN BACKGROUND , INSURE     */ 00319000
         L     @03,@PC00001+4                                      0131 00320000
         L     @03,IOSRLPTR(,@03)                                  0131 00321000
         L     @01,IOSBELM(,@03)                                   0131 00322000
         TM    INSINDD(@01),B'00100000'                            0131 00323000
         BNO   @RF00131                                            0131 00324000
*         INSINDD=YES;              /* INSDD IS PROPAGATED           */ 00325000
         L     @03,IOSTELM(,@03)                                   0132 00326000
         OI    INSINDD(@03),B'00100000'                            0132 00327000
*       IF SPBINDD=YES|SPBOTDD=YES THEN/* ARE DDS SUPPLIED           */ 00328000
@RF00131 L     @03,@PC00001+12                                     0133 00329000
         TM    SPBINDD(@03),B'00110000'                            0133 00330000
         BZ    @RF00133                                            0133 00331000
*         DO;                       /* IF SO, CALL OPENRTN TO SET    */ 00332000
*           RFY                                                    0135 00333000
*             R15 RSTD;             /* RESTRICT REG 15               */ 00334000
*           CALL OPENRTN;           /* UP IODSD THEN CLEAR FLAGS     */ 00335000
         BAL   @14,OPENRTN                                         0136 00336000
*           IF R15^=0 THEN          /* SET RETURN CODE AND REMOVE    */ 00337000
         LTR   R15,R15                                             0137 00338000
         BZ    @RF00137                                            0137 00339000
*             DO;                   /* ELEMENT OFF OF THE STACK      */ 00340000
*               RETCODE=R15;        /* SET ERROR CODE                */ 00341000
         LR    RETCODE,R15                                         0139 00342000
*               RFY                                                0140 00343000
*                 R15 UNRSTD;       /* RELEASE REG 15                */ 00344000
*               CALL CLOSERTN;      /* CALL CLOSE TO FREE IODSD      */ 00345000
         BAL   @14,CLOSERTN                                        0141 00346000
*               IOSTELM=IOSTELM-ASTAKELM;/* BACK DOWN POINTER        */ 00347000
         L     @15,@PC00001+4                                      0142 00348000
         L     @15,IOSRLPTR(,@15)                                  0142 00349000
         L     @14,IOSTELM(,@15)                                   0142 00350000
         SL    @14,@CF00068                                        0142 00351000
         ST    @14,IOSTELM(,@15)                                   0142 00352000
*               RETURN CODE(RETCODE);/* EXIT 2 OF 4                  */ 00353000
         L     @13,4(,@13)                                         0143 00354000
         L     @00,@SIZDATD                                        0143 00355000
         LR    @01,@10                                             0143 00356000
         FREEMAIN R,LV=(0),A=(1)                                        00357000
         LR    @15,@03                                             0143 00358000
         L     @14,12(,@13)                                        0143 00359000
         LM    @00,@12,20(@13)                                     0143 00360000
         BR    @14                                                 0143 00361000
*             END;                  /* IF OPEN SUCCESSFUL, COPY      */ 00362000
*         END;                      /* END DATASET FUNCTION          */ 00363000
*       ELSE                                                       0146 00364000
*         INSADLSD=0;               /* SET TERMINAL SOURCE           */ 00365000
         B     @RC00133                                            0146 00366000
@RF00133 L     @03,@PC00001+4                                      0146 00367000
         L     @03,IOSRLPTR(,@03)                                  0146 00368000
         L     @03,IOSTELM(,@03)                                   0146 00369000
         SLR   @15,@15                                             0146 00370000
         STCM  @15,7,INSADLSD(@03)                                 0146 00371000
*     END;                                                         0147 00372000
*   GOTO NORMEND;                   /* END OF ADD FUNCTION           */ 00373000
         B     NORMEND                                             0148 00374000
*                                                                  0149 00375000
*   /*****************************************************************/ 00376000
*   /*                                                               */ 00377000
*   /* D E L E T E F U N C T I O N                                   */ 00378000
*   /*                                                               */ 00379000
*   /*****************************************************************/ 00380000
*                                                                  0149 00381000
*DELETE:                                                           0149 00382000
*   RFY                                                            0149 00383000
*     LSDPTR BASED(ADDR(INSTACK));  /* POINT TO CURRENT LSD          */ 00384000
DELETE   DS    0H                                                  0150 00385000
*   IF SPBFLUSH=YES THEN            /* IF THE TMP IS FLUSHING        */ 00386000
         L     @03,@PC00001+12                                     0150 00387000
         TM    SPBFLUSH(@03),B'00001000'                           0150 00388000
         BNO   @RF00150                                            0150 00389000
*     GEN(STAX DEFER=NO);           /* MAKE SURE ATTN ARE ALLOWED    */ 00390000
         STAX DEFER=NO                                                  00391000
*   IF IOSTELM=IOSBELM THEN         /* IF ONLY 1 ELM EXIT            */ 00392000
@RF00150 L     @03,@PC00001+4                                      0152 00393000
         L     @03,IOSRLPTR(,@03)                                  0152 00394000
         L     @15,IOSTELM(,@03)                                   0152 00395000
         C     @15,IOSBELM(,@03)                                   0152 00396000
         BE    @RT00152                                            0152 00397000
*     GOTO NORMEND;                 /* EXIT GRACEFULLY               */ 00398000
*   IF SPBDLCUR=YES THEN            /* DELETE CURRENT BIT ON?        */ 00399000
         L     @03,@PC00001+12                                     0154 00400000
         TM    SPBDLCUR(@03),B'01000000'                           0154 00401000
         BNO   @RF00154                                            0154 00402000
*     DO;                           /* IF SO CALL UNSTACK TO FREE    */ 00403000
*       IF INSEXEC=YES&CMAIN=YES THEN/* CMAIN CLIST ?                */ 00404000
         TM    INSEXEC(@15),B'00001000'                            0156 00405000
         BNO   @RF00156                                            0156 00406000
         L     @03,LSDPTR(,@15)                                    0156 00407000
         L     @03,LSDEXEC(,@03)                                   0156 00408000
         TM    CMAIN(@03),B'00000100'                              0156 00409000
         BO    @RT00156                                            0156 00410000
*         GOTO NORMEND;             /* DO NOT DELETE                 */ 00411000
*       CALL UNSTACK;               /* RELATED CORE OR DCBS          */ 00412000
@RF00156 BAL   @14,UNSTACK                                         0158 00413000
*       GO TO UPDATPTR;             /* GO UPDATE TOP ELEM POINTER    */ 00414000
         B     UPDATPTR                                            0159 00415000
*     END;                                                         0160 00416000
*   IF SPBDLPRC=NO&SPBDLALL=NO THEN                                0161 00417000
@RF00154 L     @03,@PC00001+12                                     0161 00418000
         TM    SPBDLPRC(@03),B'00110000'                           0161 00419000
         BNZ   @RF00161                                            0161 00420000
*     DO;                           /* INVALID PARAMETERS            */ 00421000
*INVALID:                                                          0163 00422000
*       RETCODE=INVALINP;           /* INVALID RC SET                */ 00423000
INVALID  LA    RETCODE,4                                           0163 00424000
*       RETURN CODE(RETCODE);       /* EXIT 3 OF 4                   */ 00425000
         L     @13,4(,@13)                                         0164 00426000
         L     @00,@SIZDATD                                        0164 00427000
         LR    @01,@10                                             0164 00428000
         FREEMAIN R,LV=(0),A=(1)                                        00429000
         LR    @15,@03                                             0164 00430000
         L     @14,12(,@13)                                        0164 00431000
         LM    @00,@12,20(@13)                                     0164 00432000
         BR    @14                                                 0164 00433000
*     END;                                                         0165 00434000
*                                                                  0165 00435000
*   /*****************************************************************/ 00436000
*   /*                                                               */ 00437000
*   /* THE FOLLOWING DO LOOP DELETES EACH ELEM OF THE STACK STARTING */ 00438000
*   /* FROM THE TOP DOWN TO THE BOTTOM FOR A DELETE ALL FUNCTION OR  */ 00439000
*   /* DOWN TO AND INCLUDING THE HIGHEST PROC ELEMENT FOR A DELETE   */ 00440000
*   /* PROC OR TO THE BOTTOM ELEMENT FOR A DELETE PROC IF NO PROC    */ 00441000
*   /* ELEMENT EXISTS ON THE STACK                                   */ 00442000
*   /*                                                               */ 00443000
*   /*****************************************************************/ 00444000
*                                                                  0166 00445000
*   DO IOSTELM=IOSTELM TO IOSBELM+ASTAKELM BY-ASTAKELM;            0166 00446000
@RF00161 L     @03,@PC00001+4                                      0166 00447000
         L     @03,IOSRLPTR(,@03)                                  0166 00448000
         L     @03,IOSTELM(,@03)                                   0166 00449000
         B     @DE00166                                            0166 00450000
@DL00166 DS    0H                                                  0167 00451000
*     IF INSEXEC=YES&               /* AN EXEC CLIST ?               */ 00452000
*         (CMAIN=YES|               /* MAIN OPTION ?                 */ 00453000
*         (NOFLUSH=YES&             /* OR NOFLUSH AND CERTAIN OPTION */ 00454000
*         (SPBDLALL=YES&SPBFLUSH=NO))) THEN/* DEL ALL W/ SUPERFL     */ 00455000
         L     @03,@PC00001+4                                      0167 00456000
         L     @03,IOSRLPTR(,@03)                                  0167 00457000
         L     @03,IOSTELM(,@03)                                   0167 00458000
         TM    INSEXEC(@03),B'00001000'                            0167 00459000
         BNO   @RF00167                                            0167 00460000
         L     @03,LSDPTR(,@03)                                    0167 00461000
         L     @03,LSDEXEC(,@03)                                   0167 00462000
         TM    CMAIN(@03),B'00000100'                              0167 00463000
         BO    @RT00167                                            0167 00464000
         TM    NOFLUSH(@03),B'00100000'                            0167 00465000
         BNO   @RF00167                                            0167 00466000
         L     @03,@PC00001+12                                     0167 00467000
         TM    SPBDLALL(@03),B'00010000'                           0167 00468000
         BNO   @RF00167                                            0167 00469000
         TM    SPBFLUSH(@03),B'00001000'                           0167 00470000
         BZ    @RT00167                                            0167 00471000
*       GO TO NORMEND;              /* IF NOFLUSHING ALLOWD          */ 00472000
*     CALL UNSTACK;                 /* FREE ANY RELATED CORE         */ 00473000
@RF00167 BAL   @14,UNSTACK                                         0169 00474000
*     IF SPBDLPRC=YES THEN                                         0170 00475000
         L     @03,@PC00001+12                                     0170 00476000
         TM    SPBDLPRC(@03),B'00100000'                           0170 00477000
         BNO   @RF00170                                            0170 00478000
*       DO;                         /* DELETE PROC FUNCTION REQUSTD  */ 00479000
*         IF INSPROC=YES THEN                                      0172 00480000
         L     @03,@PC00001+4                                      0172 00481000
         L     @03,IOSRLPTR(,@03)                                  0172 00482000
         L     @03,IOSTELM(,@03)                                   0172 00483000
         TM    INSPROC(@03),B'00000010'                            0172 00484000
         BNO   @RF00172                                            0172 00485000
*           DO;                     /* CURRENT ELEM PROC ELEM ?      */ 00486000
*UPDATPTR:                                                         0174 00487000
*             IOSTELM=IOSTELM-ASTAKELM;/* DECREMENT PTR TO TOP BY 1     00488000
*                                      EL                            */ 00489000
UPDATPTR L     @03,@PC00001+4                                      0174 00490000
         L     @03,IOSRLPTR(,@03)                                  0174 00491000
         L     @15,IOSTELM(,@03)                                   0174 00492000
         SL    @15,@CF00068                                        0174 00493000
         ST    @15,IOSTELM(,@03)                                   0174 00494000
*             GOTO NORMEND;                                        0175 00495000
         B     NORMEND                                             0175 00496000
*           END;                                                   0176 00497000
*       END;                        /* END DELETE PROC FUNCTION      */ 00498000
@RF00172 DS    0H                                                  0178 00499000
*   END;                            /* END OF UNSTACK LOOP           */ 00500000
@RF00170 L     @15,@PC00001+4                                      0178 00501000
         L     @01,IOSRLPTR(,@15)                                  0178 00502000
         L     @03,@CF00766                                        0178 00503000
         AL    @03,IOSTELM(,@01)                                   0178 00504000
         L     @15,@PC00001+4                                      0178 00505000
         L     @01,IOSRLPTR(,@15)                                  0178 00506000
         ST    @03,IOSTELM(,@01)                                   0178 00507000
@DE00166 L     @15,@PC00001+4                                      0178 00508000
         L     @01,IOSRLPTR(,@15)                                  0178 00509000
         LA    @00,4                                               0178 00510000
         AL    @00,IOSBELM(,@01)                                   0178 00511000
         CR    @03,@00                                             0178 00512000
         BNL   @DL00166                                            0178 00513000
*NORMEND:                                                          0179 00514000
*   RETCODE=0;                                                     0179 00515000
NORMEND  SLR   RETCODE,RETCODE                                     0179 00516000
*   RETURN CODE(RETCODE);           /* EXIT 4 OF 4                   */ 00517000
         L     @13,4(,@13)                                         0180 00518000
         L     @00,@SIZDATD                                        0180 00519000
         LR    @01,@10                                             0180 00520000
         FREEMAIN R,LV=(0),A=(1)                                        00521000
         LR    @15,@03                                             0180 00522000
         L     @14,12(,@13)                                        0180 00523000
         LM    @00,@12,20(@13)                                     0180 00524000
         BR    @14                                                 0180 00525000
*UNSTACK:                                                          0181 00526000
*   PROC;                                                          0181 00527000
@EL00001 L     @13,4(,@13)                                         0181 00528000
@EF00001 L     @00,@SIZDATD                                        0181 00529000
         LR    @01,@10                                             0181 00530000
         FREEMAIN R,LV=(0),A=(1)                                        00531000
@ER00001 LM    @14,@12,12(@13)                                     0181 00532000
         BR    @14                                                 0181 00533000
UNSTACK  STM   @14,@12,@SA00002                                    0181 00534000
*   IF INSEXEC=YES&INSDATA=YES THEN /* TERMIN DELIM ?                */ 00535000
         L     @03,@PC00001+4                                      0182 00536000
         L     @03,IOSRLPTR(,@03)                                  0182 00537000
         L     @03,IOSTELM(,@03)                                   0182 00538000
         TM    INSEXEC(@03),B'10001000'                            0182 00539000
         BNO   @RF00182                                            0182 00540000
*     INSCODE=EXINSAVE;             /* RESTORE OPTIONS               */ 00541000
         L     @01,LSDPTR(,@03)                                    0183 00542000
         L     @01,LSDEXEC(,@01)                                   0183 00543000
         SLR   @00,@00                                             0183 00544000
         IC    @00,EXINSAVE(,@01)                                  0183 00545000
         STC   @00,INSCODE(,@03)                                   0183 00546000
*   IF INSSTOR=YES THEN                                            0184 00547000
@RF00182 L     @03,@PC00001+4                                      0184 00548000
         L     @03,IOSRLPTR(,@03)                                  0184 00549000
         L     @03,IOSTELM(,@03)                                   0184 00550000
         TM    INSSTOR(@03),B'01000000'                            0184 00551000
         BNO   @RF00184                                            0184 00552000
*     DO;                           /* IS TOP ELM AN IN-STORAGE LST  */ 00553000
*       DO;                         /* FREEMAIN (E) A(FREEADDR)    0186 00554000
*                                      SP(SP78) MF(M,FRELST)         */ 00555000
*         FRELST05='00'X;           /* SET TYPE                      */ 00556000
         MVI   FRELST05,X'00'                                      0187 00557000
*         FRELST04=ADDR(FREEADDR);  /* ADDR OF ADDR LIST             */ 00558000
         LA    @15,FREEADDR                                        0188 00559000
         STCM  @15,7,FRELST04                                      0188 00560000
*         FRELST06=SP78;            /* SUBPOOL VALUE                 */ 00561000
         MVI   FRELST06,X'4E'                                      0189 00562000
*       END;                        /* FREEMAIN (E) A(FREEADDR)    0190 00563000
*                                      SP(SP78) MF(M,FRELST)         */ 00564000
*       IF INSEXEC=YES THEN         /* IF AN EXEC STACK              */ 00565000
         TM    INSEXEC(@03),B'00001000'                            0191 00566000
         BNO   @RF00191                                            0191 00567000
*         DO;                       /* SET UP TO FREE ALL EXEC BLOCKS*/ 00568000
*           RFY                                                    0193 00569000
*             SVTAB BASED(SVTABFST);/* RESET VTAB BASE               */ 00570000
*           IF SVTABFST^=0 THEN     /* IF A VALUE TABLE PRESENT      */ 00571000
         SLR   @15,@15                                             0194 00572000
         L     @03,LSDPTR(,@03)                                    0194 00573000
         L     @03,LSDEXEC(,@03)                                   0194 00574000
         L     @14,SVTABFST(,@03)                                  0194 00575000
         CR    @14,@15                                             0194 00576000
         BE    @RF00194                                            0194 00577000
*             DO;                   /* FREE VALUE TABLE              */ 00578000
         ST    @03,@TF00001                                        0195 00579000
*               FREEADDR=SVTABFST;  /* STORAGE ADDRESS               */ 00580000
         ST    @14,FREEADDR                                        0196 00581000
*               FREELEN=SVTABLNG;   /* LENGTH |F AREA TO FREE        */ 00582000
         L     FREELEN,SVTABLNG(,@14)                              0197 00583000
*               SVTABFST=0;         /* CLEAR                         */ 00584000
         L     @14,@TF00001                                        0198 00585000
         ST    @15,SVTABFST(,@14)                                  0198 00586000
*               DO;                 /* FREEMAIN LV(FREELEN)        0199 00587000
*                                      MF(E,FRELST)                  */ 00588000
*                 RESPECIFY                                        0200 00589000
*                  (GPR01P) RESTRICTED;                            0200 00590000
*                 FRELST02=FREELEN; /* LENGTH                        */ 00591000
         STCM  FREELEN,7,FRELST02                                  0201 00592000
*                 GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST         */ 00593000
         LA    GPR01P,FRELST                                       0202 00594000
*                 SVC(5);           /* STANDARD-FORM OF GETMAIN      */ 00595000
         SVC   5                                                   0203 00596000
*                 RESPECIFY                                        0204 00597000
*                  (GPR01P) UNRESTRICTED;                          0204 00598000
*               END;                /* FREEMAIN LV(FREELEN)        0205 00599000
*                                      MF(E,FRELST)                  */ 00600000
*             END;                                                 0206 00601000
*           DO WHILE FILEDCBS^=0;   /* FREE FILE BLOCKS IF ANY       */ 00602000
@RF00194 B     @DE00207                                            0207 00603000
@DL00207 DS    0H                                                  0208 00604000
*             OPENADR=ADDR(DCBAREA);/* GET ADDR OF DCB               */ 00605000
         L     @15,@PC00001+4                                      0208 00606000
         L     @01,IOSRLPTR(,@15)                                  0208 00607000
         L     @01,IOSTELM(,@01)                                   0208 00608000
         L     @01,LSDPTR(,@01)                                    0208 00609000
         L     @01,LSDEXEC(,@01)                                   0208 00610000
         L     OPENADR,FILEDCBS(,@01)                              0208 00611000
         LA    OPENADR,DCBAREA(,OPENADR)                           0208 00612000
*             GEN REFS(OPENADR)(CLOSE ((OPENADR)),MF=(E,CLOSELST));     00613000
         CLOSE ((OPENADR)),MF=(E,CLOSELST)                              00614000
*             FREEADDR=FILEDCBS;    /* GET ADDR TO FREE              */ 00615000
         L     @03,@PC00001+4                                      0210 00616000
         L     @03,IOSRLPTR(,@03)                                  0210 00617000
         L     @03,IOSTELM(,@03)                                   0210 00618000
         L     @03,LSDPTR(,@03)                                    0210 00619000
         L     @03,LSDEXEC(,@03)                                   0210 00620000
         L     @15,FILEDCBS(,@03)                                  0210 00621000
         ST    @15,FREEADDR                                        0210 00622000
*             FILEDCBS=NEXTFILE;    /* GO TO NEXT BLOCK              */ 00623000
         L     @15,NEXTFILE(,@15)                                  0211 00624000
         ST    @15,FILEDCBS(,@03)                                  0211 00625000
*             IF DCBOFOPN=NO THEN   /* AS LONG AS DCB IS CLOSED      */ 00626000
         TM    DCBOFOPN+40(OPENADR),B'00010000'                    0212 00627000
         BNZ   @RF00212                                            0212 00628000
*               DO;                 /* FREE ALL STORAGE      @ZA09978*/ 00629000
*                 IF(DCBBUFCB&1)^=1 THEN/* IF BFR POOL       @ZA09978*/ 00630000
         LA    @03,1                                               0214 00631000
         L     @15,DCBBUFCB+16(,OPENADR)                           0214 00632000
         NR    @15,@03                                             0214 00633000
         CR    @15,@03                                             0214 00634000
         BE    @RF00214                                            0214 00635000
*                   GEN REFS(OPENADR)(FREEPOOL (OPENADR));/* @ZA09978*/ 00636000
         FREEPOOL (OPENADR)                                             00637000
*                 DO;               /* FREEMAIN                    0216 00638000
*                                      LV(LENGTH(FILEBLOK)+INLEN)  0216 00639000
*                                      MF(E,FRELST)                  */ 00640000
@RF00214 DS    0H                                                  0217 00641000
*                   RESPECIFY                                      0217 00642000
*                    (GPR01P) RESTRICTED;                          0217 00643000
*                   FRELST02=LENGTH(FILEBLOK)+INLEN;/* LENGTH        */ 00644000
         L     @03,INLEN                                           0218 00645000
         LA    @03,20(,@03)                                        0218 00646000
         STCM  @03,7,FRELST02                                      0218 00647000
*                   GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST       */ 00648000
         LA    GPR01P,FRELST                                       0219 00649000
*                   SVC(5);         /* STANDARD-FORM OF GETMAIN      */ 00650000
         SVC   5                                                   0220 00651000
*                   RESPECIFY                                      0221 00652000
*                    (GPR01P) UNRESTRICTED;                        0221 00653000
*                 END;              /* FREEMAIN                    0222 00654000
*                                      LV(LENGTH(FILEBLOK)+INLEN)  0222 00655000
*                                      MF(E,FRELST)                  */ 00656000
*               END;                /*                       @ZA09978*/ 00657000
*           END;                    /*                               */ 00658000
@RF00212 DS    0H                                                  0224 00659000
@DE00207 L     @03,@PC00001+4                                      0224 00660000
         L     @03,IOSRLPTR(,@03)                                  0224 00661000
         L     @03,IOSTELM(,@03)                                   0224 00662000
         L     @03,LSDPTR(,@03)                                    0224 00663000
         L     @03,LSDEXEC(,@03)                                   0224 00664000
         L     @03,FILEDCBS(,@03)                                  0224 00665000
         LTR   @03,@03                                             0224 00666000
         BNZ   @DL00207                                            0224 00667000
*           RFY                                                    0225 00668000
*             SNTAB BASED(SNTABFST);/* RESET SNTAB BASE              */ 00669000
*           DO WHILE SNTABFST^=0;   /* FREE ALL NAME TABLES          */ 00670000
         B     @DE00226                                            0226 00671000
@DL00226 DS    0H                                                  0227 00672000
*             FREEADDR=SNTABFST;    /* GET ADDR OF TABLE             */ 00673000
         L     @15,@PC00001+4                                      0227 00674000
         L     @01,IOSRLPTR(,@15)                                  0227 00675000
         L     @01,IOSTELM(,@01)                                   0227 00676000
         L     @01,LSDPTR(,@01)                                    0227 00677000
         L     @15,LSDEXEC(,@01)                                   0227 00678000
         L     @14,SNTABFST(,@15)                                  0227 00679000
         ST    @14,FREEADDR                                        0227 00680000
*             FREELEN=SNTABLNG;     /* GET LENGTH OF THE TABLE       */ 00681000
         L     FREELEN,SNTABLNG(,@14)                              0228 00682000
*             SNTABFST=SNTABNXT;    /* GET NEXT BLOCK POINTER        */ 00683000
         L     @14,SNTABNXT(,@14)                                  0229 00684000
         ST    @14,SNTABFST(,@15)                                  0229 00685000
*             DO;                   /* FREEMAIN LV(FREELEN)        0230 00686000
*                                      MF(E,FRELST)                  */ 00687000
*               RESPECIFY                                          0231 00688000
*                (GPR01P) RESTRICTED;                              0231 00689000
*               FRELST02=FREELEN;   /* LENGTH                        */ 00690000
         STCM  FREELEN,7,FRELST02                                  0232 00691000
*               GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST           */ 00692000
         LA    GPR01P,FRELST                                       0233 00693000
*               SVC(5);             /* STANDARD-FORM OF GETMAIN      */ 00694000
         SVC   5                                                   0234 00695000
*               RESPECIFY                                          0235 00696000
*                (GPR01P) UNRESTRICTED;                            0235 00697000
*             END;                  /* FREEMAIN LV(FREELEN)        0236 00698000
*                                      MF(E,FRELST)                  */ 00699000
*           END;                                                   0237 00700000
@DE00226 SLR   @03,@03                                             0237 00701000
         L     @15,@PC00001+4                                      0237 00702000
         L     @01,IOSRLPTR(,@15)                                  0237 00703000
         L     @01,IOSTELM(,@01)                                   0237 00704000
         L     @01,LSDPTR(,@01)                                    0237 00705000
         L     @15,LSDEXEC(,@01)                                   0237 00706000
         C     @03,SNTABFST(,@15)                                  0237 00707000
         BNE   @DL00226                                            0237 00708000
*           IF EXDLMPTR^=0 THEN     /* IF DLMBLOCKS                  */ 00709000
         L     @14,EXDLMPTR(,@15)                                  0238 00710000
         CR    @14,@03                                             0238 00711000
         BE    @RF00238                                            0238 00712000
*             DO;                   /* FREE IT                       */ 00713000
*               FREEADDR=EXDLMPTR;  /* ADDR OF STORAGE               */ 00714000
         ST    @14,FREEADDR                                        0240 00715000
*               FREELEN=LL;         /* LENGTH OF AREA TO FREE        */ 00716000
         LH    FREELEN,LL(,@14)                                    0241 00717000
*               EXDLMPTR=0;         /* BREAK CONNECTION              */ 00718000
         SLR   @14,@14                                             0242 00719000
         ST    @14,EXDLMPTR(,@15)                                  0242 00720000
*               DO;                 /* FREEMAIN LV(FREELEN)        0243 00721000
*                                      MF(E,FRELST)                  */ 00722000
*                 RESPECIFY                                        0244 00723000
*                  (GPR01P) RESTRICTED;                            0244 00724000
*                 FRELST02=FREELEN; /* LENGTH                        */ 00725000
         STCM  FREELEN,7,FRELST02                                  0245 00726000
*                 GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST         */ 00727000
         LA    GPR01P,FRELST                                       0246 00728000
*                 SVC(5);           /* STANDARD-FORM OF GETMAIN      */ 00729000
         SVC   5                                                   0247 00730000
*                 RESPECIFY                                        0248 00731000
*                  (GPR01P) UNRESTRICTED;                          0248 00732000
*               END;                /* FREEMAIN LV(FREELEN)        0249 00733000
*                                      MF(E,FRELST)                  */ 00734000
*             END;                                                 0250 00735000
*           IF LSDEXEC^=0 THEN      /* IF NOT FREED ALREADY          */ 00736000
@RF00238 L     @03,@PC00001+4                                      0251 00737000
         L     @03,IOSRLPTR(,@03)                                  0251 00738000
         L     @03,IOSTELM(,@03)                                   0251 00739000
         L     @03,LSDPTR(,@03)                                    0251 00740000
         L     @03,LSDEXEC(,@03)                                   0251 00741000
         LTR   @03,@03                                             0251 00742000
         BZ    @RF00251                                            0251 00743000
*             DO;                   /* FREE EXECDATA                 */ 00744000
*               IF ATTNCMD=YES THEN /* IS ATTN COMMAND IN EFFECT   0253 00745000
*                                                            @ZA08099*/ 00746000
         TM    ATTNCMD(@03),B'00000001'                            0253 00747000
         BNO   @RF00253                                            0253 00748000
*                 DO;               /* YES, WE MUST DECREMENT      0254 00749000
*                                      RCTDCLST USING STAX   @ZA08099*/ 00750000
*                   STAXD(1:LENSTAX)=STAXC(1:LENSTAX);/* MOVE CSECT     00751000
*                                      TO DSECT              @ZA08099*/ 00752000
         L     @03,LENSTAX                                         0255 00753000
         BCTR  @03,0                                               0255 00754000
         EX    @03,@SM00780                                        0255 00755000
*                   R2=ADDR(STAXD); /*                       @ZA08099*/ 00756000
         LA    R2,STAXD                                            0256 00757000
*                   STXATTOF='1'B;  /* SET FLAG FOR STAX SERVICE RTN    00758000
*                                                            @ZA08099*/ 00759000
         OI    STXATTOF,B'00000100'                                0257 00760000
*                   GEN(STAX MF=(E,(R2)));/*                 @ZA08099*/ 00761000
         STAX MF=(E,(R2))                                               00762000
*                 END;              /*                       @ZA08099*/ 00763000
*               FREEADDR=LSDEXEC;   /* ADDRESS OF AREA TO FREE       */ 00764000
@RF00253 L     @03,@PC00001+4                                      0260 00765000
         L     @03,IOSRLPTR(,@03)                                  0260 00766000
         L     @03,IOSTELM(,@03)                                   0260 00767000
         L     @03,LSDPTR(,@03)                                    0260 00768000
         L     @15,LSDEXEC(,@03)                                   0260 00769000
         ST    @15,FREEADDR                                        0260 00770000
*               LSDEXEC=0;          /* BREAK CONNECTION              */ 00771000
         SLR   @15,@15                                             0261 00772000
         ST    @15,LSDEXEC(,@03)                                   0261 00773000
*               DO;                 /* FREEMAIN LV(LENGTH(EXECDATA))    00774000
*                                      MF(E,FRELST)                  */ 00775000
*                 RESPECIFY                                        0263 00776000
*                  (GPR01P) RESTRICTED;                            0263 00777000
*                 FRELST02=LENGTH(EXECDATA);/* LENGTH                */ 00778000
         MVC   FRELST02(3),@CF00767+1                              0264 00779000
*                 GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST         */ 00780000
         LA    GPR01P,FRELST                                       0265 00781000
*                 SVC(5);           /* STANDARD-FORM OF GETMAIN      */ 00782000
         SVC   5                                                   0266 00783000
*                 RESPECIFY                                        0267 00784000
*                  (GPR01P) UNRESTRICTED;                          0267 00785000
*               END;                /* FREEMAIN LV(LENGTH(EXECDATA))    00786000
*                                      MF(E,FRELST)                  */ 00787000
*             END;                                                 0269 00788000
*           ECDACBLK=LSDADATA;      /* FREE STORAGE BLOCKS           */ 00789000
@RF00251 L     @03,@PC00001+4                                      0270 00790000
         L     @03,IOSRLPTR(,@03)                                  0270 00791000
         L     @03,IOSTELM(,@03)                                   0270 00792000
         L     @03,LSDPTR(,@03)                                    0270 00793000
         L     ECDACBLK,LSDADATA(,@03)                             0270 00794000
*           DO WHILE COMPRNXT^=0;   /* FREE EXTRA STORAGE BLOCKS     */ 00795000
         B     @DE00271                                            0271 00796000
@DL00271 DS    0H                                                  0272 00797000
*             FREEADDR=COMPRNXT;    /* GET ADDRESS OF STORAGE BLOCK  */ 00798000
         L     @05,COMPRNXT-1(,ECDACBLK)                           0272 00799000
         LA    @05,0(,@05)                                         0272 00800000
         ST    @05,FREEADDR                                        0272 00801000
*             FREELEN=COMPRNXT->COMPRLNG;/* GET LENGTH TO FREE       */ 00802000
         L     FREELEN,COMPRLNG(,@05)                              0273 00803000
*             COMPRNXT=COMPRNXT->COMPRNXT;/* GET NEXT BLOCK POINTER  */ 00804000
         L     @05,COMPRNXT-1(,@05)                                0274 00805000
         LA    @05,0(,@05)                                         0274 00806000
         STCM  @05,7,COMPRNXT(ECDACBLK)                            0274 00807000
*             DO;                   /* FREEMAIN LV(FREELEN)        0275 00808000
*                                      MF(E,FRELST)                  */ 00809000
*               RESPECIFY                                          0276 00810000
*                (GPR01P) RESTRICTED;                              0276 00811000
*               FRELST02=FREELEN;   /* LENGTH                        */ 00812000
         STCM  FREELEN,7,FRELST02                                  0277 00813000
*               GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST           */ 00814000
         LA    GPR01P,FRELST                                       0278 00815000
*               SVC(5);             /* STANDARD-FORM OF GETMAIN      */ 00816000
         SVC   5                                                   0279 00817000
*               RESPECIFY                                          0280 00818000
*                (GPR01P) UNRESTRICTED;                            0280 00819000
*             END;                  /* FREEMAIN LV(FREELEN)        0281 00820000
*                                      MF(E,FRELST)                  */ 00821000
*           END;                    /*                               */ 00822000
@DE00271 L     @05,COMPRNXT-1(,ECDACBLK)                           0282 00823000
         LA    @05,0(,@05)                                         0282 00824000
         LTR   @05,@05                                             0282 00825000
         BNZ   @DL00271                                            0282 00826000
*         END;                      /* DONE EXTRA STORAGE            */ 00827000
*       FREEADDR=LSDADATA;          /* FREE INSTORAGE LIST           */ 00828000
@RF00191 L     @15,@PC00001+4                                      0284 00829000
         L     @01,IOSRLPTR(,@15)                                  0284 00830000
         L     @01,IOSTELM(,@01)                                   0284 00831000
         L     @15,LSDPTR(,@01)                                    0284 00832000
         L     @14,LSDADATA(,@15)                                  0284 00833000
         ST    @14,FREEADDR                                        0284 00834000
*       FREELEN=LSDTOTLN;           /* LENGTH OF INSTORAGE LIST      */ 00835000
         LH    FREELEN,LSDTOTLN(,@15)                              0285 00836000
*       DO;                         /* FREEMAIN LV(FREELEN)        0286 00837000
*                                      MF(E,FRELST)                  */ 00838000
*         RESPECIFY                                                0287 00839000
*          (GPR01P) RESTRICTED;                                    0287 00840000
*         FRELST02=FREELEN;         /* LENGTH                        */ 00841000
         STCM  FREELEN,7,FRELST02                                  0288 00842000
*         GPR01P=ADDR(FRELST);      /* REG1 POINTS TO LIST           */ 00843000
         LA    GPR01P,FRELST                                       0289 00844000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 00845000
         SVC   5                                                   0290 00846000
*         RESPECIFY                                                0291 00847000
*          (GPR01P) UNRESTRICTED;                                  0291 00848000
*       END;                        /* FREEMAIN LV(FREELEN)        0292 00849000
*                                      MF(E,FRELST)                  */ 00850000
*       FREEADDR=LSDPTR;            /* FREE LSD                      */ 00851000
         L     @03,@PC00001+4                                      0293 00852000
         L     @03,IOSRLPTR(,@03)                                  0293 00853000
         L     @03,IOSTELM(,@03)                                   0293 00854000
         L     @03,LSDPTR(,@03)                                    0293 00855000
         ST    @03,FREEADDR                                        0293 00856000
*       DO;                         /* FREEMAIN LV(LSDSIZE)        0294 00857000
*                                      MF(E,FRELST)                  */ 00858000
*         RESPECIFY                                                0295 00859000
*          (GPR01P) RESTRICTED;                                    0295 00860000
*         FRELST02=LSDSIZE;         /* LENGTH                        */ 00861000
         MVC   FRELST02(3),@CF00185+1                              0296 00862000
*         GPR01P=ADDR(FRELST);      /* REG1 POINTS TO LIST           */ 00863000
         LA    GPR01P,FRELST                                       0297 00864000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 00865000
         SVC   5                                                   0298 00866000
*         RESPECIFY                                                0299 00867000
*          (GPR01P) UNRESTRICTED;                                  0299 00868000
*       END;                        /* FREEMAIN LV(LSDSIZE)        0300 00869000
*                                      MF(E,FRELST)                  */ 00870000
*     END;                          /* END OF STORAGE ELEMENT        */ 00871000
*   IF INSDATA=YES THEN             /* IF DATASET ELEMENT, CALL      */ 00872000
@RF00184 L     @03,@PC00001+4                                      0302 00873000
         L     @03,IOSRLPTR(,@03)                                  0302 00874000
         L     @03,IOSTELM(,@03)                                   0302 00875000
         TM    INSDATA(@03),B'10000000'                            0302 00876000
         BNO   @RF00302                                            0302 00877000
*     CALL CLOSERTN;                /* CLOSE ROUTINE                 */ 00878000
         BAL   @14,CLOSERTN                                        0303 00879000
*   END UNSTACK;                    /* END OF UNSTACK                */ 00880000
@EL00002 DS    0H                                                  0304 00881000
@EF00002 DS    0H                                                  0304 00882000
@ER00002 LM    @14,@12,@SA00002                                    0304 00883000
         BR    @14                                                 0304 00884000
*OPENRTN:                                                          0305 00885000
*   PROC;                                                          0305 00886000
OPENRTN  STM   @14,@12,@SA00003                                    0305 00887000
*   RFY                                                            0306 00888000
*     INSTACK BASED(IOSTELM+ASTAKELM);/* RESET BASE                  */ 00889000
*   IOSTELM=IOSTELM-ASTAKELM;       /* BACK DOWN                     */ 00890000
         L     @08,@PC00001+4                                      0307 00891000
         L     @08,IOSRLPTR(,@08)                                  0307 00892000
         L     @03,IOSTELM(,@08)                                   0307 00893000
         SL    @03,@CF00068                                        0307 00894000
         ST    @03,IOSTELM(,@08)                                   0307 00895000
*   RETURNCD=0;                     /* SET RETRUN CODE TO 0          */ 00896000
         SLR   RETURNCD,RETURNCD                                   0308 00897000
*   LEN=INLEN+OTLEN+LENGTH(DSDFLAGS);/* GET LENGTH OF IODSD REQ      */ 00898000
         L     @08,INLEN                                           0309 00899000
         AL    @08,OTLEN                                           0309 00900000
         LA    @08,16(,@08)                                        0309 00901000
         STCM  @08,7,LEN                                           0309 00902000
*   SPOOL=SP78;                     /* SET SHARED SUBPOOL            */ 00903000
         MVI   SPOOL,X'4E'                                         0310 00904000
*   RFY                                                            0311 00905000
*    (R0,                                                          0311 00906000
*     R1) RSTD;                     /* RESTRICT REGS                 */ 00907000
*   R0=LNGTH;                       /* LOAD REG ZERO FOR GETMAIN     */ 00908000
         L     R0,LNGTH                                            0312 00909000
*   GEN(GETMAIN R,LV=(0));          /* ISSUE GETMAIN                 */ 00910000
         GETMAIN R,LV=(0)                                               00911000
*   IODSDPTR=R1;                    /* SET BASE FOR IODSD            */ 00912000
         L     @08,@PC00001+4                                      0314 00913000
         L     @08,IOSRLPTR(,@08)                                  0314 00914000
         L     @08,IOSTELM(,@08)                                   0314 00915000
         STCM  R1,7,IODSDPTR+4(@08)                                0314 00916000
*   RFY                                                            0315 00917000
*    (R0,                                                          0315 00918000
*     R1) UNRSTD;                   /* RELEASE REGS                  */ 00919000
*   DSDFLAGS=''B;                   /* CLEAR ALL FLAG BITS           */ 00920000
         L     @08,@PC00001+4                                      0316 00921000
         L     @08,IOSRLPTR(,@08)                                  0316 00922000
         L     @08,IOSTELM(,@08)                                   0316 00923000
         L     @08,IODSDPTR+3(,@08)                                0316 00924000
         LA    @08,0(,@08)                                         0316 00925000
         XC    DSDFLAGS(16,@08),DSDFLAGS(@08)                      0316 00926000
*   DSDOPTS=SPBCODE;                /* SET OPTION BYTE               */ 00927000
         L     @03,@PC00001+12                                     0317 00928000
         IC    @15,SPBCODE(,@03)                                   0317 00929000
         STC   @15,DSDOPTS(,@08)                                   0317 00930000
*   IF SPBCNTL=YES THEN             /* IF CONTROLS IN DATASET        */ 00931000
         TM    SPBCNTL(@03),B'00000010'                            0318 00932000
         BNO   @RF00318                                            0318 00933000
*     DSDCNTL=YES;                  /* SET CNTL BIT                  */ 00934000
         OI    DSDCNTL(@08),B'01000000'                            0319 00935000
*   IF SPBSEQ=YES THEN              /* IF SEQ NUMBERS DESIRED        */ 00936000
@RF00318 L     @08,@PC00001+12                                     0320 00937000
         TM    SPBSEQ(@08),B'00000100'                             0320 00938000
         BNO   @RF00320                                            0320 00939000
*     DSDSEQ=YES;                   /* SET TO ALLOW SEQ NUMBERS      */ 00940000
         L     @08,@PC00001+4                                      0321 00941000
         L     @08,IOSRLPTR(,@08)                                  0321 00942000
         L     @08,IOSTELM(,@08)                                   0321 00943000
         L     @08,IODSDPTR+3(,@08)                                0321 00944000
         OI    DSDSEQ(@08),B'10000000'                             0321 00945000
*   IF IOSBELM->IODSDPTR^=0&IOSBELM->INSPROM=NO THEN/* NOPROMPT      */ 00946000
@RF00320 L     @08,@PC00001+4                                      0322 00947000
         L     @08,IOSRLPTR(,@08)                                  0322 00948000
         L     @03,IOSBELM(,@08)                                   0322 00949000
         L     @15,IODSDPTR-1(,@03)                                0322 00950000
         LA    @15,0(,@15)                                         0322 00951000
         LTR   @15,@15                                             0322 00952000
         BZ    @RF00322                                            0322 00953000
         TM    INSPROM(@03),B'00000100'                            0322 00954000
         BNZ   @RF00322                                            0322 00955000
*     INSPROM=NO;                   /* INSURE NOPROMPT               */ 00956000
         L     @08,IOSTELM(,@08)                                   0323 00957000
         NI    INSPROM+4(@08),B'11111011'                          0323 00958000
*   DSDLINES=56;                    /* NUMBER OF LINES TO A PAGE     */ 00959000
@RF00322 L     @08,@PC00001+4                                      0324 00960000
         L     @08,IOSRLPTR(,@08)                                  0324 00961000
         L     @08,IOSTELM(,@08)                                   0324 00962000
         L     @08,IODSDPTR+3(,@08)                                0324 00963000
         LA    @08,0(,@08)                                         0324 00964000
         MVI   DSDLINES(@08),X'38'                                 0324 00965000
*   IF SPBINDD=YES THEN             /* IF AN INPUT DCB IS REQ        */ 00966000
         L     @03,@PC00001+12                                     0325 00967000
         TM    SPBINDD(@03),B'00100000'                            0325 00968000
         BNO   @RF00325                                            0325 00969000
*     IF SPBMBR=NO THEN             /* IF NOT MBR PROCESSING         */ 00970000
         TM    SPBMBR(@03),B'00001000'                             0326 00971000
         BNZ   @RF00326                                            0326 00972000
*       DO;                         /* MOVE ONE IN AND OPEN IT       */ 00973000
*         DSDQSAM=YES;              /* TELL RBBMC TO USE QSAM        */ 00974000
         OI    DSDQSAM(@08),B'00100000'                            0328 00975000
*         INDCB(1:INLEN)=INLST(1:INLEN);/*                           */ 00976000
         LA    @15,16                                              0329 00977000
         LR    @14,@08                                             0329 00978000
         ALR   @14,@15                                             0329 00979000
         L     @07,INLEN                                           0329 00980000
         BCTR  @07,0                                               0329 00981000
         EX    @07,@SM00786                                        0329 00982000
*         OPENADR=ADDR(INDCB);      /* SET OPEN PARAMETERS           */ 00983000
         ALR   @08,@15                                             0330 00984000
         LR    OPENADR,@08                                         0330 00985000
*         DCBDDNAM=INDDNAME;        /* PUT PASSED DDNAME IN DCB      */ 00986000
         L     @08,SPBINDDN(,@03)                                  0331 00987000
         MVC   DCBDDNAM+40(8,OPENADR),INDDNAME(@08)                0331 00988000
*         GEN REFS(OPENADR)(OPEN ((OPENADR),(INPUT)),MF=(E,OPENL));     00989000
         OPEN ((OPENADR),(INPUT)),MF=(E,OPENL)                          00990000
*         IF DCBOFOPN=NO THEN       /* IF OPEN UNSUCCESSFUL          */ 00991000
         TM    DCBOFOPN+40(OPENADR),B'00010000'                    0333 00992000
         BNZ   @RF00333                                            0333 00993000
*           RETURNCD=BADINOPN;      /* SET RETURNCODE TO 8           */ 00994000
         LA    RETURNCD,8                                          0334 00995000
*         ELSE                      /* IF OK SET MINIMUM             */ 00996000
*           DO;                     /* BUFFER SIZE                   */ 00997000
         B     @RC00333                                            0335 00998000
@RF00333 DS    0H                                                  0336 00999000
*             IF DCBRECL=U THEN     /* FOR UNDEFINED RECORDS         */ 01000000
         TM    DCBRECL+28(OPENADR),B'11000000'                     0336 01001000
         BNO   @RF00336                                            0336 01002000
*               DSDMINBF=DCBBLKSI;  /* MIN BFR = BLKSI               */ 01003000
         L     @08,@PC00001+4                                      0337 01004000
         L     @08,IOSRLPTR(,@08)                                  0337 01005000
         L     @08,IOSTELM(,@08)                                   0337 01006000
         L     @08,IODSDPTR+3(,@08)                                0337 01007000
         LH    @03,DCBBLKSI+52(,OPENADR)                           0337 01008000
         STH   @03,DSDMINBF(,@08)                                  0337 01009000
*             ELSE                  /* OTHERWISE MINIMUB BFR         */ 01010000
*               DSDMINBF=DCBLRECL;  /* IS DCBLRECL                   */ 01011000
         B     @RC00336                                            0338 01012000
@RF00336 L     @08,@PC00001+4                                      0338 01013000
         L     @08,IOSRLPTR(,@08)                                  0338 01014000
         L     @08,IOSTELM(,@08)                                   0338 01015000
         L     @08,IODSDPTR+3(,@08)                                0338 01016000
         LH    @03,DCBLRECL+72(,OPENADR)                           0338 01017000
         STH   @03,DSDMINBF(,@08)                                  0338 01018000
*           END;                                                   0339 01019000
*       END;                                                       0340 01020000
*     ELSE                                                         0341 01021000
*       DO;                                                        0341 01022000
         B     @RC00326                                            0341 01023000
@RF00326 DS    0H                                                  0342 01024000
*         RFY                                                      0342 01025000
*           R15 RSTD;               /* RESTRICT REG                  */ 01026000
*         DO;                       /* GETMAIN (EC)                0343 01027000
*                                      LV(LENGTH(BPAMBLK)+POLEN)   0343 01028000
*                                      A(DSDBPAM) SP(78) MF(E,GETLST)   01029000
*                                      RTCD(R15)                     */ 01030000
*           RESPECIFY                                              0344 01031000
*            (GPR01P,                                              0344 01032000
*             GPR15F) RESTRICTED;                                  0344 01033000
*           GETLST04='20'X;         /* TYPE                          */ 01034000
         MVI   GETLST04,X'20'                                      0345 01035000
*           GETLST01=LENGTH(BPAMBLK)+POLEN;/* LENGTH                 */ 01036000
         LA    @14,156                                             0346 01037000
         AL    @14,POLEN                                           0346 01038000
         ST    @14,GETLST01                                        0346 01039000
*           GETLST03=ADDR(DSDBPAM); /* ADDR OF ADDR LIST             */ 01040000
         L     @14,@PC00001+4                                      0347 01041000
         L     @14,IOSRLPTR(,@14)                                  0347 01042000
         L     @14,IOSTELM(,@14)                                   0347 01043000
         L     @14,IODSDPTR+3(,@14)                                0347 01044000
         LA    @14,0(,@14)                                         0347 01045000
         LA    @14,DSDBPAM(,@14)                                   0347 01046000
         STCM  @14,7,GETLST03                                      0347 01047000
*           GETLST05=78;            /* SUBPOOL VALUE                 */ 01048000
         MVI   GETLST05,X'4E'                                      0348 01049000
*           GPR01P=ADDR(GETLST);    /* REG1 POINTS TO LIST           */ 01050000
         LA    GPR01P,GETLST                                       0349 01051000
*           SVC(4);                 /* STANDARD-FORM OF GETMAIN      */ 01052000
         SVC   4                                                   0350 01053000
*           R15=GPR15F;             /* SET RETURN CODE               */ 01054000
*           RESPECIFY                                              0352 01055000
*            (GPR01P,                                              0352 01056000
*             GPR15F) UNRESTRICTED;                                0352 01057000
*         END;                      /* GETMAIN (EC)                0353 01058000
*                                      LV(LENGTH(BPAMBLK)+POLEN)   0353 01059000
*                                      A(DSDBPAM) SP(78) MF(E,GETLST)   01060000
*                                      RTCD(R15)                     */ 01061000
*         IF R15^=0 THEN            /* IF GETMAIN FAILED             */ 01062000
         LTR   R15,R15                                             0354 01063000
         BZ    @RF00354                                            0354 01064000
*           DO;                     /*                               */ 01065000
*             RFY                                                  0356 01066000
*               R15 UNRSTD;         /* RELEASE REG                   */ 01067000
*             NOBPAM=YES;           /* NO BPAM BLOCK                 */ 01068000
*             NOBFRS=YES;           /* AND NO BUFFERS                */ 01069000
         OI    NOBPAM,B'01100000'                                  0358 01070000
*             RETURNCD=GETFAIL;     /* GETMIAN FAIL                  */ 01071000
         LA    RETURNCD,20                                         0359 01072000
*           END;                    /*                               */ 01073000
*         ELSE                      /* OTHERWISE                     */ 01074000
*           DO;                     /* CONTINUE                      */ 01075000
         B     @RC00354                                            0361 01076000
@RF00354 DS    0H                                                  0362 01077000
*             DSDFRST=YES;          /* TELL RBBMC TO CHECK FRST      */ 01078000
         L     @08,@PC00001+4                                      0362 01079000
         L     @08,IOSRLPTR(,@08)                                  0362 01080000
         L     @08,IOSTELM(,@08)                                   0362 01081000
         L     @08,IODSDPTR+3(,@08)                                0362 01082000
         LA    @08,0(,@08)                                         0362 01083000
         OI    DSDFRST(@08),B'00010000'                            0362 01084000
*             BPAMDCB(1:POLEN)=PODCB(1:POLEN);/* GET BPAM DCB        */ 01085000
         L     @08,DSDBPAM(,@08)                                   0363 01086000
         L     @03,POLEN                                           0363 01087000
         BCTR  @03,0                                               0363 01088000
         EX    @03,@SM00788                                        0363 01089000
*             OPENADR=ADDR(BPAMDCB);/* GET ADDR OF DCB               */ 01090000
         LA    OPENADR,BPAMDCB(,@08)                               0364 01091000
*             DCBDDNAM=INDDNAME;    /* GET DD NAME                   */ 01092000
         L     @08,@PC00001+12                                     0365 01093000
         L     @08,SPBINDDN(,@08)                                  0365 01094000
         MVC   DCBDDNAM+40(8,OPENADR),INDDNAME(@08)                0365 01095000
*             DCBEXLSA=ADDR(EXITPARM);/* SET UP FOR OPEN EXIT        */ 01096000
         LA    @08,EXITPARM                                        0366 01097000
         STCM  @08,7,DCBEXLSA+28(OPENADR)                          0366 01098000
*             EXITPARM=DCBEXIT;     /*                               */ 01099000
         MVI   EXITPARM,X'85'                                      0367 01100000
*             EXITADDR=ADDR(BPAMEXIT);/*                             */ 01101000
         LA    @08,BPAMEXIT                                        0368 01102000
         STCM  @08,7,EXITADDR                                      0368 01103000
*             GEN FLOWS(BPAMEXIT)                                  0369 01104000
*                 (OPEN ((OPENADR),(INPUT)),MF=(E,OPENL));         0369 01105000
         OPEN ((OPENADR),(INPUT)),MF=(E,OPENL)                          01106000
*             IF NOBFRS=YES THEN    /* IF BUFFER GETMAIN FAILED      */ 01107000
         TM    NOBFRS,B'00100000'                                  0370 01108000
         BNO   @RF00370                                            0370 01109000
*               RETURNCD=GETFAIL;   /* ERROR CODE                    */ 01110000
         LA    RETURNCD,20                                         0371 01111000
*             ELSE                  /* OTHERWISE                     */ 01112000
*               IF DCBOFOPN=NO THEN /* IF DCB DID NOT OPEN           */ 01113000
         B     @RC00370                                            0372 01114000
@RF00370 TM    DCBOFOPN+40(OPENADR),B'00010000'                    0372 01115000
         BNZ   @RF00372                                            0372 01116000
*                 RETURNCD=BADINOPN;/* SET PROPER RETURN CODE        */ 01117000
         LA    RETURNCD,8                                          0373 01118000
*               ELSE                /* IF DCB DID OPEN               */ 01119000
*                 DO;               /* SET UP TO DO FIND             */ 01120000
         B     @RC00372                                            0374 01121000
@RF00372 DS    0H                                                  0375 01122000
*                   IF DCBRECL=U THEN/* FOR FORMAT U, USE BLOCKSIZE  */ 01123000
         TM    DCBRECL+28(OPENADR),B'11000000'                     0375 01124000
         BNO   @RF00375                                            0375 01125000
*                     DSDMINBF=DCBBLKSI;/*                           */ 01126000
         L     @08,@PC00001+4                                      0376 01127000
         L     @08,IOSRLPTR(,@08)                                  0376 01128000
         L     @08,IOSTELM(,@08)                                   0376 01129000
         L     @08,IODSDPTR+3(,@08)                                0376 01130000
         LH    @03,DCBBLKSI+52(,OPENADR)                           0376 01131000
         STH   @03,DSDMINBF(,@08)                                  0376 01132000
*                   ELSE            /* OTHERWISE                     */ 01133000
*                     DSDMINBF=DCBLRECL;/* USE LRECL                 */ 01134000
         B     @RC00375                                            0377 01135000
@RF00375 L     @08,@PC00001+4                                      0377 01136000
         L     @08,IOSRLPTR(,@08)                                  0377 01137000
         L     @08,IOSTELM(,@08)                                   0377 01138000
         L     @08,IODSDPTR+3(,@08)                                0377 01139000
         LH    @03,DCBLRECL+72(,OPENADR)                           0377 01140000
         STH   @03,DSDMINBF(,@08)                                  0377 01141000
*                   RFY                                            0378 01142000
*                    (R4,                                          0378 01143000
*                     R15) RSTD;    /* RESTRICT REG 4 AND 15         */ 01144000
@RC00375 DS    0H                                                  0379 01145000
*                   R4=SPBMBRNM;    /* POINT TO MEMBER NAME          */ 01146000
         L     @14,@PC00001+12                                     0379 01147000
         L     R4,SPBMBRNM(,@14)                                   0379 01148000
*                   GEN(FIND (OPENADR),(R4),D);/* FIND MEMBER GIVEN  */ 01149000
         FIND (OPENADR),(R4),D                                          01150000
*                   RFY                                            0381 01151000
*                    (R4) UNRSTD;   /* RELEASE REG 4                 */ 01152000
*                   IF R15^=0 THEN  /* IF MEMBER NOT FOUND           */ 01153000
         LTR   R15,R15                                             0382 01154000
         BZ    @RF00382                                            0382 01155000
*                     RETURNCD=NOMEMBER;/* SET ERROR CODE            */ 01156000
         LA    RETURNCD,16                                         0383 01157000
*                   ELSE            /* IF MEMBER FOUND               */ 01158000
*                     DO;           /* PRIME BUFFERS                 */ 01159000
         B     @RC00382                                            0384 01160000
@RF00382 DS    0H                                                  0385 01161000
*                       RFY                                        0385 01162000
*                         R15 UNRSTD;/* RELEASE REG                  */ 01163000
*                       RFY                                        0386 01164000
*                        (R4,                                      0386 01165000
*                         R5) RSTD; /* RESTRICT REGS                 */ 01166000
*                       DO I=1 TO DECBMAX;/* GET THE SWOW ON THE ROAD*/ 01167000
         LA    I,1                                                 0387 01168000
         B     @DE00387                                            0387 01169000
@DL00387 DS    0H                                                  0388 01170000
*                         IF I=1 THEN/* FOR FIRST READ               */ 01171000
         C     I,@CF00040                                          0388 01172000
         BNE   @RF00388                                            0388 01173000
*                           R5=CURBLK(1);/* POINT TO GOTTEN BLOCK    */ 01174000
         L     @08,@PC00001+4                                      0389 01175000
         L     @08,IOSRLPTR(,@08)                                  0389 01176000
         L     @08,IOSTELM(,@08)                                   0389 01177000
         L     @08,IODSDPTR+3(,@08)                                0389 01178000
         L     @08,DSDBPAM(,@08)                                   0389 01179000
         L     R5,CURBLK(,@08)                                     0389 01180000
*                         ELSE      /* OTHERWISE                     */ 01181000
*                           R5=R5+DCBBLKSI;/* INCREMENT BY BLOCK SIZE*/ 01182000
         B     @RC00388                                            0390 01183000
@RF00388 AH    R5,DCBBLKSI+52(,OPENADR)                            0390 01184000
*                         R4=ADDR(CURDECB(I));/* GET ADDR OF DECB TO    01185000
*                                      USE                           */ 01186000
@RC00388 LR    @08,I                                               0391 01187000
         MH    @08,@CH00238                                        0391 01188000
         L     @15,@PC00001+4                                      0391 01189000
         L     @01,IOSRLPTR(,@15)                                  0391 01190000
         L     @01,IOSTELM(,@01)                                   0391 01191000
         L     @01,IODSDPTR+3(,@01)                                0391 01192000
         L     @15,DSDBPAM(,@01)                                   0391 01193000
         LA    R4,CURDECB-20(@08,@15)                              0391 01194000
*                         CURDECB(I)=RDM(1:READLEN);/* COPY READ LIST   01195000
*                                      FORM                          */ 01196000
         ALR   @08,@15                                             0392 01197000
         MVI   CURDECB-19(@08),C' '                                0392 01198000
         MVC   CURDECB-18(18,@08),CURDECB-19(@08)                  0392 01199000
         L     @14,READLEN                                         0392 01200000
         BCTR  @14,0                                               0392 01201000
         EX    @14,@SM00790                                        0392 01202000
*                         CURBLK(I)=R5;/* SAVE I/O BUFFER POINTER    */ 01203000
         LR    @08,I                                               0393 01204000
         SLA   @08,2                                               0393 01205000
         ST    R5,CURBLK-4(@08,@15)                                0393 01206000
*                         GEN(READ (R4),SF,(OPENADR),(R5),MF=E);/* 0394 01207000
*                                      START I/O                     */ 01208000
         READ (R4),SF,(OPENADR),(R5),MF=E                               01209000
*                       END;        /*                               */ 01210000
         AL    I,@CF00040                                          0395 01211000
@DE00387 L     @08,@PC00001+4                                      0395 01212000
         L     @08,IOSRLPTR(,@08)                                  0395 01213000
         L     @08,IOSTELM(,@08)                                   0395 01214000
         L     @08,IODSDPTR+3(,@08)                                0395 01215000
         L     @08,DSDBPAM(,@08)                                   0395 01216000
         CH    I,DECBMAX(,@08)                                     0395 01217000
         BNH   @DL00387                                            0395 01218000
*                       RFY                                        0396 01219000
*                        (R4,                                      0396 01220000
*                         R5) UNRSTD;/* RELEASE REGS                 */ 01221000
*                       DECBINDX=1; /* INIT INDEX                    */ 01222000
         L     @08,@PC00001+4                                      0397 01223000
         L     @08,IOSRLPTR(,@08)                                  0397 01224000
         L     @08,IOSTELM(,@08)                                   0397 01225000
         L     @08,IODSDPTR+3(,@08)                                0397 01226000
         L     @08,DSDBPAM(,@08)                                   0397 01227000
         MVC   DECBINDX(2,@08),@CH00040                            0397 01228000
*                     END;                                         0398 01229000
*                 END;                                             0399 01230000
*           END;                                                   0400 01231000
*       END;                                                       0401 01232000
*   ELSE                            /*                               */ 01233000
*     DO;                           /* IF IN BACKGROUND, SET MINBF   */ 01234000
         B     @RC00325                                            0402 01235000
@RF00325 DS    0H                                                  0403 01236000
*       IF INSINDD=YES THEN         /*                               */ 01237000
         L     @08,@PC00001+4                                      0403 01238000
         L     @08,IOSRLPTR(,@08)                                  0403 01239000
         LA    @03,4                                               0403 01240000
         AL    @03,IOSTELM(,@08)                                   0403 01241000
         TM    INSINDD(@03),B'00100000'                            0403 01242000
         BNO   @RF00403                                            0403 01243000
*         DO;                       /*                               */ 01244000
         ST    @08,@TF00001                                        0404 01245000
*           RFY                                                    0405 01246000
*             INSTACK BASED(IOSBELM);/* SET BASE                     */ 01247000
*           TEMP31=DSDMINBF;        /* GET BOTTOM MINBF              */ 01248000
         L     @01,@TF00001                                        0406 01249000
         L     @01,IOSBELM(,@01)                                   0406 01250000
         L     @01,IODSDPTR-1(,@01)                                0406 01251000
         LH    TEMP31,DSDMINBF(,@01)                               0406 01252000
*           RFY                                                    0407 01253000
*             INSTACK BASED(IOSTELM+ASTAKELM);/* RESET BASE          */ 01254000
*           DSDMINBF=TEMP31;        /* SET DSDMINBF                  */ 01255000
         L     @03,IODSDPTR-1(,@03)                                0408 01256000
         STH   TEMP31,DSDMINBF(,@03)                               0408 01257000
*         END;                                                     0409 01258000
*     END;                                                         0410 01259000
@RF00403 DS    0H                                                  0411 01260000
*   IF SPBOTDD=YES&RETURNCD=0 THEN  /* IF OUTPUT DCB REQ AND         */ 01261000
@RC00325 L     @08,@PC00001+12                                     0411 01262000
         TM    SPBOTDD(@08),B'00010000'                            0411 01263000
         BNO   @RF00411                                            0411 01264000
         LTR   RETURNCD,RETURNCD                                   0411 01265000
         BNZ   @RF00411                                            0411 01266000
*     DO;                           /* INPUT SUCCESSFUL              */ 01267000
*       DSDQSAM=YES;                /* INDICATE QSAM DCB     @ZA12377*/ 01268000
         L     @03,@PC00001+4                                      0413 01269000
         L     @03,IOSRLPTR(,@03)                                  0413 01270000
         L     @03,IOSTELM(,@03)                                   0413 01271000
         L     @03,IODSDPTR+3(,@03)                                0413 01272000
         LA    @03,0(,@03)                                         0413 01273000
         OI    DSDQSAM(@03),B'00100000'                            0413 01274000
*       OTDCB(1:OTLEN)=OTLST(1:OTLEN);/* MOVE IN AN OUTPUT DCB       */ 01275000
         LA    @15,16                                              0414 01276000
         AL    @03,INLEN                                           0414 01277000
         LR    @14,@03                                             0414 01278000
         ALR   @14,@15                                             0414 01279000
         L     @07,OTLEN                                           0414 01280000
         BCTR  @07,0                                               0414 01281000
         EX    @07,@SM00792                                        0414 01282000
*       OPENADR=ADDR(OTDCB);        /* A DDNAME , THEN ISSUE         */ 01283000
         ALR   @03,@15                                             0415 01284000
         LR    OPENADR,@03                                         0415 01285000
*       DCBDDNAM=OTDDNAME;          /* THE OPEN                      */ 01286000
         L     @08,SPBOTDDN(,@08)                                  0416 01287000
         MVC   DCBDDNAM+40(8,OPENADR),OTDDNAME(@08)                0416 01288000
*       DCBEXLSA=ADDR(EXITPARM);    /* PUT PUT EXITPARM IN DCB       */ 01289000
         LA    @08,EXITPARM                                        0417 01290000
         STCM  @08,7,DCBEXLSA+28(OPENADR)                          0417 01291000
*       EXITPARM=DCBEXIT;           /* FILL EXIT PARMS               */ 01292000
         MVI   EXITPARM,X'85'                                      0418 01293000
*       EXITADDR=ADDR(OPENEXIT);    /*                               */ 01294000
         LA    @08,OPENEXIT                                        0419 01295000
         STCM  @08,7,EXITADDR                                      0419 01296000
*       GEN FLOWS(OPENEXIT) REFS(OPENADR)                          0420 01297000
*           (OPEN ((OPENADR),(OUTPUT)),MF=(E,OPENL));              0420 01298000
         OPEN ((OPENADR),(OUTPUT)),MF=(E,OPENL)                         01299000
*       IF DCBOFOPN=NO THEN         /* IF OPEN UNSUCCESSFUL          */ 01300000
         TM    DCBOFOPN+40(OPENADR),B'00010000'                    0421 01301000
         BNZ   @RF00421                                            0421 01302000
*         RETURNCD=BADOTOPN;        /* SET RETURNCD TO 12            */ 01303000
         LA    RETURNCD,12                                         0422 01304000
*     END;                                                         0423 01305000
@RF00421 DS    0H                                                  0424 01306000
*   IOSTELM=IOSTELM+ASTAKELM;       /* RESTORE                       */ 01307000
@RF00411 L     @08,@PC00001+4                                      0424 01308000
         L     @08,IOSRLPTR(,@08)                                  0424 01309000
         LA    @03,4                                               0424 01310000
         AL    @03,IOSTELM(,@08)                                   0424 01311000
         ST    @03,IOSTELM(,@08)                                   0424 01312000
*   RFY                                                            0425 01313000
*     INSTACK BASED(IOSTELM);                                      0425 01314000
*   RETURN CODE(RETURNCD);          /* RETURN TO MAINLINE            */ 01315000
         LR    @15,RETURNCD                                        0426 01316000
         L     @14,@SA00003                                        0426 01317000
         LM    @00,@12,@SA00003+8                                  0426 01318000
         BR    @14                                                 0426 01319000
*   END OPENRTN;                                                   0427 01320000
*CLOSERTN:                                                         0428 01321000
*   PROC;                                                          0428 01322000
CLOSERTN STM   @14,@12,@SA00004                                    0428 01323000
*   IF INSINDD=YES|INSOTDD=YES THEN /* IF AN IODSD IS PRESENT        */ 01324000
         L     @03,@PC00001+4                                      0429 01325000
         L     @03,IOSRLPTR(,@03)                                  0429 01326000
         L     @03,IOSTELM(,@03)                                   0429 01327000
         TM    INSINDD(@03),B'00110000'                            0429 01328000
         BZ    @RF00429                                            0429 01329000
*     DO;                           /* GET READY TO CLOSE DCBS       */ 01330000
*       FREE=YES;                   /* AND FREE STORAGE              */ 01331000
         OI    FREE,B'10000000'                                    0431 01332000
*       IF DSDQSAM=YES THEN         /* IF USING QSAM DCB THEN        */ 01333000
         L     @03,IODSDPTR-1(,@03)                                0432 01334000
         LA    @03,0(,@03)                                         0432 01335000
         TM    DSDQSAM(@03),B'00100000'                            0432 01336000
         BNO   @RF00432                                            0432 01337000
*         OPENADR=ADDR(INDCB);      /* SET UP FOR INPUT DCB          */ 01338000
         AL    @03,@CF00185                                        0433 01339000
         LR    OPENADR,@03                                         0433 01340000
*       ELSE                        /* IF USING BPAM DCB             */ 01341000
*         OPENADR=ADDR(BPAMDCB);    /* POINT TO BPAM DCB             */ 01342000
         B     @RC00432                                            0434 01343000
@RF00432 L     @15,@PC00001+4                                      0434 01344000
         L     @01,IOSRLPTR(,@15)                                  0434 01345000
         L     @01,IOSTELM(,@01)                                   0434 01346000
         L     @01,IODSDPTR-1(,@01)                                0434 01347000
         L     OPENADR,DSDBPAM(,@01)                               0434 01348000
         LA    OPENADR,BPAMDCB(,OPENADR)                           0434 01349000
*       IF DSDOPTS(3)=YES&NOBPAM=NO THEN/* FREE CORE AND CLOSE DCB   */ 01350000
@RC00432 L     @03,@PC00001+4                                      0435 01351000
         L     @03,IOSRLPTR(,@03)                                  0435 01352000
         L     @03,IOSTELM(,@03)                                   0435 01353000
         L     @03,IODSDPTR-1(,@03)                                0435 01354000
         LA    @03,0(,@03)                                         0435 01355000
         TM    DSDOPTS(@03),B'00100000'                            0435 01356000
         BNO   @RF00435                                            0435 01357000
         TM    NOBPAM,B'01000000'                                  0435 01358000
         BNZ   @RF00435                                            0435 01359000
*         DO;                       /* THEN TRY TO CLOSE             */ 01360000
*           IF NOBFRS=NO&DSDQSAM=NO THEN/* BPAM DCB IN USE           */ 01361000
         TM    NOBFRS,B'00100000'                                  0437 01362000
         BNZ   @RF00437                                            0437 01363000
         TM    DSDQSAM(@03),B'00100000'                            0437 01364000
         BNZ   @RF00437                                            0437 01365000
*             DO;                   /* FREEMAIN (E)                0438 01366000
*                                      LV(DECBMAX*DCBBLKSI)        0438 01367000
*                                      A(CURBLK(1)) SP(78)           */ 01368000
*               RESPECIFY                                          0439 01369000
*                (GPR01P) RESTRICTED;                              0439 01370000
*               I005=I005&&I005;    /* INIT LIST                     */ 01371000
         XC    I005(10),I005                                       0440 01372000
*               I00505='00'X;       /* SET TYPE                      */ 01373000
         MVI   I00505,X'00'                                        0441 01374000
*               I00502=DECBMAX*DCBBLKSI;/* LENGTH                    */ 01375000
         L     @03,DSDBPAM(,@03)                                   0442 01376000
         LH    @00,DECBMAX(,@03)                                   0442 01377000
         MH    @00,DCBBLKSI+52(,OPENADR)                           0442 01378000
         STCM  @00,7,I00502                                        0442 01379000
*               I00504=ADDR(CURBLK(1));/* ADDR OF ADDR LIST          */ 01380000
         LA    @03,CURBLK(,@03)                                    0443 01381000
         STCM  @03,7,I00504                                        0443 01382000
*               I00506=78;          /* SUBPOOL VALUE                 */ 01383000
         MVI   I00506,X'4E'                                        0444 01384000
*               GPR01P=ADDR(I005);  /* REG1 POINTS TO LIST           */ 01385000
         LA    GPR01P,I005                                         0445 01386000
*               SVC(5);             /* STANDARD-FORM OF GETMAIN      */ 01387000
         SVC   5                                                   0446 01388000
*               RESPECIFY                                          0447 01389000
*                (GPR01P) UNRESTRICTED;                            0447 01390000
*             END;                  /* FREEMAIN (E)                0448 01391000
*                                      LV(DECBMAX*DCBBLKSI)        0448 01392000
*                                      A(CURBLK(1)) SP(78)           */ 01393000
*           GEN REFS(OPENADR)(CLOSE ((OPENADR)),MF=(E,CLOSELST));  0449 01394000
@RF00437 DS    0H                                                  0449 01395000
         CLOSE ((OPENADR)),MF=(E,CLOSELST)                              01396000
*           IF DCBOFOPN=YES THEN    /* IF CLOSE FAILED, DO NOT       */ 01397000
         TM    DCBOFOPN+40(OPENADR),B'00010000'                    0450 01398000
         BNO   @RF00450                                            0450 01399000
*             FREE=NO;              /* FREE STORAGE - THIS WILL      */ 01400000
         NI    FREE,B'01111111'                                    0451 01401000
*           ELSE                    /* CLOSE OK,FREE BUF POOL@ZA09978*/ 01402000
*             IF(DCBBUFCB&1)^=1 THEN/* IF PRESENT            @ZA09978*/ 01403000
         B     @RC00450                                            0452 01404000
@RF00450 LA    @03,1                                               0452 01405000
         L     @15,DCBBUFCB+16(,OPENADR)                           0452 01406000
         NR    @15,@03                                             0452 01407000
         CR    @15,@03                                             0452 01408000
         BE    @RF00452                                            0452 01409000
*               GEN REFS(OPENADR)(FREEPOOL (OPENADR));/*     @ZA09978*/ 01410000
         FREEPOOL (OPENADR)                                             01411000
*         END;                      /* PREVENT A C03 ABEND AT TASK   */ 01412000
@RF00452 DS    0H                                                  0454 01413000
@RC00450 DS    0H                                                  0455 01414000
*       OPENADR=ADDR(OTDCB);        /* TERMINATION                   */ 01415000
@RF00435 L     @15,@PC00001+4                                      0455 01416000
         L     @01,IOSRLPTR(,@15)                                  0455 01417000
         L     @01,IOSTELM(,@01)                                   0455 01418000
         L     @15,IODSDPTR-1(,@01)                                0455 01419000
         LA    @15,0(,@15)                                         0455 01420000
         LR    OPENADR,@15                                         0455 01421000
         AL    OPENADR,INLEN                                       0455 01422000
         AL    OPENADR,@CF00185                                    0455 01423000
*       IF DSDOPTS(4)=YES&DCBOFOPN=YES THEN/* IF OUTPUT DCB PRESENT  */ 01424000
         TM    DSDOPTS(@15),B'00010000'                            0456 01425000
         BNO   @RF00456                                            0456 01426000
         TM    DCBOFOPN+40(OPENADR),B'00010000'                    0456 01427000
         BNO   @RF00456                                            0456 01428000
*         DO;                       /* TRY TO CLOSE IT               */ 01429000
*           GEN REFS(OPENADR)(CLOSE ((OPENADR)),MF=(E,CLOSELST));  0458 01430000
         CLOSE ((OPENADR)),MF=(E,CLOSELST)                              01431000
*           IF DCBOFOPN=YES THEN    /* IF CLOSE UNSUCCESSFUL         */ 01432000
         TM    DCBOFOPN+40(OPENADR),B'00010000'                    0459 01433000
         BNO   @RF00459                                            0459 01434000
*             FREE=NO;              /* DO NOT FREE STORAGE           */ 01435000
         NI    FREE,B'01111111'                                    0460 01436000
*           ELSE                    /* CLOSE OK,FREE BUF POOL@ZA09978*/ 01437000
*             IF(DCBBUFCB&1)^=1 THEN/* IF PRESENT            @ZA09978*/ 01438000
         B     @RC00459                                            0461 01439000
@RF00459 LA    @03,1                                               0461 01440000
         L     @15,DCBBUFCB+16(,OPENADR)                           0461 01441000
         NR    @15,@03                                             0461 01442000
         CR    @15,@03                                             0461 01443000
         BE    @RF00461                                            0461 01444000
*               GEN REFS(OPENADR)(FREEPOOL (OPENADR));/*     @ZA09978*/ 01445000
         FREEPOOL (OPENADR)                                             01446000
*         END;                                                     0463 01447000
@RF00461 DS    0H                                                  0463 01448000
@RC00459 DS    0H                                                  0464 01449000
*       IF FREE=YES THEN            /* IF OK TO FREE, SET UP         */ 01450000
@RF00456 TM    FREE,B'10000000'                                    0464 01451000
         BNO   @RF00464                                            0464 01452000
*         DO;                       /* FOR FREEMAIN                  */ 01453000
*           IF NOBPAM=NO&DSDQSAM=NO THEN/* BPAM DCB IN USE           */ 01454000
         TM    NOBPAM,B'01000000'                                  0466 01455000
         BNZ   @RF00466                                            0466 01456000
         L     @03,@PC00001+4                                      0466 01457000
         L     @03,IOSRLPTR(,@03)                                  0466 01458000
         L     @03,IOSTELM(,@03)                                   0466 01459000
         L     @03,IODSDPTR-1(,@03)                                0466 01460000
         LA    @03,0(,@03)                                         0466 01461000
         TM    DSDQSAM(@03),B'00100000'                            0466 01462000
         BNZ   @RF00466                                            0466 01463000
*             DO;                   /* FREEMAIN (E)                0467 01464000
*                                      LV(LENGTH(BPAMBLK)+POLEN)   0467 01465000
*                                      A(DSDBPAM) SP(SP78)           */ 01466000
*               RESPECIFY                                          0468 01467000
*                (GPR01P) RESTRICTED;                              0468 01468000
*               I005=I005&&I005;    /* INIT LIST                     */ 01469000
         XC    I005(10),I005                                       0469 01470000
*               I00505='00'X;       /* SET TYPE                      */ 01471000
         MVI   I00505,X'00'                                        0470 01472000
*               I00502=LENGTH(BPAMBLK)+POLEN;/* LENGTH               */ 01473000
         L     @15,POLEN                                           0471 01474000
         LA    @15,156(,@15)                                       0471 01475000
         STCM  @15,7,I00502                                        0471 01476000
*               I00504=ADDR(DSDBPAM);/* ADDR OF ADDR LIST            */ 01477000
         LA    @03,DSDBPAM(,@03)                                   0472 01478000
         STCM  @03,7,I00504                                        0472 01479000
*               I00506=SP78;        /* SUBPOOL VALUE                 */ 01480000
         MVI   I00506,X'4E'                                        0473 01481000
*               GPR01P=ADDR(I005);  /* REG1 POINTS TO LIST           */ 01482000
         LA    GPR01P,I005                                         0474 01483000
*               SVC(5);             /* STANDARD-FORM OF GETMAIN      */ 01484000
         SVC   5                                                   0475 01485000
*               RESPECIFY                                          0476 01486000
*                (GPR01P) UNRESTRICTED;                            0476 01487000
*             END;                  /* FREEMAIN (E)                0477 01488000
*                                      LV(LENGTH(BPAMBLK)+POLEN)   0477 01489000
*                                      A(DSDBPAM) SP(SP78)           */ 01490000
*           LEN=INLEN+OTLEN+LENGTH(DSDFLAGS);/* GET LENGTH           */ 01491000
@RF00466 L     @03,INLEN                                           0478 01492000
         AL    @03,OTLEN                                           0478 01493000
         LA    @03,16(,@03)                                        0478 01494000
         STCM  @03,7,LEN                                           0478 01495000
*           SPOOL=SP78;             /* SET FOR SHARED SUBPOOL        */ 01496000
         MVI   SPOOL,X'4E'                                         0479 01497000
*           RFY                                                    0480 01498000
*            (R0,                                                  0480 01499000
*             R1) RSTD;             /* RESTRICT REGS                 */ 01500000
*           R0=LNGTH;               /* LOAD REG ZERO FOR FREEMAIN    */ 01501000
         L     R0,LNGTH                                            0481 01502000
*           R1=IODSDPTR;            /* LOAD REG ONE WITH ADDR        */ 01503000
         L     @03,@PC00001+4                                      0482 01504000
         L     @03,IOSRLPTR(,@03)                                  0482 01505000
         L     @03,IOSTELM(,@03)                                   0482 01506000
         L     R1,IODSDPTR-1(,@03)                                 0482 01507000
         LA    R1,0(,R1)                                           0482 01508000
*           GEN REFS(R0,R1)(FREEMAIN R,LV=(0),A=(1));/* ISSUE      0483 01509000
*                                      FREEMAIN                      */ 01510000
         FREEMAIN R,LV=(0),A=(1)                                        01511000
*           RFY                                                    0484 01512000
*            (R0,                                                  0484 01513000
*             R1) UNRSTD;           /* RELEASE REGS                  */ 01514000
*         END;                      /* END OF CLOSE PROCESSING       */ 01515000
*     END;                          /*                               */ 01516000
*   END CLOSERTN;                                                  0487 01517000
@EL00004 DS    0H                                                  0487 01518000
@EF00004 DS    0H                                                  0487 01519000
@ER00004 LM    @14,@12,@SA00004                                    0487 01520000
         BR    @14                                                 0487 01521000
*                                                                  0488 01522000
*   /*****************************************************************/ 01523000
*   /*                                                               */ 01524000
*   /* THE OPEN EXIT CANNOT SAVE REGISTERS IN REG 13 SAVEAREA SO THIS*/ 01525000
*   /* ROUTINE USES ITS OWN SAVEAREA CALLED MYSAVAREA. THE PURPOSE OF*/ 01526000
*   /* THIS EXIT IS TO DEFAULT OR CORRECT DCB PARAMETERS ON THE      */ 01527000
*   /* OUTPUT DCB                                                    */ 01528000
*   /*                                                               */ 01529000
*   /*****************************************************************/ 01530000
*                                                                  0488 01531000
*OPENEXIT:                                                         0488 01532000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0488 01533000
OPENEXIT DS    0H                                                  0489 01534000
*   GEN SETS(MYSAVREA)(STM  @14,@12,MYSAVREA+12);/* SAVE REGISTERS   */ 01535000
         STM  @14,@12,MYSAVREA+12                                       01536000
*   IF DCBRECL=NOTDEF THEN          /* IF DCBRECL IS NOT DEFINED     */ 01537000
         LA    @03,28                                              0490 01538000
         ALR   @03,OPENADR                                         0490 01539000
         TM    DCBRECL(@03),B'11000000'                            0490 01540000
         BNZ   @RF00490                                            0490 01541000
*     DO;                           /* DEFAULT TO RECFM=VA           */ 01542000
*       DCBRECL=V;                  /*                               */ 01543000
         NI    DCBRECL(@03),B'01111111'                            0492 01544000
         OI    DCBRECL(@03),B'01000000'                            0492 01545000
*       DCBRECCC=A;                 /*                               */ 01546000
         NI    DCBRECCC(@03),B'11111101'                           0493 01547000
         OI    DCBRECCC(@03),B'00000100'                           0493 01548000
*     END;                                                         0494 01549000
*   IF DCBRECL=V|DCBRECL=U THEN     /* FOR RECFM=V OR U              */ 01550000
@RF00490 TM    DCBRECL+28(OPENADR),B'01000000'                     0495 01551000
         BNO   @GL00012                                            0495 01552000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0495 01553000
         BZ    @RT00495                                            0495 01554000
@GL00012 TM    DCBRECL+28(OPENADR),B'11000000'                     0495 01555000
         BNO   @RF00495                                            0495 01556000
@RT00495 DS    0H                                                  0496 01557000
*     DO;                           /* CHECK BLKSIZE                 */ 01558000
*       IF DCBBLKSI=0 THEN          /* IF BLKSIZE = 0 AND LRECL = 0  */ 01559000
         SLR   @03,@03                                             0497 01560000
         LA    @15,52                                              0497 01561000
         ALR   @15,OPENADR                                         0497 01562000
         CH    @03,DCBBLKSI(,@15)                                  0497 01563000
         BNE   @RF00497                                            0497 01564000
*         IF DCBLRECL=0 THEN        /* DEFAULT TO RECFM = VBA        */ 01565000
         LA    @14,72                                              0498 01566000
         ALR   @14,OPENADR                                         0498 01567000
         CH    @03,DCBLRECL(,@14)                                  0498 01568000
         BNE   @RF00498                                            0498 01569000
*           DO;                     /*                               */ 01570000
*             DCBRECL=V;            /*                               */ 01571000
         LA    @03,28                                              0500 01572000
         ALR   @03,OPENADR                                         0500 01573000
         NI    DCBRECL(@03),B'01111111'                            0500 01574000
         OI    DCBRECL(@03),B'01000000'                            0500 01575000
*             DCBRECBR=B;           /*                               */ 01576000
         OI    DCBRECBR(@03),B'00010000'                           0501 01577000
*             DCBRECCC=A;           /*                               */ 01578000
         NI    DCBRECCC(@03),B'11111101'                           0502 01579000
         OI    DCBRECCC(@03),B'00000100'                           0502 01580000
*             DCBBLKSI=DEFBLKSI;    /* SET BLKSI TO 3556             */ 01581000
         MVC   DCBBLKSI(2,@15),@CH00283                            0503 01582000
*             DCBLRECL=DEFLRECL;    /* SET LRECL TO 148              */ 01583000
         MVC   DCBLRECL(2,@14),@CH00285                            0504 01584000
*           END;                    /*                               */ 01585000
*         ELSE                                                     0506 01586000
*           DCBBLKSI=DCBLRECL+4;    /* SET BLKSI TO LREC + 4         */ 01587000
         B     @RC00498                                            0506 01588000
@RF00498 LA    @03,4                                               0506 01589000
         AH    @03,DCBLRECL+72(,OPENADR)                           0506 01590000
         STH   @03,DCBBLKSI+52(,OPENADR)                           0506 01591000
*       ELSE                        /* IF BLKSI NOT = 0 AND          */ 01592000
*         IF DCBLRECL=0 THEN        /* AND LRECL IS 0 SET LRECL      */ 01593000
         B     @RC00497                                            0507 01594000
@RF00497 LA    @03,72                                              0507 01595000
         ALR   @03,OPENADR                                         0507 01596000
         LH    @15,DCBLRECL(,@03)                                  0507 01597000
         LTR   @15,@15                                             0507 01598000
         BNZ   @RF00507                                            0507 01599000
*           DCBLRECL=DCBBLKSI-4;    /* TO BLKSI-4                    */ 01600000
         LH    @15,DCBBLKSI+52(,OPENADR)                           0508 01601000
         SL    @15,@CF00068                                        0508 01602000
         STH   @15,DCBLRECL(,@03)                                  0508 01603000
*         ELSE                      /* OTHERWISE COMPUTE CORRECTIONS */ 01604000
*           DO;                     /* IF MORE THAN ONE LRECL CAN FIT*/ 01605000
         B     @RC00507                                            0509 01606000
@RF00507 DS    0H                                                  0510 01607000
*             IF DCBBLKSI/DCBLRECL>1 THEN/* SET RECFM TO XBX         */ 01608000
         LH    @00,DCBBLKSI+52(,OPENADR)                           0510 01609000
         SRDA  @00,32                                              0510 01610000
         LH    @03,DCBLRECL+72(,OPENADR)                           0510 01611000
         DR    @00,@03                                             0510 01612000
         C     @01,@CF00040                                        0510 01613000
         BNH   @RF00510                                            0510 01614000
*               DCBRECBR=B;         /* COMPUTE PROPER BLKSIZE        */ 01615000
         OI    DCBRECBR+28(OPENADR),B'00010000'                    0511 01616000
*             DCBBLKSI=(MAX((DCBBLKSI/DCBLRECL),1)*DCBLRECL)+4;    0512 01617000
@RF00510 LA    @03,52                                              0512 01618000
         ALR   @03,OPENADR                                         0512 01619000
         LH    @15,DCBLRECL+72(,OPENADR)                           0512 01620000
         LH    @00,DCBBLKSI(,@03)                                  0512 01621000
         SRDA  @00,32                                              0512 01622000
         DR    @00,@15                                             0512 01623000
         LA    @00,1                                               0512 01624000
         CR    @01,@00                                             0512 01625000
         BNL   *+6                                                      01626000
         LR    @01,@00                                             0512 01627000
         MR    @00,@15                                             0512 01628000
         AL    @01,@CF00068                                        0512 01629000
         STH   @01,DCBBLKSI(,@03)                                  0512 01630000
*           END;                                                   0513 01631000
*       IF DCBRECL=U THEN           /* FOR FORMAT U                  */ 01632000
@RC00507 DS    0H                                                  0514 01633000
@RC00497 TM    DCBRECL+28(OPENADR),B'11000000'                     0514 01634000
         BNO   @RF00514                                            0514 01635000
*         DCBLRECL=0;               /* ZERO LRECL                    */ 01636000
         SLR   @03,@03                                             0515 01637000
         STH   @03,DCBLRECL+72(,OPENADR)                           0515 01638000
*     END;                          /* END RECFM V OR U              */ 01639000
@RF00514 DS    0H                                                  0517 01640000
*   IF DCBRECL=F&DCBRECBR^=B THEN   /* FOR UNBLOCKED RECFM=F         */ 01641000
@RF00495 LA    @03,28                                              0517 01642000
         ALR   @03,OPENADR                                         0517 01643000
         TM    DCBRECL(@03),B'10000000'                            0517 01644000
         BNO   @RF00517                                            0517 01645000
         TM    DCBRECL(@03),B'01000000'                            0517 01646000
         BNZ   @RF00517                                            0517 01647000
         TM    DCBRECBR(@03),B'00010000'                           0517 01648000
         BO    @RF00517                                            0517 01649000
*     DO;                           /* IF DCBLRECL AND DCBBLK = 0    */ 01650000
*       IF DCBBLKSI=0 THEN          /* FORCE DEFAULT OF RECFM= VBA   */ 01651000
         SLR   @15,@15                                             0519 01652000
         LA    @14,52                                              0519 01653000
         ALR   @14,OPENADR                                         0519 01654000
         CH    @15,DCBBLKSI(,@14)                                  0519 01655000
         BNE   @RF00519                                            0519 01656000
*         IF DCBLRECL=0 THEN        /*                               */ 01657000
         LA    @09,72                                              0520 01658000
         ALR   @09,OPENADR                                         0520 01659000
         CH    @15,DCBLRECL(,@09)                                  0520 01660000
         BNE   @RF00520                                            0520 01661000
*           DO;                     /*                               */ 01662000
*             DCBRECL=V;            /*                               */ 01663000
         NI    DCBRECL(@03),B'01111111'                            0522 01664000
         OI    DCBRECL(@03),B'01000000'                            0522 01665000
*             DCBRECBR=B;           /*                               */ 01666000
         OI    DCBRECBR(@03),B'00010000'                           0523 01667000
*             DCBRECCC=A;           /*                               */ 01668000
         NI    DCBRECCC(@03),B'11111101'                           0524 01669000
         OI    DCBRECCC(@03),B'00000100'                           0524 01670000
*             DCBBLKSI=DEFBLKSI;    /* SET BLKSIZE TO 3556           */ 01671000
         MVC   DCBBLKSI(2,@14),@CH00283                            0525 01672000
*             DCBLRECL=DEFLRECL;    /* SET LRECL TO 148              */ 01673000
         MVC   DCBLRECL(2,@09),@CH00285                            0526 01674000
*           END;                    /*                               */ 01675000
*         ELSE                      /* OTHER WISE MAKE BLK = LRECL   */ 01676000
*           DCBBLKSI=DCBLRECL;                                     0528 01677000
         B     @RC00520                                            0528 01678000
@RF00520 LH    @03,DCBLRECL+72(,OPENADR)                           0528 01679000
         STH   @03,DCBBLKSI+52(,OPENADR)                           0528 01680000
*       ELSE                        /* OR LRECL = BLK                */ 01681000
*         DCBLRECL=DCBBLKSI;                                       0529 01682000
         B     @RC00519                                            0529 01683000
@RF00519 LH    @03,DCBBLKSI+52(,OPENADR)                           0529 01684000
         STH   @03,DCBLRECL+72(,OPENADR)                           0529 01685000
*     END;                          /* IF BLOCKED FIXED              */ 01686000
@RC00519 DS    0H                                                  0531 01687000
*   IF DCBRECL=F&DCBRECBR=B THEN    /* AND DCBLRECL AND DCBBLKSI = 0 */ 01688000
@RF00517 LA    @03,28                                              0531 01689000
         ALR   @03,OPENADR                                         0531 01690000
         TM    DCBRECL(@03),B'10000000'                            0531 01691000
         BNO   @RF00531                                            0531 01692000
         TM    DCBRECL(@03),B'01000000'                            0531 01693000
         BNZ   @RF00531                                            0531 01694000
         TM    DCBRECBR(@03),B'00010000'                           0531 01695000
         BNO   @RF00531                                            0531 01696000
*     DO;                           /* SET DEFAULTS OF RECFM= VBA    */ 01697000
*       IF DCBBLKSI=0 THEN          /*                               */ 01698000
         SLR   @15,@15                                             0533 01699000
         LA    @14,52                                              0533 01700000
         ALR   @14,OPENADR                                         0533 01701000
         CH    @15,DCBBLKSI(,@14)                                  0533 01702000
         BNE   @RF00533                                            0533 01703000
*         IF DCBLRECL=0 THEN        /*                               */ 01704000
         LA    @09,72                                              0534 01705000
         ALR   @09,OPENADR                                         0534 01706000
         CH    @15,DCBLRECL(,@09)                                  0534 01707000
         BNE   @RF00534                                            0534 01708000
*           DO;                     /*                               */ 01709000
*             DCBRECL=V;            /*                               */ 01710000
         NI    DCBRECL(@03),B'01111111'                            0536 01711000
         OI    DCBRECL(@03),B'01000000'                            0536 01712000
*             DCBRECBR=B;           /*                               */ 01713000
         OI    DCBRECBR(@03),B'00010000'                           0537 01714000
*             DCBRECCC=A;           /*                               */ 01715000
         NI    DCBRECCC(@03),B'11111101'                           0538 01716000
         OI    DCBRECCC(@03),B'00000100'                           0538 01717000
*             DCBBLKSI=DEFBLKSI;    /* SET DEFAULT BLKSI OF 3556     */ 01718000
         MVC   DCBBLKSI(2,@14),@CH00283                            0539 01719000
*             DCBLRECL=DEFLRECL;    /* SET LRECL TO 148              */ 01720000
         MVC   DCBLRECL(2,@09),@CH00285                            0540 01721000
*           END;                    /*                               */ 01722000
*         ELSE                      /*                               */ 01723000
*           DCBBLKSI=DCBLRECL;      /* IF BLK = 0, COPY LRECL        */ 01724000
         B     @RC00534                                            0542 01725000
@RF00534 LH    @03,DCBLRECL+72(,OPENADR)                           0542 01726000
         STH   @03,DCBBLKSI+52(,OPENADR)                           0542 01727000
*       ELSE                                                       0543 01728000
*         IF DCBLRECL=0 THEN        /* IF LRECL= 0, COPY BLK         */ 01729000
         B     @RC00533                                            0543 01730000
@RF00533 LA    @03,72                                              0543 01731000
         ALR   @03,OPENADR                                         0543 01732000
         LH    @15,DCBLRECL(,@03)                                  0543 01733000
         LTR   @15,@15                                             0543 01734000
         BNZ   @RF00543                                            0543 01735000
*           DCBLRECL=DCBBLKSI;      /* IF NEITHER IS ZERO,           */ 01736000
         LH    @15,DCBBLKSI+52(,OPENADR)                           0544 01737000
         STH   @15,DCBLRECL(,@03)                                  0544 01738000
*         ELSE                      /* COMPUTE BLKSIZE               */ 01739000
*           DCBBLKSI=MAX((DCBBLKSI/DCBLRECL),1)*DCBLRECL;          0545 01740000
         B     @RC00543                                            0545 01741000
@RF00543 LA    @03,52                                              0545 01742000
         ALR   @03,OPENADR                                         0545 01743000
         LH    @15,DCBLRECL+72(,OPENADR)                           0545 01744000
         LH    @00,DCBBLKSI(,@03)                                  0545 01745000
         SRDA  @00,32                                              0545 01746000
         DR    @00,@15                                             0545 01747000
         LA    @00,1                                               0545 01748000
         CR    @01,@00                                             0545 01749000
         BNL   *+6                                                      01750000
         LR    @01,@00                                             0545 01751000
         MR    @00,@15                                             0545 01752000
         STH   @01,DCBBLKSI(,@03)                                  0545 01753000
*     END;                                                         0546 01754000
@RC00543 DS    0H                                                  0546 01755000
@RC00533 DS    0H                                                  0547 01756000
*   GEN REFS(MYSAVREA)(LM    @14,@12,MYSAVREA+12);/* RESTORE       0547 01757000
*                                      REGISTERS                     */ 01758000
@RF00531 DS    0H                                                  0547 01759000
         LM    @14,@12,MYSAVREA+12                                      01760000
*   END OPENEXIT;                   /* END OF OPEN EXIT- RETURN TO 0548 01761000
*                                      DATA MANAGEMENT               */ 01762000
@EL00005 DS    0H                                                  0548 01763000
@EF00005 DS    0H                                                  0548 01764000
@ER00005 BR    @14                                                 0548 01765000
*BPAMEXIT:                                                         0549 01766000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0549 01767000
BPAMEXIT DS    0H                                                  0550 01768000
*   GEN SETS(MYSAVREA)(STM @14,@12,MYSAVREA+12);                   0550 01769000
         STM @14,@12,MYSAVREA+12                                        01770000
*   RFY                                                            0551 01771000
*     INSTACK BASED(IOSTELM+ASTAKELM);                             0551 01772000
*   IF DCBBLKSI^=0 THEN             /* AS LONG AS BLKSI NOT ZERO     */ 01773000
         LH    @03,DCBBLKSI+52(,OPENADR)                           0552 01774000
         LTR   @03,@03                                             0552 01775000
         BZ    @RF00552                                            0552 01776000
*     DO;                           /* PROCESS                       */ 01777000
*       DECBMAX=MIN(6,MAX(1,26000/DCBBLKSI));/* GET NUMBER OF BUFFERS*/ 01778000
         L     @15,@PC00001+4                                      0554 01779000
         L     @01,IOSRLPTR(,@15)                                  0554 01780000
         L     @01,IOSTELM(,@01)                                   0554 01781000
         L     @01,IODSDPTR+3(,@01)                                0554 01782000
         L     @15,DSDBPAM(,@01)                                   0554 01783000
         L     @00,@CF00752                                        0554 01784000
         SRDA  @00,32                                              0554 01785000
         DR    @00,@03                                             0554 01786000
         LA    @14,1                                               0554 01787000
         CR    @01,@14                                             0554 01788000
         BNL   *+6                                                      01789000
         LR    @01,@14                                             0554 01790000
         LA    @14,6                                               0554 01791000
         CR    @01,@14                                             0554 01792000
         BNH   *+6                                                      01793000
         LR    @01,@14                                             0554 01794000
         STH   @01,DECBMAX(,@15)                                   0554 01795000
*       RFY                                                        0555 01796000
*         R15 RSTD;                 /* RESTRICT REG                  */ 01797000
*       DO;                         /* GETMAIN (EC)                0556 01798000
*                                      LV(DECBMAX*DCBBLKSI)        0556 01799000
*                                      A(CURBLK(1)) SP(78)         0556 01800000
*                                      MF(E,GETLST) RTCD(R15)        */ 01801000
         ST    @15,@TF00001                                        0556 01802000
*         RESPECIFY                                                0557 01803000
*          (GPR01P,                                                0557 01804000
*           GPR15F) RESTRICTED;                                    0557 01805000
*         GETLST04='20'X;           /* TYPE                          */ 01806000
         ST    @01,@TF00002                                        0558 01807000
         MVI   GETLST04,X'20'                                      0558 01808000
*         GETLST01=DECBMAX*DCBBLKSI;/* LENGTH                        */ 01809000
         LR    @05,@03                                             0559 01810000
         M     @04,@TF00002                                        0559 01811000
         ST    @05,GETLST01                                        0559 01812000
*         GETLST03=ADDR(CURBLK(1)); /* ADDR OF ADDR LIST             */ 01813000
         L     @14,@TF00001                                        0560 01814000
         LA    @14,CURBLK(,@14)                                    0560 01815000
         STCM  @14,7,GETLST03                                      0560 01816000
*         GETLST05=78;              /* SUBPOOL VALUE                 */ 01817000
         MVI   GETLST05,X'4E'                                      0561 01818000
*         GPR01P=ADDR(GETLST);      /* REG1 POINTS TO LIST           */ 01819000
         LA    GPR01P,GETLST                                       0562 01820000
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */ 01821000
         SVC   4                                                   0563 01822000
*         R15=GPR15F;               /* SET RETURN CODE               */ 01823000
*         RESPECIFY                                                0565 01824000
*          (GPR01P,                                                0565 01825000
*           GPR15F) UNRESTRICTED;                                  0565 01826000
*       END;                        /* GETMAIN (EC)                0566 01827000
*                                      LV(DECBMAX*DCBBLKSI)        0566 01828000
*                                      A(CURBLK(1)) SP(78)         0566 01829000
*                                      MF(E,GETLST) RTCD(R15)        */ 01830000
*       IF R15^=0 THEN              /* BAD GETMAIN                   */ 01831000
         LTR   R15,R15                                             0567 01832000
         BZ    @RF00567                                            0567 01833000
*         NOBFRS=YES;                                              0568 01834000
         OI    NOBFRS,B'00100000'                                  0568 01835000
*       RFY                                                        0569 01836000
*         R15 UNRSTD;               /* RELEASE REG                   */ 01837000
@RF00567 DS    0H                                                  0570 01838000
*     END;                                                         0570 01839000
*   RFY                                                            0571 01840000
*     INSTACK BASED(IOSTELM);       /* RESET BASE                    */ 01841000
@RF00552 DS    0H                                                  0572 01842000
*   GEN REFS(MYSAVREA)(LM @14,@12,MYSAVREA+12);                    0572 01843000
         LM @14,@12,MYSAVREA+12                                         01844000
*   END BPAMEXIT;                                                  0573 01845000
@EL00006 DS    0H                                                  0573 01846000
@EF00006 DS    0H                                                  0573 01847000
@ER00006 BR    @14                                                 0573 01848000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 01849000
*     GPR15F FIXED(31) REG(15),                                    0574 01850000
*     GPR01P PTR(31) REG(1);                                       0574 01851000
*   DCL                                                            0575 01852000
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */ 01853000
*       3 I00501 PTR(8),            /* RESERVED                      */ 01854000
*       3 I00502 PTR(24),           /* LENGTH                        */ 01855000
*       3 I00503 PTR(8),            /* RESERVED                      */ 01856000
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */ 01857000
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */ 01858000
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */ 01859000
*   DECLARE                                                        0576 01860000
*     ILIST CHAR(10) BDY(DWORD);    /* STANDARD LIST                 */ 01861000
*   DECLARE                         /* COMMON VARIABLES              */ 01862000
*     I256C CHAR(256) BASED,                                       0577 01863000
*     I031F FIXED(31) BASED,                                       0577 01864000
*     I031P PTR(31) BASED,                                         0577 01865000
*     I015F FIXED(15) BASED,                                       0577 01866000
*     I015P PTR(15) BASED,                                         0577 01867000
*     I008P PTR(8) BASED,                                          0577 01868000
*     I001C CHAR(1) BASED;                                         0577 01869000
*   END IKJEFT30                                                   0578 01870000
*                                                                  0578 01871000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01872000
*/*%INCLUDE SYSLIB  (IKJEXEC )                                       */ 01873000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 01874000
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */ 01875000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 01876000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 01877000
*                                                                  0578 01878000
*       ;                                                          0578 01879000
@DATA    DS    0H                                                       01880000
@CH00238 DC    H'20'                                                    01881000
@CH00285 DC    H'137'                                                   01882000
@CH00283 DC    H'3155'                                                  01883000
@SM00776 MVC   OPENL(0),OPENLOC                                         01884000
@SM00780 MVC   STAXD(0),STAXC                                           01885000
@SM00786 MVC   INDCB(0,@14),INLST                                       01886000
@SM00788 MVC   BPAMDCB(0,@08),PODCB                                     01887000
@SM00790 MVC   CURDECB-20(0,@08),RDM                                    01888000
@SM00792 MVC   OTDCB(0,@14),OTLST                                       01889000
@DATD    DSECT                                                          01890000
         DS    0F                                                       01891000
@SA00001 DS    18F                                                      01892000
@PC00001 DS    4F                                                       01893000
@SA00004 DS    15F                                                      01894000
@SA00003 DS    15F                                                      01895000
@SA00002 DS    15F                                                      01896000
@TF00001 DS    F                                                        01897000
@TF00002 DS    F                                                        01898000
IKJEFT30 CSECT                                                          01899000
         DS    0F                                                       01900000
@CF00040 DC    F'1'                                                     01901000
@CH00040 EQU   @CF00040+2                                               01902000
@CF00068 DC    F'4'                                                     01903000
@CF00185 DC    F'16'                                                    01904000
@CF00070 DC    F'32'                                                    01905000
@CH00070 EQU   @CF00070+2                                               01906000
@CF00551 DC    F'48'                                                    01907000
@CF00767 DC    F'64'                                                    01908000
@CF00752 DC    F'26000'                                                 01909000
@CF00766 DC    F'-4'                                                    01910000
@DATD    DSECT                                                          01911000
         DS    0D                                                       01912000
SNTABPTR DS    A                                                        01913000
SNTELPTR DS    A                                                        01914000
SVTABPTR DS    A                                                        01915000
ECTPTR   DS    A                                                        01916000
LNGTH    DS    AL4                                                      01917000
         ORG   LNGTH                                                    01918000
SPOOL    DS    AL1                                                      01919000
LEN      DS    AL3                                                      01920000
         ORG   LNGTH+4                                                  01921000
FREEADDR DS    A                                                        01922000
DCBPTR   DS    A                                                        01923000
SWS      DS    CL1                                                      01924000
         ORG   SWS                                                      01925000
FREE     DS    BL1                                                      01926000
NOBPAM   EQU   SWS+0                                                    01927000
NOBFRS   EQU   SWS+0                                                    01928000
         ORG   SWS+1                                                    01929000
         DS    CL3                                                      01930000
@NM00018 DS    CL4                                                      01931000
         ORG   @NM00018                                                 01932000
EXITPARM DS    BL1                                                      01933000
EXITADDR DS    AL3                                                      01934000
         ORG   @NM00018+4                                               01935000
FRELST   DS    CL10                                                     01936000
         ORG   FRELST                                                   01937000
FRELST01 DS    AL1                                                      01938000
FRELST02 DS    AL3                                                      01939000
FRELST03 DS    AL1                                                      01940000
FRELST04 DS    AL3                                                      01941000
FRELST05 DS    BL1                                                      01942000
FRELST06 DS    AL1                                                      01943000
         ORG   FRELST+10                                                01944000
         DS    CL2                                                      01945000
GETLST   DS    CL10                                                     01946000
         ORG   GETLST                                                   01947000
GETLST01 DS    AL4                                                      01948000
GETLST02 DS    CL1                                                      01949000
GETLST03 DS    AL3                                                      01950000
GETLST04 DS    CL1                                                      01951000
GETLST05 DS    AL1                                                      01952000
         ORG   GETLST+10                                                01953000
         DS    CL6                                                      01954000
ILIST    DS    CL10                                                     01955000
         DS    CL2                                                      01956000
MYSAVREA DS    18F                                                      01957000
IKJEFT30 CSECT                                                          01958000
         DS    0F                                                       01959000
@SIZDATD DC    AL1(1)                                                   01960000
         DC    AL3(@ENDDATD-@DATD)                                      01961000
         DS    0D                                                       01962000
PATCH    DC    8A(0)                                                    01963000
IKJEFT30 CSECT                                                          01964000
INLST DCB DDNAME=SYSIN,DSORG=PS,MACRF=GL                                01965000
              ENTRY INLEN                                               01966000
INLEN DC  A(INLEN-INLST)                                                01967000
OTLST DCB DDNAME=SYSIN,DSORG=PS,MACRF=PM                                01968000
OTLEN DC  A(OTLEN-OTLST)                                                01969000
PODCB DCB DDNAME=A,MACRF=R,DSORG=PO,NCP=6                               01970000
POLEN DC A(POLEN-PODCB)                                                 01971000
RDM   READ DUMMY,SF,MF=L                                                01972000
READLEN DC A(READLEN-RDM)                                               01973000
IKJEFT30 CSECT                                                          01974000
*                                                         /*@ZA08099*/  01975000
STAXC    STAX MF=L                                          @ZA08099    01976000
LENSTAX   DC  A(*-STAXC)      LENGTH OF MACRO               @ZA08099    01977000
@DATD    DSECT                                                          01978000
*                                                         /*@ZA08099*/  01979000
STAXD    STAX MF=L                                          @ZA08099    01980000
@DATD    DSECT                                                          01981000
OPENL OPEN (,),MF=L                                                     01982000
CLOSELST CLOSE (,),MF=L                                                 01983000
IKJEFT30 CSECT                                                          01984000
OPENLOC OPEN (,),MF=L                                                   01985000
        CLOSE (,),MF=L                                                  01986000
OPENLEN DC A(OPENLEN-OPENLOC)                                           01987000
@DATD    DSECT                                                          01988000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01989000
@ENDDATD EQU   *                                                        01990000
IKJEFT30 CSECT                                                          01991000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01992000
@01      EQU   01                                                       01993000
@02      EQU   02                                                       01994000
@03      EQU   03                                                       01995000
@04      EQU   04                                                       01996000
@05      EQU   05                                                       01997000
@06      EQU   06                                                       01998000
@07      EQU   07                                                       01999000
@08      EQU   08                                                       02000000
@09      EQU   09                                                       02001000
@10      EQU   10                                                       02002000
@11      EQU   11                                                       02003000
@12      EQU   12                                                       02004000
@13      EQU   13                                                       02005000
@14      EQU   14                                                       02006000
@15      EQU   15                                                       02007000
I        EQU   @03                                                      02008000
FREELEN  EQU   @03                                                      02009000
RETURNCD EQU   @09                                                      02010000
RETCODE  EQU   @03                                                      02011000
ECDACBLK EQU   @04                                                      02012000
TEMP31   EQU   @08                                                      02013000
ISTCKPTR EQU   @09                                                      02014000
R0       EQU   @00                                                      02015000
R1       EQU   @01                                                      02016000
R15      EQU   @15                                                      02017000
OPENADR  EQU   @02                                                      02018000
R2       EQU   @02                                                      02019000
R3       EQU   @03                                                      02020000
R4       EQU   @04                                                      02021000
R5       EQU   @05                                                      02022000
GPR01P   EQU   @01                                                      02023000
GPR15F   EQU   @15                                                      02024000
EXECDATA EQU   0                                                        02025000
SNTABFST EQU   EXECDATA                                                 02026000
SVTABFST EQU   EXECDATA+4                                               02027000
@NM00001 EQU   EXECDATA+16                                              02028000
EXINSAVE EQU   @NM00001                                                 02029000
EXDATFLG EQU   EXECDATA+32                                              02030000
@NM00002 EQU   EXDATFLG                                                 02031000
NOFLUSH  EQU   @NM00002                                                 02032000
CMAIN    EQU   @NM00002                                                 02033000
ATTNCMD  EQU   @NM00002                                                 02034000
EXDLMPTR EQU   EXECDATA+40                                              02035000
FILEDCBS EQU   EXECDATA+56                                              02036000
COMPROC  EQU   0                                                        02037000
COMPRPTR EQU   COMPROC                                                  02038000
COMPRNXT EQU   COMPRPTR+1                                               02039000
COMPRLNG EQU   COMPROC+4                                                02040000
SNTAB    EQU   0                                                        02041000
SNTABNXT EQU   SNTAB                                                    02042000
SNTABLNG EQU   SNTAB+4                                                  02043000
SNTELEM  EQU   0                                                        02044000
SNTVLPTR EQU   SNTELEM                                                  02045000
SNTFLAGS EQU   SNTELEM+4                                                02046000
SVTAB    EQU   0                                                        02047000
SVTABLNG EQU   SVTAB+4                                                  02048000
SVTELEM  EQU   0                                                        02049000
ECT      EQU   0                                                        02050000
ECTIOWA  EQU   ECT+4                                                    02051000
ECTSWS   EQU   ECT+28                                                   02052000
ECTSWS2  EQU   ECT+40                                                   02053000
ECTSWS21 EQU   ECTSWS2                                                  02054000
LSDPTR   EQU   0                                                        02055000
LSD      EQU   0                                                        02056000
LSDADATA EQU   LSD                                                      02057000
LSDRCLEN EQU   LSD+4                                                    02058000
LSDTOTLN EQU   LSD+6                                                    02059000
LSDANEXT EQU   LSD+8                                                    02060000
LSDEXEC  EQU   LSD+12                                                   02061000
IOSRL    EQU   0                                                        02062000
IOSTELM  EQU   IOSRL                                                    02063000
IOSBELM  EQU   IOSRL+4                                                  02064000
IOSTLEN  EQU   IOSRL+8                                                  02065000
IOSNELM  EQU   IOSRL+10                                                 02066000
INSTACK  EQU   0                                                        02067000
INSCODE  EQU   INSTACK                                                  02068000
INSDATA  EQU   INSCODE                                                  02069000
INSSTOR  EQU   INSCODE                                                  02070000
INSINDD  EQU   INSCODE                                                  02071000
INSOTDD  EQU   INSCODE                                                  02072000
INSEXEC  EQU   INSCODE                                                  02073000
INSPROM  EQU   INSCODE                                                  02074000
INSPROC  EQU   INSCODE                                                  02075000
INSADLSD EQU   INSTACK+1                                                02076000
DUMYSTAK EQU   0                                                        02077000
RECLEN   EQU   0                                                        02078000
STCK     EQU   0                                                        02079000
INDCB    EQU   0                                                        02080000
DSDFLAGS EQU   0                                                        02081000
DSDSEQ   EQU   DSDFLAGS                                                 02082000
DSDCNTL  EQU   DSDFLAGS                                                 02083000
DSDQSAM  EQU   DSDFLAGS                                                 02084000
DSDFRST  EQU   DSDFLAGS                                                 02085000
DSDOPTS  EQU   DSDFLAGS+1                                               02086000
DSDLINES EQU   DSDFLAGS+3                                               02087000
DSDMINBF EQU   DSDFLAGS+4                                               02088000
DSDBPAM  EQU   DSDFLAGS+12                                              02089000
OTDCB    EQU   0                                                        02090000
INDDNAME EQU   0                                                        02091000
OTDDNAME EQU   0                                                        02092000
LL       EQU   0                                                        02093000
FILEBLOK EQU   0                                                        02094000
NEXTFILE EQU   FILEBLOK                                                 02095000
DCBAREA  EQU   FILEBLOK+20                                              02096000
BPAMBLK  EQU   0                                                        02097000
@NM00022 EQU   BPAMBLK+8                                                02098000
DECBINDX EQU   @NM00022                                                 02099000
DECBMAX  EQU   @NM00022+2                                               02100000
CURBLK   EQU   BPAMBLK+12                                               02101000
CURDECB  EQU   BPAMBLK+36                                               02102000
IOBPTR   EQU   CURDECB+16                                               02103000
BPAMDCB  EQU   BPAMBLK+156                                              02104000
@NM00025 EQU   0                                                        02105000
IHADCB   EQU   0                                                        02106000
IHADCS00 EQU   0                                                        02107000
DCBFDAD  EQU   IHADCS00+5                                               02108000
IHADCS01 EQU   0                                                        02109000
DCBDVTBL EQU   IHADCS01                                                 02110000
IHADCS11 EQU   0                                                        02111000
DCBRELB  EQU   IHADCS11                                                 02112000
DCBREL   EQU   DCBRELB+1                                                02113000
DCBBUFCB EQU   IHADCS11+4                                               02114000
DCBDSORG EQU   IHADCS11+10                                              02115000
DCBDSRG1 EQU   DCBDSORG                                                 02116000
DCBDSRG2 EQU   DCBDSORG+1                                               02117000
DCBIOBAD EQU   IHADCS11+12                                              02118000
DCBODEB  EQU   DCBIOBAD                                                 02119000
DCBLNP   EQU   DCBODEB                                                  02120000
DCBQSLM  EQU   DCBLNP                                                   02121000
DCBIOBAA EQU   DCBODEB+1                                                02122000
IHADCS50 EQU   0                                                        02123000
DCBSVCXL EQU   IHADCS50                                                 02124000
DCBEODAD EQU   IHADCS50+4                                               02125000
DCBBFALN EQU   DCBEODAD                                                 02126000
DCBHIARC EQU   DCBBFALN                                                 02127000
DCBBFTEK EQU   DCBHIARC                                                 02128000
DCBBFT   EQU   DCBBFTEK                                                 02129000
DCBEXLST EQU   IHADCS50+8                                               02130000
DCBRECFM EQU   DCBEXLST                                                 02131000
DCBRECLA EQU   DCBRECFM                                                 02132000
DCBRECL  EQU   DCBRECLA                                                 02133000
DCBRECBR EQU   DCBRECFM                                                 02134000
DCBRECCC EQU   DCBRECFM                                                 02135000
DCBEXLSA EQU   DCBEXLST+1                                               02136000
IHADCS24 EQU   0                                                        02137000
DCBDDNAM EQU   IHADCS24                                                 02138000
DCBOFLGS EQU   IHADCS24+8                                               02139000
DCBOFLWR EQU   DCBOFLGS                                                 02140000
DCBOFOPN EQU   DCBOFLGS                                                 02141000
DCBIFLG  EQU   IHADCS24+9                                               02142000
DCBIBPCT EQU   DCBIFLG                                                  02143000
DCBMACR  EQU   IHADCS24+10                                              02144000
DCBMACR1 EQU   DCBMACR                                                  02145000
DCBMRFE  EQU   DCBMACR1                                                 02146000
DCBMRGET EQU   DCBMRFE                                                  02147000
DCBMRAPG EQU   DCBMACR1                                                 02148000
DCBMRRD  EQU   DCBMRAPG                                                 02149000
DCBMRCI  EQU   DCBMACR1                                                 02150000
DCBMRMVG EQU   DCBMRCI                                                  02151000
DCBMRLCG EQU   DCBMACR1                                                 02152000
DCBMRABC EQU   DCBMACR1                                                 02153000
DCBMRPT1 EQU   DCBMRABC                                                 02154000
DCBMRSBG EQU   DCBMRPT1                                                 02155000
DCBMRCRL EQU   DCBMACR1                                                 02156000
DCBMRCHK EQU   DCBMRCRL                                                 02157000
DCBMRRDX EQU   DCBMRCHK                                                 02158000
DCBMRDMG EQU   DCBMACR1                                                 02159000
DCBMACR2 EQU   DCBMACR+1                                                02160000
DCBMRPUT EQU   DCBMACR2                                                 02161000
DCBMRWRT EQU   DCBMACR2                                                 02162000
DCBMRMVP EQU   DCBMACR2                                                 02163000
DCBMR5WD EQU   DCBMACR2                                                 02164000
DCBMRLDM EQU   DCBMR5WD                                                 02165000
DCBMRLCP EQU   DCBMRLDM                                                 02166000
DCBMR4WD EQU   DCBMACR2                                                 02167000
DCBMRPT2 EQU   DCBMR4WD                                                 02168000
DCBMRTMD EQU   DCBMRPT2                                                 02169000
DCBMR3WD EQU   DCBMACR2                                                 02170000
DCBMRCTL EQU   DCBMR3WD                                                 02171000
DCBMRSTK EQU   DCBMRCTL                                                 02172000
DCBMR1WD EQU   DCBMACR2                                                 02173000
DCBMRSWA EQU   DCBMR1WD                                                 02174000
DCBMRDMD EQU   DCBMRSWA                                                 02175000
IHADCS25 EQU   0                                                        02176000
DCBMACRF EQU   IHADCS25+2                                               02177000
DCBMACF1 EQU   DCBMACRF                                                 02178000
DCBMFFE  EQU   DCBMACF1                                                 02179000
DCBMFGET EQU   DCBMFFE                                                  02180000
DCBMFAPG EQU   DCBMACF1                                                 02181000
DCBMFRD  EQU   DCBMFAPG                                                 02182000
DCBMFCI  EQU   DCBMACF1                                                 02183000
DCBMFMVG EQU   DCBMFCI                                                  02184000
DCBMFLCG EQU   DCBMACF1                                                 02185000
DCBMFABC EQU   DCBMACF1                                                 02186000
DCBMFPT1 EQU   DCBMFABC                                                 02187000
DCBMFSBG EQU   DCBMFPT1                                                 02188000
DCBMFCRL EQU   DCBMACF1                                                 02189000
DCBMFCHK EQU   DCBMFCRL                                                 02190000
DCBMFDMG EQU   DCBMACF1                                                 02191000
DCBMACF2 EQU   DCBMACRF+1                                               02192000
DCBMFPUT EQU   DCBMACF2                                                 02193000
DCBMFWRT EQU   DCBMACF2                                                 02194000
DCBMFMVP EQU   DCBMACF2                                                 02195000
DCBMF5WD EQU   DCBMACF2                                                 02196000
DCBMFLDM EQU   DCBMF5WD                                                 02197000
DCBMFLCP EQU   DCBMFLDM                                                 02198000
DCBMF4WD EQU   DCBMACF2                                                 02199000
DCBMFPT2 EQU   DCBMF4WD                                                 02200000
DCBMFTMD EQU   DCBMFPT2                                                 02201000
DCBMF3WD EQU   DCBMACF2                                                 02202000
DCBMFCTL EQU   DCBMF3WD                                                 02203000
DCBMFSTK EQU   DCBMFCTL                                                 02204000
DCBMF1WD EQU   DCBMACF2                                                 02205000
DCBMFSWA EQU   DCBMF1WD                                                 02206000
DCBMFDMD EQU   DCBMFSWA                                                 02207000
DCBDEBAD EQU   IHADCS25+4                                               02208000
DCBIFLGS EQU   DCBDEBAD                                                 02209000
DCBIFPCT EQU   DCBIFLGS                                                 02210000
IHADCS26 EQU   0                                                        02211000
DCBWRITE EQU   IHADCS26                                                 02212000
DCBREAD  EQU   DCBWRITE                                                 02213000
DCBWRITA EQU   DCBREAD+1                                                02214000
IHADCS27 EQU   0                                                        02215000
DCBGET   EQU   IHADCS27                                                 02216000
DCBPUT   EQU   DCBGET                                                   02217000
DCBGETA  EQU   DCBPUT+1                                                 02218000
IHADCS36 EQU   0                                                        02219000
DCBGERR  EQU   IHADCS36                                                 02220000
DCBPERR  EQU   DCBGERR                                                  02221000
DCBCHECK EQU   DCBPERR                                                  02222000
DCBOPTCD EQU   DCBCHECK                                                 02223000
DCBOPTH  EQU   DCBOPTCD                                                 02224000
DCBOPTO  EQU   DCBOPTH                                                  02225000
DCBOPTZ  EQU   DCBOPTCD                                                 02226000
DCBGERRA EQU   DCBCHECK+1                                               02227000
DCBPERRA EQU   DCBGERRA                                                 02228000
DCBSYNAD EQU   IHADCS36+4                                               02229000
DCBCIND1 EQU   IHADCS36+8                                               02230000
DCBCIND2 EQU   IHADCS36+9                                               02231000
DCBBLKSI EQU   IHADCS36+10                                              02232000
DCBIOBA  EQU   IHADCS36+16                                              02233000
DCBCICB  EQU   DCBIOBA                                                  02234000
IHADCS52 EQU   0                                                        02235000
DCBDIRCT EQU   IHADCS52                                                 02236000
DCBQSWS  EQU   DCBDIRCT                                                 02237000
DCBUSASI EQU   DCBQSWS                                                  02238000
DCBQADFS EQU   DCBUSASI                                                 02239000
DCBBUFOF EQU   DCBDIRCT+1                                               02240000
IHADCS37 EQU   0                                                        02241000
DCBFLAG1 EQU   IHADCS37                                                 02242000
IHADCS38 EQU   0                                                        02243000
DCBEOBR  EQU   IHADCS38                                                 02244000
DCBLRECL EQU   IHADCS38+10                                              02245000
DCBPOINT EQU   IHADCS38+12                                              02246000
DCBCNTRL EQU   DCBPOINT                                                 02247000
IHADCS40 EQU   0                                                        02248000
DCBEOBAD EQU   IHADCS40                                                 02249000
DCBCCCW  EQU   IHADCS40+4                                               02250000
DCBRECAD EQU   DCBCCCW                                                  02251000
DCBRECBT EQU   DCBRECAD                                                 02252000
DCBRCREL EQU   DCBRECBT                                                 02253000
@NM00052 EQU   IHADCS40+12                                              02254000
DCBEROPT EQU   @NM00052                                                 02255000
I001C    EQU   0                                                        02256000
I008P    EQU   0                                                        02257000
I015F    EQU   0                                                        02258000
I015P    EQU   0                                                        02259000
I031F    EQU   0                                                        02260000
I031P    EQU   0                                                        02261000
I256C    EQU   0                                                        02262000
UPTX     EQU   0                                                        02263000
ECX      EQU   0                                                        02264000
ECB      EQU   0                                                        02265000
STPB     EQU   0                                                        02266000
SPBOPCOD EQU   STPB                                                     02267000
SPBADD   EQU   SPBOPCOD                                                 02268000
SPBDLCUR EQU   SPBOPCOD                                                 02269000
SPBDLPRC EQU   SPBOPCOD                                                 02270000
SPBDLALL EQU   SPBOPCOD                                                 02271000
SPBCODE  EQU   STPB+1                                                   02272000
SPBSTOR  EQU   SPBCODE                                                  02273000
SPBINDD  EQU   SPBCODE                                                  02274000
SPBOTDD  EQU   SPBCODE                                                  02275000
SPBFLUSH EQU   SPBCODE                                                  02276000
SPBRESVD EQU   STPB+2                                                   02277000
SPBMBR   EQU   SPBRESVD+1                                               02278000
SPBSEQ   EQU   SPBRESVD+1                                               02279000
SPBCNTL  EQU   SPBRESVD+1                                               02280000
SPBCLOS  EQU   SPBRESVD+1                                               02281000
SPBADLSD EQU   STPB+4                                                   02282000
SPBINDDN EQU   STPB+8                                                   02283000
SPBOTDDN EQU   STPB+12                                                  02284000
SPBMBRNM EQU   STPB+16                                                  02285000
IOSRLPTR EQU   ECTIOWA                                                  02286000
STAXPARM EQU   STAXD                                                    02287000
@NM00014 EQU   STAXPARM+16                                              02288000
STXATTOF EQU   @NM00014                                                 02289000
IODSDPTR EQU   INSADLSD                                                 02290000
I005     EQU   ILIST                                                    02291000
I00502   EQU   I005+1                                                   02292000
I00504   EQU   I005+5                                                   02293000
I00505   EQU   I005+8                                                   02294000
I00506   EQU   I005+9                                                   02295000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02296000
I00503   EQU   I005+4                                                   02297000
I00501   EQU   I005                                                     02298000
@NM00017 EQU   STAXPARM+17                                              02299000
@NM00016 EQU   @NM00014                                                 02300000
@NM00015 EQU   @NM00014                                                 02301000
@NM00013 EQU   STAXPARM                                                 02302000
@NM00011 EQU   SPBRESVD                                                 02303000
SPBLIST  EQU   SPBCODE                                                  02304000
SPBPROC  EQU   SPBCODE                                                  02305000
SPBPROM  EQU   SPBCODE                                                  02306000
SPBTERM  EQU   SPBCODE                                                  02307000
SPBRSVRD EQU   SPBOPCOD                                                 02308000
ECBCOMPC EQU   ECB                                                      02309000
ECBCBIT  EQU   ECB                                                      02310000
ECBWBIT  EQU   ECB                                                      02311000
DCBEOB   EQU   IHADCS40+20                                              02312000
DCBPRECL EQU   IHADCS40+18                                              02313000
@NM00055 EQU   IHADCS40+16                                              02314000
@NM00054 EQU   @NM00052+1                                               02315000
@NM00053 EQU   DCBEROPT                                                 02316000
DCBERABE EQU   DCBEROPT                                                 02317000
DCBERSKP EQU   DCBEROPT                                                 02318000
DCBERACC EQU   DCBEROPT                                                 02319000
@NM00051 EQU   IHADCS40+10                                              02320000
@NM00050 EQU   IHADCS40+9                                               02321000
@NM00049 EQU   IHADCS40+8                                               02322000
DCBRECA  EQU   DCBRECAD+1                                               02323000
@NM00048 EQU   DCBRECBT                                                 02324000
DCBRCFGT EQU   DCBRCREL                                                 02325000
DCBRCTRU EQU   DCBRCREL                                                 02326000
DCBLCCW  EQU   DCBEOBAD                                                 02327000
DCBNOTE  EQU   DCBCNTRL                                                 02328000
@NM00047 EQU   IHADCS38+8                                               02329000
DCBEOBW  EQU   IHADCS38+4                                               02330000
DCBEOBRA EQU   DCBEOBR+1                                                02331000
DCBNCP   EQU   DCBEOBR                                                  02332000
@NM00046 EQU   DCBFLAG1                                                 02333000
DCBSTFLS EQU   DCBFLAG1                                                 02334000
DCBSTQCK EQU   DCBFLAG1                                                 02335000
DCBDIRCQ EQU   DCBBUFOF                                                 02336000
DCBQSTRU EQU   DCBUSASI                                                 02337000
@NM00045 EQU   DCBUSASI                                                 02338000
DCBQADF3 EQU   DCBQADFS                                                 02339000
DCBQADF2 EQU   DCBQADFS                                                 02340000
DCBQADF1 EQU   DCBQADFS                                                 02341000
DCBBLBP  EQU   DCBUSASI                                                 02342000
@NM00044 EQU   DCBUSASI                                                 02343000
DCBCICBA EQU   DCBCICB+1                                                02344000
@NM00043 EQU   DCBCICB                                                  02345000
DCBOFFSW EQU   IHADCS36+15                                              02346000
DCBOFFSR EQU   IHADCS36+14                                              02347000
DCBWCPL  EQU   IHADCS36+13                                              02348000
DCBWCPO  EQU   IHADCS36+12                                              02349000
DCBCNQSM EQU   DCBCIND2                                                 02350000
DCBCNFEO EQU   DCBCIND2                                                 02351000
DCBCNCHS EQU   DCBCIND2                                                 02352000
DCBCNBFP EQU   DCBCIND2                                                 02353000
DCBCNIOE EQU   DCBCIND2                                                 02354000
DCBCNCLO EQU   DCBCIND2                                                 02355000
DCBCNWRO EQU   DCBCIND2                                                 02356000
DCBCNSTO EQU   DCBCIND2                                                 02357000
DCBCNEXB EQU   DCBCIND1                                                 02358000
@NM00042 EQU   DCBCIND1                                                 02359000
DCBCNBRM EQU   DCBCIND1                                                 02360000
@NM00041 EQU   DCBCIND1                                                 02361000
DCBCNEVA EQU   DCBCIND1                                                 02362000
DCBCNEVB EQU   DCBCIND1                                                 02363000
DCBCNSRD EQU   DCBCIND1                                                 02364000
DCBCNTOV EQU   DCBCIND1                                                 02365000
DCBSYNA  EQU   DCBSYNAD+1                                               02366000
DCBIOBL  EQU   DCBSYNAD                                                 02367000
DCBCHCKA EQU   DCBPERRA                                                 02368000
DCBOPTJ  EQU   DCBOPTCD                                                 02369000
DCBOPTT  EQU   DCBOPTCD                                                 02370000
DCBSRCHD EQU   DCBOPTZ                                                  02371000
DCBOPTQ  EQU   DCBOPTCD                                                 02372000
DCBBCKPT EQU   DCBOPTO                                                  02373000
DCBOPTC  EQU   DCBOPTCD                                                 02374000
DCBOPTU  EQU   DCBOPTCD                                                 02375000
DCBOPTW  EQU   DCBOPTCD                                                 02376000
DCBPUTA  EQU   DCBGETA                                                  02377000
@NM00040 EQU   DCBPUT                                                   02378000
DCBREADA EQU   DCBWRITA                                                 02379000
@NM00039 EQU   DCBREAD                                                  02380000
DCBDEBA  EQU   DCBDEBAD+1                                               02381000
@NM00038 EQU   DCBIFLGS                                                 02382000
DCBIFIOE EQU   DCBIFLGS                                                 02383000
DCBCH12  EQU   DCBIFPCT                                                 02384000
DCBCH9   EQU   DCBIFPCT                                                 02385000
DCBIFEC  EQU   DCBIFLGS                                                 02386000
DCBMFSTI EQU   DCBMFDMD                                                 02387000
DCBMFAWR EQU   DCBMFSTK                                                 02388000
DCBMFUIP EQU   DCBMFTMD                                                 02389000
DCBMFIDW EQU   DCBMFLCP                                                 02390000
DCBMFWRK EQU   DCBMFMVP                                                 02391000
DCBMFRDQ EQU   DCBMFWRT                                                 02392000
DCBMFGTQ EQU   DCBMFPUT                                                 02393000
DCBMFSTL EQU   DCBMACF2                                                 02394000
DCBMFCK  EQU   DCBMFDMG                                                 02395000
DCBMFRDX EQU   DCBMFCHK                                                 02396000
DCBMFDBF EQU   DCBMFSBG                                                 02397000
DCBMFRDI EQU   DCBMFLCG                                                 02398000
DCBMFRDK EQU   DCBMFMVG                                                 02399000
DCBMFWRQ EQU   DCBMFRD                                                  02400000
DCBMFPTQ EQU   DCBMFGET                                                 02401000
DCBMFECP EQU   DCBMACF1                                                 02402000
DCBTIOT  EQU   IHADCS25                                                 02403000
DCBMRSTI EQU   DCBMRDMD                                                 02404000
DCBMRAWR EQU   DCBMRSTK                                                 02405000
DCBMRUIP EQU   DCBMRTMD                                                 02406000
DCBMRIDW EQU   DCBMRLCP                                                 02407000
DCBMRWRK EQU   DCBMRMVP                                                 02408000
DCBMRRDQ EQU   DCBMRWRT                                                 02409000
DCBMRGTQ EQU   DCBMRPUT                                                 02410000
DCBMRSTL EQU   DCBMACR2                                                 02411000
DCBMRCK  EQU   DCBMRDMG                                                 02412000
DCBPGFXA EQU   DCBMRRDX                                                 02413000
DCBMRDBF EQU   DCBMRSBG                                                 02414000
DCBMRRDI EQU   DCBMRLCG                                                 02415000
DCBMRRDK EQU   DCBMRMVG                                                 02416000
DCBMRWRQ EQU   DCBMRRD                                                  02417000
DCBMRPTQ EQU   DCBMRGET                                                 02418000
DCBMRECP EQU   DCBMACR1                                                 02419000
@NM00037 EQU   DCBIFLG                                                  02420000
DCBIBIOE EQU   DCBIFLG                                                  02421000
DCBICH12 EQU   DCBIBPCT                                                 02422000
DCBICH9  EQU   DCBIBPCT                                                 02423000
DCBIBEC  EQU   DCBIFLG                                                  02424000
DCBOFIOF EQU   DCBOFLGS                                                 02425000
DCBOFUEX EQU   DCBOFLGS                                                 02426000
DCBOFTM  EQU   DCBOFLGS                                                 02427000
DCBOFPPC EQU   DCBOFLGS                                                 02428000
DCBOFEOV EQU   DCBOFLGS                                                 02429000
DCBOFLRB EQU   DCBOFLGS                                                 02430000
DCBOFIOD EQU   DCBOFLWR                                                 02431000
DCBRECKL EQU   DCBRECFM                                                 02432000
DCBRECSB EQU   DCBRECFM                                                 02433000
DCBRECTO EQU   DCBRECLA                                                 02434000
DCBEODA  EQU   DCBEODAD+1                                               02435000
DCBBFA   EQU   DCBBFTEK                                                 02436000
DCBH0    EQU   DCBBFTEK                                                 02437000
DCBBFTKD EQU   DCBBFTEK                                                 02438000
DCBBFTE  EQU   DCBBFT                                                   02439000
DCBBFTKR EQU   DCBBFT                                                   02440000
DCBBFTS  EQU   DCBBFT                                                   02441000
DCBH1    EQU   DCBBFTEK                                                 02442000
DCBSVCXA EQU   DCBSVCXL+1                                               02443000
@NM00036 EQU   DCBSVCXL                                                 02444000
DCBODEBA EQU   DCBIOBAA                                                 02445000
@NM00035 EQU   DCBQSLM                                                  02446000
DCBUPDBT EQU   DCBQSLM                                                  02447000
DCBUPDCM EQU   DCBQSLM                                                  02448000
DCB1DVDS EQU   DCBQSLM                                                  02449000
@NM00034 EQU   DCBDSRG2                                                 02450000
DCBDSGTR EQU   DCBDSRG2                                                 02451000
DCBACBM  EQU   DCBDSRG2                                                 02452000
@NM00033 EQU   DCBDSRG2                                                 02453000
DCBDSGTQ EQU   DCBDSRG2                                                 02454000
DCBDSGTX EQU   DCBDSRG2                                                 02455000
DCBDSGGS EQU   DCBDSRG2                                                 02456000
DCBDSGU  EQU   DCBDSRG1                                                 02457000
DCBDSGPO EQU   DCBDSRG1                                                 02458000
@NM00032 EQU   DCBDSRG1                                                 02459000
@NM00031 EQU   DCBDSRG1                                                 02460000
DCBDSGCX EQU   DCBDSRG1                                                 02461000
DCBDSGDA EQU   DCBDSRG1                                                 02462000
DCBDSGPS EQU   DCBDSRG1                                                 02463000
DCBDSGIS EQU   DCBDSRG1                                                 02464000
DCBBUFL  EQU   IHADCS11+8                                               02465000
DCBBUFCA EQU   DCBBUFCB+1                                               02466000
DCBBUFNO EQU   DCBBUFCB                                                 02467000
DCBDEVT  EQU   DCBREL                                                   02468000
DCBKEYLE EQU   DCBRELB                                                  02469000
DCBTRBAL EQU   IHADCS01+6                                               02470000
@NM00030 EQU   IHADCS01+5                                               02471000
@NM00029 EQU   IHADCS01+4                                               02472000
DCBDVTBA EQU   DCBDVTBL+1                                               02473000
@NM00028 EQU   DCBDVTBL                                                 02474000
DCBKEYCN EQU   IHADCS00+4                                               02475000
DCBRELAD EQU   IHADCS00                                                 02476000
@NM00027 EQU   IHADCB                                                   02477000
RESIDCNT EQU   @NM00025+14                                              02478000
@NM00026 EQU   @NM00025                                                 02479000
@NM00024 EQU   CURDECB+8                                                02480000
DECBBLK  EQU   CURDECB+6                                                02481000
@NM00023 EQU   CURDECB                                                  02482000
EOBLK    EQU   BPAMBLK+4                                                02483000
NEXTREC  EQU   BPAMBLK                                                  02484000
MINBFLEN EQU   FILEBLOK+18                                              02485000
FLGS     EQU   FILEBLOK+16                                              02486000
FILENAME EQU   FILEBLOK+8                                               02487000
CURREC   EQU   FILEBLOK+4                                               02488000
IODADLSD EQU   DSDFLAGS+8                                               02489000
@NM00021 EQU   DSDFLAGS+6                                               02490000
@NM00020 EQU   DSDFLAGS+2                                               02491000
@NM00019 EQU   DSDFLAGS                                                 02492000
INSLIST  EQU   INSCODE                                                  02493000
@NM00012 EQU   IOSRL+12                                                 02494000
@NM00010 EQU   ECT+52                                                   02495000
@NM00009 EQU   ECT+48                                                   02496000
@NM00008 EQU   ECT+44                                                   02497000
@NM00007 EQU   ECTSWS2+1                                                02498000
@NM00006 EQU   ECTSWS21                                                 02499000
ECTTABND EQU   ECTSWS21                                                 02500000
ECTDEFCS EQU   ECTSWS21                                                 02501000
ECTBKPB  EQU   ECT+36                                                   02502000
ECTUSER  EQU   ECT+32                                                   02503000
ECTDDNUM EQU   ECT+29                                                   02504000
ECTATTN  EQU   ECTSWS                                                   02505000
ECTBKGRD EQU   ECTSWS                                                   02506000
ECTNNOT  EQU   ECTSWS                                                   02507000
ECTNMAL  EQU   ECTSWS                                                   02508000
ECTLOGF  EQU   ECTSWS                                                   02509000
ECTATRM  EQU   ECTSWS                                                   02510000
@NM00005 EQU   ECTSWS                                                   02511000
ECTNOPD  EQU   ECTSWS                                                   02512000
ECTSCMD  EQU   ECT+20                                                   02513000
ECTPCMD  EQU   ECT+12                                                   02514000
ECTSMSG  EQU   ECT+9                                                    02515000
ECTMSGF  EQU   ECT+8                                                    02516000
ECTRTCD  EQU   ECT+1                                                    02517000
ECTRCDF  EQU   ECT                                                      02518000
SVTDATA  EQU   SVTELEM+4                                                02519000
SVTORIG  EQU   SVTELEM+2                                                02520000
SVTLNG   EQU   SVTELEM                                                  02521000
SVTELFST EQU   SVTAB+16                                                 02522000
SVTABFRE EQU   SVTAB+12                                                 02523000
SVTABUSE EQU   SVTAB+8                                                  02524000
SVTABNXT EQU   SVTAB                                                    02525000
SNTDATA  EQU   SNTELEM+8                                                02526000
SNTLNG   EQU   SNTELEM+6                                                02527000
@NM00004 EQU   SNTFLAGS+1                                               02528000
SNTGLOB  EQU   SNTFLAGS+1                                               02529000
SNTLAST  EQU   SNTFLAGS                                                 02530000
SNTEVAL  EQU   SNTFLAGS                                                 02531000
SNTNAUTH EQU   SNTFLAGS                                                 02532000
SNTNOSCN EQU   SNTFLAGS                                                 02533000
SNTLABEL EQU   SNTFLAGS                                                 02534000
SNTKEYW  EQU   SNTFLAGS                                                 02535000
SNTKEY   EQU   SNTFLAGS                                                 02536000
SNTPOSIT EQU   SNTFLAGS                                                 02537000
SNTGVAL  EQU   SNTVLPTR                                                 02538000
SNTELFST EQU   SNTAB+12                                                 02539000
SNTABUSE EQU   SNTAB+8                                                  02540000
COMRCDS  EQU   COMPROC+12                                               02541000
COMPRUSE EQU   COMPROC+8                                                02542000
COMPRID  EQU   COMPRPTR                                                 02543000
@NM00003 EQU   EXECDATA+60                                              02544000
RETPTR2  EQU   EXECDATA+52                                              02545000
ATACTEND EQU   EXECDATA+48                                              02546000
ATACTSTR EQU   EXECDATA+44                                              02547000
GEXECCNT EQU   EXECDATA+36                                              02548000
NOLASTCC EQU   @NM00002+1                                               02549000
ATINCNTL EQU   @NM00002+1                                               02550000
NOMSG    EQU   @NM00002                                                 02551000
ERINCNTL EQU   @NM00002                                                 02552000
SYMLST   EQU   @NM00002                                                 02553000
ERRCMD   EQU   @NM00002                                                 02554000
CONLST   EQU   @NM00002                                                 02555000
RETPTR   EQU   EXECDATA+28                                              02556000
ERACTEND EQU   EXECDATA+24                                              02557000
ERACTSTR EQU   EXECDATA+20                                              02558000
LASTTSO  EQU   EXECDATA+12                                              02559000
GEXECDAT EQU   EXECDATA+8                                               02560000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02561000
@RT00078 EQU   DELETE                                                   02562000
@RT00116 EQU   INVALID                                                  02563000
@RT00119 EQU   INVALID                                                  02564000
@RC00128 EQU   NORMEND                                                  02565000
@RC00133 EQU   NORMEND                                                  02566000
@RT00152 EQU   NORMEND                                                  02567000
@RT00156 EQU   NORMEND                                                  02568000
@RT00167 EQU   NORMEND                                                  02569000
@RF00302 EQU   @EL00002                                                 02570000
@RC00326 EQU   @RC00325                                                 02571000
@RC00354 EQU   @RC00325                                                 02572000
@RC00372 EQU   @RC00325                                                 02573000
@RC00370 EQU   @RC00325                                                 02574000
@RC00382 EQU   @RC00325                                                 02575000
@RF00429 EQU   @EL00004                                                 02576000
@RF00464 EQU   @EL00004                                                 02577000
@RC00498 EQU   @RC00497                                                 02578000
@RC00520 EQU   @RC00519                                                 02579000
@RC00534 EQU   @RC00533                                                 02580000
@RF00137 EQU   @RC00133                                                 02581000
@RC00333 EQU   @RC00326                                                 02582000
@RC00336 EQU   @RC00326                                                 02583000
@ENDDATA EQU   *                                                        02584000
         END   IKJEFT30,(C'PLS1751',0701,76260)                         02585000
