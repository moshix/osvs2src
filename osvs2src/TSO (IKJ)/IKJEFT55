         TITLE 'IKJEFT55, GETLINE SERVICE ROUTINE - EXEC VERSION       *00001000
                        '                                               00002000
IKJEFT55 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'IKJEFT55  77.010'                                 0001 00009000
IKJGETL  DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00030-IKJGETL)                                    00013000
         ENTRY IKJGETL                                                  00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00016000
         BALR  @12,0                                               0001 00017000
@PSTART  DS    0H                                                  0001 00018000
         USING @PSTART,@12                                         0001 00019000
         L     @00,@SIZDATD                                        0001 00020000
         GETMAIN  R,LV=(0)                                              00021000
         LR    @11,@01                                             0001 00022000
         USING @DATD,@11                                           0001 00023000
         ST    @13,@SA00001+4                                      0001 00024000
         LM    @15,@01,16(@13)                                     0001 00025000
         ST    @11,8(,@13)                                         0001 00026000
         LR    @13,@11                                             0001 00027000
         AH    @15,4(,@15)                                         0001 00028000
         BR    @15                                                 0001 00029000
@EP00001 MVC   @PC00001(16),0(@01)                                 0001 00030000
*                                                                  0028 00031000
*   /*****************************************************************/ 00032000
*   /*                                                               */ 00033000
*   /* START EXECUTABLE CODE                                         */ 00034000
*   /*                                                               */ 00035000
*   /*****************************************************************/ 00036000
*                                                                  0028 00037000
*   GETLINE=NO;                     /* NOT IKJGETL ENTRY             */ 00038000
         NI    GETLINE,B'01111111'                                 0028 00039000
*   GOTO RESTRT2A;                  /* PROCESS                       */ 00040000
         B     RESTRT2A                                            0029 00041000
*IKJGETL:                                                          0030 00042000
*   ENTRY(UPTX,ECTX,ECB,GTPB);                                     0030 00043000
@EP00030 MVC   @PC00001(16),0(@01)                                 0030 00044000
*   GETLINE=YES;                    /* IKJGETL ENTRY                 */ 00045000
         OI    GETLINE,B'10000000'                                 0031 00046000
*RESTRT2A:                                                         0032 00047000
*   ATTNBIT=NO;                     /* INIT CLIST ATTN CONTROL       */ 00048000
RESTRT2A NI    ATTNBIT,B'01111111'                                 0032 00049000
*RESTRT2:                                                          0033 00050000
*   STACKL(1:MACSLEN)=MACROS(1:MACSLEN);/* COPY LIST MACROS          */ 00051000
RESTRT2  L     @06,MACSLEN                                         0033 00052000
         BCTR  @06,0                                               0033 00053000
         EX    @06,@SM00388                                        0033 00054000
*   LSDPTR=INSADLSD;                /* INIT LSDPTR                   */ 00055000
         L     @15,@PC00001+4                                      0034 00056000
         L     @01,ECTIOWA(,@15)                                   0034 00057000
         L     @01,IOSTELM(,@01)                                   0034 00058000
         L     LSDPTR,INSADLSD-1(,@01)                             0034 00059000
         LA    LSDPTR,0(,LSDPTR)                                   0034 00060000
*   ATTNBIT=NO;                     /* ZERO ATTENTION BIT    @ZA11841*/ 00061000
         NI    ATTNBIT,B'01111111'                                 0035 00062000
*   TRUNC=NO;                       /* INIT TRUNCATION BIT OFF       */ 00063000
         NI    TRUNC,B'01111111'                                   0036 00064000
*   COMMENTS=NO;                    /* INIT COMMENT SWITCH OFF       */ 00065000
         NI    COMMENTS,B'01111111'                                0037 00066000
*   CONTEXP=NO;                     /* INIT CONTEXP XM0670           */ 00067000
         NI    CONTEXP,B'01111111'                                 0038 00068000
*   IF PARMTGET(1)=NO THEN                                         0039 00069000
         L     @06,@PC00001+12                                     0039 00070000
         TM    PARMTGET(@06),B'10000000'                           0039 00071000
         BNZ   @RF00039                                            0039 00072000
*     DO;                           /* IF TGET BIT IS NOT ON         */ 00073000
*INVALID:                                                          0041 00074000
*       RETURNCD=20;                /* SET INVALID PARM RTRNCD       */ 00075000
INVALID  LA    RETURNCD,20                                         0041 00076000
*       GOTO EXIT;                  /* BRANCH TO END PROC            */ 00077000
         B     EXIT                                                0042 00078000
*     END;                          /* END INVALID PARM PROCES       */ 00079000
*   IF ECTATTN=YES THEN             /* BYPASS NORMAL PROCESS ON    0044 00080000
*                                                            @ZA08099*/ 00081000
@RF00039 L     @06,@PC00001+4                                      0044 00082000
         TM    ECTATTN(@06),B'00000001'                            0044 00083000
         BNO   @RF00044                                            0044 00084000
*     DO;                           /* CLIST ATTN PROCESSING @ZA08099*/ 00085000
*       SSELMPTR=F0;                /* INIT SUSPENDED ELEMENT PTR  0046 00086000
*                                                            @ZA08099*/ 00087000
         SLR   SSELMPTR,SSELMPTR                                   0046 00088000
*       GOTO CLIST;                 /* HANDLED IN CLIST PROCESSING 0047 00089000
*                                                            @ZA08099*/ 00090000
         B     CLIST                                               0047 00091000
*     END;                          /*                       @ZA08099*/ 00092000
*   IF PARMTERM=YES|                /* DEMAND FROM TERMINAL OR       */ 00093000
*       INSTERM=YES|                /* CURRENT SOURCE IS TERM        */ 00094000
*       INSINDD=YES THEN            /* IN DATESET MODE               */ 00095000
@RF00044 L     @06,@PC00001+12                                     0049 00096000
         TM    PARMTERM(@06),B'00010000'                           0049 00097000
         BO    @RT00049                                            0049 00098000
         L     @06,@PC00001+4                                      0049 00099000
         L     @06,ECTIOWA(,@06)                                   0049 00100000
         L     @06,IOSTELM(,@06)                                   0049 00101000
         TM    INSTERM(@06),B'10100000'                            0049 00102000
         BZ    @RF00049                                            0049 00103000
@RT00049 DS    0H                                                  0050 00104000
*     DO;                                                          0050 00105000
*       IF INSINDD=YES&PARMTERM=NO THEN                            0051 00106000
         L     @06,@PC00001+4                                      0051 00107000
         L     @06,ECTIOWA(,@06)                                   0051 00108000
         L     @06,IOSTELM(,@06)                                   0051 00109000
         TM    INSINDD(@06),B'00100000'                            0051 00110000
         BNO   @RF00051                                            0051 00111000
         L     @15,@PC00001+12                                     0051 00112000
         TM    PARMTERM(@15),B'00010000'                           0051 00113000
         BNZ   @RF00051                                            0051 00114000
*         GETLEN=DSDMINBF+4;                                       0052 00115000
         L     @06,INSADLSD-1(,@06)                                0052 00116000
         LA    GETLEN,4                                            0052 00117000
         AH    GETLEN,DSDMINBF(,@06)                               0052 00118000
*       ELSE                                                       0053 00119000
*         GETLEN=136;                                              0053 00120000
         B     @RC00051                                            0053 00121000
@RF00051 LA    GETLEN,136                                          0053 00122000
*       RFY                                                        0054 00123000
*        (R15) RSTD;                                               0054 00124000
@RC00051 DS    0H                                                  0055 00125000
*       DO;                         /* GETMAIN (EC) LV(GETLEN)     0055 00126000
*                                      A(OBTAINAD) SP(1)             */ 00127000
*         RESPECIFY                                                0056 00128000
*          (GPR01P) RESTRICTED;                                    0056 00129000
*         I004=I004&&I004;          /* INIT LIST                     */ 00130000
         XC    I004(10),I004                                       0057 00131000
*         I00404='20'X;             /* TYPE                          */ 00132000
         MVI   I00404,X'20'                                        0058 00133000
*         I00401=GETLEN;            /* LENGTH                        */ 00134000
         ST    GETLEN,I00401                                       0059 00135000
*         I00403=ADDR(OBTAINAD);    /* ADDR OF ADDR LIST             */ 00136000
         LA    @14,OBTAINAD                                        0060 00137000
         STCM  @14,7,I00403                                        0060 00138000
*         I00405=1;                 /* SUBPOOL VALUE                 */ 00139000
         MVI   I00405,X'01'                                        0061 00140000
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */ 00141000
         LA    GPR01P,I004                                         0062 00142000
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */ 00143000
         SVC   4                                                   0063 00144000
*         RESPECIFY                                                0064 00145000
*          (GPR01P) UNRESTRICTED;                                  0064 00146000
*       END;                        /* GETMAIN (EC) LV(GETLEN)     0065 00147000
*                                      A(OBTAINAD) SP(1)             */ 00148000
*       IF R15^=0 THEN              /* GETMAIN FAILURE               */ 00149000
         LTR   R15,R15                                             0066 00150000
         BZ    @RF00066                                            0066 00151000
*         DO;                                                      0067 00152000
*           RFY                                                    0068 00153000
*            (R15) UNRSTD;                                         0068 00154000
*GETMNER:                                                          0069 00155000
*           RETURNCD=24;            /* INDICATE GETMAIN FAILUR       */ 00156000
GETMNER  LA    RETURNCD,24                                         0069 00157000
*           GOTO EXIT;                                             0070 00158000
         B     EXIT                                                0070 00159000
*         END;                                                     0071 00160000
*       LL=4;                       /* SET INIT BUF LEN TO 4         */ 00161000
@RF00066 LA    @09,4                                               0072 00162000
         L     @06,OBTAINAD                                        0072 00163000
         STH   @09,LL(,@06)                                        0072 00164000
*       BUFLEN=GETLEN-4;            /* INIT BUFFR LEN FOR TGET       */ 00165000
         LR    BUFLEN,GETLEN                                       0073 00166000
         SLR   BUFLEN,@09                                          0073 00167000
*       TGOPTION=PARMTGET;          /* MOVE TGET OPTON IN PARM       */ 00168000
         L     @05,@PC00001+12                                     0074 00169000
         IC    @15,PARMTGET(,@05)                                  0074 00170000
         STC   @15,TGOPTION                                        0074 00171000
*       IBUFADR=OBTAINAD+4;         /* BUFFER ADDRESS FOR TGET       */ 00172000
         ALR   @06,@09                                             0075 00173000
         STCM  @06,7,IBUFADR                                       0075 00174000
*CHECKECB:                                                         0076 00175000
*       IF ECBCBIT=YES              /* IF ATTN ECB IS POSTED         */ 00176000
*         THEN                                                     0076 00177000
CHECKECB L     @09,@PC00001+8                                      0076 00178000
         TM    ECBCBIT(@09),B'01000000'                            0076 00179000
         BNO   @RF00076                                            0076 00180000
*         DO;                                                      0077 00181000
*           RETURNCD=8;             /* SET ATTN RC             Y02996*/ 00182000
         LA    RETURNCD,8                                          0078 00183000
*           GO TO EREXIT;           /* THEN TAKE EREXIT        Y02996*/ 00184000
         B     EREXIT                                              0079 00185000
*         END;                                                     0080 00186000
*       IF INSINDD=NO|              /* IF NOT IN DATASET MODE        */ 00187000
*           (IOSBELM->INSINDD=NO&PARMTERM=YES) THEN                0081 00188000
@RF00076 L     @09,@PC00001+4                                      0081 00189000
         L     @09,ECTIOWA(,@09)                                   0081 00190000
         L     @06,IOSTELM(,@09)                                   0081 00191000
         TM    INSINDD(@06),B'00100000'                            0081 00192000
         BZ    @RT00081                                            0081 00193000
         L     @09,IOSBELM(,@09)                                   0081 00194000
         TM    INSINDD(@09),B'00100000'                            0081 00195000
         BNZ   @RF00081                                            0081 00196000
         L     @09,@PC00001+12                                     0081 00197000
         TM    PARMTERM(@09),B'00010000'                           0081 00198000
         BO    @RT00081                                            0081 00199000
*         GO TO SETUPGET;           /* PREPARE FOR TGET              */ 00200000
*       LINELEN=BUFLEN;             /*                               */ 00201000
@RF00081 ST    BUFLEN,LINELEN                                      0083 00202000
*       IF LINELEN<DSDMINBF THEN    /* IF NOT ENOUGH BUFFER          */ 00203000
         L     @09,LINELEN                                         0084 00204000
         L     @06,@PC00001+4                                      0084 00205000
         L     @01,ECTIOWA(,@06)                                   0084 00206000
         L     @01,IOSTELM(,@01)                                   0084 00207000
         L     @01,INSADLSD-1(,@01)                                0084 00208000
         CH    @09,DSDMINBF(,@01)                                  0084 00209000
         BL    @RT00084                                            0084 00210000
*         GO TO GETBIGBF;           /* GET MORE BUFFER               */ 00211000
*       RFY                                                        0086 00212000
*        (R15) RSTD;                                               0086 00213000
*       CALL IKJRBBMC(IBUFADR,LINELEN,ECT,0);                      0087 00214000
         LA    @14,IBUFADR                                         0087 00215000
         ST    @14,@AL00001                                        0087 00216000
         LA    @14,LINELEN                                         0087 00217000
         ST    @14,@AL00001+4                                      0087 00218000
         ST    @06,@AL00001+8                                      0087 00219000
         LA    @14,@CF00256                                        0087 00220000
         ST    @14,@AL00001+12                                     0087 00221000
         L     @15,@CV00315                                        0087 00222000
         LA    @01,@AL00001                                        0087 00223000
         BALR  @14,@15                                             0087 00224000
*       TGETCODE=R15;               /* SAVE RET CODE FROM BMC        */ 00225000
         LR    TGETCODE,R15                                        0088 00226000
*       RFY                                                        0089 00227000
*        (R15) UNRSTD;                                             0089 00228000
*       IF TGETCODE^=0 THEN         /* IF EOD OCCURRED               */ 00229000
         SLR   @09,@09                                             0090 00230000
         CR    TGETCODE,@09                                        0090 00231000
         BE    @RF00090                                            0090 00232000
*         DO;                                                      0091 00233000
*           IF CONTEXP=YES THEN     /* IF CONT EXP XM0670            */ 00234000
         TM    CONTEXP,B'10000000'                                 0092 00235000
         BO    @RT00092                                            0092 00236000
*             GO TO NORMEND;        /* SET RETURN CODE/EXIT  @ZA15801*/ 00237000
*           IF IOSTELM=IOSBELM THEN /* IF EOF ON BACKGRND            */ 00238000
         L     @10,@PC00001+4                                      0094 00239000
         L     @04,ECTIOWA(,@10)                                   0094 00240000
         CLC   IOSTELM(4,@04),IOSBELM(@04)                         0094 00241000
         BNE   @RF00094                                            0094 00242000
*             DO;                   /* SOURCE, THEN FAKE AN END      */ 00243000
*               ECTLOGF=YES;        /* SET LOGOFF BIT                */ 00244000
         OI    ECTLOGF(@10),B'00010000'                            0096 00245000
*               OO=0;               /* ZERO OFFSET YM2737            */ 00246000
         L     @10,OBTAINAD                                        0097 00247000
         STH   @09,OO(,@10)                                        0097 00248000
*               LL=LL+3;                                           0098 00249000
         LA    @09,3                                               0098 00250000
         AH    @09,LL(,@10)                                        0098 00251000
         STH   @09,LL(,@10)                                        0098 00252000
*               DTAA(1:3)='END';    /* FAKE END COMMAND              */ 00253000
         MVC   DTAA(3,@10),@CC00317                                0099 00254000
*               TGETCODE=0;                                        0100 00255000
         SLR   TGETCODE,TGETCODE                                   0100 00256000
*             END;                                                 0101 00257000
*           ELSE                                                   0102 00258000
*             LL=LL-4;                                             0102 00259000
         B     @RC00094                                            0102 00260000
@RF00094 L     @10,OBTAINAD                                        0102 00261000
         LH    @09,LL(,@10)                                        0102 00262000
         SL    @09,@CF00055                                        0102 00263000
         STH   @09,LL(,@10)                                        0102 00264000
*           GO TO NORMEND;                                         0103 00265000
         B     NORMEND                                             0103 00266000
*         END;                                                     0104 00267000
*       LL=LL+LINELEN;              /* ESTABLISH BUFF LENGTH         */ 00268000
@RF00090 L     @09,OBTAINAD                                        0105 00269000
         LH    @06,LL(,@09)                                        0105 00270000
         AL    @06,LINELEN                                         0105 00271000
         STH   @06,LL(,@09)                                        0105 00272000
*       OO=0;                       /* ZERO OUT OFFSET               */ 00273000
         SLR   @06,@06                                             0106 00274000
         STH   @06,OO(,@09)                                        0106 00275000
*       GO TO CKLOGPHY;             /* CHECK LINE PROCNG TYPE        */ 00276000
         B     CKLOGPHY                                            0107 00277000
*SETUPGET:                                                         0108 00278000
*       RFY                                                        0108 00279000
*        (R0,                                                      0108 00280000
*         R1,                                                      0108 00281000
*         R15) RSTD;                                               0108 00282000
SETUPGET DS    0H                                                  0109 00283000
*       R0=BUFLEN;                  /* FILL IN TGET PARM REG 0       */ 00284000
         LR    R0,BUFLEN                                           0109 00285000
*       R1=TGETPARM;                /* FILL IN TGET PARM REG 1       */ 00286000
         L     R1,TGETPARM                                         0110 00287000
*       GEN SETS(R1) REFS(R0)(TGET (1),(0),R);                     0111 00288000
         TGET (1),(0),R                                                 00289000
*       TGETCODE=R15;               /* SAVE RETRN CODE FROM TGET     */ 00290000
         LR    TGETCODE,R15                                        0112 00291000
*       LINELEN=R1;                 /* SAVE LEN OF RETURNED LINE     */ 00292000
         ST    R1,LINELEN                                          0113 00293000
*       RFY                                                        0114 00294000
*        (R0,                                                      0114 00295000
*         R1,                                                      0114 00296000
*         R15) UNRSTD;                                             0114 00297000
*       IF TGETCODE=0|              /* IF A LINE WAS RETURNED        */ 00298000
*           TGETCODE=12 THEN        /* FROM TGET                     */ 00299000
         LTR   TGETCODE,TGETCODE                                   0115 00300000
         BZ    @RT00115                                            0115 00301000
         C     TGETCODE,@CF00320                                   0115 00302000
         BNE   @RF00115                                            0115 00303000
@RT00115 DS    0H                                                  0116 00304000
*         DO;                                                      0116 00305000
*           LL=LL+LINELEN;          /* ESTABLISH BUFLEN              */ 00306000
         L     @09,OBTAINAD                                        0117 00307000
         LH    @06,LL(,@09)                                        0117 00308000
         AL    @06,LINELEN                                         0117 00309000
         STH   @06,LL(,@09)                                        0117 00310000
*           OO=0;                   /* ZERO OUT OFFSET               */ 00311000
         SLR   @06,@06                                             0118 00312000
         STH   @06,OO(,@09)                                        0118 00313000
*         END;                                                     0119 00314000
*       IF TGETCODE^=0 THEN         /* IF OTHER ERR FROM TGET        */ 00315000
@RF00115 LTR   TGETCODE,TGETCODE                                   0120 00316000
         BZ    @RF00120                                            0120 00317000
*         DO;                                                      0121 00318000
*           IF TGETCODE=8 THEN      /* IF AN ATTN INTRPT             */ 00319000
         C     TGETCODE,@CF00050                                   0122 00320000
         BE    @RT00122                                            0122 00321000
*             GOTO CHECKECB;        /* TRY AGAIN                     */ 00322000
*           IF TGETCODE=12 THEN     /* BUFFR TOO SMALL               */ 00323000
         LA    @09,12                                              0124 00324000
         CR    TGETCODE,@09                                        0124 00325000
         BE    @RT00124                                            0124 00326000
*             GOTO GETBIGBF;                                       0125 00327000
*           IF TGETCODE=4 THEN      /* IF NWAIT & NLINE              */ 00328000
         C     TGETCODE,@CF00055                                   0126 00329000
         BNE   @RF00126                                            0126 00330000
*             DO;                   /* SET NOWAIT RETURN CODE        */ 00331000
*               RETURNCD=12;                                       0128 00332000
         LR    RETURNCD,@09                                        0128 00333000
*               GOTO EREXIT;        /* TERMINATE PROCESSING          */ 00334000
         B     EREXIT                                              0129 00335000
*             END;                                                 0130 00336000
*           IF TGETCODE=20          /* IF TERM HUNG UP SET LINEDROP     00337000
*                                      RETURN CODE                   */ 00338000
*             THEN                                                 0131 00339000
@RF00126 C     TGETCODE,@CF00277                                   0131 00340000
         BNE   @RF00131                                            0131 00341000
*             RETURNCD=28;          /*                         Y02996*/ 00342000
         LA    RETURNCD,28                                         0132 00343000
*           ELSE                                                   0133 00344000
*             RETURNCD=20;          /* OTHERWISE SET INVALID       0133 00345000
*                                      PARAMETERS RETURN CODE  Y02996*/ 00346000
         B     @RC00131                                            0133 00347000
@RF00131 LA    RETURNCD,20                                         0133 00348000
*           GOTO EREXIT;                                           0134 00349000
         B     EREXIT                                              0134 00350000
*         END;                                                     0135 00351000
*                                                                  0136 00352000
*       /*************************************************************/ 00353000
*       /*                                                           */ 00354000
*       /* IF THIS IS CONTINUATION PROCESSING AND PLUS SIGN          */ 00355000
*       /* PROCESSING IS IN EFFECT, THEN SCAN CONTINUED PORTION OF   */ 00356000
*       /* THE BUFFER AND REMOVE ALL LEADING DELIMITERS AND COMMENTS.*/ 00357000
*       /* UPON RETURN FROM SCAN, THE BUFFER POINTER IS CHECKED TO   */ 00358000
*       /* SEE IF IT HAS CHANGED. IF SO, THEN THE BUFFER IS MOVED    */ 00359000
*       /* DOWN, REMOVING THE DELIMITERS. IF SCAN MADE THE BUFFER    */ 00360000
*       /* POINTER GREATER THAN THE END OF THE BUFFER, THE CONTINUED */ 00361000
*       /* PORTION OF THE BUFFER IS DISCARDED AND PROCESSING         */ 00362000
*       /* TERMINATES                                                */ 00363000
*       /*                                                           */ 00364000
*       /*************************************************************/ 00365000
*                                                                  0136 00366000
*CKLOGPHY:                                                         0136 00367000
*       IF CONTEXP=YES&TRUNC=YES THEN                              0136 00368000
@RF00120 DS    0H                                                  0136 00369000
CKLOGPHY TM    CONTEXP,B'10000000'                                 0136 00370000
         BNO   @RF00136                                            0136 00371000
         TM    TRUNC,B'10000000'                                   0136 00372000
         BNO   @RF00136                                            0136 00373000
*         DO;                                                      0137 00374000
*           ENDLOC=IBUFADR+LINELEN-1;                              0138 00375000
         L     @09,IBUFADR-1                                       0138 00376000
         LA    @09,0(,@09)                                         0138 00377000
         LR    ENDLOC,@09                                          0138 00378000
         AL    ENDLOC,LINELEN                                      0138 00379000
         BCTR  ENDLOC,0                                            0138 00380000
*           BUFPTR=IBUFADR;                                        0139 00381000
         LR    BUFPTR,@09                                          0139 00382000
*           CALL SCAN;                                             0140 00383000
         BAL   @14,SCAN                                            0140 00384000
*           IF BUFPTR>IBUFADR&ENDLOC>=BUFPTR THEN                  0141 00385000
         L     @09,IBUFADR-1                                       0141 00386000
         LA    @09,0(,@09)                                         0141 00387000
         CR    BUFPTR,@09                                          0141 00388000
         BNH   @RF00141                                            0141 00389000
         CR    ENDLOC,BUFPTR                                       0141 00390000
         BL    @RF00141                                            0141 00391000
*             DO;                                                  0142 00392000
*               MOVELEN=ENDLOC-BUFPTR+1;                           0143 00393000
         LR    MOVELEN,ENDLOC                                      0143 00394000
         SLR   MOVELEN,BUFPTR                                      0143 00395000
         AL    MOVELEN,@CF00036                                    0143 00396000
*               MASTBFR(1:MOVELEN)=CBUF(1:MOVELEN);                0144 00397000
         LR    @06,MOVELEN                                         0144 00398000
         BCTR  @06,0                                               0144 00399000
         EX    @06,@SM00391                                        0144 00400000
*               LL=LL-(LINELEN-MOVELEN);                           0145 00401000
         L     @09,OBTAINAD                                        0145 00402000
         L     @06,LINELEN                                         0145 00403000
         SLR   @06,MOVELEN                                         0145 00404000
         LCR   @06,@06                                             0145 00405000
         AH    @06,LL(,@09)                                        0145 00406000
         STH   @06,LL(,@09)                                        0145 00407000
*             END;                                                 0146 00408000
*           IF BUFPTR>ENDLOC THEN                                  0147 00409000
@RF00141 CR    BUFPTR,ENDLOC                                       0147 00410000
         BNH   @RF00147                                            0147 00411000
*             DO;                                                  0148 00412000
*               LL=LL-LINELEN;                                     0149 00413000
         L     @09,OBTAINAD                                        0149 00414000
         LH    @06,LL(,@09)                                        0149 00415000
         SL    @06,LINELEN                                         0149 00416000
         STH   @06,LL(,@09)                                        0149 00417000
*               GO TO DELIMCK;                                     0150 00418000
         B     DELIMCK                                             0150 00419000
*             END;                                                 0151 00420000
*         END;                                                     0152 00421000
@RF00147 DS    0H                                                  0153 00422000
*       IF PARMPHYS=NO THEN         /* IF NOT PHYSICAL LINE          */ 00423000
@RF00136 L     @09,@PC00001+12                                     0153 00424000
         TM    PARMPHYS(@09),B'00100000'                           0153 00425000
         BNZ   @RF00153                                            0153 00426000
*         DO;                                                      0154 00427000
*           APOINTER=OBTAINAD+LL-1; /* POINT TO LAST CHAR            */ 00428000
         L     @09,OBTAINAD                                        0155 00429000
         LH    APOINTER,LL(,@09)                                   0155 00430000
         ALR   APOINTER,@09                                        0155 00431000
         BCTR  APOINTER,0                                          0155 00432000
*           IF LASTCHAR='+'|LASTCHAR='-' THEN/* LINE IS TO BE      0156 00433000
*                                      CONTINUED                     */ 00434000
         CLI   LASTCHAR(APOINTER),C'+'                             0156 00435000
         BE    @RT00156                                            0156 00436000
         CLI   LASTCHAR(APOINTER),C'-'                             0156 00437000
         BNE   @RF00156                                            0156 00438000
@RT00156 DS    0H                                                  0157 00439000
*             DO;                                                  0157 00440000
*               IF LASTCHAR='+' THEN                               0158 00441000
         CLI   LASTCHAR(APOINTER),C'+'                             0158 00442000
         BNE   @RF00158                                            0158 00443000
*                 TRUNC=YES;                                       0159 00444000
         OI    TRUNC,B'10000000'                                   0159 00445000
*               CONTEXP=YES;                                       0160 00446000
@RF00158 OI    CONTEXP,B'10000000'                                 0160 00447000
*               LL=LL-1;            /* CAUSE '-' TO BE OVRLAID       */ 00448000
         L     @09,OBTAINAD                                        0161 00449000
         LH    @06,LL(,@09)                                        0161 00450000
         BCTR  @06,0                                               0161 00451000
         STH   @06,LL(,@09)                                        0161 00452000
*               BUFLEN=GETLEN-LL;   /* INDICATE HOW MANY BYTES ARE 0162 00453000
*                                      LEFT IN INPUT BUFFER          */ 00454000
         LR    BUFLEN,GETLEN                                       0162 00455000
         SLR   BUFLEN,@06                                          0162 00456000
*               IBUFADR=OBTAINAD+LL;/* POINT TO NEXT AVAIL BYT       */ 00457000
         ALR   @09,@06                                             0163 00458000
         STCM  @09,7,IBUFADR                                       0163 00459000
*               GOTO CHECKECB;                                     0164 00460000
         B     CHECKECB                                            0164 00461000
*             END;                  /* OF CONTINUED LINE PROCESSING  */ 00462000
*         END;                      /* OF LOGICAL LINE PROCESSING    */ 00463000
@RF00156 DS    0H                                                  0167 00464000
*DELIMCK:                                                          0167 00465000
*       COUNT=1;                    /* INIT COUNT                    */ 00466000
@RF00153 DS    0H                                                  0167 00467000
DELIMCK  LA    COUNT,1                                             0167 00468000
*       IF PARMTERM=NO&             /* NOT DEMAND FROM TERMINAL      */ 00469000
*           INSEXEC=YES&EXDLMPTR^=0 THEN/* IF TERMIN DELIM THEN CHECK*/ 00470000
         L     @06,@PC00001+12                                     0168 00471000
         TM    PARMTERM(@06),B'00010000'                           0168 00472000
         BNZ   @RF00168                                            0168 00473000
         L     @06,@PC00001+4                                      0168 00474000
         L     @06,ECTIOWA(,@06)                                   0168 00475000
         L     @06,IOSTELM(,@06)                                   0168 00476000
         TM    INSEXEC(@06),B'00001000'                            0168 00477000
         BNO   @RF00168                                            0168 00478000
         L     @06,LSDEXEC(,LSDPTR)                                0168 00479000
         L     @06,EXDLMPTR(,@06)                                  0168 00480000
         LTR   @06,@06                                             0168 00481000
         BZ    @RF00168                                            0168 00482000
*         DO;                       /* FOR MATCHING DELIMETER        */ 00483000
*           BUFPTR=OBTAINAD+4;      /* POINT TO BIGIN OF BFR         */ 00484000
         L     @06,OBTAINAD                                        0170 00485000
         LA    BUFPTR,4                                            0170 00486000
         ALR   BUFPTR,@06                                          0170 00487000
*           ENDLOC=BUFPTR+LL-5;     /* POINT TO END OF BFR           */ 00488000
         LR    ENDLOC,BUFPTR                                       0171 00489000
         AH    ENDLOC,LL(,@06)                                     0171 00490000
         SL    ENDLOC,@CF00259                                     0171 00491000
*           CALL SCAN;              /* SKIP DELIMETERS               */ 00492000
         BAL   @14,SCAN                                            0172 00493000
*           IF BUFPTR<=ENDLOC THEN  /* AS LONG AS AT LEAST ONE       */ 00494000
         CR    BUFPTR,ENDLOC                                       0173 00495000
         BH    @RF00173                                            0173 00496000
*             DO;                   /* PROCESS                       */ 00497000
*               ENDBUF=ENDLOC-BUFPTR+1;/* SET COUNT OF CHARS         */ 00498000
         LA    @03,1                                               0175 00499000
         LR    ENDBUF,ENDLOC                                       0175 00500000
         SLR   ENDBUF,BUFPTR                                       0175 00501000
         ALR   ENDBUF,@03                                          0175 00502000
*               DO I=1 TO ENDBUF WHILE/* FIND END OF FIRST STRING    */ 00503000
*                     CBUF(I)^=' '&CBUF(I)^=','&CBUF(I)^='05'X&/*    */ 00504000
*                     (I=ENDBUF|CBUF(I:I+1)^='/*');/*                */ 00505000
         LA    @15,1                                               0176 00506000
         LR    I,@15                                               0176 00507000
         B     @DE00176                                            0176 00508000
@DL00176 LR    @01,BUFPTR                                          0176 00509000
         ALR   @01,I                                               0176 00510000
         BCTR  @01,0                                               0176 00511000
         CLI   CBUF(@01),C' '                                      0176 00512000
         BE    @DC00176                                            0176 00513000
         LR    @01,BUFPTR                                          0176 00514000
         ALR   @01,I                                               0176 00515000
         BCTR  @01,0                                               0176 00516000
         CLI   CBUF(@01),C','                                      0176 00517000
         BE    @DC00176                                            0176 00518000
         LR    @01,BUFPTR                                          0176 00519000
         ALR   @01,I                                               0176 00520000
         BCTR  @01,0                                               0176 00521000
         CLI   CBUF(@01),X'05'                                     0176 00522000
         BE    @DC00176                                            0176 00523000
         CR    I,ENDBUF                                            0176 00524000
         BE    @DB00176                                            0176 00525000
         LR    @01,BUFPTR                                          0176 00526000
         ALR   @01,I                                               0176 00527000
         BCTR  @01,0                                               0176 00528000
         CLC   CBUF(2,@01),@CC00331                                0176 00529000
         BE    @DC00176                                            0176 00530000
@DB00176 DS    0H                                                  0177 00531000
*               END;                /*                               */ 00532000
         AL    I,@CF00036                                          0177 00533000
@DE00176 CR    I,ENDBUF                                            0177 00534000
         BNH   @DL00176                                            0177 00535000
@DC00176 DS    0H                                                  0178 00536000
*               I=I-1;              /* DECREMENT I                   */ 00537000
         BCTR  I,0                                                 0178 00538000
*             END;                  /* END                           */ 00539000
*           ELSE                    /* OTHERWISE ALL DELIMS          */ 00540000
*             I=0;                  /* I=0                           */ 00541000
         B     @RC00173                                            0180 00542000
@RF00173 SLR   I,I                                                 0180 00543000
*           FOLDAREA='';            /* CLEAR FOLDAREA TO BLANK       */ 00544000
@RC00173 MVI   FOLDAREA,C' '                                       0181 00545000
         MVC   FOLDAREA+1(255),FOLDAREA                            0181 00546000
*           IF I>0 THEN             /* IF NOT NULL                   */ 00547000
         LTR   I,I                                                 0182 00548000
         BNP   @RF00182                                            0182 00549000
*             FOLDAREA(1:I)=FOLDAREA(1:I)|CBUF(1:I);/* FOLD INPUT LN */ 00550000
         LR    @06,I                                               0183 00551000
         BCTR  @06,0                                               0183 00552000
         EX    @06,@SO00393                                        0183 00553000
*           DO DELIMPTR=EXDLMPTR+2 BY DELIMLL WHILE/* FIND A MATCH   */ 00554000
*                 DELIMPTR<EXDLMPTR+EXDLMPTR->DELIMLL;/* END OF LST  */ 00555000
@RF00182 L     @01,LSDEXEC(,LSDPTR)                                0184 00556000
         LA    DELIMPTR,2                                          0184 00557000
         AL    DELIMPTR,EXDLMPTR(,@01)                             0184 00558000
         B     @DE00184                                            0184 00559000
@DL00184 DS    0H                                                  0185 00560000
*             IF I+2=DELIMLL&(I=0|  /* LENGTH MATCH                  */ 00561000
*                 FOLDAREA(1:I)=DELIM(1:I)) THEN                   0185 00562000
         LA    @15,2                                               0185 00563000
         ALR   @15,I                                               0185 00564000
         CH    @15,DELIMLL(,DELIMPTR)                              0185 00565000
         BNE   @RF00185                                            0185 00566000
         LTR   I,I                                                 0185 00567000
         BZ    @RT00185                                            0185 00568000
         LR    @15,I                                               0185 00569000
         BCTR  @15,0                                               0185 00570000
         EX    @15,@SC00395                                        0185 00571000
         BNE   @RF00185                                            0185 00572000
@RT00185 DS    0H                                                  0186 00573000
*               DO;                 /*                               */ 00574000
*                 LOCPTR=ADDR(SYSDLM);/* SYSDLM FIRST                */ 00575000
         LA    @06,@CC00252                                        0187 00576000
         ST    @06,LOCPTR                                          0187 00577000
*                 LOCLEN=LENGTH(SYSDLM);/* LENGTH                    */ 00578000
         MVC   LOCLEN(4),@CF00134                                  0188 00579000
*                 VALPTR=ADDR(OUTA);/* VALUE                         */ 00580000
         LA    @06,OUTA                                            0189 00581000
         ST    @06,VALPTR                                          0189 00582000
*                 CVD(COUNT,WORKAREA);/* CONVERT TO DECIMAL          */ 00583000
         CVD   COUNT,WORKAREA                                      0190 00584000
*                 UNPK(OUTA,WORKAREA);/* UNPACK TO PRINTABLE         */ 00585000
         UNPK  OUTA(2),WORKAREA(8)                                 0191 00586000
*                 OUTA(2)=OUTA(2)|'0';/* GET RID OF SIGN             */ 00587000
         OI    OUTA+1,C'0'                                         0192 00588000
*                 IF OUTA(1)='0' THEN/* IF LEADING ZERO              */ 00589000
         CLI   OUTA,C'0'                                           0193 00590000
         BNE   @RF00193                                            0193 00591000
*                   DO;             /* REMOVE                        */ 00592000
*                     OUTA(1)=OUTA(2);/* SHIFT OUTA                  */ 00593000
         MVC   OUTA(1),OUTA+1                                      0195 00594000
*                     VALLEN=1;     /* VALUE LENGTH IS ONE           */ 00595000
         MVC   VALLEN(4),@CF00036                                  0196 00596000
*                   END;            /*                               */ 00597000
*                 ELSE              /* OTHERWISE                     */ 00598000
*                   VALLEN=2;       /* VALLEN IS TWO                 */ 00599000
         B     @RC00193                                            0198 00600000
@RF00193 MVC   VALLEN(4),@CF00087                                  0198 00601000
*                 CALL IKJUPDT(UPT,ECT,ECB,UPLIST);/* UPDATE         */ 00602000
@RC00193 L     @09,@PC00001                                        0199 00603000
         ST    @09,@AL00001                                        0199 00604000
         L     @09,@PC00001+4                                      0199 00605000
         ST    @09,@AL00001+4                                      0199 00606000
         L     @09,@PC00001+8                                      0199 00607000
         ST    @09,@AL00001+8                                      0199 00608000
         LA    @09,UPLIST                                          0199 00609000
         ST    @09,@AL00001+12                                     0199 00610000
         L     @15,@CV00336                                        0199 00611000
         LA    @01,@AL00001                                        0199 00612000
         BALR  @14,@15                                             0199 00613000
*                 LOCPTR=ADDR(SYSDVAL);/* UPDATE VALUE               */ 00614000
         LA    @09,@CC00254                                        0200 00615000
         ST    @09,LOCPTR                                          0200 00616000
*                 LOCLEN=LENGTH(SYSDVAL);/* LENGTH                   */ 00617000
         MVC   LOCLEN(4),@CF00103                                  0201 00618000
*                 VALPTR=ADDR(CBUF(I+1));/* VALUE                    */ 00619000
         LA    @09,CBUF(I,BUFPTR)                                  0202 00620000
         ST    @09,VALPTR                                          0202 00621000
*                 VALLEN=ENDLOC-VALPTR+1;/* LENGTH                   */ 00622000
         LA    @06,1                                               0203 00623000
         LCR   @09,@09                                             0203 00624000
         ALR   @09,ENDLOC                                          0203 00625000
         ALR   @09,@06                                             0203 00626000
         ST    @09,VALLEN                                          0203 00627000
*                 DO I=1 TO VALLEN; /* FOLD TO UPPER CASE            */ 00628000
         LR    I,@06                                               0204 00629000
         B     @DE00204                                            0204 00630000
@DL00204 DS    0H                                                  0205 00631000
*                   TR(VAL(I),TRTABUP);/* FOLD TO UPPER CASE         */ 00632000
         L     @09,VALPTR                                          0205 00633000
         ALR   @09,I                                               0205 00634000
         BCTR  @09,0                                               0205 00635000
         L     @06,@CA00206                                        0205 00636000
         TR    VAL(1,@09),TRTABUP-TRTABUP(@06)                     0205 00637000
*                 END;              /*                               */ 00638000
         AL    I,@CF00036                                          0206 00639000
@DE00204 C     I,VALLEN                                            0206 00640000
         BNH   @DL00204                                            0206 00641000
*                 CALL IKJUPDT(UPT,ECT,ECB,UPLIST);/* UPDATE         */ 00642000
         L     @09,@PC00001                                        0207 00643000
         ST    @09,@AL00001                                        0207 00644000
         L     @09,@PC00001+4                                      0207 00645000
         ST    @09,@AL00001+4                                      0207 00646000
         L     @09,@PC00001+8                                      0207 00647000
         ST    @09,@AL00001+8                                      0207 00648000
         LA    @09,UPLIST                                          0207 00649000
         ST    @09,@AL00001+12                                     0207 00650000
         L     @15,@CV00336                                        0207 00651000
         LA    @01,@AL00001                                        0207 00652000
         BALR  @14,@15                                             0207 00653000
*                 CALL FREETIN;     /* FREE TERMIN BLKS              */ 00654000
         BAL   @14,FREETIN                                         0208 00655000
*                 DO;               /* FREEMAIN (E) LV(GETLEN)     0209 00656000
*                                      A(OBTAINAD) SP(1)             */ 00657000
*                   RESPECIFY                                      0210 00658000
*                    (GPR01P) RESTRICTED;                          0210 00659000
*                   I005=I005&&I005;/* INIT LIST                     */ 00660000
         XC    I005(10),I005                                       0211 00661000
*                   I00505='00'X;   /* SET TYPE                      */ 00662000
         MVI   I00505,X'00'                                        0212 00663000
*                   I00502=GETLEN;  /* LENGTH                        */ 00664000
         STCM  GETLEN,7,I00502                                     0213 00665000
*                   I00504=ADDR(OBTAINAD);/* ADDR OF ADDR LIST       */ 00666000
         LA    @06,OBTAINAD                                        0214 00667000
         STCM  @06,7,I00504                                        0214 00668000
*                   I00506=1;       /* SUBPOOL VALUE                 */ 00669000
         MVI   I00506,X'01'                                        0215 00670000
*                   GPR01P=ADDR(I005);/* REG1 POINTS TO LIST         */ 00671000
         LA    GPR01P,I005                                         0216 00672000
*                   SVC(5);         /* STANDARD-FORM OF GETMAIN      */ 00673000
         SVC   5                                                   0217 00674000
*                   RESPECIFY                                      0218 00675000
*                    (GPR01P) UNRESTRICTED;                        0218 00676000
*                 END;              /* FREEMAIN (E) LV(GETLEN)     0219 00677000
*                                      A(OBTAINAD) SP(1)             */ 00678000
*                 GOTO CLIST;       /* PROCESS CLIST                 */ 00679000
         B     CLIST                                               0220 00680000
*               END;                                               0221 00681000
*             ELSE                                                 0222 00682000
*               COUNT=COUNT+1;      /* INCREMENT COUNT               */ 00683000
@RF00185 AL    COUNT,@CF00036                                      0222 00684000
*           END;                                                   0223 00685000
         AH    DELIMPTR,DELIMLL(,DELIMPTR)                         0223 00686000
@DE00184 L     @15,LSDEXEC(,LSDPTR)                                0223 00687000
         L     @14,EXDLMPTR(,@15)                                  0223 00688000
         LH    @01,DELIMLL(,@14)                                   0223 00689000
         ALR   @01,@14                                             0223 00690000
         CR    DELIMPTR,@01                                        0223 00691000
         BL    @DL00184                                            0223 00692000
*           IF ATTNBIT=YES THEN     /* IF WE ARE IN CLIST ATT        */ 00693000
         TM    ATTNBIT,B'10000000'                                 0224 00694000
         BNO   @RF00224                                            0224 00695000
*             DO;                   /* PROCESSING THEN WE MUST     0225 00696000
*                                      RESTORE               @ZA08099*/ 00697000
*               ATTNBIT=NO;         /* OR DELETE ANY SUSPENDED ELMTS    00698000
*                                                            @ZA08099*/ 00699000
         NI    ATTNBIT,B'01111111'                                 0226 00700000
*               IF ATINCNTL=YES THEN/* IF WE ARE STILL IN THE ATTN 0227 00701000
*                                                            @ZA08099*/ 00702000
         TM    ATINCNTL(@15),B'10000000'                           0227 00703000
         BNO   @RF00227                                            0227 00704000
*                 DO;               /* ACTION THEN FORCE END OF ATTN    00705000
*                                                            @ZA08099*/ 00706000
*                   ATINCNTL=NO;    /* ACTION AND RESTORE LSD TO   0229 00707000
*                                      POINT                 @ZA08099*/ 00708000
         NI    ATINCNTL(@15),B'01111111'                           0229 00709000
*                   LSDANEXT=RETPTR;/* OF INTERRUPTION       @ZA08099*/ 00710000
         L     @10,RETPTR(,@15)                                    0230 00711000
         ST    @10,LSDANEXT(,LSDPTR)                               0230 00712000
*                 END;              /*                       @ZA08099*/ 00713000
*               CALL FREETIN;       /* FREE TERMIN CONTROL BLKS    0232 00714000
*                                                            @ZA08099*/ 00715000
@RF00227 BAL   @14,FREETIN                                         0232 00716000
*               IF BUFPTR<=ENDLOC THEN/* IF DATA IS NOT A NULL LINE     00717000
*                                                            @ZA08099*/ 00718000
         CR    BUFPTR,ENDLOC                                       0233 00719000
         BH    @RF00233                                            0233 00720000
*                 DO;               /* THEN DELETE SUSPENDED ELMTS 0234 00721000
*                                                            @ZA08099*/ 00722000
*                   DLBASE=IOSTELM; /* OTHERWISE RESTORE THEM      0235 00723000
*                                                            @ZA08099*/ 00724000
         L     @10,@PC00001+4                                      0235 00725000
         L     @10,ECTIOWA(,@10)                                   0235 00726000
         L     DLBASE,IOSTELM(,@10)                                0235 00727000
*                   IOSTELM=SUSPENDI;/*                      @ZA08099*/ 00728000
         MVC   IOSTELM(4,@10),SUSPENDI                             0236 00729000
*                   DO WHILE IOSTELM^=DLBASE;/* DELETE THE ELMTS   0237 00730000
*                                                            @ZA08099*/ 00731000
         B     @DE00237                                            0237 00732000
@DL00237 DS    0H                                                  0238 00733000
*                     RFY                                          0238 00734000
*                       LSD BASED(INSADLSD);/*               @ZA08099*/ 00735000
*                     IF INSEXEC=YES THEN/* IGNORE MAIN CLISTS     0239 00736000
*                                                            @ZA08099*/ 00737000
         L     @10,@PC00001+4                                      0239 00738000
         L     @10,ECTIOWA(,@10)                                   0239 00739000
         L     @10,IOSTELM(,@10)                                   0239 00740000
         TM    INSEXEC(@10),B'00001000'                            0239 00741000
         BNO   @RF00239                                            0239 00742000
*                       CMAIN=NO;   /* STACK SERRTN ADJUSTS IOSTELM     00743000
*                                                            @ZA08099*/ 00744000
         L     @10,INSADLSD-1(,@10)                                0240 00745000
         L     @10,LSDEXEC(,@10)                                   0240 00746000
         NI    CMAIN(@10),B'11111011'                              0240 00747000
*                     CALL IKJEFT30(UPT,ECT,ECB,STACKL);/*   @ZA08099*/ 00748000
@RF00239 L     @10,@PC00001                                        0241 00749000
         ST    @10,@AL00001                                        0241 00750000
         L     @10,@PC00001+4                                      0241 00751000
         ST    @10,@AL00001+4                                      0241 00752000
         L     @10,@PC00001+8                                      0241 00753000
         ST    @10,@AL00001+8                                      0241 00754000
         LA    @10,STACKL                                          0241 00755000
         ST    @10,@AL00001+12                                     0241 00756000
         L     @15,@CV00346                                        0241 00757000
         LA    @01,@AL00001                                        0241 00758000
         BALR  @14,@15                                             0241 00759000
*                     RFY                                          0242 00760000
*                       LSD BASED(LSDPTR);/*                 @ZA08099*/ 00761000
*                   END;            /*                       @ZA08099*/ 00762000
@DE00237 L     @10,@PC00001+4                                      0243 00763000
         L     @10,ECTIOWA(,@10)                                   0243 00764000
         C     DLBASE,IOSTELM(,@10)                                0243 00765000
         BNE   @DL00237                                            0243 00766000
*                 END;              /*                       @ZA08099*/ 00767000
*               ELSE                /*                       @ZA08099*/ 00768000
*                 IOSTELM=SUSPENDI; /*                       @ZA08099*/ 00769000
         B     @RC00233                                            0245 00770000
@RF00233 L     @10,@PC00001+4                                      0245 00771000
         L     @10,ECTIOWA(,@10)                                   0245 00772000
         MVC   IOSTELM(4,@10),SUSPENDI                             0245 00773000
*             END;                  /*                       @ZA08099*/ 00774000
@RC00233 DS    0H                                                  0247 00775000
*         END;                      /*                       @ZA08099*/ 00776000
@RF00224 DS    0H                                                  0248 00777000
*NORMEND:                                                          0248 00778000
*       PARMADIN=OBTAINAD;          /* PLACE BUFFR ADDR IN PARM      */ 00779000
@RF00168 DS    0H                                                  0248 00780000
NORMEND  L     @10,OBTAINAD                                        0248 00781000
         L     @04,@PC00001+12                                     0248 00782000
         ST    @10,PARMADIN(,@04)                                  0248 00783000
*       FREEADDR=(((OBTAINAD+LL)+7)/8)*8;/* ROUND ADDR TO DOUBL WRD  */ 00784000
         LA    @04,8                                               0249 00785000
         LA    @15,7                                               0249 00786000
         LH    @00,LL(,@10)                                        0249 00787000
         ALR   @00,@10                                             0249 00788000
         ALR   @00,@15                                             0249 00789000
         SRDA  @00,32                                              0249 00790000
         DR    @00,@04                                             0249 00791000
         SLA   @01,3                                               0249 00792000
         ST    @01,FREEADDR                                        0249 00793000
*       FREELEN=((GETLEN+7)/8*8)-(FREEADDR-OBTAINAD);/* CALC AMOUNT     00794000
*                                      TO FREE                       */ 00795000
         LR    @02,@15                                             0250 00796000
         ALR   @02,GETLEN                                          0250 00797000
         SRDA  @02,32                                              0250 00798000
         DR    @02,@04                                             0250 00799000
         SLA   @03,3                                               0250 00800000
         SLR   @01,@10                                             0250 00801000
         SLR   @03,@01                                             0250 00802000
         LR    FREELEN,@03                                         0250 00803000
*       DO;                         /* FREEMAIN (E) LV(FREELEN)    0251 00804000
*                                      A(FREEADDR) SP(1)             */ 00805000
*         RESPECIFY                                                0252 00806000
*          (GPR01P) RESTRICTED;                                    0252 00807000
*         I005=I005&&I005;          /* INIT LIST                     */ 00808000
         XC    I005(10),I005                                       0253 00809000
*         I00505='00'X;             /* SET TYPE                      */ 00810000
         MVI   I00505,X'00'                                        0254 00811000
*         I00502=FREELEN;           /* LENGTH                        */ 00812000
         STCM  FREELEN,7,I00502                                    0255 00813000
*         I00504=ADDR(FREEADDR);    /* ADDR OF ADDR LIST             */ 00814000
         LA    @10,FREEADDR                                        0256 00815000
         STCM  @10,7,I00504                                        0256 00816000
*         I00506=1;                 /* SUBPOOL VALUE                 */ 00817000
         MVI   I00506,X'01'                                        0257 00818000
*         GPR01P=ADDR(I005);        /* REG1 POINTS TO LIST           */ 00819000
         LA    GPR01P,I005                                         0258 00820000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 00821000
         SVC   5                                                   0259 00822000
*         RESPECIFY                                                0260 00823000
*          (GPR01P) UNRESTRICTED;                                  0260 00824000
*       END;                        /* FREEMAIN (E) LV(FREELEN)    0261 00825000
*                                      A(FREEADDR) SP(1)             */ 00826000
*       IF INSINDD=YES&PARMTERM=NO THEN/* IF DEMAND NOT TO TERMINAL     00827000
*                                      AND                           */ 00828000
         L     @10,@PC00001+4                                      0262 00829000
         L     @10,ECTIOWA(,@10)                                   0262 00830000
         L     @10,IOSTELM(,@10)                                   0262 00831000
         TM    INSINDD(@10),B'00100000'                            0262 00832000
         BNO   @RF00262                                            0262 00833000
         L     @10,@PC00001+12                                     0262 00834000
         TM    PARMTERM(@10),B'00010000'                           0262 00835000
         BNZ   @RF00262                                            0262 00836000
*         DO;                       /* IN DATASET MODE THEN          */ 00837000
*           IF TGETCODE=4 THEN      /* ON DATASET EOF OTHER          */ 00838000
         LA    @10,4                                               0264 00839000
         CR    TGETCODE,@10                                        0264 00840000
         BE    @RT00264                                            0264 00841000
*             GO TO DELETE;         /* THAN BACKGD STREAM GO TO DELET*/ 00842000
*           RETURNCD=4;             /* SET NORMAL DS RCODE           */ 00843000
         LR    RETURNCD,@10                                        0266 00844000
*           GO TO EXIT;                                            0267 00845000
         B     EXIT                                                0267 00846000
*         END;                                                     0268 00847000
*       RETURNCD=0;                 /* SET NORMAL RETURN CODE        */ 00848000
@RF00262 SLR   RETURNCD,RETURNCD                                   0269 00849000
*       GOTO EXIT;                                                 0270 00850000
         B     EXIT                                                0270 00851000
*GETBIGBF:                                                         0271 00852000
*       FREEADDR=OBTAINAD;          /* ADDR OF STORAGE TO FREE       */ 00853000
GETBIGBF L     @06,OBTAINAD                                        0271 00854000
         ST    @06,FREEADDR                                        0271 00855000
*       FREELEN=GETLEN;             /* DETERMIN AMOUNT TO FREE       */ 00856000
         LR    FREELEN,GETLEN                                      0272 00857000
*       IF INSINDD=YES&PARMTERM=NO THEN/* IF DATASET I/O             */ 00858000
         L     @06,@PC00001+4                                      0273 00859000
         L     @06,ECTIOWA(,@06)                                   0273 00860000
         L     @06,IOSTELM(,@06)                                   0273 00861000
         TM    INSINDD(@06),B'00100000'                            0273 00862000
         BNO   @RF00273                                            0273 00863000
         L     @15,@PC00001+12                                     0273 00864000
         TM    PARMTERM(@15),B'00010000'                           0273 00865000
         BNZ   @RF00273                                            0273 00866000
*         GETLEN=GETLEN+DSDMINBF;   /* ADJUST BY MINIMUM BFR         */ 00867000
         L     @06,INSADLSD-1(,@06)                                0274 00868000
         AH    GETLEN,DSDMINBF(,@06)                               0274 00869000
*       ELSE                                                       0275 00870000
*         GETLEN=GETLEN+136;                                       0275 00871000
         B     @RC00273                                            0275 00872000
@RF00273 AL    GETLEN,@CF00299                                     0275 00873000
*       RFY                                                        0276 00874000
*        (R15) RSTD;                                               0276 00875000
@RC00273 DS    0H                                                  0277 00876000
*       DO;                         /* GETMAIN (EC) LV(GETLEN)     0277 00877000
*                                      A(OBTAINAD) SP(1)             */ 00878000
*         RESPECIFY                                                0278 00879000
*          (GPR01P) RESTRICTED;                                    0278 00880000
*         I004=I004&&I004;          /* INIT LIST                     */ 00881000
         XC    I004(10),I004                                       0279 00882000
*         I00404='20'X;             /* TYPE                          */ 00883000
         MVI   I00404,X'20'                                        0280 00884000
*         I00401=GETLEN;            /* LENGTH                        */ 00885000
         ST    GETLEN,I00401                                       0281 00886000
*         I00403=ADDR(OBTAINAD);    /* ADDR OF ADDR LIST             */ 00887000
         LA    @14,OBTAINAD                                        0282 00888000
         STCM  @14,7,I00403                                        0282 00889000
*         I00405=1;                 /* SUBPOOL VALUE                 */ 00890000
         MVI   I00405,X'01'                                        0283 00891000
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */ 00892000
         LA    GPR01P,I004                                         0284 00893000
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */ 00894000
         SVC   4                                                   0285 00895000
*         RESPECIFY                                                0286 00896000
*          (GPR01P) UNRESTRICTED;                                  0286 00897000
*       END;                        /* GETMAIN (EC) LV(GETLEN)     0287 00898000
*                                      A(OBTAINAD) SP(1)             */ 00899000
*       IF R15^=0 THEN              /* GETMAIN ERROR                 */ 00900000
         LTR   R15,R15                                             0288 00901000
         BNZ   @RT00288                                            0288 00902000
*         GOTO GETMNER;                                            0289 00903000
*       RFY                                                        0290 00904000
*        (R15) UNRSTD;                                             0290 00905000
*       RFY                                                        0291 00906000
*        (R2,                                                      0291 00907000
*         R3,                                                      0291 00908000
*         R4,                                                      0291 00909000
*         R5) RSTD;                                                0291 00910000
*       R4=FREEADDR;                                               0292 00911000
         L     R4,FREEADDR                                         0292 00912000
*       R2=OBTAINAD;                                               0293 00913000
         L     R2,OBTAINAD                                         0293 00914000
*       R3=FREELEN;                                                0294 00915000
         LR    R3,FREELEN                                          0294 00916000
*       R5=R3;                                                     0295 00917000
         LR    R5,R3                                               0295 00918000
*       MVCL(R2,R4);                                               0296 00919000
         MVCL  R2,R4                                               0296 00920000
*       RFY                                                        0297 00921000
*        (R2,                                                      0297 00922000
*         R3,                                                      0297 00923000
*         R4,                                                      0297 00924000
*         R5) UNRSTD;                                              0297 00925000
*       DO;                         /* FREEMAIN (E) LV(FREELEN)    0298 00926000
*                                      A(FREEADDR) SP(1)             */ 00927000
*         RESPECIFY                                                0299 00928000
*          (GPR01P) RESTRICTED;                                    0299 00929000
*         I005=I005&&I005;          /* INIT LIST                     */ 00930000
         XC    I005(10),I005                                       0300 00931000
*         I00505='00'X;             /* SET TYPE                      */ 00932000
         MVI   I00505,X'00'                                        0301 00933000
*         I00502=FREELEN;           /* LENGTH                        */ 00934000
         STCM  FREELEN,7,I00502                                    0302 00935000
*         I00504=ADDR(FREEADDR);    /* ADDR OF ADDR LIST             */ 00936000
         LA    @09,FREEADDR                                        0303 00937000
         STCM  @09,7,I00504                                        0303 00938000
*         I00506=1;                 /* SUBPOOL VALUE                 */ 00939000
         MVI   I00506,X'01'                                        0304 00940000
*         GPR01P=ADDR(I005);        /* REG1 POINTS TO LIST           */ 00941000
         LA    GPR01P,I005                                         0305 00942000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 00943000
         SVC   5                                                   0306 00944000
*         RESPECIFY                                                0307 00945000
*          (GPR01P) UNRESTRICTED;                                  0307 00946000
*       END;                        /* FREEMAIN (E) LV(FREELEN)    0308 00947000
*                                      A(FREEADDR) SP(1)             */ 00948000
*       IBUFADR=OBTAINAD+LL;        /* SET UP PARMS FOR TGET         */ 00949000
         L     @09,OBTAINAD                                        0309 00950000
         LH    @06,LL(,@09)                                        0309 00951000
         ALR   @09,@06                                             0309 00952000
         STCM  @09,7,IBUFADR                                       0309 00953000
*       BUFLEN=GETLEN-LL;           /* ESATABLISH NEW BUF SIZE       */ 00954000
         LCR   @06,@06                                             0310 00955000
         ALR   @06,GETLEN                                          0310 00956000
         LR    BUFLEN,@06                                          0310 00957000
*       GOTO CHECKECB;              /* BRANCH TO TGET PROCESS        */ 00958000
         B     CHECKECB                                            0311 00959000
*EREXIT:                                                           0312 00960000
*       DO;                         /* FREEMAIN (E) LV(GETLEN)     0312 00961000
*                                      A(OBTAINAD) SP(1)             */ 00962000
EREXIT   DS    0H                                                  0313 00963000
*         RESPECIFY                                                0313 00964000
*          (GPR01P) RESTRICTED;                                    0313 00965000
*         I005=I005&&I005;          /* INIT LIST                     */ 00966000
         XC    I005(10),I005                                       0314 00967000
*         I00505='00'X;             /* SET TYPE                      */ 00968000
         MVI   I00505,X'00'                                        0315 00969000
*         I00502=GETLEN;            /* LENGTH                        */ 00970000
         STCM  GETLEN,7,I00502                                     0316 00971000
*         I00504=ADDR(OBTAINAD);    /* ADDR OF ADDR LIST             */ 00972000
         LA    @10,OBTAINAD                                        0317 00973000
         STCM  @10,7,I00504                                        0317 00974000
*         I00506=1;                 /* SUBPOOL VALUE                 */ 00975000
         MVI   I00506,X'01'                                        0318 00976000
*         GPR01P=ADDR(I005);        /* REG1 POINTS TO LIST           */ 00977000
         LA    GPR01P,I005                                         0319 00978000
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */ 00979000
         SVC   5                                                   0320 00980000
*         RESPECIFY                                                0321 00981000
*          (GPR01P) UNRESTRICTED;                                  0321 00982000
*       END;                        /* FREEMAIN (E) LV(GETLEN)     0322 00983000
*                                      A(OBTAINAD) SP(1)             */ 00984000
*       GOTO EXIT;                                                 0323 00985000
         B     EXIT                                                0323 00986000
*     END;                          /* END TERMIN LOGIC              */ 00987000
*                                                                  0325 00988000
*   /*****************************************************************/ 00989000
*   /*                                                               */ 00990000
*   /* BEGINNING OF INSTORAGE LIST PROCESSING (STACK)                */ 00991000
*   /*                                                               */ 00992000
*   /*****************************************************************/ 00993000
*                                                                  0325 00994000
*CLIST:                                                            0325 00995000
*   IF ECBCBIT=YES THEN             /* IF ATTN ECB POSTED            */ 00996000
@RF00049 DS    0H                                                  0325 00997000
CLIST    L     @06,@PC00001+8                                      0325 00998000
         TM    ECBCBIT(@06),B'01000000'                            0325 00999000
         BNO   @RF00325                                            0325 01000000
*     DO;                           /* RETURN CODE 8                 */ 01001000
*       RETURNCD=8;                 /* RETURN CODE OF EIGHT          */ 01002000
         LA    RETURNCD,8                                          0327 01003000
*       GO TO EXIT;                 /* RETURN                        */ 01004000
         B     EXIT                                                0328 01005000
*     END;                                                         0329 01006000
*   RFY                                                            0330 01007000
*     R15 RSTD;                                                    0330 01008000
@RF00325 DS    0H                                                  0331 01009000
*   PARM433=''B;                    /* CLEAR 433 PARMS               */ 01010000
         XC    PARM433(8),PARM433                                  0331 01011000
*   IF ATTNBIT=YES THEN             /* WHEN GETLINE HAS BEEN @ZA08099*/ 01012000
         TM    ATTNBIT,B'10000000'                                 0332 01013000
         BNO   @RF00332                                            0332 01014000
*     SUSPENDI=SSELMPTR;            /* REENTERED FOR CLIST   @ZA08099   01015000
*                                      ATTN PROCESSING THEN  @ZA08099   01016000
*                                      RELOAD ANY SUSPENDED  @ZA08099   01017000
*                                      ELEMENT ADDR          @ZA08099*/ 01018000
         STCM  SSELMPTR,15,SUSPENDI                                0333 01019000
*   IF ECTATTN=YES THEN             /* INITIAL ENTRY FOR ATT @ZA08099*/ 01020000
@RF00332 L     @14,@PC00001+4                                      0334 01021000
         TM    ECTATTN(@14),B'00000001'                            0334 01022000
         BNO   @RF00334                                            0334 01023000
*     DO;                           /* PROCESSING THEN FIND  @ZA08099*/ 01024000
*       SUSPENDI=IOSTELM;           /* ELEMENT WITH ATTN-IN-CNTL   0336 01025000
*                                                            @ZA08099*/ 01026000
         L     @14,ECTIOWA(,@14)                                   0336 01027000
         L     @14,IOSTELM(,@14)                                   0336 01028000
         STCM  @14,15,SUSPENDI                                     0336 01029000
*       SSELMPTR=IOSTELM;           /* SAVE ADDRESS OF TOP IF WE   0337 01030000
*                                                            @ZA08099*/ 01031000
         LR    SSELMPTR,@14                                        0337 01032000
*       ATTNBIT=YES;                /* MUST RETORE INSTACK AND     0338 01033000
*                                      INDICATE TO GETLINE         0338 01034000
*                                      ATTENTION-IN-CNTL     @ZA08099*/ 01035000
         OI    ATTNBIT,B'10000000'                                 0338 01036000
*       LOOPA=YES;                  /* LOOP CONTROL          @ZA08099*/ 01037000
         OI    LOOPA,B'10000000'                                   0339 01038000
*       DO WHILE LOOPA=YES;         /* FIND A CLIST ELEMENT WITH   0340 01039000
*                                                            @ZA08099*/ 01040000
         B     @DE00340                                            0340 01041000
@DL00340 DS    0H                                                  0341 01042000
*         IF INSEXEC=YES&           /* ATTENTION-IN-CNTL     @ZA08099*/ 01043000
*             ATTNCMD=YES THEN      /*                       @ZA08099*/ 01044000
         L     @14,@PC00001+4                                      0341 01045000
         L     @14,ECTIOWA(,@14)                                   0341 01046000
         L     @14,IOSTELM(,@14)                                   0341 01047000
         TM    INSEXEC(@14),B'00001000'                            0341 01048000
         BNO   @RF00341                                            0341 01049000
         L     @14,LSDEXEC(,LSDPTR)                                0341 01050000
         TM    ATTNCMD(@14),B'00000001'                            0341 01051000
         BNO   @RF00341                                            0341 01052000
*           LOOPA=NO;               /* WE HAVE FOUND IT      @ZA08099*/ 01053000
         NI    LOOPA,B'01111111'                                   0342 01054000
*         ELSE                      /* CHECK NEXT ELEMENT    @ZA08099*/ 01055000
*           DO;                     /*                       @ZA08099*/ 01056000
         B     @RC00341                                            0343 01057000
@RF00341 DS    0H                                                  0344 01058000
*             IOSTELM=IOSTELM-F4;   /*                       @ZA08099*/ 01059000
         L     @14,@PC00001+4                                      0344 01060000
         L     @14,ECTIOWA(,@14)                                   0344 01061000
         L     @06,IOSTELM(,@14)                                   0344 01062000
         SL    @06,@CF00055                                        0344 01063000
         ST    @06,IOSTELM(,@14)                                   0344 01064000
*             LSDPTR=INSADLSD;      /* UPDATE LSD BASE ADDR  @ZA08099*/ 01065000
         L     LSDPTR,INSADLSD-1(,@06)                             0345 01066000
         LA    LSDPTR,0(,LSDPTR)                                   0345 01067000
*           END;                    /*                       @ZA08099*/ 01068000
*       END;                        /*                       @ZA08099*/ 01069000
@RC00341 DS    0H                                                  0347 01070000
@DE00340 TM    LOOPA,B'10000000'                                   0347 01071000
         BO    @DL00340                                            0347 01072000
*     END;                                                         0348 01073000
*   GEN REFS(DEFERYES)(STAX MF=(E,DEFERYES));                      0349 01074000
@RF00334 DS    0H                                                  0349 01075000
         STAX MF=(E,DEFERYES)                                           01076000
*   IF R15=0 THEN                   /* IF ATTNS DEFERED              */ 01077000
         LTR   R15,R15                                             0350 01078000
         BNZ   @RF00350                                            0350 01079000
*     PARMDEFR=YES;                 /* SAY OK TO CHANGE              */ 01080000
         OI    PARMDEFR,B'10000000'                                0351 01081000
*   RFY                                                            0352 01082000
*     R15 UNRSTD;                                                  0352 01083000
@RF00350 DS    0H                                                  0353 01084000
*   IF INSEXEC=YES THEN             /* IF THIS IS AN EXEC CLIST      */ 01085000
         L     @06,@PC00001+4                                      0353 01086000
         L     @06,ECTIOWA(,@06)                                   0353 01087000
         L     @06,IOSTELM(,@06)                                   0353 01088000
         TM    INSEXEC(@06),B'00001000'                            0353 01089000
         BNO   @RF00353                                            0353 01090000
*     DO;                           /* CHECK FOR END OF BLOCK        */ 01091000
*       ECDACBLK=LSDADATA;          /* POINT TO FIRST BLOCK          */ 01092000
         L     @06,LSDADATA(,LSDPTR)                               0355 01093000
         ST    @06,ECDACBLK                                        0355 01094000
*       DO WHILE ECDACBK2^=0;       /* DO UNTIL MATCH OR DONE        */ 01095000
         B     @DE00356                                            0356 01096000
@DL00356 DS    0H                                                  0357 01097000
*         IF CURID=COMPRID&         /* IF THIS IS THE BLOCK          */ 01098000
*             CURADDR>=ECDACBK2+COMPRLNG THEN/* IF END OF BLK        */ 01099000
         L     @06,ECDACBLK                                        0357 01100000
         CLC   CURID(1,LSDPTR),COMPRID(@06)                        0357 01101000
         BNE   @RF00357                                            0357 01102000
         L     @15,ECDACBK2-1                                      0357 01103000
         LA    @15,0(,@15)                                         0357 01104000
         AL    @15,COMPRLNG(,@06)                                  0357 01105000
         L     @14,CURADDR-1(,LSDPTR)                              0357 01106000
         LA    @14,0(,@14)                                         0357 01107000
         CR    @15,@14                                             0357 01108000
         BH    @RF00357                                            0357 01109000
*           IF COMPRNXT=0 THEN      /* AND NO MORE BLOCKS, END LIST  */ 01110000
         L     @06,COMPRNXT-1(,@06)                                0358 01111000
         LA    @06,0(,@06)                                         0358 01112000
         LTR   @06,@06                                             0358 01113000
         BNZ   @RF00358                                            0358 01114000
*             DO;                                                  0359 01115000
*               CMAIN=NO;           /* RESET MAIN OPTION FOR STACK   */ 01116000
         L     @10,LSDEXEC(,LSDPTR)                                0360 01117000
         NI    CMAIN(@10),B'11111011'                              0360 01118000
*DELETE:                                                           0361 01119000
*               CALL IKJEFT30(UPT,ECT,ECB,STACKL);                 0361 01120000
DELETE   L     @10,@PC00001                                        0361 01121000
         ST    @10,@AL00001                                        0361 01122000
         L     @10,@PC00001+4                                      0361 01123000
         ST    @10,@AL00001+4                                      0361 01124000
         L     @10,@PC00001+8                                      0361 01125000
         ST    @10,@AL00001+8                                      0361 01126000
         LA    @10,STACKL                                          0361 01127000
         ST    @10,@AL00001+12                                     0361 01128000
         L     @15,@CV00346                                        0361 01129000
         LA    @01,@AL00001                                        0361 01130000
         BALR  @14,@15                                             0361 01131000
*RESTRT:                                                           0362 01132000
*               IF PARMDEFR=YES THEN/* IF OK TO CHANGE               */ 01133000
RESTRT   TM    PARMDEFR,B'10000000'                                0362 01134000
         BNO   @RF00362                                            0362 01135000
*                 GEN REFS(DEFERNO)(STAX MF=(E,DEFERNO));          0363 01136000
         STAX MF=(E,DEFERNO)                                            01137000
*               PARMDEFR=NO;        /* TURN OFF BIT                  */ 01138000
@RF00362 NI    PARMDEFR,B'01111111'                                0364 01139000
*               IF CONTEXP=YES THEN /* CONTINUATION EXPECTED?@ZA15801*/ 01140000
         TM    CONTEXP,B'10000000'                                 0365 01141000
         BNO   @RF00365                                            0365 01142000
*                 RETURNCD=36;      /* CONTINUATION NOT RECEIVED   0366 01143000
*                                      BEFORE EOD            @ZA15801*/ 01144000
         LA    RETURNCD,36                                         0366 01145000
*               ELSE                /* CONTINUATION NOT EXPECTED   0367 01146000
*                                                            @ZA15801*/ 01147000
*                 RETURNCD=16;      /* SET NORMAL END OF DATA@ZA15801*/ 01148000
         B     @RC00365                                            0367 01149000
@RF00365 LA    RETURNCD,16                                         0367 01150000
*               GOTO EXIT;                                         0368 01151000
         B     EXIT                                                0368 01152000
*             END;                                                 0369 01153000
*           ELSE                                                   0370 01154000
*             DO;                                                  0370 01155000
@RF00358 DS    0H                                                  0371 01156000
*               CURADDR=COMPRNXT+LENGTH(COMPROC);                  0371 01157000
         L     @06,ECDACBLK                                        0371 01158000
         LA    @15,12                                              0371 01159000
         L     @14,COMPRNXT-1(,@06)                                0371 01160000
         LA    @14,0(,@14)                                         0371 01161000
         ALR   @15,@14                                             0371 01162000
         STCM  @15,7,CURADDR(LSDPTR)                               0371 01163000
*               CURID=COMPRID+1;                                   0372 01164000
         LA    @15,1                                               0372 01165000
         SLR   @14,@14                                             0372 01166000
         IC    @14,COMPRID(,@06)                                   0372 01167000
         ALR   @15,@14                                             0372 01168000
         STC   @15,CURID(,LSDPTR)                                  0372 01169000
*               ECDACBLK=0;         /* EXIT LOOP                     */ 01170000
         SLR   @06,@06                                             0373 01171000
         ST    @06,ECDACBLK                                        0373 01172000
*             END;                                                 0374 01173000
*         ELSE                                                     0375 01174000
*           ECDACBLK=COMPRPTR;      /* POINT TO NEXT BLOCK           */ 01175000
         B     @RC00357                                            0375 01176000
@RF00357 L     @06,ECDACBLK                                        0375 01177000
         L     @06,COMPRPTR(,@06)                                  0375 01178000
         ST    @06,ECDACBLK                                        0375 01179000
*       END;                                                       0376 01180000
@RC00357 DS    0H                                                  0376 01181000
@DE00356 L     @06,ECDACBK2-1                                      0376 01182000
         LA    @06,0(,@06)                                         0376 01183000
         LTR   @06,@06                                             0376 01184000
         BNZ   @DL00356                                            0376 01185000
*       PARMADIN=LSDANEXT;                                         0377 01186000
         L     @06,@PC00001+12                                     0377 01187000
         L     @15,LSDANEXT(,LSDPTR)                               0377 01188000
         ST    @15,PARMADIN(,@06)                                  0377 01189000
*       IF LSDRCLEN^=0 THEN         /* IF NOT VARIABLE RECS          */ 01190000
         LH    @14,LSDRCLEN(,LSDPTR)                               0378 01191000
         LTR   @14,@14                                             0378 01192000
         BNZ   @RT00378                                            0378 01193000
*         GO TO INVALID;            /* INVALID FOR EXEC CLIST        */ 01194000
*       LSDANEXT=LSDANEXT+VRECLL;                                  0380 01195000
         ICM   @03,12,VRECLL(@15)                                  0380 01196000
         SRA   @03,16                                              0380 01197000
         ALR   @03,@15                                             0380 01198000
         ST    @03,LSDANEXT(,LSDPTR)                               0380 01199000
*       RFY                                                        0381 01200000
*        (R15) RSTD;                                               0381 01201000
*       CALL IKJCT433(UPT,ECT,ECB,GTPB,PARM433);                   0382 01202000
         L     @14,@PC00001                                        0382 01203000
         ST    @14,@AL00001                                        0382 01204000
         L     @14,@PC00001+4                                      0382 01205000
         ST    @14,@AL00001+4                                      0382 01206000
         L     @14,@PC00001+8                                      0382 01207000
         ST    @14,@AL00001+8                                      0382 01208000
         ST    @06,@AL00001+12                                     0382 01209000
         LA    @14,PARM433                                         0382 01210000
         ST    @14,@AL00001+16                                     0382 01211000
         L     @15,@CV00359                                        0382 01212000
         LA    @01,@AL00001                                        0382 01213000
         BALR  @14,@15                                             0382 01214000
*       RETURNCD=R15;               /* SAVE RETURN CODE              */ 01215000
         LR    RETURNCD,R15                                        0383 01216000
*       IF PARMDEFR=YES THEN        /* IF OK WAS SET                 */ 01217000
         TM    PARMDEFR,B'10000000'                                0384 01218000
         BNO   @RF00384                                            0384 01219000
*         GEN REFS(DEFERNO)(STAX MF=(E,DEFERNO));                  0385 01220000
         STAX MF=(E,DEFERNO)                                            01221000
*       PARMDEFR=NO;                /* TURN OFF SWITCH               */ 01222000
@RF00384 NI    PARMDEFR,B'01111111'                                0386 01223000
*       IF RETURNCD=4 THEN          /* IF GETTING NEXT RECORD        */ 01224000
         C     RETURNCD,@CF00055                                   0387 01225000
         BNE   @RF00387                                            0387 01226000
*         DO;                                                      0388 01227000
*           IF ATTNBIT=YES&         /* IF END OF ATTENTION PROCESSING   01228000
*                                                            @ZA08099*/ 01229000
*               EXITSTMT=YES|       /*                       @ZA08099*/ 01230000
*               ATTNBIT=YES&INSTERM=NO THEN/*                @ZA08099*/ 01231000
         TM    ATTNBIT,B'10000000'                                 0389 01232000
         BNO   @GL00021                                            0389 01233000
         TM    EXITSTMT,B'00100000'                                0389 01234000
         BO    @RT00389                                            0389 01235000
@GL00021 TM    ATTNBIT,B'10000000'                                 0389 01236000
         BNO   @RF00389                                            0389 01237000
         L     @14,@PC00001+4                                      0389 01238000
         L     @14,ECTIOWA(,@14)                                   0389 01239000
         L     @14,IOSTELM(,@14)                                   0389 01240000
         TM    INSTERM(@14),B'10000000'                            0389 01241000
         BNZ   @RF00389                                            0389 01242000
@RT00389 DS    0H                                                  0390 01243000
*             DO;                   /* THEN RESTORE ANY SUSPENDED  0390 01244000
*                                                            @ZA08099*/ 01245000
*               ATTNBIT=NO;         /* ELEMENTS              @ZA08099*/ 01246000
         NI    ATTNBIT,B'01111111'                                 0391 01247000
*               IF EOCLIST=YES THEN /* ON END OF CLIST WE MUST     0392 01248000
*                                                            @ZA08099*/ 01249000
         TM    EOCLIST,B'01000000'                                 0392 01250000
         BNO   @RF00392                                            0392 01251000
*                 DO;               /* DELETE ALL SUSPENDED ELMTS  0393 01252000
*                                                            @ZA08099*/ 01253000
*                   EOCLIST=NO;     /* BEFORE RESUMING NORMAL      0394 01254000
*                                                            @ZA08099*/ 01255000
         NI    EOCLIST,B'10111111'                                 0394 01256000
*                   DLBASE=IOSTELM; /* CURRENT ELMT ADDR FOR LOOP  0395 01257000
*                                                            @ZA08099*/ 01258000
         L     @14,@PC00001+4                                      0395 01259000
         L     @14,ECTIOWA(,@14)                                   0395 01260000
         L     DLBASE,IOSTELM(,@14)                                0395 01261000
*                   IOSTELM=SUSPENDI;/* CONTROL AND INIT FIRST     0396 01262000
*                                                            @ZA08099*/ 01263000
         MVC   IOSTELM(4,@14),SUSPENDI                             0396 01264000
*                   DO WHILE DLBASE^=IOSTELM;/* ELMT TO DELETE     0397 01265000
*                                                            @ZA08099*/ 01266000
         B     @DE00397                                            0397 01267000
@DL00397 DS    0H                                                  0398 01268000
*                     RFY                                          0398 01269000
*                       LSD BASED(INSADLSD);/*               @ZA08099*/ 01270000
*                     IF INSEXEC=YES THEN/* IGNORE ANY MAIN  @ZA08099*/ 01271000
         L     @14,@PC00001+4                                      0399 01272000
         L     @14,ECTIOWA(,@14)                                   0399 01273000
         L     @14,IOSTELM(,@14)                                   0399 01274000
         TM    INSEXEC(@14),B'00001000'                            0399 01275000
         BNO   @RF00399                                            0399 01276000
*                       CMAIN=NO;   /* CLISTS                @ZA08099*/ 01277000
*                                                                  0400 01278000
         L     @14,INSADLSD-1(,@14)                                0400 01279000
         L     @14,LSDEXEC(,@14)                                   0400 01280000
         NI    CMAIN(@14),B'11111011'                              0400 01281000
*                     /***********************************************/ 01282000
*                     /*                                             */ 01283000
*                     /* STACK SERRTN ADJUSTS IOSTELM                */ 01284000
*                     /*                                             */ 01285000
*                     /***********************************************/ 01286000
*                                                                  0401 01287000
*                     CALL IKJEFT30(UPT,ECT,ECB,STACKL);/*   @ZA08099*/ 01288000
@RF00399 L     @14,@PC00001                                        0401 01289000
         ST    @14,@AL00001                                        0401 01290000
         L     @14,@PC00001+4                                      0401 01291000
         ST    @14,@AL00001+4                                      0401 01292000
         L     @14,@PC00001+8                                      0401 01293000
         ST    @14,@AL00001+8                                      0401 01294000
         LA    @14,STACKL                                          0401 01295000
         ST    @14,@AL00001+12                                     0401 01296000
         L     @15,@CV00346                                        0401 01297000
         LA    @01,@AL00001                                        0401 01298000
         BALR  @14,@15                                             0401 01299000
*                     RFY                                          0402 01300000
*                       LSD BASED(LSDPTR);/*                 @ZA08099*/ 01301000
*                   END;            /*                       @ZA08099*/ 01302000
@DE00397 L     @14,@PC00001+4                                      0403 01303000
         L     @14,ECTIOWA(,@14)                                   0403 01304000
         C     DLBASE,IOSTELM(,@14)                                0403 01305000
         BNE   @DL00397                                            0403 01306000
*                 END;              /*                       @ZA08099*/ 01307000
*             END;                  /*                       @ZA08099*/ 01308000
@RF00392 DS    0H                                                  0406 01309000
*           IF GETLINE=YES|         /* IF GETLINE ENTRY              */ 01310000
*               ATTNBIT=YES&EOCLIST=NO THEN/*                @ZA08099*/ 01311000
@RF00389 TM    GETLINE,B'10000000'                                 0406 01312000
         BO    @RT00406                                            0406 01313000
         TM    ATTNBIT,B'10000000'                                 0406 01314000
         BNO   @RF00406                                            0406 01315000
         TM    EOCLIST,B'01000000'                                 0406 01316000
         BZ    @RT00406                                            0406 01317000
*             GOTO RESTRT2;         /* RESTART GETLINE               */ 01318000
*           ELSE                    /* OTHERWISE                     */ 01319000
*             GOTO RESTRT;          /* GO BACK TO PUTGET             */ 01320000
         B     RESTRT                                              0408 01321000
*         END;                                                     0409 01322000
*       IF RETURNCD=8 THEN          /* IF ATTN RETURN CODE           */ 01323000
@RF00387 C     RETURNCD,@CF00050                                   0410 01324000
         BE    @RT00410                                            0410 01325000
*         GOTO EXIT;                /* RETURN WITH ATTN RC           */ 01326000
*       IF RETURNCD^=0 THEN         /* IF RETURN CODE NOT ZERO       */ 01327000
         LTR   RETURNCD,RETURNCD                                   0412 01328000
         BNZ   @RT00412                                            0412 01329000
*         GOTO INVALID;             /*                               */ 01330000
*       ELSE                        /* RESTORE ANY SUSPENDED ELMTS   */ 01331000
*         IF ATTNBIT=YES THEN       /*                       @ZA08099*/ 01332000
         TM    ATTNBIT,B'10000000'                                 0414 01333000
         BNO   @RF00414                                            0414 01334000
*           DO;                     /*                       @ZA08099*/ 01335000
*             ATTNBIT=NO;           /*                       @ZA08099*/ 01336000
         NI    ATTNBIT,B'01111111'                                 0416 01337000
*             IF ATINCNTL=YES THEN  /* IF THE USER IS STILL IN     0417 01338000
*                                                            @ZA08099*/ 01339000
         L     @14,LSDEXEC(,LSDPTR)                                0417 01340000
         TM    ATINCNTL(@14),B'10000000'                           0417 01341000
         BNO   @RF00417                                            0417 01342000
*               DO;                 /* ATTENTION EXIT THEN FORCE   0418 01343000
*                                                            @ZA08099*/ 01344000
*                 ATINCNTL=NO;      /* END OF CLIST ATTENTION ACTION    01345000
*                                                            @ZA08099*/ 01346000
         NI    ATINCNTL(@14),B'01111111'                           0419 01347000
*                 LSDANEXT=RETPTR;  /* USER IS ALLOWED ONLY 1 TSO  0420 01348000
*                                      STMT                  @ZA08099*/ 01349000
         L     @14,RETPTR(,@14)                                    0420 01350000
         ST    @14,LSDANEXT(,LSDPTR)                               0420 01351000
*               END;                /*                       @ZA08099*/ 01352000
*             BUFPTR=PARMADIN+F4;   /* IF TSO STMT IS NULL LINE    0422 01353000
*                                                            @ZA08099*/ 01354000
@RF00417 L     @14,@PC00001+12                                     0422 01355000
         L     @14,PARMADIN(,@14)                                  0422 01356000
         LA    BUFPTR,4                                            0422 01357000
         ALR   BUFPTR,@14                                          0422 01358000
*             ENDLOC=BUFPTR+PARMADIN->LL-F5;/* THEN RESTORE ALL    0423 01359000
*                                                            @ZA08099*/ 01360000
         LR    ENDLOC,BUFPTR                                       0423 01361000
         AH    ENDLOC,LL(,@14)                                     0423 01362000
         SL    ENDLOC,@CF00259                                     0423 01363000
*             CALL SCAN;            /* SUSPENDED ELMTS OTHERWISE   0424 01364000
*                                                            @ZA08099*/ 01365000
         BAL   @14,SCAN                                            0424 01366000
*             IF BUFPTR<=ENDLOC THEN/* DELETE ALL SUSPENDED  @ZA08099*/ 01367000
         CR    BUFPTR,ENDLOC                                       0425 01368000
         BH    @RF00425                                            0425 01369000
*               DO;                 /* ELEMENTS              @ZA08099*/ 01370000
*                 DLBASE=IOSTELM;   /* CURRENT ELMT ADDRESS  @ZA08099*/ 01371000
         L     @14,@PC00001+4                                      0427 01372000
         L     @14,ECTIOWA(,@14)                                   0427 01373000
         L     DLBASE,IOSTELM(,@14)                                0427 01374000
*                 IOSTELM=SUSPENDI; /* FIRST ELMT TO DELETE  @ZA08099*/ 01375000
         MVC   IOSTELM(4,@14),SUSPENDI                             0428 01376000
*                 DO WHILE IOSTELM^=DLBASE;/* DELETE THE ELMTS     0429 01377000
*                                                            @ZA08099*/ 01378000
         B     @DE00429                                            0429 01379000
@DL00429 DS    0H                                                  0430 01380000
*                   RFY                                            0430 01381000
*                     LSD BASED(INSADLSD);/*                 @ZA08099*/ 01382000
*                   IF INSEXEC=YES THEN/* IGNORE MAIN CLISTS @ZA08099*/ 01383000
         L     @14,@PC00001+4                                      0431 01384000
         L     @14,ECTIOWA(,@14)                                   0431 01385000
         L     @14,IOSTELM(,@14)                                   0431 01386000
         TM    INSEXEC(@14),B'00001000'                            0431 01387000
         BNO   @RF00431                                            0431 01388000
*                     CMAIN=NO;     /*                       @ZA08099*/ 01389000
         L     @14,INSADLSD-1(,@14)                                0432 01390000
         L     @14,LSDEXEC(,@14)                                   0432 01391000
         NI    CMAIN(@14),B'11111011'                              0432 01392000
*                   CALL IKJEFT30(UPT,ECT,ECB,STACKL);             0433 01393000
*                                                                  0433 01394000
@RF00431 L     @14,@PC00001                                        0433 01395000
         ST    @14,@AL00001                                        0433 01396000
         L     @14,@PC00001+4                                      0433 01397000
         ST    @14,@AL00001+4                                      0433 01398000
         L     @14,@PC00001+8                                      0433 01399000
         ST    @14,@AL00001+8                                      0433 01400000
         LA    @14,STACKL                                          0433 01401000
         ST    @14,@AL00001+12                                     0433 01402000
         L     @15,@CV00346                                        0433 01403000
         LA    @01,@AL00001                                        0433 01404000
         BALR  @14,@15                                             0433 01405000
*                   /*************************************************/ 01406000
*                   /*                                               */ 01407000
*                   /* STACK SERRTN ADJUSTS IOSTELM@ZA08099          */ 01408000
*                   /*                                               */ 01409000
*                   /*************************************************/ 01410000
*                                                                  0434 01411000
*                   RFY                                            0434 01412000
*                     LSD BASED(LSDPTR);/*                   @ZA08099*/ 01413000
*                 END;              /*                       @ZA08099*/ 01414000
@DE00429 L     @14,@PC00001+4                                      0435 01415000
         L     @14,ECTIOWA(,@14)                                   0435 01416000
         C     DLBASE,IOSTELM(,@14)                                0435 01417000
         BNE   @DL00429                                            0435 01418000
*               END;                /*                       @ZA08099*/ 01419000
*             ELSE                  /*                       @ZA08099*/ 01420000
*               IOSTELM=SUSPENDI;   /*                       @ZA08099*/ 01421000
         B     @RC00425                                            0437 01422000
@RF00425 L     @14,@PC00001+4                                      0437 01423000
         L     @14,ECTIOWA(,@14)                                   0437 01424000
         MVC   IOSTELM(4,@14),SUSPENDI                             0437 01425000
*           END;                    /*                       @ZA08099*/ 01426000
@RC00425 DS    0H                                                  0439 01427000
*       RFY                                                        0439 01428000
*        (R15) UNRSTD;                                             0439 01429000
@RF00414 DS    0H                                                  0440 01430000
*     END;                                                         0440 01431000
*                                                                  0441 01432000
*   /*****************************************************************/ 01433000
*   /*                                                               */ 01434000
*   /* NORMAL INSTORAGE LIST PROCESSING                              */ 01435000
*   /*                                                               */ 01436000
*   /*****************************************************************/ 01437000
*                                                                  0441 01438000
*   ELSE                                                           0441 01439000
*     DO;                                                          0441 01440000
         B     @RC00353                                            0441 01441000
@RF00353 DS    0H                                                  0442 01442000
*       IF LSDANEXT>=LSDADATA+LSDTOTLN THEN                        0442 01443000
         L     @10,LSDANEXT(,LSDPTR)                               0442 01444000
         LH    @06,LSDTOTLN(,LSDPTR)                               0442 01445000
         AL    @06,LSDADATA(,LSDPTR)                               0442 01446000
         CR    @10,@06                                             0442 01447000
         BNL   @RT00442                                            0442 01448000
*         GO TO DELETE;                                            0443 01449000
*       IF LSDRCLEN=0 THEN                                         0444 01450000
         LH    @06,LSDRCLEN(,LSDPTR)                               0444 01451000
         LTR   @06,@06                                             0444 01452000
         BNZ   @RF00444                                            0444 01453000
*         GETLEN=VRECLL;                                           0445 01454000
         ICM   GETLEN,12,VRECLL(@10)                               0445 01455000
         SRA   GETLEN,16                                           0445 01456000
*       ELSE                                                       0446 01457000
*         GETLEN=LSDRCLEN+4;                                       0446 01458000
         B     @RC00444                                            0446 01459000
@RF00444 LA    GETLEN,4                                            0446 01460000
         AH    GETLEN,LSDRCLEN(,LSDPTR)                            0446 01461000
*       RFY                                                        0447 01462000
*        (R15) RSTD;                                               0447 01463000
@RC00444 DS    0H                                                  0448 01464000
*       DO;                         /* GETMAIN (EC) LV(GETLEN)     0448 01465000
*                                      A(OBTAINAD) SP(1)             */ 01466000
*         RESPECIFY                                                0449 01467000
*          (GPR01P) RESTRICTED;                                    0449 01468000
*         I004=I004&&I004;          /* INIT LIST                     */ 01469000
         XC    I004(10),I004                                       0450 01470000
*         I00404='20'X;             /* TYPE                          */ 01471000
         MVI   I00404,X'20'                                        0451 01472000
*         I00401=GETLEN;            /* LENGTH                        */ 01473000
         ST    GETLEN,I00401                                       0452 01474000
*         I00403=ADDR(OBTAINAD);    /* ADDR OF ADDR LIST             */ 01475000
         LA    @14,OBTAINAD                                        0453 01476000
         STCM  @14,7,I00403                                        0453 01477000
*         I00405=1;                 /* SUBPOOL VALUE                 */ 01478000
         MVI   I00405,X'01'                                        0454 01479000
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */ 01480000
         LA    GPR01P,I004                                         0455 01481000
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */ 01482000
         SVC   4                                                   0456 01483000
*         RESPECIFY                                                0457 01484000
*          (GPR01P) UNRESTRICTED;                                  0457 01485000
*       END;                        /* GETMAIN (EC) LV(GETLEN)     0458 01486000
*                                      A(OBTAINAD) SP(1)             */ 01487000
*       IF R15^=0 THEN              /* GETMAIN ERROR                 */ 01488000
         SLR   @14,@14                                             0459 01489000
         CR    R15,@14                                             0459 01490000
         BNE   @RT00459                                            0459 01491000
*         GOTO GETMNER;                                            0460 01492000
*       RFY                                                        0461 01493000
*        (R15) UNRSTD;                                             0461 01494000
*       RFY                                                        0462 01495000
*        (R2,                                                      0462 01496000
*         R3,                                                      0462 01497000
*         R4,                                                      0462 01498000
*         R5) RSTD;                                                0462 01499000
*       R2=OBTAINAD;                /* POINTER TO NEW RECORD         */ 01500000
         L     @10,OBTAINAD                                        0463 01501000
         LR    R2,@10                                              0463 01502000
*       R3=GETLEN;                  /* LENGTH FOR TOTAL MOVE         */ 01503000
         LR    R3,GETLEN                                           0464 01504000
*       R4=LSDANEXT;                /* POINTER TO FROM RECORD        */ 01505000
         L     R4,LSDANEXT(,LSDPTR)                                0465 01506000
*       IF LSDRCLEN^=0 THEN         /* IF FIXED LENGTH RECORD        */ 01507000
         CH    @14,LSDRCLEN(,LSDPTR)                               0466 01508000
         BE    @RF00466                                            0466 01509000
*         DO;                                                      0467 01510000
*           LL=GETLEN;              /* LL FOR FIXED RECORD           */ 01511000
         STH   GETLEN,LL(,@10)                                     0468 01512000
*           R2=R2+4;                /* ADJUST FOR NO HEADER          */ 01513000
         LA    @09,4                                               0469 01514000
         ALR   R2,@09                                              0469 01515000
*           R3=R3-4;                /*                               */ 01516000
         SLR   R3,@09                                              0470 01517000
*           GETLEN=GETLEN-4;                                       0471 01518000
         SLR   GETLEN,@09                                          0471 01519000
*           OO=0;                   /* OFFSET FIELD ZERO             */ 01520000
         STH   @14,OO(,@10)                                        0472 01521000
*         END;                                                     0473 01522000
*       R3=GETLEN;                  /* LENGTH FOR MOVE               */ 01523000
@RF00466 LR    R3,GETLEN                                           0474 01524000
*       R5=R3;                      /*                               */ 01525000
         LR    R5,R3                                               0475 01526000
*       MVCL(R2,R4);                                               0476 01527000
         MVCL  R2,R4                                               0476 01528000
*       RFY                                                        0477 01529000
*        (R2,                                                      0477 01530000
*         R3,                                                      0477 01531000
*         R4,                                                      0477 01532000
*         R5) UNRSTD;                                              0477 01533000
*       PARMADIN=OBTAINAD;          /* PUT PTR TO BUFF IN PARM       */ 01534000
         L     @10,@PC00001+12                                     0478 01535000
         L     @09,OBTAINAD                                        0478 01536000
         ST    @09,PARMADIN(,@10)                                  0478 01537000
*       LSDANEXT=LSDANEXT+GETLEN;   /* UPDATE LSD POINTER            */ 01538000
         LR    @10,GETLEN                                          0479 01539000
         AL    @10,LSDANEXT(,LSDPTR)                               0479 01540000
         ST    @10,LSDANEXT(,LSDPTR)                               0479 01541000
*     END;                                                         0480 01542000
*   IF PARMDEFR=YES THEN            /* IF DEFER SET                  */ 01543000
@RC00353 TM    PARMDEFR,B'10000000'                                0481 01544000
         BNO   @RF00481                                            0481 01545000
*     GEN REFS(DEFERNO)(STAX MF=(E,DEFERNO));                      0482 01546000
         STAX MF=(E,DEFERNO)                                            01547000
*   PARMDEFR=NO;                    /* CLEAR BIT                     */ 01548000
@RF00481 NI    PARMDEFR,B'01111111'                                0483 01549000
*   IF PARMTERM=YES THEN            /* DEMAND FROM TERMINAL          */ 01550000
         L     @10,@PC00001+12                                     0484 01551000
         TM    PARMTERM(@10),B'00010000'                           0484 01552000
         BNO   @RF00484                                            0484 01553000
*     RETURNCD=0;                   /* FORCE ZERO RETURN CODE        */ 01554000
         SLR   RETURNCD,RETURNCD                                   0485 01555000
*   ELSE                            /* OTHERWISE                     */ 01556000
*     RETURNCD=4;                   /* INDICATE RECORD NOT FROM THE     01557000
*                                      TERMINAL                      */ 01558000
         B     @RC00484                                            0486 01559000
@RF00484 LA    RETURNCD,4                                          0486 01560000
*EXIT:                                                             0487 01561000
*   RETURN CODE(RETURNCD);                                         0487 01562000
@RC00484 DS    0H                                                  0487 01563000
EXIT     L     @13,4(,@13)                                         0487 01564000
         L     @00,@SIZDATD                                        0487 01565000
         LR    @01,@11                                             0487 01566000
         FREEMAIN R,LV=(0),A=(1)                                        01567000
         LR    @15,@02                                             0487 01568000
         L     @14,12(,@13)                                        0487 01569000
         LM    @00,@12,20(@13)                                     0487 01570000
         BR    @14                                                 0487 01571000
*                                                                  0488 01572000
*/********************************************************************/ 01573000
*/* SCAN ROUTINE-                                                    */ 01574000
*/*      THE SCAN ROUTINE LOOKS AT THE INPUT BUFFER RETURNED BY      */ 01575000
*/*      THE LAST TGET. IF THE BIGINNING CHARACTER STRING IS AN      */ 01576000
*/*      OPEN COMMENT DELIMETER, THEN A SWITCH IS SET. IF THE        */ 01577000
*/*      COMMENT SWITCH IS SET, THE SEARCH CONTINUES UNTIL A         */ 01578000
*/*      CLOSE COMMENT DELIMETER IS FOUND OR UNTIL THE END OF        */ 01579000
*/*      THE BUFFER. IF AT THE END OF THE BUFFER, A CHECK IS         */ 01580000
*/*      MADE TO SEE IF THE COMMENT WAS CONTINUED. IF NO             */ 01581000
*/*      COMMENT DELIMETER WAS FOUND, THEN BLANKS, COMMAS,           */ 01582000
*/*      AND TABS ARE PASSED OVER. THIS SCAN GOES UNTIL              */ 01583000
*/*      AN OPEN COMMENT OR A CHARACTER IS FOUND OR UNTIL            */ 01584000
*/*      END OF BUFFER. IF ANOTHER COMMENT WAS FOUND, THEN           */ 01585000
*/*      THE LOOP CONTINUES AS SPECIFIED FOR BEGINNING               */ 01586000
*/*      COMMENTS. THE OVERALL RESULTS ARE RETURNED TO               */ 01587000
*/*      THE CALLER IN BUFPTR.                                       */ 01588000
*/*                                                                  */ 01589000
*/*      BUFPTR= ADDR OF START  -> NO COMMENTS - NO MOVE             */ 01590000
*/*      BUFPTR> ENDLOC         -> ALL DELIMETERS - THROW AWAY       */ 01591000
*/*      BUFPTR= ENDLOC         -> CONTINUATION POSSIBLE - MOVE DOWN */ 01592000
*/*      BUFPTR> ADDR OF START  -> DELIMS FOUND - MOVE DOWN          */ 01593000
*/*                                                                  */ 01594000
*/********************************************************************/ 01595000
*                                                                  0488 01596000
*SCAN:                                                             0488 01597000
*   PROC;                                                          0488 01598000
SCAN     STM   @14,@01,12(@13)                                     0488 01599000
         STM   @03,@12,32(@13)                                     0488 01600000
*   EXITA=NO;                       /* TURN OFF EXIT SWITCH          */ 01601000
         NI    EXITA,B'01111111'                                   0489 01602000
*   DO WHILE EXITA=NO;                                             0490 01603000
         B     @DE00490                                            0490 01604000
@DL00490 DS    0H                                                  0491 01605000
*     IF BUFPTR<ENDLOC&CBUF(1:2)='/*'&COMMENTS=NO THEN             0491 01606000
         CR    BUFPTR,ENDLOC                                       0491 01607000
         BNL   @RF00491                                            0491 01608000
         CLC   CBUF(2,BUFPTR),@CC00331                             0491 01609000
         BNE   @RF00491                                            0491 01610000
         TM    COMMENTS,B'10000000'                                0491 01611000
         BNZ   @RF00491                                            0491 01612000
*       DO;                                                        0492 01613000
*         COMMENTS=YES;                                            0493 01614000
         OI    COMMENTS,B'10000000'                                0493 01615000
*         BUFPTR=BUFPTR+2;                                         0494 01616000
         AL    BUFPTR,@CF00087                                     0494 01617000
*       END;                                                       0495 01618000
*     ELSE                                                         0496 01619000
*       IF BUFPTR<ENDLOC&CBUF(1:2)='*/'&COMMENTS=YES THEN          0496 01620000
         B     @RC00491                                            0496 01621000
@RF00491 CR    BUFPTR,ENDLOC                                       0496 01622000
         BNL   @RF00496                                            0496 01623000
         CLC   CBUF(2,BUFPTR),@CC00368                             0496 01624000
         BNE   @RF00496                                            0496 01625000
         TM    COMMENTS,B'10000000'                                0496 01626000
         BNO   @RF00496                                            0496 01627000
*         DO;                                                      0497 01628000
*           COMMENTS=NO;                                           0498 01629000
         NI    COMMENTS,B'01111111'                                0498 01630000
*           BUFPTR=BUFPTR+2;                                       0499 01631000
         AL    BUFPTR,@CF00087                                     0499 01632000
*         END;                                                     0500 01633000
*       ELSE                                                       0501 01634000
*         IF BUFPTR<=ENDLOC&CBUF(1)=' '|CBUF(1)='6B'X|CBUF(1)='05'X|(   01635000
*             COMMENTS=YES&BUFPTR<ENDLOC) THEN                     0501 01636000
         B     @RC00496                                            0501 01637000
@RF00496 CR    BUFPTR,ENDLOC                                       0501 01638000
         BH    @GL00032                                            0501 01639000
         CLI   CBUF(BUFPTR),C' '                                   0501 01640000
         BE    @RT00501                                            0501 01641000
@GL00032 CLI   CBUF(BUFPTR),X'6B'                                  0501 01642000
         BE    @RT00501                                            0501 01643000
         CLI   CBUF(BUFPTR),X'05'                                  0501 01644000
         BE    @RT00501                                            0501 01645000
         TM    COMMENTS,B'10000000'                                0501 01646000
         BNO   @RF00501                                            0501 01647000
         CR    BUFPTR,ENDLOC                                       0501 01648000
         BNL   @RF00501                                            0501 01649000
@RT00501 DS    0H                                                  0502 01650000
*           BUFPTR=BUFPTR+1;                                       0502 01651000
         AL    BUFPTR,@CF00036                                     0502 01652000
*         ELSE                                                     0503 01653000
*           IF BUFPTR=ENDLOC&COMMENTS=YES&CBUF(1)^='+'&CBUF(1)^='-'     01654000
*             THEN                                                 0503 01655000
         B     @RC00501                                            0503 01656000
@RF00501 CR    BUFPTR,ENDLOC                                       0503 01657000
         BNE   @RF00503                                            0503 01658000
         TM    COMMENTS,B'10000000'                                0503 01659000
         BNO   @RF00503                                            0503 01660000
         CLI   CBUF(BUFPTR),C'+'                                   0503 01661000
         BE    @RF00503                                            0503 01662000
         CLI   CBUF(BUFPTR),C'-'                                   0503 01663000
         BE    @RF00503                                            0503 01664000
*             BUFPTR=BUFPTR+1;                                     0504 01665000
         AL    BUFPTR,@CF00036                                     0504 01666000
*           ELSE                                                   0505 01667000
*             EXITA=YES;                                           0505 01668000
         B     @RC00503                                            0505 01669000
@RF00503 OI    EXITA,B'10000000'                                   0505 01670000
*   END;                                                           0506 01671000
@RC00503 DS    0H                                                  0506 01672000
@RC00501 DS    0H                                                  0506 01673000
@RC00496 DS    0H                                                  0506 01674000
@RC00491 DS    0H                                                  0506 01675000
@DE00490 TM    EXITA,B'10000000'                                   0506 01676000
         BZ    @DL00490                                            0506 01677000
*   END SCAN;                                                      0507 01678000
*                                                                  0507 01679000
@EL00002 DS    0H                                                  0507 01680000
@EF00002 DS    0H                                                  0507 01681000
@ER00002 LM    @14,@01,12(@13)                                     0507 01682000
         LM    @03,@12,32(@13)                                     0507 01683000
         BR    @14                                                 0507 01684000
*   /*****************************************************************/ 01685000
*   /*                                                               */ 01686000
*   /* FREETIN IS USED TO FREE TERMIN CONTROL BLOCKS                 */ 01687000
*   /*                                                               */ 01688000
*   /*****************************************************************/ 01689000
*                                                                  0508 01690000
*FREETIN:                                                          0508 01691000
*   PROC OPTIONS(SAVEAREA);                                        0508 01692000
FREETIN  STM   @14,@12,12(@13)                                     0508 01693000
         ST    @13,@SA00003+4                                      0508 01694000
         LA    @14,@SA00003                                        0508 01695000
         ST    @14,8(,@13)                                         0508 01696000
         LR    @13,@14                                             0508 01697000
*   FREEADDR=EXDLMPTR;              /* ADDR OF STORAGE TO BE FREED   */ 01698000
         L     @10,LSDEXEC(,LSDPTR)                                0509 01699000
         L     @08,EXDLMPTR(,@10)                                  0509 01700000
         ST    @08,FREEADDR                                        0509 01701000
*   FREELEN=EXDLMPTR->DELIMLL;      /* LENGTH OF AREA                */ 01702000
         LH    FREELEN,DELIMLL(,@08)                               0510 01703000
*   INSCODE=EXINSAVE;               /* RESTORE PARMS                 */ 01704000
         L     @08,@PC00001+4                                      0511 01705000
         L     @06,ECTIOWA(,@08)                                   0511 01706000
         L     @06,IOSTELM(,@06)                                   0511 01707000
         IC    @15,EXINSAVE(,@10)                                  0511 01708000
         STC   @15,INSCODE(,@06)                                   0511 01709000
*   EXDLMPTR=0;                     /* ZERO DLM PTR                  */ 01710000
         SLR   @06,@06                                             0512 01711000
         ST    @06,EXDLMPTR(,@10)                                  0512 01712000
*   ECTRCDF=''B;                    /* CLEAR ECT TO ZERO             */ 01713000
         MVI   ECTRCDF(@08),X'00'                                  0513 01714000
*   ECTRTCD=0;                      /* SET RETURN CODE TO ZERO       */ 01715000
         STCM  @06,7,ECTRTCD(@08)                                  0514 01716000
*   DO;                             /* FREEMAIN (E) LV(FREELEN)    0515 01717000
*                                      A(FREEADDR) SP(78)            */ 01718000
*     RESPECIFY                                                    0516 01719000
*      (GPR01P) RESTRICTED;                                        0516 01720000
*     I005=I005&&I005;              /* INIT LIST                     */ 01721000
         XC    I005(10),I005                                       0517 01722000
*     I00505='00'X;                 /* SET TYPE                      */ 01723000
         MVI   I00505,X'00'                                        0518 01724000
*     I00502=FREELEN;               /* LENGTH                        */ 01725000
         STCM  FREELEN,7,I00502                                    0519 01726000
*     I00504=ADDR(FREEADDR);        /* ADDR OF ADDR LIST             */ 01727000
         LA    @10,FREEADDR                                        0520 01728000
         STCM  @10,7,I00504                                        0520 01729000
*     I00506=78;                    /* SUBPOOL VALUE                 */ 01730000
         MVI   I00506,X'4E'                                        0521 01731000
*     GPR01P=ADDR(I005);            /* REG1 POINTS TO LIST           */ 01732000
         LA    GPR01P,I005                                         0522 01733000
*     SVC(5);                       /* STANDARD-FORM OF GETMAIN      */ 01734000
         SVC   5                                                   0523 01735000
*     RESPECIFY                                                    0524 01736000
*      (GPR01P) UNRESTRICTED;                                      0524 01737000
*   END;                            /* FREEMAIN (E) LV(FREELEN)    0525 01738000
*                                      A(FREEADDR)             SP(78)*/ 01739000
*   END FREETIN;                                                   0526 01740000
@EL00003 L     @13,4(,@13)                                         0526 01741000
@EF00003 DS    0H                                                  0526 01742000
@ER00003 LM    @14,@12,12(@13)                                     0526 01743000
         BR    @14                                                 0526 01744000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 01745000
*     GPR01P PTR(31) REG(1);                                       0527 01746000
*   DCL                                                            0528 01747000
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */ 01748000
*      2 I00401 PTR(31),            /* LENGTH                        */ 01749000
*      2 I00402 CHAR(1),            /* HIARCHY                       */ 01750000
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */ 01751000
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */ 01752000
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */ 01753000
*   DCL                                                            0529 01754000
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */ 01755000
*       3 I00501 PTR(8),            /* RESERVED                      */ 01756000
*       3 I00502 PTR(24),           /* LENGTH                        */ 01757000
*       3 I00503 PTR(8),            /* RESERVED                      */ 01758000
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */ 01759000
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */ 01760000
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */ 01761000
*   DECLARE                                                        0530 01762000
*     ILIST CHAR(10) BDY(DWORD);    /* STANDARD LIST                 */ 01763000
*   DECLARE                         /* COMMON VARIABLES              */ 01764000
*     I256C CHAR(256) BASED,                                       0531 01765000
*     I031F FIXED(31) BASED,                                       0531 01766000
*     I031P PTR(31) BASED,                                         0531 01767000
*     I015F FIXED(15) BASED,                                       0531 01768000
*     I015P PTR(15) BASED,                                         0531 01769000
*     I008P PTR(8) BASED,                                          0531 01770000
*     I001C CHAR(1) BASED;                                         0531 01771000
*   END IKJEFT55                    /* END OF GETLINE                */ 01772000
*                                                                  0532 01773000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01774000
*/*%INCLUDE SYSLIB  (IKJEXEC )                                       */ 01775000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */ 01776000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 01777000
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */ 01778000
*                                                                  0532 01779000
*       ;                                                          0532 01780000
@DATA    DS    0H                                                       01781000
@SM00388 MVC   STACKL(0),MACROS                                         01782000
@SM00391 MVC   MASTBFR(0,@09),CBUF(BUFPTR)                              01783000
@SO00393 OC    FOLDAREA(0),CBUF(BUFPTR)                                 01784000
@SC00395 CLC   FOLDAREA(0),DELIM(DELIMPTR)                              01785000
@DATD    DSECT                                                          01786000
         DS    0F                                                       01787000
@SA00001 DS    18F                                                      01788000
@PC00001 DS    4F                                                       01789000
@SA00003 DS    18F                                                      01790000
@AL00001 DS    5A                                                       01791000
IKJEFT55 CSECT                                                          01792000
         DS    0F                                                       01793000
@CF00256 DC    F'0'                                                     01794000
@CF00036 DC    F'1'                                                     01795000
@CF00087 DC    F'2'                                                     01796000
@CF00055 DC    F'4'                                                     01797000
@CF00259 DC    F'5'                                                     01798000
@CF00134 DC    F'6'                                                     01799000
@CF00103 DC    F'7'                                                     01800000
@CF00050 DC    F'8'                                                     01801000
@CF00320 DC    F'12'                                                    01802000
@CF00277 DC    F'20'                                                    01803000
@CF00299 DC    F'136'                                                   01804000
@DATD    DSECT                                                          01805000
         DS    0D                                                       01806000
ECDACBLK DS    AL4                                                      01807000
         ORG   ECDACBLK                                                 01808000
@NM00015 DS    AL1                                                      01809000
ECDACBK2 DS    AL3                                                      01810000
         ORG   ECDACBLK+4                                               01811000
UPTPTR   DS    A                                                        01812000
ECTPTR   DS    A                                                        01813000
OBTAINAD DS    A                                                        01814000
TGETPARM DS    AL4                                                      01815000
         ORG   TGETPARM                                                 01816000
TGOPTION DS    AL1                                                      01817000
IBUFADR  DS    AL3                                                      01818000
         ORG   TGETPARM+4                                               01819000
LINELEN  DS    F                                                        01820000
FREEADDR DS    A                                                        01821000
FOLDAREA DS    CL256                                                    01822000
         DS    CL4                                                      01823000
WORKAREA DS    CL8                                                      01824000
ATTNBIT  DS    BL1                                                      01825000
LOOPA    DS    BL1                                                      01826000
GETLINE  DS    BL1                                                      01827000
COMMENTS DS    BL1                                                      01828000
TRUNC    DS    BL1                                                      01829000
EXITA    DS    BL1                                                      01830000
PARM433  DS    CL8                                                      01831000
         ORG   PARM433                                                  01832000
@NM00016 DS    FL4                                                      01833000
         ORG   @NM00016                                                 01834000
PARMDEFR DS    BL1                                                      01835000
EOCLIST  EQU   @NM00016+0                                               01836000
EXITSTMT EQU   @NM00016+0                                               01837000
         ORG   PARM433+4                                                01838000
SUSPENDI DS    AL4                                                      01839000
         ORG   PARM433+8                                                01840000
OUTA     DS    CL2                                                      01841000
UPLIST   DS    CL16                                                     01842000
         ORG   UPLIST                                                   01843000
LOCPTR   DS    AL4                                                      01844000
LOCLEN   DS    FL4                                                      01845000
VALPTR   DS    AL4                                                      01846000
VALLEN   DS    FL4                                                      01847000
         ORG   UPLIST+16                                                01848000
CONTEXP  DS    BL1                                                      01849000
         DS    CL7                                                      01850000
ILIST    DS    CL10                                                     01851000
IKJEFT55 CSECT                                                          01852000
         DS    0F                                                       01853000
@SIZDATD DC    AL1(1)                                                   01854000
         DC    AL3(@ENDDATD-@DATD)                                      01855000
@CA00206 DC    A(TRTABUP)                                               01856000
@CV00315 DC    V(IKJRBBMC)                                              01857000
@CV00336 DC    V(IKJUPDT)                                               01858000
@CV00346 DC    V(IKJEFT30)                                              01859000
@CV00359 DC    V(IKJCT433)                                              01860000
         DS    0D                                                       01861000
@CC00254 DC    C'SYSDVAL'                                               01862000
@CC00252 DC    C'SYSDLM'                                                01863000
@CC00317 DC    C'END'                                                   01864000
@CC00331 DC    C'/*'                                                    01865000
@CC00368 DC    C'*/'                                                    01866000
PATCH    DC    20F'0'                                                   01867000
IKJEFT55 CSECT                                                          01868000
MACROS  STACK  DELETE=TOP,MF=L                                          01869000
        STAX   DEFER=NO,MF=L                                            01870000
        STAX   DEFER=YES,MF=L                                           01871000
MACSLEN DC     A(MACSLEN-MACROS)                                        01872000
@DATD    DSECT                                                          01873000
STACKL   STACK DELETE=TOP,MF=L                                          01874000
DEFERNO  STAX  DEFER=NO,MF=L                                            01875000
DEFERYES STAX  DEFER=YES,MF=L                                           01876000
@DATD    DSECT                                                          01877000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01878000
@ENDDATD EQU   *                                                        01879000
IKJEFT55 CSECT                                                          01880000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01881000
@01      EQU   01                                                       01882000
@02      EQU   02                                                       01883000
@03      EQU   03                                                       01884000
@04      EQU   04                                                       01885000
@05      EQU   05                                                       01886000
@06      EQU   06                                                       01887000
@07      EQU   07                                                       01888000
@08      EQU   08                                                       01889000
@09      EQU   09                                                       01890000
@10      EQU   10                                                       01891000
@11      EQU   11                                                       01892000
@12      EQU   12                                                       01893000
@13      EQU   13                                                       01894000
@14      EQU   14                                                       01895000
@15      EQU   15                                                       01896000
I        EQU   @03                                                      01897000
DELIMPTR EQU   @06                                                      01898000
FREELEN  EQU   @09                                                      01899000
MOVELEN  EQU   @03                                                      01900000
ENDLOC   EQU   @04                                                      01901000
ENDBUF   EQU   @06                                                      01902000
DLBASE   EQU   @02                                                      01903000
BUFPTR   EQU   @02                                                      01904000
GETLEN   EQU   @08                                                      01905000
APOINTER EQU   @02                                                      01906000
TGETCODE EQU   @05                                                      01907000
COUNT    EQU   @09                                                      01908000
BUFLEN   EQU   @04                                                      01909000
SSELMPTR EQU   @10                                                      01910000
RETURNCD EQU   @02                                                      01911000
LSDPTR   EQU   @07                                                      01912000
R0       EQU   @00                                                      01913000
R1       EQU   @01                                                      01914000
R2       EQU   @02                                                      01915000
R3       EQU   @03                                                      01916000
R4       EQU   @04                                                      01917000
R5       EQU   @05                                                      01918000
R15      EQU   @15                                                      01919000
GPR01P   EQU   @01                                                      01920000
         EXTRN TRTABUP                                                  01921000
EXECDATA EQU   0                                                        01922000
@NM00001 EQU   EXECDATA+16                                              01923000
EXINSAVE EQU   @NM00001                                                 01924000
RETPTR   EQU   EXECDATA+28                                              01925000
EXDATFLG EQU   EXECDATA+32                                              01926000
@NM00002 EQU   EXDATFLG                                                 01927000
CMAIN    EQU   @NM00002                                                 01928000
ATTNCMD  EQU   @NM00002                                                 01929000
ATINCNTL EQU   @NM00002+1                                               01930000
EXDLMPTR EQU   EXECDATA+40                                              01931000
COMPROC  EQU   0                                                        01932000
COMPRPTR EQU   COMPROC                                                  01933000
COMPRID  EQU   COMPRPTR                                                 01934000
COMPRNXT EQU   COMPRPTR+1                                               01935000
COMPRLNG EQU   COMPROC+4                                                01936000
UPT      EQU   0                                                        01937000
UPTSWS   EQU   UPT+12                                                   01938000
ECT      EQU   0                                                        01939000
ECTRCDF  EQU   ECT                                                      01940000
ECTRTCD  EQU   ECT+1                                                    01941000
ECTIOWA  EQU   ECT+4                                                    01942000
ECTSWS   EQU   ECT+28                                                   01943000
ECTLOGF  EQU   ECTSWS                                                   01944000
ECTATTN  EQU   ECTSWS                                                   01945000
ECTSWS2  EQU   ECT+40                                                   01946000
ECTSWS21 EQU   ECTSWS2                                                  01947000
IOSRL    EQU   0                                                        01948000
IOSTELM  EQU   IOSRL                                                    01949000
IOSBELM  EQU   IOSRL+4                                                  01950000
INSTACK  EQU   0                                                        01951000
INSCODE  EQU   INSTACK                                                  01952000
INSTERM  EQU   INSCODE                                                  01953000
INSINDD  EQU   INSCODE                                                  01954000
INSEXEC  EQU   INSCODE                                                  01955000
INSADLSD EQU   INSTACK+1                                                01956000
LSD      EQU   0                                                        01957000
LSDADATA EQU   LSD                                                      01958000
LSDRCLEN EQU   LSD+4                                                    01959000
LSDTOTLN EQU   LSD+6                                                    01960000
LSDANEXT EQU   LSD+8                                                    01961000
LSDEXEC  EQU   LSD+12                                                   01962000
CBUF     EQU   0                                                        01963000
MASTBFR  EQU   0                                                        01964000
IODSD    EQU   0                                                        01965000
DSDMINBF EQU   IODSD+4                                                  01966000
@NM00022 EQU   0                                                        01967000
DELIMLL  EQU   @NM00022                                                 01968000
DELIM    EQU   @NM00022+2                                               01969000
VAL      EQU   0                                                        01970000
LASTCHAR EQU   0                                                        01971000
RECORDBF EQU   0                                                        01972000
LL       EQU   RECORDBF                                                 01973000
OO       EQU   RECORDBF+2                                               01974000
DTAA     EQU   RECORDBF+4                                               01975000
VRECORD  EQU   0                                                        01976000
VRECLL   EQU   VRECORD                                                  01977000
I001C    EQU   0                                                        01978000
I008P    EQU   0                                                        01979000
I015F    EQU   0                                                        01980000
I015P    EQU   0                                                        01981000
I031F    EQU   0                                                        01982000
I031P    EQU   0                                                        01983000
I256C    EQU   0                                                        01984000
UPTX     EQU   0                                                        01985000
ECTX     EQU   0                                                        01986000
ECB      EQU   0                                                        01987000
ECBCBIT  EQU   ECB                                                      01988000
GTPB     EQU   0                                                        01989000
PARMCNTL EQU   GTPB                                                     01990000
PARMPHYS EQU   PARMCNTL                                                 01991000
PARMTERM EQU   PARMCNTL                                                 01992000
PARMTGT  EQU   GTPB+2                                                   01993000
PARMTGET EQU   PARMTGT                                                  01994000
PARMADIN EQU   GTPB+4                                                   01995000
@NM00013 EQU   LSDANEXT                                                 01996000
CURID    EQU   @NM00013                                                 01997000
CURADDR  EQU   @NM00013+1                                               01998000
I004     EQU   ILIST                                                    01999000
I00401   EQU   I004                                                     02000000
I00403   EQU   I004+5                                                   02001000
I00404   EQU   I004+8                                                   02002000
I00405   EQU   I004+9                                                   02003000
I005     EQU   ILIST                                                    02004000
I00502   EQU   I005+1                                                   02005000
I00504   EQU   I005+5                                                   02006000
I00505   EQU   I005+8                                                   02007000
I00506   EQU   I005+9                                                   02008000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02009000
I00503   EQU   I005+4                                                   02010000
I00501   EQU   I005                                                     02011000
I00402   EQU   I004+4                                                   02012000
@NM00014 EQU   PARMTGT+1                                                02013000
PARMGET  EQU   PARMCNTL                                                 02014000
PARMBIT0 EQU   PARMCNTL                                                 02015000
ECBCOMPC EQU   ECB                                                      02016000
ECBWBIT  EQU   ECB                                                      02017000
IODADLSD EQU   IODSD+8                                                  02018000
@NM00021 EQU   IODSD+6                                                  02019000
@NM00020 EQU   IODSD+3                                                  02020000
@NM00019 EQU   IODSD+2                                                  02021000
@NM00018 EQU   IODSD+1                                                  02022000
@NM00017 EQU   IODSD                                                    02023000
INSLIST  EQU   INSCODE                                                  02024000
INSPROC  EQU   INSCODE                                                  02025000
INSPROM  EQU   INSCODE                                                  02026000
INSOTDD  EQU   INSCODE                                                  02027000
INSSTOR  EQU   INSCODE                                                  02028000
IOSUNUSD EQU   IOSRL+12                                                 02029000
IOSNELM  EQU   IOSRL+10                                                 02030000
IOSTLEN  EQU   IOSRL+8                                                  02031000
@NM00012 EQU   ECT+52                                                   02032000
@NM00011 EQU   ECT+48                                                   02033000
@NM00010 EQU   ECT+44                                                   02034000
@NM00009 EQU   ECTSWS2+1                                                02035000
@NM00008 EQU   ECTSWS21                                                 02036000
ECTTABND EQU   ECTSWS21                                                 02037000
ECTDEFCS EQU   ECTSWS21                                                 02038000
ECTBKPB  EQU   ECT+36                                                   02039000
ECTUSER  EQU   ECT+32                                                   02040000
ECTDDNUM EQU   ECT+29                                                   02041000
ECTBKGRD EQU   ECTSWS                                                   02042000
ECTNNOT  EQU   ECTSWS                                                   02043000
ECTNMAL  EQU   ECTSWS                                                   02044000
ECTATRM  EQU   ECTSWS                                                   02045000
@NM00007 EQU   ECTSWS                                                   02046000
ECTNOPD  EQU   ECTSWS                                                   02047000
ECTSCMD  EQU   ECT+20                                                   02048000
ECTPCMD  EQU   ECT+12                                                   02049000
ECTSMSG  EQU   ECT+9                                                    02050000
ECTMSGF  EQU   ECT+8                                                    02051000
UPTPREFL EQU   UPT+23                                                   02052000
UPTPREFX EQU   UPT+16                                                   02053000
@NM00006 EQU   UPT+15                                                   02054000
UPTLDEL  EQU   UPT+14                                                   02055000
UPTCDEL  EQU   UPT+13                                                   02056000
UPTWTP   EQU   UPTSWS                                                   02057000
UPTMODE  EQU   UPTSWS                                                   02058000
UPTALD   EQU   UPTSWS                                                   02059000
UPTPAUS  EQU   UPTSWS                                                   02060000
UPTNCOM  EQU   UPTSWS                                                   02061000
UPTMID   EQU   UPTSWS                                                   02062000
UPTNPRM  EQU   UPTSWS                                                   02063000
@NM00005 EQU   UPTSWS                                                   02064000
UPTUSER  EQU   UPT+2                                                    02065000
@NM00004 EQU   UPT                                                      02066000
COMRCDS  EQU   COMPROC+12                                               02067000
COMPRUSE EQU   COMPROC+8                                                02068000
@NM00003 EQU   EXECDATA+60                                              02069000
FILEDCBS EQU   EXECDATA+56                                              02070000
RETPTR2  EQU   EXECDATA+52                                              02071000
ATACTEND EQU   EXECDATA+48                                              02072000
ATACTSTR EQU   EXECDATA+44                                              02073000
GEXECCNT EQU   EXECDATA+36                                              02074000
NOLASTCC EQU   @NM00002+1                                               02075000
NOMSG    EQU   @NM00002                                                 02076000
ERINCNTL EQU   @NM00002                                                 02077000
SYMLST   EQU   @NM00002                                                 02078000
NOFLUSH  EQU   @NM00002                                                 02079000
ERRCMD   EQU   @NM00002                                                 02080000
CONLST   EQU   @NM00002                                                 02081000
ERACTEND EQU   EXECDATA+24                                              02082000
ERACTSTR EQU   EXECDATA+20                                              02083000
LASTTSO  EQU   EXECDATA+12                                              02084000
GEXECDAT EQU   EXECDATA+8                                               02085000
SVTABFST EQU   EXECDATA+4                                               02086000
SNTABFST EQU   EXECDATA                                                 02087000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02088000
@RT00081 EQU   SETUPGET                                                 02089000
@RT00084 EQU   GETBIGBF                                                 02090000
@RT00092 EQU   NORMEND                                                  02091000
@RC00094 EQU   NORMEND                                                  02092000
@RT00122 EQU   CHECKECB                                                 02093000
@RT00124 EQU   GETBIGBF                                                 02094000
@RC00131 EQU   EREXIT                                                   02095000
@RT00264 EQU   DELETE                                                   02096000
@RT00288 EQU   GETMNER                                                  02097000
@RC00365 EQU   EXIT                                                     02098000
@RT00378 EQU   INVALID                                                  02099000
@RT00406 EQU   RESTRT2                                                  02100000
@RF00406 EQU   RESTRT                                                   02101000
@RT00410 EQU   EXIT                                                     02102000
@RT00412 EQU   INVALID                                                  02103000
@RT00442 EQU   DELETE                                                   02104000
@RT00459 EQU   GETMNER                                                  02105000
@ENDDATA EQU   *                                                        02106000
         END   IKJEFT55,(C'PLS1751',0701,77010)                         02107000
