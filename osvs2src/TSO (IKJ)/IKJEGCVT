CVT      TITLE ' * MVM * IKJEGCVT THE CONVERSION ROUTINE OF TEST'       00020002
         COPY IKJEGSIO                                                  00032002
IKJEGCVT CSECT                                                          00040002
*C59800                                        ZA09259,ZA10462,ZA07138  00050003
*D60600                                                        ZA07138  00060003
*A047397,047398                                                  YM0568 00090002
*A530420,530500                                                 YA00086 00140002
*A047130                                                       @ZA11823 00143003
*C047140                                                       @ZA11823 00146003
*C50040000                                                     @ZA11367 00149003
*A50042000-50050000                                            @ZA11367 00152003
*A159182                                                       @ZA28933 00155003
*****************************  PROLOGUE  ****************************** 00160002
* STATUS  CHANGE LEVEL  00, VERSION NUMBER 01, OS/VS2                 * 00180002
*                                                                     * 00200002
* FUNCTION                                                            * 00220002
*    THIS MODULE IS A UTILITY PROGRAM USED BY THE 'TEST' PACKAGE      * 00240002
*    OF THE TIME SHARING OPTION (TSO) FOR AOS/370 MVT.  IT IS         * 00260002
*    CALLED BY VARIOUS TEST ROUTINES TO PERFORM DATA TRANSLATION      * 00280002
*    TO/FROM BINARY FROM/TO A PRINTABLE FORMAT.  THIS ROUTINE IS      * 00300002
*    ABLE TO CONVERT TO BINARY FROM THE FOLLOWING PRINTABLE FOR-      * 00320002
*    MATS- A, B, D, E, F, H, P, S, X, AND Y.  IN ADDITION, IT IS      * 00340002
*    ABLE TO CONVERT FROM BINARY TO THE FOLLOWING PRINTABLE FOR-      * 00360002
*    MATS- A, D, E, F, H, I, P, S, X, AND Y.                          * 00380002
*                                                                     * 00400002
* ENTRY POINTS                                                        * 00420002
*                                                                     * 00440002
*    IKJEGCVT-ENTRY POINT FOR ADDRESS AND VALUE CONVERSIONS.          * 00460002
*                                                                     * 00480002
*    IKJEGCOP-ENTRY POINT FOR THE OPCODE TABLE.                       * 00500002
*                                                                     * 00520002
* INPUT                                                               * 00540002
*    GENERAL PURPOSE REGISTER ZERO                                    * 00560002
*         IF NEGATIVE, INDICATES CONVERSION TO PRINTABLE FORMAT.      * 00580002
*         IF POSITIVE, INDICATES CONVERSION TO BINARY FORMAT.         * 00600002
*    GENERAL PURPOSE REGISTER ONE POINTS TO A PARSE-LIKE PARAME-      * 00620002
*    TER DESCRIPTOR LIST (PDL) CONTAINING AN ADDRESS OR A VALUE       * 00640002
*    PARSE-LIKE DESCRIPTOR ENTRY (PDE)                                * 00660002
*         IF NEGATIVE, INDICATES AN ADDRESS CONVERSION.               * 00680002
*         IF POSITIVE, INDICATES A VALUE CONVERSION.                  * 00700002
*                                                                     * 00720002
* OUTPUT                                                              * 00740002
*    FOR ADDRESS CONVERSION                                           * 00760002
*         1).  BINARY TO PRINTABLE CONVERSION OUTPUT IS RETURNED      * 00780002
*              IN CONAREA.                                            * 00800002
*         2).  PRINTABLE TO BINARY CONVERSION OUTPUT IS RETURNED      * 00820002
*              IN THE USER WORD OF THE ADDRESS PDE.                   * 00840002
*    FOR VALUE CONVERSION                                             * 00860002
*         THIS ROUTINE PLACES IN A SECTION OF CORE, POINTED TO        * 00880002
*         TO BY 'CONAREA' IN THE TEST COMMUNICATION TABLE (TCOMTAB)   * 00900002
*         THE FOLLOWING                                               * 00920002
*         1).  LENGTH OF CONVERTED OUTPUT.  (FIRST BYTE).             * 00940002
*         2).  ACTUAL CONVERTED OUTPUT.  (REMAINING BYTES).           * 00960002
*                                                                     * 00980002
* EXTERNAL REFERENCES                                                 * 01000002
*                                                                     * 01020002
*    IKJEGSYM - THE CONVERT ROUTINE CALLS UPON IKJEGSYM TO PER-       * 01040002
*    *          FORM RESOLUTION FOR ALL SYMBOLIC ADDRESSES AS         * 01060002
*    *          WELL AS FOR THE SYMBOLIC PART OF ADDRESS EXPRES-      * 01080002
*    *          SIONS.  IT EXPECTS IKJEGSYM TO SET THE FIRST BYTE     * 01100002
*    *          OF THE USER WORD OF THE ADDRESS PDE TO X'80' AND      * 01120002
*    *          TO SET THE REMAINING THREE BYTES TO POINT TO A        * 01140002
*    *          SYMBOL INFORMATION BLOCK (SYMINFO) WHOSE FIRST        * 01160002
*    *          WORD CONTAINS THE BINARY REPRESENTATION OF THE        * 01180002
*    *          ADDRESS.                                              * 01200002
*                                                                     * 01220002
*    IKJEGIO  - I/O IS CALLED TO WRITE DIAGNOSTIC MESSAGES;   IT      * 01240002
*    *          IS INVOKED VIA THE IKJEGSIO MACRO.                    * 01260002
*                                                                     * 01360002
*    ESTAE    - ESTABLISH ABEND RECOVERY EXIT ROUTINE (IKJEGSTA)      * 01410002
*                                                                     * 01430002
* EXITS, NORMAL                                                       * 01480002
*    RETURN VIA GENERAL PURPOSE REGISTER FOURTEEN.                    * 01500002
*    RETURN CODE ZERO IN GENERAL PURPOSE REGISTER FIFTEEN.            * 01520002
*                                                                     * 01540002
* RETURN CODES                                                        * 01550002
*    00 - SUCCESSFULLY COMPLETED CONVERSION.                          * 01552002
*    04 - UNABLE TO CONVERT A VALUE.                                  * 01554002
*    16 - ATTENTION HAS BEEN SCHEDULED.                               * 01554402
*    20 - ESTAE EXIT ROUTINE HAS INTERCEPTED A SCHEDULED ABEND.       * 01554802
*    24 - COULD NOT ISSUE ESTAE.                                      * 01555202
*                                                                     * 01556002
* EXITS, ERROR                                                        * 01560002
*    RETURN VIA GENERAL PURPOSE REGISTER FOURTEEN.                    * 01580002
*    RETURN CODE FOUR (4) - UNABLE TO CONVERT VALUE.                  * 01600002
*    RETURN CODE SIXTEEN (16) - ATTENTION IN EFFECT.                  * 01620002
*                                                                     * 01640002
* TABLES/WORK AREAS                                                   * 01660002
*    TCOMTAB - TEST TABLE AND WORKAREA                                * 01670002
*                                                                     * 01672002
* ATTRIBUTES                                                          * 01680002
*    REENTRANT, REFRESHABLE                                           * 01700002
*                                                                     * 01702002
* CHARACTER CODE DEPENDENCY --                                        * 01710002
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 01712002
*                                                                     * 01720002
* NOTES                                                               * 01740002
* CHANGE-ACTIVITY -                                                     01741003
*                APAR OZ07138 FIXES A PROBLEM WITH FETCHING AND         01742003
*                STORING REGISTERS IN THE INCORRECT RB WHEN AN          01743003
*                ASYNCHRONOUS EXIT CAUSES AN IRB TO BE CHAINED ON       01744003
*                THE TCB/RB QUEUE.  THE FIX IS BEFORE LABEL REGPK.      01745003
*                THE SVC 97 SVRB WILL BE POINTED TO OUT OF TCOMTAB      01746003
*                AT LABEL ECBPP+1.                                      01747003
*                APAR OZ09259 - SAME AS ABOVE.                          01748003
*                APAR OZ10462 - SAME AS ABOVE.                          01749003
*                APAR OZ11823 - CORRECT EXIT ROUTINE SPECIFICATION      01750003
*                FOR ESTAE MACRO.                                       01751003
*                                                                     * 01760002
*********************************************************************** 01780002
         EJECT                                                          01800002
R0       EQU   0                       ******************************** 01820002
R1       EQU   1                       *                              * 01840002
R2       EQU   2                       *        REGISTERS             * 01860002
R3       EQU   3                       *                              * 01880002
R4       EQU   4                       *         EQUATES              * 01900002
R5       EQU   5                       *                              * 01920002
R6       EQU   6                       *                              * 01940002
R7       EQU   7                       *                              * 01960002
R8       EQU   8                       *                              * 01980002
R9       EQU   9                       *         REGISTERS            * 02000002
R10      EQU   10                      *                              * 02020002
R11      EQU   11                      *         EQUATES              * 02040002
R12      EQU   12                      *                              * 02060002
R13      EQU   13                      *                              * 02080002
R14      EQU   14                      *                              * 02100002
R15      EQU   15                      ******************************** 02120002
@0       EQU   0                                                        02130002
@4       EQU   4                                                        02130402
@6       EQU   6                                                        02130802
@12      EQU   12                                                       02132002
@16      EQU   16                                                       02134002
@20      EQU   20                                                       02136002
@24      EQU   24                                                       02136402
@60      EQU   60                                                       02138002
BASEDISP EQU   2                                                        02140002
EXPPLUS  EQU   C'+'                                                     02160002
B7       EQU   X'B7'                   FOR ALPHABETIC CONVERSION        02180002
F0       EQU   X'F0'                   FOR NUMERIC CONVERSIONS          02200002
ZERO     EQU   0                       ZERO                             02220002
ONE      EQU   1                       ONE                              02240002
TWO      EQU   2                       TWO                              02260002
THREE    EQU   3                       THREE                            02280002
FOUR     EQU   4                       FOUR                             02300002
FIVE     EQU   5                       FIVE                             02320002
SIX      EQU   6                       SIX                              02340002
SEVEN    EQU   7                       SEVEN                            02360002
EIGHT    EQU   8                       EIGHT                            02380002
NINE     EQU   9                       NINE                             02400002
TEN      EQU   10                      TEN                              02420002
ELEVEN   EQU   11                      ELEVEN                           02440002
ONE2     EQU   12                      TWELVE                           02460002
HEXFF    EQU   X'FF'                   HEX FF                           02480002
HEX00    EQU   X'00'                   HEX 00                           02500002
HEX40    EQU   X'40'                   HEX 40                           02520002
HEX80    EQU   X'80'                   HEX 80                           02540002
HEXC0    EQU   X'C0'                   HEX C0                           02560002
HEXF0    EQU   X'F0'                   HEX F0                           02580002
HEX04    EQU   X'04'                   HEX 04                           02600002
HEX0F    EQU   X'0F'                   HEX 0F                           02620002
HEX08    EQU   X'08'                   HEX 08                           02640002
HEX01    EQU   X'01'                   HEX 01                           02660002
HEX13    EQU   X'13'                   HEX 13                           02680002
HEX0C    EQU   X'0C'                   HEX 0C                           02700002
EXP      EQU   X'FF'                   HEX FF                           02720002
ONE3     EQU   13                      DEC 13                           02740002
ONE1     EQU   11                      DEC 11                           02760002
ONE4     EQU   14                      DEC 14                           02780002
ONE5     EQU   15                      DEC 15                           02800002
ONE6     EQU   16                      DEC 16                           02820002
ONE9     EQU   19                      DEC 19                           02840002
EXPIND   EQU   10                                                       02860002
TWO4     EQU   24                      DEC 24                           02880002
TWO3     EQU   23                      DEC 23                           02900002
TWO6     EQU   26                      DEC 26                           02920002
ONE7     EQU   17                      DEC 17                           02940002
NOFZONE  EQU   34                                                       02960002
TWO7     EQU   27                      DEC 27                           02980002
TWO8     EQU   28                      DEC 28                           03000002
THREE2   EQU   32                      DEC 32                           03020002
FORTY    EQU   40                      DEC 40                           03040002
*        GENERAL CONSTANTS USED BY THE CONVERT MODULES                  03052002
VALLEN   EQU   5                       FIVE                             03060002
STARTER  EQU   X'21'                   HEX 21                           03080002
LENSYM   EQU   8                       MAXIMUM LEN FOR SYMBLES.         03100002
PACKSIGN EQU   25                      DEC 25                           03120002
OUTLEN   EQU   X'70'                   HEX 70                           03140002
WORK2    EQU   16                      DEC 16                           03160002
WORK3    EQU   26                      DEC 26                           03180002
FIXED    EQU   47                      OFFSET TO END OF ZONED DATA.     03200002
WORK4    EQU   8                       EIGHT                            03220002
WORK5    EQU   18                      DEC 18                           03240002
FDECSTAR EQU   44                      DEC 44                           03260002
OPTAB4   EQU   4                       DEC 4                            03280002
NEGBYTE  EQU   X'FF'                   HEX FF                           03300002
HION     EQU   X'80'                   HEX 80                           03302002
*        NON NUMERIC CONSTANTS                                          03310002
SIGNNEG  EQU   C'-'                    MINUS SIGN                       03320002
PLUSSIGN EQU   C'+'                    PLUS SIGN                        03340002
BLANK    EQU   C' '                    BLANK                            03360002
AZERO    EQU   C'0'                    CHAR ZERO                        03400002
PLUS     EQU   C'+'                    CHAR PLUS                        03420002
MINUS    EQU   C'-'                    CHAR MINUS                       03440002
CLOSE    EQU   C')'                    CLOSE PREN                       03540002
OPEN     EQU   C'('                    OPEN PREN                        03560002
COMMA    EQU   C','                    COMMA                            03580002
PERIOD   EQU   C'.'                    PERIOD                           03600002
*        MORE NUMERIC CONSTANTS TO BE USED BY THE CONVERT MODULE        03602002
OPSSVAL  EQU   X'20'                   HEX 20                           03610002
OPRRVAL  EQU   X'04'                   HEX 04                           03612002
OPSIVAL  EQU   X'1C'                   HEX 1C                           03614002
OPRSVAL  EQU   X'0C'                   HEX 0C                           03616002
LEN7     EQU   X'07'                   HEX 07                           03620002
GENMASK  EQU   X'20'                   HEX 20                           03640002
DOBMASK  EQU   X'10'                   HEX 10                           03660002
SINMASK  EQU   X'08'                   HEX 08                           03680002
BADPK    EQU   X'09'                   HEX 09                           03700002
LOWORDER EQU   28                      DEC 28                           03720002
TCBGRS   EQU   32                      DEC 32                           03740002
TWO0     EQU   20                      DEC 20                           03760002
SYMCK    EQU   X'80'                   HEX 80                           03780002
VALCK    EQU   X'80'                   HEX 80                           03800002
SIGNF    EQU   X'0F'                   HEX 0F                           03820002
RSIGN    EQU   C'R'                    CHAR R                           03840002
PLUSBIT  EQU   X'01'                   HEX 01                           03860002
PLUSBITS EQU   X'0F'                   HEX 0F                           03880002
ODDLEN   EQU   X'01'                   HEX 01                           03900002
HCODE    EQU   X'14'                   HEX 14                           03920002
HEX      EQU   X'02'                   HEX 02                           03940002
F1       EQU   X'01'                   HEX 01                           03960002
STCTLM   EQU   X'B6'                   OP CODE FOR STCTL.               03980002
STNSMM   EQU   X'AC'                   OP CODE FOR STNSM 370-R.         04000002
STOSMM   EQU   X'AD'                   OP CODE FOR STOSM 370 R.         04020002
SIOFOP   EQU   X'9C'                   OP CODE FOR SIO AND SIOF.        04040002
SRPOP    EQU   X'F0'                   OP CODE FOR SRP.                 04060002
B2       EQU   X'B2'                   FIRST BYTES FOR 370 2 BYTE       04080002
*                                      OP CODES.                        04100002
CHARS    EQU   C'S'                                                     04120002
CHARF    EQU   C'F'                                                     04140002
YCODE    EQU   X'24'                                                    04160002
FIXCOUNT EQU   31                      LOOP COUNT FOR FIXDEC.           04180002
FEXPPDE  EQU   16                                                       04200002
SIGNIT   EQU   25                      LOC OF SIGN BYTE OF PACK DATA.   04220002
PKLEN    EQU   X'70'                                                    04240002
REGIN    EQU   3                                                        04260002
RDSIGN   EQU   C'D'                                                     04280002
RESIGN   EQU   C'E'                                                     04300002
PACKANS  EQU   16                      ANSWER PLACE OFFSET FOR PACK.    04320002
PACKWORK EQU   26                      OFFSET FOR UPDATED PACK VALUE.   04340002
         EJECT                                                          04360002
         TITLE '* AOS * IKJEGCVT ADDRESS AND VALUE ROUTING ROUTINE.'    04380002
         ENTRY IKJEGBL1                                                 04410002
CVTBEGIN SAVE  (14,12),,*                                               04420002
         LR    R12,R15                 R12=ADDR OF BEGINNING OF CSECT.  04440002
         USING CVTBEGIN,R12            CSECT ADDRESSABILITY.            04460002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY.          04480002
         L     R15,REGSAVE4            R15=ADDR OF MODULE SAVE AREA.    04500002
         ST    R13,FOUR(R15)           SAVE ADDR OF CALLER SAVE AREA.   04520002
         ST    R15,EIGHT(R13)          ADDR IN CALLER SAVE AREA.        04540002
         LR    R13,R15                 R13=ADDR OF MODULE SAVE AREA.    04560002
         SPACE                                                          04580002
*********************************************************************** 04600002
*                                                                     * 04620002
*        THE FOLLOWING INSTRUCTIONS ESTABLISH ESTAE SUPPORT FOR CVT   * 04640002
*                                                                     * 04680002
*********************************************************************** 04700002
         L     R3,WORKAREA        POINT TO CVT WORKAREA                 04710002
         XC    @0(ESTAELN,R3),@0(R3)  CLEAR AREA FOR ESTAE EXPANSION    04712002
         L     R15,TSTSTAE        GET ESTAE ROUTINE ADDRESS    @ZA11823 04712603
         ESTAE (R15),CT,PARAM=LIST,RECORD=YES,MF=(E,(R3))      @ZA11823 04713203
         LTR   R15,R15            WAS 'ESTAE' ACCEPTED                  04716002
         BZ    RESTORE1           IF R15=0, 'ESTAE' WAS ACCEPTED        04718002
         STC   R15,TSTESTRC       PLACE ESTAE RC IN TCOM TABLE          04718402
         LA    R15,@24            SET RETURN CODE TO DECIMAL 24         04718802
         B     AFTERSCB           GO RETURN                             04719202
         SPACE                                                          04720002
*********************************************************************** 04730002
*                                                                     * 04732002
*        THE FOLLOWING INSTRUCTIONS ROUTE CONTROL TO THE PROPER       * 04734002
*        CONVERSION AREA, ADDRESS OR EXPRESSION VALUE.                * 04736002
*                                                                     * 04738002
*********************************************************************** 04738402
         SPACE                                                          04738802
RESTORE1 L     R15,REGSAVE4       R15=ADDR OF MODULE SAVE AREA          04739202
         L     R1,FOUR(R15)       GET ADDR OF CALLER'S SAVE AREA        04739602
         L     R0,@20(R1)         RESTORE R0                     YM0568 04739702
         L     R1,@24(R1)         RESTORE R1                     YM0568 04739802
         LTR   R1,R1                   Q.AN ADDRESS CONVERSION.         04740002
         BP    VALCVT                  R1 IS POSITIVE, VALUE CONVERSION 04760002
         SPACE                                                          04780002
*********************************************************************** 04800002
* THE FOLLOWING INSTRUCTIONS DETERMINE IF THE ADDRESS CONVERSION IS   * 04820002
* TO BE TO OR FROM BINARY.                                            * 04840002
*********************************************************************** 04860002
         SPACE                                                          04880002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          04900002
         LCR   R1,R1                   R1=ADDRESS POSITIVE.             04920002
         LR    R8,R1                   R8=ADDRESS OF PDE.               04940002
         USING IKJPARMA,R8             PDE ADDRESSABILITY.              04960002
         LTR   R0,R0                   Q.CONVERSION TO BINARY.          04980002
         BM    FROMBIN                 RO IS NEG CVT FROM BINARY.       05000002
         TITLE 'IKJEGCVT ADDRESS VALIDITY CHECKING ROUTINE.'            05020002
TOBIN    EQU   *                                                        05040002
         SPACE                                                          05060002
*********************************************************************** 05080002
*                                                                     * 05100002
*        THE FOLLOWING INSTRUCTIONS CONVERT AN ADDRESS FROM           * 05120002
*        PRINTABLE CHARACTERS TO THEIR BINARY FORMAT.                 * 05140002
*                                                                     * 05160002
*********************************************************************** 05180002
         SPACE                                                          05200002
* THE TEST UNDER MASK ROUTES CONTROL TO THE PROPER CONVERSION CODE.   * 05220002
         SPACE                                                          05240002
         TM    PDEFLG4,ABSCOMPL        Q.IS ADDR ABSOLUTE.              05260002
         BZ    NOENTRY                 YES,CONVERT AN ABSOLUTE ADDR.    05280002
         TM    PDEFLG4,SYMADDR         Q.IS ADDR SYMBOLIC.              05300002
         BO    SYMFOUND                YES,CONVERT A SYMBOLIC ADDR.     05320002
         TM    PDEFLG4,RELADDR         Q.IS ADDR A RELATIVE.            05340002
         BO    RELFOUND                YES,CONVERT A RELATIVE ADDR.     05360002
         TM    PDEFLG4,CTONLY          Q.ONLY ENTRYNAME SPECIFIED.      05380002
         BO    ENTNAME                 YES,GET ADDR OF ENTRYNAME.       05400002
         SPACE                                                          05420002
*********************************************************************** 05440002
* THIS SECTION OF CODE CONVERTS A REGISTER FROM ITS PRINTABLE FORMAT  * 05460002
* TO ITS BINARY FORMAT.  IF THE REGISTER IS A GENERAL PURPOSE         * 05480002
* REGISTER AND IS INDIRECTED, THE VALUE POINTED TO BY THE INDIRECT    * 05500002
* WILL BE CONVERTED TO BINARY AND RETURNED IN THE USERWORD.           * 05520002
*********************************************************************** 05540002
         SPACE                                                          05560002
         LH    R4,PDELEN3              R4=LENGTH OF INPUT.              05580002
         LA    R5,PKLEN                R5=LENGTH OF PACKED DATA.        05600002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               05620002
         OR    R4,R5                   R4=L1 & L2.                      05640002
         L     R2,PDEADRPT             R2=ADDR OF INPUT.                05660002
         EX    R4,REGPK                REG NOW PACKED DATA.             05680002
         CVB   R4,ZERO(R3)             R4=BINARY VALUE OF REG.          05700002
         ST    R4,ZERO(R3)             BINARY NOW IN WORKAREA.          05720002
         SPACE                                                          05740002
* CHECK  TO DETERMINE IF INDIRECT ADDRESSING HAS BEEN SPECIFIED.      * 05760002
         SPACE                                                          05780002
         LH    R7,PDEINDCT             R7=INDIRECT VALUE.               05800002
         CH    R7,ZEROS                Q.IS INDIRECT SPECIFIED.         05820002
         BE    EXPVAL                  NO,CHECK FOR MORE EXP VALUES.    05840002
         SPACE                                                          05860002
*********************************************************************** 05880002
* THE FOLLOWING INSTRUCTIONS LOCATE THE REGISTER SPECIFIED IN THE     * 05900002
* PROBLEM PROGRAM TCB TO GET THE CONTENT OF THE REGISTER.             * 05920002
*********************************************************************** 05940002
         SPACE                                                          05960002
         L     R5,ECBPP                R5=ADDR OF 9G SVRB      @ZA07138 05980003
*                                                              @ZA09259 05985003
*                                                              @ZA10462 05990003
         SR    R6,R6                   R6=0.                            06000002
         IC    R6,THREE(R3)            R6=REGISTER NUMBER IN BINARY.    06020002
         SLL   R6,TWO                  R6=REGISTER OFFSET VALUE.        06040002
         L     R5,TCBGRS(R6,R5)        R5=CONTENT OF REGISTER IN PPTCB. 06080002
         LA    R5,ZERO(R5)             CLEAR HIGH ORDER BYTE.           06100002
         ST    R5,ZERO(R3)             CONTENT OF REG NOW IN WORKAREA.  06120002
         BCT   R7,NEXTADDR             GET NEXT ADDR.                   06140002
         B     EXPVAL                  CHECK FOR INDIRECTING.           06160002
REGPK    PACK  ZERO(ONE,R3),ZERO(ONE,R2) INPUT NOW PACKED DECIMAL.      06180002
         SPACE                                                          06200002
*********************************************************************** 06220002
* THIS SECTION OF CODE CONVERTS A RELATIVE ADDRESS FROM ITS PRINT-    * 06240002
* ABLE FORMAT TO ITS BINARY FORMAT.  TO GET THE REQUIRED ADDRESS      * 06260002
* THE BINARY VALUE OF THE RELATIVE IS ADDED TO PPLOAD IF AN ENTRYNAME * 06280002
* WAS NOT SPECIFIED.  IF AN ENTRYNAME IS SPECIFIED CONTROL IS PASSED  * 06300002
* TO SYM TO RESOLVE THE ABSOLUTE ADDRESS OF THE ENTRYNAME.  THE       * 06320002
* RELATIVE VALUE IS THEN ADDED TO THE ABSOLUTE ADDRESS.               * 06340002
*********************************************************************** 06360002
         SPACE                                                          06380002
RELFOUND EQU   *                                                        06400002
         TM    PDEFLG2,CTNAMFLG        Q.ENTRYNAME SPECIFIED.           06420002
         BNO   NOENTRY                 NO,SKIP LINK TO SYM.             06440002
         NI    PDEFLG3,(HEXFF-AFLG)    TURN OFF PARAMETER SWITCH.       06460002
         BAL   R10,SYMLINK             GO CALL IKJEGSYM.                06480002
         OI    PDEFLG3,AFLG            TURN PARAMETER SWITCH ON.        06500002
         LTR   R15,R15                 Q.ENTRYNAME FOUND.               06520002
         BNZ   RETURN                  RETURN TO CALLER.                06540002
         NI    PDEFLG3,(HEXFF-AFLG)    TURN OFF PARAMETER SWITCH.       06560002
NOENTRY  EQU   *                                                        06580002
         SPACE                                                          06600002
*********************************************************************** 06620002
* THIS AREA OF CODE CONVERTS RELATIVE AND ABSOLUTE INPUT CHARACTERS   * 06640002
* TO BINARY VIA THE HEXBIN VALUE CONVERSION ROUTINE.                  * 06660002
*********************************************************************** 06680002
         SPACE                                                          06700002
         LA    R1,PDEADRPT             R1=ADDR OF VALUE TYPE PDE.       06720002
         BAL   R14,HEXBIN              LINK TO HEX TO BINARY ROUTINE.   06740002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           06760002
         SR    R4,R4                   R4=0.                            06780002
         IC    R4,ZERO(R2)             R4=LENGTH OF RELATIVE.           06800002
         LA    R2,ONE(R2)              R2=OUTPUT STRING ADDRESS.        06820002
         L     R2,ZERO(R2)             R2=OUTPUT STRING.                06840002
         LA    R5,FOUR                 R5=4.                            06860002
         SR    R5,R4                   R5=NUMBER OF NONE VALID DIGITS.  06880002
         SLL   R5,THREE                R5=NUMBER OF BITS TO SHIFT.      06900002
         SRL   R2,ZERO(R5)             RELATIVE NOW RIGHT JUSTIFIED.    06920002
         ST    R2,ZERO(R3)             RELATIVE NOW IN WORKAREA.        06940002
         TM    PDEFLG4,ABSCOMPL        Q.ABSOLUTE SPECIFIED.            06960002
         BZ    INDIRECK                YES,CHECK FOR INDIRECKS.         06980002
         TM    PDEFLG3,AFLG            Q.ABSOLUTE ADDRESS IN USERWORD.  07000002
         BO    INFOSKIP                NO,GET PPLOAD.                   07020002
         LA    R7,PDEUSER              R7=QUALIFIED BASE ADDRESS.       07040002
         OI    PDEFLG3,AFLG            TURN PARAMETER SWITCH ON.        07060002
         B     PPSKIP                  SKIP PPLOAD CODE.                07080002
INFOSKIP EQU   *                                                        07100002
         LA    R7,PPLOAD               R7=ADDR OF CURRENT BASE FOR REL. 07120002
PPSKIP   EQU   *                                                        07140002
         MVC   FOUR(FOUR,R3),ZERO(R7)  MOVE CURRENT BASE INTO WORKAREA. 07160002
         L     R7,FOUR(R3)             R7=CURRENT BASE FOR RELATIVE.    07180002
         AL    R7,ZERO(R3)             R7=ABSOLUTE ADDRESS IN BINARY.   07200002
         ST    R7,ZERO(R3)             MOVE ABSOLTE ADDRESS TO WORKAREA 07220002
         SPACE                                                          07240002
*********************************************************************** 07260002
* THE FOLLOWING CODE WILL DETERMINE IF INDIRECTING WAS SPECIFIED. IF  * 07280002
* INDIRECTING IS SPECIFIED THE VALUE POINTED TO BY THE INDIRECT WILL  * 07300002
* BE PROCESSED.                                                       * 07320002
*********************************************************************** 07340002
         SPACE                                                          07360002
INDIRECK EQU   *                                                        07380002
         LH    R7,PDEINDCT             R7=INDIRECT COUNT.               07400002
         LTR   R7,R7                   Q.IS INDIRECTING REQUESTED.      07420002
         BZ    EXPVAL                  NO,CHECK FOR EXPRESSION VALUES.  07440002
         NI    PDEFLG5,HEXFF-PURESYM   TURN OFF SYMINFO SWITCH.         07460002
NEXTADDR EQU   *                                                        07480002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   07500002
*        BAL TO AN ADDRESS VALIDITY CHECK R3 = ADDR TO BE CHECKED   *   07520002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   07540002
         BAL   R10,ADDRVCK             IS THE ADDR VALID                07560002
         L     R6,ZERO(R3)             R6=ADDR OF NEXT VALUE.           07580002
         MVC   ZERO(FOUR,R3),ZERO(R6)  NEW VALUE NOW IN WORKAREA.       07600002
         MVI   ZERO(R3),ZERO           CLEAR HIGH ORDER BYTE.           07620002
         BCT   R7,NEXTADDR             DECREMENT INDIRECT COUNT.        07640002
         SPACE                                                          07660002
*********************************************************************** 07680002
* THE FOLLOWING INSTRUCTIONS CHECK FOR AN ADDRESS EXPRESSION VALUE.   * 07700002
* IF AN ADDRESS EXPRESSION IS INDICATED IT IS CONVERTED TO BINARY AND * 07720002
* ADDED TO THE ADDRESS ALREADY CALCULATED.                            * 07740002
*********************************************************************** 07760002
         SPACE                                                          07780002
EXPVAL   EQU   *                                                        07800002
         CLI   PDEEXPTR,EXP            Q.EXPRESSION SPECIFIED.          07820002
         BE    SKIPEXP                 NO,SKIP CODE TO TURN OFF SWITCH. 07840002
         NI    PDEFLG5,HEXFF-PURESYM   TURN OFF SYMINFO SWITCH.         07860002
SKIPEXP  EQU   *                                                        07880002
         L     R1,PDEEXPTR             R1=PT TO EXPRESSION PDE          07900002
         MVC   WORK4(ONE,R3),PDESIGN   SAVE EXPRESSION SIGN.            07920002
MOREVAL  EQU   *                                                        07940002
         LTR   R1,R1                   Q.MORE ADDRESS EXPRESSIONS.      07960002
         BM    CORECK                  NO,CHECK MAXIMUM CORE SIZE.      07980002
         SPACE                                                          08000002
*********************************************************************** 08020002
* THE FOLLOWING INSTRUCTION DETERMINE IF THE VALUE IS HEX OR DECML.   * 08040002
*********************************************************************** 08060002
         SPACE                                                          08080002
         TM    EIGHT(R1),HEX           Q.IS THE VALUE A HEX VALUE.      08100002
         BO    HEXVAL                  YES,CONVERT THE VALUE TO BINARY. 08120002
         SPACE                                                          08140002
* THIS AREA OF CODE CONVERTS A DECML VALUE TO BINARY BY A LINK TO     * 08160002
* FIXBIN(DECIMAL TO BINARY) ROUTINE.                                  * 08180002
         SPACE                                                          08200002
         SR    R5,R5                   R5=0,FOR FIXBIN ROUTINE.         08220002
         L     R0,ZERO(R3)             R0=ADDRESS.                      08240002
         BAL   R14,FAQVBIN             LINK TO FIXBIN CONVERT ROUTINE.  08260002
         SPACE                                                          08280002
*********************************************************************** 08300002
* THE FOLLOWING CODE ALTERS THE BINARY ADDRESS ALREADY COMPUTED WITH  * 08320002
* THE RESULTS OF THE BINARY VALUE RETURNED FROM THE CONVERSION        * 08340002
* ROUTINE.                                                            * 08360002
*********************************************************************** 08380002
         SPACE                                                          08400002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              08420002
         LA    R2,ONE(R2)              R2=PT TO OUTPUT FROM FAQVBIN.    08440002
         L     R4,ZERO(R2)             R4=VALUE RETURNED BY FAQVBIN.    08460002
TESTSIGN EQU   *                                                        08480002
         CLI   WORK4(R3),EXPPLUS       Q.EXPRESSION VALUE SIGN POSITIVE 08500002
         BE    PLUSEXP                 YES,ADD VALUE TO ADDRESS.        08520002
*********************************************************************** 08540002
* THE FOLLOWING INSTRUCTIONS SUBTRACT FROM THE BINARY ADDRESS THE     * 08560002
* BINARY VALUE RETURNED FROM THE CONVERSION ROUTINE.                  * 08580002
*********************************************************************** 08600002
         SPACE                                                          08620002
         SR    R0,R4                   R4=ALTERED ADDRESS.              08640002
MOVEALT  EQU   *                                                        08660002
         ST    R0,ZERO(R3)             ALTERED ADDRESS NOW IN WORKAREA. 08680002
         LH    R7,EXPIND(R1)           R7=EXP INDIRECT COUNT.           08700002
         LTR   R7,R7                   Q.IS INDIRECTING REQUESTED.      08720002
         BZ    NEXTEXP                 NO,CHECK NEXT EXP VALUE.         08740002
EXPADDR  EQU   *                                                        08760002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   08780002
*        BAL TO AN ADDRESS VALIDITY CHECK R3 = ADDR TO BE CHECKED   *   08800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   08820002
         BAL   R10,ADDRVCK             IS THE ADDR VALID                08840002
         MVC   PDEUSER+ONE(THREE),ONE(R3) ADDR NOW IN USERWORD.         08860002
         SPACE                                                          08880002
         L     R6,ZERO(R3)             R6=ADDR OF NEXT VALUE.           08900002
         MVC   ONE(THREE,R3),ONE(R6)   NEW VALUE NOW IN WORKAREA.       08920002
         BCT   R7,EXPADDR              DECREMENT INDIRECT COUNT.        08940002
NEXTEXP  EQU   *                                                        08960002
         MVC   WORK4(ONE,R3),NINE(R1)  SAVE SIGN OF EXPRESSION.         08980002
         L     R1,ONE2(R1)             R1=NEXT EXP ADDRESS.             09000002
         B     MOREVAL                 CHECK FOR MORE EXP.              09020002
         SPACE                                                          09040002
*********************************************************************** 09060002
* THE FOLLOWING INSTRUCTION ADDS TO THE BINARY ADDRESS THE BINARY     * 09080002
* VALUE  RETURNED FROM THE VALUE CONVERSION ROUTINE.                  * 09100002
*********************************************************************** 09120002
         SPACE                                                          09140002
PLUSEXP  EQU   *                                                        09160002
         AR    R0,R4                   R4=ALTERED ADDRESS.              09180002
         B     MOVEALT                 MOVE ALTERED ADDR INTO WORKAREA. 09200002
         SPACE                                                          09220002
*********************************************************************** 09240002
* THIS AREA OF CODE CONVERTS A HEX VALUE TO TO BINARY BY USING THE    * 09260002
* HEX TO BINARY VALUE CONVERSION ROUTINE.                             * 09280002
*********************************************************************** 09300002
         SPACE                                                          09320002
HEXVAL   EQU   *                                                        09340002
         L     R0,ZERO(R3)             R0=ADDRESS VALUE.                09360002
         BAL   R14,HEXBIN              CONVERT HEX TO BINARY.           09380002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          09400002
         MVC   ZERO(FOUR,R3),ONE(R2)   BINARY VALUE NOW IN WORKAREA.    09420002
         L     R4,ZERO(R3)             R4=BINARY VALUE.                 09440002
         SR    R6,R6                   R6=0                             09460002
         IC    R6,ZERO(R2)             R6=LENGTH OF BINARY VALUE.       09480002
         LA    R7,FOUR                 R7=4.                            09500002
         SR    R7,R6                   R7=4-LENGTH OF BINARY.           09520002
         SLL   R7,THREE                R7=R7X8.                         09540002
         SRL   R4,ZERO(R7)             R4=VALUE RIGHT JUSTIFIED.        09560002
         B     TESTSIGN                CHECK FOR + OR - SIGN.           09580002
         SPACE                                                          09600002
*********************************************************************** 09620002
* THE FOLLOWING INSTRUCTIONS CONVERTS A SYMBOLIC ADDRESS FROM         * 09640002
* PRINTABLE CHARACTERS TO IT BINARY VALUE.  THIS CONVERSION IS DONE   * 09660002
* BY USING THE SYMBOLIC CONVERSION OF IKJEGSYM.                       * 09680002
*********************************************************************** 09700002
         SPACE                                                          09720002
SYMFOUND EQU   *                                                        09740002
         SPACE                                                          09760002
* CHECK LENGTH FOR MORE THAN 8 BYTES.                                 * 09780002
         SPACE                                                          09800002
         CLI   PDELEN3+ONE,LENSYM      Q.IS SYMBOL GT 8 CHARACTERS.     09820002
         BH    SYMERROR                YES,WRITE ERROR MESSAGE.         09840002
         BAL   R10,SYMLINK             GO CALL IKJEGSYM.                09860002
         LTR   R15,R15                 Q.IS THE RC=0.                   09880002
         BNZ   RETURN                  RETURN TO CALLER.                09900002
         SPACE                                                          09920002
*********************************************************************** 09940002
* THIS SECTION OF CODE GET THE BINARY ADDRESS FROM IKJEGSYM AND MOVES * 09960002
* IT INTO THE ADDRESS SAVE AREA.                                      * 09980002
*********************************************************************** 10000002
         SPACE                                                          10020002
         L     R2,PDEUSER              R2=ADDRESS OF SYMINFO.           10040002
         MVC   ZERO(FOUR,R3),ZERO(R2)  BINARY ADDRESS NOW IN WORKAREA.  10060002
         B     INDIRECK                CHECK FOR INDIRECKS.             10080002
         SPACE                                                          10100002
*********************************************************************** 10120002
* THIS SECTION OF CODE PUTS OUT AN ERROR MESSAGE INDICATING THAT THE  * 10140002
* LENGTH OF THE SYMBOLIC IS GREATER THAN EIGHT CHARACTERS.            * 10160002
*********************************************************************** 10180002
         SPACE                                                          10200002
SYMERROR EQU   *                                                        10220002
         LA    R4,MSG001               R4=ADDR OF MSG ID PARM LIST.     10240002
         B     RITERROR                WRITE ERROR MSG.                 10260002
         SPACE                                                          10280002
*********************************************************************** 10300002
* THIS SECTION OF CODE CHECKS TO DETERMINE IF THE ADDRESS COMPUTED IS * 10320002
* WITHIN THE MAXIMUM STORAGE AREA.                                    * 10340002
*********************************************************************** 10360002
         SPACE                                                          10380002
CORECK   EQU   *                                                        10400002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   10402002
*        BAL TO AN ADDRESS VALIDITY CHECK R3 = ADDR TO BE CHECKED   *   10404002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   10406002
         BAL   R10,ADDRVCK             IS THE ADDR VALID                10410002
         TM    PDEUSER,PDESIB          Q.ADDRES OF SYM INFO NEEDED.     10420002
         BO    NOCORECK                YES,SKIP CORE CHECK.             10440002
         MVC   PDEUSER+ONE(THREE),ONE(R3) ADDR NOW IN USERWORD.         10540002
         SPACE                                                          10560002
NOCORECK EQU   *                                                        10580002
         SR    R15,R15                 RC=0.                            10600002
         SPACE                                                          10620002
*********************************************************************** 10640002
* THIS SECTION CHECKS TO DETERMINE IF A RANGE OF ADDRESSES HAVE BEEN  * 10660002
* REQUESTED.  A CHECK IS MADE FIRST TO DETERMINE IF A RANGE IS        * 10680002
* POSSIBLE.  THE NEXT CHECK WILL DETERMINE IF A RANGE WAS SPEDIFIED.  * 10700002
* THE FIRST WORD OF THE SECOND PDL IS TESTED FOR ZEROES, WHICH        * 10720002
* INDICATES THAT THE RANGE WAS NOT SPECIFIED.                         * 10740002
*********************************************************************** 10760002
         SPACE                                                          10780002
         TM    TSTFLGS1,RANGESW        Q.IS A RANGE POSSIBLE.           10800002
         BZ    RETURN                  NO,RETURN                        10820002
         SPACE                                                          10840002
* A RANGE IS POSSIBLE.  TURN SWITCH OFF AND CHECK FOR A RANGE.        * 10860002
         SPACE                                                          10880002
         NI    TSTFLGS1,HEXFF-RANGESW  TURN RANGE SWITCH OFF.           10900002
         LA    R1,PDECHAIN             R1=ADDRESS OF SECOND PDL.        10920002
         NC    ZERO(TWO8,R1),ZERO(R1)  Q.RANGE SPECIFIED.               10940002
         BZ    RETURN                  NO,RETURN                        10960002
         LR    R8,R1                   BUMP ADDRESSABILITY.             10980002
         B     TOBIN                   CONVERT 2ND ADDRESS.             11000002
         SPACE                                                          11020002
*********************************************************************** 11040002
* THE FOLLOW INSTRUCTION ANALYZE THE NON-ZERO RETURN CODE TO          * 11060002
* DETERMINE WHY THE CONVERSION FAILED.  THE RETURN CODE PASSED        * 11080002
* TO THE CALLING ROUTINE WILL REFLECT THE RESMIT OF THE ANALYSIS.     * 11100002
*********************************************************************** 11120002
         SPACE                                                          11140002
         LA    R15,FOUR                SET RETURN CODE=4.               11160002
         B     RETURN                  RETURN TO CALLER.                11180002
         SPACE                                                          11200002
*********************************************************************** 11220002
*   THE NEXT SECTION OF CODE VARIFIES AN ADDRESS PASSED IN R3           11240002
*   IT INVOKES SVC 97, (IKJEGS9G)                                       11260002
*********************************************************************** 11280002
         SPACE                                                          11300002
ADDRVCK  DS    0H                      CHECK OUT THE ADDRESS            11320002
         SPACE                                                          11340002
         L     R6,PPTCB                R6= ADDR OF THE PROBLEM PROG TCB 11360002
         USING CVTWORK,R3              EST ADDR'IBILITY TO WORK AREA    11380002
         ST    R1,NUM4                 SAVE THE CONTENTS OF R1          11400002
         L     R2,ZERO(R3)             R2= ADDR TO BE CHECKED           11420002
         LA    R2,ZERO(R2)             ZERO HIGH ORDER BYTE             11430002
         IKJEGS9G ADDRCHK,TCBADDR=(R6),VALUE=(R2),MF=(E,NUM3)           11440002
         L     R1,NUM4                 RESTORE THE CONTENTS OF REG1     11460002
         LTR   R15,R15                 IS THE ADDRESS VALID             11480002
         BNZ   OUTCORE                 NO THE ADDRESS IS OUT OF REGION  11500002
         OI    PDEFLG5,PDEWRITE        SWITCH ON THE WRITE FLAG IN PDE  11510002
         DROP  R3                      RELEASE ADDR'IBILITY TO WORKAREA 11520002
         BR    R10                     RETURN TO CALLER VALID ADDRESS   11540002
         SPACE                                                          11560002
ENTNAME  EQU   *                                                        11580002
         LA    R10,ENDLINK             R14=CALLER ADDRESS.              11600002
         SPACE                                                          11620002
*********************************************************************   11640002
*        THIS SUBROUTINE DOES THE LINK TO SYM. REGISTER 1 POINTS TO *   11660002
*        THE PDE ON ENTRY                                           *   11680002
*********************************************************************   11700002
         SPACE                                                          11720002
SYMLINK  DS    0H                      LINK TO IKJEGSYM                 11740002
         LINK  EP=IKJEGSYM,MF=(E,(1)),ERRET=ERRET2 LINK WITHOUT BLDL    11760002
IKJEGBL1 EQU   *                                                        11780002
SMTSYM1  DS    0H                      SMT TESTCASE LABEL               11800002
*                                       LINK TO SYM FAILED              11820002
*                                       TESTCASE ID  TTSTC120           11840002
*                                       TESTCASE ID  TEQU5300           11860002
         BR    R10                     RETURN TO CALLER.                11880002
*                                                                       11890002
*                                                                       11892002
ERRET2   LR    R0,R1              PUT ABEND CODE IN REG0                11894002
         LA    R2,@6              GET 'LINK' SVC NUMBER                 11898002
         B     SVCERR1            GO ISSUE MESSAGES                     11898402
ENDLINK  EQU   *                                                        11900002
         LTR   R15,R15                 Q.RC=0.                          11920002
         BNZ   RETURN                  RETURN TO CALLER.                11940002
         TM    PDEFLG5,PDESIB          IS THIS A SIB POINTER            11950002
         BO    ENDLK2                  YES THEREFORE CHECK THAT ADDR    11952002
         MVC   ZERO(FOUR,R3),PDEUSER   ADDR TO BE CHECKED IN WORKA      11954002
         B     ENDLK3                  CHECK ADDR                       11956002
ENDLK2   DS    0H                      CHECK THE ADDR IN SIB BLK        11958002
         L     R6,PDEUSER              R6= ADDR OF THE SIB BLK          11958402
         MVC   ZERO(FOUR,R3),ZERO(R6)  ADDR TO BE CHECKED TO WORKA      11958802
ENDLK3   DS    0H                      GO TO THE VALIDITY CHECKER       11959202
         BAL   R10,ADDRVCK             IS THE ADDR VALID                11959602
         B     NOCORECK                CHECK FOR RANGE.                 11960002
         SPACE                                                          11980002
*********************************************************************** 12000002
*                                                                     * 12020002
*        THE FOLLOWING INSTRUCTIONS CONVERTS AN ADDRESS FROM          * 12040002
*        ITS BINARY FORMAT TO ITS PRINTABLE FORMAT.                   * 12060002
*                                                                     * 12080002
         SPACE                                                          12100002
FROMBIN  EQU   *                                                        12120002
         SPACE                                                          12140002
* THE TEST UNDER MASK ROUTES CONTROL TO THE PROPER CONVERSION CODE.   * 12160002
         SPACE                                                          12180002
         TM    PDEFLG4,ABSCOMPL        Q.IS BINARY TO BE ABSOLUTE ADDR. 12200002
         BZ    BINABT                  YES,CONVERT TO ABSOLUTE ADDR.    12220002
         TM    PDEFLG4,RELADDR         Q.IS BINARY TO BE A REL ADDR.    12240002
         BO    BINREL                  YES,CONVERT TO RELATIVE ADDR.    12260002
         SPACE                                                          12280002
*********************************************************************** 12300002
* THIS SECTION OF CODE CONVERTS BINARY TO REGISTER NOTATION. IF THE   * 12320002
* REGISTER IS A GENERAL PURPOSE REGISTER IT PRINTABLE VALUE WILL      * 12340002
* HAVE CHARACTER  -R-    FOLLOWING IT. IF IT IS A FLOATING POINT      * 12360002
* REGISTER THE LETTER -D- OR -E- WILL FOLLOW DEPENDING IF IT IS A     * 12380002
* SINGLE OR DOUBLE PRECISION.                                         * 12400002
*********************************************************************** 12420002
         SPACE                                                          12440002
         L     R5,PDEADRPT             R5=ADDR OF INPUT STRING.         12460002
         SR    R6,R6                   R6=0.                            12480002
         IC    R6,REGIN(R5)            R6=ADDR STRING.                  12500002
         CVD   R6,ZERO(R3)             REGISTER NOW PACKED DECIMAL.     12520002
         OI    SEVEN(R3),SIGNF         CHANGE SIGN TO X'F'.             12540002
         UNPK  ZERO(TWO,R3),SIX(TWO,R3) REGISTER NOW IN PRINTABLE FORM. 12560002
         SPACE                                                          12580002
*********************************************************************** 12600002
* THE FOLLOWING INSTRUCTION WHICH TYPE OF REGISTER HAS BEEN SPECIFIED * 12620002
* AND BRANCHES TO TO PROPER CODE TO MOVE IN THE PROPER LETTERS(R,RE,  * 12640002
* OR RD).                                                             * 12660002
*********************************************************************** 12680002
         SPACE                                                          12700002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       12720002
         MVC   ONE(TWO,R2),ZERO(R3)    MOVE ADDR INTO OUTPUT AREA       12740002
         SR    R15,R15                 RC=0.                            12760002
         MVI   ZERO(R2),THREE          MOVE LENGTH INTO CONAREA.        12780002
         TM    PDEFLG4,DOBMASK         Q.IS REGISTER DOUBLE PRECISION.  12800002
         BO    RDMOVE                  YES,MOVE IN D.                   12820002
         TM    PDEFLG4,SINMASK         Q.IS REGISTER SINGLE PRECISION.  12840002
         BO    REMOVE                  YES,MOVE IN E.                   12860002
         SPACE                                                          12880002
*********************************************************************** 12900002
* THE FOLLOWING WILL ALTER THE REG VALUE BY HAVING A (R) FOLLOWING    * 12920002
* IT.                                                                 * 12940002
*********************************************************************** 12960002
         SPACE                                                          12980002
         MVI   THREE(R2),RSIGN         APPEND -R- TO END OF OUTPUT.     13000002
         CLI   ONE(R2),F0              Q.IS FIRST BYTE A HEX -F0-.      13020002
         BNE   RETURN                  NO,RETURN TO CALLER.             13040002
         MVI   ONE(R2),BLANK           BLANK NOW IN FIRST BYTE.         13060002
         B     RETURN                  RETURN TO CALLER.                13080002
         SPACE                                                          13100002
*********************************************************************** 13120002
* THIS SECTION OF CODE ALTERS THE REGISTER VALUE BY APPENDING A (RD)  * 13140002
* TO THE END OF IT AND MOVE THE OUTPUT INTO CONVAREA.                 * 13160002
*********************************************************************** 13180002
         SPACE                                                          13200002
RDMOVE   EQU   *                                                        13220002
         MVC   ONE(ONE,R2),ONE(R3)     REG NUMBER NOW IN CONAREA.       13240002
         MVI   TWO(R2),RDSIGN          MOVE D TO RIGHT OF OUTPUT.       13260002
         MVI   ZERO(R2),TWO            MOVE LENGTH INTO CONAREA.        13280002
         B     RETURN                  RETURN TO CALLER.                13300002
*********************************************************************** 13320002
* THIS SECTION FO CODE ALTERS THE REGISTER VALUE BY PPPENDING A "RE"  * 13340002
* TO THE END OF IT AND MOVES THE OUTPUT INTO CONAREA.                   13360002
*********************************************************************** 13380002
         SPACE                                                          13400002
REMOVE   EQU   *                                                        13420002
         MVC   ONE(ONE,R2),ONE(R3)     MOVE REGISTER INTO CONAREA.      13440002
         MVI   TWO(R2),RESIGN          MOVE R TO RIGHT OF OUTPUT.       13460002
         MVI   ZERO(R2),TWO            MOVE LENGTH INTO CONAREA.        13480002
         B     RETURN                  RETURN TO CALLER.                13500002
         SPACE                                                          13520002
*********************************************************************** 13540002
* THIS SECTION OF CODE CONVERTS BINARY TO IT ABSOLUTE FORMAT. THE     * 13560002
* OUTPUT IS STORED IN CONAREA.                                        * 13580002
*********************************************************************** 13600002
         SPACE                                                          13620002
BINABT   EQU   *                                                        13640002
         LA    R7,ZERO                 R7=0.                            13660002
         L     R2,PDEADRPT             R2=ADDRESS OF INPUT STRING.      13680002
         LA    R6,SIX                  R6=LENGTH,6.                     13700002
         MVC   ZERO(FOUR,R3),ZERO(R2)  INPUT NOW IN WORKAREA.           13720002
         L     R5,ZERO(R3)             R5=INPUT STRING.                 13740002
         SLL   R5,EIGHT                ISOLATE LOW ORDER 3 BYTES.       13760002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              13780002
         LA    R0,NINE                 R0=9.                            13800002
NEXTBITS EQU   *                                                        13820002
         SR    R4,R4                   R4=0.                            13840002
         SLDL  R4,FOUR                 ISOLATE 4 BITS.                  13860002
         CR    R4,R0                   Q.ARE BITS GT 9.                 13880002
         BH    ADDRHI                  YES.                             13900002
         SPACE                                                          13920002
* THE 4 BITS ARE NUMERIC. MAKE PRINTABLE BY ADDING X'F0'.             * 13940002
         SPACE                                                          13960002
         LA    R4,F0(R4)               R4=PRINTABLE BYTE.               13980002
BYTEMOVE EQU   *                                                        14000002
         STC   R4,ONE(R2)              PUT BYTE INTO CONAREA.           14020002
         LA    R2,ONE(R2)              R2=ADDR OF NEXT OUTPUT AREA.     14040002
         LA    R7,ONE(R7)              INCREMENT BYTE COUNTER.          14060002
         CR    R7,R6                   Q.ARE THERE MORE BITS.           14080002
         BNE   NEXTBITS                YES,GET NEXT 4 BITS.             14100002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           14120002
         MVI   ZERO(R2),LEN7           MOVE LENGTH INTO CONAREA.        14140002
         MVI   SEVEN(R2),PERIOD        APPEND -.- TO END OF OUTPUT.     14160002
         SR    R15,R15                 SET RC=0.                        14180002
         B     RETURN                  RETURN TO CALLER.                14200002
         SPACE                                                          14220002
* THE 4 BITS AREA ALPHABETIC. CONVERT PRINTABLE BY ADDING X'B7'.      * 14240002
         SPACE                                                          14260002
ADDRHI   EQU   *                                                        14280002
         LA    R4,B7(R4)               R4=PRINTABLE BYTE.               14300002
         B     BYTEMOVE                MOVE BYTE OF OUTPUT TO CONAREA.  14320002
         SPACE                                                          14340002
*********************************************************************** 14360002
* THIS SECTION OF CODE CONVERTS BINARY TO A RELATIVE ADDRESS. THE     * 14380002
* OUTPUT IS STORED IN CONAREA                                         * 14400002
*********************************************************************** 14420002
         SPACE                                                          14440002
BINREL   EQU   *                                                        14460002
         TM    PDEFLG2,CTNAMFLG        Q.IS QUALIFY SPECIFIED.          14480002
         BZ    GETPP                   NO,GET ADDRESS FROM PPLOAD.      14500002
         L     R2,PPTEMP               R2=BASE FOR RELATIVES.           14520002
BASEMOVE EQU   *                                                        14540002
         L     R4,PDEADRPT             R4=ADDRESS OF INPUT STRING.      14560002
         MVC   ZERO(FOUR,R3),ZERO(R4)  GET INPUT STRING.                14580002
         L     R4,ZERO(R3)             R4=INPUT STRING.                 14600002
         SR    R4,R2                   R4=REALTIVE VALUE IN BINARY.     14620002
         ST    R4,ONE6(R3)             PUT INPUT INTO FAKE PDE.         14640002
         LA    R4,ONE6(R3)             R4=ADDRESS OF INPUT VALUE.       14660002
         ST    R4,EIGHT(R3)            ADDRESS IN FAKE VALUE PDE.       14680002
         LA    R5,FOUR                 R5=A LENGTH OF FOUR.             14700002
         STH   R5,ONE2(R3)             MOVE LENGTH INTO PDE.            14720002
         LA    R1,EIGHT(R3)            R1=ADDRESS OF FAKE PDE.          14740002
         BAL   R14,BINHEX              LINK TO BINHEX RT.               14760002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           14780002
         LA    R2,ONE(R2)              R2=ADDRESS OF OUTPUT STRING.     14800002
         LA    R5,SEVEN                R5=7.                            14820002
F0CHECK  EQU   *                                                        14840002
         CLI   ZERO(R2),F0             Q.IS BYTE FIRST VALID CHAR.      14860002
         BNE   ONEF0                   YES,FORMAT OUTPUT.               14880002
         LA    R2,ONE(R2)              ADVANCE POINTER.                 14900002
         BCT   R5,F0CHECK              CHECK LAST DITIT.                14920002
ONEF0    EQU   *                                                        14940002
         EX    R5,RELMOVE              MOVE REL INTO WORKAREA.          14960002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           14980002
         MVI   ZERO(R2),BLANK          BLANK IN FIRST BYTE OF CONAREA.  15000002
         MVC   ONE(FIVE,R2),ZERO(R2)   CONAREA NOW HAS SIX BLANKS.      15020002
         MVI   ZERO(R2),SEVEN          LENGTH NOW IN CONAREA.           15040002
         LA    R6,SIX                  R6=6.                            15060002
         SR    R6,R5                   R6=OFFSET IN CONAREA.            15080002
         LA    R2,ONE(R6,R2)           R2=ADDR OF OUTPUT LOCATION.      15100002
         EX    R5,REL4MAT              MOVE OUTPUT INTO CONAREA.        15120002
         BCTR  R2,ZERO                 R2=ADDR OF BYTE BEFORE 1ST DIGIT 15140002
         MVI   ZERO(R2),PLUS           PRECEDE OUTPUT WITH A PLUS SIGN. 15160002
         SR    R15,R15                 RC=0.                            15180002
         B     RETURN                  RETURN TO CALLER.                15200002
RELMOVE  MVC   ZERO(ONE,R3),ZERO(R2)   MOVE REL INTO WORKAREA.          15220002
REL4MAT  MVC   ZERO(ONE,R2),ZERO(R3)   MOVE REL OUTPUT INTO CONAREA.    15240002
OUTCORE  EQU   *                                                        15260002
         LA    R2,EIGHT                CHECK FOR RETURN CODE FOUR       15270002
         CR    R15,R2                  RC=8 FROM SVC97?                 15272002
         BNL   OUTCORE2                CONTINUE WITH ERROR MSG          15272402
         NI    PDEFLG5,HEXFF-PDEWRITE  TURN OFF THE PDE WRITE SW        15274402
         BR    R10                     RETURN & CONTINUE ADDR MAYBE OK  15274802
OUTCORE2 DS    0H                      CONTINUE WITH ERROR MESSAGE      15276002
         LA    R4,MSG002               R4=ADDR OF MSG ID LIST.          15280002
RITERROR EQU   *                                                        15300002
ERRORPK  EQU   *                                                        15350002
         L     R6,@4(R4)              GET SECOND LEVEL MSG ID           15690002
         L     R4,@0(R4)              GET 1ST LEVEL MSG ID              15692002
         XC   TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR REMOTE LIST AREA     15694002
         LTR   R6,R6                  DOES SECOND LEVEL EXIST           15694402
         BZ    MACRO2                 NO - USE SECOND FORM OF IO MACRO  15694802
*                                     WE MUST BE ISSUING MSG003         15695202
         IKJEGSIO MSG,FIRST=(R4),INST11=(APDE,(R8)),SECOND=(R6),       *15696002
               ID=CVT09,MF=(E,TSTIOPRM)                                 15698002
CHECKIO  SR    R4,R4                   CLEAR REG 4                      15708002
         LA    R4,@12(R4)             PREPARE TO CHECK FOR RC > 12      15718002
         CR    R15,R4                  IS RC > 12                       15718402
         BH    RETURN                  IF SO, RETURN                    15740002
         LA    R15,FOUR                R15=RC OF 4.                     15760002
         B     RETURN                  RESTORE CALLER REGISTERS.        15780002
MACRO2   IKJEGSIO MSG,FIRST=(R4),ID=CVT09,MF=(E,TSTIOPRM)               15790002
         B     CHECKIO                GO CHECK IO RETURN CODE           15800002
GETPP    EQU   *                                                        15820002
         L     R2,PPLOAD               R2=CURRENT BASE FOR RELATIVES.   15840002
         B     BASEMOVE                MOVE IN INPUT STRING.            15860002
SVCERR1  LR    R3,R1              SET ABEND CODE FOR ABENDREG           15870002
         LR    R4,R15             SET RETURN CODE                       15872002
         XC    TSTOIPRM(L'TSTOIPRM),TSTOIPRM CLEAR REMOTE PARM LIST     15874002
         LTR   R0,R0              IS THERE AN ABEND CODE FOR ABENDREG   15876002
         BZ    SVCERR2            IF R0=0, USE SVCERR2 FORM OF IO-MACRO 15878002
*                                                                       15878402
         IKJEGSIO SVCERR,SVC=(R2),RC=(R4),ABENDRG=(R3),MF=(E,TSTOIPRM),*15878802
               ID=CVT09,INST11=(NUM,I0034)                              15878902
         LA    R14,RETURN         INDICATE THAT SCB MUST BE REMOVED     15879002
         B     SVCRET             GO SET PROPER RETURN CODE             15879202
*                                                                       15879602
SVCERR2  IKJEGSIO SVCERR,SVC=(R2),RC=(R4),MF=(E,TSTOIPRM),             *15881102
               ID=CVT09                                                 15884602
         LA    R14,AFTERSCB     INDICATE THAT NO SCB IS TO BE REMOVED   15886002
*                                                                       15887402
SVCRET   SR    R1,R1              CLEAR REG1                            15888802
         LA    R1,@12(R1)         PUT 12 IN REG 1                       15890202
         CR    R15,R1             COMPARE RETURN CODE FROM IO WITH 12   15891602
         BNH   SETRC         IF R15 NOT > DEC 12, PASS RC TO CALLER     15893002
         BR    R14                PASS RETURN CODE TO CALLER            15894402
SETRC    SR    R15,R15            CLEAR R15 FOR RETURN CODE             15895802
         LA    R15,FOUR(R15)      SET RETURN = 4                        15897202
         BR    R14                GO RESTORE REG'S AND RETURN TO CALLER 15898602
*                                                                       15900002
RETRY    SR    R9,R9              SET REG 9 TO ZERO                     15902002
         L     R9,@16(R9)         POINT TO COM VECTOR TABLE             15904002
         L     R9,@0(R9)          POINT TO TASK CNTRL BLCK POINTERS     15906002
         L     R9,@4(R9)          POINT TO CURRENT TCB                  15906402
         L     R9,@20(R9)         POINT TO THE TCOMTAB                  15906502
         NI    TSTFLGS4,HEXFF-TSTRERTN   TURN OFF RETRY INDICATOR       15915202
         NI    TSTFLGS4,HEXFF-TSTVALCK   TURN OFF VALIDITY INDICATOR    15915602
         LA    R15,@20            INDICATE RETRY ROUTINE ENTERED        15917202
         L     R12,TSTCONVT       LOAD BASE REG                @ZA28933 15918203
         B     RETURN                                                   15919202
*                                                                       15919602
ABENDTAB DS    0F                                                       15921602
         DC    X'63'              LINK FAILED INSERT FOR ABEND MSG      15923602
         DC    AL3(SMTSYM1)                                             15925602
         DC    X'FF'                                                    15925702
*                                                                       15926002
MSG001   DC    F'101'             MESSAGE M0101 (INVALID ADDRESS)       15928002
         DC    F'281'             MESSAGE M0281 (EXCEEDS EIGHT)         15930002
MSG002   DC    F'101'             MESSAGE M0101 (INVALID ADDRESS)       15932002
         DC    F'218'             MESSAGE M0217 (PROTECTED CORE)        15934002
MSG003   DC    F'23'              MESSAGE M0101 (INVALID ADDRESS)       15936002
         DC    F'000'    NO 2ND LEVEL MESSAGE PRESENT                   15938002
LIST     IKJEGSPL RTRY=RETRY,ABNTB=ABENDTAB,MODNM=IKJEGCVT,            *15938402
               TNM=CONVERT                                              15938802
         TITLE 'IKJEGCVT VALUE CONVERSION ROUTINE.'                     15940002
*********************************************************************** 15940202
* THE FOLLOWING INSTRUCTION DETRRMINE IF THE VALUE CONVERSION IS TO   * 15946802
* BE TO OR FROM BINARY.                                               * 15953402
*********************************************************************** 15960002
         SPACE                                                          15980002
YHCODE   EQU   *                                                        16000002
         LA    R5,ONE                  R5=1. INDICATES H OR Y SPECIFIED 16020002
         B     NOTHORY                 BRANCH TO PROPER RTN.            16040002
         SPACE                                                          16060002
VALCVT   EQU   *                                                        16080002
         LTR   R0,R0                   Q.IS THE CONVERSION TO BINARY.   16100002
         BM    FROMBI                  NO,CONVERT VALUE TO PRINTABLE.   16120002
         SPACE                                                          16140002
*********************************************************************** 16160002
* THE FOLLOWING INSTRUCTIONS CONVERTS A VALUE FROM PRINTABLE     *      16180002
* CHARACTERS TO ITS BINARY FORMAT.                                    * 16200002
*********************************************************************** 16220002
         SPACE                                                          16240002
         SR    R5,R5                   R5=O. NOT H OR Y SWITCH.         16260002
         CLI   SEVEN(R1),HCODE         Q.H SPECIFIED.                   16280002
         BE    YHCODE                  YES,SET H OR Y SWITCH.           16300002
         CLI   SEVEN(R1),YCODE         Q.Y SPECIFIED.                   16320002
         BE    YHCODE                  YES,SET H OR Y SWITCH.           16340002
         SPACE                                                          16360002
*********************************************************************** 16380002
* THE FOLLOWING BRANCH ROUTINE ROUTES CONTROL TO THE DIFFERENT TYPES  * 16400002
* OF CONVERSIONS.                                                     * 16420002
*********************************************************************** 16440002
         SPACE                                                          16460002
NOTHORY  EQU   *                                                        16480002
         SR    R6,R6                   R6=0.                            16500002
         IC    R6,SEVEN(R1)            R6=TYPE CODE IN HEX.             16520002
         L     R15,ACONLST(R6)         R15=ADDRESS OF CVT RTN.          16540002
         BALR  R14,R15                 GOTO PROPER CONVERT RTN.         16560002
         USING BASEADDR,R14            R14=TEMP BASE REGISTER.          16580002
BASEADDR EQU   *                                                        16600002
         L     R12,CVTBASE             R12=ADDR OF IKJEGCVT.            16620002
         DROP  R14                     R14 NO LONGER BASE REGISTER.     16640002
RETURN   EQU   *                                                        16660002
         LR    R2,R15                  PRESERVE REG 15                  16662002
         ESTAE 0                       REMOVE 'SCB'                     16670002
         LR    R15,R2                  RESTORE REG15                    16672002
AFTERSCB L     R13,FOUR(R13)           R13=ADDR OF CALLER SAVE AREA.    16680002
         RETURN (14,12),,RC=(15)       RESTORE CALLERS REGISTERS.       16700002
         SPACE                                                          16720002
BINBIN   EQU   *                                                        16740002
         SPACE                                                          16760002
*********************************************************************** 16780002
*                                                                     * 16800002
*        THIS ROUTINE CONVERTS PRINTABLE BYTES OF THE BINARY        *   16820002
*        FORMAT INTO ITS ONE BIT BINARY VALUE.                        * 16840002
*                                                                     * 16860002
*********************************************************************** 16880002
         SPACE                                                          16900002
         SR    R8,R8                   R8=0.                            16920002
         IC    R8,VALLEN(R1)           R8=LENGTH OF INPUT.              16940002
         LA    R0,EIGHT                R0=8.                            16960002
         SR    R7,R7                   R7=0.                            16980002
         SR    R6,R6                   R6=0.                            17000002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       17020002
         LA    R2,ONE(R2)              R2=OUTPUT AREA PLUS 1.           17040002
         L     R3,ZERO(R1)             R3=ADDRESS OF INPUT STRING.      17060002
         SR    R1,R1                   R1=0.                            17080002
INIT     EQU   *                                                        17100002
         LA    R5,ONE                  R5=1                             17120002
         LCR   R5,R5                   R5=32 BINARY ONES.               17140002
         SR    R4,R4                   R4=0.                            17160002
NEXTBYTE TM    ZERO(R3),F1             Q.IS THE BYTE A ONE.             17180002
         BO    AONE                    YES,MOVE IN AN ON BIT.           17200002
         SLL   R4,ONE                  MOVE IN A ZERO.                  17220002
         B     SKIPONE                 SKIP ONES ROUTINE.               17240002
AONE     EQU   *                                                        17260002
         SLDL  R4,ONE                  MOVE IN ONE ON BIT.              17280002
SKIPONE  EQU   *                                                        17300002
         LA    R3,ONE(R3)              INCREMENT INPUT ADDRESS.         17320002
         LA    R6,ONE(R6)              INCREMENT SAVE BYTE COUNTER.     17340002
         LA    R7,ONE(R7)              INCREMENT BYTE COUNTER.          17360002
         CLR   R0,R7                   BYTE COUNT=8.                    17380002
         BNE   NOT8                    NO,COMPARE SAVE COUNT TO LENGHT. 17400002
         SR    R7,R7                   RE-INITIATE BYTE COUNT.          17420002
         STC   R4,ZERO(R2)             MOVE BYTE INTO CONAREA.          17440002
         LA    R1,ONE(R1)              INCREMENT LENGTH COUNTER.        17460002
         LA    R2,ONE(R2)              INCREMENT CONAREA POINTER        17480002
NOT8     CLR   R6,R8                   LENGTH=SAVE,BYTE COUNT.          17500002
         BE    BYTESEND                MOVE BYTE INTO CONAREA.          17520002
         LTR   R7,R7                   BYTE COUNT=0.                    17540002
         BZ    INIT                    YES,CHECK NEXT EIGHT BYTES.      17560002
         B     NEXTBYTE                GET NEXT BYTE.                   17580002
BYTESEND EQU   *                                                        17600002
         LTR   R7,R7                   BYTE COUNT=0.                    17620002
         BZ    NOOUT                   YES,OUTPUT IS IN OUTPUT AREA.    17640002
         LA    R8,EIGHT                R8=8.                            17660002
         SR    R8,R7                   R7=NUMBER OF LEADING ZEROS.      17680002
         SLL   R4,ZERO(R8)             LEFT JUSTIFY OUTPUT              17700002
         STC   R4,ZERO(R2)             MOVE OUTPUT INTO CONAREA.        17720002
         LA    R1,ONE(R1)              R1=LENGTH OF OUTPUT PLUS 1.      17740002
NOOUT    EQU   *                                                        17760002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       17780002
         STC   R1,ZERO(R2)             PUT OUTPUT LENGTH INTO CONAREA.  17800002
         SR    R15,R15                 SET RC=0.                        17820002
         BR    R14                     RETURN TO CALLER.                17840002
PKBIN    EQU   *                                                        17860002
         SPACE                                                          17880002
*********************************************************************** 17900002
*                                                                     * 17920002
*        THIS ROUTINE CONVERTS PRINTABLE CHARACTERS TO PACKED         * 17940002
*        DECIMAL.                                                     * 17960002
*                                                                     * 17980002
*********************************************************************** 18000002
         SPACE                                                          18020002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          18040002
         L     R4,WORKAREA             R4=ADDRESS OF WORKAREA.          18060002
         LH    R6,FOUR(R1)             R6=LENGTH OF INPUT.              18080002
         L     R3,ZERO(R1)             R3=ADDRESS OF INPUT STRING.      18100002
         LR    R8,R3                   R8=ADDR OF INPUT STRING.         18120002
         SPACE                                                          18140002
*        THIS SECTION OF CODE CHECKS FOR A SIGN.                      * 18160002
         SPACE                                                          18180002
         CLI   ZERO(R3),SIGNNEG        Q.IS SIGN NEGATIVE.              18200002
         BE    ADDADDR                 YES.                             18220002
         CLI   ZERO(R3),PLUSSIGN       Q.IS SIGN POSITIVE.              18240002
         BNE   NOSIGN                  YES.                             18260002
ADDADDR  LA    R3,ONE(R3)              R3=ADDRESS OF INPUT MINUS SIGN.  18280002
         BCTR  R6,ZERO                 DECREMENT LENGTH.                18300002
NOSIGN   EQU   *                                                        18320002
         CLI   FIVE(R1),ONE6           Q.LENGTH GT 16.                  18340002
         BH    PKLG                    YES.                             18360002
         SPACE                                                          18380002
*********************************************************************** 18400002
*                                                                     * 18420002
*        THIS SECTION OF CODE CONVERTS TO PACK THE VALUE LESS THAN    * 18440002
*        SEVENTEEN BYTES.                                             * 18460002
*                                                                     * 18480002
*********************************************************************** 18500002
         SPACE                                                          18520002
         LR    R7,R6                   R7=LENGTH OF INPUT.              18540002
         SRL   R6,ONE                  R6=LENGTH DIVIDED BY 2.          18560002
         SLL   R6,FOUR                 R6=L1                            18580002
         BCTR  R7,ZERO                 R7=EXECUTE INPUT LENGTH.         18600002
         OR    R6,R7                   R6=L1 AND L2.                    18620002
         EX    R6,PACK4                INPUT STRING IS NOW PACKED DEC.  18640002
         SRL   R6,FOUR                 ISOLATE LENGTH OF OUTPUT.        18660002
         LA    R6,ONE(R6)              R6=EXACT LENGTH OF PACKED DEC.   18680002
         STC   R6,ZERO(R2)             MOVE LENGTH INTO CONAREA.        18700002
         LA    R3,ZERO(R6,R4)          R3=ADDRESS OF LAST OUTPUT BYTE.  18720002
         BCTR  R3,ZERO                 *                                18740002
         CLI   ZERO(R8),SIGNNEG        Q.INPUT NEGATIVE.                18760002
         BNE   NO                      NO,MOVE IN POSITIVE SIGN.        18780002
         MVN   ZERO(ONE,R3),OFFSETD    MOVE IN NEG SIGN.                18800002
PKMOVE   EX    R6,OUTPUT               MOVE OUTPUT INTO CONAREA.        18820002
PKBEND   SR    R15,R15                 SET RETURN CODE.                 18840002
         BR    R14                     RETURN TO CALLING ROUTINE.       18860002
NO       EQU   *                                                        18880002
         MVN   ZERO(ONE,R3),OFFSETC    MOVE IN POSITIVE SIGN.           18900002
         B     PKMOVE                  MOVE OUTPUT INTO CONAREA.        18920002
PACK4    PACK  ZERO(ONE,R4),ZERO(ONE,R3)   INPUT NOW PACK DATA.         18940002
PKLG     EQU   *                                                        18960002
         STC   R6,ZERO(R4)             LENGTH NOW IN WORKAREA.          18980002
         TM    ZERO(R4),ODDLEN         Q.LENGTH ODD.                    19000002
         BO    LNODD                   YES,CONVERT ODD NUMBER OF BYTES. 19020002
         SPACE                                                          19040002
*********************************************************************** 19060002
*                                                                     * 19080002
*        THIS SECTION OF CODE CONVERTS AN EVEN NUMBER OF PRINTABLE    * 19100002
*        CHARACTERS TO PACKED DECIMAL.                                * 19120002
*                                                                     * 19140002
*********************************************************************** 19160002
         SPACE                                                          19180002
         PACK   ONE(NINE,R2),ZERO(ONE6,R3)  PACK FIRST 16 BYTES         19200002
         LA    R7,ONE6                 R7=16.                           19220002
         SR    R6,R7                   R6=LENGTH MINUS 16.              19240002
         LR    R7,R6                   R7=R6.                           19260002
         SRL   R6,ONE                  R6=LENGTH DIVIDED BY 2.          19280002
         BCTR  R7,ZERO                 R7=LENGTH FOR EXECUTE.           19300002
         SLL   R7,TWO8                 R7=LENGTH HIGH ORDER 4 BITS.     19320002
         SLDL  R6,FOUR                 R6=L1 AND L2 FOR EXECUTE.        19340002
         EX    R6,PACK2                PACK 2ND HALF OF INPUT STRING.   19360002
         SRL   R6,FOUR                 R6=LENGTH OUT PACKED DECIMAL.    19380002
         LA    R4,ZERO(R6,R4)          R4=ADDRESS OF SIGN BYTE.         19400002
         CLI   ZERO(R8),SIGNNEG        Q.SIGN NEGATIVE.                 19420002
         BNE   NO2                     NO,MOVE POSITIVE SIGN.           19440002
         MVN   ZERO(ONE,R4),OFFSETD    MOVE IN NEG SIGN.                19460002
MOVEZ    L     R4,WORKAREA             R4=ADDRESS OF WORKAREA.          19480002
         MVZ   ZERO(ONE,R4),NINE(R2)   MOVE ZONE BITS OF 1ST PACKED DEC 19500002
         EX    R6,OUTPUT2              MOVE 2ND PACKED INTO CONAREA.    19520002
         LA    R10,TEN(R6)             TOTAL LENGTH OF OUTPUT.          19540002
         STC   R10,ZERO(R2)            MOVE LENGTH INTO CONAREA.        19560002
         B     PKBEND                  SET RETURN CODE TO 0.            19580002
LNODD    EQU   *                                                        19600002
         SPACE                                                          19620002
*********************************************************************** 19640002
*                                                                     * 19660002
*        THIS  AREA OF CODE CONVERTS AN ODD NUMBER OF PRINTABLE       * 19680002
*        CHARACTERS TO PACKED DECIMAL.                                * 19700002
*                                                                     * 19720002
*********************************************************************** 19740002
         SPACE                                                          19760002
         PACK  ZERO(NINE,R4),ZERO(ONE6,R3) INPUT=PACKED DECIMAL FORMAT. 19780002
         XC    NINE(TWO,R4),NINE(R4)   ADD TWO BYTES OF ZEROS TO INPUT. 19800002
         NI    EIGHT(R4),AZERO         ALTER SIGN TO ZERO.              19820002
         MVO   ZERO(TEN,R4),ZERO(NINE,R4) SHIFT PACKED DEC 4 BITS.      19840002
         LA    R4,ONE(R4)              R4=ADDR OF PACKED DECIMAL.       19860002
         LA    R7,ONE6                 R7=169.                          19880002
         SR    R6,R7                   R6=LENGTH MINUS 16.              19900002
         LR    R7,R6                   R7=LENGTH MINUS 16.              19920002
         SRL   R6,ONE                  R6=LENGTH DIVIDED BY 2.          19940002
         BCTR  R7,ZERO                 R7=LENGTH DIVIDED BY 2 MINUS 1.  19960002
         SLL   R7,TWO8                 R7=LENGTH IN HIGH ORDER BYTE     19980002
         SLDL  R6,FOUR                 R6=L1 AND L2 FOR EXECUTE.        20000002
         EX    R6,PACK3                PACK 2ND HALF OF INPUT STRING.   20020002
         SRL   R6,FOUR                 R6=LENGTH OF PACKED DECIMAL.     20040002
         LA    R4,EIGHT(R6,R4)         R4=ADDR OF SIGN BYTE.            20060002
         CLI   ZERO(R8),SIGNNEG        Q.SIGN NEGATIVE.                 20080002
         BNE   POSITIVE                NO,MOVE POSITIVE SIGN.           20100002
         MVN   ZERO(ONE,R4),OFFSETD    MOVE IN NEG SIGN.                20120002
TLENGTH  LA    R6,NINE(R6)             R6=LENGTH OF OUTPUT              20140002
         STC   R6,ZERO(R2)             MOVE LENGTH INTO CONAREA.        20160002
         BCTR  R6,ZERO                 R6=LENGTH FOR EXECUTE.           20180002
         L     R4,WORKAREA             R4=ADDRESS OF WORKAREA.          20200002
         LA    R4,ONE(R4)              R4=ACTURAL ADDRESS OF INPUT      20220002
         B     PKMOVE                  MOVE OUTPUT INTO CONAREA.        20240002
POSITIVE EQU   *                                                        20260002
         MVN   ZERO(ONE,R4),OFFSETC    MOVE IN POSITIVE SIGN.           20280002
         B     TLENGTH                 GET LENGTH OF THE OUTPUT.        20300002
PACK3    PACK  EIGHT(ONE,R4),ONE6(ONE,R3)  PACK 2ND HALF OF INPUT.      20320002
OUTPUT   MVC   ONE(ONE,R2),ZERO(R4)    MOVE OUTPUT INTO CONAREA.        20340002
PACK2    PACK  ZERO(ONE,R4),ONE6(ONE,R3) PACK 2ND HALF OF STRING.       20360002
OUTPUT2  MVC   NINE(ONE,R2),ZERO(R4)   MOVE 2ND HALF INTO CONAREA.      20380002
NO2      EQU   *                                                        20400002
         MVN   ZERO(ONE,R4),OFFSETC    MOVEINNEG SIGN.                  20420002
         B     MOVEZ                   CONTINUE PROCESSING.             20440002
HEXBIN   EQU   *                                                        20460002
         SPACE                                                          20480002
*********************************************************************** 20500002
* THE FOLLOWING LINES OF CODE CONVERTS HEXADECIMAL BYTES TO BINARY.   * 20520002
* THIS ROUTINE CANNOT USE REGISTER 8, BECAUSE THE ADDRESS CONVERSION  * 20540002
* ROUTINE USES THIS ROUTINE AND REGISTER 8 IS THE PDE ADDRESSABILITY  * 20560002
* REGISTER.                                                           * 20580002
*********************************************************************** 20600002
         SPACE                                                          20620002
         L     R2,CONAREA              R2=CONVERT OUTPUT AREA ADDR.     20640002
         LH    R4,FOUR(R1)             R4=LENGTH OF INPUT.              20660002
         LR    R5,R4                   R5=LENGTH TO EXECUTE-TRANSLATE.  20680002
         BCTR  R5,ZERO                 DECREMENT LENGTH.                20700002
         L     R6,ZERO(R1)             R6=ADDRESS OF INPUT STRING.      20720002
         L     R3,WORKAREA             R3=ADDR OF TEMP. STORAGE         20740002
         EX    R5,SAFEMOVE             MOVE STRING INTO TEMP STORE      20760002
         LR    R6,R3                   R6=NEW STRING ADDR               20780002
         EX    R5,TRSLATE              TRANSLATE STRING                 20800002
         LR    R10,R4                  R10=HEX LENGTH                   20820002
         LA    R10,ONE(R10)            R10=LENGTH PLUS 1                20840002
         SRL   R10,ONE                 R10=LENGTH OF BINARY             20860002
         STC   R10,ZERO(R2)            STORE LENGTH FOR RETURN          20880002
         SLL   R10,FOUR                L1 TO HIGH END OF BYTE           20900002
         OR    R10,R4                  R10=L1 AND L2                    20920002
         EX    R10,PACK                CONVERT TO BINARY                20940002
         SR    R15,R15                 RETURN CODE=0.                   20960002
         BR    R14                     RETURN                           20980002
TRSLATE  TR    ZERO(ONE,R6),TRTABLE    ALTER PRINTABLES FOR CVT.        21000002
SAFEMOVE MVC   ZERO(ONE,R3),ZERO(R6)   INPUT NOW IN WORKAREA.           21020002
PACK     PACK  ONE(ONE,R2),ZERO(ONE,R6) INPUT NOW IN BINARY FORMAT.     21040002
         ORG   *-193                   BYPASS ZEROES IN TABLE.          21060002
TRTABLE  EQU   *                                                        21080002
         ORG   *+193                   RESET TABLE TO CORRECT IC.       21100002
         DC    X'FAFBFCFDFEFF'         *   TRANSLATE   TABLE          * 21120002
         DC    41X'00'                 *         FOR                  * 21140002
         DC    X'F0F1F2F3F4'           *    PRINTABLE HEXADECIMAL     * 21160002
         DC    X'F5F6F7F8F9'           *  TO BINARY ROUTINE.          * 21180002
         DC    C'ABCDEF'               *                              * 21200002
         DS    0H                      RESET TO HALFWORD BOUNDARY.      21220002
         SPACE                                                          21240002
*********************************************************************** 21260002
* THIS ROUTINE CONVERTS F,A,Q, AND V TYPE ADDRESSES TO BINARY.        * 21280002
* (R8 CAN NOT BE USE IN THIS ROUTINE.)                                * 21300002
*********************************************************************** 21320002
         SPACE                                                          21340002
FAQVBIN  EQU   *                                                        21360002
         LA    R7,ONE                  SET SWITCH.                      21380002
         L     R3,WORKAREA             R3=ADDR OF WORKAREA.             21400002
         LH    R2,FOUR(R1)             R2=PACK COUNT.                   21420002
         BCTR  R2,ZERO                 *                                21440002
         L     R4,ZERO(R1)             R4=ADDR OF INPUT STRING.         21460002
         CLI   ZERO(R4),SIGNNEG        Q.VALUE NEGATIVE.                21480002
         BE    NEGATIVE                YES,FLIP SWITCH NEGATIVE.        21500002
         CLI   ZERO(R4),PLUSSIGN       Q.PLUS SIGN ENTERED.             21520002
         BNE   NOSIGN2                 NO,DO NOT ACCOUNT FOR SIGN.      21540002
SIGN     EQU   *                                                        21560002
         LA    R4,ONE(R4)              INCREASE ADDR TO BYPASS SIGN.    21580002
         BCTR  R2,ZERO                 R2=1 LESS BECAUSE OF SIGN.       21600002
         B     NOSIGN2                 SKIP COMPLEMENT CODE.            21620002
NEGATIVE EQU   *                                                        21640002
         LCR   R7,R7                   FLIP SWITCH NEGATIVE.            21660002
         B     SIGN                    ALTER LENGTH.                    21680002
NOSIGN2  EQU   *                                                        21700002
         O     R2,ORREG                R2=L1 AND L2.                    21720002
         EX    R2,PACK1                CONVERT STRING TO PACKED DEC.    21740002
         LTR   R7,R7                   VALUE NEGATIVE                   21760002
         BH    POSIT                   NO,SKIP COMPLEMENT.              21780002
         MVN   SEVEN(ONE,R3),NEGSIGN   MAKE SIGN NEGATIVE.              21800002
POSIT    EQU   *                                                        21820002
         CVB   R4,ZERO(R3)             CONVERT INPUT TO BINARY.         21840002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          21860002
         LA    R2,ONE(R2)              R2=BYPASS LENGTH FIELD.          21880002
         SR    R15,R15                 RETURN CODE=0.                   21900002
         LTR   R5,R5                   Q.H OR Y TYPE SPECIFIED.         21920002
         BNZ   HORY                    YES,MOVE ONLY HALFWORD.          21940002
         ST    R4,ZERO(R2)             MOVE VALUE INTO OUTPUT AREA.     21960002
         BCTR  R2,ZERO                 R2=ADDR OF LENGTH BYTE.          21980002
         MVI   ZERO(R2),FOUR           MOVE LENGTH INTO OUTPUT AREA.    22000002
         BR    R14                     RETURN.                          22020002
HORY     EQU   *                                                        22040002
         STH   R4,ZERO(R2)             MOVE VALUE INTO OUTPUT AREA.     22060002
         BCTR  R2,ZERO                 R2=ADDR OF LENGTH BYTE.          22080002
         MVI   ZERO(R2),TWO            LENGTH NOW IN OUTPUT AREA.       22100002
         BR    R14                     RETURN TO CALLER.                22120002
PACK1    PACK  ZERO(ONE,R3),ZERO(ONE,R4) INPUT NOW PACKED DECIMAL.      22140002
         SPACE                                                          22160002
**********************************************************************  22180002
*        THE FOLLOWING INSTRUCTIONS WILL CONVERT PRINTABLE CHARACTERS * 22200002
*        TO BINARY IN THE SCON FORMAT.                                * 22220002
*********************************************************************** 22240002
         SPACE                                                          22260002
SCONBIN  EQU   *                                                        22280002
         L     R6,WORKAREA             R6=ADDR OF WORKAREA.             22300002
         L     R3,ZERO(R1)             R3=ADDR OF INPUT STRING.         22320002
         LH    R2,FOUR(R1)             R2=LENGTH OF INPUT.              22340002
         BCTR  R2,ZERO                 R2=EXECUTE LENGTH.               22360002
         EX    R2,SCONMOVE             MOVE INPUT INTO WORKAREA.        22380002
         LR    R3,R6                   R3=ADDR OF WORKAREA.             22400002
FINDOPEN EQU   *                                                        22420002
         LA    R3,ONE(R3)              R3=ADDR OF NEXT BYTE.            22440002
         CLI   ZERO(R3),OPEN           Q.OPEN PARENTHESIS FOUND.        22460002
         BNE   FINDOPEN                NO,CHECK NEXT BYTE.              22480002
         LR    R7,R3                   R7=ADDR OF OPEN PARENTHESIS.     22500002
         SR    R7,R6                   R7=LENGHT OF DISP.               22520002
         CLI   TWO(R3),CLOSE           Q.CLOSE PARENTHESIS FOUND.       22540002
         BNE   PACKTWO                 NO,PACK TWO BYTES.               22560002
         PACK  EIGHT(EIGHT,R6),ONE(ONE,R3) REGISTER NOW PACK DATA.      22580002
BINREG   EQU   *                                                        22600002
         CVB   R5,EIGHT(R6)            REG NOW BINARY DATA.             22620002
         SLL   R5,ONE2                 REG IN HI ORDER OF SECOND BYTE.  22640002
         SPACE                                                          22660002
* THE FOLLOWING LINES OF CODE CONVERTS THE DISP TO BINARY             * 22680002
         SPACE                                                          22700002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               22720002
         LA    R8,OUTLEN               R8=OUTPUT LENGTH.                22740002
         OR    R7,R8                   R7=LENGTH1 AND LENGTH2.          22760002
         EX    R7,PACKDATA             PACK THE ZONE DISP DATA.         22780002
         CVB   R8,EIGHT(R6)            DISP NOW BINARY DATA.            22800002
         OR    R5,R8                   R5=SCON IN BINARY.               22820002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              22840002
         MVI   ZERO(R2),TWO            LENGTH NOW IN CONAREA.           22860002
         LA    R2,ONE(R2)              R2=ADDR ONE PASS CONAREA.        22880002
         STH   R5,ZERO(R2)             SCON IN CONAREA.                 22900002
         SR    R15,R15                 RC=0.                            22920002
         BR    R14                     RETURN.                          22940002
PACKTWO  EQU   *                                                        22960002
         PACK  EIGHT(EIGHT,R6),ONE(TWO,R3) REGISTER NOW PACK DATA.      22980002
         B     BINREG                  CONVERT REGISTER TO BINARY.      23000002
SCONMOVE MVC   ZERO(ONE,R6),ZERO(R3)   INPUT NOW IN WORKAREA.           23020002
PACKDATA PACK  EIGHT(ONE,R6),ZERO(ONE,R6) DISP NOW PACK DATA.           23040002
         SPACE                                                          23060002
*********************************************************************** 23080002
* THE FOLLOWING INSTRUCTIONS CONVERTS A VALUE FROM BINARY TO ITS      * 23100002
* PRINTABLE FORMAT.                                                   * 23120002
*********************************************************************** 23140002
         SPACE                                                          23160002
HYCODE   EQU   *                                                        23180002
         LA    R5,ONE                  R5=1,INDICATES H OR Y SPECIFIED. 23200002
         B     NOHORY                  GET TYPE CODE.                   23220002
FROMBI   EQU   *                                                        23240002
         SR    R5,R5                   R5=0. NOT H OR Y SWITCH.         23260002
         CLI   SEVEN(R1),HCODE         Q.H SPECIFIED.                   23280002
         BE    HYCODE                  YES,SET H OR Y SWITCH.           23300002
         CLI   SEVEN(R1),YCODE         Q.Y CODE SPECIFIED.              23320002
         BE    HYCODE                  YES,SET H OR Y SWITCH.           23340002
NOHORY   EQU   *                                                        23360002
         SR    R6,R6                   R6=0                             23380002
         IC    R6,SEVEN(R1)            R6=TYPE CODE IN HEX.             23400002
         L     R15,ACONLST2(R6)        R15=ADDRESS OF CVT RTN.          23420002
         BALR  R14,R15                 GOTO PROPER CVT RTN.             23440002
         USING ADDRBASE,R14            R14=TEMP BASE REGISTER.          23460002
ADDRBASE EQU   *                                                        23480002
         L     R12,CVTBASE             R12=ADDR OF IKJEGCVT.            23500002
         DROP  R14                     R14,NO LONGER BASE REGISTER.     23520002
         B     RETURN                  RETURN TO CALLER.                23540002
         SPACE                                                          23560002
BINPK    EQU   *                                                        23580002
         SPACE                                                          23600002
*********************************************************************** 23620002
*                                                                     * 23640002
*        THIS ROUTINE CONVERTS PACKED DECIMAL DATA TO PRINTABLE       * 23660002
*        CHARACTERS.                                                  * 23680002
*                                                                     * 23700002
*********************************************************************** 23720002
         SPACE                                                          23740002
         LA    R8,BADPK                R8=HEX -09-.                     23760002
         SR    R6,R6                   R6=0.                            23780002
         L     R3,ZERO(R1)             R3=ADDRESS OF INPUT STRING.      23800002
         LH    R4,FOUR(R1)             R4=LENGTH OF INPUT.              23820002
         LR    R5,R3                   R5=ADDRESS OF INPUT STRING.      23840002
         LR    R2,R4                   R2=LENGTH OF INPUT.              23860002
NEXTPK   EQU   *                                                        23880002
         BCT   R2,BYTECK               CHECK FOR VALID PK DATA.         23900002
         IC    R6,ZERO(R5)             R5=LAST BYTE.                    23920002
         SRDL  R6,FOUR                 RISOLATE HIGH ORDER 4 BITS.      23940002
         CLR   R6,R8                   Q.IS HITH ORDER 4 BITS VALID.    23960002
         BH    PKERROR                 NO,WRITE ERROR MESSAGE.          23980002
         SRL   R7,LOWORDER             LOW ORDER 4 BITS ISOLATED.       24000002
         CLR   R7,R8                   Q.LOW ORDER 4 BITS VALID.        24020002
         BNH   PKERROR                 NO,WRITE ERROR MESSAGE.          24040002
         B     SKIPPKCK                SKIP PACK VALIDITY CHECK.        24060002
BYTECK   EQU   *                                                        24080002
         IC    R6,ZERO(R5)             R6=BYTE OF PACKED DATA.          24100002
         SRDL  R6,FOUR                 ISOLATE HIGH ORDER 4 BITS.       24120002
         CLR   R6,R8                   Q.HIGH ORDER 4 BITS VALID.       24140002
         BH    PKERROR                 NO,WRITE ERROR MESSAGE.          24160002
         SRL   R7,LOWORDER             LOW ORDER 4 BITS ISOLATED.       24180002
         CLR   R7,R8                   Q.LOW ORDER 4 BITS VALID.        24200002
         BH    PKERROR                 NO,WRITE ERROR MESSAGE.          24220002
         LA    R5,ONE(R5)              R5=ADDR OF NEXT BYTE.            24240002
         B     NEXTPK                  GET NEXT BYTE.                   24260002
SKIPPKCK EQU   *                                                        24280002
         LA    R6,ZERO(R4,R3)          R6=ADDR OF LAST BYTE OF INPUT.   24300002
         BCTR  R6,ZERO                 *                                24320002
         L     R2,WORKAREA             R2=ADDRESS OF WORKAREA.          24340002
         LA    R5,ZERO(R4,R2)          R5=ADDRESS OF SIGN BYTE.         24360002
         BCTR  R5,ZERO                 *                                24380002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               24400002
         EX    R4,MOVEPK               MOVE INPUT INTO WORKAREA.        24420002
         LA    R4,ONE(R4)              R4=CORRECT LENGTH.               24440002
         OI    ZERO(R5),SIGNF          ALTER SIGN TO X'F'               24460002
         LA    R5,ONE(R4,R2)           R5=ADDRESS OF EDIT OUTPUT AREA.  24480002
         MVC   ZERO(THREE2,R5),PATTERN MOVE PATTERN INTO WORKAREA.      24500002
         SLL   R4,ONE                  R4=LENGTH TIMES 2.               24520002
         BCTR  R4,ZERO                 R4=LENGTH MINUS ONE.             24540002
         LR    R7,R4                   R7=NEW LENGTH.                   24560002
         BCTR  R7,ZERO                 R7=NEW LENGTH MINUS 1.           24580002
         LA    R1,ZERO(R5,R7)          R1=ADDR OF LAST BYTE OF OUTPUT.  24600002
         LR    R7,R1                   R7=ADDR OF LAST BYTE OF OUTPUT.  24620002
         EX    R4,ZONEPK               INPUT NOW ZONE DECIMAL.          24640002
         CLI   ZERO(R1),BLANK          Q.IS LAST CHARACTER A BLANK.     24660002
         BNE   NOBLANK                 NO,SKIP MOVE IN ZERO CODE.       24680002
         MVI   ZERO(R1),AZERO          MOVE IN A CHARACTER -0-.         24700002
NOBLANK  EQU   *                                                        24720002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              24740002
         TM    ZERO(R6),PLUSBIT        LOW ORDER BIT OF BYTE ON.        24760002
         BZ    ITSPLUS                 NO,THE STRING IS POSITIVE        24780002
         TM    ZERO(R6),PLUSBITS       Q.IS SIGN NEGATIVE.              24800002
         BO    ITSPLUS                 NO,IT MUST BE POSITIVE.          24820002
         BCTR  R1,ZERO                 R1=ADDR OF SIGN LOCATION.        24840002
         MVI   ZERO(R1),SIGNNEG        PUT SIGN IN OUTPUT AREA.         24860002
PUTOUT   EQU   *                                                        24880002
         LA    R7,ONE(R7)              R7=END OF ZONED DATA ADDR.       24900002
         SR    R7,R1                   R7=LENGTH OF ZONED DATA.         24920002
         EX    R7,MOVEOUT              MOVE OUTPUT INTO OUTPUT AREA.    24940002
         LA    R7,ONE(R7)              R4=LENGTH OF OUTPUT.             24960002
         STC   R7,ZERO(R2)             LENGTH OF OUTPUT NOW IN CONAREA. 24980002
         SR    R15,R15                 SET RETURN CODE TO 0.            25000002
         BR    R14                     RETURN                           25020002
ITSPLUS  EQU   *                                                        25040002
         BCTR  R1,ZERO                 R1=ADDR OF SIGN LOCATION.        25060002
         MVI   ZERO(R1),PLUSSIGN       PUT PLUS SIGN IN OUT PUT AREA.   25080002
         B     PUTOUT                  MOVE OUTPUT INTO CONAREA.        25100002
ZONEPK   EDMK  ZERO(ONE,R5),ZERO(R2)   STRING NOW PRINTABLE CHARACTERS. 25120002
MOVEPK   MVC   ZERO(ONE,R2),ZERO(R3)   MOVE INPUT INTO WORKAREA.        25140002
MOVEOUT  MVC   ONE(ONE,R2),ZERO(R1)    MOVE OUTPUT INTO OUTPUT AREA.    25160002
PKERROR  EQU   *                                                        25180002
         LA    R4,MSG003               R4=ADDR OF MSG PARM LIST.        25200002
         B     ERRORPK                 WRITE ERROR MESSAGE.             25220002
BINAQVY  EQU   *                                                        25240002
         SPACE                                                          25260002
*********************************************************************** 25280002
*                                                                     * 25300002
*        THIS ROUTINE CONVERTS A,Q,V, AND Y TYPE CONSTANTS FROM       * 25320002
*        BINARY TO PRINTABLE CHARACTERS.  WHEN THE TYPE OS H OR Y,    * 25340002
*        REGISTER 5 MUST CONTAIN A VALUE GREATER THAN ZERO('0')       * 25360002
*        OTHERWISE REGISTER 5 WILL BE ZERO.                           * 25380002
*                                                                     * 25400002
*********************************************************************** 25420002
         SPACE                                                          25440002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           25460002
         LH    R4,FOUR(R1)             R4=LENGTH OF INPUT.              25480002
         L     R1,ZERO(R1)             R1=ADDRESS OF INPUT STRING.      25500002
         L     R10,WORKAREA            R10=ADDRESS OF WORKAREA.         25520002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               25540002
         EX    R4,AQVYMOVE             MOVE INPUT INTO WORKAREA.        25560002
         L     R1,ZERO(R10)            R1=INPUT STRING.                 25580002
         LA    R5,THREE                R5=3.                            25600002
         SR    R5,R4                   R5=LENGTH MINUS 3.               25620002
         M     R4,FULL8                R5=NUMBER OF BITS TO SHIFT.      25640002
         SRL   R1,ZERO(R5)             INPUT RIGHT JUSTIFIED.           25660002
         N     R1,MASKSIGN             TURN HIGH ORDER BIT OFF.         25680002
         CVD   R1,ZERO(R10)            STRING NOW PACK DECIMAL.         25700002
         OI    SEVEN(R10),SIGNF        ALTER SIGN TO HEX F.             25720002
         UNPK  EIGHT(ONE5,R10),ZERO(EIGHT,R10) ZONED DECIMAL DATA.      25740002
         LA    R1,TWO3(R10)            R1=END OF OUTPUT ADDR.           25760002
         LA    R5,ONE4                 R5=14.                           25780002
         LA    R10,EIGHT(R10)          R10=PTR TO OUTPUT DATA.          25800002
BUMP     CLI   ZERO(R10),AZERO         Q.VALID DATA FOUND.              25820002
         BNE   NOBUMP                  YES,COMPUTE LENGTH OF OUTPUT.    25840002
         LA    R10,ONE(R10)            BUMP PTR TO OUTPUT.              25860002
         BCT   R5,BUMP                 ALL OUTPUT TESTED FOR A ZERO.    25880002
NOBUMP   EQU   *                                                        25900002
         SR    R1,R10                  R1=LENGTH OF OUTPUT.             25920002
         STC   R1,ZERO(R2)             LENGTH NOW IN CONAREA.           25940002
         BCTR  R1,ZERO                 R1=EXECUTE LENGTH.               25960002
         EX    R1,MOVE2                OUTPUT NOW IN CONAREA.           25980002
         SR    R15,R15                 RC=0.                            26000002
         BR    R14                     RETURN TO CALLER.                26020002
MOVE2    MVC   ONE(ONE,R2),ZERO(R10)   MOVE OUTPUT TO CONAREA.          26040002
AQVYMOVE MVC   ZERO(ONE,R10),ZERO(R1)  INPUT NOW IN WORKAREA.           26060002
         SPACE                                                          26080002
BINFDEC  EQU   *                                                        26100002
         SPACE                                                          26120002
*********************************************************************** 26140002
*                                                                     * 26160002
*        THIS ROUTINE CONVERTS BINARY TO FIXED DECIMAL PRINTABLE.     * 26180002
*                                                                     * 26200002
*********************************************************************** 26220002
         SPACE                                                          26240002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          26260002
         SR    R8,R8                   INITIALIZE GT SWITCH.            26280002
         LH    R6,FOUR(R1)             R6=LENGTH OF INPUT STRING.       26300002
         L     R3,ZERO(R1)             R3=ADDR OF INPUT STRING.         26320002
         L     R4,WORKAREA             R4=ADDR OF WORKAREA.             26340002
         MVI   ONE(R2),PLUSSIGN        PUT PLUS SIGN INTO OUTPUT AREA.  26360002
         SPACE                                                          26380002
*        IS THE LENGTH OF THE BINARY VALUE GREATER THAN 4 BYTES.      * 26400002
         SPACE                                                          26420002
         CL    R6,FIXLEN               Q.LENGTH GT 4 BYTES.             26440002
         BH    GREATER                 YES,CONVERT FIRST 4 BYTES.       26460002
         SPACE                                                          26480002
*********************************************************************** 26500002
*                                                                     * 26520002
*        THIS SECTION CONVERT ONLY FOUR BYTES OF BINARY DIGITS TO     * 26540002
*        ITS PRINTABLE FORM.                                          * 26560002
*                                                                     * 26580002
*********************************************************************** 26600002
         SPACE                                                          26620002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               26640002
         EX    R6,MOVEIN               INPUT NOW IN WORKAREA.           26660002
         LA    R6,ONE(R6)              R6=CORRECT LENGTH.               26680002
         L     R1,ZERO(R4)             R1=INPUT STRING.                 26700002
         MVI   ONE(R2),PLUSSIGN        PUT PLUS SIGN INTO OUTPUT AREA.  26720002
         LA    R0,EIGHT                R0=EIGHT.                        26740002
         LA    R5,FOUR                 R5=4.                            26760002
         SR    R5,R6                   R5=4 MINUS LENGTH.               26780002
         LTR   R5,R5                   Q.IS LENGTH 4.                   26800002
         BZ    NOSRL                   YES,SKIP RIGHT JUSTIFY.          26820002
         MR    R4,R0                   R4=SHIFT FACTOR.                 26840002
         SRA   R1,ZERO(R5)             RIGHT JUSTIFY INPUT.             26860002
NOSRL    EQU   *                                                        26880002
         LTR   R1,R1                   Q.IS VALUE NON-NEGATIVE.         26900002
         BNM   NONNEG                  YES,SKIP COMPLEMENT ROUTINE.     26920002
         SPACE                                                          26940002
*        THIS AREA COMPLEMENTS THE NEGATIVE BINARY VALUE.             * 26960002
         SPACE                                                          26980002
         LCR   R1,R1                   R1,NOW POSITIVE FOR CONVERT.     27000002
         MVI   ONE(R2),SIGNNEG         MOVE IN NEG SIGN.                27020002
         SPACE                                                          27040002
NONNEG   EQU   *                                                        27060002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          27080002
         CVD   R1,ZERO(R3)             STRING IS NOW PACKED DECIMAL.    27100002
         LTR   R8,R8                   Q.LENGTH GT 4 BYTES.             27120002
         BZ    SKIP1                   NO,SKIP ADD ROUTINE              27140002
         SPACE                                                          27160002
*********************************************************************** 27180002
*                                                                     * 27200002
*        THIS SECTION ADDS THE REMAINDER OF THE INPUT STRING          * 27220002
*        (PACKED DECIMAL) TO THE ALREADY COMPUTED PACKED BYTES        * 27240002
*        OF THE STRING AND CONVERTS THE STRING TO ZONED DECIMAL.      * 27260002
*                                                                     * 27280002
*********************************************************************** 27300002
         SPACE                                                          27320002
         LTR   R7,R7                   Q.IS ADD ONE SWITCH ON.          27340002
         BZ    NOTON                   NO,DO NOT ADD ONE.               27360002
         AP    PACKANS(TEN,R3),PACKONE YES,ADD ONE.                     27380002
NOTON    EQU   *                                                        27400002
         AP    PACKANS(TEN,R3),ZERO(EIGHT,R3) ADD 2ND WORD TO 1ST WORD. 27420002
         MVN   PACKSIGN(ONE,R3),MASKSIGN   SET SIGN BITS TO HEX F.      27440002
         MVC   WORK3(TWO0,R3),PATTERN  PUT PATTERN INTO WORKAREA.       27460002
         MVI   FDECSTAR(R3),STARTER    STARTER CHAR NOW IN WORKAREA.    27480002
         LA    R1,FDECSTAR+ONE(R3)     R1=ADDR OF LAST BYTE.            27500002
         EDMK  WORK3(TWO0,R3),PACKANS(R3)  BLANK OUT LEADING ZEROS.     27520002
         LA    R4,FIXED(R3)            R4=END OF ZONED DATA.            27540002
         SR    R4,R1                   R4=NUMBER OF OUTPUT DIGITS.      27560002
         STC   R4,ZERO(R2)             LENGTH NOW IN OUTPUT AREA.       27580002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH                27600002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               27620002
         LR    R3,R1                   R3=ADDR OF SIGNIFICANCE BYTES.   27640002
         EX    R4,MOVE                 MOVE OUTPUT INTO CONAREA.        27660002
         SR    R15,R15                 R15=RC 0.                        27680002
         BR    R14                     RETURN                           27700002
         SPACE                                                          27720002
SKIP1    EQU   *                                                        27740002
         SPACE                                                          27760002
*********************************************************************** 27780002
*                                                                     * 27800002
*        THIS SECTION OF CODE CONVERTS FROM PACKED DECIMAL TO         * 27820002
*        ZONED THE INPUT WITH A LENGTH OF FOUR OR LESS.               * 27840002
*                                                                     * 27860002
*********************************************************************** 27880002
         SPACE                                                          27900002
         LA    R1,NOFZONE-TWO(R3)      R1=ADDR FOR STARTER CHAR.        27920002
         MVC   WORK5(ONE7,R3),PATTERN  PUT PATTERN INTO WORKAREA.       27940002
         MVI   ZERO(R1),STARTER        STARTER CHAR NOW IN PATTERN.     27960002
         LA    R1,ONE(R1)              R1=ADDR OF LAST BYTE.            27980002
         EDMK  WORK5(ONE6,R3),ZERO(R3) INPUT NOW ZONED DECIMAL.         28000002
         LR    R0,R3                   R0=ADDR OF WORKAREA.             28020002
         LR    R3,R1                   R3=ADDRESS OF ZONED DECIMAL.     28040002
         LA    R6,NOFZONE              R6=END OF ZONE DECIMAL.          28060002
         AR    R6,R0                   R6=END OF OUTPUT.                28080002
         SR    R6,R1                   R6=LENGTH OF OUTPUT.             28100002
         EX    R6,MOVE                 MOVE OUTPUT INTO CONAREA.        28120002
         LA    R6,ONE(R6)              R6=LENGTH OF OUTPUT.             28140002
         STC   R6,ZERO(R2)             MOVE LENGTH INTO CONAREA.        28160002
         SR    R15,R15                 R15=RC 0.                        28180002
         BR    R14                     RETURN                           28200002
GREATER  EQU   *                                                        28220002
         SPACE                                                          28240002
*********************************************************************** 28260002
*                                                                     * 28280002
*        THIA AREA OF CODE CONVERTS A BINARY VALUE TO PACKED DECIMAL  * 28300002
*        WHOSE LENGTH IS GREATER THAN FOUR BYTES.  ONLY THE HIGH      * 28320002
*        ORDER FOUR BYTES ARE PACKED.                                 * 28340002
*                                                                     * 28360002
*********************************************************************** 28380002
         SPACE                                                          28400002
         XC    ZERO(EIGHT,R4),ZERO(R4) INPUT AREA NOW CLEARED.          28420002
         SR    R7,R7                   R7=0.                            28440002
         LA    R1,SEVEN                R2=7.                            28460002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               28480002
         SR    R1,R6                   R2=NUMBER OF LEADING ZEROES.     28500002
         LA    R4,ZERO(R1,R4)          NEW ADDR OF WORKAREA.            28520002
         EX    R6,MOVEIN               MOVE INPUT INTO WORKAREA.        28540002
         L     R3,WORKAREA             R3=ADDR OF WORKAREA.             28560002
         TM    ZERO(R4),VALCK          Q.IS INPUT NEGATIVE.             28580002
         BZ    NOTNEG                  NO,DO NOT COMPLEMENT.            28600002
         MVI   ONE(R2),SIGNNEG         MOVE IN NEG SIGN.                28620002
         MVI   EIGHT(R4),NEGBYTE       SET AN AREA                      28640002
         MVC   NINE(SEVEN,R4),EIGHT(R4)            TO 2 WORDS OF ONES.  28660002
         XC    EIGHT(EIGHT,R3),ZERO(R3) FLIP BITS POSITIVE.             28680002
         LA    R3,EIGHT(R3)            R3=ADDR OF INPUT.                28700002
         LA    R7,ONE                  R7=1,INDICATE NEG & GT 4 BYTES.  28720002
NOTNEG   EQU   *                                                        28740002
         SPACE                                                          28760002
*********************************************************************** 28780002
*                                                                     * 28800002
*        THE FOLLOWING CODE CALCULATES THE VALUE OF THE HIGH ORDER    * 28820002
*        BYTES OF THE INPUT STRING THAT EXCEEDS FOUR BYTES.           * 28840002
*                                                                     * 28860002
*********************************************************************** 28880002
         SPACE                                                          28900002
         L     R4,WORKAREA             R4=ADDR OF WORKAREA.             28920002
         L     R5,ZERO(R3)             R5=INPUT STRING.                 28940002
         LA    R2,ONE                  R2=1.                            28960002
         MVC   PACKWORK(TEN,R4),PACKVAL INITIAL VALUE IN PACK WORKAREA. 28980002
         XC    PACKANS(TEN,R4),PACKANS(R4) ZERO OUT PACK ANSWER PLACE.  29000002
         LA    R6,FIXCOUNT             R6=31,LOOP COUNT.                29020002
         LR    R1,R2                   R1=1.                            29040002
         OI     SIGNIT(R4),SIGNF       PACK SIGN NOW X'F'.              29060002
NEXTBIT  EQU   *                                                        29080002
         NR    R2,R5                   SET UP TEST REGISTER.            29100002
         BZ    NOTON2                  NO,JUST ADVANCE PACK VALUE.      29120002
         AP    PACKANS(TEN,R4),PACKWORK(TEN,R4) COMPUTE PACK VALUE.     29140002
NOTON2   EQU   *                                                        29160002
         AP    PACKWORK(TEN,R4),PACKWORK(TEN,R4) UPDATE PACK VALUE.     29180002
         AR    R1,R1                   UPDATE BIT INDICATOR.            29200002
         LR    R2,R1                   R2=BIT INDICATOR.                29220002
         BCT   R6,NEXTBIT              IF MORE BITS TEST NEXT ONE.      29240002
         SPACE                                                          29260002
*********************************************************************** 29280002
*                                                                     * 29300002
*        THE FOLLOWING CODE CHECK THE HIGH ORDER BIT OF THE SECOND    * 29320002
*        WORD OF THE INPUT STRING TO DETERMINE IF IT IS ON. IF IT IS  * 29340002
*        ON IT WILL BE TURNED OFF AND THE VALUE OF IT WILL BE ADDED   * 29360002
*        TO THE FINAL VALUE. NO PROCESSING WILL BE DONE TO REFLECT    * 29380002
*        THE BIT BEINGING OFF.                                        * 29400002
*                                                                     * 29420002
*********************************************************************** 29440002
         SPACE                                                          29460002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          29480002
         LA    R8,ONE                  SET GT SWITCH = GT 4 BYTES.      29500002
         L     R1,FOUR(R3)             R1=2ND WORK OF INPUT STRING.     29520002
         TM    FOUR(R3),HION           Q.HI ORDER BIT ON.               29540002
         BNO   NONNEG                  NO, BIT IS OFF.                  29560002
         SLL   R1,ONE                  DROP HI ORDER BIT.               29580002
         SRL   R1,ONE                  ISOLATE REMAINDER OF BITS.       29600002
         AP    PACKANS(TEN,R4),LASTPACK  COMPUTE PACKED VALUE.          29620002
         B     NONNEG                  CONTINUE PROCESSING.             29640002
MOVE     MVC   TWO(ONE,R2),ZERO(R3)    MOVE OUTPUT INTO CONAREA.        29660002
MOVEIN   MVC   ZERO(ONE,R4),ZERO(R3)   MOVE INPUT INTO WORKAREA.        29680002
BINHEX   EQU   *                                                        29700002
         SPACE                                                          29720002
*********************************************************************** 29740002
* THIS ROUTINE CONVERTS BINARY TO PRINTABLE HEXADECIMAL.              * 29760002
*********************************************************************** 29780002
         SPACE                                                          29800002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          29820002
         LR    R4,R3                   R4=ADDRESS OF WORKAREA.          29840002
         L     R2,CONAREA              R2=OUTPUT AREA ADDRESS.          29860002
         LA    R2,ONE(R2)              ADVANCE PASS LENGTH AREA.        29880002
         LH    R10,FOUR(R1)            R10=LENGTH OF INPUT.             29900002
         BCTR  R10,ZERO                R10=EXECUTE LENGTH.              29920002
         L     R1,ZERO(R1)             R1=ADDRESS OF INPUT STRING.      29940002
         EX    R10,BHMOVE              MOVE INPUT TO EVEN BOUNDARY.     29960002
         LA    R10,ONE(R10)            R10=ACTUAL LENGTH OF INPUT.      29980002
         SLL   R10,ONE                 R10=LENGTH OF OUTPUT.            30000002
         SR    R1,R1                   CLEAR LENGTH COUNTER.            30020002
NEXTWORD EQU   *                                                        30040002
         L     R7,ZERO(R4)             GET A WORD OF INPUT.             30060002
         SR    R5,R5                   CLEAR COUNTER.                   30080002
MOREBITS EQU   *                                                        30100002
         SR    R6,R6                   CLEAR WORK REGISTER.             30120002
         SLDL  R6,FOUR                 MOVE J BITS INTO WORK REG.       30140002
         CL    R6,FULLNINE             Q.BITS GT 9.                     30160002
         BH    GREAT                   YES,CONVERT TO ALPHABETIC.       30180002
         LA    R6,F0(R6)               CONVERT TO HEX VALUE.            30200002
NEXT     EQU   *                                                        30220002
         STC   R6,ZERO(R2)             MOVE TO CONAREA.                 30240002
         LA    R2,ONE(R2)              INCREMENT CONAREA POINTER.       30260002
         LA    R5,ONE(R5)              INCREMENT INPUT COUNTER.         30280002
         LA    R1,ONE(R1)              INCREMENT LENGTH COUNTER.        30300002
         BCT   R10,BHEXGO              Q.MORE INPUT.                    30320002
BHEXEND  EQU   *                                                        30340002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       30360002
         STC   R1,ZERO(R2)             PUT LENGTH INTO  CONAGRA.        30380002
         SR    R15,R15                 RC=0.                            30400002
         BR  R14                       RETURN TO CALLER.                30420002
BHEXGO   EQU   *                                                        30440002
         CL    R5,FULL8                Q.ANOTHER WORD NEEDED.           30460002
         BE    ADVANCE                 YES,INCREMENT R4 4 BYTES.        30480002
         B     MOREBITS                GET NEXT 4 BITS.                 30500002
ADVANCE  EQU   *                                                        30520002
         LA    R4,FOUR(R4)             R4=NEXT FOUR BYTES ADDRESS.      30540002
         B     NEXTWORD                GET NEW WORD.                    30560002
GREAT    EQU   *                                                        30580002
         LA    R6,B7(R6)               CONVERT TO HEX VALUE.            30600002
         B     NEXT                    MOVE BYTE TO CONAREA.            30620002
BHMOVE   MVC   ZERO(ONE,R4),ZERO(R1)   MOVE INPUT TO EVEN BOUNDARY.     30640002
         EJECT                                                          30660002
*********************************************************************** 30680002
* THE FOLLOWING IS A GROUP OF CONSTANTS USED BY THE CSECT'S             30700002
*********************************************************************** 30720002
         SPACE                                                          30740002
FIXLEN   DC    F'4'                    FULL WORD 4.                     30760002
FULLNINE DC    F'9'                    FULL WORD 9.                     30780002
FULL8    DC    F'8'                    FULL WORD 8.                     30800002
MASKSIGN DC    X'7FFFFFFF'             USED TO TURN OFF HIGH ORDER BIT. 30820002
PACKONE  DC    PL10'1'                 PACKED DECIMAL 1.                30840002
ZEROS    DC    X'0000'                 HALFWORD OF DECIMAL ZEROES.      30860002
OFFSETC  DC    X'FC'                   NUMERIC C FOR PACK SIGN.         30880002
OFFSETD  DC    X'FD'                   NUMERIC D FOR PACK SIGN.         30900002
PATTERN  DC    X'40'                   PATTERN FIELD FOR THE EDIT       30920002
         DC    31X'20'                 AND MARK INSTRUCTION.            30940002
NEGSIGN  DC    P'-1'                   PACKED DECIMAL -1.               30960002
         DS    0F                                                       30980002
ORREG    DC    X'00000070'             OUTPUT LENGTH FOR EXECUTE.       31000002
COMPFLD  DC    X'FFFFFFFF'             FULL WORD OF ONES.               31020002
         DS    0X                                                       31040002
PACKVAL  DC    PL10'4294967296'        PACK DECIMAL VALUE FOR FIXDEC.   31060002
LASTPACK DC    PL10'2147483648'        *                                31080002
BKPLUS   DC    C' +'                   MSG PLUS SIGN.                   31100002
SMTSYM2  DC    C'SYM'                  CONSTANT NAME FOR BLDL           31120002
*                                       SMT TESTCASE LABEL              31140002
*                                       LINK TO SYM FAILED              31160002
*                                       TESTCASE ID  TTSTC120           31180002
*                                       TESTCASE ID  TEQU5300           31200002
SUPERZAP DC    50CL1'Z'                SUPERZAP PATCHING AREA           31210002
         DS     0F                                                      31220002
LINKLST  LINK  SF=L                    LIST FORM OF LINK.               31320002
LINKLSTL EQU   *-LINKLST               LENGTH OF LIST FORM OF LINK.     31340002
ESTAELST ESTAE MF=L                    LIST FORM OF THE ESTAE MACRO     31350002
ESTAELN  EQU   *-ESTAELST              LENGTH OF ESTAE MACRO EXPANSION  31352002
         TITLE 'IKJEGCVT CONVERT BRANCH TABLE.'                         31360002
*********************************************************************** 31380002
* THE FOLLOWING LIST OF ADCONS AND VCONS ROUTES CONTROL TO THE PROPER * 31400002
* PRINTABLE TO BINARY CONVERSION ROUTINE.  THE VCONS ROUTE CONTROL TO * 31420002
* THE 2ND CSECT OF CONVERT WHICH CONTAINS THE INSTRUCTION AND FLOATING* 31440002
* POINT CONVERSIONS.                                                  * 31460002
*********************************************************************** 31480002
         SPACE                                                          31500002
ACONLST  EQU   *                                                        31520002
         DC    A(RETURN)               CODE X'00' FOR CHAR.             31540002
         DC    A(HEXBIN)               CODE X'04' FOR HEX.              31560002
         DC    A(BINBIN)               CODE X'08' FOR BINARY.           31580002
         DC    A(RETURN)               CODE X'0C' FOR INST FROM BIN.    31600002
         DC    A(FAQVBIN)              CODE X'10' FOR FULLWORD FIXED PT 31620002
         DC    A(FAQVBIN)              CODE X'14' FOR HALFWORD FIXED PT 31640002
         DC    V(IKJEGFTB)             CODE X'18' FOR SHORT FLT PT.     31660002
         DC    V(IKJEGFTB)             CODE X'1C' FOR LONG FLT PT.      31680002
         DC    A(FAQVBIN)              CODE X'20' FOR A AND Q ADDRESS.  31700002
         DC    A(FAQVBIN)              CODE X'24' FOR Y ADDR CONSTANTS. 31720002
         DC    A(SCONBIN)              CODE X'28' FOR S ADDR CONSTANTS. 31740002
         DC    A(FAQVBIN)              CODE X'2C' FOR V ADDR CONSTANTS. 31760002
         DC    A(PKBIN)                CODE X'30' FOR PACKED DECIMAL.   31780002
         DC    A(RETURN)               CODE X'34' FOR ZONED DECIMAL.    31800002
         DC    A(RETURN)               CODE X'38' FOR EXTENDED FLT PT.  31820002
         SPACE                                                          31840002
*********************************************************************** 31860002
* THE FOLLOWING LIST OF ADCONS AND VCONS ROUTES CONTROL TO THE PROPER * 31880002
* BINARY TO PRINTABLE CONVERSION ROUTINE.  THE VCONS ROUTES CONTROL TO* 31900002
* THE 2ND CSECT OF CONVERT WHICH CONTAINS THE INSTRUCTION AND FLOATING* 31920002
* POINT CONVERSIONS.                                                  * 31940002
*********************************************************************** 31960002
         SPACE                                                          31980002
ACONLST2 EQU   *                                                        32000002
         DC    A(RETURN)               CODE X'00' FOR CHAR.             32020002
         DC    A(BINHEX)               CODE X'04' FOR HEXADECIMAL.      32040002
         DC    A(RETURN)               CODE X'08' FOR BINARY.           32060002
         DC    V(IKJEGIST)             CODE X'0C' FOR INSTRUCTION.      32080002
         DC    A(BINFDEC)              CODE X'10' FOR FULLWORD FIXED PT 32100002
         DC    A(BINFDEC)              CODE X'14' FOR HALFWORD FIXED PT 32120002
         DC    V(IKJEGBFT)             CODE X'18' FOR SHORT FLT PT.     32140002
         DC    V(IKJEGBFT)             CODE X'1C' FOR LONG FLT PT.      32160002
         DC    A(BINAQVY)              CODE X'20' FOR A AND Q ADDRESS.  32180002
         DC    A(BINAQVY)              CODE X'24' FOR Y ADDR CONSTANTS. 32200002
         DC    V(IKJEGBIS)             CODE X'28' FOR S ADDR CONSTANTS. 32220002
         DC    A(BINAQVY)              CODE X'2C' FOR V ADDR CONSTANTS. 32240002
         DC    A(BINPK)                CODE X'30' FOR V ADDR CONSTANTS. 32260002
         DC    A(RETURN)               CODE X'34' FOR ZONED DECIMAL.    32280002
         DC    A(RETURN)               CODE X'38' FOR EXTENDED FLT PT.  32300002
CVTBASE  DC    A(CVTBEGIN)             ADDR OF IKJEGCVT.                32320002
         TITLE 'IKJEGCVT INSTRUCTION CONVERSION ROUTINE.'               32340002
IKJEGCVX   CSECT                                                        32360002
         SPACE                                                          32380002
*********************************************************************** 32400002
*                                                                     * 32420002
* THIS CSECT IS AN EXTENTION OF THE CONVERT ROUTINE.  THE INSTRUCTION * 32440002
* CONVERSIONS FROM BINARY TO PRINTABLE CHARACTERS ARE FOUND IN THIS   * 32460002
* CSECT.                                                              * 32480002
*                                                                     * 32500002
*********************************************************************** 32520002
         SPACE                                                          32540002
         ENTRY IKJEGIST                                                 32560002
         ENTRY IKJEGBIS                                                 32580002
         SPACE                                                          32600002
*********************************************************************** 32620002
* THE FOLLOWING INSTRUCTIONS CONVERT AN INSTRUCTION IN STORAGE FROM   * 32640002
* ITS BINARY VALUE TO ITS PRINTABLE FORMAT.  A VALIDITY CHECK  IS     * 32660002
* TAKEN TO DETERMINE IF THE OP CODE IS VALID.  IF THE OP CODE IS IN-  * 32680002
* VALID AN ERROR MESSAGE IS PRINTED DESCRIBING THE CONDITION.         * 32700002
*********************************************************************** 32720002
         SPACE                                                          32740002
IKJEGIST EQU   *                                                        32760002
         LR    R12,R15                 R12=ADDRESS OF IKJEGCVX.         32780002
         USING IKJEGCVX,R12            IKJEGCVX ADDRESSABILITY.         32800002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY.          32820002
         L     R3,ZERO(R1)             R3=PT TO THE INPUT STRING.       32840002
         SR    R5,R5                   R5=ZERO.                         32860002
         L     R7,WORKAREA             R7=ADRESS OF WORKAREA.           32880002
         USING CVTWORK,R7              USE R7 TO ADDRESS WORKAREA.      32900002
         L     R2,CONAREA              R2=ADDR OF THE OUTPUT AREA       32920002
         MVI   CODE370,HEX00           CLEAR 370 FLAG INITIALLY.        32940002
         CLI   ZERO(R3),B2             Q.IS OP CODE TWO BYTES.          32960002
         BNE   ONEBYTOP                NO,GET OP CODE.                  32980002
         CLI   ONE(R3),HEX13           YES,Q.IS 2 BYTE CODE VALID.      33000002
         BH    NOOPCODE                NO,ERROR MESSAGE.                33020002
         IC    R5,ONE(R3)              R5=SECOND OP CODE BYTE.          33040002
         LA    R8,SIX                  R2= X'6' (IE OP TABLE INCREMT)   33060002
         MR    R4,R8                   R5=INDEX FACTOR TO GET MNENOMIC  33080002
         L     R6,TSTOPCD2             R6=ADDR OF 2 BYTE OPCODE TABLE   33100002
         LA    R6,ZERO(R5,R6)          R6=ADDR OF OPCODE                33120002
         MVC   ONE(FIVE,R2),ZERO(R6)   PUT PRINTABLE OPCODE IN CONAREA  33140002
         LA    R8,FIVE                 R8=INDEX FOR OPCODE TABLE BRANCH 33160002
MVONEBK  EQU   *                       INSERT 1 BLANK FOLLOWING OPCODE  33180002
         MVI   SIX(R2),BLANK           FOLLOW OPCODE WITH ONE BLANK     33200002
         B     OPBRANCH                FIND THE OPCODE TYPE             33220002
ONEBYTOP EQU   *                                                        33240002
         CLI   ZERO(R3),STCTLM         Q.IS OP CODE STCTL-5 CHARS.      33260002
         BE    SETCODE5                NO                               33280002
         CLI   ZERO(R3),STNSMM         Q.IS OP CODE STNSM-5 CHARS.      33300002
         BE    SETCODE5                NO                               33320002
         CLI   ZERO(R3),STOSMM         Q.IS OP CODE STOSM-5 CHARS.      33340002
         BNE   COMMONOP                NO, TRY OPCODE TABLE FOR 360     33360002
SETCODE5 EQU   *                                                        33380002
         OI    CODE370,CHAR5           FLAG INDICATING 5 CHAR OPCODE    33400002
COMMONOP EQU   *                                                        33420002
         IC    R5,ZERO(R3)             R5=THE OP CODE IN BINARY.        33440002
         LA    R8,FIVE                 R2=HEX 5.                        33460002
         MR    R4,R8                   R5=INDEX FACTOR TO GET MNEMONIC. 33480002
         L     R6,OPCODTAB             R6=ADDR OF OPCODETAB.            33500002
         LA    R6,ZERO(R5,R6)          R6=ADDRESS OF OPCODE.            33520002
         LA    R8,FOUR                 R8=INDEX TO OPCODE TYPE FIELD    33540002
         TM    CODE370,CHAR5           Q.IS MNEUMONIC 5 CHARS.          33560002
         BNO   MOVEMNEU                NO,MOVE 4 CHARS FROM TABLE.      33580002
         MVI   ONE(R2),CHARS           YES,MOVE IN FIRST S CHAR.        33600002
         MVC   TWO(FOUR,R2),ZERO(R6)   INSERT REMAINING 4-BYT OF OPCODE 33620002
         B     MVONEBK                 INSERT THE BLANK                 33640002
MOVEMNEU EQU   *                                                        33660002
         MVC   ONE(FOUR,R2),ZERO(R6)   PRINTABLE OP CODE IN CONAREA.    33680002
         CLI   ZERO(R3),SIOFOP         Q.IS OP CODE X'9C' (SIOF OR SIO) 33700002
         BNE   MVBLANK                 NO,MOVE BLANK PAST MNEUMONIC.    33720002
         TM    ONE(R3),HEX01           YES.Q.IS OP CODE SIOF.           33740002
         BNO   MVBLANK                 NOT SIOF. MOVE BLANK.            33760002
         MVI   FOUR(R2),CHARF          IS SIOF. ADD F TO MNEUMONIC.     33780002
MVBLANK  EQU   *                                                        33800002
         MVC   FIVE(TWO,R2),BLANKS     MOVE IN BLANK PASS MNEMONIC.     33820002
         DROP  R7                      DROP ADDRESSABILITY TO WORKAREA  33840002
         SPACE                                                          33860002
*********************************************************************** 33880002
* THE FOLLOWING INSTRUCTION FINDS THE PROPER INDEX VALUE FOR THE      * 33900002
* BRANCH TABLE.  THE BRANCH TABLE ROUTES CONTROL TO THE PROPER FORMAT * 33920002
* ROUTINE.                                                            * 33940002
*********************************************************************** 33960002
         SPACE                                                          33980002
OPBRANCH EQU   *                                                        34000002
         LA    R2,SEVEN(R2)            R2=UPDATED OUTPUT POINTER.       34020002
         SR    R4,R4                   R4=ZERO.                         34040002
         IC    R4,ZERO(R8,R6)          R4=INDEX VALUE TO ROUTINE.       34060002
         B     INSTBRTB(R4)            BRANCH TO REQUIRED ROUTINE.      34080002
         SPACE                                                          34100002
* THE FOLLOWING TABLE ROUTES CONTROL TO THE PROPER FORMAT ROUTINE.    * 34120002
         SPACE                                                          34140002
INSTBRTB EQU   *                                                        34160002
         B     NOOPCODE                THE OP CODE IS INVALID,ERROR MSG 34180002
         B     OPRR                    OP=RR FORMAT.                    34200002
         B     OPRR                    OP=RR FORMAT WITH 1 REGISTER.    34220002
         B     OPRS                    OP=RS FORMAT.                    34240002
         B     OPRS                    OP=RS FORMAT ONE REGISTER.       34260002
         B     OPSVC                   OP=SVC.                          34280002
         B     OPSI                    OP=SI FORMAT.                    34300002
         B     OPSI                    OP=SI WITHOUT THE IMMEDIATE.     34320002
         B     OPSS                    OP=SS WITH ONE LENGTH.           34340002
         B     OPSS                    OP=SS WITH TWO LENGTH.           34360002
         B     OPRX                    OP=RX FORMAT.                    34380002
         SPACE                                                          34400002
*********************************************************************** 34420002
* THE FOLLOWING INSTRUCTIONS CONVERTS AND FORMAT THE RR INSTRUCTIONS  * 34440002
* WITH BOTH OPERANDS IN THE OPERAND FIELD.                            * 34460002
*********************************************************************** 34480002
         SPACE                                                          34500002
OPRR     EQU   *                                                        34520002
         LA    R8,ELEVEN               R8=LENGTH OF OUTPUT              34540002
         LA    R7,TWO                  R7=2.                            34560002
         LA    R5,OPRRVAL              R5=HEX 4.                        34580002
         CR    R4,R5                   Q.RR FORMAT WITH ONE REGISTER.   34600002
         BE    OP1R                    NO,SKIP 1 REGISTER SWITCH SET.   34620002
         LA    R7,ONE                  SET ONE REGISTER SWITCH.         34640002
         LA    R8,EIGHT                SET LENGTH FOR ONE REGISTER.     34660002
OP1R     EQU   *                                                        34680002
         IC    R4,ONE(R3)              R4=OPERANDS R1 AND R2.           34700002
         SRDL  R4,EIGHT                R5=R1 AND R2 IN HIGH ORDER BYTE. 34720002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          34740002
GET1OR2  EQU   *                                                        34760002
         SR    R4,R4                   R4=0.                            34780002
         SLDL  R4,FOUR                 ISOLATE NEXT 4 BITS OP OPERAND   34800002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            34820002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  34840002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) R1 NOW ZONED DECIMAL.         34860002
         CLI   ONE(R6),F0              Q.IS REGISTER 1 OR 2 DIGITS.     34880002
         BNE   TWODIGIT                REGISTER IS TWO DIGITS.          34900002
         BCTR  R8,ZERO                 R8=CORRECTED LENGTH.             34920002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     34940002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           34960002
GETCOMMA EQU   *                                                        34980002
         MVI   ZERO(R2),COMMA          SEPERATE OPERANDS.               35000002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           35020002
         BCT   R7,GET1OR2              Q.IS R2 COMPLETED.               35040002
         L     R2,CONAREA              YES,FIND LENGTH AREA.            35060002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           35080002
         SR    R15,R15                 RC=0.                            35100002
         BR    R14                     RETURN                           35120002
TWODIGIT EQU   *                                                        35140002
         MVC   ZERO(TWO,R2),ONE(R6)    REGISTER NOW IN OUTPUT AREA.     35160002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           35180002
         B     GETCOMMA                GET A COMMA.                     35200002
         SPACE                                                          35220002
*********************************************************************** 35240002
* THE FOLLOWING INSTRUCTIONS CONVERT AND FORMAT THE RS INSTRUCTION    * 35260002
* TYPE R1 AND R3 OPERAND FIELD.                                       * 35280002
*********************************************************************** 35300002
         SPACE                                                          35320002
OPRS     EQU   *                                                        35340002
         LA    R8,SIX                  R8=LENG OF MNEMONIC AND A BLANK. 35360002
         LA    R7,TWO                  R7=2.                            35380002
         LA    R5,OPRSVAL              R5=HEX 0C.                       35400002
         CR    R4,R5                   Q.FORMAT 1 OR 2 REGISTERS.       35420002
         BE    RS2R                    2 REGISTERS,SKIP 1 SET.          35440002
         LA    R7,ONE                  R7=1.                            35460002
RS2R     EQU   *                                                        35480002
         IC    R4,ONE(R3)              R4=OPERANDS R1 AND R2.           35500002
         SRDL  R4,EIGHT                R5=R1 AND R3 IN HI ORDER BYTE.   35520002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          35540002
         USING CVTWORK,R6              USE R6 TO ADRESS WORKAREA.       35560002
GET1OR3  EQU   *                                                        35580002
         SR    R4,R4                   R4=0.                            35600002
         SLDL  R4,FOUR                 ISOLATE NEXT 4 BITS.             35620002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            35640002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  35660002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) R1 NOW ZONED DECIMAL.         35680002
         CLI   ONE(R6),F0              Q.IS REGISTER 1 OR 2 DIGITS.     35700002
         BNE   TWOVAL                  R IS TWO DIGITS.                 35720002
         LA    R8,ONE(R8)              R8=LENGTH PLUS 1.                35740002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     35760002
         LA    R2,ONE(R2)              UPDATE OUTPUT AREA.              35780002
PUTCOMMA EQU   *                                                        35800002
         MVI   ZERO(R2),COMMA          SEPERATE OPERANDS.               35820002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           35840002
         LA    R8,ONE(R8)              R8=LENGTH PLUS 1.                35860002
         BCT   R7,GET1OR3              Q.IS REG COMPLETED.              35880002
         SPACE                                                          35900002
*********************************************************************** 35920002
* THE FOLLOWING LINES OF CODE CONVERTS THE STORAGE OPERAND OF THE RS  * 35940002
* INSTRUCTION FORMAT.                                                 * 35960002
*********************************************************************** 35980002
         SPACE                                                          36000002
         MVC   ZERO(TWO,R6),TWO(R3)    INPUT NOW IN WORKAREA.           36020002
         SR    R4,R4                   R4=0.                            36040002
         L     R5,ZERO(R6)             R5=STORAGE OPERAND               36060002
         SLDL  R4,FOUR                 R4=BASE REGISTER.                36080002
         SRL   R5,TWO0                 R5=DISPLACEMENT                  36100002
         CVD   R5,ZERO(R6)             DISP NOW PACKED DECIMAL.         36120002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      36140002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  36160002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            36180002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          36200002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         36220002
         SR    R7,R1                   R7=LENGTH OF ZONED DECIMAL.      36240002
         LA    R8,ZERO(R7,R8)          R8=LENGTH PLUS DISP LENGTH.      36260002
         BCTR  R7,ZERO                 R6=EXECUTE LENGTH.               36280002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA.            36300002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           36320002
         MVI   ZERO(R2),OPEN           MOVE IN OPEN PARENTHESIS.        36340002
         SPACE                                                          36360002
*********************************************************************** 36380002
* THIS SECTION OF CODE CONVERT THE BASE REGISTER OF THE STORAGE       * 36400002
* OPERAND AND MOVE IT INTO THE OUTPUT AREA.                           * 36420002
*********************************************************************** 36440002
         SPACE                                                          36460002
         CVD   R4,ZERO(R6)             REGISTER NOW PACKED DECIMAL.     36480002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  36500002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) BASE NOW ZONED DECIMAL.       36520002
         CLI   ONE(R6),F0              Q.BASE 1 OR 2 DIGITS.            36540002
         BNE   TWOBASE                 BASE IS TWO DIGITS.              36560002
         LA    R8,ONE(R8)              R8=LENGTH NOW INCLUDES BASE.     36580002
         MVC   ONE(ONE,R2),TWO(R6)     BASE NOW IN OUTPUT AREA.         36600002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER            36620002
ENDBASE  EQU   *                                                        36640002
         MVI   ZERO(R2),CLOSE          MOVE IN A CLOSE PARENTHESIS.     36660002
         LA    R8,TWO(R8)              R8=LENGTH PLUS 2.                36680002
         L     R2,CONAREA              R2=OUTPUT AREA ADDRESS.          36700002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           36720002
         SR    R15,R15                 RC=0.                            36740002
         BR    R14                     RETURN.                          36760002
         DROP  R6                      DROP ADRESSABILITY TO WORKAREA   36780002
DISPMOVE MVC   ZERO(ONE,R2),ZERO(R1)   MOVE DISP INTO CONAREA.          36800002
TWOBASE  EQU   *                                                        36820002
         LA    R8,TWO(R8)              INCREMENT LENGTH FOR 2 DIGITS.   36840002
         MVC   ONE(TWO,R2),ONE(R6)     BASE NOW IN OUTPUT AREA.         36860002
         LA    R2,THREE(R2)            UPDATE OUTPUT POINTER.           36880002
         B     ENDBASE                 GET CLOSE PARENTHESIS.           36900002
TWOVAL   EQU   *                                                        36920002
         LA    R8,TWO(R8)              R8=LENGTH PLUS 2.                36940002
         MVC   ZERO(TWO,R2),ONE(R6)    R NOW IN OUTPUT AREA.            36960002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           36980002
         B     PUTCOMMA                GET COMMA.                       37000002
         SPACE                                                          37020002
*********************************************************************** 37040002
* THE FOLLOWING INSTRUCTIONS CONVERTS A SVC INSTRUCTION TO ITS        * 37060002
* PRINTABLE FORMAT.                                                   * 37080002
*********************************************************************** 37100002
         SPACE                                                          37120002
OPSVC    EQU   *                                                        37140002
         SR    R4,R4                   R4=0.                            37160002
         IC    R4,ONE(R3)              R4=IMMEDIATE FIELD.              37180002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          37200002
         CVD   R4,ZERO(R6)             I FIELD NOW PACKED DECIMAL.      37220002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  37240002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            37260002
         MVC   EIGHT(SEVEN,R6),PATTERN2  MOVE IN PATTERN.               37280002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  I FIELD NOW ZONED DECIMAL.       37300002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         37320002
         SR    R7,R1                   R7=LENGTH OF SIGNIFICANT DIGITS. 37340002
         LA    R8,SIX(R7)              R8=LENGTH OF OUTPUT.             37360002
         BCTR  R7,ZERO                 R7=EXECTUE LENGTH.               37380002
         EX    R7,SVCMOVE              MOVE I FIELD INTO CONAREA.       37400002
         L     R2,CONAREA              R2=CONAREA ADDRESS.              37420002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           37440002
         SR    R15,R15                 RC=0.                            37460002
         BR    R14                     RETURN TO CALLER.                37480002
SVCMOVE  MVC   ZERO(ONE,R2),ZERO(R1)   MOVE I FIELD INTO CONAREA.       37500002
         SPACE                                                          37520002
*********************************************************************** 37540002
* THE FOLLOWING INSTRUCTIONS CONVERTS A SI INSTRUCTION TO PRINTABLE   * 37560002
* CHARACTERS AND FORMAT IT IN ITS MACHINE INSTRUCTION FORMAT.         * 37580002
*********************************************************************** 37600002
         SPACE                                                          37620002
OPSI     EQU   *                                                        37640002
         LR    R0,R4                   SAVE INDEX VALUE                 37660002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          37680002
         USING CVTWORK,R6              USE R6 TO ADDRESS WORKAREA       37700002
         MVC   ZERO(TWO,R6),TWO(R3)    STORAGE OPERAND NOW IN WORKAREA. 37720002
         SR    R4,R4                   R4=0.                            37740002
         L     R5,ZERO(R6)             R5=STORAGE OPERAND.              37760002
         SLDL  R4,FOUR                 R4=BASE REGISTER.                37780002
         SRL   R5,TWO0                 R5=DISPLACEMENT.                 37800002
         CVD   R5,ZERO(R6)             DISP NOW PACKED DECIMAL.         37820002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      37840002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  37860002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            37880002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          37900002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         37920002
         SR    R7,R1                   R7=LENGTH OF ZONED DECIMAL.      37940002
         LA    R8,SIX(R7)              R8=LENGTH PLUS DISP.             37960002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               37980002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA             38000002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           38020002
         MVI   ZERO(R2),OPEN           MOVE OPEN PARENTHESIS TO CONAREA 38040002
         SPACE                                                          38060002
*********************************************************************** 38080002
* THIS SECTION OF CODE CONVERT THE BASE REGISTER OF THE STORAGE       * 38100002
* OPERAND AND MOVE IT INTO THE OUTPUT AREA.                           * 38120002
*********************************************************************** 38140002
         SPACE                                                          38160002
         CVD   R4,ZERO(R6)             REGISTER NOW PACKED DECIMAL.     38180002
         OI    SEVEN(R6),SIGNF         SIGN HEX F.                      38200002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) BASE NOW ZONED DECIMAL.       38220002
         CLI   ONE(R6),F0              Q.BASE 1 OR 2 DIGITS.            38240002
         BNE   SIBASE2                 BASE IS TWO DIGITS.              38260002
         LA    R8,ONE(R8)              R8=LENGTH NOW INCLUDES BASE.     38280002
         MVC   ONE(ONE,R2),TWO(R6)     BASE NOW IN OUTPUT AREA.         38300002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           38320002
ENDISP   EQU   *                                                        38340002
         MVI   ZERO(R2),CLOSE          MOVE IN A CLOSE PARENTHESIS.     38360002
         LA    R8,TWO(R8)              R8=LENGTH + 2.                   38380002
         SPACE                                                          38400002
* CHECK TO DETERMINE IF A SCON IS BEING CONVERTED TO PRINTABLE.       * 38420002
         SPACE                                                          38440002
         LTR   R0,R0                   Q.SCON PROCESSING.               38460002
         BZ    SCON                    YES,FINISH SCON CONVERSION.      38480002
* CHECK TO DETERMINE IF THE FORMAT REQUESTED IS WITH OR WITHOUT AN    * 38500002
* IMMEDIATE FIELD.                                                    * 38520002
         SPACE                                                          38540002
         LA    R1,OPSIVAL              R1='14'.                         38560002
         CLR   R1,R0                   Q.IMMEDIATE FIELD REQUESTED.     38580002
         BNE   IMMED                   YES,GET IMMEDIATE FIELD.         38600002
         B     ENDOPSI                 END FORMAT AND RETURN.           38620002
         DROP  R6                      DROP ADDRESSABILITY TO WORKAREA  38640002
         SPACE                                                          38660002
*********************************************************************** 38680002
* THE FOLLOWING INSTRUCTIONS CONVERT THE IMMEDIATE FIELD TO PRINTABLE * 38700002
* CHARACTERS AND MOVE THEM TO THE OUTPUT AREA.                        * 38720002
*********************************************************************** 38740002
         SPACE                                                          38760002
IMMED    EQU   *                                                        38780002
         LA    R1,TWO                                                   38800002
         SR    R4,R4                   R4=0                             38820002
         IC    R4,ONE(R3)              R4=IMMEDIATE FIELD.              38840002
         SRDL  R4,FOUR                 ISOLATE FIRST 4 BITS.            38860002
         LA    R7,NINE                 R7=9.                            38880002
NEXT4I   EQU   *                                                        38900002
         CLR   R4,R7                   Q-4 BITS GT 9.                   38920002
         BH    SIHI                    YES,CONVERT TO ALPHABETIC.       38940002
         LA    R4,F0(R4)               R4=4 BIT NOW PRINTABLE.          38960002
MOVEI    STC   R4,ZERO(R6)             MOVE BYTE INTO WORKAREA.         38980002
         LA    R6,ONE(R6)              R6=ADDR ONE PASS WORKAREA.       39000002
         SR    R4,R4                   CLEAR REG4.                      39020002
         SLDL  R4,FOUR                 ISOLATE NEXT FOUR BITS.          39040002
         BCT   R1,NEXT4I               IF R1=0,CONTINUE,ELSE CVT NEXT 4 39060002
         MVC   ONE(SIX,R2),HEXI        MOVE INTO CONAREA THE I PATTERN. 39080002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          39100002
         MVC   FOUR(TWO,R2),ZERO(R6)   MOVE IMMEDIATE DATA INTO CONAREA 39120002
         LA    R8,SIX(R8)              LENGTH NOW=OUTPUT LENGTH.        39140002
         B     ENDOPSI                 GO SET RETURN CODE.              39160002
SIBASE2  EQU   *                                                        39180002
         LA    R8,TWO(R8)              R8=LENGTH + 2 FOR 2 BASE DIGITS. 39200002
         MVC   ONE(TWO,R2),ONE(R6)     BASE NOW IN OUTPUT AREA.         39220002
         LA    R2,THREE(R2)            UPDATE OUTPUT POINTER.           39240002
         B     ENDISP                  GET CLOSE PARENTHESIS.           39260002
* MOVE LENGTH INTO CONAREA,GET RETURN CODE=O AND RETURN TO CALLER.    * 39280002
ENDOPSI  EQU   *                                                        39300002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           39320002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           39340002
         SR    R15,R15                 RC=0.                            39360002
         BR    R14                     RETURN TO CALLER.                39380002
* CONVERT THE ALPHABETIC HEX VALUES TO PRINTABLE CHARACTERS.          * 39400002
SIHI     EQU   *                                                        39420002
         LA    R4,B7(R4)               R4=4 BITS NOW PRINTABLE.         39440002
         B     MOVEI                   GET IMMEDIATE FIELD.             39460002
         SPACE                                                          39480002
*********************************************************************** 39500002
* THE FOLLOWING INSTRUCTIONS CONVERTS THE STORAGE OPERANDS OF THE     * 39520002
* SS INSTRUCTION TO ITS PRINTABLE FORM.                               * 39540002
*********************************************************************** 39560002
         SPACE                                                          39580002
OPSS     EQU   *                                                        39600002
         LR    R0,R4                   SAVE INDEX FACTOR.               39620002
         LA    R8,SIX                  R8=LENGTH OF MNEMONIC + 0.       39640002
         LA    R10,TWO                 R10=2.                           39660002
         L     R6,WORKAREA             R6=ADDRESS OF THE WORKAREA AREA. 39680002
         USING CVTWORK,R6              USE R6 TO ADDRESS WORKAREA       39700002
         CLI   ZERO(R3),SRPOP          Q.IS OP CODE SRP.                39720002
         BNE   GETB2D2                 NO,GET B1D1.                     39740002
         OI    CODE370,SSIMM           YES,TURN ON SS,L1,I3 FLAG.       39760002
GETB2D2  EQU   *                                                        39780002
         MVC   ZERO(TWO,R6),TWO(R3)    MOVE STORAGE OPERAND TO WORKAREA 39800002
         L     R4,ZERO(R6)             R0=STORAGE OPERANDS.             39820002
         SRL   R4,ONE6                 ISOLATE FIRST OPERAND.           39840002
         SRDL  R4,ONE2                 R4=BASE REGISTER.                39860002
         SRL   R5,TWO0                 R5=DISPLACEMENT.                 39880002
         CVD   R5,ZERO(R6)             DISP NOW PACKED DECIMAL.         39900002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      39920002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   39940002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            39960002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          39980002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         40000002
         SR    R7,R1                   LENGTH OF DISP.                  40020002
         LA    R8,ONE(R7,R8)           R8=NEW LENGTH.                   40040002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               40060002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA.            40080002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           40100002
         MVI   ZERO(R2),OPEN           MOVE IN OPEN PARENTHESIS.        40120002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           40140002
         LA    R7,ONE                  R7=1.                            40160002
         CLR   R10,R7                  Q.IS THIS THE CVT FOR B2D2       40180002
         BE    CVTB2D2                 YES,CONVERT B2D2.                40200002
         SR    R4,R4                   R4=0.                            40220002
         IC    R4,ONE(R3)              R4=LENGTH FIELD OF THE INST.     40240002
         LA    R7,OPSSVAL              R7=TYPE FORMAT INDICATOR.        40260002
         CLR   R7,R0                   Q.IS LENGTH L1 & L2.             40280002
         BNE   SSL2                    YES,IS L1 & L2.                  40300002
         TM    CODE370,SSIMM           NO.Q.IS IT L1 & I3.              40320002
         BNO   SSL1                    NO,ONLY L1.                      40340002
         SPACE                                                          40360002
* CONVERT LENGTH FIELD TO REFLECT A L1 & L2 LENGTH FIELD.             * 40380002
         SPACE                                                          40400002
SSL2     EQU   *                                                        40420002
         SRDL  R4,FOUR                 R4=L1.                           40440002
SSL1     EQU   *                                                        40460002
         LA    R4,ONE(R4)              R4=CORRECT LENGTH TO BE CONVERT. 40480002
         CVD   R4,ZERO(R6)             LENGTH NOW PACKED DECIMAL.       40500002
         MVC   EIGHT(FOUR,R6),PATTERN2 LENGTH NOW ZONED DECIMAL.        40520002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   40540002
         EDMK  EIGHT(FOUR,R6),SIX(R6)  LENGTH NOW ZONED DECIMAL.        40560002
         LA    R7,ONE2(R6)             R7=END OF ZONED DECIMAL.         40580002
         SR    R7,R1                   R7=LENGTH OF LENGTH.             40600002
         LA    R8,ZERO(R7,R8)          R8=UPDATED LENGTH.               40620002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               40640002
         EX    R7,DISPMOVE             MOVE LENGTH INTO CONAREA.        40660002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           40680002
         MVI   ZERO(R2),COMMA          SEPERATE LENGTH & BASE.          40700002
         LA    R8,ONE(R8)              UPDATE OUTPUT COUNTER.           40720002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           40740002
NOLENGTH EQU   *                                                        40760002
         SR    R4,R4                   R4=0.                            40780002
         IC    R4,TWO(R3)              R4=BASE + GARBAGE.               40800002
         SRL   R4,FOUR                 ISOLATE BASE.                    40820002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            40840002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   40860002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) BASE NOW ZONED DECIMAL.       40880002
         CLI   ONE(R6),F0              Q.IS BASE 1 OR 2 DIGITS.         40900002
         BNE   SSBASE2                 BASE IS 2 DIGITS.                40920002
         LA    R8,ONE(R8)              R8=LENGTH + NEXT OPERAND FIELD.  40940002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     40960002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           40980002
SSCOMMA  EQU   *                                                        41000002
         MVI   ZERO(R2),CLOSE          MOVE IN CLOSE PARENTHESIS.       41020002
         MVI   ONE(R2),COMMA           SEPERATE OPERANDS.               41040002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           41060002
         LA    R8,TWO(R8)              UPDATE OUTPUT COUNTER.           41080002
         LA    R3,TWO(R3)              R3=ADDR OF B1D1.                 41100002
         BCT   R10,GETB2D2             IF BEDE IS COMPLETED RETURN.     41120002
         BCTR  R8,ZERO                 R8=CORRECT LENGTH.               41140002
         TM    CODE370,SSIMM           Q.IS IT SS,L1 & I3.              41160002
         BNO   SSRETURN                NO.FINISH UP AND RETURN.         41180002
         LA    R8,ONE(R8)              UPDATE OUTPUT CTR FOR COMMA.     41200002
         S     R3,THREEWD              R3=INPUT POINTER TO L1 & I3.     41220002
         SR    R4,R4                   CLEAR R4.                        41240002
         IC    R4,ZERO(R3)             R4= L1 & I3 IN BINARY.           41260002
         SLL   R4,TWO8                 CLEAR OUT L1.                    41280002
         SRL   R4,TWO8                 ISOLATE I3.                      41300002
         CVD   R4,ZERO(R6)             I3 NOW DECIMAL.                  41320002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) I3 NOW ZONED DECIMAL.         41340002
         OI    TWO(R6),HEXF0           SIGN NOW HEX F.                  41360002
         CLI   ONE(R6),F0              Q.IS I3 1 OR 2 DIGITS.           41380002
         BNE   ITWODIG                 I3 IS 2 DIGITS.                  41400002
         LA    R8,ONE(R8)              UPDATE OUTPUT LENGTH 1 DIGIT.    41420002
         MVC   ZERO(ONE,R2),TWO(R6)    I3 NOW IN OUTPUT AREA.           41440002
         B     SSRETURN                FINISH UP AND RETURN.            41460002
ITWODIG  EQU   *                                                        41480002
         LA    R8,TWO(R8)              UPDATE OUTPUT PTR 2 DIGITS.      41500002
         MVC   ZERO(TWO,R2),ONE(R6)    I3 NOW IN OUTPUT AREA.           41520002
SSRETURN EQU   *                                                        41540002
         L     R2,CONAREA              R2=ADDR OF OUTPUTAREA.           41560002
         STC   R8,ZERO(R2)             LENGTH NOW IN OUTPUT AREA.       41580002
         SR    R15,R15                 RC=0.                            41600002
         BR    R14                     RETURN TO CALLER.                41620002
CVTB2D2  EQU   *                                                        41640002
         LA    R7,OPSSVAL              R7=X'00'.                        41660002
         CR    R0,R7                   Q.IS LENGTH L1 OR L1 AND L2.     41680002
         BE    NOLENGTH                LENGTH IS L1 ONLY.               41700002
         SR    R4,R4                   R4=0.                            41720002
         BCTR  R3,ZERO                 R3=PTR TO LENGTH FIELD.          41740002
         IC    R4,ZERO(R3)             R4=LENGTH FIELD.                 41760002
         SLL   R4,TWO8                 CLEAR OUT L1.                    41780002
         SRL   R4,TWO8                 ISOLATE L2.                      41800002
         LA    R3,ONE(R3)              ADVANCE INPUT POINTER.           41820002
         B     SSL1                    CONVERT L2.                      41840002
SSBASE2  EQU   *                                                        41860002
         MVC   ZERO(TWO,R2),ONE(R6)    REGISTER NOW IN OUTPUT AREA.     41880002
         LA    R2,TWO(R2)              R2=UPDATED OUTPUT PTR.           41900002
         LA    R8,TWO(R8)              UPDATE LENGTH COUNTER.           41920002
         B     SSCOMMA                 MOVE IN A COMMA.                 41940002
OPRX     EQU   *                                                        41960002
         DROP  R6                      DROP ADDRESSABILITY TO WORKAREA  41980002
         SPACE                                                          42000002
*********************************************************************** 42020002
* THE FOLLOWING INSTRUCTIONS CONVERTS AND FORMATS THE RX INSTRUCTIONS * 42040002
*********************************************************************** 42060002
         SPACE                                                          42080002
         LA    R8,SIX                  R8=LENGTH OF MNEMONIC + A BLANK. 42100002
         SR    R0,R0                   R8=LENGTH OF MNEMONIC+A BLANK.   42120002
         LA    R7,ONE                  R7=ONE.                          42140002
         IC    R4,ONE(R3)              R4=R1 & X2 FIELDS.               42160002
         SRDL  R4,EIGHT                R5=R1&X2 IN HIGH ORDER BYTE.     42180002
         L     R6,WORKAREA             R6=ADDR OF WORKAREA.             42200002
B2ORX2   EQU   *                                                        42220002
         SR    R4,R4                   R4=0.                            42240002
         SLDL  R4,FOUR                 ISOLATE NEXT 4 BITS OF OPERAND.  42260002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            42280002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   42300002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) R1 NOW ZONED DECIMAL.         42320002
         CLI   ONE(R6),F0              Q.IS REGISTER 1 OR 2 DIGITS.     42340002
         BNE   TWOCHAR                 REGISTER IS 2 CHARACTERS.        42360002
         LA    R8,ONE(R8)              R8=LENGTH + NEXT OPERAND FIELD.  42380002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     42400002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           42420002
COMMAGET EQU   *                                                        42440002
         MVI   ZERO(R2),COMMA          SEPERATE OPERAND FIELDS.         42460002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           42480002
         LA    R8,ONE(R8)              R8=LENGTH OF OUTPUT SO FAR.      42500002
         BCT   R7,B2ORX2               IF 7=2 CONBERT B2.               42520002
         LTR   R0,R0                   Q.B2 FIELD COMPLETED.            42540002
         BNZ   CLOSERX                 YES,CLOSE RX ROUTINE.            42560002
         LH    R4,BASEDISP(R3)         R4=BASE + DISP.                  42580002
         SLL   R4,TWO0                 DROP BASE REG.                   42600002
         SRL   R4,TWO0                 ISOLATE DISP.                    42620002
         CVD   R4,ZERO(R6)             DISP NOW PACKED DECIMAL.         42640002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      42660002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   42680002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            42700002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          42720002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         42740002
         SR    R7,R1                   R7=LENGTH OF ZONED DECIMAL.      42760002
         LA    R8,ONE(R7,R8)           R8=LENGTH + DISP LENGTH.         42780002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               42800002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA.            42820002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           42840002
         MVI   ZERO(R2),OPEN           MOVE IN C'('.                    42860002
         LA    R2,ONE(R2)              UPDATE OUTPUT PTR.               42880002
*        CONVERT AND FORMAT THE INDEX AND BASE REGISTER               * 42900002
         SR    R10,R10                 R10=0.                           42920002
         LA    R7,TWO                  R7=2.                            42940002
         IC    R10,BASEDISP(R3)        R6=BASE + DISP.                  42960002
         SLL   R10,TWO0                MOVE BASE TO HI ORDER.           42980002
         OR    R5,R10                  R5=X2 AND B2.                    43000002
         LA    R0,ONE                  R0=1,INDICATES DISP COMPLETED.   43020002
         B     B2ORX2                  FORMAT X2 & BE FIELD.            43040002
CLOSERX  EQU   *                                                        43060002
         BCTR  R2,ZERO                 R2=PTR TO PARENTHESIS FIELD.     43080002
         MVI   ZERO(R2),CLOSE          MOVE CLOSE PARENTHESIS IN.       43100002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          43120002
         STC   R8,ZERO(R2)             LENGTH OF OUTPUT NOW IN CONAREA. 43140002
         SR    R15,R15                 RETURN CODE =0.                  43160002
         BR    R14                     RETURN                           43180002
TWOCHAR  EQU   *                                                        43200002
         MVC   ZERO(TWO,R2),ONE(R6)    REGISTER NOW IN OUTPUT AREA.     43220002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           43240002
         LA    R8,TWO(R8)              R8=LENGTH + NEXT OPERAND FIELD.  43260002
         B     COMMAGET                GO MOVE IN COMMA.                43280002
*********************************************************************** 43300002
* THIS SECTION OF CODE CONVERTS BINARY INPUT TO ITS PRINTABLE SCON    * 43320002
* FORMAT (DISP(BASE)).                                                * 43340002
*********************************************************************** 43360002
IKJEGBIS EQU   *                                                        43380002
         DROP  R12                     GET NEW BASE REGISTER.           43400002
         USING *,R15                   R15 IS NEW BASE REGISTER.        43420002
         L     R12,BASECON             R12=ADDRESS OF IKJEGCV2.         43440002
         DROP  R15                     GET NEW BASE REGISTER.           43460002
         USING IKJEGCVX,R12            IKJEGCVX ADDRESSABILITY.         43480002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY.          43500002
         SR    R4,R4                   R4=0.                            43520002
         L     R3,ZERO(R1)             R3=ADDR OF INPUT STRING.         43540002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          43560002
         LA    R2,ONE(R2)              R2=ADDR ONE PASS LENGTH BYTE.    43580002
         BCTR  R3,ZERO                 R3=INPUT PTR-1.                  43600002
         BCTR  R3,ZERO                 R3=INPUT PTR-2.                  43620002
         B     OPSI                    CONVERT DISP(BASE).              43640002
SCON     EQU   *                                                        43660002
         LA    R5,SIX                  R5=6.                            43680002
         SR    R8,R5                   R8=SCON LENGTH.                  43700002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              43720002
         STC   R8,ZERO(R2)             MOVE LENGTH INTO CONAREA.        43740002
         SR    R15,R15                 R15=0.                           43760002
         BR    R14                     RETURN TO CALLER.                43780002
BASECON  DC    A(IKJEGCVX)             ADDR OF IKJEGCVX.                43800002
NOOPCODE EQU   *                                                        43820002
         LA    R15,FOUR                RC=4.                            43840002
         BR    R14                     RETURN.                          43860002
         DS    0F                                                       43880002
HEXI     DC    C',X''  '''             IMMEDIATE PATTERN.               43900002
PATTERN2 DC    X'40'                   ******************************** 43920002
         DC    3X'20'                  * PATTERN FIELD FOR THE EDIT   * 43940002
         DC    X'21'                   * AND MARK INSTRUCTION.        * 43960002
         DC    5X'20'                  ******************************** 43980002
BLANKS   DC    C'  '                   STRING OF TWO BLANKS             44000002
THREEWD  DC    F'3'                    THREE                            44020002
         EJECT                                                          44040002
         TITLE 'IKJEGCVT PRINTABLE OPCODES TABLE.'                      44060002
*********************************************************************** 44080002
* THIS CSECT CONTAINS THE TABLE PRINTABLE OPCODES WITH THEIR          * 44100002
* RESPECTIVE INSTRUCTION FORMAT CODES.                                * 44120002
*********************************************************************** 44140002
         SPACE                                                          44160002
IKJEGCOP  CSECT                                                         44180002
         DC    4XL5'00'                CODE=00,INVALID OP CODE.         44200002
         DC    C'SPM '                 SPM OP CODE.                     44220002
         DC    X'08'                   CODE=08,RR FORMAT-1 OPERAND.     44240002
         DC    C'BALR'                 BALR OP CODE.                    44260002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44280002
         DC    C'BCTR'                 BCTR OP CODE.                    44300002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44320002
         DC    C'BCR '                 BCR OP CODE.                     44340002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44360002
         DC    C'SSK '                 SSK OP CODE.                     44380002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44400002
         DC    C'ISK '                 ISK OP CODE.                     44420002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44440002
         DC    C'SVC '                 SVC INSTRUCTION.                 44460002
         DC    X'14'                   CODE=10,RR FORMAT-1 OPERAND.     44480002
         DC    2XL5'00'                CODE=00,INVALID OP CODE.         44500002
         DC    C'BASR'                 BASR OP CODE.  370 R.            44520002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44540002
         DC    C'MVCL'                 MVCL OP CODE.  370.              44560002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44580002
         DC    C'CLCL'                 CLCL OP CODE.  370.              44600002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44620002
         DC    C'LPR '                 LPR OP CODE.                     44640002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44660002
         DC    C'LNR '                 LNR OP CODE.                     44680002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44700002
         DC    C'LTR '                 LTR OP CODE.                     44720002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44740002
         DC    C'LCR '                 LCR OP CODE.                     44760002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44780002
         DC    C'NR  '                 NR OP CODE.                      44800002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44820002
         DC    C'CLR '                 CLR OP CODE.                     44840002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44860002
         DC    C'OR  '                 OR OP CODE.                      44880002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44900002
         DC    C'XR  '                 XR OP CODE.                      44920002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44940002
         DC    C'LR  '                 LR OP CODE.                      44960002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44980002
         DC    C'CR  '                 CR OP CODE.                      45000002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45020002
         DC    C'AR  '                 AR OP CODE.                      45040002
         DC    X'04'                   CODEV04,RR FORMAT-2 OPERANDS.    45060002
         DC    C'SR  '                 SR OP CODE.                      45080002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45100002
         DC    C'MR  '                 MR OP CODE.                      45120002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45140002
         DC    C'DR  '                 DR OP CODE.                      45160002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45180002
         DC    C'ALR '                 ALR OP CODE.                     45200002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45220002
         DC    C'SLR '                 SLR OP CODE.                     45240002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45260002
         DC    C'LPDR'                 LPDR OP CODE.                    45280002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45300002
         DC    C'LNDR'                 LNDR OP CODE.                    45320002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45340002
         DC    C'LTDR'                 LTDR OP CODE.                    45360002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45380002
         DC    C'LCDR'                 LCDR OF CODE.                    45400002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45420002
         DC    C'HDR '                 HDR OP CODE.                     45440002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45460002
         DC    C'LRDR'                 LRDR OP CODE.                    45480002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45500002
         DC    C'MXR '                 MXR OP CODE.                     45520002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45540002
         DC    C'MXDR'                 MXDR OP CODE.                    45560002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45580002
         DC    C'LDR '                 LDR OP CODE.                     45600002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45620002
         DC    C'CDR '                 CDR OP CODE.                     45640002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45660002
         DC    C'ADR '                 ADR OP CODE.                     45680002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45700002
         DC    C'SDR '                 SDR OP CODE.                     45720002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERADS.     45740002
         DC    C'MDR '                 MDR OP CODE.                     45760002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45780002
         DC    C'DDR '                 DDR OP CODE.                     45800002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45820002
         DC    C'AWR '                 AWR OP CODE.                     45840002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45860002
         DC    C'SWR '                 SWR OP CODE.                     45880002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45900002
         DC    C'LPER'                 LPER OP CODE.                    45920002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45940002
         DC    C'LNER'                 LNER OP CODE.                    45960002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45980002
         DC    C'LTER'                 LTER OP CODE.                    46000002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46020002
         DC    C'LCER'                 LCER OP CODE.                    46040002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46060002
         DC    C'HER '                 HER OP CODE.                     46080002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46100002
         DC    C'LRER'                 LRER OP CODE.                    46120002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46140002
         DC    C'AXR '                 AXR OP CODE.                     46160002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46180002
         DC    C'SXR '                 SXR OP CODE.                     46200002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46220002
         DC    C'LER '                 LER OP CODE.                     46240002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46260002
         DC    C'CER '                 CER OP CODE.                     46280002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46300002
         DC    C'AER '                 AER OP CODE.                     46320002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46340002
         DC    C'SER '                 SER OP CODE.                     46360002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46380002
         DC    C'MER '                 MER OP CODE.                     46400002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46420002
         DC    C'DER '                 DER OP CODE.                     46440002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46460002
         DC    C'AUR '                 AUR OP CODE.                     46480002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46500002
         DC    C'SUR '                 SUR OP CODE.                     46520002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46540002
         DC    C'STH '                 STH OP CODE.                     46560002
         DC    X'28'                   CODE=28,RX FORMAT.               46580002
         DC    C'LA  '                 LA OP CODE.                      46600002
         DC    X'28'                   CODE=28,RX FORMAT.               46620002
         DC    C'STC '                 STC OP CODE.                     46640002
         DC    X'28'                   CODE=28,RX FORMAT.               46660002
         DC    C'IC  '                 IC  OP CODE.                     46680002
         DC    X'28'                   CODE=28,RX FORMAT.               46700002
         DC    C'EX  '                 EX OP CODE.                      46720002
         DC    X'28'                   CODE=28,RX FORMAT.               46740002
         DC    C'BAL '                 BAL OP CODE.                     46760002
         DC    X'28'                   CODE=28,RX FORMAT.               46780002
         DC    C'BCT '                 BCT OP CODE.                     46800002
         DC    X'28'                   CODE=28,RX FORMAT.               46820002
         DC    C'BC  '                 BC OP CODE.                      46840002
         DC    X'28'                   CODE=28,RX FORMAT.               46860002
         DC    C'LH  '                 LH OP CODE.                      46880002
         DC    X'28'                   CODE=28,RX FORMAT.               46900002
         DC    C'CH  '                 CH OP CODE.                      46920002
         DC    X'28'                   CODE=28,RX FORMAT.               46940002
         DC    C'AH  '                 AH OP CODE.                      46960002
         DC    X'28'                   CODE=28,RX FORMAT.               46980002
         DC    C'SH  '                 SH OP CODE.                      47000002
         DC    X'28'                   CODE=28,RX FORMAT.               47020002
         DC    C'MH  '                 MH OP CODE.                      47040002
         DC    X'28'                   CODE=28,RX FORMAT.               47060002
         DC    C'BAS '                 BAS OP CODE. 370 R.              47080002
         DC    X'28'                   CODE=28,RX FORMAT.               47100002
         DC    C'CVD '                 CVD OP CODE.                     47120002
         DC    X'28'                   CODE=28,RX FORMAT.               47140002
         DC    C'CVB '                 CVB OP CODE                      47160002
         DC    X'28'                   CODE=28,RX FORMAT.               47180002
         DC    C'ST  '                 ST OP CODE.                      47200002
         DC    X'28'                   CODE=28,RX FORMAT.               47220002
         DC    3XL5'00'                CODE=00,INVALID OP CODE.         47240002
         DC    C'N   '                 N OP CODE.                       47260002
         DC    X'28'                   CODE=28,RX FORMAT.               47280002
         DC    C'CL  '                 CL OP CODE.                      47300002
         DC    X'28'                   CODE=28,RX FORMAT.               47320002
         DC    C'O   '                 O OP CODE.                       47340002
         DC    X'28'                   CODE=28,RX FORMAT.               47360002
         DC    C'X   '                 X OP CODE.                       47380002
         DC    X'28'                   CODE=28,RX FORMAT.               47400002
         DC    C'L   '                 L OP CODE                        47420002
         DC    X'28'                   CODE=28,RX FORMAT.               47440002
         DC    C'C   '                 C OP CODE.                       47460002
         DC    X'28'                   CODE=28,RX FORMAT.               47480002
         DC    C'A   '                 A OP CODE.                       47500002
         DC    X'28'                   CODE=28,RX FORMAT.               47520002
         DC    C'S   '                 S OP CODE.                       47540002
         DC    X'28'                   CODE=28,RX FORMAT.               47560002
         DC    C'M   '                 M OP CODE.                       47580002
         DC    X'28'                   CODE=28,RX FORMAT.               47600002
         DC    C'D   '                 D OP CODE.                       47620002
         DC    X'28'                   CODE=28,RX FORMAT.               47640002
         DC    C'AL  '                 AL OP CODE.                      47660002
         DC    X'28'                   CODE=28,RX FORMAT.               47680002
         DC    C'SL  '                 SL OP CODE.                      47700002
         DC    X'28'                   CODE=28,RX FORMAT.               47720002
         DC    C'STD '                 STD OP CODE.                     47740002
         DC    X'28'                   CODE=28,RX FORMAT.               47760002
         DC    6XL5'00'                CODE=00,INVALID OP CODE.         47780002
         DC    C'MXD '                 MXD OP CODE.                     47800002
         DC    X'28'                   CODE=28,RX FORMAT.               47820002
         DC    C'LD  '                 LD OP CODE.                      47840002
         DC    X'28'                   CODE=28,RX FORMAT.               47860002
         DC    C'CD  '                 CD OP CODE.                      47880002
         DC    X'28'                   CODE=28,RX FORMAT.               47900002
         DC    C'AD  '                 AD OP CODE.                      47920002
         DC    X'28'                   CODE=28,RX FORMAT.               47940002
         DC    C'SD  '                 SD OP CODE.                      47960002
         DC    X'28'                   CODE=28,RX FORMAT.               47980002
         DC    C'MD  '                 MD OP CODE.                      48000002
         DC    X'28'                   CODE=28,RX FORMAT.               48020002
         DC    C'DD  '                 DD OP CODE.                      48040002
         DC    X'28'                   CODE=28,RX FORMAT.               48060002
         DC    C'AW  '                 AW OP CODE.                      48080002
         DC    X'28'                   CODE=28,RX FORMAT.               48100002
         DC    C'SW  '                 SW OP CODE.                      48120002
         DC    X'28'                   CODE=28,RX OP CODE.              48140002
         DC    C'STE '                 STE OP CODE.                     48160002
         DC    X'28'                   CODE=28,RX FORMAT.               48180002
         DC    7XL5'00'                CODE=00,INVALID OP CODE.         48200002
         DC    C'LE  '                 LE OP CODE.                      48220002
         DC    X'28'                   CODE=28,RX FORMAT.               48240002
         DC    C'CE  '                 CE OP CODE.                      48260002
         DC    X'28'                   CODE=28,RX FORMAT.               48280002
         DC    C'AE  '                 AE OP CODE.                      48300002
         DC    X'28'                   CODE=28,RX FORMAT.               48320002
         DC    C'SE  '                 SE OP CODE.                      48340002
         DC    X'28'                   CODE=28,RX FORMAT.               48360002
         DC    C'ME  '                 ME OP CODE.                      48380002
         DC    X'28'                   CODE=28,RX FORMAT.               48400002
         DC    C'DE  '                 DE OP CODE.                      48420002
         DC    X'28'                   CODE=28,RX FORMAT.               48440002
         DC    C'AU  '                 AU OP CODE.                      48460002
         DC    X'28'                   CODE=28,RX FORMAT.               48480002
         DC    C'SU  '                 SU OP CODE.                      48500002
         DC    X'28'                   CODE=28,RX FORMAT.               48520002
         DC    C'SSM '                 SSM OP CODE.                     48540002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 48560002
         DC    XL5'00'                 CODE=00 INVALID OP CODE.         48580002
         DC    C'LPSW'                 LPSW OP CODE.                    48600002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 48620002
         DC    C'DIAG'                 DIAGNOSE INSTRUCTION.            48640002
         DC    X'18'                   CODE=18,DIAGNOSE FOR CE.         48660002
         DC    C'WRD '                 WRD OP CODE.                     48680002
         DC    X'18'                   CODE=18,5I FORMAT.               48700002
         DC    C'RDD '                 RDD OP CODE.                     48720002
         DC    X'18'                   CODE=18,SI FORMAT.               48740002
         DC    C'BXH '                 BXH OP CODE.                     48760002
         DC    X'0C'                   CODE=0C,RS FORMAT.               48780002
         DC    C'BXLE'                 BXLE OP CODE.                    48800002
         DC    X'0C'                   CODE=0C,RS FORMAT.               48820002
         DC    C'SRL '                 SRL OP CODE.                     48840002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48860002
         DC    C'SLL '                 SLL OP CODE.                     48880002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48900002
         DC    C'SRA '                 SRA OP CODE.                     48920002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48940002
         DC    C'SLA '                 SLA OP CODE.                     48960002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48980002
         DC    C'SRDL'                 SRDL OP CODE.                    49000002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49020002
         DC    C'SLDL'                 SLDL OP CODE.                    49040002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49060002
         DC    C'SRDA'                 SRDA OP CODE.                    49080002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49100002
         DC    C'SLDA'                 SLDA OP CODE.                    49120002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49140002
         DC    C'STM '                 STM OP CODE.                     49160002
         DC    X'0C'                   CODE=0C,RS FORMAT.               49180002
         DC    C'TM  '                 TM OP CODE.                      49200002
         DC    X'18'                   CODE=1C,SI FORMAT.               49220002
         DC    C'MVI '                 MVI OP CODE.                     49240002
         DC    X'18'                   CODE=1C,SI FORMAT.               49260002
         DC    C'TS  '                 TS OP CODE.                      49280002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49300002
         DC    C'NI  '                 NI OP CODE.                      49320002
         DC    X'18'                   CODE=18,SI FORMAT.               49340002
         DC    C'CLI '                 CLI OP CODE.                     49360002
         DC    X'18'                   CODE=18,SI FORMAT.               49380002
         DC    C'OI  '                 OI OP CODE.                      49400002
         DC    X'18'                   CODE=18,SI FORMAT.               49420002
         DC    C'XI  '                 XI OP CODE.                      49440002
         DC    X'18'                   CODE=18,SI FORMAT.               49460002
         DC    C'LM  '                 LM OP CODE.                      49480002
         DC    X'0C'                   CODE=0C,RS FORMAT.               49500002
         DC    3XL5'00'                CODE=00,INVALID OP CODE.         49520002
         DC    C'SIO '                 SIO OP CODE.                     49540002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49560002
         DC    C'TIO '                 TIO OP CODE.                     49580002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49600002
         DC    C'HIO '                 HIO OP CODE.                     49620002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49640002
         DC    C'TCH '                 TCH OP CODE.                     49660002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49680002
         DC    12XL5'00'               CODE=00,INVALID OP CODES.        49700002
         DC    C'TNSM'                 STNSM OP CODE. 370 R             49720002
         DC    X'18'                   CODE=18,SI FORMAT                49740002
         DC    C'TOSM'                 STOSM OP CODE. 370 R             49760002
         DC    X'18'                   CODE=18,SI FORMAT                49780002
         DC    C'SIGP'                 SIGP OP CODE. 370 R              49800002
         DC    X'0C'                   CODE=0C,RS FORMAT                49820002
         DC    C'MC  '                 MC OP CODE. 370                  49840002
         DC    X'18'                   CODE=18,SI FORMAT                49860002
         DC    1XL5'00'                CODE=00,INVALID OP CODES.        49880002
         DC    C'LRA '                 LRA OP CODE. 370 R               49900002
         DC    X'28'                   CODE=28,RX FORMAT                49920002
         DC    4XL5'00'                CODE=00,INVALID OP CODES.        49940002
         DC    C'TCTL'                 STCTL OP CODE. 370               49960002
         DC    X'0C'                   CODE=0C,RS FORMAT                49980002
         DC    C'LCTL'                 LCTL OP CODE. 370.               50000002
         DC    X'0C'                   CODE=0C,RS FORMAT.               50020002
         DC    2XL5'00'                CODE=00,INVALID OP CODES@ZA11367 50040003
         DC    C'CS  '                 CS OP CODE. 370.        @ZA11367 50042003
         DC    X'0C'                   CODE=0C,RS FORMAT.      @ZA11367 50044003
         DC    C'CDS '                 CDS OP CODE. 370.       @ZA11367 50046003
         DC    X'0C'                   CODE=0C,RS FORMAT.      @ZA11367 50048003
         DC    XL5'00'                 CODE=00,INVALID OP CODE.@ZA11367 50050003
         DC    C'CLM '                 CLM OP CODE. 370.                50060002
         DC    X'0C'                   CODE=0C,R1,M3.                   50080002
         DC    C'STCM'                 STCM OP CODE. 370.               50100002
         DC    X'0C'                   CODE=0C,R1,M3.                   50120002
         DC    C'ICM '                 ICM OP CODE. 370.                50140002
         DC    X'0C'                   CODE=0C,R1,M3.                   50160002
         DC    17XL5'00'               CODE=00,INVALID OP CODES.        50180002
         DC    C'MVN '                 MVN OP CODE.                     50200002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50220002
         DC    C'MVC '                 MVC OP CODE.                     50240002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50260002
         DC    C'MVZ '                 MVZ OP CODE.                     50280002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50300002
         DC    C'NC  '                 NC OP CODE.                      50320002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50340002
         DC    C'CLC '                 CLC OP CODE.                     50360002
         DC    X'20'                   CODE=20,SS FORAMT L1.            50380002
         DC    C'OC  '                 OC OP CODE.                      50400002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50420002
         DC    C'XC  '                 XC OP CODE.                      50440002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50460002
         DC    4XL5'00'                CODE=00,INVALID OP CODE.         50480002
         DC    C'TR  '                 TR OP CODE.                      50500002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50520002
         DC    C'TRT '                 TRT OP CODE.                     50540002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50560002
         DC    C'ED  '                 ED OP CODE.                      50580002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50600002
         DC    C'EDMK'                 EDMK OP CODE.                    50620002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50640002
         DC    16XL5'00'               CODE=00,INVALID OP CODE.         50660002
         DC    C'SRP '                  SRP OP CODE. 370.               50680002
         DC    X'20'                   CODE=20 SS FORMAT L1 WITH I.     50700002
         DC    C'MVO '                 MVO OP CODE.                     50720002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50740002
         DC    C'PACK'                 PACK OP OCDE.                    50760002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50780002
         DC    C'UNPK'                 UNPK OP CODE.                    50800002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50820002
         DC    4XL5'00'                CODE=00,INVALID OP CODE.         50840002
         DC    C'ZAP '                 ZAP OP CODE.                     50860002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50880002
         DC    C'CP  '                 CP OP CODE.                      50900002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50920002
         DC    C'AP  '                 AP OP CODE.                      50940002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50960002
         DC    C'SP  '                 SP OP CODE.                      50980002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       51000002
         DC    C'MP  '                 MP OP CODE.                      51020002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       51040002
         DC    C'DP  '                 DP OP CODE.                      51060002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       51080002
         DC    2XL5'00'                CODE=00,INVALID OP CODE.         51100002
OPTABLN  EQU   *-IKJEGCOP              LENGTH OF ONE BYTE OP TABLE      51120002
         EJECT                                                          51140002
*********************************************************************** 51160002
* BEGINNING OF 370 TWO BYTE OP CODE TABLE. EACH OP CODE BEGINS WITH   * 51180002
* ONE BYTE OF B2 AND THEN ANOTHER UNIQUE SECOND BYTE. THIS TABLE      * 51200002
* INCLUDES ONLY UP TO THE RRB OP CODE (370-R B213) AND CAN BE         * 51220002
* EXPANDED IN THE FUTURE IF NECESSARY.                                * 51240002
*********************************************************************** 51260002
         SPACE                                                          51280002
IKJEGCD2 CSECT                                                          51300002
         DC    2XL6'00'                CODE=00,INVALID OP CODES.        51320002
         DC    C'STIDP'                STIDP OP CODE. 370.              51340002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51360002
         DC    C'STIDC'                STIDC OP CODE. 370.              51380002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51400002
         DC    C'SCK  '                SCKC OP CODE. 370.               51420002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51440002
         DC    C'STCK '                SCKC OP CODE. 370.               51460002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51480002
         DC    C'SCKC '                SCKC OP CODE. 370-R              51500002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51520002
         DC    C'STCKC'                STCKC OP CODE. 370-R             51540002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51560002
         DC    C'SPT  '                SPT OP CODE. 370-R               51580002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51600002
         DC    C'STPT '                STPT OP CODE. 370-R              51620002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51640002
         DC    3XL6'00'                00 OP CODE. INVALID              51660002
         DC    C'PTLB '                PTLB OP CODE. 370-R              51680002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51700002
         DC    2XL6'00'                00 OP CODE. INVALID              51720002
         DC    C'SPX  '                SPX OP CODE. 370-R               51740002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51760002
         DC    C'STPX '                STPX OP CODE. 370-R              51780002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51800002
         DC    C'STAP '                STAP OP CODE. 370-R              51820002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51840002
         DC    C'RRB  '                RRB OP CODE. 370-R               51860002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51880002
OPCD2LN  EQU   *-IKJEGCD2              LENGTH OF 370 (B2) OP TABLE      51900002
         EJECT                                                          51920002
         TITLE 'IKJEGCVT' CVT MESSAGE CSECT.                            51940002
IKJEGFLT CSECT                                                          51960002
         SPACE                                                          51980002
*********************************************************************** 52000002
*                                                                     * 52020002
* THIS CSECT IS AN EXTENSION OF THE CONVERT ROUTINE(IKJEGCVT).  THE   * 52040002
* FOLLOWING LINES OF CODE IN THIS CSECT WILL CONVERT THE FLOATING     * 52060002
* POINT DATA.                                                         * 52080002
*********************************************************************** 52100002
         SPACE                                                          52120002
REMAIN   EQU   X'01'                   HEX 01                           52140002
AONE1    EQU   X'F1'                   HEX F1                           52160002
AFIVE    EQU   C'5'                    CHARACTER 5                      52180002
DOBLEND  EQU   24                      END OF DOUBLE ZONED DECIMAL.     52200002
ADJUST37 EQU   37                      DEC 37                           52220002
OFFSET39 EQU   39                      DEC 39                           52240002
HEX85    EQU   X'85'                   HEX 85                           52260002
HEX10    EQU   X'10'                   HEX 10                           52280002
HEX1C    EQU   X'1C'                   HEX 1C                           52300002
OFFSET40 EQU   40                      DEC 40                           52320002
FIVE3    EQU   53                      DEC 53                           52340002
FIVE4    EQU   54                      DEC 54                           52360002
HEX20    EQU   X'20'                   HEX 20                           52380002
SIX4     EQU   64                      DEC 64                           52400002
ONE8     EQU   18                      DEC 18                           52420002
         ENTRY IKJEGFTB                                                 52440002
         ENTRY IKJEGBFT                                                 52460002
         SPACE                                                          52480002
*********************************************************************** 52500002
*                                                                     * 52520002
* THE FOLLOWING INSTRUCTIONS CONVERT A FLOATING POINT BINARY VALUE    * 52540002
* TO ITS PRINTABLE FORMAT.                                            * 52560002
*                                                                     * 52580002
*********************************************************************** 52600002
         SPACE                                                          52620002
IKJEGBFT EQU   *                                                        52640002
         LR    R12,R15                 R12= ADDRESS OF IKJEGFLT.        52660002
         USING IKJEGFLT,R12            IKJEGFLT ADDRESSABILITY.         52680002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          52700002
         USING CVTWORK,R3              WORKAREA ADDRESSABILITY.         52720002
         LH    R6,FOUR(R1)             R6=LENGTH OF INPUT.              52740002
         LR    R0,R6                   SAVE LENGTH OF INPUT.            52760002
         L     R1,ZERO(R1)             R1=ADDRESS OF INPUT STRING.      52780002
         XC    FLTINPUT,FLTINPUT       CLEAR INPUT AREA OF GARBAGE.     52800002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               52820002
         BCTR  R6,ZERO                 *                                52840002
         LTR   R6,R6                   Q.SKIP MOVE INSTRUCTION.         52860002
         BM    SKIPMOVE                YES,SKIP MOVE INSTRUCTION.       52880002
         EX    R6,FLTMOVE              MOVE INPUT INTO WORKAREA.        52900002
SKIPMOVE EQU   *                                                        52920002
         LM    R4,R5,FLTINPUT          INPUT NOW IN WORK REGISTERS.     52940002
         IC    R7,ZERO(R1)             R7=CHARACTERISTICS.              52960002
         N     R7,SIGNOFF              TURN OFF FRACTION SIGN.          52980002
         LTR   R6,R6                   Q.EXP ONLY SPECIFIED.            53000002
         BM    EXPONLY                 YES,CONVERT EXPONENT.            53020002
         LTR   R4,R4                   Q.ZERO FRACTION SPECIFIED.       53040002
         BNZ   NONZERO                 NO - GO GET EXPONENT.    YA00086 53042002
         LTR   R5,R5                   Q.ZERO FRACTION          YA00086 53050002
*                                      SPECIED.                         53052002
         BZ    ZEROFRAC                YES, PASS A ZERO.                53060002
NONZERO  DS    0H                                                       53070002
         SH    R7,FLTCHAR              DECIMAL POINT NOW 6 DIGITS TO    53080002
*                                      RIGHT AND EXP VALUE DETERMINE.   53100002
         LTR   R5,R5                   Q.IS THIS SINGLE PRECISION.      53120002
         BNZ   FLTLONG                 NO,CONVERT LONG PRECISION.       53140002
         SPACE                                                          53160002
*********************************************************************** 53180002
* THIS SECTION OF CODE WILL CONVERT THE FRACTION OF A SINGLE          * 53200002
* PRECISION FLOATING POINT BINARY TO ZONED DECIMAL                    * 53220002
*********************************************************************** 53240002
         SPACE                                                          53260002
         CVD   R4,PACKAREA             FRACTION NOW CONVERTED TO PACKED 53280002
         OI    PACKAREA+SEVEN,SIGNF    DECIMAL.                         53300002
         UNPK  FLTSTG(ONE5),PACKAREA   FRACTION NOW ZONED DECIMAL       53320002
         LA    R6,FLTSTG+ONE5          R6=ADDR OF END OF ZONED DEC.     53340002
SUPPRESS EQU   *                                                        53360002
* THE FOLLOWING INSTRUCTIONS SUPPRESSES LEADING ZEROES.               * 53380002
         SPACE                                                          53400002
         LA    R8,FLTSTG               R8=ADDR OF ZONED DATA.           53420002
FLTLOOP  EQU   *                                                        53440002
         CLI   ZERO(R8),F0             SUPPRESS INSIGNIFICANT LEADING   53460002
         BNE   SIGFOUND                ZEROES.                          53480002
         LA    R8,ONE(R8)              GET NEXT DIGIT.                  53500002
         B     FLTLOOP                 CHECK NEXT DIGIT.                53520002
SIGFOUND EQU   *                                                        53540002
         SR    R2,R2                   R0=0                             53560002
         SR    R6,R8                   R6=LENGTH OF SIGNIFICANT DATA.   53580002
         STH   R6,FLTLEN               LENGTH NOW IN SAVE AREA.         53600002
         LTR   R7,R7                   Q.WHICH TYPE OF CVT IS NEEDED.   53620002
         BP    FLTADD                  DECIMAL ADD TO ITSELF.           53640002
         BM    FLTDIV                  DIVISION BY TWO.                 53660002
         EX    R6,ZONEMOVE             LEFT JUSTIFY ZONED DATA.         53680002
        LA     R8,FLTSTG                                                53700002
        LA     R8,ZERO(R6,R8)                                           53720002
         B     CHAR                    COMPUTE EXP VALUE.               53740002
FLTADD   EQU   *                                                        53760002
         SPACE                                                          53780002
*********************************************************************** 53800002
*                                                                     * 53820002
* THE FOLLOWING INSTRUCTIONS CONVERT THE ZONED DECIMAL FRACTION TO ITS* 53840002
* PROPER INTEGER FORM.                                                * 53860002
*                                                                     * 53880002
*********************************************************************** 53900002
         SPACE                                                          53920002
         LA    R5,FLTSTG+OFFSET40      MANTISSA RIGHT ALIGNED.          53940002
         SLL   R7,TWO                  MULTIPLY EXP BY FOUR.            53960002
         SR    R5,R6                   R5=PTR TO NEW WORKAREA.          53980002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               54000002
         EX    R6,ALIGNMVC             MOVE FRACTION FOR ADDITION.      54020002
         LH    R6,FLTLEN               R6=LENGTH OF FRACTION.           54040002
FLTSIM   EQU   *                                                        54060002
         LA    R8,FLTSTG+OFFSET39      SET UP TO BEGIN ADD.             54080002
         SR    R5,R5                   R5=0                             54100002
ADDNEXT  IC    R4,ZERO(R8)             R4=BYTE TO BE CONVERTED.         54120002
         N     R4,FLTCLEAR             R4=4 BIT VALUE.                  54140002
         AR    R4,R4                   ADD DIGIT TO ITSELF.             54160002
         AR    R4,R5                   ADD PREVIOUS CARRY.              54180002
         LA    R5,ONE                  R5=CARRY VALUE.                  54200002
         SH    R4,FLT10                IS THERE A CARRY.                54220002
         BNM   ACARRY                  YES.                             54240002
         AH    R4,FLT10                RESTORE VALUE.                   54260002
         SR    R5,R5                   CLEAR CARRY VALUE.               54280002
ACARRY   EQU   *                                                        54300002
         LA    R4,F0(R4)               CONVERT VALUE TO PRINTABLE.      54320002
         STC   R4,ZERO(R8)             SAVE THE RESULTS.                54340002
         BCTR  R8,ZERO                 ADJUST POINTER.                  54360002
         BCT   R6,ADDNEXT              ADD NEXT BYTE.                   54380002
         LH    R6,FLTLEN               R6=LENGTH.                       54400002
         LTR   R5,R5                   Q.IS THERE A CARRY.              54420002
         BZ    LASTZERO                NO,DO NOT MOVE IN A 1.           54440002
         MVI   ZERO(R8),AONE1          MOVE IN A PRINTABLE 1.           54460002
         BCTR  R8,ZERO                 POINT TO NEXT BYTE.              54480002
         AR    R6,R5                   UPDATE NUMBER OF DIGITS.         54500002
         STH   R6,FLTLEN               SAVE LENGTH.                     54520002
         LA    R5,FLTSTG               R5=ADDR OF WORK AREA.            54540002
         CR    R5,R8                   ANY TRUNCATION NEEDED.           54560002
         BE    TRUNCATE                YES.                             54580002
LASTZERO BCT   R7,FLTSIM               NO.                              54600002
         LA    R8,ONE(R8)              ADJUST ZONE DECIMAL POINTER.     54620002
         EX    R6,ZONEMOVE             ADJUST ZONED DECIMAL.            54640002
         LA    R8,FLTSTG               R8=ADDR OF ZONE DECIMAL.         54660002
         CH    R6,FLT17                Q.ZONE DECIMAL TOO LONG.         54680002
         BL    NOTLONG                 NO,SKIP LENGTH CORRECTION.       54700002
         LA    R8,ONE7(R8)             INCREMENT BY 17                  54720002
         MVI   FLTLEN+ONE,ONE7         NEW LENGTH IN LENGTH FIELD.      54740002
         B     CHAR                    GO CONVERT CHARACTERISTICS.      54760002
NOTLONG  EQU   *                                                        54780002
         LA    R8,ZERO(R6,R8)          R8=PTR TO END OF ZONED DATA.     54800002
         B     CHAR                    GO CONVERT CHARACTERISTICS.      54820002
TRUNCATE EQU   *                                                        54840002
         SH    R6,FLTDEC2              CORRECT LENGTH FOR TRUNCATION.   54860002
         STH   R6,FLTLEN               NEW LNG IN LNG SAVE AREA.        54880002
         SH    R2,FLTDEC2                                               54900002
         LA    R8,FLTSTG+ADJUST37      RIGHT ADJUST THE NUMBER          54920002
FBYTEMVC MVC   TWO(ONE,R8),ZERO(R8)    IN WORK AREA.                    54940002
         BCTR  R8,ZERO                 ALTER POINTER TO NEXT TYTE.      54960002
         BCT   R6,FBYTEMVC             GET NEXT BYTE.                   54980002
         LH    R6,FLTLEN               R6=NEW LENGTH.                   55000002
         CH    R7,HALFONE              Q.LAST MULTIPLY.                 55020002
         BNE   NOTLAST                 NO,DO NOT ALTER POINTER.         55040002
         LA    R8,TWO(R8)              R8=PT TO SIGNIFICANT DIGITS.     55060002
NOTLAST  EQU   *                                                        55080002
         B     LASTZERO                CHECK FOR MORE VALUES TO ADD.    55100002
FLTDIV   EQU   *                                                        55120002
         SPACE                                                          55140002
*********************************************************************** 55160002
*                                                                     * 55180002
* THE FOLLOWING LINES OF CODE CONVERTS THE ZONED DECIMAL MANTISSA TO  * 55200002
* ITS PROPER ZONED DECIMAL MANTISSA.                                  * 55220002
*                                                                     * 55240002
*********************************************************************** 55260002
         SPACE                                                          55280002
         LPR   R7,R7                   R7,NOW POSITIVE.                 55300002
         SLL   R7,TWO                  MULTIPLY BY FOUR.                55320002
         BCTR  R6,ZERO                 R6=LENGTH OF ZONED DECIMAL.      55340002
         EX    R6,ZONEMOVE             LEFT JUSTIFY ZONED DECIMAL.      55360002
SCALE    LH    R6,FLTLEN               LENGTH NOW IN REGISTER.          55380002
         SR    R5,R5                   R5=ZERO.                         55400002
         LA    R8,FLTSTG               R8=POINTER TO ZONED DECIMAL.     55420002
         CLI   ZERO(R8),AZERO          CHECK TO SUPPRESS LEADING ZEROS. 55440002
         BNE   NEXTDIV                 BRANCH PROCESS DIGIT.            55460002
         BCTR  R6,ZERO                 DECREMENT LENGTH.                55480002
         STH   R6,FLTLEN               SAVE CORRECT LENGTH.             55500002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               55520002
         EX    R6,ZONEJUST             LEFT JUSTIFY THE SIGNIF.DIGITS.  55540002
         SR    R5,R5                   R5=ZERO.                         55560002
         LA    R6,ONE(R6)              R6=CORRECT LENGTH.               55580002
NEXTDIV  EQU   *                                                        55600002
         IC    R4,ZERO(R8)             SIMULATE DIVISION BY TWO.        55620002
         N     R4,FLTCLEAR             R4=4 BIT VALUE.                  55640002
         SRL   R4,ONE                  R4=VALUE DIVIDED BY TWO.         55660002
         AR    R4,R5                   COMBINE THE PARTIAL QUOTIENT.    55680002
         LA    R4,F0(R4)               VALUE NOW PRINTABLE CHARACTER.   55700002
         SR    R5,R5                   R5=ZERO.                         55720002
         TM    ZERO(R8),REMAIN         CHECK FOR REMAINDER.             55740002
         BZ    SKIPCARY                SKIP CARRY FLAG SET.             55760002
         LA    R5,FIVE                 R5=5,CARRY FLAG.                 55780002
SKIPCARY EQU   *                                                        55800002
         STC   R4,ZERO(R8)             MOVE NEW VALUE IN STRING.        55820002
         LA    R8,ONE(R8)              UPDATE STRING POINTER.           55840002
         BCT   R6,NEXTDIV              BRANCH TO PROCESS NEXT DIGIT.    55860002
         LH    R6,FLTLEN               R6=CORRECT LENGTH.               55880002
         LTR   R5,R5                   ANY FINAL PARTIAL QUOTIENT.      55900002
         BZ    NOFINAL                 NO,SKIP FINAL ADJUSTMENT.        55920002
         CH    R6,FLT20                Q.FINAL PARTIAL QUOTIENT.        55940002
         BNL   ADJUSTIT                YES,ADJUST RESULTS.              55960002
         MVI   ZERO(R8),AFIVE          MOVE IN A CHARACTER FIVE.        55980002
         LA    R2,ONE(R2)              INCREMENT POINTER.               56000002
         LA    R6,ONE(R6)                                               56020002
         STH   R6,FLTLEN               SAVE LENGTH.                     56040002
JUSTEND  EQU   *                                                        56060002
         LA    R8,ONE(R8)              UPDATE POINTER.                  56080002
NOFINAL  EQU   *                                                        56100002
         BCT   R7,SCALE                BRANCH IF SCALING IS NOT ZERO.   56120002
CHAR     EQU   *                                                        56140002
*********************************************************************** 56160002
*                                                                     * 56180002
* THE FOLLOWING LINES OF CODE CALCULATE THE NUMBER OF SIGNIFICANT     * 56200002
* DIGITS AND ROUND OFF THE SIGNIFICANTS.                              * 56220002
*                                                                     * 56240002
*********************************************************************** 56260002
         SPACE                                                          56280002
         CLI   FLTSTG,AZERO            Q.AN ZERO.                       56300002
         BNE   NOZERO                  NO,CONTINUE PROCESSING.          56320002
         BCTR  R8,ZERO                 DECREMENT R8 BY ONE              56330002
         LH    R6,FLTLEN               R6= LENGTH                       56332002
         BCTR  R6,ZERO                 ALSO DECREMENT LENGTH BY ONE     56334002
         STH   R6,FLTLEN               RESTORE THE LENGTH               56336002
         EX    R6,MOVEFLT              LEFT JUSTIFY ZONE DECIMAL.       56360002
NOZERO   EQU   *                                                        56380002
         LR    R4,R0                   R4=LENGTH OF INPUT.              56400002
         BCTR  R4,ZERO                 R4=FRACTION LENGTH.              56420002
         LR    R5,R4                   R5=FRACTION LENGTH.              56440002
         SLL   R4,ONE                  ******************************** 56460002
         LA    R5,ONE(R5)              * CALCULATE THE NUMBER OF      * 56480002
         SRL   R5,ONE                  * SIGNIFICANT DIGITS.          * 56500002
         AR    R4,R5                   ******************************** 56520002
         CH    R4,FLT17                Q.LENGTH GREATER THAN 16.        56540002
         BL    NOALTER                 NO,DO NOT ALTER LENGTH.          56560002
         BCTR  R4,ZERO                 R4=CORRECT SIGNIFICANT LENGTH.   56580002
NOALTER  EQU   *                                                        56600002
         CH    R4,FLTLEN               Q.SIGNIFICANT GREATER THAN LENG. 56620002
         BH    ENDSIGNF                NO,SKIP SIGNIFICANT ALTER.       56640002
         LR    R0,R4                   R0=NUMBER OF SIGNIFICANT DIGITS. 56660002
         LA    R5,ONE                  R5=1.                            56680002
         NR    R5,R4                   Q.LENGTH ODD.                    56700002
         BM    SKIPSHIF                YES,DO NOT SHIFT.                56720002
         BCTR  R4,ZERO                 SET UP EVEN SIGNIFICANT.         56740002
SKIPSHIF EQU   *                                                        56760002
         SRL   R4,ONE                  CALCULATE NUMBER OF OUTPUT BUTES 56780002
         LA    R4,ONE(R4)              FOR PACK INSTRUCTION.            56800002
         CH    R0,FLT17                Q.INPUT 17 BYTES.                56820002
         BE    SIMPACK                 YES,SIMULATE PACK INSTRUCTION.   56840002
         LR    R5,R0                   R5=NUMBER OF SIGNIFICANT DIGITS. 56860002
         BCTR  R5,ZERO                 R5=EXECUTE LENGTH.               56880002
         SLL   R4,FOUR                 R4=LENGTH IN HIGH OFDER 4 BITS.  56900002
         OR    R5,R4                   R5=LENGTH 1 AND LENGTH 2.        56920002
         EX    R5,ROUNDPK              PACK SIGNIFICANT DIGITS.         56940002
         SRL   R5,FOUR                 CLEAR LENGTH 2.                  56960002
         SLL   R5,FOUR                 *                                56980002
         EX    R5,ADD5                 ADD 5 TO SIGNIFICANT DIGITS.     57000002
         LR    R4,R0                   R4=LENGTH OF SIGNIFICANT DIGITS. 57020002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               57040002
         SLL   R4,FOUR                 R4=LENGTH 1 IN HIGH ORDER 4 BITS 57060002
         SRL   R5,FOUR                 R5=LENGTH 2 IN LOW ORDER.        57080002
         LA    R7,ONE                  R7=1,FOR EVEN ODD CHECK.         57100002
         NR    R7,R0                   Q.SIGNIFICANTS ODD.              57120002
         BM    ODDSIGNF                YES,CHECK FOR CARRY.             57140002
         CLI   FLTINPUT,HEX9           Q.IS THERE A CARRY.              57160002
         BNH   NOEXPJST                NO,DO NOT ADJUST.                57180002
ANEXPJST EQU   *                                                        57200002
         BCTR  R2,ZERO                 ACCOUNT FOR EXPONENT.            57220002
         LA    R4,ONE6(R4)              ACCOUNT FOR CARRY DIGIT.        57240002
NOEXPJST EQU   *                                                        57260002
         OR    R5,R4                   R5=LENGTH 1 AND 2.               57280002
         EX    R5,UNPKSIG              UNPACK SIGNIFICANT DIGITS.       57300002
ENDSIG   EQU   *                                                        57320002
         LR    R8,R0                   R8=NUMBER OF SIGNIFICANT DIGITS. 57340002
         STH   R8,FLTLEN               CORRECT LENGTH IN SAVE AREA.     57360002
         LA    R5,FLTSTG               R5=ADDR OF SIGNIFICANT DIGITS.   57380002
         LA    R8,ZERO(R5,R8)          R8=PTR TO END OF SIGNIFICANTS.   57400002
         BCTR  R8,ZERO                 POINT TO LAST BYTE.              57420002
         OI    ZERO(R8),HEXF0          ALTER SIGN TO PRINTABLE.         57440002
         LA    R8,ONE(R8)              R8=PTR TO END OF SIGNIFICANTS.   57460002
         B     ENDSIGNF                CALCULATE EXPONENT.              57480002
ODDSIGNF EQU   *                                                        57500002
         CLI   FLTINPUT,HEX00          Q.IS THERE A CARRY.              57520002
         BE    NOEXPJST                NO,DO NOT ADJUST.                57540002
         B     ANEXPJST                YES,ACCOUNT FOR EXPONENT.        57560002
         SPACE                                                          57580002
*********************************************************************** 57600002
*                                                                     * 57620002
* THIS AREA OF CODE PACKS AN AREA 17 BYTES IN LENGTH AND ROUNDS THE   * 57640002
* VALUE.                                                              * 57660002
*                                                                     * 57680002
*********************************************************************** 57700002
         SPACE                                                          57720002
SIMPACK  EQU   *                                                        57740002
         PACK  FLTINPUT(NINE),FLTSTG(ONE6) PACK FIRST 15 BYTES.         57760002
         PACK  FLTINPUT+EIGHT(TWO),FLTSTG+ONE5(THREE) NEXT THREE.       57780002
         OI    FLTINPUT+NINE,SIGNF     SIGN ALTERED FOR ADD.            57800002
         MVC   FLTSTG(ONE9),FLTPATTN   PATTERN NOW IN WORKAREA.         57820002
         AP    FLTINPUT(TEN),PACK5(ONE) ROUND VALUE.                    57840002
         CLI   FLTINPUT,HEX9           Q.IS THERE A CARRY.              57860002
         BNH   NOJSTEXP                NO,DO NOT ADJUST.                57880002
         BCTR  R2,ZERO                 ACCOUNT FOR EXPONENT.            57900002
NOJSTEXP EQU   *                                                        57920002
         ED    FLTSTG(TWO0),FLTINPUT   SIGNIFICANTS NOW ZONED DECIMAL.  57940002
         LA    R8,FLTSTG               R8=POINTER TO FLTSTG.            57960002
FINDNO0  EQU   *                                                        57980002
         CLI   ZERO(R8),AZERO          Q.NON-ZERO FOUND.                58000002
         BNE   JUSTSNFT                YES,LEFT JUSTIFY.                58020002
         LA    R8,ONE(R8)              POINT TO NEXT BYTE.              58040002
         B     FINDNO0                 GET NEXT BYTE.                   58060002
JUSTSNFT EQU   *                                                        58080002
         MVC   FLTSTG(ONE7),ZERO(R8)   LEFT JUSTIFY VALUE.              58100002
         B     ENDSIG                  END SIGNIFICANTS.                58120002
ENDSIGNF EQU   *                                                        58140002
         SR    R6,R2                   R6=EXPONENT VALUE.               58160002
         MVC   ZERO(FIVE,R8),EXPCHAR   EXPONENT PATTERN IN STRING.      58180002
         LTR   R6,R6                   IS EXPONENT NEGATIVE.            58200002
         BNM   SKIPNEG                 SKIP NEGATIVE SIGN MOVE.         58220002
         MVI   TWO(R8),SIGNNEG         NEGATIVE SIGN NOW IN STRING.     58240002
SKIPNEG  EQU   *                                                        58260002
         CVD   R6,PACKAREA             EXPONENT NOW PACKED DECIMAL.     58280002
         OI    PACKAREA+SEVEN,SIGNF    SIGN NOW X'F'.                   58300002
         UNPK  THREE(TWO,R8),PACKAREA+SIX(TWO) EXPONENT NOW IN STRING.  58320002
         CLI   THREE(R8),AZERO         IS FIRST CHARACTER A ZERO.       58340002
         BNE   BLKSKIP                 NO,DO NOT MOVE IN A BLANK.       58360002
         MVI   THREE(R8),BLANK         FIRST CHARACTER NOW A BLANK.     58380002
BLKSKIP  EQU   *                                                        58400002
         LA    R8,FLTSTG-TWO           R8=ADDRESS FOR MANTISSA SIGN.    58420002
         MVC   ZERO(TWO,R8),FRACSIGN   FRACTION + SIGN NOW IN STRING.   58440002
         TM    ZERO(R1),HION           IS FRACTION NEGATIVE.            58460002
         BZ    PLUSFRAC                NO,DO NOT MOVE IN NEGATIVE SIGN. 58480002
         MVI   ZERO(R8),MINUS          MINUS SIGN NOW IN STRING.        58500002
PLUSFRAC EQU   *                                                        58520002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       58540002
         LH    R6,FLTLEN               R6=LENGTH OF MANTISSA.           58560002
         LA    R6,SEVEN(R6)            R6=LENGTH OF OUTPUT STRING.      58580002
         STC   R6,ZERO(R2)             LENGTH OF OUTPUT NOW IN CONAREA. 58600002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               58620002
         EX    R6,OUTMVC               MOVE STRING INTO OUTPUT AREA.    58640002
ENDFLT   SR    R15,R15                 R15=ZERO.                        58660002
         BR    R14                     RETURN TO CALLER.                58680002
*********************************************************************** 58700002
*                                                                     * 58720002
* THE FOLLOWING LINES OF CODE CALCULATE THE EXPONENT AND MOVE IT'S    * 58740002
* PRINTABLE REPRESENTATION INTO CONAREA.                              * 58760002
*                                                                     * 58780002
*********************************************************************** 58800002
         SPACE                                                          58820002
EXPONLY  EQU   *                                                        58840002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              58860002
         SH    R7,FLT64                R7=EXPONENT IN BINARY.           58880002
         MVC   ONE(FOUR,R2),EXPCHAR+ONE EXPONENT SIGN NOW IN CONAREA.   58900002
         LTR   R7,R7                   Q.EXPONENT NEGATIVE.             58920002
         BNM   PLUSEXP2                NO,SKIP COMPLEMENT.              58940002
         MVI   TWO(R2),MINUS           NEGATIVE SIGN NOW IN CONAREA.    58960002
PLUSEXP2 EQU   *                                                        58980002
         CVD   R7,PACKAREA             EXP NOW PACKED DECIMAL.          59000002
         OI    PACKAREA+SEVEN,SIGNF    SIGN NOW X'F'.                   59020002
         UNPK  FLTSTG(TWO),PACKAREA+SIX(TWO) EXP NOW ZONED DECIMAL.     59040002
         CLI   FLTSTG,F0               Q.FIRST CHAR A ZERO.             59060002
         BNE   NOF0                    NO,DO NOT MOVE IN BLANK.         59080002
         MVI   FLTSTG,BLANK            BLANK NOW IN EXP FIELD.          59100002
NOF0     EQU   *                                                        59120002
         MVC   THREE(TWO,R2),FLTSTG    EXP NOW IN CONAREA.              59140002
         MVI   ZERO(R2),FOUR           LENGTH NOW IN CONAREA.           59160002
         B     ENDFLT                  SET RETURN CODE & RETURN.        59180002
*********************************************************************** 59200002
*                                                                     * 59220002
* THIS SECTION OF CODE MOVES INTO CONAREA(OUTPUT AREA) THE OUTPUT FOR * 59240002
* A FRACTION ZERO.                                                    * 59260002
*                                                                     * 59280002
*********************************************************************** 59300002
         SPACE                                                          59320002
ZEROFRAC EQU   *                                                        59340002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       59360002
         MVC   ZERO(THREE,R2),FLPTZERO PRINTABLE +0 NOW IN CONAREA.     59380002
         B     ENDFLT                  GO,SET RETURN CODE & RETURN.     59400002
*********************************************************************** 59420002
*                                                                     * 59440002
* THE FOLLOWING INSTRUCTIONS CONVERT THE FRACTION OF A DOUBLE         * 59460002
* PRECISION FLOATING POINT BINARY TO ZONED DECIMAL.                   * 59480002
*                                                                     * 59500002
*********************************************************************** 59520002
FLTLONG  EQU   *                                                        59540002
         SH    R7,DOBLFLT              MOVE DEC PT 8 MORE DIGITS RIGHT. 59560002
         D     R4,CVTVAL               ALTER FRACTION FOR CONVERSION.   59580002
         CVD   R5,PACKAREA             FRACTION NOW BEING CONVERTED TO  59600002
         OI    PACKAREA+SEVEN,SIGNF    PACKED DECIMAL.                  59620002
         UNPK  FLTSTG(ONE5),PACKAREA   PARTIAL CONVERT OF FRACTION.     59640002
         CVD   R4,PACKAREA             REMAINDER OF FRACTION NOW BEING  59660002
         OI    PACKAREA+SEVEN,SIGNF    CONVERTED TO PACK DECIMAL.       59680002
         UNPK  REMDATA(NINE),PACKAREA  REMIANDER OF FRACTION CONVERTED. 59700002
         LA    R6,FLTSTG+DOBLEND       R6=ADDRESS OF END OF ZONED DEC.  59720002
         B     SUPPRESS                GO SUPPRESS LEADING ZEROES.      59740002
ADJUSTIT EQU   *                                                        59760002
         BCTR  R8,ZERO                 R8=PTR TO LAST BYTE.             59780002
         IC    R4,ZERO(R8)                                              59800002
         TM    ZERO(R8),HEX9           Q.IS IT EQUAL TO NINE.           59820002
         BO    ADJUST2                 YES                              59840002
         LA    R4,ONE(R4)              CARRY NEXT TO LAST BYTE ONE.     59860002
         STC   R4,ZERO(R8)             MOVE BYTE INTO STRING.           59880002
         B     JUSTEND                 CHECK SCALING.                   59900002
ADJUST2  EQU   *                                                        59920002
         BCTR  R6,ZERO                 DECREMENT LENGTH.                59940002
         BCTR  R2,ZERO                 DECREMENT EXPONENT.              59960002
         STH   R6,FLTLEN               SAVE LENGTH.                     59980002
         B     ADJUSTIT                GET NEXT BYTE.                   60000002
         EJECT                                                          60020002
*********************************************************************** 60040002
*                                                                     * 60060002
* THE FOLLOWING INSTRUCTIONS CONVERT PRINTABLE DATA IN STANDARD OR    * 60080002
* SCIENTIFIC NOTATION TO ITS SINGLE OR DOUBLE PRECISION FLOATING      * 60100002
* POINT REPRESENTATION.                                               * 60120002
*                                                                     * 60140002
*********************************************************************** 60160002
IKJEGFTB EQU   *                                                        60180002
         DROP  R12                     GET NEW BASE REGISTER            60200002
         USING *,R15                   ESTABLISH ADDRESSABILITY         60220002
         L     R12,FLTCON              R12=ADDRESS OF IKJEGFLT          60240002
         DROP  R15                     GET NEW BASE REGISTER            60260002
         USING IKJEGFLT,R12            IKJEGFLT ADDRESSABILITY          60280002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY           60300002
         L     R3,WORKAREA             GET WORK SPACE                   60320002
         USING CVTWORK,R3              ESTABLISH ADDRESSABILITY         60340002
         XC    ZERO(SIX4,R3),ZERO(R3)  CLEAR OUT WORK AREA              60360002
         STC   R6,TYPE                 STORE TYPE CODE E OR D           60380002
         LH    R4,FOUR(R1)             LOAD LENGTH OF INPUT STRING      60400002
         EJECT                                                          60420002
*********************************************************************** 60440002
* THE FOLLOWING CODE SCANS THE INPUT STRING SAVING THE COEFFICIENT    * 60460002
* SIGN, THE EXPONENT SIGN, THE ADDRESS OF THE COEFFICIENT AND THE     * 60480002
* EXPONENT.                                                           * 60500002
*********************************************************************** 60520002
         SPACE                                                          60540002
         LA    R6,FRACSGN              POINT TO LOCATION FOR COEFF SIGN 60560002
         LA    R2,SCAN1                R2= ADDR OF SCAN1                60580002
         L     R7,ZERO(R1)             POINT TO INPUT STRING            60600002
         MVI   EXPSIGN,PLUS            DEFAULT EXPONENT TO POSITIVE     60620002
         SR    R5,R5                   DEFAULT EXPONENT TO ZERO         60640002
SCAN0    CLI   ZERO(R7),MINUS          IS COEFFICIENT NEGATIVE          60660002
         BE    STORSIG1                IF YES BRANCH                    60680002
         CLI   ZERO(R7),PLUS           IS COEFFICIENT POSITIVE          60700002
         BE    STORSIG1                IF YES BRANCH                    60720002
         MVI   ZERO(R6),PLUS           DEFAULT TO POSITIVE              60740002
         BR    R2                      BRANCH TO SCAN1 OR SCANDONE      60760002
STORSIG1 MVC   ZERO(ONE,R6),ZERO(R7)                                    60780002
         LA    R7,ONE(R7)              POINT TO CHARACTER BEYOND SIGN   60800002
         BCTR  R4,R2                   BRANCH TO SCAN1 OR SCANDONE      60820002
SCAN1    SR    R8,R8                   INITLZ DIGIT COUNT OF COEFF      60840002
         LR    R1,R7                   SAVE ADDRESS OF COEFFICIENT      60860002
SCAN2    CLI   ZERO(R7),RESIGN         IS THE CHARACTER AN 'E'          60880002
         BE    EFOUND                  IF YES BRANCH                    60900002
         CLI   ZERO(R7),HEX85          LOWER CASE E                     60920002
         BE    EFOUND                  IF YES BRANCH                    60940002
         LA    R8,ONE(R8)              ADD ONE TO COEFF DIGIT COUNT     60960002
         LA    R7,ONE(R7)              POINT TO NEXT CHARACTER          60980002
         BCT   R4,SCAN2                BRANCH AND DECREMENT STRING LN   61000002
         B     NUMCHECK                IF STRING LENGTH ZERO BRANCH     61020002
EFOUND   LA    R7,ONE(R7)              POINT TO NEXT CHARACTER          61040002
         LA    R6,EXPSIGN              POINT TO LOCATION FOR EXP SIGN   61060002
         BCTR  R4,R0                   DECREMENT STRING LENGTH          61080002
         BAL   R2,SCAN0                CHECK FOR EXPONENT SIGN          61100002
         BCTR  R4,R0                   DECREMENT STRING LENGTH          61120002
         EX    R4,PACKE                PACK THE EXPONENT                61140002
         CVB   R5,NUM4                 CONVERT THE EXPONENT TO BINARY   61160002
         EJECT                                                          61180002
*********************************************************************** 61200002
* THE FOLLOWING CODE CHECKS FOR AN INPUT OF ZERO AND THEN BRANCHES TO * 61220002
* THE PROPER CODE TO PACK THE INPUT NUMBER DEPENDING ON WHETHER IT IS * 61240002
* AN INTEGER, A PROPER FRACTION, OR AN IMPROPER FRACTION.             * 61260002
*********************************************************************** 61280002
         SPACE                                                          61300002
NUMCHECK L     R2,CONAREA              POINT TO OUTPUT AREA             61320002
         XC    ZERO(THREE2,R2),ZERO(R2) CLEAR IT OUT                    61340002
         LA    R15,RETURN1             SAVE IN OTHERWISE USELESS REG    61360002
         MVI   NUM1,AZERO              MOVE IN CHARACTER ZERO           61380002
         MVC   NUM1+ONE(TWO6),NUM1     SPREAD IT ALONG                  61400002
         BCTR  R8,R0                   DECREMENT COEFF DIGIT CNT FOR EX 61420002
         EX    R8,CLC1                 IS COEFFICIENT ZERO              61440002
         BCR   EIGHT,R15               IF YES GO TO RETURN1             61460002
         LA    R8,ONE(R8)              RESTORE COEFFICIENT DIGIT COUNT  61480002
CLI      CLI   ZERO(R1),HEXF0          IS THERE A HIGH ORDER ZERO       61500002
         BNE   CLICLI                  IF NO BRANCH                     61520002
         BCTR  R8,R0                   DECREMENT DIGIT COUNT            61540002
         LA    R1,ONE(R1)              POINT PAST ZERO                  61560002
         B     CLI                     CHECK NEXT CHARACTER             61580002
CLICLI   EQU   *                                                        61600002
         CLI   EXPSIGN,PLUS            IS NUMBER AN INTEGER             61620002
         BE    INTEGER                 IF YES NUMBER IS PURE INTEGER    61640002
         CH    R5,HALFZERO             CHECK FOR XXXXE-0 INPUT          61660002
         BE    INTEGER                 IF SO NUMBER IS REALLY INTEGER   61680002
         CR    R8,R5                   IS NUMBER PURE FRACTION          61700002
         BNH   FRACTION                IF YES BRANCH                    61720002
         OI    FLAG,HEXC0              INDICATE MIXED                   61740002
         LR    R10,R8                  SAVE COEFFICIENT DIGIT COUNT     61760002
         SR    R10,R5                  NUMBER OF DIGITS IN INTEGER PART 61780002
         BCTR  R10,R0                  DECREMENT FOR EX                 61800002
         XC    NUM1(TWO7),NUM1         CLEAR NUM1                       61820002
         EX    R10,PACKA               PACK THE INTEGER INTO NUM1       61840002
         LA    R10,ONE(R10)            RESTORE REGISTER 10              61860002
         AR    R1,R10                  POINT PAST INTEGER PART OF COEFF 61880002
         LR    R8,R5                   SAVE R5=EXPONENT                 61900002
         LR    R6,R1                   POINT TO FRACTION COEFFICIENT    61920002
CLI2     CLI   ZERO(R6),HEXF0          DO COMPARE                       61940002
         BNE   LR8                     IF NO GET OUT                    61960002
         LA    R6,ONE(R6)              POINT TO NEXT CHARACTER          61980002
         BCT   R8,CLI2                 HAVE WE FINISHED CHECKING        62000002
         NI    FLAG,HEXFF-HEX80        IF YES THERE IS NO FRACTION PART 62020002
LR8      LR    R8,R5                   R8= R5 FOR SHIFT                 62040002
         SRL   R8,ONE                  REMOVE LOW BIT                   62060002
         LR    R4,R8                   SAVE CURRENT FRACTION            62080002
         SLL   R8,FOUR                 SHIFT BACK BY FOUR               62100002
         AR    R8,R5                   ADD R8, R5 TO GET FRACTIONAL PT  62120002
         BCTR  R8,R0                   R8=EXECUTE LENGTH.               62140002
         EX    R8,PACKB                PACK FRACTION PART OF USER NUMB  62160002
         LA    R4,NUM3+TWO(R4)         POINT TO END OF PACKED FRACTION  62180002
         MVN   ZERO(ONE,R4),HALFZERO                                    62200002
         LA    R4,ONE                  R4=1.                            62220002
         NR    R4,R5                   IS EXPONENT EVEN OR ODD          62240002
         BNZ   MIXED2                  IF EVEN BRANCH                   62260002
         MVO   NUM3(ONE6),NUM3(ONE6)                                    62280002
MIXED2   MVN   NUM3+ONE5(ONE),PACK10+ONE                                62300002
         B     PACKDONE                PACKING IS DONE, BRANCH OUT      62320002
INTEGER  EQU   *                                                        62340002
         OI    FLAG,HEX40              INDICATE INTEGER                 62360002
         LR    R10,R8                  SAVE R8=COEFFICIENT DIGIT COUNT  62380002
         AR    R10,R5                  ADD EXPONENT TO GET FULL SIZE    62400002
         BCTR  R8,R0                   DECREMENT FOR MOVE               62420002
         C     R10,TWENTY7             HOW LONG IS INTEGER              62440002
         BNL   LEFTADJ                 IF LONGER THAN BUFFER LFT ADJ IT 62460002
         LA    R6,NUM3+ONE1                                             62480002
         SR    R6,R10                  ALTER INTEGER POINTER.           62500002
         EX    R8,MOVEA                RIGHT ADJUST INTEGER .           62520002
         B     PACKINT                 PACK THE INTEGER                 62540002
LEFTADJ  EX    R8,MOVE1                LEFT ADJUST INTEGER.             62560002
PACKINT  PACK  NUM2+TWO(EIGHT),NUM1(ONE5)                               62580002
         PACK  NUM2+NINE(SEVEN),NUM1+ONE4(ONE3)                         62600002
         B     PACKDONE                PACKING IS DONE, GET OUT         62620002
*        THE NUMBER IS A PURE FRACTION SETUP FOR HANDLING IT            62630002
FRACTION EQU   *                       NUMBER IS A PURE FRACTION        62640002
         OI    FLAG,HEX80              TURN ON FRACTION FLAG            62660002
         MVI   NUM2,AZERO              MOVE IN CHARACTER ZERO           62680002
         MVC   NUM2+ONE(FIVE3),NUM2    SPREAD IT ALONG                  62700002
         LA    R0,FIVE4                NUMBER OF DIGITS FOR MULTIPLYING 62720002
         CR    R5,R0                   HOW MANY DIGITS IN FRACTION      62740002
         BNH   LESS55                  IF 54 OR LESS BRANCH             62760002
         S     R5,TWENTY7              SUBRACT 27                       62780002
         OI    FLAG,HEX04              FLAG TO INDICITE NOT FULL FRACT  62800002
         CR    R5,R0                   IS FRACTION STILL TOO LARGE      62820002
         BNH   LESS55                  IF SMALL ENOUGH BRANCH           62840002
         S     R5,TWENTY7              MAKE NUMBER SMALL ENOUGH         62860002
         OI    FLAG,HEX08              SET FLAG TO INDICATE FAKING      62880002
LESS55   LA    R6,NUM2(R5)             PACK THE FRACTION                62900002
         SR    R6,R8                   ALTER FRACTION POINTER.          62920002
         BCTR  R8,R0                   R8=EXECUTE LENGTH.               62940002
         EX    R8,MOVEA                LEFT ADJUST FRACTION.            62960002
         PACK  NUM4(EIGHT),NUM3+SEVEN(ONE5)       PACK                  62980002
         PACK  NUM3+EIGHT(EIGHT),NUM1+ONE1(ONE1)  PACK                  63000002
         MVN   NUM3+ONE5(ONE),NUM3+SIX            MOVE NUMERIC          63020002
         PACK  NUM3(EIGHT),NUM2+ONE2(ONE5)        PACK                  63040002
         PACK  NUM1+EIGHT(EIGHT),NUM2(ONE1)       PACK                  63060002
         MVN   NUM1+ONE5(ONE),NUM2+ONE1           MOVE NUMERIC          63080002
         MVC   NUM2(THREE2),NUM1+EIGHT            MOVE CHARACTER        63100002
         XC    NUM3(TWO4),NUM3                    AND (CLEAR)           63120002
         MVN   NUM4+SEVEN(ONE),PACK10+ONE         MOVE NUMERIC          63140002
         B     INTGREND                GO TO FRACTION PROCESSING PART   63160002
         EJECT                                                          63180002
*********************************************************************** 63200002
*                                                                     * 63220002
* THIS CODE IS REACHED WHEN PACKING AND FORMATTING ARE COMPLETED      * 63240002
* FOR INTEGER OR MIXED DATA.  IT SETS UP AND BEGINS CONVERSION OF     * 63260002
* THE INTEGER PORTION TO FLOATING POINT REPRESENTATION.               * 63280002
*                                                                     * 63300002
*********************************************************************** 63320002
         SPACE                                                          63340002
PACKDONE EQU   *                       PACKING IS DONE                  63360002
         SR    R5,R5                   INITIALIZE DIVISION COUNTER      63380002
         LA    R4,THREE2(R2)           POINT TO LOC FOR FRACT MANTISSA  63400002
         LA    R1,DIVIDE               SAVE ADDRESS IN UNUSED REG.      63420002
         LA    R8,MORENUM7             SAVE ADDRESS IN UNUSED REG.      63440002
DIVIDE   DP    NUM2(ONE6),TWO56(TWO)   DIVIDE TO OBTAIN HEX DIGITS      63460002
         LA    R5,TWO(R5)              INC BY 2 FOR EACH DIVISION BY 16 63480002
         MVC   NUM4+SIX(TWO),NUM2+ONE4                                  63500002
         ZAP   NUM2(ONE6),NUM2(ONE4)   RIGHT ADJUST QUOTIENT            63520002
         C     R10,TWENTY7             FULL INTEGER INVOLVED IN DIVISIN 63540002
         BH    MORENUM1                NO.                              63560002
         CVB   R0,NUM4                 YES CONTINUE                     63580002
         STC   R0,ZERO(R4)             STORE HEX DIGIT PAIR OUTPUT AREA 63600002
         BCTR  R4,R0                   POINT 1 BYTE LEFT FOR NEXT TIME  63620002
         EJECT                                                          63640002
*********************************************************************** 63660002
*                                                                     * 63680002
* THE FOLLOWING CODE IS EXECUTED IF THE FULL INTEGER IS BEING INVOLVED* 63700002
* IN DIVISION AND CALCULATION OF THE EQUIVALENT HEX REPRESENTATION. IT* 63720002
* DECREMENTS THE INTEGER DIGIT COUNTER (R10) AND IF PROCESSING IS NOT * 63740002
* DONE RETURNS TO DIVIDE THE INTEGER AGAIN.                           * 63760002
*                                                                     * 63780002
*********************************************************************** 63800002
         LA    R6,THREE                R6= 3                            63820002
         CR    R10,R6                  HOW BIG WAS DIGIT COUNT          63840002
         BL    INTGRND1                IF 1 OR 2 WE ARE DONE DIVIDING   63860002
         LA    R7,NUM2+ONE6                                             63880002
         LR    R6,R10                  SAVE R10                         63900002
         SRL   R6,ONE                  COMPUTE COUNT IN BYTES           63920002
         SR    R7,R6                   POINT TO FRONT OF QUOTIENT       63940002
         BCTR  R10,R0                  DECREMENT DIGIT COUNT            63960002
         BCTR  R10,R0                  DECREMENT DIGIT COUNT            63980002
         LA    R6,ONE                  TO CHECK R10 FOR EVEN OR ODD     64000002
         NR    R6,R10                  TO CHECK R10 FOR EVEN OR ODD     64020002
         BZ    ZEROFOX                 IF R10 IS EVEN BRANCH            64040002
         TM    ZERO(R7),HEXF0          CHECK FOR HIGH ORDER ZERO        64060002
         BCR   SEVEN,R1                BRANCH IF NONE TO DIVIDE         64080002
         B     BCTR                    GO DECREMENT DIVISION COUNTER.   64100002
ZEROFOX  TM    ZERO(R7),HEX0F          IS NEXT DIGIT ZERO ALSO          64120002
         BCR   SEVEN,R1                BRANCH IF NONE TO DIVIDE         64140002
BCTR     BCTR  R10,R1                  DECR INTEGER LENGTH AND REDIVIDE 64160002
         B     INTGRND1                GO PROCESS FRACTION PART.        64180002
         EJECT                                                          64200002
*********************************************************************** 64220002
*                                                                     * 64240002
* THE FOLLOWING CODE IS EXECUTED IF THE FULL INTEGER PART WAS NOT     * 64260002
* INVOLVED IN DIVISION. IT RECALCULATES THE INTEGER DIGIT COUNT AND   * 64280002
* FORMATS THE DIVIDEND FOR THE NEXT DIVISION.                         * 64300002
*                                                                     * 64320002
*********************************************************************** 64340002
         SPACE                                                          64360002
MORENUM1 EQU   *                                                        64380002
         S     R10,TWENTY7                                              64400002
         MP    NUM2(ONE6),PACK10(TWO)   SHIFT LEFT ONE DIGIT            64420002
         BCT   R10,MORENUM2            IF NOT ZERO CONTINUE SHIFTING    64440002
         TM    NUM2+TWO,HEX0F          IS FIRSTT OUT                    64460002
         BZ    MORENUM6                IF YES BRANCH                    64480002
         BR    R8                      IF NO GO TO MORENUM7             64500002
MORENUM2 MP    NUM2(ONE6),PACK10(TWO)   SHIFT LEFT ONE DIGIT            64520002
         TM    NUM2+TWO,HEXF0                                           64540002
         BCR   SEVEN,R8                DIGIT NOT ZERO BRANCH MORENUM7   64560002
         BCT   R10,MORENUM4            OTHERWISE DECREMENT DIGIT COUNT  64580002
         BR    R8                      IF DIGIT COUNT IS ZERO BRANCH    64600002
MORENUM4 MP    NUM2(ONE6),PACK10(TWO)  MULTIPLY TO SHIFT OUT ZERO       64620002
         BR    R8                      BRANCH TO MORENUM7               64640002
MORENUM6 BCTR  R10,R0                  DECREMENT INTEGER COUNTER        64660002
MORENUM7 BCTR  R10,R0                  DECREMENT INTEGER COUNTER        64680002
         A     R10,TWENTY7             RESTORE FULL INTEGER DIGIT CNTER 64700002
         BR    R1                      GO BACK TO DIVIDE                64720002
         EJECT                                                          64740002
*********************************************************************** 64760002
*                                                                     * 64780002
* THE FOLLOWING CODE IS REACHED WHEN THE INTEGER PROCESSING IS        * 64800002
* COMPLETE. IT WILL PROCESS THE FRACTION IF ANY.                      * 64820002
*                                                                     * 64840002
*********************************************************************** 64860002
         SPACE                                                          64880002
INTGRND1 EQU   *                       INTEGER PART CONVTED TO FLOAT PT 64900002
         LR    R8,R5                   LOAD DIGIT COUNT                 64920002
         SRL   R8,ONE                  COMPUTE BYTE COUNT               64940002
         BCTR  R8,R0                   DECREMENT FOR MOVE               64960002
         EX    R8,MOVEB                LFT ADJUST FRACT PART IN CONAREA 64980002
         TM    TWO(R2),HEXF0           IS FIRST DIGIT ZERO              65000002
         BNZ   INTGRND2                IF NO, OKAY AND BRANCH           65020002
         BCTR  R5,R0                   SUBRACT FROM DIGIT CNT (AND EXP) 65040002
         MVO   TWO(EIGHT,R2),TWO(EIGHT,R2)   SHIFT THE MANTISSA         65060002
         MVN   NINE(ONE,R2),HALFZERO    PUT IN A ZERO                   65080002
INTGRND2 EQU   *                                                        65100002
         STC   R5,NUM5                 SAVE FOR POSSIBLE USE LATER      65120002
         LA    R10,HEX40               LOAD BASE FOR EXPONENT           65140002
         CLI   FRACSGN,PLUS            IS NUMBER POSITIVE               65160002
         BE    PLUS3                   IF YES BRANCH                    65180002
         LA    R10,HEX80(R10)          OTHERWISE CHANGE THE BASE        65200002
PLUS3    AR    R10,R5                  COMPUTE THE EXPONENT             65220002
         STC   R10,ONE(R2)             SAVE IT                          65240002
         TM    FLAG,HEX80              WAS THERE A FRACTION PART        65260002
         BCR   EIGHT,R15               IF NO GO TO RETURN1              65280002
INTGREND LA    R4,ONE3(R2)             POINT TO FRACTION MANTISSA       65300002
         LA    R8,EIGHT                NUMBER OF SIGNIFICANT DIGITS     65320002
         SR    R5,R5                   MULTIPLICATION COUNTER           65340002
         SR    R7,R7                   CLEAR OUT A REGISTER             65360002
         TM    FLAG,HEX40              WAS THERE AN INTEGER PART        65380002
         BZ    MULTIPLY                IF NO START WORKING ON FRACTION  65400002
         MVC   NUM2(ONE6),NUM3         SETUP AREA FOR FRACT CONVERSION  65420002
         MVN   NUM1+ONE5(ONE),PACK10+ONE                                65440002
MULTIPLY MP    NUM2(ONE6),TWO56(TWO)                                    65460002
         MP    NUM1(ONE6),TWO56(TWO)                                    65480002
         MVO   NUM1(TWO),NUM1(TWO)     SHIFT LEFT TO MAKE ROOM FOR SIGN 65500002
         MVN   NUM1+ONE(ONE),PACK10+ONE                                 65520002
         AP    NUM2(ONE6),NUM1(TWO)     ADD TO LOW ORDER PART OF NUM2   65540002
         STH   R7,NUM1                 CLEAR OUT HIGH TWO BYTES         65560002
         CLC   NUM2(TWO),HALFZERO      IS OVERFLOW ZERO                 65580002
         BE    NEXTCHK1                IF YES BRANCH                    65600002
         TM    FLAG,HEX0C              IS EITHER FAKING FLAG STILL ON   65620002
         BZ    NEXTCHK4                IF NO BRANCH                     65640002
         BM    NEXTCHK8                IF ONLY ONE ON BRANCH            65660002
         NI    FLAG,(HEXFF-HEX08)      TURN OFF ONE FAKING FLAG         65680002
NEXTCHK9 MVC   NUM1(ONE6),NUM2         SHIFT STUFF TO LOW ORDER BUFFER  65700002
         XC    NUM2(ONE6),NUM2         CLEAR OUT HIGH ORDER BUFFER      65720002
         MVO   NUM2+ONE4(TWO),NUM1(TWO)                                 65740002
         MVN   NUM2+ONE5(ONE),PACK10+ONE                                65760002
         STH   R7,NUM1                 SAVE R7 IN NUM1                  65780002
NEXTCHKB LA    R5,TWO(R5)              INCREMENT MULTIPLY COUNTER       65800002
         B     MULTIPLY                GO DO IT AGAIN                   65820002
NEXTCHK8 NI    FLAG,(HEXFF-HEX04)      TURN OFF REMAINING FAKING FLAG   65840002
         B     NEXTCHK9                GO TO COMMON FAKING PART         65860002
NEXTCHK1 TM    FLAG,HEX20              ARE WE COMPUTING SIGNIFIC DIGITS 65880002
         BZ    NEXTCHKB                IF NO BRANCH                     65900002
NEXTCHK4 OI    FLAG,HEX20              INDICATE SIGNIFIC DIGIT FIGURING 65920002
         MVO   NUM4+SIX(TWO),NUM2(TWO)  MOVE INTO CLEAN AREA            65940002
         STH   R7,NUM2                 CLEAR OUT HIGH TWO BYTES         65960002
         CVB   R0,NUM4                 CONVERT TO TWO HEX DIGITS        65980002
         STC   R0,ZERO(R4)             SAVE THEM                        66000002
         LA    R4,ONE(R4)              POINT 1 BYTE RIGHT FOR NEXT PAIR 66020002
         BCT   R8,MULTIPLY             IF LESS THAN EIGHT BYTES BRANCH  66040002
         LA    R4,ONE3(R2)             POINT TO BEGINNING OF MANTISSA   66060002
         TM    ZERO(R4),HEXF0          IS THERE A HIGH ORDER ZERO       66080002
         BNZ   FRACDONE                IF NO BRANCH                     66100002
         MVO   ZERO(EIGHT,R4),ZERO(EIGHT,R4)                            66120002
         LA    R5,ONE(R5)              ADD TO THE MULTIPLY COUNTER      66140002
         EJECT                                                          66160002
*********************************************************************** 66180002
*                                                                     * 66200002
* THE FOLLOWING CODE IS REACHED WHEN THE MANTISSA PORTION OF THE      * 66220002
* FLOATING POINT RESULT HAS BEEN CALCULATED. IT WILL CALCULATE THE    * 66240002
* CHARACTERISTIC OR ALIGN THE MANTISSA PORTION OF THE FRACTION IF THE * 66260002
* USER ENTERED NUMBER WAS A FRACTION OR MIXED INTEGER AND FRACTION    * 66280002
*                                                                     * 66300002
*********************************************************************** 66320002
FRACDONE EQU   *                                                        66340002
         LA    R2,ONE(R2)              POINT PAST THE LENGTH FIELD      66360002
         LA    R10,HEX40               LOAD BASE FOR EXPONENT           66380002
         STC   R5,NUM7                 SAVE MULTIPLICATION COUNTER      66400002
         SR    R10,R5                  FIGURE THE EXPONENT              66420002
         CLI   FRACSGN,PLUS            IS NUMBER POSITIVE               66440002
         BE    PLUS1                   IF POSITIVE BRANCH               66460002
         LA    R10,HEX80(R10)          INDICATE NEGATIVE NUMBER         66480002
PLUS1    TM    FLAG,HEX40              WAS THERE AN INTEGER PART        66500002
         BNZ   INTNFRAC                IF YES BRANCH                    66520002
         STC   R10,ZERO(R2)            SAVE THE EXPONENT                66540002
         MVC   ONE(EIGHT,R2),ONE2(R2)                                   66560002
         BCTR  R2,R15                  RESTORE R2 AND GO TO RETURN1     66580002
INTNFRAC SR    R10,R10                 CLEAR OUT A REGISTER             66600002
         SR    R1,R1                   CLEAR OUT A REGISTER             66620002
         IC    R10,NUM7                LOAD FRACTION MULTIPLY COUNT     66640002
         IC    R1,NUM5                 LOAD INTEGER DIVISION COUNT      66660002
*        OBTAIN THE NUMBER OF DIGITS PLACES TO SHIFT TO ALIGN NUMBER    66670002
         LA    R1,TWO(R1,R10)          R1= NUMBER OF DIGIT PLACES       66680002
         LM    R4,R5,ONE2(R2)          LOAD R4, R5 FROM CONAREA         66700002
         LM    R6,R7,ONE6(R2)          LOAD R6, R7 FROM CONAREA         66720002
         LA    R0,SIX4                 R0= 64 USED FOR COMPARE          66740002
         SLL   R1,TWO                  MULTIPLY R1 BY 4                 66760002
         CR    R1,R0                   IS SHIFT MORE THAN 64 BITS       66780002
         BNL   SHIFT64                 IF YES BRANCH                    66800002
         SRL   R0,ONE                  R0= 32 USED FOR COMPARE          66820002
         CR    R1,R0                   IS SHIFT MORE THAN 32 BITS       66840002
         BNL   SHIFT32                 IF YES BRANCH                    66860002
         SRDL  R4,ZERO(R1)                                              66880002
         SRDL  R6,ZERO(R1)                                              66900002
         A     R4,ZERO(R2)             ADD R4 WITH CONAREA              66920002
         A     R5,FOUR(R2)             ADD R5 WITH CONAREA              66940002
         A     R7,EIGHT(R2)            ADD R7 WITH CONAREA              66960002
         LR    R6,R7                   R6 = CREATED SUM IN R7           66980002
         STM   R4,R6,ZERO(R2)          STORE R4, R5, R6 IN CONAREA      67000002
         BCTR  R2,R15                  RESTORE R2 AND GO TO RETURN1     67020002
SHIFT32  SR    R1,R0                   SHIFT 32 BITS (OR MORE)          67040002
         SRDL  R4,ZERO(R1)                                              67060002
         A     R4,FOUR(R2)             ADD R4 WITH CONAERA              67080002
         A     R5,EIGHT(R2)            ADD R5 WITH CONAERA              67100002
         STM   R4,R5,FOUR(R2)          STORE R4, R5 IN CONAREA          67120002
         BCTR  R2,R15                  RESTORE R2 AND GO TO RETURN1     67140002
SHIFT64  SRDL  R4,ZERO(R1)             SHIFT OF 64 BITS                 67160002
         A     R4,EIGHT(R2)            ADD R4 WITH CONAREA              67180002
         ST    R4,EIGHT(R2)            STORE R4 IN CONAREA              67200002
BCTR2    BCTR  R2,R0                   DECREMENT BY ONE                 67220002
*********************************************************************** 67240002
* THE FOLLOWING CODE COMPUTES THE OUTPUT LENGTH EITHER FOUR OR EIGHT  * 67260002
* BYTES AND SAVES THE LENGTH IN CONAREA FOR IKJEGPCH. IT THEN CHECKS  * 67280002
* THE FLOATING POINT REPRESENTATION AND ROUNDS IT IF NECESSARY.       * 67300002
* FINALLY IT CHECKS THE HIGH ORDER MANTISSA BYTE FOR ZERO             * 67320002
*********************************************************************** 67340002
         SPACE                                                          67360002
RETURN1  MVI   ZERO(R2),HEX08          SET LENGTH TO 8                  67380002
         LA    R15,ENDFLT              POINT TO ENDFLT                  67400002
         CLI   TYPE,HEX1C              DOUBLE OR SINGLE PRECISION       67420002
         BE    LNGROUND                IF DOUBLE BRANCH                 67440002
         MVI   ZERO(R2),HEX04          SET LENGTH TO 4                  67460002
*        THIS GROUP OF CODE ROUNDS THE RESULTS                          67480002
         LA    R2,ONE(R2)              POINT PAST LENGTH FIELD          67500002
         CLI   FOUR(R2),HEX80          IS IT NECESSARY TO CHANGE OUTPUT 67520002
         BCR   FOUR,R15                NO ROUNDING NECESSARY TO ENDFLT  67540002
         L     R4,ZERO(R2)             LOAD RESULT                      67560002
         LA    R5,ONE                  R5 = ONE                         67580002
         AR    R4,R5                   ADD ONE                          67600002
         ST    R4,ZERO(R2)             STORE RESULT                     67620002
         B     FINALCK                 CHECK FOR 0 HIGH ORDER MANTISSA  67640002
LNGROUND EQU   *                                                        67660002
         LA    R2,ONE(R2)              POINT PAST LENGTH FIELD          67680002
         CLI   EIGHT(R2),HEX80         IS IT NECESSARY TO CHANGE OUTPUT 67700002
         BCR   FOUR,R15                NO ROUNDING NECESSARY TO ENDFLT  67720002
         LD    R2,ZERO(R2)             LOAD INTO FLOATING PT REGISTER   67740002
         XC    ONE(SEVEN,R2),ONE(R2)   CLEAR OUT FRACTION               67760002
         MVI   SEVEN(R2),HEX01         MOVE IN ONE                      67780002
         AW    R2,ZERO(R2)             ADD TO ROUND                     67800002
         STD   R2,ZERO(R2)             REPLACE RESULT                   67820002
FINALCK  CLI   ONE(R2),HEX00                                            67840002
         BCR   SEVEN,R15               IF NOT ZERO GO TO ENDFLT         67860002
         MVI   ONE(R2),HEX10                                            67880002
         BR    R15                     GO TO ENDFLT                     67900002
         EJECT                                                          67920002
*********************************************************************** 67940002
* THE FOLLOWING IS A GROUP OF DESECT USED BY THE CSECT'S                67960002
*********************************************************************** 67980002
         TITLE 'IKJEGCVT PDE DSECT.'                                    68000002
         IKJPARMA                                                       68020002
         TITLE 'IKJEGCVT TEST COMMUNICATION TABLE.'                     68040002
         TCOMTAB                                                        68060002
CVTWORK  DSECT                                                          68080002
         SPACE                                                          68100002
*********************************************************************** 68120002
*                                                                     * 68140002
* THIS DSECT MAPS A SECTION OF THE WORKAREA POINTED TO BY 'WORKAREA'  * 68160002
* IN TCOMTAB.                                                         * 68180002
*                                                                     * 68200002
*********************************************************************** 68220002
         SPACE                                                          68240002
FLTINPUT DS    D                       LOCATION FOR FLTPT INPUT STRING. 68260002
PACKAREA DS    D                       LOCATION FOR PACKED DEC CONSTANT 68280002
FLTSTG   DS    5D                      FLOATING PT WORKAREA.            68300002
FLTLEN   DS    H                       SAVE LENGTH AREA.                68320002
         ORG   *-58                    POINT TO BEGINNING OF WORK AREA  68340002
NUM2     DS    4F                      WORK SPACE FOR CONVERSION        68360002
NUM1     DS    4F                      ***                              68380002
NUM3     DS    4F                      ***                              68400002
NUM4     DS    2F                      AREA FOR CVB OF EXPONENT         68420002
FRACSGN  DS    CL1                     SIGN OF USER ENTERED FRACTION    68440002
EXPSIGN  DS    CL1                     SIGN OF USER ENTERED EXPONENT    68460002
FLAG     DS    CL1                     USED TO INDICATE NUMBER TYPE     68480002
EXPON    DS    CL1                     USER ENTERED EXPONENT OR ZERO    68500002
NUM7     DS    CL1                     ***                              68520002
NUM5     DS    CL1                     ***                              68540002
COEFF    DS    CL1                     COEFFICIENT DIGIT COUNT          68560002
TYPE     DS    CL1                     DOUBLE OR SINGLE PRECISION       68580002
         ORG   *-1                     BACK UP ONE BYTE                 68600002
CODE370  DS    X                       370 OP CODE FLAG.                68620002
CHAR5    EQU   X'01'                   MNEUMONIC IS 5 CHARS.            68640002
SSIMM    EQU   X'02'                   SS FORMAT,L1 & I3.               68660002
IKJEGFLT CSECT                                                          68680002
FLTMOVE  MVC   FLTINPUT+ONE(ONE),ONE(R1) FRACTION NOW IN WORKAREA.      68700002
MOVEFLT  MVC   FLTSTG(ONE),FLTSTG+ONE  LEFT JUSTIFY ZONE DECIMAL.       68720002
ALIGNMVC MVC   ZERO(ONE,R5),ZERO(R8)   FRACTION NOW MOVED FOR ADD.      68740002
ZONEMOVE MVC   FLTSTG(ONE),ZERO(R8)    ZONED DECIMAL NOW LEFT JUSTIVIED 68760002
ZONEJUST MVC   ZERO(ONE,R8),ONE(R8)    INPUT NOW LEFT JUSTIFIED.        68780002
OUTMVC   MVC   ONE(ONE,R2),FLTSTG-TWO  MOVE STRING INTO OUTPUT AREA     68800002
PACKA    PACK  NUM2(ONE6),ZERO(ZERO,R1)                                 68820002
PACKB    PACK  NUM3+TWO(ZERO),ZERO(ZERO,R1)                             68840002
PACKE    PACK  NUM4+SIX(TWO),ZERO(ZERO,R7)                              68860002
CLC1     CLC   ZERO(ZERO,R1),NUM1                                       68880002
MOVE1    MVC   NUM1(ZERO),ZERO(R1)                                      68900002
MOVEA    MVC   ZERO(ZERO,R6),ZERO(R1)                                   68920002
MOVEB    MVC   TWO(ZERO,R2),ONE(R4)                                     68940002
ROUNDPK  PACK  FLTINPUT(ONE),FLTSTG(ONE) SIGNIFICANT DIGITS NOW PACKED. 68960002
ADD5     AP    FLTINPUT(ONE),PACK5(ONE) ROUND VALUE.                    68980002
UNPKSIG  UNPK  FLTSTG(ONE),FLTINPUT(ONE) SIGNIFICANT DIGITS NOW ZONED.  69000002
         DS    0F                                                       69020002
SIGNOFF  DC    X'0000007F'             VALUE TO CLEAR HIGH ORDER.       69040002
FLTCON   DC    A(IKJEGFLT)             ADDR OF FLOATING POINT ROUTINE.  69060002
CVTVAL   DC    X'3B9ACA00'             10**9 USED TO CONVERT FIXED DEC. 69080002
FLTCLEAR DC    X'0000000F'             FULL WORD 15                     69100002
DOBLFLT  DC    X'0008'                 HALFWORD 8 FOR CHARACTERISTICS.  69120002
FLT20    DC    H'20'                   HALFWORD 20.                     69140002
PACK10   DC    PL2'10'                 PACKED 10                        69160002
TWO56    DC    PL2'256'                PACKED 256                       69180002
HALFZERO DC    H'0'                    HALFWORD ZERO                    69200002
FLT17    DC    H'17'                   HALFWORD 179                     69220002
HALFONE  DC    H'1'                    HALFWORD 1.                      69240002
TWENTY7  DC    F'27'                   FULLWORD 27                      69260002
FLTDEC2  DC    H'2'                    FIXED DECIMAL 2 FOR FLOATING PT. 69280002
FLTCHAR  DC    X'0046'                 FLOATING PT CHARACTERISTIC + 6   69300002
FLT64    DC    H'64'                   HALF WORD 64.                    69320002
FLT10    DC    H'10'                   HALF WORD 10.                    69340002
EXPCHAR  DC    C' E+  '                EXPONENT PATTERN.                69360002
FLPTZERO DC    X'02'                   OUTPUT FOR ZERO VALUE.           69380002
         DC    C'+0'                   *                                69400002
FRACSIGN DC    C'+.'                   FRACTION SIGN PATTERN.           69420002
FLTPATTN DC    C'0'                    PATTERN FOR EDIT INSTRUCTION.    69440002
         DC    18X'20'                 *                                69460002
PACK5    DC    P'5'                    PACKED 5                         69480002
REMDATA  EQU   FLTSTG+15               LOC FOR REMAINDER OF FLT PT.     69500002
HEX9     EQU   X'09'                   A HEX 9.                         69520002
         END                                                            70320002
