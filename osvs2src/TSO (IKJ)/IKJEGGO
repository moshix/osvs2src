GO       TITLE 'GO RUN CALL COMMAND PROCESSOR (IKJEGGO)'                00002002
         COPY  IKJEGSIO                                                 00006002
IKJEGGO  CSECT                                                          00100002
*D324940,392300,491500,565500-567000                           XXXXXXXX 00101002
*C324960,492000                                                XXXXXXXX 00102002
*A387010,520610-520620,524610-524640                           XXXXXXXX 00103002
         EJECT                                                          00110002
*********************************************************************** 00150002
* STATUS                                                              * 00200002
*    CHANGE LEVEL 00,VERSION NUMBER 02, VS2     02/27/73              * 00210002
*                                                                     * 00250002
* FUNCTION                                                            * 00300002
*    GO-CAUSES THE MODE TO CHANGE FROM COMMAND (IN WHICH YOU MAY ENTER* 00350002
*    TEST COMMANDS) TO PROBLEM PROGRAM.  GO WITHOUT THE ADDRESS       * 00400002
*    PARAMETER CAUSES EXECUTION TO BEGIN AT THE INITIAL ENTRY         * 00450002
*    POINT IF THE PROBLEM PROGRAM HAD BEEN LOADED BY TEST OR          * 00500002
*    CAUSES EXECUTION TO BEGIN FROM THE POINT OF INTERRUPTION.        * 00550002
*    GO WITH AN ADDRESS CAUSES EXECUTION TO PROCEED AS IF A           * 00600002
*    BRANCH HAD BEEN TAKEN TO THAT ADDRESS.  WHEN A BREAKPOINT        * 00650002
*    IS ENCOUNTERED OR EXECUTION IS COMPLETED THE MODE IS CHANGED     * 00700002
*    BACK TO COMMAND MODE.                                            * 00750002
*                                                                     * 00800002
*    CALL-DIFFERS FROM 'GO' IN THAT IT INITIALIZES REGISTERS 1, 14,   * 00850002
*    AND 15 OF THE PROBLEM PROGRAM'S REGISTERS AT THE TIME            * 00900002
*    EXECUTION BEGINS THUS ALLOWING FOR THE PASSING OF A              * 00950002
*    PARAMETER LIST TO THE PROBLEM PROGRAM.  REGISTER 1 IS SET TO     * 01000002
*    A DUMMY PARAMETER LIST IF 'PARM' IS NOT SPECIFIED.  THE HIGH     * 01050002
*    ORDER BIT OF THE LAST PARAMETER IS SET TO 1 IF 'VL' IS           * 01100002
*    SPECIFIED.  REGISTER 14 WILL CONTAIN THE RETURN ADDRESS          * 01150002
*    WHICH WILL CAUSE A CHANGE IN THE MODE BACK TO THE COMMAND        * 01200002
*    MODE IN WHICH TEST COMMANDS CAN BE ISSUED.  IF THE 'RETURN'      * 01250002
*    KEYWORD IS SPECIFIED, REGISTER 14 IS SET TO THE RETURN           * 01300002
*    ADDRESS SPECIFIED.  THE ADDRESS PARAMETER MUST BE SPECIFIED      * 01350002
*    WITH THE CALL COMMAND.                                           * 01400002
*                                                                     * 01450002
*    RUN-DIFFERS FROM 'GO' IN THAT IT REMOVES ALL THE BREAKPOINTS     * 01500002
*    ESTABLISHED BY 'AT' AND ADJUSTS THE ENVIRONMENT SO THAT          * 01550002
*    TEST IS REMOVED UPON TERMINATION OF THE PROBLEM PROGRAM.         * 01600002
*                                                                     * 01650002
* ENTRY POINTS                                                        * 01700002
*                                                                     * 01750002
*         IKJEGGO-ENTERED VIA LINK FROM IKJEGMNL.  REGISTER 9 WILL    * 01800002
*    POINT TO TCOMTAB, THE COMMON DSECT USED BY TEST.  THIS IS THE    * 01850002
*    ENTRY POINT WHEN THE GO COMMAND HAS BEEN ISSUED.                 * 01900002
*                                                                     * 01950002
*         IKJEGRUN-ENTERED VIA LINK FROM IKJEGMNL.  REGISTER 9 WILL   * 02000002
*    POINT TO TCOMTAB, THE COMMON DSECT USED BY TEST.  THIS IS THE    * 02050002
*    ENTRY POINT WHEN THE RUN COMMAND HAS BEEN ISSUED.                * 02100002
*                                                                     * 02150002
*         IKJEGCAL-ENTERED VIA LINK FROM IKJEGMNL.  REGISTER 9 WILL   * 02200002
*    POINT TO TCOMTAB, THE COMMAND DSECT USED BY TEST.  THIS IS THE   * 02250002
*    ENTRY POINT WHEN THE CALL COMMAND HAS BEEN ISSUED.               * 02300002
*                                                                     * 02350002
*         ADDRCHK-ENTERED FROM IKJPARS.  REGISTER 1 POINTS TO A       * 02400002
*    THREE WORD PARAMETER LIST.  THE FIRST WORD POINTS TO THE         * 02450002
*    ADDRESS PDE BUILT BY IKJPARS, THE SECOND WORD POINTS TO          * 02500002
*    TCOMTAB AND THE THIRD WORD IS TO BE USED BY THE VALIDITY         * 02550002
*    CHECK ROUTINE TO PASS A POINTER TO A SECOND LEVEL MESSAGE        * 02600002
*    BACK TO IKJPARS.  THIS ROUTINE IS RESPONSIBLE FOR VALIDITY       * 02650002
*    CHECKING ALL PARAMETERS FOR GO, CALL, AND RUN.                   * 02700002
*                                                                     * 02750002
* INPUT                                                               * 02800002
*    THE REQUESTED FUNCTION WILL BE POINTED TO BY THE INBUF FIELD     * 02850002
*    FOUND IN TCOMTAB.  THE FORMAT OF THE GO STATEMENT IS             * 02900002
*    GO ADDR       WHERE THE ADDRESS IS AN OPTIONAL PARAMETER.        * 02950002
*    THE RUN STATEMENT ALSO HAS THE ADDRESS AS AN OPTIONAL PARAMETER  * 03000002
*    AND ITS FORMAT IS                                                * 03050002
*    RUN ADDR                                                         * 03100002
*    THE CALL STATEMENT HAS THE FOLLOWING FORMAT WITH ALL PARAMETERS  * 03150002
*    OPTIONAL EXCEPT THE ADDRESS PARAMETER.                           * 03200002
*    CALL ADDR PARM(ADDR-LIST) VL RETURN(ADDR)                        * 03250002
*                                                                     * 03300002
* OUTPUT                                                              * 03350002
*    GO AND CALL WILL CAUSE THE EXECUTION OF THE PROBLEM PROGRAM      * 03400002
*    WHICH CHANGES THE MODE TO PROBLEM PROGRAM UNTIL A BREAKPOINT IS  * 03450002
*    ENCOUNTERED OR UNTIL COMPLETE EXECUTION OF THE PROBLEM           * 03500002
*    PROGRAM, AT WHICH POINT GO AND CALL CHANGE THE MODE BACK TO THE  * 03550002
*    COMMAND MODE IN WHICH TEST COMMANDS MAY BE ENTERED.              * 03600002
*    RUN CAUSES THE EXECUTION OF THE PROBLEM PROGRAM WHICH CHANGES THE* 03650002
*    MODE TO PROBLEM PROGRAM AND UPON COMPLETION OF EXECUTION THE MODE* 03700002
*    WILL REMAIN PROBLEM PROGRAM.  RUN WIPES OUT ALL TRACES OF TEST.  * 03750002
*                                                                     * 03800002
* EXTERNAL REFERENCES                                                 * 03850002
*                                                                     * 03900002
*         IKJPARS-TO VALIDITY CHECK AND SCAN THE COMMAND BUFFER.      * 03950002
*    REGISTER 1 WILL POINT TO A 7 WORD PARAMETER LIST.                * 04000002
*                                                                     * 04050002
*         IKJEGCVT-TO CONVERT THE ADDRESS TO BINARY.  REGISTER 1      * 04100002
*    WILL BE THE ADDRESS COMPLEMENT OF THE ADDRESS PDE.  REGISTER 0   * 04150002
*    WILL BE POSITIVE TO INDICATE BINARY CONVERSION.                  * 04200002
*                                                                     * 04250002
*         IKJEGSIO-TO WRITE DIAGNOSTIC MESSAGES.                      * 04300002
*                                                                     * 04350002
* EXITS, NORMAL                                                       * 05050002
*                                                                     * 05100002
*         IKJPARS-VIA BRANCH REGISTER 14 FROM ADDRCHK WITH ONE OF THE * 05150002
*    FOLLOWING RETURN CODES IN REGISTER 15-                           * 05200002
*    0   INDICATING TO CONTINUE PROCESSING THE COMMAND BUFFER         * 05250002
*    8   INDICATING IKJPARS SHOULD PROMPT WITH REENTER                * 05300002
*    12  INDICATING IKJPARS SHOULD RETURN TO IKJEGGO WITH A RETURN    * 05350002
*    *   CODE OF 20                                                   * 05400002
*                                                                     * 05450002
*         IKJEGMNL-VIA BRANCH REGISTER 14 FROM IKJEGCAL AND IKJEGGO   * 05500002
*    WITH ONE OF THE FOLLOWING RETURN CODES IN REGISTER 15-           * 05550002
*    4    NORMAL END OF PROCESSING                                    * 05600002
*    16   INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED           * 05650002
*    *    DURING PROCESSING                                           * 05700002
*                                                                     * 05750002
*         IKJEGMNL-VIA BRANCH REGISTER 14 FROM IKJEGRUN WITH ONE      * 05800002
*    OF THE FOLLOWING RETURN CODES IN REGISTER 15-                    * 05850002
*    12   NORMAL END OF PROCESSING, RUNSW IN TCOMTAB ON               * 05900002
*    16   INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED           * 05950002
*    *    DURING PROCESSING                                           * 06000002
*                                                                     * 06050002
* EXITS, ERROR                                                        * 06100002
*         IKJEGMNL-VIA BRANCH REGISTER 14 WITH ONE OF THE FOLLOWING   * 06150002
*    RETURN CODES IN REGISTER 15 -                                    * 06200002
*    00   SYSTEM ERROR, TSTFLUSH IN TCOMTAB ON                        * 06250002
*    12   CRITICAL SYSTEM ERROR IN RUN PROCESSING, RUNSW IN           * 06260002
*    TCOMTAB OFF, TSTFLUSH IN TCOMTAB ON                              * 06280002
*    20   RETURN FROM ESTAE RETRY ROUTINE                             * 06300002
*    24   INDICATING AN ESTAE ERROR EITHER IN THIS MODULE OR A        * 06310002
*         MODULE CALLED BY THIS MODULE                                * 06320002
*                                                                     * 06350002
* TABLES/WORK AREAS                                                   * 06400002
*    THIS MODULE USES THE COMMON DSECT OF THE TEST PACKAGE-TCOMTAB.   * 06450002
*    AREA POINTED TO BY WORKAREA IN TCOMTAB.  THE PARAMETER CONTROL   * 06550002
*    LIST FOR IKJPARS IS BUILT IN THE WORKAREA.                       * 06560002
*    TCOMTAB CONTAINS POINTERS TO THIS MODULE'S SAVEAREA, A POINTER   * 06600002
*    TO THE COMMAND BUFFER, AND A POINTER TO THE OUTPUT BUFFER.       * 06610002
*                                                                     * 06750002
* ATTRIBUTES                                                          * 06800002
*    REENTRANT, REFRESHABLE                                           * 06850002
*                                                                     * 06900002
* CHARACTER CODE DEPENDENCY                                           * 06950002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 07000002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT * 07050002
*    TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED  * 07100002
*    SO THAT REDEFINITION OF CHARACTER CONSTANTS, BY REASSEMBLY,      * 07150002
*    WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.         * 07200002
*                                                                     * 07250002
* NOTES                                                               * 07300002
*    ABBREVIATIONS COMMONLY USED IN THE COMMENTS BESIDE THE CODE      * 07350002
*    1.   PDL-PARAMETER DESCRIPTOR LIST                               * 07400002
*    2.   PDE-PARAMETER DESCRIPTOR ENTRY                              * 07450002
*    3.   PCL-PARAMETER CONTROL LIST                                  * 07500002
*    4.   PPL-PARSE PARAMETER LIST                                    * 07550002
*    THE COMMENTS ON THE STATEMENTS GENERALLY START IN COLUMN 30.     * 07600002
*    STAERTN IS THE ENTRY POINT TO THE STAE RETRY ROUTINE AND IS      * 07650002
*    ENTERED FROM IKJEGSTA.                                           * 07700002
*********************************************************************** 07750002
         EJECT                                                          07800002
*********************************************************************** 07850002
*                                                                     * 07900002
*        OTHER ENTRY POINTS TO THIS MODULE                            * 07950002
*                                                                     * 08000002
*********************************************************************** 08050002
         ENTRY IKJEGRUN                                                 08100002
         ENTRY IKJEGCAL                                                 08150002
         SPACE 3                                                        08200002
*********************************************************************** 08250002
*                                                                     * 08300002
*                      EQUATES                                        * 08350002
*                                                                     * 08400002
*********************************************************************** 08450002
         SPACE                                                          08500002
R0       EQU   0             REGISTER 0 - USED AS A PARM REGISTER       08550002
R1       EQU   1             REGISTER 1 - WORK REG AND SYSTEM REG       08600002
R2       EQU   2             REGISTER 2 - WORKREG                       08650002
R3       EQU   3             REGISTER 3 - WORKREG                       08700002
R4       EQU   4             REGISTER 4 - WORKREG                       08750002
R5       EQU   5             REGISTER 5 - WORKREG                       08800002
R6       EQU   6             REGISTER 6 - USED FOR TSTCWORK             08850002
*                            ADDRESSABILITY - SET IN SETUP CODE AND     08900002
*                            ABNORMAL ADDRCHCK RETURNS AND              08950002
*                            NOWHERE ELSE.                              09000002
R7       EQU   7             REGISTER 7 - BASE FOR ADDR PDE             09050002
R8       EQU   8             REGISTER 8 - WORKREG                       09100002
R9       EQU   9             REGISTER 9 - BASE FOR TCOMTAB              09150002
R10      EQU   10            REGISTER 10 - FOR INTERNAL BAL'S           09200002
R11      EQU   11            REGISTER 11 - RESERVED FOR MAINTENANCE     09250002
R12      EQU   12            REGISTER 12 - BASE FOR CSECT               09300002
R13      EQU   13            REGISTER 13 - SAVE AREA POINTER            09350002
R14      EQU   14            REGISTER 14 - FOR EXTERNAL BALR'S          09400002
R15      EQU   15            REGISTER 15 - WORKREG AND RETURN CODES     09450002
         SPACE                                                          09500002
L0       EQU    0            LENGTH OF 0 FOR EXECUTED MOVES             09550002
L2       EQU    2            LENGTH OF 2                                09600002
L3       EQU    3            LENGTH OF 3                                09650002
L4       EQU    4            LENGTH OF 4                                09700002
L8       EQU    8            LENGTH OF 8                                09750002
L12      EQU    12           LENGTH OF 12                               09800002
         SPACE                                                          09850002
D0       EQU    0            DISPLACEMENT OF 0                          09900002
D1       EQU    1            DISPLACEMENT OF 1                          09950002
D2       EQU    2            DISPLACEMENT OF 2                          10000002
D4       EQU    4            DISPLACEMENT OF 4                          10050002
D6       EQU    6            DISPLACEMENT OF 6                          10100002
D8       EQU    8            DISPLACEMENT OF 8                          10150002
         SPACE                                                          10200002
FACTOR   EQU    8            USED TO CALCULATE MSG DISPLACEMENT         10250002
FOUR     EQU    4            RETURN CODE FROM CALL AND GO               10300002
GOCODE   EQU   X'04'         GO RETURN CODE                             10350002
EIGHT    EQU    8            CALL CODE FOR PARSE EXIT                   10400002
ERCODE   EQU   8             ERROR RETURN CODE FROM RUN TO END TEST     10450002
CALLCODE EQU   GOCODE        CALL RETURN CODE - SAME AS GO              10500002
TWELVE   EQU   12            PARSE VALIDITY CHECK AND RUN RETURN CODES  10550002
RUNCODE  EQU   X'0C'         RUN RETURN CODE                            10600002
RET16    EQU   16            USED TO SET ATTN RETURN CODE FOR IKJEGMNL  10650002
RC24     EQU   24            ESTAE ERROR RETURN CODE                    10660002
RETCOD20 EQU   20            USED TO SET STAE RETURN CODE FOR IKJEGMNL  10700002
HEXONE   EQU   X'01'         INDICATOR GETMAIN FAILED                   10750002
HEXTHREE EQU   X'03'         INDICATOR LINK FAILED                      10800002
HEXFF    EQU   X'FF'         INDICATOR OF END OF STAE ABEND TABLE       10850002
HEXOF    EQU   X'0F'         BINARY '00001111' USED TO TEST FOR         10900002
*                            KEYWORDS FROM PARSE                        10950002
HIGHBIT  EQU   B'10000000'   HIGH ORDER BIT MASK.                       11000002
LENBITS  EQU   X'C0'         LENGTH BITS OF OP CODE                     11020002
PLUSSIGN EQU   C'+'          PLUS SIGN FOR INDICATING 2ND LEVEL MSG     11050002
         EJECT                                                          11550002
         USING TCOMTAB,R9    SET UP TCOMTAB ADDRESSABILITY              11600002
*                            FOR THIS CSECT                             11650002
         USING TSTCWORK,R6   R6 WILL BE SET UP TO POINT TO              11700002
*                            TSTCWORK                                   11750002
         SPACE                                                          11800002
*********************************************************************** 11850002
*                                                                     * 11900002
*                 GO PROCESSING STARTS HERE                           * 11950002
*                                                                     * 12000002
*********************************************************************** 12050002
         SPACE                                                          12100002
GO       DS    0H            GO COMMAND OF TEST                         12150002
         SAVE  (14,12),,*    SAVE CALLER'S REGISTERS                    12200002
         LR    R12,R15       ESTABLISH ADDRESSABILITY TO BEGINNING      12250002
         USING IKJEGGO,R12   OF PROGRAM                                 12300002
         LA    R5,GOSPL      R5=ADDR OF ESTAE PARM LIST                 12310002
         BAL   R10,SETUP     FINISH ENTRY LINKAGE, ISSUE STAE, AND      12350002
*                            POINT R6 TO GO'S WORKAREA                  12400002
         MVI   CMDCODE,GOCODE SAVE GO RETURN CODE                       12450002
         LA    R2,FOUR       SAVE GO CODE FOR PARSBILD ROUTINE          12500002
         SPACE                                                          12550002
INIT     DS    0H            RUN PROCESSING ENTERS HERE                 12600002
*********************************************************************** 12650002
**             CHECK FOR AN ADDRESS IN INPUT COMMAND                 ** 12700002
*********************************************************************** 12750002
         TM    TSTFLGS3,NOPARMS  HAS AN ADDRESS BEEN SUPPLIED.          12800002
         BO    RESUME        NO ADDRESS - CONTINUE.                     12850002
*********************************************************************** 12900002
**             SET UP PCL AND PARSE THE COMMAND                      ** 12950002
*********************************************************************** 13000002
         L     R4,GOCON      REG 4 CONTAINS GO PARAMETER CONTROL        13050002
*                            LIST (PCL) ADDRESS                         13100002
         BAL   R10,PARSBILD  BUILD PARM LIST AND PARSE INPUT            13150002
         SPACE                                                          13200002
*********************************************************************** 13250002
** CHECK TO SEE IF AN ADDRESS IS SPECIFIED.  IF SO USE IT TO ALTER   ** 13300002
** THE PROGRAM'S RESUME ADDRESS, OTHERWISE BACK THE CURRENT RESUME   ** 13350002
** ADDRESS UP TWO BYTES TO CONTINUE.                                 ** 13400002
*********************************************************************** 13450002
         SPACE                                                          13500002
         SR    R5,R5         CLEAR REGISTER 5                           13550002
         L     R7,TSTANSPL   REG 7 CONTAINS ADDRESS OF PDL              13600002
         USING GORUNDUM,R7   ESTABLISH PDL ADDRESSABILITY               13650002
         LA    R7,ADDR       REG 7 CONTAINS ADDR OF ADDRESS PDE         13700002
         DROP  R7            DROP PDL ADDRESSABILITY                    13750002
         USING IKJPARMA,R7   ESTABLISH PDE ADDRESSABILITY               13800002
*********************************************************************** 13850002
*              REGISTER 7 IS USED AS THE BASE FOR ALL PDE             * 13900002
*              REFERENCES FROM HERE ON                                * 13950002
*********************************************************************** 14000002
         O     R5,PDEUSER    REG 5 CONTAINS ADDRESS IF SPECIFIED        14050002
         BZ    RESUME        NONE SPECIFIED, USE RESUME ADDR.           14100002
         SPACE                                                          14150002
*********************************************************************** 14200002
**             AN ADDRESS WAS SUPPLIED, TURN OFF WAIT COUNT          ** 14250002
*********************************************************************** 14300002
SETWAIT  DS    0H                                                       14350002
         L     R3,PPTCB      ADDR SPECIFIED, REG 3 CONTAINS ADDR OF     14400002
*                            PROBLEM PROGRAM TCB                        14450002
         IKJEGS9G  WCF,TCBADDR=(R3),MF=(E,SVCPARMS)   TURN OFF         *14500002
                             WAIT COUNT                                 14550002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO ?                  14600002
         BNZ   SVCERR        NO, ISSUE ERROR MESSAGE AND QUIT           14650002
         B     PSWSET        SPECIFIED, USE IT.                         14700002
         SPACE                                                          14750002
*********************************************************************** 14800002
** REGISTER 5 CONTAINS THE PRESUMED NEW IC ADDR FOR THE PROGRAM.     ** 14850002
** DETERMINE IF A USER-INSERTED BREAKPOINT EXISTS AT THAT ADDR.      ** 14900002
*********************************************************************** 14950002
BREAKTST DS    0H                                                       15000002
         SPACE                                                          15050002
         L     R4,BREAKTAB   REG 4 CONTAINS ADDR OF FIRST ELEMENT       15100002
         SPACE                                                          15150002
*********************************************************************** 15200002
**THIS CODE TESTS TO SEE IF THE NEW IC IS ON THE BREAK ELEMENT CHAIN ** 15250002
*********************************************************************** 15300002
LOOP1    DS    0H                                                       15350002
         LTR   R4,R4         IS THIS THE END OF CHAIN                   15400002
         BZ    PSWSET2       YES, ADDR NOT A BREAKPOINT, USE IT FOR     15450002
*                            RESUME ADDRESS                             15500002
         USING BRKELEM,R4    ESTABLISH BREAK ELEMENT ADDRESSABILITY     15550002
         C     R5,BRKADDR    IS ADDR SPECIFIED THIS BREAK ADDR          15600002
         BE    BREAK         YES, GO SET UP TO CHANGE THE IC            15650002
         L     R4,BRKLINK    NO, POINT TO NEXT BREAK ELEMENT            15700002
         B     LOOP1         GO TEST FOR BREAK POINT AT PRESUMED NEW    15750002
*                            IC ADDRESS                                 15800002
         SPACE                                                          15850002
*********************************************************************** 15900002
*        NO ADDRESS SUPPLIED. IF THIS IS A RUN REQUEST, GO REMOVE     * 15950002
*        ALL REMNANTS OF TEST FROM PP'S TCBS. OTHERWISE, GET RESUME   * 16000002
*        ADDRESS FROM OLD PSW IN SVRB FOR GO AND CALL.                * 16050002
*********************************************************************** 16100002
RESUME   DS    0H                                                       16150002
         L     R5,PPTCB      REG 5 POINTS TO THE PROBLEM PROGRAM TCB    16300002
         L     R5,TCBRBP-TCB(R5) REG 5 POINTS TO THE BREAKPOINT SVRB    16350002
         L     R5,RBLINK-RBSECT(R5)    REG 5 POINTS TO THE PROBLEM      16400002
*                            PROGRAM REQUEST BLOCK                      16450002
         L     R5,RBOPSW-RBSECT+D4(R5) PICK UP THE RESUME IC FROM       16500002
*                            THE OLD PSW (RBOPSW) IN THE REQUEST BLOCK  16550002
         LA    R5,D0(R5)     CLEAR HIGH ORDER BYTE                      16600002
         CLI   CMDCODE,RUNCODE    IS THIS A RUN REQUEST ?               16610002
         BE    RUNSET        YES, SET RESUME ADDRESS FOR RUN            16620002
         CLC   D0(L2,R5),TSTSVC IS BREAKPOINT INSTR THERE               16650002
         BE    BREAKTST      YES, CHECK FOR USER-SET BREAKPOINT         16700002
         B     EXIT          NO, GO RETURN TO MAINLINE                  16750002
         SPACE 2                                                        16800002
*********************************************************************** 16850002
** RESUME ADDRESS IN REGISTER 5 IS ADDRESS OF A BREAK SVC.           ** 16900002
** SET REGISTER 5 TO POINT TO INSTRUCTION SAVED IN THE BREAK ELEMENT.** 16950002
** THE PROBLEM PROGRAM WILL RESUME AT THAT POINT.                    ** 17000002
*********************************************************************** 17050002
BREAK    DS    0H                                                       17100002
         LA    R5,BRKINST    REG 5 CONTAINS ADDRESS OF SAVED INST       17150002
*********************************************************************** 17200002
*        R5 CONTAINS NEW RESUME ADDRESS. PUT IT INTO RESUME           * 17250002
*        PSW IN SVRB                                                  * 17300002
*********************************************************************** 17350002
PSWSET2  DS    0H                                                       17400002
         L     R3,PPTCB      GET ADDRESS OF PP'S TCB                    17450002
PSWSET   DS    0H                                                       17500002
         LA    R5,D0(R5)     CLEAR HIGH ORDER BYTE OF ADDR              17510002
         IKJEGS9G OPSW,TCBADDR=(R3),VALUE=(R5),MF=(E,SVCPARMS)         *17550002
                             RESET IC IN RESUME PSW                     17600002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   17650002
         BNZ   SVCERR        NO, ISSUE ERROR MESSAGE AND QUIT           17700002
         SPACE                                                          17750002
*********************************************************************** 17800002
*        IF THIS IS A RUN REQUEST, GO REMOVE ALL REMNANTS OF TEST     * 17850002
*        FROM PP'S TCBS.                                              * 17900002
*********************************************************************** 17950002
         CLI   CMDCODE,RUNCODE  IS THIS A RUN REQUEST ?                 18000002
         BE    RESET         YES, GO RESET TCBS                         18050002
         SPACE                                                          18100002
*********************************************************************** 18150002
*        NORMAL RETURN TO MAINLINE FROM GO, CALL, AND RUN             * 18200002
*********************************************************************** 18250002
EXIT     DS    0H            SET PROPER RETURN CODE (CONTAINED IN R11)  18300002
         SR    R15,R15       ZERO REG 15                                18350002
         IC    R15,CMDCODE   PUT RETURN CODE INTO REGISTER 15           18400002
         SPACE                                                          18450002
RETURN   DS    0H            RETURN TO IKJEGMNL                         18500002
         LR    R2,R15        SAVE RETURN CODE                           18502002
         ESTAE 0             REMOVE ESTAE                               18510002
         LR    R15,R2        RESET RETURN CODE                          18512002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY BIT               18520002
         L     R13,SAVELAST-SAVEAREA(R13) RESET SAVE AREA POINTER       18550002
         RETURN  (14,12),RC=(15)  RETURN TO IKJEGMNL                    18600002
         SPACE                                                          18650002
*********************************************************************** 18700002
*        INPUT COMMAND WAS INCORRECT AND PARSE WAS UNABLE TO          * 18750002
*        PROMPT. TELL MAINLINE TO FLUSH THE INPUT STACK.              * 18800002
*********************************************************************** 18850002
FLUSHIT  DS    0H                                                       18900002
         OI    TSTFLGS4,TSTFLUSH  INDICATE IKJEGMNL SHOULD FLUSH STACK  18950002
         SPACE                                                          19000002
*********************************************************************** 19050002
*        SET RETURN CODE TO MAINLINE TO 0 FOR SYSTEM ERROR            * 19100002
*********************************************************************** 19150002
EXIT0    DS    0H                                                       19200002
         XR    R15,R15       SET RETURN CODE                            19250002
         B     RETURN        RETURN TO IKJEGMNL                         19300002
         SPACE                                                          19350002
*********************************************************************** 19400002
*        USER ENTERED AN ATTENTION, RETURN TO MNL WITH 16 RETURN CODE * 19450002
*********************************************************************** 19500002
ATTNEXIT DS    0H                                                       19550002
         LA    R15,RET16     INDICATE ATTENTION INTERRUPT ENCOUNTERED   19600002
         B     RETURN        GO SET UP TO RETURN TO IKJEGMNL            19650002
         SPACE                                                          19700002
*********************************************************************** 19710002
*        ESTAE ERROR ENCOUNTERED IN THIS MODULE OR ONE OF THE         * 19720002
*        MODULES CALLED BY THIS MODULE                                * 19730002
*********************************************************************** 19740002
EXIT24   DS    0H                                                       19742002
         LA    R15,RC24      INDICATE ESTAE ERROR ENCOUNTERED           19744002
         B     RETURN        GO SET UP RETURN TO IKJEGMNL               19746002
         SPACE                                                          19748002
*********************************************************************** 19750002
*        ERROR OR ATTN OCCURRED DURING VALIDITY CHECK PROCESSING.     * 19800002
*        SERVICE ROUTINE RETURN CODE WAS SAVED IN REGSAVE FIELD.      * 19850002
*        GET IT AND PERFORM APPROPRIATE FUNCTION.                     * 19900002
*********************************************************************** 19950002
CHKRET   DS    0H                                                       20000002
         L     R15,REGSAVE   PUT SAVED RETURN CODE INTO REG 15          20050002
SEVRET   DS    0H                                                       20100002
         B     RETTAB(R15)   GO THROUGH FOLLOWING TABLE INDEXED         20150002
*                            CONTENTS OF REGISTER 15                    20200002
RETTAB   DS    0H                                                       20250002
         B     EXIT0         THIS CONDITION SHOULD BE IMPOSSIBLE        20300002
         B     EXIT0         4-FROM SERVICE ROUTINE-RETURN 0            20350002
         B     EXIT0         8-FROM SERVICE ROUTINE-RETURN 0            20400002
         B     EXIT0         12-FROM SERVICE ROUTINE-RETURN 0           20450002
         B     RETURN        16-FROM SERVICE ROUTINE-RETURN 16          20500002
         B     RETURN        20-FROM SERVICE ROUTINE-RETURN 20          20550002
         B     RETURN        24-FROM SERVICE ROUTINE-RETURN 24          20560002
         SPACE 2                                                        20600002
*********************************************************************** 20650002
*        THIS SUBROUTINE IS ENTERED WITH A BAL 10,SETUP.              * 20700002
*        IT COMPLETES THE ENTRY LINKAGE AND ISSUES ESTAE FOR GO,      * 20750002
*        RUN, AND CALL. UPON RETURN FROM THIS CODE, REG 6 CONTAINS    * 20800002
*        THE ADDRESS OF GO'S WORKAREA.                                * 20850002
*********************************************************************** 20900002
SETUP    DS    0H                                                       20950002
         L     R15,REGSAVE2  SUBCOMMAND SAVE AREA.                      21000002
         ST    R15,SAVENEXT-SAVEAREA(R13) SAVE FOWARD POINTER.          21050002
         ST    R13,SAVELAST-SAVEAREA(R15) SAVE BACK POINTER.            21100002
         LR    R13,R15       SET REGISTER 13                            21150002
**********************************************************************  21200002
*              ISSUE ESTAE FOR GO, RUN, AND CALL                     *  21250002
**********************************************************************  21300002
STAECODE DS    0H                                                       21350002
         STM   R14,R12,RETURNPT-SAVEAREA(R13)  SAVE OUR REGISTERS       21400002
         L     R6,WORKAREA   LOAD ADDR OF WORKAREA                      21450002
         XC    STAEAREA,STAEAREA CLEAR ESTAE PARM AREA                  21500002
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             21510002
         ESTAE (R15),CT,PARAM=(R5),XCTL=NO,RECORD=YES,                 *21550002
               MF=(E,STAEAREA)  ESTABLISH ESTAE EXIT                    21600002
         LTR   R15,R15       RETURN CODE FROM ESTAE                     21900002
         BZ    D0(R10)       RETURN TO CALLER                           21910002
         STC   R15,TSTESTRC  SAVE ESTAE RETURN CODE                     21920002
         B     EXIT24        RETURN TO MAINLINE WITH RC=24              21930002
SMTSTAE  DS    0H            SMT LABEL FOR TEST CASES TGO01500          21950002
*                            AND TCAL2900                               22000002
         BNZ   CODE16        NONZERO STAE RETURN CODE, GO WRITE MESSAGE 22050002
         BR    R10           RETURN TO CALLER.                          22100002
         EJECT                                                          22150002
*********************************************************************** 22200002
*                                                                     * 22250002
*        RUN PROCESSING STARTS HERE                                   * 22300002
*                                                                     * 22350002
*********************************************************************** 22400002
IKJEGRUN DS    0D            RUN COMMAND OF TEST                        22450002
         SAVE  (14,12),,IKJEGRUN                                        22500002
         L     R12,BASECON-IKJEGRUN(R15)  SETUP BASE REG.               22550002
         LA    R5,RUNSPL     R5=ADDR OF ESTAE PARM LIST                 22560002
         BAL   R10,SETUP     FINISH ENTRY LINKAGE, ISSUE STAE, AND      22600002
*                            POINT R6 TO GO'S WORKAREA                  22650002
         MVI   CMDCODE,RUNCODE SAVE RETURN CODE FROM RUN                22700002
         LA    R2,TWELVE     SET RUN INDICATOR FOR PARSE EXIT.          22750002
         SPACE                                                          22800002
*********************************************************************** 22850002
*        IF THIS IS AN OVERLAY MODULE, THE HIGH ORDER BIT             * 22900002
*        OF THE FIRST BYTE OF THE TSTDCB FIELD IN TCOMTAB WILL BE ON. * 22950002
*        IF SO, WRITE ERROR MESSAGE. IF NOT, BRANCH TO INIT SECTION   * 23000002
*        OF GO'S CODE.                                                * 23050002
*********************************************************************** 23100002
         TM    TSTDCB,HIGHBIT  IS THIS AN OVERLAY MODULE                23150002
         BZ    INIT          NO, CONTINUE PROCESSING REQUEST            23200002
         LA    R3,MSG3       YES, PREPARE TO WRITE MESSAGE IKJ57423I    23250002
         B     MSGRTN        GO TO THE MESSAGE ROUTINE                  23300002
         SPACE                                                          23300502
*********************************************************************** 23301002
*        A RUN WAS ISSUED WITH NO RESUME ADDRESS. R5 CONTAINS         * 23301502
*        RESUME ADDRESS FROM PP'S RBOPSW FIELD. CHECK TO SEE          * 23302002
*        IF THIS ADDRESS POINTS TO PPEXIT2 IN TCOMTAB, OR TO AN       * 23302502
*        INSTRUCTION IN A BRKELEM. IF NEITHER, LEAVE RESUME           * 23303002
*        ADDRESS ALONE. IF IT POINTS TO PPEXIT2, RESET TO POINT       * 23303502
*        TO CVTEXIT IN THE CVT. IF IT POINTS TO A BRKELEM             * 23304002
*        INSTRUCTION, RESET IT TO POINT TO THE APPROPRIATE POINT      * 23304502
*        IN THE PROBLEM PROGRAM.                                      * 23305002
*********************************************************************** 23305502
         SPACE                                                          23306002
RUNSET   DS    0H            CHECK RESUME ADDRESS AND RESET IT          23306502
*                            IF NECESSARY                               23307002
         LA    R4,PPEXIT2    GET ADDRESS OF PPEXIT2                     23307502
         CR    R4,R5         IS RESUME ADDRESS PPEXIT2 ?                23308002
         BE    SETEXIT       YES, GO RESET TO POINT TO CVTEXIT          23308502
         L     R8,BREAKTAB   GET ADDRESS OF FIRST BRKELEM               23309002
         USING BRKELEM,R8    R8 IS BASE FOR BRKELEM                     23309502
         SPACE                                                          23310002
CKBRKELM DS    0H            IF A BRKELEM EXISTS, SEE IF RESUME         23310502
*                            ADDRESS FOLLOWS INSTRUCTION IN BRKELEM -   23311002
*                            IF IT DOES, PP PROBABLY ABENDED IN BRKELEM 23311502
         LTR   R8,R8         DOES A BRKELEM EXIST ?                     23312002
         BZ    RESET         NO, GO RESET TRN FIELD                     23312502
         TM    BRKINST,LENBITS  HOW LONG IS INSTRUCTION IN BRKELEM ?    23313002
         LA    R3,L2         PUT A 2 IN R3                              23313502
         BZ    CHEKBRK       INSTRUCTION IS TWO BYTES, GO               23314002
*                            CHECK RESUME ADDRESS                       23314502
         LA    R3,L2(R3)     ADD TWO MORE TO LENGTH                     23315002
         BM    CHEKBRK       INSTRUCTION IS FOUR BYTES - GO CHECK       23315502
*                            RESUME ADDRESS                             23316002
         LA    R3,L2(R3)     ADD TWO TO LENGTH - SIX BYTE INSTRUCTION   23316502
         SPACE                                                          23317002
CHEKBRK  DS    0H            SEE IF RESUME ADDRESS POINTS TO            23317502
*                            END OF INSTRUCTION                         23318002
         LA    R4,BRKINST(R3)  POINT TO END OF INSTRUCTION              23318502
         CR    R4,R5         DOES RESUME ADDRESS POINT THERE ?          23319002
         BE    SETBRK        YES, PP PROBABLY ABENDED HERE - GO RESET   23319502
*                            RESUME ADDRESS TO FOLLOW INSTRUCTION IN PP 23320002
         L     R8,BRKLINK    GET ADDRESS OF NEXT BRKELEM                23320502
         B     CKBRKELM      GO CHECK NEXT BRKELEM                      23321002
SETBRK   DS    0H            RESUME ADDRESS FOLLOWED BREAKPOINT         23321502
*                            INSTRUCTION IN BRKELEM. RESET RESUME       23322002
*                            ADDRESS TO FOLLOW INSTRUCTION IN PP        23322502
         L     R4,BRKADDR    GET ADDR OF BREAKPOINT FOR BRKELEM         23323002
         LA    R4,D0(R3,R4)  POINT PAST BREAKPOINTED INSTRUCTION        23323502
         B     SETADDR       GO RESET RESUME ADDRESS                    23324002
         SPACE                                                          23324502
SETEXIT  DS    0H            RESUME ADDRESS POINTED TO PPEXIT2, RESET   23325002
*                            IT TO POINT TO CVTEXIT IN CVT              23325502
         L     R4,CVTPTR     GET ADDRESS OF CVT                         23326002
         USING CVT,R4        R4 IS BASE FOR CVT                         23326502
         LA    R4,CVTEXIT    GET ADDRESS OF CVTEXIT                     23327002
         DROP  R4            R4 NO LONGER CVT BASE                      23327502
         SPACE                                                          23328002
SETADDR  DS    0H            R4 CONTAINS NEW RESUME ADDRESS. USE IT     23328502
*                            TO CHANGE RBOPSW FIELD.                    23329002
         L     R5,PPTCB      GET PP'S TCB ADDRESS IN R5                 23329502
         IKJEGS9G  OPSW,TCBADDR=(R5),VALUE=(R4),MF=(E,SVCPARMS)  RESET *23330002
                             PP RESUME ADDRESS                          23330502
         LTR   R15,R15       IS RETURN CODE ZERO ?                      23331002
         BNZ   SVCERR        NO, GO ISSUE ERROR MESSAGE AND QUIT        23331502
         SPACE                                                          23332002
*********************************************************************** 23332502
*        RESET PROBLEM PROGRAM'S REGISTER 14 TO POINT TO AN SVC 3     * 23333002
*        IN CVT IF IT NOW POINTS TO SVC 97 (PPEXIT) IN TCOMTAB.       * 23333502
*        RESET BOTH THE ACTIVE PROGRAM'S REGISTER 14, AND REGISTER    * 23334002
*        14 IN THE FIRST SAVE AREA OFF THE FIRST DAUGHTER TCB         * 23334502
*        UNDER TEST.                                                  * 23335002
*********************************************************************** 23335502
         SPACE                                                          23336002
RESET    DS    0H            RESET REGISTER 14                          23336502
         L     R4,TSTTCB     GET ADDRESS OF TEST'S TCB                  23337002
         L     R4,TCBLTC-TCB(R4)  GET ADDRESS OF FIRST DAUGHTER         23337502
         L     R4,TCBFSA-TCB(R4)  GET ADDRESS OF FIRST SAVE AREA        23338002
         L     R8,RETURNPT-SAVEAREA(R4)  GET ORIGINAL REGISTER 14       23338502
         LA    R8,D0(R8)     CLEAR HIGH ORDER BYTE                      23339002
         LA    R5,PPEXIT     GET ADDRESS OF SVC 97 IN TCOMTAB           23339502
         CR    R5,R8         ARE THEY THE SAME                          23340002
         BNE   CKACTIVE      NO, GO CHECK ACTIVE R14                    23340502
         L     R8,CVTPTR     GET ADDRESS OF CVT                         23341002
         LA    R8,CVTEXIT-CVT(R8) GET ADDRESS OF SVC3 IN CVT            23341502
         ST    R8,RETURNPT-SAVEAREA(R4)  REPLACE ORIGINAL R14           23342002
         SPACE                                                          23342502
CKACTIVE DS    0H            CHECK ACTIVE R14                           23343002
         L     R4,PPTCB      GET ACTIVE PP TCB ADDRESS                  23343502
         L     R5,TCBRBP-TCB(R4)  GET SVRB ADDRESS FOR SVC 97           23344002
         L     R8,RBGRS14-RBSECT(R5)  GET ACTIVE R14 FOR PP             23344502
         LA    R8,D0(R8)      CLEAR HIGH ORDER BYTE                     23345002
         LA    R5,PPEXIT     GET ADDRESS OF SVC 97 IN TCOMTAB           23345502
         CR    R5,R8         ARE THEY THE SAME ?                        23346002
         BNE   OFFTEST       NO, GO REMOVE REMNANTS OF TEST             23346502
         L     R8,CVTPTR     GET ADDRESS OF CVT                         23347002
         LA    R8,CVTEXIT-CVT(R8) GET ADDRESS OF SVC3 IN CVT            23347502
         IKJEGS9G  GPR,TCBADDR=(R4),VALUE=(R8),REGNO=14,MF=(E,SVCPARMS)*23348002
                             REPLACE ACTIVE R14                         23348502
         LTR   R15,R15       SVC RETURN CODE ZERO ?                     23349002
         BNZ   SVCERR        NO, GO ISSUE ERROR MESSAGE AND QUIT        23349502
         SPACE                                                          23350002
*********************************************************************** 23400002
*        OTHER PROCESSING ALL DONE.  FOR ALL TASKS UNDER TEST'S TCB,  * 23450002
*        TURN OFF TEST BIT AND RESET TCBTRN FIELD TO 0 IN TCB.        * 23500002
*********************************************************************** 23550002
OFFTEST  DS    0H                                                       23600002
         L     R4,TSTTCB     REG 4 CONTAINS ADDR OF TEST'S TCB          23650002
         USING TCB,R4        ALLOW SYMBOLIC REFERENCE                   23700002
         LA    R8,D0(R4)     CLEAR HIGH ORDER BYTE AND SAVE             23750002
*********************************************************************** 23800002
*        FIND TEST'S SUBTASKS' TCBS.                                  * 23850002
*********************************************************************** 23900002
DAU      DS    0H                                                       23950002
         L     R5,TCBLTC     GET THE ADDR OF THE LAST DAUGHTER TASK     24000002
         LTR   R5,R5         IS THERE A DAUGHTER TASK                   24050002
         BNZ   PROCESS       YES, GO PROCESS                            24100002
SIS      DS    0H                                                       24150002
         L     R5,TCBNTC     NO, GET ADDRESS OF NEXT SISTER TCB IF ONE  24200002
         LTR   R5,R5         WAS THERE A SISTER TASK                    24250002
         BNZ   PROCESS       YES, GO PROCESS                            24300002
MOTH     DS    0H                                                       24350002
         L     R4,TCBOTC     NO, GET ADDRESS OF MOTHER TASK             24400002
         LA    R4,D0(R4)     CLEAR HIGH ORDER BYTE                      24450002
         CR    R4,R8         DOES MOTHER TASK = TEST TASK               24500002
         BNE   SIS           NO, GO CHECK FOR ANOTHER SISTER TCB        24550002
         SPACE                                                          24600002
*********************************************************************** 24650002
*        ALL DONE - RETURN TO MNL WITH OK RETURN CODE.                * 24700002
*********************************************************************** 24750002
RUNRTN   DS    0H                                                       24800002
         OI    TSTFLGS1,RUNSW TURN ON RUN SWITCH                        24820002
         B     EXIT          RUN AND GO SHARE CODE FROM HERE ON.        24850002
         SPACE                                                          24900002
*********************************************************************** 24950002
*        IF TASK IS UNDER TEST, TURN OFF TEST BIT, RESET TCBTRN.      * 25000002
*********************************************************************** 25050002
PROCESS  DS    0H                                                       25100002
         LA    R5,D0(R5)     CLEAR HIGH ORDER BYTE                      25150002
         CLC   TCBPKF,TCBPKF-TCB(R5)  IS THIS TCB'S KEY                 25200002
*                            THE SAME KEY AS TEST'S TCB                 25250002
         BNE   BUMPTCB       NO, THE TASK IS NOT UNDER TEST             25300002
         IKJEGS9G TCPOFF,TCBADDR=(R5),MF=(E,SVCPARMS) TURN OFF         *25350002
                             TEST BIT                                   25400002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   25450002
         BNZ   RUNBLEW       NO, GO TRY TO RECOVER                      25500002
         IKJEGS9G TRN,TCBADDR=(R5),VALUE=D0,MF=(E,SVCPARMS) RESET TRN   25550002
         LTR   R15,R15       SVC97 RETURN CODE ZERO?                    25600002
         BNZ   RUNBLEW       NO, GO TRY TO RECOVER                      25650002
         SPACE                                                          25700002
*********************************************************************** 25750002
*        GET ADDRESS OF NEXT TCB, PROCESS IT.                         * 25800002
*********************************************************************** 25850002
BUMPTCB  DS    0H            GET ADDRESS OF NEXT TCB                    25900002
         LR    R4,R5         FIND NEXT TCB UNDER TEST                   25950002
         B     DAU           LOOP UNTIL FINISHED                        26000002
         EJECT                                                          26050002
*********************************************************************** 26100002
*        NONZERO RETURN CODE FROM SVC 97 INDICATES BAD ERROR. ATTEMPT * 26150002
*        TO RECOVER BY REVERSING ABOVE PROCEDURE. IF RECOVERY         * 26200002
*        FAILS, ISSUE CRITICAL SYSTEM ERROR MESSAGE, AND RETURN       * 26250002
*        TO MAINLINE WITH A RETURN CODE OF 8 TO END TEST SESSION.     * 26300002
*        IF RECOVERY IS SUCCESSFUL, ISSUE SYSTEM ERROR MESSAGE AND    * 26350002
*        RETURN TO MAINLINE WITH A RETURN CODE OF 0.                  * 26400002
*********************************************************************** 26450002
         SPACE                                                          26500002
RUNBLEW  DS    0H                                                       26550002
         L     R4,TSTTCB     GET ADDRESS OF TEST'S TCB IN R4            26600002
         LA    R8,D0(R4)     CLEAR HI BYTE AND PUT IN R8                26650002
         SPACE                                                          26700002
BLEWDAU  DS    0H                                                       26750002
         L     R5,TCBLTC     GET ADDRESS OF DAUGHTER TCB                26800002
         LTR   R5,R5         ANY DAUGHTER TCB?                          26850002
         BNZ   BLEWPROC      YES, GO PROCESS IT                         26900002
         SPACE                                                          26950002
BLEWSIS  DS    0H                                                       27000002
         L     R5,TCBNTC     GET ADDRESS OF SISTER TCB                  27050002
         LTR   R5,R5         ANY SISTER TCB?                            27100002
         BNZ   BLEWPROC      YES, GO PROCESS IT                         27150002
         SPACE                                                          27200002
BLEWMOTH DS    0H                                                       27250002
         L     R4,TCBOTC     GET ADDRESS OF MOTHER TCB                  27300002
         LA    R4,D0(R4)     CLEAR HI BYTE                              27350002
         CR    R8,R4         IS THIS TEST'S TCB?                        27400002
         BNE   BLEWSIS       NO, CONTINUE CLEANUP                       27450002
         B     RUNSVCMS      RECOVERY SUCCESSFUL, GO ISSUE MESSAGE      27500002
         SPACE                                                          27550002
BLEWPROC DS    0H                                                       27600002
         LA    R5,D0(R5)     CLEAR HI BYTE OF TCB ADDRESS               27650002
         CLC   TCBPKF,TCBPKF-TCB(R5)  DOES THIS TCB HAVE THE SAME       27700002
*                            KEY AS TEST'S                              27750002
         BNE   BLEWBUMP      NO, THIS TCB NOT UNDER TEST                27800002
         CLI   TCBABF-TCB(R5),TCBTCP   IS THIS TCB'S TEST BIT ON?       27850002
         BE    BLEWTRN       YES, GO CHECK IT'S TRN FIELD               27900002
         IKJEGS9G TCPON,TCBADDR=(R5),MF=(E,SVCPARMS) TURN THIS TCB'S   *27950002
                             TEST BIT ON                                28000002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   28050002
         BNZ   RUNEND        NO, RECOVERY UNSUCCESSFUL                  28100002
         SPACE                                                          28150002
BLEWTRN  DS    0H                                                       28200002
         L     R7,TCBTRN-TCB(R5)  GET TCBTRN FIELD IN R7                28250002
         LA    R7,D0(R7)     CLEAR HI BYTE                              28300002
         CR    R7,R9         IS TRN FIELD POINTER TO TCOMTAB ?          28350002
         BE    BLEWBUMP      YES, THIS TCB OK                           28400002
         IKJEGS9G  TRN,TCBADDR=(R5),VALUE=(R9),MF=(E,SVCPARMS)  RESET  *28450002
                             TRN FIELD OF TCB                           28500002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   28550002
         BNZ   RUNEND        NO, RECOVERY UNSUCCESSFUL                  28600002
         SPACE                                                          28650002
BLEWBUMP DS    0H                                                       28700002
         LR    R4,R5         GET ADDRESS OF NEXT TCB                    28750002
         B     BLEWDAU       GO CHECK IT                                28800002
         SPACE                                                          28850002
RUNEND   DS    0H                                                       28900002
         O     R2,HIBITON    MAKE R2 NEGATIVE TO INDICATE BAD ERROR     28950002
         LA    R3,MSG10      PUT MSG ID IN R3                           29000002
         B     MSGRTN        GO WRITE MESSAGE                           29050002
         DROP  R4            R4 NO LONGER NEEDED FOR TCB ADDRESSES      29100002
         EJECT                                                          29150002
*********************************************************************** 29200002
*                                                                     * 29250002
*        CALL PROCESSING STARTS HERE                                  * 29300002
*                                                                     * 29350002
*********************************************************************** 29400002
IKJEGCAL DS    0D            CALL COMMAND OF TEST                       29450002
         SAVE  (14,12),,IKJEGCAL                                        29500002
         L     R12,BASECON-IKJEGCAL(R15)  SETUP BASE REG.               29550002
         LA    R5,CALSPL     R5=ADDR OF ESTAE PARM LIST                 29560002
         BAL   R10,SETUP     FINISH ENTRY LINKAGE, ISSUE STAE, AND      29600002
*                            POINT R6 TO GO'S WORKAREA                  29650002
         MVI   CMDCODE,CALLCODE SAVE RETURN CODE FROM CALL (SAME AS GO) 29700002
         LA    R2,EIGHT      CALL CODE FOR PARSE VALIDITY EXIT.         29750002
         SPACE                                                          29800002
*********************************************************************** 29850002
** BUILD PARAMETER LIST AND PARSE THE CALL COMMAND.                  ** 29900002
*********************************************************************** 29950002
         L     R4,CALLCON    REG 4 CONTAINS ADDRESS OF CALL'S PARAMETER 30000002
*                            CONTROL LIST                               30050002
         BAL   R10,PARSBILD  BUILD PARM LIST AND PARSE INPUT            30100002
         L     R8,TSTANSPL   REG 8 CONTAINS THE PDL ADDR                30150002
         USING CALLDUMM,R8   ESTABLISH ADDRESSABILITY FOR PDL           30200002
         SPACE                                                          30250002
*********************************************************************** 30300002
** MOVE PROBLEM PROGRAMS REGISTERS INTO WORKING STORAGE IN ORDER TO  ** 30350002
** MAKE THE REQUESTED CHANGES WITH A SINGLE ISSUANCE OF TEST'S SVC.  ** 30400002
*********************************************************************** 30450002
         SPACE                                                          30500002
         L     R5,PPTCB      REG 5 CONTAINS THE ADDR OF THE PROBLEM     30550002
*                            PROGRAM TASK CONTROL BLOCK (TCB)           30600002
         USING TCB,R5        ESTABLISH TCB ADDRESSABILITY               30650002
         L     R4,TCBRBP     REG 4 CONTAINS THE ADDR OF SVC'S SVRB      30700002
         DROP  R5            RELEASE REG 5 FOR FUTURE USE.              30750002
         MVC   PPRSAVE,RBGRSAVE-RBSECT(R4) MOVE PROBLEM PROGRAM'S       30800002
*                            REGISTERS INTO COMMAND'S WORKAREA          30850002
         SPACE                                                          30900002
*********************************************************************** 30950002
**       INITIALIZE COUNTER FOR PARMLIST GETMAIN, CHECK FOR          ** 31000002
**       PARM KEYWORD.                                               ** 31050002
*********************************************************************** 31100002
         LA    R4,L12        REG 4 IS AN ACCUMULATOR-HERE IS SET FOR    31150002
*                            MINIMUM LENGTH FOR PARMLIST, ONE           31200002
*                            ADDRESS AND 2 CONTROL WORDS.               31250002
         TM    PARM+D1,HEXOF WAS PARM SPECIFIED IN CALL COMMAND         31300002
         BZ    BLDLST        NO, BUILD A NULL PARAMETER LIST            31350002
         LA    R7,PARMADDR   YES, GET ADDR OF FIRST PARM ADDRESS PDE    31400002
         SPACE                                                          31450002
*********************************************************************** 31500002
** THIS CODE DETERMINES THE SIZE OF THE AREA FOR THE PARAMETER LIST  ** 31550002
** THAT IS TO BE BUILT.                                              ** 31600002
*********************************************************************** 31650002
LOOP3    DS    0H            EXAMINE PARM CHAIN                         31700002
         L     R7,PDECHAIN   OBTAIN THE ADDR OF THE NEXT ADDRESS PDE    31750002
         LA    R7,D0(R7)     CLEAR HIGH ORDER BYTE                      31800002
         LTR   R7,R7         IS THERE ANOTHER ADDRESS PDE               31850002
         BZ    BLDLST        NO, ISSUE GETMAIN AND BUILD PARMLIST       31900002
         LA    R4,D4(R4)     YES, BUMP ACCUMULATOR FOR ONE MORE ADDRESS 31950002
         B     LOOP3         GO FIND NEXT ADDR PDE IF ONE EXISTS        32000002
         SPACE                                                          32050002
*********************************************************************** 32100002
*        USE CALCULATED LENGTH TO ISSUE GETMAIN FOR PARMLIST          * 32150002
*********************************************************************** 32200002
SMTGET01 DS    0H            SMT LABEL FOR TEST CASE TGO01500           32250002
BLDLST   DS    0H            OBTAIN CORE FOR PARAMETER LIST             32300002
         LR    R0,R4         PUT LENGTH OF GETMAIN INTO REGISTER 0      32350002
         GETMAIN RC,LV=(0),SP=1   ISSUE GETMAIN FOR STORAGE             32450002
BLOW1    EQU   *             ABEND TABLE ENTRY                          32452002
         LTR   R15,R15       WAS GET MAIN SUCCESSFUL                    32460002
         BZ    GETMOK        YES CONTINUE                               32470002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        32480002
* ISSUE 'GETMAIN SVC ERROR' MESSAGE                                     32490002
         IKJEGSIO SVCERR,SVC=10,RC=(R15),ID=GO014,MF=(E,TSTIOPRM)       32492002
         C     R15,ATTNRC    IS ATTENTION IN EFFECT?                    32492402
         BE    ATTNEXIT      YES,SEND RC=16 TO MAINLINE                 32492802
         C     R15,ESTAERC   DID IO FAIL ON ESTAE?                      32493202
         BE    EXIT24        YES,SEND RC=24 TO MAINLINE                 32493602
         B     MSGRTNA       GO ISSUE MESSAGE                  XXXXXXXX 32496002
         SPACE                                                          32500002
*********************************************************************** 32550002
*        CHAIN ADDRESS OF PARMLIST OFF CALLPARM FIELD IN TCOMTAB      * 32600002
*********************************************************************** 32650002
GETMOK   DS    0H                                                       32700002
         LA    R3,CALLPARM   GET ADDRESS OF BEGINNING OF PARAMETER LIST 32750002
*                            CHAINED FROM A WORD IN TCOMTAB             32800002
         SPACE                                                          32850002
LOOP4    DS    0H            CHECK FOR MORE PARAMETER LISTS             32900002
         OC    D1(L3,R3),D1(R3) ANY MORE PARAMETER LISTS AROUND         32950002
         BZ    ADDL          NO, GO ADD NEW LIST TO THE CHAIN           33000002
         L     R3,D0(R3)     YES, GET ADDRESS OF NEXT PARAMETER LIST    33050002
         B     LOOP4         GO SEE IF IT IS LAST ON CHAIN              33100002
         SPACE                                                          33150002
ADDL     DS    0H            ADD NEW PARAMETER LIST TO CHAIN IN TCOMTAB 33200002
         ST    R1,D0(R3)     PUT ADDR OF NEW LIST INTO FIRST WORD OF    33250002
*                            LAST ENTRY OF CHAIN                        33300002
         SPACE                                                          33350002
*********************************************************************** 33400002
*        FINISH INITIALIZATION OF PARMLIST. CHECK FOR PARM KEYWORD.   * 33450002
*        IF NO PARM, DUMMY IS PASSED. SET PP R1 TO POINT TO           * 33500002
*        ADDRESSES IN PARM LIST.                                      * 33550002
*********************************************************************** 33600002
         XC    D0(L8,R1),D0(R1)   ZERO FIRST EIGHT BYTES                33650002
*                            OF PARAMETER BUFFER                        33700002
         STH   R4,D4(R1)     PLACE LENGTH OF NEW LIST INTO THE LENGTH   33750002
*                            FIELD OF NEW ENTRY ON CHAIN                33800002
         LA    R1,D6(R1)     POINT TO HALFWORD OF ZEROS                 33850002
         ST    R1,D2(R1)     STORE ADDRESS OF HALFWORD OF               33900002
*                            ZEROS FOR DUMMY PARM LIST                  33950002
         LA    R1,L2(R1)     POINT TO BEGINNING OF ACTUAL               34000002
*                            PARAMETER ADDRESS LIST                     34050002
         ST    R1,PPREG1     REPLACE PP REG 1 CONTENTS                  34100002
         TM    PARM+D1,HEXOF WAS PARM SPECIFIED                         34150002
         BZ    VARLIST       NO - CHECK FOR VL KEYWORD                  34200002
         SPACE                                                          34250002
*********************************************************************** 34300002
** BUILD PARAMETER LIST FROM ADDRESS PDE USER FIELDS                 ** 34350002
*********************************************************************** 34400002
PARMSET  DS    0H                                                       34450002
         LA    R7,PARMADDR   REG 7 CONTAINS ADDR OF FIRST PARAMETER     34500002
*                            ADDRESS PDE                                34550002
         SPACE                                                          34600002
LOOP5    DS    0H            SET UP PARAMETER                           34650002
         L     R5,PDEUSER    PUT PARM ADDRESS IN R5                     34700002
         LA    R5,D0(R5)     ZERO HIGH ORDER BYTE OF ADDRESS            34750002
         ST    R5,D0(R1)     PUT ADDRESS IN PARM LIST                   34800002
         L     R7,PDECHAIN   REG 7 POINTS TO NEXT ADDRESS PDE           34850002
         LA    R7,D0(R7)     CLEAR HIGH ORDER BYTE                      34900002
         LTR   R7,R7         WERE THERE ANY MORE PDES                   34950002
         BZ    VARLIST       NO, CHECK IF LIST IS VARIABLE LENGTH       35000002
         LA    R1,D4(R1)     YES, BUMP LIST POINTER                     35050002
         B     LOOP5         AND GO MOVE NEXT ADDR INTO NEW LIST        35100002
         SPACE                                                          35150002
*********************************************************************** 35200002
*        IF VL WAS SPECIFIED, TURN ON HIGH-ORDER BIT OF LAST          * 35250002
*        ADDRESS IN PARM LIST.                                        * 35300002
*********************************************************************** 35350002
VARLIST  DS    0H            CHECK FOR 'VL' SPECIFIED                   35400002
         TM    VLIST+D1,HEXOF  WAS 'VL' SPECIFIED                       35450002
         BZ    RETNCHK       NO, GO CHECK FOR RETURN KEYWORD            35500002
         OI    D0(R1),HIGHBIT YES, FLAG HIGH ORDER BYTE OF LAST         35550002
*                            ELEMENT OF LIST WITH A X'80'               35600002
         SPACE                                                          35650002
*********************************************************************** 35700002
*        IF THE RETURN KEYWORD IS SPECIFIED, SET THE CONTENTS         * 35750002
*        OF PP REG 14  TO THE SPECIFIED ADDRESS. OTHERWISE, POINT     * 35800002
*        PP REG 14 TO A BREAK SVC IN TCOMTAB.                    *      35850002
*********************************************************************** 35900002
RETNCHK  DS    0H                                                       35950002
         TM    RETKEY+D1,HEXOF WAS 'RETURN' SPECIFIED                   36000002
         BZ    BREAKIT       NO, SET REG 14 FOR BREAK                   36050002
         LA    R7,RETADDR    REG 7 CONTAINS ADDRESS OF RETURN ADDR PDE  36100002
         MVC   PPREG14,PDEUSER MOVE ADDR INTO REG 14                    36150002
         B     ZAPREGS       RESET ALL PP REGS                          36200002
         SPACE                                                          36250002
BREAKIT  DS    0H            SET REG 14                                 36300002
         LA    R7,PPEXIT     REG 7 CONTAINS ADDR OF BREAK SVC           36350002
         ST    R7,PPREG14    RESET REGISTER 14 WITH THIS ADDRESS        36400002
         SPACE                                                          36450002
*********************************************************************** 36500002
*        SET PP REG 15 TO ADDRESS SPECIFIED BY USER. PUT ALTERED      * 36550002
*        PP REGS BACK IN SVRB.                                        * 36600002
*********************************************************************** 36650002
ZAPREGS  DS    0H            RESTORE ALL PP REGS, PICKING UP CHANGES    36700002
         SPACE                                                          36750002
         LA    R7,BRADDR     REG 7 CONTAINS ADDR OF BRANCH ADDR PDE     36800002
         L     R5,PDEUSER    REG 5 CONTAINS THE BRANCH ADDRESS          36850002
         ST    R5,PPREG15    PLACE ENTRY ADDR IN PP R15.                36900002
         L     R3,PPTCB      REG 3 CONTAINS TCB PTR FOR TEST SVC        36950002
         IKJEGS9G AGPR,TCBADDR=(R3),VALUE=PPRSAVE,MF=(E,SVCPARMS)      *37000002
                             RESTORE PP'S ALTERRED REGISTERS            37050002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   37100002
         BNZ   CALSVCMS      NO, GO ISSUE ERROR MESSAGE AND QUIT        37150002
         SPACE                                                          37200002
*********************************************************************** 37250002
**HAVING SET ADDRESS AT WHICH PROBLEM PROGRAM IS TO RESUME EXECUTION**  37300002
**IN REGISTER 5 AND A 'GO' RETURN CODE IN REGISTER 11, ENTER 'GO'   **  37350002
**LOGIC TO EFFECT RESET OF RIGHT-HALF PP RBOPSW AND RETURN TO       **  37400002
**IKJEGMNL.                                                          ** 37450002
*********************************************************************** 37500002
         SPACE                                                          37550002
         B     SETWAIT       ENTER 'GO' LOGIC                           37600002
         EJECT                                                          37650002
*********************************************************************** 37700002
*                                                                     * 37750002
*        THIS IS THE ADDRESS VALIDITY CHECK ROUTINE FOR GO,           * 37800002
*        CALL, AND RUN.                                               * 37850002
*                                                                     * 37900002
*********************************************************************** 37950002
ADDRCHK  DS    0H                                                       38000002
         SAVE  (14,12),,ADDRCHK                                         38050002
         L     R12,BASECON-ADDRCHK(R15)   SETUP BASE REG.               38100002
         L     R7,D0(R1)     REG 7 CONTAINS ADDRESS OF ADDRESS PDE      38150002
         L     R9,D4(R1)     REG 9 CONTAINS ADDRESS OF TCOMTAB          38200002
         LA    R8,D8(R1)     SAVE ADDRESS OF THIRD WORD IN LIST         38250002
         L     R4,REGSAVE3   REG 4 CONTAINS NEW SAVEAREA ADDRESS        38300002
         ST    R13,SAVELAST-SAVEAREA(R4) STORE BACK POINTER.            38350002
         ST    R4,SAVENEXT-SAVEAREA(R13) STORE FORWARD POINTER.         38400002
         LR    R13,R4        SET NEW SAVE ADDR IN REG 13                38450002
         SPACE                                                          38500002
*********************************************************************** 38550002
*        CHECK FOR INVALID ADDRESS TYPE. IF INVALID, ISSUE            * 38600002
*        ERROR MESSAGE.                                               * 38650002
*********************************************************************** 38700002
         OI    TSTFLGS4,TSTVALCK TURN ON VALIDITY CHECK BIT    XXXXXXXX 38701002
         OC    PDEINDCT,PDEINDCT WAS INDIRECT ADDRESSING SPECIFIED      38750002
         BNZ   CONVERT       YES, VALID STORAGE ADDR, CONVERT IT        38800002
         TM    PDEFLG4,GENR+LFPR+SFPR WAS REG TYPE ADDRESSING USED      38850002
         BNZ   BUMRTURN      YES, INVALID ADDR, REQUEST MSG & PROMPT    38900002
         SPACE                                                          38950002
*********************************************************************** 39000002
*        CONVERT THE ADDRESS TO BINARY USING IKJEGCVT.                * 39050002
*********************************************************************** 39100002
CONVERT  DS    0H                                                       39150002
         SPACE                                                          39200002
         L     R1,OUTBUF     R1=ADDR OF OUTPUT BUFFER                   39210002
         XC    D0(L4,R1),D0(R1) ZERO OUT FIRST WORD OF OUT BUFFER       39220002
         LR    R1,R7         REG 1 CONTAINS ADDR OF ADDRESS PDE         39250002
         LCR   R1,R1         NEGATIVE FOR ADDR CONVERSION               39300002
         SR    R0,R0         REG 0 IS POSITIVE TO INDICATE BINARY       39350002
*                            CONVERSION                                 39400002
         L     R15,TSTCONVT  REG 15 CONTAINS ADDR OF IKJEGCVT ENTRY PT  39450002
         BALR  R14,R15       ATTEMPT TO CONVERT THE ADDRESS             39500002
         B     RETAB(R15)    BRANCH THROUGH FOLLOWING TABLE INDEXED     39550002
*                            BY CONTENTS IN REGISTER 15                 39600002
RETAB    DS    0H                                                       39650002
         B     RET0          0-CONTINUE PROCESSING                      39700002
         B     SETMSG        4-IKJEGCVT CODE-RETURN TO IKJPARS          39750002
         B     SETMSG2       8-IKJEGSYM CODE-RETURN TO IKJPARS          39800002
         B     SETMSG2       12-IO ERROR-RETURN TO IKJPARS              39850002
         B     RETURN12      16-ATTENTION INTERRUPT-RETURN TO PARSE     39900002
         B     RETURN12      20-IKJEGCVT OR IKJEGSYM BLEW               39950002
         B     RETURN12      24-ESTAE ERROR                             39960002
         SPACE                                                          40000002
*********************************************************************** 40050002
**THIS CODE PASSES THE ADDRESS OF A SECOND LEVEL MESSAGE FROM        ** 40100002
**IKJEGCVT OR IKJEGSYM BACK TO IKJPARS.  THE ADDRESS IS PICKED UP IN ** 40150002
**THE PDEUSER WORD AND PLACED IN THE THIRD WORD OF THE PARAMETER LIST** 40200002
**PASSED BY IKJPARS.  IF NO SECOND LEVEL EXISTS THE PDEUSER WORD WILL** 40250002
**CONTAIN X'FF000000'. CVT RETURN CODE WAS 4 - UNABLE TO CONVERT.    ** 40300002
*********************************************************************** 40350002
SETMSG   DS    0H                                                       40400002
         L     R1,OUTBUF     R1=ADDR OF OUTBUF                          40450002
         SR    R0,R0         R0=0                                       40500002
         C     R0,D0(R1)     IS FIRST WORD OF OUTBUF ZERO?              40510002
         BE    RETURN8       YES, NO SECOND LEVEL MESSAGE TO PASS       40520002
         MVC   D0(L4,R8),OUTBUF MOVE ADDR OF SECOND LEVEL MESSAGE       40530002
*                               INTO PARSE PARAMETER LIST               40540002
RETURN8  DS    0H                                                       40550002
         LA    R15,EIGHT     SET RETURN CODE TO IKJPARS TO 8            40600002
         B     CHKRTURN      GO SET UP TO RETURN TO IKJPARS             40650002
         SPACE                                                          40700002
*********************************************************************** 40750002
*        SAME AS ABOVE, BUT CVT RETURN CODE 8 - EITHER SYM ERROR      * 40800002
*        OR I/O ERROR.                                                * 40850002
*********************************************************************** 40900002
SETMSG2  DS    0H                                                       40950002
         L     R1,OUTBUF     R1=ADDR OF OUTBUF                          41000002
         SR    R0,R0         R0=0                                       41050002
         C     R0,D0(R1)     IS FIRST WORD OF OUTBUF ZERO?              41060002
         BE    RETURN12      YES, NO SECOND LEVEL MESSAGE TO PASS       41070002
         MVC   D0(L4,R8),OUTBUF MOVE ADDR OF SECOND LEVEL MESSAGE       41080002
*                               INTO PARSE PARAMETER LIST               41090002
         SPACE                                                          41100002
*********************************************************************** 41150002
*        SET RETURN CODE TO PARSE TO 12 TO INDICATE THAT PARSE IS     * 41200002
*        TO RETURN TO GO WITH A RETURN CODE OF 20. SAVE IKJEGCVT      * 41250002
*        RETURN CODE IN REGSAVE FIELD OF GO'S WORKAREA.               * 41300002
*********************************************************************** 41350002
RETURN12 DS    0H                                                       41400002
         L     R6,WORKAREA   LOAD ADDR OF WORKAREA                      41450002
RETRN12  DS    0H                                                       41500002
         OI    TSTFLGS4,TSTFLUSH  TURN ON TSTFLUSH SO MNL WILL          41510002
*                            FLUSH INPUT STACK                          41520002
         ST    R15,REGSAVE   SAVE RETURN CODE FOR LATER USE             41550002
         LA    R15,TWELVE    SET RETURN CODE FOR IKJPARS                41600002
         B     CHKRTURN      GO RETURN TO IKJPARS                       41650002
         SPACE                                                          41700002
*********************************************************************** 41750002
*        CVT RETURN CODE WAS 0, ADDRESS HAS BEEN CONVERTED.           * 41800002
*        IF HIGH ORDER BIT OF PDEUSER FIELD IS ON, PDEUSER POINTS     * 41850002
*        TO THE CONVERTED ADDRESS WORD. OTHERWISE, PDEUSER            * 41900002
*        CONTAINS THE CONVERTED ADDRESS.                              * 41950002
*********************************************************************** 42000002
RET0     DS    0H                                                       42050002
         TM    PDEUSER,PDESIB IS ADDRESS IN SYM INFO BLOCK              42100002
         BZ    SET0          NO, LEAVE PDEUSER FIELD ALONE              42150002
         L     R1,PDEUSER    YES, REG 1 CONTAINS ADDR OF SYM INFO       42200002
*                            BLOCK                                      42250002
         MVC   PDEUSER,D0(R1) MOVE ACTUAL ADDRESS INTO PDEUSER.         42300002
         SPACE                                                          42350002
*********************************************************************** 42400002
*        TURN ON FLAG IN PDEUSER FIELD TO INDICATE ADDRESS            * 42450002
*        ADDRESS HAS BEEN CONVERTED.                                  * 42500002
*********************************************************************** 42550002
SET0     DS    0H                                                       42600002
         MVI   PDEUSER,PDECONVD  TURN ON FLAG IN PDE TO INDICATE        42650002
*                            ADDRESS IS CONVERTED                       42700002
         XR    R15,R15       INDICATE VALID PARAMETER TO IKJPARS        42750002
         SPACE                                                          42800002
*********************************************************************** 42850002
*        RETURN TO PARSE.                                             * 42900002
*********************************************************************** 42950002
CHKRTURN DS    0H                                                       43000002
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK BIT      43010002
         L     R13,SAVELAST-SAVEAREA(R13) RESET REGISTER 13             43050002
*                            TO RETURN TO IKJPARS                       43100002
         RETURN (14,12),RC=(15) RETURN TO IKJPARS                       43150002
         SPACE 3                                                        43200002
*********************************************************************** 43250002
** INFORM USER ADDRESS IS INCORRECTLY SPECIFIED.                     ** 43300002
*********************************************************************** 43350002
BUMRTURN DS    0H                                                       43400002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        43450002
* ISSUE 'INVALID ADDRESS' MESSAGE                                       43500002
* ISSUE 'REG.NOTATION MUST BE INDIRECT GEN.REG.' MESSAGE                43550002
         IKJEGSIO MSG,FIRST=M0101,INST11=(APDE,(R7)),SECOND=M0274,     *43600002
               ID=GO014,MF=(E,TSTIOPRM)                                 43650002
         LTR   R15,R15       RETURN FROM IO A ZERO                      45150002
         BZ    SETMSG        YES, MESSAGE WAS WRITTEN-RETURN            45200002
         B     RETRN12       NO,MSG MAY NOT HAVE BEEN WRITTEN-RETURN    45250002
         EJECT                                                          45600002
*********************************************************************** 45650002
*        THIS SUBROUTINE BUILDS A STANDARD PARSE PARAMETER LIST       * 45700002
*        AND LINKS TO PARSE. IT IS ENTERED BY A BAL 10,PARSBILD.      * 45750002
*        THE PCL ADDRESS TO BE USED IS PASSED IN REG 4. REGS 1 AND    * 45800002
*        5 ARE CLOBBERED.                                             * 45850002
*********************************************************************** 45900002
PARSBILD DS    0H                                                       45950002
         LA    R1,PPLAREA    REGISTER 1 CONTAINS ADDR OF PPL AREA       46000002
         USING PPL,R1        ESTABLISH ADDRESSABILITY TO PARSE          46050002
*                            PARAMETER LIST                             46100002
         MVC   PPLUPT,TSTUPT PUT ADDR UPT INTO PARAMETER LIST           46150002
         MVC   PPLECT,TSTECT PUT ADDR ECT INTO PARAMETER LIST           46200002
         MVC   PPLECB,TSTCPECB PUT ADDR ECB INTO PARAMETER LIST         46250002
         ST    R4,PPLPCL     PUT ADDR OF PCL INTO PARAMETER LIST        46300002
         LA    R5,TSTANSPL   PUT POINTER TO ANSWER PLACE INTO           46350002
         ST    R5,PPLANS     PARAMETER LIST TO IKJPARS                  46400002
         MVC   PPLCBUF,INBUF PUT ADDRESS OF COMMAND BUFFER INTO         46450002
*                            PARAMETER LIST FOR PARSE                   46500002
         ST    R9,PPLUWA     PUT ADDRESS OF TCOMTAB INTO LIST           46550002
         DROP  R1            DROP ADDRESSABILITY TO PARSE PARAMETER     46600002
*                            LIST                                       46650002
         LINK  EP=IKJPARS,ERRET=PARSERR    PARSE THE COMMAND.           46700002
PARSBLOW DS    0H            LABEL USED BY STAE RETRY ROUTINE           46750002
SMTPARS  DS    0H            SMT LABEL FOR TEST CASES TGO01500 AND      46800002
*                            TCAL2800                                   46850002
         B     PARSTAB(R15)  GO HANDLE RETURN CODE FROM IKJPARS         46900002
PARSTAB  DS    0H                                                       46950002
         B     CODE0         0-CONTINUE PROCESSING                      47000002
         B     FLUSHIT       4-GO BACK TO IKJEGMNL                      47050002
         B     ATTNEXIT      8-ATTENTION ENCOUNTERED-EXIT               47100002
         B     CODE12        12-GO WRITE PROPER MESSAGE                 47150002
         B     CODE16        16-GO WRITE PROPER MESSAGE                 47200002
         B     CHKRET        20-RETURN TO IKJEGMNL                      47250002
         SPACE                                                          47300002
*********************************************************************** 47350002
*        PARSE OK, RETURN TO CALLER                                   * 47400002
*********************************************************************** 47450002
CODE0    DS    0H                                                       47500002
         BR    R10           GO BACK TO CALLING ROUTINE                 47550002
         SPACE                                                          47600002
*********************************************************************** 47650002
** PARSE RETURN CODE WAS 12, INDICATING INVALID PARMS SENT TO PARSE. ** 47700002
** REGISTER 2 CONTAINS A CODE INDICATING WHICH ROUTINE USED IKJPARS. ** 47750002
** THE FOLLOWING BRANCH TABLE IS USED TO FIND THE APPROPRIATE MESSAGE** 47800002
*********************************************************************** 47850002
CODE12   DS    0H                                                       47900002
         B     MSGTAB2(R2)   GO TO PROPER ROUTINE                       47950002
MSGTAB2  DS    0H                                                       48000002
         NOP   MSGTAB2       NO FUNCTION EXISTS                         48050002
         B     GOMSG2        4-CODE FOR GO                              48100002
         B     CALLMSG2      8-CODE FOR CALL                            48150002
         B     RUNMSG2       12-CODE FOR RUN                            48200002
         SPACE                                                          48250002
GOMSG2   DS    0H                                                       48300002
         LA    R3,MSG1       INDICATE MESSAGE NUMBER                    48350002
         B     MSGRTN        GO TO MESSAGE ROUTINE                      48400002
         SPACE                                                          48450002
CALLMSG2 DS    0H                                                       48500002
         LA    R3,MSG5       INDICATE MESSAGE NUMBER                    48550002
         B     MSGRTN        GO TO MESSAGE ROUTINE                      48600002
         SPACE                                                          48650002
RUNMSG2  DS    0H                                                       48700002
         LA    R3,MSG4       INDICATE MESSAGE NUMBER                    48750002
         B     MSGRTN        GO TO MESSAGE ROUTINE                      48800002
         SPACE                                                          48850002
*********************************************************************** 48900002
*        PARSE RETURN CODE 16 - NOT ENOUGH MAIN STORAGE FOR PDL       * 48950002
*        ISSUE MESSAGE.                                               * 49000002
*********************************************************************** 49050002
CODE16   DS    0H                                                       49100002
         B     MSGRTNA       GO TO MESSAGE ROUTINE             XXXXXXXX 49200002
         EJECT                                                          49250002
*********************************************************************** 49300002
*                                                                     * 49350002
*                   ESTAE EXIT ROUTINE                                * 49400002
*                                                                     * 49450002
*********************************************************************** 49500002
STAERTN  DS    0H                                                       49550002
         SPACE                                                          49600002
*********************************************************************** 49650002
*        GET ADDRESS OF TCOMTAB                                       * 49700002
*********************************************************************** 49750002
         L     R2,CVTPTR     GET CVT ADDRESS                            49800002
         USING CVT,R2        ESTABLISH ADDRESSABILITY TO CVT            49850002
         L     R2,CVTTCBP    GET ADDRESS OF TCB WORDS                   49900002
         L     R2,D4(R2)     GET ADDRESS OF CURRENT TCB                 49950002
         DROP  R2            DROP ADDRESSABILITY TO CVT                 50000002
         USING TCB,R2        ESTABLISH ADDRESSABILITY TO TCB            50050002
         L     R9,TCBTRN     PICK UP POINTER TO TCOMTAB FROM            50100002
*                            TCBTRN FIELD OF TEST'S TCB                 50150002
         SPACE                                                          50200002
*********************************************************************** 50250002
*        RESTORE GO'S REGISTERS 13 AND 12 (12 IS BASE).               * 50300002
*********************************************************************** 50350002
         L     R13,REGSAVE2  GET ADDR OF GO, CALL, RUN REGISTERS        50400002
         L     R12,GR12-SAVEAREA(R13)  RESET ADDRESSABILITY             50450002
         SPACE                                                          50500002
*********************************************************************** 50900002
*        SET RETURN CODE TO MAINLINE TO INDICATE THAT ESTAE           * 50950002
*        EXIT ROUTINE WAS ENTERED.                                    * 51000002
*********************************************************************** 51050002
NOWORK   DS    0H                                                       51100002
         LA    R15,RETCOD20  SET RETURN CODE FOR IKJEGMNL INDICATING    51150002
*                            ESTAE EXIT ROUTINE ENTERED                 51200002
         B     RETURN        GO SET UP TO RETURN TO IKJEGMNL            51250002
         EJECT                                                          51300002
*********************************************************************** 51350002
*  THIS IS THE MESSAGE WRITING ROUTINE.                                 51400002
*  AT ENTRY R3 CONTAINS THE ADDRESS OF A THREE WORD PARAMETER LIST.     51450002
*    WORD1=MESSAGE NUMBER OF FIRST LEVEL MESSAGE                        51500002
*    WORD2=MESSAGE NUMBER OF SECOND LEVEL MESSAGE                       51550002
*    WORD3=INSERT NUMBER TO BE INSERTED IN FIRST LEVEL MESSAGE          51600002
*          WORD3 WILL BE ZERO OF THERE IS NO INSERT                     51650002
*********************************************************************** 51700002
MSGRTN   DS    0H                                                       51750002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        51800002
         STM   R2,R4,SAVE234 SAVE R2-R4 FOR REUSE                       51900002
         LM    R2,R4,D0(R3)  LOAD R2-R4 WITH PARM LIST VALUES           51950002
* ISSUE FIRST AND SECOND LEVEL MESSAGES                                 52000002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(NUM,(R4)),        *52050002
               ID=GO014,MF=(E,TSTIOPRM)                                 52060002
         LM    R2,R4,SAVE234 RESET R2-R4                       XXXXXXXX 52061002
MSGRTN1  DS    0H                                              XXXXXXXX 52062002
         OI    TSTFLGS4,TSTFLUSH  TURN ON TSTFLUSH SO MNL WILL          52100002
*                            FLUSH INPUT STACK                          52120002
         B     RCTABLE(R15)  INDEX THROUGH RETURN CODE BRANCH TABLE     52130002
RCTABLE  DS    0H                                                       52140002
         B     CKCRIT        RC=0 NORMAL CONTINUE                       52150002
         B     CKCRIT        RC=4 IO ERROR TRY TO CONTINUE              52160002
         B     CKCRIT        RC=8 SHOULD NEVER HAPPEN                   52164002
         B     CKCRIT        RC=12 IO ERROR TRY TO CONTINUE             52166002
         B     ATTNEXIT      RC=16 ATTENION HIT,EXIT                    52168002
         B     CKCRIT        RC=20 IO ABEND TRY TO CONTINUE             52168402
         B     EXIT24        RC=24 ESTAE ERROR,EXIT                     52168802
CKCRIT   DS    0H            CHECK FOR CRITICAL ERROR                   52170002
         LTR   R2,R2         IS THIS A CRITICAL RUN ERROR?              52300002
         BNL   EXIT0         NO, GO BACK WITH RETURN CODE 0             52350002
         B     EXIT          RETURN TO MAINLINE WITH RETURN CODE 12     52400002
*                            BUT WITH RUNSW OFF TO CLEAN UP             52430002
*                            AND GET OUT OF TEST                        52460002
MSGRTNA  DS    0H                                              XXXXXXXX 52461002
* ISSUE 'NOT ENOUGH MAIN STORAGE' MESSAGE                      XXXXXXXX 52461202
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LST XXXXXXXX 52462002
         IKJEGSIO MSG,FIRST=M0103,ID=GO014,MF=(E,TSTIOPRM)     XXXXXXXX 52463002
         B     MSGRTN1       GO CHECK RETURN CODES             XXXXXXXX 52464002
         EJECT                                                          52500002
*********************************************************************** 52550002
*        A NONZERO RETURN CODE WAS RETURNED BY SVC 97. DETERMINE      * 52600002
*        WHICH COMMAND WAS ISSUED, AND ISSUE APPROPRIATE MESSAGE.     * 52650002
*********************************************************************** 52700002
         SPACE                                                          52750002
SVCERR   DS    0H                                                       52800002
         B     SVCTAB(R2)    BRANCH ON R2 INTO TABLE                    52850002
         SPACE                                                          52900002
SVCTAB   DS    0H                                                       52950002
         NOP   SVCTAB        THIS BRANCH IMPOSSIBLE                     53000002
         B     GOSVCMSG      ISSUE GO MESSAGE                           53050002
         B     CALSVCMS      ISSUE CALL MESSAGE                         53100002
         B     RUNSVCMS      ISSUE RUN MESSAGE                          53150002
         SPACE                                                          53200002
GOSVCMSG DS    0H                                                       53250002
         LA    R3,MSG7       PUT MSG ID IN R3                           53300002
         B     MSGRTN        GO WRITE MSG                               53350002
         SPACE                                                          53400002
CALSVCMS DS    0H                                                       53450002
         LA    R3,MSG8       PUT MSGID IN R3                            53500002
         B     MSGRTN        GO WRITE MSG                               53550002
         SPACE                                                          53600002
RUNSVCMS DS    0H                                                       53650002
         LA    R3,MSG9       PUT MSGID IN R3                            53700002
         B     MSGRTN        GO WRITE MSG                               53750002
         EJECT                                                          53800002
*********************************************************************** 53810002
*     ROUTINES TO HANDLE ERRET EXITS FROM LINK AND LOAD MACROS          53812002
*********************************************************************** 53814002
PARSERR  EQU   *                                                        53820002
* ISSUE 'LINK TO IKJPARS SVC ERROR' MESSAGE                             53820402
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         53822002
         LR    R0,R1         LOAD ABEND CODE INTO R0                    53822402
         IKJEGSIO SVCERR,SVC=6,RC=(R15),ABENDRG=(R0),                  *53824002
               INST11=(NUM,I0040),ID=GO014,MF=(E,TSTIOPRM)              53826002
         C     R15,ATTNRC    IS RC=16,20 OR 24?                         53828002
         BL    NOWORK        NO, SEND RC=20 TO MAINLINE                 53828402
         B     RETURN        SEND 16,20 OR 24 RC TO MAINLINE            53828802
         EJECT                                                          53830002
*********************************************************************** 53850002
*        THESE ARE THE PARSE MACROS FOR GO, RUN, AND CALL.            * 53900002
*********************************************************************** 53950002
IKJEGPAR IKJPARM DSECT=GORUNDUM    GO AND RUN MACROS                    54000002
ADDR     IKJPOSIT ADDRESS,VALIDCK=ADDRCHK                               54050002
         IKJENDP                                                        54100002
         SPACE                                                          54150002
IKJEGPAS IKJPARM DSECT=CALLDUMM    CALL MACROS                          54200002
BRADDR   IKJPOSIT ADDRESS,PROMPT='BRANCH ADDRESS',VALIDCK=ADDRCHK       54250002
PARM     IKJKEYWD                                                       54300002
         IKJNAME  'PARM',SUBFLD=PARMSFLD                                54350002
VLIST    IKJKEYWD                                                       54400002
         IKJNAME 'VL'                                                   54450002
RETKEY   IKJKEYWD                                                       54500002
         IKJNAME 'RETURN',SUBFLD=RETSFLD                                54550002
PARMSFLD IKJSUBF                                                        54600002
PARMADDR IKJPOSIT ADDRESS,LIST,VALIDCK=ADDRCHK,PROMPT='PARAMETER ADDRESX54650002
               S(ES)'                                                   54700002
RETSFLD  IKJSUBF                                                        54750002
RETADDR  IKJPOSIT ADDRESS,VALIDCK=ADDRCHK,PROMPT='RETURN ADDRESS'       54800002
         IKJENDP                                                        54850002
         EJECT                                                          54900002
*********************************************************************** 54950002
*                           CONSTANTS                                 * 55000002
*********************************************************************** 55050002
         SPACE                                                          55100002
         DS    0F             ALIGN SP1 TO WORD BOUNDARY                55150002
HIBITON  DC    X'80000000'   WORD WITH HI BIT ON TO MAKE R2 NEGATIVE    55200002
GOCON    DC    V(IKJEGPAR)    ADDRESS OF GO/RUN PCL                     55300002
CALLCON  DC    V(IKJEGPAS)    ADDRESS OF CALL PCL                       55350002
BASECON  DC    A(IKJEGGO)     PROGRAM BASE ADDRESS                      55400002
ATTNRC   DC    F'16'         ATTENTION RETURN CODE                      55450002
ESTAERC  DC    F'24'         ESTAE FAILURE RETURN CODE                  55500002
         SPACE                                                          55550002
**  THE FOLLOWING IS THE ESTAE MESSAGE TABLE                         ** 55600002
         SPACE                                                          55650002
STATBL   DS    0F                                                       55700002
         DC    AL1(92),AL3(BLOW1)           GETMAIN FAILED              55750002
         DC    AL1(99),AL3(PARSBLOW)        PARSE LINK FAILED           55800002
         DC    AL1(HEXFF)                   END OF ESTAE ABEND TABLE    55850002
         SPACE 2                                                        55900002
GOSPL    IKJEGSPL RTRY=STAERTN,ABNTB=STATBL,MODNM=IKJEGGO,TNM=GO        55950002
RUNSPL   IKJEGSPL RTRY=STAERTN,ABNTB=STATBL,MODNM=IKJEGGO,TNM=RUN       56000002
CALSPL   IKJEGSPL RTRY=STAERTN,ABNTB=STATBL,MODNM=IKJEGGO,TNM=CALL      56050002
         EJECT                                                          56100002
*********************************************************************** 56150002
* THESE ARE THE MESSAGE PARAMETER LISTS USED BY THE COMMON              56200002
* MESSAGE WRITING ROUTINE(MSGRTN)                                       56250002
* THE PARAMETER LISTS HAVE THE FOLLOWING FORMAT.                        56260002
*    WORD1=FIRST LEVEL MESSAGE NUMBER IN BINARY                         56270002
*    WORD2=SECOND LEVEL MESSAGE NUMBER IN BINARY                        56280002
*    WORD3=FIRST LEVEL MESSAGE INSERT NUMBER IN                         56290002
*          BINARY OR ZERO IF THERE IS NO INSERT                         56292002
*********************************************************************** 56300002
MSG1     DS    0F                                                       56350002
         DC    F'104'        GO FAILED,COMMAND SYSTEM ERROR             56400002
         DC    F'277'        PARSE ERROR CODE 12                        56450002
         DC    F'18'         'GO' INSERT                                56500002
MSG3     DS    0F                                                       56750002
         DC    F'58'         RUN FAILED                                 56800002
         DC    F'257'        OVERLAY PGMS NOT SUPPORTED BY RUN          56850002
         DC    F'19'         'RUN' INSERT                               56900002
MSG4     DS    0F                                                       56950002
         DC    F'104'        RUN FAILED,COMMAND SYSTEM ERROR            57000002
         DC    F'277'        PARSE ERROR CODE 12                        57050002
         DC    F'19'         'RUN' INSERT                               57100002
MSG5     DS    0F                                                       57150002
         DC    F'104'        CALL FAILED,COMMAND SYSTEM ERROR           57200002
         DC    F'277'        PARSE ERROR CODE 12                        57250002
         DC    F'20'         'CALL' INSERT                              57300002
MSG7     DS    0F                                                       57350002
         DC    F'104'        GO FAILED,COMMAND SYSTEM ERROR             57400002
         DC    F'283'        SVC97 RETURN CODE NONZERO                  57450002
         DC    F'18'         'GO' INSERT                                57500002
MSG8     DS    0F                                                       57550002
         DC    F'104'        CALL FAILED,COMMAND SYSTEM ERROR           57600002
         DC    F'283'        SVC97 RETURN CODE NONZERO                  57650002
         DC    F'20'         'CALL' INSERT                              57700002
MSG9     DS    0F                                                       57750002
         DC    F'104'        RUN FAILED,COMMAND SYSTEM ERROR            57800002
         DC    F'283'        SVC97 RETURN CODE NONZERO                  57850002
         DC    F'19'         'RUN' INSERT                               57900002
MSG10    DS    0F                                                       57950002
         DC    F'104'        RUN FAILED,COMMAND SYSTEM ERROR            58000002
         DC    F'276'        SYSTEM CNTRL BLK ERROR,TEST SESSION ENDED  58050002
         DC    F'19'         'RUN' INSERT                               58100002
         EJECT                                                          62500002
         SPACE 2                                                        62550002
         TCOMTAB                                                        62600002
         EJECT                                                          62650002
         SPACE                                                          62700002
         BRKELEM                                                        62750002
         EJECT                                                          62800002
         SPACE                                                          62850002
         IKJPPL                                                         62900002
         EJECT                                                          62950002
         TSTCWORK                                                       63000002
         ORG   CWORKCMD      GO BACK TO COMMAND WORK AREA               63050002
GOWKAREA DS    0H                                                       63100002
CMDCODE  DS    AL1           THIS IS THE NORMAL RETURN CODE TO BE       63150002
*                            ISSUED UPON COMPLETION OF THE COMMAND      63200002
SVCPARMS DS    3F            WORK AREA FOR TEST SVC MACRO EXPANSION     63250002
PPLAREA  DS    7F            PARSE PARAMETER LIST-DESCRIPTION IN PPL    63300002
*                            MACRO EXPANSION                            63350002
ADDRONE  DS    A             ADDRESS OF FIRST LEVEL MESSAGE             63400002
ADDRTWO  DS    A             ADDRESS OF SECOND LEVEL MESSAGE            63450002
REGSAVE  DS    F             SERVICE ROUTINE RETURN CODE SAVEAREA       63500002
STAEAREA DS    CL16          ESTAE WORKAREA                             63550002
*********************************************************************** 63600002
*        THE FOLLOWING FORMAT FOR THE SVRB'S SAVE AREA FOR THE        * 63650002
*        GPR'S ASSUMES THAT THE SVC INTERRUPT HANDLER DOES A          * 63700002
*        STM 0,15                                                     * 63750002
*********************************************************************** 63800002
         DS    0F                                                       63850002
PPRSAVE  DS    0CL64         SAVE AREA FOR PP'S REGISTERS               63900002
PPREG0   DS    F             SAVED REGISTER 0                           63950002
PPREG1   DS    F             SAVED REGISTER 1                           64000002
PPREG2   DS    F             SAVED REGISTER 2                           64050002
PPREG3   DS    F             SAVED REGISTER 3                           64100002
PPREG4   DS    F             SAVED REGISTER 4                           64150002
PPREG5   DS    F             SAVED REGISTER 5                           64200002
PPREG6   DS    F             SAVED REGISTER 6                           64250002
PPREG7   DS    F             SAVED REGISTER 7                           64300002
PPREG8   DS    F             SAVED REGISTER 8                           64350002
PPREG9   DS    F             SAVED REGISTER 9                           64400002
PPREG10  DS    F             SAVED REGISTER 10                          64450002
PPREG11  DS    F             SAVED REGISTER 11                          64500002
PPREG12  DS    F             SAVED REGISTER 12                          64550002
PPREG13  DS    F             SAVED REGISTER 13                          64600002
PPREG14  DS    F             SAVED REGISTER 14                          64650002
PPREG15  DS    F             SAVED REGISTER 15                          64700002
SAVE234  DS    3F            SAVE AREA FOR R2-R4 DURING MESSAGE WRITING 64710002
         EJECT                                                          64750002
         SPACE                                                          64800002
         IKJPARMA                                                       64850002
         EJECT                                                          64900002
         SPACE                                                          64950002
         IKJTCB                                                         65000002
         EJECT                                                          65050002
CVT      DSECT                                                          65100002
         CVT                                                            65150002
         EJECT                                                          65200002
         IKJRB                                                          65250002
         EJECT                                                          65300002
SAVEAREA DSECT                                                          65352002
SAVEUSER DS    F             UNUSED                                     65354002
SAVELAST DS    F             PTR TO LAST SAVEAREA (CALLER'S)            65356002
SAVENEXT DS    F             PTR TO NEXT SAVEAREA (SUBROUTINE)          65358002
RETURNPT DS    F             PTR TO CALLER'S RESUME ADDRESS             65358402
ENTRYPT  DS    F             PTR TO ENTRY POINT                         65358802
GR0      DS    F             GENERAL REGISTER 0                         65359202
GR1      DS    F             GENERAL REGISTER 1                         65359602
GR2      DS    F             GENERAL REGISTER 2                         65359702
GR3      DS    F             GENERAL REGISTER 3                         65359802
GR4      DS    F             GENERAL REGISTER 4                         65359902
GR5      DS    F             GENERAL REGISTER 5                         65363202
GR6      DS    F             GENERAL REGISTER 6                         65365202
GR7      DS    F             GENERAL REGISTER 7                         65365602
GR8      DS    F             GENERAL REGISTER 8                         65366002
GR9      DS    F             GENERAL REGISTER 9                         65366402
GR10     DS    F             GENERAL REGISTER 10                        65366502
GR11     DS    F             GENERAL REGISTER 11                        65366602
GR12     DS    F             GENERAL REGISTER 12                        65374902
LSAVE    EQU   *-SAVEAREA    LENGTH OF SAVEAREA                         65376902
         EJECT                                                          65378902
IKJEGGO  CSECT                                                          65383402
         DS    0F            FORCE FULLWORD ALIGNMENT                   65385402
GRCPATCH DC    50C'Z'        PATCH AREA                                 65391702
         END                                                            65400002
