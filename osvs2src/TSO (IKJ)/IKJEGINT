GINT     TITLE 'IKJEGINT - TSO TEST INITIALIZATION - MAIN LINE CODE'    00008003
         COPY  IKJEGSIO                                                 00016003
         EJECT                                                          00024003
*D638400                                                       @YM07110 00032003
*A347600-347800                                                @ZA00859 00040003
IKJEGINT CSECT                                                          00048003
*********************************************************************** 00060003
*                                                                     * 00070003
* STATUS --                                                           * 00080003
*    VERSION NO. 01, OS/VS2 RELEASE NO. 02, 06/06/73                  * 00090003
*                                                                     * 00100003
* FUNCTION --                                                         * 00112003
*    THIS MODULE RECEIVES CONTROL FROM THE TMP AS THE RESULT OF       * 00120003
*    A LINK.IT IS THE PRIMARY INITIALIZATION ROUTINE OF THE TEST      * 00130003
*    CONVERSATIONAL DEBUGGING PACKAGE FOR TSO.THIS ROUTINE ACQUIRES   * 00140003
*    STORAGE NEEDED BY TEST,LOCATES SUB-COMMANDS VIA BLDL,INITIAL-    * 00150003
*    IZES THE COMMUNICATION TABLE AND SETS UP INITIAL QUALIFICATION   * 00160003
*    FOR ANY SUB-TASK WHICH EXISTS.IF NONE EXISTS,THE TEST LOADER     * 00170003
*    IS ATTACHED TO BRING IN THE REQUESTED PROGRAM AS A SUB-TASK      * 00180003
*    OF THE TEST TASK.                                                * 00190003
*                                                                     * 00200003
* ENTRY POINTS --                                                     * 00210003
*    IKJEGINT                                                         * 00220003
*                                                                     * 00230003
* INPUT --                                                            * 00240003
*    TEST PARAMETER LIST (TPL) POINTED TO BY REGISTER 1.              * 00250003
*                                                                     * 00260003
* OUTPUT --                                                           * 00270003
*    TCOMTAB IS INITIALIZED FOR TEST'S MAINLINE ROUTINE               * 00280003
*                                                                     * 00290003
* EXTERNAL REFERENCES --                                              * 00300003
*         IKJPARS  LINKED - TO PARSE TEST COMMAND.                    * 00310003
*         IKJEGLDR ATTACHED - TO BRING IN REQUESTED PROGRAM.          * 00320003
*         IKJEGIO BRANCHED - TO WRITE DIAGNOSTIC MESSAGES.            * 00330003
*         IKJDAIR LINKED - TO ALLOCATE AND UNALLOCATED DATA SETS      * 00340003
*         IKJEFF18 LINKED - TO TO HANDLE DAIR ERROR MESSAGES          * 00350003
*         IKJDFLT LINKED - TO DEFAULT THE USER SUPPLIED DS.           * 00360003
*                                                                     * 00370003
* EXITS, NORMAL --                                                    * 00380003
*         BRANCH TO IKJEGMNL                                          * 00390003
*                                                                     * 00400003
* EXITS, ERROR --                                                     * 00410003
*         RETURN TO TMP.                                              * 00420003
*                                                                     * 00430003
* TABLES/WORKAREAS --                                                 * 00440003
*    TCOMTAB IS THE TEST COMMUNICATION TABLE BUILT BY INITIALIZATION  * 00450003
*    WORKAREAS HUNG FROM THIS TABLE ARE GOTTEN BY THIS MODULE         * 00460003
*    OUTBUF, ATTNBUF, CONAREA, BLDLIST, SCPPAD, REGSAVE1-5, SCPP4K    * 00470003
*                                                                     * 00480003
* ATTRIBUTES --                                                       * 00490003
*    RE-ENTRANT.                                                      * 00500003
*    REFRESHABLE.                                                     * 00510003
*                                                                     * 00520003
* CHARACTER CODE DEPENDENCY --                                        * 00530003
*    NONE                                                             * 00540003
*                                                                     * 00550003
* NOTES --                                                            * 00560003
*    REGISTER CONVENTION FOR INITIALIZATION ARE AS FOLLOWS            * 00570003
*    REG 9 IS TCOMTAB POINTER                                         * 00580003
*    REG 10 IS THE TPL(TEST PARAMETER LIST) POINTER                   * 00590003
*    REG 11 ONLY USED FOR LINK REGISTER                               * 00600003
*    REG 12 IS THE BASE REGISTER                                      * 00610003
*    REGISTER 0,1,14,15 ARE USED BY MOST SUBROUTINE'S BAL-ED TO.      * 00620003
*                                                                     * 00630003
* CHANGE ACTIVITY --                                                  * 00633001
*    @ZA15329 - NEAR LABEL SPECIAL INSTRUCTION ST R2,PPEXIT DELETED   * 00636001
*    @ZA18794 - PUESDO POST ECBTERM IF ABEND OCCURES IN INITALIZATION * 00636501
*               AFTER LOADING PROBLEM PROGRAM TO BE TESTED.           * 00637001
*    @ZA25752 - MSGIKJ57370I ISSUED WITH IKJ57336I TEXT - REGS 3 AND  * 00638001
*                   4 SET UP INCORRECTLY,MSG IKJ57002I WILL BE ISSUED * 00638601
*                                                                     * 00640003
*********************************************************************** 00650003
         EJECT                                                          00660003
*********************************************************************** 00670003
*                                                                       00680003
* GENERAL REGISTER EQUATES                                              00690003
*                                                                       00700003
*********************************************************************** 00710003
         SPACE 2                                                        00720003
R0       EQU   0              GENERAL REGISTER 0                        00730003
R1       EQU   1              GENERAL REGISTER 1                        00740003
R2       EQU   2              GENERAL REGISTER 2                        00750003
R3       EQU   3              GENERAL REGISTER 3                        00760003
R4       EQU   4              GENERAL REGISTER 4                        00770003
R5       EQU   5              GENERAL REGISTER 5                        00780003
R6       EQU   6              GENERAL REGISTER 6                        00790003
R7       EQU   7              GENERAL REGISTER 7                        00800003
R8       EQU   8              GENERAL REGISTER 8                        00810003
R9       EQU   9              GENERAL REGISTER 9                        00820003
R10      EQU   10             GENERAL REGISTER 10                       00830003
R11      EQU   11             GENERAL REGISTER 11                       00840003
R12      EQU   12             GENERAL REGISTER 12                       00850003
R13      EQU   13             GENERAL REGISTER 13                       00860003
R14      EQU   14             GENERAL REGISTER 14                       00870003
R15      EQU   15             GENERAL REGISTER 15                       00880003
         SPACE                                                          00890003
*********************************************************************** 00900003
*        MESSAGE EQUATES, NUMBERS OF MESSAGE IN MESSAGE CSECT           00910003
*********************************************************************** 00920003
TESTFAIL EQU   0100           TEST FAILED MSG                           00930003
SVCFAIL  EQU   0273           BREAKPOINT SVC ERROR MESSAGE (2 ND)       00940003
DAIRNO   EQU   0041           NUMBER OF 'DAIR' IN STATIC INSERT TABLE   00950003
DEFLTNO  EQU   0046           NUMBER OF 'IKJDFLT' STATIC INSERT TABLE   00960003
EFF18NO  EQU   0042           NUMBER OF 'IKJEFF18' STATIC INSERT TABLE  00970003
PARSENO  EQU   0040           NUMBER OF 'IKJPARS' STATIC INSERT TABLE   00980003
BADMEMNO EQU   0002           BAD MEMBER MESSAGE NUMBER                 00990003
NOSTROG  EQU   0260           LACK OF STORAGE MESSAGE NUMBER  (2 ND)    01000003
MGNOTRY  EQU   0001           NO PROGRAM LEFT TO TEST                   01010003
ATTCHFL  EQU   0104           XXX FAILED COMMAND SYS ERROR MSG NO.      01020003
NOTCONT  EQU   0258           UNABLE TO CONTINUE TEST MSG NO.. (2 ND)   01030003
ATTCHNO  EQU   0027           ATTACH FIX INSERT NO.                     01040003
N1       EQU   1              DECIMAL ONE                      @ZA05807 01042001
         EJECT                                                          01050003
*********************************************************************** 01060003
*                                                                     * 01070003
*        PERFORM INITIAL PROCESSING FOR THE TEST COMMAND              * 01080003
*        PROCESSOR --                                                 * 01090003
*                                                                     * 01100003
*        1 --  SAVE ENTRY REGISTERS.                                  * 01110003
*                                                                     * 01120003
*        2 --  ACQUIRE MAIN STORAGE FOR TEST COMMUNICATION TABLE,     * 01130003
*              REGISTER SAVE AREAS, OUTPUT BUFFER, AND SUBCOMMAND     * 01140003
*              WORK AREAS.                                            * 01150003
*                                                                     * 01160003
*        3 --  SET MAIN STORAGE AREAS TO ZERO.                        * 01170003
*                                                                     * 01180003
*        4 --  ISSUE THE STAE MACRO INSTRUCTION TO ESTABLISH AN       * 01190003
*              ABNORMAL END EXIT FOR THIS LOAD OF THE TEST CP.        * 01200003
*                                                                     * 01210003
*        R9 -- ADDRESS OF TCOMTAB.                                    * 01220003
*        R10 - ADDRESS OF TPL.                                        * 01230003
*        R12 - BASE REGISTER.                                         * 01240003
*                                                                     * 01250003
*********************************************************************** 01260003
         SPACE 2                                                        01270003
         SAVE  (14,12),,*     SAVE CALLER'S REGS.                       01280003
         LR    R12,R15        ESTABLISH ADDRESSABILITY FOR THIS         01290003
         USING IKJEGINT,R12   CSECT.                                    01300003
INT01010 EQU   *                                                        01310003
         LR    R10,R1         ESTABLISH ADDRESSABILITY TO THE           01320003
         USING TPL,R10        TPL.                                      01330003
         SPACE 2                                                        01340003
         L     R0,TCOMTABL    SIZE OF TCOMTAB FOR GETMAIN.              01350003
         GETMAIN RU,LV=(0),SP=1  GET STORAGE FOR TCOMTAB, WORK AREAS.   01360003
         SPACE 2                                                        01370003
         LR    R9,R1          ESTABLISH ADDRESSABILITY TO               01380003
         USING TCOMTAB,R9     THE TCOMTAB.                              01390003
         SPACE 2                                                        01400003
         LR    R2,R9          BEGINNING ADDRESS OF GOTTEN CORE          01410003
         LR    R4,R9          TO BE SET TO ZERO,                        01420003
         SR    R5,R5          SHOW ENTIRE FIELD TO BE SET TO            01430003
         L     R3,TCOMTABL    ZERO WITH X'00' AS PADDING CHAR           01440003
         MVCL  R2,R4          SET TCOMTAB TO ZERO.                      01450003
         EJECT                                                          01460003
*********************************************************************** 01470003
*                                                                     * 01480003
*        INITIALIZE FIELDS IN THE TEST COMMUNICATION TABLE --         * 01490003
*                                                                     * 01500003
*        1 --  SET-UP ADDRESS OF TEST'S TCB.                          * 01510003
*                                                                     * 01520003
*        2 --  PLACE ENTRY POINTS OF THE I/O SERVICE ROUTINES IN      * 01530003
*              TCOMTAB.  NOTE THAT VCONS IN THIS MODULE MUST HAVE     * 01540003
*              SAME ORDER AS ENTRY POINT LABELS IN TCOMTAB.           * 01550003
*                                                                     * 01560003
*        3 --  ESTABLISH THE PSEUDO BREAKPOINT IN TCOMTAB.            * 01570003
*                                                                     * 01580003
*        4 --  MOVE ADDRESSES OF ECBS, UPT, AND ECT FROM THE TPL      * 01590003
*              TO TCOMTAB.                                            * 01600003
*                                                                     * 01610003
*        5 --  COMPUTE ADDRESSES OF VARIOUS TEST WORKAREAS AND        * 01620003
*              REGISTER SAVE AREAS AND PLACE IN TCOMTAB.              * 01630003
*                                                                     * 01640003
*        6 --  INVOKE SVC 97 TO PLACE TCOMTAB ADDRESS IN TEST'S       * 01650003
*              TCB.                                                   * 01660003
*                                                                     * 01670003
*        7 --  OBTAIN TERMINAL LINE SIZE AND SAVE IN TCOMTAB FOR      * 01680003
*              USE OF I/O ROUTINES.                                   * 01690003
*                                                                     * 01700003
*        R8 -- ADDRESS OF INITIALIZATION'S WORK AREA.                 * 01710003
*                                                                     * 01720003
*********************************************************************** 01730003
         SPACE 2                                                        01740003
         L     R4,CVTPTR       CVT ADDR.                                01750003
         USING CVT,R4          ADDRESSABILITY TO CVT.                   01760003
         L     R4,CVTTCBP      NEW-CURRENT ADDR.                        01770003
         DROP  R4                                                       01780003
         MVC   TSTTCB(L'TSTTCB),X4(R4) TSTTCB=TEST'S TCB.               01790003
         SPACE 2                                                        01800003
         MVC   TSTIO(L'TSTIO),IOADDR  PLACE ADDR OF  IO INTO TCOMTAB    01810003
         MVC   TSTCONVT(N12),CVTBDSTA  ADDR OF CVT, BLD, STA IN TCOMTAB 01820003
         MVC   TSTSRHRT(X4),SRHRTVCN   PLACE ADDR OF SRH INTO TCOMTAB   01830003
         SPACE 2                                                        01840003
         MVC   OPCODTAB(X8),OPCODV  INSERT THE OP CODE TABLE ADDR       01850003
         MVC   TSTSVC(L'TSTSVC),SVC  PSEUDO BREAKPOINT SVC.             01860003
         SPACE 2                                                        01870003
         L     R2,TPLCECB     ATTACHED CP ECB ADDRESS.                  01880003
         L     R3,TPLIECB     STAI ECB ADDRESS.                         01890003
         L     R4,TPLAECB     ATTN ECB ADDRESS.                         01900003
         L     R5,TPLMECB     STOP/MODIFY ECB.                          01910003
         STM   R2,R5,ECBTERM  SAVE.                                     01920003
         L     R2,TPLUPT      ADDRESS OF UPT FOR PARMLIST               01930003
         L     R3,TPLECT      ADDRESS OF ECT FOR PARMLIST               01940003
         STM   R2,R4,PARMLIST UPT ADDR, ECT ADDR, ATTN ECB ADDR         01950003
         SPACE 2                                                        01960003
         LA    R1,TCOMLEN(,R9) ADDR OF OUTPUT BUFFER                    01970003
         ST    R1,OUTBUF      INITIALIZE POINTER TO BUFFER.      ****** 01980003
         LA    R2,OUTBUFRL(,R1) ADDR OF CONVERT WORK AREA               01990003
         ST    R2,CONAREA     INITIALIZE POINTER TO CVT WORKAREA.****** 02000003
         LA    R3,CONAREAL(,R2) ADDR OF GENERAL WORK AREA               02010003
         LA    R4,CWORKLEN(,R3) ADDR OF REGISTER SAVE AREA 1            02020003
         LA    R5,N72(,R4)    ADDR OF REGISTER SAVE AREA 2              02030003
         LA    R6,N72(,R5)    ADDR OF REGISTER SAVE AREA 3              02040003
         LA    R7,N72(,R6)    ADDR OF REGISTER SAVE AREA 4              02050003
         LA    R8,N72(,R7)    ADDR OF REGISTER SAVE AREA 5              02060003
         STM   R3,R8,WORKAREA PLACE ADDRESSES IN TCOMTAB         ****** 02070003
         LA    R1,N72(,R8)    ADDR OF REGISTER SAVE AREA 6              02080003
         ST    R1,REGSAVE6    PLACE ADDRESS IN TCOMTAB                  02090003
         SPACE                                                          02100003
         ST    R13,X4(,R4)    SAVE BACKWARD POINTER.                    02110003
         ST    R4,X8(,R13)    SAVE FORWARD POINTER.                     02120003
         LR    R13,R4         R13=NEW REGSAVE ADDR.                     02130003
         SPACE 2                                                        02140003
         SR    R8,R8          ZERO R8                                   02150003
         LA    R0,INTWLEN     SIZE OF INT WORKAREA FOR GETMAIN.         02160003
         GETMAIN RC,SP=1,LV=(0)    GET STORAGE FOR INT WORK AREAS.      02170003
         LTR   R15,R15        WAS THE GETMAIN OK                        02180003
         BNZ   GETERROR       NO THEREFORE PUTOUT ERROR MSG             02190003
         SPACE 2                                                        02200003
         LR    R8,R1          R8= ADDR OF THE WORK AREA FOR INT         02210003
         ST    R8,N0(,R13)    SAVE WORKAREA ADDRESS FOR ABEND.          02220003
         USING INTWKARA,R8    ESTABLISH ADDRESSABILITY TO WORK          02230003
*                             AREA.                                     02240003
         SPACE 2                                                        02250003
*********************************************************************** 02260003
*        ISSUE AN ESTAE                                                 02270003
*********************************************************************** 02280003
         STM   R14,R12,N12(R13) SAVE THE REGS FOR RETRY                 02290003
         XC    INTWKARA(INTWLEN),INTWKARA CLEAR WORK AREA               02300003
         L     R2,TSTSTAE     R2=ADDR OF IKJEGSTA                       02310003
         ESTAE (R2),CT,PARAM=INTSPL,RECORD=YES,MF=(E,INTWKARA)          02320003
         LTR   R15,R15        IS R15 NON ZERO                           02330003
         BNZ   ESTAERR        YES IT IS NON ZERO ERROR CONDITION        02340003
         SPACE 2                                                        02350003
INT01030 EQU   *              CONTINUE AS ESTAE WAS OK                  02360003
         L     R2,TSTTCB      ADDRESS OF TMP/TEST TCB.                  02370003
         IKJEGS9G TRN,TCBADDR=(R2),VALUE=(R9),MF=(E,INTSVCPL)           02380003
         LTR   R15,R15        CHECK RETURN CODE.                        02390003
         BNZ   SVC97ERR       IF NONZERO THEN ERROR                     02400003
         LA    R2,TSTDSECB    TEST ECB ADDR IN TCOMTAB.                 02410003
         ST    R2,ECBTST      SAVE TEST ECB ADDRESS.                    02420003
         SPACE 2                                                        02430003
         GTSIZE                                                         02440003
         LR    R11,R1         PUT THE TERMINAL LENGTH IN R11.           02450003
         SLL   R11,N16(R0)    SHIFT FOR STORE.                          02460003
         STM   R10,R11,TPLPTR SAVE TPL ADDRESS AND TERMINAL LINE        02470003
*                             LENGTH IN TCOMTAB                         02480003
         EJECT                                                          02490003
*********************************************************************** 02500003
*                                                                     * 02510003
* DETERMINE IF TEST WAS INVOKED BY THE TMP DUE TO AN ATTENTION        * 02520003
* INTERRUPT OR DUE TO THE PREVIOUS COMMAND PROCESSOR COMPLETING       * 02530003
* ABNORMALLY.                                                         * 02540003
*                                                                     * 02550003
*********************************************************************** 02560003
         SPACE 2                                                        02570003
         OC    PPTCB(L'TPLNTCB),TPLNTCB MOVE AND TEST ABENDING TCB PTR  02580003
         BNZ   INT03010       YES,ABEND,SKIP NEXT TEST.                 02590003
         OC    PPTCB(L'TPLCTCB),TPLCTCB MOVE AND TEST ATTACHED TCB PTR  02600003
         BZ    INT07010       IF NO SUBTASKS, PARSE TEST COMMAND.       02610003
         B     INT03030       BRANCH TO TURN ON TEST BIT(S)             02620003
         SPACE 2                                                        02630003
INT03010 EQU   *                                                        02640003
         OI    TSTFLGS3,TSTSTAI TURN ON STAI INDICATOR FOR SVC97        02650003
         XC    TPLNTCB(L'TPLNTCB),TPLNTCB ZERO ABENDED TCB POINTER.     02660003
         EJECT                                                          02670003
*********************************************************************** 02680003
*                                                                     * 02690003
* SUBTASK WAS INTERCEPTED THROUGH AN ATTENTION INTERRUPT OR BY AN     * 02700003
* ABNORMAL END (STAI).  CHECK ALL SUBTASKS OF THE TEST (TMP) TCB      * 02710003
* FOR DATA SAVED BY THE SVC 061 ROUTINE (TCBTRN .NE. 0).  WHEN DATA   * 02720003
* WAS SAVED BY SVC 061, CHAIN DATA FROM TSTTRN (IN TCOMTAB) AND       * 02730003
* RESET THE TCBTRN AND TCBABF FIELDS IN THE TCB.                      * 02740003
*                                                                     * 02750003
*********************************************************************** 02760003
         SPACE 2                                                        02770003
INT03030 EQU   *                                                        02780003
         L     R4,TSTTCB      TEST'S TCB.                               02790003
         USING TCB,R4         ADDRESSABILITY TO TCB.                    02800003
         OI    TSTFLGS4,TSTA  INDICATE NEED FOR A TERMINAL ELEMENT.     02810003
         LA    R2,N0(,R4)     CLEAR HIGH BYTE AND SAVE.                 02820003
INT04010 EQU   *                                                        02830003
         L     R5,TCBLTC      OBTAIN DAUGHTER.                          02840003
         LTR   R5,R5          IS THERE A DAUGHTER.                      02850003
         BNZ   INT04050       YES.PROCESS.                              02860003
INT04030 EQU   *                                                        02870003
         L     R5,TCBNTC      OBTAIN SISTER IF ONE.                     02880003
         LTR   R5,R5          IS THERE ONE.                             02890003
         BNZ   INT04050       YES.GO PROCESS.                           02900003
         L     R4,TCBOTC      LOAD MOTHER TASK.                         02910003
         LA    R4,N0(,R4)     CLEAR HIGH BYTE.                          02920003
         CR    R4,R2          DOES MOTHER = TEST TASK.                  02930003
         BNE   INT04030       NO. CHECK SISTER TCB.                     02940003
         B     INT06010       YES. DONE....                             02950003
INT04050 EQU   *                                                        02960003
         LA    R5,N0(,R5)     CLEAR HIGH BYTE.                          02970003
         BAL   R11,INT05010   CHECK THE TCBTRN FIELD                    02980003
         LR    R4,R5          FIND NEXT TCB UNDER TEST.                 02990003
         B     INT04010       LOOP UNTIL DONE.                          03000003
         DROP  R4                                                       03010003
         EJECT                                                          03020003
*********************************************************************** 03030003
*                                                                     * 03040003
* USING THE TCB ADDRESS PASSED IN REGISTER (R5), CHECK THE TCBTRN     * 03050003
* FIELD TO DETERMINE IF A POINTER IS PRESENT TO DATA SAVED BY SVC     * 03060003
* 061.  WHEN TCBTRN .NE. 0, ISSUE A GETMAIN FOR 12 BYTES OF SUBPOOL   * 03070003
* 1 CORE WHICH WILL BE USED TO ENQUEUE DATA FROM TSTTRN (IN TCOMTAB). * 03080003
* IN ALL CASES, SVC 097 WILL BE INVOKED TO SET THE TCBTCP (IN         * 03090003
* TCBABF) FLAG TO 1 AND TCBTRN TO POINT TO TCOMTAB.                   * 03100003
*                                                                     * 03110003
*        R5 -  ADDRESS OF TCB TO BE CHECKED.                          * 03120003
*                                                                     * 03130003
*********************************************************************** 03140003
         SPACE 2                                                        03150003
INT05010 EQU   *                                                        03160003
         USING TCB,R5         ADDRESSABILITY TO TCB.                    03170003
         L     R6,TCBTRN      TCBTRN MAY CONTAIN A QUEUE.               03180003
         LA    R6,N0(,R6)     CLEAR HIGH BYTE                           03190003
         LTR   R6,R6          Q. HAS SVC61 BEEN HERE..                  03200003
         BZ    INT05030       NO. TURN ON BIT AND SET FIELD.            03210003
         L     R0,INTSVIBL    LENGTH OF CONTROL BLOCK FOR GETMAIN       03220003
         GETMAIN  RC,SP=1,LV=(0)   GET SVC INFO BLOCK CONTROL WORDS.    03230003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       03240003
         BNZ   GETERROR       PROCESS THE SVC ERROR                     03250003
INT05020 EQU   *              ALL IS OK WITH THE GETMAIN.               03260003
         USING IKJEGSVQ,R1    ADDRESSABILITY TO SVQ                     03270003
         MVC   SVQLNKPT(L'SVQLNKPT),TSTTRN LINK FIELD TO PUSH           03280003
*                             DOWN QUEUE.                               03290003
         STM   R5,R6,SVQTCBPT TCB ADDR,SVC INFO BLOCK PTR.              03300003
         ST    R1,TSTTRN      HANG CONTROL WORDS TO TSTTRN WORD.        03310003
         DROP  R1                                                       03320003
         SPACE 2                                                        03330003
INT05030 EQU   *                                                        03340003
         IKJEGS9G TCPON,TCBADDR=(R5),MF=(E,INTSVCPL)                    03350003
         LTR   R15,R15        CHECK RETURN CODE.                        03360003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              03370003
         SPACE 2                                                        03380003
         IKJEGS9G TRN,TCBADDR=(R5),VALUE=(R9),MF=(E,INTSVCPL)           03390003
         LTR   R15,R15        CHECK RETURN CODE.                        03400003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              03410003
         SPACE 2                                                        03420003
         BR    R11            CHECK THE NEXT TCB UNDER TEST.            03430003
         DROP  R5                                                       03440003
         EJECT                                                          03450003
*********************************************************************** 03460003
*                                                                     * 03470003
*        LOCATE PRB FOR PROGRAM BEING TESTED.  SET A PSEUDO-          * 03480003
*        BREAKPOINT AT THE RESUME ADDRESS CONTAINED IN THE            * 03490003
*        RBOPSW.                                                      * 03500003
*                                                                     * 03510003
*********************************************************************** 03520003
         SPACE 2                                                        03530003
INT06010 EQU   *                                                        03540003
         L     R6,TPLCTCB     MOTHER TASK.                              03550003
         USING TCB,R6         ADDRESSABILITY TO TCB.                    03560003
         L     R6,TCBFSA      INITIAL SAVE AREA.                        03570003
         DROP  R6                                                       03580003
         LA    R4,PPEXIT1     'NORMAL TERMINATION' EXIT.                03590003
         ST    R4,N12(,R6)    *                                         03600003
         L     R7,PPTCB       THE ABEND TASK OR THE HIGHEST TASK (ATTN) 03610003
         USING TCB,R7         ADDRESSABILITY TO TCB.                    03620003
         L     R2,TCBRBP      1ST RB.                                   03630003
         DROP  R7                                                       03640003
         TM    TSTFLGS3,TSTSTAI  TEST FOR STAI OR ATTENTION.            03650003
         BO    STAI1          IT'S AN ABEND. PROCESS RETRY.             03660003
         LR    R4,R2          SET REGISTER FOR ATTN.                    03670003
         USING RBSECT,R4      ADDRESSABILITY TO RB.                     03680003
         SPACE 2                                                        03690003
LOOP     EQU   *                                                        03700003
         TM    RBSTAB1,RBFTSIRB TEST FOR PRB(IRB)                       03710003
         BZ    FOUND          FOUND A PRB(IRB)                          03720003
         L     R4,RBLINK      GET THE NEXT R.B.                         03730003
         B     LOOP           LOOP UNTIL PRB(IRB) IS FOUND.             03740003
         DROP  R4                                                       03750003
         EJECT                                                          03760003
*********************************************************************** 03770003
*                                                                     * 03780003
*        ALL RBS ARE PURGED UP TO THE MOST CURRENT STAE/STAI EXIT PRB.* 03790003
*        IF THERE ARE NONE OF THESE, THEN PURGE BACK TO THE MOST      * 03800003
*        CURRENT PRB AFTER THE LAST SVRB.                             * 03810003
*                                                                     * 03820003
*        IF THERE ARE NO PRBS TO RETRY, AND THERE IS ONLY ONE TASK    * 03830003
*        UNDER TEST THEN PRINT 'NOTHING LEFT TO TEST' AND QUIT.       * 03840003
*        IF THE ABENDED TASK IS NOT THE HIGHEST TASK, SET A PSEUDO    * 03850003
*        BREAKPOINT IN ITS MOTHER AND LET THE DAUGHTER ABEND.         * 03860003
*                                                                     * 03870003
*********************************************************************** 03880003
         SPACE 2                                                        03890003
STAI1    EQU   *                                                        03900003
LOOP7    EQU   *                                                        03910003
         L     R6,TCBRBP-TCB(,R7) ADDRESS OF MOST RECENT RB,            03920003
*                             ASSUME PRB FOR STAI EXIT.                 03930003
         TM    RBSTAB1-RBSECT(R6),RBFTP DETERMINE IF A PRB.             03940003
         BNZ   QRETRY         IF FIRST RB IS NOT A PRB, ERROR.          03950003
*                             BRANCH TO CHECK FOR MULTITASKING.         03960003
         TM    RBSTAB2-RBSECT(R6),RBTCBNXT CHECK IF LAST RB.            03970003
         BO    QRETRY         IF ONLY RB ON QUEUE, ERROR.               03980003
         L     R5,RBLINK-RBSECT(,R6) ADDRESS OF NEXT MOST RECENT        03990003
*                             RB, ASSUME SVRB FOR ABEND.                04000003
         TM    RBSTAB1-RBSECT(R5),RBFTSVRB DETERMINE IF A SVRB.         04010003
         BNO   QRETRY         IF NOT A SVRB, ERROR.                     04020003
         TM    RBSTAB2-RBSECT(R5),RBTCBNXT CHECK IF LAST RB.            04030003
         BO    QRETRY         IF LAST RB ON QUEUE, ERROR.               04040003
         L     R4,RBLINK-RBSECT(,R5) ADDRESS OF NEXT MOST RECENT        04050003
*                             RB, ASSUME ABENDING PRB OR IRB.           04060003
         TM    RBSTAB1-RBSECT(R4),RBFTP-RBFTIRB DETERMINE IF A          04070003
*                             PRB OR AN IRB.                            04080003
         BNZ   ABNDSVRB       IF NOT A PRB OR AN IRB, BRANCH TO         04090003
*                             CHECK FOR A SVRB.                         04100003
         LR    R2,R5          R2= ADDR OF PREVIOUS RB                   04110003
         B     AOK            BRANCH TO SET PSEUDO BREAKPOINT.          04120003
         SPACE 2                                                        04130003
ABNDSVRB EQU   *                                                        04140003
         TM    RBSTAB2-RBSECT(R4),RBTCBNXT CHECK IF LAST RB.            04150003
         BO    QRETRY         IF LAST RB ON QUEUE, ERROR.               04160003
         TM    RBSTAB1-RBSECT(R4),RBFTSVRB DETERMINE IF SVRB.           04170003
         BNO   QRETRY         IF NOT A SVRB, ERROR.                     04180003
         LA    R5,RBSECT-RBPREFIX(,R0) LENGTH OF RB PREFIX.             04190003
         SR    R4,R5          SET RB POINTER TO PREFIX.                 04200003
         CLC   RBINTCOD-RBPREFIX(L'RBINTCOD,R4),ABEND DETERMINE         04210003
*                             IF THIS RB ABENDED.                       04220003
         BNE   QRETRY         IF RB DID NOT ABEND, ERROR.               04230003
         AR    R4,R5          RESTORE RB POINTER TO BASIC SECTION       04240003
         SPACE 2                                                        04250003
PRBLOOK  EQU   *                                                        04260003
         LR    R2,R4          SAVE ADDR OF PREVIOUS RB                  04270003
         L     R4,RBLINK-RBSECT(,R4) NEXT RB ON QUEUE.                  04280003
         TM    RBSTAB1-RBSECT(R4),RBFTP-RBFTIRB DETERMINE IF PRB        04290003
*                             OR IRB NEXT ON QUEUE.                     04300003
         BZ    AOK            IF A PRB OR IRB, BRANCH TO SET            04310003
*                             PSEUDO BREAKPOINT.                        04320003
         TM    RBSTAB2-RBSECT(R4),RBTCBNXT CHECK IF LAST RB.            04330003
         BZ    PRBLOOK        IF NOT THE END OF THE RB QUEUE,           04340003
*                             CONTINUE SEARCH UNTIL A PRB (OR           04350003
*                             IRB) OR END OF QUEUE OCCURS.              04360003
         SPACE 2                                                        04370003
QRETRY   EQU   *                                                        04380003
         NI    TSTFLGS3,XFF-TSTSTAI  TURN OFF ABEND BIT.                04390003
*        BIT TURNED OFF SO PP'S REGS WONT GET MESSED UP.                04400003
         L     R5,TCBOTC-TCB(,R7) GET THE MOTHER TCB.                   04410003
         LA    R5,N0(,R5)     CLEAR THE HIGH BYTE.                      04420003
         C     R5,TSTTCB      Q. IS THE MOTHER OF TPLNTCB TEST TCB.     04430003
         BNE   SOMTHING       SKIP THE NOTHING CODE.                    04440003
         LA    R3,MGNOTRY     'NO ACTIVE PROGRAM LEFT TO TEST'          04450003
         LA    R4,N0          NOSECOND LEVEL MSG                        04460003
         B     PUTRTURN       PRINT MSG AND EXIT.                       04470003
SOMTHING EQU   *                                                        04480003
         ST    R5,PPTCB       SAVE THE MOTHER AND SET A PSEUDO BRKPT.   04490003
         L     R6,TCBRBP-TCB(,R5) GET THE FIRST RB .                    04500003
LOOP7C   EQU   *                                                        04510003
         TM    RBSTAB1-RBSECT(R6),RBFTSIRB Q.IS THIS A PRB(IRB)         04520003
         BZ    SETPSEUD       YES SET A PSEUDO BRKPT.                   04530003
         L     R6,RBLINK-RBSECT(,R6) GET THE NEXT RB.                   04540003
         B     LOOP7C         LOOP UNTIL A PRB(IRB) IS FOUND.           04550003
SETPSEUD EQU   *                                                        04560003
         MVC   TSTGOPSW(L'TSTGOPSW),RBOPSW-RBSECT+X4(R6) SAVE THE I.C.  04570003
         MVC   TSTGOWCF(L'TSTGOWCF),RBWCF-RBSECT(R6) SAVE THE           04580003
*                             WAIT COUNT.                               04590003
         IKJEGS9G WCF,TCBADDR=(R6),MF=(E,INTSVCPL)                      04600003
         LTR   R15,R15        CHECK RETURN CODE.                        04610003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04620003
         SPACE 2                                                        04630003
         LA    R2,TSTSVC      ADDRESS OF PSEUDO BREAKPT.                04640003
         IKJEGS9G OPSW,TCBADDR=(R6),VALUE=(R2),MF=(E,INTSVCPL)          04650003
         LTR   R15,R15        CHECK RETURN CODE.                        04660003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04670003
         SPACE 2                                                        04680003
         STATUS START,TCB=(R7) START THE ABENDED TCB.                   04690003
         LA    R0,PPEXIT2     RETRY AT SVC 3                            04700003
         B     STAIPOST       LET THE ABEND CONTINUE.                   04710003
AOK      EQU   *                                                        04720003
         L     R3,REGSAVE2    SAVE AREA FOR ABENDING REGS.              04730003
         MVC   N0(N64,R3),RBGRSAVE-RBSECT(R2) SAVE THE REGISTERS.       04740003
         OC    TSTGOPSW(L'TSTGOPSW),RBABOPSW-RBSECT(R4) SAVE            04750003
*                             ADDRESS OF ABEND.                         04760003
         BNZ   SKIP5          SKIP THE NEXT BIT OF CODE.                04770003
FOUND    EQU   *                                                        04780003
         MVC   TSTGOPSW(L'TSTGOPSW),RBOPSW-RBSECT+X4(R4) SET UP         04790003
*                             RESUME ADDRESS.                           04800003
SKIP5    EQU   *                                                        04810003
         MVC   TSTGOWCF(L'TSTGOWCF),RBWCF-RBSECT(R4) SAVE THE           04820003
*                             WAIT COUNT.                               04830003
         SPACE 2                                                        04840003
         IKJEGS9G WCF,TCBADDR=(R4),MF=(E,INTSVCPL)                      04850003
         LTR   R15,R15        CHECK RETURN CODE.                        04860003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04870003
         SPACE 2                                                        04880003
         LA    R2,TSTSVC      PSEUDO BREAKPOINT ADDRESS.                04890003
         IKJEGS9G OPSW,TCBADDR=(R4),VALUE=(R2),MF=(E,INTSVCPL)          04900003
         LTR   R15,R15        CHECK RETURN CODE.                        04910003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04920003
         SPACE 2                                                        04930003
         LA    R0,TSTSVC      RETRY ADDRESS.                            04940003
STAIPOST EQU   *              POST IKJEFT04(TEST/TMP STAI EXIT)         04950003
         L     R1,TPLECT      GET ECT ADDRESS                  @ZA07137 04952001
         OI    ECTSWS2-ECT(R1),ECTTABND       TELL TMP STAI  @ZA07137   04954001
*                                               NOT TO DEQ     @ZA07137 04956001
         L     R1,TPLNECB     POST ECB FOR TMP STAI EXIT RTN.           04960003
         O     R0,POST7F      POST STAI ECB WITH A '7F'                 04970003
         POST  (1),(0)        POST                                      04980003
         STATUS  START        MAKE ALL SUBTASKS DISPATCHABLE.           04990003
         B     WAIT           ALLOW RECOVERY,BY WAITING FOR PSEUDO      05000003
*                             BREAK TO OCCUR.                           05010003
         EJECT                                                          05020003
*********************************************************************** 05030003
*                                                                     * 05040003
*        TRANSFER CONTROL TO IKJEGMNL                                 * 05050003
*                                                                     * 05060003
*********************************************************************** 05070003
         SPACE 2                                                        05080003
MODEGO   EQU   *                                                        05090003
         LA    R0,INTWLEN     R0=LENGTH OF THE FREEMAIN                 05100003
         MVC   PPEXIT(X4),SVC PLACE THE SVC97 AND 03 IN TCOMTAB         05110003
         FREEMAIN RC,LV=(0),SP=1,A=(8) FREEMAIN ADDR                    05120003
         LTR   R15,R15        WAS THE FREEMAIN OK                       05130003
         BZ    GOTOMNL        YES THEREFORE GO TO MNL                   05140003
         BAL   R11,FREERROR   NO THEREFORE OUTPUT ERROR                 05150003
         SPACE                                                          05160003
****     ISSUE ESTAE 0 TO REMOVE ESTAE                                  05179903
GOTOMNL  EQU   *              TRANFER CONTROL TO MNL                    05189903
         ESTAE 0              REMOVE THE CURRENT ESTAE                  05199903
         SPACE                                                          05200003
         LR    R1,R9          PASS MNL THE ADDR OF TCOMTAB              05210003
         L     R13,X4(R13)    RESTORE TMPS SAVE AREA ADDRESS            05220003
         L     R15,MNLADDR    R15= ENTRY POINT OF MNL                   05230003
         L     R14,N12(R13)   RESTORE R14 OF TMP                        05240003
         LM    R2,R12,N28(R13)   RESTORE TMP'S REGISTERS                05250003
         BR    R15            TRANSFER CONTROL TO MNL                   05260003
BLOW3    EQU   *                                                        05270003
         EJECT                                                          05280003
*********************************************************************** 05290003
*                                                                     * 05300003
*        WHEN TEST WAS ENTERED AS THE RESULT OF THE USER ENTERING     * 05310003
*        A TEST COMMAND, BUT NOT IN RESPONSE TO AN ATTENTION          * 05320003
*        INTERRUPT, INVOKE THE PARSE SERVICE ROUTINE TO SYNTAX        * 05330003
*        CHECK OPERANDS ENTERED ON THE TEST COMMAND.                  * 05340003
*                                                                     * 05350003
*        R2 -- ADDRESS OF PARSE PARAMETER CONTROL LIST.               * 05360003
*        R3 -- ADDRESS OF PARSE ANSWER PLACE.                         * 05370003
*        R4 -- ADDRESS OF COMMAND BUFFER.                             * 05380003
*                                                                     * 05390003
*********************************************************************** 05400003
         SPACE 2                                                        05410003
INT07010 EQU   *                                                        05420003
         L     R2,PCLADDR     R2=PCL ADDR.                              05430003
         MVC   INTPARSL(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST MOVE     05440003
*                                    IN SERVICE ROUTINE PARMLIST.       05450003
         LA    R3,TSTANSPL    R3=ANSWER PLACE ADDR.                     05460003
         L     R4,TPLTBUF     R4=TEST COMMAND BUFFER.                   05470003
         LINK  EP=IKJPARS,PARAM=(,,,(R2),(R3),(R4)),ERRET=LINKPARS,    X05480003
               MF=(E,INTPARSL)  PARSE THE COMMAND.                      05490003
BLOW5    EQU   *                                                        05500003
         LTR   R15,R15        CHECK RETURN CODE FROM PARSE.             05510003
         BZ    INT08010       RETURN CODE = 0, CONTINUE NORMALLY        05520003
         CH    R15,INTRC004   CHECK FOR RETURN CODE = 4.                05530003
         BE    TMPRTURN       USER SPECIFIED NO PROMPT, RETURN.         05540003
         CH    R15,INTRC008   CHECK FOR RETURN CODE = 8.                05550003
         BE    TMPRTURN       USER CAUSED AN ATTENTION INTERRUPT,       05560003
*                             RETURN.                                   05570003
         CH    R15,INTRC016   CHECK FOR RETURN CODE = 16.               05580003
         BE    NOCORE         PARSE UNABLE TO GET CORE, RETURN.         05590003
*                                                                       05600003
*        FOR ALL OTHER RETURN CODES, ISSUE COMMAND SYSTEM ERROR         05610003
*        MESSAGE.                                                       05620003
*                                                                       05630003
         B     TMPRTURN       RETURN TO TMP.                            05640003
         SPACE                                                          05650003
****     ISSUE THE MESSAGE TEST FAILED NO CORE                          05660003
         SPACE                                                          05670003
NOCORE   EQU   *              ISSUE THE MESSAGE                         05680003
         LA    R3,TESTFAIL    R3= TEST FAILED MESSAGE NUMBER            05690003
         LA    R4,NOSTROG     R4= SECOND LEVEL NO STORAGE AVAILABLE     05700003
         B     PUTRTURN       OUTPUT THE MESSAGE AND EXIT               05710003
         EJECT                                                          05720003
*********************************************************************** 05730003
*                                                                     * 05740003
*        UPON SUCCESSFUL RETURN FROM THE PARSE SERVICE ROUTINE,       * 05750003
*        DETERMINE IF THE USER ENTERED A FULLY QUALIFIED OR A         * 05760003
*        PARTIALLY QUALIFIED DATA SET NAME.                           * 05770003
*                                                                     * 05780003
*        WHEN A FULLY QUALIFIED DATA SET NAME WAS ENTERED, BRANCH     * 05790003
*        IMMEDIATELY TO INVOKE THE DAIR SERVICE ROUTINE TO            * 05800003
*        ALLOCATE THE DATA SET.                                       * 05810003
*                                                                     * 05820003
*        WHEN A PARTIALLY QUALIFIED DATA SET NAME WAS ENTERED,        * 05830003
*        INSPECT THE RIGHTMOST QUALIFIER FOR THE DATA SET TYPE        * 05840003
*        ('LOAD' AND/OR 'OBJ').  IF EITHER TYPE WAS SPECIFIED AND     * 05850003
*        IS THE SAME AS THE KEYWORD OPERAND ENTERED ON THE TEST       * 05860003
*        COMMAND, STRIP OFF THE QUALIFIER SO THAT IT IS NOT ADDED     * 05870003
*        BY THE DEFAULT SERVICE ROUTINE.  EXAMPLE --                  * 05880003
*                                                                     * 05890003
*        IF THE USER ENTERS --                                        * 05900003
*                                                                     * 05910003
*              TEST XXX.LOAD LOAD --OR-- TEST XXX.OBJ OBJ             * 05920003
*                                                                     * 05930003
*        THE RIGHTMOST QUALIFIER IS REMOVED.                          * 05940003
*                                                                     * 05950003
*        FOR ALL PARTIALLY QUALIFIED DATA SET NAMES, THE DEFAULT      * 05960003
*        SERVICE ROUTINE IS INVOKED TO BUILD A FULLY QUALIFIED        * 05970003
*        DATA SET NAME BY PREFIXING THE USERID AND APPENDING THE      * 05980003
*        TYPE OPERAND SPECIFIED ON THE TEST COMMAND.  AFTER           * 05990003
*        DEFAULT HAS SUCCESSFULLY BUILT A FULLY QUALIFIED DATA        * 06000003
*        SET NAME, DAIR IS INVOKED TO ALLOCATE THE DATA SET.          * 06010003
*                                                                     * 06020003
*        R7 -- ADDRESS OF PARSE PDL.                                  * 06030003
*                                                                     * 06040003
*********************************************************************** 06050003
         SPACE 2                                                        06060003
INT08010 EQU   *                                                        06070003
         L     R7,TSTANSPL    R8=ADDR OF PARSE-PRODUCED PDL.            06080003
         USING IKJPARMD,R7    PDL ADDRESSABILITY.                       06090003
         SPACE 2                                                        06100003
         MVC   INDFLTPL(DFPLDFPB-DFPLUPT+L'DFPLDFPB),PARMLIST           06110003
*                             MOVE STANDARD POINTERS TO LIST            06120003
         MVI   INTSTDSN,BLANK BLANK OUT DATA SET NAME AREA              06130003
         MVC   INTSTDSN+X1(L'INTSTDSN-X1),INTSTDSN                      06140003
         L     R2,DSNAME      R2=ADDR OF DSNAME FROM DSNAME PDE.        06150003
         LH    R3,DSNAME+X4   R3 = DSNAME LENGTH.                       06160003
         STH   R3,INDSNLEN    DSNAME LENGTH SAVED FOR DEFAULT           06170003
         LTR    R3,R3         IS DSNAME LENGTH ZERO?     @ZA00859       06180003
          BZ    NODSNAM              YES, SKIP MOVE       @ZA00859      06190003
         BCTR  R3,R0          REDUCE LENGTH FOR EXECUTE.                06200003
         EX    R3,DSNMVC      MOVE DSNAME TO DSNAME AREA.               06210003
NODSNAM  TM    DSNAME+X6,FULLQUAL Q.IS DSNAME FULLY QUALIFIED.          06220003
         BO    DAIR           IF B'01000000',YES,ALLOCATE.              06230003
         CLI   LOADOBJ+X1,LOADON Q.IS LOAD SPECIFIED.                   06240003
         LA    R2,LOAD        YES,USE 'LOAD' QUALIFIER.                 06250003
         BE    NEXT1          *                                         06260003
         LA    R2,OBJECT      NO,USE 'OBJECT' QUALIFIER.                06270003
NEXT1    EQU   *                                                        06280003
         LA    R3,X1(,R3)     RESTORE DSNAME LENGTH.                    06290003
         LA    R4,X2(,R0)     CONSTANT FOR COMPARES                     06300003
         SR    R3,R4          IF USER NAME IS 2 CHARS OR LESS,          06310003
         BNH   DSN01030       BRANCH TO INDICATE SIMPLE NAME            06320003
         LA    R5,INTSTDSN(R3) ADDRESS NEXT-TO-LAST CHARACTER           06330003
DSN01010 EQU   *                                                        06340003
         CLI   N0(R5),INDSNPER IS CHARACTER A PERIOD                    06350003
         BE    DSN01020       IF SO, QUALIFIER CHECK REQUIRED           06360003
         BCTR  R5,R0          ADDRESS NEXT CHARACTER TO LEFT            06370003
         BCT   R3,DSN01010    DECREMENT LENGTH AND REPEAT AS            06380003
*                             LONG AS LENGTH .GT. 0                     06390003
         B     DSN01030       BRANCH TO INVOKE DEFAULT                  06400003
DSN01020 EQU   *                                                        06410003
         SH    R3,INDSNLEN    SUBTRACT FULL LENGTH FROM LENGTH          06420003
         LCR   R3,R3          COMPLEMENT TO GET QUALIFIER LENGTH        06430003
         BCTR  R3,R0          REDUCE LENGTH FOR EXECUTE                 06440003
         EX    R3,QUALCHK     DETERMINE IF QUALIFIER IS EITHER          06450003
*                             OBJ OR LOAD                               06460003
         BNE   DSN01030       IF NEITHER OF THE ABOVE, BRANCH TO        06470003
*                             INVOKE DEFAULT                            06480003
         LA    R3,X1(,R3)     RESTORE QUALIFIER LENGTH                  06490003
         LH    R4,INDSNLEN    GET DSNAME LENGTH                         06500003
         SR    R4,R3          SUBTRACT QUALIFIER LENGTH                 06510003
         STH   R4,INDSNLEN    UPDATE DSNAME LENGTH TO LOGICALLY         06520003
*                             REMOVE RIGHTMOST QUALIFIER                06530003
DSN01030 EQU   *                                                        06540003
         LA    R4,INDSNLEN    R4 = DSNAME ADDRESS                       06550003
         MVC   INDFLTPB+DFPBPSCB-DFPB(L'DFPBPSCB),TPLPSCB               06560003
*                             PUT ADDRESS OF PSCB IN PARMLIST           06570003
         MVI   INDFLTPB+DFPBCNTL-DFPB,DFPBUID SET CONTROL BYTE          06580003
         LA    R6,INDFLTPB    ADDRESS OF DEFAULT PARM BLOCK             06590003
         LINK  EP=IKJDFLT,PARAM=(,,,(R6),(R4),,(R2)),ERRET=LINKDEFL,   X06600003
               MF=(E,INDFLTPL) LINK TO DEFAULT SERVICE ROUTINE          06610003
         CH    R15,INTRC024   CHECK FOR RETURN CODE = 24.               06620003
         BE    TMPRTURN       USER CAUSED AN ATTENTION INTERRUPT,       06630003
*                             RETURN.                                   06640003
         EJECT                                                          06650003
*********************************************************************** 06660003
*                                                                     * 06670003
*        ALLOCATE THE DATA SET SPECIFIED ON THE TEST COMMAND.         * 06680003
*                                                                     * 06690003
*        FOR THE INITIAL ALLOCATION REQUEST, A MEMBER NAME IS         * 06700003
*        IGNORED WHETHER IT WAS ENTERED ON THE TEST COMMAND OR        * 06710003
*        NOT.  AFTER A SUCCESSFUL INVOCATION OF THE DAIR SERVICE      * 06720003
*        ROUTINE, THE ALLOCATED DATA SET IS CHECKED TO DETERMINE      * 06730003
*        IF IT HAS SEQUENTIAL OR PARTITIONED ORGANIZATION.  IF        * 06740003
*        THE DSORG IS 'PS', TYPE 'OBJ' IS ASSUMED, THE TERMINAL       * 06750003
*        IS ALLOCATED TO DDNAME 'SYSTERM', AND IKJEGLDR IS            * 06760003
*        ATTACHED TO PROCESS THE OBJECT DATA SET.                     * 06770003
*                                                                     * 06780003
*        FOR BOTH 'LOAD' AND 'OBJ', A BLDL IS PERFORMED ON THE        * 06790003
*        MEMBER NAME (OR 'TEMPNAME' IF A MEMBER NAME WAS NOT          * 06800003
*        ENTERED) TO DETERMINE IF THE MEMBER EXISTS.  IF THE          * 06810003
*        MEMBER IS NOT FOUND IN THE DATA SET, TEST RETURNS TO THE     * 06820003
*        TMP.  IF TYPE 'LOAD' WAS SPECIFIED ON THE TEST COMMAND       * 06830003
*        AND DSORG IS 'PO', IKJEGLDR IS ATTACHED TO PROCESS THE       * 06840003
*        LOAD MODULE SPECIFIED.                                       * 06850003
*                                                                     * 06860003
*        WHEN TYPE 'OBJ' WAS SPECIFIED AND DSORG IS 'PO', THE         * 06870003
*        DATA SET IS UNALLOCATED AND ALLOCATED A SECOND TIME          * 06880003
*        SPECIFYING DSNAME(MEMBER).  AFTER SUCCESSFUL ALLOCATION,     * 06890003
*        THE TERMINAL IS ALLOCATED AND IKJEGLDR IS ATTACHED.          * 06900003
*                                                                     * 06910003
*********************************************************************** 06920003
         SPACE 2                                                        06930003
DAIR     EQU   *                                                        06940003
         NI    INTFLGS1,X'FF'-INTDSMEM FIRST TIME SWITCH FOR            06950003
*                             OBJECT(PDS)                               06960003
DAIROBJ  EQU   *              ENTRY FOR OBJECT(PDS) ALLOCATION.         06970003
         MVC   INTDAIRB(LEN08),DAIR08 MOVE BASIC PARM BLOCK             06980003
         LA    R3,INDSNLEN    GET ADDRESS OF DSNAME AND PLACE IN        06990003
         ST    R3,INTDAIRB+(DA08PDSN-DAPB08) DAIR PARAMETER BLOCK.      07000003
         CLI   LOADOBJ+X1,LOADON Q.IS 'LOAD' SPECIFIED.                 07010003
         BE    NOMEMBER       LOAD SPECIFIED,FORGET MEMBER.             07020003
         TM    INTFLGS1,INTDSMEM CHECK FOR OBJECT (PDS)                 07030003
         BZ    NOMEMBER       DO NOT ALLOCATE TO MEMBER                 07040003
         LH    R3,DSNAME+N12  R3=MEMBER NAME LENGTH.                    07050003
         L     R4,DSNAME+X8   R4=ADDR OF MEMBER NAME.                   07060003
         BCTR  R3,R0          REDUCE LENGTH FOR EXECUTE.                07070003
         EX    R3,MEMMOVE     MOVE MEMBER NAME TO DAIR PARM BLOCK.      07080003
NOMEMBER EQU   *                                                        07090003
         TM    PASSWORD+X6,PRESENT  IS PASSWORD PRESENT                 07100003
         BZ    NOPASSWD       NO -- BRANCH                              07110003
         LH    R3,PASSWORD+X4 GET PASSWORD LENGTH                       07120003
         L     R4,PASSWORD    POINT TO THE PASSWORD                     07130003
         BCTR  R3,R0          DECREMENT FOR THE EXECUTE                 07140003
         EX    R3,MOVEPASS    MOVE PASSWORD TO DAIR LIST                07150003
NOPASSWD EQU   *                                                        07160003
         BAL   R11,DAIR1      ALLOCATE THE DATA SET                     07170003
         SPACE 2                                                        07180003
         TM    INTFLGS1,INTDSMEM TEST FOR PREVIOUS ALLOCATION           07190003
         LA    R1,INTDAIRB    GET PARM ADDR.                            07200003
         MVC   INTSTDDN,DA08DDN-DAPB08(R1) SAVE DDNAME FOR IKJEGLDR.    07210003
         BNZ   ALLOCTER       ALLOCATE FOR PSUEDO SYSTERM DD            07220003
         SPACE 2                                                        07230003
         TM    DA08DSO-DAPB08(R1),PS   IS THIS A SEQUENTIAL DATA SET    07240003
         BO    SEQOBJ         SET TO OBJECT                             07250003
         SPACE 2                                                        07260003
         NC    DSNAME+X8(X4),DSNAME+X8 Q.IS MEMBER SPECIFIED            07270003
         BNZ   ATTACH1        YES,O.K. TO ATTACH                        07280003
         SPACE 2                                                        07290003
         MVC   DSNAME+X8(X4),TEMPNAME MOVE POINTER TO 'TEMPNAME'        07300003
         MVC   DSNAME+N12(X2),INTRC008 MOVE LENGTH OF TEMPNAME.         07310003
         SPACE 2                                                        07320003
ATTACH1  EQU   *                                                        07330003
         LA    R0,N100        SIZE OF INT WORKAREA FOR GETMAIN.         07340003
         GETMAIN RC,SP=1,LV=(0)    GET STORAGE FOR INT WORK AREAS.      07350003
         LTR   R15,R15        WAS THE GETMAIN OK                        07360003
         BNZ   GETERROR       NO THEREFORE PUTOUT ERROR MSG             07370003
         ST    R1,TSTDCB      SAVE THE DCB CORE ADDRESS.                07380003
         XC    N0(N100,R1),N0(R1) ZERO THE LINK FIELD.                  07390003
         LA    R4,N4(R1)      GET THE DCB ADDRESS.                      07400003
         USING IHADCB,R4      ESTABLISH ADDRESSABILITY TO THE DCB       07410003
         MVC   IHADCB(ADDCBLEN),ADDCB CONSTRUCT DCB.                    07420003
         MVC   DCBDDNAM(L'INTSTDDN),INTSTDDN  MOVE IN DDNAME            07430003
         MVC   INTOPENL,LFORM MOVE IN OPEN L-FORM                       07440003
         MVC   INTCLOSL,CLFORM MOVE IN CLOSE L-FORM.                    07450003
         OPEN  ((R4)),MF=(E,INTOPENL) OPEN THE DATA SET.                07460003
         SPACE 2                                                        07470003
         TM    DCBOFLGS,DCBOFOPN DID DCB OPEN.                          07480003
         DROP  R4             RELEASE ADDR'ABILITY TO DCB               07490003
         BO    ATTACH1A       IF OPEN, BRANCH TO PROCESS.               07500003
*                                                                       07510003
*        GENERATE ERROR MESSAGE FOR OPEN FAILURE.                       07520003
*                                                                       07530003
         B     TMPRTURN       RETURN TO TMP.                            07540003
         SPACE 2                                                        07550003
ATTACH1A EQU   *                                                        07560003
         LH    R3,DSNAME+N12  R5=MEMBER NAME LENGTH.                    07570003
         L     R6,DSNAME+X8   R6=MEMBER NAME ADDR.                      07580003
         L     R5,BLDLAREA    GET THE ADDRESS FOR THE BLDL ENTRY        07590003
         MVC   N0(INTBLDLL,R5),INTBLDLD INITIALIZE LIST DESCRIPTION.    07600003
         BCTR  R3,R0          DECREMENT LENGTH FOR EXECUTE.             07610003
         EX    R3,MEMMVC      MOVE IN MEMBER NAME.                      07620003
         BLDL  (R4),(R5)      OBTAIN DIRECTORY ENTRY.                   07630003
         LTR   R15,R15        DETERMINE IF BLDL WAS SUCCESSFUL.         07640003
         BNZ   BADMEM         IF NOT, BRANCH TO ISSUE MESSAGE.          07650003
         SPACE 2                                                        07660003
         LA    R5,X4(,R5)     INCREMENT BEYOND LIST DESCRIPTION.        07670003
         USING PDS2,R5        ESTABLISH ADDRESSABILITY TO PDS           07680003
*                             DIRECTORY ENTRY.                          07690003
         TM    PDS2ATR1,PDS2OVLY TEST FOR OVERLAY STRUCTURE.            07700003
         BZ    SKIP3          SKIP AROUND.                              07710003
         MVI   TSTDCB,X80     TURN ON HIGH BIT TO INDICATE OVLY.        07720003
         SPACE 2                                                        07730003
SKIP3    EQU   *                                                        07740003
         CLI   LOADOBJ+X1,LOADON  Q.LOAD OR OBJECT.                     07750003
         BE    ATTACH         A.LOAD (PDS)                              07760003
         BAL   R11,CLOSE      OBJECT (PDS).                             07770003
         MVC   INTDAIRB(LEN2C),DAIR2C UNALLOC BY DDNAME.                07780003
         MVC   INTDAIRB+(DA2CDDN-DAPB2C)(L'INTSTDDN),INTSTDDN           07790003
*                             MOVE IN THE DDNAME.                       07800003
         MVI   INTDAIRB+(DA2CFLG-DAPB2C+X1),X1 CODE TO UNALLOCATE BY    07810003
*                             DDNAME.                                   07820003
         BAL   R11,DAIR1      UNALLOCATE BY DDNAME                      07830003
         OI    INTFLGS1,INTDSMEM INDICATE MEMBER TO BE ALLOCATED        07840003
         B     DAIROBJ        REALLOCATE TO DSN(MEMBER)                 07850003
         SPACE 2                                                        07860003
SEQOBJ   EQU   *                                                        07870003
         MVI   LOADOBJ+X1,OBJON  SET TO OBJECT , IF NOT SUPPLIED        07880003
ALLOCTER EQU   *                                                        07890003
         MVC   INTDAIRB(LEN1C),DAIR1C ALLOCATE THE TERMINAL             07900003
         BAL   R11,DAIR1      SETUP AND LINK TO DAIR                    07910003
         MVC   TERMDD,INTDAIRB+(DA1CDDN-DAPB1C) SAVE TERMINAL           07920003
*                             DDNAME FOR OS LOADER.                     07930003
         EJECT                                                          07940003
*********************************************************************** 07950003
*                                                                     * 07960003
*        WHEN THE DATA SET SPECIFIED ON THE TEST COMMAND HAS BEEN     * 07970003
*        SUCCESSFULLY ALLOCATED AND THE MEMBER (OR TEMPNAME)          * 07980003
*        FOUND IN THE DATA SET, THE TEST LOADER (IKJEGLDR) IS         * 07990003
*        ATTACHED AS A SUBTASK OF TEST.  FOLLOWING A SUCCESSFUL       * 08000003
*        ATTACH, THE NEW SUBTASK TCB ADDRESS IS SAVED IN THE TPL      * 08010003
*        SO THAT TMP MAY DETACH ONCE TEST HAS RETURNED.               * 08020003
*                                                                     * 08030003
*        DATA PASSED TO IKJEGLDR POINTED TO OUT OF TCOMTAB IS --      * 08040003
*                                                                     * 08050003
*        1 --  PDL FOR TEST COMMAND (POINTED TO BY TSTANSPL)          * 08060003
*        2 --  BLDL ENTRY FOR LOADMODULE (POINTED TO BY BLDLAREA)     * 08070003
*                                                                     * 08080003
*********************************************************************** 08090003
         SPACE 2                                                        08100003
ATTACH   EQU   *                                                        08110003
         OI    DEFERTAB,X40       INIT DEFER'D BRKPT QUEUE   @ZA06226   08113001
*                                  FOR SVC 61                 @ZA06226  08116001
         MVC   INTATCHL(ATTCHLLN),ATTCHLFM SET UP PARAMETER LIST.       08120003
         L     R3,TPLSTAI     R3=STAI EXIT ADDRESS.                     08130003
         L     R2,ECBTERM     R2=PP TERMINATION ECB ADDR.               08140003
         XC    N0(X4,R2),N0(R2) ZERO TERMINATION ECB.                   08150003
         L     R4,TPLSPLS     R4=ADDR OF PARMS FOR STAI EXIT.           08160003
         L     R1,TPLECT      OBTAIN ECT POINTER                        08170003
         MVC   ECTPCMD-ECT(L'ECTPCMD,R1),TEST  MOVE TEST NAME INTO ECT  08180003
         ATTACH EP=IKJEGLDR,ECB=(R2),MF=(E,(R9)),SF=(E,INTATCHL),      X08190003
               SHSPV=78,ESTAI=((R3),(R4)),SZERO=NO ATTACH LOADER.       08200003
         SPACE 2                                                        08210003
BLOW6    EQU   *                                                        08220003
         LTR   R15,R15        CHECK FOR SUCCESSFUL COMPLETION.          08230003
         BZ    SETTCBPT       IF RETURN CODE = 0, CONTINUE.             08240003
*                                                                       08250003
*        GENERATE ERROR MESSAGE FOR ATTACH FAILURE.                     08260003
*                                                                       08270003
         LA    R3,ATTCHFL     R3= ATTACH FAILLED MESSAGE MSG NUMBER     08280003
         LA    R4,NOTCONT     R4= UNEABLE TO CONT. MSG NUMBER           08290003
         LA    R2,ATTCHNO     R2= STATIC INSERT NO FOR ATTACH           08300003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR THE IO PARM AREA    08310003
         IKJEGSIO MSG,FIRST=(R3),SECOND=(R4),INST11=(NUM,(R2)),        *08320003
               ID=INT15,MF=(E,TSTIOPRM)    INVOKE IO FOR ERROR          08330003
         B     TMPRTURN       RETURN TO TMP.                            08340003
         SPACE 2                                                        08350003
SETTCBPT EQU   *                                                        08360003
         LA    R1,N0(,R1)     CLEAR HIGH BYTE.                          08370003
         ST    R1,TPLCTCB     SET ATTACHED TCB ADDRESS FOR TMP.         08380003
         EJECT                                                          08390003
*********************************************************************** 08400003
*                                                                     * 08410003
*        FOLLOWING A SUCCESSFUL ATTACH, WAIT ON A LIST OF ECBS.       * 08420003
*        ANY ONE OF THE FOLLOWING EVENTS WILL CAUSE TEST TO COME      * 08430003
*        OUT OF THE WAIT STATE --                                     * 08440003
*                                                                     * 08450003
*        1 --  USER PROGRAM WAIT STATE.                               * 08460003
*        2 --  USER PROGRAM TERMINATION.                              * 08470003
*        3 --  USER PROGRAM ABEND.                                    * 08480003
*        4 --  ATTENTION.                                             * 08490003
*        5 --  OPERATOR STOP TS OR MODIFY TS.                         * 08500003
*                                                                     * 08510003
*********************************************************************** 08520003
         SPACE 2                                                        08530003
WAIT     EQU   *                                                        08540003
         MVI   ECBLOG,X80     INDICATE END OF ECBLIST.                  08550003
         WAIT  ECBLIST=ECBTST ISSUE THE WAIT.                           08560003
         EJECT                                                          08570003
*********************************************************************** 08580003
*                                                                     * 08590003
*        AN EVENT OCCURRED TO TAKE TEST OUT OF THE WAIT STATE.        * 08600003
*        DETERMINE IF SVC 061 POSTED IKJEGINT SIGNALING THAT THE      * 08610003
*        PROGRAM TO BE TESTED WAS LOADED.  IF NOT, CONTINUE           * 08620003
*        TESTING FOR WHICH EVENT OCCURRED.                            * 08630003
*                                                                     * 08640003
*        WHEN SVC 061 HAS POSTED IKJEGINT --                          * 08650003
*                                                                     * 08660003
*        1 --  DETERMINE IF IKJEGLDR IS XCTLING.  IF NOT (TSTGOSW     * 08670003
*              IS ZERO), IGNORE EVENT AND POST SVC 061 COMPLETE.      * 08680003
*                                                                     * 08690003
*        2 --  WHEN IKJEGLDR IS XCTLING, OBTAIN TCB ADDRESS AND       * 08700003
*              SVC INFORMATION BLOCK POINTER FROM SVC 061'S           * 08710003
*              EXTENDED SAVE AREA.  IF SVC INFORMATION BLOCK          * 08720003
*              PRESENT, ISSUE GETMAIN FOR QUEUE CONTROL BLOCK         * 08730003
*              AND INITIALIZE.                                        * 08740003
*                                                                     * 08750003
*        3 --  IF A VALID XCTL, SAVE FIRST TWO BYTES OF USER          * 08760003
*              PROGRAM AND ESTABLISH A PSEUDO BREAKPOINT.             * 08770003
*                                                                     * 08780003
*        4 --  POST SVC 061 COMPLETE AND BRANCH TO WAIT ON SVC        * 08790003
*              097 TO COMPLETE.                                       * 08800003
*                                                                     * 08810003
*********************************************************************** 08820003
         SPACE 2                                                        08830003
         L     R5,ECBTST      TEST ECB ADDRESS.                         08840003
         TM    N0(R5),X44     X'44' IS A POST FROM SVC 61.              08850003
         BNO   SETTSIP        BRANCH TO ISSUE TSIP SVC.                 08860003
         SPACE 2                                                        08870003
         XC    N0(X4,R5),N0(R5) CLEAR TEST'S ECB.                       08880003
         TM    TSTFLGS4,TSTSVCAB  DID THE SVC ABEND?                    08890003
         BO    TSTRTURN       OUTPUT TEST FAILS AND EXIT                08900003
         L     R2,ECBPP       OBTAIN SVC61'S SVRB ADDRESS.              08910003
         TM    TSTFLGS3,TSTGOSW  TEST IF LOADER IS XCTLING.             08920003
         BZ    POST6A         NO POST. BRANCH.                          08930003
         SPACE 2                                                        08940003
         LM    R3,R4,RBEXSAVE-RBSECT(R2) GET THE TCB ADR AND SVC INFO   08950003
*                             BLOCK POINTER.                            08960003
         LTR   R3,R3          IF TCB SLOT IS ZERO , IGNORE.             08970003
         BZ    NOGET          TCB ADDR=0 , DONT GET CORE.               08980003
         SPACE 2                                                        08990003
         L     R0,INTSVIBL    IKJEGSVQ LENGTH.                          09000003
         GETMAIN  RC,SP=1,LV=(0)   GET CORE FOR CONTROL WORDS.          09010003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVAED      09020003
         BNZ   GETERROR       PROCESS THE SVC ERROR                     09030003
SVQGETOK EQU   *              ALL IS OK WITH GETMAIN                    09040003
         USING IKJEGSVQ,R1    ADDRESSABILITY TO SVQ.                    09050003
         MVC   SVQLNKPT(L'SVQLNKPT),TSTTRN PUSH DOWN QUEUE.             09060003
         STM   R3,R4,SVQTCBPT TCB ADDR, SVC BLOCK PTR TO WORDS.         09070003
         ST    R1,TSTTRN      ADD CONTROL WORDS TO QUEUE.               09080003
         DROP  R1                                                       09090003
         SPACE 2                                                        09100003
NOGET    EQU   *                                                        09110003
         L     R1,RBLINK-RBSECT(,R2) GET PRB(IRB) ADDRESS               09120003
         TM    RBCDFLGS-RBSECT(R1),RBCDXCTL TEST XCTL BIT, FL-CDE FIELD 09130003
         L     R1,RBCDE-RBSECT(,R1) XCTLEE CDE.                         09140003
         USING CDENTRY,R1     ADDRESSABILITY TO CDE DSECT.              09150003
         BZ    POST6A         BRANCH IF NOT XCTL.                       09160003
         SPACE 2                                                        09170003
         OI    INITFLG,X'10'  TURN ON INIT FLAG               @ZA18794  09171001
         L     R6,CDENTPT     XCTLEE  E.P. ADDRESS.                     09180003
         MVC   TSTGO(L'SVC),N0(R6) SAVE 2 BYTES OF INSTR.               09188401
         MVC   N0(L'SVC,R6),SVC PLANT SVC                               09200003
         MVI   DEFERTAB,X'00'   RESET DEFER BRKPT Q FOR SVC61 @ZA06226  09205001
         XC    INITFLG,INITFLG RESET INIT FLG                 @ZA18794  09207001
         SPACE 2                                                        09210003
POST6A   EQU   *                                                        09220003
         POST  ECBPP          MAKE SVC 61 DISPATCHABLE.                 09230003
         B     WAIT           WAIT AGAIN.                               09240003
         EJECT                                                          09250003
*********************************************************************** 09260003
*                                                                     * 09270003
*        DETERMINE IF IKJEGINT WAS POSTED BY SVC 097.  IF NOT,        * 09280003
*        BRANCH TO CHECK FOR USER PROGRAM ABEND.                      * 09290003
*                                                                     * 09300003
*        WHEN SVC 097 HAS POSTED IKJEGINT --                          * 09310003
*                                                                     * 09320003
*        1 --  CLEAN-UP FOLLOWING IKJEGLDR EXECUTION.                 * 09330003
*                                                                     * 09340003
*        2 --  RESET PRB RESUME PSW AND RESTORE INSTRUCTION, IF       * 09350003
*              NECESSARY.                                             * 09360003
*                                                                     * 09370003
*        3 --  BRANCH TO BRANCH TO IKJEGMNL.                          * 09380003
*                                                                     * 09390003
*********************************************************************** 09400003
         SPACE 2                                                        09410003
SETTSIP  EQU   *                                                        09420003
         SPACE 2                                                        09430003
         BAL   R11,FROMLDR    CLOSE THE DCB, AND FREE CORE              09440003
         TM    N0(R5),X44     X'40' IS NORMAL LOAD.                     09450003
         MVI   N0(R5),N0      ZERO ECB.                                 09460003
         BZ    STAICHK        CHECK STAI ECB.                           09470003
         SPACE 1                                                        09480003
*        SVC 97 POSTED INT.                                             09490003
         SPACE 1                                                        09500003
         TM    TSTFLGS4,TSTSVCAB  DID THE SVC ABEND?                    09510003
         BO    TSTRTURN       OUTPUT TEST FAILS AND EXIT                09520003
         NI    TSTFLGS3,XFF-TSTSTAI INSURE THAT STAI BIT IS OFF.        09530003
         L     R4,PPTCB       R4=PP TCB ADDR.                           09540003
         L     R5,TCBRBP-TCB(,R4) R5=ACTIVE RB ADDR.                    09550003
         L     R5,RBLINK-RBSECT(,R5) R5=PRB ADDR FOR PP.                09560003
         TM    TSTFLGS3,TSTGOSW IS IT SPECIAL BREAKPOINT.               09570003
         BO    SPECIAL        YES IT IS.                                09580003
         L     R2,TSTGO       ADDRESS OF CLOBBERED INSTRUCTION.         09590003
         SPACE 2                                                        09600003
         IKJEGS9G OPSW,TCBADDR=(R4),VALUE=(R2),MF=(E,INTSVCPL)          09610003
         LTR   R15,R15        CHECK RETURN CODE.                        09620003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              09630003
         B     CONTINUE       CONTINUE PROCESSING.                      09640003
         SPACE 2                                                        09650003
SPECIAL  EQU   *                                                        09660003
         L     R1,RBOPSW-RBSECT+X4(,R5) OBTAIN I.C.                     09670003
         MVC   N0(X2,R1),TSTGO  RESTORE 2 BYTES OF INSTRUCTION.         09680003
         NI    TSTFLGS3,XFF-TSTGOSW TURN OFF THE PSEUDO SPECIAL SW.     09690003
         LA    R2,PPEXIT      CHANGE REGISTER FOURTEEN.                 09700003
         L     R4,PPTCB       PPS TCB POINTER.                          09720003
         IKJEGS9G GPR,TCBADDR=(R4),VALUE=(R2),REGNO=R14,               *09730003
               MF=(E,INTSVCPL)                                          09740003
         LTR   R15,R15        CHECK RETURN CODE.                        09750003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              09760003
         SPACE 2                                                        09770003
CONTINUE EQU   *                                                        09780003
         XC    TSTGO(X6),TSTGO  ZERO PSEUDO BREAK FIELD IN TCOMTAB.     09790003
         B     MODEGO         ISSUE MODE MESSAGE AND GO TO MAINLINE.    09800003
         EJECT                                                          09810003
*********************************************************************** 09820003
*                                                                     * 09830003
*        THE LAST SIGNIFICANT EVENT TO BE CHECKED IS TO DETERMINE     * 09840003
*        IF THE USER PROGRAM ABENDED.  ONLY IF AN ABEND IS            * 09850003
*        INDICATED AND A MESSAGE ROUTINE ADDRESS GIVEN IN THE ECB     * 09860003
*        WILL A MESSAGE BE PRODUCED.  IN ALL CASES, CONTROL WILL      * 09870003
*        RETURN TO THE TMP.                                           * 09880003
*                                                                     * 09890003
*********************************************************************** 09900003
         SPACE 2                                                        09910003
STAICHK  EQU   *                                                        09920003
         L     R5,ECBTMPS     GET STAI ECB.                             09930003
         TM    N0(R5),X40     Q. HAS IT BEEN POSTED BY IKJEFT04.        09940003
         BZ    LDRFAIL        NO. MUST BE SOMETHING ELSE.               09950003
         MVI   N0(R5),N0      CLEAR THE ECB.                            09960003
         L     R5,N0(,R5)     GET THE ECB PARM LIST ADDRESS.            09970003
         LTR   R1,R5          IS THERE AN ADDRESS.                      09980003
         BZ    TMPRTURN       NO. RETURN TO THE TMP.                    09990003
         L     R15,N0(,R5)    GET BRANCH TO ADDRESS.(IKJEFT04)          10000003
         CALL  (15)           CALL IKJEFT04 TO PUT OUT MESSAGE.         10010003
         SPACE 2                                                        10020003
*        WAS IT A IKJEGLDR FAILURE IF SO WHAT WAS IT.                   10030003
         SPACE                                                          10040003
LDRFAIL  EQU   *                                                        10050003
         L     R5,ECBTERM     R5= ADDR OF ECBTERM ECB                   10060003
         TM    N0(R5),X40     WAS IT POSTED BY LDR?                     10070003
         BNZ   LDRDONE        EXIT WITH TEST FAILED MSG       @ZA06995  10075001
         L     R5,ECBTMPA     NOT POSTED BY LDR,SEE IF ATTN   @ZA06995  10080001
         TM    N0(R5),X'40'   WAS ATTN ECB POSTED?            @ZA06995  10081001
         BNO   TSTRTURN       NO-EXIT WITH TEST FAILED MSG    @ZA06995  10082001
         L     R5,TPLPTR      ATTN ECB POSTED                 @ZA06995  10083001
         L     R5,TPLECT-TPL(R5)   GET ECT PTR FROM TPL       @ZA06995  10084001
         OI    ECTSWS-ECT(R5),ECTATRM  SET ECT FLAG FOR ESTAI @ZA06995  10085001
LDRDONE  EQU   *                                              @ZA06995  10086001
         LA    R5,N0(R5)      CLEAR THE HIGH BYTE.                      10090003
         LA    R4,N4          R4= FOUR (R. C. CHECK)                    10100003
         CR    R4,R5          IS THE RETURN CODE 4                      10110003
         BE    TMPRTURN       YES THEREFORE EXIT (ATTN)                 10120003
         LA    R4,N24         R4= TWENTY FOUR (ESTAE FAILED)            10130003
         CR    R4,R5          IS RC 24                         @ZA25752 10140001
         BE    ESTERROR       YES,ESTAE FAILED                 @ZA25752 10141001
         LR    R3,MGNOTRY     MSG'NO ACTIVE PROG LEFT TO TEST' @ZA25752 10142001
         LA    R4,N0          NO SECOND LEVEL MSG              @ZA25752 10143001
         B     PUTRTURN       GO OUTPUT MSG                    @ZA25752 10144001
ESTERROR EQU   *              ESTAE ERROR FROM SUBTASK.                 10150003
         SR    R15,R15        ZERO R15                                  10160003
         IC    R15,TSTESTRC   R15= ESTAE RETURN CODE FROM LDR.          10170003
         B     ESTAERR        HANDLE AS ESTAE ERROR.                    10180003
         EJECT                                                          10190003
*********************************************************************** 10200003
*                                                                     * 10210003
*        TEST INITIALIZATION EXIT.                                    * 10220003
*                                                                     * 10230003
*        WHEN SOME CONDITION EXISTS SUCH THAT THE TEST SESSION        * 10240003
*        CAN NOT CONTINUE, THIS SECTION OF CODE WILL CLEAN-UP         * 10250003
*        AND RETURN TO THE TMP.                                       * 10260003
*                                                                     * 10270003
*********************************************************************** 10280003
         SPACE 2                                                        10290003
TMPRTURN EQU   *                                                        10300003
         L     R1,TPLPTR      GET TPL ADDRESS            @ZA07137       10302001
         L     R1,TPLECT-TPL(R1)  GET ECT ADDRESS        @ZA07137       10304001
         NI    ECTSWS2-ECT(R1),XFF-ECTTABND RESET NO DEQ FLAG@ZA07137   10306001
         MVI   TSTDCB,N0      INDICATE DCB MAY BE FREED.                10310003
         BAL   R11,FROMLDR    CLOSE AND FREE THE DCB.                   10320003
         SPACE                                                          10330003
         L     R1,INBUF       R1=ADDR OF BUFFER                         10340003
         LTR   R1,R1          IS INBUF ALREADY ZERO                     10350003
         BZ    RET1           YES.RETURN.                               10360003
         LH    R0,N0(,R1)     R0=LENGTH OF BUFFER FOR FREEMAIN.         10370003
         FREEMAIN RC,LV=(0),SP=1,A=(1) FREE THE BUFFER.                 10380003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       10390003
         BZ    FREDCBOK       OK CONTINUE                               10400003
         BAL   R11,FREERROR   PROCESS THE SVC ERROR                     10410003
         SPACE 2                                                        10420003
FREDCBOK EQU   *              FREEMAIN WAS OK CONTINUE                  10430003
         XC    INBUF(L'INBUF),INBUF CLEAR INBUF.                        10440003
         SPACE 2                                                        10450003
RET1     EQU   *                                                        10460003
         IKJRLSA TSTANSPL     RELEASE THE NEW PDL                       10470003
         XC    TSTANSPL(X4),TSTANSPL  ZERO TEST ANSWER PLACE            10480003
         SPACE 2                                                        10490003
BLOW2LOC EQU   *                                                        10500003
         L     R2,TSTTCB      TCB ADDRESS FOR DAIR LIST                 10510003
         MVC   INTDAIRB(LEN2C),DAIR2C UNALLOC TCB.                      10520003
         ST    R2,INTDAIRB+(DA2CTCB-DAPB2C) TCB TO LIST.                10530003
         BAL   R11,DAIR1      BRANCH TO UNALLOCATE.                     10540003
         SPACE 2                                                        10550003
         TCLEARQ  INPUT                                                 10560003
         SPACE 2                                                        10570003
         MVC   INSTCKPL(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST          10580003
*                             MOVE IN STANDARD PARM LIST.               10590003
         MVC   INSTCKPB(STACKLEN),STACKLST MOVE LIST FORM OF STACK.     10600003
         STACK PARM=INSTCKPB,DELETE=ALL,MF=(E,INSTCKPL)                X10610003
                              FLUSH THE STACK.                          10620003
         SPACE 2                                                        10630003
         L     R2,TSTTCB      CHANGE TEST'S TCBTRN FIELD TO '0'         10640003
         SR    R3,R3          ZERO.                                     10650003
         IKJEGS9G TRN,TCBADDR=(R2),VALUE=(R3),MF=(E,INTSVCPL)           10660003
*****                                                                   10670003
*****    RETURN CODE CHECK IGNORED.                                     10680003
*****                                                                   10690003
         SPACE 2                                                        10700003
BLOW1LOC EQU   *                                                        10710003
         C     R3,TPLCTCB          WAS A SUBTASK ATTACHED ?             10710503
         BE    NODETACH            NO, SKIP ABEND COMPLETION PROCESSING 10711003
         L     R1,ECBTMPA          DID TMP SEE ATTN?           @ZA06995 10711101
         TM    N0(R1),X'40'        EXAMINE ECB TO FIND OUT     @ZA06995 10711201
         BO    NODETACH            YES-SKIP ESTAI POSTING      @ZA06995 10711301
*                                                              @ZA02373 10711503
         L     R1,ECBTERM          GET ADDR OF PROB PGM ECB    @ZA02373 10711703
         TM    INITFLG,X'10'       IN INIT?                    @ZA18794 10711801
         BZ    NOTINIT             NO,GO TO NOT INIT.          @ZA18794 10711901
         OI    0(R1),X'40'         PSEUDO POST PROB PGM ECB    @ZA18794 10712501
         XC    INITFLG,INITFLG     RESET INIT FLAG             @ZA18794 10712601
NOTINIT  TM    0(R1),X40           HAS IT BEEN POSTED COMPLETE @ZA02373 10712701
*                                                              @ZA18794 10712801
         BO    NODETACH            YES, DON'T POST AGAIN       @ZA02373 10712901
         SR    R0,R0               NO PARMLIST FOR POST        @ZA02373 10713401
         L     R1,TPLNECB          ABEND ECB                   @ZA02373 10713503
         POST  (R1)                WAKE UP TMP ESTAI (IKJEFT04)@ZA02373 10714003
*                                                                       10714503
*              AFTER WAKEING UP THE TMP ESTAI START ALL SUBTASKS        10715003
*                   TO ALLOW CONTINUATION OF THE ABEND AND AVOID        10715503
*                   A 13E ABEND                                         10716003
*              GO BACK TO MAIN WAIT AND WAIT FOR THE SUBTASK ECB        10716503
*                 (ECBTERM) TO BE POSTED INDICATING TASK COMPLETE       10717003
*                                                                       10717503
         STATUS START              START ALL SUBTASKS          @ZA02373 10718003
         B     WAIT                WAIT FOR COMPLETION         @ZA02373 10718503
         SPACE 2                                                        10770003
NODETACH EQU *                                                          10770701
AARGHH   EQU   *                                                        10778401
         SPACE 2                                                        10790003
         LR    R1,R9          R1=TCOMTAB ADDR.                          10800003
         L     R0,TCOMTABL    R0=TCOMTAB LENGTH.                        10810003
         L     R6,X4(,R13)    RESTORE TMP'S SAVE AREA ADDRESS.          10820003
         FREEMAIN RC,SP=1,LV=(0),A=(1) FREE IT.                         10830003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       10840003
         BZ    FRET1          OK CONTINUE                               10850003
         BAL   R11,FREERROR   PROCESS THE SVC ERROR                     10860003
         SPACE 2                                                        10870003
FRET1    EQU   *              CONTINUE                                  10880003
         LTR   R8,R8          IS R8 = 0 (NO WORKAREA TO FREE)           10890003
         BZ    FRETCMOK       YES THEREFORE AVOID THE FREEMAIN          10900003
         LA    R0,INTWLEN     R0=LENGTH OF THE FREEMAIN                 10910003
         FREEMAIN RC,LV=(0),SP=1,A=(8) FREEMAIN ERROR                   10920003
         LTR   R15,R15        WAS THE FREEMAIN OK                       10930003
         BZ    FRETCMOK       OK CONTINUE                               10940003
         BAL   R11,FREERROR   OUPUT ERROR MSG                           10950003
         SPACE 2                                                        10960003
FRETCMOK EQU   *              FREEMAIN WAS OK CONTINUE                  10970003
         SPACE                                                          10980003
         LR    R13,R6         RESTORE TMP'S SAVE AREA ADDR              10990003
         RETURN (14,12),RC=4  RETURN TO TMP WITH RETURN CODE=4.         11000003
         EJECT                                                          11010003
*********************************************************************** 11020003
*                                                                     * 11030003
*        SUBROUTINE USED TO CLEAN-UP RESOURCES AFTER IKJEGLDR         * 11040003
*        PROCESSING.                                                  * 11050003
*                                                                     * 11060003
*        THIS SUBROUTINE IS USED TO CLEAN-UP ALL RESOURCES            * 11070003
*        ALLOCATED DURING IKJEGLDR PROCESSING.                        * 11080003
*                                                                     * 11090003
*        1.    IF THE TERMINAL WAS ALLOCATED FOR THE OS LOADER        * 11100003
*              PROCESSING, SYSTERM IS UNALLOCATED.                    * 11110003
*                                                                     * 11120003
*        2.    IF A DCB WAS OPENED PRIOR TO ATTACHING IKJEGLDR,       * 11130003
*              IT IS CLOSED AND THE POINTER TO IT IS ZEROED.          * 11140003
*                                                                     * 11150003
*********************************************************************** 11160003
         SPACE 2                                                        11170003
FROMLDR  EQU   *                                                        11180003
         TM    TERMDD,XFF     Q. DOES TERM DD GET UNALLOCATED.          11190003
         BZ    SKIP4          NO. NEVER ALLOCATED.                      11200003
         MVC   INTDAIRB(LEN2C),DAIR2C UNALLOC BY DDNAME.                11210003
         MVC   INTDAIRB+DA2CDDN-DAPB2C(L'TERMDD),TERMDD MOVE IN         11220003
*                             THE DDNAME.                               11230003
         MVI   INTDAIRB+DA2CFLG-DAPB2C+X1,X1 CODE TO UNALLOC BY         11240003
*                             DDNAME.                                   11250003
         LR    R2,R11         SAVE LINK REGISTER.                       11260003
         BAL   R11,DAIR1      BRANCH TO UNALLOCATE.                     11270003
         LR    R11,R2         RESTORE THE LINK REGISTER.                11280003
CLOSE    EQU   *                                                        11290003
SKIP4    EQU   *                                                        11300003
         L     R4,TSTDCB      GET THE DCB ADDRESS - 4                   11310003
         LTR   R4,R4          DID WE GO THRU THE 'ATTACH1' CODE         11320003
         BCR   NEG+Z,R11      RETURN UNLESS POSITIVE AND NON-ZERO       11330003
         LA    R4,N4(R4)      GET THE DCB ADDRESS.                      11340003
         USING IHADCB,R4      ESTABLISH ADDRESSABILITY TO DCB.          11350003
         TM    DCBOFLGS,DCBOFOPN HAS THE DCB BEEN OPENED                11360003
         BZ    NOCLOSE        THE DCB IS NOT OPEN                       11370003
         CLOSE ((R4)),MF=(E,INTCLOSL) CLOSE DCB                         11380003
         DROP  R4                                                       11390003
         SPACE 2                                                        11400003
NOCLOSE  EQU   *              *                                         11410003
         BR    R11            RETURN TO CALLER.                         11420003
         EJECT                                                          11430003
*********************************************************************** 11440003
*                                                                     * 11450003
*        THIS CODE OUTPUTS THE MESSAGE 'MEMBER XXX NOT IN DATA        * 11460003
*        SET YYY'.  IKJEGIO IS CALLED TO PUT  THE MESSAGE. CONTROL    * 11470003
*        IKJEGIO IS CALLED TO PUT THE MESSAGE.  CONTROL IS THEN       * 11480003
*        IS THEN RETURNED TO THE TMP.                                 * 11490003
*********************************************************************** 11500003
         SPACE 2                                                        11510003
BADMEM   EQU   *              BAD MEMBER MSG                            11520003
         L     R6,OUTBUF      R6=ADDR OF OUTPIT BUFFER                  11530003
         LA    R2,X5(R6)      R2= WHERE INSERT 2 GOES                   11540003
         MVI   N0(R6),BLANK   SET UP TO BLANK OUTPUT BUFFER    @ZA05807 11541001
         MVC   N1(OUTBUFRL-1,R6),N0(R6) BLANK ENTIRE BUFFER    @ZA05807 11543001
         SR    R4,R4          CLEAR                                     11560003
         IC    R4,DSNAME+N13  GET THE LENGTH OF MEMBER NAME             11570003
         L     R3,DSNAME+X8   POINTER TO ACTUAL DSNAME                  11580003
         LA    R1,X5(R4)      R1= TOTAL LENGTH FOR IKJEGIO              11590003
         XC    N0(4,R6),N0(R6)    ZERO INSERT LENGTH FIELD     @ZA05807 11592001
         STH   R1,N0(R6)      PLACE LENGTH INTO OUTPUT BUFFER           11600003
         AR    R2,R4          R2= LOCATION IN OUTBUF OF SECOND INSERT   11610003
         BCTR  R4,R0          DECREMENT FOR EXECUTE                     11620003
         EX    R4,MOVEMEMB    MOVE MEMBER NAME TO MESSAGE.              11630003
         LA    R3,INTSTDSN    ACTUAL DATA SET NAME.                     11640003
         L     R4,TPLUPT      ADDRESSABILITY TO UPT .          @ZA05807 11645001
         SR    R5,R5          ZERO FOR INSERT CHAR.                     11660003
         IC    R5,UPTPREFL-UPT(,R4)  GET THE LENGTH OF USERID. @ZA05807 11665001
         BCTR  R5,R0          MINUS ONE.                                11680003
         EX    R5,CLCID       COMPARE FOR USERID PREFIX.                11690003
         BNE   MOVEDSN        MOVE IN THE DATA SET NAME.                11700003
         LA    R3,X2(R5,R3)   UP POINTER PAST USERID.          @ZA05807 11705001
MOVEDSN  MVC   X4(N35,R2),N0(R3) MOVE MOST OF THE DATA SET NAME.        11720003
         LA    R1,N40         R1= LENGTH OF INSERT                      11730003
         XC    N0(4,R2),N0(R2) ZERO SECOND INSERT LENGTH FIELD @ZA05807 11732001
         STH   R1,N0(R2)      PLACE LENGTH INTO BUFFER                  11740003
         LA    R3,BADMEMNO    R3= BAD MEMBER MESSAGE NUMBER             11750003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARAMETER LIST     11760003
         IKJEGSIO MSG,FIRST=(R3),INST11=(ADDR,(R6)),                   X11770003
               INST12=(ADDR,(2)),ID=INT15,MF=(E,TSTIOPRM)               11780003
         B     TMPRTURN       EXIT TO TMP                               11790003
         EJECT                                                          11800003
*********************************************************************** 11810003
*                                                                     * 11820003
*        DAIR SUBROUTINE.                                             * 11830003
*                                                                     * 11840003
*        THIS SUBROUTINE PROVIDES A COMMON INTERFACE TO THE DAIR      * 11850003
*        SERVICE ROUTINE.  THE SUBROUTINE ASSUMES THAT THE CALLER     * 11860003
*        HAS CONSTRUCTED THE APPROPRIATE DAIR PARAMETER BLOCK.        * 11870003
*        UPON RETURN FROM DAIR, THE RETURN CODE IS TESTED FOR         * 11880003
*        ZERO.  IF A NON-ZERO RETURN CODE IS RETURNED, THE DAIR       * 11890003
*        DIAGNOSTIC ROUTINE, IKJEGDDN, IS INVOKED TO BUILD THE        * 11900003
*        ERROR MESSAGE.                                               * 11910003
*                                                                     * 11920003
*********************************************************************** 11930003
         SPACE 2                                                        11940003
DAIR1    EQU   *                                                        11950003
         MVC   INTDAIRL(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST MOVE     11960003
*                             IN SERVICE ROUTINE PARAMETER LIST.        11970003
         LA    R1,INTDAIRB    ADDRESS OF DAIR PARAMETER BLOCK.          11980003
         L     R0,TPLPSCB     PSCB TO SECOND PORTION.                   11990003
         STM   R0,R1,INTDAIRL+(DAPLPSCB-DAPL) PSCB,DAIR PARMS TO LIST.  12000003
         LINK  EP=IKJDAIR,ERRET=LINKDAIR,MF=(E,INTDAIRL) LINK TO DAIR.  12010003
         SPACE 2                                                        12020003
         LTR   R15,R15        TEST FOR SUCCESSFUL COMPLETION.           12030003
         BCR   8,R11          IF SUCCESSFUL, RETURN.                    12040003
         ST    R15,INTREGSV   SAVE RETURN CODE                          12050003
         LA    R1,INTDAIRL    R1= ADDR OF THE DAIR PARM LIST            12060003
         LA    R2,INTREGSV    R2= ADDR OF THE RETURN CODE               12070003
         LA    R3,ZEROS       R3= ADDR OF WORD OF ZEROS                 12080003
         LA    R4,HONES       R4= ADDR OF HALF WORD OF A ONE            12090003
         STM   R1,R4,EFF18PRM SETUP THE IKJEFF18 PARM LIST              12100003
         LINK  EP=IKJEFF18,ERRET=LINKEFF1,MF=(E,EFF18PRM) LINK TO EFF18 12110003
         LA    R3,TESTFAIL    R3= ADDR OF TEST FAILED                   12120003
         SR    R4,R4          ZERO R4 NO SECOND LEVEL                   12130003
         B     PUTRTURN       PRINT MESSAGE AND QUIT                    12140003
         EJECT                                                          12150003
*********************************************************************** 12160003
*                                                                     * 12170003
*        STAE RETRY ROUTINE.                                          * 12180003
*                                                                     * 12190003
*        DETERMINE IF THE ABEND WAS PREDICTED.  IF SO, DETACH ANY     * 12200003
*        SUB-TASK WHICH MAY EXIST AND WRITE THE PROPER DIAGNOSTIC.    * 12210003
*        OTHERWISE, WRITE AN 'UNPREDICTABLE ERROR' DIAGNOSTIC 2ND     * 12220003
*        LEVEL MESSAGE AND RETURN TO THE TMP.                         * 12230003
*                                                                     * 12240003
*********************************************************************** 12250003
         SPACE 2                                                        12262003
HOMEBASE EQU   *                                                        12271003
         USING *,R15          RETRY ROUTINE.                            12280003
         SPACE                                                          12289003
SETREGS  EQU   *              SET UP BASIC PROCESSING REGISTERS         12298003
         L     R2,CVTPTR      CVT POINTER                               12307003
         USING CVT,R2         ADDRESSABILITY TO CVT.                    12316003
         L     R3,CVTTCBP     NEW/CURRENT WORDS.                        12325003
         L     R4,X4(,R3)     CURRENT TCB.                              12334003
         USING TCB,R4         ADDRESSABILITY TO TCB.                    12343003
         L     R7,TCBNSTAE    SCB ADDRESS.                              12360003
         LM    R7,R10,N0(R7)  LINK , EXIT EP , TCOMTAB , PRB            12370003
         SPACE                                                          12380003
         DROP  R2,R4                                                    12390003
         L     R12,BASEAD     SETUP THE BASE REGISTER.                  12400003
         DROP  R15            RESET ORIGINAL ADDRESSABILITY             12410003
         USING IKJEGINT,R12   *                                         12420003
         L     R9,TCBTRN-TCB(,R4) ADDRESS OF TCOMTAB.                   12430003
         L     R13,REGSAVE1   RELOAD SAVE AREA ADDRESS.                 12440003
         L     R8,N0(,R13)    GET IKJEGINT WORKAREA ADDRESS.            12450003
         L     R10,TPLPTR     SETUP ADDRESSABILITY TO TPL               12460003
         B     TSTRTURN       OUT MSG AND EXIT TO TMP                   12470003
         EJECT                                                          12480003
**********************************************************************  12490003
*        ERROR HANDLER ROUTINES, FOR LINK FAILED, GETMAIN FAILED,       12500003
*        AND FREEMAIN FAILED.                                           12510003
**********************************************************************  12520003
         SPACE                                                          12530003
LINKPARS EQU   *              LINK TO PARSE FAILED                      12540003
         LA    R2,PARSENO     R2= NUMBER FOR PARSE IN STATIC TABLE      12550003
         B     LINKFAIL       OUTPUT THE ERROR MESSAGE                  12562003
         SPACE                                                          12570003
LINKEFF1 EQU   *              LINK TO IKJEFF18 FAILED                   12580003
         LA    R2,EFF18NO     R2= NUMBER FOR IKJEFF18 IN STATIC TABLE   12590003
         B     LINKFAIL       OUTPUT THE ERROR MESSAGE                  12600003
         SPACE                                                          12610003
LINKDEFL EQU   *              LINK TO IKJDFLT FAILED                    12620003
         LA    R2,DEFLTNO     R2= NUMBER FOR DEFAULT IN STATIC TABLE    12630003
         B     LINKFAIL       OUTPUT THE ERROR MESSAGE                  12640003
         SPACE                                                          12650003
LINKDAIR EQU   *              LINK TO DAIR FAILED                       12660003
         LA    R2,DAIRNO      R2= NUMBER FOR DAIR IN STATIC TABLE       12670003
         SPACE                                                          12680003
**********************************************************************  12690003
*        THIS IS THE LINK FAILED VERSION OF THE IKJEGSIO MACRO          12700003
**********************************************************************  12710003
         SPACE                                                          12720003
LINKFAIL EQU   *              LINKFAILED CALL TO IKJEGIO                12730003
         LR    R3,R15         R3= ADDRESS OF THE RETURN CODE            12740003
         LR    R4,R1          R4= ADDRESS OF THE ABEND CODE             12750003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          12760003
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R4),RC=(R3),INST11=(NUM,(R2)), X12770003
               ID=INT15,MF=(E,TSTIOPRM)  ISSUE MACRO TO CALL IKJEGIO    12780003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       12790003
         BNZ   TMPRTURN       YES THEREFORE EXIT TO TMP                 12800003
         B     TSTRTURN       OUTPUT THE ERROR AND EXIT TO TMP          12810003
         SPACE                                                          12820003
****                                                                    12830003
****     GETMAIN FAILED ERROR HANDLER PORTION OF IKJEGINT               12840003
****                                                                    12850003
         SPACE                                                          12860003
GETERROR EQU   *              A GETMAIN FAILED                          12870003
         LR    R3,R15         R3= THE RETURN CODE                       12880003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          12890003
         IKJEGSIO SVCERR,SVC=10,RC=(R3),ID=INT15,MF=(E,TSTIOPRM)        12900003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       12910003
         BNZ   TMPRTURN       YES THEREFORE EXIT TO TMP                 12920003
         B     TSTRTURN       OUTPUT THE ERROR AND EXIT TO TMP          12930003
****                                                                    12940003
****     FREEMAIN FAILED ERROR HANDLER PORTION OF IKJEGINT              12950003
****                                                                    12960003
         SPACE                                                          12970003
FREERROR EQU   *              A FREEMAIN FAILED                         12980003
         LR    R3,R15         R3= THE RETURN CODE                       12990003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          13000003
         IKJEGSIO SVCERR,SVC=10,RC=(R3),ID=INT15,MF=(E,TSTIOPRM)        13010003
         B     FREETABL(R15)  BRANCH ON RETURN CODE                     13020003
FREETABL EQU   *              TABLE FOR IO RETURN CODES                 13030003
         B     RETCALL        RC=0 RETURN TO WHERE FREEMAIN ISSUED      13040003
         B     RETCALL        RC=4 RETURN TO WHERE FREEMAIN ISSUED      13050003
         B     TSTRTURN       RC=8 THEREFORE EXIT TO TMP                13060003
         B     RETCALL        RC=12 RETURN TO WHERE FREEMAIN ISSUED     13070003
         B     TMPRTURN       RC=16 THEREFORE EXIT TO TMP               13080003
         B     TSTRTURN       RC=20 THEREFORE EXIT TO TMP               13090003
         B     TMPRTURN       RC=24 THEREFORE EXIT TO TMP               13100003
TSTRTURN EQU   *              TEST FAILED MESSAGE AND EXIT              13110003
         LA    R3,TESTFAIL    R3= NUMBER OF TEST FAILED                 13120003
         LA    R4,N0          R4= ZERO NO SECOND LEVEL                  13130003
         B     PUTRTURN       GO OUTPUT MESSAGE                         13140003
RETCALL  EQU   *              RETURN TO CALLER                          13150003
         BR    R11            RETURN TO WHERE THE FREEMAIN WAS ISSUED   13160003
****                                                                    13170003
****     ESTAE FAILED ERROR HANDLER PORTION OF IKJEGINT                 13180003
****                                                                    13190003
         SPACE                                                          13200003
ESTAERR  EQU   *              A ESTAE FAILED                            13210003
         LR    R3,R15         R3= THE RETURN CODE                       13220003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          13230003
         IKJEGSIO SVCERR,SVC=60,RC=(R3),ID=INT15,MF=(E,TSTIOPRM)        13240003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       13250003
         BNZ   TMPRTURN       YES THEREFORE EXIT TO TMP                 13260003
         LA    R3,TESTFAIL    R3= NUMBER OF TEST FAILED                 13270003
         LA    R4,N0          R4= ZERO NO SECOND LEVEL                  13280003
         B     PUTRTURN       OUTPUT THE ERROR AND EXIT TO TMP          13290003
****                                                                    13300003
****     SVC 97 FAILED OUTPUT BREAKPOINT ERROR MSG                      13310003
***                                                                     13320003
SVC97ERR EQU   *              SVC 97 NONZERO RETURN CODE                13330003
         LA    R2,N24         R2= 24 (ESTAE MACRO FAILURE RETURN CODE   13340003
         CR    R2,R15         IS THAT THE RETURN CODE FROM SVC 97       13343001
*                                                              @ZA05803 13346001
         BE    ESTAERR        YES THEREFORE HANDLE ERROR       @ZA05803 13350001
         LA    R3,TESTFAIL    R3= TEST FAILED MESSAGE                   13370003
         LA    R4,SVCFAIL     R4= SECOND LEVEL SVC ERROR                13380003
         EJECT                                                          13390003
**********************************************************************  13400003
*        THIS ROUTINE OUTPUT A MESSAGE AS INDICATED IN R3, AND R4       13410003
*        THAT IS FIRST AND SECOND LEVEL... (NO INSERTS).........        13420003
**********************************************************************  13430003
         SPACE                                                          13440003
PUTRTURN EQU   *              ISSUE MSG FROM OF IO                      13450003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          13460003
         IKJEGSIO MSG,FIRST=(R3),SECOND=(R4),ID=INT15,MF=(E,TSTIOPRM)   13470003
         SPACE                                                          13480003
****                                                                    13490003
****     WE ALWAYS EXIT THEREFORE RETURN CODES ARE IGNORED              13500003
****                                                                    13510003
         B     TMPRTURN                                                 13520003
         EJECT                                                          13530003
ADDCB    DCB   DSORG=PO,MACRF=(R) DEFINE A DCB.                         13540003
ADDCBLEN EQU   *-ADDCB        DCB LENGTH.                               13550003
         SPACE 5                                                        13560003
LFORM    OPEN  (,(INPUT)),MF=L OPEN LIST FORM.                          13570003
         SPACE 5                                                        13580003
CLFORM   CLOSE (CLFORM),MF=L  CLOSE LIST FORM.                          13590003
         SPACE 5                                                        13600003
         DS    0F             ALIGN ON WORD BOUNDARY.                   13610003
INTBLDLD DC    H'1'           NUMBER OF ENTRIES IN LIST.                13620003
         DC    H'58'          LENGTH OF DIRECTORY ENTRY.                13630003
         DC    CL8' '         MEMBER NAME.                              13640003
INTBLDLL EQU   *-INTBLDLD     LENGTH OF CONSTANT.                       13650003
ABENDCOD DC    CL16'SYSTEM CODE XXX '  FOR 2ND LEVEL MESSAGE.           13660003
         SPACE 5                                                        13670003
         DS    0F                                                       13680003
TCOMTABL DC    AL1(0)         SUBPOOL IDENTIFIER.                       13690003
         DC    AL3(TCOMLEN+OUTBUFRL+CONAREAL+CWORKLEN+REGSAVEL)         13700003
*                             LENGTH OF TCOMTAB, OUTPUT BUFFER,         13710003
*                             CONVERT WORKAREA, GENERAL PURPOSE         13720003
*                             WORKAREA, REGISTER SAVEAREAS FOR          13730003
*                             GETMAIN, AND GENERAL WORKAREA.            13740003
INTSVIBL DC    AL1(0)         SUBPOOL IDENTIFIER.                       13750003
         DC    AL3(12)        LENGTH OF CONTROL BLOCK FOR -             13760003
*                             +0 LINK FIELD                             13770003
*                             +4 TCB POINTER                            13780003
*                             +8 SVC INFORMATION BLOCK POINTER          13790003
LOAD     DC    C'LOAD    '    'LOAD' DEFAULT QUALIFIER.                 13800003
OBJECT   DC    C'OBJ     '    'OBJECT' DEFAULT QUALIFIER.               13810003
MNLADDR  DC    V(IKJEGMNL)    ADDRESS OF IKJEGMNL                       13820003
IOADDR   DC    V(IKJEGIO)     ADDRESS OF THE IO MODULE                  13830003
CVTBDSTA DC    V(IKJEGCVT)    ADDR OF IKJEGCVT                          13840003
         DC    V(IKJEGBLD)    ADDR OF IKJEGBLD                          13850003
         DC    V(IKJEGSTA)    ADDRESS OF IKJEGSTA FOR TCOMTAB           13860003
SRHRTVCN DC    V(IKJEGSRH)    ADDRESS OF IKJEGSRH                       13870003
OPCODV   DC    V(IKJEGCOP)    ADDR OF THE 360 OP CODE TABLE (1 BYTE)    13880003
         DC    V(IKJEGCD2)    ADDR OF 370 OP CODE TABLE (2 BYTE)        13890003
HIGHBIT  DC    X'80000000'    'OR' IN HIGH BIT.                         13900003
POST7F   DC    X'3F000000'    POST STAI EXIT WITH A '7F'                13910003
ZEROS    DC    X'00000000'    WORD OF ZEROS                             13920003
BASEAD   DC    A(IKJEGINT)    BASE ADDRESS FOR THIS MODULE.             13930003
CORE104  DC    AL1(0),AL3(104)  104 BYTE STAE W.A.                      13940003
INTRC004 DC    H'4'           RETURN CODE = 4.                          13950003
INTRC008 DC    H'8'           RETURN CODE = 8.                          13960003
INTRC016 DC    H'16'          RETURN CODE = 16.                         13970003
INTRC024 DC    H'24'          RETURN CODE = 24.                         13980003
HONES    DC    H'1'           HALF WORD OF A ONE                        13990003
PCLADDR  DC    V(IKJEGYNT)    *                                         14000003
SP1      DC    X'01000000'    SUB-POOL ONE INDICATOR.                   14010003
SVC      SVC   TESTSVC        TEST SVC                                  14020003
         SVC   EXITSVC        EXIT SVC                                  14030003
         EJECT                                                          14040003
         IKJDAP08                                                       14050003
DA08LEN  EQU   *              DSECT LENGTH                              14060003
IKJEGINT CSECT                                                          14070003
DAIR08   DC    (DA08LEN-DAPB08)X'0'  INITIALIZE BEFORE ORGS             14080003
         ORG   DA08CD-DAPB08+DAIR08    *                                14090003
         DC    XL2'0008'      CODE                                      14100003
         ORG   DA08DDN-DAPB08+DAIR08   *                                14110003
         DC    CL8' '         DDNAME                                    14120003
         ORG   DA08UNIT-DAPB08+DAIR08  *                                14130003
         DC    CL8' '         UNITNAME                                  14140003
         ORG   DA08SER-DAPB08+DAIR08   *                                14150003
         DC    CL8' '         VOLUME SERIAL NUMBER                      14160003
         ORG   DA08MNM-DAPB08+DAIR08   *                                14170003
         DC    CL8' '         MEMBER NAME                               14180003
         ORG   DA08PSWD-DAPB08+DAIR08  *                                14190003
         DC    CL8' '         PASSWORD                                  14200003
         ORG   DA08DSP1-DAPB08+DAIR08  *                                14210003
         DC    AL1(DA08SHR)   DISP=SHR                                  14220003
         ORG   DA08LEN-DAPB08+DAIR08   *                                14230003
LEN08    EQU   *-DAIR08       *                                         14240003
         EJECT                                                          14250003
         IKJDAP1C                                                       14260003
DA1CLEN  EQU   *              DSECT LENGTH                              14270003
IKJEGINT CSECT                                                          14280003
DAIR1C   DC    (DA1CLEN-DAPB1C)X'0'  INITIALIZE BEFORE ORGS             14290003
         ORG   DA1CCD-DAPB1C+DAIR1C    *                                14300003
         DC    XL2'001C'      CODE                                      14310003
         ORG   DA1CDDN-DAPB1C+DAIR1C   *                                14320003
         DC    CL8' '         DDNAME                                    14330003
         ORG   DA1CLEN-DAPB1C+DAIR1C   *                                14340003
LEN1C    EQU   *-DAIR1C       *                                         14350003
         EJECT                                                          14360003
         IKJDAP2C                                                       14370003
DA2CLEN  EQU   *              DSECT LENGTH                              14380003
IKJEGINT CSECT                                                          14390003
DAIR2C   DC    (DA2CLEN-DAPB2C)X'0'  INITIALIZE BEFORE ORGS             14400003
         ORG   DA2CCD-DAPB2C+DAIR2C    *                                14410003
         DC    XL2'002C'      CODE                                      14420003
         ORG   DA2CLEN-DAPB2C+DAIR2C   *                                14430003
LEN2C    EQU   *-DAIR2C       *                                         14440003
         EJECT                                                          14450003
ABENDLST DS    0F                                                       14460003
         DC    AL1(99)        ABEND KEY                                 14470003
         DC    AL3(BLOW5)     LINK TO PARSE FAILURE.                    14480003
         SPACE 1                                                        14490003
         DC    AL1(95)        ABEND KEY                                 14500003
         DC    AL3(BLOW6)     ATTACH IKJEGLDR FAILURE.                  14510003
         SPACE 1                                                        14520003
         DC    XL1'FF'        END-OF-LIST FLAG.                         14530003
         SPACE 2                                                        14540003
INTSPL   IKJEGSPL RTRY=HOMEBASE,ABNTB=ABENDLST,MODNM=IKJEGINT,         *14550003
               TNM=INITIALIZATION                                       14560003
         SPACE 2                                                        14570003
TRTABLE  DC    C'0123456789'  HEX-CHARACTER CONVERSION TABLE.           14580003
         DC    C'ABCDEF'      *                                         14590003
TEMPNAME DC    A(*+4),C'TEMPNAME' THIS IS THE MEMBER NAME IF NONE .     14600003
TEST     DC    CL8'TEST'      TEST CONSTANT                             14610003
ABEND    DC    X'000D'        ABEND CONSTANT                            14620003
         SPACE 2                                                        14630003
MEMMVC   MVC   X4(*-*,R5),N0(R6)  *                                     14640003
DSNMVC   MVC   INTSTDSN(*-*),N0(R2)  *                                  14650003
MEMMOVE  MVC   INTDAIRB+(DA08MNM-DAPB08)(*-*),N0(R4)  *                 14660003
MOVEPASS MVC   INTDAIRB+(DA08PSWD-DAPB08)(*-*),N0(R4) MOVE THE PASSWORD 14670003
QUALCHK  CLC   X1(*-*,R5),N0(R2) CHECK FOR EQUAL QUALIFIERS      A43321 14680003
CLCID    CLC   N0(*-*,R3),UPTPREFX-UPT(R4) COMPARE PREFIXES    @ZA05807 14685001
MOVEMEMB MVC   X4(*-*,R6),N0(R3)  MOVE MEMBER NAME TO MESSAGE           14700003
         SPACE 5                                                        14710003
STACKLST STACK DELETE=ALL,MF=L       LIST FORM.                         14720003
STACKLEN EQU   *-STACKLST     LENGTH OF STACK LIST.                     14730003
         SPACE 5                                                        14740003
ATTCHLFM ATTACH EP=IKJEGLDR,SF=L                                        14750003
ATTCHLLN EQU   *-ATTCHLFM                                               14760003
         EJECT                                                          14770003
IKJEGYNT IKJPARM                                                        14780003
DSNAME   IKJPOSIT DSNAME,PROMPT='DSNAME'                                14790003
STRING   IKJPOSIT QSTRING                                               14800003
LOADOBJ  IKJKEYWD DEFAULT='LOAD'                                        14810003
         IKJNAME 'LOAD'                                                 14820003
         IKJNAME 'OBJECT'                                               14830003
CPNOCP   IKJKEYWD DEFAULT='NOCP'                                        14840003
         IKJNAME 'CP'                                                   14850003
         IKJNAME 'NOCP'                                                 14860003
         IKJENDP                                                        14870003
         EJECT                                                          14880003
*              GENERAL EQUATES.                                         14890003
N0       EQU   0              DECIMAL 0                                 14900003
X0       EQU   0              HEXIDECIMAL 0                             14910003
X1       EQU   1              HEXIDECIMAL 1                             14920003
X2       EQU   2              HEXIDECIMAL 2                             14930003
X4       EQU   4              HEXIDECIMAL 4                             14940003
X5       EQU   5              HEXIDECIMAL 5                             14950003
X6       EQU   6              HEXIDECIMAL 6                             14960003
X8       EQU   8              HEXIDECIMAL 8                             14970003
N4       EQU   4              DECIMAL FOUR                              14980003
N12      EQU   12             TWELVE                                    14990003
N13      EQU   13             THIRTEEN.                                 15000003
N16      EQU   16             SIXTEEN.                                  15010003
N20      EQU   20             TWENTY                                    15020003
N24      EQU   24             TWENTY FOUR                               15030003
N28      EQU   28             TWENTY EIGHT                              15040003
N35      EQU   35             THIRTY FIVE.                              15050003
N39      EQU   39             THIRTY NINE                               15060003
N40      EQU   40             FOURTY                                    15070003
N64      EQU   64             SIXTY FOUR.                               15080003
N72      EQU   72             SEVENTY TWO.                              15090003
N100     EQU   100            ONE HUNDRED (DCB GETMAIN LENGTH)          15100003
X40      EQU   X'40'          HEXIDECIMAL 40                            15110003
X80      EQU   X'80'          HEXIDECIMAL 80                            15120003
XFF      EQU   X'FF'          HEXIDECIMAL FF                            15130003
* --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *           15140003
TESTSVC  EQU   97             TEST'S SVC                                15150003
EXITSVC  EQU   3              EXIT SVC NUMBER                           15160003
* --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *           15170003
PASSWORD EQU   DSNAME+16      POINTER,LEN,FLGS,RES                      15180003
INDSNPER EQU   C'.'           CHARACTER PERIOD.                  A43321 15190003
BLANK    EQU   C' '           THIS IS A BLANK (X'40').                  15200003
LOADON   EQU   1                                                        15210003
PRESENT  EQU   X'80'          PRESENT -- NOT ABSENT                     15220003
PS       EQU   X'40'          PHYSICAL SEQUENTIAL                       15230003
OBJON    EQU   2              INDICATES OBJECT                          15240003
Z        EQU   8              ZERO CONDITION CODE                       15250003
NEG      EQU   4              NEGATIVE CONDITION.                       15260003
X44      EQU   X'44'          HEXIDECIMAL 44.                           15270003
FULLQUAL EQU   B'01000000'    BIT TO INDICATE 'FULLY-QUALIFIED'.        15280003
         EJECT                                                          15290003
         TCOMTAB                                                        15300003
         EJECT                                                          15310003
         IKJDFPL                                                        15320003
         EJECT                                                          15330003
         IKJDFPB                                                 A43321 15340003
         EJECT                                                          15350003
         TSTCWORK                                                       15360003
         EJECT                                                          15370003
         DCBD  DSORG=PO,DEVD=DA                                         15380003
         EJECT                                                          15390003
INTWKARA DSECT                                                          15400003
INTPARSL DS    6F             PARSE SERVICE ROUTINE PARAMETER           15410003
*                             LIST.                                     15420003
INTRSVD1 DS    2F             RESERVED SPACE.                           15430003
         ORG   INTPARSL       ORIGIN TO BEGINNING OF WORK AREA.         15440003
INDFLTPL DS    4F             DEFAULT SERVICE ROUTINE PARAMETER         15450003
*                             LIST.                                     15460003
INDFLTPB DS    3F             DEFAULT SERVICE ROUTINE PARAMETER         15470003
*                             BLOCK.                                    15480003
         ORG   INTPARSL       ORIGIN TO BEGINNING OF WORK AREA.         15490003
INSTCKPL DS    4F             STACK SERVICE ROUTINE PARAMETER LIST      15500003
INSTCKPB DS    2F             STACK SERVICE ROUTINE PARAMETER BLOCK     15510003
         ORG   ,              ORIGIN TO RESTART WORK AREA.              15520003
INTRSVD2 DS    H              RESERVED SPACE.                           15530003
INDSNLEN DS    H              LENGTH OF DATA SET NAME.                  15540003
INTSTDSN DS    CL44           DATA SET NAME FROM TEST COMMAND.          15550003
INTFLGS1 DS    X              INITIALIZATION FLAGS.                     15560003
INTDSMEM EQU   X'80'          ALLOCATE TO MEMBER SPECIFIED ON           15570003
*                             THE TEST COMMAND.                         15580003
         ORG   INTPARSL       ORIGIN TO BEGINNING OF WORK AREA.         15590003
INTDAIRL DS    1F             DAIR SERVICE ROUTINE PARAMETER LIST       15600003
INTDAIR2 DS    1F             SECOND WORD OF DAIR LIST                  15610003
INTDAIR3 DS    3F             THIRD WORD OF DAIR LIST                   15620003
         ORG   ,              ORIGIN TO RESTART WORK AREA.              15630003
         DS    0F             ALIGN ON WORD BOUNDARY.                   15640003
INTDAIRB DS    (DA08LEN-DAPB08)X DAIR SERVICE ROUTINE PARAMETER         15650003
*                             BLOCK.                                    15660003
INTOPENL DS    F              OPEN PARAMETER LIST.                      15670003
INTCLOSL DS    F              CLOSE PARAMETER LIST.                     15680003
EFF18PRM DS    0F             ALSO  IKJEFF18 PARM LIST                  15690003
INTSVCPL DS    3F             SVC 97 PARAMETER LIST.                    15700003
INTATCHL DS    XL(ATTCHLLN)   ATTACH PARAMETER LIST FOR ATTACH.         15710003
INTREGSV DS    1F             SAVE AREA FOR RETURN CODES                15720003
INITFLG  DS    1F             INIT. FLAGS                   @ZA18794    15725001
INTWLEN  EQU   *-INTWKARA     LENGTH OF WORKAREA.                       15730003
         EJECT                                                          15740003
         IKJTPL                                                         15750003
         EJECT                                                          15760003
         IKJPSCB                                                        15770003
         EJECT                                                          15780003
         IKJTCB                                                         15790003
         EJECT                                                          15800003
         IKJECT                                                         15810003
         EJECT                                                          15820003
*        PARSE                                                          15830003
         IKJPPL                                                         15840003
         EJECT                                                          15850003
*        DAIR                                                           15860003
         IKJDAPL                                                        15870003
         EJECT                                                          15880003
         CVT   DSECT=YES                                                15890003
         EJECT                                                          15900003
         IKJRB                                                          15910003
         EJECT                                                          15920003
         IHAPDS                                                         15930003
         EJECT                                                          15940003
         IKJUPT                                                         15950003
         EJECT                                                          15960003
         IHACDE                                                         15970003
         EJECT                                                          15980003
         IKJEGSVQ                                                       15990003
         EJECT                                                          16000003
IKJEGINT CSECT                                                          16010003
PATCHSP  DC    50C'Z'         PATCH AREA.                               16020003
         END   IKJEGINT                                                 16050003
