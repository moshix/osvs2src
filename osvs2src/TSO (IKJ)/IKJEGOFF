         COPY  IKJEGSIO                                                 00100102
         MACRO                                                          00102002
         EXPRPDE                                                        00110002
*********************************************************************** 00112002
*                                                                     * 00114002
*        MAPPING DSECT FOR PDES FOR EXPRESSIONS                       * 00116002
*                                                                     * 00118002
*        STATUS -- VERSION NO. 01 - AOS/2 RELEASE NO. 01              * 00118402
*                                                                     * 00118802
*        CHANGE LEVEL -- 00 - DATE 09/29/71                           * 00119202
*                                                                     * 00119602
*********************************************************************** 00119702
EXPRPDE  DSECT                                                          00119802
EXPRPTR  DS    F -                      POINTER TO CHARACTER STRING,    00119902
*                                       OR ZERO IF NOT PRESENT          00136602
EXPRLNH  DS    H -                      LENGTH OF CHARACTER STRING      00146602
         DS    H -                      RESERVED                        00148602
EXPRFLGS DS    XL1 -                    FLAGS                           00150602
EXPRDEC  EQU   X'04' -                  DECIMAL EXPRESSION FLAG         00152602
EXPRHEX  EQU   X'02' -                  HEX EXPRESSION FLAG             00153002
EXPRSIGN DS    CL1 -                    ARITHMETIC SIGN OR ZERO         00153102
EXPRINDC DS    H -                      INDIRECT COUNT                  00153202
EXPRCHAI DS    F -                      POINTER TO NEXT EXPRESSION      00158802
*                                       PDE OR ZERO                     00160802
EXPRPDL  EQU   *-EXPRPDE -              LENGTH OF EXPRESSION PDE        00162802
         MEND                                                           00163202
         EJECT                                                          00163602
OFF      TITLE 'IKJEGOFF, OFF COMMAND PROCESSOR  OF TEST'               00170002
IKJEGOFF CSECT                     OFF COMMAND PROCESSOR                00180002
*C476400                                                         YM2245 00190002
*C489900                                                         YM4849 00200002
*C531279                                                       @YM07108 00210002
         SPACE 2                                                        00220002
************************************************************            00270002
*                                                         **            00320002
* STATUS                                                  **            00370002
*    CHANGE LEVEL 00, VERSION NUMBER 01, OS/VS2           **            00420002
*                                                         **            00470002
* FUNCTION                                                **            00520002
*    OFF BASICALLY REMOVES WHATEVER BREAKPOINTS THE 'AT'  **            00570002
*    SUB-COMMAND HAD ESTABLISHED. IT HAS THE FACILITY TO  **            00620002
*    REMOVE ALL THE BREAKPOINTS IN EFFECT, OR ONLY THOSE  **            00670002
*    SPECIFIED BY THE USER.                               **            00672002
*                                                         **            00674002
*    WHEN PARAMETERS HAVE BEEN ENTERED PARSE IS CALLED    **            00680002
*    IS PARSE THE INPUT STGRING. PARSE INVOKES 'OFF'      **            00690002
*    VALIDITY CHECK ROUTINE WHICH GOES TO CONVERT 'CVT'   **            00700002
*    TO CONVERT THE ADDRESS PDE. IF CONVERT RETURNS WITH  **            00710002
*    THAT ADDRESS IS SEARCH FOR ON THE ACTIVE QUEUE,      **            00712002
*    (BREAKTAB OF TCOMTAB). NEXT THE DEFERED QUEUE        **            00714002
*    (DEFERTAB OF TCOMTAB), IS SEARCH FOR THE ADDRESS.    **            00716002
*    WHEN SEARCHING THE DEFERED QUEUE A FULLY QUALIFIED   **            00718002
*    ADDRESS MUST HAVE BEEN SPECIFIED.                    **            00718402
*    ALL REFERENCES TO THAT BREAKELEMENT ARE REMOVED FROM **            00718802
*    BOTH QUEUE'S. IF IT WAS AN ACTIVE BREAKPOINT AN      **            00719202
*    ATTEMPT IS MADE TO RESTORE THE PROBLEM PROGRAM INSTR.**            00719602
*                                                         **            00719702
*    END PROCESSING IS DETERMINED BY THE ENDSW OR  RUNSW  **            00719802
*    BEING ON. (ENDSW AND RUNSW ARE IN TCOMTAB).          **            00719902
*    DURNING END PROCESSING ALL BREAKS POINTS ARE         **            00748602
*    REMOVED AS IF NO PARAMETERS WHERE ENTERED ON A       **            00750602
*    'OFF' COMMAND.                                       **            00752602
*                                                         **            01770002
* ENTRY POINTS                                            **            01820002
*         IKJEGOFF - MAIN ENTRY POINT                     **            01870002
*         IKJEGVCK - VALIDITY CHECK ROUTINE               **            01920002
*                                                         **            01970002
* INPUT                                                   **            02020002
*    ONE OR MORE LINES OF INPUT FROM THE TERMINAL INTO    **            02070002
*    THE INPUT BUFFER.                                    **            02120002
*                                                         **            02170002
* OUTPUT                                                  **            02220002
*    1.  ERROR MESSAGES TO THE MESSAGE WRITER             **            02270002
*    2.  RETURN CODES                                     **            02320002
*    *          00 - SUCCESSFUL COMPLETION OR BREAKPOINTS **            02370002
*    *               NOT REMOVED                          **            02420002
*    *          08 - HAVE PARSE ISSUE A 'REENTER'         **            02470002
*    *          12 - PARSE VALIDITY CHECK EXIT ERROR      **            02520002
*    *               RETURN CODE                                        02570002
*    *          16 - AN ATTENTION HAS BEEN SCHEDULED      **            02620002
*    *          20 - STAE RETRY HAS INTERCEPTED AN ABEND  **            02670002
*    *          24 - COULD NOT ISSUE ESTAE MACRO          **            02680002
*                                                         **            02720002
* EXTERNAL REFERENCES                                     **            02770002
*         IKJPARS - CHECKS SYNTAX OF ADDRESSES            **            02820002
*                                                         **            02830002
*         ESTAE   - ESTABLISH ABEND RECOVERY EXIT RTN     **            02840002
*         *         (IKJEGSTA)                            **            02850002
*                                                         **            02870002
*         IKJEGIO - IS INVOKED VIA THE IKJEGSIO MACRO     **            02920002
*                   TO PRINT ERROR MESSAGES.              **            02970002
*                                                         **            03070002
*         IKJEGCVT - CONVERTS AN ABSOLUTE ADDRESS, AN     **            03120002
*         *          EXPRESSION, AN INDIRECT ADDRESS, OR  **            03170002
*         *          A FULLY QUALIFIED ADDRESS TO BINARY. **            03220002
*         *          AT ENTRY, REG 1 CONTAINS THE         **            03270002
*         *          COMPLEMENT OF THE PDL ADDRESS TO     **            03320002
*         *          INDICATE AN ADDRESS CONVERSION, AND  **            03370002
*         *          REG 0 IS SET NEGATIVE TO INDICATE    **            03420002
*         *          CONVERT TO BINARY.                   **            03470002
*                                                         **            03520002
* EXITS, NORMAL                                           **            03570002
*    RETURN TO MAINLINE VIA REGISTER 14                   **            03620002
*                                                         **            03670002
* EXITS, ERROR                                            **            03720002
*    RETURN TO MAINLINE VIA REGISTER 14                   **            03770002
*                                                         **            03820002
* TABLES/WORK AREAS                                       **            03870002
*    TCOMTAB -                                            **            03920002
*    *     BREAKTAB - PTR TO ACTIVE BREAK ELEMENTS        **            03970002
*    *     DEFERTAB - PTR TO DEFERRED BREAK ELEMENTS      **            04020002
*    OFFWORKA - OFF'S WORKAREA                            **            04070002
*                                                         **            04120002
* ATTRIBUTES                                              **            04170002
*    REENTRANT AND REFRESHABLE                            **            04220002
*                                                         **            04270002
* CHARACTER CODE DEPENDENCY                               **            04320002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL**            04370002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS**            04420002
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE     **            04470002
*    CODING HAS BEEN ARRANGED SO THAT REDEFINITION OF     **            04520002
*    'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL RESULT IN **            04570002
*    A CORRECT MODULE FOR THE NEW DEFINITIONS.            **            04620002
*                                                         **            04670002
* NOTES                                                   **            04720002
*                                                         **            04770002
************************************************************            04820002
         EJECT                                                          04870002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04920002
*        THE FOLLOWING ARE THE EQUATES NEEDED BY THE OFF COMMAND        04970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05020002
         SPACE                                                          05070002
*        REGISTER EQUATES                                               05120002
R0       EQU   0                   GENERAL WORK REGISTER                05170002
R1       EQU   1                   GENERAL WORK REGISTER (PARAM PASS)   05220002
R2       EQU   2                   GENERAL WORK REGISTER                05270002
R3       EQU   3                   GENERAL WORK REGISTER                05320002
R4       EQU   4                   GENERAL WORK REGISTER                05370002
R5       EQU   5                   GENERAL WORK REGISTER                05420002
R6       EQU   6                   BASE REGISTER FOR CONTROL BLOCKS     05470002
R7       EQU   7                   BASE REGISTER FOR DEFER & ACTIVE Q   05520002
R8       EQU   8                   BASE REGISTER FOR TEMPORARY USE      05570002
R9       EQU   9                   BASE REGISTER FOR TCOMTAB            05620002
R10      EQU   10                  BASE REGISTER FOR OFFWORK AREA       05670002
R11      EQU   11                  EXTRA REGISTER NOT USED              05720002
R12      EQU   12                  BASE REGISTER FOR IKJEGOFF           05770002
R13      EQU   13                  POINTER TO SAVE AREA                 05820002
R14      EQU   14                  USED FOR BAL ALSO WORK REG           05870002
R15      EQU   15                  USED FOR RETURN CODES ALSO WORK REG  05920002
         SPACE                                                          05970002
N0       EQU   0                   CONSTANT 0                           06020002
N1       EQU   1                   CONSTANT 1                           06070002
N2       EQU   2                   CONSTANT 2                           06120002
N3       EQU   3                   CONSTANT 3                           06170002
N4       EQU   4                   CONSTANT 4                           06220002
N5       EQU   5                   CONSTANT 5                           06270002
N6       EQU   6                   CONSTANT 6                           06320002
N7       EQU   7                   CONSTANT 7                           06370002
N8       EQU   8                   CONSTANT 8                           06420002
N9       EQU   9                   CONSTANT 9                           06470002
N10      EQU   10                  CONSTANT 10                          06520002
N12      EQU   12                  CONSTANT 12                          06570002
N16      EQU   16                  CONSTANT 16                          06620002
N20      EQU   20                  CONSTANT 20                          06670002
N24      EQU   24                  CONSTANT 24                          06680002
N32      EQU   32                  CONSTANT 32                          06720002
N56      EQU   56                  CONSTANT 56                          06770002
N60      EQU   60                  CONSTANT 60                          06780002
N72      EQU   72                  CONSTANT 72                          06820002
N120     EQU   120                 CONSTANT 120                         06830002
****     HEXIDECIMAL EQUATES                                            06870002
HEXC0    EQU   X'C0'               HEX CONSTANT C0                      06920002
HEX09    EQU   X'09'               HEX CONSTANT 09                      06930002
HEXFF    EQU   X'FF'               HEX CONSTANT FF                      06970002
HEX0C    EQU   X'0C'               HEX CONSTANT 0C                      07020002
HEX10    EQU   X'10'               HEX CONSTANT 10                      07070002
         EJECT                                                          07120002
         ENTRY IKJEGVCK            ENTRY POINT OF THE VALIDITY CHECK    07170002
OFFSTART DS    0H                  STARTING POSITION OF OFF             07220002
         SAVE  (14,12),,*          SAVE THE CALLERS REGISTERS           07270002
         LR    R12,R15             SETUP REG 12 AS OFF'S BASE           07320002
         USING OFFSTART,R12        ESTABLISH ADDRESSIBILITY             07370002
         USING TCOMTAB,R9          ESTABLISH ADDRESSIBILITY TO TCOMTAB  07420002
         L     R15,REGSAVE2        LOAD ADDR OF NEW SAVEAREA (OFF'S)    07470002
         ST    R13,N4(R15)         PLACE ADDR USER'S SAVEAREA INTO OFF  07520002
         ST    R15,N8(R13)         PLACE ADDR OFF SAVEAREA INTO USERS   07570002
         LR    R13,R15             R13= ADDR OF NEW SAVE AREA           07620002
****     ESTABLISH ADDRESSIBILITY TO OFF WORKAREA -- USE REG 10         07670002
         L     R8,WORKAREA         R1= ADDR OF GENERAL WORKAREA         07720002
         USING TSTCWORK,R8         ESTABLISH ADDRESSIBILITY             07770002
         LA    R10,CWORKCMD        R10= ADDR OF OFFS WORKAREA           07820002
         USING OFFWORKA,R10        COMPLETE ADDRESSIBILITY              07870002
         DROP  R8                  RELEASE REG 8                        07920002
****     SETUP FOR RETRY THRU STAE                                      07970002
         STM   R14,R12,HEX0C(R13)  STORE REGISTERS FOR STAE             08020002
*        LA    R1,ABENDTAB         R1= ADDR OF ABEND TABLE              08070002
*        ST    R1,ABENTAB1         ADDR ABEND TABLE TO OFFS WORKAREA    08120002
*        MVC   TSTRETRY(L'TSTRETRY),ADDRETRY PUT RETRY RTN ADDR IN TCOM 08170002
         L     R2,TSTSTAE          R2= IKJEGSTAE ADDR FROM TCOMTAB      08180002
         XC    STAEWRK(STAELN),STAEWRK  CLEAR AREA FOR ESTAE ISSUANCE   08190002
         ESTAE (R2),PARAM=LIST,MF=(E,OFFWORKA),RECORD=YES  ISSUE ESTAE  08320002
         SPACE                                                          08370002
SMTSTAE  DS    0H                  SMT TESTING LABEL                    08420002
         LTR   R15,R15             TEST THE RETURN CODE FROM STAE       08470002
         BZ    OFF0000             START THE ACTUAL OFF PROCESSING      08520002
         STC   R15,TSTESTRC        PRESERVE ESTAE RETURN CODE           08570002
         LA    R15,N24             SET RETURN CODE TO DECIMAL 24        08620002
         B     OFF0340             GO RETURN WITH R15=24                08730002
         SPACE                                                          08770002
****     OFF PROCESSING BEGINS HERE... FIRST CHECK                      08820002
*        NO PARAMETERS. IF ANY OF THE 3 ARE TRUE REMOVE ALL             08870002
*        BREAK POINTS...                                                08920002
OFF0000  DS    0H                  LABEL DO WE REMOVE ALL BRK PTS       08970002
         NI    TSTFLGS2,HEXFF-TSTXCTL TURN OFF XCTL SW                  08980002
         XC    CHNGSWRK,CHNGSWRK   ZERO FIELD USED TO INDICATES REMOVAL 09020002
         XC    VCKSWWRK,VCKSWWRK   ZERO VALIDITY CHECK FIELD            09030002
         TM    TSTFLGS1,ENDSW      IS THE ENDSW ON                      09070002
         BO    OFF0040             YES  CLEANUP AND REMOVE ALL BRK PTS  09120002
         TM    TSTFLGS1,RUNSW      IS THE RUNSW ON                      09170002
         BO    OFF0040             YES CLEANUP AND REMOVE ALL BRK PTS   09220002
         TM    TSTFLGS3,NOPARMS    IS THERE ANY PARAMETERS ON OFF       09270002
         BO    OFF0040             NO JUST REMOVE ALL BREAK PTS         09320002
         B     OFF0060             PARAMETERS SUPPLIED GO TO PARSE      09370002
         SPACE                                                          09420002
OFF0040  DS    0H                  REMOVE ALL BREAK POINTS              09470002
****     REMOVE ALL THE BREAK PTS BY BAL TO IKJEGALL                    09520002
         BAL   R14,IKJEGALL        REMOVE ALL ACTIVE & DEFERED BRK PTS  09570002
         B     OFF0300             RETURN NORMALLY TO CALLER            09620002
         SPACE                                                          09670002
****     SETUP TO LINK TO PARSE TO OBTAIN THE PARAMETERS                09720002
OFF0060  DS    0H                  SETUP PPL                            09770002
         LA    R8,PPLWRK           R8= ADDR OF THE PPL WORKAREA         09820002
         USING PPL,R8              EST ADDR'ABILITY TO PPL              09870002
****     MOVE THE UPT, ECT, AND ECB POINTERS TO THE PPL WORKAREA        09920002
         MVC   PPLWRK(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST            09970002
         MVC   PPLPCL,PCLADDR      INSERT PCL ADDR INTO WORK AREA       10020002
         LA    R1,TSTANSPL         R1= ADDR OF TSTANSPL                 10070002
         ST    R1,PPLANS           STORE ADDR OF ANSWER PLACE IN WORKA  10120002
         MVC   PPLCBUF,INBUF       PLACE A POINTER TO INBUF INTO WORKA  10170002
         ST    R13,PPLUWA          STORE POINTER TO SAVE AREA IN WORKA  10220002
         LINK  EP=IKJPARS,MF=(E,PPLWRK),ERRET=ERRET1 LINK TO PARSE      10270002
SMTPARS  DS    0H                  PARSE RETURN                         10280002
         DROP  R8                  RELEASE ADDR'ABILITY TO THE PPL      10320002
         SPACE                                                          10370002
         B     OFF0080(R15)       BRANCH ON RETURN CODE INTO TABLE      10470002
OFF0080  DS    0H                  PARSE BRANCH TABLE FOR RETURN CODES  10520002
         B     OFF0220             ALL THRU RETURN CODE = 0 RETURN      10570002
         B     OFF0100             PARSE RETURN CODE = 04               10620002
         B     OFF0120             PARSE RETURN CODE = 08               10670002
         B     OFF0140             PARSE RETURN CODE = 0C (12)          10720002
         B     OFF0160             PARSE RETURN CODE = 10 (16)          10770002
         B     OFF0180             PARSE RETURN CODE = 14 (20)          10820002
         SPACE                                                          10870002
ERRET1   DS    0H                                                       10872002
         LA    R2,N6               NO-GET LINK SVC NUMBER               10876002
         BAL   R14,SVCERR          GO PUT OUT ERROR MESSAGE             10878402
         B     OFF0300                                                  10878802
         SPACE                                                          10880002
****     THE FOLLOWING CODE HANDLES PARSE ERRORS                        10920002
OFF0100  DS    0H                  RETURN CODE 04                       10970002
         OI    TSTFLGS4,TSTFLUSH   TURN ON SWITCH TO FLUSH STACK        11020002
         B     OFF0300             RETURN TO CALLER                     11070002
OFF0120  DS    0H                  RETURN CODE 08                       11120002
         LA    R15,N16             PLACE 16 INTO REG 5 FOR CALLER       11170002
         B     OFF0320             RETURN TO CALLER WITH 16             11220002
OFF0140  DS    0H                  RETURN CODE X'0C' FROM PARSE         11270002
         LA    R15,N3              INDICATE TO USE 3RD IO MACRO         11280002
         LA    R2,N5               INDICATE APPROPRIATE INSERT NUMBER   11330002
         LA    R1,MSGPRS0C         PLACE MSG ADDR INTO REG1             11370002
         BAL   R14,PUTMSG          OUTPUT THE MESSAGE                   11420002
         B     OFF0300             THATS ALL                            11470002
OFF0160  DS    0H                  PARSE RETURN CODE X'10'              11520002
         LA    R15,N1              INDICATE TO USE 1ST IO MACRO         11530002
         LA    R1,MSGPRS10         PLACE MSG ID INTO REG 1              11620002
         BAL   R14,PUTMSG          OUTPUT THE MSG                       11670002
         B     OFF0300             THATS ALL                            11720002
OFF0180  DS    0H                  RETURN CODE X'14' FROM PARSE         11770002
         CLI   RETCDWRK,N16        WAS THE RETCODE 16 FROM VALIDITY CK  11820002
         BNE   OFF0200             NO THEREFORE LOAD 20 AS A RETCODE    11870002
         LA    R15,N16             YES THEREFORE RETURN X'16' TO CALLER 11920002
         B     OFF0320             RETURN TO CALLER                     11970002
OFF0200  DS    0H                  RETURN TO  CALLER WITH 20            12020002
         CLI   RETCDWRK,N8         WAS RETURN CODE 8 FROM VALIDITY CK   12030002
         BE    OFF0300             YES THEREFORE JUST RETURN            12050002
         LA    R15,N20             PLACE 20 INTO REG 15 FOR CALLER      12070002
         B     OFF0320             RETURN TO CALLER                     12120002
         SPACE                                                          12170002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12220002
*        BEFORE TERMINATING IS THE PDE NULL (PDEUSER) IN WHICH          12270002
*        CASE ALL BREAKPOINTS SHOULD BE REMOVED                         12320002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12370002
OFF0220  DS    0H                  CHECK FOR A NULL PDE                 12420002
         L     R6,TSTANSPL         R6= ADDR OF THE RETURNED PDL         12470002
         LA    R6,N8(R6)           R6= ADDR OF THE PDE FROM PARSE       12480002
         USING IKJPARMA,R6         R6= ADDR'ABILITY TO PDE              12520002
         CLC   PDEUSER(L'PDEUSER),ZEROS   IS PDEUSER FIELD +FLAG = 0000 12570002
         DROP  R6                  RELEASE ADDR'ABILITY TO THE PDE      12620002
         BE    OFF0040             YES THEREFORE REMOVE ALL BREAKPOINTS 12670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12720002
*        WERE ANY BREAKPOINTS REMOVED IN THE VALIDITY CHECK             12770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12820002
         TM    CHNGSWRK,REMOVWRK   WAS ANY BREAKPOINTS REMOVED          12870002
         BO    OFF0300             YES THEREFORE EXIT                   12920002
         LA    R1,MSGNOBRK         R1= ADDR OF THE ERROR MESSAGE SET    12970002
         LA    R15,N1              INDICATE TO USE 1ST IO MACRO         12980002
         BAL   R14,PUTMSG          OUPUT THE MESSAGE                    13070002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   13120002
*   THIS IS THE END OF THE CONTROL PORTION OF THE OFF COMMAND...        13170002
*   RETURN TO CALLER (MNL) WITH EITHER A ZERO OR NON-ZERO RETURN CODE   13220002
*   THE NON-ZERO RETURN CODE IS PRESET IN REGISTER 15.                  13270002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   13320002
OFF0300  DS    0H                  RETURN WITH A NORMAL ZERO RET CODE   13370002
         XR    R15,R15             ZERO REGISTER 15 AS RETURN CODE      13420002
OFF0320  DS    0H                  RETURN WITH AN ERROR NONZERO RET COD 13470002
         LR    R2,R15              PRESERVE THE RETURN CODE             13472002
         ESTAE 0                   REMOVE SCB                           13480002
         LR    R15,R2              RESTORE THE RETURN CODE              13490002
OFF0340  DS    0H                  RETURN WITH THE RETURN CODE IN R15   13500002
         L     R13,N4(R13)         R13= ADDR OF CALLERS SAVE AREA       13520002
         RETURN (14,12),,RC=(15)   THIS WILL RETUNR TO THE CALLER       13570002
         EJECT                                                          13620002
IKJEGALL DS    0H                  ENTRY FOR REMOVING ALL BRK PTS       13670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   13720002
*   THE FOLLOWING SECTION OF CODE REMOVES ALL BREAK POINTS ACTIVE       13770002
*   AND DEFERED.  ACTIVE BREAK POINTS ARE REMOVED FIRST, BY TAKING      13820002
*   THE BREAK PT FROM THE TOP OF THE LIST AND LINKING THE LIST          13870002
*   AROUND THE BREAK PT AND CALLING  'REMOVACT' WHICH WIIL REMOVE       13920002
*   THE BREAK PT WHOSE ADDR IS IN REGISTER 1. THE PROCESS IS CONTINUED  13970002
*   UNTIL THERE IS A NULL LIST.                                         14020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   14070002
         ST    R14,REG14WRK        STORE THE RETURN REG UNTIL DONE      14120002
         USING BRKELEM,R8          SETUP ADDR'IBILITY TO ACTIVE BRK PTS 14170002
ALL0020  DS    0H                  GET ADDR FROM THE BREAKTAB (TCOMTAB) 14220002
         L     R8,BREAKTAB         R8= ADDR OF FIRST BRK ELEMENT        14270002
         LA    R1,N0(R8)           R1= ADDR WITH ZERO HIGH ORDER BYTE   14320002
         LTR   R1,R1               ARE THERE ANY ACTIVE BRK PTS         14370002
         BZ    ALL0100             NO THEREFORE CHECK DEFERTAB          14420002
         L     R1,BRKADDR          R1= ADDR TO BE SEARCHED FOR BY SRH   14470002
         XC    SRHAWRK(N12),SRHAWRK CLEAR THE SRH WORK AREA             14580002
         ST    R1,SRH2WRK          INSERT THE ADDR OF BRKPT TO REMOVED  14590002
         LA    R1,SRHAWRK          R1= ADDR OF THE PARAMETER AREA       14600002
         L     R15,TSTSRHRT        R15= ADDR OF THE SEARCH ROUTINE      14610002
         BALR  R14,R15             HAVE THE BREAKPOINT REMOVED          14612002
****     TRANSFER CONTROL WITH RESPECT TO RETURN CODE                   14614002
         B     ALL0040(R15)        BRANCH INTO TABLE                    14616002
         SPACE                                                          14618002
ALL0040  DS    0H                  SRH RETURN CODE TABLE                14618402
         B     ALL0060             OK TURN ON REMOVAL SW                14618802
         B     ALL0060             RC= 04 UNABLE TO FIND CK DEFERED     14619202
         B     ALL0060             RC= 08 INVALID RANGE                 14619602
         B     ALL0080             RC= 12 STAE RETRY BLEW IT            14619702
         B     OFF0320             RC > 12, SO RETURN TO CALLER(MNL)    14621802
         B     OFF0320             RC > 12, SO RETURN TO CALLER(MNL)    14623802
         B     OFF0320             RC > 12, SO RETURN TO CALLER(MNL)    14625802
         SPACE                                                          14626502
ALL0060  DS    0H                  TURN ON REMOVE SW AND CONTINUE       14629802
         B     ALL0020             CONTINUE WITH THE NEXT BREAK PT      14670002
         SPACE                                                          14672002
ALL0080  DS    0H                  RETURN TO MNL W 20                   14680002
         LA    R15,N20             RETURN TO MAINLINE WITH 20           14690002
         B     OFF0320             JUST RETURN TO MNL                   14700002
         DROP  R8                  RELEASE THE ACT BRK PT Q REG         14720002
         SPACE                                                          14770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   14820002
*   THE NEXT SECTION OF CODE REMOVES THE DEFERED BREAK POINTS.          14870002
*   IT ALSO LINKS AROUND THE DME THEN FREES THE 1) DME, 2) PDL,         14920002
*   3) INBUF, 4) DBE... 2 THROUGH 4 ARE CONTINUED UNTIL THERE ARE NO    14970002
*   MORE DBE'S. THE NEXT DME IS OBTAINED AND THE PROCESS IS CONTINUED   15020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   15070002
         SPACE                                                          15120002
ALL0100  DS    0H                  REMOVE ALL DEFERED BREAK POINTS      15170002
         USING DME,R8              ESTABLISH ADDR'IBILITY TO THE DME'S  15220002
         USING DBE,R7              ESTABLISH ADDR'IBILITY TO THE DBE'S  15270002
         L     R8,DEFERTAB         R8= ADDR OF FIRST DME                15320002
ALL0120  DS    0H                  BEGIN LOOP OF REMOVING DME'S         15370002
         LA    R8,N0(R8)           ZERO THE HIGH ORDER BYTE             15420002
         LTR   R1,R8               IF ZEROTHERE ARE NO (MORE) DME'S     15470002
         BZ    ALL0200             ALL BREAK POINTS REMOVED RETURN      15520002
         L     R7,DMEDBE           R7= ADDR OF THE DBE...               15620002
         L     R8,DMEDME           R8= ADDR OF NEXT DME TO BE PROCESSED 15670002
         ST    R8,DEFERTAB         LINK AROUND THE DEFERED ELEMENT      15720002
         FREEMAIN RC,LV=16,A=(1),SP=1  FREE THE DME...                  15770002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          15772002
         BZ    ALL0140             ZERO IMPLIES NO ERROR                15774002
         LA    R2,N120             SET SVC NUMBER                       15780002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 15790002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 15800002
ALL0140  DS    0H                  PROCESS THE DBE                      15820002
         LA    R7,N0(R7)           ZERO THE HIGH ORDER BYTE             15870002
         LTR   R7,R7               CKECK IF THERE IS A DBE TO PROCESS   15920002
         BZ    ALL0120             NO THEREFORE CHECK FOR MORE DME'S    15970002
****     RELEASE THE PARSE PDL                                          16020002
         IKJRLSA DBEPDL          RELEASE THE PDL                        16070002
****     FREE THE INPUT BUFFER POINTED TO IN THE DBE                    16120002
         L     R1,DBEINBUF         R1= ADDR OF THE INBUF                16170002
         LH    R0,N0(R1)           R3= LENGTH OF THE BUFFER             16220002
         FREEMAIN RC,LV=(0),A=(1),SP=1   FREE INBUF                     16320002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          16322002
         BZ    ALL0150             ZERO IMPLIES NO ERROR                16324002
         LA    R2,N120             SET SVC NUMBER                       16330002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 16340002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 16350002
****     ISSUE FREEMAIN TO FREE THE DBE LASTLY.                         16370002
ALL0150  DS    0H                                                       16380002
         LR    R1,R7               R1= ADDR OF DBE TO BE FREED          16420002
         L     R7,DBEDBE           R7= ADDR OF NEXT DBE IF ANY          16470002
         FREEMAIN R,LV=12,A=(1),SP=1 ISSUE FREEMAIN OF DBE              16520002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          16530002
         BZ    ALL0140             ZERO IMPLIES NO ERROR                16540002
         LA    R2,N120             SET SVC NUMBER                       16550002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 16560002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 16562002
         B     ALL0140             PROCESS NEXT                         16570002
****     ALL THE BREAK POINTS (ACTIVE AND DEFERED) HAVE BEEN REMOVED    16620002
ALL0200  DS    0H                  RETURN TO MAIN OF OFF                16670002
         L     R14,REG14WRK        R14= ADDR OF CALLER                  16720002
         BR    R14                 RETURN TO CALLER                     16770002
         DROP  R8                  RELEASE ADDR'IBILITY TO DME          16820002
         DROP  R7                  RELEASE ADDR'IBILITY TO DBE          16870002
         EJECT                                                          16920002
         SPACE                                                          16970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 22120002
*   THE NEXT SECTION OF CODE IS THE VALIDITY CHECK ROUTINE WHICH        22170002
*   PARSE RETURNS CONTROL TO VARIFY AN ADDRESS WHICH THE USER ENTERED   22220002
*   THE PDE IS INPUT TO THE ROUTINE, IT VARIFIES THE ADDRESS AND        22270002
*   REMOVES IT FROM BOTH QUEUE'S....                                    22320002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 22370002
         SPACE                                                          22420002
IKJEGVCK DS    0H                  ENTRY POINT FOR THE VALIDITY CK RTN  22470002
         SAVE  (14,12),,*          SAVE REGISTERS FROM PARSE            22520002
****     RE-ESTABLISH MY ADDRESSIBILITY TO IKJEGOFF...                  22570002
         USING IKJEGOFF,R12        SETUP ADDR'ABILITY TO BASE           22620002
         L     R2,N4(R1)           R13= ADDR OF REGISTER SAVE AREA      22670002
****     RESTORE REGISTER 9 (TCOMTAB), 10 (OFFWORKA), AND 12 (OFF BASE) 22720002
         LM    R9,R12,N56(R2)      RESTORE REGS 9 THRU 12               22770002
****     BEGIN PROCESSING THE PDE FROM PARSE                            22820002
         OI    VCKSWWRK,VCKONWRK   TURN ON VALIDITY CK SW               22830002
         L     R6,N0(R1)           R6=ADDR OF THE PDE FROM PARSE        22870002
         LA    R6,N0(R6)           ZERO THE HIGH ORDER BYTE             22920002
         USING IKJPARMA,R6         EST ADDR'IBILITY TO THE PDE          22970002
****     SAVE PARSE'S REGISTERS AND CHAIN SAVE AREAS TOGETHER           23070002
         ST    R1,PARETWRK         SAVE ADDR OF PARM BLOCK              23120002
         L     R1,REGSAVE3         R1= ADDR OF THE NEW SAVE AREA        23170002
         ST    R13,N4(R1)          STORE THE BACK POINTER               23220002
         ST    R1,N8(R13)          STORE THE FOWARD POINTER             23270002
         LR    R13,R1              R13= ADDR OF NEW SAVE AREA           23320002
         OI    TSTFLGS4,TSTVALCK   TURN ON VALIDITY CHECK INDICATOR     23330002
         L     R2,OUTBUF           GET BUFFER ADDRESS                   23340002
         MVC   N0(N4,R2),ZEROS     SET MESSAGE INDICATOR TO ZERO        23350002
         NI    CHNGSWRK,HEXFF-VCKRMWRK TURNOFF VALIDITY CHECK SW SET    23370002
         L     R2,BREAKTAB         ARE THERE ANY ACTIVE BRK ELEMENTS    23420002
         LA    R2,N0(R2)           ZERO HIGH ORDER BYTE                 23470002
         LTR   R2,R2               DO WE HAVE AN ADDRESS                23520002
         BNZ   VCK0020             YES CONTINUE                         23570002
         L     R2,DEFERTAB         ARE THERE ANY ACTIVE DEF ELEMENTS    23620002
         LA    R2,N0(R2)           ZERO HIGH ORDER BYTE                 23670002
         LTR   R2,R2               DO WE HAVE AN ADDRESS                23720002
         BNZ   VCK0020             YES CONTINUE                         23770002
****     THERE IS NOTHING ON EITHER Q ALL ADDRESSES ARE INVALID         23820002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         23830002
         LA    R1,MSGNOQUE         PLACE MSGID INTO REGISTER 1 ERROR    23870002
         LR    R2,R6               R2= ADDR OF PDE (INSERT)             23880002
         NI    TSTFLGS4,HEXFF-TSTVALCK   TURN OFF VALIDITY CHECK SW     23930002
         BAL   R14,PUTMSG          OUTPUT THE ERROR MSG                 23970002
         LA    R1,N8               R1= N8 RETURN CD TO BE SAVED         23980002
         ST    R1,RETCDWRK         SAVE THE RET CD FOR MAIN OFF USE     23990002
         LA    R15,N12             RETURN TO PARSE W/ 12 END IT         24000002
         B     VCK0935             RETURN WITH 12                       24020002
         SPACE                                                          24070002
****     VERFY THAT IT IS A VALID PDE (BOTH HALVES OF THE PDE)          24120002
VCK0020  DS    0H                  FIRST HALF OF PDE                    24170002
         TM    PDEFLG2,CTNAMFLG    WAS AN ENTRYNAME SPECIFIED           24220002
         BO    VCK0050             YES THEREFORE CHECK IT               24270002
         TM    PDEFLG4,GENR        DO WE HAVE A GENERAL REGISTER        24320002
         BNO   VCK0040             CHECK WHAT IT IS ...                 24370002
         LH    R2,PDEINDCT         R7= INDIRECT COUNT FROM PDE          24420002
         LTR   R2,R2               WAS INDIRECTION ALSO SPECIFIED       24470002
         BNZ   VCK0050             YES CHECK REGISTER USAGE             24520002
         B     VCK0045             INVALID REG ERROR MSG                24530002
****     CHECK FOR FLOATING POINT DOUBLE REGISTER USED IF SO INVALID    24820002
VCK0040  DS    0H                  LOOK AT ADDRESS TYPE FIELD           24870002
         TM    PDEFLG4,LFPR        IS IT A DOUBLE PRECISION REGISTER    24920002
         BO    VCK0045             YES THEREFORE ERROR MSG              24970002
         TM    PDEFLG4,SFPR        IS IT A FLOATING POINT REGISTER      25020002
         BNO   VCK0050             NO, THEREFORE CONTINUE               25070002
****     ERROR CONDITION INVALID REGISTER USAGE                         25120002
VCK0045  DS    0H                  ERROR CONDITION                      25170002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         25180002
         LR    R2,R6               R2= ADDR OF PDE (INSERT ADDR)        25220002
         LA    R1,MSGFPREG         R1= ADDR OF THE MESSAGE              25270002
         BAL   R14,PUTMSG          GO TO THE MESSAGE ROUTINE            25320002
         B     VCK0930             RETURN TO PARSE W/REENTER RET CODE   25370002
         SPACE                                                          25420002
VCK0050  DS    0H                  SECOND HALF OF PDE                   25430002
         TM    PDE2FLG2,CTNAMFLG   WAS AN ENTRYNAME SPECIFIED           25440002
         BO    VCK0060             YES THEREFORE CHECK IT               25450002
         TM    PDE2FLG4,GENR       DO WE HAVE A GENERAL REGISTER        25460002
         BNO   VCK0055             CHECK WHAT IT IS ...                 25462002
         LH    R2,PDE2INDC         R7= INDIRECT COUNT FROM PDE          25464002
         LTR   R2,R2               WAS INDIRECTION ALSO SPECIFIED       25466002
         BNZ   VCK0060             YES CHECK REGISTER USAGE             25468002
         B     VCK0045             INVALID REG ERROR MSG                25468402
****     CHECK FOR FLOATING POINT DOUBLE REGISTER USED IF SO INVALID    25469802
VCK0055  DS    0H                  LOOK AT ADDRESS TYPE FIELD           25469902
         TM    PDE2FLG4,LFPR       IS IT A DOUBLE PRECISION REGISTER    25486602
         BO    VCK0045             YES THEREFORE ERROR MSG              25496602
         TM    PDE2FLG4,SFPR       IS IT A FLOATING POINT REGISTER      25498602
         BO    VCK0045             NO, THEREFORE CONTINUE               25500602
         SPACE                                                          25512802
****     BEGIN ACTUAL PROCESSING GO TO CONVERT TO RESOLVE ADDRESS       25514402
VCK0060  DS    0H                  SETUP FOR COVERT                     25520002
         TM    PDEFLG1,LDNAMFLG    WAS A LOAD NAME ENTERED...           25570002
         BNO   VCK0080             NO THEREFORE DO NOT TURN ON SYM SW   25620002
         OI    TSTFLGS3,SYMMESG    SW=ON TO STOP SYM MESSAGES           25670002
VCK0080  DS    0H                  SETUP FOR A CALL TO PARSE            25720002
         OI    TSTFLGS1,RANGESW    TURN ON THE RANGE SW FOR CVT         25770002
         LCR   R1,R6               R1= COMPLEMENT ADDR OF PDE           25820002
         XR    R0,R0               R0= ZERO FOR CONVERT                 25870002
         L     R15,TSTCONVT        R15= ADDR OF THE CONVERT ROUTINE     25920002
         BALR  R14,R15             GO TO THE CONVERT SUBROUTINE         25970002
         TM    TSTFLGS1,RANGESW    IS THE RANGE SW ON                   25980002
         BO    VCK0085             YES GET AND SAVE FIRST PDEUSER       26000002
         L     R2,PDE2USER         R2=ADDR IN PDEUSER 2 (SEC LEVEL MSG) 26010002
         B     VCK0090             CONTINUE CHECKING                    26012002
VCK0085  DS    0H                  USE ADDR IN PDEUSER 1                26014002
         L     R2,PDEUSER          R2=ADDR IN PDEUSER 1 (SEC LEVEL MSG) 26016002
VCK0090  DS    0H                  CONTINUE CLEANING UP AFTER CONVERT   26018002
****     TURN OFF SYMMESG AND RANGESW SWITCHS SAVE PDEUSER (ERROR MSG)  26020002
         NI    TSTFLGS3,HEXFF-SYMMESG TURN OFF SYM MESSAGE SWITCH       26070002
         NI    TSTFLGS1,HEXFF-RANGESW TURN OFF RANGE MESSAGE SWITCH     26120002
****     TRANSFER CONTROL WITH RESPECT TO THE RETURN CODE               26220002
         SPACE                                                          26270002
         B     VCK0100(R15)        BRANCH INTO THE TABLE                26320002
VCK0100  DS    0H                  CVT RETURN CODE TABLE                26370002
         B     VCK0200             ZERO RETURN CODE THEREFORE CONTINUE  26420002
         B     VCK0140             RET CD= 04 UNABLE TO CONVERT PDE     26470002
         B     VCK0140             RET CD= 08 UNABLE TO RESOLVE SYMBOLS 26520002
         B     VCK0120             RET CD= 12 IO ERROR                  26570002
         B     VCK0120             RET CD= 16 AN ATTN WAS POSTED        26620002
         B     VCK0120             RET CD= 20 IO PROBLEMS SYM OR CVT    26670002
         SPACE                                                          26720002
****     RETURN TO PARSE WITH A '12' SAVE THE RETURN CODE FROM CVT      26770002
VCK0120  DS    0H                  RETURN TO PARSE WITH '12'            26820002
*        ESTAE 0,OV                REMOVE SCB                           26830002
         ST    R15,RETCDWRK        SAVE CONVERTS RET CODE IN WORKAREA   26870002
         LA    R15,N12             R15= '12' AS A RETURN CODE           26920002
         B     VCK0960             BRANCH TO RETURN TO PARSE            26970002
         SPACE                                                          27020002
****     CHECK IF THE PROBLEM IS AN UNRESOLVED LOADNAME ON DEFERED Q    27070002
VCK0140  DS    0H                  IS THERE A LOADNAME IN PDE1          27120002
         TM    PDEFLG1,LDNAMFLG    IS AN LOADNAME PRESENT               27170002
         BZ    VCK0160             NO ASK PARSE FOR REENTER RET CD 08   27220002
         TM    PDE2FLG3,AFLG       DOES SECOND HALF OF THE PDE EXIST    27270002
         BZ    VCK0400             NO THEREFORE  A SINGLE DEFERED ENTRY 27320002
         TM    PDE2FLG1,LDNAMFLG   DOES A LOADNAME EXIST                27370002
         BO    VCK0400             YES THEREFORE DEFERED RANGE          27420002
****     WE HAVE A BAD  NAME SYM OR CONVERT PROBLEM                     27470002
         L     R2,PDE2USER         R2= SECOND LEVEL ERROR MESSAGE       27480002
         B     VCK0930             RETURN TO PARSE WITH REENTER         27482002
VCK0160  DS    0H                  PDEUSER CONTAINS SECOND LEVEL        27490002
         L     R2,PDEUSER          R2= SECOND LEVEL MESSAGE             27500002
         B     VCK0930             RETURN TO PARSE WITH REENTER         27870002
         EJECT                                                          27920002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   27970002
*    START PROCESSING OF THE ACTUAL ADDRESS, 1) PDEUSER, 2) SIB PTR,    28020002
*    3) QUALIFIED NAME. CONDITIONS 1 AND 2 INDICATE ACTIVE, CONDITION   28070002
*    3 INDICATES DEFERED. ALL ENTERIES ARE REMOVED ON BOTH QUEUE'S...   28120002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   28170002
VCK0200  DS    0H                  START WITH PDE USER FIELD            28220002
         XC    SRHAWRK(N12),SRHAWRK CLEAR PARAMETER AREA                28230002
         L     R2,PDEUSER          R2= ADDR IN FROM PDEUSER OF THE PDE  28270002
         TM    PDEUSER,PDESIB      IS IT THE ACTUAL ADDRESS OR SIB PTR  28320002
         BZ    VCK0220             IF POSITIVE A VALID ADDRESS          28370002
         L     R2,N0(R2)           GET THE ACTUAL ADDRESS FROM THE SIB  28420002
         ST    R2,PDEUSER          VALIDATE THE ADDRESS YOU RECIEVED    28470002
         SPACE                                                          28520002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   28570002
*    REMOVE FROM THE ACTIVE BREAK Q THE BREAK POINT WHOSE ADDR IS       28620002
*    IN THE PDEUSER FIELD OF THE PDE. THE BREAK Q IS IN INCREASING      28670002
*    ORDER BY ADDRESS.                                                  28720002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   28770002
VCK0220  DS    0H                  BEGIN THE REMOVAL PROCESSING         28820002
         LA    R2,N0(R2)           CLEAR OUT THE HIGH ORDER BYTE        28870002
         ST    R2,SRH2WRK          INSERT ADDRESS OF BRKPT TO REMOVE    28880002
         L     R3,PDE2USER         R3= ADDR OF SECOND PDEUSER FIELD     29020002
         TM    PDE2USER,PDESIB     IS THE 2 PDE AN ADDR OR SIB POINTER  29170002
         BZ    VCK0240             IT IS THE ACTUAL ADDRESS             29220002
         L     R3,N0(R3)           R3=THE ACTUAL ADDRESS                29270002
         ST    R3,PDE2USER         PLACE THE ADDRESS IN PDE2USER        29320002
****    WE HAVE THE SECOND ADDRESS OF THE RANGE                         29370002
****     MAKE SURE ADDR 1 IS LESS THAN ADDR 2 OF RANGE                  29420002
VCK0240  DS    0H                  VARIFY THE ADDRESS OF A RANGE        29470002
         LA    R3,N0(R3)           CLEAR-HIGH-ORDER-BYTE                29480002
         ST    R3,SRH3WRK          INSERT ENDING RANGE ADDR (OR ZERO)   29490002
         LA    R1,SRHAWRK          R1= ADDR OF THE PARM AREA            29540002
         L     R15,TSTSRHRT        R15= ADDR OF THE SEARCH ROUTINE      29590002
         BALR  R14,R15             GO TO REMOVAL ROUTINE                29640002
****     TRANSFER CONTROL WITH RESPECT OT RETURN CODE                   29650002
         B     VCK0260(R15)        BRANCH INTO TABLE                    29660002
         SPACE                                                          29662002
VCK0260  DS    0H                  SRH RETURN CODE TABLE                29664002
         B     VCK0280             OK TURN ON REMOVAL SW                29666002
         B     VCK0400             RC= 04 UNABLE TO FIND CK DEFERED     29668002
         B     VCK0300             RC= 08 INVALID RANGE                 29668402
         B     VCK0320             DUMMY                                29668502
         B     VCK0320             DUMMY                                29672002
         B     VCK0320             RC= 20 STAE RETRY BLEW IT            29674902
         B     VCK0320             RC= 24 STAE RETRY BLEW IT            29676902
         SPACE                                                          29681602
VCK0280  DS    0H                  OK JUST TURN ON REMOVED SW           29688002
         OI    CHNGSWRK,VCKRMWRK+REMOVWRK INDICATE SOMETHING REMOVED    29694402
         B     VCK0400             CHECK THE DEFERED QUEUE              29700802
         SPACE                                                          29707202
VCK0300  DS    0H                  INVALID RANGE ERROR CONDITION        29713602
         LA    R1,MSGIVRNG         R1= ADDR OF ERROR MSG                29720002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         29730002
         LR    R2,R6               R2= ADDR OF PDE (INSERT ADDR)        29770002
         BAL   R14,PUTMSG          GO TO THE ERROR OUTPUT ROUTINE       29820002
         B     VCK0930             RETURN TO PARSE W/REENTER CODE       29870002
         SPACE                                                          29920002
VCK0320  DS    0H                  RETURN TO MNL W 20                   29970002
         LA    R1,N16              R1 = 16 SAVE INDICATOR               29980002
         ST    R1,RETCDWRK         SAVE RETRY INDICATOR                 29990002
         LA    R15,N12             R15= 12 RETURN CODE TO MNL TROUBLE   30020002
         B     VCK0960             RETURN TO PARSE                      30070002
         EJECT                                                          32770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   32820002
*    ALL ACTIVE BREAKPOINTS HAVE BEEN REMOVED IF ANY. NOW WE MUST       32870002
*    REMOVE ALL DEFERED BREAKPOINTS THAT HAVE BEEN INDICATED IN THE     32920002
*    PDE FROM PARSE...                                                  32970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   33020002
         SPACE                                                          33070002
VCK0400  DS    0H                  BEGIN DEFERED PROCESSING             33120002
         L     R8,DEFERTAB         R7= ADDR OF FIRST ELEMENT OF DEFER Q 33170002
         USING DME,R8              EST ADDR'ABILITY TO DEFERED DME'S    33220002
         USING DBE,R7              EST ADDR'ABILITY TO DEFERED DBE'S    33270002
************************ START DEFERED  -DME- SEARCH ****************** 33320002
****     START THE DEFERED PROCESSING VARIFY DEFER Q.                   33370002
         SPACE                                                          33420002
         XC    DMEBKWRK(N4),DMEBKWRK   ZERO BACK POINTER FOR DME        33470002
         NI    VCKSWWRK,HEXFF-RANSWWRK TURN OFF RANGE SWITCH            33480002
         LA    R1,DEFERTAB         R1= ADDR OF DEFERED TABLE ADDRESS    33520002
         ST    R1,DMEBKWRK         SAVE THE ADDRESS FOR BACK CHAINING   33570002
VCK0420  DS    0H                  EMPTY DEFERED Q                      33620002
         LA    R8,N0(R8)           ZERO THE HIGH ORDER BYTE             33670002
         LTR   R8,R8               NULL DEFERED QUEUE                   33720002
         BZ    VCK0920             YES THEREFORE WE ARE DONE            33770002
****     GET BOTH LOADNAMES AND COMPARE THEM                            33820002
         LA    R2,DMELOAD          R2= ADDR OF LOADNAME FROM DME        33870002
         L     R3,PDELDNAM         R3= ADDR OF THE PDE LOADNMAE         33920002
         LH    R4,PDELEN1          R4= LENGTH OF THE PDE LOAD NAME      33970002
         BCTR  R4,N0               DECREAMENT R4 FOR COMPARE            34020002
         EX    R4,COMPARE          EXECUTE A COMPARE OF THE LOADNAMES   34070002
         BE    VCK0440             WE HAVE THE CORRECT DME              34120002
         LA    R1,DMEDME           R1= ADDR OF DME POINTER              34130002
         ST    R1,DMEBKWRK         SAVE THE ADDR OF THE PREVIOUS DME    34140002
         L     R8,DMEDME           R8= ADDR OF THE NEXT DME             34220002
         B     VCK0420             CONTINUE SEARCH FOR THE CORRECT DME  34270002
         SPACE                                                          34320002
************************ START DEFERED -DBE- SEARCH ******************* 34370002
****     SEARCH FOR THE CORRECT DBE OF THAT DME                         34420002
VCK0440  DS    0H                  START SEARCH INITIALIZE              34470002
         XC    DBEBKWRK(N4),DBEBKWRK ZERO BACK POINTER FOR THE DBE      34520002
         L     R7,DMEDBE           R7= ADDR OF FIRST DBE                34570002
VCK0460  DS    0H                  CHECK IF DBE EXISTS                  34620002
         LA    R7,N0(R7)           ZERO THE HIGH ORDER BYTE             34670002
         LTR   R7,R7               IS THE DME PTR NULL                  34720002
         BZ    VCK0920             WE ARE DONE ...                      34770002
****     GET THE ADDR TO THE PDE WHICH CREATED THIS DEFERED BREAK POINT 34820002
****     ESTABLIST ADDRESSABILITY TO THIS PDE                           34870002
         L     R5,DBEPDL           GET THE PDE WHICH CREATED THE DBE    34920002
         LA    R5,N8(R5)           INCREMENT PDE ADDR TO BODY OF PDE    34970002
         USING DBEPDECT,R5         EST ADDR'ABILITY TO THE DBE-PDE      35020002
VCK0470  DS    0H             CONTINUE THE DBE-PDE SEARCH               35030002
         L     R2,DBECTNAM         R2= ADDR OF DBE CSECT NAME           35070002
         L     R3,PDECTNAM         R3= ADDR OF PDE CSECT NAME           35120002
         LH    R4,PDELEN2          R4= LENGTH OF THE PDE CSECT NAME     35170002
         BCTR  R4,N0               DECREAMENT R4 FOR COMPARE            35220002
         EX    R4,COMPARE          ARE THE CSECT NAME EQUAL             35270002
         BE    VCK0540             YES THEREFORE MUST CHECK FURTHER     35320002
         SPACE                                                          35370002
****     FIRST CHECK IF THERE IS A CHAIN OF PDE'S OFF THE DBE           35380002
VCK0500  DS    0H                  RESTART THE SEARCH FOR DBE           35382002
         L     R1,DBE2CHAI         R2= ADDR OF NEXT DBE(PDE) OFF DBE    35390002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 35400002
         LTR   R1,R1               IS THERE ANOTHER DBEPDE              35410002
         BNZ   VCK0510             YES THEREFORE CHECK IT FOR A MATCH   35412002
****     THIS DBE IS FINISHED SAVE ADDRESS FOR BACKUP AND GET NEXT DBE  35414002
         ST    R7,DBEBKWRK         SAVE THE PREVIOUS DBE ADDRESS        35470002
         L     R7,DBEDBE           OTHERWISE GET THE NEXT DBE           35520002
         B     VCK0460             CONTINUE THE CSECT SCEARCH           35570002
         SPACE                                                          35572002
****     CONTINUE SEARCH WITH NEXT DBE-PDE CHAINED OFF OF PREVIOUS      35580002
VCK0510  DS    0H                  ADDR'ABILITY TO THE DBE-PDE          35590002
         LR    R5,R1               R5= ADDR OF DBE-PDE TO BE SEARCHED   35600002
         B     VCK0470             CONTINUE THE SEARCH FOR A MATCH      35610002
         SPACE                                                          35620002
****     RESTORE THE DBE PTR AS ADDR STRING SEARCH FAILED               35670002
VCK0520  DS    0H                  RESTORE DBE                          35720002
         L     R5,DBEPDWRK         R5= SAVED ADDR OF DBE-PDE WHERE STOP 35730002
         L     R7,DBESVWRK         R7= ADDR OF DBE WHICH FAILED         35740002
         NI    VCKSWWRK,HEXFF-RANSWWRK TURN OFF RANGE SWITCH            35750002
         B     VCK0500             CONTINUE CSECT NAME SEARCH           35820002
         DROP  R7                  RELEASE ADDR'ABILITY TO THE DBE      35870002
         SPACE                                                          35920002
****     WE HAVE A MATCH FOR THE LOAD AND CSECT NAMES, NOW CHECK THE    35970002
****     ADDRESS STRING(S) AND/OR THE THIRD QUALIFIER                   36020002
VCK0540  DS    0H                  STORE THE DBE ADDR FOR RESTART       36070002
         ST    R5,DBEPDWRK         SAVE THE ADDR OF THE DBE-PDE         36080002
         ST    R7,DBESVWRK         SAVE THE CURRENT DBE                 36090002
         TM    PDEFLG4,CTONLY      IS THIS A CSECT ONLY SEARCH          36100002
         BO    VCK0920             YES THEREFORE WE HAVE A VALID MATCH  36110002
VCK0545  DS    0H                  RESTART POSITION FOR SECOND HALF PDE 36170002
****     ZERO THE TEMPORARY ADDR EXPRESSION SUMS                        36220002
         XC    DBESMWRK(N4),DBESMWRK ZERO DBE SUM IN WORKAREA           36270002
         XC    PDESMWRK(N4),PDESMWRK ZERO PDE SUM IN WORKAREA           36320002
         XC    DBEIDWRK(N2),DBEIDWRK ZERO DBE INDIRECT COUNT IN WRKAREA 36370002
         XC    PDEIDWRK(N2),PDEIDWRK ZERO PDE INDIRECT COUNT IN WRKAREA 36420002
         TM    PDEFLG3,AFLG        CHECK IF THE ADDR STRING PRESENT     36470002
         BZ    VCK0550             THIS SHOULD NEVER HAPPEN IF PARSE OK 36520002
         TM    PDEFLG4,RELADDR     IS ADDR STRING NUMERIC               36570002
         BO    VCK0580             YES THERFORE PROCESS                 36620002
         TM    PDEFLG4,SYMADDR     IS IT SYMBOLIC                       36670002
         BO    VCK0560             YES AS IT BETTER BE                  36720002
****     IN THEORY THIS PIECE OF CODE SHOULD NEVER BE EXECUTED          36770002
****     IT INDICATES AN INVALID PDE WAS ENCOUNTERED                    36820002
VCK0550  DS    0H                  OUT PUT THE ERROR MESSAGE            36870002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         36880002
         LR    R2,R6               R2= ADDRESS PDE INSERT ADDR          36920002
         LA    R1,MSGIVPDE         R1= ADDR OF INVALID PDE MSG          36970002
         BAL   R14,PUTMSG          OUTPUT THE MESSAGE                   37020002
         B     VCK0930             CONTINUE WITH NEXT PDE               37120002
         SPACE                                                          37170002
****     COMPARE THIRD QUALIFIER                                        37220002
****     A NON NUMERIC ADDR STRING COMPARE IF EQUAL                     37270002
VCK0560  DS    0H                  COMPARE THE ADDR STRINGS             37320002
         L     R2,DBEADRPT         R2= ADDR OF DBE SYMBOL               37370002
         L     R3,PDEADRPT         R3= ADDR OF PDE SYMBOL               37420002
         LH    R4,PDELEN3          R3= LENGTH OF PDE SYMBOL             37470002
         BCTR  R4,N0               DECREMENT R4 FOR EXECUTN OF COMPARE  37520002
         EX    R4,COMPARE          ARE THE TWO SYMBOLS EQUAL            37570002
         BNE   VCK0520             RESTART CSECT SEARCH                 37620002
****     THEY ARE EQUAL BUT BOTH INDIRECT                               37670002
         LH    R2,DBEINDCT         R2= DBE INDIRECT COUNT               37720002
         LH    R3,PDEINDCT         R3= PDE INDIRECT COUNT               37770002
         CR    R2,R3               ARE THE COUNTS THE SAME              37820002
         BNE   VCK0520             NO CONTINUE CSECT SEARCH             37870002
         B     VCK0600             CONTINUE WITH THE EXPRESIONS IF ANY  37920002
         SPACE                                                          37970002
****     BEGIN EVALUATING THE EXPRESSION, THE  NUMERIC ADDR STRING      38020002
****     WILL BE THE FIRST OF THE SUM. TERMINATION IS EITHER A NULL     38070002
****     EXPRESSION OF AN INDIRECT COUNT                                38120002
VCK0580  DS    0H                  START WITH ADDR STRING               38170002
         LH    R2,PDEINDCT         R2= PDE INDIRECT COUNT               38220002
         LTR   R2,R2               DOES AN INDIRECT COUNT EXIST         38270002
         BNZ   VCK0560             COMPARE AS THOUGH NON NUMERIC        38320002
****     PDE INDIRECT COUNT = 0 SO MUST DBE INDIRECT COUNT              38370002
         LH    R2,DBEINDCT         R2=DBE INDIRECT COUNT                38420002
         LTR   R2,R2               IS THE DBE INDIRECT COUNT = 0        38470002
         BNZ   VCK0520             NO THEREFORE CONTINUE CSECT SEARCH   38520002
****     CONVERT BOTH TO BINARY AND ADD TO THE APPROPRIATE SUMS         38570002
         L     R1,PDEADRPT         R1= ADDR OF THE PDE NUMERIC          38620002
         LH    R3,PDELEN3          R3= LENGTH OF THE EXPRESSION         38670002
         BAL   R14,HEXCVT          CONVERT THE NUMBER TO HEX            38720002
         ST    R1,PDESMWRK         PLACE THE VALUE IN PDE SUM           38770002
         L     R1,DBEADRPT         R1= ADDR OF THE DBE NUMERIC          38820002
         LH    R3,DBELEN3          R3= LENGTH OF THE EXPRESSION         38870002
         BAL   R14,HEXCVT          CONVERT THE NUMBER TO HEX            38920002
         ST    R1,DBESMWRK         PLACE THE VALUE IN DBE SUM           38970002
         SPACE                                                          39020002
****     UPON ENTERING BOTH PDE SUM AND DBE SUM CONTAIN EITHER A        39070002
****     PARTIAL SUM OR THE ARE ZERO                                    39120002
****     START BY LOADING THE APPROPRIATE SIGNS FOR USE                 39170002
VCK0600  DS    0H                  GET THE CURRENT SIGN                 39220002
         XR    R2,R2               ZERO REGISTER 2                      39270002
         IC    R2,PDESIGN          R2= SIGN OF FIRST ADDR EXPRESSION    39320002
         L     R1,PDEEXPTR         R1= ADDR OF THE FIRST EXPRESSION     39370002
****     SAVE THE INITIAL INFORMATION FOR THE DBE EXPRESSION EVALUATION 39420002
         MVC   DBEXPWRK(N4),DBEEXPTR SAVE THE ADDR OF FIRST DBE EXP     39470002
         XR    R3,R3               ZERO REGISTER 3                      39520002
         IC    R3,DBESIGN          R3= SIGN OF FIRST DBE EXPRESSION     39570002
         STH   R3,DBESNWRK         SAVE THE SIGN                        39620002
         SPACE                                                          39670002
****     START SUMMING UP THE PDE ADDR EXPRESSIONS                      39720002
VCK0620  DS    0H                  START OF LOOP SUMMING EXPRESSIONS    39770002
         LA    R1,N0(R1)           ZERO THE HIGH ORDER BYTE             39820002
         LTR   R7,R1               IS IT A NULL EXPRESSION POINTER      39870002
         USING EXPRPDE,R7          EST ADDR'ABILITY TO EXPRESSION PDE   39920002
         BZ    VCK0700             THIS EXPRESSION IS THRU              39970002
         L     R1,EXPRPTR           R1= ADDR OF THE NUMBER              40020002
         LH    R3,EXPRLNH           R3= LENGTH OF THE EXPRESSION        40070002
         TM    EXPRFLGS,EXPRHEX    IS THE NUMBER DECIMAL                40120002
         BZ    VCK0640             YES GO TO DECIMAL CONVERSION         40170002
         BAL   R14,HEXCVT          IT IS HEX CONVERT IT FOR SUM         40220002
         B     VCK0660             CONTINUE BY ADDING IN THE VALUE      40270002
VCK0640  DS    0H                  BAL TO THE DECIMAL CONVERSION        40320002
         BAL   R14,DECCVT          CONVERT THE VALUE FROM DECIMAL       40370002
VCK0660  DS    0H                  IS THE NUMBER PLUS OR MINUS          40420002
         CH    R2,PLUSIGN          IS IT A POSITIVE NUMBER              40470002
         BE    VCK0680             YES THEREFORE OK AS IT IS            40520002
         LCR   R1,R1               MUST COMPLEMENT AS IT IS NEGITIVE    40570002
VCK0680  DS    0H                  ADD IN THE CONVERTED VALUE           40620002
         A     R1,PDESMWRK         R1= SUM OF THE VALUES                40670002
         ST    R1,PDESMWRK         PLACE THE SUM IN PDE SUM (PDESMWRK)  40720002
         L     R1,EXPRCHAI         R1= ADDR OF THE NEXT EXPRESSION      40770002
         IC    R2,EXPRSIGN         R2= SIGN OF THE NEW EXPRESSION       40820002
         LH    R3,EXPRINDC         R3= PDE INDIRECT COUNT               40870002
         LTR   R3,R3               IF IT IS ZERO                        40920002
         BZ    VCK0620             CONTINUE WITH PDE EXPRESSIONS        40970002
         STH   R3,PDEIDWRK         SAVE THE INDIRECT COUNT              41020002
         SPACE                                                          41070002
****     THE PDE EXPRESSIONS HAVE BEEN SUMMED UP TO THE FIRST           41120002
****     DELIMITER (AN INDIRECT EXPRESSION, OR A NULL POINTER).         41170002
****     NOW LOOP THRU THE DBE EXPRESSIONS AND SUMM THEM UP             41220002
****     UNTIL A DELIMITER IS REACHED.                                  41270002
VCK0700  DS    0H                  GET THE CURRENT SIGN                 41320002
         LR    R4,R1               SAVE POINTER TO THE NEXT PDE EXP     41370002
         STH   R2,PDESNWRK         SAVE THE CURRENT SIGN LATTER USE     41420002
         L     R1,DBEXPWRK         R1= ADDR OF THE STARTING DBE EXP     41470002
         LH    R2,DBESNWRK         R2= SIGN OF THE STARTING DBE EXP     41520002
         SPACE                                                          41570002
VCK0720  DS    0H                  START OF LOOP SUMMING EXPRESSIONS    41620002
         LA    R1,N0(R1)           ZERO THE HIGH ORDER BYTE             41670002
         LTR   R7,R1               IS IT A NULL EXPRESSION POINTER      41720002
         BZ    VCK0800             THIS EXPRESSION IS THRU              41770002
         L     R1,EXPRPTR          R1= ADDR OF THE NUMBER               41820002
         LH    R3,EXPRLNH          R3= LENGTH OF THE EXPRESSION         41870002
         TM    EXPRFLGS,EXPRHEX    IS THE NUMBER DECIMAL                41920002
         BZ    VCK0740             YES GO TO DECIMAL CONVERSION         41970002
         BAL   R14,HEXCVT          IT IS HEX CONVERT IT FOR SUM         42020002
         B     VCK0760             CONTINUE BY ADDING IN THE VALUE      42070002
VCK0740  DS    0H                  BAL TO THE DECIMAL CONVERSION        42120002
         BAL   R14,DECCVT          CONVERT THE VALUE FROM DECIMAL       42170002
VCK0760  DS    0H                  IS THE NUMBER PLUS OR MINUS          42220002
         CH    R2,PLUSIGN          IS IT A POSITIVE NUMBER              42270002
         BE    VCK0780             YES THEREFORE OK AS IT IS            42320002
         LCR   R1,R1               MUST COMPLEMENT AS IT IS NEGITIVE    42370002
VCK0780  DS    0H                  ADD IN THE CONVERTED VALUE           42420002
         A     R1,DBESMWRK         R1= SUM OF THE VALUES                42470002
         ST    R1,DBESMWRK         PLACE THE SUM IN DBE SUM (DBESMWRK)  42520002
         L     R1,EXPRCHAI         R1= ADDR OF THE NEXT EXPRESSION      42570002
         IC    R2,EXPRSIGN         R2= SIGN OF THE NEW EXPRESSION       42620002
         LH    R3,EXPRINDC         R3= DBE INDIRECT COUNT               42670002
         LTR   R3,R3               IF IT IS ZERO                        42720002
         BZ    VCK0720             CONTINUE WITH DBE EXPRESSIONS        42770002
         STH   R3,DBEIDWRK         SAVE THE INDIRECT COUNT              42820002
         SPACE                                                          42870002
****     THERE NOW EXISTS TWO SUMS PDE SUM (PDESMWRK) AND DBE SUM       42920002
****    (DBESMWRK) ARE THESE SUM THE EQUAL                              42970002
VCK0800  DS    0H                  COMPARE THE SUMS                     43020002
         STH   R2,DBESNWRK         SAVE THE DBE SIGN IN WORKAREA        43070002
         L     R2,PDESMWRK         R2= PDE SUM (PDESMWRK)               43120002
         L     R3,DBESMWRK         R3= DBE SUM (DBESMWRK)               43170002
         CR    R2,R3               ARE THE TWO SUMS THE SAME            43220002
         BNE   VCK0520             RESTART THE CSECT SEARCH             43270002
****     SO FAR THE EXPRESSIONS MATCH CONTINUE                          43320002
****     NOW CHECK IF THE INDIRECT COUNTS MATCH                         43370002
         LH    R2,DBEIDWRK         R2= DBE INDIRECT COUNT               43420002
         LH    R3,PDEIDWRK         R3= PDE INDIRECT COUNT               43470002
         CR    R2,R3               ARE THE TWO INDIRECT COUNTS EQUAL    43520002
         BNE   VCK0520             NO THEREFORE RESTART CSECT SEARCH    43570002
         SPACE                                                          43620002
****     WERE THE INDIRECT COUNTS ZERO OR NON ZERO (THEY ARE EQUAL)     43670002
         LTR   R2,R2               WHAT TERMINATED THE PDE SCAN         43720002
         BNZ   VCK0820             TERMINATED BY AN INDIRECT COUNT      43770002
****     R1= ADDR OF NEXT DBE EXPRESSION, R4= ADDR OF NEXT PDE EXP      43820002
         LA    R1,N0(R1)           CLEAR HIGH ORDER BYTE OF DBE PTR     43870002
         LTR   R1,R1               IS IT A NULL DBE PTR                 43920002
         BNZ   VCK0820             NO CONTINUE EXPRESSION EVALUATION    43970002
         LA    R4,N0(R4)           CLEAR HIGH ORDER BYTE OF PDE PTR     44020002
         LTR   R4,R4               IS IT A NULL PDE PTR ALSO            44070002
         BZ    VCK0840             YES THEREFORE FREE THE CORE          44120002
         SPACE                                                          44170002
****     SAVE THE DBE INFORMATION (PTR AND SIGN) AND RESTART THE PDE    44220002
****     EXPRESSION EVALUATION                                          44270002
VCK0820  DS    0H                  SETUP TO RESTART EXP EVALUATION      44320002
         ST    R1,DBEXPWRK         SAVE THE DBE PTR IN WORKAREA         44370002
         LR    R1,R4               R1= PTR TO NEXT PDE EXPRESSION       44420002
         LH    R2,PDESNWRK         R2= PDE EXPRESSION SIGN              44470002
         XC    DBEIDWRK(N2),DBEIDWRK ZERO DBE INDIRECT COUNT IN WRKAREA 44520002
         XC    PDEIDWRK(N2),PDEIDWRK ZERO PDE INDIRECT COUNT IN WRKAREA 44570002
         B     VCK0620             RESTART THE SEARCH                   44620002
         SPACE                                                          44670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 44720002
*        UPON ENTRY A MATCH HAS BEEN FOUND BETWEEN THE CURRENT PDE      44770002
*        AND A PDE OF A DEFERED BREAK POINT.                            44820002
*        NEXT SEE IF BOTH ARE A RANGE IF SO THE PROCESS MUST BE         44870002
*        REPEATED. ONCE THEY HAVE BEEN DETERMINED EQUAL THEY MAY BE     44920002
*        FREED. MAKE SURE THAT A NULL DME IS NOT CREATED.               44970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 45020002
VCK0840  DS    0H                  DOES A SECOND PDE EXIST              45070002
         TM    VCKSWWRK,RANSWWRK   IS RANGE SW ON                       45080002
         BO    VCK0860             YES THEREFORE REMOVE                 45090002
         L     R1,DBECHAIN         R1= ZERO IF A RANGE NOT SPECIFIED    45120002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 45170002
         LTR   R1,R1               DOES THE DBE PDE HAVE A SECOND HALF  45220002
         BZ    VCK0850             NO THEREFORE CK ORIGINAL PDE         45270002
****     THE DBE PDE WAS A RANGE WAS THE ORIGINAL PDE ALSO  A RANGE     45320002
         L     R1,PDECHAIN         R1= ZERO IF A RANGE NOT SPECIFIED    45370002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 45420002
         LTR   R1,R1               DOES THE INPUT PDE HAVE SECOND HALF  45470002
         BZ    VCK0520             NO RESTART THE CSECT SEARCH          45520002
****     SAVE THE INITIAL INFORMATION FOR THE DBE EXPRESSION EVALUATION 45570002
         MVC   DBEXPWRK(N4),DBEEXPTR SAVE THE ADDR OF FIRST DBE EXP     45620002
         XR    R3,R3               ZERO REGISTER 3                      45670002
         IC    R3,DBESIGN          R3= SIGN OF CURRENT DBE EXPRESSION   45720002
         STH   R3,DBESNWRK         SAVE THE SIGN                        45770002
****     SETUP ADDRESSABILITY TO THE SECOND HALF OF THE RESPECTIVE      45820002
****     DBE AND INPUT PDE'S...                                         45870002
         LA    R6,PDECHAIN         R6= ADDR OF SECOND HALF OF INPUT PDE 45920002
         LA    R5,DBECHAIN         R5= ADDR OF SECOND HALF OF DBE PDE   45970002
****     GET BOTH LOADNAMES AND COMPARE THEM                            46020002
         LA    R2,DMELOAD          R2= ADDR OF LOADNAME FROM DME        46070002
         L     R3,PDELDNAM         R3= ADDR OF THE PDE LOADNMAE         46120002
         LH    R4,PDELEN1          R4= LENGTH OF THE PDE LOAD NAME      46170002
         BCTR  R4,N0               DECREMENT R4 FOR EXECUTN OF COMPARE  46220002
         EX    R4,COMPARE          EXECUTE A COMPARE OF THE LOADNAMES   46270002
         BNE   VCK0520             LOADNAMES DO NOT AGREE RESTART CSECT 46320002
****                               SEARCH WITH NEXT DBE                 46370002
****     GET BOTH CSECT NAMES AND COMPARE THEM                          46420002
         L     R2,DBECTNAM         R2= ADDR OF CSECT NAME FROM DME PDE  46470002
         L     R3,PDECTNAM         R3= ADDR OF INPUT PDE CSECT NAME     46520002
         LH    R4,PDELEN1          R4= LENGTH OF INPUT PDE CSECT NAME   46570002
         BCTR  R4,N0               DECREMENT R4 FOR EXECUTN OF COMPARE  46620002
         EX    R4,COMPARE          EXECUTE A COMPARE OF THE LOADNAMES   46670002
         BNE   VCK0520             CSECTNAME DO NOT AGREE RESTART CSECT 46720002
****                               SEARCH WITH NEXT DBE                 46770002
         OI    VCKSWWRK,RANSWWRK   TURN ON THE RANGE INDICATOR          46780002
         B     VCK0545             CHECK IF THE SECOND HALF PDE'S EQUAL 46820002
         DROP  R7                  RELEASE ADDR'ABILITY TO EXP DSECT    46870002
         SPACE                                                          46920002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 46970002
*        THE GENERAL COMPARE INSTRUCTION WHICH IS EXECUTED IN THE       47020002
*        SEARCH FOR MATCH PDE'S AND DEFERED BREAK ELEMENTS.             47070002
*        R4 = LENGTH OF FIRST CHARACTER STRING (R3).                    47120002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 47170002
COMPARE  CLC   N0(N0,R3),N0(R2)    COMPARE THE STRINGS (R3 TO R2)       47220002
         SPACE                                                          47270002
VCK0850  DS    0H                  CHECK IF DE IS A RANGE               47272002
****     THE DBE PDE WAS NOT A RANGE WAS THE ORIGINAL PDE  A RANGE      47274002
         L     R1,PDECHAIN         R1= ZERO IF A RANGE NOT SPECIFIED    47276002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 47278002
         LTR   R1,R1               DOES THE INPUT PDE HAVE SECOND HALF  47278402
         BNZ   VCK0520             YES RESTART THE CSECT SEARCH         47278802
         SPACE                                                          47280002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   47320002
*        WE NOW HAVE COMPLETELY VARIFIED THAT THE TWO PDE'S (INPUT      47370002
*        AND DBE'S) MATCH, THEREFORE WE CAN NOW DELETE THE DBE,         47420002
*        THE PDE, THE INBUF, AND THE DME IF THIS WAS ITS ONLY DBE       47470002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   47520002
         SPACE                                                          47570002
VCK0860  DS    0H                  RELEASE THE DEFERED CORE             47620002
         L     R5,DBEPDWRK         R5= START OF CURRENT DBE-PDE         47630002
         OI    CHNGSWRK,VCKRMWRK+REMOVWRK  SET REMOVE SW         YM2245 47640002
         MVI   DBEFLG5,PDEYECH     TURN ON USELESS INDICATOR            47650002
         USING DBE,R7              RE-ESTABLISH ADDR'ABILITY TO THE DBE 47660002
         L     R7,DBESVWRK         R7= ADDR OF THE DBE TO BE FREED      47662002
****     START AT TOP OF DBE-PDE'S FOR USELESS CHECK (R5= ADDR'ABILITY) 47664002
         L     R5,DBEPDL           R5= ADDR OF THE FIRST PDE 0F DBE     47666002
         LA    R5,N8(R5)           R5= ADDR OF THE DBE-PDE BODY         47668002
****     MAKE SURE ALL OF THE DBE-PDE'S ARE USELESS IF SO FREE THE CORE 47668402
VCK0870  DS    0H                  SEARCH ALL DBE-PDE'S FOR USELESS     47668802
         TM    DBEFLG5,PDEYECH     IS THE USELESS BTI ON                47669202
         BZ    VCK0520             NO THEREFORE CONTINUE THE SEARCH     47669602
         L     R5,DBE2CHAI         R5= ADDR OF THE NEXT DBE-PDE         47669702
         LA    R5,N0(R5)           ZERO HIGH ORDER BYTE                 47669802
         LTR   R5,R5               IS THERE ANOTHER DBE-PDE             47669902
         BNZ   VCK0870             YES THRERFORE CONTINUE CHECK         47686602
         USING DBE,R7              RE-ESTABLISH ADDR'ABILITY TO THE DBE 47703302
         L     R7,DBESVWRK         R7= ADDR OF THE DBE TO BE FREED      47720002
         OI    CHNGSWRK,VCKRMWRK+REMOVWRK SET SW INDICATE BREAKPT REMOV 47770002
****     RELEASE THE PARSE PDL                                          47820002
         IKJRLSA DBEPDL            RELEASE THE PDL                      47870002
****     FREE THE INPUT BUFFER POINTED TO IN THE DBE                    47920002
         L     R1,DBEINBUF         R1= ADDR OF THE INBUF                47970002
         LH    R3,N0(R1)           R3= LENGTH OF THE BUFFER             48020002
         FREEMAIN RC,LV=(3),A=(1),SP=1 FREE INBUF                       48070002
****     ISSUE FREEMAIN TO FREE THE DBE                                 48072002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          48080002
         BZ    VCK0775              ZERO IMPLIES NO ERROR               48090002
         LA    R2,N120             SET SVC NUMBER                       48100002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 48110002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 48112002
VCK0775  DS    0H                                                       48162002
         LR    R1,R7               R1= ADDR OF DBE TO BE FREED          48170002
         L     R2,DBEDBE           R7= ADDR OF NEXT DBE IF ANY          48220002
         FREEMAIN RC,LV=12,A=(1),SP=1  ISSUE FREEMAIN OF DBE            48270002
****     R2= NEXT DBE, AND DBEBKWRK=PREVIOUS DBE OR ZERO (NO PREVIOUS)  48320002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          48330002
         BZ    VCK0778              ZERO IMPLIES NO ERROR               48340002
         LA    R2,N120             SET SVC NUMBER                       48350002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 48360002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 48362002
VCK0778  DS    0H                                                       48364002
         L     R7,DBEBKWRK         R7= ADDR OF PREVIOUS DBE             48370002
         LA    R7,N0(R7)           ZERO HIGH ORDER BYTE                 48420002
         LTR   R7,R7               IF ZERO FIRST DBE OF CHAIN           48470002
         BNZ   VCK0900             THERE ARE ADITIONAL DBE ELEMENTS     48520002
         LA    R2,N0(R2)           ZERO HIGH ORDER BYTE OF NEXT DBE PTR 48570002
         LTR   R7,R2               IF ZERO THERE IS NO NEXT DBE         48620002
         BNZ   VCK0880             NO THEREFORE PLACE ADDR IN DME       48670002
****     NO DBE ARE HANGING OFF THE DME SO FREE THE DME                 48720002
         LA    R1,N0(R8)           R1= ADDR OF THE DME TO BE FREED      48770002
         L     R3,DMEDME           R3= ADDR OF THE NEXT DME OR ZERO     48820002
         L     R2,DMEBKWRK         R2= ADDR OF DME POINTER OR DEFERTAB  48870002
         ST    R3,N0(R2)           LINK AROUND THE DME TO BE FREED      48920002
         FREEMAIN RC,LV=16,A=(1),SP=1  FREE THE DME...                  48970002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          48980002
         BZ    VCK0920              ZERO IMPLIES NO ERROR        YM4849 48990002
         LA    R2,N120             SET SVC NUMBER                       49000002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 49010002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 49012002
         B     VCK0920             ALL THRU WITH THIS ELEMENT ANY MORE  49020002
         SPACE                                                          49070002
****     PLACE THE ADDR OF THE NEXT DBE INTO THE DME                    49120002
VCK0880  DS    0H                  LINK IN THE DBE TO THE DME           49170002
         ST    R2,DMEDBE           DME PTS TO A DBE CHAIN               49220002
         B     VCK0460             ALL THRU WITH THIS ELEMENT ANY MORE  49270002
         SPACE                                                          49320002
****     JUST LINK AROUND THE REMOVED DBE                               49370002
****     ADDR'ABILITY CURRENTY IS TO THE PREVIOUS DBE                   49420002
VCK0900  DS    0H                  R2= ADDR OF DBE TO BE LINKED IN      49470002
         ST    R2,DBEDBE           RELINK THE DBE CHAIN                 49520002
         LR    R7,R2               R7= ADDR OF DBE TO RESTART SEARCH    49530002
         B     VCK0460             ALL THRU WITH THIS ELEMENT ANY MORE  49570002
         SPACE                                                          49620002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   49670002
*        THE PROCESSING IS NOW COMPLETE CHECK IF ANY BREAK POINTS       49720002
*        WERE REMOVED. THEN RETURN TO PARSE WITH THE RESPECTIVE         49770002
*        RETURN CODE.                                                   49820002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   49870002
VCK0920  DS    0H                  THE EXIT PORTION OF VALIDITY CHECK   49920002
         TM    CHNGSWRK,VCKRMWRK   WERE ANY BREAKPOINTS REMOVED         49970002
         BO    VCK0940             YES RETURN WITH A ZERO RET CODE      50020002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         50030002
         LR    R2,R6               R2= ADDR OF ADDR PDE (INSERT MSG)    50070002
         LA    R1,MSGIVBRK         SETUP MSG ID                         50120002
         BAL   R14,PUTMSG          SEND THE MESSAGE TO THE TERMINAL     50170002
VCK0930  DS    0H                  PARSE RE-ENTER ROUTINE               50180002
****     NOTE THAT REGISTER 2 CONTAINS ANY SECOND LEVEL OR ZERO         50190002
         LA    R15,N8              R15= 8, REENTER RETURN CODE          50220002
VCK0935  DS    0H                  RETURN TO PARSE WITH THE PARM BLOCK  50222002
         L     R1,PARETWRK         R1= ADDR OF PARSE PARM BLOCK         50230002
         L     R14,OUTBUF          GET OF POSSIBLE 2ND LEVEL MSG        50232002
         LH    R2,N0(R14)          GET POSSIBLE MESSAGE LENGTH          50234002
         LTR   R2,R2               DOES 2ND LEVEL EXIST                 50236002
         BZ    VCK0960             NO - RETURN TO PARS                  50238002
         ST    R14,N8(N0,R1)       SET PARS PTR TO 2ND LEVEL MESSAGE    50238402
         B     VCK0960             RETURN TO PARSE                      50270002
VCK0940  DS    0H                  SET RETURN CODE TO ZERO              50320002
         XR    R15,R15             R15= ZERO                            50370002
VCK0960  DS    0H                  RETURN TO PARSE                      50420002
         L     R13,N4(R13)         R13=ADDR OF CALLERS SAVE AREA        50470002
         NI    VCKSWWRK,HEXFF-VCKONWRK TURN OFF VALIDITY CK SW          50480002
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK INDIC    50490002
         RETURN (14,12),,RC=(15)   THE END (VALIDITY CHECK)             50520002
         DROP  R5                  RELEASE ADDR'ABILITY TO DBE'S PDE    50570002
         DROP  R6                  RELEASE ADDR'ABILITY TO THE PDE      50620002
         DROP  R7                  RELEASE ADDR'ABILITY TO THE DBE'S    50670002
         DROP  R8                  RELEASE ADDR'ABILITY TO THE DME'S    50720002
         EJECT                                                          50770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     50820002
*        THIS ROUTINE OUTPUTS ALL ERROR MESSAGES                        50870002
*        INPUT IS REGISTER 1, POINTS TO 2 WORD MESSAGE POINTER, AND     50920002
*        REGISTER 2 WHICH POINTS TO ADDR PDE IF ANY, (OR ZERO)          50970002
*        REGISTERS USED 1 THROUGH 5                                     51020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     51070002
         SPACE                                                          51120002
PUTMSG   DS    0H                  THE GENERAL ERROR MSG HANDLER        51170002
         ST    R14,PUTREWRK        SAVE THE RETURN ADDR OF CALLER       51220002
****     FIRST SETUP  SECOND LEVEL POINTER**************                51270002
         L     R3,N4(R1)           GET SECOND LEVEL MSG ID              51280002
         L     R4,N0(R1)           GET FIRST LEVEL MSG ID               51290002
         XC    TSTOIPRM(L'TSTOIPRM),TSTOIPRM  CLEAR MSG AREA            51370002
         SLL   R15,N2              MULTIPLY CODE BY 4                   51370402
         B     CHOICE(R15)         BRANCH TO APPROPRIATE IO MACRO       51372002
CHOICE   B     CHOICE1             R15 = 0                              51374002
         B     CHOICE1             R15 = 1                              51376002
         B     CHOICE2             R15 = 2                              51378002
         B     CHOICE3             R15 = 3                              51378402
CHOICE1  DS    0H                 MESSAGE WITH NO INSERTS               51392002
         IKJEGSIO MSG,FIRST=(R4),SECOND=(R3),ID=OFF23,MF=(E,TSTOIPRM)   51400002
CHKIORC  SR    R1,R1              WAS IO SUCCESSFUL                     51402002
         LA    R1,N12             PUT DEC 12 IN R1                      51402402
         CR    R15,R1             WAS IO SUCCESSFUL                     51404002
         BNH   SETRC              YES, CONTINUE                         51410002
         B     VCK0960            RET TO CALLER (PARSE) WITH IO RET CD  51412002
SETRC    L     R14,PUTREWRK       PREPARE TO RET TO PARSE WITH APPR CD  51414002
         BR    R14                 RETURN                               51416002
         SPACE                                                          51420002
CHOICE2  DS    0H                  MESSAGES WITH PDE INSERTS            51430002
         IKJEGSIO MSG,FIRST=(R4),INST11=(APDE,(R2)),                   *51440002
               SECOND=(R3),ID=OFF23,MF=(E,TSTOIPRM)                     51442002
         B     CHKIORC   GO DETERMINE PROPER RETCODE AND RETURN         51444002
         SPACE                                                          51444402
CHOICE3  DS    0H                  MESSAGES WITH INSERT FROM MSG CSECT  51446002
         IKJEGSIO MSG,FIRST=(R4),INST11=(NUM,(R2)),                    *51448002
               SECOND=(R3),ID=OFF23,MF=(E,TSTOIPRM)                     51448402
         B     CHKIORC   GO DETERMINE PROPER RETCODE AND RETURN         51448802
         SPACE                                                          51450002
         SPACE                                                          52110002
         EJECT                                                          53070002
SVCERR   ST    R14,PUTREWRK      SAVE RETURN ADDRESS                    53072002
         LR    R3,R1              SET ABEND CODE FOR ABENDREG           53072402
         LR    R4,R15             SET RETURN CODE                       53074002
         XC    TSTOIPRM(L'TSTOIPRM),TSTOIPRM                            53076002
         LTR   R1,R1              ARE WE COMMING FROM ESTAE             53076402
         ST    R2,REGSVWRK        PRESERVE REGISTER 2                   53076502
         BNZ   SVCLINK            NO                                    53076802
         IKJEGSIO SVCERR,SVC=(R2),ID=OFF23,MF=(E,TSTOIPRM)              53078002
         L     R2,REGSVWRK        RESTORE REGISTER 2                    53078402
         B     CHKIORC            GO RETURN WITH APPROPRIATE RC         53078802
SVCLINK  IKJEGSIO SVCERR,SVC=(R2),ABENDRG=(R3),MF=(E,TSTOIPRM),        *53079202
               ID=OFF23,INST11=(NUM,I0033)                              53079302
         L     R2,REGSVWRK        RESTORE REGISTER 2                    53081302
         B     CHKIORC            GO RETURN WITH APPROPRIATE RC         53081602
MSGFPREG DC    F'101'               INVALID ADDRESS                     53086302
         DC    F'274'               REG NOTATN MUST BE IND GEN REG      53088602
MSGPRS0C DC    F'104'               OFF FAILED                          53090902
         DC    F'277'               PARSE ERROR CODE 12                 53093202
MSGPRS10 DC    F'103'               NOT ENOUGH STORAGE TO EXECUTE CMD   53103202
         DC    F'000'                                                   53105202
MSGNOQUE DC    F'101'               INVALID ADDRESS                     53105602
         DC    F'205'               BREAKPOINT QUEUES EMPTY             53106002
MSGNOBRK DC    F'9'                 NO BRKPTS FOUND ON ACT OR DEF QUE   53106102
         DC    F'000'               THERE IS NO 2ND LEVEL MSG           53106202
MSGIVPDE DC    F'101'               INVALID ADDRESS                     53106402
         DC    F'208'               INVALID PDE OBTAINED FROM PARSE     53106502
MSGIVADR DC    F'101'               INVALID ADDRESS                     53117002
         DC    F'204'               UNABLE TO CONVERT ADDR TO BINARY    53127002
MSGIVRNG DC    F'073'               INVALID RANGE              @YM07108 53127902
         DC    F'207'               1ST ADDR OF RNG MUST NOT BE > LAST  53131402
MSGIVBRK DC    F'8'                 INVALID BREAKPT ADDR                53135002
         DC    F'206'               UNABLE TO LOCATE BREAKPT            53138502
         EJECT                                                          53149002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     53159502
*        THIS ROUTINE CONVERTS HEXIDECIMAL INPUT TO BINARY FORM         53170002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     53220002
         SPACE                                                          53270002
HEXCVT   DS    0H                  CONVERT THE VALUE TO BINARY          53320002
         SPACE                                                          53370002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   53420002
*        R1 = THE ADDRESS OF THE EXPRESSION TO BE CONVERTED             53470002
*        R3 = THE LENGTH OF THE EXPRESSION                              53520002
*        REGISTERS USED ARE 1,2,3. ONLY REGISTER 2 IS SAVED.....        53530002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   53570002
         SPACE                                                          53620002
         ST    R2,REGSVWRK         SAVE THE CURRENT VALUE OF R2         53630002
         STH   R3,TEMCTWRK         SAVE THE COUNT FOR LATTER USE        53670002
         BCTR  R3,N0               DECREMENT R3 FOR EXECUTION OF MOVE   53720002
         EX    R3,MOVEHEX          PLACE THE STRING IN THE WORKAREA     53770002
         LR    R1,R3               R1= LENGTH TO BE CONVERTED           53780002
         XR    R3,R3               ZERO REGISTER THREE                  53820002
         XR    R2,R2               ZERO REGISTER 0                      53870002
HEX0020  DS    0H                  START OF LOOP OF CONVERSION          53920002
         IC    R2,CONVTWRK(R1)     R2= RIGHT HAND CHARACTER OF STRING   53970002
         CH    R2,HEXCVTC7         IS THE CHARACTER A THRU F            54020002
         BH    HEX0040             NO THEREFORE NEED LOWER HALF BYTE    54070002
         LA    R2,HEX09(R2)        INCREMENT LOWER HALF BYTE            54120002
HEX0040  DS    0H                  R1 = PORTION OF CONVERTED NUMBER     54170002
         SRDL  R2,N4               PLACE NUMERIC PORTION INTO R3        54220002
         BCTR  R1,N0               DECREMENT R1 FOR LOOPING             54270002
         LTR   R1,R1               IS THERE MORE OF THE STRING          54320002
         BNM   HEX0020             YES CONTINUE UNTIL STRING EMPTY      54370002
         LH    R2,TEMCTWRK         R2= ORIGINAL LENGTH OF LIST          54420002
         SLL   R2,N2               MULTIPLY LENGTH BY FOUR              54470002
         LA    R1,N32              R1= NUMERIC 32 (DECIMAL)             54520002
         SR    R1,R2               R1= 32-(LENGTH*4)                    54570002
         SRL   R3,N0(R1)           R3= CONVERTED NUMBER IN LOWER HALF   54620002
         LR    R1,R3               R1= VALUE OF CONVERT HEX NUMBER      54630002
         L     R2,REGSVWRK         RESTORE THE VALUE OF R2              54640002
         BR    R14                 RETURN TO THE CALLER                 54670002
MOVEHEX  MVC   CONVTWRK(N0),N0(R1) MOVE STRING TO WORKAREA              54720002
         EJECT                                                          54770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     54820002
*        THIS ROUTINE CONVERTS DECIMAL INPUT TO BINARY FORM             54870002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     54920002
         SPACE                                                          54970002
DECCVT   DS    0H                  CONVERT THE VALUE TO BINARY          55020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   55070002
*        R1 = THE ADDRESS OF THE EXPRESSION TO BE CONVERTED             55120002
*        R3 = THE LENGTH OF THE EXPRESSION                              55170002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   55220002
         SPACE                                                          55270002
         BCTR  R3,N0               DECREMENT R3 FOR EXECUTION OF PACK   55320002
         EX    R3,DECPACK          PACK THE EXPRESSION                  55370002
         CVB   R1,CONVTWRK         R1= EXPRESSION CONVERTED TO BINARY   55420002
         BR    R14                 RETURN TO THE CALLER                 55470002
DECPACK  PACK  CONVTWRK(N8),N0(N0,R1) PACK INTO THE WORKAREA            55520002
         EJECT                                                          55570002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 55620002
*        THE STAE MACRO, RETRY ROUTINE, AND ABEND TABLE                 55670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   55720002
STAELIST ESTAE MF=L                LIST FORM OF ESTAE MACRO             55730002
STAELN   EQU   *-STAELIST          END OF STAE EXPANSION                55820002
ABENDTAB DS    0H                  THE ABEND TABLE FOR STAE             55920002
         DC    X'63'               CORRECT MESSAGE POINTER              56070002
         DC    AL3(SMTPARS)        EXPAND                               56120002
         DC    X'FF'               END OF TABLE INDICATOR               56170002
****     THE BEGINING OF THE RETRY ROUTINE                              56220002
RETRYRTN DS    0H                  THE RETRY ROUTINE                    56270002
         L     R5,CVTPTR           R5= ADDR OF THE CVT                  56320002
         USING CVT,R5              ESTABLISH ADDR'ABILITY TO THE CVT    56370002
         L     R1,CVTTCBP          R1= ADDR OF NEW CURRENT TCB'S        56420002
         L     R5,N4(,R1)          R5= ADDR OF CURRENT TCB (TEST TCB)   56470002
         DROP  R5                  RELEASE ADDR'ABILITY TO THE CVT      56520002
         USING TCB,R5              ESTABLISH ADDR'ABILITY TO THE TCB    56570002
         L     R9,TCBTRN           R9= ADDR OF TCOMTAB (RESTORE)        56620002
         DROP  R5                  RELEASE ADDR'ABILITY TO TCB          56670002
****     REESTABLISH ADDRESSABILITY TO OFF WORKAREA                     56720002
         L     R8,WORKAREA         R8= ADDR OF GENERAL WORKAREA         56770002
         USING TSTCWORK,R8         ADDR'ABILITY TO TSTCWORK             56820002
         LA    R10,CWORKCMD        R10= ADDRESS OF OFF'S WORKAREA       56870002
         DROP  R8                  RELEASE ADDRABILITY                  56880002
         USING OFFWORKA,R10        COMPLETE ADDRABILITY                 56890002
         TM    VCKSWWRK,VCKONWRK   CURRENTLY IN VALIDITY CHECK          56900002
         BO    STA0000             WE ARE IN VALIDITY CHECK ROUTINE     56910002
         L     R13,REGSAVE2        R13= ADDR OF REGULAR SAVEAREA        56912002
         B     STA0020             CONTINUE STAE PROCESSING             56914002
STA0000  DS    0H                  IN VALIDITY CHECK                    56916002
         L     R13,REGSAVE3        R13= ADDR OF VALIDITY CHECK SAVEAREA 56918002
STA0020  DS    0H                  CONTINUE RESTORING INSTRUCTION       56918402
         LM    R14,R12,N12(R13)    RESTORE ALL REGISTERS FOR OFF        56919202
         SPACE                                                          56970002
****     CHECK IF WE ARE CURRENTLY IN THE VALIDITY CHECK ROUTINE        57320002
         LA    R15,N20             R15= DEC 20 (RETURN CODE)            57330002
         TM    VCKSWWRK,VCKONWRK   CURRENTLY IN VALIDITY CHECK          57370002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY INDICATOR         57380002
         BO    VCK0120             RETURN TO PARSE WITH 12              57420002
         B     OFF0320             RETURN TO CALLER (MAINLINE)          57520002
ADDRETRY DC    A(RETRYRTN)         ADDRESS OF RETRY ROUTINE             57522002
LIST     IKJEGSPL RTRY=RETRYRTN,ABNTB=ABENDTAB,MODNM=IKJEGOFF,TNM=OFF   57530002
         EJECT                                                          57570002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57620002
*          CONSTANTS USED BY THE OFF COMMAND                            57670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   57720002
         DS    0F                  ALIGNMENT                            57770002
TWELVE   DC    F'12'              CONSTANT USED TO CHECK RETURN CODES   57780002
MASKF8   DC    X'00FFFFF8'         MASK TO ZERO TOP BYTE LOWER 3 BITS   57820002
ZEROS    DC    X'00000000'         FULL WORD OF ZEROS                   57870002
SUBPOOL1 DC    X'01000000'         SUBPOOL ONE                          57920002
HEXCVTC7 DC    X'00C7'             FIRST HEX ALPHA NOT ACCEPTABLE       57970002
PLUSIGN  DC    X'004E'             PLUS SIGN                            58020002
TEXTPLUS EQU   C'+'                PLUS SIGN FOR THE ERROR MESSAGES     58070002
DCBOFLGS EQU   X'30'               DISPLACEMENT IN TSTSYMWK TO DCB ADDR 58120002
SUPERZAP DC    50CL1'Z'            PATCH AREA                           58130002
         SPACE 2                                                        58170002
****     PCL   ADDRESS VCON                                             58820002
PCLADDR  DC    V(IKJEGPCL)         ADDRESS OF THE PCL CSECT             58870002
         EJECT                                                          58920002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   58970002
*        PARSE PARMETER CONTROL LIST                                    59020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   59070002
IKJEGPCL IKJPARM                                                        59120002
GETADDR  IKJPOSIT ADDRESS,LIST,RANGE,VALIDCK=IKJEGVCK                   59170002
         IKJENDP                                                        59220002
         EJECT                                                          59270002
         EJECT                                                          66220002
************************************************************            66270002
**                                                        **            66320002
**                  TCOMTAB DSECT                         **            66370002
**                                                        **            66420002
************************************************************            66470002
TCOMTAB TCOMTAB                                                         66520002
         EJECT                                                          66570002
************************************************************            66620002
**                                                        **            66670002
**                TCB DSECT                               **            66720002
**                                                        **            66770002
************************************************************            66820002
          IKJTCB                                                        66870002
************************************************************            66920002
**                                                        **            66970002
**             CVT DSECT MACRO EXPANSION                  **            67020002
**                                                        **            67070002
************************************************************            67120002
CVT      DSECT                                                          67170002
         CVT                                                            67220002
         EJECT                                                          67270002
************************************************************            67320002
**                                                        **            67370002
**                  RB DSECT                              **            67420002
**                                                        **            67470002
************************************************************            67520002
         SPACE                                                          67570002
         IKJRB               REQUEST BLOCK DSECT                        67620002
         EJECT                                                          67670002
         IKJEGDME            DEFERED BREAKELEMENT                       67720002
         SPACE                                                          67770002
         IKJEGDBE            DEFERED MODULE ELEMENT                     67820002
         EJECT                                                          67870002
************************************************************            67920002
**                                                        **            67970002
**                     BREAKPOINT QUEUE DSECT             **            68020002
**                                                        **            68070002
************************************************************            68120002
         BRKELEM                                                        68170002
         EJECT                                                          68220002
************************************************************            68270002
**                                                        **            68320002
**             DSECT DESCRIBING  PARSE ADDR*SS PDE        **            68370002
**                                                        **            68420002
************************************************************            68470002
         IKJPARMA                                                       68520002
         EJECT                                                          68570002
************************************************************            68620002
**                                                        **            68670002
**                           WORKAREA DSECT               **            68720002
**                                                        **            68770002
************************************************************            68820002
OFFWORKA DSECT                     DSECT TO ADDRESS OFF'S WORKAREA      68870002
STAEWRK  DS    3F                  STAE EXPANSION AREA                  68920002
PPLWRK   DS    7F                  PARSE'S PPL EXPANSION AREA           68970002
REG14WRK DS    1F                  TEMPORARY SAVE AREA FOR REG 14       69020002
RETCDWRK DS    A                   RETURN CODE SAVE AREA                69070002
DBEPDWRK DS    A                   SAVE AREA FOR DBE-PDE ADDRESS        69130002
PARETWRK DS    A                   VALIDITY CK RETURN CD                69170002
DBESVWRK DS    A                   VALIDITY CK CSECT SEARCH RESUME ADDR 69220002
DBESMWRK DS    1F                  DBE SUM OF THE EXPRESSION VALUES     69270002
PDESMWRK DS    1F                  PDE SUM OF THE EXPRESSION VALUES     69320002
DBESNWRK DS    H                   DBE SIGN OF NEXT EXPRESSION          69370002
PDESNWRK DS    H                   PDE SIGN OF NEXT EXPRESSION          69420002
DBEXPWRK DS    A                   DBE RESUME EXPRESSION POINTER        69470002
DMEBKWRK DS    A                   PREVIOUS DME ENCOUNTERED IN SEARCH   69520002
DBEBKWRK DS    A                   PREVIOUS DBE ENCOUNTERED IN SEARCH   69570002
DBEIDWRK DS    H                   DBE INDIRECT COUNT                   69620002
PDEIDWRK DS    H                   PDE INDIRECT COUNT                   69670002
CHNGSWRK DS    1X                  SWITCH INDICATES WHAT'S BEEN REMOVED 69720002
VCKRMWRK EQU   X'08'               SW TO VALIDITY CK INDICATING REMOVAL 69770002
REMOVWRK EQU   X'02'               SW TO MAIN RTN INDICATING REMOVAL    69820002
VCKSWWRK DS    1X                  SW INDICATING IN VALIDITY ROUTINE    69830002
RANSWWRK EQU   X'04'               INDICATES RANGE IN PROCESS           69840002
VCKONWRK EQU   X'08'               SW IS ON AT PRESENT                  69880002
TEMCTWRK DS    2X                  TEMPORARY COUNT FOR HEXCVT           69920002
CONVTWRK DS    D                   DOUBLE WORD USED BY CONVERSION RTN'S 69970002
DCBARWRK DS    F                   TEMPORARY AREA FOR DCB ADDRESS       70020002
PUTREWRK DS    F                   PUT MESSAGE RETURN REGISTER          70070002
SRHAWRK  DS    0F                  PARAMETER AREA FOR SEARCH ROUTINE    70080002
SRH1WRK  DS    1F                  FIRST WORD FOR FLAGS                 70090002
SRH2WRK  DS    1F                  SECOND WORD FOR BEGINNING ADDRESS    70100002
SRH3WRK  DS    1F                  THIRD WORD FOR ENDING ADDR (OR ZERO) 70110002
REGSVWRK DS    1F                  TEMP SAVE AREA FOR A REGISTER        70160002
         EJECT                                                          70170002
         IKJPPL               PARSE PARAMETER LIST DSECT                70220002
         EJECT                                                          70270002
         TSTCWORK             TEST WORKAREA DSECT                       70320002
         EJECT                                                          70370002
************************************************************            70420002
**         DEFER QUEUE  PDE                               **            70470002
************************************************************            70520002
DBEPDECT DSECT                     DSECT USED TO ADDR PDE ON DEFERRED Q 70570002
*                                                                       70620002
DBELDNAM DS    A                   POINTER TO LOADNAME                  70670002
DBELEN1  DS    H                   LENGTH OF LOADNAME                   70720002
DBEFLG1  DS    X                   FLAG FOR LOADNAME                    70770002
DBERSV1  DS    X                   NOT USED                             70820002
DBECTNAM DS    A                   POINTER TO ENTRYNAME                 70870002
DBELEN2  DS    H                   LENGTH OF ENTRYNAME                  70920002
DBEFLG2  DS    X                   FLAG FOR ENTRY NAME                  70970002
DBERSV2  DS    X                   NOT USED                             71020002
DBEADRPT DS    A                   POINTER TO THE ADDRESS STRING        71070002
DBELEN3  DS    H                   LENGTH OF ADDRESS STRING             71120002
DBEFLG3  DS    X                   FLAG FOR THE ADDRESS STRING          71170002
DBERSV3  DS    X                   NOT USED                             71220002
DBEFLG4  DS    X                   ADDRESS TYPE FLAG                    71270002
DBESIGN  DS    C                   EXPRESSION SIGN                      71320002
DBEINDCT DS    H                   INDIRECT COUNT                       71370002
DBEEXPTR DS    A                   POINTER TO FIRST EXPRESSION PDE      71420002
DBEFLG5  DS    0X                  FLAG BYTE PDEUSER WORD               71470002
DBEUSER  DS    A                   RESOLVED ADDR OR SIB POINTER         71520002
DBECHAIN DS    A                   CHAIN POINTER FOR ADDR LIST          71570002
         ORG   DBECHAIN            RANGE                                71580002
DBE2LDNA DS    A                   POINTER TO LOADNAME                  71590002
DBE2LEN1 DS    H                   LENGTH OF LOADNAME                   71600002
DBE2FLG1 DS    X                   FLAG FOR LOADNAME                    71610002
DBE2RSV1 DS    X                   NOT USED                             71612002
DBE2CTNA DS    A                   POINTER TO ENTRYNAME                 71614002
DBE2LEN2 DS    H                   LENGTH OF ENTRYNAME                  71616002
DBE2FLG2 DS    X                   FLAG FOR ENTRY NAME                  71618002
DBE2RSV2 DS    X                   NOT USED                             71618402
DBE2ADRP DS    A                   POINTER TO THE ADDRESS STRING        71618802
DBE2LEN3 DS    H                   LENGTH OF ADDRESS STRING             71619202
DBE2FLG3 DS    X                   FLAG FOR THE ADDRESS STRING          71619602
DBE2RSV3 DS    X                   NOT USED                             71619702
DBE2FLG4 DS    X                   ADDRESS TYPE FLAG                    71619802
DBE2SIGN DS    C                   EXPRESSION SIGN                      71619902
DBE2INDC DS    H                   INDIRECT COUNT                       71636602
DBE2EXPT DS    A                   POINTER TO FIRST EXPRESSION PDE      71646602
DBE2FLG5 DS    0X                  FLAG BYTE PDEUSER WORD               71648602
DBE2USER DS    A                   RESOLVED ADDR OR SIB POINTER         71650602
DBE2CHAI DS    A                   CHAIN POINTER FOR ADDR LIST          71652602
         EJECT                                                          71653302
         EXPRPDE                                                        71670002
         END                                                            72270002
