         EJECT                                                          00020002
PSW      TITLE 'IKJEGPSW - TSO TEST LIST PSW ROUTINE'                   00050002
         COPY  IKJEGSIO                                                 00060002
         EJECT                                                          00070002
IKJEGPSW CSECT                                                          00100002
*A086600,099924,292100                                           YA2414 00110002
*C259000,259220                                                  YM4111 00120002
* A 148000,148030                                    @ZA07138,@ZA09259  00130000
*********************************************************************** 00150002
*                                                                     * 00250002
* STATUS --                                                           * 00300002
*    CHANGE LEVEL 00, VERSION NUMBER 02, OS/VS2  (05/17/73)           * 00350002
*                                                                     * 00400002
* FUNCTION/OPERATION --                                               * 00450002
*    THIS COMMAND PROGRAM RECEIVES CONTROL FROM THE TEST SUBCOMMAND   * 00500002
*    PROCESSOR.  IT DISPLAYS THE PSW OF THE PROBLEM PROG OR THE PSW   * 00550002
*    AT A SPECIFIED ADDRESS. IT DISPLAYS THE PSW IN EITHER BC OR EC   * 00600002
*    MODE; BIT NUMBER 13 OF THE PSW IS THE INDICATOR; (0= BCMODE) AND * 00610002
*    (1= EC MODE).                                                    * 00610402
*                                                                     * 00650002
* ENTRY POINTS --                                                     * 00700002
*         IKJEGPSW    MAIN ENTRY TO LISTPSW ROUTINE                   * 00750002
*         PSWVALCK    ENTRY TO PARSE ADDRESS VALIDITY CHECK EXIT RT   * 00800002
*                                                                     * 00850002
* INPUT --                                                            * 00900002
*    ONE LINE OF INPUT FROM THE TERMINAL CONTAINING THE SUBCOMMAND    * 00950002
*                                                                     * 01000002
* OUTPUT --                                                           * 01050002
*    LINES OF OUTPUT TO THE TERMINAL OR TO A SPECIFIED DATA SET,      * 01100002
*    THE FIRST BEING A HEADER AND THE SECOND THE PSW FIELDS           * 01150002
*                                                                     * 01200002
* EXTERNAL REFERENCES --                                              * 01250002
*         1.  IKJPARS  - TO SCAN THE INPUT BUFFER                     * 01300002
*         2.  IKJEGCVT - TO CHECK AND CONVERT THE ADDR, IF SPECIFIED, * 01350002
*         AND TO CONVERT THE PSW TO PRINTABLE HEX                     * 01400002
*         3.  IKJEGIO  - TO OUTPUT THE HEADER AND PSW                 * 01450002
*                                                                     * 01500002
* EXITS, NORMAL --                                                    * 01550002
*         RETURN TO IKJEGMNL VIA REGISTER14                           * 01600002
*                                                                     * 01650002
* EXITS, ERROR --                                                     * 01700002
*         NONE                                                        * 01750002
*                                                                     * 01800002
* TABLES/WORK AREAS --                                                * 01850002
*    TCOMTAB - TEST TABLE AND WORKAREA                                * 01900002
*                                                                     * 01950002
* ATTRIBUTES --                                                       * 02000002
*    REENTRANT ROUTINE                                                * 02050002
*    REFRESHABLE ROUTINE                                              * 02100002
*                                                                     * 02150002
* CHARACTER CODE DEPENDENCY --                                        * 02200002
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 02250002
*                                                                     * 02300002
* NOTES --                                                            * 02350002
*    IF AN ADDRESS IS SPECIFIED NEITHER BOUNDARY ALIGNMENT OR DATA    * 02400002
*    VALIDITY IS CHECKED                                              * 02450002
*                                                                       02457000
* CHANGE-ACTIVITY -                                                     02464000
*                 APAR OZ07138 - CHANGES TO USE THE CORRECT RB          02471000
*                 POINTER TO FETCH THE PSW FOR DISPLAY. THE             02478000
*                 POINTER IS IN TCOMTAB AT ECBPP+1.                     02485000
*                 APAR OZ09259 - THE SAME AS ABOVE.                     02488000
*                                                                       02492000
*                                                                     * 02500002
*********************************************************************** 02550002
         EJECT                                                          02600002
*********************************************************************** 02650002
*                                                                     * 02700002
*          REGISTER EQUATES                                           * 02750002
*                                                                     * 02800002
*********************************************************************** 02850002
         SPACE 2                                                        02900002
R0       EQU   0                   REGISTER 0                           02950002
R1       EQU   1                   REGISTER 1                           03000002
R2       EQU   2                   REGISTER 2                           03050002
R3       EQU   3                   REGISTER 3                           03100002
R4       EQU   4                   REGISTER 4                           03150002
R5       EQU   5                   CONTAINS ADDRESS OF WORKAREA         03200002
R6       EQU   6                   REGISTER 6                           03250002
R7       EQU   7                   REGISTER 7                           03300002
R8       EQU   8                   REGISTER 8                           03350002
R9       EQU   9                   BASE FOR TCOMTAB                     03400002
R10      EQU   10                  REGISTER 10                          03450002
R11      EQU   11                  NOT USED                             03500002
R12      EQU   12                  BASE FOR IKJEGPSW                    03550002
R13      EQU   13                  REGISTER 13                          03600002
R14      EQU   14                  REGISTER 14                          03650002
R15      EQU   15                  REGISTER 15                          03700002
         SPACE 2                                                        03750002
*********************************************************************** 03800002
*                                                                     * 03850002
*        OTHER EQUATES                                                * 03900002
*                                                                     * 03950002
*********************************************************************** 04000002
N0       EQU   0                   DECIMAL 0                            04050002
N1       EQU   1                   DECIMAL 1                            04100002
N2       EQU   2                   DECIMAL 2                            04150002
N3       EQU   3                   DECIMAL 3                            04200002
N4       EQU   4                   DECIMAL 4                            04250002
N5       EQU   5                   DECIMAL 5                            04300002
N6       EQU   6                   DECIMAL 6                            04350002
N7       EQU   7                   DECIMAL 7                            04400002
N8       EQU   8                   DECIMAL 8                            04450002
N9       EQU   9                   DECIMAL 9                            04500002
N10      EQU   10                  DECIMAL 10                           04550002
N11      EQU   11                  DECIMAL 11                           04600002
N12      EQU   12                  DECIMAL 12                           04650002
N16      EQU   16                  DECIMAL 16                           04700002
N20      EQU   20                  DECIMAL 20                           04750002
N22      EQU   22                  DECIMAL 22                           04800002
N24      EQU   24                  DECIMAL 24                           04850002
N26      EQU   26                  DECIMAL 26                           04900002
N28      EQU   28                  DECIMAL 28                           04950002
N30      EQU   30                  DECIMAL 30                           05000002
N31      EQU   31                  DECIMAL 31                           05010002
N32      EQU   32                  DECIMAL 32                           05050002
N40      EQU   40                  DECIMAL 40                           05100002
N52      EQU   52                  DECIMAL 52                           05110002
N53      EQU   53                  DECIMAL 53                           05120002
N65      EQU   65                  DECIMAL 65                           05150002
N66      EQU   66                  DECIMAL 66                           05200002
N67      EQU   67                  DECIMAL 67                           05250002
N68      EQU   68                  DECIMAL 68                           05300002
N79      EQU   79                  DECIMAL 79                           05350002
N80      EQU   80                  DECIMAL 80                           05400002
N104     EQU   104                 DECIMAL 104                          05450002
PLUSSIGN EQU   C'+'                PLUS SIGN INDICATE 1ST LEV HAS A 2ND 05500002
NOTSYM   EQU   10                  BC INSTR MASK, BRANCH POSTIVE OR 0   05550002
ADDR     EQU   X'80'               ADDRESS STRING INDICATOR IN PDE      05600002
         SPACE                                                          05610002
*********************************************************************** 05620002
*        MESSAGE EQUATES                                                05622002
*********************************************************************** 05630002
MSG101   EQU   101                 INVALID ADDR MSG (APDE INSERT)       05640002
MSG274   EQU   274                 REG MUST BE INDIRECT GEN (SECOND)    05642002
MSG282   EQU   282                 PSW EXTENDS INTO PROTECTED CORE      05644002
MSG103   EQU   103                 NO CORE MSG NO SECOND LEVEL          05644402
MSG104   EQU   104                 LISTPSW FAILED----                   05646002
INST15   EQU   15                  LISTPSW FIXED INSERT NO.             05648002
MSG277   EQU   277                 PARSE ERROR CODE 12 (SECOND LEVEL)   05648402
         EJECT                                                          05650002
         SAVE  (14,12),,*          SAVE MAINLINE'S REGS                 05700002
         LR    R12,R15             USE ENTRY POINT FOR BASE             05750002
         USING IKJEGPSW,R12        ESTABLISH PROGRAM ADDRESSABILITY     05800002
         USING TCOMTAB,R9          ESTABLISH TCOMTAB ADDRESSABILITY     05850002
         L     R15,REGSAVE2        LOAD ADDRESS OF NEW SAVE AREA        05900002
         ST    R13,N4(R15)         STORE REG 13 IN NEW SAVE AREA        05950002
         ST    R15,N8(R13)         STORE NEW SAVE AREA ADDRESS          06000002
         LR    R13,R15             R13 NOW HAS NEW SAVE AREA ADDRESS    06050002
         L     R7,WORKAREA         LOAD ADDRESS OF TEST WORKAREA        06100002
         USING TSTCWORK,R7                                              06150002
         LA    R5,CWORKCMD         ADDRESS OF WORK AREA FOR CMDS        06200002
         USING PSWAREA,R5          ESTABLISH ADDRESSABILITY             06250002
         DROP  R7                                                       06300002
         ST    R12,N68(R13)        SAVE MY BASE IN MY SAVE AREA         06650002
         XC    STAELIST(N16),STAELIST  CLEAR THE STAE PARM LIST         06700002
         L     R2,TSTSTAE          R2= ADDR OF IKJEGSTA                 06710002
         ESTAE (R2),CT,PARAM=PSWSPL,RECORD=YES,MF=(E,STAELIST)          06750002
         LTR   R15,R15             WAS STAE ISSUED SUCCESSFULLY         06800002
SMTSTAE  DS    0H                  SMT TESTCASE LABEL                   06850002
         BZ    GOPARSE             YES, GO SET UP TO PARSE COMMAND      07000002
         STC   R15,TSTESTRC        SAVE THE RETURN CODE FOR MNL         07050002
         LA    R15,N24             R15=24 RETURN CODE TO MNL ESTAE FAIL 07150002
         B     RETURN2             EXIT TO MNL                          07200002
         EJECT                                                          07250002
GOPARSE  EQU   *                                                        07300002
         LR    R1,R5               ADDR OF WORK AREA, BUILD PARSE LIST  07350002
         USING PPL,R1                                                   07400002
         MVC   PPLUPT(N12),PARMLIST MOVE ECT, UPT, ECB TO PARSE         07410002
         MVC   PPLPCL(N4),PCLADDR  POINTER TO PCL FOR PARSE             07600002
         LA    R2,TSTANSPL         LOAD ADDRESS OF PARSE ANSWER PLACE   07650002
         ST    R2,PPLANS           STORE IN PARM LIST FOR PARSE         07700002
         MVC   PPLCBUF(N4),INBUF   POINTER TO COMMAND INPUT BUFFER      07750002
         ST    R9,PPLUWA           STORE ADDRESS OF TCOMTAB             07800002
         DROP  R1                                                       07850002
         LINK  EP=IKJPARS,ERRET=LINKFAIL  PARSE THE COMMAND             07900002
PABEND1  EQU   *                   POSSIBLE ABEND RESUME ADDRESS        07950002
SMTPARS  DS    0H                  SMT TESTCASE LABEL                   08000002
*                                   LINK TO PARSE FAILED                08050002
*                                   TESTCASE ID  TPSW2100               08100002
         B     PARSEEND            AFTER PARSE IS COMPLETE, BRANCH      08150002
         EJECT                                                          08200002
********************  VALIDITY CHECK ROUTINE  ************************  08210002
         SPACE                                                          08220002
*********************************************************************** 08250002
*        THE FOLLOWING IS EXECUTED IMMEDIATELY BEFORE A BRANCH TO     * 08300002
*        IKJEGCVT WHICH VALIDITY CHECKS THE ADDRESS SPECIFIED BY USER * 08350002
*        THIS CODE WILL NOT BE EXECUTED IF THE USER DOES NOT SPECIFY  * 08400002
*        AN ADDRESS                                                   * 08450002
*********************************************************************** 08500002
         SPACE                                                          08550002
PSWVALCK SAVE  (14,12),,*          SAVE PARSE REGISTERS                 08600002
         LR    R2,R1               R2 = ADDR OF PDE                     08650002
         L     R9,N4(R1)           RESTORE TCOMTAB ADDRESSABILITY       08652002
         OI    TSTFLGS4,TSTVALCK   INDICATE VALIDITY CHECK              08654002
         L     R12,REGSAVE2        LOAD ADDRESS OF PSW REGISTERS        08656002
         L     R5,N40(R12)         RESTORE WORKAREA ADDRESS             08658002
         ST    R1,PARMPTR          ADR OF PARSE LST FOR EXIT RT  YM4111 08660002
         L     R1,OUTBUF           R1= ADDR OF OUTBUFFER                08710002
         XC    N0(N4,R1),N0(R1)    CLEAR THE FIRST WORD OF OUTBUF       08720002
         L     R12,N68(R12)        RESTORE PROGRAM ADDRESSABILITY       08850002
         L     R15,REGSAVE3        LOAD ADDRESS OF NEW SAVE AREA        08900002
         ST    R13,N4(R15)         STORE REG 13 IN NEW SAVE AREA        08950002
         ST    R15,N8(R13)         STORE NEW SAVE AREA ADDRESS          09000002
         LR    R13,R15             R13 NOW HAS NEW SAVE AREA ADDRESS    09050002
****     R7 NOW CONTAINS THE ADDR OF THE PDE                            09060002
         USING IKJPARMA,R7         ADDR'ABILITY TO THE PDE              09070002
         L     R7,N0(R2)           POINTER TO ADDRESS PDE               09100002
         LNR   R1,R7               NEGATIVE, ADDR CONVERSION            09150002
         LPR   R0,R7               POSTIVE, CONVERT TO BINARY           09200002
         L     R15,TSTCONVT        LOAD ADDRESS OF IKJEGCVT             09250002
         BALR  R14,R15             VALIDITY CHECK THE ADDRESS           09300002
         SPACE 1                                                        09350002
*********************************************************************** 09400002
*        THE FOLLOWING CODE IS EXECUTED UPON RETURN FROM IKJEGCVT     * 09450002
*********************************************************************** 09500002
         SPACE 1                                                        09550002
         LTR   R15,R15             IS RETURN CODE 0                     09650002
         BZ    CHKADDR             YES, GO CHECK ADDRESS                09700002
         LA    R6,N4               CONVERT UNSUCCESSFUL RETURN CODE     09800002
         CR    R6,R15              WAS CONVERT UNSUCCESSFUL             09850002
         BNE   STOP                NO, WORST TROUBLES, GO SET ENDUP     09900002
         LA    R15,N8              R.C.=8, HAVE PARSE PRINT REENTER     09950002
PARSRTRN EQU   *                                                        09960002
         NI    TSTFLGS4,HEXFF-TSTVALCK  TURN OFF VALIDITY CHECK SWITCH  09970002
         L     R1,OUTBUF           R1= ADDR OF THE OUTPUT BUFFER        09980002
         OC    N0(N4,R1),N0(R1)    IS OUTBUF CLEAR                      09990002
         BZ    RETCONT             CONTINUE TO EXIT TO PARSE            09992002
         L     R2,PARMPTR          RESTORE THE PARM POINTER      YM4111 09992402
         ST    R1,N8(R2)           PLACE ADDR OF SEC LEVEL MSG IN PPL.  09994002
RETCONT  EQU   *                   WE NOW ARE READY TO RETURN TO PARSE  09996002
         L     R13,N4(R13)                                              10000002
         RETURN (14,12),,RC=(15)   RESTORE REGISTERS AND RETURN         10050002
CHKADDR  EQU   *                                                        10100002
         L     R3,PDEUSER          CONVERTED ADDR - USER WORD IN PDE    10150002
         TM    PDEFLG5,PDESIB      IS PDEUSER A SIB POINTER             10160002
         BNO   CHKMORE             NO CONTINUE CHECKING                 10170002
         L     R3,N0(R3)           R3 = ACTUAL ADDRESS FROM SIB         10180002
CHKMORE  EQU   *                                                        10350002
         LA    R3,N0(R3)           ZERO HIGH ORDER BYTE OF PDEUSER      10360002
         ST    R3,PDEUSER          REPLACE ACTUAL ADDRESS IN PDEUSER    10370002
         SR    R15,R15             SUCCESSFUL RETCODE FOR PARSE         10400002
         LH    R4,PDEINDCT         INDIRECT COUNT                       10550002
         LTR   R4,R4               IS ADDRESS INDIRECT                  10600002
         BZ    CHKREG              NO, CHECK FOR REGISTER ADDRESS       10650002
         SPACE                                                          10916602
*-*-*    THE FOLLOWING CALL TO IGC0009G IS TO VALIDITY CHECK THE END OF 10918602
*-*-*    THE PSW                                                        10920602
CHKEND   DS    0H                  ADDRESS CHECK END OF PSW             10926602
         LA    R3,N7(R3)           R3= ADDRESS OF END OF PSW            10936602
         L     R4,PPTCB            R4= ADDR OF THE PP TCB               10946602
         IKJEGS9G ADDRCHK,TCBADDR=(R4),VALUE=(R3),MF=(E,TEMPWRK) SVC 97 10956602
         LA    R4,N16              R4= 16 IS THE RETURN CODE 20 OR 24.  10957002
         CR    R15,R4              IS THE R. C. GREATER THAN 16.        10957102
         BNL   STOP                SVC 97 HAD A PROBLEM SO END IT.      10957402
         LA    R4,N8               R4=8 RETURN CODE BAD ADDRESS         10958602
         CR    R15,R4              COMPARE WITH RETURN CD FROM SVC 97   10960602
         BL    ADDROK              THE ADDRESS IS VALID                 10962602
         LA    R2,MSG101           R2= 101 FIRST LEVEL MSG              10964602
         LA    R3,MSG282           R3= 282 SECOND LEVEL MSG             10965002
         B     MSGOUTA             OUTPUT MESSAGE WITH ADDR PDE INSERT  10965402
         SPACE                                                          10965802
ADDROK   DS    0H                  RETURN WITH ZERO RETURN CODE         10966202
         SR    R15,R15             R15= ZERO                            10966302
         B     PARSRTRN            RETURN TO PARSE                      10966402
         SPACE                                                          10966602
CHKREG   EQU   *                                                        11050002
         TM    PDEFLG4,HEX38       WAS ADDRESS A REGISTER               11100002
         BZ    CHKEND              NO, GO SEE IF COMPLETE PSW IN CORE   11150002
         LA    R2,MSG101           R2= 101 FIRST LEVEL MSG NO           11200002
         LA    R3,MSG274           R3= 274 SECOND LEVEL MSG NO.         11250002
         B     MSGOUTA             OUTPUT THE MESSAGE WITH ADDR PDE     11260002
         EJECT                                                          11270002
*********************************************************************** 11280002
*        MESSAGE OUTPUTTING SECTION NOTE R2= FIRST LEVEL NUMBER,        11282002
*        R3= SECOND LEVEL NUMBER.                                       11284002
*********************************************************************** 11290002
         SPACE                                                          11340002
MSGOUTA  DS    0H                  OUTPUT MESSAGE R7= ADDR PDE INSERT   11390002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM AREA         11440002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(APDE,(R7)),       *11490002
               ID=PSW25,MF=(E,TSTIOPRM)   OUTPUT CALL                   11540002
         LTR   R15,R15             IS R.C. 0, I/O SUCCESSFUL            12250002
         BNE   IOFAILED            NO, GO CHECK R.C. FROM I/O           12300002
         LA    R15,N8              YES, PROMPT R.C. FOR PARSE           12350002
         B     PARSRTRN            GO RETURN TO PARSE                   12400002
         DROP  R7                  RELEASE PDE ADDR'ABILITY             12410002
IOFAILED EQU   *                                                        12450002
         LA    R6,N16              I/O UNSUCCESSFUL RETURN CODE         12500002
         CR    R6,R15              WAS I/O UNSUCCESSFUL                 12550002
         BNL   STOP                NO, WORST TROUBLES, GO SET ENDUP     12600002
         SR    R15,R15             YES, CREATE 0 R.C. FOR MAINLINE      12650002
STOP     EQU   *                                                        12700002
         ST    R15,ANSWPLAC        SAVE ENDUP RETURN CODE               12750002
         LA    R15,N12             SET ENDUP R.C. FOR PARSE             12800002
         B     PARSRTRN            GO RETURN TO PARSE                   12850002
         SPACE                                                          12860002
LINKFAIL DS    0H                  LINK FAILURE                         12870002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM AREA        12880002
         LR    R2,R15              R2= RETURN CODE                      12882002
         LR    R3,R1               R3= ABEND CODE                       12884002
         IKJEGSIO SVCERR,SVC=6,RC=(R2),ABENDRG=(R3),                   *12890002
               ID=PSW25,MF=(E,TSTIOPRM)                                 12892002
         LA    R8,N16              R8= 16 (RETURN CODE CHECKING)        12892802
         CR    R8,R15              IS THE RETURN CODE 16 OR GREATER     12893202
         BNL   RETURN2             YES THEREFORE LEAVE AS IS            12893602
         LA    R15,N20             SET RETURN CODE TO 20.               12893702
         B     RETURN2             EXIT WITH 20.                        12893802
         SPACE                                                          12896002
MSGOUT   DS    0H                  OUTPUT A MESSAGE FIXED INSERT(R4)    12898002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR PARM AREA            12898402
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(NUM,(R4)),        *12898802
               ID=PSW25,MF=(E,TSTIOPRM)  OUT PUT THE MESSAGE            12899202
         B     PSWRET              EXIT TO MNL                          12899602
         EJECT                                                          12933302
*********************************************************************** 12950002
*        THE FOLLOWING IS THE CODE EXECUTED UPON RETURN FROM PARSE    * 13000002
*********************************************************************** 13050002
         SPACE 1                                                        13100002
PARSEEND EQU   *                                                        13150002
         LTR   R15,R15             IS RETURN CODE 0                     13200002
         BNZ   PSWRET1             IF NO, BRANCH                        13250002
         L     R8,TSTANSPL         LOAD ADDRESS OF PDL                  13300002
         USING IKJPARMD,R8         ESTABLISH PDL ADDRESSABILITY         13350002
         LA    R4,N40              A OUTPUT LINE LENGTH                 13400002
         CH    R4,TMPLL            IS USER SPECIFIED LINE LENGTH LESS   13450002
         BH    LL80                YES, GO USE 80 FOR LINE LENGTH       13500002
         LA    R4,N80              NO, ANOTHER LINE LENGTH              13550002
         CH    R4,TMPLL            IS SPECIFIED LINE LENGTH GREATER     13600002
         BL    LL80                YES, GO USE 80 FOR LINE LENGTH       13650002
         LH    R4,TMPLL            NO, USE SPECIFIED LINE LENGTH        13700002
         B     LINESET             GO SET LINE LENGTH                   13750002
LL80     LA    R4,N80              DEFAULT LINE LENGTH TO 80            13800002
LINESET  ST    R4,LINELEN          STORE OUTPUT LINE LENGTH             13850002
         CLI   PRINTIT+N1,HEX00    WAS PRINT SPECIFIED                  13900002
         BNZ   PRINTSPC            BRANCH IF YES                        13950002
         XC    PRINTFLG(N4),PRINTFLG                                    14000002
         B     ADDRCHK             GO CHECK FOR ADDRESS                 14050002
PRINTSPC OI    TSTFLGS1,TSTPRINT   INDICATE I/O TO DATA SET             14100002
         LA    R3,DSNAME           ADDRESS OF DSNAME PDE                14150002
         ST    R3,PRINTFLG         STORE ADDRESS OF PDE                 14200002
ADDRCHK  EQU   *                                                        14200402
         LA    R8,ADDRESS          R8= ADDRESS OF THE PARSE (PDE)       14202002
         DROP  R8                  RELEASE ADDRESSIBILITY TO PARMD(PDL) 14210002
         USING IKJPARMA,R8         ESTABLISH ADDRIBILITY TO PARMA (PDE) 14220002
         L     R3,PDEUSER          USER WORD IN ADDR PDE                14300002
         LTR   R3,R3               WAS ADDRESS SPECIFIED BY USER        14350002
         BNZ   ADRSPECF            IF YES GO TO ADRSPECF                14400002
         TM    PDEFLG3,AFLG        WAS ADDRESS SPECIFIED BY USER        14450002
         BO    ADRSPECF            YES, GO GET SPECIFIED PSW            14500002
         SPACE 1                                                        14550002
*********************************************************************** 14600002
*        THE FOLLOWING CODE LOCATES THE PROBLEM PROGRAM PSW           * 14650002
*********************************************************************** 14700002
         SPACE 1                                                        14750002
         L     R2,ECBPP            GET POINTER TO SVRB         @ZA07138 14800000
*                                                              @ZA09259 14820000
         L     R2,RBLINK-RBSECT(R2) GET POINTER TO PP RB       @ZA07138 14840000
*                                                              @ZA09259 14860000
         MVC   PSWBUF(N8),RBOPSW-RBSECT(R2)  MOVE PSW TO WORK AREA      14950002
         B     PSWCONVT            BRANCH TO CONVERT PSW TO PRINTABLE   15000002
ADRSPECF EQU   *                                                        15050002
         L     R3,PDEUSER          USER WORD OF PDE                     15100002
PSWNOSYM MVC   PSWBUF(N8),N0(R3)   MOVE PSW TO WORK AREA                15300002
         DROP  R8                  RELEASE ADDRIBILITY TO THE (PDE)     15302002
RESTRBLO DS    0H                  STAE TABLE ENTRY FOR BAD ADDRESS     15310002
         SPACE 1                                                        15350002
*********************************************************************** 15400002
*        THE FOLLOWING CODE WILL CONVERT THE PSW FROM MACHINE         * 15450002
*        REPRESENTATION TO PRINTABLE HEX                              * 15500002
*********************************************************************** 15550002
         SPACE 1                                                        15600002
PSWCONVT EQU   *                                                        15650002
         L     R15,TSTCONVT        LOAD ADDRESS OF IKJEGCVT             15700002
         LA    R14,PSWBUF          POINT TO BINARY PSW                  15750002
         ST    R14,STRNGPTR        STORE IN PDE FOR IKJEGCVT            15800002
         MVC   CVTLL(N2),PSWLEN    STORE LENGTH OF PSW IN LIST          15850002
         MVI   FLAGS,FLAG          STORE FLAG IN PDE                    15900002
         MVI   TYPECODE,TYPE       STORE TYPE (HEX) IN PDE              15950002
         LA    R1,STRNGPTR         LOAD ADDRESS OF PDE                  16000002
         LNR   R0,R1               R0 NEGATIVE - CONVERT TO PRINTABLE   16050002
         BALR  R14,R15             GO CONVERT THE PSW TO PRINTABLE      16100002
         LTR   R15,R15             RETURN CODE 0                        16150002
         BNZ   PSWRET              IF NO, BRANCH                        16200002
         SPACE 1                                                        16250002
*********************************************************************** 16300002
*        THE FOLLOWING MOVES THE THREE FIELDS TO BE PRINTED IN HEX TO * 16350002
*        THE OUTPUT FIELD BUFFER                                      * 16400002
*********************************************************************** 16450002
         SPACE 1                                                        16500002
         L     R2,CONAREA          LOAD ADDRESS OF HEX PSW              16550002
         MVI   START,BLANK         BLANK OUT FIRST BYTE OF PSW BUFFER   16600002
         MVC   START+N1(N67),START   BLANK OUT REMAINDER OF PSW BUFFER  16650002
*********************************************************************** 16660002
*        DETERMINE WHAT MODE PSW WE HAVE, EC OR BC MODE                 16662002
*        BIT 13 = 0 IS BC, BIT 13 = 1 IS EC MODE                        16664002
*********************************************************************** 16670002
         TM    PSWBUF+N1,ECMODBIT    IS THE PSW AN ECMODE PSW           16680002
         BO    ECMODPSW              YES THE PSW IS EC MOD              16690002
         MVC   KEY(N1),N3(R2)        MOVE KEY TO OUTPUT BUFFER          16700002
         MVC   INTRPTCD(N4),N5(R2)   MOVE INTRPT CODE TO OUTPUT BUFFER  16750002
         MVC   INSTRADR(N6),N11(R2)  MOVE INSTR ADDR TO OUTPUT BUFFER   16800002
         SPACE 1                                                        16850002
*********************************************************************** 16900002
*        THE FOLLOWING CONVERTS THE REMAINING PSW FIELDS TO PRINTABLE * 16950002
*        BINARY AND TRANSFERS THEM TO THE OUTPUT BUFFER               * 17000002
*        THE SECTION OF THE BINARY PSW TO BE CONVERTED IS PUT IN REG7.* 17050002
*        BITS ARE SHIFTED ONE BY ONE INTO REG6.  ACCORDING AS THE BIT * 17100002
*        IS A ZERO OR A ONE A PRINTABLE ZERO OR ONE IS ADDED INTO R10 * 17150002
*        WHEN REG10 IS FULL (AFTER 4 BITS ARE CONVERTED) IT IS STORED * 17200002
*        IN THE WORKAREA.                                             * 17250002
*********************************************************************** 17300002
         SPACE 1                                                        17350002
         MVC   PSWBUF+N2(N1),PSWBUF+N4    MOVE BINARY FIELDS TOGETHER   17400002
         SR    R3,R3                                                    17450002
         SR    R2,R2                                                    17500002
         IC    R3,ZERO             LOAD CHARACTER 0 INTO REGISTER       17550002
         IC    R2,ONE              LOAD CHARACTER 1 INTO REGISTER       17600002
         SR    R6,R6                                                    17650002
         LA    R4,N4               BIT COUNTER                          17700002
         L     R7,PSWBUF           LOAD BINARY PSW                      17750002
         LA    R8,SYSMASK          POINT TO OUTPUT AREA FOR FIELDS      17800002
LOOP1    SLDL  R6,N1(R0)           SHIFT ONE BIT INTO R6                17850002
         LTR   R6,R6               IS IT A ZERO                         17900002
         BE    ZEROBIT             IF YES, BRANCH                       17950002
ONEBIT   SLL   R10,N8(R0)          OTHERWISE IT IS A ONE                18000002
         AR    R10,R2              PUT A CHARACTER ONE IN LOW BYTE      18050002
         SR    R6,R6               ZERO OUT R6 FOR NEXT BIT             18100002
         B     EIGHTBCT            GO CHECK IF R10 IS FULL              18150002
ZEROBIT  SLL   R10,N8(R0)                                               18200002
         AR    R10,R3              PUT A CHARACTER ZERO IN LOW BYTE     18250002
EIGHTBCT BCT   R4,LOOP1            IF R10 IS NOT FULL, BRANCH           18300002
         ST    R10,N0(R8)          STORE R10 IN WORK AREA               18350002
         LA    R8,N4(R8)           INCREMENT OUTPUT POINTER             18400002
         LA    R4,TABLE            LOAD END OF PROCESSING CHECK         18450002
         CR    R8,R4               ARE ALL BITS CONVERTED               18500002
         BE    OUTPUTIT            IF YES, OUTPUT DATA                  18550002
         LA    R4,N4               RESET COUNTER FOR 4 MORE BITS        18600002
         B     LOOP1               CONVERT NEXT FOUR BITS               18650002
         SPACE                                                          18700002
*********************************************************************** 18750002
*        THE FOLLOWING SECTION OF CODE FORMATS THE EC MODE PSW          18752002
*        FIRST MOVE THE TO HEX FIELDS CONVERTED BY IKJEGCVT TO THE      18754002
*        OUTPUT FIELD BUFFER  (R2 = ADDRESS OF CONAREA)                 18756002
*********************************************************************** 18760002
ECMODPSW DS    0H                    EC MODE PSW FORMATTING             18760102
         USING CONAREAD,R2           SETUP DSECT FOR CONAREA            18760402
         MVC   ECKEY(N1),CONKEY      MOVE SYSTEM KEY TO PRINT AREA      18760802
         MVC   ECINADDR(N8),CONINADR MOVE INST ADDR INTO PRINT AREA     18761202
         DROP  R2                    RELEASE CONAREA ADDR'ABILITY       18761602
         SPACE                                                          18761702
**********************************************************************  18761802
*        THE NEXT SECTION SETS UP THE BIT PATTERN IN A TEMPORARY        18769402
*        WORKAREA AND THEN MOVES THE AREA TO OUTPUT AREA                18771402
**********************************************************************  18777202
         LA    R7,N31                R7= 31 COUNT BITS TO BE FORMATTED  18778002
         L     R2,PSWBUF             R2= FIRST HALF OF THE PSW          18779202
ECLOOP   SRDL  R2,N1                 PLACE 1 BIT INTO REG 3             18781202
         SRL   R3,N31                MOVE BIT T0 LOWER POSITION         18783202
         A     R3,F0MASK             ADD THE 'F' INTO REG 3 (PRINTABLE) 18783602
         STC   R3,ECTEMPST(R7)       PLACE CHARACTER IN TEMPORARY AERA  18784002
         BCTR  R7,N0                 DECREMENT R7 BY ONE (COUNTER)      18784402
         LTR   R7,R7                 IS THE COUNT ZERO                  18784502
         BNM   ECLOOP                NO WE ARE NOT DONE CONTINUE        18784602
         MVC   ECSYSMK2(N8),ECSYSMSK MOVE TO LINE BUFFER                18784702
         MVC   ECAMWP2(N4),ECAMWP    MOVE TO LINE BUFFER                18797702
         MVC   ECSPM2(N1),ECSPM      MOVE TO LINE BUFFER                18807702
         MVC   ECCC2(N2),ECCONDC     MOVE TO LINE BUFFER                18809702
         MVC   ECPROGMK(N4),ECPRGMSK MOVE TO LINE BUFFER                18810102
         L     R10,OUTBUF            R10= ADDR OF THE OUTPUT BUFFER     18810202
         CLI   LINELEN+N3,HEX36      IS LINE LEN LESS THAN HEADER LEN   18810302
         BL    ECBUILD               YES, BUILD A SECOND LINE           18810402
         LA    R2,N53                R2= HEADER LENGTH - 1              18813802
         LA    R3,ECHEADER           R3= ADDRESS OF EC MODE HEADER      18815802
         LA    R6,START2             R6= ADDR OF START OF ACTUAL OUTPUT 18816202
         BAL   R8,PSWIO              PUT OUT THE LINES                  18816602
         B     PSWRET                CONTINUE TO OUTPUT THE LINE        18817202
         SPACE                                                          18817602
****     BUILD TWO LINES OF THE HEADER                                  18819202
ECBUILD  DS    0H                    BUILD TWO LINES OF OUTPUT          18819602
         LA    R2,N31                MINIMUM LINE LENGTH                18820002
         LA    R3,N11(R2)            WILL PROGRAM MASK FIT IN LINE      18820102
         C     R3,LINELEN            DOES THE PROGRAM MASK FIT          18820202
         BH    ECFULINE              NO OUTPUT THE LINE AS IS           18820402
         LR    R2,R3                 YES OUTPUT THE LINE WITH PROG MASK 18821002
ECFULINE DS    0H                    LINE IS FULL AND OUTPUT IS READY   18822602
         BCTR  R2,N0                 OUTPUT DATA LEN -1                 18823302
         LA    R3,ECHEADER           R3= ADDR OF THE EC MODE HEADER     18824002
         LA    R6,START2             R6= ADDR OF START OF ACTUAL OUTPUT 18824602
         BAL   R8,PSWIO              GO AND OUTPUT THE LINES            18826602
         LA    R3,N1(R2,R3)          ADDR OF REMAINING HEADER TO OUTPUT 18828602
         LA    R6,N1(R2,R6)          ADDR OF REMAINING DATA TO OTUPUT   18828702
         LA    R8,N52                MAXIMUM LENGTH OF HEADER MINUS TWO 18832902
         SR    R8,R2                 LENGTH OF THE DATA MINUS ONE       18834902
         LR    R2,R8                 R2= PROPER LENGTH                  18836902
         BAL   R8,PSWIO              OUTPUT THE REMAINING TWO LINES     18837302
         B     PSWRET                RETURN TO CALLER                   18847702
         SPACE                                                          18858402
*********************************************************************** 18868802
*        THE FOLLOWING CODE SETS THE OUTPUT LINE LENGTH               * 18879202
*********************************************************************** 18889602
         SPACE 1                                                        18900002
OUTPUTIT MVC   SYSMASK2(N8),SYSMASK     MOVE TO FIELD BUFFER            18950002
         MVC   AMWP2(N4),AMWP           MOVE TO FIELD BUFFER            19000002
         MVC   ILC2(N2),ILC             MOVE TO FIELD BUFFER            19050002
         MVC   CC2(N2),CC               MOVE TO FIELD BUFFER            19100002
         MVC   PROGM2(N4),PROGMASK      MOVE TO FIELD BUFFER            19150002
         L     R10,OUTBUF               POINT TO OUTPUT BUFFER          19200002
         CLI   LINELEN+N3,HEX43    IS LINE LEN LESS THAN HEADER LEN     19250002
         BL    BUILDIT             YES, GO BUILD 2 OUTPUT LINES         19300002
         LA    R2,N66              OUTPUT DATA LENGTH-1                 19350002
         LA    R3,HEADER           ADDRESS OF HEADER TO PUT OUT         19400002
         LA    R6,START            ADDRESS OF PSW DATA TO PUT OUT       19450002
         BAL   R8,PSWIO            GO PUT OUT LINES                     19500002
         B     PSWRET              GO SET UP FOR RETURN TO CALLER       19550002
BUILDIT  EQU   *                                                        19600002
         LA    R2,N40              MINIMUN LINE LENGTH                  19650002
         LA    R3,N4(R2)           MINMIUN LL PLUS CC FIELD             19700002
         C     R3,LINELEN          WILL CC FIELD FIT IN LINE            19750002
         BH    FULLLINE            NO, LINE FULL, GO PUT OUT            19800002
         LR    R2,R3               LENGTH SO FAR                        19850002
         LA    R3,N11(R2)          LEN SO FAR PLUS PROG MASK FIELD      19900002
         C     R3,LINELEN          WILL PROG MASK FIT IN LINE           19950002
         BH    FULLLINE            NO, LINE FULL, GO PUT OUT            20000002
         LR    R2,R3               YES, PUT IT OUT                      20050002
FULLLINE EQU   *                                                        20100002
         BCTR  R2,N0               OUTPUT DATA LENGTH-1                 20150002
         LA    R3,HEADER           ADDRESS OF HEADER TO PUT OUT         20200002
         LA    R6,START            ADDRESS OF PSW DATA TO PUT OUT       20250002
         BAL   R8,PSWIO            GO PUT OUT LINES                     20300002
         LA    R3,N1(R2,R3)        ADDR OF REST OF HEADER TO PUT OUT    20350002
         LA    R6,N1(R2,R6)        ADDR OF REST OF PSW DATA             20400002
         LA    R8,N65              MAXMIUN LENGTH OF HEADER MINUS 2     20450002
         SR    R8,R2               LEN OF DATA MINUS ONE                20500002
         LR    R2,R8               IN PROPER REGISTER                   20550002
         BAL   R8,PSWIO            GO PUT OUT LAST TWO LINES            20600002
         B     PSWRET              GO SET FOR RETURN TO CALLER          20650002
         EJECT                                                          20700002
*********************************************************************** 20750002
*        THE FOLLOWING ROUTINE BUILDS AND PUTS OUT THE HEADER AND PSW * 20800002
*        LINES.  R2 IS THE LENGTH-1 OF OUTPUT, R3 IS THE STARTING     * 20850002
*        ADDRESS OF THE HEADER AND R6 IS THE STARTING ADDRESS OF THE  * 20900002
*        PSW DATA.  R8 IS THE RETURN ADDRESS.                         * 20950002
*********************************************************************** 21000002
         SPACE 1                                                        21050002
PSWIO    EQU   *                                                        21100002
         L     R10,OUTBUF          ADDRESS OF COMMON TEST OUTPUT BUFF   21150002
         MVI   N0(R10),HEX40       BLANK                                21200002
         MVC   N1(N79,R10),N0(R10)     OUTBUF                           21250002
         EX    R2,MOVE2            MOVE HEADER TO OUTBUF                21400002
         LA    R2,N5(R2)           LENGTH OF OUTPUT FOR I/O             21450002
         SLL   R2,N16              LENGTH IN HIGH ORDER HALF WORD       21500002
         ST    R2,N0(R10)          PREFIX OUTPUT WITH LENGTH            21550002
         BAL   R14,DATAOUT         GO TO I/O ROUTINE, PUT OUT HEADER    21800002
         XC    PRINTFLG(N4),PRINTFLG   REMOVE THE PRINT DSN INDICATOR   21850002
         SRL   R2,N16              LENGTH IN LOW ORDER HALFWORD OF REG  21950002
         SH    R2,FOUR             LEN-1 OF PSW DATA TO MOVE            22000002
         EX    R2,MOVE3            MOVE PSW DATA TO OUTBUF              22050002
         BAL   R14,DATAOUT         GO TO I/O ROUTINE, PUT OUT PSW       22200002
         BR    R8                  YES, RETURN TO CALLER                22350002
         SPACE 1                                                        22400002
*********************************************************************** 22450002
*        DATA IS A CALL TO IKJEGIO USING IKJEGSIO MACRO AND THE DATA    22450402
*        OPTION.  OUTBUF CONTAINS THE DATA PRINTFLG THE DS ADDR         22451202
*********************************************************************** 22452002
         SPACE                                                          22454002
DATAOUT  DS    0H                  OUTPUT THE  DATA LINE                22456002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR THE OUTPUT AREA     22458002
         ST    R14,TEMPWRK         SAVE THE RETURN ADDR                 22458402
         ST    R3,TEMPWRK2         SAVE THE CURRENT R3                  22462102
         L     R3,PRINTFLG         R3= ADDR OF DATA SET FOR IO.         22464102
         EJECT                                                          22465202
         L     R4,OUTBUF           R4=ADDR OF THE OUTPUT                22466702
         IKJEGSIO DATA,DATAPTR=(R4),DSNAME=(R3),ID=PSW25,              *22470402
               MF=(E,TSTIOPRM)     OUTPUT DATA                          22474102
         L     R14,TEMPWRK         PICK UP RETURN ADDR                  22477802
         L     R3,TEMPWRK2         RESTORE THE OLD VALUE TO R3.         22479802
         LTR   R15,R15             WHAT IS THE RETURN CODE              22481502
         BNZ   PSWRET              IF NON-ZERO EXIT                     22485202
         BR    R14                 RETURN TO CALLER                     22488902
         SPACE 1                                                        22492602
*********************************************************************** 22496302
* THE FOLLOWING CODE PROCESSES RETURN CODES AND SETS UP FOR OUTPUT OF * 22500002
* MESSAGES.  PSWRET ANALYSES CODES FROM IKJEGIO1 AND IKJEGCVT.        * 22550002
* PSWRET1 ANALYSES RETURN CODES FROM PARSE.                           * 22600002
*********************************************************************** 22650002
         SPACE 1                                                        22700002
PSWRETRY EQU   *                                                        22750002
         L     R9,CVTPTR           ADDRESS OF CVT                       22800002
         L     R9,CVTTCBP-CVT(R9)  POINTER TO NEW, CURRENT TCBS         22850002
         L     R9,N4(R9)           ADDRESS OF CURRENT TCB IS TEST TCB   22900002
         L     R9,TCBTRN-TCB(R9)   ADDRESS OF TCOMTAB                   22950002
         L     R13,REGSAVE2        ADDRESS OF MY SAVE AREA              23000002
         L     R12,N68(R13)        MY BASE                              23050002
         LA    R8,N20              ABEND RETURN CODE FOR MAINLINE       23100002
         B     RETURN              GO RETURN TO MAINLINE                23300002
EXITERR  EQU   *                                                        23350002
         L     R15,ANSWPLAC        VALIDITY EXIT SAVED RETURN CODE      23400002
PSWRET   EQU   *                                                        23450002
         LA    R8,N16                                                   23500002
         CR    R8,R15              RETURN CODE 16                       23550002
         BNL   RETURN2             IF YES (16 OR GREATER) BRANCH        23600002
         SR    R8,R8               SET RETURN CODE TO 0                 23800002
         B     RETURN              GO SET UP RETURN                     23850002
PSWRET1  EQU   *                   PARSE RETURN CODE ANALYSIS           23900002
         LA    R8,N8               PARSE ATTENTION R.C.                 24050002
         CR    R8,R15              WAS AN ATTENTIOM SCHEDULED           24100002
         LA    R8,N16              MAINLINE ATTENTION RETURN CODE       24150002
         BE    RETURN              IF ATT SCHEDULED, GO SET UP RETURN   24200002
         LA    R8,N20              VALIDITY EXIT SEEKS END, R.C.  PARSE 24250002
         CR    R8,R15              DID VALIDITY EXIT SEEK TERMINATION   24300002
         BE    EXITERR             IF YES, GO SET UP RETURN             24350002
         LA    R8,N16              PARSE R.C. FOR NO CORE AVAILABLE     24400002
         CR    R8,R15              WAS PARSE ABLE TO GET CORE           24450002
         BE    MNLRC24             RETURN TO MNL WITH 24                24550002
         LA    R8,N12              PARSE R.C. FOR INVALID PARAMETERS    24600002
         CR    R8,R15              WERE INVALID PARMS SPECIFIED         24650002
         LA    R2,MSG104           R2= 104 FIRST LEVEL MSG NO.          24700002
         LA    R3,MSG277           R3= 277 SECOND LEVEL MSG NO.         24710002
         LA    R4,INST15           R4= FIXED INST NO. 15 (LISTPSW)      24720002
         BE    MSGOUT              GO HAVE MESSAGE PUT OUT              24750002
         SR    R8,R8               PARSE RC=4, NO MESSAGE               24850002
         OI    TSTFLGS4,TSTFLUSH   IF STACK, TELL MNL TO FLUSH          24900002
         B     RETURN              GO RETURN TO CALLER                  24950002
         SPACE                                                          25210002
MNLRC24  DS    0H                  RETURN WITH A 24                     25220002
         LA    R2,MSG103           R2= 103 ADDR OF NO CORE MSG          25230002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARAM AREA        25240002
         IKJEGSIO MSG,FIRST=(R2),ID=PSW25,MF=(E,TSTIOPRM)               25242002
         B     PSWRET              HANDLE IO RETURN CODES               25244002
RETURN   EQU   *                                                        25250002
         LR    R15,R8              RETCODE IN PROPER REGISTER           25350002
RETURN2  DS    0H                  RETURN WITH WHAT IS IN R15           25352002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)                                25352402
*-*-*    ISSUE ESTAE 0 AND TURN OFF TSTRERTN SWITCH                     25354002
         LR    R2,R15              SAVE THE RETURN CODE                 25354402
         ESTAE 0                   REMOVE THE ESTAE                     25356002
         LR    R15,R2              RESTORE THE RETURN CODE              25356402
         NI    TSTFLGS4,(HEXFF-TSTRERTN)  TURN OFF RETRY SWITCH         25358002
         L     R13,N4(R13)                                              25400002
         RETURN  (14,12),T,RC=(15)                                      25450002
         EJECT                                                          25500002
************************************************************            25550002
*                                                          *            25600002
*            MISCELLANEOUS CONSTANTS                       *            25650002
*                                                          *            25700002
************************************************************            25750002
         SPACE 2                                                        25800002
HEADER   DC    C'  XRXXXTIE   KEY  CMWP  INTRPT CODE  ILC  CC  PROG MAS*25850002
               K  INSTR ADDR'                                    YA2414 25900002
ECHEADER DC    C'  XRXXXTIE   KEY  CMWP  SPM  CC  PROG MASK  INSTR ADDR*25920002
               '                                                 YA2414 25922002
OFFSET   EQU   64                  OFFSET OF PSWAREA INTO TEST AREA     25950002
HEX00    EQU   X'00'                                                    26000002
HEX38    EQU   X'38'                                                    26050002
HEX36    EQU   X'36'               HEXIDECIMAL 36                       26060002
HEX43    EQU   X'43'                                                    26100002
HEX40    EQU   X'40'                                                    26150002
PSWLEN   DC    X'0008'             LENGTH OF PSW                        26200002
FLAG     EQU   X'80'               FLAG FOR IKJEGCVT                    26250002
TYPE     EQU   X'04'               TYPE OF VALUE (HEX)                  26300002
ZERO     DC    C'0'                CHARACTER ZERO                       26350002
ONE      DC    C'1'                CHARACTER ONE                        26400002
TABLEVAL DC    X'0A0B04050D06050D' LENGTH OF PSW OUTPUT FIELDS, ONE     26450002
*                                  BYTE PER FIELD IN REVERSE ORDER      26500002
HEXFF    EQU   X'FF'                                                    26550002
ECMODBIT EQU   X'08'                 INDICATES EC MOD PSW               26570002
         DS    0F                  ALIGNMENT                            26572002
SUPERZAP DC    50CL1'Z'            PATCH AREA                           26580002
         DS    0F                  ALIGNMENT                            26582002
F0MASK   DC    X'000000F0'           MASK FOR FORMATTING BITS           26590002
PCLADDR  DC    A(IKJEGPWP)         ADDRESS OF PARSE CSECT               26600002
ABENDTAB DS    0F                                                       26650002
         DC    AL1(99)             LINK FAILED CODE                     26700002
         DC    AL3(PABEND1)        RESUME IC AFTER LINK                 26750002
         DC    AL1(97)             INVALID ADDRESS CODE                 26760002
         DC    AL3(RESTRBLO)       RESUME ADDRESS FOLLOWING PROT CHECK  26770002
         DC    X'FF'               END OF TABLE INDICATOR               26800002
PSWSPL   IKJEGSPL RTRY=PSWRETRY,ABNTB=ABENDTAB,MODNM=IKJEGPSW,         *26850002
               TNM=LISTPSW                                              26950002
MOVE2    MVC   N4(N1,R10),N0(R3)   MOVE HEADER TO OUTBUF                27000002
MOVE3    MVC   N4(N1,R10),N0(R6)   MOVE PSW DATA TO OUTBUF              27050002
FOUR     DC    H'4'                AMOUNT TO SUBTRACT FOR MOVE3         27100002
BLANK    EQU   C' '                                                     27150002
         EJECT                                                          27272202
*********************************************************************** 27282202
*        WORK AREA DESECT                                               27282602
*********************************************************************** 27284202
         SPACE                                                          27284602
PSWAREA  DSECT                                                          27286102
PARSELST DS    7F                  PARSE PARM LIST                      27300002
TEMPWRK2 DS    0F                  ALSO USED FOR TEMP SAVING REGS.      27310002
ANSWPLAC DS    1F                  VALIDITY CHECK EXIT RC FOR MAINLINE  27350002
PSWBUF   DS    2F                  BUFFER FOR PSW                       27400002
* IT IS ESSENTIAL THAT THE FOLLOWING 4 AREAS BE CONTIGUOUS AND IN ORDER 27450002
STRNGPTR DS    1F                  POINTER TO PSW                       27500002
CVTLL    DS    CL2                 LENGTH OF PSW                        27550002
FLAGS    DS    CL1                 FLAG FOR IKJEGCVT                    27600002
TYPECODE DS    CL1                 TYPE CODE (HEX) FOR IKJEGCVT         27650002
LINELEN  DS    1F                  OUTPUT LINE LENGTH                   27700002
PRINTFLG DS    1F                  ADDRESS OF DSNAME PDE OR ZERO        27750002
* IT IS ESSENTIAL THAT THE FOLLOWING 7 AREAS BE CONTIGUOUS AND IN ORDER 27800002
SYSMASK  DS    2F                  PRINTABLE SYSTEM MASK                27850002
         DS    1F                  WORD                                 27900002
AMWP     DS    1F                  PRINTABLE AMWP                       27950002
ILC      DS    CL2                 PRINTABLE ILC                        28000002
CC       DS    CL2                 PRINTABLE CC                         28050002
PROGMASK DS    1F                  PRINTABLE PROGRAM MASK               28100002
TABLE    DS    2F                  TABLE                                28150002
*IT IS ESSENTIAL THAT THE FOLLOWING 17 AREAS BE CONTIGUOUS AND IN ORDER 28200002
START    DS    CL2                 BLANKS                               28250002
SYSMASK2 DS    CL8                 PRINTABLE SYSTEM MASK                28300002
         DS    CL4                 BLANKS                               28350002
KEY      DS    CL1                 PRINTABLE KEY                        28400002
         DS    CL3                 BLANKS                               28450002
AMWP2    DS    CL4                 PRINTABLE AMWP                       28500002
         DS    CL5                 BLANKS                               28550002
INTRPTCD DS    CL4                 PRINTABLE INTERRUPTION CODE          28600002
         DS    CL7                 BLANKS                               28650002
ILC2     DS    CL2                 PRINTABLE INSTRUCTION LENGTH CODE    28700002
         DS    CL2                 BLANKS                               28750002
CC2      DS    CL2                 PRINTABLE CONDITION CODE             28800002
         DS    CL5                 BLANKS                               28850002
PROGM2   DS    CL4                 PRINTABLE PROGRAM MASK               28900002
         DS    CL6                 BLANKS                               28950002
INSTRADR DS    CL6                 PRINTABLE INSTRUCTION COUNTER        29000002
         DS    CL2                 BLANKS                               29050002
* IT IS ESSENTIAL THAT THE FOLLOWING 2 AREAS BE CONTIGUOUS AND IN ORDER 29100002
OUTPTR1  DS    1F                  POINTER TO FIRST OUTPUT BUFFER       29150002
OUTPTR2  DS    1F                  POINTER TO SECOND OUTPUT BUFFER      29200002
PARMPTR  DS    1F                  POINTER TO PARSE PARM LIST    YM4111 29210002
         ORG   PSWAREA             GO BACK TO BEGINNING OF WORK AREA    29250002
TEMPWRK  DS    0H                  LABEL FOR VALIDITY CHECK WORKAERA    29260002
STAELIST DS    4F                  PARAMETER LIST FOR STAE              29300002
* * * * * * * * * ** * * * * * * * * * * * * * * * * * * * * * * * * *  29310002
*        THE FOLLOWING IS A CONTINUATION OF THE PSW WORKAREA DSECT      29312002
*        THIS PORTION IS USED FOR FORMATTING THE EC MODE PSW (AOS/2)    29314002
* * * * * * * * * ** * * * * * * * * * * * * * * * * * * * * * * * * *  29320002
         ORG  SYSMASK              OVERLAY BC MODE AREA                 29330002
ECTEMPST DS   0H                   LABEL FOR MOVING FORMATTED BITS IN   29332002
ECSYSMSK DS   2F                   PRINTABLE SYSMASK AREA               29340002
ECDUMMY1 DS   1F                   FILLER FOR PROTECT AREA              29340402
ECAMWP   DS   1F                   FILLER FOR PROTECT MASK              29342002
ECDUMMY2 DS   CL2                  FILLER FOR UNUSED SPACE              29344002
ECCONDC  DS   CL2                  PRINTABLE CC AREA                    29346002
ECPRGMSK DS   1F                   PRINTABLE PROGRAM MASK AREA          29348002
ECSPM    DS   CL1                  PRINTABLE SEG PROTECTION MODE AREA   29348402
ECDUMMY3 DS   CL7                  FILLER FOR UNUSED SPACE              29348802
****     FORMATTED AREA FOR EC MODE PSW -- KEEP CONTIGUOUS--            29349202
         ORG  START                START OF THE OUTPUT AREA             29349602
START2   DS   CL2                  BLANKS                               29349702
ECSYSMK2 DS   CL8                  FORMATTED PRINTABLE SYSTEM MASK      29349802
         DS   CL4                  BLANKS                               29349902
ECKEY    DS   CL1                  FORMATTED PROTECTION KEY             29366602
         DS   CL3                  BLANKS                               29376602
ECAMWP2  DS   CL4                  FORMATTED AMWP                       29378602
         DS   CL3                  BLANKS                               29380602
ECSPM2   DS   CL1                  FORMATTED SEGMENT PROTECTION MODE    29382602
         DS   CL3                  BLANKS                               29383002
ECCC2    DS   CL2                  FORMATTED CONDITION CODE             29383102
         DS   CL5                  BLANKS                               29388802
ECPROGMK DS   CL4                  FORMATTED PROGRAM MASK               29390802
         DS   CL6                  BLANKS                               29392802
ECINADDR DS   CL6                  FORMATTED INSTRUCTION ADDRESS        29393202
         DS   CL13                 BLANKS                               29393602
IKJEGPSW CSECT                                                          29394402
         EJECT                                                          29400002
*                                                                       29400102
*        PARSE MACROS                                                   29400302
*                                                                       29400702
IKJEGPWP IKJPARM                                                        29400902
PRINTIT  IKJKEYWD                                                       29401302
         IKJNAME  'PRINT',SUBFLD=PRINTDSN                               29401402
PSWADDR  IKJKEYWD                                                       29401502
         IKJNAME  'ADDR',SUBFLD=ADDRPSW                                 29401902
ADDRPSW  IKJSUBF                                                        29402302
ADDRESS  IKJPOSIT  ADDRESS,VALIDCK=PSWVALCK,PROMPT='ADDRESS OF PSW'     29402702
PRINTDSN IKJSUBF                                                        29402802
DSNAME   IKJPOSIT  DSNAME,PROMPT='DATA SET NAME'                        29403202
         IKJENDP                                                        29403602
         SPACE 2                                                        29404002
PDEUSWD  EQU   ADDRESS+N32         IN ADDRESS PDE, USER WORD            29404102
PDEFLAG3 EQU   ADDRESS+N22         IN ADDR PDE, FLAGS FOR ADDR STRING   29404202
         EJECT                                                          29404302
CONAREAD DSECT                       DESCRIBES CONAREA FOR EC MOD PSW   29406002
         SPACE                                                          29408402
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   29411002
*        A DSECT DESCRIBING CONAREA (FROM CONVERT) FOR EC MOD PSW       29413602
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   29416202
         SPACE                                                          29418802
         DS    CL3                   NULL POSITION BLOCK                29421402
CONKEY   DS    CL1                   PRINTABLE PROT KEY                 29424002
         DS    CL5                   NULL POSITION BLOCK                29426602
CONINADR DS    CL8                   PRINTABLE INSTRUCTION ADDRESS      29429202
         EJECT                                                          29431802
**********************************************************************  29434402
*        DSECT DESCRIBING PARSE ADDRESS PDE                             29437002
**********************************************************************  29439602
         SPACE                                                          29442202
         IKJPARMA                                                       29444802
         EJECT                                                          29447402
         TCOMTAB                                                        29450002
         EJECT                                                          29500002
         TSTCWORK                                                       29550002
         EJECT                                                          29600002
         IKJPPL                                                         29650002
         EJECT                                                          29700002
CVT      DSECT                                                          32550002
         CVT                                                            32600002
         EJECT                                                          32650002
         IKJTCB                                                         32700002
         EJECT                                                          32750002
         IKJRB                                                          32800002
         END                                                            32850002
