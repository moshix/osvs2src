         COPY IKJEGSIO                                                  00008000
IKJEGSYM CSECT                                                          00016000
SYM      TITLE 'IKJEGSYM - TSO TEST ASSEMBLER SYMBOL PROCESSOR'         00024000
*C352800,A889000                                               @YA00074 00032000
*C258000                                                       @YM07131 00040000
*C180700              WRONG MSGID R3                           @ZA***** 00045000
*                     R14 IS ZERO FOR BR RETURN INST           @ZA09494 00047000
*C066500                                                       @ZA27196 00048003
*********************************************************************** 00050000
*                                                                     * 00060000
* STATUS --                                                           * 00070000
*    CHANGE LEVEL 00, VERSION NUMBER 01, OS/VS2                       * 00080000
*                                                                     * 00090000
* FUNCTION/OPERATION --                                               * 00100000
*    THE TEST SYMBOL PROCESSOR PROVIDES MAIN STORAGE ADDRESSES,       * 00110000
*    ASSEMBLER SYMBOL ATTRIBUTES AND CSECT NAMES FOR SYMBOLIC         * 00120000
*    DEBUGGING.                                                       * 00130000
*    BASICALLY MAIN STORAGE ADDRESSES ARE FOUND BY ADDING UP THE      * 00140000
*    MODULES LOADED MAIN STORAGE ADDRESS, CSECT DISPLACEMENT INTO     * 00150000
*    THE MODULE AND SYMBOL DISPLACEMENT INTO THE CSECT.               * 00160000
*    CSECT NAMES AND DISPLACEMENTS ARE FOUND IN THE CESD RECORDS      * 00170000
*    FOR THE MODULE.  IF IT IS A LOAD MODULE THEY RESIDE ON           * 00180000
*    SECONDARY STORAGE. IF IT IS A OBJECT MODULE LOADED VIA THE       * 00190000
*    OS LOADER THE CESD RECORDS ARE IN MAIN STORAGE.                  * 00200000
*    ASSEMBLER SYMBOL ATTRIBUTES AND DISPLACEMENTS ARE ONLY           * 00210000
*    AVAILIABLE FOR LOAD MODULES AND THE TEST PARM MUST BE PASSED     * 00220000
*    TO THE ASSEMBLER AND LINKAGE EDITOR TO OBTAIN THEM.              * 00230000
*    CESD AND SYMBOL INFORMATION CAN ONLY BE OBTAINED FROM LOAD       * 00240000
*    MODULES IF SVC 061 HAS PROCESSED DURING THEIR FETCH TIME.        * 00250000
*    CESD INFORMATION MAY BE OBTAINED FROM AN OBJECT MODULE WHEN      * 00260000
*    CHAINNED FROM THE P/P TCB AND THE CDE INDICATES LOADED BY        * 00270000
*    THE OS LOADER AND THAT CESD RECORDS ARE PRESENT.                 * 00280000
*                                                                     * 00290000
* ENTRY POINTS --                                                     * 00300000
*         IKJEGSYM     ONLY ENTRY POINT TO IKJEGSYM                   * 00310000
*                                                                     * 00320000
* INPUT --                                                            * 00330000
*    REGISTER 1 POINTS TO A PDE CONTAINING THE FOLLOWING ACCEPTED     * 00340000
*    ARGUMENTS                                                        * 00350000
*    LOADNAME ENTRYNAME                                               * 00360000
*    RETURN MAIN STORAGE ADDRESS IN USER FIELD OF PDE                 * 00370000
*    LOADNAME ENTRYNAME SYMBOL                                        * 00380000
*    RETURN SYMINFO BLOCK POINTED TO FROM USER FIELD                  * 00390000
*    IN PDE WITH THE HIGH ORDER BYTE EQUAL TO X'80'                   * 00400000
*    LOADNAME           OFFSET                                        * 00410000
*    RETURN CSECT NAME POINTED TO FROM PTR TO ENTRYNAME               * 00420000
*    FIELD IN PDE                                                     * 00430000
*    MISSING FIELDS ARE FILLED IN FROM THE CURRENTLY QUALIFIED        * 00440000
*    LOADNAME.ENTRYNAME OR IN THE CASE OF ENTRYNAME, DEFAULTED        * 00450000
*    TO THE FIRST CSECT OF THE MODULE                                 * 00460000
*                                                                     * 00470000
* OUTPUT --                                                           * 00480000
*    FILLED IN PDE, POSSIBLE SYMINFO BLOCK AND RETURN CODES           * 00490000
*                                                                     * 00500000
* EXTERNAL REFERENCES --                                              * 00510000
*         ESATE      - ESTABLISH ABEND RECOVERY EXIT RTN (IKJEGSTA)   * 00520000
*         IKJEGIO    - ERROR MESSAGES TO TERMINAL                     * 00530000
*         DAIR       - ALLOCATE SYS1.LINKLIB                          * 00540000
*         GETMAIN    - FOR WORK AREA, SYMINFO BLK, DAIR PARM LIST     * 00550000
*         FREEMAIN   - DAIR PARM LIST, STAE WORK AREA                 * 00560000
*         OPEN       - A BPAM DCB FOR READING SYMBOLS                 * 00570000
*         CLOSE      - THE DCB FOR READING SYMBOLS                    * 00580000
*         READ       - SYMBOLS FROM SECONDARY STORAGE                 * 00590000
*         CHECK      - VERIFY READ, WAIT FOR READ TO COMPLETE         * 00600000
*         NOTE       - TTR OF FIRST CESD RECORD IN LOADNAME MEMBER    * 00610000
*         FIND       - POINT TO SYMBOL RCDS IN LOADNAME MEMBER OF PDS * 00620000
*         SYNADAF    - FOR AN I/O ERROR, OBTAIN SYSTEM INFO MESG      * 00630000
*         SYNADRLS   - RELEASE SYNADAF WORK AREA                      * 00640000
*                                                                     * 00650000
* EXITS, NORMAL --                                                    * 00660000
*         RETURN TO CALLER WITH RETURN CODES                          * 00670000
*         0     SUCCESSFULLY COMPLETED                                * 00680000
*         4     PASSED SYMBOLIC NAME NOT FOUND, EITHER LOADNAME       * 00690000
*         ENTRYNAME OR SYMBOLNAME, OR NO CORE AVAILABLE               * 00700000
*         8     UNABLE TO RESOLVE SYMBOLICS AT THIS TIME,             * 00710000
*         CANNOT ISSUE STAE, OPEN DCB, OR ALLOCATE LINKLIB            * 00720000
*         12     AN I/O ERROR HAS OCCURRED WHILE READING SECONDARY    * 00730000
*         STORAGE                                                     * 00740000
*         16     AN ATTENTION OR LOGON/LOGOFF ECB HAS BEEN POSTED     * 00750000
*         20     AN ABEND HAS BEEN INTERCEPTED BY STAE                * 00760000
*         MESSAGES     - MESSAGES ARE SENT TO THE TERMINAL IF AN I/O  * 00770000
*         ERROR HAS OCURRED WHILE READING SECONDARY STORAGE           * 00780000
*         OR WHEN SYMMESG SWITCH, EQUATED TO B'00100000', IN          * 00790000
*         THE TSTFLGS3 FIELD OF TCOMTAB DSECT IS OFF                  * 00800000
*         NO MESSAGES ARE PRINTED WHEN THE REQUEST IS TO RESOLVE      * 00810000
*         A PASSED OFFSET                                             * 00820000
*                                                                     * 00830000
* EXITS, ERROR --                                                     * 00840000
*         N/A                                                         * 00850000
*                                                                     * 00860000
* TABLES/WORK AREAS --                                                * 00870000
*    TCOMTAB    - COMMUNICATIONS DSECT FOR ALL OF TEST                * 00880000
*    PDE        - CNTRL BLOCK CONTAINNING INPUTED ARGUMENTS           * 00890000
*    SYM RCDS   - ON SECONDARY STORAGE                                * 00900000
*    CESD RCDS  - ON SECONDARY OR IN MAIN STORAGE                     * 00910000
*    SYMTAB     - INCORE SYMBOL TABLE                                 * 00920000
*    SYMWORK    - INTERNAL WORK AREA                                  * 00930000
*    SVCINFO    - TABLE OF SAVED LOAD MODULE INFO BUILT BY            * 00940000
*    TESTRAN SVC 61 (IN DECIMAL)                                      * 00950000
*    SYMINFO    - ANSWER BLOCK RETURNED FOR A SYMBOL REQUEST          * 00960000
*                                                                     * 00970000
* ATTRIBUTES --                                                       * 00980000
*    REENTRANT AND REFRESHABLE                                        * 00990000
*                                                                     * 01000000
* CHARACTER CODE DEPENDENCY --                                        * 01010000
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 01020000
*                                                                     * 01030000
* NOTES --                                                            * 01040000
*    THE SYMBOL PROCESSOR IS SET UP FOR BEST RESPONSE TIME WHILE      * 01050000
*    RESOLVING SYMBOLS PLACED IN THE INCORE SYMBOL TABLE AND THEN     * 01060000
*    PREFIXED WITH THE CURRENTLY QUALIFIED LOADNAME ENTRYNAME.        * 01070000
*                                                                     * 01080000
*********************************************************************** 01090000
         EJECT                                                          01100000
         SPACE                                                          01110000
*        REGISTER EQUATES                                               01120000
*                                                                       01130000
PARMREG0 EQU   0                            REGISTER 0                  01140000
PARMREG1 EQU   1                            REGISTER 1                  01150000
PDEB     EQU   2                            CONTAIN ADDRESS PASSED PDE  01160000
WORK1    EQU   3                            REGISTER 3                  01170000
WORK2    EQU   4                            REGISTER 4                  01180000
WORK3    EQU   5                            REGISTER 5                  01190000
WORK4    EQU   6                            REGISTER 6                  01200000
WORK5    EQU   7                            REGISTER 7                  01210000
WORK6    EQU   8                            REGISTER 8                  01220000
TCOMTABB EQU   9                            BASE FOR TCOMTAB DSECT      01230000
INFOBLKB EQU   10                           BASE FOR INFO BLOCK         01240000
SYMB2    EQU   11                           BASE FOR IKJEGMYS CSECT     01250000
SYMB     EQU   12                           BASE FOR IKJEGSYM CSECT     01260000
SYMWKB   EQU   13                           BASE FOR SYM WORK AREA      01270000
RETURN   EQU   14                           REGISTER 14                 01280000
RETCODE  EQU   15                           REGISTER 15                 01290000
*                                                                       01300000
*        EQUATES FOR SI INSTRUCTION IMEDIATE OPERANDS                   01310000
*                                                                       01320000
V00      EQU   X'00'                        HEX 00                      01330000
V01      EQU   X'01'                        HEX 01                      01340000
V02      EQU   X'02'                        HEX 02                      01350000
V03      EQU   X'03'                        HEX 03                      01360000
V04      EQU   X'04'                        HEX 04                      01370000
V07      EQU   X'07'                        HEX 07                      01380000
V08      EQU   X'08'                        HEX 08                      01390000
V0F      EQU   X'0F'                        HEX 0F                      01400000
V10      EQU   X'10'                        HEX 10                      01410000
V20      EQU   X'20'                        HEX 20                      01420000
V40      EQU   X'40'                        HEX 40                      01430000
V60      EQU   X'60'                        HEX 60                      01440000
V80      EQU   X'80'                        HEX 80                      01450000
V0C      EQU   X'0C'                        HEX 0C                      01460000
V50      EQU   X'50'                        HEX 50                      01470000
V7F      EQU   X'7F'                        HEX 7F                      01480000
V90      EQU   X'90'                        HEX 90                      01490000
V91      EQU   X'91'                        HEX 91                      01500000
V9F      EQU   X'9F'                        HEX 9F                      01510000
VBF      EQU   X'BF'                        HEX BF                      01520000
VC0      EQU   X'C0'                        HEX C0                      01530000
VDF      EQU   X'DF'                        HEX DF                      01540000
VE0      EQU   X'E0'                        HEX E0                      01550000
VE2      EQU   X'E2'                        HEX E2                      01560000
VEF      EQU   X'EF'                        HEX EF                      01570000
VF0      EQU   X'F0'                        HEX F0                      01580000
VFF      EQU   X'FF'                        HEX FF                      01590000
LSYMRCD  EQU   C'S'                         IDENTIFY LOGICAL SYM RCD    01600000
*                                                                       01610000
*        NUMBER EQUATES                                                 01620000
*                                                                       01630000
N0       EQU   0                            DECIMAL 0                   01640000
N1       EQU   1                            DECIMAL 1                   01650000
N2       EQU   2                            DECIMAL 2                   01660000
N3       EQU   3                            DECIMAL 3                   01670000
N4       EQU   4                            DECIMAL 4                   01680000
N5       EQU   5                            DECIMAL 5                   01690000
N6       EQU   6                            DECIMAL 6                   01700000
N7       EQU   7                            DECIMAL 7                   01710000
N8       EQU   8                            DECIMAL 8                   01720000
N9       EQU   9                            DECIMAL 9                   01730000
N10      EQU   10                           DECIMAL 10                  01740000
N11      EQU   11                           DECIMAL 11                  01750000
N12      EQU   12                           DECIMAL 12                  01760000
N13      EQU   13                           DECIMAL 13                  01770000
N14      EQU   14                           DECIMAL 14                  01780000
N15      EQU   15                           DECIMAL 15                  01790000
N16      EQU   16                           DECIMAL 16                  01800000
N17      EQU   17                           DECIMAL 17                  01810000
N18      EQU   18                           DECIMAL 18                  01820000
N20      EQU   20                           DECIMAL 20                  01830000
N21      EQU   21                           DECIMAL 21                  01840000
N22      EQU   22                           DECIMAL 22                  01850000
N23      EQU   23                           DECIMAL 23                  01860000
N24      EQU   24                           DECIMAL 24                  01870000
N25      EQU   25                           DECIMAL 25                  01880000
N26      EQU   26                           DECIMAL 26                  01890000
N28      EQU   28                           DECIMAL 28                  01900000
N29      EQU   29                           DECIMAL 29                  01910000
N30      EQU   30                           DECIMAL 30                  01920000
N31      EQU   31                           DECIMAL 31                  01930000
N32      EQU   32                           DECIMAL 32                  01940000
N33      EQU   33                           DECIMAL 33                  01950000
N34      EQU   34                           DECIMAL 34                  01960000
N36      EQU   36                           DECIMAL 36                  01970000
N37      EQU   37                           DECIMAL 37                  01980000
N38      EQU   38                           DECIMAL 38                  01990000
N40      EQU   40                           DECIMAL 40                  02000000
N41      EQU   41                           DECIMAL 41                  02010000
N42      EQU   42                           DECIMAL 42                  02020000
N44      EQU   44                           DECIMAL 44                  02030000
N45      EQU   45                           DECIMAL 45                  02040000
N46      EQU   46                           DECIMAL 46                  02050000
N47      EQU   47                           DECIMAL 47                  02060000
N48      EQU   48                           DECIMAL 48                  02070000
N49      EQU   49                           DECIMAL 49                  02080000
N50      EQU   50                           DECIMAL 50                  02090000
N51      EQU   51                           DECIMAL 51                  02100000
N52      EQU   52                           DECIMAL 52                  02110000
N53      EQU   53                           DECIMAL 53                  02120000
N54      EQU   54                           DECIMAL 54                  02130000
N56      EQU   56                           DECIMAL 56                  02140000
N57      EQU   57                           DECIMAL 57                  02150000
N58      EQU   58                           DECIMAL 58                  02160000
N59      EQU   59                           DECIMAL 59                  02170000
N60      EQU   60                           DECIMAL 60                  02180000
N61      EQU   61                           DECIMAL 61                  02190000
N62      EQU   62                           DECIMAL 62                  02200000
N63      EQU   63                           DECIMAL 63                  02210000
N64      EQU   64                           DECIMAL 64                  02220000
N65      EQU   65                           DECIMAL 65                  02230000
N66      EQU   66                           DECIMAL 66                  02240000
N68      EQU   68                           DECIMAL 68                  02250000
N69      EQU   69                           DECIMAL 69                  02260000
N70      EQU   70                           DECIMAL 70                  02270000
N71      EQU   71                           DECIMAL 71                  02280000
N72      EQU   72                           DECIMAL 72                  02290000
N73      EQU   73                           DECIMAL 73                  02300000
N74      EQU   74                           DECIMAL 74                  02310000
N75      EQU   75                           DECIMAL 75                  02320000
N80      EQU   80                           DECIMAL 80                  02330000
N83      EQU   83                           DECIMAL 83                  02340000
N88      EQU   88                           DECIMAL 88                  02350000
N90      EQU   90                           DECIMAL 90                  02360000
N94      EQU   94                           DECIMAL 94                  02370000
N100     EQU   100                          DECIMAL 100                 02380000
N104     EQU   104                          DECIMAL 104                 02390000
N110     EQU   110                          DECIMAL 110                 02400000
N120     EQU   120                          DECIMAL 120                 02410000
N256     EQU   256                          DECIMAL 256                 02420000
N800     EQU   800                          DECIMAL 800                 02430000
*                                                                       02440000
*        CONDITION CODE EQUATES FOR BCR INSTRUCTIONS                    02450000
*                                                                       02460000
ZERO     EQU   8                            BRANCH IF ZERO              02470000
ONES     EQU   1                            BRANCH IF ONES              02480000
NOTZERO  EQU   7                            BRANCH IF NOT ZERO          02490000
LOW      EQU   4                            BRANCH IF LOW               02500000
         SPACE 3                                                        02510000
*********************************************************************** 02520000
*                                                                     * 02530000
*        THIS IS THE ENTRY INITILIZATION AND MAINLINE ROUTINE.        * 02540000
*        SUB-ROUTINES ARE USED TO ANALYZE REQUESTS, GATHER INFO       * 02550000
*        ABOUT THE REQUEST AND RESOLVE THE REQUEST.                   * 02560000
*                                                                     * 02570000
*********************************************************************** 02580000
         SPACE 2                                                        02590000
*                                                                       02600000
*        ENTRY  INITILIZATION                                           02610000
*                                                                       02620000
         STM   RETURN,SYMB,N12(SYMWKB)      SAVE CALLER'S REGISTERS     02630000
         LR    SYMB,RETCODE                 USE ENTRY PT FOR BASE       02640000
         USING IKJEGSYM,SYMB                ESTABLISH ADDRESSABILITY    02650000
         LR    PDEB,PARMREG1                ADDR OF PASSED PDE          02660000
         USING IKJPARMA,PDEB                BASE FOR PDE DSECT          02670000
         MVC   PDEUSER(N4),NO2NDMSG         NO 2ND LEV MSG TO CALLER    02680000
         USING TCOMTAB,TCOMTABB             BASE FOR TCOMTAB DSECT      02690000
         L     WORK1,TSTSYMWK               ADDR OF SYMWORK IN TCOMTAB  02700000
         LTR   WORK1,WORK1                  IS IT FIRST ENTRY           02710000
         BZ    FIRSTENT                     YES, GO GET CORE-INITILIZE  02720000
         ST    WORK1,N8(SYMWKB)             NO, DO LINKAGE CONVENTIONS  02730000
         ST    SYMWKB,N4(WORK1)                                         02740000
         LR    SYMWKB,WORK1                 ADDR OF SYMWORK, SAVE AREA  02750000
         USING SYMWORK,SYMWKB                                           02760000
         USING INFOBLK,INFOBLKB             BASE FOR INFO BLK DSECT     02770000
*                                                                       02780000
*        BEGIN PROCESSING  -  RESOLVE REQUEST INTO ACTION               02790000
*                                                                       02800000
IKJEGBEG EQU   *                                                        02810000
         ST    SYMB,BASEADDR                MY BASE ADDR IN WORK AREA   02820000
         L     WORK1,TSTSTAE                STAE EXIT ADDRESS           02830000
         LA    PARMREG1,STAELIST            ADDRESS OF ESTAE LIST       02840000
         XC    STAELIST(N16),STAELIST       CLEAR ESTAE LIST AREA       02850000
         ESTAE  (WORK1),CT,PARAM=LIST,XCTL=NO,RECORD=YES,MF=(E,(1))     02860000
         LTR   RETCODE,RETCODE              WAS STAE SUCCESSFUL         02870000
SMTSTAE  DS    0H                           SMT TESTCASE LABEL          02880000
*                                            INSUFFICIENT CORE TO ISSUE 02890000
*                                            STAE-RC FROM SYM IS 4      02900000
*                                            TESTCASE ID  TTSTC160      02910000
*                                            TESTCASE ID  TEQU4800      02920000
         BZ    STAEON                       ACS IS ESTABLISHED          02930000
         STC   RETCODE,TSTESTRC             PRESERVE RETURN CODE        02940000
         LA    RETCODE,N24                  SET RC TO 24                02950000
         B     TOCALL                       RETURN TO CALLER            02960000
         SPACE 1                                                        02970000
STAEON   DS    0H                                                       02980000
         XC    TSTWHR(N4),TSTWHR            LOADED ADDR FIELD TO 0      02990000
         TM    PDEFLG3,AFLG                 IS AN ADDR STRING PASSED    03000000
         BZ    ONWARD1                      NO, GO ON                   03010000
         TM    PDEFLG4,SYMADDR              IS A SYMBOL PASSED          03020000
         BZ    ONWARD1                      NO, GO ON                   03030000
         TM    PDEFLG2,CTNAMFLG             IS SYMBOL QUALIFIED         03040000
         BO    ONWARD1                      YES, SKIP INCORE SYM TAB    03050000
         BAL   RETURN,SINCORES              NO, GO SEARCH INCORE SYMTB  03060000
         LTR   RETCODE,RETCODE              WAS THE SYMBOL FOUND        03070000
         BZ    FOUNDSYM                     YES, GO BUILD ANSWER BLOCK  03080000
ONWARD1  BAL   RETURN,GETINFO               EVALUATE, GET INFO FOR REQ  03090000
         MVC   TSTWHR(N4),LOADNAMA          LOADED ADDR OF MOD          03100000
         TM    WHATPASS,V02                 WAS A SYMBOL PASSED         03110000
         BO    FINDSYM                      YES, GO FIND SYMBOL         03120000
         TM    WHATPASS,V01                 WAS AN OFFSET PASSED        03130000
         BZ    ENTRYPSD                     NO, GO SEARCH USE ENTRYNAME 03140000
         OI    SWSB,V40                     INDICATE SEARCH USE OFFSET  03150000
         BAL   RETURN,FINDCESD              GO RESOLVE CESD REQUEST     03160000
         B     FENTRY                       FOUND ENTRYNAME DISPLACMENT 03170000
*                                           USING ENTRYNAME AS SEARCH   03180000
ENTRYPSD OI    SWSB,V20                     SEARCH USING ENTRYNAME      03190000
         BAL   RETURN,FINDCESD              GO RESOLVE CESD REQUEST     03200000
         B     FOFFSET                      FOUND ENTRYNAME USING       03210000
*                                           OFFSET AS THE SEARCH        03220000
         SPACE 1                                                        03230000
SVCERR3  DS    0H                                                       03240000
         TM    TSTFLGS3,SYMMESG             SHOULD WE ISSUE MSG         03250000
         BCR   ONES,RETURN                  IF NO, RETURN               03260000
         TM    WHATPASS,V01                 WAS AN OFFSET PASSED        03270000
         BCR   ONES,RETURN                  IF NO, RETURN               03280000
         ST    RETURN,TERMIO14              SAVE RETURN ADDRESS         03290000
         LR    WORK3,RETCODE                PUT RETURN CODE IN WORK3    03300000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO DYNAM AREA       03310000
         IKJEGSIO SVCERR,SVC=(WORK2),ID=SYM30,RC=(WORK3),              *03320000
               MF=(E,TSTIOPRM)                                          03330000
         L     RETURN,TERMIO14              RESTORE RETURN REGISTER     03340000
         BR    RETURN                       RETURN TO CALLER            03350000
         SPACE 3                                                        03360000
*********************************************************************** 03370000
*                                                                     * 03380000
*        THE FOLLOWING SUB ROUTINES ARE SERVICE ROUTINES FOR THE      * 03390000
*        MAIN PROCESSING ROUTINES                                     * 03400000
*                                                                     * 03410000
*********************************************************************** 03420000
         SPACE 2                                                        03430000
*                                                                       03440000
*        THIS  ROUTINE FILLS IN THE PDE AFTER A SUCCESSFUL SEARCH       03450000
*        FOR AN ENTRYNAME USING AN OFFSET AS THE SEARCH ARGUMENT        03460000
*                                                                       03470000
FENTRY   LA    WORK1,ENTRYNAM               ADDR OF FOUND ENTRYNAME     03480000
         ST    WORK1,PDECTNAM               RETURN IN THE PASSED PDE    03490000
         LA    WORK1,N8                     LENGTH OF PASSED ENTRYNAME  03500000
         STH   WORK1,PDELEN2                RETURN IN THE PASSED PDE    03510000
         OI    PDEFLG2,CTNAMFLG             INDICATE ENTRYNAME FOUND    03520000
         SR    RETCODE,RETCODE              SUCCESSFUL RET CODE=0       03530000
         B     TOCALLER                     GO RETURN TO CALLER         03540000
*                                                                       03550000
*        THIS  ROUTINE FILLS IN THE PDE AFTER A SUCCESSFUL SEARCH       03560000
*        FOR A LOADED ADDRESS USING AN ENTRYNAME AS THE SEARCH ARGUMENT 03570000
*                                                                       03580000
FOFFSET  L     WORK1,LOADNAMA               LOADED ADDR OF MODULE       03590000
         A     WORK1,ENTRNAMD               PLUS DISPL OF ENTRYNAME     03600000
         ST    WORK1,PDEUSER                RETURN IN PASSED PDE        03610000
         SR    RETCODE,RETCODE              SUCCESSFUL RET CODE=0       03620000
         B     TOCALLER                     GO RETURN TO CALLER         03630000
*                                                                       03640000
*        THIS ROUTINE CHECKS THE ATTENTION AND LOGON/LOGOFF ECBS.  IF   03650000
*        THEY HAVE BEEN POSTED, SYM RETURNS TO ITS CALLER WITH A        03660000
*        RETCODE OF 16.  IF NOT THIS ROUTINE RETURNS TO ITS CALLER      03670000
*                                                                       03680000
CHECKECB L     WORK1,ECBTMPA                ADDRESS OF ATTENTION ECB    03690000
         TM    N0(WORK1),V40                HAS ATTENTION ECB BEEN POST 03700000
SMTATTN  DS    0H                           SMT TESTCASE LABEL          03710000
*                                            ATTN DURING SYM PROCESSING 03720000
*                                            RC FROM SYM IS 16          03730000
*                                            TESTCASE ID  TTSTC040      03740000
         BO    CODE16                       YES, RET TO CALLER          03750000
         L     WORK1,ECBLOG                 ADDR OF LOGON/LOGOFF ECB    03760000
         TM    N0(WORK1),V40                HAS LOGON/LOGOFF BEEN POSTD 03770000
         BCR   ZERO,RETURN                  NO, GO BACK TO WHAT YOU     03780000
*                                            WERE DOING                 03790000
CODE16   LA    RETCODE,N16                  REQ TO END, RETCODE=16      03800000
         B     TOCALLER                     GO RETURN TO CALLER         03810000
*                                                                       03820000
*                                                                       03830000
*        THIS IS THE STAE RETRY ROUTINE.                                03840000
*                                                                       03850000
STAERTRY EQU   *                                                        03860000
         L     TCOMTABB,CVTPTR              ADDRESS OF CVT              03870000
         L     TCOMTABB,CVTTCBP-CVT(TCOMTABB)   NEW, CURRENT TCBS       03880000
         L     TCOMTABB,N4(TCOMTABB)        CURRENT TCB IS TEST TCB     03890000
         L     TCOMTABB,TCBTRN-TCB(TCOMTABB)    ADDRESS OF TCOMTAB      03900000
         L     SYMWKB,TSTSYMWK              ADDR OF MY WORK AREA-TCOMTB 03910000
         L     SYMB,BASEADDR                MY BASE REG FROM WORK ARA   03920000
DAIRCORE EQU   *                                                        03930000
         TM    SWSC,V40                     CORE FOR DAIR PARM LIST     03940000
         BZ    CODE20                       NO, GO GIVE RET CODE=20     03950000
         L     PARMREG1,ADAIRCOR            YES, GET ADDR OF GOTTEN COR 03960000
         FREEMAIN   RC,LV=N100,A=(PARMREG1),SP=N1   FREE DAIR PARM LIST 03970000
         LTR   RETCODE,RETCODE              WAS RETURN CODE NONZERO     03980000
         BZ    TURNOFF                      IF ZERO, TURNOFF CORE SW    03990000
         LA    WORK2,N120                   GET SVC NUMBER              04000000
         BAL   RETURN,SVCERR3               GO ISSUE ERROR MESSAGE      04010000
**  THERE IS NO REASON TO PUT OUT A MESSAGE HERE IF WE FAIL             04020000
** SINCE WE ARE ON OUR WAY OUT ANYHOW                                   04030000
** AND THERE HAS ALREADY BEEN ONE MESSAGE PUT OUT                       04040000
** NOTE: WE ARE PROCESSING AN ABEND.                                    04050000
         B     CODE20                     SET CODE TO 20 AND RETURN     04060000
TURNOFF  EQU   *                                                        04070000
         NI    SWSC,VBF                     TURN DAIR CORE SWITCH OFF   04080000
CODE20   EQU   *                                                        04090000
         NI    TSTFLGS4,VFF-TSTVALCK        TURN OFF INDICATOR          04100000
         NI    TSTFLGS4,VFF-TSTRERTN        TURN OFF INDICATOR          04110000
         LA    RETCODE,N20                  STAE ENTRY RET CODE         04120000
         B     TOCALLER                     GO RETURN                   04130000
         EJECT                                                          04140000
*                                                                       04150000
*        THIS ROUTINE ISSUES THE IKJEGSIO MACRO TO OUTPUT               04160000
*        ERROR MESSAGES TO THE TERMINAL                                 04170000
*                                                                       04180000
TERMIO   EQU   *                                                        04190000
         TM    TSTFLGS3,SYMMESG             SHOULD WE PRINT A MESSAGE   04200000
         BCR   ONES,RETURN                  NO, RETURN TO CALLER        04210000
         TM    WHATPASS,V01                 WAS AN OFFSET PASSED        04220000
         BCR   ONES,RETURN                  YES, RETURN, NO MESSAGE     04230000
         SPACE 1                                                        04240000
PRINT    DS    0H                                                       04250000
         ST    RETURN,TERMIO14              SAVE RETURN ADDRESS         04260000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO DYNM AREA        04270000
         SLL   WORK5,N2                     MULTIPLY WORK5 BY 4         04280000
         B     PRINT2                       GO PRINT A MESSAGE          04290000
*                                                                       04300000
*        THIS ROUTINE RETURNS TO THE CALLER OF IKJEGSYM                 04310000
*                                                                       04320000
TOCALLER EQU   *                                                        04330000
*        MVC   TSTRETRY(N4),CALRETRY        RESTORE CALLERS STAE RETRY  04340000
*        MVC   ABENTAB1(N4),CABENDTB        RESTORE CALLERS ABEND TABLE 04350000
         L     SYMWKB,N4(SYMWKB)            ADDR OF CALLERS SAVE AREA   04360000
TOCALL   EQU   *                                                        04370000
         RETURN    (14,12),,RC=(15)                                     04380000
         SPACE 3                                                        04390000
*********************************************************************** 04400000
*                                                                     * 04410000
*        THIS SUB-ROUTINE ANALYZES THE REQUEST AND GATHERS ALL INFO   * 04420000
*        AVAILIABLE ABOUT THE MODULE INVOLVED.                        * 04430000
*                                                                     * 04440000
*********************************************************************** 04450000
         SPACE 2                                                        04460000
GETINFO  XC    WHATPASS(N3),WHATPASS        SET SWITCHES TO ZERO        04470000
         LA    INFOBLKB,TINFOBLK            ADDR OF TEMP INFO BLOCK     04480000
         MVI   LOADNAME,V40                 BLANK TO TEMP INFO BLOCK    04490000
         MVC   LOADNAME+N1(N23),LOADNAME    CHAR INFO TO BLANKS         04500000
         XC    LOADNAMA(N32),LOADNAMA       OTHER INFO TO ZEROES        04510000
*                                                                       04520000
*        ANALYZE THE PASSED INFORMATION AND REFLECT THE ARGUMENT FORM   04530000
*                                                                       04540000
         TM    PDEFLG3,AFLG                 IS AN ADDRESS STRING PASSED 04550000
         BZ    NOADDRST                     NO, GO CHECK FUTHER         04560000
         TM    PDEFLG4,SYMADDR              IS ADDR STRING A SYM REQ    04570000
         BZ    OFFSETRQ                     NO, GO CHECK FOR OFFSET     04580000
         OI    WHATPASS,VE2                 INDICATE SYMBOL PASSED AND  04590000
*                                            ARGUMENT FORM IS           04600000
*                                            LOADNAME.ENTRYNAME.SYMBOL  04610000
         MVC   PSYMBOL(N8),BLANKS           CLEAR PASSED SYMBOL FIELD   04620000
         LH    WORK1,PDELEN3                LENGTH OF SYMBOL            04630000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     04640000
         LA    WORK2,PSYMBOL                MOVE TO PASSED SYMBOL FIELD 04650000
         L     WORK3,PDEADRPT               MOVE FROM LOCATION          04660000
         EX    WORK1,MOVEINST               MOVE SYMBOL TO PSYMBOL      04670000
         B     MODINFO                      GO RESOLVE STATUS OF MODULE 04680000
OFFSETRQ EQU   *                                                        04690000
         OI    WHATPASS,V91                 INDICATE OFFSET PASSED AND  04700000
*                                            THE ARGUMENT FORM IS       04710000
*                                            LOADNAME    OFFSET         04720000
         XC    POFFSET(N4),POFFSET          OFFSET FIELD TO ZEROES      04730000
         LH    WORK1,PDELEN3                LENGTH OF OFFSET            04740000
         LA    WORK2,POFFSET                MOVE TO LOCATION            04750000
         LA    WORK4,N4                     NO. OF BYTES IN A WORD      04760000
         SR    WORK4,WORK1                  NO. OF INDEX BYTES-ALIGN    04770000
         AR    WORK2,WORK4                  OFFSET IN INFO BLOCK        04780000
         L     WORK3,PDEADRPT               MOVE FROM LOCATION          04790000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     04800000
         EX    WORK1,MOVEINST               MOVE OFFSET TO POFFSET      04810000
         B     MODINFO                      GO RESOLVE STATUS OF MODULE 04820000
NOADDRST OI    WHATPASS,VC0                 INDICATE ARGUMENT IS        04830000
*                                            LOADNAME.ENTRYNAM          04840000
*                                                                       04850000
*        BUILD AN INFO BLOCK REFLECTING THE MODULE PRESENTLY WORKING    04860000
*        WITH                                                           04870000
*                                                                       04880000
MODINFO  TM    WHATPASS,VC0                 IS ARGUMENT L.E OR JUST L   04890000
         BO    LE                           ARGUMENT IS L.E, GO RESOLVE 04900000
         TM    PDEFLG1,LDNAMFLG             ARGUMENT=L, IS IT PASSED    04910000
         BZ    USECURR                      NO, GO GET CURRENT LOADNAME 04920000
         OI    WHATPASS,V08                 INDICATE LOADNAME PASSED    04930000
         LH    WORK1,PDELEN1                LENGTH OF PASSED LOADNAME   04940000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     04950000
         LA    WORK2,TINFOBLK               MOVE TO TEMP INFO BLOCK     04960000
         L     WORK3,PDELDNAM               MOVE FROM LOCATION          04970000
         EX    WORK1,MOVEINST               MOVE ENTRYNAME TO INFO BLK  04980000
         CLC   TINFOBLK(N8),TSTCURLD        IS IT THE CURRENT LOADNAME  04990000
         BE    USECURR                      YES, GO USE CURRENT L       05000000
         B     FILLBLK                      GO FILL IN TEMP BLOCK       05010000
LE       TM    PDEFLG2,CTNAMFLG             IS ENTRYNAME PASSED         05020000
         BZ    USECURR                      NO, GO USE CURRENT L.E      05030000
         OI    WHATPASS,V04                 INDICATE ENTRYNAME PASSED   05040000
         LH    WORK1,PDELEN2                LENGTH OF PASSED ENTRYNAME  05050000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     05060000
         LA    WORK2,ENTRYNAM               MOVE TO LOCATION IN INFO BK 05070000
         L     WORK3,PDECTNAM               MOVE FROM LOCATION          05080000
         EX    WORK1,MOVEINST               MOVE ENTRYNAME TO TEMP INFO 05090000
         TM    PDEFLG1,LDNAMFLG             IS LOADNAME PASSED          05100000
         BO    ONWARD01                     YES, GO MOVE TO INFO BLK    05110000
         MVC   LOADNAME(N8),TSTCURLD        NO, USE CURRENTLY QUALIFIED 05120000
         B     ONWARD02                     GO ON                       05130000
ONWARD01 LH    WORK1,PDELEN1                LENGTH OF PASSED LOADNAME   05140000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     05150000
         L     WORK3,PDELDNAM               ADDR OF PASSED LOADNAME     05160000
         LA    WORK2,LOADNAME               MOVE TO LOCATION IN INFO BK 05170000
         EX    WORK1,MOVEINST               MOVE LOADNAME TO INFO BLOCK 05180000
         OI    WHATPASS,V08                 INDICATE LOADNAME PASSED    05190000
ONWARD02 CLC   TSTCURLD(N16),TINFOBLK       IS IT CURRENT L.E           05200000
         BE    USECURR                      YES, GO USE CURRENT L.E     05210000
         LA    INFOBLKB,TINFOBLK            USE TEMP BLK FOR BASE       05220000
         B     FILLBLK                      GO FILL IN TEMP BLOCK       05230000
USECURR  LA    INFOBLKB,CINFOBLK            USE CURRENT INFO BLOCK      05240000
         CLC   TSTCURLD(N16),CINFOBLK       IS CURR L.E KNOWN BY SYM    05250000
         BNE   GETCURR                      NO, GO CLEAR AND RE-BUILD   05260000
         CLC   TCBADDR(N4),PPTCB            CURRENT ON SAME TCB         05270000
         BNE   GETCURR                      NO, GO CLEAR AND RE-BUILD   05280000
         L     WORK1,TSTSYMBA               QUALIFIED SYMBOLIC BASE     05290000
         LTR   WORK1,WORK1                  QUALIFING TO A LOADNAME     05300000
         BCR   NOTZERO,RETURN               NO, CURR OK, RET TO CALLER  05310000
GETCURR  MVC   DDNAME(N8),BLANKS            CLEAR DDNAME FIELD          05320000
         MVC   CINFOBLK(N16),TSTCURLD       GET CURRENT L.E             05330000
         XC    LOADNAMA(N32),LOADNAMA       OTHER INFO TO ZEROES        05340000
*                                                                       05350000
*        SEARCH THE INFO BLOCKS CREATED BY THE TESTRAN SVC 61 (IN DEC)  05360000
*                                                                       05370000
FILLBLK  L     WORK1,TSTTRN                 ADDR OF FIRST SVC SAVE INFO 05380000
         LTR   WORK1,WORK1                  IS THEIR A TCB CNTRL BLK    05390000
*                                            FOR THE SVCINFO BLK CHAIN  05400000
         BZ    NOSVCINF                     NO SVCINFO, GO CHECK RB     05410000
         ST    RETURN,SVCBLK14              SAVE RET ADDR IN MAIN RT    05420000
         L     WORK2,PPTCB                  ADDR OF CURR QUALIFIED TCB  05430000
CURRTCB1 EQU   *                                                        05440000
         C     WORK2,N4(WORK1)              IS THIS TCB CNTRL BLK FOR   05450000
*                                            THE CURR QUALIFIED TCB     05460000
         BE    CURRTCB2                     YES, GO SET SEARCH SVC BLKS 05470000
         L     WORK1,N0(WORK1)              NEXT TCB CNTRL BLK ON CHAIN 05480000
         LTR   WORK1,WORK1                  IS THEIR ANYMORE            05490000
         BNZ   CURRTCB1                     YES, GO CHECK FOR CURR TCB  05500000
         B     VERFYTCB                     NO, GO SEARCH ALL VALID TCB 05510000
CURRTCB2 EQU   *                                                        05520000
         LR    WORK5,WORK1                  ADDR OF TCB CNTRL BLK FOR   05530000
*                                            CURRENT QUALIFIED TCB      05540000
         BAL   RETURN,VIEWSVC1              GO SEARCH SVCINFO BLK CHAIN 05550000
*                                                                       05560000
*        GET A TCB ADDRESS FROM THE TCB CNTRL BLK CHAIN FOR EACH        05570000
*        SVCINFO BLOCK CHAIN, VERIFY THE TCB STILL EXISTS AND SEARCH    05580000
*        THE SVCINFO BLOCKS USING LOADNAME AS THE SEARCH ARGUMENT       05590000
*                                                                       05600000
VERFYTCB EQU   *                                                        05610000
         L     WORK1,TSTTRN                 HEAD OF TCB CNTRL BLK CHAIN 05620000
VERFYBEG EQU   *                                                        05630000
         L     WORK2,TSTTCB                 ADDRESS OF TEST TCB         05640000
         LA    WORK3,N0(WORK2)              CLEAR HIGH ORDER BYTE, SAVE 05650000
VERFYDAU EQU   *                                                        05660000
         L     WORK4,TCBLTC-TCB(WORK2)      ADDRESS OF DAUGHTER         05670000
         LA    WORK4,N0(WORK4)              CLEAR HIGH ORDER BYTE       05680000
         LTR   WORK4,WORK4                  IS THEIR A DAUGHTER         05690000
         BNZ   CHKTCB                       YES, GO SEE IF ONE WE WANT  05700000
VERFYSIS EQU   *                                                        05710000
         L     WORK4,TCBNTC-TCB(WORK2)      ADDRESS OF SISTER           05720000
         LA    WORK4,N0(WORK4)              CLEAR HIGH ORDER BYTE       05730000
         LTR   WORK4,WORK4                  IS THEIR A SISTER           05740000
         BNZ   CHKTCB                       YES, GO SEE IF ONE WE WNAT  05750000
VERFYMOM EQU   *                                                        05760000
         L     WORK2,TCBOTC-TCB(WORK2)      ADDRESS OF MOTHER           05770000
         LA    WORK2,N0(WORK2)              CLEAR HIGH ORDER BYTE       05780000
         CR    WORK2,WORK3                  IS MOTHER THE TEST TCB      05790000
         BNE   VERFYSIS                     NO, GO CHECK FOR A SISTER   05800000
         B     VERFYEND                     YES, TCB FROM TCB CNTRL BLK 05810000
*                                            HAS BEEN DETACHED, GO GET  05820000
*                                            NEXT TCB CNTRL BLK         05830000
CHKTCB   EQU   *                                                        05840000
         C     WORK4,N4(WORK1)              IS THIS THE TCB WE WANT     05850000
         BE    TCBMATCH                     YES, GO SET UP TO SEARCH    05860000
*                                            SVC BLKS FOR THIS TCB      05870000
         LR    WORK2,WORK4                  FIND NEXT TCB UNDER TEST    05880000
         B     VERFYDAU                     LOOP UNTIL MATCH OR ALL TCB 05890000
*                                            UNDER TEST HAVE BEEN CHKED 05900000
TCBMATCH EQU   *                                                        05910000
         LR    WORK5,WORK1                  ADDR OF TCB CNTRL BLK       05920000
         BAL   RETURN,VIEWSVC1              GO SEARCH SVC BLK CHAIN     05930000
VERFYEND EQU   *                                                        05940000
         L     WORK1,N0(WORK1)              ADDR OF NEXT TCB CNTRL BLK  05950000
         LTR   WORK1,WORK1                  IS THEIR ANOTHER CHAIN      05960000
         BNZ   VERFYBEG                     YES, GO VERFIY ITS TCB      05970000
         L     RETURN,SVCBLK14              RESTORE RET ADDR IN MAIN RT 05980000
         B     NOSVCINF                     GO SEARCH RB CHAIN          05990000
VIEWSVC1 EQU   *                                                        06000000
         L     WORK5,N8(WORK5)              ADDR OF FIRST BLK ON CHAIN  06010000
         USING SVCINFO,WORK5                                            06020000
VIEWSVC2 EQU   *                                                        06030000
         CLC   LOADNAME(N8),LMODNAME        IS THIS THE SVC BLOCK       06040000
         BE    FOUND1                       YES, GO EXTRACT INFORMATION 06050000
         L     WORK5,NEXTBLK                NO, ADDR OF NEXT SVC BLOCK  06060000
         LTR   WORK5,WORK5                  IS THEIR ANOTHER SVC BLOCK  06070000
         BNZ   VIEWSVC2                     YES, GO SEE IF ITS THE ONE  06080000
         BR    RETURN                       NO, RETURN TO CALLER        06090000
FOUND1   EQU   *                                                        06100000
         L     RETURN,SVCBLK14              ADDR OF MAIN ROUTINE CALLER 06110000
         MVC   LOADNAMA(N4),LMLADDR         GET MAIN STORAGE ADDRESS    06120000
         MVC   ATTRIBUT(N4),LMATTRIB        GET MEMBER ATTRIBUTES       06130000
         MVC   TCBADDR(N4),LMTCB            GET LOADNAME'S TCB ADDRESS  06140000
         MVC   POINTER(N4),BEGTTR           GET TTR OF BEGIN OF MEMBER  06150000
         OI    MODSWS,V90                   INDICATE IT IS A LOAD MOD   06160000
*                                            AND THE TTSVC HAS OPERATED 06170000
         TM    LMFLAGS,V80                  DO WE HAVE A DDNAME FOR PDS 06180000
         BZ    SEELIB                       NO, GO SEE IF LIB=LINKLIB   06190000
         MVC   DDNAME(N8),LMDDNAME          GET DDNAME ALLOCATING PDS   06200000
         OI    MODSWS,V04                   YES, INDICATE DDNAME KNOWN  06210000
         BR    RETURN                       RETURN TO CALLER            06220000
SEELIB   EQU   *                                                        06230000
         TM    LMFLAGS,V40                  IS DATASET LINKLIB          06240000
         BCR   ONES,RETURN                  YES, CAN ALLOCATE, RETURN   06250000
         LA    RETCODE,N44                  NO, SECOND LEV MESG NUMBER  06260000
         B     NOFIND                       GO GIVE MESG, RETURN CODE   06270000
         DROP  WORK5                                                    06280000
*                                                                       06290000
*        SEARCH THE CDE CHAIN AND USE CDE AND EXTENT LIST INFO          06300000
*                                                                       06310000
NOSVCINF EQU   *                                                        06320000
         L     WORK3,PPRB                   ADDRESS OF CURRENT P/P RB   06330000
         L     WORK3,RBCDE-RBSECT(WORK3)    ADDRESS OF CDE              06340000
         USING CDENTRY,WORK3                ESTABLISH ADDRESS. TO CDE   06350000
         CLC   CDNAME(N8),LOADNAME          IS THIS THE PASSED LOADNAME 06360000
         BE    FOUND2                       YES, GO EXTRACT INFORMATION 06370000
CDECHAIN EQU   *                                                        06380000
         SR    WORK1,WORK1                  CLEAR REGISTER TO ZERO      06390000
         L     WORK3,TSTTCB                 ADDRESS OF TEST TCB         06400000
         L     WORK3,TCBJPQ-TCB(WORK3)      HEAD OF CDE CHAIN           06410000
         LA    WORK3,N0(WORK3)              CLEAR HIGH ORDER BYTE       06420000
CDE1     EQU   *                                                        06430000
         LTR   WORK3,WORK3                  END OF CDE CHAIN            06440000
         BNZ   CDE2                         NO, GO CONTINUE SEARCH      06450000
         LA    RETCODE,N4                   ERROR, LOADNAME NOT FOUND   06460000
         B     NOFIND                       GO SET UP ERROR MESSAGE     06470000
CDE2     EQU   *                                                        06480000
         CLC   CDNAME(N8),LOADNAME          IS CDE FOR PASSED LOADNAME  06490000
         BE    FOUND2                       YES, GO EXTRACT INFORMATION 06500000
         L     WORK3,CDCHAIN                ADDRESS OF NEXT CDE         06510000
         LA    WORK3,N0(WORK3)              CLEAR HIGH ORDER BYTE       06520000
         B     CDE1                         GO CHECK NEXT CDE           06530000
FOUND2   EQU   *                                                        06540000
         TM    CDATTR,CDMIN                 IS IT A MINOR CDE           06550000
         BZ    XL                           NO, GO GET XL ADDRESS       06560000
         L     WORK3,CDXLMJP                YES, ADDRESS OF MAJOR CDE   06570000
XL       EQU   *                                                        06580000
         L     WORK2,CDXLMJP                ADDRESS OF EXTENT LIST      06590000
         USING XTLST,WORK2                  ESTABLISH ADDRESS. XTLST    06600000
         L     WORK1,XTLNRFAC               NO. SCATTERED BLOCKS        06610000
         SLL   WORK1,N2                     TIMES NO. BYTES IN A WORD   06620000
         LA    WORK1,XTLMSBLA(WORK1)        ADDR OF FIRST LOADED BLOCK  06630000
         MVC   LOADNAMA+N1(N3),N1(WORK1)    MOVE IT TO INFO BLOCK       06640000
         TM    CDATTR2,CDSPZ                IS IT LOAD VIA OS  @ZA27196 06650003
         BO    OSLOADER                     YES, GO EXTRACT INFO        06660000
         OI    MODSWS,V80                   INDICATE IT IS A LOAD MOD   06670000
         BR    RETURN                       RETURN TO CALLER            06680000
OSLOADER CLI   N7(WORK2),V02                IS THEIR MORE EXTENT INFO   06690000
         BCR   LOW,RETURN                   NO, RETURN TO CALLER        06700000
         L     WORK5,N12(WORK2)             LENGTH OF SECOND EXTENT     06710000
         LA    WORK5,N0(WORK5)              CLEAR HIGH ORDER BYTE       06720000
         LTR   WORK5,WORK5                  IS LEN ZERO                 06730000
         BCR   ZERO,RETURN                  YES, RETURN TO CALLER       06740000
         ST    WORK5,CESDTTR                NO, LENGTH OF CESD INFO     06750000
         MVC   POINTER+N1(N3),N5(WORK1)     ADDR OF OS LOADER CESD INFO 06760000
*                                            INTO INFO BLOCK            06770000
         OI    MODSWS,V20                   INDICATE OS LOADER CESD AVA 06780000
         BR    RETURN                       RETURN TO CALLER            06790000
         SPACE 3                                                        06800000
*********************************************************************** 06810000
*                                                                     * 06820000
*        FOR A REQUEST FOR A SYMBOL, THIS ROUTINE SEARCHES SYM RCDS   * 06830000
*        IN THE LOADNAME MEMBER OF A PDS ON SECONDARY STORAGE.        * 06840000
*                                                                     * 06850000
*********************************************************************** 06860000
         SPACE 2                                                        06870000
FINDSYM  EQU   *                                                        06880000
         TM    MODSWS,V80                   IS IT A LOAD MODULE         06890000
         BO    LMOD                         YES, GO CHECK FOR SYM RCDS  06900000
         LA    RETCODE,N8                   NO, NO SYMS WITH OBJ        06910000
         B     NOFIND                       GO GIVE ERROR MESG          06920000
LMOD     EQU   *                                                        06930000
         TM    ATTRIBUT,V10                 WAS MOD LINKEDIT WITH TEST  06940000
         BO    ONWARDA                      YES, GO ON                  06950000
         LA    RETCODE,N20                  LOADNAME LKED, NO TEST PARM 06960000
         B     NOFIND                       NO, SYM CANNOT BE FOUND     06970000
ONWARDA  TM    ATTRIBUT+N1,V04              ARE SYMBOL RCDS PRESENT     06980000
         BO    ONWARDB                      YES, GO ON                  06990000
         LA    RETCODE,N36                  ENTRYNAME NOT ASM WITH TEST 07000000
         B     NOFIND                       NO, SYM CANNOT BE FOUND     07010000
ONWARDB  CLC   TSTCURLD(N16),LOADNAME       IS IT CURR LOADNAME-ENTRYNA 07020000
         BNE   MBASE                        NO, GO CREATE BASE FOR SYMS 07030000
         CLI   ENTRYNAM,V00                 IS CURR E DEFAULTED TO 1ST  07040000
         BNE   CURROK                       NO, GO USE TCOMTAB SYM BASE 07050000
         OI    SWSB,V10                     SEARCH FOR FIRST CSECT      07060000
         BAL   RETURN,FINDCESD              GO GET FIRST CSECT + DISPL  07070000
         MVI   SWSB,V00                     TURN OFF CESD SWITCHES      07080000
         MVC   TSTCURCT(N8),ENTRYNAM        MAKE FIRST CSECT CURRENT    07090000
         L     WORK1,LOADNAMA               GET LOADED ADDRESS          07100000
         A     WORK1,ENTRNAMD               ADD FIRST CSECT'S DISPL     07110000
         ST    WORK1,TSTSYMBA               CURR SYM BASE TO TCOMTAB    07120000
         ST    WORK1,BASEFSYM               ALSO IN CURRENT INFO BLOCK  07130000
         B     SYMBACK1                     GO ON                       07140000
CURROK   MVC   BASEFSYM(N4),TSTSYMBA        YES, SYM BASE FROM TCOMTAB  07150000
         B     SYMBACK1                     GO ON                       07160000
MBASE    CLI   ENTRYNAM,V00                 IS ENTRY DEFAULTED-1ST CSEC 07170000
         BNE   ENTRYPRS                     NO, ENTRYNAME IS PRESENT    07180000
         OI    SWSB,V10                     SEARCH FOR FIRST CSECT      07190000
         BAL   RETURN,FINDCESD              GO GET FIRST CSECT + DISPL  07200000
         MVI   SWSB,V00                     TURN OFF CESD SWITCHES      07210000
ENTRYPRS TM    MODSWS,V40                   IS ENTRYNAME DISPL PRESENT  07220000
         BO    ADDTOLA                      YES, GO CREATE SYM BASE     07230000
         OI    SWSB,V20                     SEARCH USING ENTRYNAME      07240000
         BAL   RETURN,FINDCESD              GO GET DISPL FOR ENTRYNAME  07250000
         MVI   SWSB,V00                     TURN OFF CESD SWITCHES      07260000
ADDTOLA  L     WORK1,LOADNAMA               LOADED ADDR OF MODULE       07270000
         A     WORK1,ENTRNAMD               ADD DISP OF ENTRYNAME       07280000
         ST    WORK1,BASEFSYM               BASE FOR SYMBOL DISPLACMENT 07290000
SYMBACK1 DS    0H                                                       07300000
         BAL   RETURN,OPENDCB               GO SET UP DCB FOR READ      07310000
         LA    PARMREG1,PDSDCB              ADDR OF DCB FOR POINT       07320000
SMTSYND1 DS    0H                           SMT TESTCASE LABEL          07330000
*                                            ENTER SYNAD ON SYMBOL READ 07340000
*                                            RC FROM SYM IS 12          07350000
*                                            TESTCASE ID  TTSTC150      07360000
         LA    PARMREG0,POINTER             ADDR OF TTR FOR POINT       07370000
         BAL   RETURN,DOPOINT               GO DO POINT                 07380000
READSYM  BAL   RETURN,DOREAD                GO READ SECONDARY STORAGE   07390000
         CLI   BUFFER,V40                   WAS A SYM/ESD RCD READ      07400000
         BE    SYMRCD1                      YES, GO CHECK FOR GOOD SYM  07410000
         TM    SWSA,V80                     WAS A PART ENTRY SAVED      07420000
         BZ    NOSYM1                       NO, GO GIVE UNRESOLVED CODE 07430000
         BAL   RETURN,INPARTAL              YES, GO CHECK PART ENTRY    07440000
NOSYM1   EQU   *                                                        07450000
         TM    SWSA,V10                     DID WE FIND ENTRYNAME       07460000
         BZ    NOTASM1                      NO, GO GIVE NOT ASEM CODE   07470000
         LA    RETCODE,N24                  YES, SYM NOT FOUND          07480000
         B     NOFIND                       GO GIVE RET CODE, MESG      07490000
NOTASM1  LA    RETCODE,N36                  ENTRYNAME NOT ASM WITH TEST 07500000
         B     NOFIND                       GO GIVE RET CODE, MESG      07510000
SYMRCD1  EQU   *                                                        07520000
         CLI   BUFFER+N1,V00                IS IT A GOOD SYM/ESD RECORD 07530000
         BE    SETUPSYM                     YES, GO SET UP TO ANALYZE   07540000
         TM    SWSA,V80                     NO, WAS A PART ENTRY SAVED  07550000
         BZ    READSYM                      NO, GO READ ANOTHER RECORD  07560000
         BAL   RETURN,INPARTAL              YES, GO CHECK PART ENTRY    07570000
         B     READSYM                      GO READ ANOTHER RECORD      07580000
*                                                                       07590000
*        THIS  ROUTINE ANALYZES A SYMBOL RECORD READ FROM SECONDARY     07600000
*        STORAGE. WORK1 POINTS TO THE BEGINNING OF THE LOGICAL RECORD,  07610000
*        WORK2 POINTS TO THE END OF THE PHYSICAL RECORD, WORK3 POINTS   07620000
*        TO THE CURRENT POSITION IN THE PHYSICAL RECORD, WORK4 WILL     07630000
*        CONTAIN THE NUMBER OF REMAINING DATA BYTES IN THE PRESENT      07640000
*        LOGICAL RECORD AND WORK5 WILL CONTAIN THE NUMBER OF BYTES IN   07650000
*        THE CURRENT ENTRY.                                             07660000
*                                                                       07670000
SETUPSYM EQU   *                                                        07680000
         LA    WORK1,BUFFER                 ADDR BEG OF PHSYICAL RCD    07690000
         LH    WORK2,N2(WORK1)              LENGTH OF PHSYICAL RECORD   07700000
         LA    WORK2,N4(WORK1,WORK2)        ADDR OF END OF PHSYICAL RCD 07710000
         LA    WORK3,N4(WORK1)              ADDR OF FIRST LOGICAL RCD   07720000
         LR    WORK1,WORK3                  ADDR OF FIRST LOGICAL RCD   07730000
ISITASYM CLI   N1(WORK3),LSYMRCD            IS THIS A LOGICAL SYM RCD   07740000
         BE    ONWARDS1                     YES, GO ON                  07750000
         TM    SWSA,V80                     WAS A PART ENTRY SAVED      07760000
         BZ    NOPART                       NO, GO ON                   07770000
         BAL   RETURN,INPARTAL              YES, GO CHECK PART ENTRY    07780000
NOPART   EQU   *                                                        07790000
         LA    WORK3,N80(WORK1)             ADDR OF NEXT LOGICAL RCD    07800000
         LR    WORK1,WORK3                  ADDR OF CURRENT LOGICAL RCD 07810000
         CR    WORK3,WORK2                  IS IT END OF PHSYICAL RCD   07820000
         BNL   READSYM                      YES, GO READ ANOTHER        07830000
         B     ISITASYM                     NO, GO CHECK NEXT LOGICAL   07840000
ONWARDS1 LH    WORK4,N10(WORK3)             LEN DATA IN LOGICAL RCD     07850000
         LA    WORK3,N16(WORK3)             ADDR OF FIRST ENTRY IN RCD  07860000
         TM    SWSA,V80                     WAS LAST ENTRY CONTINUED    07870000
         BO    ALIGNSYM                     YES, GO ALIGN ENTRY         07880000
BACKSYM1 LA    PARMREG1,N20                 MAXIUM ENTRY LENGTH         07890000
         CR    WORK4,PARMREG1               COULD NEXT ENTRY OVERFLOW   07900000
         BL    SAVEPART                     YES, SAVE POSSIBLE PART ENT 07910000
         BAL   RETURN,ENTRYLEN              GO CALCULATE SYM ENTRY LEN  07920000
         TM    N0(WORK3),V80                IS IT A DATA TYPE ENTRY     07930000
         BO    DATATYPE                     YES, GO CHECK               07940000
         BAL   RETURN,NOTDATA               NO, GO ANALYZE NON-DATA     07950000
         B     ENDENTRY                     GO END THIS ENTRY           07960000
DATATYPE TM    SWSA,V40                     SHOULD WE ANALZE ENTRY      07970000
         BZ    ENDENTRY                     NO, GO BYPASS THIS ONE      07980000
         TM    N0(WORK3),V08                IS A NAME PRESENT           07990000
         BO    ENDENTRY                     NO, DO NOT ANALYZE          08000000
         STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               08010000
         MVC   WAREA3(N8),BLANKS            CLEAR WORK AREA             08020000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       08030000
         LA    WORK2,N15                    CREATE 'AND' BYE - 0F       08040000
         NR    WORK1,WORK2                  LEN OF SYMBOL-1             08050000
         LA    WORK2,WAREA3                 MOVE TO LOCATION IN SYMWORK 08060000
         LA    WORK3,N4(WORK3)              ADDRESS OF SYMBOL TO MOVE   08070000
         EX    WORK1,MOVEINST               MOVE SYM TO WORK AREA       08080000
         LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            08090000
         CLC   WAREA3(N8),PSYMBOL           IS THIS THE SYMBOL          08100000
         BE    FOUNDSYM                     YES, GO CREATE SYMINFO BLK  08110000
ENDENTRY AR    WORK3,WORK5                  ADDR OF NEXT ENTRY          08120000
         SR    WORK4,WORK5                  LEN OF DATA REMAIN IN RCD   08130000
         LTR   WORK4,WORK4                  IS IT END OF A LOGICAL RCD  08140000
         BP    BACKSYM1                     NO, GO LOOK AT NEXT ENTRY   08150000
         LA    WORK3,N80(WORK1)             YES, ADDR OF NEXT LOGICAL   08160000
         LR    WORK1,WORK3                  ADDR OF CURRENT LOGICAL RCD 08170000
         CR    WORK3,WORK2                  IS IT END OF PHSYICAL RCD   08180000
         BNL   READSYM                      YES, GO READ NEXT PHSYICAL  08190000
         B     ISITASYM                     NO, GO LOOK AT NEXT LOGICAL 08200000
*                                                                       08210000
*        THIS ROUTINE WILL ALIGN A LOGICAL SYM RCD.  PARTIAL SYM INFO   08220000
*        FROM THE PREVIOUS LOGICAL RCD WILL BE PLACED IN FRONT OF THIS  08230000
*        PRESENT SYM RECORD.                                            08240000
*                                                                       08250000
ALIGNSYM STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               08260000
         L     WORK1,PENTRYLN               LEN OF PART TO ALIGIN       08270000
         AR    WORK4,WORK1                  NEW LEN OF DATA IN LOGICAL  08280000
         LR    WORK2,WORK3                  PRESENT ENTRY ADDRESS       08290000
         SR    WORK2,WORK1                  NEW PRESENT ENTRY ADDRESS   08300000
         LA    WORK3,PARTENTY               MOVE FROM LOCATION          08310000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     08320000
         EX    WORK1,MOVEINST               PREFIX LOG RCD WITH PARTENT 08330000
         LR    WORK3,WORK2                  NEXT ENTRY ADDRESS          08340000
         LM    WORK1,WORK2,WORKSAVE         RESTORE BEGIN-END POINTERS  08350000
         NI    SWSA,V7F                     TURN PARTIAL LAST ENTRY OFF 08360000
         B     BACKSYM1                     GO ANALYZE SYMBOL           08370000
*                                                                       08380000
*        THIS ROUTINE WILL CALCULATE THE LENGTH OF A SYM ENTRY          08390000
*                                                                       08400000
ENTRYLEN STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               08410000
         LA    WORK5,N4                     BASIC SYM LENGTH-ORGANIZATN 08420000
*                                             PLUS DISP FROM CSECT      08430000
         SR    WORK1,WORK1                  INITIAL LEN OF NAME         08440000
         TM    N0(WORK3),V08                IS NAME PRESENT             08450000
         BO    NONAME                       NO, GO ON                   08460000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       08470000
         LA    WORK2,N15                    CREATE 'AND' FIELD - 0F     08480000
         NR    WORK1,WORK2                  LEN OF NAME-1               08490000
         LA    WORK1,N1(WORK1)              LENGTH OF NAME              08500000
         AR    WORK5,WORK1                  ENTRY LEN  PLUS NAME LENGTH 08510000
NONAME   TM    N0(WORK3),V80                IS IT A DATA TYPE           08520000
         BO    DATAENTY                     YES, GO CALCULATE LEN       08530000
         TM    N0(WORK3),VF0                IS NON-DATA TYPE A SPACE    08540000
         BM    GOTLEN                       NO, HAVE LEN, GO RETURN     08550000
         LA    WORK5,N1(WORK5)              YES, ADD ALIGN BYTE FIELD   08560000
         B     GOTLEN                       HAVE LENGTH, GO RETURN      08570000
DATAENTY EQU   *                                                        08580000
         LA    WORK5,N1(WORK5)              YES, ADD LEN OF DATA FIELD  08590000
         TM    N0(WORK3),V40                IS THEIR ANY MULTIPLICITY   08600000
         BZ    NOMULTIP                     NO, GO ON                   08610000
         LA    WORK5,N3(WORK5)              ENTRY LEN PLUS LEN M FIELD  08620000
NOMULTIP TM    N0(WORK3),V10                IS A SCALE FIELD PRESENT    08630000
         BZ    NOSCALE                      NO, GO ON                   08640000
         LA    WORK5,N2(WORK5)              ENTRY LEN PLUS LEN S FIELD  08650000
NOSCALE  LA    WORK2,N4(WORK3,WORK1)        ADDR OF DATA FIELD          08660000
         CLI   N0(WORK2),V08                IS LENGTH FIELD 1 OR 2 BYTE 08670000
         BH    ONEBYTE                      LEN FIELD IS ONE BYTE       08680000
         LA    WORK5,N1(WORK5)              ENTRY LEN +2 BYTE LEN FIELD 08690000
ONEBYTE  LA    WORK5,N1(WORK5)              ENTRY LEN +1 BYTE LEN FIELD 08700000
GOTLEN   LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            08710000
         BR    RETURN                       GO CHECK NEXT ENTRY         08720000
*                                                                       08730000
*        THIS ROUTINE WILL SAVE A POSSIBLE PARTIAL ENTRY FOR PREFIXING  08740000
*        TO THE NEXT LOGICAL SYM RCD                                    08750000
*                                                                       08760000
SAVEPART STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               08770000
         ST    WORK4,PENTRYLN               LENGTH OF PART TO SAVE      08780000
         LR    WORK1,WORK4                  LEN OF PART TO SAVE         08790000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     08800000
         LA    WORK2,PARTENTY               MOVE TO LOCATION            08810000
         EX    WORK1,MOVEINST               SAVE PART ENTRY IN SYMWORK  08820000
         OI    SWSA,V80                     SET LAST ENTRY CONTINUED SW 08830000
         LR    WORK5,WORK4                  SET LEN TO REMAIN DATA BYTS 08840000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            08850000
         B     ENDENTRY                     GO END LOGICAL RECORD       08860000
*                                                                       08870000
*        THIS ROUTINE WILL HANDLE NON-DATA TYPES AND DECIDE WHEN TO     08880000
*        ANALYZE SYM ENTRIES.                                           08890000
*                                                                       08900000
NOTDATA  STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               08910000
         MVC   WAREA2(N8),BLANKS            BLANK OUT WORK AREA         08920000
         SR    WORK1,WORK1                  CLEAR REG FOR IC INSTRUCTON 08930000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       08940000
         STC   WORK1,WAREA3                 SAVE ORGANIZATION BYTE      08950000
         TM    N0(WORK3),V08                IS THEIR A NAME             08960000
         BO    SEETYPE                      NO, GO CHECK NON-DATA TYPE  08970000
         LA    WORK2,N15                    CREATE 'AND' FIELD - 0F     08980000
         NR    WORK1,WORK2                  LEN OF NAME-1               08990000
         LA    WORK2,WAREA2                 MOVE TO LOC IN SYMWORK      09000000
         LA    WORK3,N4(WORK3)              ADDRESS OF SYMBOL TO MOVE   09010000
         EX    WORK1,MOVEINST               MOVE NAME TO A WORK AREA    09020000
         L     WORK3,WKSAVE3A               RESTORE ADDRESS OF  YA00074 09030000
*                                           ENTRY                       09040000
SEETYPE  NI    WAREA3,VF0                   NON-DATA TYPE INFO          09050000
         CLI   WAREA3,V10                   IS IT A CSECT               09060000
         BNE   ISITDSEC                     NO, GO CHECK FOR A DSECT    09070000
         CLC   WAREA2(N8),ENTRYNAM          IS IT THE ENTRYNAME CSECT   09080000
         BNE   NOCHECK                      NO, GO TURN SWS OFF         09090000
         OI    SWSA,V50                     YES, TURN ANALYZE SWITCH ON 09100000
*                                            AND INDICATE SYMS ARE      09110000
*                                            AVAILABLE FOR THIS         09120000
*                                            ENTRYNAME                  09130000
         NI    SWSA,VDF                     TURN DSECT SW OFF           09140000
RNDATA1  LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            09150000
         BR    RETURN                       GO RETURN TO CALLER         09160000
NOCHECK  NI    SWSA,V9F                     TURN OFF ANALYZE,DSECT SWS  09170000
         B     RNDATA1                      GO BACK                     09180000
ISITDSEC CLI   WAREA3,V20                   IS IT A DSECT               09190000
         BNE   ISASWON                      NO, GO CHECK ANALYZE SWITCH 09200000
         OI    SWSA,V60                     YES, TURN ON ANALYZE,DSECT  09210000
         MVC   WAREA1(N8),WAREA2            SAVE DSECT NAME NOW SEARCH- 09220000
*                                            ING THROUGH                09230000
         B     RNDATA1                      GO RETURN                   09240000
ISASWON  TM    SWSA,V40                     ARE WE ANALYZING            09250000
         BZ    RNDATA1                      NO, RETURN                  09260000
         CLC   WAREA2(N8),PSYMBOL           YES, IS THIS THE SYMBOL     09270000
         BNE   RNDATA1                      NO, RETURN                  09280000
*                                                                       09290000
*        SYMBOL FOUND, BUT NOT DATA TYPE, WORK3 POINTS TO ENTRY,        09300000
*        WORK1 IS LENGTH OF SYMBOL MINUS ONE                            09310000
*                                                                       09320000
         LA    WORK2,N5(WORK3,WORK1)        WORK2 POINT TO DATA FIELD   09330000
         CLI   WAREA3,V40                   IS IT AN INSTRUCTION        09340000
         BNE   CHECKCCW                     NO, GO CHECK FOR A CCW      09350000
         MVI   N0(WORK2),V0C                YES- TYPE IS 0C             09360000
         NI    N0(WORK3),V0F                TURN OFF ANY ERRENOUS BITS  09370000
         MVI   N1(WORK2),V00                CREATE 1 BYTE LEN FIELD=0   09380000
         B     FOUNDSYM                     GO CREATE ANSWER BLOCK      09390000
CHECKCCW CLI   WAREA3,V50                   IS IT A CCW                 09400000
         BNE   DEFAULT                      NO, GO DEFAULT IT           09410000
         MVI   N0(WORK2),V04                YES, - MAKE IT HEX          09420000
         NI    N0(WORK3),V0F                TURN OFF ANY ERRENOUS BITS  09430000
         MVC   N1(N2,WORK2),CCWLENFD        LENGTH FIELD FOR A CCW      09440000
         B     FOUNDSYM                     GO CREATE ANSWER BLOCK      09450000
DEFAULT  NI    N0(WORK3),V0F                TURN OFF ANY ERRENOUS BITS  09460000
         MVI   N0(WORK2),V04                MAKE IT HEX                 09470000
         MVC   N1(N2,WORK2),DEFLENFD        LEN FIELD FOR DEFAULT       09480000
         B     FOUNDSYM                     GO BUILD ANSWER BLOCK       09490000
*                                                                       09500000
*        THIS ROUTINE WILL SEARCH A PARTIAL SAVED ENTRY FROM A          09510000
*        LOGICAL SYM RECORD FROM SECONDARY STORAGE                      09520000
*                                                                       09530000
INPARTAL EQU   *                                                        09540000
         STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               09550000
         ST    RETURN,PART14                SAVE RETURN ADDRESS         09560000
         NI    SWSA,V7F                     TURN PARTIAL ENTRY SW OFF   09570000
         LA    WORK3,PARTENTY               ADDRESS OF SAVED PART ENTRY 09580000
         L     WORK4,PENTRYLN               LEN OF SAVED PARTIAL ENTRY  09590000
         LA    WORK2,N0(WORK3,WORK4)        END OF SAVED PART ENTRY     09600000
LENCHECK BAL   RETURN,ENTRYLEN              GO CALCUATE LEN NEXT ENTRY  09610000
         CR    WORK4,WORK5                  IS THEIR A COMPLETE ENTRY   09620000
         BNL   LOOKAT                       YES, GO ON                  09630000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            09640000
         L     RETURN,PART14                NO, GET RETURN ADDRESS      09650000
         BR    RETURN                       RETURN TO CALLER            09660000
LOOKAT   TM    N0(WORK3),V80                IS IT A DATA TYPE           09670000
         BO    TYPEDATA                     YES, GO CHECK FUTHER        09680000
         BAL   RETURN,NOTDATA               NO, GO CHECK NON-DATA TYPE  09690000
         B     ENTRYEND                     GO END THIS ENTRY           09700000
TYPEDATA TM    SWSA,V40                     SHOULD WE ANALYZE ENTRY     09710000
         BZ    ENTRYEND                     NO, GO END ENTRY            09720000
         TM    N0(WORK3),V08                IS A NAME PRESENT           09730000
         BO    ENTRYEND                     NO, GO, WE NEED A NAME      09740000
         STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               09750000
         MVC   WAREA3(N8),BLANKS            CLEAR WORK AREA             09760000
         SR    WORK1,WORK1                  CLEAR REG FOR IC INSTR      09770000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       09780000
         LA    WORK2,N15                    CREATE 'AND' BYTE - 0F      09790000
         NR    WORK1,WORK2                  LEN OF SYMBOL-1             09800000
         LA    WORK2,WAREA3                 MOVE TO LOCATION            09810000
         LA    WORK3,N4(WORK3)              ADDRESS OF SYMBOL TO MOVE   09820000
         EX    WORK1,MOVEINST               MOVE SYM TO WORK AREA       09830000
         LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            09840000
         CLC   WAREA3(N8),PSYMBOL           IS THIS THE SYMBOL REQUESTD 09850000
         BE    FOUNDSYM                     YES, GO CREATE ANSWER BLOCK 09860000
ENTRYEND AR    WORK3,WORK5                  ADDR OF NEXT ENTRY          09870000
         SR    WORK4,WORK5                  LEN OF DATA REMAIN IN RCD   09880000
         CR    WORK3,WORK2                  ANY MORE ENTRIES IN PARTIAL 09890000
         BL    LENCHECK                     YES, GO CHECK FOR NEXT ONE  09900000
         L     RETURN,PART14                NO, SYMBOL NOT FOUND        09910000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            09920000
         BR    RETURN                       RETURN TO CALLER            09930000
         SPACE 3                                                        09940000
*********************************************************************** 09950000
*                                                                     * 09960000
*        FOR A REQUEST FOR A SYMBOL, THIS ROUTINE SEARCHS THE INCORE  * 09970000
*        SYMBOL TABLE                                                 * 09980000
*        IF THE SEARCH IS FOR A DSECT, THE DSECT NAME WILL BE         * 09990000
*        IN WAREA1                                                    * 10000000
*                                                                     * 10010000
*********************************************************************** 10020000
         SPACE 2                                                        10030000
SINCORES MVC   WAREA1(N8),BLANKS            CLEAR SYMBOL WORK AREA      10040000
         LH    WORK1,PDELEN3                LENGTH OF PASSED SYMBOL     10050000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     10060000
         L     WORK3,PDEADRPT               ADDR OF PASSED SYMBOL       10070000
         LA    WORK2,WAREA1                 MOVE TO LOCATION            10080000
         EX    WORK1,MOVEINST               MOVE SYMBOL TO WORK AREA    10090000
DSECTIN  L     WORK4,SYMTABLE               ADDR OF INCORE SYM TABLE    10100000
         USING INCORE,WORK4                 BASE FOR DESCRIPTIVE DSECT  10110000
SEARCH3  LTR   WORK4,WORK4                  IS IT LAST INCORE SYM TABLE 10120000
         BC    N7,CSEARCH3                  NO, GO CONTINUE SEARCH      10130000
         LA    RETCODE,N4                   YES, SYMBOL NOT FOUND       10140000
         BR    RETURN                       RETURN TO CALLER            10150000
CSEARCH3 MVC   WAREA2(N8),BLANKS            CLEAR SYMBOL WORK AREA      10160000
         LH    WORK1,LENSYM                 LENGTH OF SYMBOL NAME       10170000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     10180000
         LA    WORK3,INSYM                  ADDRESS OF SYMBOL           10190000
         LA    WORK2,WAREA2                 MOVE TO LOCATION IN SYMWORK 10200000
         EX    WORK1,MOVEINST               MOVE SYMBOL TO WORK AREA    10210000
         CLC   WAREA1(N8),WAREA2            IS THIS THE SYMBOL          10220000
         BE    FOUND3                       YES, GO EXTRACT INFO        10230000
         L     WORK4,NXINCORE               NO, POINT TO NEXT INCORE    10240000
         B     SEARCH3                      GO LOOK AT NEXT SYM INCORE  10250000
FOUND3   LNR   WORK3,WORK4                  SYM FOUND IN INCORE TABLE   10260000
         DROP  WORK4                                                    10270000
         SR    RETCODE,RETCODE              RETCODE IS ZERO             10280000
         BR    RETURN                       RETURN TO CALLER            10290000
         SPACE 3                                                        10300000
*********************************************************************** 10310000
*                                                                     * 10320000
*        THIS  SUB-ROUTINE OBTAINS CESD INFORMATION EITHER FROM CESD  * 10330000
*        RCDS ON SECONDARY STORAGE OR FROM INCORE CESD INFO SAVED BY  * 10340000
*        THE OS LOADER.  HOW TO SEARCH IS INDICATED BY SWITCHES, SWSB * 10350000
*        AND THEIR ARE THREE POSSIBLTIES- SEARCH USING OFFSET, SEARCH * 10360000
*        USING ENTRYNAME OR SEARCH FOR THE FIRST CSECT.               * 10370000
*********************************************************************** 10380000
         SPACE 2                                                        10390000
*                                                                       10400000
*        FOR   LOAD MODULES THIS ROUTINE READS SECONDARY STORAGES       10410000
*        AND RETURNS THE DESIRED INFORMATION                            10420000
*                                                                       10430000
FINDCESD ST    RETURN,CESD14                SAVE RETURN ADDRESS         10440000
         TM    MODSWS,V80                   IS IT A LOAD OR OBJ MODULE  10450000
         BZ    OBJMOD                       OBJ MOD, GO ANALYZE         10460000
         TM    MODSWS,V10                   HAS THE TTSVC OPERATED      10470000
         BO    SVCDID                       YES, GO ON                  10480000
         LA    RETCODE,N12                  NOT LOADED BY TEST          10490000
         B     NOFIND                       NO, ERROR, NO CESD INFO     10500000
SVCDID   DS    0H                                                       10510000
         BAL   RETURN,OPENDCB               GO OPEN DCB                 10520000
         TM    MODSWS,V08                   IS A CESD RCD TTR AVAILABLE 10530000
         BZ    USESYMS                      NO, GO USE SYMS TTR         10540000
SMTSYND2 DS    0H                           SMT TESTCASE LABEL          10550000
*                                            ENTER SYNAD ON CESD READ   10560000
*                                            RC FROM SYM IS 12          10570000
*                                            TESTCASE ID  TTSTC150      10580000
         LA    PARMREG0,CESDTTR             YES, USE CESD TTR           10590000
         B     ONWARD99                     GO ON                       10600000
SMTSYND3 DS    0H                           SMT TESTCASE LABEL          10610000
*                                            ENTER SYNAD ON CESD READ   10620000
*                                            RC FROM SYM IS 12          10630000
*                                            TESTCASE ID  TTSTC150      10640000
USESYMS  LA    PARMREG0,POINTER             USE SYM TTR FOR POINT       10650000
ONWARD99 LA    PARMREG1,PDSDCB              ADDR OF DCB FOR POINT       10660000
         BAL   RETURN,DOPOINT               GO ISSUE POINT              10670000
READCESD BAL   RETURN,DOREAD                GO READ FROM SECONDARY STOR 10680000
         CLI   BUFFER,V20                   IS IT A CESD RECORD         10690000
         BE    PROCESS1                     YES, GO PROCESS             10700000
         TM    SWSB,V80                     NO, HAS A CESD RCD BEEN RED 10710000
         BZ    READCESD                     NO, GO READ AGAIN           10720000
         TM    SWSB,V10                     IS SEARCH FOR FIRST CSECT   10730000
         BZ    GIVEERR                      NO, GO SET ERROR CODE       10740000
         MVC   ENTRYNAM(N8),BLANKS          FIRST CSECT NAME IS BLANK   10750000
         MVC   ENTRNAMD(N4),POFFSET         DISPLACEMENT IS OFFSET      10760000
         OI    MODSWS,V40                   INDICATE DISPL PRESENT      10770000
         L     RETURN,CESD14                GET RETURN ADDRESS          10780000
         BR    RETURN                       RETURN TO CALLER            10790000
GIVEERR  EQU   *                                                        10800000
         LA    RETCODE,N32                  ENTRYNAME NOT IN CESD RCDS  10810000
         B     NOFIND                       ERROR, NO MORE CESD RCDS    10820000
PROCESS1 OI    SWSB,V80                     INDICATE CESD RCD READ      10830000
         TM    MODSWS,V08                   IS A CESD TTR AVAILABLE     10840000
         BO    ONWARD98                     YES, GO ON                  10850000
         LA    PARMREG1,PDSDCB              NO, OBTAIN ONE              10860000
         BAL   RETURN,DONOTE                GO NOTE FIRST CESD RECORD   10870000
         ST    PARMREG1,CESDTTR             SAVE TTR                    10880000
         MVC   CESDTTR+N3(N1),POINTER+N3    CONCATENATION NO. TO TTR    10890000
         OI    MODSWS,V08                   INDICATE CESD TTR AVALIABLE 10900000
ONWARD98 LA    WORK2,BUFFER                 ADDR OF PHYSICAL RCD        10910000
         LH    WORK3,N6(WORK2)              LENGTH OF DATA PORTION      10920000
         LA    WORK2,N8(WORK2)              ADDR OF FIRST ENTRY         10930000
         LA    WORK3,N0(WORK3,WORK2)        ADDR OF END OF PHYSICAL RCD 10940000
         TM    SWSB,V20                     IS SEARCH USING ENTRYNAME   10950000
         BO    FINDNAME                     YES, SEARCH USING ENTRYNAME 10960000
         TM    SWSB,V10                     IS SEARCH FOR FIRST CSECT   10970000
         BZ    SEARCH4                      NO, SEARCH USING OFFSET     10980000
         SR    WORK1,WORK1                  YES, CREATE A ZERO OFFSET   10990000
         ST    WORK1,POFFSET                 AND USE OFFSET SEARCH RT   11000000
         TM    ATTRIBUT,V20                 IS LMOD LINK EDITED IN OVLY 11010000
         BZ    SEARCH4                      NO, OFFSET OK, GO SEARCH    11020000
         STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               11030000
         LA    WORK1,N4                     SET INDEX, 4 REGIONS MAX    11040000
         L     WORK3,LOADNAMA               ADDRESS OF SEGTAB CSECT     11050000
         SR    WORK4,WORK4                  CLEAR REGISTER TO ZERO      11060000
CKREGION EQU   *                                                        11070000
         IC    WORK4,N8(WORK3)              GET LAST SEG. NO. IN REGION 11080000
         TM    N10(WORK3),VFF               ARE THEIR ANY MORE REGIONS  11090000
         BZ    LASTREGN                     NO, GO FIGURE LEN OF SEGTAB 11100000
         BCT   WORK1,SETNEXT1               YES, GO SET TO CHECK NEXT   11110000
         B     LASTREGN                     NO, HAVE 4 REGNS, GO        11120000
SETNEXT1 EQU   *                                                        11130000
         LA    WORK3,N2(WORK3)              SEGTAB PTR TO NEXT REGION   11140000
         B     CKREGION                     GO CHECK NEXT REGION        11150000
LASTREGN EQU   *                                                        11160000
         SLL   WORK4,N2                     MULTIPLY LAST SEG NO. BY 4  11170000
         LA    WORK2,N24(WORK4)             LENGTH OF SEGTAB CSECT      11180000
         ST    WORK2,POFFSET                SAVE                        11190000
         TM    POFFSET+N3,V04               TEST FOR ALIGNMENT          11200000
         BZ    SETSEACH                     ON DOUBLE WORD, GO SEARCH   11210000
         LA    WORK2,N4(WORK2)              ALIGNED ON NEXT DOUBLE WORD 11220000
         ST    WORK2,POFFSET                OFFSET FOR 1ST CSECT SEARCH 11230000
SETSEACH EQU   *                                                        11240000
         LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            11250000
*                                                                       11260000
*        SEARCH CESD RCD USING PASSED OFFSET, RETURN ENTRYNAME CONTAIN- 11270000
*        THAT  OFFSET                                                   11280000
*                                                                       11290000
SEARCH4  NI    N8(WORK2),V0F                TURN OFF L.E. SUBCLASS      11300000
         CLI   N8(WORK2),V00                IS IT A SECTION DEFINITION  11310000
         BE    SD                           YES, CHECK FOR RIGHT ONE    11320000
BACK99   LA    WORK2,N16(WORK2)             POINT TO NEXT ENTRY         11330000
         CR    WORK2,WORK3                  IS IT END OF RCD            11340000
         BL    SEARCH4                      NO, CONTINUE SEARCH         11350000
         B     READCESD                     YES, GO READ ANOTHER RCD    11360000
SD       L     WORK4,N8(WORK2)              DISP OF SD ENTRY            11370000
         C     WORK4,POFFSET                IS SD ORGIN PAST OFFSET     11380000
         BH    BACK99                       YES, GO CHECK NEXT CESD     11390000
         L     WORK5,N12(WORK2)             SEGMENT NO. AND LENGTH      11400000
         LA    WORK5,N0(WORK5)              LENGTH OF CSECT             11410000
         ST    WORK5,WAREA1                 LENGTH TO WORK AREA         11420000
         TM    WAREA1+N3,V07                IS LEN DOUBLE WORD MULTIPLE 11430000
         BZ    ONDWORD                      YES, GO CONTINUE            11440000
         SRL   WORK5,N3                     DISCARD 3 LOW ORDER BITS    11450000
         SLL   WORK5,N3                     3 LOW ORDER BITS ARE ZERO   11460000
         LA    WORK5,N8(WORK5)              LEN IS MULTIPLE OF DOUBLE   11470000
ONDWORD  EQU   *                                                        11480000
         AR    WORK4,WORK5                  LEN OF MEMBER, SO FAR       11490000
         L     WORK1,POFFSET                OFFSET PASSED IN PDE        11500000
         CR    WORK1,WORK4                  IS OFFSET IN THIS CSECT     11510000
         BL    FOUND4                       YES, GO FILL IN INFOBLK     11520000
         B     BACK99                       NO, SEARCH SOME MORE        11530000
FOUND4   EQU   *                                                        11540000
         TM    ATTRIBUT,V20                 IS LMOD LINK EDITED IN OVLY 11550000
         BZ    INCORE4                      NO, CSECT INCORE, GO PASS   11560000
         ST    WORK3,WKSAVE3                SAVE END OF CESD RCD ADDR   11570000
         BAL   RETURN,CHKSEGMT              YES, GO SEE IF CSECT INCORE 11580000
         L     WORK3,WKSAVE3                RESTORE END OF CESD RCD PTR 11590000
         LTR   RETCODE,RETCODE              IS CSECT IN CORE            11600000
         BNZ   BACK99                       NO, GO BACK, CONTUNE SEARCH 11610000
INCORE4  EQU   *                                                        11620000
         MVC   ENTRYNAM(N8),N0(WORK2)       CSECT NAME TO ENTRYNAME FLD 11630000
         MVC   ENTRNAMD+N1(N3),N9(WORK2)    GET ENTRYNAME DISPLACMENT   11642000
         OI    MODSWS,V40                   ENTRYNAME DISPLACMENT HERE  11650000
         L     RETURN,CESD14                GET RETURN ADDR             11660000
         BR    RETURN                       RETURN                      11670000
*                                                                       11680000
*        SEARCH CESD RCDS USING PASSED ENTRYNAME  RETURN DISPLACEMENT   11690000
*        BASED ON LINKAGE EDITOR ADDR 00, OF THAT CSECT                 11700000
*                                                                       11710000
FINDNAME CLC   ENTRYNAM(N8),N0(WORK2)       IS THIS THE CSECT           11720000
         BE    FOUND5                       YES, GO EXTRACT DISPLACMENT 11730000
         LA    WORK2,N16(WORK2)             NO, POINT TO NEXT ENTRY     11740000
         CR    WORK2,WORK3                  IS IT THE END OF THE RCD    11750000
         BL    FINDNAME                     NO, GO CHECK NEXT CESD ENTY 11760000
         B     READCESD                     YES, GO READ ANOTHER RECORD 11770000
FOUND5   EQU   *                                                        11780000
         TM    ATTRIBUT,V20                 IS LMOD LINK EDITED IN OVLY 11790000
         BZ    INCORE5                      NO, CSECT INCORE, GO PASS   11800000
         BAL   RETURN,CHKSEGMT              YES, GO SEE IF CSECT INCORE 11810000
         LTR   RETCODE,RETCODE              IS CSECT IN CORE            11820000
         BZ    INCORE5                      YES, GO PASS TO CALLER      11830000
         LA    RETCODE,N40                  NO, PASS 2ND LEVEL MESG NO. 11840000
         B     NOFIND                       GO GIVE RET CODE, MESSAGE   11850000
INCORE5  EQU   *                                                        11860000
         MVC   ENTRNAMD+N1(N3),N9(WORK2)    GET ENTRYNAME DISPLACEMENT  11870000
         OI    MODSWS,V40                   INDICATE DISPLACMENT PRESNT 11880000
         L     RETURN,CESD14                GET RETURN ADDR             11890000
         BR    RETURN                       RETURN                      11900000
*                                                                       11910000
*        IF THE LOAD MODULE IS LINK EDITTED IN OVERLAY, SEE IF SEGMENT  11920000
*        CONTAINNING ENTRYNAME IS IN CORE                               11930000
*                                                                       11940000
CHKSEGMT EQU   *                                                        11950000
         SR    RETCODE,RETCODE              INITIAL INDCATE, SEG INCORE 11960000
         SR    WORK1,WORK1                  CLEAR REGISTER TO ZERO      11970000
         IC    WORK1,N12(WORK2)             SEG NO. OF FOUND ENTRYNAME  11980000
         SLL   WORK1,N2                     MULTIPLY BY FOUR            11990000
         L     WORK3,LOADNAMA               ADDRESS OF SEGTAB CSECT     12000000
         LA    WORK3,N23(WORK3,WORK1)       PTR TO STATUS IND FOR SEGMT 12010000
         TM    N0(WORK3),V03                ARE LOW ORDER 2 BITS 00     12020000
         BCR   ZERO,RETURN                  YES, SEGMENT INCORE, RETURN 12030000
         BO    NOTINMS                      NO, NOT INCORE, GO SET ERR  12040000
         TM    N0(WORK3),V02                ARE LOW ORDER 2 BITS 10     12050000
         BCR   ONES,RETURN                  YES, SEGMENT INCORE, RETURN 12060000
NOTINMS  EQU   *                                                        12070000
         LA    RETCODE,N4                   INDICATE SEGMENT NOT INCORE 12080000
         BR    RETURN                       RETURN TO CALLER            12090000
*                                                                       12100000
*        THIS ROUTINE SEARCHS INCORE CESD INFO BUILT BY THE OS LOADER   12110000
*                                                                       12120000
OBJMOD   TM    MODSWS,V20                   IS OS LOADER CESD INFO AVAB 12130000
SMTOBJ   DS    0H                           SMT TESTCASE LABEL          12140000
*                                            OBJ CESD NOT AVAILABLE     12150000
*                                            RC FROM SYM IS 4           12160000
*                                            TESTCASE ID  TEQU6100      12170000
         BO    CESDHERE                     YES, GO ON                  12180000
         LA    RETCODE,N16                  NO OS LOADER CESD INFO      12190000
         B     NOFIND                       NO, CANNOT RESOLVE          12200000
CESDHERE L     WORK2,POINTER                ADDR OF OS LOADER CESD INFO 12210000
         L     WORK3,CESDTTR                LENGTH OF CESD INFO         12220000
         AR    WORK3,WORK2                  END ADDR OF CESD INFO       12230000
         XC    WAREA1(N16),WAREA1           CLEAR WORK AREAS TO ZEROES  12240000
         TM    SWSB,V20                     IS SEARCH USING ENTRYNAME   12250000
         BO    SEARCH6                      YES, GO FIND DISPLACMENT    12260000
         L     WORK1,POFFSET                SEARCH USING OFFSET         12270000
         LA    WORK1,N8(WORK1)              ADD LEN OF **GO             12280000
         ST    WORK1,POFFSET                NEW OFFSET                  12290000
         B     OBJOFFST                     GO SEARCH USING OFFSET      12300000
*                                                                       12310000
*        THIS ROUTINE SEARCHS OS LOADER CESD INFO FOR A DISPLACEMENT    12320000
*        USING A CSECT NAME AS THE SEARCH ARGUMENT. WORK2 CONTAINS      12330000
*        THE PRESENT ENTRY ADDRESS, WORK3 CONTAINS THE END ADDRESS      12340000
*                                                                       12350000
SEARCH6  CR    WORK2,WORK3                  ANY MORE OS LOADER CESDS    12360000
         BL    CHECK6                       YES, GO CHECK THIS ENTRY    12370000
         LA    RETCODE,N32                  ENTRYNAME NOT IN CESD RCDS  12380000
         B     NOFIND                       NO, ERROR, CANNOT RESOLVE   12390000
CHECK6   CLC   ENTRYNAM(N8),N0(WORK2)       IS THIS THE CSECT           12400000
         BE    FOUND6                       YES, GO EXTRACT DISPLACEMNT 12410000
         LA    WORK2,N12(WORK2)             POINT TO NEXT ENTRY         12420000
         B     SEARCH6                      GO CHECK NEXT ENTRY         12430000
FOUND6   MVC   WAREA1+N1(N3),N9(WORK2)      LOADED ADDR OF THIS CSECT   12440000
         L     WORK4,WAREA1                 ADDR OF ENTRYNAME IN CORE   12450000
         S     WORK4,LOADNAMA               DISPL FROM LOADED ADDR      12460000
         ST    WORK4,ENTRNAMD               SAVE IN INFO BLOCK          12470000
         OI    MODSWS,V40                   INDICATE DISPLACEMENT PRSNT 12480000
         L     RETURN,CESD14                GET RETURN ADDRESS          12490000
         BR    RETURN                       RETURN                      12500000
*                                                                       12510000
*        THIS ROUTINE SEARCHS OS LOADER CESD INFO FOR A CSECT NAME      12520000
*        USING AN OFFSET AS A SEARCH ARGUMENT.  WORK2 CONTAINS THE      12530000
*        PRESENT ENTRY ADDRESS AND WORK3 CONTAINS THE END ADDRESS       12540000
*                                                                       12550000
OBJOFFST L     WORK4,LOADNAMA               MAIN STORAGE LOADED ADDRESS 12560000
         A     WORK4,POFFSET                CREATE WHERE ADDRESS        12570000
         LA    WORK5,N1                     CREATE SMALL ADDRESS        12580000
         SR    WORK1,WORK1                  INDICATE NO CESD ENTRY ADDR 12590000
SEARCH7  CR    WORK2,WORK3                  ANY MORE CESD INFO          12600000
         BL    CHECK7                       YES, GO CHECK THIS ENTRY    12610000
         B     MAYBE7                       NO, GO SEE IF WE FOUND ONE  12620000
CHECK7   MVC   WAREA2+N1(N3),N9(WORK2)      GET LOADED ADDR OF THIS SEC 12630000
         C     WORK4,WAREA2                 IS WHERE ADDR AFTER THIS    12640000
         BNL   FOUND17                      YES, GO CHECK FUTHER        12650000
PTRTONXT LA    WORK2,N12(WORK2)             POINT TO NEXT ENTRY         12661900
         B     SEARCH7                      GO CHECK NEXT ENTRY         12671900
FOUND17  C     WORK5,WAREA2                 IS THIS ADDR AFTER LAST ONE 12681900
         BH    PTRTONXT                     NO, LAST SAVED ONE HIGHER   12691900
         L     WORK5,WAREA2                 YES, GET ITS LOADED ADDR    12705600
         LR    WORK1,WORK2                  POINT TO CLOSEST CSECT ENTY 12712800
         B     PTRTONXT                     GO POINT TO NEXT ONE        12720000
MAYBE7   LTR   WORK1,WORK1                  DID WE FIND ONE             12730000
         BC    N7,FOUND7                    YES, GO MOVE TO ENTRY BLOCK 12740000
         LA    RETCODE,N4                   NO ENTRYNAME FOR OFFSET     12750000
         B     TOCALLER                     NO, ERROR, NO CSECT FOUND   12760000
FOUND7   MVC   ENTRYNAM(N8),N0(WORK1)       ENTRYNAME TO INFO BLK       12770000
         S     WORK5,LOADNAMA               CALCULATE DISPLACEMENT      12780000
         ST    WORK5,ENTRNAMD               DISPLACMENT TO INFO BLOCK   12790000
         OI    MODSWS,V40                   ENTRYNAME DISPLACMENT HERE  12800000
         L     RETURN,CESD14                GET RETURN ADDRESS          12810000
         BR    RETURN                       RETURN                      12820000
         SPACE 3                                                        12830000
*********************************************************************** 12840000
*                                                                     * 12850000
*        THE FOLLOWING SUB-ROUTINES HANDLE SECONDARY STORAGE I/O      * 12860000
*                                                                     * 12870000
*********************************************************************** 12880000
         SPACE 2                                                        12890000
*                                                                       12900000
*        THIS ROUTINE OPENS THE DCB FOR READING SECONDARY STORAGE.      12910000
*        DAIR IS LINKED TO IF IT IS NECESSARY TO ALLOCATE AND OBTAIN    12920000
*        A DDNAME FOR SYS1.LINKLIB                                      12930000
*                                                                       12940000
OPENDCB  ST    RETURN,OPDCB14               SAVE RETURN ADDRESS         12950000
         LA    WORK5,PDSDCB                 ADDR OF DCB IN WORK AREA    12960000
         USING IHADCB,WORK5                 BASE FOR DESCRIPTIVE DSECT  12970000
         TM    MODSWS,V04                   DO WE HAVE A PASSED DDNAME  12980000
         BZ    LINKLIB                      NO, PDS=LINKLIB, GO ALLOCAT 12990000
CHECKDCB TM    DCBOFLGS,V10                 IS DCB OPENED               13000000
         BZ    DOOPEN                       NO, GO OPEN DCB             13010000
         CLC   DDNAME(N8),OPENFDD           IS DCB OPENED FOR PASSED DD 13020000
         BNE   DOCLOSE                      NO, GO DO CLOSE AND OPEN    13030000
OPENDONE L     RETURN,OPDCB14               RESTORE RETURN ADDRESS      13040000
         BR    RETURN                       RETURN TO CALLER            13050000
DOCLOSE  BAL   RETURN,CHECKECB              GO CHECK FOR REQ TO END     13060000
         LA    PARMREG1,CLOSELST            ADDRESS OF CLOSE LIST       13070000
         CLOSE ((WORK5)),MF=(E,(PARMREG1))                              13080000
DOOPEN   DS    0H                                                       13090000
         MVC   DCBDDNAM(N8),DDNAME          OPEN DCB FOR PASSED DDNAME  13100000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ TO END     13110000
         LA    PARMREG1,OPENLIST            ADDRESS OF OPEN LIST        13120000
         OPEN  ((WORK5)),MF=(E,(PARMREG1))                              13130000
PABEND3  EQU   *                            POSSIBLE ABEND RESUME ADDR  13140000
         TM    DCBOFLGS,V10                 WAS DCB OPENED SUCCESSFULLY 13150000
         DROP  WORK5                                                    13160000
SMTOPEN  DS    0H                           SMT TESTCASE LABEL          13170000
*                                            OPEN UNSUCCESSFUL          13180000
*                                            RC FROM SYM IS 8           13190000
*                                            TESTCASE ID  TEQU5400      13200000
*                                            TESTCASE ID  TPCH6300      13210000
         BO    OPENOK                       YES, GO ON                  13220000
         LA    RETCODE,N4                   CANNOT OPEN DCB             13230000
         B     SYSERR                       GO SET UP END AND GIVE MESG 13240000
OPENOK   MVC   OPENFDD(N8),DDNAME           INDICATE DD DCB OPENED FOR  13250000
         B     OPENDONE                     GO BACK AND RETURN TO CALLR 13260000
LINKLIB  TM    SWSC,V80                     IS A DDNAME FOR LINKLIB ON  13270000
         BZ    ALLOC                        NO, GO SET TO ALLOC - DAIR  13280000
         MVC   DDNAME(N8),LINKLBDD          YES, MOVE TO INFO BLOCK     13290000
         OI    MODSWS,V04                   INDICATE WE HAVE A DDNAME   13300000
         B     CHECKDCB                     GO CHECK STATUS OF DCB      13310000
ALLOC    EQU   *                                                        13320000
         GETMAIN   RC,LV=N100,SP=N1         GET PARM BLOCK TO PASS-DAIR 13330000
PABEND2  EQU   *                            POSSIBLE ABEND RESUME ADDR  13340000
         LTR   RETCODE,RETCODE              IS RETURNCODE NON-ZERO      13350000
         BZ    SMTGET01                     IF ZERO, GO SET INDICATOR   13360000
         MVI   WAREA3,N8                    SAVE RETURN CODE            13370000
         LA    WORK2,N10                    GET SVC NUMBER              13380000
         LA    WORK5,N5                     INDICATE TO USE 5TH MACRO   13390000
         SPACE                                                          13400000
DOPRINT1  BAL   RETURN,TERMIO               GO PUT MESG TO TERMINAL     13410000
         SR    RETCODE,RETCODE              CLEAR FOR RETURN CODE       13420000
         IC    RETCODE,WAREA3               RETURN CODE FOR CALLER      13430000
         B     TOCALLER                     RETURN TO CALLER            13440000
SMTGET01 DS    0H                           SMT TESTCASE LABEL          13450000
*                                           GET FAILED-DAIR PARM LIST   13460000
*                                           TESTCASE ID  TTSTC160       13470000
         OI    SWSC,V40                     INDICATE THEIR IS A PARM    13480000
*                                           LIST TO FREE IN THE STAE    13490000
*                                           RETRY RT IF WE ABEND IN     13500000
*                                           DAIR                        13510000
         ST    PARMREG1,ADAIRCOR            SAVE ADDR OF DAIR LIST CORE 13520000
         USING DAPL,PARMREG1                                            13530000
         MVC   DAPLUPT(N4),TSTUPT           POINTER TO UPT FOR DAIR     13540000
         MVC   DAPLECT(N4),TSTECT           POINTER TO ECT FOR DAIR     13550000
         MVC   DAPLECB(N4),TSTCPECB         POINTER TO CP ECB FOR DAIR  13560000
         L     WORK1,TPLPTR                 OBTAIN POINTER TO THE       13570000
         USING TPL,WORK1                     PROTECTED STEP CONTROL     13580000
         MVC   DAPLPSCB(N4),TPLPSCB          BLOCK FOR DAIR             13590000
         DROP  WORK1                                                    13600000
         LA    WORK1,N20(PARMREG1)          ADDR OF DAIR LIST FOR X'08' 13610000
         ST    WORK1,DAPLDAPB               INTO STANDARD LIST FOR DAIR 13620000
         DROP  PARMREG1                                                 13630000
         USING DAPB08,WORK1                                             13640000
         LA    WORK2,N8                     DAIR REQ TYPE IS X'08'      13650000
         STH   WORK2,DA08CD                 PUT IN DAIR PARM LIST       13660000
         SR    WORK2,WORK2                  CLEAR REG TO ZEROES         13670000
         STH   WORK2,DA08FLG                FLAGS - ZERO                13680000
         ST    WORK2,DA08DARC               ERROR CODES - ZERO          13690000
         LA    WORK2,LINKPDS                ADDR OF DS NAME - LINKLIB   13700000
         ST    WORK2,DA08PDSN               INTO DAIR PARM LIST         13710000
         MVC   DA08DDN(N4),BLANKS           DDNAME IS BLANK             13720000
         MVC   DA08UNIT(N4),BLANKS          UNIT IS BLANK               13730000
         MVC   DA08SER(N4),BLANKS           VOL SER IS BLANK            13740000
         LA    WORK2,N256                   BLOCKSIZE IS 256            13750000
         ST    WORK2,DA08BLK                INTO DAIR LIST              13760000
         XC    DA08PQTY(N12),DA08PQTY       DASD SPACE REQ IS ZERO      13770000
         MVC   DA08MNM(N4),BLANKS           MEMBER NAME IS BLANKS       13780000
         MVC   DA08PSWD(N4),BLANKS          PASSWORD IS BLANK           13790000
         MVI   DA08DSP1,DA08SHR             DISP1 FIELD SET TO SHR      13800000
         MVI   DA08DPS2,DA08KEEP            DISP2 FIELD SET TO KEEP     13810000
         MVI   DA08DPS3,DA08KEP             DISP3 FIELD SET TO KEEP     13820000
         MVI   DA08CTL,V00                  CONTROL FIELD SET TO ZERO   13830000
         LA    RETURN,ALLOCOK               IF LINK FAILS GO TO ALLOCOK 13840000
         LINK  EP=IKJDAIR,ERRET=LINKERR1    GO TO DAIR                  13850000
PABEND4  EQU   *                            POSSIBLE ABEND RESUME ADDR  13860000
         B     SMTDAIR                      SKIP LINK ERROR ROUTINE     13870000
LINKERR1 EQU   *                                                        13880000
         LA    WORK5,N6                     USE 6TH FORM OF MACRO       13890000
         LA    WORK2,N6                     SET SVC #                   13900000
         MVI   WAREA3,N8                    SAVE RETURN CODE            13910000
         LR    PARMREG0,PARMREG1            SHIFT ABEND CODE TO REG0    13920000
         B     DOPRINT1                     GO PRINT MSG                13930000
SMTDAIR  DS    0H                           SMT TESTCASE LABEL          13940000
*                                            LINK TO DAIR FAILED        13950000
*                                            TESTCASE ID  TTSTC160      13960000
         LR    WORK4,RETCODE                SAVE DAIR RETURN CODE       13970000
         LTR   PARMREG0,RETCODE             WAS DAIR SUCCESSFUL         13980000
         BZ    ALLOCOK                      YES, GO GET DDNAME          13990000
         B     DAIRFAIL                     NO, GO PRINT MSG            14000000
ALLOCOK  EQU   *                                                        14010000
         MVC   LINKLBDD(N8),DA08DDN         GET LINKLIB DD OR BLANKS    14020000
         DROP  WORK1                                                    14030000
         FREEMAIN  RC,LV=N100,A=(PARMREG1),SP=N1                        14040000
         LTR   RETCODE,RETCODE              WAS RETURN CODE ZERO        14050000
         BZ    TURNOFF2                     YES, TURNOFF PARM LIST SW   14060000
         LA    WORK2,N120                   INDICATE SVC NUMBER         14070000
         MVI   WAREA3,N8                    SAVE RETURN CODE            14080000
         LA    WORK5,N5                     USE 1ST FORM OF SVCERR MAC  14090000
         B     DOPRINT1                     GO ISSUE ERROR MESSAGE      14100000
TURNOFF2 NI    SWSC,VBF                     TURN PARM LIST GOT SW OFF   14110000
         LTR   PARMREG0,WORK4               DID WE ALLOC LINKLIB        14120000
         BZ    ALLOCOK1                     YES, GO EXTRACT DDNAME      14130000
         BAL   RETURN,TERMIO                GO PUT MESG OUT             14140000
CODE8    LA    RETCODE,N8                   RC=8 FOR CALLER             14150000
         B     TOCALLER                     GO RETURN TO CALLER         14160000
ALLOCOK1 EQU   *                                                        14170000
         MVC   DDNAME(N8),LINKLBDD          MOVE IT TO INFO BLOCK       14180000
         OI    MODSWS,V04                   INDICATE DDNAME PRESENT     14190000
         OI    SWSC,V80                     WE HAVE A DDNAME FOR LINKLB 14200000
         B     CHECKDCB                     GO CHECK STATUS OF DCB      14210000
*                                                                       14220000
*        THIS ROUTINE PERFORMS A POINT TO THE LOADNAME INFO IN THE PDS  14230000
*                                                                       14240000
DOPOINT  ST    RETURN,POINT14               SAVE RETURN ADDRESS         14250000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ FOR END    14260000
         FIND  (PARMREG1),(PARMREG0),C                                  14270000
         L     RETURN,POINT14               RETURN ADDRESS              14280000
         BR    RETURN                       RETURN TO CALLER            14290000
*                                                                       14300000
*        THIS ROUTINE READS SECONDARY STORAGE                           14310000
*                                                                       14320000
DOREAD   ST    RETURN,READ14                SAVE RETURN ADDRESS         14330000
         LA    WORK4,LSTFREAD               ADDR OF DECB FOR E FORM     14340000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ FOR END    14350000
         LA    WORK3,BUFFER                 ADDRESS OF INPUT BUFFER     14360000
         LA    WORK5,PDSDCB                 ADDRESS OF DCB              14370000
         READ  (WORK4),SF,(WORK5),(WORK3),,,MF=E                        14380000
         CHECK (WORK4)                                                  14390000
         L     RETURN,READ14                GET RETURN ADDRESS          14400000
         BR    RETURN                       RETURN TO CALLER            14410000
*                                                                       14420000
*        THIS ROUTINE WILL ISSUE A NOTE FOR THE LAST RECORD READ        14430000
*                                                                       14440000
DONOTE   ST    RETURN,NOTE14                SAVE RETURN ADDRESS         14450000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ TO END     14460000
         NOTE  (PARMREG1)                                               14470000
         L     RETURN,NOTE14                GET RETURN ADDR             14480000
         BR    RETURN                       RETURN TO CALLER            14490000
         SPACE 3                                                        14500000
*********************************************************************** 14510000
*                                                                     * 14520000
*        THESE ROUTINES PERFORM LINKAGE TO THE SECOND SECTION OF SYM  * 14530000
*                                                                     * 14540000
*********************************************************************** 14550000
         SPACE 2                                                        14560000
DAIRFAIL EQU   *                                                        14570000
         LA    PARMREG1,N20                 FIFTH ROUTINE IN 2ND SEC    14580000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14590000
PRINT2   EQU   *                                                        14600000
         LR    RETURN,WORK1                 PRESERVE REG WORK1          14610000
         LA    PARMREG1,N16                 FORTH ROUTINE IN 2ND SEC    14620000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14630000
FOUNDSYM EQU   *                                                        14640000
         LA    PARMREG1,N12                 FORTH ROUTINE IN 2ND SEC    14650000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14660000
SYSERR   EQU   *                                                        14670000
         LA    PARMREG1,N8                  THIRD ROUTINE IN 2ND SEC    14680000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14690000
NOFIND   EQU   *                                                        14700000
         LA    PARMREG1,N4                  SECOND ROUTINE IN 2ND SEC   14710000
         B     GOTO2SEC                     GO SET FOR 2ND SECTION      14720000
FIRSTENT EQU   *                                                        14730000
         SR    PARMREG1,PARMREG1            FIRST ROUTINE IN 2ND SEC    14740000
GOTO2SEC L     WORK1,SECENTRY               ADDR OF ENTRY TO 2ND        14750000
         BR    WORK1                        GO TO SECOND CSECT          14760000
         SPACE 3                                                        14770000
*********************************************************************** 14780000
*                                                                     * 14790000
*        CONSTANTS                                                    * 14800000
*                                                                     * 14810000
*********************************************************************** 14820000
         SPACE 2                                                        14830000
DEFAULTM DC    X'000001'                    DEFAULT MULTIPLICITY VALUE  14840000
WLENRCD  DC    C'WRNG.LEN.RECORD'           SYNADAF MESSAGE FOR WRONG   14850000
*                                            LENGTH RECORD              14860000
CCWLENFD DC    H'7'                         CCW LENGTH FIELD            14870000
DEFLENFD DC    H'0'                         DEFAULT LENGTH FIELD        14880000
LINKPDS  DC    H'12'                        LENGTH AND NAME OF LINKLIB  14890000
         DC    C'SYS1.LINKLIB'              FOR DAIR PARM LIST          14900000
SECENTRY DC    A(IKJEGMYS)                  ADDRESS OF SECOND CSECT     14910000
MOVEINST MVC   N0(N1,WORK2),N0(WORK3)       TARGET OF EX INSTR          14920000
RETRYADR DC    AL3(STAERTRY)                ADDR OF STAE RETRY ROUTINE  14930000
BLANKS   DC    8C' '                        BLANKS FOR CLEARING AREAS   14940000
NO2NDMSG DC    X'FF000000'                  RC NOT 0, NO 2ND LEV MSG IN 14950000
ABENDTAB DS    0F                           ABEND IC TABLE FOR STAE     14960000
         DC    X'5C'                        NO CORE CODE                14970000
         DC    AL3(PABEND1)                 RESUME IC AFTER GETMAIN     14980000
         DC    X'5C'                        NO CORE CODE                14990000
         DC    AL3(PABEND2)                 RESUME IC AFTER GETMAIN     15000000
         DC    X'60'                        OPEN FAILED CODE            15010000
         DC    AL3(PABEND3)                 RESUME IC AFTER OPEN        15020000
         DC    X'60'                        LINK FAILED CODE            15030000
         DC    AL3(PABEND4)                 RESUME IC AFTER LINK        15040000
         DC    X'FF'                        END OF ABEND IC TABLE       15050000
         SPACE 1                                                        15060000
LIST     IKJEGSPL RTRY=STAERTRY,ABNTB=ABENDTAB,MODNM=IKJEGSYM,TNM=SYM   15070000
         SPACE 1                                                        15080000
SUPERZAP DC    50CL1'Z'                     PATCH AREA                  15090000
         EJECT                                                          15100000
IKJEGMYS CSECT                                                          15110000
*                                                                       15120000
*                                                                       15130000
         LR    SYMB2,WORK1                  ADDRESSABILITY              15140000
         USING IKJEGMYS,SYMB2                IKJEGMYS CSECT             15150000
         B     BTABLE(PARMREG1)             GO TO DESIRED ROUTINE       15160000
BTABLE   B     FIRSTIME                     FIRST TIME ROUTINE          15170000
         B     NOTFOUND                     UNRESOLVED SYMBOL ROUTINE   15180000
         B     NOTABLE                      CANNOT PROCESS SYMS ROUTINE 15190000
         B     BUILDSIB                     BUILD SYMINFO BLK ROUTINE   15200000
         B     PRINT3                       GO PRINT A MESSAGE          15210000
         B     DAIRERR                      GO DAIR ERROR ANALYSIS RTN  15220000
         SPACE 3                                                        15230000
*********************************************************************** 15240000
*                                                                     * 15250000
*        THIS SUB-ROUTINE PERFORMS FIRST TIME INITILIZATION.          * 15260000
*        A WORK AREA IS GOTTEN AND INITILIZED.                        * 15270000
*                                                                     * 15280000
*********************************************************************** 15290000
         SPACE 2                                                        15300000
FIRSTIME EQU   *                                                        15310000
         GETMAIN   RC,LV=N72,SP=N1          GET A TEMPORARY SAVE AREA   15320000
         LTR   RETCODE,RETCODE              IS RETURN CODE ZERO         15330000
         BZ    SMTGET02                     IF SO, GO TO SMTGET02       15340000
         LA    RETURN,RC4                   SET RETURN ADDRESS          15350000
         LA    WORK5,N5                     USE SECOND FORM OF MACRO    15360000
         LA    WORK2,N10                    SET SVC NUMBER              15370000
         LA    WORK4,N8                     SET RETURN CODE             15380000
         MVI   WAREA3,N8                    SAVE RETRUN CODE            15390000
         B     DOPRINT                      GO ISSUE ERROR MSG          15400000
SMTGET02 DS    0H                           SMT TESTCASE LABEL          15410000
*                                            GET FAILED-TEMP SAVE AREA  15420000
*                                            TESTCASE ID  TTSTC160      15430000
         LR    WORK5,PARMREG1               ADDRESS OF GOTTEN CORE      15440000
         L     WORK1,WORKAREA               ADDR OF GENERAL CMD WKAREA  15450000
         USING TSTCWORK,WORK1               BASE FOR DESCRIPTIVE DSECT  15460000
         LA    WORK2,CWORKSYM               ADDR OF SYM PART OF WKAREA  15470000
         MVC   N4(N12,WORK2),LFGET          LIST FORM OF GET TO WKAREA  15480000
         LA    PARMREG1,N4(WORK2)           ADDR OF LIST FORM FOR GET   15490000
         GETMAIN   EC,LV=N800,A=(WORK2),SP=N1,MF=(E,(PARMREG1))         15500000
         LTR   RETCODE,RETCODE              DID WE GET THE CORE         15512000
SMTGET03 DS    0H                           SMT TESTCASE LABEL          15521000
*                                            INSUFFICIENT CORE FOR WORK 15530000
*                                            AREA-RC FROM SYM IS 4      15539000
*                                            TESTCASE ID  TTSTC160      15548000
         BZ    GETOK                        YES, GO CONTINUE PROCESSING 15560000
*                                                                       15570000
*        SETUP TO GIVE INSUFFICIENT MAIN STORAGE MESSAGE                15580000
*                                                                       15590000
         ST    SYMWKB,N4(WORK5)              TO PUT OUT INSUFFICIENT    15600000
         LR    SYMWKB,WORK5                  STORAGE MESSAGE            15610000
         SR    WORK5,WORK5                  CLEAR REG FOR LATER USE     15620000
         TM    TSTFLGS3,SYMMESG             SHOULD WE PRINT A MESSAGE   15630000
         BO    FREECORE                     NO, GO FREE TEMP SAVE AREA  15640000
         ST    WORK5,N8(SYMWKB)             USE TEMPORARY SAVE AREA     15650000
         L     WORK6,NOCOREMG               ADDRESS OF NO CORE MESSAGE  15660000
         LA    WORK5,N5                     USE FOURTH FORM OF MACRO    15670000
         LA    WORK2,N10                    SET SVC NUMBER              15680000
         MVI   WAREA3,N8                    SAVE RETURN CODE            15690000
         BAL   RETURN,DOPRINT               GO ISSUE ERROR MSG          15700000
         LR    WORK5,RETCODE                SAVE RETCODE FROM I/O       15710000
FREECORE EQU   *                                                        15720000
         LR    WORK3,SYMWKB                 ADDR OF TEMP SAVE TO FREE   15730000
         L     SYMWKB,N4(SYMWKB)            ADDR OF CALLERS SAVE AREA   15740000
         FREEMAIN  RC,LV=N72,A=(WORK3),SP=N1 FREE TEMPORARY SAVE AREA   15750000
*  THERE IS NO REASON TO CHECK RETURN CODE HERE SINCE WE ARE ON OUR     15760000
* WAY OUT BECAUSE OF ERROR IN GETMAIN ABOVE                             15770000
         LTR   WORK5,WORK5                  WAS I/O SUCCESSFUL          15780000
         BZ    RC4                          YES, GO GIVE RETURN CODE 4  15790000
         LR    RETCODE,WORK5                NO, PASS BACK I/O RET CODE  15800000
         B     TOCALL                       GO RETURN TO CALLER         15810000
RC4      EQU   *                                                        15820000
         LA    RETCODE,N4                   NO CORE RETURN CODE IS 4    15830000
         B     TOCALL                       GO RETURN TO CALLER         15840000
*                                                                       15850000
*        INITILIZE WORK AREA                                            15860000
*                                                                       15874000
GETOK    EQU   *                                                        15883000
         FREEMAIN  RC,LV=N72,A=(WORK5),SP=N1 FREE TEMPORARY SAVE AREA   15892000
         LTR   RETCODE,RETCODE              IS RETURN CODE ZERO         15901000
         BZ    GETADDR                      IF SO, GET ADDRESS OF CORE  15910000
         LA    WORK5,N5                     USE FIFTH FORM OF MACRO     15919000
         LA    WORK2,N120                   GET SVC NUMBER              15928000
         BAL   RETURN,TERMIO                GO PRINT MSG                15937000
         LA    RETCODE,N8                   SET RETURN CODE TO 8        15946000
         B     TOCALLER                     RETURN                      15955000
GETADDR  EQU   *                                                        15964000
         L     WORK5,CWORKSYM               ADDRESS OF GOTTEN CORE      15973000
         DROP  WORK1                                                    15982000
         ST    WORK5,N8(SYMWKB)             MYSAVE ADDR IN CALLERS AREA 15991000
         ST    SYMWKB,N4(WORK5)             HIS SAVE ADDR IN MY AREA    16000000
         LR    SYMWKB,WORK5                 MY SAVE ADDR IN PROPER REG  16009000
         ST    SYMWKB,TSTSYMWK              WKAREA ADDR INTO TCOMTAB    16018000
         MVC   STAELIST(LENSTAE),LFSTAE  ESTAE LIST FORM  TO WKAREA     16040000
         MVC   OPENLIST(N8),LFOPEN          OPEN LIST TO THE WORK AREA  16050000
         MVC   CLOSELST(N8),LFCLOSE         CLOSE LIST TO THE WORK AREA 16060000
         MVC   LSTFREAD(N24),SSDECB         LIST FORM READ TO WORK AREA 16070000
         MVC   PDSDCB(N88),BPAMDCB          MOVE DCB TO WORK AREA       16080000
         LA    WORK1,PDSDCB                 ADDR OF DCB                 16090000
         ST    WORK1,PDSDCBA                INTO ADDR PART OF WORK AREA 16100000
         LA    WORK1,CINFOBLK               ADDR OF CURRENT INFO BLOCK  16110000
         ST    WORK1,CINFOBKA               INTO ADDR PART OF WORK AREA 16120000
         LA    WORK1,TINFOBLK               ADDR OF TEMP INFO BLOCK     16130000
         ST    WORK1,TINFOBKA               INTO ADDR PART OF WORK AREA 16140000
         LA    WORK1,BUFFER                 ADDR OF BUFFER              16150000
         ST    WORK1,BUFFERA                INTO ADDR PART OF WORK AREA 16160000
         LA    INFOBLKB,CINFOBLK            ADDR OF WORK AREA TO CLEAR  16170000
         MVI   CINFOBLK,V40                 BLANK TO CURR INFO BLK AREA 16180000
         MVC   CINFOBLK+N1(N23),CINFOBLK    BLANK CHAR INFO             16190000
         XC    LOADNAMA(N32),LOADNAMA       ZERO OUT OUT DATA           16200000
         XC    WHATPASS(N4),WHATPASS        SET ALL SWITCHES TO ZEROES  16210000
         B     IKJEGBEG                     GO BACK TO MAIN STREAM IN   16220000
*                                            FIRST SECTION              16230000
         SPACE 2                                                        16240000
*********************************************************************** 16250000
*                                                                     * 16260000
*        SYMBOL FOUND, BUILD ANSWER BLOCK, RET CODE= ZERO, RETURN     * 16270000
*        WORK3 POINTS TO FOUND SYMBOL                                 * 16280000
*        IF THE SYMBOL WAS FOUND IN A DSECT, THE DSECT NAME WILL BE   * 16290000
*        IN WAREA1                                                    * 16300000
*                                                                     * 16310000
*********************************************************************** 16320000
         SPACE 2                                                        16330000
BUILDSIB EQU   *                                                        16340000
         GETMAIN   RC,LV=N16,SP=N1           GET A SYMINFO ANSWER BLOCK 16350000
PABEND1  EQU   *                            POSSIBLE ABEND RESUME ADDR  16360000
         LTR   RETCODE,RETCODE              IS RETURN CODE ZERO         16370000
         BZ    SMTGET04                     IF SO, GO TO SMTGET04       16380000
         LA    WORK5,N5                     USE 5TH FJORM OF MACRO      16390000
         LA    WORK2,N10                    SET SVC #                   16400000
         BAL   RETURN,TERMIO                GO PRINT MSG                16410000
         LA    RETCODE,N8                   SET RETURN CODE             16420000
         B     TOCALLER                     RETURN TO CALLER            16430000
SMTGET04 DS    0H                           SMT TESTCASE LABEL          16440000
*                                            GET FAILED-SYMINFO BLK-SIB 16450000
*                                            TESTCASE ID  TTSTC160      16460000
         LA    WORK2,N0(PARMREG1)           ADDR OF GOTTEN CORE         16470000
         LA    WORK1,N1                     CREATE 'OR' REG TO SET HIGH 16480000
         SLL   WORK1,N31                     ORDER BIT ON               16490000
         OR    WORK2,WORK1                  INDICATE POINTER TO ANSW BK 16500000
         ST    WORK2,PDEUSER                RETURN IT TO CALLER IN PDE  16510000
         LA    WORK2,N0(WORK2)              CLEAR HIGH ORDER BYTE       16520000
         SR    PARMREG1,PARMREG1            CLEAR REGISTER              16530000
         ST    PARMREG1,N12(WORK2)          LAST BLOCK POINTER IS ZERO  16540000
         L     WORK1,SICHAIN                HEAD OF ANSWER BLOCK CHAIN  16554700
         LTR   WORK1,WORK1                  IS THEIR A CHAIN            16560000
         BC    N7,SEARCH9                   YES, GO SEARCH FOR LAST ONE 16570000
         ST    WORK2,SICHAIN                NO, START CHAIN             16580000
         B     GOTBLK                       GO FILL IN ANSWER BLOCK     16590000
SEARCH9  C     PARMREG1,N12(WORK1)          IS IT END OF CHAIN          16600000
         BE    FOUND9                       YES, GO ADD TO CHAIN        16610000
         L     WORK1,N12(WORK1)             NO, POINT TO NEXT BLOCK     16620000
         B     SEARCH9                      GO CHECK FOR END OF CHAIN   16630000
FOUND9   ST    WORK2,N12(WORK1)             LAST BLOCK POINTS TO NEW 1  16640000
         USING SYMINFO,WORK2                BASE FOR DESCRIPTIVE DSECT  16650000
GOTBLK   LTR   WORK3,WORK3                  WHERE WAS SYMBOL FOUND      16660000
         BP    SYMRCD                       IN A SYM RCD ON SEC STORAGE 16670000
         LPR   WORK3,WORK3                  ADDR OF INCORE SYMBOL       16680000
         USING INCORE,WORK3                 BASE FOR INCORE SYMTAB DSEC 16690000
         MVC   ZERO1(N10),ZERO2             INCORE SYM INFO-SYMINFO BLK 16700000
         DROP  WORK3                                                    16710000
         SR    RETCODE,RETCODE              RET CODE EQUAL ZERO         16720000
         B     TOCALLER                     GO BACK TO RET TO CALLER    16730000
*                                                                       16740000
SYMRCD   TM    SWSA,V20                     WAS SYMBOL FOUND IN A DSECT 16750000
         BZ    GOODSYM                      NO, USE BASE FOR SYMS       16760000
         STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               16770000
         BAL   RETURN,DSECTIN               GO SEARCH INCORE SYMS-DSECT 16780000
         LTR   RETCODE,RETCODE              WAS THE DSECT FOUND         16790000
         BZ    FOUNDD                       YES, GO EXTRACT ADDR        16800000
         LA    RETCODE,N28                  UNRESOLVED, 2ND LEV MESG 28 16810000
         B     NOFIND                       NO, ERROR CANNOT RESOLVE    16820000
FOUNDD   LPR   WORK3,WORK3                  ADDR OF ADDR BASE FOR DSECT 16830000
         L     WORK4,N4(WORK3)              BASE FOR SYMBOL             16840000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            16850000
         B     DSECTIN2                     GO FILL IN ANSWER BLOCK     16860000
GOODSYM  L     WORK4,BASEFSYM               BASE FOR SYMBOLS            16870000
DSECTIN2 MVC   WAREA2+N1(N3),N1(WORK3)      ALIGN SYMBOL DISPL          16880000
         L     WORK5,WAREA2                 SYM DISPLACEMENT            16890000
         LA    WORK5,N0(WORK5)              SYM DISP FOR ADDING         16900000
         AR    WORK4,WORK5                  LOADED ADDR OF SYMBOL       16910000
         ST    WORK4,ZERO1                  RETURN IN SYMINFO ANSWER BK 16920000
         SR    WORK1,WORK1                  CLEAR REG FOR IC INSTR      16930000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION TYPE BYTE  16940000
         LA    WORK4,N15                    CREATE 'AND' BYTE           16950000
         NR    WORK1,WORK4                  LENGTH OF NAME-1            16960000
         LA    WORK1,N5(WORK1,WORK3)        ADDR OF DATA TYPE FIELD     16970000
         MVC   TYPE(N1),N0(WORK1)           DATA TYPE TO ANSWER BLOCK   16980000
         CLI   N0(WORK1),V08                DATA TYPE TELLS LEN FIELD   16990000
         BH    LEN1BYTE                     LENGTH FIELD-1 BYTE LONG    17000000
         MVC   LENGTH(N2),N1(WORK1)         2 BYTE LEN FIELD TO ANS BLK 17010000
         LH    WORK5,LENGTH                 LENGTH-1 OF SYMBOL'S CORE   17020000
         LA    WORK5,N1(WORK5)              LENGTH OF RESERVED M.S.     17030000
         STH   WORK5,LENGTH                 LEN TO ANSWER BLOCK         17040000
         LA    WORK1,N3(WORK1)              ADDR OF MULITIPLICITY FIELD 17050000
         B     CHECKM                       GO CHECK FOR MULITIPLICITY  17060000
LEN1BYTE SR    WORK5,WORK5                  CLEAR REGISTER              17070000
         IC    WORK5,N1(WORK1)              GET 1 BYTE LENGTH FIELD     17080000
         LA    WORK5,N1(WORK5)              LEN OF RESERVED CORE        17090000
         STH   WORK5,LENGTH                 LEN FIELD TO ANSWER BLOCK   17100000
         LA    WORK1,N2(WORK1)              ADDR OF MULTIPLICITY FIELD  17110000
CHECKM   TM    N0(WORK3),V40                IS MULTIPLICITY PRESENT     17120000
         BZ    NOM                          NO, GO GET DEFAULT          17130000
         MVC   MULTIPLT(N3),N0(WORK1)       MULTIPLICITY TO ANSWER BLK  17140000
         B     BUILTBLK                     ANSWER BLK BUILT, GO ON     17150000
NOM      EQU   *                                                        17160000
         MVC   MULTIPLT(N3),DEFAULTM        MOVE 1 TO ANSWER BLOCK      17170000
BUILTBLK SR    RETCODE,RETCODE              RETCODE = ZERO              17180000
         B     TOCALLER                     GO RETURN TO CALLER         17190000
         DROP  WORK2                                                    17200000
         SPACE 2                                                        17210000
*********************************************************************** 17220000
*                                                                     * 17230000
*        THIS ROUTINE RETURNS TO THE CALLER WHEN NOT ABLE TO RESOLVE  * 17240000
*        A REQUEST.  ERROR MESSAGES ARE PRINTED IF                    * 17250000
*                  SYMMESG SWITCH, EGUATED TO B'00100000', IN THE     * 17260000
*                  TSTFLGS3 FIELD OF TCOMTAB DSECT IS OFF             * 17270000
*                                                                     * 17280000
*********************************************************************** 17290000
         SPACE 2                                                        17300000
*                                                                       17310000
*        MESSAGE   IKJ57280I                                            17320000
*                                                                       17330000
NOTFOUND EQU   *                                                        17340000
         BAL   RETURN,MSGRT1                GO SET UP FOR MESSAGES      17350000
*                                                                       17360000
*        SECOND LEVEL FOR IKJ57280I                                     17370000
*                                                                       17380000
         B     M0GETSEC(WORK5)              GO GET PROPER SECOND LEVEL  17390000
M0GETSEC B     CODEONLY                     GO GIVE RETCODE ONLY        17400000
         B     NOFIND04                     ERROR CODE 04, MESG M0L2A   17410000
         B     NOFIND08                     ERROR CODE 08, MESG M0L2B   17420000
         B     NOFIND12                     ERROR CODE 12, MESG M0L2C   17430000
         B     NOFIND16                     ERROR CODE 16, MESG M0L2D   17440000
         B     NOFIND20                     ERROR CODE 20, MESG M0L2E   17450000
         B     NOFIND24                     ERROR CODE 24, MESG M0L2F   17460000
         B     NOFIND28                     ERROR CODE 28, MESG M0L2G   17470000
         B     NOFIND32                     ERROR CODE 32, MESG M0L2H   17480000
         B     NOFIND36                     ERROR CODE 36, MESG M0L2I   17490000
         B     NOFIND40                     ERROR CODE 40, MESG M0L2J   17500000
         B     NOFIND44                     ERROR CODE 44, MESG M0L2K   17510000
         SPACE                                                          17520000
**********************************************************************  17530000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          17540000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2AP1)        17550000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        17560000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          17570000
**********************************************************************  17580000
NOFIND04 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 17590000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          17600000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      17610000
         L     WORK2,M0L2AP1                ID # OF SECOND LEVEL MESG   17620000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    17630000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     17640000
         B     DOPRINT                      GO PRINT MESSAGE            17650000
         SPACE                                                          17660000
**********************************************************************  17670000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME       *  17680000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (MOL2BP1)     *  17690000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE     *  17700000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          17710000
**********************************************************************  17720000
**********************************************************************  17730000
NOFIND08 DS    0H                                                       17740000
         MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 17750000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          17760000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      17770000
         L     WORK2,M0L2BP1                ID # OF SECOND LEVEL MESG   17780000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    17790000
         LA    WORK5,N1                     USI FIRST FORM OF MACRO     17800000
         B     DOPRINT                      GO PRINT MESSAGE            17810000
         SPACE                                                          17820000
**********************************************************************  17830000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME       *  17840000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (MOS2CP1)     *  17850000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO TO USE              *  17860000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          17870000
**********************************************************************  17880000
**********************************************************************  17890000
NOFIND12 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 17900000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          17910000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      17920000
         L     WORK2,M0L2CP1                GET SECOND LEVEL MESG  ID # 17930000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG  ID #  17940000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     17950000
         B     DOPRINT                      GO PRINT MESSAGE            17960000
         SPACE                                                          17970000
**********************************************************************  17980000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          17990000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2DP1)        18000000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO TO USE                 18010000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18020000
**********************************************************************  18030000
NOFIND16 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18040000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          18050000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18060000
         L     WORK2,M0L2DP1      GET SECOND LEVEL MSG ID # @ZA*****    18070000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     18080000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG ID #   18090000
         B     DOPRINT                      GO PRINT MESSAGE            18100000
         SPACE                                                          18110000
**********************************************************************  18120000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          18130000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (MOL2EP1)        18140000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        18150000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18160000
**********************************************************************  18170000
**********************************************************************  18180000
NOFIND20 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18190000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          18200000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18210000
         L     WORK2,M0L2EP1                GET SECOND LEVEL MESG ID #  18220000
         LA    WORK5,N1                     USE FIRST FJORM OF MACRO    18230000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG ID #   18240000
         B     DOPRINT                      GO PRINT MESSAGE            18250000
         SPACE                                                          18260000
**********************************************************************  18270000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE PSYMBOL           18280000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2FP1)        18290000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          18300000
*  WORK4 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          18310000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        18320000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18330000
**********************************************************************  18340000
NOFIND24 DS    0H                                                       18350000
         LR    WORK3,WORK1                  GET POINTER TO WORKAREA     18360000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18370000
         MVC   N4(N8,WORK3),LOADNAME        LOADNAME TO INSERT          18380000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18390000
         LA    WORK1,N13(WORK3)             GET POINTER TO NEXT INSERT  18400000
         MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18410000
         MVC   N4(N8,WORK1),PSYMBOL         PSYMBOL TO INSERT           18420000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18430000
         LA    WORK4,N13(WORK1)             GET POINTER TO NEXT INSERT  18440000
         MVC   N0(N4,WORK4),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18450000
         MVC   N4(N8,WORK4),ENTRYNAM        PSYMBOL TO INSERT           18460000
         MVI   N12(WORK4),V40               BLANK AT END OF INSERT      18470000
         L     WORK2,M0L2FP1                GETSECOND LEVEL MESG ID #   18480000
         LA    WORK5,N3                     USE THIRD FORM OF MACRO     18490000
         L     WORK2,M0L2FP1                GETSECOND LEVEL MESG ID #   18500000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG ID #   18510000
         B     DOPRINT                      GO PRINT MESSAGE            18520000
         SPACE                                                          18530000
**********************************************************************  18540000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE PSYMBOL           18550000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2FP1)        18560000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE DSECT NAME        18570000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        18580000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18590000
**********************************************************************  18600000
NOFIND28 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18610000
         MVC   N4(N8,WORK1),PSYMBOL         PSYMBOL TO INSERT           18620000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18630000
         LA    WORK3,N13(WORK1)             NEXT INSERT POSITION        18640000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18650000
         MVC   N4(N8,WORK3),WAREA1          DSECT NAME TO INSERT        18660000
         MVI   N12(WORK3),V40               BLANK AT END OF INSERT      18670000
         L     WORK2,M0L2GP2                ID # OF SECOND LEVEL MESG   18680000
         LA    WORK5,N2                     USE SECOND FORM OF MACRO    18690000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    18700000
         B     DOPRINT                      GO PRINT MESSAGE            18710000
         SPACE                                                          18720000
**********************************************************************  18730000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          18740000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2HP1)        18750000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          18760000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO IKJEGSIO TO USE        18770000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18780000
**********************************************************************  18790000
NOFIND32 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18800000
         MVC   N4(N8,WORK1),ENTRYNAM        ENTRYNAM TO INSERT          18810000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18820000
         LA    WORK3,N13(WORK1)             NEXT INSERT POSITION        18830000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18840000
         MVC   N4(N8,WORK3),LOADNAME        LOADNAME TO INSERT          18850000
         MVI   N12(WORK3),V40               BLANK AT END OF INSERT      18860000
         L     WORK2,M0L2HP1                ID OF SECOND LEVEL MESG     18870000
         LA    WORK5,N2                     USE SECOND FORM OF MACRO    18880000
         L     WORK6,M0L1P1                 ID OF FIRST LEVEL MESG      18890000
         B     DOPRINT                      GO PRINT MESSAGE            18900000
         SPACE                                                          18910000
**********************************************************************  18920000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          18930000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2IP1)        18940000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO, IKJEGSIO, TO USE      18950000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18960000
**********************************************************************  18970000
NOFIND36 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18980000
         MVC   N4(N8,WORK1),ENTRYNAM        ENTRYNAM TO INSERT          18990000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19000000
         L     WORK2,M0L2IP1                ID # OF SECOND LEVEL MESG   19010000
         LA    WORK5,N1                     USE FIRTST FORM OF MACRO    19020000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    19030000
         B     DOPRINT                      GO PRINT MESSAGE            19040000
         SPACE                                                          19050000
**********************************************************************  19060000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          19070000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2JP1)        19080000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          19090000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO IKJEGSIO TO USE        19100000
*  WORK6 - WILL CONTAIN THE FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)      19110000
**********************************************************************  19120000
NOFIND40 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 19130000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          19140000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19150000
         LA    WORK3,N13(WORK1)             NEXT INSERT POSITION        19160000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 19170000
         MVC   N4(N8,WORK3),ENTRYNAM        ENTRYNAM TO INSERT          19180000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19190000
         L     WORK2,M0L2JP1                ID # OF SECOND LEVEL MESG   19200000
         LA    WORK5,N2                     USE SECOND FORM OF MACRO    19210000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    19220000
         B     DOPRINT                      GO PRINT MESSAGE            19230000
         SPACE                                                          19240000
**********************************************************************  19250000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          19260000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2KP1)        19270000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO, IKJEGSIO, TO USE      19280000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          19290000
**********************************************************************  19300000
NOFIND44 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 19310000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          19320000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19330000
         L     WORK2,M0L2KP1                ID # OF SECOND LEVEL MESG   19340000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     19350000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    19360000
         B     DOPRINT                      GO PRINT MESSAGE            19370000
*                                                                       19380000
*        MESSAGE   IKJ57281I                                            19390000
*                                                                       19400000
         SPACE                                                          19410000
**********************************************************************  19420000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M2L2AP1)        19430000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        19440000
*  WORK6 - WILL CONTAIN FISRT LEVEL MESSAGE ID NUMBER (M1L211)          19450000
**********************************************************************  19460000
NOTABLE  EQU   *                                                        19470000
         BAL   RETURN,MSGRT1                GO SET UP FOR MESSAGES      19480000
         L     WORK2,M1L2BP1                ID # OF 2ND LEVEL MESSAGE   19490000
         L     WORK6,M1L1P1                 ID # OF 1ST LEVEL MESSAGE   19500000
*                                                                       19510000
*        SECOND LEVEL FOR IKJ57281I                                     19520000
*                                                                       19530000
         B     M1GETSEC(WORK5)              GO GET PROPER SECOND LEVEL  19540000
M1GETSEC B     CODEONLY                     GO GIVE RET CODE ONLY       19550000
         B     SYSERR04                     ERROR CODE 04, MESG M1L2B   19560000
         SPACE                                                          19570000
**********************************************************************  19580000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE DDNAME            19590000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (PRESET)         19600000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO, IKJEGSIO, TO USE      19610000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          19620000
**********************************************************************  19630000
SYSERR04 MVC   N0(N4,WORK1),INSRTLEN        INSERT LENGTH INDIC TO MESG 19640000
         MVC   N4(N8,WORK1),DDNAME          DDNAME TO MESSAGE           19650000
         LA    WORK5,N1                     INDICATE 1ST MACRO FORM     19660000
         B     DOPRINT                      GO PRINT MESSAGE            19670000
*                                                                       19680000
*        SUB ROUTINES FOR MESSAGE BUILDING                              19690000
*                                                                       19700000
MSGRT1   EQU   *                                                        19710000
         LR    WORK4,PARMREG1               RETURN CODE FOR CALLER      19720000
         STC   WORK4,WAREA3                 SAVE RETURN CODE            19730000
         LR    WORK5,RETCODE                SECOND LEVEL MESSAGE NUMBER 19740000
         TM    TSTFLGS3,SYMMESG             SHOULD WE PRINT A MESSAGE   19750000
         BO    CODEONLY                     NO, GO GIVE RETURN CODE     19760000
         LTR   RETCODE,RETCODE              IS UNRESOLVED RETURN CODE 0 19770000
         BZ    CODEONLY                     YES, GO GIVE RETURN CODE    19780000
         LA    WORK1,BUFFER                 ADDR OF FIRST LEVEL BUFFER  19790000
         BR    RETURN                       RETURN TO CALLER            19800000
MSGRT2   EQU   *                                                        19810000
         ST    RETURN,MSGRT214              SAVE RETURN ADDRESS         19820000
         LA    PARMREG1,N0(WORK1,WORK2)     NEXT LOCATION IN BUFFER     19830000
         LR    PARMREG0,PDEB                POINTER TO ADDRESS PDE      19840000
         L     RETCODE,TSTADDR              PTR TO ADDRESS BUILD RT     19850000
         BALR  RETURN,RETCODE               GO ADD ADDRESS TO MESSAGE   19860000
         AR    WORK2,PARMREG0               LENGTH OF MESSAGE, SO FAR   19870000
         L     RETURN,MSGRT214              RETURN ADDRESS              19880000
         BR    RETURN                       RETURN TO CALLER            19890000
MSGRT3   EQU   *                                                        19900000
         SLL   WORK2,N16                    LL00 FIELD FOR FIRST LEV    19910000
         ST    WORK2,BUFFER                 PREFIX MESG WITH LL00 FIELD 19920000
         LA    WORK1,MIDBUFF                ADDR OF SECOND LEVEL BUFFER 19930000
         MVC   N4(N10,WORK1),N0(WORK3)      MESG ID FOR SECOND LEVEL    19940000
         LA    WORK2,N14                    LENGTH OF SECOND LEV SO FAR 19950000
         LA    WORK1,N0(WORK1,WORK2)        NEXT LOATION IN BUFFER      19960000
         BR    RETURN                       RETURN TO CALLER            19970000
*                                                                       19980000
*        PUT OUT MESSAGE                                                19990000
*                                                                       20000000
DOPRINT  EQU   *                                                        20010000
         BAL   RETURN,TERMIO                GO PUT MESG TO TERMINAL     20020000
CODEONLY EQU   *                                                        20030000
         SR    RETCODE,RETCODE              CLEAR FOR RETURN CODE       20040000
         IC    RETCODE,WAREA3               RETURN CODE FOR CALLER      20050000
         B     TOCALLER                     GO BACK                     20060000
         SPACE 2                                                        20070000
*********************************************************************** 20080000
*                                                                     * 20090000
*        THIS IS THE SYNAD ROUTINE FOR READING SECONDARY  STORAGE.    * 20100000
*        THE SYNADAF ROUTINE IS USED TO OBTAIN A SYSTEM INFO MESG.    * 20110000
*        THE SYNAD ROUTINE WILL CHECK FOR AN ATTEMPT TO READ A RECORD * 20120000
*        GREATER THAN 256 BYTES.  SUCH A RECORD WOULD IMPLY THE END   * 20130000
*        OF CESD RECORDS AND WOULD NOT BE A REAL I/O ERROR            * 20140000
*                                                                     * 20150000
*********************************************************************** 20160000
         SPACE 2                                                        20170000
SYMSYNAD EQU   *                                                        20180000
         L     SYMB2,SECENTRY               ESTABLISH ADDRESSABILITY    20190000
         SYNADAF   ACSMETH=BPAM                                         20200000
         LR    WORK2,SYMWKB                 SAVE ADDR OF SYNADAF SAVE   20210000
         L     SYMWKB,N4(SYMWKB)            ADDRESS OF MY WORK AREA     20220000
         LA    WORK1,MIDBUFF                ADDR OF SECOND LEVEL BUFFER 20230000
         MVC   N0(N4,WORK1),LENGTH45        INSERT LENGTH INDICATOR     20240000
         MVC   N50(N4,WORK1),LENGTH45        INSERT LENGTH INDICATOR    20250000
         MVC   N4(N45,WORK1),N38(PARMREG1)  SYNADAF MESG TO BUFFER      20260000
         MVC   N54(N45,WORK1),N83(PARMREG1)  SYNADAF MESG TO BUFFER     20270000
         LR    SYMWKB,WORK2                 RESTORE SYNADAF SAVE PTR    20280000
         SYNADRLS                                                       20290000
         LA    PARMREG1,CLOSELST            ADDR OF LIST FORM OF CLOSE  20300000
         LA    WORK1,PDSDCB                 ADDR OF DCB TO CLOSE        20310000
         CLOSE ((WORK1)),MF=(E,(PARMREG1))                              20320000
         LA    WORK1,MIDBUFF                ADDR OF SECOND LEV BUFFER   20330000
         CLC   WLENRCD(N15),N53(WORK1)      IS ERR WRONG LEN RECORD     20340000
         BNE   GIVEMESG                     NO, GO GIVE I/O ERROR MESG  20350000
         LA    RETCODE,N32                  ENTRYNAME NOT IN CESD RCDS  20360000
         B     NOFIND                       ERROR, NO MORE CESD RCDS    20370000
         SPACE                                                          20380000
*********************************************************************** 20390000
*      WORK2 - CONTAINS THE SECOND LEVEL MESSAGE ID #                 * 20400000
*********************************************************************** 20410000
GIVEMESG EQU   *                                                        20420000
         L     WORK2,M1L2AP1                GET 2ND LEVEL MSG ID #      20430000
         LA    WORK2,N50(WORK1)             POINT TO 2ND INSERT         20440000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR MSG AREA             20450000
         IKJEGSIO MSG,FIRST=M0029,INST11=(APDE,(PDEB)),SECOND=M0237,   *20460000
               INST21=(ADDR,WORK1),INST22=(ADDR,WORK2),                *20470000
               ID=SYM30,MF=(E,TSTIOPRM)                                 20480000
         LA    RETCODE,N12                  IO ERR, RET CODE=12, GO     20500000
         B     TOCALLER                     RETURN TO CALLER            20510000
PRINT3   DS    0H                                                       20520000
         LR    WORK1,RETURN                 RESTORE REG WORK1           20530000
         B     MACRO(WORK5)                 GO TO PROPER MACRO FORM     20540000
MACRO    B     MAC                       0= GO TO FIRST FORM OF MACRO   20550000
MAC      B     MACRO1                    1= GO TO FIRST FORM OF MACRO   20560000
         B     MACRO2                    2= GO TO SECOND FORM OF MACRO  20570000
         B     MACRO3                    3= GO TO THIRD FORM OF MACRO   20580000
         B     MACRO4                    4= GO TO FOURTH FORM OF MACRO  20590000
         B     SVCERR1                   5= GO TO FIFTH FORM OF MACRO   20600000
         B     SVCERR2                   6= GO TO SIXTH FORM OF MACRO   20610000
**********************************************************************  20620000
*  WORK1 - WILL POINT TO AN INSERT                                      20630000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2AP1)        20640000
*  WORK5 - WILL INDICATE THIS FORM OF THE IKJEGSIO MACRO IS TO BE USED  20650000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          20660000
**********************************************************************  20670000
MACRO1   DS    0H                          ONE 2ND LEVEL INSERT         20680000
         IKJEGSIO MSG,FIRST=(WORK6),INST11=(APDE,(PDEB)),              *20690000
               SECOND=(WORK2),INST21=(ADDR,(WORK1)),ID=SYM30,          *20700000
               MF=(E,TSTIOPRM)                                          20710000
         B     CHECKIO                   GO CHECK IO RETURN CODE        20720000
**********************************************************************  20730000
*  WORK1 - POINTS TO AN INSERT                                          20740000
*  WORK2 - CONTAINS SECOND LEVEL MESSAGE ID NUMBER                      20750000
*  WORK3 - POINTS TO AN INSERT                                          20760000
*  WORK5 - INDICATES SECOND FORM OF THE IKJEGSIO MACRO IS TO BE USED    20770000
*  WORK6 - CONTAINS FIRST LEVEL MESSAGE ID NUMBER                       20780000
**********************************************************************  20790000
MACRO2   DS    0H                        TWO 2ND LEVEL INSERTS          20800000
         IKJEGSIO MSG,FIRST=(WORK6),INST11=(APDE,(PDEB)),              *20810000
               SECOND=(WORK2),INST21=(ADDR,(WORK1)),                   *20820000
               INST22=(ADDR,(WORK3)),ID=SYM30,MF=(E,TSTIOPRM)           20830000
         B     CHECKIO                   GO CHECK IO RETURN CODE        20840000
**********************************************************************  20850000
*  WORK1 - POINTS TO AN INSERT                                          20860000
*  WORK2 - CONTAINS SECOND LEVEL MESSAGE ID NUMBER                      20870000
*  WORK3 - POINTS TO AN INSERT                                          20880000
*  WORK4 - POINTS TO AN INSERT                                          20890000
*  WORK5 - INDICATES THIRD FORM OF THE IKJEGSIO MACRO IS TO BE USED     20900000
*  WORK6 - CONTAINS FIRST LEVEL MESSAGE ID NUMBER                       20910000
**********************************************************************  20920000
MACRO3   DS    0H                          THREE 2ND LEVEL INSERTS      20930000
         IKJEGSIO MSG,FIRST=(WORK6),INST11=(APDE,(PDEB)),              *20940000
               SECOND=(WORK2),INST21=(ADDR,(WORK1)),                   *20950000
               INST22=(ADDR,(WORK3)),INST23=(ADDR,(WORK4)),            *20960000
               ID=SYM30,MF=(E,TSTIOPRM)                                 20970000
         B     CHECKIO                   GO CHECK IO RETURN CODE        20980000
MACRO4   DS    0H                           NO 2ND LEVEL INSERT         20990000
         IKJEGSIO MSG,FIRST=(WORK6),SECOND=(WORK2),ID=SYM30,           *21000000
               MF=(E,TSTIOPRM)                                          21010000
CHECKIO  LA    WORK1,N16                    ATTENTION RETURN CODE       21020000
         CR    RETCODE,WORK1                ATTENTION OR ABEND RET CODE 21030000
         BNL   TOCALLER                     YES, GO PASS IT TO CALLER   21040000
         L     RETURN,TERMIO14              RETURN ADDRESS              21050000
         BR    RETURN                       RETURN TO CALLER            21060000
         SPACE 2                                                        21070000
*********************************************************************** 21080000
* INPUT -                                                               21090000
* WORK5 - WILL INDICATE WHICH FORM OF MACRO TO USE                      21100000
* RETCODE - WILL CONTAIN MACRO RETURN CODE                              21110000
* PARMREG0 - WILL CONTAIN ABEND CODE FROM LINK MACRO IF APPLICABLE      21120000
*********************************************************************** 21130000
SVCERR1  EQU   *                                                        21140000
         LR    WORK1,PARMREG0               TRANSFER CONTENT OF REG0    21150000
         LR    WORK3,RETCODE                TRANSFER CONTENT OF REG15   21160000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO AREA              21170000
         SPACE 2                                                        21180000
GETFRERR IKJEGSIO SVCERR,SVC=(WORK2),RC=(WORK3),ID=SYM30,              *21190000
               MF=(E,TSTIOPRM)                                          21200000
         B     CHECKIO                                                  21210000
SVCERR2  EQU   *                                                        21220000
         LR    WORK1,PARMREG0               TRANSFER CONTENT OF REG0    21230000
         LR    WORK3,RETCODE                TRANSFER CONTENT OF REG15   21240000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO AREA              21250000
LINKERR  IKJEGSIO SVCERR,SVC=(WORK2),ABENDRG=(WORK1),RC=(WORK3),       *21260000
               INST11=(NUM,I0035),ID=SYM30,MF=(E,TSTIOPRM)              21270000
         B     CHECKIO                      GO CHECK IO RETURN CODES    21280000
         SPACE 3                                                        21290000
********************************************************************    21300000
***  *****    THIS IS THE DAIR ERROR ANALYSIS ROUTINE  *********        21310000
********************************************************************    21320000
DAIRERR  DS    0H                                                       21330000
         L     WORK2,WORKAREA   ACCESS WORKAREA PTR                     21340000
         USING TSTCWORK,WORK2 ESTABLISH BASE FOR WORKAREA               21350000
         XC    CWORKSYM(N32),CWORKSYM ZERO WORKAREA                     21360000
         ST    RETCODE,DAIRRC-TSTCWORK(WORK2) STORE RC IN WORKAREA      21370000
         LA    PARMREG1,DAIRRC-TSTCWORK(WORK2) R1=ADDR OF RET CODE      21380000
         ST    PARMREG1,DAIRCPTR-TSTCWORK(WORK2) 2ND WORD OF PARAM LIST 21390000
         LA    PARMREG1,N1         SET UP CALLER ID                     21400000
         STH   PARMREG1,CALLERID-TSTCWORK(WORK2) STORE IN WORK AREA     21410000
         LA    PARMREG1,CALLERID-TSTCWORK(WORK2) R1=ADDR OF CALLER ID   21420000
         ST    PARMREG1,IDPTR-TSTCWORK(WORK2)   4TH WORD OF PARAM LIST  21430000
         L     PARMREG1,ADAIRCOR GET DAPL POINTER                       21440000
         ST    PARMREG1,DAPLPTR-TSTCWORK(WORK2) 1ST WORD OF PARAM LIST  21450000
         LA    PARMREG1,MSGENTPT-TSTCWORK(WORK2) SET UP MSG WRITER ENT  21460000
         ST    PARMREG1,MENTPTR-TSTCWORK(WORK2) STORE IN THIRD WORD     21470000
         LA    PARMREG1,CWORKSYM      POINT TO PARAMETER LIST           21480000
         LINK  EP=IKJEFF18,ERRET=LINKERR1 LINK TO DAIRFAIL              21490000
         LA    RETCODE,N8     INDICATE SYMBOL CAN BE RESOLVED           21500000
         B     TOCALLER      RETURN TO CALLER                           21510000
         SPACE 4                                                        21520000
*********************************************************************** 21530000
*                                                                     * 21540000
*        CONSTANTS                                                    * 21550000
*                                                                     * 21560000
*********************************************************************** 21570000
         SPACE 2                                                        21580000
         DS    0F                                                       21590000
INSRTLEN DC    X'000D0000'   LENGTH INDICATOR FOR 13 CHARACTER INSERTS  21600000
         SPACE 2                                                        21610000
         DS    0F                                                       21620000
LENGTH45 DC    X'003D0000'   LENGTH INDICATOR FOR 45 CHARACTER INSERTS  21630000
         SPACE 2                                                        21640000
BPAMDCB  DCB   DSORG=PO,MACRF=(R),RECFM=U,BLKSIZE=N256,                C21650000
               SYNAD=SYMSYNAD                                           21660000
ENDBPAM  EQU   *                                                        21670000
         READ  SSDECB,SF,,,'S',,,MF=L                                   21680000
ENDSDECB EQU   *                                                        21690000
LFSTAE   DS    0F                                                       21700000
         ESTAE MF=L                                                     21710000
ELFSTAE  EQU   *                                                        21720000
LFOPEN   OPEN  (,),MF=L                                                 21730000
ELFOPEN  EQU   *                                                        21740000
LFCLOSE  CLOSE (,),MF=L                                                 21750000
ELFCLOSE EQU   *                                                        21760000
LFGET    GETMAIN   MF=L                                                 21770000
ELFGET   EQU   *                                                        21780000
         SPACE 3                                                        21790000
         EJECT                                                          21800000
         SPACE                                                          21810000
*********************************************************************** 21820000
* THIS SECTION OF IKJEGSYM CONTAINS THE ERROR MESSAGE NUMBERS.        * 21830000
* MESSAGES RESIDE IN THE TSO TEST MESSAGE CSECT IN THE IO MODULE      * 21840000
* (IKJEGIO).  PERTINENT SYMBOLIC NAMES ARE ADDED VIA INSERTS THAT     * 21850000
* ARE CONTRUCTED IN THE WORKAREA NAMED 'BUFFER'.                      * 21860000
*                                                                     * 21870000
*********************************************************************** 21880000
         SPACE 2                                                        21890000
*                                                                       21900000
*        MESSAGE   IKJ57280I                                            21910000
*                                                                       21920000
M0L1P1   DC    F'028' ADDRESS NOT FOUND                                 21930000
M0L2AP1  DC    F'228' NOT FOUND UNDER THE TEST TASK STRUCTURE NO SYMB'S 21940000
M0L2BP1  DC    F'229' LOADED BY OS LOADER, INTERNAL SYMBOL UNAVAILABLE  21950000
M0L2CP1  DC    F'230' NOT BROUGHT TO MAIN STORAGE UNDER TEST NO SYMB'S  21960000
M0L2DP1  DC    F'231' LOADED BY OS LOADER, NOT ENOUGH MAIN              21970000
*                     STORAGE FOR EXTERNAL SYMBOLS                      21980000
M0L2EP1  DC    F'232' LINK EDITED WITHOUT TEST PARAMETER,               21990000
*                     INTERNAL SYMBOLS UNAVAILABLE                      22000000
M0L2FP1  DC    F'233' NOT IN INTERNAL SYMBOL TABLE FOR                  22010000
M0L2GP2  DC    F'294' FOUND IN DSECT                                    22020000
*                     FOR WHICH NO BASE ADDRESS EXISTS                  22030000
M0L2HP1  DC    F'295' NOT FOUND IN EXTERNAL SYMBOL TABLE FOR            22040000
M0L2IP1  DC    F'235' ASSEMBLED WITHOUT TEST PARAMETER,                 22050000
*                     INTERNAL SYMBOLS UNAVAILABLE                      22060000
M0L2JP1  DC    F'234' LINK EDITED IN OVERLAY,                           22070000
*                     NOT IN MAIN STORAGE                               22080000
M0L2KP1  DC    F'236' FROM DATASET IN A LINK LIBRARY LIST,              22090000
*                     SYMBOLS UNAVAILABLE                               22100000
*                                                                       22110000
*        MESSAGE   IKJ57281I                                            22120000
*                                                                       22130000
M1L1P1   DC    F'29'  SYMBOL                                            22140000
*                     AVAILABLE, SYSTEM ERROR+                          22150000
M1L2AP1  DC    F'237' I/O SYNAD ERROR                                   22160000
M1L2BP1  DC    F'238' CANNOT OPEN DATASET, DDNAME                       22170000
*                                                                       22180000
*        MESSAGE   IKJ57282I                                            22190000
*                                                                       22200000
NOCOREMG DC    F'30' NOT ENOUGH STORAGE TO USE SYMBOLS                  22210000
M2L2AP1  DC    F'239' ABSOLUTE OR RELATIVE ADDRESS MAY BE USED          22220000
         EJECT                                                          22230000
*                                                                       22240000
*        OTHER EQUATES                                                  22250000
*                                                                       22260000
LENDCB   EQU   ENDBPAM-BPAMDCB              LEN OF DCB                  22270000
LENDECB  EQU   ENDSDECB-SSDECB              LEN OF LIST FORM OF READ    22280000
LENSTAE  EQU   ELFSTAE-LFSTAE               LEN OF LIST FORM OF ESTAE   22290000
LENOPEN  EQU   ELFOPEN-LFOPEN               LEN OF LIST FORM OF OPEN    22300000
LENCLOSE EQU   ELFCLOSE-LFCLOSE             LEN OF LIST FORM OF CLOSE   22310000
LENGET   EQU   ELFGET-LFGET                 LEN OF LIST FORM OF GETMAIN 22320000
         EJECT                                                          22330000
*********************************************************************** 22340000
*                                                                     * 22350000
*        DSECTS                                                       * 22360000
*                                                                     * 22370000
*********************************************************************** 22380000
         TCOMTAB                                                        22390000
         EJECT                                                          22400000
         TSTCWORK                                                       22410000
DAPLPTR  EQU   CWORKSYM        DAIR PARAMETER LIST PTR                  22420000
DAIRCPTR EQU   CWORKSYM+N4    DAIR RETURN CODE POINTER                  22430000
MENTPTR  EQU   CWORKSYM+N8    MSG WTR ENTRY POINT POINTER               22440000
IDPTR    EQU   CWORKSYM+N12   CALLER ID POINTER                         22450000
DAIRRC   EQU   CWORKSYM+N16   DAIR RETURN CODE                          22460000
MSGENTPT EQU   CWORKSYM+N20   MESSAGE WTR ENTRY POINT                   22470000
CALLERID EQU   CWORKSYM+N24   CALLER ID                                 22480000
         EJECT                                                          22490000
         IKJPARMA       THIS DSECT DESCRIBES THE PASSED PDE CONTAIN-    22500000
*                       ING THE ACCEPTED ARGUMENTS                      22510000
*                                                                       22520000
         SPACE 2                                                        22530000
INFOBLK  DSECT     ,    THIS DSECT DESCRIBES THE INFO BLOCK BUILT TO    22540000
*                       REFLECT THE REQUEST AND INFO KNOWN ABOUT THE    22550000
*                       MODULE                                          22560000
*                                                                       22570000
LOADNAME DS    D             LOADNAME                                   22580000
ENTRYNAM DS    D             ENTRYNAME                                  22590000
DDNAME   DS    D             DDNAME FROM TT SVC OR BLANKS               22600000
LOADNAMA DS    A             LOADNAME MAIN STORAGE ADDRESS              22610000
ENTRNAMD DS    A             ENTRYNAME DISPLACEMENT INTO MODULE         22620000
MODSWS   DS    X             SWITCHES REFLECTING MOULE PASSED           22630000
*                                BIT 0  IF 0 - OBJECT MODULE            22640000
*                                       IF 1 - LOAD MODULE              22650000
*                                BTI 1  IF 0 - NO ENTRYNAME DISPL       22660000
*                                       IF 1 - ENTRYNAME DISPL PRESENT  22670000
*                                BIT 2  IF 0 - NO OS LOADER CESD INFO   22680000
*                                       IF 1 - OS LOADER CESD INFO      22690000
*                                BIT 3  IF 1 - SVC 61 HAS OPERATED      22700000
*                                       IF 0 - SVC 61 DID NOT OPERATE   22710000
*                                BIT 4  IF 1 - LMOD CESD TTR AVALIABLE  22720000
*                                       IF 0 - CESD TTR NOT AVALIABLE   22730000
*                                BIT 5  IF 1 - DDNAME PRESENT           22740000
*                                       IF 0 - LMOD IN SYS1.LINKLIB     22750000
POINTER  DS    F             OBJ-ADDR OF CESD, LOAD-TTR OF SYMBOLS      22760000
CESDTTR  DS    F             LOAD-TTR OF FIRST CESD RCD,                22770000
*                             OBJ-LENGTH OF CESD INFO                   22780000
ATTRIBUT DS    F             LOAD MODULE ATTRIBUTES OR ZERO             22790000
BASEFSYM DS    A             MAIN STORAGE ADDRESS TO ADD SYM DISPL TO   22800000
TCBADDR  DS    F             ADDRESS OF TCB LOADNAME HUNG OFF OF        22810000
         SPACE 2                                                        22820000
SYMINFO  DSECT     ,    THIS DSECT DESCRIBES THE ANSWER BLOCK BUILT     22830000
*                       BY SYM FOR A REQUEST FOR A SYMBOL               22840000
*                                                                       22850000
ZERO1    DS    X             ONE BYTE EQUAL TO ZEROES                   22860000
LOADEDAD DS    AL3           MAIN STORAGE ADDR OF SYMBOL                22870000
TYPE     DS    X             TYPE OF DATA AT THIS LOCATION              22880000
MULTIPLT DS    3X            MULTIPLICITY FACTOR                        22890000
LENGTH   DS    H             LENGTH OF STORAGE RESERVED                 22900000
RESERVD1 DS    H             RESERVED                                   22910000
NEXTANSB DS    F             ADDRESS OF NEXT ANSWER BLOCK               22920000
         SPACE 2                                                        22930000
INCORE   DSECT     ,    THIS DSECT DESCRIBES THE INCORE SYMBOL TABLE    22940000
*                                                                       22950000
NXINCORE DS    F             ADDRESS OF NEXT SYMBOL IN INCORE SYM TABLE 22960000
ZERO2    DS    X             ONE BYTE OF ZEROES                         22970000
LADDRESS DS    AL3           MAIN STORAGE ADDRESS OF SYMBOL             22980000
INCTYPE  DS    X             TYPE OF DATA AT THIS LOCATION              22990000
MULTIPCY DS    3X            MULTIPLICITY FACTOR                        23000000
SIZEFILD DS    H             LENGTH OF STORAGE RESERVED                 23010000
LENSYM   DS    H             NO. BYTES IN SYMBOL NAME                   23020000
INSYM    DS    2F            SYMBOL NAME                                23030000
         SPACE 2                                                        23040000
SVCINFO  DSECT     ,    THIS DSECT DESCRIBES THE INFO BLKS BUILT BY     23050000
*                       THE TESTRAN SVC 61 (IN DEC)                     23060000
*                                                                       23070000
LMODNAME DS    D             NAME OF MEMBER                             23080000
LMLADDR  DS    F             MAIN STORAGE ADDRESS WHERE LOADED          23090000
BEGTTR   DS    F             TTR OF BEGINNING OF MEMBER                 23100000
LMATTRIB DS    H             ATTRIBUTES FOR MEMBER                      23110000
LMFLAGS  DS    X             FLAGS REFLECTING CONTENTS OF SVCINFO BLOCK 23120000
*                                 BIT 0 DDNAME PRESENT                  23130000
*                                 BIT 1 DATASET IS SYS1.LINKLIB         23140000
CONCATNO DS    X             CONCATENATION NO. OF PDS                   23150000
LMDDNAME DS    2F            DDNAME FOR PDS CONTAINING MEMBER           23160000
LMTCB    DS    F             ADDRESS OF TCB LOADNAME HUNG OFF OF        23170000
NEXTBLK  DS    A             ADDR OF NEXT SVC SAVED INFO BLOCK          23180000
         SPACE 2                                                        23190000
SYMWORK  DSECT     ,    THIS DSECT DESCRIBES THE GOTTEN WORK AREA       23200000
*                                                                       23210000
MYSAVE   DS    18F           IKJEGSYM SAVE AREA                         23220000
PDSDCBA  DS    A             CONTAINS ADDR OF DCB FOR  READING SYMS     23230000
CINFOBKA DS    A             CONTAINS ADDR OF CURRENT INFO BLOCK        23240000
TINFOBKA DS    A             CONTAINS ADDR OF TEMPORARY INFO BLOCK      23250000
BUFFERA  DS    A             CONTAINS ADDR OF BUFFER                    23260000
WHATPASS DS    X             REFLECTION OF ARGUEMENT AND WHAT PASSED    23270000
*                                 BIT  0    LOADNAME                    23280000
*                                      1    ENTRYNAME                   23290000
*                                      2    SYMBOL                      23300000
*                                      3    OFFSET                      23310000
*                                      4    LOADNAME PASSED             23320000
*                                      5    ENTRYNAME PASSED            23330000
*                                      6    SYMBOL PASSED               23340000
*                                      7    OFFSET PASSED               23350000
SWSA     DS    X             SWITHCES USED DURING ANALYST OF SYM RCDS   23360000
*                                 BIT  0    LAST ENTRY CONTINUED        23370000
*                                      1    ANALYZE PRESENT ENTRY       23380000
*                                      2    SEARCHING A DSECT           23390000
*                                      3    SYMS AVAILABLE IN SYM RCDS  23400000
*                                           FOR THIS ENTRYNAME          23410000
SWSB     DS    X             CESD PROCESSING SWITCHS                    23420000
*                                 BIT  0    A CESD RCD HAS BEEN READ    23430000
*                                      1    SEARCH USING OFFSET         23440000
*                                      2    SEARCH USING ENTRYNAME      23450000
*                                      3    SEARCH FOR FIRST CSECT      23460000
SWSC     DS    X             UNIQUE SWITCHES                            23470000
*                                 BIT  0    DDNAME FOR LINKLIB KNOWN    23480000
*                                      1    STORAGE PARM LIST FOR DAIR  23490000
PDSDCB   DS    22F           BPAM DCB FOR READING SYMS                  23500000
STAELIST DS    4F            CONTAIN LIST FORM OF ESTAE MACRO           23510000
OPENLIST DS    2F            CONTAIN LIST FORM OF OPEN MACRO            23520000
CLOSELST DS    2F            CONTAINS LIST FORM OF CLOSE MACRO          23530000
LSTFREAD DS    6F            CONTAINS LIST FORM OF READ MACRO           23540000
OPENFDD  DS    2F            DDNAME DCB CURRENTLY OPENED FOR            23550000
CINFOBLK DS    16F           CURRENTLY QUALIFIED INFOBLK                23560000
TINFOBLK DS    16F           TEMPORARY INFOBLK FOR PRESENT REQUEST      23570000
BUFFER   DS    69F           READ SYM RCDS, BUILD ERROR MESGS           23580000
MIDBUFF  EQU   BUFFER+N100   MIDDLE OF BUFFER, ADDR OF 2ND LEV MESG     23590000
BASEADDR DS    F             BASE FOR IKJEGSYM CSECT                    23600000
WAREA1   DS    D             WORK AREA                                  23610000
WAREA2   DS    D             WORK AREA                                  23620000
WAREA3   DS    D             WORK AREA                                  23630000
ADAIRCOR DS    F             ADDRESS OF GOTTEN CORE FOR DAIR PARM LIST  23640000
PARTENTY DS    5F            POSSIBLE PART ENTRY SAVED BY SYM ANALYZIER 23650000
PENTRYLN DS    F             LEN OF POSSIBLE PART SYM ENTRY SAVED       23660000
PSYMBOL  DS    D             CONTAINS  SYMBOL THAT IS PASSED            23670000
POFFSET  DS    F             CONTAINS  OFFSET THAT IS PASSED            23680000
LINKLBDD DS    2F            IF KNOWN, CONTAINS A DDNAME FOR LINKLIB    23690000
WORKSAVE DS    3F            SAVE AREA FOR WORK REGISTERS               23700000
WKSAVE3  EQU   WORKSAVE+N8   WORK3 SAVE AREA                            23710000
WORKSAV2 DS    3F            INTERNAL ROUTINES SAVE AREA FOR WORK REGS  23720000
WKSAVE3A EQU   WORKSAV2+N8   THIRD WORD OF SAVE AREA            YA00074 23730000
CESD14   DS    F             SAVED RETURN ADDR DURING CESD PROCESSING   23740000
NOTE14   DS    F             SAVED RETURN ADDR DURING NOTE PROCESSING   23750000
TERMIO14 DS    F             RETURN ADDR FOR TERMIO PROCESSING          23760000
PART14   DS    F             RETURN ADDR FROM PART ENTRY PROCESSING     23770000
OPDCB14  DS    F             SAVED RETURN ADDR DURING DCB OPEN PROCESS  23780000
POINT14  DS    F             RETURN ADDRESS FOR POINT ROUTINE           23790000
READ14   DS    F             RETURN ADDRESS FOR READ ROUTINE            23800000
SVCBLK14 DS    F             RET ADDR FROM SVCINFO BLK SEARCH ROUTINE   23810000
MSGRT214 DS    F             RET ADDR FROM ADDR BUILD ROUTINE           23820000
ESYMWORK EQU   *          END OF SYMWORK DSECT                          23830000
         SPACE 2                                                        23840000
IHADCB   DCBD  DEVD=DA,DSORG=PO                                         23850000
         SPACE 4                                                        23860000
         IKJTPL                                                         23870000
         EJECT                                                          23880000
         IKJDAPL                                                        23890000
         SPACE 2                                                        23900000
         IKJDAP08                                                       23910000
         EJECT                                                          23920000
CVT      DSECT                                                          23930000
         CVT                                                            23940000
         EJECT                                                          23950000
         IHAXTLST                                                       23960000
         EJECT                                                          23970000
         IHACDE                                                         23980000
         EJECT                                                          23990000
         IKJTCB                                                         24000000
         EJECT                                                          24010000
         IKJRB                                                          24020000
         END                                                            24030000
