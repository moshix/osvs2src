         TITLE 'IKJEGTCB, THE LISTTCB FUNCTION OF THE TEST COMMAND'     00060002
         COPY  IKJEGSIO                                                 00110002
IKJEGTCB CSECT                                                          00120002
*********************************************************************** 00180002
* STATUS                                                              * 00240002
*    CHANGE LEVEL 000, VERSION 02, OS/VS2                             * 00290002
*                                                                     * 00300002
* FUNCTION/OPERATION                                                  * 00360002
*    THIS SUBCOMMAND PROGRAM RECEIVES CONTROL FROM THE TEST SUBCOMMAND* 00420002
*    PROCESSOR.  IT DISPLAYS ALL OR PART OF THE PROBLEM PROGRAM TCB OR* 00480002
*    THE TCB AT A SPECIFIED ADDRESS.                                  * 00540002
*                                                                     * 00600002
* ENTRY POINTS                                                        * 00660002
*         IKJEGTCB - ENTERED FROM IKJEGMNL                            * 00720002
*         IKJEGVCK - ENTERED FROM IKJPARS                             * 00780002
*                                                                     * 00840002
* INPUT                                                               * 00900002
*    ONE LINE OF INPUT FROM THE TERMINAL CONTAINING THE SUBCOMMAND    * 00960002
*                                                                     * 01020002
* OUTPUT                                                              * 01080002
*    LINES OF OUTPUT TO THE TERMINAL CONTAINING DESCRIPTIVE HEADERS   * 01140002
*    AND THE REQUESTED TCB FIELDS                                     * 01200002
*                                                                     * 01260002
* EXTERNAL REFERENCES                                                 * 01320002
*         IKJPARS  - TO SCAN THE INPUT BUFFER                         * 01380002
*         IKJEGCVT - TO CHECK AND CONVERT THE ADDRESS, IF SPECIFIED   * 01440002
*    AND TO CONVERT THE TCB FIELDS TO PRINTABLE                       * 01500002
*         IKJEGIO  - TO OUTPUT THE HEADER AND TCB FIELDS              * 01560002
*         IKJEGBLD - TO BUILD AN ADDRESS STRING FOR A MESSAGE         * 01620002
*                                                                     * 01680002
* EXITS,NORMAL                                                        * 01740002
*                                                                     * 01800002
*         IKJPARS-VIA A BRANCH REGISTER 14 FROM IKJEGVCK WITH ONE OF  * 01860002
*    THE FOLLOWING RETURN CODES IN REGISTER 15-                       * 01920002
*    0  - INDICATING TO CONTINUE PROCESSING THE COMMAND BUFFER        * 01980002
*    8  - INDICATING IKJPARS SHOULD PROMPT WITH REENTER               * 02040002
*    12 - INDICATING IKJPARS SHOULD RETURN TO IKJEGTCB WITH A         * 02100002
*    *    RETURN CODE OF 20 IN REGISTER 15                            * 02160002
*                                                                     * 02220002
*         IKJEGMNL VIA REGISTER 14 WITH ONE OF THE FOLLOWING          * 02280002
*    RETURN CODES PASSED VIA REGISTER 15.                             * 02340002
*    0  - NORMAL RETURN                                               * 02400002
*    16 - INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED           * 02460002
*                                                                     * 02520002
* EXITS,ERROR                                                         * 02580002
*         IKJEGMNL-VIA BRANCH REGISTER 14 WITH A RETURN CODE OF 20    * 02640002
*    IN REGISTER 15 INDICATING THE ESTAE RETRY ROUTINE WAS ENTERED.   * 02700002
*    A RETURN CODE OF 24 INDICATES THAT THE ESTAE COULD NOT BE ISSUED.* 02750002
*                                                                     * 02760002
* TABLES/WORK AREAS                                                   * 02820002
*    TCOMTAB - TEST TABLE AND WORKAREA                                * 02880002
*                                                                     * 02940002
* ATTRIBUTES                                                          * 03000002
*    REENTRANT ROUTINE                                                * 03060002
*    REFRESHABLE ROUTINE                                              * 03120002
*                                                                     * 03180002
* CHARACTER CODE DEPENDENCY                                           * 03240002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 03300002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT * 03360002
*    TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED  * 03420002
*    SO THAT REDEFINITION OF CHARACTER CONSTANTS, BY REASSEMBLY,      * 03480002
*    WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITION.          * 03540002
*                                                                     * 03600002
* NOTES                                                               * 03660002
*    COMMENTS ON THE ASSEMBLER STATEMENTS USUALLY START IN COLUMN 36. * 03720002
*    TCBRTRY IS THE ENTRY POINT INTO THE STAE RETRY ROUTINE AND IS    * 03780002
*    GIVEN CONTROL FROM IKJEGSTA.                                     * 03840002
*    PLM = SY35-0004                                                  * 03890002
*          TSO COMMAND PROCESSOR LOGIC                                * 03892002
*          VOLUME III - TEST                                          * 03894002
*********************************************************************** 03900002
         EJECT                                                          03960002
*********************************************************************** 04020002
*                                                                     * 04080002
*              REGISTER EQUATES                                       * 04140002
*                                                                     * 04200002
*********************************************************************** 04260002
R0       EQU   0                   WILL BE ZERO OR NEG FOR CONVERT      04320002
R1       EQU   1                   PARAMETER REGISTER                   04380002
R2       EQU   2                   WORK REG                             04440002
R3       EQU   3                   WORK REG & BASE REG FOR TCB DSECT    04500002
R4       EQU   4                   WORK REG                             04560002
R5       EQU   5                   PT TO WORK AREA                      04620002
R6       EQU   6                   WORK REG                             04680002
R7       EQU   7                   WORK REG                             04740002
R8       EQU   8                   USED TO REF TCB ENTRIES              04800002
R9       EQU   9                   BASE REG FOR TCOMTAB                 04860002
R10      EQU   10                  WORK REG                             04920002
R11      EQU   11                  WORK REG & WORKAREA BASE             04980002
R12      EQU   12                  MODULE BASE REG                      05040002
R13      EQU   13                  PT TO SAVE AREA                      05100002
R14      EQU   14                  LINKAGE RETURN REG                   05160002
R15      EQU   15                  LINKAGE BRANCH REG                   05220002
         SPACE 2                                                        05280002
*********************************************************************** 05340002
*                                                                     * 05400002
*        SYMBOLIC EQUATES                                             * 05460002
*                                                                     * 05520002
*********************************************************************** 05580002
         SPACE                                                          05640002
ZERO     EQU   0                   NO. 0                                05700002
ONE      EQU   1                   NO. 1                                05760002
TWO      EQU   2                   NO. 2                                05820002
THREE    EQU   3                   NO. 3                                05880002
FOUR     EQU   4                   NO. 4                                05940002
FIVE     EQU   5                   NO. 5                                06000002
EIGHT    EQU   8                   NO. 8                                06060002
TEN      EQU   10                  NO. 10                               06120002
ELEVEN   EQU   11                  NO. 11                               06180002
TWELVE   EQU   12                  NO. 12                               06240002
SIXTEEN  EQU   16                  NO. 16                               06300002
EIGHTEEN EQU   18                  NO. 18                               06350002
TWENTY   EQU   20                  NO. 20                               06360002
TWENTY4  EQU   24                  NO. 24                               06410002
THIRTY2  EQU   32                  NO. 32                               06420002
THIRTY5  EQU   35                  NO. 35                               06480002
FORTY    EQU   40                  NO. 40                               06540002
FIFTY6   EQU   56                  NO. 56                               06600002
SIXTY8   EQU   68                  NO. 68                               06660002
EIGHTY   EQU   80                  NO. 80                               06720002
EIGHTY4  EQU   84                  NO. 84                               06780002
EIGHTY9  EQU   89                  NO. 89                               06840002
NINETY   EQU   90                  NO. 90                               06900002
ONE59    EQU   159                 NO. 159                              06960002
ONE63    EQU   163                 NO. 163                              07020002
ONE84    EQU   184                 NO. 184                              07080002
HEX00    EQU   X'00'               NO. 0                                07140002
HEX01    EQU   X'01'               NO. 1                                07200002
HEX03    EQU   X'03'               NO. 3                                07260002
HEX04    EQU   X'04'               NO. 4                                07320002
HEXFF    EQU   X'FF'               USED IN NI INST                      07380002
BLANK    EQU   C' '                USED TO CLEAR BUFFERS                07440002
TYPE     EQU   X'04'               INDICATES CONVERT TO HEX             07500002
FLAG     EQU   X'80'               VALUE CONVERSION                     07560002
LINKCODE EQU   X'03'               STAE CODE FOR LINK FAILED            07620002
PROTCHK  EQU   7                   STAE CODE FOR PROTECTION CHK         07670002
CVTADDR  EQU   16                  ADDRESS OF CVT                       07680002
HEX38    EQU   X'38'               USED IN TM INSTRUCTION               07740002
PLUS     EQU   C'+'                PLUS SIGN                            07800002
* THE FOLLOWING ARE 1ST LEVEL MESSAGE NO. EQUATES.                      07850002
M0016    EQU   16                  TCB FIELD NAME REQUIRED              07852002
M0101    EQU   101                 INVALID ADDRESS ...                  07854002
M0103    EQU   103                 NOT ENOUGH MAIN STORAGE              07856002
M0104    EQU   104                 LISTTCB FAILED, COMND SYS ERR        07858002
* THE FOLLOWING ARE 2ND LEVEL MESSAGE NO. EQUATES.                      07858402
M0274    EQU   274                 REG NOT. MUST BE INDRCT GEN REG      07858802
M0277    EQU   277                 PARSE ERROR CODE 12                  07859202
M0280    EQU   280                 FULLWORD BOUNDARY REQ.               07859602
* THE FOLLOWING ARE CONSTANT MESSAGE INSERT EQUATES.                    07859702
I0040    EQU   40                  IKJPARS                              07859802
I0008    EQU   8                   LISTTCB                              07859902
I0003    EQU   3                   FULL                                 07879902
I0099    EQU   99                  ABEND CODE INSERT NO.                07889902
I0097    EQU   97                  ABEND CODE INSERT NO. (ICTABLE)      07899902
**********************************************************************  07900002
         EJECT                                                          07920002
*  ENTRY POINT FROM IKJEGMNL.  REGISTER 9 POINTS TO TCOMTAB UPON     *  07980002
*  ENTRY.                                                            *  08040002
         SPACE                                                          08100002
         SAVE  (14,12),,*          SAVE CALLING PROGRAM REGISTERS       08160002
         LR    R12,R15             SAVE ADDRESS OF THIS PROGRAM         08220002
         USING IKJEGTCB,R12        SET UP MODULE BASE                   08280002
         USING TCOMTAB,R9          ADDRESSABILITY FOR TCOMTAB           08340002
         L     R15,REGSAVE2        POINT TO MODULE SAVE AREA            08400002
         L     R7,PARSADR          POINT TO PARSE PCL                   08460002
         ST    R13,FOUR(R15)       STORE POINT TO OLD SAVE AREA         08520002
         ST    R15,EIGHT(R13)      STORE NEW AREA ADDR OLD SAVE AREA    08580002
         LR    R13,R15             POINT TO NEW SAVE AREA               08640002
         STM   R14,R12,TWELVE(R13) SAVE REGISTERS FOR SAFETY            08700002
         L     R6,WORKAREA         GET ADDRESS OF WORKAREA              08760002
         USING TSTCWORK,R6         ESTABLISH ADDRESSABILITY TO IT       08820002
         LA    R5,CWORKCMD         SKIP CONVERT WORKAREA                08880002
         DROP  R6                  DROP ADDRESSABILITY TO CONVERT AREA  08940002
         USING MYWKAREA,R5         ESTABLISH ADDRESSABILITY TO OUR AREA 09000002
         L     R2,TSTSTAE          POINT TO IKJEGSTA                    09010002
         XC    STAESTUF(SIXTEEN),STAESTUF   CLEAR STAE PARAMETER AREA   09050002
         ESTAE (R2),PARAM=LISTESTA,RECORD=YES,MF=(E,(R5))  ISSUE ESTAE  09052002
         LTR   R15,R15             RETURN CODE 0                        09420002
SMTSTAE  DS    0H                  SMT LABEL FOR TEST CASE TTCB0400     09480002
         BZ    SETPARSE            YES, CONTINUE PROCESSING             09540002
         STC   R15,TSTESTRC        STORE RET CODE IN TCOMTAB            09550002
         LA    R15,TWENTY4         SEND RC=24 TO MAINLINE               09560002
         B     RETURNS             RETURN TO MAINLINE                   09570002
SETPARSE EQU   *                                                        09840002
**  THIS CODE SETS UP TO GO TO IKJPARS TO VALIDITY CHECK THE INPUT  **  09900002
**  BUFFER.                                                         **  09960002
         DROP  R5                  RELEASE REGISTER 5                   10020002
         USING PPL,R5              ESTABLISH ADDRESSABILITY TO PARSE    10080002
         LR    R1,R5               PARAMETER LIST                       10140002
         LA    R2,TSTANSPL         LOAD ADDRESS OF ANSWER PLACE         10200002
         MVC   PPLUPT(FOUR),TSTUPT PUT ADDR UPT INTO PARAMETER LIST     10260002
         MVC   PPLECT(FOUR),TSTECT PUT ADDR ECT INTO PARAMETER LIST     10320002
         MVC   PPLECB(FOUR),TSTCPECB PUT ADDR ECB INTO PARAMETER LIST   10380002
         ST    R7,PPLPCL           PT TO PCL                            10440002
         ST    R2,PPLANS           PT TO ANSWER PLACE FOR PARSE         10500002
         MVC   PPLCBUF(FOUR),INBUF PT TO COMMAND BUFFER                 10560002
         ST    R13,PPLUWA          PT TO SAVE AREA FOR TCB REGS         10620002
         DROP  R5                  RELEASE REGISTER 5                   10680002
         USING MYWKAREA,R5                                              10740002
         LINK  EP=IKJPARS,ERRET=LINKFAIL LINK TO PARSE                  10850002
PARSEBLO EQU   *                   LABEL USED BY STAE RETRY ROUTINE     10860002
SMTPARS  DS    0H                  SMT LABEL FOR TEST CASE TTCB0500     10920002
         B     PARSDONE            GO TO PARSDONE                       10980002
IKJEGVCK EQU   *                                                        11040002
**  THIS IS THE VALIDITY CHECK ROUTINE FOR IKJEGTCB.  IT RECEIVES   **  11100002
**  CONTROL FROM IKJPARS.  REGISTER 1 POINTS TO THE THREE WORD      **  11160002
**  PARAMETER LIST FROM IKJPARS.  THE FIRST WORD POINTS TO THE PDE  **  11220002
**  BUILT BY IKJPARS, THE SECOND WORD POINTS TO IKJEGTCB'S SAVEAREA **  11280002
**  AND THE THIRD WORD IS USED TO PASS THE ADDRESS OF THE SECOND    **  11340002
**  LEVEL MESSAGE PASSED BY IKJEGCVT OR IKJEGSYM BACK TO IKJPARS.   **  11400002
         SAVE  (14,12),,*          SAVE PARSE'S REGS                    11460002
         L     R9,FOUR(R1)         GET ADDR OF SAVE AREA                11520002
         L     R12,SIXTY8(R9)      RESTORE PROG ADDRESSABILITY          11580002
         L     R5,FORTY(R9)        RESTORE WORK AREA ADDRESSABILITY     11640002
         L     R9,FIFTY6(R9)       RESTORE POINTER TO TCOMTAB           11700002
         ST    R1,OUTPTR2          SAVE ADDR OF PARSE PARM LIST         11760002
         L     R1,ZERO(R1)         POINT TO PDE FOR IKJEGCVT            11820002
         LR    R10,R1              GET ADDRESS OF PDL                   11880002
         USING IKJPARMA,R10        ESTABLISH ADDRESSABILITY TO PDL      11940002
         LCR   R1,R1               R1 NEGATIVE FOR ADDRESSES            12000002
         SPACE                                                          12060002
         L     R15,REGSAVE3        PT TO VALIDITY ROUTINE SAVE AREA     12120002
         LCR   R0,R1               R0 INDICATES CONVERT TO BINARY       12180002
         ST    R13,FOUR(R15)       STORE OLD SAVE AREA ADDR             12240002
         ST    R15,EIGHT(R13)      STORE NEW SAVE AREA ADDR             12300002
         LR    R13,R15             POINT TO NEW SAVE AREA               12360002
         SR    R14,R14             ZERO OUT REG 14                      12410002
         L     R4,OUTBUF           ACCESS OUTBUF                        12412002
         ST    R14,ZERO(R4)        CLEAR 1ST WORD OF OUTBUF             12414002
         OI    TSTFLGS4,TSTVALCK   INDICATE VALIDITY CHECK TO IO        12416002
         L     R15,TSTCONVT        EP OF IKJEGCVT                       12420002
         BALR  R14,R15             GO TO IKJEGCVT                       12480002
         LPR   R1,R1               RESET REGISTER 1 TO POSITIVE         12540002
         B     CONVTAB(R15)        BRANCH INTO TABLE INDEXED BY         12600002
*                                  CONTENTS OF REGISTER 15              12660002
CONVTAB  EQU   *                                                        12720002
         B     BOUNDCK             0-CONTINUE PROCESSING                12780002
         B     SET8                4-SET BY IKJEGCVT-MOVE MSG ADDR      12840002
         B     SET12               8-SET BY IKJEGSYM-MOVE MSG ADDR      12900002
         B     SET12               12-SET BY IKJEGSYM-MOVE MSG ADDR     12960002
         B     SET12               16-ATTENTION INTERRUPT-RETURN        13020002
         B     SET12               20-IKJEGCVT OR IKJEGSYM BLEW         13080002
SET12    EQU   *                                                        13380002
         ST    R15,REG15           SAVE RETURN CODE FOR LATER USE       13440002
         LA    R15,TWELVE          SET RETURN CODE TO 12                13500002
         B     PARSRTRN            GO RETURN TO IKJPARS                 13560002
SET8     EQU   *                                                        13860002
         LA    R15,EIGHT           SET RETURN CODE TO 8                 13920002
         B     PARSRTRN            GO RETURN TO IKJEGMNL                13980002
SET0     EQU   *                                                        14040002
         XR    R15,R15             SET RETURN CODE TO 0                 14100002
         SPACE                                                          14160002
PARSRTRN EQU   *                                                        14220002
         L     R4,OUTBUF           ACCESS OUTBUF                        14270002
         L     R4,ZERO(R4)         FIRST WORD OF OUTBUF TO REG 4        14272002
         LTR   R4,R4               IS THERE A SECOND LEVEL MESSAGE      14274002
         BZ    PARSRET             NO, RETURN TO PARSE                  14278002
         L     R7,OUTPTR2          GET ADDR OF PARM LIST FROM PARSE     14278402
         LA    R7,EIGHT(R7)        GET ADDR OF 3RD WORD OF PARM LIST    14278802
         MVC   ZERO(FOUR,R7),OUTBUF PUT MSG ADDR INTO PARM LIST         14279202
PARSRET  EQU   *                   RETURN TO PARSE                      14279602
         NI    TSTFLGS4,HEXFF-TSTVALCK CLEAR VALIDITY CHECK FLAG        14279702
         L     R13,FOUR(R13)       RESTORE REGISTER 13                  14280002
         RETURN (14,12),,RC=(15)   RESTORE REGS AND RETURN              14340002
*********************************************************************** 14400002
*THE FOLLOWING CODE PERFORMS FURTHER ADDRESS VALIDITY CHECKING.  IT     14460002
*CHECKS THAT THE ADDRESS IS NOT A REGISTER AND THAT THE ADDRESS IS ON   14520002
*A FULL WORD BOUNDARY.                                                  14580002
*********************************************************************** 14640002
BOUNDCK  EQU   *                                                        14700002
         L     R3,PDEUSER          LOAD USER WORD                       14880002
         TM    PDEUSER,PDESIB      IS CONVERTED ADDRESS IN USER WORD    14940002
         BZ    NOSYM               YES, PICK UP THE ADDRESS             15000002
         L     R3,ZERO(ZERO,R3)    NO, GET ADDR FROM SI BLOCK           15060002
         ST    R3,THIRTY2(R1)      PUT ADDRESS INTO USER WORD           15120002
NOSYM    EQU   *                                                        15180002
         L     R6,REGSAVE2         GET ADDR OF SAVE AREA                15240002
         ST    R3,THIRTY2(R6)      SAVE TCB ADDR                        15300002
REGTEST  EQU   *                   CHECK FOR INVALID REGISTER ADDR      15540002
         LH    R4,PDEINDCT         GET INDIRECT COUNT                   15600002
         LTR   R4,R4               IS IT ZERO                           15660002
         BNZ   FULLWORD            NO, INDIRECT ADDRESS, BRANCH         15720002
         TM    PDEFLG4,HEX38       YES, IS THIS A REGISTER ADDR         15780002
         BZ    FULLWORD            NO, GO CHECK BOUNDARY                15840002
         LA    R2,M0101            MSG-INVALID ADDRESS ...              15890002
         LA    R3,M0274            MSG-REG NOT. MUST BE IND GEN REG     15892002
         LR    R4,R10              ADDRESS PDE                          15894002
         B     MSG2                GO OUTPUT THE MESSAGES               15896002
         SPACE                                                          16020002
FULLWORD EQU   *                                                        16080002
         TM    THIRTY5(R1),HEX03   FULLWORD BOUNDARY                    16140002
         BZ    SET0                RETURN TO PARSE                      16310002
         LA    R2,M0101            MSG-INVALID ADDRESS ...              16312002
         LA    R3,M0280            MSG-FULLWORD BOUNDARY REQ.           16314002
         LR    R4,R10              ADDRESS PDE                          16316002
         B     MSG3                GO OUTPUT THE MESSAGES               16318002
         SPACE                                                          16320002
*        THE FOLLOWING CODE IS EXECUTED UPON COMPLETION OF PARSE      * 18223002
PARSDONE EQU   *                                                        18240002
         LTR   R15,R15             IS RETURN CODE 0 (SUCCESSFUL PARSE   18300002
*                                  COMPLETION)                          18360002
         BNZ   TCBRET1             NO, BRANCH TO TCBRET                 18420002
         ST    R15,REG14           REG15=0...CLEAR REG14 SAVE           18480002
         L     R10,TSTANSPL        LOAD ADDR OF PARSE PDL               18540002
         USING IKJPARMD,R10        ESTABLISH PDL ADDRESSABILITY         18600002
FIELDCHK EQU   *                                                        18660002
         MVI   EXTENTFG,HEX00      CLEAR EXTENT FLAG                    18714002
         MVI   NOFLDFLG,HEX00      CLEAR NO FIELDS FLAG                 18716002
         CLI   TCBFIELD+ONE,HEX00  WERE FIELDS SPECIFIED BY USER        18720002
         BNE   PRINTCHK            YES,  GO TO PRINTCHK                 18780002
*********************************************************************** 18840002
*        OTHERWISE FIELD WAS NOT SPECIFIED AND THE USER DESIRES ALL   * 18900002
*        FIELDS OF THE TCB.  IT IS NECESSARY TO MAKE THE PDE'S FOR ALL* 18960002
*        THE FIELDS OF THE TCB NON-ZERO.                              * 19020002
*********************************************************************** 19080002
         MVI   RBP,HEXFF           INDICATE THAT ALL FIELDS OF THE TCB  19140002
         MVC   RBP+ONE(CNT*2-ONE),RBP  WERE REQUESTED BY THE USER       19200002
         MVI   NOFLDFLG,HEXFF      SET NO FIELDS FLAG                   19250002
PRINTCHK EQU   *                                                        19260002
         CLI   PRINTIT+ONE,HEX00   IS PRINT KEYWORD SPECIFIED           19320002
         BNE   PRINTSPC            YES...GO TURN ON PRINT FLAG          19380002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)  NO...TURN OFF FLAG BIT        19440002
         SR    R4,R4               ZERO FOR OUTPUT TO TERMINAL          19500002
         B     ADDRCHK             GO CHECK FOR ADDR PARAMETERS         19560002
PRINTSPC EQU   *                                                        19620002
         OI    TSTFLGS1,TSTPRINT   SWITCH ON FOR OUTPUT TO DATA SET     19680002
         LA    R4,DSNAM            GET ADDR OF DSNAME PDE               19740002
ADDRCHK  EQU   *                                                        19800002
         LA    R10,ADDRESS         GET POINTER TO ADDRESS FIELD         19860002
         DROP  R10                 RELEASE REGISTER 10                  19920002
         USING IKJPARMA,R10        ESTABLISH ADDRESSABILITY             19980002
         L     R7,PDEADRPT         GET POINTER TO ADDRESS               20040002
         DROP  R10                 RELEASE REGISTER 10                  20100002
         L     R10,TSTANSPL        LOAD ADDR OF PARSE PDL               20160002
         USING IKJPARMD,R10        ESTABLISH PDL ADDRESSABILITY         20220002
         SPACE                                                          20280002
         ST    R4,PRINTFLG         MOVE ADDR OF DSNAME PDE OR 0 INTO    20340002
*                                  WORKAREA                             20400002
         LTR   R7,R7               WAS ADDR SPECIFIED BY USER           20460002
         BNZ   TABLESCN            YES, IF ADDR SPECIFIED, BRANCH       20520002
         L     R3,PPTCB            NO, PT TO THE PROBLEM PROGRAM TCB    20580002
*********************************************************************** 20640002
*        THE FOLLOWING CODE WILL SCAN THE STRING OF PARSE PDES ONE BY * 20700002
*        ONE AND BRANCH TO THE APPROPRIATE SUBROUTINE.                * 20760002
*********************************************************************** 20820002
TABLESCN EQU   *                                                        20880002
         L     R11,OUTBUF          POINT TO OUTPUT BUFFER               20940002
         SPACE                                                          21000002
         USING TCB,R3              ESTABLISH ADDRESSABILITY TO TCB      21060002
         SPACE                                                          21120002
         LA    R4,EIGHTY           LOAD DEFAULT OUTPUT LENGTH           21180002
         CH    R4,TMPLL            COMPARE WITH TERMINAL LINE LENGTH    21240002
         BNH   LINESET             IF 80 IS LOW, BRANCH                 21300002
         LA    R4,FORTY                                                 21360002
         CH    R4,TMPLL            COMPARE 40 WITH TMP LINE LENGTH      21420002
         BH    DEFAULT             BRANCH IF 40 IS HIGHER THAN TERMINAL 21480002
         LH    R4,TMPLL            USE SPECIFIED LINE LENGTH            21540002
         B     LINESET             GO SET LINE LENGTH                   21600002
DEFAULT  EQU   *                                                        21660002
         LA    R4,EIGHTY           DEFAULT LINE LENGTH TO 80            21720002
LINESET  EQU   *                                                        21780002
         ST    R4,LINELEN          STORE OUTPUT LINE LENGTH             21840002
         SR    R2,R2               ZERO OUTPUT LENGTH COUNTER           21900002
         ST    R2,LENGTH           CLEAR OUT AREA                       21960002
         STH   R2,GRSFLAG1         TURN OFF GRS FLAGS                   22020002
         MVI   ZERO(R11),BLANK     CLEAR OUT                            22080002
         MVC   ONE(ONE63,R11),ZERO(R11)  OUTPUT BUFFERS                 22140002
         LA    R6,RBP              POINT TO STRING OF FIELD PDE'S       22200002
         LA    R4,RBP+CNT*2        PT TO END OF STRING OF PDES          22260002
         ST    R4,ENDPDECK         OF FIELD KEYWORDS                    22320002
PDECHECK EQU   *                                                        22380002
         CLI   ONE(R6),HEX00       IS KEYWORD PRESENT                   22440002
         BNE   SBRTNSVR            YES, GO TO CORRESPONDING SUBROUTINE  22500002
         LA    R6,TWO(R6)          NO, POINT TO NEXT PDE                22560002
         C     R6,ENDPDECK         IS THERE ANOTHER PDE                 22620002
         BE    PDLEND              NO, GO TO PDLEND                     22680002
         B     PDECHECK            YES, CHECK NEXT PDE                  22740002
         SPACE                                                          22800002
SBRTNSVR EQU   *                                                        22860002
         L     R7,ENDPDECK         END OF PDE STRING                    22920002
         LA    R10,CNT*2           LENGTH OF PDE STRING                 22980002
         SR    R7,R6               SUBTRACT CURRENT PDE LOCATION        23040002
         SR    R10,R7              FIND RELATIVE POSITION OF PDE        23100002
         LA    R11,ELEVEN          HALF THE NO. OF BYTES FOR EACH       23160002
*                                  PDE BLOCK OF CODE                    23220002
         SPACE                                                          23280002
         LA    R7,SBRTNTAB         LOAD ADDRESS OF SUBROUTINE TABLE     23340002
         MR    R10,R10             MULTIPLY FOR PROPER ADDRESSING IN    23400002
*                                  TABLE                                23460002
         AR    R7,R11              ADD THE OFFSET                       23520002
         L     R11,TCBEXT2         PTR TO EXTENSION TO TCB              23530002
         USING TCBXTNT2,R11        ESTABLISH ADDRESSABILITY             23540002
         BR    R7                  BRANCH TO THE PROPER SECTION BELOW   24120002
         EJECT                                                          24180002
SBRTNTAB EQU   *                                                        24240002
         SPACE                                                          24300002
*********************************************************************** 24360002
*       FOLLOWING ARE 81 BLOCKS CONTAINING 5 LINES EACH               * 24420002
*       THESE BLOCKS CORRESPOND TO THE FIELDS OF THE TCB.             * 24480002
*       THEY SET THE FIELD AND HEADER LENGTHS, THE RELATIVE           * 24540002
*       ADDRESS OF THE FIELD IN THE TCB, AND THE HEADER.              * 24600002
*       CONTROL IS THEN PASSED TO A COMMON OUTPUT AND                 * 24660002
*       CONVERSION ROUTINE.                                           * 24720002
*********************************************************************** 24780002
         SPACE                                                          24840002
TCB000S  EQU   *                                                        24900002
         MVC   HDRBUF(L'HDRRBP),HDRRBP   HEADER TO HEADER BUFFER        24960002
         MVI   HDRLEN,L'HDRRBP     LENGTH OF FIELD HEADER               25020002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          25080002
         LA    R8,TCBRBP           RBP ENTRY IN TCB                     25140002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      25200002
TCB004S  EQU   *                                                        25260002
         MVC   HDRBUF(L'HDRPIE),HDRPIE   HEADER TO HEADER BUFFER        25320002
         MVI   HDRLEN,L'HDRPIE     LENGTH OF FIELD HEADER               25380002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          25440002
         LA    R8,TCBPIE           PIE ENTRY IN TCB                     25500002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      25560002
TCB008S  EQU   *                                                        25620002
         MVC   HDRBUF(L'HDRDEB),HDRDEB   HEADER TO HEADER BUFFER        25680002
         MVI   HDRLEN,L'HDRDEB     LENGTH OF FIELD HEADER               25740002
         MVI   FLDLEN,FOUR         NO OF BYTES FOR THIS FIELD           25800002
         LA    R8,TCBDEB           DEB ENTRY IN TCB                     25860002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      25920002
TCB012S  EQU   *                                                        25980002
         MVC   HDRBUF(L'HDRTIO),HDRTIO   HEADER TO HEADER BUFFER        26040002
         MVI   HDRLEN,L'HDRTIO     LENGTH OF FIELD HEADER               26100002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          26160002
         LA    R8,TCBTIO           TIO ENTRY IN TCB                     26220002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      26280002
TCB016S  EQU   8                                                        26340002
         MVC   HDRBUF(L'HDRCMP),HDRCMP  HEADER TO HEADER BUFFER         26400002
         MVI   HDRLEN,L'HDRCMP     LENGTH OF FIELD HEADER               26460002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          26520002
         LA    R8,TCBCMP           CMP ENTRY IN TCB                     26580002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      26640002
TCB020S  EQU   *                                                        26700002
         MVC   HDRBUF(L'HDRTRN),HDRTRN  HEADER TO HEADER BUFFER         26760002
         MVI   HDRLEN,L'HDRTRN     LENGTH OF FIELD HEADER               26820002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN THIS FIELD           26880002
         LA    R8,TCBTRN           TRN ENTRY IN TCB                     26940002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      27000002
TCB024S  EQU   *                                                        27060002
         MVC   HDRBUF(L'HDRMSS),HDRMSS   HEADER TO HEADER BUFFER        27120002
         MVI   HDRLEN,L'HDRMSS     LENGTH OF FIELD HEADER               27180002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN THIS FIELD           27240002
         LA    R8,TCBMSS           MSS ENTRY IN TCB                     27300002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      27360002
TCB028S  EQU   *                                                        27420002
         MVC   HDRBUF(L'HDRPKF),HDRPKF  HEADER TO HEADER BUFFER         27480002
         MVI   HDRLEN,L'HDRPKF     LENGTH OF FIELD HEADER               27540002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              27600002
         LA    R8,TCBPKF           PKF ENTRY IN TCB                     27660002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      27720002
TCB029S  EQU   *                                                        27780002
         MVC   HDRBUF(L'HDRFLGS),HDRFLGS   HEADER TO HEADER BUFFER      27840002
         MVI   HDRLEN,L'HDRFLGS    LENGTH OF FIELD HEADER               27900002
         MVI   FLDLEN,FIVE         NO. BYTES IN THIS FIELD              27960002
         LA    R8,TCBFLGS          FLGS ENTRY IN TCB                    28020002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      28080002
TCB034S  EQU   *                                                        28140002
         MVC   HDRBUF(L'HDRLMP),HDRLMP  HEADER TO HEADER BUFFER         28200002
         MVI   HDRLEN,L'HDRLMP     LENGTH OF FIELD HEADER               28260002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              28320002
         LA    R8,TCBLMP           LMP ENTRY IN TCB                     28380002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      28440002
TCB035S  EQU   *                                                        28500002
         MVC   HDRBUF(L'HDRDSP),HDRDSP   HEADER TO HEADER BUFFER        28560002
         MVI   HDRLEN,L'HDRDSP     LENGTH OF FIELD HEADER               28620002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              28680002
         LA    R8,TCBDSP           DSP ENTRY IN TCB                     28740002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      28800002
TCB036S  EQU   *                                                        28860002
         MVC   HDRBUF(L'HDRLLS),HDRLLS   HEADER TO HEADER BUFFER        28920002
         MVI   HDRLEN,L'HDRLLS     LENGTH OF FIELD HEADER               28980002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              29040002
         LA    R8,TCBLLS           LLS ENTRY IN TCB                     29100002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      29160002
TCB040S  EQU   *                                                        29220002
         MVC   HDRBUF(L'HDRJLB),HDRJLB   HEADER TO HEADER BUFFER        29280002
         MVI   HDRLEN,L'HDRJLB     LENGTH OF FIELD HEADER               29340002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              29400002
         LA    R8,TCBJLB           JLB ENTRY IN TCB                     29460002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      29520002
TCB044S  EQU   *                                                        29580002
         MVC   HDRBUF(L'HDRJPQ),HDRJPQ   HEADER TO HEADER BUFFER        29640002
         MVI   HDRLEN,L'HDRJPQ     LENGTH OF FIELD HEADER               29700002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              29760002
         LA    R8,TCBJPQ           JPQ ENTRY IN TCB                     29820002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      29880002
* THE FOLLOWING BLOCK SETS UP FOR THE GRS FIELD OF THE TCB            * 29940002
TCB048S  EQU   *                                                        30000002
         MVC   HDRBUF(L'HDRGRS),HDRGRS   HEADER TO HEADER BUFFER        30060002
         MVI   HDRLEN,L'HDRGRS     LENGTH OF FIELD HEADER               30120002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR EACH REGISTER       30180002
         LA    R8,TCBGRS           GRS ENTRY IN TCB                     30240002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      30300002
TCB112S  EQU   *                                                        30360002
         MVC   HDRBUF(L'HDRQEL),HDRQEL   HEADER TO HEADER BUFFER        30420002
         MVI   HDRLEN,L'HDRQEL     LENGTH OF FIELD HEADER               30480002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              30540002
         LA    R8,TCBQEL           QEL ENTRY IN TCB                     30600002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      30660002
TCB113S  EQU   *                                                        30720002
         MVC   HDRBUF(L'HDRFSAB),HDRFSAB  HEADER TO HEADER BUFFER       30780002
         MVI   HDRLEN,L'HDRFSAB    LENGTH OF FIELD HEADER               30840002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              30900002
         LA    R8,TCBFSAB          FSA ENTRY IN TCB                     30960002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      31020002
TCB116S  EQU   *                                                        31080002
         MVC   HDRBUF(L'HDRTCB),HDRTCB   HEADER TO HEADER BUFFER        31140002
         MVI   HDRLEN,L'HDRTCB     LENGTH OF FIELD HEADER               31200002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN THIS FIELD           31260002
         LA    R8,TCBTCB           CUR TCB ENTRY IN TCB                 31320002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      31380002
TCB120S  EQU   *                                                        31440002
         MVC   HDRBUF(L'HDRTME),HDRTME   HEADER TO HEADER BUFFER        31500002
         MVI   HDRLEN,L'HDRTME     LENGTH OF FIELD HEADER               31560002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              31620002
         LA    R8,TCBTME           TME ENTRY IN TCB                     31680002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      31740002
TCB124S  EQU   *                                                        31800002
         MVC   HDRBUF(L'HDRJSTCB),HDRJSTCB   HEADER TO HEADER BUFFER    31860002
         MVI   HDRLEN,L'HDRJSTCB   LENGTH OF FIELD HEADER               31920002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              31980002
         LA    R8,TCBJSTCB         JSTCB ENTRY IN TCB                   32040002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      32100002
TCB128S  EQU   *                                                        32160002
         MVC   HDRBUF(L'HDRNTC),HDRNTC  HEADER TO HEADER BUFFER         32220002
         MVI   HDRLEN,L'HDRNTC     LENGTH OF FIELD HEADER               32280002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              32340002
         LA    R8,TCBNTC           NTC ENTRY IN TCB                     32400002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      32460002
TCB132S  EQU   *                                                        32520002
         MVC   HDRBUF(L'HDROTC),HDROTC   HEADER TO HEADER BUFFER        32580002
         MVI   HDRLEN,L'HDROTC     LENGTH OF FIELD HEADER               32640002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              32700002
         LA    R8,TCBOTC           OTC ENTRY IN TCB                     32760002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      32820002
TCB136S  EQU   *                                                        32880002
         MVC   HDRBUF(L'HDRLTC),HDRLTC   HEADER TO HEADER BUFFER        32940002
         MVI   HDRLEN,L'HDRLTC     LENGTH OF FIELD HEADER               33000002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              33060002
         LA    R8,TCBLTC           LTC ENTRY IN TCB                     33120002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      33180002
TCB140S  EQU   *                                                        33240002
         MVC   HDRBUF(L'HDRIQE),HDRIQE   HEADER TO HEADER BUFFER        33300002
         MVI   HDRLEN,L'HDRIQE     LENGTH OF FIELD HEADER               33360002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              33420002
         LA    R8,TCBIQE           IQE ENTRY IN TCB                     33480002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      33540002
TCB144S  EQU   *                                                        33600002
         MVC   HDRBUF(L'HDRECB),HDRECB   HEADER TO HEADER BUFFER        33660002
         MVI   HDRLEN,L'HDRECB     LENGTH OF FIELD HEADER               33720002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              33780002
         LA    R8,TCBECB           ECB ENTRY IN TCB                     33840002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      33900002
TCB148S  EQU   *                                                        33960002
         MVC   HDRBUF(L'HDRTSFLG),HDRTSFLG   HEADER TO HEADER BUFFER    34020002
         MVI   HDRLEN,L'HDRTSFLG   LENGTH OF HEADER BUFFER              34080002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              34140002
         LA    R8,TCBTSFLG         TSFLG ENTRY IN TCB                   34200002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      34260002
TCB149S  EQU   *                                                        34320002
         MVC   HDRBUF(L'HDRSTPCT),HDRSTPCT   HEADER TO HEADER BUFFER    34380002
         MVI   HDRLEN,L'HDRSTPCT   LENGTH OF FIELD HEADER               34440002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              34500002
         LA    R8,TCBSTPCT         STPCT ENTRY IN TCB                   34560002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      34620002
TCB150S  EQU   *                                                        34680002
         MVC   HDRBUF(L'HDRTSLP),HDRTSLP  HEADER TO HEADER BUFFER       34740002
         MVI   HDRLEN,L'HDRTSLP    LENGTH OF FIELD HEADER               34800002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              34860002
         LA    R8,TCBTSLP          TSLP ENTRY IN TCB                    34920002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      34980002
TCB151S  EQU   *                                                        35040002
         MVC   HDRBUF(L'HDRTSDP),HDRTSDP  HEADER TO HEADER BUFFER       35100002
         MVI   HDRLEN,L'HDRTSDP    LENGTH OF FIELD HEADER               35160002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              35220002
         LA    R8,TCBTSDP          TSDP ENTRY IN TCB                    35280002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      35340002
TCB152S  EQU   *                                                        35400002
         MVC   HDRBUF(L'HDRPQE),HDRPQE   HEADER TO HEADER BUFFER        35460002
         MVI   HDRLEN,L'HDRPQE     LENGTH OF FIELD HEADER               35520002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              35580002
         LA    R8,TCBPQE           PQE ENTRY IN TCB                     35640002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      35700002
* THE FOLLOWING BLOCK SETS UP FOR THE AQE FIELD OF THE TCB            * 35760002
TCB156S  EQU   *                                                        35820002
         MVC   HDRBUF(L'HDRAQE),HDRAQE  HEADER TO HEADER BUFFER         35880002
         MVI   HDRLEN,L'HDRAQE     LENGTH OF FIELD HEADER               35940002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              36000002
         LA    R8,TCBAQE           AQE ENTRY IN TCB                     36060002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      36120002
TCB160S  EQU   *                                                        36180002
         MVC   HDRBUF(L'HDRNSTAE),HDRNSTAE   HEADER TO HEADER BUFFER    36240002
         MVI   HDRLEN,L'HDRNSTAE   LENGTH OF FIELD HEADER               36300002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              36360002
         LA    R8,TCBNSTAE         STAE FLAGS ENTRY IN TCB              36420002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      36480002
TCB161S  EQU   *                                                        36540002
         MVC   HDRBUF(L'HDRSTABB),HDRSTABB  HEADER TO HEADER BUFFER     36600002
         MVI   HDRLEN,L'HDRSTABB   LENGTH OF FIELD HEADER               36660002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              36720002
         LA    R8,TCBSTABB         STAE ADDR ENTRY IN TCB               36780002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      36840002
TCB164S  EQU   *                                                        36900002
         MVC   HDRBUF(L'HDRTCT),HDRTCT   HEADER TO HEADER BUFFER        36960002
         MVI   HDRLEN,L'HDRTCT     LENGTH OF FIELD HEADER               37020002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              37080002
         LA    R8,TCBTCT           TCT ENTRY IN TCB                     37140002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      37200002
TCB168S  EQU   *                                                        37260002
         MVC   HDRBUF(L'HDRUSER),HDRUSER   HEADER TO HEADER BUFFER      37320002
         MVI   HDRLEN,L'HDRUSER    LENGTH OF FIELD HEADER               37380002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              37440002
         LA    R8,TCBUSER          USER ENTRY IN TCB                    37500002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      37560002
TCB172S  EQU   *                                                        37620002
         MVC   HDRBUF(L'HDRNDSP0),HDRNDSP0   HEADER TO HEADER BUFFER    37680002
         MVI   HDRLEN,L'HDRNDSP0   LENGTH OF FIELD HEADER               37740002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              37800002
         LA    R8,TCBNDSP0         NDSP0 ENTRY IN TCB                   37860002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      37920002
TCB173S  EQU   *                                                        37980002
         MVC   HDRBUF(L'HDRNDSP1),HDRNDSP1  HEADER TO HEADER BUFFER     38040002
         MVI   HDRLEN,L'HDRNDSP1   LENGTH OF FIELD HEADER               38100002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              38160002
         LA    R8,TCBNDSP1         NDSP1 ENTRY                          38220002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      38280002
TCB174S  EQU   *                                                        38340002
         MVC   HDRBUF(L'HDRNDSP2),HDRNDSP2   HEADER TO HEADER BUFFER    38400002
         MVI   HDRLEN,L'HDRNDSP2   LENGTH OF FIELD HEADER               38460002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              38520002
         LA    R8,TCBNDSP2         NDSP2 ENTRY IN TCB                   38580002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      38640002
TCB175S  EQU   *                                                        38700002
         MVC   HDRBUF(L'HDRNDSP3),HDRNDSP3  HEADER TO HEADER BUFFER     38760002
         MVI   HDRLEN,L'HDRNDSP3   LENGTH OF FIELD HEADER               38820002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              38880002
         LA    R8,TCBNDSP3         NDSP3 ENTRY IN TCB                   38940002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39000002
TCB176S  EQU   *                                                        39060002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      39120002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               39180002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN FIELD                39240002
         LA    R8,TCBNDSP3+ONE     RESERVED ENTRY IN TCB                39300002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39360002
TCB180S  EQU   *                                                        39420002
         MVC   HDRBUF(L'HDRJSCB),HDRJSCB   HEADER TO HEADER BUFFER      39480002
         MVI   HDRLEN,L'HDRJSCB    LENGTH OF FIELD HEADER               39540002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              39600002
         LA    R8,TCBJSCB          JSCB ENTRY IN TCB                    39660002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39720002
TCB181S  EQU   *                   DDEXC ROUTINE                        39770002
         MVC   HDRBUF(L'HDRDDEXC),HDRDDEXC   HEADER TO HEADER BUFFER    39772002
         MVI   HDRLEN,L'HDRDDEXC   LENGTH OF FIELD HEADER               39774002
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              39776002
         LA    R8,TCBDDEXC         DDEXC ENTRY IN TCB                   39778002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39778402
TCB182S  EQU   *                   DDWTC ROUTINE                        39778802
         MVC   HDRBUF(L'HDRDDWTC),HDRDDWTC   HEADER TO HEADER BUFFER    39779202
         MVI   HDRLEN,L'HDRDDWTC   LENGTH OF FIELD HEADER               39779602
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              39779702
         LA    R8,TCBDDWTC         DDWTC ENTRY IN TCB                   39779802
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39779902
TCB183S  EQU   *                   IOBRC ROUTINE                        39799902
         MVC   HDRBUF(L'HDRIOBRC),HDRIOBRC   HEADER TO HEADER BUFFER    39809902
         MVI   HDRLEN,L'HDRIOBRC   LENGTH OF FIELD HEADER               39819902
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              39826602
         LA    R8,TCBIOBRC         IOBRC FIELD IN TCB                   39828602
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39830602
TCB184S  EQU   *                                                        39833302
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      39840002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               39900002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              39960002
         LA    R8,TCBIOBRC+FOUR     RESERVED ENTRY IN TCB               40020002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      40080002
TCB196S  EQU   *                                                        40140002
         MVC   HDRBUF(L'HDREXT1),HDREXT1   HEADER TO HEADER BUFFER      40200002
         MVI   HDRLEN,L'HDREXT1    LENGTH OF FIELD HEADER               40260002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              40320002
         LA    R8,TCBEXT1          RESERVED ENTRY IN TCB                40380002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      40440002
         SPACE 1                                                        40500002
TCB200S  EQU   *                                                        40860002
         MVC   HDRBUF(L'HDRNDSP4),HDRNDSP4  HEADER TO HEADER BUFFER     40920002
         MVI   HDRLEN,L'HDRNDSP4   LENGTH OF FIELD HEADER               40980002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              41040002
         LA    R8,TCBNDSP4         NDSP4 ENTRY IN TCB                   41100002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      41160002
TCB201S  EQU   *                                                        41220002
         MVC   HDRBUF(L'HDRNDSP5),HDRNDSP5  HEADER TO HEADER BUFFER     41280002
         MVI   HDRLEN,L'HDRNDSP5   LENGTH OF FIELD HEADER               41340002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              41400002
         LA    R8,TCBNDSP5         NDSP5 ENTRY IN TCB                   41460002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      41520002
TCB202S  EQU   *                                                        41580002
         MVC   HDRBUF(L'HDRFLGS6),HDRFLGS6  HEADER TO HEADER BUFFER     41640002
         MVI   HDRLEN,L'HDRFLGS6   LENGTH OF FIELD HEADER               41700002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              41760002
         LA    R8,TCBFLGS6         FLGS6 ENTRY IN TCB                   41820002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      41880002
TCB203S  EQU   *                                                        41940002
         MVC   HDRBUF(L'HDRFLGS7),HDRFLGS7  HEADER TO HEADER BUFFER     42000002
         MVI   HDRLEN,L'HDRFLGS7   LENGTH OF FIELD HEADER               42060002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              42120002
         LA    R8,TCBFLGS7         FLGS7 ENTRY IN TCB                   42180002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      42240002
TCB204S  EQU   *                                                        42300002
         MVC   HDRBUF(L'HDRDAR),HDRDAR  HEADER TO HEADER BUFFER         42360002
         MVI   HDRLEN,L'HDRDAR     LENGTH OF FIELD HEADER               42420002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              42480002
         LA    R8,TCBDAR           DAR ENTRY IN TCB                     42540002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      42600002
TCB205S  EQU   *                                                        42660002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       42720002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               42780002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              42840002
         LA    R8,TCBDAR+ONE       RESERVED ENTRY IN TCB                42900002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      42960002
TCB206S  EQU   *                   SYSCT ROUTINE                        43010002
         MVC   HDRBUF(L'HDRSYSCT),HDRSYSCT   HEADER TO HEADER BUFFER    43012002
         MVI   HDRLEN,L'HDRSYSCT   LENGTH OF FIELD HEADER               43014002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              43016002
         LA    R8,TCBSYSCT         SYSCT FIELD IN TCB                   43018002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      43018402
TCB207S  EQU   *                   STMCT ROUTINE                        43018802
         MVC   HDRBUF(L'HDRSTMCT),HDRSTMCT   HEADER TO HEADER BUFFER    43019202
         MVI   HDRLEN,L'HDRSTMCT   LENGTH OF FIELD HEADER               43019602
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              43019702
         LA    R8,TCBSTMCT         STMCT FIELD IN TCB                   43019802
         B     FLDOUTPT            TO COMMON CONVERSION ROUTINE         43019902
TCB208S  EQU   *                                                        43020002
         MVC   HDRBUF(L'HDREXT2),HDREXT2  HEADER TO HEADER BUFFER       43080002
         MVI   HDRLEN,L'HDREXT2    LENGTH OF FIELD HEADER               43140002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              43200002
         LA    R8,TCBEXT2          EXT2 ENTRY IN TCB                    43260002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      43320002
TCB212S  EQU   *                                                        43680002
         MVC   HDRBUF(L'HDRAECB),HDRAECB  HEADER TO HEADER BUFFER       43740002
         MVI   HDRLEN,L'HDRAECB    LENGTH OF FIELD HEADER               43800002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              43860002
         LA    R8,TCBAECB          RESERVED ENTRY IN TCB                43920002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      43980002
TCB216S  EQU   *                                                        45120002
         MVC   HDRBUF(L'HDRTIRB),HDRTIRB  HEADER TO HEADER BUFFER       45180002
         MVI   HDRLEN,L'HDRTIRB    LENGTH OF FIELD HEADER               45240002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              45300002
         LA    R8,TCBTIRB          TIRB ENTRY IN TCB                    45360002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      45420002
TCB220S  EQU   *                                                        45480002
         MVC   HDRBUF(L'HDRBACK),HDRBACK  HEADER TO HEADER BUFFER       45540002
         MVI   HDRLEN,L'HDRBACK    LENGTH OF FIELD HEADER               45600002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              45660002
         LA    R8,TCBBACK          BACK ENTRY IN TCB                    45720002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      45780002
TCB224S  EQU   *                                                        45840002
         MVC   HDRBUF(L'HDRRTWA),HDRRTWA HEADER TO HEADER BUFFER        45890002
         MVI   HDRLEN,L'HDRRTWA    LENGTH OF FIELD HEADER               45892002
         MVI   FLDLEN,FOUR         NO BYTES IN THE FIELD                45894002
         LA    R8,TCBRTWA          RTWA ENTRY IN TCB                    45896002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      46140002
TCB228S  EQU   *                                                        46200002
         MVC   HDRBUF(L'HDRIOTIM),HDRIOTIM  HEADER TO HEADER BUFFER     46260002
         MVI   HDRLEN,L'HDRIOTIM   LENGTH OF FIELD HEADER               46320002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              46380002
         LA    R8,TCBIOTIM         IOTIM ENTRY IN TCB                   46440002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      46500002
TCB232S  EQU   *                                                        46560002
         MVC   HDRBUF(L'HDRTMSAV),HDRTMSAV  HEADER TO HEADER BUFFER     46620002
         MVI   HDRLEN,L'HDRTMSAV   LENGTH OF FIELD HEADER               46680002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              46740002
         LA    R8,TCBTMSAV         TMSAV ENTRY IN TCB                   46800002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      46860002
TCB236S  EQU   *                                                        46920002
         MVC   HDRBUF(L'HDRABCUR),HDRABCUR  HEADER TO HEADER BUFFER     46980002
         MVI   HDRLEN,L'HDRABCUR   LENGTH OF FIELD HEADER               47040002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              47100002
         LA    R8,TCBABCUR         TMSAV ENTRY IN TCB                   47160002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      47220002
TCB237S  EQU   *                   RESERVED ROUTINE                     47270002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      47320002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               47370002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              47420002
         LA    R8,TCBABCUR+ONE     RESERVED FIELD IN TCB                47470002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      47520002
TCB238S  EQU   *                                                        47640002
         MVC   HDRBUF(L'HDRTID),HDRTID  HEADER TO HEADER BUFFER         47700002
         MVI   HDRLEN,L'HDRTID     LENGTH OF FIELD HEADER               47760002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              47820002
         LA    R8,TCBTID           TID ENTRY IN TCB                     47880002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      47940002
TCB239S  EQU   *                                                        48000002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       48060002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               48120002
         MVI   FLDLEN,FIVE         NO. BYTES IN THIS FIELD              48180002
         LA    R8,TCBTID+ONE       RESERVED ENTRY IN TCB                48240002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      48300002
TCB244S  EQU   *                                                        49080002
         MVC   HDRBUF(L'HDRFOE),HDRFOE  HEADER TO HEADER BUFFER         49140002
         MVI   HDRLEN,L'HDRFOE     LENGTH OF FIELD HEADER               49200002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49260002
         LA    R8,TCBFOE           FOE ENTRY IN TCB                     49320002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49380002
TCB248S  EQU   *                                                        49440002
         MVC   HDRBUF(L'HDRSWA),HDRSWA  HEADER TO HEADER BUFFER         49500002
         MVI   HDRLEN,L'HDRSWA     LENGTH OF FIELD HEADER               49560002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49620002
         LA    R8,TCBSWA           SWA ENTRY IN TCB                     49680002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49740002
TCB249S  EQU   *                                                        49790002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       49792002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               49794002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49796002
         LA    R8,TCBSWA+FOUR      RSVD ENTRY IN TCB                    49798002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49798402
TCB250S  EQU   *                                                        49798802
         MVC   HDRBUF(L'HDRTCBID),HDRTCBID  HEADER TO HEADER BUFFER     49799202
         MVI   HDRLEN,L'HDRTCBID   LENGTH OF FIELD HEADER               49799602
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49799702
         LA    R8,TCBTCBID         TCBID ENTRY IN TCB                   49799802
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49799902
TCB251S  EQU   *                                                        49819902
         MVC   HDRBUF(L'HDRRTM12),HDRRTM12  HEADER TO HEADER BUFFER     49829902
         MVI   HDRLEN,L'HDRRTM12   LENGTH OF FIELD HEADER               49839902
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49846602
         LA    R8,TCBRTM12         GTFA ENTRY IN TCB                    49848602
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49850602
TCB2511S EQU   *                                                        49852602
         MVC   HDRBUF(L'HDRESTAE),HDRESTAE  HEADER TO HEADER BUFFER     49853002
         MVI   HDRLEN,L'HDRESTAE   LENGTH OF FIELD HEADER               49853102
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49853202
         LA    R8,TCBESTAE         ESTAE ENTRY IN TCB                   49869902
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49879902
TCB2512S EQU   *                                                        49881902
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       49883902
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               49885902
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49886302
         LA    R8,TCBESTAE+FOUR    RSVD ENTRY IN TCB                    49886402
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49886502
TCB2513S EQU   *                                                        49892102
         MVC   HDRBUF(L'HDRCCPVI),HDRCCPVI  HEADER TO HEADER BUFFER     49894102
         MVI   HDRLEN,L'HDRCCPVI   LENGTH OF FIELD HEADER               49896102
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              49896502
         LA    R8,TCBCCPVI         CCPVI ENTRY IN TCB                   49896902
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49897302
TCB2514S EQU   *                                                        49897402
         MVC   HDRBUF(L'HDRAFFN),HDRAFFN  HEADER TO HEADER BUFFER       49897502
         MVI   HDRLEN,L'HDRAFFN    LENGTH OF FIELD HEADER               49897602
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              49903202
         LA    R8,TCBAFFN          AFFN ENTRY IN TCB                    49905202
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49907202
TCB2515S EQU   *                   FBYT1 ROUTINE                        49907602
         MVC   HDRBUF(L'HDRFBYT1),HDRFBYT1   HEADER TO HEADER BUFFER    49908002
         MVI   HDRLEN,L'HDRFBYT1   LENGTH OF FIELD HEADER               49908402
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              49908502
         LA    R8,TCBFBYT1         FBYT1 FIELD IN TCB                   49908602
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49908702
TCB2517S EQU   *                   RESERVED ROUTINE                     49944002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      49946002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               49946402
         MVI   FLDLEN,EIGHTEEN     NO. BYTES IN THIS FIELD              49946802
         LA    R8,TCBFBYT2+ONE     RESERVED FIELD IN TCB                49951502
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49953502
TCB252S  EQU   *                                                        49956402
         MVC   HDRBUF(L'HDRTFLG),HDRTFLG  HEADER TO HEADER BUFFER       49961102
         MVI   HDRLEN,L'HDRTFLG    LENGTH OF FIELD HEADER               49965802
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              49980002
         LA    R8,TCBTFLG          TFLG ENTRY IN TCB                    50040002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      50100002
TCB253S  EQU   *                                                        50160002
         MVC   HDRBUF(L'HDRGTFA),HDRGTFA  HEADER TO HEADER BUFFER       50220002
         MVI   HDRLEN,L'HDRGTFA    LENGTH OF FIELD HEADER               50280002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              50340002
         LA    R8,TCBGTFA          GTFA ENTRY IN TCB                    50400002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      50460002
TCB254S  EQU   *                   RESERVED ROUTINE                     50510002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      50560002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               50610002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              50660002
         LA    R8,TCBGTFA+THREE    RESERVED FIELD IN TCB                50710002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      50760002
TCB257S  EQU   *                                                        50880002
         MVC   HDRBUF(L'HDRRCMP),HDRRCMP  HEADER TO HEADER BUFFER       50940002
         MVI   HDRLEN,L'HDRRCMP    LENGTH OF FIELD HEADER               51000002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              51060002
         LA    R8,TCBRCMP          RCMP ENTRY IN TCB                    51120002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      51180002
TCB258S  EQU   *                   RESERVED ROUTINE                     51230002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER FUFFER      51232002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF THIS HEADER FIELD          51234002
         MVI   FLDLEN,TWENTY4      NO. BYTES IN THIS FIELD              51236002
         LA    R8,TCBRCMP+THREE    RESERVED FIELD IN TCB                51238002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      51238402
         SPACE 2                                                        51240002
CNT      EQU   (*-TCB000S)/22                                           51300002
         EJECT                                                          51360002
FLDOUTPT EQU   *                                                        51420002
         L     R10,OUTBUF          POINT TO OUTPUT BUFFER               51480002
         CLI   NOFLDFLG,HEX00      IS NO FIELDS FLAG SET                51530002
         BE    FIELDSON            NO, BRANCH TO CONTINUE               51532002
         CLC   HDRBUF(FOUR),HDRTFLG IS THIS THE TFLG FIELD              51534002
         BNE   FIELDSON            NO, BRANCH TO CONTINUE               51536002
         MVI   EXTENTFG,HEXFF      SET ENTENT FLAG ON                   51538002
         B     GRSFIELD            BRANCH TO OUTPUT TCB EXTENT HDR      51538402
FIELDSON EQU   *                                                        51538802
         CLC   HDRBUF(THREE),HDRGRS  IS THIS THE GRS FIELD              51540002
         BE    GRSFIELD            YES...                               51600002
         SPACE                                                          51660002
         SR    R7,R7               NO, CLEAR OUT REGISTER               51720002
         IC    R7,FLDLEN           LOAD LENGTH OF FIELD                 51780002
         AR    R7,R7               WILL BE TWICE AS LONG WHEN CONVERTED 51840002
*                                  TO PRINTABLE HEXADECIMAL             51900002
         SR    R11,R11             CLEAR OUT REGISTER                   51960002
         IC    R11,HDRLEN          LOAD HEADER LENGTH                   52020002
         CR    R7,R11              WHICH IS LONGER                      52080002
         BH    LENTHSET            BRANCH IF FIELD OUTPUT IS LONGER     52140002
HDRLONGR EQU   *                                                        52200002
         IC    R7,HDRLEN           HEADER IS LONGER                     52260002
LENTHSET EQU   *                                                        52320002
         AR    R7,R2               ADD LENGTH TO CURRENT OFFSET         52380002
         C     R7,LINELEN          WILL FIELD FIT IN LINE               52440002
         BNH   MOREROOM            IF LINE IS NOT FULL GO TO MOREROOM   52500002
OUTPTBUF EQU   *                                                        52560002
         SR    R7,R2               BUFFER IS FULL...GET CURRENT         52620002
*                                  FIELD LENGTH                         52680002
         BAL   R14,TCBIO           OUTPUT THE FIELD HEADERS             52740002
         EX    R2,MOVEINS3         MOVE FIELDS TO OUTPUT BUFFER         52800002
         BAL   R14,TCBIO           OUTPUT THE FIELDS                    52860002
         SPACE                                                          52920002
         BAL   R14,IOSPACE         GO SKIP A LINE                       52980002
         SPACE                                                          53040002
         SR    R2,R2               RESET OUTPUT COUNTER                 53100002
*********************************************************************** 53160002
*        THE FOLLOWING CODE WILL CONVERT A FIELD OF THE TCB TO        * 53220002
*        PRINTABLE HEX, STORE IT IN A TEMPORARY BUFFER, AND MOVE THE  * 53280002
*        CORRESPONDING HEADER TO THE OUTPUT BUFFER.                   * 53340002
*********************************************************************** 53400002
MOREROOM EQU   *                                                        53460002
         LR    R11,R8              GET ADDR OF TCB FIELD                53520002
GRSENTRY EQU   *                                                        53580002
         SR    R1,R1               GET LENGTH                           53630002
         IC    R1,FLDLEN           * OF FIELD TO CONVERT                53632002
         AR    R1,R11              * PLUS START OF FIELD                53632402
         BCTR  R1,R0               * - 1 = END OF FIELD                 53634002
PROTBLO1 EQU   *                   PROT CHECK HERE, IF ABEND            53636002
         IC    R1,ZERO(R1)         FORCE PROT CHK HERE IF BAD           53638002
PROTBLO2 EQU   *                   PROT CHECK HERE, IF ABEND.           53638102
*                                                                       53638402
         ST    R11,STRNGPTR        STORE ADDRESS IN PDE FOR IKJEGCVT    53640002
         MVC   LENGTH+ONE(ONE),FLDLEN   SAVE FIELD LENGTH               53700002
         MVI   FLAGS,FLAG          X'80' TO INDICATE VALUE CONVERT      53760002
         MVI   TYPECODE,TYPE       X'04' TO INDICATE CONVERT TO HEX     53820002
         SPACE                                                          53880002
         LA    R1,STRNGPTR         POINT TO TCB FIELD TO BE CONVERTED   53940002
         LCR   R0,R1               R0 NEGATIVE FOR CONVERSION FROM      54000002
*                                  BINARY TO PRINTABLE HEX              54060002
         L     R15,TSTCONVT        GET ADDR OF CONVERT                  54120002
         BALR  R14,R15             GO TO IKJEGCVT                       54180002
         LPR   R1,R1               RESTORE REGISTER 1 TO POSITIVE       54240002
         LTR   R15,R15             RETURN CODE FROM IO A ZERO           54300002
         BNZ   SEVRET              NO, GO HANDLE SERVICE ROUTINE CODE   54360002
         SPACE                                                          54420002
         L     R1,OUTBUF           YES, POINT TO OUTPUT BUFFER          54480002
         LA    R1,EIGHTY4(R1)      POINT TO FIELD BUFFER                54540002
         AR    R1,R2               ADD DISPLACEMENT                     54600002
         L     R15,CONAREA         GET CONVERTED FIELD                  54660002
         SPACE                                                          54720002
         SR    R14,R14             CLEAR OUT REGISTER                   54780002
         IC    R14,FLDLEN          GET FIELD LENGTH                     54840002
         AR    R14,R14             HEX REPRESENTATION OF FIELD WILL     54900002
*                                  BE DOUBLE ITS BINARY LENGTH          54960002
         BCTR  R14,R0              SUBTRACT ONE FOR MOVE INST           55020002
         EX    R14,MOVEINS1        MOVE CONVERTED FIELD TO WORKAREA     55080002
         IC    R14,HDRLEN          GET HEADER LENGTH                    55140002
         BCTR  R14,R0              SUBTRACT ONE FOR MOVE INST           55200002
         LR    R1,R10              GET ADDR OF HDR OUTPUT BUFFER        55260002
         AR    R1,R2               ADD CURRENT DISPLACEMENT             55320002
         EX    R14,MOVEINS2        MOVE HEADER TO OUTPUT BUFFER         55380002
         LR    R2,R7               UPDATE OUTPUT LINE LENGTH COUNTER    55440002
         LA    R2,TWO(R2)          TWO SPACES BETWEEN FIELDS            55500002
         CLI   GRSFLAG1,HEX00      GRS FIELD BEING PROCESSED            55560002
         BNE   GRSCHECK            YES...                               55620002
         LA    R6,TWO(R6)          NO, POINT TO NEXT PDE                55680002
         C     R6,ENDPDECK         ANY MORE FIELDS TO PROCESS           55740002
         BE    PDLEND              NO, GO FINISH UP                     55800002
         B     PDECHECK            YES, CHECK NEXT PDE                  55860002
*********************************************************************** 55920002
*        THE FOLLOWING CODE WILL PRINT OUT THE CONTENTS OF THE GENERAL* 55980002
*        REGISTER SAVE AREA                                           * 56040002
*********************************************************************** 56100002
GRSFIELD EQU   *                                                        56160002
         LTR   R2,R2               IS THE OUTPUT BUFFER EMPTY           56220002
         BZ    GRSSETUP            YES...DO NOT WRITE OUT BUFFER        56280002
         BAL   R14,TCBIO           NO, PUT OUT HEADERS                  56340002
         EX    R2,MOVEINS3         MOVE FIELDS TO OUTPUT BUFFER         56400002
         BAL   R14,TCBIO           PUT OUT FIELDS                       56460002
         BAL   R14,IOSPACE         GO SKIP A LINE                       56520002
         SPACE                                                          56580002
         SR    R2,R2               RESET LINE COUNTER                   56640002
GRSSETUP EQU   *                                                        56700002
         CLI   EXTENTFG,HEX00      IS EXTENT FLAG SET                   56750002
         BNE   EXTSETUP            YES, BRANCH TO OUTPUT EXT HDR        56752002
         LR    R11,R8              LOAD ADDR OF GRS FIELD               56760002
         MVI   GRSFLAG1,HEX01      INITILIZE COUNT OF REGISTERS         56820002
         MVI   GRSFLAG2,HEX01      AND LINE COUNT TO ONE                56880002
         MVC   FOUR(L'HDRGRS,R10),HDRGRS  MOVE HDR TO OUTPUT BUFFER     56940002
         IC    R2,HDRLEN           SET LENGTH OF OUTPUT                 57000002
         LA    R2,TWO(R2)          ADD 2 TO AVOID TRUNCATION OF HEADER  57060002
         BAL   R14,TCBIO           OUTPUT THE HEADER                    57120002
         MVI   FOUR(R10),BLANK                                          57180002
         MVC   FIVE(L'HDRGRS,R10),FOUR(R10)  CLEAR THE OUTPUT BUFFER    57240002
         SPACE                                                          57300002
         SR    R2,R2               SET OUTPUT LINE COUNT TO ZERO        57360002
         LA    R7,EIGHT            INITILIZE OUTPUT BUFFER OFFSET       57420002
         LA    R4,REGHDRS          PUT HDR OF 1ST REG                   57480002
         MVC   HDRBUF(THREE),ZERO(R4)  INTO OUTPUT BUFFER               57540002
         LA    R4,THREE(R4)        BUMP REG HDR POINTER                 57600002
         B     GRSENTRY            GO PROCESS FIELD                     57660002
         SPACE                                                          57720002
GRSCHECK EQU   *                                                        57780002
         CLI   GRSFLAG1,HEX04      IS THE LINE FULL YET                 57840002
         MVC   HDRBUF(THREE),ZERO(R4)  MOVE NEXT HDR TO OUTPUT BUFFER   57900002
         LA    R4,THREE(R4)        BUMP TO NEXT REG HDR                 57960002
         BE    GRSOUTPT            LINE IS FULL...PUT IT OUT            58020002
         SPACE                                                          58080002
         SR    R14,R14             NO, CLEAR OUT REGISTER               58140002
         IC    R14,GRSFLAG1        BUMP COUNTER FOR                     58200002
         LA    R14,ONE(R14)        NO. REGS PER LINE                    58260002
         STC   R14,GRSFLAG1        SAVE INCREMENTED COUNTER             58320002
         SPACE                                                          58380002
         LA    R11,FOUR(R11)       BUMP TO NEXT GRS FIELD               58440002
         LA    R7,TEN(R7)          BUMP DISPLACEMENT COUNT              58500002
         B     GRSENTRY            GO PROCESS NEXT FIELD                58560002
         SPACE                                                          58620002
GRSOUTPT EQU   *                                                        58680002
*********************************************************************** 58740002
* THIS CODE GOES TO THE TCB IO ROUTINE TO OUTPUT THE GENERAL REGISTERS* 58800002
*********************************************************************** 58860002
         BAL   R14,TCBIO           PUT OUT HEADER                       58920002
         EX    R2,MOVEINS3         MOVE FIELDS TO BUFFER                58980002
         BAL   R14,TCBIO           PUT OUT FIELDS                       59040002
         MVI   FOUR(R10),BLANK     MOVE BLANK TO HDR                    59100002
         MVC   FIVE(ONE59,R10),FOUR(R10)  OUTPUT BUFFER                 59160002
         SR    R14,R14             CLEAR OUT REGISTER                   59220002
         SR    R2,R2               RESET OUTPUT COUNTER                 59280002
         CLI   GRSFLAG2,HEX04      FOUR LINES YET                       59340002
         BE    GRSDONE             YES...                               59400002
         SPACE                                                          59460002
         LA    R7,EIGHT            NO, INIT DISPL FOR NEXT LINE         59520002
         IC    R14,GRSFLAG2        LOAD FLAG                            59580002
         LA    R14,ONE(R14)        BUMP LINE COUNTER                    59640002
         STC   R14,GRSFLAG2        STORE UPDATED FLAG                   59700002
         SPACE                                                          59760002
         LA    R11,FOUR(R11)       BUMP POINTER TO NEXT REGISTER        59820002
         MVI   GRSFLAG1,HEX01      RESET REG FIELD COUNTER              59880002
         B     GRSENTRY            GO PROCESS NEXT REG FIELD            59940002
         SPACE                                                          60000002
GRSDONE  EQU   *                                                        60060002
         LA    R6,TWO(R6)          BUMP TO NEXT PDE                     60120002
         STH   R14,GRSFLAG1        CLEAR OUT BOTH REG COUNTERS          60180002
         SPACE                                                          60240002
         BAL   R14,IOSPACE         GO SKIP A LINE                       60300002
         SPACE                                                          60360002
         B     PDECHECK            GO CHECK FOR MORE PDE'S              60420002
PDLEND   EQU   *                                                        60480002
         LTR   R2,R2               IS THE OUTPUT BUFFER EMPTY           60540002
         BZ    CHKFLD              OUTPUT BUFFER IS EMPTY...CHECK FOR   60600002
*                                  FIELD( ) SITUATION                   60660002
         SPACE                                                          60720002
         BAL   R14,TCBIO           PUT OUT HEADERS                      60780002
         EX    R2,MOVEINS3         MOVE FIELDS TO BUFFER                60840002
         BAL   R14,TCBIO           PUT OUT FIELDS                       60900002
         SPACE                                                          60960002
         BAL   R14,IOSPACE         GO SKIP A LINE                       61020002
         SPACE                                                          61080002
         B     SEVRET              GO CHECK RETURN CODES                61140002
* THIS ROUTINE OUTPUTS 'TCB EXTENT' WHEN ALL TCB IS PRINTED.            61190002
EXTSETUP EQU   *                                                        61194002
         MVC   FOUR(L'HDRTEXT,R10),HDRTEXT HEADER TO OUTPUT BUFFER      61196002
         MVI   HDRLEN,L'HDRTEXT    SET LENGTH OF OUTPUT                 61198002
         IC    R2,HDRLEN           OUTPUT LENGTH TO REG 2               61198402
         LA    R2,TWO(R2)          ADD TWO TO AVOID TRUNCATION          61198802
         BAL   R14,TCBIO           GO OUTPUT HEADER                     61199202
         MVI   FOUR(R10),BLANK     PREPARE TO CLEAR BUFFER              61199602
         MVC   FIVE(L'HDRTEXT,R10),FOUR(R10)  CLEAR OUTPUT BUFFER       61199702
         SR    R2,R2               RESET LINE COUNTER                   61199802
         MVI   EXTENTFG,HEX00      TURN OFF EXTENT FLAG                 61199902
         MVI   NOFLDFLG,HEX00      TURN OFF FIELDS FLAG                 61219902
         B     TCB252S             PICK UP TFLG ENTRY IN TCB            61229902
TCBIO    EQU   *                                                        61240002
*********************************************************************** 61260002
* THIS IS THE IO ROUTINE FOR IKJEGTCB RESPONSIBLE FOR OUTPUTTING FIELD* 61320002
* HEADERS AND FIELD CONTENTS.                                         * 61380002
*********************************************************************** 61440002
         ST    R14,REG14           SAVE REGISTER 14                     61500002
         LA    R1,OUTPTR1          POINT TO PARAMETER LIST              61560002
         L     R0,PRINTFLG         LOAD ADDRESS OF DSNAME PDE IF ANY    61620002
         LA    R14,TWO(R2)                                              61680002
         ST    R10,OUTPTR1         STORE POINTER TO OUTPUT BUFFER       61740002
         STH   R14,ZERO(R10)       STORE LENGTH OF OUTPUT BFFR          61800002
         SR    R14,R14             CLEAR OUT REGISTER                   61860002
TCBIO1   EQU   *                                                        61920002
         ST    R14,OUTPTR2         ZERO OUT SECOND WORD                 61980002
         ST    R14,PRINTFLG        INDICATE OPEN DATA SET NOW           62040002
         XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   62090002
         IKJEGSIO DATA,DATAPTR=(R10),DSNAME=(R0),ID=TCB31,             *62090402
               MF=(E,TSTIOPRM)     CALL IO                              62094002
         LTR   R15,R15             TEST RET CODE FROM IO                62094402
         BNZ   TESTRC1             NOT ZERO, CLEAN UP AND EXIT          62094802
         L     R14,REG14           YES, RESTORE REGISTER 14             62340002
         BR    R14                 RETURN TO MAIN LINE OF MODULE        62400002
         SPACE                                                          62460002
*********************************************************************** 62520002
*                                                                     * 62580002
*        THE FOLLOWING CODE WILL SPACE ONE LINE                       * 62640002
*                                                                     * 62700002
*********************************************************************** 62760002
         SPACE                                                          62820002
IOSPACE  EQU   *                                                        62880002
         MVI   FOUR(R10),BLANK     CLEAR THE                            62940002
         MVC   FIVE(ONE59,R10),FOUR(R10)  OUTPUT BUFFER                 63000002
         SPACE                                                          63060002
         ST    R14,REG14           SAVE RETURN REG                      63120002
         XR    R14,R14             CLEAR OUT REGISTER                   63180002
         ST    R14,ZERO(R10)       ZERO LENGTH TO SPACE ONE LINE        63240002
         LA    R1,OUTPTR1          POINT TO PARAMETER LIST              63300002
         B     TCBIO1              GO SKIP A LINE                       63360002
*                                                                     * 63420002
*********************************************************************** 63480002
*   THE FOLLOWING CODE PROCESSES THE VARIOUS RETURN CODES AND         * 63540002
*   INITIALIZES TO PRINT ANY NECESSARY MESSAGES.                      * 63600002
*********************************************************************** 63660002
CHKFLD   EQU   *                                                        63720002
         L     R14,REG14           CHECK IF 'FIELD( )' WAS              63780002
         LTR   R14,R14             SPECIFIED...IF SO, THE TCBIO RTN     63840002
*                                  WAS NOT ENTERED & REG14 = 0.         63900002
         BNZ   RETURN              OK...RETURN                          63960002
         SPACE                                                          64020002
         LA    R2,M0016            MSG-TCB FIELD NAME REQUIRED          64070002
         LA    R3,ZERO             NO SECOND LEVEL MESSAGE              64072002
         B     MSG1                GO OUTPUT THE MESSAGE                64074002
         SPACE                                                          64320002
         SPACE                                                          64380002
TCBRET1  EQU   *                   PARSE RETURN CODE                    64440002
         AR    R15,R15             DOUBLE FOR PROPER ADDRESSING         64500002
         LA    R3,PARSETAB(R15)    POINT TO CORRECT SECTION IN TABLE    64560002
         BR    R3                  GO TO PROPER SECTION FOR R.C.        64740002
PARSETAB EQU   *                                                        64800002
         NOP   PARSETAB            RC=0, NEVER EXECUTED                 64860002
         NOP   PARSETAB            RC=0, NEVER EXECUTED                 64920002
         B     FLUSHIT             INDICATE IKJEGMNL SHOULD FLUSH STACK 64980002
         NOP   PARSETAB            PUT IN FOR ALIGNMENT PURPOSES        65040002
         LA    R15,SIXTEEN         RC=8, ATTENTION                      65100002
         B     RETURN              RETURN TO IKJEGMNL                   65160002
         LA    R2,M0104            RC=12, MSG-TCB FAILED                65210002
         B     RC12MSG             BRANCH TO SET UP REST OF IO          65212002
         LA    R2,M0103            RC=16, MSG-NOT ENOUGH CORE           65214002
         B     RC16MSG             BRANCH TO SET UP REST OF IO          65216002
         B     CHKRTN              RC=20-CHECK SERVICE RTN RETURN CODE  65460002
         NOP   PARSETAB            NOT EXECUTED                         65520002
RC12MSG  LA    R3,M0277            MSG-PARSE ERROR CODE 12              65570002
         B     MSG4                GO OUTPUT THE MESSAGES               65572002
RC16MSG  LA    R3,ZERO             NO SECOND LEVEL MESSAGE              65574002
         B     MSG1                GO OUTPUT THE MESSAGE                65576002
CHKRTN   EQU   *                                                        66180002
         L     R15,REG15           PUT SAVED RETURN CODE INTO REG 15    66240002
SEVRET   EQU   *                                                        66300002
         CH    R15,ATTNCODE        COMPARE RET CODE TO 16               66350002
         BNL   RETURN              RET CODE IS 16 OR GREATER            66352002
         B     RETURN0             RET CODE IS LESS THAN 16             66354002
         SPACE                                                          66900002
RETURN   EQU   *                                                        66960002
         LR    R2,R15              SAVE RET CODE OVER ESTAE             66970002
         ESTAE 0                   REMOVE ESTAE REQUEST                 67010002
         LR    R15,R2              RESTORE RET CODE                     67010402
         NI    TSTFLGS4,HEXFF-TSTRERTN  SHUT OFF RETRY FLAG             67012002
RETURNS  EQU   *                   RETURN TO MAINLINE                   67014002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)  TURN OFF PRINT FLG            67020002
         L     R13,FOUR(R13)       RESTORE IKJEGMNL REGISTERS AND       67080002
         RETURN (14,12),T,RC=(15)  RETURN TO MAINLINE                   67140002
FLUSHIT  EQU   *                                                        67200002
         OI    TSTFLGS4,TSTFLUSH   INDICATE TO IKJEGMNL TO FLUSH STACK  67260002
RETURN0  EQU   *                                                        67320002
         XR    R15,R15             SET RETURN CODE TO 0                 67380002
         B     RETURN              GO RETURN TO IKJEGMNL                67440002
         EJECT                                                          67500002
*  ENTRY POINT TO THE STAE RETRY ROUTINE.  ENTERED FROM IKJEGSTA     *  67560002
         SPACE                                                          67620002
TCBRTRY  EQU   *                                                        67680002
         USING *,R15                                                    67740002
         L     R4,CVTADDR          LOAD ADDRESS OF CVT                  67800002
         USING CVTDSECT,R4         ESTABLISH ADDRESSABILITY             67860002
         L     R4,CVTTCBP          LOAD ADDRESS OF TCB POINTERS         67920002
         DROP  R4                  RELEASE REG 4                        67980002
         L     R4,ZERO(R4)         LOAD ADDRESS OF TEST TCB             68040002
         USING TCB,R4              ESTABLISH ADDRESSABILITY             68100002
         L     R9,TCBTRN           LOAD ADDRESS OF TCOMTAB              68160002
         L     R12,TCBADR                                               68220002
         USING IKJEGTCB,R12                                             68280002
         DROP  R15                                                      68340002
         DROP  R4                  RELEASE REG 4                        68400002
         L     R13,REGSAVE2        POINT TO TCB REGISTERS               68700002
         LA    R15,TWENTY          SET RETURN CODE                      68760002
         B     RETURN              RETURN TO IKJEGMNL                   68820002
ICTABLE  EQU   *                                                        68880002
         DC    AL1(I0099),AL3(PARSEBLO)  *                              68940002
         DC    AL1(I0097),AL3(PROTBLO1)   *                             68990002
         DC    AL1(I0097),AL3(PROTBLO2)   *                             68992002
         DC    AL1(HEXFF)                   *                           69000002
         SPACE 1                                                        69170002
CONSTANT DC    50C'Z'              PATCH AREA                           69220002
ATTNCODE DC    H'16'               HALFWORD OF 16                       69270002
         EJECT                                                          69420002
* THE FOLLOWING ARE MESSAGE OUTPUTTING ROUTINES.                        69470002
MSG1     XC    TSTIOPRM,TSTIOPRM   CLEAR THE PARAMETER AREA             69472002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=TCB31,                 *69474002
               MF=(E,TSTIOPRM)     CALL IO                              69476002
TESTRC1  CH    R15,ATTNCODE        IS RET CODE LESS 16                  69478002
         BNL   RETURN              NO, RETURN                           69478402
         B     RETURN0             YES, SET RC=0, RETURN                69478802
         SPACE                                                          69479202
MSG2     XC    TSTIOPRM,TSTIOPRM   CLEAR THE PARAMETER AREA             69479602
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *69479702
               ID=TCB31,MF=(E,TSTIOPRM)  CALL IO                        69479802
TESTRC2  CH    R15,ATTNCODE        IS RET CODE LESS 16                  69479902
         BNL   SET12               NO, GIVE RC=12 TO PARSE              69499902
         B     SET8                YES, GIVE RC=8 TO PARSE              69509902
         SPACE                                                          69519902
MSG3     XC    TSTIOPRM,TSTIOPRM   CLEAR PARAMETER AREA                 69526602
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *69528602
               INST21=(NUM,I0003),ID=TCB31,MF=(E,TSTIOPRM)              69530602
         B     TESTRC2             BRANCH TO TEST RET CODE              69531002
         SPACE                                                          69533202
MSG4     XC    TSTIOPRM,TSTIOPRM   CLEAR PARAMETER AREA                 69549902
         IKJEGSIO MSG,FIRST=(R2),INST11=(NUM,I0008),SECOND=(R3),       *69559902
               ID=TCB31,MF=(E,TSTIOPRM)  CALL IO                        69561902
         B     TESTRC1             BRANCH TO TEST RET CODE              69562302
         SPACE                                                          69566402
LINKFAIL XC    TSTIOPRM,TSTIOPRM   CLEAR PARAMETER AREA                 69566502
         LR    R3,R1               ABEND CODE TO REG 3                  69572102
         LR    R4,R15              RET CODE TO REG 4                    69574102
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R3),RC=(R4),                   *69576202
               ID=TCB31,INST11=(NUM,I0040),MF=(E,TSTIOPRM) CALL IO      69576502
         B     TESTRC1             BRANCH TO TEST RET CODE              69576602
         SPACE                                                          69577002
LISTESTA IKJEGSPL RTRY=TCBRTRY,ABNTB=ICTABLE,MODNM=IKJEGTCB,           *69577402
               TNM=LISTTCB  BUILD PARAMETER LIST FOR ESTAE              69581902
         EJECT                                                          69586502
MYWKAREA DSECT                                                          69591002
* IT IS ESSENTIAL THAT THE FOLLOWING 7 AREAS BE CONTIGUOUS AND IN ORDER 69595502
STAESTUF DS    4F                  AREA FOR STAE LIST                   69600002
GRSFLAG1 DS    CL1                 TCBGRS FIELD FLAG                    69660002
GRSFLAG2 DS    CL1                 TCBGRS FIELD FLAG                    69720002
FLDLEN   DS    CL1                 LENGTH OF TCB FIELD                  69780002
HDRLEN   DS    CL1                 LENGTH OF HEADER                     69840002
HDRBUF   DS    2F                  BUFFER FOR HEADER                    69900002
LINELEN  DS    1F                  OUTPUT LINE LENGTH                   69960002
ENDPDECK DS    1F                  ADDR OF LAST FIELD PDE +2            70020002
PRINTFLG DS    1F                  ADDR OF DSNAME PDE                   70080002
REG14    DS    1F                  REGISTER 14                          70140002
REG15    DS     F                  RETURN CODE FROM SERVICE             70200002
NOFLDFLG DS    CL1                 NO FIELDS SPECIFIED FLAG             70250002
EXTENTFG DS    CL1                 EXTENT PRINTED FLAG                  70252002
*                                  ROUTINE SAVEAREA                     70260002
* IT IS ESSENTIAL THAT THE FOLLOWING 4 AREAS BE CONTIGUOUS AND IN ORDER 70320002
STRNGPTR DS    1F                  PT TO FIELD TO BE CONVERTED          70380002
LENGTH   DS    CL2                 LENGTH OF FIELD TO BE CONVERTED      70440002
FLAGS    DS    CL1                 FLAG FOR IKJEGCVT                    70500002
TYPECODE DS    CL1                 TYPE OF DATA TO BE CONVERTED (HEX)   70560002
* IT IS ESSENTIAL THAT THE FOLLOWING 2 AREAS BE CONTIGUOUS AND IN ORDER 70620002
OUTPTR1  DS    1F                  PT TO FIRST OUTPUT BUFFER            70680002
OUTPTR2  DS    1F                  PT TO SECOND LEVEL MSG IF ANY        70740002
TEMP3    DS    3F                  WORK AREA FOR SVC 97                 70790002
         EJECT                                                          70800002
IKJEGTCB CSECT                                                          74760002
** THE DECLARED CONSTANTS FOR THE IKJEGTCB MODULE.                  **  74820002
HDRRBP   DC    C'RBP'              RBP HEADER OF TCB                    74880002
HDRPIE   DC    C'PIE'              PROGRAM INTERRUPT ELEMENT HDR        74940002
HDRDEB   DC    C'DEB'              DATA EXTENT BLOCK HDR                75000002
HDRTIO   DC    C'TIO'              TASK I/O HEADER                      75060002
HDRCMP   DC    C'CMP'              TASK COMPLETION CODE HDR             75120002
HDRTRN   DC    C'TRN'              TESTRAN HDR                          75180002
HDRMSS   DC    C'MSS'              SUBPOOL SPQE HDR                     75240002
HDRPKF   DC    C'PKF'              PROTECTION KEY HDR                   75300002
HDRFLGS  DC    C'FLGS'             MISC FLAGS HDR                       75360002
HDRLMP   DC    C'LMP'              LIMIT PRIORITY HDR                   75420002
HDRDSP   DC    C'DSP'              DISPATCHING PRIORITY HDR             75480002
HDRLLS   DC    C'LLS'              LOAD LIST ADDR HDR                   75540002
HDRJLB   DC    C'JLB'              JOBLIB DCB ADDR HDR                  75600002
HDRJPQ   DC    C'JPQ'              JOB PACK CDE ADDR HDR                75660002
HDRGRS   DC    C'GRS'              GENERAL REGISTER HDR                 75720002
HDRQEL   DC    C'QEL'              ENQUEUE COUNT HDR                    75780002
HDRFSAB  DC    C'FSAB'             FIRST PARM SAVE AREA ADDR HDR        75840002
HDRTCB   DC    C'TCB'              DAUGHTER TCB ADDR HDR                75900002
HDRTME   DC    C'TME'              TIMER ADDR HDR                       75960002
HDRJSTCB DC    C'JSTCB'            JOB STEP TCB ADDR HDR                76020002
HDRNTC   DC    C'NTC'              PREVIOUS SUBTASK TCB ADDR HDR        76080002
HDROTC   DC    C'OTC'              ORIGINATING TCB ADDR HDR             76140002
HDRLTC   DC    C'LTC'              SUBTASK LAST TCB ADDR HDR            76200002
HDRIQE   DC    C'IQE'              IQE ADDR HDR                         76260002
HDRECB   DC    C'ECB'              EVENT CONTROL BLOCK ADDR HDR         76320002
HDRTSFLG DC    C'TSFLG'            FLAG HDR                             76380002
HDRSTPCT DC    C'STPCT'            STPCT HDR                            76440002
HDRTSLP  DC    C'TSLP'             TSLP HDR                             76500002
HDRTSDP  DC    C'TSDP'             TSDP HDR                             76560002
HDRPQE   DC    C'PQE'              PARTITION QUEUE ELEMENT ADDR HDR     76620002
HDRAQE   DC    C'AQE'              ALLOCATED QUEUE ELEMENT ADDR HDR     76680002
HDRNSTAE DC    C'NSTAE'            STAE FLAGS HDR                       76740002
HDRSTABB DC    C'STABB'            CURRENT STAE ADDR HDR                76800002
HDRTCTR  DC    C'TCTR'             TCT FLAG HDR                         76860002
HDRTCT   DC    C'TCT'              TIMING CONTROL TABLE ADDR HDR        76920002
HDRUSER  DC    C'USER'             USER FIELD HDR                       76980002
HDRNDSP0 DC    C'NDSP0'            -                                    77040002
HDRNDSP1 DC    C'NDSP1'            NON - DISPATCHABILITY                77100002
HDRNDSP2 DC    C'NDSP2'            HEADERS                              77160002
HDRNDSP3 DC    C'NDSP3'            HEADER                               77220002
HDRRSVD  DC    C'RESERVED'         RESERVED WORD HEADER                 77280002
HDRJSCB  DC    C'JSCB'             JOB STEP CONTROL BLOCK ADDR HDR      77340002
HDREXT1  DC    C'EXT1'             ADDR OS-AOS COMMON TCB EXTENSION     77400002
HDRNDSP4 DC    C'NDSP4'            SECONDARY NONDISPATCHABILITY FLAGS   77460002
HDRNDSP5 DC    C'NDSP5'            SEC NON FLAGS UNIQUE TO AOS/2        77520002
HDRFLGS6 DC    C'FLGS6'            TASK RELATED FLAGS COMMON TO AOS1-2  77580002
HDRFLGS7 DC    C'FLGS7'            TASK RELATED FLAGS UNIQUE TO AOS2    77640002
HDRDAR   DC    C'DAR'              DAMAGE ASSESSMENT RTN HDR            77700002
HDREXT2  DC    C'EXT2'             ADDR AOS1-AOS2 COMMON TCB EXTENSION  77760002
HDRTIRB  DC    C'TIRB'             ADDRESS OF TIRB FOR TASK             78000002
HDRBACK  DC    C'BACK'             ADDR OF PREVIOUS TCB ON READY QUE    78060002
HDRRTWA  DC    C'RTWA'             ADDR OF CURRENT RTM2 WORKAREA        78170002
HDRIOTIM DC    C'IOTIM'            TIME                                 78180002
HDRTMSAV DC    C'TMSAV'            TIME                                 78240002
HDRABCUR DC    C'ABCUR'            ABEND RECURSION BYTE                 78300002
HDRSYSCT DC    C'SYSCT'            'SYSTEM MUST CONPLETE' COUNT         78360002
HDRTID   DC    C'TID'              TASK ID NUMBER                       78420002
HDRFOE   DC    C'FOE'              @ 1ST FIX OWNERSHIP ELEMENT          78600002
HDRSWA   DC    C'SWA'              ADDRESS OF 1ST SCHEDULER WORK AREA   78660002
HDRTFLG  DC    C'TFLG'             GTF FLAG BYTE                        78720002
HDRGTFA  DC    C'GTFA'             ADDRESS OF TEMPORARY TRACE BUFFER    78780002
HDRRCMP  DC    C'RCMP'             ABTERM COMP CODE ON VALID STAE REC   78840002
HDRDDEXC DC    C'DDEXC'            DDEXC HEADER                         78890002
HDRDDWTC DC    C'DDWTC'            DDWTC HEADER                         78892002
HDRIOBRC DC    C'IOBRC'            IOBRC HEADER                         78894002
HDRSTMCT DC    C'STMCT'            STMCT HEADER                         78896002
HDRAECB  DC    C'AECB'             AECB HEADER                          78898002
HDRTCBID DC    C'TCBID'            TCBID HEADER                         78898402
HDRRTM12 DC    C'RTM12'            RTM12 HEADER                         78898802
HDRESTAE DC    C'ESTAE'            ESTAE HEADER                         78899202
HDRCCPVI DC    C'CCPVI'            CCPVI HEADER                         78899602
HDRAFFN  DC    C'AFFN'             AFFN HEADER                          78899702
HDRFBYT1 DC    C'FBYT1-2'            FBYT1 HEADER                       78899802
HDRTEXT  DC    C'TCB EXTENT'       TCB EXTENT HEADER                    78919902
         SPACE 1                                                        78940002
TCBADR   DC    A(IKJEGTCB)         ADDRESS OF BEGINNING OF MODULE       78960002
         SPACE                                                          79080002
PARSADR  DC    V(IKJEGPCL)         ADDR OF PARAMETER LIST FOR PARSE     79140002
MOVEINS1 MVC   ZERO(ZERO,R1),ONE(R15)   MOVE CONVERTED FIELDS           79260002
MOVEINS2 MVC   FOUR(ZERO,R1),HDRBUF     MOVE HEADER TO OUTPUT BUFFER    79320002
MOVEINS3 MVC   FOUR(ZERO,R10),EIGHTY4(R10)  INST TO MOVE TCB FIELDS     79380002
*                                  TO OUTPUT BUFFER                     79440002
         DS    0F                                                       79560002
REGHDRS  DC    C'R0 R1 R2 R3 '     REGISTER HEADERS                     79620002
         DC    C'R4 R5 R6 R7 '     *                                    79680002
         DC    C'R8 R9 R10R11'     *                                    79740002
         DC    C'R12R13R14R15'     *                                    79800002
         EJECT                                                          79860002
IKJEGPCL IKJPARM                                                        79920002
ADDRTCB  IKJKEYWD                                                       79980002
         IKJNAME  'ADDR',SUBFLD=TCBADDR                                 80040002
PRINTIT  IKJKEYWD                                                       80100002
         IKJNAME   'PRINT',SUBFLD=DSNAME                                80160002
TCBFIELD IKJKEYWD                                                       80220002
         IKJNAME   'FIELD',SUBFLD=FIELDNAM                              80280002
DSNAME   IKJSUBF                                                        80340002
DSNAM    IKJPOSIT  DSNAME,PROMPT='DSNAME'                               80400002
TCBADDR  IKJSUBF                                                        80460002
ADDRESS  IKJPOSIT  ADDRESS,VALIDCK=IKJEGVCK,PROMPT='ADDRESS'            80520002
FIELDNAM IKJSUBF                                                        80580002
RBP      IKJKEYWD                                                       80640002
         IKJNAME   'TCBRBP'                                             80700002
PIE      IKJKEYWD                                                       80760002
         IKJNAME   'TCBPIE'                                             80820002
DEB      IKJKEYWD                                                       80880002
         IKJNAME   'TCBDEB'                                             80940002
TIO      IKJKEYWD                                                       81000002
         IKJNAME   'TCBTIO'                                             81060002
CMP      IKJKEYWD                                                       81120002
         IKJNAME   'TCBCMP'                                             81180002
TRN      IKJKEYWD                                                       81240002
         IKJNAME   'TCBTRN'                                             81300002
MSS      IKJKEYWD                                                       81360002
         IKJNAME   'TCBMSS'                                             81420002
PKF      IKJKEYWD                                                       81480002
         IKJNAME   'TCBPKF'                                             81540002
FLGS     IKJKEYWD                                                       81600002
         IKJNAME   'TCBFLGS'                                            81660002
LMP      IKJKEYWD                                                       81720002
         IKJNAME   'TCBLMP'                                             81780002
DSP      IKJKEYWD                                                       81840002
         IKJNAME   'TCBDSP'                                             81900002
LLS      IKJKEYWD                                                       81960002
         IKJNAME   'TCBLLS'                                             82020002
JLB      IKJKEYWD                                                       82080002
         IKJNAME   'TCBJLB'                                             82140002
JPQ      IKJKEYWD                                                       82200002
         IKJNAME   'TCBJPQ'                                             82260002
GRS      IKJKEYWD                                                       82320002
         IKJNAME   'TCBGRS'                                             82380002
QEL      IKJKEYWD                                                       82440002
         IKJNAME   'TCBQEL'                                             82500002
FSAB     IKJKEYWD                                                       82560002
         IKJNAME   'TCBFSAB'                                            82620002
TCB1     IKJKEYWD                                                       82680002
         IKJNAME   'TCBTCB'                                             82740002
TME      IKJKEYWD                                                       82800002
         IKJNAME   'TCBTME'                                             82860002
JSTCB    IKJKEYWD                                                       82920002
         IKJNAME   'TCBJSTCB'                                           82980002
NTC      IKJKEYWD                                                       83040002
         IKJNAME   'TCBNTC'                                             83100002
OTC      IKJKEYWD                                                       83160002
         IKJNAME   'TCBOTC'                                             83220002
LTC      IKJKEYWD                                                       83280002
         IKJNAME   'TCBLTC'                                             83340002
IQE      IKJKEYWD                                                       83400002
         IKJNAME   'TCBIQE'                                             83460002
ECB      IKJKEYWD                                                       83520002
         IKJNAME   'TCBECB'                                             83580002
TSFLG    IKJKEYWD                                                       83640002
         IKJNAME   'TCBTSFLG'                                           83700002
STPCT    IKJKEYWD                                                       83760002
         IKJNAME   'TCBSTPCT'                                           83820002
TSLP     IKJKEYWD                                                       83880002
         IKJNAME   'TCBTSLP'                                            83940002
TSDP     IKJKEYWD                                                       84000002
         IKJNAME   'TCBTSDP'                                            84060002
PQE      IKJKEYWD                                                       84120002
         IKJNAME  'TCBPQE'                                              84180002
AQE      IKJKEYWD                                                       84240002
         IKJNAME   'TCBAQE'                                             84300002
NSTAE    IKJKEYWD                                                       84360002
         IKJNAME  'TCBNSTAE'                                            84420002
STABB    IKJKEYWD                                                       84480002
         IKJNAME   'TCBSTABB'                                           84540002
TCT      IKJKEYWD                                                       84600002
         IKJNAME   'TCBTCT'                                             84660002
USER     IKJKEYWD                                                       84720002
         IKJNAME  'TCBUSER'                                             84780002
NDSP0    IKJKEYWD                                                       84840002
         IKJNAME   'TCBNDSP0'                                           84900002
NDSP1    IKJKEYWD                                                       84960002
         IKJNAME   'TCBNDSP1'                                           85020002
NDSP2    IKJKEYWD                                                       85080002
         IKJNAME   'TCBNDSP2'                                           85140002
NDSP3    IKJKEYWD                                                       85200002
         IKJNAME   'TCBNDSP3'                                           85260002
RSRVD    IKJKEYWD                                                       85320002
         IKJNAME   'RESERVED'                                           85380002
JSCB     IKJKEYWD                                                       85440002
         IKJNAME   'TCBJSCB'                                            85500002
DDEXC    IKJKEYWD                                                       85550002
         IKJNAME   'TCBDDEXC'                                           85552002
DDWTC    IKJKEYWD                                                       85554002
         IKJNAME   'TCBDDWTC'                                           85556002
IOBRC    IKJKEYWD                                                       85558002
         IKJNAME   'TCBIOBRC'                                           85558402
RSVD2    IKJKEYWD                                                       85560002
         IKJNAME   'RSVD2'                                              85620002
EXT1    IKJKEYWD                                                        85680002
         IKJNAME   'TCBEXT1'                                            85740002
NDSP4    IKJKEYWD                                                       85800002
         IKJNAME   'TCBNDSP4'                                           85860002
NDSP5    IKJKEYWD                                                       85920002
         IKJNAME   'TCBNDSP5'                                           85980002
FLGS6    IKJKEYWD                                                       86040002
         IKJNAME   'TCBFLGS6'                                           86100002
FLGS7    IKJKEYWD                                                       86160002
         IKJNAME   'TCBFLGS7'                                           86220002
DAR      IKJKEYWD                                                       86280002
         IKJNAME   'TCBDAR'                                             86340002
RSVD     IKJKEYWD                                                       86400002
         IKJNAME   'TCBRSVD'                                            86460002
SYSCT    IKJKEYWD                                                       86510002
         IKJNAME   'TCBSYSCT'                                           86512002
STMCT    IKJKEYWD                                                       86514002
         IKJNAME   'TCBSTMCT'                                           86516002
EXT2     IKJKEYWD                                                       86520002
         IKJNAME   'TCBEXT2'                                            86580002
AECB     IKJKEYWD                                                       86640002
         IKJNAME   'TCBAECB'                                            86700002
TIRB     IKJKEYWD                                                       87120002
         IKJNAME   'TCBTIRB'                                            87180002
BACK     IKJKEYWD                                                       87240002
         IKJNAME   'TCBBACK'                                            87300002
RTWA     IKJKEYWD                                                       87350002
         IKJNAME   'TCBRTWA'                                            87352002
IOTIM    IKJKEYWD                                                       87480002
         IKJNAME   'TCBIOTIM'                                           87540002
TMSAV    IKJKEYWD                                                       87600002
         IKJNAME   'TCBTMSAV'                                           87660002
ABCUR    IKJKEYWD                                                       87720002
         IKJNAME   'TCBABCUR'                                           87780002
RSVD3    IKJKEYWD                                                       87830002
         IKJNAME   'RSVD3'                                              87880002
TID      IKJKEYWD                                                       87960002
         IKJNAME   'TCBTID'                                             88020002
RSVD4    IKJKEYWD                                                       88080002
         IKJNAME   'RSVD4'                                              88140002
FOE      IKJKEYWD                                                       88440002
         IKJNAME   'TCBFOE'                                             88500002
SWA      IKJKEYWD                                                       88560002
         IKJNAME   'TCBSWA'                                             88620002
RSVD5    IKJKEYWD                                                       88670002
         IKJNAME   'RSVD5'                                              88672002
TCBID    IKJKEYWD                                                       88674002
         IKJNAME   'TCBTCBID'                                           88676002
RTM12    IKJKEYWD                                                       88678002
         IKJNAME   'TCBRTM12'                                           88678402
ESTAE    IKJKEYWD                                                       88678802
         IKJNAME   'TCBESTAE'                                           88679202
RSVD6    IKJKEYWD                                                       88679602
         IKJNAME   'RSVD6'                                              88679702
CCPVI    IKJKEYWD                                                       88679802
         IKJNAME   'TCBCCPVI'                                           88679902
AFFN     IKJKEYWD                                                       88699902
         IKJNAME   'TCBAFFN'                                            88709902
FBYT1    IKJKEYWD                                                       88719902
         IKJNAME   'TCBFBYT1'                                           88726602
RSVD7    IKJKEYWD                                                       88732602
         IKJNAME   'RSVD7'                                              88733002
TFLG     IKJKEYWD                                                       88733302
         IKJNAME   'TCBTFLG'                                            88740002
GTFA     IKJKEYWD                                                       88800002
         IKJNAME   'TCBGTFA'                                            88860002
RSVD8    IKJKEYWD                                                       88910002
         IKJNAME   'RSVD8'                                              88960002
RCMP     IKJKEYWD                                                       89040002
         IKJNAME   'TCBRCMP'                                            89100002
RSVD9    IKJKEYWD                                                       89150002
         IKJNAME   'RSVD9'                                              89152002
         IKJENDP                                                        89160002
         EJECT                                                          89220002
CVTDSECT DSECT                                                          89280002
         CVT                                                            89340002
         EJECT                                                          89400002
         IKJTCB                                                         89460002
         SPACE 1                                                        89510002
         EJECT                                                          89520002
         TCOMTAB                                                        89580002
         SPACE                                                          89640002
         TSTCWORK                                                       89700002
         SPACE                                                          89760002
         IKJPPL                                                         89820002
         EJECT                                                          89880002
         IKJPARMA                                                       89940002
         END                                                            90000002
