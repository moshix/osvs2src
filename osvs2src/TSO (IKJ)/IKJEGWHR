         TITLE 'IKJEGWHR, ''WHERE'' SUBCOMMAND OF TEST'                 00080000
*C55300,65600,69400,75000                                      @YM07131 00160000
*D143200,144000,148000,160000-162400                           @ZA07138 00180003
*C144800,147200                                                @ZA07138 00200003
*********************************************************************** 00240000
*                                                                     * 00320000
* STATUS -- CHANGE LEVEL 000   VERSION NO. 02  OS/VS2                 * 00400000
*                                                                     * 00480000
* FUNCTION -- THIS SUBCOMMAND RESULTS IN THE QUALIFICATION (ABSOLUTE  * 00560000
*    ADDRESS) FOR THE SPECIFIED ADDRESS BEING DISPLAYED AT THE        * 00640000
*    TERMINAL. IF NO ADDRESS IS ENTERED THE INSTRUCTION COUNTER OF THE* 00720000
*    CURRENT PROBLEM PROGRAM IS DISPLAYED. IF AN ADDRESS IS AN        * 00800000
*    UNQUALIFIED SYMBOLIC OR RELATIVE, THE CURRENT INPLICIT           * 00880000
*    QUALIFICATION IS DISPLAYED. IF THE ADDRESS IS ABSOLUTE ADDRESS,  * 00960000
*    OR AN ADDRESS EXPRESSION, AN ATTEMPT IS MADE TO LOCATE THE       * 01040000
*    ADDRESS WITHIN THE SUBTASK CONTENTS STRUCTURE. IF THE ADDRESS IS * 01120000
*    FOUND TO FALL WITHIN THE STORAGE EXTENT OF ANY PROGRAM ASSIGNED  * 01200000
*    TO THE PROBLEM PROGRAM TASK OR ANY OF ITS SUBTASKS, THE LOCATION * 01280000
*    WITHIN THE PROGRAM OF THE SPECIFIED ADDRESS IS DISPLAYED AT THE  * 01360000
*    TERMINAL. IT IS IDENTIFIED BY LOAD MODULE NAME, ENTRYNAME (IF    * 01440000
*    THE CESD IS AVAILABLE) AND DISPLACEMENT FROM THE BEGINNING OF    * 01520000
*    THE LOWEST LEVEL OF QUALIFICATION AVAILABLE. IF MORE THAN ONE    * 01600000
*    TASK EXISTS ON THE SUB-TASK QUEUE, THE TCB ADDRESS IS ALSO       * 01680000
*    DISPLAYED. IF LOADNAME.ENTRYNAME IS SPECIFIED THE ABSOLUTE       * 01760000
*    ADDRESS OF THE SPECIFIED LOAD MODULE ENTRY POINT IS DISPLAYED.   * 01840000
*    ENTRYNAME MAY HAVE BEEN OMITTED, IN WHICH CASE THE BEGINNING     * 01920000
*    ADDRESS AT WHICH THE LOAD MODULE IS LOADED IS DISPLAYED. IF MORE * 02000000
*    THEN ONE TASK EXISTS ON THE SUBTASK QUEUE, THE TCB ADDRESS IS    * 02080000
*    ALSO DISPLAYED. IF AN IDENTICAL LOAD MODULE EXISTS ON ANOTHER    * 02160000
*    SUBTASK, THE SAME INFORMATION IS DISPLAYED AS ABOVE FOR THE      * 02240000
*    SECOND OCCURRENCE OF THE MODULE.                                 * 02320000
*                                                                     * 02400000
* ENTRY POINTS --                                                     * 02480000
*         IKJEGWHR -- INITIAL ENTRY POINT.                            * 02560000
*         ADDRVLCK -- VALIDITY CHECK ROUTINE.                         * 02640000
*                                                                     * 02720000
* INPUT -- IS IS EXPECTED THAT REGISTER 9 POINTS TO TCOMTAB UPON      * 02800000
*    ENTRY TO IKJEGWHR. TCOMTAB IS THE COMMUNICATIONS AREA FROM       * 02880000
*    WHICH ALL NEEDED INFORMATION MAY BE ACCESSED.                    * 02960000
*                                                                     * 03040000
* OUTPUT -- DATA MESSAGES CONTAINING PERTINENT INFORMATION, I.E.,     * 03120000
*    ABSOLUTE QUALIFICATION, OFFSET, LOADNAME, CSECTNAME AND TCB      * 03200000
*    ADDRESS, ARE PRINTED ON THE TERMINAL LISTING.                    * 03280000
*                                                                     * 03360000
* EXTERNAL REFERENCES --                                              * 03440000
*         IKJPARS IS ENTERED TO CHECK SYNTAX OF WHERE SUBCOMMANDS. IN * 03520000
*         ADDITION, MUCH OF THE ADDRESS PROCESSING IS DONE WHILE IN   * 03600000
*         IKJPARS.                                                    * 03680000
*                                                                     * 03760000
*         IKJEGCVT IS ENTERED TO CONVERT THE USER SUPPLIED ADDRESS    * 03840000
*         TO HEXIDECIMAL                                              * 03920000
*                                                                     * 04000000
*         IKJEGSYM IS ENTERED FIRST TO ACCESS A CSECT NAME IN THE     * 04080000
*         INDICATED LOADNAME, AND SECOND TO SEARCH THE SYMBOL TABLE   * 04160000
*         FOR A GIVEN LOADNAME.CSECT.                                 * 04240000
*                                                                     * 04320000
*         IKJEGIO IS CALLED TO PRINT INDICATED MESSAGES.              * 04400000
*                                                                     * 04480000
* EXITS, NORMAL -- WHEN ALL ADDRESS PROCESSING IS COMPLETED, IKJEGWHR * 04560000
*         RETURNS TO MAINLINE.                                        * 04640000
*                                                                     * 04720000
* EXITS, ERROR  --                                                    * 04800000
*         NONE                                                        * 04880000
*                                                                     * 04960000
* TABLES/WORK AREAS -- THE WORKAREA POINTER PROVIDED IN TCOMTAB IS    * 05040000
*    THE ONLY WORKAREA USED.                                          * 05120000
*                                                                     * 05200000
* ATTRIBUTES -- REFRESHABLE AND REENTRANT                             * 05280000
*                                                                     * 05360000
* CHARACTER CODE DEPENDENCY --                                        * 05440000
*                                                                     * 05520000
* NOTES -- IBM STANDARD LINKAGE CONVENTIONS WERE USED.                * 05600000
*                                                                     * 05680000
* CHANGE-ACTIVITY --                                                  * 05690003
*                 APAR OZ07138 - CHANGES TO USE A POINTER TO THE      * 05700003
*                 BREAKPOINT SVRB IN TCOMTAB WHEN LOOKING FOR THE     * 05710003
*                 PSW FOR THE PROBLEM PROGRAM. THE POINTER IS AT      * 05720003
*                 ECBPP+1.                                            * 05730003
*                                                                     * 05760000
*********************************************************************** 05840000
         EJECT                                                          05920000
         COPY  IKJEGSIO                                                 06000000
         EJECT                                                          06080000
IKJEGWHR CSECT                                                          06160000
         ENTRY IKJEGVLC       ENTRY POINT FOR VALIDITY CHECK            06240000
         USING TCOMTAB,R9     OF ADDRESS. ESTABLISH TCOMTAB             06320000
         SAVE (14,12)         ADDRESSIBILITY. SAVE REGISTERS            06400000
************************************************************            06480000
**                                                        **            06560000
** AFTER REGISTERS HAVE BEEN SAVED THE ADDRESS OF A       **            06640000
** SAVE AREA IS OBTAINED FROM TCOMTAB. FORWARD AND BACK   **            06720000
** WARD CHAINING IS ACCOMPLISHED. THE ADDRESS OF THE PCL  **            06800000
** (PARAMETER CONTROL LIST) IS PLACED INTO A REGISTER TO  **            06880000
** BE PUT WITHIN THE PARAMETER LIST TO BE PASSED TO PARSE.**            06960000
** THE PARAMETER LIST WILL BE BUILT IN THE WORKAREA WHOSE **            07040000
** ADDRESS IS GOTTEN FROM TCOMTAB. PARMLIST  ADDRESS IS   **            07120000
** ALSO GOTTEN FROM TCOMTAB. PARMLIST CONTAINS UPT, ECT   **            07200000
** AND CHECK ELEMENTS OF THE PARAMETER LIST. ADDRESS OF   **            07280000
** MY SAVE AREA IS ALSO PLACED INTO THE LIST. THE COMPLETE**            07360000
** LIST IS PASSED TO THE PARSING ROUTINE VIA REG 1 AND    **            07440000
** THE LINK MACRO                                         **            07520000
************************************************************            07600000
         LR    R12,R15        RESTORE R12 TO BEGINNING ADDR             07680000
         USING IKJEGWHR,R12   USE ENTERING ADDRESS FOR ADDRESSING       07760000
         L     R2,REGSAVE2    GET ADDR OF MY SAVE AREA FROM TCOMTAB     07840000
*                             ADDRESS OBTAINED FROM TCOMTAB             07920000
         ST    R13,@4(@0,R2)  STORE CALLERS SAVE AREA ADDR              08000000
         ST    R2,@8(R13)     STORE MY SAVE IN CALLERS                  08080000
         LR    R13,R2         PLACE ADDR OF MY SAVEAREA INTO            08160000
*                             REG13                                     08240000
         L      R10,WORKAREA  ACCESS WORKAREA ADDR FROM TCOMTAB         08320000
         MVC   CWORKCMD-TSTCWORK(ENDLIST,R10),LISTSTAE STAE IN WORKAREA 08400000
         LA    R1,CWORKCMD-TSTCWORK(R10)  PARAMETER TO STAE             08480000
         L     R2,TSTSTAE     ADDR OF STAE EXIT ROUTINE                 08560000
         ST    R12,@68(R13)   SAVE BASE REGISTER                        08640000
         ESTAE (R2),PARAM=LISTESTA,RECORD=YES,MF=(E,(R1))  ISSUE ESTAE  08720000
         LTR   R15,R15        TEST STAE RETURN CODE                     08800000
SMTSTAE  DS    0H             TEST CASE TWHR2700                        08880000
         BZ    ESTAEOK        BRANCH IF ESTAE ISSUED IS OK              08960000
         STC   R15,TSTESTRC   STORE RET. CODE IN TCOMTAB                09040000
         LA    R15,@24        SEND RC=24 TO MAINLINE                    09120000
         B     RETS           BRANCH TO RETURN                          09200000
ESTAEOK  EQU   *              ESTAE WAS ISSUED                          09280000
         TM    TSTFLGS3,NOPARMS TEST FOR PARM FIELD WITH WHERE          09360000
         BO    A0009          IF ON, SKIP PARSE AND PROCESS IC          09440000
         EJECT                                                          09520000
         L     R4,PARSELST    LOAD PARSE TABLE ADDR INTO REG4           09600000
         L     R1,WORKAREA    LOAD WORKAREA ADDR FROM TCOMTAB           09680000
         LA     R1,PPLSAVE-TSTCWORK(R1) ACCESS COMMAND PORTION          09760000
         USING PPL,R1         ESTABLISH PPL ADDRESSABILITY              09840000
         MVC   PPLUPT(@4),TSTUPT PTR TO UPT FOR PARSE                   09920000
         MVC   PPLECT(@4),TSTECT PTR TO ECT FOR PARSE                   10000000
         MVC   PPLECB(@4),TSTCPECB PTR TO CP ECB FOR PARSE              10080000
         ST    R4,PPLPCL      PTR TO PCL FOR PARSE                      10160000
         ST    R13,PPLUWA     PTR TO MY SAVE AREA FOR PARSE             10240000
         LA    R4,TSTANSPL    ACCESS ADDR OF ANSWER PLACE               10320000
         ST    R4,PPLANS      PTR TO ANSWER PLACE FOR PARSE             10400000
         MVC   PPLCBUF(@4),INBUF PTR TO COMMAND BUFFER                  10480000
         DROP  R1             DROP PPL ADDRESSABILITY                   10560000
         LA    R4,I0040       IKJPARS INSERT                            10640000
         LINK  EP=IKJPARS,ERRET=LINKFL1                                 10720000
BLOW1    DS    0X              STAE ENTRY POINT                         10800000
SMTPARS  DS    0H             TEST CASE TWHR2600                        10880000
         BAL   R14,CHKCDE     TO TEST PARSE RETURN CODE                 10960000
         EJECT                                                          11040000
         L     R2,TSTANSPL    ACCESS PDE POINTER                        11120000
         USING IKJPARMD,R2    ESTABLISH PDL ADDRESSABILITY              11200000
         LA    R2,GETADDR     ACCESS ADDR OF PDE                        11280000
         DROP  R2             DROP PDL ADDRESSABILITY                   11360000
         USING IKJPARMA,R2    ESTABLISH PDE ADDRESSABILITY              11440000
         L     R3,PDEUSER     ACCESS USER WORD                          11520000
         LTR   R3,R3          TEST IF NO PARAMETERS ENTERED             11600000
*                             (ONLY APPLIES IF NULL RETURN IS USED      11680000
*                             DURING REENTER MODE)                      11760000
         BNZ   A0008          BYPASS PUTTING OUT IC                     11840000
         TM    PDEFLG4,ABSADDR+SYMADDR TEST FOR ABSOLUTE 0              11920000
         BZ    A0009          TO PUT OUT IC                             12000000
A0008    EQU    *             EQUATE LABEL TO THIS ADDRESS              12080000
         XR    R15,R15        ZERO OUT R15 FOR RETURN CODE              12160000
         DROP  R2                                                       12200003
         EJECT                                                          12240000
RET      DS    0X                                                       12320000
         LR    R2,R15         SAVE RET CODE OVER ESTAE                  12400000
         ESTAE 0              REMOVE ESTAE REQUEST                      12480000
         LR    R15,R2         RESTORE RETURN CODE                       12560000
         NI    TSTFLGS4,HEXFF-TSTRERTN  SHUT OFF RETRY FLAG             12640000
RETS     DS    0X             RETURN TO MAINLINE                        12720000
         L     R13,@4(R13)                                              12800000
         RETURN (14,12),RC=(15) RETURN TO MAINLINE                      12880000
         EJECT                                                          12960000
CHKCDE   DS    0X                                                       13040000
         B     *+@4(R15)      BRANCH ACCORDING TO CODE                  13120000
         BR    R14            RETURN CODE = 0                           13200000
         BR    R14            FOR ALIGNMENT PURPOSES                    13280000
         B     RETCDE4        RETURN CODE = 4                           13360000
         B     RETCDE8        RETURN CODE = 8                           13440000
         B     RETCDE12       RETURN CODE = 12                          13520000
         B     RETCDE16       RETURN CODE = 16                          13600000
         B     RETCDE20       RETURN CODE = 20                          13680000
         EJECT                                                          13760000
A0009    DS    0X              EQUATE LABEL TO ADDRESS                  13840000
*************************************************************           13920000
**AT THIS POINT WE ASSUME NO SUB-COMMANDS HAVE BEEN ENTERED**           14000000
**AND WILL RETURN TO THE TERMINAL THE CURRENT INSTRUCTION  **           14080000
**COUNTER ADDRESS.                                         **           14160000
*************************************************************           14240000
         L     R4,ECBPP       GET ADDRESS OF SVC 97 REQUEST BLK@ZA07138 14480003
         USING RBSECT,R4      USE REG4 TO ADDRESS RB                    14640000
         L     R4,RBLINK      GET ADDRESS OF PROBLEM PROG PRB  @ZA07138 14720003
         L     R2,RBOPSW+@4   LOAD RESUME PSW                           14880000
         BAL   R14,CONVERT    BRANCH TO CONVERT ROUTINE                 14960000
         L     R1,OUTBUF      PLACE POINTER TO OUTPUT AREA IN R1        15040000
         EX    R10,ICMVC      PUT CONVERTED IC IN BUFFER                15120000
         LA    R3,@6(R10)     CREATE LENGTH COUNT                       15200000
         STH   R3,@0(R1)      PLACE LENGTH FIELD INTO FIRST WORD        15280000
         LA    R10,@5(R10,R1) UPDATE BUFFER POINTER                     15360000
         MVI   @0(R10),DOT    PERIOD TO INDICATE ABSOLUTE ADDRESS       15440000
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  15520000
         LR    R4,R1          REG 4=PTR TO DATA                         15600000
         IKJEGSIO DATA,DATAPTR=(R4),ID=WHR32,MF=(E,TSTIOPRM)            15680000
         NI    TSTFLGS2,HEXFF-TADDROUT TURN OFF MSG PUT TO TERM SW      15760000
         B     COMMON         GO CHECK RET CODE FROM IO                 15840000
ICMVC    MVC   @4(@1,R1),@0(R2)  MOVE EBCDIC ADDRESS INTO OUTPU T       15920000
         DROP  R4                                                       15970003
RETCDE4  DS    0X                                                       16320000
         OI    TSTFLGS4,TSTFLUSH TELL MNLINE TO FLUSH STACK             16400000
         B     A0008          RETURN TO MNLINE WITH ZERO                16480000
RETCDE12 DS    0X                                                       16560000
         LA    R2,M0104       MSG-WHERE FAILED, CMMND SYS ERR           16640000
         LA    R3,M0277       MSG-PARSE ERROR CODE 12                   16720000
         BAL   R6,MSG2        GO OUTPUT THE MESSAGES                    16800000
         B     COMMON         CHECK RET CODES, RETURN                   16880000
RETCDE16 DS    0X                                                       16960000
         LA    R2,M0103       MSG-NOT ENOUGH CORE                       17040000
         LA    R3,@0          NO SECOND LEVEL MESSAGE                   17120000
         BAL   R6,MSG1        GO OUTPUT THE MESSAGES                    17200000
         B     COMMON         CHECK RET CODES, RETURN                   17280000
RETCDE20 DS    0X                                                       17360000
         L     R8,WORKAREA    ACCESS PTR TO WORKAREA                    17440000
         L     R15,CODESAVE-TSTCWORK(R8) ACCESS STORED RETURN CODE      17520000
         LA    R14,@16        FOR RETURN CODE COMPARISON                17600000
         CR    R15,R14        TEST RETURN CODE                          17680000
         BE    RET            IF EQUAL RETURN 16 TO MNLINE              17760000
         BH    SEND20         OHTERWISE SEND 20 TO MNLINE               17840000
         XR    R15,R15        SEND 0 IF LESS THAN 16                    17920000
         B     RET            RETURN TO MNLINE                          18000000
SEND20   DS    0X                                                       18080000
         LA    R15,@20        RETURN CODE TO MAINLINE                   18160000
         B     RET            RETURN TO MNLINE                          18240000
RETCDE8  DS    0X                                                       18320000
         LA    R15,@16        RETURN CODE TO MNLINE                     18400000
         B     RET            RETURN TO MNLINE                          18480000
COMMON   DS    0X                                                       18560000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       18640000
         CH    R15,ATTNCODE   COMPARE RET CODE TO 16                    18720000
         BNL   RET            RET CODE NOT LESS THAN 16                 18800000
         B     A0008          RETURN TO MNLINE WITH ZERO                18880000
         EJECT                                                          18960000
RETRY    DS    0X                                                       19040000
         L     R2,@16         ACCESS PTR TO CVT                         19120000
         USING CVT,R2         ESTABLISH CVT ADDRESSABILITY              19200000
         L     R3,CVTTCBP     ACCESS TCB PTR                            19280000
         L     R3,@4(R3)      ACCESS CURRENT TCB PTR                    19360000
         USING TCB,R3         ESTABLISH TCB ADDRESSABILITY              19440000
         L     R9,TCBTRN      PTR TO TCOMTAB                            19520000
         L     R13,REGSAVE2   ACCESS SAVE AREA                          19600000
         L     R12,@68(R13)   ACCESS BASE REGISTER                      19680000
         DROP  R2             DROP CVT ADDRESSABILITY                   19760000
         DROP  R3             DROP TCB ADDRESSABILITY                   19840000
         NI    TSTFLGS2,HEXFF-TADDROUT-TOFFDEF  TURN OFF FLAGS          19920000
         NI    TSTFLGS1,HEXFF-TSTFIRST TURN OF FLAG                     20000000
         LA    R15,@20        RETURN CODE OF 20 TO MAINLINE             20080000
         B     RET            RETURN CONVENTIONS                        20160000
         EJECT                                                          20240000
************************************************************            20320000
** PARSE WILL LINK TO THIS ADDRESS SO THAT WE MAY         **            20400000
**VALIDITY CHECK THE ADDRESS ENTERED THRU THE TERMINAL    **            20480000
** WE WILL TRY USING IKJEGCVT AND IKJEGSYM PLUS ACTUALLY  **            20560000
** LOOKING FOR THE ADDRESS WITHIN THE CONTROL BLOCKS      **            20640000
** STRUCTRUE TO CHECK WHETHER THE ADDRESS IS VALID        **            20720000
** INVALID ADDRESSES ARE FLAGGED AS SUCH AND ASKED TO BE  **            20800000
** REENTERED.                                             **            20880000
************************************************************            20960000
IKJEGVLC DS    0X                                                       21040000
         SAVE  (14,12)        SAVE REGISTERS             ***            21120000
         DROP  R12            DROP R12 AS BASE REGISTER    *            21200000
         USING IKJEGVLC,R15   ESTABLISH E.P. ADDRESSABILITY* ESTABLISH  21280000
         L     R2,@4(R1)      ACCESS MY REGISTER SAVEAREA  *            21360000
         LM    R3,R12,@32(R2) RESTORE REGISTERS 3 THRU 12  *ADDRSABLITY 21440000
         USING IKJEGWHR,R12   ESTABLISH ADDRESSABILITY     *            21520000
         DROP  R15            DROP R15 AS BASE REGISTER  ***            21600000
*                                                        ***            21680000
         L     R2,REGSAVE3    ACCESS MY SAVE AREA ADDRESS  * STANDARD   21760000
         ST    R13,@4(R2)     SAVE CALLERS SAVEAREA        *            21840000
         ST    R2,@8(R13)     STORE MY SAVE IN CALLERS     * LINKAGE    21920000
         LR    R13,R2         MY SAVE AREA INTO R13        *            22000000
*                                                        ***CONVENTIONS 22080000
         SR    R14,R14        CLEAR REG 14                              22160000
         L     R4,OUTBUF      ACCESS POINTER TO OUTBUF                  22240000
         ST    R14,@0(R4)     CLEAR 1ST WORD OF OUTBUF                  22320000
         OI    TSTFLGS4,TSTVALCK  INDICATE VALIDITY ROUTINE             22400000
         NI    TSTFLGS2,HEXDF-TADDROUT TURN OFF MSG PUT TO TERM SW      22480000
*                                       AND INIT LOAD LIST INDICATOR    22560000
         L     R2,WORKAREA    ACCESS PTR TO WORKAREA                    22640000
         LA    R3,@8(R1)      CREATE PTR TO PARSE 3RD WORD              22720000
         ST    R3,MSGADDR-TSTCWORK(R2) FUTURE PTR TO 2ND LEVEL MSG      22800000
*                                                                       22880000
         L     R7,@0(R1)      ACCESS PDE ADDRESS                        22960000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              23040000
         TM    PDEFLG4,GENR   TEST FOR REGISTER NOTATION                23120000
         BNO   FLTREG         BRANCH FOR FURTHER VALIDITY CHECK         23200000
         LH    R3,PDEINDCT    ACCESS INDIRECT COUNT                     23280000
         LTR   R3,R3          IF 0, THEN INVALID REGISTER SPECIFICATION 23360000
         BNZ   FLTREG         BRANCH FOR FURTHER VALIDITY CHECK         23440000
         B     BADADDR        BRANCH TO OUTPUT ERROR MESSAGES           23520000
FLTREG   DS    0X                                                       23600000
         TM    PDEFLG4,LFPR+SFPR TEST FOR FLOATING POINT REGISTER       23680000
         BZ    PROCESS        IF NOT SPECIFIED, PROCESS ADDRESS STING   23760000
BADADDR  DS    0X             OUTPUT ERROR MESSAGES                     23840000
         LA    R2,M0101       MSG-INVALID ADDRESS                       23920000
         LA    R3,M0274       MSG-REG NOT. MUST BE INDRT GEN REG        24000000
         LR    R4,R7          ADDRESS PDE                               24080000
         B     MSG3           GO OUTPUT THE MESSAGES                    24160000
PROCESS  DS    0X                                                       24240000
         L     R3,WORKAREA              ***                             24320000
         LA    R3,PDESAVE-TSTCWORK(R3)    * SAVE PDE IN WORKAREA        24400000
         MVC   @0(@25,R3),@0(R7)        ***                             24480000
*                                                          ***          24560000
         TM    PDEFLG2,CTNAMFLG TEST IF CSECT NAME SPECIFIED *          24640000
         BO    QUALSYM        IF SPECIFIED, BRANCH           * TEST FOR 24720000
         L     R3,PDEEXPTR    ACCESS ADDRESS OF ADDR EXP     *          24800000
         LA    R3,@0(R3)      ZERO HI ORDER BYTE             *          24880000
         LTR   R3,R3          TEST FOR ADDR EXP              *          24960000
         BNZ   ADDRPROC       IF ADDR EXP, BRANCH            *          25040000
         TM    PDEFLG3,AFLG   TEST FOR ADDR STRING           *QUALIFIED 25120000
         BNO   ADDRPROC       IF NOT SPECIFIED, BRANCH       * SYMBOL   25200000
         TM    PDEFLG4,SYMADDR TEST FOR SYMBOLIC ADDR        *          25280000
         BNO   ADDRPROC       IF NOT SYMBOL, BRANCH        ***          25360000
         B     SYMBOL         BRANCH IF IT IS A SYMBOL                  25440000
SYMBOL   DS    0X                                                       25520000
         MVC   PDELDNAM(@6),PDEADRPT SYMBOL AND LEN INTO LDNAME         25600000
         L     R1,TSTTCB      ACCESS TEST'S TCB                         25680000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       25760000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       25840000
         ST    R1,TCBCHAI-TSTCWORK(R2) STORE MOTHER TCB                 25920000
GOCDE    DS    0X                                                       26000000
         BAL R14,TCBCHAIN     BRANCH TO GET TCB ON CHAIN                26080000
         LTR   R1,R1          TEST FOR END OF TCB CHAIN                 26160000
         BZ    ENDTCB         BRANCH IF END OF CHAIN                    26240000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              26320000
         TM    TCBFLGS5,TCBFC TEST IF TCB TERMINATED                    26400000
         BO    GOCDE          IF TERMINATED, GET NEXT TCB ON CHAIN      26480000
         DROP  R1             DROP ADDRESSABILITY TO TCB                26560000
         BAL   R14,CDESRCH    SEARCH CDE FOR LOADNAME MATCH             26640000
         LTR   R0,R0          TEST IF LOADNAME MATCH FOUND              26720000
         BZ    GOCDE          IF NOT GET NEXT TCB                       26800000
         ST    R0,PDEUSER     IF FOUND, STORE LOCATED AT ADDR           26880000
         OI    TSTFLGS2,TADDROUT INDICATE MATCH FOUND (MSG OUTPUT)      26960000
         BAL   R14,LDNMSG     TO BUILD AND OUTPUT MSG                   27040000
         L     R1,TCBSAVE-TSTCWORK(R8) ACCESS STORED TCB                27120000
         LTR   R11,R11        IS THERE A RETURN ADDRESS INDICATED       27200000
         BZ    GOCDE          GET NEXT TCB                              27280000
         BR    R11            TO CONTINUE PROCESSING THE PRESENT TCB    27360000
ENDTCB   DS    0X                                                       27440000
         XR    R15,R15        INDICATE ZERO RETURN CODE                 27520000
         TM    TSTFLGS2,TADDROUT WAS ANY LOADNAME MATCH FOUND           27600000
         BO    GOHOME         IF SO, RETURN TO PARSE                    27680000
         L     R2,WORKAREA    OTHERWISE, ACCESS WORKAREA PTR            27760000
         MVC   PDELDNAM(@25),PDESAVE-TSTCWORK(R2) RESTORE PDE           27840000
         B     ADDRPROC       BRANCH TO FURTHER SEARCH                  27920000
QUALSYM  DS    0X                                                       28000000
         TM    PDEFLG1,LDNAMFLG TEST IF LOADNAME IS WITH CSECT NAME     28080000
         BO    ADDRPROC       IF SO PROCESS ADDRESS                     28160000
         L     R3,WORKAREA    ACCESS WORKAREA POINTER                   28240000
         MVC   CURLD-TSTCWORK(@8,R3),TSTCURLD MOVE CURRENT LOADNAME     28320000
         LA    R4,@8          INITIALIZE REG WITH MAX LEN 8             28400000
         LA    R5,CURLD-TSTCWORK(R3) CREATE PTR TO LOADNAME             28480000
         ST    R5,PDELDNAM    STORE PTR IN PDE                          28560000
         LA    R5,@7(R5)      UPDATE PTR TO END OF LOADNAME             28640000
CHKBLNK  DS    0X                                       *****           28720000
         CLI   @0(R5),BLANK   TEST LAST CHAR FOR BLANK     * REMOVE     28800000
         BNE   STLEN          IF NOT BLANK, BRANCH         *  BLANK     28880000
         BCTR  R4,R0          DECREMENT LENGTH COUNTER     * PADDING    28960000
         BCTR  R5,R0          DECREMENT PTR TO LOADNAME    *  IF ANY    29040000
         B     CHKBLNK        TO TEST FOR BLANK        *****            29120000
STLEN    DS    0X                                                       29200000
         STH   R4,PDELEN1     STORE CALCULATED LENGTH IN PDE            29280000
         B     ADDRPROC       TO PROCESS ADDR                           29360000
ADDRPROC DS    0X                                    ***                29440000
         LA    R0,@4          MAKE R0 POSITIVE        *                 29520000
         LR    R1,R7          ACCESS ADDR OF PDE      *                 29600000
         LCR   R1,R1          INDICATOR TO TSTCONVT   * CONVERT ADDRESS 29680000
         NI    TSTFLGS3,HEXFF-SYMMESG INDICATE PRINT  *                 29760000
         L     R15,TSTCONVT   ACCESS ADDR OF TSTCONVT *                 29840000
         BALR  R14,R15        BRANCH TO CONVERT     ***                 29920000
         BAL   R14,CODECHK    TO TEST RETURN CODE                       30000000
*                                                                       30080000
         L     R2,PDEUSER     ADDR FROM TSTCONVT                        30160000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       30240000
         TM    PDEFLG5,PDESIB IF ADDR IS NOT SYMBOLIC                   30320000
         BZ    GOXLST         ...THEN BRANCH                            30400000
         L     R2,@0(R2)      ...ELSE GET ADDR FROM SIB                 30480000
         LA    R2,0(R2)       ZERO HIGH ORDER BYTE                      30560000
         B     GOXLST         TO SEARCH XTENT LIST                      30640000
         EJECT                                                          30720000
*********************************************************************** 30800000
*                                                                     * 30880000
* THIS CODE ACCESS EACH TCB AND PASSES ITS ADDR IN REGISTER 1 TO CODE * 30960000
* WHICH SEACHES THE EXTENT LISTS FOR THE SAME ADDRESS IN PDEUSER. WHEN* 31040000
* THE ADDRESS IS FOUND, THE CORRESPONDING LOADNAME IS RETURNED IN R0  * 31120000
* IF NOT SUCCESSFUL, R0 WILL CONTAIN ZEROES.                          * 31200000
*                                                                     * 31280000
*********************************************************************** 31360000
GOXLST   DS    0X                                                       31440000
         ST    R2,PDEUSER     PUT ACTUAL ADDR IN PDEUSER                31520000
         L     R3,WORKAREA    ACCESS WORKAREA ADDR                      31600000
         ST    R2,USERSAVE-TSTCWORK(R3) SAVE ORIG CONVERTED ADDR        31680000
         L     R1,TSTTCB      ACCESS TEST TCB                           31760000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       31840000
         ST    R1,TCBCHAI-TSTCWORK(R3) STORE MOTHER TCB IN WORKAREA     31920000
NXTCB    DS    0X                                                       32000000
         BAL   R14,TCBCHAIN   TO GET NEXT TCB ON CHAIN                  32080000
         LTR   R1,R1          ANOTHER TCB FOUND                         32160000
         BZ    ENDCHAIN       NO, END XLST SEARCH                       32240000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              32320000
         TM    TCBFLGS5,TCBFC TEST IF TCB TERMINATED                    32400000
         BO    NXTCB          IF TERMINATED, GET NEXT TCB               32480000
         DROP  R1             DROP TCB ADDRESSABILITY                   32560000
         BAL   R14,XLSTSRCH   YES,SEARCH XLST                           32640000
         LTR   R0,R0          XLST SEARCH SUCCESSFUL                    32720000
         BZ    NXTCB          GET NEXT TCB                              32800000
         TM    PDEFLG1,LDNAMFLG TEST IF USER ENTERED LDNAM              32880000
         BO    GETCTN         IF SO, DO NOT ALTER PDE                   32960000
         LR    R2,R0          ACCESS PTR TO LOADNAME                    33040000
         LA    R2,@7(R2)      CREATE PTR TO END OF LOAD NAME            33120000
         LA    R8,@8          MAX LENGTH OF LOADNAME                    33200000
BLNKOFF  DS    0X                                       ****            33280000
         CLI   @0(R2),BLANK   TEST FOR BLANK              * REMOVE      33360000
         BNE   MVCPROG        NO BLANK, BRANCH            *  BLANK      33440000
         BCTR  R8,R0          DECREMENT LENGTH COUNTER    * PADDING     33520000
         BCTR  R2,R0          DECREMENT PTR TO LOADNAME   *  IF ANY     33600000
         B     BLNKOFF        TO TEST FOR BLANK        ****             33680000
PNAMVC   MVC   @0(@1,R6),@0(R2)                                         33760000
TRYALIAS DS    0X              REPLACE LDNAM WITH ALIAS                 33840000
         LA    R8,@8          MAX LENGTH OF ALIAS NAME                  33920000
         L     R6,WORKAREA    ACCESS WORKAREA PTR                       34000000
         LA    R2,ALIASAVE-TSTCWORK(R6) ACCESS PTR TO ALIAS SAVE        34080000
         TM    TSTFLGS1,TSTFIRST  HAVE WE ALREADY TRIED ALIAS           34160000
         BO    NOCTN          IF SO, BRANCH                             34240000
         OI    TSTFLGS1,TSTFIRST  SET FLAG TO INDICATE TRYING ALIAS     34320000
         LR    R0,R2          SAVE PTR TO ALIAS NAME                    34400000
         CLI   @0(R2),BLANK   TEST IF ALIAS EXISTS                      34480000
         BE    NOCTN          GO TO RECOVERY ROUTINE                    34560000
         LA    R2,@7(R2)      CREATE PTR TO END OF ALIAS NAME           34640000
         B     BLNKOFF        TO REMOVE BLANK PADDING                   34720000
NOCTN    DS    0X              RECOVERY ROUTINE IF CSECT NAME NOT FOUND 34800000
         NI    TSTFLGS1,HEXFF-TSTFIRST TURN FLAG OFF                    34880000
         STH   R8,PDELEN2       ST LENGTH OF 8                          34960000
         MVI   @0(R2),BLANK     PUT BLANK IN ALIASAVE                   35040000
         MVC   @1(@7,R2),@0(R2) SPREAD BLANKS THROUGH ALIASAVE @ZA00920 35120000
         ST    R2,PDECTNAM      STORE PTR TO BLANKS AS CSECT NAME PTR   35200000
         NI    TSTFLGS3,HEXFF-SYMMESG TURN OF SUPPRESS MSG FLAG         35280000
         MVC   OFFSET2-TSTCWORK(@4,R6),OFFSET-TSTCWORK(R6) MOVE OFFSET  35360000
         B     RECOVER          RESUME RECOVERY PROCESS                 35440000
MVCPROG  DS    0X                                                       35520000
         OI    PDEFLG1,LDNAMFLG  TURN ON LOADNAME FLAG                  35600000
         STH   R8,PDELEN1     STORE LOADNAME LENGTH                     35680000
         BCTR  R8,R0          DECREMENT FOR EX                          35760000
         L     R6,WORKAREA    ACCESS WORKAREA PTR                       35840000
         LA    R6,LOADNAME-TSTCWORK(R6) CREATE PTR TO LOADNAME AREA     35920000
         ST    R6,PDELDNAM    ST PTR IN PDE                             36000000
         LR    R2,R0          ACCESS LOADNAME PTR                       36080000
         EX    R8,PNAMVC      TO MOVE INTO WORKAREA                     36160000
GETCTN   DS    0X                                                       36240000
         MVI   PDEFLG2,HEX00  INDICATE CSECT NAME NOT PRESENT           36320000
*                                                                       36400000
         LA    R2,@4          LENGTH OF OFFSET (ADDR STRING)            36480000
         STH   R2,PDELEN3     STORE IN PDE LENGTH POINTER               36560000
         L     R6,WORKAREA    ACCESS WORKAREA PTR                       36640000
         LA    R2,OFFSET-TSTCWORK(R6) ACCESS GROSS OFFSET               36720000
         ST    R2,PDEADRPT    STORE OFFSET PTR IN PDE                   36800000
         OI    PDEFLG3,AFLG   TURN ON ADDRESS STRING INDICATOR          36880000
         MVI   PDEFLG4,RELADDR TURN ON RELADDR FLAG AND TURN OFF OTHERS 36960000
         OI    TSTFLGS3,SYMMESG  INDICATE TO SUPPRESS MSG               37040000
         LA    R1,IKJPARMA                                              37120000
         BAL   R11,LINKSYM    LINK TO IKJEGSYM TO GET CSECT NAME        37200000
         BAL   R14,CODECHK2   TEST SYM RETURN CODE                      37280000
         L     R6,WORKAREA    REINITIALIZE WORKAREA PTR                 37360000
         XC    PDEADRPT(@7),PDEADRPT CLEAR ADDR PTR, LENGTH AND FLAGS   37440000
         LH    R2,PDELEN2     ACCESS LENGTH OF CSECT NAME               37520000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     37600000
         L     R1,PDECTNAM    ACCESS PTR TO CSECT NAME                  37680000
         EX    R2,CSECTMVC    MOVE CSECT NAME TO MY WORKAREA            37760000
         LA    R2,CSECTNAM-TSTCWORK(R6) CREATE PTR TO CSECT NAME        37840000
         ST    R2,PDECTNAM    STORE PTR IN PDE                          37920000
         NI    TSTFLGS3,HEXFF-SYMMESG TURN OFF SUPPRESS MSG FLAG        38000000
         LA    R1,IKJPARMA                                              38080000
         BAL   R11,LINKSYM    LINK TO SYM FOR CSECT LOCATION            38160000
         BAL   R14,CODECHK2   TEST SYM RETURN CODE                      38240000
         L     R6,WORKAREA    REINITIALIZE WORKAREA PTR                 38320000
         L     R2,TSTWHR      ACCESS LOADED AT ADDRESS FROM IKJEGSYM    38400000
         L     R3,PDEUSER     CSECT LOCATION                            38480000
         SR    R3,R2          OFFSET OF CSECT FROM LOADED AT ADDR       38560000
         L     R4,OFFSET-TSTCWORK(R6) ACCESS SAVED GROSS OFFSET         38640000
         SR    R4,R3          CALCULATE OFFSET INTO CSECT               38720000
         ST    R4,OFFSET2-TSTCWORK(R6) STORE OFFSET IN WORKAREA         38800000
RECOVER  DS    0X              ENTER HERE IF CSECT NAME WAS NOT FOUND   38880000
         L     R1,TSTTCB      ACCESS TCB ADDRESS                        38960000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       39040000
         ST    R1,TCBCHAI-TSTCWORK(R6) SAVE MOTHER TCB                  39120000
GOTCB1   DS    0X                                                       39200000
         BAL   R14,TCBCHAIN   GET NEXT TCB ON CHAIN                     39280000
         XR    R15,R15        INDICATE ZERO RETURN CODE                 39360000
         LTR   R1,R1          TEST FOR END OF TCB CHAIN                 39440000
         BZ    GOHOME         BRANCH IF END OF CHAIN                    39520000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              39600000
         TM    TCBFLGS5,TCBFC TEST IF TCB TERMINATED                    39680000
         BO    GOTCB1         IF TERMINATED, GET NEXT TCB               39760000
         DROP  R1             DROP TCB ADDRESSABILITY                   39840000
         BAL   R14,CDESRCH    TO SEARCH CDE FOR LOADNAME MATCH          39920000
         LTR   R0,R0          TEST IF MATCH WAS FOUND                   40000000
         BZ    GOTCB1         TO GET NEXT TCB ON CHAIN                  40080000
         L     R6,OFFSET-TSTCWORK(R8)  ACCESS GROSS OFFSET              40160000
         AR    R6,R0          LOAD ADDR + GROSS OFFSET = ASOLUTE ADDR   40240000
         LA    R6,@0(R6)      CLEAR HI ORDER BYTE                       40320000
         LA    R10,PDESAVE-TSTCWORK(R8) ACCESS ADDR OF ORIGINAL PDE     40400000
         TM    @14(R10),CTNAMFLG TEST IF CSECT NAME PRESENT             40480000
         BNO   TPRINT         TO PRINT MSG                              40560000
GOPRNT   DS    0X                                                       40640000
         ST    R6,PDEUSER     STORE ABSOLUTE ADDR IN PDEUSER            40720000
         BAL   R14,OFFMSG     BRANCH TO PRINT MESSAGE                   40800000
         L     R1,TCBSAVE-TSTCWORK(R8) ACCESS CURRENT TCB               40880000
         LTR   R11,R11        TEST FOR RETURN ADDRESS FROM CDESRCH      40960000
         BZ    GOTCB1         IF NONE, GET NEXT TCB                     41040000
         BR    R11            OTHERWISE BRANCH BACK TO CDESRCH          41120000
TPRINT   DS    0X                                                       41200000
         L     R10,USERSAVE-TSTCWORK(R8) ACCESS ORIG CONVERTED ADDR     41280000
         CR    R6,R10         DOES ORIG ADDR = CALCULATED ADDR          41360000
         BE    GOPRNT         IF SO, PRINT MSG                          41440000
         LTR   R11,R11        OTHERWISE CHECK FOR CDESRCH RETURN ADDR   41520000
         BZ    GOTCB1         IF NONE, GET NEXT TCB                     41600000
         BR    R11            OTHERWISE, BRANCH INTO CDESRCH            41680000
ENDCHAIN DS    0X                                                       41760000
         BAL   R14,REGMSG     TO PUT OUT DIAGNOSTIC  MSG                41840000
         XR    R15,R15        INDICATE ZERO RETURN CODE                 41920000
         B     GOHOME         RETURN TO PARSE                           42000000
*                                                                       42080000
LINKSYM  DS    0X                                                       42160000
NOBLDL   LA    R4,I0085       IKJEGSYM INSERT                           42240000
         LINK  EP=IKJEGSYM,ERRET=LINKFL2  LINK TO SYM                   42320000
BLOW2    DS    0X                                                       42400000
BLOW3    DS    0X              STAE RESUME ADDRESS                      42480000
SMTSYM02 DS    0X             TEST CASE TTSTC120                        42560000
         BR    R11            RETURN IN LINE                            42640000
         EJECT                                                          42720000
*********************************************************************** 42800000
* THIS CODE SEARCHES THE EXTENT LISTS ON THE TCB PASSED IN REG 1      * 42880000
* FOR THE ADDRESS IN PDEUSER.  THE LOADED AT ADDRESS IS USED TO       * 42960000
* ASSOCIATE AN ADDRESS WITH A LOADNAME. A POINTER TO THE LOADNAME     * 43040000
* IS RETURNED IN REG 0, AND A GROSS OFFSET (PDEUSER-LOADED AT         * 43120000
* ADDRESS) IS STORED IN WORKAREA.                                     * 43200000
*********************************************************************** 43280000
XLSTSRCH DS    0X                                                       43360000
         XR    R0,R0          INIT R0 TO INDICATE CTN NOT FOUND         43440000
         L     R8,WORKAREA    ACCESS WORKAREA POINTER                   43520000
         LA    R8,ALIASAVE-TSTCWORK(R8) ACCESS PTR TO ALIAS SAVE AREA   43600000
         MVI   @0(R8),BLANK   TO BLANK OUT ALIAS SAVE                   43680000
         MVC   @1(@7,R8),@0(R8)  INITIALIZE ALIAS SAVE                  43760000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              43840000
         L     R2,TCBRBP      ACCESS RB PTR                             43920000
         USING RBSECT,R2      ESTABLISH RB ADDRESSABILITY               44000000
RBLOOP   DS    0X                                                       44080000
         TM    RBSTAB,HEXC0   TEST IF PRB                               44160000
         BNZ   NXTRB          IF NOT, GET NEXT RB                       44240000
         L     R3,RBCDE       IF SO, ACCESS CDE PTR                     44320000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       44400000
         LTR   R3,R3          PTR EQUAL ZERO                            44480000
         BZ    NXTRB          IF SO, SKIP THIS CDE                      44560000
CDELOOP  DS    0X                                                       44640000
         USING CDENTRY,R3     ESTABLISH CDE ADDRESSABILITY              44720000
         TM    CDATTR,CDMIN   CHECK FOR ALIAS (MINOR CDE)      @YM07131 44800000
         BNO   CONTCDE        IF NOT ALIAS, GET XLST PTR                44880000
         L     R8,WORKAREA    ACCESS WORKAREA POINTER                   44960000
         MVC   ALIASAVE-TSTCWORK(@8,R8),CDNAME SAVE ALIAS IN WORKAREA   45040000
         L     R3,CDXLMJP     ACCESS MAJOR CDE                          45120000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       45200000
CONTCDE  DS    0X                                                       45280000
         L     R5,CDXLMJP     ACCESS XLST PTR                           45360000
         USING XTLST,R5       ESTABLISH XLST ADDRESSABILITY             45440000
         TM    CDATTR2,HEX80  TEST FOR OBJECT                           45520000
         L     R6,XTLMSBAA    ACCESS LOADED AT ADDRESS                  45600000
         BNO   GETLOC         CONTINUE PROCESSING                       45680000
         LA    R15,@2         FOR FUTURE COMPARISON                     45760000
         CL    R15,XTLNRFAC   DETERMINE IF TWO ENTRIES                  45840000
         BNE   GETLOC         CONTINUE PROCESSING                       45920000
         L     R6,XTLMSBAA+@4    ACCESS LOADED AT ADDRESS               46000000
GETLOC   DS    0X                                                       46080000
         LA    R6,@0(R6)      CLEAR HI ORDER BYTE                       46160000
         L     R11,XTLMSBLA   ACCESS LENGTH OF CSECT                    46240000
         LA    R11,@0(R6,R11) CREATE END ADDR FOR CSECT                 46320000
         L     R8,PDEUSER     ACCESS ADDR IN PDEUSER                    46400000
         CLR   R6,R8          PDEUSER G.T. THIS LOADED AT ADDR          46480000
         BH    XLSTLOOP       IF NOT GET NEXT CDE                       46560000
         CLR   R11,R8         PDEUSER L.T. CSECT END ADDR               46640000
         BNH   XLSTLOOP       IF NOT, GET NEXT CDE                      46720000
         SLR   R8,R6          COMPUTE OFFSET                            46800000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       46880000
         ST    R8,OFFSET-TSTCWORK(R2) STORE GROSS OFFSET                46960000
         LA    R0,CDNAME      RETURN PTR TO LOADNAME                    47040000
RETHOME  DS    0X                                                       47120000
         NI    TSTFLGS2,HEXDF TURN OFF LOAD LIST INDICATOR              47200000
         BR    R14            RETURN AND GET ANOTHER TCB                47280000
XLSTLOOP DS    0X                                                       47360000
         TM    TSTFLGS2,TOFFDEF ARE WE USING LOAD LIST CDE'S            47440000
         BO    GOLLE          IF SO, GET NEXT LLE                       47520000
NXTRB    DS    0X                                                       47600000
         L     R2,RBLINK      OTHERWISE ACCESS NEXT RB                  47680000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       47760000
         CR    R1,R2          DOES RBLINK POINT TO TCB                  47840000
         BNE   RBLOOP         IF NOT, PROCESS THIS RB                   47920000
         L     R2,TCBLLS      OTHERWISE, ACCESS LOAD LIST PTR           48000000
         OI    TSTFLGS2,TOFFDEF INDICATE USING LOAD LIST, NOT RB        48080000
         DROP  R2                                                       48120003
         USING LLE,R2         ESTABLISH LOAD LIST ADDRESSABILITY        48160000
LLELOOP  DS    0X                                                       48240000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       48320000
         LTR   R2,R2          TEST FOR END OF LOAD LIST                 48400000
         BZ    RETHOME        IF END OF LOAD LIST, BRANCH               48480000
         L     R3,LLECDPT     OTHERWISE, GET CDE PTR                    48560000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       48640000
         LTR   R3,R3          PTR EQUAL ZERO                            48720000
         BZ    XLSTLOOP       IF SO, SKIP THIS CDE                      48800000
         B     CDELOOP        TO PROCESS NEXT CDE                       48880000
GOLLE    DS    0X                                                       48960000
         L     R2,LLECHN      ACCESS PTR TO NEXT LLE                    49040000
         B     LLELOOP        TO PROCESS LLE                            49120000
         DROP  R1                                                       49130003
         DROP  R2                                                       49140003
         DROP  R3                                                       49150003
         DROP  R5                                                       49160003
         EJECT                                                          49200000
*********************************************************************** 49280000
* THIS CODE SEARCHES THE TCB PASSED IN REG1 FOR THE LOADNAME INDICATED* 49360000
* IN PDELDNAM. WHEN THE LOADNAME IS FOUND, THE LOADED AT ADDRESS IS   * 49440000
* PASSED BACK IN REG0. IF NOT FOUND, REG0 CONTAINS ZEROES. IF R11     * 49520000
* IS ZERO THE NEXT TCB TO BE SEARCHED SHOULD BE RETURNED IN REG1. IF  * 49600000
* REG11 HAS AN ADDR THEN THE CALLER SHOULD BRANCH ON REG11 SO THAT    * 49680000
* THE REST OF THE CDE'S ON THE PRESENT TCB CAN BE SEARCHED.           * 49760000
*********************************************************************** 49840000
CDESRCH  DS    0X              REG1 POINTS TO TCB- REG7 POINTS TO PDE   49920000
         L     R8,WORKAREA    ACCESS WORKAREA                           50000000
         ST    R14,RETURN-TSTCWORK(R8) SAVE RETURN ADDR                 50080000
         XR    R0,R0          INIT R0 TO INDICATE LO                    50160000
         XR    R11,R11        ZERO POSSIBLE RETURN ADDR                 50240000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              50320000
         L     R3,TCBRBP      ACCESS RB POINTER                         50400000
         USING RBSECT,R3      ESTABLISH RB ADDRESSABILITY               50480000
RBPROC   DS    0X                                                       50560000
         LA    R3,@0(R3)      ZERO HI ORDER BYTE                        50640000
         CR    R1,R3          DOES RBLINK POINT TO TCB                  50720000
         BE    INITLLE        IF SO,USE LLE CDE                         50800000
         TM    RBSTAB,HEXC0   TEST IF PRB                               50880000
         BNZ   NEXTRB         IF NOT, GET NEXT RB IN CHAIN              50960000
         L     R5,RBCDE       ACCESS ADDR OF CDE                        51040000
         LA    R5,0(R5)       CLEAR HI ORDER BYTE                       51120000
         LTR   R5,R5          DOES PTR EQUAL ZERO                       51200000
         BZ    NEXTRB         IF SO, SKIP THIS CDE                      51280000
USECDE   DS    0X                                                       51360000
         USING CDENTRY,R5     ESTABLISH CDE ADDRESSABILITY              51440000
CDEPROC  DS    0X                                                       51520000
         LA    R8,CDNAME      ACCESS ADDR OF LOADNAME                   51600000
         LA    R8,@7(R8)      UPDATE TO END OF LOADNAME                 51680000
         LA    R6,@8          INITIALIZE LENGTH COUNTER                 51760000
REMBLNK  DS    0X                                                       51840000
         CLI   @0(R8),BLANK   TEST FOR BLANK PADDING                    51920000
         BNE   COMPLEN        ALL PADDING REMOVED                       52000000
         BCTR  R8,R0          DECREMENT POINTER                         52080000
         BCTR  R6,R0          DECREMENT COUNTER                         52160000
         B     REMBLNK        TEST FOR BLANK PADDING LOOP               52240000
COMPLEN  DS    0X                                                       52320000
         LH    R15,PDELEN1    ACCESS LENGTH OF LOADNAME IN PDE          52400000
         CLR   R15,R6         ARE LOADNAME LENGTHS EQUAL                52480000
         BNE   NOCOMP         IF NOT, DO NOT COMPARE LOADNAMES          52560000
         BCTR  R6,R0          DECREMENT FOR EXECUTE                     52640000
         L     R8,PDELDNAM    ACCESS PTR TO LOADNAME                    52720000
         EX    R6,LDNCOMPR    TO COMPARE FOR LOADNAME MATCH             52800000
         BE    CHKDUP         IF = CHECK IF ITS A DUPLICATE             52880000
NOCOMP   DS    0X                                                       52960000
         TM    CDATTR,CDMIN   CHECK FOR ALIAS (MINOR CDE)      @YM07131 53040000
         BNO   NEXTRB         IF NOT ALIAS, BRANCH                      53120000
         L     R5,CDXLMJP     ACCESS MAJOR CDE                          53200000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       53280000
         B     CDEPROC        PROCESS MINOR CDE                         53360000
LDNCOMPR CLC   @0(@1,R8),CDNAME  COMPARE LOADNAMES                      53440000
NEXTRB   DS    0X                                                       53520000
         TM    TSTFLGS2,TOFFDEF TEST IF SEARCHING LOAD LIST CDE         53600000
         BO    GETLLE         IF SO, GET NEXT LLE                       53680000
         L     R3,RBLINK      OTHERWISE ACESS NEXT RB                   53760000
         B     RBPROC         PROCESS RB                                53840000
INITLLE  DS    0X             GET CDE POINTER FROM LLE                  53920000
         L     R3,TCBLLS      OTHERWISE, ACCESS ADDR OF LOADLIST        54000000
         OI    TSTFLGS2,TOFFDEF INDICATE USING LOAD LIST, NOT RB        54080000
         DROP  R3                                                       54120003
USELLE   DS    0X                                                       54160000
         USING LLE,R3         ESTABLISH LOAD LIST ADDRESSABILITY        54240000
         LA    R3,@0(R3)      ZERO HI ORDER BYTE                        54320000
         LTR   R3,R3          END OF LOAD LIST                          54400000
         BZ    RETCALL        IF SO, RETURN TO CALLER                   54480000
         L     R5,LLECDPT     ACCESS PTR TO CDE                         54560000
         LA    R5,0(R5)       CLEAR HI ORDER BYTE                       54640000
         LTR   R5,R5          DOES PTR EQUAL ZERO                       54720000
         BZ    GETLLE         IF SO, SKIP THIS CDE                      54800000
         B     USECDE         BRANCH TO PROCESS CDE                     54880000
GETLLE   DS    0X                                                       54960000
         L     R3,LLECHN      ACCESS PTR TO NEXT LLE                    55040000
         B     USELLE         TO PROCESS LLE                            55120000
         DROP  R3                                                       55160003
RETCALL  DS    0X                                                       55200000
         NI    TSTFLGS2,HEXDF TURN OFF LOAD LIST INDICATOR              55280000
         L     R8,WORKAREA    ACCESS WORKAREA                           55360000
         L     R14,RETURN-TSTCWORK(R8) ACCESS RETURN ADDRESS            55440000
         BR    R14            RETURN TO CALLER                          55520000
CHKDUP   DS    0X                                                       55600000
         L     R8,WORKAREA    ACCESS WORKAREA PTR                       55680000
         ST    R5,CDESAVE-TSTCWORK(R8)  STORE CDE ADDRESS               55760000
         ST    R1,TCBSAVE-TSTCWORK(R8)  STORE TCB ADDRESS               55840000
         LA    R3,@0(R3)                CLEAR HI ORDER BYTE             55920000
         ST    R3,RBSAVE-TSTCWORK(R8)   STORE RB ADDRESS                56000000
         TM    CDATTR,CDMIN   TEST IF ALIAS (MINOR CDE)        @YM07131 56080000
         BNO   CONTDUP        BRANCH IF NOT ALIAS                       56160000
         L     R5,CDXLMJP     ACCESS MAJOR CDE                          56240000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       56320000
CONTDUP  DS    0X                                                       56400000
         L     R4,CDXLMJP     ACCESS POINTER TO XTENT LIST              56480000
         USING XTLST,R4       ESTABLISH XTENT LIST ADDRESSABILITY       56560000
         TM    CDATTR2,HEX80  TEST FOR OBJECT                           56640000
         L     R0,XTLMSBAA    ACCESS LOADED AT ADDRESS                  56720000
         BNO   GETLOC2        CONTINUE PROCESSING                       56800000
         LA    R15,@2         FOR FUTURE COMPARISON                     56880000
         CL    R15,XTLNRFAC   DETERMINE IF TWO ENTRIES                  56960000
         BNE   GETLOC2        CONTINUE PROCESSING                       57040000
         L     R0,XTLMSBAA+@4  ACCESS LOADED AT ADDRESS                 57120000
         DROP  R4                                                       57160003
GETLOC2  DS    0X                                                       57200000
         ST    R0,LOADSAVE-TSTCWORK(R8) STORE LOADED AT ADDRESS         57280000
         BAL   R10,CDESRCH2   TO TEST FOR DUPLICATE LOADNAMES           57360000
         LTR   R0,R0          TEST IF DUPLICATE FOUND                   57440000
         BZ    NEXTRB         IF DUPLICATE, BRANCH TO CONTINUE CHAIN    57520000
         L     R14,RETURN-TSTCWORK(R8) RELOAD RETURN ADDRESS            57600000
         BALR  R11,R14        TO TELL CALLER TO PUT OUT MSG             57680000
         XR    R0,R0          INITIALIZE REGISTER 0                     57760000
         L     R8,WORKAREA    ACCESS WORKAREA ADDRESS                   57840000
         L     R3,RBSAVE-TSTCWORK(R8)  RESTORE RB POINTER               57920000
         L     R1,TCBSAVE-TSTCWORK(R8) RESTORE TCB POINTER              58000000
         B     NEXTRB         CONTINUE PROCESSING CHAIN                 58080000
CDESRCH2 DS    0X                                                       58160000
         L     R3,TCBRBP      ACCESS FIRST RB ON CHAIN                  58240000
         USING RBSECT,R3      ESTABLISH RB ADDRESSABILITY               58320000
RBPROC2  DS    0X                                                       58400000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       58480000
         CR    R1,R3          DOES RB POINT TO TCB                      58560000
         BE    INITLLE2       ACCESS LOAD LIST                          58640000
         TM    RBSTAB,HEXC0   TEST IF PRB                               58720000
         BNZ   NEXTRB2        IF NOT, GET NEXT RB                       58800000
         L     R5,RBCDE       ACCESS POINTER TO CDE                     58880000
         LA    R5,0(R5)       CLEAR HI ORDER BYTE                       58960000
         LTR   R5,R5          DOES PTR EQUAL ZERO                       59040000
         BZ    NEXTRB2        IF SO, SKIP THIS CDE                      59120000
USECDE2  DS    0X                                                       59200000
         L     R6,CDESAVE-TSTCWORK(R8) ACCESS STORED CDE                59280000
         CR    R5,R6          COMPARE CDE POINTERS                      59360000
         BNE   TSTMJCDE       GET NEXT RB                               59440000
         L     R6,RBSAVE-TSTCWORK(R8) ACCESS STORED RB OR LLE           59520000
         LA    R6,@0(R6)      CLEAR HI ORDER BYTE                       59600000
         CR    R6,R3          COMPARE RB OR LLE                         59680000
         BCR   @8,R10         IF EQUAL, DUPLICATE SEARCH ENDED          59760000
         XR    R0,R0          INDICATE DUPLICATE - DO NOT PRINT MSG     59840000
         LR    R3,R6          RESTORE ORIGINAL RB OR LLE                59920000
         BR    R10            CONTINUE PROCESSING                       60000000
NEXTRB2  DS    0X                                                       60080000
         CLI   RBSAVE-TSTCWORK(R8),HEX80 TEST IF SEARCHING LOAD LIST    60160000
         BE    GETLLE2        IF SO, GET NEXT LLE                       60240000
         L     R3,RBLINK      IF NOT, GET NEXT RB                       60320000
         B     RBPROC2        PROCESS RB                                60400000
TSTMJCDE DS    0X                                                       60480000
         TM    CDATTR,CDMIN   CHECK FOR ALIAS (MINOR CDE)      @YM07131 60560000
         BNO   NEXTRB2        GET NEXT RB                               60640000
         L     R5,CDXLMJP     ACCESS MAJOR CDE                          60720000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       60800000
         B     USECDE2        PROCESS MAJOR CDE                         60880000
INITLLE2 DS    0X                                                       60960000
         L     R3,TCBLLS      OTHERWISE, ACCESS LOAD LIST PTR           61040000
         MVI   RBSAVE-TSTCWORK(R8),HEX80 TURN ON LLE INDICATOR          61120000
USELLE2  DS    0X                                                       61200000
         USING LLE,R3         ESTABLISH LLE ADDRESSABILITY              61280000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       61360000
         LTR   R3,R3          * THIS SITUATION SHOULD *                 61440000
         BCR   @8,R10         *   NEVER HAPPEN        *                 61520000
         L     R5,LLECDPT     ACCESS CDE PTR                            61600000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       61680000
         B     USECDE2        IF NOT, PROCESS CDE                       61760000
GETLLE2  DS    0X                                                       61840000
         L     R3,LLECHN      ACCESS NEXT LLE                           61920000
         B     USELLE2        PROCESS LLE                               62000000
         DROP  R1                                                       62020003
         DROP  R3                                                       62040003
         DROP  R5                                                       62060003
         EJECT                                                          62080000
*********************************************************************** 62160000
* THIS ROUTINE EXPECTS A TCB POINTER IN R1 AND THE ORIGINAL TCB MOTHER* 62240000
* STORED IN TCBCHAI IN WORKAREA  IT USES A MOTHER-DAUGHTER-SISTER     * 62320000
* CHAIN SEARCH AND RETURNS THE NEXT TCB IN R1. IF END OF CHAIN, R1=0  * 62400000
*********************************************************************** 62480000
TCBCHAIN DS    0X                                                       62560000
         LR    R2,R1          PUT TCB ADDRESS IN R2                     62640000
         L     R1,TCBLTC-TCB(R2) ACCESS DAUGHTER TASK PTR               62720000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       62800000
         LTR   R1,R1          TEST IF DAUGHTER EXISTS                   62880000
         BCR   @2,R14         IF NOT ZERO, RETURN TCB IN R1             62960000
SISTER   DS    0X                                                       63040000
         L     R1,TCBNTC-TCB(R2) IF NO DAUGHTER, GET SISTER             63120000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       63200000
         LTR   R1,R1          TEST IF SISTER EXISTS                     63280000
         BCR   @2,R14         IF NOT ZERO, RETURN TCB IN R1             63360000
         L     R2,TCBOTC-TCB(R2) IF NO SISTER, GET MOTHER               63440000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       63520000
         L     R11,WORKAREA   ACCESS WORKAREA PTR                       63600000
         L     R11,TCBCHAI-TSTCWORK(R11) ACCESS MOTHER TCB              63680000
         CR    R2,R11         DOES MOTHER = TEST TASK                   63760000
         BNE   SISTER         IF NOT GET MOTHER'S SISTER                63840000
         XR    R1,R1          INDICATE END OF TCB CHAIN                 63920000
         BR    R14            RETURN TCB ADDR TO CALLER                 64000000
         EJECT                                                          64080000
*********************************************************************** 64160000
*                          MESSAGE TEXT                               * 64240000
* ......LOCATED AT +... IN ..............UNDER TCB LOCATED AT.......  * 64320000
*********************************************************************** 64400000
OFFMSG   DS    0X                                                       64480000
         LR    R3,R14         SAVE RETURN ADDRESS                       64560000
         L     R4,OUTBUF      POINTER TO OUTBUF                         64640000
         XR    R2,R2          ZERO REGISTER TWO                         64720000
         STH   R2,@2(R4)     ZERO UNUSED FIELD                          64800000
         LA    R2,@81         ACCESS LENGTH OF MSG                      64880000
         STH   R2,@0(R4)      CONSTANT MSG LENGTH = 81                  64960000
         LA    R4,@4(R4)      POINTER TO ACTUAL MSG DATA                65040000
         MVI   @0(R4),BLANK   PUT BLANK IN MSG BUFFER                   65120000
         MVC   @1(@77,R4),@0(R4)  BLANK OUT MSG BUFFER                  65200000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              65280000
         L     R2,PDEUSER     ACCESS ABSOLUTE ADDRESS                   65360000
         BAL   R14,CONVERT    TO CONVERT ADDRESS TO PRINTABLE EBCDIC    65440000
         EX    R10,ADDRMVC    PUT CONVERTED ADDRESS IN BUFFER           65520000
         LA    R10,@2(R10,R4) UPDATE BUFFER POINTER                     65600000
         MVI   @0(R10),DOT    PUT PERIOD AFTER ABSOLUTE ADDRESS         65680000
         LA    R2,MDATA1      ACCESS PTR TO 'LOCATED AT'                65760000
         MVC   @8(@12,R4),@0(R2) PUT 'LOCATED AT' IN MSG BUFFER         65840000
         MVI   @20(R4),HEX4E  PUT PLUS SIGN BEFORE OFFSET               65920000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       66000000
         L     R2,OFFSET2-TSTCWORK(R2) ACCESS CALCULATED OFFSET         66080000
         BAL   R14,CONVERT    TO CONVERT OFFSET TO PRINTABLE EBCDIC     66160000
         EX    R10,OFFMVC     PUT CONVERTED OFFSET IN BUFFER            66240000
         LA    R2,MDATA2      ACCESS 'IN'                               66320000
         MVC   @28(@2,R4),@9(R2) PUT 'IN' INTO MSG BUFFER               66400000
         LH    R2,PDELEN1     ACCESS LENGTH OF LOADNAME                 66480000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     66560000
         L     R5,PDELDNAM    ACCESS PTR TO LOADNAME                    66640000
         EX    R2,LDNMVC      TO MOVE LOADNAME INTO MESSAGE             66720000
         MVI   @39(R4),DOT    PUT PERIOD TO INDICATE ABSOLUTE ADDR      66800000
         LH    R2,PDELEN2     ACCESS LENGTH OF CSECTNAME                66880000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     66960000
         L     R5,PDECTNAM    ACCESS PTR TO CSECT NAME                  67040000
         EX    R2,CTNMVC      TO MOVE CSECTNAME INTO MESSAGE            67120000
         LA    R2,MDATA3      ACCESS 'UNDER TCB'                        67200000
         MVC   @48(@22,R4),@0(R2) PUT 'UNDER TCB' IN MSG BUFFER         67280000
         LR    R2,R1          ACCESS TCB ADDR                           67360000
         BAL   R14,CONVERT    TO CONVERT TCB ADDRESS                    67440000
         EX    R10,TCBMVC     PUT CONVERTED TCB ADDRESS IN BUFFER       67520000
         LA    R10,@71(R10,R4) UPDATE BUFFER POINTER                    67600000
         MVI   @0(R10),DOT    PUT PERIOD AFTER TCB ADDRESS              67680000
         L     R1,OUTBUF      ACCESS PTR TO OUTPUT BUFFER               67760000
         BAL   R14,PUTMSG     TO BRANCH TO IO                           67840000
         BR    R3             RETURN TO CALLER                          67920000
ADDRMVC  MVC   @1(@1,R4),@0(R2) PUT CONVERTED ADDRESS IN MSG BUFFER     68000000
OFFMVC   MVC   @21(@1,R4),@0(R2) PUT CONVERTED OFFSET INTO MSG BUFFER   68080000
TCBMVC   MVC   @70(@1,R4),@0(R2) PUT CONVERTED ADDR INTO MSG BUFFER     68160000
*********************************************************************** 68240000
*                          MESSAGE TEXT                               * 68320000
*  .......LOCATED IN................UNDER TCB LOCATED AT.......       * 68400000
*********************************************************************** 68480000
LDNMSG   DS    0X                                                       68560000
         LR    R3,R14         SAVE RETURN ADDRESS                       68640000
         L     R4,OUTBUF      ACCESS PTR TO OUTPUT BUFFER               68720000
         XR    R2,R2          ZERO REGISTER TWO                         68800000
         STH   R2,@2(R4)      ZERO UNUSED FIELD                         68880000
         LA    R2,@71         ACCESS LENGTH OF MSG                      68960000
         STH   R2,@0(R4)      CONSTANT MSG LENGTH =71                   69040000
         LA    R4,@4(R4)      POINTER TO ACTUAL MSG DATA                69120000
         MVI   @0(R4),BLANK   PUT BLANK IN MSG BUFFER                   69200000
         MVC   @1(@67,R4),@0(R4)  BLANK OUT MSG BUFFER                  69280000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              69360000
         LH    R2,PDELEN1     ACCESS LENGTH OF LOADNAME                 69440000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     69520000
         L     R5,PDELDNAM    ACCESS PTR TO LOADNAME                    69600000
         EX    R2,LDNMVC2     TO MOVE LOADNAME INTO MSG                 69680000
         TM    PDEFLG2,CTNAMFLG TEST IF CSECT NAME SPECIFIED            69760000
         BNO   CONTMSG        DO NOT PUT IN CSECT NAME                  69840000
         MVI   @9(R4),DOT     PUT PERIOD BETWEEN LOADNAME-CSECTNAME     69920000
         LH    R2,PDELEN2     ACCESS LENGTH OF CSECTNAME                70000000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     70080000
         L     R5,PDECTNAM    ACCESS PTR TO CSECT NAME                  70160000
         EX    R2,CTNMVC2     TO MOVE CSECT NAME INTO MSG               70240000
         LA    R4,@9(R4)      UPDATE FOR POINTER UNIFORMITY             70320000
CONTMSG  DS    0X                                                       70400000
         LA    R2,MDATA1      ACCESS 'LOCATED AT'                       70480000
         MVC    @9(@12,R4),@0(R2) PUT'LOCATED AT' IN MSG BUFFER         70560000
         L     R2,PDEUSER     ACCESS ABSOLUTE ADDRESS                   70640000
         BAL   R14,CONVERT    TO CONVERT ADDRESS TO PRINTABLE EBCDIC    70720000
         EX    R10,A2MVC      PUT CONVERTED ADDRESS IN BUFFER           70800000
         LA    R10,@22(R10,R4) UPDATE BUFFER POINTER                    70880000
         MVI   @0(R10),DOT    PUT PERIOD AFTER ABSOLUTE ADDRESS         70960000
         LA    R2,MDATA3      ACCESS 'UNDER TCB'                        71040000
         MVC   @28(@22,R4),@0(R2) PUT'UNDER TCB' IN MSG BUFFER          71120000
         LR    R2,R1          ACCESS TCB ADDRESS                        71200000
         BAL   R14,CONVERT    TO CONVERT TCB ADDRESS                    71280000
         EX    R10,T2MVC      PUT CONVERTED TCB ADDRESS IN BUFFER       71360000
         LA    R10,@51(R10,R4) UPDATE BUFFER POINTER                    71440000
         MVI   @0(R10),DOT    PUT PERIOD AFTER TCB ADDRESS              71520000
         L     R1,OUTBUF      ACCESS ADDR OF OUTPUT BUFFER              71600000
         BAL   R14,PUTMSG     TO BRANCH TO IO                           71680000
         BR    R3             RETURN TO CALLER                          71760000
A2MVC    MVC   @21(@1,R4),@0(R2) PUT CONVERTED ADDRESS IN MSG BUFFER    71840000
T2MVC    MVC   @50(@1,R4),@0(R2) PUT CONVERTE ADDR INTO MSG BUFFER      71920000
*********************************************************************** 72000000
*                          MESSAGE TEXT                               * 72080000
*                   'NOT WITHIN ANY PROGRAM EXTENT'                   * 72160000
*********************************************************************** 72240000
REGMSG   DS    0X                                                       72320000
         LR    R3,R14         SAVE RETURN ADDRESS                       72400000
         L     R4,OUTBUF      POINTER TO OUTBUF                         72480000
         XR    R2,R2          ZERO REGISTER TWO                         72560000
         STH   R2,@2(R4)      ZERO UNUSED FIELD                         72640000
         LA    R4,@4(R4)      POINTER TO ACTUAL MSG DATA                72720000
         MVI   @0(R4),BLANK   PUT BLANK IN MSG BUFFER                   72800000
         MVC   @1(@48,R4),@0(R4)  BLANK OUT MSG BUFFER                  72880000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              72960000
         L     R2,PDEUSER     ACCESS ABSOLUTE ADDRESS                   73040000
         BAL   R14,CONVERT    TO CONVERT ADDRESS TO PRINTABLE EBCDIC    73120000
         EX    R10,A3MVC      PUT CONVERTED ADDRESS IN BUFFER           73200000
         LA    R4,@2(R10,R4)  UPDATE BUFFER POINTER                     73280000
         LA    R5,@38         BASE LENGTH OF MESSAGE                    73360000
         LA    R5,@1(R10,R5)  ADD VARIABLE LENGTH TO BASE LENGTH        73440000
         MVI   @0(R4),DOT     PUT PERIOD AFTER ABSOLUTE ADDRESS         73520000
         LA    R1,@2(R4)      CREATE PTR TO BUFFER FOR TSTADDR          73600000
         LR    R0,R7          PTR TO PDE FOR TSTADDR                    73680000
         L     R15,TSTADDR    ACCESS ADDR OF TSTADDR                    73760000
         BALR  R14,R15        BRANCH TO TSTADDR                         73840000
         LR    R10,R0         ACCESS LENGTH OF ADDR STRING              73920000
         LA    R5,@0(R10,R5)  ADD VARIABLE LENGTH TO CURRENT MSG LENGTH 74000000
         L     R10,OUTBUF     ACCESS ADDR OF OUTBUF                     74080000
         STH   R5,@0(R10)     STORE MSG LENGTH IN OUTBUF                74160000
         LA    R4,@1(R1)      CREATE POINTER TO NEXT AVAILABLE SPACE    74240000
         LA    R2,MDATA4      ACCESS MSG DATA                           74320000
         MVC   @0(@30,R4),@0(R2) PUT DATA IN MSG BUFFER                 74400000
         L     R1,OUTBUF      ACCESS ADDRESS OF OUTBUF                  74480000
         BAL   R14,PUTMSG     TO BRANCH TO IO                           74560000
         BR    R3             RETURN TO CALLER                          74640000
A3MVC    MVC   @1(@1,R4),@0(R2) PUT CONVERTED ADDRESS IN MSG BUFFER     74720000
PUTMSG   DS    0X             TO BRANCH TO IO                           74800000
PUTC     DS    0X                                                       74880000
         LR    R2,R14         SAVE RETURN ADDRESS                       74960000
         LR    R4,R1          REG 4 = PTR TO DATA                       75040000
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  75120000
         IKJEGSIO DATA,DATAPTR=(R4),ID=WHR32,MF=(E,TSTIOPRM)            75200000
         CH    R15,ATTNCODE   IS RET CODE LESS 16                       75280000
         BNL   PARS12         NO, GO SAVE RET CODE                      75360000
         BR    R2             YES, RETURN TO CALLER                     75440000
PARS12   EQU   *              RETURN TO PARSE WITH 12                   75520000
         L     R14,WORKAREA   ACCESS WORKAREA PTR                       75600000
         ST    R15,CODESAVE-TSTCWORK(R14)                               75680000
         LA    R15,@12        IN CASE RET CODE IS 16                    75760000
         B     GOHOME         RETURN TO PARSE WITH 12                   75840000
CONVERT  DS    0X              TO CONVERT TO PRINTABLE EBCDIC           75920000
         L     R5,WORKAREA    ACCESS ADDR OF WORKAREA                   76000000
         LA    R5,CWORKCMD-TSTCWORK(R5) ACCESS COMMAND PORTION          76080000
         ST    R2,@12(R5)     STORE ADDR TO BE CONVERTED                76160000
         UNPK  @0(@7,R5),@13(@4,R5) UNPACK ADDRESS                      76240000
         TR    @0(@6,R5),TRTAB-@240 CONVERT TO EBCDIC                   76320000
         LR    R2,R5          PUT ADDR OF CONVERTED STRING IN R2        76400000
         LA    R10,@5         INITIALIZE LENGTH COUNTER                 76480000
REMZ     DS    0X              THIS LOOP WILL REMOVE LEADING ZEROES     76560000
         CLI   @0(R2),ZERO    TEST FOR LEADING ZERO                     76640000
         BCR   @7,R14         IF NOT ZERO RETURN TO CALLER              76720000
         LA    R2,@1(R2)      INCREMENT ADDRESS POINTER                 76800000
         BCT   R10,REMZ       DECREMENT COUNTER AND BRANCH IF NOT ZERO  76880000
         BR    R14            RETURN TO CALLER IF COUNTER = ZERO        76960000
         EJECT                                                          77040000
GOHOME   DS    0X                                                       77120000
         NI    TSTFLGS4,HEXFF-TSTVALCK  SHUT OFF VALIDITY FLAG          77200000
         L     R4,OUTBUF      ACCESS POINTER TO OUTBUF                  77280000
         L     R4,@0(R4)      ACCESS 1ST WORD OF OUTBUF                 77360000
         LTR   R4,R4          IS THERE A SECOND LEVEL MSG               77440000
         BZ    PARSRET        NO, RETURN TO PARSE                       77520000
         L     R8,WORKAREA    ACCESS WORKAREA                           77600000
         L     R11,MSGADDR-TSTCWORK(R8) ACCESS PTR TO PARSE PARMLIST    77680000
         MVC   @0(@4,R11),OUTBUF GIVE IT TO PARSE                       77760000
PARSRET  EQU   *              RETURN TO PARSE                           77840000
         L     R2,WORKAREA    ACCESS WORKAREA ADDR                      77920000
         MVC   @0(@25,R7),PDESAVE-TSTCWORK(R2) RESTORE ORIGINAL PDE     78000000
         L     R13,@4(R13)    ACCESS CALLER'S SAVE AREA                 78080000
         RETURN (14,12),RC=(15) RETURN TO PARSE                         78160000
         EJECT                                                          78240000
CODECHK  DS    0X             CHECK RETURN CODE FROM CONVERT            78320000
         B     BTAB(R15)      BRANCH ACCORDING TO RETURN CODE           78400000
BTAB     BR    R14            IF RETURN CODE = 0                        78480000
         BR    R14            FOR ALIGNMENT PURPOSES                    78560000
         B     CONVMSG        IF RETURN CODE = 4                        78640000
         B     CONVMSG        IF RETURN CODE = 8                        78720000
         B     CONVMSG        IF RETURN CODE = 12                       78800000
         B     SYMSTAE        IF RETURN CODE = 16                       78880000
         B     CONVMSG        IF RETURN CODE = 20                       78960000
CODECHK2 DS    0X             CHECK RETURN CODE FROM SYM                79040000
         B     BTAB2(R15)     BRANCH ACCORDING TO RETURN CODE           79120000
BTAB2    BR    R14            IF RETURN CODE = 0                        79200000
         BR    R14            FOR ALIGNMENT PURPOSES                    79280000
         B     TRYALIAS       IF RETURN CODE = 4                        79360000
         B     TRYALIAS       IF RETURN CODE = 8                        79440000
         B     CONVMSG        IF RETURN CODE = 12                       79520000
         B     SYMSTAE        IF RETURN CODE = 16                       79600000
         B     SYMSTAE        IF RETURN CODE = 20                       79680000
CONVMSG  DS    0X             ENTER HERE FOR RETURN CODE 8              79760000
         LA    R15,@8         SET RETURN CODE TO 8                      79840000
         B     GOHOME         RETURN TO PARSE                           79920000
SYMSTAE  DS    0X              ENTER HERE IF RETURN CODE = 20           80000000
         L     R8,WORKAREA    ACCESS PTR TO WORKAREA                    80080000
         ST    R15,CODESAVE-TSTCWORK(R8) STORE RETURN CODE              80160000
         LA    R15,@12        SET RETURN CODE TO PARSE                  80240000
         B     GOHOME         RETURN TO PARSE                           80320000
         EJECT                                                          80400000
* THE FOLLOWING ARE MESSAGE OUTPUTTING ROUTINES.                        80480000
MSG1     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   80560000
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=WHR32,                 *80640000
               MF=(E,TSTIOPRM)  CALL IO                                 80720000
         BR    R6             RETURN TO CALLER                          80800000
         SPACE                                                          80880000
MSG2     XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  80960000
         IKJEGSIO MSG,FIRST=(R2),INST11=(NUM,I0016),SECOND=(R3),       *81040000
               ID=WHR32,MF=(E,TSTIOPRM)  CALL IO                        81120000
         BR    R6             RETURN TO CALLER                          81200000
         SPACE                                                          81280000
MSG3     XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  81360000
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *81440000
               ID=WHR32,MF=(E,TSTIOPRM)  CALL IO                        81520000
         CH    R15,ATTNCODE   IS RET CODE LESS 16                       81600000
         BNL   PARS12         NO, RETURN WITH 12                        81680000
         LA    R15,@8         YES, RC=8 (RE-ENTER)                      81760000
         B     GOHOME         RETURN TO PARSE                           81840000
         SPACE                                                          81920000
LINKFL1  BAL   R5,LINKFAIL    PUT OUT ERR MSG                           82000000
         CH    R15,ATTNCODE   IS RET CODE LESS THAN 16                  82080000
         BNL   RET            NO,SEND RC BACK TO MAINLINE               82160000
         B     A0008          YES, SET RC=0, RETURN                     82240000
         SPACE                                                          82320000
LINKFL2  BAL   R5,LINKFAIL    PUT OUT ERR MSG                           82400000
         CH    R15,ATTNCODE   IS RET CODE LESS THAN 16                  82480000
         BNL   PARS12         NO, SET RC=12 FOR PARSE                   82560000
         LA    R15,@8         YES, SET RC=8                             82640000
         B     GOHOME         RETURN TO PARSE                           82720000
         SPACE                                                          82800000
LINKFAIL LR    R3,R1          ABEND CODE TO REG 3                       82880000
         LR    R2,R15         RET CODE TO REG 2                         82960000
         XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   83040000
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R3),RC=(R2),                   *83120000
               INST11=(NUM,(R4)),ID=WHR32,MF=(E,TSTIOPRM) CALL IO       83200000
         BR    R5             RETURN TO CALLER                          83280000
         SPACE                                                          83360000
LISTESTA IKJEGSPL RTRY=RETRY,ABNTB=STAETAB,MODNM=IKJEGWHR,             *83440000
               TNM=WHERE      BUILD ESTAE PARAMETER LIST                83520000
         TITLE 'IKJEGWHR, ''WHERE'' SUBCOMMAND, MACROS AND CONSTANTS'   83600000
PARSELST DC    V(IKJEGPRS)    ADDRESS OF PARAMETER PASSED TO PARSE      83680000
IKJEGPRS IKJPARM                                                        83760000
GETADDR  IKJPOSIT   ADDRESS,VALIDCK=IKJEGVLC                            83840000
*                             MACRO USED TO CHECK ADDRESS               83920000
         IKJENDP                                                        84000000
         SPACE 5                                                        84080000
LDNMVC2  MVC   @1(@1,R4),@0(R5) PUT LOADNAME IN MSG BUFFER              84160000
CTNMVC2  MVC   @10(@1,R4),@0(R5) PUT CSECT NAME IN MSG BUFFER           84240000
LDNMVC   MVC   @31(@1,R4),@0(R5) PUT LOADNAME IN MSG BUFFER             84320000
CTNMVC   MVC   @40(@1,R4),@0(R5) PUT CSECT NAME IN MSG BUFFER           84400000
MOVNAME  MVC   @0(@1,R1),@0(R3) MOVE NAME FROM PDE TO WORKAREA          84480000
MOVDISPL MVC   @30(@1,R1),@1(R10)  MOVE OFFSET TO OUTPUT                84560000
INVLD    MVC   @0(@1,R2),@0(R11) MSG DATA INTO OUTPUT BUFFER            84640000
CSECTMVC MVC   CSECTNAM-TSTCWORK(@1,R6),@0(R1) MOVE CSECT NAME          84720000
         SPACE 5                                                        84800000
TRTAB    DC    C'0123456789ABCDEF' TRANSLATE TABLE                      84880000
MDATA1   DC    C' LOCATED AT ' MSG DATA                                 84960000
MDATA2   DC    C' LOCATED IN ' MSG DATA                                 85040000
MDATA3   DC    C' UNDER TCB LOCATED AT ' MSG DATA                       85120000
MDATA4   DC    C'NOT WITHIN ANY PROGRAM EXTENT ' MSG DATA               85200000
ADDRSIZE DC    X'000B0000'    SIZE OF ADDRESS                           85280000
ATTNCODE DC    H'16'          ATTENTION RET CODE                        85360000
CONSTANT DC    50C'Z'         ZAP AREA                                  85440000
         SPACE 5                                                        85520000
************************************************************            85600000
*                                                          *            85680000
*                    EQUATES                               *            85760000
*                                                          *            85840000
************************************************************            85920000
ZERO     EQU   C'0'                                                     86000000
HEX11    EQU   X'11'                                                    86080000
HEX10    EQU   X'10'                                                    86160000
HEX04    EQU   X'04'                                                    86240000
HEX80    EQU   X'80'                                                    86320000
HEXDF    EQU   X'DF'                                                    86400000
HEXFF    EQU   X'FF'                                                    86480000
HEX4E    EQU   X'4E'                                                    86560000
HEX00    EQU   X'00'                                                    86640000
HEXC0    EQU   X'C0'                                                    86720000
BLANK    EQU   X'40'                                                    86800000
TTCBPKF  EQU   28                                                       86880000
DOT      EQU   X'4B'                                                    86960000
@0       EQU   0                                                        87040000
@1       EQU   1                                                        87120000
@2       EQU   2                                                        87200000
@3       EQU   3                                                        87280000
@4       EQU   4                                                        87360000
@5       EQU   5                                                        87440000
@6       EQU   6                                                        87520000
@7       EQU   7                                                        87600000
@8       EQU   8                                                        87680000
@9       EQU   9                                                        87760000
@10      EQU   10                                                       87840000
@12      EQU   12                                                       87920000
@13      EQU   13                                                       88000000
@14      EQU   14                                                       88080000
@16      EQU   16                                                       88160000
@18      EQU   18                                                       88240000
@20      EQU   20                                                       88320000
@21      EQU   21                                                       88400000
@22      EQU   22                                                       88480000
@24      EQU   24                                                       88560000
@25      EQU   25                                                       88640000
@27      EQU   27                                                       88720000
@28      EQU   28                                                       88800000
@30      EQU   30                                                       88880000
@31      EQU   31                                                       88960000
@32      EQU   32                                                       89040000
@36      EQU   36                                                       89120000
@38      EQU   38                                                       89200000
@39      EQU   39                                                       89280000
@40      EQU   40                                                       89360000
@41      EQU   41                                                       89440000
@44      EQU   44                                                       89520000
@48      EQU   48                                                       89600000
@49      EQU   49                                                       89680000
@50      EQU   50                                                       89760000
@51      EQU   51                                                       89840000
@52      EQU   52                                                       89920000
@53      EQU   53                                                       90000000
@56      EQU   56                                                       90080000
@57      EQU   57                                                       90160000
@58      EQU   58                                                       90240000
@60      EQU   60                                                       90320000
@64      EQU   64                                                       90400000
@67      EQU   67                                                       90480000
@68      EQU   68                                                       90560000
@70      EQU   70                                                       90640000
@71      EQU   71                                                       90720000
@76      EQU   76                                                       90800000
@77      EQU   77                                                       90880000
@81      EQU   81                                                       90960000
@92      EQU   92                                                       91040000
@96      EQU   96                                                       91120000
@240     EQU   240                                                      91200000
R0       EQU   0                                                        91280000
R1       EQU   1                                                        91360000
R2       EQU   2                                                        91440000
R3       EQU   3                                                        91520000
R4       EQU   4                                                        91600000
R5       EQU   5                                                        91680000
R6       EQU   6                                                        91760000
R7       EQU   7                                                        91840000
R8       EQU   8                                                        91920000
R9       EQU   9                                                        92000000
R10      EQU   10                                                       92080000
R11      EQU   11                                                       92160000
R12      EQU   12                                                       92240000
R13      EQU   13                                                       92320000
R14      EQU   14                                                       92400000
R15      EQU   15                                                       92480000
* THE FOLLOWING ARE 1ST LEVEL MESSAGE NO. EQUATES.                      92560000
M0101    EQU   101            INVALID ADDRESS ...                       92640000
M0103    EQU   103            NOT ENOUGH MAIN STORAGE                   92720000
M0104    EQU   104            WHERE FAILED, CMMND SYS ERR               92800000
* THE FOLLOWING ARE 2ND LEVEL MESSAGE NO. EQUATES.                      92880000
M0274    EQU   274            REG NOT. MUST BE INDRT GEN REG            92960000
M0277    EQU   277            PARSE ERROR CODE 12                       93040000
* THE FOLLOWING ARE CONSTANT MESSAGE INSERTS.                           93120000
I0016    EQU   16             WHERE                                     93200000
I0040    EQU   40             IKJPARS                                   93280000
I0085    EQU   85             IKJEGSYM                                  93360000
I0099    EQU   99             BLOW CODES FOR ABENDTABLE                 93440000
         EJECT                                                          93520000
STAETAB  DS    0F             TO ALIGN TO FULL WORD BOUNDRY             93600000
         DC    AL1(I0099)     STAE ABEND CODE FOR SYM LINK              93680000
         DC    AL3(BLOW1)     RESUME ADDR FOR STAE                      93760000
         DC    AL1(I0099)     STAE ABEND CODE FOR SYM LINK              93840000
         DC    AL3(BLOW2)     RESUME ADDR FOR STAE                      93920000
         DC    AL1(I0099)     STAE ABEND CODE FOR SYM LINK              94000000
         DC    AL3(BLOW3)     RESUME ADDR FOR STAE                      94080000
         DC    X'FF'          INDICATE END OF TABLE                     94160000
         DS    0F                                                       94240000
LISTSTAE ESTAE MF=L           LIST FORM OF ESTAE                        94320000
ENDLIST  EQU   *-LISTSTAE                                               94400000
SUBPOOL  EQU   *                                                        94480000
         DC    AL1(0)         SUBPOOL NUMBER                            94560000
         DC    AL3(104)       WORKAREA LENGTH IN BYTES                  94640000
ARETRY   DC    AL3(RETRY)     ADDR OF STAE RETRY RTN                    94720000
SYM      DC    C'SYM'         FOR BLDL ENTRY TO SYM                     94800000
SMTSYM01 DS    0C             TEST CASE TTSTC120                        94880000
LINKF    LINK  SF=L           LIST FORM FOR LINK                        94960000
LINKL    EQU   *-LINKF        LENGTH OF LIST FORM OF LINK               95040000
        EJECT                                                           95120000
*                                                          *            95200000
*         TEST COMMUNICATION TABLE DSECT                   *            95280000
*                                                          *            95360000
************************************************************            95440000
TCOMTAB TCOMTAB              MACRO THAT GENERATES TCOMTAB DSECT         95520000
        EJECT                                                           95600000
************************************************************            95680000
*                                                          *            95760000
*              EXTENT BLOCK DSECT                          *            95840000
*                                                          *            95920000
************************************************************            96000000
         IHAXTLST                                                       96080000
         EJECT                                                          96160000
         IKJPPL                                                         96240000
         EJECT                                                          96320000
TCBDSECT IKJTCB             TCB DSECT                                   96400000
         EJECT                                                          96480000
         IHACDE                                                         96560000
         EJECT                                                          96640000
         IKJRB                                                          96720000
         EJECT                                                          96800000
************************************************************            96880000
*                                                          *            96960000
*             ADDRESS PDE CREATED BY PARSE                 *            97040000
*                                                          *            97120000
************************************************************            97200000
         IKJPARMA                                                       97280000
         EJECT                                                          97360000
CVT      DSECT               CVT DSECT                                  97440000
         CVT                                                            97520000
         EJECT                                                          97600000
         IHALLE                                                         97680000
         EJECT                                                          97760000
         TSTCWORK                                                       97840000
MYWORK   ORG   CWORKCMD       ORGANIZATION OF THIS MODULE WORKAREA      97920000
MYBUFFER DS    7A             THIS MODULE WORK BUFFER                   98000000
ALIASAVE DS    2A             ALIA SAVE AREA                            98080000
CSECTNAM DS    2A             CSECTNAMES                                98160000
PPLSAVE  DS    7A             SAVE AREA                                 98240000
CODESAVE DS    1A             RETURN CODE SAVE AREA                     98320000
PDESAVE  DS    7A             SAVE AREA                                 98400000
CURLD    DS    2A             CURRENT LOAD NAME                         98480000
LOADNAME DS    2A             LOAD NAME                                 98560000
LOADSAVE DS    1A             SAVE AREA                                 98640000
USERSAVE DS    1A             USER SAVE                                 98720000
TCBCHAI  DS    1A             TCB CHAIN ADDRESS                         98800000
TCBSAVE  DS    1A             TCB SAVE AREA                             98880000
RBSAVE   DS    1A             RB SAVE AREA                              98960000
CDESAVE  DS    1A             CDESAVE AREA                              99040000
OFFSET2  DS    1A             OFFSET  VARIABLE                          99120000
OFFSET   DS    1A             OFFSET  VARIABLE                          99200000
MSGADDR  DS    1A             MSSG POINTER                              99280000
MSGHOLD  DS    1A             MSSG HOLDING AREA                         99360000
MSGHOLD2 DS    1A             MSSG HOLDING AREA                         99440000
RETURN   DS    1A             RETURN ADDRESS SAVE AREA                  99520000
          END                                                           99600000
