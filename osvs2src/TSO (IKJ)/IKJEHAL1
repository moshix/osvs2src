      TITLE 'IKJEHAL1 - IBM TIME SHARING LISTALC COMMAND'               00050003
IKJEHAL1 CSECT                                                          00100020
*A 785000                                                       SA49892 00104521
*C 800500                                                       SA49892 00109221
*D 800000                                                       SA49892 00109321
*C 391500,402000                                                 A49871 00109521
*C 638500-639500,642500,643500,688500                            A48499 00114021
*C 252500,253500,762500,765500,766200                            A42338 00118521
*A 103600,103700,252100-252499,605600,736100,736200              A42338 00123021
*D 148000-148500,247500,737500,738000,739500,741500,742000,      A42338 00127521
*D 763000                                                        A42338 00132021
*C 586600                                                         M0875 00136521
*  873104                                                         M0883 00141003
*             VS2-3.0 CHANGES                                           00141402
*A 69100,271600,271700,272100-272300,588600,944500-944700       ZA00106 00142002
*A 951500,951600                                                ZA00106 00143002
*D 711701-711845,711851-711857,712088-712172,712181             ZA02196 00145002
*A 711851                                                       ZA02196 00145402
*C 711848                                                       ZA02196 00149002
*          VS2-3.0 MAINTENCE    SU                                      00149403
*0000272340-272360,273500                                       ZM32756 00151003
*0000002000,019600-019700,058100                               @ZA01485 00151403
*           VS2-4.1 RACF CHANGES                               @Z40RSSA 00151504
*0000109300,195100                                             @ZA01485 00151803
*0000252499                                                    @ZA02544 00152303
*0000270510,270520                                             @ZA09151 00152503
         SPACE 2                                                        00152802
*********************************************************************** 00156402
*                                                                     * 00160020
* STATUS     VS2 RELEASE 3 VERSION 0 SU                        @ZA01485 00200003
*                                                                     * 00250020
* FUNCTION --                                                         * 00300020
*    THIS MODULE LISTS THE CURRENTLY ALLOCATED DATA SETS FOR A        * 00400020
*    LOGGED-ON USER OF THE SYSTEM.  DATA SET NAMES ARE EXTRACTED      * 00450020
*    FROM THE DATA SET EXTENSION (DSE) BLOCKS. ALL INFORMATION        * 00500020
*    FOR THE BASIC COMMAND AND FOR THE 'STATUS' KEYWORD IS            * 00550020
*    EXTRACTED FROM THE IN-CORE CHAIN OF DSE'S. DATA FOR THE          * 00600020
*    'HISTORY' KEYWORD IS TAKEN FROM THE DSCB WHICH IS BROUGHT        * 00650020
*    IN BY AN OBTAIN MACRO. A RDJFCB MACRO IS USED TO GET THE         * 00700020
*    VOLID NEEDED TO DO THE OBTAIN. IF THE 'MEMBERS' KEYWORD IS       * 00750020
*    SPECIFIED IN THE COMMAND AND A DATASET WITH PARTITIONED          * 00800020
*    ORGANIZATION IS FOUND TO HAVE THE USER'S USERID AS HIGHEST       * 00850020
*    LEVEL QUALIFIER, THEN IKJEHMEM IS LOADED AND CALLED AND          * 00900020
*    WILL LIST THE DIRECTORY OF THE PDS. IF THE 'SYSNAMES'            * 00950020
*    KEYWORD IS SPECIFIED, ALL SYSTEM GENERATED DSNAMES FOUND         * 01000020
*    ALLOCATED TO THIS SESSION ARE INCLUDED IN THE LISTING.           * 01050020
*    OTHERWISE SYSTEM NAMES ARE IGNORED.                              * 01100020
*                                                                     * 01150020
* ENTRY POINTS --                                                     * 01200020
*         IKJEHAL1 - MAIN ENTRY POINT OF THE PROGRAM                  * 01250020
*         IKJEHWRT - WRITE ROUTINE                                    * 01260020
*         IKJEHERR - ERROR ROUTINE                                    * 01300020
*                                                                     * 01350020
* INPUT -- REGISTER 1 POINTS TO THE COMMAND PROCESSOR PARAMETER LIST  * 01400020
*                                                                     * 01600020
* OUTPUT --                                                           * 01650020
*    DSNAME FOR EACH DSE BLOCK FOUND IN THE CHAIN, WITH THE           * 01700020
*    EXCEPTION OF ANY SYSTEM GENERATED DSNAMES FOUND. ADDITIONAL      * 01750020
*    OUTPUT OF CREATION AND EXPIRATION DATES, PASSWORD PROTECTION     * 01800020
*    STATUS, DATASET ORGANIZATION, DDNAME AND DATASET                 * 01850020
*    DISPOSITIONS, AND MEMBER NAMES IS AVAILABLE IF THE PROPER        * 01900020
*    KEYWORDS ARE SPECIFIED WITH THE COMMAND.                         * 01950020
*        R15 = X'00'  NORMAL RETURN                            @ZA01485 01960003
*        R15 = X'0C'  ERROR RETURN                             @ZA01485 01970003
*                                                                     * 02000020
* EXTERNAL REFERENCES --                                              * 02050020
*         IKJEHMEM - TO LIST PDS DIRECTORY                            * 02100020
*         IKJPARS - TO PARSE COMMAND STRING                           * 02150020
*         IKJPUTL - TO OUTPUT DATA TO TERMINAL                        * 02300020
*                                                                     * 02350020
* EXITS, NORMAL -- RETURN TO THE TERMINAL MONITOR PROGRAM             * 02400020
*                                                                     * 02550020
* EXITS, ERROR -- RETURN TO THE TERMINAL MONITOR PROGRAM              * 02600020
*                                                                     * 02750020
* TABLES/WORK AREAS --                                                * 02800020
*    HDTNY -THE TABLE WHICH CONTAINS THE ACCUMULATED DAYS IN THE      * 02850020
*    YEAR FOR EACH MONTH.  THIS TABLE IS USED TO FIND THE             * 02900020
*    CORRECT MONTH THAT A DAY FALLS IN.  THE NY INDICATES             * 02950020
*    THAT THIS IS FOR A NORMAL YEAR.                                  * 03000020
*    HDTLY SAME AS HDTNY BUT FOR LEAP YEAR.                           * 03050020
*    INITCORE -A WORK AREA HOLDING THE INTERNAL SWITCHES FOR THE      * 03100020
*    PROGRAM, THE LIST FORMS OF THE VARIOUS MACROS, AND               * 03150020
*    THE OUTPUT BUFFER. THIS DSECT ALSO CONTAINS THE REGISTER         * 03200020
*    SAVE AREA.  CORE IS GOTTEN BY A REGISTER GETMAIN.                * 03250020
*    OBTWAD -THE WORKING CORE GOTTEN IF THE 'HISTORY' AND/OR          * 03300020
*    'MEM' KEYWORDS WERE USED. THIS AREA PROVIDES THE WORK            * 03350020
*    AREA FOR THE RDJFCB AND OBTAIN MACROS, THE DCB NEEDED            * 03400020
*    BY RDJFCB AND BY MODULE IKJEHMEM, AND THE PARAMETER LIST         * 03450020
*    FOR THE RDJFCB AND OBTAIN MACROS.                                * 03500020
*                                                                     * 03550020
* ATTRIBUTES -- REENTRANT, READ ONLY, REFRESHABLE                     * 03700020
*                                                                     * 03800020
* CHARACTER CODE DEPENDENCY -- CHARACTER CODE INDEPENDENT             * 03810020
*                                                                     * 03820020
* NOTES -- N/A                                                        * 03850020
*                                                                     * 04300020
*********************************************************************** 04350020
         EJECT                                                          04360020
         ENTRY IKJEHWRT                                                 04400020
         ENTRY IKJEHERR                                                 04450020
         SPACE                                                          04500020
*        REGISTER EQUATES                                               04550020
R0       EQU   0                   REGISTER 0                           04650020
R1       EQU   1                   REGISTER 1                           04700020
R2       EQU   2                   REGISTER 2                           04750020
R3       EQU   3                   REGISTER 3                           04800020
R4       EQU   4                   REGISTER 4                           04850020
R5       EQU   5                   REGISTER 5                           04900020
R6       EQU   6                   REGISTER 6                           04950020
R7       EQU   7                   REGISTER 7                           05000020
R8       EQU   8                   REGISTER 8                           05050020
R9       EQU   9                   REGISTER 9                           05100020
R10      EQU   10                  REGISTER 10                          05150020
R11      EQU   11                  REGISTER 11                          05200020
R12      EQU   12                  REGISTER 12                          05250020
R13      EQU   13                  REGISTER 13                          05300020
R14      EQU   14                  REGISTER 14                          05350020
R15      EQU   15                  REGISTER 15                          05400020
*                                                                       05450020
*        CHARACTER AND VALUE EQUATES                                    05500020
*                                                                       05550020
BLANK    EQU   C' '                BLANK                                05600020
SLASH    EQU   C'/'                SLASH                                05650020
SSP      EQU   1                   SUBPOOL NUMBER                       05750020
OSP      EQU   1                   SUBPOOL NUMBER                       05800020
RT12     EQU   X'0C'               RETURN CODE = 12            @ZA01485 05810003
*        MESSAGE NUMBERS                                                05850020
MSG01    EQU   1                   MESSAGE NUMBER 1                     05950020
MSG02    EQU   2                   MESSAGE NUMBER 2                     06000020
MSG03    EQU   3                   MESSAGE NUMBER 3                     06050020
MSG04    EQU   4                   MESSAGE NUMBER 4                     06100020
MSG05    EQU   5                   MESSAGE NUMBER 5                     06150020
MSG06    EQU   6                   MESSAGE NUMBER 6                     06200020
*        SECOND LEVEL MESSAGE NUMBERS                                   06400020
SECMSG01 EQU   1                   SECOND LEVEL MESSAGE 1               06450020
SECMSG02 EQU   2                   SECOND LEVEL MESSAGE 2               06500020
SECMSG03 EQU   3                   SECOND LEVEL MESSAGE 3               06550020
SECMSG04 EQU   4                   SECOND LEVEL MESSAGE 4               06600020
SECMSG05 EQU   5                   SECOND LEVEL MESSAGE 5               06650020
SECMSG06 EQU   6                   SECOND LEVEL MESSAGE 6               06700020
SECMSG07 EQU   7                   SECOND LEVEL MESSAGE 7               06750020
SECMSG08 EQU   8                   SECOND LEVEL MESSAGE 8               06800020
SECMSG09 EQU   9                   SECOND LEVEL MESSAGE 9               06850020
SECMSG10 EQU   10                  SECOND LEVEL MESSAGE 10              06900020
SECMSG11 EQU   11                  SECOND LEVEL MESSAGE 11      ZA00106 06920002
*        EQUATES                                                        06950020
DSECCNCT EQU   X'08'               ENTRY DYNAMICALLY CONCATENATED       07100020
ONE      EQU   1                   1                                    07150020
DYNDDOFF EQU   2                   OFFSET DDNAME LIST FOR DYNAM ENTRIES 07200020
DDNAMLEN EQU   8                   LENGTH OF DDNAME                     07250020
TERMDDOF EQU   10                  OFFSET TO DDNAME                     07300020
NULLDDOF EQU   10                  OFFSET TO DDNAME                     07350020
SAVELEN  EQU   112                 SIZE OF SAVE AREA                    07400020
RETREGOF EQU   12                  OFFSET TO RETURN REGISTER            07450020
BALREGOF EQU   52                  OFFSET TO BRANCH REGISTER            07500020
*  THE BITS OF THE CONTROL BYTE HAVE THE FOLLOWING MEANING              07600020
STATMSK  EQU   X'80'               STATUS SPECIFIED                     07700020
HISTMSK  EQU   X'40'               HISTORY SPECIFIED                    07750020
MEMMSK   EQU   X'20'               MEMBERS SPECIFIED                    07800020
SYSNMSK  EQU   X'10'               SYSNAMES SPECIFIED                   07850020
HISTSTAT EQU   X'C0'               HISTORY AND STATUS SPECIFIED         07900020
OBTSW    EQU   X'08'               OBTAIN FAILED INDICATOR              07950020
CONCATSW EQU   X'02'               INDICATES DYNAMIC ALLOCATION         08050020
WRITEMSK EQU   X'01'               DATA IN THE BUFFER (TO BE WRITTEN)   08100020
NOBTSW   EQU   X'F7'               FOR TURNING OFF OBTAIN SWITCH        08150020
HISTMEM  EQU   HISTMSK+MEMMSK      HISTORY AND MEMBERS SPECIFIED        08200020
HEXFF    EQU   X'FF'               DUMMY FOR TURNING OFF SWITCHES       08250020
FIRSTKWD EQU   X'01'               TEST IF FIRST KEYWORD NAME WAS FOUND 08350020
LOCNAME  EQU   4                   OFFSET TO LOCATE NAME                08400020
LOCCVOL  EQU   8                   OFFSET TO LOCATE CVOL                08450020
LOCWA    EQU   12                  OFFSET TO LOCATE WORKAREA            08500020
D0       EQU   0                   0                                    08600020
D1       EQU   1                   1                                    08650020
D2       EQU   2                   2                                    08700020
D3       EQU   3                   3                                    08750020
D4       EQU   4                   4                                    08800020
D8       EQU   8                   8                                    08850020
L0       EQU   0                   0                                    08900020
L1       EQU   1                   1                                    08950020
L2       EQU   2                   2                                    09000020
FOUR     EQU   4                   4                                    09050020
L4       EQU   4                   4                                    09100020
L3       EQU   3                   3                                    09150020
L7       EQU   7                   7                                    09300020
L8       EQU   8                   8                                    09350020
D5       EQU   5                   5                                    09400020
D6       EQU   6                   6                                    09450020
D9       EQU   9                   9                                    09550020
D10      EQU   10                  10                                   09650020
D16      EQU   16                  16                          @YL026YB 09660000
D43      EQU   43                  43                          @YL026YB 09670000
D44      EQU   44                  44                          @YL026YB 09680000
D112     EQU   112                 112                         @YL026YB 09690000
FIRSTVOL EQU   6                   OFFSET VOLID IN LOCATE VOLUME LIST   09700020
LOCSAVOF EQU   72                  OFFSET TO LOCAL SAVEAREA             09750020
DSNAMMAX EQU   44                  MAXIMUM SIZE OF DSNAME               09800020
AMPHERND EQU   C'&&'               AMPHERSAND                           09850020
ASTERSK  EQU   C'*'                ASTERISK                             09900020
MAXBUF   EQU   72                  MAXIMUM OUTPUT LINE                  09950020
CRDTOFF  EQU   9                   OFFSET CREATION DATE FIELD IN BUFFER 10000020
STATOFF1 EQU   2                   STATUS WITHOUT HISTORY OFFSET        10050020
NXTBUF   EQU   10                  USED TO BUMP TO NEXT BUFFER SLOT     10100020
MNTHS    EQU   12                  LOOP CONTROL FOR MONTHS              10150020
STATOFF2 EQU   39                  STATUS WITH HISTORY OFFSET           10200020
RETCDOF  EQU   14                  RETURN CODE OFFSET UNPACK AREA       10250020
COMMA    EQU   C','                COMMA                                10300020
PERIOD   EQU   C'.'                PERIOD                               10350020
LPAREN   EQU   C'('                LEFT PARENTHESIS              A42338 10360021
RPAREN   EQU   C')'                RIGHT PARENTHESIS             A42338 10370021
BACKWARD EQU   4                   USED FOR BACK CHAIN DISPLACEMENT     10400020
FORWARD  EQU   8                   USED FOR FORWARD CHAIN DISPLACEMENT  10450020
RETCD12  EQU   12                  RETURN CODE OF 12                    10500020
ZONE     EQU   C'0'                USED FOR ZERO OF ZONE MASK           10550020
EXITCD   EQU   X'87'               USED FOR JFCB DCB EXIT CODE          10600020
CHARU    EQU   C'U'                CHARACTER U                          10650020
SWON     EQU   X'FF'               MASK TURN SWITCH ON                  10660020
SWOFF    EQU   X'00'               MASK TURN SWITCH OFF                 10670020
FLDNO    EQU   X'03'                                           @YL026YB 10673000
DSAPERM  EQU   X'20'          MASK FOR PERMANENT ALLOCATION    @YL026YB 10676000
DUMMY    EQU   X'80'               MASK FOR NULLFILE           @YL026YB 10679000
TERMINAL EQU   X'40'               MASK FOR TERMMINAL FILE     @YL026YB 10682000
DINUSE   EQU   X'40'               MASK FOR IN-USE             @YL026YB 10685000
DYNCON   EQU   X'C0'               MASK FOR DYNAMIC ALLOC.     @YL026YB 10688000
HEX01    EQU   X'01'               HEX VALUE FOR ONE           @YL026YB 10691000
LOCVSAM  EQU   X'21'               FLAG FOR VSAM LOCATE        @YL026YB 10694000
         EJECT                                                          10700020
         SAVE  (14,12)             SAVE REGISTERS                       10750003
         LR    R11,R15             SAVE ENTRY POINT ADDRESS             10800020
         USING OBTWAD,R12          USE R12 FOR MEMBER DSECT             10850020
         USING IKJEHAL1,R11        USE R11 FOR MAIN BASE                10900020
         B     BRID                BRANCH AROUND ID                     10910003
         DC    C'IKJEHAL1'         MODULE ID                            10920003
         DC    X'6049'             DATE  02/18/76              @ZA09151 10930003
BRID     EQU   *                                                        10940003
         LR    R2,R1               SAVE PARAMETER LIST FROM TMP         10950020
         GETMAIN R,LV=INITSIZE,SP=SSP GET CORE                          11000020
         ST    R13,BACKWARD(R1)    SET UP BACKWARD CHAIN                11050020
         ST    R1,FORWARD(R13)     SET UP FORWARD CHAIN                 11100020
         LR    R13,R1              SET UP ADDRESSABILITY FOR WORK SPACE 11150020
         USING INITCORE,R13        USE R13 FOR WORK BASE                11200020
         MVI   STACKSW,SWOFF       TURN STACK SWITCH OFF                11310020
         XC    CTLA(CTLL),CTLA     CLEAR CONTROL AREA                   11350020
         LA    R3,PUTLLIST         ADDRESS OF LIST FOR PUTLINE          11400020
         ST    R3,PUTLCON          -TO WRITE ROUTINE PARAMETER LIST     11450020
         LA    R3,DPUTLINE         ADDRESS OF PUTLINE MACRO LIST FORM   11500020
         ST    R3,DPUTLCON         -TO WRITE ROUTINE PARAMETER LIST     11550020
         LA    R3,CPECB            COMMAND PROCESSOR'S ECB              11600020
         ST    R3,ECBPTR           - TO WRITE ROUTINE PARAMETER LIST    11650020
         XC    RETCD,RETCD         CLEAR RETURN CODE SAVE AREA          11700020
         XC    CPECB,CPECB         CLEAR ECB                            11750020
*  SAVE PARMLIST FROM CPPL IN WORKAREA                                  11800020
         L     R3,CPPLUPT-CPPL(R2) UPT POINTER                          11900020
         ST    R3,UPTPTR           SAVE UPT POINTER                     11950020
         L     R3,CPPLPSCB-CPPL(R2) PSCB PTR                            12000020
         ST    R3,PSCBPTR          SAVE PSCB POINTER                    12050020
         L     R3,CPPLECT-CPPL(R2) ECT POINTER                          12100020
         ST    R3,ECTPTR           SAVE ECT POINTER                     12150020
         LOAD  EP=IKJPUTL          LOAD PUTLINE                         12200020
         ST    R0,PUTLADDR         SAVE PUTLINE ADDRESS                 12250020
         MVC   GETML(LILFS),GETMLMDL MOVE LIST FORMS OF GETMAIN ETC     12300020
         MVI   OUTBUF,BLANK        BLANK                                12350020
         MVC   OUTBUF+D1(L'OUTBUF-D1),OUTBUF -OUTPUT BUFFER             12400020
         MVC   DPUTLINE(LTPUTL),TPUTMDL INITIALIZE PUTLINE              12450020
*  SETUP PARMLIST FOR PARSE, THEN PARSE COMMAND STRING                  12550020
         LA    R3,PUTLLIST         POINT TO SPACE FOR PPL               12650020
         USING PPL,R3              ADDRESSABILITY FOR PPL               12700020
         L     R1,UPTPTR           UPT POINTER                          12850020
         ST    R1,PPLUPT           -TO LIST                             12900020
         L     R1,ECTPTR           ECT POINTER                          12950020
         ST    R1,PPLECT           -TO LIST                             13000020
         L     R1,ECBPTR           CP'S ECB POINTER                     13050020
         ST    R1,PPLECB           -TO LIST                             13100020
         L     R1,PRSEC01          POINTER TO PCL                       13150020
         ST    R1,PPLPCL           -TO LIST                             13200020
         LA    R1,PARDSECT         POINTER TO ANSWER PLACE              13250020
         ST    R1,PPLANS           -TO LIST                             13300020
         L     R1,D0(R2)           POINTER TO COMMAND BUFFER            13350020
         ST    R1,PPLCBUF          -TO LIST                             13400020
         DROP  R3                  PPL NO LONGER NEEDED                 13450020
         LA    R1,PUTLLIST         PARSE PARAMETER LIST                 13500020
         LINK  EP=IKJPARS,MF=(E,(1)) PARSE LISTALC COMMAND              13550020
*                                                                       13600020
*     TEST FOR PARSE RETURN CODES -- IF ATTENTION RETURN WITH CODE  12  13650020
*                                                                       13700020
         B     PARSCODE(R15)       ANALYZE RETURN CODE FROM PARSE       13750020
PARSCODE B     PARSCD00            RC=00 SUCCESSFUL PARSE               13850020
         B     PARSCD04            RC=04 UNABLE TO PROMPT               13900020
         B     PARSCD08            RC=08 ATTENTION - ECB POSTED         13950020
         B     PARSCD12            RC=12 INVALID PARAMETERS             14000020
         B     PARSCD16            RC=16 NO SPACE AVAILABLE             14050020
PARSCD08 LA    R1,RETCD12          RETURN CODE OF 12 FOR TMP            14200020
         ST    R1,RETCD            SAVE IT FOR THE WRAPUP ROUTINE       14250020
         B     WRAPUP00            GO TERMINATE                         14300020
PARSCD12 BAL   R8,CVDREG15         CONVERT REG15 AND SET UP INSERT      14450020
         LA    R1,SECMSG10         SECOND LEVEL MESSAGE 10              14500020
         B     PARSERR1            GO PROCESS ERROR                     14550020
PARSCD16 XC    ERRSECND,ERRSECND   CLEAR SECOND LEVEL                   14600020
         XC    ERRINST1,ERRINST1   CLEAR INSERT                         14620020
         LA    R1,MSG06            MESSAGE 6                            14650020
         B     PARSERR2            SET UP PARMLIST                      14700020
PARSERR1 STH   R1,ERRSECND         SAVE SECOND LEVEL MESSAGE NUMBER     14900020
         LA    R1,MSG05            MESSAGE 5                            14950020
PARSERR2 STH   R1,ERRFIRST         SAVE MESSAGE NUMBER                  15000020
         BAL   R8,ERROUT           GO TO ERROR ROUTINE                  15050020
PARSCD04 MVI   STACKSW,SWON        TURN STACK SWITCH ON                 15060020
         LA    R1,RETCD12          SET RETURN CODE FOR TMP              15100020
         ST    R1,RETCD            SAVE FOR WRAPUP ROUTINE              15150020
         B     WRAPUP00            GO TO TERMINATE ROUTINE              15200020
CVDREG15 CVD   R15,ERRINSRT+D8     CONVERT TO DECIMAL                   15450020
         UNPK  ERRINSRT+D1(L4),ERRINSRT+RETCDOF(D3) UNPACK              15500020
         MVI   ERRINSRT,D2         MOVE IN LENGTH                       15550020
         LA    R1,ERRINSRT         INSERT ADDRESS                       15600020
         ST    R1,ERRINST2         -TO INSERT POINTER                   15650020
         XC    ERRINST1,ERRINST1   NO INSERT FOR 1ST LEVEL MESSAGE      15700020
         BR    R8                  RETURN TO CALLER                     15750020
*     SUCCESSFUL RETURN FROM PARSE  COMES HERE                          15800020
PARSCD00 L     R9,PARDSECT         ADDRESS OF DSECT RETURNED BY PARSE   15850020
         USING IKJPARMD,R9         ADDRESSABILITY PARSE DSECT           15900020
         TM    PSTAT+D1,FIRSTKWD   WAS STATUS SPECIFIED                 15950020
         BNO   PAR04               IF NOT, BRANCH                       16000020
         OI    CNTRL,STATMSK       IF YES, SET SWITCH                   16050020
PAR04    TM    PHIST+D1,FIRSTKWD   WAS HISTORY SPECIFIED                16150020
         BNO   PAR08               IF NOT, BRANCH                       16200020
         OI    CNTRL,HISTMSK       IF YES, SET SWITCH                   16250020
PAR08    TM    PMEM+D1,FIRSTKWD    WAS MEMBERS SPECIFIED                16350020
         BNO   PAR12               IF NOT, BRANCH                       16400020
         OI    CNTRL,MEMMSK        IF YES, SET SWITCH                   16450020
PAR12    TM    PSYSN+D1,FIRSTKWD   WAS SYSNAMES SPECIFIED               16550020
         BNO   PAR16               IF NOT, BRANCH                       16600020
         OI    CNTRL,SYSNMSK       IF YES, SET SWITCH                   16650020
PAR16    LR    R1,R9               PARSE DSECT TO BE RELEASED           16750020
         IKJRLSA PARDSECT          FREE PARSE DSECT CORE                16800020
         DROP  R9                  PARSE DSECT NO LONGER NEEDED         16850020
         EJECT                                                          16900020
*********************************************************************** 16950020
*                                                                     * 17000020
*    THIS ROUTINE INITIALIZES THE PARAMETER LIST OF MAPPING MACRO     * 17050000
*    IEFZB4D0 FOR INPUT TO DYNAMIC INFORMATION RETRIEVAL(DIR). @YL026YB 17350000
*    SVC 99 IS INVOKED AND DIR DATA IS GOTTEN FRON THE DSAB.   @YL026YB 17650000
*                                                                     * 17950020
*********************************************************************** 18000020
         SPACE                                                          18010020
         SR    R2,R2               CLEAR REGISTER 2            @YL026YB 18050000
         SR    R3,R3               CLEAR REGISTER 3            @YL026YB 18060000
         MVI   DYNAMSW,SWOFF       TURN OFF DYNAM SWITCH       @YL026YB 18070000
NXTDSAB  MVI   NOTUSED,SWOFF       TURN OFF NOT-INUSE SWITCH   @YL026YB 18080000
         MVI   ASKSWTCH,SWOFF      SWITCH TO WRITE AS NOT-INUSE         18090000
         MVI   DSADSNAM,BLANK                                  @YL026YB 18100000
         MVC   DSADSNAM+D1(D43),DSADSNAM                       @YL026YB 18110000
         MVI   DSADDNAM,BLANK      BLANK                       @YL026YB 18120000
         MVC   DSADDNAM+D1(L7),DSADDNAM -CLEAR DDNAME BUFFER   @YL026YB 18130000
         XC    DARQBLK,DARQBLK                                 @YL026YB 18140000
         MVI   DABLKLN,DARLNTH     SET LNTH OF BLOCK           @YL026YB 18150000
         MVI   DAVERB,S99VRBIN     SET VERB CODE FOR D.I.R     @YL026YB 18160000
         LA    R5,DAPTR            ADDR OF TEXT POINTERS       @YL026YB 18170000
         ST    R5,DATXTPT          SET ADDR OF TEXT POINTERS   @YL026YB 18180000
         USING S99TUPL,R5                                      @YL026YB 18190000
         USING S99TUNIT,R6                                     @YL026YB 18200000
         LA    R6,DAREQ            REL REQ TEXT UNIT           @YL026YB 18210000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18220000
         MVC   S99TUNIT(L'TXTREQ),TXTREQ  INIT. TEXT UNIT      @YL026YB 18230000
         LA    R2,D1(R2)                                       @YL026YB 18240000
         STH   R2,REQNUM           STORE REL.REQ. NUMBER       @YL026YB 18250000
         STH   R2,S99TUPAR                                     @YL026YB 18260000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18270000
         LA    R6,DADSNM           POINT TO DSNAME TEXT UNIT   @YL026YB 18280000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18290000
         MVC   S99TUNIT(L'TXTDSNM),TXTDSNM  DSNAME TXT UNIT    @YL026YB 18300000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18310000
         LA    R6,DALIMIT          POINT TO LIMIT TEXT UNIT    @YL026YB 18320000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18330000
         MVC   S99TUNIT(L'TXTLIMIT),TXTLIMIT  LIMIT TXT UNIT   @YL026YB 18340000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18350000
         LA    R6,DATTR            POINT TO ATTRIBUTE TXT UNIT @YL026YB 18360000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18370000
         MVC   S99TUNIT(L'TXTATTR),TXTATTR  ATTRIBUTE TXT UNIT @YL026YB 18380000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18390000
         LA    R6,DALENTRY         POINT TO LST ENTRY TXT UNIT @YL026YB 18400000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18410000
         MVC   S99TUNIT(L'TXLENTRY),TXLENTRY  LAST ENTRY TXT UNIT       18420000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18430000
         LA    R6,DADSTYPE         POINT TO DSTYPE TXT UNIT    @YL026YB 18440000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18450000
         MVC   S99TUNIT(L'TXTYPE),TXTYPE  POINTER TO DSTYPE TXT UNIT    18460000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18470000
         LA    R6,DAMEM            POINT TO MEMBER TXT UNIT    @YL026YB 18480000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18490000
         MVC   S99TUNIT(L'TXTMEM),TXTMEM MEMBER TXT UNIT       @YL026YB 18500000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18510000
         LA    R6,DADDNM           POINT TO DDNAME TXT UNIT    @YL026YB 18520000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18530000
         MVC   S99TUNIT(L'TXTDD),TXTDD  DDNAME TEXT UNIT       @YL026YB 18540000
         TM    CNTRL,STATMSK       WAS STATUS SPECIFIED        @YL026YB 18550000
         BNO   LASTPM              NO, PROCESS DSAB            @YL026YB 18560000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18570000
         LA    R6,DASTAT           POINT TO STATUS TXT UNIT    @YL026YB 18580000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18590000
         MVC   S99TUNIT(L'TXTSTAT),TXTSTAT  STATUS TEXT UNIT   @YL026YB 18600000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18610000
         LA    R6,DANDISP          PT. TO NORMAL DISP TXT UNIT @YL026YB 18620000
         ST    R6,S99TUPTR         TEXT POINTER                @YL026YB 18630000
         MVC   S99TUNIT(L'TXNDISP),TXNDISP  NORMAL DISP. TXT UNIT       18640000
         LA    R5,D4(R5)           NEXT TEXT UNIT              @YL026YB 18650000
         LA    R6,DACDISP          PT. TO COND. TXT UNIT       @YL026YB 18660000
         ST    R6,S99TUPTR         TEXT POINTER                @VS07242 18670000
         MVC   S99TUNIT(L'TXCDISP),TXCDISP  POINTER TO COND. DISP       18680000
         OI    S99TUPTR,S99TUPLN   TURN ON BIT FOR LAST PTR    @YL026YB 18690000
         B     LASTPM1             GO PROCESS DSAB             @YL026YB 18700000
LASTPM   OI    S99TUPTR,S99TUPLN   TURN ON BIT FOR LAST PTR    @YL026YB 18710000
LASTPM1  LA    R4,DARQBLK          POINTER TO REQUEST BLK      @YL026YB 18720000
         ST    R4,DAPARM           STORE REQ. BLK PTR          @YL026YB 18730000
         OI    DAPARM,S99RBPND     TURN ON REQ. BLK BIT        @YL026YB 18740000
         LA    R1,DAPARM           POINTER TO REQ. BLK PTR     @YL026YB 18750000
         USING S99RBP,R1                                       @YL026YB 18760000
         L     R5,S99RBPTR                                     @YL026YB 18770000
         USING S99RB,R5                                        @YL026YB 18780000
         L     R5,S99TXTPP                                     @YL026YB 18790000
         USING S99TUPL,R5                                      @YL026YB 18800000
         L     R6,S99TUPTR                                     @YL026YB 18810000
         USING S99TUNIT,R6                                     @YL026YB 18820000
         DYNALLOC                  PROCESS DSAB                @YL026YB 18830000
         LTR   R15,R15             TEST RETURN CODE            @YL026YB 18840000
         BZ    NEXTSTEP            NORMAL PROCESSING           @YL026YB 18850000
         LA    R1,MSG03            MESSAGE 3                            19300020
         STH   R1,ERRFIRST         TO PARAMETER LIST FOR ERROUT         19350020
         XC    ERRSECND,ERRSECND   NO SECOND LEVEL MESSAGE              19400020
         XC    ERRINST1,ERRINST1   NO FIRST LEVEL INSERT                19450020
         BAL   R8,ERROUT           GO TO ERROR ROUTINE                  19500020
         MVI   RETCD+3,RT12        SET RC                      @ZA01485 19510003
         B     WRAPUP00            GO TO NORMAL TERMINATION             19550020
NEXTSTEP BAL   R14,DIR                                         @YL026YB 19551000
         LA    R7,DSADSNAM                                     @YL026YB 19552000
         LH    R4,S99TULNG                                     @YL026YB 19553000
         STH   R4,DSADSLNG                                     @YL026YB 19554000
         BCTR  R4,R0                                           @YL026YB 19555000
         EX    R4,MOVE22                                       @YL026YB 19556000
         BAL   R14,DIR                                         @YL026YB 19557000
         MVC   DYNAMCNT(D2),S99TUPAR                           @YL026YB 19558000
         BAL   R14,DIR                                         @YL026YB 19559000
         MVC   DSACNTRL(D1),S99TUPAR                           @YL026YB 19560000
         BAL   R14,DIR                                         @YL026YB 19561000
         MVC   LSTENTRY(D1),S99TUPAR                           @YL026YB 19562000
         BAL   R14,DIR                                         @YL026YB 19563000
         MVC   DSTYPE(D1),S99TUPAR                             @YL026YB 19564000
         BAL   R14,DIR                                         @YL026YB 19565000
         MVC   DSAMEM(D8),S99TUPAR                             @YL026YB 19566000
         MVC   DMEMLNT(D2),S99TULNG                            @YL026YB 19567000
         BAL   R14,DIR                                         @YL026YB 19568000
         LA    R7,DSADDNAM                                     @YL026YB 19569000
         LH    R4,S99TULNG                                     @YL026YB 19570000
         LTR   R4,R4                                           @YL026YB 19571000
         BZ    SKIPMVC                                         @YL026YB 19572000
         BCTR  R4,R0                                           @YL026YB 19573000
         EX    R4,MOVE22                                       @YL026YB 19574000
SKIPMVC  LA    R3,D1                                           @YL026YB 19575000
         TM    CNTRL,STATMSK                                   @YL026YB 19576000
         BNO   START01                                         @YL026YB 19577000
         BAL   R14,DIR                                         @YL026YB 19578000
         MVC   DSASTAT(D1),S99TUPAR                            @YL026YB 19579000
         BAL   R14,DIR                                         @YL026YB 19580000
         MVC   DSANDISP(D1),S99TUPAR                           @YL026YB 19581000
         BAL   R14,DIR                                         @YL026YB 19582000
         MVC   DSACDISP(D1),S99TUPAR                           @YL026YB 19583000
START01  CR    R2,R3               IS REG2 GREATER THAN ONE    @YL026YB 19584000
         BH    BSCROUT             YES,PROCESSING NEXT ENTRY   @YL026YB 19585000
         B     DSEOK                                           @YL026YB 19586000
DIR      LA    R5,D4(R5)                                       @YL026YB 19587000
         L     R6,S99TUPTR                                     @YL026YB 19588000
         BR    14                                              @YL026YB 19589000
MOVE22   MVC   D0(D0,R7),S99TUPAR                              @YL026YB 19590000
*                                                                       19600020
*     NORMAL PROCESSING BEGINS HERE                                     19650020
*                                                                       19700020
DSEOK    TM    CNTRL,HISTMEM+SYSNMSK IS CORE NEEDED                     19850020
         BZ    NOMEMREQ            NO PROCESS NORMAL                    19900020
         BAL   R8,LGM02            GO ISSUE GETMAIN                     19950020
         TM    CNTRL,MEMMSK        ARE MEMBER NAMES TO BE LISTED        20050020
         BNO   NOMEMREQ            BRANCH AROUND SET UP IF NOT          20100020
         LOAD  EP=IKJEHMEM         LOAD MEMBERS ROUTINE                 20250020
         ST    R0,MEMMOD           SAVE ADDRESS OF MEMBERS ROUTINE      20350020
*********************************************************************** 20450020
*                                                                     * 20500020
*        MAIN PROCESSING ROUTINE                                      * 20550000
*                                                                     * 20600020
*********************************************************************** 20650020
NOMEMREQ LA    R7,OUTBUF           BUFFER ADDRESS                       20750020
         LR    R14,R7              INDICATE A SKIP                      20800020
         BAL   R8,WRITE            GO TO WRITE ROUTINE                  20850020
         TM    CNTRL,HISTSTAT      CHECK FOR HISTORY OR STATUS          20900020
         BZ    SKIPHDNG            NEITHER, SKIP HEADING                20950020
         TM    CNTRL,HISTMSK       WAS HISTORY SPECIFIED                21000020
         BNO   NXCHECK             NO, CHECK STATUS                     21050020
         MVC   OUTBUF(L'TITLE1),TITLE1 MOVE HEADING TO BUFFER           21100020
         LA    R7,L'TITLE1(R7)     POINT BEYOND HISTORY HEADING         21150020
NXCHECK  TM    CNTRL,STATMSK       WAS STATUS SPECIFIED                 21200020
         BZ    WRITHDNG            NO, GO WRITE HEADING                 21250020
         MVC   D0(L'TITLE2,R7),TITLE2 MOVE HEADING TO BUFFER            21300020
         LA    R7,L'TITLE2(R7)     POINT AT END OF DATA                 21350020
WRITHDNG LR    R14,R7              SETUP FOR WRITING HEADING            21450020
         LA    R7,OUTBUF           POINT AT BUFFER                      21500020
         BAL   R8,WRITE            GO WRITE BUFFER                      21550020
         LR    R14,R7              SETUP FOR LINESKIP                   21600020
         BAL   R8,WRITE            GO SKIP A LINE                       21650020
*********************************************************************** 21750020
*                                                                     * 21800020
*        THIS ROUTINE IS THE BASIC LISTALC FUNCTION. THE ROUTINE      * 21850020
*        CHECKS THE DSAB TO SEE IF DATA SET IS IN-USE. IF NOT         * 21900000
*        IT CHECKS TO SEE IF IT IS PERMANENTLY ALLOCATED.             * 21980000
*        IF NOT PERMANENTLY ALLOCATED THE DDNAME IS SAVED.            * 22060000
*        THE DSNAME IS THEN  CHECKED TO SEE IF IT IS A SYSTEM         * 22140000
*        GENERATED NAME AND IF SO IS PROCESSED ONLY IF 'SYSNAMES' IS  * 22220000
*        SPECIFIED.                                                   * 22300000
*                                                                     * 22410020
*********************************************************************** 22450020
SKIPHDNG EQU   *                   ALIAS FOR BSCROUT                    22460020
BSCROUT  TM    DSACNTRL,DINUSE     IS DATA SET IN USE          @YL026YB 22500000
         BO    BNORM               YES GO TO NORMAL PROCESSING          22550000
         TM    DSACNTRL,DSAPERM    IS ENTRY PERMANENTLY ALLOCATED       22600000
         BO    DYNAMRT             YES GO SAVEY DDNAME         @YL026YB 22650000
         MVI   NOTUSED,SWON        TURN ON NOT IN-USE SWITCH   @YL026YB 22700000
BNORM    CLI   DSTYPE,DUMMY        SEE IF DSNAME IS NULLFILE   @YL026YB 22750000
         BE    NULLFRT             YES, GO TO NULLFILE HANDLING ROUTINE 22800000
         CLI   DSTYPE,TERMINAL     SEE IF DSNAME IS ASTERISK   @YL026YB 22850000
         BE    TERMFRT             YES, PROCESS AS A TERMINAL FILE      22900000
         TM    CNTRL,SYSNMSK       WAS SYSNAMES SPECIFIED               23000020
         BO    BSCRT00A            YES, SKIP TEST FOR SYSTEM NAME       23050020
*********************************************************************** 23150020
*                                                                     * 23200020
*   THE FOLLOWING CODE WILL TEST FOR SYSTEM GENERATED NAMES.          * 23250020
*   THE TEST MAKES USE OF (AND IS DEPENDENT ON) THE FACT THAT         * 23300020
*        1.    THE ZONE FIELD OF ALL NUMERICS IS THE SAME             * 23350020
*        2.    THE NUMERIC PORTION OF A BYTE IS BINARY ZERO FOR THE   * 23400020
*              CHARACTER ZERO (0).                                    * 23450020
*   THE TEST IS PREFORMED BY ANDING A MASK OF THE CONSTANT CHARACTERS * 23500020
*   AND CHARACTER ZEROS FOR THE NUMERIC FIELDS OF DATE AND TIME,      * 23550020
*   AGAINST THE DSNAME BEING TESTED.  THE RESULT IS THEN EXCLUSIVE    * 23600020
*   OR'ED AGAINST THE ORIGINAL MASK.  RESULT SHOULD BE ZERO.          * 23650020
*                                                                     * 23700020
*********************************************************************** 23750020
         MVC   SYSNM(L'SYSNMMDL),SYSNMMDL MOVE MASK TO WORK AREA        23800020
         NC    SYSNM(L'SYSNMMDL),DSADSNAM AND MASK AGAINST DSNAME       23850000
         XC    SYSNM(L'SYSNMMDL),SYSNMMDL EX-OR PRODUCT AGAINST MASK    23900000
         BZ    NXDSEBLK            IF SYSNAME, PROCESS NEXT BLOCK       23950000
         CLI   DSADSNAM,AMPHERND   IS NAME SYSTEM ASSIGNED     @YL026YB 24000000
         BE    NXDSEBLK            YES, PROCESS NEXT DSAB BLK  @YL026YB 24050000
         B     BSCRT00             NO, PROCESS NORMALLY                 24100000
BSCRT00A CLI   DSADSNAM,AMPHERND   DOES DSNAME BEGINS WITH AMPHERSAND   24150000
         BNE   BSCRT00             NO, GO PROCESS NORMALLY              24250020
         LA    R2,OBTDCB           DCB ADDRESS                          24300020
         USING IHADCB,R2           ADDRESSABILITY DCB                   24350020
         MVC   DCBDDNAM(DDNAMLEN),DSADDNAM MOVE DDNAME FROM DSE TO DCB  24400000
         LA    R1,RDJL             LIST FORM RDJFCB                     24450020
         RDJFCB ((R2)),MF=(E,(R1)) ISSUE READ JFCB                      24500020
         DROP  R2                  DCB NO LONGER NEEDED                 24550020
         MVC   OUTBUF(DSNAMMAX),OBTDSNAM MOVE DSNAME FROM JFCB          24600020
         LA    R7,OUTBUF           BUFFER ADDRESS                       24650020
         LA    R14,DSNAMMAX(R7)    END OF BUFFER ADDRESS                24700020
         B     BSCRT00B            GO CHECK FOR KEYWORDS                24800020
BSCRT00  LA    R7,OUTBUF           POINTER TO BUFFER                    24900020
         CLI   NOTUSED,SWON        CHECK FOR NOT IN-USE        @YL026YB 24950000
         BE    DYNAMRY             YES,PROCESS '*' INDICATOR   @YL026YB 24980000
BSCRT11  XR    R1,R1               CLEAR FOR INSERT            @YL026YB 25010000
         LH    R1,DSADSLNG         GET LENGTH OF DSNAME        @YL026YB 25040000
         LA    R3,DSADSNAM         POINTER TO DSNAME           @YL026YB 25070000
         BCTR  R1,R0               DECREMENT LENGTH FOR MOVE            25100020
         EX    R1,MOVE             MOVE DSNAME TO BUFFER                25150020
         LA    R14,D1(R7,R1)       POINT AT END OF DATA                 25200020
         CLI   NOTUSED,SWON        CHECK FOR NOT IN-USE        @YL026YB 25210000
         BNE   CONT9               CONTINUE NORMALLY           @YL026YB 25212000
         LR    R7,R6               STARTING ADDRESS OF BUF     @YL026YB 25214000
CONT9    CLC   DMEMLNT(D2),ZERO1   IS MEMBER ALLOCATED         @YL026YB 25216000
         BE    BSCRT00B            NO, SKIP MEMBER PROCESSING    A42338 25218000
*        PROCESS MEMBER NAMES                                         * 25220000
         LA    R3,DSAMEM           POINT TO MEMBER NAME          A42338 25222000
         MVI   D0(R14),LPAREN      MOVE IN LEFT PARENTHESIS      A42338 25224000
         LA    R14,D1(R14)         POINT PAST PARENTHESIS        A42338 25226000
         LH    R4,DMEMLNT          LENGTH OF MEMBER NAME       @YL026YB 25228000
         BCTR  R4,R0               DECREMENT FOR EXECUTE       @YL026YB 25230000
         EX    R4,MOVE1            PUT MEMBER NAME IN BUFFER   @YL026YB 25232000
         AR    R14,R4              POINT PAST MEMBER NAME      @YL026YB 25234000
         MVI   D2(R14),RPAREN      MOVE IN CLOSING PARENTHESIS   A42338 25236000
         LA    R14,D3(R14)         POINT PAST DATA             @ZA02544 25249903
BSCRT00B BAL   R8,WRITE            GO WRITE THE NAME             A42338 25250021
         TM    CNTRL,HISTMEM       CHECK FOR HISTORY OR MEMBERS  A42338 25350021
         BZ    BSCRT01             NEITHER, CHECK STATUS                25400020
         BAL   R8,OBTRT            OBTAIN DSCB                          25450020
         TM    CNTRL,HISTMSK       WAS HISTORY REQUESTED                25550020
         BNO   BSCRT01             NO, CHECK STATUS                     25600020
         L     R15,VCONHIST        ADDRESS OF HISTORY ROUTINE           25650020
         BALR  R14,R15             GO TO HISTORY ROUTINE                25700020
BSCRT01  TM    CNTRL,STATMSK       WAS STATUS REQUESTED                 25800020
         BNO   BSCRT02             NO, CHECK WRITE SWITCH               25850020
         L     R15,VCONSTAT        ADDRESS OF STATUS ROUTINE            25900020
         BALR  R14,R15             GO TO STATUS ROUTINE                 25950020
BSCRT02  TM    CNTRL,WRITEMSK      IS WRITE SWITCH ON                   26050020
         BNO   BSCRT02A            NO, GO CHECK NEXT OPTION             26100020
         LA    R7,OUTBUF           POINT AT BUFFER                      26150020
         LA    R14,MAXBUF(R7)      POINT AT END OF BUFFER               26200020
         BAL   R8,WRITE            GO WRITE BUFFER TO TERMINAL          26250020
         NI    CNTRL,HEXFF-WRITEMSK TURN OFF WRITE SWITCH               26300020
BSCRT02A TM    CNTRL,OBTSW         CHECK FOR OBTAIN SWITCH              26400020
*                                                                     * 26450020
*  IF THE OBTAIN SWITCH IS TURNED ON, IT MEANS THAT THE OBTAIN ISSUED * 26500020
*  FOR HISTORY INFORMATION FAILED AND NO DATA WAS SUPPLIED FOR THE    * 26550020
*  HISTORY OPTION. THE ERROR WAS NOT PROCESSED UNTIL NOW IN           * 26600020
*  ORDER TO ALLOW STATUS INFORMATION TO BE PROCESSED IF REQUESTED.    * 26650020
*                                                                     * 26750020
         BNO   BSCRT03             NO, GO CHECK FOR MEMBERS             26800020
         NI    CNTRL,NOBTSW        TURN OFF OBTAIN SWITCH               26850020
         L     R15,OBTAINRC        GET OBTAIN RETURN CODE               26900020
         LA    R15,D0(R15)         CLEAR HIGH ORDER BYTE                26950020
         TM    OBTAINRC,HEXFF      TEST FOR LOCATE FAILURE              27000020
         BNO   OBTCODE(R15)        NO, ANALYZE OBTAIN RETURN CODE       27050020
         TM    CNTRL,HISTMSK       WAS HISTORY REQUESTED       @ZA09151 27060003
         BNO   TESTMEM             NO, GO CHECK FOR MEMBERS    @ZA09151 27070003
         LA    R1,MSG01            MESSAGE 1                            27100020
         STH   R1,ERRFIRST         INTO LIST FOR ERROR HANDLER          27150020
         CLC   JESNAME,OBTDSNAM    TEST FOR SPOOL DS            ZA00106 27200002
         BE    SPOOLNM             YES, SEND SPOOL MSG          ZA00106 27208002
         LA    R1,SECMSG05         SECOND LEVEL MESSAGE 5               27216002
         B     GOON                BRANCH AROUND SPL MSG        ZA00106 27224002
SPOOLNM  LA    R1,SECMSG11         SECOND LEVEL MESSAGE 11      ZA00106 27232002
         STH  R1,ERRSECND          INTO LIST FOR ERROR HANDLER  ZM32756 27234003
         B    MSGOUT      BRANCH AROUND CONVERT OF RETURN CODE  ZM32756 27236003
GOON     EQU   *                                                ZA00106 27240002
         STH   R1,ERRSECND         INTO LIST FOR ERROR HANDLER          27250020
         BAL   R8,CVDREG15         CONVERT RETURN CODE                  27300020
MSGOUT   EQU   *                                                ZM32756 27310003
         BAL   R8,ERROUT           GO WRITE ERROR MESSAGE       ZM32756 27350003
         B     BSCRT04             CHECK FOR MORE DSE BLOCKS            27400020
OBTCODE  DS    F                   RC=00 HANDLED ELSEWHERE              27500020
         B     NOTDA               RC=04 VOLUME NOT MOUNTED OR NOT DA   27550020
         B     NODSCB              RC=08 DSCB NOT ON THIS VOLUME        27600020
         B     OBTIOERR            RC=12 I/O ERROR DURING OBTAIN        27650020
         B     OBTIOERR            RC=16 ERROR IN OBTAIN WORK AREA      27700020
         B     OBTIOERR            RC=20 DSCB OUT OF VTOC EXTENT        27750020
NOTDA    LA    R1,SECMSG01         SECOND LEVEL MESSAGE 1               27950020
         B     OBTERRRT            GO PROCESS ERROR                     28000020
NODSCB   LA    R1,SECMSG02         SECOND LEVEL MESSAGE 2               28100020
         B     OBTERRRT            GO PROCESS ERROR                     28150020
OBTIOERR BAL   R8,CVDREG15         CONVERT RETURN CODE                  28300020
         LA    R1,SECMSG04         SECOND LEVEL MESSAGE 4               28350020
         B     OBINSERT            SET UP REST OF MESSAGE               28400020
OBTERRRT XC    ERRINST1(L'ERRINST1+L'ERRINST2),ERRINST1 CLEAR BYTES     28450020
OBINSERT STH   R1,ERRSECND         INTO LIST FOR ERROR ROUTINE          28500020
*  EITHER MEMBERS OR HISTORY OR BOTH FAILED                             28510020
         TM    CNTRL,HISTMSK       HISTORY OPTION ON                    28700020
         BO    HISTFAIL            IF ONES HISTORY FAILED               28750020
         B     TESTMEM             WAS MEMBERS ON                       28800020
HISTFAIL LA    R1,MSG01            MESSAGE 1                            28850020
         STH   R1,ERRFIRST         INTO LIST FOR ERROR ROUTINE          28900020
         BAL   R8,ERROUT           WRITE MESSAGE                        28950020
         TM    LOCSW,HEXFF         WAS LOCATE ISSUED                    29000020
         BNO   TESTMEM             NO, TEST MEMBERS OPTION              29050020
         MVI   LOCSW,D0            YES, TURN OFF SWITCH                 29100020
         B     MSGDONE             CHECK FOR MORE DSE ENTRIES           29150020
TESTMEM  TM    CNTRL,MEMMSK        IS MEMBERS OPTION ON                 29200020
         BNO   MSGDONE             CHECK FOR MORE DSE ENTRIES           29250020
         LA    R1,MSG04            MESSAGE 4                            29300020
         STH   R1,ERRFIRST         INTO LIST FOR ERROR ROUTINE          29350020
         BAL   R8,ERROUT           WRITE MESSAGE                        29400020
MSGDONE  B     BSCRT04             CHECK FOR MORE DSE ENTRIES           29450020
BSCRT03  TM    CNTRL,MEMMSK        WAS MEMBERS REQUESTED                29800020
         BNO   BSCRT04             NO, PROCESS NEXT ENTRY               29850020
         L     R15,VCONMEM         ADDRESS OF MEMBERS ROUTINE           29900020
         BALR  R14,R15             GO TO MEMBERS ROUTINE                29950020
BSCRT04  CLI   LSTENTRY,SWOFF      ARE THERE MORE DSABS        @YL026YB 30050000
         BNE   WRAPUP              NO, GO FINISH               @YL026YB 30100000
         LA    R7,OUTBUF           SETUP TO SKIP A LINE                 30150020
         LR    R14,R7              NULL LINE                            30200020
         BAL   R8,WRITE            GO TO WRITE ROUTINE                  30250020
         LH    R2,REQNUM           RELATIVE REQUEST NUMBER     @YL026YB 30300000
         B     NXTDSAB             GO PROCESS NEXT DSAB        @YL026YB 30380000
NXDSEBLK CLI   LSTENTRY,SWOFF      ARE THERE MORE DSABS        @YL026YB 30460000
         BNE   WRAPUP              YES, GO TO NORMAL TERMINATION        30540000
         LH    R2,REQNUM           RELATIVE REQUEST NUMBER     @YL026YB 30620000
         B     NXTDSAB             GO PROCESS NEXT DSAB        @YL026YB 30700000
         EJECT                                                          30800020
*********************************************************************** 30900020
*                                                                     * 30950020
*     THE NORMAL TERMINATION ROUTINE FIRST CHECKS TO SEE IF ANY DATA- * 31000000
*     NEED TO BE UNALLOCATED IF SO, A MESSAGE IS PUT TO THE TERMINAL  * 31050000
*     WITH THE COUNT, FOLLOWED BY THE DDNAMES IF STATUS WAS REQUESTED.* 31100020
*                                                                     * 31150020
*********************************************************************** 31200020
WRAPUP   CLC   DYNAMCNT(D2),ZERO1  WERE ANY DSETS TO  BE FREED @YL026YB 31250000
         BE    WRAPUP00            NO, GO TERMINATE            @YL026YB 31300000
         LH    R2,DYNAMCNT         PICK UP COUNT                        31350020
         CVD   R2,NULLCNT          CONVERT COUNT TO DECIMAL             31400020
         LA    R7,OUTBUF           POINT AT BUFFER                      31450020
         UNPK  D0(L3,R7),NULLCNT+D6(D2) UNPACK COUNT INTO BUFFER        31500020
         OI    D2(R7),ZONE         SET CORRECT ZONE                     31550020
         CLI   D0(R7),ZONE         ELIMINATE LEADING ZEROES             31600020
         BNE   DYNAMRT4            NONE, GO GET MESSAGE                 31650020
         MVC   D0(D3,R7),D1(R7)    SHIFT ZERO AWAY                      31700020
         CLI   D0(R7),ZONE         CHECK NEXT PLACE FOR ZERO            31750020
         BE    DYNAMRT5            YES, GO GET RID OF IT                31800020
         LA    R7,D3(R7)           NO, INDICATE PROPER DISPLACEMENT     31850020
DYNAMRT3 MVC   D0(L'DYNAMMSG,R7),DYNAMMSG PUT TEXT IN BUFFER            31900020
         LA    R14,L'DYNAMMSG(R7)  BUMP POINTER TO END OF DATA          31950020
         LA    R7,OUTBUF           START OF BUFFER                      32000020
         BAL   R8,WRITE            WRITE BUFFER                         32050020
         B     DYNAMRT6            GO CHECK STATUS                      32100020
DYNAMRT4 LA    R7,D4(R7)           PROPER DISPLACEMENT                  32200020
         B     DYNAMRT3            GO PUT OUT MESSAGE                   32250020
DYNAMRT5 MVC   D0(L2,R7),D1(R7)    SHIFT EXTRA ZERO OFF                 32350020
         LA    R7,D2(R7)           PROPER DISPLACEMENT                  32400020
         B     DYNAMRT3            GO COMPLETE MESSAGE                  32450020
DYNAMRT6 TM    CNTRL,STATMSK       WAS STATUS REQUESTED                 32550020
         BNO   WRAPUP00            NO, GO TERMINATE                     32600020
         LA    R9,DYNAMSAV         ADDRESS OF FIRST DYNAM ENTRY         32650000
         LH    R5,DDCNT            COUNT OF RE-USE DDNAME      @YL026YB 32670000
DYNAMRT7 MVC   OUTBUF+DYNDDOFF(DDNAMLEN),D0(R9) MOVE DDNAME TO @YL026YB 32690000
*                                               BUFFER         @YL026YB 32710000
         LA    R7,OUTBUF           POINT AT BUFFER                      32750020
         LA    R14,DDNAMLEN+DYNDDOFF(R7) END OF DATA POINTER            32800020
         BAL   R8,WRITE            GO WRITE BUFFER                      32850020
         LA    R9,D8(R9)           POINT TO NEXT DDNAME        @YL026YB 32900000
         BCT   R5,DYNAMRT7         CHECK FOR MORE ENTRIES      @YL026YB 32950000
WRAPUP00 CLI   ASKSWTCH,SWON        CHECK FOR NOT IN-USE       @YL026YB 33000000
         BNE   WRAPUP99            GO TERMINATE                @YL026YB 33050000
         LA    R7,OUTBUF           POINT AT BUFFER             @YL026YB 33100000
         MVC   D0(L'ASKMSG,R7),ASKMSG PUT TEXT IN BUFFER       @YL026YB 33150000
         LA    R14,L'ASKMSG(R7) BUMP POINTER TO IN OF DATA     @YL026YB 33200000
         BAL   R8,WRITE            GO TO WRITE ROUTINE         @YL026YB 33250000
WRAPUP99 LA    R7,OUTBUF           SETUP TO SKIP A LINE        @YL026YB 33300000
         LR    R14,R7              NULL LINE                            33400020
         BAL   R8,WRITE            GO TO WRITE ROUTINE                  33450020
WRAPUPT  NC    OBTWA,OBTWA         TEST FOR OBTAIN WORK AREA            33500020
         BZ    WRAPUP01            NO, SKIP FREEMAIN                    33550020
*  FREE WORK CORE GOTTEN FOR OBTAIN AND JFCB WORKAREAS                  33650020
         LA    R2,OBTWA            POINTER TO CORE TO BE FREE           33750020
         LA    R1,FREEML           FREEMAIN PARAMETER LIST              33800020
         FREEMAIN E,A=(R2),LV=OBTWAL,SP=OSP,MF=(E,(1)) FREE CORE        33850020
WRAPUP01 NC    MEMMOD,MEMMOD       WAS MEMBER MODULE LOADED             34000020
         BZ    WRAPUP02            NO, SKIP DELETE                      34050020
         DELETE EP=IKJEHMEM        DELETE MEMBERS MODULE                34100020
WRAPUP02 DELETE EP=IKJPUTL         DELETE PUTLINE                       34200020
*  NOW CHECK IF AN ERROR HAS OCCURRED.  IF SO, THE STACK MUST BE        34210020
*  FLUSHED AND THE INPUT QUEUE CLEARED.                                 34220020
         CLI   STACKSW,SWON        IS STACK SWITCH ON                   34230020
         BNE   STACKOK             NO ERROR, END NORMALLY               34240020
         LA    R1,UPTPTR           POINT TO I/O PARAMETER LIST          34242020
         LA    R2,STACKPRM         POINT TO STACK PARM BLOCK            34244020
         ST    R2,PUTLADDR         POINT TO STACK PARM BLOCK            34246020
         STACK DELETE=ALL,MF=(E,(1)) FLUSH STACK                        34248020
         TCLEARQ INPUT             CLEAR ANYTHING TYPED AHEAD           34248420
STACKOK  EQU   *                   NORMAL RETURN FROM HERE              34248820
         L     R8,RETCD            GET RETURN CODE                      34250020
         LR    R1,R13              ADDRESS OF CORE TO BE FREED          34300020
         L     R13,D4(R13)         RESTORE ADDRESS OF CALLERS SAVEAREA  34350020
         FREEMAIN R,LV=INITSIZE,A=(1),SP=SSP FREE CORE                  34400020
         LR    R15,R8              PUT RETURN CODE IN REGISTER 15       34450020
         RETURN (14,12),T,RC=(15)  RETURN                               34500020
*                                                                       34550020
*********************************************************************** 35300020
*                                                                     * 35350020
*  GETMAIN ROUTINE FOR MEMBERS, SYSNAMES AND HISTORY WORK AREA        * 35400020
*                                                                     * 35450020
*********************************************************************** 35500020
LGM02    LA    R1,GETML            GETMAIN PARAMETER LIST               35600020
         LA    R2,OBTWA            ADDRESS OF CORE GOES TO OBTWA        35650020
         GETMAIN A=(R2),SP=OSP,LV=OBTWAL,MF=(E,(1)) GET CORE            35700020
         B     GMRC(R15)           ANALYZE GETMAIN RETURN CODE          35750020
GMRC     B     GMOK                RC = 0, GETMAIN OK                   35800020
         B     GMNOTOK             RETURN CODE=4, NO CORE AVAILABLE     35850020
GMOK     L     R12,OBTWA           ADDRESS OF CORE JUST GOTTEN          36000020
         ST    R12,OBTJFCBX        ADDRESS OF JFCB WORK AREA            36050020
         LA    R2,OBTDCB           ADDRESS OF DCB IN DSECT              36100020
         USING IHADCB,R2           ADDRESSABILITY DCB                   36150020
         MVC   OBTMACS(LOLFS),OLFS MOVE MACRO LIST FORMS TO DSECT       36200020
         LA    R15,OBTDCBXL        ADDRESS OF DCB EXIT LIST             36250020
         ST    R15,DCBEXLST        SET UP EXIT LIST ADDRESS             36300020
         MVI   OBTJFCBX,EXITCD     SET JFCB DCB EXIT CODE               36350020
         DROP  R2                  DCB NO LONGER NEEDED                 36400020
         BR    R8                  RETURN TO CALLER                     36450020
GMNOTOK  LA    R1,MSG02            MESSAGE 2                            36850020
         STH   R1,ERRFIRST         INTO LIST FOR ERROR HANDLER          36900020
         XC    ERRSECND,ERRSECND   CLEAR SECOND LEVEL MESSAGE           36950020
         LA    R1,ERRINSRT         PICK UP ADDRESS OF FIRST INSERT      37000020
         ST    R1,ERRINST1         PUT IN ERROR LIST                    37050020
         MVI   ERRINSRT,L'NHISTORY LENGTH OF INSERT                     37100020
         TM    CNTRL,HISTMSK       WAS HISTORY OPTION ON                37150020
         BNO   CKMEM               NO, CHECK MEMBERS OPTION             37200020
         NI    CNTRL,HEXFF-HISTMSK YES, TURN OFF SWITCH                 37250020
         MVC   ERRINSRT+D1(L'NHISTORY),NHISTORY HISTORY INSERT          37300020
         BAL   R8,ERROUT           GO WRITE MESSAGE                     37350020
CKMEM    TM    CNTRL,MEMMSK        IS MEMBERS OPTION ON                 37400020
         BNO   CKSYSNM             NO, CHECK SYSNAMES                   37450020
         NI    CNTRL,HEXFF-MEMMSK  TURN OFF MEMBERS OPTION              37500020
         MVC   ERRINSRT+D1(L'NMEMBERS),NMEMBERS MEMBERS INSERT          37550020
         BAL   R8,ERROUT           GO WRITE MESSAGE                     37600020
CKSYSNM  TM    CNTRL,SYSNMSK       IS SYSNAMES OPTION ON                37650020
         BNO   GMEND               IF NOT, EXIT                         37700020
         NI    CNTRL,HEXFF-SYSNMSK YES, TURN OFF SYSNAMES OPTION        37750020
         MVC   ERRINSRT+D1(L'NSYSNAME),NSYSNAME SYSNAMES INSERT         37800020
         MVI   ERRINSRT,L'NSYSNAME LENGTH OF INSERT                     37850020
         BAL   R8,ERROUT           GO WRITE MESSAGE                     37900020
GMEND    B     NOMEMREQ            GO PROCESS                           37950020
*********************************************************************** 38500020
*                                                                     * 38550020
*    THIS ROUTINE GETS CONTROL WHEN A NULLFILE IS FOUND. A MESSAGE IS * 38600020
*    WRITTEN OUT INDICATING THE NULLFILE IS PRESENT.  IF STATUS       * 38650020
*    WAS REQUESTED, THE DDNAME IS INCLUDED.                           * 38700020
*                                                                     * 38750020
*********************************************************************** 38800020
NULLFRT  LA    R7,OUTBUF           POINT AT BUFFER                      38850020
         MVC   D0(L'NULLFILE,R7),NULLFILE MOVE NULLFILE TO BUFFER       38900020
         LA    R14,L'NULLFILE(R7)  POINT AT END OF DATA                 38950020
         TM    CNTRL,STATMSK       WAS STATUS REQUESTED                 39000020
         BNO   NULLFRT1            NO, GO WRITE OUT BUFFER              39050020
         MVC   NULLDDOF(DDNAMLEN,R7),DSADDNAM MOVE DDNAME TO BUFFER     39100000
         LA    R14,D2+DDNAMLEN(R14) POINT PAST DDNAME            A49871 39150021
NULLFRT1 BAL   R8,WRITE            GO WRITE BUFFER                      39200020
         B     BSCRT04             GO CHECK FOR MORE BLOCKS             39250020
*********************************************************************** 39450020
*                                                                     * 39500020
*     THIS ROUTINE GETS CONTROL WHEN AN ASTERISK (*) IS FOUND FOR THE * 39550020
*     DSNAME IN THE DSE ENTRY. THIS IS AN INDICATION THAT IT IS A     * 39600020
*     TERMINAL FILE AND A MESSAGE IS WRITTEN TO INDICATE THIS. IF     * 39650020
*     STATUS INFORMATION WAS REQUESTED, THE DDNAME WILL BE INCLUDED.  * 39700020
*                                                                     * 39800020
*********************************************************************** 39850020
TERMFRT  LA    R7,OUTBUF           POINT AT BUFFER                      39900020
         MVC   D0(L'TERMFILE,R7),TERMFILE MOVE TERMFILE TO BUFFER       39950020
         LA    R14,L'TERMFILE(R7)  POINT AT END OF DATA                 40000020
         TM    CNTRL,STATMSK       WAS STATUS REQUESTED                 40050020
         BNO   TERMFRT1            NO, GO WRITE BUFFER                  40100020
         MVC   TERMDDOF(DDNAMLEN,R7),DSADDNAM MOVE DDNAME TO BUFFER     40150000
         LA    R14,D2+DDNAMLEN(R14) END OF DATA POINTER          A49871 40200021
TERMFRT1 BAL   R8,WRITE            GO WRITE BUFFER                      40300020
         B     BSCRT04             GO CHECK FOR MORE BLOCKS             40350020
*********************************************************************** 40550020
*                                                                     * 40600020
*     THIS ROUTINE GETS CONTROL IF AN AVAILABLE ENTRY IS FOUND IN     * 40650020
*     THE CHAIN OF DSE ENTRIES. IF IT IS THE FIRST TIME THE ROUTINE   * 40700020
*     HAS BEEN ENTERED, A SWITCH IS TURNED ON AND A COUNTER IS SET    * 40750020
*     TO ONE. THE ADDRESS OF THE FIRST DYNAM ENTRY IS SAVED. IF THIS  * 40800020
*     IS NOT THE FIRST TIME INTO THIS ROUTINE, THE COUNTER IS BUMPED  * 40850020
*     BY ONE AND AN EXIT IS TAKEN.                                    * 40900020
*                                                                     * 40950020
*********************************************************************** 41000020
DYNAMRT  LA    R3,DSADDNAM         ADDRESS OF DDNAME           @YL026YB 41050000
         CLI   DYNAMSW,SWON        IS THIS THE FIRST ENTRY     @YL026YB 41080000
         BE    DYNAMRT1            NO,GO TO NEXT ENTRY         @YL026YB 41110000
         SR    R5,R5               CLEAR REG 5                 @YL026YB 41140000
         LA    R4,DYNAMSAV         POINT TO DDNAMES            @YL026YB 41170000
         MVI   DYNAMSW,SWON        TURN SWITCH ON              @YL026YB 41200000
         B     DYNAMRX             GO STORE DDNAME             @YL026YB 41230000
DYNAMRT1 L     R4,DSAV             POINTER TO NEXT DDNAME ENTRY         41260000
         LH    R5,DDCNT            PUT DDNAME COUNT IN REG 5   @YL026YB 41290000
         LA    R5,D1(R5)           COUNT OF DDNAME ENTRIES     @YL026YB 41320000
DYNAMRX  MVC   D0(D8,R4),D0(R3)    STORE DDNAME                @YL026YB 41350000
         LA    R4,D8(R4)           POINT TO SPACE FOR NEXT DDNAME       41380000
         ST    R4,DSAV             STORE POINTER               @YL026YB 41410000
         STH   R5,DDCNT            STORE DDNAME COUNT          @YL026YB 41440000
         B     BNORM               RETURN TO NORMAL PROCESSING @YL026YB 41470000
DYNAMRY  MVI   D0(R7),ASTERSK      PUT '*' IN 1ST POSITION     @YL026YB 41500000
         LR    R6,R7               SAVE ADRESS IN R6           @YL026YB 41530000
         LA    R7,D1(R7)           BUMP POINTER FOR DSNAME     @YL026YB 41560000
         B     BSCRT11             GO WRITE NAME               @YL026YB 41590000
*                                  -LIST DATA SET INFORMATION           41700020
*********************************************************************** 41850020
*                                                                     * 41900020
*   THIS ROUTINE IS ENTERED IF HISTORY OR MEMBERS WAS REQUESTED       * 41950020
*   ON THE COMMAND.  IT MAKES THE NECESSARY CONCATENATION TESTS AND   * 42000020
*   ISSUES A LOCATE TO GET A VOLSER FOR THE OBTAIN IF THE             * 42050020
*   HISTORY OPTION WAS REQUESTED.  IF IT IS NOT                       * 42100020
*   CONCATENATED, A RDJFCB IS ISSUED FOR THE VOLSER.  IF THE OBTAIN   * 42150020
*   FOR THE DSCB FAILS, A SWITCH IS SET (OBTSW--ALSO SET IF LOCATE    * 42200020
*   FAILS), AND CONTROL IS RETURNED TO THE MAINLINE.  THE SWITCH IS   * 42250020
*   CHECKED IN THE MAINLINE AND A MESSAGE IS PUT OUT TO THE TERMINAL  * 42300020
*   INDICATING THE REQUESTED INFORMATION CANNOT BE SUPPLIED.          * 42350020
*                                                                     * 42400020
*********************************************************************** 42450020
OBTRT    STM   R0,R9,LOCSAVOF(R13) SAVE REGISTERS LOCALLY               42550020
         CLC   DSADDNAM(L'BLANKS),BLANKS IS DDNAME BLANKS      @YL026YB 42600000
         BE    HISTLOC             YES, MUST BE CONCATENATED            42650000
         TM    DSACNTRL,DYNCON     SEE IF DYNAMICATENATION BIT IS ON    42700000
         BO    HISTDCON            YES, CHECK FURTHUR                   42750020
         NI    CNTRL,HEXFF-CONCATSW TURN OFF CONCATENATION SWITCH       42800020
HISTGO   LA    R2,OBTDCB           ADDRESS OF THE DCB IN THE DSECT      42950020
         USING IHADCB,R2           ADDRESSABILITY DCB                   43000020
         MVC   DCBDDNAM,DSADDNAM   PUT DDNAME IN DCB           @YL026YB 43050000
         LA    R1,RDJL             RDJFCB LIST FORM IN DSECT            43100020
         RDJFCB  ((R2)),MF=(E,(R1)) ISSUE READ JFCB                     43150020
         DROP  R2                  DCB NO LONGER NEEDED                 43200020
         LA    R15,JFCBVOLS        ADDESS OF VOLID                      43450020
         CLC   JFCBVOLS(D4),ZERO   CHECK FOR ZERO VOLSER                43460000
         BE    HISTLOC             GO DO A LOCATE                       43470000
         ST    R15,OBTVOL          -TO OBTAIN LIST                      43500020
HISTOBTN LA    R15,OBTDSNAM        ADDRESS OF THE DATA SET NAME         43600020
         ST    R15,OBTDSN          -TO OBTAIN LIST                      43650020
         LA    R15,OBTWORKA        ADDRESS OF 350 BYTE WORK AREA        43700020
         ST    R15,OBTWKA          -TO OBTAIN LIST                      43750020
         OBTAIN  OBTCLST           ISSUE OBTAIN                         43850020
         LTR   R15,R15             TEST RETURN CODE                     43950020
         BZ    OBTOKGO             ZERO, GO PROCESS INFORMATION         44000020
         L     R15,VCONVHS                                     @YL026YB 44100000
         BALR  R14,R15                                         @YL026YB 44150000
         B     BSCRT01             GO CHECK NEXT ENTRY                  44200020
HISTDCON TM    CNTRL,CONCATSW      CHECK CONCATENATION SWITCH           44350020
         BO    HISTLOC             IF ON, GO ISSUE LOCATE FOR VOLUMES   44400020
         OI    CNTRL,CONCATSW      IF OFF, TURN IT ON                   44450020
         B     HISTGO              GO PROCESS THIS ENTRY NORMALLY       44500020
HISTLOC  TM    CNTRL,HISTMSK       WAS HISTORY BIT ON                   44650020
         BNO   HISTLOC1            IF NOT DO NOT DO LOCATE              44700020
         XR    R15,R15             CLEAR REGISTER FOR INSERT            44750020
         LH    R15,DSADSLNG        GET LENGTH OF DSNAME        @YL026YB 44800000
         MVI   OBTDSNAM,BLANK      BLANK OUT AREA TO CONTAIN            44850020
         MVC   OBTDSNAM+D1(L'OBTDSNAM-D1),OBTDSNAM -DSNAME              44900020
         LA    R7,OBTDSNAM         POINT AT AREA TO HOLD DSNAME         44950020
         LA    R3,DSADSNAM         POINT AT DSNAME             @YL026YB 45000000
         BCTR  R15,R0              DECREMENT LENGTH FOR EXECUTE         45050020
         EX    R15,MOVE            MOVE DSNAME                          45100020
         MVC   LOCLIST(L'LOCLIST),CAM1 INITIALIZE LOCATE LIST           45150020
         LA    R1,OBTDSNAM         POINT AT DSNAME                      45200020
         ST    R1,LOCLIST+LOCNAME  PUT INTO CAMLST                      45250020
         XR    R1,R1               ZERO REGISTER                        45300020
         ST    R1,LOCLIST+LOCCVOL  INDICATE NO CVOL                     45350020
         LA    R1,LOCAREA          POINT AT LOCATE WORK AREA            45400020
         ST    R1,LOCLIST+LOCWA    PUT ADDRESS INTO CAMLST              45450020
         LOCATE LOCLIST            ISSUE LOCATE                         45550020
         LTR   R15,R15             TEST RETURN CODE                     45650020
         BZ    HISLOCOK            IF ZERO, GO DO OBTAIN                45700020
         L     R15,VCONVHS         ADDRESS OF VSAM HISTORY ROUT.        45750000
         BALR  R14,R15             GO TO VSAM ROUTINE          @YL026YB 45820000
         B     BSCRT01             GO CHECK STATUS                      45900020
HISTLOC1 XC    DS1DSORG-OBTWAD(L2,R12),ZERO CLEAR DSORG FIELD           46000020
         B     BSCRT01             GO CHECK STATUS                      46050020
HISLOCOK LA    R15,LOCAREA+FIRSTVOL POINT AT FIRST VOLSER IN LIST       46250020
         ST    R15,OBTCLST+D8      PUT IN OBTAIN LIST                   46300020
         B     HISTOBTN            GO COMPLETE LIST AND ISSUE OBTAIN    46350020
OBTOKGO  LM    R0,R9,LOCSAVOF(R13) RESTORE REGISTERS                    46500020
         BR    R8                  RETURN                               46550020
         EJECT                                                          46650020
*********************************************************************** 46750020
*                                                                     * 46800020
*   INPUT TO THIS ROUTINE IS THE BUFFER ADDRESS IN REGISTER 7         * 46850020
*   AND THE END OF BUFFER ADDRESS IN REGISTER 14.                     * 46900020
*   THE RETURN ADDRESS IS IN REGISTER 8.                              * 46950020
*   THE OUTPUT BUFFER IS CLEARED AND RETURNED IN REGISTER 7.          * 47000020
*   TRAILING BLANKS WILL BE ELIMINATED.                               * 47050020
*                                                                     * 47100020
*   IMPORTANT---THIS ROUTINE REQUIRES NO BASE REGISTER. KEEP IT THAT  * 47150020
*   WAY SO THAT IKJEHMEM CAN USE IT.                                  * 47200020
*                                                                     * 47250020
*********************************************************************** 47300020
IKJEHWRT EQU   *                   WRITE ROUTINE EXTERNAL NAME          47310020
WRITE    STM   R0,R9,LOCSAVOF(R13) SAVE REGISTERS LOCALLY               47350020
         LR    R2,R14              GET END OF DATA POINTER              47400020
         SR    R2,R7               CALCULATE DATA LENGTH                47450020
         LA    R1,FOUR             DECREMENT BUFFER POINTER BY 4        47500020
         SR    R7,R1               -SO R7 WILL POINT AT LL FIELD        47550020
         LA    R2,FOUR(R2)         BUMP LL BY FOUR FOR LL AND OFFSET    47600020
         STH   R2,D0(R7)           STORE LENGTH                         47650020
         XC    D2(L2,R7),D2(R7)    CLEAR OFFSET BYTE                    47700020
         LR    R6,R7               PUT OUTPUT LINE POINTER IN PROPER    47750020
         LA    R1,PARMLSTL         POINT IN FRONT OF BUFFER             47800020
         SR    R7,R1               CONTANING VARIOUS ADCONS             47850020
         LM    R1,R5,D0(R7)        SET UP REGISTERS FOR PUTLINE         47900020
         L     R15,PARMLSTL-FOUR(R7) GET ENTRY POINT.                   47950020
         PUTLINE PARM=(R2),UPT=(R3),ECT=(R4),ECB=(R5),OUTPUT=((R6),    X48000020
               DATA),ENTRY=(15),MF=(E,(1)) PUTLINE                      48050020
         LA    R7,PARMLSTL+FOUR(R7) POINT BACK TO DATA BUFFER           48550020
         MVI   D0(R7),BLANK        BLANK FIRST BYTE OF BUFFER           48650020
         MVC   D1(L'OUTBUF-L1,R7),D0(R7) CLEAR BUFFER                   48700020
         LM    R0,R9,LOCSAVOF(R13) RESTORE CALLERS REGISTER             48750020
         BR    R8                  RETURN TO CALLER                     48800020
         EJECT                                                          48950020
*********************************************************************** 49050020
*                                                                     * 49100020
*  THIS ROUTINE IS USED TO OUTPUT ERROR MESSAGES.  INPUT IS A THREE   * 49200020
*  WORD LIST CALLED ERRPARM WHICH CONTAINS INFORMATION AS FOLLOWS-    * 49250020
*        BYTE 1 AND 2 - THE RELATIVE POSITION OF THE FIRST            * 49350020
*                       LEVEL MESSAGE IN THE MESSAGE CSECT            * 49400020
*        BYTE 3 AND 4 - THE RELATIVE POSITION OF THE SECOND           * 49450020
*                       LEVEL MESSAGE IN THE MESSAGE CSECT            * 49500020
*        SECOND WORD  - POINTS TO TEXT TO BE INSERTED AFTER THE       * 49550020
*                       FIRST SEGMENT OF FIRST LEVEL MESSAGE          * 49600020
*        THIRD WORD   - POINTS TO TEXT TO BE INSERTED AFTER THE       * 49650020
*                       FIRST SEGMENT OF SECOND LEVEL MESSAGE         * 49700020
*  REGISTER 8 IS THE RETURN REGISTER                                  * 49750020
*                                                                     * 49800020
*********************************************************************** 49850020
IKJEHERR EQU   *                   EXTERNAL NAME FOR ERROR ROUTINE      49860020
ERROUT   STM   R0,R9,LOCSAVOF(R13) SAVE LOCAL REGISTERS                 49900020
         MVI   STACKSW,SWON        TURN STACK SWITCH ON                 49910020
         LA    R7,OUTBUF+D4        POINT AT PROPER BUFFER OFFSET        49950020
         LH    R1,ERRPARM          RELATIVE MESSAGE NUMBER              50000020
         BCTR  R1,R0               DECREMENT POSITION COUNT             50050020
         SLL   R1,D3               MULTIPLY BY 8 GIVES INDEX INTO TABLE 50100020
         L     R6,MSGCSECT         ADDRESS OF MESSAGE CSECT             50150020
         LA    R5,D0(R6,R1)        TABLE ENTRY FOR PROPER MESSAGE       50200020
         LH    R1,D0(R5)           LENGTH OF MESSAGE                    50250020
         LA    R2,D4(R1)           UP LENGTH FOR LL AND OFFSET FIELDS   50300020
         STH   R2,OUTBUF           SAVE LENGTH                          50350020
         XC    OUTBUF+D2(L2),OUTBUF+D2 CLEAR OFFSET FIELD               50400020
         LH    R4,D2(R5)           OFFSET TO MESSAGE IN CSECT           50450020
         LA    R3,D0(R6,R4)        POINTER TO MESSAGE IN CSECT          50500020
         BCTR  R1,R0               DECREMENT COUNT FOR EXECUTE          50550020
         EX    R1,MOVE             MOVE MESSAGE TO BUFFER               50600020
         LA    R7,D1(R1,R7)        POINT BEYOND MESSAGE                 50650020
         L     R4,ERRINST1         INSERTION POINTER                    50700020
         LTR   R4,R4               TEST FOR ZERO                        50750020
         BZ    SEGCHECK            IF ZERO, CHECK FOR SEGMENTATION      50800020
         XR    R1,R1               ZERO REGISTER                        50850020
         IC    R1,D0(R4)           GET LENGTH OF INSERT DATA            50900020
         LA    R3,D1(R4)           POINT AT INSERT DATA                 50950020
         LH    R2,OUTBUF           GET LENGTH                           51000020
         LA    R2,D0(R2,R1)        INCREMENT COUNT                      51050020
         STH   R2,OUTBUF           SAVE LENGTH AGAIN                    51100020
         BCTR  R1,R0               DECREMENT COUNT FOR EXECUTE          51150020
         EX    R1,MOVE             MOVE INSERT DATA TO BUFFER           51200020
         LA    R7,D1(R1,R7)        POINT BEYOND MESSAGE                 51250020
SEGCHECK LH    R4,D4(R5)           PICKUP OFFSET OF SEGMENT             51350020
         LTR   R4,R4               TEST FOR ZERO                        51400020
         BZ    SECLVTST            CHECK FOR SECOND LEVEL MESSAGE       51450020
         LA    R4,D0(R4,R6)        POINT AT SEGMENT TABLE               51500020
SEGLOOP  LH    R1,D0(R4)           PICK UP LENGTH OF SEGMENT            51600020
         LTR   R1,R1               TEST LENGTH                          51650020
         BZ    SECLVTST            CHECK FOR SECOND LEVEL MESSAGE       51700020
         LH    R2,OUTBUF           GET LENGTH                           51750020
         LA    R2,D0(R2,R1)        INCREMENT COUNT                      51800020
         STH   R2,OUTBUF           SAVE LENGTH AGAIN                    51850020
         LH    R3,D2(R4)           PICKUP OFFSET TO SEGMENT             51900020
         LA    R3,D0(R3,R6)        CALCULATE THE ADDRESS                51950020
         BCTR  R1,R0               DECREMENT FOR EXECUTE                52000020
         EX    R1,MOVE             MOVE SEGMENT TO BUFFER               52050020
         LA    R7,D1(R7,R1)        POINT AT END OF DATA IN BUFFER       52100020
         LA    R4,D4(R4)           NEXT SEGMENT SLOT IN TABLE           52150020
         B     SEGLOOP             PROCESS ANOTHER SEGMENT              52200020
*  THIS ROUTINE CHECKS FOR SECOND LEVEL MESSAGES,                       52210020
*  IF NONE IT PROCESSES FIRST LEVEL                                     52220020
SECLVTST LA    R1,D1               SEGMENT COUNT IS 1                   52550020
         ST    R1,MSGPARM1+D4      PUT IN PARM LIST                     52600020
         LA    R1,OUTBUF           POINT TO OUTPUT BUFFER               52650020
         ST    R1,MSGPARM1+D8      SAVE POINTER TO FIRST LEVEL MESSAGE  52700020
         LH    R1,ERRSECND         CHECK FOR SECOND LEVEL MESSAGE       52750020
         LTR   R1,R1               TEST FOR ZERO                        52800020
         BZ    NOSECLVL            NO SECOND LEVEL PUT OUT FIRST ONLY   52850020
         BCTR  R1,R0               DECREMENT POSITION COUNT             52900020
         LA    R0,D6               TABLE ENTRY SIZE                     52950020
         MR    R0,R0               OFFSET INTO TABLE CALCULATED         53000020
         LH    R4,D6(R5)           OFFSET TO SECOND LEVEL TABLE         53050020
         LA    R4,D0(R4,R6)        ADDRESS OF TABLE                     53100020
         LA    R5,D0(R4,R1)        OFFSET TO ENTRY IN TABLE             53150020
         LA    R7,SECBUFF+D4       POINT TO SECOND BUFFER OFFSET        53200020
         LH    R1,D0(R5)           GET LENGTH OF ENTRY                  53250020
         LA    R2,D4(R1)           UP LENGTH FOR LL AND OFFSET FIELDS   53300020
         STH   R2,SECBUFF          SAVE LENGTH OF FIRST SEGMENT         53350020
         XC    SECBUFF+D2(L2),SECBUFF+D2 CLEAR OFFSET FIELD             53400020
         LH    R4,D2(R5)           OFFSET TO MESSAGE IN CSECT           53450020
         LA    R3,D0(R6,R4)        ADDRESS OF MESSAGE IN CORE           53500020
         BCTR  R1,R0               DECREMENT LENGTH FOR EXECUTE         53550020
         EX    R1,MOVE             MOVE MESSAGE SEGMENT TO BUFFER       53600020
         LA    R7,D1(R1,R7)        BUMP BUFFER POINTER                  53650020
         MVC   SECBUFF+D10(L2),OUTBUF+D10 SET ID FOR SECOND LEVEL       53700020
         L     R4,ERRINST2         INSERT POINTER FOR SECOND LEVEL      53750020
         LTR   R4,R4               TEST FOR ZERO                        53800020
         BZ    SECSEGCK            IF ZERO, CHECK SEGMENTATION          53850020
         XR    R1,R1               ZERO REGISTER                        53900020
         IC    R1,D0(R4)           GET LENGTH OF INSERT DATA            53950020
         LH    R2,SECBUFF          SEGMENT LENGTH                       54000020
         LA    R2,D0(R2,R1)        UPDATE LENGTH OF BUFFER MESSAGE      54050020
         STH   R2,SECBUFF          SAVE LENGTH AGAIN                    54100020
         LA    R3,D1(R4)           POINT AT DATA                        54150020
         BCTR  R1,R0               DECREMENT COUNT FOR EXECUTE          54200020
         EX    R1,MOVE             MOVE DATA TO BUFFER                  54250020
         LA    R7,D1(R1,R7)        UPDATE BUFFER POINTER                54300020
SECSEGCK LA    R1,D1               SET SEGMENT COUNT TO ONE             54400020
         ST    R1,MSGPARM2+D4      PUT IT INTO PARM LIST                54450020
         LA    R1,SECBUFF          BUFFER ADDRESS                       54500020
         ST    R1,MSGPARM2+D8      -INTO LIST                           54550020
         LA    R1,MSGPARM2         CHAIN MESSAGE LEVEL                  54600020
         ST    R1,MSGPARM1         -PARAMETER LISTS                     54650020
         XC    MSGPARM2,MSGPARM2   END OF CHAIN LINK ADDRESS            54700020
         MVI   MSGPARM2,HEXFF      END OF LIST FLAG IN CHAIN FIELD      54750020
         LH    R4,D4(R5)           OFFSET TO SEGMENT TABLE              54800020
         LTR   R4,R4               TEST FOR ZERO                        54850020
         BZ    PUTMSG              IF ZERO, PUT OUT MESSAGE             54900020
         LA    R4,D0(R4,R6)        ADDRESS OF SEGMENT TABLE             54950020
         LH    R1,D0(R4)           LENGTH OF SEGMENT                    55000020
SECSEGLP LTR   R1,R1               IS THIS THE LAST SEGMENT             55100020
         BZ    PUTMSG              YES, GO WRITE MESSAGE                55150020
         LH    R2,SECBUFF          SEGMENT LENGTH                       55200020
         LA    R2,D0(R2,R1)        UPDATE LENGTH OF BUFFER MESSAGE      55250020
         STH   R2,SECBUFF          RE-STORE IT                          55300020
         LH    R3,D2(R4)           OFFSET TO SEGMENT                    55350020
         LA    R3,D0(R3,R6)        ADDRESS OF MESSAGE                   55400020
         BCTR  R1,R0               DECREMENT COUNT FOR EXECUTE          55450020
         EX    R1,MOVE             MOVE INTO BUFFER                     55500020
         LA    R7,D1(R7,R1)        UPDATE BUFFER OFFSET                 55550020
         LA    R4,D4(R4)           GET NEXT SEGMENT                     55600020
         B     SECSEGLP            GO PROCESS THIS SEGMENT              55650020
NOSECLVL XC    MSGPARM1,MSGPARM1   CLEAR SECOND LEVEL POINTER           55750020
         MVI   MSGPARM1,HEXFF      PUT IN END OF CHAIN MARK             55800020
PUTMSG   LM    R3,R5,UPTPTR        LOAD UPT, ECT, ECB ADDRESSES         55900020
         LA    R6,MSGPARM1         POINT TO MESSAGE PARM LISTS          55950020
         LA    R2,DPUTLINE         LIST FORM OF MACRO                   56000020
         LA    R1,PUTLLIST         LIST FOR E FORM OF MACRO             56050020
         L     R15,PUTLADDR        ADDRESS OF PUTLINE ROUTINE           56100020
         PUTLINE PARM=(R2),UPT=(R3),ECT=(R4),ECB=(R5),                 X56200020
               OUTPUT=((R6),MULTLVL),ENTRY=(15),MF=(E,(1)) PUTLINE      56250020
         LM    R0,R9,LOCSAVOF(R13) RESTORE LOCAL REGISTERS              56300020
         BR    R8                  RETURN                               56350020
         EJECT                                                          56400020
*                                                                       56450020
*  CONSTANTS AND LIST FORMS OF MACROS                                   56500020
*                                                                       56600020
TPUTMDL  PUTLINE MF=L              LIST FORM OF PUTLINE                 56700020
ENDTPUT  EQU   *                   END OF PUTLINE EXPANSION             56750020
LTPUTL   EQU   ENDTPUT-TPUTMDL     LENGTH OF PUTLINE EXPANSION          56800020
OLFS     EQU   *                   BEGINNING OF LIST FORMS FOR OBTWAD   56850020
RDJMDL   RDJFCB  (,(INPUT)),MF=L   LIST FORM READ JFCB                  56900020
         SPACE                                                          56950020
CLSTMDL  CAMLST  SEARCH,1,2,3      OBTAIN CAMLST                        57000020
         SPACE                                                          57050020
DCBMDL   DCB   DSORG=PS,MACRF=R,RECFM=F,BLKSIZE=256,KEYLEN=8,LRECL=256,C57100020
               DDNAME=DUMMY        DCB                                  57150020
         SPACE                                                          57200020
OPENMDL  OPEN  (,),MF=L            LIST FORM OF OPEN                    57250020
         SPACE                                                          57300020
READMDL  READ  RMDECB,SF,,,'S',,,MF=L LIST FORM OF READ                 57350020
         SPACE                                                          57400020
CLOSEMDL CLOSE (,),MF=L            MODEL FOR THE LIST FORM OF CLOSE     57450020
LOLFS    EQU   *-OLFS              LENGTH OF AREA TO MOVE               57550020
         SPACE                                                          57600020
ILFS     EQU   *                   BEGINNING OF LIST FORMS FOR INITCORE 57700020
GETMLMDL GETMAIN  EC,MF=L          LIST FORM OF GETMAIN                 57750020
FREEMMDL FREEMAIN  E,MF=L          LIST FORM OF FREEMAIN                57850020
LILFS    EQU   *-ILFS              LENGTH OF LIST FORMS FOR INITCORE    58000020
         SPACE                                                          58050020
PRSEC01  DC    V(IKJEHPRM)         ADDRESS OF PARSE CONTROL CSECT       58450020
MSGCSECT DC    V(IKJEHALM)         ADDRESS OF MESSAGE CSECT             58500020
VCONHIST DC    V(IKJEHHST)         ADDRESS OF HISTORY CSECT             58550020
VCONSTAT DC    V(IKJEHSTS)         ADDRESS OF STATUS CSECT              58600020
VCONMEM  DC    V(IKJEHMMR)         ADDRESS OF MEMBER CSECT              58650020
VCONVHS  DC    V(IKJEHVHS)         ADDR. OF VSAM HIST. CSECT   @YL026YB 58660000
CAM1     CAMLST NAME,1,,3          LOCATE CAMLST                  M0875 58690000
ZERO     DC    F'0'                USED FOR SETTING ZEROS               58720000
MOVE1    MVC   D0(D0,R14),D0(R3)   USED FOR EXECUTE INST.      @YL026YB 58750000
MOVE     MVC   D0(L1,R7),D0(R3)    USED FOR EXECUTE MOVES               58800020
BLANKS   DC    C'        '         BLANKS FOR COMPARISON                58850020
JESNAME  DC    C'JES'              COMPARISON FOR SPOOL DS      ZA00106 58870002
SYSNMMDL DC    C'SYS00000.T000000.' TEST FOR SYSNAMES MASK              58900020
NHISTORY DC    C'HISTORY'          HISTORY INSERT                       58902020
NMEMBERS DC    C'MEMBERS'          MEMBERS INSERT                       58904020
NSYSNAME DC    C'SYSNAMES'         SYSNAMES INSERT                      58906020
NULLFILE DC    C'NULLFILE'         NULLFILE                             58910020
DYNAMMSG DC    C'DATA SETS MUST BE UNALLOCATED BEFORE NEW ALLOCATIONS  *58920000
               CAN BE DONE'        MESSAGE                     @YL026YB 58927000
ASKMSG   DC    C'* THIS DATA SET IS NOT IN-USE' MESSAGE        @YL026YB 58934000
TERMFILE DC    C'TERMFILE'         TERMINAL FILE                        58942020
TITLE1   DC    C'--DSORG--CREATED---EXPIRES---SECURITY'  HEADING        58944020
TITLE2   DC    C'--DDNAME---DISP--' HEADING                             58946020
*        CONSTANTS FOR DYNAMIC INFORMATION RETRIEVAL           @YL026YB 58950000
TXTREQ   DS    0CL6                RELATIVE REQUEST TXTUNIT    @YL026YB 58951000
         DC    X'000F'             KEY FOR REL. REQ            @YL026YB 58952000
         DC    X'0001'             NUMBER OF REL. REQ.         @YL026YB 58953000
         DC    X'0002'             LENGTH OF REQUEST           @YL026YB 58954000
TXTDSNM  DS    0CL6                DSNAME TEXT UNIT            @YL026YB 58955000
         DC    X'0005'             KEY FOR DSNAME              @YL026YB 58956000
         DC    X'0001'             NUMBER OF DSNAMES           @YL026YB 58957000
         DC    X'002C'             LENGTH OF DSNAME            @YL026YB 58958000
TXTLIMIT DS    0CL6                LIMIT OF TEXT UNIT          @YL026YB 58959000
         DC    X'000B'             KEY FOR LIMIT               @YL026YB 58960000
         DC    X'0001'             NUMBER OF LIMITS            @YL026YB 58961000
         DC    X'0002'             LENGTH OF LIMIT             @YL026YB 58962000
TXTATTR  DS    0CL6                ATTRIBUTE TXT UNIT          @YL026YB 58963000
         DC    X'000C'             KEY FOR ATTRIBUTE           @YL026YB 58964000
         DC    X'0001'             NUMBER                      @YL026YB 58965000
         DC    X'0001'             LENGTH                      @YL026YB 58966000
TXLENTRY DS    0CL6                LAST ENTRY TXT UNIT         @YL026YB 58967000
         DC    X'000D'             KEY                         @YL026YB 58968000
         DC    X'0001'             NUMBER                      @YL026YB 58969000
         DC    X'0001'             LENGTH                      @YL026YB 58970000
TXTYPE   DS    0CL6                DATA SET TYPE TXT UNIT      @YL026YB 58971000
         DC    X'000E'             KEY                         @YL026YB 58972000
         DC    X'0001'             NUMBER                      @YL026YB 58973000
         DC    X'0001'             LENGTH                      @YL026YB 58974000
TXTMEM   DS    0CL6                                            @YL026YB 58975000
         DC    X'0006'             KEY                         @YL026YB 58976000
         DC    X'0001'             NUMBER                      @YL026YB 58977000
         DC    X'0008'             LENGTH                      @YL026YB 58978000
TXTDD    DS    0CL6                DDNAME TXT UNIT             @YL026YB 58979000
         DC    X'0004'             KEY                         @YL026YB 58980000
         DC    X'0001'             NUMBER                      @YL026YB 58981000
         DC    X'0008'             LENGTH                      @YL026YB 58982000
TXTSTAT  DS    0CL6                STATUS TXT UNIT             @YL026YB 58983000
         DC    X'0007'             KEY                         @YL026YB 58984000
         DC    X'0001'             NUMBER                      @YL026YB 58985000
         DC    X'0001'             LENGTH                      @YL026YB 58986000
TXNDISP  DS    0CL6                NORMAL DISP TXT UNIT        @YL026YB 58987000
         DC    X'0008'             KEY                         @YL026YB 58988000
         DC    X'0001'             NUMBER                      @YL026YB 58989000
         DC    X'0001'             LENGTH                      @YL026YB 58990000
TXCDISP  DS    0CL6                CONDITIONAL DISP TXT UNIT   @YL026YB 58991000
         DC    X'0009'             KEY                         @YL026YB 58992000
         DC    X'0001'             NUMBER                      @YL026YB 58993000
         DC    X'0001'             LENGTH                      @YL026YB 58994000
         EJECT                                                          58995000
IKJEHPRM IKJPARM                                                        59000020
PSTAT    IKJKEYWD                                                       59050020
         IKJNAME  'STATUS'                                              59100020
PHIST    IKJKEYWD                                                       59150020
         IKJNAME  'HISTORY'                                             59200020
PMEM     IKJKEYWD                                                       59250020
         IKJNAME  'MEMBERS'                                             59300020
PSYSN    IKJKEYWD                                                       59350020
         IKJNAME  'SYSNAMES'                                            59400020
         IKJENDP                                                        59450020
         EJECT                                                          59550020
IKJEHHST CSECT                                                          59650020
*********************************************************************** 59700020
*                                                                     * 59750020
*    THIS ROUTINE GETS CONTROL IF HISTORY WAS REQUESTED AND           * 59800020
*    FORMATS THE REQUIRED INFORMATION INTO THE OUTPUT BUFFER.         * 59850020
*    THE INFORMATION IS OBTAINED FROM THE DSCB WHICH IS ALREADY       * 59900020
*    AVAILABLE IN CORE AT THIS POINT. THE INFORMATION IS              * 59950020
*    REFERENCED THROUGH DSECT OBTWAD. THE FOLLOWING INFORMATION       * 60000020
*    IS COLLECTED-                                                    * 60050020
*                                                                     * 60100020
*                   1. CREATION DATE                                  * 60150020
*                   2. EXPIRATION DATE                                * 60200020
*                   3. SECURITY (PASSWORD) INFORMATION                * 60250020
*                   4. DSORG                                          * 60300020
*                                                                     * 60350020
*********************************************************************** 60400020
HISTROUT SAVE  (14,12),,*          SAVE REGISTERS                       60450020
         LR    R11,R15             ENTRY POINT ADDRESS                  60500020
         LR    R10,R13             WORKAREA ADDRESS                     60550020
         DROP  R13                 CHANGE BASE FOR INITCORE      A42338 60560021
         USING INITCORE,R10        ADDRESSABILITY FOR WORK AREA         60600020
         USING OBTWAD,R12          ADDRESSABILITY FOR OBTAIN WORK AREA  60650020
         USING HISTROUT,R11        ADDRESSABILITY FOR THIS ROUTINE      60700020
         GETMAIN R,LV=SAVELEN,SP=SSP GET NEW SAVE AREA                  60750020
         ST    R13,D4(R1)          CHAIN SAVE AREAS BACKWARDS           60800020
         ST    R1,D8(R13)          -AND FORWARDS                        60850020
         LR    R13,R1              NEW SAVEAREA                         60900020
         OI    CNTRL,WRITEMSK      TURN ON WRITE SWITCH                 61000020
         TM    DS1DSORG,PS         IS DSORG PS                          61100020
         BO    SETPS               IF YES, BRANCH                       61150020
         TM    DS1DSORG,PO         IS DSORG PO                          61250020
         BO    SETPO               IF YES, BRANCH                       61300020
         TM    DS1DSORG,IS         IS DSORG IS                          61400020
         BO    SETIS               IF YES, BRANCH                       61450020
         TM    DS1DSORG,DA         IS DSORG DA                          61550020
         BO    SETDA               IF YES, BRANCH                       61600020
         TM    DS1DSORG,NOTID      IS AN UNIDENTIFIED BIT SET           61700020
         BZ    SETND               IF NO, BRANCH                        61750020
         LA    R15,UNKL            LENGTH OF DSORG FIELD                61850020
         LA    R14,UNK             DSORG WAS NOT IDENTIFIABLE           61900020
EXDSORGM LA    R5,OUTBUF+DSORGOFF  POINT AT DSORG FIELD                 62000020
         BCTR  R15,R0              DECREMENT FOR EXECUTE                62050020
         EX    R15,DSORGMV         MOVE DSORG TO BUFFER                 62100020
         LA    R5,D1(R5,R15)       POINT BEYOND DSORG IN BUFFER         62150020
         TM    DS1DSORG,UNMV       CHECK DSCB FOR UNMOVABLE ATTRIBUTE   62200020
         BZ    DSORGEXT            EXIT FROM DSORG PROCESSING           62250020
         MVI   D0(R5),CHARU        SET UNMOVABLE ATTRIBUTE              62300020
         B     DSORGEXT            GO TO DSORG OPTION PROCESSING        62350020
SETPS    LA    R15,SEQL            LENGTH OF DSORG FIELD                62450020
         LA    R14,SEQ             DSORG WAS SEQUENTIAL                 62500020
         B     EXDSORGM            PROCESS THE DSORG FIELD              62550020
SETPO    LA    R15,PDSL            LENGTH OF DSORG FIELD                62650020
         LA    R14,PDS             DSORG WAS PARTITIONED                62700020
         B     EXDSORGM            PROCESS THE DSORG FIELD              62750020
SETIS    LA    R15,ISEQL           LENGTH OF DSORG FIELD                62850020
         LA    R14,ISEQ            DSORG WAS INDEXED SEQUENTIAL         62900020
         B     EXDSORGM            PROCESS THE DSORG FIELD              62950020
SETDA    LA    R15,DAL             LENGTH OF DSORG FIELD                63050020
         LA    R14,DIRECT          DSORG WAS DIRECT (BDAM)              63100020
         B     EXDSORGM            PROCESS THE DSORG FIELD              63150020
SETND    LA    R15,UNDEFL          LENGTH OF DSORG FIELD                63250020
         LA    R14,UNDEF           DSORG WAS NOT DEFINED                63300020
         B     EXDSORGM            PROCESS THE DSORG FIELD              63350020
DSORGEXT LA    R2,DS1CREDT         SET UP TO CONVERT CREATION DATE      63450020
         LA    R7,OUTBUF           ADDRESS OF OUTPUT BUFFER             63500020
         LA    R7,CRDTOFF(R7)      POINT AT BUFFER POSITION             63550020
         BAL   R14,HDT02           GO CONVERT DATE AND PUT IN BUFFER    63600020
         LA    R2,DS1EXPDT         SET UP TO CONVERT EXPIRATION DATE    63650020
         LA    R7,NXTBUF(R7)       POINT AT NEXT BUFFER POSITION        63700020
         BAL   R14,HDT02           GO CONVERT DATE AND PUT IN BUFFER    63750020
         LA    R7,NXTBUF(R7)       POINT AT NEXT BUFFER POSITION        63800020
*   CHECK FOR VARIOUS COMBINATIONS OF RACF AND PASSWORD PROTECTION      63810004
         TM    DS1DSIND,RACOPWD    RACF AND PASSWORD           @Z40RSSA 63850004
         BNO   NTBOTH                 NO                       @Z40RSSA 63900004
         MVC   D0(9,R7),WPWDRAC                                @Z40RSSA 63910004
TSTREAD  TM    DS1DSIND,WPIND      WRITE PASSWORD PROTECT?     @Z40RSSA 63920004
         BO    HISTEXIT               YES                      @Z40RSSA 63930004
         MVI   D0(R7),C'R'            NO, CHANGE TO RPWD/RACF  @Z40RSSA 63940004
HISTEXIT LR   R1,R13               SAVE AREA ADDRESS FOR FREEMAIN       63950004
         L    R13,D4(R1)           CALLERS SAVEAREA                     64000004
         FREEMAIN R,LV=SAVELEN,A=(1),SP=SSP FREE SAVE AREA              64150020
         RETURN (14,12)            RETURN                               64200020
        SPACE  1                                                        64210004
*       NOT BOTH RACF AND PASSWORD PROTECTED                            64250004
NTBOTH  MVC   D0(4,R7),NONE        ASSUME NONE                 @Z40RSSA 64300004
        BZ    HISTEXIT                IF NONE                  @Z40RSSA 64350004
        MVC   D0(4,R7),RACF        ASSUME RACF                 @Z40RSSA 64400004
        TM    DS1DSIND,RACIND                                  @Z40RSSA 64450004
        BO    HISTEXIT                RACF ONLY                @Z40RSSA 64500004
        MVC   D0(4,R7),WPWD       ASSUME WPWD ONLY             @Z40RSSA 64550004
        B     TSTREAD             TO TEST FOR READ             @Z40RSSA 64560004
*********************************************************************** 64600020
*                                                                     * 64650020
*    THIS ROUTINE CONVERTS BINARY DATES OF THE FORM YYDDDD TO         * 64700020
*    CHARACTER FORMAT IN THE FORM MM/DD/YY.  LEAP YEARS ARE HANDLED.  * 64750020
*    INPUT REQUIREMENTS ARE-                                          * 64800020
*         1.   R2 POINTS TO FIELD TO BE CONVERTED                     * 64850020
*         2.   R7 POINTS TO RECEIVING FIELD                           * 64900020
*         3.   R14 HAS RETURN ADDRESS                                 * 64950020
*                                                                     * 65000020
*********************************************************************** 65010020
HDT02    CLC   D0(L3,R2),HDTZ      CHECK FOR UNSPECIFIED DATE           65100020
         BNE   HDT04               BRANCH IF DATE PRESENT               65150020
HDT03    MVC   D0(L'HDTDF,R7),HDTDF MOVE IN DEFAULT OF 00/00/00         65200020
         BR    R14                 RETURN                               65250020
HDT04    STM   R14,R6,HDTSV        SAVE REGISTERS                       65300020
*                                                                       65350020
*  TEST FOR LEAP YEAR BY ANDING THE YEAR FIELD AGAINST A BYTE WITH      65400020
*  THE TWO LOW ORDER BITS ON. LEAP YEARS WILL HAVE ZEROS FOR THE TWO    65450020
*  LOW ORDER BYTES.                                                     65500020
*                                                                       65550020
         SR    R3,R3               CLEAR REGISTER                       65600020
         IC    R3,D0(R2)           GET YEAR BYTE FROM DATE FIELD        65650020
         LA    R4,HDTBIN3          SET UP TO TEST LOW ORDER BITS        65700020
         NR    R3,R4               ZERO, IF YEAR IS DIVISIBLE BY 4      65750020
         LA    R4,HDTNY            SET UP FOR NON-LEAP YEAR             65800020
         BNZ   HDT06               NOT ZERO, NOT LEAP YEAR              65850020
         LA    R4,HDTLY            REMAINDER IS ZERO, USE LEAP YEAR     65900020
HDT06    MVC   HDTWK(L2),D1(R2)    MOVE DAY FIELD TO HALFWORD FOR ALIGN 65950020
         LH    R3,HDTWK            DAY OF YEAR (0-365)                  66000020
         LA    R6,MNTHS            BRANCH CONTROL IS NUMBER OF MONTHS   66050020
*                                                                       66100020
*  SEARCH NOW BEGINS TO FIND THE MONTH IN WHICH THE DAY-OF-THE-YEAR     66150020
*  OCCURS. IF DAY-OF-THE-YEAR IS GREATER THAN 365/366, MONTH 12 IS USED 66200020
*                                                                       66250020
HDT08    CH    R3,D0(R4)           COMPARE DAY TO TABLE ENTRY FOR MONTH 66300020
         BH    HDT10               DAY GREATER THAN TABLE IS A FIND     66350020
         LA    R4,D2(R4)           POINT TO NEXT ELEMENT                66400020
         BCT   R6,HDT08            DECREMENT MONTH AND RETRY            66450020
         B     HDT03               USE DEFAULT 00/00/00                 66500020
HDT10    SH    R3,D0(R4)           SUBTRACT TABLE ELEMENT FROM DAY      66550020
         EX    R3,HDTCLI           COMPARE DAY TO 31                    66600020
         BNL   HDT12               OKAY, GO TO MONTHS                   66650020
         LA    R3,DYS31            DEFAULT TO 31 DAYS                   66700020
HDT12    CVD   R6,HDTWK            CONVERT MONTH TO DECIMAL             66750020
         UNPK  D0(L2,R7),HD6(D2)   -THEN TO CHARACTER                   66800020
         CVD   R3,HDTWK            CONVERT DAY TO DECIMAL               66850020
         UNPK  D3(L2,R7),HD6(D2)   -THEN TO CHARACTER                   66900020
         IC    R6,D0(R2)           GET YEAR                             66950020
         CVD   R6,HDTWK            CONVERT IT TO DECIMAL                67000020
         UNPK  D6(L2,R7),HD6(D2)   -THEN TO CHARACTER                   67050020
         MVZ   D1(L7,R7),D0(R7)    PROPAGATE NUMERIC ZONE               67100020
         MVI   D2(R7),SLASH        MOVE IN SEPARATORS BETWEEN           67150020
         MVI   D5(R7),SLASH        -MONTH, DAY, AND YEAR                67200020
         LM    R14,R6,HDTSV        RESTORE REGISTERS                    67250020
         BR    R14                 RETURN                               67300020
*                                                                       67400020
*  THE FOLLOWING EQUATES AND CONSTANTS ARE USED BY THE HISTORY ROUTINE. 67450020
*                                                                       67500020
DSORGOFF EQU   2                   OFFSET TO DSORG FIELD IN OUTPUT      67550020
PS       EQU   X'40'               SEQUENTIAL                           67600020
PO       EQU   X'02'               PARTITIONED                          67650020
IS       EQU   X'80'               INDEXED SEQUENTIAL                   67700020
DA       EQU   X'20'               DIRECT                               67750020
NOTID    EQU   X'1C'               THESE BITS RESERVED IN DSORG         67800020
UNMV     EQU   X'01'               UNMOVEABLE BIT                       67850020
DYS31    EQU   31                  USED FOR THIRTY ONE COMPARE          67860020
PWRD1    EQU   X'14'               MASK FOR PASSWORD PROTECTION (DSCB)  67870020
PWRD2    EQU   X'10'               MASK FOR WRITE PROTECTION            67880020
RACIND   EQU   X'40'               MASK FOR RACF PROTECTION             67882004
WPIND    EQU   X'04'               WRITE PASSWORD PROTECT               67884004
RACOPWD  EQU   X'50'               RACF OR PASSWORD                     67886004
HDTBIN3  EQU   X'03'               BYTE WITH TWO LOW ORDER BITS ON      67890020
DSORGMV  MVC   D0(L0,R5),D0(R14)   USED WITH EXECUTE TO MOVE DSORG      67900020
HDTCLI   CLI   HDTC31,D0           CHECKS IF DATE GREATER THAN 31       67910020
SEQ      DC    C'PS'               PHYSICAL SEQUENTIAL                  67950020
SEQL     EQU   L'SEQ               LENGTH OF CONSTANT SEQ               68000020
PDS      DC    C'PO'               PARTITIONED DATA SET                 68050020
PDSL     EQU   L'PDS               LENGTH OF CONSTANT PDS               68100020
ISEQ     DC    C'IS'               INDEXED SEQUENTIAL                   68150020
ISEQL    EQU   L'ISEQ              LENGTH OF CONSTANT ISEQ              68200020
DIRECT   DC    C'DA'               DIRECT ACCESS                        68250020
DAL      EQU   L'DIRECT            LENGTH OF CONSTANT DIRECT            68300020
UNDEF    DC    C'**'               DSORG NOT SPECIFIED                  68350020
UNDEFL   EQU   L'UNDEF             LENGTH OF CONSTANT UNDEF             68400020
UNK      DC    C'??'               DSORG NOT RECOGNIZED                 68450020
UNKL     EQU   L'UNK               LENGTH OF CONSTANT UNK               68500020
NONE     DC    C'NONE'             NO RACF OR PASSWORD PROTECTION       68550004
RACF     DC    C'RACF'             RACF PROTECTION             @Z40RSSA 68600004
WPWD     DC    C'WPWD'             WRITE PASSWORD PROTECTION   @Z40RSSA 68650004
WPWDRAC  DC    C'WPWD/RACF'        WRITE PASSWORD AND RACF     @Z40RSSA 68700004
HDTZ     DC    X'000000'           DATE IS NOT SPECIFIED                69250020
HDTDF    DC    C'00/00/00'         DISPLAYED DATE OF ZERO               69300020
HDTC31   DC    FL1'31'             USED FOR 31 DAY COMPARISON           69350020
*  THIS IS THE MONTH TABLE LOOKUP INDEX FOR NON LEAP-YEARS              69450020
HDTNY    DC    H'334'              DECEMBER                             69600020
         DC    H'304'              NOVEMBER                             69650020
         DC    H'273'              OCTOBER                              69700020
         DC    H'243'              SEPTEMBER                            69750020
         DC    H'212'              AUGUST                               69800020
         DC    H'181'              JULY                                 69850020
         DC    H'151'              JUNE                                 69900020
         DC    H'120'              MAY                                  69950020
         DC    H'90'               APRIL                                70000020
         DC    H'59'               MARCH                                70050020
         DC    H'31'               FEBRUARY                             70100020
         DC    H'0'                JANUARY                              70150020
*  THIS IS THE MONTH TABLE LOOKUP INDEX FOR LEAP YEARS                  70250020
HDTLY    DC    H'335'              DECEMBER                             70350020
         DC    H'305'              NOVEMBER                             70400020
         DC    H'274'              OCTOBER                              70450020
         DC    H'244'              SEPTEMBER                            70500020
         DC    H'213'              AUGUST                               70550020
         DC    H'182'              JULY                                 70600020
         DC    H'152'              JUNE                                 70650020
         DC    H'121'              MAY                                  70700020
         DC    H'91'               APRIL                                70750020
         DC    H'60'               MARCH                                70800020
         DC    H'31'               FEBRUARY                             70850020
         DC    H'0'                JANUARY                              70900020
         EJECT                                                          71150020
IKJEHVHS CSECT                                                 @YL026YB 71150300
*********************************************************************** 71150600
*                                                                     * 71150900
*    THIS ROUTINE GETS CONTROL IF HISTORY WAS REQUESTED AND           * 71151200
*    FORMATS THE REQUIRED INFORMATION INTO THE OUTPUT BUFFER.         * 71151500
*    THE INFORMATION IS OBTAINED FROM THE DSCB WHICH IS ALREADY       * 71151800
*    AVAILABLE IN CORE AT THIS POINT. THE INFORMATION IS              * 71152100
*    REFERENCED THROUGH DSECT OBTWAD. THE FOLLOWING INFORMATION       * 71152400
*    IS COLLECTED-                                                    * 71152700
*                                                                     * 71153000
*                   1. CREATION DATE                                  * 71153300
*                   2. EXPIRATION DATE                                * 71153600
*                   3. ENTRY CODE                                     * 71153900
*                                                                     * 71154200
*********************************************************************** 71154500
HISTROU1 SAVE  (14,12),,*          SAVE REGISTERS              @YL026YB 71154800
         LR    R11,R15             ENTRY POINT ADDRESS         @YL026YB 71155100
         LR    R10,R13             WORKAREA ADDRESS            @YL026YB 71155400
         USING INITCORE,R10        ADDRESSABILITY FOR WORK AREA         71155700
         USING OBTWAD,R12          ADDRESSABILITY FOR OBTAIN WORK AREA  71156000
         USING HISTROU1,R11        ADDRESSABILITY FOR THIS ROUTINE      71156300
         GETMAIN R,LV=SAVELEN,SP=SSP GET NEW SAVE AREA         @YL026YB 71156600
         ST    R13,D4(R1)          CHAIN SAVE AREAS BACKWARDS  @YL026YB 71156900
         ST    R1,D8(R13)          -AND FORWARDS               @YL026YB 71157200
         LR    R13,R1              NEW SAVEAREA                @YL026YB 71157500
         LA    R8,LOCPTN           POINT TO CPL CONSTANTS      @YL026YB 71157800
         ST    R8,CTGPLPTR         STORE IN CTGPL POINTER      @YL026YB 71158100
         USING CTGPL,R8            ADDRESSABILITY TO CPL       @YL026YB 71158400
         XC    LOCPTN(D112),LOCPTN ZERO CPL AND FPL            @YL026YB 71158700
         MVI   CTGOPTN1,CTGNAME    44 BYTE NAME ENTRY          @YL026YB 71159000
         MVI   CTGOPTN3,LOCVSAM    VSAM LOCATE REQUEST         @YL026YB 71159300
         LA    R5,DSADSNAM         POINT TO DSNAME             @YL026YB 71159600
         ST    R5,CTGENT           STORE IN CPL                @YL026YB 71159900
         LA    R5,WKAREA           POINT TO WORKAREA           @YL026YB 71160200
         MVC   WKAREA(D2),WKLGTH   LENGTH OF WORK AREA         @YL026YB 71160500
         ST    R5,CTGWKA           STORE IN CPL                @YL026YB 71160800
         MVI   CTGNOFLD,FLDNO      NUMBER OF FPLS REQUIRED     @YL026YB 71161100
         LA    R5,FLDREQ1          POINT TO FIRST FPL          @YL026YB 71161400
         ST    R5,CTGFIELD         STORE IN CPL                @YL026YB 71161700
         LA    R5,FLDREQ2          POINT TO 2ND FPL            @YL026YB 71162000
         ST    R5,CTGFIELD+D4      STORE IN CPL                @YL026YB 71162300
         LA    R5,FLDREQ3          POINT TO 3RD FPL            @YL026YB 71162600
         ST    R5,CTGFIELD+D8      STORE IN CPL                @YL026YB 71162900
         USING CTGFL,R4            ADDRESSABILITY TO 1ST FPL   @YL026YB 71163200
         L     R4,CTGFIELD         POINT TO 1ST FPL            @YL026YB 71163500
         MVI   CTGFLDNO,HEX01      NUMBER OF DATA ADDR.        @YL026YB 71163800
         LA    R5,ENNTYPE          POINTER TO 1ST FIELD NAME   @YL026YB 71164100
         ST    R5,CTGFLDNM         STORE IN FIELD PARM. POINTER         71164400
         L     R4,CTGFIELD+D4      POINT TO 2ND FPL            @YL026YB 71164700
         MVI   CTGFLDNO,HEX01      NUMBER OF DATA ADDR.        @YL026YB 71165000
         LA    R5,DSCRDT           POINTER TO 2ND FIELD NAME   @YL026YB 71165300
         ST    R5,CTGFLDNM         STORE IN FIELD PARM. PTR.   @YL026YB 71165600
         L     R4,CTGFIELD+D8      POINT TO 3RD FPL            @YL026YB 71165900
         MVI   CTGFLDNO,HEX01      NUMBER OF DATA ADDR.        @YL026YB 71166200
         LA    R5,DSETEX           POINTER TO 3RD FIELD NAME   @YL026YB 71166500
         ST    R5,CTGFLDNM         STORE IN FIELD PARM.PTR     @YL026YB 71166800
         L     R1,CTGPLPTR         PUT CTGPL ADDR. IN REG 1    @YL026YB 71167100
         CATLG (1)                 VSAM LOCATE                 @YL026YB 71167400
         LTR   R15,R15             TEST RETURN CODE            @YL026YB 71167700
         BZ    NRMPROSS            GO TO NORMAL PROCESSING     @YL026YB 71168000
         ST    R15,OBTAINRC        SAVE LOCATE RETURN CODE     @YL026YB 71168300
         OI    OBTAINRC,HEXFF      INDICATE RETURN CODE IS FROM LOCATE  71168600
         OI    CNTRL,OBTSW         TURN ON OBTAIN SWITCH       @YL026YB 71168900
         B     HOSTEXIT            RETURN                      @YL026YB 71169200
NRMPROSS OI    CNTRL,WRITEMSK      TURN ON WRITE SWITCH        @YL026YB 71169500
         USING CTGFL,R4            ADDRRESSABILITY TO FPLS     @YL026YB 71169800
ENTCODE  LA    R5,OUTBUF           POINT AT ENTRY FIELD         ZA02196 71184802
         MVC   DSORGOF1(L4,R5),VSAMCON  MOVE IN CONSTANT        ZA02196 71185102
DSORGET1 L     R4,CTGFIELD+D4      SET TO CONVERT DATE         @VS07788 71186000
         L     R2,CTGFLPT          POINT TO CREATION DATE      @YL026YB 71186300
         LA    R7,OUTBUF           ADDRESS OF OUTPUT BUFFER    @YL026YB 71186600
         LA    R7,CRDTOFF(R7)      POINT AT BUFFER POSITION    @YL026YB 71186900
         BAL   R14,HDTO2           GO CONVERT DATE AND PUT IN BUFFER    71187200
         L     R4,CTGFIELD+D8      POINT TO 3RD FPL            @VS07788 71187500
         L     R2,CTGFLPT          SET UP TO CONVERT EXPIRATION DATE    71187800
         LA    R7,NXTBUF(R7)       POINT AT NEXT BUFFER POSITION        71188100
         BAL   R14,HDTO2           GO CONVERT DATE AND PUT IN BUFFER    71188400
HOSTEXIT LR    R1,R13              SAVE AREA ADDRESS FOR FREEMAIN       71188700
         L     R13,D4(R1)          CALLERS SAVEAREA            @YL026YB 71189000
         FREEMAIN R,LV=SAVELEN,A=(1),SP=SSP FREE SAVE AREA     @YL026YB 71189300
         RETURN (14,12)            RETURN                      @YL026YB 71189600
*********************************************************************** 71189900
*                                                                     * 71190200
*    THIS ROUTINE CONVERTS BINARY DATES OF THE FORM YYDDDD TO         * 71190500
*    CHARACTER FORMAT IN THE FORM MM/DD/YY.  LEAP YEARS ARE HANDLED.  * 71190800
*    INPUT REQUIREMENTS ARE-                                          * 71191100
*         1.   R2 POINTS TO FIELD TO BE CONVERTED                     * 71191400
*         2.   R7 POINTS TO RECEIVING FIELD                           * 71191700
*         3.   R14 HAS RETURN ADDRESS                                 * 71192000
*                                                                     * 71192300
*********************************************************************** 71192600
HDTO2    L     R1,D16(R4)                                      @VS07242 71192900
         LA    R1,D0(R1)                                                71193200
         LTR   R1,R1                                                    71193500
         BZ    HDTO3                                                    71193800
         CLC   D0(L3,R2),HITZ      CHECK FOR UNSPECIFIED DATE  @YL026YB 71194100
         BNE   HDTO4               BRANCH IF DATE PRESENT      @YL026YB 71194400
HDTO3    MVC   D0(L'HDTDF,R7),HITDF MOVE IN DEFAULT OF 00/00/00         71194700
         BR    R14                 RETURN                      @YL026YB 71195000
HDTO4    STM   R14,R6,HDTSV        SAVE REGISTERS              @YL026YB 71195300
*                                                              @YL026YB 71195600
*  TEST FOR LEAP YEAR BY ANDING THE YEAR FIELD AGAINST A BYTE WITH      71195900
*  THE TWO LOW ORDER BITS ON. LEAP YEARS WILL HAVE ZEROS FOR THE TWO    71196200
*  LOW ORDER BYTES.                                            @YL026YB 71196500
*                                                              @YL026YB 71196800
         SR    R3,R3               CLEAR REGISTER              @YL026YB 71197100
         IC    R3,D0(R2)           GET YEAR BYTE FROM DATE FIELD        71197400
         LA    R4,HITBIN3          SET UP TO TEST LOW ORDER BITS        71197700
         NR    R3,R4               ZERO, IF YEAR IS DIVISIBLE BY 4      71198000
         LA    R4,HITNY            SET UP FOR NON-LEAP YEAR    @YL026YB 71198300
         BNZ   HDTO6               NOT ZERO, NOT LEAP YEAR     @YL026YB 71198600
         LA    R4,HITLY            REMAINDER IS ZERO, USE LEAP YEAR     71198900
HDTO6    MVC   HDTWK(L2),D1(R2)    MOVE DAY FIELD TO HALFWORD FOR ALIGN 71199200
         LH    R3,HDTWK            DAY OF YEAR (0-365)         @YL026YB 71199500
         LA    R6,MNTHS            BRANCH CONTROL IS NUMBER OF MONTHS   71199800
*                                                              @YL026YB 71200100
*  SEARCH NOW BEGINS TO FIND THE MONTH IN WHICH THE DAY-OF-THE-YEAR     71200400
*  OCCURS. IF DAY-OF-THE-YEAR IS GREATER THAN 365/366, MONTH 12 IS USED 71200700
*                                                              @YL026YB 71201000
HDTO8    CH    R3,D0(R4)           COMPARE DAY TO TABLE ENTRY FOR MONTH 71201300
         BH    HIT10               DAY GREATER THAN TABLE IS A FIND     71201600
         LA    R4,D2(R4)           POINT TO NEXT ELEMENT       @YL026YB 71201900
         BCT   R6,HDTO8            DECREMENT MONTH AND RETRY   @YL026YB 71202200
         B     HDTO3               USE DEFAULT 00/00/00        @YL026YB 71202500
HIT10    SH    R3,D0(R4)           SUBTRACT TABLE ELEMENT FROM DAY      71202800
         EX    R3,HITCLI           COMPARE DAY TO 31           @YL026YB 71203100
         BNL   HIT12               OKAY, GO TO MONTHS          @YL026YB 71203400
         LA    R3,DYS311           DEFAULT TO 31 DAYS          @YL026YB 71203700
HIT12    CVD   R6,HDTWK            CONVERT MONTH TO DECIMAL    @YL026YB 71204000
         UNPK  D0(L2,R7),HD6(D2)   -THEN TO CHARACTER          @YL026YB 71204300
         CVD   R3,HDTWK            CONVERT DAY TO DECIMAL      @YL026YB 71204600
         UNPK  D3(L2,R7),HD6(D2)   -THEN TO CHARACTER          @YL026YB 71204900
         IC    R6,D0(R2)           GET YEAR                    @YL026YB 71205200
         CVD   R6,HDTWK            CONVERT IT TO DECIMAL       @YL026YB 71205500
         UNPK  D6(L2,R7),HD6(D2)   -THEN TO CHARACTER          @YL026YB 71205800
         MVZ   D1(L7,R7),D0(R7)    PROPAGATE NUMERIC ZONE      @YL026YB 71206100
         MVI   D2(R7),SLASH        MOVE IN SEPARATORS BETWEEN  @YL026YB 71206400
         MVI   D5(R7),SLASH        -MONTH, DAY, AND YEAR       @YL026YB 71206700
         LM    R14,R6,HDTSV        RESTORE REGISTERS           @YL026YB 71207000
         BR    R14                 RETURN                      @YL026YB 71207300
*                                                              @YL026YB 71207600
*  THE FOLLOWING EQUATES AND CONSTANTS ARE USED BY THE HISTORY ROUTINE. 71207900
*                                                              @YL026YB 71208200
DSORGOF1 EQU   2                   OFFSET TO DSORG FIELD IN OUTPUT      71208500
VSAMCON  DC    C'VSAM'             DSORG CONSTANT FOR VSAM      ZA02196 71208802
DYS311   EQU   31                  USED FOR THIRTY ONE COMPARE @YL026YB 71217500
HITBIN3  EQU   X'03'               BYTE WITH TWO LOW ORDER BITS ON      71217800
HITCLI   CLI   HITC31,D0           CHECKS IF DATE GREATER THAN 31       71218400
HITZ     DC    X'000000'           DATE IS NOT SPECIFIED       @YL026YB 71218700
HITDF    DC    C'00/00/00'         DISPLAYED DATE OF ZERO      @YL026YB 71219000
HITC31   DC    FL1'31'             USED FOR 31 DAY COMPARISON  @YL026YB 71219300
ENNTYPE  DC    C'ENTYPE  '         ENTRY TYPE                  @YL026YB 71219600
DSCRDT   DC    C'DSETCRDT'         CREATION DATA               @YL026YB 71219900
DSETEX   DC    C'DSETEXDT'         EXPIRATION DATE             @YL026YB 71220200
         DS    0H                  HALF WORD BNDRY             @YL026YB 71220500
WKLGTH   DC    H'100'              LENGTH OF CPPL WORKAREA     @YL026YB 71220800
*  THIS IS THE MONTH TABLE LOOKUP INDEX FOR NON LEAP-YEARS     @YL026YB 71221100
HITNY    DC    H'334'              DECEMBER                    @YL026YB 71221400
         DC    H'304'              NOVEMBER                    @YL026YB 71221700
         DC    H'273'              OCTOBER                     @YL026YB 71222000
         DC    H'243'              SEPTEMBER                   @YL026YB 71222300
         DC    H'212'              AUGUST                      @YL026YB 71222600
         DC    H'181'              JULY                        @YL026YB 71222900
         DC    H'151'              JUNE                        @YL026YB 71223200
         DC    H'120'              MAY                         @YL026YB 71223500
         DC    H'90'               APRIL                       @YL026YB 71223800
         DC    H'59'               MARCH                       @YL026YB 71224100
         DC    H'31'               FEBRUARY                    @YL026YB 71224400
         DC    H'0'                JANUARY                     @YL026YB 71224700
*  THIS IS THE MONTH TABLE LOOKUP INDEX FOR LEAP YEARS         @YL026YB 71225000
HITLY    DC    H'335'              DECEMBER                    @YL026YB 71225300
         DC    H'305'              NOVEMBER                    @YL026YB 71225600
         DC    H'274'              OCTOBER                     @YL026YB 71225900
         DC    H'244'              SEPTEMBER                   @YL026YB 71226200
         DC    H'213'              AUGUST                      @YL026YB 71226500
         DC    H'182'              JULY                        @YL026YB 71226800
         DC    H'152'              JUNE                        @YL026YB 71227100
         DC    H'121'              MAY                         @YL026YB 71227400
         DC    H'91'               APRIL                       @YL026YB 71227700
         DC    H'60'               MARCH                       @YL026YB 71228000
         DC    H'31'               FEBRUARY                    @YL026YB 71228300
         DC    H'0'                JANUARY                     @YL026YB 71228600
         EJECT                                                 @YL026YB 71228900
IKJEHMMR CSECT                                                          71250020
*********************************************************************** 71300020
*                                                                     * 71350020
*    THIS ROUTINE GETS CONTROL IF THE MEMBERS KEYWORD IS SPECIFIED    * 71400020
*    WITH THE COMMAND AND DOES THE FOLLOWING-                         * 71450020
*         1. CHECKS WHETHER DATA SET IS PARTITIONED (DSORG IN DSCB)   * 71550020
*         2. CHECKS WHETHER DATA SET HAS THIS USERS USERID AS FIRST   * 71600020
*            QUALIFIER IN DSNAME                                      * 71650020
*         3. CHECKS FOR BLANK DDNAME (EXIT IF YES--CONCATENATED)      * 71700020
*         4. CHECKS DYNAMIC CONCATENATION BIT IN DSE--IF ON, THE      * 71750020
*            DSADDNAM IS COMPARED TO THE DCBDDNAM. IF THEY ARE THE    * 71800000
*            SAME, THEN THIS IS AT LEAST THE SECOND MEMBER OF A       * 71850020
*            CONCATENATION CLUSTER AND AN EXIT IS TAKEN.              * 71900020
*                                                                     * 71950020
*    IF ALL CONDITIONS ARE MET, A RDJFCB IS ISSUED AND IKJEHMEM IS    * 72000020
*    CALLED TO LIST THE DIRECTORY. IF HISTORY WAS SPECIFIED AS A      * 72050020
*    KEYWORD, THE JFCB HAS ALREADY BEEN READ.                         * 72100020
*                                                                     * 72150020
*********************************************************************** 72200020
MEMROUT  SAVE  (14,12),,*          SAVE REGISTERS                       72250020
         LR    R11,R15             ENTRY POINT ADDRESS                  72300020
         LR    R10,R13             WORKAREA ADDRESS                     72350020
         USING INITCORE,R10        ADDRESSABILITY FOR WORKAREA          72400020
         USING OBTWAD,R12          ADDRESSABILITY FOR OBTAIN WORK AREA  72450020
         USING MEMROUT,R11         ADDRESSABILITY FOR ROUTINE           72500020
         GETMAIN R,LV=SAVELEN,SP=SSP GET NEW SAVE AREA                  72550020
         ST    R13,BACKWARD(R1)    CHAIN SAVE AREAS BACKWARD            72600020
         ST    R1,FORWARD(R13)     -AND FORWARD                         72650020
         LR    R13,R1              NEW SAVE AREA                        72700020
         TM    DS1DSORG,PO         IS DSORG PO                          72750020
         BNO   MEMEXIT             NO, EXIT FROM ROUTINE                72800020
*  COMPARE USERID AGAINST HIGHEST LEVEL QUALIFIER                       72900020
         L     R2,UPTPTR           POINT TO UPT                @YL026YB 73000000
         USING UPT,R2              ADDRESSABILITY UPT          @YL026YB 73030000
         XR    R1,R1               CLEAR REGISTER                       73060000
         IC    R1,UPTPREFL         LENGTH OF USERID            @YL026YB 73090000
         LTR   R1,R1               SEE IF USERID IS ZERO       @YL026YB 73120000
         BZ    NOPREFIX            YES,NO USERID OR PREFIX     @YL026YB 73150000
         LA    R3,DSADSNAM         ADDRESS OF DSNAME IN DSAB   @YL026YB 73180000
         LA    R3,D0(R3,R1)        ADD USERID LENGTH TO DSNAME          73250020
         CLI   D0(R3),PERIOD       CHECK FOR A PERIOD                   73300020
         BNE   MEMEXIT             NOT EQUAL, GO EXIT THIS ROUTINE      73350020
         BCTR  R1,R0               DECREMENT LENGTH FOR EXECUTE         73400020
         EX    R1,USRIDCOM         COMPARE USERID TO FIRST QUALIFIER    73450020
         BNE   MEMEXIT             NOT EQUAL, GO EXIT THIS ROUTINE      73500020
NOPREFIX CLI   DSADDNAM,BLANK      IS DDNAME BLANK             @YL026YB 73550000
         BE    MEMEXIT             YES, GO EXIT                         73600020
         LA    R2,OBTDCB           ADDRESS OF DCB                A42338 73610021
         USING IHADCB,R2           ADDRESSABILITY DCB            A42338 73620021
         TM    DSACNTRL,DYNCON     CHECK DYNAMIC CONCATENATION BIT      73650000
         BNO   MEMRT01             OFF, GO PROCESS                      73730000
         CLC   DCBDDNAM(DDNAMLEN),DSADDNAM COMPARE DDNAMES IN DSE, DCB  73810000
         BE    MEMEXIT             EQUAL, GO EXIT--CANNOT LIST MEMBERS  73900020
MEMRT01  TM    CNTRL,HISTMSK       WAS HISTORY SPECIFIED                74050020
         BO    MEMRT02             YES, SKIP RDJFCB                     74100020
         MVC   DCBDDNAM(DDNAMLEN),DSADDNAM MOVE DDNAME TO DCB  @YL026YB 74250000
         LA    R1,RDJL             ADDRESS OF RDJFCB LIST FORM          74300020
         RDJFCB ((R2)),MF=(E,(R1)) ISSUE READ JFCB                      74350020
         DROP  R2                  DCB NO LONGER NEEDED                 74400020
MEMRT02  L     R15,MEMMOD          ADDRESS OF IKJEHMEM (MEMBERS MODULE) 74500020
         LA    R1,CALLIST          PARAMETER LIST FOR CALL MACRO        74550020
         L     R3,VCONWRTE         ADDRESS OF WRITE ROUTINE             74600020
*  GO TO MEMBERS ROUTINE (IKJEHMEM)                                     74650020
         CALL  (15),((R12),GETML,OUTBUF,(R3),FREEML),VL,MF=(E,(1))      74700020
         B     MEMCODE(R15)        ANALYZE IKJEHMEM RETURN CODE         74800020
MEMCODE  B     MEMEXIT             SUCCESS                              74850020
         B     MEMCDE04            INSUFFICIENT CORE                    74900020
         B     MEMCDE08            I/O ERROR                            74950020
         B     MEMCDE12            DIRECTORY ERROR                      75000020
MEMCDE04 LA    R1,SECMSG06         SECOND LEVEL MESSAGE 6               75150020
         B     MEMERROR            GO PROCESS MESSAGE                   75200020
MEMCDE08 LA    R1,SECMSG08         SECOND LEVEL MESSAGE 8               75300020
         LA    R2,SYNMSG           ADDRESS OF INSERT                    75350020
         ST    R2,ERRINST2         -TO PARM LIST                        75400020
         B     MEMSYN              GO PROCESS MESSAGE                   75450020
MEMCDE12 LA    R1,SECMSG07         SECOND LEVEL MESSAGE 7               75550020
MEMERROR XC    ERRINST2,ERRINST2   NO SECOND LEVEL INSERTION            75700020
MEMSYN   XC    ERRINST1,ERRINST1   NO FIRST LEVEL INSERTION             75750020
         STH   R1,ERRSECND         SECOND LEVEL MESSAGE CODE            75800020
         LA    R1,MSG04            MESSAGE 4                            75850020
         STH   R1,ERRFIRST         FIRST LEVEL MESSAGE CODE             75900020
         LR    R1,R13              ADDRESS OF AREA TO FREE              75950020
         LR    R13,R10             CALLERS SAVEAREA                     76000020
         L     R2,VCONERRT         ERROUT ADDRESS                       76050020
         L     R3,RETREGOF(R13)    CALLERS RETURN ADDRESS               76100020
         ST    R2,RETREGOF(R13)    MAKE RETURN TO ERROR HANDLER         76150020
         ST    R3,BALREGOF(R13)    FROM ERROR HANDLER TO CALLER         76200020
         B     MEMEXIT1            GO FREE CORE AND RETURN       A42338 76250021
MEMEXIT  LR    R1,R13              SAVE AREA ADDRESS TO BE FREED        76450020
         LR    R13,R10             CALLERS SAVEAREA                     76500020
MEMEXIT1 FREEMAIN R,LV=SAVELEN,A=(1),SP=SSP FREE SAVE AREA       A42338 76550021
         RETURN (14,12)            RETURN                               76600020
*                                                                       76610020
*  CONSTANTS USED BY THE MEMBERS ROUTINE                         A42338 76620021
*                                                                       76630020
         USING UPT,R2              ADDRESSABILITY PSCB         @YL026YB 76650000
USRIDCOM CLC   UPTPREFX(L1),DSADSNAM COMPARE TO BE EXECUTED    @YL026YB 76700000
         DROP  R2                  PSCB NO LONGER NEEDED                76750020
VCONERRT DC    V(IKJEHERR)         ADDRESS OF ERROR ROUTINE             76800020
VCONWRTE DC    V(IKJEHWRT)         ADDRESS OF WRITE ROUTINE             76850020
         EJECT                                                          76950020
IKJEHSTS CSECT                                                          77050020
*********************************************************************** 77100020
*                                                                     * 77150020
*    THIS ROUTINE GETS CONTROL IF THE STATUS KEYWORD IS SPECIFIED ON  * 77200020
*    THE COMMAND. IT EXTRACTS THE DDNAME AND NORMAL AND ABNORMAL      * 77250020
*    DISPOSITION FROM THE DSE BLOCK CURRENTLY BEING PROCESSD. THE     * 77300020
*    DDNAME MAY BE BLANKS IF THE DATA SET WAS CONCATENATED IN THE     * 77350020
*    LOGON PROCEDURE.  SOME DDNAMES MAY BE DUPLICATED IN THE LISTING. * 77400020
*    THESE DATA SETS WILL ALL BE MEMBERS OF THE SAME CONCATENATION    * 77450020
*    CLUSTER (DYNAMIC CONCATENATION).  THE POSSIBLE DISPOSITIONS      * 77500020
*    INCLUDE ALL THOSE CURRENTLY SUPPORTED IN OS.                     * 77550020
*                                                                     * 77600020
*********************************************************************** 77650020
STATROUT SAVE  (14,12),,*          SAVE REGISTERS                       77700020
         LR    R11,R15             ENTRY POINT ADDRESS                  77750020
         LR    R10,R13             WORKAREA ADDRESS                     77800020
         USING INITCORE,R10        ADDRESSABILITY WORK AREA             77850020
         USING OBTWAD,R12          ADDRESSABILITY OBTAIN WORK AREA      77900020
         USING STATROUT,R11        ADDRESSABILITY FOR THIS ROUTINE      77950020
         GETMAIN R,LV=SAVELEN,SP=SSP GET SAVE AREA                      78000020
         ST    R13,BACKWARD(R1)    CHAIN SAVE AREAS BACKWARD            78050020
         ST    R1,FORWARD(R13)     -AND FORWARD                         78100020
         LR    R13,R1              NEW SAVE AREA                        78150020
         LA    R7,OUTBUF+STATOFF1  POINT AT OFFSET FOR STATUS ALONE     78200020
         TM    CNTRL,HISTMSK       WAS HISTORY SPECIFIED                78250020
         BNO   STATRT01            NO, USE AS IS                        78300020
         LA    R7,OUTBUF+STATOFF2  YES, POINT TO NEW OFFSET             78350020
STATRT01 MVC   D0(DDNAMLEN,R7),DSADDNAM MOVE DDNAME TO BUFFER  @YL026YB 78450000
         LA    R7,DDNAMLEN+D1(R7)  UPDATE BUFFER POINTER        SA49892 78490000
* TEST STATUS BITS AND MOVE IN APPROPRIATE WORD                         78530000
         TM    DSANDISP,KEEP       IS DISPOSITION KEEP         @YL026YB 78570000
         BO    STATKEEP            YES, BRANCH                          78610000
         TM    DSANDISP,DELETE     IS DISPOSITION DELETE       @YL026YB 78650000
         BO    STATDELE            YES, BRANCH                          78690000
         TM    DSANDISP,CATLG      IS DISPOSITION CATALOG      @YL026YB 78730000
         BO    STATCATL            YES, BRANCH                          78770000
         TM    DSANDISP,UNCATLG    IS DISPOSITION UNCATALOG    @YL026YB 78810000
         BO    STATUNCT            YES, BRANCH                          78850000
         TM    DSANDISP,PASS       IS DISPOSITION PASS         @YL026YB 78890000
         BO    STATPASS            YES,BRANCH                  @YL026YB 78930000
         B     STATRT03            IF UNSPECIFIED, SKIP TO NEXT         79050020
STATKEEP LA    R14,SKEEP           DISPOSITION OF 'KEEP'                79100020
         LA    R15,L'SKEEP         ITS LENGTH                           79150020
         B     STATRT02            PUT IT IN BUFFER                     79200020
STATDELE LA    R14,SDELE           DISPOSITION OF 'DELETE'              79300020
         LA    R15,L'SDELE         ITS LENGTH                           79350020
         B     STATRT02            PUT IT IN BUFFER                     79400020
STATCATL LA    R14,SCATL           DISPOSITION OF 'CATLG'               79500020
         LA    R15,L'SCATL         ITS LENGTH                           79550020
         B     STATRT02            PUT IT IN BUFFER                     79600020
STATUNCT LA    R14,SUNCT           DISPOSITION OF 'UNCATLG'             79700020
         LA    R15,L'SUNCT         ITS LENGTH                           79750020
         B     STATRT02            PUT IT IN BUFFER            @YL026YB 79770000
STATPASS LA    R14,SPASS           DISP. OF 'PASS'             @YL026YB 79790000
         LA    R15,L'SPASS         ITS LENGTH                  @YL026YB 79810000
* MOVE THE CORRECT FIELD TO THE BUFFER                                  79850020
STATRT02 BCTR  R15,R0              DECREMENT COUNT FOR EXECUTE  SA49892 80050021
         EX    R15,DISPMOVE        MOVE DISPOSITION TO BUFFER           80100020
         LA    R7,D1(R15,R7)       POINT AT NEXT LOCATION               80150020
* TEST FOR ABNORMAL DISPOSITION                                         80250020
STATRT03 TM    DSACDISP,KEEP       IS DISPOSITION KEEP         @YL026YB 80400000
         BO    STKEEP              YES, BRANCH                          80440000
         TM    DSACDISP,DELETE     IS DISPOSITION DELETE       @YL026YB 80480000
         BO    STDELE              YES, BRANCH                          80520000
         TM    DSACDISP,CATLG      IS DISPOSITION CATALOG      @YL026YB 80560000
         BO    STCATL              YES, BRANCH                          80600000
         TM    DSACDISP,UNCATLG    IS DISPOSITION UNCATALOG    @YL026YB 80640000
         BO    STUNCT              YES, BRANCH                          80680000
         TM    DSACDISP,PASS       IS DISP. PASS               @YL026YB 80720000
         BO    STPASS              YES,BRANCH                  @YL026YB 80760000
         B     STATRT05            IF UNSPECIFIED, SKIP IT              80800020
STKEEP   LA    R14,SKEEP           DISPOSITION OF 'KEEP'                80900020
         LA    R15,L'SKEEP         ITS LENGTH                           80950020
         B     STATRT04            PUT IT INTO THE BUFFER               81000020
STDELE   LA    R14,SDELE           DISPOSITION OF 'DELETE'              81100020
         LA    R15,L'SDELE         ITS LENGTH                           81150020
         B     STATRT04            PUT IT INTO BUFFER                   81200020
STCATL   LA    R14,SCATL           DISPOSITION OF 'CATLG'               81300020
         LA    R15,L'SCATL         ITS LENGTH                           81350020
         B     STATRT04            PUT IT INTO BUFFER                   81400020
STUNCT   LA    R14,SUNCT           DISPOSITION OF 'UNCATLG'             81500020
         LA    R15,L'SUNCT         ITS LENGTH                           81550020
         B     STATRT04            PUT IT INTO BUFFER          @YL026YB 81570000
STPASS   LA    R14,SPASS           DISP OF 'PASS'              @YL026YB 81590000
         LA    R15,L'SPASS         ITS LENGTH                  @YL026YB 81610000
* MOVE THE CORRECT FIELD TO THE BUFFER                                  81650020
STATRT04 MVI   D0(R7),COMMA         PUT A COMMA SEPARATOR IN BUFFER     81800020
         LA    R7,D1(R7)            BUMP POINTER                        81850020
         BCTR  R15,R0               DECREMENT LENGTH FOR EXECUTE        81900020
         EX    R15,DISPMOVE         MOVE DISPOSITION TO BUFFER          81950020
STATRT05 OI    CNTRL,WRITEMSK       TURN ON WRITE SWITCH                82100020
         LR    R1,R13               ADDRESS OF SAVE AREA TO BE FREED    82150020
         LR    R13,R10              USERS SAVEAREA                      82200020
         FREEMAIN R,LV=SAVELEN,A=(1),SP=SSP FREE SAVE AREA              82250020
         RETURN (14,12)             RETURN                              82300020
*                                                                       82350020
*     EQUATES AND CONSTANTS USED BY THE STATUS ROUTINE                  82400020
*                                                                       82450020
DISPMOVE MVC   D0(D0,R7),D0(R14)    EXECUTED TO MOVE DISPOSITION        82460020
KEEP     EQU   X'08'                DSAB DISPOSITION KEEP      @YL026YB 82500000
DELETE   EQU   X'04'                DSAB  DISPOSITION DELETE   @YL026YB 82540000
CATLG    EQU   X'02'                DSAB  DISPOSITION CATALOG  @YL026YB 82580000
UNCATLG  EQU   X'01'                DSAB  DISPOSITION UNCATALOG         82620000
PASS     EQU   X'10'                DSAB DISP. PASS            @YL026YB 82660000
SKEEP    DC    C'KEEP'              KEEP                                82700020
SDELE    DC    C'DELETE'            DELETE                              82750020
SCATL    DC    C'CATLG'             CATALOG                             82800020
SUNCT    DC    C'UNCATLG'           UNCATALOG                           82850020
SPASS    DC    C'pass'              PASS                       @YL026YB 82920000
         EJECT                                                          83000020
INITCORE DSECT                                                          83050020
SAVEAREA DS    28F                  SAVEAREA AND LOCAL SAVEAREA         83100020
NULLCNT  DS    D                    KEEPS COUNT OF DYNAMS               83110020
DSAV     DS    F                    ADDR. OF DDNAME BUFFER     @YL026YB 83120000
OBTAINRC DS    F                    HOLDS OBTAIN RETURN CODE            83130020
CTLA     EQU   *                    BEGIN CONTROL WORD AND SW AREA      83150020
MEMMOD   DS    A                    ADDRESS OF MEMBERS MODULE           83200020
OBTWA    DS    A                    ADDRESS OF CORE FOR OBTAIN WORKAREA 83250020
RETCD    DS    F                    HOLDS RETURN CODE                   83300020
PARDSECT DS    F                    ADDRESS OF PARSE DSECT              83400020
CNTRL    DS    XL1                  SWITCH FOR COMMAND SCAN RESULTS     83410020
CTLL     EQU   *-CTLA               LENGTH CONTROL WORD AND SWITCH AREA 83500020
DDCNT    DS    H                    COUNT OF DDNAMES IN BUFFER @YL026YB 83660000
ZERO1    DC    X'0000'              ZEROS FOR COMPARES         @YL026YB 83700000
LOCSW    DC    X'00'                SWITCH USED FOR LOCATE ISSUED       83750020
         EJECT                                                          83800020
*********************************************************************** 83850020
*                                                                     * 83900020
*    THE  FOLLOWING 3 WORDS ARE USED TO PASS PARAMETERS TO THE        * 83950020
*    ERROR HANDLING ROUTINE. THE FIRST TWO BYTES CONTAIN THE RELATIVE * 84000020
*    POSITION OF THE MESSAGE IN THE MESSAGE CSECT. THE NEXT TWO BYTES * 84050020
*    CONTAIN THE NUMBER THAT INDICATES WHICH SECOND LEVEL MESSAGE     * 84100020
*    IS TO BE SELECTED. THE SECOND WORD POINTS TO A FIELD CONTAINING  * 84150020
*    A ONE BYTE LENGTH FIELD FOLLOWED BY DATA TO BE INSERTED IN THE   * 84200020
*    FIRST MESSAGE. THE LAST WORD CONTAINS A SIMILAR POINTER FOR THE  * 84250020
*    SECOND MESSAGE.                                                  * 84300020
*                                                                     * 84350020
*********************************************************************** 84400020
ERRPARM  DS    0F                  PARAMETER LIST FOR ERROR HANDLER     84450020
ERRFIRST DS    H                   RELATIVE FIRST LEVEL MESSAGE NUMBER  84500020
ERRSECND DS    H                   RELATIVE SECOND LEVEL MESSAGE NUMBER 84550020
ERRINST1 DS    F                   INSERT DATA FOR FIRST LEVEL MESSAGE  84600020
ERRINST2 DS    F                   INSERT DATA FOR SECOND LEVEL MESSAGE 84650020
         DS    0D                  DOUBLE WORD ALIGN                    84700020
ERRINSRT DS    CL70                INSERT DATA BUFFER                   84750020
*********************************************************************** 84900020
*                                                                     * 84950020
*        THE FOLLOWING CONSTANTS, BUFFER AND PUTLINE MACRO MUST ALL   * 85000020
*        APPEAR TOGETHER IN THE SPECIFIED ORDER SO THAT THE WRITE     * 85050020
*        ROUTINE WILL REMAIN INDEPENDANT OF A BASE REGISTER.          * 85100020
*                                                                     * 85150020
*********************************************************************** 85200020
PARMLSTS DS    0F                  ALIGN PARAMETER LIST                 85250020
PUTLCON  DS    F                   LIST FOR PUTLINE MACRO               85300020
DPUTLCON DS    F                   PUTLINE LIST FORM                    85350020
UPTPTR   DS    F                   UPT POINTER                          85400020
ECTPTR   DS    F                   ECT POINTER                          85450020
ECBPTR   DS    F                   CPS ECB POINTER                      85500020
PUTLADDR DS    F                   ENTRY POINT OF PUTLINE               85550020
PARMLSTL EQU   *-PARMLSTS          LENGTH OF PARAMETER LIST             85600020
         DS    F                   LENGTH AND OFFSET FIELDS             85700020
OUTBUF   DS    CL120               OUTPUT BUFFER FOR PUTLINE            85750020
DPUTLINE PUTLINE MF=L              PUTLINE LIST FORM                    85800020
*                                                                       85900020
* SERVICE ROUTINE PARAMETER LIST AREA                                   85950020
*                                                                       86000020
PUTLLIST DS    7F                  COMMON PARAMETER AREA                86200020
* END OF SERVICE ROUTINE PARAMETER LIST AREA                            86600020
CPECB    DS    F                   CPS ECB                              86650020
PSCBPTR  DS    F                   PSCB POINTER                         86700020
GETML    GETMAIN  EC,MF=L          LIST FORM OF GETMAIN                 86850020
FREEML   FREEMAIN  E,MF=L          LIST FORM OF FREEMAIN                86900020
LOCLIST  DS    4F                  LOCATE CAMLST                        87000020
MSGPARM1 DS    3F                  FIRST LEVEL MESSAGE PARAMETERS       87100020
MSGPARM2 DS    3F                  SECOND LEVEL MESSAGE PARAMETERS      87150020
SECBUFF  DS    30F                 SECOND BUFFER FOR ERROR HANDLER      87200020
STACKPRM DS    2F                  SPACE FOR STACK PARAMETER BLOCK      87250020
SYSNM    DS    C'SYS00000.T000000.' MASK TO TEST FOR SYSNAMES           87300020
STACKSW  DS    CL1                 INDICATE FLUSH STACK AND CLEAR QUEUE 87310020
         DS    0D                  ALIGN LOCATE WORKAREA          M0883 87310421
LOCAREA  DS    CL265               WORK AREA FOR LOCATE MACRO           87312020
DYNAMSAV DS    CL265               BUFFER FOR DDNAMES          @YL026YB 87312800
DYNAMSW  DS    CL1                 INDICATOR FOR RE-USE        @YL026YB 87313600
WKAREA   DS    CL100               WORKAREA FOR CPL            @YL026YB 87314400
NOTUSED  DS    CL1                 INDICATOR FOR NOT IN-USE    @YL026YB 87315200
ASKSWTCH DS    CL1                 SWITCH TO WRITE AS NOT-INUSE         87316000
*                                                              @YL026YB 87316800
*                                                              @YL026YB 87317600
         DS    0F                  ALINE POINTER               @YL026YB 87318400
CTGPLPTR DS    F                   POINTER TO CPL AREA         @YL026YB 87319200
CTGFLPTR DS    F                   POINTER TO FPL AREA         @YL026YB 87320000
LOCPTN   DS    0F                  CPL CONSTANTS               @YL026YB 87320800
         DS    CL40                POINTER TO ENTRY NAME       @YL026YB 87321600
*                                                              @YL026YB 87322400
*                                                              @YL026YB 87323200
FLDREQ1  DS    CL24                FPL CONSTANTS               @YL026YB 87324000
FLDREQ2  DS    CL24                FPL CONSTANTS               @YL026YB 87324800
FLDREQ3  DS    CL24                FPL CONSTANTS               @YL026YB 87325600
*                                                              @YL026YB 87326400
*                                                              @YL026YB 87327200
*                                                              @YL026YB 87328000
*                                                              @YL026YB 87328800
         DS    0H                                              @YL026YB 87329600
REQNUM   DS    CL2                 RELATIVE REQUEST NUMBER     @YL026YB 87330400
DSADSLNG DS    CL2                 DSNAME LENGTH               @YL026YB 87331200
DSADSNAM DS    CL44                                            @YL026YB 87332000
DYNAMCNT DS    CL2                                             @YL026YB 87332800
DSACNTRL DS    CL1                                             @YL026YB 87333600
LSTENTRY DS    CL1                                             @YL026YB 87334400
DSTYPE   DS    CL1                                             @YL026YB 87335200
         DS    0H                                              @YL026YB 87336000
DMEMLNT  DS    CL2                                             @YL026YB 87336800
DSAMEM   DS    CL8                                             @YL026YB 87337600
DSADDNAM DS    CL8                                             @YL026YB 87338400
DSASTAT  DS    CL1                                             @YL026YB 87339200
DSANDISP DS    CL1                                             @YL026YB 87340000
DSACDISP DS    CL1                                             @YL026YB 87340800
*        WORK AREA FOR ALLOCATION                              @YL026YB 87341600
DAPARM   DS    F                   POINTER TO REQUEST BLK      @YL026YB 87342400
DARQBLK  DS    0CL20               DYNAMIC ALLOC REQUEST BLK   @YL026YB 87343200
DABLKLN  DS    CL1                 LENGTH OF BLK               @YL026YB 87344000
DAVERB   DS    CL1                 VERB CODE                   @YL026YB 87344800
DAFLGS1  DS    CL2                 FLAGS                       @YL026YB 87345600
DAERRCD  DS    CL2                 ERROR RETURN CODE           @YL026YB 87346400
DAINFO   DS    CL2                 INFORMATION RETURN CD       @YL026YB 87347200
DATXTPT  DS    CL4                 ADDRESS OF TEXT POINTERS    @YL026YB 87348000
         DS    CL4                 RESERVED                    @YL026YB 87348800
DAFLGS2  DS    CL4                 FLAGS                       @YL026YB 87349600
DARLNTH  EQU   *-DARQBLK                                       @YL026YB 87350400
*        TEXT POINTER                                          @YL026YB 87351200
DAPTR    DS    11F                                             @YL026YB 87352000
*        *     TEXT UNIT FOR DYNAMIC INFORMATION RETRIEVAL     @YL026YB 87352800
DAREQ    DS    0CL8                                            @YL026YB 87353600
         DS    CL2                 KEY                         @YL026YB 87354400
         DS    CL2                 NUMBER                      @YL026YB 87355200
         DS    CL2                 LENGTH                      @YL026YB 87356000
         DS    CL2                 RELATIVE REQUEST NO.        @YL026YB 87356800
DADSNM   DS    0CL50               DSNAME TEXT UNIT            @YL026YB 87357600
         DS    CL2                 KEY                         @YL026YB 87358400
         DS    CL2                 NUMBER                      @YL026YB 87359200
         DS    CL2                 LENGTH                      @YL026YB 87360000
         DS    CL44                DATA SET NAME               @YL026YB 87360800
DALIMIT  DS    0CL8                LIMIT TETX UNIT             @YL026YB 87361600
         DS    CL2                 KEY                         @YL026YB 87362400
         DS    CL2                 NUMBER                      @YL026YB 87363200
         DS    CL2                 LENGHT                      @YL026YB 87364000
         DS    CL2                 LIMIT                       @YL026YB 87364800
DATTR    DS    0CL7                ATTRIBUTE TEXT UNIT         @YL026YB 87365600
         DS    CL2                 KEY                         @YL026YB 87366400
         DS    CL2                 NUMBER                      @YL026YB 87367200
         DS    CL2                 LENGTH                      @YL026YB 87368000
         DS    CL1                 ATTRIBUTE                   @YL026YB 87368800
DALENTRY DS    0CL7                LAST ENTRY TEXT UNIT        @YL026YB 87369600
         DS    CL2                 KEY                         @YL026YB 87370400
         DS    CL2                 NUMBER                      @YL026YB 87371200
         DS    CL2                 LENGTH                      @YL026YB 87372000
         DS    CL1                 LAST ENTRY CODE             @YL026YB 87372800
DADSTYPE DS    0CL7                DATA SET TYPE TXT UNIT      @YL026YB 87373600
         DS    CL2                 KEY                         @YL026YB 87374400
         DS    CL2                 NUMBER                      @YL026YB 87375200
         DS    CL2                 LENGTH                      @YL026YB 87376000
         DS    CL1                 DATA SET TYPE               @YL026YB 87376800
         DS    0H                                              @YL026YB 87377600
DAMEM    DS    0CL14               MEMBER TEXT UNIT            @YL026YB 87378400
         DS    CL2                 KEY                         @YL026YB 87379200
         DS    CL2                 NUMBER                      @YL026YB 87380000
         DS    CL2                 LENGTH                      @YL026YB 87380800
         DS    CL8                 MEMBER NAME                 @YL026YB 87381600
DADDNM   DS    0CL14               DDNAME TEXT UNIT            @YL026YB 87382400
         DS    CL2                 KEY                         @YL026YB 87383200
         DS    CL2                 NUMBER                      @YL026YB 87384000
         DS    CL2                 LENGTH                      @YL026YB 87384800
         DS    CL8                 DDNAME                      @YL026YB 87385600
DASTAT   DS    0CL7                STATUS TEXT UNIT            @YL026YB 87386400
         DS    CL2                 KEY                         @YL026YB 87387200
         DS    CL2                 NUMBER                      @YL026YB 87388000
         DS    CL2                 LENGTH                      @YL026YB 87388800
         DS    CL1                 STATUS                      @YL026YB 87389600
DANDISP  DS    0CL7                NORMAL DISP. TEXT UNIT      @YL026YB 87390400
         DS    CL2                 KEY                         @YL026YB 87391200
         DS    CL2                 NUMBER                      @YL026YB 87392000
         DS    CL2                 LENGTH                      @YL026YB 87392800
         DS    CL1                 NORMAL DISPOSITION          @YL026YB 87393600
DACDISP  DS    0CL7                CONDITIONAL DISP. TXT UNIT  @YL026YB 87394400
         DS    CL2                 KEY                         @YL026YB 87395200
         DS    CL2                 NUMBER                      @YL026YB 87396000
         DS    CL2                 LENGTH                      @YL026YB 87396800
         DS    CL1                 CONDITIONAL DISPOSITION     @YL026YB 87397600
INITSIZE EQU   *-SAVEAREA          LENGTH OF DSECT                      87400020
         EJECT                                                          87450020
         IKJEHCOM                                                       87500020
         DCBD  DSORG=PS                                                 87550020
         EJECT                                                          87600020
         CVT                                                            87650020
         EJECT                                                          87700020
         IKJTCB                                                         87750020
         SPACE 3                                                        87800000
         IEFZB4D0                                              @YL026YB 87850000
         EJECT                                                          87900000
         IEZCTGPL                                              @YL026YB 87950000
         EJECT                                                 @YL026YB 88000000
         IEZCTGFL                                              @YL026YB 88050000
         EJECT                                                 @YL026YB 88100000
         IKJUPT                                                @YL026YB 88150000
         EJECT                                                 @YL026YB 88200000
         IKJPSCB                                                        88250000
         EJECT                                                          88300000
         IKJIOPL                                               @YL026YB 88350000
         EJECT                                                 @YL026YB 88400000
         IKJCPPL                                                        88550020
         SPACE 2                                                        88600020
         IKJPPL                                                         88700020
         SPACE 2                                                        88710020
         IKJDAPL                                                        88750020
         EJECT                                                          88800020
IKJEHALM CSECT                                                          88850020
*********************************************************************** 88900020
*                                                                     * 88950020
*    THE CSECT BEGINS WITH A TABLE OF 8 BYTE ENTRIES, ONE FOR         * 90050020
*    EACH FIRST LEVEL MESSAGE.  THE FIRST HALFWORD OF EACH ENTRY      * 90100020
*    CONTAINS THE LENGTH OF A MESSAGE.  THE SECOND HALFWORD CONTAINS  * 90150020
*    THE OFFSET TO THE MESSAGE IN THE CSECT.  THE THIRD HALFWORD      * 90200020
*    CONTAINS THE OFFSET TO THE SEGMENT CHAIN IF MORE THAN ONE        * 90250020
*    MESSAGE SEGMENT EXISTS FOR A PARTICULAR MESSAGE.  THE FOURTH     * 90300020
*    AND LAST HALFWORD POINTS TO A TABLE DESCRIBING SECOND LEVEL      * 90350020
*    MESSAGES.  THE SEGMENT CHAIN ADDRESS IS CURRENTLY ALWAYS ZERO.   * 90400020
*                                                                     * 90450020
*    THE TABLE DESCRIBING SECOND LEVEL MESSAGES IS MADE UP OF         * 90600020
*    6 BYTE ENTRIES. A 2 BYTE LENGTH, A 2 BYTE MESSAGE OFFSET,        * 90650020
*    AND A 2 BYTE SEGMENT CHAIN OFFSET.                               * 90700020
*                                                                     * 90950020
*********************************************************************** 91000020
SEGCH0   EQU   0                   SEGMENT CHAIN OFFSET                 91010020
*                                                                       91020020
*        FIRST LEVEL MESSAGE TABLE                                      91030020
*                                                                       91040020
STARTALM DS    0F                  ALIGN FIRST LEVEL MESSAGE TABLE      91050020
         DC    AL2(L'MSGE1)        LENGTH OF MESSAGE                    91100020
         DC    AL2(MSGE1-STARTALM) OFFSET TO MESSAGE                    91150020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              91200020
         DC    AL2(SECLEVEL-STARTALM) OFFSET TO SECOND LEVEL TABLE      91250020
         DC    AL2(L'MSGE2)        LENGTH OF MESSAGE                    91300020
         DC    AL2(MSGE2-STARTALM) OFFSET TO MESSAGE                    91350020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              91400020
         DC    AL2(SECLEVEL-STARTALM) OFFSET TO SECOND LEVEL TABLE      91450020
         DC    AL2(L'MSGE3)        LENGTH OF MESSAGE                    91500020
         DC    AL2(MSGE3-STARTALM) OFFSET TO MESSAGE                    91550020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              91600020
         DC    AL2(SECLEVEL-STARTALM) OFFSET TO SECOND LEVEL TABLE      91650020
         DC    AL2(L'MSGE4)        LENGTH OF MESSAGE                    91700020
         DC    AL2(MSGE4-STARTALM) OFFSET TO MESSAGE                    91750020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              91800020
         DC    AL2(SECLEVEL-STARTALM) OFFSET TO SECOND LEVEL TABLE      91820020
         DC    AL2(L'MSGE5)        LENGTH OF MESSAGE                    91850020
         DC    AL2(MSGE5-STARTALM) OFFSET TO MESSAGE                    91900020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              91950020
         DC    AL2(SECLEVEL-STARTALM) OFFSET TO SECOND LEVEL TABLE      91970020
         DC    AL2(L'MSGE6)        LENGTH OF MESSAGE                    92000020
         DC    AL2(MSGE6-STARTALM) OFFSET TO MESSAGE                    92050020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              92100020
         DC    AL2(SECLEVEL-STARTALM) OFFSET TO SECOND LEVEL TABLE      92150020
*                                                                       92200020
*        FIRST LEVEL MESSAGES                                           92250020
*                                                                       92300020
*                                                                       92350020
MSGE1    DC    C'IKJ58300I HISTORY NOT AVAILABLE+'                      92400020
MSGE2    DC    C'IKJ58303I NOT ENOUGH MAIN STORAGE TO LIST '            92450020
MSGE3    DC    C'IKJ58302I NO DATA SETS ALLOCATED'                      92500020
MSGE4    DC    C'IKJ58301I MEMBERS NOT AVAILABLE+'                      92550020
MSGE5    DC    C'IKJ58304I COMMAND SYSTEM ERROR+'                       92600020
MSGE6    DC    C'IKJ58305I NOT ENOUGH MAIN STORAGE TO EXECUTE COMMAND'  92650020
*                                                                       92700020
*        SECOND LEVEL MESSAGE TABLE                                     92750020
*                                                                       92800020
SECLEVEL DS    0F                  ALIGN SECOND LEVEL MESSAGE TABLE     92900020
         DC    AL2(L'MSGSEC01)     LENGTH OF MESSAGE                    92950020
         DC    AL2(MSGSEC01-STARTALM) OFFSET TO MESSAGE                 93000020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              93050020
         DC    AL2(L'MSGSEC02)     LENGTH OF MESSAGE                    93100020
         DC    AL2(MSGSEC02-STARTALM) OFFSET TO MESSAGE                 93150020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              93200020
         DC    AL2(L'MSGSEC03)     LENGTH OF MESSAGE                    93250020
         DC    AL2(MSGSEC03-STARTALM) OFFSET TO MESSAGE                 93300020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              93350020
         DC    AL2(L'MSGSEC04)     LENGTH OF MESSAGE                    93400020
         DC    AL2(MSGSEC04-STARTALM) OFFSET TO MESSAGE                 93450020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              93500020
         DC    AL2(L'MSGSEC05)     LENGTH OF MESSAGE                    93550020
         DC    AL2(MSGSEC05-STARTALM) OFFSET TO MESSAGE                 93600020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              93650020
         DC    AL2(L'MSGSEC06)     LENGTH OF MESSAGE                    93700020
         DC    AL2(MSGSEC06-STARTALM) OFFSET TO MESSAGE                 93750020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              93800020
         DC    AL2(L'MSGSEC07)     LENGTH OF MESSAGE                    93850020
         DC    AL2(MSGSEC07-STARTALM) OFFSET TO MESSAGE                 93900020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              93950020
         DC    AL2(L'MSGSEC08)     LENGTH OF MESSAGE                    94000020
         DC    AL2(MSGSEC08-STARTALM) OFFSET TO MESSAGE                 94050020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              94100020
         DC    AL2(L'MSGSEC09)     LENGTH OF MESSAGE                    94150020
         DC    AL2(MSGSEC09-STARTALM) OFFSET TO MESSAGE                 94200020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              94250020
         DC    AL2(L'MSGSEC10)     LENGTH OF MESSAGE                    94300020
         DC    AL2(MSGSEC10-STARTALM) OFFSET TO MESSAGE                 94350020
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN              94400020
         DC    AL2(L'MSGSEC11)     LENGTH OF MESSAGE            ZA00106 94420002
         DC    AL2(MSGSEC11-STARTALM) OFFSET TO MESSAGE         ZA00106 94440002
         DC    AL2(SEGCH0)         OFFSET TO SEGMENT CHAIN      ZA00106 94460002
*                                                                       94500020
*        SECOND LEVEL MESSAGES                                          94550020
*                                                                       94600020
MSGSEC01 DC    C'IKJ583XXI REQUIRED VOLUME NOT MOUNTED'                 94650020
MSGSEC02 DC    C'IKJ583XXI DATA SET NOT ON VOLUME'                      94700020
MSGSEC03 EQU   *                                                        94750020
MSGSEC04 DC    C'IKJ583XXI I/O ERROR DURING OBTAIN, CODE '              94800020
MSGSEC05 DC    C'IKJ583XXI LOCATE ERROR CODE '                          94850020
MSGSEC06 DC    C'IKJ583XXI NOT ENOUGH MAIN STORAGE'                     94900020
MSGSEC07 DC    C'IKJ583XXI DIRECTORY STRUCTURE ERROR'                   94950020
MSGSEC08 DC    C'IKJ583XXI I/O SYNAD ERROR DURING DIRECTORY SEARCH '    95000020
MSGSEC09 EQU   *                                                        95050020
MSGSEC10 DC    C'IKJ583XXI PARSE ERROR CODE '                           95100020
MSGSEC11 DC    C'IKJ583XXI NO HISTORY AVAILABLE ON SPOOL DATA SETS'     95200002
*                                                               ZA00106 96200002
PATCH    DC    20X'00'             PATCH AREA                           96250003
         END                                                            97200002
