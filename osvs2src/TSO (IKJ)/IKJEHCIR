         TITLE '*********** IKJEHCIR:  CATALOG INFORMATION ROUTINE *****00001000
               ******** '                                               00002000
IKJEHCIR CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJEHCIR  74.346'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
*                                                                  0070 00022000
*        /************************************************************/ 00023000
*        /*                                                          */ 00024000
*        /* SET UP WORK AREA FOR CLP AND FPL.THEN CHECK ENTRY CODE   */ 00025000
*        /* FROM CIR PARAMETER LIST                                  */ 00026000
*        /*                                                          */ 00027000
*        /************************************************************/ 00028000
*                                                                  0071 00029000
*        CIRPTR = REG1;                                    /*@YL026YB*/ 00030000
         LR    CIRPTR,REG1                                         0071 00031000
*        CTGPLPTR = ADDR(CPLSTOR);                         /*@YL026YB*/ 00032000
         LA    CTGPLPTR,CPLSTOR                                    0072 00033000
*        CTGFLPTR = ADDR(FPLSTOR);                         /*@YL026YB*/ 00034000
         LA    @14,FPLSTOR                                         0073 00035000
         ST    @14,CTGFLPTR                                        0073 00036000
*        IF CIROPT = HEX01                                         0074 00037000
*          THEN                                                    0074 00038000
         CLI   CIROPT(CIRPTR),X'01'                                0074 00039000
         BNE   @RF00074                                            0074 00040000
*            CALL ENTRY01;                                 /*@YL026YB*/ 00041000
         BAL   @14,ENTRY01                                         0075 00042000
*          ELSE                                                    0076 00043000
*            IF CIROPT = HEX02                                     0076 00044000
*              THEN                                                0076 00045000
         B     @RC00074                                            0076 00046000
@RF00074 CLI   CIROPT(CIRPTR),X'02'                                0076 00047000
         BNE   @RF00076                                            0076 00048000
*                CALL ENTRY02;                             /*@YL026YB*/ 00049000
         BAL   @14,ENTRY02                                         0077 00050000
*              ELSE                                                0078 00051000
*                IF CIROPT = HEX04                                 0078 00052000
*                  THEN                                            0078 00053000
         B     @RC00076                                            0078 00054000
@RF00076 CLI   CIROPT(CIRPTR),X'04'                                0078 00055000
         BNE   @RF00078                                            0078 00056000
*                    CALL ENTRY04;                         /*@YL026YB*/ 00057000
         BAL   @14,ENTRY04                                         0079 00058000
*                  ELSE                                            0080 00059000
*                    CALL ENTRY06;                         /*@YL026YB*/ 00060000
*                                                                  0080 00061000
         B     @RC00078                                            0080 00062000
@RF00078 BAL   @14,ENTRY06                                         0080 00063000
*/********************************************************************/ 00064000
*/*                                                                  */ 00065000
*/* ENTRY01 IS THE PROCEDURE TO RETURN AN 8 BYTE QUALIFIER           */ 00066000
*/* WITH ENTRY TYPE. 44 BYTE NAMES ARE OBTAINED BY CALLING           */ 00067000
*/* SVC 26 FOR A GENERIC LOCATE.                                     */ 00068000
*/*                                                                  */ 00069000
*/********************************************************************/ 00070000
*                                                                  0081 00071000
*                                                                  0081 00072000
*ENTRY01: PROCEDURE;                                       /*@YL026YB*/ 00073000
         B     @PB00002                                            0081 00074000
ENTRY01  STM   @14,@12,@SA00002                                    0081 00075000
*        COUNT = 0;                                        /*@YL026YB*/ 00076000
         SLR   @14,@14                                             0082 00077000
         STH   @14,COUNT                                           0082 00078000
*        CNN = 0;                                                  0083 00079000
         STH   @14,CNN                                             0083 00080000
*        CNT = 0;                                                  0084 00081000
         STH   @14,CNT                                             0084 00082000
*        SWITCH = 0;                                               0085 00083000
*                                                                  0085 00084000
         STH   @14,SWITCH                                          0085 00085000
*        /************************************************************/ 00086000
*        /*                                                          */ 00087000
*        /* DO A GETMAIN TO OBTAIN A TEMPORARY WORKAREA FOR DATA     */ 00088000
*        /* RETURNED FROM SVC 26.SET REG 0 TO CONTAIN LENGTH OF      */ 00089000
*        /* WORKAREA AND SUBPOOL NUMBER.                             */ 00090000
*        /*                                                          */ 00091000
*        /************************************************************/ 00092000
*                                                                  0086 00093000
*        RFY (REG0,REG1) RSTD;                                     0086 00094000
*        REG0 = MAX1;                                              0087 00095000
         LH    REG0,@CH00208                                       0087 00096000
*        REG0 = REG0 | SUBPOOL1;                                   0088 00097000
         O     REG0,@CF00176                                       0088 00098000
*        CORESIZE = REG0;                                          0089 00099000
         ST    REG0,CORESIZE                                       0089 00100000
*        GEN (GETMAIN R,LV=(0));                                   0090 00101000
         GETMAIN R,LV=(0)                                               00102000
*        DPTR = REG1;                                              0091 00103000
*                                                                  0091 00104000
         ST    REG1,DPTR                                           0091 00105000
*        /************************************************************/ 00106000
*        /*                                                          */ 00107000
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */ 00108000
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */ 00109000
*        /* LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS            */ 00110000
*        /*                                                          */ 00111000
*        /************************************************************/ 00112000
*                                                                  0092 00113000
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/ 00114000
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/ 00115000
         LA    @14,44                                              0092 00116000
         STH   @14,COUNT                                           0092 00117000
@DL00092 L     @10,CIRSRCH(,CIRPTR)                                0092 00118000
         ALR   @10,@14                                             0092 00119000
         AL    @10,@CF00251                                        0092 00120000
         CLI   USENAME(@10),X'40'                                  0092 00121000
         BNE   @DC00092                                            0092 00122000
*        END;                                              /*@YL026YB*/ 00123000
         BCTR  @14,0                                               0093 00124000
         STH   @14,COUNT                                           0093 00125000
         LTR   @14,@14                                             0093 00126000
         BP    @DL00092                                            0093 00127000
@DC00092 DS    0H                                                  0094 00128000
*        GELENGTH = COUNT + 1;    /*MAKE ROOM FOR PERIOD TO   ZA00645*/ 00129000
         LA    @14,1                                               0094 00130000
         AH    @14,COUNT                                           0094 00131000
         STC   @14,GELENGTH                                        0094 00132000
*                       /*LIMIT SEARCH TO CORRECT INDEX LEVEL ZA00645*/ 00133000
*        USENAME(GELENGTH) = PERIOD;     /*INSERT PERIOD      ZA00645*/ 00134000
         L     @10,CIRSRCH(,CIRPTR)                                0095 00135000
         ALR   @14,@10                                             0095 00136000
         AL    @14,@CF00251                                        0095 00137000
         MVI   USENAME(@14),X'4B'                                  0095 00138000
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/ 00139000
         MVI   GNAME+1,C' '                                        0096 00140000
         MVC   GNAME+2(42),GNAME+1                                 0096 00141000
         SLR   @14,@14                                             0096 00142000
         IC    @14,GELENGTH                                        0096 00143000
         BCTR  @14,0                                               0096 00144000
         EX    @14,@SM00307                                        0096 00145000
*        CPLSTOR = ''B;                                    /*@YL026YB*/ 00146000
         XC    CPLSTOR(32),CPLSTOR                                 0097 00147000
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/ 00148000
         L     @14,DPTR                                            0098 00149000
         LA    @14,QUALDATA(,@14)                                  0098 00150000
         ST    @14,@AL00001                                        0098 00151000
         LA    @01,@AL00001                                        0098 00152000
         BAL   @14,MOVEINST                                        0098 00153000
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/ 00154000
*                                                                  0099 00155000
         L     @14,DPTR                                            0099 00156000
         MVC   QUALN(2,@14),@CH00208                               0099 00157000
*        /************************************************************/ 00158000
*        /*                                                          */ 00159000
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */ 00160000
*        /*                                                          */ 00161000
*        /************************************************************/ 00162000
*                                                                  0100 00163000
*        CTGNAME = ON;                                     /*@YL026YB*/ 00164000
*        CTGCNAME = ON;                                    /*@YL026YB*/ 00165000
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0101 00166000
*        CTGSUPLT = ON;                                    /*@YL026YB*/ 00167000
         OI    CTGSUPLT(CTGPLPTR),B'00010000'                      0102 00168000
*        CTGGENLD = ON;                                    /*@YL026YB*/ 00169000
         OI    CTGGENLD(CTGPLPTR),B'00000001'                      0103 00170000
*        CTGAM0 = ON;                                      /*@YL026YB*/ 00171000
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0104 00172000
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/ 00173000
         LA    @10,GENAME                                          0105 00174000
         ST    @10,CTGENT(,CTGPLPTR)                               0105 00175000
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/ 00176000
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0106 00177000
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/ 00178000
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0107 00179000
*        CTGWKA = DPTR;                                    /*@YL026YB*/ 00180000
*                                                                  0108 00181000
         ST    @14,CTGWKA(,CTGPLPTR)                               0108 00182000
*        /************************************************************/ 00183000
*        /*                                                          */ 00184000
*        /* CALL SVC 26 FOR GENERIC LOCATE. ON RETURN CHECK RETURN   */ 00185000
*        /* CODE                                                     */ 00186000
*        /*                                                          */ 00187000
*        /************************************************************/ 00188000
*                                                                  0109 00189000
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/ 00190000
         LR    REG1,CTGPLPTR                                       0109 00191000
*        GENERATE (CATLG (1));                             /*@YL026YB*/ 00192000
         CATLG (1)                                                      00193000
*        RETNCODE = REG15;                                 /*@YL026YB*/ 00194000
*                                                                  0111 00195000
         ST    REG15,RETNCODE                                      0111 00196000
*        /************************************************************/ 00197000
*        /*                                                          */ 00198000
*        /* IF RETURN CODE IS ZERO, THIS ROUTINE TAKES 44 BYTE NAMES */ 00199000
*        /* RETURNED AND COMPARES THEM WITH THE NAME FROM THE USER.  */ 00200000
*        /* THEN RETURNS THE 8 BYTE QUALIFIERS NEEDED TO COMPLETE    */ 00201000
*        /* THE NAME                                                 */ 00202000
*        /*                                                          */ 00203000
*        /************************************************************/ 00204000
*                                                                  0112 00205000
*        IF  RETNCODE = 0                                          0112 00206000
*          THEN                                                    0112 00207000
         L     @14,RETNCODE                                        0112 00208000
         LTR   @14,@14                                             0112 00209000
         BNZ   @RF00112                                            0112 00210000
*            DO;                                           /*@YL026YB*/ 00211000
*              IF AREALN < RTNQLN                          /*@YL026YB*/ 00212000
*                THEN                                      /*@YL026YB*/ 00213000
         L     @14,CIRWA(,CIRPTR)                                  0114 00214000
         LH    @14,AREALN(,@14)                                    0114 00215000
         L     @10,DPTR                                            0114 00216000
         CH    @14,RTNQLN(,@10)                                    0114 00217000
         BNL   @RF00114                                            0114 00218000
*                  DO;                                     /*@YL026YB*/ 00219000
*                    CIRLOCRC = 44;                        /*@YL026YB*/ 00220000
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0116 00221000
*                    RETNCODE = 4;                         /*@YL026YB*/ 00222000
         MVC   RETNCODE(4),@CF00190                                0117 00223000
*                    GOTO FRECR01;                         /*@YL026YB*/ 00224000
         B     FRECR01                                             0118 00225000
*                  END;                                    /*@YL026YB*/ 00226000
*            CNT = COUNT + 2;                              /*@YL026YB*/ 00227000
@RF00114 LA    @14,2                                               0120 00228000
         AH    @14,COUNT                                           0120 00229000
         STH   @14,CNT                                             0120 00230000
*            DATALN = RTNQLN;                              /*@YL026YB*/ 00231000
         L     @14,CIRWA(,CIRPTR)                                  0121 00232000
         L     @10,DPTR                                            0121 00233000
         LH    @03,RTNQLN(,@10)                                    0121 00234000
         STH   @03,DATALN(,@14)                                    0121 00235000
*            FIRST = 1;                                    /*@YL026YB*/ 00236000
         LA    @14,1                                               0122 00237000
         STH   @14,FIRST                                           0122 00238000
*            LAST = LENGTH(TYPE01);                        /*@YL026YB*/ 00239000
         MVC   LAST(2),@CH00279                                    0123 00240000
*            QULTYPE = '07'X;                              /*@YL026YB*/ 00241000
         MVI   QULTYPE,X'07'                                       0124 00242000
*            QULPTR = ADDR(QUALDATA);                      /*@YL026YB*/ 00243000
         LA    @10,QUALDATA(,@10)                                  0125 00244000
         ST    @10,QULPTR                                          0125 00245000
*            CONTROL = (RTNQLN - 4) / 45;                  /*@YL026YB*/ 00246000
         LR    @04,@03                                             0126 00247000
         SH    @04,@CH00190                                        0126 00248000
         SRDA  @04,32                                              0126 00249000
         D     @04,@CF00206                                        0126 00250000
         STH   @05,CONTROL                                         0126 00251000
*            DO  I = 1 TO CONTROL;                         /*@YL026YB*/ 00252000
         B     @DE00127                                            0127 00253000
@DL00127 DS    0H                                                  0128 00254000
*            QULBUF = QULPTR->DATABLK;                     /*@YL026YB*/ 00255000
         L     @14,QULPTR                                          0128 00256000
         MVC   QULBUF(45),DATABLK(@14)                             0128 00257000
*            IF QUALIFY(CNT) = BLANK                       /*@YL026YB*/ 00258000
*               THEN                                       /*@YL026YB*/ 00259000
         LH    @14,CNT                                             0129 00260000
         LA    @10,QUALIFY-1(@14)                                  0129 00261000
         CLI   0(@10),X'40'                                        0129 00262000
         BNE   @RF00129                                            0129 00263000
*                  DO;                                     /*@YL026YB*/ 00264000
*                   RETNCODE = 12;                         /*@YL026YB*/ 00265000
         MVC   RETNCODE(4),@CF00123                                0131 00266000
*                   GOTO FRECR01;                          /*@YL026YB*/ 00267000
         B     FRECR01                                             0132 00268000
*                  END;                                    /*@YL026YB*/ 00269000
*            DO  J = CNT TO 44 WHILE (QUALIFY(J) ^= BLANK);/*@YL026YB*/ 00270000
@RF00129 LH    @14,CNT                                             0134 00271000
         B     @DE00134                                            0134 00272000
@DL00134 LA    @10,QUALIFY-1(@14)                                  0134 00273000
         CLI   0(@10),X'40'                                        0134 00274000
         BE    @DC00134                                            0134 00275000
*               /* MOVE ONLY NAMES LOCATED WITH THEIR NEXT    ZA00646*/ 00276000
*               /* LEVEL BEING ALSO THEIR LAST, IE. NOT INDEX ZA00646*/ 00277000
*               IF QUALIFY(J) = PERIOD THEN                /* ZA00646*/ 00278000
         LA    @10,QUALIFY-1(@14)                                  0135 00279000
         CLI   0(@10),X'4B'                                        0135 00280000
         BE    @RT00135                                            0135 00281000
*                 GOTO BYPASS;                             /* ZA00646*/ 00282000
*               ELSE;                                      /* ZA00646*/ 00283000
*            END;                                          /*@YL026YB*/ 00284000
         AH    @14,@CH00051                                        0138 00285000
@DE00134 ST    @14,J                                               0138 00286000
         CH    @14,@CH00183                                        0138 00287000
         BNH   @DL00134                                            0138 00288000
@DC00134 DS    0H                                                  0139 00289000
*            CNN = J - 1;                                  /*@YL026YB*/ 00290000
         L     @14,J                                               0139 00291000
         BCTR  @14,0                                               0139 00292000
         STH   @14,CNN                                             0139 00293000
*            QULNAME = QUALIFY(CNT:CNN);                   /*@YL026YB*/ 00294000
         MVI   QULNAME+1,C' '                                      0140 00295000
         MVC   QULNAME+2(6),QULNAME+1                              0140 00296000
         LH    @10,CNT                                             0140 00297000
         SLR   @14,@10                                             0140 00298000
         LA    @03,QUALIFY-1(@10)                                  0140 00299000
         EX    @14,@SM00311                                        0140 00300000
*            DATAREA(FIRST:LAST) = TYPE01;                 /*@YL026YB*/ 00301000
*                                                                  0141 00302000
         LH    @14,FIRST                                           0141 00303000
         L     @10,CIRWA(,CIRPTR)                                  0141 00304000
         ALR   @10,@14                                             0141 00305000
         LH    @03,LAST                                            0141 00306000
         LCR   @14,@14                                             0141 00307000
         ALR   @14,@03                                             0141 00308000
         EX    @14,@SM00313                                        0141 00309000
*            /********************************************************/ 00310000
*            /*                                                      */ 00311000
*            /* ADJUST SUBSTRING VARIABLES AND POINT TO NEXT 44 BYTE */ 00312000
*            /* NAME                                                 */ 00313000
*            /*                                                      */ 00314000
*            /********************************************************/ 00315000
*                                                                  0142 00316000
*            FIRST = LAST + 1;                             /*@YL026YB*/ 00317000
         AH    @03,@CH00051                                        0142 00318000
         STH   @03,FIRST                                           0142 00319000
*            LAST = FIRST + LENGTH(QULNAME);               /*@YL026YB*/ 00320000
         AH    @03,@CH00055                                        0143 00321000
         STH   @03,LAST                                            0143 00322000
*BYPASS:     QULPTR = QULPTR + 45;                         /* ZA00646*/ 00323000
BYPASS   LA    @14,45                                              0144 00324000
         AL    @14,QULPTR                                          0144 00325000
         ST    @14,QULPTR                                          0144 00326000
*            END;                                          /*@YL026YB*/ 00327000
*                                                                  0145 00328000
         LA    @14,1                                               0145 00329000
         AL    @14,I                                               0145 00330000
@DE00127 ST    @14,I                                               0145 00331000
         CH    @14,CONTROL                                         0145 00332000
         BNH   @DL00127                                            0145 00333000
*            /********************************************************/ 00334000
*            /*                                                      */ 00335000
*            /*   PUT HEX FF AS THE LAST BYTE IN USER WORK AREA TO   */ 00336000
*            /*   TO INDICATE END OF DATA                            */ 00337000
*            /*                                                      */ 00338000
*            /********************************************************/ 00339000
*                                                                  0146 00340000
*            ENDBYTE = FIRST;                              /*@YL026YB*/ 00341000
         LH    ENDBYTE,FIRST                                       0146 00342000
*            DATAREA(ENDBYTE) = FOXES;                     /*@YL026YB*/ 00343000
         L     @14,CIRWA(,CIRPTR)                                  0147 00344000
         ALR   @14,ENDBYTE                                         0147 00345000
         MVI   DATAREA-1(@14),X'FF'                                0147 00346000
*            RETNCODE = 0;                                 /*@YL026YB*/ 00347000
         SLR   @14,@14                                             0148 00348000
         ST    @14,RETNCODE                                        0148 00349000
*            GOTO FRECR01;                                 /*@YL026YB*/ 00350000
         B     FRECR01                                             0149 00351000
*            END;                                          /*@YL026YB*/ 00352000
*                                                                  0150 00353000
*        /************************************************************/ 00354000
*        /*                                                          */ 00355000
*        /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN TABLE*/ 00356000
*        /*                                                          */ 00357000
*        /************************************************************/ 00358000
*                                                                  0151 00359000
*        ELSE                                                      0151 00360000
*            DO;                                           /*@YL026YB*/ 00361000
@RF00112 DS    0H                                                  0152 00362000
*              DO I =1 TO 8;                               /*@YL026YB*/ 00363000
         LA    @14,1                                               0152 00364000
         ST    @14,I                                               0152 00365000
@DL00152 DS    0H                                                  0153 00366000
*              IF RTNTABLE(I) = RETNCODE                           0153 00367000
*                THEN                                              0153 00368000
         SLA   @14,2                                               0153 00369000
         L     @14,RTNTABLE-4(@14)                                 0153 00370000
         C     @14,RETNCODE                                        0153 00371000
         BNE   @RF00153                                            0153 00372000
*                  DO;                                     /*@YL026YB*/ 00373000
*                    SWITCH = 1;                           /*@YL026YB*/ 00374000
         MVC   SWITCH(2),@CH00051                                  0155 00375000
*                    CIRLOCRC = REG15;                     /*@YL026YB*/ 00376000
         STC   REG15,CIRLOCRC(,CIRPTR)                             0156 00377000
*                    RETNCODE = 4;                         /*@YL026YB*/ 00378000
         MVC   RETNCODE(4),@CF00190                                0157 00379000
*                    GOTO FRECR01;                         /*@YL026YB*/ 00380000
         B     FRECR01                                             0158 00381000
*                  END;                                    /*@YL026YB*/ 00382000
*                  ELSE;                                   /*@YL026YB*/ 00383000
@RF00153 DS    0H                                                  0161 00384000
*              END;                                        /*@YL026YB*/ 00385000
*                                                                  0161 00386000
         LA    @14,1                                               0161 00387000
         AL    @14,I                                               0161 00388000
         ST    @14,I                                               0161 00389000
         CH    @14,@CH00055                                        0161 00390000
         BNH   @DL00152                                            0161 00391000
*            /********************************************************/ 00392000
*            /*                                                      */ 00393000
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */ 00394000
*            /* TABLE, SET THE RETURN CODE TO 12                     */ 00395000
*            /*                                                      */ 00396000
*            /********************************************************/ 00397000
*                                                                  0162 00398000
*            IF SWITCH ^= 1                                        0162 00399000
*               THEN                                               0162 00400000
         CLC   SWITCH(2),@CH00051                                  0162 00401000
         BE    @RF00162                                            0162 00402000
*                 RETNCODE = 12;                           /*@YL026YB*/ 00403000
         MVC   RETNCODE(4),@CF00123                                0163 00404000
*         END;                                             /*@YL026YB*/ 00405000
*                                                                  0164 00406000
@RF00162 DS    0H                                                  0165 00407000
*        /************************************************************/ 00408000
*        /*                                                          */ 00409000
*        /* FREE TEMPORARY WORKAREA. RETURN TO CALLER                */ 00410000
*        /*                                                          */ 00411000
*        /************************************************************/ 00412000
*                                                                  0165 00413000
*FRECR01: REG1 = DPTR;                                             0165 00414000
FRECR01  L     REG1,DPTR                                           0165 00415000
*         REG0 = CORESIZE;                                         0166 00416000
         L     REG0,CORESIZE                                       0166 00417000
*         GEN (FREEMAIN R,LV=(0),A=(1));                           0167 00418000
         FREEMAIN R,LV=(0),A=(1)                                        00419000
*         RFY (REG0,REG1) UNRSTD;                                  0168 00420000
*         END;                                             /*@YL026YB*/ 00421000
*                                                                  0169 00422000
@EL00002 DS    0H                                                  0169 00423000
@EF00002 DS    0H                                                  0169 00424000
@ER00002 LM    @14,@12,@SA00002                                    0169 00425000
         BR    @14                                                 0169 00426000
*/********************************************************************/ 00427000
*/*                                                                  */ 00428000
*/* ENTRY02 IS THE PROCEDURE TO RETURN A 44 BYTE NAME WITH ENTRY     */ 00429000
*/* TYPE. IT ISSUES SVC 26 FOR GENERIC LOCATE TO A LIST OF 44 BYTE   */ 00430000
*/* NAMES                                                            */ 00431000
*/********************************************************************/ 00432000
*                                                                  0170 00433000
*ENTRY02:PROCEDURE;                                        /*@YL026YB*/ 00434000
ENTRY02  STM   @14,@12,@SA00003                                    0170 00435000
*        COUNT = 0;                                                0171 00436000
         SLR   @14,@14                                             0171 00437000
         STH   @14,COUNT                                           0171 00438000
*        SWITCH = 0;                                               0172 00439000
         STH   @14,SWITCH                                          0172 00440000
*        RFY (REG1) RSTD;                                          0173 00441000
*                                                                  0173 00442000
*        /************************************************************/ 00443000
*        /*                                                          */ 00444000
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */ 00445000
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */ 00446000
*        /* LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS            */ 00447000
*        /*                                                          */ 00448000
*        /************************************************************/ 00449000
*                                                                  0174 00450000
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/ 00451000
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/ 00452000
         LA    @14,44                                              0174 00453000
         STH   @14,COUNT                                           0174 00454000
@DL00174 L     @10,CIRSRCH(,CIRPTR)                                0174 00455000
         ALR   @10,@14                                             0174 00456000
         AL    @10,@CF00251                                        0174 00457000
         CLI   USENAME(@10),X'40'                                  0174 00458000
         BNE   @DC00174                                            0174 00459000
*        END;                                              /*@YL026YB*/ 00460000
         BCTR  @14,0                                               0175 00461000
         STH   @14,COUNT                                           0175 00462000
         LTR   @14,@14                                             0175 00463000
         BP    @DL00174                                            0175 00464000
@DC00174 DS    0H                                                  0176 00465000
*        GELENGTH = COUNT + 1;    /*MAKE ROOM FOR PERIOD TO   ZA00645*/ 00466000
         LA    @14,1                                               0176 00467000
         AH    @14,COUNT                                           0176 00468000
         STC   @14,GELENGTH                                        0176 00469000
*                       /*LIMIT SEARCH TO CORRECT INDEX LEVEL ZA00645*/ 00470000
*        USENAME(GELENGTH) = PERIOD;     /*INSERT PERIOD      ZA00645*/ 00471000
         L     @10,CIRSRCH(,CIRPTR)                                0177 00472000
         ALR   @14,@10                                             0177 00473000
         AL    @14,@CF00251                                        0177 00474000
         MVI   USENAME(@14),X'4B'                                  0177 00475000
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/ 00476000
         MVI   GNAME+1,C' '                                        0178 00477000
         MVC   GNAME+2(42),GNAME+1                                 0178 00478000
         SLR   @14,@14                                             0178 00479000
         IC    @14,GELENGTH                                        0178 00480000
         BCTR  @14,0                                               0178 00481000
         EX    @14,@SM00307                                        0178 00482000
*        CPLSTOR = ''B;                                    /*@YL026YB*/ 00483000
*                                                                  0179 00484000
         XC    CPLSTOR(32),CPLSTOR                                 0179 00485000
*        /************************************************************/ 00486000
*        /*                                                          */ 00487000
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */ 00488000
*        /*                                                          */ 00489000
*        /************************************************************/ 00490000
*                                                                  0180 00491000
*        CTGNAME = ON;                                     /*@YL026YB*/ 00492000
*        CTGCNAME = ON;                                    /*@YL026YB*/ 00493000
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0181 00494000
*        CTGSUPLT = ON;                                    /*@YL026YB*/ 00495000
         OI    CTGSUPLT(CTGPLPTR),B'00010000'                      0182 00496000
*        CTGGENLD = ON;                                    /*@YL026YB*/ 00497000
         OI    CTGGENLD(CTGPLPTR),B'00000001'                      0183 00498000
*        CTGAM0 = ON;                                      /*@YL026YB*/ 00499000
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0184 00500000
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/ 00501000
         LA    @14,GENAME                                          0185 00502000
         ST    @14,CTGENT(,CTGPLPTR)                               0185 00503000
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/ 00504000
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0186 00505000
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/ 00506000
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0187 00507000
*        CTGWKA = CIRWA;                                   /*@YL026YB*/ 00508000
*                                                                  0188 00509000
         MVC   CTGWKA(4,CTGPLPTR),CIRWA(CIRPTR)                    0188 00510000
*        /************************************************************/ 00511000
*        /*                                                          */ 00512000
*        /* CALL SVC 26 FOR GENERIC LOCATE. ON RETURN CHECK RETURN   */ 00513000
*        /* CODE                                                     */ 00514000
*        /*                                                          */ 00515000
*        /************************************************************/ 00516000
*                                                                  0189 00517000
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/ 00518000
         LR    REG1,CTGPLPTR                                       0189 00519000
*        GENERATE (CATLG (1));                             /*@YL026YB*/ 00520000
         CATLG (1)                                                      00521000
*        RETNCODE = REG15;                                 /*@YL026YB*/ 00522000
*                                                                  0191 00523000
         ST    REG15,RETNCODE                                      0191 00524000
*        /************************************************************/ 00525000
*        /*                                                          */ 00526000
*        /* IF RETURN CODE IS ZERO, 44 BYTE NAMES NOW IN USER        */ 00527000
*        /* WORK AREA.PUT A HEX FF AS THE LAST BYTE IN               */ 00528000
*        /* USER WORK AREA TO INDICATE END OF DATA                   */ 00529000
*        /*                                                          */ 00530000
*        /************************************************************/ 00531000
*                                                                  0192 00532000
*        IF RETNCODE = 0                                           0192 00533000
*          THEN                                                    0192 00534000
         L     @14,RETNCODE                                        0192 00535000
         LTR   @14,@14                                             0192 00536000
         BNZ   @RF00192                                            0192 00537000
*            DO;                                           /*@YL026YB*/ 00538000
*              ENDBYTE = DATALN - 3;                       /*@YL026YB*/ 00539000
         L     @14,CIRWA(,CIRPTR)                                  0194 00540000
         LH    ENDBYTE,DATALN(,@14)                                0194 00541000
         SH    ENDBYTE,@CH00090                                    0194 00542000
*              DATAREA(ENDBYTE) = FOXES;                   /*@YL026YB*/ 00543000
         ALR   @14,ENDBYTE                                         0195 00544000
         MVI   DATAREA-1(@14),X'FF'                                0195 00545000
*            END;                                          /*@YL026YB*/ 00546000
*          /**********************************************************/ 00547000
*          /*                                                        */ 00548000
*          /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN    */ 00549000
*          /* TABLE                                                  */ 00550000
*          /**********************************************************/ 00551000
*          ELSE                                                    0197 00552000
*                                                                  0197 00553000
*            DO;                                           /*@YL026YB*/ 00554000
         B     @RC00192                                            0197 00555000
@RF00192 DS    0H                                                  0198 00556000
*              DO I = 1 TO 8;                              /*@YL026YB*/ 00557000
         LA    @14,1                                               0198 00558000
         ST    @14,I                                               0198 00559000
@DL00198 DS    0H                                                  0199 00560000
*              IF RTNTABLE(I) = RETNCODE                           0199 00561000
*                THEN                                              0199 00562000
         SLA   @14,2                                               0199 00563000
         L     @14,RTNTABLE-4(@14)                                 0199 00564000
         C     @14,RETNCODE                                        0199 00565000
         BNE   @RF00199                                            0199 00566000
*                  DO;                                     /*@YL026YB*/ 00567000
*                    SWITCH = 1;                           /*@YL026YB*/ 00568000
         MVC   SWITCH(2),@CH00051                                  0201 00569000
*                    CIRLOCRC = REG15;                     /*@YL026YB*/ 00570000
         STC   REG15,CIRLOCRC(,CIRPTR)                             0202 00571000
*                    RETNCODE = 4;                         /*@YL026YB*/ 00572000
         MVC   RETNCODE(4),@CF00190                                0203 00573000
*                  END;                                    /*@YL026YB*/ 00574000
*                ELSE;                                     /*@YL026YB*/ 00575000
@RF00199 DS    0H                                                  0206 00576000
*            END;                                          /*@YL026YB*/ 00577000
*                                                                  0206 00578000
         LA    @14,1                                               0206 00579000
         AL    @14,I                                               0206 00580000
         ST    @14,I                                               0206 00581000
         CH    @14,@CH00055                                        0206 00582000
         BNH   @DL00198                                            0206 00583000
*            /********************************************************/ 00584000
*            /*                                                      */ 00585000
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */ 00586000
*            /* TABLE, SET THE RETURN CODE TO 12                     */ 00587000
*            /*                                                      */ 00588000
*            /********************************************************/ 00589000
*                                                                  0207 00590000
*            IF SWITCH ^= 1                                        0207 00591000
*              THEN                                                0207 00592000
         CLC   SWITCH(2),@CH00051                                  0207 00593000
         BE    @RF00207                                            0207 00594000
*                RETNCODE = 12;                            /*@YL026YB*/ 00595000
         MVC   RETNCODE(4),@CF00123                                0208 00596000
*        END;                                              /*@YL026YB*/ 00597000
*        RFY (REG1) UNRSTD;                                        0210 00598000
*        END;                                              /*@YL026YB*/ 00599000
*                                                                  0211 00600000
@EL00003 DS    0H                                                  0211 00601000
@EF00003 DS    0H                                                  0211 00602000
@ER00003 LM    @14,@12,@SA00003                                    0211 00603000
         BR    @14                                                 0211 00604000
*/********************************************************************/ 00605000
*/*                                                                  */ 00606000
*/* ENTRY04 IS THE PROCEDURE TO RETURN VOLUMN INFORMATION.SVC 26     */ 00607000
*/* IS ISSUED FOR A VSAM LOCATE                                      */ 00608000
*/*                                                                  */ 00609000
*/********************************************************************/ 00610000
*                                                                  0212 00611000
*ENTRY04: PROCEDURE;                                       /*@YL026YB*/ 00612000
ENTRY04  STM   @14,@12,@SA00004                                    0212 00613000
*        COUNT = 0;                                                0213 00614000
         SLR   @14,@14                                             0213 00615000
         STH   @14,COUNT                                           0213 00616000
*        SWITCH = 0;                                               0214 00617000
*                                                                  0214 00618000
         STH   @14,SWITCH                                          0214 00619000
*        /************************************************************/ 00620000
*        /*                                                          */ 00621000
*        /* DO A GETMAIN TO OBTAIN A TEMPORARY WORKAREA FOR DATA     */ 00622000
*        /* RETURNED FROM SVC 26.SET REG 0 TO CONTAIN LENGTH OF      */ 00623000
*        /* WORKAREA AND SUBPOOL NUMBER.                             */ 00624000
*        /*                                                          */ 00625000
*        /************************************************************/ 00626000
*                                                                  0215 00627000
*        RFY (REG0,REG1) RSTD;                                     0215 00628000
*        REG0 = MAX1;                                              0216 00629000
         LH    REG0,@CH00208                                       0216 00630000
*        REG0 = REG0 | SUBPOOL1;                           /*@YL026YB*/ 00631000
         O     REG0,@CF00176                                       0217 00632000
*        CORESIZE = REG0;                                          0218 00633000
         ST    REG0,CORESIZE                                       0218 00634000
*        GEN (GETMAIN R,LV=(0));                                   0219 00635000
         GETMAIN R,LV=(0)                                               00636000
*        DPTR = REG1;                                              0220 00637000
*                                                                  0220 00638000
         ST    REG1,DPTR                                           0220 00639000
*        /************************************************************/ 00640000
*        /*                                                          */ 00641000
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */ 00642000
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */ 00643000
*        /* LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS            */ 00644000
*        /*                                                          */ 00645000
*        /************************************************************/ 00646000
*                                                                  0221 00647000
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/ 00648000
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/ 00649000
         LA    @14,44                                              0221 00650000
         STH   @14,COUNT                                           0221 00651000
@DL00221 L     @10,CIRSRCH(,CIRPTR)                                0221 00652000
         ALR   @10,@14                                             0221 00653000
         AL    @10,@CF00251                                        0221 00654000
         CLI   USENAME(@10),X'40'                                  0221 00655000
         BNE   @DC00221                                            0221 00656000
*        END;                                              /*@YL026YB*/ 00657000
         BCTR  @14,0                                               0222 00658000
         STH   @14,COUNT                                           0222 00659000
         LTR   @14,@14                                             0222 00660000
         BP    @DL00221                                            0222 00661000
@DC00221 DS    0H                                                  0223 00662000
*        GELENGTH = COUNT;                                 /*@YL026YB*/ 00663000
         LH    @14,COUNT                                           0223 00664000
         STC   @14,GELENGTH                                        0223 00665000
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/ 00666000
         MVI   GNAME+1,C' '                                        0224 00667000
         MVC   GNAME+2(42),GNAME+1                                 0224 00668000
         BCTR  @14,0                                               0224 00669000
         L     @10,CIRSRCH(,CIRPTR)                                0224 00670000
         EX    @14,@SM00307                                        0224 00671000
*        CPLSTOR = ''B;                                    /*@YL026YB*/ 00672000
         XC    CPLSTOR(32),CPLSTOR                                 0225 00673000
*        FPLSTOR = ''B;                                    /*@YL026YB*/ 00674000
         XC    FPLSTOR(24),FPLSTOR                                 0226 00675000
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/ 00676000
         L     @14,DPTR                                            0227 00677000
         LA    @14,QUALDATA(,@14)                                  0227 00678000
         ST    @14,@AL00001                                        0227 00679000
         LA    @01,@AL00001                                        0227 00680000
         BAL   @14,MOVEINST                                        0227 00681000
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/ 00682000
*                                                                  0228 00683000
         L     @14,DPTR                                            0228 00684000
         MVC   QUALN(2,@14),@CH00208                               0228 00685000
*        /************************************************************/ 00686000
*        /*                                                          */ 00687000
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */ 00688000
*        /*                                                          */ 00689000
*        /************************************************************/ 00690000
*                                                                  0229 00691000
*        CTGNAME = ON;                                     /*@YL026YB*/ 00692000
*        CTGCNAME = ON;                                    /*@YL026YB*/ 00693000
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0230 00694000
*        CTGFUNC = '001'B;                                 /*@YL026YB*/ 00695000
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       0231 00696000
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       0231 00697000
*        CTGAM0 = ON;                                      /*@YL026YB*/ 00698000
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0232 00699000
*        CTGENT = ADDR(GNAME);                             /*@YL026YB*/ 00700000
         LA    @10,GNAME                                           0233 00701000
         ST    @10,CTGENT(,CTGPLPTR)                               0233 00702000
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/ 00703000
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0234 00704000
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/ 00705000
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0235 00706000
*        CTGWKA = DPTR;                                    /*@YL026YB*/ 00707000
*                                                                  0236 00708000
         ST    @14,CTGWKA(,CTGPLPTR)                               0236 00709000
*        /************************************************************/ 00710000
*        /*                                                          */ 00711000
*        /* SET UP PARAMETER LIST FOR FPL                            */ 00712000
*        /*                                                          */ 00713000
*        /************************************************************/ 00714000
*                                                                  0237 00715000
*        CTGNOFLD = 1;                                     /*@YL026YB*/ 00716000
         MVI   CTGNOFLD(CTGPLPTR),X'01'                            0237 00717000
*        CTGFIELD(1) = ADDR(FPLSTOR);                      /*@YL026YB*/ 00718000
         LA    @14,FPLSTOR                                         0238 00719000
         ST    @14,CTGFIELD(,CTGPLPTR)                             0238 00720000
*        CTGFLDNM = ADDR(ENNTRY);                          /*@YL026YB*/ 00721000
         L     @14,CTGFLPTR                                        0239 00722000
         LA    @10,@CC00229                                        0239 00723000
         ST    @10,CTGFLDNM(,@14)                                  0239 00724000
*        CTGFLDNO = 1;                                     /*@YL026YB*/ 00725000
*                                                                  0240 00726000
         MVI   CTGFLDNO(@14),X'01'                                 0240 00727000
*        /************************************************************/ 00728000
*        /*                                                          */ 00729000
*        /* CALL SVC 26 FOR VSAM    LOCATE. ON RETURN CHECK RETURN   */ 00730000
*        /* CODE                                                     */ 00731000
*        /*                                                          */ 00732000
*        /************************************************************/ 00733000
*                                                                  0241 00734000
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/ 00735000
         LR    REG1,CTGPLPTR                                       0241 00736000
*        GENERATE (CATLG (1));                             /*@YL026YB*/ 00737000
         CATLG (1)                                                      00738000
*        RETNCODE = REG15;                                 /*@YL026YB*/ 00739000
*                                                                  0243 00740000
         ST    REG15,RETNCODE                                      0243 00741000
*        /************************************************************/ 00742000
*        /*                                                          */ 00743000
*        /* IF RETURN CODE IS ZERO, COMPUTE THE VOLUMN COUNT.        */ 00744000
*        /* MOVE VOLUMN INFORMATION TO USER WORK AREA                */ 00745000
*        /*                                                          */ 00746000
*        /************************************************************/ 00747000
*                                                                  0244 00748000
*        IF  RETNCODE = 0                                          0244 00749000
*          THEN                                                    0244 00750000
         L     @14,RETNCODE                                        0244 00751000
         LTR   @14,@14                                             0244 00752000
         BNZ   @RF00244                                            0244 00753000
*            DO;                                                   0245 00754000
*              IF AREALN < RTNQLN                          /*@YL026YB*/ 00755000
*                THEN                                      /*@YL026YB*/ 00756000
         L     @14,CIRWA(,CIRPTR)                                  0246 00757000
         LH    @14,AREALN(,@14)                                    0246 00758000
         L     @10,DPTR                                            0246 00759000
         CH    @14,RTNQLN(,@10)                                    0246 00760000
         BNL   @RF00246                                            0246 00761000
*                  DO;                                     /*@YL026YB*/ 00762000
*                    CIRLOCRC = 44;                        /*@YL026YB*/ 00763000
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0248 00764000
*                    RETNCODE = 4;                         /*@YL026YB*/ 00765000
         MVC   RETNCODE(4),@CF00190                                0249 00766000
*                    GOTO FRECR04;                         /*@YL026YB*/ 00767000
         B     FRECR04                                             0250 00768000
*                  END;                                    /*@YL026YB*/ 00769000
*                  DATALN = RTNQLN;                        /*@YL026YB*/ 00770000
@RF00246 L     @14,CIRWA(,CIRPTR)                                  0252 00771000
         L     @10,DPTR                                            0252 00772000
         MVC   DATALN(2,@14),RTNQLN(@10)                           0252 00773000
*              VOLCNT = CTGFLNG(1) / LENGTH(VOLAREA);      /*@YL026YB*/ 00774000
         L     @10,CTGFLPTR                                        0253 00775000
         L     @04,CTGFLNG(,@10)                                   0253 00776000
         SRDA  @04,32                                              0253 00777000
         D     @04,@CF00145                                        0253 00778000
         STC   @05,VOLCNT                                          0253 00779000
*              DATAREA(1) = VOLCNT;                        /*@YL026YB*/ 00780000
         STC   @05,DATAREA(,@14)                                   0254 00781000
*              LAST = 1;                                   /*@YL026YB*/ 00782000
         LA    @14,1                                               0255 00783000
         STH   @14,LAST                                            0255 00784000
*              DO  I = 1 TO VOLCNT;                        /*@YL026YB*/ 00785000
         B     @DE00256                                            0256 00786000
@DL00256 DS    0H                                                  0257 00787000
*              FIRST = LAST + 1;                           /*@YL026YB*/ 00788000
         LA    @10,1                                               0257 00789000
         AH    @10,LAST                                            0257 00790000
         STH   @10,FIRST                                           0257 00791000
*              LAST = FIRST + (LENGTH(VOLDATA) - 1);       /*@YL026YB*/ 00792000
         LA    @03,11                                              0258 00793000
         ALR   @03,@10                                             0258 00794000
         STH   @03,LAST                                            0258 00795000
*              VOLAREA = CTGFLPT(1)->VOLBLK(1:LENGTH(VOLAREA));    0259 00796000
         L     @09,CTGFLPTR                                        0259 00797000
         L     @08,CTGFLPT(,@09)                                   0259 00798000
         MVC   VOLAREA(15),VOLBLK(@08)                             0259 00799000
*              DATAREA(FIRST:LAST) = VOLDATA;              /*@YL026YB*/ 00800000
         L     @07,CIRWA(,CIRPTR)                                  0260 00801000
         ALR   @07,@10                                             0260 00802000
         SLR   @03,@10                                             0260 00803000
         EX    @03,@SM00317                                        0260 00804000
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(VOLAREA);  /*@YL026YB*/ 00805000
         AH    @08,@CH00145                                        0261 00806000
         ST    @08,CTGFLPT(,@09)                                   0261 00807000
*              END;                                        /*@YL026YB*/ 00808000
*                                                                  0262 00809000
         AH    @14,@CH00051                                        0262 00810000
@DE00256 ST    @14,I                                               0262 00811000
         SLR   @10,@10                                             0262 00812000
         IC    @10,VOLCNT                                          0262 00813000
         CR    @14,@10                                             0262 00814000
         BNH   @DL00256                                            0262 00815000
*              /******************************************************/ 00816000
*              /*                                                    */ 00817000
*              /* PUT HEX FF AS THE LAST BYTE IN USER WORK AREA TO   */ 00818000
*              /* TO INDICATE END OF DATA                            */ 00819000
*              /*                                                    */ 00820000
*              /******************************************************/ 00821000
*                                                                  0263 00822000
*              ENDBYTE = LAST + 1;                         /*@YL026YB*/ 00823000
         LA    ENDBYTE,1                                           0263 00824000
         AH    ENDBYTE,LAST                                        0263 00825000
*              DATAREA(ENDBYTE) = FOXES;                   /*@YL026YB*/ 00826000
         L     @14,CIRWA(,CIRPTR)                                  0264 00827000
         ALR   @14,ENDBYTE                                         0264 00828000
         MVI   DATAREA-1(@14),X'FF'                                0264 00829000
*              RETNCODE = 0;                               /*@YL026YB*/ 00830000
         SLR   @14,@14                                             0265 00831000
         ST    @14,RETNCODE                                        0265 00832000
*              GOTO FRECR04;                                       0266 00833000
         B     FRECR04                                             0266 00834000
*            END;                                          /*@YL026YB*/ 00835000
*            /********************************************************/ 00836000
*            /*                                                      */ 00837000
*            /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN  */ 00838000
*            /* TABLE                                                */ 00839000
*            /********************************************************/ 00840000
*            ELSE                                                  0268 00841000
*              DO;                                         /*@YL026YB*/ 00842000
@RF00244 DS    0H                                                  0269 00843000
*                DO I = 1 TO 8;                            /*@YL026YB*/ 00844000
         LA    @14,1                                               0269 00845000
         ST    @14,I                                               0269 00846000
@DL00269 DS    0H                                                  0270 00847000
*              IF RTNTABLE(I) = RETNCODE                           0270 00848000
*                THEN                                              0270 00849000
         SLA   @14,2                                               0270 00850000
         L     @14,RTNTABLE-4(@14)                                 0270 00851000
         C     @14,RETNCODE                                        0270 00852000
         BNE   @RF00270                                            0270 00853000
*                  DO;                                     /*@YL026YB*/ 00854000
*                    SWITCH = 1;                           /*@YL026YB*/ 00855000
         MVC   SWITCH(2),@CH00051                                  0272 00856000
*                    CIRLOCRC = REG15;                     /*@YL026YB*/ 00857000
         STC   REG15,CIRLOCRC(,CIRPTR)                             0273 00858000
*                    RETNCODE = 4;                         /*@YL026YB*/ 00859000
         MVC   RETNCODE(4),@CF00190                                0274 00860000
*                    GOTO FRECR04;                                 0275 00861000
         B     FRECR04                                             0275 00862000
*                  END;                                    /*@YL026YB*/ 00863000
*                ELSE;                                     /*@YL026YB*/ 00864000
@RF00270 DS    0H                                                  0278 00865000
*            END;                                          /*@YL026YB*/ 00866000
*                                                                  0278 00867000
         LA    @14,1                                               0278 00868000
         AL    @14,I                                               0278 00869000
         ST    @14,I                                               0278 00870000
         CH    @14,@CH00055                                        0278 00871000
         BNH   @DL00269                                            0278 00872000
*            /********************************************************/ 00873000
*            /*                                                      */ 00874000
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */ 00875000
*            /* TABLE, SET THE RETURN CODE TO 12                     */ 00876000
*            /*                                                      */ 00877000
*            /********************************************************/ 00878000
*                                                                  0279 00879000
*            IF SWITCH ^= 1                                        0279 00880000
*              THEN                                                0279 00881000
         CLC   SWITCH(2),@CH00051                                  0279 00882000
         BE    @RF00279                                            0279 00883000
*                RETNCODE = 12;                            /*@YL026YB*/ 00884000
         MVC   RETNCODE(4),@CF00123                                0280 00885000
*        END;                                              /*@YL026YB*/ 00886000
*                                                                  0281 00887000
@RF00279 DS    0H                                                  0282 00888000
*        /************************************************************/ 00889000
*        /*                                                          */ 00890000
*        /* FREE TEMPORARY WORKAREA. RETURN TO CALLER                */ 00891000
*        /*                                                          */ 00892000
*        /************************************************************/ 00893000
*                                                                  0282 00894000
*FRECR04:REG1 = DPTR;                                              0282 00895000
FRECR04  L     REG1,DPTR                                           0282 00896000
*        REG0 = CORESIZE;                                          0283 00897000
         L     REG0,CORESIZE                                       0283 00898000
*        GEN (FREEMAIN R,LV=(0),A=(1));                            0284 00899000
         FREEMAIN R,LV=(0),A=(1)                                        00900000
*        RFY (REG0,REG1) UNRSTD;                                   0285 00901000
*        END;                                              /*@YL026YB*/ 00902000
*                                                                  0286 00903000
@EL00004 DS    0H                                                  0286 00904000
@EF00004 DS    0H                                                  0286 00905000
@ER00004 LM    @14,@12,@SA00004                                    0286 00906000
         BR    @14                                                 0286 00907000
*/********************************************************************/ 00908000
*/*                                                                  */ 00909000
*/* ENTRY06 IS THE PROCEDURE TO RETURN 44 BYTE NAMES AND VOLUMN      */ 00910000
*/* INFORMATION. IT GETS CONTROL IF THE ENTRY CODE IS HEX 05         */ 00911000
*/* OR HEX 06. IF THE ENTRY CODE IS HEX 05 IT CALLS PROCEDURE        */ 00912000
*/* ENTRY05. FIRST IT ISSUES SVC 26 FOR A GENERIC LOCATE             */ 00913000
*/* AND TAKES THE 44 BYTE NAME RETURNED AND ISSUES SVC 26            */ 00914000
*/* AGAIN FOR A VSAM LOCATE TO GET VOLUMN INFORMATION.               */ 00915000
*/*                                                                  */ 00916000
*/********************************************************************/ 00917000
*                                                                  0287 00918000
*ENTRY06: PROCEDURE;                                       /*@YL026YB*/ 00919000
ENTRY06  STM   @14,@12,@SA00005                                    0287 00920000
*        DCL SAVCNT          FIXED(15);/*LENGTH OF NAME      @YL026YB*/ 00921000
*                                      /*FROM GENERIC LOCATE         */ 00922000
*        DCL SAVNAME         CHAR(45); /*NAME FROM LOCATE    @YL026YB*/ 00923000
*        DCL FS1             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/ 00924000
*        DCL FS2             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/ 00925000
*        DCL N1              FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/ 00926000
*        DCL N2              FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/ 00927000
*                                                                  0293 00928000
*                                                                  0293 00929000
*        COUNT = 0;                                                0294 00930000
*                                                                  0294 00931000
         SLR   @14,@14                                             0294 00932000
         STH   @14,COUNT                                           0294 00933000
*        /************************************************************/ 00934000
*        /*                                                          */ 00935000
*        /* DO A GETMAIN TO OBTAIN A TEMPORARY WORKAREA FOR DATA     */ 00936000
*        /* RETURNED FROM SVC 26.SET REG 0 TO CONTAIN LENGTH OF      */ 00937000
*        /* WORKAREA AND SUBPOOL NUMBER.                             */ 00938000
*        /*                                                          */ 00939000
*        /************************************************************/ 00940000
*                                                                  0295 00941000
*        SWITCH = 0;                                               0295 00942000
         STH   @14,SWITCH                                          0295 00943000
*        RFY (REG0,REG1) RSTD;                                     0296 00944000
*        REG0 = MAX1;                                              0297 00945000
         LH    REG0,@CH00208                                       0297 00946000
*        REG0 = REG0 | SUBPOOL1;                                   0298 00947000
         O     REG0,@CF00176                                       0298 00948000
*        CORESIZE = REG0;                                          0299 00949000
         ST    REG0,CORESIZE                                       0299 00950000
*        GEN (GETMAIN R,LV=(0));                                   0300 00951000
         GETMAIN R,LV=(0)                                               00952000
*        DPTR1 = REG1;                                             0301 00953000
         ST    REG1,DPTR1                                          0301 00954000
*        TEMLN = LENGTH(WORKTEMP);                         /*@YL026YB*/ 00955000
         L     @14,DPTR1                                           0302 00956000
         MVC   TEMLN(2,@14),@CH00208                               0302 00957000
*        /************************************************************/ 00958000
*        /*                                                          */ 00959000
*        /* CHECK THE DSNAME FROM USER TO FIND ITS LENGTH.           */ 00960000
*        /* INITIALIZE PARAMETER LIST FOR CPL.USE MOVE CHARACTER     */ 00961000
*        /* LONG INSTRUCTION TO FILL TEMPDATA WITH BLANKS            */ 00962000
*        /*                                                          */ 00963000
*        /************************************************************/ 00964000
*                                                                  0303 00965000
*        DO COUNT = LENGTH(USENAME) TO 1 BY -1             /*@YL026YB*/ 00966000
*           WHILE(USENAME(COUNT) = BLANK);                 /*@YL026YB*/ 00967000
         LA    @14,44                                              0303 00968000
         STH   @14,COUNT                                           0303 00969000
@DL00303 L     @10,CIRSRCH(,CIRPTR)                                0303 00970000
         ALR   @10,@14                                             0303 00971000
         AL    @10,@CF00251                                        0303 00972000
         CLI   USENAME(@10),X'40'                                  0303 00973000
         BNE   @DC00303                                            0303 00974000
*        END;                                              /*@YL026YB*/ 00975000
         BCTR  @14,0                                               0304 00976000
         STH   @14,COUNT                                           0304 00977000
         LTR   @14,@14                                             0304 00978000
         BP    @DL00303                                            0304 00979000
@DC00303 DS    0H                                                  0305 00980000
*        SAVCNT = COUNT;                                   /*@YL026YB*/ 00981000
         LH    @14,COUNT                                           0305 00982000
         STH   @14,SAVCNT                                          0305 00983000
*        GELENGTH = COUNT + 1;    /*MAKE ROOM FOR PERIOD TO   ZA00645*/ 00984000
         AH    @14,@CH00051                                        0306 00985000
         STC   @14,GELENGTH                                        0306 00986000
*                       /*LIMIT SEARCH TO CORRECT INDEX LEVEL ZA00645*/ 00987000
*        USENAME(GELENGTH) = PERIOD;     /*INSERT PERIOD      ZA00645*/ 00988000
         L     @10,CIRSRCH(,CIRPTR)                                0307 00989000
         ALR   @14,@10                                             0307 00990000
         AL    @14,@CF00251                                        0307 00991000
         MVI   USENAME(@14),X'4B'                                  0307 00992000
*        GNAME = USENAME(1:GELENGTH);                      /*@YL026YB*/ 00993000
         MVI   GNAME+1,C' '                                        0308 00994000
         MVC   GNAME+2(42),GNAME+1                                 0308 00995000
         SLR   @14,@14                                             0308 00996000
         IC    @14,GELENGTH                                        0308 00997000
         BCTR  @14,0                                               0308 00998000
         EX    @14,@SM00307                                        0308 00999000
*        CALL MOVEINST(TEMPDATA);                          /*@YL026YB*/ 01000000
         L     @14,DPTR1                                           0309 01001000
         LA    @14,TEMPDATA(,@14)                                  0309 01002000
         ST    @14,@AL00001                                        0309 01003000
         LA    @01,@AL00001                                        0309 01004000
         BAL   @14,MOVEINST                                        0309 01005000
*        CPLSTOR = ''B;                                    /*@YL026YB*/ 01006000
         XC    CPLSTOR(32),CPLSTOR                                 0310 01007000
*        FPLSTOR = ''B;                                    /*@YL026YB*/ 01008000
         XC    FPLSTOR(24),FPLSTOR                                 0311 01009000
*        WKPTR = ADDR(TEMPDATA);                           /*@YL026YB*/ 01010000
         L     @14,DPTR1                                           0312 01011000
         LA    @10,TEMPDATA(,@14)                                  0312 01012000
         ST    @10,WKPTR                                           0312 01013000
*        /************************************************************/ 01014000
*        /*                                                          */ 01015000
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */ 01016000
*        /*                                                          */ 01017000
*        /************************************************************/ 01018000
*        CTGNAME = ON;                                     /*@YL026YB*/ 01019000
*        CTGCNAME = ON;                                    /*@YL026YB*/ 01020000
         OI    CTGNAME(CTGPLPTR),B'00000110'                       0314 01021000
*        CTGSUPLT = ON;                                    /*@YL026YB*/ 01022000
         OI    CTGSUPLT(CTGPLPTR),B'00010000'                      0315 01023000
*        CTGGENLD = ON;                                    /*@YL026YB*/ 01024000
         OI    CTGGENLD(CTGPLPTR),B'00000001'                      0316 01025000
*        CTGAM0 = ON;                                      /*@YL026YB*/ 01026000
         OI    CTGAM0(CTGPLPTR),B'00000001'                        0317 01027000
*        CTGENT = ADDR(GNAME);                             /*@YL026YB*/ 01028000
         LA    @10,GNAME                                           0318 01029000
         ST    @10,CTGENT(,CTGPLPTR)                               0318 01030000
*        CTGCAT = CIRVOL;                                  /*@YL026YB*/ 01031000
         MVC   CTGCAT(4,CTGPLPTR),CIRVOL(CIRPTR)                   0319 01032000
*        CTGPSWD = CIRPSWD;                                /*@YL026YB*/ 01033000
         MVC   CTGPSWD(4,CTGPLPTR),CIRPSWD(CIRPTR)                 0320 01034000
*        CTGWKA = DPTR1;                                   /*@YL026YB*/ 01035000
*                                                                  0321 01036000
         ST    @14,CTGWKA(,CTGPLPTR)                               0321 01037000
*        /************************************************************/ 01038000
*        /*                                                          */ 01039000
*        /* SET VARIABLES TO INITIAL SUBSTRING COUNT                 */ 01040000
*        /*                                                          */ 01041000
*        /************************************************************/ 01042000
*                                                                  0322 01043000
*        FS1 = 1;                                          /*@YL026YB*/ 01044000
         LA    @14,1                                               0322 01045000
         STH   @14,FS1                                             0322 01046000
*        FS2 = 9;                                          /*@YL026YB*/ 01047000
         MVC   FS2(2),@CH00279                                     0323 01048000
*        N1 = 1;                                           /*@YL026YB*/ 01049000
         STH   @14,N1                                              0324 01050000
*        N2 = 45;                                          /*@YL026YB*/ 01051000
         MVC   N2(2),@CH00206                                      0325 01052000
*        /************************************************************/ 01053000
*        /*                                                          */ 01054000
*        /* CALL SVC 26 FOR GENERIC LOCATE. ON RETURN CHECK RETURN   */ 01055000
*        /* CODE                                                     */ 01056000
*        /*                                                          */ 01057000
*        /************************************************************/ 01058000
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/ 01059000
         LR    REG1,CTGPLPTR                                       0326 01060000
*        GENERATE (CATLG (1));                             /*@YL026YB*/ 01061000
         CATLG (1)                                                      01062000
*        RETNCODE = REG15;                                 /*@YL026YB*/ 01063000
*                                                                  0328 01064000
         ST    REG15,RETNCODE                                      0328 01065000
*        /************************************************************/ 01066000
*        /*                                                          */ 01067000
*        /* IF THE RETURN CODE IS ZERO THEN DETERMINE THE NUMBER     */ 01068000
*        /* OF 44 BYTE NAMES RETURNED. IF THE ENTRY CODE IS HEX 05   */ 01069000
*        /* GO TO PROCEDURE ENTRY 05                                 */ 01070000
*        /*                                                          */ 01071000
*        /************************************************************/ 01072000
*                                                                  0329 01073000
*        IF RETNCODE = 0                                           0329 01074000
*          THEN                                                    0329 01075000
         L     @14,RETNCODE                                        0329 01076000
         LTR   @14,@14                                             0329 01077000
         BNZ   @RF00329                                            0329 01078000
*            DO;                                           /*@YL026YB*/ 01079000
*            REG0 = CORESIZE;                                      0331 01080000
         L     REG0,CORESIZE                                       0331 01081000
*            GEN (GETMAIN R,LV=(0));                               0332 01082000
         GETMAIN R,LV=(0)                                               01083000
*            DPTR = REG1;                                          0333 01084000
         ST    REG1,DPTR                                           0333 01085000
*              CONTROL = (TEMRTLN - 4) / 45;               /*@YL026YB*/ 01086000
         L     @14,DPTR1                                           0334 01087000
         LH    @04,TEMRTLN(,@14)                                   0334 01088000
         SH    @04,@CH00190                                        0334 01089000
         SRDA  @04,32                                              0334 01090000
         D     @04,@CF00206                                        0334 01091000
         STH   @05,CONTROL                                         0334 01092000
*              DO I = 1 TO CONTROL;                        /*@YL026YB*/ 01093000
         LA    @14,1                                               0335 01094000
         B     @DE00335                                            0335 01095000
@DL00335 DS    0H                                                  0336 01096000
*              SAVNAME = WKPTR->TEMBLK;                    /*@YL026YB*/ 01097000
         L     @14,WKPTR                                           0336 01098000
         MVC   SAVNAME(45),TEMBLK(@14)                             0336 01099000
*              IF CIROPT = HEX05                                   0337 01100000
*                THEN                                              0337 01101000
         CLI   CIROPT(CIRPTR),X'05'                                0337 01102000
         BNE   @RF00337                                            0337 01103000
*                  DO;                                     /*@YL026YB*/ 01104000
*                    LAST = FS2;                           /*@YL026YB*/ 01105000
*                                                                  0339 01106000
         MVC   LAST(2),FS2                                         0339 01107000
*                    /************************************************/ 01108000
*                    /*                                              */ 01109000
*                    /* GO TO PROCEDURE ENTRY 05 AND PROCESS 8 BYTE  */ 01110000
*                    /* QUALIFIER AND VOLUMN INFORMATION.            */ 01111000
*                    /*                                              */ 01112000
*                    /************************************************/ 01113000
*                                                                  0340 01114000
*                    CALL ENTRY05(SAVNAME,FS1,FS2,SAVCNT);         0340 01115000
         LA    @14,SAVNAME                                         0340 01116000
         ST    @14,@AL00001                                        0340 01117000
         LA    @14,FS1                                             0340 01118000
         ST    @14,@AL00001+4                                      0340 01119000
         LA    @14,FS2                                             0340 01120000
         ST    @14,@AL00001+8                                      0340 01121000
         LA    @14,SAVCNT                                          0340 01122000
         ST    @14,@AL00001+12                                     0340 01123000
         LA    @01,@AL00001                                        0340 01124000
         BAL   @14,ENTRY05                                         0340 01125000
*                    IF REG15 ^= 0                                 0341 01126000
*                      THEN                                        0341 01127000
         LTR   REG15,REG15                                         0341 01128000
         BZ    @RF00341                                            0341 01129000
*                        RET05 = REG15;                    /*@YL026YB*/ 01130000
*                                                                  0342 01131000
         STH   REG15,RET05                                         0342 01132000
*              /******************************************************/ 01133000
*              /* RESET SUBSTRING COUNT                              */ 01134000
*              /******************************************************/ 01135000
*                                                                  0343 01136000
*              FS1 = FS2 + 1;                              /*@YL026YB*/ 01137000
@RF00341 LA    @14,1                                               0343 01138000
         AH    @14,FS2                                             0343 01139000
         STH   @14,FS1                                             0343 01140000
*              FS2 = FS1 + 8;                              /*@YL026YB*/ 01141000
         AH    @14,@CH00055                                        0344 01142000
         STH   @14,FS2                                             0344 01143000
*              END;                                        /*@YL026YB*/ 01144000
*                                                                  0345 01145000
*              /******************************************************/ 01146000
*              /* TURN OFF FLAGS FOR GENERIC LOCATE AND SET FLAG     */ 01147000
*              /* FOR VSAM LOCATE                                    */ 01148000
*              /******************************************************/ 01149000
*                                                                  0346 01150000
*              ELSE                                                0346 01151000
*                DO;                                       /*@YL026YB*/ 01152000
         B     @RC00337                                            0346 01153000
@RF00337 DS    0H                                                  0347 01154000
*                  CTGSUPLT = OFF;                         /*@YL026YB*/ 01155000
         NI    CTGSUPLT(CTGPLPTR),B'11101111'                      0347 01156000
*                  CTGGENLD = OFF;                         /*@YL026YB*/ 01157000
         NI    CTGGENLD(CTGPLPTR),B'11111110'                      0348 01158000
*                  CTGFUNC = '001'B;                       /*@YL026YB*/ 01159000
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       0349 01160000
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       0349 01161000
*                  COUNT = 0;                              /*@YL026YB*/ 01162000
*                                                                  0350 01163000
         SLR   @14,@14                                             0350 01164000
         STH   @14,COUNT                                           0350 01165000
*        /************************************************************/ 01166000
*        /*                                                          */ 01167000
*        /* CHECK THE NAME FROM GENERIC LOCATE TO FIND ITS TRUE      */ 01168000
*        /* LENGTH.POINT TO NAME AND WKAREA FOR CPL.USE MOVE         */ 01169000
*        /* CHARACTER LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS  */ 01170000
*        /*                                                          */ 01171000
*        /************************************************************/ 01172000
*                                                                  0351 01173000
*        DO COUNT = LENGTH(SAVNAME) TO 1 BY -1             /*@YL026YB*/ 01174000
*           WHILE(SAVNAME(COUNT) = BLANK);                 /*@YL026YB*/ 01175000
         LA    @14,45                                              0351 01176000
         STH   @14,COUNT                                           0351 01177000
@DL00351 LA    @10,SAVNAME-1(@14)                                  0351 01178000
         CLI   0(@10),X'40'                                        0351 01179000
         BNE   @DC00351                                            0351 01180000
*        END;                                              /*@YL026YB*/ 01181000
         BCTR  @14,0                                               0352 01182000
         STH   @14,COUNT                                           0352 01183000
         LTR   @14,@14                                             0352 01184000
         BP    @DL00351                                            0352 01185000
@DC00351 DS    0H                                                  0353 01186000
*        GELENGTH = COUNT;                                 /*@YL026YB*/ 01187000
         LH    @14,COUNT                                           0353 01188000
         STC   @14,GELENGTH                                        0353 01189000
*        GNAME = SAVNAME(1:GELENGTH);                      /*@YL026YB*/ 01190000
         MVI   GNAME+1,C' '                                        0354 01191000
         MVC   GNAME+2(42),GNAME+1                                 0354 01192000
         BCTR  @14,0                                               0354 01193000
         EX    @14,@SM00321                                        0354 01194000
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/ 01195000
         L     @14,DPTR                                            0355 01196000
         LA    @14,QUALDATA(,@14)                                  0355 01197000
         ST    @14,@AL00001                                        0355 01198000
         LA    @01,@AL00001                                        0355 01199000
         BAL   @14,MOVEINST                                        0355 01200000
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/ 01201000
         L     @14,DPTR                                            0356 01202000
         MVC   QUALN(2,@14),@CH00208                               0356 01203000
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/ 01204000
         LA    @10,GENAME                                          0357 01205000
         ST    @10,CTGENT(,CTGPLPTR)                               0357 01206000
*        CTGWKA = DPTR;                                    /*@YL026YB*/ 01207000
*                                                                  0358 01208000
         ST    @14,CTGWKA(,CTGPLPTR)                               0358 01209000
*        /************************************************************/ 01210000
*        /*                                                          */ 01211000
*        /* SET UP PARAMETER LIST FOR FPL                            */ 01212000
*        /*                                                          */ 01213000
*        /************************************************************/ 01214000
*                                                                  0359 01215000
*        CTGNOFLD = 1;                                     /*@YL026YB*/ 01216000
         MVI   CTGNOFLD(CTGPLPTR),X'01'                            0359 01217000
*        CTGFIELD(1) = ADDR(FPLSTOR);                      /*@YL026YB*/ 01218000
         LA    @14,FPLSTOR                                         0360 01219000
         ST    @14,CTGFIELD(,CTGPLPTR)                             0360 01220000
*        CTGFLDNM = ADDR(ENNTRY);                          /*@YL026YB*/ 01221000
         L     @14,CTGFLPTR                                        0361 01222000
         LA    @10,@CC00229                                        0361 01223000
         ST    @10,CTGFLDNM(,@14)                                  0361 01224000
*        CTGFLDNO = 1;                                     /*@YL026YB*/ 01225000
         MVI   CTGFLDNO(@14),X'01'                                 0362 01226000
*        /************************************************************/ 01227000
*        /*                                                          */ 01228000
*        /* CALL SVC 26 FOR VSAM    LOCATE. ON RETURN CHECK RETURN   */ 01229000
*        /* CODE                                                     */ 01230000
*        /*                                                          */ 01231000
*        /************************************************************/ 01232000
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/ 01233000
         LR    REG1,CTGPLPTR                                       0363 01234000
*        GENERATE (CATLG (1));                             /*@YL026YB*/ 01235000
         CATLG (1)                                                      01236000
*        RETNCODE = REG15;                                 /*@YL026YB*/ 01237000
*                                                                  0365 01238000
         ST    REG15,RETNCODE                                      0365 01239000
*        /************************************************************/ 01240000
*        /*                                                          */ 01241000
*        /* IF RETURN CODE IS ZERO, COMPUTE THE VOLUMN COUNT.        */ 01242000
*        /* MOVE VOLUMN INFORMATION TO USER WORK AREA                */ 01243000
*        /*                                                          */ 01244000
*        /************************************************************/ 01245000
*                                                                  0366 01246000
*        IF  RETNCODE = 0                                          0366 01247000
*          THEN                                                    0366 01248000
         L     @14,RETNCODE                                        0366 01249000
         LTR   @14,@14                                             0366 01250000
         BNZ   @RF00366                                            0366 01251000
*            DO;                                           /*@YL026YB*/ 01252000
*              IF AREALN < RTNQLN                          /*@YL026YB*/ 01253000
*                THEN                                      /*@YL026YB*/ 01254000
         L     @14,CIRWA(,CIRPTR)                                  0368 01255000
         LH    @14,AREALN(,@14)                                    0368 01256000
         L     @10,DPTR                                            0368 01257000
         CH    @14,RTNQLN(,@10)                                    0368 01258000
         BNL   @RF00368                                            0368 01259000
*                  DO;                                     /*@YL026YB*/ 01260000
*                    CIRLOCRC = 44;                        /*@YL026YB*/ 01261000
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0370 01262000
*                    RETNCODE = 4;                         /*@YL026YB*/ 01263000
         MVC   RETNCODE(4),@CF00190                                0371 01264000
*                    GOTO FRECORE;                         /*@YL026YB*/ 01265000
         B     FRECORE                                             0372 01266000
*                  END;                                    /*@YL026YB*/ 01267000
*              DATALN = RTNQLN;                            /*@YL026YB*/ 01268000
@RF00368 L     @14,CIRWA(,CIRPTR)                                  0374 01269000
         L     @10,DPTR                                            0374 01270000
         MVC   DATALN(2,@14),RTNQLN(@10)                           0374 01271000
*              VOLCNT = CTGFLNG(1) / LENGTH(VOLAREA);      /*@YL026YB*/ 01272000
         L     @10,CTGFLPTR                                        0375 01273000
         L     @04,CTGFLNG(,@10)                                   0375 01274000
         SRDA  @04,32                                              0375 01275000
         D     @04,@CF00145                                        0375 01276000
         STC   @05,VOLCNT                                          0375 01277000
*              DATAREA(N1:N2) = SAVNAME;                   /*@YL026YB*/ 01278000
         LH    @10,N1                                              0376 01279000
         ALR   @10,@14                                             0376 01280000
         LH    @04,N2                                              0376 01281000
         LH    @09,N1                                              0376 01282000
         LCR   @09,@09                                             0376 01283000
         ALR   @09,@04                                             0376 01284000
         EX    @09,@SM00323                                        0376 01285000
*              FIRST = N2 + 1;                             /*@YL026YB*/ 01286000
         LA    @10,1                                               0377 01287000
         ALR   @04,@10                                             0377 01288000
         STH   @04,FIRST                                           0377 01289000
*              DATAREA(FIRST) = VOLCNT;                    /*@YL026YB*/ 01290000
         STC   @05,DATAREA-1(@04,@14)                              0378 01291000
*              LAST = FIRST;                               /*@YL026YB*/ 01292000
         STH   @04,LAST                                            0379 01293000
*              DO  K = 1 TO VOLCNT;                        /*@YL026YB*/ 01294000
         B     @DE00380                                            0380 01295000
@DL00380 DS    0H                                                  0381 01296000
*              FIRST = LAST + 1;                           /*@YL026YB*/ 01297000
         LA    @14,1                                               0381 01298000
         AH    @14,LAST                                            0381 01299000
         STH   @14,FIRST                                           0381 01300000
*              LAST = FIRST + (LENGTH(VOLDATA) - 1);       /*@YL026YB*/ 01301000
         LA    @09,11                                              0382 01302000
         ALR   @09,@14                                             0382 01303000
         STH   @09,LAST                                            0382 01304000
*              VOLAREA = CTGFLPT(1)->VOLBLK(1:LENGTH(VOLAREA));    0383 01305000
         L     @08,CTGFLPTR                                        0383 01306000
         L     @07,CTGFLPT(,@08)                                   0383 01307000
         MVC   VOLAREA(15),VOLBLK(@07)                             0383 01308000
*              DATAREA(FIRST:LAST) = VOLDATA;              /*@YL026YB*/ 01309000
         L     @06,CIRWA(,CIRPTR)                                  0384 01310000
         ALR   @06,@14                                             0384 01311000
         SLR   @09,@14                                             0384 01312000
         EX    @09,@SM00325                                        0384 01313000
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(VOLDATA);  /*@YL026YB*/ 01314000
         AH    @07,@CH00123                                        0385 01315000
         ST    @07,CTGFLPT(,@08)                                   0385 01316000
*              END;                                        /*@YL026YB*/ 01317000
*                                                                  0386 01318000
         AH    @10,@CH00051                                        0386 01319000
@DE00380 ST    @10,K                                               0386 01320000
         SLR   @14,@14                                             0386 01321000
         IC    @14,VOLCNT                                          0386 01322000
         CR    @10,@14                                             0386 01323000
         BNH   @DL00380                                            0386 01324000
*              /******************************************************/ 01325000
*              /* RESET SUBSTRING COUNT                              */ 01326000
*              /******************************************************/ 01327000
*                                                                  0387 01328000
*              N1 = LAST + 1;                              /*@YL026YB*/ 01329000
         LA    @14,1                                               0387 01330000
         AH    @14,LAST                                            0387 01331000
         STH   @14,N1                                              0387 01332000
*              N2 = N1 + (LENGTH(SAVNAME) - 1);            /*@YL026YB*/ 01333000
         AH    @14,@CH00183                                        0388 01334000
         STH   @14,N2                                              0388 01335000
*              END;                                        /*@YL026YB*/ 01336000
*          ELSE                                            /*@YL026YB*/ 01337000
*            RET06 = REG15;                                /*@YL026YB*/ 01338000
         B     @RC00366                                            0390 01339000
@RF00366 STH   REG15,RET06                                         0390 01340000
*              END;                                        /*@YL026YB*/ 01341000
*                                                                  0391 01342000
@RC00366 DS    0H                                                  0392 01343000
*              /******************************************************/ 01344000
*              /*                                                    */ 01345000
*              /* ADJUST SUBSTRING VARIABLES AND POINT TO NEXT 44    */ 01346000
*              /* BYTE  NAME                                         */ 01347000
*              /*                                                    */ 01348000
*              /******************************************************/ 01349000
*                                                                  0392 01350000
*              WKPTR = WKPTR + 45;                         /*@YL026YB*/ 01351000
@RC00337 LA    @14,45                                              0392 01352000
         AL    @14,WKPTR                                           0392 01353000
         ST    @14,WKPTR                                           0392 01354000
*              END;                                        /*@YL026YB*/ 01355000
*                                                                  0393 01356000
         LA    @14,1                                               0393 01357000
         AL    @14,I                                               0393 01358000
@DE00335 ST    @14,I                                               0393 01359000
         CH    @14,CONTROL                                         0393 01360000
         BNH   @DL00335                                            0393 01361000
*              /******************************************************/ 01362000
*              /*                                                    */ 01363000
*              /* PUT HEX FF AS THE LAST BYTE IN USER WORK AREA TO   */ 01364000
*              /* TO INDICATE END OF DATA                            */ 01365000
*              /*                                                    */ 01366000
*              /******************************************************/ 01367000
*                                                                  0394 01368000
*              ENDBYTE = LAST + 1;                         /*@YL026YB*/ 01369000
         LA    ENDBYTE,1                                           0394 01370000
         AH    ENDBYTE,LAST                                        0394 01371000
*              DATAREA(ENDBYTE) = FOXES;                   /*@YL026YB*/ 01372000
         L     @14,CIRWA(,CIRPTR)                                  0395 01373000
         ALR   @14,ENDBYTE                                         0395 01374000
         MVI   DATAREA-1(@14),X'FF'                                0395 01375000
*              RETNCODE = 0;                               /*@YL026YB*/ 01376000
         SLR   @14,@14                                             0396 01377000
         ST    @14,RETNCODE                                        0396 01378000
*              GOTO FRECORE;                                       0397 01379000
         B     FRECORE                                             0397 01380000
*              END;                                        /*@YL026YB*/ 01381000
*            /********************************************************/ 01382000
*            /*                                                      */ 01383000
*            /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN  */ 01384000
*            /* TABLE                                                */ 01385000
*            /********************************************************/ 01386000
*            ELSE                                                  0399 01387000
*              DO;                                         /*@YL026YB*/ 01388000
@RF00329 DS    0H                                                  0400 01389000
*                DO I = 1 TO 8;                            /*@YL026YB*/ 01390000
         LA    @14,1                                               0400 01391000
         ST    @14,I                                               0400 01392000
@DL00400 DS    0H                                                  0401 01393000
*                 IF RTNTABLE(I) = RETNCODE                        0401 01394000
*                   THEN                                           0401 01395000
         SLA   @14,2                                               0401 01396000
         L     @14,RTNTABLE-4(@14)                                 0401 01397000
         C     @14,RETNCODE                                        0401 01398000
         BNE   @RF00401                                            0401 01399000
*                    DO;                                   /*@YL026YB*/ 01400000
*                    SWITCH = 1;                           /*@YL026YB*/ 01401000
         MVC   SWITCH(2),@CH00051                                  0403 01402000
*                    CIRLOCRC = REG15;                     /*@YL026YB*/ 01403000
         STC   REG15,CIRLOCRC(,CIRPTR)                             0404 01404000
*                    RETNCODE = 4;                         /*@YL026YB*/ 01405000
         MVC   RETNCODE(4),@CF00190                                0405 01406000
*                    GOTO FRECORE;                         /*@YL026YB*/ 01407000
         B     FRECORE                                             0406 01408000
*                    END;                                  /*@YL026YB*/ 01409000
*                ELSE;                                     /*@YL026YB*/ 01410000
@RF00401 DS    0H                                                  0409 01411000
*            END;                                          /*@YL026YB*/ 01412000
*                                                                  0409 01413000
         LA    @14,1                                               0409 01414000
         AL    @14,I                                               0409 01415000
         ST    @14,I                                               0409 01416000
         CH    @14,@CH00055                                        0409 01417000
         BNH   @DL00400                                            0409 01418000
*            /********************************************************/ 01419000
*            /*                                                      */ 01420000
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */ 01421000
*            /* TABLE, SET THE RETURN CODE TO 12                     */ 01422000
*            /*                                                      */ 01423000
*            /********************************************************/ 01424000
*                                                                  0410 01425000
*            IF SWITCH ^= 1                                        0410 01426000
*              THEN                                                0410 01427000
         CLC   SWITCH(2),@CH00051                                  0410 01428000
         BE    @RF00410                                            0410 01429000
*                RETNCODE = 12;                            /*@YL026YB*/ 01430000
         MVC   RETNCODE(4),@CF00123                                0411 01431000
*        END;                                              /*@YL026YB*/ 01432000
*                                                                  0412 01433000
@RF00410 DS    0H                                                  0413 01434000
*        /************************************************************/ 01435000
*        /*                                                          */ 01436000
*        /* FREE TEMPORARY WORKAREA. RETURN TO CALLER                */ 01437000
*        /*                                                          */ 01438000
*        /************************************************************/ 01439000
*                                                                  0413 01440000
*FRECORE:REG1 = DPTR1;                                             0413 01441000
FRECORE  L     REG1,DPTR1                                          0413 01442000
*        REG0 = CORESIZE;                                          0414 01443000
         L     REG0,CORESIZE                                       0414 01444000
*        GEN (FREEMAIN R,LV=(0),A=(1));                            0415 01445000
         FREEMAIN R,LV=(0),A=(1)                                        01446000
*        IF RETNCODE = 0                                           0416 01447000
*          THEN                                                    0416 01448000
         ICM   @14,15,RETNCODE                                     0416 01449000
         BNZ   @RF00416                                            0416 01450000
*            DO;                                           /*@YL026YB*/ 01451000
*              REG1 = DPTR;                                /*@YL026YB*/ 01452000
         L     REG1,DPTR                                           0418 01453000
*              GEN (FREEMAIN R,LV=(0),A=(1));              /*@YL026YB*/ 01454000
         FREEMAIN R,LV=(0),A=(1)                                        01455000
*              END;                                        /*@YL026YB*/ 01456000
*        RFY (REG0,REG1) UNRSTD;                                   0421 01457000
*        END;                                              /*@YL026YB*/ 01458000
*                                                                  0422 01459000
@EL00005 DS    0H                                                  0422 01460000
@EF00005 DS    0H                                                  0422 01461000
@ER00005 LM    @14,@12,@SA00005                                    0422 01462000
         BR    @14                                                 0422 01463000
*/********************************************************************/ 01464000
*/*                                                                  */ 01465000
*/* ENTRY05 IS THE PROCEDURE TO TAKE A 44 BYTE NAME AND ISSUE SVC 26 */ 01466000
*/* FOR A VSAM LOCATE TO RETURN VOLUMN INFORMATION                   */ 01467000
*/*                                                                  */ 01468000
*/********************************************************************/ 01469000
*                                                                  0423 01470000
*ENTRY05: PROCEDURE(SVNAME,FT1,FT2,USECNT);                /*@YL026YB*/ 01471000
ENTRY05  STM   @14,@12,@SA00006                                    0423 01472000
         MVC   @PC00006(16),0(@01)                                 0423 01473000
*        DCL SVNAME          CHAR(45);/*NAME FROM LOCATE     @YL026YB*/ 01474000
*        DCL FT1             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/ 01475000
*        DCL FT2             FIXED(15);/*SUBSTRING VARIABLE  @YL026YB*/ 01476000
*        DCL USECNT          FIXED(15);/*LENGTH OF NAME      @YL026YB*/ 01477000
*        /************************************************************/ 01478000
*        /*                                                          */ 01479000
*        /* TURN ON FLAGS FOR GENERIC LOCATE                         */ 01480000
*        /*                                                          */ 01481000
*        /************************************************************/ 01482000
*        CTGSUPLT = OFF;                                   /*@YL026YB*/ 01483000
         NI    CTGSUPLT(CTGPLPTR),B'11101111'                      0428 01484000
*        CTGGENLD = OFF;                                   /*@YL026YB*/ 01485000
         NI    CTGGENLD(CTGPLPTR),B'11111110'                      0429 01486000
*        CTGFUNC = '001'B;                                 /*@YL026YB*/ 01487000
         NI    CTGFUNC(CTGPLPTR),B'00111111'                       0430 01488000
         OI    CTGFUNC(CTGPLPTR),B'00100000'                       0430 01489000
*        COUNT = 0;                                        /*@YL026YB*/ 01490000
         SLR   @14,@14                                             0431 01491000
         STH   @14,COUNT                                           0431 01492000
*        SWITCH = 0;                                       /*@YL026YB*/ 01493000
         STH   @14,SWITCH                                          0432 01494000
*        CNT = 0;                                          /*@YL026YB*/ 01495000
         STH   @14,CNT                                             0433 01496000
*        CNN = 0;                                          /*@YL026YB*/ 01497000
         STH   @14,CNN                                             0434 01498000
*        RFY (REG1) RSTD;                                          0435 01499000
*                                                                  0435 01500000
*        /************************************************************/ 01501000
*        /*                                                          */ 01502000
*        /* CHECK THE NAME FROM GENERIC LOCATE TO FIND ITS TRUE      */ 01503000
*        /* LENGTH.POINT TO NAME AND WKAREA FOR CPL.USE MOVE         */ 01504000
*        /* CHARACTER LONG INSTRUCTION TO FILL QUALDATA WITH BLANKS  */ 01505000
*        /*                                                          */ 01506000
*        /************************************************************/ 01507000
*                                                                  0436 01508000
*        DO COUNT = LENGTH(SVNAME) TO 1 BY -1              /*@YL026YB*/ 01509000
*           WHILE(SVNAME(COUNT) = BLANK);                  /*@YL026YB*/ 01510000
         LA    @14,45                                              0436 01511000
         STH   @14,COUNT                                           0436 01512000
@DL00436 L     @10,@PC00006                                        0436 01513000
         ALR   @10,@14                                             0436 01514000
         AL    @10,@CF00251                                        0436 01515000
         CLI   SVNAME(@10),X'40'                                   0436 01516000
         BNE   @DC00436                                            0436 01517000
*        END;                                              /*@YL026YB*/ 01518000
         BCTR  @14,0                                               0437 01519000
         STH   @14,COUNT                                           0437 01520000
         LTR   @14,@14                                             0437 01521000
         BP    @DL00436                                            0437 01522000
@DC00436 DS    0H                                                  0438 01523000
*        GELENGTH = COUNT;                                 /*@YL026YB*/ 01524000
         LH    @14,COUNT                                           0438 01525000
         STC   @14,GELENGTH                                        0438 01526000
*        GNAME = SVNAME(1:GELENGTH);                       /*@YL026YB*/ 01527000
         MVI   GNAME+1,C' '                                        0439 01528000
         MVC   GNAME+2(42),GNAME+1                                 0439 01529000
         BCTR  @14,0                                               0439 01530000
         L     @10,@PC00006                                        0439 01531000
         EX    @14,@SM00327                                        0439 01532000
*        CALL MOVEINST(QUALDATA);                          /*@YL026YB*/ 01533000
         L     @14,DPTR                                            0440 01534000
         LA    @14,QUALDATA(,@14)                                  0440 01535000
         ST    @14,@AL00001                                        0440 01536000
         LA    @01,@AL00001                                        0440 01537000
         BAL   @14,MOVEINST                                        0440 01538000
*        QUALN = LENGTH(QUALAREA);                         /*@YL026YB*/ 01539000
         L     @14,DPTR                                            0441 01540000
         MVC   QUALN(2,@14),@CH00208                               0441 01541000
*        CTGENT = ADDR(GENAME);                            /*@YL026YB*/ 01542000
         LA    @10,GENAME                                          0442 01543000
         ST    @10,CTGENT(,CTGPLPTR)                               0442 01544000
*        CTGWKA = DPTR;                                    /*@YL026YB*/ 01545000
*                                                                  0443 01546000
         ST    @14,CTGWKA(,CTGPLPTR)                               0443 01547000
*        /************************************************************/ 01548000
*        /*                                                          */ 01549000
*        /* SET UP PARAMETER LIST FOR FPL                            */ 01550000
*        /*                                                          */ 01551000
*        /************************************************************/ 01552000
*                                                                  0444 01553000
*        CTGNOFLD = 1;                                     /*@YL026YB*/ 01554000
         MVI   CTGNOFLD(CTGPLPTR),X'01'                            0444 01555000
*        CTGFIELD(1) = ADDR(FPLSTOR);                      /*@YL026YB*/ 01556000
         LA    @14,FPLSTOR                                         0445 01557000
         ST    @14,CTGFIELD(,CTGPLPTR)                             0445 01558000
*        CTGFLDNM = ADDR(ENNTRY);                          /*@YL026YB*/ 01559000
         L     @14,CTGFLPTR                                        0446 01560000
         LA    @10,@CC00229                                        0446 01561000
         ST    @10,CTGFLDNM(,@14)                                  0446 01562000
*        CTGFLDNO = 1;                                     /*@YL026YB*/ 01563000
         MVI   CTGFLDNO(@14),X'01'                                 0447 01564000
*        /************************************************************/ 01565000
*        /*                                                          */ 01566000
*        /* CALL SVC 26 FOR VSAM    LOCATE. ON RETURN CHECK RETURN   */ 01567000
*        /* CODE                                                     */ 01568000
*        /*                                                          */ 01569000
*        /************************************************************/ 01570000
*        REG1 = CTGPLPTR;                                  /*@YL026YB*/ 01571000
         LR    REG1,CTGPLPTR                                       0448 01572000
*        GENERATE (CATLG (1));                             /*@YL026YB*/ 01573000
         CATLG (1)                                                      01574000
*        RETNCODE = REG15;                                 /*@YL026YB*/ 01575000
*                                                                  0450 01576000
         ST    REG15,RETNCODE                                      0450 01577000
*        /************************************************************/ 01578000
*        /*                                                          */ 01579000
*        /* IF RETURN CODE IS ZERO, COMPUTE THE VOLUMN COUNT.        */ 01580000
*        /* MOVE VOLUMN INFORMATION TO USER WORK AREA                */ 01581000
*        /*                                                          */ 01582000
*        /************************************************************/ 01583000
*                                                                  0451 01584000
*        IF  RETNCODE = 0                                          0451 01585000
*          THEN                                                    0451 01586000
         L     @14,RETNCODE                                        0451 01587000
         LTR   @14,@14                                             0451 01588000
         BNZ   @RF00451                                            0451 01589000
*            DO;                                           /*@YL026YB*/ 01590000
*              IF AREALN < RTNQLN                          /*@YL026YB*/ 01591000
*                THEN                                      /*@YL026YB*/ 01592000
         L     @14,CIRWA(,CIRPTR)                                  0453 01593000
         LH    @14,AREALN(,@14)                                    0453 01594000
         L     @10,DPTR                                            0453 01595000
         CH    @14,RTNQLN(,@10)                                    0453 01596000
         BNL   @RF00453                                            0453 01597000
*                  DO;                                     /*@YL026YB*/ 01598000
*                    CIRLOCRC = 44;                        /*@YL026YB*/ 01599000
         MVI   CIRLOCRC(CIRPTR),X'2C'                              0455 01600000
*                    RETURN CODE(4);                       /*@YL026YB*/ 01601000
         LA    @15,4                                               0456 01602000
         L     @14,@SA00006                                        0456 01603000
         LM    @00,@12,@SA00006+8                                  0456 01604000
         BR    @14                                                 0456 01605000
*                  END;                                    /*@YL026YB*/ 01606000
*              DATALN = RTNQLN;                            /*@YL026YB*/ 01607000
@RF00453 L     @14,CIRWA(,CIRPTR)                                  0458 01608000
         L     @10,DPTR                                            0458 01609000
         MVC   DATALN(2,@14),RTNQLN(@10)                           0458 01610000
*              VOLCNT = CTGFLNG(1) / LENGTH(VOLAREA);      /*@YL026YB*/ 01611000
         L     @09,CTGFLPTR                                        0459 01612000
         L     @04,CTGFLNG(,@09)                                   0459 01613000
         SRDA  @04,32                                              0459 01614000
         D     @04,@CF00145                                        0459 01615000
         STC   @05,VOLCNT                                          0459 01616000
*              CNT = USECNT + 2;                           /*@YL026YB*/ 01617000
         L     @04,@PC00006+12                                     0460 01618000
         LA    @00,2                                               0460 01619000
         AH    @00,USECNT(,@04)                                    0460 01620000
         STH   @00,CNT                                             0460 01621000
*              CNN = COUNT;                                /*@YL026YB*/ 01622000
         LH    @04,COUNT                                           0461 01623000
         STH   @04,CNN                                             0461 01624000
*              QULTYPE = '07'X;                            /*@YL026YB*/ 01625000
         MVI   QULTYPE,X'07'                                       0462 01626000
*              QULPTR = ADDR(QUALDATA);                    /*@YL026YB*/ 01627000
         LA    @10,QUALDATA(,@10)                                  0463 01628000
         ST    @10,QULPTR                                          0463 01629000
*              QULBUF = SVNAME;                            /*@YL026YB*/ 01630000
         L     @10,@PC00006                                        0464 01631000
         MVC   QULBUF(45),SVNAME(@10)                              0464 01632000
*              QULNAME = QUALIFY(CNT:CNN);                 /*@YL026YB*/ 01633000
         MVI   QULNAME+1,C' '                                      0465 01634000
         MVC   QULNAME+2(6),QULNAME+1                              0465 01635000
         SLR   @04,@00                                             0465 01636000
         LR    @10,@00                                             0465 01637000
         LA    @09,QUALIFY-1(@10)                                  0465 01638000
         EX    @04,@SM00329                                        0465 01639000
*              DATAREA(FT1:FT2) = TYPE01;                  /*@YL026YB*/ 01640000
         L     @10,@PC00006+4                                      0466 01641000
         LH    @10,FT1(,@10)                                       0466 01642000
         ALR   @10,@14                                             0466 01643000
         L     @04,@PC00006+8                                      0466 01644000
         LH    @04,FT2(,@04)                                       0466 01645000
         L     @09,@PC00006+4                                      0466 01646000
         LH    @09,FT1(,@09)                                       0466 01647000
         LCR   @09,@09                                             0466 01648000
         ALR   @09,@04                                             0466 01649000
         EX    @09,@SM00313                                        0466 01650000
*              FIRST = FT2 + 1;                            /*@YL026YB*/ 01651000
         LA    @10,1                                               0467 01652000
         ALR   @04,@10                                             0467 01653000
         STH   @04,FIRST                                           0467 01654000
*              DATAREA(FIRST) = VOLCNT;                    /*@YL026YB*/ 01655000
         STC   @05,DATAREA-1(@04,@14)                              0468 01656000
*              LAST = FIRST;                               /*@YL026YB*/ 01657000
         STH   @04,LAST                                            0469 01658000
*              DO  J = 1 TO VOLCNT;                        /*@YL026YB*/ 01659000
         B     @DE00470                                            0470 01660000
@DL00470 DS    0H                                                  0471 01661000
*              FIRST = LAST + 1;                           /*@YL026YB*/ 01662000
         LA    @14,1                                               0471 01663000
         AH    @14,LAST                                            0471 01664000
         STH   @14,FIRST                                           0471 01665000
*              LAST = FIRST + (LENGTH(VOLDATA) - 1);       /*@YL026YB*/ 01666000
         LA    @00,11                                              0472 01667000
         ALR   @00,@14                                             0472 01668000
         STH   @00,LAST                                            0472 01669000
*              VOLAREA = CTGFLPT(1)->VOLBLK(1:LENGTH(VOLAREA));    0473 01670000
         L     @09,CTGFLPTR                                        0473 01671000
         L     @08,CTGFLPT(,@09)                                   0473 01672000
         MVC   VOLAREA(15),VOLBLK(@08)                             0473 01673000
*              DATAREA(FIRST:LAST) = VOLDATA;              /*@YL026YB*/ 01674000
         L     @07,CIRWA(,CIRPTR)                                  0474 01675000
         ALR   @07,@14                                             0474 01676000
         SLR   @00,@14                                             0474 01677000
         LR    @14,@00                                             0474 01678000
         EX    @14,@SM00317                                        0474 01679000
*              CTGFLPT(1) = CTGFLPT(1) + LENGTH(VOLDATA);  /*@YL026YB*/ 01680000
         AH    @08,@CH00123                                        0475 01681000
         ST    @08,CTGFLPT(,@09)                                   0475 01682000
*              END;                                        /*@YL026YB*/ 01683000
*                                                                  0476 01684000
         AH    @10,@CH00051                                        0476 01685000
@DE00470 ST    @10,J                                               0476 01686000
         SLR   @14,@14                                             0476 01687000
         IC    @14,VOLCNT                                          0476 01688000
         CR    @10,@14                                             0476 01689000
         BNH   @DL00470                                            0476 01690000
*              /******************************************************/ 01691000
*              /* RESET SUBSTRING COUNT                              */ 01692000
*              /******************************************************/ 01693000
*                                                                  0477 01694000
*              FT2 = LAST;                                 /*@YL026YB*/ 01695000
         L     @14,@PC00006+8                                      0477 01696000
         MVC   FT2(2,@14),LAST                                     0477 01697000
*              RETURN CODE(0);                             /*@YL026YB*/ 01698000
         SLR   @15,@15                                             0478 01699000
         L     @14,@SA00006                                        0478 01700000
         LM    @00,@12,@SA00006+8                                  0478 01701000
         BR    @14                                                 0478 01702000
*              END;                                        /*@YL026YB*/ 01703000
*            /********************************************************/ 01704000
*            /*                                                      */ 01705000
*            /* COMPARE RETURN CODE FROM SVC 26 WITH ERROR CODES IN  */ 01706000
*            /* TABLE                                                */ 01707000
*            /********************************************************/ 01708000
*            ELSE                                                  0480 01709000
*              DO;                                         /*@YL026YB*/ 01710000
@RF00451 DS    0H                                                  0481 01711000
*                DO I = 1 TO 8;                            /*@YL026YB*/ 01712000
         LA    @14,1                                               0481 01713000
         ST    @14,I                                               0481 01714000
@DL00481 DS    0H                                                  0482 01715000
*              IF RTNTABLE(I) = RETNCODE                           0482 01716000
*                THEN                                              0482 01717000
         SLA   @14,2                                               0482 01718000
         L     @14,RTNTABLE-4(@14)                                 0482 01719000
         C     @14,RETNCODE                                        0482 01720000
         BNE   @RF00482                                            0482 01721000
*                  DO;                                     /*@YL026YB*/ 01722000
*                    SWITCH = 1;                           /*@YL026YB*/ 01723000
         MVC   SWITCH(2),@CH00051                                  0484 01724000
*                    CIRLOCRC = REG15;                     /*@YL026YB*/ 01725000
         STC   REG15,CIRLOCRC(,CIRPTR)                             0485 01726000
*                    RETURN CODE(4);                       /*@YL026YB*/ 01727000
         LA    @15,4                                               0486 01728000
         L     @14,@SA00006                                        0486 01729000
         LM    @00,@12,@SA00006+8                                  0486 01730000
         BR    @14                                                 0486 01731000
*                  END;                                    /*@YL026YB*/ 01732000
*                ELSE;                                     /*@YL026YB*/ 01733000
@RF00482 DS    0H                                                  0489 01734000
*            END;                                          /*@YL026YB*/ 01735000
*                                                                  0489 01736000
         LA    @14,1                                               0489 01737000
         AL    @14,I                                               0489 01738000
         ST    @14,I                                               0489 01739000
         CH    @14,@CH00055                                        0489 01740000
         BNH   @DL00481                                            0489 01741000
*            /********************************************************/ 01742000
*            /*                                                      */ 01743000
*            /* IF THE RETURN CODE DOES NOT MATCH A NUMBER IN THE    */ 01744000
*            /* TABLE, SET THE RETURN CODE TO 12                     */ 01745000
*            /*                                                      */ 01746000
*            /********************************************************/ 01747000
*                                                                  0490 01748000
*            IF SWITCH ^= 1                                        0490 01749000
*              THEN                                                0490 01750000
         CLC   SWITCH(2),@CH00051                                  0490 01751000
         BE    @RF00490                                            0490 01752000
*                RETURN CODE(12);                          /*@YL026YB*/ 01753000
         LA    @15,12                                              0491 01754000
         L     @14,@SA00006                                        0491 01755000
         LM    @00,@12,@SA00006+8                                  0491 01756000
         BR    @14                                                 0491 01757000
*        END;                                              /*@YL026YB*/ 01758000
*        END;                                              /*@YL026YB*/ 01759000
*                                                                  0493 01760000
@EL00006 DS    0H                                                  0493 01761000
@EF00006 DS    0H                                                  0493 01762000
@ER00006 LM    @14,@12,@SA00006                                    0493 01763000
         BR    @14                                                 0493 01764000
*/********************************************************************/ 01765000
*/*                                                                  */ 01766000
*/* THIS PROCEDURE MOVES BLANKS INTO A WORKAREA GREATER THAN 256     */ 01767000
*/* BYTES. IT USES THE MVCL INSTRUCTION BY SETTING UP EVEN -ODD      */ 01768000
*/* PAIRS OF REGISTERS                                               */ 01769000
*/*                                                                  */ 01770000
*/********************************************************************/ 01771000
*                                                                  0494 01772000
*MOVEINST: PROCEDURE(PARM1);                               /*@YL026YB*/ 01773000
MOVEINST STM   @14,@12,12(@13)                                     0494 01774000
         MVC   @PC00007(4),0(@01)                                  0494 01775000
*        DCL PARM1                 CHAR(4996); /*WORK AREA   @YL026YB*/ 01776000
*        DCL R4                    REG(4)  PTR  RSTD;/*WKAREA PTR    */ 01777000
*        DCL R5                    REG(5)       RSTD;/*WKAREA LENGTH */ 01778000
*        DCL R6                    REG(6)  PTR  RSTD;/*DATA POINTER  */ 01779000
*        DCL R7                    REG(7)       RSTD;/*DATA + LENGTH */ 01780000
*                                                                  0499 01781000
*        /************************************************************/ 01782000
*        /*                                                          */ 01783000
*        /* SET UP REGISTERS FOR THE MVCL INSTRUCTION,THEN FREE      */ 01784000
*        /* THE REGISTERS.                                           */ 01785000
*        /*                                                          */ 01786000
*        /************************************************************/ 01787000
*                                                                  0500 01788000
*        R4 = ADDR(PARM1);                                         0500 01789000
         L     R4,@PC00007                                         0500 01790000
*        R5 = LENGTH(PARM1);                                       0501 01791000
         LH    R5,@CH00215                                         0501 01792000
*        R6 = ADDR(BLANK);                                         0502 01793000
         LA    R6,@CB00160                                         0502 01794000
*        R7 = '40000001'X;                                         0503 01795000
         L     R7,@CF00304                                         0503 01796000
*        MVCL  (R4,R6);                                            0504 01797000
         MVCL  R4,R6                                               0504 01798000
*        RESPECIFY(R4,R5,R6,R7) UNRSTD;                            0505 01799000
*        END;                                                      0506 01800000
@EL00007 DS    0H                                                  0506 01801000
@EF00007 DS    0H                                                  0506 01802000
@ER00007 LM    @14,@12,12(@13)                                     0506 01803000
         BR    @14                                                 0506 01804000
@PB00007 DS    0H                                                  0507 01805000
*        RETURN CODE(RETNCODE);                            /*@YL026YB*/ 01806000
         L     @10,RETNCODE                                        0507 01807000
         L     @13,4(,@13)                                         0507 01808000
         L     @00,@SIZDATD                                        0507 01809000
         LR    @01,@11                                             0507 01810000
         FREEMAIN R,LV=(0),A=(1)                                        01811000
         LR    @15,@10                                             0507 01812000
         L     @14,12(,@13)                                        0507 01813000
         LM    @00,@12,20(@13)                                     0507 01814000
         BR    @14                                                 0507 01815000
*        END IKJEHCIR                                      /*@YL026YB*/ 01816000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01817000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 01818000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 01819000
*;                                                                 0508 01820000
@DATA    DS    0H                                                       01821000
@CH00051 DC    H'1'                                                     01822000
@CH00090 DC    H'3'                                                     01823000
@CH00055 DC    H'8'                                                     01824000
@CH00279 DC    H'9'                                                     01825000
@CH00183 DC    H'44'                                                    01826000
@CH00215 DC    H'4996'                                                  01827000
@CH00208 DC    H'5000'                                                  01828000
@SM00307 MVC   GNAME(0),USENAME(@10)                                    01829000
@SM00311 MVC   QULNAME(0),0(@03)                                        01830000
@SM00313 MVC   DATAREA-1(0,@10),TYPE01                                  01831000
@SM00317 MVC   DATAREA-1(0,@07),VOLDATA                                 01832000
@SM00321 MVC   GNAME(0),SAVNAME                                         01833000
@SM00323 MVC   DATAREA-1(0,@10),SAVNAME                                 01834000
@SM00325 MVC   DATAREA-1(0,@06),VOLDATA                                 01835000
@SM00327 MVC   GNAME(0),SVNAME(@10)                                     01836000
@SM00329 MVC   QULNAME(0),0(@09)                                        01837000
@DATD    DSECT                                                          01838000
         DS    0F                                                       01839000
@SA00001 DS    18F                                                      01840000
@SA00002 DS    15F                                                      01841000
@SA00003 DS    15F                                                      01842000
@SA00004 DS    15F                                                      01843000
@SA00005 DS    15F                                                      01844000
@PC00007 DS    1F                                                       01845000
@SA00006 DS    15F                                                      01846000
@PC00006 DS    4F                                                       01847000
@AL00001 DS    4A                                                       01848000
IKJEHCIR CSECT                                                          01849000
         DS    0F                                                       01850000
@CF00190 DC    F'4'                                                     01851000
@CH00190 EQU   @CF00190+2                                               01852000
@CF00123 DC    F'12'                                                    01853000
@CH00123 EQU   @CF00123+2                                               01854000
@CF00145 DC    F'15'                                                    01855000
@CH00145 EQU   @CF00145+2                                               01856000
@CF00206 DC    F'45'                                                    01857000
@CH00206 EQU   @CF00206+2                                               01858000
@CF00251 DC    F'-1'                                                    01859000
@CF00176 DC    XL4'01000000'                                            01860000
@CF00304 DC    XL4'40000001'                                            01861000
@DATD    DSECT                                                          01862000
         DS    0D                                                       01863000
CTGFLPTR DS    A                                                        01864000
CORESIZE DS    F                                                        01865000
RETNCODE DS    F                                                        01866000
WKPTR    DS    A                                                        01867000
DPTR     DS    A                                                        01868000
DPTR1    DS    A                                                        01869000
QULPTR   DS    A                                                        01870000
I        DS    F                                                        01871000
J        DS    F                                                        01872000
K        DS    F                                                        01873000
SWITCH   DS    H                                                        01874000
CONTROL  DS    H                                                        01875000
RET05    DS    H                                                        01876000
RET06    DS    H                                                        01877000
FIRST    DS    H                                                        01878000
LAST     DS    H                                                        01879000
COUNT    DS    H                                                        01880000
CNT      DS    H                                                        01881000
CNN      DS    H                                                        01882000
SAVCNT   DS    H                                                        01883000
FS1      DS    H                                                        01884000
FS2      DS    H                                                        01885000
N1       DS    H                                                        01886000
N2       DS    H                                                        01887000
LIMIT    DS    H                                                        01888000
VOLCNT   DS    FL1                                                      01889000
         DS    CL1                                                      01890000
CPLSTOR  DS    CL32                                                     01891000
         ORG   CPLSTOR                                                  01892000
@NM00007 DS    CL28                                                     01893000
@NM00008 DS    CL4                                                      01894000
         ORG   CPLSTOR+32                                               01895000
FPLSTOR  DS    CL24                                                     01896000
         ORG   FPLSTOR                                                  01897000
@NM00009 DS    CL16                                                     01898000
@NM00010 DS    CL8                                                      01899000
         ORG   FPLSTOR+24                                               01900000
GENAME   DS    CL45                                                     01901000
         ORG   GENAME                                                   01902000
GELENGTH DS    CL1                                                      01903000
GNAME    DS    CL44                                                     01904000
         ORG   GENAME+45                                                01905000
TYPE01   DS    CL9                                                      01906000
         ORG   TYPE01                                                   01907000
QULTYPE  DS    CL1                                                      01908000
QULNAME  DS    CL8                                                      01909000
         ORG   TYPE01+9                                                 01910000
         DS    CL2                                                      01911000
QULBUF   DS    CL45                                                     01912000
         ORG   QULBUF                                                   01913000
@NM00011 DS    CL1                                                      01914000
QUALIFY  DS    CL44                                                     01915000
         ORG   QULBUF+45                                                01916000
VOLAREA  DS    CL15                                                     01917000
         ORG   VOLAREA                                                  01918000
@NM00012 DS    CL2                                                      01919000
VOLDATA  DS    CL12                                                     01920000
         ORG   VOLDATA                                                  01921000
DEVTYPE  DS    CL4                                                      01922000
VOLSER   DS    CL6                                                      01923000
FSEQ     DS    CL2                                                      01924000
         ORG   VOLAREA+14                                               01925000
@NM00013 DS    CL1                                                      01926000
         ORG   VOLAREA+15                                               01927000
SAVNAME  DS    CL45                                                     01928000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01929000
@ENDDATD EQU   *                                                        01930000
IKJEHCIR CSECT                                                          01931000
         DS    0F                                                       01932000
@SIZDATD DC    AL1(0)                                                   01933000
         DC    AL3(@ENDDATD-@DATD)                                      01934000
         DS    0D                                                       01935000
@CC00229 DC    C'CATVOL  '                                              01936000
@CB00160 DC    X'40'                                                    01937000
FIXAREA  DS    CL300                                                    01938000
         ORG   FIXAREA                                                  01939000
@NM00014 DC    150X'00'                                                 01940000
@NM00015 DC    150X'00'                                                 01941000
         ORG   FIXAREA+300                                              01942000
         DS    CL3                                                      01943000
RTNTABLE DC    F'4'                                                     01944000
         DC    F'8'                                                     01945000
         DC    F'24'                                                    01946000
         DC    F'32'                                                    01947000
         DC    F'36'                                                    01948000
         DC    F'44'                                                    01949000
         DC    F'56'                                                    01950000
         DC    F'188'                                                   01951000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01952000
@01      EQU   01                                                       01953000
@02      EQU   02                                                       01954000
@03      EQU   03                                                       01955000
@04      EQU   04                                                       01956000
@05      EQU   05                                                       01957000
@06      EQU   06                                                       01958000
@07      EQU   07                                                       01959000
@08      EQU   08                                                       01960000
@09      EQU   09                                                       01961000
@10      EQU   10                                                       01962000
@11      EQU   11                                                       01963000
@12      EQU   12                                                       01964000
@13      EQU   13                                                       01965000
@14      EQU   14                                                       01966000
@15      EQU   15                                                       01967000
ENDBYTE  EQU   @03                                                      01968000
CTGPLPTR EQU   @03                                                      01969000
REG0     EQU   @00                                                      01970000
REG1     EQU   @01                                                      01971000
REG15    EQU   @15                                                      01972000
CIRPTR   EQU   @02                                                      01973000
R4       EQU   @04                                                      01974000
R5       EQU   @05                                                      01975000
R6       EQU   @06                                                      01976000
R7       EQU   @07                                                      01977000
REG10    EQU   @10                                                      01978000
REG11    EQU   @11                                                      01979000
REG12    EQU   @12                                                      01980000
REG13    EQU   @13                                                      01981000
REG14    EQU   @14                                                      01982000
REG2     EQU   @02                                                      01983000
REG3     EQU   @03                                                      01984000
REG4     EQU   @04                                                      01985000
REG5     EQU   @05                                                      01986000
REG6     EQU   @06                                                      01987000
REG7     EQU   @07                                                      01988000
REG8     EQU   @08                                                      01989000
REG9     EQU   @09                                                      01990000
CIRPARM  EQU   0                                                        01991000
CIROPT   EQU   CIRPARM                                                  01992000
CIRLOCRC EQU   CIRPARM+3                                                01993000
CIRSRCH  EQU   CIRPARM+4                                                01994000
CIRVOL   EQU   CIRPARM+8                                                01995000
CIRWA    EQU   CIRPARM+12                                               01996000
CIRPSWD  EQU   CIRPARM+20                                               01997000
CTGPL    EQU   0                                                        01998000
CTGOPTN1 EQU   CTGPL                                                    01999000
CTGNAME  EQU   CTGOPTN1                                                 02000000
CTGCNAME EQU   CTGOPTN1                                                 02001000
CTGGENLD EQU   CTGOPTN1                                                 02002000
CTGOPTN2 EQU   CTGPL+1                                                  02003000
CTGEXT   EQU   CTGOPTN2                                                 02004000
CTGERASE EQU   CTGOPTN2                                                 02005000
CTGSMF   EQU   CTGERASE                                                 02006000
CTGREL   EQU   CTGSMF                                                   02007000
CTGPURG  EQU   CTGOPTN2                                                 02008000
CTGVMNT  EQU   CTGPURG                                                  02009000
CTGOPTN3 EQU   CTGPL+2                                                  02010000
CTGFUNC  EQU   CTGOPTN3                                                 02011000
CTGSUPLT EQU   CTGOPTN3                                                 02012000
CTGAM0   EQU   CTGOPTN3                                                 02013000
CTGOPTN4 EQU   CTGPL+3                                                  02014000
CTGENT   EQU   CTGPL+4                                                  02015000
CTGCAT   EQU   CTGPL+8                                                  02016000
CTGWKA   EQU   CTGPL+12                                                 02017000
CTGDSORG EQU   CTGPL+16                                                 02018000
CTGNOFLD EQU   CTGPL+19                                                 02019000
CTGDDNM  EQU   CTGPL+20                                                 02020000
CTGNEWNM EQU   CTGDDNM                                                  02021000
CTGFBFLG EQU   CTGNEWNM+2                                               02022000
CTGJSCB  EQU   CTGPL+24                                                 02023000
CTGPSWD  EQU   CTGJSCB                                                  02024000
CTGFIELD EQU   CTGPL+28                                                 02025000
CTGFL    EQU   0                                                        02026000
CTGFLDNO EQU   CTGFL                                                    02027000
CTGFLDRE EQU   CTGFL+3                                                  02028000
CTGFLDNM EQU   CTGFL+8                                                  02029000
CTGFLDAT EQU   CTGFL+16                                                 02030000
CTGFLNG  EQU   CTGFLDAT                                                 02031000
CTGFLPT  EQU   CTGFLDAT+4                                               02032000
WORKAREA EQU   0                                                        02033000
AREALN   EQU   WORKAREA                                                 02034000
DATALN   EQU   WORKAREA+2                                               02035000
DATAREA  EQU   WORKAREA+4                                               02036000
USENAME  EQU   0                                                        02037000
TEMBLK   EQU   0                                                        02038000
WORKTEMP EQU   0                                                        02039000
TEMLN    EQU   WORKTEMP                                                 02040000
TEMRTLN  EQU   WORKTEMP+2                                               02041000
TEMPDATA EQU   WORKTEMP+4                                               02042000
QUALAREA EQU   0                                                        02043000
QUALN    EQU   QUALAREA                                                 02044000
RTNQLN   EQU   QUALAREA+2                                               02045000
QUALDATA EQU   QUALAREA+4                                               02046000
DATABLK  EQU   0                                                        02047000
VOLBLK   EQU   0                                                        02048000
SVNAME   EQU   0                                                        02049000
FT1      EQU   0                                                        02050000
FT2      EQU   0                                                        02051000
USECNT   EQU   0                                                        02052000
PARM1    EQU   0                                                        02053000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02054000
CTGFLCHN EQU   CTGFL+12                                                 02055000
CTGFLDWA EQU   CTGFL+4                                                  02056000
CTGFLDTS EQU   CTGFLDRE                                                 02057000
@NM00006 EQU   CTGFLDRE                                                 02058000
CTGFLDGC EQU   CTGFL+2                                                  02059000
CTGFLDCD EQU   CTGFL+1                                                  02060000
@NM00005 EQU   CTGFBFLG                                                 02061000
CTGNGDSN EQU   CTGFBFLG                                                 02062000
CTGGDGB  EQU   CTGFBFLG                                                 02063000
CTGKEEP  EQU   CTGFBFLG                                                 02064000
CTGPAR   EQU   CTGFBFLG                                                 02065000
CTGFDBK  EQU   CTGNEWNM                                                 02066000
CTGTYPE  EQU   CTGPL+18                                                 02067000
@NM00004 EQU   CTGDSORG                                                 02068000
CTGOPTNS EQU   CTGDSORG                                                 02069000
CTGCVOL  EQU   CTGCAT                                                   02070000
CTGFVT   EQU   CTGENT                                                   02071000
@NM00003 EQU   CTGOPTN4                                                 02072000
CTGDOCAT EQU   CTGOPTN4                                                 02073000
CTGLBASE EQU   CTGOPTN4                                                 02074000
CTGNUM   EQU   CTGOPTN3                                                 02075000
CTGSRH   EQU   CTGOPTN3                                                 02076000
CTGGDGL  EQU   CTGOPTN3                                                 02077000
@NM00002 EQU   CTGOPTN2                                                 02078000
CTGSCR   EQU   CTGOPTN2                                                 02079000
CTGOVRID EQU   CTGOPTN2                                                 02080000
CTGDISC  EQU   CTGOPTN2                                                 02081000
CTGGTNXT EQU   CTGOPTN2                                                 02082000
CTGRCATN EQU   CTGVMNT                                                  02083000
CTGGTALL EQU   CTGREL                                                   02084000
CTGNSVS  EQU   CTGEXT                                                   02085000
CTGREAD  EQU   CTGOPTN1                                                 02086000
CTGUPD   EQU   CTGOPTN1                                                 02087000
CTGCI    EQU   CTGOPTN1                                                 02088000
CTGMAST  EQU   CTGOPTN1                                                 02089000
CTGBYPSS EQU   CTGOPTN1                                                 02090000
CIRSAVE  EQU   CIRPARM+16                                               02091000
@NM00001 EQU   CIRPARM+1                                                02092000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02093000
@RT00135 EQU   BYPASS                                                   02094000
@RC00192 EQU   @EL00003                                                 02095000
@RF00207 EQU   @EL00003                                                 02096000
@RF00416 EQU   @EL00005                                                 02097000
@RF00490 EQU   @EL00006                                                 02098000
@PB00006 EQU   @PB00007                                                 02099000
@PB00005 EQU   @PB00006                                                 02100000
@PB00004 EQU   @PB00005                                                 02101000
@PB00003 EQU   @PB00004                                                 02102000
@PB00002 EQU   @PB00003                                                 02103000
@RC00078 EQU   @PB00002                                                 02104000
@RC00076 EQU   @PB00002                                                 02105000
@RC00074 EQU   @PB00002                                                 02106000
@ENDDATA EQU   *                                                        02107000
         END   IKJEHCIR,(C'PLS0408',0602,74346)                         02108000
