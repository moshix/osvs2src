         TITLE 'IKJEHDS1-IBM TIME SHARING LISTDS COMMAND'               00030003
IKJEHDS1 CSECT                                                          00040021
*         VS2 -3.0 SERVICE UPDATE                      PTF#     APAR#   00043403
*0000116620,312400,738840                             UZ03988  @ZA10244 00043603
*0000116200,192201,239801-239802,239900-241100        UZ03988  @ZA09142 00043803
*0000116200,579750,579780                             UZ03988  @ZA07714 00044003
*0000592820,592840,593020                             UZ03988  @ZA06703 00044203
*0000042900,165900,183608,183612,183618,183630                 @VS06783 00044403
*0000192100-192300,481300-481500,483100-483300                 @VS06171 00044603
*A 029500,579756-579757                               UZ03988  @ZA06146 00044803
*C 579092,579760-579764,579776-579778,579785-579787   UZ03988  @ZA06146 00045003
*C 579801-579804,579810,302800                        UZ03988  @ZA06146 00045203
*0000184201-184280                                    UZ03988  @ZA06144 00045403
*0000012200-012700,116500-116640,142100,144800        UZ03988  @ZA01485 00045603
*0000183645                                           UZ03988  @ZA01485 00045803
*0000183433,183532                                    UZ03988  @ZA05439 00046003
*A 343600-343760                                                SA52667 00047403
*C 328800,329700,336900,343200                                  SA52667 00050803
*D 334200-335700                                                SA52667 00054203
*C 746100                                                        YM1019 00057603
*A 582400                                                       SA49892 00061003
*D 591600                                                       SA49829 00064403
*C 828600,829200,829800,830400,831000                            A49872 00067803
*A 646600-646700                                                 A48499 00071203
*C 474000-474600,476400,477000,497700                            A48499 00074603
*C 240000                                                        A46800 00078003
*A 630100-630280,671800-671900,718600-718720                     100000 00081403
*C 130500-130800,131700-135300,169500-169800,170400-170700,      100000 00084803
*C 172200-172800,174900-175200,175800-176100,624600,             100000 00088203
*C 648600-648900,649500-652200,652800,669300                     100000 00092100
*D 131100-131400,135600,170100,173100-174000,174600,177300,      100000 00096100
*D 232500-233100,245700,624900-627300,649200,652500,             100000 00100100
*D 669600-669900                                                 100000 00104100
*C 191700                                                        A46749 00108100
*C 167400,191400,192300,195900,236700                            A42337 00112100
*A 069300,167700-168900,188700-191100,191700-192000,             A42337 00116100
*A 192600-195600,746400,754200-754800                            A42337 00120100
*D 168300,169000,169300,169400                                   A42337 00124100
*C 712200                                                         M0875 00128100
*                  RELEASE 3.0, VS2 CHANGES                             00128502
*C 297564                                                      @ZA00105 00129003
*D 570420                                                       ZA00105 00132403
*                                                                       00134304
*             VS2-4.1 RACF CHANGES                             @Z40RSSA 00134404
*A 66901,303620,303640,570420-570476,570508-570538,570848       ZA00105 00135803
*A 734099-734299,734400,734500                                  ZA00105 00139203
*A 032200,202960,202980,738280                                  ZA00612 00142603
*C 183598                                                       ZA02173 00146003
*D 579436-579740,579900-579964                                  ZA02196 00149403
*C 579868                                                       ZA02196 00152803
*A 579436,579424,579900                                         ZA02196 00156203
*C231000                                                        ZA01264 00159603
*********************************************************************** 00163003
*                                                                     * 00166403
* STATUS --  VS2  030  SU                                      @ZA06146 00169803
*                                                                     * 00176603
* FUNCTION --                                                         * 00180020
*    THIS IS THE MAIN PROCESSING MODULE OF THE LISTDS COMMAND.        * 00240020
*    IT GETS CONTROL FROM THE TERMINAL MONITOR PROGRAM VIA ATTACH     * 00270020
*    AND PROCESSES A LIST OF DSNAMES, DISPLAYING THEIR ATTRIBUTES     * 00300020
*    ON THE TERMINAL. A LOCATE IS ISSUED TO GET THE VOLUME LIST,        00330000
*    ENTRY TYPE, AND OTHER INFORMATION ABOUT THE DATA SET.     @YL026YA 00340000
*    IF THE DATA SET IS NON-VSAM,                              @YL026YA 00350000
*    OBTAIN IS USED TO GET THE REMAINDER OF THE INFOR-         @YL026YA 00360000
*    MATION GIVEN AS PART OF THE BASIC FUNCTION OF THE COMMAND.       * 00370000
*    IF THE DATA SET IS VSAM, THE ORIGINAL LOCATE SUPPLIED     @YL026YA 00380000
*    THE INFORMATION.                                          @YL026YA 00390000
*    IF THE DSNAME IS NOT CATALOGED, AN ENTRY IS MADE TO DAIR TO      * 00420020
*    SEE IF IT WAS ALLOCATED VIA THE LOGON PROC. IF IT WAS, THE       * 00450020
*    DDNAME IS EXTRACTED AND A RDJFCB IS ISSUED. IN THIS CASE         * 00480020
*    ONLY UP TO 5 VOLSERS WILL BE DISPLAYED.                          * 00510020
*    HISTORY INFORMATION IS OPTIONALLY PROVIDED FROM THE DSCB  @YL026YA 00540000
*    FOR NON-VSAM DATA SETS.  FOR VSAM DATA SETS, HISTORY      @YL026YA 00550000
*    INFORMATION IS RETRIEVED FROM THE CATALOG VIA THE ORIGINAL         00560000
*    LOCATE.                                                   @YL026YA 00570000
*    IF STATUS INFORMATION IS REQUESTED, THE INFORMATION       @YL026YA 00580000
*    RETRIEVAL FUNCTION OF DYNAMIC ALLOCATION IS USED;         @YL026YA 00590000
*    THE DDNAME AND DISPOSITION                                @YL026YA 00600000
*    IS EXTRACTED AND DISPLAYED. IF THE DSNAME IS A MEMBERNAME        * 00630020
*    A BLDL ISSUED AND INFORMATION IN THE DIRECTORY FOR THAT          * 00660020
*    MEMBER IS DISPLAYED. IF MEMBERS INFORMATION IS REQUESTED,        * 00690020
*    AND THE DATASET IS A PDS, THEN IKJEHMEM IS CALLED TO LIST        * 00720020
*    OUT THE DIRECTORY. IF LABEL INFORMATION IS REQUESTED, THE        * 00750020
*    DSCB CHAIN IS PRINTED IN HEXADECIMAL ON THE TERMINAL.            * 00780020
*                                                                     * 00810020
* ENTRY POINTS --                                                     * 00840020
*         IKJEHDS1 - MAIN ENTRY POINT OF THE PROGRAM                  * 00900020
*         IKJEHWRT - WRITE ROUTINE                                    * 00940020
*                                                                     * 00990020
* INPUT -- REGISTER 1 POINTS TO THE COMMAND PROCESSOR PARAMETER LIST  * 01020020
*                                                                     * 01140020
* OUTPUT -- A LIST OF ATTRIBUTES FOR THE DATA SETS SPECIFIED          * 01170020
*         R15 = X'00'   NORMAL RETURN                          @ZA01485 01220003
*         R15 = X'0C'   ERROR RETURN                           @ZA01485 01270003
*                                                                     * 01290020
* EXTERNAL REFERENCES --                                              * 01320020
*         IKJEHMEM TO LIST PDS DIRECTORY                              * 01380020
*         IKJPARS TO PARSE COMMAND                                    * 01440020
*         IKJPUTL TO OUTPUT DATA TO TERMINAL                          * 01470020
*         IKJEHSIR TO ESTABLISH STAE EXIT                             * 01500020
*         IKJDAIR TO ALLOCATE DATASET                                 * 01502020
*         IKJDFLT TO QUALIFY DATA SET NAMES                           * 01504020
*         IKJEHCIR TO OBTAIN A LIST OF NAMES IF LEVEL OR A     @YL026YA 01512000
*                  GENERIC (*) DATA SET NAME IS SPECIFIED.     @YL026YA 01520000
*                                                                     * 01530020
* EXITS, NORMAL -- RETURN TO THE TERMINAL MONITOR PROGRAM             * 01560020
*                                                                     * 01590020
* EXITS, ERROR -- RETURN TO THE TERMINAL MONITOR PROGRAM              * 01620020
*                                                                     * 01770020
* TABLES/WORK AREAS --                                                * 01800000
*    HDTNY-THIS TABLE THE ACCUMULATED DAYS IN THE YEAR FOR EACH       * 01860020
*    MONTH. IT IS USED TO FIND THE CORRECT MONTH THAT A               * 01890020
*    DAY FALLS IN. NY STANDS FOR NORMAL YEAR.                         * 01920020
*    HDTLY-SAME AS HDTNY BUT FOR LEAP YEAR.                           * 01950020
*    TRANSTAB-USED TO TRANSLATE BINARY TO HEXADECIMAL                 * 01980020
*    OBTWAD-WORKING CORE GOTTEN THAT PROVIDES THE WORK AREA FOR       * 02010020
*    THE RDJFCB AND OBTAIN MACROS ALONG WITH DCBS AND                 * 02040020
*    VARIOUS INTERNAL SWITCHS, LIST FORMS OF MACROS,                  * 02070020
*    BUFFERS, REG SAVE AREA, AND PARAMETER LISTS. CORE                * 02100020
*    IS GOTTEN BY A REG GETMAIN.                                      * 02130020
*                                                                     * 02190020
* ATTRIBUTES -- REENTRANT, READ-ONLY, REFRESHABLE                     * 02200000
*                                                                     * 02210000
* CHARACTER CODE DEPENDENCY -- CHARACTER CODE INDEPENDENT             * 02220000
*                                                                     * 02230000
* NOTES --                                                            * 02240000
*    DESCRIBED IN OS/VS2 TSO COMMAND PROCESSOR LOGIC,          @YL026YA 02250000
*    VOLUME IV, SY28-0652.                                     @YL026YA 02260000
*                                                                     * 02310020
*********************************************************************** 02340020
         ENTRY IKJEHWRT                                                 02370020
         ENTRY IKJEHALC                                        @YL026YA 02380000
         ENTRY IKJEHERR                                                 02400020
R0       EQU   0                   REGISTER 0                           02430020
R1       EQU   1                   REGISTER 1                           02460020
R2       EQU   2                   REGISTER 2                           02490020
R3       EQU   3                   REGISTER 3                           02520020
R4       EQU   4                   REGISTER 4                           02550020
R5       EQU   5                   REGISTER 5                           02580020
R6       EQU   6                   REGISTER 6                           02610020
R7       EQU   7                   REGISTER 7                           02640020
R8       EQU   8                   REGISTER 8                           02670020
R9       EQU   9                   REGISTER 9 - POINTER TO CURRENT     *02700000
                                   DSNAME                      @YL026YA 02710000
R10      EQU   10                  REGISTER 10 - BASE FOR      @YL026YA 02720000
*                                    SECONDARY PROGRAM CSECTS  @YL026YA 02730000
R11      EQU   11                  REGISTER 11 - MAIN PROGRAM  @YL026YA 02740000
*                                    BASE REGISTER             @YL026YA 02750000
R12      EQU   12                  REGISTER 12 - BASE FOR WORKAREA      02760000
R13      EQU   13                  REGISTER 13                          02820020
R14      EQU   14                  REGISTER 14                          02850020
R15      EQU   15                  REGISTER 15                          02880020
WORKSP   EQU   1                   SUBPOOL NUMBER                       02910020
SAVELEN  EQU   112                 SAVE AREA LENGTH            @ZA06146 02940003
SAVELEN1 EQU   120                 SAVE AREA LENGTH            @ZA06146 02950003
ONE      EQU   X'01'               MASK TO CHECK KEYWORD PDE            02970020
HISTORY  EQU   X'01'               HISTORY OPTION                       03000020
STATUS   EQU   X'02'               STATUS OPTION                        03030020
MEMBERS  EQU   X'04'               MEMBERS OPTION                       03060020
LABEL    EQU   X'08'               LABEL OPTION                         03090020
CATALOG  EQU   X'01'               CATALOG OPTION              @YL026YA 03100000
LEVEL    EQU   X'02'               LEVEL OPTION                @YL026YA 03110000
JFCB     EQU   X'20'               INDICATE RDJFCB HAS BEEN ISSUED      03120020
LOCATE   EQU   X'40'               INDICATE LOCATE HAS BEEN SUCCESSFUL  03150020
MOREVOLS EQU   X'80'               INDICATE FOR MORE VOLUMES.           03180020
NMOREVOL EQU   X'7F'               MASK TO TURN OFF MORE VOL SWITCH     03210020
B1       EQU   1                   MASK FOR BYTE#1 OF REG       ZA00612 03220002
ON       EQU   X'80'               MASK FOR DSLIST PDE FLAGS            03240020
MEMFLAG  EQU   14                  OFFSET TO MEMBER FLAG BYTE IN PDE    03270020
MEMNAME  EQU   X'10'               INDICATOR FOR MEMBER NAME            03300020
PWOFF    EQU   16                  OFFSET TO PASSWORD ADDRESS           03330020
STATOFF1 EQU   29                  OFFSET FOR STATUS WITHOUT HISTORY    03360020
STATOFF2 EQU   58                  OFFSET FOR STATUS WITH HISTORY       03370020
BLANK    EQU   C' '                BLANK                                03380020
ZONE     EQU   C'0'                ZONE FIELD                           03390020
SLASH    EQU   C'/'                CHARACTER SLASH                      03450020
FOXES    EQU   X'FF'               HEX FF BYTE                          03480020
MNAMTTR  EQU   11                  OFFSET TO TTR FOR MNAM OUTPUT        03510020
MNAMALI  EQU   18                  ALIAS OFFSET                         03540020
MNAMTTRN EQU   24                  OFFSET TO TTRN                       03570020
MNAMCNT  EQU   29                  OFFSET TO HW COUNT                   03600020
MNAMDATA EQU   33                  OFFSET TO DATA TO INSERT.            03630020
FOX3     EQU  X'F3'                USED FOR MASK OF F3                  03690020
MAXDSN   EQU   44                  LONGEST NAME ALLOWED TO     @YL026YA 03694000
*                                  SYSTEM                      @YL026YA 03698000
CIRLIST  EQU   X'FF'               INDICATOR THAT NAME BEING   @YL026YA 03702000
*                                  PROCESSED IS FROM CIR LIST  @YL026YA 03706000
CIROPTDS EQU   X'02'               CIR OPTION TO RETURN LIST   @YL026YA 03710000
*                                  OF NAMES                    @YL026YA 03714000
*     RELATIVE MESSAGE NUMBERS TO BE USED FOR ERROR HANDLING            03720020
MSG01    EQU   1                   MESSAGE NUMBER 1                     03780020
MSG02    EQU   2                   MESSAGE NUMBER 2                     03810020
MSG03    EQU   3                   MESSAGE NUMBER 3                     03840020
MSG04    EQU   4                   MESSAGE NUMBER 4                     03870020
MSG05    EQU   5                   MESSAGE NUMBER 5                     03900020
MSG06    EQU   6                   MESSAGE NUMBER 6                     03930020
MSG07    EQU   7                   MESSAGE NUMBER 7                     03960020
MSG08    EQU   8                   MESSAGE NUMBER 8                     03990020
MSG09    EQU   9                   MESSAGE NUMBER 9                     04020020
MSG10    EQU   10                  MESSAGE NUMBER 10                    04050020
MSG11    EQU   11                  MESSAGE NUMBER 11                    04080020
MSG12    EQU   12                  MESSAGE NUMBER 12                    04110020
MSG13    EQU   13                  MESSAGE NUMBER 13                    04140020
MSG14    EQU   14                  MESSAGE NUMBER 14                    04170020
MSG15    EQU   15                  MESSAGE NUMBER 15                    04200020
MSG16    EQU   16                  MESSAGE NUMBER 16                    04230020
MSG17    EQU   17                  MESSAGE NUMBER 17                    04260020
MSG18    EQU   18                  MESSAGE NUMBER 18           @YL026YA 04270000
MSG19    EQU   19                  MESSAGE NUMBER 19           @YL026YA 04280000
MSG20    EQU   20                  MESSAGE NUMBER 20           @VS06783 04290000
SECMSG01 EQU   1                   SECOND LEVEL MESSAGE 1               04320020
SECMSG02 EQU   2                   SECOND LEVEL MESSAGE 2               04350020
SECMSG03 EQU   3                   SECOND LEVEL MESSAGE 3               04380020
SECMSG04 EQU   4                   SECOND LEVEL MESSAGE 4               04410020
SECMSG05 EQU   5                   SECOND LEVEL MESSAGE 5               04440020
SECMSG06 EQU   6                   SECOND LEVEL MESSAGE 6               04470020
SECMSG07 EQU   7                   SECOND LEVEL MESSAGE 7               04500020
SECMSG08 EQU   8                   SECOND LEVEL MESSAGE 8               04530020
SECMSG09 EQU   9                   SECOND LEVEL MESSAGE 9               04560020
SECMSG10 EQU   10                  SECOND LEVEL MESSAGE 10              04590020
SECMSG11 EQU   11                  SECOND LEVEL MESSAGE 11              04620020
SECMSG12 EQU   12                  SECOND LEVEL MESSAGE 12              04650020
SECMSG13 EQU   13                  SECOND LEVEL MESSAGE 13              04680020
SECMSG14 EQU   14                  SECOND LEVEL MESSAGE 14              04710020
SECMSG15 EQU   15                  SECOND LEVEL MESSAGE 15              04740020
SECMSG16 EQU   16                  SECOND LEVEL MESSAGE 16              04770020
SECMSG17 EQU   17                  SECOND LEVEL MESSAGE 17              04800020
SECMSG18 EQU   18                  SECOND LEVEL MESSAGE 18              04830020
SECMSG19 EQU   19                  SECOND LEVEL MESSAGE 19              04840020
SECMSG20 EQU   20                  SECOND LEVEL MESSAGE 20              04850020
SECMSG21 EQU   21                  SECOND LEVEL MESSAGE 21     @YL026YA 04853000
SECMSG22 EQU   22                  SECOND LEVEL MESSAGE 22     @YL026YA 04856000
*                                                                       04860020
CHARV    EQU   C'V'                RECFM EQUAL V                        04890020
CHARU    EQU   C'U'                EQUAL U                              04920020
CHARF    EQU   C'F'                EQUAL F                              04950020
CHARAST  EQU   C'*'                RECFM NOT SPECIFIED                  04980020
CHART    EQU   C'T'                TRACK OVERFLOW CHAR                  05010020
CHARB    EQU   C'B'                BLOCKED ATTRIBUTE                    05040020
CHARS    EQU   C'S'                STANDARD OR SPANNED                  05070020
CHARA    EQU   C'A'                ASA CONTROL CHAR                     05100020
CHARM    EQU   C'M'                MACHINE CONTROL                      05130020
NOHIBIT  EQU   X'7F'               USED FOR MASK OF X'7F'               05160020
DAIR08   EQU   X'08'               DAIR ENTRY CODE 08                   05170020
DAIR2C   EQU   X'2C'               DAIR ENTRY CODE 2C                   05180020
EXITCODE EQU   X'87'               EXIT CODE FOR JFCB                   05190000
RETCD52  EQU   52                  RETURN CODE OFFSET                   05220000
*                                    (END OF SAVE AREA)        @YL026YA 05250000
DAYS31   EQU   31                  USED FOR VALUE 31                    05280020
ERRCOD   EQU   14                  USED AS OFFSET OF 14 IN ERROR RTN    05310020
PASSLOT  EQU   60                  PASSWORD SLOT OF DAIRLIST            05340020
CRDTOFF  EQU   28                  OFFSET TO CREATION DATE              05430000
*                                  IN OUTPUT (PRINT) BUFFER    @YL026YA 05480000
VOLENTLN EQU   6                   LENGTH OF VOLSER ENTRY      @YL026YA 05530000
DSNADDR  EQU   0                   OFFSET TO DSNAME ADDR IN PDE LIST    05580000
DSNLEN   EQU   4                   OFFSET TO DSNAME LENGTH FIELD IN PDE 05630000
DSNFLAGS EQU   6                   OFFSET TO FLAG1 IN PDE      @YL026YA 05680000
MEMADDR  EQU   8                   OFFSET TO MEMBERNAME POINTER IN PDE  05730020
MEMLEN   EQU   12                  OFFSET TO MEMBERNAME LENGTH          05760020
PWRDADDR EQU   16                  OFFSET TO PASSWORD ADDRESS IN PDE    05790020
PWLEN    EQU   20                  OFFSET TO PASSWORD LENGTH IN PDE     05820000
PWFLAG   EQU   22                  OFFSET TO PASSWORD          @YL026YA 05830000
CHAINAD  EQU   24                  OFFSET TO PDE CHAIN FIELD            05850020
BLDLLEN  EQU   80                  LENGTH OF BLDL LIST                  05880020
LOCSAVOF EQU   72                  OFFSET TO LOCAL SAVE AREA            05900020
TCBOFF   EQU   4                   OFFSET TO TCB                        05920020
FOUR     EQU   4                   USED FOR FULL WORD MOVES AND REFS    05940020
OPT02    EQU   X'20'               USED AS OPTION FOR DEFAULT INTERFACE 05970020
OPT04    EQU   X'04'               USED AS OPTION FOR DEFAULT ROUTINE   06000020
QUOTED   EQU   X'40'               FLAG FOR QUOTED DSNAME IN PDE        06030000
HIGHBIT  EQU   X'80'               HIGH ORDER BIT MASK                  06080000
*  DISPLACEMENTS, LENGTHS                                               06130000
D0       EQU   0                   0                                    06180020
D1       EQU   1                   1                                    06210020
D2       EQU   2                   2                                    06240020
D3       EQU   3                   3                                    06270020
D4       EQU   4                   4                                    06300020
D5       EQU   5                   5                                    06330020
D6       EQU   6                   6                                    06360020
D7       EQU   7                   7                                    06390020
D8       EQU   8                   8                                    06420020
D9       EQU   9                   9                          @YL026YB  06430000
D10      EQU   10                  10                                   06450020
D11      EQU   11                  11                                   06480020
D12      EQU   12                  12                                   06510020
D56      EQU   56                  56                                   06520000
L0       EQU   0                   0                                    06540020
L1       EQU   1                   1                                    06570020
L2       EQU   2                   2                                    06600020
L3       EQU   3                   3                                    06630020
L4       EQU   4                   4                                    06660020
L5       EQU   5                   5                                    06690020
L6       EQU   6                   6                                    06720020
L7       EQU   7                   7                                    06750020
L8       EQU   8                   8                                    06780020
L9       EQU   9                   9                                    06810020
L10      EQU   10                  10                                   06840020
L12      EQU   12                  12                           ZA00105 06845002
L15      EQU   15                 15                                    06850000
L16      EQU   16                  16                          @YL026YA 06851000
L23      EQU   23                  23                          @YL026YA 06852000
L34      EQU   34                                                       06853000
*                                                                       06854000
FOURB    EQU   4                   4                                    06855000
EQ       EQU   8                   CONDITION CODE EQUAL        @YL026YA 06856000
RC28     EQU   28                  RETURN CODE 28                       06860020
NXTBUF   EQU   10                  NEXT BUFFER POSITION                 06870020
CONVCNT  EQU   8                   HALF BYTE COUNT FOR BITOHEX          06900020
NUMMONTH EQU   12                  NUMBER OF MONTHS IN A YEAR           06930020
DDNAMLEN EQU   8                   LENGTH OF A DDNAME                   06960020
STAR     EQU   C'*'                ASTERISK                    @YL026YA 06970000
PERIOD   EQU   C'.'                DSNAME LEVEL DELIMITER      @YL026YA 06980000
COMMA    EQU   C','                COMMA                                06990020
QUOTE    EQU   C''''               CHARACTER QUOTE               A42337 07000021
CONDZERO EQU   8                   BRANCH IF ZERO CONDITION CODE        07020020
RETCD12  EQU   12                  RETURN CODE FOR ERROR RETURN TO TMP  07050020
ONEF     EQU   X'1F'               USED FOR MASK OF X'1F'               07110020
RT08     EQU   X'08'               USED FOR RETURN CODE CHECK           07140020
RT12     EQU   X'0C'               USED FOR RETURN CODE                 07170020
RT16     EQU   X'10'               USED FOR RETURN CODE 16              07200020
ZERO     EQU   X'00'               USED TO CLEAR BYTES                  07210020
SWON     EQU   X'FF'               MASK TURN SWITCH ON                  07220020
SWOFF    EQU   X'00'               MASK TURN SWITCH OFF                 07222020
*********************************************************************** 07224000
*                                                                     * 07264000
*    THE FOLLOWING EQUATES ARE USED BY THE LABEL KEYWORD PROCESSING   * 07304000
*    ROUTINE (IKJEHLBL).   THEY ARE MAINLY USED FOR FORMATTING THE    * 07350020
*    FORMAT 1 AND 3 DSCBS INTO THE OUTPUT BUFFER.  EQUATES ENDING IN  * 07380020
*    LEN ARE GENERALLY LENGTHS OF SOME DATA FIELD AND THOSE ENDING IN * 07410020
*    OFF AND OF ARE GENERALLY OFFSETS INTO ONE OF THE WORK AREAS OR   * 07440020
*    THE BUFFER.  THOSE OFFSETS BEGINNING WITH N ARE OFFSETS INTO THE * 07470020
*    OUTPUT BUFFER.  THOSE OFFSETS NOT BEGINNING WITH N ARE OFFSETS   * 07500020
*    INTO A WORK AREA WHERE THE DATA IS CONVERTED TO HEXIDECIMAL.     * 07530020
*                                                                     * 07560020
*    ANY OF THE LENGTHS OF THE DATA FIELDS MAY BE CHANGED WITHOUT     * 07590020
*    REQUIRING CHANGES TO THE OFFSETS OR OUTPUT FORMATS, EXCEPT IN    * 07620020
*    IN THE CASE WHERE THE CHANGE IN LENGTH CAUSES THE CONVERSION     * 07650020
*    AREA OR THE BUFFER TO BE OVER RUN.                               * 07680020
*                                                                     * 07710020
*********************************************************************** 07740020
MAXNUM   EQU   40                  MAX BYTE COUNT FOR FORMAT 1 CONVERT  07770000
MAXNUM2  EQU   36                  MAX COUNT FOR A FORMAT 3 CONVERSION  07800000
IDLEN    EQU   2                   LENGTH OF ID BYTE                    07830000
SNLEN    EQU   12                  SERIAL NUMBER LENGTH                 07860000
VSLEN    EQU   4                   VOLUME SEQUENCE LENGTH               07890000
CDLEN    EQU   6                   CREATION DATE LENGTH                 07920000
EDLEN    EQU   6                   EXPIRATION DATE LENGTH               07950000
NELEN    EQU   2                   NUMBER OF EXTENTS LENGTH             07980000
NOBDBLEN EQU   2                   BYTES USED IN LAST DIRECTORY BLK LEN 08010000
RESLEN1  EQU   2                   RESERVED AREA 1 LENGTH               08040000
SYSCDLEN EQU   26                  SYSTEM CODE LENGTH                   08070000
RESLEN2  EQU   14                  RESERVED AREA NUMBER 2 LENGTH        08100000
DSORGLEN EQU   4                   DSORG FIELD LENGTH                   08130000
RECFMLEN EQU   2                   RECFM FIELD LENGTH                   08160000
OPTCDLEN EQU   2                   OPTCD FIELD LENGTH                   08190000
BLKLLEN  EQU   4                   BLKL FIELD LENGTH                    08220000
LRECLLEN EQU   4                   LRECL FIELD LENGTH                   08250000
KEYLLEN  EQU   2                   KEY LENGTH FIELD LENGTH              08280000
RKPLEN   EQU   4                   RELATIVE KEY POSITION FIELD LENGTH   08310000
DSINDLEN EQU   2                   DSIND FIELD LENGTH                   08340000
SCALOLEN EQU   8                   SECONDARY ALLOC. FIELD LENGTH        08370000
LSTARLEN EQU   6                   LSTAR FIELD LENGTH                   08400000
TRBALLEN EQU   4                   TRACK BALANCE FIELD LENGTH           08430000
RESLEN3  EQU   4                   RESERVED AREA 3 LENGTH               08460000
EXT1LEN  EQU   20                  EXTENT ONE LENGTH                    08490000
EXT2LEN  EQU   20                  EXTENT TWO LENGTH                    08520000
EXT3LEN  EQU   20                  EXTENT THREE LENGTH                  08550000
PTRDSLEN EQU   10                  CCHHR OF NEXT DSCB LENGTH            08580000
     EJECT                                                              08610020
*********************************************************************** 08640020
*                                                                       08670020
*      THE FOLLOWING EQUATES APPEAR IN PAIRS, THE FIRST BEING THE       08700020
*      OFFSET INTO AN AREA WHERE A PORTION OF THE DSCB HAS BEEN         08730020
*      CONVERTED TO HEXIDECIMAL, AND THE SECOND (STARTING ALWAYS        08760020
*      WITH N) INTO THE BUFFER WHERE IT WILL BE OUTPUTTED. THE          08790020
*      FIRST COUPLE CHARACTERS CORRESPONDS TO THE SAME ITEM THAT        08820020
*      IS REPRESENTED ABOVE AS THE LENGTH OF THE FIELD.                 08850020
*                                                                       08880020
*********************************************************************** 08910020
SNOFF    EQU   IDLEN               OFFSET TO ID FIELD IN CONVERSION     08940000
*                                  AREA                                 08960000
NSNOFF   EQU   IDLEN+1             OFFSET INTO BUFFER TO ID FIELD FOR   08980000
*                                  OUTPUT                               09000000
VSOFF    EQU   SNOFF+SNLEN         VOLUME SEQ FIELD                     09020000
NVSOFF   EQU   SNLEN+NSNOFF+1                                           09040000
CDOFF    EQU   VSOFF+VSLEN         CREATION DATE                        09060000
NCDOFF   EQU   VSLEN+NVSOFF+1                                           09080000
EDOFF    EQU   CDOFF+CDLEN         EXPIRATION DATE                      09100000
NEDOFF   EQU   CDLEN+NCDOFF+1                                           09120000
NEOFF    EQU   EDOFF+EDLEN         N. OF EXTENTS                        09140000
NNEOFF   EQU   EDLEN+NEDOFF+1                                           09160000
NOBDBOFF EQU   NEOFF+NELEN         N. OF BYTES IN LAST PDS DIRECT. BLK. 09180000
NNOBDBOF EQU   NELEN+NNEOFF+1                                           09200000
RESOFF1  EQU   NOBDBOFF+NOBDBLEN   RESERVED AREA 1                      09220000
NRESOFF1 EQU   NOBDBLEN+NNOBDBOF+1                                      09240000
SYSCDOFF EQU   RESOFF1+RESLEN1     SYSTEM CODE FIELD                    09260000
NSYSCDOF EQU   RESLEN1+NRESOFF1+1                                       09280000
*                                                                       09300000
DSORGOF  EQU   RESLEN2             DSORG FIELD                          09320000
NDSORGOF EQU   RESLEN2+1                                                09340000
RECFMOF  EQU   DSORGOF+DSORGLEN    RECFM FIELD                          09360000
NRECFMOF EQU   DSORGLEN+NDSORGOF+1                                      09380000
OPTCDOFF EQU   RECFMOF+RECFMLEN    OPTCD FIELD                          09400000
NOPTCDOF EQU   RECFMLEN+NRECFMOF+1                                      09420000
BLKLOF   EQU   OPTCDOFF+OPTCDLEN   BLKL FIELD                           09440000
NBLKLOF  EQU   OPTCDLEN+NOPTCDOF+1                                      09460000
LRECLOF  EQU   BLKLOF+BLKLLEN      LRECL FIELD                          09480000
NLRECLOF EQU   BLKLLEN+NBLKLOF+1                                        09500000
KEYLOFF  EQU   LRECLOF+LRECLLEN    KEY LENGTH                           09520000
NKEYLOFF EQU   LRECLLEN+NLRECLOF+1                                      09540000
RKPOFF   EQU   KEYLOFF+KEYLLEN     REL. KEY POSITION FIELD              09560000
NRKPOFF  EQU   KEYLLEN+NKEYLOFF+1                                       09580000
DSINDOFF EQU   RKPOFF+RKPLEN       DSIND FIELD                          09600000
NDSINDOF EQU   RKPLEN+NRKPOFF+1                                         09900020
SCALOOFF EQU   DSINDOFF+DSINDLEN                                        09930020
NSCALOOF EQU   DSINDLEN+NDSINDOF+1  SEC. ALLOC. FIELD                   09960020
LSTAROFF EQU   SCALOOFF+SCALOLEN   LSTAR FIELD                          09990020
NLSTAROF EQU   SCALOLEN+NSCALOOF+1                                      10020020
TRBALOFF EQU   LSTAROFF+LSTARLEN   TRK BALANCE FIELD                    10050020
NTRBALOF EQU   LSTARLEN+NLSTAROF+1                                      10080020
RESOFF3  EQU   TRBALOFF+TRBALLEN   RESERVED AREA THREE                  10110000
NRESOFF3 EQU   TRBALLEN+NTRBALOF+1                                      10140000
EXT2OFF  EQU   EXT1LEN             EXTENT TWO FIELD                     10170000
NEXT2OFF EQU   EXT1LEN+1                                                10200000
EXT3OFF  EQU   EXT2OFF+EXT2LEN     EXTENT THREE                         10230000
NEXT3OFF EQU   EXT2LEN+NEXT2OFF+1                                       10260000
PTRDSOFF EQU   EXT3OFF+EXT3LEN     PTRDS FIELD                          10290000
NPTRDSOF EQU   EXT3LEN+NEXT3OFF+1                                       10320020
*                                                                       10350020
*   THE FOLLOWING EQUATES ARE USED FOR PROCESSING THE FORMAT 3 DSCB.    10380020
*                                                                       10410020
KEYIDLEN EQU   8                   LEN OF KEY ID FIELD WHEN IN HEX      10440000
F3EXTLEN EQU   20                  LEN OF EXTENT FIELD WHEN CONVERTED   10470000
F3IDLEN  EQU   2                   ID FIELD LENGTH                      10500000
MAXNUM3  EQU   15                  NUMBER USED IN CONVERSION ROUTINE    10530000
MAXNUM4  EQU   31                  NUMBER USED IN CONVERSION ROUTINE    10560000
EOBUFF1  EQU   2*MAXNUM2           USED IN UNKNOWN DSCB ROUTINE         10590000
IDOFF    EQU   9                   OFFSET TO ID                         10620000
*                                                                       10650000
F3OFF1   EQU   KEYIDLEN            OFFSET TO EXTENT 4                   10680000
F3OFF2   EQU   F3EXTLEN+F3OFF1     EXTENT 5                             10710000
F3OFF3   EQU   F3EXTLEN+F3OFF2     EXTENT 6                             10740000
*                                                                       10770000
NF3OFF1  EQU   KEYIDLEN+1          OFFSET INTO BUFFER FOR EXTENTS       10800000
NF3OFF2  EQU   NF3OFF1+F3EXTLEN+1                                       10830020
NF3OFF3  EQU   NF3OFF2+F3EXTLEN+1                                       10860020
NF3OFF4  EQU   F3EXTLEN+1                                               10890020
F3OFF4   EQU   F3EXTLEN            EXTENT OFFSETS INTO CONVERSION AREA  10920000
F3OFF5   EQU   F3OFF4+F3IDLEN                                           10950020
NF3OFF5  EQU   NF3OFF4+F3IDLEN+1                                        10980020
F3OFF6   EQU   F3OFF5+F3EXTLEN                                          11010020
NF3OFF6  EQU   NF3OFF5+F3EXTLEN+1                                       11040020
F3OFF7   EQU   F3EXTLEN                                                 11070020
NF3OFF7  EQU   F3EXTLEN+1                                               11100020
F3OFF8   EQU   F3OFF7+F3EXTLEN                                          11130020
NF3OFF8  EQU   NF3OFF7+F3EXTLEN+1                                       11160020
*                                                                       11190020
*******EQUATES USED IN MEMBER PROCESSING ****                           11220020
*                                                                       11250020
DSORGF   EQU   1                   DSORG FIELD LENGTH                   11280000
BLDL1    EQU   1                   DO BLDL ON ONE ENTRY                 11310000
BLDLMAX  EQU   76                  MAX LIST LENGTH ON BLDL              11340000
DTACNT   EQU   1                   DATA COUNT TO BE CONVERTED           11370000
USERFLD  EQU   4                   OFFSET TO USER DATA                  11400000
BUFPTLN  EQU   9                   LENGTH OF BUFFPTR                    11430000
LSTFLD   EQU   69                  OFFSET TO LAST FIELD OUTPUT BUFF     11460000
*                                                                       11490020
         EJECT                                                          11520020
LISTDS   SAVE  (14,12)                                                  11550003
         LR    R11,R15             ESTABLISH ADDRESSABILITY             11580000
         USING LISTDS,R11          USE R11 FOR MAIN BASE                11610000
         USING OBTWAD,R12          USE R12 FOR WORKAREA BASE            11640000
         B     BRARID              BRANCH AROUND ID            @ZA01485 11650003
         DC    C'IKJEHDS1'         MODULE ID                   @ZA01485 11660003
         DC    X'6098'             DATE 04/07/76               @ZA10244 11662003
BRARID   EQU   *                                               @ZA01485 11664003
         LR    R2,R1               COPY PARM LIST POINTER               11670000
         GETMAIN  R,LV=WORKSIZE,SP=WORKSP   GET INITIAL CORE            11700000
         LR    R12,R1              SETUP BASE FOR WORKAREA              11730000
         LA    R3,SAVEAREA         GET ADDR OF THIS PROGRAMS SAVEAREA   11760000
         ST    R13,D4(R3)          SET UP BACK CHAIN                    11790000
         ST    R3,D8(R13)          SET UP FORWARD CHAIN                 11820000
         LR    R13,R3                   BACKWARD CHAIN AREAS.           11850020
*                                                                       11880020
         MVI   STACKSW,SWOFF       TURN STACK SWITCH OFF                11890020
         LA    R3,PUTLLIST         SETUP                                11910000
         ST    R3,PUTLCON          ADCONS                               11940000
         LA    R3,DPUTLINE         TO                                   11970020
         ST    R3,DPUTLCON          BE USED                             12000020
         LA    R3,CPECB               BY THE                            12030020
         ST    R3,ECBPTR               PUTLINE                          12060020
         XC    CPECB,CPECB               ROUTINES                       12090020
         L     R3,CPPLUPT-CPPL(R2) GET UPT PTR                          12120020
         ST    R3,UPTPTR           SAVE UPT POINTER                     12150000
         L     R3,CPPLPSCB-CPPL(R2)  GET PSCB PTR                       12170000
         ST    R3,PSCBPTR          SAVE IT                              12190000
         L     R3,CPPLECT-CPPL(R2)  GET ECT PTR                         12210000
         ST    R3,ECTPTR           SAVE IT                              12230000
         ST    R2,TMPSR1                                                12280020
         LOAD  EP=IKJPUTL                                               12300020
         ST    R0,PUTLADDR                                              12330020
         XC    RETCODE,RETCODE     SET RETURN CODE TO ZERO              12360000
         XC    CIRADDR,CIRADDR     INDICATE CIR NOT LOADED     @YL026YA 12366000
         XC    PROCNM,PROCNM       INITIALLY PROCESSING DSNAMES        *12372000
                                   FROM PARSE LIST             @YL026YA 12378000
         MVI   FIRSTIME,ONE        TURN ON FIRST ALLOC SWITCH           12384000
         XC    ALLOCSW(L3),ALLOCSW  CLEAR CONTROL BYTES                 12390020
         XC    ERRPARM(ERRLIST),ERRPARM  CLEAR ERROR PARM LIST          12420020
         MVC   GETML(LILFS),GETMLMDL MOVE LIST FORMS OF GETMAIN ETC     12480020
         MVI   OUTBUF,BLANK        CLEAR OUTPUT BUFFER                  12510000
         MVC   OUTBUF+D1(L'OUTBUF-D1),OUTBUF                            12540000
         MVC   DPUTLINE(LTPUTL),TPUTMDL INITIALIZE PUTLINE              12570000
         ST    R12,OBTJFCBX        SAVE ADDR OF JFCB WORK AREA          12600000
         LA    R3,OBTDCB           ADDR OF DCB IN DSECT                 12630000
         USING IHADCB,R3                                                12660000
         MVC   OBTMACS(LOLFS),OLFS MOVE MACRO LIST FORMS TO DSECT       12690000
         LA    R15,OBTDCBXL        ADDR OF DCB EXIT LIST                12720000
         ST    R15,DCBEXLST        SET UP EXIT LIST ADDRESS             12750000
         MVI   OBTJFCBX,EXITCODE   SET JFCB DCB EXIT CODE               12780000
         DROP  R3                                                       12810020
*                                                                       12840020
*        SETUP PARMLIST FOR PARSE, THEN PARSE COMMAND STRING            12870020
*                                                                       12900020
         LA    R1,PUTLLIST         POINT TO PARSE PARM LIST      100000 12930021
         USING PPL,R1              USE PARSE PARM LIST DSECT     100000 12960021
         L     R3,UPTPTR           UPT POINTER TO-               100000 13050021
         ST    R3,PPLUPT           PARSE PARM LIST               100000 13080021
         L     R3,ECTPTR           ECT POINTER TO-               100000 13110021
         ST    R3,PPLECT           PARSE PARM LIST               100000 13140021
         L     R3,ECBPTR           ECB POINTER TO-               100000 13170021
         ST    R3,PPLECB           PARSE PARM LIST               100000 13200021
         L     R3,PARSECON         PCL POINTER TO-               100000 13230021
         ST    R3,PPLPCL           PARSE PARM LIST-              100000 13260000
         LA    R3,PARDSECT         ANSWER PLACE POINTER TO-      100000 13290000
         ST    R3,PPLANS           PARSE PARM LIST               100000 13320000
         L     R3,D0(R2)           COMMAND BUFFER POINTER        100000 13350000
         ST    R3,PPLCBUF          TO PARSE PARM LIST            100000 13380021
         DROP  R1                  DSECT NO LONGER NEEDED        100000 13410021
         LINK  EP=IKJPARS,MF=(E,(1))                                    13470020
*                                                                       13500020
*    TEST FOR PARSE RETURN CODES--IF ATTENTION, RETURN WITH RC OF 12    13530020
*                                                                       13560020
         B     PARSCODE(R15)       ANALYZE RETURN CODE FROM PARSE       13590000
*                                                                       13630000
PARSCODE B     PARSCD00            RC=00 SUCESSFUL PARSE                13670000
         B     PARSCD04            RC=04 UNABLE TO PROMPT (NO-PROMPT    13710000
*                                                MODE)                  13750000
         B     PARSCD08            RC=08 ATTENTION--ECB POSTED          13790000
         B     PARSCD12            RC=12 INVALID PARAMETERS             13830000
PARSCD16 EQU   *                   RC=16 NO SPACE AVAILABLE             13870000
         MVI   ERR1,MSG14          MESSAGE 14                           13910000
         B     PARSERR2            GO PROCESS ERROR                     13950000
PARSCD12 EQU   *                                                        13990000
         LR    R6,R15              SAVE RETURN CODE                     14030000
         BAL   R8,CVDREG15         GO CONVERT REG 15 AND SET UP INSERT  14070000
         MVI   ERR2,SECMSG16       SECOND LEVEL MESSAGE 16              14140020
         MVI   ERR1,MSG13          MESSAGE 13                           14150020
PARSERR2 BAL   R8,ERROUT           GO WRITE MESSAGE                     14160020
PARSCD04 EQU   *                                               @ZA01485 14210003
PARSCD08 LA    R1,RETCD12          GET RC FOR TMP                       14460000
         MVI   STACKSW,SWON        TURN STACK SWITCH ON        @ZA01485 14480003
         ST    R1,RETCODE          SAVE IT FOR WRAPUP ROUTINE           14500000
         B     WRAPUP              GO TERMINATE                         14520000
*                                                                       14550020
*    SUCESSFUL RETURN FROM PARSE COMES HERE                             14580020
*                                                                       14610020
PARSCD00 EQU   *                                                        14640020
         L     R10,PARDSECT        GET POINTER TO PARSE DSECT           14670000
         USING IKJPARMD,R10                                             14680000
         TM    PHISTORY+D1,ONE     WAS HISTORY REQUESTED                14690000
         BNO   PARS00              NO, CHECK STATUS                     14700000
         OI    OPTMASK,HISTORY     YES, SET INDICATOR IN MASK           14710000
PARS00   TM    PSTATUS+D1,ONE      WAS STATUS REQUESTED                 14720000
         BNO   PARS01              NO, CHECK MEMBERS                    14730000
         OI    OPTMASK,STATUS      YES, SET INDICATOR                   14740000
         L     R15,STIVCON         GET ADDR OF STATUS INIT RTN @YL026YA 14750000
         BALR  R8,R15              INITIALIZE INFORMATION      @YL026YA*14760000
                                   RETRIEVAL                   @YL026YA 14770000
PARS01   TM    PMEMBERS+D1,ONE     WAS MEMBERS REQUESTED                14780000
         BNO   PARS02              NO, CHECK LABEL                      14790000
         OI    OPTMASK,MEMBERS     YES, SET INDICATOR                   14800000
         LOAD  EP=IKJEHMEM                                              14810000
         ST    R0,MEMMOD                                                14820000
PARS02   TM    PLABEL+D1,ONE       WAS LABEL SPECIFIED                  14830000
         BNO   PARS03              NO, CHECK CATALOG           @YL026YA 14840000
         OI    OPTMASK,LABEL       YES, SET INDICATOR                   14850000
PARS03   TM    PCATLG+D1,ONE       WAS CATALOG SPECIFIED?      @YL026YA 14860000
         BNO   PARS04              NO - CHECK LEVEL            @YL026YA 14870000
         OI    OPTMASK2,CATALOG    YES - SET MASK BIT          @YL026YA 14880000
* BUILD A 44-BYTE CATALOG NAME IN THE WORKAREA                 @YL026YA 14890000
         MVI   CATBUFF,BLANK       CLEAR BUFFER TO BLANKS      @YL026YA 14900000
         MVC   CATBUFF+D1(L'CATBUFF-L1),CATBUFF                @YL026YA 14910000
         LA    R7,CATBUFF          POINT TO BUFFER             @YL026YA 14920000
         L     R3,PCATNM           POINT TO CATALOG NAME       @YL026YA 14930000
         LH    R2,PCATNM+DSNLEN    GET LENGTH OF NAME          @YL026YA 14940000
         BCTR  R2,R0               DECREMENT FOR EX INST.      @YL026YB 14950000
         EX    R2,MOVE             MOVE NAME TO BUFFER         @YL026YA 14960000
PARS04   TM    PLEVEL+D1,ONE       WAS LEVEL SPECIFIED         @YL026YA 14970000
         BNO   MAINLINE            NO - START PROCESSING       @YL026YA 14980000
         OI    OPTMASK2,LEVEL      YES - SET MASK BIT          @YL026YA 14990000
         L     R15,VCONCIR         ADDRESS OF CIR              @YL026YB 15000000
         BALR  R8,R15              BRANCH TO CIR               @YL026YB 15010000
         B     MAINLINE            RETURN CODE ZERO            @YL026YB 15020000
         B     GOWRT               NONZERO RETURN CODE         @YL026YB 15030000
*                                                                       15180020
*    MAINLINE ROUTINE                                                   15210020
*                                                                       15240020
MAINLINE EQU   *                                                        15270020
         LA    R9,PDSLIST          POINT AT FIRST ENTRY IN DSNAME LIST  15300000
         CLC   CHAINAD(L4,R9),NOTCHAIN WAS A DSLIST ENTERED?   @YL026YA 15300100
         BE    MAINL01             NO - OK                     @YL026YA 15300200
         TM    OPTMASK2,LEVEL      YES - WAS LEVEL SPECIFIED?  @YL026YA 15300300
         BO    LEVELER             YES - LIST NOT ALLOWED      @YL026YA 15300400
*                                  WITH LEVEL                  @YL026YA 15300500
MAINL01  EQU   *                                               @YL026YA 15300600
         XC    STAELIST(STAELNTH),STAELIST   CLEAR STAE BLOCKS          15301020
         LOAD  EP=IKJEHSIR         LOAD STAE INTERFACE ROUTINE          15302020
         ST    R0,STAEADDR         SAVE ADDRESS OF STAE ROUTINE         15303020
BLDSTAE  PSEUDO TMP=TMPSR1,MF=E                                         15304020
         STABUILD CODE=(113,213,313,713,913),ADDR=STAEONE,NUM=2,       X15305020
               FLAG=(MUL,NMSG),LIST=STAELST,RTN=OPENERR,               X15306020
               MF=E                                                     15307020
         STABUILD CODE=000,RTN=ANYABND,ADDR=STAETWO,                   X15308020
               FLAG=(ALL,NMSG,END),                                    X15309020
               MF=E                                                     15310020
         STAEPARM FLAG=(CP),LIST=STAEONE,ADDR=STAEPARM,PSEUDO=$PSEUDO, X15311020
               MF=E                                                     15312020
         L     R2,STAEADDR         POINTER TO STAE INTERFACE ROUTINE    15313020
         STAE  (R2),CT,PARAM=STAEPARM,MF=(E,STAELIST)                   15314020
         B     NXDSNAME            CONTINUE  MAINLINE                   15315020
ANYABND  EQU   *                                                        15316020
         MVI   ERR2,SECMSG14       ABEND ERROR CODE MSG                 15317020
MCOM5    MVI   ERR1,MSG09          DSNAME NOT USABLE MSG                15318020
         LA    R5,ERRINSRT         PUT ADDRESS OF INSERT                15319020
         ST    R5,ERRINST2         INTO INSERT SLOT                     15320020
         STH   R1,CNVRTWD          PLACE RETURN CODE IN AREA            15321020
         LA    R4,CNVRTWD          ADDR OF AREA FOR CONVERT RTN         15322020
         L     R2,STAEADDR         POINTER TO STAE INTERFACE ROUTINE    15323020
         STAE  (R2),CT,PARAM=STAEPARM,MF=(E,STAELIST)                   15324020
         B     MCOM4               GO TO COMMON RTN                     15325020
OPENERR  EQU   *                                                        15326020
         MVI   ERR2,SECMSG12       OPEN ERROR CODE                      15327020
         B     MCOM5               SET UP MESSAGE                       15328020
     EJECT                                                              15330020
NXDSNAME DS    0H                                                       15360020
*********************************************************************** 15390020
*                                                                     * 15420020
*   THIS ROUTINE INTERFACES WITH THE DEFAULT SERVICE ROUTINE (IKJDFLT)* 15450020
*   IF A NAME IS FOUND IN THE DSLIST WHICH IS NOT FULLY QUALIFIED. THE* 15480020
*   SERVICE ROUTINE WILL APPEND THE USERID AND ADD THE APPROPRIATE    * 15510020
*   DESCRIPTIVE QUALIFIER. WHEN CONTROL IS RETURNED, CURNTNAM WILL    * 15540020
*   CONTAIN THE FULLY QUALIFIED DSNAME.  IF NO DSNAME IS SPECIFIED    * 15570020
*   (INDICATING A MEMBERNAME WAS ENTERED ALONE), AN ERROR MESSAGE     * 15600020
*   IS PUT OUT TO THE TERMINAL AND THE NEXT NAME IN THE LIST IS       * 15630020
*   SELECTED.                                                         * 15660020
*                                                                     * 15690020
*********************************************************************** 15720020
*                                                                       15727020
         ST    R9,$RETRY0+R9*L4    STORE CURRENT R9 FOR RETRY           15734000
*                                                                       15764000
         MVI   CURNTNAM,BLANK      BLANK OUT AREA FOR DSNAME            15794000
         MVC   CURNTNAM+D1(L'CURNTNAM-L1),CURNTNAM BLANK ENTIRE AREA    15824000
         TM    DSNFLAGS(R9),HIGHBIT  IS DSNAME OMITTED                  15854000
         BZ    NAMERR              YES, PROCESS AS AN ERROR    @YL026YA 15884000
         LH    R1,DSNLEN(R9)       LENGTH OF DSNAME                     15914000
         STH   R1,CURNTNAM         SAVE LENGTH                          15944000
         BCTR  R1,R0               DECREMENT LENGTH FOR EX OF MOVE      15974000
         LA    R7,TEMPNAME         POINT AT AREA TO HOLD NAME           16004000
         L     R3,DSNADDR(R9)      NAME TO MOVE                @YL026YA 16034000
         EX    R1,MOVE             MOVE NAMES                           16064000
         TM    DSNFLAGS(R9),QUOTED SEE IF DSNAME IS QUOTED              16140020
         BO    QUOTNAME            YES, GO PROCESS AS IS         A42337 16170021
*  SAVE UNQUALIFIED DATA SET NAME FOR MESSAGES                   A42337 16180021
         LA    R1,D2(R1)           UP LENGTH FOR LENGTH FIELD    A42337 16190021
         LA    R7,MSGNAMEL         MESSAGE LENGTH-NAME BUFFER    A42337 16200021
         LA    R3,CURNTNAM         DATA SET LENGTH-NAME BUFFER   A42337 16210021
         EX    R1,MOVE             MOVE DSNAME TO BUFFER         A42337 16220021
         B     ASTERCK             GO CHECK NAME FOR ASTERISK  @YL026YA 16260000
**     SET UP DEFAULT PARM LIST USING MAP MACROS         *              16300000
QUALNAM  LA    R1,PUTLLIST         POINT TO PARM LIST          @YL026YA 16340000
         USING DFPL,R1             IKJDFPL MAP MACRO             100000 16380021
         L     R3,UPTPTR           UPT POINTER TO-               100000 16440021
         ST    R3,DFPLUPT          DEFAULT PARM LIST             100000 16470021
         L     R2,ECTPTR           GET ECTPTR                           16500000
         ST    R2,DFPLECT          PUT IN LIST                          16530000
         L     R4,ECBPTR           GET ECB PTR                          16560000
         ST    R4,DFPLECB          PUT IN LIST                 @VS06783 16590000
         LA    R3,DEFLIST          DEFAULT PARM LIST ADDRESS-    100000 16620021
         ST    R3,DFPLDFPB         TO DEFAULT PARM LIST          100000 16650021
         DROP  R1                  IKJDFPL NO LONGER NEEDED      100000 16680021
         USING DFPB,R3             MACRO IKJDFPB                        16830020
         LA    R2,CURNTNAM         DSNAME PRECEDED BY LENGTH-    100000 16890021
         ST    R2,DFPBDSN          PUT INTO DEFAULT LIST         100000 16920000
         OI    DFPBCODE,OPT04      INDICATE OPTION REQUESTED OF DEFAULT 16950000
         L     R2,PSCBPTR          PSCB ADDRESS TO-              100000 16980000
         ST    R2,DFPBPSCB         DEFAULT PARM BLOCK            100000 17010000
         DROP  R3                                                       17070020
******************************************************                  17100020
         LINK  EP=IKJDFLT,MF=(E,(1))                                    17160020
*                                                                       17190020
         LA    R8,DSNTEST1                                     @YL026YB 17196000
         ST    R8,RETADDR                                      @YL026YB 17202000
         B     DEFCODE(R15)        ANALYZE  RETURN CODE                 17210020
DEFCODE  B     DEFOK               SUCCESS                              17230020
         B     DSNTEST             MSG BY DEFAULT, GET NEXT DSNAME      17250020
         B     DEF8                INVALID NAME                         17270020
         B     DSNTEST             MSG BY DEFAULT, GET NEXT DSNAME      17290020
         B     DEF16               DSNAME NOT IN CATLG                  17310020
         B     DEF16               DSNAME NOT IN CATLG                  17330020
         B     DEF28               NOT POSSIBLE                         17350020
         B     DEF28               COMMAND SYSTEM ERROR                 17370020
         B     DEF16               NOT POSSIBLE                         17390020
*  THIS IS NOT AN UNCONDITIONAL BRANCH TO THE NEXT SEQUENTIAL           17400020
*  INSTRUCTION.  IT IS DEFAULT RC=36                                    17402020
DEF16    EQU   *                   DEFAULT RC=16,20,32,36               17460020
         MVI   ERR1,MSG01          MESSAGE 1                            17462020
         B     MCOMMON3            INSERT NAME IN MESSAGE               17464020
DEF8     EQU   *                                                        17470020
         MVI   ERR1,MSG16          MESSAGE 16                           17490020
         B     RETCOM2             PUT OUT REST OF MSG                  17510000
DEF28    EQU   *                                                        17570020
         MVI   ERR1,MSG13          COMMAND SYSTEM ERROR                 17590020
         MVI   ERR2,SECMSG17       DEFAULT ERROR CODE                   17610020
         B     GOWRT               PUT OUT MESSAGE                      17630020
QUOTNAME LA    R7,MSGNAME          DSNAME MESSAGE BUFFER         A42337 18200021
         MVI   D0(R7),QUOTE        MOVE QUOTE                    A42337 18250021
         LA    R7,D1(R7)           POINT PAST QUOTE              A42337 18300021
         EX    R1,MOVE             MOVE IN DSNAME                A42337 18310021
         LA    R7,D1(R1,R7)        POINT PAST DSNAME             A42337 18320021
         MVI   D0(R7),QUOTE        MOVE QUOTE                    A42337 18322021
         LA    R1,D3(R1)           UP LENGTH FOR QUOTES AND EXEC A42337 18324021
         STH   R1,MSGNAMEL         SAVE DSNAME LENGTH            A42337 18326021
*                                                              @YL026YA 18328000
*   CHECK THE DSNAME FOR ASTERISKS.  IF NONE, PROCESS THE      @YL026YA 18328200
*   DATA SET.  IF AN ASTERISK APPEARS, OR LEVEL WAS SPECIFIED, @YL026YA 18328400
*   CALL CIR TO GET A LIST OF NAMES TO PROCESS.                @YL026YA 18328600
*                                                              @YL026YA 18328800
ASTERCK  EQU   *                                               @YL026YA 18329000
         LA    R2,TEMPNAME         ADDRESS OF NAME             @YL026YA 18329200
         LH    R3,CURNTNAM         LENGTH OF NAME              @YL026YA 18329400
         L     R15,VCONAST         GET ADDRESS OF ASTERISK     @YL026YA 18329600
*                                  ROUTINE                     @YL026YA 18329800
         BALR  R14,R15                                         @YL026YA 18330000
         B     STARER1             * IN FIRST LEVEL - ERROR    @YL026YA 18330200
         B     STARER2             MORE THAN ONE * - ERROR     @YL026YA 18330400
         CLI   STARLEV,ZERO        OK - IS THERE AN * ?        @YL026YA 18330600
         BNE   ASTERNM             YES - CALL CIR              @YL026YA 18330800
         TM    OPTMASK2,LEVEL      NO - WAS LEVEL SPECIFIED ?  @YL026YA 18331000
         BO    LEVL1               YES - PROCESS LEVEL         @YL026YA 18331200
         TM    DSNFLAGS(R9),QUOTED NO * - IS NAME QUOTED ?     @YL026YA 18331400
         BO    DEFGO               QUOTED NAMES - CONTINUE     @YL026YA 18331600
         B     QUALNAM             UNQUOTED - QUALIFY THE NAME @YL026YA 18331800
ASTERNM  EQU   *                   * IN NAME - GET NAME LIST   @YL026YA 18332000
*   SET UP TO CALL CIR                                         @YL026YA 18332200
         L     R15,VCONCIR                                              18332400
         BALR  R8,R15                                                   18332600
         B     LEVL1                                                    18332800
         B     GOWRT                                                    18333000
LEVL1    TM    OPTMASK2,CATALOG    WAS CATALOG NAME GIVEN?     @YL026YA 18333200
         BO    CATOK               YES - ALREADY SET UP        @YL026YA 18333400
*                                  NO - USE DATASET PASSWORD   @YL026YA 18333600
         LH    R2,PWLEN(R9)        LENGTH OF PASSWORD          @YL026YA 18333800
         LA    R3,PWRDADDR(R9)     ADDRESS OF PASSWORD         @YL026YA 18334000
         BCTR  R2,R0               DECREMENT LENGTH FOR MOVE   @YL026YA 18334200
         LTR   R2,R2               CHECK FOR POSITIVE NO.      @YL026YB 18334400
         BNP   CATOK               NO,GOTO CATOK               @YL026YB 18334600
         LA    R7,CIRPASS          ADDRESS OF PASSWORD BUFFER  @YL026YA 18334800
         EX    R2,MOVE             MOVE THE PASSWORD           @YL026YA 18335000
CATOK    EQU   *                                               @YL026YA 18335200
         MVI   CIRDSN,BLANK        CLEAR DSNAME BUFFER         @YL026YA 18335400
         MVC   CIRDSN+D1(L'CIRDSN-L1),CIRDSN                   @YL026YA 18335600
         LA    R7,CIRDSN           ADDRESS OF CIR DSNAME       @YL026YA 18335800
*                                  BUFFER                      @YL026YA 18336000
         TM    OPTMASK2,LEVEL      WAS LEVEL SPECIFIED ?       @YL026YB 18336200
         BNO   NOLEV               NO, PROCESSING '*' NAME     @YL026YB 18336400
         LA    R3,TEMPNAME         POINT TO DATASET NAME       @YL026YB 18336600
         LH    R2,CURNTNAM         LOAD LENGTH OF NAME         @YL026YB 18336800
         EX    R2,MOVE             MOVE NAME TO BUFFER         @YL026YB 18337000
         B     CALLCIR             GO TO CIR                   @YL026YB 18337200
*                                                              @YL026YB 18337400
NOLEV    LA    R3,TEMPNAME         POINT TO DATA SET NAME      @YL026YA 18337600
         L     R2,STARADR          POINT TO ASTERISK           @YL026YA 18337800
         SR    R2,R3               ASTERISK DISPLACEMENT       @YL026YA 18338000
         BCTR  R2,R0               DECREMENT FOR EX INST.      @YL026YB 18338200
         EX    R2,MOVE             MOVE THE NAME TO CIR NAME   @YL026YA 18338400
*                                    BUFFER                    @YL026YA 18338600
*   SAVE THE TRAILING QUALIFIERS FOR LATER COMPARISON.         @YL026YA 18338800
*                                                              @YL026YA 18339000
         LA    R2,2(R2)           LENGTH OF NAME TO ASTERISK  @YL026YA  18339200
         CH    R2,CURNTNAM         COMPARE TO LENGTH OF NAME   @YL026YA 18339400
*   IF LENGTHS ARE EQUAL THE ASTERISK IS IN THE LAST POISITION @YL026YA 18339600
*   OF THE NAME AND THE TRAILING QUALIFIER IS STORED AS        @YL026YA 18339800
*   BLANKS; OTHERWISE, SAVE THE TRAILING QUALIFIER.            @YL026YA 18340000
         BNE   SAVEQUAL            ASTERISK NOT IN LAST LEVEL  @YL026YA 18340200
         SR    R0,R0               CLEAR REG ZERO              @YL026YB 18340400
         STH   R0,LASTQLEN         LENGTH IS ZERO              @YL026YA 18340600
         BCTR  R2,R0              DECREMENT FOR EX INST.       @YL026YB 18340800
         MVI   LASTQUAL,BLANK      BLANKS FOR TRAILING QUAL.   @YL026YA 18341000
         MVC   LASTQUAL+D1(L'LASTQUAL-L1),LASTQUAL             @YL026YA 18341200
         B     CALLCIR             GO GET LIST OF NAMES        @YL026YA 18341400
SAVEQUAL EQU   *                                               @YL026YA 18341600
         LH    R4,CURNTNAM         LENGTH OF NAME              @YL026YA 18341800
         SR    R4,R2               LENGTH OF NAME AFTER *      @YL026YA 18342000
         LA    R3,D0(R3,R2)        ADDRESS OF TRAILING PART    @YL026YA 18342200
*                                  OF NAME                     @YL026YA 18342400
         STH   R4,LASTQLEN         SAVE LENGTH                 @YL026YA 18342600
         BCTR  R4,R0               DECREMENT FOR MOVE          @YL026YA 18342800
         LA    R7,LASTQUAL         ADDRESS OF LAST QUALIFIER   @YL026YA 18343000
         EX    R4,MOVE             MOVE THE TRAILING QUALIFIER @YL026YA 18343200
         BCTR  R2,R0               DECREMENT TO ELIMINATE *    @ZA05439 18343303
CALLCIR  EQU   *                                               @YL026YA 18343400
*   NOW GET A LIST OF NAMES FROM CIR                           @YL026YA 18343600
         STH   R2,0(R13)                                       @YL026YB 18343800
         L     R15,CIRADDR         ADDRESS OF IKJEHCIR         @YL026YA 18344000
         LA    R1,CIRPARM          ADDRESS OF PARAMETER LIST   @YL026YA 18344200
         CALL  (15)                GO TO CIR                   @YL026YA 18344400
         LTR   R15,R15             TEST RETURN CODE            @YL026YA 18344600
         BNZ   CIRERROR            NON-ZERO IS ERROR           @YL026YA 18344800
         ST    R9,PARSPTR          SAVE PTR TO PARSE DSNAME    @YL026YA 18345000
         L     R9,CIRWA            GET ADDR OF CIR RETURN AREA @YL026YA 18345200
         LA    R9,D4(R9)           POINT TO FIRST TYPE/DSNAME  @YL026YA 18345400
NAMELOOK EQU   *                                               @YL026YA 18345600
*   NO ENTRY-TYPE CHECKING HERE YET.                           @YL026YA 18345800
         LA    R9,D1(R9)           POINT TO NEXT DSNAME        @YL026YA 18346000
         OI    PROCNM,CIRLIST      INDICATE PROCESSING CIR NAME         18346200
         TM    OPTMASK2,LEVEL      WAS LEVEL SPECIFIED?        @YL026YA 18346400
         BO    NAMEMOVE            YES - PROCESS EVERY NAME    @YL026YA 18346600
*                                  NO - TEST QUALIFIERS        @YL026YA 18346800
         MVC   NAMEBUFF,CIRDSN     MOVE PARTIAL NAME TO BUFFER @YL026YA 18347000
*   MOVE ONE QUALIFIER                                         @YL026YA 18347200
         LA    R3,D8               INITIALIZE LOOP INDEX TO    @YL026YA 18347400
*                                  COUNT 8 CHARACTERS          @YL026YA 18347600
         LA    R4,NAMEBUFF         ADDRESS OF NAME BUFFER      @YL026YA 18347800
         LH    R2,0(R13)           GET LENGTH OF NAME          @YL026YB 18348000
         LR    R1,R2               SAVE LENGTH                          18348200
         LA    R2,D0(R4,R2)        END OF PARTIAL NAME         @YL026YA 18348400
         LR    R5,R9               POINT TO FIRST CHARACTER OF @YL026YA 18348600
*                                  DATA SET NAME               @YL026YA 18348800
         LA    R5,D0(R5,R1)        POINT TO QUALIFIER IN       @YL026YA 18349000
*                                  ASTERISK POSITION           @YL026YA 18349200
LOOPCHAR EQU   *                                               @YL026YA 18349400
         CLI   D0(R5),BLANK        IS IT A BLANK ?             @YL026YA 18349600
         BE    ENDNAME             YES - END OF NAME - QUIT    @YL026YA 18349800
         CLI   D0(R5),PERIOD       OR A PERIOD ?               @YL026YA 18350000
         BE    ENDNAME             YES - END OF QUALIFIER      @YL026YA 18350200
         MVC   D0(L1,R2),D0(R5)    MOVE THE CHARACTER          @YL026YA 18350400
         LA    R5,D1(R5)           LOOK AT NEXT CHARACTER      @YL026YA 18350600
         LA    R2,D1(R2)           LOOK AT NEXT CHARACTER      @YL026YA 18350800
         BCT   R3,LOOPCHAR         LOOP UNTIL 8 CHARACTERS     @YL026YA 18351000
*                                  HAVE BEEN MOVED             @YL026YA 18351200
ENDNAME  LH    R4,LASTQLEN         LENGTH OF TRAILING QUALIFIERS        18351400
         LA    R4,D0(R4,R1)        PLUS LENGTH SO FAR          @YL026YA 18351600
         LA    R3,MAXDSN           MAX LENGTH OF NAME          @YL026YA 18351800
         CR    R4,R3               IS NAME TOO LONG?           @YL026YA 18352000
         BH    NAMERR              YES - PUT OUT MESSAGE       @YL026YA 18352200
         LH    R1,LASTQLEN         NO - GET LENGTH OF QUALS.   @YL026YA 18352400
         LTR   R1,R1               IS LENGTH ZERO?             @YL026YA 18352600
         BZ    NOQUAL              YES - NO QUALIFIER          @YL026YA 18352800
         BCTR  R1,R0               DECREMENT LENGTH FOR MOVE   @YL026YA 18353000
         LR    R7,R2               WHERE TO MOVE               @ZA05439 18353203
*                                  (AFTER PARTIAL NAME)        @YL026YA 18353400
         LA    R3,LASTQUAL         ADDRESS OF TRAILING QUALS   @YL026YA 18353600
         EX    R1,MOVE             MOVE IN TRAILING QUALIFIERS @YL026YA 18353800
NOQUAL   CLC   NAMEBUFF,D0(R9)     IS THIS THE NAME            @YL026YA 18354000
*                                  RETURNED BY CIR ?           @YL026YA 18354200
         BE    NAMEMOVE            YES - USE IT                @YL026YA 18354400
*   LOOK AT NEXT NAME                                          @YL026YA 18354600
NEXTCIR  EQU   *                                               @YL026YA 18354800
         LA    R9,MAXDSN(R9)       STEP PAST NAME              @YL026YA 18355000
         L     R7,CIRWA            GET ADDRESS OF WORK AREA    @YL026YA 18355200
         LH    R3,D2(R7)           GET WORK AREA LENGTH        @YL026YA 18355400
         LA    R7,D0(R7,R3)        ADDRESS OF END OF WORK AREA @YL026YA 18355600
         CR    R9,R7               IS NEXT NAME OUT OF WORK AREA?       18355800
         BL    NAMELOOK            NO - DO NEXT NAME FROM LIST @YL026YA 18356000
         XC    PROCNM,PROCNM       NO MORE NAMES - GO BACK TO  @YL026YA 18356200
*                                  DSLIST                      @YL026YA 18356400
         L     R9,PARSPTR          RESTORE DSLIST ADDRESS      @YL026YA 18356600
         B     DSNTEST             PROCESS NEXT NAME           @YL026YB 18356800
*   MOVE NAME TO CURNTNAM AND MESSAGE BUFFER                   @YL026YA 18357000
NAMEMOVE EQU   *                                               @YL026YA 18357200
         MVC   TEMPNAME,D0(R9)     MOVE NAME TO BUFFER         @YL026YA 18357400
         MVC   MSGNAME,D0(R9)      MOVE NAME TO MESSAGE BUFFER @YL026YA 18357600
         LA    R2,MAXDSN           MAXIMUM LENGTH OF NAME      @YL026YA 18357800
BLNKCT   LA    R3,TEMPNAME         ADDRESS OF NAME             @YL026YA 18358000
         LA    R3,D0(R3,R2)        ADDRESS OF NEXT CHARACTER   @YL026YA 18358200
         CLI   D0(R3),BLANK        IS THIS CHARACTER BLANK?    @YL026YA 18358400
         BNE   BLNKEND             NO - STORE LENGTH OF NON-   @YL026YA 18358600
*                                  BLANK NAME                  @YL026YA 18358800
         BCT   R2,BLNKCT           YES - LOOP UNTIL NON-BLANK  @YL026YA 18359000
*                                  CHARACTER FOUND             @YL026YA 18359200
BLNKEND  STH   R2,CURNTNAM         LENGTH OF NON-BLANK NAME    @YL026YA 18359400
         STH   R2,MSGNAMEL         TO BOTH BUFFERS             @YL026YA 18359600
         B     DEFGO               PROCESS THIS NAME            ZA02173 18359802
*                                                              @YL026YA 18360000
*   ERROR ROUTINES                                             @YL026YA 18360200
*                                                              @YL026YA 18360400
CIRERROR EQU   *                                               @YL026YA 18360600
         LA    R8,DSNTEST1           GOTO WRAPUP ROUTINE       @VS06783 18360800
         ST    R8,RETADDR          SAVE WRAPUP ADDRESS         @YL026YB 18361000
         MVI   ERR1,MSG20          MESSAGE 20 (NOT IN CATALOG) @VS06783 18361200
         B     MCOMMON3            INSERT DATA SET NAME IN MSG @YL026YA 18361400
STARER1  EQU   *                                               @YL026YA 18361600
         LA    R8,DSNTEST1         GOTO WRAPUP ROUTINE         @VS06783 18361800
         ST    R8,RETADDR          SAVE WRAPUP ROUTINE         @YL026YB 18362000
         MVI   ERR1,MSG18          INVALID USE OF ASTERISK     @YL026YA 18362200
         MVI   ERR2,SECMSG21       NOT ALLOWED IN FIRST LEVEL  @YL026YA 18362400
         B     MCOMMON3            GO PUT OUT MESSAGE          @YL026YA 18362600
STARER2  EQU   *                                               @YL026YA 18362800
         LA    R8,DSNTEST1         GOTO WRAPUP ROUTINE         @VS06783 18363000
         ST    R8,RETADDR          SAVE WRAPUP ADDRESS         @YL026YB 18363200
         MVI   ERR1,MSG18          INVALID USE OF ASTERISK     @YL026YA 18363400
         MVI   ERR2,SECMSG22       MORE THAN ONE NOT ALLOWED   @YL026YA 18363600
         B     MCOMMON3            GO PUT OUT MESSAGE          @YL026YA 18363800
LEVELER  EQU   *                                               @YL026YA 18364000
         LA    R8,WRAPUP           GOTO WRAPUP ROUTINE         @YL026YB 18364200
         ST    R8,RETADDR          SAVE WRAPUP ADDRESS         @YL026YB 18364400
         MVI   RETCODE+3,RT12      SET RETURN CODE             @ZA01485 18364503
         MVI   ERR1,MSG17          NO DSLIST WITH LEVEL        @YL026YA 18364600
         B     GOWRT               GO PUT OUT MESSAGE          @YL026YA 18364800
NAMERR   EQU   *                                                        18365000
*                                                                       18365200
*   MEMBER NAME SPECIFIED ALONE--ERROR SINCE THIS ROUTINE IS UNABLE     18365400
*   TO DETERMINE THE FULLY QUALIFIED NAME DESIRED.                      18365600
*                                                                       18365800
         LH    R1,MEMLEN(R9)       GET LENGTH OF MEMBERNAME             18366000
         L     R3,MEMADDR(R9)      GET ADDR OF MEMBERNAME               18366200
         STH   R1,CURNTNAM         SAVE LENGTH                          18366400
         BCTR  R1,R0               DECREMENT FOR EX OF MOVE             18366600
         LA    R7,TEMPNAME         AREA TO HOLD MEMBERNAME              18366800
         EX    R1,MOVE             MOVE NAME TO AREA                    18367000
         MVI   ERR1,MSG07          MESSAGE 7                            18367200
         B     RETCOM2             FILL IN REST OF MSG                  18367400
*  NOW STRIP OFF USERID AND SAVE DATA SET NAME FOR MESSAGES      A42337 18367600
DEFOK    L     R3,UPTPTR           POINT TO UPT                @YL026YB 18367800
         USING UPT,R3              ADDRESSABILITY PSCB           A42337 18368000
         SR    R1,R1               CLEAR REGISTER                A42337 18368200
         IC    R1,UPTPREFL         USERID LENGTH                 A42337 18368400
         LA    R1,D1(R1)           PLUS ONE FOR PERIOD           A42337 18380021
         DROP  R3                  PSCB NO LONGER NEEDED         A42337 18382021
         LH    R2,CURNTNAM         LENGTH OF QUALIFIED DSNAME    A42337 18384021
         LA    R7,MSGNAME          DATA SET NAME MESSAGE BUFFER  A42337 18386021
         LA    R3,TEMPNAME         QUALIFIED DATA SET NAME       A42337 18388021
         SR    R2,R1               MINUS USERID LENGTH           A42337 18388421
         STH   R2,MSGNAMEL         SAVE DATA SET NAME LENGTH     A42337 18388521
         AR    R3,R1               POINT PAST USERID             A42337 18388821
         BCTR  R2,R0               DECREMENT FOR EXECUTE         A42337 18389221
         EX    R2,MOVE             MOVE DATA SET NAME            A42337 18389621
DEFGO    MVC   CONTROL,OPTMASK     INITIALIZE CONTROL BYTE       A42337 18390021
         NI    ALLOCSW,ZERO        TURN OFF ALLOCATE SWITCH             18420000
         L     R1,$RETRY0+R9*L4    GET PTR TO PDE              @ZA06144 18428003
         TM    MEMFLAG(R1),ON      SEE IF MEM NAME WAS GIVEN   @ZA06144 18432003
         BNO   MAIN00              SKIP TURNING ON SWITCH               18436000
         OI    CONTROL,MEMNAME     TURN ON MEMBER INDICATOR             18444000
MAIN00   EQU   *                                                        18452000
         LH    R1,CURNTNAM         GET LENGTH OF NAME                   18460000
         LA    R3,TEMPNAME         POINT AT NAME TO MOVE                18468000
         BCTR  R1,R0               DECREMENT LENGTH FOR EX OF MOVE      18476000
         LA    R7,OUTBUF                                                18484000
         EX    R1,MOVE             MOVE DSNAME TO BUFFER                18492000
         LA    R14,D1(R7,R1)       POINT AT END OF NAME                 18500000
         BAL   R8,WRITE            GO WRITE THE NAME.                   18508000
*                                                                       18516000
*  ISSUE VSAM LOCATE ON THE GIVEN NAME                         @YL026YA 18524000
*                                                              @YL026YA 18532000
*  FIRST BUILD CPL AND WORKAREA                                @YL026YA 18540000
         XC    CPLAREA,CPLAREA     CLEAR AREA FOR CPL          @YL026YA 18548000
         LA    R1,CPLAREA          ADDRESSABILITY FOR CPL      @YL026YA 18556000
         USING CTGPL,R1                                        @YL026YA 18564000
         OI    CTGOPTN1,CTGNAME+CTGCNAME 44-BYTE ENTRY NAME    @YL026YA 18572000
*                                  AND CATALOG NAME            @YL026YA 18580000
         OI    CTGOPTN3,CTGLOC+CTGAM0 SET FUNCTION TO          @YL026YA 18588000
*                                  VSAM LOCATE                 @YL026YA 18596000
         LA    R2,TEMPNAME         POINT TO 44-BYTE ENTRY NAME @YL026YA 18604000
         ST    R2,CTGENT           STORE NAME ADDRESS IN CPL   @YL026YA 18612000
         LA    R2,CATBUFF          POINT TO 44-BYTE CATALOG NAME        18620000
         ST    R2,CTGCAT           STORE NAME ADDRESS IN CPL   @YL026YA 18628000
         LA    R2,CATWORK1         POINT TO WORKAREA           @YL026YA 18636000
         ST    R2,CTGWKA           STORE ADDRESS IN CPL        @YL026YA 18644000
         LA    R2,L'CATWORK1       SET WORKAREA LENGTH         @YL026YA 18652000
         STH   R2,CATWORK1         IN FIRST HALFWORD OF AREA   @YL026YA 18660000
LOCBUILD EQU   *                                               @YL026YA 18668000
         TM    OPTMASK2,CATALOG    WAS CATALOG SPECIFIED?      @YL026YA 18676000
         BO    CATPSWD             YES - GET CATALOG PASSWORD  @YL026YA 18684000
         XC    CTGCAT,CTGCAT       CLEAR CAT.NAME PTR                   18692000
         L     R2,PDSLIST+PWRDADDR NO - GET DSNAME PASSWORD    @YL026YA 18700000
         B     PSWDST                                          @YL026YA 18708000
CATPSWD  LA    R2,CIRPASS          CATALOG PASSWORD            @YL026YA 18716000
PSWDST   ST    R2,CTGPSWD          STORE ADDRESS IN CPL        @YL026YA 18724000
*                                                              @YL026YA 18732000
*  NOW BUILD THE FPL'S                                         @YL026YA 18740000
*                                                              @YL026YA 18748000
         USING CTGFL,R2                                        @YL026YA 18756000
         LA    R2,CTGFL1           POINT TO FIRST FPL          @YL026YA 18764000
         LA    R3,D1               ONE FIELD                   @YL026YA 18772000
         LA    R4,ENTYPE           POINT TO FIRST FIELD        @YL026YA 18780000
         LA    R7,CTGFIELD         POINT TO FIRST CPL SLOT     @YL026YA 18788000
         TM    OPTMASK,HISTORY     WAS HISTORY SPECIFIED?      @YL026YA 18796000
         BNO   NOHIST              NO - SKIP DATES             @YL026YA 18804000
         LA    R5,D8               8 FPLS IF HISTORY OPTION    @YL026YA 18812000
         STC   R5,CTGNOFLD         NO. OF FPLS                 @YL026YB 18820000
         B     FPLLOOP             GO BUILD FPL                @YL026YA 18828000
NOHIST   LA    R5,D6               6 FPLS IF NO HISTORY        @YL026YA 18836000
         STC   R5,CTGNOFLD         NO. OF FPLS                 @YL026YB 18844000
FPLLOOP  EQU   *                                               @YL026YA 18852000
         ST    R2,D0(R7)           STORE FPL ADDRESS IN CPL    @YL026YA 18860000
         XC    D0(CTGFL2-CTGFL1,R2),D0(R2) CLEAR FPL AREA      @YL026YA 18868000
         STC   R3,CTGFLDNO         STORE FIELD COUNT           @YL026YA 18876000
         ST    R4,CTGFLDNM         STORE FIELD NAME            @YL026YA 18884000
         LA    R2,CTGFL2-CTGFL1(R2)  POINT TO NEXT FPL         @YL026YA 18892000
         LA    R4,D8(R4)           POINT TO NEXT FIELD NAME    @YL026YA 18900000
         LA    R7,L'CTGFIELD(R7)   POINT TO NEXT SLOT IN CPL   @YL026YA 18908000
         BCT   R5,FPLLOOP          GO DO NEXT FPL              @YL026YA 18916000
*  ISSUE LOCATE                                                @YL026YA 18924000
         DROP  R1                                              @YL026YA 18932000
         DROP  R2                                              @YL026YA 18940000
         CATLG (1)                                             @YL026YA 18948000
******* RETURN FROM LOCATE IS NOT ANALYZED IN DETAIL AND NO             19020020
*       MESSAGE IS PUT OUT IF A NON ZERO RETURN CODE IS                 19050020
*       RECEIVED . THIS IS BECAUSE ALLOCATE WILL BE ISSUED              19080020
*       AND A MESSAGE PUT OUT THEN                                      19110020
*                                                                       19140020
         LTR   R15,R15             RETURN CODE ZERO SKIP ALLOCATE       19170000
         BZ    TESTTYPE            GO TEST DATA SET TYPE       @YL026YA 19180000
*                                                                       19190000
*                                                                       19200000
*  ALL VSAM DATA SETS ARE CATALOGUED,THEREFORE THIS MUST BE    @VS06171 19210000
*  A NONVSAM DATA SET.                                         @VS06171 19220000
NONVSAM  EQU   *                                               @ZA09142 19225003
         MVI   DSTYPE,CTGTALIN     FORCE NONVSAM DSTYPE        @VS06171 19230000
*********************************************************************** 19290020
*                                                                       19320020
*   A NONZERO RETURN CODE FROM LOCATE INDICATES ONLY THAT THE DSNAME    19350020
*   INFORMATION COULD NOT BE GOTTEN FROM THE CATALOG. NONE OF THE       19380020
*   RETURN CODES CONCLUSIVELY ELIMINATES THE POSSIBILITY OF THE DATA    19410020
*   SET EXISTING AND BEING ACCESSIBLE THROUGH DAIR, SO AN INFORMATIVE   19440020
*   MESSAGE IS PUT OUT INDICATING THAT THE DATASET COULD NOT BE         19470020
*   ACCESSED THROUGH THE CATALOG AND THEN DAIR IS LINKED TO.            19500020
*                                                                       19530020
*                                                                       19560020
*********************************************************************** 19590020
*********************************************************************** 19620020
*                                                                       19650020
*                                                                       19680020
*    INTERFACE WITH DAIR, CODE X'08'. GET DDNAME FROM RETURNED LIST     19710020
*    AND PUT INTO DCB SO RDJFCB CAN BE ISSUED.                          19740020
*                                                                       19770020
*                                                                       19800020
*                                                                       19830020
*                                                                       19860020
*********************************************************************** 19890020
         BAL   R8,ALLOCDS          GO ALLOCATE THE DATA SET    @YL026YA 19920000
         TM    ALLOCSW,ON          ALLOCATE OKAY                        19922020
         BO    ACODE00             GO READ JFCB                         19924020
         B     DSNTEST             GET NEXT DSNAME                      19926020
*                                                                       19928020
         EJECT                                                 @YL026YA 19929000
IKJEHALC DS    0H                                              @YL026YA 19934000
ALLOCDS  DS    0H                                              @YL026YA 19939000
*********************************************************************** 19944000
*                                                              @YL026YA 19949000
*        THIS IS A COMMON ROUTINE THAT TAKES THE CURRENT DSNAME AND     19954000
*        ALLOCATES IT BY GOING TO DAIR AT ENTRY X'08'.         @YL026YA 19959000
*                                                              @YL026YA 19964000
*********************************************************************** 19969000
*                                                              @YL026YA 19974000
         ST    R8,RETADDR          SAVE CALLERS ADDRESS        @YL026YA 19979000
*                                                              @YL026YA 19984000
*                                                              @YL026YA 19989000
ALLOCDS1 EQU   *                   ENTRY FROM RETRY            @YL026YA 19994000
         LA    R2,DAIRLIST         SET UP USE OF DSECT         @YL026YA 19999000
         USING DAPB08,R2           USE DSECT HERE              @YL026YA 20004000
*                                                              @YL026YA 20009000
         XC    DAPB08(DAIR08LN),DAPB08 ZERO PARM BLOCK         @YL026YA 20014000
         MVI   DA08DDN,BLANK       BLANK-                      @YL026YA 20019000
         MVC   DA08DDN+D1(L23),DA08DDN DDNAME, UNIT NAME, AND VOLSER    20024000
         MVC   DA08MNM(L16),DA08DDN ALSO MEMBER NAME AND PASSWORD       20029000
         MVI   DA08DSP1,DA08SHR    SET DISPOSITION OF KEEP     @YL026YA 20034000
         MVI   DA08CD+D1,DAIR08    SET ENTRY CODE              @YL026YA 20039000
         LA    R1,CURNTNAM                                     @YL026YA 20044000
         ST    R1,DA08PDSN         PTR TO CURRENT DSNAME       @YL026YA 20049000
*                                                              @YL026YA 20054000
         TM    PWFLAG(R9),HIGHBIT  TEST FOR PASSWORD           @YL026YA 20059000
         BZ    GODAIR              IF NONE GO TO DAIR          @YL026YA 20064000
         LH    R1,PWLEN(R9)        GET LENGTH OF PASSWORD      @YL026YA 20069000
         L     R3,PWOFF(R9)        GET ADDRESS OF PASSWORD     @YL026YA 20074000
         LA    R7,DA08PSWD         POINT AT PASSWORD SLOT OF DAIRLIST   20079000
         BCTR  R1,R0               DECREMENT BY ONE            @YL026YA 20084000
         EX    R1,MOVE             MOVE PASSWORD TO LIST       @YL026YA 20089000
        DROP  R2                                               @YL026YA 20094000
*                                                              @YL026YA 20099000
GODAIR   BAL   R8,MEMDAIR          LINK TO DAIR                @YL026YA 20104000
ALLOCCHK LTR   R15,R15                                         @YL026YA 20109000
         BNZ   ALLOCERR            ALLOCATE ERROR              @YL026YA 20114000
*                                                              @YL026YA 20119000
**********************************************************************  20124000
         OI    ALLOCSW,ON                                      @YL026YA 20129000
         NI    FIRSTIME,ZERO       TURN OFF FIRSTIME SWITCH    @YL026YA 20134000
ALLOCEND EQU   *                                               @YL026YA 20139000
         L     R8,RETADDR          RETURN TO CALLER            @YL026YA 20144000
         BR    R8                  RETURN                      @YL026YA 20149000
**********************************************************************  20154000
         EJECT                                                 @YL026YA 20159000
MEMDAIR  EQU   *                                               @YL026YA 20164000
*                                                              @YL026YA 20169000
         LA    R1,PUTLLIST         POINT TO PARM LIST            100000 20174000
         USING DAPL,R1             DAPL DSECT                    100000 20179000
         L     R2,UPTPTR           UPT POINTER TO-               100000 20184000
         ST    R2,DAPLUPT          DAIR PARM LIST                100000 20189000
         L     R2,ECTPTR           ECT POINTER TO-               100000 20194000
         ST    R2,DAPLECT          DAIR PARM LIST                100000 20199000
         L     R2,ECBPTR           ECB POINTER TO-               100000 20204000
         ST    R2,DAPLECB          DAIR PARM LIST                100000 20209000
         L     R2,PSCBPTR          PSCB POINTER TO-              100000 20214000
         ST    R2,DAPLPSCB         DAIR PARM LIST                100000 20219000
         LA    R2,DAIRLIST         DAIR PARM BLOCK POINTER-      100000 20224000
         ST    R2,DAPLDAPB         TO DAIR PARM LIST             100000 20229000
         DROP  R1                  DAPL NO LONGER NEEDED         100000 20234000
         LINK  EP=IKJDAIR,MF=(E,(1))                           @YL026YA 20239000
         BR    R8                   RETURN TO CALLER           @YL026YA 20244000
*                                                              @YL026YA 20249000
         EJECT                                                 @YL026YA 20254000
**********************************************************************  20259000
*                                                                    *  20264000
*    ALLOCERR ROUTINE ANALYZES NON ZERO RETURN CODES FROM ALLOCATION *  20269000
*    THIS ROUTINE IS PART OF THE ALLOCDS CLOSED SUBROUTINE           *  20274000
*                                                                    *  20279000
**********************************************************************  20284000
ALLOCERR LA    R2,DAIRLIST         SET UP ADDRESSABILITY                20289000
         USING DAPB08,R2           USING MAP MACRO                      20294000
         CLM   R15,B1,RC16         RC GREATER THAN X'10'?       ZA00612 20296002
         BH    ACODE04             YES, ANALYZE THE DAIR ERROR  ZA00612 20298002
         B     ALCCODE(R15)        CHECK RETURN CODE                    20299000
*                                                                       20304000
ALCCODE  B     ACODE00             SUCCESS                              20309000
         B     ACODE04             INVALID PARM LIST                    20314000
         B     ACODE08             NO ENTRIES AVAILABLE                 20319000
         B     ACODE12             DDNAME REQUESTED IS IN USE           20324000
         B     ACODE16             ALLOCATION FAILED                    20329000
*                                                                       20334000
ACODE04  EQU   *                                                        20339000
         MVI   ERR1,MSG13          COMMAND SYSTEM ERROR                 20344000
         MVI   ERR2,SECMSG20       DAIR ERROR CODE                      20349000
         LR    R6,R15              SAVE RETURN CODE                     20354000
         BAL   R8,CVDREG15         CONVERT CODE RTN                     20370020
         B     GOWRT               GO WRITE                             20400020
*                                                                       20430020
ACODE08  EQU   *                                                        20460020
*********RETURN CODES OF 4 8 12 16 AND 28 ARE VALID ONLY ******         20500020
         CLI   DA08CTRC+D1,D4      RC =  4 VOL NOT AVAIL                20540000
         BE    CTRC4               PUT OUT MSG                          20580000
         CLI   DA08CTRC+D1,RC28    RC 28 CAT I/O ERROR                  20620000
         BE    CTRC28              PUT OUT MSG                          20660000
******IF NOT ABOVE  USE CATCH ALL DS NOT IN CATLG*********              20700000
         MVI   ERR1,MSG01          DSNAME NOT IN CATLG                  20740000
         B     MCOMMON3            INSERT DSNAME IN MSG                 20780000
CTRC4    MVI   ERR2,SECMSG10       VOL NOT ON SYSTEM                    20820000
         MVI   ERR1,MSG10          DS NOT ALLOCATED                     20860000
         B     MCOMMON3            INSERT NAME AND PUT OUT MSG          20900000
CTRC28   MVI   ERR2,SECMSG19       CATALOG I O ERROR                    20940000
         MVI   ERR1,MSG11          DS NOT ALLOC MSG SYSTEM ERROR        20980000
         B     MCOMMON3            INSERT NAME AND PUT OUT MSG          21020000
ACODE12  EQU   *                                                        21180020
*                                                                       21210020
*    THE FOLLOWING CODE BREAKS OUT SPECIFIC DARC CODES                  21240020
*    AFTER CERTAIN RETURN CODES ARE COMPARED FOR A                      21270020
*    COMMON ERROR CODE IS PUT OUT                                       21300020
*                                                                       21330020
         LH    R1,DAIRLIST+D4      LOAD DARC CODE                       21360000
         CH    R1,C210                                                  21450020
         BE    M210                DYNAMIC ALLOCATION RC = 210          21480020
         CH    R1,C218                                                  21510020
         BE    M218                DYNAMIC ALLOCATION RC = 218          21540020
**********  THIS RTN CONVERTS THE HEX RC FROM DAIR  ************        21790020
****** AND PUTS OUT THE FIRST AND SECOND LEVEL MSG PARMS ******         21800020
         MVI   ERR2,SECMSG03       DYNAM ALLOC ERROR                    21810000
         MVI   ERR1,MSG11          SYSTEM ERROR                         21830000
HEX      LA    R5,ERRINSRT         PUT ADDRESS OF INSERT                21850000
         ST    R5,ERRINST2         INTO INSERT SLOT                     21870000
         LA    R4,DA08DARC         POINT TO DATA                        21890000
MCOM4    EQU   *                                                        21910000
         LA    R5,D2               NUMBER OF BYTES TO CONVERT           21930000
         LA    R7,ERRINSRT+D1      POINT TO OUTPUT BUFFER               21950000
         L     R10,VCONLABL        ADDRESSABILITY FOR BITOHEX           21970000
         L     R15,VCONBTHX        ADDRESS OF BITOHEX                   21990000
         BALR  R8,R15              GO CONVERT HEX CODE                  22010000
         CLI   ERRINSRT+D1,ZONE    GET RID OF LEADING ZERO              22030000
         BNE   ENDHEX              IF ANY                               22050000
         MVI   ERRINSRT+D1,BLANK   BLANK LEADING ZERO                   22070000
ENDHEX   MVI   ERRINSRT,FOURB      LENGTH OF TEXT                       22090000
         B     MCOMMON3            PUT OUT MSG AND INSERT               22110000
*                                                                       22230020
         DROP  R2                                                       22300020
*                                                                       22380020
M210     MVI   ERR2,SECMSG15       DATA SET ALLOCATED TO OTHER USER     22410000
         MVI   ERR1,MSG12          MESSAGE 12                           22450000
         B     MCOMMON2            FILL IN REST OF MSG                  22490000
M218     MVI   ERR2,SECMSG13       VOL NOT ON SY8STEM                   22530000
         MVI   ERR1,MSG10          MESSAGE 10                           22590020
*                                                                       22770020
RETCOM2  EQU   *                                                        22950020
MCOMMON2 EQU   *                   COMMON MESSAGE SEGMENT               22980020
MCOMMON3 LA    R1,MSGNAMEL+D1      GET ADDRESS OF NAME           A42337 23010021
         ST    R1,ERRINST1                                              23040020
GOWRT    BAL   R8,ERROUT           GO WRITE                             23070000
         B     DSNTEST             SEE IF MORE DSNAMES          ZA01264 23100002
ACODE16  EQU   *                                                        23130020
*                                                                       23160020
         TM    FIRSTIME,ONE        FIRST ATTEMPT TO ALLOCATE            23170020
         BNO   UNALLOC             NO THEN UNALLOCATE BY TCB            23180020
NODYNAM  NI    OPTMASK,FOXES-MEMBERS   TURN OFF MEM OPTION              23190020
*                                                                       23200020
         MVI   ERR2,SECMSG11       USE FREE COMMAND                     23220000
         MVI   ERR1,MSG08          MESSAGE 8                     A46800 23260000
         B     MCOMMON2            FILL IN REST OF MSG                  23300000
*                                                                    *  23341020
**********************************************************************  23342020
*                                                                       23343020
UNALLOC  EQU   *                                                        23344020
         MVI   FIRSTIME,ONE        SET ON TO PREVENT ALLOC LOOP         23345000
         LA    R1,DAIRLIST                                              23346020
         USING DAPB2C,R1                                                23347020
         XC    DAPB2C(DAIR2CLN),DAPB2C ZERO PARM BLOCK                  23348020
         MVI   DAPB2C+D1,DAIR2C    MOVE IN ENTRY CODE                   23348420
         L     R2,CVTPTR                ADDR OF CVT                     23349020
         USING CVTTCBP,R2               USE MAP MACRO                   23350020
         L     R3,CVTTCBP               POINTER TO TCB                  23351020
         L     R2,TCBOFF(R3)            ADDR OF CURRENT TCB             23352020
         ST    R2,DA2CTCB               STORE IN LIST                   23353020
         DROP  R1                                                       23354020
         DROP  R2                                                       23355020
         BAL   R8,MEMDAIR               SET UP DAIR PARAMETERS AND LINK 23356020
         B     ALLOCDS1            GO ALLOCATE                          23358020
*                                                                       23359020
**********************************************************************  23360020
**********************************************************************  23361020
         EJECT                                                 @YL026YA 23370000
*                                                                       23400000
ACODE00  EQU   *                                                        23430000
         OI     ALLOCSW,ON         TURN ON ALLOC SWITCH                 23460000
         LA    R2,OBTDCB                                                23490020
         USING IHADCB,R2                                                23520020
         MVC   DCBDDNAM(D8),DAIRLIST+D12  PUT DDNAME IN DCB             23550020
         DROP  R2                                                       23580020
         LA    R1,RDJL             ADDR OF RDJFCB IN DSECT              23610000
         LA    R3,OBTDCB           ADDR OF THE DCB IN THE DSECT         23640000
         RDJFCB ((R3)),MF=(E,(R1))                                      23670020
*                                                                       23700020
*                                                                       23730020
         LA    R3,JFCBVOLS         ADDR OF VOLID FROM JFCB              23760000
         ST    R3,OBTVOL                                                23790020
*                                                                       23820020
*                                                                       23850020
         OI    CONTROL,JFCB        INDICATE RDJFCB ISSUED               23880000
         B     MAIN01              GO ISSUE OBTAIN WITH VOLID JFCB      23890000
TESTTYPE EQU   *                   TEST ENTRY TYPE FOR NON-VSAM         23900000
         USING CTGFL,R3                                        @YL026YA 23910000
         OI    CONTROL,LOCATE      INDICATE LOCATE OK                   23920000
         LA    R3,CTGFL1           ADDRESSABILITY FOR ENTRY    @YL026YA 23930000
*                                  TYPE FPL                    @YL026YA 23940000
         L     R3,CTGFLPT          ADDRESS OF ENTRY TYPE       @YL026YA 23950000
         MVC   DSTYPE,D0(R3)       SAVE TYPE CODE              @YL026YA 23960000
         CLI   DSTYPE,CTGTALIN     IF TYPE IS NOT NONVSAM,     @YL026YA 23970000
         BNE   VSAMBSC             PROCESS AS VSAM CLUSTER     @YL026YA 23980000
         NI    CONTROL,FOXES-LOCATE TURN OFF SUCESS. LOCATE    @ZA09142 23990003
         B     NONVSAM             GO PROCESS AS NON-VSAM      @ZA09142 24050003
MAIN01   EQU   *                                                        24120000
         LA    R3,OBTDSNAM         GET DSNAME ADDRESS                   24130000
         ST    R3,OBTDSN           STORE IN OBTAIN LIST                 24140000
         LA    R3,OBTWORKA         WORK AREA ADDRESS                    24150000
         ST    R3,OBTWKA           PUT IN LIST                          24160000
         MVC   OBTCLST(D4),CLSTMDL   INITIALIZE OBTAIN CAMLST           24420020
*                                                                       24450020
*                                                                       24480020
         OBTAIN                    OBTCLST                              24510000
         LA    R1,D4               REG 1 = 4                            24520020
         CR    R15,R1              IS RETURN CODE = 4                   24530020
         BL    OBTOK               RC = 0 IS OK                         24540020
         BH    OBTERR              OBTAIN ERROR                         24550020
         MVI   ERR2,SECMSG13       SECOND LEVEL MESSAGE 13              24840020
         B     STSECND             FILL IN REST OF MSG                  24870000
OBTERR   EQU   *                                                        24900000
         LR    R6,R15              SAVE RETURN CODE                     24930000
         BAL   R8,CVDREG15         CONVERT RETURN CODE                  24960000
         MVI   ERR2,SECMSG02       SECOND LEVEL MESSAGE 2               24990020
STSECND  MVI   ERR1,MSG02          MESSAGE 2                            25020020
         BAL   R8,ERROUT             PUT OUT MSG                        25110020
DSNTEST  DS    0H                                                       25140020
         NI    ALLOCSW,ZERO        TURN OFF ALLOC SWITCH                25150000
         TM    PROCNM,CIRLIST      WAS NAME FROM CIR?                   25152000
         BNO   DSNTEST1            NO,PROCESS NORMALLY                  25154000
         B     NEXTCIR             PROCESS NEXT CIR ENTRY               25156000
*                                                                       25160020
*                                                                       25170020
***********************************************************             25710020
DSNTEST1 CLI   CHAINAD(R9),FOXES    TEST FOR END OF CHAIN               25740020
         BE    WRAPUP              NO, NORMAL TERMINATION.              25770000
         L     R9,CHAINAD(R9)      PICK UP ADDRESS OF NEXT PDE          25800000
         B     NXDSNAME            SCAN NEXT DSNAME                     25830000
**********************************************************              25860020
WRAPUP   EQU   *                                                        26400020
WRAPUP01 EQU   *                                                        26550020
*                                                                       26670020
* NOW CHECK IF AN ERROR HAS OCCURRED.  IF SO, THE STACK MUST BE         26680020
*  FLUSHED AND THE INPUT QUEUE CLEARED.                                 26690020
         CLI   STACKSW,SWON        IS STACK SWITCH ON                   26692020
         BNE   STACKOK             NO ERROR, END NORMALLY               26694020
         LA    R1,UPTPTR           POINT TO I/O PARAMETER LIST          26696020
         LA    R2,STACKPRM         POINT TO STACK PARM BLOCK            26698020
         ST    R2,PUTLADDR         POINT TO STACK PARM BLOCK            26698420
         STACK DELETE=ALL,MF=(E,(1)) FLUSH STACK                        26698820
         TCLEARQ INPUT             CLEAR ANYTHING TYPED AHEAD           26699220
STACKOK  EQU   *                   NORMAL RETURN FROM HERE              26699620
         L     R13,D4(R13)         RESTORE ADDRESS OF CALLERS SAVEAREA  26730000
         L     R15,RETCODE         GET RETURN CODE INTO REG 15          26780000
         RETURN                    (14,12),RC=(15) RETURN TO TMP        26830000
*                                                                       26880020
*                                                                       26910020
OBTOK    EQU   *                                                        26940020
         MVC   DSORGSV(L'DS1DSORG),DS1DSORG  SAVE DSORG TYPE            26950020
         LA    R7,OUTBUF           BUILD HEADING FOR FIRST LINE OF      26970000
         MVC   D0(L'BASICHDG,R7),BASICHDG  OUTPUT DATA                  27000000
         LA    R7,L'BASICHDG(R7)                                        27030000
         TM    CONTROL,HISTORY     WAS HISTORY SPECIFIED                27060000
         BNO   OBTOK01             NO, CHECK STATUS                     27090000
         MVC   D0(L'HISTHDG,R7),HISTHDG  YES MOVE HEADING TO BUFFER     27120020
         LA    R7,L'HISTHDG(R7)                                         27150020
OBTOK01  EQU   *                                                        27180020
         TM    CONTROL,STATUS      WAS STATUS SPECIFIED                 27210000
         BNO   OBTOK02             NO, WRITE BUFFER                     27230000
         LA    R8,DCBMDL           REG8 WILL BE BASE FOR CONSTANTS      27250000
         USING DCBMDL,R8           ADDRESSABILITY TO CONSTANTS          27270000
         MVC   D0(L'STATHDG,R7),STATHDG  MOVE HEADING TO BUFFER         27290000
         DROP  R8                  DROP ADDRESSABILITY TO CONSTANTS     27310000
         LA    R7,L'STATHDG(R7)                                         27330000
OBTOK02  EQU   *                                                        27350000
         LR    R14,R7              POINT AT END OF BUFFER DATA          27370000
         LA    R7,OUTBUF                                                27390000
         BAL   R8,WRITE            WRITES OUT THE BUFFER                27410000
         L     R15,BSCVCON         ADDRESS OF BASIC INFORMATION ROUTINE 27430000
         BALR  R14,R15             GO TO BASIC ROUTINE                  27450000
ENDBASIC EQU   *                                               @YL026YA 27470000
*********************************************************************** 27510020
*                                                                       27540020
*   THE  FOLLOWING ROUTINE CHECKS FOR THE HISTORY AND STATUS KEYWORDS   27570020
*   AND IF SPECIFIED PASSES CONTROL TO THE RESPECTIVE KEYWORD HANDLING  27600020
*   ROUTINES.  THEN THE VOLSER INFORMATION IS PUT OUT.                  27630020
*                                                                       27660020
*********************************************************************** 27690020
         TM    CONTROL,HISTORY     WAS HISTORY REQUESTED                27720000
         BNO   STATCHEK            NO, CHECK STATUS                     27750000
         L     R15,HISTVCON                                             27780000
         BALR  R14,R15             GO TO HISTORY ROUTINE                27810000
*                                                                       27840020
*                                                                       27870020
*                                                                       27900020
STATCHEK EQU   *                                                        27930020
         TM    CONTROL,STATUS      WAS STATUS REQUESTED                 27960000
         BNO   VOLROUT             NO, PUT OUT VOLUME INFORMATION       27970000
         L     R15,STATVCON        ADDRESS OF STATUS  ROUTINE           27980000
         BALR  R14,R15             GO TO STATUS ROUTINE....             27990000
VOLROUT  EQU   *                                                        28000000
         LA    R7,OUTBUF           POINT AT BUFFER                      28010000
         LA    R14,L'OUTBUF(R7)    POINT AT END OF BUFFER               28020000
         BAL   R8,WRITE            GO WRITE THE BUFFER                  28030000
         LA    R8,DCBMDL           REG 8 WILL BE BASE FOR END OF PGM    28040000
         USING DCBMDL,R8           ADDRESSABILITY TO CONSTANTS          28050000
         CLI   DSTYPE,CTGTALIN     IF ENTRY IS NONVSAM,        @YL026YA 28060000
         BE    VOLALIN             WRITE VOLSER HEADING        @YL026YA 28070000
         MVC   OUTBUF(L'VSAMVHDG),VSAMVHDG  OTHERWISE,         @YL026YA 28080000
*                                  WRITE VOLSER AND BLKSIZE    @YL026YA 28090000
         LA    R14,L'VSAMVHDG(R7)  POINT TO BUFFER             @YL026YA 28100000
         B     VOLWRT              GO WRITE                    @YL026YA 28110000
VOLALIN  EQU   *                                               @YL026YA 28120000
         MVC   OUTBUF(L'VOLHDING),VOLHDING  MOVE HEADING TO BUFFER      28130000
         DROP  R8                  DROP ADDRESSABLIITY TO CONSTANTS     28140000
         LA    R14,L'VOLHDING(R7)   ADJUST POINTERS TO WRITE BUFFER     28150000
VOLWRT   EQU   *                                               @YL026YA 28160000
         BAL   R8,WRITE            WRITE THE HEADING                    28170000
         TM    CONTROL,LOCATE      SEE IF LOCATE WAS SUCCESSFUL         28180000
         BO    VOLROUT2            IF YES, PROCESS VOLUME LIST          28190000
*********************************************************************** 28410020
*                                                                       28440020
*   IF LOCATE WAS NOT SUCCESSFUL, THEN A RDJFCB HAD TO HAVE BEEN        28470020
*   ISSUED IN ORDER TO GET THIS FAR.                                    28500020
*                                                                       28530020
*********************************************************************** 28560020
         LA    R3,D5               SET CTR FOR MAX NO. OF VOLSERS       28590000
         XR    R4,R4               CLEAR REGISTER                       28620000
         IC    D4,JFCBNVOL         GET VOLSER COUNT                     28650000
         LA    R7,OUTBUF           GET BUFFER POINTER                   28680000
         LA    R1,JFCBVOLS         POINT AT FIRST VOLSER                28710000
VOLROUT1 EQU   *                                                        28740000
         MVC   D2(L6,R7),D0(R1)    MOVE VOLSER TO BUFFER                28770000
         LA    R14,D8(R7)                                               28800000
         BAL   R8,WRITE            WRITE BUFFER                         28830000
         BCTR  R4,R0               DECREMENT ACTUAL COUNT.              28860000
         LTR   R4,R4               SEE IF COUNT IS ZERO                 28890000
         BZ    VOLEXIT             IF ZERO, ALL DONE                    28920000
         LA    R1,D6(R1)           BUMP VOLSER POINTER TO NEXT ONE      28950000
         BCT   R3,VOLROUT1         DECR MAX COUNT AND BR IF NONZERO     28980000
*********************************************************************** 29010020
*                                                                       29040020
*   MORE THAN 5 VOLSERS WAS INDICATED IN JFCB. CAN NOT READ JFCB        29070020
*   EXTENSION AND DATA SET IS NOT CATALOGED, SO MESSAGE MUST BE         29100020
*   WRITTEN TO TERMINAL INDICATING VOLUME LIST IS INCOMPLETE.           29130020
*                                                                       29160020
*********************************************************************** 29190020
         MVI   ERR1,MSG03          COMPLETE VOL LIST NOT AVAILABLE      29220000
         MVI   ERR2,SECMSG18       JFCB EXT NOT AVAILABLE               29240000
         BAL   R8,ERROUT           GO PUT OUT ERROR MESSAGE             29260000
         B     VOLEXIT             GO PROCESS NEXT KEYWORD              29280000
VOLROUT2 EQU   *                                                        29300000
         USING CTGFL,R3            ADDRESSABILITY FOR          @YL026YA 29320000
         LA    R3,CTGFL3           BLOCKSIZE FPL               @YL026YA 29340000
         L     R4,CTGFLPT          ADDRESS OF BLKSIZE LIST     @YL026YA 29360000
         LA    R3,CTGFL2           VOLUMES FPL                 @YL026YA 29380000
         L     R5,CTGFLPT          ADDRESS OF VOLUMES LIST     @YL026YA 29400000
         L     R3,CTGFLNG          LENGTH OF LIST              @YL026YA 29420000
         LTR   R3,R3               IS LENGTH ZERO?             @YL026YB 29440000
         BZ    VOLROUT5            YES, GOTO VOLROUT5          @YL026YB 29460000
         SR    R2,R2               CLEAR REG 2                 @YL026YB 29480000
         D     R2,VOLLEN           DIVIDE BY ENTRY LENGTH TO   @YL026YA 29500000
*                                  GET VOLUME COUNT            @YL026YA 29520000
*  COUNT NOW IN R3, ADDRESS IN R5                              @YL026YA 29540000
         DROP  R3                                              @YL026YA 29560000
VOLROUT4 EQU   *                                                        29580000
         MVC   D2(L6,R7),D0(R5)    MOVE VOLSER TO BUFF                  29600000
VOLROUT6 CLI   DSTYPE,CTGTALIN     IS THIS A NONVSAM DATA SET  @YL026YA 29620000
         BNE   VSAMDS              IF NOT PRINT BLKSIZE                 29640000
         LA    R14,D8(R7)          POINT AT END OF DATA                 29660000
         B     ENDBZX              GO WRITE DATA               @YL026YB 29680000
VSAMDS   EQU   *                   POINT AT END OF DATA        @YL026YA 29700000
         LA    R14,13(R7)                                               29720000
         LTR   R4,R4               IS REG 4 ZERO ?             @YL026YB 29740000
         BZ    ZERBLK              YES, GOTO ZERBLK            @YL026YB 29760000
         L     R1,D0(R4)           GET BLOCKSIZE VALUE         @YL026YA 29780000
         LTR   R1,R1               IS VALUE ZERO?              @YL026YA 29800000
         BZ    ZERBLK              YES, PRINT '**'             @YL026YA 29820000
         LA    R7,D10(R7)                                       ZA00105 29840002
         CVD   R1,WORKROOM         NO, CONVERT TO NUMBERS      @YL026YA 29860000
         UNPK  D0(D5,R7),WORKROOM(D8)                          @YL026YA 29880000
         OI    D4(R7),ZONE         CLEAR SIGN                  @YL026YA 29900000
BLOKLOOP EQU   *                                               @YL026YA 29920000
         CLI   D0(R7),ZONE         IS DIGIT ZERO?              @YL026YA 29940000
         BNE   ENDBSZ2             NO - END LOOP               @YL026YA 29960000
         MVC   D0(L5,R7),D1(R7)    SHIFT NUMBER TO LEFT        @YL026YA 29980000
         B     BLOKLOOP            CONTINUE CHECKING           @YL026YA 30000000
VOLROUT5 LA    R3,1                REG 3 EQUALS 1              @YL026YB 30020000
         B     VOLROUT6            GOTO VOLROUT6               @YL026YB 30040000
ZERBLK   MVC   D8(L'ASTER,R7),ASTER  MOVE '**' TO BUFFER       @YL026YA 30060000
ENDBSZ   EQU   *                   POINT TO END OF BUFFER      @YL026YA 30080000
ENDBZX   BAL   R8,WRITE            WRITE BUFFER                @YL026YB 30100000
         LA    R5,VOLENTLN(R5)     POINT AT NEXT VOLSER        @YL026YB 30120000
         BCT   R3,VOLROUT4         DECR CNT AND WRITE OUT NEXT VOLSER   30140000
VOLEXIT  EQU   *                                                        30160000
         CLI   DSTYPE,CTGTALIN          NONVSAM DATA SET?       ZA00105 30166002
         BNE   DSNTEST                  NO, SKIP LABEL/MEM      ZA00105 30172002
         L     R15,VCONMEM         GET ADDR OF MEMBER AND      @YL026YA 30180000
*                                  LABEL PROCESSING ROUTINE    @YL026YA 30200000
         BALR  R14,R15             GO PROCESS MEMBER NAMES,    @YL026YA 30220000
*                                  LABELS, AND MEMBERS KEYWORD @YL026YA 30240000
         B     DSNTEST             GO TEST FOR ANOTHER DSNAME TO O      30260000
ENDBSZ2  LA    R8,D10                                          @ZA06146 30280003
         SR    R7,R8                                                    30300000
         B     ENDBSZ                                                   30320000
         EJECT                                                 @YL026YA 30340000
**** * * * * * * * * * * * * * * * * * * * *                   @YL026YA 30360000
* * * * * * * * * * * * * * * * * * * * * *                    @YL026YA 30380000
* * * *THIS RTN CONVERTS RETURN CODES * * *                    @YL026YA 30400000
* * * * * * * * * * * * * * * * * * * * *                      @YL026YA 30420000
CVDREG15 DS    0H                                              @YL026YA 30440000
         CVD   R6,ERRINSRT+D8      CONVERT TO DECIMAL          @YL026YA 30460000
         UNPK  ERRINSRT+D1(L4),ERRINSRT+ERRCOD(L3)  UNPACK TWO @YL026YA 30480000
         MVI   ERRINSRT,D2         MOVE IN LENGTH OF TWO       @YL026YA 30500000
         LA    R1,ERRINSRT         PLACE INSERT ADDRESS IN     @YL026YA 30520000
         ST    R1,ERRINST2         2ND LEVEL MESSAG SLOT       @YL026YA 30540000
         BR    R8                  RETURN TO CALLER            @YL026YA 30560000
* * * * * * * * * * * * * * * * * * * * *                      @YL026YA 30580000
* * * * * * * * * * * * * * * * * * * *                        @YL026YA 30600000
         EJECT                                                          30620000
CIROUTN  CSECT                                                          30640000
**********************************************************************  30660000
*                                                              @YL026YA 30680000
*   THIS ROUTINE LOADS IKJEHCIR, ACQUIRES CORE FOR THE SAVE    @YL026YA 30700000
*   AREA AND WORK AREA, AND INITIALIZES THE PARAMETER LIST.    @YL026YA 30720000
*                                                              @YL026YA 30740000
*********************************************************************** 30760000
CIRINIT  SAVE  (14,12),,*                                               30780000
         LR    R10,R15                                                  30800000
         USING CIRINIT,R10                                              30820000
         GETMAIN R,LV=SAVELEN,SP=WORKSP                                 30840000
         ST    R13,D4(R1)          SAVE CALLERS SAVE AREA      @YL026YB 30860000
         ST    R1,D8(R13)          SAVE THIS ROUTINE SAVE AREA          30880000
         LR    R13,R1              SAVE AREA ADDRESS           @YL026YB 30900000
         LOAD  EP=IKJEHCIR                                     @YL026YA 30920000
         ST    R0,CIRADDR          SAVE THE ROUTINE'S ADDRESS  @YL026YA 30940000
         LH    R0,CIRLEN           LENGTH OF GETMAIN AREA      @YL026YB 30960000
         LR    R3,R0               SAVE LENGTH                 @YL026YB 30980000
         O     R0,SUPPL1           SET SUBPOOL NUMBER          @YL026YB 31000000
         GETMAIN R,LV=(0)                                      @YL026YA 31020000
         LTR   R15,R15             DID GETMAIN WORK?           @YL026YA 31040000
         BNZ   NOCORE              NO - ISSUE MESSAGE          @YL026YA 31060000
         LR    R4,R1               SAVE CONTENTS FOR R1        @YL026YB 31080000
         XC    D0(CIRPMLN,R1),D0(R1) CLEAR AREA                @YL026YA 31100000
         LA    R2,CIRPMLN(R1)      SAVE AREA FOLLOWS           @YL026YA 31120000
         ST    R2,CIRSAVE          PARAMETER LIST              @YL026YA 31140000
         LA    R2,RETCD52(R2)      AFTER SAVE AREA             @YL026YA 31160000
         ST    R2,CIRWA            IS WORK AREA                @YL026YA 31180000
         SR    R4,R2               LENGTH OF PARM LIST AND SAVEAREA     31200000
         LH    R3,CIRLEN           LENGTH OF GETMAIN AREA               31220000
         AR    R3,R4               LENGTH OF CIR WORKAREA      @ZA10244 31240003
         STH   R3,D0(R2)           PUT IN LENGTH FIELD OF      @YL026YA 31260000
*                                  WORK AREA                   @YL026YA 31280000
         LA    R2,CIRDSN           ADDRESS OF DSNAME BUFFER    @YL026YA 31300000
         ST    R2,CIRSRCH          TO PARAMETER LIST           @YL026YA 31320000
         OI    CIROPT,CIROPTDS     SET OPTION BYTE             @YL026YA 31340000
         TM    OPTMASK2,CATALOG    WAS A USER CATALOG NAMED?   @YL026YA 31360000
         BNO   SKIPCAT             NO - SKIP SETUP             @YL026YA 31380000
         LA    R2,CATBUFF          POINT TO NAME               @YL026YA 31400000
         ST    R2,CIRCVOL          PUT ADDRESS IN PARAMETER LIST        31420000
         LA    R2,CIRPASS          POINT TO PASSWORD           @YL026YA 31440000
         ST    R2,CIRPSWD          PUT ADDRESS IN PARAMETER LIST        31460000
         B     BANC08                                                   31480000
SKIPCAT  EQU   *                                               @YL026YA 31500000
         XC    CIRPSWD,CIRPSWD                                          31520000
         XC    CIRCVOL,CIRCVOL                                          31540000
BANC08   LR    R1,R13                                                   31560000
         L     R13,D4(R1)                                               31580000
         FREEMAIN R,LV=SAVELEN,A=(1),SP=WORKSP                          31600000
         LM    R14,R7,D12(R13)     RESTORE REGS 14 TO 7                 31620000
         LM    R9,R12,D56(R13)     RESTORE REGS 9 TO 12                 31640000
         BR    R8                  RETURN TO CALLER            @YL026YA 31660000
*                                                              @YL026YA 31680000
NOCORE   EQU   *                                               @YL026YA 31700000
         MVI   ERR1,MSG19          UNABLE TO DO GENERIC LOCATE @YL026YA 31720000
         MVI   ERR2,SECMSG06       NOT ENOUGH CORE             @YL026YA 31740000
         LA    R8,D4(R8)                                                31760000
         B     BANC08                                          @YL026YA 31780000
         EJECT                                                 @YL026YA 31800000
IKJEHBSC CSECT                                                          32670020
*********************************************************************** 32730020
*                                                                       32760020
*   THIS ROUTINE SUPPLIES THE BASIC INFORMATION THAT IS ALWAYS GIVEN    32790020
*   WITH THE LISTDS COMMAND FOR EACH SPECIFIED DATASET.  THE            32820020
*   INFORMATION THAT IS PROVIDED BY THIS ROUTINE IS AS FOLLOWS...       32850020
*     1. RECORD FORMAT (RECFM)                                          32880020
*     2. LOGICAL RECORD LENGTH (LRECL)                                  32910020
*     3. BLOCK SIZE (BLKSIZE)                                           32940020
*     4. DATA SET ORGANIZATION (DSORG)                                  32970020
*    AND BUILD THE OUTPUT DATA LINE                                     33000020
*                                                                       33030020
*********************************************************************** 33060020
BASICRT  SAVE  (14,12),,*                                               33090020
         LR    R10,R15             ESTABLISH ADDRESSABILITY             33120000
         USING BASICRT,R10                                              33150000
         USING OBTWAD,R12          WORKAREA BASE                        33180000
         GETMAIN R,LV=SAVELEN,SP=WORKSP                                 33210000
         ST    R13,D4(R1)          CHAIN WORKAREAS TOGETHER             33240000
         ST    R1,D8(R13)                                               33270000
         LR    R13,R1              NEW SAVEAREA                         33300000
         LA    R7,OUTBUF           POINT AT BUFFER                      33330000
         LA    R5,RECFMOFF(R7)     POSITION POINTER FOR RECFM           33360000
         LR    R3,R5               SAVE VALUE                   SA52667 33390000
         TM    DS1RECFM,UTYPE      CHECK FOR UNDEFINED                  33420000
         BO    RECFMU              YES, MOVE PROPER CHARACTER TO BUFFER 33450000
         BZ    TTEST1              U, V, F NOT SPECIFIED        SA52667 33480000
*                                                                       33510000
         TM    DS1RECFM,FTYPE      CHECK FIXED                          33540000
         BO    RECFMF              YES                                  33570000
*                                                                       33600020
RECFM    EQU   *                                                        33630020
         MVI   D0(R5),CHARV        MOVE IN CHARACTER V                  33660020
         B     TTEST               GO CHECK TRACK OVERFLOW              33690000
*                                                                       33730000
RECFMU   EQU   *                                                        33770000
         MVI   D0(R5),CHARU        MOVE CHAR TO BUFFER FOR UNDEFINED    33810000
         B     TTEST               GO CHECK FOR TRK OVFLW               33850000
*                                                                       33890000
RECFMF   EQU   *                                                        33930000
         MVI   D0(R5),CHARF        INDICATE FIXED                       33970000
*                                                                       34010000
TTEST    EQU   *                                                        34050000
         LA    R5,D1(R5)           INCRE BUF PTR PAST FIRST RECFM CHARA 34090000
TTEST1   TM    DS1RECFM,TOVFLOW    CHECK FOR TRACKFLOW          SA52667 34130000
         BNO   BTEST               NO, CHECK FOR BLOCKED                34170000
         MVI   D0(R5),CHART        MOVE CHARACTER TO BUFFER             34260020
         LA    R5,D1(R5)                                                34290020
BTEST    EQU   *                                                        34320020
         TM    DS1RECFM,BLOCKED    CHECK BLOCKED ATTRIBUTE              34350000
         BNO   STEST               NO, CHECK STANDARD ATTRIBUTE         34380000
         MVI   D0(R5),CHARB        INDICATE BLOCKED                     34410020
         LA    R5,D1(R5)                                                34440020
STEST    EQU   *                                                        34470020
         TM    DS1RECFM,STANDARD   CHECK FOR STANDARD OR SPANNED        34500000
         BNO   ASATEST             NO, CHECK ASA                        34520000
         MVI   D0(R5),CHARS        MOVE STANDARD TO BUFFER              34540000
         LA    R5,D1(R5)           BUMP PTR                             34560000
ASATEST  EQU   *                                                        34580000
         TM    DS1RECFM,ASA        CHECK FOR ASA                        34600000
         BNO   MACHTEST            NO, CHECK FOR MACHINE CTL CHARS      34620000
         MVI   D0(R5),CHARA        MOVE ASA CHAR TO BUFFER              34640000
         LA    R5,D1(R5)           BUMP PTR                             34660000
MACHTEST EQU   *                                                        34680000
         TM    DS1RECFM,MACHINE    CHECK MACHINE ATTRIBUTE              34700000
         BNO   TREG                NO, GO TEST LRECL            SA52667 34720000
         MVI   D0(R5),CHARM        MOVE MACHINE CNTRL CHAR TO BUFF      34740000
         LA    R5,D1(R5)           BUMP POINTER                 SA52667 34760000
TREG     CR    R3,R5               SEE IF REG. CHANGED          SA52667 34780000
         BNE   LRECLTST            GO TEST LRECL                SA52667 34800000
         MVI   D0(R5),CHARAST      INDICATE RECFM               SA52667 34820000
         MVI   D1(R5),CHARAST      NOT SPECIFIED                SA52667 34840000
LRECLTST EQU   *                                                        34860000
         LH    R1,DS1LRECL         PICK UP LRECL                        34880000
         N     R1,SIGNOFF          CLEAR POSSIBLE NEGATIVE SIGN         34900000
         LTR   R1,R1               PROPAGATED. CHECK FOR ZERO.          34920000
         BZ    NOLRECL             IF ZERO, INDICATE NO LRECL WITH **   34940000
         CVD   R1,WORKROOM                                              35040020
         UNPK  LRECLOFF(D5,R7),WORKROOM(D8)                             35070020
         OI    LRECLOFF+D4(R7),ZONE GET RID OF SIGN                     35100020
LRECLOOP EQU   *                                                        35130020
         CLI   LRECLOFF(R7),ZONE   ARE THERE HIGH ORDER ZEROES          35160000
         BNE   BLKSIZET            NO, TEST BLKSIZE                     35190000
         MVC   LRECLOFF(L5,R7),LRECLOFF+D1(R7) SHIFT NUMBER LEFT        35220000
         B     LRECLOOP            REPEAT EDIT OF LRECL                 35250000
NOLRECL  EQU   *                                                        35280020
         MVC   LRECLOFF(L'ASTERISK,R7),ASTERISK   INDICATE NO LRECL     35310020
BLKSIZET EQU   *                                                        35340020
         LH    R1,DS1BLKL          PICKUP BLOCK LENGTH                  35370000
         N     R1,SIGNOFF          CLEAR POSSIBLE NEGATIVE SIGN         35400000
         LTR   R1,R1               TEST FOR ZERO                        35430000
         BZ    NOBLKLEN            IF ZERO, PUT ** FOR NO BLKLENGTH     35460000
         CVD   R1,WORKROOM         CONVERT NUMBER                       35490000
         UNPK  BLKLOFF(L5,R7),WORKROOM(D8)    AND PLACE IN BUFFER       35520020
         OI    BLKLOFF+L4(R7),ZONE GET RID OF SIGN                      35550020
BLKLOOP  EQU   *                                                        35580020
         CLI   BLKLOFF(R7),ZONE    ARE THERE HIGH ORDER ZEROES          35610000
         BNE   DSORGTST            NO, CHECK DSORG                      35640000
         MVC   BLKLOFF(L5,R7),BLKLOFF+D1(R7) SHIFT NUMBER LEFT          35670020
         B     BLKLOOP             REPEAT EDIT OF ZEROES                35700020
NOBLKLEN EQU   *                                                        35730020
         MVC   BLKLOFF(L'ASTERISK,R7),ASTERISK                          35760020
DSORGTST EQU   *                                                        35790020
*                                                                       35820020
*                                                                       35850020
         TM    DS1DSORG,PS         IS DSORG PS                          35880000
         BO    SETPS               IF YES, BRANCH                       35910000
*                                                                       35940000
         TM    DS1DSORG,PO         IS DSORG PO                          35970000
         BO    SETPO               IF YES, BRANCH                       36000000
*                                                                       36030000
         TM    DS1DSORG,IS         IS DSORG IS                          36060000
         BO    SETIS               IF YES, BRANCH                       36090000
*                                                                       36120000
         TM    DS1DSORG,DA         IS DSORG DA                          36150000
         BO    SETDA               IF YES, BRANCH                       36180000
*                                                                       36210000
         TM    DS1DSORG,NOTID      IS AN UNIDENTIFIED BIT SET           36240000
         BZ    SETND               IF NO, BRANCH                        36270000
*                                                                       36300000
         LA    R15,UNKL            DSORG NOT IDENTIFIABLE               36330000
         LA    R14,UNK                                                  36360020
EXDSORGM EQU   *                                                        36390020
         LA    R5,OUTBUF+DSORGOFF    POINT AT DSORG FIELD               36420020
         BCTR  R15,R0              DECREEENT FOR EX OF MOVE             36450000
         EX    R15,DSORGMV         MOVE DSORG TO BUFFER                 36470000
         LA    R5,D1(R5,R15)       POINT BEYOND DSORG IN BUFFER         36490000
         TM    DS1DSORG,UNMV       CHECK DSCB FOR UNMOVABLE ATTRIBUTE   36510000
         BZ    DSORGEXT            EXIT FROM DSORG PROCESSING           36530000
         MVI   D0(R5),UNMVABLE     UNMOVABLE ATTRIBUTE.                 36550000
         B     DSORGEXT            EXIT FROM ROUTINE                    36570000
*                                                                       36590000
SETPS    LA    R15,SEQL            DSORG WAS SEQUENTIAL                 36610000
         LA    R14,SEQ                                                  36630000
         B     EXDSORGM            GO MOVE DSORG TO BUFFER              36650000
*                                                                       36670000
SETPO    LA    R15,PDSL            DSORG WAS PARTITIONED                36690000
         LA    R14,PDS                                                  36710000
         B     EXDSORGM            GO MOVE DSORG TO BUFFER              36730000
*                                                                       36750000
SETIS    LA    R15,ISEQL           DSORG WAS INDEXED SEQUENTIAL         36770000
         LA    R14,ISEQ                                                 36790000
         B     EXDSORGM            GO MOVE DSORG TO BUFFER              36810000
*                                                                       36830000
SETDA    LA    R15,DAL             DSORG WAS DIRECT (BDAM)              36850000
         LA    R14,DIRECT                                               36870000
         B     EXDSORGM            GO MOVE DSORG TO BUFFER              36890000
*                                                                       36910000
SETND    LA    R15,UNDEFL          DSORG WAS NOT DEFINED                36930000
         LA    R14,UNDEF                                                36950000
         B     EXDSORGM            GO MOVE DSORG TO BUFFER              36970000
DSORGEXT EQU   *                                                        36990000
         MVC   WRKCREDT,DS1CREDT   MOVE CREATE DATE TO COMMON  @YL026YA 37010000
         MVC   WRKEXPDT,DS1EXPDT   MOVE EXPIR. DATE TO COMMON  @YL026YA 37030000
         LR    R1,R13              SAVE DYNAMIC AREA ADDRESS            37050000
         L     R13,D4(R1)          CALLERS SAVEAREA                     37070000
         FREEMAIN R,LV=SAVELEN,A=(1),SP=WORKSP                          37090000
         RETURN                    (14,12)                              37110000
*                                                                       37130000
DSORGOFF EQU   22                  OFFSET TO DSORG FIELD                37150000
RECFMOFF EQU   2                   OFFSET TO RECFM FIELD IN BUFFER      37170000
UTYPE    EQU   X'C0'               MASK FOR UNDEFINED                   37190000
FTYPE    EQU   X'80'               MASK FOR FIXED                       37210000
TOVFLOW  EQU   X'20'               TRACK OVERFLOW MASK                  37230000
BLOCKED  EQU   X'10'               BLOCKED ATTRIBUTE MASK               37250000
STANDARD EQU   X'08'               STANDARD BLOCKED (F), OR SPANNED (V) 37270000
ASA      EQU   X'04'               ASA CONTROL CHARACTER                37290000
MACHINE  EQU   X'02'               MACHINE CONTROL CHARACTER            37310000
LRECLOFF EQU   8                   OFFSET TO LRECL FIELD IN BUFFER      37330000
BLKLOFF  EQU   14                  OFFSET TO BLKSIZE FIELD IN BUFFER    37350000
PS       EQU   X'40'               SEQUENTIAL                           37370000
PO       EQU   X'02'               PARTITIONED                          37390000
IS       EQU   X'80'               INDEXED SEQ                          37410000
DA       EQU   X'20'               DIRECT                               37430000
NOTID    EQU   X'1C'               THESE BITS RESERVED IN DSORG         37450000
UNMVABLE EQU   C'U'                UNMOVABLE ATTRIBUTE                  37470000
ASTERISK DC    C'**'               DOUBLE ASTERIKS NO LRECL             37490000
DSORGMV  MVC   D0(D0,R5),D0(R14)   USED WITH EXECUTE CMND               37510000
SEQ      DC    C'PS'               SEQUENTIAL DATA SET ORG              37530000
SEQL     EQU   L'SEQ               LENGTH OF CONSTANT SEQ               37550000
PDS      DC    C'PO'               PARTITIONED DATA SET ORG             37570000
PDSL     EQU   L'PDS               LENGTH OF CONSTANT PDS               37590000
ISEQ     DC    C'IS'               INDEXED SEQUENTIAL                   37610000
ISEQL    EQU   L'ISEQ              LENGTH OF IS CONSTANT                37630000
DIRECT   DC    C'DA'               DIRECT ACCESS                        37650000
DAL      EQU   L'DIRECT            LENGTH OF DA CONSTANT                37670000
UNDEF    DC    C'**'               DSORG NOT SPECIFIED                  37690000
UNDEFL   EQU   L'UNDEF                                                  37710000
UNK      DC    C'??'               DSORG NOT RECOGNIZED                 37730000
UNKL     EQU   L'UNK                                                    37750000
UNMV     EQU   X'01'               UNMOVEABLE BIT                       37770000
         DS    0F                  ALIGN WORD BOUNDRY                   38380020
SIGNOFF  DC    X'0000FFFF'         MASK TO TURN OFF HIGH HALF WORD      38390020
         EJECT                                                          38400020
IKJEHLBL CSECT                                                          38460020
*********************************************************************** 38490020
*                                                                       38520020
*   THIS ROUTINE IS ENTERED IF THE LABEL KEYWORD IS SPECIFIED ON THE    38550020
*   ENTERED COMMAND.  THE FORMAT 1 DSCB HAS TO BE AVAILABLE NOW BY      38580020
*   NECESSITY OF THE BASIC FUNCTION OF THE COMMAND.  A HEADING IS PUT   38610020
*   TO THE TERMINAL AND THEN THE DSCB IS FORMATTED AND OUTPUT ONE LINE  38640020
*   AT A TIME.  THE FORMATTING CONSISTS OF PUTING A BLANK BETWEEN EVERY 38670020
*   FIELD IN THE DSCB.  IF THE LINK ADDRESS IS NONZERO, THEN THE NEXT   38700020
*   DSCB IS READ VIA THE OBTAIN MACRO AND IF IT IS THE FORMAT 3, IT IS  38730020
*   FORMATTED IN A SIMILAR FASHION AS MENTIONED ABOVE.  IF IT IS OTHER  38760020
*   THAN THE FORMAT 3, IT IS JUST DUMPED IN HEXIDECIMAL, 36 (ACTUAL)    38790020
*   BYTES AT A TIME.  THE ENTIRE CHAIN IS PUT OUT BEFORE PROCESSING IS  38820020
*   IS COMPLETE.                                                        38850020
*                                                                       38880020
*********************************************************************** 38910020
         ENTRY IKJEHBTX                                                 38940020
LABELRT  SAVE  (14,12),,*                                               38970020
         LR    R10,R15             ESTABLISH BASE REGISTER              39000020
         USING LABELRT,R10                                              39030020
         USING OBTWAD,R12          WORK AREA BASE                       39060000
         GETMAIN R,LV=SAVELEN,SP=WORKSP   GET A SAVE AREA               39090000
         ST    R13,D4(R1)          FORWARD                              39120000
         ST    R1,D8(R13)          AND                                  39150000
         LR    R13,R1              BACKWARD CHAIN.                      39180000
         LA    R7,OUTBUF           POINT AT BUFFER                      39210000
         LR    R14,R7                                                   39240000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             39270000
         BALR  R8,R15              GO WRITE BUFFER                      39300000
         MVC   D0(L'FORMAT1,R7),FORMAT1  MV FORMAT 1 HEADING TO BUFFER  39330000
         LA    R14,L'FORMAT1(R7)                                        39360000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             39390000
         BALR  R8,R15              GO WRITE BUFFER                      39420000
         LA    R4,DS1FMTID         POINT TO DATA TO CONVERT             39450000
         LA    R5,MAXNUM           MAXIMUM COUNT FOR THIS CONVERSION    39480000
         LA    R7,LABELHEX         CONVERSION AREA ADDRESS              39510000
         BAL   R8,BITOHEX          GO CONVERT IT.                       39540000
         MVC   OUTBUF(IDLEN),LABELHEX        IDENTIFIER                 39570020
         MVC   OUTBUF+NSNOFF(SNLEN),LABELHEX+SNOFF SERIAL NUMBER        39600020
         MVC   OUTBUF+NVSOFF(VSLEN),LABELHEX+VSOFF VOLUME SEQUENCE      39630020
         MVC   OUTBUF+NCDOFF(CDLEN),LABELHEX+CDOFF CREATION DATE        39660020
         MVC   OUTBUF+NEDOFF(EDLEN),LABELHEX+EDOFF EXPIRATION DATE      39690020
         MVC   OUTBUF+NNEOFF(NELEN),LABELHEX+NEOFF NUMBER OF EXTENTS    39720020
         MVC   OUTBUF+NNOBDBOF(NOBDBLEN),LABELHEX+NOBDBOFF DS1NOBDB     39750020
         MVC   OUTBUF+NRESOFF1(RESLEN1),LABELHEX+RESOFF1 RESERVED       39780020
         MVC   OUTBUF+NSYSCDOF(SYSCDLEN),LABELHEX+SYSCDOFF DS1SYSCD     39810020
         LA    R7,OUTBUF           PUT BUFFER OUT TO TERMINAL           39840000
         LA    R14,NSYSCDOF+SYSCDLEN(R7)  END OF DATA IN BUFFER         39870000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             39900000
         BALR  R8,R15              GO WRITE BUFFER                      39930000
         LA    R4,DS1SYSCD+L'DS1SYSCD POINT AT NEXT DATA TO CONVERT     39960000
         LA    R5,MAXNUM           SET UP MAXIMUM COUNT TO CONVERT      39990000
         LA    R7,LABELHEX         POINT TO RECEIVING AREA              40020000
         BAL   R8,BITOHEX          CONVERT                              40050000
         MVC   OUTBUF(RESLEN2),LABELHEX     RESERVED AREA               40080020
         MVC   OUTBUF+NDSORGOF(DSORGLEN),LABELHEX+DSORGOF  DSORG FIELD  40110020
         MVC   OUTBUF+NRECFMOF(RECFMLEN),LABELHEX+RECFMOF  RECFM FIELD  40140020
         MVC   OUTBUF+NOPTCDOF(OPTCDLEN),LABELHEX+OPTCDOFF OPTCD FIELD  40170020
         MVC   OUTBUF+NBLKLOF(BLKLLEN),LABELHEX+BLKLOF    BLKL FIELD    40200020
         MVC   OUTBUF+NLRECLOF(LRECLLEN),LABELHEX+LRECLOF  LRECL FIELD  40230020
         MVC   OUTBUF+NKEYLOFF(KEYLLEN),LABELHEX+KEYLOFF   KEYL FIELD   40260020
         MVC   OUTBUF+NRKPOFF(RKPLEN),LABELHEX+RKPOFF      RKP  FIELD   40290020
         MVC   OUTBUF+NDSINDOF(DSINDLEN),LABELHEX+DSINDOFF DSIND FIELD  40320020
         MVC   OUTBUF+NSCALOOF(SCALOLEN),LABELHEX+SCALOOFF SCALO FIELD  40350020
         MVC   OUTBUF+NLSTAROF(LSTARLEN),LABELHEX+LSTAROFF LSTAR FIELD  40380020
         MVC   OUTBUF+NTRBALOF(TRBALLEN),LABELHEX+TRBALOFF TRBAL FIELD  40410020
         MVC   OUTBUF+NRESOFF3(RESLEN3),LABELHEX+RESOFF3 RESRVD FIELD   40440020
         LA    R7,OUTBUF           WRITE                                40470000
         LA    R14,NRESOFF3+RESLEN3(R7) END OF DATA IN BUFFER           40500000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             40530000
         BALR  R8,R15              GO WRITE BUFFER                      40560000
         LA    R4,DS1EXT1          SETUP TO CONVERT                     40590000
         LA    R5,MAXNUM           REMAINING DATA.                      40620000
         LA    R7,LABELHEX                                              40650000
         BAL   R8,BITOHEX          GO TO CONVERT.                       40680000
         MVC   OUTBUF(EXT1LEN),LABELHEX   FIRST EXTENT                  40710020
         MVC   OUTBUF+NEXT2OFF(EXT2LEN),LABELHEX+EXT2OFF SECOND EXTENT  40740020
         MVC   OUTBUF+NEXT3OFF(EXT3LEN),LABELHEX+EXT3OFF THIRD EXTENT   40770020
         MVC   OUTBUF+NPTRDSOF(PTRDSLEN),LABELHEX+PTRDSOFF PTRDS FIELD  40800020
         LA    R7,OUTBUF           POINT AT BUFFER                      40830000
         LA   R14,NPTRDSOF+PTRDSLEN(R7)   END OF BUFFER POINTER         40860000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             40890000
         BALR  R8,R15              GO WRITE BUFFER                      40920000
ZEROCHCK CLC   DS1PTRDS,ZEROES     CHECK FOR OTHER DSCB ON CHAIN        40950000
*************************************************                       40980020
*******CONTINUE CHECKING FOR MORE DSCBS**********                       41010020
*******IF NONE EXIT FROM ROUTINE      ***********                       41040020
*************************************************                       41070020
         BE    LABELEXT            GO EXIT FROM THIS ROUTINE            41100000
         MVC   OBTCLST(D4),CAMLSTSK  SETUP FOR OBTAINING NEXT DSCB      41130000
         MVC   OBTCCHHR,DS1PTRDS   MOVE CHAIN CCHHR TO SAVE AREA        41160000
         LA    R1,OBTCCHHR         POINT AT CCHHR OF NEXT BLOCK         41190000
ZEROCHK1  EQU  *                                                        41220000
         ST    R1,OBTCLST+D4       AND PLACE IN CAMLST                  41250000
         LR    R14,R7              SKIP                                 41280000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             41310000
         BALR  R8,R15              GO WRITE BUFFER                      41340000
*                                                                       41370020
*                                                                       41400020
****** DO OBTAIN AT THIS POINT TO READ DSCB***                          41430020
*                                                                       41460020
*                                                                       41490020
         OBTAIN                    OBTCLST                              41520000
         LTR   R15,R15             TEST RETURN CODE                     41550000
         BZ    LABELOK             IF GOOD, GO PROCESS                  41580000
         LA    R1,MSG06            INDICATE FIRST LEVEL MESSAGE         41610000
         STH   R1,ERRPARM          STORE CODE IN PARAMETER LIST         41640000
         LA    R1,SECMSG02         GET SECOND LEVEL MESSAGE CODE        41670000
         STH   R1,ERRSECND         SAVE IT                              41700000
         CVD   R15,ERRINSRT+D8     CONVERT RC TO DECIMAL                41730000
        UNPK  ERRINSRT+D1(D2),ERRINSRT+D8(D8)  UNPACK                   41760000
         OI    ERRINSRT+D2,ZONE    GET RID OF SIGN                      41790000
         LA    R1,D2               LENGTH OF DATA                       41820000
         STC   R1,ERRINSRT         PLACE BEFORE DATA                    41850000
         LA    R1,ERRINSRT         PLACE ADDRESS OF DATA IN SLOT        41880000
         ST    R1,ERRINST2         FOR SECOND LEVEL MESSAGE             41910000
         LR    R1,R13              SAVE DYNAMIC AREA ADDRESS            41940000
         L     R13,D4(R1)          CALLERS SAVE AREA                    41970000
         L     R2,VCONERRT         ADDRESS OF ERROUT                    42000000
         L     R3,D12(R13)         GET NORMAL RETURN                    42030000
         ST    R2,D12(R13)         SAVE IN SAVE AREA NORMAL RETURN SLOT 42060000
         ST    R3,RETCD52(R13)     SET RETURN FROM ERROUT NORMAL        42090000
LABELEND EQU *                                                          42120000
         FREEMAIN R,LV=SAVELEN,A=(1),SP=WORKSP                          42150000
         LM    R14,R12,D12(R13)    RESTORE REGISTERS                    42180000
         BR    R14                 RETURN TO CALLER                     42210000
LABELOK  EQU   *                                                        42240000
         CLI   LABELID,FOX3        CHECK FOR FORMAT 3                   42270000
         BNE   LABEL02             NO,  GO PROCESS UNKNOWN FORMAT       42300000
         MVC   OUTBUF(L'FORMAT3),FORMAT3  MOVE HEADING TO BUFFER        42330000
         LA    R7,OUTBUF                                                42360000
         LA    R14,L'FORMAT3(R7)   POINT BEYOND HEADING                 42390000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             42420000
         BALR  R8,R15              GO WRITE BUFFER                      42450000
*                                                                       42510020
**********CONVERT LABEL ROUTINE  **************                         42540020
*                                                                       42570020
         LA    R7,LABELHEX         SETUP                                42600000
         LA    R4,OBTWORKA         TO                                   42630000
         LA    R5,MAXNUM2          CONVERT LABEL.                       42660000
         BAL   R8,BITOHEX          CONVERT TO PRINTABLE HEX             42690000
         MVC   OUTBUF(KEYIDLEN),LABELHEX    KEY IDENTIFER               42720020
         MVC   OUTBUF+NF3OFF1(F3EXTLEN),LABELHEX+F3OFF1 EXTENT 1        42750020
         MVC   OUTBUF+NF3OFF2(F3EXTLEN),LABELHEX+F3OFF2 EXTENT 2        42780020
         MVC   OUTBUF+NF3OFF3(F3EXTLEN),LABELHEX+F3OFF3 EXTENT 3        42810020
         LA    R7,OUTBUF           POINT AT BUFFER                      42840000
        LA    R14,NF3OFF3+F3EXTLEN(R7) END OF DATA                      42870000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             42900000
         BALR  R8,R15              GO WRITE BUFFER                      42930000
         LA    R7,LABELHEX         CONVERT                              42960000
         LA    R4,LABLOFF1         ANOTHER                     @YL026YA 42990000
         LA    R5,MAXNUM2          BLOCK OF DATA.                       43020000
         BAL   R8,BITOHEX          GO CONVERT DATA                      43050000
         MVC   OUTBUF(F3EXTLEN),LABELHEX  EXTENT 4                      43080000
         MVC   OUTBUF+NF3OFF4(F3IDLEN),LABELHEX+F3OFF4 ID BYTE @YL026YA 43110000
         MVC   OUTBUF+NF3OFF5(F3EXTLEN),LABELHEX+F3OFF5 EXTENT 5        43140000
         MVC   OUTBUF+NF3OFF6(F3EXTLEN),LABELHEX+F3OFF6 EXTENT 6        43170000
         LA    R7,OUTBUF           POINT AT BUFFER                      43200000
         LA    R14,NF3OFF6+F3EXTLEN(R7) END OF BUFFER                   43230000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             43260000
         BALR  R8,R15              GO WRITE BUFFER                      43290000
         LA    R7,LABELHEX         CONVERT                              43320000
         LA    R4,LABLOFF2         ANOTHER                     @YL026YA 43350000
         LA    R5,MAXNUM2          BLOCK OF DATA                        43380020
         BAL   R8,BITOHEX           TO PRINTABLE HEXADECIMAL.           43410020
         MVC   OUTBUF(F3EXTLEN),LABELHEX  EXTENT 7                      43440020
         MVC   OUTBUF+NF3OFF7(F3EXTLEN),LABELHEX+F3OFF7 EXTENT 8        43470020
         MVC   OUTBUF+NF3OFF8(F3EXTLEN),LABELHEX+F3OFF8 EXTENT 9        43500020
         LA    R7,OUTBUF           POINT AT BUFFER                      43530000
         LA    R14,NF3OFF8+F3EXTLEN(R7) END OF BUFFER          @YL026YA 43560000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             43590000
         BALR  R8,R15              GO WRITE BUFFER                      43620000
         LA    R7,LABELHEX         CONVERT                              43650000
         LA    R4,LABLOFF3         MORE                                 43680000
         LA    R5,MAXNUM2          DATA.                                43710000
         BAL   R8,BITOHEX          GO TO CONVERT ROUTINE                43740000
         MVC   OUTBUF(F3EXTLEN),LABELHEX  EXTENT 10                     43770020
         MVC   OUTBUF+NF3OFF7(F3EXTLEN),LABELHEX+F3OFF7 EXTENT 11       43800020
         MVC   OUTBUF+NF3OFF8(F3EXTLEN),LABELHEX+F3OFF8 EXTENT 12       43830020
         LA    R7,OUTBUF           OUTPUT                               43860000
         LA    R14,NF3OFF8+F3EXTLEN(R7) THE                    @YL026YA 43890000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             43920000
         BALR  R8,R15              GO WRITE BUFFER                      43950000
         LA    R7,LABELHEX         CONVERT                              43980000
         LA    R4,LABLOFF4         LAST                        @YL026YA 44010000
         LA    R5,MAXNUM3          FIELDS OF                            44040000
         BAL   R8,BITOHEX          FORMAT 3.                            44070000
         MVC   OUTBUF(F3EXTLEN),LABELHEX  EXTENT 13                     44100000
         MVC   OUTBUF+NF3OFF7(PTRDSLEN),LABELHEX+F3OFF7 PTRDS FIELD     44130000
         LA    R7,OUTBUF           BUFFER                               44160000
         LA    R14,NF3OFF7+PTRDSLEN(R7) END OF DATA                     44190000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             44220000
*                                                                       44250020
*                                                                       44280020
*******AT THIS POINT WRITE THE DATA AND EXIT THE ROUTINE**              44310020
*                                                                       44340020
         BALR  R8,R15              GO WRITE BUFFER                      44370000
LABELEXT EQU  *                                                         44400000
         LR    R1,R13              SAVE DYNAMIC AREA                    44430000
         L     R13,D4(R1)          CALLERS SAVEAREA                     44460000
         B     LABELEND             FREE UP STORAGE AND RETURN          44490020
LABEL02  EQU   *                                                        44520020
         MVC   OUTBUF(L'FORMAT2),FORMAT2  MOVE HEADING TO BUFFER        44550020
         MVC   OUTBUF+IDOFF(L1),LABELID    PUT FORMAT ID IN HEADING     44580020
         LA    R7,OUTBUF           POINT TO BUFFER                      44610020
         LA    R14,L'FORMAT2(R7)   END OF DATA                          44640020
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             44670000
         BALR  R8,R15              GO WRITE BUFFER                      44700000
         LA    R4,OBTWORKA         POINT AT START OF DSCB               44730000
LABELOOP EQU   *                                                        44760000
         LA    R5,MAXNUM2          SET AMOUNT TO BE CONVERTED           44790000
         LA    R7,OUTBUF           POINT TO RECEIVING AREA              44820000
         BAL   R8,BITOHEX             CONVERTS BINARY TO HEX            44850000
         LA    R7,OUTBUF           POINT AT BUFFER                      44880000
         LA    R14,EOBUFF1(R7)     END OF BUFFER               @YL026YA 44910000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             44940000
         BALR  R8,R15              GO WRITE BUFFER                      44970000
*                                                                       45000020
*    BITOHEX BUMPS REG 4 BY 4 EACH TIME IT GOES THROUGH THE PROCESS     45030020
*    LOOP SO THAT WHEN WE GET CONTROL BACK IT SHOULD BE POINTING AT     45060020
*    THE NEXT DATA TO CONVERT. THIS WILL BE TRUE ONLY IF THE DATA       45090020
*    COUNT IS A MULTIPLE OF 4, IN THIS CASE 36. OTHERWISE THE POINTER   45120020
*    WOULD BE OFF A COUPLE OF BYTES.                                    45150020
*                                                                       45180020
         LA    R4,FOUR(R4)         BUMP PTR NEXT DATA TO CONVERT        45210000
         LA    R1,LABLOFF5         POINT AT END OF 36 BYTE MULTIPLES    45230000
         CR    R4,R1               SEE IF ALL 36-BYTE CHUNKS ARE DONE   45250000
         BL    LABELOOP            NO, GO DO ANOTHER ONE.               45270000
         LA    R5,MAXNUM4          SET COUNT TO REMAINDER               45290000
         LA    R7,OUTBUF           POINT AT BUFFER                      45310000
         BAL   R8,BITOHEX          CONVERT REMAINING DATA               45330000
         LA    R7,OUTBUF           POINT AT BUFFER                      45350000
         LA    R14,EOBUFF1(R7)     END OF BUFFER               @YL026YA 45370000
         L     R15,VCONWRTE        ADDRESS OF WRITE ROUTINE             45390000
         BALR  R8,R15              GO WRITE BUFFER                      45410000
         CLC   LBLCHAIN(L'DS1PTRDS),ZEROES SEE IF CCHHR OF NEXT IS 0.   45430000
         BE    LABELEXT            NO, GO EXIT                          45450000
         MVC   OBTCLST(D4),CAMLSTSK   SETUP CAMLST CODE                 45470000
         MVC  OBTCCHHR,LBLCHAIN     SAVE CCHHR                          45490000
         LA    R1,OBTCCHHR         POINT AT CCHHR                       45510000
         B     ZEROCHK1            GO ISSUE OBTAIN                      45530000
IKJEHBTX DS    0H                                                       45710020
BITOHEX  EQU   *                                                        45730020
*********************************************************************** 45750020
*                                                                       45780020
*    THIS ROUTINE CONVERTS BINARY DATA TO HEXIDECIMAL REPRESENTATION    45810020
*    FOR OUTPUT TO A TERMINAL.                                          45840020
*         INPUT IS AS FOLLOWS.                                          45870020
*                                                                       45900020
*                 R4 - POINTS TO DATA TO CONVERT                        45930020
*                 R5 - CONTAINS LENGTH OF DATA IN BYTES                 45960020
*                 R7 - POINTS TO OUTPUT AREA FOR CONVERTED DATA         45990020
*                                                                       46020020
*        R2 AND R3 ARE USED FOR LOGICAL OPERATIONS                      46050020
*                                                                       46080020
*********************************************************************** 46110020
         AR    R5,R5               DOUBLE COUNT TO CORRESPOND TO OUTPUT 46140000
         XR    R3,R3               CLEAR REG TO HOLD DATA               46170000
BILOOP01 LA    R1,CONVCNT          NUMBER OF HALF BYTES TO CONVERT      46200000
         MVC   ALIGN(FOUR),D0(R4)   ALIGN FOUR BYTES TO CONVERT         46230000
         L     R3,ALIGN            PUT FOUR BYTES INTO ODD REGISTER     46260000
BILOOP02 XR    R2,R2                                                    46290000
         SLDL  R2,FOUR             GET NEXT 4 BITS TO CONVERT TO HEX    46320000
         IC    R0,TRANSTAB(R2)     GET PROPER CHARACTER                 46350000
         STC   R0,D0(R7)           PLACE IN OUT AREA                    46380000
         LA    R7,D1(R7)           UPDATE OUT AREA POINTER BY ONE       46410000
         BCTR  R5,R0               DECREMENT COUNT BY ONE               46440000
         LTR   R5,R5               ARE THERE MORE BYTES TO CONVERT      46470000
         BCR   CONDZERO,R8         IF ZERO, RETURN TO CALLER            46500000
         BCT   R1,BILOOP02         DECREMENT LOOP COUNT AND GO AGAIN    46530000
         LA    R4,FOUR(R4)         IF ZERO, POINT AT NEXT BYTES         46560000
         B     BILOOP01            GET NEXT FOUR BYTES TO CONVERT       46590000
CAMLSTSK CAMLST SEEK,1,2,3                                              46620020
********************************************                            46650020
******THE FOLLOWING TABLE IS USED FOR THE **                            46680020
******TRANSLATE INSTRUCTION FOR CONVERTING**                            46710020
******BINARY TO HEX REPRESENTATION *********                            46740020
********************************************                            46770020
TRANSTAB DC    C'0123456789ABCDEF' TRANSLATE TABLE FOR BITOHEX ROUTINE  46970020
ZEROES   DC    5X'00'              FIVE BYTES OF ZEROES                 47280000
FORMAT1  DC    C'--FORMAT 1 DSCB--'         HEADING FOR LABEL COMMAND   47310020
FORMAT2  DC    C'--FORMAT 2 DSCB--'         HEADING FOR LABEL COMMAND   47340020
FORMAT3  DC    C'--FORMAT 3 DSCB--'         HEADING FOR LABEL COMMAND   47370020
VCONWRTE DC    V(IKJEHWRT)         ADDRESS OF WRITE ROUTINE             47400000
VCONERRT DC    V(IKJEHERR)         ADDRESS OF ERROR ROUTINE             47430000
         EJECT                                                          47460020
IKJEHHIS CSECT                                                          47520020
*********************************************************************** 47550020
*                                                                       47580020
*    THIS ROUTINE GETS CONTROL IF THE HISTORY KEYWORD IS SPECIFIED.     47610020
*    THE REQUIRED INFORMATION IS COLLECTED FROM THE DSCB THAT IS        47640020
*    AVAILABLE AT THIS TIME SINCE IT IS REQUIRED FOR THE BASIC FUNCTION 47670020
*    OF THE COMMAND. THE INFORMATION WHICH IS REFERENCED THROUGH DSECT  47700020
*    OBTWAD IS AS FOLLOWS.                                              47730020
*                  1. CREATION DATE                                     47760020
*                  2. EXPIRATION DATE                                   47790020
*                  3. SECURITY (PASSWORD) INFORMATION                   47820020
*                                                                       47850020
*********************************************************************** 47880020
HISTROUT SAVE (14,12),,*                                                47940020
         LR    R10,R15             ESTABLISH ADDRESSABILITY             47970000
         USING HISTROUT,R10                                             47990000
         USING OBTWAD,R12          WORKAREA BASE                        48010000
         GETMAIN R,LV=SAVELEN,SP=WORKSP  GET SAVEAREA FOR THIS ROUTINE  48030000
         ST    R13,D4(R1)          CHAIN AREAS TOGETHER                 48050000
         ST    R1,D8(R13)                                               48070000
         LR    R13,R1              NEW SAVEAREA ESTABLISHED             48090000
         LA    R7,OUTBUF          INITIALIZE POINTER                    48110000
         CLI   DSTYPE,CTGTALIN    CHECK FOR VSAM               @VS06171 48130000
         BNE   VSAMHIST           YES                          @VS06171 48150000
         LA    R2,WRKCREDT         GET CREATION DATE ADDR      @YL026YA 48170000
         LA    R7,CRDTOFF(R7)      POINT AT BUFFER POSITION             48190000
         BAL   R14,HDT02           GO CONVERT DATE AND PUT IN BUFFER    48210000
         LA    R2,WRKEXPDT         GET EXPIRATION DATE ADDR    @YL026YA 48230000
         LA    R7,NXTBUF(R7)       POINT AT NEXT BUFFER POSITION        48250000
         BAL   R14,HDT02           GO CONVERT DATE AND PUT IN BUFFER    48270000
CHKPROT  LA    R7,NXTBUF(R7)       POINT AT NEXT BUFFER POSITION        48290000
         CLI   DSTYPE,CTGTALIN     IS DATA SET NONVSAM?        @VS06171 48310000
         BNE   HISTEXIT            NO, NO PROTECTION INFO      @VS06171 48330000
*     CHECK FOR VARIOUS COMBINATIONS OF RACF AND PASSWORD PROTECTION    48380004
         TM    DS1DSIND,RACOPWD    RACF AND PASSWORD?          @Z40RSSA 48390004
         BNO   NTBOTH                  NO                      @Z40RSSA 48400004
         MVC   D0(9,R7),WPWDRAC                                @Z40RSSA 48402004
TSTREAD  TM    DS1DSIND,WPIND      WRITE PASSWORD PROTECT?     @Z40RSSA 48404004
         BO    HISTEXIT               YES                      @Z40RSSA 48406004
         MVI   D0(R7),C'R'            NO, CHANGE TO RPWD/RACF  @Z40RSSA 48408004
HISTEXIT EQU    *                                                       48410000
         LR    R1,R13              SAVE DYNAM AREA ADDR FOR FREEMAIN    48430000
         L     R13,D4(R1)          CALLERS SAVEAREA                     48450000
         FREEMAIN R,LV=SAVELEN,A=(1),SP=WORKSP                          48570020
         RETURN (14,12)                                                 48600020
         SPACE 1                                                        48650004
NTBOTH   MVC   D0(4,R7),NONE       ASSUME NONE                 @Z40RSSA 48710004
         BZ    HISTEXIT                IF NONE                 @Z40RSSA 48712004
         MVC   D0(4,R7),RACF       ASSUME RACF                 @Z40RSSA 48714004
         TM    DS1DSIND,RACIND                                 @Z40RSSA 48716004
         BO    HISTEXIT                RACF ONLY               @Z40RSSA 48718004
         MVC   D0(4,R7),WPWD       ASSUME WPWD ONLY            @Z40RSSA 48718404
         B     TSTREAD             TO TEST FOR READ            @Z40RSSA 48768404
VSAMHIST LA    R2,WRKCREDT        CREATION DATE IN BINARY               48813000
         LA    R7,L15(R7)         OFFSET FOR OUTPUT                     48816000
         BAL   R14,HDT02          CONVERT TO DEC.                       48819000
         LA    R2,WRKEXPDT        EXPIRE DATE IN BINARY                 48822000
         LA    R7,NXTBUF(R7)      OFFSET IN BUFFER                      48825000
         BAL   R14,HDT02          CONVERT TO DEC.                       48828000
         B     CHKPROT            CHECK FOR PROTECTION                  48831000
*                                                                       48840020
*                                                                       48870020
*    THIS ROUTINE CONVERTS BINARY DATES OF THE FORM YYDDDD TO         * 48900020
*    CHARACTER FORMAT IN THE FORM MM/DD/YY. LEAP YEARS ARE ACCOUNTED  * 48930020
*    FOR. INPUT REQUIREMENTS ARE.                                     * 48960020
*         1.   R2 POINTS TO FIELD TO BE CONVERTED                     * 48990020
*         2.   R7 POINTS TO RECEIVING FIELD                           * 49020020
*         3.   R14 HAS RETURN ADDRESS.                                * 49050020
*                                                                     * 49080020
HDT02 EQU      *                                                        49110020
         CLC   D0(D3,R2),HDTZ      CHECK FOR UNSPECIFIED DATE           49140000
         BNE   HDT04               BRANCH IF DATE PRESENT               49170000
HDT03    MVC   D0(L'HDTDF,R7),HDTDF  MOVE IN DEFAULT OF 00/00/00        49200000
         BR    R14                 RETURN                               49230000
HDT04    STM   R14,R6,HDTSV        SAVE REGS                            49260000
*                                                                       49290020
*  TEST FOR LEAP YEAR BY ANDING THE YEAR FIELD AGAINST A BYTE WITH    * 49320020
*  THE TWO LOW ORDER BITS ON.  LEAP YEARS WILL HAVE ZEROS FOR THE TWO * 49350020
*  LOW ORDER BYTES.                                                   * 49380020
*                                                                     * 49410020
         SR    R3,R3               CLEAR REG FOR INSERT CHARACTER.      49440000
         IC    R3,D0(R2)           GET YEAR BYTE FROM DATE FIELD.       49470000
         LA    R4,HDTBIN3          SET UP TO TEST LOW ORDER BITS.       49500000
         NR    R3,R4               IF YEAR IS DIVISIBLE BY 4,PROD EQ 0. 49530000
         LA    R4,HDTNY            SET UP FOR NON-LEAP YR -SAVE COND CD 49560000
         BNZ   HDT06               IF PROD N. EQ. TO ZERO, NOT LEAP YR. 49590000
         LA    R4,HDTLY            IF REMAINDER IS ZERO, USE LEAP YR.   49620000
*                                                                       49650000
HDT06    MVC   HDTWK(L2),D1(R2)    MOVE 2 BYTE DAY FLD TO HWORD         49680000
         LH    R3,HDTWK            PUT INTO REGISTER                    49710000
         LA    R6,NUMMONTH         SET UP BR CTL AS NO. OF MONTHS       49740000
*                                                                       49770020
*  SEARCH NOW BEGINS TO FIND THE MONTH THAT THE DAY-OF-THE-YEAR OCCURS  49800020
*  IN.  IF DAY-OF-THE-YEAR IS GREATER THAN 365/366, MONTH 12 IS USED.   49830020
*                                                                       49860020
HDT08    CH     R3,D0(R4)          COMPARE DAY TO TABLE ENTRY FOR MONTH 49890000
         BH    HDT10               DAY GREATER THAN TABLE IS A FIND     49920000
         LA    R4,D2(R4)           UP TBL PTR TO NEXT ELEMENT.          49950000
         BCT   R6,HDT08            DECREMENT MONTH AND RETRY.           49980000
         B     HDT03               IF DAY NEG, USE DEFAULT 00/00/00     50010000
HDT10    SH    R3,D0(R4)           SUBTRACT TABLE ELEMENT FROM DAY      50040000
         EX    R3,HDTCLI           COMPARE DAY TO 31.                   50070000
         BNL   HDT12               IF VALUE LESS THAN 31 OK             50100000
         LA    R3,DAYS31           DEFAULT TO 31 DAYS.                  50130000
HDT12    CVD   R6,HDTWK            CONVERT MONTH TO DEC                 50160000
        UNPK   D0(L2,R7),HD6(D2)   THEN TO CHARCTER                     50190000
         CVD   R3,HDTWK            CONVERT DAY TO DECIMAL               50220000
        UNPK   D3(L2,R7),HD6(D2)   THEN TO CHARACTER                    50250000
         IC    R6,D0(R2)           GET YEAR                             50280000
         CVD   R6,HDTWK            CONVERT IT TO DECIMAL                50310000
         UNPK  D6(L2,R7),HD6(D2)   THEN TO CHAR                         50340000
        MVZ    D1(L7,R7),D0(R7)    PROPAGATE A NUM CHAR ZONE            50370000
         MVI   D2(R7),SLASH        MOVE IN SEPARATORS BETWEEN           50400000
         MVI   D5(R7),SLASH        MONTH DAY AND YEAR                   50430000
         LM    R14,R6,HDTSV        RESTORE REGS                         50460000
HDT16    BR    R14                 RETURN                               50490000
*                                                                       50520020
*                                                                       50550020
*  THE FOLLOWING CONSTANTS ARE USED BY THE HISTORY ROUTINE.             50580020
*                                                                       50610020
HDTCLI   CLI   HDTC31,D0           EXECUTED TO CHECK IF DATE IS GT 31   50620020
RACIND   EQU  X'40'                MASK FOR RACF PROTECTION(DSCB)       50670004
WPIND    EQU  X'04'                WRITE PASSWORD PROTECT(DSCB)         50720004
RACOPWD  EQU  X'50'                RACF OR PASSWORD PROTECTION          50770004
NONE     DC   C'NONE'              NO RACF OR PASSWORD PROTECTION       50780004
RACF     DC   C'RACF'              RACF PROTECTION ONLY                 50782004
WPWD     DC   C'WPWD'              WRITE PASSWORD ONLY                  50784004
WPWDRAC  DC   C'WPWD/RACF'         WRITE PASSWORD AND RACF              50786004
HDTZ     DC    X'000000'           MASK OF NO DATE SPECIFIED            50790000
HDTDF    DC    C'00/00/00'         DEFAULT OF NO DATE PRINTED           50820000
HDTC31  DC    FL1'31'              USED FOR COMPARE OF 31 DAYS          50850000
*****************************************************************       50910020
**                                                                      50940020
**THE TABLE BELOW IS USED FOR THE MONTH LOOKUP IN NORMAL YEARS***       50970020
***                                                                     51000020
HDTNY    DC    H'334'              DECEMBER                             51030000
         DC    H'304'              NOVEMBER                             51060000
         DC    H'273'              OCTOBER                              51090000
         DC    H'243'              SEPTEMBER                            51120000
         DC    H'212'              AUGUST                               51150000
         DC    H'181'              JULY                                 51180000
         DC    H'151'              JUNE                                 51210000
         DC    H'120'              MAY                                  51240000
         DC    H'90'               APRIL                                51270000
         DC    H'59'               MARCH                                51300000
         DC    H'31'               FEBRUARY                             51330000
         DC    H'0'                JANUARY                              51360000
***************************************************************         51390020
****                                                                    51420020
****MONTHLY TABLE LOOKUP IN LEAP YEARS              ***********         51450020
****                                                                    51480020
HDTLY    DC    H'335'              DECEMBER                             51510000
         DC    H'305'              NOVEMBER                             51540000
         DC    H'274'              OCTOBER                              51570000
         DC    H'244'              SEPTEMBER                            51600000
         DC    H'213'              AUGUST                               51630000
         DC    H'182'              JULY                                 51660000
         DC    H'152'              JUNE                                 51690000
         DC    H'121'              MAY                                  51720000
         DC    H'91'               APRIL                                51750000
         DC    H'60'               MARCH                                51780000
         DC    H'31'               FEBRUARY                             51810000
         DC    H'0'                JANUARY                              51840000
*****                                                                   51870020
***END OF TABLE LOOKUP FOR MONTHS****                                   51900020
*****                                                                   51930020
HDTBIN3  EQU   X'03'               BYTE WITH TWO LOW ORDER BITS EQ 1'S  51960000
HDTL     EQU   10                                                       51990020
*                                                                       52020020
         EJECT                                                          52050020
IKJEHDS1 CSECT                                                          52110020
IKJEHWRT DS    0H                                                       52130020
WRITE    EQU   *                                                        52150020
*********************************************************************** 52170020
*                                                                     * 52200020
*   INPUT TO THIS ROUTINE IS THE BUFFER ADDRESS IN REG7 AND END       * 52230020
*   OF BUFFER ADDRESS IN REG 14. RETURN ADDRESS IS IN REG8.           * 52260020
*                                                                       52290020
*   THE OUTPUT BUFFER IS CLEARED AND RETURNED IN REG7.                  52320020
*   TRAILING BLANKS WILL BE ELIMINATED.                                 52350020
*                                                                       52380020
*  IMPORTANT---THIS ROUTINE REQUIRES NO BASE REGISTER. KEEP IT THAT     52410020
*  WAY SO THAT IKJEHMEM CAN USE IT.(SEE CALL PARAMETERS)                52440020
*                                                                       52470020
*********************************************************************** 52500020
         STM   R0,R9,LOCSAVOF(R13)  SAVE REGISTERS LOCALLY              52530020
         LR    R2,R14              COPY THE END OF DATA PTR             52560000
         SR    R2,R7               CALCULATE DATA  LENGTH               52590000
         LA    R1,FOUR             DECREMENT BUFFER POINTER BY 4,       52620000
         SR    R7,R1               SO R7 WILL POINT AT LL FIELD         52650000
         LA    R2,FOUR(R2)         BUMP LENGTH FOR LL AND OFF FIELD     52680000
         STH   R2,D0(R7)           STORE LENGTH OF DATA IN LL FIELD     52710000
         XC    D2(L2,R7),D2(R7)    CLEAR OFFSET BYTE                    52740000
         LR    R6,R7               PUT OUTPUT LINE POINTER IN PROPER    52770000
         LA    R1,PARMLSTL         POINT INFRONT OF BUFFER TO PARM LIST 52800000
         SR    R7,R1               CONTAING VARIOUS ADCONS. (SEE DSECT) 52830000
         LM    R1,R5,D0(R7)        SET UP REGISTERS FOR PUTLINE         52860000
         L     R15,PARMLSTL-FOUR(R7) GET ENTRY POINT.                   52890020
         PUTLINE PARM=(R2),UPT=(R3),ECT=(R4),ECB=(R5),OUTPUT=((R6),    X52920020
               DATA),ENTRY=(15),MF=(E,(1))                              52950020
***********************************************************             52980020
*                                                                       53010020
*                                                                       53220020
************************************************************            53250020
         LA    R7,PARMLSTL+FOUR(R7) POINT BACK TO DATA BUFFER           53280020
*                                                                       53310020
         MVI   D0(R7),BLANK                                             53340020
         MVC   D1(L'OUTBUF-L1,R7),D0(R7) CLEAR BUFFER                   53370020
         LM    R0,R9,LOCSAVOF(R13)  RESTORE CALLERS REGISTER            53400020
         BR    R8                  RETURN TO CALLER                     53430000
         EJECT                                                          53460020
*                                                                       53490020
IKJEHERR DS    0H                                                       53510020
ERROUT   EQU   *                                                        53530020
*********************************************************************** 53550020
*                                                                       53580020
*    THIS ROUTINE IS ENTERED VIA A 'BAL R8,ERROUT' INSTRUCTION SEQUENCE 53610020
*    AND IS USED TO OUTPUT ERROR MESSAGES. INPUT IS A THREE WORD LIST   53640020
*    CALLED ERRPARM WHICH CONTAINS INFORMATION AS FOLLOWS.              53670020
*                                                                       53700020
*                    BYTE 1 AND 2 - THE RELATIVE POSITION OF THE FIRST  53730020
*                             LEVEL MESSAGE IN THE MESSAGE CSECT        53760020
*                    BYTE 3 AND 4 - THE RELATIVE POSITION OF THE        53790020
*                             SECOND LEVEL MESSAGE IN THE STRING.       53820020
*                    SECOND WORD  - POINTS TO TEXT TO BE INSERTED AFTER 53850020
*                             FIRST SEGMENT OF FIRST LEVEL MESSAGE.     53880020
*                    THIRD WORD   - POINTS TO TEXT TO BE INSERTED AFTER 53910020
*                             FIRST SEGMENT OF SECOND LEVEL MESSAGE.    53940020
*                                                                       53970020
*                                                                       54000020
*********************************************************************** 54030020
         STM   R0,R9,LOCSAVOF(R13)       SAVE LOCAL REGISTERS           54060020
         MVI   STACKSW,SWON        TURN STACK SWITCH ON                 54070020
         LA    R7,OUTBUF+D4        POINT AT PROPER BUFFER OFFSET        54090000
         LH    R1,ERRPARM          RELATIVE MESSAGE NUMBER              54120000
         BCTR  R1,R0               DECREMENT POSITION COUNT             54150000
         SLL   R1,D3               TIMES 8 TO GET INDEX INTO TABLE      54180000
         L     R6,MSGCSECT         PICK UP VCON FOR CSECT               54210000
         LA    R5,D0(R6,R1)        TABLE ENTRY FOR PROPER MSG           54240000
         LH    R1,D0(R5)           LENGTH OF MESSAGE                    54270000
         LA    R2,D4(R1)           UPDATE LENGTH FOR LL SND OFF FIELDS  54300000
         STH   R2,OUTBUF           SAVE LENGTH                          54330000
        XC     OUTBUF+D2(L2),OUTBUF+D2  CLEAR OFFSET FIELD              54360000
         LH    R4,D2(R5)           OFFSET TO MESSAGE IN CSECT           54390000
         LA    R3,D0(R6,R4)        POINTER TO MESSAGE IN CSECT          54420000
         BCTR  R1,R0               DECREMENT COUNT FOR EX OF MVC        54450000
         EX    R1,MOVE             MOVE MESSAGE TO BUFFER               54480000
         LA    R7,D1(R1,R7)        POINT BEYOND MESSAGE                 54510000
         L     R4,ERRINST1         PICKUP INSERT POINTER                54540000
         LTR   R4,R4               TEST FOR ZERO                        54570000
         BZ    SEGCHECK            IF ZERO, CHECK FOR SEGMENTATION      54600000
         XR    R1,R1                                                    54630000
         IC    R1,D0(R4)           GET LENGTH OF INSERT DATA            54660000
         LA    R3,D1(R4)           POINT AT INSERT DATA                 54690000
         LH    R2,OUTBUF           GET LENGTH                           54720000
         LA    R2,D0(R2,R1)        INCREMENT COUNT                      54750000
         STH   R2,OUTBUF           SAVE IT AGAIN                        54780000
         BCTR  R1,R0               REDUCE COUNT BY ONE                  54810000
         EX    R1,MOVE             MOVE INSERT DATA TO BUFFER           54840000
         LA    R7,D1(R1,R7)                                             54870000
SEGCHECK EQU   *                                                        54900000
         LH    R4,D4(R5)           PICKUP OFFSET OF SEGMENT             54930000
         LTR   R4,R4               TEST FOR ZERO                        54960000
         BZ    SECLVTST            CHECK SECOND LEVEL                   54990000
         LA    R4,D0(R4,R6)        POINT AT SEGMENT TABLE               55020000
SEGLOOP  EQU   *                                                        55050000
         LH    R1,D0(R4)           PICK UP LENGTH OF SEGMENT            55080000
         LTR   R1,R1               TEST CONTENTS OF REGISTERS           55110000
         BZ    SECLVTST            CHECK FOR SECOND LEVEL               55140000
         LH    R2,OUTBUF           GET LENGTH                           55170000
         LA    R2,D0(R2,R1)        INCREMENT COUNT                      55200000
         STH   R2,OUTBUF           SAVE IT AGAIN                        55230000
         LH    R3,D2(R4)           PICKUP OFFSET TO SEGMENT             55260000
         LA    R3,D0(R3,R6)        CALCULATE THE ADDRESS                55290000
         BCTR  R1,R0               DECREMENT FOR MOVE                   55320000
         EX    R1,MOVE             MOVE SEGMENT TO BUFFER               55350000
         LA    R7,D1(R7,R1)        POINT AT END OF DATA IN BUFFER       55380000
         LA    R4,D4(R4)           NEXT SEGMENT SLOT IN TABLE           55410000
         B     SEGLOOP             PROCESS ANOTHER SEGMENT              55440000
*********************************************************               55470020
***SECOND LEVEL MESSAGE CHECKING BEGINS HERE*************               55500020
*********************************************************               55530020
SECLVTST EQU   *                                                        55560020
         LA    R1,D1               SEGMENT COUNT IS 1                   55590000
         ST    R1,MPM11            PUT IN PAARM LIST                    55620000
         LA    R1,OUTBUF                                                55650000
         ST    R1,MPM12            SAVE PTR TO MESSAGE (FIRST LEVEL)    55680000
         LH    R3,ERRSECND         CHECK FOR SECOND LEVEL MESSAGE       55710000
         LTR   R3,R3                                                    55740000
         BZ    NOSECLVL             NO SECOND LEVEL BRANCH =ZERO        55770000
         BCTR  R3,R0               DECREMENT POSITION COUNT             55800000
         LA    R2,D6               TABLE ENTRY SIZE                     55830000
         MR    R2,R2               OFFSET INTO TABLE CALCULATED         55860000
         LH    R4,D6(R5)           OFFSET TO SECOND LEVEL TABLE         55890000
         LA    R4,D0(R4,R6)        ADDRESS OF SECOND LEVEL TABLE        55920000
         LA    R5,D0(R4,R3)        OFFSET TO ENTRY IN TABLE             55950000
         LA    R7,SECBUFF+D4       POINT TO SECOND BUFFER OFFSET        55980000
         LH    R1,D0(R5)           GET LENGTH OF ENTRY                  56010000
         LA    R2,D4(R1)           UPDATE LENGTH FOR LL SND OFF FIELDS  56040000
         STH   R2,SECBUFF          SAVE LENGTH OF FIRST SEGMENT         56070000
         XC    SECBUFF+D2(L2),SECBUFF+D2 CLEAR OFFSET FIELD             56100000
         LH    R4,D2(R5)           OFFSET TO MESSAGE IN CSECT           56130000
         LA    R3,D0(R6,R4)        ADDRESS OF MESSAGE IN CORE           56160000
         BCTR  R1,R0               DECREMENT LENGTH FOR EX OF MOVE      56190000
         EX    R1,MOVE             MOVE MESSAGE SEGMENT TO BUFFER       56220000
         LA    R7,D1(R1,R7)        BUMP BUFFER POINTER                  56250000
         MVC   SECBUFF+D10(L2),OUTBUF+D10   SET ID FOR SECND LEVEL      56280000
         L     R4,ERRINST2         GET INSERT POINTER FOR SECOND LEVEL  56310000
         LTR   R4,R4               TEST FOR ZERO                        56340000
         BZ    SECSEGCK            IF ZERO, CHECK SEGMENTATION          56370000
         XR    R1,R1                                                    56400000
         IC    R1,D0(R4)           GET LENGTH OF INSERT DATA            56430000
         LH    R2,SECBUFF                                               56460000
         LA    R2,D0(R2,R1)        UPDATE LENGTH OF BUFFER MESSAGE      56490000
         STH   R2,SECBUFF          SAVE AGAIN                           56520000
         LA    R3,D1(R4)           POINT AT DATA                        56550000
         BCTR  R1,R0               DECREMENT COUNT FOR MOVE             56580000
         EX    R1,MOVE             MOVE IT TO BUFFER                    56610000
         LA    R7,D1(R1,R7)        UPDATE BUFFER POINTER                56640000
SECSEGCK EQU   *                                                        56670000
         LA    R1,D1               SET SEGMENT COUNT TO ONE             56700000
         ST    R1,MPM21            PUT IT INTO KPARM LIST               56730000
         LA    R1,SECBUFF          PUT BUFFER ADDRESS INTO LIST         56760000
         ST    R1,MPM22                                                 56790000
         LA    R1,MSGPARM2         CHAIN MSG LEVEL PARM LISTS           56820000
         ST    R1,MSGPARM1                                              56850000
         XC    MSGPARM2,MSGPARM2   SETUP LINK ADDRESS TO END OF CHAIN   56880000
         LA    R1,FOXES            PUT X'FF' IN A REGISTER              56910000
         STC   R1,MSGPARM2         PUT END OF LIST IND IN CHAIN FIELD   56940000
         LH    R4,D4(R5)           OFFSET TO SEGMENT TABLE              56970000
         LTR   R4,R4               TEST FOR ZERO                        57000000
         BZ    PUTMSG              IF ZERO, PUT OUT MESSAGE             57030000
         LA    R4,D0(R4,R6)        ADDRESS OF SEGMENT TABLE             57060000
         LH    R1,D0(R4)           LENGTH OF SEGMENT                    57090000
SECSEGLP EQU   *                                                        57120000
         LTR   R1,R1               SEE IF THIS IS THE LAST              57150000
         BZ    PUTMSG              YES, GO                              57180000
         LH    R2,SECBUFF          UPDATE THE LENGTH FIELD              57210000
         LA    R2,D0(R2,R1)                                             57240000
         STH   R2,SECBUFF          RE-STORE IT                          57270000
         LH    R3,D2(R4)           OFFSET TO SEGMENT                    57300000
         LA    R3,D0(R3,R6)        ADDRESS OF MESSAGE                   57330000
         BCTR  R1,R0               DECREMENT COUNT FOR MOVE             57360000
         EX    R1,MOVE             MOVE MESSAGE                         57390000
         LA    R7,D1(R7,R1)        UPDATE BUFFER OFFSET                 57420000
         LA    R4,D4(R4)           GET NEXT SEGMENT                     57450000
        B     SECSEGLP             SEGMENT LOOP                         57480020
NOSECLVL EQU   *                                                        57510020
         XC    MSGPARM1,MSGPARM1   CLEAR SECOND LEVEL POINTER           57540020
PUTMSG   EQU   *                                                        57570020
         LM    R3,R5,UPTPTR        LOAD UPT, ECT, ECB                   57600000
         LA    R6,MSGPARM1         POINT TO MSG PARM LISTS              57630000
         LA    R2,DPUTLINE         LIST FORM OF MACRO                   57660000
         LA    R1,PUTLLIST         LIST FOR E FORM OF MACRO             57690000
         L     R15,PUTLADDR        ADDRESS OF PUTLINE ROUTINE           57720000
*                                                                       57750020
         PUTLINE PARM=(R2),UPT=(R3),ECT=(R4),ECB=(R5),                 X57780020
               OUTPUT=((R6),MULTLVL),ENTRY=(15),MF=(E,(1))              57810020
         XC    ERRPARM(ERRLIST),ERRPARM  CLEAR ERROR PARM LIST          57820020
         LM    R0,R9,LOCSAVOF(R13)       RESTORE LOCAL REGISTERS        57840020
         BR    R8                  RETURN                               57870000
*                                                                       57870800
         EJECT                                                 @YL026YA 57871600
*   THE VSAM BASIC ROUTINE PROCESSES BASIC                     @YL026YA 57872400
*   INFORMATION FOR VSAM DATA SETS                             @YL026YA 57873200
*                                                              @YL026YA 57874000
VSAMBSC  EQU   *                                               @YL026YA 57874800
*  IF ENTRY FOUND IS AN ALIAS, GET INFORMATION FOR THE         @YL026YA 57875600
*  REAL (RELATED) NAME                                         @YL026YA 57876400
         CLI   DSTYPE,CTGTANM      IS THIS ENTRY AN ALIAS?     @YL026YA 57877200
         BNE   GOVSAM              NO, GO AHEAD                @YL026YA 57878000
LOCAGAIN EQU   *                                               @YL026YA 57878800
         XC    CPLAREA,CPLAREA     CLEAR CPL SPACE             @YL026YA 57879600
         LA    R1,CPLAREA          SET UP ADDRESSABILITY       @YL026YA 57880400
         USING CTGPL,R1            TO CPL                      @YL026YA 57881200
         OI    CTGOPTN3,CTGLOC+CTGAM0 SET FUNCTION TO LOCATE   @YL026YA 57882000
         USING CTGFL,R3            SET UP ADDRESSABILITY       @YL026YA 57882800
         LA    R3,CTGFL5           TO CATALOG ACB FPL          @YL026YA 57883600
         L     R3,CTGFLPT          ADDRESS OF CATALOG ACB ADDR @YL026YA 57884400
         ST    R3,CTGCAT           STORE IN CPL                @YL026YA 57885200
         LA    R3,CTGFL6           ADDRESS OF RELATED NAME FPL @YL026YA 57886000
         L     R3,CTGFLPT          ADDRESS OF RELATED NAME     @YL026YA 57886800
         LA    R3,D1(R3)           ADDR OF ENTRY NUMBER ADDR   @YL026YA 57887600
         ST    R3,CTGENT           STORE IN CPL                @YL026YA 57888400
         LA    R2,CATWORK2         ADDRESS OF WORKAREA         @YL026YA 57889200
         ST    R2,CTGWKA           STORE IN CPL                @YL026YA 57890000
         LA    R2,L'CATWORK2       GET LENGTH OF WORKAREA      @YL026YA 57890800
         STH   R2,CATWORK2         STORE IN FIRST HALFWORD     @YL026YA 57891600
*                                  OF AREA                     @YL026YA 57892400
         B     LOCBUILD            GO FINISH SETTING UP LOCATE @YL026YA 57893200
GOVSAM   EQU   *                                               @YL026YA 57894000
         L     R15,VSAMVCON        ADDRESS OF VSAM ROUTINE     @YL026YA 57894800
         BALR  R14,R15             GO PROCESS THE DATA SET     @YL026YA 57895600
         B     ENDBASIC            GO CHECK FOR HISTORY, ETC.  @YL026YA 57896400
         EJECT                                                 @YL026YA 57897200
IKJEHVSM CSECT                                                 @YL026YA 57898000
*                                                              @YL026YA 57898800
*  THIS ROUTINE IS ENTERED IF THE DATA SET NAME OCCURS IN      @YL026YA 57899600
*  THE CATALOG AND IS NOT A NONVSAM DATA SET.  A HEADING IS    @YL026YA 57900400
*  PUT TO THE TERMINAL AND THE BUFFER IS FILLED WITH BASIC     @YL026YA 57901200
*  INFORMATION.  IF THE HISTORY AND/OR STATUS OPTION IS        @YL026YA 57902000
*  SPECIFIED, THE HEADING INCLUDES THE APPROPRIATE TITLES.     @YL026YA 57902800
*  HISTORY INFORMATION IS PUT TO THE TERMINAL ALONG WITH       @YL026YA 57903600
*  THE BASIC INFORMATION.                                      @YL026YA 57904400
*                                                              @YL026YA 57905200
VSAMROUT SAVE  (14,12),,*                                      @YL026YA 57906000
         LR    R10,R15             SET UP ADDESSABILITY TO THIS ROUTINE 57906800
         USING VSAMROUT,R10        MAIN BASE FOR THIS ROUTINE  @YL026YA 57907600
         USING OBTWAD,R12          WORK AREA, R12 PASSED WITH ADDR      57908400
         GETMAIN R,LV=SAVELEN1,SP=WORKSP  GET A SAVE AREA      @ZA06146 57909203
         ST    R13,D4(R1)          SAVE CALLERS SAVE AREA      @YL026YA 57910000
         ST    R1,D8(R13)          SAVE THIS ROUTINES SAVE AREA ADDR    57910800
         LR    R13,R1              THIS ROUTINES SAVE AREA ADDRESS      57911600
*  WRITE THE HEADING LINE                                      @YL026YA 57912400
         LA    R7,OUTBUF           POINT TO OUTPUT BUFFER      @YL026YA 57913200
         MVC   D0(L'VSAMHDG,R7),VSAMHDG  MOVE BASIC HEADING    @YL026YA 57914000
         LA    R7,L'VSAMHDG(R7)    POINT PAST BASIC HEADING    @YL026YA 57914800
         TM    CONTROL,HISTORY     WAS HISTORY REQUESTED?      @YL026YA 57915600
         BNO   VSAM10              NO--SKIP HISTORY HEADING    @YL026YA 57916400
         MVC   D0(L'VSAMHHDG,R7),VSAMHHDG  MOVE HISTORY HEAD   @YL026YA 57917200
         LA    R7,L'VSAMHHDG(R7)   POINT PAST HISTORY HEADING  @YL026YA 57918000
VSAM10   EQU   *                                               @YL026YA 57918800
         TM    CONTROL,STATUS      WAS STATUS REQUESTED?       @YL026YA 57919600
         BNO   VSAM15              NO--SKIP STATUS HEADING     @YL026YA 57920400
         MVC   D0(L'VSAMSHDG,R7),VSAMSHDG  MOVE STATUS HEAD    @YL026YA 57921200
         LA    R7,L'VSAMSHDG(R7)   POINT PAST STATUS HEADING   @YL026YA 57922000
VSAM15   EQU   *                                               @YL026YA 57922800
         LR    R14,R7              POINT AT END OF BUFFER DATA @YL026YA 57923600
         LA    R7,OUTBUF           POINT AT BUFFER             @YL026YA 57924400
         L     R15,VCONVWRT        ADDRESS OF WRITE ROUTINE    @YL026YA 57925200
         BALR  R8,R15              WRITE HEADING LINE          @YL026YA 57926000
*  MOVE LRECL AND ENTRY TYPE TO BUFFER                         @YL026YA 57926800
         USING CTGFL,R3                                        @YL026YA 57927600
         LA    R3,CTGFL4           GET FPL FOR LRECL           @YL026YA 57928400
         L     R3,CTGFLPT          ADDRESS OF LRECL VALUE      @YL026YA 57929200
         TM    0(R3),X'FF'         CHECK FOR FOXES IN LRECL VALUE       57930000
         BO    VSAM30              YES, INDICATE WITH  **      @YL026YB 57930800
         L     R1,D0(R3)           LRECL VALUE                 @YL026YA 57931600
         N     R1,OFFSIGN          TURN OFF ANY NEGATIVE SIGN  @YL026YA 57932400
         LTR   R1,R1               CHECK FOR ZERO VALUE        @YL026YA 57933200
         BZ    VSAM30              IF ZERO, INDICATE WITH **   @YL026YA 57934000
         CVD   R1,WORKROOM         CONVERT TO NUMBERS          @YL026YA 57934800
         UNPK  LRECLOF1(D5,R7),WORKROOM(D8)                    @YL026YA 57935600
         OI    LRECLOF1+D4(R7),ZONE  GET RID OF SIGN           @YL026YA 57936400
VSAM20   EQU   *                                               @YL026YA 57937200
         CLI   LRECLOF1(R7),ZONE   ARE THERE HIGHORDER ZEROS?  @YL026YA 57938000
         BNE   VSAM40              NO - VALUE OK AS IS         @YL026YA 57938800
         MVC   LRECLOF1(L5,R7),LRECLOF1+D1(R7) SHIFT NUMBER    @YL026YA 57939600
         B     VSAM20              REPEAT ZERO TEST            @YL026YA 57940400
VSAM30   EQU   *                   NO LRECL VALUE              @YL026YA 57941200
         MVC   LRECLOF1(L'NOVAL,R7),NOVAL  UNDEFINED VALUE     @YL026YA 57942000
         B     VSAM50              BRANCH TO GET DATES          ZA02196 57942402
VSAM40   EQU   *                                               @YL026YA 57942800
         MVC   TYPEOFF(L4,R7),VSAMCON   MOVE IN CONSTANT VSAM   ZA02196 57943602
VSAM50   EQU   *                                               @YL026YA 57974800
         TM    CONTROL,HISTORY     HISTORY                     @ZA06146 57975603
         BNO   VSAM60              NO                          @ZA06146 57975703
         LA    R3,CTGFL7           GET CREATION DATE FPL       @YL026YA 57975803
         L     R3,CTGFLPT          GET ADDRESS OF CREATE DATE  @YL026YA 57975903
         XC    WRKCREDT(L3),WRKCREDT    ZERO CREATE COMM AREA  @ZA07714 57976003
         TM    1(R3),FOXES              IS CREATE DATE FOXES?  @ZA07714 57976103
         BO    VSAM55                   YES CHECK EXPIRE DATE  @ZA07714 57976203
         XC    SAVELEN(L8,R13),SAVELEN(R13) ZERO WORK AREA     @ZA06146 57976303
         MVC   SAVELEN+6(L2,R13),D1(R3) MOVE IN JULIAN DATE    @ZA06146 57976403
         CVB   R1,SAVELEN(R13)          CONVERT TO BINARY      @ZA06146 57976503
         STH   R1,WRKCREDT+D1           STORE IN COMM AREA      ZA00105 57976603
         XC    SAVELEN(L8,R13),SAVELEN(R13) ZERO WORK AREA     @ZA06146 57976803
         LH    R1,D0(R3)                LOAD YYDD INTO REG      ZA00105 57977003
         IC    R1,OFFSIGN+D1            MASK DD WITH 'FF'       ZA00105 57977203
         SRL   R1,L4                    SHIFT TO YYF            ZA00105 57977403
         ST    R1,SAVELEN+4(R13)        STORE IN WORK AREA     @ZA06146 57977603
         CVB   R1,SAVELEN(R13)          CONVERT DEC TO BIN     @ZA06146 57977803
         STC   R1,WRKCREDT              STORE YY IN COMM AREA   ZA00105 57978202
VSAM55   LA    R3,CTGFL8           GET EXPIRATION DATE FPL     @ZA07714 57978303
         L     R3,CTGFLPT          GET ADDRESS OF EXPIRE DATE  @YL026YA 57978403
         XC    WRKEXPDT(L3),WRKEXPDT    ZERO EXPIRE DATE       @ZA07714 57978503
         TM    1(R3),FOXES              IS EXPIRE DATE FOXES?  @ZA07714 57978603
         BO    VSAM60                   YES LEAVE ZEROS IN DATE@ZA07714 57978703
         XC    SAVELEN(L8,R13),SAVELEN(R13) ZERO WORK AREA     @ZA06146 57978803
         MVC   SAVELEN+6(L2,R13),D1(R3) MOVE IN JULIAN DATE    @ZA06146 57978903
         CVB   R1,SAVELEN(R13)          CONVT TO BINARY        @ZA06146 57979003
         STH   R1,WRKEXPDT+D1           STORE IN COMM AREA      ZA00105 57979103
         XC    SAVELEN(L8,R13),SAVELEN(R13) ZERO WORK AREA     @ZA06146 57979203
         LH    R1,D0(R3)                LOAD YYDD INTO REG      ZA00105 57979303
         IC    R1,OFFSIGN+D1            MASK DD WITH 'FF'       ZA00105 57979503
         SRL   R1,L4                    SHIFT TO YYF            ZA00105 57979803
         ST    R1,SAVELEN+4(R13)        STORE IN WORK AREA     @ZA06146 57980103
         CVB   R1,SAVELEN(R13)          CONVRT TO BINARY       @ZA06146 57980403
         STC   R1,WRKEXPDT              STORE YY IN COMM AREA   ZA00105 57980703
VSAM60   LR    R1,R13              SAVE DYNAMIC AREA ADDRESS   @ZA06146 57981003
         L     R13,D4(R1)          CALLERS SAVEAREA            @YL026YA 57981303
         FREEMAIN R,LV=SAVELEN1,A=(1),SP=WORKSP FREE SAVE AREA @ZA06146 57981603
         RETURN (14,12)            RETURN TO CALLER            @YL026YA 57982800
         EJECT                                                 @YL026YA 57983600
*  CONSTANTS AND EQUATES FOR VSAM BASIC INFO                   @YL026YA 57984400
VCONVWRT DC    V(IKJEHWRT)         ADDRESS OF WRITE ROUTINE    @YL026YA 57985200
OFFSIGN  DC    X'7FFFFFFF'         TO TURN OFF MINUS BIT       @YL026YA 57986000
VSAMHDG  DC    C'--LRECL--DSORG-'  BASIC DATA HEADING           ZA02196 57986802
VSAMHHDG DC    C'-CREATED---EXPIRES' HISTORY DATA HEADING      @YL026YA 57987600
VSAMSHDG DC    C'--DDNAME---DISP'  STATUS DATA HEADING         @YL026YA 57988400
NOVAL    DC    C'**'               REPLACES UNDEFINED VALUES   @YL026YA 57989200
VSAMCON  DC    C'VSAM'             CONSTANT FOR VSAM ENTRY      ZA02196 57990002
DWORD    DS    D                        DOUBLE WORD WORK AREA   ZA00105 57996802
*                                                              @YL026YA 57997200
TYPEOFF  EQU   9                   OFFSET TO TYPE CODE         @YL026YA 57998000
LRECLOF1 EQU   2                   OFFSET TO LRECL FOR VSAM    @YL026YA 57998800
         DROP  R3                                              @YL026YA 57999600
         DROP  R10                                             @YL026YA 58000400
         EJECT                                                          58001200
IKJEHSTA CSECT                                                          58002000
         ENTRY IKJEHSTI                                        @YL026YA 58002800
*********************************************************************** 58020020
*                                                                     * 58050020
*   THIS ROUTINE IS ENTERED IF STATUS IS SPECIFIED ON THE COMMAND     * 58080020
*   WHEN IT IS ENTERED.  THE DYNAMIC ALLOCATION REQUEST BLOCK  @YL026YA 58110000
*   HAS ALREADY BEEN INITIALIZED BY THE STATUS INITIALIZATION  @YL026YA 58130000
*   ROUTINE (IKJEHSTI).                                        @YL026YA 58150000
*   DYNAMIC INFORMATION RETRIEVAL IS CALLED TO OBTAIN          @YL026YA 58170000
*   INFORMATION ABOUT THE ALLOCATED DATA SET.                  @YL026YA 58190000
*   THE APPROPRIATE INFORMATION (DDNAME, NORMAL AND ABNORMAL DISP)    * 58210000
*   ARE EXTRACTED AND FORMATTED IN THE BUFFER.  IF DYNAMIC     @YL026YA 58230000
*   INFORMATION RETRIEVAL FAILS, THEN NO STATUS IS AVAILABLE   @YL026YA 58250000
*   FOR THIS DSNAME.                                           @YL026YA 58270000
*                                                                     * 58350020
*********************************************************************** 58380020
*                                                                       58410020
STATROUT SAVE  (14,12),,*                                               58440020
         LR    R10,R15             SET UP ADDESSABILITY TO THIS ROUTINE 58470000
         USING STATROUT,R10        MAIN BASE FOR THIS ROUTINE           58480000
         USING OBTWAD,R12          WORK AREA, R12 PASSED WITH ADDR      58490000
         GETMAIN R,LV=SAVELEN,SP=WORKSP  GET A SAVE AREA                58500000
         ST    R13,D4(R1)          SAVE CALLERS SAVE AREA               58510000
         ST    R1,D8(R13)          SAVE THIS ROUTINES SAVE AREA ADDR    58520000
         LR    R13,R1              THIS ROUTINES SAVE AREA ADDRESS      58530000
*                                                              @YL026YA 58540000
*   PUT DATA SET NAME AND LENGTH IN DYNAMIC ALLOCATION         @YL026YA 58550000
*   PARAMETER LIST AND RETRIEVE INFORMATION.                   @YL026YA 58560000
*                                                              @YL026YA 58570000
         LA    R1,RQBLKAD          ADDRESS OF REQUEST BLOCK    @YL026YA 58580000
*                                  POINTER                     @YL026YA 58590000
         USING S99RBP,R1                                       @YL026YA 58600000
         L     R2,S99RBPTR         ADDRESS OF REQUEST BLOCK    @YL026YA 58610000
         USING S99RB,R2                                        @YL026YA 58620000
         L     R2,S99TXTPP         ADDRESS OF TEXT POINTER     @YL026YA 58630000
*                                  LIST                        @YL026YA 58640000
         USING S99TUPL,R2                                      @YL026YA 58650000
         L     R5,S99TUPTR         ADDRESS OF FIRST TEXT UNIT  @YL026YA 58660000
*                                  POINTER                     @YL026YA 58670000
         USING S99TUNIT,R5                                     @YL026YA 58680000
         LH    R4,CURNTNAM         LENGTH OF DSNAME            @YL026YA 58690000
         STH   R4,S99TULNG         STORE IN PARAMETER LENGTH   @YL026YA 58700000
*                                  FIELD                       @YL026YA 58710000
         LA    R3,TEMPNAME         ADDRESS OF CURRENT DSNAME   @YL026YA 58720000
         LA    R7,S99TUPAR         ADDRESS OF PARAMETER FIELD  @YL026YA 58730000
         BCTR  R4,R0               DECREMENT LENGTH FOR MOVE   @YL026YA 58740000
         EX    R4,MOVE             MOVE DSNAME                 @YL026YA 58750000
         DYNALLOC                                              @YL026YA 58760000
         LTR   R15,R15             DID RETRIEVE GO OK?         @YL026YA 58770000
         BNZ   STATRT05            NO - EXIT WITH NO INFO      @YL026YA 58780000
*                                                                       59100020
*    WE HAVE A HIT--MOVE DDNAME AND DISP FIELDS TO BUFFER AND OUTPUT    59130020
*                                                                       59160020
         CLI   DSTYPE,CTGTALIN     CHECK FOR VSAM                       59190000
         BNE   VSAMOFF             YES                                  59200000
         LA    R7,OUTBUF+STATOFF1  POINT AT OFFSET FOR STATUS ALONE     59210000
         TM    CONTROL,HISTORY     SEE IF HISTORY WAS SPECIFIED         59220000
         BNO   STATRT01            NO USE AS IS                         59230000
         LA    R7,OUTBUF+STATOFF2  YES, POINT TO NEW OFFSET    @YL026YA 59240000
STATRT01 EQU   *                                                        59250000
         LA    R2,L'S99TUPTR(R2)   LOOK AT NEXT TEXT UNIT      @YL026YA 59260000
         L     R5,S99TUPTR         ADDRESS OF TEXT UNIT        @YL026YB 59270000
         LH    R4,S99TULNG         LENGTH OF PARAMETER         @YL026YA 59280000
         LTR   R4,R4               IS LENGTH GT ZERO           @ZA06703 59282003
         BZ    STANODDN            NO, DON'T PROCESS DDNAME    @ZA06703 59284003
         BCTR  R4,R0               DECREMENT FOR MOVE          @YL026YA 59290000
         EX    R4,STATMOVE         MOVE DDNAME TO BUFFER       @YL026YA 59300000
STANODDN EQU   *                                               @ZA06703 59302003
         LA    R2,L'S99TUPTR(R2)   LOOK AT NEXT TEXT UNIT      @YL026YA 59310000
         L     R5,S99TUPTR         ADDRESS OF TEXT UNIT        @YL026YB 59320000
         LA    R7,D9(R7)           BUMP OUTPUT BUFFER PTR               59330000
*                                                                       59370020
*   TEST STATUS BITS AND MOVE IN APPROPRIATE WORD                       59400020
*                                                                       59430020
         TM    S99TUPAR,KEEP       IS IT KEEP                  @YL026YA 59460000
         BO    STATKEEP            YES, BRANCH                          59480000
         TM    S99TUPAR,DELETE     IS IT DELETE                @YL026YA 59500000
         BO    STATDELE            YES, BRANCH                 @YL026YA 59520000
         TM    S99TUPAR,CATLG      IS IT CATALOG               @YL026YA 59540000
         BO    STATCATL            YES BRANCH                  @YL026YA 59560000
         TM    S99TUPAR,UNCATLG    IS IT UNCATLG               @YL026YA 59580000
         BO    STATUNCT            YES, BRANCH                 @YL026YA 59600000
         B     STATRT03            IF UNSPECIFIED, SKIP TO NEXT ROUTINE 59620000
VSAMOFF  LA    R7,OUTBUF+L16       OFFSET INTO BUFFER                   59640000
         TM    CONTROL,HISTORY     HISTORY REQUESTED                    59660000
         BNO   STATRT01            NO                                   59680000
         LA    R7,OUTBUF+L34       OFFSET FOR HISTORY                   59700000
         B     STATRT01                                                 59720000
STATKEEP LA    R14,SKEEP           ADDRESS OF 'KEEP'                    59740000
         LA    R15,L'SKEEP         ITS LENGTH                           59760000
         B     STATRT02            PUT IT INTO BUFFER                   59780000
*                                                                       59800000
STATDELE LA    R14,SDELE           ADDRESS OF 'DELETE'                  59820000
         LA    R15,L'SDELE         ITS LENGTH                           59840000
         B     STATRT02            PUT IT IN BUFFER                     59860000
*                                                                       59880000
STATCATL LA    R14,SCATL           ADDRESS OF 'CATLG'                   59900000
         LA    R15,L'SCATL         ITS LENGTH                           59920000
         B     STATRT02            PUT IT INTO THE BUFFER               59940000
*                                                                       59960000
STATUNCT LA    R14,SUNCT           ADDRESS OF 'UNCATLG'                 59980000
         LA    R15,L'SUNCT         ITS LENGTH                           60000000
*                                                                       60150020
*  MOVE CORRECT FIELD TO THE BUFFER                                     60180020
*                                                                       60210020
STATRT02 EQU   *                                                        60240020
         BCTR  R15,R0              DECREMENT COUNT BY ONE               60300000
         EX    R15,DISPMOVE        MOVE DISP TO BUFFER                  60330000
         LA    R7,L1(R15,R7)       POINT AT NEXT LOCATION               60360000
*                                                                       60390020
*   TEST FOR ABNORMAL DISPOSITION                                       60420020
*                                                                       60450020
STATRT03 EQU   *                                                        60480020
         LA    R2,L'S99TUPTR(R2)   LOOK AT NEXT TEXT UNIT      @YL026YA 60510000
         L     R5,S99TUPTR         ADDRESS OF TEXT UNIT        @YL026YB 60530000
         TM    S99TUPAR,KEEP       IS IT KEEP                  @YL026YA 60550000
         BO    STKEEP              YES, BRANCH                          60570000
         TM    S99TUPAR,DELETE     IS IT DELETE                @YL026YA 60590000
         BO    STDELE              YES, BRANCH                          60610000
         TM    S99TUPAR,CATLG      IS IT CATALOG               @YL026YA 60630000
         BO    STCATL              YES, BRANCH                          60650000
         TM    S99TUPAR,UNCATLG    IS IT UNCATALOG             @YL026YA 60670000
         BO    STUNCT              YES, BRANCH                          60690000
         B     STATRT05            IF UNSPECIFIED, SKIP IT              60710000
*                                                                       60730000
STKEEP   LA    R14,SKEEP           ADDRESS OF 'KEEP'                    60750000
         LA    R15,L'SKEEP         LENGTH OF KEEP                       60770000
         B     STATRT04            GO PUT IT INTO BUFFER                60790000
*                                                                       60810000
STDELE   LA    R14,SDELE           ADDRESS OF 'DELETE'                  60830000
         LA    R15,L'SDELE         LENGTH OF DELETE                     60850000
         B     STATRT04            GO PUT INTO BUFFER                   60870000
*                                                                       60890000
STCATL   LA    R14,SCATL           ADDRESS OF 'CATLG'                   60910000
         LA    R15,L'SCATL         LENGTH OF CATLG                      60930000
         B     STATRT04            PUT IT INTO BUFFER                   60950000
*                                                                       60970000
STUNCT   LA    R14,SUNCT           ADDRESS OF 'UNCATLG'                 60990000
         LA    R15,L'SUNCT         ITS LENGTH                           61010000
*                                                                       61230020
*   MOVE THE CORRECT FIELD TO THE BUFFER                                61260020
*                                                                       61290020
STATRT04 EQU   *                                                        61320020
         MVI   D0(R7),COMMA        PUT A COMMA SEPARATOR IN BUFFER      61350000
         LA    R7,L1(R7)           BUMP POINTER FOR LENGTH OF COMMA     61380000
         BCTR  R15,R0              DECREMENT COUNT FOR MOVE             61410000
         EX    R15,DISPMOVE        MOVE DISP TO BUFFER                  61440000
*                                                                       61470000
STATRT05 EQU   *                                                        61500000
         LR    R1,R13              SAVE ADDRESS OF CORE TO FREE         61530000
         L     R13,D4(R1)          USERS SAVEAREA                       61560000
         FREEMAIN R,LV=SAVELEN,A=(1),SP=WORKSP                          61590020
         RETURN (14,12)                                                 61620020
*                                                                       61650020
*    EQUATES AND CONSTANTS USED BY STATUS                               61680020
*                                                                       61710020
KEEP     EQU   X'08'               KEEP DISP MASK                       61740000
DELETE   EQU   X'04'               DELETE MASK                          61744000
CATLG    EQU   X'02'               CATALOG MASK                         61748000
UNCATLG  EQU   X'01'               UNCATALOG                            61752000
SKEEP    DC    C'KEEP'             KEEP                                 61756000
SDELE    DC    C'DELETE'           DELETE                               61760000
SCATL    DC    C'CATLG'            CATALOG                              61764000
SUNCT    DC    C'UNCATLG'          UNCATALOG                            61768000
         DS    0H                  ALIGN HALF WORD                      61772000
DISPMOVE MVC   D0(L0,R7),D0(R14)   EXECUTED TO MOVE DISP                61776000
STATMOVE MVC   D0(,R7),S99TUPAR    MOVE DDNAME TO BUFFER       @YL026YA 61780000
*                                                                       61784000
         DROP  R2                                              @YL026YA 61788000
         DROP  R10                                             @YL026YA 61792000
         DROP  R5                                                       61796000
         EJECT                                                 @YL026YA 61800000
IKJEHSTI DS    0H                                              @YL026YA 61804000
*********************************************************************   61808000
*                                                              @YL026YA 61812000
*   THIS ROUTINE IS ENTERED VIA BAL R8 IF THE STATUS KEYWORD   @YL026YA 61816000
*   IS SPECIFIED ON THE COMMAND.                               @YL026YA 61820000
*   IT INITIALIZES THE PARAMETER LIST FOR DYNAMIC INFORMATION  @YL026YA 61824000
*   RETRIEVAL, WHICH WILL BE USED LATER TO RETRIEVE STATUS     @YL026YA 61828000
*   INFORMATION ABOUT SPECIFIC DATA SETS.                      @YL026YA 61832000
*                                                              @YL026YA 61836000
**********************************************************************  61840000
*  INITIALIZE THE REQUEST BLOCK                                @YL026YA 61844000
         XC    DAREQBLK(DABLKLN),DAREQBLK                      @YL026YA 61848000
*                                  CLEAR REQUEST BLOCK AREA    @YL026YA 61852000
         MVI   DARBLEN,DABLKLN     SET LENGTH OF BLOCK         @YL026YA 61856000
         MVI   DAVRBCD,S99VRBIN    SET VERBCODE FOR INFOR-     @YL026YA 61860000
*                                  MATION RETRIEVAL            @YL026YA 61864000
         LA    R3,TXTPTRS          GET ADDRESS OF TEXT PTRS    @YL026YA 61868000
         USING S99TUPL,R3                                      @YL026YA 61872000
         ST    R3,DATXTPT          SET ADDRESS OF TEXT POINTERS         61876000
         USING S99TUNIT,R2                                     @YL026YA 61880000
*   INITIALIZE DSNAME TEXT UNIT                                @YL026YA 61884000
         XC    TU1DSN(TU1LNGTH),TU1DSN CLEAR TEXT UNIT         @YL026YA 61888000
         LA    R2,TU1DSN           ADDRESS OF TEXT UNIT        @YL026YA 61892000
         ST    R2,S99TUPTR         TO TEXT POINTER             @YL026YA 61896000
         LA    R3,D4(R3)           MOVE TO NEXT TEXT POINTER   @YL026YA 61900000
         MVI   S99TUKEY+D1,DSNKEY  KEY TO RETRIEVE DSNAME      @YL026YA 61904000
         MVI   S99TUNUM+D1,L1      ONE PARAMETER               @YL026YA 61908000
*   INITIALIZE DDNAME TEXT UNIT                                @YL026YA 61912000
         XC    TU2DDN(TU2LNGTH),TU2DDN CLEAR TEXT UNIT         @YL026YA 61916000
         LA    R2,TU2DDN           ADDRESS OF TEXT UNIT        @YL026YA 61920000
         ST    R2,S99TUPTR         TO TEXT POINTER             @YL026YA 61924000
         LA    R3,D4(R3)           MOVE TO NEXT TEXT POINTER   @YL026YA 61928000
         MVI   S99TUKEY+D1,DDNKEY  KEY TO RETRIEVE DDNAME      @YL026YA 61932000
         MVI   S99TUNUM+D1,L1      ONE PARAMETER               @YL026YA 61936000
         MVI   S99TULNG+D1,L'TU2NAM LENGTH OF DDNAME FIELD     @YL026YA 61940000
*   INITIALIZE STATUS TEXT UNIT                                @YL026YA 61944000
         XC    TU3STAT(TU3LNGTH),TU3STAT CLEAR TEXT UNIT       @YL026YA 61948000
         LA    R2,TU3STAT          ADDRESS OF TEXT UNIT        @YL026YA 61952000
         ST    R2,S99TUPTR         TO TEXT POINTER             @YL026YA 61956000
         LA    R3,D4(R3)           MOVE TO NEXT TEXT POINTER   @YL026YA 61960000
         MVI   S99TUKEY+D1,STATKEY KEY TO RETRIEVE STATUS      @YL026YA 61964000
         MVI   S99TUNUM+D1,L1      ONE PARAMETER               @YL026YA 61968000
         MVI   S99TULNG+D1,L1      FIELD LENGTH IS ONE BYTE    @YL026YA 61972000
*   INITIALIZE NORMAL DISPOSITION TEXT UNIT                    @YL026YA 61976000
         XC    TU4DSPN(TU4LNGTH),TU4DSPN CLEAR TEXT UNIT       @YL026YA 61980000
         LA    R2,TU4DSPN          ADDRESS OF TEXT UNIT        @YL026YA 61984000
         ST    R2,S99TUPTR         TO TEXT POINTER             @YL026YA 61988000
         LA    R3,D4(R3)           MOVE TO NEXT TEXT POINTER   @YL026YA 61992000
         MVI   S99TUKEY+D1,NDSPKEY KEY TO RETRIEVE NORM DISP   @YL026YA 61996000
         MVI   S99TUNUM+D1,L1      ONE PARAMETER               @YL026YA 62000000
         MVI   S99TULNG+D1,L1      FIELD LENGTH IS ONE BYTE    @YL026YA 62004000
*   INITIALIZE CONDITIONAL DISPOSITION TEXT UNIT               @YL026YA 62008000
         XC    TU5DSPC(TU5LNGTH),TU5DSPC CLEAR TEXT UNIT       @YL026YA 62012000
         LA    R2,TU5DSPC          ADDRESS OF TEXT UNIT        @YL026YA 62016000
         ST    R2,S99TUPTR         TO TEXT POINTER             @YL026YA 62020000
         OI    S99TUPTR,S99TUPLN   INDICATE LAST TEXT UNIT     @YL026YA 62024000
         MVI   S99TUKEY+D1,CDSPKEY KEY TO RETRIEVE COND DISP   @YL026YA 62028000
         MVI   S99TUNUM+D1,L1      ONE PARAMETER               @YL026YA 62032000
         MVI   S99TULNG+D1,L1      FIELD LENGTH IS ONE BYTE    @YL026YA 62036000
*   POINT TO REQUEST BLOCK                                     @YL026YA 62040000
         LA    R2,DAREQBLK         ADDRESS OF REQUEST BLOCK    @YL026YA 62044000
         ST    R2,RQBLKAD          TO PARAMETER LIST POINTER   @YL026YA 62048000
         OI    RQBLKAD,S99RBPND    TURN HIGH-ORDER BIT ON      @YL026YA 62052000
         DROP  R2                                              @YL026YA 62056000
         DROP  R3                                              @YL026YA 62060000
         BR    R8                                                       62064000
         EJECT                                                          62068000
IKJEHMBR CSECT                                                 @YL026YA 62072000
*********************************************************************** 62076000
*                                                              @YL026YA 62080000
*   THIS ROUTINE CHECKS FOR DSNAME BEING A MEMBER NAME, CHECKS @YL026YA 62084000
*   TO SEE IF LABEL WAS SPECIFIED, AND CHECKS TO SEE IF THE    @YL026YA 62088000
*   MEMBERS OPTION WAS SPECIFIED.  IKJEHMBR IS ENTERED FROM    @YL026YA 62092000
*   THE MAINLINE PROCESSING ROUTINE VIA BALR 14,15.            @YL026YA 62096000
*                                                              @YL026YA 62100000
*********************************************************************** 62104000
MEMCHK   SAVE  (14,12),,*                                      @YL026YA 62108000
         LR    R10,R15             SET UP ADDESSABILITY TO THIS ROUTINE 62112000
         USING MEMCHK,R10          MAIN BASE FOR THIS ROUTINE  @YL026YA 62116000
         USING OBTWAD,R12          WORK AREA, R12 PASSED WITH ADDR      62120000
         GETMAIN R,LV=SAVELEN,SP=WORKSP  GET A SAVE AREA       @YL026YA 62124000
         ST    R13,D4(R1)          SAVE CALLERS SAVE AREA      @YL026YA 62128000
         ST    R1,D8(R13)          SAVE THIS ROUTINES SAVE AREA ADDR    62132000
         LR    R13,R1              THIS ROUTINES SAVE AREA ADDRESS      62136000
*                                                              @YL026YA 62140000
         TM    CONTROL,MEMNAME     IS DSNAME   A MEMBERNAME    @YL026YA 62144000
         BNO   LABELCHK            NO, GO CHECK LABEL KEYWORD  @YL026YA 62148000
         BAL   R8,MNAMROUT         LIST MEMBER DIRECTORY INFORMATION    62152000
LABELCHK TM    CONTROL,LABEL       SEE IF LABEL KEYWORD WAS SPECIFIED   62156000
         BNO   MEMBCHK             CHECK FOR MEMBERS KEYWORD   @YL026YA 62160000
         L     R15,VCONLBL         GET ADDR OF LABEL PROCESSING ROUTINE 62164000
         BALR  R14,R15             GO                          @YL026YA 62168000
MEMBCHK  EQU   *                                               @YL026YA 62172000
         TM    CONTROL,MEMBERS     WAS MEMBERS SPECIFIED       @YL026YA 62176000
         BNO   MEMEND              NO GO TEST FOR MORE NAMES IN LIST    62180000
         BAL   R8,MEMROUT          GO LIST PDS DIRECTORY       @YL026YA 62184000
MEMEND   LR    R1,R13                                                   62188000
         L     R13,D4(R1)          SAVE AREA ADDRESS           @YL026YB 62192000
         RETURN (14,12)            RETURN TO PROCESS MORE NAMES         62196000
         EJECT                                                 @YL026YA 62200000
MEMROUT  DS    0H                                                       62220020
*********************************************************************** 62250020
*                                                                       62280020
*     THIS ROUTINE GETS CONTROL IF THE MEMBERS KEYWORD WAS SPECIFIED.   62310020
*     IT CHECKS DSORG FOR PARTITIONED DATASET AND IF PARRTITIONED       62340020
*     SETS UP LINKAGE TO IKJEHMEM WHICH WILL LIST OUT THE DIRECTORY.    62370020
*                                                                       62400020
*********************************************************************** 62430020
         TM    DSORGSV,PO          IS DS PO                             62460000
         BCR   CONDZERO,R8         NO, RETURN TO MAINLINE               62480000
         LA    R7,OUTBUF           SETUP TO                             62500000
         LR    R6,R8               SAVE RETURN ADDRESS                  62520000
         MVC   D0(L'MEMHDG,R7),MEMHDG  MOVE HEADING TO BUFFER           62540000
         LA    R14,L'MEMHDG(R7)                                         62560000
         L     R15,VCONWRIT        GET ADDRESS OF WRITE ROUTINE         62580000
         BALR  R8,R15              GO WRITE BUFFER             @YL026YA 62600000
         TM    CONTROL,JFCB        SEE IF JFCB WAS READ                 62620000
         BO    MEMLINK             IF YES, GO LINK TO IKJEHMEM          62640000
         TM    ALLOCSW,ON          ALLOC OK                             62660000
         BO    DCODE00             YES JUST DO RDJFCB                   62680000
         L     R15,VCONALC         ADDRESS OF ALLOCATE ROUTINE @YL026YA 62700000
         BALR  R8,R15              GO ALLOCATE DATA SET        @YL026YA 62720000
         TM    ALLOCSW,ON          ALLOCATE OKAY                        62740000
         BO    DCODE00             YES DO RDJFCB                        62760000
         B     MEMEND              NO GET NEXT DSNAME          @YL026YA 62780000
*                                                                       62814020
*                                                                       63510020
DCODE00  EQU   *                                                        63540020
         LA    R2,OBTDCB                                                63600020
         LA    R3,DAIRLIST         ADDRESS OF DAIR LIST                 63630000
         USING DAPB08,R3           DAIR 08  ENTRY DSECT ADDRESSABILITY  63660000
         USING IHADCB,R2                                                63690020
         MVC   DCBDDNAM(DDNAMLEN),DA08DDN PUT DDNAME IN DCB             63720020
         DROP  R3                                                       63750020
         LA    R1,RDJL                                                  63780020
         LA    R3,OBTDCB                                                63810020
         RDJFCB ((R3)),MF=(E,(R1))                                      63840020
         DROP  R2                                                       63870020
         OI    CONTROL,JFCB        INDICATE RDJFCB WAS ISSUED           63900000
MEMLINK  EQU   *                                                        63930020
         L     R15,MEMMOD                                               63960020
         LA    R1,CALLIST                                               63990020
         CALL  (15),((R12),GETML,OUTBUF,WRITE,FREEML),VL,MF=(E,(1))     64020020
         B     MEMCODE(R15)        ANALYZE IKJEHMEM RETURN CODE         64050000
MEMCODE  B     MEMCDE00            SUCCESS                              64080000
         B     MEMCDE04            INSUFFICIENT CORE                    64110000
         B     MEMCDE08            I/O ERROR                            64140000
* THIS IS RC=12, MEMCDE12 MUST FOLLOW                            100000 64170021
MEMCDE12 EQU   *                                                        64470020
         MVI   ERR2,SECMSG04       SECOND LEVEL MESSAGE 4               64500020
MEMERROR EQU   *                                                        64530020
MEMSYN   EQU   *                                                        64570020
         MVI   ERR1,MSG04          MEMBERS NOT AVAIL                    64650000
         L     R15,VCONERR         GET ADDRESS OF ERROR MSG    @YL026YA 64670000
         BALR  R8,R15              GO PUT OUT MESSAGE          @YL026YA 64690000
MEMCDE00 EQU   *                                                        64710000
         LR    R8,R6                                                    64730000
         BR    R8                  RETURN TO CALLER                     64750000
MEMCDE04 MVI   ERR2,SECMSG06       SECOND LEVEL MESSAGE 6        100000 64820021
         B     MEMERROR            GO PROCESS ERROR              100000 64822021
MEMCDE08 MVI   ERR2,SECMSG05       SECOND LEVEL MESSAGE 5        100000 64826021
         LA    R2,SYNMSG           POINTER TO SYNAD DATA-        100000 64828021
         ST    R2,ERRINST2         TO I/O PARM LIST              100000 64828421
         B     MEMSYN              FINISH UP MSG                 100000 64828821
         EJECT                                                          64830020
MNAMROUT EQU   *                                                        66630020
*********************************************************************** 66660020
*                                                                     * 66690020
*   THIS ROUTINE GETS CONTROL IF THE DSNAME SPECIFIED WAS A MEMBER    * 66720020
*   NAME.  A CHECK IS MADE TO SEE IF DSORG IS PO, AND IF NOT, A       * 66750020
*   DIAGNOSTIC IS PUT TO THE TERMINAL. THE JFCB CONTROL BIT IS CHECKED* 66780020
*   AND IF ON THE DDNAME IS ALREADY IN THE DCB. THE DSORG IS MADE PO. * 66810020
*   IF IT IS OFF, CONTROL IS PASSED TO DAIR TO ALLOCATE THE DATASET,  * 66840020
*   AND THE DDNAME IS TAKEN FROM THE RETURNED LIST.                   * 66870020
*                                                                       66900020
*********************************************************************** 66930020
         TM    DS1DSORG,PO         IS DATASET PARTITIONED               66960000
         BNO   MNAMERR             NO, PROCESS AS AN ERROR              66990000
         LA    R7,OUTBUF           SET UP                               67020000
         TM    CONTROL,JFCB        SEE IF RDJFCB WAS ISSUED             67050000
         BNO   MNAMDAIR            IF NOT, GOT ALLOCATE DATASET         67080000
         LA    R2,OBTDCB           ADDRESS THE DCB                      67110000
         USING IHADCB,R2                                                67140000
MNAMOPEN MVI   DCBDSORG,PO         SET DSORG FOR BPAM                   67170000
*********************************************************************** 67247020
**  THIS CODE PUT IN TO BYPASS OPEN PROBLEM OF CARRY FIELDS TO        * 67254020
**  NEXT USER OF JFCB                                                   67261020
*                                                                       67268020
         SR    R1,R1               CLEAR WORK REG                       67275020
         ST    R1,DCBEXLST         CLEAR EXIT LIST                      67282020
         STH   R1,DCBBLKSI         CLEAR BLOCK SIZE                     67289020
         STH   R1,DCBLRECL         CLEAR LRECL                          67296020
         STH   R1,DCBKEYLE         CLEAR KEYLENGTH                      67303020
*********************************************************************** 67310020
         DROP  R2                                                       67320020
         LA    R2,OBTDCB                                                67350020
         LA    R1,OPENL                                                 67380020
         OPEN  ((R2)),MF=(E,(1))                                        67410020
         XC    BLDLLIST(BLDLLEN),BLDLLIST    CLEAR BLDL LIST            67440020
         LA    R1,BLDL1            INITIALIZE LIST FOR BLDL.            67470000
         STH   R1,BLDLLIST         ONE ENTRY                            67500000
         LA    R1,BLDLMAX                                               67530000
         STH   R1,BLDLL            MAXIMUM LIST LENGTH                  67560000
        MVI   BLDLNME,BLANK        BLANK OUT MEMBERNAME FIELD           67590000
        MVC   BLDLNME+D1(L7),BLDLNME  MOVE IN NAME                      67620000
         LA    R7,BLDLNME          SET UP FOR MOVING MEMBERNAME         67650000
         L     R3,D8(R9)           POINT AT NAME                        67680000
         LH    R1,D12(R9)          GET LENGTH TO BE MOVED               67710000
         BCTR  R1,R0               DECREMENT FOR EX OF MVC              67740000
         EX    R1,MOVE             MOVE MEMBER NAME TO LIST             67770000
         BLDL  OBTDCB,BLDLLIST                                          67800000
         B     BLDLCODE(R15)       ANALYZE RETURN CODE                  67830000
BLDLCODE EQU   *                                                        67860000
         B     BLDLOK              RC=00  SUCCESS                       67890000
         B     BLDLERR1            RC=04  ENTRY NOT FOUND               67920000
*  THIS IS RC=08, BLDERR MUST FOLLOW                             100000 67950000
BLDLERR  EQU   *                                                        67980000
         LA    R1,SECMSG07         I/O ERROR IN BLDL                    68010000
BLDLERR2 STH   R1,ERRSECND         PUT IN LIST                          68040000
         MVI   ERR1,MSG05          DIR INFO NOT AVAIL                   68070000
         L     R15,VCONERR         GET ADDRESS OF ERR ROUTINE  @YL026YA 68100000
         BALR  R8,R15              GO PUT OUT MESSAGE          @YL026YA 68130000
         B     BLDLEXIT            GO TO CLOSE DCB                      68190020
BLDLERR1 LA    R1,SECMSG09         MEMBER NOT FOUND MSG          100000 68200021
         B     BLDLERR2            FINISH REST OF MSG            100000 68210021
*                                                                       68220020
*                                                                       68250020
****** GO TO ALLOCATE THE DATA SET HERE TO GET THE DDNAME **            68280020
*                                                                       68310020
MNAMDAIR EQU   *                                                        68340020
         BAL   R8,ALLOCDS          GO ALLOCATE DATA SET                 68370000
**********************************************************************  68375020
         TM    ALLOCSW,ON          ALLOCATE OKAY                        68380020
         BO    MNAMRC00            YES PUT DDNAME IN DCB                68385020
         B     LABELCHK            GO CHECK LABEL KEYWORD               68390020
**********************************************************************  68395020
MNAMRC00 EQU  *                                                         68970020
         LA    R3,DAIRLIST                                              69010020
         USING DAPB08,R3              OF DAIR MACRO MAP                 69030020
         LA    R2,OBTDCB                                                69060020
         USING IHADCB,R2                                                69090020
         MVC   DCBDDNAM(L'DA08DDN),DA08DDN  PUT DDNME IN                69120020
         DROP  R3                                                       69150020
         DROP  R2                                                       69180020
         B     MNAMOPEN            GO OPEN DCB                          69210000
MNAMERR  EQU   *                                                        69230000
         MVI   ERR1,MSG05          DIR INFO NOT AVAIL                   69250000
         MVI   ERR2,SECMSG08       DATA SET NOT PO                      69270000
         L     R15,VCONERR         GET ADDRESS OF ERR ROUTINE  @YL026YA 69290000
         BALR  R8,R15              GO PUT OUT MESSAGE          @YL026YA 69310000
         B     LABELCHK            GO CHECK FOR LABEL EKYWORD           69330000
BLDLOK   EQU   *                                                        69350000
         MVC   OUTBUF(L'MNAMHDG),MNAMHDG  MOVE HEADING TO BUFFER        69370000
         LA    R7,OUTBUF           POINT AT BUFFER                      69390000
         LA    R14,L'MNAMHDG(R7)   POINT AT END OF BUFFER               69410000
         L     R15,VCONWRIT        GET ADDR OF WRITE ROUTINE   @YL026YA 69430000
         BALR  R8,R15              GO WRITE BUFFER             @YL026YA 69450000
         MVC   D2(L8,R7),BLDLNME   MOVE MEMBERNAME TO BUFFER   @YL026YA 69470000
         LA    R7,OUTBUF+MNAMTTR   POINT TO BUFFER LOCATION             69490000
         LA    R4,BLDLTT           POINT AT TTR                @YL026YA 69510000
         LA    R5,D3                INDICATE LENGTH OF DATA TO CONVERT  69530000
         LR    R6,R10              SAVE BASE                   @VS06864 69550000
         L     R15,VCONBHEX        ADDRESS OF BITOHEX          @VS06864 69570000
         L     R10,VCONLBL         ADDRESSABILITY FOR BITOHEX  @VS06864 69590000
         BALR  R8,R15              GO                                   69610000
         LR    R10,R6              MAIN ADDRESSABILITY         @VS06864 69630000
         TM    BLDLCD,HIGHBIT      TEST FOR ALIAS NAME         @YL026YA 69650000
         BO    NOTTRUE             YES, BRANCH                          69670000
         MVC   OUTBUF+MNAMALI(L'NO),NO   NOT AN ALIAS                   69690000
BLDLNEX  EQU   *                                                        69710000
         NI    BLDLCD,NOHIBIT      TURN OFF ALIAS BIT                   69730000
         XR    R1,R1               CLEAR REG                            69750000
        IC    R1,BLDLCD            AND INSERT BYTE                      69770000
         SRL   R1,D5               SHIFT OUT UNNEEDED BITS              69790000
         STC   R1,OUTBUF+MNAMTTRN  PUT TTRN IN BUFFER                   69810000
         OI    OUTBUF+MNAMTTRN,ZONE  SET SIGN POSITIVE                  69830000
        NI    BLDLCD,ONEF          TURN OFF UNNEEDED BITS               69850000
         LA    R7,OUTBUF+MNAMCNT   POINT TO PROPER BUFFER POSITION      69870000
         LA    R4,BLDLCD           POINT AT DATA TO CONVERT             69890000
         LA    R5,DTACNT           DATA BYTE COUNT                      69910000
         LR    R6,R10              SAVE BASE                   @VS06864 69930000
         L     R15,VCONBHEX        ADDRESS OF BITOHEX          @VS06864 69950000
         L     R10,VCONLBL         ADDRESSABILITY FOR BITOHEX  @VS06864 69970000
         BALR  R8,R15              GO                                   69990000
         LR    R10,R6              MAIN ADDRESSABILITY         @VS06864 70010000
*  THE FOLLOWING PROCESSES AND PRINTS THE USER DATA                     70030000
         LA    R7,OUTBUF+MNAMDATA  POINT AT PROPER BUFFER LOCATION.     70050000
        LA    R4,BLDLUSR           POINT AT USER DATA                   70070000
BLDLOK00 ST    R7,WORKROOM         SAVE                                 70090000
         ST    R4,WORKROOM+USERFLD  POINTERS.                           70110000
         XR    R5,R5                                                    70130000
        IC    R5,BLDLCD            PICK UP HW COUNT                     70150000
         LTR   R5,R5               TEST COUNT FOR ZERO                  70170000
         BZ    BLDLEND             IF ZERO, OUTPUT IS FINISHED          70190000
         MVI   BLDLCD,ZERO         CLEAR CNT IN LIST                    70210000
         CH    R5,TWO              COMPARE COUNT TO 2                   70230000
         BNH   BLDLOK01            IF LESS OR EQUAL,USE AS IS           70250000
         SH    R5,TWO              IF MORE, DECREMENT BY TWO            70270000
        STC   R5,BLDLCD            AND STORE BACK IN LIST               70290000
         LH    R5,TWO              SET COUNT TO CONVERT TO TWO          70310000
BLDLOK01 AR    R5,R5               CHANGE HALFWORD COUNT TO BYTE COUNT  70330000
         LR    R6,R10              SAVE BASE                   @VS06864 70350000
         L     R15,VCONBHEX        ADDRESS OF BITOHEX          @VS06864 70370000
         L     R10,VCONLBL         ADDRESSABILITY FOR BITOHEX  @VS06864 70390000
         BALR  R8,R15              GO                                   70410000
         LR    R10,R6              MAIN ADDRESSABILITY         @VS06864 70430000
         L     R7,WORKROOM         GET BUFFER PTR AND                   70450000
         LA    R7,BUFPTLN(R7)       INCREMENT IT.                       70470000
         LA    R6,OUTBUF+LSTFLD    COMPARE IT AGAINST                   70490000
         CR    R7,R6               END OF BUFFER.                       70510000
         BL    BLDLOK02            IF LESS, PROCESS MORE DATA.          70530000
         LA    R7,OUTBUF           IF MORE OR EQUAL, PUT OUT.           70550000
         LA    R14,LOCSAVOF(R7)       THE BUFFER AND RESET PTR.         70570000
         L     R15,VCONWRIT        GET ADDR OF WRITE ROUTINE   @YL026YA 70590000
         BALR  R8,R15              GO WRITE BUFFER             @YL026YA 70610000
BLDLOK02 L     R4,WORKROOM+USERFLD  GET DATA PTR AND                    70630000
         LA    R4,D4(R4)           INCREMENT IT.                        70650000
         B     BLDLOK00            GO PROCESS MORE DATA.                70670000
BLDLEND  LA    R7,OUTBUF           GET BUFFER ADDRESS                   70690000
         L     R6,WORKROOM         SEE IF THERE IS ANY                  70710000
         CR    R6,R7               DATA TO OUTPUT                       70730000
         BE    BLDLEXIT            NO, SKIP WRITE ROUTINE               70750000
         LA    R14,LOCSAVOF(R7)    SET END OF BUFFER INDICATION         70770000
         L     R15,VCONWRIT        GET ADDR OF WRITE ROUTINE   @YL026YA 70790000
         BALR  R8,R15              GO WRITE BUFFER             @YL026YA 70810000
BLDLEXIT EQU   *                                                        70830000
         LA    R2,OBTDCB                                                70850000
         LA    R1,CLOSEL           POINT AT LIST FORM OF CLOSE          70870000
         CLOSE  ((R2)),MF=(E,(1))                                       70890000
         LA    R2,OBTDCB           SET UP ADDRESSABILITY TO DCB         70910000
         USING IHADCB,R2                                                71550020
*********************************************************************** 71560020
**  THIS CODE PUT IN TO BYPASS OPEN PROBLEM                           * 71570020
*                                                                     * 71580020
         MVC   OBTDCB(EOLFS-DCBMDL),DCBMDL   SET DCB FIELDS BACK        71590020
         MVI   OBTJFCBX,EXITCODE   SET JFCB DCB EXIT CODE               71600020
*********************************************************************** 71610020
         LA    R1,OBTDCBXL         ADDRESS OF EXIT LIST FOR DCB         71640000
         ST    R1,DCBEXLST         RE-ESTABLISH EXIT LIST FOR JFCB      71670000
         DROP  R2                                                       71700020
         B     LABELCHK            CHECK LABEL OPTION                   71730020
NOTTRUE  MVC   OUTBUF+MNAMALI(L'YES),YES                                71760020
         B     BLDLNEX             DO NEXT BLDL                         71790020
         EJECT                                                 @YL026YA 71820000
*********************************************************************** 71821000
*                                                              @YL026YA 71822000
*   CONSTANTS FOR MEMBER NAME AND MEMBERS OPTION PROCESSING    @YL026YA 71823000
*                                                              @YL026YA 71824000
*********************************************************************** 71825000
MNAMHDG  DC    C'--MEMBER---TTR----ALIAS-TTRN-CNT-DATA'        @YL026YA 71826000
YES      DC    C'YES'              IS AN ALIAS NAME            @YL026YA 71827000
NO       DC    C'NO'               IS NOT AN ALIAS NAME        @YL026YA 71828000
TWO      DC    H'2'                TWO                         @YL026YA 71829000
MEMHDG   DC    C'--MEMBERS--'      HEADING FOR MEMBERS         @YL026YA 71830000
VCONLBL  DC    V(IKJEHLBL)         ADDRESS OF LABEL ROUTINE    @YL026YA 71831000
VCONWRIT DC    V(IKJEHWRT)         ADDRESS OF WRITE ROUTINE    @YL026YA 71832000
VCONERR  DC    V(IKJEHERR)         ADDRESS OF ERROR ROUTINE    @YL026YA 71833000
VCONALC  DC    V(IKJEHALC)         ADDRESS OF ALLOCATE ROUTINE @YL026YA 71834000
VCONBHEX DC    V(IKJEHBTX)         ADDRESS OF BIT-TO-HEX RTN   @YL026YA 71835000
         EJECT                                                          71836000
IKJEHDS1 CSECT                                                 @YL026YA 71837000
*                                                                       71850020
*  MACRO 'LIST' FORMS                                                   71880020
*                                                                       71910020
*                                                                       71940020
TPUTMDL  PUTLINE MF=L                                                   72000020
ENDTPUT  EQU   *                                                        72030020
LTPUTL   EQU   ENDTPUT-TPUTMDL                                          72060020
OLFS     EQU   *                   BEGINNING OF LIST FORMS              72090000
RDJMDL   RDJFCB                    (,(INPUT)),MF=L                      72120000
CLSTMDL  CAMLST                    SEARCH,OBTMDLNM,OBTMDLVO,OBTMDLWA    72150000
OBTMDLNM EQU   0                                                        72180020
OBTMDLVO EQU   0                                                        72210020
OBTMDLWA EQU   0                                                        72240020
DCBMDL   DCB   DSORG=PS,MACRF=R,RECFM=F,BLKSIZE=256,KEYLEN=8,LRECL=256,C72270020
               DDNAME=DUMMY                                             72300020
OPENMDL  OPEN  (,),MF=L            LIST FORM OF OPEN                    72330020
READMDL  READ  RMDECB,SF,,,'S',,,MF=L  MODEL FOR LIST FORM OF READ      72360020
CLOSEMDL CLOSE (,),MF=L            MODEL FOR LIST FORM OF CLOSE         72390000
EOLFS    EQU   *                   END OF LIST FORMS                    72420000
LOLFS    EQU   EOLFS-OLFS          LENGTH OF AREA TO MOVE.              72450000
ILFS EQU *                                                              72480020
GETMLMDL GETMAIN EC,MF=L                                                72510020
FREEMMDL FREEMAIN E,MF=L                                                72540020
EILFS    EQU   *                                                        72570020
LILFS    EQU   EILFS-ILFS                                               72600020
MOVE     MVC   D0(L0,R7),D0(R3)    GENERAL MOVE EXECUTED       @YL026YA 72630000
PARSECON DC    V(IKJEHPRM)         ADDRESS OF PARSE MACROS              72700000
*                                                                       72770000
MSGCSECT DC    V(IKJEHDSM)         ADDRESS OF MESSAGES CSECT            72840000
VCONBTHX DC    V(IKJEHBTX)         ADDRESS OF BIT-TO-HEX ROUTINE        72910000
BSCVCON  DC    V(IKJEHBSC)         ADDRESS OF BASIC INFO ROUTINE        72980000
VCONLABL DC    V(IKJEHLBL)         ADDRESS OF LABEL ROUTINE    @YL026YA 73050000
HISTVCON DC    V(IKJEHHIS)         ADDRESS OF HISTORY ROUTINE           73120000
STATVCON DC    V(IKJEHSTA)         ADDRESS OF STATUS ROUTINE            73190000
VCONMEM  DC    V(IKJEHMBR)         ADDRESS OF MEMBERS ROUTINE  @YL026YA 73260000
VCONAST  DC    V(IKJEHDS2)         ADDRESS OF ASTERISK ROUTINE @YL026YA 73330000
VSAMVCON DC    V(IKJEHVSM)         ADDRESS OF VSAM BASIC RTN   @YL026YA 73400000
STIVCON  DC    V(IKJEHSTI)         ADDRESS OF STATUS INIT RTN  @YL026YA 73470000
VCONCIR  DC    V(CIROUTN)                                               73540000
NOTCHAIN DC    X'FF000000'         END OF LIST INDICATOR FOR   @YL026YA 73610000
SUPPL1   DC    X'01000000'         SUBPOOL NUMBER              @YL026YB 73680000
*                                  PARSE                       @YL026YA 73750000
         DS    0H                  ALIGNMENT                     100000 73822021
C210     DC    X'0210'             DARC CODE 0210                100000 73824021
C218     DC    X'0218'             DARC CODE 0218                100000 73826021
RC16     DC    X'10'               RETURN CDE FOR DAIR CHECK    ZA00612 73828002
*   LENGTH OF WORKAREA FOR CIR PARAMETERS                      @YL026YB 73830000
CIRLEN   DC    H'5072'             LENGTH                      @YL026YB 73833000
*  CONSTANTS FOR VSAM LOCATE AND VSAM DATA SETS                @YL026YA 73836000
ENTYPE   DC    CL8'ENTYPE  '       FIELD NAME FOR ENTRY TYPE   @YL026YA 73839000
VOLSER   DC    CL8'VOLSER  '       FIELD NAME FOR VOLUME SERIAL         73842000
PHYBLKSZ DC    CL8'PHYBLKSZ'       FIELD NAME FOR BLOCK SIZE   @YL026YA 73845000
LRECL    DC    CL8'LRECL   '       FIELD NAME FOR RECORD LENGTH         73848000
CATACB   DC    CL8'CATACB  '       FIELD NAME FOR CATALOG ACB  @YL026YA 73851000
NAMEDS   DC    CL8'NAMEDS  '       FIELD NAME FOR RELATED NAMES         73854000
DSETCRDT DC    CL8'DSETCRDT'       FIELD NAME FOR CREATE DATE  @YL026YA 73857000
DSETEXDT DC    CL8'DSETEXDT'       FIELD NAME FOR EXPIRE DATE  @YL026YA 73860000
VOLLEN   DC    F'6'                LENGTH OF VOLUMES ENTRY     @YL026YA 73863000
ASTER    DC    C'**'               SYMBOL FOR UNDEFINED NUMBER @YL026YA 73866000
BASICHDG DC    C'--RECFM-LRECL-BLKSIZE-DSORG'  BASIC DATA HEADING       73869000
HISTHDG  DC    C'-CREATED---EXPIRES---SECURITY'  HISTORY DATA HEADING   73872000
STATHDG  DC    C'--DDNAME---DISP'  STATUS DATA HEADING         @YL026YA 73875000
VOLHDING DC    C'--VOLUMES--'      HEADING FOR VOLSER          @YL026YA 73878000
VSAMVHDG DC    C'--VOLUMES-BLKSIZE'  HEADING FOR VSAM VOLSER   @YL026YA 73881000
FIXAREA  DC    30F'0'              SPACE FOR PATCHES           @ZA10244 73884003
         EJECT                                                          73893000
IKJEHPRM IKJPARM                                                        73896000
PDSLIST  IKJPOSIT DSTHING,USID,LIST,PROMPT='DATA SET NAME'     @YL026YA 73899000
PHISTORY IKJKEYWD                                                       73920020
         IKJNAME  'HISTORY'                                             73950020
PSTATUS  IKJKEYWD                                                       73980020
         IKJNAME  'STATUS'                                              74010020
PMEMBERS IKJKEYWD                                                       74040020
         IKJNAME  'MEMBERS'                                             74070020
PLABEL   IKJKEYWD                                                       74100020
         IKJNAME  'LABEL'                                               74130020
PCATLG   IKJKEYWD                                                       74160000
         IKJNAME 'CATALOG',SUBFLD=PCATSF                       @YL026YA 74163000
PLEVEL   IKJKEYWD                                                       74166000
         IKJNAME 'LEVEL'                                       @YL026YA 74169000
PCATSF   IKJSUBF                                                        74172000
PCATNM   IKJPOSIT DSNAME,PROMPT='CATALOG NAME'                 @YL026YA 74175000
         IKJENDP                                                        74178000
         EJECT                                                          74181000
IKJEHDS2 CSECT                                                          74184000
         USING IKJEHDS2,R15        ADDRESSABILITY FOR CSECT             74187000
         USING OBTWAD,R12          ADDRESSABILITY FOR WORKAREA @YL026YA 74190000
*********************************************************************** 74193000
*              ASTERISK SCAN ROUTINE                                    74196000
*  THIS ROUTINE SCANS THE DATA SET NAME AND LOCATES ASTERISK            74199000
*  QUALIFIERS, IF PRESENT.  IT ALSO CHECKS THAT THE ASTERISK DOES NOT   74202000
*  OCCUR IN THE FIRST INDEX LEVEL AND THAT THERE IS NOT MORE THAN ONE   74205000
*  ASTERISK IN THE DATA SET NAME.  NOTE-  THE SCAN BY PARSE HAS CHECKED 74208000
*  SYNTAX OF DATA SET NAME WITH ASTERISK ALLOWED IN PLACE OF ANY INDEX  74211000
*  LEVEL.                                                               74214000
*  INPUT-      R2 POINTS TO DSNAME TO BE SCANNED                        74217000
*              R3 CONTAINS LENGTH OF THIS DSNAME                        74220000
*              R14 IS RETURN REGISTER                                   74223000
*  REGISTERS 2, 3, 4, AND 6 ARE USED                                    74226000
*  RETURN IS AS FOLLOWS-                                                74229000
*              0 PAST R14 IF * FOUND IN FIRST INDEX LEVEL               74232000
*              4 PAST R14 IF MORE THAN ONE * FOUND                      74235000
*              8 PAST R14 IF SCAN SUCCESSFULLY COMPLETED                74238000
*                                                                       74241000
SCANDSN  SR    R4,R4               ZERO REGISTER                        74244000
         ST    R4,STARADR          ZERO POINTER TO ASTERISK             74247000
         STC   R4,STARLEV          ZERO ASTERISK LEVEL INDICATOR        74250000
         AR    R3,R2               ADD LENGTH AND ADDRESS               74253000
*  REGISTER 3 POINTS PAST LAST CHARACTER OF DATA SET NAME               74256000
         LA    R4,D1               INITIALIZE LEVEL COUNTER TO ONE      74259000
         LR    R6,R4               SET REG 6 TO ONE FOR A LATER TEST    74262000
STARTST2 CLI   D0(R2),STAR         IS THIS CHARACTER AN ASTERISK        74265000
         BE    LEVLTST2            IF *, CHECK INDEX LEVEL              74268000
NXTCHAR2 LA    R2,D1(R2)           POINT TO NEXT CHARACTER              74271000
         CR    R2,R3               ARE THERE MORE CHARACTERS            74274000
         BE    ADD8                IF NOT SCAN IS FINISHED              74277000
         CLI   D0(R2),PERIOD       CHECK FOR PERIOD (NEW INDEX LEVEL)   74280000
         BNE   NXTCHAR2            IF NOT, CHECK NEXT CHARACTER         74283000
         LA    R4,D1(R4)           INCREMENT LEVEL COUNTER              74286000
         LA    R2,D1(R2)           POINT TO NEXT CHARACTER              74289000
         B     STARTST2            NEW INDEX LEVEL, GO CHECK FOR *      74292000
LEVLTST2 CR    R4,R6               IS THIS FIRST INDEX LEVEL            74295000
         BCR   EQ,R14              YES ERROR, * IN FIRST INDEX LEVEL    74298000
         CLI   STARLEV,ZERO        IS LEVEL INDICATOR ZERO     @YL026YA 74301000
         BNE   ADD4                NO, ERROR, MORE THAN ONE ASTERISK    74304000
         ST    R2,STARADR          SAVE ADDRESS OF ASTERISK             74307000
         STC   R4,STARLEV          SAVE LEVEL AT WHICH ASTERISK FOUND   74310000
         B     NXTCHAR2            GO CHECK NEXT CHARACTER              74313000
ADD4     LA    R14,D4(R14)         BUMP RETURN ADDRESS BY 4             74316000
         BR    R14                 RETURN                               74319000
ADD8     LA    R14,D8(R14)         BUMP RETURN ADDRESS BY 8             74322000
         BR    R14                 RETURN                               74325000
         DROP  R15                 IKJEHDS2 NO LONGER NEEDED            74328000
*                                                                       74331000
*  WHEN THE SCAN IS FINISHED                                            74334000
*        STARLEV  WILL CONTAIN LEVEL AT WHICH ASTERISK FOUND            74337000
*        STARADR  WILL CONTAIN ADDRESS AT WHICH ASTERISK FOUND          74340000
*        BOTH WILL CONTAIN ZERO IF NO ASTERISK FOUND                    74343000
*                                                                       74346000
*********************************************************************** 74349000
         EJECT                                                          74352000
         IKJEHCOM                                              @YL026YA 74355000
         ORG   OBTWAEND            ADJUST FOR CONTINUATION OF WORKAREA  74358000
PARDSECT DS    F                   ADDRESS OF PARSE DSECT               74361000
FIRSTIME DS    C                   CONTROLS UNALLOCATE LOGIC            74364000
ALLOCSW  DS    C                   CONTROLS ALLOCATE SWITCH             74367000
OPTMASK  DS    C                   CONTAINS KEYWORD INDICATORS          74370000
OPTMASK2 DS    C                   CONTAINS KEYWORD INDICATORS @YL026YA 74373000
CONTROL  DS    C                   CTL OPTIONS FOR INDIVIDUAL ENTRIES.  74376000
DEFLIST  DS    3F                  DEFAULT PARM LIST                    74379000
SAVEDDN  DS    8X                  DDNAME SAVE AREA                     74382000
RETADDR  DS    F                   HOLDS ADDRESS OF CALLER TO ALLOCDS   74385000
**********************************************************************  74388000
*                                                              @YL026YA 74391000
*   PARAMETER LIST FOR IKJEHCIR                                @YL026YA 74394000
*                                                              @YL026YA 74397000
*********************************************************************** 74400000
CIRADDR  DS    F                   ADDRESS OF IKJEHCIR ROUTINE @YL026YA 74403000
CIRPARM  DS    0C                  PARAMETER LIST              @YL026YA 74406000
CIROPT   DS    CL1                 OPTION BYTE                 @YL026YA 74409000
         DS    CL2                 RESERVED                    @YL026YA 74412000
CIRLOCRC DS    CL1                 LOCATE RETURN CODE          @YL026YA 74415000
CIRSRCH  DS    F                   POINTER TO NAME             @YL026YA 74418000
CIRCVOL  DS    F                   POINTER TO USER CATALOG     @YL026YA 74421000
CIRWA    DS    F                   POINTER TO OUTPUT WORKAREA  @YL026YA 74424000
CIRSAVE  DS    F                   18-WORD SAVE AREA ADDRESS   @YL026YA 74427000
CIRPSWD  DS    F                   POINTER TO 8-BYTE PASSWORD  @YL026YA 74430000
CIRPMLN  EQU   *-CIRPARM           LENGTH OF PARAMETER LIST    @YL026YA 74433000
*********************************************************************** 74490020
*                                                                       74520020
*        THE FOLLOWING CONSTANTS, BUFFER AND PUTLINE MACRO MUST ALL     74550020
*        APPEAR TOGETHER IN THE SPECIFIED ORDER SO THAT THE WRITE       74580020
*        ROUTINE WILL REMAIN INDEPENDANT OF A BASE REGISTER.            74610020
*                                                                       74640020
*********************************************************************** 74670020
PARMLSTS DS    0F                                                       74700020
PUTLCON  DS    F                   PTR TO LIST FOR PUTLINE MACRO        74730000
DPUTLCON DS    F                   PTR TO PUTLINE LIST FORM             74760000
UPTPTR   DS    F                   UPT PTR                              74790000
ECTPTR   DS    F                   ECT PTR                              74820000
ECBPTR   DS    F                   CP ECB PTR                           74850000
PUTLADDR DS    F                   ENTRY POINT OF PUTLINE               74880000
PARMLSTL EQU   *-PARMLSTS                                               74910000
*                                                                       74940000
         DS    F                   LL AND OFF FIELDS FOR OUTPUT LINES   74970000
OUTBUF   DS    CL108               OUTPUT BUFFER                        75000020
DPUTLINE PUTLINE MF=L                                                   75030020
*                                                                       75060020
*                                                                       75090020
*    AREA FOR SERVICE ROUTINE PARM LIST **                              75120020
PUTLLIST DS    7F                  PARMLIST  FOR RTNS                   75150000
*                                                                       75170000
*    END OF SERVICE AREA ROUTINE PARMLIST *                             75190000
CIRDSN   DS    CL44                DATA SET NAME BUFFER FOR CIR         75210000
CIRPASS  DS    CL8                 PASSWORD BUFFER             @YL026YA 75230000
STARADR  DS    F                   ADDRESS OF * IN NAME        @YL026YA 75250000
STARLEV  DS    CL1                 POSITION OF * IN NAME       @YL026YA 75270000
*                                                              @YL026YA 75290000
         DS    0H                  HALF WORD BNDRY             @YL026YB 75310000
LASTQLEN DS    H                   LENGTH OF TRAILING QUALIFIER         75330000
LASTQUAL DS    CL44                TRAILING QUALIFIER BUFFER   @YL026YA 75350000
PARSPTR  DS    F                   VALUE OF DSLIST POINTER (R9)         75370000
*                                    BEFORE CALLING CIR        @YL026YA 75390000
NAMEBUFF DS    CL44                FOR BUILDING FULLY QUALIFIED         75410000
*                                  NAME TO TEST AGAINST        @YL026YA 75430000
CATBUFF  DS    CL44                44-BYTE CATALOG NAME        @YL026YA 75450000
PROCNM   DS    CL1                 NAME PROCESSING INDICATOR - @YL026YA 75470000
*                                   X'00' - NAME FROM DSLIST   @YL026YA 75490000
*                                   X'FF' - NAME FROM CIR LIST @YL026YA 75510000
         DS    0H                       HALF WORD BNDRY         ZA00105 75530002
         DS    CL1                 ALIGN LAST 2 BYTES OF        ZA00105 75533002
*                                  CREDT TO HALF WORD           ZA00105 75536002
WRKCREDT DS    CL3                 COMMON CREATION DATE        @YL026YA 75539002
         DS    CL1                 ALIGN LAST 2 BYTES OF        ZA00105 75542002
*                                  EXPDT TO HALF WORD           ZA00105 75545002
WRKEXPDT DS    CL3                 COMMON EXPIRATION DATE      @YL026YA 75550000
DSTYPE   DS    CL1                 ENTRY TYPE CODE             @YL026YA 75570000
CPECB    DS    F                   CP ECB                      @YL026YA 75590000
PSCBPTR  DS    F                   PSCB PTR                    @YL026YA 75610000
GETML    GETMAIN EC,MF=L                                                75630000
FREEML   FREEMAIN                  E,MF=L                               75650000
GETMVCL  GETMAIN VC,MF=L                                       @YL026YA 75670000
        EJECT                                                           75810020
*********************************************************************** 75840020
*                                                                       75870020
*   THE  FOLLOWING 3 WORDS ARE USED TO PASS PARAMETERS TO THE           75900020
*   ERROR HANDLING ROUTINE. THE FIRST TWO BYTES CONTAIN THE RELATIVE    75930020
*   POSITION OF THE MESSAGE IN THE MESSAGE CSECT. THE NEXT TWO BYTES    75960020
*   CONTAIN THE A NUMBER THAT INDICATES WHICH SECOND LEVEL MESSAGE      75990020
*   IS TO BE SELECTED. THE SECOND WORD POINTS A FIELD CONTAINING        76020020
*   A ONE BYTE LENGTH FIELD FOLLOWED BY DATA TO BE INSERTED IN THE      76050020
*   FIRST MESSAGE. THE LAST WORD CONTAINS A SIMILAR POINTER FOR THE     76080020
*   SECOND MESSAGE.                                                     76110020
*                                                                       76140020
*********************************************************************** 76170020
ERRPARM  DS    0F                                                       76200020
ERRFIRST DS    H                   FIRST LEVEL MSG RELATIVE NUMBER      76230000
ERRSECND DS    H                   SECOND LEVEL MSG RELATIVE NUMBER     76250000
ERRINST1 DS    F                   PTR TO INSERT DATA FOR LEVEL 1       76270000
ERRINST2 DS    F                   PTR TO INSERT DATA FOR LEVEL 2       76290000
ERREND   EQU   *                                                        76326020
ERRLIST  EQU   ERREND-ERRPARM                                           76332020
ERR1     EQU   ERRFIRST+D1                                              76338020
ERR2     EQU   ERRSECND+D1                                              76344020
         DS    0D                                                       76350020
ERRINSRT DS    CL45                FOR PASSING DATA TO ERROR HANDLER TO 76380000
*                                BE INSERTED IN A MESSAGE               76400000
WORKROOM EQU   ERRINSRT                                                 76420000
MSGPARM1 DS    1F                  FIRST LEVEL MSG PARM LIST            76440000
MPM11    DS    1F                  OFFSET OF 4                          76460000
MPM12    DS    1F                  OFFSET OF 8                          76480000
MSGPARM2 DS    1F                  SECOND LEVEL MSG PARM LIST           76500000
MPM21    DS    1F                  OFFSET OF 4                          76520000
MPM22    DS    1F                  OFFSET OF 8                 @YL026YA 76540000
DAIRLIST DS    21F                 DAIR PARAMETER LIST           YM1019 76560000
         DS    0H                  HALFWORD ALIGN NEXT FIELD     A42337 76580000
CURNTNAM DS    CL47                DSNAME CURRENTLY BEING PROCESSED     76600000
TEMPNAME EQU   CURNTNAM+2          ADDRESS OF CURRENT NAME              76620000
MEMMOD   DS    F                   CONTAINS ADDRESS OF IKJEHMEM         76640000
DSORGSV  DS    CL2                 SAVE DSORG TYPE                      76660000
* * * * * * * * * * * * * * * * * * *                                   76680000
BLDLLIST DS    0H                  LIST FOR BLDL MACRO                  76700000
BLDLFF  DS    H                    FLAG OPTIONS                         76720000
BLDLL   DS    H                    LENGTH OF ENTRY                      76740000
BLDLNME  DS    CL8                 MEMBERNAME                           76760000
BLDLTT   DS    H                   RELATIVE TRACK NUMBER                76780000
BLDLR    DS    X                   BLOCK NUMBER                         76800000
BLDLK    DS    X                   CONCATENATION NUMBER                 76820000
BLDLZ    DS    X                   WHERE FOUND                          76840000
BLDLCD   DS    X                   MASK OF TYPE NAME                    76860000
BLDLUSR  DS    31H                 USER AREA                            76880000
         DS    8F                  ADDED SPACE FOR I/O SYNAD ERROR      76900000
* * * * * * * * * * * * * * * * * * *                                   76920000
SAVEAREA DS    28F                 SAVEAREA AND LOCAL SAVEAREA          76940000
OBTCCHHR DS    CL5                 HOLDS CCHHR OF NEXT DSCB IN CHAIN    76960000
STACKSW  DS    CL1                 INDICATE FLUSH STACK AND CLEAR QUEUE 77160420
STACKPRM DS    2F                  STACK PARM BLOCK                     77160820
         EJECT                                                          77161020
*********************************************************************** 77162000
*                                                              @YL026YA 77162100
*   THE FOLLOWING DECLARES ARE USED FOR DYNAMIC INFORMATION    @YL026YA 77162200
*   RETRIEVAL.                                                 @YL026YA 77162300
*                                                              @YL026YA 77162400
*********************************************************************** 77162500
DAREQBLK DS    0F                  REQUEST BLOCK FOR DYNAMIC   @YL026YA 77162600
*                                  ALLOCATION                  @YL026YA 77162700
DARBLEN  DS    CL1                 LENGTH OF BLOCK             @YL026YA 77162800
DAVRBCD  DS    CL1                 VERB CODE                   @YL026YA 77162900
DAFLGS1  DS    CL2                 FLAGS                       @YL026YA 77163000
DAERRCD  DS    CL2                 ERROR REASON CODE           @YL026YA 77163100
DAINFCD  DS    CL2                 INFORMATIONAL RETURN CODE   @YL026YA 77163200
DATXTPT  DS    CL4                 ADDRESS OF TEXT POINTERS    @YL026YA 77163300
         DS    CL4                                             @YL026YA 77163400
         DS    CL4                                             @YL026YA 77163500
DABLKLN  EQU   *-DAREQBLK          LENGTH OF REQUEST BLOCK     @YL026YA 77163600
*                                                              @YL026YA 77163700
TXTPTRS  DS    5F                  ADDRESSES OF TEXT UNITS     @YL026YA 77163800
TU1DSN   DS    0C                  TEXT UNIT FOR DSNAME        @YL026YA 77163900
TU1KEY   DS    CL2                                             @YL026YA 77164000
TU1NUM   DS    CL2                                             @YL026YA 77164100
TU1LEN   DS    CL2                                             @YL026YA 77164200
TU1NAM   DS    CL44                                            @YL026YA 77164300
TU1LNGTH EQU   *-TU1DSN                                        @YL026YA 77164400
TU2DDN   DS    0C                  TEXT UNIT FOR DDNAME        @YL026YA 77164500
TU2KEY   DS    CL2                                             @YL026YA 77164600
TU2NUM   DS    CL2                                             @YL026YA 77164700
TU2LEN   DS    CL2                                             @YL026YA 77164800
TU2NAM   DS    CL8                                             @YL026YA 77164900
TU2LNGTH EQU   *-TU2DDN                                        @YL026YA 77165000
TU3STAT  DS    0C                  TEXT UNIT FOR STATUS        @YL026YA 77165100
TU3KEY   DS    CL2                                             @YL026YA 77165200
TU3NUM   DS    CL2                                             @YL026YA 77165300
TU3LEN   DS    CL2                                             @YL026YA 77165400
TU3VALUE DS    CL1                                             @YL026YA 77165500
TU3LNGTH EQU   *-TU3STAT                                       @YL026YA 77165600
TU4DSPN  DS    0C                  TEXT UNIT FOR NORMAL DISP   @YL026YA 77165700
TU4KEY   DS    CL2                                             @YL026YA 77165800
TU4NUM   DS    CL2                                             @YL026YA 77165900
TU4LEN   DS    CL2                                             @YL026YA 77166000
TU4VALUE DS    CL1                                             @YL026YA 77166100
TU4LNGTH EQU   *-TU4DSPN                                       @YL026YA 77166200
TU5DSPC  DS    0C                  TEXT UNIT FOR COND. DISP.   @YL026YA 77166300
TU5KEY   DS    CL2                                             @YL026YA 77166400
TU5NUM   DS    CL2                                             @YL026YA 77166500
TU5LEN   DS    CL2                                             @YL026YA 77166600
TU5VALUE DS    CL1                                             @YL026YA 77166700
TU5LNGTH EQU   *-TU5DSPC                                       @YL026YA 77166800
*   INFORMATION RETRIEVAL KEYS FOR FIELDS                      @YL026YA 77166900
DSNKEY   EQU   X'02'               DSNAME                      @YL026YA 77167000
DDNKEY   EQU   X'04'               DDNAME                      @YL026YA 77167100
STATKEY  EQU   X'07'               STATUS                      @YL026YA 77167200
NDSPKEY  EQU   X'08'               NORMAL DISPOSITION          @YL026YA 77167300
CDSPKEY  EQU   X'09'               CONDITIONAL DISPOSITION     @YL026YA 77167400
*                                                              @YL026YA 77167500
RQBLKAD  DS    0F                  POINTER TO REQUEST BLOCK    @YL026YA 77167600
*   END OF INFORMATION RETRIEVAL AREAS                         @YL026YA 77167700
         EJECT                                                 @YL026YA 77167800
TMPSR1   DS    F                   SAVE TMP'S REGISTER 1 HERE           77167900
STAEADDR DS    F                   ADDRESS OF IKJUSTAE                  77168000
CNVRTWD  DS    H                   CONTAINS RETURN CODE                 77168100
*  DATA SET NAME INSERTION BUFFER FOR MESSAGES                   A42337 77168200
MSGNAMEL DS    H                   DSNAME LENGTH                 A42337 77168300
MSGNAME  DS    CL48                DSNAME FOR MESSAGE INSERTION  A42337 77168400
         PSEUDO MF=L                                                    77168500
STAELIST STAE  STAEADDR,PARAM=STAEPARM,MF=L                             77168600
STAEONE  STABUILD CODE=(113,213,313,713,913),ADDR=STAEONE,NUM=2,       X77168700
               FLAG=(MUL,NMSG),LIST=STAELST,RTN=OPENERR,               X77168800
               MF=L                                                     77169020
STAETWO  STABUILD CODE=000,RTN=ANYABND,ADDR=STAETWO,                   X77170020
               FLAG=(ALL,NMSG,END),                                    X77171020
               MF=L                                                     77172020
         ORG                                                            77173020
         STAEPARM FLAG=(CP),LIST=STAEONE,ADDR=STAEPARM,PSEUDO=$PSEUDO, X77174020
               MF=L                                                     77175020
STAELNTH EQU   *-STAELIST          SIZE OF STAE LISTS                   77176020
LABELHEX EQU   BLDLLIST            FOR CONVERTING LABEL TO HEX          77190000
SECBUFF  EQU   BLDLLIST                                                 77193000
         IEZCTGPL                                              @YL026YA 77196000
         EJECT                                                 @YL026YA 77199000
         IEZCTGFL                                              @YL026YA 77202000
         EJECT                                                 @YL026YA 77205000
OBTWAD   DSECT                                                 @YL026YA 77208000
CPLAREA  DS    CL(CTGPLLEN)        SPACE FOR CPL               @YL026YA 77211000
         DS    7A                  SPACE FOR FIELD POINTERS    @YL026YA 77214000
CATWORK1 DS    CL512               CATALOG WORK AREA           @YL026YA 77217000
CATWORK2 DS    CL512               CATALOG WORK AREA ALSO      @YL026YA 77220000
CTGFL1   DS    6A                  FPL SPACE                   @YL026YA 77223000
CTGFL2   DS    6A                  FPL SPACE                   @YL026YA 77226000
CTGFL3   DS    6A                  FPL SPACE                   @YL026YA 77229000
CTGFL4   DS    6A                  FPL SPACE                   @YL026YA 77232000
CTGFL5   DS    6A                  FPL SPACE                   @YL026YA 77235000
CTGFL6   DS    6A                  FPL SPACE                   @YL026YA 77238000
CTGFL7   DS    6A                  FPL SPACE                   @YL026YA 77241000
CTGFL8   DS    6A                  FPL SPACE                   @YL026YA 77244000
WORKSIZE EQU   *-OBTDSNAM                                               77250020
         EJECT                                                          77280020
         DCBD  DSORG=PS                                                 77310020
         EJECT                                                          77340020
         CVT                                                            77370020
         EJECT                                                          77400020
         IKJTCB                                                         77430020
         EJECT                                                          77460020
         IEFZB4D0                                              @YL026YA 77490000
         EJECT                                                          77540000
         IKJCPPL                                                        77590000
         IKJPSCB                                                        77640000
         IKJUPT                                                @YL026YB 77690000
         IKJPPL                                                         77740000
         IKJDAPL                                                        77790000
         EJECT                                                 @YL026YA 77840000
         IKJDFPL                                                        77890000
         IKJDFPB                                                        77940000
         EJECT                                                          77990000
         IKJDAP2C                                                       78090020
DAIR2CLN EQU   *-DAPB2C            LENGTH OF DAIR PARM BLOCK 2C         78100020
         EJECT                                                          78150020
         IKJDAP08                                                       78180020
DAIR08LN EQU   *-DAPB08            LENGTH OF DAIR08 PARM BLOCK          78190020
         EJECT                                                          78210020
IKJEHDSM CSECT                                                          78240020
*********************************************************************** 78270020
*                                                                     * 78300020
*        THIS MODULE CONTAINS THE MESSAGES USED BY THE LISTDS COMMAND * 78390020
*                                                                     * 78420020
*        THE BEGINNING OF THE CSECT CONTAINS A TABLE WITH ONE DWORD   * 78930020
*        ENTRY FOR EACH MESSAGE. THE FIRST HWORD CONTAINS THE LENGTH  * 78960020
*        OF THE FIRST LEVEL MESSAGE. THE SECOND HWORD CONTAINS THE    * 78990020
*        OFFSET OF THE MESSAGE INTO THE CSECT. THE THIRD HWORD        * 79020020
*        CONTAINS THE OFFSET TO THE SEGMENT STRING.    THE FOURTH     * 79050020
*        AND LAST HWORD POINTS TO A CHAIN OF FWORDS POINTING TO THE   * 79080020
*        SECOND LEVEL MESSAGES.                                       * 79110020
*                                                                       79260020
*********************************************************************** 79290020
STARTDSM DS    0F                  ALIGN TO A FULL WORD BOUNDARY        79320000
         DC    AL2(L'MSGE1)        LENGTH OF MESSAGE 1                  79350020
         DC    AL2(MSGE1-STARTDSM) OFFSET OF MESSAGE 1                  79380020
         DC    AL2(OFFSEG1-STARTDSM)            OFFSET TO NEXT SEGMENT  79410020
         DC    AL2(SECLEVEL-STARTDSM) OFFSET TO SECOND LEVEL MESSAGES   79440020
         DC    AL2(L'MSGE2)                                             79470020
         DC    AL2(MSGE2-STARTDSM)                                      79500020
         DC    AL2(0)                                                   79530020
         DC    AL2(SECLEVEL-STARTDSM)                                   79560020
         DC    AL2(L'MSGE3)                                             79590020
         DC    AL2(MSGE3-STARTDSM)                                      79620020
         DC    AL2(0)                                                   79650020
         DC    AL2(SECLEVEL-STARTDSM)                                   79680020
         DC    AL2(L'MSGE4)                                             79710020
         DC    AL2(MSGE4-STARTDSM)                                      79740020
         DC    AL2(0)                                                   79770020
         DC    AL2(SECLEVEL-STARTDSM)                                   79800020
         DC    AL2(L'MSGE5)                                             79830020
         DC    AL2(MSGE5-STARTDSM)                                      79860020
         DC    AL2(0)                                                   79890020
         DC    AL2(SECLEVEL-STARTDSM)                                   79920020
         DC    AL2(L'MSGE6)                                             79950020
         DC    AL2(MSGE6-STARTDSM)                                      79980020
         DC    AL2(0)                                                   80010020
         DC    AL2(SECLEVEL-STARTDSM)                                   80040020
         DC    AL2(L'MSGE7)        LENGTH OF MSG 7                      80070000
         DC    AL2(MSGE7-STARTDSM) OFFSET TO MSG 7                      80100020
         DC    AL2(OFFSEG7-STARTDSM)   OFFSET TO SEGMENT                80130020
         DC    AL2(SECLEVEL-STARTDSM) SECOND LEVEL TABLE                80160020
          DC    AL2(L'MSGE8)                                            80190020
          DC    AL2(MSGE8-STARTDSM)                                     80220020
          DC    AL2(OFFSEG8-STARTDSM)                                   80250020
          DC    AL2(SECLEVEL-STARTDSM)                                  80280020
          DC    AL2(L'MSGE9)                                            80310020
          DC    AL2(MSGE9-STARTDSM)                                     80340020
          DC    AL2(OFFSEG9-STARTDSM)                                   80370020
          DC    AL2(SECLEVEL-STARTDSM)                                  80400020
          DC    AL2(L'MSGE10)                                           80430020
          DC    AL2(MSGE10-STARTDSM)                                    80460020
          DC    AL2(OFFSEG10-STARTDSM)                                  80490020
          DC    AL2(SECLEVEL-STARTDSM)                                  80520020
          DC    AL2(L'MSGE11)                                           80550020
          DC    AL2(MSGE11-STARTDSM)                                    80580020
          DC    AL2(OFFSEG11-STARTDSM)                                  80610020
          DC    AL2(SECLEVEL-STARTDSM)                                  80640020
          DC    AL2(L'MSGE12)                                           80670020
          DC    AL2(MSGE12-STARTDSM)                                    80700020
          DC    AL2(OFFSEG12-STARTDSM)                                  80730020
          DC    AL2(SECLEVEL-STARTDSM)                                  80760020
          DC    AL2(L'MSGE13)                                           80790020
          DC    AL2(MSGE13-STARTDSM)                                    80820020
          DC    AL2(0)                                                  80850020
          DC    AL2(SECLEVEL-STARTDSM)                                  80880020
          DC    AL2(L'MSGE14)                                           80910020
          DC    AL2(MSGE14-STARTDSM)                                    80940020
          DC    AL2(0)                                                  80970020
          DC    AL2(SECLEVEL-STARTDSM)                                  81000020
          DC    AL2(L'MSGE15)                                           81030020
          DC    AL2(MSGE15-STARTDSM)                                    81060020
          DC    AL2(OFFSEG15-STARTDSM)                                  81090020
          DC    AL2(SECLEVEL-STARTDSM)                                  81120020
*                                                                       81150020
          DC    AL2(L'MSGE16)                                           81180020
          DC    AL2(MSGE16-STARTDSM)                                    81210020
          DC    AL2(OFFSEG16-STARTDSM)                                  81240020
         DC    AL2(SECLEVEL-STARTDSM)                                   81270020
         DC    AL2(L'MSGE17)                                            81300020
         DC    AL2(MSGE17-STARTDSM)                                     81330020
         DC    AL2(OFFSEG17-STARTDSM)                                   81360020
         DC    AL2(SECLEVEL-STARTDSM)                                   81390020
         DC    AL2(L'MSGE18)                                   @YL026YA 81392000
         DC    AL2(MSGE18-STARTDSM)                            @YL026YA 81394000
         DC    AL2(OFFSEG18-STARTDSM)                          @YL026YA 81396000
         DC    AL2(SECLEVEL-STARTDSM)                          @YL026YA 81398000
         DC    AL2(L'MSGE19)                                   @YL026YA 81400000
         DC    AL2(MSGE19-STARTDSM)                            @YL026YA 81402000
         DC    AL2(0)                                          @YL026YA 81404000
         DC    AL2(SECLEVEL-STARTDSM)                          @YL026YA 81406000
         DC    AL2(L'MSGE20)                                   @VS06783 81408000
         DC    AL2(MSGE20-STARTDSM)                            @VS06783 81410000
         DC    AL2(0)                                          @VS06783 81412000
         DC    AL2(SECLEVEL-STARTDSM)                          @VS06783 81414000
*        SECOND LEVEL MESSAGE TABLE--6 BYTES PER ENTRY INCLUDING A      81420020
*        2 BYTE LENGTH, A 2 BYTE MESSAGE OFFSET, A 2 BYTE SEGMENT ADDR. 81450020
SECLEVEL DS    0F                                                       81480020
         DC    AL2(L'MSGSEC01)                                          81510020
         DC    AL2(MSGSEC01-STARTDSM)                                   81540020
         DC    AL2(0)                                                   81570020
         DC    AL2(L'MSGSEC02)                                          81600020
         DC    AL2(MSGSEC02-STARTDSM)                                   81630020
         DC    AL2(0)                                                   81660020
         DC    AL2(L'MSGSEC03)                                          81690020
         DC    AL2(MSGSEC03-STARTDSM)                                   81720020
         DC    AL2(0)                                                   81750020
         DC    AL2(L'MSGSEC04)                                          81780020
         DC    AL2(MSGSEC04-STARTDSM)                                   81810020
         DC    AL2(0)                                                   81840020
         DC    AL2(L'MSGSEC05)                                          81870020
         DC    AL2(MSGSEC05-STARTDSM)                                   81900020
         DC    AL2(0)                                                   81930020
         DC    AL2(L'MSGSEC06)                                          81960020
         DC    AL2(MSGSEC06-STARTDSM)                                   81990020
         DC    AL2(0)                                                   82020020
         DC    AL2(L'MSGSEC07)                                          82050020
         DC    AL2(MSGSEC07-STARTDSM)                                   82080020
         DC    AL2(0)                                                   82110020
         DC    AL2(L'MSGSEC08)                                          82140020
         DC    AL2(MSGSEC08-STARTDSM)                                   82170020
         DC    AL2(0)                                                   82200020
         DC    AL2(L'MSGSEC09)     LENGTH OF SEC LEVEL MSG 9            82230000
         DC    AL2(MSGSEC09-STARTDSM) OFFSET TO MSG 9                   82260000
         DC    AL2(0)              OFFSET TO SEGMENT TABLE              82290000
         DC    AL2(L'MSGSEC10)     LENGTH OF SEC LEVEL MSG 10           82320000
         DC    AL2(MSGSEC10-STARTDSM) OFFSET TO MESSAGE                 82350000
         DC    AL2(0)              OFFSET TO SEGMENT TABLE              82380000
          DC    AL2(L'MSGSEC11)                                         82410020
          DC    AL2(MSGSEC11-STARTDSM)                                  82440020
          DC    AL2(0)                                                  82470020
          DC    AL2(L'MSGSEC12)                                         82500020
          DC    AL2(MSGSEC12-STARTDSM)                                  82530020
          DC    AL2(0)                                                  82560020
          DC    AL2(L'MSGSEC13)                                         82590020
          DC    AL2(MSGSEC13-STARTDSM)                                  82620020
          DC    AL2(0)                                                  82650020
          DC    AL2(L'MSGSEC14)                                         82680020
          DC    AL2(MSGSEC14-STARTDSM)                                  82710020
          DC    AL2(0)                                                  82740020
          DC    AL2(L'MSGSEC15)                                         82770020
          DC    AL2(MSGSEC15-STARTDSM)                                  82800020
          DC    AL2(0)                                                  82830020
          DC    AL2(L'MSGSEC16)                                         82860020
          DC    AL2(MSGSEC16-STARTDSM)                                  82890020
          DC    AL2(0)                                                  82920020
          DC    AL2(L'MSGSEC17)                                         82950020
          DC    AL2(MSGSEC17-STARTDSM)                                  82980020
          DC    AL2(0)                                                  83010020
         DC    AL2(L'MSGSEC18)                                          83017020
         DC    AL2(MSGSEC18-STARTDSM)                                   83024020
         DC    AL2(0)                                                   83031020
         DC    AL2(L'MSGSEC19)                                          83032020
         DC    AL2(MSGSEC19-STARTDSM)                                   83033020
         DC    AL2(0)                                                   83034020
         DC    AL2(L'MSGSEC20)                                          83035020
         DC    AL2(MSGSEC20-STARTDSM)                                   83036020
         DC    AL2(0)                                                   83037020
         DC    AL2(L'MSGSEC21)                                 @YL026YA 83037400
         DC    AL2(MSGSEC21-STARTDSM)                          @YL026YA 83037800
         DC    AL2(0)                                          @YL026YA 83038200
         DC    AL2(L'MSGSEC22)                                 @YL026YA 83038600
         DC    AL2(MSGSEC22-STARTDSM)                          @YL026YA 83039000
         DC    AL2(0)                                          @YL026YA 83039400
*                                                                       83040020
*                                                                       83070020
*   SEGTABLE USED FOR SEGMENTS OF MESSAGES **                           83100020
         DS    0F                  ALIGN                                83130000
OFFSEG1  DC    AL2(L'SEG1)                                              83160020
         DC    AL2(SEG1-STARTDSM)                                       83190020
         DC    AL2(0)                                                   83220020
OFFSEG7  DC    AL2(L'SEG7)                                              83230020
         DC    AL2(SEG7-STARTDSM)                                       83240020
         DC    AL2(0)                                                   83250020
OFFSEG8  DC    AL2(L'SEG8)                                              83310020
         DC    AL2(SEG8-STARTDSM)                                       83340020
         DC    AL2(0)                                                   83370020
OFFSEG9  DC    AL2(L'SEG9)                                              83400020
         DC    AL2(SEG9-STARTDSM)                                       83430020
         DC    AL2(0)                                                   83460020
OFFSEG10 DC    AL2(L'SEG10)                                             83490020
         DC    AL2(SEG10-STARTDSM)                                      83520020
         DC    AL2(0)                                                   83550020
OFFSEG11 DC    AL2(L'SEG11)                                             83580020
         DC    AL2(SEG11-STARTDSM)                                      83610020
         DC    AL2(0)                                                   83640020
OFFSEG12 DC    AL2(L'SEG12)                                             83670020
         DC    AL2(SEG12-STARTDSM)                                      83700020
         DC    AL2(0)                                                   83730020
         DC    3F'0'                                                    83760020
*     THE ABOVE DC IS FILL IN FOR TWO MSGES *                           83790020
OFFSEG15 DC    AL2(L'SEG15)                                             83820020
         DC    AL2(SEG15-STARTDSM)                                      83850020
         DC    AL2(0)                                                   83880020
OFFSEG16 DC    AL2(L'SEG16)                                             83910020
         DC    AL2(SEG16-STARTDSM)                                      83940020
         DC    AL2(0)                                                   83970020
OFFSEG17 DC    AL2(L'SEG17)                                             84000020
         DC    AL2(SEG17-STARTDSM)                                      84030020
         DC    AL2(0)                                                   84060020
OFFSEG18 DC    AL2(L'SEG18)                                    @YL026YA 84067000
         DC    AL2(SEG18-STARTDSM)                             @YL026YA 84074000
         DC    AL2(0)                                          @YL026YA 84081000
*        FIRST LEVEL MESSAGES FOLLOW BELOW                              84090020
*                                                                       84120020
*                                                                       84150020
*                                                                       84180020
MSGE1    DC    C'IKJ58503I DATA SET '                                   84210020
SEG1     DC    C' NOT IN CATALOG'       SECND SEG                       84240020
MSGE2    DC    C'IKJ58500I DATA SET ATTRIBUTES NOT AVAILABLE+'          84270020
MSGE3    DC    C'IKJ58504I COMPLETE VOLUME LIST NOT AVAILABLE+'         84300020
MSGE4    DC    C'IKJ58501I MEMBERS NOT AVAILABLE+'                      84330020
MSGE5    DC    C'IKJ58502I DIRECTORY INFORMATION NOT AVAILABLE+'        84360020
MSGE6    DC    C'IKJ58505I LABEL INFORMATION NOT AVAILABLE+'            84390020
MSGE7    DC    C'IKJ58509I DATA SET NAME REQUIRED WHEN MEMBER '         84420020
SEG7     DC    C' IS SPECIFIED'       SECND SEG                         84450020
MSGE8    DC    C'IKJ58506I DATA SET '    FIRST SEG                      84480020
SEG8     DC    C' NOT ALLOCATED, TOO MANY DATA SETS+'  SECND SEG A49872 84510000
MSGE9    DC    C'IKJ58514I DATA SET '   STAE FIRST MESSAGE SEGMENT      84540020
SEG9     DC    C' NOT USEABLE+'          STAE SECOND MESSAGE     A49872 84570021
MSGE10   DC    C'IKJ58507I DATA SET '      FIRST SEG                    84600020
SEG10    DC    C' NOT ALLOCATED, REQUIRED VOLUME NOT MOUNTED+'   A49872 84630021
MSGE11   DC    C'IKJ58508I DATA SET '      FIRST SEG                    84660020
SEG11    DC    C' NOT ALLOCATED, SYSTEM OR INSTALLATION ERROR+'  A49872 84690021
MSGE12   DC    C'IKJ58510I DATA SET '      FIRST SEG                    84720020
SEG12    DC    C' ALREADY IN USE, TRY LATER+'                    A49872 84750021
MSGE13   DC    C'IKJ58512I COMMAND SYSTEM ERROR+'  NO SEG               84780020
MSGE14   DC    C'IKJ58511I NOT ENOUGH MAIN STORAGE TO EXECUTE COMMAND'  84810020
MSGE15   EQU   *                                                        84840020
SEG15    EQU   *                                                        84870020
MSGE16   DC    C'IKJ58513I INVALID DATA SET NAME, '                     84900020
SEG16    DC    C' EXCEEDS 44 CHARACTERS'                                84930020
MSGE17   DC    C'IKJ58515I DATA SET LIST NOT ALLOWED WITH LEVEL'        84960000
SEG17    EQU   *                                                        84968000
MSGE18   DC    C'IKJ58516I INVALID USE OF * IN '               @YL026YA 84976000
SEG18    DC    C' +'                                           @YL026YA 84984000
MSGE19   DC    C'IKJ58517I UNABLE TO LIST * NAME OR LEVEL+'    @YL026YA 84992000
SEG19    EQU   *                                               @YL026YA 85000000
MSGE20   DC    C'IKJ58518I NO DATA SETS FOUND TO MATCH * IN '  @VS06783 85008000
*                                                                       85020020
*                                                                       85050020
*        SECOND LEVEL MESSAGES FOLLOW BELOW--XX IS DETERMINED           85080020
*        DYNAMICALLY AND APPENDED.                                      85110020
*                                                                       85140020
MSGSEC01 DC    C'IKJ585XXI LOCATE ERROR CODE '     LOCATE ERROR MSG     85170020
MSGSEC02 DC    C'IKJ585XXI OBTAIN ERROR CODE '                          85200020
MSGSEC03 DC    C'IKJ585XXI DYNAMIC ALLOCATION ERROR CODE '              85230020
MSGSEC04 DC    C'IKJ585XXI DIRECTORY STRUCTURE ERROR'                   85260020
MSGSEC05 DC    C'IKJ585XXI I/O SYNAD ERROR DURING DIRECTORY SEARCH '    85290020
MSGSEC06 DC    C'IKJ585XXI NOT ENOUGH MAIN STORAGE'                     85320020
MSGSEC07 DC    C'IKJ585XXI I/O ERROR DURING BLDL'  RC=8                 85350020
MSGSEC08 DC    C'IKJ585XXI DATA SET IS NOT A PARTITIONED DATA SET'      85380020
MSGSEC09 DC    C'IKJ585XXI MEMBER NAME NOT FOUND'    RC=04              85410020
MSGSEC10 DC    C'IKJ585XXI VOLUME OR CVOL NOT ON SYSTEM AND CANNOT BE A-85430020
               CCESSED'           CTRC=4  DAIR 8                        85450020
MSGSEC11 DC    C'IKJ585XXI USE FREE COMMAND TO FREE UNUSED DATA SETS'   85470020
MSGSEC12 DC    C'IKJ585XXI OPEN ERROR CODE ' STAE MSG                   85500020
MSGSEC13 DC    C'IKJ585XXI VOLUME NOT ON SYSTEM AND CANNOT BE ACCESSED' 85530020
MSGSEC14 DC    C'IKJ585XXI ABEND CODE '     STAE MSG                    85560020
MSGSEC15 DC    C'IKJ585XXI DATA SET ALLOCATED TO ANOTHER USER OR JOB'   85590020
MSGSEC16 DC    C'IKJ585XXI PARSE ERROR CODE '                           85620020
MSGSEC17 DC    C'IKJ585XXI DEFAULT ERROR CODE '                         85650020
MSGSEC18 DC    C'IKJ58504I JFCB EXTENSION NOT AVAILABLE'                85680020
MSGSEC19 DC    C'IKJ585XXI CATALOG I/O ERROR '   CTRC28 DAIR8           85690020
MSGSEC20 DC    C'IKJ585XXI DAIR ERROR CODE '   RC 4 DAIR                85700020
MSGSEC21 DC    C'IKJ585XXI * NOT ALLOWED AS FIRST LEVEL'       @YL026YA 85710000
MSGSEC22 DC    C'IKJ585XXI MORE THAN ONE * NOT ALLOWED'        @YL026YA 88710000
PATCH     DC    20X'00'                PATCH AREA                       88760003
         END                                                            91710000
