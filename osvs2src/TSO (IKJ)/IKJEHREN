         TITLE 'IKJEHREN-IBM TIME SHARING RENAME COMMAND'               00040037
IKJEHREN CSECT                                                          00080020
*C 727200,773200-773600,857200                                   A49872 00122021
*A 162300                                                        A48485 00130021
*C 332080                                                         M2009 00140021
*        VS2-3.0 SERVICE UPDATE                                         00150037
*0000095500,383760                                             @ZA11579 00150837
*0000049201,082410,085141,095500,383610-383640                 @ZA07213 00151637
*0000411901-411905,822810,822820-857204                        @ZA07213 00152437
*0000531549                                                    @ZA06145 00153237
*0000002400,010100,010200,095300-095520                        @ZA01485 00154037
*0000144420,337200,342900,343300-343500                        @ZA01485 00156037
*0000492000,496800,526800,614384,714820                        @ZA01485 00158037
*        VS2-3.7 SERVICE UPDATE                                         00160003
*C763200,A763300,C619200         REF ZA25723                   @ZA27595 00166003
*D082410,085141,095500,383610-383640,411901-411905,            @ZA28003 00172003
*D822810,822820-857204       ALSO SEE ZA14772                  @ZA28003 00178003
*********************************************************************** 00184003
*                                                                     * 00200020
* STATUS -- VS2 RELEASE 3 VERSION 0   SU                       @ZA01485 00240037
*                                                                     * 00280000
* FUNCTION -- THE RENAME COMMAND IS USED TO CHANGE THE NAME OF A DATA * 00320000
*    SET OR PARTITIONED DATA SET MEMBER OR TO CREATE AN ALIAS FOR AN  * 00360000
*    EXISTING MEMBER OF A PARTITIONED DATA SET.                       * 00400020
*                                                                     * 00440020
* ENTRY POINTS --                                                     * 00480020
*         IKJEHREN - MAIN ENTRY POINT OF PROGRAM, ATTACHED BY THE     * 00520020
*    TERMINAL MONITOR PROGRAM WHEN A RENAME COMMAND IS ENTERED AT THE * 00560020
*    TERMINAL                                                         * 00600020
*                                                                     * 00640020
* INPUT --  REGISTER 1 POINTS TO THE STANDARD COMMAND PROCESSOR       * 00680020
*    PARAMETER LIST (CPPL) AS FOLLOWS-                                * 00720020
*    WORD 1 CONTAINS A POINTER TO THE COMMAND BUFFER                  * 00760020
*    WORD 2 CONTAINS A POINTER TO THE USER PROFILE TABLE              * 00800020
*    WORD 3 CONTAINS A POINTER TO THE PROTECTED STEP CONTROL BLOCK    * 00840020
*    WORD 4 CONTAINS A POINTER TO AN ENVIRONMENT CONTROL TABLE        * 00880020
*                                                                     * 00920020
* OUTPUT -- NORMALLY NONE, EXCEPT APPROPRIATE ERROR MESSAGES TO       * 00960020
*    DESCRIBE ERROR CONDITIONS                                        * 01000020
*        R15 = X'00' NORMAL RETURN                             @ZA01485 01010037
*        R15 = X'0C' ERROR RETURN                              @ZA01485 01020037
*                                                                     * 01040020
* EXTERNAL REFERENCES --                                              * 01080020
*         IKJPARS - ENTRY POINT TO PARSE ROUTINE                      * 01120020
*         IKJDAIR - ENTRY POINT TO DYNAMIC ALLOCATION INTERFACE       * 01160020
*         ROUTINE                                                     * 01200000
*         IKJPUTL - ENTRY POINT TO PUTLINE ROUTINE                    * 01240020
*         IKJEHCIR - ENTRY POINT TO CATALOG INFORMATION ROUTINE       * 01280020
*         IKJDFLT - ENTRY POINT TO DEFAULT SERVICE ROUTINE            * 01300020
*         IKJEHSIR - ENTRY POINT FOR STAE INTERFACE ROUTINE           * 01320020
*                                                                     * 01360020
* EXITS, NORMAL -- RETURN TO THE TERMINAL MONITOR PROGRAM             * 01400020
*                                                                     * 01440020
* EXITS, ERROR -- RETURN TO THE TERMINAL MONITOR PROGRAM              * 01480020
*                                                                     * 01520020
* TABLES/WORK AREAS --                                                * 01560000
*    IHADCB - A DSECT TO MAP THE WORKAREA                             * 01640000
*                                                                     * 01720020
* ATTRIBUTES -- REENTRANT, READ-ONLY, REFRESHABLE                     * 01760020
*                                                                     * 01800020
* CHARACTER CODE DEPENDENCY -- CHARACTER CODE INDEPENDENT             * 01840000
*                                                                     * 01850000
* NOTES --                                                     @YL026YB 01860000
*    DESCRIBED IN TSO COMMAND PROCESSOR LOGIC, SY28-0652       @YL026YB 01870000
*                                                                     * 01880020
*********************************************************************** 01920020
         EJECT                                                          01960020
*              REGISTER EQUATES                                         02000020
R0       EQU   0                   GENERAL REGISTER 0                   02040020
R1       EQU   1                   GENERAL REGISTER 1                   02080020
R2       EQU   2                   GENERAL REGISTER 2                   02120020
R3       EQU   3                   GENERAL REGISTER 3                   02160020
R4       EQU   4                   GENERAL REGISTER 4                   02200020
R5       EQU   5                   GENERAL REGISTER 5                   02240020
R6       EQU   6                   GENERAL REGISTER 6                   02280020
R7       EQU   7                   GENERAL REGISTER 7                   02320020
R8       EQU   8                   GENERAL REGISTER 8                   02360020
R9       EQU   9                   GENERAL REGISTER 9                   02400020
R10      EQU   10                  GENERAL REGISTER 10                  02440020
R11      EQU   6                   GENERAL REGISTER 6                   02480020
R1X      EQU   11                  GENERAL REGISTER 11                  02520020
R12      EQU   12                  GENERAL REGISTER 12                  02560020
R13      EQU   13                  GENERAL REGISTER 13                  02600020
R14      EQU   14                  GENERAL REGISTER 14                  02640020
R15      EQU   15                  GENERAL REGISTER 15                  02680020
*                                                                       02720020
*              REGISTER USEAGE                                          02760000
*                                                                       02800020
*  REGISTER 0  USED AS WORK REGISTER                                    02840020
*                                                                       02880020
*  REGISTER 1  USED AS PARAMETER REGISTER AND AS WORK REGISTER          02920020
*                                                                       02960020
*  REGISTER 2  USED INITIALLY TO SAVE PARAMETER LIST POINTER, THEN AS   03000020
*              WORK REGISTER                                            03040020
*                                                                       03080020
*  REGISTER 3  USED IN 'EXECUTE MVC' AS POINTER TO 'TO AREA' AND AS     03120020
*              WORK REGISTER                                            03160020
*                                                                       03200020
*  REGISTER 4  USED IN 'EXECUTE MVC' AS POINTER TO 'FROM AREA' AND AS   03240020
*              WORK REGISTER                                            03280020
*                                                                       03320020
*  REGISTER 5  USED AS WORK REGISTER                                    03360020
*                                                                       03400020
*  REGISTER 6  USED AS WORK REGISTER                                    03440020
*                                                                       03480020
*  REGISTER 7  USED TO ADDRESS CONSTANTS FOR IKJEHRN2                   03520020
*                                                                       03560020
*  REGISTER 8  USED AS INDEX REGISTER FOR CIR WORKAREA (SET TO ZERO     03600020
*              WHEN NOT PROCESSING '*')                                 03640020
*                                                                       03680020
*  REGISTER 9  IS BASE REGISTER FOR PARSE DSECT                         03720020
*                                                                       03760020
*  REGISTER 10 USED AS WORK REGISTER                                    03800020
*                                                                       03840020
*  REGISTER 11 IS BASE REGISTER FOR GETMAIN COMMON AREA (DSECT)         03880020
*                                                                       03920020
*  REGISTER 12 IS BASE REGISTER FOR THIS PROGRAM                        03960020
*                                                                       04000020
*  REGISTER 13 IS THE SAVE AREA REGISTER                                04040020
*                                                                       04080020
*  REGISTER 14 IS THE LINK REGISTER                                     04120020
*                                                                       04160020
*  REGISTER 15 IS THE BRANCH REGISTER AND THE RETURN CODE REGISTER      04200020
*                                                                       04240020
         SPACE 2                                                        04280020
*  ABSOLUTE EQUATES (OFFSETS AND SHORT LENGTHS)                         04320020
ONE      EQU   1                   ONE                                  04360020
TWO      EQU   2                   TWO                                  04400020
F0       EQU   0                   ZERO                                 04440020
F1       EQU   1                   ONE                                  04480020
F2       EQU   2                   TWO                                  04520020
F4       EQU   4                   FOUR                                 04560020
F5       EQU   5                   FIVE                                 04600020
F6       EQU   6                   LENGTH OF A VOLUME SERIAL NUMBER     04640020
F7       EQU   7                   SEVEN                                04680020
F8       EQU   8                   EIGHT                                04720020
F12      EQU   12                  TWELVE                               04760020
F24      EQU   24                  TWENTY-FOUR                          04800020
F32      EQU   32                  THIRTY-TWO                           04840020
F16      EQU   16                  SIXTEEN                              04880020
F20      EQU   20                  TWENTY                               04920020
F43      EQU   43                  FORTY-THREE                 @YL026YB 04940000
F45      EQU   45                  FORTY-FIVE                           04960020
F36      EQU   36                  THIRTY-SIX                           05000020
F76      EQU   76                  SEVENTY-SIX                          05040020
F63      EQU   63                  SIXTY-THREE                          05080020
F46      EQU   46                  FORTY-SIX                            05160020
F9       EQU   9                   NINE                                 05200020
F11      EQU   11                  ELEVEN                               05240020
L72      EQU   72                  LENGTH OF SAVEAREA                   05280020
F3       EQU   3                   THREE                                05320020
F44      EQU   44                  FORTY-FOUR                           05400020
F51      EQU   51                  FIFTY-ONE                            05440020
F52      EQU   52                  FIFTY-TWO                            05480020
*  RETURN CODE EQUATES                                                  05520020
RC4      EQU   4                   RETURN CODE = 4                      05560020
RC8      EQU   8                   RETURN CODE = 8                      05600020
RC12     EQU   12                  RETURN CODE = 12                     05640020
RC16     EQU   16                  RETURN CODE = 16                     05680020
RC20     EQU   20                  RETURN CODE = 20                     05720020
RC24     EQU   24                  RETURN CODE = 24                     05760020
RC28     EQU   28                  RETURN CODE = 28                     05800020
RC32     EQU   32                  RETURN CODE = 32                     05840020
RC36     EQU   36                  RETURN CODE = 36                     05880020
*  EQUATES FOR MESSAGE NUMBERS (FIRST LEVEL MESSAGES)                   05920020
M01      EQU   1                   MESSAGE NUMBER 01                    05960020
M02      EQU   2                   MESSAGE NUMBER 02                    06000020
M03      EQU   3                   MESSAGE NUMBER 03                    06040020
M04      EQU   4                   MESSAGE NUMBER 04                    06080020
M05      EQU   5                   MESSAGE NUMBER 05                    06120020
M06      EQU   6                   MESSAGE NUMBER 06                    06160020
M07      EQU   7                   MESSAGE NUMBER 07                    06200020
M08      EQU   8                   MESSAGE NUMBER 08                    06240020
M09      EQU   9                   MESSAGE NUMBER 09                    06280020
M10      EQU   10                  MESSAGE NUMBER 10                    06320020
M11      EQU   11                  MESSAGE NUMBER 11                    06360020
M12      EQU   12                  MESSAGE NUMBER 12                    06400020
M13      EQU   13                  MESSAGE NUMBER 13                    06440020
M14      EQU   14                  MESSAGE NUMBER 14                    06480020
M15      EQU   15                  MESSAGE NUMBER 15                    06520020
M16      EQU   16                  MESSAGE NUMBER 16                    06560020
M17      EQU   17                  MESSAGE NUMBER 17                    06600020
M18      EQU   18                  MESSAGE NUMBER 18                    06640020
M19      EQU   19                  MESSAGE NUMBER 19                    06680020
M20      EQU   20                  MESSAGE NUMBER 20                    06720020
M21      EQU   21                  MESSAGE NUMBER 21                    06760020
M22      EQU   22                  MESSAGE NUMBER 22                    06800020
M23      EQU   23                  MESSAGE NUMBER 23                    06840020
M24      EQU   24                  MESSAGE NUMBER 24                    06880020
M25      EQU   25                  MESSAGE NUMBER 25                    06920020
M26      EQU   26                  MESSAGE NUMBER 26                    06960020
M27      EQU   27                  MESSAGE NUMBER 27                    07000020
M28      EQU   28                  MESSAGE NUMBER 28                    07020020
M29      EQU   29                  MESSAGE NUMBER 29                    07030020
*  EQUATES FOR MESSAGE NUMBERS (SECOND LEVEL MESSAGES)                  07040020
S01      EQU   1                   SECOND LEVEL MESSAGE NUMBER 01       07080020
S02      EQU   2                   SECOND LEVEL MESSAGE NUMBER 02       07120020
S03      EQU   3                   SECOND LEVEL MESSAGE NUMBER 03       07160020
S04      EQU   4                   SECOND LEVEL MESSAGE NUMBER 04       07200020
S05      EQU   5                   SECOND LEVEL MESSAGE NUMBER 05       07240020
S06      EQU   6                   SECOND LEVEL MESSAGE NUMBER 06       07280020
S07      EQU   7                   SECOND LEVEL MESSAGE NUMBER 07       07320020
S08      EQU   8                   SECOND LEVEL MESSAGE NUMBER 08       07360020
S09      EQU   9                   SECOND LEVEL MESSAGE NUMBER 09       07400020
S10      EQU   10                  SECOND LEVEL MESSAGE NUMBER 10       07440020
S11      EQU   11                  SECOND LEVEL MESSAGE NUMBER 11       07480020
S12      EQU   12                  SECOND LEVEL MESSAGE NUMBER 12       07520020
S13      EQU   13                  SECOND LEVEL MESSAGE NUMBER 13       07560020
S14      EQU   14                  SECOND LEVEL MESSAGE NUMBER 14       07600020
S15      EQU   15                  SECOND LEVEL MESSAGE NUMBER 15       07640020
S16      EQU   16                  SECOND LEVEL MESSAGE NUMBER 16       07680020
S17      EQU   17                  SECOND LEVEL MESSAGE NUMBER 17       07720020
S18      EQU   18                  SECOND LEVEL MESSAGE NUMBER 18       07760020
S19      EQU   19                  SECOND LEVEL MESSAGE NUMBER 19       07800020
S20      EQU   20                  SECOND LEVEL MESSAGE NUMBER 20       07840020
S21      EQU   21                  SECOND LEVEL MESSAGE NUMBER 21       07880020
S22      EQU   22                  SECOND LEVEL MESSAGE NUMBER 22       07920020
S23      EQU   23                  SECOND LEVEL MESSAGE NUMBER 23       07960020
S24      EQU   24                  SECOND LEVEL MESSAGE NUMBER 24       08000020
S25      EQU   25                  SECOND LEVEL MESSAGE NUMBER 25       08040020
S26      EQU   26                  SECOND LEVEL MESSAGE NUMBER 26       08080020
S27      EQU   27                  SECOND LEVEL MESSAGE NUMBER 27       08120020
S28      EQU   28                  SECOND LEVEL MESSAGE NUMBER 28       08160020
S29      EQU   29                  SECOND LEVEL MESSAGE NUMBER 29       08200020
S30      EQU   30                  SECOND LEVEL MESSAGE NUMBER 30       08240020
*              OTHER EQUATES                                            08280020
STAR     EQU   C'*'                ASTERISK                             08320020
PERIOD   EQU   C'.'                PERIOD                               08360020
BLANK    EQU   C' '                BLANK                                08400020
QUOTE    EQU   C''''               CHARACTER QUOTE                      08420020
ZONE     EQU   C'0'                CHARACTER CONSTANT FOR ZONE FIELD    08440020
ZERO     EQU   X'00'               ZERO                                 08480020
FOXZERO  EQU   C'0'                CHARACTER ZERO                       08500020
CHARG    EQU   C'G'                CHARACTER G                          08510020
CHARV    EQU   C'V'                CHARACTER V                          08512020
COMPZONE EQU   X'F0'               MASK TO TEST FOR GENERATION NAME     08514020
QUOTEMSK EQU   X'40'               MASK TO CHECK IF DSNAME IN QUOTES    08520020
INDEXTST EQU   X'C1'               INDEX NAME (CIR)            @YL026YB 08560000
GDGNTST  EQU   X'02'               GENERATION DATA GROUP NAME (CIR)     08600020
NAMETST  EQU   X'07'               DATA SET NAME (CIR)                  08640020
TTRSIGN  EQU   X'80'               TTR INDICATOR (CIR)                  08680020
ENDTEST  EQU   X'FF'               LIST END (CIR)                       08720020
NAMESOPT EQU   X'01'               OPTION BYTE FOR DATA SET NAMES (CIR) 08760020
INDEXOPT EQU   X'02'               OPTION BYTE FOR INDEX NAMES (CIR)    08800020
PDSTEST  EQU   X'02'               MASK TO CHECK DATA SET ORGANIZATION  08840020
DAIROPTA EQU   X'08'               OPTION BYTE FOR DATA SET ALLOCATION  08880020
DAIROPTU EQU   X'18'               OPTION BYTE FRO DATASET UNALLOCATION 08920020
NAMECHCK EQU   X'03'               MASK TO CHECK IF NAME ON VOLUME      09000020
BADPASWD EQU   2                   MASK TO CHECK IF PASSWORD BAD        09010020
EQ       EQU   8                   MASK TO TEST CONDITION CODE EQUAL    09020020
SWON     EQU   X'FF'               MASK FOR SWITCH ON                   09040020
SWOFF    EQU   X'00'               MASK FOR SWITCH OFF                  09080020
MASK1    EQU   X'40'               MASK TO CHECK FOR INTERRUPT          09120020
ALIAS    EQU   X'80'               MASK TO INDICATE MEMBER IS ALIAS     09160020
SPNUM    EQU   1                   SUBPOOL NUMBER FOR GETMAIN           09200020
VOLLENTH EQU   12                  LENGTH OF VOLUME ENTRY FROM LOCATE   09240020
GDGLENTH EQU   16                  LENGTH OF GDG ENTRY IN CIR LIST      09280020
VOLCOUNT EQU   1                   MAXIMUM NUMBER OF VOLUMES            09320020
PERMALC  EQU   X'10'               INDICATE UNALLOC PERMANENTLY ALLOC   09330020
         EJECT                                                          09360020
         SPACE                                                          09400020
         SAVE  (14,12)             SAVE REGISTERS OF CALLING PROGRAM    09440037
         LR    R12,R15             ENTRY POINT ADDRESS TO BASE REGISTER 09480020
         USING IKJEHREN,R12        ESTABLISH ADDRESSABILITY FOR PROGRAM 09520020
         B     BRID                BRANCH AROUND ID            @ZA01485 09530037
         DC    C'IKJEHREN'         MODULE ID                   @ZA01485 09540037
         DC    X'7349'             DATE 12/15/77               @ZA27595 09550003
BRID     EQU   *                                               @ZA01485 09552037
         LR    R2,R1               SAVE CONTENTS OF REGISTER 1 IN       09560020
*                                  REGISTER 2 - GETMAIN USES REGISTER 1 09600020
         GETMAIN R,LV=CORE,SP=SPNUM GET CORE FOR SAVEAREA AND WORKAREA  09640020
*  THIS IS AN UNCONDITIONAL REQUEST FOR CORE.  IF SUFFICIENT CORE IS    09680020
*  NOT AVAILABLE THE RESULT IS ABNORMAL TERMINATION OF THIS PROGRAM.    09720020
*  THE FIRST 96 BYTES IS DCB, NEXT 18 WORDS IS REGISTER SAVE AREA.      09760020
         LR    R1X,R1              ADDRESS OF GETMAIN AREA              09800020
         USING IHADCB,R1X          ESTABLISH ADDRESSABILITY WORKAREA    09840020
         LA    R1,SAVEAREA         ADDRESS OF REGISTER SAVE AREA        09880020
         XC    F0(L72,R1),F0(R1)   INITIALIZE REGISTER SAVE AREA        09920020
         ST    R13,F4(R1)          SAVE ADDRESS OF CALLER'S REGISTERS   09960020
         ST    R1,F8(R13)          CHAIN SAVE AREAS                     10000020
         LR    R13,R1              REGISTER 13 POINTS TO SAVEAREA       10040020
*  REGISTER 2 POINTS TO COMMAND PROCESSOR PARAMETER LIST (CPPL)         10080020
         ST    R2,TMPSR1           SAVE TMP'S REGISTER 1                10100020
*  WHEN THE TMP ATTACHES RENAME REGISTER 1 POINTS TO A PARAMETER LIST   10120020
*  THE FORMAT OF THE TMP PARAMETER LIST IS-                             10160020
*     1ST WORD POINTER TO THE COMMAND BUFFER                            10200020
*     2ND WORD POINTER TO THE USER PROFILE TABLE                        10240020
*     3RD WORD POINTER TO THE PROTECTED STEP CONTROL BLOCK              10280020
*     4TH WORD POINTER TO THE ENVIRONMENT CONTROL TABLE                 10320020
         MVC   PUT(PUTLEND-PUTL),PUTL INITIALIZE PUTLINE PARM BLOCK     10360020
         MVI   ENDERROR,SWOFF      TURN OFF END ERROR SWITCH            10400020
         MVI   STACKSW,SWOFF       TURN STACK SWITCH OFF                10450020
         MVI   DEFLTSW,SWOFF       TURN OFF DEFAULT SWITCH              10480020
         MVI   RENERRSW,SWOFF      INITIALIZE SWITCH OFF                10520020
         MVI   ERRORSW,SWOFF       TURN ERROR SWITCH OFF                10540020
         MVI   MEM2SW,SWOFF        TURN OFF MEM2 SWITCH                 10550020
         LA    R3,LEVELSCN         POINT TO SCAN BUFFER                 10560020
         MVI   F8(R3),BLANK        BLANK LAST BYTE OF SCAN FIELD        10600020
         LA    R4,LISTSCN          POINT TO LIST BUFFER        @YL026YB 10610000
         MVI   F44(R4),BLANK       PUT BLANK IN LAST BYTE      @YL026YB 10620000
         MVI   ISWITCH,INDEXTST    INITIALIZE SWITCH TO OFF (ZERO)      10640020
         MVI   UNALOCSW,SWOFF      INITIALIZE SWITCH TO OFF (ZERO)      10680020
         SR    R8,R8               INDEX REGISTER TO CIR WORKAREA, SET  10720020
*                                  TO ZERO INDICATES NOT PROCESSING *   10760020
         USING CPPL,R2             ADDRESSABILITY CPPL                  10800020
         LA    R9,PARSPARM         POINT TO SPACE FOR PARSE PARMETERS   10840020
         USING PPL,R9              ADDRESSABILITY PARSE PARMLIST        10880020
         LA    R4,DFLTPARM         POINT TO SPACE FOR DEFAULT PARMLIST  10920020
         USING DFPL,R4             ADDRESSABILITY DEFAULT PARMLIST      10960020
         LA    R5,DFLTPBLK         POINT TO SPACE DEFAULT PARMBLOCK     11000020
         USING DFPB,R5             ADDRESSABILITY DEFAULT PARM BLOCK    11040020
         LA    R6,IOPARM           POINT TO SPACE FOR I/O PARM LIST     11080020
         USING IOPL,R6             ADDRESSABILITY I/O PARM LIST         11120020
         LA    R10,DAIRPARM        POINT TO SPACE FOR DAIR PARM LIST    11160020
         USING DAPL,R10            ADDRESSABILITY DAIR PARM LIST        11200020
*  INITIALIZE PARAMETERS FOR PARSE, DAIR, DEFAULT, AND PUTLINE          11240020
         L     R3,CPPLCBUF         COMMAND BUFFER POINTER               11280020
         ST    R3,PPLCBUF          - TO PARSE PARAMETER LIST            11320020
         L     R3,CPPLUPT          UPT POINTER                          11360020
         ST    R3,IOPLUPT          - TO I/O PARAMETER LIST              11400020
         ST    R3,PPLUPT           - TO PARSE PARAMETER LIST            11440020
         ST    R3,DAPLUPT          - TO DAIR PARAMETER LIST             11480020
         ST    R3,DFPLUPT          - TO DEFAULT PARAMETER LIST          11520020
         ST    R3,UPTSAVE          - SAVE UPT  ADDRESS                  11560000
         L     R3,CPPLPSCB         PSCB POINTER                         11600000
         ST    R3,DAPLPSCB         - TO DAIR PARAMETER LIST             11640020
         ST    R3,DFPBPSCB         - TO DEFAULT PARAMETER BLOCK         11680020
         L     R3,CPPLECT          ECT POINTER                          11720020
         ST    R3,IOPLECT          - TO I/O PARAMETER LIST              11760020
         ST    R3,PPLECT           - TO PARSE PARAMETER LIST            11800020
         ST    R3,DAPLECT          - TO DAIR PARAMETER LIST             11840020
         ST    R3,DFPLECT          - TO DEFAULT PARAMETER LIST          11880020
         DROP  R2                  CPPL IS NO LONGER NEEDED             11920020
         LA    R2,RENCPECB         POINT TO CP'S ECB                    11960020
         ST    R2,IOPLECB          - TO I/O PARAMETER LIST              12000020
         ST    R2,PPLECB           - TO PARSE PARAMETER LIST            12040020
         ST    R2,DAPLECB          - TO DAIR PARAMETER LIST             12080020
         ST    R2,DFPLECB          - TO DEFAULT PARAMETER LIST          12120020
         ST    R5,DFPLDFPB         PARM BLOCK POINTER TO PARM LIST      12160020
         ST    R8,CIRADDR          ZERO ADDRESS OF CIR (NOT LOADED)     12200020
         ST    R8,RENCPECB         ZERO CP'S ECB                        12240020
         ST    R8,PPLUWA           ZERO UNUSED PARAMETER                12280020
         ST    R8,DFPBQUAL         ZERO POINTER TO DEFAULT QUALIFIER    12320020
         ST    R8,CIRPARM          CLEAR FIRST WORD OF PARAMETER LIST   12330020
         ST    R8,VOLIDPTR         INITIALIZE TO ZERO (DEFAULT SYSRES)  12340020
         L     R3,VCONPARS         ADDRESS OF PARSE MACROS              12360020
         ST    R3,PPLPCL           SET PARSE CONTROL LIST POINTER       12400020
         LA    R3,ANSPLACE         ADDRESS OF PARSE ANSWER PLACE        12440020
         ST    R3,PPLANS           SET PARSE ANSWER PLACE POINTER       12480020
         DROP  R4                  DFPL NO LONGER NEEDED                12520020
         DROP  R6                  IOPL NO LONGER NEEDED                12560020
         DROP  R9                  PPL NO LONGER NEEDED                 12600020
         DROP  R10                 DAPL NO LONGER NEEDED                12640020
* NOW MOVE MACROS TO GETMAIN AREA                                       12680020
         MVC   RENAMLST(CLSTEND-RENLST),RENLST MOVE CAMLST MACROS       12720020
         MVC   IHADCB(DCBEND-DCB),DCB  MOVE DCB                         12760020
         MVC   OPEN(OPENEND-OPN),OPN MOVE OPEN MACRO                    12800020
         MVC   CLOSE(CLOSEEND-CLSE),CLSE MOVE CLOSE MACRO               12840020
         LR    R2,R1X              ADDRESS OF DCB                       12880020
         O     R2,OPEN             OR IN OPEN OPTION CODE, THEN         12920020
         ST    R2,OPEN             PUT CODE AND ADDRESS IN OPEN MACRO   12960020
         LR    R2,R1X              ADDRESS OF DCB                       13000020
         O     R2,CLOSE            OR IN CLOSE OPTION CODE, THEN        13040020
         ST    R2,CLOSE            PUT CODE AND ADDRESS IN CLOSE MACRO  13080020
*  INITIALIZE DAIR PARAMETER LIST TO ALLOCATE DATA SET                  13120020
         LA    R4,DAIR08           POINT TO DAIR ENTRY 08               13160020
         USING DAPB08,R4           ADDRESSABILITY FOR DAIR ENTRY 08     13200020
         LA    R6,DAIR18           POINT TO DAIR ENTRY 18               13240020
         USING DAPB18,R6           ADDRESSABILITY DAIR ENTRY 18         13280020
         XC    DAIR08(DLSTEND-DAIR08),DAIR08 ZERO DAIR LISTS            13320020
         MVI   DA08CD+F1,DAIROPTA  SET OPTION FOR ALLOCATION            13360020
         MVI   DA08UNIT,BLANK      BLANK SIX                            13400020
         MVC   DA08UNIT+F1(F7),DA08UNIT BLANK UNIT NAME                 13440020
         MVC   DA08SER(F8),DA08UNIT BLANK VOLUME SERIAL NUMBER          13480020
         MVC   DA08MNM(F8),DA08SER BLANK MEMBER NAME                    13520020
         LA    R2,DSLO             ADDRESS OF DSL-DSN BUFFER            13560020
         ST    R2,DA08PDSN         POINT TO DSL-DSN BUFFER              13600020
*  INITIALIZE DAIR PARAMETER LIST TO UNALLOCATE DATA SET                13640020
         MVI   DA18CD+F1,DAIROPTU  SET TO UNALLOCATE DATA SET           13680020
         MVC   DA18MNM(F8),DA08SER BLANK MEMBER NAME                    13720020
         MVC   DA18JBNM(F8),DA08SER BLANK JOBNAME                       13760020
         MVC   DA18SCLS(F2),DA08SER  BLANK SYSOUT CLASS        @VS06880 13780000
*  INITIALIZE DEFAULT SERVICE ROUTINE PARAMETER LIST                    13800020
         ST    R2,DFPBDSN          POINT TO DSL-DSN BUFFER              13840020
         MVI   DFPBCODE,DFPB04     SET OPTION FOR DEFAULT ROUTINE       13880020
         MVI   DFPBCNTL,DFPBUID+DFPBRET SET CONTROL BYTE                13920020
         LA    R2,QUALBUFF         QUALIFIER BUFFER                     13930020
         ST    R2,DFPBQUAL         ADDRESS TO PARM LIST                 13940020
         DROP  R4                  DAPB08 NO LONGER NEEDED              13960020
         DROP  R5                  DFPB NO LONGER NEEDED                14000020
         DROP  R6                  DAPB18 NO LONGER NEEDED              14040020
*  LOAD DAIR ROUTINE                                                    14360020
         LOAD  EP=IKJDAIR          LOAD DAIR                            14400020
         ST    R0,DAIRADDR         SAVE ADDRESS OF DAIR                 14440020
         MVI   RCX,ZERO            ZERO RC SAVE AREA           @ZA01485 14442037
*  NOW LOAD CATALOG INFORMATION ROUTINE                                 14450020
         LOAD  EP=IKJEHCIR         LOAD CIR                             14460020
         ST    R0,CIRADDR          SAVE ADDRESS OF CIR                  14470020
         MVI   NAMEPTR,ZERO        ZERO HIGH ORDER BYTE                 14472020
         MVI   CIRFLAG,SWOFF       SET SWITCH OFF                       14474020
         MVI   STARSW,SWOFF        TURN STAR SWITCH OFF                 14476020
         LA    R2,STARLIST         BEGINNING OF STARLIST                14478020
         ST    R2,STARPTR          POINT TO NEXT EMPTY SLOT             14478420
*  NOW BLANK ALL DATA SET BUFFERS                                       14480020
         MVI   DSNBUFFO,BLANK      BLANK                                14520020
         MVC   DSNBUFFO+F1(F51),DSNBUFFO OLD DSNAME BUFFER              14560020
         MVC   QUALBUFF(F8),DSNBUFFO BLANK QUALIFIER RETURN BUFFER      14570020
         MVC   DSNBUFFN(F52),DSNBUFFO NEW DSNAME BUFFER                 14600020
         MVC   DSNO(F44),DSNBUFFO  OLD DATA SET NAME BUFFER             14640020
         MVC   DSNN(F44),DSNBUFFO  NEW DATA SET NAME BUFFER             14680020
         MVI   NAMETTR,BLANK       BLANK CIR BUFFER            @YL026YB 14680300
         MVC   NAMETTR+F1(F43),NAMETTR BLANKS IN CIR BUFFER    @YL026YB 14680600
         XC    STAELIST(STAELNTH),STAELIST CLEAR AREA FOR STAE BLOCKS   14681020
         LOAD  EP=IKJEHSIR         LOAD STAE INTERFACE ROUTINE          14682020
         ST    R0,STAEADDR         SAVE ADDRESS OF STAE ROUTINE         14683020
BLDSTAE  PSEUDO TMP=TMPSR1,MF=E                                         14684020
         L     R4,VCON713          ADDRESS OF RETRY ROUTINE             14685020
         STABUILD CODE=713,RTN=(R4),ADDR=STAEONE,FLAG=(ONE,NMSG),      X14686020
               NUM=4,MF=E                                               14687020
         L     R4,VCON913          ADDRESS OF RETRY ROUTINE             14688020
         STABUILD CODE=913,RTN=(R4),ADDR=STAETWO,FLAG=(ONE,NMSG),      X14689020
               MF=E                                                     14690020
         L     R4,VCON13           ADDRESS OF RETRY ROUTINE             14691020
         STABUILD CODE=(113,213,313,A13),RTN=(R4),ADDR=STAETHRE,       X14692020
               FLAG=(MUL,NMSG),LIST=STAELST,                           X14693020
               MF=E                                                     14694020
         L     R4,VCONLTST         ADDRESS OF RETRY ROUTINE             14695020
         STABUILD CODE=000,RTN=(R4),ADDR=STAEFOUR,FLAG=(ALL,END),      X14696020
               MF=E                                                     14697020
         STAEPARM FLAG=(CP),PSEUDO=$PSEUDO,LIST=STAEONE,ADDR=STAEPARM, X14698020
               MF=E                                                     14699020
         L     R2,STAEADDR         ADDRESS OF STAE INTERFACE ROUTINE    14700020
         STAE  (R2),CT,PARAM=STAEPARM,MF=(E,STAELIST) ISSUE STAE        14701020
         LR    R1,R9               POINT TO PARSE PARAMETER LIST        14711020
*  WHEN THE PARSE SERVICE ROUTINE IS ENTERED REGISTER 1 POINTS TO THE   14713020
*  FOLLOWING PARAMETER LIST-                                            14715020
*     1ST WORD POINTER TO THE USER PROFILE TABLE                        14717020
*     2ND WORD POINTER TO THE ENVIRONMENT CONTROL TABLE                 14719020
*     3RD WORD POINTER TO THE COMMAND PROCESSOR'S EVENT CONTROL BLOCK   14719420
*     4TH WORD POINTER TO PARSE CONTROL LIST                            14719820
*     5TH WORD POINTER TO THE PARSE ANSWER PLACE                        14719920
*     6TH WORD POINTER TO THE COMMAND BUFFER                            14720020
*     7TH WORD POINTER TO THE USER WORK AREA (VALIDITY EXIT ROUTINE)    14722020
*  PARSE THE RENAME COMMAND                                             14724020
         LINK  EP=IKJPARS          PARSE RENAME COMMAND                 14726020
         L     R9,ANSPLACE         PARSE PUT RENPARM ADDRESS HERE       14726420
         ST    R9,$RETRY0+R9*F4    SAVE REG FOR STAE RECOVERY           14726820
         L     R12,VCONRN2         LOAD ADDRESS OF SECOND CSECT         14728020
         ST    R12,$RETRY0+R12*F4  SAVE BASE REG FOR STAE RECOVERY      14730020
         BR    R12                 GO TO SECOND CSECT                   14760020
         EJECT                                                          14800020
*                                                                       14840020
*              WORKAREA - REQUIRED CONSTANTS (IKJEHREN)                 14880020
*                                                                       14920020
VCONPARS DC    V(IKJEHPDL)         PARSE PARAMETERS RENAME COMMAND      14960020
VCONRN2  DC    V(IKJEHRN2)         ENTRY POINT SECOND CSECT             15000020
VCON713  DC    V(IKJEH713)         713 ABEND ROUTINE                    15008020
VCON913  DC    V(IKJEH913)         913 ABEND ROUTINE                    15016020
VCON13   DC    V(IKJEH13)          13 TYPE ABENDS ROUTINE               15024020
VCONLTST DC    V(IKJEHTST)         RETRY ROUTINE                        15032020
DCB      DCB   DSORG=PO,MACRF=W                                         15040020
DCBEND   EQU   *                   END OF DCB                           15080020
OPN      OPEN  (0,OUTPUT),MF=L     LIST FORM OF OPEN                    15120020
OPENEND  EQU   *                   END OF OPEN                          15160020
CLSE     CLOSE 0,MF=L              LIST FORM OF CLOSE                   15200020
CLOSEEND EQU   *                   END OF CLOSE                         15240020
PUTL     PUTLINE  MF=L             LIST FORM OF PUTLINE                 15280020
PUTLEND  EQU   *                   END OF PUTLINE EXPANSION             15320020
*  KEEP CAMLST MACROS TOGETHER, MOVED AS ONE BLOCK                      15360020
*              RENAME MACRO CAMLST                                      15400020
RENLST   CAMLST RENAME,0,0,0       RENAME MACRO                         15440020
*        UNCATALOG MACRO CAMLST                                         15480020
UNCLST   CAMLST UCATDX,0           UNCATALOG MACRO                      15520020
*              LOCATE MACRO CAMLST (BY DATA SET NAME)                   15560020
LNAME    CAMLST NAME,0,,0          LOCATE MACRO                         15600020
*              CATALOG MACRO CAMLST                                     15640020
CLST     CAMLST CATBX,0,,0         CATALOG MACRO                        15740020
CLSTEND  EQU   *                   END OF CAMLSTS                       15880020
*              END OF CAMLST MACROS                                     15920020
         EJECT                                                          15960020
IKJEHRN2 CSECT                                                          16000020
         ENTRY IKJEH713,IKJEH913,IKJEH13,IKJEHTST                       16020020
*  CONTROL IS PASSED HERE FROM IKJEHREN WHEN INITIALIZATION IS COMPLETE 16040020
*  REGISTER 12 CONTAINS ENTRY POINT ADDRESS                             16080020
*  REGISTER 11 CONTAINS WORKAREA ADDRESS                                16120020
*  REGISTER 15 CONTAINS THE PARSE RETURN CODE                           16160020
*  REGISTER 9 CONTAINS PARSE DSECT ADDRESS                              16170020
         USING IKJEHRN2,R12        ESTABLISH ADDRESSABILITY FOR PROGRAM 16200020
         LA    R7,RN2CNSTS         POINT TO CONSTANTS                   16210020
         USING RN2CNSTS,R7         ADDRESSABILITY FOR CONSTANTS         16220020
         ST    R7,$RETRY0+R7*F4    SAVE REG FOR STAE RECOVERY    A48485 16230021
         USING IHADCB,R1X          ESTABLISH ADDRESSABILITY WORKAREA    16240020
         LTR   R15,R15             TEST PARSE RETURN CODE               16760020
         BNZ   PARSEERR            NON-ZERO RETURN CODE, PARSE ERROR    16800020
* ESTABLISH ADDRESSABILITY FOR PARSE DSECT                              16840020
         USING IKJPARMD,R9         ESTABLISH ADDRESSABILITY PARSE PDL   16920020
*  THE FORMAT OF THE LIST RETURNED FROM PARSE IS AS FOLLOWS-            16960020
*  TWO SIX WORD LISTS LABELED DSNAME1 AND DSNAME2 AS FOLLOWS            17000020
*     1ST WORD POINTER TO DATA SET NAME                                 17040020
*     2ND WORD BYTE 0-1 LENGTH OF DATA SET NAME (EXCLUDING QUOTES)      17080020
*              BYTE 2   FLAGS (BIT 1 IS 1 IF DATA SET NAME QUOTED)      17120020
*              BYTE 3   RESERVED                                        17160020
*     3RD WORD POINTER TO MEMBER NAME (ZERO IF MISSING)                 17200020
*     4TH WORD BYTE 0-1 LENGTH OF MEMBER NAME (EXCLUDING PARENTHESES)   17240020
*              BYTE 2   FLAGS                                           17280020
*              BYTE 3   RESERVED                                        17320020
*     5TH WORD POINTER TO PASSWORD (ZERO IF MISSING)                    17360020
*     6TH WORD BYTE 0-1 LENGTH OF PASSWORD                              17400020
*              BYTE 2   FLAGS                                           17440020
*              BYTE 3   RESERVED                                        17480020
*                                                                       17520020
*     AN ADDITIONAL TWO BYTES LABELED RENTYPE                           17560020
*        A 0 INDICATES NO KEYWORD SPECIFIED                             17600020
*        A 1 INDICATES 'ALIAS' KEYWORD SPECIFIED                        17640020
*  NOW PROCESS FIRST DATA SET NAME                                      17680020
         SR    R2,R2               ZERO REGISTER                        17720020
*  SET REGISTER 5 AS INDEX FOR PARSE DESCRIPTOR ENTRY FIRST DSNAME      17760020
         LA    R5,DSNAME1          POINT TO PDE FOR FIRST DSNAME        17800020
         C     R2,F0(R5)           IS DSNAME POINTER ZERO               17840020
         BE    NODSN1              ERROR, NO DSNAME1 SPECIFIED          17880020
*  MOVE FIRST DATA SET NAME TO FIRST DSLENGTH AND DSNAME BUFFER         17920020
         L     R4,F0(R5)           ADDRESS OF DATA SET NAME FROM PARSE  17960020
         LH    R2,F4(R5)           LENGTH OF DATA SET NAME FROM PARSE   18000020
         LTR   R2,R2               TEST DATA SET LENGTH                 18040020
         BZ    NODSN1              LENGTH ZERO IS ERROR                 18080020
         STH   R2,DSLO             SAVE DATA SET LENGTH                 18120020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    18160020
         LA    R3,DSNO             ADDRESS OF BUFFER FIRST DSNAME       18200020
         EX    R2,MOVEINST         MOVE FIRST DATA SET NAME TO BUFFER   18240020
*  MOVE FIRST DATA SET NAME TO MESSAGE BUFFER                           18280020
         LA    R3,DSNMSG1          POINT TO DSNAME1 MESSAGE BUFFER      18320020
         TM    F6(R5),QUOTEMSK     IS FIRST DSNAME FULLY QUALIFIED      18330020
         BZ    SAVUNQL1            NO, SAVE UNQUALIFIED DSNAME          18340020
         BAL   R14,QUOTEDSN        SAVE QUOTED DATA SET NAME            18350020
SAVELN1  STH   R2,DSNMSGL1         SAVE LENGTH FOR MESSAGE INSERTIONS   18440020
*  MOVE MEMBER NAME TO MESSAGE BUFFER                                   18480020
         LH    R2,F12(R5)          LENGTH OF MEMBER NAME                18560020
         LTR   R2,R2               WAS MEMBER NAME SPECIFIED            18600020
         BZ    QTEST1              NO MEMBER SPECIFIED                  18640020
         LA    R3,MEMMSG1          MEMBER MESSAGE BUFFER                18680020
         BAL   R14,MEMBUFF         SAVE MEMBER NAME                     18690020
         STH   R2,MEMMSGL1         SAVE LENGTH OF INSERTION             18840020
QTEST1   TM    F6(R5),QUOTEMSK     DSNAME FULLY QUALIFIED               18890020
         BZ    ADUSRID1            NO, GO ADD USERID                    18940020
NOMEM1   MVC   DSBLO(F46),DSLO     FIRST DSLENGTH-DSNAME TO * BUFFER    18960020
SCANDSN1 LA    R2,DSNBUFFO         REGISTER 2 POINTS TO FIRST DSNAME    19000020
         LH    R3,DSBLO            LENGTH OF FIRST DATA SET NAME        19040020
         L     R15,VCONRN3         ADDRESS OF ASTERISK SCAN ROUTINE     19050020
         BALR  R14,R15             GO SCAN FOR ASTERISK                 19080020
         B     STARERR4            ERROR                                19120020
         B     STARERR8            ERROR                                19160020
         MVC   STARLEV1(F1),STARLEV2 SAVE ASTERISK LEVEL                19200020
         MVC   STARADR1(F4),STARADR2 SAVE ASTERISK ADDRESS              19240020
*  NOW PROCESS SECOND DATA SET NAME                                     19280020
         SR    R2,R2               ZERO REGISTER                        19320020
*  SET REGISTER 5 AS INDEX FOR PARSE DESCRIPTOR ENTRY SECOND DSNAME     19360020
         LA    R5,DSNAME2          POINT TO PDE FOR SECOND DSNAME       19400020
         C     R2,F0(R5)           IS DSNAME POINTER ZERO               19440020
         BE    NODSN2              NO DSNAME2 SPECIFIED, CHECK IF VALID 19480020
*  MOVE SECOND DATA SET NAME TO SECOND DSLENGTH AND DSNAME BUFFER       19520020
         L     R4,F0(R5)           ADDRESS OF DATA SET NAME FROM PARSE  19560020
         LH    R2,F4(R5)           LENGTH OF DATA SET NAME FROM PARSE   19600020
         LTR   R2,R2               TEST DATA SET LENGTH                 19640020
         BZ    NODSN2              LENGTH ZERO, CHECK IF VALID          19680020
         STH   R2,DSLN             SAVE DATA SET LENGTH                 19720020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    19760020
         LA    R3,DSNN             ADDRESS OF BUFFER SECOND DSNAME      19800020
         EX    R2,MOVEINST         MOVE SECOND DATA SET NAME TO BUFFER  19840020
*  MOVE SECOND DATA SET NAME TO MESSAGE BUFFER                          19880020
         LA    R3,DSNMSG2          POINT TO DSNAME2 MESSAGE BUFFER      19920020
         TM    F6(R5),QUOTEMSK     IS SECOND DSNAME FULLY QUALIFIED     19930020
         BZ    SAVUNQL2            NO, SAVE UNQUALIFIED DSNAME          19940020
         BAL   R14,QUOTEDSN        SAVE QUOTED DATA SET NAME            19950020
SAVELN2  STH   R2,DSNMSGL2         SAVE LENGTH FOR MESSAGE INSERTIONS   20040020
*  MOVE MEMBER NAME TO MESSAGE BUFFER                                   20080020
MEM2     LH    R2,F12(R5)          LENGTH OF MEMBER NAME                20160020
         LTR   R2,R2               MEMBER SPECIFIED                     20200020
         BZ    QTEST2              NO MEMBER SPECIFIED                  20240020
         LA    R3,MEMMSG2          MEMBER MESSAGE BUFFER                20280020
         BAL   R14,MEMBUFF         SAVE MEMBER NAME                     20290020
         STH   R2,MEMMSGL2         SAVE LENGTH OF INSERTION             20440020
         CLI   MEM2SW,SWON         IS MEM2 SWITCH ON                    20450020
         BE    GOODSCAN            YES, NO DSN2, CONTINUE PROCESSING    20460020
QTEST2   TM    F6(R5),QUOTEMSK     DSNAME FULLY QUALIFIED               20510020
         BZ    ADUSRID2            NO, ADD USERID                       20520020
NOMEM2   MVC   DSBLN(F46),DSLN     SECOND DSLENGTH-DSNAME TO * BUFFER   20560020
SCANDSN2 LA    R2,DSNBUFFN         REGISTER 2 POINTS TO SECOND DSNAME   20600020
         LH    R3,DSBLN            LENGTH OF SECOND DATA SET NAME       20640020
         L     R15,VCONRN3         ADDRESS OF ASTERISK SCAN ROUTINE     20650020
         BALR  R14,R15             GO SCAN FOR ASTERISK                 20680020
         B     STARER4             ERROR                                20720020
         B     STARER8             ERROR                                20760020
         B     GOODSCAN            SUCCESSFUL SCAN                      20800020
QUOTEDSN MVI   F0(R3),QUOTE        MOVE QUOTE                           20810020
         LA    R3,F1(R3)           POINT PAST QUOTE                     20820020
         EX    R2,MOVEINST         MOVE DATA SET NAME TO BUFFER         20830020
         LA    R3,F1(R2,R3)        POINT PAST DSNAME                    20832020
         MVI   F0(R3),QUOTE        MOVE QUOTE                           20834020
         LA    R2,F7(R2)           1 EXECUTE, 4 HEADER, 2 QUOTES        20836020
         BR    R14                 RETURN                               20838020
MEMBUFF  L     R4,F8(R5)           POINT TO MEMBER NAME                 20838420
         BCTR  R2,R0               DECREMENT FOR EXECUTE                20838820
         EX    R2,MOVEINST         MOVE MEMBER TO MESSAGE BUFFER        20839220
         LA    R2,F5(R2)           1 FOR EXECUTE, 4 FOR HEADER          20839620
         BR    R14                 RETURN                               20839720
*  NOW CHECK THAT ASTERISK IS AT SAME LEVEL IN BOTH DATA SET NAMES      22800020
GOODSCAN CLC   STARLEV1,STARLEV2   COMPARE LEVEL INDICATORS             22840020
         BNE   STARERR             ERROR, *'S NOT AT SAME LEVEL         22880020
*  NOW CHECK IF ASTERISK FOUND                                          22920020
         CLI   STARLEV1,ZERO       IS LEVEL INDICATOR ZERO              22960020
         BE    QUOTETST            IF SO, NO ASTERISK FOUND             23000020
         SR    R2,R2               ZERO REGISTER                        23040020
         LA    R5,DSNAME1          POINT TO PARSE PDE                   23080020
         C     R2,F8(R5)           WAS MEMBER SPECIFIED FIRST DSNAME    23120020
         BNE   STARMEM1            YES, ERROR                           23160020
         C     R2,F32(R5)          WAS MEMBER SPECIFIED SECOND DSNAME   23200020
         BNE   STARMEM2            YES, ERROR                           23240020
*                                                                       23280020
*  A VALID ASTERISK HAS BEEN FOUND IN THE DATA SET NAMES.  NOW          23320020
*  DETERMINE IF ASTERISK WAS IN INDEX LEVEL OR DATA SET NAME LEVEL      23360020
*  (LAST POSITION) OF DATA SET NAME.  SEPARATE ENTRY TO IKJEHCIR        23400020
*  (CATALOG INFORMATION ROUTINE) AND SEPARATE PROCESSING REQUIRED FOR   23440020
*  EACH CASE.                                                           23480020
*                                                                       23520020
*  INITIALIZE CATALOG INFORMATION ROUTINE PARAMETER LIST                23650000
         LH    R0,MINMAX           LENGTH OF GETMAIN AREA      @YL026YB 23660000
         LR    R3,R0               SAVE LENGTH                 @YL026YB 23670000
         O     R0,SUBPOL1          SET SUBPOOL NUMBER          @YL026YB 23680000
         GETMAIN R,LV=(0)          WORKAREA FOR CIR            @YL026YB 23690000
         LTR   R15,R15             TEST RETURN CODE            @YL026YB 23700000
         BZ    CIRPM               CONTINUE NORMALLY           @YL026YB 23710000
         SR    R8,R8               CLEAR ASTERISK INDICATOR    @YL026YB 23720000
         B     NOSPACE             GO WRITE MESSAGE            @YL026YB 23730000
CIRPM    LR    R2,R1               POINT TO CIR WORKAREA       @YL026YB 23740000
         STH   R3,F0(R2)           SAVE LENGTH OF WORKAREA     @YL026YB 23750000
         ST    R2,WORK1PTR         SET POINTER TO WORK AREA 1           23760000
         LA    R2,WRK2AREA         ADDRESS OF WORK AREA 2               23770000
         ST    R2,WORK2PTR         SET POINTER TO WORK AREA 2           23780000
         LA    R2,NAMETTR          ADDRESS OF NAME-TTR BUFFER           23790000
         ST    R2,NAMEPTR          SET POINTER TO NAME-TTR BUFFER       23800000
         LA    R2,CVOLID           ADDRESS OF USER CAT. NAME   @YL026YB 23810000
         ST    R2,VOLIDPTR         SET PTR TO USER CAT. NAME   @YL026YB 23820000
         LA    R2,PASSWKD          ADDRESS OF CATALOG PASSWORD @YL026YB 23830000
         ST    R2,PASSPTR          SET PTR TO CATALOG PASSWORD @YL026YB 23840000
         MVC   STARBUFF(F52),DSNMESGL SAVE ASTERISK NAME                23850000
*  NOW MOVE INDEX STRUCTURE (FIRST DATA SET NAME)                       23860000
         XC    PASSPTR,PASSPTR     ZERO NO CAT. PASSWORD       @YL026YB 23870000
         XC    VOLIDPTR,VOLIDPTR   ZERO FOR SEARCH DEFAULT     @YL026YB 23880000
         LA    R3,NAMETTR          ADDRESS OF CIR BUFFER                23920020
         LA    R4,DSNBUFFO         POINT TO FIRST DATA SET NAME         23960020
         L     R2,STARADR1         LOAD POINTER TO ASTERISK             24000020
         LR    R5,R2               POINT TO ASTERISK                    24040020
         BCTR  R5,R0               POINT TO PERIOD BEFORE ASTERISK      24080020
         MVI   F0(R5),BLANK        BLANK OUT PERIOD FOR CIR             24120020
         SR    R2,R4               LENGTH OF INDEX STRUCTURE AND BLANK  24160020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    24200020
         EX    R2,MOVEINST         INDEX STRUCTURE AND BLANK TO BUFFER  24240020
         STH   R2,INDEXSZE         SAVE LENGTH OF INDEX STRUCTURE       24280020
*  CATALOG INFORMATION ROUTINE PARAMETER LIST IS NOW COMPLETE EXCEPT    24320020
*  FOR OPTION BYTE.  NOW DETERMINE OPTION NEEDED.                       24360020
         LA    R5,F2(R2)           LENGTH OF DATA SET NAME TO ASTERISK  24400020
         CH    R5,DSBLO            COMPARE TO LENGTH OF DATA SET NAME   24440020
*  IF LENGTHS ARE EQUAL THE ASTERISK IS IN THE LAST POSITION OF THE     24480020
*  DATA SET NAME AND THE OPTION FOR THE CATALOG INFORMATION ROUTINE IS  24520020
*  X'01' REQUESTING DSNAMES.  IF LENGTHS NOT EQUAL THE OPTION IS X'02'  24560020
*  REQUESTING ALL NAMES                                        @YL026YB 24600000
         BNE   CIRINDEX            PROCESS INDEX NAMES                  24640020
CIRNAMES MVI   CIRPARM,NAMESOPT    SET DSNAMES OPTION FOR CIR           24680020
MORNAMES L     R15,CIRADDR         ADDRESS OF CIR                       24720020
         LA    R1,CIRPARM          POINT TO CIR PARAMETER LIST          24760020
         CALL  (15)                GO TO CIR                            24800020
         LTR   R15,R15             TEST RETURN CODE                     24840020
         BNZ   CIRLTST             NONZERO RETN CODE IS ERROR  @YL026YB 24880000
         L     R8,WORK1PTR         REG PTS TO CIR   NAMES      @YL026YB 24920000
*                                  AND IS USED TO INDEX THROUGH LIST    24960000
         MVC   WKLENGTH(F4),F0(R8)  SAVE WKAREA LENGTH FIELDS  @YL026YB 25000000
         LA    R8,F4(R8)           BUMP PTR TO 1ST ENTRY CODE  @YL026YB 25040000
CIRNTEST ST    R8,$RETRY0+R8*F4    SAVE REG FOR STAE RECOVERY           25080000
         CLI   F0(R8),NAMETST      IS IT A DATA SET NAME ENTRY          25120000
         BE    BLDNAME             YES,GO PROCESS DSNAME ENTRY @YL026YB 25160000
         CLI   F0(R8),ENDTEST      TEST FOR END OF LIST                 25200000
         BE    ENDLIST             YES, GO PROCESS END OF LIST          25240000
         LA    R8,F9(R8)           POINT TO NEXT ENTRY         @YL026YB 25280000
         B     CIRNTEST            GO PROCESS NEXT ENTRY       @YL026YB 25320000
CIRINDEX MVI   CIRPARM,INDEXOPT    SET INDEX NAMES OPTION FOR CIR       25360020
MORINDXS L     R15,CIRADDR         ADDRESS OF CIR                       25400020
         LA    R1,CIRPARM          POINT TO CIR PARAMETER LIST          25440020
         CALL  (15)                GO TO CIR                            25480020
         LTR   R15,R15             TEST RETURN CODE                     25520020
         BNZ   CIRLTST             NONZERO RETURN CDE IS ERROR @YL026YB 25560000
         L     R8,WORK1PTR         REG PTS TO CIR  NAMES       @YL026YB 25570000
*                                  AND IS USED TO INDEX THROUGH LIST    25580000
         MVC   WKLENGTH(F4),F0(R8) SAVE WK AREA LENGTH FIELDS  @YL026YB 25590000
         LA    R8,F4(R8)           BUMP PTR TO 1ST ENTRY CODE  @YL026YB 25600000
CIRITEST ST    R8,$RETRY0+R8*F4    SAVE REG FOR STAE RECOVERY           25610000
         CLI   F0(R8),INDEXTST     IS IT A NONVSAM NAME ENTRY  @YL026YB 25620000
         BE    BLDNAME             YES, GO PROCESS LIST ENTRY  @YL026YB 25630000
         CLI   F0(R8),ENDTEST      TEST FOR END OF LIST                 25640000
         BE    ENDLIST             YES, GO PROCESS END OF LIST          25650000
         LA    R8,F45(R8)          POINT TO NEXT ENTRY         @YL026YB 25660000
         B     CIRITEST            GO PROCESS NEXT ENTRY       @YL026YB 25670000
BLDNAME  L     R15,VCONRN4         ADDRESS OF CIR NAME ROUTINE @YL026YB 25680000
         BALR  R14,R15             GET NAME FROM CIR           @YL026YB 25690000
         B     ERRORDS1            GO UPDATE MESSAGE BUFFER    @YL026YB 25700000
         B     STARPROC            ERROR FOUND GO TO NEXT NAME @YL026YB 25710000
ENDLIST  CLI   STARSW,SWON         HAS * VALUE BEEN RENAMED    @YL026YB 25720000
         BE    CLEANUP             YES, GO CLEANUP                      25860020
         MVI   STARSW,SWOFF        NO, TURN OFF SWITCH                  25870020
         B     CIRERROR            GO PUT OUT MESSAGE                   25872020
*  NO ASTERISK FOUND IN DATA SET NAMES.  CHECK IF DATA SET NAMES ARE    26840020
*  FULLY QUALIFIED (IN QUOTES).  IF NOT ADD QUALIFIERS TO EITHER OR     26880020
*  BOTH DATA SET NAMES AS NEEDED.                                       26920020
QUOTETST LA    R5,DSNAME1          POINT TO PDE                         26930020
         TM    F6(R5),QUOTEMSK     IS FIRST DSNAME FULLY QUALIFIED      26940020
         BZ    QUALIFY1            IF NOT, GO QUALIFY FIRST DSNAME      27120020
QUAL2    LA    R5,DSNAME2          POINT TO PDE                         27130020
         SR    R1,R1               ZERO REGISTER                        27132020
         C     R1,F0(R5)           IS SECOND DSNAME POINTER ZERO        27134020
         BE    MEMCHECK            YES, DO NOT QUALIFY SECOND DSNAME    27136020
         TM    F6(R5),QUOTEMSK     IS SECOND DSNAME FULLY QUALIFIED     27140020
         BZ    QUALIFY2            IF NOT, GO QUALIFY IT                27150020
MEMCHECK SR    R2,R2               ZERO REGISTER                        27240020
         LA    R5,DSNAME1          POINT TO PARSE PDE                   27280020
         C     R2,F8(R5)           IS FIRST MEMBER NAME POINTER ZERO    27320020
         BNE   MEMTEST2            NO, GO CHECK SECOND DSNAME           27360020
         C     R2,F32(R5)          IS SECOND MEMBER POINTER ZERO        27400020
         BNE   BADDSN2             NO, ERROR, MEMBER SECOND NAME ONLY   27440020
         CH    R2,RENTYPE          WAS ALIAS SPECIFIED                  27480020
         BNE   BADKEYWD            YES, ERROR, INVALID USE OF ALIAS     27520020
         B     ALLOCDS             OK, GO ALLOCATE DATA SET             27560020
SAMENAME MVC   DSLN(F46),DSLO      SAME PDS FOR BOTH NAMES              27570020
         B     ALLOCDS             GO ALLOCATE DATA SET                 27580020
MEMTEST2 C     R2,F32(R5)          IS SECOND MEMBER POINTER ZERO        27600020
         BE    BADDSN4             YES, ERROR, MEMBER FIRST NAME ONLY   27640020
         C     R2,F24(R5)          IS SECOND DSNAME POINTER ZERO        27680020
         BE    SAMENAME            YES, OK, DEFAULT TO FIRST DSNAME     27720020
         CLC   DSLO(F46),DSLN      SAME PDS BOTH DSNAMES                27760020
         BNE   BADDSN5             NO, ERROR, DIFFERENT PDS'S           27800020
*  BOTH DSNAMES ARE NOW FULLY QUALIFIED.  NOW ALLOCATE FIRST DATA SET   27840020
ALLOCDS  LA    R6,DAIR08           POINT TO DAIR ENTRY 08               27880020
         USING DAPB08,R6           ADDRESSABILITY FOR DAIR ENTRY 08     27920020
         MVC   DA08DDN(F8),DA08SER BLANK DDNAME FIELD                   27960020
         MVC   DA08PSWD(F8),DA08SER BLANK PASSWORD FIELD                28000020
         L     R4,F16(R5)          POINTER TO PASSWORD                  28040020
         LTR   R4,R4               TEST PASSWORD POINTER                28080020
         BZ    NOPASWRD            ZERO POINTER INDICATES NO PASSWORD   28120020
         LA    R3,DA08PSWD         POINT TO PASSWORD FIELD IN DAIR LIST 28160020
         LH    R2,F20(R5)          LENGTH OF PASSWORD                   28200020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    28240020
         EX    R2,MOVEINST         MOVE PASSWORD TO DAIR LIST           28280020
NOPASWRD LA    R1,DAIRPARM         POINT TO DAIR GENERAL PARAMETER LIST 28320020
         MVI   STARSW,SWON         TURN STAR SWITCH ON                  28330020
         MVI   CIRFLAG,SWON        TURN CIR FLAG ON                     28340020
         L     R15,DAIRADDR        ADDRESS OF DAIR                      28360020
         ST    R6,DAPLDAPB-DAPL(R1) ENTRY PARM BLOCK TO DAIR LIST       28400020
         CALL  (15)                GO TO DAIR (ALLOCATE DATA SET)       28440020
         LTR   R15,R15             TEST DAIR RETURN CODE                28480020
         BNZ   DAIRERR             NONZERO RETURN CODE IS DAIR ERROR    28520020
         MVI   UNALOCSW,SWON       TURN UNALLOCATE SWITCH ON            28560020
         MVC   DDNAME1(F8),DA08DDN SAVE DDNAME                          28600020
*  NOW DETERMINE IF RENAME IS FOR ENTIRE DATA SET OR FOR A MEMBER OF    28640020
*  A PARTITIONED DATA SET                                               28680020
         SR    R2,R2               ZERO REGISTER                        28720020
         CLI   DA08DSO,PDSTEST     IS DATA SET A PDS                    28760020
         DROP  R6                  DAPB08 NO LONGER NEEDED              28800020
         LA    R5,DSNAME1          POINT TO PARSE PDE                   28840020
         BE    MEMBRTST            IF YES, WAS A MEMBER SPECIFIED       28880020
*  DATA SET IS NOT PARTITIONED.  A MEMBER SPECIFIED IS AN ERROR         28920020
         C     R2,F8(R5)           IS FIRST MEMBER NAME POINTER ZERO    28960020
         BNE   BADDSN1             ERROR (EXPLAINED ABOVE)              29000020
*  THE RENAME IS NOT FOR A MEMBER OF A PARTITIONED DATA SET, THEREFORE  29040020
*  RENAME ENTIRE DATA SET.                                              29080020
RENSEQDS LH    R2,DSLO             LENGTH OF FIRST DATA SET NAME        29120020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    29160020
         LA    R4,DSNO             POINT TO FIRST DATA SET NAME         29200020
*  BLANK WORK DATA SET NAME BUFFERS                                     29240020
         MVI   DSNAMEU,BLANK       BLANK                                29280020
         MVC   DSNAMEU+F1(F44),DSNAMEU UNCATALOG MACRO BUFFER           29320020
         MVC   DSNAME4(F45),DSNAMEU CATALOG MACRO BUFFER (2ND DSNAME)   29360020
         MVC   DSNAME3(F44),DSNAMEU LOCATE MACRO BUFFER                 29400020
         MVC   OLDNAME(F44),DSNAMEU RENAME MACRO BUFFER (OLDNAME)       29520020
         MVC   NEWNAME(F44),DSNAMEU RENAME MACRO BUFFER (NEWNAME)       29560020
*  NOW MOVE DSNAMES TO CAMLST MACRO BUFFERS                             29600020
         LA    R3,DSNAMEU          POINT TO UNCATALOG DSNAME BUFFER     29640020
         EX    R2,MOVEINST         FIRST DSNAME TO UNCATALOG BUFFER     29680020
         LA    R3,DSNAME3          POINT TO LOCATE DSNAME BUFFER        29720020
         EX    R2,MOVEINST         FIRST DSNAME TO LOCATE BUFFER        29760020
         LA    R3,OLDNAME          POINT TO RENAME DSNAME(OLD) BUFFER   29880020
         EX    R2,MOVEINST         FIRST DSNAME TO RENAME BUFFER        29920020
         LH    R2,DSLN             LENGTH OF SECOND DATA SET NAME       29960020
         BCTR  R2,R0               DECREMENT FOR EXECUTE                30000020
         LA    R4,DSNN             POINT TO SECOND DATA SET NAME        30040020
         LA    R3,DSNAME4          POINT TO CATALOG DSNAME BUFFER       30160020
         EX    R2,MOVEINST         SECOND DSNAME TO CATALOG BUFFER      30200020
         LA    R3,NEWNAME          POINT TO RENAME DSNAME(NEW) BUFFER   30240020
         EX    R2,MOVEINST         SECOND DSNAME TO RENAME BUFFER       30280020
*  NOW ISSUE LOCATE TO GET VOLUME INFORMATION FOR RENAME                30320020
         LA    R2,DSNAME3          LOCATE DSNAME BUFFER                 30360020
         ST    R2,LOCNAME2         SET POINTER TO DSNAME BUFFER         30400020
         LA    R2,LOCAREA1         LOCATE WORKAREA                      30440020
         ST    R2,LOCNAME4         SET POINTER TO WORKAREA              30480020
         LOCATE LOCNAME            ISSUE LOCATE                         30520020
         LTR   R15,R15             TEST LOCATE RETURN CODES             30560020
         BNZ   LOCERROR            NONZERO RETURN CODE IS LOCATE ERROR  30600020
         CLI   ISWITCH,ENDTEST     WAS THIS A VALIDITY CHECK            30640020
         BE    OKINDEX             YES, GO TURN OFF SWITCH              30680020
*  NOW CHECK NUMBER OF VOLUMES.  MORE THAN 1 VOLUME IS ERROR            30720020
         LA    R2,VOLCOUNT         SET REGISTER TO 1                    30760020
         CH    R2,LOCAREA1         COMPARE 1 TO NUMBER OF VOLUMES       30800020
         BL    OVR20VOL            ERROR, MORE THAN 1 VOLUME            30840020
*  COMPUTE LENGTH OF VOLUME LIST AND MOVE VOLUME                        30880020
*  LIST TO RENAME AND CATALOG CAMLSTS                                   30920020
         LA    R2,VOLLENTH         LENGTH OF EACH VOLUME ENTRY          30960020
         MH    R2,LOCAREA1         MULTIPLY BY NUMBER OF VOLUMES        31000020
         LA    R2,F1(R2)           ADD TWO FOR VOLUME COUNT, DECREMENT- 31040020
*                                  ONE FOR EXECUTE INSTRUCTION          31080020
         LA    R3,VOLIST1          ADDRESS OF RENAME VOLUME LIST        31120020
         ST    R3,RENAME4          POINT TO RENAME VOLUME LIST          31160020
         LA    R4,LOCAREA1         LOCATE WORKAREA (VOLUME LIST)        31200020
         EX    R2,MOVEINST         MOVE VOLUME LIST TO RENAME MACRO     31240020
         LA    R3,VOLIST2          ADDRESS OF CATALOG VOLUME LIST       31280020
         ST    R3,CATLST4          POINT TO CATALOG VOLUME LIST         31290020
         EX    R2,MOVEINST         MOVE VOLUME LIST TO CATALOG MACRO    31320020
*  NOW SEE IF NEW NAME IS ALREADY CATALOGED                             31330020
         LA    R2,DSNAME4          DSNAME POINTER                       31340020
         ST    R2,LOCNAME2         TO LOCATE LIST                       31350020
         LOCATE LOCNAME            ISSUE LOCATE                         31352020
         LTR   R15,R15             TEST RETURN CODE                     31354020
         BZ    NMEONVOL            NAME FOUND IS ERROR                  31356020
*  PREVENT ATTENTION INTERRUPTIONS FROM NOW UNTIL AFTER UNALLOCATION    31358020
         STAX  DEFER=YES           DEFER ATTENTION INTERRUPTS           31358420
*  NOW RENAME DATA SET                                                  31360020
         LA    R2,OLDNAME          OLD DSNAME                           31440020
         ST    R2,RENAME2          SET POINTER TO OLD DSNAME BUFFER     31480020
         LA    R2,NEWNAME          NEW DSNAME                           31520020
         ST    R2,RENAME3          SET POINTER TO NEW DSNAME BUFFER     31560020
         SR    R0,R0               THIS REGISTER ZEROED FOR RENAME      31600020
         RENAME RENAMLST           ISSUE RENAME                         31640020
         LTR   R15,R15             TEST RENAME RETURN CODE              31680020
         BNZ   RENAMERR            RENAME ERROR                         31720020
*  NOW CATALOG NEW DATA SET NAME                                        32080020
CATNEWDS LA    R2,DSNAME4          CATALOG DSNAME BUFFER                32120020
         ST    R2,CATLST2          SET POINTER TO CATALOG BUFFER        32160020
*  ISSUE CATALOG MACRO TO CATALOG NEW DATA SET                          32200020
         CATALOG CATLST            ISSUE CATALOG                        32240020
         LTR   R15,R15             TEST CATALOG RETURN CODE             32280020
         BNZ   RESTORE             CATALOG ERROR, RESTORE STATUS        32360020
*  NOW UNCATALOG OLD DATA SET                                           32440020
         LA    R2,DSNAMEU          UNCATALOG DSNAME BUFFER              32520020
         ST    R2,UNCAT2           SET POINTER TO UNCATALOG NAME BUFFER 32600020
*  ISSUE CATALOG MACRO TO UNCATALOG OLD DATA SET NAME                   32680020
         SR    R0,R0               THIS REGISTER ZEROED FOR CATALOG     32760020
         CATALOG UNCATLST          ISSUE CATALOG                        32840020
         LTR   R15,R15             TEST CATALOG RETURN CODE             32920020
         BNZ   UNCATBAD            CATALOG ERROR                        33000020
*  NOW UNALLOCATE DATA SET                                              33080020
UNALOCDS LA    R6,DAIR18           POINT TO DAIR ENTRY 18               33120020
         USING DAPB18,R6           ADDRESSABILITY DAIR ENTRY 18         33160020
*  IF RENAME WAS SUCCESSFUL UNALLOCATE BY DSNAME, BUT IF ERROR OR       33168020
*  RENAME WAS FOR PDS MEMBER UNALLOCATE BY DDNAME                       33176020
         SR    R3,R3               ZERO REGISTER                        33184020
         CLI   ERRORSW,SWON        DID ERROR OCCUR                      33186020
         BE    UNALOC              YES, GO UNALLOCATE DDNAME            33188020
         MVI   DA18CTL,PERMALC     UNALLOC PERMANENTLY ALLOC DS         33190020
         LA    R5,DSNAME1          POINT TO PARSE PDE                   33192020
         C     R3,F8(R5)           WAS MEMBER SPECIFIED                 33200020
         BNE   UNALOC              YES, GO UNALLOCATE DDNAME      M2009 33208021
         LA    R3,DSLO             POINT TO DSLENGTH-DSNAME             33232000
         ST    R3,DA18PDSN         SET DSNAME POINTER                   33240020
         MVC   DA18DDN(F8),DA18JBNM BLANK DDNAME                        33248020
         B     UNALOCGO            GO UNALLOCATE                        33256020
UNALOC   MVI   DA18CTL,ZERO        CLEAR CONTROL BYTE                   33258020
UNALOCDD ST    R3,DA18PDSN         XERO DSNAME POINTER                  33264020
         MVC   DA18DDN(F8),DDNAME1 MOVE DDNAME TO UNALLOCATE LIST       33280020
UNALOCGO L     R15,DAIRADDR        LOAD DAIR ADDRESS                    33320020
         LA    R1,DAIRPARM         POINT TO DAIR GENERAL PARAMETER LIST 33360020
         ST    R6,DAPLDAPB-DAPL(R1) ENTRY PARM BLOCK TO DAIR LIST       33400020
         DROP  R6                  DAPB18 NO LONGER NEEDED              33440020
         CALL  (15)                GO TO DAIR (UNALLOCATE DATA SET)     33480020
         MVI   UNALOCSW,SWOFF      TURN UNALLOCATE SWITCH OFF           33520020
         MVI   ERRORSW,SWOFF       TURN ERROR SWITCH OFF                33540020
*  NOW ALLOW ATTENTION INTERRUPTIONS                                    33550020
         STAX  DEFER=NO            ALLOW ATTENTION INTERRUPTS           33552020
*  FINISHED PROCESSING THIS DATA SET.  CHECK IF PROCESSING ASTERISK     33560020
*  NAMES AND IF SO CONTINUE ASTERISK PROCESSING, OTHERWISE CLEANUP      33600020
*  AND RETURN.                                                          33640020
IKJEHTST EQU   *                   ALIAS FOR LISTEST                    33660020
LISTEST  CLI   ENDERROR,SWON       CAN PROCESSING CONTINUE              33680020
         BE    CLUPRCC             NO, GO CLEANUP AND RETURN   @ZA01485 33720037
         L     R2,STAEADDR         ADDRESS OF STAE INTERFACE ROUTINE    33730020
         STAE  (R2),CT,PARAM=STAEPARM,MF=(E,STAELIST) ISSUE STAE        33740020
         LTR   R8,R8               TEST FOR PROCESSING ASTERISK NAMES   33760020
         BNZ   STARPROC            YES, CONTINUE PROCESSING             33800020
*  FINISHED PROCESSING, CLEANUP                                         33840020
*  NOW CHECK IF AN ERROR HAS OCCURRED.  IF SO, THE STACK MUST BE        34170020
*  FLUSHED AND THE INPUT QUEUE CLEARED.                                 34180020
CLEANUP  CLI   STACKSW,SWON        IS STACK SWITCH ON                   34190020
         BNE   STACKOK             NO ERROR, END NORMALLY               34192020
         LA    R1,IOPARM           POINT TO I/O PARAMETER LIST          34194020
         LA    R2,STACKPRM         POINT TO STACK PARM BLOCK            34196020
         ST    R2,IOPLIOPB-IOPL(R1) PARM BLOCK ADDRESS TO PARM LIST     34198020
         STACK DELETE=ALL,MF=(E,(1)) FLUSH STACK                        34198420
         TCLEARQ INPUT             CLEAR ANYTHING TYPED AHEAD           34198820
STACKOK  EQU   *                   NORMAL RETURN FROM HERE              34199220
         L     R13,F4(R13)         POINT TO CALLER'S REGISTERS          34200020
         SR    R15,R15             CLEAR RETURN CODE           @ZA01485 34280037
         IC    R15,RCX             SET RC                      @ZA01485 34290037
         RETURN (14,12),T,RC=(15)  RESTORE REGISTERS AND RETURN         34320020
CLUPRCC  EQU   *                                               @ZA01485 34330037
         MVI   RCX,RC12            SET RC                      @ZA01485 34340037
         B     CLEANUP                                         @ZA01485 34350037
STARPROC CLI   CIRPARM,INDEXOPT    PROCESSING INDEX NAMES               34360020
         BE    CIRITEST            YES, GO PROCESS INDEX NAME           34400020
         B     CIRNTEST            NO, GO PROCESS DATA SET NAME         34440020
*  THIS SECTION APPENDS THE USERID TO THE FIRST DATA SET NAME           34480020
*  FIRST SEVEN BYTES OF PSCB IS USERID (RIGHT PADDED WITH BLANKS) AND   34520020
*  EIGHTH BYTE IS THE LENGTH OF THE USERID.                             34560020
ADUSRID1 L     R4,UPTSAVE          ADDRESS OF PSCB                      34600000
         LA    R3,DSNBUFFO         ADDRESS OF FIRST DSNAME BUFFER       34620000
         SR    R2,R2               ZERO REGISTER                        34640000
         IC    R2,UPTPREFL-UPT(R4) LENGTH OF USERID                     34660000
         LTR   R2,R2               CHECK PREFIX LENGTH FOR ZERO         34680000
         BZ    NOPREFX             NO PREFIXING                @YL026YB 34700000
         EX    R2,MOVE1            MOVE USERID TO FIRST DSNAME BUFFER   34720000
*  THIS ACTUALLY MOVED ONE EXTRA BYTE WHICH WILL NOW BE OVERLAID WITH   34800020
*  A PERIOD.                                                            34840020
         AR    R3,R2               POINT PAST PERIOD                    34880020
         MVI   F0(R3),PERIOD       MOVE IN A PERIOD                     34920020
         LA    R3,F1(R3)           POINT PAST PERIOD           @YL026YB 34960000
         LA    R2,F1(R2)           - PLUS ONE FOR THE PERIOD   @YL026YB 35000000
NOPREFX  LA    R4,DSNO             ADDRESS OF DATA SET NAME    @YL026YB 35040000
         LH    R5,DSLO             LENGTH OF DATA SET NAME -            35080000
         AR    R2,R5               - ADDED TO LENGTH OF USERID -        35120000
         BCTR  R5,R0               DECREMENT FOR EXECUTE INSTRUCTION    35160020
         EX    R5,MOVEINST         MOVE DATA SET NAME TO USERID         35200020
         STH   R2,DSBLO            SAVE TOTAL DATA SET LENGTH           35240020
         CH    R2,MAXLENTH         CHECK LENGTH NOT GREATER THAN 44     35280020
         BH    DSNBIG1             IF SO, ERROR                         35320020
         B     SCANDSN1            NOW GO CHECK FOR * QUALIFIERS        35360020
*  THIS SECTION APPENDS THE USERID TO THE SECOND DATA SET NAME          35400020
*  FIRST SEVEN BYTES OF PSCB IS USERID (RIGHT PADDED WITH BLANKS) AND   35440020
*  EIGHTH BYTE IS THE LENGTH OF THE USERID                              35480020
ADUSRID2 L     R4,UPTSAVE          ADDRESS OF UPT              @YL026YB 35520000
         LA    R3,DSNBUFFN         ADDRESS OF SECOND DSNAME BUFFER      35540000
         SR    R2,R2               ZERO REGISTER                        35560000
         IC    R2,UPTPREFL-UPT(R4) LENGTH OF USERID            @YL026YB 35580000
         LTR   R2,R2               CHECK PREFIXING LENGTH FOR ZERO      35600000
         BZ    NOPREX1             NO PREFIXING                @YL026YB 35620000
         EX    R2,MOVE1            MOVE USERID TO SECOND DSNAME BUFFER  35640000
*  THIS ACTUALLY MOVED ONE EXTRA BYTE WHICH WILL NOW BE OVERLAID WITH   35720020
*  A PERIOD.                                                            35760020
         AR    R3,R2               POINT PAST PERIOD                    35800020
         MVI   F0(R3),PERIOD       MOVE IN A PERIOD                     35840020
         LA    R3,F1(R3)           POINT PAST PERIOD                    35880020
         LA    R2,F1(R2)           - PLUS ONE FOR THE PERIOD   @YL026YB 35920000
NOPREX1  LA    R4,DSNN             ADDRESS OF DATA SET NAME    @YL026YB 35960000
         LH    R5,DSLN             LENGTH OF DATA SET NAME -            36000000
         AR    R2,R5               - ADDED TO LENGTH OF USERID          36040000
         BCTR  R5,R0               DECREMENT OFR EXECUTE INSTRUCTION    36080020
         EX    R5,MOVEINST         MOVE DATA SET NAME TO USERID         36120020
         STH   R2,DSBLN            SAVE TOTAL DATA SET LENGTH           36160020
         CH    R2,MAXLENTH         CHECK LENGTH NOT GREATER THAN 44     36200020
         BH    DSNBIG2             IF SO, ERROR                         36240020
         B     SCANDSN2            NOW GO CHECK FOR * QUALIFIERS        36280020
*  FIRST DATA SET IS PARTITIONED.  CHECK IF MEMBER NAME SPECIFIED       36320020
MEMBRTST C     R2,F8(R5)           IS FIRST MEMBER NAME POINTER ZERO    36360020
         BE    RENSEQDS            PDS WITHOUT MEMBER                   36400020
*  RENAME IS FOR A PDS MEMBER                                           36440020
*  BUILD DCB BEFORE OPEN (INSERT DDNAME OBTAINED FROM DAIR)             36480020
OKNAME   MVC   DCBDDNAM(F8),DDNAME1 MOVE DDNAME TO DCB                  36520020
*  NOW OPEN DATA SET                                                    36560020
         LA    R1,OPEN             ADDRESS OF OPEN LIST                 36600020
         OPEN  ,MF=(E,(1))         OPEN DATA SET                        36640020
*  NOW INITIALIZE STOW AND BLDL WORK AREAS TO BLANKS                    36800020
         MVI   STOWOLD,BLANK       BLANK FIRST BYTE                     36840020
         MVC   STOWOLD+F1(STOWEND-STOWOLD-F1),STOWOLD BLANK WORK AREA   36880020
*  MOVE BOTH MEMBER NAMES TO WORK AREA                                  36920020
         LA    R3,STOWOLD          OLD MEMBER NAME AREA                 36960020
         L     R4,F8(R5)           POINT TO FIRST MEMBER NAME           37000020
         LH    R2,F12(R5)          LENGTH OF MEMBER NAME                37040020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    37080020
         EX    R2,MOVEINST         MOVE OLD MEMBER NAME                 37120020
         LA    R3,STOWNEW          NEW MEMBER NAME AREA                 37160020
         L     R4,F32(R5)          POINT TO SECOND MEMBER NAME          37200020
         LH    R2,F36(R5)          LENGTH OF MEMBER NAME                37240020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    37280020
         EX    R2,MOVEINST         MOVE NEW MEMBER NAME                 37320020
*  NOW CHECK IF ALIAS KEYWORD SPECIFIED                                 37360020
         SR    R2,R2               ZERO REGISTER                        37400020
         CH    R2,RENTYPE          WAS ALIAS SPECIFIED                  37440020
         BNE   ALIASMEM            YES, GO PROCESS ALIAS NAME           37480020
*  ALIAS KEYWORD NOT SPECIFIED, USE STOW C OPTION TO CHANGE             37520020
*  MEMBER NAME                                                          37560020
         STOW  IHADCB,STOWOLD,C    ISSUE STOW                           37600020
         LTR   R15,R15             TEST RETURN CODE                     37640020
         BNZ   STWERROR            STOW ERROR                           37680020
*  STOW COMPLETE, NOW CLOSE DATA SET                                    37720020
CLOSEPDS LA    R1,CLOSE            ADDRESS OF CLOSE LIST                37760020
         CLOSE ,MF=(E,(1))         ISSUE CLOSE                          37800020
*  DATA SET CLOSED                                                      37840020
         B     UNALOCDS            GO UNALLOCATE DATA SET               37880020
*  ALIAS KEYWORD SPECIFIED, USE BLDL TO GET DIRECTORY INFORMATION FOR   37920020
*  OLD MEMBER NAME                                                      37960020
*  FIRST INITIALIZE BLDL LIST                                           38000020
ALIASMEM LA    R2,F1               NUMBER OF ENTRIES                    38040020
         STH   R2,BLDLCNT          SET COUNT IN BLDL LIST               38080020
         LA    R2,F76              LENGTH OF ENTRY                      38120020
         STH   R2,BLDLLNTH         SET LENGTH IN BLDL LIST              38160020
         MVC   BLDLMEM(F8),STOWOLD MEMBER NAME TO BLDL LIST             38200020
*  USE BLDL TO GET DIRECTORY INFORMATION                                38240020
         BLDL  IHADCB,BLDLCNT      ISSUE BLDL                           38280020
         LTR   R15,R15             TEST BLDL RETURN CODE                38320020
         BNZ   BLDLERR             BLDL ERROR                           38360020
*  MOVE DIRECTORY INFORMATION TO STOW WORK AREA                         38400020
         MVC   STOWMEM(F11),BLDLMEM MEMBER AND TTR DATA TO STOW AREA    38440020
         MVC   STOWDATA(F63),BLDLDATA USER DATA AND FLAG BYTE           38480020
         OI    STOWDATA,ALIAS      INDICATE THAT MEMBER IS AN ALIAS     38520020
         MVC   STOWMEM(F8),STOWNEW NEW MEMBER NAME TO STOW WORK AREA    38560020
*  USE STOW TO CREATE ALIAS                                             38600020
         STOW  IHADCB,STOWMEM,A    ISSUE STOW                           38640020
         LTR   R15,R15             TEST RETURN CODE                     38680020
         BNZ   STWERROR            STOW ERROR                           38720020
         B     CLOSEPDS            GO CLOSE DATA SET                    38760020
LOCERROR CLI   ISWITCH,ENDTEST     WAS THIS A VALIDITY CHECK            41080020
         BE    BADSTAR             YES, RESET AND TRY NEXT INDEX NAME   41120020
         B     DSNOTFND            GO BUILD MESSAGE                     41190020
BADSTAR  MVI   ISWITCH,INDEXTST    RESET INDEX SWITCH                   41200020
         B     CIRITEST            GO PROCESS NEXT INDEX NAME           41240020
OKINDEX  MVI   ISWITCH,INDEXTST    TURN OFF INDEX SWITCH                41280020
         B     BLDDSN2             GO BUILD SECOND DATA SET NAME        41320020
*  UNABLE TO CATALOG NEW DATA SET NAME, RESTORE TO OLD NAME.  RENAME    43160020
*  BACK TO OLD NAME AND RECATALOG OLD NAME.                             43200020
RESTORE  LA    R2,OLDNAME          THIS CODE REVERSES THE POINTERS TO   43240020
         ST    R2,RENAME3          -THE DATA SET NAME BUFFERS (OLD DATA 43280020
         LA    R2,NEWNAME          -SET NAME IS NOW THE NEW NAME AND    43320020
         ST    R2,RENAME2          -VICE VERSA)                         43360020
         LA    R2,VOLIST2          POINT TO CATALOG VOLUME LIST         43370020
         ST    R2,RENAME4          USE THIS LIST SO RENAME CONDITION    43372020
*                                  WILL NOT BE OVERLAID                 43374020
         STH   R15,CATERCDE        SAVE CATALOG ERROR CODE              43380020
*  ISSUE RENAME MACRO TO RESTORE ORIGINAL (OLD) DATA SET NAME           43400020
         SR    R0,R0               THIS REGISTER ZEROED FOR RENAME      43440020
         RENAME RENAMLST           ISSUE RENAME                         43480020
         CLI   RENERRSW,SWON       WAS THIS A RENAME ERROR              43520020
         BCR   EQ,R11              YES, GO PUT OUT MESSAGE              43560020
         LA    R15,RC8             SET R15 = 8                          43570020
         CH    R15,CATERCDE        CATALOG ERROR CODE = 8               43580020
         BE    INDEXBAD            YES, INDEX STRUCTURE ERROR           43582020
         LA    R10,DSNMSGL2        POINT TO DSNAME INSERTION            43590020
         LA    R2,M28              MESSAGE NUMBER 28                    43620020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     43650020
         LH    R15,CATERCDE        RESTORE CATALOG ERROR CODE           43680020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         43710020
         LA    R2,S12              SECOND LEVEL MESSAGE NUMBER 12       43740020
         B     BLDSMSG             GO BUILD SECOND LEVEL MESSAGE        43770020
INDEXBAD LA    R2,M27              MESSAGE 27                           43820020
         LA    R10,DSNMSGL2        POINT TO INSERTION                   43830020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     43832020
         LA    R2,S11              SECOND LEVEL MESSAGE 11              43834020
         B     ZEROR10             GO BUILD MESSAGE                     43836020
*  NO SECOND DATA SET NAME ENTERED.  SECOND DATA SET NAME IS A MEMBER   43840020
*  NAME ALONE.  THIS IS VALID ONLY IF FIRST DATA SET IS PARTITIONED     43880020
*  AND A MEMBER NAME WAS SPECIFIED.                                     43920020
NODSN2   LA    R3,DSNAME1          POINT TO PDE FOR FIRST DSNAME        43960020
         C     R2,F8(R3)           IS MEMBER POINTER ZERO               44000020
         BE    BADDSN2             YES, ERROR                           44040020
         MVI   STARLEV2,ZERO       INDICATE NO * IN SECOND DSNAME       44080020
         MVI   MEM2SW,SWON         TURN MEM2 SWITCH ON                  44090020
         B     MEM2                GO SAVE SECOND MEMBER NAME           44100020
*                                                                       44160020
STARERR4 LA    R10,DSNMSGL1        POINT TO INSERTION                   44200020
STARMSG1 BAL   R11,STARMSG         GO GET FIRST LEVEL MESSAGE           44240020
         LA    R2,S18              SECOND LEVEL MESSAGE NUMBER 18       44280020
         B     ZEROR10             GO BUILD MESSAGE                     44290020
DSNBIG2  LA    R10,DSNMSGL2        POINT TO DSNAME INSERTION            44440020
         LA    R1,DSLN             POINT TO DATA SET NAME BUFFER        44490020
         B     DSNBIG              GO BUILD DSNAME INSERTION            44520020
STARER4  LA    R10,DSNMSGL2        POINT TO INSERTION                   44560020
         B     STARMSG1            GO GET FIRST LEVEL MESSAGE           44600020
STARERR8 LA    R10,DSNMSGL1        POINT TO INSERTION                   44640020
STARMSG2 BAL   R11,STARMSG         GO GET FIRST LEVEL MESSAGE           44680020
         LA    R2,S17              SECOND LEVEL MESSAGE NUMBER 17       44720020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        44760020
STARER8  LA    R10,DSNMSGL2        POINT TO INSERTION                   44800020
         B     STARMSG2            GO GET FIRST LEVEL MESSAGE           44840020
STARERR  LA    R10,DSNMSGL1        POINT TO INSERTION                   44880020
         BAL   R11,STARMSG         GO GET FIRST LEVEL MESSAGE           44920020
         LA    R2,S19              SECOND LEVEL MESSAGE NUMBER 19       44960020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        45000020
STARMSG  LA    R2,M06              MESSAGE NUMBER 6                     45040020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     45080020
         BR    R11                 RETURN FOR SECOND LEVEL MESSAGE      45120020
STARMEM1 LA    R10,DSNMSGL1        POINT TO INSERTION                   45160020
STARMSG3 BAL   R11,STARMSG         GO GET FIRST LEVEL MESSAGE           45200020
         LA    R2,S09              SECOND LEVEL MESSAGE NUMBER 9        45240020
         B     ZEROR10             GO BUILD MESSAGE                     45280020
STARMEM2 LA    R10,DSNMSGL2        POINT TO INSERTION                   45320020
         B     STARMSG3            GO BUILD MESSAGE                     45360020
BADDSN1  LA    R2,M24              MESSAGE NUMBER 24                    45400020
         LA    R10,DSNMESGL        POINT TO INSERTION                   45440020
         B     BLDMESG             GO BUILD MESSAGE                     45480020
NMEONVOL LA    R2,M22              MESSAGE NUMBER 22                    45520020
         LA    R10,DSNMSGL2        POINT TO DSNAME INSERTION            45560020
         B     BLDMESG             GO BUILD MESSAGE                     45600020
NONEWMEM LA    R2,M23              MESSAGE NUMBER 23                    45640020
         LA    R10,MEMMSGL2        POINT TO INSERTION                   45680020
         B     BLDMESG             GO BUILD MESSAGE                     45720020
ALIASERR LA    R2,M26              MESSAGE NUMBER 26                    45760020
         B     NOINSERT            GO BUILD MESSAGE                     45800020
BADUNIT  BAL   R11,MESG29          GO GET FIRST LEVEL MESSAGE           45850020
         LA    R2,S24              SECOND LEVEL MESSAGE 24              45900020
         B     ZEROR10             GO BUILD MESSAGE                     45950020
NOUNIT   BAL   R11,MESG29          GO GET FIRST LEVEL MESSAGE           45952020
         LA    R2,S25              SECOND LEVEL MESSAGE 25              45954020
         B     ZEROR10             GO BUILD MESSAGE                     45956020
MESG29   LA    R2,M29              MESSAGE NUMBER 29                    45958020
         LA    R10,DSNMESGL        POINT TO INSERTION                   45958420
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     45958820
         BR    R11                 RETURN                               45959220
MULTIVOL LA    R2,M21              MESSAGE 21                           45959620
         LA    R10,DSNMESGL        POINT TO INSERTION                   45959720
         B     BLDMESG             GO BUILD MESSAGE                     45959820
INUSE    LA    R2,M15              MESSAGE NUMBER 15                    45960020
         LA    R10,DSNMESGL        POINT TO INSERTION                   46000020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     46040020
         LA    R2,S06              SECOND LEVEL MESSAGE NUMBER 6        46080020
         B     ZEROR10             GO BUILD MESSAGE                     46120020
CATLGIO  BAL   R11,SYSTEMER        GO GET FIRST LEVEL MESSAGE           46130020
         LA    R2,S14              SECOND LEVEL MESSAGE 14              46140020
         B     ZEROR10             GO BUILD MESSAGE                     46150020
*  ANALYZE DAIR RETURN CODES                                            46160020
DAIRERR  STC   R15,RC              SAVE DAIR RETURN CODE                46200020
         CLI   RC,RC16             IS RETURN CODE = 16                  46240020
         BE    NODDS               YES, NO DD ENTRIES                   46280020
         LA    R2,DAIR08           POINT TO DAIR ENTRY 08               46320020
         CLI   RC,RC8              IS RETURN CODE = 8                   46360020
         BL    DAERROR             DAIR ERROR                           46370020
         BE    DSNCATLG            YES, DATA SET NOT CATALOGED          46400020
         LH    R15,DA08DARC-DAPB08(R2) DYNAMIC ALLOCATION RETURN CODE   46440020
         CH    R15,DARC0204        IS DARC = 0204                       46480020
         BE    NOSPACE             YES, NO CORE, GO SET RETURN CODE     46520020
         CH    R15,DARC0210        IS DARC = 0210                       46560020
         BE    INUSE               YES, DATA SET IN USE                 46600020
         CH    R15,DARC0218        IS DARC = 0218                       46640020
         BE    VOLNTMTD            YES, VOLUME NOT MOUNTED              46680020
         CH    R15,DARC6708        IS DARC = 6708                       46720020
         BE    DSNTOVOL            YES, DATA SET NOT ON VOLUME          46760020
         CH    R15,DARC021C        IS DARC = 021C                       46770020
         BE    BADUNIT             YES, BAD UNIT INFORMATION            46780020
         CH    R15,DARC0214        IS DARC = 0214                       46790020
         BE    NOUNIT              YES, NO UNIT AVAILABLE               46792020
         CH    R15,DARC041C        IS DARC = 041C                       46794020
         BE    MULTIVOL            YES, MULTI VOLUME DATA SET           46796020
         BAL   R11,SYSTEMER        GO GET FIRST LEVEL MESSAGE           46800020
         BAL   R3,BITOHEX          GO SET RETURN CODE INSERTION         46840020
         LA    R2,S05              SECOND LEVEL MESSAGE NUMBER 5        46880020
         B     BLDSMSG             GO BUILD SECOND LEVEL MESSAGE        46920020
NOMEM    LA    R2,M17              MESSAGE NUMBER 17                    46960020
         LA    R10,DSNMESGL        POINT TO INSERTION                   47000020
         B     BLDMESG             GO BUILD MESSAGE                     47040020
SYSTEMER LA    R2,M14              MESSAGE NUMBER 14                    47080020
         LA    R10,DSNMESGL        POINT TO INSERTION                   47120020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     47160020
         BR    R11                 RETURN FOR SECOND LEVEL MESSAGE      47200020
RENAMERR STC   R15,RC              SAVE RENAME RETURN CODE              47240020
         MVI   RENERRSW,SWON       TURN RENAME ERROR SWITCH ON          47290020
         BAL   R11,RESTORE         GO RENAME BACK TO OLD NAME           47340020
         MVI   RENERRSW,SWOFF      TURN OFF RENAME ERROR SWITCH         47390020
*  ANALYZE RENAME RETURN CODES                                          47400020
         CLI   RC,RC8              IS RETURN CODE = 8                   47440020
         BL    RENMERR             NO, RENAME ERROR                     47480020
*  CHECK UNUSUAL CONDITIONS                                             47520020
         LA    R2,SEQNUM+F1        POINT TO LAST BYTE OF VOLUME ENTRY   47560020
         LH    R3,VOLIST1          NUMBER OF VOLUMES                    47600020
NAMETEST CLI   F0(R2),NAMECHCK     DOES NEW NAME EXIST                  47640020
         BE    NMEONVOL            YES, ERROR                           47680020
         CLI   F0(R2),BADPASWD     INCORRECT PASSWORD SPECIFIED         47690020
         BE    ABEND913            YES, ERROR                           47700020
         LA    R2,F12(R2)          POINT TO NEXT VOLUME                 47720020
         BCT   R3,NAMETEST         IF MORE VOLUMES, GO CHECK THEM       47760020
         B     RENMERR             ELSE, RENAME ERROR                   47800020
BLDLERR  STC   R15,RC              SAVE BLDL RETURN CODE                47840020
         CLI   RC,RC4              IS RETURN CODE = 4                   47880020
         BE    NOMEM               YES, MEMBER NOT FOUND                47920020
         BAL   R11,DSNOTREN        GO GET FIRST LEVEL MESSAGE           47960020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         48000020
         LA    R2,S21              SECOND LEVEL MESSAGE NUMBER 21       48040020
         B     BLDSMSG             GO BUILD SECOND LEVEL MESSAGE        48080020
DSNOTREN LA    R10,DSNMESGL        POINT TO DSNAME INSERTION            48120020
         LA    R2,M07              MESSAGE NUMBER 7                     48160020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     48200020
         BR    R11                 RETURN FOR SECOND LEVEL MESSAGE      48240020
STWERROR STC   R15,RC              SAVE STOW RETURN CODE                48280020
         CLI   RC,RC8              IS RETURN CODE = 8                   48320020
         BE    NOMEM               YES, MEMBER NOT FOUND                48360020
         CLI   RC,RC4              IS RETURN CODE = 4                   48400020
         BE    NONEWMEM            YES, NEW MEMBER EXISTS               48440020
         CLI   RC,RC12             IS RETURN CODE = 12                  48480020
         BE    ALIASERR            YES, NO SPACE FOR ALIAS              48520020
         BAL   R11,DSNOTREN        GO GET FIRST LEVEL MESSAGE           48560020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         48600020
         LA    R2,S22              SECOND LEVEL MESSAGE NUMBER 22       48640020
         B     BLDSMSG             GO BUILD SECOND LEVEL MESSAGE        48680020
NODSN1   LA    R3,MEMMSG1          POINT TO MEMBER MESSAGE BUFFER       48720020
         L     R4,F8(R5)           POINT TO MEMBER NAME                 48760020
         LH    R2,F12(R5)          LENGTH OF MEMBER NAME                48800020
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    48840020
         EX    R2,MOVEINST         MOVE MEMBER NAME TO MESSAGE BUFFER   48880020
         LA    R2,F5(R2)           1 FOR EXECUTE, 4 FOR HEADER          48920020
         STH   R2,MEMMSGL1         SAVE LENGTH IN INSERTION BUFFER      48960020
         LA    R2,M09              MESSAGE NUMBER 9                     49000020
         LA    R10,MEMMSGL1        POINT TO MEMBER NAME INSERTION       49040020
         B     BLDMESG             GO WRITE MESSATE                     49080020
*  THIS ROUTINE CHECKS FOR ATTENTION INTERRUPT                          49120020
TESTATTN TM    RENCPECB,MASK1      IS ECB POSTED (DID INTERRUPT OCCUR)  49160020
         BO    CLUPRCC             YES, CLEANUP AND RETURN     @ZA01485 49200037
         BR    R14                 RETURN                               49240020
*        THIS ROUTINE PRINTS ERROR MESSAGES                             49280020
TPUT     BAL   R14,TESTATTN        GO CHECK FOR INTERRUPT               49320020
         LA    R1,IOPARM           POINT TO PUTLINE GENERAL PARAMETERS  49400020
         PUTLINE  PARM=PUT,OUTPUT=(OUTAREA1,MULTLVL),MF=(E,(1)),       X49440020
               TERMPUT=(EDIT,WAIT)                                      49480020
         LTR   R15,R15             TEST RETURN CODE                     49520020
         BZ    TESTSW              CONTINUE PROCESSING                  49560020
         LA    R3,F4               REGISTER 3 = 4                       49600020
         CR    R3,R15              DID ATTENTION OCCUR                  49640020
         BE    CLUPRCC             YES, CLEANUP AND RETURN     @ZA01485 49680037
TESTSW   LTR   R8,R8               PROCESSING ASTERISK                  49690020
         BZ    NOTSTAR             NO, CONTINUE                         49700020
         BAL   R14,SAVESTAR        YES, SAVE ASTERISK VALUE             49710020
NOTSTAR  CLI   UNALOCSW,SWON       IS UNALLOCATE SWITCH ON              49720020
         BE    UNALOCDS            YES, GO UNALLOCATE DATA SET          49760020
         B     LISTEST             NO CONTINUE PROCESSING               49800020
*  SUBROUTINE TO SAVE ASTERISK VALUE                                    49805000
SAVESTAR L     R2,STARPTR          POINT TO NEXT SLOT                   49810020
         LA    R3,STAREND          POINT TO END OF LIST                 49820020
         MVC   F0(F8,R2),LEVELSCN  MOVE ERROR VALUE TO LIST             49830020
         LA    R2,F8(R2)           POINT TO NEXT SLOT                   49832020
         CR    R3,R2               END OF LIST                          49834020
         BCR   EQ,R14              YES, RETURN                          49836020
         ST    R2,STARPTR          SAVE ADDRESS OF NEXT SLOT            49838020
         BR    R14                 RETURN                               49838420
*  ROUTINES TO SET UP ERROR MESSAGES                                    49839200
OVR20VOL BAL   R11,DSNOTREN        GO GET FIRST LEVEL MESSAGE           49840020
         LA    R2,S23              SECOND LEVEL MESSAGE NUMBER 23       49880020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        49920020
RENMERR  BAL   R11,DSNOTREN        GO GET FIRST LEVEL MESSAGE           49960020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         50000020
         LA    R2,S20              SECOND LEVEL MESSAGE NUMBER 20       50040020
         B     BLDSMSG             GO BUILD SECOND LEVEL MESSAGE        50080020
BADCOMND LA    R2,M08              MESSAGE NUMBER 8                     50280020
         BAL   R14,MSGBLD          GO BUILD MESSAGE                     50360020
         MVI   ENDERROR,SWON       TURN ON END ERROR SWITCH             50400020
         BR    R11                 RETURN FOR SECOND LEVEL MESSAGE      50440020
BADKEYWD LA    R2,M05              MESSAGE NUMBER 5                     50480020
         BAL   R14,MSGBLD          GO BUILD MESSAGE                     50560020
         MVI   ENDERROR,SWON       TURN ON END ERROR SWITCH             50600020
         LA    R2,S16              SECOND LEVEL MESSAGE NUMBER 16       50640020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        50680020
BADDSN5  BAL   R11,BADCOMND        GO GET FIRST LEVEL MESSAGE           50720020
         LA    R2,S27              SECOND LEVEL MESSAGE 27              50760020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        50800020
BADDSN4  BAL   R11,BADCOMND        GO GET FIRST LEVEL MESSAGE           50840020
         LA    R2,S29              SECOND LEVEL MESSAGE NUMBER 29       50880020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        50920020
BADDSN2  BAL   R11,BADCOMND        GO GET FIRST LEVEL MESSAGE           50960020
         LA    R2,S28              SECOND LEVEL MESSAGE NUMBER 28       51000020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        51040020
UNCATBAD STH   R15,CATERCDE        SAVE UNCATALOG ERROR CODE            51060020
UNCATERR LA    R10,DSNMESGL        POINT TO DSNAME INSERTION            51080020
         LA    R2,M10              MESSAGE NUMBER 10                    51120020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     51160020
         MVI   ERRORSW,SWOFF       TURN ERROR SWITCH OFF                51180020
         LH    R15,CATERCDE        RESTORE UNCATALOG ERROR CODE         51200020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         51240020
         LA    R2,S10              SECOND LEVEL MESSAGE NUMBER 10       51280020
         B     BLDSMSG             GO BUILD MESSAGE                     51320020
*  ABEND MESSAGES                                                       51320500
IKJEH713 EQU   *                   ALIAS FOR ABEND713                   51321020
ABEND713 BAL   R11,MESG03          GO GET FIRST LEVEL MESSAGE           51326020
         LA    R2,S30              SECOND LEVEL MESSAGE 30              51328020
         B     ZEROR10             GO BUILD MESSAGE                     51330020
IKJEH913 EQU   *                   ALIAS FOR ABEND913                   51331020
ABEND913 LA    R10,DSNMESGL        POINT TO DSNAME INSERTION            51332020
         LA    R2,M16              MESSAGE NUMBER 16                    51334020
         B     BLDMESG             GO BUILD MESSAGE                     51336020
IKJEH13  EQU   *                   ALIAS FOR ABEND13                    51337020
ABEND13  LA    R10,DSNMESGL        POINT TO DSNAME INSERTION            51338020
         LR    R15,R1              MOVE ABEND CODE TO REGISTER 15       51340020
         LA    R2,M04              MESSAGE NUMBER 4                     51342020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     51344020
         BAL   R3,BITOHEX          GO SET RETURN CODE INSERTION         51346020
         LA    R2,S13              SECOND LEVEL MESSAGE 13              51348020
         B     BLDSMSG             GO BUILD MESSAGE                     51350020
NODDS    LA    R10,DSNMESGL        POINT TO DSNAME INSERTION            51360020
         LA    R2,M11              MESSAGE NUMBER 11                    51400020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     51440020
         LA    R2,S01              SECOND LEVEL MESSAGE 1               51450020
         B     ZEROR10             GO BUILD MESSAGE                     51460020
MESG03   LA    R10,DSNMESGL        POINT TO DSNAME INSERTION            51520020
         LA    R2,M03              MESSAGE NUMBER 3                     51560020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     51600020
         BR    R11                 RETURN FOR SECOND LEVEL              51610020
DSNOTFND LA    R10,DSNMESGL        POINT TO DSNAME INSERTION            51960020
         LA    R2,M01              MESSAGE NUMBER 1                     52000020
         B     BLDMESG             GO WRITE MESSAGE                     52040020
VOLNTMTD LA    R2,M13              MESSAGE NUMBER 13                    52200020
         LA    R10,DSNMESGL        POINT TO INSERTION                   52240020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     52280020
         LA    R2,S03              SECOND LEVEL MESSAGE NUMBER 3        52320020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        52360020
DSNTOVOL LA    R2,M12              MESSAGE NUMBER 12                    52400020
         LA    R10,DSNMESGL        POINT TO INSERTION                   52440020
         BAL   R14,MSGBUILD        GO BUILD MESSAGE                     52480020
         LA    R2,S02              SECOND LEVEL MESSAGE NUMBER2         52520020
         B     ZEROR10             GO BUILD SECOND LEVEL MESSAGE        52560020
PARSEERR STC   R15,RC              SAVE PARSE RETURN CODE               52600020
         MVI   STACKSW,SWON        TURN STACK SWITCH ON                 52610020
         CLI   RC,RC12             ATTENTION INTERRUPT OR NOPROMPT      52640020
         BL    CLUPRCC             YES, CLEANUP AND RETURN     @ZA01485 52680037
         MVI   ENDERROR,SWON       TURN ON END ERROR SWITCH             52720020
         BH    NOSPACE             NO CORE                              52800020
         BAL   R11,MESG25          GO BUILD MESSAGE                     52810020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         52820020
         LA    R2,S08              SECOND LEVEL MESSAGE 8               52830020
         B     BLDSMSG             GO BUILD MESSAGE                     52840020
MESG25   LA    R2,M25              MESSAGE 25                           52860020
         BAL   R14,MSGBLD          GO BUILD MESSAGE                     52870020
         BR    R11                 RETURN FOR SECOND LEVEL              52880020
NOSPACE  LA    R2,M02              MESSAGE NUMBER 2                     52920020
NOINSERT SR    R10,R10             NO INSERTION                         52930020
BLDMESG  BAL   R14,MSGBUILD        GO BUILD MESSAGE                     52940020
         B     TPUT                GO WRITE MESSAGE                     52950020
SAVUNQL1 EX    R2,MOVEINST         DSNAME TO MESSAGE BUFFER             53010020
         LA    R2,F5(R2)           1 EXECUTE, 4 HEADER                  53060020
         B     SAVELN1             GO SAVE LENGTH                       53120020
SAVUNQL2 EX    R2,MOVEINST         DSNAME TO MESSAGE BUFFER             53130020
         LA    R2,F5(R2)           1 EXECUTE, 4 HEADER                  53140020
         B     SAVELN2             GO SAVE LENGTH                       53152020
DAERROR  BAL   R11,MESG25          GO GET FIRST LEVEL MESSAGE           53154020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         53156020
         LA    R2,S15              SECOND LEVEL MESSAGE 15              53158020
         B     BLDSMSG             GO BUILD MESSAGE                     53158420
CIRLTST  LA    R5,F4               PUT A FOUR IN REG 5         @YL026YB 53158600
         CR    R15,R5              SEE IF REG 15 CONTAINS A 4  @YL026YB 53158800
         BNE   CIRERROR            NO RETURN CODE IN CIRLOCRC  @YL026YB 53159000
         SR    R8,R8               CLEAR ASTERISK INDICATOR    @YL026YB 53159200
         B     DSNOTFND            GO BUILD MESSAGE            @ZA06145 53159437
CIRERROR LA    R10,STARBUFF        POINT TO INSERTION                   53160020
         LA    R2,M19              MESSAGE NUMBER 19                    53200020
         SR    R8,R8               CLEAR ASTERISK INDICATOR             53210020
         B     BLDMESG             GO BUILD MESSAGE                     53240020
*  CATALOG ERROR MESSAGES                                               53260000
DSNCATLG LH    R15,DA08CTRC-DAPB08(R2) CATALOG RETURN CODE              53280020
         STC   R15,RC              SAVE CATALOG RETURN CODE             53320020
         CLI   RC,RC8              RETURN CODE = 8                      53440020
         BL    VOLNTMTD            VOLUME NOT MOUNTED                   53450020
         CLI   RC,RC20             RETURN CODE = 20                     53460020
         BH    CATLGIO             CATALOG I/O ERROR                    53470020
         BNE   DSNOTFND            DATA SET NOT CATALOGED               53480020
         BAL   R11,SYSTEMER        GO GET FIRST LEVEL MESSAGE           53520020
         BAL   R3,BITOHEX          GO SET RETURN CODE INSERTION         53560020
         LA    R2,S04              SECOND LEVEL MESSAGE NUMBER 4        53600020
         B     BLDSMSG             GO BUILD MESSAGE                     53640020
DSNBIG1  LA    R10,DSNMESGL        POINT TO INSERTION                   53680020
         LA    R1,DSLO             POINT TO DSNAME BUFFER               53690020
DSNBIG   L     R4,UPTSAVE          UPT ADDRESS                 @YL026YB 53760000
         LA    R3,F4(R10)          DSNAME INSERTION BUFFER              53790000
         SR    R2,R2               CLEAR REGISTER                       53820000
         IC    R2,UPTPREFL-UPT(R4) LENGTH OF USERID            @YL026YB 53850000
         LTR   R2,R2               CHECK PREFIXING LENGTH FOR ZERO      53880000
         BZ    NOPREX2             NO PREFIXING                         53910000
         EX    R2,MOVE1            USERID TO DSNAME BUFFER     @YL026YB 53940000
*  THIS MOVED ONE EXTRA BYTE WHICH WILL NOW BE OVERLAID WITH A PERIOD   54000020
         AR    R3,R2               POINT PAST USERID                    54040020
         MVI   F0(R3),PERIOD       MOVE IN PERIOD                       54080020
         LA    R3,F1(R3)           POINT PAST PERIOD                    54120020
NOPREX2  LA    R4,F2(R1)           ADDRESS OF DATA SET NAME             54160000
         LH    R5,F0(R1)           LENGTH OF DATA SET NAME              54200020
         AR    R2,R5               PLUS LENGTH OF USERID                54240020
         LA    R2,F5(R2)           ONE FOR PERIOD, FOUR FOR HEADER      54280020
         BCTR  R5,R0               DECREMENT FOR EXECUTE                54320020
         EX    R5,MOVEINST         MOVE DATA SET NAME TO USERID         54360020
         STH   R2,F0(R10)          SAVE TOTAL LENGTH                    54400020
         LA    R2,M18              MESSAGE NUMBER 18                    54440020
         B     BLDMESG             GO BUILD AND WRITE MESSAGE           54520020
*  CONVERT RETURN CODE, SUPPRESS LEADING ZEROS AND MOVE TO INSERTION    54560020
*  BUFFER.  INPUT - R15 CONTAINS RETURN CODE TO BE CONVERTED            54600020
*           OUTPUT - R10 POINTS TO INSERTION BUFFER                     54640020
*  R2 IS THE RETURN REGISTER                                            54680020
CONVRTRC CVD   R15,UNPACK          CONVERT TO PACKED DECIMAL FORMAT     54720020
         UNPK  COUNT,UNPACK        CONVERT TO ZONED FORMAT              54760020
         OI    SIGNBYTE,ZONE       ZONE OVER SIGN                       54800020
*  SUPPRESS LEADING ZEROS IN RETURN CODE                                54840020
         LA    R4,COUNT            POINT TO COUNT BUFFER                54880020
         LA    R5,F7               R5 = 7                               54920020
SUPPZERO CLI   F0(R4),FOXZERO      IS THIS LEADING ZERO                 54960020
         BNE   NOTZERO             NO, GO MOVE RETURN CODE              55000020
         LA    R4,F1(R4)           YES, POINT TO NEXT DIGIT             55040020
         BCT   R5,SUPPZERO         GO CHECK NEXT DIGIT                  55080020
NOTZERO  LA    R5,ENDCOUNT         POINT PAST COUNT BUFFER              55120020
         SR    R5,R4               NUMBER OF SIGNIFICANT DIGITS IN R5   55160020
         BCTR  R5,R0               DECREMENT FOR EXECUTE                55200020
         LA    R3,RCMESG           POINT TO RETURN CODE BUFFER          55240020
         EX    R5,MOVEINST         MOVE RETURN CODE TO INSERTION BUFFER 55280020
         LA    R5,F5(R5)           4 FOR HEADER AND 1 FOR EXECUTE       55320020
         STH   R5,RCMESGL          LENGTH OF RETURN CODE INSERTION      55360020
         LA    R10,RCMESGL         POINT TO INSERTION BUFFER            55400020
         BR    R2                  RETURN                               55440020
*  BINARY TO HEXIDECIMAL CONVERSION ROUTINE                             55441020
*        INPUT - R15 CONTAIN RETURN CODE TO BE CONVERTED                55442020
*        OUTPUT - R10 POINTS TO INSERTION BUFFER                        55443020
*  R3 IS THE RETURN REGISTER                                            55444020
BITOHEX  SLL   R15,F16             SHIFT RETURN CODE TO HIGH HALF REG.  55445020
         LA    R10,RCMESG          POINT TO RETURN CODE BUFFER          55446020
         LA    R5,F4               FOUR HALF BYTES TO CONVERT           55447020
HEXLOOP  XR    R14,R14             CLEAR REGISTER                       55448020
         SLDL  R14,F4              MOVE HALF BYTE TO WORK REGISTER      55449020
         IC    R14,TRANSTAB(R14)   SELECT CHARACTER                     55450020
         STC   R14,F0(R10)         PUT CHARACTER IN RETURN CODE BUFFER  55451020
         LA    R10,F1(R10)         UP POINTER FOR NEXT CHARACTER        55452020
         BCT   R5,HEXLOOP          IF MORE TO CONVERT, CONTINUE         55453020
         CLI   RCMESG,FOXZERO      TEST FOR LEADING ZERO                55454020
         BNE   HEXGO               NOT ZERO,                            55455020
         MVI   RCMESG,BLANK        SUPPRESS LEADING ZERO                55456020
HEXGO    LA    R14,F8              4 FOR LENGTH PLUS FOUR FOR HEADER    55457020
         STH   R14,RCMESGL         LENGTH TO INSERTION BUFFER           55458020
         LA    R10,RCMESGL         POINT TO INSERTION BUFFER            55459020
         BR    R3                  RETURN                               55460020
*  THIS IS THE MESSAGE BUILD SUBROUTINE.  IT ACCESSES THE MESSAGE CSECT 55480020
*  TO OBTAIN THE ADDRESS OF THE MESSAGE SEGMENT AND THE OFFSET AT WHICH 55520020
*  ANY INSERTIONS WILL BE MADE.                                         55560020
*  AT ENTRY R2 CONTAINS MESSAGE NUMBER AND R10 CONTAINS ADDRESS OF THE  55600020
*  INSERTION.  R14 IS THE RETURN REGISTER  (R10 = 0 IS NO INSERTION)    55640020
*                                                                       55680020
MSGBLD   SR    R10,R10             NO INSERTION                         55690020
MSGBUILD SR    R3,R3               ZERO REGISTER                        55720020
         ST    R3,OUTAREA1         SET POINTER INDICATING ONE MESSAGE   55760020
         MVI   OUTAREA1,ENDTEST    FLAG END OF MESSAGE CHAIN            55800020
         L     R1,VCONMSG          ADDRESS OF MESSAGE BRANCH TABLE      55840020
         BCTR  R2,R0               DECREMENT MESSAGE NUMBER             55880020
         SLL   R2,TWO              MULTIPLY MESSAGE NUMBER BY 4         55920020
         L     R3,F0(R2,R1)        LOAD BRANCH TABLE ENTRY              55960020
         ST    R3,WORKWORD         SAVE THIS ENTRY                      56000020
         LA    R3,F0(R3)           CLEAR HIGH ORDER BYTE                56040020
         ST    R3,OUTPUT11         MESSAGE ADDRESS TO OUTPUT LIST       56080020
         LTR   R10,R10             IS THERE AN INSERTION                56120020
         BZ    NOINSRT1            NO, GO SET SEGMENT COUNT TO 1        56160020
         SR    R2,R2               ZERO REGISTER                        56200020
         IC    R2,WORKWORD         GET OFFSET FOR INSERTION             56240020
         STH   R2,F2(R10)          STORE OFFSET IN MESSAGE OFFSET FIELD 56280020
         ST    R10,OUTPUT12        INSERTION ADDRESS TO OUTPUT LIST     56320020
         LA    R2,TWO              2 SEGMENTS                           56360020
SETCNT1  ST    R2,OUTCNT1          SET SEGMENT COUNT                    56400020
         MVI   ERRORSW,SWON        TURN ERROR SWITCH ON                 56420020
         MVI   STACKSW,SWON        TURN STACK SWITCH ON                 56430020
         BR    R14                 RETURN                               56440020
NOINSRT1 LA    R2,ONE              ONE SEGMENT                          56480020
         B     SETCNT1             GO SET SEGMENT COUNT                 56520020
*                                                                       56560020
*  THIS IS THE SECOND LEVEL MESSAGE BUILD SUBROUTINE.  IT ACCESSES THE  56600020
*  MESSAGE CSECT TO OBTAIN THE ADDRESS OF THE SECOND LEVEL MESSAGE AND  56640020
*  THE OFFSET AT WHICH ANY INSERTIONS WILL BE MADE.                     56680020
*  AT ENTRY R2 CONTAINS SECOND LEVEL MESSAGE NUMBER AND R10 CONTAINS    56720020
*  ADDRESS OF THE INSERTION.  (R10 = 0 IS NO INSERTION).                56760020
*  MESSAGE IS BUILT AND CONTROL PASSED TO TPUT ROUTINE TO WRITE MESSAGE 56800020
*                                                                       56840020
ZEROR10  SR    R10,R10             NO INSERTION                         56850020
BLDSMSG  EQU   *                   ALIAS FOR SMSGBLD                    56860020
SMSGBLD  SR    R3,R3               ZERO REGISTER                        56880020
         ST    R3,OUTAREA2         SET POINTER INDICATING LAST MESSAGE  56920020
         MVI   OUTAREA2,ENDTEST    FLAG END OF MESSAGE CHAIN            56960020
         LA    R3,OUTAREA2         POINT TO SECOND LEVEL MESSAGE CHAIN  57000020
         ST    R3,OUTAREA1         CHAIN SECOND LEVEL TO FIRST LEVEL    57040020
         L     R1,VCONSMSG         SECOND LEVEL MESSAGE BRANCH TABLE    57080020
         BCTR  R2,R0               DECREMENT MESSAGE NUMBER             57120020
         SLL   R2,TWO              MULTIPLY MESSAGE NUMBER BY 4         57160020
         L     R3,F0(R2,R1)        LOAD BRANCH TABLE ENTRY              57200020
         ST    R3,WORKWORD         SAVE THIS ENTRY                      57240020
         LA    R3,F0(R3)           CLEAR HIGH ORDER BYTE                57280020
         ST    R3,OUTPUT21         MESSAGE ADDRESS TO OUTPUT LIST       57320020
         LTR   R10,R10             IS THERE AN INSERTION                57360020
         BZ    NOINSRT2            NO, GO SET SEGMENT COUNT TO 1        57400020
         SR    R2,R2               ZERO REGISTER                        57440020
         IC    R2,WORKWORD         GET OFFSET FOR INSERTION             57480020
         STH   R2,F2(R10)          STORE OFFSET IN MESSAGE OFFSET FIELD 57520020
         ST    R10,OUTPUT22        INSERTION ADDRESS TO OUTPUT LIST     57560020
         LA    R2,TWO              2 SEGMENTS                           57600020
SETCNT2  ST    R2,OUTCNT2          SET SEGMENT COUNT                    57640020
         B     TPUT                GO WRITE MESSAGE                     57680020
NOINSRT2 LA    R2,ONE              ONE SEGMENT                          57720020
         B     SETCNT2             GO SET SEGMENT COUNT                 57760020
SETSW    MVI   DEFLTSW,SWON        TURN DEFAULT SWITCH ON               57770020
*  NOW MOVE UPDATED DSNAME TO MESSAGE AREA                              57800020
ERRORDS1 LH    R2,DSLO             LENGTH OF FULLY QUALIFIED DSNAME     57840020
         LA    R3,DSNMSG1          POINT TO MESSAGE INSERTION BUFFER    57880020
         LA    R4,DSNO             POINT TO DATA SET NAME               57920020
         LA    R5,DSNAME1          POINT TO PDE FIRST DSNAME            57960020
         TM    F6(R5),QUOTEMSK     WAS DATA SET NAME QUOTED             58000020
         BO    SAVENME1            YES, GO SAVE NAME                    58040020
         L     R5,UPTSAVE          ADDRESS OF UPT              @YL026YB 58080000
         SR    R1,R1               CLEAR REGISTER                       58100000
         IC    R1,UPTPREFL-UPT(R5) LENGTH OF USERID            @YL026YB 58120000
         LTR   R1,R1               CHECK PREFIXING LENGTH      @YL026YB 58140000
         BZ    SAVENME1            NO PREFIXING                @YL026YB 58160000
         LA    R1,F1(R1)           PLUS ONE FOR THE PERIOD              58200020
         SR    R2,R1               SUBTRACT LENGTH OF USERID            58240020
         AR    R4,R1               POINT PAST USERID                    58280020
SAVENME1 BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    58320020
         EX    R2,MOVEINST         MOVE DSNAME TO ERROR BUFFER          58360020
         LA    R2,F5(R2)           1 FOR EXECUTE, 4 FOR HEADER          58400020
         STH   R2,DSNMSGL1         SAVE LENGTH OF DATA SET NAME         58440020
         CLI   DEFLTSW,SWON        IS NAME FROM DEFAULT ROUTINE         58480020
         BE    QUAL2               YES, GO QUALIFY SECOND DSNAME        58520020
         CLI   ISWITCH,SWON        IS THIS INDEX '*' NAME               58560020
         BE    RENSEQDS            YES, GO VALIDITY CHECK NAME          58600020
BLDDSN2  LA    R3,DSNN             POINT TO BUILD BUFFER                58680020
         LA    R4,DSNBUFFN         POINT TO INDEX STRUCTURE             58720020
         L     R2,STARADR2         LOAD POINTER TO ASTERISK             58760020
         SR    R2,R4               LENGTH OF DSNAME TO ASTERISK         58800020
         LR    R1,R2               LENGTH OF STRUCTURE TO ASTERISK      58840020
         LA    R1,F1(R1)           LENGTH OF DSNAME INCLUDING ASTERISK  58880020
         EX    R2,MOVEINST         MOVE INDEX STRUCTURE                 58920020
*  THIS MOVES ONE EXTRA BYTE WHICH WILL BE OVERLAID WITH THE QUALIFIER  58960020
         AR    R3,R2               POINT PAST MOVED STRUCTURE           59000020
         LH    R5,NAMELTH          LENGTH OF QUALIFIER                  59040020
         AR    R2,R5               TOTAL LENGTH NAME PLUS QUALIFIER     59080020
         LA    R4,LEVELSCN         POINT TO QUALIFIER NAME              59120020
         BCTR  R5,R0               DECREMENT FOR EXECUTE INSTRUCTION    59160020
         EX    R5,MOVEINST         MOVE QUALIFIER TO NAME               59200020
         CH    R1,DSBLN            PROCESSING '*' NAME                  59240020
         BNE   BLDINDX2            NO, GO BUILD INDEX NAME              59280020
         STH   R2,DSLN             SAVE TOTAL LENGTH                    59320020
         B     ERRORDS2            GO SAVE SECOND DSNAME FOR MESSAGE    59360020
BLDINDX2 AR    R3,R5               POINT PAST INDEX NAME                59400020
         LA    R3,F1(R3)           PLUS ONE FROM EXECUTE                59440020
         L     R4,STARADR2         POINT AT ASTERISK                    59480020
         LA    R4,F1(R4)           POINT PAST ASTERISK                  59520020
         LA    R5,DSNBUFFN         POINT TO DSNAME                      59560020
         AH    R5,DSBLN            POINT PAST DSNAME                    59600020
         SR    R5,R4               LENGTH OF DSNAME AFTER ASTERISK      59640020
         AR    R2,R5               TOTAL LENGTH OF COMPLETE DSNAME      59680020
         CH    R2,MAXLENTH         MORE THAN 44 CHARACTERS              59720020
         BH    DSNBIG2             YES, ERROR                           59760020
         STH   R2,DSLN             SAVE TOTAL LENGTH                    59800020
         BCTR  R5,R0               DECREMENT FOR EXECUTE INSTRUCTION    59840020
         EX    R5,MOVEINST         MOVE REST OF NAME           @YL026YB 59880000
ERRORDS2 LH    R2,DSLN             LENGTH OF FULLY GUALIFIED DSNAME     59960020
         LA    R3,DSNMSG2          POINT TO MESSAGE INSERTION BUFFER    60000020
         LA    R4,DSNN             POINT TO DATA SET NAME               60040020
         LA    R5,DSNAME2          POINT TO PDE SECOND DSNAME           60080020
         TM    F6(R5),QUOTEMSK     WAS DATA SET NAME QUOTED             60120020
         BO    SAVENME2            YES, GO SAVE NAME                    60160020
         L     R5,UPTSAVE          ADDRESS OF PSCB             @YL026YB 60200000
         SR    R1,R1               ZERO REGISTER               @YL026YB 60220000
         IC    R1,UPTPREFL-UPT(R5) LENGTH OF USERID            @YL026YB 60240000
         LTR   R1,R1               CHECK PREFIXING LENGTH               60260000
         BZ    SAVENME2            NO PREFIXING                         60280000
         LA    R1,F1(R1)           PLUS ONE FOR THE PERIOD              60320020
         SR    R2,R1               SUBTRACT LENGTH OF USERID            60360020
         AR    R4,R1               POINT PAST USERID                    60400020
*  SAVE SECOND NAME IF FIRST NAME BAD                                   60420000
SAVENME2 BCTR  R2,R0               DECREMENT FOR EXECUTE INSTRUCTION    60440020
         EX    R2,MOVEINST         MOVE DSNAME TO ERROR BUFFER          60480020
         LA    R2,F5(R2)           1 FOR EXECUTE, 4 FOR HEADER          60520020
         STH   R2,DSNMSGL2         SAVE LENGTH OF DATA SET NAME         60560020
         B     MEMCHECK            GO CHECK FOR MEMBER NAMES            60600020
*  BUILD FULLY QUALIFIED NAMES                                          60640000
QUALIFY1 LA    R1,DFLTPARM         POINT TO DEFAULT PARAMETER LIST      60680020
         LINK  EP=IKJDFLT          GO TO DEFAULT SERVICE ROUTINE        60760020
         B     DFLTERR1(R15)       ANALYZE DEFAULT RETURN CODE          60810020
DFLTERR1 B     SETSW               DEFAULT RETURN CODE = 0              60860020
         B     FLUSH               DEFAULT RETURN CODE = 4              60910020
         B     DSNBIG1             DEFAULT RETURN CODE = 8              60960020
         B     FLUSH               DEFAULT RETURN CODE = 12             61010020
         B     DSNOTFND            DEFAULT RETURN CODE = 16             61060020
         B     DSNOTFND            DEFAULT RETURN CODE = 20             61110020
         B     FLUSH               DEFAULT RETURN CODE = 24             61120020
         B     DEFAULT             DEFAULT RETURN CODE = 28             61130020
         B     FLUSH               DEFAULT RETURN CODE = 32             61140020
         B     DSNOTFND            DEFAULT RETURN CODE = 36             61150020
DEFAULT  BAL   R11,MESG25          GO GET FIRST LEVEL MESSAGE           61152020
         BAL   R2,CONVRTRC         GO SET RETURN CODE INSERTION         61200020
         LA    R2,S07              SECOND LEVEL MESSAGE NUMBER 7        61240020
         B     BLDSMSG             GO BUILD SECOND LEVEL MESSAGE        61280020
QUALIFY2 LA    R14,DFLTPBLK        DEFAULT PARAMETER BLOCK              61290020
         USING DFPB,R14            ADDRESSABILITY FOR DFPB              61300020
         LA    R2,DSLN             NEW DATA SET NAME                    61310020
         ST    R2,DFPBDSN          TO PARAMETER BLOCK                   61320020
         MVI   DFPBCODE,DFPB0C     SET ENTRY CODE                       61330020
         CLI   QUALBUFF,BLANK      WAS QUALIFIER RETURNED               61340020
         BNE   QUALRET             YES, SET CONTROL TO USE IT           61350020
         MVI   DFPBCNTL,DFPBUID    SET CONTROL BYTE                     61360020
         B     QUALGO              CONTINUE                             61362020
QUALRET  MVI   DFPBCNTL,DFPBUID+DFPBADD SET CONTROL BYTE                61364020
QUALGO   LA    R1,DFLTPARM         DEFAULT PARAMETER LIST               61366020
         DROP  R14                 DFPB NO LONGER NEEDED                61368420
         LINK  EP=IKJDFLT          QUALIFY SECOND DSNAME                61368820
         B     DFLTERR2(R15)       ANALYZE DEFAULT RETURN CODE          61369220
DFLTERR2 B     ERRORDS2            DEFAULT RETURN CODE = 0              61369620
         B     FLUSH               DEFAULT RETURN CODE = 4              61369720
         B     DSNBIG2             DEFAULT RETURN CODE = 8              61369820
         B     FLUSH               DEFAULT RETURN CODE = 12             61369920
         B     INDEXBAD            DEFAULT RETURN CODE = 16             61370020
         B     DEFAULT             DEFAULT RETURN CODE = 20             61380020
         B     FLUSH               DEFAULT RETURN CODE = 24             61430020
         B     DEFAULT             DEFAULT RETURN CODE = 28             61432020
         B     FLUSH               DEFAULT RETURN CODE = 32             61434020
         B     DEFAULT             DEFAULT RETURN CODE = 36             61436020
FLUSH    MVI   STACKSW,SWON        TURN STACK SWITCH ON                 61438020
         B     CLUPRCC             EXIT                        @ZA01485 61438437
         EJECT                                                          61440020
*                                                                       61480020
*              WORKAREA - REQUIRED CONSTANTS (IKJEHRN2)                 61520020
*                                                                       61560020
RN2CNSTS DS    0F                  CONSTANTS FOR IKJEHRN2 BEGIN HERE    61570020
VCONMSG  DC    V(IKJEHMSG)         ENTRY MESSAGE CSECT 1ST LEVEL        61600020
VCONSMSG DC    V(IKJEHSMG)         ENTRY MESSAGE CSECT 2ND LEVEL        61640020
VCONRN3  DC    V(IKJEHRN3)         ENTRY POINT THIRD CSECT              61650020
VCONRN4  DC    V(IKJEHRN4)         ENTRY POINT FOURTH CSECT    @YL026YB 61660000
FOXMASK  DC    X'FFFFFFFF'         MASK TO COMPLEMENT GENERATION NAME   61666000
SUBPOL1  DC    X'01000000'         SUBPOOL NUMBER              @YL026YB 61672000
         DS    0H                  ALIGN HALF WORD BOUNDRY              61680020
DARC0204 DC    X'0204'             DARC NO CORE                         61720020
DARC0210 DC    X'0210'             DARC DATA SET IN USE                 61760020
DARC0218 DC    X'0218'             DARC VOLUME NOT MOUNTED              61800020
DARC6708 DC    X'6708'             DARC DATA SET NOT ON VOLUME          61840020
DARC021C DC    X'021C'             DARC BAD UNIT INFORMATION            61850020
DARC0214 DC    X'0214'             DARC NO UNIT AVAILABLE               61860020
DARC041C DC    X'041C'             DARC MULTI VOLUME DATA SET           61870020
MAXLENTH DC    H'44'               MAXIMUM DATA SET LENGTH              61880020
MINMAX   DC    H'10000'            LENGTH FOR GETMAIN AREA     @ZA27595 61920003
MOVEINST MVC   F0(F0,R3),F0(R4)    MOVE INSTRUCTION FOR EXECUTE         61926000
MOVE1    MVC   F0(F0,R3),UPTPREFX-UPT(R4)  MOVE INSTRUCTION FOR EX.     61932000
TRANSTAB DC    C'0123456789ABCDEF' TRANSLATE TABLE FOR BITOHEX ROUTINE  61940020
         EJECT                                                          61960020
IKJEHRN3 CSECT                                                          61962020
         USING IKJEHRN3,R15        ADDRESSABILITY FOR CSECT             61964020
         USING IHADCB,R1X          ADDRESSABILITY FOR WORKAREA          61966020
*********************************************************************** 61970020
*              ASTERISK SCAN ROUTINE                                    61980020
*  THIS ROUTINE SCANS THE DATA SET NAME AND LOCATES ASTERISK            61990020
*  QUALIFIERS, IF PRESENT.  IT ALSO CHECKS THAT THE ASTERISK DOES NOT   61992020
*  OCCUR IN THE FIRST INDEX LEVEL AND THAT THERE IS NOT MORE THAN ONE   61994020
*  ASTERISK IN THE DATA SET NAME.  NOTE-  THE SCAN BY PARSE HAS CHECKED 61996020
*  SYNTAX OF DATA SET NAME WITH ASTERISK ALLOWED IN PLACE OF ANY INDEX  61998020
*  LEVEL.                                                               61998420
*  INPUT-      R2 POINTS TO DSNAME TO BE SCANNED                        61998820
*              R3 CONTAINS LENGTH OF THIS DSNAME                        61999220
*              R14 IS RETURN REGISTER                                   61999620
*  REGISTERS 2, 3, 4, AND 6 ARE USED                                    61999720
*  RETURN IS AS FOLLOWS-                                                61999820
*              0 PAST R14 IF * FOUND IN FIRST INDEX LEVEL               61999920
*              4 PAST R14 IF MORE THAN ONE * FOUND                      62013220
*              8 PAST R14 IF SCAN SUCCESSFULLY COMPLETED                62023220
*                                                                       62025220
SCANDSN  SR    R4,R4               ZERO REGISTER                        62025620
         ST    R4,STARADR2         ZERO POINTER TO ASTERISK             62026020
         STC   R4,STARLEV2         ZERO ASTERISK LEVEL INDICATOR        62026420
         AR    R3,R2               ADD LENGTH AND ADDRESS               62026520
*  REGISTER 3 POINTS PAST LAST CHARACTER OF DATA SET NAME               62026620
         LA    R4,F1               INITIALIZE LEVEL COUNTER TO ONE      62031020
         LR    R6,R4               SET REG 6 TO ONE FOR A LATER TEST    62033020
STARTST2 CLI   F0(R2),STAR         IS THIS CHARACTER AN ASTERISK        62035020
         BE    LEVLTST2            IF *, CHECK INDEX LEVEL              62035420
NXTCHAR2 LA    R2,F1(R2)           POINT TO NEXT CHARACTER              62035520
         CR    R2,R3               ARE THERE MORE CHARACTERS            62046620
         BE    ADD8                IF NOT SCAN IS FINISHED              62056620
         CLI   F0(R2),PERIOD       CHECK FOR PERIOD (NEW INDEX LEVEL)   62057020
         BNE   NXTCHAR2            IF NOT, CHECK NEXT CHARACTER         62057420
         LA    R4,F1(R4)           INCREMENT LEVEL COUNTER              62057520
         LA    R2,F1(R2)           POINT TO NEXT CHARACTER              62057620
         B     STARTST2            NEW INDEX LEVEL, GO CHECK FOR *      62057720
LEVLTST2 CR    R4,R6               IS THIS FIRST INDEX LEVEL            62061420
         BCR   EQ,R14              YES ERROR, * IN FIRST INDEX LEVEL    62063420
         CLI   STARLEV2,ZERO       IS LEVEL INDICATOR ZERO              62063820
         BNE   ADD4                NO, ERROR, MORE THAN ONE ASTERISK    62064220
         ST    R2,STARADR2         SAVE ADDRESS OF ASTERISK             62064620
         STC   R4,STARLEV2         SAVE LEVEL AT WHICH ASTERISK FOUND   62065020
         B     NXTCHAR2            GO CHECK NEXT CHARACTER              62065120
ADD4     LA    R14,F4(R14)         BUMP RETURN ADDRESS BY 4             62068820
         BR    R14                 RETURN                               62068920
ADD8     LA    R14,F8(R14)         BUMP RETURN ADDRESS BY 8             62070920
         BR    R14                 RETURN                               62071320
         DROP  R15                 IKJEHRN3 NO LONGER NEEDED            62071420
*                                                                       62071720
*  WHEN THE SCAN IS FINISHED                                            62072120
*        STARLEV2 WILL CONTAIN LEVEL AT WHICH ASTERISK FOUND            62072520
*        STARADR2 WILL CONTAIN ADDRESS AT WHICH ASTERISK FOUND          62082020
*        BOTH WILL CONTAIN ZERO IF NO ASTERISK FOUND                    62084020
*                                                                       62086020
*********************************************************************** 62088020
*                                                                       62090000
*                                                                       62090100
         EJECT                                                 @YL026YB 62090200
IKJEHRN4 CSECT                                                 @YL026YB 62090300
         USING IKJEHRN4,R15        ADDRESSABLILITY FOR CSECT   @YL026YB 62090400
         USING IHADCB,R1X          ADDRESSABILITY FOR WKAREA   @YL026YB 62090500
*********************************************************************** 62090600
*  THIS SECTION DETERMINES THE LENGTH OF INDEX NAMES AND DATA SET NAMES 62090700
*  FROM THE CATALOG.  THESE NAMES HAVE A MAXIMUM LENGTH OF 8 WHEN       62090800
*  THE ASTERISK IS IN THE LAST POSITION OF THE DATA SET TO BE RENAMED.  62090900
*  OTHERWISE THE MAXIMUM LENGTH OF THE NAMES IS 44. A BLANK    @YL026YB 62091000
*  HAS BEEN STORED IN THE LAST  BYTE OF THE SCAN  BUFFER . THE SCAN     62091100
*  STARTS WITH THE 2ND BYTE AND CONTINUES UNTIL A BLANK IS FOUND.       62091200
*                                                                       62091300
NAMESCAN CLI   CIRPARM,INDEXOPT    IS IT A LIST NAME ENTRY     @YL026YB 62091400
         BE    BLDLIST             YES,GO PROCESS LIST ENTRY   @YL026YB 62091500
         LA    R2,LEVELSCN         ADDRESS OF SCAN BUFFER      @YL026YB 62091600
         MVC   F0(F8,R2),F1(R8)    MOVE NAME TO SCAN BUFFER    @YL026YB 62091700
         LA    R8,F9(R8)           BUMP POINTER FOR NAME ENTRY @YL026YB 62091800
*  TEST FOR GENERATION DATA GROUP DATA SET NAME                @YL026YB 62091900
         CLI   F0(R2),CHARG        TEST FOR G                  @YL026YB 62092000
         BNE   CHCKSTAR            NO,CONTINUE                 @YL026YB 62092100
         CLI   F5(R2),CHARV        TEST FOR V                  @YL026YB 62092200
         BNE   CHCKSTAR            NO, CONTINUE                @YL026YB 62092300
         LA    R6,F4               SET LOOP CONTROL            @YL026YB 62092400
GDGLOOP  LA    R3,F0(R6,R2)        POINT TO CHARACTER TO BE TESTED      62092500
         TM    F0(R3),COMPZONE     TEST FOR COMPLEMENTED NUMBER         62092600
         BNZ   CHCKSTAR            NOT COMPLEMENT, CONTINUE    @YL026YB 62092700
         BCT   R6,GDGLOOP          CHECK NEXT CHARACTER        @YL026YB 62092800
         XC    F1(F4,R2),FOXMASK   COMPLEMENT GENERATION NAME  @YL026YB 62092900
*  NOW SEE IF THIS IS ERROR VALUE ALREADY ATTEMPTED            @YL026YB 62093000
CHCKSTAR L     R6,STARPTR          POINT TO END OF CURRENT LIST         62093100
         LA    R3,STARLIST         POINT TO FIRST ENTRY        @YL026YB 62093200
STARLOOP CR    R6,R3               END OF LIST                 @YL026YB 62093300
         BE    CHECKOPT            YES, GO SCAN ASTERISK VALUE @YL026YB 62093400
         CLC   F0(F8,R3),LEVELSCN  COMPARE * VALUE TO ERROR LIST        62093500
         BE    ERRPROC             ERROR VALUE  ALREADY TRIED  @YL026YB 62093600
         LA    R3,F8(R3)           POINT TO NEXT VALUE OF * (ERROR)     62093700
         B     STARLOOP            GO CHECK THIS VALUE         @YL026YB 62093800
CHECKOPT CLI   CIRPARM,INDEXOPT    PROCESSING LIST NAMES       @YL026YB 62093900
         BE    INDXPTR             GO CHECK NAME AFTER '*'     @YL026YB 62094000
*  THE FIRST CHARACTER IS A NON-BLANK, THEREFORE START SCAN WITH        62094100
*  SECOND CHARACTER                                            @YL026YB 62094200
STARTSCN LA    R2,F1(R2)           POINT TO SECOND BYTE OF SCAN BUFFER  62094300
         LA    R6,F1               SET CHARACTER COUNTER       @YL026YB 62094400
BLANKTST CLI   F0(R2),BLANK        CHECK FOR BLANK CHARACTER   @YL026YB 62094500
         BE    ENDOFSCN            IF A BLANK IS FOUND SCAN IS OVER     62094600
         LA    R2,F1(R2)           POINT TO NEXT BYTE          @YL026YB 62094700
         LA    R6,F1(R6)           BUMP CHARACTER COUNTER      @YL026YB 62094800
         B     BLANKTST            GO CHECK FOR BLANK          @YL026YB 62094900
*  A DATA SET NAME OR AN INDEX LEVEL NAME HAS BEEN FOUND.  THE NAME IS  62095000
*  NOW IN LEVELSCN AND ITS LENGTH IS IN REGISTER 6.  NOW BUILD THE      62095100
*  FULLY QUALIFIED DATA SET NAME AND PROCESS IT.                        62095200
ENDOFSCN LA    R3,DSNO             POINT TO BUILD BUFFER       @YL026YB 62095300
         STH   R6,NAMELTH          SAVE LENGTH OF QUALIFIER    @YL026YB 62095400
         LA    R4,DSNBUFFO         POINT TO INDEX STRUCTURE    @YL026YB 62095500
         LH    R2,INDEXSZE         LOAD LENGTH OF INDEX STRUCTURE       62095600
         EX    R2,MOVE             MOVE INDEX STRUCTURE        @YL026YB 62095700
*  THIS MOVES ONE EXTRA BYTE WHICH WILL BE OVERLAID WITH A PERIOD       62095800
         AR    R3,R2               POINT PAST INDEX STRUCTURE  @YL026YB 62095900
         MVI   F0(R3),PERIOD       INSERT PERIOD               @YL026YB 62096000
         LA    R2,F1(R2)           INCREASE LENGTH FOR PERIOD  @YL026YB 62096100
         AR    R2,R6               TOTAL LENGTH OF DATA SET NAME        62096200
         LA    R3,F1(R3)           POINT PAST PERIOD           @YL026YB 62096300
         LA    R4,LEVELSCN         POINT TO NAME FROM CIR      @YL026YB 62096400
         BCTR  R6,R0               DECREMENT FOR EXECUTE INSTRUCTION    62096500
         EX    R6,MOVE             MOVE DSNAME TO INDEX STRUCTURE       62096600
         STH   R2,DSLO             SAVE LENGTH OF TOTAL DATA SET NAME   62096700
         BR    R14                 RETURN                      @YL026YB 62096800
*  PROCESS LIST NAME AND SAVE ASTERISK VALUE TO BUILD SECOND DSNAME     62096900
BLDLIST  LA    R2,LISTSCN          ADDRESS OF SCAN BUFFER      @YL026YB 62097000
         MVC   LISTSCN(F44),F1(R8) MOVE NAME TO SCAN BUFFER    @YL026YB 62097100
         LA    R8,F45(R8)          BUMP PTR FOR LIST ENTRY     @YL026YB 62097200
         LA    R2,F1(R2)           POINT TO SECOND BYTE        @YL026YB 62097300
         LA    R6,F1               SET CHARACTER COUNTER       @YL026YB 62097400
BLNKTST  CLI   F0(R2),BLANK        CHECK FOR BLANK CHARACTER   @YL026YB 62097500
         BE    ENDSCN              BLANK FOUND SCAN IS OVER    @YL026YB 62097600
         LA    R2,F1(R2)           POINT TO NEXT BYTE          @YL026YB 62097700
         LA    R6,F1(R6)           BUMP CHARACTER COUNTER      @YL026YB 62097800
         B     BLNKTST             GO CHECK FOR BLANK          @YL026YB 62097900
ENDSCN   LA    R3,DSNO             POINT TO BUILD BUFFER       @YL026YB 62098000
         STH   R6,DSLO             SAVE LENGTH OF LIST NAME    @YL026YB 62098100
         LA    R4,LISTSCN          POINT TO LIST NAME          @YL026YB 62098200
         BCTR  R6,R0               DECREMENT FOR EXECUTE INSTR.         62098300
         EX    R6,MOVE             MOVE LIST TO BUFFER         @YL026YB 62098400
         LA    R4,DSNBUFFO         POINT TO INDEX STRUCT       @YL026YB 62098500
         LA    R3,TEMBUF           BUFFER FOR NAME BEFORE '*'  @YL026YB 62098600
         LH    R2,INDEXSZE         LENGTH OF INDEX STRUCTURE   @YL026YB 62098700
         BCTR  R2,R0               DECREMENT FOR EXECUTE INSTR.         62098800
         EX    R2,MOVE             MOVE NAME BEFORE '*' TO BUFFER       62098900
         LA    R4,LISTSCN          POINT TO LIST NAME          @YL026YB 62099000
         EX    R2,CLC1             SEE IF NAMES ARE EQUAL      @YL026YB 62099100
         BNE   ERRPROC             ERROR FOUND                 @YL026YB 62099200
         LA    R3,LEVELSCN         BUFFER FOR ASTERISK NAME    @YL026YB 62099300
         LA    R2,F2(R2)           SET LENGTH TO '*' NAME      @YL026YB 62099400
         AR    R4,R2               1ST BYTE OF '*' NAME        @YL026YB 62099500
         ST    R4,NADDR1           SAVE ADDR. OF '*' NAME               62099600
         SR    R5,R5               SET CHARACTER COUNTER       @YL026YB 62099700
ASTKSCN  CLI   F0(R4),PERIOD       CHECK FOR PERIOD            @YL026YB 62099800
         BE    ASTKVAL             ASTERISK VALUE FOUND        @YL026YB 62099900
         LA    R4,F1(R4)           POINT TO NEXT BYTE          @YL026YB 62100000
         LA    R5,F1(R5)           BUMP CHARACTER COUNTER      @YL026YB 62100100
         B     ASTKSCN             GO CHECK FOR PERIOD         @YL026YB 62100200
ASTKVAL  STH   R5,NAMELTH          LENGTH OF '*' VALUE         @YL026YB 62100300
         ST    R4,NADDR2          SAVE ADDR. OF LAST BYTE OF QUAL.      62100400
         L     R4,NADDR1          ADDRESS OF '*' NAME                   62100500
         BCTR  R5,R0               DECREMENT FOR EXECUTE INSTR.         62100600
         EX    R5,MOVE             MOVE '*' NAME TO BUFFER     @YL026YB 62100700
         B     CHCKSTAR            GO CHECK '*' VALUE          @YL026YB 62100800
INDXPTR  L     R4,NADDR2           LAST BYTE OF QUAL.                   62100900
         LA    R4,F1(R4)           BUMP PTR TO NAME AFTER '*'  @YL026YB 62101000
         ST    R4,NADDR2           SAVE ADDRESS                         62101100
         SR    R6,R6               SET CHARACTER COUNTER       @YL026YB 62101200
LASTNME  CLI   F0(R4),BLANK        CHECK FOR BLANK             @YL026YB 62101300
         BE    ENDSCN1             BLANK FOUND SCAN IS OVER    @YL026YB 62101400
         LA    R4,F1(R4)           POINT TO NEXT BYTE          @YL026YB 62101500
         LA    R6,F1(R6)           BUMP CHARACTER COUNTER      @YL026YB 62101600
         B     LASTNME             GO CHECK FOR BLANK          @YL026YB 62101700
ENDSCN1  LA    R3,TEMBUF1          BUFFER FOR NAME AFTER '*'   @YL026YB 62101800
         L     R4,NADDR2           ADDRESS OF NAME AFTER '*'            62101900
         BCTR  R6,R0               DECREMENT FOR EXECUTE INSTR.         62102000
         EX    R6,MOVE             NAME AFTER '*' TO BUFFER    @YL026YB 62102100
         L     R4,STARADR1         ADDRESS OF ASTERISK         @YL026YB 62102200
         LA    R4,F2(R4)           POINT PAST ASTERISK         @YL026YB 62102300
         LA    R5,DSNBUFFO         POINT TO DSNAME (FIRST CHARACTER)    62102400
         AH    R5,DSBLO            POINT PAST DSNAME           @YL026YB 62102500
         SR    R5,R4               LENGTH OF DSNAME AFTER ASTERISK      62102600
         BCTR  R5,R0               DECREMENT FOR EXECUTE INSTRUCTION    62102700
         CR    R6,R5               COMPARE LENGTHS             @YL026YB 62102800
         BNE   ERRPROC             ERROR FOUND GO TO NEXT NAME @YL026YB 62102900
         EX    R6,CLC1             COMPARE NAMES AFTER '*'     @YL026YB 62103000
         BNE   ERRPROC             ERROR FOUND                 @YL026YB 62103100
         MVI   ISWITCH,ENDTEST     SET INDEX SWITCH            @YL026YB 62103200
         BR    R14                 RETURN                      @YL026YB 62103300
ERRPROC  LA    R14,F4(R14)         BUMP RETURN ADDRESS BY 4    @YL026YB 62103400
         BR    R14                 RETURN                      @YL026YB 62103500
MOVE     MVC   F0(F0,R3),F0(R4)    MOVE INSTR. FOR EX          @YL026YB 62103600
CLC1     CLC   F0(F0,R3),F0(R4)    COMPARE INSTR. FOR EX       @YL026YB 62103700
         DROP  R15                 IKJEHRN4 NO LONGER NEEDED   @YL026YB 62103800
         EJECT                                                          62103900
*                                                                     * 62104000
*              PARSE MACROS FOR RENAME COMMAND                        * 62104100
*                                                                     * 62110520
         DS    0F                                                       62120020
IKJEHPDL IKJPARM                                                        62160020
DSNAME1  IKJPOSIT   DSTHING,PROMPT='OLD DATA SET NAME',HELP=('NAME OF DX62200020
               ATA SET TO BE RENAMED')                                  62240020
DSNAME2  IKJPOSIT   DSTHING,PROMPT='NEW DATA SET NAME',HELP=('NEW NAME X62280020
               OF DATA SET')                                            62320020
RENTYPE  IKJKEYWD                                                       62360020
         IKJNAME    'ALIAS'                                             62400020
         IKJENDP                                                        62440020
*                                                                     * 62480020
*              END OF PARSE MACROS                                    * 62520020
*                                                                     * 62560020
         EJECT                                                          62600020
*  MAPPING MACROS                                                       62640020
         SPACE 2                                                        62680020
         IKJCPPL                                                        62880020
         IKJPPL                                                         62920020
LPPL     EQU   *-PPL               LENGTH OF PPL                        62960020
         IKJDFPL                                                        63000020
LDFPL    EQU   *-DFPL              LENGTH OF DFPL                       63040020
         IKJDFPB                                                        63080020
LDFPB    EQU   *-DFPB              LENGTH OF DFPB                       63120020
         IKJPSCB                                                        63160020
         IKJDAPL                                                        63200020
LDAPL    EQU   *-DAPL              LENGTH OF DAPL                       63240020
         IKJDAP08                                                       63280020
LDAPB08  EQU   *-DAPB08            LENGTH OF DAPB08                     63320020
         IKJDAP18                                                       63360020
LDAPB18  EQU   *-DAPB18            LENGTH OF DAPB18                     63400020
         IKJIOPL                                                        63440020
LIOPL    EQU   *-IOPL              LENGTH OF IOPL                       63480020
         IKJSTPB                                                        63490020
LSTPB    EQU   *-STPB              LENGTH OF STPB                       63500020
         EJECT                                                          63520020
        IKJUPT                                                 @YL026YB 63560000
         EJECT                                                 @YL026YB 63580000
*              GETMAIN COMMON AREA                                      63600000
*                                                              @YL026YB 63620000
         DCBD  DSORG=PO,DEVD=DA                                         63640020
SAVEAREA DS    18F                 REGISTER SAVE AREA                   63680020
UNPACK   DS    D                   WORK AREA FOR CVD                    63720020
COUNT    DS    D                   WORK AREA FOR UNPACK                 63760020
         ORG   COUNT+F7            BACK TO LAST BYTE OF COUNT FIELD     63800020
SIGNBYTE DS    CL1                 LABEL THE SIGN BYTE                  63840020
         ORG                                                            63880020
ENDCOUNT EQU   *                   END OF COUNT FIELD                   63920020
*  CAMLST MACROS MUST BE KEPT TOGETHER - MOVED AS ONE BLOCK             63960020
*                                                                       64000020
*              RENAME MACRO CAMLST                                      64040020
*                                                                       64080020
RENAMLST CAMLST RENAME,OLDNAME,NEWNAME,VOLIST1 RENAME MACRO             64120020
         ORG   RENAMLST            LABEL RENAME CALST FIELDS            64160020
RENAME1  DS    H                   RENAME CAMLST FIRST HALF WORD        64200020
RENAME1A DS    H                   RENAME CAMLST SECOND HALF WORD       64240020
RENAME2  DS    F                   RENAME CAMLST SECOND FULL WORD       64280020
RENAME3  DS    F                   RENAME CAMLST THIRD FULL WORD        64320020
RENAME4  DS    F                   RENAME CAMLST FOURTH FULL WORD       64360020
         ORG                                                            64400020
*                                                                       64440020
*              UNCATALOG MACRO CAMLST                                   64480020
*                                                                       64520020
UNCATLST CAMLST UCATDX,DSNAMEU     UNCATALOG MACRO                      64560020
         ORG   UNCATLST            LABEL UNCATALOG CAMLST FIELDS        64600020
UNCAT1   DS    F                   UNCATALOG CAMLST FIRST FULL WORD     64640020
UNCAT2   DS    F                   UNCATALOG CAMLST SECOND FULL WORD    64680020
UNCAT    DS    F                   UNCATALOG CAMLST THIRD FULL WORD     64720020
         ORG                                                            64760020
*                                                                       64800020
*              LOCATE MACRO CAMLST (BY DATA SET NAME)                   64840020
*                                                                       64880020
LOCNAME  CAMLST NAME,DSNAME3,,LOCAREA1 LOCATE MACRO                     64920020
         ORG   LOCNAME             LABEL LOCATE (NAME) CAMLST FIELDS    64960020
LOCNAME1 DS    F                   LOCATE CAMLST FIRST FULL WORD        65000020
LOCNAME2 DS    F                   LOCATE CAMLST SECOND FULL WORD       65040020
LOCNAME3 DS    F                   LOCATE CAMLST THIRD FULL WORD        65080020
LOCNAME4 DS    F                   LOCATE CAMLST FOURTH FULL WORD       65120020
         ORG                                                            65160020
*                                                                       65200020
*              CATALOG MACRO CAMLST                                     65240020
*                                                                       65280020
CATLST   CAMLST CATBX,DSNAME4,,VOLIST2 CATALOG MACRO                    65320020
         ORG   CATLST              LABEL CATALOG CAMLST FIELDS          65360020
CATLST1  DS    F                   CATALOG CAMLST FIRST FULL WORD       65400020
CATLST2  DS    F                   CATALOG CAMLST SECOND FULL WORD      65440020
CATLST3  DS    F                   CATALOG CAMLST THIRD FULL WORD       65480020
CATLST4  DS    F                   CATALOG CAMLST FOURTH FULL WORD      65520020
         ORG                                                            65560020
*                                                                       66320020
*              END OF CAMLST MACROS                                     66360020
*                                                                       66400020
OLDNAME  DS    CL44                OLD DATA SET NAME                    66440020
NEWNAME  DS    CL44                NEW DATA SET NAME                    66480020
DSNAMEU  DS    CL45                DATA SET NAME (BLANK DELIMITER)      66520020
DSNAME3  DS    CL44                DATA SET NAME                        66560020
DSNAME4  DS    CL45                DATA SET NAME (BLANK DELIMITER)      66600020
VOLNUM   DS    CL6                 VOLUME SERIAL NUMBER                 66720020
TEMBUF   DS    CL8                 BUFFER FOR NAMD BEFORE '*'  @YL026YB 66730000
TEMBUF1  DS    CL44                BUFFER FOR NAME AFTER  '*'  @YL026YB 66740000
WKLENGTH DS    CL4                 WORKAREA LENGTH FIELD       @YL026YB 66750000
         DS    0H                  ALIGN HALF WORD BOUNDRY              66760020
VOLIST1  DS    CL12                VOLUME LIST                          66800020
SEQNUM   DS    CL2                 VOLUME SEQUENCE NUMBER               66840020
MANYVOLS DS    19CL12              SPACE FOR MORE VOLUMES               66880020
VOLIST2  DS    CL2                 VOLUME LIST                          66920020
         DS    20CL12              SPACE FOR SECOND VOLUME LIST         66960020
         DS    0D                  ALIGN DOUBLE WORD BOUNDRY            67000020
LOCAREA1 DS    259C                WORKAREA FOR LOCATE                  67040020
LOCVNUM  DS    6C                  WORKAREA FOR LOCATE                  67080020
*                                                                       67120020
OPEN     OPEN  (0,OUTPUT),MF=L     LIST FORM OF OPEN                    67160020
CLOSE    CLOSE 0,MF=L              LIST FORM OF CLOSE                   67200020
RENCPECB DS    F                   CP'S ECB FOR RENAME COMMAND          67240020
CIRADDR  DS    F                   ADDRESS OF CIR                       67280020
DAIRADDR DS    F                   ADDRESS OF DAIR                      67320020
UPTSAVE  DS    F                   SAVE UPT ADDRESS HERE       @YL026YB 67360000
STARADR1 DS    F                   ADDRESS * FOUND DSNAME1              67400020
STARADR2 DS    F                   ADDRESS * FOUND DSNAME2              67440020
WORKWORD DS    F                   WORK SPACE (TEMPORARY SAVE AREA)     67480020
STARPTR  DS    F                   ADDRESS OF NEXT EMPTY SLOT           67490020
NADDR1   DS    F                   TEMPORARY ADDRESS FOR QUALIFIERS     67493000
NADDR2   DS    F                   TEMPORARY ADDRESS FOR QUALIFIERS     67496000
STARLIST DS    CL256               LIST OF ERROR ASTERISK VALUES        67500020
STAREND  EQU   *                   END OF STAR LIST                     67510020
INDEXSZE DS    H                   LENGTH OF INDEX STRUCTURE            67520020
NAMELTH  DS    H                   SAVE QUALIFIER LENGTH HERE           67560020
CATERCDE DS    H                   UNCATALOG RETURN CODE SAVED HERE     67600020
         DS    0H                  ALIGN HALF WORD BOUNDRY              67640020
DSLO     DS    CL2                 DSLENGTH AND                         67680020
DSNO     DS    CL44                DSNAME BUFFER (OLD DSNAME)           67720020
         DS    0H                  ALIGN HALF WORD BOUNDRY              67760020
DSBLO    DS    CL2                 LENGTH OF DSNAME IN DSNBUFFO         67800020
DSNBUFFO DS    CL52                DSNAME (OLD) BUILT IN THIS BUFFER    67840020
         DS    0H                  ALIGN HALF WORD BOUNDRY              67880020
DSLN     DS    CL2                 DSLENGTH AND                         67920020
DSNN     DS    CL44                DSNAME BUFFER (NEW DSNAME)           67960020
         DS    0H                  ALIGN HALF WORD BOUNDRY              68000020
DSBLN    DS    CL2                 LENGTH OF NAME IN DSNBUFFN           68040020
DSNBUFFN DS    CL52                DSNAME (NEW) BUILT IN THIS BUFFER    68080020
LEVELSCN DS    CL9                 BUFFER FOR SCANNING INDEX NAMES      68120020
ISWITCH  DS    CL1                 SWITCH INDICATES INDEX NAMES         68160020
STARLEV1 DS    CL1                 LEVEL * FOUND DSNAME1                68200020
STARLEV2 DS    CL1                 LEVEL * FOUND DSNAME2                68240020
UNALOCSW DS    CL1                 SWITCH INDICATES UNALLOCATE DATA SET 68280020
ENDERROR DS    CL1                 SWITCH INDICATES CONTINUE PROCESSING 68320020
RC       DS    CL1                 SAVE RETURN CODES HERE               68360020
DEFLTSW  DS    CL1                 SWITCH INDICATES DEFAULT NAME        68440020
RENERRSW DS    CL1                 SWITCH INDICATES RENAME ERROR        68480020
CIRFLAG  DS    CL1                 INDICATES * NAME PROCESSED           68520020
ERRORSW  DS    CL1                 ERROR SWITCH                         68540020
MEM2SW   DS    CL1                 SWITCH SECOND NAME IS MEMBER ONLY    68550020
DDNAME1  DS    CL8                 SAVE DDNAME HERE                     68560020
LISTSCN  DS    CL45                BUFFER FOR SCANNING LIST             68570000
STACKSW  DS    CL1                 INDICATE FLUSH STACK AND CLEAR QUEUE 68580000
MAINX    DS    CL1                 GIVES STATUS OF CIR WKAREA  @YL026YB 68590000
*  THESE FIELDS USED BY BLDL AND STOW (KEEP INTACT)                     68600020
STOWOLD  DS    2F                  MEMBER NAMES STORED HERE FOR -       68640020
STOWNEW  DS    2F                  STOW CHANGE OPTION                   68680020
BLDLCNT  DS    H                   BLDL LIST NUMBER OF ENTRIES (1)      68720020
BLDLLNTH DS    H                   BLDL LIST LENGTH OF EACH ENTRY (76)  68760020
BLDLMEM  DS    CL13                BLDL MEMBER NAME AND TTR DATA        68800020
BLDLDATA DS    CL63                BLDL FLAG BYTE AND USER DATA         68840020
         DS    0H                  ALIGN HALF WORD BOUNDRY              68880020
STOWMEM  DS    CL11                STOW MEMBER NAME AND TTR DATA        68920020
STOWDATA DS    CL63                STOW FLAG BYTE AND USER DATA         68960020
STOWEND  EQU   *                   END OF STOW AND BLDL LISTS           69000020
*  CATALOG INFORMATION ROUTINE PARAMETER LIST (KEEP INTACT)             69040020
CIRPARM  DS    F                   OPTION BYTE                          69080020
NAMEPTR  DS    F                   POINTER TO NAME OR TTR               69120020
VOLIDPTR DS    F                   POINTER TO USER CAT NAME    @YL026YB 69160000
WORK1PTR DS    F                   POINTER TO CIR  WORKAREA    @YL026YB 69190000
WORK2PTR DS    F                   POINTER TO 18 WORD WORKAREA          69220000
PASSPTR  DS    F                   POINTER TO PASSWORD         @YL026YB 69250000
WRK2AREA DS    18F                 WORKAREA FOR CIR (SAVEAREA)          69280000
         DS    0D                  ALIGN WORKAREA                       69310000
NAMETTR  DS    CL44                DSNAME  BUFFER              @YL026YB 69340000
CVOLID   DS    CL44                VOLUME SERIAL NUMBER BUFFER @YL026YB 69370000
PASSWKD  DS    CL8                 PASSWORD BUFFER             @YL026YB 69400000
STARSW   DS    CL1                 INDICATES ASTERISK VALUE PROCESSED   69450020
QUALBUFF DS    CL8                 DEFAULT RETURNS QUALIFIER HERE       69460020
*  END OF CATALOG INFORMATION ROUTINE PARAMETER LIST                    69480020
ANSPLACE DS    F                   ANSWER PLACE FOR PARSE               69520020
         DS    0F                  ALIGN WORD BOUNDRY                   69560020
PARSPARM DS    (LPPL)X             SPACE FOR PARSE PARAMETER LIST       69600020
         DS    0F                  ALIGN WORD BOUNDRY                   69640020
IOPARM   DS    (LIOPL)X            SPACE FOR I/O PARAMETER LIST         69680020
         DS    0F                  ALIGN WORD BOUNDRY                   69720020
DFLTPARM DS    (LDFPL)X            SPACE FOR DEFAULT PARAMETER LIST     69760020
         DS    0F                  ALIGN WORD BOUNDRY                   69800020
DFLTPBLK DS    (LDFPB)X            SPACE FOR DEFAULT PARM BLOCK         69840020
         DS    0F                  ALIGN WORD BOUNDRY                   69880020
DAIRPARM DS    (LDAPL)X            SPACE FOR DAIR PARAMETER LIST        69920020
         DS    0F                  ALIGN WORD BOUNDRY                   69960020
DAIR08   DS    (LDAPB08)X          SPACE FOR DAIR ENTRY 08              70000020
         DS    0F                  ALIGN WORD BOUNDRY                   70040020
DAIR18   DS    (LDAPB18)X          SPACE FOR DAIR ENTRY 18              70080020
*  KEEP DAIR LISTS TOGETHER, ZEROED BY ONE INSTRUCTION                  70120020
DLSTEND  EQU   *                   END OF DAIR ENTRY LISTS              70160020
         DS    0F                  ALIGN WORD BOUNDRY                   70170020
STACKPRM DS    (LSTPB)X            SPACE FOR STACK PARM BLOCK           70180020
PUT      PUTLINE MF=L              LIST FORM OF PUTLINE                 70200020
*  THE FOLLOWING SPACE IS USED FOR STAE                                 70202020
TMPSR1   DS    F                   SAVE TMP'S REGISTER 1 HERE           70204020
STAEADDR DS    F                   ADDRESS OF STAE INTERFACE ROUTINE    70206020
         PSEUDO MF=L                                                    70208020
STAELIST STAE  STAEADDR,PARAM=STAEPARM,MF=L                             70210020
STAEONE  STABUILD CODE=713,RTN=ABEND713,ADDR=STAEONE,FLAG=(ONE,NMSG),  X70212020
               NUM=4,MF=L                                               70214020
STAETWO  STABUILD CODE=913,RTN=ABEND913,ADDR=STAETWO,FLAG=(ONE,NMSG),  X70216020
               MF=L                                                     70218020
STAETHRE STABUILD CODE=(113,213,313,A13),RTN=ABEND13,ADDR=STAETHRE,    X70220020
               FLAG=(MUL,NMSG),LIST=STAELST,                           X70222020
               MF=L                                                     70224020
STAEFOUR STABUILD CODE=000,RTN=LISTEST,ADDR=STAEFOUR,FLAG=(ALL,END),   X70226020
               MF=L                                                     70228020
STAEPARM STAEPARM FLAG=(CP),PSEUDO=$PSEUDO,LIST=STAEONE,ADDR=STAEPARM, X70230020
               MF=L                                                     70232020
STAELNTH EQU   *-STAELIST          SIZE OF STAE LISTS                   70234020
*  THE FOLLOWING IS RESERVED SPACE FOR OUTPUT CHAINS                    70240020
OUTAREA1 DS    F                   MESSAGE CHAIN POINTER                70280020
OUTCNT1  DS    F                   MESSAGE SEGMENT COUNT                70320020
OUTPUT11 DS    F                   POINTER TO MESSAGE SEGMENT           70360020
OUTPUT12 DS    F                   POINTER TO MESSAGE INSERTION         70400020
OUTAREA2 DS    F                   MESSAGE CHAIN POINTER                70440020
OUTCNT2  DS    F                   MESSAGE SEGMENT COUNT                70480020
OUTPUT21 DS    F                   POINTER TO MESSAGE SEGMENT           70520020
OUTPUT22 DS    F                   POINTER TO MESSAGE INSERTION         70560020
*  END OF OUTPUT CHAINS                                                 70600020
*                                                                       70640020
*  FIRST DATA SET NAME FOR MESSAGES STORED HERE                         70680020
DSNMESGL EQU   *                   ALIAS FOR DSNMSGL1                   70720020
DSNMSGL1 DS    H                   LENGTH OF FIRST DSNAME               70760020
DSNMSGO1 DS    H                   OFFSET FOR INSERTION                 70800020
DSNMSG1  DS    CL52                FIRST DSNAME                         70840020
*  FIRST MEMBER NAME FOR MESSAGES STORED HERE                           70880020
MEMMSGL1 DS    H                   LENGTH OF MEMBER NAME FIRST DSNAME   70920020
MEMMSGO1 DS    H                   OFFSET FOR INSERTION                 70960020
MEMMSG1  DS    CL10                MEMBER NAME FIRST DSNAME             71000020
*  SECOND DATA SET NAME FOR MESSAGES STORED HERE                        71040020
DSNMSGL2 DS    H                   LENGTH OF SECOND DSNAME              71080020
DSNMSGO2 DS    H                   OFFSET FOR INSERTION                 71120020
DSNMSG2  DS    CL52                SECOND DSNAME                        71160020
*  SECOND MEMBER NAME FOR MESSAGES STORED HERE                          71200020
MEMMSGL2 DS    H                   LENGTH OF MEMBER NAME SECOND DSNAME  71240020
MEMMSGO2 DS    H                   OFFSET FOR INSERTION                 71280020
MEMMSG2  DS    CL10                MEMBER NAME SECOND DSNAME            71320020
*  RETURN CODE FOR MESSAGES STORED HERE                                 71360020
RCMESGL  DS    H                   LENGTH OF RETURN CODE                71400020
RCMESGO  DS    H                   OFFSET FOR INSERTION                 71440020
RCMESG   DS    CL4                 RETURN CODE                          71480020
RCX      DS    CL1                 RC SAVE AREA                @ZA01485 71482037
*  ASTERISK NAME FOR MESSAGES STORED HERE                               71490020
STARBUFF DS    CL52                LENGTH, OFFSET, AND ASTERISK NAME    71500020
CORE     EQU   *-IHADCB            CORE SIZE FOR GETMAIN                71520020
         EJECT                                                          71560020
IKJEHMSG CSECT                                                          71600020
         ENTRY IKJEHSMG                                                 71640020
*********************************************************************** 71680020
*                                                                     * 71720020
*  THIS CONTROL SECTION CONTAINS THE MESSAGE TEXT (BOTH FIRST AND     * 71760020
*  SECOND LEVEL).  IT CONTAINS A BRANCH TABLE FOR FIRST LEVEL MESSAGES* 71800020
*  AND A BRANCH TABLE FOR SECOND LEVEL MESSAGES.  EACH BRANCH TABLE   * 71840020
*  ENTRY IS COMPOSED OF A ONE BYTE OFFSET FIELD FOR MESSAGE INSERTIONS* 71880020
*  AND A THREE BYTE ADDRESS OF THE MESSAGE.  THE MESSAGE BUILDER      * 71920020
*  ROUTINES COMBINE THE ADDRESS OF THE CONTROL SECTION AND THE ADDRESS* 71960020
*  OF THE MESSAGE TO GET THE TRUE ADDRESS OF THE MESSAGE.  THE OFFSET * 72000020
*  IS PLACED IN THE INSERTION SEGMENT.                                * 72040020
*  EACH MESSAGE IS COMPOSED OF A 4 BYTE HEADER (2 BYTE LENGTH OF      * 72050020
*  MESSAGE INCLUDING HEADER LENGTH AND A 2 BYTE OFFSET FIELD)         * 72060020
*  FOLLOWED BY THE MESSAGE TEXT.                                      * 72070020
*                                                                     * 72080020
*********************************************************************** 72120020
         SPACE                                                          72160020
*  EQUATES USED IN THIS CONTROL SECTION                                 72200020
HDR      EQU   4                   HEADER LENGTH (2 BYTES EACH, LENGTH  72240020
*                                  AND OFFSET FIELDS) EACH SEGMENT      72280020
OFST     EQU   0                   INSERTION OFFSET 1ST MESSAGE SEGMENT 72320020
*  OFFSETS FOR FIRST LEVEL MESSAGE INSERTIONS                           72360020
OFST01   EQU   19                  INSERTION OFFSET MESSAGE 01          72400020
OFST02   EQU   0                   INSERTION OFFSET MESSAGE 02          72440020
OFST03   EQU   19                  INSERTION OFFSET MESSAGE 03          72480020
OFST04   EQU   19                  INSERTION OFFSET MESSAGE 04          72520020
OFST05   EQU   0                   INSERTION OFFSET MESSAGE 05          72560020
OFST06   EQU   30                  INSERTION OFFSET MESSAGE 06          72600020
OFST07   EQU   36                  INSERTION OFFSET MESSAGE 07          72640020
OFST08   EQU   0                   INSERTION OFFSET MESSAGE 08          72680020
OFST09   EQU   45                  INSERTION OFFSET MESSAGE 09   A49872 72720021
OFST10   EQU   31                  INSERTION OFFSET MESSAGE 10          72760020
OFST11   EQU   19                  INSERTION OFFSET MESSAGE 11          72800020
OFST12   EQU   19                  INSERTION OFFSET MESSAGE 12          72840020
OFST13   EQU   19                  INSERTION OFFSET MESSAGE 13          72880020
OFST14   EQU   19                  INSERTION OFFSET MESSAGE 14          72920020
OFST15   EQU   19                  INSERTION OFFSET MESSAGE 15          72960020
OFST16   EQU   43                  INSERTION OFFSET MESSAGE 16          73000020
OFST17   EQU   43                  INSERTION OFFSET MESSAGE 17          73040020
OFST18   EQU   34                  INSERTION OFFSET MESSAGE 18          73080020
OFST19   EQU   43                  INSERTION OFFSET MESSAGE 19          73120020
OFST20   EQU   19                  INSERTION OFFSET MESSAGE 20          73160020
OFST21   EQU   19                  INSERTION OFFSET MESSAGE 21          73200020
OFST22   EQU   19                  INSERTION OFFSET MESSAGE 22          73240020
OFST23   EQU   17                  INSERTION OFFSET MESSAGE 23          73280020
OFST24   EQU   31                  INSERTION OFFSET MESSAGE 24          73320020
OFST25   EQU   0                   INSERTION OFFSET MESSAGE 25          73360020
OFST26   EQU   0                   INSERTION OFFSET MESSAGE 26          73400020
OFST27   EQU   24                  INSERTION OFFSET MESSAGE 27          73440020
OFST28   EQU   28                  INSERTION OFFSET MESSAGE 28          73460020
OFST29   EQU   19                  INSERTION OFFSET MESSAGE 29          73470020
*  OFFSETS FOR SECOND LEVEL MESSAGE INSERTIONS                          73480020
*  NOTE-  THERE ARE CURRENTLY NO INSERTIONS IN MOST SECOND LEVEL        73520020
*  MESSAGES.  A COMMON OFFSET OF ZERO IS USED.                          73560020
OFSTSMSG EQU   0                   INSERTION OFFSET 2ND LEVEL MESSAGES  73600020
OFSTSM04 EQU   29                  INSERTION OFFSET SECOND LEVEL MSG 04 73640020
OFSTSM05 EQU   40                  INSERTION OFFSET SECOND LEVEL MSG 05 73680020
OFSTSM07 EQU   29                  INSERTION OFFSET SECOND LEVEL MSG 07 73720020
OFSTSM08 EQU   27                  INSERTION OFFSET SECOND LEVEL MSG 08 73760020
OFSTSM10 EQU   29                  INSERTION OFFSET SECOND LEVEL MSG 10 73800020
OFSTSM12 EQU   29                  INSERTION OFFSET SECOND LEVEL MSG 12 73820020
OFSTSM13 EQU   26                  INSERTION OFFSET SECOND LEVEL MSG 13 73840020
OFSTSM15 EQU   26                  INSERTION OFFSET SECOND LEVEL MSG 15 73850020
OFSTSM20 EQU   28                  INSERTION OFFSET SECOND LEVEL MSG 20 73880020
OFSTSM21 EQU   26                  INSERTION OFFSET SECOND LEVEL MSG 21 73920020
OFSTSM22 EQU   26                  INSERTION OFFSET SECOND LEVEL MSG 22 73960020
         SPACE                                                          74000020
AMSG01   DC    AL1(OFST01)         INSERTION OFFSET                     74040020
         DC    AL3(LMSG01)         MESSAGE ADDRESS                      74080020
AMSG02   DC    AL1(OFST02)         INSERTION OFFSET                     74120020
         DC    AL3(LMSG02)         MESSAGE ADDRESS                      74160020
AMSG03   DC    AL1(OFST03)         INSERTION OFFSET                     74200020
         DC    AL3(LMSG03)         MESSAGE ADDRESS                      74240020
AMSG04   DC    AL1(OFST04)         INSERTION OFFSET                     74280020
         DC    AL3(LMSG04)         MESSAGE ADDRESS                      74320020
AMSG05   DC    AL1(OFST05)         INSERTION OFFSET                     74360020
         DC    AL3(LMSG05)         MESSAGE ADDRESS                      74400020
AMSG06   DC    AL1(OFST06)         INSERTION OFFSET                     74440020
         DC    AL3(LMSG06)         MESSAGE ADDRESS                      74480020
AMSG07   DC    AL1(OFST07)         INSERTION OFFSET                     74520020
         DC    AL3(LMSG07)         MESSAGE ADDRESS                      74560020
AMSG08   DC    AL1(OFST08)         INSERTION OFFSET                     74600020
         DC    AL3(LMSG08)         MESSAGE ADDRESS                      74640020
AMSG09   DC    AL1(OFST09)         INSERTION OFFSET                     74680020
         DC    AL3(LMSG09)         MESSAGE ADDRESS                      74720020
AMSG10   DC    AL1(OFST10)         INSERTION OFFSET                     74760020
         DC    AL3(LMSG10)         MESSAGE ADDRESS                      74800020
AMSG11   DC    AL1(OFST11)         INSERTION OFFSET                     74840020
         DC    AL3(LMSG11)         MESSAGE ADDRESS                      74880020
AMSG12   DC    AL1(OFST12)         INSERTION OFFSET                     74920020
         DC    AL3(LMSG12)         MESSAGE ADDRESS                      74960020
AMSG13   DC    AL1(OFST13)         INSERTION OFFSET                     75000020
         DC    AL3(LMSG13)         MESSAGE ADDRESS                      75040020
AMSG14   DC    AL1(OFST14)         INSERTION OFFSET                     75080020
         DC    AL3(LMSG14)         MESSAGE ADDRESS                      75120020
AMSG15   DC    AL1(OFST15)         INSERTION OFFSET                     75160020
         DC    AL3(LMSG15)         MESSAGE ADDRESS                      75200020
AMSG16   DC    AL1(OFST16)         INSERTION OFFSET                     75240020
         DC    AL3(LMSG16)         MESSAGE ADDRESS                      75280020
AMSG17   DC    AL1(OFST17)         INSERTION OFFSET                     75320020
         DC    AL3(LMSG17)         MESSAGE ADDRESS                      75360020
AMSG18   DC    AL1(OFST18)         INSERTION OFFSET                     75400020
         DC    AL3(LMSG18)         MESSAGE ADDRESS                      75440020
AMSG19   DC    AL1(OFST19)         INSERTION OFFSET                     75480020
         DC    AL3(LMSG19)         MESSAGE ADDRESS                      75520020
AMSG20   DC    AL1(OFST20)         INSERTION OFFSET                     75560020
         DC    AL3(LMSG20)         MESSAGE ADDRESS                      75600020
AMSG21   DC    AL1(OFST21)         INSERTION OFFSET                     75640020
         DC    AL3(LMSG21)         MESSAGE ADDRESS                      75680020
AMSG22   DC    AL1(OFST22)         INSERTION OFFSET                     75720020
         DC    AL3(LMSG22)         MESSAGE ADDRESS                      75760020
AMSG23   DC    AL1(OFST23)         INSERTION OFFSET                     75800020
         DC    AL3(LMSG23)         MESSAGE ADDRESS                      75840020
AMSG24   DC    AL1(OFST24)         INSERTION OFFSET                     75880020
         DC    AL3(LMSG24)         MESSAGE ADDRESS                      75920020
AMSG25   DC    AL1(OFST25)         INSERTION OFFSET                     75960020
         DC    AL3(LMSG25)         MESSAGE ADDRESS                      76000020
AMSG26   DC    AL1(OFST26)         INSERTION OFFSET                     76040020
         DC    AL3(LMSG26)         MESSAGE ADDRESS                      76080020
AMSG27   DC    AL1(OFST27)         INSERTION OFFSET                     76120020
         DC    AL3(LMSG27)         MESSAGE ADDRESS                      76160020
AMSG28   DC    AL1(OFST28)         INSERTION OFFSET                     76170020
         DC    AL3(LMSG28)         MESSAGE ADDRESS                      76180020
AMSG29   DC    AL1(OFST29)         INSERTION OFFSET                     76190020
         DC    AL3(LMSG29)         MESSAGE ADDRESS                      76192020
*  FIRST LEVEL MESSAGES                                                 76200020
LMSG01   DC    AL2(L'MSG01+HDR)                                         76240020
         DC    AL2(OFST)                                                76280020
MSG01    DC    C'IKJ58201I DATA SET  NOT IN CATALOG OR AMOUNT OF DATASEX76320003
               TS EXCEEDS WORKAREA FOR GENERIC RENAME'          OZ27595 76330003
LMSG02   DC    AL2(L'MSG02+HDR)                                         76360020
         DC    AL2(OFST)                                                76400020
MSG02    DC    C'IKJ58202I NOT ENOUGH MAIN STORAGE TO EXECUTE COMMAND'  76440020
LMSG03   DC    AL2(L'MSG03+HDR)                                         76480020
         DC    AL2(OFST)                                                76520020
MSG03    DC    C'IKJ58203I DATA SET  NOT RENAMED, EXPIRATION DATE HAS NX76560020
               OT PASSED+'                                              76600020
LMSG04   DC    AL2(L'MSG04+HDR)                                         76640020
         DC    AL2(OFST)                                                76680020
MSG04    DC    C'IKJ58204I DATA SET  NOT USABLE+'                       76720020
LMSG05   DC    AL2(L'MSG05+HDR)                                         76760020
         DC    AL2(OFST)                                                76800020
MSG05    DC    C'IKJ58205I INVALID USE OF ALIAS KEYWORD+'               76840020
LMSG06   DC    AL2(L'MSG06+HDR)                                         76880020
         DC    AL2(OFST)                                                76920020
MSG06    DC    C'IKJ58206I INVALID USE OF * IN +'                       76960020
LMSG07   DC    AL2(L'MSG07+HDR)                                         77000020
         DC    AL2(OFST)                                                77040020
MSG07    DC    C'IKJ58207I UNABLE TO RENAME DATA SET +'                 77080020
LMSG08   DC    AL2(L'MSG08+HDR)                                         77120020
         DC    AL2(OFST)                                                77160020
MSG08    DC    C'IKJ58208I INVALID USE OF COMMAND+'                     77200020
LMSG09   DC    AL2(L'MSG09+HDR)                                         77240020
         DC    AL2(OFST)                                                77280020
MSG09    DC    C'IKJ58209I DATA SET NAME REQUIRED WHEN MEMBER  SPECIFIEX77320021
               D'                                                A49872 77360021
LMSG10   DC    AL2(L'MSG10+HDR)                                         77400020
         DC    AL2(OFST)                                                77440020
MSG10    DC    C'IKJ58210I DATA SET RENAMED BUT  STILL CATALOGED'       77480020
LMSG11   DC    AL2(L'MSG11+HDR)                                         77520020
         DC    AL2(OFST)                                                77560020
MSG11    DC    C'IKJ58211I DATA SET  NOT ALLOCATED, TOO MANY DATA SETS+X77600020
               '                                                        77640020
LMSG12   DC    AL2(L'MSG12+HDR)                                         77680020
         DC    AL2(OFST)                                                77720020
MSG12    DC    C'IKJ58212I DATA SET  NOT ALLOCATED, DATA SET NOT ON VOLX77760020
               UME+'                                                    77800020
LMSG13   DC    AL2(L'MSG13+HDR)                                         77840020
         DC    AL2(OFST)                                                77880020
MSG13    DC    C'IKJ58213I DATA SET  NOT ALLOCATED, REQUIRED VOLUME NOTX77920020
                MOUNTED+'                                               77960020
LMSG14   DC    AL2(L'MSG14+HDR)                                         78000020
         DC    AL2(OFST)                                                78040020
MSG14    DC    C'IKJ58214I DATA SET  NOT ALLOCATED, SYSTEM OR INSTALLATX78080020
               ION ERROR+'                                              78090020
LMSG15   DC    AL2(L'MSG15+HDR)                                         78120020
         DC    AL2(OFST)                                                78160020
MSG15    DC    C'IKJ58215I DATA SET  ALREADY IN USE, TRY LATER+'        78200020
LMSG16   DC    AL2(L'MSG16+HDR)                                         78240020
         DC    AL2(OFST)                                                78280020
MSG16    DC    C'IKJ58216I PROPER PASSWORD NOT SUPPLIED FOR '           78320020
LMSG17   DC    AL2(L'MSG17+HDR)                                         78360020
         DC    AL2(OFST)                                                78400020
MSG17    DC    C'IKJ58217I SPECIFIED MEMBER NOT IN DATA SET '           78440020
LMSG18   DC    AL2(L'MSG18+HDR)                                         78480020
         DC    AL2(OFST)                                                78520020
MSG18    DC    C'IKJ58218I INVALID DATA SET NAME, '''' EXCEEDS 44 CHARAX78560020
               CTERS'                                                   78600020
LMSG19   DC    AL2(L'MSG19+HDR)                                         78640020
         DC    AL2(OFST)                                                78680020
MSG19    DC    C'IKJ58219I NO DATA SETS FOUND TO MATCH * IN '           78720020
LMSG20   DC    AL2(L'MSG20+HDR)                                         78760020
         DC    AL2(OFST)                                                78800020
MSG20    DC    C'IKJ58220I DATA SET  NOT ON A DIRECT ACCESS DEVICE, NOTX78840020
                SUPPORTED'                                              78850020
LMSG21   DC    AL2(L'MSG21+HDR)                                         78880020
         DC    AL2(OFST)                                                78920020
MSG21    DC    C'IKJ58221I DATA SET  RESIDES ON MULTIPLE VOLUMES, NOT SX78960020
               UPPORTED'                                                78970020
LMSG22   DC    AL2(L'MSG22+HDR)                                         79040020
         DC    AL2(OFST)                                                79080020
MSG22    DC    C'IKJ58222I DATA SET  ALREADY EXISTS'                    79120020
LMSG23   DC    AL2(L'MSG23+HDR)                                         79160020
         DC    AL2(OFST)                                                79200020
MSG23    DC    C'IKJ58223I MEMBER  ALREADY EXISTS'                      79240020
LMSG24   DC    AL2(L'MSG24+HDR)                                         79280020
         DC    AL2(OFST)                                                79320020
MSG24    DC    C'IKJ58224I MEMBER SPECIFIED BUT  NOT A PARTITIONED DATAX79360020
                SET'                                                    79400020
LMSG25   DC    AL2(L'MSG25+HDR)                                         79440020
         DC    AL2(OFST)                                                79480020
MSG25    DC    C'IKJ58225I COMMAND SYSTEM ERROR+'                       79520020
LMSG26   DC    AL2(L'MSG26+HDR)                                         79560020
         DC    AL2(OFST)                                                79600020
MSG26    DC    C'IKJ58226I NO SPACE IN DIRECTORY FOR ALIAS'             79640020
LMSG27   DC    AL2(L'MSG27+HDR)                                         79680020
         DC    AL2(OFST)                                                79720020
MSG27    DC    C'IKJ58227I DATA SET NAME  WILL CREATE INVALID CATALOG SX79760020
               TRUCTURE+'                                               79800020
LMSG28   DC    AL2(L'MSG28+HDR)                                         79810020
         DC    AL2(OFST)                                                79820020
MSG28    DC    C'IKJ58228I UNABLE TO CATALOG +'                         79830020
LMSG29   DC    AL2(L'MSG29+HDR)                                         79832020
         DC    AL2(OFST)                                                79834020
MSG29    DC    C'IKJ58229I DATA SET  NOT ALLOCATED+'                    79836020
*  ENTRY POINT TO SECOND LEVEL MESSAGE BRANCH TABLE                     79840020
IKJEHSMG DS    0F                  ALIGN SECOND LEVEL BRANCH TABLE      79880020
ASMSG01  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     79920020
         DC    AL3(LSMSG01)        MESSAGE ADDRESS                      79960020
ASMSG02  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     80000020
         DC    AL3(LSMSG02)        MESSAGE ADDRESS                      80040020
ASMSG03  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     80080020
         DC    AL3(LSMSG03)        MESSAGE ADDRESS                      80120020
ASMSG04  DC    AL1(OFSTSM04)       INSERTION OFFSET                     80160020
         DC    AL3(LSMSG04)        MESSAGE ADDRESS                      80200020
ASMSG05  DC    AL1(OFSTSM05)       INSERTION OFFSET                     80240020
         DC    AL3(LSMSG05)        MESSAGE ADDRESS                      80280020
ASMSG06  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     80320020
         DC    AL3(LSMSG06)        MESSAGE ADDRESS                      80360020
ASMSG07  DC    AL1(OFSTSM07)       INSERTION OFFSET                     80400020
         DC    AL3(LSMSG07)        MESSAGE ADDRESS                      80440020
ASMSG08  DC    AL1(OFSTSM08)       INSERTION OFFSET                     80480020
         DC    AL3(LSMSG08)        MESSAGE ADDRESS                      80520020
ASMSG09  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     80560020
         DC    AL3(LSMSG09)        MESSAGE ADDRESS                      80600020
ASMSG10  DC    AL1(OFSTSM10)       INSERTION OFFSET                     80640020
         DC    AL3(LSMSG10)        MESSAGE ADDRESS                      80680020
ASMSG11  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     80720020
         DC    AL3(LSMSG11)        MESSAGE ADDRESS                      80760020
ASMSG12  DC    AL1(OFSTSM12)       INSERTION OFFSET                     80800020
         DC    AL3(LSMSG12)        MESSAGE ADDRESS                      80840020
ASMSG13  DC    AL1(OFSTSM13)       INSERTION OFFSET                     80880020
         DC    AL3(LSMSG13)        MESSAGE ADDRESS                      80920020
ASMSG14  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     80960020
         DC    AL3(LSMSG14)        MESSAGE ADDRESS                      81000020
ASMSG15  DC    AL1(OFSTSM15)       INSERTION OFFSET                     81040020
         DC    AL3(LSMSG15)        MESSAGE ADDRESS                      81080020
ASMSG16  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81120020
         DC    AL3(LSMSG16)        MESSAGE ADDRESS                      81160020
ASMSG17  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81200020
         DC    AL3(LSMSG17)        MESSAGE ADDRESS                      81240020
ASMSG18  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81280020
         DC    AL3(LSMSG18)        MESSAGE ADDRESS                      81320020
ASMSG19  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81360020
         DC    AL3(LSMSG19)        MESSAGE ADDRESS                      81400020
ASMSG20  DC    AL1(OFSTSM20)       INSERTION OFFSET                     81440020
         DC    AL3(LSMSG20)        MESSAGE ADDRESS                      81480020
ASMSG21  DC    AL1(OFSTSM21)       INSERTION OFFSET                     81520020
         DC    AL3(LSMSG21)        MESSAGE ADDRESS                      81560020
ASMSG22  DC    AL1(OFSTSM22)       INSERTION OFFSET                     81600020
         DC    AL3(LSMSG22)        MESSAGE ADDRESS                      81640020
ASMSG23  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81680020
         DC    AL3(LSMSG23)        MESSAGE ADDRESS                      81720020
ASMSG24  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81760020
         DC    AL3(LSMSG24)        MESSAGE ADDRESS                      81800020
ASMSG25  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81840020
         DC    AL3(LSMSG25)        MESSAGE ADDRESS                      81880020
ASMSG26  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     81920020
         DC    AL3(LSMSG26)        MESSAGE ADDRESS                      81960020
ASMSG27  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     82000020
         DC    AL3(LSMSG27)        MESSAGE ADDRESS                      82040020
ASMSG28  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     82080020
         DC    AL3(LSMSG28)        MESSAGE ADDRESS                      82120020
ASMSG29  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     82160020
         DC    AL3(LSMSG29)        MESSAGE ADDRESS                      82200020
ASMSG30  DC    AL1(OFSTSMSG)       INSERTION OFFSET                     82240020
         DC    AL3(LSMSG30)        MESSAGE ADDRESS                      82280020
*  SECOND LEVEL MESSAGES                                                82320020
LSMSG01  DC    AL2(L'SMSG01+HDR)                                        82360020
         DC    AL2(OFST)                                                82400020
SMSG01   DC    C'IKJ58211I USE FREE COMMAND TO FREE UNUSED DATA SETS'   82440020
LSMSG02  DC    AL2(L'SMSG02+HDR)                                        82480020
         DC    AL2(OFST)                                                82520020
SMSG02   DC    C'IKJ58212I CATALOG INFORMATION INCORRECT'               82560020
LSMSG03  DC    AL2(L'SMSG03+HDR)                                        82600020
         DC    AL2(OFST)                                                82640020
SMSG03   DC    C'IKJ58213I VOLUME OR CVOL NOT ON SYSTEM AND CANNOT BE AX82680020
               CCESSED'                                                 82690020
LSMSG04  DC    AL2(L'SMSG04+HDR)                                        82720020
         DC    AL2(OFST)                                                82760020
SMSG04   DC    C'IKJ58214I CATALOG ERROR CODE '                         82800020
LSMSG05  DC    AL2(L'SMSG05+HDR)                                        82840020
         DC    AL2(OFST)                                                82880020
SMSG05   DC    C'IKJ58214I DYNAMIC ALLOCATION ERROR CODE '              82920020
LSMSG06  DC    AL2(L'SMSG06+HDR)                                        82960020
         DC    AL2(OFST)                                                83000020
SMSG06   DC    C'IKJ58215I DATA SET IS ALLOCATED TO ANOTHER JOB OR USERX83040020
               '                                                        83080020
LSMSG07  DC    AL2(L'SMSG07+HDR)                                        83120020
         DC    AL2(OFST)                                                83160020
SMSG07   DC    C'IKJ58225I DEFAULT ERROR CODE '                         83200020
LSMSG08  DC    AL2(L'SMSG08+HDR)                                        83240020
         DC    AL2(OFST)                                                83280020
SMSG08   DC    C'IKJ58225I PARSE ERROR CODE '                           83320020
LSMSG09  DC    AL2(L'SMSG09+HDR)                                        83360020
         DC    AL2(OFST)                                                83400020
SMSG09   DC    C'IKJ58206I * CANNOT BE USED WITH MEMBER'                83440020
LSMSG10  DC    AL2(L'SMSG10+HDR)                                        83480020
         DC    AL2(OFST)                                                83520020
SMSG10   DC    C'IKJ58210I CATALOG ERROR CODE '                         83560020
LSMSG11  DC    AL2(L'SMSG11+HDR)                                        83600020
         DC    AL2(OFST)                                                83640020
SMSG11   DC    C'IKJ58227I A QUALIFIER CANNOT BE BOTH AN INDEX AND THE X83680020
               LAST QUALIFIER OF A DATA SET NAME'                       83720020
LSMSG12  DC    AL2(L'SMSG12+HDR)                                        83740020
         DC    AL2(OFST)                                                83760020
SMSG12   DC    C'IKJ58228I CATALOG ERROR CODE '                         83780020
LSMSG13  DC    AL2(L'SMSG13+HDR)                                        83800020
         DC    AL2(OFST)                                                83840020
SMSG13   DC    C'IKJ58204I OPEN ERROR CODE '                            83880020
LSMSG14  DC    AL2(L'SMSG14+HDR)                                        83920020
         DC    AL2(OFST)                                                83930020
SMSG14   DC    C'IKJ58214I CATALOG I/O ERROR'                           83940020
LSMSG15  DC    AL2(L'SMSG15+HDR)                                        83960020
         DC    AL2(OFST)                                                83970020
SMSG15   DC    C'IKJ58225I DAIR ERROR CODE '                            83980020
LSMSG16  DC    AL2(L'SMSG16+HDR)                                        84000020
         DC    AL2(OFST)                                                84040020
SMSG16   DC    C'IKJ58205I ALIAS VALID ONLY FOR MEMBERS OF PARTITIONED X84080020
               DATA SETS'                                               84120020
LSMSG17  DC    AL2(L'SMSG17+HDR)                                        84160020
         DC    AL2(OFST)                                                84200020
SMSG17   DC    C'IKJ58206I MORE THAN ONE * IN DATA SET NAME'            84240020
LSMSG18  DC    AL2(L'SMSG18+HDR)                                        84280020
         DC    AL2(OFST)                                                84320020
SMSG18   DC    C'IKJ58206I * NOT VALID AS FIRST INDEX LEVEL'            84360020
LSMSG19  DC    AL2(L'SMSG19+HDR)                                        84400020
         DC    AL2(OFST)                                                84440020
SMSG19   DC    C'IKJ58206I DATA SET NAMES USED * AT DIFFERENT LEVELS'   84480020
LSMSG20  DC    AL2(L'SMSG20+HDR)                                        84520020
         DC    AL2(OFST)                                                84560020
SMSG20   DC    C'IKJ58207I RENAME ERROR CODE '                          84600020
LSMSG21  DC    AL2(L'SMSG21+HDR)                                        84640020
         DC    AL2(OFST)                                                84680020
SMSG21   DC    C'IKJ58207I BLDL ERROR CODE '                            84720020
LSMSG22  DC    AL2(L'SMSG22+HDR)                                        84760020
         DC    AL2(OFST)                                                84800020
SMSG22   DC    C'IKJ58207I STOW ERROR CODE '                            84840020
LSMSG23  DC    AL2(L'SMSG23+HDR)                                        84880020
         DC    AL2(OFST)                                                84920020
SMSG23   DC    C'IKJ58207I DATA SET RESIDES ON MULTIPLE VOLUMES'        84960020
LSMSG24  DC    AL2(L'SMSG24+HDR)                                        85000020
         DC    AL2(OFST)                                                85010020
SMSG24   DC    C'IKJ58229I INVALID UNIT IN USER ATTRIBUTE DATA SET'     85020020
LSMSG25  DC    AL2(L'SMSG25+HDR)                                        85040020
         DC    AL2(OFST)                                                85050020
SMSG25   DC    C'IKJ58229I NO UNIT AVAILABLE'                           85060020
LSMSG26  EQU   *                   UNUSED SECOND LEVEL MESSAGE          85080020
LSMSG27  DC    AL2(L'SMSG27+HDR)                                        85120020
         DC    AL2(OFST)                                                85160020
SMSG27   DC    C'IKJ58208I BOTH MEMBERS MUST BE FROM THE SAME PARTITIONX85200020
               ED DATA SET'                                             85240020
LSMSG28  DC    AL2(L'SMSG28+HDR)                                        85280020
         DC    AL2(OFST)                                                85320020
SMSG28   DC    C'IKJ58208I A DATA SET CAN NOT BE RENAMED TO A MEMBER NAX85360020
               ME'                                                      85400020
LSMSG29  DC    AL2(L'SMSG29+HDR)                                        85440020
         DC    AL2(OFST)                                                85480020
SMSG29   DC    C'IKJ58208I A MEMBER NAME CAN NOT BE RENAMED TO A DATA SX85520020
               ET'                                                      85560020
LSMSG30  DC    AL2(L'SMSG30+HDR)                                        85600020
         DC    AL2(OFST)                                                85640020
SMSG30   DC    C'IKJ58203I SYSTEM OPERATOR DID NOT AUTHORIZE ACCESS TO X85680020
               DATA SET'                                         A49872 85720021
PATCH    DC    20X'00'             PATCH AREA                           93730037
         END                                                            95730037
