         TITLE '''SYNCH'' SUBCOMMAND OF ACCOUNT                      '  00001000
         EJECT                                                          00002000
IKJRBBCR CSECT ,                                                   0002 00003000
@MAINENT DS    0H                                                  0002 00004000
         USING *,@15                                               0002 00005000
         B     @PROLOG                                             0002 00006000
         DC    AL1(16)                                             0002 00007000
         DC    C'IKJRBBCR  73.153'                                 0002 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00010000
         BALR  @11,0                                               0002 00011000
@PSTART  DS    0H                                                  0002 00012000
         USING @PSTART,@11                                         0002 00013000
         L     @00,@SIZDATD                                        0002 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @12,@01                                             0002 00016000
         USING @DATD,@12                                           0002 00017000
         ST    @13,@SA00001+4                                      0002 00018000
         LM    @00,@01,20(@13)                                     0002 00019000
         ST    @12,8(,@13)                                         0002 00020000
         LR    @13,@12                                             0002 00021000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00022000
         MVC   @PC00001(4),0(@01)                                  0002 00023000
         MODID BRANCH='1'B                                              00024000
         EJECT                                                          00025000
         EJECT                                                          00026000
         EJECT                                                          00027000
         EJECT                                                          00028000
*    CPPLPTR = R1;                 /* SAVE PTR TO PARM LIST         */  00029000
         ST    R1,CPPLPTR                                          0096 00030000
*    RFY (R2) RSTD;                                                0097 00031000
*    CALL INITS;                   /* DO INITIALIZATION, SET UP PARM    00032000
*                                     LISTS, ETC.                   */  00033000
         BAL   @14,INITS                                           0098 00034000
*    CALL ALLOCBC;                 /* ALLOCATE BRODCAST DATA SET.  0099 00035000
*                                     'BCASTDDN' IS SET BY 'ALLOCBC'*/  00036000
         BAL   @14,ALLOCBC                                         0099 00037000
*    IF SUBRETC = 0 THEN           /* CHECK RET CODE FROM 'ALLOCBC' */  00038000
         CLI   SUBRETC,0                                           0100 00039000
         BNE   @RF00100                                            0100 00040000
*      DO;                                                         0101 00041000
*        CALL OPENUADS;            /* ENQ AND OPEN UADS             */  00042000
         BAL   @14,OPENUADS                                        0102 00043000
*        IF SUBRETC = 0 THEN       /* CHECK RET CODE FROM 'OPENUADS'*/  00044000
         CLI   SUBRETC,0                                           0103 00045000
         BNE   @RF00103                                            0103 00046000
*          DO;                                                     0104 00047000
*            CALL OPENBCST;        /* ENQ, OPEN BROADCAST AND DO   0105 00048000
*                                     'CREATE' PROCESSING           */  00049000
         BAL   @14,OPENBCST                                        0105 00050000
*            IF SUBRETC = 0 THEN   /* CHECK RET CODE FROM 'OPENBCST'*/  00051000
         CLI   SUBRETC,0                                           0106 00052000
         BNE   @RF00106                                            0106 00053000
*              DO;                                                 0107 00054000
*                CALL FORMAT;      /* FORMAT AND WRITE THE MAIL DIR-    00055000
*                                     ECTORY RECORDS OF BROADCAST DS*/  00056000
         BAL   @14,FORMAT                                          0108 00057000
*                IF SUBRETC = 0 THEN /* CHECK RET CODE FROM 'FORMAT'*/  00058000
         CLI   SUBRETC,0                                           0109 00059000
         BNE   @RF00109                                            0109 00060000
*                  MSGINDX = MSGIDD0; /* INDICATE MSG TO BE ISSUED -    00061000
*                                     'BROADCAST DATA SET FORMATTED'*/  00062000
         MVC   MSGINDX(4),MSGIDD0                                  0110 00063000
*                ELSE              /* ERROR IN 'FORMAT' SUBRTN      */  00064000
*                  FBADSYNC = '1'B;                                0111 00065000
         B     @RC00109                                            0111 00066000
@RF00109 OI    FBADSYNC,B'00100000'                                0111 00067000
*              END;                                                0112 00068000
*            ELSE                  /* ERROR IN 'OPENBCST' SUBRTN    */  00069000
*              FBADSYNC = '1'B;                                    0113 00070000
         B     @RC00106                                            0113 00071000
@RF00106 OI    FBADSYNC,B'00100000'                                0113 00072000
*          END;                                                    0114 00073000
*        ELSE                      /* ERROR IN 'OPENUADS' SUBRTN    */  00074000
*          FBADSYNC = '1'B;                                        0115 00075000
         B     @RC00103                                            0115 00076000
@RF00103 OI    FBADSYNC,B'00100000'                                0115 00077000
*      END;                                                        0116 00078000
*    ELSE                          /* ERROR IN 'ALLOCBC' SUBRTN     */  00079000
*      FBADSYNC = '1'B;                                            0117 00080000
*                                                                  0117 00081000
         B     @RC00100                                            0117 00082000
@RF00100 OI    FBADSYNC,B'00100000'                                0117 00083000
*    IF MSGINDX ^= 0 THEN          /* CHECK IF ANY MSG TO BE ISSUED */  00084000
@RC00100 MVC   @TF00001(4),MSGINDX                                 0118 00085000
         L     @10,@TF00001                                        0118 00086000
         LTR   @10,@10                                             0118 00087000
         BZ    @RF00118                                            0118 00088000
*      DO;                         /* YES, SET UP TO CALL IKJEFF02  */  00089000
*        MSGCSECT = ADDR(IKJRBBCM); /* PTR TO MSG CSECT             */  00090000
         L     @10,@CA00338                                        0120 00091000
         ST    @10,MSGCSECT                                        0120 00092000
*        MSGREVER = '1'B;          /* INDICATE PUTLINE TO BE USED   */  00093000
         OI    MSGREVER,B'01000000'                                0121 00094000
*                                  /* MSG INDICATOR, MSGINDX, IS   0122 00095000
*                                     ALREADY SET UP                */  00096000
*        /*   CALL IKJEFF02 TO ISSUE DIAGNOSTIC MSG                 */  00097000
*        CALL IKJEFF02 (MSGPARM,ACCTCPPL,SDECB);                   0122 00098000
         LA    @10,MSGPARM                                         0122 00099000
         ST    @10,@AL00001                                        0122 00100000
         L     @10,CPPLPTR                                         0122 00101000
         ST    @10,@AL00001+4                                      0122 00102000
         LA    @10,SDECB                                           0122 00103000
         ST    @10,@AL00001+8                                      0122 00104000
         L     @15,@CV00291                                        0122 00105000
         LA    @01,@AL00001                                        0122 00106000
         BALR  @14,@15                                             0122 00107000
*      END;                                                        0123 00108000
*    ELSE;                         /* NO MESSAGE TO ISSUE           */  00109000
         B     @RC00118                                            0124 00110000
@RF00118 DS    0H                                                  0125 00111000
*    CALL CLEANUP;                 /* CLOSE DATA SETS, DEQ, ETC.    */  00112000
*                                                                  0125 00113000
@RC00118 BAL   @14,CLEANUP                                         0125 00114000
*EXITCODE:                                                         0126 00115000
*    IF FBADSYNC = '1'B THEN       /* CHECK FOR ANY ERROR           */  00116000
EXITCODE TM    FBADSYNC,B'00100000'                                0126 00117000
         BNO   @RF00126                                            0126 00118000
*      DO;                         /* YES, SOME ERROR OCCURRED      */  00119000
*        R2 = CPPLECB;             /* REG2 = ADDR. ACCOUNT ECB      */  00120000
         L     @10,CPPLPTR                                         0128 00121000
         L     R2,CPPLECB(,@10)                                    0128 00122000
*        GEN (POST  (R2),12)           /* POST ACCOUNT ECB WITH '12'*/  00123000
*            REFS(R2);                                             0129 00124000
         POST  (R2),12                                                  00125000
*      END;                                                        0130 00126000
*    ELSE;                         /* SUCCESSFUL COMPLETION         */  00127000
         B     @RC00126                                            0131 00128000
*    RETURN;                       /* RETURN TO CALLER, ACCOUNT     */  00129000
@EL00001 L     @13,4(,@13)                                         0132 00130000
@EF00001 L     @00,@SIZDATD                                        0132 00131000
         LR    @01,@12                                             0132 00132000
         FREEMAIN R,LV=(0),A=(1)                                        00133000
@ER00001 LM    @14,@12,12(@13)                                     0132 00134000
         BR    @14                                                 0132 00135000
*INITS:  PROC  ;                                                   0133 00136000
*                                                                  0133 00137000
INITS    STM   @14,@12,@SA00002                                    0133 00138000
*    SDECB = SDECB && SDECB;       /* CLEAR SYNC ECB TO ZERO. ECB  0134 00139000
*                                     ADDR IS PASSED TO DAIR.       */  00140000
         XC    SDECB(4),SDECB                                      0134 00141000
*    MSGPARM = MSGPARM && MSGPARM; /* CLEAR PARMLIST FOR IKJEFF02   */  00142000
         XC    MSGPARM(36),MSGPARM                                 0135 00143000
*    GEN  (MVC  AUTOLIST(LISTEND-LISTBEG),LISTBEG);                0136 00144000
         MVC  AUTOLIST(LISTEND-LISTBEG),LISTBEG                         00145000
*/*                                                                 */  00146000
*/*                     SET UP ACCTPLST                             */  00147000
*/*                                                                 */  00148000
*    UPTPTR = CPPLUPT;             /* PTR TO UPT                    */  00149000
         L     @10,CPPLPTR                                         0137 00150000
         MVC   UPTPTR(4),CPPLUPT(@10)                              0137 00151000
*    ECTPTR = CPPLECT;             /* PTR TO ECT                    */  00152000
         MVC   ECTPTR(4),CPPLECT(@10)                              0138 00153000
*    AECBPTR = CPPLECB;            /* PTR TO ACCOUNT'S ECB          */  00154000
         MVC   AECBPTR(4),CPPLECB(@10)                             0139 00155000
*    BUFPTR  = CPPLCBUF;           /* PTR TO COMMAND BUFFER         */  00156000
         MVC   BUFPTR(4),CPPLCBUF(@10)                             0140 00157000
*    CMDIND = 0;                   /* THIS FIELD IS SET TO 1 BY    0141 00158000
*                                     ACCOUNT IF LISTIDS CMD ENTERED*/  00159000
         SR    @10,@10                                             0141 00160000
         ST    @10,CMDIND                                          0141 00161000
*    USDPTR = ADDR(DIRAREA);       /* SET PTR TO BRODCAST DIRECTORY     00162000
*                                     WORK AREA WHERE RCD IS BUILT  */  00163000
         LA    @10,DIRAREA                                         0142 00164000
         ST    @10,@TF00001                                        0142 00165000
         MVC   USDPTR(3),@TF00001+1                                0142 00166000
*    USDIR = USDIR && USDIR;       /* CLEAR BRODCAST DIRECTORY TO 0 */  00167000
         XC    USDIR(129,@10),USDIR(@10)                           0143 00168000
*    FLAGS = '0'B;                 /* CLEAR ALL FLAGS TO ZERO       */  00169000
         MVI   FLAGS,B'00000000'                                   0144 00170000
*    RETURN;                       /* RETURN TO MAINLINE PROCESSING */  00171000
@EL00002 DS    0H                                                  0145 00172000
@EF00002 DS    0H                                                  0145 00173000
@ER00002 LM    @14,@12,@SA00002                                    0145 00174000
         BR    @14                                                 0145 00175000
*    END INITS;                                                    0146 00176000
*ALLOCBC:                                                          0147 00177000
*        PROC  ;                                                   0147 00178000
ALLOCBC  STM   @14,@12,@SA00003                                    0147 00179000
*    RFY (R1) RSTD;                                                0148 00180000
*    IF ECTBKGRD = '0'B THEN       /* TEST IF RUNNING IN BACKGROUND */  00181000
         L     @10,ECTPTR                                          0149 00182000
         TM    ECTBKGRD(@10),B'00000010'                           0149 00183000
         BNZ   @RF00149                                            0149 00184000
*      DO;                         /* NO, THIS IS FOREGROUND-USE DAIR*/ 00185000
* /*                                                                 */ 00186000
* /*                 -    D    A    I    R    -                      */ 00187000
* /*                                                                 */ 00188000
* /*      GO TO DAIR WITH CODE X'08' TO REQUEST ALLOCATION OF        */ 00189000
* /*      BROADCAST DATA SET.  SINCE THE DATA SET IS CATALOGED,      */ 00190000
* /*      ONLY THE DSNAME AND DISPOSITION FIELDS NEED BE SUPPLIED.   */ 00191000
* /*                                                                 */ 00192000
*         DAPB0PTR = ADDR(AUTODAIR);/* SET BASE FOR DAIR PARM BL     */ 00193000
         LA    @10,AUTODAIR                                        0151 00194000
         ST    @10,DAPB0PTR                                        0151 00195000
*         DAPB08=DAPB08 && DAPB08;  /* CLEAR DAIR PARM BL            */ 00196000
         XC    DAPB08(84,@10),DAPB08(@10)                          0152 00197000
*         DA08CD = DAIRCD08;        /* SET DAIR CODE = X'08'         */ 00198000
         MVC   DA08CD(2,@10),DAIRCD08                              0153 00199000
*         DA08PDSN = ADDR(DAIRDSN); /* PTR TO DATA SET NAME          */ 00200000
         LA    @00,DAIRDSN                                         0154 00201000
         ST    @00,DA08PDSN(,@10)                                  0154 00202000
*         DA08DDN  = ' ';           /* DDNAME FIELD = BLANK,       0155 00203000
*                                      DDNAME IS RETURNED HERE       */ 00204000
         MVI   DA08DDN+1(@10),C' '                                 0155 00205000
         MVC   DA08DDN+2(6,@10),DA08DDN+1(@10)                     0155 00206000
         MVI   DA08DDN(@10),C' '                                   0155 00207000
*         DA08UNIT = ' ';           /* UNITNAME = BLANK              */ 00208000
         MVI   DA08UNIT+1(@10),C' '                                0156 00209000
         MVC   DA08UNIT+2(6,@10),DA08UNIT+1(@10)                   0156 00210000
         MVI   DA08UNIT(@10),C' '                                  0156 00211000
*         DA08SER = ' ';            /* VOLUME SERIAL NO. = BLANK     */ 00212000
         MVI   DA08SER+1(@10),C' '                                 0157 00213000
         MVC   DA08SER+2(6,@10),DA08SER+1(@10)                     0157 00214000
         MVI   DA08SER(@10),C' '                                   0157 00215000
*         DA08MNM = ' ';            /* MEMBER NAME = BLANK           */ 00216000
         MVI   DA08MNM+1(@10),C' '                                 0158 00217000
         MVC   DA08MNM+2(6,@10),DA08MNM+1(@10)                     0158 00218000
         MVI   DA08MNM(@10),C' '                                   0158 00219000
*         DA08PSWD = ' ';           /* DATA SET PASSWORD = BLANK     */ 00220000
         MVI   DA08PSWD+1(@10),C' '                                0159 00221000
         MVC   DA08PSWD+2(6,@10),DA08PSWD+1(@10)                   0159 00222000
         MVI   DA08PSWD(@10),C' '                                  0159 00223000
*         DA08SHR = '1'B;           /* STATUS = SHARE                */ 00224000
         OI    DA08SHR(@10),B'00001000'                            0160 00225000
*         DA08KEEP = '1'B;          /* NORMAL DISPOSITION = KEEP     */ 00226000
         OI    DA08KEEP(@10),B'00001000'                           0161 00227000
*         DA08KEP = '1'B;           /* CONDITIONAL DISPOSITION = KEEP*/ 00228000
         OI    DA08KEP(@10),B'00001000'                            0162 00229000
*         DAPLPTR = ADDR(AUTOPARM); /* SET POINTER TO PARM LIST      */ 00230000
         LA    @00,AUTOPARM                                        0163 00231000
         ST    @00,DAPLPTR                                         0163 00232000
*         DAPLUPT = CPPLUPT;        /* UPT ADDR                      */ 00233000
         L     @15,CPPLPTR                                         0164 00234000
         LR    @14,@00                                             0164 00235000
         MVC   DAPLUPT(4,@14),CPPLUPT(@15)                         0164 00236000
*         DAPLECT = CPPLECT;        /* ECT ADDR                      */ 00237000
         LR    @14,@00                                             0165 00238000
         MVC   DAPLECT(4,@14),CPPLECT(@15)                         0165 00239000
*         DAPLECB = ADDR(SDECB);    /* ADDR OF SEND ECB              */ 00240000
         LA    @14,SDECB                                           0166 00241000
         LR    @09,@00                                             0166 00242000
         ST    @14,DAPLECB(,@09)                                   0166 00243000
*         DAPLPSCB = CPPLPSCB;      /* PTR TO PSCB                   */ 00244000
         LR    @14,@00                                             0167 00245000
         MVC   DAPLPSCB(4,@14),CPPLPSCB(@15)                       0167 00246000
*         DAPLDAPB = DAPB0PTR;      /* PTR TO DAIR PARM BLOCK        */ 00247000
         LR    @15,@00                                             0168 00248000
         ST    @10,DAPLDAPB(,@15)                                  0168 00249000
*         R1 = DAPLPTR;             /* SET REG1 = ADDR PARM LIST     */ 00250000
         LR    R1,@00                                              0169 00251000
*         GEN  (LINK  EP=IKJDAIR);  /* LINK TO DAIR '08'            */  00252000
         LINK  EP=IKJDAIR                                               00253000
*                                  /*TO ALLOCATE BROADCAST DATA SET */  00254000
*        DAIRRETC = R15;           /* SAVE RETURN CODE FROM REG 15  */  00255000
         ST    R15,DAIRRETC                                        0171 00256000
*        IF DAIRRETC > 0 THEN      /* TEST RETURN CODE FROM DAIR    */  00257000
         L     @10,DAIRRETC                                        0172 00258000
         LTR   @10,@10                                             0172 00259000
         BNP   @RF00172                                            0172 00260000
*          DO;                     /* SOME ERROR IN DAIR PROCESSING,    00261000
*                                     CALL COMMON DAIR FAIL ROUTINE */  00262000
*            GEN (LOAD  EP=IKJEFF18);                              0174 00263000
         LOAD  EP=IKJEFF18                                              00264000
*            F18ADDR = R0;         /* SAVE ENTRY PT ADDR FROM REG 0     00265000
*                                     AFTER LOAD OF IKJEFF18        */  00266000
         ST    R0,F18ADDR                                          0175 00267000
*            CALL IKJEFF18 (DAPL,DAIRRETC,F18F02,F18CLNO);         0176 00268000
         L     @10,DAPLPTR                                         0176 00269000
         ST    @10,@AL00001                                        0176 00270000
         LA    @10,DAIRRETC                                        0176 00271000
         ST    @10,@AL00001+4                                      0176 00272000
         LA    @10,F18F02                                          0176 00273000
         ST    @10,@AL00001+8                                      0176 00274000
         LA    @10,F18CLNO                                         0176 00275000
         ST    @10,@AL00001+12                                     0176 00276000
         L     @10,F18ADDR                                         0176 00277000
         LR    @15,@10                                             0176 00278000
         LA    @01,@AL00001                                        0176 00279000
         BALR  @14,@15                                             0176 00280000
*            GEN (DELETE  EP=IKJEFF18);                            0177 00281000
         DELETE  EP=IKJEFF18                                            00282000
*            SUBRETC = 4;          /* SET SUBROUTINE RETURN CODE =4 */  00283000
         MVI   SUBRETC,X'04'                                       0178 00284000
*          END;                                                    0179 00285000
*        ELSE                      /* DAIR RETURN CODE =0, SUCCESS  */  00286000
*          DO;                     /* SAVE DDNAME FOR BRODCAST      */  00287000
         B     @RC00172                                            0180 00288000
@RF00172 DS    0H                                                  0181 00289000
*            BCASTDDN = DA08DDN;   /* SAVE DDNAME RETURNED BY DAIR  */  00290000
         L     @10,DAPB0PTR                                        0181 00291000
         MVC   BCASTDDN(8),DA08DDN(@10)                            0181 00292000
*            SUBRETC = 0;          /* SET SUBROUTINE RETURN CODE = 0    00293000
*                                     FOR SUCCESSFUL COMPLETION     */  00294000
         MVI   SUBRETC,X'00'                                       0182 00295000
*          END;                                                    0183 00296000
*      END;                                                        0184 00297000
*    ELSE                          /* BACKGROUND, DO NOT USE DAIR   */  00298000
*      DO;                         /* USE DDNAME FROM BMP PROCEDURE */  00299000
         B     @RC00149                                            0185 00300000
@RF00149 DS    0H                                                  0186 00301000
*        BCASTDDN = 'SYSLBC';      /* SET DDNAME FOR BRODCAST       */  00302000
         MVI   BCASTDDN+6,C' '                                     0186 00303000
         MVI   BCASTDDN+7,C' '                                     0186 00304000
         MVC   BCASTDDN(6),@CC00362                                0186 00305000
*        SUBRETC = 0;              /* SET SUBROUTINE RETURN CODE =0     00306000
*                                     FOR SUCCESSFUL COMPLETION     */  00307000
         MVI   SUBRETC,X'00'                                       0187 00308000
*      END;                                                        0188 00309000
*    RETURN;                       /* RETURN TO MAINLINE PROCESSING */  00310000
@EL00003 DS    0H                                                  0189 00311000
@EF00003 DS    0H                                                  0189 00312000
@ER00003 LM    @14,@12,@SA00003                                    0189 00313000
         BR    @14                                                 0189 00314000
*    END ALLOCBC;                                                  0190 00315000
         B     @EL00003                                            0190 00316000
*OPENBCST:                                                         0191 00317000
*        PROC  ;                                                   0191 00318000
OPENBCST STM   @14,@12,@SA00004                                    0191 00319000
*                                  /* ENQ EXCLUSIVE ON BRODCAST DS  */  00320000
*    GEN (ENQ (QNBCAST,RNBCAST1,E,3,SYSTEM),RET=HAVE,MF=(E,ENQEL) );    00321000
         ENQ (QNBCAST,RNBCAST1,E,3,SYSTEM),RET=HAVE,MF=(E,ENQEL)        00322000
* /*                                                                 */ 00323000
* /*      CALL IO RTN TO OPEN BROADCAST DATA SET                     */ 00324000
* /*                                                                 */ 00325000
*    IOPARML = IOPARML && IOPARML;  /* CLEAR ENTIRE PARM AREA        */ 00326000
         XC    IOPARML(32),IOPARML                                 0193 00327000
*    P1OPEN = '1'B;                 /* SET PARM FLAG FOR OPEN        */ 00328000
         OI    P1OPEN,B'10000000'                                  0194 00329000
*    PARMDDNM = BCASTDDN;           /* SET DDNAME IN PARM LIST       */ 00330000
         MVC   PARMDDNM(8),BCASTDDN                                0195 00331000
*    R1 = ADDR(IOPARML);            /* REG1 = ADDR PARM LIST         */ 00332000
         LA    R1,IOPARML                                          0196 00333000
*    CALL  IEEVSDIO;                /* CALL IO RTN TO OPEN DATA SET  */ 00334000
         L     @15,@CV00289                                        0197 00335000
         BALR  @14,@15                                             0197 00336000
*    RETC = R15;                    /* SAVE RETURN CODE FROM IO RTN  */ 00337000
         ST    R15,RETC                                            0198 00338000
*    IF RETC > 0                    /* RETURN CODE GREATER THAN ZERO */ 00339000
*       & RETC ^= RCREFORM THEN     /* AND NOT 'REFORMAT'            */ 00340000
         L     @10,RETC                                            0199 00341000
         LTR   @10,@10                                             0199 00342000
         BNP   @RF00199                                            0199 00343000
         MVC   @ZT00003+3(1),RCREFORM                              0199 00344000
         C     @10,@ZT00003                                        0199 00345000
         BE    @RF00199                                            0199 00346000
*      DO;                          /* OPEN WAS NOT SUCCESSFUL       */ 00347000
*        SUBRETC = 4;               /* SET SUBROUTINE RETURN CODE = 4*/ 00348000
         MVI   SUBRETC,X'04'                                       0201 00349000
*        MSGINDX = MSGID52;         /* INDICATE DIAG MSG TO BE ISSUED - 00350000
*                                      CANNOT OPEN BROADCAST D.S.   */  00351000
         MVC   MSGINDX(4),MSGID52                                  0202 00352000
*      END;                                                        0203 00353000
*    ELSE                          /* OPEN WAS SUCCESSFUL           */  00354000
*      DO;                         /* 'CREATE' BROADCAST USING BSAM */  00355000
         B     @RC00199                                            0204 00356000
@RF00199 DS    0H                                                  0205 00357000
*        FBCOPEN = '1'B;           /* SET FLAG FOR BROADCAST OPEN   */  00358000
         OI    FBCOPEN,B'01000000'                                 0205 00359000
*        SDIOPARM = SDIOPARM && SDIOPARM; /* CLEAR PARM LIST AREA   */  00360000
         XC    SDIOPARM(12),SDIOPARM                               0206 00361000
*        P1CREATE = '1'B;          /* SET INDICATOR FOR 'CREATE'    */  00362000
         OI    P1CREATE,B'00100000'                                0207 00363000
*        R1 = ADDR(IOPARML);       /* REG1 = ADDR PARMLIST          */  00364000
         LA    R1,IOPARML                                          0208 00365000
*        CALL IEEVSDIO;            /* CALL I/O RTN TO DO 'CREATE' OF    00366000
*                                     BRODCAST USING BSAM           */  00367000
         L     @15,@CV00289                                        0209 00368000
         BALR  @14,@15                                             0209 00369000
*        RETC = R15;               /* SAVE RETURN CODE FROM REG15   */  00370000
         ST    R15,RETC                                            0210 00371000
*        IF RETC > 0 THEN          /* CHECK RETURN CODE FROM I/O RTN*/  00372000
         L     @10,RETC                                            0211 00373000
         LTR   @10,@10                                             0211 00374000
         BNP   @RF00211                                            0211 00375000
*          DO;                     /* NON-ZERO RET CODE, SOME ERROR */  00376000
*            SUBRETC =8;           /* SET SUBROUTINE RETURN CODE TO     00377000
*                                     SAY DIAG. MSG NEEDED          */  00378000
         MVI   SUBRETC,X'08'                                       0213 00379000
*            MSGINDX = MSGID51;    /* INDICATE DIAG MSG TO BE ISSUED -  00380000
*                                     BROADCAST D.S. NOT USABLE,   0214 00381000
*                                     I/O SYNAD ERROR               */  00382000
         MVC   MSGINDX(4),MSGID51                                  0214 00383000
*          END;                                                    0215 00384000
*        ELSE                      /* SUCCESSFUL 'CREATE'           */  00385000
*          SUBRETC = 0;            /* SET SUBROUTINE RETURN CODE =0     00386000
*                                     FOR SUCCESSFUL COMPLETION     */  00387000
         B     @RC00211                                            0216 00388000
@RF00211 MVI   SUBRETC,X'00'                                       0216 00389000
*      END;                                                        0217 00390000
*    RETURN;                       /* RETURN TO MAINLINE PROCESSING */  00391000
@EL00004 DS    0H                                                  0218 00392000
@EF00004 DS    0H                                                  0218 00393000
@ER00004 LM    @14,@12,@SA00004                                    0218 00394000
         BR    @14                                                 0218 00395000
*    END OPENBCST;                                                 0219 00396000
         B     @EL00004                                            0219 00397000
*OPENUADS:                                                         0220 00398000
*        PROC  ;                                                   0220 00399000
OPENUADS STM   @14,@12,@SA00005                                    0220 00400000
*    GEN (ENQ  (QNUADS,RNUADS,E,8,SYSTEM),RET=HAVE,MF=(E,ENQEL) ); 0221 00401000
         ENQ  (QNUADS,RNUADS,E,8,SYSTEM),RET=HAVE,MF=(E,ENQEL)          00402000
*       /* CLEAR DIRECTORY WORK AREA     */                        0222 00403000
*    DIRYWA(1:256) = DIRYWA(1:256) && DIRYWA(1:256);               0222 00404000
         XC    DIRYWA(256),DIRYWA                                  0222 00405000
*    DIRYWA(257:DIRYWAL)                                           0223 00406000
*          = DIRYWA(257:DIRYWAL) && DIRYWA(257:DIRYWAL);           0223 00407000
         LH    @10,DIRYWAL                                         0223 00408000
         SH    @10,@CH00369                                        0223 00409000
         EX    @10,@SX00398                                        0223 00410000
*    UADSDCB = UADSDCBS;           /* MOVE UADS DCB INTO DIRECTORY 0224 00411000
*                                     WORK AREA, DIRYWA             */  00412000
         MVC   UADSDCB(88),UADSDCBS                                0224 00413000
*    RFY (UADCBPTR,R2) RSTD;                                       0225 00414000
*    R2 = ADDR(UADSDCB);                                           0226 00415000
         LA    R2,UADSDCB                                          0226 00416000
*    R1 = ADDR(OPENL);                                             0227 00417000
         LA    R1,OPENL                                            0227 00418000
*    GEN REFS(R2,R1,UADCBPTR);                                     0228 00419000
     OPEN  ((R2),(INPUT)),MF=(E,(R1))   OPEN DCB FOR UADS               00420000
     USING IHADCB,UADCBPTR              SET ADDRESSABILITY FOR DCB      00421000
*    UADCBPTR = ADDR(UADSDCB);     /* SET PTR TO UADS DCB           */  00422000
         LA    UADCBPTR,UADSDCB                                    0229 00423000
*    IF DCBOFLG  = '0'B THEN       /* TEST IF UADS DCB IS OPEN      */  00424000
         TM    DCBOFLG,B'00010000'                                 0230 00425000
         BNZ   @RF00230                                            0230 00426000
*      DO;                         /* NO, UADS DCB DID NOT OPEN     */  00427000
*        MSGINDX = MSGIDE1;        /* INDICATE DIAG. MSG REQ'D -   0232 00428000
*                                     CANNOT OPEN UADS              */  00429000
         MVC   MSGINDX(4),MSGIDE1                                  0232 00430000
*        SUBRETC =8;               /* SET SUBROUTINE RETURN CODE TO     00431000
*                                     INDICATE DIAG. MSG NEEDED     */  00432000
         MVI   SUBRETC,X'08'                                       0233 00433000
*      END;                                                        0234 00434000
*    ELSE                          /* UADS OPEN WAS SUCCESSFUL      */  00435000
*      DO;                                                         0235 00436000
         B     @RC00230                                            0235 00437000
@RF00230 DS    0H                                                  0236 00438000
*        FUAOPEN = '1'B;           /* SET FLAG FOR UADS OPEN        */  00439000
         OI    FUAOPEN,B'10000000'                                 0236 00440000
*        SUBRETC = 0;              /* SET SUBROUTINE RETURN CODE =0     00441000
*                                     FOR SUCCESSFUL COMPLETION     */  00442000
         MVI   SUBRETC,X'00'                                       0237 00443000
*      END;                                                        0238 00444000
*    RETURN;                       /* RETURN TO MAINLINE PROCESSING */  00445000
@EL00005 DS    0H                                                  0239 00446000
@EF00005 DS    0H                                                  0239 00447000
@ER00005 LM    @14,@12,@SA00005                                    0239 00448000
         BR    @14                                                 0239 00449000
*    END OPENUADS;                                                 0240 00450000
         B     @EL00005                                            0240 00451000
*FORMAT:                                                           0241 00452000
*        PROC  ;                                                   0241 00453000
FORMAT   STM   @14,@12,@SA00006                                    0241 00454000
*    R1PTR = PARMRC1;              /* SET PTR TO RECORD 1 BUFFER    */  00455000
         L     @10,PARMRC1                                         0242 00456000
         ST    @10,@TF00001                                        0242 00457000
         MVC   R1PTR(3),@TF00001+1                                 0242 00458000
*    RBAUSD = R1USPTR;             /* INIT PTR TO 1ST BROADCAST    0243 00459000
*                                     MAIL DIRECTORY RECORD         */  00460000
         MVC   RBAUSD(3),R1USPTR(@10)                              0243 00461000
*/*                                                                 */  00462000
*/*      SET UP PARM LIST FOR IKJEFA51                              */  00463000
*/*                                                                 */  00464000
*    READFLGS = '24'X;             /* READ DIRECTORY BLOCK ONLY     */  00465000
         MVI   READFLGS,X'24'                                      0244 00466000
*    DIRWAPTR = ADDR(DIRYWA);      /* PTR TO DIRECTORY WORK AREA    */  00467000
         LA    @10,DIRYWA                                          0245 00468000
         ST    @10,DIRWAPTR                                        0245 00469000
*    ACTPADDR = ADDR(ACCTPLST);    /* PTR TO ACCOUNT PARMLIST       */  00470000
         LA    @10,ACCTPLST                                        0246 00471000
         ST    @10,ACTPADDR                                        0246 00472000
*    MSGID = SYNCID;               /* SET MSG ID TO BE USED BY     0247 00473000
*                                     IKJEFA51 IF A DIAG MSG NEEDED */  00474000
         MVC   MSGID(1),SYNCID                                     0247 00475000
*/*                                                                 */  00476000
*/*      CALL IKJEFA51 TO READ A UADS DIRECTORY BLOCK.              */  00477000
*/*                                                                 */  00478000
*      USRCNT = 1;                 /* FORMAT 1 BROADCAST MAIL DIRECTORY 00479000
*                                     RECORD WITH USERIDS FROM UADS */  00480000
         MVI   USRCNT,X'01'                                        0248 00481000
*RDUADS:                                                           0249 00482000
*      R1 = ADDR(RDWRPARM);        /* REG1 = ADDR PARMLIST          */  00483000
RDUADS   LA    R1,RDWRPARM                                         0249 00484000
*      CALL IKJEFA51;              /* CALL ROUTINE TO READ 1 UADS  0250 00485000
*                                     DIRECTORY BLOCK               */  00486000
         L     @15,@CV00288                                        0250 00487000
         BALR  @14,@15                                             0250 00488000
*      RETC = R15;                 /* SAVE RETURN CODE FROM REG15   */  00489000
         ST    R15,RETC                                            0251 00490000
*      FRDUADS = '0'B;             /* TURN OFF 'READ UADS' FLAG     */  00491000
         NI    FRDUADS,B'11110111'                                 0252 00492000
*      IF RETC > 0 THEN            /* CHECK RET CODE FROM IKJEFA51  */  00493000
         L     @10,RETC                                            0253 00494000
         LTR   @10,@10                                             0253 00495000
         BNP   @RF00253                                            0253 00496000
*        DO;                       /* NON-ZERO RETURN CODE, ERROR   */  00497000
*          SUBRETC = 12;           /* SET SUBROUTINE RETURN CODE TO     00498000
*                                     INDICATE SOME ERROR OCCURRED.     00499000
*                                     EFA51 ISSUED ITS OWN DIAG MSG */  00500000
         MVI   SUBRETC,X'0C'                                       0255 00501000
*          GOTO FORMEND;           /* GO TO EXIT THIS SUBROUTINE    */  00502000
         B     FORMEND                                             0256 00503000
*        END;                                                      0257 00504000
*      ELSE;                       /* GOOD READ OF UADS, CONTINUE   */  00505000
*                                                                  0258 00506000
@RF00253 DS    0H                                                  0259 00507000
*         MEMPTR = ADDR(DIRYBLK) +2;  /* INIT PTR TO 1ST DIR. MEMBER*/  00508000
         LA    @10,DIRYBLK                                         0259 00509000
         AH    @10,@CH00055                                        0259 00510000
         ST    @10,MEMPTR                                          0259 00511000
*LNGFNDR: /* THIS LOOP WILL CALCULATE THE LENGTH OF THE USERID BY   */  00512000
*         /* FINDING THE 1ST NON-BLANK CHARACTER, STARTING FROM THE */  00513000
*         /* RIGHT. THAT CHARACTER IS THE EXTENT NUMBER & IS NOT    */  00514000
*         /* INCLUDED IN THE LENGTH.                                */  00515000
*         USRLEN = 7;                 /* SET STARTING LENGTH        */  00516000
LNGFNDR  MVC   USRLEN(2),@CH00275                                  0260 00517000
*LNGLOOP: /* BEGINNING OF THE LOOP                                  */  00518000
*         INDEXPTR = MEMPTR+USRLEN;   /* SET BASE PTR FOR BYTE TO BE    00519000
*                                        CHECKED                    */  00520000
LNGLOOP  LH    @10,USRLEN                                          0261 00521000
         L     @15,MEMPTR                                          0261 00522000
         AR    @15,@10                                             0261 00523000
         ST    @15,INDEXPTR                                        0261 00524000
*         /* IF THIS CHARACTER IS A NON-BLANK, THEN EXIT FROM LOOP  */  00525000
*         IF INDEX = ' '                                           0262 00526000
*           THEN                      /* BLANK, CONTINUE            */  00527000
         CLI   INDEX(@15),C' '                                     0262 00528000
         BNE   @RF00262                                            0262 00529000
*             DO;                                                  0263 00530000
*               USRLEN = USRLEN-1;    /* DECREMENT THE LENGTH       */  00531000
         BCTR  @10,0                                               0264 00532000
         STH   @10,USRLEN                                          0264 00533000
*               GOTO LNGLOOP;         /* GO LOOK AT NEXT CHARACTER  */  00534000
         B     LNGLOOP                                             0265 00535000
*             END;                                                 0266 00536000
*                                                                  0266 00537000
*         /* CHECK THE 1ST NON-BLANK CHARACTER. IF IT IS '0', THEN  */  00538000
*         /* THIS IS A BASE MEMBER & WILL BE PUT INTO BROADCAST MAIL*/  00539000
*         /* DIRECTORY. IF NOT, THEN IT IS EITHER AN EXTENSION OF THE*/ 00540000
*         /* PREVIOUS MEMBER OR THE END OF THE DIRECTORY.           */  00541000
*         IF INDEX = '0'              /* BASE MEMBER?               */  00542000
*           THEN                      /* YES,                       */  00543000
@RF00262 L     @10,INDEXPTR                                        0267 00544000
         CLI   INDEX(@10),C'0'                                     0267 00545000
         BNE   @RF00267                                            0267 00546000
*             DO;                     /* PUT THIS USERID FROM UADS 0268 00547000
*                                        INTO BROADCAST MAIL DIRECT-    00548000
*                                        ORY RECORD                 */  00549000
*               USDID(USRCNT) = MEMNAME(1:USRLEN);                 0269 00550000
*                                                                  0269 00551000
         SR    @10,@10                                             0269 00552000
         IC    @10,USRCNT                                          0269 00553000
         LR    @15,@10                                             0269 00554000
         MH    @15,@CH00167                                        0269 00555000
         L     @01,USDPTR-1                                        0269 00556000
         LA    @01,0(,@01)                                         0269 00557000
         ALR   @01,@15                                             0269 00558000
         AL    @01,@CF00401                                        0269 00559000
         MVI   USDID+1(@01),C' '                                   0269 00560000
         MVC   USDID+2(5,@01),USDID+1(@01)                         0269 00561000
         LH    @15,USRLEN                                          0269 00562000
         BCTR  @15,0                                               0269 00563000
         L     @14,MEMPTR                                          0269 00564000
         EX    @15,@SM00402                                        0269 00565000
*               USRCNT = USRCNT + 1;  /* BUMP INDEX TO BROADCAST   0270 00566000
*                                        MAIL DIRECTORY RCD         */  00567000
         AH    @10,@CH00034                                        0270 00568000
         STC   @10,USRCNT                                          0270 00569000
*               IF USRCNT > BCDIRMAX THEN                          0271 00570000
         CLC   USRCNT(1),BCDIRMAX                                  0271 00571000
         BNH   @RF00271                                            0271 00572000
*                 BRCDFULL = '1'B;    /* INDICATE BROADCAST DIRECTORY   00573000
*                                        RCD FULL                   */  00574000
         OI    BRCDFULL,B'00000100'                                0272 00575000
*             END;                                                 0273 00576000
@RF00271 DS    0H                                                  0274 00577000
*         /* IS IT THE END OF THE DIRECTORY (ALL BINARY ONES)?      */  00578000
*         IF MEMNAME =                /* END OF DIRECTORY?          */  00579000
*           'FFFFFFFFFFFFFFFF'X                                    0274 00580000
*           THEN                      /* YES,                       */  00581000
@RF00267 L     @10,MEMPTR                                          0274 00582000
         CLC   MEMNAME(8,@10),@CB00382                             0274 00583000
         BNE   @RF00274                                            0274 00584000
*                 DO;                                              0275 00585000
*                   EODFLG = '1'B;    /* 1- END OF DIRECTORY, NO MORE   00586000
*                                        USERIDS TO BE EXTRACTED    */  00587000
         OI    EODFLG,B'00010000'                                  0276 00588000
*                   GOTO WRITBC;      /* PUT OUT REMAINING USERIDS  */  00589000
         B     WRITBC                                              0277 00590000
*                 END;                                             0278 00591000
*           ELSE;                     /* NOT END OF DATA ON UADS    */  00592000
*                                                                  0279 00593000
@RF00274 DS    0H                                                  0280 00594000
*NEXTMEM: /* REFERENCE THE NEXT MEMBER ENTRY BY INCREMENTING THE    */  00595000
*         /* BASE POINTER BY THE CONSTANT LENGTH OF AN ENTRY AND THE*/  00596000
*         /* NUMBER OF USER HALF-WORDS CONTAINED IN BLOKC.          */  00597000
*         MEMPTR = MEMPTR+12+(BLOKC&'00011111'B)*2;                0280 00598000
*                                                                  0280 00599000
NEXTMEM  L     @10,MEMPTR                                          0280 00600000
         LA    @15,12                                              0280 00601000
         AR    @15,@10                                             0280 00602000
         LA    @14,31                                              0280 00603000
         MVC   @ZT00003+3(1),BLOKC(@10)                            0280 00604000
         N     @14,@ZT00003                                        0280 00605000
         AR    @14,@14                                             0280 00606000
         AR    @15,@14                                             0280 00607000
         ST    @15,MEMPTR                                          0280 00608000
*         /* CHECK FOR END OF BLOCK BY COMPARING THE BASE POINTER   */  00609000
*         /* TO THE ADDR OF THE BLOCK PLUS THE NUMBER OF BYTES USED */  00610000
*         /* ON THE BLOCK.                                          */  00611000
*         IF MEMPTR >= ADDR(DIRYBLK)+NUMBYTES                      0281 00612000
*           THEN                      /* YES, END OF BLOCK,         */  00613000
         LA    @10,DIRYBLK                                         0281 00614000
         MVC   @TF00001(2),NUMBYTES                                0281 00615000
         AH    @10,@TF00001                                        0281 00616000
         CR    @15,@10                                             0281 00617000
         BL    @RF00281                                            0281 00618000
*             DO;                                                  0282 00619000
*               FRDUADS = '1'B;       /* INDICATE 'READ UADS'       */  00620000
         OI    FRDUADS,B'00001000'                                 0283 00621000
*               IF BRCDFULL = '1'B THEN                            0284 00622000
         TM    BRCDFULL,B'00000100'                                0284 00623000
         BO    @RT00284                                            0284 00624000
*                 GOTO WRITBC;        /* GO WRITE BROADCAST RCD     */  00625000
*               ELSE                                               0286 00626000
*                 GOTO RDUADS;        /* GO READ NEXT UADS BLOCK    */  00627000
         B     RDUADS                                              0286 00628000
*             END;                                                 0287 00629000
*                                                                  0287 00630000
*           ELSE                      /* NO, NOT END OF UADS BLOCK  */  00631000
*             DO;                                                  0288 00632000
@RF00281 DS    0H                                                  0289 00633000
*               FRDUADS = '0'B;       /* INDICATE UADS READ NOT NEC.*/  00634000
         NI    FRDUADS,B'11110111'                                 0289 00635000
*               IF BRCDFULL = '1'B THEN                            0290 00636000
         TM    BRCDFULL,B'00000100'                                0290 00637000
         BO    @RT00290                                            0290 00638000
*                 GOTO WRITBC;        /* GO WRITE BROADCAST RCD     */  00639000
*               ELSE                  /* BROADCAST RCD NOT FULL     */  00640000
*                 GOTO LNGFNDR;       /* GO CALCULATE LENGTH        */  00641000
         B     LNGFNDR                                             0292 00642000
*             END;                                                 0293 00643000
*/*                                                                 */  00644000
*/*      WRITE A FORMATTED BRODCAST DIRECTORY RECORD                */  00645000
*/*                                                                 */  00646000
*WRITBC:                                                           0294 00647000
*    IF EODFLG= '0'B THEN          /* CHECK FOR END-OF-DIRECTORY    */  00648000
WRITBC   TM    EODFLG,B'00010000'                                  0294 00649000
         BNZ   @RF00294                                            0294 00650000
*      USDNEXT= RBAUSD +1;         /* NO, NOT END OF DATA, SET CHAIN    00651000
*                                     PTR TO NEXT MAIL DIRECTORY RCD*/  00652000
         L     @10,USDPTR-1                                        0295 00653000
         LA    @10,0(,@10)                                         0295 00654000
         LA    @15,1                                               0295 00655000
         MVC   @ZT00001+1(3),RBAUSD                                0295 00656000
         A     @15,@ZT00001                                        0295 00657000
         ST    @15,@TF00001                                        0295 00658000
         MVC   USDNEXT(3,@10),@TF00001+1                           0295 00659000
*    ELSE                          /* END OF DATA REACHED           */  00660000
*      USDNEXT = 0;                /* SET CHAIN PTR =0              */  00661000
         B     @RC00294                                            0296 00662000
@RF00294 L     @10,USDPTR-1                                        0296 00663000
         LA    @10,0(,@10)                                         0296 00664000
         SR    @15,@15                                             0296 00665000
         ST    @15,@TF00001                                        0296 00666000
         MVC   USDNEXT(3,@10),@TF00001+1                           0296 00667000
*      USDREND = '7F'X;            /* SET END-OF-RECORD INDICATOR    */ 00668000
@RC00294 L     @10,USDPTR-1                                        0297 00669000
         LA    @10,0(,@10)                                         0297 00670000
         MVI   USDREND(@10),X'7F'                                  0297 00671000
*                /* WRITE USER MAIL DIRECTORY RECORD        */     0298 00672000
*         SDIOPARM = SDIOPARM && SDIOPARM; /* CLEAR PARM AREA        */ 00673000
         XC    SDIOPARM(12),SDIOPARM                               0298 00674000
*         P2WRDI = '1'B;            /* SET PARM FLAG FOR WRITE 'DI'  */ 00675000
         OI    P2WRDI,B'10000000'                                  0299 00676000
*         PARMRBA = ADDR(RBAUSD);   /* SET RBA OF RECORD TO WRITE    */ 00677000
         LA    @10,RBAUSD                                          0300 00678000
         ST    @10,@TF00001                                        0300 00679000
         MVC   PARMRBA(4),@TF00001                                 0300 00680000
*         PARMIOAD = ADDR(DIRAREA); /* AREA ADDR OF RECORD TO WRITE  */ 00681000
         LA    @10,DIRAREA                                         0301 00682000
         ST    @10,@TF00001                                        0301 00683000
         MVC   PARMIOAD(4),@TF00001                                0301 00684000
*         PARMKEY = USDKEY;         /* SET KEY FOR USER DIRECTORY    */ 00685000
         MVC   PARMKEY(1),USDKEY                                   0302 00686000
*         R1 = ADDR(IOPARML);       /* REG 1 = ADDR PARM LIST        */ 00687000
         LA    R1,IOPARML                                          0303 00688000
*         CALL  IEEVSDIO;           /* CALL IO TO WRITE USER DIR. RC */ 00689000
         L     @15,@CV00289                                        0304 00690000
         BALR  @14,@15                                             0304 00691000
*         RETC = R15;               /* SAVE RETURN CODE REG15        */ 00692000
         ST    R15,RETC                                            0305 00693000
*    BRCDFULL = '0'B;              /* TURN OFF FLAG FOR BROADCAST  0306 00694000
*                                     DIRECTORY RECORD FULL         */  00695000
         NI    BRCDFULL,B'11111011'                                0306 00696000
*    IF RETC> 0 THEN               /* CHECK RETURN CODE FROM I/O RTN*/  00697000
         L     @10,RETC                                            0307 00698000
         LTR   @10,@10                                             0307 00699000
         BNP   @RF00307                                            0307 00700000
*      DO;                         /* NON-ZERO RET CODE, SOME ERROR */  00701000
*       SUBRETC = 8;               /* SET SUBROUTINE RETURN CODE TO     00702000
*                                     INDICATE DIAG. MSG NEEDED     */  00703000
         MVI   SUBRETC,X'08'                                       0309 00704000
*       IF RBAUSD ^< R1RECNUM THEN                                 0310 00705000
         L     @10,R1PTR-1                                         0310 00706000
         LA    @10,0(,@10)                                         0310 00707000
         L     @15,RBAUSD-1                                        0310 00708000
         LA    @15,0(,@15)                                         0310 00709000
         C     @15,R1RECNUM(,@10)                                  0310 00710000
         BL    @RF00310                                            0310 00711000
*         MSGINDX = MSGID40;       /* INDICATE DIAG MSG - NO SPACE 0311 00712000
*                                     IN BROADCAST FOR USERIDS      */  00713000
         MVC   MSGINDX(4),MSGID40                                  0311 00714000
*       ELSE                                                       0312 00715000
*         MSGINDX = MSGID51;       /* INDICATE DIAG MSG - BROADCAST D.  00716000
*                                     S. NOT USABLE, I/O SYNAD ERROR*/  00717000
         B     @RC00310                                            0312 00718000
@RF00310 MVC   MSGINDX(4),MSGID51                                  0312 00719000
*      END;                                                        0313 00720000
*    ELSE                          /* GOOD RETURN FROM I/O ROUTINE  */  00721000
*      DO;                                                         0314 00722000
         B     @RC00307                                            0314 00723000
@RF00307 DS    0H                                                  0315 00724000
*        DIRAREA= DIRAREA && DIRAREA;/* CLEAR AREA FOR NEXT BRODCAST    00725000
*                                     DIRECTORY RECORD TO ALL ZERO  */  00726000
         XC    DIRAREA(129),DIRAREA                                0315 00727000
*        USRCNT = 1;               /* RESET INDEX TO BROADCAST DIR  */  00728000
         MVI   USRCNT,X'01'                                        0316 00729000
*        RBAUSD = RBAUSD + 1;      /* BUMP RBA OF NEXT DIR RCD      */  00730000
         LA    @10,1                                               0317 00731000
         MVC   @ZT00001+1(3),RBAUSD                                0317 00732000
         A     @10,@ZT00001                                        0317 00733000
         ST    @10,@TF00001                                        0317 00734000
         MVC   RBAUSD(3),@TF00001+1                                0317 00735000
*        IF EODFLG = '0'B THEN     /* CHECK IF END-OF-DATA ON UADS  */  00736000
         TM    EODFLG,B'00010000'                                  0318 00737000
         BNZ   @RF00318                                            0318 00738000
*          DO;                     /* NOT END-OF-DIRECTORY ON UADS  */  00739000
*            IF FRDUADS = '1'B THEN/* IS 'READ UADS' INDICATED?     */  00740000
         TM    FRDUADS,B'00001000'                                 0320 00741000
         BO    @RT00320                                            0320 00742000
*              GOTO RDUADS;        /* YES, READ NEXT UADS DIR BLOCK */  00743000
*            ELSE                  /* NO, 'READ UADS' NOT INDICATED */  00744000
*              GOTO LNGFNDR;       /* CONTINUE PROCESSING THIS UADS     00745000
*                                     DIRECTORY BLOCK               */  00746000
         B     LNGFNDR                                             0322 00747000
*          END;                                                    0323 00748000
*        ELSE                      /* END-OF-DIRECTORY ON UADS      */  00749000
*          SUBRETC = 0;            /* SET SUBROUTINE RETURN CODE =0     00750000
*                                     TO INDICATE GOOD COMPLETION   */  00751000
@RF00318 MVI   SUBRETC,X'00'                                       0324 00752000
*      END;                                                        0325 00753000
*FORMEND:                          /* END OF 'FORMAT' SUBROUTINE    */  00754000
*    RETURN;                       /* RETURN TO MAINLINE PROCESSING */  00755000
@EL00006 DS    0H                                                  0326 00756000
@EF00006 DS    0H                                                  0326 00757000
@ER00006 LM    @14,@12,@SA00006                                    0326 00758000
         BR    @14                                                 0326 00759000
*    END FORMAT;                                                   0327 00760000
         B     @EL00006                                            0327 00761000
*CLEANUP:                                                          0328 00762000
*        PROC  ;                                                   0328 00763000
CLEANUP  STM   @14,@12,@SA00007                                    0328 00764000
*    RFY (R1,R2) RSTD;                                             0329 00765000
*    IF FUAOPEN = '1'B THEN        /* CHECK IF UADS DCB IS OPEN     */  00766000
         TM    FUAOPEN,B'10000000'                                 0330 00767000
         BNO   @RF00330                                            0330 00768000
*      DO;                         /* YES, UADS IS OPEN             */  00769000
*        R2 = ADDR(UADSDCB);       /* REG2 = ADDR UADS DCB          */  00770000
         LA    R2,UADSDCB                                          0332 00771000
*        R1 = ADDR(CLOSEL);        /* REG1 = ADDR LIST FORM OF CLOSE    00772000
*                                     MACRO                         */  00773000
         LA    R1,CLOSEL                                           0333 00774000
*        GEN (CLOSE ((R2)),MF=(E,(R1)) ) /* CLOSE UADS DCB         */   00775000
*        REFS(R2,R1);                                              0334 00776000
         CLOSE ((R2)),MF=(E,(R1))                                       00777000
*        FUAOPEN = '0'B;           /* TURN OFF'UADS OPEN' FLAG      */  00778000
         NI    FUAOPEN,B'01111111'                                 0335 00779000
*      END;                                                        0336 00780000
*    ELSE;                         /* NO, UADS NOT OPEN             */  00781000
         B     @RC00330                                            0337 00782000
@RF00330 DS    0H                                                  0338 00783000
*                                  /* DEQ CONDITIONALLY FROM UADS   */  00784000
*    GEN (DEQ (QNUADS,RNUADS,8,SYSTEM),RET=HAVE,MF=(E,DEQL) )      0338 00785000
*    REFS(QNUADS,RNUADS,8,DEQL);                                   0338 00786000
@RC00330 DS    0H                                                  0338 00787000
         DEQ (QNUADS,RNUADS,8,SYSTEM),RET=HAVE,MF=(E,DEQL)              00788000
*    IF FBCOPEN = '1'B THEN        /* CHECK IF BRODCAST DCB IS OPEN */  00789000
         TM    FBCOPEN,B'01000000'                                 0339 00790000
         BNO   @RF00339                                            0339 00791000
*      DO;                         /* YES, BRODCAST IS OPEN         */  00792000
*                 /* CLOSE BROADCAST DATA SET                */    0341 00793000
*         SDIOPARM = SDIOPARM && SDIOPARM; /* CLEAR PARM LIST AREA   */ 00794000
         XC    SDIOPARM(12),SDIOPARM                               0341 00795000
*         P2CLOSE = '1'B;           /* SET PARM FLAG FOR CLOSE       */ 00796000
         OI    P2CLOSE,B'00100000'                                 0342 00797000
*         R1 = ADDR(IOPARML);       /* REG1 = ADDR PARM LIST         */ 00798000
         LA    R1,IOPARML                                          0343 00799000
*         CALL IEEVSDIO;            /* CALL IO RTN TO CLOSE DATA SET */ 00800000
         L     @15,@CV00289                                        0344 00801000
         BALR  @14,@15                                             0344 00802000
*        FBCOPEN = '0'B;           /* TURN OFF 'BRODCAST OPEN' FLAG */  00803000
         NI    FBCOPEN,B'10111111'                                 0345 00804000
*      END;                                                        0346 00805000
*    ELSE;                         /* NO, BRODCAST NOT OPEN         */  00806000
         B     @RC00339                                            0347 00807000
@RF00339 DS    0H                                                  0348 00808000
*                                  /* DEQ CONDITIONALLY ON BRODCAST */  00809000
*    GEN (DEQ (QNBCAST,RNBCAST1,3,SYSTEM),RET=HAVE,MF=(E,DEQL) )   0348 00810000
*    REFS(QNBCAST,RNBCAST1,3,DEQL);                                0348 00811000
@RC00339 DS    0H                                                  0348 00812000
         DEQ (QNBCAST,RNBCAST1,3,SYSTEM),RET=HAVE,MF=(E,DEQL)           00813000
*    RETURN;                       /* RETURN TO MAINLINE PROCESSING */  00814000
@EL00007 DS    0H                                                  0349 00815000
@EF00007 DS    0H                                                  0349 00816000
@ER00007 LM    @14,@12,@SA00007                                    0349 00817000
         BR    @14                                                 0349 00818000
*    END CLEANUP;                                                  0350 00819000
@PB00007 DS    0H                                                  0351 00820000
*    GENERATE;                                                     0351 00821000
CABBAGE DC   50X'00'                PATCH AREA                          00822000
*        END IKJRBBCR                                              0352 00823000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00824000
*/*%INCLUDE SYSLIB  (IKJDAPL )                                        * 00825000
*/*%INCLUDE SYSLIB  (IKJDAP08)                                        * 00826000
*/*%INCLUDE SYSLIB  (IKJECT  )                                        * 00827000
*/*%INCLUDE SYSLIB  (IKJZT301)                                        * 00828000
*/*%INCLUDE SYSLIB  (IKJZT304)                                        * 00829000
*;                                                                 0352 00830000
         B     @EL00001                                            0352 00831000
@DATA    DS    0H                                                       00832000
@CH00034 DC    H'1'                                                     00833000
@CH00055 DC    H'2'                                                     00834000
@CH00275 DC    H'7'                                                     00835000
@CH00167 DC    H'13'                                                    00836000
@CH00369 DC    H'257'                                                   00837000
@SX00398 XC    DIRYWA+256(0),DIRYWA+256                                 00838000
@SM00402 MVC   USDID(0,@01),MEMNAME(@14)                                00839000
@DATD    DSECT                                                          00840000
         DS    0F                                                       00841000
@SA00001 DS    18F                                                      00842000
@PC00001 DS    1F                                                       00843000
@SAV001  EQU   @SA00001                                                 00844000
@SA00002 DS    15F                                                      00845000
@SA00003 DS    15F                                                      00846000
@SA00004 DS    15F                                                      00847000
@SA00005 DS    15F                                                      00848000
@SA00007 DS    15F                                                      00849000
@SA00006 DS    0F                                                       00850000
         DS    15F                                                      00851000
@AL00001 DS    4A                                                       00852000
@TF00001 DS    F                                                        00853000
@ZTEMPS  DS    0F                                                       00854000
@ZT00001 DC    F'0'                                                     00855000
@ZT00003 DC    F'0'                                                     00856000
@ZTEMPND EQU   *                                                        00857000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00858000
@TEMPS   EQU   @ZTEMPS                                                  00859000
@L       EQU   @ZLEN                                                    00860000
IKJRBBCR CSECT                                                          00861000
         DS    0F                                                       00862000
@CF00401 DC    F'-13'                                                   00863000
@DATD    DSECT                                                          00864000
         DS    0D                                                       00865000
CPPLPTR  DS    A                                                        00866000
INDEXPTR DS    A                                                        00867000
MEMPTR   DS    A                                                        00868000
DAPLPTR  DS    A                                                        00869000
DAPB0PTR DS    A                                                        00870000
F18ADDR  DS    A                                                        00871000
DAIRRETC DS    A                                                        00872000
RETC     DS    A                                                        00873000
USRLEN   DS    H                                                        00874000
         DS    CL3                                                      00875000
RBAUSD   DS    AL3                                                      00876000
USRCNT   DS    AL1                                                      00877000
R1PTR    DS    AL3                                                      00878000
         DS    CL1                                                      00879000
USDPTR   DS    AL3                                                      00880000
SUBRETC  DS    AL1                                                      00881000
         DS    CL3                                                      00882000
ACCTPLST DS    CL20                                                     00883000
         ORG   ACCTPLST                                                 00884000
UPTPTR   DS    AL4                                                      00885000
ECTPTR   DS    AL4                                                      00886000
AECBPTR  DS    AL4                                                      00887000
BUFPTR   DS    AL4                                                      00888000
CMDIND   DS    AL4                                                      00889000
         ORG   ACCTPLST+20                                              00890000
RDWRPARM DS    CL24                                                     00891000
         ORG   RDWRPARM                                                 00892000
UADSADDR DS    AL4                                                      00893000
         ORG   UADSADDR                                                 00894000
READFLGS DS    CL1                                                      00895000
         ORG   READFLGS                                                 00896000
@NM00001 DS    BL1                                                      00897000
READFL3  EQU   READFLGS+0                                               00898000
@NM00002 EQU   READFLGS+0                                               00899000
READFL6  EQU   READFLGS+0                                               00900000
@NM00003 EQU   READFLGS+0                                               00901000
         ORG   UADSADDR+1                                               00902000
@NM00004 DS    AL3                                                      00903000
         ORG   RDWRPARM+4                                               00904000
@NM00005 DS    AL4                                                      00905000
DIRWAPTR DS    AL4                                                      00906000
@NM00006 DS    AL4                                                      00907000
@NM00007 DS    AL4                                                      00908000
ACTPADDR DS    AL4                                                      00909000
         ORG   ACTPADDR                                                 00910000
MSGID    DS    CL1                                                      00911000
         ORG   RDWRPARM+24                                              00912000
DIRYWA   DS    CL344                                                    00913000
         ORG   DIRYWA                                                   00914000
UADSDCB  DS    CL88                                                     00915000
DIRYBLK  DS    CL256                                                    00916000
         ORG   DIRYBLK                                                  00917000
NUMBYTES DS    FL2                                                      00918000
         ORG   DIRYWA+344                                               00919000
AUTODAIR DS    CL84                                                     00920000
         DS    CL4                                                      00921000
AUTOPARM DS    CL20                                                     00922000
BCASTDDN DS    CL8                                                      00923000
SDECB    DS    CL4                                                      00924000
IOPARML  DS    CL32                                                     00925000
         ORG   IOPARML                                                  00926000
SDIOPARM DS    CL12                                                     00927000
         ORG   SDIOPARM                                                 00928000
@NM00029 DS    CL1                                                      00929000
         ORG   @NM00029                                                 00930000
P1OPEN   DS    BL1                                                      00931000
P1READ   EQU   @NM00029+0                                               00932000
P1CREATE EQU   @NM00029+0                                               00933000
         ORG   SDIOPARM+1                                               00934000
@NM00030 DS    CL1                                                      00935000
         ORG   @NM00030                                                 00936000
P2WRDI   DS    BL1                                                      00937000
P2WRDAF  EQU   @NM00030+0                                               00938000
P2CLOSE  EQU   @NM00030+0                                               00939000
P2DEL    EQU   @NM00030+0                                               00940000
P2JFCB   EQU   @NM00030+0                                               00941000
P2ACCT   EQU   @NM00030+0                                               00942000
         ORG   SDIOPARM+2                                               00943000
PARMKEY  DS    CL1                                                      00944000
PARMFDBK DS    CL1                                                      00945000
PARMRBA  DS    CL4                                                      00946000
PARMIOAD DS    CL4                                                      00947000
         ORG   IOPARML+12                                               00948000
PARMDDNM DS    CL8                                                      00949000
PARMLMCT DS    FL4                                                      00950000
PARMDCB  DS    AL4                                                      00951000
PARMRC1  DS    AL4                                                      00952000
         ORG   IOPARML+32                                               00953000
AUTOLIST DS    CL44                                                     00954000
         ORG   AUTOLIST                                                 00955000
ENQSL    DS    CL12                                                     00956000
ENQEL    DS    CL12                                                     00957000
DEQL     DS    CL12                                                     00958000
OPENL    DS    CL4                                                      00959000
CLOSEL   DS    CL4                                                      00960000
         ORG   AUTOLIST+44                                              00961000
DIRAREA  DS    CL129                                                    00962000
FLAGS    DS    BL1                                                      00963000
         ORG   FLAGS                                                    00964000
FUAOPEN  DS    BL1                                                      00965000
FBCOPEN  EQU   FLAGS+0                                                  00966000
FBADSYNC EQU   FLAGS+0                                                  00967000
EODFLG   EQU   FLAGS+0                                                  00968000
FRDUADS  EQU   FLAGS+0                                                  00969000
BRCDFULL EQU   FLAGS+0                                                  00970000
@NM00036 EQU   FLAGS+0                                                  00971000
@NM00037 EQU   FLAGS+0                                                  00972000
         ORG   FLAGS+1                                                  00973000
         DS    CL2                                                      00974000
MSGPARM  DS    CL36                                                     00975000
         ORG   MSGPARM                                                  00976000
MSGCSECT DS    AL4                                                      00977000
@NM00038 DS    AL4                                                      00978000
         ORG   @NM00038                                                 00979000
MSGSWS   DS    BL1                                                      00980000
         ORG   MSGSWS                                                   00981000
@NM00039 DS    BL1                                                      00982000
MSGREVER EQU   MSGSWS+0                                                 00983000
         ORG   MSGPARM+8                                                00984000
@NM00040 DS    CL16                                                     00985000
MSGINDX  DS    CL4                                                      00986000
MSGVAR   DS    AL4                                                      00987000
         ORG   MSGVAR+0                                                 00988000
MSGVARLN DS    BL1                                                      00989000
         ORG   MSGPARM+36                                               00990000
BCDDNM   DS    CL8                                                      00991000
IKJRBBCR CSECT                                                          00992000
         DS    0F                                                       00993000
@SIZDATD DC    AL1(1)                                                   00994000
         DC    AL3(@ENDDATD-@DATD)                                      00995000
@SIZ001  EQU   @SIZDATD                                                 00996000
@CV00288 DC    V(IKJEFA51)                                              00997000
@CV00289 DC    V(IEEVSDIO)                                              00998000
@CV00291 DC    V(IKJEFF02)                                              00999000
@CA00338 DC    A(IKJRBBCM)                                              01000000
         DS    0D                                                       01001000
F18F02   DC    VL4(IKJEFF02)                                            01002000
DIRYWAL  DC    AL2(344)                                                 01003000
F18CLNO  DC    AL2(1)                                                   01004000
BCDIRMAX DC    AL1(9)                                                   01005000
RNAME    DS    AL3                                                      01006000
@CC00362 DC    C'SYSLBC'                                                01007000
@CB00382 DC    X'FFFFFFFFFFFFFFFF'                                      01008000
DAIRCD08 DC    X'0008'                                                  01009000
DAIRDSN  DS    CL15                                                     01010000
         ORG   DAIRDSN                                                  01011000
DSLNGTH  DC    X'000D'                                                  01012000
DSNAME   DC    CL13'SYS1.BRODCAST'                                      01013000
         ORG   DAIRDSN+15                                               01014000
QNBCAST  DC    CL8'SYSIKJBC'                                            01015000
RNBCAST1 DC    X'000000'                                                01016000
QNUADS   DC    CL8'SYSIKJUA'                                            01017000
RNUADS   DC    CL8'OPENUADS'                                            01018000
SYNCID   DC    CL1'9'                                                   01019000
SDERR    DC    X'80'                                                    01020000
NOCORE   DC    X'40'                                                    01021000
RCREFORM DC    X'10'                                                    01022000
IOERR    DC    X'08'                                                    01023000
OPENERR  DC    X'02'                                                    01024000
DSFULL   DC    X'01'                                                    01025000
QNAME    DC    CL8'SYSIKJBC'                                            01026000
ZERENT   DC    X'00000000000000000000'                                  01027000
USDKEY   DC    X'01'                                                    01028000
MSGID51  DC    CL4'2051'                                                01029000
MSGID52  DC    CL4'2052'                                                01030000
MSGIDE1  DC    CL4'20E1'                                                01031000
MSGID40  DC    CL4'2040'                                                01032000
MSGIDC0  DC    CL4'20C0'                                                01033000
MSGIDD0  DC    CL4'20D0'                                                01034000
RNBCAST  DS    CL3                                                      01035000
@DATD    DSECT                                                          01036000
IKJRBBCR CSECT ,                       RESUME CSECT                     01037000
LISTBEG   ENQ   (QNAME,RNAME,S,3,SYSTEM),RET=HAVE,MF=L                  01038000
          ENQ   (QNAME,RNAME,E,3,SYSTEM),RET=HAVE,MF=L                  01039000
          DEQ   (QNAME,RNAME,3,SYSTEM),RET=HAVE,MF=L                    01040000
          OPEN  0,MF=L                                                  01041000
          CLOSE 0,MF=L                                                  01042000
LISTEND  EQU   *                   END OF LIST FORMS                    01043000
@DATD    DSECT                                                          01044000
         DCBD  DSORG=BS,DEVD=DA                                         01045000
IKJRBBCR CSECT ,                      RESUME CSECT                      01046000
UADSDCBS DCB   DDNAME=SYSUADS,                                         X01047000
               BLKSIZE=256,                                            X01048000
               DSORG=PS,                                               X01049000
               KEYLEN=0,                                               X01050000
               MACRF=(R),                                              X01051000
               RECFM=F                                                  01052000
@DATD    DSECT                                                          01053000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01054000
@ENDDATD EQU   *                                                        01055000
@DATEND  EQU   *                                                        01056000
IKJRBBCR CSECT                                                          01057000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01058000
@01      EQU   01                                                       01059000
@02      EQU   02                                                       01060000
@03      EQU   03                                                       01061000
@04      EQU   04                                                       01062000
@05      EQU   05                                                       01063000
@06      EQU   06                                                       01064000
@07      EQU   07                                                       01065000
@08      EQU   08                                                       01066000
@09      EQU   09                                                       01067000
@10      EQU   10                                                       01068000
@11      EQU   11                                                       01069000
@12      EQU   12                                                       01070000
@13      EQU   13                                                       01071000
@14      EQU   14                                                       01072000
@15      EQU   15                                                       01073000
@0       EQU   00                                                       01074000
@1       EQU   01                                                       01075000
@2       EQU   02                                                       01076000
@3       EQU   03                                                       01077000
@4       EQU   04                                                       01078000
@5       EQU   05                                                       01079000
@6       EQU   06                                                       01080000
@7       EQU   07                                                       01081000
@8       EQU   08                                                       01082000
@9       EQU   09                                                       01083000
@A       EQU   10                                                       01084000
@B       EQU   11                                                       01085000
@C       EQU   12                                                       01086000
@D       EQU   13                                                       01087000
@E       EQU   14                                                       01088000
@F       EQU   15                                                       01089000
R0       EQU   @00                                                      01090000
R1       EQU   @01                                                      01091000
R2       EQU   @02                                                      01092000
R15      EQU   @15                                                      01093000
UADCBPTR EQU   @04                                                      01094000
DCBPTR   EQU   @04                                                      01095000
R11      EQU   @11                                                      01096000
R12      EQU   @12                                                      01097000
R13      EQU   @13                                                      01098000
R14      EQU   @14                                                      01099000
R3       EQU   @03                                                      01100000
R4       EQU   @04                                                      01101000
         EXTRN IKJRBBCM                                                 01102000
ACCTCPPL EQU   0                                                        01103000
CPPLCBUF EQU   ACCTCPPL                                                 01104000
CPPLUPT  EQU   ACCTCPPL+4                                               01105000
CPPLPSCB EQU   ACCTCPPL+8                                               01106000
CPPLECT  EQU   ACCTCPPL+12                                              01107000
CPPLECB  EQU   ACCTCPPL+20                                              01108000
INDEX    EQU   0                                                        01109000
MEMENTRY EQU   0                                                        01110000
MEMNAME  EQU   MEMENTRY                                                 01111000
BLOKC    EQU   MEMENTRY+11                                              01112000
DAPL     EQU   0                                                        01113000
DAPLUPT  EQU   DAPL                                                     01114000
DAPLECT  EQU   DAPL+4                                                   01115000
DAPLECB  EQU   DAPL+8                                                   01116000
DAPLPSCB EQU   DAPL+12                                                  01117000
DAPLDAPB EQU   DAPL+16                                                  01118000
DAPB08   EQU   0                                                        01119000
DA08CD   EQU   DAPB08                                                   01120000
DA08FLG  EQU   DAPB08+2                                                 01121000
DA08PDSN EQU   DAPB08+8                                                 01122000
DA08DDN  EQU   DAPB08+12                                                01123000
DA08UNIT EQU   DAPB08+20                                                01124000
DA08SER  EQU   DAPB08+28                                                01125000
DA08MNM  EQU   DAPB08+52                                                01126000
DA08PSWD EQU   DAPB08+60                                                01127000
DA08DSP1 EQU   DAPB08+68                                                01128000
DA08SHR  EQU   DA08DSP1                                                 01129000
DA08DPS2 EQU   DAPB08+69                                                01130000
DA08KEEP EQU   DA08DPS2                                                 01131000
DA08DPS3 EQU   DAPB08+70                                                01132000
DA08KEP  EQU   DA08DPS3                                                 01133000
DA08CTL  EQU   DAPB08+71                                                01134000
ECT      EQU   0                                                        01135000
ECTSWS   EQU   ECT+28                                                   01136000
ECTBKGRD EQU   ECTSWS                                                   01137000
R1BC     EQU   0                                                        01138000
R1BCPTRP EQU   R1BC                                                     01139000
R1USPTRP EQU   R1BC+4                                                   01140000
R1USPTR  EQU   R1USPTRP+1                                               01141000
R1RECNUM EQU   R1BC+8                                                   01142000
USDIR    EQU   0                                                        01143000
USDENTRY EQU   USDIR                                                    01144000
USDID    EQU   USDENTRY                                                 01145000
USDREND  EQU   USDIR+125                                                01146000
USDNEXT  EQU   USDIR+126                                                01147000
IKJEFF18 EQU   0                                                        01148000
PARM     EQU   0                                                        01149000
DCBFLGS  EQU   DCBOFLGS                                                 01150000
DCBOFLG  EQU   DCBFLGS                                                  01151000
*                                      START UNREFERENCED COMPONENTS    01152000
@NM00035 EQU   DCBFLGS                                                  01153000
@NM00034 EQU   USDIR+117                                                01154000
USDEND   EQU   USDENTRY+10                                              01155000
USDRBA   EQU   USDENTRY+7                                               01156000
@NM00033 EQU   R1BC+45                                                  01157000
R1LEVEL  EQU   R1BC+38                                                  01158000
R1DSN    EQU   R1BC+14                                                  01159000
R1BCMAX  EQU   R1BC+12                                                  01160000
R1USFLGS EQU   R1USPTRP                                                 01161000
R1BCPTR  EQU   R1BCPTRP+1                                               01162000
R1BCFLGS EQU   R1BCPTRP                                                 01163000
ECTBKPB  EQU   ECT+36                                                   01164000
ECTUSER  EQU   ECT+32                                                   01165000
ECTDDNUM EQU   ECT+29                                                   01166000
@NM00032 EQU   ECTSWS                                                   01167000
ECTNNOT  EQU   ECTSWS                                                   01168000
ECTNMAL  EQU   ECTSWS                                                   01169000
ECTLOGF  EQU   ECTSWS                                                   01170000
ECTATRM  EQU   ECTSWS                                                   01171000
@NM00031 EQU   ECTSWS                                                   01172000
ECTNOPD  EQU   ECTSWS                                                   01173000
ECTSCMD  EQU   ECT+20                                                   01174000
ECTPCMD  EQU   ECT+12                                                   01175000
ECTSMSG  EQU   ECT+9                                                    01176000
ECTMSGF  EQU   ECT+8                                                    01177000
ECTIOWA  EQU   ECT+4                                                    01178000
ECTRTCD  EQU   ECT+1                                                    01179000
ECTRCDF  EQU   ECT                                                      01180000
DA08ALN  EQU   DAPB08+76                                                01181000
DA08DSO  EQU   DAPB08+75                                                01182000
@NM00028 EQU   DAPB08+72                                                01183000
@NM00027 EQU   DA08CTL                                                  01184000
DA08ATRL EQU   DA08CTL                                                  01185000
DA08DMMY EQU   DA08CTL                                                  01186000
DA08PERM EQU   DA08CTL                                                  01187000
DA08RLSE EQU   DA08CTL                                                  01188000
DA08UID  EQU   DA08CTL                                                  01189000
DA08ABKL EQU   DA08CTL                                                  01190000
DA08TRKS EQU   DA08CTL                                                  01191000
DA08UNCT EQU   DA08DPS3                                                 01192000
DA08CATL EQU   DA08DPS3                                                 01193000
DA08DELE EQU   DA08DPS3                                                 01194000
@NM00026 EQU   DA08DPS3                                                 01195000
@NM00025 EQU   DA08DPS3                                                 01196000
@NM00024 EQU   DA08DPS3                                                 01197000
@NM00023 EQU   DA08DPS3                                                 01198000
DA08UCAT EQU   DA08DPS2                                                 01199000
DA08CAT  EQU   DA08DPS2                                                 01200000
DA08DEL  EQU   DA08DPS2                                                 01201000
@NM00022 EQU   DA08DPS2                                                 01202000
@NM00021 EQU   DA08DPS2                                                 01203000
@NM00020 EQU   DA08DPS2                                                 01204000
@NM00019 EQU   DA08DPS2                                                 01205000
DA08OLD  EQU   DA08DSP1                                                 01206000
DA08MOD  EQU   DA08DSP1                                                 01207000
DA08NEW  EQU   DA08DSP1                                                 01208000
@NM00018 EQU   DA08DSP1                                                 01209000
@NM00017 EQU   DA08DSP1                                                 01210000
@NM00016 EQU   DA08DSP1                                                 01211000
@NM00015 EQU   DA08DSP1                                                 01212000
DA08DQTY EQU   DAPB08+48                                                01213000
DA08SQTY EQU   DAPB08+44                                                01214000
DA08PQTY EQU   DAPB08+40                                                01215000
DA08BLK  EQU   DAPB08+36                                                01216000
DA08CTRC EQU   DAPB08+6                                                 01217000
DA08DARC EQU   DAPB08+4                                                 01218000
@NM00014 EQU   DA08FLG                                                  01219000
@NM00013 EQU   DA08FLG                                                  01220000
@NM00012 EQU   DA08FLG                                                  01221000
@NM00011 EQU   DA08FLG                                                  01222000
@NM00010 EQU   DA08FLG                                                  01223000
@NM00009 EQU   DA08FLG                                                  01224000
@NM00008 EQU   DA08FLG                                                  01225000
DA08FPE  EQU   DA08FLG                                                  01226000
BLOKTTR  EQU   MEMENTRY+8                                               01227000
UIDLPTRP EQU   ACCTCPPL+16                                              01228000
*                                      END UNREFERENCED COMPONENTS      01229000
@RC00103 EQU   @RC00100                                                 01230000
@RC00126 EQU   @EL00001                                                 01231000
@RF00126 EQU   @EL00001                                                 01232000
@RC00149 EQU   @EL00003                                                 01233000
@RC00199 EQU   @EL00004                                                 01234000
@RC00211 EQU   @EL00004                                                 01235000
@RC00230 EQU   @EL00005                                                 01236000
@RT00284 EQU   WRITBC                                                   01237000
@RF00284 EQU   RDUADS                                                   01238000
@RT00290 EQU   WRITBC                                                   01239000
@RF00290 EQU   LNGFNDR                                                  01240000
@RT00320 EQU   RDUADS                                                   01241000
@RF00320 EQU   LNGFNDR                                                  01242000
@RC00307 EQU   @EL00006                                                 01243000
FORMEND  EQU   @EL00006                                                 01244000
@PB00006 EQU   @PB00007                                                 01245000
@RC00106 EQU   @RC00103                                                 01246000
@RC00172 EQU   @RC00149                                                 01247000
@PB00005 EQU   @PB00006                                                 01248000
@RC00310 EQU   @RC00307                                                 01249000
@RC00109 EQU   @RC00106                                                 01250000
@PB00004 EQU   @PB00005                                                 01251000
@PB00003 EQU   @PB00004                                                 01252000
@PB00002 EQU   @PB00003                                                 01253000
@EL01    EQU   @EL00001                                                 01254000
@ENDDATA EQU   *                                                        01255000
         END   IKJRBBCR                                                 01256000
