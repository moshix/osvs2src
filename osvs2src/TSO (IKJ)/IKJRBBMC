         TITLE 'IKJRBBMC,  DATASET I/O ROUTINE                         *00001000
                        '                                               00002000
IKJRBBMC CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKJRBBMC  78.173'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(16),0(@01)                                 0001 00022000
*                                                                  0022 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* START EXECUTABLE CODE                                         */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0022 00029000
*   SWS=''B;                        /* CLEAR ALL SWITCHES            */ 00030000
         MVI   SWS,X'00'                                           0022 00031000
*   FIRST=YES;                      /* SET FIRST SWITCH              */ 00032000
         OI    FIRST,B'01000000'                                   0023 00033000
*   CALL FINDDCB;                   /* FIND APPROPRIATE DCB          */ 00034000
         BAL   @14,FINDDCB                                         0024 00035000
*   IF ERROR=NO THEN                /* IF OK SO FAR                  */ 00036000
         TM    ERROR,B'10000000'                                   0025 00037000
         BNZ   @RF00025                                            0025 00038000
*     IF FUNC=0 THEN                /* IF GET FUNCTION THEN CALL     */ 00039000
         L     @10,@PC00001+12                                     0026 00040000
         L     @10,FUNC(,@10)                                      0026 00041000
         LTR   @10,@10                                             0026 00042000
         BNZ   @RF00026                                            0026 00043000
*       CALL GETRTN;                /* GET ROUTINE                   */ 00044000
         BAL   @14,GETRTN                                          0027 00045000
*     ELSE                          /* OTHERWISE CALL PUTRTN         */ 00046000
*       CALL PUTRTN;                /*                               */ 00047000
         B     @RC00026                                            0028 00048000
@RF00026 BAL   @14,PUTRTN                                          0028 00049000
*   ELSE                            /* OTHERWISE                     */ 00050000
*     DO;                           /*                               */ 00051000
         B     @RC00025                                            0029 00052000
@RF00025 DS    0H                                                  0030 00053000
*       CALL IKJEFT30(0,ECTX,0,STCKL);/* DELETE TOP ELEMENT RELIES ON   00054000
*                                      T30 NOT CHECKING UPT OR ECB   */ 00055000
         MVC   @AL00001(16),@AL00030                               0030 00056000
         L     @10,@PC00001+8                                      0030 00057000
         ST    @10,@AL00001+4                                      0030 00058000
         L     @15,@CV00517                                        0030 00059000
         LA    @01,@AL00001                                        0030 00060000
         BALR  @14,@15                                             0030 00061000
*       RETCODE=4;                  /* FAKE END OF FILE RETURN CODE  */ 00062000
         LA    RETCODE,4                                           0031 00063000
*     END;                                                         0032 00064000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER              */ 00065000
@RC00025 L     @13,4(,@13)                                         0033 00066000
         L     @00,@SIZDATD                                        0033 00067000
         LR    @01,@11                                             0033 00068000
         FREEMAIN R,LV=(0),A=(1)                                        00069000
         LR    @15,@08                                             0033 00070000
         L     @14,12(,@13)                                        0033 00071000
         LM    @00,@12,20(@13)                                     0033 00072000
         BR    @14                                                 0033 00073000
*                                                                  0034 00074000
*   /*****************************************************************/ 00075000
*   /*                                                               */ 00076000
*   /* FINDDCB: THIS ROUTINE IS USED TO FIND THE DCB THAT WILL BE    */ 00077000
*   /* USED FOR THIS ENTRY TO IKJRBBMC. THIS ROUTINE ASSUMES THAT IF */ 00078000
*   /* A DCBPRESENT BIT IS ON IN THE TOP ELEMENT IF THE STACK, THAT A*/ 00079000
*   /* DCB IS PRESENT THERE OR ON THE BOTTOM OF THE STACK. THE FINDCB*/ 00080000
*   /* ROUTINE SETS OPENADR WHICK IS THE BASE FOR THE DCBD           */ 00081000
*   /*                                                               */ 00082000
*   /*****************************************************************/ 00083000
*                                                                  0034 00084000
*FINDDCB:                                                          0034 00085000
*   PROC OPTIONS(NOSAVE(OPENADR));                                 0034 00086000
@EL00001 L     @13,4(,@13)                                         0034 00087000
@EF00001 L     @00,@SIZDATD                                        0034 00088000
         LR    @01,@11                                             0034 00089000
         FREEMAIN R,LV=(0),A=(1)                                        00090000
@ER00001 LM    @14,@12,12(@13)                                     0034 00091000
         BR    @14                                                 0034 00092000
FINDDCB  STM   @14,@01,12(@13)                                     0034 00093000
         STM   @03,@06,32(@13)                                     0034 00094000
         STM   @08,@12,52(@13)                                     0034 00095000
*   IODSDPTR=INSADLSD;              /* POINT TO CURRENT IODSD        */ 00096000
         L     @10,@PC00001+8                                      0035 00097000
         L     @10,IOSRLPTR(,@10)                                  0035 00098000
         L     @10,IOSTELM(,@10)                                   0035 00099000
         L     IODSDPTR,INSADLSD-1(,@10)                           0035 00100000
         LA    IODSDPTR,0(,IODSDPTR)                               0035 00101000
*   IF FUNC=0 THEN                  /* IF FUNCTION IS GET, GET THE   */ 00102000
         SLR   @06,@06                                             0036 00103000
         L     @03,@PC00001+12                                     0036 00104000
         C     @06,FUNC(,@03)                                      0036 00105000
         BNE   @RF00036                                            0036 00106000
*     DO;                           /* INPUT DCB                     */ 00107000
*       IF IODSDPTR=0|INSDATA=NO|   /* IF TMPS IODSD                 */ 00108000
*           DSDOPTS(3)=NO THEN      /* IF ORIGINAL INDCB THEN USE    */ 00109000
         CR    IODSDPTR,@06                                        0038 00110000
         BE    @RT00038                                            0038 00111000
         TM    INSDATA(@10),B'10000000'                            0038 00112000
         BZ    @RT00038                                            0038 00113000
         TM    DSDOPTS(IODSDPTR),B'00100000'                       0038 00114000
         BNZ   @RF00038                                            0038 00115000
@RT00038 DS    0H                                                  0039 00116000
*         DO;                       /* ELEMENT HAS THE DCB           */ 00117000
*           RFY                                                    0040 00118000
*             INSTACK BASED(IOSBELM);/* SET BASE TO BOTTOM           */ 00119000
*           IODSDPTR=INSADLSD;      /* BOTTOM ELEMENTS IODSD         */ 00120000
         L     @10,@PC00001+8                                      0041 00121000
         L     @10,IOSRLPTR(,@10)                                  0041 00122000
         L     @10,IOSBELM(,@10)                                   0041 00123000
         L     IODSDPTR,INSADLSD-1(,@10)                           0041 00124000
         LA    IODSDPTR,0(,IODSDPTR)                               0041 00125000
*           RFY                                                    0042 00126000
*             INSTACK BASED(IOSTELM);/* RESET BASE FOR STACK         */ 00127000
*         END;                                                     0043 00128000
*       IF DSDQSAM=YES THEN         /* IF USING QSAM DCB             */ 00129000
@RF00038 TM    DSDQSAM(IODSDPTR),B'00100000'                       0044 00130000
         BNO   @RF00044                                            0044 00131000
*         OPENADR=ADDR(INDCB);      /* USE QSAM DCB                  */ 00132000
         LA    OPENADR,16                                          0045 00133000
         ALR   OPENADR,IODSDPTR                                    0045 00134000
*       ELSE                        /* OTHERWISE                     */ 00135000
*         OPENADR=ADDR(BPAMDCB);    /* USE BPAM DCB                  */ 00136000
         B     @RC00044                                            0046 00137000
@RF00044 L     OPENADR,DSDBPAM(,IODSDPTR)                          0046 00138000
         LA    OPENADR,BPAMDCB(,OPENADR)                           0046 00139000
*     END;                          /*                               */ 00140000
*   ELSE                            /* IF NOT GET FUNCTION, ASSUME   */ 00141000
*     DO;                           /* PUT FUNCTION                  */ 00142000
         B     @RC00036                                            0048 00143000
@RF00036 DS    0H                                                  0049 00144000
*       IF IODSDPTR=0|INSDATA=NO|   /* IF TMPS IODSD                 */ 00145000
*           DSDOPTS(4)=NO THEN      /*                               */ 00146000
         LTR   IODSDPTR,IODSDPTR                                   0049 00147000
         BZ    @RT00049                                            0049 00148000
         L     @10,@PC00001+8                                      0049 00149000
         L     @10,IOSRLPTR(,@10)                                  0049 00150000
         L     @10,IOSTELM(,@10)                                   0049 00151000
         TM    INSDATA(@10),B'10000000'                            0049 00152000
         BZ    @RT00049                                            0049 00153000
         TM    DSDOPTS(IODSDPTR),B'00010000'                       0049 00154000
         BNZ   @RF00049                                            0049 00155000
@RT00049 DS    0H                                                  0050 00156000
*         DO;                       /* ELEMENT HAS THE DCB           */ 00157000
*           RFY                                                    0051 00158000
*             INSTACK BASED(IOSBELM);/* SET BASE TO BOTTOM           */ 00159000
*           IODSDPTR=INSADLSD;      /* SET IODSD ADDR                */ 00160000
         L     @10,@PC00001+8                                      0052 00161000
         L     @10,IOSRLPTR(,@10)                                  0052 00162000
         L     @10,IOSBELM(,@10)                                   0052 00163000
         L     IODSDPTR,INSADLSD-1(,@10)                           0052 00164000
         LA    IODSDPTR,0(,IODSDPTR)                               0052 00165000
*           RFY                                                    0053 00166000
*             INSTACK BASED(IOSTELM);/* RESET BASED FOR STACK        */ 00167000
*         END;                      /*                               */ 00168000
*       OPENADR=ADDR(OTDCB);        /* ADDR OF OUTPUT DCB            */ 00169000
@RF00049 L     @10,@CA00148                                        0055 00170000
         LR    OPENADR,IODSDPTR                                    0055 00171000
         AL    OPENADR,INLEN-INLEN(,@10)                           0055 00172000
         AL    OPENADR,@CF00198                                    0055 00173000
*     END;                          /*                               */ 00174000
*   IF DCBOFOPN=NO THEN             /* IF DCB IS NOT OPEN            */ 00175000
@RC00036 TM    DCBOFOPN+40(OPENADR),B'00010000'                    0057 00176000
         BNZ   @RF00057                                            0057 00177000
*     ERROR=YES;                    /* NO DICE - DON''T ALLOW        */ 00178000
         OI    ERROR,B'10000000'                                   0058 00179000
*   END FINDDCB;                    /*                               */ 00180000
@EL00002 DS    0H                                                  0059 00181000
@EF00002 DS    0H                                                  0059 00182000
@ER00002 LM    @14,@01,12(@13)                                     0059 00183000
         LM    @03,@06,32(@13)                                     0059 00184000
         LM    @08,@12,52(@13)                                     0059 00185000
         BR    @14                                                 0059 00186000
*                                                                  0060 00187000
*   /*****************************************************************/ 00188000
*   /*                                                               */ 00189000
*   /* GETRTN: THE GETRTN GETS THE INPUT LINE FROM THE DATASET AND   */ 00190000
*   /* SCANS BACK TO FIRST NONBLANK. RECFM VXX RECORDS ARE SCANNED   */ 00191000
*   /* EVEN THOUGH THERE ARE NO TRAILING BLANKS IN MOST CASES TO     */ 00192000
*   /* PROVIDE FIX FOR APAR OZ10464                          @ZA10464*/ 00193000
*   /*                                                               */ 00194000
*   /*****************************************************************/ 00195000
*                                                                  0060 00196000
*GETRTN:                                                           0060 00197000
*   PROC;                           /* GETALINE ROUTINE              */ 00198000
GETRTN   STM   @14,@07,@SA00003                                    0060 00199000
         STM   @09,@12,@SA00003+40                                 0060 00200000
*   RETCODE=4;                      /* SET RETCODE TO EOF            */ 00201000
         LA    RETCODE,4                                           0061 00202000
*   DCBEODA=ADDR(EOF);              /* SET EOF RETURN POINT          */ 00203000
         LA    @10,EOF                                             0062 00204000
         STCM  @10,7,DCBEODA+28(OPENADR)                           0062 00205000
*   RFY                                                            0063 00206000
*    (R1) RSTD;                     /* RESTRICT REG 1                */ 00207000
*   IF DSDQSAM=YES THEN             /* IF MEMBER PROCESSING NOT USED */ 00208000
         TM    DSDQSAM(IODSDPTR),B'00100000'                       0064 00209000
         BNO   @RF00064                                            0064 00210000
*     GEN REFS(OPENADR) FLOWS(EOF)(GET  (OPENADR));/* GET A LINE     */ 00211000
         GET  (OPENADR)                                                 00212000
*   ELSE                            /* IF NOT USING QSAM, GET REC    */ 00213000
*     DO;                           /* FROM BPAM BUFFER              */ 00214000
         B     @RC00064                                            0066 00215000
@RF00064 DS    0H                                                  0067 00216000
*       IF DSDFRST=YES THEN         /* IF FIRST CHECK NOT DONE       */ 00217000
         TM    DSDFRST(IODSDPTR),B'00010000'                       0067 00218000
         BNO   @RF00067                                            0067 00219000
*         DO;                       /* CHECK FIRST READ              */ 00220000
*           DSDFRST=NO;             /* RESET FIRST CHECK SWITCH      */ 00221000
         NI    DSDFRST(IODSDPTR),B'11101111'                       0069 00222000
*           RFY                                                    0070 00223000
*            (R4) RSTD;             /* RESTRICT REG                  */ 00224000
*           R4=ADDR(CURDECB(1));    /* POINT TO FIRST DECB           */ 00225000
         L     R4,DSDBPAM(,IODSDPTR)                               0071 00226000
         LA    R4,CURDECB(,R4)                                     0071 00227000
*           GEN REFS(R4) FLOWS(EOF)(CHECK (R4));/* CHECK FIRST READ  */ 00228000
         CHECK (R4)                                                     00229000
*           NEXTREC=CURBLK(1);      /* POINT TO FIRST BLOCK          */ 00230000
         L     @10,DSDBPAM(,IODSDPTR)                              0073 00231000
         L     @09,CURBLK(,@10)                                    0073 00232000
         ST    @09,NEXTREC(,@10)                                   0073 00233000
*           DECBINDX=1;             /* POINT TO FIRST DECB           */ 00234000
         MVC   DECBINDX(2,@10),@CH00036                            0074 00235000
*           IF DCBRECL=V THEN       /* FOR VARIABLE LENGTH   @ZA03285*/ 00236000
         TM    DCBRECL+28(OPENADR),B'01000000'                     0075 00237000
         BNO   @RF00075                                            0075 00238000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0075 00239000
         BNZ   @RF00075                                            0075 00240000
*             DO;                   /* RECORDS               @ZA03285*/ 00241000
*               EOBLK=NEXTREC+NEXTREC->LL;/* CALC END OF BUFR@ZA03285*/ 00242000
         ICM   @06,12,LL(@09)                                      0077 00243000
         SRA   @06,16                                              0077 00244000
         ALR   @06,@09                                             0077 00245000
         ST    @06,EOBLK(,@10)                                     0077 00246000
*               NEXTREC=NEXTREC+4;  /* BYPASS BLOCK LENGTH   @ZA03285*/ 00247000
         AL    @09,@CF00117                                        0078 00248000
         ST    @09,NEXTREC(,@10)                                   0078 00249000
*             END;                  /*                       @ZA03285*/ 00250000
*           ELSE                    /* FOR FIXED LENGTH RECS @ZA03285*/ 00251000
*             EOBLK=NEXTREC-RESIDCNT+DCBBLKSI;/* CALC EOB    @ZA03285*/ 00252000
         B     @RC00075                                            0080 00253000
@RF00075 L     @10,DSDBPAM(,IODSDPTR)                              0080 00254000
         LH    @09,DECBINDX(,@10)                                  0080 00255000
         MH    @09,@CH00133                                        0080 00256000
         ALR   @09,@10                                             0080 00257000
         ICM   @06,15,IOBPTR-20(@09)                               0080 00258000
         L     @09,NEXTREC(,@10)                                   0080 00259000
         SH    @09,RESIDCNT(,@06)                                  0080 00260000
         AH    @09,DCBBLKSI+52(,OPENADR)                           0080 00261000
         ST    @09,EOBLK(,@10)                                     0080 00262000
*         END;                                                     0081 00263000
@RC00075 DS    0H                                                  0082 00264000
*       IF NEXTREC>=EOBLK THEN      /* IF AT END OF BLOCK            */ 00265000
@RF00067 L     @10,DSDBPAM(,IODSDPTR)                              0082 00266000
         CLC   NEXTREC(4,@10),EOBLK(@10)                           0082 00267000
         BL    @RF00082                                            0082 00268000
*         DO;                       /*                               */ 00269000
*           RFY                                                    0084 00270000
*            (R4,                                                  0084 00271000
*             R5) RSTD;             /* RESTRICT REG 5                */ 00272000
*           R5=CURBLK(DECBINDX);    /* SAVE USED BUFFER ADDR         */ 00273000
         LH    @09,DECBINDX(,@10)                                  0085 00274000
         LR    @06,@09                                             0085 00275000
         SLA   @06,2                                               0085 00276000
         L     R5,CURBLK-4(@06,@10)                                0085 00277000
*           R4=ADDR(CURDECB(DECBINDX));/* GET USED DECB              */ 00278000
         MH    @09,@CH00133                                        0086 00279000
         LA    R4,CURDECB-20(@09,@10)                              0086 00280000
*           GEN REFS(OPENADR,R4,R5)(READ (R4),SF,(OPENADR),(R5),MF=E);  00281000
         READ (R4),SF,(OPENADR),(R5),MF=E                               00282000
*           IF DECBINDX=DECBMAX THEN/* IF ALL USED, GO BACK TO       */ 00283000
         L     @10,DSDBPAM(,IODSDPTR)                              0088 00284000
         CLC   DECBINDX(2,@10),DECBMAX(@10)                        0088 00285000
         BNE   @RF00088                                            0088 00286000
*             DECBINDX=1;           /* FIRST DECB                    */ 00287000
         MVC   DECBINDX(2,@10),@CH00036                            0089 00288000
*           ELSE                    /* OTHERWISE                     */ 00289000
*             DECBINDX=DECBINDX+1;  /* GO TO NEXT DECB               */ 00290000
         B     @RC00088                                            0090 00291000
@RF00088 L     @10,DSDBPAM(,IODSDPTR)                              0090 00292000
         LA    @09,1                                               0090 00293000
         AH    @09,DECBINDX(,@10)                                  0090 00294000
         STH   @09,DECBINDX(,@10)                                  0090 00295000
*           R4=ADDR(CURDECB(DECBINDX));/* GET NEW CURRENT DECB       */ 00296000
@RC00088 L     @10,DSDBPAM(,IODSDPTR)                              0091 00297000
         LH    @09,DECBINDX(,@10)                                  0091 00298000
         MH    @09,@CH00133                                        0091 00299000
         LA    R4,CURDECB-20(@09,@10)                              0091 00300000
*           GEN REFS(R4) FLOWS(EOF)(CHECK (R4));/* CHECK READ        */ 00301000
         CHECK (R4)                                                     00302000
*           RFY                                                    0093 00303000
*            (R4,                                                  0093 00304000
*             R5) UNRSTD;           /* RELEASE REGS                  */ 00305000
*           NEXTREC=CURBLK(DECBINDX);/* SET FIRST REC                */ 00306000
         L     @10,DSDBPAM(,IODSDPTR)                              0094 00307000
         LH    @06,DECBINDX(,@10)                                  0094 00308000
         SLA   @06,2                                               0094 00309000
         L     @06,CURBLK-4(@06,@10)                               0094 00310000
         ST    @06,NEXTREC(,@10)                                   0094 00311000
*           IF DCBRECL=V THEN       /* FOR VARIABLE LENGTH   @ZA03285*/ 00312000
         TM    DCBRECL+28(OPENADR),B'01000000'                     0095 00313000
         BNO   @RF00095                                            0095 00314000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0095 00315000
         BNZ   @RF00095                                            0095 00316000
*             DO;                   /* RECORDS               @ZA03285*/ 00317000
*               EOBLK=NEXTREC+NEXTREC->LL;/* CALC END OF BUFR@ZA03285*/ 00318000
         ICM   @03,12,LL(@06)                                      0097 00319000
         SRA   @03,16                                              0097 00320000
         ALR   @03,@06                                             0097 00321000
         ST    @03,EOBLK(,@10)                                     0097 00322000
*               NEXTREC=NEXTREC+4;  /* BYPASS BLOCK LENGTH   @ZA03285*/ 00323000
         AL    @06,@CF00117                                        0098 00324000
         ST    @06,NEXTREC(,@10)                                   0098 00325000
*             END;                  /*                       @ZA03285*/ 00326000
*           ELSE                    /* FOR FIXED LENGTH RECS @ZA03285*/ 00327000
*             EOBLK=NEXTREC-RESIDCNT+DCBBLKSI;/* CALC EOB    @ZA03285*/ 00328000
         B     @RC00095                                            0100 00329000
@RF00095 L     @10,DSDBPAM(,IODSDPTR)                              0100 00330000
         LH    @06,DECBINDX(,@10)                                  0100 00331000
         MH    @06,@CH00133                                        0100 00332000
         ALR   @06,@10                                             0100 00333000
         ICM   @03,15,IOBPTR-20(@06)                               0100 00334000
         L     @06,NEXTREC(,@10)                                   0100 00335000
         SH    @06,RESIDCNT(,@03)                                  0100 00336000
         AH    @06,DCBBLKSI+52(,OPENADR)                           0100 00337000
         ST    @06,EOBLK(,@10)                                     0100 00338000
*         END;                                                     0101 00339000
@RC00095 DS    0H                                                  0102 00340000
*       R1=NEXTREC;                                                0102 00341000
@RF00082 L     @10,DSDBPAM(,IODSDPTR)                              0102 00342000
         L     @06,NEXTREC(,@10)                                   0102 00343000
         LR    R1,@06                                              0102 00344000
*       IF DCBRECL=V THEN           /* FOR VARIABLE RECORDS          */ 00345000
         TM    DCBRECL+28(OPENADR),B'01000000'                     0103 00346000
         BNO   @RF00103                                            0103 00347000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0103 00348000
         BNZ   @RF00103                                            0103 00349000
*         DO;                       /*                               */ 00350000
*           NEXTREC=NEXTREC+R1->LL; /*                               */ 00351000
         ICM   @03,12,LL(R1)                                       0105 00352000
         SRA   @03,16                                              0105 00353000
         ALR   @06,@03                                             0105 00354000
         ST    @06,NEXTREC(,@10)                                   0105 00355000
*           DCBLRECL=R1->LL;        /* SET DCBLRECL FOR RECORD       */ 00356000
         STH   @03,DCBLRECL+72(,OPENADR)                           0106 00357000
*         END;                      /*                               */ 00358000
*       ELSE                        /* FOR OTHER                     */ 00359000
*         NEXTREC=NEXTREC+DCBLRECL; /*                               */ 00360000
         B     @RC00103                                            0108 00361000
@RF00103 L     @10,DSDBPAM(,IODSDPTR)                              0108 00362000
         LH    @06,DCBLRECL+72(,OPENADR)                           0108 00363000
         AL    @06,NEXTREC(,@10)                                   0108 00364000
         ST    @06,NEXTREC(,@10)                                   0108 00365000
*     END;                                                         0109 00366000
@RC00103 DS    0H                                                  0110 00367000
*   RETCODE=0;                      /* SET NORMAL RETCODE            */ 00368000
@RC00064 SLR   RETCODE,RETCODE                                     0110 00369000
*   PTRA=R1;                        /* SET BASE OF I/O BFRS          */ 00370000
         LR    PTRA,R1                                             0111 00371000
*   RFY                                                            0112 00372000
*    (R1) UNRSTD;                   /* RELEASE REGISTER ONE          */ 00373000
*   IF DCBRECL=V THEN               /* IF RECFM=F X X                */ 00374000
         LA    @10,28                                              0113 00375000
         ALR   @10,OPENADR                                         0113 00376000
         TM    DCBRECL(@10),B'01000000'                            0113 00377000
         BNO   @RF00113                                            0113 00378000
         TM    DCBRECL(@10),B'10000000'                            0113 00379000
         BNZ   @RF00113                                            0113 00380000
*     DO;                           /* LOGICALLY REMOVE SEQ NO       */ 00381000
*       IF DCBRECCC=A&DSDCNTL=NO THEN/* ALSO BYPASS C/C CHAR         */ 00382000
         TM    DCBRECCC(@10),B'00000100'                           0115 00383000
         BNO   @RF00115                                            0115 00384000
         TM    DCBRECCC(@10),B'00000010'                           0115 00385000
         BNZ   @RF00115                                            0115 00386000
         TM    DSDCNTL(IODSDPTR),B'01000000'                       0115 00387000
         BNZ   @RF00115                                            0115 00388000
*         MOVED=9;                  /* BYPASS C/C AND SEQ NO         */ 00389000
         LA    MOVED,9                                             0116 00390000
*       ELSE                        /* ONLY BYPASS SEQ NO            */ 00391000
*         MOVED=8;                  /*                               */ 00392000
         B     @RC00115                                            0117 00393000
@RF00115 LA    MOVED,8                                             0117 00394000
*       IF DCBLRECL-MOVED<=4|       /* IF A RECORD THAT IS LESS THAN */ 00395000
*           DSDSEQ=YES THEN         /* 8 DATA CHARS OR SEQ NUMBERS   */ 00396000
@RC00115 LH    @10,DCBLRECL+72(,OPENADR)                           0118 00397000
         SLR   @10,MOVED                                           0118 00398000
         C     @10,@CF00117                                        0118 00399000
         BNH   @RT00118                                            0118 00400000
         TM    DSDSEQ(IODSDPTR),B'10000000'                        0118 00401000
         BNO   @RF00118                                            0118 00402000
@RT00118 DS    0H                                                  0119 00403000
*         MOVED=MOVED-8;            /* REQUIRED,DONT STRIP SEQ     0119 00404000
*                                      NUMBERS                       */ 00405000
         SL    MOVED,@CF00063                                      0119 00406000
*       LEN=MAX(0,((MIN(DSDMINBF,DCBLRECL))-(MOVED+4)));/* LEN FOR   */ 00407000
@RF00118 L     @10,@PC00001+4                                      0120 00408000
         LH    @09,DSDMINBF(,IODSDPTR)                             0120 00409000
         LH    @06,DCBLRECL+72(,OPENADR)                           0120 00410000
         CR    @09,@06                                             0120 00411000
         BNH   *+6                                                      00412000
         LR    @09,@06                                             0120 00413000
         LA    @06,4                                               0120 00414000
         ALR   @06,MOVED                                           0120 00415000
         SLR   @09,@06                                             0120 00416000
         SLR   @06,@06                                             0120 00417000
         CR    @09,@06                                             0120 00418000
         BNL   *+6                                                      00419000
         LR    @09,@06                                             0120 00420000
         ST    @09,LEN(,@10)                                       0120 00421000
*       DO LEN=LEN TO 1 BY-1 WHILE BFRVA(LEN)=' ';/* SCAN    @ZA10464*/ 00422000
         B     @DE00121                                            0121 00423000
@DL00121 L     @10,@PC00001+4                                      0121 00424000
         L     @10,LEN(,@10)                                       0121 00425000
         LR    @09,PTRA                                            0121 00426000
         ALR   @09,MOVED                                           0121 00427000
         ALR   @09,@10                                             0121 00428000
         CLI   BFRVA-1(@09),C' '                                   0121 00429000
         BNE   @DC00121                                            0121 00430000
*       END;                        /* OFF TRAILING BLANKS   @ZA10464*/ 00431000
         L     @10,@PC00001+4                                      0122 00432000
         SLR   @09,@09                                             0122 00433000
         BCTR  @09,0                                               0122 00434000
         AL    @09,LEN(,@10)                                       0122 00435000
         L     @10,@PC00001+4                                      0122 00436000
         ST    @09,LEN(,@10)                                       0122 00437000
@DE00121 LTR   @09,@09                                             0122 00438000
         BP    @DL00121                                            0122 00439000
@DC00121 DS    0H                                                  0123 00440000
*       CALL MOVE(BFRVA,OUTBUF,LEN,LEN);/* COPY BUFFER               */ 00441000
         LR    @10,PTRA                                            0123 00442000
         ALR   @10,MOVED                                           0123 00443000
         LA    @10,BFRVA(,@10)                                     0123 00444000
         ST    @10,@AL00001                                        0123 00445000
         L     @10,@PC00001                                        0123 00446000
         BCTR  @10,0                                               0123 00447000
         L     @10,BFRA(,@10)                                      0123 00448000
         LA    @10,0(,@10)                                         0123 00449000
         ST    @10,@AL00001+4                                      0123 00450000
         L     @10,@PC00001+4                                      0123 00451000
         ST    @10,@AL00001+8                                      0123 00452000
         ST    @10,@AL00001+12                                     0123 00453000
         LA    @01,@AL00001                                        0123 00454000
         BAL   @14,MOVE                                            0123 00455000
*     END;                          /* END RECFM=V X X PROCESS       */ 00456000
*   ELSE                            /* IF RECFM=F OR RECFM= U        */ 00457000
*     DO;                           /* REMOVE SEQ NO FROM RIGHT      */ 00458000
         B     @RC00113                                            0125 00459000
@RF00113 DS    0H                                                  0126 00460000
*       IF DCBRECL=F&DCBLRECL>8&DSDSEQ=NO THEN/* FIXED OF SUFFIC-    */ 00461000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0126 00462000
         BNO   @RF00126                                            0126 00463000
         TM    DCBRECL+28(OPENADR),B'01000000'                     0126 00464000
         BNZ   @RF00126                                            0126 00465000
         LA    @10,8                                               0126 00466000
         LH    @09,DCBLRECL+72(,OPENADR)                           0126 00467000
         CR    @09,@10                                             0126 00468000
         BNH   @RF00126                                            0126 00469000
         TM    DSDSEQ(IODSDPTR),B'10000000'                        0126 00470000
         BNZ   @RF00126                                            0126 00471000
*         LEN=DCBLRECL-8;           /* IENT LENGTH, STRIP SEQ NUMBERS*/ 00472000
         L     @06,@PC00001+4                                      0127 00473000
         SLR   @09,@10                                             0127 00474000
         ST    @09,LEN(,@06)                                       0127 00475000
*       ELSE                        /* FOR ALL OTHERS, DO NO         */ 00476000
*         LEN=DCBLRECL;             /* SET RECORD LENGTH             */ 00477000
         B     @RC00126                                            0128 00478000
@RF00126 L     @10,@PC00001+4                                      0128 00479000
         LH    @09,DCBLRECL+72(,OPENADR)                           0128 00480000
         ST    @09,LEN(,@10)                                       0128 00481000
*       IF DCBRECCC=A&DSDCNTL=NO THEN/* IF CARRIAGE CNTL TO BE     0129 00482000
*                                      STRIPPED                      */ 00483000
@RC00126 TM    DCBRECCC+28(OPENADR),B'00000100'                    0129 00484000
         BNO   @RF00129                                            0129 00485000
         TM    DCBRECCC+28(OPENADR),B'00000010'                    0129 00486000
         BNZ   @RF00129                                            0129 00487000
         TM    DSDCNTL(IODSDPTR),B'01000000'                       0129 00488000
         BNZ   @RF00129                                            0129 00489000
*         DO;                       /* SET MOVED                     */ 00490000
*           LEN=LEN-1;              /* DECREMENT LEN RETURNED        */ 00491000
         L     @10,@PC00001+4                                      0131 00492000
         L     @09,LEN(,@10)                                       0131 00493000
         BCTR  @09,0                                               0131 00494000
         ST    @09,LEN(,@10)                                       0131 00495000
*           MOVED=1;                /* UP BFRA BASE BY 1             */ 00496000
         LA    MOVED,1                                             0132 00497000
*         END;                      /*                               */ 00498000
*       ELSE                        /* OTHERWISE SET MOVED           */ 00499000
*         MOVED=0;                  /* TO ZERO                       */ 00500000
         B     @RC00129                                            0134 00501000
@RF00129 SLR   MOVED,MOVED                                         0134 00502000
*       DO LEN=LEN TO 1 BY-1 WHILE BFRFA(LEN)=' ';/* SCAN            */ 00503000
@RC00129 L     @10,@PC00001+4                                      0135 00504000
         L     @10,LEN(,@10)                                       0135 00505000
         B     @DE00135                                            0135 00506000
@DL00135 L     @10,@PC00001+4                                      0135 00507000
         L     @10,LEN(,@10)                                       0135 00508000
         LR    @09,PTRA                                            0135 00509000
         ALR   @09,MOVED                                           0135 00510000
         ALR   @09,@10                                             0135 00511000
         BCTR  @09,0                                               0135 00512000
         CLI   BFRFA(@09),C' '                                     0135 00513000
         BNE   @DC00135                                            0135 00514000
*       END;                        /* BACK TO LAST NONBLANK         */ 00515000
         L     @09,@PC00001+4                                      0136 00516000
         SLR   @10,@10                                             0136 00517000
         BCTR  @10,0                                               0136 00518000
         AL    @10,LEN(,@09)                                       0136 00519000
         L     @09,@PC00001+4                                      0136 00520000
         ST    @10,LEN(,@09)                                       0136 00521000
@DE00135 LTR   @10,@10                                             0136 00522000
         BP    @DL00135                                            0136 00523000
@DC00135 DS    0H                                                  0137 00524000
*       CALL MOVE(BFRFA,OUTBUF,LEN,LEN);/* MOVE BFR                  */ 00525000
         LR    @10,PTRA                                            0137 00526000
         ALR   @10,MOVED                                           0137 00527000
         ST    @10,@AL00001                                        0137 00528000
         L     @10,@PC00001                                        0137 00529000
         BCTR  @10,0                                               0137 00530000
         L     @10,BFRA(,@10)                                      0137 00531000
         LA    @10,0(,@10)                                         0137 00532000
         ST    @10,@AL00001+4                                      0137 00533000
         L     @10,@PC00001+4                                      0137 00534000
         ST    @10,@AL00001+8                                      0137 00535000
         ST    @10,@AL00001+12                                     0137 00536000
         LA    @01,@AL00001                                        0137 00537000
         BAL   @14,MOVE                                            0137 00538000
*     END;                                                         0138 00539000
*EOF:                                                              0139 00540000
*   END GETRTN;                                                    0139 00541000
@EL00003 DS    0H                                                  0139 00542000
@EF00003 DS    0H                                                  0139 00543000
@ER00003 LM    @14,@07,@SA00003                                    0139 00544000
         LM    @09,@12,@SA00003+40                                 0139 00545000
         BR    @14                                                 0139 00546000
*                                                                  0140 00547000
*   /*****************************************************************/ 00548000
*   /*                                                               */ 00549000
*   /* PUTRTN: THE PUTRTN IS USED TO PUT A LINE OUT TO A DATASET.    */ 00550000
*   /* SPECIAL PROCESSING OCCURS IF THE LINE TO BE PUT OUT IS GREATER*/ 00551000
*   /* THAN DCBLRECL FOR RECFM=F OR DCBBLKSI FOR RECFM=V             */ 00552000
*   /*                                                               */ 00553000
*   /*****************************************************************/ 00554000
*                                                                  0140 00555000
*PUTRTN:                                                           0140 00556000
*   PROC;                           /* THIS IS THE PUTRTN            */ 00557000
PUTRTN   STM   @14,@07,@SA00004                                    0140 00558000
         STM   @09,@12,@SA00004+40                                 0140 00559000
*   SPOOL=SP01;                     /* SET FOR SUPBOOL 1             */ 00560000
         MVI   SPOOL,X'01'                                         0141 00561000
*   IF DCBRECL=V THEN               /* FOR RECFM = V                 */ 00562000
         TM    DCBRECL+28(OPENADR),B'01000000'                     0142 00563000
         BNO   @RF00142                                            0142 00564000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0142 00565000
         BNZ   @RF00142                                            0142 00566000
*     LENG=LEN+5;                   /* GET MAXIMUM BUFFER            */ 00567000
         L     @10,@PC00001+4                                      0143 00568000
         L     @10,LEN(,@10)                                       0143 00569000
         LA    @10,5(,@10)                                         0143 00570000
         STCM  @10,7,LENG                                          0143 00571000
*   ELSE                            /* FOR OTHER RECFMS              */ 00572000
*     LENG=MAX(LEN+1,DCBLRECL);     /* SET LENG AT LEAST DCBLRECL    */ 00573000
         B     @RC00142                                            0144 00574000
@RF00142 L     @10,@PC00001+4                                      0144 00575000
         LA    @06,1                                               0144 00576000
         AL    @06,LEN(,@10)                                       0144 00577000
         LH    @10,DCBLRECL+72(,OPENADR)                           0144 00578000
         CR    @06,@10                                             0144 00579000
         BNL   *+6                                                      00580000
         LR    @06,@10                                             0144 00581000
         STCM  @06,7,LENG                                          0144 00582000
*   RFY                                                            0145 00583000
*    (R0,                                                          0145 00584000
*     R1) RSTD;                     /* RESTRICT GETMAIN REGS         */ 00585000
@RC00142 DS    0H                                                  0146 00586000
*   R0=GETPARM;                     /* LOAD R0 WITH GETMAIN PARMS    */ 00587000
         L     R0,GETPARM                                          0146 00588000
*   GEN REFS(R0) SETS(R1)(GETMAIN R,LV=(0));/* ISSUE GETMAIN         */ 00589000
         GETMAIN R,LV=(0)                                               00590000
*   LINEPTR=R1;                     /* SET BASE POINTER              */ 00591000
         LR    LINEPTR,R1                                          0148 00592000
*   RFY                                                            0149 00593000
*    (R0,                                                          0149 00594000
*     R1) UNRSTD;                   /* RELEASE REGS                  */ 00595000
*   PTRA=LINEPTR;                   /* SET I/O BUFFER BASE           */ 00596000
         LR    PTRA,LINEPTR                                        0150 00597000
*   LEFT=LEN;                       /* SET AMOUNT TO MOVE            */ 00598000
         L     @10,@PC00001+4                                      0151 00599000
         L     @10,LEN(,@10)                                       0151 00600000
         ST    @10,LEFT                                            0151 00601000
*   IF DCBRECCC=A&DSDCNTL=NO THEN   /* IF CARRIAGE BYTE NEEDED       */ 00602000
         TM    DCBRECCC+28(OPENADR),B'00000100'                    0152 00603000
         BNO   @RF00152                                            0152 00604000
         TM    DCBRECCC+28(OPENADR),B'00000010'                    0152 00605000
         BNZ   @RF00152                                            0152 00606000
         TM    DSDCNTL(IODSDPTR),B'01000000'                       0152 00607000
         BNZ   @RF00152                                            0152 00608000
*     CCN=1;                        /* SET XTRA BYTE AMOUNT          */ 00609000
         LA    CCN,1                                               0153 00610000
*   ELSE                            /* OTHERWISE SET XTRA BYTE       */ 00611000
*     CCN=0;                        /* AMOUNT TO ZERO                */ 00612000
         B     @RC00152                                            0154 00613000
@RF00152 SLR   CCN,CCN                                             0154 00614000
*   CALL CARRIAGE;                  /* PROCESS CARRIAGE CNTL         */ 00615000
@RC00152 BAL   @14,CARRIAGE                                        0155 00616000
*   IF DCBRECL=V THEN               /* PROCESS FOR RECFM=V           */ 00617000
         TM    DCBRECL+28(OPENADR),B'01000000'                     0156 00618000
         BNO   @RF00156                                            0156 00619000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0156 00620000
         BNZ   @RF00156                                            0156 00621000
*     DO;                           /*                               */ 00622000
*       LINEPTR->OO=0;              /* SET OFSET TO ZERO             */ 00623000
         SLR   @10,@10                                             0158 00624000
         STCM  @10,3,OO(LINEPTR)                                   0158 00625000
*       CALL MOVE(INBUF,BFRV,LEN,LEN);/* COPY BUFFER INTO OUTAREA    */ 00626000
         L     @10,@PC00001                                        0159 00627000
         BCTR  @10,0                                               0159 00628000
         L     @10,BFRA(,@10)                                      0159 00629000
         LA    @10,0(,@10)                                         0159 00630000
         ST    @10,@AL00001                                        0159 00631000
         LA    @10,BFRV(,PTRA)                                     0159 00632000
         ST    @10,@AL00001+4                                      0159 00633000
         L     @10,@PC00001+4                                      0159 00634000
         ST    @10,@AL00001+8                                      0159 00635000
         ST    @10,@AL00001+12                                     0159 00636000
         LA    @01,@AL00001                                        0159 00637000
         BAL   @14,MOVE                                            0159 00638000
*       DO WHILE LEFT^=0;           /* PUTOUT LOOP                   */ 00639000
         B     @DE00160                                            0160 00640000
@DL00160 DS    0H                                                  0161 00641000
*         RFY                                                      0161 00642000
*          (R0) RSTD;               /* RESTRICT FOR PUT              */ 00643000
*         R0=LINEPTR;               /* SET OUTAREA ADDRESS           */ 00644000
         LR    R0,LINEPTR                                          0162 00645000
*         GEN REFS(OPENADR,R0)(PUT  (OPENADR),(R0));/* ISSUE PUT     */ 00646000
         PUT  (OPENADR),(R0)                                            00647000
*         RFY                                                      0164 00648000
*          (R0) UNRSTD;             /* RELEASE REG ZERO              */ 00649000
*         LEFT=LEFT-MOVED;          /* SUBTRACT AMOUNT PUT OUT       */ 00650000
         L     @10,LEFT                                            0165 00651000
         SLR   @10,MOVED                                           0165 00652000
         ST    @10,LEFT                                            0165 00653000
*         IF LEFT^=0 THEN           /* IF MORE TO GO                 */ 00654000
         LTR   @10,@10                                             0166 00655000
         BZ    @RF00166                                            0166 00656000
*           DO;                     /* MOVE DOWN UNPUT PART OF BFR   */ 00657000
*             CALL MOVE(BFRVA,BFRV,LEFT,LEFT);                     0168 00658000
         LR    @10,PTRA                                            0168 00659000
         ALR   @10,MOVED                                           0168 00660000
         LA    @10,BFRVA(,@10)                                     0168 00661000
         ST    @10,@AL00001                                        0168 00662000
         LA    @10,BFRV(,PTRA)                                     0168 00663000
         ST    @10,@AL00001+4                                      0168 00664000
         LA    @10,LEFT                                            0168 00665000
         ST    @10,@AL00001+8                                      0168 00666000
         LA    @10,LEFT                                            0168 00667000
         ST    @10,@AL00001+12                                     0168 00668000
         LA    @01,@AL00001                                        0168 00669000
         BAL   @14,MOVE                                            0168 00670000
*             CALL CARRIAGE;        /* PROCESS C/C CHAR              */ 00671000
         BAL   @14,CARRIAGE                                        0169 00672000
*           END;                    /*                               */ 00673000
*       END;                        /*                               */ 00674000
@RF00166 DS    0H                                                  0171 00675000
@DE00160 L     @10,LEFT                                            0171 00676000
         LTR   @10,@10                                             0171 00677000
         BNZ   @DL00160                                            0171 00678000
*     END;                          /*                               */ 00679000
*                                                                  0173 00680000
*   /*****************************************************************/ 00681000
*   /*                                                               */ 00682000
*   /* PUTRTN OTHER THAN RECFM=V                                     */ 00683000
*   /*                                                               */ 00684000
*   /*****************************************************************/ 00685000
*                                                                  0173 00686000
*   ELSE                            /* OTHERWISE ASSUME RECFM=F OR U */ 00687000
*     DO;                           /* PUT OUT A LINE                */ 00688000
         B     @RC00156                                            0173 00689000
@RF00156 DS    0H                                                  0174 00690000
*       CALL MOVE(INBUF,BFRF,LEN,MAX(LEN,DCBLRECL-CCN));/* COPY BFR  */ 00691000
         L     @10,@PC00001                                        0174 00692000
         BCTR  @10,0                                               0174 00693000
         L     @10,BFRA(,@10)                                      0174 00694000
         LA    @10,0(,@10)                                         0174 00695000
         ST    @10,@AL00001                                        0174 00696000
         ST    PTRA,@AL00001+4                                     0174 00697000
         L     @10,@PC00001+4                                      0174 00698000
         ST    @10,@AL00001+8                                      0174 00699000
         LH    @09,DCBLRECL+72(,OPENADR)                           0174 00700000
         SLR   @09,CCN                                             0174 00701000
         L     @10,LEN(,@10)                                       0174 00702000
         CR    @10,@09                                             0174 00703000
         BNL   *+6                                                      00704000
         LR    @10,@09                                             0174 00705000
         ST    @10,@AFTEMPS                                        0174 00706000
         LA    @10,@AFTEMPS                                        0174 00707000
         ST    @10,@AL00001+12                                     0174 00708000
         LA    @01,@AL00001                                        0174 00709000
         BAL   @14,MOVE                                            0174 00710000
*       DO WHILE LEFT^=0;           /* DO UNTIL DONE                 */ 00711000
         B     @DE00175                                            0175 00712000
@DL00175 DS    0H                                                  0176 00713000
*         RFY                                                      0176 00714000
*          (R0) RSTD;               /* RESTRICT REG ZERO             */ 00715000
*         R0=LINEPTR;               /* SET OUTAREA ADDR              */ 00716000
         LR    R0,LINEPTR                                          0177 00717000
*         GEN REFS(OPENADR,R0)(PUT  (OPENADR),(R0));/* ISSUE PUT     */ 00718000
         PUT  (OPENADR),(R0)                                            00719000
*         RFY                                                      0179 00720000
*          (R0) UNRSTD;             /* RELEASE REGS                  */ 00721000
*         LEFT=LEFT-MOVED;          /* UPDATE LEFT                   */ 00722000
         L     @10,LEFT                                            0180 00723000
         SLR   @10,MOVED                                           0180 00724000
         ST    @10,LEFT                                            0180 00725000
*         IF LEFT^=0 THEN           /* IF REC TOO LONG, PUT REST     */ 00726000
         LTR   @10,@10                                             0181 00727000
         BZ    @RF00181                                            0181 00728000
*           DO;                     /* MOVE DOWN REST OF BUFFER      */ 00729000
*             CALL MOVE(BFRFA,BFRF,LEFT,MAX(LEFT,DCBLRECL-CCN));   0183 00730000
         LR    @09,PTRA                                            0183 00731000
         ALR   @09,MOVED                                           0183 00732000
         ST    @09,@AL00001                                        0183 00733000
         ST    PTRA,@AL00001+4                                     0183 00734000
         LA    @09,LEFT                                            0183 00735000
         ST    @09,@AL00001+8                                      0183 00736000
         LH    @09,DCBLRECL+72(,OPENADR)                           0183 00737000
         SLR   @09,CCN                                             0183 00738000
         CR    @10,@09                                             0183 00739000
         BNL   *+6                                                      00740000
         LR    @10,@09                                             0183 00741000
         ST    @10,@AFTEMPS                                        0183 00742000
         LA    @10,@AFTEMPS                                        0183 00743000
         ST    @10,@AL00001+12                                     0183 00744000
         LA    @01,@AL00001                                        0183 00745000
         BAL   @14,MOVE                                            0183 00746000
*             CALL CARRIAGE;        /* PROCESS C/C CHAR              */ 00747000
         BAL   @14,CARRIAGE                                        0184 00748000
*           END;                    /*                               */ 00749000
*       END;                        /*                               */ 00750000
@RF00181 DS    0H                                                  0186 00751000
@DE00175 L     @10,LEFT                                            0186 00752000
         LTR   @10,@10                                             0186 00753000
         BNZ   @DL00175                                            0186 00754000
*     END;                          /*                               */ 00755000
*   RFY                                                            0188 00756000
*    (R0,                                                          0188 00757000
*     R1) RSTD;                     /* RESTRICT REGS                 */ 00758000
@RC00156 DS    0H                                                  0189 00759000
*   R0=GETPARM;                     /* SET LENG AND SPOOL            */ 00760000
         L     R0,GETPARM                                          0189 00761000
*   R1=LINEPTR;                     /* SET FREE ADDR                 */ 00762000
         LR    R1,LINEPTR                                          0190 00763000
*   GEN REFS(R0,R1)(FREEMAIN R,LV=(0),A=(1));/* ISSUE FREEMAIN       */ 00764000
         FREEMAIN R,LV=(0),A=(1)                                        00765000
*   RFY                                                            0192 00766000
*    (R0,                                                          0192 00767000
*     R1) UNRSTD;                   /* RELEASE REGS                  */ 00768000
*   RETCODE=0;                      /*                               */ 00769000
         SLR   RETCODE,RETCODE                                     0193 00770000
*   END PUTRTN;                     /* END PUT PROCESSING            */ 00771000
@EL00004 DS    0H                                                  0194 00772000
@EF00004 DS    0H                                                  0194 00773000
@ER00004 LM    @14,@07,@SA00004                                    0194 00774000
         LM    @09,@12,@SA00004+40                                 0194 00775000
         BR    @14                                                 0194 00776000
*                                                                  0195 00777000
*   /*****************************************************************/ 00778000
*   /*                                                               */ 00779000
*   /* CARRIAGE: THE CARRIAGE ROUTINE IS USED TO DETERMINE IF        */ 00780000
*   /* CARRIAGE CONTROL IS NECESSARY. IF IT IS THEN THE I/O BUFFER   */ 00781000
*   /* BASE IS UPPED BY ONE ON THE FIRST ENTRY. ALSO THE FUNCTION OF */ 00782000
*   /* SETTING AMOUNT MOVED IS DONE HERE                             */ 00783000
*   /*                                                               */ 00784000
*   /*****************************************************************/ 00785000
*                                                                  0195 00786000
*CARRIAGE:                                                         0195 00787000
*   PROC;                           /* SETS C/C AND MOVED            */ 00788000
CARRIAGE STM   @14,@02,12(@13)                                     0195 00789000
         STM   @05,@12,40(@13)                                     0195 00790000
*   IF CCN=1 THEN                   /* IF C/C CHAR NECESSARY         */ 00791000
         LA    @10,1                                               0196 00792000
         CR    CCN,@10                                             0196 00793000
         BNE   @RF00196                                            0196 00794000
*     DO;                           /* THEN TEST IF FIRST ENTRY      */ 00795000
*       IF FIRST=YES THEN           /* IF IT IS, THEN INCR           */ 00796000
         TM    FIRST,B'01000000'                                   0198 00797000
         BNO   @RF00198                                            0198 00798000
*         DO;                       /* UPDATE PTRA BASE              */ 00799000
*           PTRA=PTRA+1;            /* AND RESET FIRST SWITCH        */ 00800000
         ALR   PTRA,@10                                            0200 00801000
*           FIRST=NO;               /*                               */ 00802000
         NI    FIRST,B'10111111'                                   0201 00803000
*         END;                      /*                               */ 00804000
*       IF DSDLINES>55 THEN         /* IF READY TO SKIP TO NEW PG    */ 00805000
@RF00198 CLI   DSDLINES(IODSDPTR),55                               0203 00806000
         BNH   @RF00203                                            0203 00807000
*         DO;                       /* RESET LINES TO 1 AND          */ 00808000
*           DSDLINES=1;             /* SET CCX TO CHAR '1'           */ 00809000
         MVI   DSDLINES(IODSDPTR),X'01'                            0205 00810000
*           CCX='1';                /*                               */ 00811000
         MVI   CCX,C'1'                                            0206 00812000
*         END;                      /*                               */ 00813000
*       ELSE                        /* OTHERWISE SET CCX TO BLANK    */ 00814000
*         DO;                       /* AND RESET LINES TO 1          */ 00815000
         B     @RC00203                                            0208 00816000
@RF00203 DS    0H                                                  0209 00817000
*           DSDLINES=1+DSDLINES;    /*                               */ 00818000
         LA    @10,1                                               0209 00819000
         SLR   @09,@09                                             0209 00820000
         IC    @09,DSDLINES(,IODSDPTR)                             0209 00821000
         ALR   @10,@09                                             0209 00822000
         STC   @10,DSDLINES(,IODSDPTR)                             0209 00823000
*           CCX=' ';                /*                               */ 00824000
         MVI   CCX,C' '                                            0210 00825000
*         END;                      /*                               */ 00826000
*       IF DCBRECL=V THEN           /* USE APPROPRIATE BUFFER FOR    */ 00827000
@RC00203 TM    DCBRECL+28(OPENADR),B'01000000'                     0212 00828000
         BNO   @RF00212                                            0212 00829000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0212 00830000
         BNZ   @RF00212                                            0212 00831000
*         LINEPTR->BFRV(1)=CCX;     /* SET C/C FOR RECFM=V           */ 00832000
         MVC   BFRV(1,LINEPTR),CCX                                 0213 00833000
*       ELSE                        /*                               */ 00834000
*         LINEPTR->BFRF(1)=CCX;     /* SET C/C FOR RECFM=F OR U      */ 00835000
         B     @RC00212                                            0214 00836000
@RF00212 MVC   BFRF(1,LINEPTR),CCX                                 0214 00837000
*     END;                          /*                               */ 00838000
@RC00212 DS    0H                                                  0216 00839000
*   IF DCBRECL=V THEN               /* FOR RECFM=V                   */ 00840000
@RF00196 TM    DCBRECL+28(OPENADR),B'01000000'                     0216 00841000
         BNO   @RF00216                                            0216 00842000
         TM    DCBRECL+28(OPENADR),B'10000000'                     0216 00843000
         BNZ   @RF00216                                            0216 00844000
*     DO;                           /*                               */ 00845000
*       LINEPTR->LL=MIN(DCBBLKSI-4,LEFT+4+CCN);/* SET LL FOR LINE    */ 00846000
         LA    @10,4                                               0218 00847000
         LH    @09,DCBBLKSI+52(,OPENADR)                           0218 00848000
         SLR   @09,@10                                             0218 00849000
         L     @06,LEFT                                            0218 00850000
         ALR   @06,@10                                             0218 00851000
         ALR   @06,CCN                                             0218 00852000
         CR    @09,@06                                             0218 00853000
         BNH   *+6                                                      00854000
         LR    @09,@06                                             0218 00855000
         STCM  @09,3,LL(LINEPTR)                                   0218 00856000
*       MOVED=LINEPTR->LL-(4+CCN);  /* SET AMT PUT OUT               */ 00857000
         ALR   @10,CCN                                             0219 00858000
         SLR   @09,@10                                             0219 00859000
         LR    MOVED,@09                                           0219 00860000
*     END;                          /*                               */ 00861000
*   ELSE                            /* SET MOVED TO DCBLRECL-CC      */ 00862000
*     DO;                           /*                               */ 00863000
         B     @RC00216                                            0221 00864000
@RF00216 DS    0H                                                  0222 00865000
*       IF DCBRECL=U THEN           /* FOR RECFM=U                   */ 00866000
         TM    DCBRECL+28(OPENADR),B'11000000'                     0222 00867000
         BNO   @RF00222                                            0222 00868000
*         DCBLRECL=MIN(DCBBLKSI,LEFT+CCN);/* SET DCBLRECL            */ 00869000
         LR    @10,CCN                                             0223 00870000
         AL    @10,LEFT                                            0223 00871000
         LH    @09,DCBBLKSI+52(,OPENADR)                           0223 00872000
         CR    @09,@10                                             0223 00873000
         BNH   *+6                                                      00874000
         LR    @09,@10                                             0223 00875000
         STH   @09,DCBLRECL+72(,OPENADR)                           0223 00876000
*       MOVED=MIN(DCBLRECL-CCN,LEFT);/* SET MOVED                    */ 00877000
@RF00222 LH    MOVED,DCBLRECL+72(,OPENADR)                         0224 00878000
         SLR   MOVED,CCN                                           0224 00879000
         L     @10,LEFT                                            0224 00880000
         CR    MOVED,@10                                           0224 00881000
         BNH   *+6                                                      00882000
         LR    MOVED,@10                                           0224 00883000
*     END;                          /*                               */ 00884000
*   END CARRIAGE;                   /* END C/C CHAR PROCESSING       */ 00885000
@EL00005 DS    0H                                                  0226 00886000
@EF00005 DS    0H                                                  0226 00887000
@ER00005 LM    @14,@02,12(@13)                                     0226 00888000
         LM    @05,@12,40(@13)                                     0226 00889000
         BR    @14                                                 0226 00890000
*                                                                  0227 00891000
*   /*****************************************************************/ 00892000
*   /*                                                               */ 00893000
*   /* MOVE: THE MOVE ROUTINE IS USED TO MOVE I/O BUFFERS AROUND.    */ 00894000
*   /* THIS ROUTINE DECLARES ITS OWN REGISTERS TO KEEP THE SEPARATE  */ 00895000
*   /* FROM MAINLINE PROCESSING                                      */ 00896000
*   /*                                                               */ 00897000
*   /*****************************************************************/ 00898000
*                                                                  0227 00899000
*MOVE:                                                             0227 00900000
*   PROC(FROM,TO,LENFR,LENTO);      /* MOVE ROUTINE                  */ 00901000
MOVE     STM   @14,@12,@SA00006                                    0227 00902000
         MVC   @PC00006(16),0(@01)                                 0227 00903000
*   DCL                             /*                               */ 00904000
*     FROM CHAR(*),                 /* FROM BUFFER                   */ 00905000
*     TO CHAR(*),                   /* TO BUFFER                     */ 00906000
*     LENFR FIXED(31),              /* NUMBER OF BYTES TO MOVE       */ 00907000
*     LENTO FIXED(31),              /* NUMBER OF BYTES TO MOVE       */ 00908000
*     BLANKS BIT(32) CONSTANT('40000000'X);/* PADDING CHAR           */ 00909000
*   RFY                                                            0229 00910000
*    (R4,                                                          0229 00911000
*     R5,                                                          0229 00912000
*     R6,                                                          0229 00913000
*     R7) RSTD;                     /* RESTRICT REGS FOR MVCL        */ 00914000
*   R4=ADDR(TO(1));                 /* ADDRESS OF TO BUFFER          */ 00915000
         L     R4,@PC00006+4                                       0230 00916000
*   R6=ADDR(FROM(1));               /* ADDRESS OF FROM BUFFER        */ 00917000
         L     R6,@PC00006                                         0231 00918000
*   R5=LENTO;                       /* NUMBER OF BYTES TO MOVE       */ 00919000
         L     @10,@PC00006+12                                     0232 00920000
         L     R5,LENTO(,@10)                                      0232 00921000
*   R7=BLANKS|LENFR;                /* SET LEN AND PADD CHAR         */ 00922000
         L     @10,@PC00006+8                                      0233 00923000
         L     R7,LENFR(,@10)                                      0233 00924000
         O     R7,@CF00557                                         0233 00925000
*   GEN(MVCL  R4,R6);               /* ISSUE MVCL INSTRUCTION        */ 00926000
         MVCL  R4,R6                                                    00927000
*   RFY                                                            0235 00928000
*    (R4,                                                          0235 00929000
*     R5,                                                          0235 00930000
*     R6,                                                          0235 00931000
*     R7) UNRSTD;                   /* RELEASE REGS                  */ 00932000
*   END MOVE;                       /*                               */ 00933000
@EL00006 DS    0H                                                  0236 00934000
@EF00006 DS    0H                                                  0236 00935000
@ER00006 LM    @14,@12,@SA00006                                    0236 00936000
         BR    @14                                                 0236 00937000
*   END IKJRBBMC                    /*                               */ 00938000
*                                                                  0237 00939000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00940000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 00941000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 00942000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 00943000
*                                                                  0237 00944000
*       ;                                                          0237 00945000
@DATA    DS    0H                                                       00946000
@CH00036 DC    H'1'                                                     00947000
@CH00133 DC    H'20'                                                    00948000
         DS    0F                                                       00949000
@AL00030 DC    A(@CF00511)             LIST WITH   4 ARGUMENT(S)        00950000
         DS    F                                                        00951000
         DC    A(@CF00511)                                              00952000
         DC    A(STCKL)                                                 00953000
@DATD    DSECT                                                          00954000
         DS    0F                                                       00955000
@SA00001 DS    18F                                                      00956000
@PC00001 DS    4F                                                       00957000
@SA00003 DS    14F                                                      00958000
@SA00004 DS    14F                                                      00959000
@SA00006 DS    15F                                                      00960000
@PC00006 DS    4F                                                       00961000
@AL00001 DS    4A                                                       00962000
@AFTEMPS DS    1F                                                       00963000
IKJRBBMC CSECT                                                          00964000
         DS    0F                                                       00965000
@CF00511 DC    F'0'                                                     00966000
@CF00117 DC    F'4'                                                     00967000
@CF00063 DC    F'8'                                                     00968000
@CF00198 DC    F'16'                                                    00969000
@CF00557 DC    XL4'40000000'                                            00970000
@DATD    DSECT                                                          00971000
         DS    0D                                                       00972000
LEFT     DS    F                                                        00973000
GETPARM  DS    FL4                                                      00974000
         ORG   GETPARM                                                  00975000
SPOOL    DS    FL1                                                      00976000
LENG     DS    FL3                                                      00977000
         ORG   GETPARM+4                                                00978000
ECTPTR   DS    A                                                        00979000
DCBPTR   DS    A                                                        00980000
CCX      DS    CL1                                                      00981000
SWS      DS    CL1                                                      00982000
         ORG   SWS                                                      00983000
ERROR    DS    BL1                                                      00984000
FIRST    EQU   SWS+0                                                    00985000
         ORG   SWS+1                                                    00986000
IKJRBBMC CSECT                                                          00987000
         DS    0F                                                       00988000
@SIZDATD DC    AL1(1)                                                   00989000
         DC    AL3(@ENDDATD-@DATD)                                      00990000
@CA00148 DC    A(INLEN)                                                 00991000
@CV00517 DC    V(IKJEFT30)                                              00992000
         DS    0D                                                       00993000
PATCH    DC    8A(0)                                                    00994000
IKJRBBMC CSECT                                                          00995000
STCKL    STACK   DELETE=TOP,MF=L                                        00996000
@DATD    DSECT                                                          00997000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00998000
@ENDDATD EQU   *                                                        00999000
IKJRBBMC CSECT                                                          01000000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01001000
@01      EQU   01                                                       01002000
@02      EQU   02                                                       01003000
@03      EQU   03                                                       01004000
@04      EQU   04                                                       01005000
@05      EQU   05                                                       01006000
@06      EQU   06                                                       01007000
@07      EQU   07                                                       01008000
@08      EQU   08                                                       01009000
@09      EQU   09                                                       01010000
@10      EQU   10                                                       01011000
@11      EQU   11                                                       01012000
@12      EQU   12                                                       01013000
@13      EQU   13                                                       01014000
@14      EQU   14                                                       01015000
@15      EQU   15                                                       01016000
IODSDPTR EQU   @07                                                      01017000
PTRA     EQU   @04                                                      01018000
LINEPTR  EQU   @05                                                      01019000
RETCODE  EQU   @08                                                      01020000
CCN      EQU   @08                                                      01021000
MOVED    EQU   @03                                                      01022000
R0       EQU   @00                                                      01023000
R1       EQU   @01                                                      01024000
R4       EQU   @04                                                      01025000
R5       EQU   @05                                                      01026000
R6       EQU   @06                                                      01027000
R7       EQU   @07                                                      01028000
OPENADR  EQU   @02                                                      01029000
         EXTRN INLEN                                                    01030000
OUTBUF   EQU   0                                                        01031000
INBUF    EQU   0                                                        01032000
BFRF     EQU   0                                                        01033000
BFRFA    EQU   0                                                        01034000
@NM00002 EQU   0                                                        01035000
BFRVA    EQU   @NM00002+4                                               01036000
INSTACK  EQU   0                                                        01037000
INSCODE  EQU   INSTACK                                                  01038000
INSDATA  EQU   INSCODE                                                  01039000
INSADLSD EQU   INSTACK+1                                                01040000
IOSRL    EQU   0                                                        01041000
IOSTELM  EQU   IOSRL                                                    01042000
IOSBELM  EQU   IOSRL+4                                                  01043000
DSDFLAGS EQU   0                                                        01044000
DSDSEQ   EQU   DSDFLAGS                                                 01045000
DSDCNTL  EQU   DSDFLAGS                                                 01046000
DSDQSAM  EQU   DSDFLAGS                                                 01047000
DSDFRST  EQU   DSDFLAGS                                                 01048000
DSDOPTS  EQU   DSDFLAGS+1                                               01049000
DSDLINES EQU   DSDFLAGS+3                                               01050000
DSDMINBF EQU   DSDFLAGS+4                                               01051000
DSDBPAM  EQU   DSDFLAGS+12                                              01052000
BPAMBLK  EQU   0                                                        01053000
NEXTREC  EQU   BPAMBLK                                                  01054000
EOBLK    EQU   BPAMBLK+4                                                01055000
@NM00009 EQU   BPAMBLK+8                                                01056000
DECBINDX EQU   @NM00009                                                 01057000
DECBMAX  EQU   @NM00009+2                                               01058000
CURBLK   EQU   BPAMBLK+12                                               01059000
CURDECB  EQU   BPAMBLK+36                                               01060000
IOBPTR   EQU   CURDECB+16                                               01061000
BPAMDCB  EQU   BPAMBLK+156                                              01062000
@NM00012 EQU   0                                                        01063000
RESIDCNT EQU   @NM00012+14                                              01064000
INDCB    EQU   0                                                        01065000
OTDCB    EQU   0                                                        01066000
ECT      EQU   0                                                        01067000
ECTIOWA  EQU   ECT+4                                                    01068000
ECTSWS   EQU   ECT+28                                                   01069000
ECTSWS2  EQU   ECT+40                                                   01070000
ECTSWS21 EQU   ECTSWS2                                                  01071000
IHADCB   EQU   0                                                        01072000
IHADCS00 EQU   0                                                        01073000
DCBFDAD  EQU   IHADCS00+5                                               01074000
IHADCS01 EQU   0                                                        01075000
DCBDVTBL EQU   IHADCS01                                                 01076000
IHADCS11 EQU   0                                                        01077000
DCBRELB  EQU   IHADCS11                                                 01078000
DCBREL   EQU   DCBRELB+1                                                01079000
DCBBUFCB EQU   IHADCS11+4                                               01080000
DCBDSORG EQU   IHADCS11+10                                              01081000
DCBDSRG1 EQU   DCBDSORG                                                 01082000
DCBDSRG2 EQU   DCBDSORG+1                                               01083000
DCBIOBAD EQU   IHADCS11+12                                              01084000
DCBODEB  EQU   DCBIOBAD                                                 01085000
DCBLNP   EQU   DCBODEB                                                  01086000
DCBQSLM  EQU   DCBLNP                                                   01087000
DCBIOBAA EQU   DCBODEB+1                                                01088000
IHADCS50 EQU   0                                                        01089000
DCBSVCXL EQU   IHADCS50                                                 01090000
DCBEODAD EQU   IHADCS50+4                                               01091000
DCBBFALN EQU   DCBEODAD                                                 01092000
DCBHIARC EQU   DCBBFALN                                                 01093000
DCBBFTEK EQU   DCBHIARC                                                 01094000
DCBBFT   EQU   DCBBFTEK                                                 01095000
DCBEODA  EQU   DCBEODAD+1                                               01096000
DCBEXLST EQU   IHADCS50+8                                               01097000
DCBRECFM EQU   DCBEXLST                                                 01098000
DCBRECLA EQU   DCBRECFM                                                 01099000
DCBRECL  EQU   DCBRECLA                                                 01100000
DCBRECCC EQU   DCBRECFM                                                 01101000
IHADCS24 EQU   0                                                        01102000
DCBOFLGS EQU   IHADCS24+8                                               01103000
DCBOFLWR EQU   DCBOFLGS                                                 01104000
DCBOFOPN EQU   DCBOFLGS                                                 01105000
DCBIFLG  EQU   IHADCS24+9                                               01106000
DCBIBPCT EQU   DCBIFLG                                                  01107000
DCBMACR  EQU   IHADCS24+10                                              01108000
DCBMACR1 EQU   DCBMACR                                                  01109000
DCBMRFE  EQU   DCBMACR1                                                 01110000
DCBMRGET EQU   DCBMRFE                                                  01111000
DCBMRAPG EQU   DCBMACR1                                                 01112000
DCBMRRD  EQU   DCBMRAPG                                                 01113000
DCBMRCI  EQU   DCBMACR1                                                 01114000
DCBMRMVG EQU   DCBMRCI                                                  01115000
DCBMRLCG EQU   DCBMACR1                                                 01116000
DCBMRABC EQU   DCBMACR1                                                 01117000
DCBMRPT1 EQU   DCBMRABC                                                 01118000
DCBMRSBG EQU   DCBMRPT1                                                 01119000
DCBMRCRL EQU   DCBMACR1                                                 01120000
DCBMRCHK EQU   DCBMRCRL                                                 01121000
DCBMRRDX EQU   DCBMRCHK                                                 01122000
DCBMRDMG EQU   DCBMACR1                                                 01123000
DCBMACR2 EQU   DCBMACR+1                                                01124000
DCBMRPUT EQU   DCBMACR2                                                 01125000
DCBMRWRT EQU   DCBMACR2                                                 01126000
DCBMRMVP EQU   DCBMACR2                                                 01127000
DCBMR5WD EQU   DCBMACR2                                                 01128000
DCBMRLDM EQU   DCBMR5WD                                                 01129000
DCBMRLCP EQU   DCBMRLDM                                                 01130000
DCBMR4WD EQU   DCBMACR2                                                 01131000
DCBMRPT2 EQU   DCBMR4WD                                                 01132000
DCBMRTMD EQU   DCBMRPT2                                                 01133000
DCBMR3WD EQU   DCBMACR2                                                 01134000
DCBMRCTL EQU   DCBMR3WD                                                 01135000
DCBMRSTK EQU   DCBMRCTL                                                 01136000
DCBMR1WD EQU   DCBMACR2                                                 01137000
DCBMRSWA EQU   DCBMR1WD                                                 01138000
DCBMRDMD EQU   DCBMRSWA                                                 01139000
IHADCS25 EQU   0                                                        01140000
DCBMACRF EQU   IHADCS25+2                                               01141000
DCBMACF1 EQU   DCBMACRF                                                 01142000
DCBMFFE  EQU   DCBMACF1                                                 01143000
DCBMFGET EQU   DCBMFFE                                                  01144000
DCBMFAPG EQU   DCBMACF1                                                 01145000
DCBMFRD  EQU   DCBMFAPG                                                 01146000
DCBMFCI  EQU   DCBMACF1                                                 01147000
DCBMFMVG EQU   DCBMFCI                                                  01148000
DCBMFLCG EQU   DCBMACF1                                                 01149000
DCBMFABC EQU   DCBMACF1                                                 01150000
DCBMFPT1 EQU   DCBMFABC                                                 01151000
DCBMFSBG EQU   DCBMFPT1                                                 01152000
DCBMFCRL EQU   DCBMACF1                                                 01153000
DCBMFCHK EQU   DCBMFCRL                                                 01154000
DCBMFDMG EQU   DCBMACF1                                                 01155000
DCBMACF2 EQU   DCBMACRF+1                                               01156000
DCBMFPUT EQU   DCBMACF2                                                 01157000
DCBMFWRT EQU   DCBMACF2                                                 01158000
DCBMFMVP EQU   DCBMACF2                                                 01159000
DCBMF5WD EQU   DCBMACF2                                                 01160000
DCBMFLDM EQU   DCBMF5WD                                                 01161000
DCBMFLCP EQU   DCBMFLDM                                                 01162000
DCBMF4WD EQU   DCBMACF2                                                 01163000
DCBMFPT2 EQU   DCBMF4WD                                                 01164000
DCBMFTMD EQU   DCBMFPT2                                                 01165000
DCBMF3WD EQU   DCBMACF2                                                 01166000
DCBMFCTL EQU   DCBMF3WD                                                 01167000
DCBMFSTK EQU   DCBMFCTL                                                 01168000
DCBMF1WD EQU   DCBMACF2                                                 01169000
DCBMFSWA EQU   DCBMF1WD                                                 01170000
DCBMFDMD EQU   DCBMFSWA                                                 01171000
DCBDEBAD EQU   IHADCS25+4                                               01172000
DCBIFLGS EQU   DCBDEBAD                                                 01173000
DCBIFPCT EQU   DCBIFLGS                                                 01174000
IHADCS26 EQU   0                                                        01175000
DCBWRITE EQU   IHADCS26                                                 01176000
DCBREAD  EQU   DCBWRITE                                                 01177000
DCBWRITA EQU   DCBREAD+1                                                01178000
IHADCS27 EQU   0                                                        01179000
DCBGET   EQU   IHADCS27                                                 01180000
DCBPUT   EQU   DCBGET                                                   01181000
DCBGETA  EQU   DCBPUT+1                                                 01182000
IHADCS36 EQU   0                                                        01183000
DCBGERR  EQU   IHADCS36                                                 01184000
DCBPERR  EQU   DCBGERR                                                  01185000
DCBCHECK EQU   DCBPERR                                                  01186000
DCBOPTCD EQU   DCBCHECK                                                 01187000
DCBOPTH  EQU   DCBOPTCD                                                 01188000
DCBOPTO  EQU   DCBOPTH                                                  01189000
DCBOPTZ  EQU   DCBOPTCD                                                 01190000
DCBGERRA EQU   DCBCHECK+1                                               01191000
DCBPERRA EQU   DCBGERRA                                                 01192000
DCBSYNAD EQU   IHADCS36+4                                               01193000
DCBCIND1 EQU   IHADCS36+8                                               01194000
DCBCIND2 EQU   IHADCS36+9                                               01195000
DCBBLKSI EQU   IHADCS36+10                                              01196000
DCBIOBA  EQU   IHADCS36+16                                              01197000
DCBCICB  EQU   DCBIOBA                                                  01198000
IHADCS52 EQU   0                                                        01199000
DCBDIRCT EQU   IHADCS52                                                 01200000
DCBQSWS  EQU   DCBDIRCT                                                 01201000
DCBUSASI EQU   DCBQSWS                                                  01202000
DCBQADFS EQU   DCBUSASI                                                 01203000
DCBBUFOF EQU   DCBDIRCT+1                                               01204000
IHADCS37 EQU   0                                                        01205000
DCBFLAG1 EQU   IHADCS37                                                 01206000
IHADCS38 EQU   0                                                        01207000
DCBEOBR  EQU   IHADCS38                                                 01208000
DCBLRECL EQU   IHADCS38+10                                              01209000
DCBPOINT EQU   IHADCS38+12                                              01210000
DCBCNTRL EQU   DCBPOINT                                                 01211000
IHADCS40 EQU   0                                                        01212000
DCBEOBAD EQU   IHADCS40                                                 01213000
DCBCCCW  EQU   IHADCS40+4                                               01214000
DCBRECAD EQU   DCBCCCW                                                  01215000
DCBRECBT EQU   DCBRECAD                                                 01216000
DCBRCREL EQU   DCBRECBT                                                 01217000
@NM00045 EQU   IHADCS40+12                                              01218000
DCBEROPT EQU   @NM00045                                                 01219000
BLKLEN   EQU   0                                                        01220000
BFRA     EQU   0                                                        01221000
LEN      EQU   0                                                        01222000
ECTX     EQU   0                                                        01223000
FUNC     EQU   0                                                        01224000
FROM     EQU   0                                                        01225000
TO       EQU   0                                                        01226000
LENFR    EQU   0                                                        01227000
LENTO    EQU   0                                                        01228000
@NM00001 EQU   BFRF                                                     01229000
LL       EQU   @NM00001                                                 01230000
OO       EQU   @NM00001+2                                               01231000
BFRV     EQU   @NM00001+4                                               01232000
IOSRLPTR EQU   ECTIOWA                                                  01233000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01234000
DCBEOB   EQU   IHADCS40+20                                              01235000
DCBPRECL EQU   IHADCS40+18                                              01236000
@NM00048 EQU   IHADCS40+16                                              01237000
@NM00047 EQU   @NM00045+1                                               01238000
@NM00046 EQU   DCBEROPT                                                 01239000
DCBERABE EQU   DCBEROPT                                                 01240000
DCBERSKP EQU   DCBEROPT                                                 01241000
DCBERACC EQU   DCBEROPT                                                 01242000
@NM00044 EQU   IHADCS40+10                                              01243000
@NM00043 EQU   IHADCS40+9                                               01244000
@NM00042 EQU   IHADCS40+8                                               01245000
DCBRECA  EQU   DCBRECAD+1                                               01246000
@NM00041 EQU   DCBRECBT                                                 01247000
DCBRCFGT EQU   DCBRCREL                                                 01248000
DCBRCTRU EQU   DCBRCREL                                                 01249000
DCBLCCW  EQU   DCBEOBAD                                                 01250000
DCBNOTE  EQU   DCBCNTRL                                                 01251000
@NM00040 EQU   IHADCS38+8                                               01252000
DCBEOBW  EQU   IHADCS38+4                                               01253000
DCBEOBRA EQU   DCBEOBR+1                                                01254000
DCBNCP   EQU   DCBEOBR                                                  01255000
@NM00039 EQU   DCBFLAG1                                                 01256000
DCBSTFLS EQU   DCBFLAG1                                                 01257000
DCBSTQCK EQU   DCBFLAG1                                                 01258000
DCBDIRCQ EQU   DCBBUFOF                                                 01259000
DCBQSTRU EQU   DCBUSASI                                                 01260000
@NM00038 EQU   DCBUSASI                                                 01261000
DCBQADF3 EQU   DCBQADFS                                                 01262000
DCBQADF2 EQU   DCBQADFS                                                 01263000
DCBQADF1 EQU   DCBQADFS                                                 01264000
DCBBLBP  EQU   DCBUSASI                                                 01265000
@NM00037 EQU   DCBUSASI                                                 01266000
DCBCICBA EQU   DCBCICB+1                                                01267000
@NM00036 EQU   DCBCICB                                                  01268000
DCBOFFSW EQU   IHADCS36+15                                              01269000
DCBOFFSR EQU   IHADCS36+14                                              01270000
DCBWCPL  EQU   IHADCS36+13                                              01271000
DCBWCPO  EQU   IHADCS36+12                                              01272000
DCBCNQSM EQU   DCBCIND2                                                 01273000
DCBCNFEO EQU   DCBCIND2                                                 01274000
DCBCNCHS EQU   DCBCIND2                                                 01275000
DCBCNBFP EQU   DCBCIND2                                                 01276000
DCBCNIOE EQU   DCBCIND2                                                 01277000
DCBCNCLO EQU   DCBCIND2                                                 01278000
DCBCNWRO EQU   DCBCIND2                                                 01279000
DCBCNSTO EQU   DCBCIND2                                                 01280000
DCBCNEXB EQU   DCBCIND1                                                 01281000
@NM00035 EQU   DCBCIND1                                                 01282000
DCBCNBRM EQU   DCBCIND1                                                 01283000
@NM00034 EQU   DCBCIND1                                                 01284000
DCBCNEVA EQU   DCBCIND1                                                 01285000
DCBCNEVB EQU   DCBCIND1                                                 01286000
DCBCNSRD EQU   DCBCIND1                                                 01287000
DCBCNTOV EQU   DCBCIND1                                                 01288000
DCBSYNA  EQU   DCBSYNAD+1                                               01289000
DCBIOBL  EQU   DCBSYNAD                                                 01290000
DCBCHCKA EQU   DCBPERRA                                                 01291000
DCBOPTJ  EQU   DCBOPTCD                                                 01292000
DCBOPTT  EQU   DCBOPTCD                                                 01293000
DCBSRCHD EQU   DCBOPTZ                                                  01294000
DCBOPTQ  EQU   DCBOPTCD                                                 01295000
DCBBCKPT EQU   DCBOPTO                                                  01296000
DCBOPTC  EQU   DCBOPTCD                                                 01297000
DCBOPTU  EQU   DCBOPTCD                                                 01298000
DCBOPTW  EQU   DCBOPTCD                                                 01299000
DCBPUTA  EQU   DCBGETA                                                  01300000
@NM00033 EQU   DCBPUT                                                   01301000
DCBREADA EQU   DCBWRITA                                                 01302000
@NM00032 EQU   DCBREAD                                                  01303000
DCBDEBA  EQU   DCBDEBAD+1                                               01304000
@NM00031 EQU   DCBIFLGS                                                 01305000
DCBIFIOE EQU   DCBIFLGS                                                 01306000
DCBCH12  EQU   DCBIFPCT                                                 01307000
DCBCH9   EQU   DCBIFPCT                                                 01308000
DCBIFEC  EQU   DCBIFLGS                                                 01309000
DCBMFSTI EQU   DCBMFDMD                                                 01310000
DCBMFAWR EQU   DCBMFSTK                                                 01311000
DCBMFUIP EQU   DCBMFTMD                                                 01312000
DCBMFIDW EQU   DCBMFLCP                                                 01313000
DCBMFWRK EQU   DCBMFMVP                                                 01314000
DCBMFRDQ EQU   DCBMFWRT                                                 01315000
DCBMFGTQ EQU   DCBMFPUT                                                 01316000
DCBMFSTL EQU   DCBMACF2                                                 01317000
DCBMFCK  EQU   DCBMFDMG                                                 01318000
DCBMFRDX EQU   DCBMFCHK                                                 01319000
DCBMFDBF EQU   DCBMFSBG                                                 01320000
DCBMFRDI EQU   DCBMFLCG                                                 01321000
DCBMFRDK EQU   DCBMFMVG                                                 01322000
DCBMFWRQ EQU   DCBMFRD                                                  01323000
DCBMFPTQ EQU   DCBMFGET                                                 01324000
DCBMFECP EQU   DCBMACF1                                                 01325000
DCBTIOT  EQU   IHADCS25                                                 01326000
DCBMRSTI EQU   DCBMRDMD                                                 01327000
DCBMRAWR EQU   DCBMRSTK                                                 01328000
DCBMRUIP EQU   DCBMRTMD                                                 01329000
DCBMRIDW EQU   DCBMRLCP                                                 01330000
DCBMRWRK EQU   DCBMRMVP                                                 01331000
DCBMRRDQ EQU   DCBMRWRT                                                 01332000
DCBMRGTQ EQU   DCBMRPUT                                                 01333000
DCBMRSTL EQU   DCBMACR2                                                 01334000
DCBMRCK  EQU   DCBMRDMG                                                 01335000
DCBPGFXA EQU   DCBMRRDX                                                 01336000
DCBMRDBF EQU   DCBMRSBG                                                 01337000
DCBMRRDI EQU   DCBMRLCG                                                 01338000
DCBMRRDK EQU   DCBMRMVG                                                 01339000
DCBMRWRQ EQU   DCBMRRD                                                  01340000
DCBMRPTQ EQU   DCBMRGET                                                 01341000
DCBMRECP EQU   DCBMACR1                                                 01342000
@NM00030 EQU   DCBIFLG                                                  01343000
DCBIBIOE EQU   DCBIFLG                                                  01344000
DCBICH12 EQU   DCBIBPCT                                                 01345000
DCBICH9  EQU   DCBIBPCT                                                 01346000
DCBIBEC  EQU   DCBIFLG                                                  01347000
DCBOFIOF EQU   DCBOFLGS                                                 01348000
DCBOFUEX EQU   DCBOFLGS                                                 01349000
DCBOFTM  EQU   DCBOFLGS                                                 01350000
DCBOFPPC EQU   DCBOFLGS                                                 01351000
DCBOFEOV EQU   DCBOFLGS                                                 01352000
DCBOFLRB EQU   DCBOFLGS                                                 01353000
DCBOFIOD EQU   DCBOFLWR                                                 01354000
DCBDDNAM EQU   IHADCS24                                                 01355000
DCBEXLSA EQU   DCBEXLST+1                                               01356000
DCBRECKL EQU   DCBRECFM                                                 01357000
DCBRECSB EQU   DCBRECFM                                                 01358000
DCBRECBR EQU   DCBRECFM                                                 01359000
DCBRECTO EQU   DCBRECLA                                                 01360000
DCBBFA   EQU   DCBBFTEK                                                 01361000
DCBH0    EQU   DCBBFTEK                                                 01362000
DCBBFTKD EQU   DCBBFTEK                                                 01363000
DCBBFTE  EQU   DCBBFT                                                   01364000
DCBBFTKR EQU   DCBBFT                                                   01365000
DCBBFTS  EQU   DCBBFT                                                   01366000
DCBH1    EQU   DCBBFTEK                                                 01367000
DCBSVCXA EQU   DCBSVCXL+1                                               01368000
@NM00029 EQU   DCBSVCXL                                                 01369000
DCBODEBA EQU   DCBIOBAA                                                 01370000
@NM00028 EQU   DCBQSLM                                                  01371000
DCBUPDBT EQU   DCBQSLM                                                  01372000
DCBUPDCM EQU   DCBQSLM                                                  01373000
DCB1DVDS EQU   DCBQSLM                                                  01374000
@NM00027 EQU   DCBDSRG2                                                 01375000
DCBDSGTR EQU   DCBDSRG2                                                 01376000
DCBACBM  EQU   DCBDSRG2                                                 01377000
@NM00026 EQU   DCBDSRG2                                                 01378000
DCBDSGTQ EQU   DCBDSRG2                                                 01379000
DCBDSGTX EQU   DCBDSRG2                                                 01380000
DCBDSGGS EQU   DCBDSRG2                                                 01381000
DCBDSGU  EQU   DCBDSRG1                                                 01382000
DCBDSGPO EQU   DCBDSRG1                                                 01383000
@NM00025 EQU   DCBDSRG1                                                 01384000
@NM00024 EQU   DCBDSRG1                                                 01385000
DCBDSGCX EQU   DCBDSRG1                                                 01386000
DCBDSGDA EQU   DCBDSRG1                                                 01387000
DCBDSGPS EQU   DCBDSRG1                                                 01388000
DCBDSGIS EQU   DCBDSRG1                                                 01389000
DCBBUFL  EQU   IHADCS11+8                                               01390000
DCBBUFCA EQU   DCBBUFCB+1                                               01391000
DCBBUFNO EQU   DCBBUFCB                                                 01392000
DCBDEVT  EQU   DCBREL                                                   01393000
DCBKEYLE EQU   DCBRELB                                                  01394000
DCBTRBAL EQU   IHADCS01+6                                               01395000
@NM00023 EQU   IHADCS01+5                                               01396000
@NM00022 EQU   IHADCS01+4                                               01397000
DCBDVTBA EQU   DCBDVTBL+1                                               01398000
@NM00021 EQU   DCBDVTBL                                                 01399000
DCBKEYCN EQU   IHADCS00+4                                               01400000
DCBRELAD EQU   IHADCS00                                                 01401000
@NM00020 EQU   IHADCB                                                   01402000
@NM00019 EQU   ECT+52                                                   01403000
@NM00018 EQU   ECT+48                                                   01404000
@NM00017 EQU   ECT+44                                                   01405000
@NM00016 EQU   ECTSWS2+1                                                01406000
@NM00015 EQU   ECTSWS21                                                 01407000
ECTTABND EQU   ECTSWS21                                                 01408000
ECTDEFCS EQU   ECTSWS21                                                 01409000
ECTBKPB  EQU   ECT+36                                                   01410000
ECTUSER  EQU   ECT+32                                                   01411000
ECTDDNUM EQU   ECT+29                                                   01412000
ECTATTN  EQU   ECTSWS                                                   01413000
ECTBKGRD EQU   ECTSWS                                                   01414000
ECTNNOT  EQU   ECTSWS                                                   01415000
ECTNMAL  EQU   ECTSWS                                                   01416000
ECTLOGF  EQU   ECTSWS                                                   01417000
ECTATRM  EQU   ECTSWS                                                   01418000
@NM00014 EQU   ECTSWS                                                   01419000
ECTNOPD  EQU   ECTSWS                                                   01420000
ECTSCMD  EQU   ECT+20                                                   01421000
ECTPCMD  EQU   ECT+12                                                   01422000
ECTSMSG  EQU   ECT+9                                                    01423000
ECTMSGF  EQU   ECT+8                                                    01424000
ECTRTCD  EQU   ECT+1                                                    01425000
ECTRCDF  EQU   ECT                                                      01426000
@NM00013 EQU   @NM00012                                                 01427000
@NM00011 EQU   CURDECB+8                                                01428000
DECBBLK  EQU   CURDECB+6                                                01429000
@NM00010 EQU   CURDECB                                                  01430000
@NM00008 EQU   DSDFLAGS+8                                               01431000
@NM00007 EQU   DSDFLAGS+6                                               01432000
@NM00006 EQU   DSDFLAGS+2                                               01433000
@NM00005 EQU   DSDFLAGS                                                 01434000
@NM00004 EQU   IOSRL+12                                                 01435000
IOSNELM  EQU   IOSRL+10                                                 01436000
IOSTLEN  EQU   IOSRL+8                                                  01437000
INSLIST  EQU   INSCODE                                                  01438000
INSPROC  EQU   INSCODE                                                  01439000
INSPROM  EQU   INSCODE                                                  01440000
INSRSVD  EQU   INSCODE                                                  01441000
INSOTDD  EQU   INSCODE                                                  01442000
INSINDD  EQU   INSCODE                                                  01443000
INSSTOR  EQU   INSCODE                                                  01444000
@NM00003 EQU   @NM00002                                                 01445000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01446000
@RC00026 EQU   @RC00025                                                 01447000
@RC00044 EQU   @RC00036                                                 01448000
@RF00057 EQU   @EL00002                                                 01449000
@RC00113 EQU   @EL00003                                                 01450000
EOF      EQU   @EL00003                                                 01451000
@RC00216 EQU   @EL00005                                                 01452000
@ENDDATA EQU   *                                                        01453000
         END   IKJRBBMC,(C'PLS1908',0701,78173)                         01454000
