         TITLE 'IKJRBBU0 -- UADS-REFORMATTOR                           *00001000
                        '                                               00002000
          LCLA  &SUBPN                                                  00003000
&SUBPN    SETA  1                                                       00004000
          ENTRY IKJREF                                                  00005000
IKJRBBU0  CSECT                                                         00006000
IKJREF    DS    0H                                                      00007000
IKJRBBU0 CSECT ,                                                   0002 00008000
@MAINENT DS    0H                                                  0002 00009000
         USING *,@15                                               0002 00010000
         B     @PROLOG                                             0002 00011000
         DC    AL1(16)                                             0002 00012000
         DC    C'IKJRBBU0  76.163'                                 0002 00013000
         DROP  @15                                                      00014000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00015000
         BALR  @09,0                                               0002 00016000
@PSTART  LA    @10,4095(,@09)                                      0002 00017000
         USING @PSTART,@09                                         0002 00018000
         USING @PSTART+4095,@10                                    0002 00019000
         L     @00,@SIZDATD                                        0002 00020000
         GETMAIN  R,LV=(0)                                              00021000
         LR    @11,@01                                             0002 00022000
         LA    @12,4095(,@11)                                      0002 00023000
         USING @DATD,@11                                           0002 00024000
         USING @DATD+4095,@12                                      0002 00025000
         ST    @13,@SA00001+4                                      0002 00026000
         LM    @00,@01,20(@13)                                     0002 00027000
         ST    @11,8(,@13)                                         0002 00028000
         LR    @13,@11                                             0002 00029000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00030000
*/********************************************************************/ 00031000
*/*                                                                  */ 00032000
*/* SEGMENT NAME -- IKJREF                                           */ 00033000
*/*                                                                  */ 00034000
*/* DESCRIPTIVE NAME -- N/A                                          */ 00035000
*/*                                                                  */ 00036000
*/* FUNCTION -- MAIN ENTRY TO UADSREFM, TOP LEVEL EXECUTOR           */ 00037000
*/*   OPERATION --                                                   */ 00038000
*/*   -  EXECUTE STANDARD PROLOGUE, SAVING ENTRY ENVIRONMENT         */ 00039000
*/*   -  PERFORM SEGMENT RINIT TO INITIALIZE UADSREFM ENVIRONMENT    */ 00040000
*/*   -  PERFORM SEGMENT STAE TO CREATE STAE EXIT LINKAGE            */ 00041000
*/*   -  PERFORM SEGMENT RJFCB TO DETERMINE OPEN ACTION              */ 00042000
*/*   -  PERFORM SEGMENT ROPEN TO OPEN DCBS FOR UPDAT/OUTPUT OR      */ 00043000
*/*      INPUT/OUTPUT                                                */ 00044000
*/*   -  PERFORM SEGMENT RENQU TO ENQ SHARED ON SYSIKJUA/OPENUADS    */ 00045000
*/*   -  PERFORM SEGMENT RREAD TO READ EACH USERID IN DIRECTORY      */ 00046000
*/*      SEQUENCE UNTIL END OF FILE IS DETECTED (OR TERMINATION      */ 00047000
*/*      CONDITION OCCURS)                                           */ 00048000
*/*   -  PERFORM SEGMENT RGMNEW TO OBTAIN OUTPUT BUFFER SPACE        */ 00049000
*/*   -  PERFORM SEGMENTS RBLDHDR AND RBLDMBR TO REBUILD CURRENT     */ 00050000
*/*      MEMBER BY HIERARCHICAL STRUCTURE                            */ 00051000
*/*   -  PERFORM SEGMENT RENQM TO ENQUEUE EXCLUSIVELY ON SYSIKJUA/   */ 00052000
*/*      'USERID' IF OUTPUT UADS IS OLD (UPDAT MODE)                 */ 00053000
*/*   -  PERFORM SEGMENT RWRITE TO WRITE THE REBUILT USERID MEMBER   */ 00054000
*/*      INTO OUTPUT UADS (SYSUADS)                                  */ 00055000
*/*   -  PERFORM SEGMENT RDEQM TO DEQUEUE SYSIKJUA/'USERID' IF IT IS */ 00056000
*/*      CURRENTLY ENQUEUED                                          */ 00057000
*/*   -  PERFORM SEGMENT RMODEU TO UPDATE (AND PRINT IF MESSAGE      */ 00058000
*/*      BUFFER IS FULL) THE 'USERIDS REFORMATTED' MESSAGE           */ 00059000
*/*   -  PERFORM SEGMENT RDEQU TO DEQUEUE 'SYSIKJUA/OPENUADS'        */ 00060000
*/*   -  PERFORM SEGMENT REND TO RELEASE ALL RESOURCES AND SET       */ 00061000
*/*      RETURN CODE                                                 */ 00062000
*/*   -  PERFORM STANDARD EPILOGUE TO RESTORE ENTRY ENVIRONMENT      */ 00063000
*/*      AND RETURN TO CALLER                                        */ 00064000
*/*                                                                  */ 00065000
*/* ENTRY -- ATTACHED (BY TMP/EQUIVALENT)                            */ 00066000
*/*                                                                  */ 00067000
*/* INPUT --                                                         */ 00068000
*/*   -  REGISTER 1 POINTS TO CPPL                                   */ 00069000
*/*                                                                  */ 00070000
*/* OUTPUT -- N/A                                                    */ 00071000
*/*                                                                  */ 00072000
*/* EXTERNAL REFERENCES -- N/A                                       */ 00073000
*/*                                                                  */ 00074000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 00075000
*/*   CONDITIONS -- N/A                                              */ 00076000
*/*   RETURN CODE -- N/A                                             */ 00077000
*/*                                                                  */ 00078000
*/* EXIT-ERROR -- N/A                                                */ 00079000
*/*   CONDITIONS -- N/A                                              */ 00080000
*/*   RETURN CODE -- N/A                                             */ 00081000
*/*                                                                  */ 00082000
*/********************************************************************/ 00083000
*/*  IKJREF:  EP(EFFECTIVE) TO UADS-REFORM EXTERNAL PROCEDURE        */ 00084000
*                                                                  0117 00085000
*           CALL  RINIT;            /* PERFORM INITIALIZATION        */ 00086000
         BAL   @14,RINIT                                           0117 00087000
*           CALL  RSTAE;            /* ESTABLISH STAE ENVIRONMENT    */ 00088000
         BAL   @14,RSTAE                                           0118 00089000
*           CALL  RJFCB;            /* DEFINE DCB RELATIONSHIP       */ 00090000
         BAL   @14,RJFCB                                           0119 00091000
*           CALL  ROPEN;            /* OPEN DCBS FOR UADS            */ 00092000
         BAL   @14,ROPEN                                           0120 00093000
*           CALL  RENQU;            /* ENQ ON SYSIKJUA/OPENUADS      */ 00094000
*                                                                  0121 00095000
         BAL   @14,RENQU                                           0121 00096000
*           DO  LIMIT = 1 TO 1;        /* CHK TO REVISE CURRENT MBR  */ 00097000
         LA    @08,1                                               0122 00098000
         STH   @08,LIMIT                                           0122 00099000
@DL00122 DS    0H                                                  0123 00100000
*             CALL  RREAD;          /* READ IN CURRENT MEMBER        */ 00101000
         BAL   @14,RREAD                                           0123 00102000
*             IF  RENDOF = '0'B     /* CHK FOR UADS END OF FILE      */ 00103000
*               THEN                /* NO,                           */ 00104000
         TM    RENDOF,B'00100000'                                  0124 00105000
         BNZ   @RF00124                                            0124 00106000
*                 DO;                                              0125 00107000
*                   CALL  RGMNEW;   /* GET SPACE FOR NEW MBR ENTRY   */ 00108000
         BAL   @14,RGMNEW                                          0126 00109000
*                   CALL  RBLDHDR;  /* BUILD NEW HEADER BLOCK        */ 00110000
         BAL   @14,RBLDHDR                                         0127 00111000
*                   CALL  RBLDMBR;  /* BUILD NEW MEMBER ENTRY        */ 00112000
         BAL   @14,RBLDMBR                                         0128 00113000
*                   CALL  RENQM;    /* ENQ ON SYSIKJUA/'USERID'      */ 00114000
         BAL   @14,RENQM                                           0129 00115000
*                   CALL  RWRITE;   /* WRITE NEW MEMBER IN UADS      */ 00116000
         BAL   @14,RWRITE                                          0130 00117000
*                   CALL  RDEQM;    /* DEQ FROM SYSIKJUA/'USERID'    */ 00118000
         BAL   @14,RDEQM                                           0131 00119000
*                   CALL  RMODEU;   /* ISSUE USERIDS-MODE MESSAGE    */ 00120000
         BAL   @14,RMODEU                                          0132 00121000
*                   IF RFMQUIT='0'B /* CHK FOR TERMINATION           */ 00122000
*                     THEN          /* NO,                           */ 00123000
         TM    RFMQUIT,B'01000000'                                 0133 00124000
         BNZ   @RF00133                                            0133 00125000
*                       DO;                                        0134 00126000
*                         LIMIT = 0;  /* SET TO CONTINUE TO READ     */ 00127000
         SLR   @08,@08                                             0135 00128000
         STH   @08,LIMIT                                           0135 00129000
*                         UIDQUIT = '0'B;/* CLEAR USERID TERM FLAG   */ 00130000
         NI    UIDQUIT,B'01111111'                                 0136 00131000
*                         RFCTLR=RFCTLR&FLAGMSK;  /* CONTROL FLAGS   */ 00132000
         NC    RFCTLR(5),FLAGMSK                                   0137 00133000
         MVI   RFCTLR+5,X'00'                                      0137 00134000
*                       END;                                       0138 00135000
*                 END;                                             0139 00136000
@RF00133 DS    0H                                                  0140 00137000
*           END;                                                   0140 00138000
*                                                                  0140 00139000
@RF00124 LA    @08,1                                               0140 00140000
         AH    @08,LIMIT                                           0140 00141000
         STH   @08,LIMIT                                           0140 00142000
         CH    @08,@CH00032                                        0140 00143000
         BNH   @DL00122                                            0140 00144000
*           CALL  REND;             /* TERMINATE REFORM FUNCTIONS    */ 00145000
         BAL   @14,REND                                            0141 00146000
*/*         END;     (EFFECTIVE) OF REFORM PROCESSOR                 */ 00147000
*MAINX:     RETURN  CODE(RETURNC);  /* END OF REFORM EXECUTOR        */ 00148000
MAINX    L     @08,RETURNC                                         0142 00149000
         L     @13,4(,@13)                                         0142 00150000
         L     @00,@SIZDATD                                        0142 00151000
         LR    @01,@11                                             0142 00152000
         FREEMAIN R,LV=(0),A=(1)                                        00153000
         LR    @15,@08                                             0142 00154000
         L     @14,12(,@13)                                        0142 00155000
         LM    @00,@12,20(@13)                                     0142 00156000
         BR    @14                                                 0142 00157000
*/********************************************************************/ 00158000
*/*                                                                  */ 00159000
*/* SEGMENT NAME -- RINIT                                            */ 00160000
*/*                                                                  */ 00161000
*/* DESCRIPTIVE NAME -- N/A                                          */ 00162000
*/*                                                                  */ 00163000
*/* FUNCTION -- INITIALIZE UADSREFM ENVIRONMENT                      */ 00164000
*/*                                                                  */ 00165000
*/*   OPERATION --                                                   */ 00166000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 00167000
*/*   -  CLEAR GETMAIN AREA                                          */ 00168000
*/*   -  SET POINTERS TO CONTROL BLOCKS -- CPPL (REGISTER 1),        */ 00169000
*/*      ECT (CPPLECT), ECT (ECTPTR), UPT (CPPLUPT), REFMECB,        */ 00170000
*/*      AND TO CURRENT DIRECTORY ENTRY AREA                         */ 00171000
*/*   -  INITIALIZE PARAMETER LISTS, PARAMETER BLOCKS, AND DCBS      */ 00172000
*/*   -  SET POINTERS TO DCBS                                        */ 00173000
*/*   -  SET RDJFCB EXIT LISTS AT HEAD OF RDJFCB READ AREAS --       */ 00174000
*/*      RDJINNA AND RDJEXAA                                         */ 00175000
*/*   -  INITIALIZE CONTROLS FOR USERID-REFORMATTED MESSAGE BUFFER   */ 00176000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 00177000
*/*                                                                  */ 00178000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 00179000
*/*                                                                  */ 00180000
*/* INPUT --                                                         */ 00181000
*/*   -  REGISTER 1, POINTER TO CPPL                                 */ 00182000
*/*                                                                  */ 00183000
*/* OUTPUT --                                                        */ 00184000
*/*   -  UADSREFM ENVIRONMENT ESTABLISHED                            */ 00185000
*/*                                                                  */ 00186000
*/* EXTERNAL REFERENCES -- N/A                                       */ 00187000
*/*                                                                  */ 00188000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14 )           */ 00189000
*/*                                                                  */ 00190000
*/*   CONDITIONS -- N/A                                              */ 00191000
*/*                                                                  */ 00192000
*/*   RETURN CODE -- N/A                                             */ 00193000
*/*                                                                  */ 00194000
*/* EXIT-ERROR -- N/A                                                */ 00195000
*/*                                                                  */ 00196000
*/*   CONDITIONS -- N/A                                              */ 00197000
*/*                                                                  */ 00198000
*/*   RETURN CODE -- N/A                                             */ 00199000
*/*                                                                  */ 00200000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 00201000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 00202000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 00203000
*/*                                                                  */ 00204000
*/********************************************************************/ 00205000
*                                                                  0143 00206000
*RINIT:     /* INITIALIZATION FUNCTION                               */ 00207000
*           PROCEDURE                                              0143 00208000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 00209000
@EL00001 L     @13,4(,@13)                                         0143 00210000
@EF00001 L     @00,@SIZDATD                                        0143 00211000
         LR    @01,@11                                             0143 00212000
         FREEMAIN R,LV=(0),A=(1)                                        00213000
@ER00001 LM    @14,@12,12(@13)                                     0143 00214000
         BR    @14                                                 0143 00215000
RINIT    DS    0H                                                  0144 00216000
*                                   /* NO SAVE AREA CREATED          */ 00217000
*                                                                  0144 00218000
*           RESPECIFY (R14) RESTRICTED;                            0144 00219000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 00220000
         ST    R14,SAVLNKA                                         0145 00221000
*           RESPECIFY (R14) UNRESTRICTED;                          0146 00222000
*                                                                  0146 00223000
*           /* CLEAR GOTMAIN AREA                                    */ 00224000
*           RESPECIFY (RSPZOP,RLNG) RESTRICTED;                    0147 00225000
*           GEN(LH    RLNG,@SIZDATD+2);  /* SET BASIC LENGTH         */ 00226000
         LH    RLNG,@SIZDATD+2                                          00227000
*           RESPECIFY (R11) RESTRICTED;                            0149 00228000
*           RLNG = RLNG-(ADDR(SVREND)-R11);  /* EXCLUDE SAVE LINKS   */ 00229000
         LA    @08,SVREND                                          0150 00230000
         LCR   @08,@08                                             0150 00231000
         ALR   @08,R11                                             0150 00232000
         ALR   RLNG,@08                                            0150 00233000
*           RESPECIFY (R11) UNRESTRICTED;                          0151 00234000
*           RSPZOP = ADDR(XCOP);    /* SET FOR EXCLUSIVE-OR OPN      */ 00235000
         LA    RSPZOP,XCOP                                         0152 00236000
*           RESPECIFY (RFROM,RTO) RESTRICTED;                      0153 00237000
*           RFROM = ADDR(HEDBPTR);  /* SET SOURCE PTR                */ 00238000
         LA    RFROM,HEDBPTR                                       0154 00239000
*           RTO = RFROM;            /* SET RECEIVER PTR              */ 00240000
         LR    RTO,RFROM                                           0155 00241000
*           CALL  DOPSPAZ;          /* GO TO PERFORM EXCLUSIVE-OR    */ 00242000
         BAL   @14,DOPSPAZ                                         0156 00243000
*           RESPECIFY (RSPZOP,RSPW,RLNG,RFROM,RTO) UNRESTRICTED;   0157 00244000
*           RESPECIFY (R1) RESTRICTED;                             0158 00245000
*           CPPLPTR = R1;           /* PTR TO INPUT PARM LIST        */ 00246000
         ST    R1,CPPLPTR                                          0159 00247000
*           RESPECIFY (R1) UNRESTRICTED;                           0160 00248000
*           ECTPTR = CPPLECT;       /* PTR TO ECT                    */ 00249000
         L     @08,CPPLPTR                                         0161 00250000
         L     @15,CPPLECT(,@08)                                   0161 00251000
         ST    @15,ECTPTR                                          0161 00252000
*           BASECTP = ECTPTR;       /* PTR TO ECT FOR MODEL PL       */ 00253000
         ST    @15,BASECTP                                         0162 00254000
*           BASUPTP = CPPLUPT;      /* PTR TO UPT FOR MODEL PL       */ 00255000
         MVC   BASUPTP(4),CPPLUPT(@08)                             0163 00256000
*           BASECBP = ADDR(REFMECB);/* PTR TO REFORM ECB FOR MODEL   */ 00257000
         LA    @08,REFMECB                                         0164 00258000
         ST    @08,BASECBP                                         0164 00259000
*           CURDIRP = ADDR(CURDIRN);/* PTR TO CURRENT DIRECTRY ENTRY */ 00260000
         LA    @08,CURDIRN                                         0165 00261000
         ST    @08,CURDIRP                                         0165 00262000
*           IOPLPTR = ADDR(PLOUT);  /* PTR TO SERVICE RTN PARM LIST  */ 00263000
         LA    @08,PLOUT                                           0166 00264000
         ST    @08,IOPLPTR                                         0166 00265000
*           PLOUT = BASPTRS;        /* INITIALIZE PARM LIST          */ 00266000
         MVI   PLOUT+20,C' '                                       0167 00267000
         MVC   PLOUT+21(3),PLOUT+20                                0167 00268000
         MVC   PLOUT(20),BASPTRS                                   0167 00269000
*           PTPBPTR = ADDR(PTPBK);  /* PTR TO PUTLINE PB             */ 00270000
         LA    @08,PTPBK                                           0168 00271000
         ST    @08,PTPBPTR                                         0168 00272000
*           GEN(MVC   STAEL1(MVCLNG1),MSTAEL1);/* INITIALIZE PLS,PBS */ 00273000
         MVC   STAEL1(MVCLNG1),MSTAEL1                                  00274000
*           GEN(MVC   NQOPN(MVCLNG2),MNQOPN);  /* INITIALIZE PLS,PBS */ 00275000
         MVC   NQOPN(MVCLNG2),MNQOPN                                    00276000
*           GEN(MVC   RDIDCB(DIRDLG),MRDIDCB); /* INITIALIZE BSAM    */ 00277000
         MVC   RDIDCB(DIRDLG),MRDIDCB                                   00278000
*           DCBNPTR = ADDR(RINDCB); /* INPUT DCB PTR                 */ 00279000
         LA    @08,RINDCB                                          0172 00280000
         ST    @08,DCBNPTR                                         0172 00281000
*           DCBXPTR = ADDR(REXDCB); /* OUTPUT DCB PTR                */ 00282000
         LA    @08,REXDCB                                          0173 00283000
         ST    @08,DCBXPTR                                         0173 00284000
*           DCBDPTR = ADDR(RDIDCB); /* OUTPUT DCB PTR                */ 00285000
         LA    @08,RDIDCB                                          0174 00286000
         ST    @08,DCBDPTR                                         0174 00287000
*           RDJNXL = ADDR(RDJINA)+MSK07W;  /* FORM INPUT EXIT LIST   */ 00288000
         L     @08,MSK07W                                          0175 00289000
         LA    @15,RDJINA                                          0175 00290000
         ALR   @15,@08                                             0175 00291000
         ST    @15,RDJNXL                                          0175 00292000
*           RDJXXL = ADDR(RDJEXA)+MSK07W;  /* FORM OUTPUT EXIT LIST  */ 00293000
         LA    @15,RDJEXA                                          0176 00294000
         ALR   @15,@08                                             0176 00295000
         ST    @15,RDJXXL                                          0176 00296000
*           MAXLINP=ADDR(IDSLINS(10))+LENGTH(IDSLINS);     /* END    */ 00297000
         LA    @08,IDSLINS+972                                     0177 00298000
         AH    @08,@CH00551                                        0177 00299000
         ST    @08,MAXLINP                                         0177 00300000
*           LINPTR = MAXLINP;       /* SET INITIALIZATION FLAG       */ 00301000
         ST    @08,LINPTR                                          0178 00302000
*           IDSCT = 0;              /* NO USERIDS REFORMATTED YET    */ 00303000
*                                                                  0179 00304000
         SLR   @08,@08                                             0179 00305000
         STH   @08,IDSCT                                           0179 00306000
*           RESPECIFY (R14) RESTRICTED;                            0180 00307000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 00308000
         L     R14,SAVLNKA                                         0181 00309000
*           RETURN;                 /* RETURN                        */ 00310000
@EL00002 DS    0H                                                  0182 00311000
@EF00002 DS    0H                                                  0182 00312000
@ER00002 BR    @14                                                 0182 00313000
*/********************************************************************/ 00314000
*/*                                                                  */ 00315000
*/* SEGMENT NAME -- RSTAE                                            */ 00316000
*/*                                                                  */ 00317000
*/* DESCRIPTIVE NAME -- N/A                                          */ 00318000
*/*                                                                  */ 00319000
*/* FUNCTION -- ESTABLISH STAE EXIT ENVIRONMENT                      */ 00320000
*/*                                                                  */ 00321000
*/*   OPERATION --                                                   */ 00322000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 00323000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RSTAE FUNCTION   */ 00324000
*/*   -  BUILD STAE EXIT COMUNICATIONS PARAMETER LIST (STAEPL1) WITH */ 00325000
*/*      -  1ST CODE BASE POINTER (STAPRM1)                          */ 00326000
*/*      -  2ND CODE BASE POINTER (STAPRM2)                          */ 00327000
*/*      -  1ST REENTRANT DATA POINTER (STAPRM3)                     */ 00328000
*/*      -  2ND REENTRANT DATA POINTER (STAPRM4)                     */ 00329000
*/*   -  INITIALIZE STAE PARAMETER LIST (STAEL1)                     */ 00330000
*/*   -  EXECUTE STAE MACRO                                          */ 00331000
*/*   -  IF STAE RETURN CODE IS 0 (SUCCESSFUL STAE), SET STAE-IN-    */ 00332000
*/*      FORCE FLAG (STASET), RESTORE ENTRY REGISTER 14 AND RETURN   */ 00333000
*/*   -  IF STAE RETURN CODE IS 4 (INSUFFICIENT STORAGE SPACE) SET   */ 00334000
*/*      ERROR MESSAGE INDEX 1, ISSUE ERROR MESSAGE, SET TERMINA-    */ 00335000
*/*      TION FLAG (RFMQUIT) AND RETURN                              */ 00336000
*/*   -  IF ANY OTHER RETURN CODE, ISSUE UTILITY ERROR MESSAGE 9,    */ 00337000
*/*      SET TERMINATION FLAG AND RETURN                             */ 00338000
*/*                                                                  */ 00339000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 00340000
*/*                                                                  */ 00341000
*/* INPUT --                                                         */ 00342000
*/*   -  UADSREFM ENVIRONMENT                                        */ 00343000
*/*                                                                  */ 00344000
*/* OUTPUT --                                                        */ 00345000
*/*   -  STAE ACTIVE FLAG SET (STASET)                               */ 00346000
*/*                                                                  */ 00347000
*/* EXTERNAL REFERENCES -- STAE MACRO                                */ 00348000
*/*                                                                  */ 00349000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 00350000
*/*   CONDITIONS --                                                  */ 00351000
*/*   -  SUCCESSFUL STAE                                             */ 00352000
*/*   RETURN CODE -- N/A                                             */ 00353000
*/*                                                                  */ 00354000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 00355000
*/*   CONDITIONS --                                                  */ 00356000
*/*   -  UNSUCCESSFUL STAE (REFMQUIT FLAG SET)                       */ 00357000
*/*   RETURN CODE -- N/A                                             */ 00358000
*/*                                                                  */ 00359000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 00360000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 00361000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 00362000
*/*                                                                  */ 00363000
*/********************************************************************/ 00364000
*RSTAE:     /* ESTABLISH STAE ENVIRONMENT                            */ 00365000
*           ENTRY;                                                 0183 00366000
RSTAE    DS    0H                                                  0184 00367000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 00368000
         ST    R14,SAVLNKA                                         0184 00369000
*           RESPECIFY (R14) UNRESTRICTED;                          0185 00370000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 00371000
*             THEN                  /* NO,                           */ 00372000
         TM    QUITCHK,B'11100000'                                 0186 00373000
         BNZ   @RF00186                                            0186 00374000
*               DO;                                                0187 00375000
*                                                                  0187 00376000
*           RESPECIFY (R9,R10,R11,R12,R15) RESTRICTED;             0188 00377000
*           /* RESERVE CURRENT BASE POINTERS                         */ 00378000
*           STAPRM1 = R9;           /* SAVE IKJREF CODE BASE PTR     */ 00379000
         ST    R9,STAPRM1                                          0189 00380000
*           STAPRM2 = R10;          /*   AND 2ND CODE BASE PTR       */ 00381000
         ST    R10,STAPRM2                                         0190 00382000
*           STAPRM3 = R11;          /*   AND RENT DATA PTR           */ 00383000
         ST    R11,STAPRM3                                         0191 00384000
*           STAPRM4 = R12;          /*   AND 2ND RENT DATA PTR       */ 00385000
         ST    R12,STAPRM4                                         0192 00386000
*           RESPECIFY (R9,R10,R11,R12) UNRESTRICTED;               0193 00387000
*                                                                  0193 00388000
*           /* SET UP AND CREATE STAE CALL                           */ 00389000
*           GENERATE;                                              0194 00390000
*                                                                  0194 00391000
         MVC   STAEL1(STALNG),MSTAEL1 INITIALIZE STAE PARM LIST         00392000
         STAE  PARAM=STAEPL1,MF=(E,STAEL1)  SET ABEND EXIT              00393000
*           RESPECIFY (R14) RESTRICTED;                            0195 00394000
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */ 00395000
         ST    R15,RTNCODE                                         0196 00396000
*           RESPECIFY (R14) UNRESTRICTED;                          0197 00397000
*           IF RTNCODE ^= 0         /* CHK IF STAE SUCCESSFUL        */ 00398000
*             THEN                  /* NO,                           */ 00399000
         L     @14,RTNCODE                                         0198 00400000
         LTR   @14,@14                                             0198 00401000
         BZ    @RF00198                                            0198 00402000
*               DO;                                                0199 00403000
*                 IF RTNCODE = 4    /* CHK FOR LACK OF SPACE         */ 00404000
*                   THEN            /* YES,                          */ 00405000
         CH    @14,@CH00102                                        0200 00406000
         BNE   @RF00200                                            0200 00407000
*                     DO;                                          0201 00408000
*                       MSGNO = 1;  /* SET NOSPACE MESSAGE INDEX     */ 00409000
         MVC   MSGNO(2),@CH00032                                   0202 00410000
*                       CALL  MSGFNDR;  /* LOCATE TEXT               */ 00411000
         BAL   @14,MSGFNDR                                         0203 00412000
*                       CALL  FXPUTL; /* INITIALIZE  P B             */ 00413000
         BAL   @14,FXPUTL                                          0204 00414000
*                       CALL  DOPUTL; /* TO ISSUE PUTLINE            */ 00415000
         BAL   @14,DOPUTL                                          0205 00416000
*                     END;                                         0206 00417000
*                   ELSE            /* NO, NOT LACK OF SPACE         */ 00418000
*                     DO;                                          0207 00419000
         B     @RC00200                                            0207 00420000
@RF00200 DS    0H                                                  0208 00421000
*                       MSGNO = 9;  /* SET MESSAGE INDEX             */ 00422000
         MVC   MSGNO(2),@CH00033                                   0208 00423000
*                       SOFFS = 20;   /* SET INSERT OFFSET           */ 00424000
         MVC   SOFFS(2),@CH00351                                   0209 00425000
*                       CALL  SYSERRD;  /* ISSUE MESSAGE             */ 00426000
         BAL   @14,SYSERRD                                         0210 00427000
*                     END;                                         0211 00428000
*                 RFMQUIT = '1'B;   /* SET TERMINATE FLAG            */ 00429000
@RC00200 OI    RFMQUIT,B'01000000'                                 0212 00430000
*               END;                                               0213 00431000
*             ELSE                                                 0214 00432000
*               STASET = '1'B;      /* SET STAE ACTIVE FLAG          */ 00433000
*                                                                  0214 00434000
         B     @RC00198                                            0214 00435000
@RF00198 OI    STASET,B'00100000'                                  0214 00436000
*               END;                                               0215 00437000
@RC00198 DS    0H                                                  0216 00438000
*           RESPECIFY (R14) RESTRICTED;                            0216 00439000
@RF00186 DS    0H                                                  0217 00440000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 00441000
         L     R14,SAVLNKA                                         0217 00442000
*           RETURN;                 /* RETURN                        */ 00443000
         B     @EL00002                                            0218 00444000
*/********************************************************************/ 00445000
*/*                                                                  */ 00446000
*/* SEGMENT NAME -- RJFCB                                            */ 00447000
*/*                                                                  */ 00448000
*/* DESCRIPTIVE NAME -- N/A                                          */ 00449000
*/*                                                                  */ 00450000
*/* FUNCTION -- RDJFCB TO OBTAIN DATA SET DEFINITIONS                */ 00451000
*/*   OPERATION --                                                   */ 00452000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 00453000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RJFCB FUNCTION   */ 00454000
*/*   -  SET INPUT DCB POINTER (DCBNPTR) AND OUTPUT DCB POINTER      */ 00455000
*/*      (DCBXPTR) IN RDJFCB PARAMETER LIST (RDJLSTA)                */ 00456000
*/*   -  SET POINTER (RDJNPTR) TO JFCB AREA (RDJINA) FOR INPUT       */ 00457000
*/*   -  SET POINTER (RDJXPTR) TO JFCB AREA (RDJEXA) FOR OUTPUT      */ 00458000
*/*   -  SET POINTERS IN DCBS (DCBEXLST) TO JFCB AREAS               */ 00459000
*/*   -  EXECUTE RDJFCB MACRO                                        */ 00460000
*/*   -  IF THE INPUT UADS (SYSUADN) HAS NOT BEEN ALLOCATED (NAME=   */ 00461000
*/*      NULLFILE) ISSUE ERROR MESSAGE 10, SET TERMINATION FLAG      */ 00462000
*/*      (REFMQUIT), RESTORE ENTRY LINK REGISTER 14 AND RETURN.  IF  */ 00463000
*/*      SYSUADS HAS NOT BEEN ALLOCATED, ISSUE ERROR MESSAGE 11      */ 00464000
*/*   -  SET THE EQUIVALENCE FLAG (EQUIUAD) TO NON-IDENTICAL STATE   */ 00465000
*/*   -  COMPARE INPUT AND OUTPUT DATA SET ATTRIBUTES -- DSNAMES,    */ 00466000
*/*      NUMBER OF VOLUMES, VOLUME NAMES, RECORD FORMAT, BLOCK SIZE  */ 00467000
*/*   -  IF ALL ATTRIBUTES ARE IDENTICAL, SET EQUIVALENCE FLAG TO    */ 00468000
*/*      IDENTICAL STATE (1) AND SET DDNAME IN READ DIRECTORY DCB    */ 00469000
*/*      (RDIDCB) TO MATCH THAT IN OUTPUT DCB (REXDCB)               */ 00470000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 00471000
*/*                                                                  */ 00472000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 00473000
*/*                                                                  */ 00474000
*/* INPUT --                                                         */ 00475000
*/*   -  UADSREFM ENVIRONMENT                                        */ 00476000
*/*                                                                  */ 00477000
*/* OUTPUT --                                                        */ 00478000
*/*   -  JFCB IMAGES FOR SYSUADS AND SYSUADN                         */ 00479000
*/*   -  EQUIVALENCE FLAG (EQUIUAD) SET ON/OFF                       */ 00480000
*/*   -  DATA SET NAME FOR READ DIRECTORY DCB (RDIDCB) ESTABLISHED   */ 00481000
*/*                                                                  */ 00482000
*/* EXTERNAL REFERENCES -- RDJFCB MACRO                              */ 00483000
*/*                                                                  */ 00484000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 00485000
*/*   CONDITIONS --                                                  */ 00486000
*/*   -  SUCCESSFUL READ JFCB                                        */ 00487000
*/*   RETURN CODE -- N/A                                             */ 00488000
*/*                                                                  */ 00489000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 00490000
*/*   CONDITIONS --                                                  */ 00491000
*/*   -  READ JFCB FAILURE (RFMQUIT FLAG SET)                        */ 00492000
*/*   RETURN CODE -- N/A                                             */ 00493000
*/*                                                                  */ 00494000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 00495000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 00496000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 00497000
*/*                                                                  */ 00498000
*/********************************************************************/ 00499000
*RJFCB:     /* OBTAIN DATA SET DEFINITIONS                           */ 00500000
*           ENTRY;                                                 0219 00501000
RJFCB    DS    0H                                                  0220 00502000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 00503000
         ST    R14,SAVLNKA                                         0220 00504000
*           RESPECIFY (R14) UNRESTRICTED;                          0221 00505000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 00506000
*             THEN                  /* NO,                           */ 00507000
         TM    QUITCHK,B'11100000'                                 0222 00508000
         BNZ   @RF00222                                            0222 00509000
*               DO;                                                0223 00510000
*                                                                  0223 00511000
*           RDJA1NM = DCBNPTR;      /* RINDCB PTR IN RDJFCB PL       */ 00512000
         MVC   RDJA1NM(3),DCBNPTR+1                                0224 00513000
*           RDJA2NM = DCBXPTR;      /* REXDCB PTR IN RDJFCB PL       */ 00514000
         L     @14,DCBXPTR                                         0225 00515000
         ST    @14,@TF00001                                        0225 00516000
         MVC   RDJA2NM(3),@TF00001+1                               0225 00517000
*           RDJNPTR = ADDR(RDJINA); /* INPUT JFCB PTR                */ 00518000
         LA    @08,RDJINA                                          0226 00519000
         ST    @08,RDJNPTR                                         0226 00520000
*           RDJXPTR = ADDR(RDJEXA); /* OUTPUT JFCB PTR               */ 00521000
         LA    @07,RDJEXA                                          0227 00522000
         ST    @07,RDJXPTR                                         0227 00523000
*           DCBEXLST = RDJNPTR-4;   /* PTR TO IN-JFCB AREA           */ 00524000
         LA    @06,4                                               0228 00525000
         SLR   @08,@06                                             0228 00526000
         L     @01,DCBPTR                                          0228 00527000
         ST    @08,DCBEXLST(,@01)                                  0228 00528000
*           DCBXPTR->DCBEXLST=RDJXPTR-4;   /* OUT-JFCB AREA          */ 00529000
         SLR   @07,@06                                             0229 00530000
         ST    @07,DCBEXLST(,@14)                                  0229 00531000
*           GEN(RDJFCB  MF=(E,RDJLST));    /* DO RDJFCBS             */ 00532000
         RDJFCB  MF=(E,RDJLST)                                          00533000
*             IF JFCBDSNM(1:8) = 'NULLFILE'/* INPUT JFCB READ ?      */ 00534000
*                 | RDJXPTR->JFCBDSNM(1:8)='NULLFILE'/* OUTPUT ?     */ 00535000
*               THEN                /* NO,                           */ 00536000
         L     @14,JFCBPTR                                         0231 00537000
         CLC   JFCBDSNM(8,@14),@CC01862                            0231 00538000
         BE    @RT00231                                            0231 00539000
         L     @14,RDJXPTR                                         0231 00540000
         CLC   JFCBDSNM(8,@14),@CC01862                            0231 00541000
         BNE   @RF00231                                            0231 00542000
@RT00231 DS    0H                                                  0232 00543000
*                 DO;                                              0232 00544000
*                   IF JFCBDSNM(1:8)='NULLFILE'/* CHK SYSUADN        */ 00545000
*                     THEN          /* NO,                           */ 00546000
         L     @14,JFCBPTR                                         0233 00547000
         CLC   JFCBDSNM(8,@14),@CC01862                            0233 00548000
         BNE   @RF00233                                            0233 00549000
*                       DO;                                        0234 00550000
*                         MSGNO = 10;   /* SET MESSAGE INDEX         */ 00551000
         MVC   MSGNO(2),@CH00034                                   0235 00552000
*                         CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT     */ 00553000
         BAL   @14,MSGFNDR                                         0236 00554000
*                         CALL  FXPUTLM;  /* INITIALIZE PARM BLOCK   */ 00555000
         BAL   @14,FXPUTLM                                         0237 00556000
*                         CALL  DOPUTL;   /* ISSUE MESSAGE           */ 00557000
         BAL   @14,DOPUTL                                          0238 00558000
*                       END;                                       0239 00559000
*                   IF RDJXPTR->JFCBDSNM(1:8)='NULLFILE'/* SYSUADS   */ 00560000
*                     THEN          /* NO,                           */ 00561000
@RF00233 L     @14,RDJXPTR                                         0240 00562000
         CLC   JFCBDSNM(8,@14),@CC01862                            0240 00563000
         BNE   @RF00240                                            0240 00564000
*                       DO;                                        0241 00565000
*                         MSGNO = 11;   /* SET MESSAGE INDEX         */ 00566000
         MVC   MSGNO(2),@CH00035                                   0242 00567000
*                         CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT     */ 00568000
         BAL   @14,MSGFNDR                                         0243 00569000
*                         CALL  FXPUTLM;  /* INITIALIZE PARM BLOCK   */ 00570000
         BAL   @14,FXPUTLM                                         0244 00571000
*                         CALL  DOPUTL;   /* ISSUE MESSAGE           */ 00572000
         BAL   @14,DOPUTL                                          0245 00573000
*                       END;                                       0246 00574000
*                   RFMQUIT = '1'B; /* SET TERMINATE FLAG            */ 00575000
@RF00240 OI    RFMQUIT,B'01000000'                                 0247 00576000
*                 END;                                             0248 00577000
*               ELSE                /* JFCBS BOTH PRESENT            */ 00578000
*                 DO;                                              0249 00579000
         B     @RC00231                                            0249 00580000
@RF00231 DS    0H                                                  0250 00581000
*                   EQUIUAD = '0'B; /* SET NOT SAME FLAG             */ 00582000
         NI    EQUIUAD,B'10111111'                                 0250 00583000
*                   /* COMPARE CHARACTERISTICS OF DCBS               */ 00584000
*                   IF JFCBDSNM=RDJXPTR->JFCBDSNM     /* DSNAMES     */ 00585000
*                       & JFCBVOLS=RDJXPTR->JFCBVOLS  /* VNAMES      */ 00586000
*                     THEN          /* PERFECT COMPARE,              */ 00587000
         L     @14,JFCBPTR                                         0251 00588000
         L     @08,RDJXPTR                                         0251 00589000
         CLC   JFCBDSNM(44,@14),JFCBDSNM(@08)                      0251 00590000
         BNE   @RF00251                                            0251 00591000
         CLC   JFCBVOLS(30,@14),JFCBVOLS(@08)                      0251 00592000
         BNE   @RF00251                                            0251 00593000
*                       EQUIUAD='1'B; /* SET EQUIVALENCE FLAG        */ 00594000
         OI    EQUIUAD,B'01000000'                                 0252 00595000
*                 END;                                             0253 00596000
*                                                                  0253 00597000
@RF00251 DS    0H                                                  0254 00598000
*               END;                                               0254 00599000
@RC00231 DS    0H                                                  0255 00600000
*           RESPECIFY (R14) RESTRICTED;                            0255 00601000
@RF00222 DS    0H                                                  0256 00602000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 00603000
         L     R14,SAVLNKA                                         0256 00604000
*           RETURN;                 /* RETURN                        */ 00605000
         B     @EL00002                                            0257 00606000
*/********************************************************************/ 00607000
*/*                                                                  */ 00608000
*/* SEGMENT NAME -- ROPEN                                            */ 00609000
*/*                                                                  */ 00610000
*/* DESCRIPTIVE NAME -- N/A                                          */ 00611000
*/*                                                                  */ 00612000
*/* FUNCTION -- OPEN DCBS FOR READ, WRITE AND READ DIRECTORY         */ 00613000
*/*   OPERATION --                                                   */ 00614000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 00615000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP ROPEN FUNCTION   */ 00616000
*/*   -  SET ERROR MESSAGE 3 INDEX                                   */ 00617000
*/*   -  SET DCB POINTER (PPPPTR) TO DCB (RINDCB)                    */ 00618000
*/*   -  IF DATA SETS ARE IDENTICAL,  SET  REGISTER 1  TO POINT TO   */ 00619000
*/*      UPDAT-MODE PL (RUOPNL), EXECUTE OPEN MACRO (VIA SEGMENT     */ 00620000
*/*      OPENDCB),                                                   */ 00621000
*/*   -  IF DATA SETS ARE NOT IDENTICAL, SET  REGISTER 1 TO POINT    */ 00622000
*/*      TO OUTPUT MODE PL (RXOPNL), EXECUTE OPEN MACRO              */ 00623000
*/*   -  SET DCB POINTER (PPPPTR) TO DCB (REXDCB)                    */ 00624000
*/*   -  SET ERROR MESSAGE 4 INDEX                                   */ 00625000
*/*   -  SET REGISTER 1 TO  POINT TO OUTPUT-MODE PL (RXOPNL),        */ 00626000
*/*      EXECUTE OPEN MACRO                                          */ 00627000
*/*   -  SET DCB POINTER (PPPPTR) TO DIRECTORY DCB (RDIDCB),  SET    */ 00628000
*/*      ERROR MESSAGE 3 AND EXECUTE OPEN                            */ 00629000
*/*   -  CHECK (VIA SEGMENT DCBCHK) FOR BLOCKSIZE                    */ 00630000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 00631000
*/*                                                                  */ 00632000
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */ 00633000
*/*                                                                  */ 00634000
*/* INPUT --                                                         */ 00635000
*/*   -  UADSREFM ENVIRONMENT                                        */ 00636000
*/*                                                                  */ 00637000
*/* OUTPUT -- N/A                                                    */ 00638000
*/*                                                                  */ 00639000
*/* EXTERNAL REFERENCES -- N/A                                       */ 00640000
*/*                                                                  */ 00641000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 00642000
*/*   CONDITIONS --                                                  */ 00643000
*/*   -  SUCCESSFUL OPENS                                            */ 00644000
*/*   -  BLOCK SIZE ADEQUATE                                         */ 00645000
*/*   RETURN CODE -- N/A                                             */ 00646000
*/*                                                                  */ 00647000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 00648000
*/*   CONDITIONS -- N/A                                              */ 00649000
*/*   RETURN CODE -- N/A                                             */ 00650000
*/*                                                                  */ 00651000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 00652000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 00653000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 00654000
*/*                                                                  */ 00655000
*/********************************************************************/ 00656000
*ROPEN:     /* OPEN DCBS FOR READ, WRITE AND READ DIRECTORY          */ 00657000
*           ENTRY;                                                 0258 00658000
ROPEN    DS    0H                                                  0259 00659000
*           RESPECIFY (PPPPTR) RESTRICTED;  /* RESERVE POINTER       */ 00660000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 00661000
         ST    R14,SAVLNKA                                         0260 00662000
*           RESPECIFY (R14) UNRESTRICTED;                          0261 00663000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 00664000
*             THEN                  /* NO,                           */ 00665000
         TM    QUITCHK,B'11100000'                                 0262 00666000
         BNZ   @RF00262                                            0262 00667000
*               DO;                                                0263 00668000
*                                                                  0263 00669000
*           MSGNO = 3;              /* SET MESSAGE INDEX             */ 00670000
         LA    @14,3                                               0264 00671000
         STH   @14,MSGNO                                           0264 00672000
*           MSGN2 = 3;              /* SET RESERVE MESSAGE INDEX     */ 00673000
         STH   @14,MSGN2                                           0265 00674000
*           MSGN3 = 30;             /* SET RESERVE MESSAGE INDEX     */ 00675000
         MVC   MSGN3(2),@CH01172                                   0266 00676000
*           PPPPTR = ADDR(RINDCB);  /* SET DCB PTR FOR OPEN          */ 00677000
         LA    PPPPTR,RINDCB                                       0267 00678000
*           IF EQUIUAD = '1'B       /* CHK IF DCBS SAME              */ 00679000
*             THEN                  /* YES,                          */ 00680000
         TM    EQUIUAD,B'01000000'                                 0268 00681000
         BNO   @RF00268                                            0268 00682000
*               DO;                                                0269 00683000
*                 RESPECIFY (R1) RESTRICTED;                       0270 00684000
*                 R1 = ADDR(RUOPNL);  /* SET PTR TO OPEN PL          */ 00685000
         LA    R1,RUOPNL                                           0271 00686000
*                 CALL  OPENDCB;    /* TO OPEN SYSUADS FOR UPDAT     */ 00687000
         BAL   @14,OPENDCB                                         0272 00688000
*               END;                                               0273 00689000
*             ELSE                  /* DCBS NOT IDENTICAL            */ 00690000
*               DO;                                                0274 00691000
         B     @RC00268                                            0274 00692000
@RF00268 DS    0H                                                  0275 00693000
*                 R1 = ADDR(RNOPNL);  /* SET PTR TO OPEN PL          */ 00694000
         LA    R1,RNOPNL                                           0275 00695000
*                 RESPECIFY (R1) UNRESTRICTED;                     0276 00696000
*                 CALL  OPENDCB;    /* OPEN SYSUADN FOR INPUT/OUTPUT */ 00697000
         BAL   @14,OPENDCB                                         0277 00698000
*               END;                                               0278 00699000
*           PPPPTR = ADDR(REXDCB);  /* DCB PTR FOR OPEN              */ 00700000
@RC00268 LA    PPPPTR,REXDCB                                       0279 00701000
*           MSGNO = 4;              /* SET MESSAGE INDEX             */ 00702000
         LA    @14,4                                               0280 00703000
         STH   @14,MSGNO                                           0280 00704000
*           MSGN2 = 4;              /* SET RESERVE MESSAGE INDEX     */ 00705000
         STH   @14,MSGN2                                           0281 00706000
*           MSGN3 = 29;             /* SET RESERVE MESSAGE INDEX     */ 00707000
         MVC   MSGN3(2),@CH01868                                   0282 00708000
*           RESPECIFY (R1) RESTRICTED;                             0283 00709000
*           R1 = ADDR(RXOPNL);      /* SET PTR TO OPEN PL            */ 00710000
         LA    R1,RXOPNL                                           0284 00711000
*           CALL  OPENDCB;          /* TO OPEN SYSUADS FOR OUTPUT    */ 00712000
         BAL   @14,OPENDCB                                         0285 00713000
*           MSGNO = 3;              /* SET MESSAGE INDEX             */ 00714000
         LA    @14,3                                               0286 00715000
         STH   @14,MSGNO                                           0286 00716000
*           MSGN2 = 3;              /* SET RESERVE MESSAGE INDEX     */ 00717000
         STH   @14,MSGN2                                           0287 00718000
*           MSGN3 = 30;             /* SET RESERVE MESSAGE INDEX     */ 00719000
         MVC   MSGN3(2),@CH01172                                   0288 00720000
*           PPPPTR = ADDR(RDIDCB);  /* DCB PTR FOR OPEN              */ 00721000
         LA    PPPPTR,RDIDCB                                       0289 00722000
*           R1 = ADDR(RDOPNL);      /* SET PTR TO OPEN PL            */ 00723000
         LA    R1,RDOPNL                                           0290 00724000
*           RESPECIFY (R1) UNRESTRICTED;                           0291 00725000
*           CALL  OPENDCB;          /* TO OPEN SYSUADN FOR BSAM      */ 00726000
*                                                                  0292 00727000
         BAL   @14,OPENDCB                                         0292 00728000
*           CALL DCBCHK;            /* CHECK BLOCK SIZES             */ 00729000
*                                                                  0293 00730000
         BAL   @14,DCBCHK                                          0293 00731000
*               END;                                               0294 00732000
*           RESPECIFY (R14) RESTRICTED;                            0295 00733000
@RF00262 DS    0H                                                  0296 00734000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 00735000
         L     R14,SAVLNKA                                         0296 00736000
*           RESPECIFY  (PPPPTR) UNRESTRICTED;  /* FREE POINTER       */ 00737000
*           RETURN;                 /* RETURN                        */ 00738000
         B     @EL00002                                            0298 00739000
*/********************************************************************/ 00740000
*/*                                                                  */ 00741000
*/* SEGMENT NAME -- RENQU                                            */ 00742000
*/*                                                                  */ 00743000
*/* DESCRIPTIVE NAME -- N/A                                          */ 00744000
*/*                                                                  */ 00745000
*/* FUNCTION -- ENQUEUE (SHARED) ON SYSIKJUA/OPENUADS                */ 00746000
*/*   OPERATION --                                                   */ 00747000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 00748000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RENQU FUNCTION   */ 00749000
*/*   -  SET SET DO CONTROL (DOWHYLN) TO LOOP UNTIL ENQ SUCCEEDS     */ 00750000
*/*   -  SET REGISTER 1 TO POINT TO ENQ PL (NQOPN), EXECUTE ENQ      */ 00751000
*/*      MACRO                                                       */ 00752000
*/*   -  IF ENQ NOT SUCCESSFUL (REGISTER 15 NOT = 0), CHECK RC LIST  */ 00753000
*/*   -  IF LIST RC IS 0 OR 8, RESTORE ENTRY REGISTER 14 AND RETURN  */ 00754000
*/*   -  IF LIST RC IS 4, SET DOWHYLN TO GONTINUE ENQ DOWHILE LOOP   */ 00755000
*/*   -  IF ANY OTHER CODE, ISSUE ERROR MESSAGE 13, SET UADSREFM     */ 00756000
*/*      TERMINATION FLAG (RFMQUIT), RESTORE REGISTER 14 AND RETURN  */ 00757000
*/*                                                                  */ 00758000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 00759000
*/*                                                                  */ 00760000
*/* INPUT -- UADSREFM ENVIRONMENT                                    */ 00761000
*/*                                                                  */ 00762000
*/* OUTPUT -- N/A                                                    */ 00763000
*/*                                                                  */ 00764000
*/* EXTERNAL REFERENCES -- ENQ MACRO                                 */ 00765000
*/*                                                                  */ 00766000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 00767000
*/*   CONDITIONS --                                                  */ 00768000
*/*   -  SUCCESSFUL ENQ                                              */ 00769000
*/*   RETURN CODE -- N/A                                             */ 00770000
*/*                                                                  */ 00771000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 00772000
*/*   CONDITIONS --                                                  */ 00773000
*/*   -  ENQ FAILURE                                                 */ 00774000
*/*   RETURN CODE -- N/A                                             */ 00775000
*/*                                                                  */ 00776000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 00777000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 00778000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 00779000
*/*                                                                  */ 00780000
*/********************************************************************/ 00781000
*RENQU:     /* ENQUEUE ON UADS                                       */ 00782000
*           /* DEQUEUE AT RDEQU                                      */ 00783000
*           ENTRY;                                                 0299 00784000
RENQU    DS    0H                                                  0300 00785000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 00786000
         ST    R14,SAVLNKA                                         0300 00787000
*           RESPECIFY (R14) UNRESTRICTED;                          0301 00788000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 00789000
*             THEN                  /* NO,                           */ 00790000
         TM    QUITCHK,B'11100000'                                 0302 00791000
         BNZ   @RF00302                                            0302 00792000
*               DO;                                                0303 00793000
*                                                                  0303 00794000
*           RESPECIFY (R1,R15) RESTRICTED;                         0304 00795000
*           DO DOWHYLN = 1 TO 1;         /* UNTIL ENQUEUED SHARED    */ 00796000
         LA    @14,1                                               0305 00797000
         STH   @14,DOWHYLN                                         0305 00798000
@DL00305 DS    0H                                                  0306 00799000
*             R1 = ADDR(NQOPN);     /* PTR TO ENQ PARM LIST          */ 00800000
         LA    R1,NQOPN                                            0306 00801000
*             GEN(ENQ   ,MF=(E,(1)));  /* ISSUE ENQUEUE              */ 00802000
         ENQ   ,MF=(E,(1))                                              00803000
*             RTNCODE = R15;        /* RESERVE RETURN CODE           */ 00804000
         ST    R15,RTNCODE                                         0308 00805000
*             IF RTNCODE ^= 0       /* CHK FOR SATISFACTORY RET CODE */ 00806000
*               THEN                /* NO,                           */ 00807000
         L     @14,RTNCODE                                         0309 00808000
         SLR   @08,@08                                             0309 00809000
         CR    @14,@08                                             0309 00810000
         BE    @RF00309                                            0309 00811000
*                 DO;                                              0310 00812000
*                   RCPTR = RTNCODE;  /* LOCATE RETURN CODE          */ 00813000
         ST    @14,RCPTR                                           0311 00814000
*                   IF RCLC1^=0     /* CHK FOR UNSATISFACTORY        */ 00815000
*                       & RCLC1^=8  /*     RETURN CODE               */ 00816000
*                     THEN          /* YES,                          */ 00817000
         CLI   RCLC1(@14),0                                        0312 00818000
         BE    @RF00312                                            0312 00819000
         CLI   RCLC1(@14),8                                        0312 00820000
         BE    @RF00312                                            0312 00821000
*                       IF RCLC1 = 4   /* CHK NOT AVAILABLE          */ 00822000
*                         THEN      /* YES,                          */ 00823000
         CLI   RCLC1(@14),4                                        0313 00824000
         BNE   @RF00313                                            0313 00825000
*                           DOWHYLN = 0;  /* SET TO REPEAT           */ 00826000
         STH   @08,DOWHYLN                                         0314 00827000
*                         ELSE      /* UNKNOWN RETURN CODE           */ 00828000
*                           DO;                                    0315 00829000
         B     @RC00313                                            0315 00830000
@RF00313 DS    0H                                                  0316 00831000
*                             MSGNO = 13;     /* SET MESSAGE INDEX   */ 00832000
         MVC   MSGNO(2),@CH01676                                   0316 00833000
*                             SOFFS = 20;     /* SET INSERT OFFSET   */ 00834000
         MVC   SOFFS(2),@CH00351                                   0317 00835000
*                             CALL  SYSERRD;  /* ISSUE ERROR MSG     */ 00836000
         BAL   @14,SYSERRD                                         0318 00837000
*                             RFMQUIT = '1'B; /* SET TERMINATION FLG */ 00838000
         OI    RFMQUIT,B'01000000'                                 0319 00839000
*                           END;                                   0320 00840000
*                 END;                                             0321 00841000
@RC00313 DS    0H                                                  0321 00842000
@RF00312 DS    0H                                                  0322 00843000
*           END;                                                   0322 00844000
@RF00309 LA    @14,1                                               0322 00845000
         AH    @14,DOWHYLN                                         0322 00846000
         STH   @14,DOWHYLN                                         0322 00847000
         CH    @14,@CH00032                                        0322 00848000
         BNH   @DL00305                                            0322 00849000
*           RESPECIFY (R1,R15) UNRESTRICTED;                       0323 00850000
*                                                                  0323 00851000
*               END;                                               0324 00852000
*           RESPECIFY (R14) RESTRICTED;                            0325 00853000
@RF00302 DS    0H                                                  0326 00854000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 00855000
         L     R14,SAVLNKA                                         0326 00856000
*           RETURN;                 /* RETURN                        */ 00857000
         B     @EL00002                                            0327 00858000
*/********************************************************************/ 00859000
*/*                                                                  */ 00860000
*/* SEGMENT NAME -- RREAD                                            */ 00861000
*/*                                                                  */ 00862000
*/* DESCRIPTIVE NAME -- N/A                                          */ 00863000
*/*                                                                  */ 00864000
*/* FUNCTION -- LOCATE USERID IN UADS DIRECTORY AND READ MEMBER      */ 00865000
*/*   OPERATION --                                                   */ 00866000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 00867000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RREAD FUNCTION   */ 00868000
*/*   -  IF PRIME READ HAS NOT BEEN PROCESSED, PERFORM SEGMENT       */ 00869000
*/*      RDINIT TO OBTAIN 1ST USERID MEMBER                          */ 00870000
*/*   -  IF TERMINATION FLAG IN REFMECB IS ON, SET FLAG (RFMQUIT)    */ 00871000
*/*      ELSE, IF 1ST USERID MEMBER HAS BEEN READ AND PROCESSED,     */ 00872000
*/*      PERFORM SEGMENT DOWRT2 TO FREE THE READ BUFFER AREA         */ 00873000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS OFF, PERFORM SEGMENT RDNAM */ 00874000
*/*      TO EXTRACT CURRENT USERID NAME AND NAME LENGTH.  IF 1ST     */ 00875000
*/*      READ IS NOT NOW BEING PROCESSED AND STOW WAS PERFORMED FOR  */ 00876000
*/*      THE IMMEDIATELY PRIOR MEMBER, PERFORM SEGMENTS RDDIR AND    */ 00877000
*/*      RDLOCN TO OBTAIN THE DIRECTORY INFORMATION FOR THE CURRENT  */ 00878000
*/*      USERID, RESET STOW-PERFORMED FLAG (STODON), AND SET POINTER */ 00879000
*/*      (RWPNBP) TO CURRENT USERID NAME.  PERFORM SEGMENT DOREAD TO */ 00880000
*/*      TO OBTAIN CURRENT USERID MEMBER, AND SAVE THE NEXT USERID   */ 00881000
*/*      NAME (COMPNAM)                                              */ 00882000
*/*   -  CLEAR THE 1ST USERID-IN-PROCESS FLAG (RD1NOW)               */ 00883000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 00884000
*/*                                                                  */ 00885000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 00886000
*/*                                                                  */ 00887000
*/* INPUT --                                                         */ 00888000
*/*   -  UADSREFM ENVIRONMENT                                        */ 00889000
*/*                                                                  */ 00890000
*/* OUTPUT --                                                        */ 00891000
*/*   -  FIRST-MEMBER-PROCESSED FLAG SET (RDINTL)                    */ 00892000
*/*   -  STOW-PERFORMED FLAG RESET (STODON)                          */ 00893000
*/*   -  CURRENTLY-PROCESSING-1ST-USERID FLAG RESET (RD1NOW)         */ 00894000
*/*   -  NEXT USERID NAME SAVED (COMPNAM)                            */ 00895000
*/*                                                                  */ 00896000
*/* EXTERNAL REFERENCES -- N/A                                       */ 00897000
*/*                                                                  */ 00898000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 00899000
*/*   CONDITIONS --                                                  */ 00900000
*/*   -  NO READ PROCESSING FAILURE                                  */ 00901000
*/*   RETURN CODE -- N/A                                             */ 00902000
*/*                                                                  */ 00903000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 00904000
*/*   CONDITIONS --                                                  */ 00905000
*/*   -  FORCED TERMINATION (ECBCPL) (RFMQUIT FLAG SET)              */ 00906000
*/*   RETURN CODE -- N/A                                             */ 00907000
*/*                                                                  */ 00908000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 00909000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 00910000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 00911000
*/*                                                                  */ 00912000
*/********************************************************************/ 00913000
*RREAD:     ENTRY;  /* READ UADS MEMBER                              */ 00914000
RREAD    DS    0H                                                  0329 00915000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 00916000
         ST    R14,SAVLNKA                                         0329 00917000
*           RESPECIFY (R14) UNRESTRICTED;                          0330 00918000
*           IF QUITCHK = '000'B     /* CHK FOR TERMINATION FLAG ?    */ 00919000
*             THEN                  /* NONE,                         */ 00920000
         TM    QUITCHK,B'11100000'                                 0331 00921000
         BNZ   @RF00331                                            0331 00922000
*               DO;                                                0332 00923000
*           IF RDINTL = '0'B        /* CHK IF PRIME READ PROCESSED   */ 00924000
*             THEN                  /* NO,                           */ 00925000
         TM    RDINTL,B'00000010'                                  0333 00926000
         BNZ   @RF00333                                            0333 00927000
*               CALL  RDINIT;       /* TO PERFORM PRIME READ         */ 00928000
         BAL   @14,RDINIT                                          0334 00929000
*           IF ECBCPL = '1'B        /* CHK ECB COMPLETE FLAG         */ 00930000
*             THEN                  /* YES,                          */ 00931000
@RF00333 TM    ECBCPL,B'01000000'                                  0335 00932000
         BNO   @RF00335                                            0335 00933000
*               RFMQUIT = '1'B;     /* TERMINATE REFORM ACTIVITY     */ 00934000
         OI    RFMQUIT,B'01000000'                                 0336 00935000
*             ELSE                  /* NO, CONTINUE                  */ 00936000
*               DO;                                                0337 00937000
         B     @RC00335                                            0337 00938000
@RF00335 DS    0H                                                  0338 00939000
*                 IF RDDONE = '1'B  /* CHK FOR BUFFER-READ FLAG      */ 00940000
*                     & RDINTL = '1'B  /* AND 1ST READ PROCESSED     */ 00941000
*                   THEN            /* YES,                          */ 00942000
         TM    RDDONE,B'00000011'                                  0338 00943000
         BNO   @RF00338                                            0338 00944000
*                     DO;                                          0339 00945000
*                       RWPF5 = '0'B;  /* CLEAR WRITE FLAG           */ 00946000
         NI    RWPF5,B'11110111'                                   0340 00947000
*                       CALL  DOWRT2;  /* GO TO FREE BUFFER          */ 00948000
         BAL   @14,DOWRT2                                          0341 00949000
*                       RDDONE = '0'B; /* CLEAR READ DONE FLAG       */ 00950000
         NI    RDDONE,B'11111110'                                  0342 00951000
*                     END;                                         0343 00952000
*               END;                                               0344 00953000
@RF00338 DS    0H                                                  0345 00954000
*           IF QUITCHK = '000'B     /* CHK FOR TERMINATION FLAG ?    */ 00955000
*             THEN                  /* NONE,                         */ 00956000
@RC00335 TM    QUITCHK,B'11100000'                                 0345 00957000
         BNZ   @RF00345                                            0345 00958000
*               DO;                                                0346 00959000
*/*               NOTE -- THE FOLLOWING CODE-COMMENTS REPRESENT THE  */ 00960000
*/*               CODE INSERTION NEEDED IF SPECIFIC NAME(S) ABILITY  */ 00961000
*/*               PARAMETERS ARE ADDED TO UADSREFM INVOCATION        */ 00962000
*/*               IF DUCLSF1 = YES  /* CHK FOR ASTERISK FLAG         */ 00963000
*/*                 THEN            /* YES,                          */ 00964000
*                     CALL  RDNAM;  /* GET USERID NAME AND LENGTH    */ 00965000
         BAL   @14,RDNAM                                           0347 00966000
*                 IF RD1NOW = '0'B  /* CHK FOR 1ST USERID READ       */ 00967000
*                   THEN            /* NO, NOT 1ST READ NOW          */ 00968000
         TM    RD1NOW,B'01000000'                                  0348 00969000
         BNZ   @RF00348                                            0348 00970000
*                     DO;           /*                               */ 00971000
*                       START2=2;      /* INITIALIZE FOR SINGLE BSP  */ 00972000
         MVC   START2(2),@CH00099                                  0350 00973000
*                       IF STODON = '1'B /* CHK FOR STOW-DONE        */ 00974000
*                           & EQUIUAD = '1'B /*  AND IN UPDAT MODE   */ 00975000
*                         THEN      /* YES, LOCATE NEXT NAME         */ 00976000
         TM    STODON,B'10000000'                                  0351 00977000
         BNO   @RF00351                                            0351 00978000
         TM    EQUIUAD,B'01000000'                                 0351 00979000
         BNO   @RF00351                                            0351 00980000
*                           DO;                                    0352 00981000
*                             DO DOWHYL4=1 TO 1;         /* FIND     */ 00982000
         LA    @08,1                                               0353 00983000
         STH   @08,DOWHYL4                                         0353 00984000
@DL00353 DS    0H                                                  0354 00985000
*                               CALL  RDDIR;  /* GET DIRECTORY BLOCK */ 00986000
         BAL   @14,RDDIR                                           0354 00987000
*                               CALL  RDLOCN; /* CHK FOR NAME        */ 00988000
         BAL   @14,RDLOCN                                          0355 00989000
*                             END;                                 0356 00990000
         LA    @08,1                                               0356 00991000
         AH    @08,DOWHYL4                                         0356 00992000
         STH   @08,DOWHYL4                                         0356 00993000
         CH    @08,@CH00032                                        0356 00994000
         BNH   @DL00353                                            0356 00995000
*                             STODON='0'B; /* RESET REFORM-STOW FLAG */ 00996000
         NI    STODON,B'01111111'                                  0357 00997000
*                             RWPNBP=DIRBDAP; /* PTR TO CURRENT NAME */ 00998000
         MVC   RWPNBP(4),DIRBDAP                                   0358 00999000
*                           END;                                   0359 01000000
*                       CALL  DOREAD;  /* READ USERID MEMBER         */ 01001000
@RF00351 BAL   @14,DOREAD                                          0360 01002000
*                       COMPNAM = RDNAMC;  /* RESERVE NEXT NAME      */ 01003000
         L     @08,RWPNBP                                          0361 01004000
         MVC   COMPNAM(8),RDNAMC(@08)                              0361 01005000
*                     END;                                         0362 01006000
*                 RD1NOW = '0'B;    /* FIRST HAS BEEN READ           */ 01007000
@RF00348 NI    RD1NOW,B'10111111'                                  0363 01008000
*               END;                                               0364 01009000
*               END;                                               0365 01010000
@RF00345 DS    0H                                                  0366 01011000
*           RESPECIFY (R14) RESTRICTED;                            0366 01012000
@RF00331 DS    0H                                                  0367 01013000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 01014000
         L     R14,SAVLNKA                                         0367 01015000
*           RETURN;                 /* RETURN                        */ 01016000
         B     @EL00002                                            0368 01017000
*/********************************************************************/ 01018000
*/*                                                                  */ 01019000
*/* SEGMENT NAME -- RGMNEW                                           */ 01020000
*/*                                                                  */ 01021000
*/* DESCRIPTIVE NAME -- N/A                                          */ 01022000
*/*                                                                  */ 01023000
*/* FUNCTION -- OBTAIN STORAGE SPACE FOR REBUILD/WRITE BUFFER        */ 01024000
*/*   OPERATION --                                                   */ 01025000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 01026000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RGMNEW FUNCTION  */ 01027000
*/*   -  FIND NUMBER (NUMBLKS) OF OUTPUT MEMBER-BLOCKS (INPUT MEMBER */ 01028000
*/*      LENGTH + NEW HEADER SPACE DIVIDED BY OUTPUT BLOCK LENGTH)   */ 01029000
*/*   -  IF NUMBLKS IS LESS THAN 10, ADD 1 TO NUMBLKS AND SET EXTRA  */ 01030000
*/*      BLOCK SPACE FLAG (XTRBLK).  OTHERWISE, SET NUMBLKS TO 10    */ 01031000
*/*   -  FIND GETMAIN LENGTH (GMAINL) BY MULTIPLYING THE NUMBER OF   */ 01032000
*/*      BLOCK SPACES BY OUTPUT BLOCK LENGTH                         */ 01033000
*/*   -  SET POINTERS -- TO GETMAIN LENGTH (GMAINL) IN REGISTER 5,   */ 01034000
*/*      TO LOCATION OF RESPONSE AREA (GMAINP) IN REGISTER 6, TO     */ 01035000
*/*      POINTER TO GETMAIN PL (GMLST) IN REGISTER 1                 */ 01036000
*/*   -  EXECUTE GETMAIN MACRO                                       */ 01037000
*/*   -  IF GETMAIN RC WAS UNSUCCESSFUL, CHECK FLAG (XTRBLK).  IF    */ 01038000
*/*      EXTRA BLOCK WAS REQUESTED, RESET XTRBLK, REDUCE BLOCK COUNT */ 01039000
*/*      BY 1 (NUMBLKS) AND SET DOWHILE CONTROL FLAG (DOWHYLN) TO    */ 01040000
*/*      REPEAT GETMAIN REQUEST.  IF NO EXTRA BLOCK REQUEST, PERFORM */ 01041000
*/*      SEGMENT NOUSP TO ISSUE NO SPACE MESSAGE (SETS UIDQUIT FLAG) */ 01042000
*/*   -  IF GETMAIN SUCCEEDED, SET OUTPUT BUFFER POINTER (REXBUFP)   */ 01043000
*/*      TO GETMAIN LOCATION (GMAINP), AND SET CONTROLS FOR, AND     */ 01044000
*/*      PERFORM SEGMENT DOPSPAZ TO CLEAR THE GETMAIN AREA           */ 01045000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 01046000
*/*                                                                  */ 01047000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 01048000
*/*                                                                  */ 01049000
*/* INPUT --                                                         */ 01050000
*/*   -  UADSREFM ENVIRONMENT                                        */ 01051000
*/*   -  LENGTH OF INPUT MEMBER READ-IN (OLRDBUFL)                   */ 01052000
*/*                                                                  */ 01053000
*/* OUTPUT --                                                        */ 01054000
*/*   -  CLEARED BUFFER AREA LOCATED BY POINTER (REXBUFP)            */ 01055000
*/*   -  LENGTH OF BUFFER (GMAINL)                                   */ 01056000
*/*   -  EXTRA-BLOCK-SPACE FLAG (XTRBLK) SET ON/OFF                  */ 01057000
*/*   -  NUMBER OF OUTPUT BLOCKS (NUMBLKS)                           */ 01058000
*/*                                                                  */ 01059000
*/* EXTERNAL REFERENCES -- GETMAIN MACRO                             */ 01060000
*/*                                                                  */ 01061000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 01062000
*/*   CONDITIONS --                                                  */ 01063000
*/*   -  SUCCESSFUL GETMAIN                                          */ 01064000
*/*                                                                  */ 01065000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 01066000
*/*   CONDITIONS -- N/A                                              */ 01067000
*/*                                                                  */ 01068000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 01069000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 01070000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 01071000
*/*                                                                  */ 01072000
*/********************************************************************/ 01073000
*RGMNEW:    ENTRY;                  /* GET SPACE FOR WRITE BUFFER    */ 01074000
RGMNEW   DS    0H                                                  0370 01075000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 01076000
         ST    R14,SAVLNKA                                         0370 01077000
*           IF QUITCHK = '000'B     /* CHK FOR TERMINATION FLAG ?    */ 01078000
*             THEN                  /* NONE,                         */ 01079000
         TM    QUITCHK,B'11100000'                                 0371 01080000
         BNZ   @RF00371                                            0371 01081000
*               DO;                                                0372 01082000
*           XTRBLK = '0'B;          /* RESET EXTRA BLOCK FLAG        */ 01083000
         NI    XTRBLK,B'11101111'                                  0373 01084000
*           NUMBLKS = (OLRDBUFL+HDRDIF)  /* FIND REQUIRED NUMBER     */ 01085000
*               /DCBXPTR->DCBBLKSI; /*          OF BLOCKS            */ 01086000
         SLR   @15,@15                                             0374 01087000
         IC    @15,HDRDIF                                          0374 01088000
         AL    @15,OLRDBUFL                                        0374 01089000
         LR    @00,@15                                             0374 01090000
         SRDA  @00,32                                              0374 01091000
         L     @15,DCBXPTR                                         0374 01092000
         LH    @15,DCBBLKSI(,@15)                                  0374 01093000
         DR    @00,@15                                             0374 01094000
         STH   @01,NUMBLKS                                         0374 01095000
*           IF NUMBLKS < 10         /* CHK FOR LESS THAN 10          */ 01096000
*             THEN                  /* YES,                          */ 01097000
         CH    @01,@CH00034                                        0375 01098000
         BNL   @RF00375                                            0375 01099000
*               DO;                                                0376 01100000
*                 NUMBLKS=NUMBLKS+1; /* PROVIDE EXPANSION SPACE      */ 01101000
         LA    @01,1(,@01)                                         0377 01102000
         STH   @01,NUMBLKS                                         0377 01103000
*                 XTRBLK = '1'B;    /* SET EXTRA BLOCK FLAG          */ 01104000
         OI    XTRBLK,B'00010000'                                  0378 01105000
*               END;                                               0379 01106000
*             ELSE                  /* BLOCK NUMBER NOT LESS THAN 10 */ 01107000
*               NUMBLKS = 10;       /* SET MAXIMUM BLOCK COUNT       */ 01108000
         B     @RC00375                                            0380 01109000
@RF00375 MVC   NUMBLKS(2),@CH00034                                 0380 01110000
*           DO DOWHYLN = 1 TO 1;         /* ESTABLISH GETMAIN        */ 01111000
@RC00375 LA    @15,1                                               0381 01112000
         STH   @15,DOWHYLN                                         0381 01113000
@DL00381 DS    0H                                                  0382 01114000
*             RESPECIFY (R5,R6,R15) RESTRICTED;                    0382 01115000
*             GMAINL=NUMBLKS*DCBXPTR->DCBBLKSI; /* GETMAIN LNG       */ 01116000
         LH    @08,NUMBLKS                                         0383 01117000
         L     @07,DCBXPTR                                         0383 01118000
         MH    @08,DCBBLKSI(,@07)                                  0383 01119000
         ST    @08,GMAINL                                          0383 01120000
*             R5 = GMAINL;          /* SET LENGTH PTR                */ 01121000
         LR    R5,@08                                              0384 01122000
*             R6 = ADDR(GMAINP);    /* SET LOCATION PTR              */ 01123000
         LA    R6,GMAINP                                           0385 01124000
*             GEN(LA    R3,&SUBPN         SET SUBPOOL NUMBER);     0386 01125000
         LA    R3,&SUBPN         SET SUBPOOL NUMBER                     01126000
*             GEN(LA    R1,GMLST          SET PTR TO PL);          0387 01127000
         LA    R1,GMLST          SET PTR TO PL                          01128000
*             GEN(GETMAIN  EC,LV=(R5),A=(R6),SP=(R3),MF=(E,(1)));  0388 01129000
         GETMAIN  EC,LV=(R5),A=(R6),SP=(R3),MF=(E,(1))                  01130000
*             RTNCODE = R15;        /* RESERVE RETURN CODE           */ 01131000
         ST    R15,RTNCODE                                         0389 01132000
*             RESPECIFY (R5,R6,R15) UNRESTRICTED;                  0390 01133000
*               IF RTNCODE ^= 0     /* CHK FOR SUCCESS               */ 01134000
*                 THEN              /* NO,                           */ 01135000
         L     @15,RTNCODE                                         0391 01136000
         SLR   @08,@08                                             0391 01137000
         CR    @15,@08                                             0391 01138000
         BE    @RF00391                                            0391 01139000
*                   DO;                                            0392 01140000
*                     IF XTRBLK = '1'B /* CHK IF EXTRA BLOCK CALLED  */ 01141000
*                       THEN        /* YES,                          */ 01142000
         TM    XTRBLK,B'00010000'                                  0393 01143000
         BNO   @RF00393                                            0393 01144000
*                         DO;                                      0394 01145000
*                           XTRBLK = '0'B;/* CLEAR BLOCK FLAG        */ 01146000
         NI    XTRBLK,B'11101111'                                  0395 01147000
*                           NUMBLKS = NUMBLKS-1;   /* SET MINIMUM CT */ 01148000
         LH    @15,NUMBLKS                                         0396 01149000
         BCTR  @15,0                                               0396 01150000
         STH   @15,NUMBLKS                                         0396 01151000
*                           DOWHYLN = 0;   /* TO TRY AGAIN           */ 01152000
         STH   @08,DOWHYLN                                         0397 01153000
*                         END;                                     0398 01154000
*                       ELSE        /* NO SPACE FOR RETRY            */ 01155000
*                         CALL  NOUSP;  /* NO USERID SPACE MESSAGE   */ 01156000
         B     @RC00393                                            0399 01157000
@RF00393 BAL   @14,NOUSP                                           0399 01158000
*                   END;                                           0400 01159000
*                 ELSE              /* GETMAIN WAS SUCCESSFUL,       */ 01160000
*                   DO;                                            0401 01161000
         B     @RC00391                                            0401 01162000
@RF00391 DS    0H                                                  0402 01163000
*                     REXBUFP = GMAINP; /* SET UP BUFFER PTR         */ 01164000
         L     @15,GMAINP                                          0402 01165000
         ST    @15,REXBUFP                                         0402 01166000
*                     RESPECIFY  (RSPZOP,RLNG,RFROM,RTO) RESTRICTED;    01167000
*                     RSPZOP=ADDR(XCOP);  /* PTR TO CLEAR SPACE OP   */ 01168000
         LA    RSPZOP,XCOP                                         0404 01169000
*                     RLNG = GMAINL;  /* SET SPACE LENGTH            */ 01170000
         L     RLNG,GMAINL                                         0405 01171000
*                     RFROM = GMAINP;  /* SET FROM LOCATION          */ 01172000
         LR    RFROM,@15                                           0406 01173000
*                     RTO = RFROM;  /* SET TO LOCATION               */ 01174000
         LR    RTO,RFROM                                           0407 01175000
*                     CALL  DOPSPAZ;  /* TO CLEAR GETMAIN AREA       */ 01176000
         BAL   @14,DOPSPAZ                                         0408 01177000
*                     RESPECIFY (RSPZOP,RLNG,RFROM,RTO) UNRESTRICTED;   01178000
*                   END;                                           0410 01179000
*           END;                                                   0411 01180000
@RC00391 LA    @15,1                                               0411 01181000
         AH    @15,DOWHYLN                                         0411 01182000
         STH   @15,DOWHYLN                                         0411 01183000
         CH    @15,@CH00032                                        0411 01184000
         BNH   @DL00381                                            0411 01185000
*               END;                                               0412 01186000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 01187000
@RF00371 L     R14,SAVLNKA                                         0413 01188000
*           RETURN;                 /* RETURN                        */ 01189000
         B     @EL00002                                            0414 01190000
*/********************************************************************/ 01191000
*/*                                                                  */ 01192000
*/* SEGMENT NAME -- RBLDHDR                                          */ 01193000
*/*                                                                  */ 01194000
*/* DESCRIPTIVE NAME -- N/A                                          */ 01195000
*/*                                                                  */ 01196000
*/* FUNCTION -- BUILD NEW HEADER BLOCK IN OUTPUT BUFFER              */ 01197000
*/*   OPERATION --                                                   */ 01198000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 01199000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RBLDHDR FUNCTION */ 01200000
*/*   -  CLEAR  STORAGE SPACE  FOR BOTH INPUT (OLRPL)  AND OUTPUT    */ 01201000
*/*      (NLRPL) REBUILD-STRUCTURE CONTROL BLOCKS                    */ 01202000
*/*   -  CLEAR MODE-OF-OPERATION FLAGS (OPMODE)                      */ 01203000
*/*   -  SET TSO MODE FLAG (TSONOW)                                  */ 01204000
*/*   -  PERFORM SEGMENT FNDTREE TO IDENTIFY AND LOCATE ORIGIN OF    */ 01205000
*/*      STRUCTURE TO BE PROCESSED (TSO-TYPE FIRST)                  */ 01206000
*/*   -  COPY BASIC HEADER AREA FROM INPUT MEMBER.  IF INPUT MEMBER  */ 01207000
*/*      IS NEW=TYPE FORMAT, COPY HEADER AREA EXTENSION FROM INPUT   */ 01208000
*/*      MEMBER.  OTHERWISE, INITIALIZE HEADER EXTENSION TO DEFAULT  */ 01209000
*/*   -  INITIALIZE HEADER(S) IN ANY ADDITIONAL EXTENT BLOCK(S)      */ 01210000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 01211000
*/*                                                                  */ 01212000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEDO, LINKED BY REGISTER 14)      */ 01213000
*/*                                                                  */ 01214000
*/* INPUT --                                                         */ 01215000
*/*   -  UADSREFM ENVIRONMENT                                        */ 01216000
*/*   -  INPUT MEMBER HEADER BLOCK POINTER (RINBUFP)                 */ 01217000
*/*   -  INPUT DIRECTORY BLOCK POINTER (CURDIRP)                     */ 01218000
*/*   -  OUTPUT MEMBER HEADER BLOCK POINTER (REXBUFP)                */ 01219000
*/*                                                                  */ 01220000
*/* OUTPUT --                                                        */ 01221000
*/*   -  REVISED HEADER BLOCK IN OUTPUT BUFFER (REXBUF)              */ 01222000
*/*                                                                  */ 01223000
*/* EXTERNAL REFERENCES -- N/A                                       */ 01224000
*/*                                                                  */ 01225000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 01226000
*/*   CONDITIONS -- N/A                                              */ 01227000
*/*                                                                  */ 01228000
*/* EXIT-ERROR --                                                    */ 01229000
*/*   CONDITIONS -- N/A                                              */ 01230000
*/*                                                                  */ 01231000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 01232000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 01233000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 01234000
*/*                                                                  */ 01235000
*/********************************************************************/ 01236000
*RBLDHDR:   /* BUILD NEW HEADER BLOCK(S)                             */ 01237000
*           ENTRY;                                                 0415 01238000
RBLDHDR  DS    0H                                                  0416 01239000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 01240000
         ST    R14,SAVLNKA                                         0416 01241000
*           RESPECIFY (R14) UNRESTRICTED;                          0417 01242000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 01243000
*             THEN                  /* NO,                           */ 01244000
         TM    QUITCHK,B'11100000'                                 0418 01245000
         BNZ   @RF00418                                            0418 01246000
*               DO;                                                0419 01247000
*                                                                  0419 01248000
*           OLRPL = OLRPL&&OLRPL;   /* CLEAR OLD RPL                 */ 01249000
         XC    OLRPL(121),OLRPL                                    0420 01250000
*           NLRPL = NLRPL&&NLRPL;   /* CLEAR NEW RPL                 */ 01251000
         XC    NLRPL(121),NLRPL                                    0421 01252000
*           OPMODE = '000'B;        /* RESET MODE FLAGS              */ 01253000
         NI    OPMODE,B'11000000'                                  0422 01254000
*           TSONOW = '1'B;          /* SET TSO FLAG                  */ 01255000
         OI    TSONOW,B'00100000'                                  0423 01256000
*           CALL  FNDTREE;          /* TO LOCATE CURRENT STRUCTURE   */ 01257000
*                                                                  0424 01258000
         BAL   @14,FNDTREE                                         0424 01259000
*           NUBASHD=OLBASHD;        /* SET BASIC HDR AREA            */ 01260000
         L     @08,REXBUFP                                         0425 01261000
         L     @15,RINBUFP                                         0425 01262000
         MVC   NUBASHD(28,@08),OLBASHD(@15)                        0425 01263000
*           IF RINBUFP->UADSEXPF='1'B /* CHK FOR NEW TYPE INPUT      */ 01264000
*             THEN                  /* YES,                          */ 01265000
         TM    UADSEXPF(@15),B'01000000'                           0426 01266000
         BNO   @RF00426                                            0426 01267000
*               NUEXTHD=OLEXTHD;    /* COPY INPUT HDR EXTENSION      */ 01268000
         MVC   NUEXTHD(36,@08),OLEXTHD(@15)                        0427 01269000
*             ELSE                  /* NOT NEW TYPE INPUT            */ 01270000
*               NUEXTHD=MEXTHD;     /* SET EXTENSION FROM MODEL      */ 01271000
*                                                                  0428 01272000
         B     @RC00426                                            0428 01273000
@RF00426 L     @08,REXBUFP                                         0428 01274000
         MVC   NUEXTHD(36,@08),MEXTHD                              0428 01275000
*           IDINCB = NUMBLKS;       /* SET TO MASTER HEADER BLOCK    */ 01276000
@RC00426 MVC   IDINCB(2),NUMBLKS                                   0429 01277000
*           HEDBPTR = REXBUFP;      /* SET MASK TO OUTPUT BUFFER     */ 01278000
         MVC   HEDBPTR(4),REXBUFP                                  0430 01279000
*           DO WHILE IDINCB>0;      /* LOOP THROUGH EXTENTS, IF ANY  */ 01280000
         B     @DE00431                                            0431 01281000
@DL00431 DS    0H                                                  0432 01282000
*             UADSBLNG=DCBXPTR->DCBBLKSI;  /* OUTPUT BLK LNG         */ 01283000
         L     @08,HEDBPTR                                         0432 01284000
         L     @01,DCBXPTR                                         0432 01285000
         MVC   UADSBLNG(2,@08),DCBBLKSI(@01)                       0432 01286000
*             IF IDINCB = NUMBLKS   /* MASTER HEADER BLOCK ?         */ 01287000
*               THEN                /* YES,                          */ 01288000
         CLC   IDINCB(2),NUMBLKS                                   0433 01289000
         BNE   @RF00433                                            0433 01290000
*                 DO;               /* INITIALIZE MASTER HEADER BLK  */ 01291000
*                   UADSEXPF = '1'B;/* SET NEW FORMAT FLAG           */ 01292000
         OI    UADSEXPF(@08),B'01000000'                           0435 01293000
*                   UADSFSQP=(LENGTH(DHED)+3)&RNDDWN;  /* OFFSET     */ 01294000
         MVC   @ZT00002+2(2),RNDDWN                                0436 01295000
         L     @15,@ZT00002                                        0436 01296000
         N     @15,@CF02068                                        0436 01297000
         STH   @15,UADSFSQP(,@08)                                  0436 01298000
*                 END;                                             0437 01299000
*               ELSE                /* NO, IS EXTENT BLOCK           */ 01300000
*                 DO;               /* INITIALIZE EXTENT HEADER BLK  */ 01301000
         B     @RC00433                                            0438 01302000
@RF00433 DS    0H                                                  0439 01303000
*                   UADSFSQP=(LENGTH(UADSMHDR)+3)&RNDDWN;  /* OFFSET */ 01304000
         L     @08,HEDBPTR                                         0439 01305000
         MVC   @ZT00002+2(2),RNDDWN                                0439 01306000
         L     @15,@ZT00002                                        0439 01307000
         N     @15,@CF02026                                        0439 01308000
         STH   @15,UADSFSQP(,@08)                                  0439 01309000
*                   UADSUSER = REXBUFP->UADSUSER;  /* USERID         */ 01310000
         L     @01,REXBUFP                                         0440 01311000
         MVC   UADSUSER(8,@08),UADSUSER(@01)                       0440 01312000
*                   UADSUSER(NODIDL+1)=(NUMBLKS-IDINCB)|'0';   /* N  */ 01313000
         LH    @01,NODIDL                                          0441 01314000
         LH    @00,NUMBLKS                                         0441 01315000
         SH    @00,IDINCB                                          0441 01316000
         O     @00,@CF01890                                        0441 01317000
         STC   @00,UADSUSER(@01,@08)                               0441 01318000
*                 END;                                             0442 01319000
*             UADSNUSP = '0'B;      /* SET USABLE SPACE LEFT FLAG    */ 01320000
@RC00433 L     @08,HEDBPTR                                         0443 01321000
         NI    UADSNUSP(@08),B'01111111'                           0443 01322000
*             FSQEPTR=HEDBPTR+UADSFSQP;  /* PTR TO 1ST FSQE          */ 01323000
         LH    @15,UADSFSQP(,@08)                                  0444 01324000
         LR    @14,@08                                             0444 01325000
         ALR   @14,@15                                             0444 01326000
         ST    @14,FSQEPTR                                         0444 01327000
*             FSQELNTH=UADSBLNG-UADSFSQP;  /* LENGTH OF SPACE        */ 01328000
         LH    @07,UADSBLNG(,@08)                                  0445 01329000
         LCR   @15,@15                                             0445 01330000
         ALR   @15,@07                                             0445 01331000
         STH   @15,FSQELNTH(,@14)                                  0445 01332000
*             FSQENEXT = 0;         /* INDICATE 1ST FSQE             */ 01333000
         SLR   @15,@15                                             0446 01334000
         STH   @15,FSQENEXT(,@14)                                  0446 01335000
*             SVFSQEP = FSQEPTR;    /* SET RESERVE PTR               */ 01336000
         ST    @14,SVFSQEP                                         0447 01337000
*             SVFSQEL = FSQEPTR->CURFSQL;   /* RESERVE TEXT LENGTH   */ 01338000
         MVC   SVFSQEL(2),CURFSQL(@14)                             0448 01339000
*             HEDBPTR=HEDBPTR+UADSBLNG;  /* STEP TO NEXT BLOCK       */ 01340000
         ALR   @08,@07                                             0449 01341000
         ST    @08,HEDBPTR                                         0449 01342000
*             IDINCB = IDINCB-1;    /* DECREMENT EXTENT COUNTER      */ 01343000
         LH    @08,IDINCB                                          0450 01344000
         BCTR  @08,0                                               0450 01345000
         STH   @08,IDINCB                                          0450 01346000
*           END;                                                   0451 01347000
@DE00431 LH    @08,IDINCB                                          0451 01348000
         LTR   @08,@08                                             0451 01349000
         BP    @DL00431                                            0451 01350000
*           HEDBPTR = RINBUFP;      /* RESTORE MASK TO INPUT BUFFER  */ 01351000
*                                                                  0452 01352000
         MVC   HEDBPTR(4),RINBUFP                                  0452 01353000
*               END;                                               0453 01354000
*           RESPECIFY (R14) RESTRICTED;                            0454 01355000
@RF00418 DS    0H                                                  0455 01356000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 01357000
         L     R14,SAVLNKA                                         0455 01358000
*           RETURN;                 /* RETURN                        */ 01359000
         B     @EL00002                                            0456 01360000
*/********************************************************************/ 01361000
*/*                                                                  */ 01362000
*/* SEGMENT NAME -- RBLDMBR                                          */ 01363000
*/*                                                                  */ 01364000
*/* DESCRIPTIVE NAME -- N/A                                          */ 01365000
*/*                                                                  */ 01366000
*/* FUNCTION -- BUILD NEW USERID MEMBER IN OUTPUT BUFFER             */ 01367000
*/*   OPERATION --                                                   */ 01368000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 01369000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RBLDMBR FUNCTION */ 01370000
*/*   -  PERFORM SEGMENT RBLDIN TO INITIALIZE REBUILDING CONTROL     */ 01371000
*/*      TABLES AND POINTERS, TO LOCATE SPACE FOR THE USER  PROFILE  */ 01372000
*/*      TABLE (UPT) AND TO SET THE INITIAL FREE SPACE QUEUE ELEMENT */ 01373000
*/*   -  INITIALIZE THE DYNAMIC 3-LEVEL MASKS AT THE USERID LEVEL    */ 01374000
*/*      FOR INPUT (OUOFFS) AND FOR OUTPUT (NUOFFS)) OF THE REBUILD- */ 01375000
*/*      DATA CONTROL TABLES (INPUT (OLRPL) AND OUTPUT (NLRPL))      */ 01376000
*/*   -  PERFORM SEGMENTS RITEM (TO REBUILD ONE COMPLETE AUTHORIZA-  */ 01377000
*/*      TION PATH) AND ADJLVL (TO FIND THE NEXT LEVEL TO REBUILD)   */ 01378000
*/*   -  WHEN RITEM AND ADJLVL HAVE COMPLETED 1 HIERARCHICAL STRUC-  */ 01379000
*/*      TURE, THE MODE FLAG (TSONOW) IS RESET                       */ 01380000
*/*   -  PERFORM SEGMENT FNDTREE TO LOCATE ANY FURTHER STRUCTURE TO  */ 01381000
*/*      REBUILD.  IF ANY FURTHER STRUCTURE EXISTS, DOWHYLT LOOP     */ 01382000
*/*      REPEATS THE RBLDMBR FUNCTION                                */ 01383000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 01384000
*/*                                                                  */ 01385000
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */ 01386000
*/*                                                                  */ 01387000
*/* INPUT --                                                         */ 01388000
*/*   -  UADSREFM ENVIRONMENT                                        */ 01389000
*/*                                                                  */ 01390000
*/* OUTPUT --                                                        */ 01391000
*/*   -  REVISED MEMBER IN OUTPUT BUFFER (REXBUF)                    */ 01392000
*/*                                                                  */ 01393000
*/* EXTERNAL REFERENCES -- N/A                                       */ 01394000
*/*                                                                  */ 01395000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 01396000
*/*   CONDITIONS -- N/A                                              */ 01397000
*/*   RETURN CODE -- N/A                                             */ 01398000
*/*                                                                  */ 01399000
*/* EXIT-ERROR --                                                    */ 01400000
*/*   CONDITIONS -- N/A                                              */ 01401000
*/*   RETURN CODE -- N/A                                             */ 01402000
*/*                                                                  */ 01403000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 01404000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 01405000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 01406000
*/*                                                                  */ 01407000
*/********************************************************************/ 01408000
*RBLDMBR:   /* BUILD NEW USERID MEMBER                               */ 01409000
*           ENTRY;                                                 0457 01410000
RBLDMBR  DS    0H                                                  0458 01411000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 01412000
         ST    R14,SAVLNKA                                         0458 01413000
*           RESPECIFY (R14) UNRESTRICTED;                          0459 01414000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG  ?       */ 01415000
*             THEN                  /* NO,                           */ 01416000
         TM    QUITCHK,B'11100000'                                 0460 01417000
         BNZ   @RF00460                                            0460 01418000
*               DO;                                                0461 01419000
*                                                                  0461 01420000
*           CALL  RBLDIN;           /* GO TO SET UP MEMBER SCAN      */ 01421000
         BAL   @14,RBLDIN                                          0462 01422000
*           DO DOWHYLT=1 TO 1;         /* REFORM ALL TREES           */ 01423000
         LA    @08,1                                               0463 01424000
         STH   @08,DOWHYLT                                         0463 01425000
@DL00463 DS    0H                                                  0464 01426000
*             ONMIDP = ADDR(OUOFFS);   /* OLD DYNAMIC MASK           */ 01427000
         LA    @08,OUOFFS                                          0464 01428000
         ST    @08,ONMIDP                                          0464 01429000
*             NNMIDP = ADDR(NUOFFS);   /* NEW DYNAMIC MASK           */ 01430000
*                                                                  0465 01431000
         LA    @08,NUOFFS                                          0465 01432000
         ST    @08,NNMIDP                                          0465 01433000
*             DO DOWHYL=1 TO 1;          /* REFORM ONE TREE          */ 01434000
         LA    @08,1                                               0466 01435000
         STH   @08,DOWHYL                                          0466 01436000
@DL00466 DS    0H                                                  0467 01437000
*               CALL  RITEM;        /* REFORM ONE PATH               */ 01438000
         BAL   @14,RITEM                                           0467 01439000
*               CALL  ADJLVL;       /* SET REFORM POINT LEVEL        */ 01440000
         BAL   @14,ADJLVL                                          0468 01441000
*             END;                                                 0469 01442000
*                                                                  0469 01443000
         LA    @08,1                                               0469 01444000
         AH    @08,DOWHYL                                          0469 01445000
         STH   @08,DOWHYL                                          0469 01446000
         CH    @08,@CH00032                                        0469 01447000
         BNH   @DL00466                                            0469 01448000
*             IF TSONOW = '1'B      /* CHK IF TSO TREE JUST DONE     */ 01449000
*               THEN                /* YES,                          */ 01450000
         TM    TSONOW,B'00100000'                                  0470 01451000
         BNO   @RF00470                                            0470 01452000
*                 TSONOW = '0'B;    /* CLEAR TSO TREE FLAG           */ 01453000
         NI    TSONOW,B'11011111'                                  0471 01454000
*             CALL  FNDTREE;        /* CHK FOR MORE TREES TO REFORM  */ 01455000
@RF00470 BAL   @14,FNDTREE                                         0472 01456000
*           END;                                                   0473 01457000
*                                                                  0473 01458000
         LA    @08,1                                               0473 01459000
         AH    @08,DOWHYLT                                         0473 01460000
         STH   @08,DOWHYLT                                         0473 01461000
         CH    @08,@CH00032                                        0473 01462000
         BNH   @DL00463                                            0473 01463000
*               END;                                               0474 01464000
*           RESPECIFY (R14) RESTRICTED;                            0475 01465000
@RF00460 DS    0H                                                  0476 01466000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 01467000
         L     R14,SAVLNKA                                         0476 01468000
*           RETURN;                 /* RETURN                        */ 01469000
         B     @EL00002                                            0477 01470000
*/********************************************************************/ 01471000
*/*                                                                  */ 01472000
*/* SEGMENT NAME -- RENQM                                            */ 01473000
*/*                                                                  */ 01474000
*/* DESCRIPTIVE NAME -- N/A                                          */ 01475000
*/*                                                                  */ 01476000
*/* FUNCTION -- ENQUEUE ON SYSIKJUA/'USERID NAME'                    */ 01477000
*/*   OPERATION --                                                   */ 01478000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 01479000
*/*   -  PERFORM SEGMENT RDEQM TO REMOVE ANY OUTSTANDING MEMBERNAME  */ 01480000
*/*      ENQUEUED CONDITION                                          */ 01481000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RENQM FUNCTION   */ 01482000
*/*   -  IF INPUT UADS (SYSUADS) IS NEW DATA SET,                    */ 01483000
*/*      -  SET POINTER TO MINOR NAME (QNAMR) AND MINOR NAME LENGTH  */ 01484000
*/*         (QLNGR)                                                  */ 01485000
*/*      -  SET POINTER TO ENQ PARAMETER BLOCK (NQMBR) IN REGISTER 1 */ 01486000
*/*      -  EXECUTE ENQ MACRO                                        */ 01487000
*/*      -  IF ENQ RETURN CODE IS UNSUCCESSFUL, (NOT 0 OR 8),        */ 01488000
*/*         PERFORM SEGMENT RENQM2 TO CHECK CODE FURTHER.            */ 01489000
*/*         OTHERWISE, SET MEMBERNAME-ENQUEUE-IN-FORCE FLAG (NQMNOW) */ 01490000
*/*         AND SAVE MINOR NAME (NQMIDC) AND MINOR NAME LENGTH       */ 01491000
*/*         (NQMIDL) FOR DEQUEUEING                                  */ 01492000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 01493000
*/*                                                                  */ 01494000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 01495000
*/*                                                                  */ 01496000
*/* INPUT --                                                         */ 01497000
*/*   -  UADSREFM ENVIRONMENT                                        */ 01498000
*/*                                                                  */ 01499000
*/* OUTPUT --                                                        */ 01500000
*/*   -  ENQUEUED STATE                                              */ 01501000
*/*   -  ENQUEUE-IN-FORCE FLAG SET (NQMNOW)                          */ 01502000
*/*   -  MINOR NAME (NQMIDC) AND LENGTH (NQMIDL) SAVED               */ 01503000
*/*                                                                  */ 01504000
*/* EXTERNAL REFERENCES -- ENQ MACRO                                 */ 01505000
*/*                                                                  */ 01506000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 01507000
*/*   CONDITIONS --                                                  */ 01508000
*/*   -  SUCCESSFUL ENQ                                              */ 01509000
*/*   RETURN CODE -- N/A                                             */ 01510000
*/*                                                                  */ 01511000
*/* EXIT-ERROR --                                                    */ 01512000
*/*   CONDITIONS --                                                  */ 01513000
*/*   -  UNSUCCESSFUL ENQ (USERID TERMINATION FLAG (UIDQUIT) SET)    */ 01514000
*/*   RETURN CODE -- N/A                                             */ 01515000
*/*                                                                  */ 01516000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 01517000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 01518000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 01519000
*/*                                                                  */ 01520000
*/********************************************************************/ 01521000
*RENQM:     /* ENQUEUE ON USERID MEMBER NAME                         */ 01522000
*           /* DEQUEUE AT RDEQM                                      */ 01523000
*           ENTRY;                                                 0478 01524000
RENQM    DS    0H                                                  0479 01525000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 01526000
         ST    R14,SAVLNKA                                         0479 01527000
*           RESPECIFY (R14) UNRESTRICTED;                          0480 01528000
*           CALL  RDEQM;            /* CLEAR ENQUEUE STATE           */ 01529000
         BAL   @14,RDEQM                                           0481 01530000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 01531000
*             THEN                  /* NO,                           */ 01532000
         TM    QUITCHK,B'11100000'                                 0482 01533000
         BNZ   @RF00482                                            0482 01534000
*               DO;                                                0483 01535000
*                                                                  0483 01536000
*           IF RDJXPTR->JFCDISP ^= '11'B  /* CHK FOR SYSUADS = NEW   */ 01537000
*             THEN                  /* NO,                           */ 01538000
         L     @08,RDJXPTR                                         0484 01539000
         TM    JFCDISP(@08),B'11000000'                            0484 01540000
         BO    @RF00484                                            0484 01541000
*               DO;                                                0485 01542000
*                 RESPECIFY  (QNAMR,QLNGR,R1,R15) RESTRICTED;      0486 01543000
*                 QNAMR = ADDR(NODIDC);  /* SET PTR TO MINOR NAME    */ 01544000
         LA    QNAMR,NODIDC                                        0487 01545000
*                 QLNGR = NODIDL;        /* SET MINOR NAME LENGTH    */ 01546000
         LH    QLNGR,NODIDL                                        0488 01547000
*                 R1 = ADDR(NQMBR);      /* SET PTR TO ENQ PARM BLK  */ 01548000
         LA    R1,NQMBR                                            0489 01549000
*                 /* ENQUEUE SYSUADS-MEMBERNAME                      */ 01550000
*                 GEN(ENQ    (,(QNAMR),,(QLNGR),,),MF=(E,(1)));    0490 01551000
*                                                                  0490 01552000
         ENQ    (,(QNAMR),,(QLNGR),,),MF=(E,(1))                        01553000
*                 /* CHK IF ENQUEUE SUCCESSFUL                       */ 01554000
*                 RCPTR = R15;         /* RESERVE RETURN CODE        */ 01555000
         ST    R15,RCPTR                                           0491 01556000
*                 RESPECIFY  (QNAMR,QLNGR,R1,R15) UNRESTRICTED;    0492 01557000
*                 IF RCPTR ^= 0        /* CHK IF SATISFACTORY        */ 01558000
*                   THEN               /* NO,                        */ 01559000
         L     @08,RCPTR                                           0493 01560000
         LTR   @08,@08                                             0493 01561000
         BZ    @RF00493                                            0493 01562000
*                     CALL  RENQM2;    /* CHECK UNSATISFACTORY CODE  */ 01563000
         BAL   @14,RENQM2                                          0494 01564000
*                   ELSE                                           0495 01565000
*                     DO;                                          0495 01566000
         B     @RC00493                                            0495 01567000
@RF00493 DS    0H                                                  0496 01568000
*                       NQMNOW = '1'B; /* SET ENQUEUE ACTIVE FLAG    */ 01569000
         OI    NQMNOW,B'00000010'                                  0496 01570000
*                       NQMIDC=NODIDC; /* RESERVE MINOR NAME         */ 01571000
         MVC   NQMIDC(8),NODIDC                                    0497 01572000
*                       NQMIDL=NODIDL; /* RESERVE MINOR NAME LENGTH  */ 01573000
         MVC   NQMIDL(2),NODIDL                                    0498 01574000
*                     END;                                         0499 01575000
*               END;                                               0500 01576000
*                                                                  0500 01577000
@RC00493 DS    0H                                                  0501 01578000
*               END;                                               0501 01579000
@RF00484 DS    0H                                                  0502 01580000
*           RESPECIFY (R14) RESTRICTED;                            0502 01581000
@RF00482 DS    0H                                                  0503 01582000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 01583000
         L     R14,SAVLNKA                                         0503 01584000
*           RETURN;                 /* RETURN                        */ 01585000
         B     @EL00002                                            0504 01586000
*/********************************************************************/ 01587000
*/*                                                                  */ 01588000
*/* SEGMENT NAME -- RWRITE                                           */ 01589000
*/*                                                                  */ 01590000
*/* DESCRIPTIVE NAME -- N/A                                          */ 01591000
*/*                                                                  */ 01592000
*/* FUNCTION -- WRITE REFORMATTED MEMBER TO SYSUADS UADS             */ 01593000
*/*   OPERATION --                                                   */ 01594000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 01595000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RWRITE FUNCTION  */ 01596000
*/*   -  ESTABLISH NUMBER OF BLOCK TO WRITE AND DETERMINE USAGE OF   */ 01597000
*/*      EXTRA BLOCK                                                 */ 01598000
*/*   -  SET ACCOUNT-WRITE PARAMETER BLOCK (RWPB) FOR WRITE WITHOUT  */ 01599000
*/*      ENQUEUE OPERATION                                           */ 01600000
*/*   -  IF EQUIVALENCE FLAG (EQUIUAD) IS SET, PERFORM SEGMENT       */ 01601000
*/*      DOUPDAT TO WRITE-IN-PLACE THE UPDATED USERID MEMBER.  ELSE  */ 01602000
*/*      SET THE ACCOUNT-WRITE PARAMETER BLOCK TO WRITE IN CREATE-   */ 01603000
*/*      MODE 1 MEMBER BLOCK TO THE DATASET CONTROLLED BY THE OUTPUT */ 01604000
*/*      DCB (REXDCB). INSERT THE MEMBER SEQUENCE CHARACTER IN THE   */ 01605000
*/*      USERID NAME (NODIDC(NODIDL+1)) STARTING WITH EBCDIC ZERO    */ 01606000
*/*      FOR THE FIRST WRITE FUNCTION.  PERFORM SEGMENT DOWRT2 TO    */ 01607000
*/*      CALL ACCOUNT-WRITE (IKJEFA52).  PERFORM SEGMENT RSTOW TO    */ 01608000
*/*      EXECUTE STOW FOR MEMBER JUST WRITTEN.                       */ 01609000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS ON, SET DOWHILE CONTROL    */ 01610000
*/*      (SPZBLKN) TO TERMINATE.  ELSE, STEP WRITE-BUFFER POINTER    */ 01611000
*/*      (RWPBUF) IN ACCOUNT-WRITE PARAMETER BLOCK BY 1 OUTPUT BLOCK */ 01612000
*/*      LENGTH AND REDUCE BLOCK COUNT (SPZBLKN) BY 1.  IF SPZBLKN   */ 01613000
*/*      HAS NOT REACHED ZERO, WRITE-STOW FUNCTION IS REPEATED.      */ 01614000
*/*      WHEN WRITING IS COMPLETE SEGMENT FREBUF IS PERFORMED TO     */ 01615000
*/*      FREE THE WRITE-BUFFER AREA                                  */ 01616000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 01617000
*/*                                                                  */ 01618000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 01619000
*/*                                                                  */ 01620000
*/* INPUT --                                                         */ 01621000
*/*  -  UADSREFM ENVIRONMENT                                         */ 01622000
*/*  -  NUMBER OF MEMBER BLOCKS TO WRITE (SPZBLKN)                   */ 01623000
*/*                                                                  */ 01624000
*/* OUTPUT --                                                        */ 01625000
*/*  -  REFORMATTED USERID MEMBER WRITTEN TO OUTPUT UADS (SYSUADS)   */ 01626000
*/*                                                                  */ 01627000
*/* EXTERNAL REFERENCES -- N/A                                       */ 01628000
*/*                                                                  */ 01629000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 01630000
*/*   CONDITIONS -- N/A                                              */ 01631000
*/*   RETURN CODE -- N/A                                             */ 01632000
*/*                                                                  */ 01633000
*/* EXIT-ERROR -- N/A                                                */ 01634000
*/*   CONDITIONS -- N/A                                              */ 01635000
*/*   RETURN CODE -- N/A                                             */ 01636000
*/*                                                                  */ 01637000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 01638000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 01639000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 01640000
*/*                                                                  */ 01641000
*/********************************************************************/ 01642000
*RWRITE:    /* WRITE REFORMATTED MEMBER TO SYSUADS UADS              */ 01643000
*           ENTRY;                                                 0505 01644000
RWRITE   DS    0H                                                  0506 01645000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 01646000
         ST    R14,SAVLNKA                                         0506 01647000
*           RESPECIFY (R14) UNRESTRICTED;                          0507 01648000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 01649000
*             THEN                  /* NO,                           */ 01650000
         TM    QUITCHK,B'11100000'                                 0508 01651000
         BNZ   @RF00508                                            0508 01652000
*               DO;                                                0509 01653000
*                                                                  0509 01654000
*           CURFSQP = SVFSQEP;      /* SET TEST PTR                  */ 01655000
         MVC   CURFSQP(4),SVFSQEP                                  0510 01656000
*           IDINCB = NUMBLKS;       /* SET TO MAXIMUM BLOCK COUNT    */ 01657000
         MVC   IDINCB(2),NUMBLKS                                   0511 01658000
*           DO WHILE CURFSQL = SVFSQEL   /* BLOCK NOT USED           */ 01659000
*               & IDINCB ^= 1;      /* AND NOT FIRST BLOCK           */ 01660000
         B     @DE00512                                            0512 01661000
@DL00512 DS    0H                                                  0513 01662000
*             CURFSQP = CURFSQP-REXBUFP->UADSBLNG;  /* TO PRIOR BLK  */ 01663000
         L     @08,CURFSQP                                         0513 01664000
         L     @01,REXBUFP                                         0513 01665000
         SH    @08,UADSBLNG(,@01)                                  0513 01666000
         ST    @08,CURFSQP                                         0513 01667000
*             IDINCB = IDINCB - 1;   /* REDUCE CURRENT COUNT         */ 01668000
         LH    @08,IDINCB                                          0514 01669000
         BCTR  @08,0                                               0514 01670000
         STH   @08,IDINCB                                          0514 01671000
*           END;                                                   0515 01672000
@DE00512 L     @08,CURFSQP                                         0515 01673000
         CLC   CURFSQL(2,@08),SVFSQEL                              0515 01674000
         BNE   @DC00512                                            0515 01675000
         CLC   IDINCB(2),@CH00032                                  0515 01676000
         BNE   @DL00512                                            0515 01677000
@DC00512 DS    0H                                                  0516 01678000
*           IF IDINCB^<NUMBLKS      /* IS LAST BLOCK IN USE ?        */ 01679000
*               & XTRBLK = '1'B     /* AND IS IT EXTRA BLOCK ?       */ 01680000
*             THEN                  /* YES,                          */ 01681000
         LH    @08,IDINCB                                          0516 01682000
         CH    @08,NUMBLKS                                         0516 01683000
         BL    @RF00516                                            0516 01684000
         TM    XTRBLK,B'00010000'                                  0516 01685000
         BNO   @RF00516                                            0516 01686000
*               XTRBNOW='1'B;       /* SET EXTRA BLOCK IN USE FLAG   */ 01687000
         OI    XTRBNOW,B'00001000'                                 0517 01688000
*           RWPF2 = '0'B;           /* SET PTR-TO-USERID FLAG        */ 01689000
@RF00516 DS    0H                                                  0519 01690000
*           RWPF5 = '1'B;           /* SET DO-WRITE-NOW FLAG         */ 01691000
*           RWPF7 = '0'B;           /* SET DO-NOT-ENQUEUE FLAG       */ 01692000
         OI    RWPF5,B'00001000'                                   0520 01693000
         NI    RWPF2,B'10111101'                                   0520 01694000
*           IF EQUIUAD = '1'B       /* CHK IF UPDAT MODE IS CURRENT  */ 01695000
*             THEN                  /* YES,                          */ 01696000
         TM    EQUIUAD,B'01000000'                                 0521 01697000
         BNO   @RF00521                                            0521 01698000
*               CALL  DOUPDAT;      /* GO TO WRITE IN UPDAT MODE     */ 01699000
         BAL   @14,DOUPDAT                                         0522 01700000
*             ELSE                  /* IN CREATE MODE NOW            */ 01701000
*               DO;                                                0523 01702000
         B     @RC00521                                            0523 01703000
@RF00521 DS    0H                                                  0524 01704000
*                 RWPBSAV = RWPB;   /* RESERVE READ PARM BLOCK       */ 01705000
         MVC   RWPBSAV(24),RWPB                                    0524 01706000
*                 SPZBLKN = IDINCB; /* RESERVE NUMBER OF BLOCKS      */ 01707000
         LH    @08,IDINCB                                          0525 01708000
         STH   @08,SPZBLKN                                         0525 01709000
*                 RWPBUF = REXBUFP; /* PTR TO OUTPUT BUFFER          */ 01710000
         MVC   RWPBUF(3),REXBUFP+1                                 0526 01711000
*                 RWPUDP = ADDR(REXDCB);  /* PTR TO DCB              */ 01712000
         LA    @15,REXDCB                                          0527 01713000
         ST    @15,@TF00001                                        0527 01714000
         MVC   RWPUDP(3),@TF00001+1                                0527 01715000
*                 RWPF3 = '0'B;     /* SET NOT-DIRECTORY-PTR FLAG    */ 01716000
         NI    RWPF3,B'11011111'                                   0528 01717000
*                 RWPNOM = 1;                                      0529 01718000
         MVI   RWPNOM,X'01'                                        0529 01719000
*                 DO SPZBLKN TO 0 BY -1 WHILE SPZBLKN ^= 0;        0530 01720000
         B     @DE00530                                            0530 01721000
@DL00530 SLR   @15,@15                                             0530 01722000
         CR    @08,@15                                             0530 01723000
         BE    @DC00530                                            0530 01724000
*                   RWPRBP=0;       /* SET CREATE MODE INDICATOR     */ 01725000
         ST    @15,RWPRBP                                          0531 01726000
*                   NODIDC(NODIDL+1)=  /* INSERT INCREMENTAL         */ 01727000
*                        (IDINCB-SPZBLKN)|'0';    /* CHAR            */ 01728000
         LH    @01,NODIDL                                          0532 01729000
         LCR   @08,@08                                             0532 01730000
         AH    @08,IDINCB                                          0532 01731000
         O     @08,@CF01890                                        0532 01732000
         STC   @08,NODIDC(@01)                                     0532 01733000
*                   CALL DOWRT2;    /* TO CALL WRITE ROUTINE         */ 01734000
         BAL   @14,DOWRT2                                          0533 01735000
*                   RWPRBP = RWPSDR;  /* RESTORE DIRECTORY PTR       */ 01736000
         MVC   RWPRBP(4),RWPSDR                                    0534 01737000
*                   CALL  RSTOW;    /* TO CALL STOW ROUTINE          */ 01738000
         BAL   @14,RSTOW                                           0535 01739000
*                   IF QUITCHK ^= '000'B/* CHK FOR TERMINATION       */ 01740000
*                     THEN          /* YES,                          */ 01741000
         TM    QUITCHK,B'11100000'                                 0536 01742000
         BZ    @RF00536                                            0536 01743000
*                       SPZBLKN = 0;    /* STOP WRITE LOOP           */ 01744000
         SLR   @08,@08                                             0537 01745000
         STH   @08,SPZBLKN                                         0537 01746000
*                     ELSE          /* NOT TERMINATION NOW           */ 01747000
*                         RWPBUF=RWPBUF+DCBXPTR->DCBBLKSI;  /* SET   */ 01748000
         B     @RC00536                                            0538 01749000
@RF00536 L     @08,RWPBUF-1                                        0538 01750000
         LA    @08,0(,@08)                                         0538 01751000
         L     @01,DCBXPTR                                         0538 01752000
         AH    @08,DCBBLKSI(,@01)                                  0538 01753000
         ST    @08,@TF00001                                        0538 01754000
         MVC   RWPBUF(3),@TF00001+1                                0538 01755000
*                 END;                                             0539 01756000
@RC00536 SLR   @08,@08                                             0539 01757000
         BCTR  @08,0                                               0539 01758000
         AH    @08,SPZBLKN                                         0539 01759000
         STH   @08,SPZBLKN                                         0539 01760000
@DE00530 LTR   @08,@08                                             0539 01761000
         BNM   @DL00530                                            0539 01762000
@DC00530 DS    0H                                                  0540 01763000
*                 CALL  FREBUF;     /* FREE OUTBUFFER AREA           */ 01764000
         BAL   @14,FREBUF                                          0540 01765000
*                 RWPB = RWPBSAV;   /* RESTORE READ PARM BLOCK       */ 01766000
         MVC   RWPB(24),RWPBSAV                                    0541 01767000
*               END;                                               0542 01768000
*                                                                  0542 01769000
*               END;                                               0543 01770000
@RC00521 DS    0H                                                  0544 01771000
*           RESPECIFY (R14) RESTRICTED;                            0544 01772000
@RF00508 DS    0H                                                  0545 01773000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 01774000
         L     R14,SAVLNKA                                         0545 01775000
*           END  RINIT;             /* RETURN                        */ 01776000
         B     @EL00002                                            0546 01777000
*/********************************************************************/ 01778000
*/*                                                                  */ 01779000
*/* SEGMENT NAME -- DCBCHK                                           */ 01780000
*/*                                                                  */ 01781000
*/* DESCRIPTIVE NAME -- N/A                                          */ 01782000
*/*                                                                  */ 01783000
*/* FUNCTION -- CHECK DCB FOR MINIMUM AND IDENTICAL BLOCK SIZE       */ 01784000
*/*                                                                  */ 01785000
*/*   OPERATION --                                                   */ 01786000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 01787000
*/*   -  IF OUTPUT BLOCK SIZE IS LESS THAN MINIMUM, ISSUE ERROR      */ 01788000
*/*      MESSAGE 15 AND SET UADSREFM TERMINATION FLAG (RFMQUIT)      */ 01789000
*/*   -  IF INPUT (SYSUADN) AND OUTPUT (SYSUADS) DATA SETS ARE IDEN- */ 01790000
*/*      TICAL ( EQUIUAD FLAG SET ), AND BLOCK SIZES ARE NOT EQUAL,  */ 01791000
*/*      ISSUE ERROR MESSAGE 26 AND SET UADSREFM TERMINATION FLAG    */ 01792000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 01793000
*/*                                                                  */ 01794000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 01795000
*/*                                                                  */ 01796000
*/* INPUT --                                                         */ 01797000
*/*   -  UADSREFM ENVIRONMENT                                        */ 01798000
*/*                                                                  */ 01799000
*/* OUTPUT -- N/A                                                    */ 01800000
*/*                                                                  */ 01801000
*/* EXTERNAL REFERENCES -- N/A                                       */ 01802000
*/*                                                                  */ 01803000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 01804000
*/*   CONDITIONS --                                                  */ 01805000
*/*   -  SYSUADS BLOCKSIZE ADEQUATE                                  */ 01806000
*/*   -  SYSUADS AND SYSUADN BLOCKSIZES IDENTICAL FOR UPDATE MODE    */ 01807000
*/*   RETURN CODE -- N/A                                             */ 01808000
*/*                                                                  */ 01809000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 01810000
*/*   CONDITIONS --                                                  */ 01811000
*/*   -  INADEQUATE BLOCK SIZE FOR SYSUADS OR UPDATE MODE BLOCK      */ 01812000
*/*      SIZES NOT EQUAL (TERMINATION FLAG (RFMQUIT) IS SET)         */ 01813000
*/*   RETURN CODE -- N/A                                             */ 01814000
*/*                                                                  */ 01815000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 01816000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 01817000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 01818000
*/*                                                                  */ 01819000
*/********************************************************************/ 01820000
*DCBCHK:    /* CHECK DCB FOR ADEQUATE AND IDENTICAL BLOCK SIZES      */ 01821000
*           PROCEDURE                                              0547 01822000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 01823000
DCBCHK   DS    0H                                                  0548 01824000
*                                   /* NO SAVE AREA CREATED          */ 01825000
*           RESPECIFY (R14) RESTRICTED;                            0548 01826000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 01827000
         ST    R14,SAVLNKB                                         0549 01828000
*           RESPECIFY (R14) UNRESTRICTED;                          0550 01829000
*                                                                  0550 01830000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 01831000
*             THEN                  /* NO,                           */ 01832000
         TM    QUITCHK,B'11100000'                                 0551 01833000
         BNZ   @RF00551                                            0551 01834000
*               DO;                                                0552 01835000
*                                                                  0552 01836000
*           IF DCBXPTR->DCBBLKSI<MINBLK   /* BLOCK SIZE INADEQUATE ? */ 01837000
*             THEN                  /* YES,                          */ 01838000
         L     @08,DCBXPTR                                         0553 01839000
         LH    @08,DCBBLKSI(,@08)                                  0553 01840000
         C     @08,MINBLK                                          0553 01841000
         BNL   @RF00553                                            0553 01842000
*               DO;                                                0554 01843000
*                 MSGNO = 15;       /* SET MESSAGE INDEX             */ 01844000
         MVC   MSGNO(2),@CH00174                                   0555 01845000
*                 CALL  MSGFNDR;    /* LOCATE MESSAGE TEXT           */ 01846000
         BAL   @14,MSGFNDR                                         0556 01847000
*                 CALL  FXPUTLM;    /* INITIALIZE PARM BLOCK         */ 01848000
         BAL   @14,FXPUTLM                                         0557 01849000
*                 CALL  DOPUTL;     /* TO ISSUE PUTLINE              */ 01850000
         BAL   @14,DOPUTL                                          0558 01851000
*                 RFMQUIT = '1'B;   /* SET TERMINATION FLAG          */ 01852000
         OI    RFMQUIT,B'01000000'                                 0559 01853000
*               END;                                               0560 01854000
*                                                                  0560 01855000
*           IF EQUIUAD = '1'B       /* CHK FOR UPDATE MODE           */ 01856000
*             THEN                  /* YES,                          */ 01857000
@RF00553 TM    EQUIUAD,B'01000000'                                 0561 01858000
         BNO   @RF00561                                            0561 01859000
*               IF DCBBLKSI^=DCBXPTR->DCBBLKSI  /* CHK IF UNEQUAL    */ 01860000
*                 THEN              /* YES,                          */ 01861000
         L     @08,DCBPTR                                          0562 01862000
         L     @01,DCBXPTR                                         0562 01863000
         CLC   DCBBLKSI(2,@08),DCBBLKSI(@01)                       0562 01864000
         BE    @RF00562                                            0562 01865000
*                   DO;                                            0563 01866000
*                     MSGNO = 26;   /* SET MESSAGE INDEX             */ 01867000
         MVC   MSGNO(2),@CH01912                                   0564 01868000
*                     CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT         */ 01869000
         BAL   @14,MSGFNDR                                         0565 01870000
*                     CALL  FXPUTLM;  /* INITIALIZE PARM BLOCK       */ 01871000
         BAL   @14,FXPUTLM                                         0566 01872000
*                     CALL  DOPUTL;   /* TO ISSUE PUTLINE            */ 01873000
         BAL   @14,DOPUTL                                          0567 01874000
*                     RFMQUIT = '1'B; /* SET TERMINATION FLAG        */ 01875000
         OI    RFMQUIT,B'01000000'                                 0568 01876000
*                   END;                                           0569 01877000
*                                                                  0569 01878000
*           END;                                                   0570 01879000
@RF00562 DS    0H                                                  0570 01880000
@RF00561 DS    0H                                                  0571 01881000
*           RESPECIFY (R14) RESTRICTED;                            0571 01882000
@RF00551 DS    0H                                                  0572 01883000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 01884000
         L     R14,SAVLNKB                                         0572 01885000
*           RETURN;                 /* RETURN                        */ 01886000
@EL00003 DS    0H                                                  0573 01887000
@EF00003 DS    0H                                                  0573 01888000
@ER00003 BR    @14                                                 0573 01889000
*/********************************************************************/ 01890000
*/*                                                                  */ 01891000
*/* SEGMENT NAME -- RDINIT                                           */ 01892000
*/*                                                                  */ 01893000
*/* DESCRIPTIVE NAME -- N/A                                          */ 01894000
*/*                                                                  */ 01895000
*/* FUNCTION -- INITIALIZE ACCOUNT-READ PARAMETER BLOCK (RWPB) AND   */ 01896000
*/*             OBTAIN FIRST USERID                                  */ 01897000
*/*   OPERATION --                                                   */ 01898000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 01899000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDINIT FUNCTION  */ 01900000
*/*   -  INITIALIZE ACCOUNT-READ PARAMETER BLOCK (RWPB) FOR POINTERS */ 01901000
*/*      TO INPUT DCB (RINDCB), TO COMMUNICATION PL (PLOUT), AND TO  */ 01902000
*/*      UADSREFM IDENTIFYING CHARACTER 'R'                          */ 01903000
*/*   -  DEFINE LENGTH (DPLNDP) OF REBUILD-STRUCTURE CONTROL BLOCK   */ 01904000
*/*   -  SET RWPB TO PERFORM DIRECTORY+MEMBER TYPE READ              */ 01905000
*/*   -  PERFORM SEGMENT DOREAD TO OBTAIN FIRST USERID MEMBER AND    */ 01906000
*/*      AND DIRECTORY ENTRY HOLDING NAME OF NEXT SEQUENTIAL USERID  */ 01907000
*/*      NAME.  SAVE THAT NAME (COMPNAM).  SET POINTER (DIRBDAP) TO  */ 01908000
*/*      FIRST DIRECTORY ENTRY.  SAVE THAT CURRENT DIRECTORY ENTRY   */ 01909000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 01910000
*/*                                                                  */ 01911000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 01912000
*/*                                                                  */ 01913000
*/* INPUT --                                                         */ 01914000
*/*   -  UADSREFM ENVIRONMENT                                        */ 01915000
*/*                                                                  */ 01916000
*/* OUTPUT --                                                        */ 01917000
*/*   -  FIRST USERID MEMBER IN INPUT BUFFER                         */ 01918000
*/*   -  NEXT USERID NAME (COMPNAM)                                  */ 01919000
*/*   -  COPY OF CURRENT DIRECTORY ENTRY (CURDIRN)                   */ 01920000
*/*                                                                  */ 01921000
*/* EXTERNAL REFERENCES -- N/A                                       */ 01922000
*/*                                                                  */ 01923000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 01924000
*/*   CONDITIONS -- N/A                                              */ 01925000
*/*   RETURN CODE -- N/A                                             */ 01926000
*/*                                                                  */ 01927000
*/* EXIT-ERROR -- N/A                                                */ 01928000
*/*   CONDITIONS -- N/A                                              */ 01929000
*/*   RETURN CODE -- N/A                                             */ 01930000
*/*                                                                  */ 01931000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 01932000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 01933000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 01934000
*/*                                                                  */ 01935000
*/********************************************************************/ 01936000
*RDINIT:    /* INITIALIZE RD/WR  P B  AND OBTAIN FIRST USERID        */ 01937000
*           ENTRY;                                                 0574 01938000
RDINIT   DS    0H                                                  0575 01939000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 01940000
         ST    R14,SAVLNKB                                         0575 01941000
*           RESPECIFY (R14) UNRESTRICTED;                          0576 01942000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 01943000
*             THEN                  /* NO,                           */ 01944000
         TM    QUITCHK,B'11100000'                                 0577 01945000
         BNZ   @RF00577                                            0577 01946000
*               DO;                                                0578 01947000
*                                                                  0578 01948000
*           /* INITIALIZE READ/WRITE PARAMETER BLOCK                 */ 01949000
*           RWPUDP = ADDR(RINDCB);  /* SET PTR TO UADS DCB           */ 01950000
         LA    @08,RINDCB                                          0579 01951000
         ST    @08,@TF00001                                        0579 01952000
         MVC   RWPUDP(3),@TF00001+1                                0579 01953000
*           RWPAPL = ADDR(PLOUT);   /* SET PTR TO REFORM  P L        */ 01954000
         LA    @08,PLOUT                                           0580 01955000
         ST    @08,RWPAPL                                          0580 01956000
*           RWPCHR = 'R';           /* SET REFORM IDENTIFIER         */ 01957000
         MVI   RWPCHR,C'R'                                         0581 01958000
*           RWPF4 = '1'B;           /* SET EXTRA BLOCK REQUEST FLAG  */ 01959000
*                                                                  0582 01960000
         OI    RWPF4,B'00010000'                                   0582 01961000
*           DPLNDP = ADDR(OEND);    /* SET PTR TO END OF OLRPL       */ 01962000
*                                                                  0583 01963000
         LA    @08,OEND                                            0583 01964000
         ST    @08,DPLNDP                                          0583 01965000
*           /* INITIALIZE FOR READ SPECIFIC OR DIRECTORY MEMBER      */ 01966000
*/*         NOTE -- THE FOLLOWING CODE-COMMENTS REPRESENT THE CODE   */ 01967000
*/*         INSERTION NEEDED IF SPECIFIC NAME(S) ABILITY PARAMETERS  */ 01968000
*/*         ARE ADDED TO UADSREFM INVOCATION                         */ 01969000
*/*         IF DUCLSF1 = YES        /* CHK FOR ASTERISK FLAG         */ 01970000
*/*           THEN                  /* YES,                          */ 01971000
*               DO;                                                0584 01972000
*                 /* DO PRIME-READ TO IDENTIFY FIRST MEMBER NAME     */ 01973000
*                 RWPF3  =  '1'B;   /* SET WORK AREA INDICATOR       */ 01974000
         OI    RWPF3,B'00100000'                                   0585 01975000
*                 RWPWAP=ADDR(DIRWA); /* PTR TO DIRECTORY WORK AREA  */ 01976000
         LA    @08,DIRWA                                           0586 01977000
         ST    @08,RWPWAP                                          0586 01978000
*                 CALL  DOREAD;     /* GO TO EXECUTE PRIMING READ    */ 01979000
         BAL   @14,DOREAD                                          0587 01980000
*                 COMPNAM = RDNAMC; /* RESERVE NEXT NAME             */ 01981000
         L     @08,RWPNBP                                          0588 01982000
         MVC   COMPNAM(8),RDNAMC(@08)                              0588 01983000
*                 DIRBDAP=ADDR(DIRBLK)+2;  /* PTR TO DIRECTORY ENTRY */ 01984000
         LA    @08,DIRBLK                                          0589 01985000
         AH    @08,@CH00099                                        0589 01986000
         ST    @08,DIRBDAP                                         0589 01987000
*                 CURDIRN = UADIRENT;  /* RESERVE CURRENT USER ENTRY */ 01988000
         L     @08,DIRPTR                                          0590 01989000
         MVC   CURDIRN(14),UADIRENT(@08)                           0590 01990000
*               END;                                               0591 01991000
*/*           ELSE                  /* NO, IS NOT ASTERISK USERID    */ 01992000
*/*             DO;                                                  */ 01993000
*/*               RWPNBP=ADDR(NODIDC);  /* PTR TO SPECIFIC USERID    */ 01994000
*/*               NODIDC(NODIDL+1)=CZERO; /* ZERO FOR FIRST MEMBER   */ 01995000
*/*             END;                                                 */ 01996000
*                                                                  0592 01997000
*               END;                                               0592 01998000
*           RESPECIFY (R14) RESTRICTED;                            0593 01999000
@RF00577 DS    0H                                                  0594 02000000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 02001000
         L     R14,SAVLNKB                                         0594 02002000
*           RETURN;                 /* RETURN                        */ 02003000
         B     @EL00003                                            0595 02004000
*/********************************************************************/ 02005000
*/*                                                                  */ 02006000
*/* SEGMENT NAME -- RDNAM                                            */ 02007000
*/*                                                                  */ 02008000
*/* DESCRIPTIVE NAME -- N/A                                          */ 02009000
*/*                                                                  */ 02010000
*/* FUNCTION -- EXTRACT NAME OF MEMBER READ AND FIND NAME LENGTH     */ 02011000
*/*   OPERATION --                                                   */ 02012000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 02013000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDNAM FUNCTION   */ 02014000
*/*   -  IF NEXT NAME IS  END-OF-FILE  MASK,  SET END-OF-DIRECTORY   */ 02015000
*/*      FLAG (RENDOF) AND RETURN                                    */ 02016000
*/*   -  SET CURRENT USERID NAME (NODIDC) FROM SAVE NEXT NAME        */ 02017000
*/*      (COMPNAM) OR IF FIRST USERID IS BEING PROCESSED, FROM       */ 02018000
*/*      DIRECTORY ENTRY (RDNAMD)                                    */ 02019000
*/*   -  SCAN NAME TO FIND NUMBER OF SIGNIFICANT CHARACTERS (NODIDL) */ 02020000
*/*   -  IF FIRST USERID IS BEING PROCESSED, SET 1ST-USERID-READ     */ 02021000
*/*      FLAG (RDINTL) AND FIRST-USERID-CURRENTLY-IN-PROCESS FLAG    */ 02022000
*/*      (RD1NOW)                                                    */ 02023000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 02024000
*/*                                                                  */ 02025000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 02026000
*/*                                                                  */ 02027000
*/* INPUT --                                                         */ 02028000
*/*   -  UADSREFM ENVIRONMENT                                        */ 02029000
*/*   -  NEXT USERID NAME IN SAVE AREA (COMPNAM) OR IN 1ST DIRECTORY */ 02030000
*/*      ENTRY (RDNAMD)                                              */ 02031000
*/*                                                                  */ 02032000
*/* OUTPUT --                                                        */ 02033000
*/*   -  CURRENT USERID NAME IN CURRENT USE AREA (NODIDC) AND THE    */ 02034000
*/*      CURRENT NUMBER OF CHARACTERS IN (NODIDL),                   */ 02035000
*/*      OR END-OF-DIRECTORY FLAG                                    */ 02036000
*/*                                                                  */ 02037000
*/* EXTERNAL REFERENCES -- N/A                                       */ 02038000
*/*                                                                  */ 02039000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 02040000
*/*   CONDITIONS -- N/A                                              */ 02041000
*/*   RETURN CODE -- N/A                                             */ 02042000
*/*                                                                  */ 02043000
*/* EXIT-ERROR -- N/A                                                */ 02044000
*/*   CONDITIONS -- N/A                                              */ 02045000
*/*   RETURN CODE -- N/A                                             */ 02046000
*/*                                                                  */ 02047000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 02048000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 02049000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 02050000
*/*                                                                  */ 02051000
*/********************************************************************/ 02052000
*RDNAM:     /* EXTRACT NAME OF MEMBER READ AND FIND NAME LENGTH      */ 02053000
*           ENTRY;                                                 0596 02054000
RDNAM    DS    0H                                                  0597 02055000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 02056000
         ST    R14,SAVLNKB                                         0597 02057000
*           RESPECIFY (R14) UNRESTRICTED;                          0598 02058000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 02059000
*             THEN                  /* NO,                           */ 02060000
         TM    QUITCHK,B'11100000'                                 0599 02061000
         BNZ   @RF00599                                            0599 02062000
*               DO;                                                0600 02063000
*                                                                  0600 02064000
*           NODIDC = COMPNAM;       /* SET CURRENT USERID NAME       */ 02065000
         MVC   NODIDC(8),COMPNAM                                   0601 02066000
*           IF RDINTL = '0'B        /* CH FOR 1ST READ DONE          */ 02067000
*             THEN                  /* NO,                           */ 02068000
         TM    RDINTL,B'00000010'                                  0602 02069000
         BNZ   @RF00602                                            0602 02070000
*               NODIDC = RDNAMD;    /* GET 1ST NAME IN DIRECTORY     */ 02071000
         MVC   NODIDC(8),RDNAMD                                    0603 02072000
*           IF NODIDC ^= ENDMSK     /* CHK FOR END OF DIRECTORY      */ 02073000
*             THEN                  /* NOT END,                      */ 02074000
@RF00602 CLC   NODIDC(8),ENDMSK                                    0604 02075000
         BE    @RF00604                                            0604 02076000
*               DO;                                                0605 02077000
*                 NODIDL = 7;       /* INITIALIZE LENGTH COUNT       */ 02078000
         MVC   NODIDL(2),@CH00644                                  0606 02079000
*                 /* FIND LENGTH OF NEW NAME                         */ 02080000
*                 DO DOWHYLR=1 TO 1;         /* START DOWHILE LOOP   */ 02081000
         LA    @08,1                                               0607 02082000
         STH   @08,DOWHYLR                                         0607 02083000
@DL00607 DS    0H                                                  0608 02084000
*                   /* CHK FOR TERMINATING CHARACTER                 */ 02085000
*                   IF NODIDC(NODIDL+1)^='0'   /* CHK FOR MEMBER ID  */ 02086000
*                     THEN          /* IS NOT 0                      */ 02087000
         LH    @08,NODIDL                                          0608 02088000
         LA    @01,NODIDC(@08)                                     0608 02089000
         CLI   0(@01),C'0'                                         0608 02090000
         BE    @RF00608                                            0608 02091000
*                       DO;                                        0609 02092000
*                         NODIDL = NODIDL-1;  /* REDUCE LENGTH COUNT */ 02093000
         BCTR  @08,0                                               0610 02094000
         STH   @08,NODIDL                                          0610 02095000
*                         DOWHYLR = 0;    /* SET DOWHILE LOCK        */ 02096000
         SLR   @08,@08                                             0611 02097000
         STH   @08,DOWHYLR                                         0611 02098000
*                       END;                                       0612 02099000
*                 END;              /* IS NOW 0                      */ 02100000
*                                                                  0613 02101000
@RF00608 LA    @08,1                                               0613 02102000
         AH    @08,DOWHYLR                                         0613 02103000
         STH   @08,DOWHYLR                                         0613 02104000
         CH    @08,@CH00032                                        0613 02105000
         BNH   @DL00607                                            0613 02106000
*                 /* CHK IF INITIAL READ PROCESSED                   */ 02107000
*                 IF RDINTL = '0'B  /* CHK FOR 1ST READ FLAG         */ 02108000
*                   THEN            /* NO,                           */ 02109000
         TM    RDINTL,B'00000010'                                  0614 02110000
         BNZ   @RF00614                                            0614 02111000
*                     DO;                                          0615 02112000
*                       RDINTL='1'B; /* SET FIRST READ DONE FLAG     */ 02113000
         OI    RDINTL,B'00000010'                                  0616 02114000
*                       RD1NOW='1'B; /* SET TO PROCESS FIRST READ    */ 02115000
         OI    RD1NOW,B'01000000'                                  0617 02116000
*                     END;                                         0618 02117000
*               END;                                               0619 02118000
*             ELSE                                                 0620 02119000
*               RENDOF = '1'B;      /* SET END OF DIRECTORY FLAG     */ 02120000
*                                                                  0620 02121000
         B     @RC00604                                            0620 02122000
@RF00604 OI    RENDOF,B'00100000'                                  0620 02123000
*               END;                                               0621 02124000
@RC00604 DS    0H                                                  0622 02125000
*           RESPECIFY (R14) RESTRICTED;                            0622 02126000
@RF00599 DS    0H                                                  0623 02127000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 02128000
         L     R14,SAVLNKB                                         0623 02129000
*           RETURN;                 /* RETURN                        */ 02130000
         B     @EL00003                                            0624 02131000
*/********************************************************************/ 02132000
*/*                                                                  */ 02133000
*/* SEGMENT NAME -- RDDIR                                            */ 02134000
*/*                                                                  */ 02135000
*/* DESCRIPTIVE NAME -- N/A                                          */ 02136000
*/*                                                                  */ 02137000
*/* FUNCTION -- GET DIRECTORY BLOCK AT/BELOW CURRENT NEXT NAME       */ 02138000
*/*   OPERATION --                                                   */ 02139000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 02140000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDDIR FUNCTION   */ 02141000
*/*   -  EXECUTE BSP (BACKSPACE) MACRO                               */ 02142000
*/*   -  IF BSP FAILED (RETURN CODE NOT 0) ISSUE ERROR MESSAGE 21,   */ 02143000
*/*      SET UADSREFM TERMINATION FLAG (RFMQUIT) AND EXIT            */ 02144000
*/*   -  IF BSP SUCCEEDED, INITIALIZE ACCOUNT-READ PARAMETER BLOCK   */ 02145000
*/*      (RWPB) FOR READ-DIRECTORY-ONLY, AND PERFORM SEGMENT DOREAD  */ 02146000
*/*      TO OBTAIN NEXT DIRECTORY BLOCK.  RESET DATA-READ-DONE FLAG  */ 02147000
*/*      (RDDONE) AND SET DIRECTORY ENTRY POINTER (DIRBDAP) TO FIRST */ 02148000
*/*      ENTRY IN NEW DIRECTORY BLOCK                                */ 02149000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 02150000
*/*                                                                  */ 02151000
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */ 02152000
*/*                                                                  */ 02153000
*/* INPUT --                                                         */ 02154000
*/*   -  UADSREFM ENVIRONMENT                                        */ 02155000
*/*   -  NEXT USERID NAME IN RESERVED AREA (COMPNAM)                 */ 02156000
*/*                                                                  */ 02157000
*/* OUTPUT --                                                        */ 02158000
*/*   -  DIRECTORY ENTRY CONTAINING NEXT USERID NAME IS IN DIRECTORY */ 02159000
*/*      WORK AREA (DIRWA)                                           */ 02160000
*/*   -  FIRST DIRECTORY ENTRY IS LOCATED BY POINTER (DIRBDAP)       */ 02161000
*/*                                                                  */ 02162000
*/* EXTERNAL REFERENCES -- BSP MACRO                                 */ 02163000
*/*                                                                  */ 02164000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 02165000
*/*   CONDITIONS --                                                  */ 02166000
*/*   -  SUCESSFUL BSP AND READ                                      */ 02167000
*/*   RETURN CODE -- N/A                                             */ 02168000
*/*                                                                  */ 02169000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 02170000
*/*   CONDITIONS --                                                  */ 02171000
*/*   -  BSP FAILURE (RFMQUIT FLAG SET)                              */ 02172000
*/*   RETURN CODE -- N/A                                             */ 02173000
*/*                                                                  */ 02174000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 02175000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 02176000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 02177000
*/*                                                                  */ 02178000
*/********************************************************************/ 02179000
*RDDIR:     /* GET DIRECTORY BLOCK AT/BELOW CURRENT NEXT NAME        */ 02180000
*           ENTRY;                                                 0625 02181000
*                                                                  0625 02182000
RDDIR    DS    0H                                                  0626 02183000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 02184000
         ST    R14,SAVLNKB                                         0626 02185000
*           RESPECIFY (R14) UNRESTRICTED;                          0627 02186000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 02187000
*             THEN                  /* NO,                           */ 02188000
         TM    QUITCHK,B'11100000'                                 0628 02189000
         BNZ   @RF00628                                            0628 02190000
*               DO;                                                0629 02191000
*                                                                  0629 02192000
*/*         DO DOWHYL2=START TO STOP;  /* DO WHILE WRONG DIR BLOCK   */ 02193000
*             RWPBSAV = RWPB;       /* RESERVE UPDAT READ/WRITE PB   */ 02194000
         MVC   RWPBSAV(24),RWPB                                    0630 02195000
*             DO BSPCTR=START2 TO 2;      /* LOOP FOR NEXT BLOCK     */ 02196000
         LH    @08,START2                                          0631 02197000
         B     @DE00631                                            0631 02198000
@DL00631 DS    0H                                                  0632 02199000
*               GENERATE(BSP  RDIDCB); /* BACKSPACE DIRECTORY        */ 02200000
         BSP  RDIDCB                                                    02201000
*               /* CHK FOR SUCCESSFUL BACKSPACE                      */ 02202000
*               RESPECIFY (R15) RESTRICTED;                        0633 02203000
*               RTNCODE = R15;      /* RESERVE RETURN CODE           */ 02204000
         ST    R15,RTNCODE                                         0634 02205000
*               RESPECIFY (R15) UNRESTRICTED;                      0635 02206000
*               IF RTNCODE ^= 0     /* CHK FOR SUCCESS CODE          */ 02207000
*                 THEN              /* NO,                           */ 02208000
         L     @08,RTNCODE                                         0636 02209000
         LTR   @08,@08                                             0636 02210000
         BZ    @RF00636                                            0636 02211000
*                   DO;                                            0637 02212000
*                     MSGNO = 21;   /* SET MESSAGE INDEX             */ 02213000
         MVC   MSGNO(2),@CH01923                                   0638 02214000
*                     SOFFS = 20;   /* SET TEXT OFFSET               */ 02215000
         MVC   SOFFS(2),@CH00351                                   0639 02216000
*                     CALL  SYSERRD;  /* GO TO ISSUE MESSAGE         */ 02217000
         BAL   @14,SYSERRD                                         0640 02218000
*                     RFMQUIT = '1'B; /* UADSREFM TERM FLAG          */ 02219000
         OI    RFMQUIT,B'01000000'                                 0641 02220000
*                     BSPCTR = 2;      /* NO MORE BACKSPACE          */ 02221000
         MVC   BSPCTR(2),@CH00099                                  0642 02222000
*                   END;                                           0643 02223000
*                 ELSE              /* SUCCESSFUL BACKSPACE,         */ 02224000
*                   DIREND = '0'B;  /* CLEAR DIRECTORY EOF FLAG      */ 02225000
         B     @RC00636                                            0644 02226000
@RF00636 NI    DIREND,B'10111111'                                  0644 02227000
*             END;                                                 0645 02228000
@RC00636 LA    @08,1                                               0645 02229000
         AH    @08,BSPCTR                                          0645 02230000
@DE00631 STH   @08,BSPCTR                                          0645 02231000
         CH    @08,@CH00099                                        0645 02232000
         BNH   @DL00631                                            0645 02233000
*             IF QUITCHK = '000'B   /* CHK FOR TERMINATION           */ 02234000
*               THEN                /* NO,                           */ 02235000
         TM    QUITCHK,B'11100000'                                 0646 02236000
         BNZ   @RF00646                                            0646 02237000
*                 DO;                                              0647 02238000
*                   RWPF6 = '1'B;   /* SET DIRECTORY ONLY FLAG       */ 02239000
         OI    RWPF6,B'00000100'                                   0648 02240000
*                   RWPWAP = ADDR(DIRWA);  /* SET WORK AREA PTR      */ 02241000
         LA    @08,DIRWA                                           0649 02242000
         ST    @08,RWPWAP                                          0649 02243000
*                   CALL  DOREAD;   /* GET DIRECTORY BLOCK           */ 02244000
         BAL   @14,DOREAD                                          0650 02245000
*                   RWPF6 = '0'B;   /* CLEAR DIRECTORY ONLY FLAG     */ 02246000
         NI    RWPF6,B'11111011'                                   0651 02247000
*                   DIRBDAP=ADDR(DIRBNAM1); /* PTR TO 1ST NAME       */ 02248000
         LA    @08,DIRBNAM1                                        0652 02249000
         ST    @08,DIRBDAP                                         0652 02250000
*/*                 IF DIRBNAM1 > COMPNAM  /* CHK FOR TOO HIGH A BLK */ 02251000
*/*                   THEN          /* YES,                          */ 02252000
*/*                     DO;                                          */ 02253000
*/*                       DOWHYL2 = GO; /* GET PREVIOUS BLOCK        */ 02254000
*/*                       START2 = D1;  /* SET FOR DOUBLE BSP        */ 02255000
*/*                     END;                                         */ 02256000
*                 END;                                             0653 02257000
*             RWPB = RWPBSAV;       /* RESTORE UPDAT READ/WRITE PB   */ 02258000
@RF00646 MVC   RWPB(24),RWPBSAV                                    0654 02259000
*/*         END;                                                     */ 02260000
*                                                                  0655 02261000
*               END;                                               0655 02262000
*           RESPECIFY (R14) RESTRICTED;                            0656 02263000
@RF00628 DS    0H                                                  0657 02264000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 02265000
         L     R14,SAVLNKB                                         0657 02266000
*           RETURN;                 /* RETURN                        */ 02267000
         B     @EL00003                                            0658 02268000
*/********************************************************************/ 02269000
*/*                                                                  */ 02270000
*/* SEGMENT NAME -- RDLOCN                                           */ 02271000
*/*                                                                  */ 02272000
*/* DESCRIPTIVE NAME -- N/A                                          */ 02273000
*/*                                                                  */ 02274000
*/* FUNCTION -- SCAN DIRECTORY BLOCK FOR NEXT NAME                   */ 02275000
*/*   OPERATION --                                                   */ 02276000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 02277000
*/*   -  IF TERMINATION FLAG (RFMQUIT) IS SET, SKIP RDLOCN FUNCTION  */ 02278000
*/*   -  FIND LOCATION OF LAST USERID NAME (DRBLASP) IN CURRENT      */ 02279000
*/*      DIRECTORY ENTRY BLOCK                                       */ 02280000
*/*   -  SET CURRENT DIRECTORY NAME POINTER (DIRBDAP) TO 1ST USERID  */ 02281000
*/*      NAME IN CURRENT DIRECTORY BLOCK                             */ 02282000
*/*   -  IF CURRENT DIRECTORY ENTRY NAME (DIRBNAM) IS END-OF-DIREC-  */ 02283000
*/*      TORY FLAG (ENDMSK), SET END OF DIRECTORY FLAG (DIREND),     */ 02284000
*/*      PERFORM SEGMENT NOUFND (TO ISSUE ERROR MESSAGE 5 AND SET    */ 02285000
*/*      UIDQUIT FLAG), THEN EXIT                                    */ 02286000
*/*   -  IF NOT END OF DIRECTORY, SCAN THROUGH TO FIND THE ENTRY     */ 02287000
*/*      CONTAINING CURRENT NEXT NAME (COMPNAM).  IF NAME IS LOCATED */ 02288000
*/*      SAVE IN DIRECTORY ENTRY (CURDIRN).  IF NOT LOCATED, SET     */ 02289000
*/*      FLAG (DOWYL4) TO CAUSE NEXT DIRECTORY BLOCK TO BE READ      */ 02290000
*/*                                                                  */ 02291000
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */ 02292000
*/*                                                                  */ 02293000
*/* INPUT --                                                         */ 02294000
*/*    -  UADSREFM ENVIRONMENT                                       */ 02295000
*/*   -  NEXT USERID NAME IN RESERVED AREA (COMPNAM)                 */ 02296000
*/*                                                                  */ 02297000
*/* OUTPUT --                                                        */ 02298000
*/*   -  DIRECTORY BLOCK HOLDING NEXT USERID IN AREA (CURDIRN)       */ 02299000
*/*                                                                  */ 02300000
*/* EXTERNAL REFERENCES -- N/A                                       */ 02301000
*/*                                                                  */ 02302000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 02303000
*/*   CONDITIONS -- N/A                                              */ 02304000
*/*   RETURN CODE -- N/A                                             */ 02305000
*/*                                                                  */ 02306000
*/* EXIT-ERROR -- N/A                                                */ 02307000
*/*   CONDITIONS -- N/A                                              */ 02308000
*/*   RETURN CODE -- N/A                                             */ 02309000
*/*                                                                  */ 02310000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 02311000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 02312000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 02313000
*/*                                                                  */ 02314000
*/********************************************************************/ 02315000
*RDLOCN:    /* SCAN DIRECTORY BLOCK FOR NEXT NAME                    */ 02316000
*           ENTRY;                                                 0659 02317000
RDLOCN   DS    0H                                                  0660 02318000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 02319000
         ST    R14,SAVLNKB                                         0660 02320000
*           RESPECIFY (R14) UNRESTRICTED;                          0661 02321000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 02322000
*             THEN                  /* NO,                           */ 02323000
         TM    QUITCHK,B'11100000'                                 0662 02324000
         BNZ   @RF00662                                            0662 02325000
*               DO;                                                0663 02326000
*                                                                  0663 02327000
*           DO DOWHYL3 = 1 TO 1;         /* FIND LAST NAME POINTER   */ 02328000
         LA    @08,1                                               0664 02329000
         STH   @08,DOWHYL3                                         0664 02330000
@DL00664 DS    0H                                                  0665 02331000
*             DRBLASP = DIRBDAP;      /* SET LAST ITEM PTR           */ 02332000
         L     @08,DIRBDAP                                         0665 02333000
         ST    @08,DRBLASP                                         0665 02334000
*             DIRBCAX = DIRBCA & MSK1F;  /* CLEAR HIGH ORDER         */ 02335000
         MVC   DIRBCAX(1),DIRBCA(@08)                              0666 02336000
         NC    DIRBCAX(1),MSK1F                                    0666 02337000
*             DIRBDAP = DIRBDAP+DIRBC*2+12;    /* SET TO NEXT ITEM   */ 02338000
         SLR   @15,@15                                             0667 02339000
         IC    @15,DIRBC                                           0667 02340000
         ALR   @15,@15                                             0667 02341000
         ALR   @08,@15                                             0667 02342000
         AH    @08,@CH00036                                        0667 02343000
         ST    @08,DIRBDAP                                         0667 02344000
*             /* CHK IF STILL WITHIN DIRECTORY BLOCK                 */ 02345000
*             IF DIRBDAP-ADDR(DIRBLKA)<DIRBLNG  /* IS SPAN EXCESSIVE */ 02346000
*               THEN                  /* NO,                         */ 02347000
         LA    @15,DIRBLKA                                         0668 02348000
         SLR   @08,@15                                             0668 02349000
         MVC   @ZT00002+2(2),DIRBLNG                               0668 02350000
         C     @08,@ZT00002                                        0668 02351000
         BNL   @RF00668                                            0668 02352000
*                 DOWHYL3 = 0;        /* GO FOR NEXT ITEM            */ 02353000
         SLR   @08,@08                                             0669 02354000
         STH   @08,DOWHYL3                                         0669 02355000
*           END;                                                   0670 02356000
*                                                                  0670 02357000
@RF00668 LA    @08,1                                               0670 02358000
         AH    @08,DOWHYL3                                         0670 02359000
         STH   @08,DOWHYL3                                         0670 02360000
         CH    @08,@CH00032                                        0670 02361000
         BNH   @DL00664                                            0670 02362000
*           DIRBDAP=ADDR(DIRBNAM1); /* SET DYNAMIC PTR TO 1ST NAME   */ 02363000
*                                                                  0671 02364000
         LA    @08,DIRBNAM1                                        0671 02365000
         ST    @08,DIRBDAP                                         0671 02366000
*           DO DOWHYL5 = 1 TO 1;         /* SCAN THROUGN NAMES       */ 02367000
         LA    @08,1                                               0672 02368000
         STH   @08,DOWHYL5                                         0672 02369000
@DL00672 DS    0H                                                  0673 02370000
*             IF DIRBNAM = ENDMSK  /* CHK FOR END OF DIRECTORY       */ 02371000
*               THEN               /* YES,                           */ 02372000
         L     @08,DIRBDAP                                         0673 02373000
         CLC   DIRBNAM(8,@08),ENDMSK                               0673 02374000
         BNE   @RF00673                                            0673 02375000
*                 DO;                                              0674 02376000
*                   DIREND = '1'B;  /* SET DIRECTORY EOF FLAG        */ 02377000
         OI    DIREND,B'01000000'                                  0675 02378000
*                   CALL  NOUFND;   /* ISSUE USERID NOT FOUND MSG    */ 02379000
         BAL   @14,NOUFND                                          0676 02380000
*                 END;                                             0677 02381000
*               ELSE                /* NOT DIRECTORY EOF             */ 02382000
*                 DO;                                              0678 02383000
         B     @RC00673                                            0678 02384000
@RF00673 DS    0H                                                  0679 02385000
*                   IF DIRBNAM ^= COMPNAM /* CHK FOR FIRST LEVEL     */ 02386000
*                     THEN          /* NO,                           */ 02387000
         L     @08,DIRBDAP                                         0679 02388000
         CLC   DIRBNAM(8,@08),COMPNAM                              0679 02389000
         BE    @RF00679                                            0679 02390000
*                       DO;                                        0680 02391000
*                         /* SCAN THROUGH DIRECTORY ITEMS            */ 02392000
*                         IF DIRBDAP<DRBLASP  /* CHK IF IN BLOCK     */ 02393000
*                           THEN    /* YES,                          */ 02394000
         C     @08,DRBLASP                                         0681 02395000
         BNL   @RF00681                                            0681 02396000
*                             DO;                                  0682 02397000
*                               DIRBCAX=DIRBCA&MSK1F; /* CLR HI-ORDR */ 02398000
         MVC   DIRBCAX(1),DIRBCA(@08)                              0683 02399000
         NC    DIRBCAX(1),MSK1F                                    0683 02400000
*                               DIRBDAP=  /* LOCATE NEXT ITEM        */ 02401000
*                                    DIRBDAP+DIRBC*2+12;           0684 02402000
         SLR   @15,@15                                             0684 02403000
         IC    @15,DIRBC                                           0684 02404000
         ALR   @15,@15                                             0684 02405000
         ALR   @08,@15                                             0684 02406000
         AH    @08,@CH00036                                        0684 02407000
         ST    @08,DIRBDAP                                         0684 02408000
*                               DOWHYL5 = 0;   /* TO CHK NEW ITEM    */ 02409000
         SLR   @08,@08                                             0685 02410000
         STH   @08,DOWHYL5                                         0685 02411000
*                             END;                                 0686 02412000
*                           ELSE    /* BLOCK EXHAUSTED               */ 02413000
*                             DO;                                  0687 02414000
         B     @RC00681                                            0687 02415000
@RF00681 DS    0H                                                  0688 02416000
*                               DOWHYL4=0;   /* TO READ NEXT DIR BLK */ 02417000
         SLR   @08,@08                                             0688 02418000
         STH   @08,DOWHYL4                                         0688 02419000
*                               START2=3;   /* SKIP BACKSPACE        */ 02420000
         MVC   START2(2),@CH00090                                  0689 02421000
*                             END;                                 0690 02422000
*                       END;                                       0691 02423000
*                     ELSE            /* NAME HAS BEEN LOCATED       */ 02424000
*                       CURDIRN=UADIRENT;  /* RESERVE CURRENT ENTRY  */ 02425000
         B     @RC00679                                            0692 02426000
@RF00679 L     @08,DIRPTR                                          0692 02427000
         MVC   CURDIRN(14),UADIRENT(@08)                           0692 02428000
*                 END;                                             0693 02429000
@RC00679 DS    0H                                                  0694 02430000
*           END;                                                   0694 02431000
*                                                                  0694 02432000
@RC00673 LA    @08,1                                               0694 02433000
         AH    @08,DOWHYL5                                         0694 02434000
         STH   @08,DOWHYL5                                         0694 02435000
         CH    @08,@CH00032                                        0694 02436000
         BNH   @DL00672                                            0694 02437000
*               END;                                               0695 02438000
*           RESPECIFY (R14) RESTRICTED;                            0696 02439000
@RF00662 DS    0H                                                  0697 02440000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 02441000
         L     R14,SAVLNKB                                         0697 02442000
*           RETURN;                 /* RETURN                        */ 02443000
         B     @EL00003                                            0698 02444000
*/********************************************************************/ 02445000
*/*                                                                  */ 02446000
*/* SEGMENT NAME -- RBLDIN                                           */ 02447000
*/*                                                                  */ 02448000
*/* DESCRIPTIVE NAME -- N/A                                          */ 02449000
*/*                                                                  */ 02450000
*/* FUNCTION -- SETUP TO SCAN AND REFORM THE MEMBER IN RINBUF        */ 02451000
*/*   OPERATION --                                                   */ 02452000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 02453000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RBLDIN FUNCTION  */ 02454000
*/*   -  SET POINTER (OLDLOC) AND OFFSET (OUOFDAT) IN INPUT REBUILD- */ 02455000
*/*      CONTROL TABLE (OLRPL)                                       */ 02456000
*/*   -  SET INITIAL END-OF-CHAIN FLAGS AT ALL LEVELS                */ 02457000
*/*   -  SET POINTER (NUDLOC) AND OFFSET (NUOFDAT) INTO THE OUTPUT   */ 02458000
*/*      REBUILD-CONTROL TABLE (NLRPL)                               */ 02459000
*/*   -  SET INITIAL (TEMPORARY) DATA POINTERS AT ALL LEVELS         */ 02460000
*/*   -  SET INITIAL LEVEL OF MODIFICATION (TSTLVL) AT PASSWORD      */ 02461000
*/*      LEVEL (OPOFFS)                                              */ 02462000
*/*   -  SET MAXIMUM LEVEL OF MODIFICATION (TOPLVL) AT PROCEDURE     */ 02463000
*/*      NAME LEVEL (OROFFS)                                         */ 02464000
*/*   -  RESET LEVEL-CHAINING FLAG  (CHAINOW)                         * 02465000
*/*   -  SET HEADER BLOCK MAPPING MACRO BASE POINTER (HEDBPTR) TO    */ 02466000
*/*      OUTPUT BUFFER LOCATION (REXBUFP)                            */ 02467000
*/*   -  SET UADS BLOCK LENGTH (UADSBLNG) EQUAL TO ALLOCATED BLOCK   */ 02468000
*/*      LENGTH (DCBLRECL) FOR OUTPUT (SYSUADS)                      */ 02469000
*/*   -  SET OFFSET TO 1ST FREE SPACE QUEUE ELEMENT (UADSFSQP) TO    */ 02470000
*/*      LOCATION IMMEDIATELY FOLLOWING HEADER BLOCK AND SET POINTER */ 02471000
*/*      TO 1ST FSQE IN OUTPUT BUFFER (FSQEPTR)                      */ 02472000
*/*   -  SET INITIAL FSQE LENGTH EQUAL TO BLOCK LENGTH LESS HEADER   */ 02473000
*/*      BLOCK LENGTH AND ROUND DOWN TO NEAREST HALFWORD VALUE       */ 02474000
*/*   -  INDICATE THE FSQE JUST LOCATED IS LAST FREE SPACE ELEMENT   */ 02475000
*/*      WITH ZERO IN LINKING OFFSET                                 */ 02476000
*/*   -  CALL SEGMENT DOGETSP TO ACQUIRE SPACE IN OUTPUT MEMBERBLOCK */ 02477000
*/*      (VIA ACCOUNT-GETSPACE) FOR USER PROFILE TABLE AREA WITH A   */ 02478000
*/*      LENGTH FROM IKJUPT (SPZBLNG).  SET OFFSET TO SPACE ACQUIRED */ 02479000
*/*      IN UPT OFFSET AREA (UADSUPTP) IN OUTPUT HEADER BLOCK        */ 02480000
*/*   -  REALIGN HEADER BLOCK MAP WITH INPUT BUFFER BY SETTING THE   */ 02481000
*/*      HEADER BLOCK BASE POINTER (HEDBPTR) TO LOCATION OF INPUT    */ 02482000
*/*      BUFFER (RINBUFP)                                            */ 02483000
*/*   -  (RESTORE THE ENTRY LINK REGISTER 14 AND RETURN              */ 02484000
*/*                                                                  */ 02485000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 02486000
*/*                                                                  */ 02487000
*/* INPUT --                                                         */ 02488000
*/*   -  UADSREFM ENVIRONMENT                                        */ 02489000
*/*   -  POINTER TO OUTPUT BUFFER (REXBUFP)                          */ 02490000
*/*   -  POINTER TO INPUT BUFFER (RINBUFP)                           */ 02491000
*/* SEGMENT NAME -- RBLDIN  (CONTINUED)                              */ 02492000
*/*                                                                  */ 02493000
*/* OUTPUT --                                                        */ 02494000
*/*   -  USERID LEVEL OF INPUT (OLRPL) AND OUTPUT (NLRPL) REBUILD-   */ 02495000
*/*      CONTROL TABLES INITIALIZED                                  */ 02496000
*/*   -  BLOCK LENGTH, OFFSET TO 1ST FSQE, 1ST FSQE AND OFFSET TO    */ 02497000
*/*      UPT AREA SET IN OUTPUT HEADER BLOCK                         */ 02498000
*/*                                                                  */ 02499000
*/* EXTERNAL REFERENCES -- N/A                                       */ 02500000
*/*                                                                  */ 02501000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 02502000
*/*   CONDITIONS -- N/A                                              */ 02503000
*/*   RETURN CODE -- N/A                                             */ 02504000
*/*                                                                  */ 02505000
*/* EXIT-ERROR -- N/A                                                */ 02506000
*/*   CONDITIONS -- N/A                                              */ 02507000
*/*   RETURN CODE -- N/A                                             */ 02508000
*/*                                                                  */ 02509000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 02510000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 02511000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 02512000
*/*                                                                  */ 02513000
*/********************************************************************/ 02514000
*RBLDIN:    /* SET UP TO SCAN AND REFORM THE MEMBER IN RINBUF        */ 02515000
*                                                                  0699 02516000
*           ENTRY;                                                 0699 02517000
RBLDIN   DS    0H                                                  0700 02518000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 02519000
         ST    R14,SAVLNKB                                         0700 02520000
*           RESPECIFY (R14) UNRESTRICTED;                          0701 02521000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 02522000
*             THEN                  /* NO,                           */ 02523000
         TM    QUITCHK,B'11100000'                                 0702 02524000
         BNZ   @RF00702                                            0702 02525000
*               DO;                                                0703 02526000
*                                                                  0703 02527000
*           OUDLOC = ADDR(RINBUF)+4;   /* PTR TO INPUT USERID NAME   */ 02528000
         LA    @08,4                                               0704 02529000
         L     @15,RINBUFP                                         0704 02530000
         ALR   @15,@08                                             0704 02531000
         ST    @15,OUDLOC                                          0704 02532000
*           OUOFDAT = 4;            /* OFFSET TO INPUT USERID NAME   */ 02533000
         ST    @08,OUOFDAT                                         0705 02534000
*           NPOFLG1 = '1'B;         /* SET PASSWORD NO-CHAIN FLAG    */ 02535000
         OI    NPOFLG1,B'10000000'                                 0706 02536000
*           NAOFLG1 = '1'B;         /* SET ACCTNMBR NO-CHAIN FLAG    */ 02537000
         OI    NAOFLG1,B'10000000'                                 0707 02538000
*           NROFLG1 = '1'B;         /* SET PROCNAME NO-CHAIN FLAG    */ 02539000
         OI    NROFLG1,B'10000000'                                 0708 02540000
*           NUDLOC = ADDR(REXBUF)+4;  /* PTR TO OUTPUT USERID NAME   */ 02541000
         L     @15,REXBUFP                                         0709 02542000
         LR    @14,@15                                             0709 02543000
         ALR   @14,@08                                             0709 02544000
         ST    @14,NUDLOC                                          0709 02545000
*           NUOFDAT = 4;            /* OFFSET TO OUTPUT USERID NAME  */ 02546000
         ST    @08,NUOFDAT                                         0710 02547000
*           NPFLOC = ADDR(NROFDAT); /* INITIAL NCURUNEX - PASSWORD   */ 02548000
         LA    @08,NROFDAT                                         0711 02549000
         ST    @08,NPFLOC                                          0711 02550000
*           NAFLOC = ADDR(NROFDAT); /* INITIAL NCURUNEX - ACCTNAME   */ 02551000
         ST    @08,NAFLOC                                          0712 02552000
*           NRFLOC = ADDR(NROFDAT); /* INITIAL NCURUNEX - PROCNAME   */ 02553000
         ST    @08,NRFLOC                                          0713 02554000
*           TSTLVL = ADDR(OPOFFS);  /* INITIAL LEVEL OF MODIFICATION */ 02555000
         LA    @08,OPOFFS                                          0714 02556000
         ST    @08,TSTLVL                                          0714 02557000
*           TOPLVL = ADDR(OROFFS);  /* MAXIMUM MODIFICATION LEVEL    */ 02558000
         LA    @08,OROFFS                                          0715 02559000
         ST    @08,TOPLVL                                          0715 02560000
*           CHAINOW = '0'B;         /* INITIALIZE FOR NO CHAINING    */ 02561000
         NI    CHAINOW,B'01111111'                                 0716 02562000
*           HEDBPTR = REXBUFP;      /* SET MAP TO OUTPUT UADS        */ 02563000
*                                                                  0717 02564000
         ST    @15,HEDBPTR                                         0717 02565000
*           IDINCB = 1;             /* INITIALIZE FOR CURRENT BLOCK  */ 02566000
         MVC   IDINCB(2),@CH00032                                  0718 02567000
*           SPAZPB=SPAZPB&&SPAZPB;  /* INITIALIZE GETSPACE PB        */ 02568000
         XC    SPAZPB(12),SPAZPB                                   0719 02569000
*           SPZBLNG = LENGTH(UPT);  /* LENGTH OF UPT AREA            */ 02570000
         MVC   SPZBLNG(2),@CH00049                                 0720 02571000
*           CALL  DOGETSP;          /* GET ASSIGNED SPACE            */ 02572000
         BAL   @14,DOGETSP                                         0721 02573000
*           UADSUPTP = SPZBLOC;     /* SET OFFSET TO UPT AREA        */ 02574000
         L     @08,HEDBPTR                                         0722 02575000
         L     @15,SPZBLOC                                         0722 02576000
         ST    @15,UADSUPTP(,@08)                                  0722 02577000
*           RESPECIFY  (UPT) BASED(HEDBPTR+UADSUPTP);              0723 02578000
*           UPT=(RINBUFP+(RINBUFP->UADSUPTP))->UPT; /* COPY OLD UPT  */ 02579000
         ALR   @08,@15                                             0724 02580000
         L     @15,RINBUFP                                         0724 02581000
         LR    @14,@15                                             0724 02582000
         AL    @14,UADSUPTP(,@15)                                  0724 02583000
         MVC   UPT(24,@08),UPT(@14)                                0724 02584000
*           IF RINBUFP->UADSEXPF = '0'B/* NEW FORMAT INPUT   OA00910 */ 02585000
*             THEN                  /* NO,                   OA00910 */ 02586000
         TM    UADSEXPF(@15),B'01000000'                           0725 02587000
         BNZ   @RF00725                                            0725 02588000
*               DO;                 /*                       OA00910 */ 02589000
*                 UPTPREFL=NODIDL;  /* INSERT LNG OF PREFIS  OA00910 */ 02590000
         LH    @15,NODIDL                                          0727 02591000
         STC   @15,UPTPREFL(,@08)                                  0727 02592000
*                 UPTPREFX='       ';/*                            0728 02593000
*                                      BLANK OUT CHAR AREA   OA00910 */ 02594000
         MVC   UPTPREFX(7,@08),@CC01934                            0728 02595000
*                 UPTPREFX(1:NODIDL)=NODIDC;  /* SET PREFIX  OA00910 */ 02596000
         BCTR  @15,0                                               0729 02597000
         EX    @15,@SM02090                                        0729 02598000
*                END;               /*                       OA00910 */ 02599000
*           IF RINBUFP->UADSEXPF = '1'B&/*                         0731 02600000
*                                         IF INPUT UADS      @ZA10449*/ 02601000
*              RINBUFP->UADSPERP ^= 0  /* HAD PREFORM GROUPS @ZA10449*/ 02602000
*             THEN DO;                 /* COPY TO NEW UADS   @ZA10449*/ 02603000
@RF00725 L     @08,RINBUFP                                         0731 02604000
         TM    UADSEXPF(@08),B'01000000'                           0731 02605000
         BNO   @RF00731                                            0731 02606000
         L     @08,UADSPERP(,@08)                                  0731 02607000
         LTR   @08,@08                                             0731 02608000
         BZ    @RF00731                                            0731 02609000
*               SPAZPB=SPAZPB&&SPAZPB; /* CLEAR PARM LIST    @ZA10449*/ 02610000
         XC    SPAZPB(12),SPAZPB                                   0733 02611000
*               SPZBLNG = LENGTH(PERFGRP);  /* SET LENGTH    @ZA10449*/ 02612000
         MVC   SPZBLNG(2),@CH00113                                 0734 02613000
*               CALL DOGETSP;          /* OBTAIN SPACE       @ZA10449*/ 02614000
         BAL   @14,DOGETSP                                         0735 02615000
*               UADSPERP = SPZBLOC;         /* POINT TO SPACE@ZA10449*/ 02616000
         L     @08,HEDBPTR                                         0736 02617000
         L     @15,SPZBLOC                                         0736 02618000
         ST    @15,UADSPERP(,@08)                                  0736 02619000
*               RESPECIFY (PERFGRP) BASED(HEDBPTR+UADSPERP);       0737 02620000
*                                   /* SET BASE FOR PERF GRP @ZA10449*/ 02621000
*               PERFGRP=(RINBUFP+(RINBUFP->UADSPERP))->PERFGRP;    0738 02622000
         ALR   @08,@15                                             0738 02623000
         L     @15,RINBUFP                                         0738 02624000
         LR    @14,@15                                             0738 02625000
         AL    @14,UADSPERP(,@15)                                  0738 02626000
         MVC   PERFGRP(32,@08),PERFGRP(@14)                        0738 02627000
*             END;                  /* COPY PERF GOUPS       @ZA10449*/ 02628000
*           HEDBPTR = RINBUFP;      /* RESTORE MAP TO INPUT UADS     */ 02629000
@RF00731 L     @08,RINBUFP                                         0740 02630000
         ST    @08,HEDBPTR                                         0740 02631000
*           IF UADSEXPF = '1'B      /* CHK IF INPUT IS NEW FORMAT    */ 02632000
*             THEN                  /* YES,                          */ 02633000
         TM    UADSEXPF(@08),B'01000000'                           0741 02634000
         BNO   @RF00741                                            0741 02635000
*               CURNEW = '1'B;      /* SET NEW FORMAT FLAG           */ 02636000
         OI    CURNEW,B'10000000'                                  0742 02637000
*             ELSE                  /* INPUT UADS IS OLD FORMAT      */ 02638000
*               CURNEW = '0'B;      /* RESET NEW FORMAT FLAG         */ 02639000
*                                                                  0743 02640000
         B     @RC00741                                            0743 02641000
@RF00741 NI    CURNEW,B'01111111'                                  0743 02642000
*               END;                                               0744 02643000
@RC00741 DS    0H                                                  0745 02644000
*           RESPECIFY (R14) RESTRICTED;                            0745 02645000
@RF00702 DS    0H                                                  0746 02646000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 02647000
         L     R14,SAVLNKB                                         0746 02648000
*           RETURN;                 /* RETURN                        */ 02649000
         B     @EL00003                                            0747 02650000
*/********************************************************************/ 02651000
*/*                                                                  */ 02652000
*/* SEGMENT NAME -- RITEM                                            */ 02653000
*/*                                                                  */ 02654000
*/* DESCRIPTIVE NAME -- N/A                                          */ 02655000
*/*                                                                  */ 02656000
*/* FUNCTION -- BUILD NEW USERID MEMBER -- BUILD OFFSET BLOCK        */ 02657000
*/*   OPERATION --                                                   */ 02658000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 02659000
*/*   -  IF TERMINATION FLAG (QUITCHK( IS SET, SKIP RITEM FUNCTION   */ 02660000
*/*   -  FIND NEXT OFFSET BLOCK IN INPUT UADS (RINBUF),  IF OFFSET   */ 02661000
*/*      BLOCK IS CHAINED TO NEXT OFFSET ON SAME LEVEL, BY ADDING    */ 02662000
*/*      LATERAL OFFSET (ONMFNX2) AND LOCATION OF THE MEMBER BLOCK   */ 02663000
*/*      (RINBUFP).  IF OFFSET BLOCK IS NOT CHAINED, ADD THE OFFSET  */ 02664000
*/*      (ONFSUB1) OF SUBLEVEL OFFSET BLOCK TO LOCATION OF MEMBER    */ 02665000
*/*      BLOCK (RINBUFP)                                             */ 02666000
*/*   -  COPY THE LOCATED OFFSET BLOCK (OCRUNODE) INTO THE INPUT     */ 02667000
*/*      REBUILD-CONTROL TABLE (ONMOFS2)                             */ 02668000
*/*   -  IF CURRENT INPUT LEVEL CONTAINS A DATA BLOCK (OFFSET VALUE  */ 02669000
*/*      IN ONFDAT2), SET DATA BLOCK POINTER (ONDLOC2) TO LOCATION   */ 02670000
*/*      SPECIFIED BY THAT OFFSET LEVEL PLUS LOCATION OF INPUT       */ 02671000
*/*      BUFFER (RINBUFP).  OTHERWISE, SET THE DATA BLOCK POINTER    */ 02672000
*/*      (ONDLOC2) TO ZERO                                           */ 02673000
*/*   -  CALL SEGMENT DOGETSP TO OBTAIN OFFSET BLOCK SPACE (VIA THE  */ 02674000
*/*      ACCOUNT-GETSPACE ROUTINE)                                   */ 02675000
*/*   -  IF LATERAL CHAINING IS NOT CURRENTLY ACTIVE (CHAINOW), SET  */ 02676000
*/*      ACQUIRED SPACE OFFSET IN PRIOR LEVELS SUBLEVEL OFFSET POSI- */ 02677000
*/*      TION IN THE OUTPUT REBUILD-CONTROL TABLE (NNFSUB1) AND IN   */ 02678000
*/*      THE OUTPUT IMAGE (NLASUSUB).                                */ 02679000
*/*   -  SET  ACQUIRED OFFSET  IN CURRENT NEXT-INCIDENCE-OF-LEVEL    */ 02680000
*/*      POSITION IN OUTPUT IMAGE (NCURUNEX)                         */ 02681000
*/*   -  IF INPUT  CONTROL-LATERAL-CHAINING  FLAG (ONFLG21)  IS SET  */ 02682000
*/*      THEN SET OUTPUT CONTROL FLAG ON (NNFLG21).  ELSE SET FLAG   */ 02683000
*/*      OFF (NNFLG21)                                               */ 02684000
*/*   -  FORM POINTER TO OUTPUT IMAGE OF NEW OFFSET BLOCK BY ADDING  */ 02685000
*/*      NEW OFFSET PLUS OUTPUT BUFFER LOCATION AND PLACE SUM IN THE */ 02686000
*/*      OUTPUT CONTROL TABLE CURRENT OFFSET BLOCK POINTER (NNFLOC2) */ 02687000
*/*   -  IF LATERAL CHAINING FLAG IS ON IN OUTPUT CONTROL TABLE      */ 02688000
*/*      (NNFLG21) SET CHAINING FLAG ON IN OUTPUT IMAGE (NCURUFLG).  */ 02689000
*/*      OTHERWISE, SET FLAG OFF (NCURUFLG).                         */ 02690000
*/*   -  PERFORM SEGMENT RITEM2 TO BUILD ASSOCIATED DATA BLOCK       */ 02691000
*/*   -  RESET CURRENT NEXT-INCIDENCE-OF-LEVEL POSITION IN OUTPUT    */ 02692000
*/*      CONTROL TABLE (NNMFNX2).  RESET CURRENT NEXT-INCIDENCE AND  */ 02693000
*/*      CURRENT SUBLEVEL POSITIONS IN NEW OFFSET BLOCK IN OUTPUT    */ 02694000
*/*      IMAGE (NCURUNEX AND NCURUSUB, BOTH BASED ON UPDATED POINTER */ 02695000
*/*      NNFLOC2)                                                    */ 02696000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 02697000
*/* SEGMENT NAME -- RITEM  (CONTINUED)                               */ 02698000
*/*                                                                  */ 02699000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 02700000
*/*                                                                  */ 02701000
*/* INPUT --                                                         */ 02702000
*/*   -  UADSREFM ENVIRONMENT                                        */ 02703000
*/*                                                                  */ 02704000
*/* OUTPUT --                                                        */ 02705000
*/*   -  OUTPUT OFFSET BLOCK BUILT (DATA BLOCK BUILT VIA RITEM2)     */ 02706000
*/*                                                                  */ 02707000
*/* EXTERNAL REFERENCES -- N/A                                       */ 02708000
*/*                                                                  */ 02709000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 02710000
*/*   CONDITIONS -- N/A                                              */ 02711000
*/*   RETURN CODE -- N/A                                             */ 02712000
*/*                                                                  */ 02713000
*/* EXIT-ERROR -- N/A                                                */ 02714000
*/*   CONDITIONS -- N/A                                              */ 02715000
*/*   RETURN CODE -- N/A                                             */ 02716000
*/*                                                                  */ 02717000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 02718000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 02719000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 02720000
*/*                                                                  */ 02721000
*/********************************************************************/ 02722000
*RITEM:     /* BUILD NEW USERID MEMBER -- BUILD OFFSET BLOCK DATA    */ 02723000
*           ENTRY;                                                 0748 02724000
RITEM    DS    0H                                                  0749 02725000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 02726000
         ST    R14,SAVLNKB                                         0749 02727000
*           RESPECIFY (R14) UNRESTRICTED;                          0750 02728000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG  ?       */ 02729000
*             THEN                  /* NO,                           */ 02730000
         TM    QUITCHK,B'11100000'                                 0751 02731000
         BNZ   @RF00751                                            0751 02732000
*               DO;                 /* ESTABLISH OFFSET BLOCK        */ 02733000
*                                                                  0752 02734000
*           IF CHAINOW = '0'B       /* CURRENTLY CHAINING NOW ?      */ 02735000
*             THEN                  /* NO,                           */ 02736000
         TM    CHAINOW,B'10000000'                                 0753 02737000
         BNZ   @RF00753                                            0753 02738000
*               ONFLOC2 = ONFSUB1 + ADDR(RINBUF); /* IS SUBLVL       */ 02739000
         L     @08,ONMIDP                                          0754 02740000
         L     @15,ONFSUB1(,@08)                                   0754 02741000
         AL    @15,RINBUFP                                         0754 02742000
         ST    @15,ONFLOC2(,@08)                                   0754 02743000
*             ELSE                  /* YES,                          */ 02744000
*               ONFLOC2 = ONMFNX2+ADDR(RINBUF); /* IS NEXT LVL       */ 02745000
         B     @RC00753                                            0755 02746000
@RF00753 L     @08,ONMIDP                                          0755 02747000
         L     @15,ONMFNX2-1(,@08)                                 0755 02748000
         LA    @15,0(,@15)                                         0755 02749000
         AL    @15,RINBUFP                                         0755 02750000
         ST    @15,ONFLOC2(,@08)                                   0755 02751000
*           ONMOFS2 = OCRUNODE;     /* RESERVE CURRENT OFFSET BLK    */ 02752000
@RC00753 L     @08,ONMIDP                                          0756 02753000
         L     @01,ONFLOC2(,@08)                                   0756 02754000
         MVC   ONMOFS2(12,@08),OCRUNODE(@01)                       0756 02755000
*           IF ONFDAT2 ^= 0         /* CHK FOR ANY DATA FIELD        */ 02756000
*             THEN                  /** YES,                         */ 02757000
         L     @15,ONFDAT2(,@08)                                   0757 02758000
         LTR   @15,@15                                             0757 02759000
         BZ    @RF00757                                            0757 02760000
*               ONDLOC2 = ONFDAT2+ADDR(RINBUF);  /* SET OFFSET       */ 02761000
         AL    @15,RINBUFP                                         0758 02762000
         ST    @15,ONDLOC2(,@08)                                   0758 02763000
*             ELSE                  /* NO DATA FIELD                 */ 02764000
*               ONDLOC2 = 0;        /* CLEAR OFFSET                  */ 02765000
*                                                                  0759 02766000
         B     @RC00757                                            0759 02767000
@RF00757 L     @08,ONMIDP                                          0759 02768000
         SLR   @15,@15                                             0759 02769000
         ST    @15,ONDLOC2(,@08)                                   0759 02770000
*           SPZBLNG = 12;           /* SET LENGTH OF OFFSET BLOCK    */ 02771000
@RC00757 MVC   SPZBLNG(2),@CH00036                                 0760 02772000
*           CALL  DOGETSP;          /* GET SPACE FOR OFFSET BLOCK    */ 02773000
*                                                                  0761 02774000
         BAL   @14,DOGETSP                                         0761 02775000
*           IF CHAINOW = '0'B       /* CURRENTLY CHAINING NOW ?      */ 02776000
*             THEN                  /* NO,                           */ 02777000
         TM    CHAINOW,B'10000000'                                 0762 02778000
         BNZ   @RF00762                                            0762 02779000
*               DO;                                                0763 02780000
*                 NNFSUB1 = SPZBLOC;  /* SET SUBLEVEL OFFSET         */ 02781000
         L     @08,SPZBLOC                                         0764 02782000
         L     @15,NNMIDP                                          0764 02783000
         ST    @08,NNFSUB1(,@15)                                   0764 02784000
*                 NLASUSUB = SPZBLOC; /*    AND IN BUFFER            */ 02785000
         L     @01,NNFLOC1(,@15)                                   0765 02786000
         ST    @08,@TF00001                                        0765 02787000
         MVC   NLASUSUB(3,@01),@TF00001+1                          0765 02788000
*               END;                                               0766 02789000
*           NCURUNEX = SPZBLOC;     /* SET NEXT OFFSET IN BUFFER     */ 02790000
@RF00762 L     @08,NNMIDP                                          0767 02791000
         L     @01,NNFLOC2(,@08)                                   0767 02792000
         MVC   NCURUNEX(3,@01),SPZBLOC+1                           0767 02793000
*           NNFLG21='0'B;           /* CLEAR NEW CHAINING FLAG       */ 02794000
         NI    NNFLG21(@08),B'01111111'                            0768 02795000
*           IF ONFLG21='1'B         /* CHK IF OLD FLAG ON            */ 02796000
*             THEN                  /* YES,                          */ 02797000
         L     @01,ONMIDP                                          0769 02798000
         TM    ONFLG21(@01),B'10000000'                            0769 02799000
         BNO   @RF00769                                            0769 02800000
*               NNFLG21='1'B;       /* SET NEW FLAG ON               */ 02801000
         OI    NNFLG21(@08),B'10000000'                            0770 02802000
*           NNFLOC2 = SPZBLOC + ADDR(REXBUF); /* SET OB PTR          */ 02803000
@RF00769 L     @08,NNMIDP                                          0771 02804000
         L     @15,SPZBLOC                                         0771 02805000
         AL    @15,REXBUFP                                         0771 02806000
         ST    @15,NNFLOC2(,@08)                                   0771 02807000
*           NCURUFLG='0'B;          /* SET NEW FLAG OFF              */ 02808000
         NI    NCURUFLG(@15),B'01111111'                           0772 02809000
*           IF NNFLG21='1'B         /* CHK IF LEVEL FLAG ON          */ 02810000
*             THEN                  /* YES,                          */ 02811000
         TM    NNFLG21(@08),B'10000000'                            0773 02812000
         BNO   @RF00773                                            0773 02813000
*               NCURUFLG='1'B;      /* SET NEW FLAG ON               */ 02814000
*                                                                  0774 02815000
         OI    NCURUFLG(@15),B'10000000'                           0774 02816000
*           CALL  RITEM2;           /* ESTABLISH DATA BLOCK          */ 02817000
*                                                                  0775 02818000
@RF00773 BAL   @14,RITEM2                                          0775 02819000
*           NNMFNX2 = 0;            /*       CLEAR                   */ 02820000
         L     @08,NNMIDP                                          0776 02821000
         SLR   @15,@15                                             0776 02822000
         ST    @15,@TF00001                                        0776 02823000
         MVC   NNMFNX2(3,@08),@TF00001+1                           0776 02824000
*           NCURUNEX = 0;           /*   CURRENT LEVEL               */ 02825000
         L     @08,NNFLOC2(,@08)                                   0777 02826000
         SLR   @15,@15                                             0777 02827000
         ST    @15,@TF00001                                        0777 02828000
         MVC   NCURUNEX(3,@08),@TF00001+1                          0777 02829000
*           NCURUSUB = 0;           /*      OFFSETS                  */ 02830000
*                                                                  0778 02831000
         SLR   @15,@15                                             0778 02832000
         ST    @15,@TF00001                                        0778 02833000
         MVC   NCURUSUB(3,@08),@TF00001+1                          0778 02834000
*               END;                                               0779 02835000
*           RESPECIFY (R14) RESTRICTED;                            0780 02836000
@RF00751 DS    0H                                                  0781 02837000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 02838000
         L     R14,SAVLNKB                                         0781 02839000
*           RETURN;                 /* RETURN                        */ 02840000
         B     @EL00003                                            0782 02841000
*/********************************************************************/ 02842000
*/*                                                                  */ 02843000
*/* SEGMENT NAME -- ADJLVL                                           */ 02844000
*/*                                                                  */ 02845000
*/* DESCRIPTIVE NAME -- N/A                                          */ 02846000
*/*                                                                  */ 02847000
*/* FUNCTION -- ADJUST LEVEL POINTERS TO SCAN AND REBUILD NEXT       */ 02848000
*/*             AUTHORIZATION PATH SEGMENT                           */ 02849000
*/*   OPERATION --                                                   */ 02850000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 02851000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP ADJLVL FUNCTION  */ 02852000
*/*   -  SET NOT-CURRENTLY-CHAINING FLAG (CHAINOW)                   */ 02853000
*/*   -  IF CURRENTLY PROCESSED LEVEL (TSTLVL) WAS HIGHEST AUTHORI-  */ 02854000
*/*      ZATION LEVEL (TOPLVL), THEN IF INPUT CURRENT NEXT-INCIDENCE-*/ 02855000
*/*      OF-LEVEL OFFSET EXISTS (ONMIFNX2) SET CONTROL FLAG (DOWHYL) */ 02856000
*/*      TO CONTINUE PROCESSING MEMBER.  IF INPUT CURRENT LEVEL      */ 02857000
*/*      AUTHORIZATION PATH ENDS (ONFLG21)(NOT CHAINED) THEN REDUCE  */ 02858000
*/*      POINTERS TO PROCESS PREVIOUS LEVEL (TSTLVL, ONMIDP, NNMIDP) */ 02859000
*/*      AND SET CONTROL FLAG TO REPEAT CHECK UNTIL LOWEST LEVEL, OR */ 02860000
*/*      A LEVEL WHICH IS CHAINED, IS REACHED.  WHEN A CHAINED INPUT */ 02861000
*/*      LEVEL IS ENCOUNTERED, THE CURRENTLY-CHAINING FLAG (CHAINOW) */ 02862000
*/*      IS SET                                                      */ 02863000
*/*   -  IF CURRENTLY PROCESSED LEVEL WAS NOT HIGHEST LEVEL, STEP    */ 02864000
*/*      CONTROL POINTERS TO NEXT LEVEL (TSTLVL, ONMIDP, NNMIDP) AND */ 02865000
*/*      SET CONTROL FLAG (DOWHYL) TO CONTINUE PROCESSING            */ 02866000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 02867000
*/*                                                                  */ 02868000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 02869000
*/*                                                                  */ 02870000
*/* INPUT --                                                         */ 02871000
*/*   -  UADSREFM ENVIRONMENT                                        */ 02872000
*/*                                                                  */ 02873000
*/* OUTPUT --                                                        */ 02874000
*/*   -  CONTROL POINTERS SET TO NEXT REBUILD LEVEL                  */ 02875000
*/*                                                                  */ 02876000
*/* EXTERNAL REFERENCES -- N/A                                       */ 02877000
*/*                                                                  */ 02878000
*/* EXIT-NORMAL -- N/A                                               */ 02879000
*/*   CONDITIONS -- N/A                                              */ 02880000
*/*   RETURN CODE -- N/A                                             */ 02881000
*/*                                                                  */ 02882000
*/* EXIT-ERROR -- N/A                                                */ 02883000
*/*   CONDITIONS -- N/A                                              */ 02884000
*/*   RETURN CODE -- N/A                                             */ 02885000
*/*                                                                  */ 02886000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 02887000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 02888000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 02889000
*/*                                                                  */ 02890000
*/********************************************************************/ 02891000
*ADJLVL:    /* ADJUST LEVEL PTRS TO SCAN AND REFORM NEXT ITEM/PATH   */ 02892000
*           ENTRY;                                                 0783 02893000
ADJLVL   DS    0H                                                  0784 02894000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 02895000
         ST    R14,SAVLNKB                                         0784 02896000
*           RESPECIFY (R14) UNRESTRICTED;                          0785 02897000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 02898000
*             THEN                  /* NO,                           */ 02899000
         TM    QUITCHK,B'11100000'                                 0786 02900000
         BNZ   @RF00786                                            0786 02901000
*               DO;                                                0787 02902000
*                                                                  0787 02903000
*           CHAINOW = '0'B;         /* SET NOT-CHAINING FLAG         */ 02904000
         NI    CHAINOW,B'01111111'                                 0788 02905000
*           IF TSTLVL = TOPLVL      /* CHK FOR END OF PATH           */ 02906000
*             THEN                  /* YES,                          */ 02907000
         CLC   TSTLVL(4),TOPLVL                                    0789 02908000
         BNE   @RF00789                                            0789 02909000
*               DO;                                                0790 02910000
*                 IF ONMFNX2 ^= 0     /* CHK FOR LATERAL CHAIN       */ 02911000
*                   THEN            /* YES,                          */ 02912000
         L     @08,ONMIDP                                          0791 02913000
         L     @08,ONMFNX2-1(,@08)                                 0791 02914000
         LA    @08,0(,@08)                                         0791 02915000
         LTR   @08,@08                                             0791 02916000
         BZ    @RF00791                                            0791 02917000
*                     DO DOWHYL2 = 1 TO 1;         /* TO BACK-SCAN   */ 02918000
         LA    @08,1                                               0792 02919000
         STH   @08,DOWHYL2                                         0792 02920000
@DL00792 DS    0H                                                  0793 02921000
*                       DOWHYL = 0;   /* TO CONTINUE PROCESSING MBR  */ 02922000
         SLR   @08,@08                                             0793 02923000
         STH   @08,DOWHYL                                          0793 02924000
*                       IF ONFLG21 = '1'B /* CHK FOR LOCAL PATH END  */ 02925000
*                         THEN      /* YES,                          */ 02926000
         L     @15,ONMIDP                                          0794 02927000
         TM    ONFLG21(@15),B'10000000'                            0794 02928000
         BNO   @RF00794                                            0794 02929000
*                           DO;                                    0795 02930000
*                             TSTLVL=TSTLVL-LSPAN; /* BKSP TOP TEST  */ 02931000
         L     @14,LSPAN                                           0796 02932000
         L     @07,TSTLVL                                          0796 02933000
         SLR   @07,@14                                             0796 02934000
         ST    @07,TSTLVL                                          0796 02935000
*                             ONMIDP=ONMIDP-LSPAN; /* BKSP INPUT PTR */ 02936000
         SLR   @15,@14                                             0797 02937000
         ST    @15,ONMIDP                                          0797 02938000
*                             NNMIDP=NNMIDP-LSPAN; /* BKSP OUTPUT PT */ 02939000
         LCR   @14,@14                                             0798 02940000
         AL    @14,NNMIDP                                          0798 02941000
         ST    @14,NNMIDP                                          0798 02942000
*                             DOWHYL2 = 0;  /* TO CHK PREVIOUS LEVEL */ 02943000
         STH   @08,DOWHYL2                                         0799 02944000
*                           END;                                   0800 02945000
*                         ELSE      /* NOT END OF LOCAL PATH,        */ 02946000
*                           CHAINOW = '1'B; /* SET CHAINING-NOW FLAG */ 02947000
         B     @RC00794                                            0801 02948000
@RF00794 OI    CHAINOW,B'10000000'                                 0801 02949000
*                     END;                                         0802 02950000
@RC00794 LA    @08,1                                               0802 02951000
         AH    @08,DOWHYL2                                         0802 02952000
         STH   @08,DOWHYL2                                         0802 02953000
         CH    @08,@CH00032                                        0802 02954000
         BNH   @DL00792                                            0802 02955000
*               END;                                               0803 02956000
*             ELSE                  /* NOT END OF PATH,              */ 02957000
*               DO;                 /* SET POINTERS TO NEXT LEVEL    */ 02958000
         B     @RC00789                                            0804 02959000
@RF00789 DS    0H                                                  0805 02960000
*                 TSTLVL = TSTLVL+LSPAN;  /* STEP TOP TEST           */ 02961000
         L     @08,LSPAN                                           0805 02962000
         L     @15,TSTLVL                                          0805 02963000
         ALR   @15,@08                                             0805 02964000
         ST    @15,TSTLVL                                          0805 02965000
*                 ONMIDP=ONMIDP+LSPAN;  /* STEP INPUT POINTER        */ 02966000
         L     @15,ONMIDP                                          0806 02967000
         ALR   @15,@08                                             0806 02968000
         ST    @15,ONMIDP                                          0806 02969000
*                 NNMIDP=NNMIDP+LSPAN;  /* STEP OUTPUT POINTER       */ 02970000
         AL    @08,NNMIDP                                          0807 02971000
         ST    @08,NNMIDP                                          0807 02972000
*                 DOWHYL = 0;       /* TO CONTINUE PROCESSING MEMBER */ 02973000
         SLR   @08,@08                                             0808 02974000
         STH   @08,DOWHYL                                          0808 02975000
*               END;                                               0809 02976000
*                                                                  0809 02977000
*               END;                                               0810 02978000
@RC00789 DS    0H                                                  0811 02979000
*           RESPECIFY (R14) RESTRICTED;                            0811 02980000
@RF00786 DS    0H                                                  0812 02981000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 02982000
         L     R14,SAVLNKB                                         0812 02983000
*           RETURN;                 /* RETURN                        */ 02984000
         B     @EL00003                                            0813 02985000
*/********************************************************************/ 02986000
*/*                                                                  */ 02987000
*/* SEGMENT NAME -- RENQM2                                           */ 02988000
*/*                                                                  */ 02989000
*/* DESCRIPTIVE NAME -- N/A                                          */ 02990000
*/*                                                                  */ 02991000
*/* FUNCTION -- CHECK RETURN CODE FOR ENQ ON SYSIKJUA/'USERID NAME'  */ 02992000
*/*   OPERATION --                                                   */ 02993000
*/*    - SAVE ENTRY LINK REGISTER 14                                 */ 02994000
*/*    - IF RETURN CODE IS SUCCESSFUL (CODE 0 OR CODE 8), RETURN     */ 02995000
*/*      IMMEDIATELY                                                 */ 02996000
*/*    - IF RETURN CODE IS NOT SUCCESSFUL, SET USERID PROCESSING     */ 02997000
*/*      TERMINATION FLAG (UIDQUIT)                                  */ 02998000
*/*    - IF RETURN CODE IS 4, ISSUE ERROR MESSAGE 6                  */ 02999000
*/*    - IF ANY OTHER FAILURE RETURN CODE, ISSUE ERROR MESSAGE 13    */ 03000000
*/*    - RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 03001000
*/*                                                                  */ 03002000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 03003000
*/*                                                                  */ 03004000
*/* INPUT --                                                         */ 03005000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03006000
*/*   -  POINTER TO RETURN CODE IN RCLC1                             */ 03007000
*/*                                                                  */ 03008000
*/* OUTPUT --                                                        */ 03009000
*/*                                                                  */ 03010000
*/* EXTERNAL REFERENCES -- N/A                                       */ 03011000
*/*                                                                  */ 03012000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 03013000
*/*   CONDITIONS -- N/A                                              */ 03014000
*/*   RETURN CODE -- N/A                                             */ 03015000
*/*                                                                  */ 03016000
*/* EXIT-ERROR --                                                    */ 03017000
*/*   CONDITIONS -- N/A                                              */ 03018000
*/*   RETURN CODE -- N/A                                             */ 03019000
*/*                                                                  */ 03020000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 03021000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 03022000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 03023000
*/*                                                                  */ 03024000
*/********************************************************************/ 03025000
*RENQM2:    /* CHECK RETURN CODE FOR ENQ ON USERID MEMBER NAME       */ 03026000
*           ENTRY;                                                 0814 03027000
RENQM2   DS    0H                                                  0815 03028000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 03029000
         ST    R14,SAVLNKB                                         0815 03030000
*           RESPECIFY (R14) UNRESTRICTED;                          0816 03031000
*                                                                  0816 03032000
*           IF RCLC1^=0             /* CHK FOR UNSATISFACTORY        */ 03033000
*               & RCLC1^=8          /*     RETURN CODE               */ 03034000
*             THEN                  /* YES,                          */ 03035000
         L     @08,RCPTR                                           0817 03036000
         CLI   RCLC1(@08),0                                        0817 03037000
         BE    @RF00817                                            0817 03038000
         CLI   RCLC1(@08),8                                        0817 03039000
         BE    @RF00817                                            0817 03040000
*               DO;                                                0818 03041000
*                 UIDQUIT = '1'B;   /* SET USERID TERMINATION FLAG   */ 03042000
         OI    UIDQUIT,B'10000000'                                 0819 03043000
*                 IF RCLC1 = 4      /* CHK IF USERID IN USE          */ 03044000
*                   THEN            /* YES,                          */ 03045000
         CLI   RCLC1(@08),4                                        0820 03046000
         BNE   @RF00820                                            0820 03047000
*                     DO;                                          0821 03048000
*                       MSGNO = 6;  /* SET MESSAGE INDEX             */ 03049000
         MVC   MSGNO(2),@CH00118                                   0822 03050000
*                       CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT       */ 03051000
         BAL   @14,MSGFNDR                                         0823 03052000
*                       TMSGNS1(1:20)=TMXMDL;  /* SEGMENT LIST       */ 03053000
         L     @08,MSGPTR                                          0824 03054000
         MVC   TMSGNS1(20),TMXMDL(@08)                             0824 03055000
*                       TMSGNP13=ADDR(TMSGTIX1);  /* 3RD SEGMENT     */ 03056000
         LA    @08,TMSGTIX1                                        0825 03057000
         ST    @08,TMSGNP13                                        0825 03058000
*                       TMSGTIL1 = NODIDL+4;   /* LENGTH OF SEGMENT  */ 03059000
         LH    @08,NODIDL                                          0826 03060000
         LA    @01,4(,@08)                                         0826 03061000
         STH   @01,TMSGTIL1                                        0826 03062000
*                       TMSGTIO1 = 9;   /* SET INSERT OFFSET         */ 03063000
         MVC   TMSGTIO1(2),@CH00033                                0827 03064000
*                       TMSGTIN1(1:NODIDL)  /* INSERT USERID         */ 03065000
*                           =NODIDC(1:NODIDL);  /*  TEXT             */ 03066000
         BCTR  @08,0                                               0828 03067000
         EX    @08,@SM02092                                        0828 03068000
*                       MSGPTR = ADDR(TMSGNS1);  /* TEXT PTR         */ 03069000
         LA    @08,TMSGNS1                                         0829 03070000
         ST    @08,MSGPTR                                          0829 03071000
*                       CALL FXPUTL;  /* INITIALIZE PARM BLOCK       */ 03072000
         BAL   @14,FXPUTL                                          0830 03073000
*                       CALL  DOPUTL; /* GO TO ISSUE MESSAGE         */ 03074000
         BAL   @14,DOPUTL                                          0831 03075000
*                     END;                                         0832 03076000
*                   ELSE            /* NOT RETURN CODE 4             */ 03077000
*                     DO;                                          0833 03078000
         B     @RC00820                                            0833 03079000
@RF00820 DS    0H                                                  0834 03080000
*                       RTNCODE = RCLC1;  /* SET FOR TEXT            */ 03081000
         L     @08,RCPTR                                           0834 03082000
         SLR   @15,@15                                             0834 03083000
         IC    @15,RCLC1(,@08)                                     0834 03084000
         ST    @15,RTNCODE                                         0834 03085000
*                       MSGNO = 13;   /* SET MESSAGE INDEX           */ 03086000
         MVC   MSGNO(2),@CH01676                                   0835 03087000
*                       SOFFS = 20;   /* SET INSERT OFFSET           */ 03088000
         MVC   SOFFS(2),@CH00351                                   0836 03089000
*                       CALL  SYSERRD;  /* GO TO ISSUE MESSAGE       */ 03090000
         BAL   @14,SYSERRD                                         0837 03091000
*                     END;                                         0838 03092000
*               END;                                               0839 03093000
*                                                                  0839 03094000
@RC00820 DS    0H                                                  0840 03095000
*           RESPECIFY (R14) RESTRICTED;                            0840 03096000
@RF00817 DS    0H                                                  0841 03097000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 03098000
         L     R14,SAVLNKB                                         0841 03099000
*           RETURN;                 /* RETURN                        */ 03100000
         B     @EL00003                                            0842 03101000
*/********************************************************************/ 03102000
*/*                                                                  */ 03103000
*/* SEGMENT NAME -- DOUPDAT                                          */ 03104000
*/*                                                                  */ 03105000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03106000
*/*                                                                  */ 03107000
*/* FUNCTION -- WRITE REVISED MEMBER BLOCK BACK IN UPDAT MODE        */ 03108000
*/*   OPERATION --                                                   */ 03109000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 03110000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP DOUPDAT FUNCTION */ 03111000
*/*   -  MOVE OUTPUT BUFFER INTO UPDAT BUFFER                        */ 03112000
*/*   -  IF THE EXTRA BLOCK SPACE WAS USED, SET POINTER (PPPPTR) TO  */ 03113000
*/*      THE EXTRA DCB (RINDCB), SET REGISTER 1 TO POINT TO OUTPUT   */ 03114000
*/*      MODE PARAMETER BLOCK (RXOPNL) AND PERFORM SEGMENT OPENDCB   */ 03115000
*/*      TO EXECUTE OPEN.  SAVE UPDAT-MODE ACCOUNT-WRITE PARAMETER   */ 03116000
*/*      BLOCK (RWPB).  SET RWPB TO WRITE THE EXTRA BLOCK THROUGH    */ 03117000
*/*      DCB (RINDCB) IN CREATE (OUTPUT)MODE.  PERFORM SEGMENT       */ 03118000
*/*      DOWRT2 TO EXCUTE WRITE.  PERFORM SEGMENT RSTOW TO EXECUTE   */ 03119000
*/*      STOW FOR THE NEW BLOCK.  RESTORE ACCOUNT-WRITE PARAMETER    */ 03120000
*/*      BLOCK (RWPB) FROM THE SAVE AREA (RWPBSAV)                   */ 03121000
*/*   -  SET ACCOUNT-WRITE PARAMETER BLOCK POINTER (RWPUDP) WITH     */ 03122000
*/*      LOCATION OF UPDAT DCB (REXDCB) AND NUMBER OF BLOCK TO WRITE */ 03123000
*/*      (RWPNOM) FROM SAVE AREA FOR NUMBER OF UPDAT MODE BLOCKS     */ 03124000
*/*      (ONNOBLK)                                                   */ 03125000
*/*   -  PERFORM SEGMENT DOWRT2 TO EXECUTE WRITE                     */ 03126000
*/*   -  IF INPUT MEMBER IS NOT IN REVISED FORMAT (CURNEW), SET      */ 03127000
*/*      BLOCK IDENTITY IN USERID NAME TO ZERO AND PERFORM SEGMENT   */ 03128000
*/*      RSTOW TO CREATE REVISED FORMAT ENTRY                        */ 03129000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 03130000
*/*                                                                  */ 03131000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 03132000
*/*                                                                  */ 03133000
*/* INPUT --                                                         */ 03134000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03135000
*/*   -  FLAG (XTRBNOW) SET ON                                       */ 03136000
*/*                                                                  */ 03137000
*/* OUTPUT --                                                        */ 03138000
*/*   -  REFORMATTED USERID MEMBER WRITTEN BACK TO UADS (SYSUADS)    */ 03139000
*/*                                                                  */ 03140000
*/* EXTERNAL REFERENCES -- N/A                                       */ 03141000
*/*                                                                  */ 03142000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 03143000
*/*   CONDITIONS -- N/A                                              */ 03144000
*/*   RETURN CODE -- N/A                                             */ 03145000
*/*                                                                  */ 03146000
*/* EXIT-ERROR --                                                    */ 03147000
*/*   CONDITIONS -- N/A                                              */ 03148000
*/*   RETURN CODE -- N/A                                             */ 03149000
*/*                                                                  */ 03150000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 03151000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 03152000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 03153000
*/*                                                                  */ 03154000
*/********************************************************************/ 03155000
*DOUPDAT:   /* WRITE=OUT REVISED MEMBER IN UPDAT MODE                */ 03156000
*           ENTRY;                                                 0843 03157000
*                                                                  0843 03158000
DOUPDAT  DS    0H                                                  0844 03159000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 03160000
         ST    R14,SAVLNKB                                         0844 03161000
*           RESPECIFY (R14) UNRESTRICTED;                          0845 03162000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 03163000
*             THEN                  /* NO,                           */ 03164000
         TM    QUITCHK,B'11100000'                                 0846 03165000
         BNZ   @RF00846                                            0846 03166000
*               DO;                                                0847 03167000
*                                                                  0847 03168000
*           /* MOVE OUTPUT BUFFER TO UPDAT BUFFER                    */ 03169000
*           RESPECIFY  (RSPZOP,RLNG,RFROM,RTO)  RESTRICTED;        0848 03170000
*           RSPZOP = ADDR(MVCOP);   /* PTR TO MOVE CHAR OP           */ 03171000
         LA    RSPZOP,MVCOP                                        0849 03172000
*           RLNG = SPZBLKN*DCBXPTR->DCBBLKSI;  /* SET MOVE LENGTH    */ 03173000
         LH    RLNG,SPZBLKN                                        0850 03174000
         L     @08,DCBXPTR                                         0850 03175000
         MH    RLNG,DCBBLKSI(,@08)                                 0850 03176000
*           RFROM = GMAINP;         /* SET FROM LOCATION             */ 03177000
         L     RFROM,GMAINP                                        0851 03178000
*           RTO = RINBUFP;          /* SET TO LOCATION               */ 03179000
         L     RTO,RINBUFP                                         0852 03180000
*           CALL  DOPSPAZ;          /* MOVE OUTPUT TO UPDAT BUFFER   */ 03181000
         BAL   @14,DOPSPAZ                                         0853 03182000
*           RESPECIFY  (RSPZOP,RLNG,RFROM,RTO)  UNRESTRICTED;      0854 03183000
*                                                                  0854 03184000
*           IF XTRBNOW = '1'B       /* CHK IF EXTRA BLOCK USED       */ 03185000
*             THEN                  /* YES,                          */ 03186000
         TM    XTRBNOW,B'00001000'                                 0855 03187000
         BNO   @RF00855                                            0855 03188000
*               DO;                                                0856 03189000
*                 RESPECIFY (PPPPTR,R1) RESTRICTED;                0857 03190000
*                 PPPPTR = ADDR(REXDCB);  /* PTR TO OUTPUT DCB       */ 03191000
         LA    PPPPTR,REXDCB                                       0858 03192000
*                 R1 = ADDR(RXOPNL);  /* PL FOR EXTRA BLOCK OUTPUT   */ 03193000
         LA    R1,RXOPNL                                           0859 03194000
*                 MSGNO = 4;        /* SET MESSAGE INDEX             */ 03195000
         LA    @08,4                                               0860 03196000
         STH   @08,MSGNO                                           0860 03197000
*                 MSGN2 = 4;        /* SET MESSAGE INDEX FOR OPEN    */ 03198000
         STH   @08,MSGN2                                           0861 03199000
*                 MSGN3 = 29;       /* SET MESSAGE INDEX FOR CLOSE   */ 03200000
         MVC   MSGN3(2),@CH01868                                   0862 03201000
*                 CALL  OPENDCB;    /* GO TO OPEN FOR OUTPUT         */ 03202000
         BAL   @14,OPENDCB                                         0863 03203000
*                 RESPECIFY (PPPPTR,R1) UNRESTRICTED;              0864 03204000
*                 RWPBSAV = RWPB;   /* RESERVE UPDAT PARM BLOCK      */ 03205000
         MVC   RWPBSAV(24),RWPB                                    0865 03206000
*                 RWPBUF=REXBUFP+DCBXPTR->DCBBLKSI*OLNOBLK;        0866 03207000
         L     @08,DCBXPTR                                         0866 03208000
         LH    @08,DCBBLKSI(,@08)                                  0866 03209000
         MH    @08,OLNOBLK                                         0866 03210000
         AL    @08,REXBUFP                                         0866 03211000
         ST    @08,@TF00001                                        0866 03212000
         MVC   RWPBUF(3),@TF00001+1                                0866 03213000
*                                   /* LOCATE BUFFER                 */ 03214000
*                 RWPUDP = ADDR(REXDCB);  /* FOR SYSUADS OUTPUT DCB  */ 03215000
         LA    @08,REXDCB                                          0867 03216000
         ST    @08,@TF00001                                        0867 03217000
         MVC   RWPUDP(3),@TF00001+1                                0867 03218000
*                 RWPRBP = 0;       /* SET CREATE MODE INDICATION    */ 03219000
         SLR   @08,@08                                             0868 03220000
         ST    @08,RWPRBP                                          0868 03221000
*                 RWPF3 = '0'B;     /* SET NOT-DIRWA-PTR FLAG        */ 03222000
         NI    RWPF3,B'11011111'                                   0869 03223000
*                 RWPNOM = 1;       /* FOR EXTRA BLOCK OUTPUT WRITE  */ 03224000
         MVI   RWPNOM,X'01'                                        0870 03225000
*                 CALL  DOWRT2;     /* GO TO WRITE EXTRA BLOCK       */ 03226000
         BAL   @14,DOWRT2                                          0871 03227000
*                 NODIDC(NODIDL+1)=OLNOBLK+1|'0';     /* EXTENT ID   */ 03228000
         LH    @08,NODIDL                                          0872 03229000
         LA    @15,1                                               0872 03230000
         AH    @15,OLNOBLK                                         0872 03231000
         O     @15,@CF01890                                        0872 03232000
         STC   @15,NODIDC(@08)                                     0872 03233000
*                 CALL  RSTOW;      /* GO TO STOW ADDED BLOCK        */ 03234000
         BAL   @14,RSTOW                                           0873 03235000
*                 RWPB = RWPBSAV;   /* RESTORE UPDAT PARM BLOCK      */ 03236000
         MVC   RWPB(24),RWPBSAV                                    0874 03237000
*               END;                                               0875 03238000
*                                                                  0875 03239000
*           RWPUDP = ADDR(RINDCB);  /* PTR TO SYSUADS UPDAT DCB      */ 03240000
@RF00855 LA    @08,RINDCB                                          0876 03241000
         ST    @08,@TF00001                                        0876 03242000
         MVC   RWPUDP(3),@TF00001+1                                0876 03243000
*           CALL  DOWRT2;           /* TO WRITE UPDAT BLOCKS         */ 03244000
         BAL   @14,DOWRT2                                          0877 03245000
*           STODON = '1'B;          /* SET FOR RMODEU                */ 03246000
         OI    STODON,B'10000000'                                  0878 03247000
*           IF CURNEW = '0'B        /* CHK FOR NEW-FORMAT INPUT      */ 03248000
*             THEN                  /* NO,                           */ 03249000
         TM    CURNEW,B'10000000'                                  0879 03250000
         BNZ   @RF00879                                            0879 03251000
*               DO;                                                0880 03252000
*                 NODIDC(NODIDL+1)='0';    /* SET TO 1ST BLOCK       */ 03253000
         LH    @08,NODIDL                                          0881 03254000
         LA    @01,NODIDC(@08)                                     0881 03255000
         MVI   0(@01),C'0'                                         0881 03256000
*                 CALL  RSTOW;      /* TO STOW FOR 1ST BLOCK         */ 03257000
         BAL   @14,RSTOW                                           0882 03258000
*               END;                                               0883 03259000
*                                                                  0883 03260000
*               END;                                               0884 03261000
@RF00879 DS    0H                                                  0885 03262000
*           RESPECIFY (R14) RESTRICTED;                            0885 03263000
@RF00846 DS    0H                                                  0886 03264000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 03265000
         L     R14,SAVLNKB                                         0886 03266000
*           RETURN;                 /* RETURN                        */ 03267000
         B     @EL00003                                            0887 03268000
*/********************************************************************/ 03269000
*/*                                                                  */ 03270000
*/* SEGMENT NAME -- RMODEU                                           */ 03271000
*/*                                                                  */ 03272000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03273000
*/*                                                                  */ 03274000
*/* FUNCTION -- PRINT LIST OF REFORMATTED USERID NAMES               */ 03275000
*/*   OPERATION --                                                   */ 03276000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 03277000
*/*   -  IF MESSAGE BUFFER IS FULL AFTER REFORMATTING SOME USERIDS,  */ 03278000
*/*      OR IF TERMINATION IS CURRENT --                             */ 03279000
*/*     -  IF HEADER MESSAGE IS NOT YET PRINTED, PERFORM SEGMENT     */ 03280000
*/*        MSGFNDR, FXPUTL, DOPUTL TO PRINT MESSAGE 28 AND SET THE   */ 03281000
*/*        HEADER PRINTED FLAG (HDRPRT).  PRINT LIST OF REFORMATTED  */ 03282000
*/*        USERIDS                                                   */ 03283000
*/*     -  RESET COUNT OF REFORMATTED USERIDS (IDSCT), PERFORM SEG-  */ 03284000
*/*        MENT BLNKBUF TO CLEAR USERID-LIST BUFFER (IDSBUF),  AND   */ 03285000
*/*        INITIALIZE  LINE POSITION CONTROLS  FOR NEXT FIRST LINE   */ 03286000
*/*        USERID NAME                                               */ 03287000
*/*   -  IF STOW WAS PERFORMED FOR USERID CURRENTLY IN PROCESS,      */ 03288000
*/*      INSERT NAME IN PRINT BUFFER AND UPDATE THE LINE POSITION    */ 03289000
*/*      CONTROLS                                                    */ 03290000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 03291000
*/*                                                                  */ 03292000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 03293000
*/*                                                                  */ 03294000
*/* INPUT --                                                         */ 03295000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03296000
*/*                                                                  */ 03297000
*/* OUTPUT --                                                        */ 03298000
*/*   -  USERID NAME INSERTED IN PRINT BUFFER, OR NAME LIST PRINTED  */ 03299000
*/*                                                                  */ 03300000
*/* EXTERNAL REFERENCES -- N/A                                       */ 03301000
*/*                                                                  */ 03302000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 03303000
*/*   CONDITIONS -- N/A                                              */ 03304000
*/*   RETURN CODE -- N/A                                             */ 03305000
*/*                                                                  */ 03306000
*/* EXIT-ERROR -- N/A                                                */ 03307000
*/*   CONDITIONS --                                                  */ 03308000
*/*   RETURN CODE -- N/A                                             */ 03309000
*/*                                                                  */ 03310000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 03311000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 03312000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 03313000
*/*                                                                  */ 03314000
*/********************************************************************/ 03315000
*RMODEU:    /* PRINT LIST OF REFORMATTED USERID NAMES                */ 03316000
*           ENTRY;                                                 0888 03317000
RMODEU   DS    0H                                                  0889 03318000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 03319000
         ST    R14,SAVLNKB                                         0889 03320000
*           RESPECIFY (R14) UNRESTRICTED;                          0890 03321000
*           IF LINPTR ^< MAXLINP    /* CHK IF BUFFER FULL            */ 03322000
*               | TERMCHK ^= '00'B  /*     OR TERMINATION CURRENT    */ 03323000
*             THEN                  /* YES,                          */ 03324000
         CLC   LINPTR(4),MAXLINP                                   0891 03325000
         BNL   @RT00891                                            0891 03326000
         TM    TERMCHK,B'01100000'                                 0891 03327000
         BZ    @RF00891                                            0891 03328000
@RT00891 DS    0H                                                  0892 03329000
*               DO;                                                0892 03330000
*                 IF IDSCT ^= 0     /* CHK IF ANY REFORM DONE        */ 03331000
*                   THEN            /* YES, PRINT IDS NOTICE         */ 03332000
         LH    @08,IDSCT                                           0893 03333000
         LTR   @08,@08                                             0893 03334000
         BZ    @RF00893                                            0893 03335000
*                     DO;                                          0894 03336000
*                       IF HDRPRT = '0'B/* HAS HEADER BEEN PRINTED ? */ 03337000
*                         THEN          /* NO,                       */ 03338000
         TM    HDRPRT,B'00000001'                                  0895 03339000
         BNZ   @RF00895                                            0895 03340000
*                           DO;                                    0896 03341000
*                             MSGNO = 28;   /* SET MESSAGE INDEX     */ 03342000
         MVC   MSGNO(2),@CH00565                                   0897 03343000
*                             CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT */ 03344000
         BAL   @14,MSGFNDR                                         0898 03345000
*                             CALL  FXPUTL;   /* INITIALIZE PB       */ 03346000
         BAL   @14,FXPUTL                                          0899 03347000
*                             CALL  DOPUTL;   /* TO ISSUE HEADER MSG */ 03348000
         BAL   @14,DOPUTL                                          0900 03349000
*                             HDRPRT = '1'B;  /* SET HDR DONE FLAG   */ 03350000
         OI    HDRPRT,B'00000001'                                  0901 03351000
*                           END;                                   0902 03352000
*                       PTPBK = PTPBDM;  /* INITIALIZE PARM BLOCK    */ 03353000
@RF00895 MVC   PTPBK(12),PTPBDM                                    0903 03354000
*                       PTPBOPUT = ADDR(IDSBUF);  /* PTR TO TEXT     */ 03355000
         LA    @08,IDSBUF                                          0904 03356000
         L     @01,PTPBPTR                                         0904 03357000
         ST    @08,PTPBOPUT(,@01)                                  0904 03358000
*                       CALL  DOPUTL;  /* ISSUE MESSAGE              */ 03359000
         BAL   @14,DOPUTL                                          0905 03360000
*                     END;                                         0906 03361000
*                 IDSCT = 0;        /* RESET USERID NOTICE CT        */ 03362000
@RF00893 SLR   @08,@08                                             0907 03363000
         STH   @08,IDSCT                                           0907 03364000
*                 CALL  BLNKBUF;    /* TO CLEAR TEXT BUFFER          */ 03365000
         BAL   @14,BLNKBUF                                         0908 03366000
*                 LINPTR = ADDR(IDSBUF);  /* INITIALIZE LINE PTR     */ 03367000
         LA    @08,IDSBUF                                          0909 03368000
         ST    @08,LINPTR                                          0909 03369000
*                 IDLPOSR = 1;      /* SET TO FIRST POSITION IN LINE */ 03370000
         MVC   IDLPOSR(2),@CH00032                                 0910 03371000
*                 MIDSHDR = MIDSHDR&&MIDSHDR; /* CLEAR LINE CONTROLS */ 03372000
         XC    MIDSHDR(8,@08),MIDSHDR(@08)                         0911 03373000
*                 MIDSLLG = 4;      /* INITIALIZE LINE LENGTH        */ 03374000
         MVC   MIDSLLG(2,@08),@CH00102                             0912 03375000
*               END;                                               0913 03376000
*           IF STODON = '1'B        /* WAS CURRENT ID REFORMATTED    */ 03377000
*             THEN                  /* THEN,                         */ 03378000
@RF00891 TM    STODON,B'10000000'                                  0914 03379000
         BNO   @RF00914                                            0914 03380000
*               DO;                                                0915 03381000
*                 MIDSNAM(IDLPOSR)=NODIDC(1:NODIDL); /* INSERT NAME  */ 03382000
         L     @08,LINPTR                                          0916 03383000
         LH    @15,IDLPOSR                                         0916 03384000
         LR    @14,@15                                             0916 03385000
         MH    @14,@CH00034                                        0916 03386000
         ALR   @14,@08                                             0916 03387000
         BCTR  @14,0                                               0916 03388000
         BCTR  @14,0                                               0916 03389000
         MVI   MIDSNAM-7(@14),C' '                                 0916 03390000
         MVC   MIDSNAM-6(8,@14),MIDSNAM-7(@14)                     0916 03391000
         LH    @07,NODIDL                                          0916 03392000
         BCTR  @07,0                                               0916 03393000
         EX    @07,@SM02095                                        0916 03394000
*                 IF IDLPOSR = 1    /* CHK IF 1ST ENTRY OF LINE      */ 03395000
*                     & IDSCT ^= 0      /* BUT NOT 1ST LINE          */ 03396000
*                   THEN            /* YES,                          */ 03397000
         CH    @15,@CH00032                                        0917 03398000
         BNE   @RF00917                                            0917 03399000
         LH    @15,IDSCT                                           0917 03400000
         LTR   @15,@15                                             0917 03401000
         BZ    @RF00917                                            0917 03402000
*                     IDSLLAS=LINPTR;  /* SET CHAIN PTR IN LAST LINE */ 03403000
         L     @01,IDSLASP                                         0918 03404000
         ST    @08,IDSLLAS(,@01)                                   0918 03405000
*                 IDSCT = IDSCT+1;  /* STEP NAME COUNT               */ 03406000
@RF00917 LA    @08,1                                               0919 03407000
         LH    @15,IDSCT                                           0919 03408000
         ALR   @15,@08                                             0919 03409000
         STH   @15,IDSCT                                           0919 03410000
*                 MIDSLLG=MIDSLLG+LENGTH(MIDSNAM); /* STEP LINE LNG  */ 03411000
         L     @15,LINPTR                                          0920 03412000
         LA    @14,10                                              0920 03413000
         LH    @07,MIDSLLG(,@15)                                   0920 03414000
         ALR   @07,@14                                             0920 03415000
         STH   @07,MIDSLLG(,@15)                                   0920 03416000
*                 IDLPOSR=IDLPOSR+1;  /* STEP LINE NAME POSITION     */ 03417000
         LH    @07,IDLPOSR                                         0921 03418000
         ALR   @07,@08                                             0921 03419000
         STH   @07,IDLPOSR                                         0921 03420000
*                 IF IDLPOSR > 10   /* CHK IF LINE COMPLETE          */ 03421000
*                   THEN            /* YES,                          */ 03422000
         CR    @07,@14                                             0922 03423000
         BNH   @RF00922                                            0922 03424000
*                     DO;                                          0923 03425000
*                       IDSLASP = LINPTR;  /* PREVIOUS LINE PTR      */ 03426000
         ST    @15,IDSLASP                                         0924 03427000
*                       IDLPOSR = 1;  /* INITIALIZE LINE POSITION CT */ 03428000
         STH   @08,IDLPOSR                                         0925 03429000
*                       LINPTR=LINPTR+LENGTH(MIDSLIN);  /* NEXT LINE */ 03430000
         AH    @15,@CH00551                                        0926 03431000
         ST    @15,LINPTR                                          0926 03432000
*                       MIDSHDR=MIDSHDR&&MIDSHDR;  /* CLEAR CONTROLS */ 03433000
         XC    MIDSHDR(8,@15),MIDSHDR(@15)                         0927 03434000
*                       MIDSLLG = 4;   /* INITIALIZE LINE LENGTH     */ 03435000
         MVC   MIDSLLG(2,@15),@CH00102                             0928 03436000
*                     END;                                         0929 03437000
*               END;                                               0930 03438000
@RF00922 DS    0H                                                  0931 03439000
*           RESPECIFY (R14) RESTRICTED;                            0931 03440000
@RF00914 DS    0H                                                  0932 03441000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 03442000
         L     R14,SAVLNKB                                         0932 03443000
*           RETURN;                 /* RETURN                        */ 03444000
         B     @EL00003                                            0933 03445000
*/********************************************************************/ 03446000
*/*                                                                  */ 03447000
*/* SEGMENT NAME -- RCLOS                                            */ 03448000
*/*                                                                  */ 03449000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03450000
*/*                                                                  */ 03451000
*/* FUNCTION -- COMMON CLOSE DCB ROUTINE                             */ 03452000
*/*   OPERATION --                                                   */ 03453000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 03454000
*/*   -  SET MESSAGE INDEX 29 AND POINTER (PPPPTR) FOR REXDCB, CALL  */ 03455000
*/*      SEGMENT CLOSDCB                                             */ 03456000
*/*   -  SET MESSAGE INDEX 30 AND POINTER (PPPPTR) FOR RDIDCB, CALL  */ 03457000
*/*      SEGMENT CLOSDCB                                             */ 03458000
*/*   -  SET MESSAGE INDEX 30 AND POINTER (PPPPTR) FOR RINDCB, CALL  */ 03459000
*/*      SEGMENT CLOSDCB                                             */ 03460000
*/*  -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                  */ 03461000
*/*                                                                  */ 03462000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 03463000
*/*                                                                  */ 03464000
*/* INPUT --                                                         */ 03465000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03466000
*/*                                                                  */ 03467000
*/* OUTPUT --                                                        */ 03468000
*/*   -  ALL DCBS IN CLOSED STATE   (VIA CLOSDCB)                    */ 03469000
*/*                                                                  */ 03470000
*/* EXTERNAL REFERENCES -- N/A                                       */ 03471000
*/*                                                                  */ 03472000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 03473000
*/*   CONDITIONS -- N/A                                              */ 03474000
*/*   RETURN CODE -- N/A                                             */ 03475000
*/*                                                                  */ 03476000
*/* EXIT-ERROR -- N/A                                                */ 03477000
*/*   CONDITIONS -- N/A                                              */ 03478000
*/*   RETURN CODE -- N/A                                             */ 03479000
*/*                                                                  */ 03480000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 03481000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 03482000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 03483000
*/*                                                                  */ 03484000
*/********************************************************************/ 03485000
*RCLOS:     /* CLOSE DATA CONTROL BLOCK ROUTINE EP                   */ 03486000
*                                                                  0934 03487000
*           ENTRY;                                                 0934 03488000
RCLOS    DS    0H                                                  0935 03489000
*           RESPECIFY (PPPPTR) RESTRICTED;  /* RESERVE POINTER       */ 03490000
*           SAVLNKB  =  R14;        /* RESERVE LINK REGISTER         */ 03491000
         ST    R14,SAVLNKB                                         0936 03492000
*           RESPECIFY (R14) UNRESTRICTED;                          0937 03493000
*                                                                  0937 03494000
*           MSGNO = 29;             /* SET MESSAGE INDEX FOR SYSUADS */ 03495000
         MVC   MSGNO(2),@CH01868                                   0938 03496000
*           PPPPTR = ADDR(REXDCB);  /* PTR TO DCB TO BE CLOSED       */ 03497000
         LA    PPPPTR,REXDCB                                       0939 03498000
*           CALL  CLOSDCB;          /* GO TO ISSUE CLOSE             */ 03499000
*                                                                  0940 03500000
         BAL   @14,CLOSDCB                                         0940 03501000
*           MSGNO = 30;             /* SET MESSAGE INDEX FOR SYSUADN */ 03502000
         MVC   MSGNO(2),@CH01172                                   0941 03503000
*           PPPPTR = ADDR(RDIDCB);  /* PTR TO DCB TO BE CLOSED       */ 03504000
         LA    PPPPTR,RDIDCB                                       0942 03505000
*           CALL  CLOSDCB;          /* GO TO ISSUE CLOSE             */ 03506000
*                                                                  0943 03507000
         BAL   @14,CLOSDCB                                         0943 03508000
*           MSGNO = 30;             /* SET MESSAGE INDEX FOR SYSUADN */ 03509000
         MVC   MSGNO(2),@CH01172                                   0944 03510000
*           PPPPTR = ADDR(RINDCB);  /* PTR TO DCB TO BE CLOSED       */ 03511000
         LA    PPPPTR,RINDCB                                       0945 03512000
*           CALL  CLOSDCB;          /* GO TO ISSUE CLOSE             */ 03513000
*                                                                  0946 03514000
         BAL   @14,CLOSDCB                                         0946 03515000
*           RESPECIFY (R14) RESTRICTED;                            0947 03516000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 03517000
         L     R14,SAVLNKB                                         0948 03518000
*           RESPECIFY  (PPPPTR) UNRESTRICTED;  /* FREE POINTER       */ 03519000
*           RETURN;                 /* RETURN                        */ 03520000
         B     @EL00003                                            0950 03521000
*/********************************************************************/ 03522000
*/*                                                                  */ 03523000
*/* SEGMENT NAME -- FREBUF                                           */ 03524000
*/*                                                                  */ 03525000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03526000
*/*                                                                  */ 03527000
*/* FUNCTION -- FREE STORAGE SPACE FOR OUTPUT BUFFER                 */ 03528000
*/*   OPERATION --                                                   */ 03529000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 03530000
*/*   -  IF BUFFER EXISTS (GMAINL IS NOT ZERO),                      */ 03531000
*/*      -  SET REGISTER 1 TO POINT TO FREEMAIN PARAMETER LIST       */ 03532000
*/*      -  SET FREEMAIN LENGTH (GMAINL) IN REGISTER 5               */ 03533000
*/*      -  SET POINTER TO BUFFER AREA (GMAINP) IN REGISTER 6        */ 03534000
*/*      -  SET SUBPOOL NUMBER IN REGISTER 3                         */ 03535000
*/*      -  EXECUTE FREEMAIN MACRO                                   */ 03536000
*/*      -  CLEAR FREEMAIN LENGTH FIELD (GMAINL)                     */ 03537000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 03538000
*/*                                                                  */ 03539000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 03540000
*/*                                                                  */ 03541000
*/* INPUT --                                                         */ 03542000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03543000
*/*   -  BUFFER LENGTH (IF ANY) IN POINTER (GMAINL)                  */ 03544000
*/*   -  STARTING POINT OF BUFFER AREA IN POINTER (GMAINP)           */ 03545000
*/*                                                                  */ 03546000
*/* OUTPUT -- N/A                                                    */ 03547000
*/*                                                                  */ 03548000
*/* EXTERNAL REFERENCES -- FREEMAIN MACRO                            */ 03549000
*/*                                                                  */ 03550000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 03551000
*/*   CONDITIONS -- N/A                                              */ 03552000
*/*   RETURN CODE -- N/A                                             */ 03553000
*/*                                                                  */ 03554000
*/* EXIT-ERROR -- N/A                                                */ 03555000
*/*   CONDITIONS -- N/A                                              */ 03556000
*/*   RETURN CODE -- N/A                                             */ 03557000
*/*                                                                  */ 03558000
*/********************************************************************/ 03559000
*FREBUF:    /* ISSUE FREEMAIN FOR OUTPUT BUFFER                      */ 03560000
*           ENTRY;                                                 0951 03561000
*                                                                  0951 03562000
FREBUF   DS    0H                                                  0952 03563000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 03564000
         ST    R14,SAVLNKB                                         0952 03565000
*           RESPECIFY (R14) UNRESTRICTED;                          0953 03566000
*                                                                  0953 03567000
*           RESPECIFY (R1,R5,R6) RESTRICTED;                       0954 03568000
*           IF GMAINL ^= 0          /* CHK FOR CURRENT GOTMAIN       */ 03569000
*             THEN                  /* YES, EXECUTE FREEMAIN         */ 03570000
         L     @08,GMAINL                                          0955 03571000
         LTR   @08,@08                                             0955 03572000
         BZ    @RF00955                                            0955 03573000
*               DO;                                                0956 03574000
*                 R1 = ADDR(FMLST); /* PTR TO FREE MAIN  P L         */ 03575000
         LA    R1,FMLST                                            0957 03576000
*                 GMAINL = GMAINL|HIORDR1;  /* SET HIGH ORDER FLAG   */ 03577000
         MVC   @TF00001(4),HIORDR1                                 0958 03578000
         O     @08,@TF00001                                        0958 03579000
         ST    @08,GMAINL                                          0958 03580000
*                 R5 = ADDR(GMAINL);  /* PTR TO FREEMAIN LENGTH      */ 03581000
         LA    R5,GMAINL                                           0959 03582000
*                 R6 = ADDR(GMAINP);  /* PTR TO FREE MAIN AREA       */ 03583000
         LA    R6,GMAINP                                           0960 03584000
*                 GEN(LA    R3,&SUBPN); /* SUBPOOL NUMBER            */ 03585000
         LA    R3,&SUBPN                                                03586000
*                 GEN(FREEMAIN  L,LA=(R5),A=(R6),SP=(R3),MF=(E,(1)));   03587000
         FREEMAIN  L,LA=(R5),A=(R6),SP=(R3),MF=(E,(1))                  03588000
*                 GMAINL = 0;       /* SET NO GOTMAIN INDICATOR      */ 03589000
         SLR   @08,@08                                             0963 03590000
         ST    @08,GMAINL                                          0963 03591000
*               END;                                               0964 03592000
*           RESPECIFY (R1,R5,R6) UNRESTRICTED;                     0965 03593000
*                                                                  0965 03594000
@RF00955 DS    0H                                                  0966 03595000
*           RESPECIFY (R14) RESTRICTED;                            0966 03596000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 03597000
         L     R14,SAVLNKB                                         0967 03598000
*           RETURN;                 /* RETURN                        */ 03599000
         B     @EL00003                                            0968 03600000
*/********************************************************************/ 03601000
*/*                                                                  */ 03602000
*/* SEGMENT NAME -- RDEQU                                            */ 03603000
*/*                                                                  */ 03604000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03605000
*/*                                                                  */ 03606000
*/* FUNCTION -- DEQUEUE FROM SYSIKJUA/OPENUADS                       */ 03607000
*/*   OPERATION --                                                   */ 03608000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 03609000
*/*   -  SET POINTER TO DEQ PARAMETER LIST (DQOPN) IN REGISTER 1     */ 03610000
*/*   -  EXECUTE DEQ MACRO                                           */ 03611000
*/*   -  IF DEQ RETURN CODE (REGISTER 15) IS UNSUCCESSFUL (NOT ZERO) */ 03612000
*/*      CHECK RETURN CODE LIST LOCATED BY REGISTER 15 AS POINTER    */ 03613000
*/*      -  IF RETURN CODE IS NOT 8, ISSUE ERROR MESSAGE 27 AND SET  */ 03614000
*/*         UADSREFM TERMINATION FLAG (RFMQUIT)                      */ 03615000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 03616000
*/*                                                                  */ 03617000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 03618000
*/*                                                                  */ 03619000
*/* INPUT --                                                         */ 03620000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03621000
*/*                                                                  */ 03622000
*/* OUTPUT -- N/A                                                    */ 03623000
*/*                                                                  */ 03624000
*/* EXTERNAL REFERENCES -- DEQ MACRO                                 */ 03625000
*/*                                                                  */ 03626000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 03627000
*/*   CONDITIONS --                                                  */ 03628000
*/*  -  SUCCESSFUL DEQ                                               */ 03629000
*/*                                                                  */ 03630000
*/*   RETURN CODE -- N/A                                             */ 03631000
*/*                                                                  */ 03632000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 03633000
*/*   CONDITIONS --                                                  */ 03634000
*/*   -  FAILURE IN DEQ  (REFMQUIT FLAG SET)                         */ 03635000
*/*   RETURN CODE -- N/A                                             */ 03636000
*/*                                                                  */ 03637000
*/********************************************************************/ 03638000
*RDEQU:     /* DEQUEUE FROM UADS                                     */ 03639000
*           /* ENQUEUE AT RENQU                                      */ 03640000
*           ENTRY;                                                 0969 03641000
RDEQU    DS    0H                                                  0970 03642000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 03643000
         ST    R14,SAVLNKB                                         0970 03644000
*           RESPECIFY (R14) UNRESTRICTED;                          0971 03645000
*                                                                  0971 03646000
*           RESPECIFY (R1,R15) RESTRICTED;                         0972 03647000
*           R1 = ADDR(DQOPN);       /* PTR TO DEQ PARM LIST          */ 03648000
         LA    R1,DQOPN                                            0973 03649000
*           GEN(DEQ   ,MF=(E,(1))); /* ISSUE DEQUEUE                 */ 03650000
         DEQ   ,MF=(E,(1))                                              03651000
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */ 03652000
         ST    R15,RTNCODE                                         0975 03653000
*           RESPECIFY (R1,R15) UNRESTRICTED;                       0976 03654000
*           IF RTNCODE ^= 0         /* CHK FOR SATISFACTORY RET CODE */ 03655000
*             THEN                  /* NO,                           */ 03656000
         L     @08,RTNCODE                                         0977 03657000
         LTR   @08,@08                                             0977 03658000
         BZ    @RF00977                                            0977 03659000
*               DO;                                                0978 03660000
*                 RCPTR = RTNCODE;  /* LOCATE RETURN CODE            */ 03661000
         ST    @08,RCPTR                                           0979 03662000
*                 IF RCLC1^=0       /* CHK FOR UNSATISFACTORY        */ 03663000
*                     & RCLC1^=8    /*     RETURN CODE               */ 03664000
*                   THEN            /* YES,                          */ 03665000
         CLI   RCLC1(@08),0                                        0980 03666000
         BE    @RF00980                                            0980 03667000
         CLI   RCLC1(@08),8                                        0980 03668000
         BE    @RF00980                                            0980 03669000
*                     DO;                                          0981 03670000
*                       MSGNO = 27;     /* SET MESSAGE INDEX         */ 03671000
         MVC   MSGNO(2),@CH01967                                   0982 03672000
*                       SOFFS = 20;     /* SET INSERT OFFSET         */ 03673000
         MVC   SOFFS(2),@CH00351                                   0983 03674000
*                       CALL  SYSERRD;  /* ISSUE ERROR MSG           */ 03675000
         BAL   @14,SYSERRD                                         0984 03676000
*                       RFMQUIT = '1'B; /* SET TERMINATION FLG       */ 03677000
         OI    RFMQUIT,B'01000000'                                 0985 03678000
*                     END;                                         0986 03679000
*               END;                                               0987 03680000
*                                                                  0987 03681000
@RF00980 DS    0H                                                  0988 03682000
*           RESPECIFY (R14) RESTRICTED;                            0988 03683000
@RF00977 DS    0H                                                  0989 03684000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 03685000
         L     R14,SAVLNKB                                         0989 03686000
*           RETURN;                 /* RETURN                        */ 03687000
         B     @EL00003                                            0990 03688000
*/********************************************************************/ 03689000
*/*                                                                  */ 03690000
*/* SEGMENT NAME -- RDSTAE                                           */ 03691000
*/*                                                                  */ 03692000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03693000
*/*                                                                  */ 03694000
*/* FUNCTION -- CANCEL EXISTING STAE ENVIRONMENT                     */ 03695000
*/*   OPERATION --                                                   */ 03696000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 03697000
*/*   -  IF STAE ENVIRONMENT IS CURRENTLY ESTABLISHED (STASET SET)   */ 03698000
*/*      -  SET STAE PARAMETER LIST (STAEL1)                         */ 03699000
*/*      -  EXECUTE STAE MACRO (OPERAND OF 0)                        */ 03700000
*/*      -  IF RETURN CODE (REGISTER 15) IS NOT ZERO, ISSUE MESSAGE  */ 03701000
*/*         9 AND SET TERMINATION FLAG (RFMQUIT)                     */ 03702000
*/*      -  IF RETURN CODE IS ZERO, SET STAE ENVIRONMENT ESTABLISHED */ 03703000
*/*         FLAG OFF (STASET = 0)                                    */ 03704000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 03705000
*/*                                                                  */ 03706000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 03707000
*/*                                                                  */ 03708000
*/* INPUT --                                                         */ 03709000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03710000
*/*                                                                  */ 03711000
*/* OUTPUT --                                                        */ 03712000
*/*   -  STAE ENVIRONMENT CANCELLED (STASET FLAG SET OFF)            */ 03713000
*/*                                                                  */ 03714000
*/* EXTERNAL REFERENCES -- STAE MACRO                                */ 03715000
*/*                                                                  */ 03716000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 03717000
*/*   CONDITIONS --                                                  */ 03718000
*/*   -  SUCCESSFUL STAE (STASET FLAG SET OFF)                       */ 03719000
*/*   RETURN CODE -- N/A                                             */ 03720000
*/*                                                                  */ 03721000
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */ 03722000
*/*   CONDITIONS --                                                  */ 03723000
*/*   -  UNSUCCESSFUL STAE (ERROR MESSAGE 9 AND RFMQUIT FLAG SET)    */ 03724000
*/*   RETURN CODE -- N/A                                             */ 03725000
*/*                                                                  */ 03726000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 03727000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 03728000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 03729000
*/*                                                                  */ 03730000
*/********************************************************************/ 03731000
*RDSTAE:    /* CANCEL EXISTING STAE ENVIRONMENT                      */ 03732000
*           ENTRY;                                                 0991 03733000
RDSTAE   DS    0H                                                  0992 03734000
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */ 03735000
         ST    R14,SAVLNKB                                         0992 03736000
*           RESPECIFY (R14) UNRESTRICTED;                          0993 03737000
*                                                                  0993 03738000
*           IF STASET = '1'B        /* CHK FOR CURRENT STAE          */ 03739000
*             THEN                  /* YES,                          */ 03740000
         TM    STASET,B'00100000'                                  0994 03741000
         BNO   @RF00994                                            0994 03742000
*               DO;                                                0995 03743000
*                 /* SET UP AND ISSUE CANCEL STAE                    */ 03744000
*                 GEN(MVC    STAEL1(STALNG),MSTAEL1);  /* SET P L    */ 03745000
         MVC    STAEL1(STALNG),MSTAEL1                                  03746000
*                 GEN(STAE   0);    /* ISSUE CANCEL STAE             */ 03747000
*                                                                  0997 03748000
         STAE   0                                                       03749000
*                 RESPECIFY (R15) RESTRICTED;                      0998 03750000
*                 RTNCODE = R15;    /* RESERVE RETURN CODE           */ 03751000
         ST    R15,RTNCODE                                         0999 03752000
*                 RESPECIFY (R15) UNRESTRICTED;                    1000 03753000
*                 IF RTNCODE ^= 0     /* CHK FOR SUCCESS CODE        */ 03754000
*                   THEN            /* NO,                           */ 03755000
         L     @08,RTNCODE                                         1001 03756000
         LTR   @08,@08                                             1001 03757000
         BZ    @RF01001                                            1001 03758000
*                     DO;                                          1002 03759000
*                       MSGNO = 9;  /* SET MESSAGE INDEX             */ 03760000
         MVC   MSGNO(2),@CH00033                                   1003 03761000
*                       SOFFS=20;   /* SET TEXT OFFSET               */ 03762000
         MVC   SOFFS(2),@CH00351                                   1004 03763000
*                       CALL  SYSERRD;  /* TO ISSUE MESSAGE          */ 03764000
         BAL   @14,SYSERRD                                         1005 03765000
*                       RFMQUIT = '1'B; /* SET TERMINATION FLAG      */ 03766000
         OI    RFMQUIT,B'01000000'                                 1006 03767000
*                     END;                                         1007 03768000
*                   ELSE            /* CANCEL STAE SUCESSFUL         */ 03769000
*                     STASET = '0'B;/* SET STAE INACTIVE FLAG        */ 03770000
         B     @RC01001                                            1008 03771000
@RF01001 NI    STASET,B'11011111'                                  1008 03772000
*               END;                                               1009 03773000
*                                                                  1009 03774000
@RC01001 DS    0H                                                  1010 03775000
*           RESPECIFY (R14) RESTRICTED;                            1010 03776000
@RF00994 DS    0H                                                  1011 03777000
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */ 03778000
         L     R14,SAVLNKB                                         1011 03779000
*           END  DCBCHK;            /* RETURN                        */ 03780000
         B     @EL00003                                            1012 03781000
*/********************************************************************/ 03782000
*/*                                                                  */ 03783000
*/* SEGMENT NAME -- OPENDCB                                          */ 03784000
*/*                                                                  */ 03785000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03786000
*/*                                                                  */ 03787000
*/* FUNCTION -- COMMON OPEN DCB ROUTINE                              */ 03788000
*/*   OPERATION --                                                   */ 03789000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 03790000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP OPENDCB FUNCTION */ 03791000
*/*   -  IF DCB INDICATED BY POINTER (PPPPTR) IS CURRENTLY OPEN,     */ 03792000
*/*      PERFORM SEGMENT CLOSDCB TO CLOSE THAT DCB                   */ 03793000
*/*   -  IF THAT DCB IS STILL OPEN, ISSUE FAILURE MESSAGE AND SET    */ 03794000
*/*      UADSREFM TERMINATION FLAG (REMQUIT).  OTHERWISE, EXECUTE    */ 03795000
*/*      OPEN MACRO.  IF DCB IS NOT OPENED, ISSUE ERROR MESSAGE AND  */ 03796000
*/*      SET RFMQUIT                                                 */ 03797000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 03798000
*/*                                                                  */ 03799000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 03800000
*/*                                                                  */ 03801000
*/* INPUT --                                                         */ 03802000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03803000
*/*   -  POINTER TO DCB IN (PPPPTR)                                  */ 03804000
*/*   -  MESAGE INDEXES SET --                                       */ 03805000
*/*      -  MSGN2 -- 3 FOR OPEN SYSUADN ERROR                        */ 03806000
*/*      -  MSGN2 -- 4 FOR OPEN SYSUADS ERROR                        */ 03807000
*/*      -  MSGN3 -- 30 FOR CLOSE SYSUADN ERROR                      */ 03808000
*/*      -  MSGN3 -- 29 FOR CLOSE SYSUADS ERROR                      */ 03809000
*/*                                                                  */ 03810000
*/* OUTPUT --                                                        */ 03811000
*/*   -  DCBS OPEN                                                   */ 03812000
*/*                                                                  */ 03813000
*/* EXTERNAL REFERENCES -- OPEN MACRO                                */ 03814000
*/*                                                                  */ 03815000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 03816000
*/*   CONDITIONS --                                                  */ 03817000
*/*   -  SUCCESSFUL OPEN                                             */ 03818000
*/*   RETURN CODE -- N/A                                             */ 03819000
*/*                                                                  */ 03820000
*/* EXIT-ERROR --                                                    */ 03821000
*/*   CONDITIONS --                                                  */ 03822000
*/*   -  UNSUCCESSFUL OPEN (RFMQUIT FLAG SET)                        */ 03823000
*/*   RETURN CODE -- N/A                                             */ 03824000
*/*                                                                  */ 03825000
*/********************************************************************/ 03826000
*OPENDCB:   /* OPEN DATA CONTROL BLOCK ROUTINE EP                    */ 03827000
*                                                                  1013 03828000
*           PROCEDURE                                              1013 03829000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 03830000
OPENDCB  DS    0H                                                  1014 03831000
*                                   /* NO SAVE AREA CREATED          */ 03832000
*           RESPECIFY (PPPPTR) RESTRICTED;  /* RESERVE POINTER       */ 03833000
*                                                                  1014 03834000
*           RESPECIFY (R14) RESTRICTED;                            1015 03835000
*           SAVLNKC  =  R14;        /* RESERVE LINK REGISTER         */ 03836000
         ST    R14,SAVLNKC                                         1016 03837000
*           RESPECIFY (R14) UNRESTRICTED;                          1017 03838000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 03839000
*             THEN                  /* NO,                           */ 03840000
         TM    QUITCHK,B'11100000'                                 1018 03841000
         BNZ   @RF01018                                            1018 03842000
*               DO;                                                1019 03843000
*                                                                  1019 03844000
*           MSGNOW = '0'B;          /* INITIALIZE FOR NO MESSAGE     */ 03845000
         NI    MSGNOW,B'11111011'                                  1020 03846000
*           /* CHK IF OPEN AND IF SO, CLOSE                          */ 03847000
*           IF PPPPTR->DCBOFOPN = '1'B /* CHK FOR OPEN FLAG          */ 03848000
*             THEN                  /* YES,                          */ 03849000
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1021 03850000
         BNO   @RF01021                                            1021 03851000
*               DO;                                                1022 03852000
*                 MSGNO = MSGN3;    /* RESTORE MESSAGE INDEX         */ 03853000
         MVC   MSGNO(2),MSGN3                                      1023 03854000
*                 CALL  CLOSDCB;    /* CLOSE OPEN DCB                */ 03855000
         BAL   @14,CLOSDCB                                         1024 03856000
*                 MSGNO = MSGN2;    /* RESTORE MESSAGE INDEX         */ 03857000
         MVC   MSGNO(2),MSGN2                                      1025 03858000
*               END;                                               1026 03859000
*           /* CHK IF OPEN AND IF SO, ISSUE ERROR MESSAGE            */ 03860000
*           IF PPPPTR->DCBOFOPN = '1'B /* CHK FOR OPEN FLAG          */ 03861000
*             THEN                  /* YES,                          */ 03862000
@RF01021 TM    DCBOFOPN(PPPPTR),B'00010000'                        1027 03863000
         BNO   @RF01027                                            1027 03864000
*               MSGNOW = '1'B;      /* SET DO MESSAGE FLAG           */ 03865000
         OI    MSGNOW,B'00000100'                                  1028 03866000
*             ELSE                                                 1029 03867000
*               DO;                                                1029 03868000
         B     @RC01027                                            1029 03869000
@RF01027 DS    0H                                                  1030 03870000
*                 /* ISSUE OPEN                                      */ 03871000
*                 GENERATE (OPEN  ((PPPPTR),),MF=(E,(1)));         1030 03872000
         OPEN  ((PPPPTR),),MF=(E,(1))                                   03873000
*                 /* CHK IF OPEN NOW                                 */ 03874000
*                 IF PPPPTR->DCBOFOPN='0'B/* CHK FOR OPEN FLAG       */ 03875000
*                   THEN            /* NO,                           */ 03876000
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1031 03877000
         BNZ   @RF01031                                            1031 03878000
*                     MSGNOW = '1'B;  /* SET DO MESSAGE FLAG         */ 03879000
         OI    MSGNOW,B'00000100'                                  1032 03880000
*               END;                                               1033 03881000
@RF01031 DS    0H                                                  1034 03882000
*           IF MSGNOW = '1'B        /* CHK FOR PENDING MESSAGE       */ 03883000
*             THEN                  /* YES,                          */ 03884000
@RC01027 TM    MSGNOW,B'00000100'                                  1034 03885000
         BNO   @RF01034                                            1034 03886000
*               DO;                                                1035 03887000
*                 CALL  MSGFNDR;    /* LOCATE MESSAGE TEXT           */ 03888000
         BAL   @14,MSGFNDR                                         1036 03889000
*                 CALL  FXPUTLM;    /* INITIALIZE P B                */ 03890000
         BAL   @14,FXPUTLM                                         1037 03891000
*                 CALL  DOPUTL;     /* ISSUE PUTLINE                 */ 03892000
         BAL   @14,DOPUTL                                          1038 03893000
*                 RFMQUIT = '1'B;   /* SET TERMINATION FLAG          */ 03894000
         OI    RFMQUIT,B'01000000'                                 1039 03895000
*               END;                                               1040 03896000
*                                                                  1040 03897000
*               END;                                               1041 03898000
@RF01034 DS    0H                                                  1042 03899000
*           RESPECIFY (R14) RESTRICTED;                            1042 03900000
@RF01018 DS    0H                                                  1043 03901000
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */ 03902000
         L     R14,SAVLNKC                                         1043 03903000
*           RESPECIFY  (PPPPTR) UNRESTRICTED;  /* FREE POINTER       */ 03904000
*           RETURN;                 /* RETURN                        */ 03905000
@EL00004 DS    0H                                                  1045 03906000
@EF00004 DS    0H                                                  1045 03907000
@ER00004 BR    @14                                                 1045 03908000
*/********************************************************************/ 03909000
*/*                                                                  */ 03910000
*/* SEGMENT NAME -- DOREAD                                           */ 03911000
*/*                                                                  */ 03912000
*/* DESCRIPTIVE NAME -- N/A                                          */ 03913000
*/*                                                                  */ 03914000
*/* FUNCTION -- SET UP AND CALL ACCOUNT-READ ROUTINE (IKJEFA51)      */ 03915000
*/*   OPERATION --                                                   */ 03916000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 03917000
*/*   -  IF TERMINATION FLAG (RFMQUIT) IS SET, SKIP DOREAD FUNCTION  */ 03918000
*/*   -  SET READ FLAG (RWPF5) IN RWPB                               */ 03919000
*/*   -  SET ADDRESS OF ACCOUNT-READ PARM BLOCK (RWPB) IN REGISTER 1 */ 03920000
*/*   -  CALL IKJEFA51 TO READ UADS MEMBER                           */ 03921000
*/*   -  IF RETURN CODE IS UNSUCCESSFUL (CODE NOT 0) --              */ 03922000
*/*      -  IF RETURN CODE IS 12, PERFORM SEGMENT NOUSP              */ 03923000
*/*      -  IF RETURN CODE IS 4, PERFORM SEGMENT NOUFND              */ 03924000
*/*      -  IF RETURN CODE IS 24, SET END-OF-FILE FLAG (RENDOF)      */ 03925000
*/*      -  IF RETURN CODE IS 20, SET USERID PROCESSING TERMINATION  */ 03926000
*/*         FLAG (UIDQUIT)                                           */ 03927000
*/*      -  IF ANY OTHER RETURN CODE, ISSUE ERROR MESSAGE 17 AND SET */ 03928000
*/*         TERMINATION FLAG (UIDQUIT)                               */ 03929000
*/*      -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                */ 03930000
*/*   -  IF READ RETURN CODE IS SUCCESSFUL (CODE 0), SET READ-ACCOM- */ 03931000
*/*      PLISHED FLAG (RDDONE)                                       */ 03932000
*/*      -  IF IT WAS A USERID-MEMBER TYPE READ, SET POINTER TO      */ 03933000
*/*         INPUT BUFFER (RINBUFP) WITH ADDRESS RETURNED IN ACCOUNT- */ 03934000
*/*         READ PARAMETER BLOCK (RWPBUF), SET HEADER BLOCK MAPPING  */ 03935000
*/*         MACRO BASE POINTER WITH INPUT BUFFER LOCATION (RINBUFP), */ 03936000
*/*         SAVE INPUT BLOCK LENGTH (OLRDBUFL) AND NUMBER OF BLOCKS  */ 03937000
*/*         IN INPUT MEMBER READ (OLNOBLK), AND HOLD TTR IN SVTTR    */ 03938000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 03939000
*/*                                                                  */ 03940000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 03941000
*/*                                                                  */ 03942000
*/* INPUT --                                                         */ 03943000
*/*   -  UADSREFM ENVIRONMENT                                        */ 03944000
*/*                                                                  */ 03945000
*/* OUTPUT --                                                        */ 03946000
*/*   -  USERID MEMBER/DIRECTORY ENTRY BLOCK READ INTO BUFFER        */ 03947000
*/*      RINBUF/DIRWA                                                */ 03948000
*/*                                                                  */ 03949000
*/* EXTERNAL REFERENCES -- ACCOUNT-READ ROUTINE -- IKJEFA51          */ 03950000
*/*                                                                  */ 03951000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 03952000
*/*   CONDITIONS --                                                  */ 03953000
*/*   -  SUCCESSFUL READ (RDDONE FLAG SET)                           */ 03954000
*/*   RETURN CODE -- N/A                                             */ 03955000
*/*                                                                  */ 03956000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 03957000
*/*   CONDITIONS --                                                  */ 03958000
*/*   -  UNSUCCESSFUL READ (UIDQUIT FLAG SET)                        */ 03959000
*/*   RETURN CODE -- N/A                                             */ 03960000
*/*                                                                  */ 03961000
*/********************************************************************/ 03962000
*DOREAD:    /* SET UP AND CALL ACCOUNT-READ ROUTINE IKJEFA51         */ 03963000
*           ENTRY;                                                 1046 03964000
DOREAD   DS    0H                                                  1047 03965000
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */ 03966000
         ST    R14,SAVLNKC                                         1047 03967000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 03968000
*             THEN                  /* NO,                           */ 03969000
         TM    QUITCHK,B'11100000'                                 1048 03970000
         BNZ   @RF01048                                            1048 03971000
*               DO;                                                1049 03972000
*           RWPF5 = '0'B;           /* CLEAR WRITE FLAG              */ 03973000
*           RWPF3 = '1'B;           /* RWPWAP IS PTR TO DIRWA        */ 03974000
         OI    RWPF3,B'00100000'                                   1051 03975000
         NI    RWPF5,B'11110111'                                   1051 03976000
*           RESPECIFY (R1,R15) RESTRICTED;                         1052 03977000
*           R1 = ADDR(RWPB);        /* PTR TO READ  P B              */ 03978000
         LA    R1,RWPB                                             1053 03979000
*           CALL  IKJEFA51;         /* GO TO READ ROUTINE            */ 03980000
         L     @15,@CV00037                                        1054 03981000
         BALR  @14,@15                                             1054 03982000
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */ 03983000
         ST    R15,RTNCODE                                         1055 03984000
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1056 03985000
*           IF RTNCODE^=0           /* CHK FOR CODE FOR SUCCESS      */ 03986000
*             THEN                  /* NO,                           */ 03987000
         L     @15,RTNCODE                                         1057 03988000
         LTR   @15,@15                                             1057 03989000
         BZ    @RF01057                                            1057 03990000
*               DO;                                                1058 03991000
*                 IF RTNCODE = 12   /* IS NO-SPACE CODE ?            */ 03992000
*                   THEN            /* YES,                          */ 03993000
         CH    @15,@CH00036                                        1059 03994000
         BNE   @RF01059                                            1059 03995000
*                     CALL  NOUSP;  /* ISSUE NO-SPACE MSG            */ 03996000
         BAL   @14,NOUSP                                           1060 03997000
*                   ELSE            /* NOT NO-SPACE CODE             */ 03998000
*                     IF RTNCODE = 4   /* IS NOT-FOUND CODE ?        */ 03999000
*                       THEN        /* YES,                          */ 04000000
         B     @RC01059                                            1061 04001000
@RF01059 CLC   RTNCODE(4),@CF00102                                 1061 04002000
         BNE   @RF01061                                            1061 04003000
*                         CALL  NOUFND; /* PUT NOT-FOUND MSG         */ 04004000
         BAL   @14,NOUFND                                          1062 04005000
*                       ELSE        /* NOT NOT-FOUND MSG             */ 04006000
*                         IF RTNCODE = 24   /* IS END-OF-FILE        */ 04007000
*                           THEN    /* YES,                          */ 04008000
         B     @RC01061                                            1063 04009000
@RF01061 CLC   RTNCODE(4),@CF00049                                 1063 04010000
         BNE   @RF01063                                            1063 04011000
*                             RENDOF = '1'B; /* SET EOF FLAG         */ 04012000
         OI    RENDOF,B'00100000'                                  1064 04013000
*                           ELSE    /* NOT EOF, IS ERROR             */ 04014000
*                             DO;                                  1065 04015000
         B     @RC01063                                            1065 04016000
@RF01063 DS    0H                                                  1066 04017000
*                               IF RTNCODE^=20   /* CHK FOR MESSAGE  */ 04018000
*                                 THEN        /* YES,                */ 04019000
         LA    @15,20                                              1066 04020000
         C     @15,RTNCODE                                         1066 04021000
         BE    @RF01066                                            1066 04022000
*                                   DO;                            1067 04023000
*                                     MSGNO = 17;   /* MSG INDEX     */ 04024000
         MVC   MSGNO(2),@CH00562                                   1068 04025000
*                                     SOFFS = 20;   /* TEXT OFFSET   */ 04026000
         STH   @15,SOFFS                                           1069 04027000
*                                     CALL  SYSERRD;  /* ISSUE MSG   */ 04028000
         BAL   @14,SYSERRD                                         1070 04029000
*                                   END;                           1071 04030000
*                               UIDQUIT = '1'B; /* TERMINATION       */ 04031000
@RF01066 OI    UIDQUIT,B'10000000'                                 1072 04032000
*                             END;                                 1073 04033000
*               END;                                               1074 04034000
*             ELSE                                                 1075 04035000
*               DO;                                                1075 04036000
         B     @RC01057                                            1075 04037000
@RF01057 DS    0H                                                  1076 04038000
*                 RDDONE = '1'B;    /* SET READ ACCOMPLISHED FLAG    */ 04039000
         OI    RDDONE,B'00000001'                                  1076 04040000
*                 IF RWPF6='0'B     /* DIRECTORY ONLY ?              */ 04041000
*                   THEN            /* NO,                           */ 04042000
         TM    RWPF6,B'00000100'                                   1077 04043000
         BNZ   @RF01077                                            1077 04044000
*                     DO;                                          1078 04045000
*                       RINBUFP = RWPBUF; /* INPUT BUFFER PTR        */ 04046000
         L     @15,RWPBUF-1                                        1079 04047000
         LA    @15,0(,@15)                                         1079 04048000
         ST    @15,RINBUFP                                         1079 04049000
*                       HEDBPTR= RINBUFP; /* UADS MAPPING PTR        */ 04050000
         ST    @15,HEDBPTR                                         1080 04051000
*                       OLRDBUFL=RWPNOM*DCBBLKSI; /* SAVE LNG        */ 04052000
         SLR   @15,@15                                             1081 04053000
         IC    @15,RWPNOM                                          1081 04054000
         LR    @08,@15                                             1081 04055000
         L     @01,DCBPTR                                          1081 04056000
         MH    @08,DCBBLKSI(,@01)                                  1081 04057000
         ST    @08,OLRDBUFL                                        1081 04058000
*                       OLNOBLK = RWPNOM; /* SAVE INPUT NO           */ 04059000
         STH   @15,OLNOBLK                                         1082 04060000
*                       SVTTR = RDTTR;  /* RESERVE TTR  JUST READ    */ 04061000
         L     @15,RWPRBP                                          1083 04062000
         MVC   SVTTR(3),RDTTR(@15)                                 1083 04063000
*                     END;                                         1084 04064000
*               END;                                               1085 04065000
@RF01077 DS    0H                                                  1086 04066000
*               END;                                               1086 04067000
@RC01057 DS    0H                                                  1087 04068000
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */ 04069000
@RF01048 L     R14,SAVLNKC                                         1087 04070000
*           RETURN;                 /* RETURN                        */ 04071000
         B     @EL00004                                            1088 04072000
*/********************************************************************/ 04073000
*/*                                                                  */ 04074000
*/* SEGMENT NAME -- FNDTREE                                          */ 04075000
*/*                                                                  */ 04076000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04077000
*/*                                                                  */ 04078000
*/* FUNCTION -- ADJUST LEVEL POINTERS TO SCAN AND REFORM NEXT        */ 04079000
*/*             ITEM/AUTHORIZATION PATH                              */ 04080000
*/*   OPERATION --                                                   */ 04081000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 04082000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP FNDTREE FUNCTION */ 04083000
*/*   -  IF TSO-STRUCTURE IS CURRENTLY BEING PROCESSED, SET OFFSET   */ 04084000
*/*      TO 1ST TSO TYPE PASSWORD OFFSET BLOCK (UADSPWD1) IN INPUT   */ 04085000
*/*      MEMBER INTO INPUT REBUILD-CONTROL TABLE 1ST OFFSET BLOCK    */ 04086000
*/*      OFFSET (TREEOFF),  SET LOCATION OF FIRST OFFSET BLOCK IN    */ 04087000
*/*      OUTPUT BUFFER IN OUTPUT REBUILD-CONTROL TABLE (NUFLOC),     */ 04088000
*/*      AND SET CONTROL FLAG (DOWHYLT) TO CONTINUE PROCESSING TSO   */ 04089000
*/*      STRUCTURE                                                   */ 04090000
*/*   -  IF NOT CURRENTLY PROCESSING TSO-TYPE STRUCTURE, CLEAR FIRST */ 04091000
*/*      OFFSET BLOCK OFFSET (TREEOFF)                               */ 04092000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 04093000
*/*                                                                  */ 04094000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 04095000
*/*                                                                  */ 04096000
*/* INPUT --                                                         */ 04097000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04098000
*/*                                                                  */ 04099000
*/* OUTPUT --                                                        */ 04100000
*/*   -  OFFSET TO 1ST PASSWORD OFFSET BLOCK SET IN INPUT REBUILD-   */ 04101000
*/*      CONTROL TABLE                                               */ 04102000
*/*   -  LOCATION OF 1ST PASSWORD OFFSET BLOCK SET IN OUTPUT REBUILD-*/ 04103000
*/*      CONTROL TABLE                                               */ 04104000
*/*                                                                  */ 04105000
*/* EXTERNAL REFERENCES -- N/A                                       */ 04106000
*/*                                                                  */ 04107000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 04108000
*/*   CONDITIONS -- N/A                                              */ 04109000
*/*   RETURN CODE -- N/A                                             */ 04110000
*/*                                                                  */ 04111000
*/* EXIT-ERROR --                                                    */ 04112000
*/*   CONDITIONS -- N/A                                              */ 04113000
*/*   RETURN CODE -- N/A                                             */ 04114000
*/*                                                                  */ 04115000
*/********************************************************************/ 04116000
*FNDTREE:   /* ADJUST LEVEL PTRS TO SCAN AND REFORM NEXT ITEM/PATH   */ 04117000
*           ENTRY;                                                 1089 04118000
FNDTREE  DS    0H                                                  1090 04119000
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */ 04120000
         ST    R14,SAVLNKC                                         1090 04121000
*           RESPECIFY (R14) UNRESTRICTED;                          1091 04122000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04123000
*             THEN                  /* NO,                           */ 04124000
         TM    QUITCHK,B'11100000'                                 1092 04125000
         BNZ   @RF01092                                            1092 04126000
*               DO;                                                1093 04127000
*                                                                  1093 04128000
*           IF TSONOW = '1'B        /* CHK IF TSO PROCESSING CURRENT */ 04129000
*             THEN                  /* YES,                          */ 04130000
         TM    TSONOW,B'00100000'                                  1094 04131000
         BNO   @RF01094                                            1094 04132000
*               DO;                                                1095 04133000
*                 TREEOFF = UADSPWD1; /* OFFSET TO 1ST TSO PASSWD    */ 04134000
         L     @08,HEDBPTR                                         1096 04135000
         MVC   TREEOFF(4),UADSPWD1(@08)                            1096 04136000
*                 NUFLOC = ADDR(REXBUFP->UADSPWD1)-4;  /* TO 1ST OB  */ 04137000
         L     @08,REXBUFP                                         1097 04138000
         LA    @08,UADSPWD1(,@08)                                  1097 04139000
         SL    @08,@CF00102                                        1097 04140000
         ST    @08,NUFLOC                                          1097 04141000
*                 DOWHYLT = 0;      /* SET TO LOOP THRU STRUCTURES   */ 04142000
         SLR   @08,@08                                             1098 04143000
         STH   @08,DOWHYLT                                         1098 04144000
*               END;                                               1099 04145000
*             ELSE                  /* TSO PROCESSING NOT CURRENT    */ 04146000
*               TREEOFF = 0;        /* CLEAR 1ST PASSWORD POINTER    */ 04147000
*                                                                  1100 04148000
         B     @RC01094                                            1100 04149000
@RF01094 SLR   @08,@08                                             1100 04150000
         ST    @08,TREEOFF                                         1100 04151000
*               END;                                               1101 04152000
@RC01094 DS    0H                                                  1102 04153000
*           RESPECIFY (R14) RESTRICTED;                            1102 04154000
@RF01092 DS    0H                                                  1103 04155000
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */ 04156000
         L     R14,SAVLNKC                                         1103 04157000
*           RETURN;                 /* RETURN                        */ 04158000
         B     @EL00004                                            1104 04159000
*/********************************************************************/ 04160000
*/*                                                                  */ 04161000
*/* SEGMENT NAME -- RITEM2                                           */ 04162000
*/*                                                                  */ 04163000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04164000
*/*                                                                  */ 04165000
*/* FUNCTION -- BUILD NEW USERID MEMBER -- BUILD DATA BLOCK          */ 04166000
*/*   OPERATION --                                                   */ 04167000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 04168000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RITEM2 FUNCTION  */ 04169000
*/*   -  IF NO DATA BLOCK IS REQUIRED, EXIT                          */ 04170000
*/*   -  IF INDICATED DATA BLOCK CURRENTLY EXISTS FOR MULTIPLE USAGE */ 04171000
*/*      (DPLICHK), SET RESERVED OFFSET TO EXISTING BLOCK (SVFDAT2)  */ 04172000
*/*      IN OUTPUT CURRENT NAME DATA BLOCK OFFSET (NNFDAT2) AND SET  */ 04173000
*/*      RESERVED POINTER TO EXISTING BLOCK (SVDLOC2) IN OUTPUT      */ 04174000
*/*      CURRENT DATA BLOCK POINTER (NNDLOC2)                        */ 04175000
*/*   -  IF INDICATED DATA BLOCK DOES NOT CURRENTLY EXIST, PERFORM   */ 04176000
*/*      SEGMENT GETDBSP TO ACQUIRE SPACE FROM FREESPACE QUEUE.  SET */ 04177000
*/*      ACQUIRED OFFSET IN OUTPUT CURRENT NAME DATA BLOCK OFFSET    */ 04178000
*/*      (NNFDAT2) AND SET DERIVED BLOCK POINTER (NNFDAT2+REXBUFP)   */ 04179000
*/*      IN OUTPUT CURRENT DATA BLOCK POINTER (NNDLOC2).  COPY OLD   */ 04180000
*/*      DATA BLOCK NAME (OLCDB) INTO NEW DATA BLOCK NAME SPACE      */ 04181000
*/*      (NUCDB).  IF INPUT DATA BLOCK USAGE COUNT (OCDBCT) IS MORE  */ 04182000
*/*      THAN 1, SET DUPLICATE USAGE FLAG (DUPLICHK) AND RESERVE     */ 04183000
*/*      CURRENT OFFSET AND POINTER IN SVFDAT2 AND SVDLOC2           */ 04184000
*/*   -  SET OFFSET TO CURRENT DATA BLOCK (NNFDAT2) IN CURRENT OUT-  */ 04185000
*/*      PUT MEMBER OFFSET BLOCK (NCURUDAT)                          */ 04186000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 04187000
*/*                                                                  */ 04188000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 04189000
*/*                                                                  */ 04190000
*/* INPUT --                                                         */ 04191000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04192000
*/*                                                                  */ 04193000
*/* OUTPUT -- N/A                                                    */ 04194000
*/*                                                                  */ 04195000
*/* EXTERNAL REFERENCES -- N/A                                       */ 04196000
*/*                                                                  */ 04197000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 04198000
*/*   CONDITIONS -- N/A                                              */ 04199000
*/*   RETURN CODE -- N/A                                             */ 04200000
*/*                                                                  */ 04201000
*/* EXIT-ERROR -- N/A                                                */ 04202000
*/*   CONDITIONS -- N/A                                              */ 04203000
*/*   RETURN CODE -- N/A                                             */ 04204000
*/*                                                                  */ 04205000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 04206000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 04207000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 04208000
*/*                                                                  */ 04209000
*/********************************************************************/ 04210000
*RITEM2:    /* BUILD NEW USERID MEMBER -- BUILD DATA BLOCK           */ 04211000
*           ENTRY;                                                 1105 04212000
RITEM2   DS    0H                                                  1106 04213000
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */ 04214000
         ST    R14,SAVLNKC                                         1106 04215000
*           RESPECIFY (R14) UNRESTRICTED;                          1107 04216000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG          */ 04217000
*             THEN                  /* NO,                           */ 04218000
         TM    QUITCHK,B'11100000'                                 1108 04219000
         BNZ   @RF01108                                            1108 04220000
*               DO;                                                1109 04221000
*                                                                  1109 04222000
*           IF ONDLOC2 ^= 0         /* CHK IF ANY DATA BLOCK         */ 04223000
*             THEN                  /* YES,                          */ 04224000
         L     @08,ONMIDP                                          1110 04225000
         L     @08,ONDLOC2(,@08)                                   1110 04226000
         LTR   @08,@08                                             1110 04227000
         BZ    @RF01110                                            1110 04228000
*               DO;                                                1111 04229000
*                 IF DUPLICHK = 'FE'X    /* IS USAGE MORE THAN ONE ? */ 04230000
*                   THEN            /* YES,                          */ 04231000
         CLI   DUPLICHK(@08),254                                   1112 04232000
         BNE   @RF01112                                            1112 04233000
*                     DO;                                          1113 04234000
*                       NNFDAT2 = SVFDAT2;  /* USE RESERVED OFFSET   */ 04235000
         L     @15,NNMIDP                                          1114 04236000
         MVC   NNFDAT2(4,@15),SVFDAT2(@08)                         1114 04237000
*                       NNDLOC2 = SVDLOC2;  /* USE RESERVED PTR      */ 04238000
         MVC   NNDLOC2(4,@15),SVDLOC2(@08)                         1115 04239000
*                     END;                                         1116 04240000
*                                                                  1116 04241000
*                   ELSE            /* NOT YET MULTIPLE USAGE        */ 04242000
*                     DO;                                          1117 04243000
         B     @RC01112                                            1117 04244000
@RF01112 DS    0H                                                  1118 04245000
*                       CALL  GETDBSP;  /* GET SPACE FOR DATA BLOCK  */ 04246000
         BAL   @14,GETDBSP                                         1118 04247000
*                       NNFDAT2 = SPZBLOC; /* RESERVE NEW OFFSET     */ 04248000
         L     @08,SPZBLOC                                         1119 04249000
         L     @15,NNMIDP                                          1119 04250000
         ST    @08,NNFDAT2(,@15)                                   1119 04251000
*                       NNDLOC2 = SPZBLOC+ADDR(REXBUF);  /* DATA PTR */ 04252000
         AL    @08,REXBUFP                                         1120 04253000
         ST    @08,NNDLOC2(,@15)                                   1120 04254000
*                       NUCDB(1:SPZBLNG)=OLCDB(1:SPZBLNG);  /* DATA  */ 04255000
         LH    @15,SPZBLNG                                         1121 04256000
         BCTR  @15,0                                               1121 04257000
         L     @01,ONMIDP                                          1121 04258000
         L     @01,ONDLOC2(,@01)                                   1121 04259000
         EX    @15,@SM02097                                        1121 04260000
*                       RESPECIFY (DNOBD) BASED(NNDLOC2);          1122 04261000
*                       IF ACTNOW = '1'B /* IS ACCTNMBR LEVEL NOW ?  */ 04262000
*                         THEN      /* NO,                           */ 04263000
         TM    ACTNOW,B'01000000'                                  1123 04264000
         BNO   @RF01123                                            1123 04265000
*                           UADSADRF = UADSADRF&&UADSADRF;  /* CLEAR */ 04266000
         XC    UADSADRF(40,@08),UADSADRF(@08)                      1124 04267000
*                       RESPECIFY (DNOBD) BASED(UADSAPTR);         1125 04268000
@RF01123 DS    0H                                                  1126 04269000
*                       ACTNOW = '0'B;/* RESET ACCNT NMBR FLAG       */ 04270000
         NI    ACTNOW,B'10111111'                                  1126 04271000
*                       IF OCDBCT > 1   /* IS USAGE CT OVER 1 ?      */ 04272000
*                         THEN      /* YES,                          */ 04273000
         L     @08,ONMIDP                                          1127 04274000
         L     @08,ONDLOC2(,@08)                                   1127 04275000
         CLI   OCDBCT(@08),1                                       1127 04276000
         BNH   @RF01127                                            1127 04277000
*                           DO;                                    1128 04278000
*                             DUPLICHK = 'FE'X;   /* MULTIPLE FLAG   */ 04279000
         MVI   DUPLICHK(@08),X'FE'                                 1129 04280000
*                             SVFDAT2 = NNFDAT2;  /* RESERVE OFFSET  */ 04281000
         L     @15,NNMIDP                                          1130 04282000
         MVC   SVFDAT2(4,@08),NNFDAT2(@15)                         1130 04283000
*                             SVDLOC2 = NNDLOC2;  /* RESERVE PTR     */ 04284000
         MVC   SVDLOC2(4,@08),NNDLOC2(@15)                         1131 04285000
*                           END;                                   1132 04286000
*                     END;                                         1133 04287000
@RF01127 DS    0H                                                  1134 04288000
*                 NCURUDAT = NNFDAT2;  /* SET OFFSET IN NEW BUFFER   */ 04289000
@RC01112 L     @08,NNMIDP                                          1134 04290000
         L     @01,NNFLOC2(,@08)                                   1134 04291000
         MVC   NCURUDAT(3,@01),NNFDAT2+1(@08)                      1134 04292000
*               END;                                               1135 04293000
*                                                                  1135 04294000
*               END;                                               1136 04295000
@RF01110 DS    0H                                                  1137 04296000
*           RESPECIFY (R14) RESTRICTED;                            1137 04297000
@RF01108 DS    0H                                                  1138 04298000
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */ 04299000
         L     R14,SAVLNKC                                         1138 04300000
*           RETURN;                                                1139 04301000
         B     @EL00004                                            1139 04302000
*/********************************************************************/ 04303000
*/*                                                                  */ 04304000
*/* SEGMENT NAME -- DOWRT2                                           */ 04305000
*/*                                                                  */ 04306000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04307000
*/*                                                                  */ 04308000
*/* FUNCTION -- WRITE REFORMATTED MEMBER AND/OR FREE OUTPUT BUFFER   */ 04309000
*/*   OPERATION --                                                   */ 04310000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 04311000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP DOWRT2 FUNCTION  */ 04312000
*/*   -  SET POINTER TO ACCOUNT-READ/WRITE PARAMETER BLOCK (RWPB)    */ 04313000
*/*      IN REGISTER 1                                               */ 04314000
*/*   -  EXECUTE ACCOUNT-WRITE -- IKJEFA52                           */ 04315000
*/*   -  IF RETURN CODE (REGISTER 15) IS NOT 0 OR IS NOT 20 (ERROR   */ 04316000
*/*      MESSAGE ISSUED BY ACCOUNT-WRITE), ISSUE ERROR MESSAGE 32    */ 04317000
*/*      AND SET USERID TERMINATION FLAG (UIDQUIT)                   */ 04318000
*/*   -  IF WRITE WAS SUCCESSFUL (RETURN CODE = 0) AND IF CURRENTLY  */ 04319000
*/*      IN UPDAT MODE, RESET BUFFER-READ FLAG (IKJEFA52 FREE THE    */ 04320000
*/*      UPDAT BUFFER)                                               */ 04321000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 04322000
*/*                                                                  */ 04323000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 04324000
*/*                                                                  */ 04325000
*/* INPUT --                                                         */ 04326000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04327000
*/*   -  RWPB SET TO WRITE AND/OR FREE BUFFER                        */ 04328000
*/*                                                                  */ 04329000
*/* OUTPUT --                                                        */ 04330000
*/*   -  REFORMATTED UADS MEMBER WRITTEN TO SYSUADS AND/OR OUTPUT    */ 04331000
*/*      BUFFER FREED                                                */ 04332000
*/*                                                                  */ 04333000
*/* EXTERNAL REFERENCES -- ACCOUNT-WRITE -- IKJEFA52                 */ 04334000
*/*                                                                  */ 04335000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 04336000
*/*   CONDITIONS --                                                  */ 04337000
*/*   -  MEMBER WRITTEN AND/OR BUFFER FREED                          */ 04338000
*/*   RETURN CODE -- N/A                                             */ 04339000
*/*                                                                  */ 04340000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 04341000
*/*   CONDITIONS --                                                  */ 04342000
*/*   -  UNSUCCESSFUL WRITE (UIDQUIT FLAG SET)                       */ 04343000
*/*   RETURN CODE -- N/A                                             */ 04344000
*/*                                                                  */ 04345000
*/********************************************************************/ 04346000
*DOWRT2:    /* WRITE REFORMATTED MEMBER AND/OR FREE BUFFER           */ 04347000
*           ENTRY;                                                 1140 04348000
*                                                                  1140 04349000
DOWRT2   DS    0H                                                  1141 04350000
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */ 04351000
         ST    R14,SAVLNKC                                         1141 04352000
*           RESPECIFY (R14) UNRESTRICTED;                          1142 04353000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04354000
*             THEN                  /* NO,                           */ 04355000
         TM    QUITCHK,B'11100000'                                 1143 04356000
         BNZ   @RF01143                                            1143 04357000
*               DO;                                                1144 04358000
*                                                                  1144 04359000
*           RESPECIFY (R1,R15) RESTRICTED;                         1145 04360000
*           R1 = ADDR(RWPB);        /* SET PTR TO WRITE PB           */ 04361000
         LA    R1,RWPB                                             1146 04362000
*           CALL  IKJEFA52;         /* GO TO WRITE ROUTINE           */ 04363000
         L     @15,@CV00038                                        1147 04364000
         BALR  @14,@15                                             1147 04365000
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */ 04366000
         ST    R15,RTNCODE                                         1148 04367000
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1149 04368000
*           IF RTNCODE ^= 0         /* CHK FOR CODE FOR SUCCESS      */ 04369000
*             THEN                  /* NO,                           */ 04370000
         L     @08,RTNCODE                                         1150 04371000
         LTR   @08,@08                                             1150 04372000
         BZ    @RF01150                                            1150 04373000
*               DO;                                                1151 04374000
*                 UIDQUIT = '1'B;   /* SET USER TERMINATION          */ 04375000
         OI    UIDQUIT,B'10000000'                                 1152 04376000
*                 IF RTNCODE ^= 20  /*     OR ERROR-MESSAGE-ISSUED   */ 04377000
*                   THEN            /* NO,                           */ 04378000
         LA    @15,20                                              1153 04379000
         CR    @08,@15                                             1153 04380000
         BE    @RF01153                                            1153 04381000
*                     DO;                                          1154 04382000
*                       MSGNO = 23;     /* SET MESSAGE INDEX         */ 04383000
         MVC   MSGNO(2),@CH01991                                   1155 04384000
*                       SOFFS = 20;     /* SET TEXT INSERT OFFSET    */ 04385000
         STH   @15,SOFFS                                           1156 04386000
*                       CALL  SYSERRD;  /* GO TO ISSUE MESSAGE       */ 04387000
         BAL   @14,SYSERRD                                         1157 04388000
*                     END;                                         1158 04389000
*               END;                                               1159 04390000
*             ELSE                  /* SUCCESSFUL RETURN CODE,       */ 04391000
*               IF RWPRBP ^= 0      /* CHK FOR UPDAT MODE            */ 04392000
*                 THEN              /* YES,                          */ 04393000
         B     @RC01150                                            1160 04394000
@RF01150 L     @08,RWPRBP                                          1160 04395000
         LTR   @08,@08                                             1160 04396000
         BZ    @RF01160                                            1160 04397000
*                   RDDONE = '0'B;  /* RESET BUFFER-READ FLAG        */ 04398000
*                                                                  1161 04399000
         NI    RDDONE,B'11111110'                                  1161 04400000
*               END;                                               1162 04401000
@RF01160 DS    0H                                                  1162 04402000
@RC01150 DS    0H                                                  1163 04403000
*           RESPECIFY (R14) RESTRICTED;                            1163 04404000
@RF01143 DS    0H                                                  1164 04405000
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */ 04406000
         L     R14,SAVLNKC                                         1164 04407000
*           RETURN;                 /* RETURN                        */ 04408000
         B     @EL00004                                            1165 04409000
*/********************************************************************/ 04410000
*/*                                                                  */ 04411000
*/* SEGMENT NAME -- RSTOW                                            */ 04412000
*/*                                                                  */ 04413000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04414000
*/*                                                                  */ 04415000
*/* FUNCTION -- STOW REFORMATTED MEMBER NAME FOR SYSUADS UADS        */ 04416000
*/*   OPERATION --                                                   */ 04417000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 04418000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RSTOW FUNCTION   */ 04419000
*/*   -  INITIALIZE STOW PARAMETER BLOCK (STOLST)                    */ 04420000
*/*   -  IF STOW IS FOR FIRST BLOCK OF USERID (IDENTITY CHARACTER OF */ 04421000
*/*      ZERO) SET COUNT AND STRUCTURE TYPE FLAG (TSO/NEW) IN STOW   */ 04422000
*/*      ENTRY USER AREA                                             */ 04423000
*/*   -  IF IN UPDAT MODE, SET ALIAS FLAG (STLALYS)  AND USE THE     */ 04424000
*/*      RESERVED TTR (SVTTR)                                        */ 04425000
*/*   -  EXECUTE STOW MACRO                                          */ 04426000
*/*   -  IF STOW RETURN CODE IS NOT ZERO, ISSUE ERROR MESSAGE 14 AND */ 04427000
*/*      SET UADSREFM TERMINATION FLAG (RFMQUIT)                     */ 04428000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 04429000
*/*                                                                  */ 04430000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 04431000
*/*                                                                  */ 04432000
*/* INPUT --                                                         */ 04433000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04434000
*/*   -  USERID NAME IN NODIDC                                       */ 04435000
*/*                                                                  */ 04436000
*/* OUTPUT --                                                        */ 04437000
*/*   -  USERID MEMBER BLOCK NAME STOWED                             */ 04438000
*/*                                                                  */ 04439000
*/* EXTERNAL REFERENCES -- STOW MACRO                                */ 04440000
*/*                                                                  */ 04441000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 04442000
*/*   CONDITIONS --                                                  */ 04443000
*/*   -  SUCCESSFUL STOW                                             */ 04444000
*/*   RETURN CODE -- N/A                                             */ 04445000
*/*                                                                  */ 04446000
*/* EXIT-ERROR --  RETURN BY ENTRY LINK REGISTER 14                  */ 04447000
*/*   CONDITIONS --                                                  */ 04448000
*/*   -  UNSUCCESSFUL STOW (ERROR MESSAGE 14 AND RFMQUIT FLAG SET)   */ 04449000
*/*   RETURN CODE --                                                 */ 04450000
*/*                                                                  */ 04451000
*/********************************************************************/ 04452000
*RSTOW:     /* STOW REFORMATTED MEMBER FOR SYSUADS UADS              */ 04453000
*           ENTRY;                                                 1166 04454000
RSTOW    DS    0H                                                  1167 04455000
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */ 04456000
         ST    R14,SAVLNKC                                         1167 04457000
*           RESPECIFY (R14) UNRESTRICTED;                          1168 04458000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04459000
*             THEN                  /* NO,                           */ 04460000
         TM    QUITCHK,B'11100000'                                 1169 04461000
         BNZ   @RF01169                                            1169 04462000
*               DO;                                                1170 04463000
*                                                                  1170 04464000
*           STOLST=STOLST&&STOLST;  /* CLEAR STOW PARM BLOCK         */ 04465000
         XC    STOLST(14),STOLST                                   1171 04466000
*           STLUSER(1:8) = NODIDC;  /* SET STOW NAME                 */ 04467000
         MVC   STLUSER(8),NODIDC                                   1172 04468000
*           STLCTUA=STLCTUA&HIORDR3;  /* CLEAR LOWER ORDER           */ 04469000
         SLR   @08,@08                                             1173 04470000
         IC    @08,STLCTUA                                         1173 04471000
         MVC   @ZT00003+3(1),HIORDR3                               1173 04472000
         N     @08,@ZT00003                                        1173 04473000
         STC   @08,STLCTUA                                         1173 04474000
*           STLCTUA=STLCTUA|1;      /* SET COUNT FOR USER AREA       */ 04475000
         O     @08,@CF00032                                        1174 04476000
         STC   @08,STLCTUA                                         1174 04477000
*           IF NODIDC(NODIDL+1)='0'    /* CHK FOR 1ST MEMBER BLOCK   */ 04478000
*             THEN                  /* YES,                          */ 04479000
         LH    @08,NODIDL                                          1175 04480000
         LA    @01,NODIDC(@08)                                     1175 04481000
         CLI   0(@01),C'0'                                         1175 04482000
         BNE   @RF01175                                            1175 04483000
*               DO;                                                1176 04484000
*                 IF EQUIUAD = '1'B /* CHK FOR UPDAT MODE            */ 04485000
*                   THEN            /* YES,                          */ 04486000
         TM    EQUIUAD,B'01000000'                                 1177 04487000
         BNO   @RF01177                                            1177 04488000
*                     DO;                                          1178 04489000
*                       STLALYS = '1'B; /* SET ALIAS FLAG            */ 04490000
         OI    STLALYS,B'10000000'                                 1179 04491000
*                       STLTTRC = SVTTR;  /* SET TTR FOR STOW        */ 04492000
         MVC   STLTTRC(3),SVTTR                                    1180 04493000
*                     END;                                         1181 04494000
*               END;                                               1182 04495000
*                                                                  1182 04496000
@RF01177 DS    0H                                                  1183 04497000
*           RESPECIFY  (QNAMR,R15) RESTRICTED;  /* RESERVE REGISTER  */ 04498000
@RF01175 DS    0H                                                  1184 04499000
*           QNAMR = RWPUDP;         /* SET PTR TO DCB                */ 04500000
         L     QNAMR,RWPUDP-1                                      1184 04501000
         LA    QNAMR,0(,QNAMR)                                     1184 04502000
*           GEN(STOW  (QNAMR),STOLST,R);  /* TO EXECUTE STOW         */ 04503000
         STOW  (QNAMR),STOLST,R                                         04504000
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */ 04505000
         ST    R15,RTNCODE                                         1186 04506000
*           RESPECIFY  (QNAMR,R15) UNRESTRICTED;  /* FREE REGISTER   */ 04507000
*           IF RTNCODE ^= 0         /* CHK FOR SUCCESSFUL STOW  (OLD */ 04508000
*               & RTNCODE ^= 8      /*    OR NEW MEMBER)             */ 04509000
*             THEN                  /* NO,                           */ 04510000
         L     @08,RTNCODE                                         1188 04511000
         LTR   @08,@08                                             1188 04512000
         BZ    @RF01188                                            1188 04513000
         CH    @08,@CH00046                                        1188 04514000
         BE    @RF01188                                            1188 04515000
*               DO;                                                1189 04516000
*                 MSGNO = 14;       /* SET MESSAGE INDEX             */ 04517000
         MVC   MSGNO(2),@CH00231                                   1190 04518000
*                 SOFFS = 24;       /* SET TEXT INSERT OFFSET        */ 04519000
         MVC   SOFFS(2),@CH00049                                   1191 04520000
*                 CALL  SYSERRD;    /* GO TO ISSUE MESSAGE           */ 04521000
         BAL   @14,SYSERRD                                         1192 04522000
*                 RFMQUIT = '1'B;   /* SET UADSREFM TERMINATION FLAG */ 04523000
         OI    RFMQUIT,B'01000000'                                 1193 04524000
*                 STODON = '0'B;    /* CLEAR STOW DONE FLAG          */ 04525000
         NI    STODON,B'01111111'                                  1194 04526000
*               END;                                               1195 04527000
*             ELSE                  /* SUCCESSFUL STOW               */ 04528000
*               STODON = '1'B;      /* SET STOW DONE FLAG            */ 04529000
*                                                                  1196 04530000
         B     @RC01188                                            1196 04531000
@RF01188 OI    STODON,B'10000000'                                  1196 04532000
*               END;                                               1197 04533000
@RC01188 DS    0H                                                  1198 04534000
*           RESPECIFY (R14) RESTRICTED;                            1198 04535000
@RF01169 DS    0H                                                  1199 04536000
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */ 04537000
         L     R14,SAVLNKC                                         1199 04538000
*           RETURN;                 /* RETURN                        */ 04539000
         B     @EL00004                                            1200 04540000
*/********************************************************************/ 04541000
*/*                                                                  */ 04542000
*/* SEGMENT NAME -- BLNKBUF                                          */ 04543000
*/*                                                                  */ 04544000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04545000
*/*                                                                  */ 04546000
*/* FUNCTION -- CLEAR WRITE BUFFER TO BLANKS                         */ 04547000
*/*   OPERATION --                                                   */ 04548000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 04549000
*/*   -  INITIALIZE 1ST BYTE OF BUFFER TO BLANK                      */ 04550000
*/*   -  RESTRICT REGISTER PTR TO OP CODE (RSPZOP) AND TO LENGTH OF  */ 04551000
*/*      OPERATIVE AREA (RLNG)                                       */ 04552000
*/*   -  SET LENGTH OF BUFFER LESS 1 IN RLNG                         */ 04553000
*/*   -  SET PTR TO LARGE SCALE MVC OPERATION (RSPZOP)               */ 04554000
*/*   -  RESTRICT REGISTER PTR TO SOURCE AREA (RFROM) AND TO TARGET  */ 04555000
*/*      AREA (RTO)                                                  */ 04556000
*/*   -  CALL SEGMENT DOPSPAZ TO PERFORM LARGE SCALE MVC             */ 04557000
*/*   -  RELEASE RESTRICTED PTRS                                     */ 04558000
*/*                                                                  */ 04559000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 04560000
*/*                                                                  */ 04561000
*/* INPUT --                                                         */ 04562000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04563000
*/*                                                                  */ 04564000
*/* OUTPUT --                                                        */ 04565000
*/*   -  USERID MESSAGE BUFFER BLANKED OUT                           */ 04566000
*/*                                                                  */ 04567000
*/* EXTERNAL REFERENCES -- N/A                                       */ 04568000
*/*                                                                  */ 04569000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 04570000
*/*   CONDITIONS -- N/A                                              */ 04571000
*/*   RETURN CODE -- N/A                                             */ 04572000
*/*                                                                  */ 04573000
*/* EXIT-ERROR -- N/A                                                */ 04574000
*/*   CONDITIONS -- N/A                                              */ 04575000
*/*   RETURN CODE -- N/A                                             */ 04576000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 04577000
*/*        BE INCORPORATED  AS  AN INCLUDED CODE SEGMENT  WHEN THE   */ 04578000
*/* INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION              */ 04579000
*/*                                                                  */ 04580000
*/********************************************************************/ 04581000
*BLNKBUF:   /* FREE WRITE BUFFER IF CURRENTLY EXISTANT               */ 04582000
*           ENTRY;                                                 1201 04583000
*                                                                  1201 04584000
BLNKBUF  DS    0H                                                  1202 04585000
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */ 04586000
         ST    R14,SAVLNKC                                         1202 04587000
*           RESPECIFY (R14) UNRESTRICTED;                          1203 04588000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04589000
*             THEN                  /* NO,                           */ 04590000
         TM    QUITCHK,B'11100000'                                 1204 04591000
         BNZ   @RF01204                                            1204 04592000
*               DO;                                                1205 04593000
*                                                                  1205 04594000
*           IDSBUF(1) = ' ';        /* SET 1ST CHAR TO BLANK         */ 04595000
         MVI   IDSBUF,C' '                                         1206 04596000
*           RESPECIFY  (RSPZOP,RLNG) RESTRICTED;                   1207 04597000
*           RLNG=LENGTH(IDSBUF)-1;  /* SET BLANKING LENGTH           */ 04598000
         LA    RLNG,1079                                           1208 04599000
*           RSPZOP=ADDR(MVCOP);     /* SET PTR TO MVC OPERATION      */ 04600000
         LA    RSPZOP,MVCOP                                        1209 04601000
*           RESPECIFY  (RFROM,RTO) RESTRICTED;                     1210 04602000
*           RFROM=ADDR(IDSBUF);     /* SET SOURCE PTR                */ 04603000
         LA    RFROM,IDSBUF                                        1211 04604000
*           RTO = RFROM+1;          /* SET TARGET PTR                */ 04605000
         LA    RTO,1                                               1212 04606000
         ALR   RTO,RFROM                                           1212 04607000
*           CALL  DOPSPAZ;          /* GO TO BLANK OUT BUFFER        */ 04608000
         BAL   @14,DOPSPAZ                                         1213 04609000
*           RESPECIFY  (RSPZOP,RSPW,RLNG,RFROM,RTO) UNRESTRICTED;  1214 04610000
*                                                                  1214 04611000
*               END;                                               1215 04612000
*           RESPECIFY (R14) RESTRICTED;                            1216 04613000
@RF01204 DS    0H                                                  1217 04614000
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */ 04615000
         L     R14,SAVLNKC                                         1217 04616000
*           END  OPENDCB;           /* RETURN                        */ 04617000
         B     @EL00004                                            1218 04618000
*/********************************************************************/ 04619000
*/*                                                                  */ 04620000
*/* SEGMENT NAME -- GETDBSP                                          */ 04621000
*/*                                                                  */ 04622000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04623000
*/*                                                                  */ 04624000
*/* FUNCTION -- GET SPACE FOR DATA BLOCK FROM FREESPACE QUEUE        */ 04625000
*/*   OPERATION --                                                   */ 04626000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 04627000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP GETDBSP FUNCTION */ 04628000
*/*   -  SET PARAMETER BLOCK(SPZBLNG) FOR LENGTH OF INPUT DATA BLOCK */ 04629000
*/*   -  PERFORM SEGMENT DOGETSP TO LOCATE AVAILABLE FREE SPACE      */ 04630000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 04631000
*/*                                                                  */ 04632000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 04633000
*/*                                                                  */ 04634000
*/* INPUT --                                                         */ 04635000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04636000
*/*                                                                  */ 04637000
*/* OUTPUT --                                                        */ 04638000
*/*   -  BLOCK LENGTH SET IN GETSPACE PARAMETER BLOCK (SPZBLNG)      */ 04639000
*/*      (SPACE ACQUIRED VIA DOGETSP)                                */ 04640000
*/*                                                                  */ 04641000
*/* EXTERNAL REFERENCES -- N/A                                       */ 04642000
*/*                                                                  */ 04643000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 04644000
*/*   CONDITIONS -- N/A                                              */ 04645000
*/*   RETURN CODE -- N/A                                             */ 04646000
*/*                                                                  */ 04647000
*/* EXIT-ERROR -- N/A                                                */ 04648000
*/*   CONDITIONS -- N/A                                              */ 04649000
*/*   RETURN CODE -- N/A                                             */ 04650000
*/*                                                                  */ 04651000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 04652000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 04653000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 04654000
*/*                                                                  */ 04655000
*/********************************************************************/ 04656000
*GETDBSP:   /* GET SPACE FOR DATA BLOCK FROM FREESPACE QUEUE         */ 04657000
*                                                                  1219 04658000
*           PROCEDURE                                              1219 04659000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 04660000
GETDBSP  DS    0H                                                  1220 04661000
*                                   /* NO SAVE AREA CREATED          */ 04662000
*           RESPECIFY (R14) RESTRICTED;                            1220 04663000
*           SAVLNKD = R14;          /* SAVE LINK REGISTER            */ 04664000
         ST    R14,SAVLNKD                                         1221 04665000
*           RESPECIFY (R14) UNRESTRICTED;                          1222 04666000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04667000
*             THEN                  /* NO,                           */ 04668000
         TM    QUITCHK,B'11100000'                                 1223 04669000
         BNZ   @RF01223                                            1223 04670000
*               DO;                                                1224 04671000
*                                                                  1224 04672000
*           SPZBLNG = 12;           /* LENGTH FOR PASSWARD DATA BLK  */ 04673000
         MVC   SPZBLNG(2),@CH00036                                 1225 04674000
*           IF TSTLVL > ADDR(OPOFFS)  /* CHK FOR PASSWORD LEVEL      */ 04675000
*             THEN                  /* NO,                           */ 04676000
         L     @08,TSTLVL                                          1226 04677000
         LA    @15,OPOFFS                                          1226 04678000
         CR    @08,@15                                             1226 04679000
         BNH   @RF01226                                            1226 04680000
*               DO;                                                1227 04681000
*                 IF TSTLVL > ADDR(OAOFFS) /* IS ACCTNMBR LEVEL ?    */ 04682000
*                   THEN            /* NO,                           */ 04683000
         LA    @15,OAOFFS                                          1228 04684000
         CR    @08,@15                                             1228 04685000
         BNH   @RF01228                                            1228 04686000
*                     SPZBLNG=24;   /* SET TO PROCNAME DB LENGTH     */ 04687000
         MVC   SPZBLNG(2),@CH00049                                 1229 04688000
*                   ELSE            /* YES, ACCOUNT NUMBER LEVEL     */ 04689000
*                     DO;                                          1230 04690000
         B     @RC01228                                            1230 04691000
@RF01228 DS    0H                                                  1231 04692000
*                       SPZBLNG=OCANLEN  /* SET TO ACCTNMBR          */ 04693000
*                           +LENGTH(UADSADRF)+5;   /* DB LENGTH      */ 04694000
         L     @08,ONMIDP                                          1231 04695000
         L     @08,ONDLOC2(,@08)                                   1231 04696000
         SLR   @01,@01                                             1231 04697000
         IC    @01,OCANLEN(,@08)                                   1231 04698000
         LA    @01,45(,@01)                                        1231 04699000
         STH   @01,SPZBLNG                                         1231 04700000
*                       ACTNOW = '1'B; /* SET ACCNT NMBR NOW FLAG    */ 04701000
         OI    ACTNOW,B'01000000'                                  1232 04702000
*                     END;                                         1233 04703000
*               END;                                               1234 04704000
*                                                                  1234 04705000
@RC01228 DS    0H                                                  1235 04706000
*           CALL  DOGETSP;          /* GO TO ACQUIRE SPACE           */ 04707000
*                                                                  1235 04708000
@RF01226 BAL   @14,DOGETSP                                         1235 04709000
*               END;                                               1236 04710000
*           RESPECIFY (R14) RESTRICTED;                            1237 04711000
@RF01223 DS    0H                                                  1238 04712000
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */ 04713000
         L     R14,SAVLNKD                                         1238 04714000
*           RETURN;                 /* RETURN                        */ 04715000
@EL00005 DS    0H                                                  1239 04716000
@EF00005 DS    0H                                                  1239 04717000
@ER00005 BR    @14                                                 1239 04718000
*/********************************************************************/ 04719000
*/*                                                                  */ 04720000
*/* SEGMENT NAME -- RDEQM                                            */ 04721000
*/*                                                                  */ 04722000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04723000
*/*                                                                  */ 04724000
*/* FUNCTION -- DEQUEUE FROM SYSIKJUA/'USERID-MEMBERNAME'            */ 04725000
*/*   OPERATION --                                                   */ 04726000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 04727000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDEQM FUNCTION   */ 04728000
*/*   -  IF MEMBER NAME ENQUEUE IS CURRENTLY IN FORCE (NQMNOW), SET  */ 04729000
*/*      POINTER TO RNAME (USERID) IN REGISTER 5 AND LENGTH OF NAME  */ 04730000
*/*      IN REGISTER 6, SET POINTER TO DEQUEUE PARAMETER BLOCK       */ 04731000
*/*      (DQMBR) IN REGISTER 1 AND EXECUTE DEQ MACRO                 */ 04732000
*/*      -  IF RETURN CODE (REGISTER 15) IS NOT 0, CHECK RETURN CODE */ 04733000
*/*         LIST (POINTED TO BY REGISTER 15)                         */ 04734000
*/*         -  IF RETURN CODE LIST VALUE IS 4, CLEAR ENQUEUE IN      */ 04735000
*/*            FORCE FLAG (NQMNOW)                                   */ 04736000
*/*         _  FOR ANY OTHER RETURN CODE VALUE  ISSUE ERROR MESSAGE  */ 04737000
*/*            27 AND SET UADSREFM TERMINATION FLAG (RFMQUIT)        */ 04738000
*/*      -  IF PRIME RETURN CODE (REGISTER 15) IS 0, CLEAR ENQUEUE   */ 04739000
*/*         IN FORCE FLAG (NQMNOW)                                   */ 04740000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 04741000
*/*                                                                  */ 04742000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 04743000
*/*                                                                  */ 04744000
*/* INPUT --                                                         */ 04745000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04746000
*/*   -  ENQUEUED MEMBER NAME IN NQMIDC, LENGTH IN NQMIDL            */ 04747000
*/*                                                                  */ 04748000
*/* OUTPUT -- N/A                                                    */ 04749000
*/*                                                                  */ 04750000
*/* EXTERNAL REFERENCES -- DEQ MACRO                                 */ 04751000
*/*                                                                  */ 04752000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 04753000
*/*   CONDITIONS --                                                  */ 04754000
*/*   -  SUCCESSFUL DEQ                                              */ 04755000
*/*   RETURN CODE -- N/A                                             */ 04756000
*/*                                                                  */ 04757000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 04758000
*/*   CONDITIONS --                                                  */ 04759000
*/*   -  UNSUCCESSFUL DEQ (ISSUE MESSAGE 27 AND SET RFMQUIT          */ 04760000
*/*   RETURN CODE -- N/A                                             */ 04761000
*/*                                                                  */ 04762000
*/********************************************************************/ 04763000
*RDEQM:     /* DEQUEUE FROM USERID MEMBER NAME                       */ 04764000
*           /* ENQUEUE AT RENQM                                      */ 04765000
*           ENTRY;                                                 1240 04766000
*                                                                  1240 04767000
RDEQM    DS    0H                                                  1241 04768000
*           SAVLNKD = R14;          /* SAVE LINK REGISTER            */ 04769000
         ST    R14,SAVLNKD                                         1241 04770000
*           RESPECIFY (R14) UNRESTRICTED;                          1242 04771000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04772000
*             THEN                  /* NO,                           */ 04773000
         TM    QUITCHK,B'11100000'                                 1243 04774000
         BNZ   @RF01243                                            1243 04775000
*               DO;                                                1244 04776000
*                                                                  1244 04777000
*           IF NQMNOW = '1'B        /* CHK IF ENQ IN FORCE           */ 04778000
*             THEN                  /* YES,                          */ 04779000
         TM    NQMNOW,B'00000010'                                  1245 04780000
         BNO   @RF01245                                            1245 04781000
*               DO;                                                1246 04782000
*                 RESPECIFY (QNAMR,QLNGR,R1,R15) RESTRICTED;       1247 04783000
*                 QNAMR = ADDR(NQMIDC);  /* SET PTR TO MINOR NAME    */ 04784000
         LA    QNAMR,NQMIDC                                        1248 04785000
*                 QLNGR = NQMIDL;   /* SET MINOR NAME LENGTH         */ 04786000
         LH    QLNGR,NQMIDL                                        1249 04787000
*                 R1 = ADDR(DQMBR); /* SET PTR TO DEQ PARM BLOCK     */ 04788000
         LA    R1,DQMBR                                            1250 04789000
*                 /* DEQUEUE FROM SYSIKJUA/'USERID'                  */ 04790000
*                 GEN(DEQ   (,(QNAMR),(QLNGR),,),MF=(E,(1)));      1251 04791000
         DEQ   (,(QNAMR),(QLNGR),,),MF=(E,(1))                          04792000
*                 RTNCODE = R15;    /* RESERVE RETURN CODE           */ 04793000
         ST    R15,RTNCODE                                         1252 04794000
*                 RESPECIFY (QNAMR,QLNGR,R1,R15) UNRESTRICTED;     1253 04795000
*                 IF RTNCODE^=0     /* CHK FOR SUCCESSFUL DEQUEUE    */ 04796000
*                   THEN            /* NO,                           */ 04797000
         L     @08,RTNCODE                                         1254 04798000
         LTR   @08,@08                                             1254 04799000
         BZ    @RF01254                                            1254 04800000
*                     DO;                                          1255 04801000
*                       RCPTR=RTNCODE;  /* SET PTR TO RETURN CODE    */ 04802000
         ST    @08,RCPTR                                           1256 04803000
*                       IF RCLC1=4   /* IS ENQUEUE CURRENT           */ 04804000
*                         THEN      /* NO,                           */ 04805000
         CLI   RCLC1(@08),4                                        1257 04806000
         BNE   @RF01257                                            1257 04807000
*                           NQMNOW = '0'B;/*SET NO ENQ IN FORCE FLAG */ 04808000
         NI    NQMNOW,B'11111101'                                  1258 04809000
*                         ELSE                                     1259 04810000
*                           DO;                                    1259 04811000
         B     @RC01257                                            1259 04812000
@RF01257 DS    0H                                                  1260 04813000
*                             MSGNO = 27;   /* SET MESSAGE INDEX     */ 04814000
         MVC   MSGNO(2),@CH01967                                   1260 04815000
*                             SOFFS = 20;   /* SET TEXT OFFSET       */ 04816000
         MVC   SOFFS(2),@CH00351                                   1261 04817000
*                             CALL SYSERRD; /* TO ISSUE PUTLINE      */ 04818000
         BAL   @14,SYSERRD                                         1262 04819000
*                             RFMQUIT='1'B; /* TERMINATION FLAG      */ 04820000
         OI    RFMQUIT,B'01000000'                                 1263 04821000
*                           END;                                   1264 04822000
*                     END;                                         1265 04823000
*                   ELSE            /* SUCCESSFUL DEQUEUE            */ 04824000
*                     NQMNOW = '0'B;/* SET NO ENQ IN FORCE FLAG      */ 04825000
         B     @RC01254                                            1266 04826000
@RF01254 NI    NQMNOW,B'11111101'                                  1266 04827000
*               END;                                               1267 04828000
*                                                                  1267 04829000
@RC01254 DS    0H                                                  1268 04830000
*               END;                                               1268 04831000
@RF01245 DS    0H                                                  1269 04832000
*           RESPECIFY (R14) RESTRICTED;                            1269 04833000
@RF01243 DS    0H                                                  1270 04834000
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */ 04835000
         L     R14,SAVLNKD                                         1270 04836000
*           RETURN;                 /* RETURN                        */ 04837000
         B     @EL00005                                            1271 04838000
*/********************************************************************/ 04839000
*/*                                                                  */ 04840000
*/* SEGMENT NAME -- NOUSP                                            */ 04841000
*/*                                                                  */ 04842000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04843000
*/*                                                                  */ 04844000
*/* FUNCTION -- ISSUE INSUFFICIENT SPACE FOR USERID MESSAGE          */ 04845000
*/*   OPERATION --                                                   */ 04846000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 04847000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP NOUSP FUNCTION   */ 04848000
*/*   -  SET MESSAGE INDEX TO 16                                     */ 04849000
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */ 04850000
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT CONTAINING USERID NAME AND    */ 04851000
*/*      BUILD DYNAMIC SEGMENT LIST (TMSGNS1)                        */ 04852000
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */ 04853000
*/*   -  PERFORM SEGMENT FXPUTL TO INITIALIZE PUTLINE PARM BLOCK     */ 04854000
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE (VIA PUTLINE)       */ 04855000
*/*   -  SET USERID TERMINATION FLAG (UIDQUIT)                       */ 04856000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 04857000
*/*                                                                  */ 04858000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 04859000
*/*                                                                  */ 04860000
*/* INPUT --                                                         */ 04861000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04862000
*/*                                                                  */ 04863000
*/* OUTPUT --                                                        */ 04864000
*/*   -  ERROR MESSAGE 16                                            */ 04865000
*/*   -  USERID TERMINATION FLAG SET (UIDQUIT)                       */ 04866000
*/*                                                                  */ 04867000
*/* EXTERNAL REFERENCES -- N/A                                       */ 04868000
*/*                                                                  */ 04869000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 04870000
*/*   CONDITIONS -- N/A                                              */ 04871000
*/*   RETURN CODE -- N/A                                             */ 04872000
*/*                                                                  */ 04873000
*/* EXIT-ERROR -- N/A                                                */ 04874000
*/*   CONDITIONS -- N/A                                              */ 04875000
*/*   RETURN CODE -- N/A                                             */ 04876000
*/*                                                                  */ 04877000
*/********************************************************************/ 04878000
*NOUSP:     /* ISSUE INSUFFICIENT SPACE FOR USERID MESSAGE           */ 04879000
*                                                                  1272 04880000
*           ENTRY;                                                 1272 04881000
*                                                                  1272 04882000
NOUSP    DS    0H                                                  1273 04883000
*           SAVLNKD = R14;          /* RESERVE LINK REGISTER         */ 04884000
         ST    R14,SAVLNKD                                         1273 04885000
*           RESPECIFY (R14) UNRESTRICTED;                          1274 04886000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04887000
*             THEN                  /* NO,                           */ 04888000
         TM    QUITCHK,B'11100000'                                 1275 04889000
         BNZ   @RF01275                                            1275 04890000
*               DO;                                                1276 04891000
*                                                                  1276 04892000
*           MSGNO = 16;             /* SET MESSAGE INDEX             */ 04893000
         MVC   MSGNO(2),@CH00076                                   1277 04894000
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE          */ 04895000
         BAL   @14,MSGFNDR                                         1278 04896000
*           TMSGNS1(1:12) = TMLMDL1(1:12);  /* SET SEGMENT LIST      */ 04897000
         L     @08,MSGPTR                                          1279 04898000
         MVC   TMSGNS1(12),TMLMDL1(@08)                            1279 04899000
*           TMSGNP12 = ADDR(TMSGTIX1); /* SET 2ND SEGMENT PTR        */ 04900000
         LA    @08,TMSGTIX1                                        1280 04901000
         ST    @08,TMSGNP12                                        1280 04902000
*           TMSGTIL1 = NODIDL+4;    /* SET SEGMENT LENGTH            */ 04903000
         LH    @08,NODIDL                                          1281 04904000
         LA    @01,4(,@08)                                         1281 04905000
         STH   @01,TMSGTIL1                                        1281 04906000
*           TMSGTIO1 = 51;          /* SET TEXT OFFSET               */ 04907000
         MVC   TMSGTIO1(2),@CH02008                                1282 04908000
*           TMSGTIN1(1:NODIDL) = NODIDC;  /* SET INSERT TEXT         */ 04909000
         BCTR  @08,0                                               1283 04910000
         EX    @08,@SM02092                                        1283 04911000
*           MSGPTR = ADDR(TMSGNS1); /* SET PTR TO TEXT               */ 04912000
*                                                                  1284 04913000
         LA    @08,TMSGNS1                                         1284 04914000
         ST    @08,MSGPTR                                          1284 04915000
*           CALL  FXPUTL;           /* INITIALIZE PARM LIST          */ 04916000
         BAL   @14,FXPUTL                                          1285 04917000
*           CALL  DOPUTL;           /* TO ISSUE PUTLINE              */ 04918000
         BAL   @14,DOPUTL                                          1286 04919000
*           UIDQUIT = '1'B;         /* SET USERID TERMINATION FLAG   */ 04920000
*                                                                  1287 04921000
         OI    UIDQUIT,B'10000000'                                 1287 04922000
*               END;                                               1288 04923000
*           RESPECIFY (R14) RESTRICTED;                            1289 04924000
@RF01275 DS    0H                                                  1290 04925000
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */ 04926000
         L     R14,SAVLNKD                                         1290 04927000
*           RETURN;                 /* RETURN                        */ 04928000
         B     @EL00005                                            1291 04929000
*/********************************************************************/ 04930000
*/*                                                                  */ 04931000
*/* SEGMENT NAME -- NOUFND                                           */ 04932000
*/*                                                                  */ 04933000
*/* DESCRIPTIVE NAME -- N/A                                          */ 04934000
*/*                                                                  */ 04935000
*/* FUNCTION -- ISSUE USERID NOT FOUND MESSAGE                       */ 04936000
*/*   OPERATION --                                                   */ 04937000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 04938000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP NOUFND FUNCTION  */ 04939000
*/*   -  SET MESSAGE INDEX TO 5                                      */ 04940000
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */ 04941000
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT CONTAINING USERID NAME AND    */ 04942000
*/*      BUILD DYNAMIC PUTLINE SEGMENT LIST (TMSGNS1)                */ 04943000
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */ 04944000
*/*   -  PERFORM SEGMENT FXPUTL TO INITIALIZE PUTLINE PARM BLOCK     */ 04945000
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE (VIA PUTLINE)       */ 04946000
*/*   -  SET USERID TERMINATION FLAG (UIDQUIT)                       */ 04947000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 04948000
*/*                                                                  */ 04949000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 04950000
*/*                                                                  */ 04951000
*/* INPUT --                                                         */ 04952000
*/*   -  UADSREFM ENVIRONMENT                                        */ 04953000
*/*                                                                  */ 04954000
*/* OUTPUT --                                                        */ 04955000
*/*   -  ERROR MESSAGE 5                                             */ 04956000
*/*   -  USERID TERMINATION FLAG SET (UIDQUIT)                       */ 04957000
*/*                                                                  */ 04958000
*/* EXTERNAL REFERENCES -- N/A                                       */ 04959000
*/*                                                                  */ 04960000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 04961000
*/*   CONDITIONS -- N/A                                              */ 04962000
*/*   RETURN CODE -- N/A                                             */ 04963000
*/*                                                                  */ 04964000
*/* EXIT-ERROR -- N/A                                                */ 04965000
*/*   CONDITIONS -- N/A                                              */ 04966000
*/*   RETURN CODE -- N/A                                             */ 04967000
*/*                                                                  */ 04968000
*/********************************************************************/ 04969000
*NOUFND:    /* ISSUE USERID NOT FOUND MESSAGE                        */ 04970000
*           ENTRY;                                                 1292 04971000
*                                                                  1292 04972000
NOUFND   DS    0H                                                  1293 04973000
*           SAVLNKD = R14;          /* RESERVE LINK REGISTER         */ 04974000
         ST    R14,SAVLNKD                                         1293 04975000
*           RESPECIFY (R14) UNRESTRICTED;                          1294 04976000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 04977000
*             THEN                  /* NO,                           */ 04978000
         TM    QUITCHK,B'11100000'                                 1295 04979000
         BNZ   @RF01295                                            1295 04980000
*               DO;                                                1296 04981000
*                                                                  1296 04982000
*           MSGNO = 5;              /* SET MESSAGE INDEX             */ 04983000
         MVC   MSGNO(2),@CH00080                                   1297 04984000
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE          */ 04985000
         BAL   @14,MSGFNDR                                         1298 04986000
*           TMSGNS1(1:12) = TMLMDL1(1:12);  /* SET SEGMENT LIST      */ 04987000
         L     @08,MSGPTR                                          1299 04988000
         MVC   TMSGNS1(12),TMLMDL1(@08)                            1299 04989000
*           TMSGNP12 = ADDR(TMSGTIX1); /* SET 2ND SEGMENT PTR        */ 04990000
         LA    @08,TMSGTIX1                                        1300 04991000
         ST    @08,TMSGNP12                                        1300 04992000
*           TMSGTIL1 = NODIDL+4;    /* SET SEGMENT LENGTH            */ 04993000
         LH    @08,NODIDL                                          1301 04994000
         LA    @01,4(,@08)                                         1301 04995000
         STH   @01,TMSGTIL1                                        1301 04996000
*           TMSGTIO1 = 15;          /* SET TEXT OFFSET               */ 04997000
         MVC   TMSGTIO1(2),@CH00174                                1302 04998000
*           TMSGTIN1(1:NODIDL) = NODIDC;  /* SET INSERT TEXT         */ 04999000
         BCTR  @08,0                                               1303 05000000
         EX    @08,@SM02092                                        1303 05001000
*           MSGPTR = ADDR(TMSGNS1); /* SET PTR TO TEXT               */ 05002000
*                                                                  1304 05003000
         LA    @08,TMSGNS1                                         1304 05004000
         ST    @08,MSGPTR                                          1304 05005000
*           CALL  FXPUTL;           /* INITIALIZE PARM LIST          */ 05006000
         BAL   @14,FXPUTL                                          1305 05007000
*           CALL  DOPUTL;           /* TO ISSUE PUTLINE              */ 05008000
         BAL   @14,DOPUTL                                          1306 05009000
*           UIDQUIT = '1'B;         /* SET USERID TERMINATION FLAG   */ 05010000
*                                                                  1307 05011000
         OI    UIDQUIT,B'10000000'                                 1307 05012000
*               END;                                               1308 05013000
*           RESPECIFY (R14) RESTRICTED;                            1309 05014000
@RF01295 DS    0H                                                  1310 05015000
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */ 05016000
         L     R14,SAVLNKD                                         1310 05017000
*           RETURN;                 /* RETURN                        */ 05018000
         B     @EL00005                                            1311 05019000
*/********************************************************************/ 05020000
*/*                                                                  */ 05021000
*/* SEGMENT NAME -- CLOSDCB                                          */ 05022000
*/*                                                                  */ 05023000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05024000
*/*                                                                  */ 05025000
*/* FUNCTION -- CLOSE UADS AND DIRECTORY DCBS                        */ 05026000
*/*   OPERATION --                                                   */ 05027000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05028000
*/*   -  SET POINTER TO CLOSE PARAMETER BLOCK IN REGISTER 1          */ 05029000
*/*   -  IF DCB IS OPEN (DCBOFOPN), EXECUTE CLOSE MACRO              */ 05030000
*/*   -  IF DCB IS STILL OPEN AT END OF CLOSE MACRO EXECUTION, ISSUE */ 05031000
*/*      ERROR MESSAGE (INDEX SET IN CALLER) AND SET RFMQUIT         */ 05032000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05033000
*/*                                                                  */ 05034000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 05035000
*/*                                                                  */ 05036000
*/* INPUT --                                                         */ 05037000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05038000
*/*                                                                  */ 05039000
*/* OUTPUT --                                                        */ 05040000
*/*   -  DCB CLOSED                                                  */ 05041000
*/*                                                                  */ 05042000
*/* EXTERNAL REFERENCES -- CLOSE MACRO                               */ 05043000
*/*                                                                  */ 05044000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05045000
*/*   CONDITIONS --                                                  */ 05046000
*/*   -  SUCCESSFUL CLOSE                                            */ 05047000
*/*   RETURN CODE -- N/A                                             */ 05048000
*/*                                                                  */ 05049000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 05050000
*/*   CONDITIONS --                                                  */ 05051000
*/*   -  UNSUCCESSFUL CLOSE (RFMQUIT FLAG SET)                       */ 05052000
*/*   RETURN CODE -- N/A                                             */ 05053000
*/*                                                                  */ 05054000
*/********************************************************************/ 05055000
*CLOSDCB:   /* CLOSE UADS AND DIRECTORY DCBS ROUTINE EP              */ 05056000
*                                                                  1312 05057000
*           ENTRY;                                                 1312 05058000
*                                                                  1312 05059000
CLOSDCB  DS    0H                                                  1313 05060000
*           SAVLNKD  =  R14;        /* RESERVE LINK REGISTER         */ 05061000
         ST    R14,SAVLNKD                                         1313 05062000
*           RESPECIFY (R14) UNRESTRICTED;                          1314 05063000
*                                                                  1314 05064000
*           /* ESTABLISH ADDRESSABILITY FOR DCB                      */ 05065000
*           GENERATE (USING IHADCB,PPPPTR);                        1315 05066000
         USING IHADCB,PPPPTR                                            05067000
*           RESPECIFY (PPPPTR,R1) RESTRICTED;  /* RESERVE POINTERS   */ 05068000
*                                                                  1316 05069000
*           R1  =  ADDR(RLCLSL);    /* SET PTR TO CLOSE  C P  PL     */ 05070000
*                                                                  1317 05071000
         LA    R1,RLCLSL                                           1317 05072000
*           /* CHK IF OPEN NOW AND IF SO, CLOSE                      */ 05073000
*           IF PPPPTR->DCBOFOPN = '1'B /* CHK FOR OPEN FLAG IN DCB   */ 05074000
*             THEN                  /* YES, CLOSE                    */ 05075000
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1318 05076000
         BNO   @RF01318                                            1318 05077000
*               DO;                                                1319 05078000
*                 /* ISSUE CLOSE                                     */ 05079000
*                 GENERATE (CLOSE ((PPPPTR),),MF=(E,(1)));         1320 05080000
         CLOSE ((PPPPTR),),MF=(E,(1))                                   05081000
*                 IF PPPPTR->DCBOFOPN = '1'B /* CHK IF STILL OPEN    */ 05082000
*                   THEN            /* YES, ERROR                    */ 05083000
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1321 05084000
         BNO   @RF01321                                            1321 05085000
*                    DO;                                           1322 05086000
*                      CALL MSGFNDR;  /* LOCATE MESSAGE TEXT         */ 05087000
         BAL   @14,MSGFNDR                                         1323 05088000
*                      CALL  FXPUTL;  /* INITIALIZE  P B             */ 05089000
         BAL   @14,FXPUTL                                          1324 05090000
*                      CALL  DOPUTL;  /* TO ISSUE PUTLINE            */ 05091000
         BAL   @14,DOPUTL                                          1325 05092000
*                      RFMQUIT = '1'B; /* SET TERMINATION FLAG       */ 05093000
         OI    RFMQUIT,B'01000000'                                 1326 05094000
*                    END;                                          1327 05095000
*               END;                                               1328 05096000
*             ELSE     ;            /* NO, NOT OPEN                  */ 05097000
*                                                                  1329 05098000
@RF01318 DS    0H                                                  1330 05099000
*           RESPECIFY (R14) RESTRICTED;                            1330 05100000
@RC01318 DS    0H                                                  1331 05101000
*           R14  =  SAVLNKD;        /* RESTORE LINK REGISTER         */ 05102000
*                                                                  1331 05103000
         L     R14,SAVLNKD                                         1331 05104000
*           /* RELEASE DCB ADDRESSABILITY                            */ 05105000
*           GENERATE(DROP  PPPPTR);                                1332 05106000
         DROP  PPPPTR                                                   05107000
*           RESPECIFY  (PPPPTR,R1) UNRESTRICTED;  /* FREE POINTERS   */ 05108000
*           END  GETDBSP;           /* RETURN                        */ 05109000
         B     @EL00005                                            1334 05110000
*/********************************************************************/ 05111000
*/*                                                                  */ 05112000
*/* SEGMENT NAME -- DOGETSP                                          */ 05113000
*/*                                                                  */ 05114000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05115000
*/*                                                                  */ 05116000
*/* FUNCTION -- GET SPACE FOR REQUESTED BLOCK FROM FREESPACE QUEUE   */ 05117000
*/*   OPERATION --                                                   */ 05118000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05119000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP DOGETSP FUNCTION */ 05120000
*/*   -  SET NUMBER OF BLOCKS IN GETSPACE PARAMETER BLOCK (SPZBLKN)  */ 05121000
*/*      EQUAL TO TOTAL AVAILABLE BLOCKS (NUMBLKS).                  */ 05122000
*/*   -  SET POINTER TO OUTPUT BUFFER (REXBUF) IN GETSPACE PARAMETER */ 05123000
*/*      BLOCK (SPZBUFP)                                             */ 05124000
*/*   -  PERFORM IKJEFA53 (ACCOUNT-GETSPACE)                         */ 05125000
*/*   -  IF GETSPACE RETURN CODE IS 8 (MEANING NO AVAILABLE SPACE    */ 05126000
*/*      FOUND) PERFORM SEGMENT GSPZERR TO ISSUE NO SPACE MESSAGE    */ 05127000
*/*   -  FOR ANY OTHER RETURN CODE, PERFORM SEGMENT GSPZER2 TO ISSUE */ 05128000
*/*      ERROR MESSAGE                                               */ 05129000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05130000
*/*                                                                  */ 05131000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 05132000
*/*                                                                  */ 05133000
*/* INPUT --                                                         */ 05134000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05135000
*/*   -  NUMBER OF BLOCKS IN CURRENT USERID IN (RWPNOM)              */ 05136000
*/*                                                                  */ 05137000
*/* OUTPUT --                                                        */ 05138000
*/*   -  OFFSET TO ACQUIRED AREA IN PARAMETER BLOCK (SPZBLOC)        */ 05139000
*/*                                                                  */ 05140000
*/* EXTERNAL REFERENCES -- ACCOUNT-GETSPACE ROUTINE -- IKJEFA53      */ 05141000
*/*                                                                  */ 05142000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05143000
*/*   CONDITIONS --                                                  */ 05144000
*/*   -  SUCCESSFUL GETSPACE                                         */ 05145000
*/*   RETURN CODE -- N/A                                             */ 05146000
*/*                                                                  */ 05147000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 05148000
*/*   CONDITIONS --                                                  */ 05149000
*/*   -  UNSUCCESSFUL GETSPACE                                       */ 05150000
*/*   RETURN CODE -- N/A                                             */ 05151000
*/*                                                                  */ 05152000
*/********************************************************************/ 05153000
*DOGETSP:   /* GET SPACE FOR REQUESTED BLOCK FROM FREESPACE QUEUE    */ 05154000
*                                                                  1335 05155000
*           PROCEDURE                                              1335 05156000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 05157000
DOGETSP  DS    0H                                                  1336 05158000
*                                   /* NO SAVE AREA CREATED          */ 05159000
*           RESPECIFY (R14) RESTRICTED;                            1336 05160000
*           SAVLNKE = R14;          /* SAVE LINK REGISTER            */ 05161000
         ST    R14,SAVLNKE                                         1337 05162000
*           RESPECIFY (R14) UNRESTRICTED;                          1338 05163000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 05164000
*             THEN                  /* NO,                           */ 05165000
         TM    QUITCHK,B'11100000'                                 1339 05166000
         BNZ   @RF01339                                            1339 05167000
*               DO;                                                1340 05168000
*                                                                  1340 05169000
*           SPZBLKN = NUMBLKS;      /* RESTORE TOTAL BLOCK NUMBER    */ 05170000
         MVC   SPZBLKN(2),NUMBLKS                                  1341 05171000
*           SPZBUFP = ADDR(REXBUF); /* PTR TO MEMBER BUFFER          */ 05172000
         MVC   SPZBUFP(4),REXBUFP                                  1342 05173000
*           RESPECIFY (R1,R15) RESTRICTED;                         1343 05174000
*           R1 = ADDR(SPAZPB);      /* PTR TO GETSPACE  P B          */ 05175000
         LA    R1,SPAZPB                                           1344 05176000
*           CALL  IKJEFA53;         /* GO TO GETSPACE                */ 05177000
         L     @15,@CV00039                                        1345 05178000
         BALR  @14,@15                                             1345 05179000
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */ 05180000
         ST    R15,RTNCODE                                         1346 05181000
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1347 05182000
*           IF RTNCODE ^< 8         /* CHK FOR SUCCESS CODE          */ 05183000
*             THEN                  /* NO,                           */ 05184000
         L     @08,RTNCODE                                         1348 05185000
         LA    @15,8                                               1348 05186000
         CR    @08,@15                                             1348 05187000
         BL    @RF01348                                            1348 05188000
*               DO;                                                1349 05189000
*                 IF RTNCODE = 8    /* NO-SPACE CODE ?               */ 05190000
*                   THEN            /* YES,                          */ 05191000
         CR    @08,@15                                             1350 05192000
         BNE   @RF01350                                            1350 05193000
*                     CALL  GSPZERR;  /* NO SPACE MSG                */ 05194000
         BAL   @14,GSPZERR                                         1351 05195000
*                   ELSE            /* NO LEGITIMATE RETURN CODE     */ 05196000
*                     CALL  GSPZER2;  /* CODE ERROR MSG              */ 05197000
         B     @RC01350                                            1352 05198000
@RF01350 BAL   @14,GSPZER2                                         1352 05199000
*               END;                                               1353 05200000
*                                                                  1353 05201000
@RC01350 DS    0H                                                  1354 05202000
*               END;                                               1354 05203000
@RF01348 DS    0H                                                  1355 05204000
*           RESPECIFY (R14) RESTRICTED;                            1355 05205000
@RF01339 DS    0H                                                  1356 05206000
*           R14 = SAVLNKE;          /* RESTORE LINK REGISTER         */ 05207000
         L     R14,SAVLNKE                                         1356 05208000
*           END  DOGETSP;           /* RETURN                        */ 05209000
@EL00006 DS    0H                                                  1357 05210000
@EF00006 DS    0H                                                  1357 05211000
@ER00006 BR    @14                                                 1357 05212000
*/********************************************************************/ 05213000
*/*                                                                  */ 05214000
*/* SEGMENT NAME -- GSPZERR                                          */ 05215000
*/*                                                                  */ 05216000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05217000
*/*                                                                  */ 05218000
*/* FUNCTION -- ISSUE NO BLOCK SPACE AVAILABLE MESSAGE               */ 05219000
*/*   OPERATION --                                                   */ 05220000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 05221000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP GSPZERR FUNCTION */ 05222000
*/*   -  SET MESSAGE INDEX 18                                        */ 05223000
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */ 05224000
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT CONTAINING USERID NAME AND    */ 05225000
*/*      BUILD DYNAMIC SEGMENT LIST (TMSGNS1)                        */ 05226000
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */ 05227000
*/*   -  PERFORM SEGMENT FXPUTL TO INITIALIZE PUTLINE PARM BLOCK     */ 05228000
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE                     */ 05229000
*/*   -  SET USERID TERMINATION FLAG (UIDQUIT)                       */ 05230000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 05231000
*/*                                                                  */ 05232000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 05233000
*/*                                                                  */ 05234000
*/* INPUT --                                                         */ 05235000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05236000
*/*                                                                  */ 05237000
*/* OUTPUT --                                                        */ 05238000
*/*   -  ERROR MESSAGE 18 (THROUGH DOPUTL)                           */ 05239000
*/*   -  USERID TERMINATION FLAG SET (UIDQUIT)                       */ 05240000
*/*                                                                  */ 05241000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05242000
*/*                                                                  */ 05243000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 05244000
*/*   CONDITIONS --                                                  */ 05245000
*/*   -  MESSAGE 18 ISSUED                                           */ 05246000
*/*   RETURN CODE -- N/A                                             */ 05247000
*/*                                                                  */ 05248000
*/* EXIT-ERROR -- N/A                                                */ 05249000
*/*   CONDITIONS -- N/A                                              */ 05250000
*/*   RETURN CODE -- N/A                                             */ 05251000
*/*                                                                  */ 05252000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 05253000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 05254000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 05255000
*/*                                                                  */ 05256000
*/********************************************************************/ 05257000
*GSPZERR:   /* ISSUE NO BLOCK SPACE ERROR MESSAGE                    */ 05258000
*           PROCEDURE                                              1358 05259000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 05260000
GSPZERR  DS    0H                                                  1359 05261000
*                                   /* NO SAVE AREA CREATED          */ 05262000
*           RESPECIFY (R14) RESTRICTED;                            1359 05263000
*           SAVLNKF = R14;          /* SAVE LINK REGISTER            */ 05264000
         ST    R14,SAVLNKF                                         1360 05265000
*           RESPECIFY (R14) UNRESTRICTED;                          1361 05266000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 05267000
*             THEN                  /* NO,                           */ 05268000
         TM    QUITCHK,B'11100000'                                 1362 05269000
         BNZ   @RF01362                                            1362 05270000
*               DO;                                                1363 05271000
*                                                                  1363 05272000
*           MSGNO = 18;             /* SET MESSAGE INDEX             */ 05273000
         MVC   MSGNO(2),@CH00181                                   1364 05274000
*           CALL MSGFNDR;           /* LOCATE TEXT                   */ 05275000
         BAL   @14,MSGFNDR                                         1365 05276000
*           TMSGNS1(1:20)=TMLMDL1;  /* SET SEGMENT LIST              */ 05277000
         L     @08,MSGPTR                                          1366 05278000
         MVC   TMSGNS1(20),TMLMDL1(@08)                            1366 05279000
*           TMSGNP13 = ADDR(TMSGTIX1);  /* SET TO SECOND SEGMENT     */ 05280000
         LA    @08,TMSGTIX1                                        1367 05281000
         ST    @08,TMSGNP13                                        1367 05282000
*           TMSGTIL1 = NODIDL+4;    /*SET LENGTH OF SEGMENT          */ 05283000
         LH    @08,NODIDL                                          1368 05284000
         LA    @01,4(,@08)                                         1368 05285000
         STH   @01,TMSGTIL1                                        1368 05286000
*           TMSGTIO1 = 9;           /* SET INSERT OFFSET             */ 05287000
         MVC   TMSGTIO1(2),@CH00033                                1369 05288000
*           TMSGTIN1(1:NODIDL)=NODIDC(1:NODIDL);  /* INSERT USERID   */ 05289000
         BCTR  @08,0                                               1370 05290000
         EX    @08,@SM02092                                        1370 05291000
*           MSGPTR = ADDR(TMSGNS1); /* SET TO INITIAL SEGMENT        */ 05292000
         LA    @08,TMSGNS1                                         1371 05293000
         ST    @08,MSGPTR                                          1371 05294000
*           CALL FXPUTL;            /* TO INITIALIZE PARM BLOCK      */ 05295000
         BAL   @14,FXPUTL                                          1372 05296000
*           CALL DOPUTL;            /* TO ISSUE PUTLINE              */ 05297000
         BAL   @14,DOPUTL                                          1373 05298000
*           UIDQUIT = '1'B;         /* SET USERID TERMINATION FLAG   */ 05299000
*                                                                  1374 05300000
         OI    UIDQUIT,B'10000000'                                 1374 05301000
*               END;                                               1375 05302000
*           RESPECIFY (R14) RESTRICTED;                            1376 05303000
@RF01362 DS    0H                                                  1377 05304000
*           R14 = SAVLNKF;          /* RESTORE LINK REGISTER         */ 05305000
         L     R14,SAVLNKF                                         1377 05306000
*           RETURN;                 /* RETURN                        */ 05307000
@EL00007 DS    0H                                                  1378 05308000
@EF00007 DS    0H                                                  1378 05309000
@ER00007 BR    @14                                                 1378 05310000
*/********************************************************************/ 05311000
*/*                                                                  */ 05312000
*/* SEGMENT NAME -- GSPZER2                                          */ 05313000
*/*                                                                  */ 05314000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05315000
*/*                                                                  */ 05316000
*/* FUNCTION -- ISSUE GETSPACE RETURN CODE ERROR MESSAGE             */ 05317000
*/*   OPERATION --                                                   */ 05318000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 05319000
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP GSPZER2 FUNCTION */ 05320000
*/*   -  SET MESSAGE INDEX 19                                        */ 05321000
*/*   -  SET INSERTION OFFSET (SOFFS) TO 20                          */ 05322000
*/*   -  PERFORM SEGMENT SYSERRD TO ISSUE MESSAGE                    */ 05323000
*/*   -  SET UADSREFM TERMINATION FLAG (RFMQUIT)                     */ 05324000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN                  */ 05325000
*/*                                                                  */ 05326000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 05327000
*/*                                                                  */ 05328000
*/* INPUT --                                                         */ 05329000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05330000
*/*                                                                  */ 05331000
*/* OUTPUT --                                                        */ 05332000
*/*   -  ERROR MESSAGE 19 (VIA SYSERRD)                              */ 05333000
*/*   -  UADSREFM TERMINATION FLAG SET (RFMQUIT)                     */ 05334000
*/*                                                                  */ 05335000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05336000
*/*                                                                  */ 05337000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 05338000
*/*   CONDITIONS -- N/A                                              */ 05339000
*/*   RETURN CODE -- N/A                                             */ 05340000
*/*                                                                  */ 05341000
*/* EXIT-ERROR -- N/A                                                */ 05342000
*/*   CONDITIONS -- N/A                                              */ 05343000
*/*   RETURN CODE -- N/A                                             */ 05344000
*/*                                                                  */ 05345000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 05346000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 05347000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 05348000
*/*                                                                  */ 05349000
*/********************************************************************/ 05350000
*GSPZER2:   /* ISSUE GETSPACE RETURN CODE ERROR MESSAGE              */ 05351000
*                                                                  1379 05352000
*           ENTRY;                                                 1379 05353000
GSPZER2  DS    0H                                                  1380 05354000
*           SAVLNKF = R14;          /* SAVE LINK REGISTER            */ 05355000
         ST    R14,SAVLNKF                                         1380 05356000
*           RESPECIFY (R14) UNRESTRICTED;                          1381 05357000
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */ 05358000
*             THEN                  /* NO,                           */ 05359000
         TM    QUITCHK,B'11100000'                                 1382 05360000
         BNZ   @RF01382                                            1382 05361000
*               DO;                                                1383 05362000
*                                                                  1383 05363000
*           MSGNO = 19;             /* MESSAGE INDEX                 */ 05364000
         MVC   MSGNO(2),@CH02026                                   1384 05365000
*           SOFFS = 20;             /* TEXT OFFSET                   */ 05366000
         MVC   SOFFS(2),@CH00351                                   1385 05367000
*           CALL  SYSERRD;          /* TO ISSUE MESSAGE              */ 05368000
         BAL   @14,SYSERRD                                         1386 05369000
*           RFMQUIT = '1'B;         /* TERMINATION FLAG              */ 05370000
*                                                                  1387 05371000
         OI    RFMQUIT,B'01000000'                                 1387 05372000
*               END;                                               1388 05373000
*           RESPECIFY (R14) RESTRICTED;                            1389 05374000
@RF01382 DS    0H                                                  1390 05375000
*           R14 = SAVLNKF;          /* RESTORE LINK REGISTER         */ 05376000
         L     R14,SAVLNKF                                         1390 05377000
*           END  GSPZERR;           /* RETURN                        */ 05378000
         B     @EL00007                                            1391 05379000
*/********************************************************************/ 05380000
*/*                                                                  */ 05381000
*/* SEGMENT NAME -- DOPSPAZ                                          */ 05382000
*/*                                                                  */ 05383000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05384000
*/*                                                                  */ 05385000
*/* FUNCTION -- PERFORM LARGE SCALE CHARACTER OPERATION              */ 05386000
*/*   OPERATION --                                                   */ 05387000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05388000
*/*   -  REDUCE LENGTH COUNT BY 1 (COMPENSATE FOR CHARACTER OPERA-   */ 05389000
*/*      TION COUNT CONTROL)                                         */ 05390000
*/*   -  FORM CURRENT CHARACTER COUNT IN (RSPW)                      */ 05391000
*/*   -  EXECUTE CHARACTER OPERATION FOR COUNT OF (RSPW)             */ 05392000
*/*   -  STEP SOURCE LOCATION (RFROM)                                */ 05393000
*/*   -  STEP TARGET LOCATION (RTO)                                  */ 05394000
*/*   -  DECREMENT TOTAL COUNT (RLNG) BY CURRENTLY USED COUNT (RSPW) */ 05395000
*/*   -  IF ANY COUNT REMAINS IN (RLNG) REPEAT WHOLE FUNCTION        */ 05396000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05397000
*/*                                                                  */ 05398000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 05399000
*/*                                                                  */ 05400000
*/* INPUT --                                                         */ 05401000
*/*   -  NUMBER OF CHARACTERS FOR OPERATION IN (RSPW)                */ 05402000
*/*   -  POINTER TO CHARACTER OPERATION TO EXECUTED IN (RSPZOP)      */ 05403000
*/*   -  POINTER TO START OF SOURCE AREA IN (RFROM)                  */ 05404000
*/*   -  POINTER TO START OF TARGET AREA IN (RTO)                    */ 05405000
*/*                                                                  */ 05406000
*/* OUTPUT --                                                        */ 05407000
*/*   -  TARGET CHARACTER AREA MODIFIED                              */ 05408000
*/*                                                                  */ 05409000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05410000
*/*                                                                  */ 05411000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05412000
*/*   CONDITIONS -- N/A                                              */ 05413000
*/*   RETURN CODE -- N/A                                             */ 05414000
*/*                                                                  */ 05415000
*/* EXIT-ERROR -- N/A                                                */ 05416000
*/*   CONDITIONS -- N/A                                              */ 05417000
*/*   RETURN CODE -- N/A                                             */ 05418000
*/*                                                                  */ 05419000
*/********************************************************************/ 05420000
*DOPSPAZ:   /* PERFORM LARGE SCALE CHARACTER OPERATION               */ 05421000
*           PROCEDURE                                              1392 05422000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 05423000
DOPSPAZ  DS    0H                                                  1393 05424000
*                                   /* NO SAVE AREA CREATED          */ 05425000
*           RESPECIFY (R14) RESTRICTED;                            1393 05426000
*           SAVLNKG = R14;          /* SAVE LINK REGISTER            */ 05427000
         ST    R14,SAVLNKG                                         1394 05428000
*           RESPECIFY (R14) UNRESTRICTED;                          1395 05429000
*                                                                  1395 05430000
*           RESPECIFY  (RSPW,RSPZOP,RLNG,RFROM,RTO) RESTRICTED;    1396 05431000
*           GENERATE;                                              1397 05432000
OPSPAZ    EQU    *                                                      05433000
          BCTR   RLNG,0             COMPENSATE COUNT FOR CHAR OPN       05434000
          LA     RSPW,255           SET MAXIMUM CHAR COUNT              05435000
          NR     RSPW,RLNG          EXTRACT CURRENT CHAR COUNT          05436000
          EX     RSPW,0(RSPZOP)     EXEC CHAR OPERATION                 05437000
          LA     RFROM,1(RSPW,RFROM)  INCREMENT FROM LOCATION           05438000
          LA     RTO,1(RSPW,RTO)    INCREMENT TO LOCATION               05439000
          SR     RLNG,RSPW          DECREMENT TOTAL COUNT BY CURRENT    05440000
          BNZ    OPSPAZ             CONTINUE '1'B REMAINING COUNT       05441000
*           RESPECIFY  (RSPW,RSPZOP,RLNG,RFROM,RTO) UNRESTRICTED;  1398 05442000
*                                                                  1398 05443000
*           RESPECIFY (R14) RESTRICTED;                            1399 05444000
*           R14 = SAVLNKG;          /* RESTORE LINK REGISTER         */ 05445000
         L     R14,SAVLNKG                                         1400 05446000
*           RETURN;                 /* RETURN                        */ 05447000
@EL00008 DS    0H                                                  1401 05448000
@EF00008 DS    0H                                                  1401 05449000
@ER00008 BR    @14                                                 1401 05450000
*/********************************************************************/ 05451000
*/*                                                                  */ 05452000
*/* SEGMENT NAME -- SYSERRD                                          */ 05453000
*/*                                                                  */ 05454000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05455000
*/*                                                                  */ 05456000
*/* FUNCTION -- BUILD AND ISSUE SYSTEM-ERROR-TYPE MESSAGE            */ 05457000
*/*   OPERATION --                                                   */ 05458000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05459000
*/*   -  IF ENTRY MADE AT SYSERRD, CONVERT BINARY VALUE (RTNCODE) TO */ 05460000
*/*      DECIMAL BASE VALUE BACK INTO (RTNCODE)                      */ 05461000
*/*   -  (ENTRY SYSERRX, OR CONTINUATION)                            */ 05462000
*/*      SAVE ENTRY LINK REGISTER 14                                 */ 05463000
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE TEXT                      */ 05464000
*/*   -  UNPACK DECIMAL BASE VALUE (RTNCODE) AND TRANSLATE RESULT TO */ 05465000
*/*      EBCDIC INTO DYNAMIC MESSAGE SEGMENT (TMSGTIN1)              */ 05466000
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT LIST (TMSGNS1)                */ 05467000
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */ 05468000
*/*   -  PERFORM SEGMENT FXPUTLM TO INITIALIZE PUTLINE PARM BLOCK    */ 05469000
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE                     */ 05470000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05471000
*/*                                                                  */ 05472000
*/* ENTRY -- SYSERRD, TO ACCEPT BINARY VALUE                         */ 05473000
*/*   -  LINKED BY REGISTER 14                                       */ 05474000
*/* ENTRY -- SYSERRX, TO ACCEPT DECIMAL VALUE                        */ 05475000
*/*   -  LINKED BY REGISTER 14                                       */ 05476000
*/*                                                                  */ 05477000
*/* INPUT --                                                         */ 05478000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05479000
*/*   -  TRANSLATABLE VALUE IN RTNCODE                               */ 05480000
*/*   -  MESSAGE INDEX IN MSGNO                                      */ 05481000
*/*   -  TEXT INSERTION OFFSET IN SOFFS                              */ 05482000
*/*                                                                  */ 05483000
*/* OUTPUT --                                                        */ 05484000
*/*   -  MESSAGE ISSUED                                              */ 05485000
*/*                                                                  */ 05486000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05487000
*/*                                                                  */ 05488000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05489000
*/*   CONDITIONS -- N/A                                              */ 05490000
*/*   RETURN CODE -- N/A                                             */ 05491000
*/*                                                                  */ 05492000
*/* EXIT-ERROR -- N/A                                                */ 05493000
*/*   CONDITIONS -- N/A                                              */ 05494000
*/*   RETURN CODE -- N/A                                             */ 05495000
*/*                                                                  */ 05496000
*/********************************************************************/ 05497000
*SYSERRD:   /* SYSTEM ERROR MESSAGE ROUTINE EP                       */ 05498000
*           ENTRY;                                                 1402 05499000
*                                                                  1402 05500000
SYSERRD  DS    0H                                                  1403 05501000
*           SAVLNKG = R14;          /* RESERVE LINK REGISTER         */ 05502000
         ST    R14,SAVLNKG                                         1403 05503000
*           /* FORM DECIMAL BASE IN RTNCODE                          */ 05504000
*           GENERATE;                                              1404 05505000
*                                                                  1404 05506000
         L     R3,RTNCODE             CODE INTO CONVERSION REGISTER     05507000
         CVD   R3,DBLWORD             CONVERT TO DECIMAL BASE FIGURES   05508000
         L     R3,DBLWD2              CONVERSION INTO REGISTER          05509000
         ST    R3,RTNCODE             CONVERSION INTO UNPACK AREA       05510000
*SYSERRX:   /* EP TO FORM HEXIDECIMAL PRINT IMAGE FOR MESSAGE        */ 05511000
*           ENTRY;                                                 1405 05512000
         B     @EC01405                                            1405 05513000
SYSERRX  DS    0H                                                  1405 05514000
@EC01405 DS    0H                                                  1406 05515000
*           SAVLNKG = R14;          /* RESERVE LINK REGISTER         */ 05516000
         ST    R14,SAVLNKG                                         1406 05517000
*           RESPECIFY (R14) UNRESTRICTED;                          1407 05518000
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE          */ 05519000
*                                                                  1408 05520000
         BAL   @14,MSGFNDR                                         1408 05521000
*           /* UNPACK AND TRANSLATE TO EBCDIC CHARACTERS             */ 05522000
*           GENERATE;                                              1409 05523000
*                                                                  1409 05524000
         UNPK  MSGCDE-1(6),RTNCCHS(3) UNPACK BINARY CHARACTER AREA      05525000
         TR    TMSGTIN1(3),HEXTBL-240 TRANSLATE TO EBCDIC               05526000
*           TMSGNS1(1:28) = TMLMDL1(1:28);  /* SET SEGMENT LIST      */ 05527000
         L     @08,MSGPTR                                          1410 05528000
         MVC   TMSGNS1(28),TMLMDL1(@08)                            1410 05529000
*           TMSGNNO1 = ADDR(TMSGNS2);  /* SET PTR TO SECOND LEVEL    */ 05530000
         LA    @15,TMSGNS2                                         1411 05531000
         ST    @15,TMSGNNO1                                        1411 05532000
*           TMSGNS2(1:20)=TMLMDL2(1:20);  /* SET SECOND SEGMENT LIST */ 05533000
         L     @08,TMLNX1(,@08)                                    1412 05534000
         MVC   TMSGNS2(20),TMLMDL2(@08)                            1412 05535000
*           TMSGNP24 = ADDR(TMSGTIX1); /* SET MESSAGE POINTER        */ 05536000
         LA    @08,TMSGTIX1                                        1413 05537000
         ST    @08,TMSGNP24                                        1413 05538000
*           TMSGTIL1 = 6;           /* SET LENGTH OF SEGMENT         */ 05539000
         MVC   TMSGTIL1(2),@CH00118                                1414 05540000
*           TMSGTIO1 = SOFFS;       /* SET INSERT OFFSET             */ 05541000
         MVC   TMSGTIO1(2),SOFFS                                   1415 05542000
*           MSGPTR = ADDR(TMSGNS1); /* SET PTR TO TEXT               */ 05543000
*                                                                  1416 05544000
         LA    @08,TMSGNS1                                         1416 05545000
         ST    @08,MSGPTR                                          1416 05546000
*           CALL  FXPUTLM;          /* GO TO INITIALIZE PARM BLOCK   */ 05547000
         BAL   @14,FXPUTLM                                         1417 05548000
*           CALL  DOPUTL;           /* GO TO ISSUE MESSAGE           */ 05549000
*                                                                  1418 05550000
         BAL   @14,DOPUTL                                          1418 05551000
*           RESPECIFY (R14) RESTRICTED;                            1419 05552000
*           R14 = SAVLNKG;          /* RESTORE LINK REGISTER         */ 05553000
         L     R14,SAVLNKG                                         1420 05554000
*           END  DOPSPAZ;           /* RETURN                        */ 05555000
         B     @EL00008                                            1421 05556000
*/********************************************************************/ 05557000
*/*                                                                  */ 05558000
*/* SEGMENT NAME -- MSGFNDR                                          */ 05559000
*/*                                                                  */ 05560000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05561000
*/*                                                                  */ 05562000
*/* FUNCTION -- LOCATE MESSAGE TEXT IN MESSAGE CSECT (ANDXL)         */ 05563000
*/*   OPERATION --                                                   */ 05564000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05565000
*/*   -  FIND MESSAGE TEXT OFFSET (MOFFND) IN INDEX TABLE BY MULTI-  */ 05566000
*/*      PLYING THE INDEX NUMBER (MSGNO) BY 2 AND ADDING THE LOCA-   */ 05567000
*/*      TION OF THE START OF INDEX TABLE -2  (ANDXL-2)              */ 05568000
*/*   -  FORM POINTER TO MESSAGE TEXT (MSGPTR) BY ADDING EXTRACTED   */ 05569000
*/*      INDEX OFFSET (MOFFNO) AND LOCATION OF TEXT CSECT (ANDXL)    */ 05570000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05571000
*/*                                                                  */ 05572000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 05573000
*/*                                                                  */ 05574000
*/* INPUT --                                                         */ 05575000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05576000
*/*   -  MESSAGE INDEX NUMBER IN MSGNO                               */ 05577000
*/*                                                                  */ 05578000
*/* OUTPUT --                                                        */ 05579000
*/*   -  POINTER TO MESSAGE TEXT IN MSGPTR                           */ 05580000
*/*                                                                  */ 05581000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05582000
*/*                                                                  */ 05583000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05584000
*/*   CONDITIONS -- N/A                                              */ 05585000
*/*   RETURN CODE -- N/A                                             */ 05586000
*/*                                                                  */ 05587000
*/* EXIT-ERROR -- N/A                                                */ 05588000
*/*   CONDITIONS -- N/A                                              */ 05589000
*/*   RETURN CODE -- N/A                                             */ 05590000
*/*                                                                  */ 05591000
*/********************************************************************/ 05592000
*MSGFNDR:   /* LOCATE MESSAGE TEXT ROUTINE EP                        */ 05593000
*           PROCEDURE                                              1422 05594000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 05595000
MSGFNDR  DS    0H                                                  1423 05596000
*                                   /* NO SAVE AREA CREATED          */ 05597000
*                                                                  1423 05598000
*           RESPECIFY (R14) RESTRICTED;                            1423 05599000
*           SAVLNKM = R14;          /* RESERVE LINK REGISTER         */ 05600000
         ST    R14,SAVLNKM                                         1424 05601000
*           RESPECIFY (R14) UNRESTRICTED;                          1425 05602000
*                                                                  1425 05603000
*           MOFFNO = (MSGNO*2)+ADDR(ANDXL)-2;  /* FORM PTR TO OFFSET */ 05604000
         LH    @08,MSGNO                                           1426 05605000
         ALR   @08,@08                                             1426 05606000
         L     @15,@CV00040                                        1426 05607000
         ALR   @08,@15                                             1426 05608000
         BCTR  @08,0                                               1426 05609000
         BCTR  @08,0                                               1426 05610000
         ST    @08,MOFFNO                                          1426 05611000
*           MSGPTR = MOFFNC + ADDR(ANDXL);  /* FORM PTR TO TEXT      */ 05612000
*                                                                  1427 05613000
         L     @15,@CV00040                                        1427 05614000
         AH    @15,MOFFNC(,@08)                                    1427 05615000
         ST    @15,MSGPTR                                          1427 05616000
*           RESPECIFY (R14) RESTRICTED;                            1428 05617000
*           R14 = SAVLNKM;          /* RESTORE LINK REGISTER         */ 05618000
         L     @08,SAVLNKM                                         1429 05619000
         LR    R14,@08                                             1429 05620000
*           RETURN;                 /* RETURN TO CALLER              */ 05621000
@EL00009 DS    0H                                                  1430 05622000
@EF00009 DS    0H                                                  1430 05623000
@ER00009 BR    @14                                                 1430 05624000
*/********************************************************************/ 05625000
*/*                                                                  */ 05626000
*/* SEGMENT NAME -- FXPUTL                                           */ 05627000
*/*                                                                  */ 05628000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05629000
*/*                                                                  */ 05630000
*/* FUNCTION -- INITIALIZE PUTLINE PARAMETER BLOCK (PTPBK)           */ 05631000
*/*   OPERATION --                                                   */ 05632000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05633000
*/*   -  SET SINGLE LEVEL MESSAGE FLAG (SNGLVL)                      */ 05634000
*/*   -  MOVE MODEL SINGLE LEVEL MESSAGE PARAMETER BLOCK (MPTPBK)    */ 05635000
*/*      INTO DYNAMIC BLOCK (PTPBK)                                  */ 05636000
*/*   -  (ENTRY FXPUTLM OR CONTINUE)  IF SNGLVL FLAG IS ON, SET      */ 05637000
*/*      MESSAGE TEXT POINTER (MSGPTR) IN PARAMETER BLOCK (PTPBOPUT) */ 05638000
*/*      AND RESET SNGLVL LEVEL MESSAGE FLAG (SNGLVL)                */ 05639000
*/*      IF SNGLVL FLAG IS OFF (MULTI-LEVEL MESSAGE) SAVE ENTRY LINK */ 05640000
*/*      REGISTER 14, MOVE MODEL MULTI-LEVEL PARAMETER BLOCK INTO    */ 05641000
*/*      DYNAMIC BLOCK (PTPBK), SET MESSAGE TEXT POINTER (MSGPTR) IN */ 05642000
*/*      PARAMETER LBOCK (PTPBOPUT) AND RESET SINGLE LEVEL MESSAGE   */ 05643000
*/*      FLAG (SNGLVL)                                               */ 05644000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05645000
*/*                                                                  */ 05646000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 05647000
*/*                                                                  */ 05648000
*/* INPUT --                                                         */ 05649000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05650000
*/*   -  POINTER TO MESSAGE TEXT IN MSGPTR                           */ 05651000
*/*                                                                  */ 05652000
*/* OUTPUT --                                                        */ 05653000
*/*   -  PUTLINE PARAMETER BLOCK SET (PTPBK)                         */ 05654000
*/*                                                                  */ 05655000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05656000
*/*                                                                  */ 05657000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05658000
*/*   CONDITIONS -- N/A                                              */ 05659000
*/*   RETURN CODE -- N/A                                             */ 05660000
*/*                                                                  */ 05661000
*/* EXIT-ERROR -- N/A                                                */ 05662000
*/*   CONDITIONS -- N/A                                              */ 05663000
*/*   RETURN CODE -- N/A                                             */ 05664000
*/*                                                                  */ 05665000
*/********************************************************************/ 05666000
*FXPUTL:    /* INITIALIZE PUTLINE  P P  PARAMETER BLOCK              */ 05667000
*           ENTRY;                                                 1431 05668000
*                                                                  1431 05669000
FXPUTL   DS    0H                                                  1432 05670000
*           SAVLNKM = R14;          /* RESERVE LINK REGISTER         */ 05671000
         ST    R14,SAVLNKM                                         1432 05672000
*           SNGLVL = '1'B;          /* SET SINGLE LEVEL MSG FLAG     */ 05673000
         OI    SNGLVL,B'00000100'                                  1433 05674000
*           PTPBK = MPTPBK;         /* INITIALIZE PUTLINE PB         */ 05675000
*                                                                  1434 05676000
         MVC   PTPBK(12),MPTPBK                                    1434 05677000
*FXPUTLM:   /* INITIALIZE PARAMETER BLOCK FOR PUTLINE  (MULTILEVEL)  */ 05678000
*           ENTRY;                                                 1435 05679000
*                                                                  1435 05680000
         B     @EC01435                                            1435 05681000
FXPUTLM  DS    0H                                                  1435 05682000
@EC01435 DS    0H                                                  1436 05683000
*           IF SNGLVL ^= '1'B       /* CHK FOR SINGLE LEVEL ENTRY    */ 05684000
*             THEN                  /* NO,                           */ 05685000
         TM    SNGLVL,B'00000100'                                  1436 05686000
         BO    @RF01436                                            1436 05687000
*               DO;                                                1437 05688000
*                 SAVLNKM = R14;    /* RESERVE LINK REGISTER         */ 05689000
         ST    R14,SAVLNKM                                         1438 05690000
*                 RESPECIFY (R14) UNRESTRICTED;                    1439 05691000
*                 PTPBK = MPTPBKM;  /* INITIALIZE PUTLINE PB         */ 05692000
         MVC   PTPBK(12),MPTPBKM                                   1440 05693000
*               END;                                               1441 05694000
*                                                                  1441 05695000
*           PTPBOPUT = MSGPTR;      /* SET PTR TO OUTPUT LINE        */ 05696000
@RF01436 L     @08,PTPBPTR                                         1442 05697000
         MVC   PTPBOPUT(4,@08),MSGPTR                              1442 05698000
*           SNGLVL = '0'B;          /* RESET MESSAGE MODE FLAG       */ 05699000
*                                                                  1443 05700000
         NI    SNGLVL,B'11111011'                                  1443 05701000
*           RESPECIFY (R14) RESTRICTED;                            1444 05702000
*           R14 = SAVLNKM;          /* RESTORE LINK REGISTER         */ 05703000
         L     R14,SAVLNKM                                         1445 05704000
*           RETURN;                 /* RETURN TO CALLER              */ 05705000
         B     @EL00009                                            1446 05706000
*/********************************************************************/ 05707000
*/*                                                                  */ 05708000
*/* SEGMENT NAME -- DOPUTL                                           */ 05709000
*/*                                                                  */ 05710000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05711000
*/*                                                                  */ 05712000
*/* FUNCTION -- CALL PUTLINE SERVICE ROUTINE TO ISSUE MESSAGE        */ 05713000
*/*   OPERATION --                                                   */ 05714000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05715000
*/*   -  INITIALIZE PUTLINE PARAMETER LIST (IOPL) AND SET POINTER TO */ 05716000
*/*      PARAMETER BLOCK (PTPB) IN LIST (IOPLIOPB)                   */ 05717000
*/*   -  INITIALIZE CONTROL PROGRAM PARAMETER LIST (PTLCPL) FROM     */ 05718000
*/*      MODEL (MPTLCPL)                                             */ 05719000
*/*   -  SET PUTLINE ACTIVE FLAG (PLNOW)                             */ 05720000
*/*   -  SET POINTER TO PUTLINE PL (IOPL) IN REGISTER 1              */ 05721000
*/*   -  SET POINTER TO CP PL (PTLCPL) IN REGISTER 15                */ 05722000
*/*   -  LINK TO PUTLINE VIA (PTLCPL)                                */ 05723000
*/*   -  ON RETURN, CLEAR PUTLINE ACTIVE FLAG (PLNOW)                */ 05724000
*/*   -  IF RETURN CODE (REGISTER 15) IS NONSUCCESSFUL (NOT 0) AND   */ 05725000
*/*      IT NOT A RECURSIVE ERROR (PLFAIL IS 0), SET PUTLINE FAILURE */ 05726000
*/*      FLAG (PLFAIL) ON.  IF RETURN CODE IS 16, ISSUE ERROR MES-   */ 05727000
*/*      SAGE 1 (LACK OF SPACE) AND SET UADSREFM TERMINATION FLAG    */ 05728000
*/*      (RFMQUIT)                                                   */ 05729000
*/*   -  IF RETURN CODE IS SUCCESSFUL (0), CLEAR PUTLINE FAILURE     */ 05730000
*/*      FLAG (PLFAIL)                                               */ 05731000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05732000
*/*                                                                  */ 05733000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 05734000
*/*                                                                  */ 05735000
*/* INPUT --                                                         */ 05736000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05737000
*/*   -  PUTLINE PARAMETER BLOCK SET (PTPBK)                         */ 05738000
*/*                                                                  */ 05739000
*/* OUTPUT --                                                        */ 05740000
*/*   -  MESSAGE ISSUED                                              */ 05741000
*/*                                                                  */ 05742000
*/* EXTERNAL REFERENCES --                                           */ 05743000
*/*   -  PUTLINE MACRO -- LIST FORMAT                                */ 05744000
*/*   -  LINK MACRO -- LIST FORMAT                                   */ 05745000
*/*                                                                  */ 05746000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05747000
*/*   CONDITIONS --                                                  */ 05748000
*/*   -  MESSAGE ISSUED SUCCESSFULLY                                 */ 05749000
*/*   RETURN CODE -- N/A                                             */ 05750000
*/*                                                                  */ 05751000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 05752000
*/*   CONDITIONS --                                                  */ 05753000
*/*   -  MESSAGE FAILURE                                             */ 05754000
*/*   RETURN CODE -- N-A                                             */ 05755000
*/*                                                                  */ 05756000
*/********************************************************************/ 05757000
*DOPUTL:    /* CALL PUTLINE SERVICE ROUTINE                          */ 05758000
*           ENTRY;                                                 1447 05759000
DOPUTL   DS    0H                                                  1448 05760000
*           SAVLNKM = R14;          /* RESERVE LINK REGISTER         */ 05761000
         ST    R14,SAVLNKM                                         1448 05762000
*           RESPECIFY (R14) UNRESTRICTED;                          1449 05763000
*           IOPL(1:12) = BASPTRS(1:12);  /* SET PL BASE PTRS         */ 05764000
         L     @08,IOPLPTR                                         1450 05765000
         MVC   IOPL(12,@08),BASPTRS                                1450 05766000
*           IOPLIOPB = ADDR(PTPBK);  /* SET PTR TO PARAMETER BLOCK   */ 05767000
         LA    @15,PTPBK                                           1451 05768000
         ST    @15,IOPLIOPB(,@08)                                  1451 05769000
*           PLOUTZ = '0'B;          /* CLEAR VARIABLE AREA           */ 05770000
         XC    PLOUTZ+1(7),PLOUTZ+1                                1452 05771000
         MVI   PLOUTZ,B'00000000'                                  1452 05772000
*           /* INITIALIZE PARM LIST FOR CONTROL PROGRAM              */ 05773000
*           GEN(MVC   PTLCPL(LNKLNG),MPTLCPL); /* C P  PARM LIST     */ 05774000
         MVC   PTLCPL(LNKLNG),MPTLCPL                                   05775000
*           PLNOW = '1'B;           /* SET ACTIVE FLAG FOR PUTLINE   */ 05776000
         OI    PLNOW,B'00100000'                                   1454 05777000
*           RESPECIFY (R1,R15) RESTRICTED;                         1455 05778000
*           R1 = ADDR(IOPL);        /* SET PTR TO PUTLINE P P PL     */ 05779000
         L     R1,IOPLPTR                                          1456 05780000
*           R15 = ADDR(PTLCPL);     /* SET PTR TO PUTLINE C P PL     */ 05781000
         LA    R15,PTLCPL                                          1457 05782000
*           /* LINK TO PUTLINE                                       */ 05783000
*           GEN(LINK  MF=(E,(1)),SF=(E,(15)));  /* GO TO PUTLINE     */ 05784000
         LINK  MF=(E,(1)),SF=(E,(15))                                   05785000
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */ 05786000
         ST    R15,RTNCODE                                         1459 05787000
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1460 05788000
*           PLNOW = '0'B;           /* CLEAR ACTIVE FLAG OF PUTLN    */ 05789000
         NI    PLNOW,B'11011111'                                   1461 05790000
*           IF RTNCODE ^= 0         /* CHK FOR SUCESSFUL PUTLINE     */ 05791000
*             THEN                  /* NO,                           */ 05792000
         L     @08,RTNCODE                                         1462 05793000
         LTR   @08,@08                                             1462 05794000
         BZ    @RF01462                                            1462 05795000
*               DO;                                                1463 05796000
*                 IF PLFAIL = '0'B  /* CHK FOR PREVIOUS FAILURE      */ 05797000
*                   THEN            /* NO,                           */ 05798000
         TM    PLFAIL,B'10000000'                                  1464 05799000
         BNZ   @RF01464                                            1464 05800000
*                     DO;                                          1465 05801000
*                       SAVLNKMS=SAVLNKM;  /* SAVE ENTRY LINK        */ 05802000
         MVC   SAVLNKMS(4),SAVLNKM                                 1466 05803000
*                       PLFAIL = '1'B;/* SET PUTLINE FAILURE FLAG    */ 05804000
         OI    PLFAIL,B'10000000'                                  1467 05805000
*                       IF RTNCODE=16   /* CHK IF INSUFFICIENT SPACE */ 05806000
*                         THEN        /* YES,                        */ 05807000
         CH    @08,@CH00076                                        1468 05808000
         BNE   @RF01468                                            1468 05809000
*                           DO;                                    1469 05810000
*                             MSGNO = 1;     /* SET MESSAGE INDEX    */ 05811000
         MVC   MSGNO(2),@CH00032                                   1470 05812000
*                             CALL  MSGFNDR; /* LOCATE MESSAGE       */ 05813000
         BAL   @14,MSGFNDR                                         1471 05814000
*                             CALL  FXPUTL;  /* INITIALIZE PARM BLK  */ 05815000
         BAL   @14,FXPUTL                                          1472 05816000
*                             CALL  DOPUTL;  /* TO ISSUE PUTLINE     */ 05817000
         BAL   @14,DOPUTL                                          1473 05818000
*                             RFMQUIT = '1'B;/* SET TERM FLAG        */ 05819000
         OI    RFMQUIT,B'01000000'                                 1474 05820000
*                           END;                                   1475 05821000
*                         ELSE                                     1476 05822000
*                           DO;                                    1476 05823000
         B     @RC01468                                            1476 05824000
@RF01468 DS    0H                                                  1477 05825000
*                             MSGNO = 2;       /* SET MESSAGE INDEX  */ 05826000
         MVC   MSGNO(2),@CH00099                                   1477 05827000
*                             SOFFS = 20;      /* SET INSERT OFFSET  */ 05828000
         MVC   SOFFS(2),@CH00351                                   1478 05829000
*                             CALL  SYSERRD;   /* TO PRINT ERROR MSG */ 05830000
         BAL   @14,SYSERRD                                         1479 05831000
*                           END;                                   1480 05832000
*                       SAVLNKM=SAVLNKMS;  /* RESTORE ENTRY LINK     */ 05833000
@RC01468 MVC   SAVLNKM(4),SAVLNKMS                                 1481 05834000
*                     END;                                         1482 05835000
*                   ELSE            /* IS RECURSIVE FAILURE          */ 05836000
*                     RFMQUIT = '1'B;/*                            1483 05837000
*                                      UADSREFM TERMINATION FLAG     */ 05838000
         B     @RC01464                                            1483 05839000
@RF01464 OI    RFMQUIT,B'01000000'                                 1483 05840000
*               END;                                               1484 05841000
*             ELSE                  /* PUTLINE NOT SUCCESSFUL        */ 05842000
*               PLFAIL = '0'B;      /* CLEAR PUTLINE FAILURE FLAG    */ 05843000
         B     @RC01462                                            1485 05844000
@RF01462 NI    PLFAIL,B'01111111'                                  1485 05845000
*           RESPECIFY (R14) RESTRICTED;                            1486 05846000
@RC01462 DS    0H                                                  1487 05847000
*           R14 = SAVLNKM;          /* RESTORE LINK REGISTER         */ 05848000
         L     R14,SAVLNKM                                         1487 05849000
*           END  MSGFNDR;           /* RETURN TO CALLER              */ 05850000
         B     @EL00009                                            1488 05851000
*/********************************************************************/ 05852000
*/*                                                                  */ 05853000
*/* SEGMENT NAME -- DORENDR                                          */ 05854000
*/*                                                                  */ 05855000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05856000
*/*                                                                  */ 05857000
*/* FUNCTION -- ENTRY POINT FOR STAE RETRY EXIT                      */ 05858000
*/*   OPERATION --                                                   */ 05859000
*/*   -  IF NO STAE WORK AREA INDICATED (INPUT REGISTER 0 NOT 0),    */ 05860000
*/*      RETURN IMMEDIATELY                                          */ 05861000
*/*   -  OTHERWISE, REGISTER 0 CONTAINS POINTER TO STAE WORK AREA.   */ 05862000
*/*      SET POINTER TO PASSED PARAMETER BLOCK (STAEPL1) IN REGISTER */ 05863000
*/*      2 FROM LOCATION INDICATED BY REGISTER 1                     */ 05864000
*/*   -  LOAD BASE REGISTERS 9 THROUGH 12 FROM (STAEPL1)             */ 05865000
*/*   -  FREE THE STAE WORK AREA                                     */ 05866000
*/*   -  RE-ESTABLISH THE UADSREFM STAE ENVIRONMENT                  */ 05867000
*/*   -  SET MAIN STREAM EXIT POINTER (MAINX) IN REGISTER 14 TO      */ 05868000
*/*      SIMULATE LINK TO REND                                       */ 05869000
*/*   -  DROP THROUGH TO REND                                        */ 05870000
*/*                                                                  */ 05871000
*/* ENTRY -- STANDARD STAE RETRY EXIT LINKAGE                        */ 05872000
*/*                                                                  */ 05873000
*/* INPUT --                                                         */ 05874000
*/*   -  REGISTER 1 POINTS TO STAE WORK AREA                         */ 05875000
*/*                                                                  */ 05876000
*/* OUTPUT -- N/A                                                    */ 05877000
*/*                                                                  */ 05878000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05879000
*/*                                                                  */ 05880000
*/* EXIT-NORMAL -- N/A                                               */ 05881000
*/*   CONDITIONS -- N/A                                              */ 05882000
*/*   RETURN CODE -- N/A                                             */ 05883000
*/*                                                                  */ 05884000
*/* EXIT-ERROR -- N/A                                                */ 05885000
*/*   CONDITIONS -- N/A                                              */ 05886000
*/*   RETURN CODE -- N/A                                             */ 05887000
*/*                                                                  */ 05888000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 05889000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 05890000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 05891000
*/*                                                                  */ 05892000
*/********************************************************************/ 05893000
*DORENDR:   /* REND  E P  FOR STAE RETRY EXIT                        */ 05894000
*           PROCEDURE                                              1489 05895000
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */ 05896000
DORENDR  DS    0H                                                  1490 05897000
*                                   /* NO SAVE AREA CREATED          */ 05898000
*                                                                  1490 05899000
*           RESPECIFY (R14) UNRESTRICTED;                          1490 05900000
*           GEN(USING  DORENDR,@15);                               1491 05901000
         USING  DORENDR,@15                                             05902000
*           RESPECIFY (R0) RESTRICTED;                             1492 05903000
*           IF R0 ^= 0              /* CHK IF WORK AREA SUPPLIED     */ 05904000
*             THEN                  /* NO,                           */ 05905000
         LTR   R0,R0                                               1493 05906000
         BZ    @RF01493                                            1493 05907000
*               GEN(RETURN);        /* RETURN TO CALLER              */ 05908000
         RETURN                                                         05909000
*           GENERATE;                                              1495 05910000
*                                                                  1495 05911000
@RF01493 DS    0H                                                  1495 05912000
          DROP  @15                 DROP ENTRY ADDRESSABILITY           05913000
          USING @PSTART,R9          REESTABLISH MODULE ADDRESSABILITY   05914000
          L     R2,0(R1)            GET PTR TO PARAMETER BLOCK          05915000
          LM    R9,R12,0(R2)        LOAD IKJRBBU0 BASE PTRS             05916000
*           R0 = 104;               /* SET LENGTH OF STAE WORK AREA  */ 05917000
         LA    R0,104                                              1496 05918000
*           GEN(FREEMAIN  R,LV=(0),A=(1));  /* FREE WORK AREA        */ 05919000
         FREEMAIN  R,LV=(0),A=(1)                                       05920000
*           RESPECIFY (R0) UNRESTRICTED;                           1498 05921000
*                                                                  1498 05922000
*           CALL RSTAE;             /* RE-ESTABLISH STAE ENVIRONMENT */ 05923000
*                                                                  1499 05924000
         BAL   @14,RSTAE                                           1499 05925000
*           RESPECIFY (R14) RESTRICTED;                            1500 05926000
*           R14 = ADDR(MAINX);      /* SET MAIN EXIT PTR             */ 05927000
         LA    R14,MAINX                                           1501 05928000
*/********************************************************************/ 05929000
*/*                                                                  */ 05930000
*/* SEGMENT NAME -- REND                                             */ 05931000
*/*                                                                  */ 05932000
*/* DESCRIPTIVE NAME -- N/A                                          */ 05933000
*/*                                                                  */ 05934000
*/* FUNCTION -- RELEASE ALL RESOURCES AND SET EXIT RETURN CODE       */ 05935000
*/*   OPERATION --                                                   */ 05936000
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */ 05937000
*/*   -  PERFORM SEGMENT RMODEU TO PRINT ANY EXISTING USERID MESSAGE */ 05938000
*/*   -  SET NO-WRITE FLAG (RWPF5) IN ACCOUNT-READ/WRITE PARAMETER   */ 05939000
*/*      BLOCK (RWPB)                                                */ 05940000
*/*   -  PERFORM SEGMENT DOWRT2 TO FREE READ BUFFER                  */ 05941000
*/*   -  PERFORM SEGMENT FREBUF TO FREE WRITE BUFFER                 */ 05942000
*/*   -  PERFORM SEGMENT RDEQM TO DEQUEUE USERID IF ENQUEUED         */ 05943000
*/*   -  PERFORM SEGMENT RCLOS TO CLOSE ANY OPEN DCBS                */ 05944000
*/*   -  PERFORM SEGMENT RDEQU TO DEQUEUE FROM UADS IF ENQUEUED      */ 05945000
*/*   -  PERFORM SEGMENT RDSTAE TO REMOVE ANY EXISTING STAE          */ 05946000
*/*   -  IF ANY FAILURE FLAG SET (QUITCHK NOT 0) SET RETURN CODE TO  */ 05947000
*/*      TO 12 AND EXIT                                              */ 05948000
*/*   -  IF NO FAILURE FLAG SET, ISSUE MESSAGE 8 (REFORMATTED) AND   */ 05949000
*/*      IF STILL NO FAILURE FLAG, SET RETURN CODE TO 0.  IF FAILURE */ 05950000
*/*      FLAG SET AFTER MESSAGE 8 ATTEMPT, LEAVE RETURN CODE AT 12   */ 05951000
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */ 05952000
*/*                                                                  */ 05953000
*/* ENTRY -- LINKED BY REGISTER 14                                   */ 05954000
*/*                                                                  */ 05955000
*/* INPUT --                                                         */ 05956000
*/*   -  UADSREFM ENVIRONMENT                                        */ 05957000
*/*                                                                  */ 05958000
*/* OUTPUT --                                                        */ 05959000
*/*   -  ALL RESOURCES RELEASED                                      */ 05960000
*/*   -  MODE MESSAGE                                                */ 05961000
*/*   -  RETURN CODE SET                                             */ 05962000
*/*                                                                  */ 05963000
*/* EXTERNAL REFERENCES -- N/A                                       */ 05964000
*/*                                                                  */ 05965000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 05966000
*/*   CONDITIONS --                                                  */ 05967000
*/*   -  NO FAILURE OCCURRED DURING UADSREFM PROCESSING              */ 05968000
*/*      (REFORMATTED MESSAGE ISSUED)                                */ 05969000
*/*   RETURN CODE --  0                                              */ 05970000
*/*                                                                  */ 05971000
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */ 05972000
*/*   CONDITIONS --                                                  */ 05973000
*/*   -  SOME FAILURE OCCURRED DURING UADSREFM PROCESSING            */ 05974000
*/*   RETURN CODE -- 12                                              */ 05975000
*/*                                                                  */ 05976000
*/********************************************************************/ 05977000
*REND:      /* RELEASE ALL RESOURCES, SET EXIT CODE AND EXIT         */ 05978000
*           ENTRY;                                                 1502 05979000
*                                                                  1502 05980000
         B     @EC01502                                            1502 05981000
REND     DS    0H                                                  1502 05982000
@EC01502 DS    0H                                                  1503 05983000
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */ 05984000
         ST    R14,SAVLNKA                                         1503 05985000
*           RESPECIFY (R14) UNRESTRICTED;                          1504 05986000
*                                                                  1504 05987000
*           CALL  RMODEU;           /* GO TO ISSUE USERIDS MESSAGE   */ 05988000
         BAL   @14,RMODEU                                          1505 05989000
*           RWPF5 = '0'B;           /* SET NO-WRITE FLAG             */ 05990000
         NI    RWPF5,B'11110111'                                   1506 05991000
*           CALL  DOWRT2;           /* GO TO FREE READ BUFFER        */ 05992000
         BAL   @14,DOWRT2                                          1507 05993000
*           CALL  FREBUF;           /* GO TO FREE WRITE BUFFER       */ 05994000
         BAL   @14,FREBUF                                          1508 05995000
*           CALL  RDEQM;            /* GO TO DEQUEUE USERID          */ 05996000
         BAL   @14,RDEQM                                           1509 05997000
*           CALL  RCLOS;            /* GO TO CLOSE OPEN DCBS         */ 05998000
         BAL   @14,RCLOS                                           1510 05999000
*           CALL  RDEQU;            /* GO TO DEQUEUE UADS            */ 06000000
         BAL   @14,RDEQU                                           1511 06001000
*           CALL  RDSTAE;           /* GO TO REMOVE STAE             */ 06002000
*                                                                  1512 06003000
         BAL   @14,RDSTAE                                          1512 06004000
*           /* SET RETURN FOR CALLER                                 */ 06005000
*           RETURNC = 12;           /* SET ERROR RETURN CODE         */ 06006000
         MVC   RETURNC(4),@CF00036                                 1513 06007000
*           IF RFMQUIT = '0'B       /* CHK FOR ANY FAILURE           */ 06008000
*             THEN                  /* NONE,                         */ 06009000
         TM    RFMQUIT,B'01000000'                                 1514 06010000
         BNZ   @RF01514                                            1514 06011000
*               DO;                                                1515 06012000
*                 MSGNO = 8;        /* SET MESSAGE INDEX             */ 06013000
         MVC   MSGNO(2),@CH00046                                   1516 06014000
*                 CALL  MSGFNDR;    /* LOCATE MESSAGE TEXT           */ 06015000
         BAL   @14,MSGFNDR                                         1517 06016000
*                 CALL FXPUTL;      /* INITIALIZE PB                 */ 06017000
         BAL   @14,FXPUTL                                          1518 06018000
*                 CALL  DOPUTL;     /* ISSUE PUTLINE                 */ 06019000
         BAL   @14,DOPUTL                                          1519 06020000
*                 IF RFMQUIT = '0'B /* CHK FOR ANY FAILURE           */ 06021000
*                   THEN            /* NONE,                         */ 06022000
         TM    RFMQUIT,B'01000000'                                 1520 06023000
         BNZ   @RF01520                                            1520 06024000
*                     RETURNC=0;    /* SET SUCCESS RETURN CODE       */ 06025000
         SLR   @08,@08                                             1521 06026000
         ST    @08,RETURNC                                         1521 06027000
*               END;                                               1522 06028000
*                                                                  1522 06029000
@RF01520 DS    0H                                                  1523 06030000
*           RESPECIFY (R14) RESTRICTED;                            1523 06031000
@RF01514 DS    0H                                                  1524 06032000
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */ 06033000
         L     R14,SAVLNKA                                         1524 06034000
*           END  DORENDR;           /* RETURN                        */ 06035000
@EL00010 DS    0H                                                  1525 06036000
@EF00010 DS    0H                                                  1525 06037000
@ER00010 BR    @14                                                 1525 06038000
*/********************************************************************/ 06039000
*/*                                                                  */ 06040000
*/* SEGMENT NAME -- STAEXIN                                          */ 06041000
*/*                                                                  */ 06042000
*/* DESCRIPTIVE NAME -- N/A                                          */ 06043000
*/*                                                                  */ 06044000
*/* FUNCTION -- STAE (ABEND) EXIT ROUTINE                            */ 06045000
*/*   OPERATION --                                                   */ 06046000
*/*   -  IF NO STAE WORK AREA WAS SUPPLIED (ENTRY REGISTER 0 = 12),  */ 06047000
*/*      CHECK IF PARAMETER LIST WAS PASSED (REGISTER 2 NOT 0).  IF  */ 06048000
*/*      NO  PARAMETER LIST  WAS PASSED,  SET  REGISTER 15  TO  0    */ 06049000
*/*      (NO RETRY) AND RETURN DIRECTLY TO ABEND.  IF PARAMETER LIST */ 06050000
*/*      WAS PASSED,  ESTABLISH A LOCAL AREA TO SUBSTITUTE FOR THE   */ 06051000
*/*      SYSTEM LINKAGE SAVE AREA (VIA REGISTER 13) AND RELOAD THE   */ 06052000
*/*      ADDRESABILITY REGISTERS (REGISTERS 9 THROUGH 12) FROM PARA- */ 06053000
*/*      METER LIST.  RESERVE THE ABEND CODE FROM REGISTER 1         */ 06054000
*/*   -  IF STAE WORK AREA WAS SUPPLIED, GET LOCATION OF THE PASSED  */ 06055000
*/*      PARAMETER LIST FROM WORK AREA AND RELOAD THE ADDRESSABILITY */ 06056000
*/*      REGISTERS.  RESERVE ABEND CODE FROM PARAMETER LIST (SABEND) */ 06057000
*/*   -  SAVE ENTRY REGISTER 13 IN STAEXIN SAVE AREA (STASAV+4) AND  */ 06058000
*/*      LOAD REGISTER 13 WITH LOCATION OF SAVE AREA (STASAV)        */ 06059000
*/*   -  RELOAD ECTPTR                                               */ 06060000
*/*   -  INITIALIZE EXIT RETURN CODE (STARC) AND EXIT RETRY ADDRESS  */ 06061000
*/*      (STARAD) FOR NO-RETRY (0).                                  */ 06062000
*/*   -  SET ENTRY ABEND CODE (RTNCODE) IN ECT (ECTRTCD) AND SET     */ 06063000
*/*      ABEND CODE FLAG (ECTRCDF)                                   */ 06064000
*/*   -  POSITION ABEND CODE (RTNCODE) FOR MESSAGE 12                */ 06065000
*/*   -  IF REPETITIVE ABEND ENTRY (STANOW NOT 0), POST UADSREFM ECB */ 06066000
*/*      (REFMECB) WITH CODE 12, RESTORE ENTRY REGISTERS AND EXIT    */ 06067000
*/*   -  IF INITIAL ABEND ENTRY (STANOW = 0),                        */ 06068000
*/*      -  IF FORCED TERMINATION FLAG (ECTATRM) IS SET, THEN POST   */ 06069000
*/*         UADSREFM ECB (REFMECB) WITH CODE 12, RESTORE ENTRY REG-  */ 06070000
*/*         ISTERS AND EXIT                                          */ 06071000
*/*      -  IF NOT FORCED TERMINATION AND ABEND CODE IS 'B01' (I/0   */ 06072000
*/*         ERROR IN SERVICE ROUTINE), THEN SET STARC TO 4 (RETRY)   */ 06073000
*/*         AND SET LOCATION OF DORENDR IN STARAD (RETRY EXIT).      */ 06074000
*/*      -  IF NOT FORCED TERMINATION AND NOT ABEND CODE 'B01',      */ 06075000
*/*         PERFORM SEGMENT STAEXN2 TO ISSUE ERROR MESSAGE 12        */ 06076000
*/*      -  POST UADSREFM ECB (REFMECB) WITH CODE 12, RESTORE ENTRY  */ 06077000
*/*         REGISTERS AND EXIT                                       */ 06078000
*/* SEGMENT NAME -- STAEXIN  (CONTINUED)                             */ 06079000
*/*                                                                  */ 06080000
*/* ENTRY -- STAEXIN -- STANDARD STAE EXIT LINKAGE                   */ 06081000
*/*                                                                  */ 06082000
*/* INPUT --                                                         */ 06083000
*/*   -  REGISTER 1 (POINTER TO STAE WORK AREA)                      */ 06084000
*/*                                                                  */ 06085000
*/* OUTPUT --                                                        */ 06086000
*/*   -  ERROR MESSAGE 12                                            */ 06087000
*/*                                                                  */ 06088000
*/* EXTERNAL REFERENCES --                                           */ 06089000
*/*   -  STAE WORK AREA (VIA REGISTER 1)                             */ 06090000
*/*                                                                  */ 06091000
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */ 06092000
*/*   CONDITIONS --                                                  */ 06093000
*/*   -  ABEND CODE NOT 'B01' (MESSAGE 12 ISSUED)                    */ 06094000
*/*   RETURN CODE -- 0  (NO RETRY)                                   */ 06095000
*/*                                                                  */ 06096000
*/* EXIT-ERROR --                                                    */ 06097000
*/*   CONDITIONS --                                                  */ 06098000
*/*   -  ABEND CODE 'B01'                                            */ 06099000
*/*   RETURN CODE -- 4  (RETRY)                                      */ 06100000
*/*                                                                  */ 06101000
*/********************************************************************/ 06102000
*STAEXIN:   /* STAE (ABEND) EXIT ROUTINE                             */ 06103000
*           PROCEDURE                                              1526 06104000
*                 OPTIONS(NOSAVE,NOSAVEAREA); /* NO REGISTERS SAVED  */ 06105000
STAEXIN  DS    0H                                                  1527 06106000
*                                   /* NO SAVE AREA CREATED          */ 06107000
*           RESPECIFY  (R14) UNRESTRICTED;                         1527 06108000
*           RESPECIFY  (R0,R14) RESTRICTED;                        1528 06109000
*           GEN(DROP   R9                 DROP MODULE ADDRESSABILITY);  06110000
         DROP   R9                 DROP MODULE ADDRESSABILITY           06111000
*           GEN(USING  STAEXIN,@15        SET ENTRY ADDRESSABILITY);    06112000
*                                                                  1530 06113000
         USING  STAEXIN,@15        SET ENTRY ADDRESSABILITY             06114000
*           IF R0 = 12              /* CHK IF ANY WORK AREA PASSED   */ 06115000
*             THEN                  /* NO,                           */ 06116000
         CH    R0,@CH00036                                         1531 06117000
         BNE   @RF01531                                            1531 06118000
*               /* INITIALIZE WITH OUT PASSED WORK AREA              */ 06119000
*               DO;                                                1532 06120000
*                 RESPECIFY (R1,R2,R13) RESTRICTED;                1533 06121000
*                 IF R2 ^= 0        /* CHK FOR PARM LIST PTR         */ 06122000
*                   THEN            /* YES,                          */ 06123000
         LTR   R2,R2                                               1534 06124000
         BZ    @RF01534                                            1534 06125000
*                     DO;                                          1535 06126000
*                       GEN(USING  @DATD,R13);                     1536 06127000
         USING  @DATD,R13                                               06128000
*                       GEN(L      R13,STAENL1+8(R2)    RENT AREA);     06129000
         L      R13,STAENL1+8(R2)    RENT AREA                          06130000
*                       GEN(LA     R13,STASAVN       LOC OF SAVE AREA); 06131000
         LA     R13,STASAVN       LOC OF SAVE AREA                      06132000
*                       GEN(STM    R14,R12,12(R13)   SAVE ENTRY REGS);  06133000
         STM    R14,R12,12(R13)   SAVE ENTRY REGS                       06134000
*                       GEN(DROP   R13);                           1540 06135000
         DROP   R13                                                     06136000
*                       GEN(LM     R9,R12,STAENL1(R2)   GET BASE REGS); 06137000
         LM     R9,R12,STAENL1(R2)   GET BASE REGS                      06138000
*                       GEN(DROP   @15);                           1542 06139000
         DROP   @15                                                     06140000
*                       GEN(USING  @PSTART,R9);                    1543 06141000
         USING  @PSTART,R9                                              06142000
*                       RTNCODE = R1;                              1544 06143000
         ST    R1,RTNCODE                                          1544 06144000
*                       RESPECIFY (R1,R2,R13) UNRESTRICTED;        1545 06145000
*                     END;                                         1546 06146000
*                   ELSE            /* NO PARAMETER LIST PTR         */ 06147000
*                     DO;           /* EXIT FROM UNKNOWN ENTRY       */ 06148000
         B     @RC01534                                            1547 06149000
@RF01534 DS    0H                                                  1548 06150000
*                       GEN(SR    @15,@15);  /* NO-RETRY             */ 06151000
         SR    @15,@15                                                  06152000
*                       GEN(RETURN);   /* EXIT                       */ 06153000
         RETURN                                                         06154000
*                     END;                                         1550 06155000
*               END;                                               1551 06156000
*             ELSE                  /* YES, WORK AREA                */ 06157000
*               /* INITIALIZE WITH PASSED WORK AREA                  */ 06158000
*               DO;                                                1552 06159000
         B     @RC01531                                            1552 06160000
@RF01531 DS    0H                                                  1553 06161000
*                 GENERATE;                                        1553 06162000
*                                                                  1553 06163000
         STM   R14,R12,12(R13)        SAVE ENTRY REGS                   06164000
         L     R2,0(R1)               L PARM LIST PTR                   06165000
         LM    R9,R12,0(R2)           L POSSIBLE SAVED BASE PTRS        06166000
*                 RESPECIFY (R1) RESTRICTED;                       1554 06167000
*                 RTNCODE = SABND;  /* RESERVE ABEND CODE            */ 06168000
         MVC   RTNCODE(4),SABND(SWRKAP)                            1555 06169000
*                 RESPECIFY (R1) UNRESTRICTED;                     1556 06170000
*               END;                                               1557 06171000
*                                                                  1557 06172000
*           GENERATE;                                              1558 06173000
@RC01531 DS    0H                                                  1558 06174000
         ST    @13,STASAV+4           SAVE PASSED SAVE AREA PTR         06175000
         LA    @15,STASAV             L CURRENT SAVE AREA PTR           06176000
         ST    @15,8(0,@13)           SAVE IN CALLERS SAVE AREA         06177000
         LR    @13,@15                SET CURRENT SAVE AREA PTR         06178000
*           ECTPTR = BASECTP;       /* SET PTR TO ECT                */ 06179000
         L     @15,BASECTP                                         1559 06180000
         ST    @15,ECTPTR                                          1559 06181000
*           ECTRTCD = RTNCODE;      /* PRESERVE ABEND RETURN CODE    */ 06182000
         MVC   ECTRTCD(3,@15),RTNCODE+1                            1560 06183000
*           ECTRCDF = '80'X;        /* SET ABEND CODE FLAG           */ 06184000
         MVI   ECTRCDF(@15),X'80'                                  1561 06185000
*           STARAD = 0;             /* INITIALIZE FOR NO RETRY       */ 06186000
         SLR   @08,@08                                             1562 06187000
         ST    @08,STARAD                                          1562 06188000
*           STARC = 0;              /* INITIALIZE FOR NO RETRY       */ 06189000
         ST    @08,STARC                                           1563 06190000
*           /* CHK FOR REPETITIVE ENTRY TO STAEXIN                   */ 06191000
*           IF STANOW = '0'B        /* CHK IF ABEND RE-ENTRY         */ 06192000
*             THEN                  /* NO,                           */ 06193000
         TM    STANOW,B'00010000'                                  1564 06194000
         BNZ   @RF01564                                            1564 06195000
*               /* ISSUE ABEND MESSAGE                               */ 06196000
*               DO;                                                1565 06197000
*                 STANOW = '1'B;    /* SET ABEND ACTIVE FLAG         */ 06198000
         OI    STANOW,B'00010000'                                  1566 06199000
*                 /* CHK IF DETACH ENTRY                             */ 06200000
*                 IF ECTATRM = '0'B /* CHK FOR ECT QUIT FLAG         */ 06201000
*                   THEN            /* NO,                           */ 06202000
         TM    ECTATRM(@15),B'00100000'                            1567 06203000
         BNZ   @RF01567                                            1567 06204000
*                     DO;                                          1568 06205000
*                       IF USERCDE^='0B01'X /* CHK FOR I/O ERROR     */ 06206000
*                         THEN              /* NO,                   */ 06207000
         CLC   USERCDE(2),@CB02062                                 1569 06208000
         BE    @RF01569                                            1569 06209000
*                           CALL  STAEXN2;  /* ISSUE ABEND MESSAGE   */ 06210000
         BAL   @14,STAEXN2                                         1570 06211000
*                         ELSE              /* YES, IS I/O ERROR     */ 06212000
*                           DO;                                    1571 06213000
         B     @RC01569                                            1571 06214000
@RF01569 DS    0H                                                  1572 06215000
*                             STARC = 4;  /* SET RETRY RETURN CODE   */ 06216000
         MVC   STARC(4),@CF00102                                   1572 06217000
*                             STARAD=ADDR(DORENDR); /* SET RETRY EP  */ 06218000
         LA    @15,DORENDR                                         1573 06219000
         ST    @15,STARAD                                          1573 06220000
*                             RFMQUIT = '1'B; /* TERMINATION FLAG ON */ 06221000
         OI    RFMQUIT,B'01000000'                                 1574 06222000
*                           END;                                   1575 06223000
*                     END;                                         1576 06224000
*                   ELSE     ;      /* YES, QUIT NOW                 */ 06225000
@RF01567 DS    0H                                                  1578 06226000
*               END;                                               1578 06227000
*                                                                  1578 06228000
@RC01567 DS    0H                                                  1579 06229000
*           REFMECB = SPOST + 12;   /* POST ECB                      */ 06230000
@RF01564 LA    @15,12                                              1579 06231000
         AL    @15,SPOST                                           1579 06232000
         ST    @15,REFMECB                                         1579 06233000
*           /* RESTORE ENTRY REGISTERS THEN EXIT                     */ 06234000
*           GEN(LM    @15,@00,STARC          SET RETURN CODE );    1580 06235000
         LM    @15,@00,STARC          SET RETURN CODE                   06236000
*           GEN(L     @13,4(0,@13)           RESTORE SAVE AREA PTR );   06237000
         L     @13,4(0,@13)           RESTORE SAVE AREA PTR             06238000
*           GEN(STM   @15,@00,16(@13)        SET UP EXIT VALUES ); 1582 06239000
         STM   @15,@00,16(@13)        SET UP EXIT VALUES                06240000
*           GEN(LM    @14,@12,12(@13) RESTORE CALLERS REGS );      1583 06241000
         LM    @14,@12,12(@13) RESTORE CALLERS REGS                     06242000
*           GEN(BCR   15,@14          RETURN );                    1584 06243000
*                                                                  1584 06244000
         BCR   15,@14          RETURN                                   06245000
*           RESPECIFY  (R0) UNRESTRICTED;                          1585 06246000
*/********************************************************************/ 06247000
*/*                                                                  */ 06248000
*/* SEGMENT NAME -- STAEXN2                                          */ 06249000
*/*                                                                  */ 06250000
*/* DESCRIPTIVE NAME -- N/A                                          */ 06251000
*/*                                                                  */ 06252000
*/* FUNCTION -- ISSUE ABEND MESSAGE AND SET NO-RETRY RETURN CODE     */ 06253000
*/*   OPERATION --                                                   */ 06254000
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */ 06255000
*/*   -  SET MESSAGE INDEX 12                                        */ 06256000
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */ 06257000
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT LIST (TMSGNS1)                */ 06258000
*/*   -  TRANSLATE ABEND CODE (ABNCCHS) TO EBCDIC (MSGCDE)           */ 06259000
*/*   -  SET DYNAMIC SEGMENT LIST WITH NAME LENGTH (TMSGTIL1) AND    */ 06260000
*/*      OFFSET INTO TEXT (TMSGTIO1)                                 */ 06261000
*/*   -  PERFORM SEGMENTS FXPUTLM (INITIALIZE PARAMETER BLOCK) AND   */ 06262000
*/*      AND DOPUTL TO ISSUE MESSAGE                                 */ 06263000
*/*   -  SET NO-RETRY RETURN CODE (0 IN STARC) FOR STAEXIN           */ 06264000
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */ 06265000
*/*                                                                  */ 06266000
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */ 06267000
*/*                                                                  */ 06268000
*/* INPUT -- N/A                                                     */ 06269000
*/*                                                                  */ 06270000
*/* OUTPUT --                                                        */ 06271000
*/*   -  ERROR MESSAGE 12 (ABEND)                                    */ 06272000
*/*                                                                  */ 06273000
*/* EXTERNAL REFERENCES -- N/A                                       */ 06274000
*/*                                                                  */ 06275000
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */ 06276000
*/*   CONDITIONS --                                                  */ 06277000
*/*   -  MESSAGE 12 ISSUED                                           */ 06278000
*/*   RETURN CODE -- N/A                                             */ 06279000
*/*                                                                  */ 06280000
*/* EXIT-ERROR -- N/A                                                */ 06281000
*/*   CONDITIONS -- N/A                                              */ 06282000
*/*   RETURN CODE -- N/A                                             */ 06283000
*/*                                                                  */ 06284000
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */ 06285000
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */ 06286000
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */ 06287000
*/*                                                                  */ 06288000
*/********************************************************************/ 06289000
*STAEXN2:   /* ISSUE ABEND MESSAGE AND SET NO-RETRY RETURN CODE      */ 06290000
*                                                                  1586 06291000
*           ENTRY;                                                 1586 06292000
         B     @EC01586                                            1586 06293000
STAEXN2  DS    0H                                                  1586 06294000
@EC01586 DS    0H                                                  1587 06295000
*           SAVLNKS  =  R14;        /* RESERVE LINK REGISTER         */ 06296000
         ST    R14,SAVLNKS                                         1587 06297000
*           RESPECIFY (R14) UNRESTRICTED;                          1588 06298000
*                                                                  1588 06299000
*           MSGNO = 12;             /* SET MESSAGE INDEX             */ 06300000
         MVC   MSGNO(2),@CH00036                                   1589 06301000
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE TEXT     */ 06302000
         BAL   @14,MSGFNDR                                         1590 06303000
*           TMSGNS1(1:16)=TMLMDL1(1:16);  /* SEGMENT LIST            */ 06304000
         L     @08,MSGPTR                                          1591 06305000
         MVC   TMSGNS1(16),TMLMDL1(@08)                            1591 06306000
*           TMSGNNO1 = ADDR(TMSGNS2);  /* 2ND LEVEL PTR              */ 06307000
         LA    @15,TMSGNS2                                         1592 06308000
         ST    @15,TMSGNNO1                                        1592 06309000
*           TMSGNP13 = ADDR(TMSGTIX2); /* TEXT SEGMT PTR             */ 06310000
         LA    @15,TMSGTIX2                                        1593 06311000
         ST    @15,TMSGNP13                                        1593 06312000
*           TMSGNS2(1:16)=TMLMDL2(1:16);  /* 2ND SEGMT LIST          */ 06313000
         L     @08,TMLNX1(,@08)                                    1594 06314000
         MVC   TMSGNS2(16),TMLMDL2(@08)                            1594 06315000
*           TMSGNP23=ADDR(TMSGTIX1);  /* 2ND TEXT SGMT PTR           */ 06316000
*                                                                  1595 06317000
         LA    @08,TMSGTIX1                                        1595 06318000
         ST    @08,TMSGNP23                                        1595 06319000
*           /* EXTRACT AND CONVERT CODE CHARACTERS                   */ 06320000
*           GENERATE;                                              1596 06321000
*                                                                  1596 06322000
          UNPK  MSGCDE(6),ABNCCHS(3)   UNPACK BINARY CHARACTER AREA     06323000
          TR    TMSGTIN1(3),HEXTBL-240 TRANSLATE TO EBCDIC              06324000
*           TMSGTIL1 = 7;           /* SET TEXT SEGMENT LENGTH       */ 06325000
         MVC   TMSGTIL1(2),@CH00644                                1597 06326000
*           TMSGTIO1 = 32;          /* SET TEXT OFFSET               */ 06327000
*                                                                  1598 06328000
         MVC   TMSGTIO1(2),@CH00113                                1598 06329000
*           CALL  FXPUTLM;          /* INITIALIZE PARAMETER BLOCK    */ 06330000
*                                                                  1599 06331000
         BAL   @14,FXPUTLM                                         1599 06332000
*           PTPBOPUT = ADDR(TMSGNS1);  /* PTR TO OUTPUT              */ 06333000
*                                                                  1600 06334000
         LA    @08,TMSGNS1                                         1600 06335000
         L     @01,PTPBPTR                                         1600 06336000
         ST    @08,PTPBOPUT(,@01)                                  1600 06337000
*           CALL  DOPUTL;           /* GO TO ISSUE PUTLINE           */ 06338000
*                                                                  1601 06339000
         BAL   @14,DOPUTL                                          1601 06340000
*           STARC = 0;              /* SET NO-RETRY RETURN CODE      */ 06341000
*                                                                  1602 06342000
         SLR   @08,@08                                             1602 06343000
         ST    @08,STARC                                           1602 06344000
*           RESPECIFY (R14) RESTRICTED;                            1603 06345000
*           R14 = SAVLNKS;          /* RESTORE LINK REGISTER         */ 06346000
         L     R14,SAVLNKS                                         1604 06347000
*           END  STAEXIN;                                          1605 06348000
@EL00011 DS    0H                                                  1605 06349000
@EF00011 DS    0H                                                  1605 06350000
@ER00011 BR    @14                                                 1605 06351000
*                                                                  1606 06352000
*           END  IKJRBBU0           /* END OF REFORM PROCESSOR       */ 06353000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 06354000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                        * 06355000
*/*%INCLUDE SYSLIB  (IKJECT  )                                        * 06356000
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        * 06357000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        * 06358000
*/*%INCLUDE SYSLIB  (IHADCB  )                                        * 06359000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        * 06360000
*/*%INCLUDE SYSLIB  (IKJEFUAD)                                        * 06361000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        * 06362000
*/*%INCLUDE SYSLIB  (IKJPTPB )                                        * 06363000
*/*%INCLUDE SYSUT5  (NOWRKA  )                                        * 06364000
*/*%INCLUDE SYSUT5  (XTRWRKA )                                        * 06365000
*/*%INCLUDE SYSUT5  (ABNDMSG )                                        * 06366000
*;                                                                 1606 06367000
@DATA    DS    0H                                                       06368000
@CH00099 DC    H'2'                                                     06369000
@CH00090 DC    H'3'                                                     06370000
@CH00080 DC    H'5'                                                     06371000
@CH00118 DC    H'6'                                                     06372000
@CH00644 DC    H'7'                                                     06373000
@CH00046 DC    H'8'                                                     06374000
@CH00033 DC    H'9'                                                     06375000
@CH00034 DC    H'10'                                                    06376000
@CH00035 DC    H'11'                                                    06377000
@CH01676 DC    H'13'                                                    06378000
@CH00231 DC    H'14'                                                    06379000
@CH00174 DC    H'15'                                                    06380000
@CH00076 DC    H'16'                                                    06381000
@CH00562 DC    H'17'                                                    06382000
@CH00181 DC    H'18'                                                    06383000
@CH00351 DC    H'20'                                                    06384000
@CH01923 DC    H'21'                                                    06385000
@CH01991 DC    H'23'                                                    06386000
@CH01912 DC    H'26'                                                    06387000
@CH01967 DC    H'27'                                                    06388000
@CH00565 DC    H'28'                                                    06389000
@CH01868 DC    H'29'                                                    06390000
@CH01172 DC    H'30'                                                    06391000
@CH00113 DC    H'32'                                                    06392000
@CH02008 DC    H'51'                                                    06393000
@CH00551 DC    H'108'                                                   06394000
@SM02090 MVC   UPTPREFX(0,@08),NODIDC                                   06395000
@SM02092 MVC   TMSGTIN1(0),NODIDC                                       06396000
@SM02095 MVC   MIDSNAM-8(0,@14),NODIDC                                  06397000
@SM02097 MVC   NUCDB(0,@08),OLCDB(@01)                                  06398000
@DATD    DSECT                                                          06399000
         DS    0F                                                       06400000
@SA00001 DS    18F                                                      06401000
@SAV001  EQU   @SA00001                                                 06402000
@TF00001 DS    F                                                        06403000
@ZTEMPS  DS    0F                                                       06404000
@ZT00002 DC    F'0'                                                     06405000
@ZT00003 DC    F'0'                                                     06406000
@ZTEMPND EQU   *                                                        06407000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         06408000
@TEMPS   EQU   @ZTEMPS                                                  06409000
@L       EQU   @ZLEN                                                    06410000
IKJRBBU0 CSECT                                                          06411000
         DS    0F                                                       06412000
@CF00032 DC    F'1'                                                     06413000
@CH00032 EQU   @CF00032+2                                               06414000
@CF00102 DC    F'4'                                                     06415000
@CH00102 EQU   @CF00102+2                                               06416000
@CF00036 DC    F'12'                                                    06417000
@CH00036 EQU   @CF00036+2                                               06418000
@CF02026 DC    F'19'                                                    06419000
@CH02026 EQU   @CF02026+2                                               06420000
@CF00049 DC    F'24'                                                    06421000
@CH00049 EQU   @CF00049+2                                               06422000
@CF02068 DC    F'67'                                                    06423000
@CF01890 DC    XL3'0'                                                   06424000
         DC    C'0'                                                     06425000
@DATD    DSECT                                                          06426000
         DS    0D                                                       06427000
RENTSR   DS    CL3040                                                   06428000
         ORG   RENTSR                                                   06429000
RENTS    DS    CL3040                                                   06430000
         ORG   RENTS                                                    06431000
SAVLNKA  DS    AL4                                                      06432000
SAVLNKB  DS    AL4                                                      06433000
SAVLNKC  DS    AL4                                                      06434000
SAVLNKD  DS    AL4                                                      06435000
SAVLNKE  DS    AL4                                                      06436000
SAVLNKF  DS    AL4                                                      06437000
SAVLNKG  DS    AL4                                                      06438000
SAVLNKM  DS    AL4                                                      06439000
SAVLNKMS DS    AL4                                                      06440000
SAVLNKN  DS    AL4                                                      06441000
SAVLNKS  DS    AL4                                                      06442000
SVREND   DS    AL4                                                      06443000
HEDBPTR  DS    AL4                                                      06444000
RHEDBPTR DS    AL4                                                      06445000
UADSNPTR DS    AL4                                                      06446000
DPOBPTR  DS    AL4                                                      06447000
DNOBPTR  DS    AL4                                                      06448000
DROBPTR  DS    AL4                                                      06449000
UADSPPTR DS    AL4                                                      06450000
UADSAPTR DS    AL4                                                      06451000
UADSRPTR DS    AL4                                                      06452000
FSQEPTR  DS    AL4                                                      06453000
SVFSQEP  DS    AL4                                                      06454000
CURFSQP  DS    AL4                                                      06455000
ECTPTR   DS    AL4                                                      06456000
IOPLPTR  DS    AL4                                                      06457000
CPPLPTR  DS    AL4                                                      06458000
DCBNPTR  DS    AL4                                                      06459000
DCBXPTR  DS    AL4                                                      06460000
DCBDPTR  DS    AL4                                                      06461000
RDJNPTR  DS    AL4                                                      06462000
         ORG   RDJNPTR                                                  06463000
JFCBPTR  DS    AL4                                                      06464000
         ORG   RENTS+124                                                06465000
RDJXPTR  DS    AL4                                                      06466000
DPLNDP   DS    AL4                                                      06467000
ONMIDP   DS    AL4                                                      06468000
NNMIDP   DS    AL4                                                      06469000
PTPBPTR  DS    AL4                                                      06470000
RCPTR    DS    AL4                                                      06471000
LEVLP    DS    AL4                                                      06472000
RINBUFP  DS    AL4                                                      06473000
REXBUFP  DS    AL4                                                      06474000
TSTLVL   DS    AL4                                                      06475000
TOPLVL   DS    AL4                                                      06476000
TSOTROF  DS    AL4                                                      06477000
SOFFS    DS    AL2                                                      06478000
MSGNO    DS    AL2                                                      06479000
MOFFNO   DS    AL4                                                      06480000
MSGN2    DS    AL2                                                      06481000
MSGN3    DS    AL2                                                      06482000
MSGPTR   DS    AL4                                                      06483000
STASAVN  DS    18A                                                      06484000
STASAV   DS    18A                                                      06485000
STARC    DS    AL4                                                      06486000
STARAD   DS    AL4                                                      06487000
LIMIT    DS    FL2                                                      06488000
DOWHYL   DS    FL2                                                      06489000
DOWHYLN  DS    FL2                                                      06490000
DOWHYLR  DS    FL2                                                      06491000
DOWHYLT  DS    FL2                                                      06492000
DOWHYL2  DS    FL2                                                      06493000
DOWHYL3  DS    FL2                                                      06494000
DOWHYL4  DS    FL2                                                      06495000
DOWHYL5  DS    FL2                                                      06496000
DOWHYL6  DS    FL2                                                      06497000
BSPCTR   DS    FL2                                                      06498000
START2   DS    FL2                                                      06499000
SVFSQEL  DS    AL2                                                      06500000
         DS    CL2                                                      06501000
RFCTLR   DS    BL6                                                      06502000
         ORG   RFCTLR                                                   06503000
QUITFLG  DS    BL1                                                      06504000
         ORG   QUITFLG                                                  06505000
QUITCHK  DS    BL1                                                      06506000
         ORG   QUITCHK                                                  06507000
UIDQUIT  DS    BL1                                                      06508000
TERMCHK  EQU   QUITCHK+0                                                06509000
         ORG   TERMCHK                                                  06510000
RFMQUIT  EQU   TERMCHK+0                                                06511000
RENDOF   EQU   TERMCHK+0                                                06512000
         ORG   RFCTLR+0                                                 06513000
QUITRES  EQU   RFCTLR+0                                                 06514000
         DS    CL1                                                      06515000
PLFAIL   DS    BL1                                                      06516000
DIREND   EQU   RFCTLR+1                                                 06517000
STASET   EQU   RFCTLR+1                                                 06518000
STANOW   EQU   RFCTLR+1                                                 06519000
STACLOS  EQU   RFCTLR+1                                                 06520000
SNGLVL   EQU   RFCTLR+1                                                 06521000
RDINTL   EQU   RFCTLR+1                                                 06522000
RDDONE   EQU   RFCTLR+1                                                 06523000
STODON   DS    BL1                                                      06524000
RD1NOW   EQU   RFCTLR+2                                                 06525000
OPMODE   EQU   RFCTLR+2                                                 06526000
         ORG   OPMODE                                                   06527000
TSONOW   EQU   OPMODE+0                                                 06528000
OPRES    EQU   OPMODE+0                                                 06529000
         ORG   RFCTLR+3                                                 06530000
CHAINOW  DS    BL1                                                      06531000
EQUIUAD  EQU   RFCTLR+3                                                 06532000
PLNOW    EQU   RFCTLR+3                                                 06533000
XTRBLK   EQU   RFCTLR+3                                                 06534000
XTRBNOW  EQU   RFCTLR+3                                                 06535000
MSGNOW   EQU   RFCTLR+3                                                 06536000
NQMNOW   EQU   RFCTLR+3                                                 06537000
HDRPRT   EQU   RFCTLR+3                                                 06538000
CURNEW   DS    BL1                                                      06539000
ACTNOW   EQU   RFCTLR+4                                                 06540000
RESFLGS  EQU   RFCTLR+4                                                 06541000
         ORG   RENTS+376                                                06542000
RTNCDAR  DS    CL8                                                      06543000
         ORG   RTNCDAR                                                  06544000
RTNCODE  DS    FL4                                                      06545000
         ORG   RTNCODE                                                  06546000
RTNCRS2  DS    CL2                                                      06547000
         ORG   RTNCRS2                                                  06548000
RTNCRS1  DS    CL1                                                      06549000
ABNCCHS  DS    CL3                                                      06550000
         ORG   RTNCODE+2                                                06551000
RTNCCHS  DS    CL3                                                      06552000
         ORG   RTNCCHS                                                  06553000
USERCDE  DS    CL2                                                      06554000
         ORG   RTNCODE+5                                                06555000
RTNCRS   DS    CL3                                                      06556000
         ORG   RENTS+384                                                06557000
DIRWA    DS    CL344                                                    06558000
         ORG   DIRWA                                                    06559000
RDIDCB   DS    CL88                                                     06560000
DIRBLK   DS    CL256                                                    06561000
         ORG   RENTS+728                                                06562000
CURDIRP  DS    AL4                                                      06563000
DIRBLKP  DS    AL4                                                      06564000
DRBLASP  DS    AL4                                                      06565000
DIRBDAP  DS    AL4                                                      06566000
OLRDBUFL DS    AL4                                                      06567000
COMPNAM  DS    CL8                                                      06568000
         DS    CL4                                                      06569000
DBLWORD  DS    CL8                                                      06570000
         ORG   DBLWORD                                                  06571000
DBLWD1   DS    CL4                                                      06572000
DBLWD2   DS    CL4                                                      06573000
         ORG   RENTS+768                                                06574000
RDJINAA  DS    CL180                                                    06575000
         ORG   RDJINAA                                                  06576000
RDJNXL   DS    AL4                                                      06577000
RDJINA   DS    CL176                                                    06578000
         ORG   RENTS+948                                                06579000
RDJEXAA  DS    CL180                                                    06580000
         ORG   RDJEXAA                                                  06581000
RDJXXL   DS    AL4                                                      06582000
RDJEXA   DS    CL176                                                    06583000
         ORG   RENTS+1128                                               06584000
DIRBCAX  DS    CL1                                                      06585000
         ORG   DIRBCAX                                                  06586000
DIRBTX   DS    BL1                                                      06587000
DIRBCX   EQU   DIRBCAX+0                                                06588000
         ORG   RENTS+1129                                               06589000
SVTTR    DS    CL3                                                      06590000
TMSGNS1  DS    CL28                                                     06591000
         ORG   TMSGNS1                                                  06592000
TMSGNNO1 DS    AL4                                                      06593000
TMSGNP10 DS    AL4                                                      06594000
TMSGNP12 DS    AL4                                                      06595000
TMSGNP13 DS    AL4                                                      06596000
TMSGNP14 DS    AL4                                                      06597000
TMSGNP15 DS    AL4                                                      06598000
TMSGNP16 DS    AL4                                                      06599000
         ORG   RENTS+1160                                               06600000
TMSGNS2  DS    CL28                                                     06601000
         ORG   TMSGNS2                                                  06602000
TMSGNNO2 DS    AL4                                                      06603000
TMSGNP21 DS    AL4                                                      06604000
TMSGNP22 DS    AL4                                                      06605000
TMSGNP23 DS    AL4                                                      06606000
TMSGNP24 DS    AL4                                                      06607000
TMSGNP25 DS    AL4                                                      06608000
TMSGNP26 DS    AL4                                                      06609000
         ORG   RENTS+1188                                               06610000
TMSGTIX1 DS    CL150                                                    06611000
         ORG   TMSGTIX1                                                 06612000
TMSGTIL1 DS    AL2                                                      06613000
TMSGTIO1 DS    AL2                                                      06614000
TMSGTIN1 DS    CL146                                                    06615000
         ORG   RENTS+1338                                               06616000
TMSGTIX2 DS    CL150                                                    06617000
         ORG   TMSGTIX2                                                 06618000
TMSGTIL2 DS    AL2                                                      06619000
TMSGTIO2 DS    AL2                                                      06620000
TMSGTIN2 DS    CL146                                                    06621000
         ORG   RENTS+1488                                               06622000
RWPB     DS    CL24                                                     06623000
         ORG   RWPB                                                     06624000
RWPBA    DS    BL24                                                     06625000
         ORG   RWPBA                                                    06626000
RWPFGS   DS    BL1                                                      06627000
         ORG   RWPFGS                                                   06628000
RWPF1    DS    BL1                                                      06629000
RWPF2    EQU   RWPFGS+0                                                 06630000
RWPF3    EQU   RWPFGS+0                                                 06631000
RWPF4    EQU   RWPFGS+0                                                 06632000
RWPF5    EQU   RWPFGS+0                                                 06633000
RWPF6    EQU   RWPFGS+0                                                 06634000
RWPF7    EQU   RWPFGS+0                                                 06635000
RWPF8    EQU   RWPFGS+0                                                 06636000
         ORG   RWPBA+1                                                  06637000
RWPUDP   DS    AL3                                                      06638000
RWPNBP   DS    AL4                                                      06639000
RWPWAP   DS    AL4                                                      06640000
RWPRBP   DS    AL4                                                      06641000
RWPNOM   DS    AL1                                                      06642000
RWPBUF   DS    AL3                                                      06643000
RWPAPL   DS    AL4                                                      06644000
         ORG   RWPAPL                                                   06645000
RWPCHR   DS    CL1                                                      06646000
RWPARP   DS    AL3                                                      06647000
         ORG   RENTS+1512                                               06648000
STAEPL1  DS    CL16                                                     06649000
         ORG   STAEPL1                                                  06650000
STAPRM1  DS    AL4                                                      06651000
STAPRM2  DS    AL4                                                      06652000
STAPRM3  DS    AL4                                                      06653000
STAPRM4  DS    AL4                                                      06654000
         ORG   RENTS+1528                                               06655000
SPAZPB   DS    CL12                                                     06656000
         ORG   SPAZPB                                                   06657000
SPZBUFP  DS    AL4                                                      06658000
SPZBLKN  DS    FL2                                                      06659000
SPZBLNG  DS    FL2                                                      06660000
SPZBLOC  DS    AL4                                                      06661000
         ORG   RENTS+1540                                               06662000
PLOUT    DS    CL24                                                     06663000
         ORG   PLOUT                                                    06664000
PLOUTA   DS    CL12                                                     06665000
         ORG   PLOUTA                                                   06666000
AUPTP    DS    AL4                                                      06667000
AECTP    DS    AL4                                                      06668000
AECBP    DS    AL4                                                      06669000
         ORG   PLOUT+12                                                 06670000
ACBFP    DS    AL4                                                      06671000
         ORG   ACBFP                                                    06672000
PLOUTB   DS    CL4                                                      06673000
         ORG   PLOUT+16                                                 06674000
PLOUTC   DS    CL8                                                      06675000
         ORG   PLOUTC                                                   06676000
PLOUTZ   DS    BL8                                                      06677000
         ORG   RENTS+1564                                               06678000
STOLST   DS    CL14                                                     06679000
         ORG   STOLST                                                   06680000
STLUSER  DS    CL8                                                      06681000
STLTTRC  DS    AL3                                                      06682000
STLCTUA  DS    AL1                                                      06683000
         ORG   STLCTUA                                                  06684000
STLALYS  DS    BL1                                                      06685000
STLTTCT  EQU   STLCTUA+0                                                06686000
STLUSCT  EQU   STLCTUA+0                                                06687000
         ORG   STOLST+12                                                06688000
STLBYT1  DS    BL1                                                      06689000
         ORG   STLBYT1                                                  06690000
STLIRES  DS    BL1                                                      06691000
         ORG   STOLST+13                                                06692000
STLBYT2  DS    BL1                                                      06693000
         ORG   STLBYT2                                                  06694000
@NM00001 DS    BL1                                                      06695000
         ORG   RENTS+1580                                               06696000
BASPTRS  DS    CL20                                                     06697000
         ORG   BASPTRS                                                  06698000
BASUPTP  DS    AL4                                                      06699000
BASECTP  DS    AL4                                                      06700000
BASECBP  DS    AL4                                                      06701000
BASEBFP  DS    AL4                                                      06702000
BASERSP  DS    AL4                                                      06703000
         ORG   RENTS+1600                                               06704000
GMAINL   DS    AL4                                                      06705000
GMAINP   DS    AL4                                                      06706000
PBOUT    DS    CL20                                                     06707000
NODIDL   DS    AL2                                                      06708000
CURDIRN  DS    CL14                                                     06709000
         ORG   CURDIRN                                                  06710000
CURUSER  DS    CL8                                                      06711000
         ORG   CURUSER                                                  06712000
NODIDC   DS    CL8                                                      06713000
         ORG   RENTS+1644                                               06714000
NQMIDC   DS    CL8                                                      06715000
NQMIDL   DS    AL2                                                      06716000
         DS    CL2                                                      06717000
REFMECB  DS    BL4                                                      06718000
         ORG   REFMECB                                                  06719000
ECBCODE  DS    AL4                                                      06720000
         ORG   ECBCODE                                                  06721000
ECBWT    DS    BL1                                                      06722000
ECBCPL   EQU   ECBCODE+0                                                06723000
         ORG   RENTS+1660                                               06724000
RETURNC  DS    AL4                                                      06725000
RWPBSAV  DS    CL24                                                     06726000
         ORG   RWPBSAV                                                  06727000
@NM00002 DS    CL12                                                     06728000
RWPSDR   DS    CL4                                                      06729000
@NM00003 DS    CL8                                                      06730000
         ORG   RENTS+1688                                               06731000
OLNOBLK  DS    FL2                                                      06732000
IDINCB   DS    FL2                                                      06733000
NUMBLKS  DS    FL2                                                      06734000
         DS    CL2                                                      06735000
IDSLASP  DS    AL4                                                      06736000
LINPTR   DS    AL4                                                      06737000
MAXLINP  DS    AL4                                                      06738000
IDLPOSR  DS    AL2                                                      06739000
IDSCT    DS    AL2                                                      06740000
OLRPL    DS    CL121                                                    06741000
         ORG   OLRPL                                                    06742000
OLARP    DS    AL4                                                      06743000
OCRP     DS    AL4                                                      06744000
OUOFFS   DS    CL12                                                     06745000
         ORG   OUOFFS                                                   06746000
OUOFFLG  DS    CL1                                                      06747000
         ORG   OUOFFLG                                                  06748000
OUOFLG1  DS    BL1                                                      06749000
@NM00004 EQU   OUOFFLG+0                                                06750000
@NM00005 EQU   OUOFFLG+0                                                06751000
@NM00006 EQU   OUOFFLG+0                                                06752000
@NM00007 EQU   OUOFFLG+0                                                06753000
@NM00008 EQU   OUOFFLG+0                                                06754000
@NM00009 EQU   OUOFFLG+0                                                06755000
@NM00010 EQU   OUOFFLG+0                                                06756000
         ORG   OUOFFS+1                                                 06757000
OUOFNEX  DS    AL3                                                      06758000
OUOFSUB  DS    AL4                                                      06759000
OUOFDAT  DS    AL4                                                      06760000
         ORG   OLRPL+20                                                 06761000
OUFLOC   DS    AL4                                                      06762000
OUDLOC   DS    AL4                                                      06763000
OUCLS    DS    CL1                                                      06764000
         ORG   OUCLS                                                    06765000
OUCLSF1  DS    BL1                                                      06766000
@NM00011 EQU   OUCLS+0                                                  06767000
@NM00012 EQU   OUCLS+0                                                  06768000
@NM00013 EQU   OUCLS+0                                                  06769000
@NM00014 EQU   OUCLS+0                                                  06770000
@NM00015 EQU   OUCLS+0                                                  06771000
@NM00016 EQU   OUCLS+0                                                  06772000
@NM00017 EQU   OUCLS+0                                                  06773000
         ORG   OLRPL+29                                                 06774000
@NM00018 DS    CL3                                                      06775000
OUSRDTN  DS    AL2                                                      06776000
OUSRDCN  DS    AL2                                                      06777000
OPOFFS   DS    CL12                                                     06778000
         ORG   OPOFFS                                                   06779000
OPOFFLG  DS    CL1                                                      06780000
         ORG   OPOFFLG                                                  06781000
OPOFLG1  DS    BL1                                                      06782000
@NM00019 EQU   OPOFFLG+0                                                06783000
@NM00020 EQU   OPOFFLG+0                                                06784000
@NM00021 EQU   OPOFFLG+0                                                06785000
@NM00022 EQU   OPOFFLG+0                                                06786000
@NM00023 EQU   OPOFFLG+0                                                06787000
@NM00024 EQU   OPOFFLG+0                                                06788000
@NM00025 EQU   OPOFFLG+0                                                06789000
         ORG   OPOFFS+1                                                 06790000
OPOFNEX  DS    AL3                                                      06791000
OPOFSUB  DS    AL4                                                      06792000
OPOFDAT  DS    AL4                                                      06793000
         ORG   OLRPL+48                                                 06794000
OPFLOC   DS    AL4                                                      06795000
OPDLOC   DS    AL4                                                      06796000
OPCLS    DS    CL1                                                      06797000
@NM00026 DS    CL3                                                      06798000
OPSWDTN  DS    AL2                                                      06799000
OPSWDCN  DS    AL2                                                      06800000
OAOFFS   DS    CL12                                                     06801000
         ORG   OAOFFS                                                   06802000
OAOFFLG  DS    CL1                                                      06803000
         ORG   OAOFFLG                                                  06804000
OAOFLG1  DS    BL1                                                      06805000
@NM00027 EQU   OAOFFLG+0                                                06806000
@NM00028 EQU   OAOFFLG+0                                                06807000
@NM00029 EQU   OAOFFLG+0                                                06808000
@NM00030 EQU   OAOFFLG+0                                                06809000
@NM00031 EQU   OAOFFLG+0                                                06810000
@NM00032 EQU   OAOFFLG+0                                                06811000
@NM00033 EQU   OAOFFLG+0                                                06812000
         ORG   OAOFFS+1                                                 06813000
OAOFNEX  DS    AL3                                                      06814000
OAOFSUB  DS    AL4                                                      06815000
OAOFDAT  DS    AL4                                                      06816000
         ORG   OLRPL+76                                                 06817000
OAFLOC   DS    AL4                                                      06818000
OADLOC   DS    AL4                                                      06819000
OACLS    DS    CL1                                                      06820000
@NM00034 DS    CL3                                                      06821000
OACCTTN  DS    AL2                                                      06822000
OACCTCN  DS    AL2                                                      06823000
OROFFS   DS    CL12                                                     06824000
         ORG   OROFFS                                                   06825000
OROFFLG  DS    CL1                                                      06826000
         ORG   OROFFLG                                                  06827000
OROFLG1  DS    BL1                                                      06828000
@NM00035 EQU   OROFFLG+0                                                06829000
@NM00036 EQU   OROFFLG+0                                                06830000
@NM00037 EQU   OROFFLG+0                                                06831000
@NM00038 EQU   OROFFLG+0                                                06832000
@NM00039 EQU   OROFFLG+0                                                06833000
@NM00040 EQU   OROFFLG+0                                                06834000
@NM00041 EQU   OROFFLG+0                                                06835000
         ORG   OROFFS+1                                                 06836000
OROFNEX  DS    AL3                                                      06837000
OROFSUB  DS    AL4                                                      06838000
OROFDAT  DS    AL4                                                      06839000
         ORG   OLRPL+104                                                06840000
ORFLOC   DS    AL4                                                      06841000
ORDLOC   DS    AL4                                                      06842000
ORCLS    DS    CL1                                                      06843000
@NM00042 DS    CL3                                                      06844000
ORCNMTN  DS    AL2                                                      06845000
ORCNMCN  DS    AL2                                                      06846000
OEND     DS    BL1                                                      06847000
         ORG   RENTS+1836                                               06848000
NLRPL    DS    CL121                                                    06849000
         ORG   NLRPL                                                    06850000
NLARP    DS    AL4                                                      06851000
NCRP     DS    AL4                                                      06852000
NUOFFS   DS    CL12                                                     06853000
         ORG   NUOFFS                                                   06854000
NUOFFLG  DS    CL1                                                      06855000
         ORG   NUOFFLG                                                  06856000
NUOFLG1  DS    BL1                                                      06857000
@NM00043 EQU   NUOFFLG+0                                                06858000
@NM00044 EQU   NUOFFLG+0                                                06859000
@NM00045 EQU   NUOFFLG+0                                                06860000
@NM00046 EQU   NUOFFLG+0                                                06861000
@NM00047 EQU   NUOFFLG+0                                                06862000
@NM00048 EQU   NUOFFLG+0                                                06863000
@NM00049 EQU   NUOFFLG+0                                                06864000
         ORG   NUOFFS+1                                                 06865000
NUOFNEX  DS    AL3                                                      06866000
NUOFSUB  DS    AL4                                                      06867000
NUOFDAT  DS    AL4                                                      06868000
         ORG   NLRPL+20                                                 06869000
NUFLOC   DS    AL4                                                      06870000
NUDLOC   DS    AL4                                                      06871000
NUCLS    DS    CL1                                                      06872000
         ORG   NUCLS                                                    06873000
NUCLSF1  DS    BL1                                                      06874000
@NM00050 EQU   NUCLS+0                                                  06875000
@NM00051 EQU   NUCLS+0                                                  06876000
@NM00052 EQU   NUCLS+0                                                  06877000
@NM00053 EQU   NUCLS+0                                                  06878000
@NM00054 EQU   NUCLS+0                                                  06879000
@NM00055 EQU   NUCLS+0                                                  06880000
@NM00056 EQU   NUCLS+0                                                  06881000
         ORG   NLRPL+29                                                 06882000
@NM00057 DS    CL3                                                      06883000
NUSRDTN  DS    AL2                                                      06884000
NUSRDCN  DS    AL2                                                      06885000
NPOFFS   DS    CL12                                                     06886000
         ORG   NPOFFS                                                   06887000
NPOFFLG  DS    CL1                                                      06888000
         ORG   NPOFFLG                                                  06889000
NPOFLG1  DS    BL1                                                      06890000
@NM00058 EQU   NPOFFLG+0                                                06891000
@NM00059 EQU   NPOFFLG+0                                                06892000
@NM00060 EQU   NPOFFLG+0                                                06893000
@NM00061 EQU   NPOFFLG+0                                                06894000
@NM00062 EQU   NPOFFLG+0                                                06895000
@NM00063 EQU   NPOFFLG+0                                                06896000
@NM00064 EQU   NPOFFLG+0                                                06897000
         ORG   NPOFFS+1                                                 06898000
NPOFNEX  DS    AL3                                                      06899000
NPOFSUB  DS    AL4                                                      06900000
NPOFDAT  DS    AL4                                                      06901000
         ORG   NLRPL+48                                                 06902000
NPFLOC   DS    AL4                                                      06903000
NPDLOC   DS    AL4                                                      06904000
NPCLS    DS    CL1                                                      06905000
@NM00065 DS    CL3                                                      06906000
NPSWDTN  DS    AL2                                                      06907000
NPSWDCN  DS    AL2                                                      06908000
NAOFFS   DS    CL12                                                     06909000
         ORG   NAOFFS                                                   06910000
NAOFFLG  DS    CL1                                                      06911000
         ORG   NAOFFLG                                                  06912000
NAOFLG1  DS    BL1                                                      06913000
@NM00066 EQU   NAOFFLG+0                                                06914000
@NM00067 EQU   NAOFFLG+0                                                06915000
@NM00068 EQU   NAOFFLG+0                                                06916000
@NM00069 EQU   NAOFFLG+0                                                06917000
@NM00070 EQU   NAOFFLG+0                                                06918000
@NM00071 EQU   NAOFFLG+0                                                06919000
@NM00072 EQU   NAOFFLG+0                                                06920000
         ORG   NAOFFS+1                                                 06921000
NAOFNEX  DS    AL3                                                      06922000
NAOFSUB  DS    AL4                                                      06923000
NAOFDAT  DS    AL4                                                      06924000
         ORG   NLRPL+76                                                 06925000
NAFLOC   DS    AL4                                                      06926000
NADLOC   DS    AL4                                                      06927000
NACLS    DS    CL1                                                      06928000
@NM00073 DS    CL3                                                      06929000
NACCTTN  DS    AL2                                                      06930000
NACCTCN  DS    AL2                                                      06931000
NROFFS   DS    CL12                                                     06932000
         ORG   NROFFS                                                   06933000
NROFFLG  DS    CL1                                                      06934000
         ORG   NROFFLG                                                  06935000
NROFLG1  DS    BL1                                                      06936000
@NM00074 EQU   NROFFLG+0                                                06937000
@NM00075 EQU   NROFFLG+0                                                06938000
@NM00076 EQU   NROFFLG+0                                                06939000
@NM00077 EQU   NROFFLG+0                                                06940000
@NM00078 EQU   NROFFLG+0                                                06941000
@NM00079 EQU   NROFFLG+0                                                06942000
@NM00080 EQU   NROFFLG+0                                                06943000
         ORG   NROFFS+1                                                 06944000
NROFNEX  DS    AL3                                                      06945000
NROFSUB  DS    AL4                                                      06946000
NROFDAT  DS    AL4                                                      06947000
         ORG   NLRPL+104                                                06948000
NRFLOC   DS    AL4                                                      06949000
NRDLOC   DS    AL4                                                      06950000
NRCLS    DS    CL1                                                      06951000
@NM00081 DS    CL3                                                      06952000
NRCNMTN  DS    AL2                                                      06953000
NRCNMCN  DS    AL2                                                      06954000
NEND     DS    BL1                                                      06955000
         ORG   RENTS+1960                                               06956000
IDSBUF   DS    CL1080                                                   06957000
         ORG   IDSBUF                                                   06958000
IDSLINS  DS    CL108                                                    06959000
         ORG   IDSLINS+0                                                06960000
IDSLNEX  DS    AL4                                                      06961000
IDSLLNG  DS    AL2                                                      06962000
IDSLOFF  DS    AL2                                                      06963000
IDSLTXT  DS    CL100                                                    06964000
         ORG   RENTSR+3040                                              06965000
IKJRBBU0 CSECT                                                          06966000
         DS    0F                                                       06967000
@SIZDATD DC    AL1(1)                                                   06968000
         DC    AL3(@ENDDATD-@DATD)                                      06969000
@SIZ001  EQU   @SIZDATD                                                 06970000
@CV00037 DC    V(IKJEFA51)                                              06971000
@CV00038 DC    V(IKJEFA52)                                              06972000
@CV00039 DC    V(IKJEFA53)                                              06973000
@CV00040 DC    V(ANDXL)                                                 06974000
         DS    0D                                                       06975000
MSK1FW   DS    AL4                                                      06976000
         ORG   MSK1FW                                                   06977000
MSK1F    DC    X'1F'                                                    06978000
MSK1FA   DC    X'000000'                                                06979000
         ORG   MSK1FW+4                                                 06980000
MSK07W   DS    AL4                                                      06981000
         ORG   MSK07W                                                   06982000
MSK07    DC    X'07'                                                    06983000
MSK07A   DC    X'000000'                                                06984000
         ORG   MSK07W+4                                                 06985000
MINBLK   DC    A(256)                                                   06986000
LSPAN    DC    AL4(OPOFFS-OUOFFS)                                       06987000
HDRDIF   DC    AL1(36)                                                  06988000
@CC01862 DC    C'NULLFILE'                                              06989000
@CC01934 DC    C'       '                                               06990000
@CB02062 DC    X'0B01'                                                  06991000
         DS    CL2                                                      06992000
MEXTHD   DS    CL36                                                     06993000
         ORG   MEXTHD                                                   06994000
HXSPERP  DC    A(0)                                                     06995000
HXDESTN  DC    8X'00'                                                   06996000
HXRESSP  DC    24X'00'                                                  06997000
         ORG   MEXTHD+36                                                06998000
HEXTBL   DC    CL16'0123456789ABCDEF'                                   06999000
FLAGMSK  DC    X'607B204100'                                            07000000
ENDMSK   DC    X'FFFFFFFFFFFFFFFF'                                      07001000
RNDDWN   DC    X'FFFC'                                                  07002000
HIORDR1  DC    X'80000000'                                              07003000
HIORDR3  DC    B'11100000'                                              07004000
SPOSTB   DS    BL4                                                      07005000
         ORG   SPOSTB                                                   07006000
SPOSTA   DC    B'01000000'                                              07007000
         ORG   SPOSTA                                                   07008000
SPOST1   DS    BL1                                                      07009000
SPOST3   EQU   SPOSTA+0                                                 07010000
         ORG   SPOSTB+1                                                 07011000
SPOSTCD  DC    X'000000'                                                07012000
         ORG   SPOSTB+4                                                 07013000
EQNAM1   DC    CL8'SYSIKJUA'                                            07014000
ERNAM1   DC    CL8'OPENUADS'                                            07015000
@DATD    DSECT                                                          07016000
IKJRBBU0 CSECT                                                          07017000
XCOP     XC    0(1,RTO),0(RFROM)      LARGE SCALE CHAR OP (XC)          07018000
MVCOP    MVC   0(1,RTO),0(RFROM)      LARGE SCALE CHAR OP (MVC)         07019000
MSTAEL1  STAE  STAEXIN,MF=L,PURGE=NONE  FOR ABEND EXIT                  07020000
MRDJLST  RDJFCB  (MRINDCB,,MREXDCB),MF=L  FOR RDJFCB -- INPUT,OUTPUT    07021000
MRINDCB  DCB   DDNAME=SYSUADN,DSORG=PO,MACRF=(R,W),RECFM=FB,KEYLEN=0    07022000
MREXDCB  DCB   DDNAME=SYSUADS,DSORG=PO,MACRF=(R,W),RECFM=FB,KEYLEN=0    07023000
DCBLG    EQU   *-MREXDCB              LENGTH OF DCB                     07024000
MVCLNG1  EQU   *-MSTAEL1              LENGTH OF INITIALIZATION BLOCK    07025000
MNQOPN   ENQ   (EQNAM1,ERNAM1,S,8,SYSTEM),RET=USE,MF=L  FOR OPEN ENQ    07026000
MRUOPNL  OPEN  (,(UPDAT)),MF=L        FOR OPEN -- UPDATE                07027000
MRNOPNL  OPEN  (,(INPUT)),MF=L        FOR OPEN -- INPUT                 07028000
MRXOPNL  OPEN  (,(OUTPUT)),MF=L       FOR OPEN -- OUTPUT                07029000
MRDOPNL  OPEN  (,(INPUT)),MF=L        FOR OPEN -- DIRECTORY INPUT       07030000
MNQMBR   ENQ   (EQNAM1,,E,8,SYSTEM),RET=USE,MF=L   FOR MEMBER ENQUEUE   07031000
MDQMBR   DEQ   (EQNAM1,,8,SYSTEM),RET=HAVE,MF=L    FOR MEMBER DEQUEUE   07032000
MRLCLSL  CLOSE (,),MF=L               FOR CLOSE                         07033000
MDQOPN   DEQ    (EQNAM1,ERNAM1,8,SYSTEM),RET=HAVE,MF=L   FOR OPEN DEQ   07034000
MPTPBK   PUTLINE  OUTPUT=(0,TERM,SINGLE,INFOR),MF=L    FOR PUTLINE      07035000
MPTPBKM  PUTLINE  OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L   FOR PUTLINE      07036000
MPTPBDM  PUTLINE  OUTPUT=(0,TERM,MULTLIN,DATA),MF=L   FOR PUTLINE(DATA) 07037000
PTPBLG   EQU   *-MPTPBDM              LENGTH OF PUTLINE PARM BLOCK      07038000
MPTLCPL  LINK  EP=IKJPUTL,SF=L        FOR PUTLINE(LINK)                 07039000
MGMLST   GETMAIN  ,MF=L               FOR GETMAIN                       07040000
MFMLST   FREEMAIN  ,MF=L              FOR FREEMAIN                      07041000
MVCLNG2  EQU   *-MNQOPN               LENGTH OF INITIALIZATION BLOCK    07042000
*  NOTE -- THE ABOVE LIST OF MACROS (MSTAEL1 THRU MFMLST) MUST BE KEPT  07043000
*     PARALLEL BY ITEM AND SEQUENCE WITH LIST STARTING WITH STAEL1      07044000
MRDIDCB  DCB   DDNAME=SYSUADN,DEVD=DA,DSORG=PS,MACRF=(RP),             S07045000
               RECFM=F,KEYLEN=0,BLKSIZE=256                             07046000
DIRDLG   EQU   *-MRDIDCB              LENGTH OF DCB                     07047000
         DS    0F                                                       07048000
RPATCHN  DC    C'RPATCH  '                                              07049000
RPATCH   DS    400C                                                     07050000
@DATD    DSECT                        RE-ESTABLISH AUTOMATIC DSECT      07051000
@DATD    DSECT                                                          07052000
@DATD   DSECT                                                           07053000
*                                                                       07054000
*        CREATE AREAS FOR PARAMETER LISTS, CONTROL BLOCKS               07055000
STAEL1   STAE  STAEXIN,MF=L           FOR ABEND EXIT                    07056000
STALNG   EQU   *-STAEL1               LENGTH OF STAE  C P  PARM LIST    07057000
RDJLST   RDJFCB  (RINDCB,,REXDCB),MF=L FOR RDJFCB -- INPUT,OUTPUT       07058000
RDJLNG   EQU   *-RDJLST               LENGTH OF RDJFCB PARM LIST        07059000
RINDCB   DCB   DDNAME=SYSUADN,DSORG=PO,MACRF=(R,W),RECFM=FT             07060000
REXDCB   DCB   DDNAME=SYSUADS,DSORG=PO,MACRF=(R,W),RECFM=FT             07061000
NQOPN    ENQ   (,,,,),MF=L            FOR OPEN ENQUEUE                  07062000
NQLNG    EQU   *-NQOPN                LENGTH OF ENQUEUE PARM BLOCK      07063000
RUOPNL   OPEN  (,),MF=L               FOR OPEN -- UPDAT                 07064000
RNOPNL   OPEN  (,),MF=L               FOR OPEN -- INPUT                 07065000
RXOPNL   OPEN  (,),MF=L               FOR OPEN -- OUTPUT                07066000
RXOPNLG  EQU   *-RXOPNL               LENGTH OF OPEN  C P  PARM LIST    07067000
RDOPNL   OPEN  (,),MF=L               FOR OPEN -- DIRECTORY INPUT       07068000
NQMBR    ENQ   (,,,,),MF=L            FOR MEMBER ENQUEUE                07069000
DQMBR    DEQ   (,,,),MF=L             FOR DEQUEUE                       07070000
RLCLSL   CLOSE (,),MF=L               FOR CLOSE                         07071000
RLCLSLG  EQU   *-RLCLSL               LENGTH OF CLOSE  C P  PARM LIST   07072000
DQOPN    DEQ   (,,,),MF=L             FOR OPEN DEQUEUE                  07073000
DQLNG    EQU   *-DQOPN                LENGTH OF DEQUEUE PARM BLOCK      07074000
PTPBK    PUTLINE  ,MF=L               FOR PUTLINE                       07075000
PTPBKM   PUTLINE  ,MF=L               FOR PUTLINE                       07076000
PTPBDM   PUTLINE  ,MF=L               FOR PUTLINE(DATA)                 07077000
PTLCPL   LINK   EP=IKJPUTL,SF=L       FOR PUTLINE(LINK)                 07078000
LNKLNG   EQU   *-PTLCPL               LENGTH OF LINK CP PARM LIST       07079000
GMLST    GETMAIN  ,MF=L               FOR GETMAIN                       07080000
FMLST    FREEMAIN  ,MF=L              FOR FREEMAIN                      07081000
*  NOTE -- THE ABOVE LIST OF MACROS (STAEL1 THRU FMLST) MUST BE KEPT    07082000
*     PARALLEL BY ITEM AND SEQUENCE WITH LIST STARTING WITH MSTAEL1     07083000
*RDIDCB  IS    PART OF THE DIRECTORY WORK AREA, DIRWA                   07084000
@DATD    DSECT                                                          07085000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07086000
@ENDDATD EQU   *                                                        07087000
@DATEND  EQU   *                                                        07088000
IKJRBBU0 CSECT                                                          07089000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07090000
@01      EQU   01                                                       07091000
@02      EQU   02                                                       07092000
@03      EQU   03                                                       07093000
@04      EQU   04                                                       07094000
@05      EQU   05                                                       07095000
@06      EQU   06                                                       07096000
@07      EQU   07                                                       07097000
@08      EQU   08                                                       07098000
@09      EQU   09                                                       07099000
@10      EQU   10                                                       07100000
@11      EQU   11                                                       07101000
@12      EQU   12                                                       07102000
@13      EQU   13                                                       07103000
@14      EQU   14                                                       07104000
@15      EQU   15                                                       07105000
@0       EQU   00                                                       07106000
@1       EQU   01                                                       07107000
@2       EQU   02                                                       07108000
@3       EQU   03                                                       07109000
@4       EQU   04                                                       07110000
@5       EQU   05                                                       07111000
@6       EQU   06                                                       07112000
@7       EQU   07                                                       07113000
@8       EQU   08                                                       07114000
@9       EQU   09                                                       07115000
@A       EQU   10                                                       07116000
@B       EQU   11                                                       07117000
@C       EQU   12                                                       07118000
@D       EQU   13                                                       07119000
@E       EQU   14                                                       07120000
@F       EQU   15                                                       07121000
R0       EQU   @00                                                      07122000
R1       EQU   @01                                                      07123000
R2       EQU   @02                                                      07124000
R5       EQU   @05                                                      07125000
R6       EQU   @06                                                      07126000
R9       EQU   @09                                                      07127000
R10      EQU   @10                                                      07128000
R11      EQU   @11                                                      07129000
R12      EQU   @12                                                      07130000
R13      EQU   @13                                                      07131000
R14      EQU   @14                                                      07132000
R15      EQU   @15                                                      07133000
PPPPTR   EQU   @04                                                      07134000
QNAMR    EQU   @05                                                      07135000
QLNGR    EQU   @06                                                      07136000
SWRKAP   EQU   @01                                                      07137000
RSPW     EQU   @02                                                      07138000
RSPZOP   EQU   @03                                                      07139000
RLNG     EQU   @04                                                      07140000
RFROM    EQU   @05                                                      07141000
RTO      EQU   @06                                                      07142000
R3       EQU   @03                                                      07143000
R4       EQU   @04                                                      07144000
R7       EQU   @07                                                      07145000
R8       EQU   @08                                                      07146000
RTCLIST  EQU   0                                                        07147000
RCLC1    EQU   RTCLIST+3                                                07148000
SAVAR    EQU   4                                                        07149000
OLHEDB   EQU   0                                                        07150000
OLBASHD  EQU   OLHEDB                                                   07151000
OLEXTHD  EQU   OLHEDB+28                                                07152000
NUHEDB   EQU   0                                                        07153000
NUBASHD  EQU   NUHEDB                                                   07154000
NUEXTHD  EQU   NUHEDB+28                                                07155000
STAENPL  EQU   0                                                        07156000
RINBUF   EQU   0                                                        07157000
REXBUF   EQU   0                                                        07158000
MOFFNC   EQU   0                                                        07159000
MIDSLIN  EQU   0                                                        07160000
MIDSHDR  EQU   MIDSLIN                                                  07161000
MIDSLLG  EQU   MIDSHDR+4                                                07162000
MIDSLTX  EQU   MIDSLIN+8                                                07163000
MIDSNAM  EQU   MIDSLTX                                                  07164000
IDSLLAS  EQU   0                                                        07165000
ECT      EQU   0                                                        07166000
ECTRCDF  EQU   ECT                                                      07167000
ECTRTCD  EQU   ECT+1                                                    07168000
ECTSWS   EQU   ECT+28                                                   07169000
ECTATRM  EQU   ECTSWS                                                   07170000
ECTSWS2  EQU   ECT+40                                                   07171000
ECTSWS21 EQU   ECTSWS2                                                  07172000
IOPL     EQU   0                                                        07173000
IOPLIOPB EQU   IOPL+12                                                  07174000
CPPL     EQU   0                                                        07175000
CPPLUPT  EQU   CPPL+4                                                   07176000
CPPLECT  EQU   CPPL+12                                                  07177000
IHADCB   EQU   0                                                        07178000
INFMJFCB EQU   0                                                        07179000
JFCBDSNM EQU   INFMJFCB                                                 07180000
JFCBELNM EQU   INFMJFCB+44                                              07181000
JFCBTSDM EQU   INFMJFCB+52                                              07182000
JFCFCBID EQU   INFMJFCB+56                                              07183000
JFCBFRID EQU   JFCFCBID                                                 07184000
JFCBLTYP EQU   INFMJFCB+66                                              07185000
JFCBOTTR EQU   INFMJFCB+67                                              07186000
JFCBUFOF EQU   JFCBOTTR                                                 07187000
JFCBFLSQ EQU   JFCBOTTR+1                                               07188000
JFCFUNC  EQU   JFCBFLSQ                                                 07189000
JFCBMASK EQU   INFMJFCB+72                                              07190000
JFCBFLG1 EQU   JFCBMASK+5                                               07191000
JFCOPEN  EQU   JFCBFLG1                                                 07192000
JFCBFLG2 EQU   JFCBMASK+6                                               07193000
JFCDEFER EQU   JFCBFLG2                                                 07194000
JFCBIND1 EQU   INFMJFCB+86                                              07195000
JFCBIND2 EQU   INFMJFCB+87                                              07196000
JFCDISP  EQU   JFCBIND2                                                 07197000
JFCAMPTR EQU   INFMJFCB+88                                              07198000
JFCBUFRQ EQU   JFCAMPTR                                                 07199000
JFCBUFNO EQU   JFCBUFRQ                                                 07200000
JFCBGNCP EQU   JFCAMPTR+1                                               07201000
JFCBHIAR EQU   JFCBGNCP                                                 07202000
JFCBFALN EQU   JFCBHIAR                                                 07203000
JFCBFTEK EQU   JFCBFALN                                                 07204000
JFCBBFTA EQU   JFCBFTEK                                                 07205000
JFCEROPT EQU   INFMJFCB+92                                              07206000
JFCTRTCH EQU   INFMJFCB+93                                              07207000
DHED     EQU   0                                                        07208000
UADSMHDR EQU   DHED                                                     07209000
UADSBLNG EQU   UADSMHDR                                                 07210000
UADSFSQP EQU   UADSMHDR+2                                               07211000
UADSUSER EQU   UADSMHDR+4                                               07212000
UADSBN01 EQU   UADSMHDR+12                                              07213000
UADSNUSP EQU   UADSBN01+1                                               07214000
UADSEXPF EQU   UADSBN01+1                                               07215000
UADSATTR EQU   DHED+16                                                  07216000
UADSUPTP EQU   DHED+20                                                  07217000
UADSPWD1 EQU   DHED+24                                                  07218000
UADSPERP EQU   DHED+28                                                  07219000
UADSNODE EQU   0                                                        07220000
UADSNWD1 EQU   UADSNODE                                                 07221000
DPOB     EQU   0                                                        07222000
DNOB     EQU   0                                                        07223000
DROB     EQU   0                                                        07224000
DPOBD    EQU   0                                                        07225000
DNOBD    EQU   0                                                        07226000
UADSADRF EQU   DNOBD+4                                                  07227000
DROBD    EQU   0                                                        07228000
UADSFSQE EQU   0                                                        07229000
FSQELNTH EQU   UADSFSQE                                                 07230000
FSQENEXT EQU   UADSFSQE+2                                               07231000
UPT      EQU   0                                                        07232000
UPTSWS   EQU   UPT+12                                                   07233000
UPTPREFX EQU   UPT+16                                                   07234000
UPTPREFL EQU   UPT+23                                                   07235000
PERFGRP  EQU   0                                                        07236000
UADIRENT EQU   0                                                        07237000
UADIBYT1 EQU   UADIRENT+12                                              07238000
UADIBYT2 EQU   UADIRENT+13                                              07239000
CUDIRENT EQU   0                                                        07240000
CURBYT1  EQU   CUDIRENT+12                                              07241000
CURBYT2  EQU   CUDIRENT+13                                              07242000
ONAMID   EQU   0                                                        07243000
ONMOFS1  EQU   ONAMID                                                   07244000
ONFLG1S  EQU   ONMOFS1                                                  07245000
ONFSUB1  EQU   ONMOFS1+4                                                07246000
ONFLOC1  EQU   ONAMID+12                                                07247000
ONDLOC1  EQU   ONAMID+16                                                07248000
ONCLS1   EQU   ONAMID+20                                                07249000
ONDXN1   EQU   ONAMID+24                                                07250000
ONMOFS2  EQU   ONAMID+28                                                07251000
ONTST1   EQU   ONMOFS2                                                  07252000
ONFLG2S  EQU   ONTST1                                                   07253000
ONFLG21  EQU   ONFLG2S                                                  07254000
ONMFNX2  EQU   ONMOFS2+1                                                07255000
ONFDAT2  EQU   ONMOFS2+8                                                07256000
ONFLOC2  EQU   ONAMID+40                                                07257000
ONDLOC2  EQU   ONAMID+44                                                07258000
ONCLS2   EQU   ONAMID+48                                                07259000
ONDXN2   EQU   ONAMID+52                                                07260000
ONMOFS3  EQU   ONAMID+56                                                07261000
ONTST2   EQU   ONMOFS3                                                  07262000
ONFLG3S  EQU   ONTST2                                                   07263000
ONFLOC3  EQU   ONAMID+68                                                07264000
ONDLOC3  EQU   ONAMID+72                                                07265000
ONCLS3   EQU   ONAMID+76                                                07266000
ONDXN3   EQU   ONAMID+80                                                07267000
NNAMID   EQU   0                                                        07268000
NNMOFS1  EQU   NNAMID                                                   07269000
NNFLG1S  EQU   NNMOFS1                                                  07270000
NNFSUB1  EQU   NNMOFS1+4                                                07271000
NNFLOC1  EQU   NNAMID+12                                                07272000
NNDLOC1  EQU   NNAMID+16                                                07273000
NNCLS1   EQU   NNAMID+20                                                07274000
NNDXN1   EQU   NNAMID+24                                                07275000
NNMOFS2  EQU   NNAMID+28                                                07276000
NNTST1   EQU   NNMOFS2                                                  07277000
NNFLG2S  EQU   NNTST1                                                   07278000
NNFLG21  EQU   NNFLG2S                                                  07279000
NNMFNX2  EQU   NNMOFS2+1                                                07280000
NNFDAT2  EQU   NNMOFS2+8                                                07281000
NNFLOC2  EQU   NNAMID+40                                                07282000
NNDLOC2  EQU   NNAMID+44                                                07283000
NNCLS2   EQU   NNAMID+48                                                07284000
NNDXN2   EQU   NNAMID+52                                                07285000
NNMOFS3  EQU   NNAMID+56                                                07286000
NNTST2   EQU   NNMOFS3                                                  07287000
NNFLG3S  EQU   NNTST2                                                   07288000
NNFLOC3  EQU   NNAMID+68                                                07289000
NNDLOC3  EQU   NNAMID+72                                                07290000
NNCLS3   EQU   NNAMID+76                                                07291000
NNDXN3   EQU   NNAMID+80                                                07292000
OLSUNODE EQU   0                                                        07293000
OLASUWD1 EQU   OLSUNODE                                                 07294000
OLASUNFL EQU   OLASUWD1                                                 07295000
OLASUWD2 EQU   OLSUNODE+4                                               07296000
OLASUWD3 EQU   OLSUNODE+8                                               07297000
OLPDB    EQU   0                                                        07298000
OCRUNODE EQU   0                                                        07299000
OCURUWD1 EQU   OCRUNODE                                                 07300000
OCURUNFL EQU   OCURUWD1                                                 07301000
OCURUWD2 EQU   OCRUNODE+4                                               07302000
OCURUWD3 EQU   OCRUNODE+8                                               07303000
OLCDB    EQU   0                                                        07304000
OCDBCT   EQU   OLCDB                                                    07305000
OCDBSP   EQU   OLCDB+4                                                  07306000
DUPLIDAT EQU   0                                                        07307000
SVFDAT2  EQU   DUPLIDAT                                                 07308000
DUPLICHK EQU   DUPLIDAT+4                                               07309000
SVDLOC2  EQU   DUPLIDAT+8                                               07310000
ONXUNODE EQU   0                                                        07311000
ONEXUWD1 EQU   ONXUNODE                                                 07312000
ONEXUNFL EQU   ONEXUWD1                                                 07313000
ONEXUWD2 EQU   ONXUNODE+4                                               07314000
ONEXUWD3 EQU   ONXUNODE+8                                               07315000
OLNDB    EQU   0                                                        07316000
NLSUNODE EQU   0                                                        07317000
NLASUWD1 EQU   NLSUNODE                                                 07318000
NLASUNFL EQU   NLASUWD1                                                 07319000
NLASUWD2 EQU   NLSUNODE+4                                               07320000
NLASUSUB EQU   NLASUWD2+1                                               07321000
NLASUWD3 EQU   NLSUNODE+8                                               07322000
NUPDB    EQU   0                                                        07323000
NCRUNODE EQU   0                                                        07324000
NCURUWD1 EQU   NCRUNODE                                                 07325000
NCURUNFL EQU   NCURUWD1                                                 07326000
NCURUFLG EQU   NCURUNFL                                                 07327000
NCURUNEX EQU   NCURUWD1+1                                               07328000
NCURUWD2 EQU   NCRUNODE+4                                               07329000
NCURUSUB EQU   NCURUWD2+1                                               07330000
NCURUWD3 EQU   NCRUNODE+8                                               07331000
NCURUDAT EQU   NCURUWD3+1                                               07332000
NUCDB    EQU   0                                                        07333000
NNXUNODE EQU   0                                                        07334000
NNEXUWD1 EQU   NNXUNODE                                                 07335000
NNEXUNFL EQU   NNEXUWD1                                                 07336000
NNEXUWD2 EQU   NNXUNODE+4                                               07337000
NNEXUWD3 EQU   NNXUNODE+8                                               07338000
NUNDB    EQU   0                                                        07339000
SWRKA    EQU   0                                                        07340000
SABND    EQU   SWRKA+4                                                  07341000
STRGS    EQU   SWRKA+24                                                 07342000
PTPB     EQU   0                                                        07343000
PTPBOPUT EQU   PTPB+4                                                   07344000
RDNAMC   EQU   0                                                        07345000
DIRBDA   EQU   0                                                        07346000
DIRBNAM  EQU   DIRBDA                                                   07347000
DIRBCA   EQU   DIRBDA+11                                                07348000
RDTTR    EQU   12                                                       07349000
DRBLAS   EQU   0                                                        07350000
DRBLC    EQU   DRBLAS+11                                                07351000
CURFSQL  EQU   0                                                        07352000
TMXMDL   EQU   0                                                        07353000
TMXMP1   EQU   TMXMDL+4                                                 07354000
TMXMP2   EQU   TMXMDL+8                                                 07355000
TMXMP3   EQU   TMXMDL+12                                                07356000
TMXMP4   EQU   TMXMDL+16                                                07357000
TMXMP5   EQU   TMXMDL+20                                                07358000
TMS1MDL  EQU   0                                                        07359000
TMS2MDL  EQU   0                                                        07360000
TMS3MDL  EQU   0                                                        07361000
TMS4MDL  EQU   0                                                        07362000
TMS5MDL  EQU   0                                                        07363000
TMLMDL1  EQU   0                                                        07364000
TMLNX1   EQU   TMLMDL1                                                  07365000
TMLMP11  EQU   TMLMDL1+8                                                07366000
TMLMP12  EQU   TMLMDL1+12                                               07367000
TMLMP13  EQU   TMLMDL1+16                                               07368000
TMLMP14  EQU   TMLMDL1+20                                               07369000
TMLMP15  EQU   TMLMDL1+24                                               07370000
TMLMDL2  EQU   0                                                        07371000
TMLNX2   EQU   TMLMDL2                                                  07372000
TMLMP21  EQU   TMLMDL2+8                                                07373000
TMLMP22  EQU   TMLMDL2+12                                               07374000
TMLMP23  EQU   TMLMDL2+16                                               07375000
TMLMP24  EQU   TMLMDL2+20                                               07376000
TMLMP25  EQU   TMLMDL2+24                                               07377000
TMLMDL3  EQU   0                                                        07378000
TMLMP31  EQU   TMLMDL3+8                                                07379000
TMLMP32  EQU   TMLMDL3+12                                               07380000
TMLMP33  EQU   TMLMDL3+16                                               07381000
TMLMP34  EQU   TMLMDL3+20                                               07382000
TMLMP35  EQU   TMLMDL3+24                                               07383000
TM11MDL  EQU   0                                                        07384000
TM12MDL  EQU   0                                                        07385000
TM13MDL  EQU   0                                                        07386000
TM14MDL  EQU   0                                                        07387000
TM15MDL  EQU   0                                                        07388000
TM21MDL  EQU   0                                                        07389000
TM22MDL  EQU   0                                                        07390000
TM23MDL  EQU   0                                                        07391000
TM24MDL  EQU   0                                                        07392000
TM25MDL  EQU   0                                                        07393000
TM31MDL  EQU   0                                                        07394000
TM32MDL  EQU   0                                                        07395000
TM33MDL  EQU   0                                                        07396000
TM34MDL  EQU   0                                                        07397000
TM35MDL  EQU   0                                                        07398000
RETRNCD  EQU   16                                                       07399000
TMSMT1   EQU   0                                                        07400000
TMSMT2   EQU   0                                                        07401000
TMSMT3   EQU   0                                                        07402000
TMSMT4   EQU   0                                                        07403000
TMSMT5   EQU   0                                                        07404000
SPOST    EQU   SPOSTB                                                   07405000
DCBPTR   EQU   DCBNPTR                                                  07406000
DIRPTR   EQU   DIRBDAP                                                  07407000
TREEOFF  EQU   OUOFSUB                                                  07408000
RDJLSTA  EQU   RDJLST                                                   07409000
RDJA1NM  EQU   RDJLSTA+1                                                07410000
RDJA2NM  EQU   RDJLSTA+5                                                07411000
IHADCS00 EQU   IHADCB                                                   07412000
DCBFDAD  EQU   IHADCS00+5                                               07413000
IHADCS01 EQU   DCBFDAD+7                                                07414000
DCBDVTBL EQU   IHADCS01                                                 07415000
IHADCS11 EQU   IHADCB+16                                                07416000
DCBRELB  EQU   IHADCS11                                                 07417000
DCBREL   EQU   DCBRELB+1                                                07418000
DCBBUFCB EQU   IHADCS11+4                                               07419000
DCBDSORG EQU   IHADCS11+10                                              07420000
DCBDSRG1 EQU   DCBDSORG                                                 07421000
DCBDSRG2 EQU   DCBDSORG+1                                               07422000
DCBIOBAD EQU   IHADCS11+12                                              07423000
DCBODEB  EQU   DCBIOBAD                                                 07424000
DCBLNP   EQU   DCBODEB                                                  07425000
DCBQSLM  EQU   DCBLNP                                                   07426000
DCBIOBAA EQU   DCBODEB+1                                                07427000
IHADCS50 EQU   DCBIOBAD                                                 07428000
DCBSVCXL EQU   IHADCS50                                                 07429000
DCBEODAD EQU   IHADCS50+4                                               07430000
DCBBFALN EQU   DCBEODAD                                                 07431000
DCBHIARC EQU   DCBBFALN                                                 07432000
DCBBFTEK EQU   DCBHIARC                                                 07433000
DCBBFT   EQU   DCBBFTEK                                                 07434000
DCBEXLST EQU   IHADCS50+8                                               07435000
DCBRECFM EQU   DCBEXLST                                                 07436000
DCBRECLA EQU   DCBRECFM                                                 07437000
IHADCS24 EQU   IHADCB+40                                                07438000
DCBOFLGS EQU   IHADCS24+8                                               07439000
DCBOFLWR EQU   DCBOFLGS                                                 07440000
DCBOFOPN EQU   DCBOFLGS                                                 07441000
DCBIFLG  EQU   IHADCS24+9                                               07442000
DCBIBPCT EQU   DCBIFLG                                                  07443000
DCBMACR  EQU   IHADCS24+10                                              07444000
DCBMACR1 EQU   DCBMACR                                                  07445000
DCBMRFE  EQU   DCBMACR1                                                 07446000
DCBMRGET EQU   DCBMRFE                                                  07447000
DCBMRAPG EQU   DCBMACR1                                                 07448000
DCBMRRD  EQU   DCBMRAPG                                                 07449000
DCBMRCI  EQU   DCBMACR1                                                 07450000
DCBMRMVG EQU   DCBMRCI                                                  07451000
DCBMRLCG EQU   DCBMACR1                                                 07452000
DCBMRABC EQU   DCBMACR1                                                 07453000
DCBMRPT1 EQU   DCBMRABC                                                 07454000
DCBMRSBG EQU   DCBMRPT1                                                 07455000
DCBMRCRL EQU   DCBMACR1                                                 07456000
DCBMRCHK EQU   DCBMRCRL                                                 07457000
DCBMRRDX EQU   DCBMRCHK                                                 07458000
DCBMRDMG EQU   DCBMACR1                                                 07459000
DCBMACR2 EQU   DCBMACR+1                                                07460000
DCBMRPUT EQU   DCBMACR2                                                 07461000
DCBMRWRT EQU   DCBMACR2                                                 07462000
DCBMRMVP EQU   DCBMACR2                                                 07463000
DCBMR5WD EQU   DCBMACR2                                                 07464000
DCBMRLDM EQU   DCBMR5WD                                                 07465000
DCBMRLCP EQU   DCBMRLDM                                                 07466000
DCBMR4WD EQU   DCBMACR2                                                 07467000
DCBMRPT2 EQU   DCBMR4WD                                                 07468000
DCBMRTMD EQU   DCBMRPT2                                                 07469000
DCBMR3WD EQU   DCBMACR2                                                 07470000
DCBMRCTL EQU   DCBMR3WD                                                 07471000
DCBMRSTK EQU   DCBMRCTL                                                 07472000
DCBMR1WD EQU   DCBMACR2                                                 07473000
DCBMRSWA EQU   DCBMR1WD                                                 07474000
DCBMRDMD EQU   DCBMRSWA                                                 07475000
IHADCS25 EQU   IHADCB+40                                                07476000
DCBMACRF EQU   IHADCS25+2                                               07477000
DCBMACF1 EQU   DCBMACRF                                                 07478000
DCBMFFE  EQU   DCBMACF1                                                 07479000
DCBMFGET EQU   DCBMFFE                                                  07480000
DCBMFAPG EQU   DCBMACF1                                                 07481000
DCBMFRD  EQU   DCBMFAPG                                                 07482000
DCBMFCI  EQU   DCBMACF1                                                 07483000
DCBMFMVG EQU   DCBMFCI                                                  07484000
DCBMFLCG EQU   DCBMACF1                                                 07485000
DCBMFABC EQU   DCBMACF1                                                 07486000
DCBMFPT1 EQU   DCBMFABC                                                 07487000
DCBMFSBG EQU   DCBMFPT1                                                 07488000
DCBMFCRL EQU   DCBMACF1                                                 07489000
DCBMFCHK EQU   DCBMFCRL                                                 07490000
DCBMFDMG EQU   DCBMACF1                                                 07491000
DCBMACF2 EQU   DCBMACRF+1                                               07492000
DCBMFPUT EQU   DCBMACF2                                                 07493000
DCBMFWRT EQU   DCBMACF2                                                 07494000
DCBMFMVP EQU   DCBMACF2                                                 07495000
DCBMF5WD EQU   DCBMACF2                                                 07496000
DCBMFLDM EQU   DCBMF5WD                                                 07497000
DCBMFLCP EQU   DCBMFLDM                                                 07498000
DCBMF4WD EQU   DCBMACF2                                                 07499000
DCBMFPT2 EQU   DCBMF4WD                                                 07500000
DCBMFTMD EQU   DCBMFPT2                                                 07501000
DCBMF3WD EQU   DCBMACF2                                                 07502000
DCBMFCTL EQU   DCBMF3WD                                                 07503000
DCBMFSTK EQU   DCBMFCTL                                                 07504000
DCBMF1WD EQU   DCBMACF2                                                 07505000
DCBMFSWA EQU   DCBMF1WD                                                 07506000
DCBMFDMD EQU   DCBMFSWA                                                 07507000
DCBDEBAD EQU   IHADCS25+4                                               07508000
DCBIFLGS EQU   DCBDEBAD                                                 07509000
DCBIFPCT EQU   DCBIFLGS                                                 07510000
IHADCS26 EQU   IHADCB+48                                                07511000
DCBWRITE EQU   IHADCS26                                                 07512000
DCBREAD  EQU   DCBWRITE                                                 07513000
DCBWRITA EQU   DCBREAD+1                                                07514000
IHADCS36 EQU   IHADCB+52                                                07515000
DCBGERR  EQU   IHADCS36                                                 07516000
DCBPERR  EQU   DCBGERR                                                  07517000
DCBCHECK EQU   DCBPERR                                                  07518000
DCBOPTCD EQU   DCBCHECK                                                 07519000
DCBOPTH  EQU   DCBOPTCD                                                 07520000
DCBOPTO  EQU   DCBOPTH                                                  07521000
DCBOPTZ  EQU   DCBOPTCD                                                 07522000
DCBGERRA EQU   DCBCHECK+1                                               07523000
DCBPERRA EQU   DCBGERRA                                                 07524000
DCBSYNAD EQU   IHADCS36+4                                               07525000
DCBCIND1 EQU   IHADCS36+8                                               07526000
DCBCIND2 EQU   IHADCS36+9                                               07527000
DCBBLKSI EQU   IHADCS36+10                                              07528000
DCBIOBA  EQU   IHADCS36+16                                              07529000
DCBCICB  EQU   DCBIOBA                                                  07530000
IHADCS52 EQU   IHADCB+80                                                07531000
DCBDIRCT EQU   IHADCS52                                                 07532000
DCBQSWS  EQU   DCBDIRCT                                                 07533000
DCBUSASI EQU   DCBQSWS                                                  07534000
DCBQADFS EQU   DCBUSASI                                                 07535000
DCBBUFOF EQU   DCBDIRCT+1                                               07536000
IHADCS37 EQU   IHADCB+60                                                07537000
DCBFLAG1 EQU   IHADCS37                                                 07538000
IHADCS38 EQU   IHADCB+72                                                07539000
DCBEOBR  EQU   IHADCS38                                                 07540000
DCBPOINT EQU   IHADCS38+12                                              07541000
DCBCNTRL EQU   DCBPOINT                                                 07542000
JFCKEYLE EQU   JFCTRTCH                                                 07543000
JFCCODE  EQU   JFCKEYLE                                                 07544000
JFCSTACK EQU   JFCTRTCH                                                 07545000
JFCMODE  EQU   JFCSTACK                                                 07546000
JFCSPPRT EQU   JFCTRTCH                                                 07547000
JFCBABFS EQU   JFCSPPRT+2                                               07548000
JFCLIMCT EQU   JFCBABFS                                                 07549000
JFCDSORG EQU   JFCSPPRT+5                                               07550000
JFCDSRG1 EQU   JFCDSORG                                                 07551000
JFCDSRG2 EQU   JFCDSORG+1                                               07552000
JFCRECFM EQU   JFCSPPRT+7                                               07553000
JFCRCFM  EQU   JFCRECFM                                                 07554000
JFCOPTCD EQU   JFCSPPRT+8                                               07555000
JFCWVCSP EQU   JFCOPTCD                                                 07556000
JFCWVCIS EQU   JFCWVCSP                                                 07557000
JFCWVCBD EQU   JFCWVCIS                                                 07558000
JFCALLOW EQU   JFCOPTCD                                                 07559000
JFCRSV17 EQU   JFCALLOW                                                 07560000
JFCOVER  EQU   JFCRSV17                                                 07561000
JFCPCIBT EQU   JFCOPTCD                                                 07562000
JFCMAST  EQU   JFCPCIBT                                                 07563000
JFCEXT   EQU   JFCMAST                                                  07564000
JFCBCKPT EQU   JFCOPTCD                                                 07565000
JFCIND   EQU   JFCBCKPT                                                 07566000
JFCRSV18 EQU   JFCOPTCD                                                 07567000
JFCCYL   EQU   JFCRSV18                                                 07568000
JFCACT   EQU   JFCCYL                                                   07569000
JFCREDUC EQU   JFCOPTCD                                                 07570000
JFCRSV19 EQU   JFCREDUC                                                 07571000
JFCRSV20 EQU   JFCRSV19                                                 07572000
JFCRSV21 EQU   JFCOPTCD                                                 07573000
JFCDEL   EQU   JFCRSV21                                                 07574000
JFCOPTJ  EQU   JFCOPTCD                                                 07575000
JFCREORG EQU   JFCOPTJ                                                  07576000
JFCBLKSI EQU   JFCSPPRT+9                                               07577000
JFCBUFSI EQU   JFCBLKSI                                                 07578000
JFCAMSYN EQU   JFCSPPRT+11                                              07579000
JFCNCP   EQU   JFCAMSYN+2                                               07580000
JFCNTM   EQU   JFCAMSYN+3                                               07581000
JFCBFSEQ EQU   JFCNTM                                                   07582000
JFCPCI   EQU   JFCBFSEQ                                                 07583000
JFCRESRV EQU   JFCAMSYN+4                                               07584000
JFCUCSEG EQU   JFCRESRV                                                 07585000
JFCUCSOP EQU   JFCUCSEG+4                                               07586000
JFCOUTLI EQU   JFCUCSEG+5                                               07587000
JFCTHRSH EQU   JFCOUTLI                                                 07588000
JFCCPRI  EQU   JFCTHRSH                                                 07589000
JFCBVOLS EQU   JFCUCSEG+10                                              07590000
JFCBS001 EQU   JFCBVOLS                                                 07591000
JFCBPQTY EQU   JFCBS001+34                                              07592000
JFCBCTRI EQU   JFCBS001+37                                              07593000
JFCBSQTY EQU   JFCBS001+38                                              07594000
JFCFLGS1 EQU   JFCBS001+41                                              07595000
OCANDBA  EQU   OCDBSP                                                   07596000
OCANLEN  EQU   OCANDBA+40                                               07597000
DIRBLKA  EQU   DIRBLK                                                   07598000
DIRBLNG  EQU   DIRBLKA                                                  07599000
DIRBNAM1 EQU   DIRBLKA+2                                                07600000
DIRBCA1  EQU   DIRBLKA+16                                               07601000
RDNAMD   EQU   DIRBLK+2                                                 07602000
DIRBC    EQU   DIRBCAX                                                  07603000
FSQELNGA EQU   FSQELNTH                                                 07604000
MSGCDE   EQU   TMSGTIX1+3                                               07605000
*                                      START UNREFERENCED COMPONENTS    07606000
DIRBCB1  EQU   DIRBCA1                                                  07607000
DIRBTT1  EQU   DIRBCA1                                                  07608000
DIRBAL1  EQU   DIRBCA1                                                  07609000
DIRBTTR1 EQU   DIRBLKA+13                                               07610000
OCANNUM  EQU   OCANDBA+41                                               07611000
OCANDRF  EQU   OCANDBA                                                  07612000
JFCBEND  EQU   JFCBS001+58                                              07613000
JFCBSPTN EQU   JFCBS001+57                                              07614000
JFCBVLCT EQU   JFCBS001+56                                              07615000
JFCBDRLH EQU   JFCBS001+53                                              07616000
JFCBSBNM EQU   JFCBS001+50                                              07617000
JFCBABST EQU   JFCBS001+48                                              07618000
JFCBSPNM EQU   JFCBS001+45                                              07619000
JFCBDQTY EQU   JFCBS001+42                                              07620000
JFCBUAFF EQU   JFCFLGS1                                                 07621000
JFCRSV45 EQU   JFCFLGS1                                                 07622000
JFCVRDS  EQU   JFCFLGS1                                                 07623000
JFCBCEOV EQU   JFCFLGS1                                                 07624000
JFCRSV42 EQU   JFCFLGS1                                                 07625000
JFCBADSP EQU   JFCFLGS1                                                 07626000
JFCTOPEN EQU   JFCFLGS1                                                 07627000
JFCBDLET EQU   JFCFLGS1                                                 07628000
JFCRQID  EQU   JFCBSQTY                                                 07629000
JFCROUND EQU   JFCBCTRI                                                 07630000
JFCALX   EQU   JFCBCTRI                                                 07631000
JFCMIXG  EQU   JFCBCTRI                                                 07632000
JFCONTIG EQU   JFCBCTRI                                                 07633000
JFCRSV29 EQU   JFCBCTRI                                                 07634000
JFCBMSGP EQU   JFCBCTRI                                                 07635000
JFCBSPAC EQU   JFCBCTRI                                                 07636000
JFCRUNIT EQU   JFCBPQTY                                                 07637000
JFCBEXAD EQU   JFCBS001+31                                              07638000
JFCBEXTL EQU   JFCBS001+30                                              07639000
JFCMSVGP EQU   JFCBS001+22                                              07640000
@NM00111 EQU   JFCBS001                                                 07641000
JFCAVOLS EQU   JFCBVOLS                                                 07642000
JFCBNVOL EQU   JFCUCSEG+9                                               07643000
JFCBNTCS EQU   JFCUCSEG+8                                               07644000
JFCSOWA  EQU   JFCOUTLI+1                                               07645000
JFCSEND  EQU   JFCCPRI                                                  07646000
JFCEQUAL EQU   JFCCPRI                                                  07647000
JFCRECV  EQU   JFCCPRI                                                  07648000
JFCRSV34 EQU   JFCCPRI                                                  07649000
JFCRSV33 EQU   JFCCPRI                                                  07650000
JFCRSV55 EQU   JFCCPRI                                                  07651000
JFCRSV54 EQU   JFCCPRI                                                  07652000
JFCRSV53 EQU   JFCCPRI                                                  07653000
JFCRSV27 EQU   JFCUCSOP                                                 07654000
JFCRSV26 EQU   JFCUCSOP                                                 07655000
JFCFCBVR EQU   JFCUCSOP                                                 07656000
JFCFCBAL EQU   JFCUCSOP                                                 07657000
JFCVER   EQU   JFCUCSOP                                                 07658000
JFCRSV25 EQU   JFCUCSOP                                                 07659000
JFCFOLD  EQU   JFCUCSOP                                                 07660000
JFCBEXTP EQU   JFCUCSOP                                                 07661000
JFCUCSID EQU   JFCUCSEG                                                 07662000
JFCINTVL EQU   JFCSPPRT+19                                              07663000
JFCDBUFN EQU   JFCRESRV+3                                               07664000
JFCCYLOF EQU   JFCRESRV+2                                               07665000
JFCRKP   EQU   JFCRESRV                                                 07666000
JFCPCIR2 EQU   JFCPCI                                                   07667000
JFCPCIR1 EQU   JFCPCI                                                   07668000
JFCPCIN2 EQU   JFCPCI                                                   07669000
JFCPCIN1 EQU   JFCPCI                                                   07670000
JFCPCIA2 EQU   JFCPCI                                                   07671000
JFCPCIA1 EQU   JFCPCI                                                   07672000
JFCPCIX2 EQU   JFCPCI                                                   07673000
JFCPCIX1 EQU   JFCPCI                                                   07674000
JFCBUFMX EQU   JFCNCP                                                   07675000
JFCLRECL EQU   JFCAMSYN                                                 07676000
JFCBAXBF EQU   JFCBUFSI                                                 07677000
JFCREL   EQU   JFCREORG                                                 07678000
JFCRSV22 EQU   JFCDEL                                                   07679000
JFCSRCHD EQU   JFCRSV20                                                 07680000
JFCOPTQ  EQU   JFCACT                                                   07681000
JFCFEED  EQU   JFCIND                                                   07682000
JFCCBWU  EQU   JFCEXT                                                   07683000
JFCWUMSG EQU   JFCOVER                                                  07684000
JFCSDNAM EQU   JFCWVCBD                                                 07685000
@NM00110 EQU   JFCRECFM                                                 07686000
JFCCHAR  EQU   JFCRECFM                                                 07687000
JFCRFS   EQU   JFCRECFM                                                 07688000
JFCRFB   EQU   JFCRECFM                                                 07689000
JFCRFO   EQU   JFCRCFM                                                  07690000
JFCFMREC EQU   JFCRCFM                                                  07691000
JFCRSV16 EQU   JFCDSRG2                                                 07692000
JFCRSV15 EQU   JFCDSRG2                                                 07693000
JFCORGTR EQU   JFCDSRG2                                                 07694000
JFCORGAM EQU   JFCDSRG2                                                 07695000
JFCRSV13 EQU   JFCDSRG2                                                 07696000
JFCORGTQ EQU   JFCDSRG2                                                 07697000
JFCORGTX EQU   JFCDSRG2                                                 07698000
JFCORGGS EQU   JFCDSRG2                                                 07699000
JFCORGU  EQU   JFCDSRG1                                                 07700000
JFCORGPO EQU   JFCDSRG1                                                 07701000
JFCORGMQ EQU   JFCDSRG1                                                 07702000
JFCORGCQ EQU   JFCDSRG1                                                 07703000
JFCORGCX EQU   JFCDSRG1                                                 07704000
JFCORGDA EQU   JFCDSRG1                                                 07705000
JFCORGPS EQU   JFCDSRG1                                                 07706000
JFCORGIS EQU   JFCDSRG1                                                 07707000
JFCTRKBL EQU   JFCLIMCT+1                                               07708000
@NM00109 EQU   JFCLIMCT                                                 07709000
JFCDEN   EQU   JFCSPPRT+1                                               07710000
JFCPRTSP EQU   JFCSPPRT                                                 07711000
JFCONE   EQU   JFCMODE                                                  07712000
JFCTWO   EQU   JFCMODE                                                  07713000
JFCRSV07 EQU   JFCMODE                                                  07714000
JFCRSV06 EQU   JFCMODE                                                  07715000
JFCMODER EQU   JFCMODE                                                  07716000
JFCMODEO EQU   JFCMODE                                                  07717000
JFCEBCD  EQU   JFCMODE                                                  07718000
JFCBIN   EQU   JFCMODE                                                  07719000
JFCRSV32 EQU   JFCCODE                                                  07720000
JFCTTY   EQU   JFCCODE                                                  07721000
JFCASCII EQU   JFCCODE                                                  07722000
JFCNCR   EQU   JFCCODE                                                  07723000
JFCBUR   EQU   JFCCODE                                                  07724000
JFCFRI   EQU   JFCCODE                                                  07725000
JFCBCD   EQU   JFCCODE                                                  07726000
JFCNOCON EQU   JFCCODE                                                  07727000
DCBNOTE  EQU   DCBCNTRL                                                 07728000
DCBLRECL EQU   IHADCS38+10                                              07729000
@NM00107 EQU   IHADCS38+8                                               07730000
DCBEOBW  EQU   IHADCS38+4                                               07731000
DCBEOBRA EQU   DCBEOBR+1                                                07732000
DCBNCP   EQU   DCBEOBR                                                  07733000
@NM00106 EQU   DCBFLAG1                                                 07734000
DCBSTFLS EQU   DCBFLAG1                                                 07735000
DCBSTQCK EQU   DCBFLAG1                                                 07736000
DCBDIRCQ EQU   DCBBUFOF                                                 07737000
DCBQSTRU EQU   DCBUSASI                                                 07738000
@NM00105 EQU   DCBUSASI                                                 07739000
DCBQADF3 EQU   DCBQADFS                                                 07740000
DCBQADF2 EQU   DCBQADFS                                                 07741000
DCBQADF1 EQU   DCBQADFS                                                 07742000
DCBBLBP  EQU   DCBUSASI                                                 07743000
@NM00104 EQU   DCBUSASI                                                 07744000
DCBCICBA EQU   DCBCICB+1                                                07745000
@NM00103 EQU   DCBCICB                                                  07746000
DCBOFFSW EQU   IHADCS36+15                                              07747000
DCBOFFSR EQU   IHADCS36+14                                              07748000
DCBWCPL  EQU   IHADCS36+13                                              07749000
DCBWCPO  EQU   IHADCS36+12                                              07750000
DCBCNQSM EQU   DCBCIND2                                                 07751000
DCBCNFEO EQU   DCBCIND2                                                 07752000
DCBCNCHS EQU   DCBCIND2                                                 07753000
DCBCNBFP EQU   DCBCIND2                                                 07754000
DCBCNIOE EQU   DCBCIND2                                                 07755000
DCBCNCLO EQU   DCBCIND2                                                 07756000
DCBCNWRO EQU   DCBCIND2                                                 07757000
DCBCNSTO EQU   DCBCIND2                                                 07758000
DCBCNEXB EQU   DCBCIND1                                                 07759000
@NM00102 EQU   DCBCIND1                                                 07760000
DCBCNBRM EQU   DCBCIND1                                                 07761000
@NM00101 EQU   DCBCIND1                                                 07762000
DCBCNEVA EQU   DCBCIND1                                                 07763000
DCBCNEVB EQU   DCBCIND1                                                 07764000
DCBCNSRD EQU   DCBCIND1                                                 07765000
DCBCNTOV EQU   DCBCIND1                                                 07766000
DCBSYNA  EQU   DCBSYNAD+1                                               07767000
DCBIOBL  EQU   DCBSYNAD                                                 07768000
DCBCHCKA EQU   DCBPERRA                                                 07769000
DCBOPTJ  EQU   DCBOPTCD                                                 07770000
DCBOPTT  EQU   DCBOPTCD                                                 07771000
DCBSRCHD EQU   DCBOPTZ                                                  07772000
DCBOPTQ  EQU   DCBOPTCD                                                 07773000
DCBBCKPT EQU   DCBOPTO                                                  07774000
DCBOPTC  EQU   DCBOPTCD                                                 07775000
DCBOPTU  EQU   DCBOPTCD                                                 07776000
DCBOPTW  EQU   DCBOPTCD                                                 07777000
DCBREADA EQU   DCBWRITA                                                 07778000
@NM00100 EQU   DCBREAD                                                  07779000
DCBDEBA  EQU   DCBDEBAD+1                                               07780000
@NM00099 EQU   DCBIFLGS                                                 07781000
DCBIFIOE EQU   DCBIFLGS                                                 07782000
DCBCH12  EQU   DCBIFPCT                                                 07783000
DCBCH9   EQU   DCBIFPCT                                                 07784000
DCBIFEC  EQU   DCBIFLGS                                                 07785000
DCBMFSTI EQU   DCBMFDMD                                                 07786000
DCBMFAWR EQU   DCBMFSTK                                                 07787000
DCBMFUIP EQU   DCBMFTMD                                                 07788000
DCBMFIDW EQU   DCBMFLCP                                                 07789000
DCBMFWRK EQU   DCBMFMVP                                                 07790000
DCBMFRDQ EQU   DCBMFWRT                                                 07791000
DCBMFGTQ EQU   DCBMFPUT                                                 07792000
DCBMFSTL EQU   DCBMACF2                                                 07793000
DCBMFCK  EQU   DCBMFDMG                                                 07794000
DCBMFRDX EQU   DCBMFCHK                                                 07795000
DCBMFDBF EQU   DCBMFSBG                                                 07796000
DCBMFRDI EQU   DCBMFLCG                                                 07797000
DCBMFRDK EQU   DCBMFMVG                                                 07798000
DCBMFWRQ EQU   DCBMFRD                                                  07799000
DCBMFPTQ EQU   DCBMFGET                                                 07800000
DCBMFECP EQU   DCBMACF1                                                 07801000
DCBTIOT  EQU   IHADCS25                                                 07802000
DCBMRSTI EQU   DCBMRDMD                                                 07803000
DCBMRAWR EQU   DCBMRSTK                                                 07804000
DCBMRUIP EQU   DCBMRTMD                                                 07805000
DCBMRIDW EQU   DCBMRLCP                                                 07806000
DCBMRWRK EQU   DCBMRMVP                                                 07807000
DCBMRRDQ EQU   DCBMRWRT                                                 07808000
DCBMRGTQ EQU   DCBMRPUT                                                 07809000
DCBMRSTL EQU   DCBMACR2                                                 07810000
DCBMRCK  EQU   DCBMRDMG                                                 07811000
DCBPGFXA EQU   DCBMRRDX                                                 07812000
DCBMRDBF EQU   DCBMRSBG                                                 07813000
DCBMRRDI EQU   DCBMRLCG                                                 07814000
DCBMRRDK EQU   DCBMRMVG                                                 07815000
DCBMRWRQ EQU   DCBMRRD                                                  07816000
DCBMRPTQ EQU   DCBMRGET                                                 07817000
DCBMRECP EQU   DCBMACR1                                                 07818000
@NM00098 EQU   DCBIFLG                                                  07819000
DCBIBIOE EQU   DCBIFLG                                                  07820000
DCBICH12 EQU   DCBIBPCT                                                 07821000
DCBICH9  EQU   DCBIBPCT                                                 07822000
DCBIBEC  EQU   DCBIFLG                                                  07823000
DCBOFIOF EQU   DCBOFLGS                                                 07824000
DCBOFUEX EQU   DCBOFLGS                                                 07825000
DCBOFTM  EQU   DCBOFLGS                                                 07826000
DCBOFPPC EQU   DCBOFLGS                                                 07827000
DCBOFEOV EQU   DCBOFLGS                                                 07828000
DCBOFLRB EQU   DCBOFLGS                                                 07829000
DCBOFIOD EQU   DCBOFLWR                                                 07830000
DCBDDNAM EQU   IHADCS24                                                 07831000
DCBEXLSA EQU   DCBEXLST+1                                               07832000
DCBRECKL EQU   DCBRECFM                                                 07833000
DCBRECCC EQU   DCBRECFM                                                 07834000
DCBRECSB EQU   DCBRECFM                                                 07835000
DCBRECBR EQU   DCBRECFM                                                 07836000
DCBRECTO EQU   DCBRECLA                                                 07837000
DCBRECL  EQU   DCBRECLA                                                 07838000
DCBEODA  EQU   DCBEODAD+1                                               07839000
DCBBFA   EQU   DCBBFTEK                                                 07840000
DCBH0    EQU   DCBBFTEK                                                 07841000
DCBBFTKD EQU   DCBBFTEK                                                 07842000
DCBBFTE  EQU   DCBBFT                                                   07843000
DCBBFTKR EQU   DCBBFT                                                   07844000
DCBBFTS  EQU   DCBBFT                                                   07845000
DCBH1    EQU   DCBBFTEK                                                 07846000
DCBSVCXA EQU   DCBSVCXL+1                                               07847000
@NM00097 EQU   DCBSVCXL                                                 07848000
DCBODEBA EQU   DCBIOBAA                                                 07849000
@NM00096 EQU   DCBQSLM                                                  07850000
DCBUPDBT EQU   DCBQSLM                                                  07851000
DCBUPDCM EQU   DCBQSLM                                                  07852000
DCB1DVDS EQU   DCBQSLM                                                  07853000
@NM00095 EQU   DCBDSRG2                                                 07854000
DCBDSGTR EQU   DCBDSRG2                                                 07855000
DCBACBM  EQU   DCBDSRG2                                                 07856000
@NM00094 EQU   DCBDSRG2                                                 07857000
DCBDSGTQ EQU   DCBDSRG2                                                 07858000
DCBDSGTX EQU   DCBDSRG2                                                 07859000
DCBDSGGS EQU   DCBDSRG2                                                 07860000
DCBDSGU  EQU   DCBDSRG1                                                 07861000
DCBDSGPO EQU   DCBDSRG1                                                 07862000
@NM00093 EQU   DCBDSRG1                                                 07863000
@NM00092 EQU   DCBDSRG1                                                 07864000
DCBDSGCX EQU   DCBDSRG1                                                 07865000
DCBDSGDA EQU   DCBDSRG1                                                 07866000
DCBDSGPS EQU   DCBDSRG1                                                 07867000
DCBDSGIS EQU   DCBDSRG1                                                 07868000
DCBBUFL  EQU   IHADCS11+8                                               07869000
DCBBUFCA EQU   DCBBUFCB+1                                               07870000
DCBBUFNO EQU   DCBBUFCB                                                 07871000
DCBDEVT  EQU   DCBREL                                                   07872000
DCBKEYLE EQU   DCBRELB                                                  07873000
DCBTRBAL EQU   IHADCS01+6                                               07874000
@NM00091 EQU   IHADCS01+5                                               07875000
@NM00090 EQU   IHADCS01+4                                               07876000
DCBDVTBA EQU   DCBDVTBL+1                                               07877000
@NM00089 EQU   DCBDVTBL                                                 07878000
DCBKEYCN EQU   IHADCS00+4                                               07879000
DCBRELAD EQU   IHADCS00                                                 07880000
RDJA2CT  EQU   RDJLSTA+4                                                07881000
RDJA1CT  EQU   RDJLSTA                                                  07882000
TM35MT   EQU   TM35MDL+8                                                07883000
TM35MO   EQU   TM35MDL+4                                                07884000
TM35ML   EQU   TM35MDL                                                  07885000
TM34MT   EQU   TM34MDL+8                                                07886000
TM34MO   EQU   TM34MDL+4                                                07887000
TM34ML   EQU   TM34MDL                                                  07888000
TM33MT   EQU   TM33MDL+8                                                07889000
TM33MO   EQU   TM33MDL+4                                                07890000
TM33ML   EQU   TM33MDL                                                  07891000
TM32MT   EQU   TM32MDL+8                                                07892000
TM32MO   EQU   TM32MDL+4                                                07893000
TM32ML   EQU   TM32MDL                                                  07894000
TM31MT   EQU   TM31MDL+8                                                07895000
TM31MO   EQU   TM31MDL+4                                                07896000
TM31ML   EQU   TM31MDL                                                  07897000
TM25MT   EQU   TM25MDL+8                                                07898000
TM25MO   EQU   TM25MDL+4                                                07899000
TM25ML   EQU   TM25MDL                                                  07900000
TM24MT   EQU   TM24MDL+8                                                07901000
TM24MO   EQU   TM24MDL+4                                                07902000
TM24ML   EQU   TM24MDL                                                  07903000
TM23MT   EQU   TM23MDL+8                                                07904000
TM23MO   EQU   TM23MDL+4                                                07905000
TM23ML   EQU   TM23MDL                                                  07906000
TM22MT   EQU   TM22MDL+8                                                07907000
TM22MO   EQU   TM22MDL+4                                                07908000
TM22ML   EQU   TM22MDL                                                  07909000
TM21MT   EQU   TM21MDL+8                                                07910000
TM21MO   EQU   TM21MDL+4                                                07911000
TM21ML   EQU   TM21MDL                                                  07912000
TM15MT   EQU   TM15MDL+8                                                07913000
TM15MO   EQU   TM15MDL+4                                                07914000
TM15ML   EQU   TM15MDL                                                  07915000
TM14MT   EQU   TM14MDL+8                                                07916000
TM14MO   EQU   TM14MDL+4                                                07917000
TM14ML   EQU   TM14MDL                                                  07918000
TM13MT   EQU   TM13MDL+8                                                07919000
TM13MO   EQU   TM13MDL+4                                                07920000
TM13ML   EQU   TM13MDL                                                  07921000
TM12MT   EQU   TM12MDL+8                                                07922000
TM12MO   EQU   TM12MDL+4                                                07923000
TM12ML   EQU   TM12MDL                                                  07924000
TM11MT   EQU   TM11MDL+8                                                07925000
TM11MO   EQU   TM11MDL+4                                                07926000
TM11ML   EQU   TM11MDL                                                  07927000
TMLMN3   EQU   TMLMDL3+4                                                07928000
TMLNX3   EQU   TMLMDL3                                                  07929000
TMLMN2   EQU   TMLMDL2+4                                                07930000
TMLMN1   EQU   TMLMDL1+4                                                07931000
TMS5MT   EQU   TMS5MDL+4                                                07932000
TMS5MO   EQU   TMS5MDL+2                                                07933000
TMS5ML   EQU   TMS5MDL                                                  07934000
TMS4MT   EQU   TMS4MDL+4                                                07935000
TMS4MO   EQU   TMS4MDL+2                                                07936000
TMS4ML   EQU   TMS4MDL                                                  07937000
TMS3MT   EQU   TMS3MDL+4                                                07938000
TMS3MO   EQU   TMS3MDL+2                                                07939000
TMS3ML   EQU   TMS3MDL                                                  07940000
TMS2MT   EQU   TMS2MDL+4                                                07941000
TMS2MO   EQU   TMS2MDL+2                                                07942000
TMS2ML   EQU   TMS2MDL                                                  07943000
TMS1MT   EQU   TMS1MDL+4                                                07944000
TMS1MO   EQU   TMS1MDL+2                                                07945000
TMS1ML   EQU   TMS1MDL                                                  07946000
TMXMN    EQU   TMXMDL                                                   07947000
DRBLCB   EQU   DRBLC                                                    07948000
DRBLTT   EQU   DRBLC                                                    07949000
DRBLAL   EQU   DRBLC                                                    07950000
DRBLTTR  EQU   DRBLAS+8                                                 07951000
DRBLNAM  EQU   DRBLAS                                                   07952000
DIRBCB   EQU   DIRBCA                                                   07953000
DIRBTT   EQU   DIRBCA                                                   07954000
DIRBAL   EQU   DIRBCA                                                   07955000
DIRBTTR  EQU   DIRBDA+8                                                 07956000
PTPBFLN  EQU   PTPB+8                                                   07957000
@NM00265 EQU   PTPB                                                     07958000
SWRKRS   EQU   SWRKA+100                                                07959000
PPEP     EQU   SWRKA+96                                                 07960000
PPNAM    EQU   SWRKA+88                                                 07961000
STRG15   EQU   STRGS+60                                                 07962000
STRG14   EQU   STRGS+56                                                 07963000
STRG13   EQU   STRGS+52                                                 07964000
STRG12   EQU   STRGS+48                                                 07965000
STRG11   EQU   STRGS+44                                                 07966000
STRG10   EQU   STRGS+40                                                 07967000
STRG9    EQU   STRGS+36                                                 07968000
STRG8    EQU   STRGS+32                                                 07969000
STRG7    EQU   STRGS+28                                                 07970000
STRG6    EQU   STRGS+24                                                 07971000
STRG5    EQU   STRGS+20                                                 07972000
STRG4    EQU   STRGS+16                                                 07973000
STRG3    EQU   STRGS+12                                                 07974000
STRG2    EQU   STRGS+8                                                  07975000
STRG1    EQU   STRGS+4                                                  07976000
STRG0    EQU   STRGS                                                    07977000
LASPSW   EQU   SWRKA+16                                                 07978000
BNDPSW   EQU   SWRKA+8                                                  07979000
SEXPL    EQU   SWRKA                                                    07980000
NNDBSP   EQU   NUNDB+4                                                  07981000
NNDBRS   EQU   NUNDB+1                                                  07982000
NNDBCT   EQU   NUNDB                                                    07983000
NNEXUDAT EQU   NNEXUWD3+1                                               07984000
NNEXUDFL EQU   NNEXUWD3                                                 07985000
NNEXUSUB EQU   NNEXUWD2+1                                               07986000
NNEXUSFL EQU   NNEXUWD2                                                 07987000
NNEXUNEX EQU   NNEXUWD1+1                                               07988000
@NM00264 EQU   NNEXUNFL                                                 07989000
@NM00263 EQU   NNEXUNFL                                                 07990000
@NM00262 EQU   NNEXUNFL                                                 07991000
@NM00261 EQU   NNEXUNFL                                                 07992000
@NM00260 EQU   NNEXUNFL                                                 07993000
@NM00259 EQU   NNEXUNFL                                                 07994000
@NM00258 EQU   NNEXUNFL                                                 07995000
NNEXUFLG EQU   NNEXUNFL                                                 07996000
NCDBSP   EQU   NUCDB+4                                                  07997000
NCDBRS   EQU   NUCDB+1                                                  07998000
NCDBCT   EQU   NUCDB                                                    07999000
NCURUDFL EQU   NCURUWD3                                                 08000000
NCURUSFL EQU   NCURUWD2                                                 08001000
@NM00257 EQU   NCURUNFL                                                 08002000
@NM00256 EQU   NCURUNFL                                                 08003000
@NM00255 EQU   NCURUNFL                                                 08004000
@NM00254 EQU   NCURUNFL                                                 08005000
@NM00253 EQU   NCURUNFL                                                 08006000
@NM00252 EQU   NCURUNFL                                                 08007000
@NM00251 EQU   NCURUNFL                                                 08008000
NPDBSP   EQU   NUPDB+4                                                  08009000
NPDBRS   EQU   NUPDB+1                                                  08010000
NPDBCT   EQU   NUPDB                                                    08011000
NLASUDAT EQU   NLASUWD3+1                                               08012000
NLASUDFL EQU   NLASUWD3                                                 08013000
NLASUSFL EQU   NLASUWD2                                                 08014000
NLASUNEX EQU   NLASUWD1+1                                               08015000
@NM00250 EQU   NLASUNFL                                                 08016000
@NM00249 EQU   NLASUNFL                                                 08017000
@NM00248 EQU   NLASUNFL                                                 08018000
@NM00247 EQU   NLASUNFL                                                 08019000
@NM00246 EQU   NLASUNFL                                                 08020000
@NM00245 EQU   NLASUNFL                                                 08021000
@NM00244 EQU   NLASUNFL                                                 08022000
NLASUFLG EQU   NLASUNFL                                                 08023000
ONDBSP   EQU   OLNDB+4                                                  08024000
ONDBRS   EQU   OLNDB+1                                                  08025000
ONDBCT   EQU   OLNDB                                                    08026000
ONEXUDAT EQU   ONEXUWD3+1                                               08027000
ONEXUDFL EQU   ONEXUWD3                                                 08028000
ONEXUSUB EQU   ONEXUWD2+1                                               08029000
ONEXUSFL EQU   ONEXUWD2                                                 08030000
ONEXUNEX EQU   ONEXUWD1+1                                               08031000
@NM00243 EQU   ONEXUNFL                                                 08032000
@NM00242 EQU   ONEXUNFL                                                 08033000
@NM00241 EQU   ONEXUNFL                                                 08034000
@NM00240 EQU   ONEXUNFL                                                 08035000
@NM00239 EQU   ONEXUNFL                                                 08036000
@NM00238 EQU   ONEXUNFL                                                 08037000
@NM00237 EQU   ONEXUNFL                                                 08038000
ONEXUFLG EQU   ONEXUNFL                                                 08039000
@NM00236 EQU   DUPLIDAT+5                                               08040000
OCDBRS   EQU   OLCDB+1                                                  08041000
OCURUDAT EQU   OCURUWD3+1                                               08042000
OCURUDFL EQU   OCURUWD3                                                 08043000
OCURUSUB EQU   OCURUWD2+1                                               08044000
OCURUSFL EQU   OCURUWD2                                                 08045000
OCURUNEX EQU   OCURUWD1+1                                               08046000
@NM00235 EQU   OCURUNFL                                                 08047000
@NM00234 EQU   OCURUNFL                                                 08048000
@NM00233 EQU   OCURUNFL                                                 08049000
@NM00232 EQU   OCURUNFL                                                 08050000
@NM00231 EQU   OCURUNFL                                                 08051000
@NM00230 EQU   OCURUNFL                                                 08052000
@NM00229 EQU   OCURUNFL                                                 08053000
OCURUFLG EQU   OCURUNFL                                                 08054000
OPDBSP   EQU   OLPDB+4                                                  08055000
OPDBRS   EQU   OLPDB+1                                                  08056000
OPDBCT   EQU   OLPDB                                                    08057000
OLASUDAT EQU   OLASUWD3+1                                               08058000
OLASUDFL EQU   OLASUWD3                                                 08059000
OLASUSUB EQU   OLASUWD2+1                                               08060000
OLASUSFL EQU   OLASUWD2                                                 08061000
OLASUNEX EQU   OLASUWD1+1                                               08062000
@NM00228 EQU   OLASUNFL                                                 08063000
@NM00227 EQU   OLASUNFL                                                 08064000
@NM00226 EQU   OLASUNFL                                                 08065000
@NM00225 EQU   OLASUNFL                                                 08066000
@NM00224 EQU   OLASUNFL                                                 08067000
@NM00223 EQU   OLASUNFL                                                 08068000
@NM00222 EQU   OLASUNFL                                                 08069000
OLASUFLG EQU   OLASUNFL                                                 08070000
NNTST3   EQU   NNAMID+84                                                08071000
NNDCN3   EQU   NNDXN3+2                                                 08072000
NNDTN3   EQU   NNDXN3                                                   08073000
@NM00221 EQU   NNAMID+77                                                08074000
@NM00220 EQU   NNCLS3                                                   08075000
@NM00219 EQU   NNCLS3                                                   08076000
@NM00218 EQU   NNCLS3                                                   08077000
@NM00217 EQU   NNCLS3                                                   08078000
@NM00216 EQU   NNCLS3                                                   08079000
@NM00215 EQU   NNCLS3                                                   08080000
@NM00214 EQU   NNCLS3                                                   08081000
NNBLDG3  EQU   NNCLS3                                                   08082000
NNFDAT3  EQU   NNMOFS3+8                                                08083000
NNFSUB3  EQU   NNMOFS3+4                                                08084000
NNMFNX3  EQU   NNMOFS3+1                                                08085000
@NM00213 EQU   NNFLG3S                                                  08086000
@NM00212 EQU   NNFLG3S                                                  08087000
@NM00211 EQU   NNFLG3S                                                  08088000
@NM00210 EQU   NNFLG3S                                                  08089000
@NM00209 EQU   NNFLG3S                                                  08090000
@NM00208 EQU   NNFLG3S                                                  08091000
@NM00207 EQU   NNFLG3S                                                  08092000
NNFLG31  EQU   NNFLG3S                                                  08093000
NNDCN2   EQU   NNDXN2+2                                                 08094000
NNDTN2   EQU   NNDXN2                                                   08095000
@NM00206 EQU   NNAMID+49                                                08096000
@NM00205 EQU   NNCLS2                                                   08097000
@NM00204 EQU   NNCLS2                                                   08098000
@NM00203 EQU   NNCLS2                                                   08099000
@NM00202 EQU   NNCLS2                                                   08100000
@NM00201 EQU   NNCLS2                                                   08101000
@NM00200 EQU   NNCLS2                                                   08102000
@NM00199 EQU   NNCLS2                                                   08103000
NNBLDG2  EQU   NNCLS2                                                   08104000
NNFSUB2  EQU   NNMOFS2+4                                                08105000
@NM00198 EQU   NNFLG2S                                                  08106000
@NM00197 EQU   NNFLG2S                                                  08107000
@NM00196 EQU   NNFLG2S                                                  08108000
@NM00195 EQU   NNFLG2S                                                  08109000
@NM00194 EQU   NNFLG2S                                                  08110000
@NM00193 EQU   NNFLG2S                                                  08111000
@NM00192 EQU   NNFLG2S                                                  08112000
NNDCN1   EQU   NNDXN1+2                                                 08113000
NNDTN1   EQU   NNDXN1                                                   08114000
@NM00191 EQU   NNAMID+21                                                08115000
@NM00190 EQU   NNCLS1                                                   08116000
@NM00189 EQU   NNCLS1                                                   08117000
@NM00188 EQU   NNCLS1                                                   08118000
@NM00187 EQU   NNCLS1                                                   08119000
@NM00186 EQU   NNCLS1                                                   08120000
@NM00185 EQU   NNCLS1                                                   08121000
@NM00184 EQU   NNCLS1                                                   08122000
NNBLDG1  EQU   NNCLS1                                                   08123000
NNFDAT1  EQU   NNMOFS1+8                                                08124000
NNMFNX1  EQU   NNMOFS1+1                                                08125000
@NM00183 EQU   NNFLG1S                                                  08126000
@NM00182 EQU   NNFLG1S                                                  08127000
@NM00181 EQU   NNFLG1S                                                  08128000
@NM00180 EQU   NNFLG1S                                                  08129000
@NM00179 EQU   NNFLG1S                                                  08130000
@NM00178 EQU   NNFLG1S                                                  08131000
@NM00177 EQU   NNFLG1S                                                  08132000
NNFLG11  EQU   NNFLG1S                                                  08133000
ONTST3   EQU   ONAMID+84                                                08134000
ONDCN3   EQU   ONDXN3+2                                                 08135000
ONDTN3   EQU   ONDXN3                                                   08136000
@NM00176 EQU   ONAMID+77                                                08137000
@NM00175 EQU   ONCLS3                                                   08138000
@NM00174 EQU   ONCLS3                                                   08139000
@NM00173 EQU   ONCLS3                                                   08140000
@NM00172 EQU   ONCLS3                                                   08141000
@NM00171 EQU   ONCLS3                                                   08142000
@NM00170 EQU   ONCLS3                                                   08143000
@NM00169 EQU   ONCLS3                                                   08144000
ONBLDG3  EQU   ONCLS3                                                   08145000
ONFDAT3  EQU   ONMOFS3+8                                                08146000
ONFSUB3  EQU   ONMOFS3+4                                                08147000
ONMFNX3  EQU   ONMOFS3+1                                                08148000
@NM00168 EQU   ONFLG3S                                                  08149000
@NM00167 EQU   ONFLG3S                                                  08150000
@NM00166 EQU   ONFLG3S                                                  08151000
@NM00165 EQU   ONFLG3S                                                  08152000
@NM00164 EQU   ONFLG3S                                                  08153000
@NM00163 EQU   ONFLG3S                                                  08154000
@NM00162 EQU   ONFLG3S                                                  08155000
ONFLG31  EQU   ONFLG3S                                                  08156000
ONDCN2   EQU   ONDXN2+2                                                 08157000
ONDTN2   EQU   ONDXN2                                                   08158000
@NM00161 EQU   ONAMID+49                                                08159000
@NM00160 EQU   ONCLS2                                                   08160000
@NM00159 EQU   ONCLS2                                                   08161000
@NM00158 EQU   ONCLS2                                                   08162000
@NM00157 EQU   ONCLS2                                                   08163000
@NM00156 EQU   ONCLS2                                                   08164000
@NM00155 EQU   ONCLS2                                                   08165000
@NM00154 EQU   ONCLS2                                                   08166000
ONBLDG2  EQU   ONCLS2                                                   08167000
ONFSUB2  EQU   ONMOFS2+4                                                08168000
@NM00153 EQU   ONFLG2S                                                  08169000
@NM00152 EQU   ONFLG2S                                                  08170000
@NM00151 EQU   ONFLG2S                                                  08171000
@NM00150 EQU   ONFLG2S                                                  08172000
@NM00149 EQU   ONFLG2S                                                  08173000
@NM00148 EQU   ONFLG2S                                                  08174000
@NM00147 EQU   ONFLG2S                                                  08175000
ONDCN1   EQU   ONDXN1+2                                                 08176000
ONDTN1   EQU   ONDXN1                                                   08177000
@NM00146 EQU   ONAMID+21                                                08178000
@NM00145 EQU   ONCLS1                                                   08179000
@NM00144 EQU   ONCLS1                                                   08180000
@NM00143 EQU   ONCLS1                                                   08181000
@NM00142 EQU   ONCLS1                                                   08182000
@NM00141 EQU   ONCLS1                                                   08183000
@NM00140 EQU   ONCLS1                                                   08184000
@NM00139 EQU   ONCLS1                                                   08185000
ONBLDG1  EQU   ONCLS1                                                   08186000
ONFDAT1  EQU   ONMOFS1+8                                                08187000
ONMFNX1  EQU   ONMOFS1+1                                                08188000
@NM00138 EQU   ONFLG1S                                                  08189000
@NM00137 EQU   ONFLG1S                                                  08190000
@NM00136 EQU   ONFLG1S                                                  08191000
@NM00135 EQU   ONFLG1S                                                  08192000
@NM00134 EQU   ONFLG1S                                                  08193000
@NM00133 EQU   ONFLG1S                                                  08194000
@NM00132 EQU   ONFLG1S                                                  08195000
ONFLG11  EQU   ONFLG1S                                                  08196000
@NM00131 EQU   CURBYT2                                                  08197000
@NM00130 EQU   CURBYT1                                                  08198000
CUDITTRC EQU   CUDIRENT+8                                               08199000
CUDIUSER EQU   CUDIRENT                                                 08200000
@NM00129 EQU   UADIBYT2                                                 08201000
@NM00128 EQU   UADIBYT1                                                 08202000
UADINEW  EQU   UADIBYT1                                                 08203000
UADITTRC EQU   UADIRENT+8                                               08204000
UADIUSER EQU   UADIRENT                                                 08205000
@NM00127 EQU   UPT+15                                                   08206000
UPTLDEL  EQU   UPT+14                                                   08207000
UPTCDEL  EQU   UPT+13                                                   08208000
UPTWTP   EQU   UPTSWS                                                   08209000
UPTMODE  EQU   UPTSWS                                                   08210000
UPTALD   EQU   UPTSWS                                                   08211000
UPTPAUS  EQU   UPTSWS                                                   08212000
UPTNCOM  EQU   UPTSWS                                                   08213000
UPTMID   EQU   UPTSWS                                                   08214000
UPTNPRM  EQU   UPTSWS                                                   08215000
@NM00126 EQU   UPTSWS                                                   08216000
UPTUSER  EQU   UPT+2                                                    08217000
@NM00125 EQU   UPT                                                      08218000
UADSUNAM EQU   DROBD+16                                                 08219000
UADSRSIZ EQU   DROBD+14                                                 08220000
@NM00124 EQU   DROBD+12                                                 08221000
UADSRNAM EQU   DROBD+4                                                  08222000
@NM00123 EQU   DROBD+1                                                  08223000
UADSRCTR EQU   DROBD                                                    08224000
UADSANUM EQU   DNOBD+45                                                 08225000
UADSALEN EQU   DNOBD+44                                                 08226000
@NM00122 EQU   DNOBD+1                                                  08227000
UADSACTR EQU   DNOBD                                                    08228000
UADSPPWD EQU   DPOBD+4                                                  08229000
@NM00121 EQU   DPOBD+1                                                  08230000
UADSPCTR EQU   DPOBD                                                    08231000
UADSRDAT EQU   DROB+8                                                   08232000
@NM00120 EQU   DROB+4                                                   08233000
UADSRNEX EQU   DROB+1                                                   08234000
@NM00119 EQU   DROB                                                     08235000
FLGR01   EQU   DROB                                                     08236000
UADSADAT EQU   DNOB+8                                                   08237000
UADSASUB EQU   DNOB+4                                                   08238000
UADSANEX EQU   DNOB+1                                                   08239000
@NM00118 EQU   DNOB                                                     08240000
AFLG01   EQU   DNOB                                                     08241000
UADSPDAT EQU   DPOB+8                                                   08242000
UADSPSUB EQU   DPOB+4                                                   08243000
UADSPNEX EQU   DPOB+1                                                   08244000
@NM00117 EQU   DPOB                                                     08245000
PFLG01   EQU   DPOB                                                     08246000
UADSNDAT EQU   UADSNODE+8                                               08247000
UADSNSUB EQU   UADSNODE+4                                               08248000
UADSNNEX EQU   UADSNWD1+1                                               08249000
@NM00116 EQU   UADSNWD1                                                 08250000
UADSNFLG EQU   UADSNWD1                                                 08251000
@NM00115 EQU   DHED+40                                                  08252000
UADSDEST EQU   DHED+32                                                  08253000
UADSINST EQU   DHED+18                                                  08254000
@NM00114 EQU   UADSATTR                                                 08255000
USATR03  EQU   UADSATTR                                                 08256000
USATR02  EQU   UADSATTR                                                 08257000
USATR01  EQU   UADSATTR                                                 08258000
USATR00  EQU   UADSATTR                                                 08259000
UADSMAXC EQU   UADSMHDR+14                                              08260000
@NM00113 EQU   UADSBN01+1                                               08261000
@NM00112 EQU   UADSBN01                                                 08262000
JFCRSV05 EQU   JFCEROPT                                                 08263000
JFCRSV04 EQU   JFCEROPT                                                 08264000
JFCRSV03 EQU   JFCEROPT                                                 08265000
JFCRSV02 EQU   JFCEROPT                                                 08266000
JFCTOPT  EQU   JFCEROPT                                                 08267000
JFCABN   EQU   JFCEROPT                                                 08268000
JFCSKP   EQU   JFCEROPT                                                 08269000
JFCACC   EQU   JFCEROPT                                                 08270000
JFCBUFL  EQU   JFCAMPTR+2                                               08271000
JFCFWORD EQU   JFCBFTEK                                                 08272000
JFCDWORD EQU   JFCBFTEK                                                 08273000
JFCHIER1 EQU   JFCBFTEK                                                 08274000
JFCDYN   EQU   JFCBFTEK                                                 08275000
JFCEXC   EQU   JFCBFTEK                                                 08276000
JFCBBFTR EQU   JFCBBFTA                                                 08277000
JFCSIM   EQU   JFCBBFTA                                                 08278000
JFCHIER  EQU   JFCBFTEK                                                 08279000
JFCBFOUT EQU   JFCBUFNO                                                 08280000
JFCBUFIN EQU   JFCBUFNO                                                 08281000
JFCTEMP  EQU   JFCBIND2                                                 08282000
JFCREQ   EQU   JFCBIND2                                                 08283000
JFCENT   EQU   JFCBIND2                                                 08284000
JFCSHARE EQU   JFCBIND2                                                 08285000
JFCSECUR EQU   JFCBIND2                                                 08286000
JFCPDS   EQU   JFCBIND1                                                 08287000
JFCGDG   EQU   JFCBIND1                                                 08288000
JFCADDED EQU   JFCBIND1                                                 08289000
JFCLOC   EQU   JFCBIND1                                                 08290000
JFCRLSE  EQU   JFCBIND1                                                 08291000
JFCBXPDT EQU   INFMJFCB+83                                              08292000
JFCBCRDT EQU   INFMJFCB+80                                              08293000
JFCBOPS2 EQU   JFCBMASK+7                                               08294000
JFCRCTLG EQU   JFCBFLG2                                                 08295000
JFCBBUFF EQU   JFCBFLG2                                                 08296000
JFCTRACE EQU   JFCBFLG2                                                 08297000
JFCSDRPS EQU   JFCBFLG2                                                 08298000
JFCMODNW EQU   JFCBFLG2                                                 08299000
JFCNRPS  EQU   JFCDEFER                                                 08300000
JFCOUTOP EQU   JFCBFLG2                                                 08301000
JFCINOP  EQU   JFCBFLG2                                                 08302000
JFCBPWBP EQU   JFCOPEN                                                  08303000
@NM00108 EQU   JFCOPEN                                                  08304000
JFCDUAL  EQU   JFCBFLG1                                                 08305000
JFCSLDES EQU   JFCBFLG1                                                 08306000
JFCSLCRE EQU   JFCBFLG1                                                 08307000
JFCSTAND EQU   JFCBFLG1                                                 08308000
JFCBOPS1 EQU   JFCBMASK                                                 08309000
JFCBVLSQ EQU   INFMJFCB+70                                              08310000
JFCRSV31 EQU   JFCFUNC                                                  08311000
JFCFNCBT EQU   JFCFUNC                                                  08312000
JFCFNCBX EQU   JFCFUNC                                                  08313000
JFCFNCBD EQU   JFCFUNC                                                  08314000
JFCFNCBW EQU   JFCFUNC                                                  08315000
JFCFNCBP EQU   JFCFUNC                                                  08316000
JFCFNCBR EQU   JFCFUNC                                                  08317000
JFCFNCBI EQU   JFCFUNC                                                  08318000
JFCBFOFL EQU   JFCBUFOF                                                 08319000
JFCNL    EQU   JFCBLTYP                                                 08320000
JFCSL    EQU   JFCBLTYP                                                 08321000
JFCNSL   EQU   JFCBLTYP                                                 08322000
JFCSUL   EQU   JFCBLTYP                                                 08323000
JFCBLP   EQU   JFCBLTYP                                                 08324000
JFCBLTM  EQU   JFCBLTYP                                                 08325000
JFCBAL   EQU   JFCBLTYP                                                 08326000
JFCRSV38 EQU   JFCBLTYP                                                 08327000
JFCVINDX EQU   INFMJFCB+64                                              08328000
JFCNLREC EQU   INFMJFCB+62                                              08329000
JFCBADBF EQU   INFMJFCB+60                                              08330000
JFCAMSTR EQU   JFCBFRID+2                                               08331000
JFCAMCRO EQU   JFCBFRID                                                 08332000
JFCBDSCB EQU   INFMJFCB+53                                              08333000
JFCPAT   EQU   JFCBTSDM                                                 08334000
JFCNDCB  EQU   JFCBTSDM                                                 08335000
JFCNDSCB EQU   JFCBTSDM                                                 08336000
JFCNWRIT EQU   JFCBTSDM                                                 08337000
JFCTTR   EQU   JFCBTSDM                                                 08338000
JFCSDS   EQU   JFCBTSDM                                                 08339000
JFCVSL   EQU   JFCBTSDM                                                 08340000
JFCCAT   EQU   JFCBTSDM                                                 08341000
JFCIPLTX EQU   JFCBELNM                                                 08342000
JFCBQNAM EQU   JFCBDSNM                                                 08343000
@NM00088 EQU   IHADCB                                                   08344000
CPPLPSCB EQU   CPPL+8                                                   08345000
CPPLCBUF EQU   CPPL                                                     08346000
IOPLECB  EQU   IOPL+8                                                   08347000
IOPLECT  EQU   IOPL+4                                                   08348000
IOPLUPT  EQU   IOPL                                                     08349000
@NM00087 EQU   ECT+52                                                   08350000
@NM00086 EQU   ECT+48                                                   08351000
@NM00085 EQU   ECT+44                                                   08352000
@NM00084 EQU   ECTSWS2+1                                                08353000
@NM00083 EQU   ECTSWS21                                                 08354000
ECTTABND EQU   ECTSWS21                                                 08355000
ECTDEFCS EQU   ECTSWS21                                                 08356000
ECTBKPB  EQU   ECT+36                                                   08357000
ECTUSER  EQU   ECT+32                                                   08358000
ECTDDNUM EQU   ECT+29                                                   08359000
ECTATTN  EQU   ECTSWS                                                   08360000
ECTBKGRD EQU   ECTSWS                                                   08361000
ECTNNOT  EQU   ECTSWS                                                   08362000
ECTNMAL  EQU   ECTSWS                                                   08363000
ECTLOGF  EQU   ECTSWS                                                   08364000
@NM00082 EQU   ECTSWS                                                   08365000
ECTNOPD  EQU   ECTSWS                                                   08366000
ECTSCMD  EQU   ECT+20                                                   08367000
ECTPCMD  EQU   ECT+12                                                   08368000
ECTSMSG  EQU   ECT+9                                                    08369000
ECTMSGF  EQU   ECT+8                                                    08370000
ECTIOWA  EQU   ECT+4                                                    08371000
MIDSLOF  EQU   MIDSHDR+6                                                08372000
MIDSLNX  EQU   MIDSHDR                                                  08373000
STAENL4  EQU   STAENPL+12                                               08374000
STAENL3  EQU   STAENPL+8                                                08375000
STAENL2  EQU   STAENPL+4                                                08376000
STAENL1  EQU   STAENPL                                                  08377000
RCLRES   EQU   RTCLIST                                                  08378000
*                                      END UNREFERENCED COMPONENTS      08379000
@RC00393 EQU   @RC00391                                                 08380000
@RF00614 EQU   @RC00604                                                 08381000
@RC00681 EQU   @RC00679                                                 08382000
@RF00791 EQU   @RC00789                                                 08383000
@RC01063 EQU   @RC01057                                                 08384000
@RC01061 EQU   @RC01057                                                 08385000
@RC01059 EQU   @RC01057                                                 08386000
@RF01153 EQU   @RC01150                                                 08387000
@RC01257 EQU   @RC01254                                                 08388000
@RF01321 EQU   @RC01318                                                 08389000
@RC01464 EQU   @RC01462                                                 08390000
@RC01534 EQU   @RC01531                                                 08391000
@RC01569 EQU   @RC01567                                                 08392000
@EL01    EQU   @EL00001                                                 08393000
@ENDDATA EQU   *                                                        08394000
         END   IKJRBBU0,(C'PLS1929',0701,76163)                         08395000
