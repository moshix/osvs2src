         TITLE '*** IKT3270O: TSO/VTAM TERMINAL SCREEN MANAGER ***     *00001000
                        '                                               00002000
IKT3270O CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKT3270O  78.045'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @05,0                                               0001 00011000
@PSTART  LA    @06,4095(,@05)                                      0001 00012000
         LA    @07,4095(,@06)                                      0001 00013000
         USING @PSTART,@05                                         0001 00014000
         USING @PSTART+4095,@06                                    0001 00015000
         USING @PSTART+8190,@07                                    0001 00016000
         EJECT                                                          00017000
*/********************************************************************/ 00018000
*/*                                                                  */ 00019000
*/* SET UP ADDRESSING TO COMPILER WORK AREA, SET SCREEN PARMS AND    */ 00020000
*/* PROCESS REQUEST CODE.                                            */ 00021000
*/*                                                                  */ 00022000
*/********************************************************************/ 00023000
*                                                                  0045 00024000
*TVWAPTR=TSBXTVWA;                   /* SET TVWA POINTER             */ 00025000
         L     @12,PSAAOLD                                         0045 00026000
         L     @12,ASCBTSB(,@12)                                   0045 00027000
         L     @12,TSBEXTNT(,@12)                                  0045 00028000
         L     TVWAPTR,TSBXTVWA(,@12)                              0045 00029000
*TOMWAPTR=TVWATOMW;                  /* SET BASE PTR FOR WORK AREA   */ 00030000
         L     TOMWAPTR,TVWATOMW(,TVWAPTR)                         0046 00031000
*RFY IFGRPL BASED(EVAL(TOMWAPTR+                                   0047 00032000
*          LEN@DATA+LENGTH(TOMWA))); /* RPL ADDRESS                  */ 00033000
*REG4=ADDR(TOMAUTOD);                /* ADDRESS OF AUTODATA AREA     */ 00034000
         LA    REG4,TOMAUTOD(,TOMWAPTR)                            0048 00035000
*GEN REFS(REG4) SETS(REG13);         /* ADDRESSING-COMPILER WORK AREA*/ 00036000
    USING @DATD,REG4                                                    00037000
    ST REG13,@SA00001+4                                                 00038000
    ST REG4,8(,REG13)                                                   00039000
    LR REG13,REG4                                                       00040000
*IF (TVWAXSCD='1'B) THEN             /* HAS SCREEN SIZE CHANGED?     */ 00041000
         TM    TVWAXSCD(TVWAPTR),B'00001000'                       0050 00042000
         BNO   @RF00050                                            0050 00043000
*  CALL SETSCRSZ;                    /* SET UP & VALIDATE SCRN PARMS */ 00044000
         BAL   @14,SETSCRSZ                                        0051 00045000
*ELSE;                               /* NO PARMS VALIDATION NEEDED   */ 00046000
@RF00050 DS    0H                                                  0053 00047000
*TOMGETMN=TOMWAPTR+                  /* WORK AREA ADDRESS +  @ZM21356*/ 00048000
*         LEN@DATA+                  /* AUTO DATA SIZE +     @ZM21356*/ 00049000
*         LENGTH(TOMWA)+             /* WORK AREA SIZE +     @ZM21356*/ 00050000
*         LENGTH(IFGRPL);            /* LENGTH OF RPL        @ZM21356*/ 00051000
         LA    @12,856                                             0053 00052000
         ALR   @12,TOMWAPTR                                        0053 00053000
         ST    @12,TOMGETMN(,TOMWAPTR)                             0053 00054000
*TOMBFPTR=TOMGETMN;                  /* SET PTR TO BEGINNING OF RU   */ 00055000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0054 00056000
*IF TOMREQCD=BLDOPRU THEN            /* IS REQUEST CODE FOR RU BUILD?*/ 00057000
         CLI   TOMREQCD(TOMWAPTR),0                                0055 00058000
         BNE   @RF00055                                            0055 00059000
*  CALL BLDRU;                       /* YES, BUILD OUTPUT RU         */ 00060000
         BAL   @14,BLDRU                                           0056 00061000
*ELSE                                /* CONTINUE REQUEST CHK @G58AK2Q*/ 00062000
*  IF TOMREQCD=BLDFMWRT THEN         /* REQ FOR FORMAT WRT?  @G58AK2Q*/ 00063000
         B     @RC00055                                            0057 00064000
@RF00055 CLI   TOMREQCD(TOMWAPTR),1                                0057 00065000
         BNE   @RF00057                                            0057 00066000
*    CALL FORMTWRT;                  /* YES, BLD FORMAT WRT  @G58AK2Q*/ 00067000
         BAL   @14,FORMTWRT                                        0058 00068000
*  ELSE                              /* CONTINUE REQUEST CHK @G58AK2Q*/ 00069000
*    IF TOMREQCD=BLDRDBF THEN        /* IS REQ FOR READ BUFF @G58AK2Q*/ 00070000
         B     @RC00057                                            0059 00071000
@RF00057 CLI   TOMREQCD(TOMWAPTR),2                                0059 00072000
         BNE   @RF00059                                            0059 00073000
*      CALL READBUFF;                /* YES, BLD READ BUFFER @G58AK2Q*/ 00074000
         BAL   @14,READBUFF                                        0060 00075000
*    ELSE                            /* CONTINUE REQUEST CHK @G58AK2Q*/ 00076000
*      IF TOMREQCD=BLDBKSE THEN      /* IS REQ FOR BREAK-IN? @G58AK2Q*/ 00077000
         B     @RC00059                                            0061 00078000
@RF00059 CLI   TOMREQCD(TOMWAPTR),3                                0061 00079000
         BNE   @RF00061                                            0061 00080000
*        CALL BKMDSEND;              /* BLD BREAK-IN RU      @G58AK2Q*/ 00081000
         BAL   @14,BKMDSEND                                        0062 00082000
*      ELSE                          /* CONTINUE REQ CHECK   @G58AK2Q*/ 00083000
*        IF TOMREQCD=BLDSCRES THEN   /* BREAK-IN SCRN RES    @G58AK2Q*/ 00084000
         B     @RC00061                                            0063 00085000
@RF00061 CLI   TOMREQCD(TOMWAPTR),4                                0063 00086000
         BNE   @RF00063                                            0063 00087000
*          CALL SCRNREST;            /* RESTORE SCREEN       @G58AK2Q*/ 00088000
         BAL   @14,SCRNREST                                        0064 00089000
*        ELSE;                       /* END REQUEST CHECK    @G58AK2Q*/ 00090000
@RF00063 DS    0H                                                  0066 00091000
*/********************************************************************/ 00092000
*/*                                                                  */ 00093000
*/* PROCESS USER AND/OR ASCII TRANSLATION REQUESTS                   */ 00094000
*/*                                                                  */ 00095000
*/********************************************************************/ 00096000
*IF TOMBFCNT>0 THEN                  /* IS RU EMPTY?                 */ 00097000
@RC00061 DS    0H                                                  0066 00098000
@RC00059 DS    0H                                                  0066 00099000
@RC00057 DS    0H                                                  0066 00100000
@RC00055 L     @12,TOMBFCNT(,TOMWAPTR)                             0066 00101000
         LTR   @12,@12                                             0066 00102000
         BNP   @RF00066                                            0066 00103000
*  IF (TVWATRAN='1'B)|               /* IS USER TRANSLATION NEEDED?  */ 00104000
*     (TSBXASCI='1'B) THEN           /* IS ASCII TRANSLATION NEEDED? */ 00105000
         TM    TVWATRAN(TVWAPTR),B'00000010'                       0067 00106000
         BO    @RT00067                                            0067 00107000
         L     @12,PSAAOLD                                         0067 00108000
         L     @12,ASCBTSB(,@12)                                   0067 00109000
         L     @12,TSBEXTNT(,@12)                                  0067 00110000
         TM    TSBXASCI(@12),B'10000000'                           0067 00111000
         BNO   @RF00067                                            0067 00112000
@RT00067 DS    0H                                                  0068 00113000
*    CALL TRANPROC;                  /* YES, DO USER &/OR ASCII TRANS*/ 00114000
         BAL   @14,TRANPROC                                        0068 00115000
*  ELSE;                             /* NO TRANSLATION NEEDED        */ 00116000
@RF00067 DS    0H                                                  0070 00117000
*ELSE;                               /* RU IS EMPTY                  */ 00118000
@RF00066 DS    0H                                                  0071 00119000
         EJECT                                                          00120000
*/********************************************************************/ 00121000
*/*                                                                  */ 00122000
*/* THIS PROCEDURE, SETSCRSZ, WILL BE CALL TO INITIALIZE PARAMETERS  */ 00123000
*/* USED FOR SCREEN MANAGEMENT. SETSCRSZ WILL ALSO BE CALL TO ADJUST */ 00124000
*/* THESE PARAMETERS AS NEEDED DURING THE SESSION.                   */ 00125000
*/*                                                                  */ 00126000
*/********************************************************************/ 00127000
*                                                                  0071 00128000
*SETSCRSZ: PROCEDURE OPTIONS(SAVE(14));                            0071 00129000
*                                                                  0071 00130000
@EL00001 L     @13,4(,@13)                                         0071 00131000
@EF00001 DS    0H                                                  0071 00132000
@ER00001 LM    @14,@12,12(@13)                                     0071 00133000
         BR    @14                                                 0071 00134000
SETSCRSZ ST    @14,12(,@13)                                        0071 00135000
*IF TSBXTMBF=1920 THEN               /* IS THIS A MODEL TWO DISPLAY? */ 00136000
         L     @12,PSAAOLD                                         0072 00137000
         L     @12,ASCBTSB(,@12)                                   0072 00138000
         L     @12,TSBEXTNT(,@12)                                  0072 00139000
         CLC   TSBXTMBF(2,@12),@CH02229                            0072 00140000
         BNE   @RF00072                                            0072 00141000
*  DO;                               /* YES, SCRN PARMS FOR MODEL-2  */ 00142000
*    TOMPLSZ=80;                     /* SET PHYSICAL LINE-SIZE       */ 00143000
         MVC   TOMPLSZ(4,TOMWAPTR),@CF01672                        0074 00144000
*    TOMPLNNO=24;                    /* SET PHYSICAL # OF LINES/SCRN */ 00145000
         MVI   TOMPLNNO(TOMWAPTR),X'18'                            0075 00146000
*    TOMFMTAD='5D7F'X;               /* LAST SCREEN POSITION         */ 00147000
         MVC   TOMFMTAD(2,TOMWAPTR),@CB02230                       0076 00148000
*  END;                              /* SET SCRN PARMS FOR MODEL-2   */ 00149000
*ELSE                                /* IF NO, THEN THIS IS A MODEL-1*/ 00150000
*  DO;                               /* SET SCRN PARMS FOR MODEL-1   */ 00151000
         B     @RC00072                                            0078 00152000
@RF00072 DS    0H                                                  0079 00153000
*    TOMPLSZ=40;                     /* SET PHYSICAL LINE-SIZE       */ 00154000
         MVC   TOMPLSZ(4,TOMWAPTR),@CF01910                        0079 00155000
*    TOMPLNNO=12;                    /* SET PHYSICAL # OF LINES/SCRN */ 00156000
         MVI   TOMPLNNO(TOMWAPTR),X'0C'                            0080 00157000
*    TOMFMTAD='C75F'X;               /* LAST SCREEN POSITION         */ 00158000
         MVC   TOMFMTAD(2,TOMWAPTR),@CB02231                       0081 00159000
*  END;                              /* SET SCRN PARMS FOR MODEL-1   */ 00160000
*TOMSBACD=SBA;                       /* SET SBA CODE IN FORMAT DATA  */ 00161000
@RC00072 MVI   TOMSBACD(TOMWAPTR),X'11'                            0083 00162000
*TOMFMATT=SFRDATT;                   /* SET FORMAT ATTRIBUTE IN DATA */ 00163000
         MVC   TOMFMATT(2,TOMWAPTR),@CB01962                       0084 00164000
*TOMLNSZ=MAX(2,MIN(TSBLNSZ,TOMPLSZ));/* SET WORKING LINE-SIZE        */ 00165000
         LA    @12,2                                               0085 00166000
         L     @01,PSAAOLD                                         0085 00167000
         L     @15,ASCBTSB(,@01)                                   0085 00168000
         SLR   @14,@14                                             0085 00169000
         IC    @14,TSBLNSZ(,@15)                                   0085 00170000
         L     @11,TOMPLSZ(,TOMWAPTR)                              0085 00171000
         CR    @14,@11                                             0085 00172000
         BNH   *+6                                                      00173000
         LR    @14,@11                                             0085 00174000
         CR    @14,@12                                             0085 00175000
         BNL   *+6                                                      00176000
         LR    @14,@12                                             0085 00177000
         STC   @14,TOMLNSZ(,TOMWAPTR)                              0085 00178000
*TOMLNNO=MAX(2,MIN(TSBLNNO,TOMPLNNO));/* SET WORKING # OF LINES/SCRN */ 00179000
         SLR   @14,@14                                             0086 00180000
         IC    @14,TSBLNNO(,@15)                                   0086 00181000
         SLR   @15,@15                                             0086 00182000
         IC    @15,TOMPLNNO(,TOMWAPTR)                             0086 00183000
         CR    @14,@15                                             0086 00184000
         BNH   *+6                                                      00185000
         LR    @14,@15                                             0086 00186000
         CR    @14,@12                                             0086 00187000
         BNL   *+6                                                      00188000
         LR    @14,@12                                             0086 00189000
         ST    @14,TOMLNNO(,TOMWAPTR)                              0086 00190000
*TVWAXSCD='0'B;                      /* OFF, SET SCRN SIZE REQUEST   */ 00191000
         NI    TVWAXSCD(TVWAPTR),B'11110111'                       0087 00192000
*END SETSCRSZ;                       /* END OF SETSCRSZ              */ 00193000
@EL00002 DS    0H                                                  0088 00194000
@EF00002 DS    0H                                                  0088 00195000
@ER00002 L     @14,12(,@13)                                        0088 00196000
         BR    @14                                                 0088 00197000
         EJECT                                                          00198000
*/********************************************************************/ 00199000
*/*                                                                  */ 00200000
*/* THIS PROCEDURE, FORMTWRT, WILL BUILD AN RU CONSISTING OF A.....  */ 00201000
*/*                                                                  */ 00202000
*/********************************************************************/ 00203000
*                                                                  0089 00204000
*FORMTWRT: PROCEDURE OPTIONS(SAVE(14));                    /*@G58AK2Q*/ 00205000
*                                                                  0089 00206000
FORMTWRT ST    @14,12(,@13)                                        0089 00207000
*DCL ASCITABO CHAR(256) BASED(TVWAATBO);/* ASCII TRANS TABLE @G58AK2Q*/ 00208000
*                                                                  0090 00209000
*TOMCOLMN=0;                         /* RESET COLUMN COUNT   @ZA17886*/ 00210000
         SLR   @12,@12                                             0091 00211000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0091 00212000
*I=9;                                /* INDEX INTO MESSAGE   @G58AK2Q*/ 00213000
         LA    @12,9                                               0092 00214000
         ST    @12,I(,TOMWAPTR)                                    0092 00215000
*TOMWRKSZ=MIN(MSGSIZE,62)+18;        /* SET SIZE OF ERROR MS @G58AK2Q*/ 00216000
         SLA   @12,2                                               0093 00217000
         L     @01,FLCCVT                                          0093 00218000
         L     @01,CVTTCASP(,@01)                                  0093 00219000
         L     @01,TCASMSGS(,@01)                                  0093 00220000
         AL    @01,@CF02389                                        0093 00221000
         L     @12,MSGADR(@12,@01)                                 0093 00222000
         LH    @15,MSGSIZE(,@12)                                   0093 00223000
         LA    @14,62                                              0093 00224000
         CR    @15,@14                                             0093 00225000
         BNH   *+6                                                      00226000
         LR    @15,@14                                             0093 00227000
         AL    @15,@CF02240                                        0093 00228000
         STC   @15,TOMWRKSZ(,TOMWAPTR)                             0093 00229000
*TOMWRKBF(1)=EWRT;                   /* PUT IN COMMAND       @ZM21421*/ 00230000
         MVI   TOMWRKBF(TOMWAPTR),X'F5'                            0094 00231000
*TOMWRKBF(2:7)='C21140401DC8'X;      /* WRITE CONTROL CHARACTER AND     00232000
*                                       ADDRESS              @ZM21421*/ 00233000
         MVC   TOMWRKBF+1(6,TOMWAPTR),@CB02241                     0095 00234000
*TOMWRKBF(8:TOMWRKSZ-11)=MSGDATA(1:(MIN(MSGSIZE,62)));     /*@G58AK2Q*/ 00235000
         LR    @14,@15                                             0096 00236000
         SL    @14,@CF02373                                        0096 00237000
         EX    @14,@SM02390                                        0096 00238000
*TOMWRKBF(TOMWRKSZ-10:TOMWRKSZ)='11C1501DC85C5C5C1D4013'X; /*@G58AK2Q*/ 00239000
         ALR   @15,TOMWAPTR                                        0097 00240000
         MVC   TOMWRKBF-11(11,@15),@CB02243                        0097 00241000
*IF TSBXASCI='1'B THEN               /* ASCII TRANSLATION?   @G58AK@Q*/ 00242000
         L     @12,PSAAOLD                                         0098 00243000
         L     @12,ASCBTSB(,@12)                                   0098 00244000
         L     @12,TSBEXTNT(,@12)                                  0098 00245000
         TM    TSBXASCI(@12),B'10000000'                           0098 00246000
         BNO   @RF00098                                            0098 00247000
*  TR(TOMWRKBF(1:TOMWRKSZ),ASCITABO);/* YES, TRANSLATE DATA  @G58AK2Q*/ 00248000
         SLR   @12,@12                                             0099 00249000
         IC    @12,TOMWRKSZ(,TOMWAPTR)                             0099 00250000
         BCTR  @12,0                                               0099 00251000
         L     @01,TVWAATBO(,TVWAPTR)                              0099 00252000
         EX    @12,@SB02392                                        0099 00253000
*ELSE;                                                     /*@G58AK2Q*/ 00254000
@RF00098 DS    0H                                                  0101 00255000
*TVWAPGN='1'B;                       /* SET PAGING FLAG ON   @G58AK2Q*/ 00256000
         OI    TVWAPGN(TVWAPTR),B'01000000'                        0101 00257000
*TVWAKBDL='0'B;                      /* KEYBOARD UNLOCKED    @ZA13627*/ 00258000
         NI    TVWAKBDL(TVWAPTR),B'11011111'                       0102 00259000
*IF RPLUSNSI='0001'X THEN            /* OPERATIONS CHECK?    @ZA17031*/ 00260000
         LA    @12,744                                             0103 00261000
         ALR   @12,TOMWAPTR                                        0103 00262000
         CLC   RPLUSNSI(2,@12),@CH02246                            0103 00263000
         BNE   @RF00103                                            0103 00264000
*  TOMERLCT='0'B;                                          /*@ZA17031*/ 00265000
         NI    TOMERLCT(TOMWAPTR),B'11111101'                      0104 00266000
*ELSE                                /* NOT OPERATIONS CHECK @ZA17031*/ 00267000
*  TOMERLCT='1'B;                                          /*@ZA17031*/ 00268000
         B     @RC00103                                            0105 00269000
@RF00103 OI    TOMERLCT(TOMWAPTR),B'00000010'                      0105 00270000
*TOMCURST='1'B;                      /* CURSOR SET                   */ 00271000
@RC00103 OI    TOMCURST(TOMWAPTR),B'00010000'                      0106 00272000
*TOMERMG9='1'B;                      /* SPECIAL ERROR MSG RU @G58AK2Q*/ 00273000
         OI    TOMERMG9(TOMWAPTR),B'00100000'                      0107 00274000
*END FORMTWRT;                       /* END OF FORMTWRT              */ 00275000
@EL00003 DS    0H                                                  0108 00276000
@EF00003 DS    0H                                                  0108 00277000
@ER00003 L     @14,12(,@13)                                        0108 00278000
         BR    @14                                                 0108 00279000
         EJECT                                                          00280000
*/********************************************************************/ 00281000
*/*                                                                  */ 00282000
*/* THIS PROCEDURE, READBUFF, WILL BUILD A RU TO ISSUE A READ BUFFER */ 00283000
*/* COMMAND.                                                         */ 00284000
*/*                                                                  */ 00285000
*/********************************************************************/ 00286000
*                                                                  0109 00287000
*READBUFF: PROCEDURE OPTIONS(SAVE(14));                    /*@G58AK2Q*/ 00288000
*                                                                  0109 00289000
READBUFF ST    @14,12(,@13)                                        0109 00290000
*IKTOBUF(1)=RDBFCMD;                 /* READ BUFFER CMD IN RU@G58AK2Q*/ 00291000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0110 00292000
         MVI   IKTOBUF(@12),X'F2'                                  0110 00293000
*TOMBFCNT=1;                         /* UPDATE COUNT OF DATA @G58AK2Q*/ 00294000
         LA    @15,1                                               0111 00295000
         ST    @15,TOMBFCNT(,TOMWAPTR)                             0111 00296000
*TOMBFPTR=TOMBFPTR+1;                /* UPDATA RU BUFFER PTR @G58AK2Q*/ 00297000
         ALR   @12,@15                                             0112 00298000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0112 00299000
*TVWAKBDL='0'B;                      /* KB LOGICALLY UNLOCKED@G58AK2Q*/ 00300000
         NI    TVWAKBDL(TVWAPTR),B'11011111'                       0113 00301000
*END READBUFF;                       /* END OF READBUFF      @G58AK2Q*/ 00302000
@EL00004 DS    0H                                                  0114 00303000
@EF00004 DS    0H                                                  0114 00304000
@ER00004 L     @14,12(,@13)                                        0114 00305000
         BR    @14                                                 0114 00306000
         EJECT                                                          00307000
*/********************************************************************/ 00308000
*/*                                                                  */ 00309000
*/* THIS PROCEDURE, BKMDSEND, WILL BUILD AN RU....                   */ 00310000
*/*                                                                  */ 00311000
*/********************************************************************/ 00312000
*                                                                  0115 00313000
*BKMDSEND: PROCEDURE OPTIONS(SAVE(14));                    /*@G58AK2Q*/ 00314000
*                                                                  0115 00315000
BKMDSEND ST    @14,@SA00005                                        0115 00316000
*IF TOMBFCNT=0 THEN                  /* IS OUTPUT RU EMPTY?  @G58AK2Q*/ 00317000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0116 00318000
         LTR   @12,@12                                             0116 00319000
         BNZ   @RF00116                                            0116 00320000
*  CALL SCRFORMT;                    /* PUT IN CMD AND WCC   @G58AK2Q*/ 00321000
         BAL   @14,SCRFORMT                                        0117 00322000
*ELSE;                               /* RU NOT EMPTY         @G58AK2Q*/ 00323000
@RF00116 DS    0H                                                  0119 00324000
*IF TVWAFSM='0'B THEN                /* IN FULLSCREEN MODE?  @G58AK2Q*/ 00325000
         TM    TVWAFSM(TVWAPTR),B'01000000'                        0119 00326000
         BNZ   @RF00119                                            0119 00327000
*  CALL NEWCURS;                     /* NO, FORMAT SCRN FOR  @G58AK2Q*/ 00328000
         BAL   @14,NEWCURS                                         0120 00329000
*ELSE;                               /* FULLSCREEN MODE      @G58AK2Q*/ 00330000
@RF00119 DS    0H                                                  0122 00331000
*END BKMDSEND;                       /* END OF BKMDSEND      @G58AK2Q*/ 00332000
@EL00005 DS    0H                                                  0122 00333000
@EF00005 DS    0H                                                  0122 00334000
@ER00005 L     @14,@SA00005                                        0122 00335000
         BR    @14                                                 0122 00336000
         EJECT                                                          00337000
*/********************************************************************/ 00338000
*/*                                                                  */ 00339000
*/* THIS PROCEDURE, SCRNREST, WILL BUILD A RU TO RESTORE SCRN WHICH  */ 00340000
*/* WAS SAVED PRIOR TO BREAK-IN PROCESSING.                          */ 00341000
*/*                                                                  */ 00342000
*/********************************************************************/ 00343000
*                                                                  0123 00344000
*SCRNREST: PROCEDURE OPTIONS(SAVE(14));                    /*@G58AK2Q*/ 00345000
*                                                                  0123 00346000
SCRNREST ST    @14,12(,@13)                                        0123 00347000
*DECLARE                                                           0124 00348000
*  1 RDBFGETM BASED(TVWAGMPT),       /* GETMAINED FOR RD BUF @G58AK2Q*/ 00349000
*   2 GETMLENG FIXED(31),            /* LENGTH OF GETMAIN    @G58AK2Q*/ 00350000
*   2 DATALENG FIXED(31),            /* LGTH OF RD BUF INPUT @G58AK2Q*/ 00351000
*   2 CNTLHEAD,                      /* SCRN RESTORE HEADER  @G58AK2Q*/ 00352000
*    3 CMDWCCDE CHAR(2),             /* COMMAND AND WCC BYTE @G58AK2Q*/ 00353000
*    3 SBASEQEN CHAR(3),             /* START ADR FOR RESTORE@G58AK2Q*/ 00354000
*     4    *     CHAR(1),            /* AID OR SBA CODE      @G58AK2Q*/ 00355000
*     4 CURSSBA@ CHAR(2);            /* CURS OR SBA ADDRESS  @G58AK2Q*/ 00356000
*                                                                  0124 00357000
*DECLARE                                                           0125 00358000
*  1 ICCURSOR BASED(EVAL(TVWAGMPT+DATALENG+10)),           /*@G58AK2Q*/ 00359000
*   2 SBACDE   CHAR(1),              /* SET BUFFER ADDR CODE @G58AK2Q*/ 00360000
*   2 CURSADDR CHAR(2),              /* RESTORED CURSOR ADDR @G58AK2Q*/ 00361000
*   2 ICORDER  CHAR(1);              /* INSERT CURSOR ORDER  @G58AK2Q*/ 00362000
*                                                                  0125 00363000
*SBACDE=SBA;                         /* SET SBA CODE FOR IC  @G58AK2Q*/ 00364000
         LA    @12,10                                              0126 00365000
         L     @15,TVWAGMPT(,TVWAPTR)                              0126 00366000
         L     @14,DATALENG(,@15)                                  0126 00367000
         LR    @11,@15                                             0126 00368000
         ALR   @11,@14                                             0126 00369000
         LR    @10,@11                                             0126 00370000
         ALR   @10,@12                                             0126 00371000
         MVI   SBACDE(@10),X'11'                                   0126 00372000
*CURSADDR=CURSSBA@;                  /* RESTORE CURSOR ADDR  @G58AK2Q*/ 00373000
         LR    @10,@11                                             0127 00374000
         ALR   @10,@12                                             0127 00375000
         MVC   CURSADDR(2,@10),CURSSBA@(@15)                       0127 00376000
*ICORDER=IC;                         /* INSERT CURSOR ORDER  @G58AK2Q*/ 00377000
         ALR   @11,@12                                             0128 00378000
         MVI   ICORDER(@11),X'13'                                  0128 00379000
*CNTLHEAD='F1C2114040'X;             /* SET HEADER FOR WRITE @G58AK2Q*/ 00380000
         MVC   CNTLHEAD(5,@15),@CB02270                            0129 00381000
*TOMBFCNT=DATALENG+6;                /* SET LGTH OF OUTPUT RU@G58AK2Q*/ 00382000
         AL    @14,@CF00033                                        0130 00383000
         ST    @14,TOMBFCNT(,TOMWAPTR)                             0130 00384000
*TOMGETMN=TVWAGMPT+8;                /* SET ADDR OF OUTPUT RU@G58AK2Q*/ 00385000
         AL    @15,@CF00062                                        0131 00386000
         ST    @15,TOMGETMN(,TOMWAPTR)                             0131 00387000
*TVWAKBDL='0'B;                      /* KEYBD IS UNLOCKED    @G58AK2Q*/ 00388000
         NI    TVWAKBDL(TVWAPTR),B'11011111'                       0132 00389000
*IF TOMPGNSV='0'B THEN               /* NO PAGING?           @ZM20919*/ 00390000
         TM    TOMPGNSV(TOMWAPTR),B'00010000'                      0133 00391000
         BNZ   @RF00133                                            0133 00392000
*  TVWAPGN='0'B;                     /* TURN OFF PAGING BIT  @ZM20919*/ 00393000
         NI    TVWAPGN(TVWAPTR),B'10111111'                        0134 00394000
*ELSE                                /* PAGING               @ZM20919*/ 00395000
*  TVWAPGN='1'B;                     /* TURN ON PAGING BIT   @ZM20919*/ 00396000
         B     @RC00133                                            0135 00397000
@RF00133 OI    TVWAPGN(TVWAPTR),B'01000000'                        0135 00398000
*END SCRNREST;                       /* END OF SCRNREST      @G58AK2Q*/ 00399000
@EL00006 DS    0H                                                  0136 00400000
@EF00006 DS    0H                                                  0136 00401000
@ER00006 L     @14,12(,@13)                                        0136 00402000
         BR    @14                                                 0136 00403000
         EJECT                                                          00404000
*/********************************************************************/ 00405000
*/*                                                                  */ 00406000
*/* THIS PROCEDURE, BLDRU, WILL CONTROL THE BUILDING OF THE OUTPUT.  */ 00407000
*/* APPROPRIATE ROUTINES WILL BE CALLED TO PUT DATA IN THE OUTPUT    */ 00408000
*/* RU.                                                              */ 00409000
*/*                                                                  */ 00410000
*/********************************************************************/ 00411000
*                                                                  0137 00412000
*BLDRU: PROCEDURE OPTIONS(SAVE(14));                               0137 00413000
*                                                                  0137 00414000
BLDRU    ST    @14,@SA00007                                        0137 00415000
*OPASID  ='0'B;                      /* SET CROSS-MEMORY FLAG OFF    */ 00416000
         NI    OPASID(TOMWAPTR),B'11110111'                        0138 00417000
*TOMSCHED='0'B;                      /* SEND RU POST=RESP            */ 00418000
         NI    TOMSCHED(TOMWAPTR),B'11110111'                      0139 00419000
*TOMCURST='0'B;                      /* CURSOR NOT SET IN OUTPUT RU  */ 00420000
*TOMEXBRU='0'B;                      /* OFF, CONTINUE RU DATA BUILD  */ 00421000
         NI    TOMCURST(TOMWAPTR),B'11101101'                      0141 00422000
*TOMKBULK='0'B;                      /* KEYBD UNLOCK NOT REQ'ED YET  */ 00423000
         NI    TOMKBULK(TOMWAPTR),B'01111111'                      0142 00424000
*TOMBFCNT= 0  ;                      /* SET COUNT OF DATA IN RU TO 0 */ 00425000
         SLR   @12,@12                                             0143 00426000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0143 00427000
*TOMTRSBA='0'B;                      /* SAVE LAST ATTRBUTE ADDRESS   */ 00428000
*TOMALARM='0'B;                      /* OFF, AUDIBLE ALARM REQUEST   */ 00429000
*TOMERASE='0'B;                      /* NO SCRN ERASE NEEDED         */ 00430000
         NI    TOMTRSBA(TOMWAPTR),B'10101110'                      0146 00431000
*IF TVWABKMG='1'B THEN               /* IS FLASHBACK DATA PENDING?   */ 00432000
         TM    TVWABKMG(TVWAPTR),B'00000100'                       0147 00433000
         BNO   @RF00147                                            0147 00434000
*  /******************************************************************/ 00435000
*  /*                                                                */ 00436000
*  /*      PUT LAST INPUT LINE(S) AT TOP OF 3270 SCREEN IF YES.      */ 00437000
*  /*                                                                */ 00438000
*  /******************************************************************/ 00439000
*  CALL FLSHBACK;                    /* PUT FLASHBACK IN OUTPUT RU   */ 00440000
         BAL   @14,FLSHBACK                                        0148 00441000
*ELSE;                               /* NO FLASHBACK PENDING         */ 00442000
@RF00147 DS    0H                                                  0150 00443000
*IF (TVWAERMG='1'B)&                 /* TEST FOR TIM'S ERROR MESSAGE */ 00444000
*   (TOMEXBRU='0'B) THEN             /* CAN RU BUILD CONTINUE?       */ 00445000
         TM    TVWAERMG(TVWAPTR),B'00001000'                       0150 00446000
         BNO   @RF00150                                            0150 00447000
         TM    TOMEXBRU(TOMWAPTR),B'00000010'                      0150 00448000
         BNZ   @RF00150                                            0150 00449000
*  /******************************************************************/ 00450000
*  /*                                                                */ 00451000
*  /*            PUT TIM'S ERROR MESSAGE IN OUTPUT RU                */ 00452000
*  /*                                                                */ 00453000
*  /******************************************************************/ 00454000
*  CALL BLDERR;                      /* GO TO ERROR MESSAGE ROUTINE  */ 00455000
         BAL   @14,BLDERR                                          0151 00456000
*ELSE;                               /* TIM'S ERR MESSAGE NOT PENDING*/ 00457000
@RF00150 DS    0H                                                  0153 00458000
*IF ((TVWAATTN^=0)   |               /* REQ FOR ATTENTION ACCEPTED?  */ 00459000
*    (TVWAAIGN='1'B))&               /* REQ FOR ATTENTION IGNORED?   */ 00460000
*    (TOMEXBRU='0'B)  THEN           /* CAN RU BUILD CONTINUE        */ 00461000
         CLI   TVWAATTN(TVWAPTR),0                                 0153 00462000
         BNE   @GL00003                                            0153 00463000
         TM    TVWAAIGN(TVWAPTR),B'00100000'                       0153 00464000
         BNO   @RF00153                                            0153 00465000
@GL00003 TM    TOMEXBRU(TOMWAPTR),B'00000010'                      0153 00466000
         BNZ   @RF00153                                            0153 00467000
*  /******************************************************************/ 00468000
*  /*                                                                */ 00469000
*  /*    PUT ATTENTION ACCEPTED AND/OR IGNORED MESSAGE(S) IN RU.     */ 00470000
*  /*                                                                */ 00471000
*  /******************************************************************/ 00472000
*  CALL BLDATTN;                     /* PUT ATTENTION MESSAGES IN RU */ 00473000
         BAL   @14,BLDATTN                                         0154 00474000
*ELSE;                               /* NO ATTENTION MESSAGES PENDING*/ 00475000
@RF00153 DS    0H                                                  0156 00476000
*/********************************************************************/ 00477000
*/*                                                                  */ 00478000
*/*            BUILD AND EDIT USER DATA IN OUTPUT RU.                */ 00479000
*/*                                                                  */ 00480000
*/********************************************************************/ 00481000
*IF TOMEXBRU='0'B THEN               /* CAN RU BUILD CONTINUE?       */ 00482000
         TM    TOMEXBRU(TOMWAPTR),B'00000010'                      0156 00483000
         BNZ   @RF00156                                            0156 00484000
*  CALL BLDDTA;                      /* YES, CALL DATA BUILD ROUTINE */ 00485000
         BAL   @14,BLDDTA                                          0157 00486000
*ELSE;                                                             0158 00487000
@RF00156 DS    0H                                                  0159 00488000
*IF (TSBSPIT='0'B) &                 /* NO TCLEARQ OR STBREAK ISSUED?*/ 00489000
*   (TSBAUTON='1'B)&                 /* IS AUTO-PROMPTING IS EFFECT? */ 00490000
*   (TSBSTAUT='1'B)&                 /* CAN PROMPT BE STARTED NOW?   */ 00491000
*   (TOMEXBRU='0'B) THEN             /* CAN RU BUILD CONTINUE?       */ 00492000
         L     @12,PSAAOLD                                         0159 00493000
         L     @12,ASCBTSB(,@12)                                   0159 00494000
         TM    TSBSPIT(@12),B'00100000'                            0159 00495000
         BNZ   @RF00159                                            0159 00496000
         TM    TSBAUTON(@12),B'01000100'                           0159 00497000
         BNO   @RF00159                                            0159 00498000
         TM    TOMEXBRU(TOMWAPTR),B'00000010'                      0159 00499000
         BNZ   @RF00159                                            0159 00500000
*  /******************************************************************/ 00501000
*  /*                                                                */ 00502000
*  /*       BUILD LINE OR CHARACTER PROMPT DATA IN OUTPUT RU.        */ 00503000
*  /*                                                                */ 00504000
*  /******************************************************************/ 00505000
*  CALL BLDPRMPT;                    /* GO TO PROMPT ROUNTINE        */ 00506000
         BAL   @14,BLDPRMPT                                        0160 00507000
*ELSE;                               /* NO AUTO-PROMPT REQUESTED     */ 00508000
@RF00159 DS    0H                                                  0162 00509000
*IF TOMBFCNT>0 & TOMLNCNT>1 THEN     /* DATA IN RU & NOT FIRST LINE? */ 00510000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0162 00511000
         LTR   @12,@12                                             0162 00512000
         BNP   @RF00162                                            0162 00513000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0162 00514000
         C     @12,@CF00064                                        0162 00515000
         BNH   @RF00162                                            0162 00516000
*  IF TOMTRSBA='0'B |                /* IS LINE-COUNT GREATER THAN 1?*/ 00517000
*     TOMEDSAV='00'B |               /* LAST TPUT AN EDIT?   @ZA17040*/ 00518000
*     TOMEDSAV='01'B THEN            /* LAST TPUT AN ASIS?   @ZA17040*/ 00519000
         TM    TOMTRSBA(TOMWAPTR),B'00000001'                      0163 00520000
         BZ    @RT00163                                            0163 00521000
         TM    TOMEDSAV(TOMWAPTR),B'11000000'                      0163 00522000
         BZ    @RT00163                                            0163 00523000
         TM    TOMEDSAV(TOMWAPTR),B'01000000'                      0163 00524000
         BNO   @RF00163                                            0163 00525000
         TM    TOMEDSAV(TOMWAPTR),B'10000000'                      0163 00526000
         BNZ   @RF00163                                            0163 00527000
@RT00163 DS    0H                                                  0164 00528000
*    TVWASCAN='1'B;                  /* YES                  @ZA19883*/ 00529000
         OI    TVWASCAN(TVWAPTR),B'10000000'                       0164 00530000
*  ELSE                              /* NO ATTRIBUTE TRACKING NEEDED */ 00531000
*    TVWASCAN='0'B;                  /* TURN OFF REQ FOR ATTRIB TRACK*/ 00532000
         B     @RC00163                                            0165 00533000
@RF00163 NI    TVWASCAN(TVWAPTR),B'01111111'                       0165 00534000
*ELSE;                               /* RU EMPTY OR FIRST LINE       */ 00535000
@RF00162 DS    0H                                                  0167 00536000
*IF TOMBFCNT>0 THEN                  /* DATA IN RU?          @ZA17040*/ 00537000
@RC00162 L     @12,TOMBFCNT(,TOMWAPTR)                             0167 00538000
         LTR   @12,@12                                             0167 00539000
         BNP   @RF00167                                            0167 00540000
*  TVWADARC='0'B;                    /* RESET DATA FOUND BIT @ZA17040*/ 00541000
         NI    TVWADARC(TVWAPTR),B'11111110'                       0168 00542000
*ELSE;                               /* RU EMPTY             @ZA17040*/ 00543000
@RF00167 DS    0H                                                  0170 00544000
*IF TOMENDBF='0'B THEN               /* ENOUGH BUFFER SPACE? @ZA19888*/ 00545000
         TM    TOMENDBF(TOMWAPTR),B'00100000'                      0170 00546000
         BNZ   @RF00170                                            0170 00547000
*  IF (TOMCURST='0'B)&               /* IS CURSOR ALREADY SET IN RU? */ 00548000
*     (TOMBFCNT>0) THEN              /* IS THERE DATA IN OUTPUT RU?  */ 00549000
         TM    TOMCURST(TOMWAPTR),B'00010000'                      0171 00550000
         BNZ   @RF00171                                            0171 00551000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0171 00552000
         LTR   @12,@12                                             0171 00553000
         BNP   @RF00171                                            0171 00554000
*     /***************************************************************/ 00555000
*     /*                                                             */ 00556000
*     /* THIS DO GROUP WILL SET CURSOR FOR ALL NON-EMPTY RU'S FOR    */ 00557000
*     /* WHICH CURSOR HAS NOT ALREADY BEEN SET.                      */ 00558000
*     /*                                                             */ 00559000
*     /***************************************************************/ 00560000
*    DO;                             /* BEGIN DEFAULT CURSOR PROCESS */ 00561000
*      CALL NEWLINE;                 /* PUT LINE ADDR IN OUTPUT RU   */ 00562000
         BAL   @14,NEWLINE                                         0173 00563000
*      IF (TOMLNCNT>=TOMLNNO)&       /* LINE-COUNT AT LAST SCRN LINE?*/ 00564000
*         (TVWANOFB='0'B) THEN       /* IS IT OKAY TO DO FLASHBACK?  */ 00565000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0174 00566000
         C     @12,TOMLNNO(,TOMWAPTR)                              0174 00567000
         BL    @RF00174                                            0174 00568000
         TM    TVWANOFB(TVWAPTR),B'00010000'                       0174 00569000
         BNZ   @RF00174                                            0174 00570000
*        CALL SCRNPAGE;              /* YES, PUT PAGE PROMPT IN RU   */ 00571000
         BAL   @14,SCRNPAGE                                        0175 00572000
*      ELSE                          /* NOT LAST LINE OR NO FLASHBACK*/ 00573000
*        DO;                         /* SET CURSOR ON CURRENT LINE   */ 00574000
         B     @RC00174                                            0176 00575000
@RF00174 DS    0H                                                  0177 00576000
*          TOMBFCNT=TOMBFCNT+1;      /* UPDATE COUNT OF DATA IN RU   */ 00577000
         LA    @12,1                                               0177 00578000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0177 00579000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0177 00580000
*          IKTOBUF=IC;               /* PUT INSERT CURSOR IN RU      */ 00581000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0178 00582000
         XC    IKTOBUF+1(255,@01),IKTOBUF+1(@01)                   0178 00583000
         MVI   IKTOBUF(@01),X'13'                                  0178 00584000
*          TOMBFPTR=TOMGETMN+TOMBFCNT; /* UPDATE RU BUFFER POINTER   */ 00585000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0179 00586000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0179 00587000
*          TOMSTCUR='0'B;            /* TURN OFF REQUEST FOR CURSOR  */ 00588000
         NI    TOMSTCUR(TOMWAPTR),B'11111011'                      0180 00589000
*        END;                        /* END CURSOR SETING OF CURSOR  */ 00590000
*    END;                            /* END DEFAULT CURSOR PROCESS   */ 00591000
*  ELSE                              /* CURSOR IS SET OR RU IS EMPTY */ 00592000
*    IF (TOMSTCUR='1'B)&             /* REQ FOR CURSOR AFTER PAGING? */ 00593000
*       (TOMBFCNT=0)  THEN           /* IS OUTPUT RU EMPTY?          */ 00594000
         B     @RC00171                                            0183 00595000
@RF00171 TM    TOMSTCUR(TOMWAPTR),B'00000100'                      0183 00596000
         BNO   @RF00183                                            0183 00597000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0183 00598000
         LTR   @12,@12                                             0183 00599000
         BNZ   @RF00183                                            0183 00600000
*      DO;                           /* SET CURSOR AT TOP OF SCREEN  */ 00601000
*        CALL SCRFORMT;              /* PUT CMD,WCC, & FORMAT IN RU  */ 00602000
         BAL   @14,SCRFORMT                                        0185 00603000
*        CALL NEWLINE;               /* PUT LINE ADDRESS IN RU       */ 00604000
         BAL   @14,NEWLINE                                         0186 00605000
*        IKTOBUF(1)=IC;              /* PUT INSERT CURSOR IN RU      */ 00606000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0187 00607000
         MVI   IKTOBUF(@12),X'13'                                  0187 00608000
*        TOMBFCNT=TOMBFCNT+1;        /* UPDATE CNT FOR CURS          */ 00609000
         LA    @12,1                                               0188 00610000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0188 00611000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0188 00612000
*        TOMBFPTR=TOMGETMN+TOMBFCNT; /* UPDATE RU BUFFER PTR         */ 00613000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0189 00614000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0189 00615000
*        TOMSTCUR='0'B;              /* TURN OFF REQUEST FOR CURSOR  */ 00616000
         NI    TOMSTCUR(TOMWAPTR),B'11111011'                      0190 00617000
*      END;                          /* END SET CURSOR AT TOP OF SCRN*/ 00618000
*    ELSE                            /* NO CURSOR REQ OR RU NOT EMPTY*/ 00619000
*      TOMSTCUR='0'B;                /* OFF, REQ FOR CURS AFTER PAGE */ 00620000
         B     @RC00183                                            0192 00621000
@RF00183 NI    TOMSTCUR(TOMWAPTR),B'11111011'                      0192 00622000
*ELSE;                               /* NOT ENOUGH BUFFER SP @ZA19888*/ 00623000
@RF00170 DS    0H                                                  0194 00624000
*RFY (REG2) RSTD;                    /* RESTRICT REGISTER 2          */ 00625000
@RC00170 DS    0H                                                  0195 00626000
*REG2=TOMGETMN;                      /* SET ADDR OF OUTPUT RU IN R2  */ 00627000
         L     REG2,TOMGETMN(,TOMWAPTR)                            0195 00628000
*IF TOMALARM='1'B THEN               /* SOUND AUDIBLE ALARM REQUEST? */ 00629000
         TM    TOMALARM(TOMWAPTR),B'01000000'                      0196 00630000
         BNO   @RF00196                                            0196 00631000
*  GEN(OI 1(REG2),X'04')             /* YES, MODIFY WCC FOR ALARM    */ 00632000
*     REFS(REG2);                    /* REGISTER 2 IS REFERENCED     */ 00633000
         OI 1(REG2),X'04'                                               00634000
*ELSE;                               /* NO AUDIBLE ALARM REQUESTED   */ 00635000
@RF00196 DS    0H                                                  0199 00636000
*RFY (REG2) UNRSTD;                  /* UNRESTRICT REGISTER 2        */ 00637000
*IF TOMBRKPG='1'B THEN               /* PAGE AFTER BREAK-IN? @G58AK2Q*/ 00638000
         TM    TOMBRKPG(TOMWAPTR),B'00000010'                      0200 00639000
         BNO   @RF00200                                            0200 00640000
*  DO;                               /*                      @G58AK2Q*/ 00641000
*    IF TVWAPGN='0'B THEN            /* NO SCREEN PAGING?    @ZM21356*/ 00642000
         TM    TVWAPGN(TVWAPTR),B'01000000'                        0202 00643000
         BNZ   @RF00202                                            0202 00644000
*      DO;                           /*                      @ZM21356*/ 00645000
*        IF TOMBFCNT=0 THEN          /* IS CURRENT RU EMPTY? @G58AK2Q*/ 00646000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0204 00647000
         LTR   @12,@12                                             0204 00648000
         BNZ   @RF00204                                            0204 00649000
*          CALL SCRFORMT;            /* PUT CMD & WCC IN RU  @G58AK2Q*/ 00650000
         BAL   @14,SCRFORMT                                        0205 00651000
*        ELSE;                       /*                      @G58AK2Q*/ 00652000
@RF00204 DS    0H                                                  0207 00653000
*        CALL SCRNPAGE;              /* PUT IS PAGE PROMPT   @G58AK2Q*/ 00654000
         BAL   @14,SCRNPAGE                                        0207 00655000
*      END;                          /*                      @ZM21356*/ 00656000
*    ELSE;                           /* SCREEN PAGING        @ZM21356*/ 00657000
@RF00202 DS    0H                                                  0210 00658000
*    TOMBPRSP='1'B;                  /* BREAK-IN IS COMPLETE @G58AK2Q*/ 00659000
*    TOMBRKPG='0'B;                  /* BREAK-IN IS COMPLETE @G58AK2Q*/ 00660000
         OI    TOMBPRSP(TOMWAPTR),B'00000100'                      0211 00661000
         NI    TOMBRKPG(TOMWAPTR),B'11111101'                      0211 00662000
*    TVWABKPG='1'B;                  /* BREAK-IN PAGING              */ 00663000
         OI    TVWABKPG(TVWAPTR),B'10000000'                       0212 00664000
*  END;                              /*                      @G58AK2Q*/ 00665000
*ELSE;                               /*                      @G58AK2Q*/ 00666000
@RF00200 DS    0H                                                  0215 00667000
*IF ((TOMEXBRU='0'B | TVWANOFB='1'B) /* CONTINUE BLDRU?      @G58AK3B*/ 00668000
*  & TVWAULK='1'B ) |                /* GLOBAL UNLOCK REQ    @G58AK3B*/ 00669000
*   (TOMKBULK='1'B)  THEN            /* LOCAL REQ FOR KEYBD UNLOCK?  */ 00670000
         TM    TOMEXBRU(TOMWAPTR),B'00000010'                      0215 00671000
         BZ    @GL00014                                            0215 00672000
         TM    TVWANOFB(TVWAPTR),B'00010000'                       0215 00673000
         BNO   @GL00013                                            0215 00674000
@GL00014 TM    TVWAULK(TVWAPTR),B'00000100'                        0215 00675000
         BO    @RT00215                                            0215 00676000
@GL00013 TM    TOMKBULK(TOMWAPTR),B'10000000'                      0215 00677000
         BNO   @RF00215                                            0215 00678000
@RT00215 DS    0H                                                  0216 00679000
*  DO;                                                             0216 00680000
*  /******************************************************************/ 00681000
*  /*                                                                */ 00682000
*  /* MODIFY WCC IN RU TO RESTORE KEYBOARD OPERATION IF KEYBOARD UN- */ 00683000
*  /* LOCK REQUEST IS OUTSTANDING.                                   */ 00684000
*  /*                                                                */ 00685000
*  /******************************************************************/ 00686000
*  IF TOMBFCNT^=0 | TOMEB='0'B THEN                                0217 00687000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0217 00688000
         LTR   @12,@12                                             0217 00689000
         BNZ   @RT00217                                            0217 00690000
         TM    TOMEB(TOMWAPTR),B'01000000'                         0217 00691000
         BNZ   @RF00217                                            0217 00692000
@RT00217 DS    0H                                                  0218 00693000
*    DO;                             /* BEGIN UNLOCK KEYBD PROCESS   */ 00694000
*      IF TOMBFCNT=0 THEN            /* RU FOR UNLOCK KEYBOARD ONLY? */ 00695000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0219 00696000
         LTR   @12,@12                                             0219 00697000
         BNZ   @RF00219                                            0219 00698000
*        DO;                         /* YES, RU IS FOR KB UNLOCK ONLY*/ 00699000
*          IF TVWAFMSC='1'B |        /* FORMAT SCREEN?       @ZA19498*/ 00700000
*            (TVWADARC='1'B &        /* HAS TIM RECEIVED DATA?       */ 00701000
*             TOMLNCNT>1) THEN       /* IS LINE-COUNT GREATER THAN 1?*/ 00702000
         TM    TVWAFMSC(TVWAPTR),B'10000000'                       0221 00703000
         BO    @RT00221                                            0221 00704000
         TM    TVWADARC(TVWAPTR),B'00000001'                       0221 00705000
         BNO   @RF00221                                            0221 00706000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0221 00707000
         C     @12,@CF00064                                        0221 00708000
         BNH   @RF00221                                            0221 00709000
@RT00221 DS    0H                                                  0222 00710000
*            DO;                     /* SET SPECIAL CURSOR FOR INPUT */ 00711000
*              CALL SCRFORMT;        /* CMD,WCC, & FORMAT            */ 00712000
         BAL   @14,SCRFORMT                                        0223 00713000
*              CALL NEWCURS;         /* PUT CURSOR IN RU             */ 00714000
         BAL   @14,NEWCURS                                         0224 00715000
*            END;                    /* END SET SPECIAL CURSOR       */ 00716000
*          ELSE                      /* BLD HEADER FOR UNLOCK RU     */ 00717000
*            DO;                     /* BLD HEADER FOR UNLOCK REQ    */ 00718000
         B     @RC00221                                            0226 00719000
@RF00221 DS    0H                                                  0227 00720000
*              IKTOBUF(1:2)=WRTWCC;  /* YES, PUT CMD AND WCC         */ 00721000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0227 00722000
         MVC   IKTOBUF(2,@12),@CB01968                             0227 00723000
*              TOMBFCNT=TOMBFCNT+2;  /* UPDATE COUNT OF DATA IN RU   */ 00724000
         LA    @12,2                                               0228 00725000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0228 00726000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0228 00727000
*             TOMBFPTR=TOMGETMN+TOMBFCNT;/* UPDATE RU BUFFER POINTER */ 00728000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0229 00729000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0229 00730000
*            END;                    /* END BLD HEADER FOR UNLOCK    */ 00731000
*          TVWADARC='0'B;            /* OFF, DATA RECEIVED           */ 00732000
@RC00221 NI    TVWADARC(TVWAPTR),B'11111110'                       0231 00733000
*        END;                        /* END RU FOR UNLOCK KEYBD ONLY */ 00734000
*      ELSE;                         /* RU IS NON-EMPTY              */ 00735000
@RF00219 DS    0H                                                  0234 00736000
*      RFY (REG2) RSTD;              /* RESTRICT REGISTER 2          */ 00737000
*      REG2=TOMGETMN;                /* SET ADDR OF RU IN REGISTER 2 */ 00738000
         L     REG2,TOMGETMN(,TOMWAPTR)                            0235 00739000
*      GEN(OI 1(REG2),X'02')         /* MODIFY WCC TO RESTORE KEYBD  */ 00740000
*       REFS(REG2);                  /* REGISTER 2 IS REFERENCED     */ 00741000
         OI 1(REG2),X'02'                                               00742000
*      RFY (REG2) UNRSTD;            /* UNRESTRICT REGISTER 2        */ 00743000
*      IF TSBNOBRK='1'B THEN         /* NO BREAK TERMINAL?           */ 00744000
         L     @12,PSAAOLD                                         0238 00745000
         L     @12,ASCBTSB(,@12)                                   0238 00746000
         TM    TSBNOBRK(@12),B'00000010'                           0238 00747000
         BNO   @RF00238                                            0238 00748000
*        TVWATAS='1'B;               /* ONLY TIM SHOULD SCHEDULE TOM */ 00749000
         OI    TVWATAS(TVWAPTR),B'00100000'                        0239 00750000
*      ELSE;                         /* BREAK TERMINAL               */ 00751000
@RF00238 DS    0H                                                  0241 00752000
*      TOMCOLMN=0;                   /* RESET COLUMN COUNT   @ZA1BBBB*/ 00753000
         SLR   @12,@12                                             0241 00754000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0241 00755000
*    END;                            /* END UNLOCK KEYBOARD PROCESS  */ 00756000
*  ELSE;                             /* KEYBOARD ALREADY RESTORED    */ 00757000
@RF00217 DS    0H                                                  0244 00758000
*  TVWAKBDL='0'B;                    /* SET KEYBD STATE TO UNLOCKED  */ 00759000
         NI    TVWAKBDL(TVWAPTR),B'11011111'                       0244 00760000
*  IF TVWAPGN='0'B THEN              /* IS UNLOCK FOR PAGING?        */ 00761000
         TM    TVWAPGN(TVWAPTR),B'01000000'                        0245 00762000
         BNZ   @RF00245                                            0245 00763000
*    TVWAULK='0'B;                   /* NO, TURN OFF USER REQUEST    */ 00764000
         NI    TVWAULK(TVWAPTR),B'11111011'                        0246 00765000
*  ELSE;                             /* KB UNLOCK IS NOT FOR PAGING  */ 00766000
@RF00245 DS    0H                                                  0248 00767000
*  END;                                                            0248 00768000
*ELSE;                               /* NO KEYBD UNLOCK REQUESTED    */ 00769000
@RF00215 DS    0H                                                  0250 00770000
*TVWALNCT=TOMLNCNT;                  /* UPDATE LINE-COUNT IN TVWA    */ 00771000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0250 00772000
         STC   @12,TVWALNCT(,TVWAPTR)                              0250 00773000
*END BLDRU;                          /* END OF BLDRU                 */ 00774000
@EL00007 DS    0H                                                  0251 00775000
@EF00007 DS    0H                                                  0251 00776000
@ER00007 L     @14,@SA00007                                        0251 00777000
         BR    @14                                                 0251 00778000
         EJECT                                                          00779000
*/********************************************************************/ 00780000
*/*                                                                  */ 00781000
*/* THIS PROCEDURE, NEWLINE, WILL BE CALLED BY INTERNAL PROCEDURES   */ 00782000
*/* TO BUILD LINE ADDRESSES WHILE BUILDING THE OUTPUT RU.            */ 00783000
*/*                                                                  */ 00784000
*/********************************************************************/ 00785000
*                                                                  0252 00786000
*NEWLINE: PROCEDURE OPTIONS(SAVE(14));                             0252 00787000
*                                                                  0252 00788000
NEWLINE  ST    @14,@SA00008                                        0252 00789000
*RFY REG2 RSTD;                      /* RESTRICT REGISTER 2  @ZA17886*/ 00790000
*REG2=1;                             /* SET R2 FOR BUFFER ADDRESS    */ 00791000
         LA    REG2,1                                              0254 00792000
*CALL BUFFADDR;                      /* PUT LINE ADDRESS IN RU       */ 00793000
         BAL   @14,BUFFADDR                                        0255 00794000
*TOMBFCNT=TOMBFCNT+3;                /* SET CNT FOR LINE ADDR IN RU  */ 00795000
         LA    @12,3                                               0256 00796000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0256 00797000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0256 00798000
*IKTOBUF(1)=SBA;                     /* PUT SBA ORDER IN RU          */ 00799000
         L     @03,TOMBFPTR(,TOMWAPTR)                             0257 00800000
         MVI   IKTOBUF(@03),X'11'                                  0257 00801000
*IKTOBUF(2:3)=TOMLNADR;              /* PUT LINE ADDR IN OUTPUT RU   */ 00802000
         MVC   IKTOBUF+1(2,@03),TOMLNADR(TOMWAPTR)                 0258 00803000
*TOMBFPTR=TOMGETMN+TOMBFCNT;         /* POINT TO NEXT UNUSED RU BYTE */ 00804000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0259 00805000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0259 00806000
*RFY REG2 UNRSTD;                    /* UNRESTRICT REGISTER 2@ZA17886*/ 00807000
*END NEWLINE;                        /* END OF NEWLINE               */ 00808000
@EL00008 DS    0H                                                  0261 00809000
@EF00008 DS    0H                                                  0261 00810000
@ER00008 L     @14,@SA00008                                        0261 00811000
         BR    @14                                                 0261 00812000
         EJECT                                                          00813000
*/********************************************************************/ 00814000
*/*                                                                  */ 00815000
*/* THIS PROCEDURE, BUFFADDR, WILL COMPUTE BUFFER ADDRESSES FOR TOM  */ 00816000
*/*                                                                  */ 00817000
*/********************************************************************/ 00818000
*                                                                  0262 00819000
*BUFFADDR: PROCEDURE OPTIONS(SAVE(14));                            0262 00820000
*                                                                  0262 00821000
BUFFADDR ST    @14,12(,@13)                                        0262 00822000
*TOMLNCNT=MIN(TOMLNCNT,TOMLNNO);     /* NOT BEYOND LAST SCREEN LINE  */ 00823000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0263 00824000
         L     @15,TOMLNNO(,TOMWAPTR)                              0263 00825000
         CR    @12,@15                                             0263 00826000
         BNH   *+6                                                      00827000
         LR    @12,@15                                             0263 00828000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0263 00829000
*RFY REG2 RSTD;                      /* RESTRICT REGISTER 2  @ZA17886*/ 00830000
*J=(TOMLNCNT-REG2)*TOMPLSZ+TOMCOLMN; /* OFFSET               @ZA17886*/ 00831000
         LR    @01,@12                                             0265 00832000
         SLR   @01,REG2                                            0265 00833000
         M     @00,TOMPLSZ(,TOMWAPTR)                              0265 00834000
         AL    @01,TOMCOLMN(,TOMWAPTR)                             0265 00835000
         ST    @01,J(,TOMWAPTR)                                    0265 00836000
*J=MAX(0,J);                         /* J IS NONZERO         @ZA19877*/ 00837000
         SLR   @12,@12                                             0266 00838000
         CR    @01,@12                                             0266 00839000
         BNL   *+6                                                      00840000
         LR    @01,@12                                             0266 00841000
         ST    @01,J(,TOMWAPTR)                                    0266 00842000
*TOMROWAD=J/64;                      /* SET ROW INDEX FOR TRANSLATE  */ 00843000
         LR    @10,@01                                             0267 00844000
         SRDA  @10,32                                              0267 00845000
         D     @10,@CF01025                                        0267 00846000
         STC   @11,TOMROWAD(,TOMWAPTR)                             0267 00847000
*TOMCOLAD=J//64;                     /* SET COL INDEX FOR TRANSLATE  */ 00848000
         LR    @10,@01                                             0268 00849000
         SRDA  @10,32                                              0268 00850000
         D     @10,@CF01025                                        0268 00851000
         STC   @10,TOMCOLAD(,TOMWAPTR)                             0268 00852000
*TR(TOMLNADR,BFADRTAB);              /* SAVE BUFFER ADDRESS          */ 00853000
         TR    TOMLNADR(2,TOMWAPTR),BFADRTAB                       0269 00854000
*RFY REG2 UNRSTD;                    /* UNRESTRICT REGISTER 2        */ 00855000
*END BUFFADDR;                       /* END OF BUFFADDR              */ 00856000
@EL00009 DS    0H                                                  0271 00857000
@EF00009 DS    0H                                                  0271 00858000
@ER00009 L     @14,12(,@13)                                        0271 00859000
         BR    @14                                                 0271 00860000
         EJECT                                                          00861000
*/********************************************************************/ 00862000
*/*                                                                  */ 00863000
*/* THIS PROCEDURE, NEWCURS, WILL SET CURSOR AFTER SUCCESSIVE TGETS. */ 00864000
*/*                                                                  */ 00865000
*/********************************************************************/ 00866000
*                                                                  0272 00867000
*NEWCURS: PROCEDURE OPTIONS(SAVE(14));                             0272 00868000
*                                                                  0272 00869000
NEWCURS  ST    @14,@SA00010                                        0272 00870000
*RFY REG2 RSTD;                      /* RESTRICT REGISTER 2  @ZA17886*/ 00871000
*REG2=2;                             /* SET R2 FOR BUFFER ADDRESS    */ 00872000
         LA    REG2,2                                              0274 00873000
*IF TOMCOLMN=TOMLNSZ THEN            /* NO SPACE ON LINE?    @ZA17040*/ 00874000
         L     @12,TOMCOLMN(,TOMWAPTR)                             0275 00875000
         SLR   @03,@03                                             0275 00876000
         IC    @03,TOMLNSZ(,TOMWAPTR)                              0275 00877000
         CR    @12,@03                                             0275 00878000
         BNE   @RF00275                                            0275 00879000
*  DO;                               /* NO SPACE ON LINE     @ZA17040*/ 00880000
*    TOMCOLMN=0;                     /* RESET COLUMN COUNT   @ZA17040*/ 00881000
         SLR   @12,@12                                             0277 00882000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0277 00883000
*    TOMLNCNT=TOMLNCNT+1;            /* MOVE TO NEXT LINE    @ZA17040*/ 00884000
         LA    @12,1                                               0278 00885000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0278 00886000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0278 00887000
*  END;                              /*                      @ZA17040*/ 00888000
*ELSE                                /* SPACE LEFT ON LINE   @ZA17040*/ 00889000
*  TOMCOLMN=TOMLNSZ-1;               /*                      @ZA17040*/ 00890000
         B     @RC00275                                            0280 00891000
@RF00275 SLR   @12,@12                                             0280 00892000
         IC    @12,TOMLNSZ(,TOMWAPTR)                              0280 00893000
         BCTR  @12,0                                               0280 00894000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0280 00895000
*CALL BUFFADDR;                      /* COMPUTE BUFFER ADDRESS       */ 00896000
@RC00275 BAL   @14,BUFFADDR                                        0281 00897000
*TOMBFCNT=TOMBFCNT+6;                /* UPDATE RU DATA COUNT         */ 00898000
         LA    @12,6                                               0282 00899000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0282 00900000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0282 00901000
*IKTOBUF(1)=SBA;                     /* PUT SBA ORDER IN RU          */ 00902000
         L     @03,TOMBFPTR(,TOMWAPTR)                             0283 00903000
         MVI   IKTOBUF(@03),X'11'                                  0283 00904000
*IKTOBUF(2:3)=TOMLNADR;              /* PUT BUFFER ADDRESS IN RU     */ 00905000
         MVC   IKTOBUF+1(2,@03),TOMLNADR(TOMWAPTR)                 0284 00906000
*IKTOBUF(4:6)=SFRDATIC;              /* READ ATTRIBUTE AND CURSOR    */ 00907000
         MVC   IKTOBUF+3(3,@03),@CB01960                           0285 00908000
*TOMBFPTR=TOMGETMN+TOMBFCNT;         /* UPDATE RU BUFFER POINTER     */ 00909000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0286 00910000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0286 00911000
*TOMCOLMN=0;                         /* RESET COLUMN COUNT   @ZM20919*/ 00912000
         SLR   @12,@12                                             0287 00913000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0287 00914000
*TVWASCAN='1'B;                      /* REQ ATTRIBUTE TRACKING       */ 00915000
         OI    TVWASCAN(TVWAPTR),B'10000000'                       0288 00916000
*RFY REG2 UNRSTD;                    /* FREE REGISTER 2              */ 00917000
*END NEWCURS;                        /* END OF NEWCURS               */ 00918000
@EL00010 DS    0H                                                  0290 00919000
@EF00010 DS    0H                                                  0290 00920000
@ER00010 L     @14,@SA00010                                        0290 00921000
         BR    @14                                                 0290 00922000
         EJECT                                                          00923000
*/********************************************************************/ 00924000
*/*                                                                  */ 00925000
*/* THIS PROCEDURE, SCRFORMT, FORMATS THE 3270 SCREEN (IF NEEDED)    */ 00926000
*/* AND PUTS THE PROPER WRITE CMD IN THE OUTPUT RU. THE SCREEN IS    */ 00927000
*/* FORMATTED BY PUTTING AN ATTRIBUTE CHARACTER IN THE LAST          */ 00928000
*/* BUFFER LOCATION.                                                 */ 00929000
*/*                                                                  */ 00930000
*/********************************************************************/ 00931000
*                                                                  0291 00932000
*SCRFORMT: PROCEDURE OPTIONS(SAVE(14));                            0291 00933000
*                                                                  0291 00934000
SCRFORMT ST    @14,12(,@13)                                        0291 00935000
*IF (TOMLNCNT=1)   |                 /* IS THIS THE TOP LINE OF SCRN?*/ 00936000
*   (TVWAFMSC='1'B) THEN             /* IS FORMAT OF SCRN REQUESTED? */ 00937000
         CLC   TOMLNCNT(4,TOMWAPTR),@CF00064                       0292 00938000
         BE    @RT00292                                            0292 00939000
         TM    TVWAFMSC(TVWAPTR),B'10000000'                       0292 00940000
         BNO   @RF00292                                            0292 00941000
@RT00292 DS    0H                                                  0293 00942000
*  /******************************************************************/ 00943000
*  /*                                                                */ 00944000
*  /* THIS DO GROUP FORMATS THE 3270 BUFFER AFTER DETERMINING THE    */ 00945000
*  /* LAST BUFFER LOCATION.                                          */ 00946000
*  /*                                                                */ 00947000
*  /******************************************************************/ 00948000
*  DO;                               /* SET FORMATTING DATA IN RU    */ 00949000
*    IF TVWAFMSC='1'B THEN           /* FORMAT SCREEN BIT ON?@ZM17040*/ 00950000
         TM    TVWAFMSC(TVWAPTR),B'10000000'                       0294 00951000
         BNO   @RF00294                                            0294 00952000
*      TOMCOLMN=0;                   /* RESET COLUMN COUNT   @ZA17040*/ 00953000
         SLR   @12,@12                                             0295 00954000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0295 00955000
*    ELSE;                           /* FORMAT SCREEN BIT OFF@ZA17040*/ 00956000
@RF00294 DS    0H                                                  0297 00957000
*    TOMBFCNT=7;                     /* COUNT FOR CMD,WCC, & FORMAT  */ 00958000
         MVC   TOMBFCNT(4,TOMWAPTR),@CF00034                       0297 00959000
*    IKTOBUF(3:7)=TOMFMTDA;          /* PUT FORMATTING DATA IN RU    */ 00960000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0298 00961000
         MVC   IKTOBUF+2(5,@12),TOMFMTDA(TOMWAPTR)                 0298 00962000
*    TVWAFMSC='0'B;                  /* TURN OFF REQUEST FOR FORMAT  */ 00963000
         NI    TVWAFMSC(TVWAPTR),B'01111111'                       0299 00964000
*  END;                              /* END SETTING OF FORMAT DATA   */ 00965000
*ELSE                                /* SCREEN FORMATTING NOT NEEDED */ 00966000
*  TOMBFCNT=2;                       /* SET COUNT FOR CMD AND WCC    */ 00967000
         B     @RC00292                                            0301 00968000
@RF00292 MVC   TOMBFCNT(4,TOMWAPTR),@CF00076                       0301 00969000
*IF (TVWAFSM='1'B &                  /* IS FULLSCR MODE IS EFFECT?   */ 00970000
*    TOMERASE='1'B) |                /* SCREEN ERASE?        @ZM20919*/ 00971000
*   (OPBRK='1'B &                    /* BREAK TPUT?          @ZM20919*/ 00972000
*    TVWABRIN='1'B) THEN             /* BREAK-IN PROCESSING? @ZM20919*/ 00973000
@RC00292 TM    TVWAFSM(TVWAPTR),B'01000000'                        0302 00974000
         BNO   @GL00020                                            0302 00975000
         TM    TOMERASE(TOMWAPTR),B'00010000'                      0302 00976000
         BO    @RT00302                                            0302 00977000
@GL00020 TM    OPBRK(TOMWAPTR),B'01000000'                         0302 00978000
         BNO   @RF00302                                            0302 00979000
         TM    TVWABRIN(TVWAPTR),B'10000000'                       0302 00980000
         BNO   @RF00302                                            0302 00981000
@RT00302 DS    0H                                                  0303 00982000
*  IKTOBUF(1:2)=EWRTWCCD;            /* YES, USE ERASE/WRITE         */ 00983000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0303 00984000
         MVC   IKTOBUF(2,@12),@CB01938                             0303 00985000
*ELSE                                /* NO, CONTINUE CHECK           */ 00986000
*  IF TOMLNCNT=1 THEN                /* IS THIS THE TOP SCREEN LINE? */ 00987000
         B     @RC00302                                            0304 00988000
@RF00302 CLC   TOMLNCNT(4,TOMWAPTR),@CF00064                       0304 00989000
         BNE   @RF00304                                            0304 00990000
*    IF (TOMEDSAV='11'B)&            /* WAS LAST TPUT FULLSCRN MODE? */ 00991000
*       (OPASID='1'B)    THEN        /* CURRENT TPUT A CROSS-MEMORY? */ 00992000
         TM    TOMEDSAV(TOMWAPTR),B'11000000'                      0305 00993000
         BNO   @RF00305                                            0305 00994000
         TM    OPASID(TOMWAPTR),B'00001000'                        0305 00995000
         BNO   @RF00305                                            0305 00996000
*      IKTOBUF(1:2)=WRTWCCDF;        /* USE WRT-ASID FOLLOWS FULSCRN */ 00997000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0306 00998000
         MVC   IKTOBUF(2,@12),@CB01970                             0306 00999000
*    ELSE                            /* USE ERASE WRITE COMMAND      */ 01000000
*      IF TOMCOLMN=0 THEN            /* FIRST POSITION?      @ZA19498*/ 01001000
         B     @RC00305                                            0307 01002000
@RF00305 L     @12,TOMCOLMN(,TOMWAPTR)                             0307 01003000
         LTR   @12,@12                                             0307 01004000
         BNZ   @RF00307                                            0307 01005000
*        IKTOBUF(1:2)=EWRTWCCD;      /* PUT EWRT CMD AND WCC IN RU   */ 01006000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0308 01007000
         MVC   IKTOBUF(2,@12),@CB01938                             0308 01008000
*      ELSE                          /* NOT FIRST POSITION   @ZA19498*/ 01009000
*        IKTOBUF(1:2)=WRTWCCDF;      /* WRITE CMD AND WCC    @ZA19498*/ 01010000
         B     @RC00307                                            0309 01011000
@RF00307 L     @12,TOMBFPTR(,TOMWAPTR)                             0309 01012000
         MVC   IKTOBUF(2,@12),@CB01970                             0309 01013000
*  ELSE                              /* THIS IS NOT TOP LINE-USE WRT */ 01014000
*    IKTOBUF(1:2)=WRTWCCDF;          /* PUT WRITE CMD AND WCC IN RU  */ 01015000
         B     @RC00304                                            0310 01016000
@RF00304 L     @12,TOMBFPTR(,TOMWAPTR)                             0310 01017000
         MVC   IKTOBUF(2,@12),@CB01970                             0310 01018000
*TOMBFPTR=TOMGETMN+TOMBFCNT;         /* UPDATE RU BUFFER POINTER     */ 01019000
@RC00304 DS    0H                                                  0311 01020000
@RC00302 L     @12,TOMGETMN(,TOMWAPTR)                             0311 01021000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0311 01022000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0311 01023000
*END SCRFORMT ;                      /* END OF SCRFORMT              */ 01024000
@EL00011 DS    0H                                                  0312 01025000
@EF00011 DS    0H                                                  0312 01026000
@ER00011 L     @14,12(,@13)                                        0312 01027000
         BR    @14                                                 0312 01028000
         EJECT                                                          01029000
*/********************************************************************/ 01030000
*/*                                                                  */ 01031000
*/* THIS PROCEDURE, FLSHBACK, WILL BE CALLED TO PUT THE LAST LOGICAL */ 01032000
*/* INPUT SCREEN LINE(S) INTO THE OUTPUT RU FOR DISPLAY AT THE TOP   */ 01033000
*/* OF THE SCREEN.                                                   */ 01034000
*/*                                                                  */ 01035000
*/********************************************************************/ 01036000
*                                                                  0313 01037000
*FLSHBACK: PROCEDURE OPTIONS(SAVE(14));                            0313 01038000
*                                                                  0313 01039000
FLSHBACK ST    @14,@SA00012                                        0313 01040000
*DCL 1 TOPQ BASED(TVWATOPQ),         /* STRUCTURE FOR FLASHBACK DATA */ 01041000
*     2 TQL1 CHAR(80),               /* FIRST FLASHBACK BUFFER       */ 01042000
*     2 TQL2 CHAR(80);               /* SECOND FLASHBACK BUFFER      */ 01043000
*                                                                  0314 01044000
*TOMCOLMN=0;                         /* RESET COLUMN COUNT   @ZA17886*/ 01045000
         SLR   @12,@12                                             0315 01046000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0315 01047000
*CALL SCRFORMT;                      /* PUT IN CMD,WCC, AND FORMAT   */ 01048000
         BAL   @14,SCRFORMT                                        0316 01049000
*IF TOMLNCNT>=TOMLNNO THEN           /* IS THIS THE LAST LINE?       */ 01050000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0317 01051000
         C     @12,TOMLNNO(,TOMWAPTR)                              0317 01052000
         BL    @RF00317                                            0317 01053000
*  DO;                               /*                      @ZA19882*/ 01054000
*    CALL NEWLINE;                   /* LINE ADDRESS IN RU   @ZA19882*/ 01055000
         BAL   @14,NEWLINE                                         0319 01056000
*    CALL SCRNPAGE;                  /* YES, PUT PAGE PROMPT IN RU   */ 01057000
         BAL   @14,SCRNPAGE                                        0320 01058000
*  END;                              /* END OF PAGING        @ZA19882*/ 01059000
*ELSE                                /* NO, CONTINUE FLSHBACK PROCESS*/ 01060000
*  /******************************************************************/ 01061000
*  /*                                                                */ 01062000
*  /* SCREEN LINE(S) IS AVAILABLE SO PUT FLASHBACK DATA IN RU.       */ 01063000
*  /*                                                                */ 01064000
*  /******************************************************************/ 01065000
*  DO;                               /* START FLASHBACK PROCESSING   */ 01066000
         B     @RC00317                                            0322 01067000
@RF00317 DS    0H                                                  0323 01068000
*    TOMLNCNT=1;                     /* TOP OF SCREEN        @ZA19882*/ 01069000
         MVC   TOMLNCNT(4,TOMWAPTR),@CF00064                       0323 01070000
*    CALL NEWLINE;                   /* LINE ADDRESS IN RU   @ZA19882*/ 01071000
         BAL   @14,NEWLINE                                         0324 01072000
*    IF TVWATQL1^=0 THEN             /* LENG OF 1ST FLSHBACK QUE > 0?*/ 01073000
         CLI   TVWATQL1(TVWAPTR),0                                 0325 01074000
         BE    @RF00325                                            0325 01075000
*      /**************************************************************/ 01076000
*      /*                                                            */ 01077000
*      /* TAKE DATA FROM FIRST FLASHBACK QUEUE BUFFER.               */ 01078000
*      /*                                                            */ 01079000
*      /**************************************************************/ 01080000
*      DO;                           /* BEGIN FIRST FLASHBACK PROCESS*/ 01081000
*        TOMBFCNT=TOMBFCNT+          /* UPDATE COUNT OF DATA IN RU BY*/ 01082000
*          MIN(TVWATQL1,TOMLNSZ)+2;  /* SMALLER OR LINE-SZ & QUE LENG*/ 01083000
         LA    @12,2                                               0327 01084000
         SLR   @15,@15                                             0327 01085000
         IC    @15,TVWATQL1(,TVWAPTR)                              0327 01086000
         SLR   @14,@14                                             0327 01087000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0327 01088000
         LR    @11,@14                                             0327 01089000
         CR    @11,@15                                             0327 01090000
         BNH   *+6                                                      01091000
         LR    @11,@15                                             0327 01092000
         AL    @11,TOMBFCNT(,TOMWAPTR)                             0327 01093000
         ALR   @11,@12                                             0327 01094000
         ST    @11,TOMBFCNT(,TOMWAPTR)                             0327 01095000
*        IKTOBUF(1:2)=SFWRTATT;      /* PUT WRITE ATTRIBUTE INTO RU  */ 01096000
         L     @10,TOMBFPTR(,TOMWAPTR)                             0328 01097000
         MVC   IKTOBUF(2,@10),@CB01964                             0328 01098000
*                                    /* MOVE FIRST FLSHBACK BUFFER   */ 01099000
*        IKTOBUF(3:(MIN(TVWATQL1,TOMLNSZ-1)+2))=TQL1; /* MOVE DATA   */ 01100000
         BCTR  @14,0                                               0329 01101000
         CR    @15,@14                                             0329 01102000
         BNH   *+6                                                      01103000
         LR    @15,@14                                             0329 01104000
         BCTR  @15,0                                               0329 01105000
         L     @01,TVWATOPQ(,TVWAPTR)                              0329 01106000
         EX    @15,@SM02405                                        0329 01107000
*        TR(IKTOBUF(3:(MIN(TVWATQL1,TOMLNSZ-1)+2)),EDITTAB);       0330 01108000
         SLR   @15,@15                                             0330 01109000
         IC    @15,TOMLNSZ(,TOMWAPTR)                              0330 01110000
         BCTR  @15,0                                               0330 01111000
         SLR   @14,@14                                             0330 01112000
         IC    @14,TVWATQL1(,TVWAPTR)                              0330 01113000
         CR    @14,@15                                             0330 01114000
         BNH   *+6                                                      01115000
         LR    @14,@15                                             0330 01116000
         BCTR  @14,0                                               0330 01117000
         EX    @14,@SB02407                                        0330 01118000
*                                    /* TRANSLATE            @ZA19882*/ 01119000
*        TOMBFPTR=TOMGETMN+TOMBFCNT; /* UPDATE RU BUFFER POINTER     */ 01120000
         L     @10,TOMGETMN(,TOMWAPTR)                             0331 01121000
         LR    @15,@10                                             0331 01122000
         ALR   @15,@11                                             0331 01123000
         ST    @15,TOMBFPTR(,TOMWAPTR)                             0331 01124000
*        TOMBFCNT=TOMBFCNT+2;        /* UPDATE DATA CNT FOR RD ATTRI */ 01125000
         ALR   @11,@12                                             0332 01126000
         ST    @11,TOMBFCNT(,TOMWAPTR)                             0332 01127000
*        IKTOBUF(1:2)=SFRDATT;       /* PUT READ ATTRIBUTE INTO RU   */ 01128000
         MVC   IKTOBUF(2,@15),@CB01962                             0333 01129000
*        TOMBFPTR=TOMGETMN+TOMBFCNT; /* UPDATE RU BUFFER POINTER     */ 01130000
         ALR   @10,@11                                             0334 01131000
         ST    @10,TOMBFPTR(,TOMWAPTR)                             0334 01132000
*        TVWATQL1=0;                 /* ZERO LENGTH OF FIRST QUEUE   */ 01133000
         MVI   TVWATQL1(TVWAPTR),X'00'                             0335 01134000
*        TOMLNCNT=TOMLNCNT+1;        /* INCREMENT LINE-COUNT BY ONE  */ 01135000
         LA    @12,1                                               0336 01136000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0336 01137000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0336 01138000
*      END;                          /* END FIRST FLASHBACK PROCESS  */ 01139000
*    ELSE;                                                         0338 01140000
@RF00325 DS    0H                                                  0339 01141000
*    IF TOMLNCNT>=TOMLNNO THEN       /* IS THIS THE LAST SCRN LINE?  */ 01142000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0339 01143000
         C     @12,TOMLNNO(,TOMWAPTR)                              0339 01144000
         BL    @RF00339                                            0339 01145000
*      DO;                           /* BEGIN PAGING PROCESSING      */ 01146000
*        CALL NEWLINE;               /* YES, PUT LINE ADDRESS IN RU  */ 01147000
         BAL   @14,NEWLINE                                         0341 01148000
*        CALL SCRNPAGE;              /* YES, PUT PAGE PROMPT IN RU   */ 01149000
         BAL   @14,SCRNPAGE                                        0342 01150000
*      END;                          /* END PAGING PROCESS           */ 01151000
*    ELSE                            /* NOT LAST LINE SO CONTINUE    */ 01152000
*      IF TVWATQL2^=0 THEN           /* LENG OF 2ND FLSHBACK BUFF>0? */ 01153000
         B     @RC00339                                            0344 01154000
@RF00339 CLI   TVWATQL2(TVWAPTR),0                                 0344 01155000
         BE    @RF00344                                            0344 01156000
*        /************************************************************/ 01157000
*        /*                                                          */ 01158000
*        /*      TAKE DATA FROM SECOND FLASHBACK QUEUE BUFFER.       */ 01159000
*        /*                                                          */ 01160000
*        /************************************************************/ 01161000
*        DO;                         /* BEGIN SECOND FLSHBACK PROCESS*/ 01162000
*          CALL NEWLINE;             /* PUT LINE ADDRESS IN RU       */ 01163000
         BAL   @14,NEWLINE                                         0346 01164000
*          TOMBFCNT=TOMBFCNT +       /* UPDATA COUNT OF DATA IN RU BY*/ 01165000
*            MIN(TVWATQL2,TOMLNSZ)+2;/* SMALLER OF LINE-SZ & QUE LENG*/ 01166000
         LA    @12,2                                               0347 01167000
         SLR   @15,@15                                             0347 01168000
         IC    @15,TVWATQL2(,TVWAPTR)                              0347 01169000
         SLR   @14,@14                                             0347 01170000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0347 01171000
         LR    @11,@14                                             0347 01172000
         CR    @11,@15                                             0347 01173000
         BNH   *+6                                                      01174000
         LR    @11,@15                                             0347 01175000
         AL    @11,TOMBFCNT(,TOMWAPTR)                             0347 01176000
         ALR   @11,@12                                             0347 01177000
         ST    @11,TOMBFCNT(,TOMWAPTR)                             0347 01178000
*          IKTOBUF(1:2)=SFWRTATT;    /* PUT WRITE ATTRIBUTE INTO RU  */ 01179000
         L     @10,TOMBFPTR(,TOMWAPTR)                             0348 01180000
         MVC   IKTOBUF(2,@10),@CB01964                             0348 01181000
*                                    /* MOVE SECOND FLASHBACK BUFFER */ 01182000
*          IKTOBUF(3:(MIN(TVWATQL2,TOMLNSZ-1)+2))=TQL2; /* MOVE DATA */ 01183000
         BCTR  @14,0                                               0349 01184000
         CR    @15,@14                                             0349 01185000
         BNH   *+6                                                      01186000
         LR    @15,@14                                             0349 01187000
         BCTR  @15,0                                               0349 01188000
         L     @01,TVWATOPQ(,TVWAPTR)                              0349 01189000
         EX    @15,@SM02409                                        0349 01190000
*          TR(IKTOBUF(3:(MIN(TVWATQL2,TOMLNSZ-1)+2)),EDITTAB);     0350 01191000
         SLR   @15,@15                                             0350 01192000
         IC    @15,TOMLNSZ(,TOMWAPTR)                              0350 01193000
         BCTR  @15,0                                               0350 01194000
         SLR   @14,@14                                             0350 01195000
         IC    @14,TVWATQL2(,TVWAPTR)                              0350 01196000
         CR    @14,@15                                             0350 01197000
         BNH   *+6                                                      01198000
         LR    @14,@15                                             0350 01199000
         BCTR  @14,0                                               0350 01200000
         EX    @14,@SB02407                                        0350 01201000
*                                    /* TRANSLATE            @ZA19882*/ 01202000
*          TOMBFPTR=TOMGETMN+TOMBFCNT;/* UPDATE RU BUFFER POINTER    */ 01203000
         L     @10,TOMGETMN(,TOMWAPTR)                             0351 01204000
         LR    @15,@10                                             0351 01205000
         ALR   @15,@11                                             0351 01206000
         ST    @15,TOMBFPTR(,TOMWAPTR)                             0351 01207000
*          TOMBFCNT=TOMBFCNT+2;      /* UPDATE DATA CNT FOR RD ATTRI */ 01208000
         ALR   @11,@12                                             0352 01209000
         ST    @11,TOMBFCNT(,TOMWAPTR)                             0352 01210000
*          IKTOBUF(1:2)=SFRDATT;     /* PUT READ ATTRIBUTE INTO RU   */ 01211000
         MVC   IKTOBUF(2,@15),@CB01962                             0353 01212000
*          TOMBFPTR=TOMGETMN+TOMBFCNT;/* UPDATE RU BUFFER POINTER    */ 01213000
         ALR   @10,@11                                             0354 01214000
         ST    @10,TOMBFPTR(,TOMWAPTR)                             0354 01215000
*          TVWATQL2=0;               /* ZERO LENGTH OF 2ND BUFFER    */ 01216000
         MVI   TVWATQL2(TVWAPTR),X'00'                             0355 01217000
*          TOMLNCNT=TOMLNCNT+1;      /* INCREMENT LINE-COUNT BY ONE  */ 01218000
         LA    @12,1                                               0356 01219000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0356 01220000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0356 01221000
*        END;                        /* END SECOND FLASHBACK PROCESS */ 01222000
*      ELSE;                         /* NO SECOND FLASHBACK NEEDED   */ 01223000
@RF00344 DS    0H                                                  0359 01224000
*  END;                              /* END FLASHBACK PROCESSING     */ 01225000
@RC00339 DS    0H                                                  0360 01226000
*IF TVWATQL1=0 & TVWATQL2=0 THEN     /* IS ALL FLASHBACK PROCESSED?  */ 01227000
@RC00317 CLI   TVWATQL1(TVWAPTR),0                                 0360 01228000
         BNE   @RF00360                                            0360 01229000
         CLI   TVWATQL2(TVWAPTR),0                                 0360 01230000
         BNE   @RF00360                                            0360 01231000
*  TVWABKMG='0'B;                    /* YES, TURN OFF REQUEST BIT    */ 01232000
         NI    TVWABKMG(TVWAPTR),B'11111011'                       0361 01233000
*ELSE;                                                             0362 01234000
@RF00360 DS    0H                                                  0363 01235000
*END FLSHBACK;                       /* END OF FLSHBACK              */ 01236000
@EL00012 DS    0H                                                  0363 01237000
@EF00012 DS    0H                                                  0363 01238000
@ER00012 L     @14,@SA00012                                        0363 01239000
         BR    @14                                                 0363 01240000
         EJECT                                                          01241000
*/********************************************************************/ 01242000
*/*                                                                  */ 01243000
*/* THIS PROCEDURE, BLDATTN, BUILDS ATTENTIONS MESSAGES IN THE OUT-  */ 01244000
*/* PUT RU. THE CHARACTER | IS PUT ON THE NEXT AVAILABLE SCREEN LINE */ 01245000
*/* FOR EACH ACCEPTED ATTENTION. THE CHARACTER SEQUENCE |I IS PUT ON */ 01246000
*/* NEXT SCREEN LINE WHEN IGNORED ATTENTION(S) ARE DETECTED          */ 01247000
*/*                                                                  */ 01248000
*/********************************************************************/ 01249000
*                                                                  0364 01250000
*BLDATTN: PROCEDURE OPTIONS(SAVE(14));                             0364 01251000
*                                                                  0364 01252000
BLDATTN  ST    @14,@SA00013                                        0364 01253000
*TOMCOLMN=0;                         /* RESET COLUMN COUNT   @ZA17886*/ 01254000
         SLR   @12,@12                                             0365 01255000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0365 01256000
*IF TOMBFCNT=0 THEN                  /* IS OUTPUT RU EMPTY?          */ 01257000
         C     @12,TOMBFCNT(,TOMWAPTR)                             0366 01258000
         BNE   @RF00366                                            0366 01259000
*  CALL SCRFORMT;                    /* YES, PUT IN CMD,WCC & FORMAT */ 01260000
         BAL   @14,SCRFORMT                                        0367 01261000
*ELSE;                                                             0368 01262000
@RF00366 DS    0H                                                  0369 01263000
*/********************************************************************/ 01264000
*/*                                                                  */ 01265000
*/* THIS DO GROUP BUILDS ATTENTION MESSAGES UNTIL THE ATTENTION      */ 01266000
*/* ACCEPTED COUNT GOES TO ZERO, THE ATTENTION IGNORED INDICATOR IS  */ 01267000
*/* TURNED OFF, OR SCREEN PAGING IS NEEDED.                          */ 01268000
*/*                                                                  */ 01269000
*/********************************************************************/ 01270000
*DO WHILE (((TVWAATTN>0)|(TVWAAIGN='1'B))&(TOMEXBRU='0'B));        0369 01271000
         B     @DE00369                                            0369 01272000
@DL00369 DS    0H                                                  0370 01273000
*  CALL NEWLINE;                     /* PUT LINE ADDR INTO OUTPUT RU */ 01274000
         BAL   @14,NEWLINE                                         0370 01275000
*  IF TOMLNCNT>=TOMLNNO THEN         /* IS THIS THE LAST SCRN LINE?  */ 01276000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0371 01277000
         C     @12,TOMLNNO(,TOMWAPTR)                              0371 01278000
         BL    @RF00371                                            0371 01279000
*    CALL SCRNPAGE;                  /* YES, PUT PAGE PROMPT INTO RU */ 01280000
         BAL   @14,SCRNPAGE                                        0372 01281000
*  ELSE                              /* NO, CONTINUE ATTEN PROCESSING*/ 01282000
*    DO;                             /* BEGIN ATTENTION PROCESSING   */ 01283000
         B     @RC00371                                            0373 01284000
@RF00371 DS    0H                                                  0374 01285000
*      IF TVWAATTN>0 THEN            /* IS ACCEPTED ATTN COUNT>0?    */ 01286000
         CLI   TVWAATTN(TVWAPTR),0                                 0374 01287000
         BNH   @RF00374                                            0374 01288000
*        /************************************************************/ 01289000
*        /*                                                          */ 01290000
*        /* THIS DO GROUP PUTS THE MSG, |, ON THE CURRENT LINE AND   */ 01291000
*        /* DECREMENTS THE ACCEPTED ATTENTION COUNT BY ONE           */ 01292000
*        /*                                                          */ 01293000
*        /************************************************************/ 01294000
*        DO;                         /* BEGIN ATTENTION ACCEPTED     */ 01295000
*          TOMBFCNT=TOMBFCNT+5;      /* SET COUNT FOR ATTENTION MSG  */ 01296000
         LA    @12,5                                               0376 01297000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0376 01298000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0376 01299000
*          IKTOBUF(1:5)=ATTNMSG;     /* PUT ATTENTION MESSAGE IN RU  */ 01300000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0377 01301000
         MVC   IKTOBUF(5,@12),@CB01911                             0377 01302000
*          TVWAATTN=TVWAATTN-1;      /* DECREMENT ACCEPTED ATTN CNT  */ 01303000
         SLR   @12,@12                                             0378 01304000
         IC    @12,TVWAATTN(,TVWAPTR)                              0378 01305000
         BCTR  @12,0                                               0378 01306000
         STC   @12,TVWAATTN(,TVWAPTR)                              0378 01307000
*        END;                        /* END ATTENTION ACCEPTED       */ 01308000
*      ELSE                          /* ATTENTION WAS NOT ACCEPTED   */ 01309000
*        /************************************************************/ 01310000
*        /*                                                          */ 01311000
*        /* THIS DO GROUP PUTS THE MSG, |I, ON THE CURRENT LINE AND  */ 01312000
*        /* ATTENTION IGNORED INDICATOR IS ON AND THE ATTENTION AC-  */ 01313000
*        /* CEPTED COUNT IS ZERO.                                    */ 01314000
*        /*                                                          */ 01315000
*        /************************************************************/ 01316000
*        DO;                         /* BEGIN ATTEN IGNORED PROCESS  */ 01317000
         B     @RC00374                                            0380 01318000
@RF00374 DS    0H                                                  0381 01319000
*          TOMBFCNT=TOMBFCNT+6;      /* SET COUNT FOR ATTN MESSAGE   */ 01320000
         LA    @12,6                                               0381 01321000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0381 01322000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0381 01323000
*          IKTOBUF(1:6)=ATTNIGN;     /* PUT ATTN IGNORED MSG IN RU   */ 01324000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0382 01325000
         MVC   IKTOBUF(6,@12),@CB01907                             0382 01326000
*          TVWAAIGN='0'B;            /* TURN OFF ATTN INDICATOR      */ 01327000
         NI    TVWAAIGN(TVWAPTR),B'11011111'                       0383 01328000
*          TVWAULK='1'B;             /* REQUEST KEYBOARD UNLOCK      */ 01329000
         OI    TVWAULK(TVWAPTR),B'00000100'                        0384 01330000
*        END;                        /* END ATTENTION IGNORED PROCESS*/ 01331000
*      TOMBFPTR=TOMGETMN+TOMBFCNT;   /* UPDATE RU BUFFER POINTER     */ 01332000
@RC00374 L     @12,TOMGETMN(,TOMWAPTR)                             0386 01333000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0386 01334000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0386 01335000
*      TOMLNCNT=TOMLNCNT+1;          /* INCREMENT LINE-COUNT BY ONE  */ 01336000
         LA    @12,1                                               0387 01337000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0387 01338000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0387 01339000
*    END;                            /* END ATTENTION PROCESSING     */ 01340000
*END;                                /* END OF DO LOOP FOR ATTENTION */ 01341000
@RC00371 DS    0H                                                  0389 01342000
@DE00369 CLI   TVWAATTN(TVWAPTR),0                                 0389 01343000
         BH    @GL00025                                            0389 01344000
         TM    TVWAAIGN(TVWAPTR),B'00100000'                       0389 01345000
         BNO   @DC00369                                            0389 01346000
@GL00025 TM    TOMEXBRU(TOMWAPTR),B'00000010'                      0389 01347000
         BZ    @DL00369                                            0389 01348000
@DC00369 DS    0H                                                  0390 01349000
*END BLDATTN;                        /* END OF BLDATTN               */ 01350000
@EL00013 DS    0H                                                  0390 01351000
@EF00013 DS    0H                                                  0390 01352000
@ER00013 L     @14,@SA00013                                        0390 01353000
         BR    @14                                                 0390 01354000
         EJECT                                                          01355000
*/********************************************************************/ 01356000
*/*                                                                  */ 01357000
*/* THIS PROCEDURE, BLDDTA, CONTROLS BUILDING OF USER DATA IN THE    */ 01358000
*/* OUTPUT RU                                                        */ 01359000
*/*                                                                  */ 01360000
*/********************************************************************/ 01361000
*                                                                  0391 01362000
*BLDDTA: PROCEDURE OPTIONS(SAVE(14));                              0391 01363000
*                                                                  0391 01364000
BLDDTA   ST    @14,@SA00014                                        0391 01365000
*TOMOWAIT='0'B;                      /* OFF, INTERNAL TPUT HOLD SW   */ 01366000
*TOMENDBF='0'B;                      /* OFF, NOT AT END OF RU BUFFER */ 01367000
*TOMENDSC='0'B;                      /* OFF, NOT AT END OF 3270 SCRN */ 01368000
*TOMEXDTA='0'B;                      /* OFF, CONTINUE DATA BUILD     */ 01369000
         NI    TOMOWAIT(TOMWAPTR),B'11010010'                      0395 01370000
*IF TSBNOBRK='0'B THEN               /* BREAK TERMINAL?              */ 01371000
         L     @12,PSAAOLD                                         0396 01372000
         L     @12,ASCBTSB(,@12)                                   0396 01373000
         TM    TSBNOBRK(@12),B'00000010'                           0396 01374000
         BNZ   @RF00396                                            0396 01375000
*  IF TVWABRIN='0'B THEN             /* NOT BREAK-IN PROCESSING?     */ 01376000
         TM    TVWABRIN(TVWAPTR),B'10000000'                       0397 01377000
         BNZ   @RF00397                                            0397 01378000
*    DO;                             /* SAVE INFORMATION     @ZM20919*/ 01379000
*      IF TVWAPGN='0'B THEN          /* PAGING?              @ZM20919*/ 01380000
         TM    TVWAPGN(TVWAPTR),B'01000000'                        0399 01381000
         BNZ   @RF00399                                            0399 01382000
*        TOMPGNSV='0'B;              /* SAVE PAGING INFO     @ZM20919*/ 01383000
         NI    TOMPGNSV(TOMWAPTR),B'11101111'                      0400 01384000
*      ELSE                          /* ^ PAGING             @ZM20919*/ 01385000
*        TOMPGNSV='1'B;              /* SAVE ^ PAGING INFO   @ZM20919*/ 01386000
         B     @RC00399                                            0401 01387000
@RF00399 OI    TOMPGNSV(TOMWAPTR),B'00010000'                      0401 01388000
*      TVWALNSV=TOMLNCNT;            /* SAVE LINE COUNT              */ 01389000
@RC00399 L     @12,TOMLNCNT(,TOMWAPTR)                             0402 01390000
         STC   @12,TVWALNSV(,TVWAPTR)                              0402 01391000
*    END;                            /* INFORMATION SAVED    @ZM20919*/ 01392000
*  ELSE;                                                           0404 01393000
@RF00397 DS    0H                                                  0405 01394000
*ELSE;                               /* BREAK-IN PROCESSING          */ 01395000
@RF00396 DS    0H                                                  0406 01396000
*/********************************************************************/ 01397000
*/*                                                                  */ 01398000
*/* THIS DO GROUP PUTS DATA IN THE RU UNTIL LOOP CNTL IS SET TO STOP */ 01399000
*/*                                                                  */ 01400000
*/********************************************************************/ 01401000
*DO UNTIL (TOMEXDTA='1'B);                                         0406 01402000
@DL00406 DS    0H                                                  0407 01403000
*  TOMMVCNT=0;                       /* DATA MOVED THIS PASS IS 0    */ 01404000
         SLR   @12,@12                                             0407 01405000
         ST    @12,TOMMVCNT(,TOMWAPTR)                             0407 01406000
*  TOMQDATA=0;                       /* DATA MOVED THIS PASS IS 0    */ 01407000
         ST    @12,TOMQDATA(,TOMWAPTR)                             0408 01408000
*  OPREQ=OBTAINO;                    /* SET REQUEST CODE FOR OBTAIN  */ 01409000
         MVI   OPREQ(TOMWAPTR),X'02'                               0409 01410000
*  REG13=ADDR(SAVEREGS);             /* PUT NEW SAVE AREA ADDR IS R13*/ 01411000
         LA    REG13,SAVEREGS(,TOMWAPTR)                           0410 01412000
*  CALL IKTQMOUT(OPARMS);            /* OBTAIN DATA FROM OUTPUT QUE  */ 01413000
         LA    @12,OPARMS(,TOMWAPTR)                               0411 01414000
         ST    @12,@AL00001                                        0411 01415000
         L     @12,FLCCVT                                          0411 01416000
         L     @12,CVTTCASP(,@12)                                  0411 01417000
         L     @15,TCASOQM(,@12)                                   0411 01418000
         LA    @01,@AL00001                                        0411 01419000
         BALR  @14,@15                                             0411 01420000
*  REG13=ADDR(TOMAUTOD);             /* RESTORE OLD SAVE AREA ADDR   */ 01421000
         LA    REG13,TOMAUTOD(,TOMWAPTR)                           0412 01422000
*  IF OPRC=3 THEN                    /* WAS OUTPUT QUEUE EMPTY?      */ 01423000
         CLI   OPRC(TOMWAPTR),3                                    0413 01424000
         BNE   @RF00413                                            0413 01425000
*    /****************************************************************/ 01426000
*    /*                                                              */ 01427000
*    /*  YES, NO MORE DATA IS AVAILABLE FROM OUTPUT MESSAGE QUEUE.   */ 01428000
*    /*                                                              */ 01429000
*    /****************************************************************/ 01430000
*    DO;                             /* BEGIN QUEUE-IS-EMPTY PROCESS */ 01431000
*      TSBIFLSH='0'B;                /* YES, TURN OFF INPUT FLSH BIT */ 01432000
         L     @12,PSAAOLD                                         0415 01433000
         L     @12,ASCBTSB(,@12)                                   0415 01434000
         NI    TSBIFLSH(@12),B'11110111'                           0415 01435000
*      TOMEXDTA='1'B;                /* SET LOOP CNTL FOR EXIT       */ 01436000
         OI    TOMEXDTA(TOMWAPTR),B'00000100'                      0416 01437000
*    END;                            /* END QUEUE-IS-EMPTY PROCESS   */ 01438000
*  ELSE                                                    /*@G58AK3B*/ 01439000
*    /****************************************************************/ 01440000
*    /*                                                      @G58AK3B*/ 01441000
*    /* IF PRINT-INHIBIT SITUATION (I.E., TVWANOFB ON) AND   @G58AK3B*/ 01442000
*    /* MESSAGE IS A CROSS-MEMORY TPUT, RESET MESSAGE QUEUE  @G58AK3B*/ 01443000
*    /* POINTER AND EXIT FROM LOOP.                          @G58AK3B*/ 01444000
*    /*                                                      @G58AK3B*/ 01445000
*    /****************************************************************/ 01446000
*    IF (TVWANOFB='1'B &             /* NO FLASHBACK?        @G58AK3B*/ 01447000
*        OPASID='1'B) THEN           /* CROSS-MEMORY TPUT?   @G58AK3B*/ 01448000
         B     @RC00413                                            0418 01449000
@RF00413 TM    TVWANOFB(TVWAPTR),B'00010000'                       0418 01450000
         BNO   @RF00418                                            0418 01451000
         TM    OPASID(TOMWAPTR),B'00001000'                        0418 01452000
         BNO   @RF00418                                            0418 01453000
*      DO;                           /* YES                  @G58AK3B*/ 01454000
*        TOMEXDTA='1'B;              /* SET EXIT LOOP CNTL   @G58AK3B*/ 01455000
         OI    TOMEXDTA(TOMWAPTR),B'00000100'                      0420 01456000
*        OPREQ=UPDATO;               /* RESET MESSAGE Q PTR  @G58AK3B*/ 01457000
         MVI   OPREQ(TOMWAPTR),X'04'                               0421 01458000
*        REG13=ADDR(SAVEREGS);       /* NEW SAVE AREA ADDR   @G58AK3B*/ 01459000
         LA    REG13,SAVEREGS(,TOMWAPTR)                           0422 01460000
*        CALL IKTQMOUT(OPARMS);      /* CALL QUEUE MANAGER   @G58AK3B*/ 01461000
         LA    @12,OPARMS(,TOMWAPTR)                               0423 01462000
         ST    @12,@AL00001                                        0423 01463000
         L     @12,FLCCVT                                          0423 01464000
         L     @12,CVTTCASP(,@12)                                  0423 01465000
         L     @15,TCASOQM(,@12)                                   0423 01466000
         LA    @01,@AL00001                                        0423 01467000
         BALR  @14,@15                                             0423 01468000
*        REG13=ADDR(TOMAUTOD);       /* RESTORE OLD SAVEAREA @G58AK3B*/ 01469000
         LA    REG13,TOMAUTOD(,TOMWAPTR)                           0424 01470000
*        OPASID='0'B;                /* RESET X-MEMORY FLAG  @G58AK3B*/ 01471000
         NI    OPASID(TOMWAPTR),B'11110111'                        0425 01472000
*      END;                                                /*@G58AK3B*/ 01473000
*   ELSE                             /* OUTPUT QUEUE CONTAINS DATA   */ 01474000
*    /****************************************************************/ 01475000
*    /*                                                              */ 01476000
*    /* OUTPUT QUEUE IS NOT EMPTY SO CONTINUE PROCESSING USER DATA   */ 01477000
*    /*                                                              */ 01478000
*    /****************************************************************/ 01479000
*    DO;                             /* BEGIN USER TPUT PROCESSING   */ 01480000
         B     @RC00418                                            0427 01481000
@RF00418 DS    0H                                                  0428 01482000
*    IF TOMEDSAV='00'B THEN          /* LAST TPUT AN EDIT?   @ZA17040*/ 01483000
         TM    TOMEDSAV(TOMWAPTR),B'11000000'                      0428 01484000
         BNZ   @RF00428                                            0428 01485000
*      TOMCOLMN=0;                   /* RESET COLUMN COUNT   @ZA17040*/ 01486000
         SLR   @12,@12                                             0429 01487000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0429 01488000
*    ELSE;                           /* LAST TPUT NOT EDIT   @ZA17040*/ 01489000
@RF00428 DS    0H                                                  0431 01490000
*    IF OPBRK='1'B THEN              /* BREAK-IN TPUT?               */ 01491000
         TM    OPBRK(TOMWAPTR),B'01000000'                         0431 01492000
         BNO   @RF00431                                            0431 01493000
*      TOMBRKMG='1'B;                /* TURN ON BREAK-MESSAGE SWITCH */ 01494000
         OI    TOMBRKMG(TOMWAPTR),B'10000000'                      0432 01495000
*    ELSE;                           /* NOT A BREAK-IN TPUT          */ 01496000
@RF00431 DS    0H                                                  0434 01497000
*    IF ^(((OPEDIT='11'B) &          /* IS CURRENT TPUT FULLSCRN?    */ 01498000
*         (TOMBFCNT>0))   |          /* IS DATA CNT IN RU > 0?       */ 01499000
*         (TOMCURST='1'B)) THEN      /* IS CURSOR ALREADY SET IN RU  */ 01500000
         TM    OPEDIT(TOMWAPTR),B'00110000'                        0434 01501000
         BNO   @GL00028                                            0434 01502000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0434 01503000
         LTR   @12,@12                                             0434 01504000
         BP    @RF00434                                            0434 01505000
@GL00028 TM    TOMCURST(TOMWAPTR),B'00010000'                      0434 01506000
         BO    @RF00434                                            0434 01507000
*      /**************************************************************/ 01508000
*      /*                                                            */ 01509000
*      /* THIS DO GROUP IS EXECUTED EITHER IF THE CURRENT TPUT IS A  */ 01510000
*      /* FULLSRCN AND THE RU IS EMPTY OR IF CURSOR IS NOT SET IN A  */ 01511000
*      /* NON-EMPTY RU . ALSO ENOUGH RU SPACE EXIST FOR AT LEAST ONE */ 01512000
*      /* LINE OF DATA AND PAGING MESSAGE.                           */ 01513000
*      /*                                                            */ 01514000
*      /**************************************************************/ 01515000
*      DO;                           /* CONTINUE PROCESSING USER TPUT*/ 01516000
*      RFY (REG0,REG15) RSTD;        /* RESTRICT REGISTERS 0 AND 15  */ 01517000
*      REG15=0;                      /* SET REGISTER 15 TO ZERO      */ 01518000
         SLR   REG15,REG15                                         0437 01519000
*      TOMQBPTR=OPBUFADR;            /* PTR TO BEGINNING OF QUE DATA */ 01520000
         L     @14,OPBUFADR(,TOMWAPTR)                             0438 01521000
         ST    @14,TOMQBPTR(,TOMWAPTR)                             0438 01522000
*      IF ADDR(IKTIDSX1)^=0 THEN     /* TEST FOR USER EXIT           */ 01523000
         L     @14,@CV02201                                        0439 01524000
         LTR   @14,@14                                             0439 01525000
         BZ    @RF00439                                            0439 01526000
*        DO;                         /* SET PARAMETERS FOR USER EXIT */ 01527000
*          TVWALNCT=TOMLNCNT;        /* SET LINE-CNT FOR USER EXIT   */ 01528000
         L     @14,TOMLNCNT(,TOMWAPTR)                             0441 01529000
         STC   @14,TVWALNCT(,TVWAPTR)                              0441 01530000
*          TOMUPRM1=ADDR(OPARMS);    /* SET ADDR OF QUEUE PARAMETERS */ 01531000
         LA    @14,OPARMS(,TOMWAPTR)                               0442 01532000
         ST    @14,TOMUPRM1(,TOMWAPTR)                             0442 01533000
*          TOMUPRM2=ADDR(TOMWFLGS);  /* LOAD ADDR OF EDITTING FLAGS  */ 01534000
         LA    @14,TOMWFLGS(,TOMWAPTR)                             0443 01535000
         ST    @14,TOMUPRM2(,TOMWAPTR)                             0443 01536000
*          TOMUPRM3=ADDR(TOMBUFSZ);  /* LOAD ADDR OF RU BUFFER SIZE  */ 01537000
         LA    @14,TOMBUFSZ(,TOMWAPTR)                             0444 01538000
         ST    @14,TOMUPRM3(,TOMWAPTR)                             0444 01539000
*          TOMUPRM4=ADDR(TOMBFPTR);  /* LOAD ADDR OF RU BUFFER PTR   */ 01540000
         LA    @14,TOMBFPTR(,TOMWAPTR)                             0445 01541000
         ST    @14,TOMUPRM4(,TOMWAPTR)                             0445 01542000
*          TOMUPRM5=ADDR(TOMBFCNT);  /* LOAD ADDR FOR DATA CNT IN RU */ 01543000
         LA    @14,TOMBFCNT(,TOMWAPTR)                             0446 01544000
         ST    @14,TOMUPRM5(,TOMWAPTR)                             0446 01545000
*          TOMUPRM6=ADDR(TOMQBPTR);  /* ADRR OF POINTER TO USER DATA */ 01546000
         LA    @14,TOMQBPTR(,TOMWAPTR)                             0447 01547000
         ST    @14,TOMUPRM6(,TOMWAPTR)                             0447 01548000
*          TOMUPRM7=ADDR(TOMMVCNT);  /* ADDR OF MOVED USER DATA CNT  */ 01549000
         LA    @14,TOMMVCNT(,TOMWAPTR)                             0448 01550000
         ST    @14,TOMUPRM7(,TOMWAPTR)                             0448 01551000
*          TOMUPRM8=ADDR(TOMQDATA);  /* ADDR OF MOVED USER DATA CNT  */ 01552000
         LA    @14,TOMQDATA(,TOMWAPTR)                             0449 01553000
         ST    @14,TOMUPRM8(,TOMWAPTR)                             0449 01554000
*          REG0=ADDR(TOMUPARM);      /* ADDR OF PARM LIST IN REG(0)  */ 01555000
         LA    REG0,TOMUPARM(,TOMWAPTR)                            0450 01556000
*          CALL IKTIDSX1;            /* CALL USER EXIT               */ 01557000
         L     @15,@CV02201                                        0451 01558000
         BALR  @14,@15                                             0451 01559000
*          TOMLNCNT=TVWALNCT;        /* USE LINE-CNT FROM USER EXIT  */ 01560000
         SLR   @14,@14                                             0452 01561000
         IC    @14,TVWALNCT(,TVWAPTR)                              0452 01562000
         ST    @14,TOMLNCNT(,TOMWAPTR)                             0452 01563000
*        END;                        /* END PARMS SET FOR USER EXIT  */ 01564000
*      ELSE;                                                       0454 01565000
@RF00439 DS    0H                                                  0455 01566000
*      IF REG15=0 THEN               /* CHECK RETURN FROM USER EXIT  */ 01567000
         LTR   REG15,REG15                                         0455 01568000
         BNZ   @RF00455                                            0455 01569000
*        /************************************************************/ 01570000
*        /*                                                          */ 01571000
*        /* USER EXIT NOT CALLED OR NORMAL PROCESSING WAS SPECIFIED  */ 01572000
*        /*                                                          */ 01573000
*        /************************************************************/ 01574000
*        DO;                         /*                              */ 01575000
*        RFY (REG0,REG15) UNRSTD;    /* UNRESTRICT REGISTERS 0 AND 15*/ 01576000
*        IF ((TVWAFSM='1'B)   &      /* FULLSCRN-MODE PROCESSING?    */ 01577000
*            (TOMEDSAV^='11'B)&      /* WAS LAST TPUT NON-FULLSCRN?  */ 01578000
*            (OPEDIT='11'B))  &      /* IS CURRENT PUT FULLSCRN?     */ 01579000
*           ((TVWANFSP='0'B)  |      /* IS FULLSCR-MODE PAGING LEGAL */ 01580000
*            (TVWAIOTR='0'B))  THEN  /* HAS I/O TRANSACTION OCCURRED?*/ 01581000
         TM    TVWAFSM(TVWAPTR),B'01000000'                        0458 01582000
         BNO   @RF00458                                            0458 01583000
         TM    TOMEDSAV(TOMWAPTR),B'11000000'                      0458 01584000
         BO    @RF00458                                            0458 01585000
         TM    OPEDIT(TOMWAPTR),B'00110000'                        0458 01586000
         BNO   @RF00458                                            0458 01587000
         TM    TVWANFSP(TVWAPTR),B'00000100'                       0458 01588000
         BZ    @RT00458                                            0458 01589000
         TM    TVWAIOTR(TVWAPTR),B'01000000'                       0458 01590000
         BNZ   @RF00458                                            0458 01591000
@RT00458 DS    0H                                                  0459 01592000
*          /**********************************************************/ 01593000
*          /*                                                        */ 01594000
*          /* A FULLSCRN TPUT FOLLOWS A NON-FULLSCRN TPUT WHILE IN   */ 01595000
*          /* FULLSCRN MODE AND PAGING IS ALLOWED.                   */ 01596000
*          /*                                                        */ 01597000
*          /**********************************************************/ 01598000
*          DO;                       /* BEGIN FULLSCRN-MODE PAGE     */ 01599000
*            IF TOMBFCNT=0 THEN      /* IS OUTPUT RU EMPTY?          */ 01600000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0460 01601000
         LTR   @12,@12                                             0460 01602000
         BNZ   @RF00460                                            0460 01603000
*              CALL SCRFORMT;        /* YES, PUT IN CMD/WCC          */ 01604000
         BAL   @14,SCRFORMT                                        0461 01605000
*            ELSE;                                                 0462 01606000
@RF00460 DS    0H                                                  0463 01607000
*            TOMEDSAV='11'B;         /* CONSIDER RU AS FULLSCRN-MODE */ 01608000
         OI    TOMEDSAV(TOMWAPTR),B'11000000'                      0463 01609000
*            TOMCOLMN=MAX(0,MIN(TOMCOLMN,TOMLNSZ-7));      /*@ZA19887*/ 01610000
         SLR   @12,@12                                             0464 01611000
         IC    @12,TOMLNSZ(,TOMWAPTR)                              0464 01612000
         SL    @12,@CF00034                                        0464 01613000
         L     @15,TOMCOLMN(,TOMWAPTR)                             0464 01614000
         CR    @15,@12                                             0464 01615000
         BNH   *+6                                                      01616000
         LR    @15,@12                                             0464 01617000
         SLR   @12,@12                                             0464 01618000
         CR    @15,@12                                             0464 01619000
         BNL   *+6                                                      01620000
         LR    @15,@12                                             0464 01621000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0464 01622000
*            CALL NEWLINE;           /* PUT LINE ADDRESS IN RU       */ 01623000
         BAL   @14,NEWLINE                                         0465 01624000
*            CALL SCRNPAGE;          /* PAGE PROMPT IN RU            */ 01625000
         BAL   @14,SCRNPAGE                                        0466 01626000
*            TVWAFSW='1'B;           /* FULLSCREEN TPUT WAITING      */ 01627000
         OI    TVWAFSW(TVWAPTR),B'00010000'                        0467 01628000
*          END;                      /* END FULLSCREEN MODE PAGE     */ 01629000
*        ELSE                        /* NO FULLSCRN-MODE PAGE NEEDED */ 01630000
*          DO;                                                     0469 01631000
         B     @RC00458                                            0469 01632000
@RF00458 DS    0H                                                  0470 01633000
*            IF TVWAFSM='1'B THEN    /* IS USER IN FULLSCRN-MODE?    */ 01634000
         TM    TVWAFSM(TVWAPTR),B'01000000'                        0470 01635000
         BNO   @RF00470                                            0470 01636000
*              DO;                   /*                              */ 01637000
*                TVWANFSP='0'B;      /* FULLSCRN-PAGING IS ALLOWED   */ 01638000
         NI    TVWANFSP(TVWAPTR),B'11111011'                       0472 01639000
*                IF (TOMEDSAV='11'B)&/* WAS LAST TPUT FULLSCRN-MODE? */ 01640000
*                   (OPEDIT^='11'B) THEN/* CURRENT TPUT NON-FULLSCR? */ 01641000
         TM    TOMEDSAV(TOMWAPTR),B'11000000'                      0473 01642000
         BNO   @RF00473                                            0473 01643000
         TM    OPEDIT(TOMWAPTR),B'00110000'                        0473 01644000
         BO    @RF00473                                            0473 01645000
*                  /**************************************************/ 01646000
*                  /*                                                */ 01647000
*                  /* A NON-FULLSCRN TPUT FOLLOWS A FULLSCRN TPUT    */ 01648000
*                  /* WHILE IN FULLSCRN MODE.                        */ 01649000
*                  /*                                                */ 01650000
*                  /**************************************************/ 01651000
*                  DO;               /* BEGIN NON-FS FOLLOWS FS TPUT */ 01652000
*                    TOMLNCNT=1;     /* WRT TO TOP OF SCRN           */ 01653000
         MVC   TOMLNCNT(4,TOMWAPTR),@CF00064                       0475 01654000
*                    TOMALARM='1'B;  /* SOUND AUDIBLE ALARM          */ 01655000
*                    TOMERASE='1'B;  /* ERASE SCREEN                 */ 01656000
         OI    TOMALARM(TOMWAPTR),B'01010000'                      0477 01657000
*                    TVWAWO='1'B;    /* FULLSCR WRITTEN OVER         */ 01658000
         OI    TVWAWO(TVWAPTR),B'00100000'                         0478 01659000
*                    CALL SCRFORMT;  /* PUT CMD & WCC IN RU          */ 01660000
         BAL   @14,SCRFORMT                                        0479 01661000
*                    TOMEDSAV='00'B; /* CONSIDER RU AS EDIT          */ 01662000
         NI    TOMEDSAV(TOMWAPTR),B'00111111'                      0480 01663000
*                  END;              /* END NON-FS FOLLOWS FS TPUT   */ 01664000
*                ELSE;                                             0482 01665000
@RF00473 DS    0H                                                  0483 01666000
*              END;                                                0483 01667000
*            ELSE;                                                 0484 01668000
@RF00470 DS    0H                                                  0485 01669000
*            IF OPEDIT='00'B THEN    /* TEST FOR EDIT-MODE USER DATA */ 01670000
         TM    OPEDIT(TOMWAPTR),B'00110000'                        0485 01671000
         BNZ   @RF00485                                            0485 01672000
*              CALL EDIT;            /* YES, USE EDIT-MODE PROCESS'  */ 01673000
         BAL   @14,EDIT                                            0486 01674000
*            ELSE                    /* CONTINUE CHECK OF TPUT TYPE  */ 01675000
*              IF OPEDIT='11'B THEN  /* TEST FOR FULLSCRN-MODE DATA  */ 01676000
         B     @RC00485                                            0487 01677000
@RF00485 TM    OPEDIT(TOMWAPTR),B'00110000'                        0487 01678000
         BNO   @RF00487                                            0487 01679000
*                CALL FULSCRN;       /* YES, USE FULSCRN- MODE EDIT  */ 01680000
         BAL   @14,FULSCRN                                         0488 01681000
*              ELSE                  /* CONTINUE CHECK OF TPUT TYPE  */ 01682000
*                IF (TOMBFCNT=0)   | /* IN OUTPUT RU EMPTY           */ 01683000
*                   ((QBUF(1)^=ESC)& /* FIRST BYTE AN ESCAPE CHAR ?  */ 01684000
*                   ((OPBFSZ<3)    | /* IS LENGTH OF TPUT < 3 ?      */ 01685000
*                    (QBUF(2)^=SBA))) THEN /* IS SBA ORDER IN HEADER?*/ 01686000
         B     @RC00487                                            0489 01687000
@RF00487 L     @12,TOMBFCNT(,TOMWAPTR)                             0489 01688000
         LTR   @12,@12                                             0489 01689000
         BZ    @RT00489                                            0489 01690000
         L     @12,TOMQBPTR(,TOMWAPTR)                             0489 01691000
         CLI   QBUF(@12),X'27'                                     0489 01692000
         BE    @RF00489                                            0489 01693000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0489 01694000
         C     @15,@CF00291                                        0489 01695000
         BL    @RT00489                                            0489 01696000
         CLI   QBUF+1(@12),X'11'                                   0489 01697000
         BE    @RF00489                                            0489 01698000
@RT00489 DS    0H                                                  0490 01699000
*                  /**************************************************/ 01700000
*                  /*                                                */ 01701000
*                  /* ASIS & CNTL TPUTS WILL BE COMBINED FOR OUTPUT  */ 01702000
*                  /* WITH OTHER NON-FULLSCRN TPUTS ONLY IF NON OF   */ 01703000
*                  /* USER-SPECIFIED HEADER (CMD,WCC,SBA) IS PRESENT.*/ 01704000
*                  /*                                                */ 01705000
*                  /**************************************************/ 01706000
*                  IF OPEDIT='01'B THEN /* TEST FOR ASIS MODE DATA   */ 01707000
         TM    OPEDIT(TOMWAPTR),B'00010000'                        0490 01708000
         BNO   @RF00490                                            0490 01709000
         TM    OPEDIT(TOMWAPTR),B'00100000'                        0490 01710000
         BNZ   @RF00490                                            0490 01711000
*                    CALL ASIS;      /* YES, USE ASIS MODE PROCESS'  */ 01712000
         BAL   @14,ASIS                                            0491 01713000
*                  ELSE              /* CONTINUE CHECK OF TPUT TYPE  */ 01714000
*                    CALL CNTL;      /* USE CNTL MODE PROCESSING     */ 01715000
         B     @RC00490                                            0492 01716000
@RF00490 BAL   @14,CNTL                                            0492 01717000
*                ELSE                /*                      @G58AK2Q*/ 01718000
*                  TOMBRKPG='0'B;    /* OFF, BREAK-IN PAGING @G58AK2Q*/ 01719000
         B     @RC00489                                            0493 01720000
@RF00489 NI    TOMBRKPG(TOMWAPTR),B'11111101'                      0493 01721000
*            IF (OPEDIT^='11'B)&     /* IS TPUT NOT FULLSCRN TPUT?   */ 01722000
*               (OPASID='0'B)   THEN /* IS TPUT A CROSS-MEMORY TPUT? */ 01723000
@RC00489 DS    0H                                                  0494 01724000
@RC00487 DS    0H                                                  0494 01725000
@RC00485 TM    OPEDIT(TOMWAPTR),B'00110000'                        0494 01726000
         BO    @RF00494                                            0494 01727000
         TM    OPASID(TOMWAPTR),B'00001000'                        0494 01728000
         BNZ   @RF00494                                            0494 01729000
*              TVWAFLSC='0'B;        /* NO, TURN OFF FULLSCRN SEND   */ 01730000
         NI    TVWAFLSC(TVWAPTR),B'11110111'                       0495 01731000
*            ELSE;                                                 0496 01732000
@RF00494 DS    0H                                                  0497 01733000
*          END;                                                    0497 01734000
*        END;                                                      0498 01735000
*      ELSE;                                                       0499 01736000
@RF00455 DS    0H                                                  0500 01737000
*      END;                                                        0500 01738000
*    ELSE;                                                         0501 01739000
@RF00434 DS    0H                                                  0502 01740000
*      IF TOMMVCNT<OPBFSZ THEN       /* WAS ALL USER DATA MOVED?     */ 01741000
@RC00434 L     @12,TOMMVCNT(,TOMWAPTR)                             0502 01742000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0502 01743000
         BNL   @RF00502                                            0502 01744000
*        /************************************************************/ 01745000
*        /*                                                          */ 01746000
*        /* IF ALL USER DATA NOT PROCESS THIS ENTRY, UPDATE OUTPUT   */ 01747000
*        /* QUEUE FOR NEXT ENTRY.                                    */ 01748000
*        /*                                                          */ 01749000
*        /************************************************************/ 01750000
*        DO;                         /* NO, UPDATE FOR NEXT ENTRY    */ 01751000
*          OPBUFADR=OPBUFADR+TOMMVCNT;/* SET PTR TO UNUSED DATA      */ 01752000
         AL    @12,OPBUFADR(,TOMWAPTR)                             0504 01753000
         ST    @12,OPBUFADR(,TOMWAPTR)                             0504 01754000
*          OPREQ=UPDATO;             /* SET REQUEST CODE TO UPDATE   */ 01755000
         MVI   OPREQ(TOMWAPTR),X'04'                               0505 01756000
*          REG13=ADDR(SAVEREGS);     /* SET NEW SAVE AREA ADDR IN R13*/ 01757000
         LA    REG13,SAVEREGS(,TOMWAPTR)                           0506 01758000
*          CALL IKTQMOUT(OPARMS);    /* CALL OUTPUT QUEUE MANAGER    */ 01759000
         LA    @12,OPARMS(,TOMWAPTR)                               0507 01760000
         ST    @12,@AL00001                                        0507 01761000
         L     @12,FLCCVT                                          0507 01762000
         L     @12,CVTTCASP(,@12)                                  0507 01763000
         L     @15,TCASOQM(,@12)                                   0507 01764000
         LA    @01,@AL00001                                        0507 01765000
         BALR  @14,@15                                             0507 01766000
*          REG13=ADDR(TOMAUTOD);     /* RESTORE OLD SAVE AREA ADDR   */ 01767000
         LA    REG13,TOMAUTOD(,TOMWAPTR)                           0508 01768000
*          TVWATAS='1'B;             /* SET RESCHEDULE BIT TO ON     */ 01769000
         OI    TVWATAS(TVWAPTR),B'00100000'                        0509 01770000
*          TOMEXDTA='1'B;            /* SET BLD LOOP CNTL FOR EXIT   */ 01771000
*          TOMEXBRU='1'B;            /* SET RU BLD LOOP CNTL TO STOP */ 01772000
         OI    TOMEXDTA(TOMWAPTR),B'00000110'                      0511 01773000
*        END;                        /* END UPDATA PROCESSING        */ 01774000
*      ELSE                          /* LOOP CNTL STILL FOR CONTINUE */ 01775000
*        /************************************************************/ 01776000
*        /*                                                          */ 01777000
*        /* IF YES, DATA EDITTING ROUTINE DID NOT SET LOOP CONTROL   */ 01778000
*        /* TO STOP. SO CHECK TO SEE IF MORE DATA IS ON QUEUE        */ 01779000
*        /*                                                          */ 01780000
*        /************************************************************/ 01781000
*        DO;                         /* BEGIN END-OF-TPUT PROCESSING */ 01782000
         B     @RC00502                                            0513 01783000
@RF00502 DS    0H                                                  0514 01784000
*          IF TOMBPREQ='1'B &        /* REQ FOR BRK-IN PAGE? @G58AK2Q*/ 01785000
*             OPNXBRK='0'B &         /* NEXT TPUT NOT BREAK? @ZM21356*/ 01786000
*             OPBRK='1'B THEN        /* CURRENT TPUT BRK-IN? @G58AK2Q*/ 01787000
         TM    TOMBPREQ(TOMWAPTR),B'00001000'                      0514 01788000
         BNO   @RF00514                                            0514 01789000
         TM    OPNXBRK(TOMWAPTR),B'01000000'                       0514 01790000
         BNZ   @RF00514                                            0514 01791000
         TM    OPBRK(TOMWAPTR),B'01000000'                         0514 01792000
         BNO   @RF00514                                            0514 01793000
*            TOMBRKPG='1'B;          /* SET REQ FOR PAGING   @G58AK2Q*/ 01794000
         OI    TOMBRKPG(TOMWAPTR),B'00000010'                      0515 01795000
*          ELSE;                     /*                      @G58AK2Q*/ 01796000
@RF00514 DS    0H                                                  0517 01797000
*          IF OPHOLD='1'B THEN       /* WAS THIS OWAIT DATA?         */ 01798000
         TM    OPHOLD(TOMWAPTR),B'10000000'                        0517 01799000
         BNO   @RF00517                                            0517 01800000
*            TOMOWAIT='1'B;          /* YES SET INDICATOR FOR STATUS */ 01801000
         OI    TOMOWAIT(TOMWAPTR),B'00000001'                      0518 01802000
*          ELSE;                                                   0519 01803000
@RF00517 DS    0H                                                  0520 01804000
*          IF OPRC=2 THEN            /* IS MORE DATA ON OUTPUT QUE?  */ 01805000
         CLI   OPRC(TOMWAPTR),2                                    0520 01806000
         BNE   @RF00520                                            0520 01807000
*            DO;                     /* BEGIN OUTPUT QUEUE EMPTY     */ 01808000
*              TSBIFLSH='0'B;        /* NO, TURN OFF INPUT FLUSH BIT */ 01809000
         L     @12,PSAAOLD                                         0522 01810000
         L     @12,ASCBTSB(,@12)                                   0522 01811000
         NI    TSBIFLSH(@12),B'11110111'                           0522 01812000
*              TOMEXDTA='1'B;        /* NO, SET LOOP CNTL TO STOP    */ 01813000
         OI    TOMEXDTA(TOMWAPTR),B'00000100'                      0523 01814000
*            END;                    /* END OUTPUT QUEUE EMPTY       */ 01815000
*          ELSE                      /* AT LEAST ONE TPUT IS ON QUEUE*/ 01816000
*            IF (OPEDIT='11'B)  |    /* IS CURRENT TPUT FULLSCREEN?  */ 01817000
*               (TVWANOFB='1'B &     /* NO FLASH BACK?       @G58AK3B*/ 01818000
*                OPNXASID='1'B) |    /* NEXT CROSS MEMORY?   @G58AK3B*/ 01819000
*               (OPNXEDIT='11'B) THEN/* IS NEXT TPUT FULLSCREEN TPUT?*/ 01820000
         B     @RC00520                                            0525 01821000
@RF00520 TM    OPEDIT(TOMWAPTR),B'00110000'                        0525 01822000
         BO    @RT00525                                            0525 01823000
         TM    TVWANOFB(TVWAPTR),B'00010000'                       0525 01824000
         BNO   @GL00041                                            0525 01825000
         TM    OPNXASID(TOMWAPTR),B'00001000'                      0525 01826000
         BO    @RT00525                                            0525 01827000
@GL00041 TM    OPNXEDIT(TOMWAPTR),B'00110000'                      0525 01828000
         BNO   @RF00525                                            0525 01829000
@RT00525 DS    0H                                                  0526 01830000
*              /******************************************************/ 01831000
*              /*                                                    */ 01832000
*              /* IF THE CURRENT RU IS A FULLSCRN TPUT OR THE NEXT   */ 01833000
*              /* QUEUE ELEMENT IS A FULLSCRN TPUT, THE CURRENT RU   */ 01834000
*              /* WILL BE SENT & THE NEXT TPUT PROCESSED ON RETURN   */ 01835000
*              /*                                                    */ 01836000
*              /******************************************************/ 01837000
*              DO;                   /* BEGIN FULLSCR FOLLOWS FULLSCR*/ 01838000
*                TOMEXDTA='1'B;      /* USER DATA BLD IS COMPLETE    */ 01839000
*                TOMEXBRU='1'B;      /* RU BLD IS COMPETE THIS ENTRY */ 01840000
         OI    TOMEXDTA(TOMWAPTR),B'00000110'                      0528 01841000
*              END;                  /* END FULLSCRN FOLLOWS FULLSCRN*/ 01842000
*            ELSE;                   /* NOT FULLSCREEN TPUT          */ 01843000
@RF00525 DS    0H                                                  0531 01844000
*        END;                                                      0531 01845000
@RC00520 DS    0H                                                  0532 01846000
*    END;                                                          0532 01847000
@RC00502 DS    0H                                                  0533 01848000
*  IF TOMBPREQ='1'B &                /* BREAKIN TPUT BEING PROCESSED?   01849000
*                                                            @ZM21402*/ 01850000
*     TVWADOOQ='0'B THEN             /* NO DATA ON QUEUE?    @ZM21402*/ 01851000
@RC00418 DS    0H                                                  0533 01852000
@RC00413 TM    TOMBPREQ(TOMWAPTR),B'00001000'                      0533 01853000
         BNO   @RF00533                                            0533 01854000
         TM    TVWADOOQ(TVWAPTR),B'01000000'                       0533 01855000
         BNZ   @RF00533                                            0533 01856000
*    TOMBRKPG='1'B;                  /* SCREEN PAGE FOR END OF BREAKIN  01857000
*                                       MESSAGE              @ZM21402*/ 01858000
         OI    TOMBRKPG(TOMWAPTR),B'00000010'                      0534 01859000
*  ELSE                              /* NOT END OF BREAKIN MESSAGE 0535 01860000
*                                                            @ZM21402*/ 01861000
*    ;                                                             0535 01862000
@RF00533 DS    0H                                                  0536 01863000
*END;                                                              0536 01864000
@DE00406 TM    TOMEXDTA(TOMWAPTR),B'00000100'                      0536 01865000
         BNO   @DL00406                                            0536 01866000
*END BLDDTA;                         /* END OF BLDDTA                */ 01867000
@EL00014 DS    0H                                                  0537 01868000
@EF00014 DS    0H                                                  0537 01869000
@ER00014 L     @14,@SA00014                                        0537 01870000
         BR    @14                                                 0537 01871000
         EJECT                                                          01872000
*/********************************************************************/ 01873000
*/*                                                                  */ 01874000
*/* THIS PROCEDURE, CNTL,  BUILDS CONTROL DATA IN THE OUTPU RU.      */ 01875000
*/* VALID CONTROL CHARATERS ARE PT, IC, BYP, RES. INVALID DATA IS    */ 01876000
*/* REMOVE FROM THE OUTPUT DATA                                      */ 01877000
*/*                                                                  */ 01878000
*/********************************************************************/ 01879000
*                                                                  0538 01880000
*CNTL: PROCEDURE OPTIONS(SAVE(14));                                0538 01881000
*                                                                  0538 01882000
CNTL     ST    @14,@SA00015                                        0538 01883000
*TOMCOLMN=0;                         /* RESET COLUMN COUNT   @ZA17886*/ 01884000
         SLR   @12,@12                                             0539 01885000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0539 01886000
*CALL CNTLHDRS;                      /* PUT HEADER DATA IN RU        */ 01887000
         BAL   @14,CNTLHDRS                                        0540 01888000
*/********************************************************************/ 01889000
*/*                                                                  */ 01890000
*/* THIS DO WHILE LOOP WILL BE EXECUTED AS LONG AS THE CURRENT TPUT  */ 01891000
*/* HAS NOT BEEN COMPLETELY MOVED AND THERE IS OUTPUT RU SPACE.      */ 01892000
*/*                                                                  */ 01893000
*/********************************************************************/ 01894000
*DO WHILE (TOMMVCNT<OPBFSZ)&(TOMBFCNT<TOMBUFSZ-2);                 0541 01895000
         B     @DE00541                                            0541 01896000
@DL00541 DS    0H                                                  0542 01897000
*  TOMWRKSZ=MIN(OPBFSZ-TOMQDATA,80); /* SET COUNT FOR MOVE   @ZA19885*/ 01898000
         LH    @12,OPBFSZ(,TOMWAPTR)                               0542 01899000
         SL    @12,TOMQDATA(,TOMWAPTR)                             0542 01900000
         LA    @15,80                                              0542 01901000
         CR    @12,@15                                             0542 01902000
         BNH   *+6                                                      01903000
         LR    @12,@15                                             0542 01904000
         STC   @12,TOMWRKSZ(,TOMWAPTR)                             0542 01905000
*  TOMWRKBF(1:TOMWRKSZ)=QBUF;        /* MOVE USER DATA TO WORK AREA  */ 01906000
         BCTR  @12,0                                               0543 01907000
         L     @01,TOMQBPTR(,TOMWAPTR)                             0543 01908000
         EX    @12,@SM02416                                        0543 01909000
*  TOMEDSAV='10'B;                   /* SAVE MODE OF TPUT    @ZA19885*/ 01910000
         NI    TOMEDSAV(TOMWAPTR),B'10111111'                      0544 01911000
         OI    TOMEDSAV(TOMWAPTR),B'10000000'                      0544 01912000
*  /******************************************************************/ 01913000
*  /*                                                                */ 01914000
*  /* THIS DO WHILE LOOP WILL SCAN DATA IN WORK AREA FOR VALID CON-  */ 01915000
*  /* CONTROL CHARACTERS. VALID CHARACTERS ARE MOVED TO OUTPUT RU    */ 01916000
*  /*                                                                */ 01917000
*  /******************************************************************/ 01918000
*  DO I=1 TO TOMWRKSZ WHILE (TOMBFCNT<(TOMBUFSZ-2));               0545 01919000
         LA    @12,1                                               0545 01920000
         B     @DE00545                                            0545 01921000
@DL00545 L     @12,TOMBFCNT(,TOMWAPTR)                             0545 01922000
         LA    @15,2                                               0545 01923000
         L     @14,TOMBUFSZ(,TOMWAPTR)                             0545 01924000
         SLR   @14,@15                                             0545 01925000
         CR    @12,@14                                             0545 01926000
         BNL   @DC00545                                            0545 01927000
*    IF TOMWRKBF(I)=RES THEN         /* IS CURRENT CHAR RESTORE?     */ 01928000
         L     @01,I(,TOMWAPTR)                                    0546 01929000
         ALR   @01,TOMWAPTR                                        0546 01930000
         CLI   TOMWRKBF-1(@01),X'14'                               0546 01931000
         BNE   @RF00546                                            0546 01932000
*      /**************************************************************/ 01933000
*      /*                                                            */ 01934000
*      /* THIS DO GROUP PUTS RESTORE ATTRIBUTE IN OUTPUT RU          */ 01935000
*      /*                                                            */ 01936000
*      /**************************************************************/ 01937000
*      DO;                                                         0547 01938000
*        TOMBFCNT=TOMBFCNT+2;        /* UPDATE COUNT OF DATA IN RU   */ 01939000
         ALR   @12,@15                                             0548 01940000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0548 01941000
*        IKTOBUF(1:2)=SFWRTATT;      /* PUT RESTORE ATTRIBUTE IN RU  */ 01942000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0549 01943000
         MVC   IKTOBUF(2,@12),@CB01964                             0549 01944000
*        TVWANOFB='0'B;              /* RESET NO FLASHBACK   @G58AK3B*/ 01945000
         NI    TVWANOFB(TVWAPTR),B'11101111'                       0550 01946000
*      END;                                                        0551 01947000
*    ELSE                            /* CURREN CHARACTER IS NOT RES  */ 01948000
*      IF TOMWRKBF(I)=BYP THEN       /* IS CURRENT CHARACTER BYPASS? */ 01949000
         B     @RC00546                                            0552 01950000
@RF00546 L     @12,I(,TOMWAPTR)                                    0552 01951000
         ALR   @12,TOMWAPTR                                        0552 01952000
         CLI   TOMWRKBF-1(@12),X'24'                               0552 01953000
         BNE   @RF00552                                            0552 01954000
*        /************************************************************/ 01955000
*        /*                                                          */ 01956000
*        /* THIS DO GROUP PUTS BYPASS ATTRIBUTE IN OUTPUT RU         */ 01957000
*        /*                                                          */ 01958000
*        /************************************************************/ 01959000
*        DO;                                                       0553 01960000
*          TOMBFCNT=TOMBFCNT+3;      /* UPDATE COUNT OF DATA IN RU   */ 01961000
         LA    @12,3                                               0554 01962000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0554 01963000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0554 01964000
*          IKTOBUF(1:2)=SFBYPATT;    /* PUT BYPASS ATTRIBUTE IN RU   */ 01965000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0555 01966000
         MVC   IKTOBUF(2,@12),@CB01958                             0555 01967000
*          IKTOBUF(3)=IC;            /* PUT CURSOR AFTER BYP ATTRIB  */ 01968000
         MVI   IKTOBUF+2(@12),X'13'                                0556 01969000
*          TOMCURST='1'B;            /* INDICATE CURSOR IS SET IN RU */ 01970000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0557 01971000
*          TVWANOFB='1'B;            /* REQUEST HALT OF FLASK BACK   */ 01972000
         OI    TVWANOFB(TVWAPTR),B'00010000'                       0558 01973000
*        END;                                                      0559 01974000
*      ELSE                          /* CURRENT CHAR IS NOT BYPASS   */ 01975000
*        IF TOMWRKBF(I)=IC THEN      /* IS CURRENT CHAR INSERT CURS? */ 01976000
         B     @RC00552                                            0560 01977000
@RF00552 L     @12,I(,TOMWAPTR)                                    0560 01978000
         ALR   @12,TOMWAPTR                                        0560 01979000
         CLI   TOMWRKBF-1(@12),X'13'                               0560 01980000
         BNE   @RF00560                                            0560 01981000
*          /**********************************************************/ 01982000
*          /*                                                        */ 01983000
*          /* THIS DO GROUP PUTS INSERT CURSOR ORDER IN OUTPUT  RU   */ 01984000
*          /*                                                        */ 01985000
*          /**********************************************************/ 01986000
*          DO;                                                     0561 01987000
*            TOMBFCNT=TOMBFCNT+1;    /* UPDATE COUNT OF DATA IN RU   */ 01988000
         LA    @12,1                                               0562 01989000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0562 01990000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0562 01991000
*            IKTOBUF(1)=IC;          /* PUT INSERT CURS ORDER IN RU  */ 01992000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0563 01993000
         MVI   IKTOBUF(@12),X'13'                                  0563 01994000
*            TOMCURST='1'B;          /* INDICATE CURSOR IS SET IN RU */ 01995000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0564 01996000
*          END;                                                    0565 01997000
*        ELSE                        /* CURRENT CHAR NOT INSERT CURS */ 01998000
*          IF TOMWRKBF(I)=PT THEN    /* IS CURRENT CHAR PROGRAM TAB? */ 01999000
         B     @RC00560                                            0566 02000000
@RF00560 L     @12,I(,TOMWAPTR)                                    0566 02001000
         ALR   @12,TOMWAPTR                                        0566 02002000
         CLI   TOMWRKBF-1(@12),X'05'                               0566 02003000
         BNE   @RF00566                                            0566 02004000
*            /********************************************************/ 02005000
*            /*                                                      */ 02006000
*            /* THIS DO GROUP PUTS PROGRAM TAB ORDER IN OUTPUT RU    */ 02007000
*            /*                                                      */ 02008000
*            /********************************************************/ 02009000
*            DO;                                                   0567 02010000
*              TOMBFCNT=TOMBFCNT+1;  /* UPDATE COUNT OF DATA IN RU   */ 02011000
         LA    @12,1                                               0568 02012000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0568 02013000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0568 02014000
*              IKTOBUF(1)=PT;        /* PUT PROGRAM TAB ORDER IN RU  */ 02015000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0569 02016000
         MVI   IKTOBUF(@12),X'05'                                  0569 02017000
*            END;                                                  0570 02018000
*          ELSE;                     /* NO VALID CONTROL CHAR FOUND  */ 02019000
@RF00566 DS    0H                                                  0572 02020000
*    TOMBFPTR=TOMGETMN+TOMBFCNT;     /* UPDATE PTR TO NEXT RU BYTE   */ 02021000
@RC00560 DS    0H                                                  0572 02022000
@RC00552 DS    0H                                                  0572 02023000
@RC00546 L     @12,TOMGETMN(,TOMWAPTR)                             0572 02024000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0572 02025000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0572 02026000
*  END;                              /* END FOR INNER DO WHILE LOOP  */ 02027000
         LA    @12,1                                               0573 02028000
         AL    @12,I(,TOMWAPTR)                                    0573 02029000
@DE00545 ST    @12,I(,TOMWAPTR)                                    0573 02030000
         SLR   @15,@15                                             0573 02031000
         IC    @15,TOMWRKSZ(,TOMWAPTR)                             0573 02032000
         CR    @12,@15                                             0573 02033000
         BNH   @DL00545                                            0573 02034000
@DC00545 DS    0H                                                  0574 02035000
*  TOMMVCNT=TOMMVCNT+I-1;            /* UPDATE DATA COUNT    @ZA19885*/ 02036000
         L     @12,TOMMVCNT(,TOMWAPTR)                             0574 02037000
         AL    @12,I(,TOMWAPTR)                                    0574 02038000
         BCTR  @12,0                                               0574 02039000
         ST    @12,TOMMVCNT(,TOMWAPTR)                             0574 02040000
*  TOMQDATA=TOMMVCNT;                /* SAVE CNT OF USER DATA MOVED  */ 02041000
         ST    @12,TOMQDATA(,TOMWAPTR)                             0575 02042000
*  TOMQBPTR=OPBUFADR+TOMMVCNT;       /* UPDATE PTR TO NEXT USER BYTE */ 02043000
         AL    @12,OPBUFADR(,TOMWAPTR)                             0576 02044000
         ST    @12,TOMQBPTR(,TOMWAPTR)                             0576 02045000
*END;                                /* END FOR OUTTER DO WHILE LOOP */ 02046000
@DE00541 L     @12,TOMMVCNT(,TOMWAPTR)                             0577 02047000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0577 02048000
         BNL   @DC00541                                            0577 02049000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0577 02050000
         BCTR  @12,0                                               0577 02051000
         BCTR  @12,0                                               0577 02052000
         C     @12,TOMBFCNT(,TOMWAPTR)                             0577 02053000
         BH    @DL00541                                            0577 02054000
@DC00541 DS    0H                                                  0578 02055000
*END CNTL;                           /* END OF CNTL                  */ 02056000
@EL00015 DS    0H                                                  0578 02057000
@EF00015 DS    0H                                                  0578 02058000
@ER00015 L     @14,@SA00015                                        0578 02059000
         BR    @14                                                 0578 02060000
         EJECT                                                          02061000
*/********************************************************************/ 02062000
*/*                                                                  */ 02063000
*/* THIS PROCEDURE, FULSCRN, WILL EDIT USER FULLSCREEN MODE DATA AND */ 02064000
*/* MOVE THE DATA TO THE OUTPUT RU.                                  */ 02065000
*/*                                                                  */ 02066000
*/********************************************************************/ 02067000
*                                                                  0579 02068000
*FULSCRN: PROCEDURE OPTIONS(SAVE(14));                             0579 02069000
*                                                                  0579 02070000
FULSCRN  ST    @14,12(,@13)                                        0579 02071000
*TOMCOLMN=0;                         /* RESET COLUMN COUNT   @ZA17886*/ 02072000
         SLR   @12,@12                                             0580 02073000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0580 02074000
*IF  (QBUF(1)=ESC) &                 /* FIRST USER BYTE ESCAPE CHAR? */ 02075000
*    (TOMBUFSZ<OPBFSZ) THEN          /* IS DATA LARGER THAN RU SIZE? */ 02076000
         L     @12,TOMQBPTR(,TOMWAPTR)                             0581 02077000
         CLI   QBUF(@12),X'27'                                     0581 02078000
         BNE   @RF00581                                            0581 02079000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0581 02080000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0581 02081000
         BNL   @RF00581                                            0581 02082000
*  OPBFSZ=TOMBUFSZ;                  /* YES, TRUNCATE DATA TO FIT RU */ 02083000
         STH   @12,OPBFSZ(,TOMWAPTR)                               0582 02084000
*ELSE                                /* CONTINUE CHECK FOR TRUNCATION*/ 02085000
*  IF (QBUF(1)^=ESC)       &         /* IS 1ST USER BYTE NOT ESCAPE? */ 02086000
*     (TOMBUFSZ<(OPBFSZ+1)) THEN     /* DATA LARGER THAN RU SIZE?    */ 02087000
         B     @RC00581                                            0583 02088000
@RF00581 L     @12,TOMQBPTR(,TOMWAPTR)                             0583 02089000
         CLI   QBUF(@12),X'27'                                     0583 02090000
         BE    @RF00583                                            0583 02091000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0583 02092000
         LA    @15,1                                               0583 02093000
         AH    @15,OPBFSZ(,TOMWAPTR)                               0583 02094000
         CR    @12,@15                                             0583 02095000
         BNL   @RF00583                                            0583 02096000
*    OPBFSZ=TOMBUFSZ-2;              /* YES, TRUNCATE DATA TO FIT RU */ 02097000
         BCTR  @12,0                                               0584 02098000
         BCTR  @12,0                                               0584 02099000
         STH   @12,OPBFSZ(,TOMWAPTR)                               0584 02100000
*  ELSE;                             /* NO DATA TRUNCATION NEEDED    */ 02101000
@RF00583 DS    0H                                                  0586 02102000
*IF QBUF(1)=ESC THEN                 /* IS FIRST CHARACTER ESCAPE?   */ 02103000
@RC00581 L     @12,TOMQBPTR(,TOMWAPTR)                             0586 02104000
         CLI   QBUF(@12),X'27'                                     0586 02105000
         BNE   @RF00586                                            0586 02106000
*  /******************************************************************/ 02107000
*  /*                                                                */ 02108000
*  /* INCLUDE ESCAPE CHARACTER IS COUNT OF DATA MOVED BUT DO NOT MOVE*/ 02109000
*  /* ESCAPE CHARACTER TO OUTPUT RU.                                 */ 02110000
*  /*                                                                */ 02111000
*  /******************************************************************/ 02112000
*  DO;                                                             0587 02113000
*    TOMMVCNT=1;                     /* COUNT ESCAPE CHAR AS MOVED   */ 02114000
         LA    @12,1                                               0588 02115000
         ST    @12,TOMMVCNT(,TOMWAPTR)                             0588 02116000
*    TOMQBPTR=OPBUFADR+1;            /* SET POINTER PASS ESCAPE      */ 02117000
         AL    @12,OPBUFADR(,TOMWAPTR)                             0589 02118000
         ST    @12,TOMQBPTR(,TOMWAPTR)                             0589 02119000
*    OPBFSZ=OPBFSZ-1;                /* DECREMENT MSG SIZE   @ZA19889*/ 02120000
         LH    @12,OPBFSZ(,TOMWAPTR)                               0590 02121000
         BCTR  @12,0                                               0590 02122000
         STH   @12,OPBFSZ(,TOMWAPTR)                               0590 02123000
*  END;                                                            0591 02124000
*ELSE                                /* ESCAPE CHARACTER NOT PRESENT */ 02125000
*  /******************************************************************/ 02126000
*  /*                                                                */ 02127000
*  /* ESC NOT PRESENT. PUT DEFAULT WRITE COMMAND IN OUTPUT RU.       */ 02128000
*  /*                                                                */ 02129000
*  /******************************************************************/ 02130000
*  DO;                                                             0592 02131000
         B     @RC00586                                            0592 02132000
@RF00586 DS    0H                                                  0593 02133000
*    TOMBFCNT=1;                     /* SET COUNT FOR MOVE INTO RU   */ 02134000
         LA    @12,1                                               0593 02135000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0593 02136000
*    IKTOBUF(1)=WRTCMD;              /* PUT WRITE CMD IN OUTPUT RU   */ 02137000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0594 02138000
         MVI   IKTOBUF(@01),X'F1'                                  0594 02139000
*    TOMBFPTR=TOMGETMN+TOMBFCNT;     /* UPPATE RU BUFFER PTR         */ 02140000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0595 02141000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0595 02142000
*  END;                                                            0596 02143000
*/********************************************************************/ 02144000
*/*                                                                  */ 02145000
*/*           MOVE AND EDIT FULLSCREEN MODE DATA                     */ 02146000
*/*                                                                  */ 02147000
*/********************************************************************/ 02148000
*RFY (REG1,REG2) RSTD;               /* R1 & R2 RSTD FOR TRT @ZA16238*/ 02149000
@RC00586 DS    0H                                                  0598 02150000
*REG2=0;                             /* INIT FOR TRT USE     @ZA16238*/ 02151000
         SLR   REG2,REG2                                           0598 02152000
*DO WHILE (TOMMVCNT<OPBFSZ);         /* CONTINUE UNTIL END OF DATA   */ 02153000
         B     @DE00599                                            0599 02154000
@DL00599 DS    0H                                                  0600 02155000
*  TOMMVCNT=                         /* INCREMENT FOR NEXT MOVE      */ 02156000
*      MIN(OPBFSZ,(TOMQDATA+256));                                 0600 02157000
         L     @12,TOMQDATA(,TOMWAPTR)                             0600 02158000
         LA    @03,256                                             0600 02159000
         ALR   @03,@12                                             0600 02160000
         LH    @00,OPBFSZ(,TOMWAPTR)                               0600 02161000
         CR    @00,@03                                             0600 02162000
         BNH   *+6                                                      02163000
         LR    @00,@03                                             0600 02164000
         ST    @00,TOMMVCNT(,TOMWAPTR)                             0600 02165000
*  TOMBFCNT=TOMBFCNT                 /* MOVE 256 BYTES OR LESS       */ 02166000
*          +(TOMMVCNT-TOMQDATA);                                   0601 02167000
         SLR   @00,@12                                             0601 02168000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0601 02169000
         ALR   @12,@00                                             0601 02170000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0601 02171000
*  IKTOBUF(1:(TOMMVCNT-TOMQDATA))=   /* MOVE USER DATA TO OUTPUT RU  */ 02172000
*         QBUF;                                                    0602 02173000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0602 02174000
         BCTR  @00,0                                               0602 02175000
         L     @03,TOMQBPTR(,TOMWAPTR)                             0602 02176000
         LR    @15,@00                                             0602 02177000
         EX    @15,@SM02418                                        0602 02178000
*  TR(IKTOBUF(1:(TOMMVCNT-TOMQDATA)),FLSCRTAB); /* EDIT OUTPUT RU    */ 02179000
         L     @03,TOMMVCNT(,TOMWAPTR)                             0603 02180000
         SL    @03,TOMQDATA(,TOMWAPTR)                             0603 02181000
         BCTR  @03,0                                               0603 02182000
         EX    @03,@SB02420                                        0603 02183000
*  IF REG2=0 THEN                    /* HAS IC BEEN FOUND?   @ZA16238*/ 02184000
         LTR   REG2,REG2                                           0604 02185000
         BNZ   @RF00604                                            0604 02186000
*    TRT(IKTOBUF(1:(TOMMVCNT-TOMQDATA)),ICTAB); /* FIND IC   @ZA16238*/ 02187000
         L     @03,TOMBFPTR(,TOMWAPTR)                             0605 02188000
         L     @12,TOMMVCNT(,TOMWAPTR)                             0605 02189000
         SL    @12,TOMQDATA(,TOMWAPTR)                             0605 02190000
         BCTR  @12,0                                               0605 02191000
         EX    @12,@SB02422                                        0605 02192000
*  ELSE;                             /* YES, SKIP LOOKING    @ZA16238*/ 02193000
@RF00604 DS    0H                                                  0607 02194000
*  TOMBFPTR=TOMGETMN+TOMBFCNT;       /* UPDATE RU BUFFER PTR         */ 02195000
         L     @12,TOMGETMN(,TOMWAPTR)                             0607 02196000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0607 02197000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0607 02198000
*  TOMQBPTR=TOMQBPTR+TOMMVCNT-TOMQDATA;                     /*ZA17886*/ 02199000
         L     @12,TOMMVCNT(,TOMWAPTR)                             0608 02200000
         L     @03,TOMQBPTR(,TOMWAPTR)                             0608 02201000
         ALR   @03,@12                                             0608 02202000
         SL    @03,TOMQDATA(,TOMWAPTR)                             0608 02203000
         ST    @03,TOMQBPTR(,TOMWAPTR)                             0608 02204000
*  TOMQDATA=TOMMVCNT;                /* SAVE COUNT OF DATA MOVED     */ 02205000
         ST    @12,TOMQDATA(,TOMWAPTR)                             0609 02206000
*END;                                                              0610 02207000
@DE00599 L     @12,TOMMVCNT(,TOMWAPTR)                             0610 02208000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0610 02209000
         BL    @DL00599                                            0610 02210000
*IF REG2=0 THEN                      /* NO IC WAS FOUND      @ZA16238*/ 02211000
         LTR   REG2,REG2                                           0611 02212000
         BNZ   @RF00611                                            0611 02213000
*  DO;                                                             0612 02214000
*    RFY IKTOBUF BASED(TOMGETMN);    /* SET ADDR TO BEGINNING OF RU  */ 02215000
*    IF IKTOBUF(1)=EAU THEN;         /* DON'T DEFAULT IC - EAU CMD!  */ 02216000
         L     @12,TOMGETMN(,TOMWAPTR)                             0614 02217000
         CLI   IKTOBUF(@12),X'6F'                                  0614 02218000
         BE    @RT00614                                            0614 02219000
*    ELSE                                                          0616 02220000
*       DO;                                                /*@ZA16238*/ 02221000
*          TOMBFCNT=TOMBFCNT+1;      /* UPDATE RU DATA CNT FOR CURS  */ 02222000
         LA    @12,1                                               0617 02223000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0617 02224000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0617 02225000
*          RFY IKTOBUF BASED(TOMBFPTR); /* RESTORE ORIGINAL RU PTR   */ 02226000
*          IKTOBUF(1)=IC;            /* PUT IC AT END OF RU  @ZA16238*/ 02227000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0619 02228000
         MVI   IKTOBUF(@12),X'13'                                  0619 02229000
*       END;                                               /*@ZA16238*/ 02230000
*  END;                                                            0621 02231000
*ELSE;                                                     /*@ZA16238*/ 02232000
@RF00611 DS    0H                                                  0623 02233000
*RFY (REG1,REG2) UNRSTD;             /* FREE REG1 AND REG2   @ZA16238*/ 02234000
@RC00611 DS    0H                                                  0624 02235000
*TOMCURST='1'B;                      /* CURSOR IS SET IN RU          */ 02236000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0624 02237000
*TVWAFLSC='1'B;                      /* NEXT SEND IS FULLSCREEN DATA */ 02238000
         OI    TVWAFLSC(TVWAPTR),B'00001000'                       0625 02239000
*TOMTRSBA='1'B;                      /* NO SBA TRACKING              */ 02240000
         OI    TOMTRSBA(TOMWAPTR),B'00000001'                      0626 02241000
*TOMEDSAV='11'B;                     /* SAVE MODE OF TPUT DATA       */ 02242000
         OI    TOMEDSAV(TOMWAPTR),B'11000000'                      0627 02243000
*IF TVWAFSM='0'B THEN                /* FULLSCR MODE OFF?            */ 02244000
         TM    TVWAFSM(TVWAPTR),B'01000000'                        0628 02245000
         BNZ   @RF00628                                            0628 02246000
*  TOMLNCNT=2;                       /* YES, SET LINE CNT FOR I/O    */ 02247000
         MVC   TOMLNCNT(4,TOMWAPTR),@CF00076                       0629 02248000
*ELSE;                               /* FULLSCREEN MODE              */ 02249000
@RF00628 DS    0H                                                  0631 02250000
*END FULSCRN;                        /* END OF FULSCRN               */ 02251000
@EL00016 DS    0H                                                  0631 02252000
@EF00016 DS    0H                                                  0631 02253000
@ER00016 L     @14,12(,@13)                                        0631 02254000
         BR    @14                                                 0631 02255000
         EJECT                                                          02256000
*/********************************************************************/ 02257000
*/*                                                                  */ 02258000
*/* THIS PROCEDURE, ASIS, WILL EDIT ASIS MODE  USER DATA. CONTROL    */ 02259000
*/* HEADER INFORMATION (CMD,WCCSBA@@,SFATTRIB) WILL BE WILL BE VALID */ 02260000
*/* IN ANY COMBINATION(NO REORDERING). MISSING CONTROL INFO  WILL BE */ 02261000
*/* DEFAULTED. LINE COUNTING WILL BE IN EFFECT.                      */ 02262000
*/*                                                                  */ 02263000
*/********************************************************************/ 02264000
*                                                                  0632 02265000
*ASIS: PROCEDURE OPTIONS(SAVE(14));                                0632 02266000
*                                                                  0632 02267000
ASIS     ST    @14,@SA00017                                        0632 02268000
*DCL TEMPMVCT FIXED(31) DEF(J);      /* TEMPORARY WORK VARIABLE      */ 02269000
*                                                                  0633 02270000
*IF (TOMBUFSZ-TOMBFCNT) <                                  /*@ZA19888*/ 02271000
*   (MIN(OPBFSZ-TOMMVCNT,TOMLNSZ))+15 THEN                 /*@ZA19888*/ 02272000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0634 02273000
         SL    @12,TOMBFCNT(,TOMWAPTR)                             0634 02274000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0634 02275000
         SL    @15,TOMMVCNT(,TOMWAPTR)                             0634 02276000
         SLR   @14,@14                                             0634 02277000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0634 02278000
         CR    @15,@14                                             0634 02279000
         BNH   *+6                                                      02280000
         LR    @15,@14                                             0634 02281000
         AL    @15,@CF00113                                        0634 02282000
         CR    @12,@15                                             0634 02283000
         BNL   @RF00634                                            0634 02284000
*  TOMENDBF='1'B;                    /* END OF BUFFER        @ZA19888*/ 02285000
         OI    TOMENDBF(TOMWAPTR),B'00100000'                      0635 02286000
*ELSE                                /* ENOUGH BUFFER SPACE  @ZA19888*/ 02287000
*IF TOMLNCNT>=TOMLNNO THEN           /* IS THIS THE LAST SCRN LINE?  */ 02288000
         B     @RC00634                                            0636 02289000
@RF00634 L     @12,TOMLNCNT(,TOMWAPTR)                             0636 02290000
         C     @12,TOMLNNO(,TOMWAPTR)                              0636 02291000
         BL    @RF00636                                            0636 02292000
*  /******************************************************************/ 02293000
*  /*                                                                */ 02294000
*  /*    BOTTOM OF SCREEN HAS BEEN REACHED SO PAGE AND CONTINUE      */ 02295000
*  /*                                                                */ 02296000
*  /******************************************************************/ 02297000
*  DO;                                                             0637 02298000
*    IF TOMBFCNT=0 THEN              /* IS OUTPUT RU EMPTY?          */ 02299000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0638 02300000
         LTR   @12,@12                                             0638 02301000
         BNZ   @RF00638                                            0638 02302000
*      CALL SCRFORMT;                /* YES, PUT IN CMD AND WCC      */ 02303000
         BAL   @14,SCRFORMT                                        0639 02304000
*    ELSE;                                                         0640 02305000
@RF00638 DS    0H                                                  0641 02306000
*    TOMCOLMN=MAX(0,MIN(TOMCOLMN,TOMLNSZ-7)); /*RESET COLUMN @ZA19887*/ 02307000
         SLR   @12,@12                                             0641 02308000
         IC    @12,TOMLNSZ(,TOMWAPTR)                              0641 02309000
         SL    @12,@CF00034                                        0641 02310000
         L     @15,TOMCOLMN(,TOMWAPTR)                             0641 02311000
         CR    @15,@12                                             0641 02312000
         BNH   *+6                                                      02313000
         LR    @15,@12                                             0641 02314000
         SLR   @12,@12                                             0641 02315000
         CR    @15,@12                                             0641 02316000
         BNL   *+6                                                      02317000
         LR    @15,@12                                             0641 02318000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0641 02319000
*    CALL NEWLINE;                   /* PUT LINE ADDR IN OUTPUT RU   */ 02320000
         BAL   @14,NEWLINE                                         0642 02321000
*    CALL SCRNPAGE;                  /* PUT PAGE PROMPT DATA IN RU   */ 02322000
         BAL   @14,SCRNPAGE                                        0643 02323000
*  END;                                                            0644 02324000
*ELSE                                /* NO SCREEN PAGING NEEDED      */ 02325000
*DO;                                                               0645 02326000
         B     @RC00636                                            0645 02327000
@RF00636 DS    0H                                                  0646 02328000
*  TOMEDSAV='01'B;                   /* ASIS TPUT            @ZA17886*/ 02329000
         NI    TOMEDSAV(TOMWAPTR),B'01111111'                      0646 02330000
         OI    TOMEDSAV(TOMWAPTR),B'01000000'                      0646 02331000
*  CALL CNTLHDRS;                    /* PUT CONTROL HEADER IN RU     */ 02332000
         BAL   @14,CNTLHDRS                                        0647 02333000
*  TOMCOLMN=TOMCOLMN+1;              /* UP COLUMN COUNT      @ZA17886*/ 02334000
         LA    @12,1                                               0648 02335000
         L     @15,TOMCOLMN(,TOMWAPTR)                             0648 02336000
         ALR   @15,@12                                             0648 02337000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0648 02338000
*  I=1;                                                            0649 02339000
         ST    @12,I(,TOMWAPTR)                                    0649 02340000
*  /******************************************************************/ 02341000
*  /*                                                                */ 02342000
*  /* THIS DO GROUP WILL BUILD LINES OF ASIS MODE DATA UNTIL THE DATA*/ 02343000
*  /* COUNT IS ZERO,SCREEN PAGING IS NEEDED, OR RU BUFFER IS USED UP.*/ 02344000
*  /*                                                                */ 02345000
*  /******************************************************************/ 02346000
*  DO WHILE (TOMMVCNT<OPBFSZ)&(TOMENDSC='0'B)&(TOMENDBF='0'B);     0650 02347000
         B     @DE00650                                            0650 02348000
@DL00650 DS    0H                                                  0651 02349000
*    TOMNWLSZ=TOMQDATA+MIN(TOMLNSZ-TOMCOLMN,OPBFSZ-TOMQDATA,       0651 02350000
*             TOMBUFSZ-TOMBFCNT);                           /*ZA17886*/ 02351000
         L     @12,TOMQDATA(,TOMWAPTR)                             0651 02352000
         SLR   @15,@15                                             0651 02353000
         IC    @15,TOMLNSZ(,TOMWAPTR)                              0651 02354000
         LR    @14,@15                                             0651 02355000
         SL    @14,TOMCOLMN(,TOMWAPTR)                             0651 02356000
         LH    @11,OPBFSZ(,TOMWAPTR)                               0651 02357000
         SLR   @11,@12                                             0651 02358000
         CR    @14,@11                                             0651 02359000
         BNH   *+6                                                      02360000
         LR    @14,@11                                             0651 02361000
         L     @11,TOMBUFSZ(,TOMWAPTR)                             0651 02362000
         SL    @11,TOMBFCNT(,TOMWAPTR)                             0651 02363000
         CR    @14,@11                                             0651 02364000
         BNH   *+6                                                      02365000
         LR    @14,@11                                             0651 02366000
         ALR   @12,@14                                             0651 02367000
         ST    @12,TOMNWLSZ(,TOMWAPTR)                             0651 02368000
*    IF (I=1)             &          /* FIRST PASS THROUGH LOOP?     */ 02369000
*       (TOMNWLSZ=TOMLNSZ) THEN      /* CURRENT LINE-SZ=LOGICAL SIZE */ 02370000
         LA    @14,1                                               0652 02371000
         C     @14,I(,TOMWAPTR)                                    0652 02372000
         BNE   @RF00652                                            0652 02373000
         CR    @12,@15                                             0652 02374000
         BNE   @RF00652                                            0652 02375000
*      TOMNWLSZ=MAX(TOMNWLSZ-1,1);   /* SPACE FOR ATTRIB ON 1ST PASS */ 02376000
         BCTR  @12,0                                               0653 02377000
         CR    @12,@14                                             0653 02378000
         BNL   *+6                                                      02379000
         LR    @12,@14                                             0653 02380000
         ST    @12,TOMNWLSZ(,TOMWAPTR)                             0653 02381000
*    ELSE;                                                         0654 02382000
@RF00652 DS    0H                                                  0655 02383000
*    I=MAX(TOMQDATA,1);              /* MAX OF TOMQDATA & 1  @ZA17031*/ 02384000
         L     @12,TOMQDATA(,TOMWAPTR)                             0655 02385000
         LA    @15,1                                               0655 02386000
         CR    @12,@15                                             0655 02387000
         BNL   *+6                                                      02388000
         LR    @12,@15                                             0655 02389000
         ST    @12,I(,TOMWAPTR)                                    0655 02390000
*    /****************************************************************/ 02391000
*    /*                                                              */ 02392000
*    /* DETERMINE INDEX INTO UNPROCESSED USER'S DATA TO GET A LINE-  */ 02393000
*    /* SIZE OF PRINTABLE DATA. STORE THIS INDEX IN NWLNSZ.          */ 02394000
*    /*                                                              */ 02395000
*    /****************************************************************/ 02396000
*    TOMXCNT=0;                      /* INITIALIZE TOMXCNT   @ZA17886*/ 02397000
         SLR   @12,@12                                             0656 02398000
         ST    @12,TOMXCNT(,TOMWAPTR)                              0656 02399000
*    DO WHILE((I<TOMNWLSZ) &                                       0657 02400000
*             (TOMNWLSZ<=OPBFSZ) &                                 0657 02401000
*             ((TOMBUFSZ-(TOMBFCNT+TOMNWLSZ))>0));                 0657 02402000
         B     @DE00657                                            0657 02403000
@DL00657 DS    0H                                                  0658 02404000
*      IF QBUF(I)=PT |               /* CHECK FOR PROGRAM TAB (PT)   */ 02405000
*         QBUF(I)=EUA|               /* ERASE UNPROTECTED T0 @ (EUA) */ 02406000
*         QBUF(I)=RA  THEN           /* REPEAT TO ADDRESS (RA)?      */ 02407000
         L     @12,I(,TOMWAPTR)                                    0658 02408000
         L     @15,TOMQBPTR(,TOMWAPTR)                             0658 02409000
         ALR   @12,@15                                             0658 02410000
         BCTR  @12,0                                               0658 02411000
         CLI   QBUF(@12),X'05'                                     0658 02412000
         BE    @RT00658                                            0658 02413000
         L     @12,I(,TOMWAPTR)                                    0658 02414000
         ALR   @12,@15                                             0658 02415000
         BCTR  @12,0                                               0658 02416000
         CLI   QBUF(@12),X'12'                                     0658 02417000
         BE    @RT00658                                            0658 02418000
         L     @12,I(,TOMWAPTR)                                    0658 02419000
         ALR   @15,@12                                             0658 02420000
         BCTR  @15,0                                               0658 02421000
         CLI   QBUF(@15),X'3C'                                     0658 02422000
         BNE   @RF00658                                            0658 02423000
@RT00658 DS    0H                                                  0659 02424000
*        DO;                         /*                      @ZA19884*/ 02425000
*          TOMXCNT=TOMXCNT+1;        /*                      @ZA19884*/ 02426000
         LA    @12,1                                               0660 02427000
         L     @15,TOMXCNT(,TOMWAPTR)                              0660 02428000
         ALR   @15,@12                                             0660 02429000
         ST    @15,TOMXCNT(,TOMWAPTR)                              0660 02430000
*          TOMNWLSZ=TOMNWLSZ+1;      /* INCREMENT PASS NONPRINT CHAR */ 02431000
         AL    @12,TOMNWLSZ(,TOMWAPTR)                             0661 02432000
         ST    @12,TOMNWLSZ(,TOMWAPTR)                             0661 02433000
*        END;                        /*                      @ZA19884*/ 02434000
*      ELSE                          /* CONTINUE CHK FOR BUFFER CNTLS*/ 02435000
*        IF QBUF(I)=SBA THEN         /* SET BUFFER ADDRESS (SBA)?    */ 02436000
         B     @RC00658                                            0663 02437000
@RF00658 L     @12,I(,TOMWAPTR)                                    0663 02438000
         L     @01,TOMQBPTR(,TOMWAPTR)                             0663 02439000
         ALR   @01,@12                                             0663 02440000
         BCTR  @01,0                                               0663 02441000
         CLI   QBUF(@01),X'11'                                     0663 02442000
         BNE   @RF00663                                            0663 02443000
*          DO;                                                     0664 02444000
*            TOMNWLSZ=TOMNWLSZ+3;    /* SET COUNT FOR SBA ORDER      */ 02445000
         LA    @15,3                                               0665 02446000
         L     @14,TOMNWLSZ(,TOMWAPTR)                             0665 02447000
         ALR   @14,@15                                             0665 02448000
         ST    @14,TOMNWLSZ(,TOMWAPTR)                             0665 02449000
*            I=I+2;                  /*                              */ 02450000
         AL    @12,@CF00076                                        0666 02451000
         ST    @12,I(,TOMWAPTR)                                    0666 02452000
*            TOMXCNT=TOMXCNT+3;      /* INCREMENT TOMXCNT    @ZA17886*/ 02453000
         AL    @15,TOMXCNT(,TOMWAPTR)                              0667 02454000
         ST    @15,TOMXCNT(,TOMWAPTR)                              0667 02455000
*          END;                                                    0668 02456000
*        ELSE;                                                     0669 02457000
@RF00663 DS    0H                                                  0670 02458000
*      I=I+1;                        /* SET INDEX TO SKIP NON-PRINT  */ 02459000
@RC00658 LA    @12,1                                               0670 02460000
         AL    @12,I(,TOMWAPTR)                                    0670 02461000
         ST    @12,I(,TOMWAPTR)                                    0670 02462000
*    END;                            /* END DO WHILE LOOP            */ 02463000
@DE00657 L     @12,TOMNWLSZ(,TOMWAPTR)                             0671 02464000
         C     @12,I(,TOMWAPTR)                                    0671 02465000
         BNH   @DC00657                                            0671 02466000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0671 02467000
         BH    @DC00657                                            0671 02468000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0671 02469000
         LCR   @12,@12                                             0671 02470000
         AL    @12,TOMBUFSZ(,TOMWAPTR)                             0671 02471000
         LTR   @12,@12                                             0671 02472000
         BP    @DL00657                                            0671 02473000
@DC00657 DS    0H                                                  0672 02474000
*    /****************************************************************/ 02475000
*    /*                                                              */ 02476000
*    /* THIS DO GROUP WILL MOVE & EDIT ONE LINESIZE OR LESS OF PRINT-*/ 02477000
*    /* ABLE USER S DATA-LESS IF DATA OR RU BUFFER SPACE RUNS OUT    */ 02478000
*    /*                                                              */ 02479000
*    /****************************************************************/ 02480000
*    DO WHILE ((TOMNWLSZ-TOMQDATA)>0)&(((TOMBUFSZ-1)-TOMBFCNT)>0); 0672 02481000
         B     @DE00672                                            0672 02482000
@DL00672 DS    0H                                                  0673 02483000
*      TEMPMVCT=                                                   0673 02484000
*       MIN(TOMNWLSZ,(TOMQDATA+80)); /* MOVE MAXIMUM OF 80 CHARACTER */ 02485000
         L     @12,TOMQDATA(,TOMWAPTR)                             0673 02486000
         LA    @15,80                                              0673 02487000
         ALR   @15,@12                                             0673 02488000
         L     @14,TOMNWLSZ(,TOMWAPTR)                             0673 02489000
         CR    @14,@15                                             0673 02490000
         BNH   *+6                                                      02491000
         LR    @14,@15                                             0673 02492000
         ST    @14,TEMPMVCT(,TOMWAPTR)                             0673 02493000
*      TOMWRKSZ=MIN((TEMPMVCT-TOMQDATA),((TOMBUFSZ-1)-TOMBFCNT));  0674 02494000
         SLR   @14,@12                                             0674 02495000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0674 02496000
         BCTR  @12,0                                               0674 02497000
         L     @15,TOMBFCNT(,TOMWAPTR)                             0674 02498000
         SLR   @12,@15                                             0674 02499000
         CR    @14,@12                                             0674 02500000
         BNH   *+6                                                      02501000
         LR    @14,@12                                             0674 02502000
         STC   @14,TOMWRKSZ(,TOMWAPTR)                             0674 02503000
*      TOMMVCNT=TOMMVCNT+TOMWRKSZ;   /* SET COUNT FOR MOVE OF DATA   */ 02504000
         L     @12,TOMMVCNT(,TOMWAPTR)                             0675 02505000
         ALR   @12,@14                                             0675 02506000
         ST    @12,TOMMVCNT(,TOMWAPTR)                             0675 02507000
*      TOMWRKBF(1:TOMWRKSZ)=QBUF;    /* MOVE USER DATA TO WORK AREA  */ 02508000
         LR    @11,@14                                             0676 02509000
         BCTR  @11,0                                               0676 02510000
         L     @01,TOMQBPTR(,TOMWAPTR)                             0676 02511000
         EX    @11,@SM02416                                        0676 02512000
*      TR(TOMWRKBF(1:TOMWRKSZ),ASISTAB);/* REPLACE INVALID CHARACTERS*/ 02513000
         SLR   @10,@10                                             0677 02514000
         IC    @10,TOMWRKSZ(,TOMWAPTR)                             0677 02515000
         BCTR  @10,0                                               0677 02516000
         EX    @10,@SB02425                                        0677 02517000
*      TOMBFCNT=TOMBFCNT+TOMWRKSZ;   /* COUNT FOR MOVE TO RU BUFFER  */ 02518000
         ALR   @15,@14                                             0678 02519000
         ST    @15,TOMBFCNT(,TOMWAPTR)                             0678 02520000
*      IKTOBUF(1:TOMWRKSZ)=TOMWRKBF; /* MOVE USER DATA TO RU BUFFER  */ 02521000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0679 02522000
         EX    @11,@SM02427                                        0679 02523000
*      TOMQDATA=TOMMVCNT;            /* SAVE CNT OF USER DATA MOVED  */ 02524000
         ST    @12,TOMQDATA(,TOMWAPTR)                             0680 02525000
*      TOMBFPTR=TOMGETMN+TOMBFCNT;   /* UPDATE RU BUFFER PTR         */ 02526000
         AL    @15,TOMGETMN(,TOMWAPTR)                             0681 02527000
         ST    @15,TOMBFPTR(,TOMWAPTR)                             0681 02528000
*      TOMQBPTR=OPBUFADR+TOMMVCNT;   /* UPDATE PTR TO UNUSED DATA    */ 02529000
         AL    @12,OPBUFADR(,TOMWAPTR)                             0682 02530000
         ST    @12,TOMQBPTR(,TOMWAPTR)                             0682 02531000
*      TOMCOLMN=TOMCOLMN+TOMWRKSZ-TOMXCNT;                 /*@ZA17886*/ 02532000
         AL    @14,TOMCOLMN(,TOMWAPTR)                             0683 02533000
         SL    @14,TOMXCNT(,TOMWAPTR)                              0683 02534000
         ST    @14,TOMCOLMN(,TOMWAPTR)                             0683 02535000
*    END;                            /* END DO WHILE LOOP            */ 02536000
@DE00672 SLR   @12,@12                                             0684 02537000
         L     @15,TOMNWLSZ(,TOMWAPTR)                             0684 02538000
         SL    @15,TOMQDATA(,TOMWAPTR)                             0684 02539000
         CR    @15,@12                                             0684 02540000
         BNH   @DC00672                                            0684 02541000
         L     @15,TOMBUFSZ(,TOMWAPTR)                             0684 02542000
         BCTR  @15,0                                               0684 02543000
         SL    @15,TOMBFCNT(,TOMWAPTR)                             0684 02544000
         CR    @15,@12                                             0684 02545000
         BH    @DL00672                                            0684 02546000
@DC00672 DS    0H                                                  0685 02547000
*    IF TOMMVCNT=OPBFSZ THEN         /* HAS ALL DATA BEEN MOVED?     */ 02548000
         L     @12,TOMMVCNT(,TOMWAPTR)                             0685 02549000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0685 02550000
         BNE   @RF00685                                            0685 02551000
*      /**************************************************************/ 02552000
*      /*                                                            */ 02553000
*      /* AT END OF USER'S DATA THIS ENDDATA WILL PROCESS BYPASS AND */ 02554000
*      /* INSERT CURSOR ORDERS.                                      */ 02555000
*      /*                                                            */ 02556000
*      /**************************************************************/ 02557000
*      CALL ENDDATA;                 /* PROCESS LAST TWO DATA BYTES  */ 02558000
         BAL   @14,ENDDATA                                         0686 02559000
*    ELSE                            /* END OF USER DATA NOT REACHED */ 02560000
*      /**************************************************************/ 02561000
*      /*                                                            */ 02562000
*      /* MORE USER DATA EXIST SO DO NEWLINE PROCESSING & CONTINUE   */ 02563000
*      /*                                                            */ 02564000
*      /**************************************************************/ 02565000
*      DO;                                                         0687 02566000
         B     @RC00685                                            0687 02567000
@RF00685 DS    0H                                                  0688 02568000
*        TOMCOLMN=0;                 /* RESET COLUMN COUNT   @ZA17886*/ 02569000
         SLR   @12,@12                                             0688 02570000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0688 02571000
*        TOMLNCNT=TOMLNCNT+1;        /* ADD ONE TO LINE COUNT        */ 02572000
         LA    @12,1                                               0689 02573000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0689 02574000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0689 02575000
*        IF (TOMBUFSZ-TOMBFCNT)<                                   0690 02576000
*           EVAL(MIN((OPBFSZ-TOMMVCNT),TOMLNSZ)+15) THEN           0690 02577000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0690 02578000
         SL    @12,TOMBFCNT(,TOMWAPTR)                             0690 02579000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0690 02580000
         SL    @15,TOMMVCNT(,TOMWAPTR)                             0690 02581000
         SLR   @14,@14                                             0690 02582000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0690 02583000
         CR    @15,@14                                             0690 02584000
         BNH   *+6                                                      02585000
         LR    @15,@14                                             0690 02586000
         AL    @15,@CF00113                                        0690 02587000
         CR    @12,@15                                             0690 02588000
         BNL   @RF00690                                            0690 02589000
*          /**********************************************************/ 02590000
*          /*                                                        */ 02591000
*          /* NOT ENOUGH RU BUFFER FOR LINESZ OF DATA AND PAGING     */ 02592000
*          /* PROMPT SO SEND CURRENT RU AND CONTINUE                 */ 02593000
*          /*                                                        */ 02594000
*          /**********************************************************/ 02595000
*          TOMENDBF='1'B;            /* END OF OUTPUT RU REACHED     */ 02596000
         OI    TOMENDBF(TOMWAPTR),B'00100000'                      0691 02597000
*        ELSE                        /* RU BUFFER SPACE STILL EXIST  */ 02598000
*          DO;                       /*                      @ZA17040*/ 02599000
         B     @RC00690                                            0692 02600000
@RF00690 DS    0H                                                  0693 02601000
*            CALL NEWLINE;           /* LINE ADDRESS IN RU   @ZA17040*/ 02602000
         BAL   @14,NEWLINE                                         0693 02603000
*            IF TOMLNCNT>=TOMLNNO THEN /* LAST SCREEN LINE?          */ 02604000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0694 02605000
         C     @12,TOMLNNO(,TOMWAPTR)                              0694 02606000
         BL    @RF00694                                            0694 02607000
*              CALL SCRNPAGE;          /* PUT PAGE PROMPT IN RU      */ 02608000
         BAL   @14,SCRNPAGE                                        0695 02609000
*            ELSE;                   /* NOT LAST SCREEN LINE         */ 02610000
@RF00694 DS    0H                                                  0697 02611000
*          END;                      /*                      @ZA17040*/ 02612000
*      END;                                                        0698 02613000
@RC00690 DS    0H                                                  0699 02614000
*  END;                              /* END DO WHILE LOOP            */ 02615000
@RC00685 DS    0H                                                  0699 02616000
@DE00650 L     @12,TOMMVCNT(,TOMWAPTR)                             0699 02617000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0699 02618000
         BNL   @DC00650                                            0699 02619000
         TM    TOMENDSC(TOMWAPTR),B'00101000'                      0699 02620000
         BZ    @DL00650                                            0699 02621000
@DC00650 DS    0H                                                  0700 02622000
*END;                                                              0700 02623000
*END ASIS;                           /* END OF ASIS                  */ 02624000
@EL00017 DS    0H                                                  0701 02625000
@EF00017 DS    0H                                                  0701 02626000
@ER00017 L     @14,@SA00017                                        0701 02627000
         BR    @14                                                 0701 02628000
         EJECT                                                          02629000
*/********************************************************************/ 02630000
*/*                                                                  */ 02631000
*/* THIS PROCEDURE, ENDDATA  , WILL BE CALLED TO PROCESS LAST TWO    */ 02632000
*/* BYTES OF USER DATA IF EDIT OR ASIS IS SPECIFIED.                 */ 02633000
*/*                                                                  */ 02634000
*/********************************************************************/ 02635000
*                                                                  0702 02636000
*ENDDATA: PROCEDURE OPTIONS(SAVE(14));                             0702 02637000
*                                                                  0702 02638000
ENDDATA  ST    @14,@SA00018                                        0702 02639000
*TOMBFPTR=TOMGETMN+TOMBFCNT-2;       /* BACK UP FOR MOVE OF BYPASS   */ 02640000
         LA    @12,2                                               0703 02641000
         L     @15,TOMBFCNT(,TOMWAPTR)                             0703 02642000
         L     @14,TOMGETMN(,TOMWAPTR)                             0703 02643000
         ALR   @14,@15                                             0703 02644000
         SLR   @14,@12                                             0703 02645000
         ST    @14,TOMBFPTR(,TOMWAPTR)                             0703 02646000
*TOMQBPTR=OPBUFADR+TOMMVCNT-2;       /* BACK UP FOR MOVE OF BYPASS   */ 02647000
         L     @11,OPBUFADR(,TOMWAPTR)                             0704 02648000
         AL    @11,TOMMVCNT(,TOMWAPTR)                             0704 02649000
         SLR   @11,@12                                             0704 02650000
         ST    @11,TOMQBPTR(,TOMWAPTR)                             0704 02651000
*IF QBUF(2)=BYP THEN                 /* IS LAST USER BYTE BYPASS?    */ 02652000
         CLI   QBUF+1(@11),X'24'                                   0705 02653000
         BNE   @RF00705                                            0705 02654000
*  /******************************************************************/ 02655000
*  /*                                                                */ 02656000
*  /*       LAST IS BYPASS. REPLACE WITH START FIELD & BYPASS ATTRIB */ 02657000
*  /*                                                                */ 02658000
*  /******************************************************************/ 02659000
*  DO;                                                             0706 02660000
*    TOMBFCNT=TOMBFCNT+1;            /* SET INDEX FOR MOVE INTO RU   */ 02661000
         AL    @15,@CF00064                                        0707 02662000
         ST    @15,TOMBFCNT(,TOMWAPTR)                             0707 02663000
*    IKTOBUF(2:3)=SFBYPATT;          /* PUT START FLD/BYP ATT IN RU  */ 02664000
         MVC   IKTOBUF+1(2,@14),@CB01958                           0708 02665000
*    TVWANOFB='1'B;                  /* NO FLASH BACK FOR THIS DATA  */ 02666000
         OI    TVWANOFB(TVWAPTR),B'00010000'                       0709 02667000
*    TOMCOLMN=0;                     /* RESET COLUMN COUNT   @ZA17886*/ 02668000
         SLR   @12,@12                                             0710 02669000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0710 02670000
*  END;                                                            0711 02671000
*ELSE                                /* CONTINUE END CHARACTER CHECK */ 02672000
*  IF OPBFSZ>1 &                     /* MESSAGE SIZE > 1?    @ZA17886*/ 02673000
*    (QBUF(1:2)=BYPNL |              /* IS LAST 2 USER BYTES BYP/NL? */ 02674000
*     QBUF(1:2)=BYPCR) THEN          /* IS LAST 2 USER BYTES BYP/CR? */ 02675000
         B     @RC00705                                            0712 02676000
@RF00705 LH    @12,OPBFSZ(,TOMWAPTR)                               0712 02677000
         C     @12,@CF00064                                        0712 02678000
         BNH   @RF00712                                            0712 02679000
         L     @12,TOMQBPTR(,TOMWAPTR)                             0712 02680000
         CLC   QBUF(2,@12),@CB01928                                0712 02681000
         BE    @RT00712                                            0712 02682000
         CLC   QBUF(2,@12),@CB01926                                0712 02683000
         BNE   @RF00712                                            0712 02684000
@RT00712 DS    0H                                                  0713 02685000
*    /****************************************************************/ 02686000
*    /*                                                              */ 02687000
*    /* LAST CHAR IS BYPASS. REPLACE WITH START FIELD & BYPASS ATTRIB*/ 02688000
*    /*                                                              */ 02689000
*    /****************************************************************/ 02690000
*    DO;                                                           0713 02691000
*      IKTOBUF(1:2)=SFBYPATT;        /* PUT SF AND BYP ATTRIB IN RU  */ 02692000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0714 02693000
         MVC   IKTOBUF(2,@12),@CB01958                             0714 02694000
*      TVWANOFB='1'B;                /* NO FLASH BACK FOR THIS DATA  */ 02695000
         OI    TVWANOFB(TVWAPTR),B'00010000'                       0715 02696000
*      TOMCOLMN=0;                   /* RESET COLUMN COUNT   @ZA17886*/ 02697000
         SLR   @12,@12                                             0716 02698000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0716 02699000
*    END;                                                          0717 02700000
*  ELSE                              /* CONTINUE END CHARACTER CHECK */ 02701000
*    IF (QBUF(2)=IC) &               /* IS LAST CHAR INSERT CURSOR?  */ 02702000
*       (OPEDIT='01'B) THEN          /* IS CURRENT TPUT ASIS MODE?   */ 02703000
         B     @RC00712                                            0718 02704000
@RF00712 L     @12,TOMQBPTR(,TOMWAPTR)                             0718 02705000
         CLI   QBUF+1(@12),X'13'                                   0718 02706000
         BNE   @RF00718                                            0718 02707000
         TM    OPEDIT(TOMWAPTR),B'00010000'                        0718 02708000
         BNO   @RF00718                                            0718 02709000
         TM    OPEDIT(TOMWAPTR),B'00100000'                        0718 02710000
         BNZ   @RF00718                                            0718 02711000
*      /**************************************************************/ 02712000
*      /*                                                            */ 02713000
*      /* INSERT CURSOR IS VALID AS LAST CHARACTER FOR ASIS MODE DATA*/ 02714000
*      /*                                                            */ 02715000
*      /**************************************************************/ 02716000
*      DO;                                                         0719 02717000
*        IKTOBUF(2)=IC;              /* PUT INSERT CURS ORDER IN RU  */ 02718000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0720 02719000
         MVI   IKTOBUF+1(@12),X'13'                                0720 02720000
*        TOMCURST='1'B;              /* TURN CURSOR SET FLAG ON      */ 02721000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0721 02722000
*        TOMCOLMN=TOMCOLMN-1;        /*                      @ZA17040*/ 02723000
         L     @12,TOMCOLMN(,TOMWAPTR)                             0722 02724000
         BCTR  @12,0                                               0722 02725000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0722 02726000
*      END;                                                        0723 02727000
*    ELSE                            /* CONTINUE END CHARACTER CHECK */ 02728000
*      /**************************************************************/ 02729000
*      /*                                                            */ 02730000
*      /* IF VALID BYPASS IS NOT FOUND AND CURSOR IS NOT SET         */ 02731000
*      /* DO GROUP WILL PUT DEFAULT ATTRIBUTE AT END OF DATA         */ 02732000
*      /*                                                            */ 02733000
*      /**************************************************************/ 02734000
*      DO;                                                         0724 02735000
         B     @RC00718                                            0724 02736000
@RF00718 DS    0H                                                  0725 02737000
*        IF QBUF(2)=NL THEN          /* IS LAST USER BYTE NEWLINE?   */ 02738000
         L     @12,TOMQBPTR(,TOMWAPTR)                             0725 02739000
         CLI   QBUF+1(@12),X'15'                                   0725 02740000
         BNE   @RF00725                                            0725 02741000
*          TOMBFCNT=TOMBFCNT-1;      /* YES, REMOVE NL FROM RU       */ 02742000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0726 02743000
         BCTR  @12,0                                               0726 02744000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0726 02745000
*        ELSE;                                                     0727 02746000
@RF00725 DS    0H                                                  0728 02747000
*        TOMBFPTR=TOMGETMN+TOMBFCNT; /* RESTORE RU BUFFER POINTER    */ 02748000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0728 02749000
         L     @15,TOMGETMN(,TOMWAPTR)                             0728 02750000
         ALR   @15,@12                                             0728 02751000
         ST    @15,TOMBFPTR(,TOMWAPTR)                             0728 02752000
*        IF TOMCOLMN<TOMLNSZ THEN    /* SPACE LEFT ON LINE?  @ZA17886*/ 02753000
         L     @14,TOMCOLMN(,TOMWAPTR)                             0729 02754000
         SLR   @11,@11                                             0729 02755000
         IC    @11,TOMLNSZ(,TOMWAPTR)                              0729 02756000
         CR    @14,@11                                             0729 02757000
         BNL   @RF00729                                            0729 02758000
*          DO;                       /* SPACE LEFT ON LINE   @ZA17040*/ 02759000
*            TOMBFCNT=TOMBFCNT+2;    /* ADD 2 TO BUF COUNT   @ZA17040*/ 02760000
         AL    @12,@CF00076                                        0731 02761000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0731 02762000
*            TOMCOLMN=TOMCOLMN+1;    /* ADD 1 TO COLUMN COUNT@ZA17886*/ 02763000
         LA    @10,1                                               0732 02764000
         ALR   @14,@10                                             0732 02765000
         ST    @14,TOMCOLMN(,TOMWAPTR)                             0732 02766000
*            IKTOBUF(1:2)=SFRDATT;   /* PUT IN ATTR. BYTE    @ZA17040*/ 02767000
         MVC   IKTOBUF(2,@15),@CB01962                             0733 02768000
*            IF OPEDIT='01'B & QBUF(2)^=NL THEN  /*ASIS & ^NL@ZA17040*/ 02769000
         TM    OPEDIT(TOMWAPTR),B'00010000'                        0734 02770000
         BNO   @RF00734                                            0734 02771000
         TM    OPEDIT(TOMWAPTR),B'00100000'                        0734 02772000
         BNZ   @RF00734                                            0734 02773000
         L     @01,TOMQBPTR(,TOMWAPTR)                             0734 02774000
         CLI   QBUF+1(@01),X'15'                                   0734 02775000
         BE    @RF00734                                            0734 02776000
*              IF TOMCOLMN<TOMLNSZ THEN /* ROOM ON LINE?     @ZA17886*/ 02777000
         CR    @14,@11                                             0735 02778000
         BNL   @RF00735                                            0735 02779000
*                DO;                 /* SPACE LEFT ON LINE   @ZA17040*/ 02780000
*                  TOMBFCNT=TOMBFCNT+1; /* ADD 1 TO BUFCNT   @ZA17040*/ 02781000
         ALR   @12,@10                                             0737 02782000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0737 02783000
*                  TOMCURST='1'B;    /* SHOW CURSOR IS SET   @ZA17040*/ 02784000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0738 02785000
*                  IKTOBUF(3)=IC;    /* PUT IC IN THE RU     @ZA17040*/ 02786000
         MVI   IKTOBUF+2(@15),X'13'                                0739 02787000
*                END;                /*                      @ZA17040*/ 02788000
*              ELSE                  /* NO ROOM LEFT ON LINE @ZA17040*/ 02789000
*                DO;                 /*                      @ZA17040*/ 02790000
         B     @RC00735                                            0741 02791000
@RF00735 DS    0H                                                  0742 02792000
*                  TOMLNCNT=TOMLNCNT+1;                    /*@ZA17040*/ 02793000
         LA    @12,1                                               0742 02794000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0742 02795000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0742 02796000
*                  TOMCOLMN=0;       /* RESET COLUMN COUNT   @ZA17040*/ 02797000
         SLR   @15,@15                                             0743 02798000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0743 02799000
*                  IF TOMLNCNT<TOMLNNO THEN                /*@ZA17040*/ 02800000
         C     @12,TOMLNNO(,TOMWAPTR)                              0744 02801000
         BNL   @RF00744                                            0744 02802000
*                    DO;             /* SPACE ON SCREEN      @ZA17040*/ 02803000
*                      CALL NEWLINE; /* GET ADDR OF NEW LINE @ZA17040*/ 02804000
         BAL   @14,NEWLINE                                         0746 02805000
*                      TOMBFCNT=TOMBFCNT+1;                /*@ZA17040*/ 02806000
         LA    @12,1                                               0747 02807000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0747 02808000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0747 02809000
*                      TOMCURST='1'B;/* CURSOR IS SET        @ZA17040*/ 02810000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0748 02811000
*                      IKTOBUF(3)=IC;/* PUT IC IN RU         @ZA17040*/ 02812000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0749 02813000
         MVI   IKTOBUF+2(@12),X'13'                                0749 02814000
*                    END;            /*                      @ZA17040*/ 02815000
*                  ELSE;             /* NO SPACE WAS LEFT    @ZA17040*/ 02816000
@RF00744 DS    0H                                                  0752 02817000
*                END;                /*                      @ZA17040*/ 02818000
*            ELSE                    /* EDIT OR NEWLINE      @ZA17040*/ 02819000
*              TOMCOLMN=0;           /* RESET COLUMN COUNT   @ZA17040*/ 02820000
         B     @RC00734                                            0753 02821000
@RF00734 SLR   @12,@12                                             0753 02822000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0753 02823000
*          END;                      /*                      @ZA17040*/ 02824000
*        ELSE                        /* NO SPACE ON LINE             */ 02825000
*          /**********************************************************/ 02826000
*          /*                                                        */ 02827000
*          /*  NO SPACE ON THIS LINE PUT ATTRIBUTE ON NEXT LINE      */ 02828000
*          /*                                                        */ 02829000
*          /**********************************************************/ 02830000
*          DO;                                                     0755 02831000
         B     @RC00729                                            0755 02832000
@RF00729 DS    0H                                                  0756 02833000
*            TOMLNCNT=TOMLNCNT+1;    /* ADD ONE TO LINE COUNT        */ 02834000
         LA    @12,1                                               0756 02835000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0756 02836000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0756 02837000
*            TOMCOLMN=0;             /* RESET COLUMN COUNT   @ZA17886*/ 02838000
         SLR   @15,@15                                             0757 02839000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0757 02840000
*            IF TOMLNCNT<TOMLNNO THEN/* IS THIS THE LAST SCRN LINE?  */ 02841000
         C     @12,TOMLNNO(,TOMWAPTR)                              0758 02842000
         BNL   @RF00758                                            0758 02843000
*              /******************************************************/ 02844000
*              /*                                                    */ 02845000
*              /*THIS IS NOT THE LAST LINE. PUT IN ATTRIB AND CURSOR */ 02846000
*              /*                                                    */ 02847000
*              /******************************************************/ 02848000
*              DO;                                                 0759 02849000
*                CALL NEWLINE;       /* GET ADDRESS OF NEW LINE      */ 02850000
         BAL   @14,NEWLINE                                         0760 02851000
*                TOMBFCNT=TOMBFCNT+3;/* SET COUNT FOR ATTRIBUTE      */ 02852000
         LA    @12,3                                               0761 02853000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0761 02854000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0761 02855000
*                IKTOBUF(1:3)=SFRDATIC;/* PUT SF & RD ATTRIB IN RU   */ 02856000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0762 02857000
         MVC   IKTOBUF(3,@12),@CB01960                             0762 02858000
*                TOMCURST='1'B;      /* CURSOR IS SET IN RU          */ 02859000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0763 02860000
*                TOMCOLMN=TOMCOLMN+1;/* UP COLUMN COUNT      @ZA17886*/ 02861000
         LA    @12,1                                               0764 02862000
         AL    @12,TOMCOLMN(,TOMWAPTR)                             0764 02863000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0764 02864000
*              END;                                                0765 02865000
*            ELSE;                                                 0766 02866000
@RF00758 DS    0H                                                  0767 02867000
*          END;                                                    0767 02868000
*      END;                                                        0768 02869000
@RC00729 DS    0H                                                  0769 02870000
*TOMBFPTR=TOMGETMN+TOMBFCNT;         /* UPDATE RU BUFFER POINTER     */ 02871000
@RC00718 DS    0H                                                  0769 02872000
@RC00712 DS    0H                                                  0769 02873000
@RC00705 L     @12,TOMGETMN(,TOMWAPTR)                             0769 02874000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0769 02875000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0769 02876000
*TOMQBPTR=OPBUFADR+TOMMVCNT;         /* RESTORE QUEUE BUFFER POINTER */ 02877000
         L     @12,OPBUFADR(,TOMWAPTR)                             0770 02878000
         AL    @12,TOMMVCNT(,TOMWAPTR)                             0770 02879000
         ST    @12,TOMQBPTR(,TOMWAPTR)                             0770 02880000
*IF (TOMLNCNT>=TOMLNNO)|             /* IF LAST LINE DON'T UPDATE CNT*/ 02881000
*   (TOMCURST='1'B)     THEN;        /* IF CURSOR SET DON'T UP COUNT */ 02882000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0771 02883000
         C     @12,TOMLNNO(,TOMWAPTR)                              0771 02884000
         BNL   @RT00771                                            0771 02885000
         TM    TOMCURST(TOMWAPTR),B'00010000'                      0771 02886000
         BO    @RT00771                                            0771 02887000
*ELSE                                                              0773 02888000
*  TOMLNCNT=TOMLNCNT+1;              /* OTHERWISE ADD 1 TO LINE CNT  */ 02889000
         LA    @12,1                                               0773 02890000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0773 02891000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0773 02892000
*END ENDDATA;                        /* END OF ENDDATA               */ 02893000
@EL00018 DS    0H                                                  0774 02894000
@EF00018 DS    0H                                                  0774 02895000
@ER00018 L     @14,@SA00018                                        0774 02896000
         BR    @14                                                 0774 02897000
         EJECT                                                          02898000
*                                                                  0775 02899000
*/********************************************************************/ 02900000
*/*                                                                  */ 02901000
*/* THIS PROCEDURE, CNTLHDRS, WILL BUILD THE OUTPUT HEADER FOR CON-  */ 02902000
*/* TROL OR ASIS MODE USER DATA.                                     */ 02903000
*/*                                                                  */ 02904000
*/********************************************************************/ 02905000
*                                                                  0775 02906000
*CNTLHDRS: PROCEDURE OPTIONS(SAVE(14));                            0775 02907000
*                                                                  0775 02908000
CNTLHDRS ST    @14,@SA00019                                        0775 02909000
*IF (TOMBUFSZ-TOMBFCNT) <                                  /*@ZA19888*/ 02910000
*   (MIN(OPBFSZ-TOMMVCNT,TOMLNSZ))+15 THEN                 /*@ZA19888*/ 02911000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0776 02912000
         SL    @12,TOMBFCNT(,TOMWAPTR)                             0776 02913000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0776 02914000
         SL    @15,TOMMVCNT(,TOMWAPTR)                             0776 02915000
         SLR   @14,@14                                             0776 02916000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0776 02917000
         CR    @15,@14                                             0776 02918000
         BNH   *+6                                                      02919000
         LR    @15,@14                                             0776 02920000
         AL    @15,@CF00113                                        0776 02921000
         CR    @12,@15                                             0776 02922000
         BNL   @RF00776                                            0776 02923000
*  TOMENDBF='1'B;                    /* NOT ENOUGH BUFFER SP @ZA19888*/ 02924000
         OI    TOMENDBF(TOMWAPTR),B'00100000'                      0777 02925000
*ELSE                                /* ENOUGH BUFFER SPACE  @ZA19888*/ 02926000
*  DO;                                                     /*@ZA19888*/ 02927000
         B     @RC00776                                            0778 02928000
@RF00776 DS    0H                                                  0779 02929000
*    IF TOMBFCNT=0 THEN              /* IS RU OUTPUT RU EMPTY?       */ 02930000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0779 02931000
         LTR   @12,@12                                             0779 02932000
         BNZ   @RF00779                                            0779 02933000
*      /**************************************************************/ 02934000
*      /*                                                            */ 02935000
*      /* BUILD CONTROL HEADER (CMD,WCC,SBA ORDER) ONLY IF RU IS     */ 02936000
*      /* EMPTY.                                                     */ 02937000
*      /*                                                            */ 02938000
*      /**************************************************************/ 02939000
*      DO;                                                         0780 02940000
*        IF OPBFSZ>2 &               /* IS TPUT LARGER THAN 2 BYTES? */ 02941000
*           QBUF(1)=ESC THEN         /* IS FIRST BYTE ESCAPE CHAR?   */ 02942000
         LA    @15,2                                               0781 02943000
         CH    @15,OPBFSZ(,TOMWAPTR)                               0781 02944000
         BNL   @RF00781                                            0781 02945000
         L     @14,TOMQBPTR(,TOMWAPTR)                             0781 02946000
         CLI   QBUF(@14),X'27'                                     0781 02947000
         BNE   @RF00781                                            0781 02948000
*          /**********************************************************/ 02949000
*          /*                                                        */ 02950000
*          /* ESC PRESENT, TAKE USER'S COMMAND.                      */ 02951000
*          /*                                                        */ 02952000
*          /**********************************************************/ 02953000
*          DO;                                                     0782 02954000
*            TOMBFCNT=TOMBFCNT+1;    /* UPDATE COUNT OF DATA IN RU   */ 02955000
         AL    @12,@CF00064                                        0783 02956000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0783 02957000
*            TOMMVCNT=2;             /* INCLUDE ESC IN MOVE COUNT    */ 02958000
         ST    @15,TOMMVCNT(,TOMWAPTR)                             0784 02959000
*            IKTOBUF(1:2)=QBUF(2:3); /* PUT USER'S CMD IN RU @ZM20636*/ 02960000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0785 02961000
         MVC   IKTOBUF(2,@01),QBUF+1(@14)                          0785 02962000
*            TOMBFPTR=TOMGETMN+TOMBFCNT; /* UPDATE RU BUFFER PTR     */ 02963000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0786 02964000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0786 02965000
*            TOMQBPTR=OPBUFADR+TOMMVCNT; /* UPDATE PTR TO NEXT BYTE  */ 02966000
         L     @12,OPBUFADR(,TOMWAPTR)                             0787 02967000
         ALR   @12,@15                                             0787 02968000
         ST    @12,TOMQBPTR(,TOMWAPTR)                             0787 02969000
*            TOMQDATA=TOMMVCNT;      /* SAVE CNT OF USER DATA MOVED  */ 02970000
         ST    @15,TOMQDATA(,TOMWAPTR)                             0788 02971000
*          END;                                                    0789 02972000
*        ELSE                        /* FIRST DATA BYTE NOT ESCAPE   */ 02973000
*          /**********************************************************/ 02974000
*          /*                                                        */ 02975000
*          /* ESCAPE CHAR IS NOT PRESENT SO PUT IN DEFAULT WRITE     */ 02976000
*          /* COMMAND.                                               */ 02977000
*          /*                                                        */ 02978000
*          /**********************************************************/ 02979000
*          DO;                       /* YES, PUT CMD IN RU           */ 02980000
         B     @RC00781                                            0790 02981000
@RF00781 DS    0H                                                  0791 02982000
*            CALL SCRFORMT;          /* PUT DEFAULT CMD IN RU        */ 02983000
         BAL   @14,SCRFORMT                                        0791 02984000
*            TOMBFCNT=TOMBFCNT-1;    /* DON'T COUNT DEFAULT WCC YET! */ 02985000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0792 02986000
         BCTR  @12,0                                               0792 02987000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0792 02988000
*            TOMBFPTR=TOMBFPTR-1;    /* DON'T INCLUDE DEFAULT WCC YET*/ 02989000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0793 02990000
         BCTR  @12,0                                               0793 02991000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0793 02992000
*          END;                                                    0794 02993000
*        IF OPBFSZ>4 &               /* IS TPUT LARGER THAN 4 BYTES? */ 02994000
*           QBUF(2)=SBA THEN         /* USER HEADER CONTAIN SBA?     */ 02995000
@RC00781 LA    @12,4                                               0795 02996000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0795 02997000
         BNL   @RF00795                                            0795 02998000
         L     @15,TOMQBPTR(,TOMWAPTR)                             0795 02999000
         CLI   QBUF+1(@15),X'11'                                   0795 03000000
         BNE   @RF00795                                            0795 03001000
*          /**********************************************************/ 03002000
*          /*                                                        */ 03003000
*          /* MOVE USER WRITE CONTROL CHAR AND SBA ORDER INTO        */ 03004000
*          /* OUTPUT RU.                                             */ 03005000
*          /*                                                        */ 03006000
*          /**********************************************************/ 03007000
*          DO;                                                     0796 03008000
*            TOMBFCNT=TOMBFCNT+4;    /* UPDATE RU DATA COUNT         */ 03009000
         L     @14,TOMBFCNT(,TOMWAPTR)                             0797 03010000
         ALR   @14,@12                                             0797 03011000
         ST    @14,TOMBFCNT(,TOMWAPTR)                             0797 03012000
*            TOMMVCNT=TOMMVCNT+4;    /* UPDATE COUNT OF DATA MOVED   */ 03013000
         AL    @12,TOMMVCNT(,TOMWAPTR)                             0798 03014000
         ST    @12,TOMMVCNT(,TOMWAPTR)                             0798 03015000
*            IKTOBUF(1:4)=QBUF(1:4); /* PUT USER'S WCC IN RU @ZA19886*/ 03016000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0799 03017000
         MVC   IKTOBUF(4,@01),QBUF(@15)                            0799 03018000
*            TOMBFPTR=TOMGETMN+TOMBFCNT; /* UPDATE RU BUFFER PTR     */ 03019000
         AL    @14,TOMGETMN(,TOMWAPTR)                             0800 03020000
         ST    @14,TOMBFPTR(,TOMWAPTR)                             0800 03021000
*            TOMQBPTR=OPBUFADR+TOMMVCNT; /* UPDATE PTR TO NEXT DATA  */ 03022000
         L     @15,OPBUFADR(,TOMWAPTR)                             0801 03023000
         ALR   @15,@12                                             0801 03024000
         ST    @15,TOMQBPTR(,TOMWAPTR)                             0801 03025000
*            TOMQDATA=TOMMVCNT;      /* SAVE CNT OF MOVED USER DATA  */ 03026000
         ST    @12,TOMQDATA(,TOMWAPTR)                             0802 03027000
*            TOMTRSBA='1'B;          /* NO SBA TRACKING              */ 03028000
         OI    TOMTRSBA(TOMWAPTR),B'00000001'                      0803 03029000
*          END;                                                    0804 03030000
*        ELSE                        /* USER SBA ORDER NOT IN HEADER */ 03031000
*          /**********************************************************/ 03032000
*          /*                                                        */ 03033000
*          /* USER SBA NOT IN HEADER SO USER DEFAULT WCC AND LINE    */ 03034000
*          /* ADDRESS                                                */ 03035000
*          /*                                                        */ 03036000
*          /**********************************************************/ 03037000
*          DO;                                                     0805 03038000
         B     @RC00795                                            0805 03039000
@RF00795 DS    0H                                                  0806 03040000
*            TOMBFCNT=TOMBFCNT+1;    /* COUNT DEFAULT WCC NOW        */ 03041000
         LA    @12,1                                               0806 03042000
         L     @15,TOMBFCNT(,TOMWAPTR)                             0806 03043000
         ALR   @15,@12                                             0806 03044000
         ST    @15,TOMBFCNT(,TOMWAPTR)                             0806 03045000
*            TOMBFPTR=TOMBFPTR+1;    /* INCLUDE DEFAULT WCC NOW      */ 03046000
         AL    @12,TOMBFPTR(,TOMWAPTR)                             0807 03047000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0807 03048000
*            CALL NEWLINE;           /* PUT LINE ADDRESS IN RU       */ 03049000
         BAL   @14,NEWLINE                                         0808 03050000
*          END;                                                    0809 03051000
*      END;                          /* NO DATA AT PROC ENTRY        */ 03052000
*    ELSE                            /* DATA ALREADY IN RU           */ 03053000
*      CALL NEWLINE;                 /* PUT LINE ADDRESS IN RU       */ 03054000
         B     @RC00779                                            0811 03055000
@RF00779 BAL   @14,NEWLINE                                         0811 03056000
*    IF OPBFSZ-TOMMVCNT>1 &          /* MORE THAN 1 USER BYTES LEFT? */ 03057000
*       QBUF(1)=SF THEN              /* IS CURRENT BYTE START FIELD? */ 03058000
@RC00779 L     @12,TOMMVCNT(,TOMWAPTR)                             0812 03059000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0812 03060000
         SLR   @15,@12                                             0812 03061000
         C     @15,@CF00064                                        0812 03062000
         BNH   @RF00812                                            0812 03063000
         L     @15,TOMQBPTR(,TOMWAPTR)                             0812 03064000
         CLI   QBUF(@15),X'1D'                                     0812 03065000
         BNE   @RF00812                                            0812 03066000
*      /**************************************************************/ 03067000
*      /*                                                            */ 03068000
*      /* IF START FIELD IS PRESENT, TAKE USER'S ATTRIBUTE CHARACTER.*/ 03069000
*      /*                                                            */ 03070000
*      /**************************************************************/ 03071000
*      DO;                                                         0813 03072000
*        TOMBFCNT=TOMBFCNT+2;        /* UPDATE RU DATA CNT FOR MOVE  */ 03073000
         LA    @14,2                                               0814 03074000
         L     @11,TOMBFCNT(,TOMWAPTR)                             0814 03075000
         ALR   @11,@14                                             0814 03076000
         ST    @11,TOMBFCNT(,TOMWAPTR)                             0814 03077000
*        TOMMVCNT=TOMMVCNT+2;        /* UPDATE COUNT OF DATA MOVED   */ 03078000
         ALR   @12,@14                                             0815 03079000
         ST    @12,TOMMVCNT(,TOMWAPTR)                             0815 03080000
*        IKTOBUF(1:2)=QBUF;          /* MOVE USER'S ATTRIBUTE CHAR   */ 03081000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0816 03082000
         MVC   IKTOBUF(2,@01),QBUF(@15)                            0816 03083000
*        TOMQDATA=TOMMVCNT;          /* SAVE COUNT OF DATA MOVED     */ 03084000
         ST    @12,TOMQDATA(,TOMWAPTR)                             0817 03085000
*        TOMQBPTR=OPBUFADR+TOMMVCNT; /* UPDATE POINTER TO USER DATA  */ 03086000
         AL    @12,OPBUFADR(,TOMWAPTR)                             0818 03087000
         ST    @12,TOMQBPTR(,TOMWAPTR)                             0818 03088000
*      END;                                                        0819 03089000
*    ELSE                                                          0820 03090000
*      IF OPEDIT='01'B THEN          /* TPUT ASIS?           @ZA19886*/ 03091000
         B     @RC00812                                            0820 03092000
@RF00812 TM    OPEDIT(TOMWAPTR),B'00010000'                        0820 03093000
         BNO   @RF00820                                            0820 03094000
         TM    OPEDIT(TOMWAPTR),B'00100000'                        0820 03095000
         BNZ   @RF00820                                            0820 03096000
*        IF OPBFSZ-TOMMVCNT=1 THEN   /* ONE BYTE LEFT?       @ZA19886*/ 03097000
         LH    @12,OPBFSZ(,TOMWAPTR)                               0821 03098000
         SL    @12,TOMMVCNT(,TOMWAPTR)                             0821 03099000
         C     @12,@CF00064                                        0821 03100000
         BNE   @RF00821                                            0821 03101000
*          IF QBUF(1)=BYP|QBUF(1)=IC THEN; /* IC OR BYP?     @ZA19886*/ 03102000
         L     @12,TOMQBPTR(,TOMWAPTR)                             0822 03103000
         CLI   QBUF(@12),X'24'                                     0822 03104000
         BE    @RT00822                                            0822 03105000
         CLI   QBUF(@12),X'13'                                     0822 03106000
         BE    @RT00822                                            0822 03107000
*          ELSE                                            /*@ZA19886*/ 03108000
*            DO;                                                   0824 03109000
*              TOMBFCNT=TOMBFCNT+2;  /* CNT FOR MOVE OF WRITE ATTRIB */ 03110000
         LA    @12,2                                               0825 03111000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0825 03112000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0825 03113000
*              IKTOBUF(1:2)=SFWRTATT; /* PUT IN DEFAULT WRITE ATTRIB */ 03114000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0826 03115000
         MVC   IKTOBUF(2,@12),@CB01964                             0826 03116000
*            END;                                                  0827 03117000
*        ELSE                        /* MORE THAN 1 BYTE LEFT@ZA19886*/ 03118000
*          IF OPBFSZ-TOMMVCNT=2 &    /*                      @ZA19886*/ 03119000
*            (QBUF(1:2)=BYPNL | QBUF(1:2)=BYPCR) THEN;     /*@ZA19886*/ 03120000
         B     @RC00821                                            0828 03121000
@RF00821 LH    @12,OPBFSZ(,TOMWAPTR)                               0828 03122000
         SL    @12,TOMMVCNT(,TOMWAPTR)                             0828 03123000
         C     @12,@CF00076                                        0828 03124000
         BNE   @RF00828                                            0828 03125000
         L     @12,TOMQBPTR(,TOMWAPTR)                             0828 03126000
         CLC   QBUF(2,@12),@CB01928                                0828 03127000
         BE    @RT00828                                            0828 03128000
         CLC   QBUF(2,@12),@CB01926                                0828 03129000
         BE    @RT00828                                            0828 03130000
*          ELSE                      /*                      @ZA19886*/ 03131000
*            DO;                     /*                      @ZA19886*/ 03132000
@RF00828 DS    0H                                                  0831 03133000
*              TOMBFCNT=TOMBFCNT+2;  /* ADD 2 TO BUFFER CNT  @ZA19886*/ 03134000
         LA    @12,2                                               0831 03135000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0831 03136000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0831 03137000
*              IKTOBUF(1:2)=SFWRTATT; /* PUT IN ATTRIBUTE    @ZA19886*/ 03138000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0832 03139000
         MVC   IKTOBUF(2,@12),@CB01964                             0832 03140000
*            END;                    /*                      @ZA19886*/ 03141000
*      ELSE;                         /* CONTROL TPUT         @ZA19886*/ 03142000
@RF00820 DS    0H                                                  0835 03143000
*    TOMBFPTR=TOMGETMN+TOMBFCNT;     /* UPDATE PTR TO NEXT RU BYTE   */ 03144000
@RC00820 DS    0H                                                  0835 03145000
@RC00812 L     @12,TOMGETMN(,TOMWAPTR)                             0835 03146000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0835 03147000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0835 03148000
*  END;                              /*                      @ZA19888*/ 03149000
*END CNTLHDRS;                       /* END OF CNTLHDRS              */ 03150000
@EL00019 DS    0H                                                  0837 03151000
@EF00019 DS    0H                                                  0837 03152000
@ER00019 L     @14,@SA00019                                        0837 03153000
         BR    @14                                                 0837 03154000
         EJECT                                                          03155000
*/********************************************************************/ 03156000
*/*                                                                  */ 03157000
*/* THIS PROCEDURE, EDIT, DOES THE EDITING FOR EDIT MODE DATA. IN-   */ 03158000
*/* VALID CHARACTERS ARE REPLACED WITH COLONS. BYPASS ('24'X) IS     */ 03159000
*/* VALID ONLY AS LAST OR (CONDITIONALLY) NEXT TO LAST CHARACTER.    */ 03160000
*/*                                                                  */ 03161000
*/********************************************************************/ 03162000
*                                                                  0838 03163000
*EDIT: PROCEDURE OPTIONS(SAVE(14));                                0838 03164000
*                                                                  0838 03165000
EDIT     ST    @14,@SA00020                                        0838 03166000
*IF (TOMBUFSZ-TOMBFCNT) <                                  /*@ZA19888*/ 03167000
*  (MIN(OPBFSZ-TOMMVCNT,TOMLNSZ))+15 THEN                  /*@ZA19888*/ 03168000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0839 03169000
         SL    @12,TOMBFCNT(,TOMWAPTR)                             0839 03170000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0839 03171000
         SL    @15,TOMMVCNT(,TOMWAPTR)                             0839 03172000
         SLR   @14,@14                                             0839 03173000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0839 03174000
         CR    @15,@14                                             0839 03175000
         BNH   *+6                                                      03176000
         LR    @15,@14                                             0839 03177000
         AL    @15,@CF00113                                        0839 03178000
         CR    @12,@15                                             0839 03179000
         BNL   @RF00839                                            0839 03180000
*  TOMENDBF='1'B;                    /* NOT ENOUGH BUFFER SP @ZA19888*/ 03181000
         OI    TOMENDBF(TOMWAPTR),B'00100000'                      0840 03182000
*ELSE                                /* ENOUGH BUFFER SPACE  @ZA19888*/ 03183000
*DO;                                 /*                      @ZA19888*/ 03184000
         B     @RC00839                                            0841 03185000
@RF00839 DS    0H                                                  0842 03186000
*IF TOMBFCNT=0 THEN                  /* IS OUTPUT RU EMPTY?          */ 03187000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0842 03188000
         LTR   @12,@12                                             0842 03189000
         BNZ   @RF00842                                            0842 03190000
*  CALL SCRFORMT;                    /* PUT IN CMD,WCC, & FORMAT     */ 03191000
         BAL   @14,SCRFORMT                                        0843 03192000
*ELSE;                                                             0844 03193000
@RF00842 DS    0H                                                  0845 03194000
*/********************************************************************/ 03195000
*/*                                                                  */ 03196000
*/* BUILD LINES OF DATA UNTIL DATA,SCREEN, OR RU BUFFER RUNS OUT     */ 03197000
*/*                                                                  */ 03198000
*/********************************************************************/ 03199000
*DO WHILE ((TOMMVCNT<OPBFSZ)&(TOMENDSC='0'B)&(TOMENDBF='0'B));     0845 03200000
         B     @DE00845                                            0845 03201000
@DL00845 DS    0H                                                  0846 03202000
*  IF TOMLNCNT>=TOMLNNO THEN         /* IS THIS THE LAST SCREEN LINE */ 03203000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0846 03204000
         C     @12,TOMLNNO(,TOMWAPTR)                              0846 03205000
         BL    @RF00846                                            0846 03206000
*    DO;                             /*                      @ZA17886*/ 03207000
*      TOMCOLMN=MAX(0,MIN(TOMCOLMN,TOMLNSZ-7));            /*@ZA19887*/ 03208000
         SLR   @12,@12                                             0848 03209000
         IC    @12,TOMLNSZ(,TOMWAPTR)                              0848 03210000
         SL    @12,@CF00034                                        0848 03211000
         L     @15,TOMCOLMN(,TOMWAPTR)                             0848 03212000
         CR    @15,@12                                             0848 03213000
         BNH   *+6                                                      03214000
         LR    @15,@12                                             0848 03215000
         SLR   @12,@12                                             0848 03216000
         CR    @15,@12                                             0848 03217000
         BNL   *+6                                                      03218000
         LR    @15,@12                                             0848 03219000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0848 03220000
*      CALL NEWLINE;                 /* PUT LINE ADDRESS IN RU       */ 03221000
         BAL   @14,NEWLINE                                         0849 03222000
*      CALL SCRNPAGE;                /* YES, PUT PROMPT MSG IN RU    */ 03223000
         BAL   @14,SCRNPAGE                                        0850 03224000
*    END;                            /*                              */ 03225000
*  ELSE                              /* SCREEN PAGING NOT NEEDED     */ 03226000
*    DO;                                                           0852 03227000
         B     @RC00846                                            0852 03228000
@RF00846 DS    0H                                                  0853 03229000
*      TOMEDSAV='00'B;               /* EDIT TPUT            @ZA17886*/ 03230000
         NI    TOMEDSAV(TOMWAPTR),B'00111111'                      0853 03231000
*      CALL NEWLINE;                 /* PUT LINE ADDR IN RU  @ZA17886*/ 03232000
         BAL   @14,NEWLINE                                         0854 03233000
*      IF TOMQDATA=0 &               /* FIRST PASS THRU LOOP?@ZA17040*/ 03234000
*         TOMCOLMN=TOMLNSZ-1 THEN    /*                      @ZA17040*/ 03235000
         L     @12,TOMQDATA(,TOMWAPTR)                             0855 03236000
         LTR   @12,@12                                             0855 03237000
         BNZ   @RF00855                                            0855 03238000
         SLR   @12,@12                                             0855 03239000
         IC    @12,TOMLNSZ(,TOMWAPTR)                              0855 03240000
         LR    @15,@12                                             0855 03241000
         BCTR  @15,0                                               0855 03242000
         C     @15,TOMCOLMN(,TOMWAPTR)                             0855 03243000
         BNE   @RF00855                                            0855 03244000
*        /************************************************************/ 03245000
*        /*                                                          */ 03246000
*        /* ON FIRST PASS FOR EACH TPUT, PUT ATTRIB IN FRONT OF DATA */ 03247000
*        /*                                                          */ 03248000
*        /************************************************************/ 03249000
*        DO;                                                       0856 03250000
*          TOMBFCNT=TOMBFCNT+2;      /* SET COUNT FOR ATTRIBUTE      */ 03251000
         LA    @15,2                                               0857 03252000
         AL    @15,TOMBFCNT(,TOMWAPTR)                             0857 03253000
         ST    @15,TOMBFCNT(,TOMWAPTR)                             0857 03254000
*          IKTOBUF(1:2)=SFWRTATT;    /* PUT IN ATTRIBUTE SEQUENCE    */ 03255000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0858 03256000
         MVC   IKTOBUF(2,@01),@CB01964                             0858 03257000
*          TOMBFPTR=TOMGETMN+TOMBFCNT;/* UPDATE RU BUFFER POINTER    */ 03258000
         L     @14,TOMGETMN(,TOMWAPTR)                             0859 03259000
         ALR   @14,@15                                             0859 03260000
         ST    @14,TOMBFPTR(,TOMWAPTR)                             0859 03261000
*          TOMLNCNT=TOMLNCNT+1;      /* INCREMENT LINE COUNT         */ 03262000
         LA    @14,1                                               0860 03263000
         AL    @14,TOMLNCNT(,TOMWAPTR)                             0860 03264000
         ST    @14,TOMLNCNT(,TOMWAPTR)                             0860 03265000
*          IF (TOMBUFSZ-TOMBFCNT)<                                 0861 03266000
*             EVAL(MIN((OPBFSZ-TOMMVCNT),TOMLNSZ)+15) THEN /*@ZA17040*/ 03267000
         LCR   @15,@15                                             0861 03268000
         AL    @15,TOMBUFSZ(,TOMWAPTR)                             0861 03269000
         LH    @14,OPBFSZ(,TOMWAPTR)                               0861 03270000
         SL    @14,TOMMVCNT(,TOMWAPTR)                             0861 03271000
         CR    @14,@12                                             0861 03272000
         BNH   *+6                                                      03273000
         LR    @14,@12                                             0861 03274000
         AL    @14,@CF00113                                        0861 03275000
         CR    @15,@14                                             0861 03276000
         BNL   @RF00861                                            0861 03277000
*            TOMENDBF='1'B;          /* END OF RU BUFFER REACHED     */ 03278000
         OI    TOMENDBF(TOMWAPTR),B'00100000'                      0862 03279000
*          ELSE;                                                   0863 03280000
@RF00861 DS    0H                                                  0864 03281000
*          TOMCOLMN=0;               /* RESET COLUMN COUNT   @ZA17040*/ 03282000
         SLR   @12,@12                                             0864 03283000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0864 03284000
*        END;                                                      0865 03285000
*      ELSE                                                        0866 03286000
*        DO;                         /*                      @ZA17040*/ 03287000
         B     @RC00855                                            0866 03288000
@RF00855 DS    0H                                                  0867 03289000
*          IF TOMQDATA=0 THEN        /* NO USER DATA MOVED?  @ZA17040*/ 03290000
         L     @12,TOMQDATA(,TOMWAPTR)                             0867 03291000
         LTR   @12,@12                                             0867 03292000
         BNZ   @RF00867                                            0867 03293000
*            DO;                     /*                      @ZA17040*/ 03294000
*              TOMBFCNT=TOMBFCNT+2;  /* SET COUNT FOR ATTR           */ 03295000
         LA    @12,2                                               0869 03296000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0869 03297000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0869 03298000
*              IKTOBUF(1:2)=SFWRTATT;/* PUT IN ATTR SEQ      @ZA17040*/ 03299000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0870 03300000
         MVC   IKTOBUF(2,@01),@CB01964                             0870 03301000
*              TOMBFPTR=TOMGETMN+TOMBFCNT;                 /*@ZA17040*/ 03302000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0871 03303000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0871 03304000
*              TOMCOLMN=TOMCOLMN+1;  /* INCREMENT COLUMN CNT @ZA17040*/ 03305000
         LA    @12,1                                               0872 03306000
         L     @15,TOMCOLMN(,TOMWAPTR)                             0872 03307000
         ALR   @15,@12                                             0872 03308000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0872 03309000
*              J=MIN(OPBFSZ,(TOMLNSZ-TOMCOLMN));           /*@ZA17886*/ 03310000
         LCR   @15,@15                                             0873 03311000
         SLR   @14,@14                                             0873 03312000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0873 03313000
         ALR   @15,@14                                             0873 03314000
         LH    @14,OPBFSZ(,TOMWAPTR)                               0873 03315000
         CR    @14,@15                                             0873 03316000
         BNH   *+6                                                      03317000
         LR    @14,@15                                             0873 03318000
         ST    @14,J(,TOMWAPTR)                                    0873 03319000
*              TOMMVCNT=MAX(J,1);    /* MOVE OF AT LEAST ONE BYTE    */ 03320000
         CR    @14,@12                                             0874 03321000
         BNL   *+6                                                      03322000
         LR    @14,@12                                             0874 03323000
         ST    @14,TOMMVCNT(,TOMWAPTR)                             0874 03324000
*            END;                    /*                      @ZA17040*/ 03325000
*          ELSE                      /* MOVE LINESIZE OR LESS@ZA17040*/ 03326000
*            TOMMVCNT=MIN(OPBFSZ,(TOMQDATA+TOMLNSZ));/*LINESZ OR LESS*/ 03327000
         B     @RC00867                                            0876 03328000
@RF00867 SLR   @12,@12                                             0876 03329000
         IC    @12,TOMLNSZ(,TOMWAPTR)                              0876 03330000
         AL    @12,TOMQDATA(,TOMWAPTR)                             0876 03331000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0876 03332000
         CR    @15,@12                                             0876 03333000
         BNH   *+6                                                      03334000
         LR    @15,@12                                             0876 03335000
         ST    @15,TOMMVCNT(,TOMWAPTR)                             0876 03336000
*      TOMWRKSZ=TOMMVCNT-TOMQDATA;   /* COUNT FOR MOVE TO WORK AREA  */ 03337000
@RC00867 L     @12,TOMMVCNT(,TOMWAPTR)                             0877 03338000
         LR    @15,@12                                             0877 03339000
         SL    @15,TOMQDATA(,TOMWAPTR)                             0877 03340000
         STC   @15,TOMWRKSZ(,TOMWAPTR)                             0877 03341000
*      TOMCOLMN=TOMCOLMN+TOMWRKSZ;   /* ADD TO COLUMN COUNT  @ZA17886*/ 03342000
         L     @14,TOMCOLMN(,TOMWAPTR)                             0878 03343000
         ALR   @14,@15                                             0878 03344000
         ST    @14,TOMCOLMN(,TOMWAPTR)                             0878 03345000
*      TOMWRKBF(1:TOMWRKSZ)=QBUF;    /* MOVE USER DATA TO WORK AREA  */ 03346000
         LR    @14,@15                                             0879 03347000
         BCTR  @14,0                                               0879 03348000
         L     @01,TOMQBPTR(,TOMWAPTR)                             0879 03349000
         EX    @14,@SM02416                                        0879 03350000
*      TR(TOMWRKBF(1:TOMWRKSZ),EDITTAB);/* REPLACE INVALID CHARACTER */ 03351000
         SLR   @11,@11                                             0880 03352000
         IC    @11,TOMWRKSZ(,TOMWAPTR)                             0880 03353000
         BCTR  @11,0                                               0880 03354000
         EX    @11,@SB02429                                        0880 03355000
*      TOMBFCNT=TOMBFCNT+TOMWRKSZ;   /* COUNT OF DATA IN OUTPUT RU   */ 03356000
         AL    @15,TOMBFCNT(,TOMWAPTR)                             0881 03357000
         ST    @15,TOMBFCNT(,TOMWAPTR)                             0881 03358000
*      IKTOBUF(1:TOMWRKSZ)=TOMWRKBF; /* MOVE DATA TO OUTPUT RU       */ 03359000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0882 03360000
         EX    @14,@SM02427                                        0882 03361000
*      TOMQDATA=TOMMVCNT;            /* SAVE COUNT OF DATA MOVED     */ 03362000
         ST    @12,TOMQDATA(,TOMWAPTR)                             0883 03363000
*      TOMBFPTR=TOMGETMN+TOMBFCNT;   /* UPDATE RU BUFFER POINTER     */ 03364000
         AL    @15,TOMGETMN(,TOMWAPTR)                             0884 03365000
         ST    @15,TOMBFPTR(,TOMWAPTR)                             0884 03366000
*      TOMQBPTR=OPBUFADR+TOMMVCNT;   /* PTR TO BYTE OF UNUSED DATA   */ 03367000
         L     @15,OPBUFADR(,TOMWAPTR)                             0885 03368000
         ALR   @15,@12                                             0885 03369000
         ST    @15,TOMQBPTR(,TOMWAPTR)                             0885 03370000
*      IF TOMMVCNT=OPBFSZ THEN       /* ALL USER DATA BEEN MOVED?    */ 03371000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0886 03372000
         BNE   @RF00886                                            0886 03373000
*        /************************************************************/ 03374000
*        /*                                                          */ 03375000
*        /* THIS DO GROUP PROCESSES BYPASS('24'X) WHEN FOUND IN NEXT */ 03376000
*        /* LAST OR LAST DATA BYTE. A DEFAULT ATTRIBUTE IS PLACED IN */ 03377000
*        /* RU WHEN A VALID BYPASS IS NOT FOUND                      */ 03378000
*        /*                                                          */ 03379000
*        /************************************************************/ 03380000
*        CALL ENDDATA;                                             0887 03381000
         BAL   @14,ENDDATA                                         0887 03382000
*      ELSE                          /* MORE USER DATA TO BE PROCESS */ 03383000
*        /************************************************************/ 03384000
*        /*                                                          */ 03385000
*        /* MORE USER DATA LEFT SO DO NEW-LINE PROCESSING & CONTINUE */ 03386000
*        /*                                                          */ 03387000
*        /************************************************************/ 03388000
*        DO;                                                       0888 03389000
         B     @RC00886                                            0888 03390000
@RF00886 DS    0H                                                  0889 03391000
*          TOMLNCNT=TOMLNCNT+1;      /* ADD ONE TO LINE COUNT        */ 03392000
         LA    @12,1                                               0889 03393000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0889 03394000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0889 03395000
*          TOMCOLMN=0;               /* RESET COLUMN COUNT   @ZA17886*/ 03396000
         SLR   @12,@12                                             0890 03397000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0890 03398000
*          IF (TOMBUFSZ-TOMBFCNT)<                                 0891 03399000
*             EVAL(MIN((OPBFSZ-TOMMVCNT),TOMLNSZ)+15) THEN         0891 03400000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0891 03401000
         SL    @12,TOMBFCNT(,TOMWAPTR)                             0891 03402000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0891 03403000
         SL    @15,TOMMVCNT(,TOMWAPTR)                             0891 03404000
         SLR   @14,@14                                             0891 03405000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0891 03406000
         CR    @15,@14                                             0891 03407000
         BNH   *+6                                                      03408000
         LR    @15,@14                                             0891 03409000
         AL    @15,@CF00113                                        0891 03410000
         CR    @12,@15                                             0891 03411000
         BNL   @RF00891                                            0891 03412000
*            /********************************************************/ 03413000
*            /*                                                      */ 03414000
*            /* NOT ENOUGH RU BUFFER FOR LINESZ OF DATA AND PAGING   */ 03415000
*            /* PROMPT SO SEND CURRENT RU AND CONTINUE               */ 03416000
*            /*                                                      */ 03417000
*            /********************************************************/ 03418000
*            TOMENDBF='1'B;          /* END OF RU BUFFER REACHED     */ 03419000
         OI    TOMENDBF(TOMWAPTR),B'00100000'                      0892 03420000
*          ELSE;                                                   0893 03421000
@RF00891 DS    0H                                                  0894 03422000
*        END;                                                      0894 03423000
*      END;                          /*                      @ZA17040*/ 03424000
@RC00886 DS    0H                                                  0896 03425000
*    END;                                                          0896 03426000
@RC00855 DS    0H                                                  0897 03427000
*END;                                /* END FOR DO WHILE LOOP        */ 03428000
@RC00846 DS    0H                                                  0897 03429000
@DE00845 L     @12,TOMMVCNT(,TOMWAPTR)                             0897 03430000
         CH    @12,OPBFSZ(,TOMWAPTR)                               0897 03431000
         BNL   @DC00845                                            0897 03432000
         TM    TOMENDSC(TOMWAPTR),B'00101000'                      0897 03433000
         BZ    @DL00845                                            0897 03434000
@DC00845 DS    0H                                                  0898 03435000
*END;                                /*                      @ZA19888*/ 03436000
*END EDIT;                           /* END OF EDIT                  */ 03437000
@EL00020 DS    0H                                                  0899 03438000
@EF00020 DS    0H                                                  0899 03439000
@ER00020 L     @14,@SA00020                                        0899 03440000
         BR    @14                                                 0899 03441000
         EJECT                                                          03442000
*/********************************************************************/ 03443000
*/*                                                                  */ 03444000
*/* THE PROCEDURE, BLDPRMPT, WILL BUILD AUTOPROMPT DATA IN THE OUT-  */ 03445000
*/* PUT RU. FOR AUTO LINE NUMBERING, THIS ROUTINE WILL BUILD A VARI- */ 03446000
*/* BLE LENGTH LINE NUMBER OF 5 TO 8 DIGITS WITH LEADING ZEROS TRUN- */ 03447000
*/* CATED UP TO THE FIRST 3. AUTO CHARACTER PROMPTING WILL CONSIST   */ 03448000
*/* OF POSITIONING THE CURSOR. THE KEYBOARD WILL BE UNLOCKED ON      */ 03449000
*/* EITHER TYPE AUTO PROMPT.                                         */ 03450000
*/*                                                                  */ 03451000
*/********************************************************************/ 03452000
*                                                                  0900 03453000
*BLDPRMPT: PROCEDURE OPTIONS(SAVE(14));                            0900 03454000
*                                                                  0900 03455000
BLDPRMPT ST    @14,@SA00021                                        0900 03456000
*DCL UNPKNUM CHAR(8) BDY(DWORD);     /* STORAGE FOR CVD INSTRUCTION  */ 03457000
*DCL PRMPTNUM CHAR(8) BDY(DWORD);    /* STORAGE FOR LINE NO. PROMPT  */ 03458000
*                                                                  0902 03459000
*IF (TOMBUFSZ-TOMBFCNT) <                                  /*@ZA19888*/ 03460000
*   (MIN(OPBFSZ-TOMMVCNT,TOMLNSZ))+15 THEN                 /*@ZA19888*/ 03461000
         L     @12,TOMBUFSZ(,TOMWAPTR)                             0903 03462000
         SL    @12,TOMBFCNT(,TOMWAPTR)                             0903 03463000
         LH    @15,OPBFSZ(,TOMWAPTR)                               0903 03464000
         SL    @15,TOMMVCNT(,TOMWAPTR)                             0903 03465000
         SLR   @14,@14                                             0903 03466000
         IC    @14,TOMLNSZ(,TOMWAPTR)                              0903 03467000
         CR    @15,@14                                             0903 03468000
         BNH   *+6                                                      03469000
         LR    @15,@14                                             0903 03470000
         AL    @15,@CF00113                                        0903 03471000
         CR    @12,@15                                             0903 03472000
         BNL   @RF00903                                            0903 03473000
*  TOMENDBF='1'B;                    /* NOT ENOUGH BUFFER SP @ZA19888*/ 03474000
         OI    TOMENDBF(TOMWAPTR),B'00100000'                      0904 03475000
*ELSE                                /* ENOUGH BUFFER SPACE  @ZA19888*/ 03476000
*IF TOMLNCNT>=TOMLNNO THEN           /* TEST FOR LAST SCREEN LINE    */ 03477000
         B     @RC00903                                            0905 03478000
@RF00903 L     @12,TOMLNCNT(,TOMWAPTR)                             0905 03479000
         C     @12,TOMLNNO(,TOMWAPTR)                              0905 03480000
         BL    @RF00905                                            0905 03481000
*  DO;                                                             0906 03482000
*    IF TOMBFCNT=0 THEN              /* RU EMPTY?            @ZA19881*/ 03483000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0907 03484000
         LTR   @12,@12                                             0907 03485000
         BNZ   @RF00907                                            0907 03486000
*      CALL SCRFORMT;                /* FORMAT SCREEN        @ZA19881*/ 03487000
         BAL   @14,SCRFORMT                                        0908 03488000
*    ELSE;                           /* RU NOT EMPTY         @ZA19881*/ 03489000
@RF00907 DS    0H                                                  0910 03490000
*    TOMCOLMN=MAX(0,MIN(TOMCOLMN,TOMLNSZ-7));              /*@ZA19887*/ 03491000
         SLR   @12,@12                                             0910 03492000
         IC    @12,TOMLNSZ(,TOMWAPTR)                              0910 03493000
         SL    @12,@CF00034                                        0910 03494000
         L     @15,TOMCOLMN(,TOMWAPTR)                             0910 03495000
         CR    @15,@12                                             0910 03496000
         BNH   *+6                                                      03497000
         LR    @15,@12                                             0910 03498000
         SLR   @12,@12                                             0910 03499000
         CR    @15,@12                                             0910 03500000
         BNL   *+6                                                      03501000
         LR    @15,@12                                             0910 03502000
         ST    @15,TOMCOLMN(,TOMWAPTR)                             0910 03503000
*    CALL NEWLINE;                   /* PUT LINE ADDRESS IN RU       */ 03504000
         BAL   @14,NEWLINE                                         0911 03505000
*    CALL SCRNPAGE;                  /* PAGE SCREEN AT LAST LINE     */ 03506000
         BAL   @14,SCRNPAGE                                        0912 03507000
*  END;                                                            0913 03508000
*ELSE                                /* SCREEN PAGING NOT NEEDED     */ 03509000
*  DO;                                                             0914 03510000
         B     @RC00905                                            0914 03511000
@RF00905 DS    0H                                                  0915 03512000
*    IF TOMBFCNT=0 THEN              /* RU EMPTY?            @ZA19881*/ 03513000
         L     @12,TOMBFCNT(,TOMWAPTR)                             0915 03514000
         LTR   @12,@12                                             0915 03515000
         BNZ   @RF00915                                            0915 03516000
*      DO;                           /*                      @ZA19881*/ 03517000
*        TOMSCHED='1'B;              /* POST=SCHED           @ZA19881*/ 03518000
         OI    TOMSCHED(TOMWAPTR),B'00001000'                      0917 03519000
*        CALL SCRFORMT;              /* FORMAT SCREEN        @ZA19881*/ 03520000
         BAL   @14,SCRFORMT                                        0918 03521000
*      END;                          /*                      @ZA19881*/ 03522000
*    ELSE;                           /* RU NOT EMPTY         @ZA19881*/ 03523000
@RF00915 DS    0H                                                  0921 03524000
*    IF TSBAULST='1'B THEN           /* TEST FOR AUTO LINE PROMPTING */ 03525000
         L     @12,PSAAOLD                                         0921 03526000
         L     @12,ASCBTSB(,@12)                                   0921 03527000
         TM    TSBAULST(@12),B'00010000'                           0921 03528000
         BNO   @RF00921                                            0921 03529000
*      /**************************************************************/ 03530000
*      /*                                                            */ 03531000
*      /* THIS DO GROUP BUILDS A VARIABLE LENGTH LINE NUMBER         */ 03532000
*      /*                                                            */ 03533000
*      /**************************************************************/ 03534000
*      DO;                                                         0922 03535000
*        CALL NEWLINE;               /* PUT LINE ADDRESS IN RU       */ 03536000
         BAL   @14,NEWLINE                                         0923 03537000
*        CVD(TSBAUTOS,UNPKNUM);      /* CHANGE LINE # TO PACKED DEC. */ 03538000
         L     @12,PSAAOLD                                         0924 03539000
         L     @12,ASCBTSB(,@12)                                   0924 03540000
         L     @12,TSBAUTOS(,@12)                                  0924 03541000
         CVD   @12,UNPKNUM                                         0924 03542000
*        GEN SETS(UNPKNUM);                                        0925 03543000
            OI UNPKNUM+7,X'0F'                                          03544000
*        UNPK(PRMPTNUM,UNPKNUM);     /* CHANGE LINE # TO ZONED DEC.  */ 03545000
         UNPK  PRMPTNUM(8),UNPKNUM(8)                              0926 03546000
*        DO I=1 TO 3                                               0927 03547000
*          WHILE PRMPTNUM(I)='F0'X;  /* INDEX PASS LEADING ZEROES    */ 03548000
         LA    @12,1                                               0927 03549000
         ST    @12,I(,TOMWAPTR)                                    0927 03550000
@DL00927 L     @12,I(,TOMWAPTR)                                    0927 03551000
         LA    @01,PRMPTNUM-1(@12)                                 0927 03552000
         CLI   0(@01),X'F0'                                        0927 03553000
         BNE   @DC00927                                            0927 03554000
*        END;                                                      0928 03555000
         LA    @12,1                                               0928 03556000
         AL    @12,I(,TOMWAPTR)                                    0928 03557000
         ST    @12,I(,TOMWAPTR)                                    0928 03558000
         C     @12,@CF00291                                        0928 03559000
         BNH   @DL00927                                            0928 03560000
@DC00927 DS    0H                                                  0929 03561000
*        TOMBFCNT=TOMBFCNT+5+((8-I)+1);/* UPDATE BY LGTH LINE NO. + 5*/ 03562000
         LA    @12,5                                               0929 03563000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0929 03564000
         L     @15,I(,TOMWAPTR)                                    0929 03565000
         LA    @14,8                                               0929 03566000
         SLR   @14,@15                                             0929 03567000
         AL    @14,@CF00064                                        0929 03568000
         ALR   @12,@14                                             0929 03569000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0929 03570000
*        IKTOBUF(1:2)=SFWRTATT;      /* PUT START FLD & WRT ATTRIB   */ 03571000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0930 03572000
         MVC   IKTOBUF(2,@12),@CB01964                             0930 03573000
*        IKTOBUF(3:(11-I))=PRMPTNUM(I:8); /* PUT PROMPT NUMBER IN RU */ 03574000
         LA    @14,11                                              0931 03575000
         SLR   @14,@15                                             0931 03576000
         SL    @14,@CF00291                                        0931 03577000
         LA    @01,PRMPTNUM-1(@15)                                 0931 03578000
         EX    @14,@SM02431                                        0931 03579000
*        IKTOBUF((12-I):(14-I))=SFRDATIC; /* SF, WRT ATTRIB, & IC    */ 03580000
         LA    @14,12                                              0932 03581000
         SLR   @14,@15                                             0932 03582000
         ALR   @12,@14                                             0932 03583000
         BCTR  @12,0                                               0932 03584000
         LCR   @15,@15                                             0932 03585000
         AL    @15,@CF01015                                        0932 03586000
         SLR   @15,@14                                             0932 03587000
         EX    @15,@SM02433                                        0932 03588000
*      END;                                                        0933 03589000
*    ELSE;                             /* NO CHARACTER PROMPT@ZA19881*/ 03590000
@RF00921 DS    0H                                                  0935 03591000
*    TOMBFPTR=TOMGETMN+TOMBFCNT;     /* UPDATE RU BUFFER POINTER     */ 03592000
         L     @12,TOMGETMN(,TOMWAPTR)                             0935 03593000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0935 03594000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0935 03595000
*    TOMCURST='1'B;                  /* INDICATE CURSOR IS SET       */ 03596000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0936 03597000
*    TOMKBULK='1'B;                  /* KEYBOARD UNLOCK NEEDED       */ 03598000
         OI    TOMKBULK(TOMWAPTR),B'10000000'                      0937 03599000
*  END;                                                            0938 03600000
*END BLDPRMPT;                       /* END OF BLDPRMPT              */ 03601000
@EL00021 DS    0H                                                  0939 03602000
@EF00021 DS    0H                                                  0939 03603000
@ER00021 L     @14,@SA00021                                        0939 03604000
         BR    @14                                                 0939 03605000
         EJECT                                                          03606000
*/********************************************************************/ 03607000
*/*                                                                  */ 03608000
*/* THIS PROCEDURE, SCRNPAGE, WILL BE CALLED TO BUILD THE PAGING     */ 03609000
*/* PROMPT MESSAGE AND TO SET APPROPRIATE INDICATORS.                */ 03610000
*/*                                                                  */ 03611000
*/********************************************************************/ 03612000
*                                                                  0940 03613000
*SCRNPAGE: PROCEDURE OPTIONS(SAVE(14));                            0940 03614000
*                                                                  0940 03615000
SCRNPAGE ST    @14,12(,@13)                                        0940 03616000
*TOMBFCNT=TOMBFCNT+8;                /* SET COUNT FOR PAGING MESSAGE */ 03617000
         LA    @12,8                                               0941 03618000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0941 03619000
         ST    @12,TOMBFCNT(,TOMWAPTR)                             0941 03620000
*IKTOBUF(1:8)='1DC85C5C5C1D4013'X;   /* PUT PAGE PROMPT IN OUTPUT RU */ 03621000
         L     @01,TOMBFPTR(,TOMWAPTR)                             0942 03622000
         MVC   IKTOBUF(8,@01),@CB02350                             0942 03623000
*TOMBFPTR=TOMGETMN+TOMBFCNT;         /* UPDATE RU BUFFER POINTER     */ 03624000
         AL    @12,TOMGETMN(,TOMWAPTR)                             0943 03625000
         ST    @12,TOMBFPTR(,TOMWAPTR)                             0943 03626000
*TOMCURST='1'B;                      /* INDICATE CURSOR IS SET IN RU */ 03627000
         OI    TOMCURST(TOMWAPTR),B'00010000'                      0944 03628000
*TVWAPGN='1'B;                       /* PAGING RESPONSE OUTSTANDING  */ 03629000
         OI    TVWAPGN(TVWAPTR),B'01000000'                        0945 03630000
*TOMENDSC='1'B;                      /* END OF SCRN HAS BEEN REACHED */ 03631000
*TOMEXDTA='1'B;                      /* DATA BLD COMPLETE THIS ENTRY */ 03632000
*TOMEXBRU='1'B;                      /* RU BUILD COMPLETE THIS ENTRY */ 03633000
         OI    TOMENDSC(TOMWAPTR),B'00001110'                      0948 03634000
*TOMSTCUR='1'B;                      /* IC ON NEXT ENTRY IF NO DATA  */ 03635000
*TOMKBULK='1'B;                      /* SET KEYBOARD UNLOCK NEEDED   */ 03636000
         OI    TOMSTCUR(TOMWAPTR),B'10000100'                      0950 03637000
*END SCRNPAGE;                       /* END OF SCRNPAGE              */ 03638000
@EL00022 DS    0H                                                  0951 03639000
@EF00022 DS    0H                                                  0951 03640000
@ER00022 L     @14,12(,@13)                                        0951 03641000
         BR    @14                                                 0951 03642000
         EJECT                                                          03643000
*/********************************************************************/ 03644000
*/*                                                                  */ 03645000
*/* THIS PROCEDURE, BLDERR, WILL BE CALLED TO PUT ERROR MESSAGES IN  */ 03646000
*/* THE OUTPUT RU                                                    */ 03647000
*/*                                                                  */ 03648000
*/********************************************************************/ 03649000
*                                                                  0952 03650000
*BLDERR: PROCEDURE OPTIONS(SAVE(14));                              0952 03651000
*                                                                  0952 03652000
BLDERR   ST    @14,@SA00023                                        0952 03653000
*TOMCOLMN=0;                         /* RESET COLUMN COUNT   @ZA17886*/ 03654000
         SLR   @12,@12                                             0953 03655000
         ST    @12,TOMCOLMN(,TOMWAPTR)                             0953 03656000
*IF TOMBFCNT=0 THEN                  /* IS RU EMPTY?                 */ 03657000
         C     @12,TOMBFCNT(,TOMWAPTR)                             0954 03658000
         BNE   @RF00954                                            0954 03659000
*  CALL SCRFORMT;                    /* YES, PUT CMD,WCC, & FORMT    */ 03660000
         BAL   @14,SCRFORMT                                        0955 03661000
*ELSE;                                                             0956 03662000
@RF00954 DS    0H                                                  0957 03663000
*CALL NEWLINE;                       /* PUT LINE ADDRESS IN RU       */ 03664000
         BAL   @14,NEWLINE                                         0957 03665000
*IF TOMLNCNT>=TOMLNNO THEN           /* IS THIS THE LAST SCRN LINE?  */ 03666000
         L     @12,TOMLNCNT(,TOMWAPTR)                             0958 03667000
         C     @12,TOMLNNO(,TOMWAPTR)                              0958 03668000
         BL    @RF00958                                            0958 03669000
*  CALL SCRNPAGE;                    /* YES, PUT PAGE PROMPT IN RU   */ 03670000
         BAL   @14,SCRNPAGE                                        0959 03671000
*ELSE                                                              0960 03672000
*  DO;                               /* ENTRY FOR TIM'S ERROR MSG    */ 03673000
         B     @RC00958                                            0960 03674000
@RF00958 DS    0H                                                  0961 03675000
*    I=4;                            /* INDEX INTO MESSAGE TABLE     */ 03676000
         LA    @12,4                                               0961 03677000
         ST    @12,I(,TOMWAPTR)                                    0961 03678000
*    TOMBFCNT=TOMBFCNT+MSGSIZE+4;    /* UPDATE CNT FOR MESSAGE MOVE  */ 03679000
         LR    @15,@12                                             0962 03680000
         SLA   @15,2                                               0962 03681000
         L     @01,FLCCVT                                          0962 03682000
         L     @01,CVTTCASP(,@01)                                  0962 03683000
         L     @01,TCASMSGS(,@01)                                  0962 03684000
         AL    @01,@CF02389                                        0962 03685000
         L     @15,MSGADR(@15,@01)                                 0962 03686000
         LH    @14,MSGSIZE(,@15)                                   0962 03687000
         L     @11,TOMBFCNT(,TOMWAPTR)                             0962 03688000
         ALR   @11,@14                                             0962 03689000
         ALR   @11,@12                                             0962 03690000
         ST    @11,TOMBFCNT(,TOMWAPTR)                             0962 03691000
*    IKTOBUF(1:2)=SFWRTATT;          /* PUT WRITE ATTRIBUTE IN RU    */ 03692000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0963 03693000
         MVC   IKTOBUF(2,@12),@CB01964                             0963 03694000
*    IKTOBUF(3:MSGSIZE+2)=MSGDATA(1:MSGSIZE); /* PUT ERR MSG IN RU   */ 03695000
         LR    @10,@14                                             0964 03696000
         BCTR  @10,0                                               0964 03697000
         EX    @10,@SM02435                                        0964 03698000
*    IKTOBUF(MSGSIZE+3:MSGSIZE+4)=SFRDATT;    /* PUT RD ATTRIB IN RU */ 03699000
         ALR   @12,@14                                             0965 03700000
         MVC   IKTOBUF+2(2,@12),@CB01962                           0965 03701000
*    TOMBFPTR=TOMGETMN+TOMBFCNT;     /* UPDATE RU BUFFER POINTER     */ 03702000
         AL    @11,TOMGETMN(,TOMWAPTR)                             0966 03703000
         ST    @11,TOMBFPTR(,TOMWAPTR)                             0966 03704000
*    TVWAERMG='0'B;                  /* OFF, REQUEST FOR ERROR MSG   */ 03705000
         NI    TVWAERMG(TVWAPTR),B'11110111'                       0967 03706000
*    TVWAULK='1'B;                   /* REQUEST KEYBOARD UNLOCK      */ 03707000
         OI    TVWAULK(TVWAPTR),B'00000100'                        0968 03708000
*    TOMLNCNT=TOMLNCNT+1;            /* AID ONE TO LINE COUNT        */ 03709000
         LA    @12,1                                               0969 03710000
         AL    @12,TOMLNCNT(,TOMWAPTR)                             0969 03711000
         ST    @12,TOMLNCNT(,TOMWAPTR)                             0969 03712000
*  END;                                                            0970 03713000
*END BLDERR;                         /* END OF BLDERR                */ 03714000
@EL00023 DS    0H                                                  0971 03715000
@EF00023 DS    0H                                                  0971 03716000
@ER00023 L     @14,@SA00023                                        0971 03717000
         BR    @14                                                 0971 03718000
         EJECT                                                          03719000
*/********************************************************************/ 03720000
*/*                                                                  */ 03721000
*/* THIS PROCEDURE, TRANPROC, WILL PERFORM USER AND/OR ASCII TRANS-  */ 03722000
*/* LATION ON THE OUTBOUND RU.                                       */ 03723000
*/*                                                                  */ 03724000
*/********************************************************************/ 03725000
*                                                                  0972 03726000
*TRANPROC: PROCEDURE OPTIONS(SAVE(14));                            0972 03727000
*                                                                  0972 03728000
TRANPROC ST    @14,12(,@13)                                        0972 03729000
*DCL ASCITAB CHAR(256)               /* ADDRESSING FOR EBCDIC TO     */ 03730000
*    BASED(TVWAATBO);                /*   ASCII TRANSLATE TABLE      */ 03731000
*DCL USERTAB CHAR(256)               /* ADDRESSING TO USER DEFINED   */ 03732000
*    BASED(TVWATABO);                /*   TRANSLATE TABLE            */ 03733000
*DCL EOTR FIXED(31) DEF(TOMWRKVI);   /* ENDING INDEX FOR TRANSLATE   */ 03734000
*DCL BOTR FIXED(31) DEF(TOMWRKVJ);   /* BEGINNING INDEX FOR TRANSL'  */ 03735000
*DCL SCAN REG(1) PTR(31);            /* USE REG1 AS POINTER          */ 03736000
*                                                                  0977 03737000
*IF TVWATRAN='1'B THEN               /* USER TRANSLATION?    @ZA18919*/ 03738000
         TM    TVWATRAN(TVWAPTR),B'00000010'                       0978 03739000
         BNO   @RF00978                                            0978 03740000
*  DO;                               /* USER TRANSLATION     @ZA18919*/ 03741000
*    BOTR=0;                         /* BEGIN TRANLATE               */ 03742000
         SLR   @12,@12                                             0980 03743000
         ST    @12,BOTR(,TOMWAPTR)                                 0980 03744000
*    RFY (REG1,REG2,SCAN,REG3) RSTD; /* RESTRICT REGISTERS           */ 03745000
*    REG3=3;                         /* SKIP CMD/WCC-USER TR         */ 03746000
         LA    REG3,3                                              0982 03747000
*    DO WHILE BOTR<TOMBFCNT;         /* TRANSLATE UNTIL END OF RU    */ 03748000
         B     @DE00983                                            0983 03749000
@DL00983 DS    0H                                                  0984 03750000
*      REG1=0;                                                     0984 03751000
         SLR   REG1,REG1                                           0984 03752000
*      TOMBFPTR=TOMGETMN+BOTR;       /* POINT NEXT UNTRANSLATED BYTE */ 03753000
         L     @12,BOTR(,TOMWAPTR)                                 0985 03754000
         L     @00,TOMGETMN(,TOMWAPTR)                             0985 03755000
         ALR   @00,@12                                             0985 03756000
         ST    @00,TOMBFPTR(,TOMWAPTR)                             0985 03757000
*      EOTR=MIN((TOMBFCNT-BOTR),253); /* INDEX FOR TRANS' END        */ 03758000
         LCR   @12,@12                                             0986 03759000
         AL    @12,TOMBFCNT(,TOMWAPTR)                             0986 03760000
         LA    @00,253                                             0986 03761000
         CR    @12,@00                                             0986 03762000
         BNH   *+6                                                      03763000
         LR    @12,@00                                             0986 03764000
         ST    @12,EOTR(,TOMWAPTR)                                 0986 03765000
*      TRT(IKTOBUF(1:EOTR),SBATAB); /* SCAN FOR BUFFER CNTL ORDERS */   03766000
         L     @12,TOMBFPTR(,TOMWAPTR)                             0987 03767000
         L     @15,EOTR(,TOMWAPTR)                                 0987 03768000
         BCTR  @15,0                                               0987 03769000
         EX    @15,@SB02437                                        0987 03770000
*      BC(8,NONFLG);                 /* NO BUFFER ORDER-TRANSL' DATA */ 03771000
         BC    8,NONFLG                                            0988 03772000
*      EOTR=REG1-TOMBFPTR;           /* ORDER FOUND-TRANL' TO ORDER  */ 03773000
         LR    @12,REG1                                            0989 03774000
         SL    @12,TOMBFPTR(,TOMWAPTR)                             0989 03775000
         ST    @12,EOTR(,TOMWAPTR)                                 0989 03776000
*      RFY IKTOBUF BASED(SCAN);      /* BASE RU AT REG1              */ 03777000
*      IF IKTOBUF(1)=SBA|IKTOBUF(1)=EUA THEN /* SBA OR EUA?          */ 03778000
         CLI   IKTOBUF(SCAN),X'11'                                 0991 03779000
         BE    @RT00991                                            0991 03780000
         CLI   IKTOBUF(SCAN),X'12'                                 0991 03781000
         BNE   @RF00991                                            0991 03782000
@RT00991 DS    0H                                                  0992 03783000
*        REG1=3;                     /* CNT TO SKIP SBA/EUA          */ 03784000
         LA    REG1,3                                              0992 03785000
*      ELSE                          /* NEITHER SBA NOR EUA          */ 03786000
*        IF IKTOBUF(1)=RA THEN       /* REPEAT TO ADDRESS?           */ 03787000
         B     @RC00991                                            0993 03788000
@RF00991 CLI   IKTOBUF(SCAN),X'3C'                                 0993 03789000
         BNE   @RF00993                                            0993 03790000
*          REG1=4;                   /* SET CNT TO SKIP RA           */ 03791000
         LA    REG1,4                                              0994 03792000
*        ELSE                        /* NOT RA                       */ 03793000
*          IF IKTOBUF(1)=SF THEN /* START FIELD?                     */ 03794000
         B     @RC00993                                            0995 03795000
@RF00993 CLI   IKTOBUF(SCAN),X'1D'                                 0995 03796000
         BNE   @RF00995                                            0995 03797000
*            REG1=2;                 /* SET CNT TO SKIP SF           */ 03798000
         LA    REG1,2                                              0996 03799000
*          ELSE                      /* NOT SF               @ZA18919*/ 03800000
*            IF IKTOBUF(1)=IC |      /* INSERT CURSOR?       @ZA18919*/ 03801000
*               IKTOBUF(1)=PT THEN   /* PROGRAM TAB?         @ZA18919*/ 03802000
         B     @RC00995                                            0997 03803000
@RF00995 CLI   IKTOBUF(SCAN),X'13'                                 0997 03804000
         BE    @RT00997                                            0997 03805000
         CLI   IKTOBUF(SCAN),X'05'                                 0997 03806000
         BNE   @RF00997                                            0997 03807000
@RT00997 DS    0H                                                  0998 03808000
*              REG1=1;               /*                      @ZA18919*/ 03809000
         LA    REG1,1                                              0998 03810000
*            ELSE;                   /*                      @ZA18919*/ 03811000
@RF00997 DS    0H                                                  1000 03812000
*      RFY IKTOBUF BASED(TOMBFPTR);  /* RESTORE RU BASE PTR          */ 03813000
@RC00995 DS    0H                                                  1000 03814000
@RC00993 DS    0H                                                  1000 03815000
@RC00991 DS    0H                                                  1001 03816000
*      IF (REG3<=EOTR) &             /* LEFT <= RIGHT INDEX? @ZA18919*/ 03817000
*         (REG3=1|EOTR>=3) THEN      /* DON'T TRANS CMD OR WCC       */ 03818000
         L     @12,EOTR(,TOMWAPTR)                                 1001 03819000
         CR    REG3,@12                                            1001 03820000
         BH    @RF01001                                            1001 03821000
         C     REG3,@CF00064                                       1001 03822000
         BE    @RT01001                                            1001 03823000
         C     @12,@CF00291                                        1001 03824000
         BL    @RF01001                                            1001 03825000
@RT01001 DS    0H                                                  1002 03826000
*NONFLG: TR(IKTOBUF(REG3:EOTR),USERTAB);/* DO USER TRANSLATION       */ 03827000
NONFLG   L     @12,TOMBFPTR(,TOMWAPTR)                             1002 03828000
         ALR   @12,REG3                                            1002 03829000
         BCTR  @12,0                                               1002 03830000
         L     @15,EOTR(,TOMWAPTR)                                 1002 03831000
         SLR   @15,REG3                                            1002 03832000
         L     @14,TVWATABO(,TVWAPTR)                              1002 03833000
         EX    @15,@SB02439                                        1002 03834000
*      ELSE;                                                       1003 03835000
@RF01001 DS    0H                                                  1004 03836000
*      REG3=1;                                                     1004 03837000
         LA    REG3,1                                              1004 03838000
*      BOTR=BOTR+EOTR+REG1;          /* SET INDEX FOR NEXT TRANSLATE */ 03839000
         L     @12,BOTR(,TOMWAPTR)                                 1005 03840000
         AL    @12,EOTR(,TOMWAPTR)                                 1005 03841000
         ALR   @12,REG1                                            1005 03842000
         ST    @12,BOTR(,TOMWAPTR)                                 1005 03843000
*    END;                            /* END OF USER TRANSLATION LOOP */ 03844000
@DE00983 L     @12,BOTR(,TOMWAPTR)                                 1006 03845000
         C     @12,TOMBFCNT(,TOMWAPTR)                             1006 03846000
         BL    @DL00983                                            1006 03847000
*    RFY (REG1,REG2,SCAN,REG3) UNRSTD;                             1007 03848000
*  END;                              /* END OF USER TRANS    @ZA18919*/ 03849000
*ELSE;                               /* NOT USER TRANSLATION @ZA18919*/ 03850000
@RF00978 DS    0H                                                  1010 03851000
*IF TSBXASCI='1'B THEN               /* ASCII?                       */ 03852000
         L     @12,PSAAOLD                                         1010 03853000
         L     @12,ASCBTSB(,@12)                                   1010 03854000
         L     @12,TSBEXTNT(,@12)                                  1010 03855000
         TM    TSBXASCI(@12),B'10000000'                           1010 03856000
         BNO   @RF01010                                            1010 03857000
*  DO;                               /* ASCII                @ZA18919*/ 03858000
*    BOTR=0;                         /* INITIALIZE INDEX     @ZA18919*/ 03859000
         SLR   @12,@12                                             1012 03860000
         ST    @12,BOTR(,TOMWAPTR)                                 1012 03861000
*    DO WHILE BOTR < TOMBFCNT;       /* DO TILL END OF RU    @ZA18919*/ 03862000
         B     @DE01013                                            1013 03863000
@DL01013 DS    0H                                                  1014 03864000
*      TOMBFPTR=TOMGETMN+BOTR;       /* NEXT BYTE TO TRANS.  @ZA18919*/ 03865000
         L     @12,BOTR(,TOMWAPTR)                                 1014 03866000
         L     @15,TOMGETMN(,TOMWAPTR)                             1014 03867000
         ALR   @15,@12                                             1014 03868000
         ST    @15,TOMBFPTR(,TOMWAPTR)                             1014 03869000
*      EOTR=MIN(TOMBFCNT-BOTR,256);  /* AMOUNT TO TRANSLATE  @ZA18919*/ 03870000
         L     @14,TOMBFCNT(,TOMWAPTR)                             1015 03871000
         SLR   @14,@12                                             1015 03872000
         LA    @11,256                                             1015 03873000
         CR    @14,@11                                             1015 03874000
         BNH   *+6                                                      03875000
         LR    @14,@11                                             1015 03876000
         ST    @14,EOTR(,TOMWAPTR)                                 1015 03877000
*      TR(IKTOBUF(1:EOTR),ASCITAB);  /* TRANSLATE INTO ASCII @ZA18919*/ 03878000
         L     @11,EOTR(,TOMWAPTR)                                 1016 03879000
         BCTR  @11,0                                               1016 03880000
         L     @01,TVWAATBO(,TVWAPTR)                              1016 03881000
         EX    @11,@SB02441                                        1016 03882000
*      BOTR=BOTR + EOTR;             /* UPDATE INDEX         @ZA18919*/ 03883000
         ALR   @12,@14                                             1017 03884000
         ST    @12,BOTR(,TOMWAPTR)                                 1017 03885000
*    END;                            /* END OF TRANS. LOOP   @ZA18919*/ 03886000
@DE01013 L     @12,BOTR(,TOMWAPTR)                                 1018 03887000
         C     @12,TOMBFCNT(,TOMWAPTR)                             1018 03888000
         BL    @DL01013                                            1018 03889000
*  END;                              /* END OF ASCII TRANS.  @ZA18919*/ 03890000
*ELSE;                               /* NOT ASCII                    */ 03891000
@RF01010 DS    0H                                                  1021 03892000
*END TRANPROC;                       /* END OF TRANPROC              */ 03893000
@EL00024 DS    0H                                                  1021 03894000
@EF00024 DS    0H                                                  1021 03895000
@ER00024 L     @14,12(,@13)                                        1021 03896000
         BR    @14                                                 1021 03897000
         EJECT                                                          03898000
*END IKT3270O                        /* END OF IKT3270O              */ 03899000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 03900000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 03901000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        * 03902000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                        * 03903000
*/*%INCLUDE SYSLIB  (ISTRPLFB)                                        * 03904000
*/*%INCLUDE SYSLIB  (IHAASCB )                                        * 03905000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        * 03906000
*/*%INCLUDE SYSLIB  (IKJTSB  )                                        * 03907000
*/*%INCLUDE SYSLIB  (IKTTSBX )                                        * 03908000
*/*%INCLUDE SYSLIB  (IKTEQU  )                                        * 03909000
*/*%INCLUDE SYSLIB  (IKTTCAST)                                        * 03910000
*/*%INCLUDE SYSLIB  (IKTTOMWA)                                        * 03911000
*/*%INCLUDE SYSLIB  (IKTOPARM)                                        * 03912000
*/*%INCLUDE SYSLIB  (IKTTVWA )                                        * 03913000
*;                                                                 1022 03914000
@DATA    DS    0H                                                       03915000
@CH02229 DC    H'1920'                                                  03916000
@CH02246 DC    XL2'0001'                                                03917000
@SM02390 MVC   TOMWRKBF+7(0,TOMWAPTR),MSGDATA(@12)                      03918000
@SB02392 TR    TOMWRKBF(0,TOMWAPTR),ASCITABO(@01)                       03919000
@SM02405 MVC   IKTOBUF+2(0,@10),TQL1(@01)                               03920000
@SB02407 TR    IKTOBUF+2(0,@10),EDITTAB                                 03921000
@SM02409 MVC   IKTOBUF+2(0,@10),TQL2(@01)                               03922000
@SM02416 MVC   TOMWRKBF(0,TOMWAPTR),QBUF(@01)                           03923000
@SM02418 MVC   IKTOBUF(0,@12),QBUF(@03)                                 03924000
@SB02420 TR    IKTOBUF(0,@12),FLSCRTAB                                  03925000
@SB02422 TRT   IKTOBUF(0,@03),ICTAB                                     03926000
@SB02425 TR    TOMWRKBF(0,TOMWAPTR),ASISTAB                             03927000
@SM02427 MVC   IKTOBUF(0,@01),TOMWRKBF(TOMWAPTR)                        03928000
@SB02429 TR    TOMWRKBF(0,TOMWAPTR),EDITTAB                             03929000
@SM02431 MVC   IKTOBUF+2(0,@12),0(@01)                                  03930000
@SM02433 MVC   IKTOBUF(0,@12),@CB01960                                  03931000
@SM02435 MVC   IKTOBUF+2(0,@12),MSGDATA(@15)                            03932000
@SB02437 TRT   IKTOBUF(0,@12),SBATAB                                    03933000
@SB02439 TR    IKTOBUF(0,@12),USERTAB(@14)                              03934000
@SB02441 TR    IKTOBUF(0,@15),ASCITAB(@01)                              03935000
@DATD    DSECT                                                          03936000
         DS    0F                                                       03937000
@SA00001 DS    18F                                                      03938000
@SA00007 DS    1F                                                       03939000
@SA00005 DS    1F                                                       03940000
@SA00010 DS    1F                                                       03941000
@SA00012 DS    1F                                                       03942000
@SA00023 DS    1F                                                       03943000
@SA00013 DS    1F                                                       03944000
@SA00014 DS    1F                                                       03945000
@SA00021 DS    1F                                                       03946000
@SA00008 DS    1F                                                       03947000
@SA00020 DS    1F                                                       03948000
@SA00017 DS    1F                                                       03949000
@SA00015 DS    1F                                                       03950000
@SA00019 DS    1F                                                       03951000
@SA00018 DS    1F                                                       03952000
@AL00001 DS    1A                                                       03953000
IKT3270O CSECT                                                          03954000
         DS    0F                                                       03955000
@CF00064 DC    F'1'                                                     03956000
@CF00076 DC    F'2'                                                     03957000
@CF00291 DC    F'3'                                                     03958000
@CF00033 DC    F'6'                                                     03959000
@CF00034 DC    F'7'                                                     03960000
@CF00062 DC    F'8'                                                     03961000
@CF01015 DC    F'14'                                                    03962000
@CF00113 DC    F'15'                                                    03963000
@CF02240 DC    F'18'                                                    03964000
@CF02373 DC    F'19'                                                    03965000
@CF01910 DC    F'40'                                                    03966000
@CF01025 DC    F'64'                                                    03967000
@CF01672 DC    F'80'                                                    03968000
@CF02389 DC    F'-4'                                                    03969000
@DATD    DSECT                                                          03970000
         DS    0D                                                       03971000
UNPKNUM  DS    CL8                                                      03972000
PRMPTNUM DS    CL8                                                      03973000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03974000
@ENDDATD EQU   *                                                        03975000
IKT3270O CSECT                                                          03976000
         NOPR  ((@ENDDATD-@DATD)/201*16)                                03977000
         DS    0F                                                       03978000
@SIZDATD DC    AL1(0)                                                   03979000
         DC    AL3(@ENDDATD-@DATD)                                      03980000
@CV02201 DC    V(IKTIDSX1)                                              03981000
         DS    0D                                                       03982000
@CB02243 DC    X'11C1501DC85C5C5C1D4013'                                03983000
@CB02350 DC    X'1DC85C5C5C1D4013'                                      03984000
@CB01907 DC    X'1DC84FC91D40'                                          03985000
@CB02241 DC    X'C21140401DC8'                                          03986000
@CB01911 DC    X'1DC84F1D40'                                            03987000
@CB02270 DC    X'F1C2114040'                                            03988000
@CB01960 DC    X'1D4013'                                                03989000
@CB01926 DC    X'240D'                                                  03990000
@CB01928 DC    X'2415'                                                  03991000
@CB01938 DC    X'F5C1'                                                  03992000
@CB01958 DC    X'1D4C'                                                  03993000
@CB01962 EQU   @CB01960                                                 03994000
@CB01964 EQU   @CB02350                                                 03995000
@CB01968 DC    X'F140'                                                  03996000
@CB01970 DC    X'F1C1'                                                  03997000
@CB02230 DC    X'5D7F'                                                  03998000
@CB02231 DC    X'C75F'                                                  03999000
EDITTAB  DS    CL256                                                    04000000
         ORG   EDITTAB                                                  04001000
@NM00105 DC    X'007A7A7A7A057A7A7A7A7A7A0C7A7A7A'                      04002000
@NM00106 DC    X'107A7A7A7A7A7A7A7A197A7A1C7A1E1F'                      04003000
@NM00107 DC    X'7A7A7A7A7A7A7A277A7A7A7A7A7A7A7A'                      04004000
@NM00108 DC    X'7A7A327A7A7A7A377A7A7A7A7A7A7A3F'                      04005000
@NM00109 DC    X'407A7A7A7A7A7A7A7A7A4A4B4C4D4E4F'                      04006000
@NM00110 DC    X'507A7A7A7A7A7A7A7A7A5A5B5C5D5E5F'                      04007000
@NM00111 DC    X'60617A7A7A7A7A7A7A7A6A6B6C6D6E6F'                      04008000
@NM00112 DC    X'7A7A7A7A7A7A7A7A7A7A7A7B7C7D7E7F'                      04009000
@NM00113 DC    X'7A8182838485868788897A7A7A7A7A7A'                      04010000
@NM00114 DC    X'7A9192939495969798997A7A7A7A7A7A'                      04011000
@NM00115 DC    X'7A7AA2A3A4A5A6A7A8A97A7A7A7A7A7A'                      04012000
@NM00116 DC    X'7A7A7A7A7A7A7A7A7A7A7A7A7A7A7A7A'                      04013000
@NM00117 DC    X'7AC1C2C3C4C5C6C7C8C97A7A7A7A7A7A'                      04014000
@NM00118 DC    X'7AD1D2D3D4D5D6D7D8D97A7A7A7A7A7A'                      04015000
@NM00119 DC    X'7A7AE2E3E4E5E6E7E8E97A7A7A7A7A7A'                      04016000
@NM00120 DC    X'F0F1F2F3F4F5F6F7F8F97A7A7A7A7A7A'                      04017000
         ORG   EDITTAB+256                                              04018000
ASISTAB  DS    CL256                                                    04019000
         ORG   ASISTAB                                                  04020000
@NM00121 DC    X'007A7A7A7A057A0708090A0B0C7A0E0F'                      04021000
@NM00122 DC    X'1011127A7A7A7A7A18191A1B1C1D1E1F'                      04022000
@NM00123 DC    X'202122237A257A2728292A2B2C7A2E2F'                      04023000
@NM00124 DC    X'303132333435363738393A3B3C7A3E3F'                      04024000
@NM00125 DC    X'404142434445464748494A4B4C4D4E4F'                      04025000
@NM00126 DC    X'505152535455565758595A5B5C5D5E5F'                      04026000
@NM00127 DC    X'606162636465666768696A6B6C6D6E6F'                      04027000
@NM00128 DC    X'707172737475767778797A7B7C7D7E7F'                      04028000
@NM00129 DC    X'808182838485868788898A8B8C8D8E8F'                      04029000
@NM00130 DC    X'909192939495969798999A9B9C9D9E9F'                      04030000
@NM00131 DC    X'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF'                      04031000
@NM00132 DC    X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'                      04032000
@NM00133 DC    X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'                      04033000
@NM00134 DC    X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'                      04034000
@NM00135 DC    X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'                      04035000
@NM00136 DC    X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'                      04036000
         ORG   ASISTAB+256                                              04037000
FLSCRTAB DS    CL256                                                    04038000
         ORG   FLSCRTAB                                                 04039000
@NM00137 DC    X'007A7A7A7A057A0708090A0B0C7A0E0F'                      04040000
@NM00138 DC    X'101112137A7A7A7A18191A1B1C1D1E1F'                      04041000
@NM00139 DC    X'20212223247A7A7A28292A2B2C7A2E2F'                      04042000
@NM00140 DC    X'303132333435367A38393A3B3C7A3E3F'                      04043000
@NM00141 DC    X'404142434445464748494A4B4C4D4E4F'                      04044000
@NM00142 DC    X'505152535455565758595A5B5C5D5E5F'                      04045000
@NM00143 DC    X'606162636465666768696A6B6C6D6E6F'                      04046000
@NM00144 DC    X'707172737475767778797A7B7C7D7E7F'                      04047000
@NM00145 DC    X'808182838485868788898A8B8C8D8E8F'                      04048000
@NM00146 DC    X'909192939495969798999A9B9C9D9E9F'                      04049000
@NM00147 DC    X'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF'                      04050000
@NM00148 DC    X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'                      04051000
@NM00149 DC    X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'                      04052000
@NM00150 DC    X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'                      04053000
@NM00151 DC    X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'                      04054000
@NM00152 DC    X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'                      04055000
         ORG   FLSCRTAB+256                                             04056000
SBATAB   DS    CL256                                                    04057000
         ORG   SBATAB                                                   04058000
@NM00153 DC    X'00000000000500000000000000000000'                      04059000
@NM00154 DC    X'001112130000000000000000001D0000'                      04060000
@NM00155 DC    X'00000000000000000000000000000000'                      04061000
@NM00156 DC    X'0000000000000000000000003C000000'                      04062000
@NM00157 DC    X'00000000000000000000000000000000'                      04063000
@NM00158 DC    X'00000000000000000000000000000000'                      04064000
@NM00159 DC    X'00000000000000000000000000000000'                      04065000
@NM00160 DC    X'00000000000000000000000000000000'                      04066000
@NM00161 DC    X'00000000000000000000000000000000'                      04067000
@NM00162 DC    X'00000000000000000000000000000000'                      04068000
@NM00163 DC    X'00000000000000000000000000000000'                      04069000
@NM00164 DC    X'00000000000000000000000000000000'                      04070000
@NM00165 DC    X'00000000000000000000000000000000'                      04071000
@NM00166 DC    X'00000000000000000000000000000000'                      04072000
@NM00167 DC    X'00000000000000000000000000000000'                      04073000
@NM00168 DC    X'00000000000000000000000000000000'                      04074000
         ORG   SBATAB+256                                               04075000
BFADRTAB DS    CL64                                                     04076000
         ORG   BFADRTAB                                                 04077000
@NM00169 DC    X'40C1C2C3C4C5C6C7C8C94A4B4C4D4E4F'                      04078000
@NM00170 DC    X'50D1D2D3D4D5D6D7D8D95A5B5C5D5E5F'                      04079000
@NM00171 DC    X'6061E2E3E4E5E6E7E8E96A6B6C6D6E6F'                      04080000
@NM00172 DC    X'F0F1F2F3F4F5F6F7F8F97A7B7C7D7E7F'                      04081000
         ORG   BFADRTAB+64                                              04082000
ICTAB    DS    CL256                                                    04083000
         ORG   ICTAB                                                    04084000
@NM00173 DC    X'00000000000000000000000000000000'                      04085000
@NM00174 DC    X'00000013000000000000000000000000'                      04086000
@NM00175 DC    X'00000000000000000000000000000000'                      04087000
@NM00176 DC    X'00000000000000000000000000000000'                      04088000
@NM00177 DC    X'00000000000000000000000000000000'                      04089000
@NM00178 DC    X'00000000000000000000000000000000'                      04090000
@NM00179 DC    X'00000000000000000000000000000000'                      04091000
@NM00180 DC    X'00000000000000000000000000000000'                      04092000
@NM00181 DC    X'00000000000000000000000000000000'                      04093000
@NM00182 DC    X'00000000000000000000000000000000'                      04094000
@NM00183 DC    X'00000000000000000000000000000000'                      04095000
@NM00184 DC    X'00000000000000000000000000000000'                      04096000
@NM00185 DC    X'00000000000000000000000000000000'                      04097000
@NM00186 DC    X'00000000000000000000000000000000'                      04098000
@NM00187 DC    X'00000000000000000000000000000000'                      04099000
@NM00188 DC    X'00000000000000000000000000000000'                      04100000
         ORG   ICTAB+256                                                04101000
PATCH    DC    75F'0'                                                   04102000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04103000
@01      EQU   01                                                       04104000
@02      EQU   02                                                       04105000
@03      EQU   03                                                       04106000
@04      EQU   04                                                       04107000
@05      EQU   05                                                       04108000
@06      EQU   06                                                       04109000
@07      EQU   07                                                       04110000
@08      EQU   08                                                       04111000
@09      EQU   09                                                       04112000
@10      EQU   10                                                       04113000
@11      EQU   11                                                       04114000
@12      EQU   12                                                       04115000
@13      EQU   13                                                       04116000
@14      EQU   14                                                       04117000
@15      EQU   15                                                       04118000
TOMWAPTR EQU   @08                                                      04119000
TVWAPTR  EQU   @09                                                      04120000
REG0     EQU   @00                                                      04121000
REG1     EQU   @01                                                      04122000
REG2     EQU   @02                                                      04123000
REG3     EQU   @03                                                      04124000
REG4     EQU   @04                                                      04125000
REG5     EQU   @05                                                      04126000
REG6     EQU   @06                                                      04127000
REG7     EQU   @07                                                      04128000
REG13    EQU   @13                                                      04129000
REG15    EQU   @15                                                      04130000
SCAN     EQU   @01                                                      04131000
PSA      EQU   0                                                        04132000
FLCRNPSW EQU   PSA                                                      04133000
FLCROPSW EQU   PSA+8                                                    04134000
FLCICCW2 EQU   PSA+16                                                   04135000
FLCCVT   EQU   FLCICCW2                                                 04136000
PSAEEPSW EQU   PSA+132                                                  04137000
PSAESPSW EQU   PSA+136                                                  04138000
FLCSVILC EQU   PSAESPSW+1                                               04139000
PSAEPPSW EQU   PSA+140                                                  04140000
FLCPIILC EQU   PSAEPPSW+1                                               04141000
FLCPICOD EQU   PSAEPPSW+2                                               04142000
PSAPICOD EQU   FLCPICOD+1                                               04143000
FLCTEA   EQU   PSAEPPSW+4                                               04144000
FLCPER   EQU   PSA+152                                                  04145000
FLCMCLA  EQU   PSA+168                                                  04146000
FLCIOEL  EQU   FLCMCLA+4                                                04147000
FLCIOA   EQU   FLCMCLA+16                                               04148000
FLCFSA   EQU   FLCMCLA+80                                               04149000
PSAAOLD  EQU   PSA+548                                                  04150000
PSASUPER EQU   PSA+552                                                  04151000
PSASUP1  EQU   PSASUPER                                                 04152000
PSASUP2  EQU   PSASUPER+1                                               04153000
PSASUP3  EQU   PSASUPER+2                                               04154000
PSASUP4  EQU   PSASUPER+3                                               04155000
PSACLHT  EQU   PSA+640                                                  04156000
PSALKSA  EQU   PSA+696                                                  04157000
PSAHLHI  EQU   PSA+760                                                  04158000
PSADSSFL EQU   PSA+836                                                  04159000
PSADSSF1 EQU   PSADSSFL                                                 04160000
PSADSSF3 EQU   PSADSSFL+2                                               04161000
PSADSSF4 EQU   PSADSSFL+3                                               04162000
PSARSVT  EQU   PSA+896                                                  04163000
CVTMAP   EQU   0                                                        04164000
CVTDAR   EQU   CVTMAP+72                                                04165000
CVTFLGS1 EQU   CVTDAR                                                   04166000
CVTDCB   EQU   CVTMAP+116                                               04167000
CVTIERLC EQU   CVTMAP+144                                               04168000
CVTOPTA  EQU   CVTMAP+182                                               04169000
CVTOPTB  EQU   CVTMAP+183                                               04170000
CVTGTF   EQU   CVTMAP+236                                               04171000
CVTGTFST EQU   CVTGTF                                                   04172000
CVTGTFS  EQU   CVTGTFST                                                 04173000
CVTSTATE EQU   CVTGTFST                                                 04174000
CVTTMODE EQU   CVTGTFST                                                 04175000
CVTFORM  EQU   CVTGTFST                                                 04176000
CVTAQAVT EQU   CVTMAP+240                                               04177000
CVTTCMFG EQU   CVTAQAVT                                                 04178000
CVTVOLM2 EQU   CVTMAP+244                                               04179000
CVTTATA  EQU   CVTVOLM2                                                 04180000
CVTTSKS  EQU   CVTTATA                                                  04181000
CVTVOLF2 EQU   CVTTSKS                                                  04182000
CVTTAT   EQU   CVTTATA+1                                                04183000
CVTATER  EQU   CVTMAP+248                                               04184000
CVTEXT1  EQU   CVTMAP+252                                               04185000
CVTPURG  EQU   CVTMAP+260                                               04186000
CVTQMSG  EQU   CVTMAP+268                                               04187000
CVTDMSR  EQU   CVTMAP+272                                               04188000
CVTRSV37 EQU   CVTDMSR                                                  04189000
CVTDMSRF EQU   CVTRSV37                                                 04190000
CVTERPV  EQU   CVTMAP+316                                               04191000
CVTINTLA EQU   CVTMAP+320                                               04192000
CVTAPF   EQU   CVTMAP+324                                               04193000
CVTEXT2  EQU   CVTMAP+328                                               04194000
CVTHJES  EQU   CVTMAP+332                                               04195000
CVTPGSIA EQU   CVTMAP+348                                               04196000
CVTA1F1  EQU   CVTMAP+356                                               04197000
CVTSYSK  EQU   CVTMAP+357                                               04198000
CVTVOLM1 EQU   CVTMAP+380                                               04199000
CVTVOLF1 EQU   CVTVOLM1                                                 04200000
CVTATMCT EQU   CVTMAP+388                                               04201000
CVTXTNT1 EQU   0                                                        04202000
CVTXTNT2 EQU   0                                                        04203000
CVTDSSV  EQU   CVTXTNT2                                                 04204000
CVTFLGBT EQU   CVTXTNT2+5                                               04205000
CVTQID   EQU   CVTXTNT2+24                                              04206000
CVTSHS   EQU   CVTXTNT2+40                                              04207000
CVTRV400 EQU   CVTXTNT2+52                                              04208000
CVTRV409 EQU   CVTXTNT2+53                                              04209000
CVTATCVT EQU   CVTXTNT2+64                                              04210000
CVTRV429 EQU   CVTXTNT2+84                                              04211000
CVTRV438 EQU   CVTXTNT2+85                                              04212000
CVTRV457 EQU   CVTXTNT2+112                                             04213000
CVTRV466 EQU   CVTXTNT2+113                                             04214000
CVTFIX   EQU   0                                                        04215000
CVTRELNO EQU   CVTFIX+252                                               04216000
IFGRPL   EQU   0                                                        04217000
RPLCOMN  EQU   IFGRPL                                                   04218000
RPLIDWD  EQU   RPLCOMN                                                  04219000
RPLLEN   EQU   RPLIDWD+3                                                04220000
RPLECB   EQU   RPLCOMN+8                                                04221000
RPLFDBWD EQU   RPLCOMN+12                                               04222000
RPLFDBK  EQU   RPLFDBWD+1                                               04223000
RPLRTNCD EQU   RPLFDBK                                                  04224000
RPLCNDCD EQU   RPLFDBK+1                                                04225000
RPLCMPON EQU   RPLCNDCD                                                 04226000
RPLFDB2  EQU   RPLCMPON                                                 04227000
RPLERRCD EQU   RPLCNDCD+1                                               04228000
RPLFDB3  EQU   RPLERRCD                                                 04229000
RPLKEYLE EQU   RPLCOMN+16                                               04230000
RPLARG   EQU   RPLCOMN+36                                               04231000
RPLOPTCD EQU   RPLCOMN+40                                               04232000
RPLOPT1  EQU   RPLOPTCD                                                 04233000
RPLECBSW EQU   RPLOPT1                                                  04234000
RPLOPT2  EQU   RPLOPTCD+1                                               04235000
RPLADR   EQU   RPLOPT2                                                  04236000
RPLOPT3  EQU   RPLOPTCD+2                                               04237000
RPLOPT4  EQU   RPLOPTCD+3                                               04238000
RPLNXTRP EQU   RPLCOMN+44                                               04239000
RPLOPTC2 EQU   RPLCOMN+56                                               04240000
RPLOPT5  EQU   RPLOPTC2                                                 04241000
RPLWRTYP EQU   RPLOPT5                                                  04242000
RPLOPT6  EQU   RPLOPTC2+1                                               04243000
RPLUNTYP EQU   RPLOPT6                                                  04244000
RPLOPT7  EQU   RPLOPTC2+2                                               04245000
RPLCNOPT EQU   RPLOPT7                                                  04246000
RPLOPT8  EQU   RPLOPTC2+3                                               04247000
RPLRBAR  EQU   RPLCOMN+60                                               04248000
RPLAIXID EQU   RPLRBAR+2                                                04249000
RPLEXTDS EQU   RPLCOMN+68                                               04250000
RPLEXTD1 EQU   RPLEXTDS                                                 04251000
RPLVTEXT EQU   IFGRPL+76                                                04252000
RPLFDBK2 EQU   RPLVTEXT+12                                              04253000
RPLSSNSI EQU   RPLFDBK2                                                 04254000
RPLDSB   EQU   RPLSSNSI                                                 04255000
RPLDSB1  EQU   RPLDSB                                                   04256000
RPLSSEI  EQU   RPLDSB1                                                  04257000
RPLDSB2  EQU   RPLDSB+1                                                 04258000
RPLUSNSI EQU   RPLFDBK2+2                                               04259000
RPLOPTC3 EQU   RPLVTEXT+20                                              04260000
RPLOPT9  EQU   RPLOPTC3                                                 04261000
RPLOPT10 EQU   RPLOPTC3+1                                               04262000
RPLOPT11 EQU   RPLOPTC3+2                                               04263000
RPLOPT12 EQU   RPLOPTC3+3                                               04264000
RPLOSENS EQU   RPLVTEXT+24                                              04265000
RPLSSNSO EQU   RPLOSENS                                                 04266000
RPLSSEO  EQU   RPLSSNSO                                                 04267000
RPLOF16  EQU   0                                                        04268000
RPLRH3   EQU   RPLOF16                                                  04269000
RPLSRTYP EQU   RPLOF16+1                                                04270000
RPLSTYPE EQU   RPLSRTYP                                                 04271000
RPLRTYPE EQU   RPLSRTYP                                                 04272000
RPLCHN   EQU   RPLOF16+2                                                04273000
RPLVTFL1 EQU   RPLOF16+3                                                04274000
RPLVTFL2 EQU   RPLOF16+4                                                04275000
RPLPOSTV EQU   RPLVTFL2                                                 04276000
RPLRESP  EQU   RPLVTFL2                                                 04277000
RPLCNTRL EQU   RPLOF16+5                                                04278000
RPLCNTDF EQU   RPLCNTRL                                                 04279000
RPLCNTDC EQU   RPLCNTRL+1                                               04280000
RPLCNTSC EQU   RPLCNTRL+2                                               04281000
RPLOF60  EQU   0                                                        04282000
RPLOBSQ  EQU   RPLOF60+4                                                04283000
RPLIBSQ  EQU   RPLOF60+5                                                04284000
ASCB     EQU   0                                                        04285000
ASCBSUPC EQU   ASCB+16                                                  04286000
ASCBTSB  EQU   ASCB+60                                                  04287000
ASCBFW1  EQU   ASCB+100                                                 04288000
ASCBRCTF EQU   ASCBFW1+2                                                04289000
ASCBFLG1 EQU   ASCBFW1+3                                                04290000
ASCBDSP1 EQU   ASCB+114                                                 04291000
ASCBFLG2 EQU   ASCB+115                                                 04292000
ASCBLKGP EQU   ASCB+128                                                 04293000
ASCBSRQ  EQU   ASCB+180                                                 04294000
ASCBSRQ1 EQU   ASCBSRQ                                                  04295000
ASCBSRQ2 EQU   ASCBSRQ+1                                                04296000
ASCBSRQ3 EQU   ASCBSRQ+2                                                04297000
ASCBSRQ4 EQU   ASCBSRQ+3                                                04298000
TSB      EQU   0                                                        04299000
TSBASCBA EQU   TSB                                                      04300000
TSBSTAT  EQU   TSBASCBA                                                 04301000
TSBFLG1  EQU   TSB+4                                                    04302000
TSBIFLSH EQU   TSBFLG1                                                  04303000
TSBLNSZ  EQU   TSB+8                                                    04304000
TSBFLG2  EQU   TSB+16                                                   04305000
TSBAUTON EQU   TSBFLG2                                                  04306000
TSBAULST EQU   TSBFLG2                                                  04307000
TSBSTAUT EQU   TSBFLG2                                                  04308000
TSBFLG3  EQU   TSB+24                                                   04309000
TSBSPIT  EQU   TSBFLG3                                                  04310000
TSBNOBRK EQU   TSBFLG3                                                  04311000
TSBFLG5  EQU   TSB+25                                                   04312000
TSBTERMC EQU   TSB+26                                                   04313000
TSBTERM1 EQU   TSBTERMC                                                 04314000
TSBTERM2 EQU   TSBTERMC+1                                               04315000
TSBSTCC  EQU   TSB+34                                                   04316000
TSBLNNO  EQU   TSB+40                                                   04317000
TSBFLG4  EQU   TSB+41                                                   04318000
TSBAUTOS EQU   TSB+48                                                   04319000
TSBRCB   EQU   TSB+64                                                   04320000
TSBLINKA EQU   TSBRCB+4                                                 04321000
TSBTPOST EQU   TSB+72                                                   04322000
TSBTPFLG EQU   TSBTPOST                                                 04323000
TSBMINL  EQU   TSB+84                                                   04324000
TSBEXTNT EQU   TSB+96                                                   04325000
TSBX     EQU   0                                                        04326000
TSBXFLG1 EQU   TSBX+32                                                  04327000
TSBXASCI EQU   TSBXFLG1                                                 04328000
TSBXTVWA EQU   TSBX+36                                                  04329000
TSBXTERM EQU   TSBX+72                                                  04330000
TSBXTMBF EQU   TSBXTERM+2                                               04331000
TCAST    EQU   0                                                        04332000
TCASUSER EQU   TCAST+4                                                  04333000
TCASMSGS EQU   TCAST+52                                                 04334000
TCASOQM  EQU   TCAST+76                                                 04335000
TCASFLG1 EQU   TCAST+88                                                 04336000
TCASFLG2 EQU   TCAST+89                                                 04337000
TOMWA    EQU   240                                                      04338000
TOMAUTOD EQU   TOMWA                                                    04339000
TOMWRKBF EQU   TOMWA+200                                                04340000
SAVEREGS EQU   TOMWA+280                                                04341000
TOMBFCNT EQU   TOMWA+352                                                04342000
TOMMVCNT EQU   TOMWA+356                                                04343000
TOMQDATA EQU   TOMWA+360                                                04344000
TOMWRKVI EQU   TOMWA+364                                                04345000
TOMWRKVJ EQU   TOMWA+368                                                04346000
TOMNWLSZ EQU   TOMWA+372                                                04347000
TOMQBPTR EQU   TOMWA+376                                                04348000
TOMGETMN EQU   TOMWA+380                                                04349000
TOMBUFSZ EQU   TOMWA+384                                                04350000
TOMBFPTR EQU   TOMWA+388                                                04351000
TOMWRKSZ EQU   TOMWA+392                                                04352000
TOMSCPRM EQU   TOMWA+396                                                04353000
TOMREQCD EQU   TOMSCPRM                                                 04354000
TOMPLNNO EQU   TOMSCPRM+1                                               04355000
TOMLNSZ  EQU   TOMSCPRM+2                                               04356000
TOMLNNO  EQU   TOMSCPRM+4                                               04357000
TOMPLSZ  EQU   TOMSCPRM+8                                               04358000
TOMLNCNT EQU   TOMSCPRM+12                                              04359000
TOMFMTDA EQU   TOMSCPRM+16                                              04360000
TOMSBACD EQU   TOMFMTDA                                                 04361000
TOMFMTAD EQU   TOMFMTDA+1                                               04362000
TOMFMATT EQU   TOMFMTDA+3                                               04363000
TOMLNADR EQU   TOMSCPRM+21                                              04364000
TOMROWAD EQU   TOMLNADR                                                 04365000
TOMCOLAD EQU   TOMLNADR+1                                               04366000
TOMWFLGS EQU   TOMWA+421                                                04367000
TOMWFLG1 EQU   TOMWFLGS                                                 04368000
TOMEDSAV EQU   TOMWFLG1                                                 04369000
TOMENDBF EQU   TOMWFLG1                                                 04370000
TOMCURST EQU   TOMWFLG1                                                 04371000
TOMENDSC EQU   TOMWFLG1                                                 04372000
TOMEXDTA EQU   TOMWFLG1                                                 04373000
TOMEXBRU EQU   TOMWFLG1                                                 04374000
TOMOWAIT EQU   TOMWFLG1                                                 04375000
TOMWFLG2 EQU   TOMWFLGS+1                                               04376000
TOMKBULK EQU   TOMWFLG2                                                 04377000
TOMALARM EQU   TOMWFLG2                                                 04378000
TOMERMG9 EQU   TOMWFLG2                                                 04379000
TOMERASE EQU   TOMWFLG2                                                 04380000
TOMSCHED EQU   TOMWFLG2                                                 04381000
TOMSTCUR EQU   TOMWFLG2                                                 04382000
TOMERLCT EQU   TOMWFLG2                                                 04383000
TOMTRSBA EQU   TOMWFLG2                                                 04384000
TOMWFLG3 EQU   TOMWFLGS+2                                               04385000
TOMBPREQ EQU   TOMWFLG3                                                 04386000
TOMBPRSP EQU   TOMWFLG3                                                 04387000
TOMBRKPG EQU   TOMWFLG3                                                 04388000
TOMWRLG4 EQU   TOMWFLGS+3                                               04389000
TOMBRKMG EQU   TOMWRLG4                                                 04390000
TOMEB    EQU   TOMWRLG4                                                 04391000
TOMPGNSV EQU   TOMWRLG4                                                 04392000
TOMUPARM EQU   TOMWA+428                                                04393000
TOMUPRM1 EQU   TOMUPARM                                                 04394000
TOMUPRM2 EQU   TOMUPARM+4                                               04395000
TOMUPRM3 EQU   TOMUPARM+8                                               04396000
TOMUPRM4 EQU   TOMUPARM+12                                              04397000
TOMUPRM5 EQU   TOMUPARM+16                                              04398000
TOMUPRM6 EQU   TOMUPARM+20                                              04399000
TOMUPRM7 EQU   TOMUPARM+24                                              04400000
TOMUPRM8 EQU   TOMUPARM+28                                              04401000
TOMCOLMN EQU   TOMWA+464                                                04402000
TOMXCNT  EQU   TOMWA+468                                                04403000
OPARMS   EQU   TOMWA+484                                                04404000
OPBUFADR EQU   OPARMS                                                   04405000
OPREQ    EQU   OPARMS+4                                                 04406000
OPRC     EQU   OPARMS+5                                                 04407000
OPBFSZ   EQU   OPARMS+6                                                 04408000
OPFLAGS  EQU   OPARMS+8                                                 04409000
OPOPTNS  EQU   OPFLAGS+1                                                04410000
OPHOLD   EQU   OPOPTNS                                                  04411000
OPBRK    EQU   OPOPTNS                                                  04412000
OPEDIT   EQU   OPOPTNS                                                  04413000
OPASID   EQU   OPOPTNS                                                  04414000
OPNXFLGS EQU   OPARMS+16                                                04415000
OPNXBRK  EQU   OPNXFLGS+1                                               04416000
OPNXEDIT EQU   OPNXFLGS+1                                               04417000
OPNXASID EQU   OPNXFLGS+1                                               04418000
TVWA     EQU   0                                                        04419000
TVWATOMW EQU   TVWA+12                                                  04420000
TVWATOPQ EQU   TVWA+16                                                  04421000
TVWAGMPT EQU   TVWA+68                                                  04422000
TVWAATTN EQU   TVWA+85                                                  04423000
TVWATQL1 EQU   TVWA+86                                                  04424000
TVWATQL2 EQU   TVWA+87                                                  04425000
TVWAFLG7 EQU   TVWA+110                                                 04426000
TVWABKPG EQU   TVWAFLG7                                                 04427000
TVWALNSV EQU   TVWA+111                                                 04428000
TVWAECBL EQU   TVWA+120                                                 04429000
TVWADLST EQU   TVWA+132                                                 04430000
TVWAFLG1 EQU   TVWA+144                                                 04431000
TVWATAS  EQU   TVWAFLG1                                                 04432000
TVWAXSCD EQU   TVWAFLG1                                                 04433000
TVWAULK  EQU   TVWAFLG1                                                 04434000
TVWAFLG2 EQU   TVWA+145                                                 04435000
TVWAPGN  EQU   TVWAFLG2                                                 04436000
TVWAERMG EQU   TVWAFLG2                                                 04437000
TVWABKMG EQU   TVWAFLG2                                                 04438000
TVWAFLG3 EQU   TVWA+146                                                 04439000
TVWABRIN EQU   TVWAFLG3                                                 04440000
TVWAAIGN EQU   TVWAFLG3                                                 04441000
TVWATRAN EQU   TVWAFLG3                                                 04442000
TVWAFLG4 EQU   TVWA+147                                                 04443000
TVWAFMSC EQU   TVWAFLG4                                                 04444000
TVWADOOQ EQU   TVWAFLG4                                                 04445000
TVWAKBDL EQU   TVWAFLG4                                                 04446000
TVWANOFB EQU   TVWAFLG4                                                 04447000
TVWAFLSC EQU   TVWAFLG4                                                 04448000
TVWADARC EQU   TVWAFLG4                                                 04449000
TVWAFLG5 EQU   TVWA+150                                                 04450000
TVWASCAN EQU   TVWAFLG5                                                 04451000
TVWAFSM  EQU   TVWAFLG5                                                 04452000
TVWAWO   EQU   TVWAFLG5                                                 04453000
TVWAFSW  EQU   TVWAFLG5                                                 04454000
TVWANFSP EQU   TVWAFLG5                                                 04455000
TVWALNCT EQU   TVWA+151                                                 04456000
TVWATABO EQU   TVWA+156                                                 04457000
TVWAATBO EQU   TVWA+172                                                 04458000
TVWAFLG6 EQU   TVWA+182                                                 04459000
TVWAIOTR EQU   TVWAFLG6                                                 04460000
MSGADR   EQU   0                                                        04461000
MSGDATA  EQU   2                                                        04462000
MSGSIZE  EQU   0                                                        04463000
QBUF     EQU   0                                                        04464000
IKTOBUF  EQU   0                                                        04465000
IKTQMOUT EQU   0                                                        04466000
ASCITABO EQU   0                                                        04467000
RDBFGETM EQU   0                                                        04468000
DATALENG EQU   RDBFGETM+4                                               04469000
CNTLHEAD EQU   RDBFGETM+8                                               04470000
SBASEQEN EQU   CNTLHEAD+2                                               04471000
CURSSBA@ EQU   SBASEQEN+1                                               04472000
ICCURSOR EQU   0                                                        04473000
SBACDE   EQU   ICCURSOR                                                 04474000
CURSADDR EQU   ICCURSOR+1                                               04475000
ICORDER  EQU   ICCURSOR+3                                               04476000
TOPQ     EQU   0                                                        04477000
TQL1     EQU   TOPQ                                                     04478000
TQL2     EQU   TOPQ+80                                                  04479000
ASCITAB  EQU   0                                                        04480000
USERTAB  EQU   0                                                        04481000
ISTRPL   EQU   0                                                        04482000
CVTS01   EQU   CVTPGSIA                                                 04483000
CVTLPDIA EQU   CVTS01+12                                                04484000
CVTDIRST EQU   CVTLPDIA                                                 04485000
CVTSLIDA EQU   CVTS01+24                                                04486000
CVTCTLFG EQU   CVTS01+50                                                04487000
CVTRV210 EQU   CVTS01+424                                               04488000
CVTRV219 EQU   CVTS01+425                                               04489000
CVTRV228 EQU   CVTS01+426                                               04490000
CVTRV237 EQU   CVTS01+427                                               04491000
CVTMFRTR EQU   CVTS01+452                                               04492000
CVTRV262 EQU   CVTS01+468                                               04493000
CVTRV271 EQU   CVTS01+469                                               04494000
CVTRV280 EQU   CVTS01+470                                               04495000
CVTRV289 EQU   CVTS01+471                                               04496000
CVTGSDA  EQU   CVTS01+600                                               04497000
CVTTCASP EQU   CVTS01+664                                               04498000
PSARSVTE EQU   PSARSVT                                                  04499000
I        EQU   TOMWRKVI                                                 04500000
J        EQU   TOMWRKVJ                                                 04501000
TEMPMVCT EQU   J                                                        04502000
EOTR     EQU   TOMWRKVI                                                 04503000
BOTR     EQU   TOMWRKVJ                                                 04504000
FLC      EQU   PSA                                                      04505000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04506000
PSARSAV  EQU   PSARSVTE+60                                              04507000
PSARSTK  EQU   PSARSVTE+56                                              04508000
PSAESAV3 EQU   PSARSVTE+52                                              04509000
PSAESTK3 EQU   PSARSVTE+48                                              04510000
PSAESAV2 EQU   PSARSVTE+44                                              04511000
PSAESTK2 EQU   PSARSVTE+40                                              04512000
PSAESAV1 EQU   PSARSVTE+36                                              04513000
PSAESTK1 EQU   PSARSVTE+32                                              04514000
PSAPSAV  EQU   PSARSVTE+28                                              04515000
PSAPSTK  EQU   PSARSVTE+24                                              04516000
PSAMSAV  EQU   PSARSVTE+20                                              04517000
PSAMSTK  EQU   PSARSVTE+16                                              04518000
PSASSAV  EQU   PSARSVTE+12                                              04519000
PSASSTK  EQU   PSARSVTE+8                                               04520000
PSANSTK  EQU   PSARSVTE+4                                               04521000
PSACSTK  EQU   PSARSVTE                                                 04522000
CVTRV628 EQU   CVTS01+728                                               04523000
CVTRV627 EQU   CVTS01+724                                               04524000
CVTRV626 EQU   CVTS01+720                                               04525000
CVTRV625 EQU   CVTS01+716                                               04526000
CVTRV624 EQU   CVTS01+712                                               04527000
CVTRV623 EQU   CVTS01+708                                               04528000
CVTRV622 EQU   CVTS01+704                                               04529000
CVTRV621 EQU   CVTS01+700                                               04530000
CVTRV620 EQU   CVTS01+696                                               04531000
CVTRV619 EQU   CVTS01+692                                               04532000
CVTRV618 EQU   CVTS01+688                                               04533000
CVTRV617 EQU   CVTS01+684                                               04534000
CVTRV616 EQU   CVTS01+680                                               04535000
CVTRV615 EQU   CVTS01+676                                               04536000
CVTRV614 EQU   CVTS01+672                                               04537000
CVTRV613 EQU   CVTS01+668                                               04538000
CVT0PT03 EQU   CVTS01+660                                               04539000
CVT0PT0E EQU   CVTS01+656                                               04540000
CVTIRM   EQU   CVTS01+652                                               04541000
CVTCGK   EQU   CVTS01+648                                               04542000
CVTRV607 EQU   CVTS01+644                                               04543000
CVTRV606 EQU   CVTS01+640                                               04544000
CVTRV605 EQU   CVTS01+636                                               04545000
CVTRV604 EQU   CVTS01+632                                               04546000
CVTEFF02 EQU   CVTS01+628                                               04547000
CVTCBBR  EQU   CVTS01+624                                               04548000
CVTSSCR  EQU   CVTS01+620                                               04549000
CVTEVENT EQU   CVTS01+616                                               04550000
CVTCRCA  EQU   CVTS01+612                                               04551000
CVTTPIO  EQU   CVTS01+608                                               04552000
CVTADV   EQU   CVTS01+604                                               04553000
CVTGSDAB EQU   CVTGSDA                                                  04554000
CVTQV3   EQU   CVTS01+596                                               04555000
CVTQV2   EQU   CVTS01+592                                               04556000
CVTQV1   EQU   CVTS01+588                                               04557000
CVTRPT   EQU   CVTS01+584                                               04558000
CVTSSRB  EQU   CVTS01+580                                               04559000
CVTCSDRL EQU   CVTS01+576                                               04560000
CVTEXP1  EQU   CVTS01+572                                               04561000
CVTRMPMT EQU   CVTS01+568                                               04562000
CVTRMPTT EQU   CVTS01+564                                               04563000
CVTVPSA  EQU   CVTS01+560                                               04564000
CVTVSTOP EQU   CVTS01+556                                               04565000
CVTGTFR8 EQU   CVTS01+552                                               04566000
CVTQUIT  EQU   CVTS01+548                                               04567000
CVTVACR  EQU   CVTS01+544                                               04568000
CVTWTCB  EQU   CVTS01+540                                               04569000
CVTSTPRS EQU   CVTS01+536                                               04570000
CVT0PT02 EQU   CVTS01+532                                               04571000
CVTDARCM EQU   CVTS01+528                                               04572000
CVTIRECM EQU   CVTS01+524                                               04573000
CVTJRECM EQU   CVTS01+520                                               04574000
CVTVEMS0 EQU   CVTS01+516                                               04575000
CVTSPFRR EQU   CVTS01+512                                               04576000
CVTRLSTG EQU   CVTS01+508                                               04577000
CVT0TC0A EQU   CVTS01+504                                               04578000
CVTGMBR  EQU   CVTS01+500                                               04579000
CVTLFRM  EQU   CVTS01+496                                               04580000
CVTRMBR  EQU   CVTS01+492                                               04581000
CVTVIOP  EQU   CVTS01+488                                               04582000
CVTRV307 EQU   CVTS01+486                                               04583000
CVTRV306 EQU   CVTS01+484                                               04584000
CVTRV305 EQU   CVTS01+482                                               04585000
CVTRV304 EQU   CVTS01+480                                               04586000
CVTRV303 EQU   CVTS01+478                                               04587000
CVTRV302 EQU   CVTS01+476                                               04588000
CVTTRCA  EQU   CVTS01+472                                               04589000
CVTRV297 EQU   CVTRV289                                                 04590000
CVTRV296 EQU   CVTRV289                                                 04591000
CVTRV295 EQU   CVTRV289                                                 04592000
CVTRV294 EQU   CVTRV289                                                 04593000
CVTRV293 EQU   CVTRV289                                                 04594000
CVTRV292 EQU   CVTRV289                                                 04595000
CVTRV291 EQU   CVTRV289                                                 04596000
CVTRV290 EQU   CVTRV289                                                 04597000
CVTRV288 EQU   CVTRV280                                                 04598000
CVTRV287 EQU   CVTRV280                                                 04599000
CVTRV286 EQU   CVTRV280                                                 04600000
CVTRV285 EQU   CVTRV280                                                 04601000
CVTRV284 EQU   CVTRV280                                                 04602000
CVTRV283 EQU   CVTRV280                                                 04603000
CVTRV282 EQU   CVTRV280                                                 04604000
CVTRV281 EQU   CVTRV280                                                 04605000
CVTRV279 EQU   CVTRV271                                                 04606000
CVTRV278 EQU   CVTRV271                                                 04607000
CVTRV277 EQU   CVTRV271                                                 04608000
CVTRV276 EQU   CVTRV271                                                 04609000
CVTRV275 EQU   CVTRV271                                                 04610000
CVTRV274 EQU   CVTRV271                                                 04611000
CVTRV273 EQU   CVTRV271                                                 04612000
CVTRV272 EQU   CVTRV271                                                 04613000
CVTRV270 EQU   CVTRV262                                                 04614000
CVTRV269 EQU   CVTRV262                                                 04615000
CVTRV268 EQU   CVTRV262                                                 04616000
CVTRV267 EQU   CVTRV262                                                 04617000
CVTRV266 EQU   CVTRV262                                                 04618000
CVTRV265 EQU   CVTRV262                                                 04619000
CVTRV264 EQU   CVTRV262                                                 04620000
CVTRV263 EQU   CVTRV262                                                 04621000
CVTVFP   EQU   CVTS01+464                                               04622000
CVTVSI   EQU   CVTS01+460                                               04623000
CVTVPSIB EQU   CVTS01+456                                               04624000
CVTMFACT EQU   CVTMFRTR                                                 04625000
CVTMFCTL EQU   CVTS01+448                                               04626000
CVTPVBP  EQU   CVTS01+444                                               04627000
CVTPWI   EQU   CVTS01+440                                               04628000
CVTRV254 EQU   CVTS01+438                                               04629000
CVTRV253 EQU   CVTS01+436                                               04630000
CVTRV252 EQU   CVTS01+434                                               04631000
CVTRV251 EQU   CVTS01+433                                               04632000
CVTRV250 EQU   CVTS01+432                                               04633000
CVTRV249 EQU   CVTS01+431                                               04634000
CVTRV248 EQU   CVTS01+430                                               04635000
CVTRV247 EQU   CVTS01+429                                               04636000
CVTRV246 EQU   CVTS01+428                                               04637000
CVTRV245 EQU   CVTRV237                                                 04638000
CVTRV244 EQU   CVTRV237                                                 04639000
CVTRV243 EQU   CVTRV237                                                 04640000
CVTRV242 EQU   CVTRV237                                                 04641000
CVTRV241 EQU   CVTRV237                                                 04642000
CVTRV240 EQU   CVTRV237                                                 04643000
CVTRV239 EQU   CVTRV237                                                 04644000
CVTRV238 EQU   CVTRV237                                                 04645000
CVTRV236 EQU   CVTRV228                                                 04646000
CVTRV235 EQU   CVTRV228                                                 04647000
CVTRV234 EQU   CVTRV228                                                 04648000
CVTRV233 EQU   CVTRV228                                                 04649000
CVTRV232 EQU   CVTRV228                                                 04650000
CVTRV231 EQU   CVTRV228                                                 04651000
CVTRV230 EQU   CVTRV228                                                 04652000
CVTRV229 EQU   CVTRV228                                                 04653000
CVTRV227 EQU   CVTRV219                                                 04654000
CVTRV226 EQU   CVTRV219                                                 04655000
CVTRV225 EQU   CVTRV219                                                 04656000
CVTRV224 EQU   CVTRV219                                                 04657000
CVTRV223 EQU   CVTRV219                                                 04658000
CVTRV222 EQU   CVTRV219                                                 04659000
CVTRV221 EQU   CVTRV219                                                 04660000
CVTRV220 EQU   CVTRV219                                                 04661000
CVTRV218 EQU   CVTRV210                                                 04662000
CVTRV217 EQU   CVTRV210                                                 04663000
CVTRV216 EQU   CVTRV210                                                 04664000
CVTRV215 EQU   CVTRV210                                                 04665000
CVTRV214 EQU   CVTRV210                                                 04666000
CVTRV213 EQU   CVTRV210                                                 04667000
CVTRV212 EQU   CVTRV210                                                 04668000
CVTRV211 EQU   CVTRV210                                                 04669000
CVTLCCAT EQU   CVTS01+420                                               04670000
CVTPCCAT EQU   CVTS01+416                                               04671000
CVTIPCRP EQU   CVTS01+412                                               04672000
CVTIPCRI EQU   CVTS01+408                                               04673000
CVTIPCDS EQU   CVTS01+404                                               04674000
CVTAIDVT EQU   CVTS01+400                                               04675000
CVTSSAP  EQU   CVTS01+396                                               04676000
CVTEHCIR EQU   CVTS01+392                                               04677000
CVTEHDEF EQU   CVTS01+388                                               04678000
CVTDAIR  EQU   CVTS01+384                                               04679000
CVTPERFM EQU   CVTS01+380                                               04680000
CVT044R2 EQU   CVTS01+376                                               04681000
CVTFETCH EQU   CVTS01+372                                               04682000
CVTRSTWD EQU   CVTS01+368                                               04683000
CVTSPOST EQU   CVTS01+364                                               04684000
CVTIOBP  EQU   CVTS01+360                                               04685000
CVTASMVT EQU   CVTS01+356                                               04686000
CVTRECRQ EQU   CVTS01+352                                               04687000
CVTWSAC  EQU   CVTS01+348                                               04688000
CVTRV149 EQU   CVTS01+344                                               04689000
CVTWSAL  EQU   CVTS01+340                                               04690000
CVTSPSA  EQU   CVTS01+336                                               04691000
CVTGLMN  EQU   CVTS01+332                                               04692000
CVTVEAC0 EQU   CVTS01+328                                               04693000
CVT062R1 EQU   CVTS01+324                                               04694000
CVTRPOST EQU   CVTS01+320                                               04695000
CVTDQIQE EQU   CVTS01+316                                               04696000
CVTCSD   EQU   CVTS01+312                                               04697000
CVTLKRMA EQU   CVTS01+308                                               04698000
CVTRSPIE EQU   CVTS01+304                                               04699000
CVTRENQ  EQU   CVTS01+300                                               04700000
CVTLQCB  EQU   CVTS01+296                                               04701000
CVTFQCB  EQU   CVTS01+292                                               04702000
CVTQCS01 EQU   CVTS01+288                                               04703000
CVTAPFT  EQU   CVTS01+284                                               04704000
CVTPARRL EQU   CVTS01+280                                               04705000
CVTVWAIT EQU   CVTS01+276                                               04706000
CVTGSPL  EQU   CVTS01+272                                               04707000
CVTLSMQ  EQU   CVTS01+268                                               04708000
CVTGSMQ  EQU   CVTS01+264                                               04709000
CVTEXPRO EQU   CVTS01+260                                               04710000
CVTOPCTP EQU   CVTS01+256                                               04711000
CVTSIC   EQU   CVTS01+252                                               04712000
CVTTPIOS EQU   CVTS01+248                                               04713000
CVTRTMS  EQU   CVTS01+244                                               04714000
CVTSDBF  EQU   CVTS01+240                                               04715000
CVTSCBP  EQU   CVTS01+236                                               04716000
CVTSDMP  EQU   CVTS01+232                                               04717000
CVTSV60  EQU   CVTS01+228                                               04718000
CVTRTMCT EQU   CVTS01+224                                               04719000
CVTASCBL EQU   CVTS01+220                                               04720000
CVTASCBH EQU   CVTS01+216                                               04721000
CVTGDA   EQU   CVTS01+212                                               04722000
CVTASVT  EQU   CVTS01+208                                               04723000
CVTVVMDI EQU   CVTS01+204                                               04724000
CVTAQTOP EQU   CVTS01+200                                               04725000
CVTIOSCS EQU   CVTS01+196                                               04726000
CVTSDRM  EQU   CVTS01+192                                               04727000
CVTOPTE  EQU   CVTS01+188                                               04728000
CVTSTXU  EQU   CVTS01+184                                               04729000
CVTQUIS  EQU   CVTS01+180                                               04730000
CVTPARS  EQU   CVTS01+176                                               04731000
CVTS1EE  EQU   CVTS01+172                                               04732000
CVTFRAS  EQU   CVTS01+168                                               04733000
CVTQSAS  EQU   CVTS01+164                                               04734000
CVTCRAS  EQU   CVTS01+160                                               04735000
CVTCRMN  EQU   CVTS01+156                                               04736000
CVTDELCP EQU   CVTS01+152                                               04737000
CVTFRECL EQU   CVTS01+148                                               04738000
CVTGETCL EQU   CVTS01+144                                               04739000
CVTBLDCP EQU   CVTS01+140                                               04740000
CVTAUTHL EQU   CVTS01+136                                               04741000
CVTSCAN  EQU   CVTS01+132                                               04742000
CVTRV144 EQU   CVTS01+130                                               04743000
CVTMAXMP EQU   CVTS01+128                                               04744000
CVTSTCK  EQU   CVTS01+124                                               04745000
CVTRV139 EQU   CVTS01+123                                               04746000
CVTDSSAC EQU   CVTS01+122                                               04747000
CVTRV513 EQU   CVTS01+121                                               04748000
CVTIOSPL EQU   CVTS01+120                                               04749000
CVTPTGT  EQU   CVTS01+116                                               04750000
CVTCSPIE EQU   CVTS01+112                                               04751000
CVTSMFEX EQU   CVTS01+108                                               04752000
CVTOLT0A EQU   CVTS01+104                                               04753000
CVTSRBRT EQU   CVTS01+100                                               04754000
CVTPUTL  EQU   CVTS01+96                                                04755000
CVTASCRL EQU   CVTS01+92                                                04756000
CVTASCRF EQU   CVTS01+88                                                04757000
CVTRV326 EQU   CVTS01+84                                                04758000
CVTRV325 EQU   CVTS01+80                                                04759000
CVTRV324 EQU   CVTS01+76                                                04760000
CVT0VL01 EQU   CVTS01+72                                                04761000
CVTSHRVM EQU   CVTS01+68                                                04762000
CVTRV332 EQU   CVTS01+64                                                04763000
CVTTAS   EQU   CVTS01+60                                                04764000
CVTRSCN  EQU   CVTS01+56                                                04765000
CVTTRAC2 EQU   CVTS01+54                                                04766000
CVTTRACE EQU   CVTS01+52                                                04767000
CVTAPG   EQU   CVTS01+51                                                04768000
CVTSDTRC EQU   CVTCTLFG                                                 04769000
CVTGTRCE EQU   CVTCTLFG                                                 04770000
CVTNOMP  EQU   CVTCTLFG                                                 04771000
CVTRSV79 EQU   CVTCTLFG                                                 04772000
CVTDSTAT EQU   CVTCTLFG                                                 04773000
CVTRSV78 EQU   CVTCTLFG                                                 04774000
CVTRV333 EQU   CVTCTLFG                                                 04775000
CVTRV323 EQU   CVTCTLFG                                                 04776000
CVTSPVLK EQU   CVTS01+49                                                04777000
CVTRSV77 EQU   CVTS01+48                                                04778000
CVTRV331 EQU   CVTS01+44                                                04779000
CVTRV330 EQU   CVTS01+40                                                04780000
CVTRV329 EQU   CVTS01+36                                                04781000
CVTRV328 EQU   CVTS01+32                                                04782000
CVTRV322 EQU   CVTS01+28                                                04783000
CVTSLID  EQU   CVTSLIDA+1                                               04784000
CVTSYLK  EQU   CVTSLIDA                                                 04785000
CVTRV321 EQU   CVTS01+20                                                04786000
CVTRV320 EQU   CVTS01+16                                                04787000
CVTLPDIR EQU   CVTLPDIA+1                                               04788000
CVTRSV69 EQU   CVTDIRST                                                 04789000
CVTRSV68 EQU   CVTDIRST                                                 04790000
CVTRSV67 EQU   CVTDIRST                                                 04791000
CVTRSV66 EQU   CVTDIRST                                                 04792000
CVTRSV65 EQU   CVTDIRST                                                 04793000
CVTRSV64 EQU   CVTDIRST                                                 04794000
CVTRSV63 EQU   CVTDIRST                                                 04795000
CVTDICOM EQU   CVTDIRST                                                 04796000
CVTPVTP  EQU   CVTS01+8                                                 04797000
CVTLPDSR EQU   CVTS01+4                                                 04798000
CVTGETL  EQU   CVTS01                                                   04799000
@NM00189 EQU   SBASEQEN                                                 04800000
CMDWCCDE EQU   CNTLHEAD                                                 04801000
GETMLENG EQU   RDBFGETM                                                 04802000
TVWAEND  EQU   TVWA+216                                                 04803000
@NM00104 EQU   TVWA+208                                                 04804000
TVWAUSRA EQU   TVWA+200                                                 04805000
@NM00103 EQU   TVWA+192                                                 04806000
TVWAFRWO EQU   TVWA+188                                                 04807000
TVWAFRWI EQU   TVWA+184                                                 04808000
TVWARSHW EQU   TVWA+183                                                 04809000
@NM00102 EQU   TVWAFLG6                                                 04810000
TVWAINB  EQU   TVWAFLG6                                                 04811000
TVWAFMEW EQU   TVWAFLG6                                                 04812000
TVWARCDT EQU   TVWAFLG6                                                 04813000
TVWAIOP  EQU   TVWAFLG6                                                 04814000
TVWAISYS EQU   TVWAFLG6                                                 04815000
@NM00101 EQU   TVWA+180                                                 04816000
TVWAQMLB EQU   TVWA+176                                                 04817000
TVWAATBI EQU   TVWA+168                                                 04818000
TVWATRNM EQU   TVWA+160                                                 04819000
TVWATABI EQU   TVWA+152                                                 04820000
TVWAP1ST EQU   TVWAFLG5                                                 04821000
TVWAPRMT EQU   TVWAFLG5                                                 04822000
TVWATIR  EQU   TVWAFLG5                                                 04823000
@NM00100 EQU   TVWA+148                                                 04824000
TVWARCRS EQU   TVWAFLG4                                                 04825000
TVWAQMEV EQU   TVWAFLG4                                                 04826000
TVWATRDF EQU   TVWAFLG3                                                 04827000
TVWAQLBU EQU   TVWAFLG3                                                 04828000
TVWAQMIO EQU   TVWAFLG3                                                 04829000
TVWAQMRT EQU   TVWAFLG3                                                 04830000
TVWASDSG EQU   TVWAFLG3                                                 04831000
TVWABIR  EQU   TVWAFLG2                                                 04832000
TVWARTRY EQU   TVWAFLG2                                                 04833000
TVWAGERR EQU   TVWAFLG2                                                 04834000
TVWASCD  EQU   TVWAFLG2                                                 04835000
TVWABFC  EQU   TVWAFLG2                                                 04836000
TVWAOOPS EQU   TVWAFLG1                                                 04837000
TVWALTE  EQU   TVWAFLG1                                                 04838000
TVWATID  EQU   TVWAFLG1                                                 04839000
TVWATIS  EQU   TVWAFLG1                                                 04840000
TVWATOD  EQU   TVWAFLG1                                                 04841000
TVWADIN3 EQU   TVWADLST+8                                               04842000
TVWADIN2 EQU   TVWADLST+4                                               04843000
TVWADIN1 EQU   TVWADLST                                                 04844000
TVWAECB3 EQU   TVWAECBL+8                                               04845000
TVWAECB2 EQU   TVWAECBL+4                                               04846000
TVWAECB1 EQU   TVWAECBL                                                 04847000
TVWATECB EQU   TVWA+116                                                 04848000
TVWAECB  EQU   TVWA+112                                                 04849000
@NM00099 EQU   TVWAFLG7                                                 04850000
TVWACHSE EQU   TVWAFLG7                                                 04851000
TVWATOBB EQU   TVWAFLG7                                                 04852000
TVWARISW EQU   TVWAFLG7                                                 04853000
TVWARET  EQU   TVWAFLG7                                                 04854000
TVWARDBF EQU   TVWAFLG7                                                 04855000
TVWASND1 EQU   TVWAFLG7                                                 04856000
TVWAVSZ  EQU   TVWA+108                                                 04857000
TVWAVST  EQU   TVWA+104                                                 04858000
TVWAEXL  EQU   TVWA+100                                                 04859000
TVWARPL  EQU   TVWA+96                                                  04860000
TVWANIB  EQU   TVWA+92                                                  04861000
TVWAACB  EQU   TVWA+88                                                  04862000
TVWACHNL EQU   TVWA+84                                                  04863000
TVWALBUF EQU   TVWA+80                                                  04864000
TVWAHBUF EQU   TVWA+76                                                  04865000
TVWACLSZ EQU   TVWA+74                                                  04866000
TVWARTR  EQU   TVWA+72                                                  04867000
TVWATCB  EQU   TVWA+64                                                  04868000
TVWAUSMN EQU   TVWA+60                                                  04869000
TVWACPID EQU   TVWA+56                                                  04870000
TVWAEOQ  EQU   TVWA+52                                                  04871000
TVWANOM  EQU   TVWA+48                                                  04872000
TVWABOQ  EQU   TVWA+44                                                  04873000
TVWAEIQ  EQU   TVWA+40                                                  04874000
TVWANIM  EQU   TVWA+36                                                  04875000
TVWABIQ  EQU   TVWA+32                                                  04876000
TVWAQMWA EQU   TVWA+28                                                  04877000
TVWALLWA EQU   TVWA+24                                                  04878000
TVWABFPT EQU   TVWA+20                                                  04879000
TVWATIMW EQU   TVWA+8                                                   04880000
TVWAPPL  EQU   TVWA                                                     04881000
TOMWAEND EQU   TOMWA+504                                                04882000
@NM00098 EQU   OPNXFLGS+3                                               04883000
@NM00097 EQU   OPNXFLGS+2                                               04884000
@NM00096 EQU   OPNXFLGS+1                                               04885000
OPNXHOLD EQU   OPNXFLGS+1                                               04886000
@NM00095 EQU   OPNXFLGS                                                 04887000
OPNXADTP EQU   OPNXFLGS                                                 04888000
OPNXALC  EQU   OPNXFLGS                                                 04889000
OPNXBFSZ EQU   OPARMS+14                                                04890000
@NM00094 EQU   OPARMS+12                                                04891000
@NM00093 EQU   OPFLAGS+3                                                04892000
@NM00092 EQU   OPFLAGS+2                                                04893000
@NM00091 EQU   OPOPTNS                                                  04894000
@NM00090 EQU   OPFLAGS                                                  04895000
OPADTOP  EQU   OPFLAGS                                                  04896000
OPALLOC  EQU   OPFLAGS                                                  04897000
@NM00089 EQU   TOMWA+476                                                04898000
TOMCOLSV EQU   TOMWA+472                                                04899000
TOMERCNT EQU   TOMWA+460                                                04900000
@NM00088 EQU   TOMWFLGS+4                                               04901000
@NM00087 EQU   TOMWRLG4                                                 04902000
TOMEBSV  EQU   TOMWRLG4                                                 04903000
@NM00086 EQU   TOMWRLG4                                                 04904000
TOMENDB  EQU   TOMWFLG3                                                 04905000
TOMESEND EQU   TOMWFLG3                                                 04906000
TOMEMAIN EQU   TOMWFLG3                                                 04907000
TOMBRKSW EQU   TOMWFLG3                                                 04908000
TOMINITS EQU   TOMWFLG3                                                 04909000
@NM00085 EQU   TOMSCPRM+23                                              04910000
@NM00084 EQU   TOMSCPRM+3                                               04911000
@NM00083 EQU   TOMWA+393                                                04912000
TCASTEND EQU   TCAST+136                                                04913000
TCASDUMP EQU   TCAST+132                                                04914000
TCASSCHD EQU   TCAST+128                                                04915000
TCASTPND EQU   TCAST+124                                                04916000
TCASOMJR EQU   TCAST+120                                                04917000
@NM00082 EQU   TCAST+118                                                04918000
TCASBR14 EQU   TCAST+116                                                04919000
TCASATTN EQU   TCAST+112                                                04920000
TCASASCI EQU   TCAST+108                                                04921000
TCASTTQH EQU   TCAST+104                                                04922000
@NM00081 EQU   TCAST+102                                                04923000
@NM00080 EQU   TCAST+100                                                04924000
@NM00079 EQU   TCAST+98                                                 04925000
@NM00078 EQU   TCAST+96                                                 04926000
TCASASCB EQU   TCAST+92                                                 04927000
@NM00077 EQU   TCAST+90                                                 04928000
@NM00076 EQU   TCASFLG2                                                 04929000
@NM00075 EQU   TCASFLG1                                                 04930000
TCASNACT EQU   TCASFLG1                                                 04931000
TCASVSD  EQU   TCASFLG1                                                 04932000
TCASABND EQU   TCASFLG1                                                 04933000
TCASMDSW EQU   TCASFLG1                                                 04934000
TCASBKMD EQU   TCASFLG1                                                 04935000
TCASLTE  EQU   TCAST+84                                                 04936000
TCASEXIT EQU   TCAST+80                                                 04937000
TCASIQM  EQU   TCAST+72                                                 04938000
TCASTSB  EQU   TCAST+68                                                 04939000
TCASTTL  EQU   TCAST+64                                                 04940000
TCASWA   EQU   TCAST+60                                                 04941000
TCASFRR  EQU   TCAST+56                                                 04942000
TCASDATO EQU   TCAST+48                                                 04943000
TCASDATI EQU   TCAST+44                                                 04944000
TCASXECB EQU   TCAST+40                                                 04945000
TCASTID  EQU   TCAST+32                                                 04946000
@NM00074 EQU   TCAST+31                                                 04947000
TCASCHNL EQU   TCAST+30                                                 04948000
TCASCRSZ EQU   TCAST+28                                                 04949000
TCASLBUF EQU   TCAST+24                                                 04950000
TCASHBUF EQU   TCAST+20                                                 04951000
TCASCLSZ EQU   TCAST+18                                                 04952000
TCASRCON EQU   TCAST+16                                                 04953000
TCASACBP EQU   TCAST+8                                                  04954000
TCASUMAX EQU   TCASUSER+2                                               04955000
TCASUSEC EQU   TCASUSER                                                 04956000
TCASID   EQU   TCAST                                                    04957000
TSBXEND  EQU   TSBX+120                                                 04958000
@NM00073 EQU   TSBX+116                                                 04959000
TSBXBIND EQU   TSBX+80                                                  04960000
TSBXRPL  EQU   TSBX+76                                                  04961000
@NM00072 EQU   TSBXTERM+1                                               04962000
TSBXTMTP EQU   TSBXTERM                                                 04963000
TSBXAIND EQU   TSBX+70                                                  04964000
TSBXRSZO EQU   TSBX+69                                                  04965000
TSBXRSZI EQU   TSBX+68                                                  04966000
TSBXLBUF EQU   TSBX+64                                                  04967000
TSBXCSAP EQU   TSBX+60                                                  04968000
TSBXSRB  EQU   TSBX+56                                                  04969000
TSBXSRBI EQU   TSBX+52                                                  04970000
@NM00071 EQU   TSBX+48                                                  04971000
TSBXTOM  EQU   TSBX+44                                                  04972000
TSBXTIM  EQU   TSBX+40                                                  04973000
@NM00070 EQU   TSBX+33                                                  04974000
@NM00069 EQU   TSBXFLG1                                                 04975000
TSBXWREC EQU   TSBXFLG1                                                 04976000
TSBXLOGF EQU   TSBXFLG1                                                 04977000
TSBXACTV EQU   TSBXFLG1                                                 04978000
TSBXUID  EQU   TSBX+24                                                  04979000
@NM00068 EQU   TSBX+16                                                  04980000
@NM00067 EQU   TSBX+12                                                  04981000
TSBXECB  EQU   TSBX+8                                                   04982000
TSBXBCK  EQU   TSBX+4                                                   04983000
TSBXFWD  EQU   TSBX                                                     04984000
TSBEND   EQU   TSB+120                                                  04985000
TSBSF1   EQU   TSB+112                                                  04986000
TSBTRMID EQU   TSB+104                                                  04987000
TSBALTC  EQU   TSB+103                                                  04988000
TSBALTR  EQU   TSB+102                                                  04989000
TSBPRMC  EQU   TSB+101                                                  04990000
TSBPRMR  EQU   TSB+100                                                  04991000
TSBPSWD  EQU   TSB+88                                                   04992000
TSBLECB  EQU   TSBMINL                                                  04993000
TSBLINE  EQU   TSB+82                                                   04994000
TSBSTAX  EQU   TSB+81                                                   04995000
TSBATTNC EQU   TSB+80                                                   04996000
TSBF1V   EQU   TSBTPOST+7                                               04997000
TSBF1M   EQU   TSBTPOST+6                                               04998000
TSBF2V   EQU   TSBTPOST+5                                               04999000
TSBF2M   EQU   TSBTPOST+4                                               05000000
TSBFLAGV EQU   TSBTPOST+3                                               05001000
TSBFLAGM EQU   TSBTPOST+2                                               05002000
TSBSBASV EQU   TSBTPOST+1                                               05003000
@NM00066 EQU   TSBTPFLG                                                 05004000
@NM00065 EQU   TSBTPFLG                                                 05005000
@NM00064 EQU   TSBTPFLG                                                 05006000
@NM00063 EQU   TSBTPFLG                                                 05007000
TSBNEWID EQU   TSBTPFLG                                                 05008000
TSBTPAYI EQU   TSBTPFLG                                                 05009000
TSBTPQCB EQU   TSBTPFLG                                                 05010000
TSBPOSTO EQU   TSBTPFLG                                                 05011000
TSBLINKB EQU   TSBLINKA+1                                               05012000
TSBPRI   EQU   TSBLINKA                                                 05013000
TSBRQCB  EQU   TSBRCB                                                   05014000
TSBCTCB  EQU   TSB+60                                                   05015000
TSBERSDS EQU   TSB+56                                                   05016000
TSBAUTOI EQU   TSB+52                                                   05017000
TSBATNCC EQU   TSB+44                                                   05018000
TSBASRCE EQU   TSB+42                                                   05019000
TSBHLDL  EQU   TSBFLG4                                                  05020000
TSBGETBF EQU   TSBFLG4                                                  05021000
TSBCANC  EQU   TSBFLG4                                                  05022000
TSBHOLD  EQU   TSBFLG4                                                  05023000
TSBHUNG  EQU   TSBFLG4                                                  05024000
TSBOWAIT EQU   TSBFLG4                                                  05025000
TSBIWAIT EQU   TSBFLG4                                                  05026000
TSBOCAB  EQU   TSBFLG4                                                  05027000
TSBATNTC EQU   TSB+38                                                   05028000
TSBATNLC EQU   TSB+36                                                   05029000
TSBCHDCC EQU   TSBSTCC+1                                                05030000
TSBLNDCC EQU   TSBSTCC                                                  05031000
TSBWTJID EQU   TSB+32                                                   05032000
TSBECB   EQU   TSB+28                                                   05033000
TSBC1050 EQU   TSBTERM2                                                 05034000
@NM00062 EQU   TSBTERM2                                                 05035000
@NM00061 EQU   TSBTERM2                                                 05036000
@NM00060 EQU   TSBTERM2                                                 05037000
@NM00059 EQU   TSBTERM2                                                 05038000
TSBCTWX  EQU   TSBTERM2                                                 05039000
@NM00058 EQU   TSBTERM2                                                 05040000
@NM00057 EQU   TSBTERM2                                                 05041000
@NM00056 EQU   TSBTERM1                                                 05042000
@NM00055 EQU   TSBTERM1                                                 05043000
@NM00054 EQU   TSBTERM1                                                 05044000
TSBC2741 EQU   TSBTERM1                                                 05045000
TSBC5041 EQU   TSBTERM1                                                 05046000
TSBCATTN EQU   TSBTERM1                                                 05047000
TSBCBRK  EQU   TSBTERM1                                                 05048000
TSBCIHBN EQU   TSBTERM1                                                 05049000
TSBVTAM  EQU   TSBFLG5                                                  05050000
TSBKEYS  EQU   TSBFLG5                                                  05051000
@NM00053 EQU   TSBFLG5                                                  05052000
TSBATMP  EQU   TSBFLG5                                                  05053000
TSBNFLOP EQU   TSBFLG3                                                  05054000
TSBTPUT  EQU   TSBFLG3                                                  05055000
TSBAWOIP EQU   TSBFLG3                                                  05056000
TSBNBKSP EQU   TSBFLG3                                                  05057000
TSBTJMSG EQU   TSBFLG3                                                  05058000
TSBATTN  EQU   TSBFLG3                                                  05059000
TSBIBFP  EQU   TSB+21                                                   05060000
TSBNIBF  EQU   TSB+20                                                   05061000
TSBITBFP EQU   TSB+17                                                   05062000
TSBSATN2 EQU   TSBFLG2                                                  05063000
TSBSATN1 EQU   TSBFLG2                                                  05064000
TSBAUTOC EQU   TSBFLG2                                                  05065000
TSBBRKIN EQU   TSBFLG2                                                  05066000
TSBBIPI  EQU   TSBFLG2                                                  05067000
TSBOBFP  EQU   TSB+13                                                   05068000
TSBNOBF  EQU   TSB+12                                                   05069000
TSBOTBFP EQU   TSB+9                                                    05070000
TSBWTCB  EQU   TSB+5                                                    05071000
TSBTJBF  EQU   TSBFLG1                                                  05072000
TSBTJIP  EQU   TSBFLG1                                                  05073000
TSBTJOW  EQU   TSBFLG1                                                  05074000
TSBWOWIP EQU   TSBFLG1                                                  05075000
TSBOWIP  EQU   TSBFLG1                                                  05076000
TSBOFLSH EQU   TSBFLG1                                                  05077000
TSBANSR  EQU   TSBFLG1                                                  05078000
TSBASCB  EQU   TSBASCBA+1                                               05079000
TSBATNLD EQU   TSBSTAT                                                  05080000
TSB3270  EQU   TSBSTAT                                                  05081000
TSBDISC  EQU   TSBSTAT                                                  05082000
TSBITOFF EQU   TSBSTAT                                                  05083000
TSBNOBUF EQU   TSBSTAT                                                  05084000
TSBDSPLY EQU   TSBSTAT                                                  05085000
TSBLWAIT EQU   TSBSTAT                                                  05086000
TSBINUSE EQU   TSBSTAT                                                  05087000
ASCBEND  EQU   ASCB+208                                                 05088000
ASCBSRBT EQU   ASCB+200                                                 05089000
ASCBSWTL EQU   ASCB+196                                                 05090000
ASCBRS14 EQU   ASCB+195                                                 05091000
ASCBSMCT EQU   ASCB+194                                                 05092000
ASCBRS12 EQU   ASCB+192                                                 05093000
ASCBPCTT EQU   ASCB+188                                                 05094000
ASCBVGTT EQU   ASCB+184                                                 05095000
ASCBRV43 EQU   ASCBSRQ4                                                 05096000
ASCBRV42 EQU   ASCBSRQ4                                                 05097000
ASCBRV41 EQU   ASCBSRQ4                                                 05098000
ASCBRV40 EQU   ASCBSRQ4                                                 05099000
ASCBRV39 EQU   ASCBSRQ4                                                 05100000
ASCBRV38 EQU   ASCBSRQ4                                                 05101000
ASCBRV37 EQU   ASCBSRQ4                                                 05102000
ASCBRV36 EQU   ASCBSRQ4                                                 05103000
ASCBRV35 EQU   ASCBSRQ3                                                 05104000
ASCBRV34 EQU   ASCBSRQ3                                                 05105000
ASCBRV33 EQU   ASCBSRQ3                                                 05106000
ASCBRV32 EQU   ASCBSRQ3                                                 05107000
ASCBRV31 EQU   ASCBSRQ3                                                 05108000
ASCBRV30 EQU   ASCBSRQ3                                                 05109000
ASCBRV29 EQU   ASCBSRQ3                                                 05110000
ASCBRV28 EQU   ASCBSRQ3                                                 05111000
ASCBRV27 EQU   ASCBSRQ2                                                 05112000
ASCBRV26 EQU   ASCBSRQ2                                                 05113000
ASCBRV25 EQU   ASCBSRQ2                                                 05114000
ASCBRV24 EQU   ASCBSRQ2                                                 05115000
ASCBRV23 EQU   ASCBSRQ2                                                 05116000
ASCBRV22 EQU   ASCBSRQ2                                                 05117000
ASCBRV21 EQU   ASCBSRQ2                                                 05118000
ASCBRV20 EQU   ASCBSRQ2                                                 05119000
ASCBRV19 EQU   ASCBSRQ1                                                 05120000
ASCBRV18 EQU   ASCBSRQ1                                                 05121000
ASCBRV17 EQU   ASCBSRQ1                                                 05122000
ASCBRV16 EQU   ASCBSRQ1                                                 05123000
ASCBRV15 EQU   ASCBSRQ1                                                 05124000
ASCBRV14 EQU   ASCBSRQ1                                                 05125000
ASCBRV13 EQU   ASCBSRQ1                                                 05126000
ASCBSTA  EQU   ASCBSRQ1                                                 05127000
ASCBJBNS EQU   ASCB+176                                                 05128000
ASCBJBNI EQU   ASCB+172                                                 05129000
ASCBMCC  EQU   ASCB+168                                                 05130000
ASCBRTWA EQU   ASCB+164                                                 05131000
ASCBIQEA EQU   ASCB+160                                                 05132000
ASCBXMPQ EQU   ASCB+156                                                 05133000
ASCBRS01 EQU   ASCB+154                                                 05134000
ASCBFMCT EQU   ASCB+152                                                 05135000
ASCBOUXB EQU   ASCB+148                                                 05136000
ASCBOUCB EQU   ASCB+144                                                 05137000
ASCBMECB EQU   ASCB+140                                                 05138000
ASCBQECB EQU   ASCB+136                                                 05139000
ASCBLSQH EQU   ASCBLKGP+4                                               05140000
ASCBLOCK EQU   ASCBLKGP                                                 05141000
ASCBTCBS EQU   ASCB+124                                                 05142000
ASCBNVSC EQU   ASCB+122                                                 05143000
ASCBVSC  EQU   ASCB+120                                                 05144000
ASCBSRBS EQU   ASCB+118                                                 05145000
ASCBSSRB EQU   ASCB+116                                                 05146000
ASCBRV06 EQU   ASCBFLG2                                                 05147000
ASCBRV05 EQU   ASCBFLG2                                                 05148000
ASCBRV04 EQU   ASCBFLG2                                                 05149000
ASCBSNQS EQU   ASCBFLG2                                                 05150000
ASCBS2S  EQU   ASCBFLG2                                                 05151000
ASCBCEXT EQU   ASCBFLG2                                                 05152000
ASCBPXMT EQU   ASCBFLG2                                                 05153000
ASCBXMPT EQU   ASCBFLG2                                                 05154000
ASCBRF07 EQU   ASCBDSP1                                                 05155000
ASCBRF06 EQU   ASCBDSP1                                                 05156000
ASCBRF05 EQU   ASCBDSP1                                                 05157000
ASCBRF04 EQU   ASCBDSP1                                                 05158000
ASCBRF03 EQU   ASCBDSP1                                                 05159000
ASCBRF02 EQU   ASCBDSP1                                                 05160000
ASCBFAIL EQU   ASCBDSP1                                                 05161000
ASCBNOQ  EQU   ASCBDSP1                                                 05162000
ASCBSWCT EQU   ASCB+112                                                 05163000
ASCBASXB EQU   ASCB+108                                                 05164000
ASCBTMCH EQU   ASCB+104                                                 05165000
ASCBNSWP EQU   ASCBFLG1                                                 05166000
ASCBTYP1 EQU   ASCBFLG1                                                 05167000
ASCBSTND EQU   ASCBFLG1                                                 05168000
ASCBABNT EQU   ASCBFLG1                                                 05169000
ASCBTERM EQU   ASCBFLG1                                                 05170000
ASCBS3S  EQU   ASCBFLG1                                                 05171000
ASCBCMSH EQU   ASCBFLG1                                                 05172000
ASCBTOFF EQU   ASCBFLG1                                                 05173000
ASCBRF01 EQU   ASCBRCTF                                                 05174000
ASCBTMLW EQU   ASCBRCTF                                                 05175000
ASCBOUT  EQU   ASCBRCTF                                                 05176000
ASCBWAIT EQU   ASCBRCTF                                                 05177000
ASCBRV08 EQU   ASCBRCTF                                                 05178000
ASCBFQU  EQU   ASCBRCTF                                                 05179000
ASCBFRS  EQU   ASCBRCTF                                                 05180000
ASCBTMNO EQU   ASCBRCTF                                                 05181000
ASCBAFFN EQU   ASCBFW1                                                  05182000
ASCBDUMP EQU   ASCB+96                                                  05183000
ASCBQSVC EQU   ASCB+92                                                  05184000
ASCBUBET EQU   ASCB+88                                                  05185000
ASCBECB  EQU   ASCB+84                                                  05186000
ASCBJSTL EQU   ASCB+80                                                  05187000
ASCBEWST EQU   ASCB+72                                                  05188000
ASCBEJST EQU   ASCB+64                                                  05189000
ASCBCSCB EQU   ASCB+56                                                  05190000
ASCBRSM  EQU   ASCB+52                                                  05191000
ASCBLDA  EQU   ASCB+48                                                  05192000
ASCBSTOR EQU   ASCB+44                                                  05193000
ASCBDP   EQU   ASCB+43                                                  05194000
ASCBRV07 EQU   ASCB+42                                                  05195000
ASCBIOSM EQU   ASCB+40                                                  05196000
ASCBSEQN EQU   ASCB+38                                                  05197000
ASCBASID EQU   ASCB+36                                                  05198000
ASCBCPUS EQU   ASCB+32                                                  05199000
ASCBSPL  EQU   ASCB+28                                                  05200000
ASCBIOSP EQU   ASCB+24                                                  05201000
ASCBSYNC EQU   ASCBSUPC+4                                               05202000
ASCBSVRB EQU   ASCBSUPC                                                 05203000
ASCBCMSF EQU   ASCB+12                                                  05204000
ASCBBWDP EQU   ASCB+8                                                   05205000
ASCBFWDP EQU   ASCB+4                                                   05206000
ASCBASCB EQU   ASCB                                                     05207000
ASCBEGIN EQU   ASCB                                                     05208000
RPLSEQNO EQU   RPLOF60+6                                                05209000
@NM00028 EQU   RPLIBSQ                                                  05210000
RPLIINV  EQU   RPLIBSQ                                                  05211000
RPLINEG  EQU   RPLIBSQ                                                  05212000
RPLIPOS  EQU   RPLIBSQ                                                  05213000
RPLIIGN  EQU   RPLIBSQ                                                  05214000
RPLIRSET EQU   RPLIBSQ                                                  05215000
RPLITST  EQU   RPLIBSQ                                                  05216000
RPLISET  EQU   RPLIBSQ                                                  05217000
@NM00027 EQU   RPLOBSQ                                                  05218000
RPLOINV  EQU   RPLOBSQ                                                  05219000
RPLONEG  EQU   RPLOBSQ                                                  05220000
RPLOPOS  EQU   RPLOBSQ                                                  05221000
RPLOIGN  EQU   RPLOBSQ                                                  05222000
RPLORSET EQU   RPLOBSQ                                                  05223000
RPLOTST  EQU   RPLOBSQ                                                  05224000
RPLOSET  EQU   RPLOBSQ                                                  05225000
RPLIBSQV EQU   RPLOF60+2                                                05226000
RPLOBSQV EQU   RPLOF60                                                  05227000
@NM00026 EQU   RPLCNTSC                                                 05228000
RPLRSHUT EQU   RPLCNTSC                                                 05229000
RPLRQR   EQU   RPLCNTSC                                                 05230000
RPLSHUTC EQU   RPLCNTSC                                                 05231000
RPLSHUTD EQU   RPLCNTSC                                                 05232000
RPLSTSN  EQU   RPLCNTSC                                                 05233000
RPLCLEAR EQU   RPLCNTSC                                                 05234000
RPLSDT   EQU   RPLCNTSC                                                 05235000
@NM00025 EQU   RPLCNTDC                                                 05236000
RPLSIGNL EQU   RPLCNTDC                                                 05237000
RPLLUS   EQU   RPLCNTDC                                                 05238000
RPLRTR   EQU   RPLCNTDC                                                 05239000
RPLBID   EQU   RPLCNTDC                                                 05240000
@NM00024 EQU   RPLCNTDF                                                 05241000
RPLQI    EQU   RPLCNTDF                                                 05242000
RPLRELQ  EQU   RPLCNTDF                                                 05243000
RPLCHASE EQU   RPLCNTDF                                                 05244000
RPLQEC   EQU   RPLCNTDF                                                 05245000
RPLQC    EQU   RPLCNTDF                                                 05246000
RPLCNCEL EQU   RPLCNTDF                                                 05247000
RPLDATA  EQU   RPLCNTDF                                                 05248000
RPLRRN   EQU   RPLRESP                                                  05249000
RPLNFME  EQU   RPLRESP                                                  05250000
RPLEX    EQU   RPLRESP                                                  05251000
@NM00023 EQU   RPLRESP                                                  05252000
@NM00022 EQU   RPLPOSTV                                                 05253000
RPLSCHED EQU   RPLPOSTV                                                 05254000
@NM00021 EQU   RPLVTFL1                                                 05255000
RPLAUTUS EQU   RPLVTFL1                                                 05256000
RPLVTUSE EQU   RPLVTFL1                                                 05257000
@NM00020 EQU   RPLVTFL1                                                 05258000
@NM00019 EQU   RPLCHN                                                   05259000
RPLONLY  EQU   RPLCHN                                                   05260000
RPLLAST  EQU   RPLCHN                                                   05261000
RPLMIDLE EQU   RPLCHN                                                   05262000
RPLFIRST EQU   RPLCHN                                                   05263000
@NM00018 EQU   RPLRTYPE                                                 05264000
RPLDFASY EQU   RPLRTYPE                                                 05265000
RPLNFSYN EQU   RPLRTYPE                                                 05266000
RPLRRESP EQU   RPLRTYPE                                                 05267000
@NM00017 EQU   RPLSTYPE                                                 05268000
RPLSRESP EQU   RPLSTYPE                                                 05269000
@NM00016 EQU   RPLRH3                                                   05270000
RPLCSI   EQU   RPLRH3                                                   05271000
RPLCHREQ EQU   RPLRH3                                                   05272000
RPLCMD   EQU   RPLRH3                                                   05273000
RPLEB    EQU   RPLRH3                                                   05274000
RPLBB    EQU   RPLRH3                                                   05275000
RPLSIGDA EQU   RPLVTEXT+32                                              05276000
RPLSAV13 EQU   RPLVTEXT+28                                              05277000
RPLUSNSO EQU   RPLOSENS+2                                               05278000
RPLSSMO  EQU   RPLSSNSO+1                                               05279000
@NM00015 EQU   RPLSSEO                                                  05280000
RPLRRO   EQU   RPLSSEO                                                  05281000
RPLFIO   EQU   RPLSSEO                                                  05282000
RPLSTATO EQU   RPLSSEO                                                  05283000
RPLCPMO  EQU   RPLSSEO                                                  05284000
@NM00014 EQU   RPLSSEO                                                  05285000
RPLFMHDR EQU   RPLOPT12                                                 05286000
@NM00013 EQU   RPLOPT12                                                 05287000
@NM00012 EQU   RPLOPT12                                                 05288000
@NM00011 EQU   RPLOPT12                                                 05289000
RPLNIBTK EQU   RPLOPT12                                                 05290000
RPLTRUNC EQU   RPLOPT12                                                 05291000
RPLKEEP  EQU   RPLOPT12                                                 05292000
@NM00010 EQU   RPLOPT12                                                 05293000
RPLRSVE8 EQU   RPLOPT11                                                 05294000
RPLRSVE7 EQU   RPLOPT11                                                 05295000
RPLRSVE6 EQU   RPLOPT11                                                 05296000
RPLRSVE5 EQU   RPLOPT11                                                 05297000
RPLRSVE4 EQU   RPLOPT11                                                 05298000
RPLSTOP  EQU   RPLOPT11                                                 05299000
RPLSTART EQU   RPLOPT11                                                 05300000
RPLQUIES EQU   RPLOPT11                                                 05301000
RPLRSVI6 EQU   RPLOPT10                                                 05302000
RPLRSVI5 EQU   RPLOPT10                                                 05303000
RPLRSVI4 EQU   RPLOPT10                                                 05304000
RPLRSVI3 EQU   RPLOPT10                                                 05305000
RPLRSVI2 EQU   RPLOPT10                                                 05306000
RPLSPARM EQU   RPLOPT10                                                 05307000
RPLDSPLY EQU   RPLOPT10                                                 05308000
RPLBSCID EQU   RPLOPT10                                                 05309000
RPLTOPL  EQU   RPLOPT9                                                  05310000
RPLCIDE  EQU   RPLOPT9                                                  05311000
RPLRNNM  EQU   RPLOPT9                                                  05312000
RPLAPPST EQU   RPLOPT9                                                  05313000
RPLCOUNT EQU   RPLOPT9                                                  05314000
RPLTERMS EQU   RPLOPT9                                                  05315000
RPLDEVCH EQU   RPLOPT9                                                  05316000
RPLLOGON EQU   RPLOPT9                                                  05317000
RPLUSFLD EQU   RPLVTEXT+16                                              05318000
RPLESR2  EQU   RPLUSNSI+1                                               05319000
RPLESR1  EQU   RPLUSNSI                                                 05320000
RPLSSMI  EQU   RPLDSB2                                                  05321000
@NM00009 EQU   RPLSSEI                                                  05322000
RPLRRI   EQU   RPLSSEI                                                  05323000
RPLFII   EQU   RPLSSEI                                                  05324000
RPLSTATI EQU   RPLSSEI                                                  05325000
RPLCPMI  EQU   RPLSSEI                                                  05326000
RPLPATHI EQU   RPLSSEI                                                  05327000
RPLARCLN EQU   RPLVTEXT+8                                               05328000
RPLAARLN EQU   RPLVTEXT+4                                               05329000
RPLAAREA EQU   RPLVTEXT                                                 05330000
RPLERMSA EQU   RPLCOMN+72                                               05331000
RPLEMLEN EQU   RPLCOMN+70                                               05332000
RPLACTIV EQU   RPLCOMN+69                                               05333000
RPLBRANC EQU   RPLEXTD1                                                 05334000
RPLNIB   EQU   RPLEXTD1                                                 05335000
@NM00008 EQU   RPLEXTD1                                                 05336000
RPLEXIT  EQU   RPLEXTD1                                                 05337000
RPLNEXIT EQU   RPLEXTD1                                                 05338000
RPLEXSCH EQU   RPLEXTD1                                                 05339000
RPLDDDD  EQU   RPLRBAR+4                                                05340000
@NM00007 EQU   RPLRBAR+3                                                05341000
@NM00006 EQU   RPLAIXID                                                 05342000
RPLAXPKP EQU   RPLAIXID                                                 05343000
RPLAIXPC EQU   RPLRBAR                                                  05344000
RPLRSV88 EQU   RPLOPT8                                                  05345000
RPLUNCON EQU   RPLOPT8                                                  05346000
RPLACTV  EQU   RPLOPT8                                                  05347000
RPLSESS  EQU   RPLOPT8                                                  05348000
RPLPEND  EQU   RPLOPT8                                                  05349000
RPLODPRM EQU   RPLOPT8                                                  05350000
RPLODACP EQU   RPLOPT8                                                  05351000
RPLODACQ EQU   RPLOPT8                                                  05352000
RPLRSV78 EQU   RPLOPT7                                                  05353000
RPLTCRNO EQU   RPLOPT7                                                  05354000
RPLRLSOP EQU   RPLOPT7                                                  05355000
RPLTPOST EQU   RPLOPT7                                                  05356000
RPLQOPT  EQU   RPLOPT7                                                  05357000
RPLCNIMM EQU   RPLCNOPT                                                 05358000
RPLCNANY EQU   RPLCNOPT                                                 05359000
RPLCNALL EQU   RPLCNOPT                                                 05360000
RPLRSV68 EQU   RPLOPT6                                                  05361000
RPLRSV67 EQU   RPLOPT6                                                  05362000
RPLLOCK  EQU   RPLOPT6                                                  05363000
RPLNCOND EQU   RPLOPT6                                                  05364000
RPLCOND  EQU   RPLOPT6                                                  05365000
RPLEOT   EQU   RPLUNTYP                                                 05366000
RPLEOM   EQU   RPLUNTYP                                                 05367000
RPLEOB   EQU   RPLUNTYP                                                 05368000
RPLWROPT EQU   RPLOPT5                                                  05369000
RPLNODE  EQU   RPLOPT5                                                  05370000
RPLERACE EQU   RPLWRTYP                                                 05371000
RPLEAU   EQU   RPLWRTYP                                                 05372000
RPLNERAS EQU   RPLWRTYP                                                 05373000
RPLPSOPT EQU   RPLOPT5                                                  05374000
@NM00005 EQU   RPLOPT5                                                  05375000
RPLDLGIN EQU   RPLOPT5                                                  05376000
RPLBUFL  EQU   RPLCOMN+52                                               05377000
RPLRLEN  EQU   RPLCOMN+48                                               05378000
RPLCHAIN EQU   RPLNXTRP                                                 05379000
RPLBOP   EQU   RPLOPT4                                                  05380000
@NM00004 EQU   RPLOPT4                                                  05381000
RPLMKFRM EQU   RPLOPT4                                                  05382000
RPLENDTR EQU   RPLOPT4                                                  05383000
RPLALIGN EQU   RPLOPT3                                                  05384000
RPLFMT   EQU   RPLOPT3                                                  05385000
RPLFLD   EQU   RPLOPT3                                                  05386000
RPLVFY   EQU   RPLOPT3                                                  05387000
RPLBLK   EQU   RPLOPT3                                                  05388000
RPLSFORM EQU   RPLOPT3                                                  05389000
RPLEODS  EQU   RPLOPT3                                                  05390000
RPLNSP   EQU   RPLOPT2                                                  05391000
RPLUPD   EQU   RPLOPT2                                                  05392000
@NM00003 EQU   RPLOPT2                                                  05393000
RPLLRD   EQU   RPLOPT2                                                  05394000
RPLBWD   EQU   RPLOPT2                                                  05395000
RPLCNV   EQU   RPLOPT2                                                  05396000
RPLADD   EQU   RPLADR                                                   05397000
RPLKEY   EQU   RPLOPT2                                                  05398000
RPLECBIN EQU   RPLECBSW                                                 05399000
RPLGEN   EQU   RPLOPT1                                                  05400000
RPLKGE   EQU   RPLOPT1                                                  05401000
RPLASY   EQU   RPLOPT1                                                  05402000
RPLSKP   EQU   RPLOPT1                                                  05403000
RPLSEQ   EQU   RPLOPT1                                                  05404000
RPLDIR   EQU   RPLOPT1                                                  05405000
RPLLOC   EQU   RPLOPT1                                                  05406000
RPLDAF   EQU   RPLARG+2                                                 05407000
RPLSAF   EQU   RPLARG                                                   05408000
RPLAREA  EQU   RPLCOMN+32                                               05409000
RPLTCBPT EQU   RPLCOMN+28                                               05410000
RPLDACB  EQU   RPLCOMN+24                                               05411000
RPLCCHAR EQU   RPLCOMN+20                                               05412000
RPLSTRID EQU   RPLCOMN+18                                               05413000
RPLKEYL  EQU   RPLKEYLE                                                 05414000
RPLRDSOH EQU   RPLFDB3                                                  05415000
RPLRLG   EQU   RPLFDB3                                                  05416000
RPLLGFRC EQU   RPLFDB3                                                  05417000
RPLREOT  EQU   RPLFDB3                                                  05418000
RPLREOM  EQU   RPLFDB3                                                  05419000
RPLREOB  EQU   RPLFDB3                                                  05420000
RPLSV32  EQU   RPLFDB3                                                  05421000
RPLUINPT EQU   RPLFDB3                                                  05422000
RPLSTSAV EQU   RPLFDB2                                                  05423000
RPLCUERR EQU   RPLFDB2                                                  05424000
RPLDLGFL EQU   RPLFDB2                                                  05425000
RPLIOERR EQU   RPLFDB2                                                  05426000
RPLDVUNS EQU   RPLFDB2                                                  05427000
RPLATND  EQU   RPLFDB2                                                  05428000
RPLRVID  EQU   RPLFDB2                                                  05429000
RPLERLK  EQU   RPLFDB2                                                  05430000
RPLERREG EQU   RPLRTNCD                                                 05431000
RPLSTAT  EQU   RPLFDBWD                                                 05432000
RPLPOST  EQU   RPLECB                                                   05433000
RPLWAIT  EQU   RPLECB                                                   05434000
RPLPLHPT EQU   RPLCOMN+4                                                05435000
RPLLEN2  EQU   RPLLEN                                                   05436000
RPLREQ   EQU   RPLIDWD+2                                                05437000
RPLSTYP  EQU   RPLIDWD+1                                                05438000
RPLID    EQU   RPLIDWD                                                  05439000
CVTLEVL  EQU   CVTRELNO+2                                               05440000
CVTNUMB  EQU   CVTRELNO                                                 05441000
CVTMDL   EQU   CVTFIX+250                                               05442000
@NM00002 EQU   CVTFIX+248                                               05443000
@NM00001 EQU   CVTFIX                                                   05444000
CVTRV482 EQU   CVTXTNT2+128                                             05445000
CVTRV481 EQU   CVTXTNT2+124                                             05446000
CVTRV480 EQU   CVTXTNT2+120                                             05447000
CVTRV479 EQU   CVTXTNT2+118                                             05448000
CVTRV478 EQU   CVTXTNT2+117                                             05449000
CVTRV477 EQU   CVTXTNT2+116                                             05450000
CVTRV476 EQU   CVTXTNT2+115                                             05451000
CVTRV475 EQU   CVTXTNT2+114                                             05452000
CVTRV474 EQU   CVTRV466                                                 05453000
CVTRV473 EQU   CVTRV466                                                 05454000
CVTRV472 EQU   CVTRV466                                                 05455000
CVTRV471 EQU   CVTRV466                                                 05456000
CVTRV470 EQU   CVTRV466                                                 05457000
CVTRV469 EQU   CVTRV466                                                 05458000
CVTRV468 EQU   CVTRV466                                                 05459000
CVTRV467 EQU   CVTRV466                                                 05460000
CVTRV465 EQU   CVTRV457                                                 05461000
CVTRV464 EQU   CVTRV457                                                 05462000
CVTRV463 EQU   CVTRV457                                                 05463000
CVTRV462 EQU   CVTRV457                                                 05464000
CVTRV461 EQU   CVTRV457                                                 05465000
CVTRV460 EQU   CVTRV457                                                 05466000
CVTRV459 EQU   CVTRV457                                                 05467000
CVTRV458 EQU   CVTRV457                                                 05468000
CVTRV456 EQU   CVTXTNT2+108                                             05469000
CVTRV455 EQU   CVTXTNT2+104                                             05470000
CVTRV454 EQU   CVTXTNT2+100                                             05471000
CVTRV453 EQU   CVTXTNT2+96                                              05472000
CVTRV452 EQU   CVTXTNT2+94                                              05473000
CVTRV451 EQU   CVTXTNT2+92                                              05474000
CVTRV450 EQU   CVTXTNT2+90                                              05475000
CVTRV449 EQU   CVTXTNT2+88                                              05476000
CVTRV448 EQU   CVTXTNT2+87                                              05477000
CVTRV447 EQU   CVTXTNT2+86                                              05478000
CVTRV446 EQU   CVTRV438                                                 05479000
CVTRV445 EQU   CVTRV438                                                 05480000
CVTRV444 EQU   CVTRV438                                                 05481000
CVTRV443 EQU   CVTRV438                                                 05482000
CVTRV442 EQU   CVTRV438                                                 05483000
CVTRV441 EQU   CVTRV438                                                 05484000
CVTRV440 EQU   CVTRV438                                                 05485000
CVTRV439 EQU   CVTRV438                                                 05486000
CVTRV437 EQU   CVTRV429                                                 05487000
CVTRV436 EQU   CVTRV429                                                 05488000
CVTRV435 EQU   CVTRV429                                                 05489000
CVTRV434 EQU   CVTRV429                                                 05490000
CVTRV433 EQU   CVTRV429                                                 05491000
CVTRV432 EQU   CVTRV429                                                 05492000
CVTRV431 EQU   CVTRV429                                                 05493000
CVTRV430 EQU   CVTRV429                                                 05494000
CVTRV428 EQU   CVTXTNT2+80                                              05495000
CVTRV427 EQU   CVTXTNT2+76                                              05496000
CVTRV426 EQU   CVTXTNT2+72                                              05497000
CVTRV425 EQU   CVTXTNT2+68                                              05498000
CVTATACT EQU   CVTATCVT                                                 05499000
CVTRV423 EQU   CVTXTNT2+62                                              05500000
CVTRV422 EQU   CVTXTNT2+60                                              05501000
CVTRV421 EQU   CVTXTNT2+58                                              05502000
CVTRV420 EQU   CVTXTNT2+56                                              05503000
CVTRV419 EQU   CVTXTNT2+55                                              05504000
CVTRV418 EQU   CVTXTNT2+54                                              05505000
CVTRV417 EQU   CVTRV409                                                 05506000
CVTRV416 EQU   CVTRV409                                                 05507000
CVTRV415 EQU   CVTRV409                                                 05508000
CVTRV414 EQU   CVTRV409                                                 05509000
CVTRV413 EQU   CVTRV409                                                 05510000
CVTRV412 EQU   CVTRV409                                                 05511000
CVTRV411 EQU   CVTRV409                                                 05512000
CVTRV410 EQU   CVTRV409                                                 05513000
CVTRV408 EQU   CVTRV400                                                 05514000
CVTRV407 EQU   CVTRV400                                                 05515000
CVTRV406 EQU   CVTRV400                                                 05516000
CVTRV405 EQU   CVTRV400                                                 05517000
CVTRV404 EQU   CVTRV400                                                 05518000
CVTRV403 EQU   CVTRV400                                                 05519000
CVTRV402 EQU   CVTRV400                                                 05520000
CVTRV401 EQU   CVTRV400                                                 05521000
CVTICB   EQU   CVTXTNT2+48                                              05522000
CVTSKTA  EQU   CVTXTNT2+44                                              05523000
CVTSHSB  EQU   CVTSHS                                                   05524000
CVTRSV98 EQU   CVTXTNT2+36                                              05525000
CVTRSV97 EQU   CVTXTNT2+34                                              05526000
CVTRSV96 EQU   CVTXTNT2+32                                              05527000
CVTOLTEP EQU   CVTXTNT2+28                                              05528000
CVTQIDA  EQU   CVTQID+1                                                 05529000
CVTRSV95 EQU   CVTQID                                                   05530000
CVTRSV94 EQU   CVTXTNT2+20                                              05531000
CVTRSV93 EQU   CVTXTNT2+16                                              05532000
CVTRSV92 EQU   CVTXTNT2+12                                              05533000
CVTDEBVR EQU   CVTXTNT2+8                                               05534000
CVTRSV91 EQU   CVTXTNT2+6                                               05535000
CVTRSV9H EQU   CVTFLGBT                                                 05536000
CVTRSV9G EQU   CVTFLGBT                                                 05537000
CVTRSV9F EQU   CVTFLGBT                                                 05538000
CVTRSV9E EQU   CVTFLGBT                                                 05539000
CVTRSV9D EQU   CVTFLGBT                                                 05540000
CVTRSV9C EQU   CVTFLGBT                                                 05541000
CVTVME   EQU   CVTFLGBT                                                 05542000
CVTNPE   EQU   CVTFLGBT                                                 05543000
CVTNUCLS EQU   CVTXTNT2+4                                               05544000
CVTDSSVA EQU   CVTDSSV+1                                                05545000
CVTRSV89 EQU   CVTDSSV                                                  05546000
CVTRSV88 EQU   CVTXTNT1+8                                               05547000
CVTRSV87 EQU   CVTXTNT1+4                                               05548000
CVTFACHN EQU   CVTXTNT1                                                 05549000
CVTRV488 EQU   CVTMAP+412                                               05550000
CVTRV487 EQU   CVTMAP+408                                               05551000
CVTRV486 EQU   CVTMAP+404                                               05552000
CVTRV485 EQU   CVTMAP+400                                               05553000
CVTACTAP EQU   CVTMAP+396                                               05554000
CVTAUTH  EQU   CVTMAP+392                                               05555000
CVTATMCA EQU   CVTATMCT+1                                               05556000
CVTATMST EQU   CVTATMCT                                                 05557000
CVTRSV61 EQU   CVTMAP+384                                               05558000
CVTVOLT1 EQU   CVTVOLM1+1                                               05559000
CVTVOLI1 EQU   CVTVOLF1                                                 05560000
CVTSTOA  EQU   CVTMAP+376                                               05561000
CVTRSV58 EQU   CVTMAP+374                                               05562000
CVTRSV57 EQU   CVTMAP+372                                               05563000
CVTDDCE  EQU   CVTMAP+368                                               05564000
CVTPNWFR EQU   CVTMAP+364                                               05565000
CVTSMF   EQU   CVTMAP+360                                               05566000
CVTSULK  EQU   CVTMAP+358                                               05567000
CVTSLKO  EQU   CVTSYSK                                                  05568000
CVTSLKP  EQU   CVTSYSK                                                  05569000
CVTSLKQ  EQU   CVTSYSK                                                  05570000
CVTSLKR  EQU   CVTSYSK                                                  05571000
CVTRSV56 EQU   CVTSYSK                                                  05572000
CVTRSV55 EQU   CVTSYSK                                                  05573000
CVTRSV54 EQU   CVTSYSK                                                  05574000
CVTRSV53 EQU   CVTSYSK                                                  05575000
CVTRSV52 EQU   CVTA1F1                                                  05576000
CVTRSV51 EQU   CVTA1F1                                                  05577000
CVTRSV50 EQU   CVTA1F1                                                  05578000
CVTRSV49 EQU   CVTA1F1                                                  05579000
CVTRSV48 EQU   CVTA1F1                                                  05580000
CVTRSV47 EQU   CVTA1F1                                                  05581000
CVTSRSW  EQU   CVTA1F1                                                  05582000
CVTPFSW  EQU   CVTA1F1                                                  05583000
CVTPCVT  EQU   CVTMAP+352                                               05584000
CVTRSV46 EQU   CVTMAP+344                                               05585000
CVTRSV45 EQU   CVTMAP+340                                               05586000
CVTRSV44 EQU   CVTMAP+338                                               05587000
CVTRSV43 EQU   CVTMAP+336                                               05588000
CVTHJESA EQU   CVTHJES+1                                                05589000
CVTRSV42 EQU   CVTHJES                                                  05590000
CVTEXT2A EQU   CVTEXT2+1                                                05591000
CVTRSV41 EQU   CVTEXT2                                                  05592000
CVTAPFA  EQU   CVTAPF+1                                                 05593000
CVTRSV40 EQU   CVTAPF                                                   05594000
CVTRV518 EQU   CVTINTLA                                                 05595000
CVTRV517 EQU   CVTERPV                                                  05596000
CVTEORM  EQU   CVTMAP+312                                               05597000
CVTMCHPR EQU   CVTMAP+308                                               05598000
CVTTZ    EQU   CVTMAP+304                                               05599000
CVTJEPS  EQU   CVTMAP+300                                               05600000
CVTJESCT EQU   CVTMAP+296                                               05601000
CVTMODE  EQU   CVTMAP+292                                               05602000
CVTPTRV  EQU   CVTMAP+288                                               05603000
CVTREAL  EQU   CVTMAP+284                                               05604000
CVTRSV39 EQU   CVTMAP+280                                               05605000
CVTRSV38 EQU   CVTMAP+276                                               05606000
CVTDMSRA EQU   CVTDMSR+1                                                05607000
CVTRV634 EQU   CVTDMSRF                                                 05608000
CVTRV633 EQU   CVTDMSRF                                                 05609000
CVTRV632 EQU   CVTDMSRF                                                 05610000
CVTRV631 EQU   CVTDMSRF                                                 05611000
CVTRV630 EQU   CVTDMSRF                                                 05612000
CVTRV629 EQU   CVTDMSRF                                                 05613000
CVTUDUMP EQU   CVTDMSRF                                                 05614000
CVTSDUMP EQU   CVTDMSRF                                                 05615000
CVTQMSGA EQU   CVTQMSG+1                                                05616000
CVTRSV36 EQU   CVTQMSG                                                  05617000
CVTAMFF  EQU   CVTMAP+264                                               05618000
CVTPURGA EQU   CVTPURG+1                                                05619000
CVTRSV35 EQU   CVTPURG                                                  05620000
CVTCBSP  EQU   CVTMAP+256                                               05621000
CVTATERA EQU   CVTATER+1                                                05622000
CVTSYST  EQU   CVTATER                                                  05623000
CVTVOLT2 EQU   CVTTAT                                                   05624000
CVTVOLI2 EQU   CVTVOLF2                                                 05625000
CVTAQAVB EQU   CVTAQAVT+1                                               05626000
CVTRSV34 EQU   CVTTCMFG                                                 05627000
CVTRSV33 EQU   CVTTCMFG                                                 05628000
CVTRSV32 EQU   CVTTCMFG                                                 05629000
CVTRSV31 EQU   CVTTCMFG                                                 05630000
CVTRSV30 EQU   CVTTCMFG                                                 05631000
CVTRSV29 EQU   CVTTCMFG                                                 05632000
CVTRSV28 EQU   CVTTCMFG                                                 05633000
CVTTCRDY EQU   CVTTCMFG                                                 05634000
CVTGTFA  EQU   CVTGTF+1                                                 05635000
CVTRSV27 EQU   CVTGTFST                                                 05636000
CVTRNIO  EQU   CVTGTFST                                                 05637000
CVTUSR   EQU   CVTGTFST                                                 05638000
CVTRV318 EQU   CVTFORM                                                  05639000
CVTRV317 EQU   CVTTMODE                                                 05640000
CVTRV316 EQU   CVTSTATE                                                 05641000
CVTRV315 EQU   CVTGTFS                                                  05642000
CVTGTFAV EQU   CVTGTFS                                                  05643000
CVT0SCR1 EQU   CVTMAP+232                                               05644000
CVTRV515 EQU   CVTMAP+228                                               05645000
CVTRMS   EQU   CVTMAP+224                                               05646000
CVTPATCH EQU   CVTMAP+220                                               05647000
CVTTSCE  EQU   CVTMAP+216                                               05648000
CVTLNKSC EQU   CVTMAP+214                                               05649000
CVTQABST EQU   CVTMAP+212                                               05650000
CVTMDLDS EQU   CVTMAP+208                                               05651000
CVTUSER  EQU   CVTMAP+204                                               05652000
CVTABEND EQU   CVTMAP+200                                               05653000
CVTSMCA  EQU   CVTMAP+196                                               05654000
CVTRSV18 EQU   CVTMAP+192                                               05655000
CVTQLPAQ EQU   CVTMAP+188                                               05656000
CVTQCDSR EQU   CVTMAP+184                                               05657000
CVTRSV17 EQU   CVTOPTB                                                  05658000
CVTRSV16 EQU   CVTOPTB                                                  05659000
CVTFP    EQU   CVTOPTB                                                  05660000
CVTAPTHR EQU   CVTOPTB                                                  05661000
CVTNLOG  EQU   CVTOPTB                                                  05662000
CVTTOD   EQU   CVTOPTB                                                  05663000
CVTCTIMS EQU   CVTOPTB                                                  05664000
CVTPROT  EQU   CVTOPTB                                                  05665000
CVTXPFP  EQU   CVTOPTA                                                  05666000
CVTASCII EQU   CVTOPTA                                                  05667000
CVTRSV13 EQU   CVTOPTA                                                  05668000
CVTRSV12 EQU   CVTOPTA                                                  05669000
CVTNIP   EQU   CVTOPTA                                                  05670000
CVTDDR   EQU   CVTOPTA                                                  05671000
CVTAPR   EQU   CVTOPTA                                                  05672000
CVTCCH   EQU   CVTOPTA                                                  05673000
CVTSNCTR EQU   CVTMAP+180                                               05674000
CVTQMWR  EQU   CVTMAP+176                                               05675000
CVTQOCR  EQU   CVTMAP+172                                               05676000
CVT1EF00 EQU   CVTMAP+168                                               05677000
CVTMZ00  EQU   CVTMAP+164                                               05678000
CVTHEAD  EQU   CVTMAP+160                                               05679000
CVTRSV11 EQU   CVTMAP+156                                               05680000
CVT0PT01 EQU   CVTMAP+152                                               05681000
CVTMSER  EQU   CVTMAP+148                                               05682000
CVTRV516 EQU   CVTIERLC                                                 05683000
CVTILCH  EQU   CVTMAP+140                                               05684000
CVT0DS   EQU   CVTMAP+136                                               05685000
CVTFBOSV EQU   CVTMAP+132                                               05686000
CVTNUCB  EQU   CVTMAP+128                                               05687000
CVTIXAVL EQU   CVTMAP+124                                               05688000
CVTIOQET EQU   CVTMAP+120                                               05689000
CVTDCBA  EQU   CVTMAP+117                                               05690000
CVTMVS2  EQU   CVTDCB                                                   05691000
CVT6DAT  EQU   CVTDCB                                                   05692000
CVT4MPS  EQU   CVTDCB                                                   05693000
CVTRSV09 EQU   CVTDCB                                                   05694000
CVT4MS1  EQU   CVTDCB                                                   05695000
CVT2SPS  EQU   CVTDCB                                                   05696000
CVT1SSS  EQU   CVTDCB                                                   05697000
CVTRSV08 EQU   CVTDCB                                                   05698000
CVTSTB   EQU   CVTMAP+112                                               05699000
CVTQTD00 EQU   CVTMAP+108                                               05700000
CVTQTE00 EQU   CVTMAP+104                                               05701000
CVTCUCB  EQU   CVTMAP+100                                               05702000
CVTSJQ   EQU   CVTMAP+96                                                05703000
CVTPBLDL EQU   CVTMAP+92                                                05704000
CVTTPC   EQU   CVTMAP+88                                                05705000
CVTSVDCB EQU   CVTMAP+84                                                05706000
CVTBRET  EQU   CVTMAP+82                                                05707000
CVTEXIT  EQU   CVTMAP+80                                                05708000
CVT0FN00 EQU   CVTMAP+76                                                05709000
CVTDARA  EQU   CVTDAR+1                                                 05710000
CVTRSV07 EQU   CVTFLGS1                                                 05711000
CVTRSV06 EQU   CVTFLGS1                                                 05712000
CVTRSV05 EQU   CVTFLGS1                                                 05713000
CVTRSV04 EQU   CVTFLGS1                                                 05714000
CVTRSV03 EQU   CVTFLGS1                                                 05715000
CVTRSV02 EQU   CVTFLGS1                                                 05716000
CVTRSV01 EQU   CVTFLGS1                                                 05717000
CVTDMPLK EQU   CVTFLGS1                                                 05718000
CVTXITP  EQU   CVTMAP+68                                                05719000
CVTZDTAB EQU   CVTMAP+64                                                05720000
CVTMSLT  EQU   CVTMAP+60                                                05721000
CVTDATE  EQU   CVTMAP+56                                                05722000
CVTBTERM EQU   CVTMAP+52                                                05723000
CVTSYSAD EQU   CVTMAP+48                                                05724000
CVTXTLER EQU   CVTMAP+44                                                05725000
CVTILK2  EQU   CVTMAP+40                                                05726000
CVTILK1  EQU   CVTMAP+36                                                05727000
CVTPRLTV EQU   CVTMAP+32                                                05728000
CVTPCNVT EQU   CVTMAP+28                                                05729000
CVT0VL00 EQU   CVTMAP+24                                                05730000
CVTXAPG  EQU   CVTMAP+20                                                05731000
CVTBUF   EQU   CVTMAP+16                                                05732000
CVTJOB   EQU   CVTMAP+12                                                05733000
CVTLINK  EQU   CVTMAP+8                                                 05734000
CVT0EF00 EQU   CVTMAP+4                                                 05735000
CVTTCBP  EQU   CVTMAP                                                   05736000
CVT      EQU   CVTMAP                                                   05737000
@NM00052 EQU   PSA+3668                                                 05738000
PSASTAK  EQU   PSA+3072                                                 05739000
@NM00051 EQU   PSA+1048                                                 05740000
PSAUSEND EQU   PSA+1048                                                 05741000
PSARV062 EQU   PSA+1044                                                 05742000
PSACDAL  EQU   PSA+1040                                                 05743000
PSAWTCOD EQU   PSA+1036                                                 05744000
PSAATCVT EQU   PSA+1032                                                 05745000
PSAPCPSW EQU   PSA+1024                                                 05746000
PSAPIR2  EQU   PSA+1020                                                 05747000
PSARV059 EQU   PSA+1018                                                 05748000
PSASVC13 EQU   PSA+1016                                                 05749000
PSALSFCC EQU   PSA+1012                                                 05750000
PSASFACC EQU   PSA+1008                                                 05751000
PSASTOP  EQU   PSA+992                                                  05752000
PSASTART EQU   PSA+976                                                  05753000
PSARSPSW EQU   PSA+968                                                  05754000
PSASRPSW EQU   PSA+960                                                  05755000
PSARV045 EQU   PSA+892                                                  05756000
PSARV044 EQU   PSA+888                                                  05757000
PSARV043 EQU   PSA+884                                                  05758000
PSARV042 EQU   PSA+880                                                  05759000
PSARV041 EQU   PSA+876                                                  05760000
PSARV040 EQU   PSA+872                                                  05761000
PSARV025 EQU   PSA+868                                                  05762000
PSADSSED EQU   PSA+868                                                  05763000
PSADSSPR EQU   PSA+864                                                  05764000
PSADSSFW EQU   PSA+860                                                  05765000
PSADSS14 EQU   PSA+856                                                  05766000
PSADSSPP EQU   PSA+848                                                  05767000
PSADSSRP EQU   PSA+840                                                  05768000
PSADSS05 EQU   PSADSSF4                                                 05769000
PSADSS10 EQU   PSADSSF4                                                 05770000
PSADSSVE EQU   PSADSSF4                                                 05771000
PSADSSDE EQU   PSADSSF4                                                 05772000
PSADSSC0 EQU   PSADSSF4                                                 05773000
PSADSSIE EQU   PSADSSF4                                                 05774000
PSADSS12 EQU   PSADSSF4                                                 05775000
PSADSSRC EQU   PSADSSF4                                                 05776000
PSARV057 EQU   PSADSSF3                                                 05777000
PSARV056 EQU   PSADSSF3                                                 05778000
PSARV055 EQU   PSADSSF3                                                 05779000
PSADSSMC EQU   PSADSSF3                                                 05780000
PSADSSRW EQU   PSADSSF3                                                 05781000
PSADSSNM EQU   PSADSSF3                                                 05782000
PSADSSES EQU   PSADSSF3                                                 05783000
PSADSSGP EQU   PSADSSF3                                                 05784000
PSADSSF2 EQU   PSADSSFL+1                                               05785000
PSADSSPI EQU   PSADSSF1                                                 05786000
PSADSSOI EQU   PSADSSF1                                                 05787000
PSADSSSP EQU   PSADSSF1                                                 05788000
PSADSSTP EQU   PSADSSF1                                                 05789000
PSADSSDW EQU   PSADSSF1                                                 05790000
PSADSSDD EQU   PSADSSF1                                                 05791000
PSADSSDM EQU   PSADSSF1                                                 05792000
PSADSSMV EQU   PSADSSF1                                                 05793000
PSADSSTS EQU   PSA+816                                                  05794000
PSADSSWK EQU   PSA+812                                                  05795000
PSADSSR3 EQU   PSA+808                                                  05796000
PSADSSR2 EQU   PSA+804                                                  05797000
PSADSSRS EQU   PSA+800                                                  05798000
PSASTOR  EQU   PSA+796                                                  05799000
PSACPUSA EQU   PSA+794                                                  05800000
PSAVSTAP EQU   PSA+792                                                  05801000
PSAWKVAP EQU   PSA+788                                                  05802000
PSAWKRAP EQU   PSA+784                                                  05803000
PSAMCHIC EQU   PSA+783                                                  05804000
PSARV061 EQU   PSA+782                                                  05805000
PSASYMSK EQU   PSA+781                                                  05806000
PSAMCHFL EQU   PSA+780                                                  05807000
PSACR0   EQU   PSA+776                                                  05808000
PSAPSWSV EQU   PSA+768                                                  05809000
PSALITA  EQU   PSA+764                                                  05810000
PSACLHS  EQU   PSAHLHI                                                  05811000
PSALKR15 EQU   PSALKSA+60                                               05812000
PSALKR14 EQU   PSALKSA+56                                               05813000
PSALKR13 EQU   PSALKSA+52                                               05814000
PSALKR12 EQU   PSALKSA+48                                               05815000
PSALKR11 EQU   PSALKSA+44                                               05816000
PSALKR10 EQU   PSALKSA+40                                               05817000
PSALKR9  EQU   PSALKSA+36                                               05818000
PSALKR8  EQU   PSALKSA+32                                               05819000
PSALKR7  EQU   PSALKSA+28                                               05820000
PSALKR6  EQU   PSALKSA+24                                               05821000
PSALKR5  EQU   PSALKSA+20                                               05822000
PSALKR4  EQU   PSALKSA+16                                               05823000
PSALKR3  EQU   PSALKSA+12                                               05824000
PSALKR2  EQU   PSALKSA+8                                                05825000
PSALKR1  EQU   PSALKSA+4                                                05826000
PSALKR0  EQU   PSALKSA                                                  05827000
PSARV023 EQU   PSACLHT+52                                               05828000
PSALOCAL EQU   PSACLHT+48                                               05829000
PSACMSL  EQU   PSACLHT+44                                               05830000
PSAOPTL  EQU   PSACLHT+40                                               05831000
PSATPACL EQU   PSACLHT+36                                               05832000
PSATPDNL EQU   PSACLHT+32                                               05833000
PSATPNCL EQU   PSACLHT+28                                               05834000
PSAIOSLL EQU   PSACLHT+24                                               05835000
PSAIOSUL EQU   PSACLHT+20                                               05836000
PSAIOSCL EQU   PSACLHT+16                                               05837000
PSAIOSSL EQU   PSACLHT+12                                               05838000
PSASALCL EQU   PSACLHT+8                                                05839000
PSAASML  EQU   PSACLHT+4                                                05840000
PSADISPL EQU   PSACLHT                                                  05841000
PSASRSA  EQU   PSA+636                                                  05842000
PSARV050 EQU   PSA+634                                                  05843000
PSADSSGO EQU   PSA+633                                                  05844000
PSARECUR EQU   PSA+632                                                  05845000
PSAHLHIS EQU   PSA+628                                                  05846000
PSAIPCSA EQU   PSA+624                                                  05847000
@NM00050 EQU   PSA+621                                                  05848000
PSAIPCDM EQU   PSA+620                                                  05849000
PSAIPCD  EQU   PSA+616                                                  05850000
@NM00049 EQU   PSA+613                                                  05851000
PSAIPCRM EQU   PSA+612                                                  05852000
PSAIPCR  EQU   PSA+608                                                  05853000
PSAMCHEX EQU   PSA+600                                                  05854000
PSAMPSW  EQU   PSA+592                                                  05855000
PSAEXPS2 EQU   PSA+584                                                  05856000
PSAEXPS1 EQU   PSA+576                                                  05857000
PSAPIREG EQU   PSA+572                                                  05858000
PSARSREG EQU   PSA+568                                                  05859000
PSAGPREG EQU   PSA+556                                                  05860000
PSARV022 EQU   PSASUP4                                                  05861000
PSARV021 EQU   PSASUP4                                                  05862000
PSARV020 EQU   PSASUP4                                                  05863000
PSARV019 EQU   PSASUP4                                                  05864000
PSARV018 EQU   PSASUP4                                                  05865000
PSARV017 EQU   PSASUP4                                                  05866000
PSARV016 EQU   PSASUP4                                                  05867000
PSARV015 EQU   PSASUP4                                                  05868000
PSARV014 EQU   PSASUP3                                                  05869000
PSARV013 EQU   PSASUP3                                                  05870000
PSARV012 EQU   PSASUP3                                                  05871000
PSARV011 EQU   PSASUP3                                                  05872000
PSASPR   EQU   PSASUP3                                                  05873000
PSAPSREG EQU   PSASUP3                                                  05874000
PSAPI2   EQU   PSASUP3                                                  05875000
PSAIOSUP EQU   PSASUP3                                                  05876000
PSALCR   EQU   PSASUP2                                                  05877000
PSARTM   EQU   PSASUP2                                                  05878000
PSAACR   EQU   PSASUP2                                                  05879000
PSAIPCE2 EQU   PSASUP2                                                  05880000
PSAIPCES EQU   PSASUP2                                                  05881000
PSAIPCEC EQU   PSASUP2                                                  05882000
PSAGTF   EQU   PSASUP2                                                  05883000
PSAIPCRI EQU   PSASUP2                                                  05884000
PSARV063 EQU   PSASUP1                                                  05885000
PSATCTL  EQU   PSASUP1                                                  05886000
PSADISP  EQU   PSASUP1                                                  05887000
PSALOCK  EQU   PSASUP1                                                  05888000
PSAPI    EQU   PSASUP1                                                  05889000
PSAEXT   EQU   PSASUP1                                                  05890000
PSASVC   EQU   PSASUP1                                                  05891000
PSAIO    EQU   PSASUP1                                                  05892000
PSAANEW  EQU   PSA+544                                                  05893000
PSATOLD  EQU   PSA+540                                                  05894000
PSATNEW  EQU   PSA+536                                                  05895000
PSALCCAR EQU   PSA+532                                                  05896000
PSALCCAV EQU   PSA+528                                                  05897000
PSAPCCAR EQU   PSA+524                                                  05898000
PSAPCCAV EQU   PSA+520                                                  05899000
PSACPULA EQU   PSA+518                                                  05900000
PSACPUPA EQU   PSA+516                                                  05901000
PSAPSA   EQU   PSA+512                                                  05902000
FLCHDEND EQU   PSA+512                                                  05903000
FLCCRSAV EQU   FLCMCLA+280                                              05904000
FLCGRSAV EQU   FLCMCLA+216                                              05905000
FLCFPSAV EQU   FLCMCLA+184                                              05906000
FLCFLA   EQU   FLCMCLA+88                                               05907000
FLCRGNCD EQU   FLCMCLA+84                                               05908000
FLCFSAA  EQU   FLCFSA+1                                                 05909000
@NM00048 EQU   FLCFSA                                                   05910000
@NM00047 EQU   FLCMCLA+72                                               05911000
FLCMCIC  EQU   FLCMCLA+64                                               05912000
@NM00046 EQU   FLCMCLA+20                                               05913000
FLCIOAA  EQU   FLCIOA+1                                                 05914000
@NM00045 EQU   FLCIOA                                                   05915000
@NM00044 EQU   FLCMCLA+15                                               05916000
@NM00043 EQU   FLCMCLA+14                                               05917000
@NM00042 EQU   FLCMCLA+12                                               05918000
FLCLCL   EQU   FLCMCLA+8                                                05919000
FLCIOELA EQU   FLCIOEL+1                                                05920000
@NM00041 EQU   FLCIOEL                                                  05921000
FLCCHNID EQU   FLCMCLA                                                  05922000
@NM00040 EQU   PSA+160                                                  05923000
FLCMTRCD EQU   PSA+157                                                  05924000
@NM00039 EQU   PSA+156                                                  05925000
FLCPERA  EQU   FLCPER+1                                                 05926000
@NM00038 EQU   FLCPER                                                   05927000
@NM00037 EQU   PSA+151                                                  05928000
FLCPERCD EQU   PSA+150                                                  05929000
FLCMCNUM EQU   PSA+149                                                  05930000
@NM00036 EQU   PSA+148                                                  05931000
FLCTEAA  EQU   FLCTEA+1                                                 05932000
@NM00035 EQU   FLCTEA                                                   05933000
PSAPIPC  EQU   PSAPICOD                                                 05934000
PSAPIMC  EQU   PSAPICOD                                                 05935000
PSAPIPER EQU   PSAPICOD                                                 05936000
PSARV049 EQU   FLCPICOD                                                 05937000
FLCPILCB EQU   FLCPIILC                                                 05938000
@NM00034 EQU   FLCPIILC                                                 05939000
@NM00033 EQU   PSAEPPSW                                                 05940000
FLCSVCN  EQU   PSAESPSW+2                                               05941000
FLCSILCB EQU   FLCSVILC                                                 05942000
@NM00032 EQU   FLCSVILC                                                 05943000
@NM00031 EQU   PSAESPSW                                                 05944000
FLCEICOD EQU   PSAEEPSW+2                                               05945000
PSASPAD  EQU   PSAEEPSW                                                 05946000
@NM00030 EQU   PSA+128                                                  05947000
FLCINPSW EQU   PSA+120                                                  05948000
FLCMNPSW EQU   PSA+112                                                  05949000
FLCPNPSW EQU   PSA+104                                                  05950000
FLCSNPSW EQU   PSA+96                                                   05951000
FLCENPSW EQU   PSA+88                                                   05952000
FLCTRACE EQU   PSA+84                                                   05953000
FLCTIMER EQU   PSA+80                                                   05954000
FLCCVT2  EQU   PSA+76                                                   05955000
FLCCAW   EQU   PSA+72                                                   05956000
FLCCSW   EQU   PSA+64                                                   05957000
FLCIOPSW EQU   PSA+56                                                   05958000
FLCMOPSW EQU   PSA+48                                                   05959000
FLCPOPSW EQU   PSA+40                                                   05960000
FLCSOPSW EQU   PSA+32                                                   05961000
FLCEOPSW EQU   PSA+24                                                   05962000
@NM00029 EQU   FLCICCW2+4                                               05963000
FLCICCW1 EQU   FLCROPSW                                                 05964000
FLCIPPSW EQU   FLCRNPSW                                                 05965000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05966000
@RC00133 EQU   @EL00006                                                 05967000
@RC00163 EQU   @RC00162                                                 05968000
@RC00183 EQU   @RC00170                                                 05969000
@RC00171 EQU   @RC00170                                                 05970000
@RC00307 EQU   @RC00304                                                 05971000
@RC00305 EQU   @RC00304                                                 05972000
@RC00490 EQU   @RC00489                                                 05973000
@RC00455 EQU   @RC00434                                                 05974000
@RT00614 EQU   @RC00611                                                 05975000
@RC00636 EQU   @EL00017                                                 05976000
@RC00634 EQU   @EL00017                                                 05977000
@RC00734 EQU   @RC00729                                                 05978000
@RT00771 EQU   @EL00018                                                 05979000
@RC00795 EQU   @RC00779                                                 05980000
@RT00828 EQU   @RC00820                                                 05981000
@RC00821 EQU   @RC00820                                                 05982000
@RC00776 EQU   @EL00019                                                 05983000
@RC00839 EQU   @EL00020                                                 05984000
@RC00905 EQU   @EL00021                                                 05985000
@RC00903 EQU   @EL00021                                                 05986000
@RC00958 EQU   @EL00023                                                 05987000
@PB00024 EQU   @EL00001                                                 05988000
@RC00174 EQU   @RC00171                                                 05989000
@RC00458 EQU   @RC00455                                                 05990000
@RC00735 EQU   @RC00734                                                 05991000
@RT00822 EQU   @RC00821                                                 05992000
@PB00023 EQU   @PB00024                                                 05993000
@PB00022 EQU   @PB00023                                                 05994000
@PB00021 EQU   @PB00022                                                 05995000
@PB00020 EQU   @PB00021                                                 05996000
@PB00019 EQU   @PB00020                                                 05997000
@PB00018 EQU   @PB00019                                                 05998000
@PB00017 EQU   @PB00018                                                 05999000
@PB00016 EQU   @PB00017                                                 06000000
@PB00015 EQU   @PB00016                                                 06001000
@PB00014 EQU   @PB00015                                                 06002000
@PB00013 EQU   @PB00014                                                 06003000
@PB00012 EQU   @PB00013                                                 06004000
@PB00011 EQU   @PB00012                                                 06005000
@PB00010 EQU   @PB00011                                                 06006000
@PB00009 EQU   @PB00010                                                 06007000
@PB00008 EQU   @PB00009                                                 06008000
@PB00007 EQU   @PB00008                                                 06009000
@PB00006 EQU   @PB00007                                                 06010000
@PB00005 EQU   @PB00006                                                 06011000
@PB00004 EQU   @PB00005                                                 06012000
@PB00003 EQU   @PB00004                                                 06013000
@PB00002 EQU   @PB00003                                                 06014000
@ENDDATA EQU   *                                                        06015000
         END   IKT3270O,(C'PLS2005',0701,78045)                         06016000
