         TITLE 'IKTQMNGR: TSO/VTAM QUEUE MANAGER                       *00001000
                        '                                               00002000
IKTQMIN  CSECT ,                                                        00003000
MAINENT  DS    0H                                                       00004000
         USING *,R15                                                    00005000
         B     SAVEIT                                                   00006000
         DC    AL2(EP0001-MAINENT)                                      00007000
         DC    AL1(16)                                                  00008000
         DC    C'IKTQMNGR  76.026'                                      00009000
IKTQMOUT DS    0H                                                       00010000
         USING *,R15                                                    00011000
         B     SAVEIT                                                   00012000
         DC    AL2(EP0002-IKTQMOUT)                                     00013000
         ENTRY IKTQMOUT                                                 00014000
IKTQMFR1 DS    0H                                                       00015000
         USING *,R15                                                    00016000
         B     PROLOG                                                   00017000
         DC    AL2(EP0003-IKTQMFR1)                                     00018000
         ENTRY IKTQMFR1                                                 00019000
IKTQMEV  DS    0H                                                       00020000
         STM   R0,R14,4(R1)                                             00021000
         BALR 15,0            ADJUST ADDRESS FOR ENTRY                  00022000
         USING *,15                                                     00023000
IKTQMEV1 B     PROLOG                                                   00024000
         DC    AL2(EP0004-IKTQMEV1)                                     00025000
         ENTRY IKTQMEV                                                  00026000
IKTQMFR2 DS    0H                                                       00027000
         USING *,R15                                                    00028000
         B     PROLOG                                                   00029000
         DC    AL2(EP0005-IKTQMFR2)                                     00030000
         ENTRY IKTQMFR2                                                 00031000
         DROP  R15                                                      00032000
SAVEIT   STM   R14,R12,12(R13) SAVE CALLERS REGS                        00033000
PROLOG   BALR  R12,0                                                    00034000
PSTART   DS    0H                                                       00035000
         USING PSTART,R12                                               00036000
         L     R10,ASCBPTR            SET UP ADDRESSABILITY TO          00037000
         L     R10,ASCBTSB(,R10)      THE TVWA                          00038000
         L     R10,TSBEXTNT(,R10)                                       00039000
         L     TVWAPTR,TSBXTVWA(,R10)                                   00040000
         AH    R15,4(,R15)                                              00041000
         BR    R15                                                      00042000
         EJECT                                                          00043000
EP0001   DS    0H                                                       00044000
*   DATARG=TVWAQMWA;                /* PUT @ OF WORKAREA IN THE    0059 00045000
*                                      DATAREG                       */ 00046000
         L     DATARG,TVWAQMWA(,TVWAPTR)                           0059 00047000
*   GEN REFS(DATARG) SETS(R13);                                    0060 00048000
        USING @DATD,DATARG       ESTABLISH ADDRESSABILITY TO WORK AREA  00049000
        MVC   @PC00001(4),0(@01) SAVE POINTER TO PARAMETER LIST         00050000
        ST    @13,@SA00001+4     SAVE ADDRESS OF CALLERS SAVE AREA      00051000
        LA    @13,@SA00001       LOAD ADDRESS OF MY SAVE AREA           00052000
*   PARMS=IPARMS;                   /* MAKE A LOCAL COPY OF PARM LIST*/ 00053000
         L     @10,@PC00001                                        0061 00054000
         MVC   PARMS(20),IPARMS(@10)                               0061 00055000
*   IF PREQ>0&PREQ<=INFUNC THEN     /* IS THIS A PROPER REQUEST CODE */ 00056000
         CLI   PREQ,0                                              0062 00057000
         BNH   @RF00062                                            0062 00058000
         CLI   PREQ,7                                              0062 00059000
         BH    @RF00062                                            0062 00060000
*     DO;                                                          0063 00061000
*       RFY                                                        0064 00062000
*         R0 RSTD;                                                 0064 00063000
*       R0=ADDR(IKTQMFR1);                                         0065 00064000
         L     R0,@CA02138                                         0065 00065000
*       GEN REFS(R0,PSACSTK,PSA,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,   0066 00066000
*           FRRSELEN,FRRSFRRA,FRRSENTR) SETS(R2,R14,R15);          0066 00067000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2    SAVE CALLERS KEY   00068000
        SETFRR  A,FRRAD=(R0),WRKREGS=(R14,R15)                          00069000
        MODESET KEYADDR=(2)                     RETURN TO CALLERS KEY   00070000
*       RFY                                                        0067 00071000
*         R0 UNRSTD;                                               0067 00072000
*       TVWAQMIO='0'B;              /* INPUT SERVICES BEING USED     */ 00073000
         NI    TVWAQMIO(TVWAPTR),B'11110111'                       0068 00074000
*/********************************************************************/ 00075000
*/*          CASE MACRO USED TO BRANCH TO PROPER SERVICE ROUTINE     */ 00076000
*/********************************************************************/ 00077000
*                                                                  0069 00078000
*BRAN:                                                             0069 00079000
*       DO;                         /* BRAN:CASE(PREQ)NAMES(ADDEL,OBT   00080000
*                                      AIN,DELIN,UPDATE,CLEARI,DELBK,   00081000
*                                      MARKAVBL)                     */ 00082000
BRAN     DS    0H                                                  0070 00083000
*         DCL                                                      0070 00084000
*           CL0001@ LABEL BASED(CP0001@(PREQ)) VALUERANGE(ADDEL,OBTAIN, 00085000
*               DELIN,UPDATE,CLEARI,DELBK,MARKAVBL);/* BRANCH TARGET */ 00086000
*         DCL                                                      0071 00087000
*           CP0001@(7) PTR(31) INIT(ADDR(ADDEL),ADDR(OBTAIN),ADDR(DELIN 00088000
*               ),ADDR(UPDATE),ADDR(CLEARI),ADDR(DELBK),ADDR(MARKAVBL)) 00089000
*             ;                                                    0071 00090000
*         GOTO CL0001@;             /* BRANCH TO SELECTED CASE       */ 00091000
         SLR   @10,@10                                             0072 00092000
         IC    @10,PREQ                                            0072 00093000
         SLA   @10,2                                               0072 00094000
         L     @10,CP0001@-4(@10)                                  0072 00095000
         BR    @10                                                 0072 00096000
         EJECT                                                          00097000
*                                                                  0073 00098000
*/********************************************************************/ 00099000
*/*                                                                  */ 00100000
*/* INPUT TO ADDEL:                                                  */ 00101000
*/*      REQUEST CODE = 1                                            */ 00102000
*/*      FLAGS        = THE FLAGS THE CALLER WANTS SET               */ 00103000
*/*      BUFFER SIZE  = THE MESSAGE LENGTH                           */ 00104000
*/* OUTPUT FROM ADDEL:                                               */ 00105000
*/*      RETURN CODE  = 1 => SUCCESSFUL                              */ 00106000
*/*                   = 2 => UNSUCCESSFUL, NO MORE ROOM FOR ELEMENTS */ 00107000
*/*      BUFFER ADDRESS= ADDRESS AT WHICH CALLER SHOULD PLACE THE    */ 00108000
*/*                      MESSAGE                                     */ 00109000
*/*                                                                  */ 00110000
*/********************************************************************/ 00111000
*                                                                  0073 00112000
*ADDEL:                                                            0073 00113000
*         DO;                       /* SUBCASE ADD AN ELEMENT TO THE    00114000
*                                      INPUT QUEUE                   */ 00115000
ADDEL    DS    0H                                                  0074 00116000
*           RFY                                                    0074 00117000
*             IQELE BASED(TVWAEIQ); /* USE TVWAEIQ AS QUEUE PTR      */ 00118000
*           QPTR1=ADDR(TVWABIQ);    /* PASS @ OF INPUT PTRS. TO    0075 00119000
*                                      BLDELE                        */ 00120000
         LA    QPTR1,TVWABIQ(,TVWAPTR)                             0075 00121000
*           CALL BLDELE;            /* CALL BLDELE TO BUILD AND CHAIN   00122000
*                                      ELE                           */ 00123000
         BAL   @14,BLDELE                                          0076 00124000
*           RFY                                                    0077 00125000
*             R15 RSTD;                                            0077 00126000
*           IF R15=0 THEN           /* IF BLDELE WAS SUCCESSFUL      */ 00127000
         LTR   R15,R15                                             0078 00128000
         BNZ   @RF00078                                            0078 00129000
*             DO;                                                  0079 00130000
*               IF IQAVBL='1'B THEN /* IF THIS LAST ELEMENT IS NOW 0080 00131000
*                                      MARKED AVAILABLE              */ 00132000
         L     @14,TVWAEIQ(,TVWAPTR)                               0080 00133000
         TM    IQAVBL(@14),B'10000000'                             0080 00134000
         BNO   @RF00080                                            0080 00135000
*                 DO;               /* MARK PREVIOUS ELEMENTS      0081 00136000
*                                      AVAILABLE IF THEY ARE       0081 00137000
*                                      UNAVAILABLE                   */ 00138000
*                   TEMP1=IQPREV;   /* SET TEMPORARY PTR TO PREVIOUS    00139000
*                                      ELE.                          */ 00140000
         L     TEMP1,IQPREV(,@14)                                  0082 00141000
*                   DO WHILE(TEMP1^=0&/* DO WHILE MORE IS ON QUEUE 0083 00142000
*                                      AND                           */ 00143000
*                         TEMP1->IQAVBL='0'B);/* ELEMENTS ARE MARKED    00144000
*                                      UNAVAILABLE                   */ 00145000
         B     @DE00083                                            0083 00146000
@DL00083 DS    0H                                                  0084 00147000
*                     TEMP1->IQAVBL='1'B;/* MARK THIS MESSAGE      0084 00148000
*                                      AVAILABLE                     */ 00149000
         OI    IQAVBL(TEMP1),B'10000000'                           0084 00150000
*                     TEMP1=TEMP1->IQPREV;/* SET TEMPORARY TO      0085 00151000
*                                      PREVIOUS ELEMENT              */ 00152000
         L     TEMP1,IQPREV(,TEMP1)                                0085 00153000
*                   END;                                           0086 00154000
@DE00083 LTR   TEMP1,TEMP1                                         0086 00155000
         BZ    @DC00083                                            0086 00156000
         TM    IQAVBL(TEMP1),B'10000000'                           0086 00157000
         BZ    @DL00083                                            0086 00158000
@DC00083 DS    0H                                                  0087 00159000
*                 END;                                             0087 00160000
*               PRC=1;              /* SET RC TO 'SUCCESSFUL ADD'    */ 00161000
@RF00080 MVI   PRC,X'01'                                           0088 00162000
*             END;                                                 0089 00163000
*           ELSE                    /* IF BLDELE NOT SUCCESSFUL      */ 00164000
*             PRC=2;                /* SET RC TO 'OUT OF STORAGE'    */ 00165000
         B     @RC00078                                            0090 00166000
@RF00078 MVI   PRC,X'02'                                           0090 00167000
*           RFY                                                    0091 00168000
*             R15 UNRSTD;                                          0091 00169000
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */ 00170000
         B     CE0001@                                             0092 00171000
*         END ADDEL;                /* END OF SUBCASE                */ 00172000
         EJECT                                                          00173000
*                                                                  0094 00174000
*/********************************************************************/ 00175000
*/*                                                                  */ 00176000
*/* INPUT TO OBTAIN:                                                 */ 00177000
*/*      REQUEST CODE = 2                                            */ 00178000
*/* OUTPUT FROM OBTAIN:                                              */ 00179000
*/*      RETURN CODE  = 1 => SUCCESSFUL, MORE MESSAGES ON QUEUE      */ 00180000
*/*                   = 2 => SUCCESSFUL, NO MORE MESSAGES ON QUEUE   */ 00181000
*/*                   = 3 => UNSUCCESSFUL, NOTHING ON QUEUE          */ 00182000
*/*      BUFFER ADDRESS= ADDRESS OF FIRST BYTE OF MESSAGE            */ 00183000
*/*      BUFFER SIZE  = SIZE (IN BYTES) OF MESSAGE                   */ 00184000
*/*      FLAGS        = THE QUEUE ELEMENT FLAGS                      */ 00185000
*/*                                                                  */ 00186000
*/********************************************************************/ 00187000
*                                                                  0094 00188000
*OBTAIN:                                                           0094 00189000
*         DO;                       /* SUBCASE GET THE NEXT MESSAGE     00190000
*                                      AND THE FOLLOWING MESSAGE SIZE   00191000
*                                      AND FLAGS                     */ 00192000
OBTAIN   DS    0H                                                  0095 00193000
*           RFY                                                    0095 00194000
*             IQELE BASED(TVWANIM); /* USE TVWANIM AS QUEUE ELEMENT     00195000
*                                      PTR                           */ 00196000
*           IF(TVWANIM=0|           /* IF THERE IS NOTHING TO OBTAIN    00197000
*                                      OR                            */ 00198000
*               IQAVBL='0'B) THEN   /* IF THERE IS NOTHING AVAILABLE */ 00199000
         L     @10,TVWANIM(,TVWAPTR)                               0096 00200000
         LTR   @10,@10                                             0096 00201000
         BZ    @RT00096                                            0096 00202000
         TM    IQAVBL(@10),B'10000000'                             0096 00203000
         BNZ   @RF00096                                            0096 00204000
@RT00096 DS    0H                                                  0097 00205000
*             PRC=3;                /* SET RC TO 'NOTHING TO BE    0097 00206000
*                                      OBTAINED'                     */ 00207000
         MVI   PRC,X'03'                                           0097 00208000
*           ELSE                    /* IF THERE IS SOMETHING       0098 00209000
*                                      AVAILABLE                     */ 00210000
*             DO;                                                  0098 00211000
         B     @RC00096                                            0098 00212000
@RF00096 DS    0H                                                  0099 00213000
*               PBUFADR=IQ@CURR+TVWANIM;/* SET BUFFER ADDRESS        */ 00214000
         L     @10,TVWANIM(,TVWAPTR)                               0099 00215000
         LH    @07,IQ@CURR(,@10)                                   0099 00216000
         LR    @15,@07                                             0099 00217000
         ALR   @15,@10                                             0099 00218000
         ST    @15,PBUFADR                                         0099 00219000
*               PBFSZ=IQNBQE-IQ@CURR;/* SET BUFFER SIZE              */ 00220000
         LCR   @07,@07                                             0100 00221000
         LH    @15,IQNBQE(,@10)                                    0100 00222000
         N     @15,@CF02260                                        0100 00223000
         ALR   @07,@15                                             0100 00224000
         STH   @07,PBFSZ                                           0100 00225000
*               PFLAGS=IQFLAGS;     /* SET BUFFER FLAGS              */ 00226000
         MVC   PFLAGS(4),IQFLAGS(@10)                              0101 00227000
*               TVWANIM=IQNEXT;     /* SET POINTER TO NEXT MESSAGE   */ 00228000
         L     @10,IQNEXT(,@10)                                    0102 00229000
         ST    @10,TVWANIM(,TVWAPTR)                               0102 00230000
*               IF(TVWANIM=0|IQAVBL='0'B) THEN/* IF ANYTHING LEFT FOR   00231000
*                                      OBTAINING                     */ 00232000
         LTR   @10,@10                                             0103 00233000
         BZ    @RT00103                                            0103 00234000
         TM    IQAVBL(@10),B'10000000'                             0103 00235000
         BNZ   @RF00103                                            0103 00236000
@RT00103 DS    0H                                                  0104 00237000
*                 PRC=2;            /* SET RC TO 'THIS IS LAST     0104 00238000
*                                      ELEMENT'                      */ 00239000
         MVI   PRC,X'02'                                           0104 00240000
*               ELSE                /* IF THERE IS SOMETHING LEFT    */ 00241000
*                 DO;                                              0105 00242000
         B     @RC00103                                            0105 00243000
@RF00103 DS    0H                                                  0106 00244000
*                   PRC=1;          /* SET RC TO 'THERE IS MORE ON 0106 00245000
*                                      QUEUE'                        */ 00246000
         MVI   PRC,X'01'                                           0106 00247000
*                   PNXBFSZ=IQNBQE-IQ@CURR;/* SET NEXT BUFFER SIZE   */ 00248000
         L     @10,TVWANIM(,TVWAPTR)                               0107 00249000
         LH    @07,IQNBQE(,@10)                                    0107 00250000
         N     @07,@CF02260                                        0107 00251000
         SH    @07,IQ@CURR(,@10)                                   0107 00252000
         STH   @07,PNXBFSZ                                         0107 00253000
*                   PNXFLGS=IQFLAGS;/* SET NEXT FLAGS                */ 00254000
         MVC   PNXFLGS(4),IQFLAGS(@10)                             0108 00255000
*                 END;                                             0109 00256000
*             END;                                                 0110 00257000
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */ 00258000
         B     CE0001@                                             0111 00259000
*         END OBTAIN;               /* END OF SUBCASE                */ 00260000
         EJECT                                                          00261000
*                                                                  0113 00262000
*/********************************************************************/ 00263000
*/*                                                                  */ 00264000
*/* INPUT TO DELIN:                                                  */ 00265000
*/*      REQUEST CODE = 3                                            */ 00266000
*/* OUTPUT FROM DELIN:                                               */ 00267000
*/*      RETURN CODE  = 1 => SUCCESSFUL DELETE, MORE MESSAGES ON     */ 00268000
*/*                          QUEUE TO BE OBTAINED                    */ 00269000
*/*                   = 2 => SUCCESSFUL DELETE, NO MORE MESSAGES ON  */ 00270000
*/*                          QUEUE                                   */ 00271000
*/*                                                                  */ 00272000
*/********************************************************************/ 00273000
*                                                                  0113 00274000
*DELIN:                                                            0113 00275000
*         DO;                       /* SUBCASE REMOVE ALL PREVIOUSLY    00276000
*                                      OBTAIN'D MESSAGES FROM THE  0113 00277000
*                                      QUEUE                         */ 00278000
DELIN    DS    0H                                                  0114 00279000
*           RFY                                                    0114 00280000
*             R1 RSTD;                                             0114 00281000
*           QPTR2=ADDR(TVWABIQ);    /* PASS @ OF INPUT PTRS TO DELEL */ 00282000
         LA    QPTR2,TVWABIQ(,TVWAPTR)                             0115 00283000
*           DO WHILE TVWABIQ^=TVWANIM;/* WHILE THERE ARE ELEMENTS TO    00284000
*                                      BE DELETED                    */ 00285000
         B     @DE00116                                            0116 00286000
@DL00116 DS    0H                                                  0117 00287000
*             R1=TVWABIQ;           /* PUT ADDRESS OF FIRST IN REG 1 */ 00288000
         L     R1,TVWABIQ(,TVWAPTR)                                0117 00289000
*/* ADDRESS OF ELEMENT TO BE DELETED IS PASSED TO DELEL IN REG 1     */ 00290000
*                                                                  0118 00291000
*             CALL DELEL;           /* TO UNCHAIN THIS QUEUE ELEMENT    00292000
*                                      AND FREE ASSOCIATED STORAGE   */ 00293000
         BAL   @14,DELEL                                           0118 00294000
*           END;                                                   0119 00295000
@DE00116 L     @10,TVWABIQ(,TVWAPTR)                               0119 00296000
         C     @10,TVWANIM(,TVWAPTR)                               0119 00297000
         BNE   @DL00116                                            0119 00298000
*           RFY                                                    0120 00299000
*             R1 UNRSTD;                                           0120 00300000
*           IF TVWABIQ=0 THEN       /* IF THERE IS NOTHING LEFT ON 0121 00301000
*                                      QUEUE                         */ 00302000
         LTR   @10,@10                                             0121 00303000
         BNZ   @RF00121                                            0121 00304000
*             PRC=2;                /* SET RETURN CODE TO 2          */ 00305000
         MVI   PRC,X'02'                                           0122 00306000
*           ELSE                                                   0123 00307000
*             DO;                                                  0123 00308000
         B     @RC00121                                            0123 00309000
@RF00121 DS    0H                                                  0124 00310000
*               PRC=1;              /* SET RETURN CODE TO 1          */ 00311000
         MVI   PRC,X'01'                                           0124 00312000
*               TVWABIQ->IQ@STRT=TVWABIQ->IQ@CURR;/* DELETE A PORTION   00313000
*                                      OF A PREVIOUSLY OBTAINED QUEUE   00314000
*                                      ELEMENT                       */ 00315000
         L     @10,TVWABIQ(,TVWAPTR)                               0125 00316000
         LH    @07,IQ@CURR(,@10)                                   0125 00317000
         STH   @07,IQ@STRT(,@10)                                   0125 00318000
*             END;                                                 0126 00319000
*           TSBPTR=ASCBTSB;         /* GET ADDRESS OF TSB            */ 00320000
@RC00121 L     @10,ASCBPTR                                         0127 00321000
         L     TSBPTR,ASCBTSB(,@10)                                0127 00322000
*           RFY                                                    0128 00323000
*             TSB BASED(TSBPTR);                                   0128 00324000
*                                                                  0128 00325000
*           /*********************************************************/ 00326000
*           /*                                                       */ 00327000
*           /* TSBNOBUF INDICATES TASKS ARE WAITING IN THIS ADDRESS  */ 00328000
*           /* SPACE TSBTJBF INDICATES TASKS ARE WAITING IN ANOTHER  */ 00329000
*           /* ADDRESS SPACE                                         */ 00330000
*           /*                                                       */ 00331000
*           /*********************************************************/ 00332000
*                                                                  0129 00333000
*           IF(TSBNOBUF='1'B|TSBTJBF='1'B)&TVWAUSMN<TVWALBUF THEN/*     00334000
*                                      IF TASKS ARE WAITING AND    0129 00335000
*                                      STORAGE USAGE IS BELOW LOW  0129 00336000
*                                      THRESHOLD                     */ 00337000
         TM    TSBNOBUF(TSBPTR),B'00010000'                        0129 00338000
         BO    @GL00005                                            0129 00339000
         TM    TSBTJBF(TSBPTR),B'00000001'                         0129 00340000
         BNO   @RF00129                                            0129 00341000
@GL00005 L     @10,TVWAUSMN(,TVWAPTR)                              0129 00342000
         C     @10,TVWALBUF(,TVWAPTR)                              0129 00343000
         BNL   @RF00129                                            0129 00344000
*             CALL MARKDISP;        /* TO DISPATCH TASKS SUSPENDED 0130 00345000
*                                      FOR BUFFER OVERUSE            */ 00346000
         BAL   @14,MARKDISP                                        0130 00347000
*           RFY                                                    0131 00348000
*             TSB BASED(ASCBTSB);                                  0131 00349000
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */ 00350000
         B     CE0001@                                             0132 00351000
*         END DELIN;                /* END OF SUBCASE                */ 00352000
         EJECT                                                          00353000
*                                                                  0134 00354000
*/********************************************************************/ 00355000
*/*                                                                  */ 00356000
*/* INPUT TO CLEARI:                                                 */ 00357000
*/*      REQUEST CODE = 5                                            */ 00358000
*/* OUTPUT FROM CLEARI:                                              */ 00359000
*/*      NONE                                                        */ 00360000
*/*                                                                  */ 00361000
*/********************************************************************/ 00362000
*                                                                  0134 00363000
*CLEARI:                                                           0134 00364000
*         DO;                       /* SUBCASE REMOVE ALL MESSAGES 0134 00365000
*                                      FROM INPUT QUE                */ 00366000
CLEARI   DS    0H                                                  0135 00367000
*           RFY                                                    0135 00368000
*             IQELE BASED(TEMP2);                                  0135 00369000
*           TEMP2=TVWAEIQ;          /* SET TEMPORARY TO END OF QUEUE */ 00370000
         L     TEMP2,TVWAEIQ(,TVWAPTR)                             0136 00371000
*           COUNT1=0;               /* SET A TEMPORARY COUNTER TO 0  */ 00372000
         SLR   COUNT1,COUNT1                                       0137 00373000
*           DO WHILE TEMP2^=0;      /* WHILE THERE ARE ELEMENTS TO 0138 00374000
*                                      CLEAR                         */ 00375000
         B     @DE00138                                            0138 00376000
@DL00138 DS    0H                                                  0139 00377000
*             IF IQPRMPT='1'B THEN  /* IF THIS ELEMENT WAS PROMPTED     00378000
*                                      FOR                           */ 00379000
         TM    IQPRMPT(TEMP2),B'01000000'                          0139 00380000
         BNO   @RF00139                                            0139 00381000
*               COUNT1=COUNT1+1;    /* INCREMENT COUNT OF ELEMENTS 0140 00382000
*                                      PROMPTED FOR                  */ 00383000
         AL    COUNT1,@CF00047                                     0140 00384000
*             RFY                                                  0141 00385000
*              (R0,                                                0141 00386000
*               R1) RSTD;                                          0141 00387000
@RF00139 DS    0H                                                  0142 00388000
*             R1=TEMP2;             /* REMEMBER ADDRESS OF ELEMENT   */ 00389000
         LR    R1,TEMP2                                            0142 00390000
*             TEMP2=IQPREV;         /* SET TEMPORARY TO PREVIOUS     */ 00391000
         L     TEMP2,IQPREV(,TEMP2)                                0143 00392000
*             IF R1->IQALLOC='0'B THEN/* IF ELEMENT WAS GETCELL'D    */ 00393000
         TM    IQALLOC(R1),B'10000000'                             0144 00394000
         BNZ   @RF00144                                            0144 00395000
*               IF TVWAQLBU='1'B THEN/* IF LOOK ASIDE BUFFER IS IN 0145 00396000
*                                      USE                           */ 00397000
         TM    TVWAQLBU(TVWAPTR),B'00000100'                       0145 00398000
         BNO   @RF00145                                            0145 00399000
*                 DO;                                              0146 00400000
*                   TVWAQMLB=R1;    /* SET LOOK ASIDE BUFFER ADDRESS    00401000
*                                      TO ADDRESS OF ELEMENT TO BE 0147 00402000
*                                      DELETED                       */ 00403000
         ST    R1,TVWAQMLB(,TVWAPTR)                               0147 00404000
*                   TVWAQLBU='0'B;  /* SET LOOK ASIDE BUFFER FLAG TO    00405000
*                                      'NOT IN USE'                  */ 00406000
         NI    TVWAQLBU(TVWAPTR),B'11111011'                       0148 00407000
*                 END;                                             0149 00408000
*               ELSE                                               0150 00409000
*                 DO;                                              0150 00410000
         B     @RC00145                                            0150 00411000
@RF00145 DS    0H                                                  0151 00412000
*                   R0=TVWACPID;    /* PUT CELL POOL ID IN REG 0     */ 00413000
         L     R0,TVWACPID(,TVWAPTR)                               0151 00414000
*                   RFY                                            0152 00415000
*                     R15 RSTD;                                    0152 00416000
*                   GEN REFS(R0,R1,CVTFRECL,CVTMAP) SETS(R14,R15); 0153 00417000
        FREECELL CPID=(0),CELL=(1),BRANCH=YES                           00418000
*                   RFY                                            0154 00419000
*                    (R4,                                          0154 00420000
*                     R7) RSTD;                                    0154 00421000
*                   IF R15=AUTODEL THEN/* IF AN EXTENT IS NOW EMPTY  */ 00422000
         C     R15,@CF00137                                        0155 00423000
         BNE   @RF00155                                            0155 00424000
*                     DO;                                          0156 00425000
*                       R0=4096;    /* SIZE OF AREA TO FREEMAIN      */ 00426000
         L     R0,@CF02165                                         0157 00427000
*                       R4=TVWATCB; /* PUT ADDRESS OF TCB IN REG 4   */ 00428000
         L     R4,TVWATCB(,TVWAPTR)                                0158 00429000
*                       R7=PSAAOLD; /* PUT ADDRESS OF ASCB IN REG 7  */ 00430000
         L     R7,PSAAOLD                                          0159 00431000
*                       GEN REFS(R0,R1,CVTRMBR,CVTMAP,CVTPTR) SETS(R2,  00432000
*                           R3,R14,R15);                           0160 00433000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2    SAVE CALLERS KEY   00434000
        FREEMAIN RU,LV=(0),A=(1),BRANCH=YES,KEY=TCASKEY,SP=SP229        00435000
        MODESET KEYADDR=(2)                     RETURN TO CALLERS KEY   00436000
*                     END;                                         0161 00437000
*                   RFY                                            0162 00438000
*                     R15 UNRSTD;                                  0162 00439000
@RF00155 DS    0H                                                  0163 00440000
*                 END;                                             0163 00441000
*             ELSE                  /* IF THIS ELEMENT WAS GETMAIN'D */ 00442000
*               DO;                                                0164 00443000
         B     @RC00144                                            0164 00444000
@RF00144 DS    0H                                                  0165 00445000
*                 R4=TVWATCB;       /* PUT TCB @ IN REG 4 FOR      0165 00446000
*                                      FREEMAIN                      */ 00447000
         L     R4,TVWATCB(,TVWAPTR)                                0165 00448000
*                 R7=PSAAOLD;       /* PUT ASCB@ IN REG 7 FOR      0166 00449000
*                                      FREEMAIN                      */ 00450000
         L     R7,PSAAOLD                                          0166 00451000
*                 R0=R1->IQNBUF;    /* PUT SIZE OF FREEMAIN IN REG 0 */ 00452000
         LH    R0,IQNBUF(,R1)                                      0167 00453000
*                 GEN REFS(R0,R1,CVTRMBR,CVTMAP,CVTPTR) SETS(R2,R3,R14, 00454000
*                     R15);                                        0168 00455000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2    SAVE CALLERS KEY   00456000
        FREEMAIN RU,LV=(0),A=(1),BRANCH=YES,KEY=TCASKEY,SP=SP229        00457000
        MODESET KEYADDR=(2)                     RETURN TO CALLERS KEY   00458000
*               END;                                               0169 00459000
*             RFY                                                  0170 00460000
*              (R0,                                                0170 00461000
*               R1,                                                0170 00462000
*               R4,                                                0170 00463000
*               R7) UNRSTD;                                        0170 00464000
@RC00144 DS    0H                                                  0171 00465000
*           END;                                                   0171 00466000
@DE00138 SLR   @10,@10                                             0171 00467000
         CR    TEMP2,@10                                           0171 00468000
         BNE   @DL00138                                            0171 00469000
*           TVWABIQ=0;              /* SET BEGINNING OF QUEUE TO 0   */ 00470000
         ST    @10,TVWABIQ(,TVWAPTR)                               0172 00471000
*           TVWANIM=0;              /* SET NEXT MESSAGE PTR TO 0     */ 00472000
         ST    @10,TVWANIM(,TVWAPTR)                               0173 00473000
*           TVWAEIQ=0;              /* SET END OF QUEUE TO 0         */ 00474000
         ST    @10,TVWAEIQ(,TVWAPTR)                               0174 00475000
*           TSBAUTOS=TSBAUTOS-COUNT1*TSBAUTOI;/* RESET LINE PROMPTING   00476000
*                                      BY COUNTER TIMES INCREMENT    */ 00477000
         L     @10,ASCBPTR                                         0175 00478000
         L     @10,ASCBTSB(,@10)                                   0175 00479000
         LR    @01,COUNT1                                          0175 00480000
         M     @00,TSBAUTOI(,@10)                                  0175 00481000
         LCR   @01,@01                                             0175 00482000
         AL    @01,TSBAUTOS(,@10)                                  0175 00483000
         ST    @01,TSBAUTOS(,@10)                                  0175 00484000
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */ 00485000
         B     CE0001@                                             0176 00486000
*         END CLEARI;               /* END OF SUBCASE                */ 00487000
         EJECT                                                          00488000
*                                                                  0178 00489000
*/********************************************************************/ 00490000
*/*                                                                  */ 00491000
*/* INPUT TO UPDATE:                                                 */ 00492000
*/*      REQUEST CODE = 4                                            */ 00493000
*/*      BUFFER ADDRESS= ADDRESS OF FIRST UNUSED BYTE OF MESSAGE     */ 00494000
*/* OUTPUT FROM UPDATE:                                              */ 00495000
*/*      RETURN CODE  = 1 => ELEMENT UPDATED                         */ 00496000
*/*                   = 2 => UNSUCCESSFUL, NOTHING ON QUEUE TO UPDATE*/ 00497000
*/*                                                                  */ 00498000
*/********************************************************************/ 00499000
*                                                                  0178 00500000
*UPDATE:                                                           0178 00501000
*         DO;                       /* SUBCASE UPDATE THE PREVIOUSLY    00502000
*                                      OBTAINED MESSAGE BECAUSE A  0178 00503000
*                                      PARTIAL MESSAGE WAS USED      */ 00504000
UPDATE   DS    0H                                                  0179 00505000
*           RFY                                                    0179 00506000
*             IQELE BASED(TVWANIM);                                0179 00507000
*           IF TVWANIM=TVWABIQ THEN /* IF NOTHING TO UPDATE          */ 00508000
         CLC   TVWANIM(4,TVWAPTR),TVWABIQ(TVWAPTR)                 0180 00509000
         BNE   @RF00180                                            0180 00510000
*             PRC=2;                /* SET RC TO 'NOTHING TO UPDATE' */ 00511000
         MVI   PRC,X'02'                                           0181 00512000
*           ELSE                                                   0182 00513000
*             DO;                                                  0182 00514000
         B     @RC00180                                            0182 00515000
@RF00180 DS    0H                                                  0183 00516000
*               IF TVWANIM=0 THEN   /* IF POINTER IS PASSED END OF Q */ 00517000
         L     @10,TVWANIM(,TVWAPTR)                               0183 00518000
         LTR   @10,@10                                             0183 00519000
         BNZ   @RF00183                                            0183 00520000
*                 TVWANIM=TVWAEIQ;  /* SET POINTER TO END OF QUEUE   */ 00521000
         L     @10,TVWAEIQ(,TVWAPTR)                               0184 00522000
         ST    @10,TVWANIM(,TVWAPTR)                               0184 00523000
*               ELSE                                               0185 00524000
*                 TVWANIM=IQPREV;   /* SET POINTER TO PREVIOUS     0185 00525000
*                                      ELEMENT                       */ 00526000
         B     @RC00183                                            0185 00527000
@RF00183 L     @10,TVWANIM(,TVWAPTR)                               0185 00528000
         L     @10,IQPREV(,@10)                                    0185 00529000
         ST    @10,TVWANIM(,TVWAPTR)                               0185 00530000
*               IQ@CURR=PBUFADR-TVWANIM;/* UPDATE CURRENT POINTER TO    00531000
*                                      REFLECT DATA USED             */ 00532000
@RC00183 L     @10,TVWANIM(,TVWAPTR)                               0186 00533000
         L     @07,PBUFADR                                         0186 00534000
         SLR   @07,@10                                             0186 00535000
         STH   @07,IQ@CURR(,@10)                                   0186 00536000
*               IQCCC=PFLGMVB3;     /* UPDATE CONTROL CHARACTER COUNT*/ 00537000
         IC    @07,PFLGMVB3                                        0187 00538000
         STC   @07,IQCCC(,@10)                                     0187 00539000
*               PRC=1;              /* SET RETURN CODE TO ELEMENT  0188 00540000
*                                      UPDATED                       */ 00541000
         MVI   PRC,X'01'                                           0188 00542000
*             END;                                                 0189 00543000
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */ 00544000
         B     CE0001@                                             0190 00545000
*         END UPDATE;               /* END OF SUBCASE                */ 00546000
         EJECT                                                          00547000
*                                                                  0192 00548000
*/********************************************************************/ 00549000
*/*                                                                  */ 00550000
*/* INPUT TO DELBK:                                                  */ 00551000
*/*      REQUEST CODE = 6                                            */ 00552000
*/* OUTPUT FROM DELBK:                                               */ 00553000
*/*      NONE                                                        */ 00554000
*/*                                                                  */ 00555000
*/********************************************************************/ 00556000
*                                                                  0192 00557000
*DELBK:                                                            0192 00558000
*         DO;                       /* SUBCASE REMOVE MESSAGES OFF 0192 00559000
*                                      BACK OF QUEUE TO A PREVIOUSLY    00560000
*                                      AVAILABLE MESSAGE             */ 00561000
DELBK    DS    0H                                                  0193 00562000
*           COUNT2=0;               /* SET COUNT OF PROMPTED ELEMENTS   00563000
*                                      0                             */ 00564000
         SLR   COUNT2,COUNT2                                       0193 00565000
*           RFY                                                    0194 00566000
*             R1 RSTD;                                             0194 00567000
*           QPTR2=ADDR(TVWABIQ);    /* PASS @ OF INPUT PTRS. TO DELEL*/ 00568000
         LA    QPTR2,TVWABIQ(,TVWAPTR)                             0195 00569000
*           DO WHILE(TVWAEIQ^=0&    /* WHILE THERE IS SOMETHING ON Q    00570000
*                                      AND                           */ 00571000
*                 TVWAEIQ->IQAVBL='0'B);/* ELEMENTS ARE MARKED     0196 00572000
*                                      UNAVAILABLE                   */ 00573000
         B     @DE00196                                            0196 00574000
@DL00196 DS    0H                                                  0197 00575000
*             R1=TVWAEIQ;           /* PUT @ OF ELEMENT IN REG 1 TO     00576000
*                                      PASS TO DELEL                 */ 00577000
         L     R1,TVWAEIQ(,TVWAPTR)                                0197 00578000
*             IF R1->IQPRMPT='1'B THEN/* IF THIS ELEMENT WAS PROMPTED   00579000
*                                      FOR                           */ 00580000
         TM    IQPRMPT(R1),B'01000000'                             0198 00581000
         BNO   @RF00198                                            0198 00582000
*               COUNT2=COUNT2+1;    /* INCREMENT COUNT OF ELEMENTS 0199 00583000
*                                      PROMPTED FOR                  */ 00584000
         AL    COUNT2,@CF00047                                     0199 00585000
*             CALL DELEL;           /* TO UNCHAIN THE ELEMENT AND  0200 00586000
*                                      FREE ASSOCIATED STORAGE. REG 1   00587000
*                                      CONTAINS @ OF ELEMENT         */ 00588000
@RF00198 BAL   @14,DELEL                                           0200 00589000
*           END;                                                   0201 00590000
@DE00196 L     @10,TVWAEIQ(,TVWAPTR)                               0201 00591000
         LTR   @10,@10                                             0201 00592000
         BZ    @DC00196                                            0201 00593000
         TM    IQAVBL(@10),B'10000000'                             0201 00594000
         BZ    @DL00196                                            0201 00595000
@DC00196 DS    0H                                                  0202 00596000
*           RFY                                                    0202 00597000
*             R1 UNRSTD;                                           0202 00598000
*           TSBPTR=ASCBTSB;         /* GET ADDRESS OF TSB            */ 00599000
         L     @10,ASCBPTR                                         0203 00600000
         L     TSBPTR,ASCBTSB(,@10)                                0203 00601000
*           RFY                                                    0204 00602000
*             TSB BASED(TSBPTR);                                   0204 00603000
*           TSBAUTOS=TSBAUTOS-COUNT2*TSBAUTOI;/* RESET LINE PROMPTING   00604000
*                                      BY COUNTER TIMES INCREMENT    */ 00605000
         LR    @01,COUNT2                                          0205 00606000
         M     @00,TSBAUTOI(,TSBPTR)                               0205 00607000
         LCR   @01,@01                                             0205 00608000
         AL    @01,TSBAUTOS(,TSBPTR)                               0205 00609000
         ST    @01,TSBAUTOS(,TSBPTR)                               0205 00610000
*           IF(TSBNOBUF='1'B|TSBTJBF='1'B)/* IF A TASK IS WAITING FOR   00611000
*                                      BUFFERS                       */ 00612000
*               &TVWAUSMN<TVWALBUF THEN/* AND BELOW LOW THRESHOLD    */ 00613000
         TM    TSBNOBUF(TSBPTR),B'00010000'                        0206 00614000
         BO    @GL00008                                            0206 00615000
         TM    TSBTJBF(TSBPTR),B'00000001'                         0206 00616000
         BNO   @RF00206                                            0206 00617000
@GL00008 L     @10,TVWAUSMN(,TVWAPTR)                              0206 00618000
         C     @10,TVWALBUF(,TVWAPTR)                              0206 00619000
         BNL   @RF00206                                            0206 00620000
*             CALL MARKDISP;        /* TO DISPATCH TASKS SUSPENDED 0207 00621000
*                                      FOR BUFFER OVERUSE            */ 00622000
         BAL   @14,MARKDISP                                        0207 00623000
*           RFY                                                    0208 00624000
*             TSB BASED(ASCBTSB);                                  0208 00625000
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */ 00626000
         B     CE0001@                                             0209 00627000
*         END DELBK;                /* END OF SUBCASE                */ 00628000
         EJECT                                                          00629000
*                                                                  0211 00630000
*/********************************************************************/ 00631000
*/*                                                                  */ 00632000
*/* INPUT TO MARKAVBL:                                               */ 00633000
*/*      REQUEST CODE = 7                                            */ 00634000
*/* OUTPUT FROM MARKAVBL:                                            */ 00635000
*/*      NONE                                                        */ 00636000
*/*                                                                  */ 00637000
*/********************************************************************/ 00638000
*                                                                  0211 00639000
*MARKAVBL:                                                         0211 00640000
*         DO;                       /* SUBCASE MARK MESSAGES       0211 00641000
*                                      AVAILABLE FOR TGET BACK TO  0211 00642000
*                                      PREVIOUSLY AVAILABLE ELE      */ 00643000
MARKAVBL DS    0H                                                  0212 00644000
*           TEMP4=TVWAEIQ;          /* SET TEMPORARY TO END OF QUEUE    00645000
*                                      FOR STEPING THROUGH QUEUE     */ 00646000
         L     TEMP4,TVWAEIQ(,TVWAPTR)                             0212 00647000
*           DO WHILE(TEMP4^=0&      /* DO WHILE THERE ARE MORE     0213 00648000
*                                      ELEMENTS                      */ 00649000
*                 TEMP4->IQAVBL='0'B);/* AND ELEMENTS ARE UNAVAILABLE*/ 00650000
         B     @DE00213                                            0213 00651000
@DL00213 DS    0H                                                  0214 00652000
*             TEMP4->IQAVBL='1'B;   /* SET AVAILABLE BIT IN THIS   0214 00653000
*                                      ELEMENT                       */ 00654000
         OI    IQAVBL(TEMP4),B'10000000'                           0214 00655000
*             TEMP4=TEMP4->IQPREV;  /* SET TEMPORARY TO PREVIOUS   0215 00656000
*                                      ELEMENT                       */ 00657000
         L     TEMP4,IQPREV(,TEMP4)                                0215 00658000
*           END;                                                   0216 00659000
@DE00213 LTR   TEMP4,TEMP4                                         0216 00660000
         BZ    @DC00213                                            0216 00661000
         TM    IQAVBL(TEMP4),B'10000000'                           0216 00662000
         BZ    @DL00213                                            0216 00663000
@DC00213 DS    0H                                                  0217 00664000
*           GOTO CE0001@;           /* BRANCH TO END OF CASE         */ 00665000
         B     CE0001@                                             0217 00666000
*         END MARKAVBL;             /* END OF SUBCASE                */ 00667000
         EJECT                                                          00668000
*CE0001@:                                                          0219 00669000
*       END BRAN;                   /* END OF CASE                   */ 00670000
CE0001@  DS    0H                                                  0220 00671000
*/********************************************************************/ 00672000
*/*  DELETE FRR ROUTINE ADDRESS FROM FRR LIST                        */ 00673000
*/*  RESET RETRY INDICATOR INDICATOR WHICH MIGHT BE SET BY IKTQMFR1  */ 00674000
*/*  RETURN PARM LIST TO USERS AREA                                  */ 00675000
*/********************************************************************/ 00676000
*                                                                  0220 00677000
*       GEN REFS(PSACSTK,PSA,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,FRRSELEN,  00678000
*           FRRSFRRA,FRRSENTR,FRRSEMP) SETS(R2,R14,R15);           0220 00679000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2     SAVE CALLERS KEY  00680000
        SETFRR  D,WRKREGS=(R14,R15)                                     00681000
        MODESET KEYADDR=(2)                        RESTORE CALLERS KEY  00682000
*       TVWAQMRT='0'B;              /* RESET RETRY INDICATOR         */ 00683000
         NI    TVWAQMRT(TVWAPTR),B'11101111'                       0221 00684000
*     END;                                                         0222 00685000
*                                                                  0222 00686000
*   /*****************************************************************/ 00687000
*   /*                                                               */ 00688000
*   /* END OF VALID REQUEST PROCESSING                               */ 00689000
*   /*                                                               */ 00690000
*   /*****************************************************************/ 00691000
*                                                                  0223 00692000
*   ELSE                            /* IF REQUEST IS INVALID         */ 00693000
*     PRC=4;                        /* SET RETURN CODE TO INVALID  0223 00694000
*                                      REQUEST                       */ 00695000
         B     @RC00062                                            0223 00696000
@RF00062 MVI   PRC,X'04'                                           0223 00697000
*   IPARMS=PARMS;                   /* RETURN PARM LIST TO USERS AREA*/ 00698000
@RC00062 L     @10,@PC00001                                        0224 00699000
         MVC   IPARMS(20,@10),PARMS                                0224 00700000
*RETURN01:                                                         0225 00701000
*   GEN NOSEQFLOW EXIT SETS(R0,R1,R2,R3,R4,R5,R6,R7,R8,R9,R10,R11,R12,  00702000
*       R13,R14,R15);                                              0225 00703000
RETURN01 DS    0H                                                  0225 00704000
         L     R13,4(R13)                                               00705000
         LM    R14,R12,12(R13)                                          00706000
         BR    R14                                                      00707000
         EJECT                                                          00708000
*   GEN;                                                           0226 00709000
EP0002    DS    0H                                                      00710000
*IKTQMOUT:                                                         0227 00711000
*   ENTRY(OPARMS);                  /* OUTPUT QUEUE ENTRY POINT      */ 00712000
@EC00227 DS    0H                                                  0228 00713000
*   DATARG=TVWAQMWA;                /* PUT @ OF WORK AREA IN DATAREG */ 00714000
         L     DATARG,TVWAQMWA(,TVWAPTR)                           0228 00715000
*   GEN;                                                           0229 00716000
        MVC   @PC00001+4(4),0(@01)  SAVE PTR TO PARM LIST               00717000
        ST    R13,@SA00001+4        SAVE PTR TO USERS SAVE AREA         00718000
        LA    R13,@SA00001          LOAD PTR TO MY SAVE AREA            00719000
*   PARMS=OPARMS;                   /* MAKE A LOCAL COPY OF PARM LIST*/ 00720000
         L     @10,@PC00001+4                                      0230 00721000
         MVC   PARMS(20),OPARMS(@10)                               0230 00722000
*   IF PREQ>0&PREQ<=OUTFUNC THEN    /* IF THE REQUEST CODE IS VALID  */ 00723000
         CLI   PREQ,0                                              0231 00724000
         BNH   @RF00231                                            0231 00725000
         CLI   PREQ,8                                              0231 00726000
         BH    @RF00231                                            0231 00727000
*     DO;                                                          0232 00728000
*       RFY                                                        0233 00729000
*         R0 RSTD;                                                 0233 00730000
*       R0=ADDR(IKTQMFR1);          /* PUT @ OF FRR ROUTINE IN REG 3    00731000
*                                      FOR SETFRR MACRO              */ 00732000
         L     R0,@CA02138                                         0234 00733000
*       GEN REFS(R0,PSACSTK,PSA,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,   0235 00734000
*           FRRSELEN,FRRSFRRA,FRRSENTR,FRRSPARM) SETS(R2,R14,R15); 0235 00735000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2     SAVE CALLERS KEY  00736000
        SETFRR  A,FRRAD=(R0),WRKREGS=(R14,R15)    SET UP @ OF IKTQMFR1  00737000
        MODESET KEYADDR=(2)                        RESTORE CALLERS KEY  00738000
*       RFY                                                        0236 00739000
*         R0 UNRSTD;                                               0236 00740000
*       TVWAQMIO='1'B;              /* OUTPUT SERVICES BEING USED    */ 00741000
         OI    TVWAQMIO(TVWAPTR),B'00001000'                       0237 00742000
*/********************************************************************/ 00743000
*/*          CASE MACRO USED TO BRANCH TO PROPER SERVICE ROUTINE     */ 00744000
*/********************************************************************/ 00745000
*                                                                  0238 00746000
*BRAN2:                                                            0238 00747000
*       DO;                         /* BRAN2:CASE(PREQ)NAMES(ADDO,OBT   00748000
*                                      AINO,DELETO,UPDATO,CLEARO,REOB   00749000
*                                      TAIN,RESET,ADDTOP)            */ 00750000
BRAN2    DS    0H                                                  0239 00751000
*         DCL                                                      0239 00752000
*           CL0002@ LABEL BASED(CP0002@(PREQ)) VALUERANGE(ADDO,OBTAINO, 00753000
*               DELETO,UPDATO,CLEARO,REOBTAIN,RESET,ADDTOP);/* BRANCH   00754000
*                                      TARGET                        */ 00755000
*         DCL                                                      0240 00756000
*           CP0002@(8) PTR(31) INIT(ADDR(ADDO),ADDR(OBTAINO),ADDR( 0240 00757000
*               DELETO),ADDR(UPDATO),ADDR(CLEARO),ADDR(REOBTAIN),ADDR(  00758000
*               RESET),ADDR(ADDTOP));                              0240 00759000
*         GOTO CL0002@;             /* BRANCH TO SELECTED CASE       */ 00760000
         SLR   @10,@10                                             0241 00761000
         IC    @10,PREQ                                            0241 00762000
         SLA   @10,2                                               0241 00763000
         L     @10,CP0002@-4(@10)                                  0241 00764000
         BR    @10                                                 0241 00765000
         EJECT                                                          00766000
*                                                                  0242 00767000
*/********************************************************************/ 00768000
*/*                                                                  */ 00769000
*/* INPUT TO ADDO:                                                   */ 00770000
*/*      REQUEST CODE = 1                                            */ 00771000
*/*      FLAGS        = THE FLAGS THE CALLER WANTS SET               */ 00772000
*/*      BUFFERSIZE   = THE MESSAGE LENGTH                           */ 00773000
*/* OUTPUT FROM ADDO:                                                */ 00774000
*/*      RETURN CODE  = 1 => SUCCESSFUL                              */ 00775000
*/*                   = 2 => BUFFER ALLOCATION EXCEEDED              */ 00776000
*/*      BUFFER ADDRESS= ADDRESS WHERE CALLER SHOULD PLACE MESSAGE   */ 00777000
*/*                                                                  */ 00778000
*/********************************************************************/ 00779000
*                                                                  0242 00780000
*ADDO:                                                             0242 00781000
*         DO;                       /* SUBCASE ADD AN ELEMENT TO   0242 00782000
*                                      OUTPUT QUEUE                  */ 00783000
ADDO     DS    0H                                                  0243 00784000
*           RFY                                                    0243 00785000
*             OQELE BASED(TVWAEOQ);                                0243 00786000
*           IF TVWAUSMN+PBFSZ>=     /* IF STORAGE TO BE IN USE IS  0244 00787000
*                                      MORE                          */ 00788000
*               TVWAHBUF THEN       /* THAN HIGH LIMIT ALLOWS        */ 00789000
         LH    @10,PBFSZ                                           0244 00790000
         AL    @10,TVWAUSMN(,TVWAPTR)                              0244 00791000
         C     @10,TVWAHBUF(,TVWAPTR)                              0244 00792000
         BL    @RF00244                                            0244 00793000
*             PRC=2;                /* TELL CALLER IT CANT BE PUT ON    00794000
*                                      Q                             */ 00795000
         MVI   PRC,X'02'                                           0245 00796000
*           ELSE                                                   0246 00797000
*             DO;                                                  0246 00798000
         B     @RC00244                                            0246 00799000
@RF00244 DS    0H                                                  0247 00800000
*               RFY                                                0247 00801000
*                (R1,                                              0247 00802000
*                 R15) RSTD;                                       0247 00803000
*               QPTR1=ADDR(TVWABOQ);/* PASS @ OF OUTPUT PTRS. TO   0248 00804000
*                                      BLDELE                        */ 00805000
         LA    QPTR1,TVWABOQ(,TVWAPTR)                             0248 00806000
*               CALL BLDELE;        /* CALL BLDELE TO BUILD A QUEUE     00807000
*                                      ELE                           */ 00808000
         BAL   @14,BLDELE                                          0249 00809000
*               IF R15>0 THEN       /* IF BLDELE COULDNT BUILD THE 0250 00810000
*                                      ELE                           */ 00811000
         LTR   R15,R15                                             0250 00812000
         BNP   @RF00250                                            0250 00813000
*                 PRC=2;            /* TELL CALLER IT CANT BE PUT ON    00814000
*                                      Q                             */ 00815000
         MVI   PRC,X'02'                                           0251 00816000
*               ELSE                                               0252 00817000
*                 DO;                                              0252 00818000
         B     @RC00250                                            0252 00819000
@RF00250 DS    0H                                                  0253 00820000
*                   TVWADOOQ='1'B;  /* MARK DATA ON OUTPUT QUEUE     */ 00821000
         OI    TVWADOOQ(TVWAPTR),B'01000000'                       0253 00822000
*                   TVWAUSMN=TVWAUSMN+OQNBUF;/* INCREASE COUNT OF  0254 00823000
*                                      USED MAIN STORAGE             */ 00824000
         L     @14,TVWAEOQ(,TVWAPTR)                               0254 00825000
         LH    @14,OQNBUF(,@14)                                    0254 00826000
         AL    @14,TVWAUSMN(,TVWAPTR)                              0254 00827000
         ST    @14,TVWAUSMN(,TVWAPTR)                              0254 00828000
*                   PRC=1;          /* TELL CALLER OF SUCCESSFUL ADD */ 00829000
         MVI   PRC,X'01'                                           0255 00830000
*                 END;                                             0256 00831000
*               RFY                                                0257 00832000
*                (R1,                                              0257 00833000
*                 R15) UNRSTD;                                     0257 00834000
@RC00250 DS    0H                                                  0258 00835000
*             END;                                                 0258 00836000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 00837000
         B     CE0002@                                             0259 00838000
*         END ADDO;                 /* END OF SUBCASE                */ 00839000
         EJECT                                                          00840000
*                                                                  0261 00841000
*/********************************************************************/ 00842000
*/*                                                                  */ 00843000
*/* INPUT TO OBTAINO:                                                */ 00844000
*/*      REQUEST CODE = 2                                            */ 00845000
*/* OUTPUT FROM OBTAINO:                                             */ 00846000
*/*      RETURN CODE  = 1 => SUCCESSFUL, MORE MESSAGES ON QUEUE      */ 00847000
*/*                   = 2 => SUCCESSFUL, NO MORE MESSAGES ON QUEUE   */ 00848000
*/*                   = 3 => UNSUCCESSFUL, NOTHING ON QUEUE          */ 00849000
*/*      BUFFER SIZE  = SIZE (IN BYTES) OF MESSAGE                   */ 00850000
*/*      FLAGS        = THE QUEUE ELEMENT FLAGS                      */ 00851000
*/*                                                                  */ 00852000
*/********************************************************************/ 00853000
*                                                                  0261 00854000
*OBTAINO:                                                          0261 00855000
*         DO;                       /* SUBCASE GET A QUEUE ELEMENT 0261 00856000
*                                      FOR CALLER                    */ 00857000
OBTAINO  DS    0H                                                  0262 00858000
*           RFY                                                    0262 00859000
*             OQELE BASED(TVWANOM);                                0262 00860000
*           IF TVWANOM=0 THEN       /* IF THERE IS NOTHING TO OBTAIN */ 00861000
         L     @10,TVWANOM(,TVWAPTR)                               0263 00862000
         LTR   @10,@10                                             0263 00863000
         BNZ   @RF00263                                            0263 00864000
*             PRC=3;                /* SET RC TO 'NOTHING TO OBTAIN' */ 00865000
         MVI   PRC,X'03'                                           0264 00866000
*           ELSE                                                   0265 00867000
*             DO;                                                  0265 00868000
         B     @RC00263                                            0265 00869000
@RF00263 DS    0H                                                  0266 00870000
*               PBUFADR=TVWANOM+OQ@CURR;/* SET BUFFER ADDRESS TO THIS   00871000
*                                      MESSAGE PLUS CURRENT OFFSET   */ 00872000
         L     @10,TVWANOM(,TVWAPTR)                               0266 00873000
         LH    @07,OQ@CURR(,@10)                                   0266 00874000
         LR    @15,@10                                             0266 00875000
         ALR   @15,@07                                             0266 00876000
         ST    @15,PBUFADR                                         0266 00877000
*               PBFSZ=OQNBQE-OQ@CURR;/* SET BUFFER SIZE PARAMETER    */ 00878000
         LCR   @07,@07                                             0267 00879000
         LH    @15,OQNBQE(,@10)                                    0267 00880000
         N     @15,@CF02260                                        0267 00881000
         ALR   @07,@15                                             0267 00882000
         STH   @07,PBFSZ                                           0267 00883000
*               PFLAGS=OQFLAGS;     /* SET BUFFER FLAGS PARAMETER    */ 00884000
         MVC   PFLAGS(4),OQFLAGS(@10)                              0268 00885000
*               TVWANOM=OQNEXT;     /* SET NEXT MESSAGE PTR TO     0269 00886000
*                                      FOLLOWING                     */ 00887000
         L     @10,OQNEXT(,@10)                                    0269 00888000
         ST    @10,TVWANOM(,TVWAPTR)                               0269 00889000
*               IF TVWANOM=0 THEN   /* IF NOTHING IS LEFT ON QUEUE   */ 00890000
         LTR   @10,@10                                             0270 00891000
         BNZ   @RF00270                                            0270 00892000
*                 DO;                                              0271 00893000
*                   TVWADOOQ='0'B;  /* DATA NOT ON OUTPUT QUEUE      */ 00894000
         NI    TVWADOOQ(TVWAPTR),B'10111111'                       0272 00895000
*                   PRC=2;          /* SET RC TO 'LAST MESSAGE ON  0273 00896000
*                                      QUEUE'                        */ 00897000
         MVI   PRC,X'02'                                           0273 00898000
*                 END;                                             0274 00899000
*               ELSE                                               0275 00900000
*                 DO;                                              0275 00901000
         B     @RC00270                                            0275 00902000
@RF00270 DS    0H                                                  0276 00903000
*                   PRC=1;          /* SET RC TO 'MORE MESSAGES ON 0276 00904000
*                                      QUEUE'                        */ 00905000
         MVI   PRC,X'01'                                           0276 00906000
*                   PNXBFSZ=OQNBQE-OQ@CURR;/* SET NEXT BUFFER SIZE 0277 00907000
*                                      PARAMETER                     */ 00908000
         L     @10,TVWANOM(,TVWAPTR)                               0277 00909000
         LH    @07,OQNBQE(,@10)                                    0277 00910000
         N     @07,@CF02260                                        0277 00911000
         SH    @07,OQ@CURR(,@10)                                   0277 00912000
         STH   @07,PNXBFSZ                                         0277 00913000
*                   PNXFLGS=OQFLAGS;/* SET NEXT FLAGS PARAMETER      */ 00914000
         MVC   PNXFLGS(4),OQFLAGS(@10)                             0278 00915000
*                 END;                                             0279 00916000
*             END;                                                 0280 00917000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 00918000
         B     CE0002@                                             0281 00919000
*         END OBTAINO;              /* END OF SUBCASE                */ 00920000
         EJECT                                                          00921000
*                                                                  0283 00922000
*/********************************************************************/ 00923000
*/*                                                                  */ 00924000
*/* INPUT TO DELETO:                                                 */ 00925000
*/*      REQUEST CODE = 3                                            */ 00926000
*/* OUTPUT FROM DELETO:                                              */ 00927000
*/*      RETURN CODE  = 1 => SUCCESSFUL DELETE, MORE MESSAGES ON QUEUE  00928000
*                                                                    */ 00929000
*/*                   = 2 => SUCCESSFUL DELETE, NO MORE MESSAGES     */ 00930000
*/*                                                                  */ 00931000
*/********************************************************************/ 00932000
*                                                                  0283 00933000
*DELETO:                                                           0283 00934000
*         DO;                       /* SUBCASE REMOVE PREVIOUSLY   0283 00935000
*                                      OBTAINED ELEMENTS FROM OUTPUT    00936000
*                                      QUEUE                         */ 00937000
DELETO   DS    0H                                                  0284 00938000
*           RFY                                                    0284 00939000
*             OQELE BASED(TVWABOQ);                                0284 00940000
*           RFY                                                    0285 00941000
*             R1 RSTD;                                             0285 00942000
*           QPTR2=ADDR(TVWABOQ);    /* PASS @ OF OUTPUT PTRS TO DELEL*/ 00943000
         LA    QPTR2,TVWABOQ(,TVWAPTR)                             0286 00944000
*           DO WHILE TVWABOQ^=TVWANOM;/* DO WHILE THERE ARE        0287 00945000
*                                      PREVIOUSLY OBTAINED MESSAGES     00946000
*                                      ON QUEUE                      */ 00947000
         B     @DE00287                                            0287 00948000
@DL00287 DS    0H                                                  0288 00949000
*             R1=TVWABOQ;           /* SET REG 1 TO BEGINNING POINTER*/ 00950000
         L     @10,TVWABOQ(,TVWAPTR)                               0288 00951000
         LR    R1,@10                                              0288 00952000
*             TVWAUSMN=TVWAUSMN-OQNBUF;/* REDUCE COUNT OF USED MAIN     00953000
*                                      STORAGE                       */ 00954000
         L     @07,TVWAUSMN(,TVWAPTR)                              0289 00955000
         SH    @07,OQNBUF(,@10)                                    0289 00956000
         ST    @07,TVWAUSMN(,TVWAPTR)                              0289 00957000
*             CALL DELEL;           /* TO UNCHAIN QUEUE ELEMENT AND     00958000
*                                      FREE ASSOCIATED STORAGE       */ 00959000
         BAL   @14,DELEL                                           0290 00960000
*           END;                                                   0291 00961000
@DE00287 CLC   TVWABOQ(4,TVWAPTR),TVWANOM(TVWAPTR)                 0291 00962000
         BNE   @DL00287                                            0291 00963000
*           RFY                                                    0292 00964000
*             R1 UNRSTD;                                           0292 00965000
*           TSBPTR=ASCBTSB;         /* GET ADDRESS OF TSB            */ 00966000
         L     @10,ASCBPTR                                         0293 00967000
         L     TSBPTR,ASCBTSB(,@10)                                0293 00968000
*           RFY                                                    0294 00969000
*             TSB BASED(TSBPTR);                                   0294 00970000
*           IF(TSBNOBUF='1'B|TSBTJBF='1'B)/* IF BELOW LOW THRESHOLD  */ 00971000
*               &TVWAUSMN<=TVWALBUF THEN                           0295 00972000
         TM    TSBNOBUF(TSBPTR),B'00010000'                        0295 00973000
         BO    @GL00012                                            0295 00974000
         TM    TSBTJBF(TSBPTR),B'00000001'                         0295 00975000
         BNO   @RF00295                                            0295 00976000
@GL00012 L     @10,TVWAUSMN(,TVWAPTR)                              0295 00977000
         C     @10,TVWALBUF(,TVWAPTR)                              0295 00978000
         BH    @RF00295                                            0295 00979000
*             CALL MARKDISP;        /* TO DISPATCH TASKS SUSPENDED 0296 00980000
*                                      FOR BUFFER OVERUSE            */ 00981000
         BAL   @14,MARKDISP                                        0296 00982000
*           RFY                                                    0297 00983000
*             TSB BASED(ASCBTSB);                                  0297 00984000
@RF00295 DS    0H                                                  0298 00985000
*           IF TVWABOQ=0 THEN       /* IF NOTHING LEFT ON QUEUE      */ 00986000
         L     @10,TVWABOQ(,TVWAPTR)                               0298 00987000
         LTR   @10,@10                                             0298 00988000
         BNZ   @RF00298                                            0298 00989000
*             PRC=2;                /* SET RETURN CODE TO NOTHING ON    00990000
*                                      Q                             */ 00991000
         MVI   PRC,X'02'                                           0299 00992000
*           ELSE                                                   0300 00993000
*             DO;                                                  0300 00994000
         B     @RC00298                                            0300 00995000
@RF00298 DS    0H                                                  0301 00996000
*               OQ@STRT=OQ@CURR;                                   0301 00997000
         L     @10,TVWABOQ(,TVWAPTR)                               0301 00998000
         LH    @07,OQ@CURR(,@10)                                   0301 00999000
         STH   @07,OQ@STRT(,@10)                                   0301 01000000
*               PRC=1;              /* SET RETURN CODE TO MORE ON  0302 01001000
*                                      QUEUE                         */ 01002000
         MVI   PRC,X'01'                                           0302 01003000
*             END;                                                 0303 01004000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 01005000
         B     CE0002@                                             0304 01006000
*         END DELETO;               /* END OF SUBCASE                */ 01007000
         EJECT                                                          01008000
*                                                                  0306 01009000
*/********************************************************************/ 01010000
*/*                                                                  */ 01011000
*/* INPUT TO UPDATO:                                                 */ 01012000
*/*      REQUEST CODE = 4                                            */ 01013000
*/*      BUFFER ADDRESS= ADDRESS OF FIRST UNUSED BYTE OF MESSAGE     */ 01014000
*/* OUTPUT FROM UPDATO:                                              */ 01015000
*/*      RETURN CODE = 1 => ELEMENT UPDATED                          */ 01016000
*/*                  = 2 => NOTHING ON QUEUE TO UPDATE               */ 01017000
*/*                                                                  */ 01018000
*/********************************************************************/ 01019000
*                                                                  0306 01020000
*UPDATO:                                                           0306 01021000
*         DO;                       /* SUBCASE UPDATE QUEUE ELEMENT     01022000
*                                      BECAUSE A PARTIAL MESSAGE WAS    01023000
*                                      USED                          */ 01024000
UPDATO   DS    0H                                                  0307 01025000
*           RFY                                                    0307 01026000
*             OQELE BASED(TVWANOM);                                0307 01027000
*           IF TVWABOQ^=TVWANOM THEN/* IF THERE IS SOMETHING TO    0308 01028000
*                                      UPDATE                        */ 01029000
         L     @10,TVWANOM(,TVWAPTR)                               0308 01030000
         C     @10,TVWABOQ(,TVWAPTR)                               0308 01031000
         BE    @RF00308                                            0308 01032000
*             DO;                                                  0309 01033000
*                                                                  0309 01034000
*               /*****************************************************/ 01035000
*               /*                                                   */ 01036000
*               /* MOVE NEXT OUTPUT MESSAGE POINTER BACK TO THE      */ 01037000
*               /* ELEMENT TO BE UPDATED                             */ 01038000
*               /*                                                   */ 01039000
*               /*****************************************************/ 01040000
*                                                                  0310 01041000
*               IF TVWANOM=0 THEN   /* IF NEXT POINTER IS PAST QUEUE */ 01042000
         LTR   @10,@10                                             0310 01043000
         BNZ   @RF00310                                            0310 01044000
*                 DO;                                              0311 01045000
*                   TVWANOM=TVWAEOQ;/* SET NEXT MESSAGE PTR TO END 0312 01046000
*                                      QUEUE                         */ 01047000
         L     @10,TVWAEOQ(,TVWAPTR)                               0312 01048000
         ST    @10,TVWANOM(,TVWAPTR)                               0312 01049000
*                   TVWADOOQ='1'B;  /* MARK DATA ON OUTPUT QUEUE     */ 01050000
         OI    TVWADOOQ(TVWAPTR),B'01000000'                       0313 01051000
*                 END;                                             0314 01052000
*               ELSE                                               0315 01053000
*                 TVWANOM=TVWANOM->OQPREV;/* SET NEXT MESSAGE PTR TO    01054000
*                                      PREVIOUS                      */ 01055000
         B     @RC00310                                            0315 01056000
@RF00310 L     @10,TVWANOM(,TVWAPTR)                               0315 01057000
         L     @10,OQPREV(,@10)                                    0315 01058000
         ST    @10,TVWANOM(,TVWAPTR)                               0315 01059000
*               OQ@CURR=PBUFADR-TVWANOM;/* CHANGE CURRENT OFFSET TO     01060000
*                                      REFLECT PARTIAL MESSAGE USED  */ 01061000
@RC00310 L     @10,TVWANOM(,TVWAPTR)                               0316 01062000
         L     @07,PBUFADR                                         0316 01063000
         SLR   @07,@10                                             0316 01064000
         STH   @07,OQ@CURR(,@10)                                   0316 01065000
*               PRC=1;              /* INDICATE UPDATE SUCCESSFUL    */ 01066000
         MVI   PRC,X'01'                                           0317 01067000
*             END;                                                 0318 01068000
*           ELSE                                                   0319 01069000
*             PRC=2;                /* INDICATE THERE WAS NOTHING ON    01070000
*                                      QUEUE TO UPDATE               */ 01071000
         B     @RC00308                                            0319 01072000
@RF00308 MVI   PRC,X'02'                                           0319 01073000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 01074000
         B     CE0002@                                             0320 01075000
*         END UPDATO;               /* END OF SUBCASE                */ 01076000
         EJECT                                                          01077000
*                                                                  0322 01078000
*/********************************************************************/ 01079000
*/*                                                                  */ 01080000
*/* INPUT TO CLEARO:                                                 */ 01081000
*/*      REQUEST CODE = 5                                            */ 01082000
*/* OUTPUT FROM CLEARO:                                              */ 01083000
*/*      NONE                                                        */ 01084000
*/*                                                                  */ 01085000
*/********************************************************************/ 01086000
*                                                                  0322 01087000
*CLEARO:                                                           0322 01088000
*         DO;                       /* SUBCASE REMOVE ALL BUT ASID 0322 01089000
*                                      MESSAGES FROM OUTPUT QUEUE    */ 01090000
CLEARO   DS    0H                                                  0323 01091000
*           RFY                                                    0323 01092000
*             OQELE BASED(R1);                                     0323 01093000
*           RFY                                                    0324 01094000
*             R1 RSTD;                                             0324 01095000
*           R1=TVWAEOQ;             /* SET A TEMPORARY TO BEGINNING     01096000
*                                      OF Q                          */ 01097000
         L     R1,TVWAEOQ(,TVWAPTR)                                0325 01098000
*           TVWADOOQ='0'B;          /* MARK NO DATA ON OUTPUT QUEUE  */ 01099000
         NI    TVWADOOQ(TVWAPTR),B'10111111'                       0326 01100000
*           QPTR2=ADDR(TVWABOQ);    /* PASS @ OF OUTPUT PTRS TO DELEL*/ 01101000
         LA    QPTR2,TVWABOQ(,TVWAPTR)                             0327 01102000
*           DO WHILE R1^=0;         /* WHILE THERE ARE ELEMENTS TO BE   01103000
*                                      DELETED                       */ 01104000
         B     @DE00328                                            0328 01105000
@DL00328 DS    0H                                                  0329 01106000
*             TEMP5=OQPREV;         /* SAVE ADDRESS OF PREVIOUS    0329 01107000
*                                      ELEMENT                       */ 01108000
         L     TEMP5,OQPREV(,R1)                                   0329 01109000
*             IF OQASID='0'B THEN   /* IF THIS IS NOT AN ASID MESSAGE*/ 01110000
         TM    OQASID(R1),B'00001000'                              0330 01111000
         BNZ   @RF00330                                            0330 01112000
*               DO;                                                0331 01113000
*                 TVWAUSMN=TVWAUSMN-OQNBUF;/* REDUCE USE COUNT NO. OF   01114000
*                                      BYTES IN THE BUFFER           */ 01115000
         L     @07,TVWAUSMN(,TVWAPTR)                              0332 01116000
         SH    @07,OQNBUF(,R1)                                     0332 01117000
         ST    @07,TVWAUSMN(,TVWAPTR)                              0332 01118000
*                 CALL DELEL;       /* TO UNCHAIN ELEMENT AND FREE 0333 01119000
*                                      STORAGE                       */ 01120000
         BAL   @14,DELEL                                           0333 01121000
*               END;                                               0334 01122000
*             ELSE                  /* IF THERE IS AN ASID MESSAGE   */ 01123000
*               TVWADOOQ='1'B;      /* THERES STILL DATA ON OUTPUT 0335 01124000
*                                      QUEUE                         */ 01125000
         B     @RC00330                                            0335 01126000
@RF00330 OI    TVWADOOQ(TVWAPTR),B'01000000'                       0335 01127000
*             R1=TEMP5;             /* SET REG1TO PREVIOUS MESSAGE   */ 01128000
@RC00330 LR    R1,TEMP5                                            0336 01129000
*           END;                                                   0337 01130000
@DE00328 LTR   R1,R1                                               0337 01131000
         BNZ   @DL00328                                            0337 01132000
*           RFY                                                    0338 01133000
*             R1 UNRSTD;                                           0338 01134000
*           TSBPTR=ASCBTSB;                                        0339 01135000
         L     @10,ASCBPTR                                         0339 01136000
         L     TSBPTR,ASCBTSB(,@10)                                0339 01137000
*           RFY                                                    0340 01138000
*             TSB BASED(TSBPTR);                                   0340 01139000
*           IF TSBNOBUF='1'B|TSBTJBF='1'B THEN                     0341 01140000
         TM    TSBNOBUF(TSBPTR),B'00010000'                        0341 01141000
         BO    @RT00341                                            0341 01142000
         TM    TSBTJBF(TSBPTR),B'00000001'                         0341 01143000
         BNO   @RF00341                                            0341 01144000
@RT00341 DS    0H                                                  0342 01145000
*             CALL MARKDISP;        /* TO DISPATCH TASKS SUSPENDED 0342 01146000
*                                      FOR BUFFER OVERUSE            */ 01147000
         BAL   @14,MARKDISP                                        0342 01148000
*           RFY                                                    0343 01149000
*             TSB BASED(ASCBTSB);                                  0343 01150000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 01151000
         B     CE0002@                                             0344 01152000
*         END CLEARO;               /* END OF SUBCASE                */ 01153000
         EJECT                                                          01154000
*                                                                  0346 01155000
*/********************************************************************/ 01156000
*/*                                                                  */ 01157000
*/* INPUT TO REOBTAIN:                                               */ 01158000
*/*      REQUEST CODE = 6                                            */ 01159000
*/* OUTPUT FROM REOBTAIN:                                            */ 01160000
*/*      RETURN CODE  = 1 => SUCCESSFUL, MORE MESSAGES ON QUEUE      */ 01161000
*/*                   = 2 => SUCCESSFUL, NO MORE MESSAGES            */ 01162000
*/*                   = 3 => UNSUCCESSFUL, NOTHING ON QUEUE          */ 01163000
*/*      BUFFER SIZE  = SIZE (IN BYTES) OF MESSAGE                   */ 01164000
*/*      BUFFER ADDRESS= ADDRESS OF FIRST BYTE OF MESSAGE            */ 01165000
*/*      FLAGS         = QUEUE ELEMENT FLAGS                         */ 01166000
*/*                                                                  */ 01167000
*/********************************************************************/ 01168000
*                                                                  0346 01169000
*REOBTAIN:                                                         0346 01170000
*         DO;                       /* SUBCASE                       */ 01171000
REOBTAIN DS    0H                                                  0347 01172000
*           RFY                                                    0347 01173000
*             OQELE BASED(TEMP6);                                  0347 01174000
*           TEMP6=TVWABOQ;          /* SET A TEMPORARY TO TOP OF   0348 01175000
*                                      QUEUE                         */ 01176000
         L     TEMP6,TVWABOQ(,TVWAPTR)                             0348 01177000
*           IF TEMP6=0 THEN         /* IF THERE IS NOTHING ON QUEUE  */ 01178000
         LTR   TEMP6,TEMP6                                         0349 01179000
         BNZ   @RF00349                                            0349 01180000
*             PRC=3;                /* SET RC TO 'NOTHING ON QUEUE'  */ 01181000
         MVI   PRC,X'03'                                           0350 01182000
*           ELSE                    /* IF THERE IS SOMETHING TO    0351 01183000
*                                      REOBTAIN                      */ 01184000
*             DO;                                                  0351 01185000
         B     @RC00349                                            0351 01186000
@RF00349 DS    0H                                                  0352 01187000
*               DO WHILE(TEMP6^=0&  /* WHILE THERE ARE ELEMENTS LEFT    01188000
*                                      AND                           */ 01189000
*                     TEMP6^=TVWANOM->OQNEXT);/* TEMPORARY ^= NEXT 0352 01190000
*                                      POINTER                       */ 01191000
         B     @DE00352                                            0352 01192000
@DL00352 DS    0H                                                  0353 01193000
*                 OQ@CURR=OQ@STRT;  /* SET CURRENT OFFSET TO START 0353 01194000
*                                      OFFSET                        */ 01195000
         LH    @10,OQ@STRT(,TEMP6)                                 0353 01196000
         STH   @10,OQ@CURR(,TEMP6)                                 0353 01197000
*                 TEMP6=OQNEXT;     /* SET TEMPORARY TO NEXT ELEMENT */ 01198000
         L     TEMP6,OQNEXT(,TEMP6)                                0354 01199000
*               END;                                               0355 01200000
@DE00352 LTR   TEMP6,TEMP6                                         0355 01201000
         BZ    @DC00352                                            0355 01202000
         L     @10,TVWANOM(,TVWAPTR)                               0355 01203000
         C     TEMP6,OQNEXT(,@10)                                  0355 01204000
         BNE   @DL00352                                            0355 01205000
@DC00352 DS    0H                                                  0356 01206000
*               RFY                                                0356 01207000
*                 OQELE BASED(TVWABOQ);                            0356 01208000
*               PBUFADR=TVWABOQ+OQ@CURR;/* SET BUFFER ADDRESS PARM   */ 01209000
         L     @10,TVWABOQ(,TVWAPTR)                               0357 01210000
         LH    @07,OQ@CURR(,@10)                                   0357 01211000
         LR    @15,@10                                             0357 01212000
         ALR   @15,@07                                             0357 01213000
         ST    @15,PBUFADR                                         0357 01214000
*               PBFSZ=OQNBQE-OQ@CURR;/* SET BUFFER SIZE PARM         */ 01215000
         LCR   @07,@07                                             0358 01216000
         LH    @15,OQNBQE(,@10)                                    0358 01217000
         N     @15,@CF02260                                        0358 01218000
         ALR   @07,@15                                             0358 01219000
         STH   @07,PBFSZ                                           0358 01220000
*               PFLAGS=OQFLAGS;     /* SET BUFFER FLAGS PARM         */ 01221000
         MVC   PFLAGS(4),OQFLAGS(@10)                              0359 01222000
*               TVWANOM=OQNEXT;     /* SET NEXT MESSAGE PTR TO NEXT     01223000
*                                      ELE                           */ 01224000
         L     @10,OQNEXT(,@10)                                    0360 01225000
         ST    @10,TVWANOM(,TVWAPTR)                               0360 01226000
*               RFY                                                0361 01227000
*                 OQELE BASED(TVWANOM);                            0361 01228000
*               IF TVWANOM=0 THEN   /* IF NOTHING MORE ON QUEUE      */ 01229000
         LTR   @10,@10                                             0362 01230000
         BNZ   @RF00362                                            0362 01231000
*                 DO;                                              0363 01232000
*                   TVWADOOQ='0'B;  /* MARK NO MORE DATA ON OUTPUT 0364 01233000
*                                      QUEUE                         */ 01234000
         NI    TVWADOOQ(TVWAPTR),B'10111111'                       0364 01235000
*                   PRC=2;          /* SET RC TO 'LAST MESSAGE ON  0365 01236000
*                                      QUEUE'                        */ 01237000
         MVI   PRC,X'02'                                           0365 01238000
*                 END;                                             0366 01239000
*               ELSE                /* IF MORE ON QUEUE              */ 01240000
*                 DO;                                              0367 01241000
         B     @RC00362                                            0367 01242000
@RF00362 DS    0H                                                  0368 01243000
*                   TVWADOOQ='1'B;  /* MARK DATA ON OUTPUT QUEUE     */ 01244000
         OI    TVWADOOQ(TVWAPTR),B'01000000'                       0368 01245000
*                   PRC=1;          /* SET RC TO 'MORE TO COME'      */ 01246000
         MVI   PRC,X'01'                                           0369 01247000
*                   PNXBFSZ=OQNBQE-OQ@CURR;/* SET NEXT BUFFER SIZE 0370 01248000
*                                      PARM                          */ 01249000
         L     @10,TVWANOM(,TVWAPTR)                               0370 01250000
         LH    @07,OQNBQE(,@10)                                    0370 01251000
         N     @07,@CF02260                                        0370 01252000
         SH    @07,OQ@CURR(,@10)                                   0370 01253000
         STH   @07,PNXBFSZ                                         0370 01254000
*                   PNXFLGS=OQFLAGS;/* SET NEXT BUFFER FLAGS PARM    */ 01255000
         MVC   PNXFLGS(4),OQFLAGS(@10)                             0371 01256000
*                 END;                                             0372 01257000
*             END;                                                 0373 01258000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 01259000
         B     CE0002@                                             0374 01260000
*         END REOBTAIN;             /* END OF SUBCASE                */ 01261000
         EJECT                                                          01262000
*                                                                  0376 01263000
*/********************************************************************/ 01264000
*/*                                                                  */ 01265000
*/* INPUT TO RESET:                                                  */ 01266000
*/*      REQUEST CODE = 7                                            */ 01267000
*/* OUTPUT FROM RESET:                                               */ 01268000
*/*      NONE                                                        */ 01269000
*/*                                                                  */ 01270000
*/********************************************************************/ 01271000
*                                                                  0376 01272000
*RESET:                                                            0376 01273000
*         DO;                       /* SUBCASE RETURN TO TOP OF QUEUE*/ 01274000
RESET    DS    0H                                                  0377 01275000
*           RFY                                                    0377 01276000
*             OQELE BASED(TEMP7);                                  0377 01277000
*           TEMP7=TVWABOQ;          /* SET A TEMPORARY TO TOP OF   0378 01278000
*                                      QUEUE                         */ 01279000
         L     TEMP7,TVWABOQ(,TVWAPTR)                             0378 01280000
*           DO WHILE(TEMP7^=0&      /* DO WHILE THERE IS SOMETHING 0379 01281000
*                                      AND                           */ 01282000
*                 TEMP7^=TVWANOM->OQNEXT);/* THE POINTER ^= NEXT     */ 01283000
         B     @DE00379                                            0379 01284000
@DL00379 DS    0H                                                  0380 01285000
*             OQ@CURR=OQ@STRT;      /* SET CURRENT OFFSET TO START 0380 01286000
*                                      OFFSET                        */ 01287000
         LH    @10,OQ@STRT(,TEMP7)                                 0380 01288000
         STH   @10,OQ@CURR(,TEMP7)                                 0380 01289000
*             TEMP7=OQNEXT;         /* SET TEMPORARY TO NEXT ELEMENT */ 01290000
         L     TEMP7,OQNEXT(,TEMP7)                                0381 01291000
*           END;                                                   0382 01292000
@DE00379 LTR   TEMP7,TEMP7                                         0382 01293000
         BZ    @DC00379                                            0382 01294000
         L     @10,TVWANOM(,TVWAPTR)                               0382 01295000
         C     TEMP7,OQNEXT(,@10)                                  0382 01296000
         BNE   @DL00379                                            0382 01297000
@DC00379 DS    0H                                                  0383 01298000
*           TVWANOM=TVWABOQ;        /* SET NEXT MESSAGE POINTER TO 0383 01299000
*                                      TOP                           */ 01300000
         L     @10,TVWABOQ(,TVWAPTR)                               0383 01301000
         ST    @10,TVWANOM(,TVWAPTR)                               0383 01302000
*           IF TVWANOM=0 THEN       /* IF THERE IS NOTHING ON QUEUE  */ 01303000
         LTR   @10,@10                                             0384 01304000
         BNZ   @RF00384                                            0384 01305000
*             TVWADOOQ='0'B;        /* MARK NO DATA ON OUTPUT QUEUE  */ 01306000
         NI    TVWADOOQ(TVWAPTR),B'10111111'                       0385 01307000
*           ELSE                                                   0386 01308000
*             TVWADOOQ='1'B;        /* THERE IS DATA ON OUTPUT QUEUE */ 01309000
         B     @RC00384                                            0386 01310000
@RF00384 OI    TVWADOOQ(TVWAPTR),B'01000000'                       0386 01311000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 01312000
         B     CE0002@                                             0387 01313000
*         END RESET;                /* END OF SUBCASE                */ 01314000
         EJECT                                                          01315000
*                                                                  0389 01316000
*/********************************************************************/ 01317000
*/*                                                                  */ 01318000
*/* INPUT TO ADDTOP:                                                 */ 01319000
*/*      REQUEST CODE = 8                                            */ 01320000
*/*      FLAGS        = THE FLAGS THE CALLER WANTS SET               */ 01321000
*/*      BUFFER SIZE  = THE MESSAGE LENGTH                           */ 01322000
*/* OUTPUT FROM ADDTOP:                                              */ 01323000
*/*      RETURN CODE  = 1 => SUCCESSFUL                              */ 01324000
*/*                   = 2 => UNSUCCESSFUL, NO MORE ROOM FOR ELEMENTS */ 01325000
*/*      BUFFER ADDRESS= ADDRESS AT WHICH CALLER SHOULD PLACE THE    */ 01326000
*/*                      MESSAGE                                     */ 01327000
*/*                                                                  */ 01328000
*/********************************************************************/ 01329000
*                                                                  0389 01330000
*ADDTOP:                                                           0389 01331000
*         DO;                       /* SUBCASE ADD AN ELEMENT TO BE     01332000
*                                      NEXT OUTPUT                   */ 01333000
*                                                                  0389 01334000
ADDTOP   DS    0H                                                  0390 01335000
*           /*********************************************************/ 01336000
*           /*                                                       */ 01337000
*           /* MESSAGES ARE TO BE ADDED TO THE MIDDLE OF THE OUTPUT  */ 01338000
*           /* QUEUE IN FIFO ORDER. THIS LOOP FINDS THE POSITION     */ 01339000
*           /* WHERE THIS NEW ELEMENT SHOULD GO                      */ 01340000
*           /*                                                       */ 01341000
*           /*********************************************************/ 01342000
*                                                                  0390 01343000
*           TEMP9=TVWANOM;          /* SET TEMPORARY TO NEXT MESSAGE    01344000
*                                      PTR                           */ 01345000
         L     TEMP9,TVWANOM(,TVWAPTR)                             0390 01346000
*           DO WHILE(TEMP9^=0&      /* WHILE THERE ARE ELEMENTS ON 0391 01347000
*                                      QUEUE                         */ 01348000
*                 TEMP9->OQADTOP='1'B);/* AND MESSAGES ARE MARKED AS    01349000
*                                      ADDED TO TOP OF QUEUE         */ 01350000
         B     @DE00391                                            0391 01351000
@DL00391 DS    0H                                                  0392 01352000
*             TEMP9=TEMP9->OQNEXT;  /* SET TEMPORARY TO NEXT ELEMENT */ 01353000
         L     TEMP9,OQNEXT(,TEMP9)                                0392 01354000
*           END;                                                   0393 01355000
@DE00391 LTR   TEMP9,TEMP9                                         0393 01356000
         BZ    @DC00391                                            0393 01357000
         TM    OQADTOP(TEMP9),B'01000000'                          0393 01358000
         BO    @DL00391                                            0393 01359000
@DC00391 DS    0H                                                  0394 01360000
*           QPTR1=ADDR(TVWABOQ);    /* PASS ADDRESS OF QUEUE PTRS TO    01361000
*                                      RTN                           */ 01362000
         LA    QPTR1,TVWABOQ(,TVWAPTR)                             0394 01363000
*           CALL BLDELE;            /* TO BUILD ELEMENT AND CHAIN AT    01364000
*                                      END                           */ 01365000
         BAL   @14,BLDELE                                          0395 01366000
*           IF R15=0 THEN           /* IF BLDELE WENT OK             */ 01367000
         SLR   @14,@14                                             0396 01368000
         CR    R15,@14                                             0396 01369000
         BNE   @RF00396                                            0396 01370000
*             DO;                                                  0397 01371000
*               PRC=1;              /* SET RC TO SUCCESSFUL          */ 01372000
         MVI   PRC,X'01'                                           0398 01373000
*               RFY                                                0399 01374000
*                 OQELE BASED(R1);                                 0399 01375000
*               RFY                                                0400 01376000
*                 R1 RSTD;          /* REG 1 CONTAINS ADDRESS OF NEW    01377000
*                                      ELE AFTER THE CALL TO BLDELE  */ 01378000
*               TVWADOOQ='1'B;      /* MARK DATA ON OUTPUT QUEUE     */ 01379000
         OI    TVWADOOQ(TVWAPTR),B'01000000'                       0401 01380000
*               OQADTOP='1'B;       /* MARK THIS ELEMENT AS ADD TO 0402 01381000
*                                      TOP                           */ 01382000
         OI    OQADTOP(R1),B'01000000'                             0402 01383000
*               IF TEMP9^=0 THEN    /* IF NEW ELEMENT MUST GO IN   0403 01384000
*                                      MIDDLE OF QUEUE SOMEWHERE     */ 01385000
*                                                                  0403 01386000
         CR    TEMP9,@14                                           0403 01387000
         BE    @RF00403                                            0403 01388000
*                 /***************************************************/ 01389000
*                 /*                                                 */ 01390000
*                 /* THIS CODE TAKES THE ELEMENT OFF THE END OF THE  */ 01391000
*                 /* QUEUE AND PLACES IT (LOGICALLY) IN ITS PROPER   */ 01392000
*                 /* PLACE, WHICH WAS DETERMINED EARLIER, IN THE     */ 01393000
*                 /* MIDDLE OF THE QUEUE                             */ 01394000
*                 /*                                                 */ 01395000
*                 /***************************************************/ 01396000
*                                                                  0404 01397000
*                 DO;                                              0404 01398000
*                   OQPREV->OQNEXT=OQNEXT;/* TAKE THIS ELEMENT OFF 0405 01399000
*                                      END OF QUEUE                  */ 01400000
         L     @10,OQPREV(,R1)                                     0405 01401000
         L     @07,OQNEXT(,R1)                                     0405 01402000
         ST    @07,OQNEXT(,@10)                                    0405 01403000
*                   TVWAEOQ=OQPREV;                                0406 01404000
         ST    @10,TVWAEOQ(,TVWAPTR)                               0406 01405000
*                   OQNEXT=TEMP9;   /* AND CHAIN IT AHEAD OF FIRST 0407 01406000
*                                      NON ADDED TO TOP OF THE QUEUE    01407000
*                                      MESSAGE                       */ 01408000
         ST    TEMP9,OQNEXT(,R1)                                   0407 01409000
*                   OQPREV=TEMP9->OQPREV;                          0408 01410000
         L     @10,OQPREV(,TEMP9)                                  0408 01411000
         ST    @10,OQPREV(,R1)                                     0408 01412000
*                   TEMP9->OQPREV=R1;/* SET PREVIOUS PTR TO NEW    0409 01413000
*                                      ELEMENT                       */ 01414000
         ST    R1,OQPREV(,TEMP9)                                   0409 01415000
*                   IF TEMP9=TVWABOQ THEN/* IF NEW ELEMENT IS GOING     01416000
*                                      AT                            */ 01417000
         C     TEMP9,TVWABOQ(,TVWAPTR)                             0410 01418000
         BNE   @RF00410                                            0410 01419000
*                     DO;           /* BEGINNING OF OUTPUT QUEUE     */ 01420000
*                       TVWABOQ=R1; /* SET START OF QUEUE TO NEW   0412 01421000
*                                      ELEMENT                       */ 01422000
         ST    R1,TVWABOQ(,TVWAPTR)                                0412 01423000
*                       TVWANOM=R1; /* SET NEXT MESSAGE PTR TO NEW 0413 01424000
*                                      ELEMENT                       */ 01425000
         ST    R1,TVWANOM(,TVWAPTR)                                0413 01426000
*                     END;                                         0414 01427000
*                   ELSE                                           0415 01428000
*                     DO;                                          0415 01429000
         B     @RC00410                                            0415 01430000
@RF00410 DS    0H                                                  0416 01431000
*                       OQPREV->OQNEXT=R1;/* SET NEXT PTR OF PREVIOUS   01432000
*                                      ELEMENT TO POINT TO NEW     0416 01433000
*                                      ELEMENT                       */ 01434000
         L     @10,OQPREV(,R1)                                     0416 01435000
         ST    R1,OQNEXT(,@10)                                     0416 01436000
*                       IF TEMP9=TVWANOM THEN/* IF NEW ELE IS GOING     01437000
*                                      AT NEXT PTR                   */ 01438000
         C     TEMP9,TVWANOM(,TVWAPTR)                             0417 01439000
         BNE   @RF00417                                            0417 01440000
*                         TVWANOM=R1;/* SET NEXT MESSAGE PTR TO NEW     01441000
*                                      ELE                           */ 01442000
         ST    R1,TVWANOM(,TVWAPTR)                                0418 01443000
*                     END;                                         0419 01444000
@RF00417 DS    0H                                                  0420 01445000
*                 END;                                             0420 01446000
@RC00410 DS    0H                                                  0421 01447000
*               RFY                                                0421 01448000
*                 R1 UNRSTD;                                       0421 01449000
@RF00403 DS    0H                                                  0422 01450000
*             END;                                                 0422 01451000
*           ELSE                    /* IF BLDELE FAILED              */ 01452000
*             PRC=2;                /* SET RC TO 'OUT OF STORAGE'    */ 01453000
         B     @RC00396                                            0423 01454000
@RF00396 MVI   PRC,X'02'                                           0423 01455000
*           GOTO CE0002@;           /* BRANCH TO END OF CASE         */ 01456000
         B     CE0002@                                             0424 01457000
*         END ADDTOP;               /* END OF SUBCASE                */ 01458000
         EJECT                                                          01459000
*CE0002@:                                                          0426 01460000
*       END BRAN2;                  /* END OF CASE                   */ 01461000
CE0002@  DS    0H                                                  0427 01462000
*/********************************************************************/ 01463000
*/*  DELETE FRR ROUTINE ADDRESS FROM FRR LIST                        */ 01464000
*/*  RESET RETRY INDICATOR INDICATOR WHICH MIGHT BE SET BY IKTQMFR1  */ 01465000
*/*  RETURN PARM LIST TO USERS AREA                                  */ 01466000
*/********************************************************************/ 01467000
*                                                                  0427 01468000
*       GEN REFS(PSACSTK,PSA,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,FRRSELEN,  01469000
*           FRRSFRRA,FRRSENTR,FRRSEMP) SETS(R2,R14,R15);           0427 01470000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2    SAVE CALLERS KEY   01471000
        SETFRR  D,WRKREGS=(R14,R15)      DELETE @ OF IKTQMFR1 ROUTINE   01472000
        MODESET KEYADDR=(2)                       RESTORE CALLERS KEY   01473000
*       TVWAQMRT='0'B;              /* RESET RETRY INDICATOR         */ 01474000
         NI    TVWAQMRT(TVWAPTR),B'11101111'                       0428 01475000
*     END;                                                         0429 01476000
*                                                                  0429 01477000
*   /*****************************************************************/ 01478000
*   /*                                                               */ 01479000
*   /* END OF VALID REQUEST PROCESSING                               */ 01480000
*   /*                                                               */ 01481000
*   /*****************************************************************/ 01482000
*                                                                  0430 01483000
*   ELSE                            /* IF REQUEST CODE IS INVALID    */ 01484000
*     PRC=4;                        /* SET RETURN CODE TO REQUEST  0430 01485000
*                                      INVALID                       */ 01486000
         B     @RC00231                                            0430 01487000
@RF00231 MVI   PRC,X'04'                                           0430 01488000
*   OPARMS=PARMS;                   /* RETURN PARM LIST TO USERS AREA*/ 01489000
@RC00231 L     @10,@PC00001+4                                      0431 01490000
         MVC   OPARMS(20,@10),PARMS                                0431 01491000
*   GOTO RETURN01;                                                 0432 01492000
         B     RETURN01                                            0432 01493000
         EJECT                                                          01494000
*   GEN;                                                           0433 01495000
EP0003   DS   0H                                                        01496000
*IKTQMFR1:                                                         0434 01497000
*   ENTRY;                          /* FIRST Q MANAGER FRR ROUTINE   */ 01498000
*                                                                  0434 01499000
*   /*****************************************************************/ 01500000
*   /*                                                               */ 01501000
*   /* THIS ROUTINE IS ENTERED WHEN EVER AN ERROR CONDITION IS       */ 01502000
*   /* DETECTED IN THE INPUT OR OUTPUT ROUTINES. IF THIS FRR HAS BEEN*/ 01503000
*   /* PERCOLATED TO, REENTERED, OR IF RETRYING A REQUEST HAS FAILED */ 01504000
*   /* THIS ROUTINE WILL JUST CONTINUE TERMINATION                   */ 01505000
*   /*                                                               */ 01506000
*   /*****************************************************************/ 01507000
*                                                                  0435 01508000
*   DATARG=TVWAQMWA;                /* PUT @ OF WORKAREA IN DATAREG  */ 01509000
         L     DATARG,TVWAQMWA(,TVWAPTR)                           0435 01510000
*   GEN;                                                           0436 01511000
        LA    R13,@SA00001                                              01512000
        ST    R14,@SA00003                                              01513000
*   RFY                                                            0437 01514000
*     SDWAPTR RSTD;                                                0437 01515000
*   SDWAPTR=R1;                     /* MOVE SDWA POINTER TO ANOTHER     01516000
*                                      REG                           */ 01517000
         LR    SDWAPTR,R1                                          0438 01518000
*   IF R0^=12&SDWAPERC='0'B&SDWASTAF='0'B&TVWAQMRT='0'B THEN       0439 01519000
         C     R0,@CF02219                                         0439 01520000
         BE    @RF00439                                            0439 01521000
         TM    SDWAPERC(SDWAPTR),B'10010000'                       0439 01522000
         BNZ   @RF00439                                            0439 01523000
         TM    TVWAQMRT(TVWAPTR),B'00010000'                       0439 01524000
         BNZ   @RF00439                                            0439 01525000
*     DO;                                                          0440 01526000
*       TVWAQMRT='1'B;                                             0441 01527000
         OI    TVWAQMRT(TVWAPTR),B'00010000'                       0441 01528000
*       SDWARCRD='1'B;              /* RECORDING REQUESTED           */ 01529000
         OI    SDWARCRD(SDWAPTR),B'10000000'                       0442 01530000
*       SDWAMODN=QMNGR;             /* PUT NAME OF MODULE IN SDWA    */ 01531000
         MVC   SDWAMODN(8,SDWAPTR),QMNGR                           0443 01532000
*       SDWAREXN=FRR1;              /* PUT NAME OF FRR ROUTINE IN  0444 01533000
*                                      SDWA                          */ 01534000
         MVC   SDWAREXN(8,SDWAPTR),FRR1                            0444 01535000
*       IF TVWAQMIO='0'B THEN       /* IF AN INPUT REQUEST WAS BAD   */ 01536000
         TM    TVWAQMIO(TVWAPTR),B'00001000'                       0445 01537000
         BNZ   @RF00445                                            0445 01538000
*         QPTR=ADDR(TVWABIQ);       /* GET @ OF INPUT QUEUE POINTERS */ 01539000
         LA    QPTR,TVWABIQ(,TVWAPTR)                              0446 01540000
*       ELSE                                                       0447 01541000
*         QPTR=ADDR(TVWABOQ);       /* GET @ OF OUTPUT QUEUE POINTERS*/ 01542000
         B     @RC00445                                            0447 01543000
@RF00445 LA    QPTR,TVWABOQ(,TVWAPTR)                              0447 01544000
*       RFY                                                        0448 01545000
*         QPTRS BASED(QPTR);                                       0448 01546000
@RC00445 DS    0H                                                  0449 01547000
*       RFY                                                        0449 01548000
*         R0 RSTD;                                                 0449 01549000
*       R0=ADDR(IKTQMFR2);                                         0450 01550000
         L     R0,@CA02221                                         0450 01551000
*       GEN REFS(R0,PSACSTK,PSA,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,   0451 01552000
*           FRRSELEN,FRRSFRRA,FRRSENTR,FRRSPARM) SETS(R14,R15);    0451 01553000
        SETFRR  A,FRRAD=(R0),WRKREGS=(R14,R15)   SET UP @ OF IKTQMFR2   01554000
*       RFY                                                        0452 01555000
*        (R4,                                                      0452 01556000
*         R7) RSTD;                                                0452 01557000
*       R0=LENGTH(QVPL);            /* GET LENGTH OF AREA FOR GETMAIN*/ 01558000
         LA    R0,144                                              0453 01559000
*       R4=TVWATCB;                 /* SET TCB @ FOR BRANCH ENTRY  0454 01560000
*                                      GETMAIN                       */ 01561000
         L     R4,TVWATCB(,TVWAPTR)                                0454 01562000
*       R7=PSAAOLD;                 /* SET ASCB@ FOR BRANCH ENTRY    */ 01563000
*                                                                  0455 01564000
         L     R7,PSAAOLD                                          0455 01565000
*       /*************************************************************/ 01566000
*       /*                                                           */ 01567000
*       /* GETMAIN A BUFFER FOR USE                                  */ 01568000
*       /*                                                           */ 01569000
*       /*************************************************************/ 01570000
*                                                                  0456 01571000
*       GEN REFS(R0,R2,R4,R7,CVTCRMN,CVTMAP) SETS(R1,R3,R14,R15);  0456 01572000
        GETMAIN RC,LV=(0),SP=SP229,BRANCH=YES,KEY=TCASKEY               01573000
*       RFY                                                        0457 01574000
*        (R0,                                                      0457 01575000
*         R4,                                                      0457 01576000
*         R7) UNRSTD;                                              0457 01577000
*       IF R15=0 THEN                                              0458 01578000
         LTR   R15,R15                                             0458 01579000
         BNZ   @RF00458                                            0458 01580000
*         DO;                                                      0459 01581000
*           RFY                                                    0460 01582000
*             QVPLPTR RSTD;                                        0460 01583000
*           QVPLTYP3=QVPLTYP3&&QVPLTYP3;/* ZERO OUT PARAMETER LIST   */ 01584000
         XC    QVPLTYP3(40,QVPLPTR),QVPLTYP3(QVPLPTR)              0461 01585000
*           QVPLHDR=ADDR(MTVWABQ);  /* PUT @ OF BEGINNING OF QUEUE 0462 01586000
*                                      PTR IN QVPL                   */ 01587000
         ST    QPTR,QVPLHDR(,QVPLPTR)                              0462 01588000
*           QVPLTRLR=ADDR(MTVWAEQ); /* PUT @ OF END OF QUEUE PTR IN     01589000
*                                      QVPL                          */ 01590000
         LA    @07,MTVWAEQ(,QPTR)                                  0463 01591000
         ST    @07,QVPLTRLR(,QVPLPTR)                              0463 01592000
*           QVPLODA=SDWARECA;                                      0464 01593000
         L     @07,SDWARECA(,SDWAPTR)                              0464 01594000
         ST    @07,QVPLODA(,QVPLPTR)                               0464 01595000
*           QVPLEVR=ADDR(IKTQMEV);  /* PUT @ OF ELEMENT VERIFICATION    01596000
*                                      ROUTINE IN QVPL               */ 01597000
         L     @07,@CA02222                                        0465 01598000
         ST    @07,QVPLEVR(,QVPLPTR)                               0465 01599000
*           QVPLWKA=ADDR(QVWRKAR);  /* PUT @ OF WORK AREA IN QVPL    */ 01600000
         LA    @07,QVWRKAR(,QVPLPTR)                               0466 01601000
         ST    @07,QVPLWKA(,QVPLPTR)                               0466 01602000
*           QVPLFPTR=8;             /* PUT OFFSET OF FORWARD POINTER    01603000
*                                      IN QVPL                       */ 01604000
         MVC   QVPLFPTR(2,QVPLPTR),@CH00056                        0467 01605000
*           QVPLBPTR=12;            /* PUT OFFSET OF BACKWARD POINTER   01606000
*                                      IN QVPL                       */ 01607000
         MVC   QVPLBPTR(2,QVPLPTR),@CH02219                        0468 01608000
*           RFY                                                    0469 01609000
*            (R0,                                                  0469 01610000
*             R15) RSTD;                                           0469 01611000
*           R0=ADDR(QVSAVEAR);      /* PASS @ OF SAVE AREA TO EV   0470 01612000
*                                      ROUTINE. ADDRESS IS IN REG 1     01613000
*                                      ON ENTRY TO IKTQMEV           */ 01614000
         LA    R0,QVSAVEAR(,QVPLPTR)                               0470 01615000
*           CALL IEAVEQV3;                                         0471 01616000
         L     @07,CVTPTR                                          0471 01617000
         L     @15,CVTQV3(,@07)                                    0471 01618000
         BALR  @14,@15                                             0471 01619000
*           R8=R15;                 /* SAVE RETURN CODE FROM QUEUE 0472 01620000
*                                      VERIFIER                      */ 01621000
         LR    R8,R15                                              0472 01622000
*           RFY                                                    0473 01623000
*            (R4,                                                  0473 01624000
*             R7) RSTD;                                            0473 01625000
*           R0=LENGTH(QVPL);                                       0474 01626000
         LA    R0,144                                              0474 01627000
*           R4=TVWATCB;                                            0475 01628000
         L     R4,TVWATCB(,TVWAPTR)                                0475 01629000
*           R7=PSAAOLD;                                            0476 01630000
         L     R7,PSAAOLD                                          0476 01631000
*           RFY                                                    0477 01632000
*             R3 RSTD;                                             0477 01633000
*           GEN REFS(R0,R4,R7,CVTMAP) SETS(R3,R14,R15);            0478 01634000
         FREEMAIN RC,LV=(0),A=(1),BRANCH=YES,KEY=TCASKEY,SP=SP229       01635000
*           RFY                                                    0479 01636000
*            (R0,                                                  0479 01637000
*             R3,                                                  0479 01638000
*             R4,                                                  0479 01639000
*             R7,                                                  0479 01640000
*             QVPLPTR) UNRSTD;                                     0479 01641000
*         END;                                                     0480 01642000
*       IF R8^=0&TVWAQLBU='0'B THEN                                0481 01643000
*                                                                  0481 01644000
@RF00458 SLR   @14,@14                                             0481 01645000
         CR    R8,@14                                              0481 01646000
         BE    @RF00481                                            0481 01647000
         TM    TVWAQLBU(TVWAPTR),B'00000100'                       0481 01648000
         BNZ   @RF00481                                            0481 01649000
*         /***********************************************************/ 01650000
*         /*                                                         */ 01651000
*         /* HAVE MESSAGE SENT TO TERMINAL                           */ 01652000
*         /*                                                         */ 01653000
*         /***********************************************************/ 01654000
*                                                                  0482 01655000
*         DO;                                                      0482 01656000
*           RFY                                                    0483 01657000
*             QELE BASED(TVWAQMLB);                                0483 01658000
*           TVWAQLBU='1'B;          /* MARK LOOK ASIDE BUFFER AS IN     01659000
*                                      USE                           */ 01660000
         OI    TVWAQLBU(TVWAPTR),B'00000100'                       0484 01661000
*           QNEXT=0;                /* ZERO OUT NEXT POINTER         */ 01662000
         L     @07,TVWAQMLB(,TVWAPTR)                              0485 01663000
         ST    @14,QNEXT(,@07)                                     0485 01664000
*           QPREV=TVWAEOQ;          /* POINT TO PREVIOUS ELEMENT     */ 01665000
         L     @14,TVWAEOQ(,TVWAPTR)                               0486 01666000
         ST    @14,QPREV(,@07)                                     0486 01667000
*           QALLOC='0'B;            /* MARK AS GETCELLED             */ 01668000
         NI    QALLOC(@07),B'01111111'                             0487 01669000
*           Q@CURR=HEADER;                                         0488 01670000
         LA    @14,20                                              0488 01671000
         STH   @14,Q@CURR(,@07)                                    0488 01672000
*           Q@STRT=HEADER;                                         0489 01673000
         STH   @14,Q@STRT(,@07)                                    0489 01674000
*           QNBUF=TVWACLSZ;                                        0490 01675000
         LH    @14,TVWACLSZ(,TVWAPTR)                              0490 01676000
         STH   @14,QNBUF(,@07)                                     0490 01677000
*           IF TVWAQMIO='0'B THEN   /* IF ERROR ON INPUT             */ 01678000
         TM    TVWAQMIO(TVWAPTR),B'00001000'                       0491 01679000
         BNZ   @RF00491                                            0491 01680000
*             TEMPA=IKT00400;       /* MARK AS INPUT ERROR           */ 01681000
         LA    TEMPA,4                                             0492 01682000
*           ELSE                    /* IF ERROR OCCURED ON OUTPUT    */ 01683000
*             TEMPA=IKT00401;       /* MARK AS OUTPUT ERROR          */ 01684000
         B     @RC00491                                            0493 01685000
@RF00491 LA    TEMPA,5                                             0493 01686000
*           TEMPA=IKTMSGS(TEMPA);   /* GET POINTER TO PROPER ERROR 0494 01687000
*                                      MSG                           */ 01688000
@RC00491 LR    @14,TEMPA                                           0494 01689000
         SLA   @14,2                                               0494 01690000
         L     @07,CVTPTR                                          0494 01691000
         L     @07,TCASTPTR(,@07)                                  0494 01692000
         L     @07,TCASMSGS(,@07)                                  0494 01693000
         AL    @07,@CF02269                                        0494 01694000
         L     @14,IKTMSGS(@14,@07)                                0494 01695000
         LR    TEMPA,@14                                           0494 01696000
*           IF TVWACLSZ-HEADER<MSGLENG THEN                        0495 01697000
         LH    @14,TVWACLSZ(,TVWAPTR)                              0495 01698000
         LR    @07,@14                                             0495 01699000
         SL    @07,@CF00137                                        0495 01700000
         CH    @07,MSGLENG(,TEMPA)                                 0495 01701000
         BNL   @RF00495                                            0495 01702000
*             QNBQE=TVWACLSZ;                                      0496 01703000
         L     @07,TVWAQMLB(,TVWAPTR)                              0496 01704000
         STH   @14,QNBQE(,@07)                                     0496 01705000
*           ELSE                                                   0497 01706000
*             QNBQE=HEADER+MSGLENG;                                0497 01707000
         B     @RC00495                                            0497 01708000
@RF00495 L     @14,TVWAQMLB(,TVWAPTR)                              0497 01709000
         LA    @07,20                                              0497 01710000
         AH    @07,MSGLENG(,TEMPA)                                 0497 01711000
         STH   @07,QNBQE(,@14)                                     0497 01712000
*           MVC(QELE(HEADER:QNBQE),EMSG(1:MSGLENG));               0498 01713000
@RC00495 L     @14,TVWAQMLB(,TVWAPTR)                              0498 01714000
         L     @07,TVWAQMLB(,TVWAPTR)                              0498 01715000
         LH    @07,QNBQE(,@07)                                     0498 01716000
         N     @07,@CF02260                                        0498 01717000
         SL    @07,@CF00137                                        0498 01718000
         EX    @07,@SM02270                                        0498 01719000
*           TVWAEOQ->QNEXT=TVWAQMLB;                               0499 01720000
         L     @07,TVWAEOQ(,TVWAPTR)                               0499 01721000
         ST    @14,QNEXT(,@07)                                     0499 01722000
*           TVWAEOQ=TVWAQMLB;                                      0500 01723000
         ST    @14,TVWAEOQ(,TVWAPTR)                               0500 01724000
*         END;                                                     0501 01725000
*       RFY                                                        0502 01726000
*         R15 UNRSTD;                                              0502 01727000
*                                                                  0502 01728000
@RF00481 DS    0H                                                  0503 01729000
*       /*************************************************************/ 01730000
*       /*                                                           */ 01731000
*       /* LOG TVWA AND SDWA                                         */ 01732000
*       /*                                                           */ 01733000
*       /*************************************************************/ 01734000
*                                                                  0503 01735000
*       SDWAFRM1=ADDR(TVWA);        /* SET BEGINNING AND ENDING    0503 01736000
*                                      ADDRESS                       */ 01737000
         ST    TVWAPTR,SDWAFRM1(,SDWAPTR)                          0503 01738000
*       SDWATO1=ADDR(TVWA)+LENGTH(TVWA);/* OF TVWA FOR RECORDING     */ 01739000
*                                                                  0504 01740000
         LA    @07,216                                             0504 01741000
         ALR   @07,TVWAPTR                                         0504 01742000
         ST    @07,SDWATO1(,SDWAPTR)                               0504 01743000
*       /*************************************************************/ 01744000
*       /*                                                           */ 01745000
*       /* VERIFY NEXT MESSAGE POINTER                               */ 01746000
*       /*                                                           */ 01747000
*       /*************************************************************/ 01748000
*                                                                  0505 01749000
*       TEMP3=MTVWABQ;              /* START AT BEGINNING OF QUEUE   */ 01750000
         L     TEMP3,MTVWABQ(,QPTR)                                0505 01751000
*       DO WHILE TEMP3^=0&          /* DO WHILE THERE ARE ELEMENTS   */ 01752000
*             TEMP3^=MTVWANM;       /* AND NEXT MESSAGE PTR IS NOT 0506 01753000
*                                      YET VERIFIED                  */ 01754000
         B     @DE00506                                            0506 01755000
@DL00506 DS    0H                                                  0507 01756000
*         TEMP3=TEMP3->QNEXT;       /* GO TO NEXT ELEMENT            */ 01757000
         L     TEMP3,QNEXT(,TEMP3)                                 0507 01758000
*       END;                                                       0508 01759000
@DE00506 LTR   TEMP3,TEMP3                                         0508 01760000
         BZ    @DC00506                                            0508 01761000
         C     TEMP3,MTVWANM(,QPTR)                                0508 01762000
         BNE   @DL00506                                            0508 01763000
@DC00506 DS    0H                                                  0509 01764000
*       IF TEMP3^=MTVWANM THEN      /* IF VERIFY WAS NOT SUCCESSFUL  */ 01765000
         C     TEMP3,MTVWANM(,QPTR)                                0509 01766000
         BE    @RF00509                                            0509 01767000
*         MTVWANM=MTVWABQ;                                         0510 01768000
         L     @07,MTVWABQ(,QPTR)                                  0510 01769000
         ST    @07,MTVWANM(,QPTR)                                  0510 01770000
*       GEN REFS(PSACSTK,PSA,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,FRRSELEN,  01771000
*           FRRSFRRA,FRRSENTR,FRRSPARM,FRRSEMP) SETS(R14,R15);     0511 01772000
*                                                                  0511 01773000
@RF00509 DS    0H                                                  0511 01774000
        SETFRR  D,WRKREGS=(R14,R15)                                     01775000
*       /*************************************************************/ 01776000
*       /*                                                           */ 01777000
*       /* INDICATE RETRY IS TO TAKE PLACE                           */ 01778000
*       /*                                                           */ 01779000
*       /*************************************************************/ 01780000
*                                                                  0512 01781000
*       SDWARCDE=SDWARETY;          /* SET RETURN CODE TO RETRY      */ 01782000
         MVI   SDWARCDE(SDWAPTR),X'04'                             0512 01783000
*       SDWAUPRG='1'B;              /* INDICATE RETRY REGS TO BE USED*/ 01784000
         OI    SDWAUPRG(SDWAPTR),B'00001000'                       0513 01785000
*       IF TVWAQMIO='0'B THEN       /* IF INPUT WAS BEING DONE       */ 01786000
         TM    TVWAQMIO(TVWAPTR),B'00001000'                       0514 01787000
         BNZ   @RF00514                                            0514 01788000
*         DO;                                                      0515 01789000
*           SDWACSCT=INQM;          /* PUT NAME OF CSECT IN SDWA     */ 01790000
         MVC   SDWACSCT(8,SDWAPTR),INQM                            0516 01791000
*           SDWARTYA=ADDR(BRAN);    /* RETRY AT INPUT POINT          */ 01792000
         LA    @10,BRAN                                            0517 01793000
         ST    @10,SDWARTYA(,SDWAPTR)                              0517 01794000
*         END;                                                     0518 01795000
*       ELSE                                                       0519 01796000
*         DO;                                                      0519 01797000
         B     @RC00514                                            0519 01798000
@RF00514 DS    0H                                                  0520 01799000
*           SDWACSCT=OUTQM;         /* PUT NAME OF CSECT IN SDWA     */ 01800000
         MVC   SDWACSCT(8,SDWAPTR),OUTQM                           0520 01801000
*           SDWARTYA=ADDR(BRAN2);   /* RETRY AT OUTPUT POINT         */ 01802000
         LA    @10,BRAN2                                           0521 01803000
         ST    @10,SDWARTYA(,SDWAPTR)                              0521 01804000
*         END;                                                     0522 01805000
*     END;                                                         0523 01806000
@RC00514 DS    0H                                                  0524 01807000
*   RFY                                                            0524 01808000
*     SDWAPTR UNRSTD;                                              0524 01809000
@RF00439 DS    0H                                                  0525 01810000
*   GEN NOSEQFLOW EXIT;                                            0525 01811000
         L    R14,@SA00003             RESTORE REG 14                   01812000
         BR   R14                                                       01813000
         EJECT                                                          01814000
*   GEN;                                                           0526 01815000
EP0004    DS   0H                                                       01816000
*IKTQMEV:                                                          0527 01817000
*   ENTRY;                                                         0527 01818000
*                                                                  0527 01819000
*/* THIS ROUTINE IS TO VERIFY THAT ELEMENTS IN THE QUEUE ARE PROPER  */ 01820000
*                                                                  0528 01821000
*   GEN;                                                           0528 01822000
         DROP  DATARG                                                   01823000
         MODESET EXTKEY=TCAM      GET IN KEY 6 FOR STOR REF @YM03224    01824000
*   RFY                                                            0529 01825000
*    (R0,                                                          0529 01826000
*     R1) RSTD;                                                    0529 01827000
*   VERADD=R0;                      /* PUT ADDRESS OF ELEMENT TO BE     01828000
*                                      VERIFIED IN A REGISTER        */ 01829000
         LR    VERADD,R0                                           0530 01830000
*   RFY                                                            0531 01831000
*     QELE BASED(VERADD);                                          0531 01832000
*   TVWAQMEV='1'B;                  /* SET FOOTPRINT                 */ 01833000
         OI    TVWAQMEV(TVWAPTR),B'00000100'                       0532 01834000
*   RFY                                                            0533 01835000
*     R15 RSTD;                                                    0533 01836000
*   IF QALLOC='1'B THEN             /* IF THIS ELEMENT WAS GETMAIN'D */ 01837000
         TM    QALLOC(VERADD),B'10000000'                          0534 01838000
         BNO   @RF00534                                            0534 01839000
*     IF QNBQE=QNBUF THEN           /* IF QUEUE ELE. SIZE=BUFFER SIZE*/ 01840000
         LH    @14,QNBQE(,VERADD)                                  0535 01841000
         N     @14,@CF02260                                        0535 01842000
         CH    @14,QNBUF(,VERADD)                                  0535 01843000
         BNE   @RF00535                                            0535 01844000
*       R15=0;                      /* ASSUME QUEUE ELEMENT IS GOOD  */ 01845000
         SLR   R15,R15                                             0536 01846000
*     ELSE                                                         0537 01847000
*       R15=8;                      /* OTHERWISE IT IS A BAD ELEMENT */ 01848000
         B     @RC00535                                            0537 01849000
@RF00535 LA    R15,8                                               0537 01850000
*   ELSE                                                           0538 01851000
*     IF QNBUF=TVWACLSZ THEN        /* IF BUFFER SIZE=CELL SIZE      */ 01852000
         B     @RC00534                                            0538 01853000
@RF00534 CLC   QNBUF(2,VERADD),TVWACLSZ(TVWAPTR)                   0538 01854000
         BNE   @RF00538                                            0538 01855000
*       R15=0;                      /* ASSUME QUEUE ELEMENT IS GOOD  */ 01856000
         SLR   R15,R15                                             0539 01857000
*     ELSE                                                         0540 01858000
*       R15=8;                      /* OTHERWISE THIS IS A BAD     0540 01859000
*                                      ELEMENT                       */ 01860000
         B     @RC00538                                            0540 01861000
@RF00538 LA    R15,8                                               0540 01862000
*EVRETRY:                                                          0541 01863000
*   TVWAQMEV='0'B;                  /* RESET FOOTPRINT               */ 01864000
@RC00538 DS    0H                                                  0541 01865000
@RC00534 DS    0H                                                  0541 01866000
EVRETRY  NI    TVWAQMEV(TVWAPTR),B'11111011'                       0541 01867000
*   RFY                                                            0542 01868000
*    (R0,                                                          0542 01869000
*     R1,                                                          0542 01870000
*     R15) UNRSTD;                                                 0542 01871000
*   GEN NOSEQFLOW EXIT;                                            0543 01872000
        MODESET EXTKEY=ZERO     RETURN TO KEY ZERO          @YM03224    01873000
        LM    R0,R14,4(R1)      RESTORE REGS                            01874000
        BR    R14                                                       01875000
         EJECT                                                          01876000
*   GEN;                                                           0544 01877000
EP0005   DS    0H                                                       01878000
*IKTQMFR2:                                                         0545 01879000
*   ENTRY;                                                         0545 01880000
*                                                                  0545 01881000
*/* THIS ROUTINE IS FOR HANDLING ERROR CONDITIONS IN THE ELEMENT   0546 01882000
*   VERIFICATION ROUTINE. IT IS ENTERED WHEN EVER AN ERROR OCCURS IN    01883000
*   IKTQMFR1, IKTQMEV OR IEAVEQV3                                    */ 01884000
*                                                                  0546 01885000
*   RFY                                                            0546 01886000
*     R1 RSTD;                                                     0546 01887000
*   RFY                                                            0547 01888000
*     SDWA BASED(R1);                                              0547 01889000
*   DATARG=TVWAQMWA;                /* PUT @ OF Q MANAGER WORK AREA     01890000
*                                      IN                            */ 01891000
         L     DATARG,TVWAQMWA(,TVWAPTR)                           0548 01892000
*   GEN;                                                           0549 01893000
         USING @DATD,DATARG                                             01894000
         ST    R14,@SA00004     SAVE RETURN ADDRESS                     01895000
*   IF R0^=12 THEN                  /* IF THERE IS AN SDWA           */ 01896000
         C     R0,@CF02219                                         0550 01897000
         BE    @RF00550                                            0550 01898000
*     IF TVWAQMEV='1'B THEN         /* IF FAILURE OCCURED DURING   0551 01899000
*                                      ELEMENT VERIFICATION          */ 01900000
         TM    TVWAQMEV(TVWAPTR),B'00000100'                       0551 01901000
         BNO   @RF00551                                            0551 01902000
*       DO;                                                        0552 01903000
*                                                                  0552 01904000
*/*   INDICATE BAD ELEMENT AND RETRY                                 */ 01905000
*                                                                  0553 01906000
*         SDWARCDE=SDWARETY;        /* SET RETURN CODE TO RETRY      */ 01907000
         MVI   SDWARCDE(R1),X'04'                                  0553 01908000
*         SDWAUPRG='1'B;            /* RETRY REGS TO BE USED TO RETRY*/ 01909000
         OI    SDWAUPRG(R1),B'00001000'                            0554 01910000
*         SDWARTYA=ADDR(EVRETRY);   /* RETRY AT END OF ELEMENT     0555 01911000
*                                      VERIFIER                      */ 01912000
         LA    @10,EVRETRY                                         0555 01913000
         ST    @10,SDWARTYA(,R1)                                   0555 01914000
*         SDWASR15=8;               /* INDICATE THIS ELEMENT WAS BAD */ 01915000
         MVC   SDWASR15(4,R1),@CF00056                             0556 01916000
*       END;                                                       0557 01917000
*     ELSE                          /* IF FAILURE WAS NOT IN ELEMENT    01918000
*                                      VER                           */ 01919000
*       DO;                                                        0558 01920000
*                                                                  0558 01921000
         B     @RC00551                                            0558 01922000
@RF00551 DS    0H                                                  0559 01923000
*/*   OTHERWISE LOG TVWA,SDWA, AND CONTINUE WITH TERMINATION         */ 01924000
*                                                                  0559 01925000
*         SDWARCRD='1'B;            /* INDICATE RECORDING            */ 01926000
         OI    SDWARCRD(R1),B'10000000'                            0559 01927000
*         SDWAFRM1=ADDR(TVWA);      /* SET BEGINNING AND ENDING    0560 01928000
*                                      ADDRESS                       */ 01929000
         ST    TVWAPTR,SDWAFRM1(,R1)                               0560 01930000
*         SDWATO1=ADDR(TVWA)+LENGTH(TVWA);/* OF TVWA FOR RECORDING   */ 01931000
         LA    @10,216                                             0561 01932000
         ALR   @10,TVWAPTR                                         0561 01933000
         ST    @10,SDWATO1(,R1)                                    0561 01934000
*         SDWARCDE=SDWACWT;         /* INDICATE CONTINUE WITH      0562 01935000
*                                      TERMINATION                   */ 01936000
         MVI   SDWARCDE(R1),X'00'                                  0562 01937000
*       END;                                                       0563 01938000
*   RFY                                                            0564 01939000
*     R1 UNRSTD;                                                   0564 01940000
@RC00551 DS    0H                                                  0564 01941000
@RF00550 DS    0H                                                  0565 01942000
*   GEN NOSEQFLOW EXIT;                                            0565 01943000
         L     R14,@SA00004                                             01944000
         BR    R14                                                      01945000
         EJECT                                                          01946000
*DELEL:                                                            0566 01947000
*   PROC OPTIONS(SAVE(14));                                        0566 01948000
*                                                                  0566 01949000
DELEL    ST    @14,@SA00002                                        0566 01950000
*/*  THIS ROUTINE IS TO UNCHAIN A QUEUE ELEMENT FROM EITHER QUEUE AND*/ 01951000
*/*   FREE THE ASSOCIATED STORAGE                                    */ 01952000
*/*   ADDRESS OF ELEMENT TO BE DELETED IS PASSED TO DELEL IN REG 1   */ 01953000
*                                                                  0567 01954000
*   RFY                                                            0567 01955000
*     QELE BASED(R1);                                              0567 01956000
*   RFY                                                            0568 01957000
*     QPTRS BASED(QPTR2);                                          0568 01958000
*   RFY                                                            0569 01959000
*     R1 RSTD;                                                     0569 01960000
*   IF R1=MTVWABQ THEN              /* IF THIS IS FIRST ELEMENT      */ 01961000
         C     R1,MTVWABQ(,QPTR2)                                  0570 01962000
         BNE   @RF00570                                            0570 01963000
*     MTVWABQ=QNEXT;                /* SET BEGINNING OF QUEUE PTR TO    01964000
*                                      NEXT                          */ 01965000
         L     @09,QNEXT(,R1)                                      0571 01966000
         ST    @09,MTVWABQ(,QPTR2)                                 0571 01967000
*   ELSE                                                           0572 01968000
*     QPREV->QNEXT=QNEXT;           /* SET THE NEXT PTR IN THE PREV     01969000
*                                      ELEMENT TO THE NEXT ELEMENT   */ 01970000
         B     @RC00570                                            0572 01971000
@RF00570 L     @09,QPREV(,R1)                                      0572 01972000
         L     @07,QNEXT(,R1)                                      0572 01973000
         ST    @07,QNEXT(,@09)                                     0572 01974000
*   IF R1=MTVWAEQ THEN              /* IF ELE. TO BE DEL'D IS LAST   */ 01975000
@RC00570 C     R1,MTVWAEQ(,QPTR2)                                  0573 01976000
         BNE   @RF00573                                            0573 01977000
*     MTVWAEQ=QPREV;                /* SET END OF QUEUE PTR TO     0574 01978000
*                                      PREVIOUS                      */ 01979000
         L     @09,QPREV(,R1)                                      0574 01980000
         ST    @09,MTVWAEQ(,QPTR2)                                 0574 01981000
*   ELSE                                                           0575 01982000
*     QNEXT->QPREV=QPREV;           /* SET THE PREV PTR IN THE NEXT     01983000
*                                      ELEMENT TO THE PREVIOUS     0575 01984000
*                                      ELEMENT                       */ 01985000
         B     @RC00573                                            0575 01986000
@RF00573 L     @09,QNEXT(,R1)                                      0575 01987000
         L     @07,QPREV(,R1)                                      0575 01988000
         ST    @07,QPREV(,@09)                                     0575 01989000
*   IF R1=MTVWANM THEN              /* IF ELE TO BE DEL'D IS NEXT  0576 01990000
*                                      MESSAG                        */ 01991000
@RC00573 C     R1,MTVWANM(,QPTR2)                                  0576 01992000
         BNE   @RF00576                                            0576 01993000
*     MTVWANM=QNEXT;                /* SET NEXT MESSAGE PTR TO THE 0577 01994000
*                                      NEXT                          */ 01995000
         L     @09,QNEXT(,R1)                                      0577 01996000
         ST    @09,MTVWANM(,QPTR2)                                 0577 01997000
*   IF QALLOC='0'B THEN             /* IF THIS ELE WAS GETCELL'D     */ 01998000
@RF00576 TM    QALLOC(R1),B'10000000'                              0578 01999000
         BNZ   @RF00578                                            0578 02000000
*     IF TVWAQLBU='1'B THEN         /* IF LOOK ASIDE BUFFER IS IN USE*/ 02001000
         TM    TVWAQLBU(TVWAPTR),B'00000100'                       0579 02002000
         BNO   @RF00579                                            0579 02003000
*       DO;                                                        0580 02004000
*         TVWAQMLB=R1;              /* SET LOOK ASIDE BUFFER ADDRESS    02005000
*                                      TO ADDRESS OF ELEMENT TO BE 0581 02006000
*                                      DELETED                       */ 02007000
         ST    R1,TVWAQMLB(,TVWAPTR)                               0581 02008000
*         TVWAQLBU='0'B;            /* SET LOOK ASIDE BUFFER FLAG TO    02009000
*                                      'NOT IN USE'                  */ 02010000
         NI    TVWAQLBU(TVWAPTR),B'11111011'                       0582 02011000
*       END;                                                       0583 02012000
*     ELSE                                                         0584 02013000
*       DO;                                                        0584 02014000
         B     @RC00579                                            0584 02015000
@RF00579 DS    0H                                                  0585 02016000
*         RFY                                                      0585 02017000
*          (R0,                                                    0585 02018000
*           R15) RSTD;                                             0585 02019000
*         R0=TVWACPID;              /* GET CELL POOL IDENTIFIER      */ 02020000
         L     R0,TVWACPID(,TVWAPTR)                               0586 02021000
*         GEN REFS(R0,R1,CVTFRECL,CVTMAP) SETS(R14,R15);           0587 02022000
        FREECELL CPID=(0),CELL=(1),BRANCH=YES                           02023000
*         IF R15>4 THEN             /* IF RC SAYS CELL OR CELLPOOL 0588 02024000
*                                      BAD                           */ 02025000
         C     R15,@CF00099                                        0588 02026000
         BNH   @RF00588                                            0588 02027000
*           IF R15=AUTODEL THEN     /* IF A POOL EXTENT CAN NOW BE 0589 02028000
*                                      FREED                         */ 02029000
         C     R15,@CF00137                                        0589 02030000
         BNE   @RF00589                                            0589 02031000
*             DO;                                                  0590 02032000
*               RFY                                                0591 02033000
*                (R4,                                              0591 02034000
*                 R7) RSTD;                                        0591 02035000
*               R0=4096;            /* LENGTH OF FREEMAIN IN REG 0   */ 02036000
         L     R0,@CF02165                                         0592 02037000
*               R4=TVWATCB;         /* PUT TCB @ IN REG 4 FOR BRANCH    02038000
*                                      ENTRY                         */ 02039000
         L     R4,TVWATCB(,TVWAPTR)                                0593 02040000
*               R7=PSAAOLD;         /* PUT ASCB @ IN REG7 FOR BRANCH    02041000
*                                      ENTRY                         */ 02042000
         L     R7,PSAAOLD                                          0594 02043000
*               RFY                                                0595 02044000
*                 R3 RSTD;                                         0595 02045000
*               GEN REFS(R0,R1,CVTRMBR,CVTMAP,CVTPTR) SETS(R2,R3,R14,   02046000
*                   R15);                                          0596 02047000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2    SAVE CALLERS KEY   02048000
        FREEMAIN RU,LV=(0),A=(1),BRANCH=YES,KEY=TCASKEY,SP=SP229        02049000
        MODESET KEYADDR=(2)                       RESTORE CALLERS KEY   02050000
*               RFY                                                0597 02051000
*                (R0,                                              0597 02052000
*                 R3,                                              0597 02053000
*                 R4,                                              0597 02054000
*                 R7) UNRSTD;                                      0597 02055000
*             END;                                                 0598 02056000
*           ELSE                                                   0599 02057000
*             GEN;                                                 0599 02058000
         B     @RC00589                                            0599 02059000
@RF00589 DS    0H                                                  0599 02060000
        ABEND X'0AD',,,SYSTEM                                           02061000
*       END;                                                       0600 02062000
*   ELSE                                                           0601 02063000
*     DO;                                                          0601 02064000
         B     @RC00578                                            0601 02065000
@RF00578 DS    0H                                                  0602 02066000
*       RFY                                                        0602 02067000
*        (R0,                                                      0602 02068000
*         R4,                                                      0602 02069000
*         R7) RSTD;                                                0602 02070000
*       R0=QNBUF;                   /* LENGTH OF FREEMAIN IN REG 0   */ 02071000
         LH    R0,QNBUF(,R1)                                       0603 02072000
*       R4=TVWATCB;                 /* PUT TCB @ IN REG 4 FOR BRANCH    02073000
*                                      ENTRY                         */ 02074000
         L     R4,TVWATCB(,TVWAPTR)                                0604 02075000
*       R7=ASCBPTR;                 /* PUT ASCB @ IN REG7 FOR BRANCH    02076000
*                                      ENTRY                         */ 02077000
         L     R7,ASCBPTR                                          0605 02078000
*       RFY                                                        0606 02079000
*         R3 RSTD;                                                 0606 02080000
*       GEN REFS(R0,R1,CVTRMBR,CVTMAP,CVTPTR) SETS(R2,R3,R14,R15); 0607 02081000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2    SAVE CALLERS KEY   02082000
         FREEMAIN RU,LV=(0),A=(1),BRANCH=YES,KEY=TCASKEY,SP=SP229       02083000
        MODESET KEYADDR=(2)                       RESTORE CALLERS KEY   02084000
*       RFY                                                        0608 02085000
*        (R0,                                                      0608 02086000
*         R3,                                                      0608 02087000
*         R4,                                                      0608 02088000
*         R7) UNRSTD;                                              0608 02089000
*     END;                                                         0609 02090000
*   RFY                                                            0610 02091000
*    (R1,                                                          0610 02092000
*     R15) UNRSTD;                                                 0610 02093000
*   END DELEL;                                                     0611 02094000
@EL00002 DS    0H                                                  0611 02095000
@EF00002 DS    0H                                                  0611 02096000
@ER00002 L     @14,@SA00002                                        0611 02097000
         BR    @14                                                 0611 02098000
         EJECT                                                          02099000
*BLDELE:                                                           0612 02100000
*   PROC OPTIONS(SAVE(14));                                        0612 02101000
*                                                                  0612 02102000
BLDELE   ST    @14,@SA00003                                        0612 02103000
*/*  THIS ROUTINE IS TO BUILD A QUEUE ELEMENT FOR EITHER QUEUE AND   */ 02104000
*/*  CHAIN IT ON THE END OF THE QUEUE                                */ 02105000
*/*  ADDRESS OF NEW ELEMENT IS RETURNED IN REG 1                     */ 02106000
*                                                                  0613 02107000
*   RFY                                                            0613 02108000
*     QELE BASED(R1);                                              0613 02109000
*   RFY                                                            0614 02110000
*     QPTRS BASED(QPTR1);                                          0614 02111000
*   RFY                                                            0615 02112000
*     R1 RSTD;                                                     0615 02113000
*   IF PBFSZ+HEADER>TVWACLSZ THEN   /* IF BUFFER NEEDED IS BIGGER  0616 02114000
*                                      THAN A                        */ 02115000
         LA    @10,20                                              0616 02116000
         AH    @10,PBFSZ                                           0616 02117000
         CH    @10,TVWACLSZ(,TVWAPTR)                              0616 02118000
         BNH   @RF00616                                            0616 02119000
*     DO;                           /* NORMAL BUFFER                 */ 02120000
*       RFY                                                        0618 02121000
*        (R0,                                                      0618 02122000
*         R4,                                                      0618 02123000
*         R7,                                                      0618 02124000
*         R15) RSTD;                                               0618 02125000
*       R0=PBFSZ+HEADER;            /* SET SIZE OF GETMAIN           */ 02126000
         LR    R0,@10                                              0619 02127000
*       R4=TVWATCB;                 /* SET TCB @ FOR BRANCH ENTRY  0620 02128000
*                                      GETMAIN                       */ 02129000
         L     R4,TVWATCB(,TVWAPTR)                                0620 02130000
*       R7=PSAAOLD;                 /* SET ASCB@ FOR BRANCH ENTRY    */ 02131000
*                                                                  0621 02132000
         L     R7,PSAAOLD                                          0621 02133000
*       /*************************************************************/ 02134000
*       /*                                                           */ 02135000
*       /* GETMAIN A BUFFER FOR USE                                  */ 02136000
*       /*                                                           */ 02137000
*       /*************************************************************/ 02138000
*                                                                  0622 02139000
*       GEN REFS(R0,R4,R7,CVTCRMN,CVTPTR) SETS(R1,R2,R3,R14,R15);  0622 02140000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2    SAVE CALLERS KEY   02141000
        GETMAIN RC,LV=(0),SP=SP229,BRANCH=YES,KEY=TCASKEY               02142000
        MODESET KEYADDR=(2)                                             02143000
*       RFY                                                        0623 02144000
*        (R4,                                                      0623 02145000
*         R7) UNRSTD;                                              0623 02146000
*       IF R15=0 THEN               /* IF GETMAIN WAS SUCCESSFUL     */ 02147000
         LTR   R15,R15                                             0624 02148000
         BNZ   @RF00624                                            0624 02149000
*         DO;                                                      0625 02150000
*           QNBUF=R0;               /* PUT NO. OF BYTES IN BUFFER    */ 02151000
         STH   R0,QNBUF(,R1)                                       0626 02152000
*           QALLOC='1'B;            /* SET ALLOC BIT TO GETMAIN'D    */ 02153000
         OI    QALLOC(R1),B'10000000'                              0627 02154000
*         END;                                                     0628 02155000
*     END;                                                         0629 02156000
*   ELSE                            /* IF BUFFER NEEDED IS A NORMAL  */ 02157000
*     DO;                           /* SIZE OR LESS                  */ 02158000
         B     @RC00616                                            0630 02159000
@RF00616 DS    0H                                                  0631 02160000
*       R0=TVWACPID;                /* SET REG 0 TO CELL POOL ID     */ 02161000
         L     R0,TVWACPID(,TVWAPTR)                               0631 02162000
*       GEN REFS(R0,CVTGETCL,CVTMAP) SETS(R1,R14,R15);             0632 02163000
*                                                    /* GETCELL  */     02164000
       GETCELL CPID=(0),BRANCH=YES                                      02165000
*       RFY                                                        0633 02166000
*         R0 UNRSTD;                                               0633 02167000
*       IF R15=0 THEN               /* IF GETCELL WAS SUCCESSFUL     */ 02168000
         LTR   R15,R15                                             0634 02169000
         BNZ   @RF00634                                            0634 02170000
*         DO;                                                      0635 02171000
*           QNBUF=TVWACLSZ;         /* SET SIZE OF BUFFER            */ 02172000
         LH    @14,TVWACLSZ(,TVWAPTR)                              0636 02173000
         STH   @14,QNBUF(,R1)                                      0636 02174000
*           QALLOC='0'B;            /* MARK THIS BUFFER GETCELL'D    */ 02175000
         NI    QALLOC(R1),B'01111111'                              0637 02176000
*         END;                                                     0638 02177000
*       ELSE                        /* IF GETCELL FAILED             */ 02178000
*         IF R15>12 THEN                                           0639 02179000
         B     @RC00634                                            0639 02180000
@RF00634 C     R15,@CF02219                                        0639 02181000
         BNH   @RF00639                                            0639 02182000
*           GEN;                                                   0640 02183000
        ABEND X'0AD',,,SYSTEM                                           02184000
*         ELSE                                                     0641 02185000
*           DO;                                                    0641 02186000
         B     @RC00639                                            0641 02187000
@RF00639 DS    0H                                                  0642 02188000
*             RFY                                                  0642 02189000
*              (R0,                                                0642 02190000
*               R4,                                                0642 02191000
*               R7) RSTD;                                          0642 02192000
*             R0=4096;              /* LENGTH OF GETMAIN AREA        */ 02193000
         L     R0,@CF02165                                         0643 02194000
*             R4=TVWATCB;                                          0644 02195000
         L     R4,TVWATCB(,TVWAPTR)                                0644 02196000
*             R7=PSAAOLD;                                          0645 02197000
         L     R7,PSAAOLD                                          0645 02198000
*             GEN REFS(R0,R4,R7,CVTCRMN,CVTMAP) SETS(R1,R2,R3,R14,R15); 02199000
        MODESET EXTKEY=ZERO,SAVEKEY=(2),WORKREG=2     SAVE CALLERS KEY  02200000
       GETMAIN RC,LV=(0),SP=SP229,BNDRY=PAGE,BRANCH=YES,KEY=TCASKEY     02201000
        MODESET KEYADDR=(2)                      RETURN TO CALLERS KEY  02202000
*             RFY                                                  0647 02203000
*              (R0,                                                0647 02204000
*               R4,                                                0647 02205000
*               R7) UNRSTD;                                        0647 02206000
*             IF R15=0 THEN         /* IF GTMN FOR POOL EXTNT      0648 02207000
*                                      SUCCESSFUL                    */ 02208000
         LTR   R15,R15                                             0648 02209000
         BNZ   @RF00648                                            0648 02210000
*               DO;                                                0649 02211000
*                 RFY                                              0650 02212000
*                  (R0,                                            0650 02213000
*                   R3) RSTD;                                      0650 02214000
*                 R3=TVWACLSZ;      /* PUT SIZE OF A CELL IN REG 3   */ 02215000
         LH    R3,TVWACLSZ(,TVWAPTR)                               0651 02216000
*                 R0=TVWACPID;      /* SET REG 0 TO CELL POOL ID     */ 02217000
         L     R0,TVWACPID(,TVWAPTR)                               0652 02218000
*                 GEN REFS(R0,R1,R3,R13,CVTBLDCP,CVTGETCL,CVTMAP) SETS( 02219000
*                     R1,R14,R15);                                 0653 02220000
         BLDCPOOL CPID=(0),BRANCH=YES,AUTODEL=YES,CPADDR=(1),         ++02221000
               CSIZE=(R3),POOLSIZ=4,SP=SP229                            02222000
         GETCELL  CPID=(0),BRANCH=YES                                   02223000
*                 RFY                                              0654 02224000
*                  (R0,                                            0654 02225000
*                   R3) UNRSTD;                                    0654 02226000
*                 QALLOC='0'B;      /* MARK THIS BUFFER AS GETCELL'D */ 02227000
         NI    QALLOC(R1),B'01111111'                              0655 02228000
*                 QNBUF=TVWACLSZ;   /* SET NO. OF BYTES TO CELL SIZE */ 02229000
         LH    @14,TVWACLSZ(,TVWAPTR)                              0656 02230000
         STH   @14,QNBUF(,R1)                                      0656 02231000
*               END;                                               0657 02232000
*           END;                                                   0658 02233000
@RF00648 DS    0H                                                  0659 02234000
*     END;                                                         0659 02235000
@RC00639 DS    0H                                                  0659 02236000
@RC00634 DS    0H                                                  0660 02237000
*   IF R15>0&TVWAQMIO='1'B&TVWAQLBU='0'B THEN                      0660 02238000
@RC00616 LTR   R15,R15                                             0660 02239000
         BNP   @RF00660                                            0660 02240000
         TM    TVWAQMIO(TVWAPTR),B'00001000'                       0660 02241000
         BNO   @RF00660                                            0660 02242000
         TM    TVWAQLBU(TVWAPTR),B'00000100'                       0660 02243000
         BNZ   @RF00660                                            0660 02244000
*     DO;                                                          0661 02245000
*       TVWAQLBU='1'B;              /* MARK LOOK ASIDE BUFFER AS IN     02246000
*                                      USE                           */ 02247000
         OI    TVWAQLBU(TVWAPTR),B'00000100'                       0662 02248000
*       R1=TVWAQMLB;                /* PUT @ OF LOOK ASIDE BUFFER IN    02249000
*                                      R1                            */ 02250000
         L     R1,TVWAQMLB(,TVWAPTR)                               0663 02251000
*       R15=0;                      /* RESET REGISTER 15             */ 02252000
         SLR   R15,R15                                             0664 02253000
*       QNBUF=TVWACLSZ;             /* SET SIZE OF THE BUFFER        */ 02254000
         LH    @14,TVWACLSZ(,TVWAPTR)                              0665 02255000
         STH   @14,QNBUF(,R1)                                      0665 02256000
*       IF PBFSZ+HEADER>TVWACLSZ THEN/* IF SIZE OF BUFFER NEEDED IS     02257000
*                                      BIGGER THAN A CELL            */ 02258000
         LA    @10,20                                              0666 02259000
         LH    @09,PBFSZ                                           0666 02260000
         ALR   @09,@10                                             0666 02261000
         CR    @09,@14                                             0666 02262000
         BNH   @RF00666                                            0666 02263000
*         PBFSZ=TVWACLSZ-HEADER;                                   0667 02264000
         SLR   @14,@10                                             0667 02265000
         STH   @14,PBFSZ                                           0667 02266000
*     END;                                                         0668 02267000
@RF00666 DS    0H                                                  0669 02268000
*   IF R15=0 THEN                                                  0669 02269000
@RF00660 SLR   @14,@14                                             0669 02270000
         CR    R15,@14                                             0669 02271000
         BNE   @RF00669                                            0669 02272000
*     DO;                                                          0670 02273000
*       QFLGMV=PFLGMV;              /* SET THE FLAGS IN THE QUEUE  0671 02274000
*                                      ELEMENT                       */ 02275000
         MVC   QFLGMV(3,R1),PFLGMV                                 0671 02276000
*       QNBQE=PBFSZ+HEADER;         /* SET THE SIZE OF BUFFER        */ 02277000
         LA    @10,20                                              0672 02278000
         LH    @09,PBFSZ                                           0672 02279000
         ALR   @09,@10                                             0672 02280000
         STH   @09,QNBQE(,R1)                                      0672 02281000
*       Q@STRT=HEADER;              /* SET START OFFSET PAST HEADER  */ 02282000
         STH   @10,Q@STRT(,R1)                                     0673 02283000
*       Q@CURR=HEADER;              /* SET THE CURRENT OFFSET PAST 0674 02284000
*                                      HEADER                        */ 02285000
         STH   @10,Q@CURR(,R1)                                     0674 02286000
*       QPREV=MTVWAEQ;              /* SET PREVIOUS PTR IN NEW QUEUE    02287000
*                                      ELE                           */ 02288000
         L     @10,MTVWAEQ(,QPTR1)                                 0675 02289000
         ST    @10,QPREV(,R1)                                      0675 02290000
*       QNEXT=0;                    /* SET NEXT PTR IN NEW QUEUE   0676 02291000
*                                      ELEMENT                       */ 02292000
         ST    @14,QNEXT(,R1)                                      0676 02293000
*       IF MTVWABQ=0 THEN           /* IF THERE IS NOTHING ON QUEUE  */ 02294000
         C     @14,MTVWABQ(,QPTR1)                                 0677 02295000
         BNE   @RF00677                                            0677 02296000
*         DO;                                                      0678 02297000
*           MTVWANM=R1;             /* SET NEXT MESSAGE TO NEW     0679 02298000
*                                      ELEMENT                       */ 02299000
         ST    R1,MTVWANM(,QPTR1)                                  0679 02300000
*           MTVWABQ=R1;             /* SET START OF QUEUE TO NEW   0680 02301000
*                                      ELEMENT                       */ 02302000
         ST    R1,MTVWABQ(,QPTR1)                                  0680 02303000
*         END;                                                     0681 02304000
*       ELSE                        /* IF THERE IS ALREADY SOMETHING    02305000
*                                      ON THE QUEUE                  */ 02306000
*         DO;                                                      0682 02307000
         B     @RC00677                                            0682 02308000
@RF00677 DS    0H                                                  0683 02309000
*           MTVWAEQ->QNEXT=R1;      /* CHAIN THIS MESSAGE ON END OF     02310000
*                                      QUEUE                         */ 02311000
         L     @14,MTVWAEQ(,QPTR1)                                 0683 02312000
         ST    R1,QNEXT(,@14)                                      0683 02313000
*           IF MTVWANM=0 THEN       /* IF THERE IS NO NEXT MESSAGE   */ 02314000
         L     @14,MTVWANM(,QPTR1)                                 0684 02315000
         LTR   @14,@14                                             0684 02316000
         BNZ   @RF00684                                            0684 02317000
*             MTVWANM=R1;           /* SET NEXT MESSAGE PTR TO NEW 0685 02318000
*                                      ELE                           */ 02319000
         ST    R1,MTVWANM(,QPTR1)                                  0685 02320000
*         END;                                                     0686 02321000
@RF00684 DS    0H                                                  0687 02322000
*       MTVWAEQ=R1;                 /* SET END OF QUEUE PTR TO NEW 0687 02323000
*                                      ELE.                          */ 02324000
@RC00677 ST    R1,MTVWAEQ(,QPTR1)                                  0687 02325000
*       PBUFADR=Q@CURR+R1;          /* PASS BUFFER @ BACK TO CALLER  */ 02326000
         LR    @14,R1                                              0688 02327000
         AH    @14,Q@CURR(,R1)                                     0688 02328000
         ST    @14,PBUFADR                                         0688 02329000
*     END;                                                         0689 02330000
*   RFY                                                            0690 02331000
*    (R1,                                                          0690 02332000
*     R15) UNRSTD;                                                 0690 02333000
*   END BLDELE;                                                    0691 02334000
@EL00003 DS    0H                                                  0691 02335000
@EF00003 DS    0H                                                  0691 02336000
@ER00003 L     @14,@SA00003                                        0691 02337000
         BR    @14                                                 0691 02338000
         EJECT                                                          02339000
*MARKDISP:                                                         0692 02340000
*   PROC OPTIONS(SAVE(14));                                        0692 02341000
*                                                                  0692 02342000
MARKDISP ST    @14,@SA00004                                        0692 02343000
*/* THIS ROUTINE DISPATCHES TASKS SUSPENDED FOR BUFFER OVERUSE AND   */ 02344000
*/* RESETS INDICATORS                                                */ 02345000
*                                                                  0693 02346000
*   RFY                                                            0693 02347000
*     TSB BASED(TSBPTR);                                           0693 02348000
*   IF TSBNOBUF='1'B&TSBOWAIT='1'B THEN/* IF A TASK IN THIS ADDRESS     02349000
*                                      SPACE IS WAITING              */ 02350000
         TM    TSBNOBUF(TSBPTR),B'00010000'                        0694 02351000
         BNO   @RF00694                                            0694 02352000
         TM    TSBOWAIT(TSBPTR),B'00100000'                        0694 02353000
         BNO   @RF00694                                            0694 02354000
*     DO;                                                          0695 02355000
*       TSBOWAIT='0'B;              /* CLEAR TASK IS WAITING FLAG    */ 02356000
         NI    TSBOWAIT(TSBPTR),B'11011111'                        0696 02357000
*/*   CALL STATUS BRANCH ENTRY                                       */ 02358000
*                                                                  0697 02359000
*       RFY                                                        0697 02360000
*        (R0,                                                      0697 02361000
*         R1,                                                      0697 02362000
*         R10,                                                     0697 02363000
*         R13) RSTD;                                               0697 02364000
*       R0=8;                       /* ENTRY CODE IN REG0    @YM03241*/ 02365000
         LA    R0,8                                                0698 02366000
*       R1='80000000'X;             /* INDICATES DESET               */ 02367000
         L     R1,@CF02250                                         0699 02368000
*       R10=R13;                    /* MOVE ADDRESS OF SAVE AREA TO     02369000
*                                      REG 10                        */ 02370000
         LR    R10,R13                                             0700 02371000
*       R13='0400'X;                /* INDICATES TCBOWAIT IS BIT   0701 02372000
*                                      MANIPULATED                   */ 02373000
         LA    R13,1024                                            0701 02374000
*       CALL STATUS;                                               0702 02375000
         L     @07,CVTPTR                                          0702 02376000
         L     @07,SCVTSPTR(,@07)                                  0702 02377000
         L     @15,SCVTSTAT(,@07)                                  0702 02378000
         BALR  @14,@15                                             0702 02379000
*       R13=R10;                    /* MOVE SAVE AREA @ BACK TO REG     02380000
*                                      13                            */ 02381000
         LR    R13,R10                                             0703 02382000
*       RFY                                                        0704 02383000
*        (R0,                                                      0704 02384000
*         R1,                                                      0704 02385000
*         R10,                                                     0704 02386000
*         R13) UNRSTD;                                             0704 02387000
*     END;                                                         0705 02388000
*   TSBNOBUF='0'B;                  /* CLEAR TASK WAITING ON BUFFERS    02389000
*                                      FLAG                          */ 02390000
@RF00694 NI    TSBNOBUF(TSBPTR),B'11101111'                        0706 02391000
*   IF TSBTJBF='1'B THEN            /* IF A TASK IS WAITING IN     0707 02392000
*                                      ANOTHER ADDRESS SPACE         */ 02393000
*                                                                  0707 02394000
         TM    TSBTJBF(TSBPTR),B'00000001'                         0707 02395000
         BNO   @RF00707                                            0707 02396000
*     /***************************************************************/ 02397000
*     /*                                                             */ 02398000
*     /* RESCHEDULE IKTXMTPT IN THIS ADDRESS SAPCE                   */ 02399000
*     /*                                                             */ 02400000
*     /***************************************************************/ 02401000
*                                                                  0708 02402000
*     DO;                                                          0708 02403000
*       RFY                                                        0709 02404000
*         SRBPTR RSTD;                                             0709 02405000
*       SRBPTR=TVCSSRBA;                                           0710 02406000
         L     @10,TSBEXTNT(,TSBPTR)                               0710 02407000
         L     @10,TSBXCSAP(,@10)                                  0710 02408000
         L     SRBPTR,TVCSSRBA-1(,@10)                             0710 02409000
         LA    SRBPTR,0(,SRBPTR)                                   0710 02410000
*       GEN REFS(CVTLSMQ,CVTMAP,SRBFLNK,SRBSECT,SRBPTR) SETS(R0,R15);   02411000
         SCHEDULE SRB=(1),SCOPE=LOCAL                                   02412000
*       TSBTJBF='0'B;               /* CLEAR TSBTJBF                 */ 02413000
         NI    TSBTJBF(TSBPTR),B'11111110'                         0712 02414000
*       RFY                                                        0713 02415000
*         SRBPTR UNRSTD;                                           0713 02416000
*     END;                                                         0714 02417000
*   RFY                                                            0715 02418000
*     TSB BASED(ASCBTSB);                                          0715 02419000
*   END MARKDISP;                                                  0716 02420000
@EL00004 DS    0H                                                  0716 02421000
@EF00004 DS    0H                                                  0716 02422000
@ER00004 L     @14,@SA00004                                        0716 02423000
         BR    @14                                                 0716 02424000
*   END IKTQMIN                                                    0717 02425000
*                                                                  0717 02426000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02427000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 02428000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 02429000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 02430000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 02431000
*/*%INCLUDE SYSLIB  (IHAQVPL )                                       */ 02432000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 02433000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 02434000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 02435000
*/*%INCLUDE SYSLIB  (IKTTCAST)                                       */ 02436000
*/*%INCLUDE SYSLIB  (IKJTSB  )                                       */ 02437000
*/*%INCLUDE SYSLIB  (IKTTSBX )                                       */ 02438000
*/*%INCLUDE SYSLIB  (IKTTVCS )                                       */ 02439000
*/*%INCLUDE SYSLIB  (IKTTVWA )                                       */ 02440000
*/*%INCLUDE SYSLIB  (IKTIPARM)                                       */ 02441000
*/*%INCLUDE SYSLIB  (IKTOPARM)                                       */ 02442000
*                                                                  0717 02443000
*       ;                                                          0717 02444000
@DATA    DS    0H                                                       02445000
@SM02270 MVC   QELE+19(0,@14),EMSG(TEMPA)                               02446000
@DATD    DSECT                                                          02447000
         DS    0F                                                       02448000
@SA00001 DS    18F                                                      02449000
@PC00001 DS    2F                                                       02450000
@SA00003 DS    1F                                                       02451000
@SA00002 DS    1F                                                       02452000
@SA00004 DS    1F                                                       02453000
IKTQMIN  CSECT                                                          02454000
         DS    0F                                                       02455000
@CF00047 DC    F'1'                                                     02456000
@CF00099 DC    F'4'                                                     02457000
@CF00056 DC    F'8'                                                     02458000
@CH00056 EQU   @CF00056+2                                               02459000
@CF02219 DC    F'12'                                                    02460000
@CH02219 EQU   @CF02219+2                                               02461000
@CF00137 DC    F'20'                                                    02462000
@CF02165 DC    F'4096'                                                  02463000
@CF02269 DC    F'-4'                                                    02464000
@CF02250 DC    XL4'80000000'                                            02465000
@CF02260 DC    XL4'0000FFFF'                                            02466000
@DATD    DSECT                                                          02467000
         DS    0D                                                       02468000
PARMS    DS    CL20                                                     02469000
         ORG   PARMS                                                    02470000
PBUFADR  DS    AL4                                                      02471000
PREQ     DS    FL1                                                      02472000
PRC      DS    FL1                                                      02473000
PBFSZ    DS    FL2                                                      02474000
PFLAGS   DS    CL4                                                      02475000
         ORG   PFLAGS                                                   02476000
@NM00007 DS    CL1                                                      02477000
PFLGMV   DS    CL3                                                      02478000
         ORG   PFLGMV                                                   02479000
PFLGMVB2 DS    FL1                                                      02480000
PFLGMVB3 DS    FL1                                                      02481000
PFLGMVB4 DS    FL1                                                      02482000
         ORG   PARMS+12                                                 02483000
@NM00008 DS    FL2                                                      02484000
PNXBFSZ  DS    FL2                                                      02485000
PNXFLGS  DS    CL4                                                      02486000
         ORG   PARMS+20                                                 02487000
IKTQMIN  CSECT                                                          02488000
         NOPR  ((@ENDDATD-@DATD)/121*16)                                02489000
         DS    0F                                                       02490000
@SIZDATD DC    AL1(0)                                                   02491000
         DC    AL3(@ENDDATD-@DATD)                                      02492000
@CA02138 DC    A(IKTQMFR1)                                              02493000
@CA02222 DC    A(IKTQMEV)                                               02494000
@CA02221 DC    A(IKTQMFR2)                                              02495000
         DS    0D                                                       02496000
QMNGR    DC    CL8'IKTQMNGR'                                            02497000
FRR1     DC    CL8'IKTQMFR1'                                            02498000
INQM     DC    CL8'IKTQMIN'                                             02499000
OUTQM    DC    CL8'IKTQMOUT'                                            02500000
PATCH    DC    60F'0'                                                   02501000
CP0001@  DC    AL4(ADDEL)                                               02502000
         DC    AL4(OBTAIN)                                              02503000
         DC    AL4(DELIN)                                               02504000
         DC    AL4(UPDATE)                                              02505000
         DC    AL4(CLEARI)                                              02506000
         DC    AL4(DELBK)                                               02507000
         DC    AL4(MARKAVBL)                                            02508000
CP0002@  DC    AL4(ADDO)                                                02509000
         DC    AL4(OBTAINO)                                             02510000
         DC    AL4(DELETO)                                              02511000
         DC    AL4(UPDATO)                                              02512000
         DC    AL4(CLEARO)                                              02513000
         DC    AL4(REOBTAIN)                                            02514000
         DC    AL4(RESET)                                               02515000
         DC    AL4(ADDTOP)                                              02516000
IKTQMIN  CSECT                                                          02517000
SP229    EQU   229                                                      02518000
TCASKEY  EQU   6                                                        02519000
@DATD    DSECT                                                          02520000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02521000
@ENDDATD EQU   *                                                        02522000
IKTQMIN  CSECT                                                          02523000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02524000
@01      EQU   01                                                       02525000
@02      EQU   02                                                       02526000
@03      EQU   03                                                       02527000
@04      EQU   04                                                       02528000
@05      EQU   05                                                       02529000
@06      EQU   06                                                       02530000
@07      EQU   07                                                       02531000
@08      EQU   08                                                       02532000
@09      EQU   09                                                       02533000
@10      EQU   10                                                       02534000
@11      EQU   11                                                       02535000
@12      EQU   12                                                       02536000
@13      EQU   13                                                       02537000
@14      EQU   14                                                       02538000
@15      EQU   15                                                       02539000
TSBPTR   EQU   @02                                                      02540000
TEMP9    EQU   @05                                                      02541000
TEMP7    EQU   @02                                                      02542000
TEMP6    EQU   @02                                                      02543000
TEMP5    EQU   @10                                                      02544000
TEMP4    EQU   @02                                                      02545000
TEMP3    EQU   @02                                                      02546000
TEMP2    EQU   @05                                                      02547000
TEMP1    EQU   @02                                                      02548000
QPTR2    EQU   @05                                                      02549000
QPTR1    EQU   @08                                                      02550000
QPTR     EQU   @10                                                      02551000
COUNT2   EQU   @08                                                      02552000
COUNT1   EQU   @08                                                      02553000
VERADD   EQU   @04                                                      02554000
TEMPA    EQU   @02                                                      02555000
R0       EQU   @00                                                      02556000
R1       EQU   @01                                                      02557000
QVPLPTR  EQU   @01                                                      02558000
SRBPTR   EQU   @01                                                      02559000
R2       EQU   @02                                                      02560000
R3       EQU   @03                                                      02561000
R4       EQU   @04                                                      02562000
SDWAPTR  EQU   @05                                                      02563000
R5       EQU   @05                                                      02564000
R6       EQU   @06                                                      02565000
TVWAPTR  EQU   @06                                                      02566000
R7       EQU   @07                                                      02567000
R8       EQU   @08                                                      02568000
R9       EQU   @09                                                      02569000
R10      EQU   @10                                                      02570000
DATARG   EQU   @11                                                      02571000
R11      EQU   @11                                                      02572000
R12      EQU   @12                                                      02573000
R13      EQU   @13                                                      02574000
R14      EQU   @14                                                      02575000
R15      EQU   @15                                                      02576000
PSA      EQU   0                                                        02577000
FLCRNPSW EQU   PSA                                                      02578000
FLCROPSW EQU   PSA+8                                                    02579000
FLCICCW2 EQU   PSA+16                                                   02580000
FLCCVT   EQU   FLCICCW2                                                 02581000
PSAEEPSW EQU   PSA+132                                                  02582000
PSAESPSW EQU   PSA+136                                                  02583000
FLCSVILC EQU   PSAESPSW+1                                               02584000
PSAEPPSW EQU   PSA+140                                                  02585000
FLCPIILC EQU   PSAEPPSW+1                                               02586000
FLCPICOD EQU   PSAEPPSW+2                                               02587000
PSAPICOD EQU   FLCPICOD+1                                               02588000
FLCTEA   EQU   PSAEPPSW+4                                               02589000
FLCPER   EQU   PSA+152                                                  02590000
FLCMCLA  EQU   PSA+168                                                  02591000
FLCIOEL  EQU   FLCMCLA+4                                                02592000
FLCIOA   EQU   FLCMCLA+16                                               02593000
FLCFSA   EQU   FLCMCLA+80                                               02594000
PSAAOLD  EQU   PSA+548                                                  02595000
PSASUPER EQU   PSA+552                                                  02596000
PSASUP1  EQU   PSASUPER                                                 02597000
PSASUP2  EQU   PSASUPER+1                                               02598000
PSASUP3  EQU   PSASUPER+2                                               02599000
PSASUP4  EQU   PSASUPER+3                                               02600000
PSACLHT  EQU   PSA+640                                                  02601000
PSALKSA  EQU   PSA+696                                                  02602000
PSAHLHI  EQU   PSA+760                                                  02603000
PSADSSFL EQU   PSA+836                                                  02604000
PSADSSF1 EQU   PSADSSFL                                                 02605000
PSADSSF3 EQU   PSADSSFL+2                                               02606000
PSADSSF4 EQU   PSADSSFL+3                                               02607000
PSARSVT  EQU   PSA+896                                                  02608000
PSALSFCC EQU   PSA+1012                                                 02609000
IQELE    EQU   0                                                        02610000
IQNBQE   EQU   IQELE                                                    02611000
IQ@CURR  EQU   IQELE+2                                                  02612000
IQ@STRT  EQU   IQELE+4                                                  02613000
IQNBUF   EQU   IQELE+6                                                  02614000
IQNEXT   EQU   IQELE+8                                                  02615000
IQPREV   EQU   IQELE+12                                                 02616000
IQFLAGS  EQU   IQELE+16                                                 02617000
IQALLOC  EQU   IQFLAGS                                                  02618000
IQAVBL   EQU   IQFLAGS+1                                                02619000
IQPRMPT  EQU   IQFLAGS+1                                                02620000
IQCCC    EQU   IQFLAGS+2                                                02621000
OQELE    EQU   0                                                        02622000
OQNBQE   EQU   OQELE                                                    02623000
OQ@CURR  EQU   OQELE+2                                                  02624000
OQ@STRT  EQU   OQELE+4                                                  02625000
OQNBUF   EQU   OQELE+6                                                  02626000
OQNEXT   EQU   OQELE+8                                                  02627000
OQPREV   EQU   OQELE+12                                                 02628000
OQFLAGS  EQU   OQELE+16                                                 02629000
OQADTOP  EQU   OQFLAGS                                                  02630000
OQASID   EQU   OQFLAGS+1                                                02631000
QELE     EQU   0                                                        02632000
QNBQE    EQU   QELE                                                     02633000
Q@CURR   EQU   QELE+2                                                   02634000
Q@STRT   EQU   QELE+4                                                   02635000
QNBUF    EQU   QELE+6                                                   02636000
QNEXT    EQU   QELE+8                                                   02637000
QPREV    EQU   QELE+12                                                  02638000
QFLAGS   EQU   QELE+16                                                  02639000
QALLOC   EQU   QFLAGS                                                   02640000
QFLGMV   EQU   QFLAGS+1                                                 02641000
QPTRS    EQU   0                                                        02642000
MTVWABQ  EQU   QPTRS                                                    02643000
MTVWANM  EQU   QPTRS+4                                                  02644000
MTVWAEQ  EQU   QPTRS+8                                                  02645000
IKTMSGS  EQU   0                                                        02646000
@NM00009 EQU   0                                                        02647000
MSGLENG  EQU   @NM00009                                                 02648000
EMSG     EQU   @NM00009+2                                               02649000
IEAVEQV3 EQU   0                                                        02650000
STATUS   EQU   0                                                        02651000
ASCB     EQU   0                                                        02652000
ASCBSUPC EQU   ASCB+16                                                  02653000
ASCBTSB  EQU   ASCB+60                                                  02654000
ASCBFW1  EQU   ASCB+100                                                 02655000
ASCBRCTF EQU   ASCBFW1+2                                                02656000
ASCBFLG1 EQU   ASCBFW1+3                                                02657000
ASCBDSP1 EQU   ASCB+114                                                 02658000
ASCBFLG2 EQU   ASCB+115                                                 02659000
ASCBLKGP EQU   ASCB+128                                                 02660000
ASCBSRQ  EQU   ASCB+180                                                 02661000
ASCBSRQ1 EQU   ASCBSRQ                                                  02662000
ASCBSRQ2 EQU   ASCBSRQ+1                                                02663000
ASCBSRQ3 EQU   ASCBSRQ+2                                                02664000
ASCBSRQ4 EQU   ASCBSRQ+3                                                02665000
CVTMAP   EQU   0                                                        02666000
CVTDAR   EQU   CVTMAP+72                                                02667000
CVTFLGS1 EQU   CVTDAR                                                   02668000
CVTDCB   EQU   CVTMAP+116                                               02669000
CVTIERLC EQU   CVTMAP+144                                               02670000
CVTOPTA  EQU   CVTMAP+182                                               02671000
CVTOPTB  EQU   CVTMAP+183                                               02672000
CVTABEND EQU   CVTMAP+200                                               02673000
CVTGTF   EQU   CVTMAP+236                                               02674000
CVTGTFST EQU   CVTGTF                                                   02675000
CVTGTFS  EQU   CVTGTFST                                                 02676000
CVTSTATE EQU   CVTGTFST                                                 02677000
CVTTMODE EQU   CVTGTFST                                                 02678000
CVTFORM  EQU   CVTGTFST                                                 02679000
CVTAQAVT EQU   CVTMAP+240                                               02680000
CVTTCMFG EQU   CVTAQAVT                                                 02681000
CVTVOLM2 EQU   CVTMAP+244                                               02682000
CVTTATA  EQU   CVTVOLM2                                                 02683000
CVTTSKS  EQU   CVTTATA                                                  02684000
CVTVOLF2 EQU   CVTTSKS                                                  02685000
CVTTAT   EQU   CVTTATA+1                                                02686000
CVTATER  EQU   CVTMAP+248                                               02687000
CVTEXT1  EQU   CVTMAP+252                                               02688000
CVTPURG  EQU   CVTMAP+260                                               02689000
CVTQMSG  EQU   CVTMAP+268                                               02690000
CVTDMSR  EQU   CVTMAP+272                                               02691000
CVTRSV37 EQU   CVTDMSR                                                  02692000
CVTDMSRF EQU   CVTRSV37                                                 02693000
CVTERPV  EQU   CVTMAP+316                                               02694000
CVTINTLA EQU   CVTMAP+320                                               02695000
CVTAPF   EQU   CVTMAP+324                                               02696000
CVTEXT2  EQU   CVTMAP+328                                               02697000
CVTHJES  EQU   CVTMAP+332                                               02698000
CVTPGSIA EQU   CVTMAP+348                                               02699000
CVTA1F1  EQU   CVTMAP+356                                               02700000
CVTSYSK  EQU   CVTMAP+357                                               02701000
CVTVOLM1 EQU   CVTMAP+380                                               02702000
CVTVOLF1 EQU   CVTVOLM1                                                 02703000
CVTATMCT EQU   CVTMAP+388                                               02704000
CVTXTNT1 EQU   0                                                        02705000
CVTXTNT2 EQU   0                                                        02706000
CVTDSSV  EQU   CVTXTNT2                                                 02707000
CVTFLGBT EQU   CVTXTNT2+5                                               02708000
CVTQID   EQU   CVTXTNT2+24                                              02709000
CVTSHS   EQU   CVTXTNT2+40                                              02710000
CVTRV400 EQU   CVTXTNT2+52                                              02711000
CVTRV409 EQU   CVTXTNT2+53                                              02712000
CVTATCVT EQU   CVTXTNT2+64                                              02713000
CVTRV429 EQU   CVTXTNT2+84                                              02714000
CVTRV438 EQU   CVTXTNT2+85                                              02715000
CVTRV457 EQU   CVTXTNT2+112                                             02716000
CVTRV466 EQU   CVTXTNT2+113                                             02717000
CVTFIX   EQU   0                                                        02718000
CVTRELNO EQU   CVTFIX+252                                               02719000
FRREPTR  EQU   0                                                        02720000
FRRS     EQU   0                                                        02721000
FRRSHEAD EQU   FRRS                                                     02722000
FRRSEMP  EQU   FRRSHEAD                                                 02723000
FRRSLAST EQU   FRRSHEAD+4                                               02724000
FRRSELEN EQU   FRRSHEAD+8                                               02725000
FRRSCURR EQU   FRRSHEAD+12                                              02726000
FRRSENTR EQU   0                                                        02727000
FRRSFRRA EQU   FRRSENTR                                                 02728000
FRRSFLGS EQU   FRRSENTR+4                                               02729000
FRRSFLG1 EQU   FRRSFLGS                                                 02730000
FRRSPARM EQU   FRRSENTR+8                                               02731000
QVPL     EQU   0                                                        02732000
QVPLTYP3 EQU   QVPL                                                     02733000
QVPLTYP2 EQU   QVPLTYP3                                                 02734000
QVPLTYP1 EQU   QVPLTYP2                                                 02735000
QVPLEVR  EQU   QVPLTYP1                                                 02736000
QVPLODA  EQU   QVPLTYP1+4                                               02737000
QVPLWKA  EQU   QVPLTYP1+8                                               02738000
QVPLHDR  EQU   QVPLTYP1+16                                              02739000
QVPLHF   EQU   QVPLTYP1+20                                              02740000
QVPLFLGH EQU   QVPLHF                                                   02741000
QVPLFLGF EQU   QVPLHF+1                                                 02742000
QVPLFPTR EQU   QVPLHF+2                                                 02743000
QVPLTRLR EQU   QVPLTYP2+28                                              02744000
QVPLTB   EQU   QVPLTYP2+32                                              02745000
QVPLFLGT EQU   QVPLTB                                                   02746000
QVPLFLGB EQU   QVPLTB+1                                                 02747000
QVPLBPTR EQU   QVPLTB+2                                                 02748000
QVWRKAR  EQU   QVPL+40                                                  02749000
QVSAVEAR EQU   QVPL+80                                                  02750000
SCVTSECT EQU   0                                                        02751000
SCVTSTAT EQU   SCVTSECT+148                                             02752000
SDWA     EQU   0                                                        02753000
SDWAFIOB EQU   SDWA+4                                                   02754000
SDWAABCC EQU   SDWAFIOB                                                 02755000
SDWACMPF EQU   SDWAABCC                                                 02756000
SDWACTL1 EQU   SDWA+8                                                   02757000
SDWACMKA EQU   SDWACTL1                                                 02758000
SDWAMWPA EQU   SDWACTL1+1                                               02759000
SDWAPMKA EQU   SDWACTL1+4                                               02760000
SDWACTL2 EQU   SDWA+16                                                  02761000
SDWACMKP EQU   SDWACTL2                                                 02762000
SDWAMWPP EQU   SDWACTL2+1                                               02763000
SDWAPMKP EQU   SDWACTL2+4                                               02764000
SDWAGRSV EQU   SDWA+24                                                  02765000
SDWANAME EQU   SDWA+88                                                  02766000
SDWAEC1  EQU   SDWA+104                                                 02767000
SDWAEMK1 EQU   SDWAEC1                                                  02768000
SDWAMWP1 EQU   SDWAEC1+1                                                02769000
SDWAINT1 EQU   SDWAEC1+2                                                02770000
SDWANXT1 EQU   SDWAEC1+4                                                02771000
SDWAAEC1 EQU   SDWA+112                                                 02772000
SDWAILC1 EQU   SDWAAEC1+1                                               02773000
SDWAINC1 EQU   SDWAAEC1+2                                               02774000
SDWAICD1 EQU   SDWAINC1+1                                               02775000
SDWAEC2  EQU   SDWA+120                                                 02776000
SDWAEMK2 EQU   SDWAEC2                                                  02777000
SDWAMWP2 EQU   SDWAEC2+1                                                02778000
SDWAINT2 EQU   SDWAEC2+2                                                02779000
SDWANXT2 EQU   SDWAEC2+4                                                02780000
SDWAAEC2 EQU   SDWA+128                                                 02781000
SDWAILC2 EQU   SDWAAEC2+1                                               02782000
SDWAINC2 EQU   SDWAAEC2+2                                               02783000
SDWAICD2 EQU   SDWAINC2+1                                               02784000
SDWASRSV EQU   SDWA+136                                                 02785000
SDWASR15 EQU   SDWASRSV+60                                              02786000
SDWAIDNT EQU   SDWA+200                                                 02787000
SDWAMCH  EQU   SDWA+204                                                 02788000
SDWASTCK EQU   SDWAMCH                                                  02789000
SDWAMCHI EQU   SDWAMCH+8                                                02790000
SDWAMCHS EQU   SDWAMCHI                                                 02791000
SDWAMCHD EQU   SDWAMCHI+1                                               02792000
SDWARSR1 EQU   SDWAMCH+12                                               02793000
SDWARSR2 EQU   SDWAMCH+13                                               02794000
SDWAFLGS EQU   SDWA+232                                                 02795000
SDWAERRA EQU   SDWAFLGS                                                 02796000
SDWAERRB EQU   SDWAFLGS+1                                               02797000
SDWAERRC EQU   SDWAFLGS+2                                               02798000
SDWASTAF EQU   SDWAERRC                                                 02799000
SDWAPERC EQU   SDWAERRC                                                 02800000
SDWAERRD EQU   SDWAFLGS+3                                               02801000
SDWAIOFS EQU   SDWA+238                                                 02802000
SDWARTYA EQU   SDWA+240                                                 02803000
SDWARECA EQU   SDWA+244                                                 02804000
SDWACPUA EQU   SDWA+248                                                 02805000
SDWAPARQ EQU   SDWA+252                                                 02806000
SDWARCDE EQU   SDWAPARQ                                                 02807000
SDWAACF2 EQU   SDWAPARQ+1                                               02808000
SDWARCRD EQU   SDWAACF2                                                 02809000
SDWAUPRG EQU   SDWAACF2                                                 02810000
SDWAACF3 EQU   SDWAPARQ+2                                               02811000
SDWAACF4 EQU   SDWAPARQ+3                                               02812000
SDWALKWA EQU   SDWA+256                                                 02813000
SDWALKWS EQU   SDWALKWA                                                 02814000
SDWARECP EQU   SDWA+292                                                 02815000
SDWAMODN EQU   SDWARECP                                                 02816000
SDWACSCT EQU   SDWARECP+8                                               02817000
SDWAREXN EQU   SDWARECP+16                                              02818000
SDWASNPA EQU   SDWA+320                                                 02819000
SDWADUMP EQU   SDWASNPA                                                 02820000
SDWADPFS EQU   SDWADUMP+1                                               02821000
SDWADDAT EQU   SDWASNPA+4                                               02822000
SDWASDAT EQU   SDWADDAT                                                 02823000
SDWAPDAT EQU   SDWADDAT+2                                               02824000
SDWADPSA EQU   SDWA+328                                                 02825000
SDWADPSL EQU   SDWADPSA                                                 02826000
SDWAFRM1 EQU   SDWADPSL                                                 02827000
SDWATO1  EQU   SDWADPSL+4                                               02828000
SDWARA   EQU   SDWA+400                                                 02829000
SDWADPVA EQU   SDWARA+2                                                 02830000
SRBSECT  EQU   0                                                        02831000
SRBFLNK  EQU   SRBSECT+4                                                02832000
SRBFLC   EQU   SRBSECT+12                                               02833000
TCAST    EQU   0                                                        02834000
TCASUSER EQU   TCAST+4                                                  02835000
TCASMSGS EQU   TCAST+52                                                 02836000
TCASFLG1 EQU   TCAST+88                                                 02837000
TCASFLG2 EQU   TCAST+89                                                 02838000
TSB      EQU   0                                                        02839000
TSBASCBA EQU   TSB                                                      02840000
TSBSTAT  EQU   TSBASCBA                                                 02841000
TSBNOBUF EQU   TSBSTAT                                                  02842000
TSBFLG1  EQU   TSB+4                                                    02843000
TSBTJBF  EQU   TSBFLG1                                                  02844000
TSBFLG2  EQU   TSB+16                                                   02845000
TSBFLG3  EQU   TSB+24                                                   02846000
TSBFLG5  EQU   TSB+25                                                   02847000
TSBTERMC EQU   TSB+26                                                   02848000
TSBTERM1 EQU   TSBTERMC                                                 02849000
TSBTERM2 EQU   TSBTERMC+1                                               02850000
TSBSTCC  EQU   TSB+34                                                   02851000
TSBFLG4  EQU   TSB+41                                                   02852000
TSBOWAIT EQU   TSBFLG4                                                  02853000
TSBAUTOS EQU   TSB+48                                                   02854000
TSBAUTOI EQU   TSB+52                                                   02855000
TSBRCB   EQU   TSB+64                                                   02856000
TSBLINKA EQU   TSBRCB+4                                                 02857000
TSBTPOST EQU   TSB+72                                                   02858000
TSBTPFLG EQU   TSBTPOST                                                 02859000
TSBMINL  EQU   TSB+84                                                   02860000
TSBEXTNT EQU   TSB+96                                                   02861000
TSBX     EQU   0                                                        02862000
TSBXFLG1 EQU   TSBX+32                                                  02863000
TSBXTVWA EQU   TSBX+36                                                  02864000
TSBXCSAP EQU   TSBX+60                                                  02865000
TSBXTERM EQU   TSBX+72                                                  02866000
TVCS     EQU   0                                                        02867000
TVCSECB  EQU   TVCS                                                     02868000
TVCSOPTN EQU   TVCS+8                                                   02869000
TVCSSRBA EQU   TVCS+9                                                   02870000
TVCSINDS EQU   TVCS+16                                                  02871000
TVWA     EQU   0                                                        02872000
TVWAQMWA EQU   TVWA+28                                                  02873000
TVWABIQ  EQU   TVWA+32                                                  02874000
TVWANIM  EQU   TVWA+36                                                  02875000
TVWAEIQ  EQU   TVWA+40                                                  02876000
TVWABOQ  EQU   TVWA+44                                                  02877000
TVWANOM  EQU   TVWA+48                                                  02878000
TVWAEOQ  EQU   TVWA+52                                                  02879000
TVWACPID EQU   TVWA+56                                                  02880000
TVWAUSMN EQU   TVWA+60                                                  02881000
TVWATCB  EQU   TVWA+64                                                  02882000
TVWACLSZ EQU   TVWA+74                                                  02883000
TVWAHBUF EQU   TVWA+76                                                  02884000
TVWALBUF EQU   TVWA+80                                                  02885000
TVWAFLG7 EQU   TVWA+110                                                 02886000
TVWAECBL EQU   TVWA+120                                                 02887000
TVWADLST EQU   TVWA+132                                                 02888000
TVWAFLG1 EQU   TVWA+144                                                 02889000
TVWAFLG2 EQU   TVWA+145                                                 02890000
TVWAFLG3 EQU   TVWA+146                                                 02891000
TVWAQMRT EQU   TVWAFLG3                                                 02892000
TVWAQMIO EQU   TVWAFLG3                                                 02893000
TVWAQLBU EQU   TVWAFLG3                                                 02894000
TVWAFLG4 EQU   TVWA+147                                                 02895000
TVWADOOQ EQU   TVWAFLG4                                                 02896000
TVWAQMEV EQU   TVWAFLG4                                                 02897000
TVWAFLG5 EQU   TVWA+150                                                 02898000
TVWAQMLB EQU   TVWA+176                                                 02899000
TVWAFLG6 EQU   TVWA+182                                                 02900000
CL0001@  EQU   0                                                        02901000
CL0002@  EQU   0                                                        02902000
IPARMS   EQU   0                                                        02903000
IPFLAGS  EQU   IPARMS+8                                                 02904000
IPNXFLGS EQU   IPARMS+16                                                02905000
OPARMS   EQU   0                                                        02906000
OPFLAGS  EQU   OPARMS+8                                                 02907000
OPOPTNS  EQU   OPFLAGS+1                                                02908000
OPNXFLGS EQU   OPARMS+16                                                02909000
ASCBPTR  EQU   PSAAOLD                                                  02910000
CVTPTR   EQU   FLCCVT                                                   02911000
CVTS01   EQU   CVTPGSIA                                                 02912000
CVTLPDIA EQU   CVTS01+12                                                02913000
CVTDIRST EQU   CVTLPDIA                                                 02914000
CVTSLIDA EQU   CVTS01+24                                                02915000
CVTCTLFG EQU   CVTS01+50                                                02916000
CVTBLDCP EQU   CVTS01+140                                               02917000
CVTGETCL EQU   CVTS01+144                                               02918000
CVTFRECL EQU   CVTS01+148                                               02919000
CVTCRMN  EQU   CVTS01+156                                               02920000
CVTLSMQ  EQU   CVTS01+268                                               02921000
CVTRV210 EQU   CVTS01+424                                               02922000
CVTRV219 EQU   CVTS01+425                                               02923000
CVTRV228 EQU   CVTS01+426                                               02924000
CVTRV237 EQU   CVTS01+427                                               02925000
CVTMFRTR EQU   CVTS01+452                                               02926000
CVTRV262 EQU   CVTS01+468                                               02927000
CVTRV271 EQU   CVTS01+469                                               02928000
CVTRV280 EQU   CVTS01+470                                               02929000
CVTRV289 EQU   CVTS01+471                                               02930000
CVTRMBR  EQU   CVTS01+492                                               02931000
CVTQV3   EQU   CVTS01+596                                               02932000
CVTGSDA  EQU   CVTS01+600                                               02933000
CVTTCASP EQU   CVTS01+664                                               02934000
PSARSVTE EQU   PSARSVT                                                  02935000
PSACSTK  EQU   PSARSVTE                                                 02936000
FRRSPTR  EQU   PSACSTK                                                  02937000
SCVTSPTR EQU   CVTABEND                                                 02938000
TCASTPTR EQU   CVTTCASP                                                 02939000
FLC      EQU   PSA                                                      02940000
SRB      EQU   SRBSECT                                                  02941000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02942000
PSARSAV  EQU   PSARSVTE+60                                              02943000
PSARSTK  EQU   PSARSVTE+56                                              02944000
PSAESAV3 EQU   PSARSVTE+52                                              02945000
PSAESTK3 EQU   PSARSVTE+48                                              02946000
PSAESAV2 EQU   PSARSVTE+44                                              02947000
PSAESTK2 EQU   PSARSVTE+40                                              02948000
PSAESAV1 EQU   PSARSVTE+36                                              02949000
PSAESTK1 EQU   PSARSVTE+32                                              02950000
PSAPSAV  EQU   PSARSVTE+28                                              02951000
PSAPSTK  EQU   PSARSVTE+24                                              02952000
PSAMSAV  EQU   PSARSVTE+20                                              02953000
PSAMSTK  EQU   PSARSVTE+16                                              02954000
PSASSAV  EQU   PSARSVTE+12                                              02955000
PSASSTK  EQU   PSARSVTE+8                                               02956000
PSANSTK  EQU   PSARSVTE+4                                               02957000
CVTRV628 EQU   CVTS01+728                                               02958000
CVTRV627 EQU   CVTS01+724                                               02959000
CVTRV626 EQU   CVTS01+720                                               02960000
CVTRV625 EQU   CVTS01+716                                               02961000
CVTRV624 EQU   CVTS01+712                                               02962000
CVTRV623 EQU   CVTS01+708                                               02963000
CVTRV622 EQU   CVTS01+704                                               02964000
CVTRV621 EQU   CVTS01+700                                               02965000
CVTRV620 EQU   CVTS01+696                                               02966000
CVTRV619 EQU   CVTS01+692                                               02967000
CVTRV618 EQU   CVTS01+688                                               02968000
CVTRV617 EQU   CVTS01+684                                               02969000
CVTRV616 EQU   CVTS01+680                                               02970000
CVTRV615 EQU   CVTS01+676                                               02971000
CVTRV614 EQU   CVTS01+672                                               02972000
CVTRV613 EQU   CVTS01+668                                               02973000
CVT0PT03 EQU   CVTS01+660                                               02974000
CVT0PT0E EQU   CVTS01+656                                               02975000
CVTIRM   EQU   CVTS01+652                                               02976000
CVTCGK   EQU   CVTS01+648                                               02977000
CVTRV607 EQU   CVTS01+644                                               02978000
CVTRV606 EQU   CVTS01+640                                               02979000
CVTRV605 EQU   CVTS01+636                                               02980000
CVTRV604 EQU   CVTS01+632                                               02981000
CVTEFF02 EQU   CVTS01+628                                               02982000
CVTCBBR  EQU   CVTS01+624                                               02983000
CVTSSCR  EQU   CVTS01+620                                               02984000
CVTEVENT EQU   CVTS01+616                                               02985000
CVTCRCA  EQU   CVTS01+612                                               02986000
CVTTPIO  EQU   CVTS01+608                                               02987000
CVTADV   EQU   CVTS01+604                                               02988000
CVTGSDAB EQU   CVTGSDA                                                  02989000
CVTQV2   EQU   CVTS01+592                                               02990000
CVTQV1   EQU   CVTS01+588                                               02991000
CVTRPT   EQU   CVTS01+584                                               02992000
CVTSSRB  EQU   CVTS01+580                                               02993000
CVTCSDRL EQU   CVTS01+576                                               02994000
CVTEXP1  EQU   CVTS01+572                                               02995000
CVTRMPMT EQU   CVTS01+568                                               02996000
CVTRMPTT EQU   CVTS01+564                                               02997000
CVTVPSA  EQU   CVTS01+560                                               02998000
CVTVSTOP EQU   CVTS01+556                                               02999000
CVTGTFR8 EQU   CVTS01+552                                               03000000
CVTQUIT  EQU   CVTS01+548                                               03001000
CVTVACR  EQU   CVTS01+544                                               03002000
CVTWTCB  EQU   CVTS01+540                                               03003000
CVTSTPRS EQU   CVTS01+536                                               03004000
CVT0PT02 EQU   CVTS01+532                                               03005000
CVTDARCM EQU   CVTS01+528                                               03006000
CVTIRECM EQU   CVTS01+524                                               03007000
CVTJRECM EQU   CVTS01+520                                               03008000
CVTVEMS0 EQU   CVTS01+516                                               03009000
CVTSPFRR EQU   CVTS01+512                                               03010000
CVTRLSTG EQU   CVTS01+508                                               03011000
CVT0TC0A EQU   CVTS01+504                                               03012000
CVTGMBR  EQU   CVTS01+500                                               03013000
CVTLFRM  EQU   CVTS01+496                                               03014000
CVTVIOP  EQU   CVTS01+488                                               03015000
CVTRV307 EQU   CVTS01+486                                               03016000
CVTRV306 EQU   CVTS01+484                                               03017000
CVTRV305 EQU   CVTS01+482                                               03018000
CVTRV304 EQU   CVTS01+480                                               03019000
CVTRV303 EQU   CVTS01+478                                               03020000
CVTRV302 EQU   CVTS01+476                                               03021000
CVTTRCA  EQU   CVTS01+472                                               03022000
CVTRV297 EQU   CVTRV289                                                 03023000
CVTRV296 EQU   CVTRV289                                                 03024000
CVTRV295 EQU   CVTRV289                                                 03025000
CVTRV294 EQU   CVTRV289                                                 03026000
CVTRV293 EQU   CVTRV289                                                 03027000
CVTRV292 EQU   CVTRV289                                                 03028000
CVTRV291 EQU   CVTRV289                                                 03029000
CVTRV290 EQU   CVTRV289                                                 03030000
CVTRV288 EQU   CVTRV280                                                 03031000
CVTRV287 EQU   CVTRV280                                                 03032000
CVTRV286 EQU   CVTRV280                                                 03033000
CVTRV285 EQU   CVTRV280                                                 03034000
CVTRV284 EQU   CVTRV280                                                 03035000
CVTRV283 EQU   CVTRV280                                                 03036000
CVTRV282 EQU   CVTRV280                                                 03037000
CVTRV281 EQU   CVTRV280                                                 03038000
CVTRV279 EQU   CVTRV271                                                 03039000
CVTRV278 EQU   CVTRV271                                                 03040000
CVTRV277 EQU   CVTRV271                                                 03041000
CVTRV276 EQU   CVTRV271                                                 03042000
CVTRV275 EQU   CVTRV271                                                 03043000
CVTRV274 EQU   CVTRV271                                                 03044000
CVTRV273 EQU   CVTRV271                                                 03045000
CVTRV272 EQU   CVTRV271                                                 03046000
CVTRV270 EQU   CVTRV262                                                 03047000
CVTRV269 EQU   CVTRV262                                                 03048000
CVTRV268 EQU   CVTRV262                                                 03049000
CVTRV267 EQU   CVTRV262                                                 03050000
CVTRV266 EQU   CVTRV262                                                 03051000
CVTRV265 EQU   CVTRV262                                                 03052000
CVTRV264 EQU   CVTRV262                                                 03053000
CVTRV263 EQU   CVTRV262                                                 03054000
CVTVFP   EQU   CVTS01+464                                               03055000
CVTVSI   EQU   CVTS01+460                                               03056000
CVTVPSIB EQU   CVTS01+456                                               03057000
CVTMFACT EQU   CVTMFRTR                                                 03058000
CVTMFCTL EQU   CVTS01+448                                               03059000
CVTPVBP  EQU   CVTS01+444                                               03060000
CVTPWI   EQU   CVTS01+440                                               03061000
CVTRV254 EQU   CVTS01+438                                               03062000
CVTRV253 EQU   CVTS01+436                                               03063000
CVTRV252 EQU   CVTS01+434                                               03064000
CVTRV251 EQU   CVTS01+433                                               03065000
CVTRV250 EQU   CVTS01+432                                               03066000
CVTRV249 EQU   CVTS01+431                                               03067000
CVTRV248 EQU   CVTS01+430                                               03068000
CVTRV247 EQU   CVTS01+429                                               03069000
CVTRV246 EQU   CVTS01+428                                               03070000
CVTRV245 EQU   CVTRV237                                                 03071000
CVTRV244 EQU   CVTRV237                                                 03072000
CVTRV243 EQU   CVTRV237                                                 03073000
CVTRV242 EQU   CVTRV237                                                 03074000
CVTRV241 EQU   CVTRV237                                                 03075000
CVTRV240 EQU   CVTRV237                                                 03076000
CVTRV239 EQU   CVTRV237                                                 03077000
CVTRV238 EQU   CVTRV237                                                 03078000
CVTRV236 EQU   CVTRV228                                                 03079000
CVTRV235 EQU   CVTRV228                                                 03080000
CVTRV234 EQU   CVTRV228                                                 03081000
CVTRV233 EQU   CVTRV228                                                 03082000
CVTRV232 EQU   CVTRV228                                                 03083000
CVTRV231 EQU   CVTRV228                                                 03084000
CVTRV230 EQU   CVTRV228                                                 03085000
CVTRV229 EQU   CVTRV228                                                 03086000
CVTRV227 EQU   CVTRV219                                                 03087000
CVTRV226 EQU   CVTRV219                                                 03088000
CVTRV225 EQU   CVTRV219                                                 03089000
CVTRV224 EQU   CVTRV219                                                 03090000
CVTRV223 EQU   CVTRV219                                                 03091000
CVTRV222 EQU   CVTRV219                                                 03092000
CVTRV221 EQU   CVTRV219                                                 03093000
CVTRV220 EQU   CVTRV219                                                 03094000
CVTRV218 EQU   CVTRV210                                                 03095000
CVTRV217 EQU   CVTRV210                                                 03096000
CVTRV216 EQU   CVTRV210                                                 03097000
CVTRV215 EQU   CVTRV210                                                 03098000
CVTRV214 EQU   CVTRV210                                                 03099000
CVTRV213 EQU   CVTRV210                                                 03100000
CVTRV212 EQU   CVTRV210                                                 03101000
CVTRV211 EQU   CVTRV210                                                 03102000
CVTLCCAT EQU   CVTS01+420                                               03103000
CVTPCCAT EQU   CVTS01+416                                               03104000
CVTIPCRP EQU   CVTS01+412                                               03105000
CVTIPCRI EQU   CVTS01+408                                               03106000
CVTIPCDS EQU   CVTS01+404                                               03107000
CVTAIDVT EQU   CVTS01+400                                               03108000
CVTSSAP  EQU   CVTS01+396                                               03109000
CVTEHCIR EQU   CVTS01+392                                               03110000
CVTEHDEF EQU   CVTS01+388                                               03111000
CVTDAIR  EQU   CVTS01+384                                               03112000
CVTPERFM EQU   CVTS01+380                                               03113000
CVT044R2 EQU   CVTS01+376                                               03114000
CVTFETCH EQU   CVTS01+372                                               03115000
CVTRSTWD EQU   CVTS01+368                                               03116000
CVTSPOST EQU   CVTS01+364                                               03117000
CVTIOBP  EQU   CVTS01+360                                               03118000
CVTASMVT EQU   CVTS01+356                                               03119000
CVTRECRQ EQU   CVTS01+352                                               03120000
CVTWSAC  EQU   CVTS01+348                                               03121000
CVTRV149 EQU   CVTS01+344                                               03122000
CVTWSAL  EQU   CVTS01+340                                               03123000
CVTSPSA  EQU   CVTS01+336                                               03124000
CVTGLMN  EQU   CVTS01+332                                               03125000
CVTVEAC0 EQU   CVTS01+328                                               03126000
CVT062R1 EQU   CVTS01+324                                               03127000
CVTRPOST EQU   CVTS01+320                                               03128000
CVTDQIQE EQU   CVTS01+316                                               03129000
CVTCSD   EQU   CVTS01+312                                               03130000
CVTLKRMA EQU   CVTS01+308                                               03131000
CVTRSPIE EQU   CVTS01+304                                               03132000
CVTRENQ  EQU   CVTS01+300                                               03133000
CVTLQCB  EQU   CVTS01+296                                               03134000
CVTFQCB  EQU   CVTS01+292                                               03135000
CVTQCS01 EQU   CVTS01+288                                               03136000
CVTAPFT  EQU   CVTS01+284                                               03137000
CVTPARRL EQU   CVTS01+280                                               03138000
CVTVWAIT EQU   CVTS01+276                                               03139000
CVTGSPL  EQU   CVTS01+272                                               03140000
CVTGSMQ  EQU   CVTS01+264                                               03141000
CVTEXPRO EQU   CVTS01+260                                               03142000
CVTOPCTP EQU   CVTS01+256                                               03143000
CVTSIC   EQU   CVTS01+252                                               03144000
CVTTPIOS EQU   CVTS01+248                                               03145000
CVTRTMS  EQU   CVTS01+244                                               03146000
CVTSDBF  EQU   CVTS01+240                                               03147000
CVTSCBP  EQU   CVTS01+236                                               03148000
CVTSDMP  EQU   CVTS01+232                                               03149000
CVTSV60  EQU   CVTS01+228                                               03150000
CVTRTMCT EQU   CVTS01+224                                               03151000
CVTASCBL EQU   CVTS01+220                                               03152000
CVTASCBH EQU   CVTS01+216                                               03153000
CVTGDA   EQU   CVTS01+212                                               03154000
CVTASVT  EQU   CVTS01+208                                               03155000
CVTVVMDI EQU   CVTS01+204                                               03156000
CVTAQTOP EQU   CVTS01+200                                               03157000
CVTIOSCS EQU   CVTS01+196                                               03158000
CVTSDRM  EQU   CVTS01+192                                               03159000
CVTOPTE  EQU   CVTS01+188                                               03160000
CVTSTXU  EQU   CVTS01+184                                               03161000
CVTQUIS  EQU   CVTS01+180                                               03162000
CVTPARS  EQU   CVTS01+176                                               03163000
CVTS1EE  EQU   CVTS01+172                                               03164000
CVTFRAS  EQU   CVTS01+168                                               03165000
CVTQSAS  EQU   CVTS01+164                                               03166000
CVTCRAS  EQU   CVTS01+160                                               03167000
CVTDELCP EQU   CVTS01+152                                               03168000
CVTAUTHL EQU   CVTS01+136                                               03169000
CVTSCAN  EQU   CVTS01+132                                               03170000
CVTRV144 EQU   CVTS01+130                                               03171000
CVTMAXMP EQU   CVTS01+128                                               03172000
CVTSTCK  EQU   CVTS01+124                                               03173000
CVTRV139 EQU   CVTS01+123                                               03174000
CVTDSSAC EQU   CVTS01+122                                               03175000
CVTRV513 EQU   CVTS01+121                                               03176000
CVTIOSPL EQU   CVTS01+120                                               03177000
CVTPTGT  EQU   CVTS01+116                                               03178000
CVTCSPIE EQU   CVTS01+112                                               03179000
CVTSMFEX EQU   CVTS01+108                                               03180000
CVTOLT0A EQU   CVTS01+104                                               03181000
CVTSRBRT EQU   CVTS01+100                                               03182000
CVTPUTL  EQU   CVTS01+96                                                03183000
CVTASCRL EQU   CVTS01+92                                                03184000
CVTASCRF EQU   CVTS01+88                                                03185000
CVTRV326 EQU   CVTS01+84                                                03186000
CVTRV325 EQU   CVTS01+80                                                03187000
CVTRV324 EQU   CVTS01+76                                                03188000
CVT0VL01 EQU   CVTS01+72                                                03189000
CVTSHRVM EQU   CVTS01+68                                                03190000
CVTRV332 EQU   CVTS01+64                                                03191000
CVTTAS   EQU   CVTS01+60                                                03192000
CVTRSCN  EQU   CVTS01+56                                                03193000
CVTTRAC2 EQU   CVTS01+54                                                03194000
CVTTRACE EQU   CVTS01+52                                                03195000
CVTAPG   EQU   CVTS01+51                                                03196000
CVTSDTRC EQU   CVTCTLFG                                                 03197000
CVTGTRCE EQU   CVTCTLFG                                                 03198000
CVTNOMP  EQU   CVTCTLFG                                                 03199000
CVTRSV79 EQU   CVTCTLFG                                                 03200000
CVTDSTAT EQU   CVTCTLFG                                                 03201000
CVTRSV78 EQU   CVTCTLFG                                                 03202000
CVTRV333 EQU   CVTCTLFG                                                 03203000
CVTRV323 EQU   CVTCTLFG                                                 03204000
CVTSPVLK EQU   CVTS01+49                                                03205000
CVTRSV77 EQU   CVTS01+48                                                03206000
CVTRV331 EQU   CVTS01+44                                                03207000
CVTRV330 EQU   CVTS01+40                                                03208000
CVTRV329 EQU   CVTS01+36                                                03209000
CVTRV328 EQU   CVTS01+32                                                03210000
CVTRV322 EQU   CVTS01+28                                                03211000
CVTSLID  EQU   CVTSLIDA+1                                               03212000
CVTSYLK  EQU   CVTSLIDA                                                 03213000
CVTRV321 EQU   CVTS01+20                                                03214000
CVTRV320 EQU   CVTS01+16                                                03215000
CVTLPDIR EQU   CVTLPDIA+1                                               03216000
CVTRSV69 EQU   CVTDIRST                                                 03217000
CVTRSV68 EQU   CVTDIRST                                                 03218000
CVTRSV67 EQU   CVTDIRST                                                 03219000
CVTRSV66 EQU   CVTDIRST                                                 03220000
CVTRSV65 EQU   CVTDIRST                                                 03221000
CVTRSV64 EQU   CVTDIRST                                                 03222000
CVTRSV63 EQU   CVTDIRST                                                 03223000
CVTDICOM EQU   CVTDIRST                                                 03224000
CVTPVTP  EQU   CVTS01+8                                                 03225000
CVTLPDSR EQU   CVTS01+4                                                 03226000
CVTGETL  EQU   CVTS01                                                   03227000
@NM00169 EQU   OPNXFLGS+3                                               03228000
@NM00168 EQU   OPNXFLGS+2                                               03229000
@NM00167 EQU   OPNXFLGS+1                                               03230000
OPNXASID EQU   OPNXFLGS+1                                               03231000
OPNXEDIT EQU   OPNXFLGS+1                                               03232000
OPNXBRK  EQU   OPNXFLGS+1                                               03233000
OPNXHOLD EQU   OPNXFLGS+1                                               03234000
@NM00166 EQU   OPNXFLGS                                                 03235000
OPNXADTP EQU   OPNXFLGS                                                 03236000
OPNXALC  EQU   OPNXFLGS                                                 03237000
OPNXBFSZ EQU   OPARMS+14                                                03238000
@NM00165 EQU   OPARMS+12                                                03239000
@NM00164 EQU   OPFLAGS+3                                                03240000
@NM00163 EQU   OPFLAGS+2                                                03241000
@NM00162 EQU   OPOPTNS                                                  03242000
OPASID   EQU   OPOPTNS                                                  03243000
OPEDIT   EQU   OPOPTNS                                                  03244000
OPBRK    EQU   OPOPTNS                                                  03245000
OPHOLD   EQU   OPOPTNS                                                  03246000
@NM00161 EQU   OPFLAGS                                                  03247000
OPADTOP  EQU   OPFLAGS                                                  03248000
OPALLOC  EQU   OPFLAGS                                                  03249000
OPBFSZ   EQU   OPARMS+6                                                 03250000
OPRC     EQU   OPARMS+5                                                 03251000
OPREQ    EQU   OPARMS+4                                                 03252000
OPBUFADR EQU   OPARMS                                                   03253000
IPNXTMTP EQU   IPNXFLGS+3                                               03254000
IPNXCCC  EQU   IPNXFLGS+2                                               03255000
@NM00160 EQU   IPNXFLGS+1                                               03256000
IPNXPRTL EQU   IPNXFLGS+1                                               03257000
IPNXPMT  EQU   IPNXFLGS+1                                               03258000
IPNXAVBL EQU   IPNXFLGS+1                                               03259000
@NM00159 EQU   IPNXFLGS                                                 03260000
IPNXALC  EQU   IPNXFLGS                                                 03261000
IPNXBFSZ EQU   IPARMS+14                                                03262000
@NM00158 EQU   IPARMS+12                                                03263000
IPTRMTYP EQU   IPFLAGS+3                                                03264000
IPCCC    EQU   IPFLAGS+2                                                03265000
@NM00157 EQU   IPFLAGS+1                                                03266000
IPPRTL   EQU   IPFLAGS+1                                                03267000
IPPRMPT  EQU   IPFLAGS+1                                                03268000
IPAVBL   EQU   IPFLAGS+1                                                03269000
@NM00156 EQU   IPFLAGS                                                  03270000
IPALLOC  EQU   IPFLAGS                                                  03271000
IPBFSZ   EQU   IPARMS+6                                                 03272000
IPRC     EQU   IPARMS+5                                                 03273000
IPREQ    EQU   IPARMS+4                                                 03274000
IPBUFADR EQU   IPARMS                                                   03275000
TVWAEND  EQU   TVWA+216                                                 03276000
@NM00155 EQU   TVWA+208                                                 03277000
TVWAUSRA EQU   TVWA+200                                                 03278000
@NM00154 EQU   TVWA+192                                                 03279000
TVWAFRWO EQU   TVWA+188                                                 03280000
TVWAFRWI EQU   TVWA+184                                                 03281000
TVWARSHW EQU   TVWA+183                                                 03282000
@NM00153 EQU   TVWAFLG6                                                 03283000
TVWAINB  EQU   TVWAFLG6                                                 03284000
TVWAFMEW EQU   TVWAFLG6                                                 03285000
TVWARCDT EQU   TVWAFLG6                                                 03286000
TVWAIOP  EQU   TVWAFLG6                                                 03287000
TVWAIOTR EQU   TVWAFLG6                                                 03288000
TVWAISYS EQU   TVWAFLG6                                                 03289000
@NM00152 EQU   TVWA+180                                                 03290000
TVWAATBO EQU   TVWA+172                                                 03291000
TVWAATBI EQU   TVWA+168                                                 03292000
TVWATRNM EQU   TVWA+160                                                 03293000
TVWATABO EQU   TVWA+156                                                 03294000
TVWATABI EQU   TVWA+152                                                 03295000
TVWALNCT EQU   TVWA+151                                                 03296000
TVWAP1ST EQU   TVWAFLG5                                                 03297000
TVWAPRMT EQU   TVWAFLG5                                                 03298000
TVWANFSP EQU   TVWAFLG5                                                 03299000
TVWATIR  EQU   TVWAFLG5                                                 03300000
TVWAFSW  EQU   TVWAFLG5                                                 03301000
TVWAWO   EQU   TVWAFLG5                                                 03302000
TVWAFSM  EQU   TVWAFLG5                                                 03303000
TVWASCAN EQU   TVWAFLG5                                                 03304000
@NM00151 EQU   TVWA+148                                                 03305000
TVWADARC EQU   TVWAFLG4                                                 03306000
TVWARCRS EQU   TVWAFLG4                                                 03307000
TVWAFLSC EQU   TVWAFLG4                                                 03308000
TVWANOFB EQU   TVWAFLG4                                                 03309000
TVWAKBDL EQU   TVWAFLG4                                                 03310000
TVWAFMSC EQU   TVWAFLG4                                                 03311000
TVWATRDF EQU   TVWAFLG3                                                 03312000
TVWATRAN EQU   TVWAFLG3                                                 03313000
TVWAAIGN EQU   TVWAFLG3                                                 03314000
TVWASDSG EQU   TVWAFLG3                                                 03315000
TVWABRIN EQU   TVWAFLG3                                                 03316000
TVWABIR  EQU   TVWAFLG2                                                 03317000
TVWARTRY EQU   TVWAFLG2                                                 03318000
TVWABKMG EQU   TVWAFLG2                                                 03319000
TVWAERMG EQU   TVWAFLG2                                                 03320000
TVWAGERR EQU   TVWAFLG2                                                 03321000
TVWASCD  EQU   TVWAFLG2                                                 03322000
TVWAPGN  EQU   TVWAFLG2                                                 03323000
TVWABFC  EQU   TVWAFLG2                                                 03324000
TVWAOOPS EQU   TVWAFLG1                                                 03325000
TVWALTE  EQU   TVWAFLG1                                                 03326000
TVWAULK  EQU   TVWAFLG1                                                 03327000
TVWAXSCD EQU   TVWAFLG1                                                 03328000
TVWATID  EQU   TVWAFLG1                                                 03329000
TVWATAS  EQU   TVWAFLG1                                                 03330000
TVWATIS  EQU   TVWAFLG1                                                 03331000
TVWATOD  EQU   TVWAFLG1                                                 03332000
TVWADIN3 EQU   TVWADLST+8                                               03333000
TVWADIN2 EQU   TVWADLST+4                                               03334000
TVWADIN1 EQU   TVWADLST                                                 03335000
TVWAECB3 EQU   TVWAECBL+8                                               03336000
TVWAECB2 EQU   TVWAECBL+4                                               03337000
TVWAECB1 EQU   TVWAECBL                                                 03338000
TVWATECB EQU   TVWA+116                                                 03339000
TVWAECB  EQU   TVWA+112                                                 03340000
TVWALNSV EQU   TVWA+111                                                 03341000
@NM00150 EQU   TVWAFLG7                                                 03342000
TVWACHSE EQU   TVWAFLG7                                                 03343000
TVWATOBB EQU   TVWAFLG7                                                 03344000
TVWARISW EQU   TVWAFLG7                                                 03345000
TVWARET  EQU   TVWAFLG7                                                 03346000
TVWARDBF EQU   TVWAFLG7                                                 03347000
TVWASND1 EQU   TVWAFLG7                                                 03348000
TVWABKPG EQU   TVWAFLG7                                                 03349000
TVWAVSZ  EQU   TVWA+108                                                 03350000
TVWAVST  EQU   TVWA+104                                                 03351000
TVWAEXL  EQU   TVWA+100                                                 03352000
TVWARPL  EQU   TVWA+96                                                  03353000
TVWANIB  EQU   TVWA+92                                                  03354000
TVWAACB  EQU   TVWA+88                                                  03355000
TVWATQL2 EQU   TVWA+87                                                  03356000
TVWATQL1 EQU   TVWA+86                                                  03357000
TVWAATTN EQU   TVWA+85                                                  03358000
TVWACHNL EQU   TVWA+84                                                  03359000
TVWARTR  EQU   TVWA+72                                                  03360000
TVWAGMPT EQU   TVWA+68                                                  03361000
TVWALLWA EQU   TVWA+24                                                  03362000
TVWABFPT EQU   TVWA+20                                                  03363000
TVWATOPQ EQU   TVWA+16                                                  03364000
TVWATOMW EQU   TVWA+12                                                  03365000
TVWATIMW EQU   TVWA+8                                                   03366000
TVWAPPL  EQU   TVWA                                                     03367000
TVCSDATA EQU   TVCS+20                                                  03368000
@NM00149 EQU   TVCSINDS                                                 03369000
TVCSTGRC EQU   TVCSINDS                                                 03370000
TVCSRCRC EQU   TVCSINDS                                                 03371000
TVCSASCB EQU   TVCS+12                                                  03372000
TVCSEDIT EQU   TVCSOPTN                                                 03373000
TVCSBRK  EQU   TVCSOPTN                                                 03374000
TVCSHOLD EQU   TVCSOPTN                                                 03375000
TVCSNOWT EQU   TVCSOPTN                                                 03376000
TVCSPRIO EQU   TVCSOPTN                                                 03377000
@NM00148 EQU   TVCSOPTN                                                 03378000
TVCSPTGT EQU   TVCSOPTN                                                 03379000
TVCSGMSZ EQU   TVCS+6                                                   03380000
TVCSDASZ EQU   TVCS+4                                                   03381000
TVCSCODE EQU   TVCSECB+1                                                03382000
@NM00147 EQU   TVCSECB                                                  03383000
TVCSPOST EQU   TVCSECB                                                  03384000
TVCSWAIT EQU   TVCSECB                                                  03385000
TSBXEND  EQU   TSBX+120                                                 03386000
@NM00146 EQU   TSBX+116                                                 03387000
TSBXBIND EQU   TSBX+80                                                  03388000
TSBXRPL  EQU   TSBX+76                                                  03389000
TSBXTMBF EQU   TSBXTERM+2                                               03390000
@NM00145 EQU   TSBXTERM+1                                               03391000
TSBXTMTP EQU   TSBXTERM                                                 03392000
TSBXAIND EQU   TSBX+70                                                  03393000
TSBXRSZO EQU   TSBX+69                                                  03394000
TSBXRSZI EQU   TSBX+68                                                  03395000
TSBXLBUF EQU   TSBX+64                                                  03396000
TSBXSRB  EQU   TSBX+56                                                  03397000
TSBXSRBI EQU   TSBX+52                                                  03398000
@NM00144 EQU   TSBX+48                                                  03399000
TSBXTOM  EQU   TSBX+44                                                  03400000
TSBXTIM  EQU   TSBX+40                                                  03401000
@NM00143 EQU   TSBX+33                                                  03402000
@NM00142 EQU   TSBXFLG1                                                 03403000
TSBXWREC EQU   TSBXFLG1                                                 03404000
TSBXLOGF EQU   TSBXFLG1                                                 03405000
TSBXACTV EQU   TSBXFLG1                                                 03406000
TSBXASCI EQU   TSBXFLG1                                                 03407000
TSBXUID  EQU   TSBX+24                                                  03408000
@NM00141 EQU   TSBX+16                                                  03409000
@NM00140 EQU   TSBX+12                                                  03410000
TSBXECB  EQU   TSBX+8                                                   03411000
TSBXBCK  EQU   TSBX+4                                                   03412000
TSBXFWD  EQU   TSBX                                                     03413000
TSBEND   EQU   TSB+120                                                  03414000
TSBSF1   EQU   TSB+112                                                  03415000
TSBTRMID EQU   TSB+104                                                  03416000
TSBALTC  EQU   TSB+103                                                  03417000
TSBALTR  EQU   TSB+102                                                  03418000
TSBPRMC  EQU   TSB+101                                                  03419000
TSBPRMR  EQU   TSB+100                                                  03420000
TSBPSWD  EQU   TSB+88                                                   03421000
TSBLECB  EQU   TSBMINL                                                  03422000
TSBLINE  EQU   TSB+82                                                   03423000
TSBSTAX  EQU   TSB+81                                                   03424000
TSBATTNC EQU   TSB+80                                                   03425000
TSBF1V   EQU   TSBTPOST+7                                               03426000
TSBF1M   EQU   TSBTPOST+6                                               03427000
TSBF2V   EQU   TSBTPOST+5                                               03428000
TSBF2M   EQU   TSBTPOST+4                                               03429000
TSBFLAGV EQU   TSBTPOST+3                                               03430000
TSBFLAGM EQU   TSBTPOST+2                                               03431000
TSBSBASV EQU   TSBTPOST+1                                               03432000
@NM00139 EQU   TSBTPFLG                                                 03433000
@NM00138 EQU   TSBTPFLG                                                 03434000
@NM00137 EQU   TSBTPFLG                                                 03435000
@NM00136 EQU   TSBTPFLG                                                 03436000
TSBNEWID EQU   TSBTPFLG                                                 03437000
TSBTPAYI EQU   TSBTPFLG                                                 03438000
TSBTPQCB EQU   TSBTPFLG                                                 03439000
TSBPOSTO EQU   TSBTPFLG                                                 03440000
TSBLINKB EQU   TSBLINKA+1                                               03441000
TSBPRI   EQU   TSBLINKA                                                 03442000
TSBRQCB  EQU   TSBRCB                                                   03443000
TSBCTCB  EQU   TSB+60                                                   03444000
TSBERSDS EQU   TSB+56                                                   03445000
TSBATNCC EQU   TSB+44                                                   03446000
TSBASRCE EQU   TSB+42                                                   03447000
TSBHLDL  EQU   TSBFLG4                                                  03448000
TSBGETBF EQU   TSBFLG4                                                  03449000
TSBCANC  EQU   TSBFLG4                                                  03450000
TSBHOLD  EQU   TSBFLG4                                                  03451000
TSBHUNG  EQU   TSBFLG4                                                  03452000
TSBIWAIT EQU   TSBFLG4                                                  03453000
TSBOCAB  EQU   TSBFLG4                                                  03454000
TSBLNNO  EQU   TSB+40                                                   03455000
TSBATNTC EQU   TSB+38                                                   03456000
TSBATNLC EQU   TSB+36                                                   03457000
TSBCHDCC EQU   TSBSTCC+1                                                03458000
TSBLNDCC EQU   TSBSTCC                                                  03459000
TSBWTJID EQU   TSB+32                                                   03460000
TSBECB   EQU   TSB+28                                                   03461000
TSBC1050 EQU   TSBTERM2                                                 03462000
@NM00135 EQU   TSBTERM2                                                 03463000
@NM00134 EQU   TSBTERM2                                                 03464000
@NM00133 EQU   TSBTERM2                                                 03465000
@NM00132 EQU   TSBTERM2                                                 03466000
TSBCTWX  EQU   TSBTERM2                                                 03467000
@NM00131 EQU   TSBTERM2                                                 03468000
@NM00130 EQU   TSBTERM2                                                 03469000
@NM00129 EQU   TSBTERM1                                                 03470000
@NM00128 EQU   TSBTERM1                                                 03471000
@NM00127 EQU   TSBTERM1                                                 03472000
TSBC2741 EQU   TSBTERM1                                                 03473000
TSBC5041 EQU   TSBTERM1                                                 03474000
TSBCATTN EQU   TSBTERM1                                                 03475000
TSBCBRK  EQU   TSBTERM1                                                 03476000
TSBCIHBN EQU   TSBTERM1                                                 03477000
TSBVTAM  EQU   TSBFLG5                                                  03478000
TSBKEYS  EQU   TSBFLG5                                                  03479000
@NM00126 EQU   TSBFLG5                                                  03480000
TSBATMP  EQU   TSBFLG5                                                  03481000
TSBNFLOP EQU   TSBFLG3                                                  03482000
TSBNOBRK EQU   TSBFLG3                                                  03483000
TSBTPUT  EQU   TSBFLG3                                                  03484000
TSBAWOIP EQU   TSBFLG3                                                  03485000
TSBNBKSP EQU   TSBFLG3                                                  03486000
TSBSPIT  EQU   TSBFLG3                                                  03487000
TSBTJMSG EQU   TSBFLG3                                                  03488000
TSBATTN  EQU   TSBFLG3                                                  03489000
TSBIBFP  EQU   TSB+21                                                   03490000
TSBNIBF  EQU   TSB+20                                                   03491000
TSBITBFP EQU   TSB+17                                                   03492000
TSBSATN2 EQU   TSBFLG2                                                  03493000
TSBSATN1 EQU   TSBFLG2                                                  03494000
TSBSTAUT EQU   TSBFLG2                                                  03495000
TSBAUTOC EQU   TSBFLG2                                                  03496000
TSBAULST EQU   TSBFLG2                                                  03497000
TSBBRKIN EQU   TSBFLG2                                                  03498000
TSBAUTON EQU   TSBFLG2                                                  03499000
TSBBIPI  EQU   TSBFLG2                                                  03500000
TSBOBFP  EQU   TSB+13                                                   03501000
TSBNOBF  EQU   TSB+12                                                   03502000
TSBOTBFP EQU   TSB+9                                                    03503000
TSBLNSZ  EQU   TSB+8                                                    03504000
TSBWTCB  EQU   TSB+5                                                    03505000
TSBTJIP  EQU   TSBFLG1                                                  03506000
TSBTJOW  EQU   TSBFLG1                                                  03507000
TSBIFLSH EQU   TSBFLG1                                                  03508000
TSBWOWIP EQU   TSBFLG1                                                  03509000
TSBOWIP  EQU   TSBFLG1                                                  03510000
TSBOFLSH EQU   TSBFLG1                                                  03511000
TSBANSR  EQU   TSBFLG1                                                  03512000
TSBASCB  EQU   TSBASCBA+1                                               03513000
TSBATNLD EQU   TSBSTAT                                                  03514000
TSB3270  EQU   TSBSTAT                                                  03515000
TSBDISC  EQU   TSBSTAT                                                  03516000
TSBITOFF EQU   TSBSTAT                                                  03517000
TSBDSPLY EQU   TSBSTAT                                                  03518000
TSBLWAIT EQU   TSBSTAT                                                  03519000
TSBINUSE EQU   TSBSTAT                                                  03520000
TCASTEND EQU   TCAST+136                                                03521000
TCASDUMP EQU   TCAST+132                                                03522000
TCASSCHD EQU   TCAST+128                                                03523000
@NM00125 EQU   TCAST+124                                                03524000
TCASOMJR EQU   TCAST+120                                                03525000
@NM00124 EQU   TCAST+118                                                03526000
TCASBR14 EQU   TCAST+116                                                03527000
TCASATTN EQU   TCAST+112                                                03528000
TCASASCI EQU   TCAST+108                                                03529000
TCASTTQH EQU   TCAST+104                                                03530000
@NM00123 EQU   TCAST+102                                                03531000
@NM00122 EQU   TCAST+100                                                03532000
@NM00121 EQU   TCAST+98                                                 03533000
@NM00120 EQU   TCAST+96                                                 03534000
TCASASCB EQU   TCAST+92                                                 03535000
@NM00119 EQU   TCAST+90                                                 03536000
@NM00118 EQU   TCASFLG2                                                 03537000
@NM00117 EQU   TCASFLG1                                                 03538000
TCASNACT EQU   TCASFLG1                                                 03539000
@NM00116 EQU   TCASFLG1                                                 03540000
TCASABND EQU   TCASFLG1                                                 03541000
TCASMDSW EQU   TCASFLG1                                                 03542000
TCASBKMD EQU   TCASFLG1                                                 03543000
TCASLTE  EQU   TCAST+84                                                 03544000
TCASEXIT EQU   TCAST+80                                                 03545000
TCASOQM  EQU   TCAST+76                                                 03546000
TCASIQM  EQU   TCAST+72                                                 03547000
TCASTSB  EQU   TCAST+68                                                 03548000
TCASTTL  EQU   TCAST+64                                                 03549000
TCASWA   EQU   TCAST+60                                                 03550000
TCASFRR  EQU   TCAST+56                                                 03551000
TCASDATO EQU   TCAST+48                                                 03552000
TCASDATI EQU   TCAST+44                                                 03553000
TCASXECB EQU   TCAST+40                                                 03554000
TCASTID  EQU   TCAST+32                                                 03555000
@NM00115 EQU   TCAST+31                                                 03556000
TCASCHNL EQU   TCAST+30                                                 03557000
TCASCRSZ EQU   TCAST+28                                                 03558000
TCASLBUF EQU   TCAST+24                                                 03559000
TCASHBUF EQU   TCAST+20                                                 03560000
TCASCLSZ EQU   TCAST+18                                                 03561000
TCASRCON EQU   TCAST+16                                                 03562000
TCASACBP EQU   TCAST+8                                                  03563000
TCASUMAX EQU   TCASUSER+2                                               03564000
TCASUSEC EQU   TCASUSER                                                 03565000
TCASID   EQU   TCAST                                                    03566000
@NM00114 EQU   SRBSECT+40                                               03567000
@NM00113 EQU   SRBSECT+38                                               03568000
SRBPRIOR EQU   SRBSECT+37                                               03569000
SRBPKF   EQU   SRBSECT+36                                               03570000
SRBSAVE  EQU   SRBSECT+32                                               03571000
SRBPARM  EQU   SRBSECT+28                                               03572000
SRBRMTR  EQU   SRBSECT+24                                               03573000
SRBEP    EQU   SRBSECT+20                                               03574000
SRBPTCB  EQU   SRBFLC+4                                                 03575000
SRBPASID EQU   SRBFLC+2                                                 03576000
SRBCPAFF EQU   SRBFLC                                                   03577000
SRBASCB  EQU   SRBSECT+8                                                03578000
SRBID    EQU   SRBSECT                                                  03579000
@NM00112 EQU   SDWA+512                                                 03580000
SDWAVRA  EQU   SDWARA+4                                                 03581000
SDWAURAL EQU   SDWARA+3                                                 03582000
@NM00111 EQU   SDWADPVA                                                 03583000
SDWAEBC  EQU   SDWADPVA                                                 03584000
SDWAHEX  EQU   SDWADPVA                                                 03585000
SDWAVRAL EQU   SDWARA                                                   03586000
@NM00110 EQU   SDWA+396                                                 03587000
SDWACOMP EQU   SDWA+392                                                 03588000
SDWARCPL EQU   SDWA+364                                                 03589000
@NM00109 EQU   SDWADPSA+32                                              03590000
SDWATO4  EQU   SDWADPSL+28                                              03591000
SDWAFRM4 EQU   SDWADPSL+24                                              03592000
SDWATO3  EQU   SDWADPSL+20                                              03593000
SDWAFRM3 EQU   SDWADPSL+16                                              03594000
SDWATO2  EQU   SDWADPSL+12                                              03595000
SDWAFRM2 EQU   SDWADPSL+8                                               03596000
@NM00108 EQU   SDWADDAT+3                                               03597000
@NM00107 EQU   SDWAPDAT                                                 03598000
SDWAUSPL EQU   SDWAPDAT                                                 03599000
SDWADPSW EQU   SDWAPDAT                                                 03600000
SDWATJPA EQU   SDWAPDAT                                                 03601000
SDWATLPA EQU   SDWAPDAT                                                 03602000
SDWADREG EQU   SDWAPDAT                                                 03603000
SDWADSAH EQU   SDWAPDAT                                                 03604000
SDWADSAS EQU   SDWAPDAT                                                 03605000
@NM00106 EQU   SDWADDAT+1                                               03606000
@NM00105 EQU   SDWASDAT                                                 03607000
SDWAQQS  EQU   SDWASDAT                                                 03608000
SDWACBS  EQU   SDWASDAT                                                 03609000
SDWAGTF  EQU   SDWASDAT                                                 03610000
SDWASWA  EQU   SDWASDAT                                                 03611000
SDWALSQA EQU   SDWASDAT                                                 03612000
SDWASQA  EQU   SDWASDAT                                                 03613000
SDWANUC  EQU   SDWASDAT                                                 03614000
@NM00104 EQU   SDWADUMP+2                                               03615000
@NM00103 EQU   SDWADPFS                                                 03616000
SDWASLST EQU   SDWADPFS                                                 03617000
@NM00102 EQU   SDWADPFS                                                 03618000
SDWADLST EQU   SDWADPFS                                                 03619000
SDWADPT  EQU   SDWADPFS                                                 03620000
SDWADPID EQU   SDWADUMP                                                 03621000
SDWADPLA EQU   SDWA+316                                                 03622000
@NM00101 EQU   SDWALKWA+32                                              03623000
SDWATALW EQU   SDWALKWS+28                                              03624000
SDWATDLW EQU   SDWALKWS+24                                              03625000
SDWATNLW EQU   SDWALKWS+20                                              03626000
SDWAAPLW EQU   SDWALKWS+16                                              03627000
SDWAIPLW EQU   SDWALKWS+12                                              03628000
SDWAILLW EQU   SDWALKWS+8                                               03629000
SDWAIULW EQU   SDWALKWS+4                                               03630000
SDWAICLW EQU   SDWALKWS                                                 03631000
SDWAFLLK EQU   SDWAACF4                                                 03632000
SDWACMS  EQU   SDWAACF4                                                 03633000
SDWAOPTM EQU   SDWAACF4                                                 03634000
SDWATADB EQU   SDWAACF4                                                 03635000
SDWATDNB EQU   SDWAACF4                                                 03636000
SDWATNCB EQU   SDWAACF4                                                 03637000
SDWAILCH EQU   SDWAACF4                                                 03638000
SDWAIUCB EQU   SDWAACF4                                                 03639000
SDWAICAT EQU   SDWAACF3                                                 03640000
SDWAIPRG EQU   SDWAACF3                                                 03641000
SDWASALL EQU   SDWAACF3                                                 03642000
SDWAASMP EQU   SDWAACF3                                                 03643000
SDWADISP EQU   SDWAACF3                                                 03644000
@NM00100 EQU   SDWAACF3                                                 03645000
@NM00099 EQU   SDWAACF2                                                 03646000
SDWAFREE EQU   SDWAACF2                                                 03647000
@NM00098 EQU   SDWAACF2                                                 03648000
SDWASPIN EQU   SDWAACF2                                                 03649000
@NM00097 EQU   SDWAACF2                                                 03650000
SDWALCPU EQU   SDWACPUA+2                                               03651000
@NM00096 EQU   SDWACPUA                                                 03652000
@NM00095 EQU   SDWA+239                                                 03653000
@NM00094 EQU   SDWAIOFS                                                 03654000
SDWANIOP EQU   SDWAIOFS                                                 03655000
SDWANOIO EQU   SDWAIOFS                                                 03656000
SDWAIOHT EQU   SDWAIOFS                                                 03657000
SDWAIOQR EQU   SDWAIOFS                                                 03658000
SDWAFMID EQU   SDWA+236                                                 03659000
@NM00093 EQU   SDWAERRD                                                 03660000
SDWAMCIV EQU   SDWAERRD                                                 03661000
SDWARPIV EQU   SDWAERRD                                                 03662000
SDWAMABD EQU   SDWAERRD                                                 03663000
SDWACTS  EQU   SDWAERRD                                                 03664000
SDWASTAE EQU   SDWAERRD                                                 03665000
SDWANRBE EQU   SDWAERRD                                                 03666000
SDWACLUP EQU   SDWAERRD                                                 03667000
@NM00092 EQU   SDWAERRC                                                 03668000
SDWAEAS  EQU   SDWAERRC                                                 03669000
SDWAIRB  EQU   SDWAERRC                                                 03670000
SDWASTAI EQU   SDWAERRC                                                 03671000
SDWASRBM EQU   SDWAERRB                                                 03672000
SDWALDIS EQU   SDWAERRB                                                 03673000
SDWAENRB EQU   SDWAERRB                                                 03674000
SDWATYP1 EQU   SDWAERRB                                                 03675000
@NM00091 EQU   SDWAERRB                                                 03676000
SDWAPGIO EQU   SDWAERRA                                                 03677000
SDWATEXC EQU   SDWAERRA                                                 03678000
SDWASVCE EQU   SDWAERRA                                                 03679000
SDWAABTM EQU   SDWAERRA                                                 03680000
SDWASVCD EQU   SDWAERRA                                                 03681000
SDWARKEY EQU   SDWAERRA                                                 03682000
SDWAPCHK EQU   SDWAERRA                                                 03683000
SDWAMCHK EQU   SDWAERRA                                                 03684000
SDWATIME EQU   SDWAMCH+20                                               03685000
SDWARFSA EQU   SDWAMCH+16                                               03686000
@NM00090 EQU   SDWAMCH+14                                               03687000
SDWAVEQR EQU   SDWARSR2                                                 03688000
SDWAPGFX EQU   SDWARSR2                                                 03689000
SDWAFLSQ EQU   SDWARSR2                                                 03690000
SDWAFSQA EQU   SDWARSR2                                                 03691000
SDWANUCL EQU   SDWARSR2                                                 03692000
SDWASPER EQU   SDWARSR2                                                 03693000
SDWAINTC EQU   SDWARSR2                                                 03694000
SDWAOFLN EQU   SDWARSR2                                                 03695000
SDWACHNG EQU   SDWARSR1                                                 03696000
SDWAMSER EQU   SDWARSR1                                                 03697000
@NM00089 EQU   SDWARSR1                                                 03698000
SDWACPID EQU   SDWAMCH+10                                               03699000
SDWATERR EQU   SDWAMCHD                                                 03700000
SDWAFPRX EQU   SDWAMCHD                                                 03701000
SDWAINSF EQU   SDWAMCHD                                                 03702000
SDWAACR  EQU   SDWAMCHD                                                 03703000
SDWASCK  EQU   SDWAMCHD                                                 03704000
SDWAPSWU EQU   SDWAMCHD                                                 03705000
SDWAREGU EQU   SDWAMCHD                                                 03706000
SDWASKYF EQU   SDWAMCHD                                                 03707000
@NM00088 EQU   SDWAMCHS                                                 03708000
SDWARSRF EQU   SDWAMCHS                                                 03709000
SDWARSRC EQU   SDWAMCHS                                                 03710000
SDWAINVP EQU   SDWAMCHS                                                 03711000
SDWATSVL EQU   SDWAMCHS                                                 03712000
SDWARCDF EQU   SDWAMCHS                                                 03713000
SDWASRVL EQU   SDWAMCHS                                                 03714000
SDWASCKE EQU   SDWASTCK+4                                               03715000
SDWASCKB EQU   SDWASTCK                                                 03716000
SDWALNTH EQU   SDWAIDNT+1                                               03717000
SDWASPID EQU   SDWAIDNT                                                 03718000
SDWASR14 EQU   SDWASRSV+56                                              03719000
SDWASR13 EQU   SDWASRSV+52                                              03720000
SDWASR12 EQU   SDWASRSV+48                                              03721000
SDWASR11 EQU   SDWASRSV+44                                              03722000
SDWASR10 EQU   SDWASRSV+40                                              03723000
SDWASR09 EQU   SDWASRSV+36                                              03724000
SDWASR08 EQU   SDWASRSV+32                                              03725000
SDWASR07 EQU   SDWASRSV+28                                              03726000
SDWASR06 EQU   SDWASRSV+24                                              03727000
SDWASR05 EQU   SDWASRSV+20                                              03728000
SDWASR04 EQU   SDWASRSV+16                                              03729000
SDWASR03 EQU   SDWASRSV+12                                              03730000
SDWASR02 EQU   SDWASRSV+8                                               03731000
SDWASR01 EQU   SDWASRSV+4                                               03732000
SDWASR00 EQU   SDWASRSV                                                 03733000
SDWATRN2 EQU   SDWAAEC2+4                                               03734000
SDWAIPC2 EQU   SDWAICD2                                                 03735000
SDWAIMC2 EQU   SDWAICD2                                                 03736000
SDWAIPR2 EQU   SDWAICD2                                                 03737000
@NM00087 EQU   SDWAINC2                                                 03738000
@NM00086 EQU   SDWAILC2                                                 03739000
SDWAIL2  EQU   SDWAILC2                                                 03740000
@NM00085 EQU   SDWAILC2                                                 03741000
@NM00084 EQU   SDWAAEC2                                                 03742000
SDWAADD2 EQU   SDWANXT2+1                                               03743000
@NM00083 EQU   SDWANXT2                                                 03744000
@NM00082 EQU   SDWAEC2+3                                                03745000
SDWASGN2 EQU   SDWAINT2                                                 03746000
SDWAEXP2 EQU   SDWAINT2                                                 03747000
SDWADEC2 EQU   SDWAINT2                                                 03748000
SDWAFPO2 EQU   SDWAINT2                                                 03749000
SDWACC2  EQU   SDWAINT2                                                 03750000
@NM00081 EQU   SDWAINT2                                                 03751000
SDWAPGM2 EQU   SDWAMWP2                                                 03752000
SDWAWAT2 EQU   SDWAMWP2                                                 03753000
SDWAMCK2 EQU   SDWAMWP2                                                 03754000
SDWAECT2 EQU   SDWAMWP2                                                 03755000
SDWAKEY2 EQU   SDWAMWP2                                                 03756000
SDWAEXT2 EQU   SDWAEMK2                                                 03757000
SDWAIO2  EQU   SDWAEMK2                                                 03758000
SDWATRM2 EQU   SDWAEMK2                                                 03759000
@NM00080 EQU   SDWAEMK2                                                 03760000
SDWAPER2 EQU   SDWAEMK2                                                 03761000
@NM00079 EQU   SDWAEMK2                                                 03762000
SDWATRAN EQU   SDWAAEC1+4                                               03763000
SDWAIPC1 EQU   SDWAICD1                                                 03764000
SDWAIMC1 EQU   SDWAICD1                                                 03765000
SDWAIPR1 EQU   SDWAICD1                                                 03766000
@NM00078 EQU   SDWAINC1                                                 03767000
@NM00077 EQU   SDWAILC1                                                 03768000
SDWAIL1  EQU   SDWAILC1                                                 03769000
@NM00076 EQU   SDWAILC1                                                 03770000
@NM00075 EQU   SDWAAEC1                                                 03771000
SDWAADD1 EQU   SDWANXT1+1                                               03772000
@NM00074 EQU   SDWANXT1                                                 03773000
@NM00073 EQU   SDWAEC1+3                                                03774000
SDWASGN1 EQU   SDWAINT1                                                 03775000
SDWAEXP1 EQU   SDWAINT1                                                 03776000
SDWADEC1 EQU   SDWAINT1                                                 03777000
SDWAFPO1 EQU   SDWAINT1                                                 03778000
SDWACC1  EQU   SDWAINT1                                                 03779000
@NM00072 EQU   SDWAINT1                                                 03780000
SDWAPGM1 EQU   SDWAMWP1                                                 03781000
SDWAWAT1 EQU   SDWAMWP1                                                 03782000
SDWAMCK1 EQU   SDWAMWP1                                                 03783000
SDWAECT1 EQU   SDWAMWP1                                                 03784000
SDWAKEY1 EQU   SDWAMWP1                                                 03785000
SDWAEXT1 EQU   SDWAEMK1                                                 03786000
SDWAIO1  EQU   SDWAEMK1                                                 03787000
SDWATRM1 EQU   SDWAEMK1                                                 03788000
@NM00071 EQU   SDWAEMK1                                                 03789000
SDWAPER1 EQU   SDWAEMK1                                                 03790000
@NM00070 EQU   SDWAEMK1                                                 03791000
SDWAIOBR EQU   SDWA+100                                                 03792000
SDWAEPA  EQU   SDWA+96                                                  03793000
@NM00069 EQU   SDWANAME+4                                               03794000
SDWARBAD EQU   SDWANAME                                                 03795000
SDWAGR15 EQU   SDWAGRSV+60                                              03796000
SDWAGR14 EQU   SDWAGRSV+56                                              03797000
SDWAGR13 EQU   SDWAGRSV+52                                              03798000
SDWAGR12 EQU   SDWAGRSV+48                                              03799000
SDWAGR11 EQU   SDWAGRSV+44                                              03800000
SDWAGR10 EQU   SDWAGRSV+40                                              03801000
SDWAGR09 EQU   SDWAGRSV+36                                              03802000
SDWAGR08 EQU   SDWAGRSV+32                                              03803000
SDWAGR07 EQU   SDWAGRSV+28                                              03804000
SDWAGR06 EQU   SDWAGRSV+24                                              03805000
SDWAGR05 EQU   SDWAGRSV+20                                              03806000
SDWAGR04 EQU   SDWAGRSV+16                                              03807000
SDWAGR03 EQU   SDWAGRSV+12                                              03808000
SDWAGR02 EQU   SDWAGRSV+8                                               03809000
SDWAGR01 EQU   SDWAGRSV+4                                               03810000
SDWAGR00 EQU   SDWAGRSV                                                 03811000
SDWANXTP EQU   SDWACTL2+5                                               03812000
SDWASGP  EQU   SDWAPMKP                                                 03813000
SDWAEUP  EQU   SDWAPMKP                                                 03814000
SDWADOP  EQU   SDWAPMKP                                                 03815000
SDWAFPP  EQU   SDWAPMKP                                                 03816000
SDWACCP  EQU   SDWAPMKP                                                 03817000
SDWAILP  EQU   SDWAPMKP                                                 03818000
SDWAINTP EQU   SDWACTL2+2                                               03819000
SDWASPVP EQU   SDWAMWPP                                                 03820000
SDWAWATP EQU   SDWAMWPP                                                 03821000
SDWAMCKP EQU   SDWAMWPP                                                 03822000
@NM00068 EQU   SDWAMWPP                                                 03823000
SDWAKEYP EQU   SDWAMWPP                                                 03824000
SDWAEXTP EQU   SDWACMKP                                                 03825000
SDWAIOP  EQU   SDWACMKP                                                 03826000
SDWANXTA EQU   SDWACTL1+5                                               03827000
SDWASGA  EQU   SDWAPMKA                                                 03828000
SDWAEUA  EQU   SDWAPMKA                                                 03829000
SDWADOA  EQU   SDWAPMKA                                                 03830000
SDWAFPA  EQU   SDWAPMKA                                                 03831000
SDWACCA  EQU   SDWAPMKA                                                 03832000
SDWAILA  EQU   SDWAPMKA                                                 03833000
SDWAINTA EQU   SDWACTL1+2                                               03834000
SDWASPVA EQU   SDWAMWPA                                                 03835000
SDWAWATA EQU   SDWAMWPA                                                 03836000
SDWAMCKA EQU   SDWAMWPA                                                 03837000
@NM00067 EQU   SDWAMWPA                                                 03838000
SDWAKEYA EQU   SDWAMWPA                                                 03839000
SDWAEXTA EQU   SDWACMKA                                                 03840000
SDWAIOA  EQU   SDWACMKA                                                 03841000
SDWACMPC EQU   SDWAABCC+1                                               03842000
@NM00066 EQU   SDWACMPF                                                 03843000
SDWASTCC EQU   SDWACMPF                                                 03844000
@NM00065 EQU   SDWACMPF                                                 03845000
SDWASTEP EQU   SDWACMPF                                                 03846000
SDWAREQ  EQU   SDWACMPF                                                 03847000
SDWAPARM EQU   SDWA                                                     03848000
@NM00064 EQU   SCVTSECT+180                                             03849000
@NM00063 EQU   SCVTSECT+176                                             03850000
SCVTPIQE EQU   SCVTSECT+172                                             03851000
@NM00062 EQU   SCVTSECT+168                                             03852000
SCVTPTRM EQU   SCVTSECT+164                                             03853000
@NM00061 EQU   SCVTSECT+160                                             03854000
@NM00060 EQU   SCVTSECT+156                                             03855000
SCVTQCBR EQU   SCVTSECT+152                                             03856000
@NM00059 EQU   SCVTSECT+144                                             03857000
SCVTTQE  EQU   SCVTSECT+140                                             03858000
@NM00058 EQU   SCVTSECT+136                                             03859000
SCVTSVCT EQU   SCVTSECT+132                                             03860000
@NM00057 EQU   SCVTSECT+128                                             03861000
@NM00056 EQU   SCVTSECT+124                                             03862000
SCVTRXLQ EQU   SCVTSECT+120                                             03863000
@NM00055 EQU   SCVTSECT+116                                             03864000
SCVTCTCB EQU   SCVTSECT+112                                             03865000
@NM00054 EQU   SCVTSECT+108                                             03866000
@NM00053 EQU   SCVTSECT+104                                             03867000
@NM00052 EQU   SCVTSECT+100                                             03868000
@NM00051 EQU   SCVTSECT+96                                              03869000
SCVTCOMM EQU   SCVTSECT+92                                              03870000
@NM00050 EQU   SCVTSECT+88                                              03871000
@NM00049 EQU   SCVTSECT+84                                              03872000
@NM00048 EQU   SCVTSECT+80                                              03873000
@NM00047 EQU   SCVTSECT+76                                              03874000
@NM00046 EQU   SCVTSECT+72                                              03875000
SCVTGMBR EQU   SCVTSECT+68                                              03876000
SCVTRPTR EQU   SCVTSECT+64                                              03877000
SCVTHSKP EQU   SCVTSECT+60                                              03878000
@NM00045 EQU   SCVTSECT+56                                              03879000
@NM00044 EQU   SCVTSECT+52                                              03880000
SCVTLFRM EQU   SCVTSECT+48                                              03881000
SCVTCDCL EQU   SCVTSECT+44                                              03882000
@NM00043 EQU   SCVTSECT+40                                              03883000
SCVTRACE EQU   SCVTSECT+36                                              03884000
@NM00042 EQU   SCVTSECT+32                                              03885000
SCVTRMBR EQU   SCVTSECT+28                                              03886000
@NM00041 EQU   SCVTSECT+24                                              03887000
@NM00040 EQU   SCVTSECT+20                                              03888000
@NM00039 EQU   SCVTSECT+16                                              03889000
@NM00038 EQU   SCVTSECT+14                                              03890000
SCVTBR14 EQU   SCVTSECT+12                                              03891000
SCVTSPET EQU   SCVTSECT+8                                               03892000
SCVTPGWR EQU   SCVTSECT+4                                               03893000
SCVTPGTM EQU   SCVTSECT                                                 03894000
QVPLFELM EQU   QVPLTYP2+36                                              03895000
QVPLRES4 EQU   QVPLFLGB                                                 03896000
QVPLBP3  EQU   QVPLFLGB                                                 03897000
QVPLRES3 EQU   QVPLFLGT                                                 03898000
QVPLTR3  EQU   QVPLFLGT                                                 03899000
QVPLLELM EQU   QVPLTYP1+24                                              03900000
QVPLRES2 EQU   QVPLFLGF                                                 03901000
QVPLFP3  EQU   QVPLFLGF                                                 03902000
QVPLRES1 EQU   QVPLFLGH                                                 03903000
QVPLHD3  EQU   QVPLFLGH                                                 03904000
QVPLNOEL EQU   QVPLTYP1+12                                              03905000
@NM00013 EQU   FRRSFLGS+1                                               03906000
@NM00012 EQU   FRRSFLG1                                                 03907000
FRRSRCUR EQU   FRRSFLG1                                                 03908000
FRRSENTS EQU   FRRS+84                                                  03909000
FRRSRTMW EQU   FRRS+16                                                  03910000
CVTLEVL  EQU   CVTRELNO+2                                               03911000
CVTNUMB  EQU   CVTRELNO                                                 03912000
CVTMDL   EQU   CVTFIX+250                                               03913000
@NM00011 EQU   CVTFIX+248                                               03914000
@NM00010 EQU   CVTFIX                                                   03915000
CVTRV482 EQU   CVTXTNT2+128                                             03916000
CVTRV481 EQU   CVTXTNT2+124                                             03917000
CVTRV480 EQU   CVTXTNT2+120                                             03918000
CVTRV479 EQU   CVTXTNT2+118                                             03919000
CVTRV478 EQU   CVTXTNT2+117                                             03920000
CVTRV477 EQU   CVTXTNT2+116                                             03921000
CVTRV476 EQU   CVTXTNT2+115                                             03922000
CVTRV475 EQU   CVTXTNT2+114                                             03923000
CVTRV474 EQU   CVTRV466                                                 03924000
CVTRV473 EQU   CVTRV466                                                 03925000
CVTRV472 EQU   CVTRV466                                                 03926000
CVTRV471 EQU   CVTRV466                                                 03927000
CVTRV470 EQU   CVTRV466                                                 03928000
CVTRV469 EQU   CVTRV466                                                 03929000
CVTRV468 EQU   CVTRV466                                                 03930000
CVTRV467 EQU   CVTRV466                                                 03931000
CVTRV465 EQU   CVTRV457                                                 03932000
CVTRV464 EQU   CVTRV457                                                 03933000
CVTRV463 EQU   CVTRV457                                                 03934000
CVTRV462 EQU   CVTRV457                                                 03935000
CVTRV461 EQU   CVTRV457                                                 03936000
CVTRV460 EQU   CVTRV457                                                 03937000
CVTRV459 EQU   CVTRV457                                                 03938000
CVTRV458 EQU   CVTRV457                                                 03939000
CVTRV456 EQU   CVTXTNT2+108                                             03940000
CVTRV455 EQU   CVTXTNT2+104                                             03941000
CVTRV454 EQU   CVTXTNT2+100                                             03942000
CVTRV453 EQU   CVTXTNT2+96                                              03943000
CVTRV452 EQU   CVTXTNT2+94                                              03944000
CVTRV451 EQU   CVTXTNT2+92                                              03945000
CVTRV450 EQU   CVTXTNT2+90                                              03946000
CVTRV449 EQU   CVTXTNT2+88                                              03947000
CVTRV448 EQU   CVTXTNT2+87                                              03948000
CVTRV447 EQU   CVTXTNT2+86                                              03949000
CVTRV446 EQU   CVTRV438                                                 03950000
CVTRV445 EQU   CVTRV438                                                 03951000
CVTRV444 EQU   CVTRV438                                                 03952000
CVTRV443 EQU   CVTRV438                                                 03953000
CVTRV442 EQU   CVTRV438                                                 03954000
CVTRV441 EQU   CVTRV438                                                 03955000
CVTRV440 EQU   CVTRV438                                                 03956000
CVTRV439 EQU   CVTRV438                                                 03957000
CVTRV437 EQU   CVTRV429                                                 03958000
CVTRV436 EQU   CVTRV429                                                 03959000
CVTRV435 EQU   CVTRV429                                                 03960000
CVTRV434 EQU   CVTRV429                                                 03961000
CVTRV433 EQU   CVTRV429                                                 03962000
CVTRV432 EQU   CVTRV429                                                 03963000
CVTRV431 EQU   CVTRV429                                                 03964000
CVTRV430 EQU   CVTRV429                                                 03965000
CVTRV428 EQU   CVTXTNT2+80                                              03966000
CVTRV427 EQU   CVTXTNT2+76                                              03967000
CVTRV426 EQU   CVTXTNT2+72                                              03968000
CVTRV425 EQU   CVTXTNT2+68                                              03969000
CVTATACT EQU   CVTATCVT                                                 03970000
CVTRV423 EQU   CVTXTNT2+62                                              03971000
CVTRV422 EQU   CVTXTNT2+60                                              03972000
CVTRV421 EQU   CVTXTNT2+58                                              03973000
CVTRV420 EQU   CVTXTNT2+56                                              03974000
CVTRV419 EQU   CVTXTNT2+55                                              03975000
CVTRV418 EQU   CVTXTNT2+54                                              03976000
CVTRV417 EQU   CVTRV409                                                 03977000
CVTRV416 EQU   CVTRV409                                                 03978000
CVTRV415 EQU   CVTRV409                                                 03979000
CVTRV414 EQU   CVTRV409                                                 03980000
CVTRV413 EQU   CVTRV409                                                 03981000
CVTRV412 EQU   CVTRV409                                                 03982000
CVTRV411 EQU   CVTRV409                                                 03983000
CVTRV410 EQU   CVTRV409                                                 03984000
CVTRV408 EQU   CVTRV400                                                 03985000
CVTRV407 EQU   CVTRV400                                                 03986000
CVTRV406 EQU   CVTRV400                                                 03987000
CVTRV405 EQU   CVTRV400                                                 03988000
CVTRV404 EQU   CVTRV400                                                 03989000
CVTRV403 EQU   CVTRV400                                                 03990000
CVTRV402 EQU   CVTRV400                                                 03991000
CVTRV401 EQU   CVTRV400                                                 03992000
CVTICB   EQU   CVTXTNT2+48                                              03993000
CVTSKTA  EQU   CVTXTNT2+44                                              03994000
CVTSHSB  EQU   CVTSHS                                                   03995000
CVTRSV98 EQU   CVTXTNT2+36                                              03996000
CVTRSV97 EQU   CVTXTNT2+34                                              03997000
CVTRSV96 EQU   CVTXTNT2+32                                              03998000
CVTOLTEP EQU   CVTXTNT2+28                                              03999000
CVTQIDA  EQU   CVTQID+1                                                 04000000
CVTRSV95 EQU   CVTQID                                                   04001000
CVTRSV94 EQU   CVTXTNT2+20                                              04002000
CVTRSV93 EQU   CVTXTNT2+16                                              04003000
CVTRSV92 EQU   CVTXTNT2+12                                              04004000
CVTDEBVR EQU   CVTXTNT2+8                                               04005000
CVTRSV91 EQU   CVTXTNT2+6                                               04006000
CVTRSV9H EQU   CVTFLGBT                                                 04007000
CVTRSV9G EQU   CVTFLGBT                                                 04008000
CVTRSV9F EQU   CVTFLGBT                                                 04009000
CVTRSV9E EQU   CVTFLGBT                                                 04010000
CVTRSV9D EQU   CVTFLGBT                                                 04011000
CVTRSV9C EQU   CVTFLGBT                                                 04012000
CVTVME   EQU   CVTFLGBT                                                 04013000
CVTNPE   EQU   CVTFLGBT                                                 04014000
CVTNUCLS EQU   CVTXTNT2+4                                               04015000
CVTDSSVA EQU   CVTDSSV+1                                                04016000
CVTRSV89 EQU   CVTDSSV                                                  04017000
CVTRSV88 EQU   CVTXTNT1+8                                               04018000
CVTRSV87 EQU   CVTXTNT1+4                                               04019000
CVTFACHN EQU   CVTXTNT1                                                 04020000
CVTRV488 EQU   CVTMAP+412                                               04021000
CVTRV487 EQU   CVTMAP+408                                               04022000
CVTRV486 EQU   CVTMAP+404                                               04023000
CVTRV485 EQU   CVTMAP+400                                               04024000
CVTACTAP EQU   CVTMAP+396                                               04025000
CVTAUTH  EQU   CVTMAP+392                                               04026000
CVTATMCA EQU   CVTATMCT+1                                               04027000
CVTATMST EQU   CVTATMCT                                                 04028000
CVTRSV61 EQU   CVTMAP+384                                               04029000
CVTVOLT1 EQU   CVTVOLM1+1                                               04030000
CVTVOLI1 EQU   CVTVOLF1                                                 04031000
CVTSTOA  EQU   CVTMAP+376                                               04032000
CVTRSV58 EQU   CVTMAP+374                                               04033000
CVTRSV57 EQU   CVTMAP+372                                               04034000
CVTDDCE  EQU   CVTMAP+368                                               04035000
CVTPNWFR EQU   CVTMAP+364                                               04036000
CVTSMF   EQU   CVTMAP+360                                               04037000
CVTSULK  EQU   CVTMAP+358                                               04038000
CVTSLKO  EQU   CVTSYSK                                                  04039000
CVTSLKP  EQU   CVTSYSK                                                  04040000
CVTSLKQ  EQU   CVTSYSK                                                  04041000
CVTSLKR  EQU   CVTSYSK                                                  04042000
CVTRSV56 EQU   CVTSYSK                                                  04043000
CVTRSV55 EQU   CVTSYSK                                                  04044000
CVTRSV54 EQU   CVTSYSK                                                  04045000
CVTRSV53 EQU   CVTSYSK                                                  04046000
CVTRSV52 EQU   CVTA1F1                                                  04047000
CVTRSV51 EQU   CVTA1F1                                                  04048000
CVTRSV50 EQU   CVTA1F1                                                  04049000
CVTRSV49 EQU   CVTA1F1                                                  04050000
CVTRSV48 EQU   CVTA1F1                                                  04051000
CVTRSV47 EQU   CVTA1F1                                                  04052000
CVTSRSW  EQU   CVTA1F1                                                  04053000
CVTPFSW  EQU   CVTA1F1                                                  04054000
CVTPCVT  EQU   CVTMAP+352                                               04055000
CVTRSV46 EQU   CVTMAP+344                                               04056000
CVTRSV45 EQU   CVTMAP+340                                               04057000
CVTRSV44 EQU   CVTMAP+338                                               04058000
CVTRSV43 EQU   CVTMAP+336                                               04059000
CVTHJESA EQU   CVTHJES+1                                                04060000
CVTRSV42 EQU   CVTHJES                                                  04061000
CVTEXT2A EQU   CVTEXT2+1                                                04062000
CVTRSV41 EQU   CVTEXT2                                                  04063000
CVTAPFA  EQU   CVTAPF+1                                                 04064000
CVTRSV40 EQU   CVTAPF                                                   04065000
CVTRV518 EQU   CVTINTLA                                                 04066000
CVTRV517 EQU   CVTERPV                                                  04067000
CVTEORM  EQU   CVTMAP+312                                               04068000
CVTMCHPR EQU   CVTMAP+308                                               04069000
CVTTZ    EQU   CVTMAP+304                                               04070000
CVTJEPS  EQU   CVTMAP+300                                               04071000
CVTJESCT EQU   CVTMAP+296                                               04072000
CVTMODE  EQU   CVTMAP+292                                               04073000
CVTPTRV  EQU   CVTMAP+288                                               04074000
CVTREAL  EQU   CVTMAP+284                                               04075000
CVTRSV39 EQU   CVTMAP+280                                               04076000
CVTRSV38 EQU   CVTMAP+276                                               04077000
CVTDMSRA EQU   CVTDMSR+1                                                04078000
CVTRV634 EQU   CVTDMSRF                                                 04079000
CVTRV633 EQU   CVTDMSRF                                                 04080000
CVTRV632 EQU   CVTDMSRF                                                 04081000
CVTRV631 EQU   CVTDMSRF                                                 04082000
CVTRV630 EQU   CVTDMSRF                                                 04083000
CVTRV629 EQU   CVTDMSRF                                                 04084000
CVTUDUMP EQU   CVTDMSRF                                                 04085000
CVTSDUMP EQU   CVTDMSRF                                                 04086000
CVTQMSGA EQU   CVTQMSG+1                                                04087000
CVTRSV36 EQU   CVTQMSG                                                  04088000
CVTAMFF  EQU   CVTMAP+264                                               04089000
CVTPURGA EQU   CVTPURG+1                                                04090000
CVTRSV35 EQU   CVTPURG                                                  04091000
CVTCBSP  EQU   CVTMAP+256                                               04092000
CVTATERA EQU   CVTATER+1                                                04093000
CVTSYST  EQU   CVTATER                                                  04094000
CVTVOLT2 EQU   CVTTAT                                                   04095000
CVTVOLI2 EQU   CVTVOLF2                                                 04096000
CVTAQAVB EQU   CVTAQAVT+1                                               04097000
CVTRSV34 EQU   CVTTCMFG                                                 04098000
CVTRSV33 EQU   CVTTCMFG                                                 04099000
CVTRSV32 EQU   CVTTCMFG                                                 04100000
CVTRSV31 EQU   CVTTCMFG                                                 04101000
CVTRSV30 EQU   CVTTCMFG                                                 04102000
CVTRSV29 EQU   CVTTCMFG                                                 04103000
CVTRSV28 EQU   CVTTCMFG                                                 04104000
CVTTCRDY EQU   CVTTCMFG                                                 04105000
CVTGTFA  EQU   CVTGTF+1                                                 04106000
CVTRSV27 EQU   CVTGTFST                                                 04107000
CVTRNIO  EQU   CVTGTFST                                                 04108000
CVTUSR   EQU   CVTGTFST                                                 04109000
CVTRV318 EQU   CVTFORM                                                  04110000
CVTRV317 EQU   CVTTMODE                                                 04111000
CVTRV316 EQU   CVTSTATE                                                 04112000
CVTRV315 EQU   CVTGTFS                                                  04113000
CVTGTFAV EQU   CVTGTFS                                                  04114000
CVT0SCR1 EQU   CVTMAP+232                                               04115000
CVTRV515 EQU   CVTMAP+228                                               04116000
CVTRMS   EQU   CVTMAP+224                                               04117000
CVTPATCH EQU   CVTMAP+220                                               04118000
CVTTSCE  EQU   CVTMAP+216                                               04119000
CVTLNKSC EQU   CVTMAP+214                                               04120000
CVTQABST EQU   CVTMAP+212                                               04121000
CVTMDLDS EQU   CVTMAP+208                                               04122000
CVTUSER  EQU   CVTMAP+204                                               04123000
CVTSMCA  EQU   CVTMAP+196                                               04124000
CVTRSV18 EQU   CVTMAP+192                                               04125000
CVTQLPAQ EQU   CVTMAP+188                                               04126000
CVTQCDSR EQU   CVTMAP+184                                               04127000
CVTRSV17 EQU   CVTOPTB                                                  04128000
CVTRSV16 EQU   CVTOPTB                                                  04129000
CVTFP    EQU   CVTOPTB                                                  04130000
CVTAPTHR EQU   CVTOPTB                                                  04131000
CVTNLOG  EQU   CVTOPTB                                                  04132000
CVTTOD   EQU   CVTOPTB                                                  04133000
CVTCTIMS EQU   CVTOPTB                                                  04134000
CVTPROT  EQU   CVTOPTB                                                  04135000
CVTXPFP  EQU   CVTOPTA                                                  04136000
CVTASCII EQU   CVTOPTA                                                  04137000
CVTRSV13 EQU   CVTOPTA                                                  04138000
CVTRSV12 EQU   CVTOPTA                                                  04139000
CVTNIP   EQU   CVTOPTA                                                  04140000
CVTDDR   EQU   CVTOPTA                                                  04141000
CVTAPR   EQU   CVTOPTA                                                  04142000
CVTCCH   EQU   CVTOPTA                                                  04143000
CVTSNCTR EQU   CVTMAP+180                                               04144000
CVTQMWR  EQU   CVTMAP+176                                               04145000
CVTQOCR  EQU   CVTMAP+172                                               04146000
CVT1EF00 EQU   CVTMAP+168                                               04147000
CVTMZ00  EQU   CVTMAP+164                                               04148000
CVTHEAD  EQU   CVTMAP+160                                               04149000
CVTRSV11 EQU   CVTMAP+156                                               04150000
CVT0PT01 EQU   CVTMAP+152                                               04151000
CVTMSER  EQU   CVTMAP+148                                               04152000
CVTRV516 EQU   CVTIERLC                                                 04153000
CVTILCH  EQU   CVTMAP+140                                               04154000
CVT0DS   EQU   CVTMAP+136                                               04155000
CVTFBOSV EQU   CVTMAP+132                                               04156000
CVTNUCB  EQU   CVTMAP+128                                               04157000
CVTIXAVL EQU   CVTMAP+124                                               04158000
CVTIOQET EQU   CVTMAP+120                                               04159000
CVTDCBA  EQU   CVTMAP+117                                               04160000
CVTMVS2  EQU   CVTDCB                                                   04161000
CVT6DAT  EQU   CVTDCB                                                   04162000
CVT4MPS  EQU   CVTDCB                                                   04163000
CVTRSV09 EQU   CVTDCB                                                   04164000
CVT4MS1  EQU   CVTDCB                                                   04165000
CVT2SPS  EQU   CVTDCB                                                   04166000
CVT1SSS  EQU   CVTDCB                                                   04167000
CVTRSV08 EQU   CVTDCB                                                   04168000
CVTSTB   EQU   CVTMAP+112                                               04169000
CVTQTD00 EQU   CVTMAP+108                                               04170000
CVTQTE00 EQU   CVTMAP+104                                               04171000
CVTCUCB  EQU   CVTMAP+100                                               04172000
CVTSJQ   EQU   CVTMAP+96                                                04173000
CVTPBLDL EQU   CVTMAP+92                                                04174000
CVTTPC   EQU   CVTMAP+88                                                04175000
CVTSVDCB EQU   CVTMAP+84                                                04176000
CVTBRET  EQU   CVTMAP+82                                                04177000
CVTEXIT  EQU   CVTMAP+80                                                04178000
CVT0FN00 EQU   CVTMAP+76                                                04179000
CVTDARA  EQU   CVTDAR+1                                                 04180000
CVTRSV07 EQU   CVTFLGS1                                                 04181000
CVTRSV06 EQU   CVTFLGS1                                                 04182000
CVTRSV05 EQU   CVTFLGS1                                                 04183000
CVTRSV04 EQU   CVTFLGS1                                                 04184000
CVTRSV03 EQU   CVTFLGS1                                                 04185000
CVTRSV02 EQU   CVTFLGS1                                                 04186000
CVTRSV01 EQU   CVTFLGS1                                                 04187000
CVTDMPLK EQU   CVTFLGS1                                                 04188000
CVTXITP  EQU   CVTMAP+68                                                04189000
CVTZDTAB EQU   CVTMAP+64                                                04190000
CVTMSLT  EQU   CVTMAP+60                                                04191000
CVTDATE  EQU   CVTMAP+56                                                04192000
CVTBTERM EQU   CVTMAP+52                                                04193000
CVTSYSAD EQU   CVTMAP+48                                                04194000
CVTXTLER EQU   CVTMAP+44                                                04195000
CVTILK2  EQU   CVTMAP+40                                                04196000
CVTILK1  EQU   CVTMAP+36                                                04197000
CVTPRLTV EQU   CVTMAP+32                                                04198000
CVTPCNVT EQU   CVTMAP+28                                                04199000
CVT0VL00 EQU   CVTMAP+24                                                04200000
CVTXAPG  EQU   CVTMAP+20                                                04201000
CVTBUF   EQU   CVTMAP+16                                                04202000
CVTJOB   EQU   CVTMAP+12                                                04203000
CVTLINK  EQU   CVTMAP+8                                                 04204000
CVT0EF00 EQU   CVTMAP+4                                                 04205000
CVTTCBP  EQU   CVTMAP                                                   04206000
CVT      EQU   CVTMAP                                                   04207000
ASCBEND  EQU   ASCB+208                                                 04208000
ASCBSRBT EQU   ASCB+200                                                 04209000
ASCBSWTL EQU   ASCB+196                                                 04210000
ASCBRS14 EQU   ASCB+195                                                 04211000
ASCBSMCT EQU   ASCB+194                                                 04212000
ASCBRS12 EQU   ASCB+192                                                 04213000
ASCBPCTT EQU   ASCB+188                                                 04214000
ASCBVGTT EQU   ASCB+184                                                 04215000
ASCBRV43 EQU   ASCBSRQ4                                                 04216000
ASCBRV42 EQU   ASCBSRQ4                                                 04217000
ASCBRV41 EQU   ASCBSRQ4                                                 04218000
ASCBRV40 EQU   ASCBSRQ4                                                 04219000
ASCBRV39 EQU   ASCBSRQ4                                                 04220000
ASCBRV38 EQU   ASCBSRQ4                                                 04221000
ASCBRV37 EQU   ASCBSRQ4                                                 04222000
ASCBRV36 EQU   ASCBSRQ4                                                 04223000
ASCBRV35 EQU   ASCBSRQ3                                                 04224000
ASCBRV34 EQU   ASCBSRQ3                                                 04225000
ASCBRV33 EQU   ASCBSRQ3                                                 04226000
ASCBRV32 EQU   ASCBSRQ3                                                 04227000
ASCBRV31 EQU   ASCBSRQ3                                                 04228000
ASCBRV30 EQU   ASCBSRQ3                                                 04229000
ASCBRV29 EQU   ASCBSRQ3                                                 04230000
ASCBRV28 EQU   ASCBSRQ3                                                 04231000
ASCBRV27 EQU   ASCBSRQ2                                                 04232000
ASCBRV26 EQU   ASCBSRQ2                                                 04233000
ASCBRV25 EQU   ASCBSRQ2                                                 04234000
ASCBRV24 EQU   ASCBSRQ2                                                 04235000
ASCBRV23 EQU   ASCBSRQ2                                                 04236000
ASCBRV22 EQU   ASCBSRQ2                                                 04237000
ASCBRV21 EQU   ASCBSRQ2                                                 04238000
ASCBRV20 EQU   ASCBSRQ2                                                 04239000
ASCBRV19 EQU   ASCBSRQ1                                                 04240000
ASCBRV18 EQU   ASCBSRQ1                                                 04241000
ASCBRV17 EQU   ASCBSRQ1                                                 04242000
ASCBRV16 EQU   ASCBSRQ1                                                 04243000
ASCBRV15 EQU   ASCBSRQ1                                                 04244000
ASCBRV14 EQU   ASCBSRQ1                                                 04245000
ASCBRV13 EQU   ASCBSRQ1                                                 04246000
ASCBSTA  EQU   ASCBSRQ1                                                 04247000
ASCBJBNS EQU   ASCB+176                                                 04248000
ASCBJBNI EQU   ASCB+172                                                 04249000
ASCBMCC  EQU   ASCB+168                                                 04250000
ASCBRTWA EQU   ASCB+164                                                 04251000
ASCBIQEA EQU   ASCB+160                                                 04252000
ASCBXMPQ EQU   ASCB+156                                                 04253000
ASCBRS01 EQU   ASCB+154                                                 04254000
ASCBFMCT EQU   ASCB+152                                                 04255000
ASCBOUXB EQU   ASCB+148                                                 04256000
ASCBOUCB EQU   ASCB+144                                                 04257000
ASCBMECB EQU   ASCB+140                                                 04258000
ASCBQECB EQU   ASCB+136                                                 04259000
ASCBLSQH EQU   ASCBLKGP+4                                               04260000
ASCBLOCK EQU   ASCBLKGP                                                 04261000
ASCBTCBS EQU   ASCB+124                                                 04262000
ASCBNVSC EQU   ASCB+122                                                 04263000
ASCBVSC  EQU   ASCB+120                                                 04264000
ASCBSRBS EQU   ASCB+118                                                 04265000
ASCBSSRB EQU   ASCB+116                                                 04266000
ASCBRV06 EQU   ASCBFLG2                                                 04267000
ASCBRV05 EQU   ASCBFLG2                                                 04268000
ASCBRV04 EQU   ASCBFLG2                                                 04269000
ASCBSNQS EQU   ASCBFLG2                                                 04270000
ASCBS2S  EQU   ASCBFLG2                                                 04271000
ASCBCEXT EQU   ASCBFLG2                                                 04272000
ASCBPXMT EQU   ASCBFLG2                                                 04273000
ASCBXMPT EQU   ASCBFLG2                                                 04274000
ASCBRF07 EQU   ASCBDSP1                                                 04275000
ASCBRF06 EQU   ASCBDSP1                                                 04276000
ASCBRF05 EQU   ASCBDSP1                                                 04277000
ASCBRF04 EQU   ASCBDSP1                                                 04278000
ASCBRF03 EQU   ASCBDSP1                                                 04279000
ASCBRF02 EQU   ASCBDSP1                                                 04280000
ASCBFAIL EQU   ASCBDSP1                                                 04281000
ASCBNOQ  EQU   ASCBDSP1                                                 04282000
ASCBSWCT EQU   ASCB+112                                                 04283000
ASCBASXB EQU   ASCB+108                                                 04284000
ASCBTMCH EQU   ASCB+104                                                 04285000
ASCBNSWP EQU   ASCBFLG1                                                 04286000
ASCBTYP1 EQU   ASCBFLG1                                                 04287000
ASCBSTND EQU   ASCBFLG1                                                 04288000
ASCBABNT EQU   ASCBFLG1                                                 04289000
ASCBTERM EQU   ASCBFLG1                                                 04290000
ASCBS3S  EQU   ASCBFLG1                                                 04291000
ASCBCMSH EQU   ASCBFLG1                                                 04292000
ASCBTOFF EQU   ASCBFLG1                                                 04293000
ASCBRF01 EQU   ASCBRCTF                                                 04294000
ASCBTMLW EQU   ASCBRCTF                                                 04295000
ASCBOUT  EQU   ASCBRCTF                                                 04296000
ASCBWAIT EQU   ASCBRCTF                                                 04297000
ASCBRV08 EQU   ASCBRCTF                                                 04298000
ASCBFQU  EQU   ASCBRCTF                                                 04299000
ASCBFRS  EQU   ASCBRCTF                                                 04300000
ASCBTMNO EQU   ASCBRCTF                                                 04301000
ASCBAFFN EQU   ASCBFW1                                                  04302000
ASCBDUMP EQU   ASCB+96                                                  04303000
ASCBQSVC EQU   ASCB+92                                                  04304000
ASCBUBET EQU   ASCB+88                                                  04305000
ASCBECB  EQU   ASCB+84                                                  04306000
ASCBJSTL EQU   ASCB+80                                                  04307000
ASCBEWST EQU   ASCB+72                                                  04308000
ASCBEJST EQU   ASCB+64                                                  04309000
ASCBCSCB EQU   ASCB+56                                                  04310000
ASCBRSM  EQU   ASCB+52                                                  04311000
ASCBLDA  EQU   ASCB+48                                                  04312000
ASCBSTOR EQU   ASCB+44                                                  04313000
ASCBDP   EQU   ASCB+43                                                  04314000
ASCBRV07 EQU   ASCB+42                                                  04315000
ASCBIOSM EQU   ASCB+40                                                  04316000
ASCBSEQN EQU   ASCB+38                                                  04317000
ASCBASID EQU   ASCB+36                                                  04318000
ASCBCPUS EQU   ASCB+32                                                  04319000
ASCBSPL  EQU   ASCB+28                                                  04320000
ASCBIOSP EQU   ASCB+24                                                  04321000
ASCBSYNC EQU   ASCBSUPC+4                                               04322000
ASCBSVRB EQU   ASCBSUPC                                                 04323000
ASCBCMSF EQU   ASCB+12                                                  04324000
ASCBBWDP EQU   ASCB+8                                                   04325000
ASCBFWDP EQU   ASCB+4                                                   04326000
ASCBASCB EQU   ASCB                                                     04327000
ASCBEGIN EQU   ASCB                                                     04328000
QDATA    EQU   QELE+20                                                  04329000
@NM00006 EQU   QFLAGS                                                   04330000
OQDATA   EQU   OQELE+20                                                 04331000
OQTRMTYP EQU   OQFLAGS+3                                                04332000
@NM00005 EQU   OQFLAGS+2                                                04333000
@NM00004 EQU   OQFLAGS+1                                                04334000
OQEDIT   EQU   OQFLAGS+1                                                04335000
OQBRK    EQU   OQFLAGS+1                                                04336000
OQHOLD   EQU   OQFLAGS+1                                                04337000
@NM00003 EQU   OQFLAGS                                                  04338000
OQALLOC  EQU   OQFLAGS                                                  04339000
IQDATA   EQU   IQELE+20                                                 04340000
IQTRMTYP EQU   IQFLAGS+3                                                04341000
@NM00002 EQU   IQFLAGS+1                                                04342000
IQPRTL   EQU   IQFLAGS+1                                                04343000
@NM00001 EQU   IQFLAGS                                                  04344000
@NM00037 EQU   PSA+3668                                                 04345000
PSASTAK  EQU   PSA+3072                                                 04346000
@NM00036 EQU   PSA+1048                                                 04347000
PSAUSEND EQU   PSA+1048                                                 04348000
PSARV062 EQU   PSA+1044                                                 04349000
PSACDAL  EQU   PSA+1040                                                 04350000
PSAWTCOD EQU   PSA+1036                                                 04351000
PSAATCVT EQU   PSA+1032                                                 04352000
PSAPCPSW EQU   PSA+1024                                                 04353000
PSAPIR2  EQU   PSA+1020                                                 04354000
PSARV059 EQU   PSA+1018                                                 04355000
PSASVC13 EQU   PSA+1016                                                 04356000
PSASFACC EQU   PSA+1008                                                 04357000
PSASTOP  EQU   PSA+992                                                  04358000
PSASTART EQU   PSA+976                                                  04359000
PSARSPSW EQU   PSA+968                                                  04360000
PSASRPSW EQU   PSA+960                                                  04361000
PSARV045 EQU   PSA+892                                                  04362000
PSARV044 EQU   PSA+888                                                  04363000
PSARV043 EQU   PSA+884                                                  04364000
PSARV042 EQU   PSA+880                                                  04365000
PSARV041 EQU   PSA+876                                                  04366000
PSARV040 EQU   PSA+872                                                  04367000
PSARV025 EQU   PSA+868                                                  04368000
PSADSSED EQU   PSA+868                                                  04369000
PSADSSPR EQU   PSA+864                                                  04370000
PSADSSFW EQU   PSA+860                                                  04371000
PSADSS14 EQU   PSA+856                                                  04372000
PSADSSPP EQU   PSA+848                                                  04373000
PSADSSRP EQU   PSA+840                                                  04374000
PSADSS05 EQU   PSADSSF4                                                 04375000
PSADSS10 EQU   PSADSSF4                                                 04376000
PSADSSVE EQU   PSADSSF4                                                 04377000
PSADSSDE EQU   PSADSSF4                                                 04378000
PSADSSC0 EQU   PSADSSF4                                                 04379000
PSADSSIE EQU   PSADSSF4                                                 04380000
PSADSS12 EQU   PSADSSF4                                                 04381000
PSADSSRC EQU   PSADSSF4                                                 04382000
PSARV057 EQU   PSADSSF3                                                 04383000
PSARV056 EQU   PSADSSF3                                                 04384000
PSARV055 EQU   PSADSSF3                                                 04385000
PSADSSMC EQU   PSADSSF3                                                 04386000
PSADSSRW EQU   PSADSSF3                                                 04387000
PSADSSNM EQU   PSADSSF3                                                 04388000
PSADSSES EQU   PSADSSF3                                                 04389000
PSADSSGP EQU   PSADSSF3                                                 04390000
PSADSSF2 EQU   PSADSSFL+1                                               04391000
PSADSSPI EQU   PSADSSF1                                                 04392000
PSADSSOI EQU   PSADSSF1                                                 04393000
PSADSSSP EQU   PSADSSF1                                                 04394000
PSADSSTP EQU   PSADSSF1                                                 04395000
PSADSSDW EQU   PSADSSF1                                                 04396000
PSADSSDD EQU   PSADSSF1                                                 04397000
PSADSSDM EQU   PSADSSF1                                                 04398000
PSADSSMV EQU   PSADSSF1                                                 04399000
PSADSSTS EQU   PSA+816                                                  04400000
PSADSSWK EQU   PSA+812                                                  04401000
PSADSSR3 EQU   PSA+808                                                  04402000
PSADSSR2 EQU   PSA+804                                                  04403000
PSADSSRS EQU   PSA+800                                                  04404000
PSASTOR  EQU   PSA+796                                                  04405000
PSACPUSA EQU   PSA+794                                                  04406000
PSAVSTAP EQU   PSA+792                                                  04407000
PSAWKVAP EQU   PSA+788                                                  04408000
PSAWKRAP EQU   PSA+784                                                  04409000
PSAMCHIC EQU   PSA+783                                                  04410000
PSARV061 EQU   PSA+782                                                  04411000
PSASYMSK EQU   PSA+781                                                  04412000
PSAMCHFL EQU   PSA+780                                                  04413000
PSACR0   EQU   PSA+776                                                  04414000
PSAPSWSV EQU   PSA+768                                                  04415000
PSALITA  EQU   PSA+764                                                  04416000
PSACLHS  EQU   PSAHLHI                                                  04417000
PSALKR15 EQU   PSALKSA+60                                               04418000
PSALKR14 EQU   PSALKSA+56                                               04419000
PSALKR13 EQU   PSALKSA+52                                               04420000
PSALKR12 EQU   PSALKSA+48                                               04421000
PSALKR11 EQU   PSALKSA+44                                               04422000
PSALKR10 EQU   PSALKSA+40                                               04423000
PSALKR9  EQU   PSALKSA+36                                               04424000
PSALKR8  EQU   PSALKSA+32                                               04425000
PSALKR7  EQU   PSALKSA+28                                               04426000
PSALKR6  EQU   PSALKSA+24                                               04427000
PSALKR5  EQU   PSALKSA+20                                               04428000
PSALKR4  EQU   PSALKSA+16                                               04429000
PSALKR3  EQU   PSALKSA+12                                               04430000
PSALKR2  EQU   PSALKSA+8                                                04431000
PSALKR1  EQU   PSALKSA+4                                                04432000
PSALKR0  EQU   PSALKSA                                                  04433000
PSARV023 EQU   PSACLHT+52                                               04434000
PSALOCAL EQU   PSACLHT+48                                               04435000
PSACMSL  EQU   PSACLHT+44                                               04436000
PSAOPTL  EQU   PSACLHT+40                                               04437000
PSATPACL EQU   PSACLHT+36                                               04438000
PSATPDNL EQU   PSACLHT+32                                               04439000
PSATPNCL EQU   PSACLHT+28                                               04440000
PSAIOSLL EQU   PSACLHT+24                                               04441000
PSAIOSUL EQU   PSACLHT+20                                               04442000
PSAIOSCL EQU   PSACLHT+16                                               04443000
PSAIOSSL EQU   PSACLHT+12                                               04444000
PSASALCL EQU   PSACLHT+8                                                04445000
PSAASML  EQU   PSACLHT+4                                                04446000
PSADISPL EQU   PSACLHT                                                  04447000
PSASRSA  EQU   PSA+636                                                  04448000
PSARV050 EQU   PSA+634                                                  04449000
PSADSSGO EQU   PSA+633                                                  04450000
PSARECUR EQU   PSA+632                                                  04451000
PSAHLHIS EQU   PSA+628                                                  04452000
PSAIPCSA EQU   PSA+624                                                  04453000
@NM00035 EQU   PSA+621                                                  04454000
PSAIPCDM EQU   PSA+620                                                  04455000
PSAIPCD  EQU   PSA+616                                                  04456000
@NM00034 EQU   PSA+613                                                  04457000
PSAIPCRM EQU   PSA+612                                                  04458000
PSAIPCR  EQU   PSA+608                                                  04459000
PSAMCHEX EQU   PSA+600                                                  04460000
PSAMPSW  EQU   PSA+592                                                  04461000
PSAEXPS2 EQU   PSA+584                                                  04462000
PSAEXPS1 EQU   PSA+576                                                  04463000
PSAPIREG EQU   PSA+572                                                  04464000
PSARSREG EQU   PSA+568                                                  04465000
PSAGPREG EQU   PSA+556                                                  04466000
PSARV022 EQU   PSASUP4                                                  04467000
PSARV021 EQU   PSASUP4                                                  04468000
PSARV020 EQU   PSASUP4                                                  04469000
PSARV019 EQU   PSASUP4                                                  04470000
PSARV018 EQU   PSASUP4                                                  04471000
PSARV017 EQU   PSASUP4                                                  04472000
PSARV016 EQU   PSASUP4                                                  04473000
PSARV015 EQU   PSASUP4                                                  04474000
PSARV014 EQU   PSASUP3                                                  04475000
PSARV013 EQU   PSASUP3                                                  04476000
PSARV012 EQU   PSASUP3                                                  04477000
PSARV011 EQU   PSASUP3                                                  04478000
PSASPR   EQU   PSASUP3                                                  04479000
PSAPSREG EQU   PSASUP3                                                  04480000
PSAPI2   EQU   PSASUP3                                                  04481000
PSAIOSUP EQU   PSASUP3                                                  04482000
PSALCR   EQU   PSASUP2                                                  04483000
PSARTM   EQU   PSASUP2                                                  04484000
PSAACR   EQU   PSASUP2                                                  04485000
PSAIPCE2 EQU   PSASUP2                                                  04486000
PSAIPCES EQU   PSASUP2                                                  04487000
PSAIPCEC EQU   PSASUP2                                                  04488000
PSAGTF   EQU   PSASUP2                                                  04489000
PSAIPCRI EQU   PSASUP2                                                  04490000
PSARV063 EQU   PSASUP1                                                  04491000
PSATCTL  EQU   PSASUP1                                                  04492000
PSADISP  EQU   PSASUP1                                                  04493000
PSALOCK  EQU   PSASUP1                                                  04494000
PSAPI    EQU   PSASUP1                                                  04495000
PSAEXT   EQU   PSASUP1                                                  04496000
PSASVC   EQU   PSASUP1                                                  04497000
PSAIO    EQU   PSASUP1                                                  04498000
PSAANEW  EQU   PSA+544                                                  04499000
PSATOLD  EQU   PSA+540                                                  04500000
PSATNEW  EQU   PSA+536                                                  04501000
PSALCCAR EQU   PSA+532                                                  04502000
PSALCCAV EQU   PSA+528                                                  04503000
PSAPCCAR EQU   PSA+524                                                  04504000
PSAPCCAV EQU   PSA+520                                                  04505000
PSACPULA EQU   PSA+518                                                  04506000
PSACPUPA EQU   PSA+516                                                  04507000
PSAPSA   EQU   PSA+512                                                  04508000
FLCHDEND EQU   PSA+512                                                  04509000
FLCCRSAV EQU   FLCMCLA+280                                              04510000
FLCGRSAV EQU   FLCMCLA+216                                              04511000
FLCFPSAV EQU   FLCMCLA+184                                              04512000
FLCFLA   EQU   FLCMCLA+88                                               04513000
FLCRGNCD EQU   FLCMCLA+84                                               04514000
FLCFSAA  EQU   FLCFSA+1                                                 04515000
@NM00033 EQU   FLCFSA                                                   04516000
@NM00032 EQU   FLCMCLA+72                                               04517000
FLCMCIC  EQU   FLCMCLA+64                                               04518000
@NM00031 EQU   FLCMCLA+20                                               04519000
FLCIOAA  EQU   FLCIOA+1                                                 04520000
@NM00030 EQU   FLCIOA                                                   04521000
@NM00029 EQU   FLCMCLA+15                                               04522000
@NM00028 EQU   FLCMCLA+14                                               04523000
@NM00027 EQU   FLCMCLA+12                                               04524000
FLCLCL   EQU   FLCMCLA+8                                                04525000
FLCIOELA EQU   FLCIOEL+1                                                04526000
@NM00026 EQU   FLCIOEL                                                  04527000
FLCCHNID EQU   FLCMCLA                                                  04528000
@NM00025 EQU   PSA+160                                                  04529000
FLCMTRCD EQU   PSA+157                                                  04530000
@NM00024 EQU   PSA+156                                                  04531000
FLCPERA  EQU   FLCPER+1                                                 04532000
@NM00023 EQU   FLCPER                                                   04533000
@NM00022 EQU   PSA+151                                                  04534000
FLCPERCD EQU   PSA+150                                                  04535000
FLCMCNUM EQU   PSA+149                                                  04536000
@NM00021 EQU   PSA+148                                                  04537000
FLCTEAA  EQU   FLCTEA+1                                                 04538000
@NM00020 EQU   FLCTEA                                                   04539000
PSAPIPC  EQU   PSAPICOD                                                 04540000
PSAPIMC  EQU   PSAPICOD                                                 04541000
PSAPIPER EQU   PSAPICOD                                                 04542000
PSARV049 EQU   FLCPICOD                                                 04543000
FLCPILCB EQU   FLCPIILC                                                 04544000
@NM00019 EQU   FLCPIILC                                                 04545000
@NM00018 EQU   PSAEPPSW                                                 04546000
FLCSVCN  EQU   PSAESPSW+2                                               04547000
FLCSILCB EQU   FLCSVILC                                                 04548000
@NM00017 EQU   FLCSVILC                                                 04549000
@NM00016 EQU   PSAESPSW                                                 04550000
FLCEICOD EQU   PSAEEPSW+2                                               04551000
PSASPAD  EQU   PSAEEPSW                                                 04552000
@NM00015 EQU   PSA+128                                                  04553000
FLCINPSW EQU   PSA+120                                                  04554000
FLCMNPSW EQU   PSA+112                                                  04555000
FLCPNPSW EQU   PSA+104                                                  04556000
FLCSNPSW EQU   PSA+96                                                   04557000
FLCENPSW EQU   PSA+88                                                   04558000
FLCTRACE EQU   PSA+84                                                   04559000
FLCTIMER EQU   PSA+80                                                   04560000
FLCCVT2  EQU   PSA+76                                                   04561000
FLCCAW   EQU   PSA+72                                                   04562000
FLCCSW   EQU   PSA+64                                                   04563000
FLCIOPSW EQU   PSA+56                                                   04564000
FLCMOPSW EQU   PSA+48                                                   04565000
FLCPOPSW EQU   PSA+40                                                   04566000
FLCSOPSW EQU   PSA+32                                                   04567000
FLCEOPSW EQU   PSA+24                                                   04568000
@NM00014 EQU   FLCICCW2+4                                               04569000
FLCICCW1 EQU   FLCROPSW                                                 04570000
FLCIPPSW EQU   FLCRNPSW                                                 04571000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04572000
@RC00078 EQU   CE0001@                                                  04573000
@RC00096 EQU   CE0001@                                                  04574000
@RC00103 EQU   CE0001@                                                  04575000
@RF00129 EQU   CE0001@                                                  04576000
@RC00145 EQU   @RC00144                                                 04577000
@RC00180 EQU   CE0001@                                                  04578000
@RF00206 EQU   CE0001@                                                  04579000
@RC00244 EQU   CE0002@                                                  04580000
@RC00263 EQU   CE0002@                                                  04581000
@RC00270 EQU   CE0002@                                                  04582000
@RC00298 EQU   CE0002@                                                  04583000
@RC00308 EQU   CE0002@                                                  04584000
@RF00341 EQU   CE0002@                                                  04585000
@RC00349 EQU   CE0002@                                                  04586000
@RC00362 EQU   CE0002@                                                  04587000
@RC00384 EQU   CE0002@                                                  04588000
@RC00396 EQU   CE0002@                                                  04589000
@RC00535 EQU   @RC00534                                                 04590000
@RC00578 EQU   @EL00002                                                 04591000
@RF00624 EQU   @RC00616                                                 04592000
@RF00669 EQU   @EL00003                                                 04593000
@RF00707 EQU   @EL00004                                                 04594000
@RC00579 EQU   @RC00578                                                 04595000
@RC00589 EQU   @RC00578                                                 04596000
@RF00588 EQU   @RC00578                                                 04597000
@ENDDATA EQU   *                                                        04598000
         END   IKTQMIN,(C'PLS1924',0701,77319)                          04599000
