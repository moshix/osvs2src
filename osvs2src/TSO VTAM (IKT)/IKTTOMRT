         TITLE '***IKTTOMRT:  ROCKET TERMINAL OUTPUT MANAGER***        *00001000
                        '                                               00002000
IKTTOMRT CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IKTTOMRT  78.045'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @08,0                                               0001 00010000
@PSTART  LA    @09,4095(,@08)                                      0001 00011000
         LA    @10,4095(,@09)                                      0001 00012000
         USING @PSTART,@08                                         0001 00013000
         USING @PSTART+4095,@09                                    0001 00014000
         USING @PSTART+8190,@10                                    0001 00015000
*                                                                  0150 00016000
         LR    TOMWREG,RTOMW                                            00017000
         USING @DATD,TOMWREG                                            00018000
*           SAVE14 = BRNCHREG;           /* SAVE RETURN ADDRESS      */ 00019000
         ST    BRNCHREG,SAVE14(,TOMWREG)                           0151 00020000
*           RFY (RTOMW,BRNCHREG) UNRSTD;                           0152 00021000
*           TSBREG=ASCBTSB;              /* LOAD TSB ADDRESS @ZA24528*/ 00022000
         L     @01,PSAAOLD                                         0153 00023000
         L     TSBREG,ASCBTSB(,@01)                                0153 00024000
*           RFY TSB BASED(TSBREG);       /* REBASE THE TSB   @ZA24528*/ 00025000
*           TSBSAVE=TSBREG;              /* SAVE TSB ADDRESS @ZA24528*/ 00026000
         ST    TSBREG,TSBSAVE                                      0155 00027000
*           TVWAREG=TSBXTVWA;            /* LOAD TVWA ADDRESS@ZA24528*/ 00028000
         L     @01,TSBEXTNT(,TSBREG)                               0156 00029000
         L     TVWAREG,TSBXTVWA(,@01)                              0156 00030000
*           RFY TVWA BASED(TVWAREG);     /* REBASE THE TVWA  @ZA24528*/ 00031000
*           TVWASAVE=TVWAREG;            /* SAVE TVWA ADDRESS@ZA24528*/ 00032000
         ST    TVWAREG,TVWASAVE                                    0158 00033000
*           RPLREG=TOMWREG+320+LENGTH(WORKAREA); /* RPL ADDR @ZA24528*/ 00034000
         LA    RPLREG,960                                          0159 00035000
         ALR   RPLREG,TOMWREG                                      0159 00036000
*           RPLSAVE=RPLREG;              /* SAVE RPL ADDRESS @ZA24528*/ 00037000
         ST    RPLREG,RPLSAVE                                      0160 00038000
*           FRRPTR = ADDR(IKTIOFRR);     /* FRR ADDRESS      @ZM20856*/ 00039000
*                                                                  0161 00040000
         L     @01,CVTPTR                                          0161 00041000
         L     @01,CVTTCASP(,@01)                                  0161 00042000
         L     FRRPTR,TCASFRR(,@01)                                0161 00043000
*           /*********************************************************/ 00044000
*           /* SET UP FUNCTIONAL RECOVERY ROUTINE (IKTIOFRR).        */ 00045000
*           /*********************************************************/ 00046000
*                                                                  0162 00047000
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    0162 00048000
*                                                                  0162 00049000
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,FRRSELEN,FLC,   00050000
*                         FRRSFRRA,FRRSENTR,FRRSPARM,PSA,PSACSTK,  0163 00051000
*                         PSALSFCC,PSALITA)                        0163 00052000
*                   SETS(WRK2,WRK3,REGPARM,REG13,REG14);           0163 00053000
       SETFRR  A,FRRAD=(FRRPTR),PARMAD=(REGPARM),WRKREGS=(WRK2,WRK3)    00054000
A1     SETLOCK OBTAIN,                                                CC00055000
               TYPE=LOCAL,                                            CC00056000
               MODE=UNCOND,                                           CC00057000
               REGS=USE,                                              CC00058000
               RELATED=(A2,'OBTAIN LOCAL LOCK')                         00059000
*           FRRPARM=REGPARM;          /* SAVE ADDRESS OF           0164 00060000
*                                        FRR PARAMETER AREA  @ZM20856*/ 00061000
         ST    REGPARM,FRRPARM                                     0164 00062000
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) UNRSTD;  0165 00063000
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/  00064000
*CKMC0002:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856 00065000
**/            FRWACKPT(2)=ADDR(CKMC0002); /* SAVE ADDRESS    @ZM20856  00066000
*/           END;      /* CHECK POINT         @ZM20856*/           0167 00067000
CKMC0002 L     @15,TVWAFRWO(,TVWAREG)                              0167 00068000
         STM   REG0,REG15,FRWACKRG(@15)                            0167 00069000
         LA    @14,CKMC0002                                        0168 00070000
         ST    @14,FRWACKPT+4(,@15)                                0168 00071000
*           CALL INITFRR;             /* CALL FRR INIT       @ZM20856*/ 00072000
         BAL   @14,INITFRR                                         0170 00073000
*           TVWATIR = '1'B;           /* TOM IS RUNNING              */ 00074000
*                                                                  0171 00075000
         OI    TVWATIR(TVWAREG),B'00001000'                        0171 00076000
*           /*********************************************************/ 00077000
*           /* FOR THE FIRST INVOCATION OF TOM, BUILD THE RPL.       */ 00078000
*           /*********************************************************/ 00079000
*                                                                  0172 00080000
*           IF TIME1 = '0'B THEN      /* CHECK IF FIRST PASS         */ 00081000
         TM    TIME1(TOMWREG),B'00010000'                          0172 00082000
         BNZ   @RF00172                                            0172 00083000
*             DO;                     /* FIRST-PASS PROCESSING       */ 00084000
*               TIME1 = '1'B;         /* RESET PASS SWITCH           */ 00085000
         OI    TIME1(TOMWREG),B'00010000'                          0174 00086000
*               SWNL = '1'B;          /* START ON NEW LINE           */ 00087000
         OI    SWNL(TOMWREG),B'01000000'                           0175 00088000
*               IFGRPL=DUMMYRPL;      /* INITIALIZE RPL              */ 00089000
         MVC   IFGRPL(112,RPLREG),DUMMYRPL                         0176 00090000
*               RPLDACB=TVWAACB;      /* ACB ADDRESS                 */ 00091000
         L     @15,TVWAACB(,TVWAREG)                               0177 00092000
         ST    @15,RPLDACB(,RPLREG)                                0177 00093000
*               RPLARG=NIBCID;        /* CID                         */ 00094000
         L     @01,TVWANIB(,TVWAREG)                               0178 00095000
         L     @15,NIBCID(,@01)                                    0178 00096000
         ST    @15,RPLARG(,RPLREG)                                 0178 00097000
*               RPLAREA = ADDR(RU);   /* RU ADDRESS                  */ 00098000
         LA    @15,RU(,TOMWREG)                                    0179 00099000
         ST    @15,RPLAREA(,RPLREG)                                0179 00100000
*               TVWATOMW = TOMWREG;   /* WORK AREA ADDRESS           */ 00101000
         ST    TOMWREG,TVWATOMW(,TVWAREG)                          0180 00102000
*               STM(REG0,REG15,RETRYREG); /* SAVE REGISTERS USED   0181 00103000
*                                        IN RETRY            @ZM20856*/ 00104000
         STM   REG0,REG15,RETRYREG                                 0181 00105000
*             END;                    /* END FIRST-PASS PROCESSING   */ 00106000
*           ELSE;                     /* NOT FIRST PASS              */ 00107000
*                                                                  0183 00108000
@RF00172 DS    0H                                                  0184 00109000
*FRRENTRY:  CALL BLDCHAIN;            /* BUILD CHAINS                */ 00110000
*                                                                  0184 00111000
FRRENTRY BAL   @14,BLDCHAIN                                        0184 00112000
*           /*********************************************************/ 00113000
*           /* TURN OFF BOTH TOM-IS-SCHEDULED AND TOM-IS-RUNNING     */ 00114000
*           /* SWITCHES.                                    @YM03259 */ 00115000
*           /*********************************************************/ 00116000
*                                                                  0185 00117000
*           TVWATIS = '0'B;           /* RESET TOM-SCHEDULED SWITCH  */ 00118000
         NI    TVWATIS(TVWAREG),B'10111111'                        0185 00119000
*           TVWATIR = '0'B;           /* RESET TOM-RUNNING SWITCH    */ 00120000
*                                                                  0186 00121000
         NI    TVWATIR(TVWAREG),B'11110111'                        0186 00122000
*           /*********************************************************/ 00123000
*           /* RELEASE LOCAL LOCK AND FRR                            */ 00124000
*           /*********************************************************/ 00125000
*                                                                  0187 00126000
*           RFY (WRK2,WRK3,REG0,REG1,REG14,REG15) RSTD;            0187 00127000
*                                                                  0187 00128000
*           GENERATE REFS(PSACSTK,PSA,FRRSCURR,FRRS,FRRSEMP,FRRSELEN,   00129000
*                         PSALITA,FLC)                             0188 00130000
*                    SETS(WRK2,WRK3,REG13,REG14);                  0188 00131000
*                                                                  0188 00132000
A2     SETLOCK RELEASE,                                               CC00133000
               TYPE=LOCAL,                                            CC00134000
               REGS=USE,                                              CC00135000
               RELATED=(A1,'RELEASE LOCAL LOCK')                        00136000
       SETFRR  D,WRKREGS=(WRK2,WRK3)                                    00137000
*           RFY (WRK2,WRK3,REG0,REG1,REG14,REG15) UNRSTD;          0189 00138000
*                                                                  0189 00139000
*           RFY BRNCHREG RSTD;        /* RESTRICT RETURN REGISTER    */ 00140000
*           BRNCHREG = SAVE14;        /* RESTORE RETURN ADDRESS      */ 00141000
         L     BRNCHREG,SAVE14(,TOMWREG)                           0191 00142000
*           GEN (BR BRNCHREG)                                      0192 00143000
*               REFS(BRNCHREG);       /* RETURN TO CALLER            */ 00144000
         BR BRNCHREG                                                    00145000
*           RFY BRNCHREG UNRSTD;      /* UNRESTRICT RETURN REGISTER  */ 00146000
         EJECT                                                          00147000
*BLDCHAIN:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0194 00148000
*                                                                  0194 00149000
BLDCHAIN ST    @14,@SA00002                                        0194 00150000
*           /*********************************************************/ 00151000
*           /*                                                       */ 00152000
*           /* PROCEDURE - BLDCHAIN                                  */ 00153000
*           /*                                                       */ 00154000
*           /* FUNCTION - TO BUILD CHAINS                            */ 00155000
*           /*                                                       */ 00156000
*           /*********************************************************/ 00157000
*                                                                  0195 00158000
*                                                                  0195 00159000
*   /*****************************************************************/ 00160000
*   /*         STRUCTURE OF BUILD-CHAIN                              */ 00161000
*   /*****************************************************************/ 00162000
*   /*                                                               */ 00163000
*   /*         ***************************************************** */ 00164000
*   /*         * DO WHILE                                          * */ 00165000
*   /*         *                                                   * */ 00166000
*   /*         *               *********************************** * */ 00167000
*   /*         *               * BLDMSGS                         * * */ 00168000
*   /*         *               *                **************** * * */ 00169000
*   /*         *               *                * EDITMSG      * * * */ 00170000
*   /*         *               *                **************** * * */ 00171000
*   /*         *               *********************************** * */ 00172000
*   /*         *    **********************************             * */ 00173000
*   /*         *    * BLDMID                         *             * */ 00174000
*   /*         *    *          ********************* *             * */ 00175000
*   /*         *    *          * BLDEND            * *             * */ 00176000
*   /*         *    *          ********************* *             * */ 00177000
*   /*         *    **********************************             * */ 00178000
*   /*         *               *********************************** * */ 00179000
*   /*         *               * FIN                             * * */ 00180000
*   /*         *               *********************************** * */ 00181000
*   /*         *                                                   * */ 00182000
*   /*         * END DO WHILE                                      * */ 00183000
*   /*         ***************************************************** */ 00184000
*   /*                                                               */ 00185000
*   /*****************************************************************/ 00186000
*                                                                  0195 00187000
*   /*****************************************************************/ 00188000
*   /*         INITIALIZATION OF BIT VARIABLES:                      */ 00189000
*   /*         (A) MOR, HLD, FCNERR, PARMERR, RETRYMSG,              */ 00190000
*   /*             XIT, AND PSENT ARE TURNED OFF.                    */ 00191000
*   /*         (B) MSG, TSTPRMPT, AND AGAIN ARE TURNED ON.           */ 00192000
*   /*         NOTE:  A NEW-LINE CHARACTER IS PLACED AT THE END OF   */ 00193000
*   /*                EACH MESSAGE THAT IS NOT CONTROL, ASIS, OR     */ 00194000
*   /*                FULLSCR.  WHEN THE RU IS FULL AND A NEW-LINE   */ 00195000
*   /*                CHARACTER IS NEEDED, SWNL ('START WITH A       */ 00196000
*   /*                NEW-LINE CHARACTER') IS TURNED ON.             */ 00197000
*   /*****************************************************************/ 00198000
*                                                                  0195 00199000
*           BITVALU0 = '00000000'B;         /* INITIALIZE VARIABLES  */ 00200000
         MVI   BITVALU0(TOMWREG),B'00000000'                       0195 00201000
*           BITVALU1 = '00000111'B;         /* INITIALIZE VARIABLES  */ 00202000
*                                                                  0196 00203000
         MVI   BITVALU1(TOMWREG),B'00000111'                       0196 00204000
*           /*********************************************************/ 00205000
*           /* INITIALIZE PRINTABLE-CHARACTER COUNT TO 0.            */ 00206000
*           /* INITIALIZE CHAIN SIZE TO USER-DEFINED CHAIN LENGTH.   */ 00207000
*           /* INITIALIZE NUMBER OF RU'S IN A CHAIN.                 */ 00208000
*           /*********************************************************/ 00209000
*                                                                  0197 00210000
*           CHARCNT = 0;                    /* PRINTABLE-CHAR. COUNT */ 00211000
         SLR   @15,@15                                             0197 00212000
         ST    @15,CHARCNT(,TOMWREG)                               0197 00213000
*           CHAINSZE = TVWACHNL;            /* CHAIN SIZE            */ 00214000
         IC    @15,TVWACHNL(,TVWAREG)                              0198 00215000
         STC   @15,CHAINSZE(,TOMWREG)                              0198 00216000
*           RUCOUNT = CHAINSZE;             /* NO. OF RU'S IN CHAIN  */ 00217000
*                                                                  0199 00218000
         IC    @15,CHAINSZE(,TOMWREG)                              0199 00219000
         STC   @15,RUCOUNT(,TOMWREG)                               0199 00220000
*           DO WHILE (AGAIN = '1'B);                               0200 00221000
*                                                                  0200 00222000
         B     @DE00200                                            0200 00223000
@DL00200 DS    0H                                                  0201 00224000
*             /*******************************************************/ 00225000
*             /* INITIALIZATION OF BIT VARIABLES:                    */ 00226000
*             /* (A) BRK, XC, NXC, MORMSGS, ERMG, SKIP, AND BYPASS   */ 00227000
*             /*     ARE TURNED OFF.                                 */ 00228000
*             /* (B) REPEAT IS TURNED ON.                            */ 00229000
*             /*******************************************************/ 00230000
*                                                                  0201 00231000
*             BITVAL00 = '00000000'B;       /* INITIALIZE VARIABLES  */ 00232000
         MVI   BITVAL00(TOMWREG),B'00000000'                       0201 00233000
*             REPEAT = '1'B;                /* REPEAT                */ 00234000
         OI    REPEAT(TOMWREG),B'00000010'                         0202 00235000
*             BYTECNT = 1;                  /* BYTE-POSITION OF RU   */ 00236000
         MVC   BYTECNT(4,TOMWREG),@CF00064                         0203 00237000
*             NOTNOW = '0'B;                /* RESET SWITCH          */ 00238000
         NI    NOTNOW(TOMWREG),B'11111011'                         0204 00239000
*             /*******************************************************/ 00240000
*             /* IF LOST-TERM ENTERED OR TIM IS GONE,                */ 00241000
*             /* DO A CLEAN-EXIT.                                    */ 00242000
*             /*******************************************************/ 00243000
*             IF TVWALTE = '1'B |           /* LOSTERM ENTERED?      */ 00244000
*                TVWATID='1'B THEN          /* IKTTIMRT IS DEAD?     */ 00245000
         TM    TVWALTE(TVWAREG),B'00010010'                        0205 00246000
         BZ    @RF00205                                            0205 00247000
*               CALL FINPROC;               /* CALL CLEAN-UP ROUTINE */ 00248000
         BAL   @14,FINPROC                                         0206 00249000
*             ELSE                                                 0207 00250000
*               /*****************************************************/ 00251000
*               /* CHECK IF GLOBAL ERROR HAS OCCURRED, I.E.,         */ 00252000
*               /* ATTENTION, ATTENTION-IGNORED, OR TIM-ERROR        */ 00253000
*               /* MESSAGE.                                          */ 00254000
*               /*****************************************************/ 00255000
*               IF TVWAGERR = '1'B THEN     /* GLOBAL ERROR?         */ 00256000
         B     @RC00205                                            0207 00257000
@RF00205 TM    TVWAGERR(TVWAREG),B'00010000'                       0207 00258000
         BNO   @RF00207                                            0207 00259000
*                 DO;                       /* DO THE FOLLOWING      */ 00260000
*                   SWNL = '0'B;            /* RESET NEW-LINE SWITCH */ 00261000
         NI    SWNL(TOMWREG),B'10111111'                           0209 00262000
*                   ERMG = '1'B;            /* GLOBAL ERROR          */ 00263000
         OI    ERMG(TOMWREG),B'00001000'                           0210 00264000
*                   CALL CHKOCEOC;          /* CANCEL CHAIN  @ZA27108*/ 00265000
         BAL   @14,CHKOCEOC                                        0211 00266000
*                   SKIP = '1'B;            /* SKIP BLDMSGS          */ 00267000
         OI    SKIP(TOMWREG),B'00000010'                           0212 00268000
*                   TVWABKMG = '0'B;        /* NO PARTIAL MESSAGE    */ 00269000
         NI    TVWABKMG(TVWAREG),B'11111011'                       0213 00270000
*                   SIGSENT = '0'B;         /* RESET SIGNAL SWITCH   */ 00271000
*                   PROMPT = '0'B;          /* RESET PROMPT SWITCH   */ 00272000
         NI    SIGSENT(TOMWREG),B'01101111'                        0215 00273000
*                   /*************************************************/ 00274000
*                   /* IF ATTENTION OR ATTENTION-IGNORED,            */ 00275000
*                   /* CALL ATTENTION-HANDLING ROUTINE.              */ 00276000
*                   /* OTHERWISE, CALL TIM-ERROR-MESSAGE ROUTINE.    */ 00277000
*                   /*************************************************/ 00278000
*                   IF TVWAATTN > 0 |       /* ATTENTION(S)?         */ 00279000
*                      TVWAAIGN='1'B THEN   /* ATTENTION IGNORED?    */ 00280000
         CLI   TVWAATTN(TVWAREG),0                                 0216 00281000
         BH    @RT00216                                            0216 00282000
         TM    TVWAAIGN(TVWAREG),B'00100000'                       0216 00283000
         BNO   @RF00216                                            0216 00284000
@RT00216 DS    0H                                                  0217 00285000
*                     CALL ATTNROUT;        /* CALL ATTENTION ROUTINE*/ 00286000
         BAL   @14,ATTNROUT                                        0217 00287000
*                   ELSE                    /* TIM-ERROR-MESSAGE CASE*/ 00288000
*                     /***********************************************/ 00289000
*                     /* PLACE 'INPUT DATA LOST' MESSAGE INTO RU     */ 00290000
*                     /* WHICH WAS ISSUED BY IKTTIMRT TO INDICATE    */ 00291000
*                     /* THAT EITHER DATA NOT BEING RECEIVED         */ 00292000
*                     /* PROPERLY OR DATA UNABLE TO BE PLACED ON     */ 00293000
*                     /* INPUT QUEUE.                                */ 00294000
*                     /***********************************************/ 00295000
*                     DO;                   /* PROCESS ERROR MESSAGE */ 00296000
         B     @RC00216                                            0218 00297000
@RF00216 DS    0H                                                  0219 00298000
*                       RU(BYTECNT) = NL;   /* START ON NEW LINE     */ 00299000
         L     @15,BYTECNT(,TOMWREG)                               0219 00300000
         ALR   @15,TOMWREG                                         0219 00301000
         MVC   RU-1(1,@15),NL                                      0219 00302000
*                       BYTECNT=BYTECNT+1;  /* INCREMENT RU POSITION */ 00303000
         LA    @15,1                                               0220 00304000
         L     @14,BYTECNT(,TOMWREG)                               0220 00305000
         ALR   @14,@15                                             0220 00306000
         ST    @14,BYTECNT(,TOMWREG)                               0220 00307000
*                       TVWAERMG = '0'B;    /* RESET ERROR SWITCH    */ 00308000
         NI    TVWAERMG(TVWAREG),B'11110111'                       0221 00309000
*                       I = INPUTERR;       /* ERROR ON INPUT        */ 00310000
         LA    @05,4                                               0222 00311000
         ST    @05,I(,TOMWREG)                                     0222 00312000
*                       RU(BYTECNT:BYTECNT+MSGSIZE-1)              0223 00313000
*                             = MSGDATA(1:MSGSIZE);                0223 00314000
         ALR   @14,TOMWREG                                         0223 00315000
         SLA   @05,2                                               0223 00316000
         L     @01,CVTPTR                                          0223 00317000
         L     @01,CVTTCASP(,@01)                                  0223 00318000
         L     @01,TCASMSGS(,@01)                                  0223 00319000
         AL    @01,@CF02987                                        0223 00320000
         L     @05,MSGADR(@05,@01)                                 0223 00321000
         LH    @04,MSGSIZE(,@05)                                   0223 00322000
         LR    @03,@04                                             0223 00323000
         BCTR  @03,0                                               0223 00324000
         EX    @03,@SM02988                                        0223 00325000
*                       BYTECNT=BYTECNT+MSGSIZE; /* INCREMENT BYTECNT*/ 00326000
         L     @05,BYTECNT(,TOMWREG)                               0224 00327000
         ALR   @05,@04                                             0224 00328000
         ST    @05,BYTECNT(,TOMWREG)                               0224 00329000
*                       RU(BYTECNT) = NL;   /* GO TO NEXT LINE       */ 00330000
         ALR   @05,TOMWREG                                         0225 00331000
         MVC   RU-1(1,@05),NL                                      0225 00332000
*                       BYTECNT=BYTECNT+1;  /* INCREMENT RU POSITION */ 00333000
         L     @14,BYTECNT(,TOMWREG)                               0226 00334000
         ALR   @14,@15                                             0226 00335000
         ST    @14,BYTECNT(,TOMWREG)                               0226 00336000
*                     END;                  /* END MESSAGE PROCESSING*/ 00337000
*                 END;                      /* END OF GLOBAL ERROR   */ 00338000
*               ELSE                        /* NOT GLOBAL ERROR      */ 00339000
*                 IF RETRYMSG = '1'B THEN   /* RETRY MESSAGE?        */ 00340000
         B     @RC00207                                            0229 00341000
@RF00207 TM    RETRYMSG(TOMWREG),B'00001000'                       0229 00342000
         BNO   @RF00229                                            0229 00343000
*                   DO;                     /* PROCESS RETRY MESSAGE */ 00344000
*                     SKIP = '1'B;          /* SKIP BLDMSGS          */ 00345000
*                     XC = '1'B;            /* ENSURE OC (BLDMID)    */ 00346000
*                     ERMG = '0'B;          /* NO GLOBAL ERROR       */ 00347000
         OI    SKIP(TOMWREG),B'01000010'                           0233 00348000
         NI    ERMG(TOMWREG),B'11110111'                           0233 00349000
*                     SPEC = '0'B;          /* RESET SPECIAL SWITCH  */ 00350000
         NI    SPEC(TOMWREG),B'11011111'                           0234 00351000
*                     RU(BYTECNT) = NL;     /* START ON NEW LINE     */ 00352000
         L     @15,BYTECNT(,TOMWREG)                               0235 00353000
         ALR   @15,TOMWREG                                         0235 00354000
         MVC   RU-1(1,@15),NL                                      0235 00355000
*                     BYTECNT=BYTECNT+1;    /* INCREMENT RU POSITION */ 00356000
         LA    @15,1                                               0236 00357000
         L     @14,BYTECNT(,TOMWREG)                               0236 00358000
         ALR   @14,@15                                             0236 00359000
         ST    @14,BYTECNT(,TOMWREG)                               0236 00360000
*                     I = OUTERR;           /* ERROR ON OUTPUT       */ 00361000
         LA    @05,7                                               0237 00362000
         ST    @05,I(,TOMWREG)                                     0237 00363000
*                     RU(BYTECNT:BYTECNT+MSGSIZE-1)                0238 00364000
*                            = MSGDATA(1:MSGSIZE);                 0238 00365000
         ALR   @14,TOMWREG                                         0238 00366000
         SLA   @05,2                                               0238 00367000
         L     @01,CVTPTR                                          0238 00368000
         L     @01,CVTTCASP(,@01)                                  0238 00369000
         L     @01,TCASMSGS(,@01)                                  0238 00370000
         AL    @01,@CF02987                                        0238 00371000
         L     @05,MSGADR(@05,@01)                                 0238 00372000
         LH    @04,MSGSIZE(,@05)                                   0238 00373000
         LR    @03,@04                                             0238 00374000
         BCTR  @03,0                                               0238 00375000
         EX    @03,@SM02988                                        0238 00376000
*                     BYTECNT=BYTECNT+MSGSIZE; /* INCREMENT BYTECNT  */ 00377000
         L     @05,BYTECNT(,TOMWREG)                               0239 00378000
         ALR   @05,@04                                             0239 00379000
         ST    @05,BYTECNT(,TOMWREG)                               0239 00380000
*                     RU(BYTECNT) = NL;     /* GO TO NEXT LINE       */ 00381000
         ALR   @05,TOMWREG                                         0240 00382000
         MVC   RU-1(1,@05),NL                                      0240 00383000
*                     BYTECNT=BYTECNT+1;    /* INCREMENT RU POSITION */ 00384000
         L     @14,BYTECNT(,TOMWREG)                               0241 00385000
         ALR   @14,@15                                             0241 00386000
         ST    @14,BYTECNT(,TOMWREG)                               0241 00387000
*                     SWNL = '0'B;          /* ALREADY ON NEW LINE   */ 00388000
         NI    SWNL(TOMWREG),B'10111111'                           0242 00389000
*                   END;                    /* END MESSAGE PROCESSING*/ 00390000
*                 ELSE;                                            0244 00391000
*                                                                  0244 00392000
@RF00229 DS    0H                                                  0245 00393000
*             IF SKIP = '1'B |              /* SKIP BLDMSGS?         */ 00394000
*                MSG='0'B |                 /* NO MESSAGE ON QUEUE?  */ 00395000
*                SENDPRMT='1'B THEN;        /* SEND PROMPT ONLY?     */ 00396000
@RC00207 DS    0H                                                  0245 00397000
@RC00205 TM    SKIP(TOMWREG),B'00000010'                           0245 00398000
         BO    @RT00245                                            0245 00399000
         TM    MSG(TOMWREG),B'00000100'                            0245 00400000
         BZ    @RT00245                                            0245 00401000
         TM    SENDPRMT(TOMWREG),B'00001000'                       0245 00402000
         BO    @RT00245                                            0245 00403000
*             ELSE                          /* DO NOT SKIP BLDMSGS   */ 00404000
*               CALL BLDMSGS;               /* BUILD MESSAGES        */ 00405000
*                                                                  0247 00406000
         BAL   @14,BLDMSGS                                         0247 00407000
*             CALL BLDMID;                                         0248 00408000
*                                                                  0248 00409000
@RT00245 BAL   @14,BLDMID                                          0248 00410000
*             IF XIT = '0'B THEN            /* EXIT MODULE?          */ 00411000
         TM    XIT(TOMWREG),B'00000100'                            0249 00412000
         BNZ   @RF00249                                            0249 00413000
*               CALL FIN;                   /* DO FINAL PROCESSING   */ 00414000
         BAL   @14,FIN                                             0250 00415000
*             ELSE;                         /* DO NOT EXIT MODULE    */ 00416000
*                                                                  0251 00417000
@RF00249 DS    0H                                                  0252 00418000
*           END;                                                   0252 00419000
*                                                                  0252 00420000
@DE00200 TM    AGAIN(TOMWREG),B'00000001'                          0252 00421000
         BO    @DL00200                                            0252 00422000
*           END BLDCHAIN;                   /* END OF BLDCHAIN       */ 00423000
@EL00002 DS    0H                                                  0253 00424000
@EF00002 DS    0H                                                  0253 00425000
@ER00002 L     @14,@SA00002                                        0253 00426000
         BR    @14                                                 0253 00427000
         EJECT                                                          00428000
*/********************************************************************/ 00429000
*/*                                                                  */ 00430000
*/* SUBROUTINE-                                                      */ 00431000
*/*      FINPROC                                                     */ 00432000
*/*                                                                  */ 00433000
*/* FUNCTION-                                                        */ 00434000
*/*      PERMANENT EXIT.                                             */ 00435000
*/*                                                                  */ 00436000
*/********************************************************************/ 00437000
*                                                                  0254 00438000
*FINPROC:                                                          0254 00439000
*   PROCEDURE OPTIONS(NOSAVE);      /* CALL IKTEXIT          @ZM21235*/ 00440000
FINPROC  DS    0H                                                  0255 00441000
*   RFY                                                            0255 00442000
*     REG1 RSTD;                    /* PARAMETER POINTER     @ZM21235*/ 00443000
*   REG1=ADDR(PLXPARMS);            /* ADDRESS PARAMETER LIST      0256 00444000
*                                                            @ZM21235*/ 00445000
         LA    REG1,PLXPARMS                                       0256 00446000
*   CALL IKTEXIT;                   /* PERMANENT EXIT        @ZM21235*/ 00447000
         L     @14,CVTPTR                                          0257 00448000
         L     @14,CVTTCASP(,@14)                                  0257 00449000
         L     @15,TCASEXIT(,@14)                                  0257 00450000
         BALR  @14,@15                                             0257 00451000
*   RFY                                                            0258 00452000
*     REG1 UNRSTD;                  /* PARAMETER POINTER     @ZM21235*/ 00453000
*   END FINPROC;                    /* END OF SUBROUTINE     @ZM21235*/ 00454000
@EL00003 DS    0H                                                  0259 00455000
@EF00003 DS    0H                                                  0259 00456000
@ER00003 BR    @14                                                 0259 00457000
         EJECT                                                          00458000
*BLDMSGS:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0260 00459000
BLDMSGS  ST    @14,@SA00004                                        0260 00460000
*           /*********************************************************/ 00461000
*           /*                                                       */ 00462000
*           /* PROCEDURE - BLDMSGS                                   */ 00463000
*           /*                                                       */ 00464000
*           /* FUNCTION - TO PREPARE MESSAGES FOR PLACEMENT INTO RU  */ 00465000
*           /*                                                       */ 00466000
*           /*********************************************************/ 00467000
*                                                                  0261 00468000
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/  00469000
*CKMC0003:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856 00470000
**/            FRWACKPT(2)=ADDR(CKMC0003); /* SAVE ADDRESS    @ZM20856  00471000
*/           END;            /* CHECK POINT   @ZM20856*/           0262 00472000
*                                                                  0262 00473000
CKMC0003 L     @15,TVWAFRWO(,TVWAREG)                              0262 00474000
         STM   REG0,REG15,FRWACKRG(@15)                            0262 00475000
         LA    @14,CKMC0003                                        0263 00476000
         ST    @14,FRWACKPT+4(,@15)                                0263 00477000
*           OPREQ = OBTAINO;                /* OBTAIN MESSAGE        */ 00478000
         MVI   OPREQ(TOMWREG),X'02'                                0265 00479000
*           CALL IKTQMOUT(OPARMS);          /* CALL QUEUE MANAGER    */ 00480000
*                                                                  0266 00481000
         LA    @15,OPARMS(,TOMWREG)                                0266 00482000
         ST    @15,@AL00001                                        0266 00483000
         L     @01,CVTPTR                                          0266 00484000
         L     @01,CVTTCASP(,@01)                                  0266 00485000
         L     @15,TCASOQM(,@01)                                   0266 00486000
         LA    @01,@AL00001                                        0266 00487000
         BALR  @14,@15                                             0266 00488000
*           /*********************************************************/ 00489000
*           /* IF MESSAGE AVAILABLE                                  */ 00490000
*           /*********************************************************/ 00491000
*           IF OPRC = MORQMSGS |            /* MESSAGES ON QUEUE?    */ 00492000
*              OPRC = ONEQMSG THEN          /* ONE MESSAGE ON QUEUE? */ 00493000
         CLI   OPRC(TOMWREG),1                                     0267 00494000
         BE    @RT00267                                            0267 00495000
         CLI   OPRC(TOMWREG),2                                     0267 00496000
         BNE   @RF00267                                            0267 00497000
@RT00267 DS    0H                                                  0268 00498000
*             /*******************************************************/ 00499000
*             /* IF PART OF PREVIOUS MESSAGE WAS NOT PROCESSED       */ 00500000
*             /*******************************************************/ 00501000
*             IF MOR = '1'B THEN            /* MIDDLE OF MESSAGE?    */ 00502000
         TM    MOR(TOMWREG),B'10000000'                            0268 00503000
         BNO   @RF00268                                            0268 00504000
*               /*****************************************************/ 00505000
*               /* IF THE PREVIOUS MESSAGE IS STILL THERE,           */ 00506000
*               /* LEAVE CHAIN ALONE.                                */ 00507000
*               /*****************************************************/ 00508000
*               IF OPBUFADR = BUFPTR THEN;  /* SAME MESSAGE?         */ 00509000
         CLC   OPBUFADR(4,TOMWREG),BUFPTR(TOMWREG)                 0269 00510000
         BE    @RT00269                                            0269 00511000
*               ELSE                        /* DIFFERENT MESSAGE     */ 00512000
*                 DO;                       /* DO THE FOLLOWING      */ 00513000
*                   CALL CHKOCEOC;          /* CANCEL CHAIN          */ 00514000
         BAL   @14,CHKOCEOC                                        0272 00515000
*                   MOR = '0'B;             /* NEW MESSAGE           */ 00516000
         NI    MOR(TOMWREG),B'01111111'                            0273 00517000
*                 END;                      /* CHAIN CANCELED        */ 00518000
*             ELSE                          /* NEW MESSAGE           */ 00519000
*               SPEC = '0'B;                /* NOT SPECIAL CASE      */ 00520000
         B     @RC00268                                            0275 00521000
@RF00268 NI    SPEC(TOMWREG),B'11011111'                           0275 00522000
*           ELSE                            /* MESSAGE NOT AVAILABLE */ 00523000
*             DO;                           /* DO THE FOLLOWING      */ 00524000
         B     @RC00267                                            0276 00525000
@RF00267 DS    0H                                                  0277 00526000
*               /*****************************************************/ 00527000
*               /* WHEN MESSAGE IS NOT AVAILABLE AND PART OF         */ 00528000
*               /* PREVIOUS MESSAGE WAS NOT PROCESSED, CANCEL        */ 00529000
*               /* CHAIN IF NECESSARY.                               */ 00530000
*               /* WHEN MESSAGE IS NOT AVAILABLE AND ALL OF THE      */ 00531000
*               /* PREVIOUS MESSAGE WAS PROCESSED, SKIP THE REST     */ 00532000
*               /* OF THIS PROCEDURE.                                */ 00533000
*               /*****************************************************/ 00534000
*               IF MOR = '1'B THEN          /* MIDDLE OF MESSAGE     */ 00535000
         TM    MOR(TOMWREG),B'10000000'                            0277 00536000
         BNO   @RF00277                                            0277 00537000
*                 DO;                       /* DO THE FOLLOWING      */ 00538000
*                   CALL CHKOCEOC;          /* CANCEL CHAIN          */ 00539000
         BAL   @14,CHKOCEOC                                        0279 00540000
*                   MOR = '0'B;             /* END OF MESSAGE        */ 00541000
         NI    MOR(TOMWREG),B'01111111'                            0280 00542000
*                 END;                      /* CHAIN CANCELED        */ 00543000
*               ELSE;                       /* NOT MIDDLE OF MESSAGE */ 00544000
@RF00277 DS    0H                                                  0283 00545000
*               SPEC = '0'B;                /* NOT A SPECIAL CASE    */ 00546000
         NI    SPEC(TOMWREG),B'11011111'                           0283 00547000
*               MSG = '0'B;                 /* NO MESSAGE AVAILABLE  */ 00548000
         NI    MSG(TOMWREG),B'11111011'                            0284 00549000
*               SKIP = '1'B;                /* SKIP THE FOLLOWING    */ 00550000
         OI    SKIP(TOMWREG),B'00000010'                           0285 00551000
*             END;                                                 0286 00552000
*           /*********************************************************/ 00553000
*           /* IF NO MESSAGE AVAILABLE, SKIP THE FOLLOWING.          */ 00554000
*           /*********************************************************/ 00555000
*           IF SKIP = '1'B THEN;            /* SKIP THE FOLLOWING    */ 00556000
@RC00267 TM    SKIP(TOMWREG),B'00000010'                           0287 00557000
         BO    @RT00287                                            0287 00558000
*           ELSE                            /* DO THE FOLLOWING      */ 00559000
*             DO;                                                  0289 00560000
*               IF SPEC = '0'B THEN         /* NOT SPECIAL CASE?     */ 00561000
         TM    SPEC(TOMWREG),B'00100000'                           0290 00562000
         BNZ   @RF00290                                            0290 00563000
*                 DO;                       /* ESTIMATE MESSAGE SIZE */ 00564000
*                   ESTIMATE = OPBFSZ + (OPBFSZ/TSBLNSZ) + 2;      0292 00565000
         LH    @15,OPBFSZ(,TOMWREG)                                0292 00566000
         LR    @00,@15                                             0292 00567000
         SRDA  @00,32                                              0292 00568000
         SLR   @14,@14                                             0292 00569000
         IC    @14,TSBLNSZ(,TSBREG)                                0292 00570000
         DR    @00,@14                                             0292 00571000
         ALR   @15,@01                                             0292 00572000
         AL    @15,@CF00076                                        0292 00573000
         ST    @15,ESTIMATE(,TOMWREG)                              0292 00574000
*                   IF ESTIMATE > (257-BYTECNT)+(RUCOUNT-1)*256 THEN    00575000
         LA    @14,257                                             0293 00576000
         SL    @14,BYTECNT(,TOMWREG)                               0293 00577000
         SLR   @05,@05                                             0293 00578000
         IC    @05,RUCOUNT(,TOMWREG)                               0293 00579000
         BCTR  @05,0                                               0293 00580000
         SLA   @05,8                                               0293 00581000
         ALR   @14,@05                                             0293 00582000
         CR    @15,@14                                             0293 00583000
         BNH   @RF00293                                            0293 00584000
*                                           /* MESSAGE TOO LARGE?    */ 00585000
*                     SPEC = '1'B;          /* SPECIAL CASE          */ 00586000
         OI    SPEC(TOMWREG),B'00100000'                           0294 00587000
*                   ELSE;                   /* MESSAGE FITS          */ 00588000
@RF00293 DS    0H                                                  0296 00589000
*                 END;                      /* END OF ESTIMATION     */ 00590000
*               ELSE;                       /* SPECIAL CASE          */ 00591000
@RF00290 DS    0H                                                  0298 00592000
*               /*****************************************************/ 00593000
*               /* IF MESSAGE IS BREAKIN, CROSS-MEMORY, OR CONTROL,  */ 00594000
*               /* THEN TURN ON  EXCEPTION SWITCH (XC = '1'B).       */ 00595000
*               /*****************************************************/ 00596000
*               IF OPBRK = '1'B THEN        /* BREAKIN TPUT?         */ 00597000
         TM    OPBRK(TOMWREG),B'01000000'                          0298 00598000
         BNO   @RF00298                                            0298 00599000
*                 DO;                       /* DO THE FOLLOWING      */ 00600000
*                   TVWABIR = '0'B;         /* RESET BREAK SWITCH    */ 00601000
         NI    TVWABIR(TVWAREG),B'11111110'                        0300 00602000
*                   IF MOR = '0'B           /* CHECK IF NEW MESSAGE  */ 00603000
*                   THEN                    /* NEW MESSAGE           */ 00604000
         TM    MOR(TOMWREG),B'10000000'                            0301 00605000
         BNZ   @RF00301                                            0301 00606000
*                     SWNL = '1'B;          /* START ON NEW LINE     */ 00607000
         OI    SWNL(TOMWREG),B'01000000'                           0302 00608000
*                   ELSE;                   /* NOT NEW MESSAGE       */ 00609000
@RF00301 DS    0H                                                  0304 00610000
*                   BRK = '1'B;             /* BREAKIN MESSAGE       */ 00611000
*                   XC = '1'B;              /* EXCEPTION MESSAGE     */ 00612000
         OI    BRK(TOMWREG),B'11000000'                            0305 00613000
*                 END;                      /* END BREAK PROCESSING  */ 00614000
*               ELSE;                       /* NOT BREAKIN TPUT      */ 00615000
@RF00298 DS    0H                                                  0308 00616000
*               IF OPEDIT = '10'B THEN      /* CONTROL TPUT?         */ 00617000
         TM    OPEDIT(TOMWREG),B'00100000'                         0308 00618000
         BNO   @RF00308                                            0308 00619000
         TM    OPEDIT(TOMWREG),B'00010000'                         0308 00620000
         BNZ   @RF00308                                            0308 00621000
*                 XC = '1'B;                /* EXCEPTION CONDITION   */ 00622000
         OI    XC(TOMWREG),B'01000000'                             0309 00623000
*               ELSE;                       /* NOT CONTROL TPUT      */ 00624000
@RF00308 DS    0H                                                  0311 00625000
*               IF OPASID = '1'B THEN       /* CROSS-MEMORY TPUT?    */ 00626000
         TM    OPASID(TOMWREG),B'00001000'                         0311 00627000
         BNO   @RF00311                                            0311 00628000
*                 DO;                       /* DO THE FOLLOWING      */ 00629000
*                   XC = '1'B;              /* EXCEPTION CONDITION   */ 00630000
         OI    XC(TOMWREG),B'01000000'                             0313 00631000
*                   IF MOR = '0'B THEN      /* NEW MESSAGE?          */ 00632000
         TM    MOR(TOMWREG),B'10000000'                            0314 00633000
         BNZ   @RF00314                                            0314 00634000
*                     SWNL = '1'B;          /* START ON NEW LINE     */ 00635000
         OI    SWNL(TOMWREG),B'01000000'                           0315 00636000
*                   ELSE;                   /* NOT NEW MESSAGE       */ 00637000
@RF00314 DS    0H                                                  0317 00638000
*                 END;                      /* END OF X-MEMORY TPUT  */ 00639000
*               ELSE;                       /* NOT CROSS-MEMORY MSG  */ 00640000
@RF00311 DS    0H                                                  0319 00641000
*               IF XC = '1'B |              /* TPUT IS X-MEMORY,   0319 00642000
*                                              BREAKIN, OR CONTROL?  */ 00643000
*                  SPEC = '1'B THEN         /* MESSAGE LARGER THAN 0319 00644000
*                                              ONE CHAIN?            */ 00645000
         TM    XC(TOMWREG),B'01000000'                             0319 00646000
         BO    @RT00319                                            0319 00647000
         TM    SPEC(TOMWREG),B'00100000'                           0319 00648000
         BNO   @RF00319                                            0319 00649000
@RT00319 DS    0H                                                  0320 00650000
*                 DO;                       /* OR SPECIAL CASE       */ 00651000
*                   /*************************************************/ 00652000
*                   /* AT THIS POINT, MOR='0'B MEANS THAT THE        */ 00653000
*                   /* CURRENT MESSAGE IS NOT PART OF A PREVIOUS     */ 00654000
*                   /* MESSAGE.  THUS, IF MOR='0'B, INITIALIZE THE   */ 00655000
*                   /* RU COUNT TO THE CHAIN SIZE OF 3 (ANY INTEGER  */ 00656000
*                   /* > 2 WILL DO) SO THAT IN BLDMID THE            */ 00657000
*                   /* CHAIN-ELEMENT WILL BE SET TO BEGINNING OF     */ 00658000
*                   /* CHAIN.                                        */ 00659000
*                   /* IF MOR ^= '0'B, SET RU COUNT DIFFERENT FROM   */ 00660000
*                   /* CHAIN SIZE SO THAT IN BLDMID THE              */ 00661000
*                   /* CHAIN-ELEMENT WILL NOT BE SET TO              */ 00662000
*                   /* BEGINNING-OF-CHAIN.                           */ 00663000
*                   /*************************************************/ 00664000
*                   CHAINSZE = 3;           /* INITIALIZE CHAIN SIZE */ 00665000
         MVI   CHAINSZE(TOMWREG),X'03'                             0321 00666000
*                   IF MOR = '0'B THEN      /* NEW MESSAGE?          */ 00667000
         TM    MOR(TOMWREG),B'10000000'                            0322 00668000
         BNZ   @RF00322                                            0322 00669000
*                     RUCOUNT = CHAINSZE;   /* BOC OR OC             */ 00670000
         IC    @15,CHAINSZE(,TOMWREG)                              0323 00671000
         STC   @15,RUCOUNT(,TOMWREG)                               0323 00672000
*                   ELSE                    /* OTHERWISE, MOC OR EOC */ 00673000
*                     RUCOUNT=CHAINSZE - 1; /* SET RUCOUNT ^= CHAINSZE  00674000
*                                              AND > 1 SO THAT THE 0324 00675000
*                                              CHAIN ELEMENT WILL NOT   00676000
*                                              BE SET TO BEGINNING OF   00677000
*                                              CHAIN.                */ 00678000
         B     @RC00322                                            0324 00679000
@RF00322 SLR   @15,@15                                             0324 00680000
         IC    @15,CHAINSZE(,TOMWREG)                              0324 00681000
         BCTR  @15,0                                               0324 00682000
         STC   @15,RUCOUNT(,TOMWREG)                               0324 00683000
*                   CALL EDITMSG;           /* EDIT MESSAGE          */ 00684000
@RC00322 BAL   @14,EDITMSG                                         0325 00685000
*                   MORMSGS = '0'B;         /* LET CHAIN CONSIST OF     00686000
*                                              EXCEPTION MESSAGE ONLY*/ 00687000
         NI    MORMSGS(TOMWREG),B'11101111'                        0326 00688000
*                   /*************************************************/ 00689000
*                   /* IF MORE OF MESSAGE YET TO BE PROCESSED,       */ 00690000
*                   /* UPDATE MESSAGE POINTER.                       */ 00691000
*                   /*************************************************/ 00692000
*                   IF MOR = '1'B THEN      /* MIDDLE OF MESSAGE?    */ 00693000
         TM    MOR(TOMWREG),B'10000000'                            0327 00694000
         BNO   @RF00327                                            0327 00695000
*                     DO;                   /* DO THE FOLLOWING      */ 00696000
*                       OPREQ = UPDATO;     /* UPDATE MESSAGE POINTER*/ 00697000
         MVI   OPREQ(TOMWREG),X'04'                                0329 00698000
*                       OPBUFADR = BUFPTR;  /* MESSAGE ADDRESS       */ 00699000
         L     @15,BUFPTR(,TOMWREG)                                0330 00700000
         ST    @15,OPBUFADR(,TOMWREG)                              0330 00701000
*                       CALL IKTQMOUT(OPARMS);                     0331 00702000
         LA    @15,OPARMS(,TOMWREG)                                0331 00703000
         ST    @15,@AL00001                                        0331 00704000
         L     @01,CVTPTR                                          0331 00705000
         L     @01,CVTTCASP(,@01)                                  0331 00706000
         L     @15,TCASOQM(,@01)                                   0331 00707000
         LA    @01,@AL00001                                        0331 00708000
         BALR  @14,@15                                             0331 00709000
*                     END;                  /* MSG. POINTER UPDATED  */ 00710000
*                   ELSE                    /* END OF MESSAGE        */ 00711000
*                     IF OPHOLD = '1'B THEN /* TPUT HOLD MESSAGE?    */ 00712000
         B     @RC00327                                            0333 00713000
@RF00327 TM    OPHOLD(TOMWREG),B'10000000'                         0333 00714000
         BNO   @RF00333                                            0333 00715000
*                       HLD = '1'B;         /* TURN ON HOLD SWITCH.  */ 00716000
         OI    HLD(TOMWREG),B'01000000'                            0334 00717000
*                     ELSE;                 /* NOT TPUT-HOLD MESSAGE */ 00718000
@RF00333 DS    0H                                                  0336 00719000
*                 END;                      /* END SPECIAL PROCESSING*/ 00720000
*               ELSE                        /* NOT SPECIAL CASE      */ 00721000
*                 /***************************************************/ 00722000
*                 /* BLOCK AS MANY MESSAGES (THAT ARE NOT            */ 00723000
*                 /* EXCEPTIONAL) AS POSSIBLE INTO THE RU UNTIL THE  */ 00724000
*                 /* OUTPUT MESSAGE QUEUE IS EMPTY OR THE RU IS FULL.*/ 00725000
*                 /***************************************************/ 00726000
*                 DO WHILE (REPEAT = '1'B);                        0337 00727000
         B     @RC00319                                            0337 00728000
@RF00319 B     @DE00337                                            0337 00729000
@DL00337 DS    0H                                                  0338 00730000
*                   /*************************************************/ 00731000
*                   /* IF THERE ARE MORE MESSAGES ON THE QUEUE,      */ 00732000
*                   /* CHECK IF NEXT MESSAGE IS AN EXCEPTION         */ 00733000
*                   /* MESSAGE.                                      */ 00734000
*                   /*************************************************/ 00735000
*                   IF OPRC = MORQMSGS THEN /* MORE MESSAGES?        */ 00736000
         CLI   OPRC(TOMWREG),1                                     0338 00737000
         BNE   @RF00338                                            0338 00738000
*                     DO;                   /* DO THE FOLLOWING      */ 00739000
*                       MORMSGS = '1'B;     /* MORE MESSAGES ON QUEUE*/ 00740000
*                                                                  0340 00741000
         OI    MORMSGS(TOMWREG),B'00010000'                        0340 00742000
*                       /*********************************************/ 00743000
*                       /* IF NEXT MESSAGE IS CROSS-MEMORY, BREAKIN, */ 00744000
*                       /* OR EDIT, TURN ON EXCEPTION INDICATOR      */ 00745000
*                       /* FOR NEXT MESSAGE (NXC = '1'B).            */ 00746000
*                       /*********************************************/ 00747000
*                       IF OPNXASID = '1'B | /* NEXT TPUT A X-MEMORY?*/ 00748000
*                          OPNXBRK = '1'B |  /* NEXT TPUT A BREAKIN? */ 00749000
*                          OPNXEDIT = '10'B THEN /* NEXT-CONTROL MSG?*/ 00750000
         TM    OPNXASID(TOMWREG),B'01001000'                       0341 00751000
         BNZ   @RT00341                                            0341 00752000
         TM    OPNXEDIT(TOMWREG),B'00100000'                       0341 00753000
         BNO   @RF00341                                            0341 00754000
         TM    OPNXEDIT(TOMWREG),B'00010000'                       0341 00755000
         BNZ   @RF00341                                            0341 00756000
@RT00341 DS    0H                                                  0342 00757000
*                         NXC = '1'B;        /* NEXT TPUT EXCEPTIONAL*/ 00758000
         OI    NXC(TOMWREG),B'00100000'                            0342 00759000
*                       ELSE;                                      0343 00760000
*                                                                  0343 00761000
@RF00341 DS    0H                                                  0344 00762000
*                     END;                   /* END OF MORE MESSAGES */ 00763000
*                                                                  0344 00764000
*                   ELSE                    /* QUEUE IS EMPTY        */ 00765000
*                     MORMSGS = '0'B;       /* QUEUE IS EMPTY        */ 00766000
         B     @RC00338                                            0345 00767000
@RF00338 NI    MORMSGS(TOMWREG),B'11101111'                        0345 00768000
*                   CALL EDITMSG;           /* EDIT MESSAGE          */ 00769000
@RC00338 BAL   @14,EDITMSG                                         0346 00770000
*                   IF MOR = '1'B THEN      /* MIDDLE OF MESSAGE?    */ 00771000
         TM    MOR(TOMWREG),B'10000000'                            0347 00772000
         BNO   @RF00347                                            0347 00773000
*                     DO;                   /* UPDATE MESSAGE POINTER*/ 00774000
*                       OPREQ = UPDATO;     /* UPDATE MESSAGE POINTER*/ 00775000
         MVI   OPREQ(TOMWREG),X'04'                                0349 00776000
*                       OPBUFADR = BUFPTR;  /* UPDATE MESSAGE POINTER*/ 00777000
         L     @15,BUFPTR(,TOMWREG)                                0350 00778000
         ST    @15,OPBUFADR(,TOMWREG)                              0350 00779000
*                       CALL IKTQMOUT(OPARMS);                     0351 00780000
         LA    @15,OPARMS(,TOMWREG)                                0351 00781000
         ST    @15,@AL00001                                        0351 00782000
         L     @01,CVTPTR                                          0351 00783000
         L     @01,CVTTCASP(,@01)                                  0351 00784000
         L     @15,TCASOQM(,@01)                                   0351 00785000
         LA    @01,@AL00001                                        0351 00786000
         BALR  @14,@15                                             0351 00787000
*                       REPEAT = '0'B;      /* RU FULL-DO NOT REPEAT */ 00788000
         NI    REPEAT(TOMWREG),B'11111101'                         0352 00789000
*                     END;                  /* POINTER UPDATED       */ 00790000
*                   ELSE                    /* END OF MESSAGE        */ 00791000
*                     DO;                   /* DO THE FOLLOWING      */ 00792000
         B     @RC00347                                            0354 00793000
@RF00347 DS    0H                                                  0355 00794000
*                       IF OPHOLD='1'B THEN /* TPUT HOLD MESSAGE?    */ 00795000
         TM    OPHOLD(TOMWREG),B'10000000'                         0355 00796000
         BNO   @RF00355                                            0355 00797000
*                         HLD = '1'B;       /* TURN ON HOLD SWITCH.  */ 00798000
         OI    HLD(TOMWREG),B'01000000'                            0356 00799000
*                       ELSE;               /* NOT TPUT HOLD MESSAGE */ 00800000
*                                                                  0357 00801000
@RF00355 DS    0H                                                  0358 00802000
*                       /*********************************************/ 00803000
*                       /* IF THE RU IS NOT FULL AND IF THERE ARE    */ 00804000
*                       /* MESSAGES ON THE QUEUE AND THE NEXT        */ 00805000
*                       /* MESSAGE IS NOT EXCEPTIONAL, OBTAIN NEXT   */ 00806000
*                       /* MESSAGE.                                  */ 00807000
*                       /*********************************************/ 00808000
*                       IF BYTECNT<256 &    /* RU NOT FULL?          */ 00809000
*                          MORMSGS='1'B &   /* MORE MESSAGES?        */ 00810000
*                          NXC='0'B THEN    /* NEXT TPUT ^EXCEPTION? */ 00811000
         L     @15,BYTECNT(,TOMWREG)                               0358 00812000
         C     @15,@CF00684                                        0358 00813000
         BNL   @RF00358                                            0358 00814000
         TM    MORMSGS(TOMWREG),B'00010000'                        0358 00815000
         BNO   @RF00358                                            0358 00816000
         TM    NXC(TOMWREG),B'00100000'                            0358 00817000
         BNZ   @RF00358                                            0358 00818000
*                         DO;                                      0359 00819000
*                           ESTIMATE = OPNXBFSZ+(OPNXBFSZ/TSBLNSZ)+2;   00820000
         LH    @14,OPNXBFSZ(,TOMWREG)                              0360 00821000
         LR    @00,@14                                             0360 00822000
         SRDA  @00,32                                              0360 00823000
         SLR   @05,@05                                             0360 00824000
         IC    @05,TSBLNSZ(,TSBREG)                                0360 00825000
         DR    @00,@05                                             0360 00826000
         ALR   @14,@01                                             0360 00827000
         AL    @14,@CF00076                                        0360 00828000
         ST    @14,ESTIMATE(,TOMWREG)                              0360 00829000
*                           IF ESTIMATE <= (257-BYTECNT)           0361 00830000
*                                          + (RUCOUNT-1)*256 THEN  0361 00831000
         LCR   @15,@15                                             0361 00832000
         AL    @15,@CF02797                                        0361 00833000
         SLR   @05,@05                                             0361 00834000
         IC    @05,RUCOUNT(,TOMWREG)                               0361 00835000
         BCTR  @05,0                                               0361 00836000
         SLA   @05,8                                               0361 00837000
         ALR   @15,@05                                             0361 00838000
         CR    @14,@15                                             0361 00839000
         BH    @RF00361                                            0361 00840000
*                             DO;                                  0362 00841000
*                               OPREQ = OBTAINO;                   0363 00842000
         MVI   OPREQ(TOMWREG),X'02'                                0363 00843000
*                               CALL IKTQMOUT(OPARMS);             0364 00844000
         LA    @15,OPARMS(,TOMWREG)                                0364 00845000
         ST    @15,@AL00001                                        0364 00846000
         L     @01,CVTPTR                                          0364 00847000
         L     @01,CVTTCASP(,@01)                                  0364 00848000
         L     @15,TCASOQM(,@01)                                   0364 00849000
         LA    @01,@AL00001                                        0364 00850000
         BALR  @14,@15                                             0364 00851000
*                             END;                                 0365 00852000
*                           ELSE                                   0366 00853000
*                             DO;                                  0366 00854000
         B     @RC00361                                            0366 00855000
@RF00361 DS    0H                                                  0367 00856000
*                               REPEAT='0'B; /* END BLOCKING OF    0367 00857000
*                                               MESSAGES             */ 00858000
         NI    REPEAT(TOMWREG),B'11111101'                         0367 00859000
*                               NXC='1'B;    /* TREAT NEXT MESSAGE AS   00860000
*                                               EXCEPTION TO END   0368 00861000
*                                               CURRENT CHAIN        */ 00862000
         OI    NXC(TOMWREG),B'00100000'                            0368 00863000
*                             END;                                 0369 00864000
*                         END;                                     0370 00865000
*                       ELSE                                       0371 00866000
*                         REPEAT = '0'B;     /* END MESSAGE BLOCKING */ 00867000
*                                                                  0371 00868000
         B     @RC00358                                            0371 00869000
@RF00358 NI    REPEAT(TOMWREG),B'11111101'                         0371 00870000
*                     END;                                         0372 00871000
*                                                                  0372 00872000
@RC00358 DS    0H                                                  0373 00873000
*                 END;                       /* END MESSAGE BLOCKING */ 00874000
@RC00347 DS    0H                                                  0373 00875000
@DE00337 TM    REPEAT(TOMWREG),B'00000010'                         0373 00876000
         BO    @DL00337                                            0373 00877000
*             END;                                                 0374 00878000
*                                                                  0374 00879000
*           END BLDMSGS;            /* END OF BLDMSGS                */ 00880000
@EL00004 DS    0H                                                  0375 00881000
@EF00004 DS    0H                                                  0375 00882000
@ER00004 L     @14,@SA00004                                        0375 00883000
         BR    @14                                                 0375 00884000
         EJECT                                                          00885000
*BLDMID:    PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0376 00886000
*                                                                  0376 00887000
BLDMID   ST    @14,@SA00005                                        0376 00888000
*           /*********************************************************/ 00889000
*           /*                                                       */ 00890000
*           /* PROCEDURE - BLDMID                                    */ 00891000
*           /*                                                       */ 00892000
*           /* FUNCTION - TO PREPARE RU FOR OUTPUT                   */ 00893000
*           /*     (A) DETERMINE IF PROMPT IS AVAILABLE AND IF IT    */ 00894000
*           /*         SHOULD BE PLACED IN RU AT THIS TIME.          */ 00895000
*           /*     (B) DETERMINE IF USER TRANSLATION OR ASCII        */ 00896000
*           /*         TRANSLATION SHOULD BE DONE.                   */ 00897000
*           /*     (C) DETERMINE CHAIN ELEMENT IF NECESSARY.         */ 00898000
*           /*                                                       */ 00899000
*           /*********************************************************/ 00900000
*                                                                  0377 00901000
*           /*********************************************************/ 00902000
*           /* WHEN START-WITH-NEW-LINE CHARACTER IS INDICATED AND   */ 00903000
*           /* THE RU IS NOT FULL (--BOTH CONDITIONS ARE POSSIBLE AT */ 00904000
*           /* THIS POINT IF BLDMSGS WAS ENTERED BUT THERE WAS NO    */ 00905000
*           /* MESSAGE ON THE QUEUE), ADD NEW-LINE CHARACTER TO RU.  */ 00906000
*           /*********************************************************/ 00907000
*                                                                  0377 00908000
*           IF SWNL = '1'B &                /* NEW LINE PROCESSING?  */ 00909000
*              BYTECNT < 257 THEN           /* ROOM IN RU?           */ 00910000
         TM    SWNL(TOMWREG),B'01000000'                           0377 00911000
         BNO   @RF00377                                            0377 00912000
         L     @15,BYTECNT(,TOMWREG)                               0377 00913000
         C     @15,@CF02797                                        0377 00914000
         BNL   @RF00377                                            0377 00915000
*             DO;                           /* BEGIN NL PROCESSING   */ 00916000
*               RU(BYTECNT) = NL;           /* NEXT LINE             */ 00917000
         ALR   @15,TOMWREG                                         0379 00918000
         MVC   RU-1(1,@15),NL                                      0379 00919000
*               BYTECNT = BYTECNT + 1;      /* NEXT BYTE POSITION    */ 00920000
         L     @15,BYTECNT(,TOMWREG)                               0380 00921000
         AL    @15,@CF00064                                        0380 00922000
         ST    @15,BYTECNT(,TOMWREG)                               0380 00923000
*               SWNL = '0'B;                /* RESET NEW-LINE SWITCH */ 00924000
         NI    SWNL(TOMWREG),B'10111111'                           0381 00925000
*             END;                          /* END OF NL PROCESSING  */ 00926000
*           ELSE;                           /* NO NL PROCESSING      */ 00927000
*                                                                  0383 00928000
@RF00377 DS    0H                                                  0384 00929000
*           IF BYTECNT > 1 THEN             /* RU NOT EMPTY?         */ 00930000
         L     @15,BYTECNT(,TOMWREG)                               0384 00931000
         C     @15,@CF00064                                        0384 00932000
         BNH   @RF00384                                            0384 00933000
*             TSTPRMPT = '1'B;              /* TEST FOR PROMPTING    */ 00934000
         OI    TSTPRMPT(TOMWREG),B'00000010'                       0385 00935000
*           ELSE;                           /* RU EMPTY              */ 00936000
*                                                                  0386 00937000
@RF00384 DS    0H                                                  0387 00938000
*           IF SENDPRMT = '1'B THEN         /* SEND PROMPT?          */ 00939000
         TM    SENDPRMT(TOMWREG),B'00001000'                       0387 00940000
         BNO   @RF00387                                            0387 00941000
*             DO;                                                  0388 00942000
*               SENDPRMT = '0'B;            /* RESET SEND-PROMPT SW  */ 00943000
         NI    SENDPRMT(TOMWREG),B'11110111'                       0389 00944000
*               TSTPRMPT = '0'B;            /* RESET TEST-PROMPT SW  */ 00945000
         NI    TSTPRMPT(TOMWREG),B'11111101'                       0390 00946000
*               CALL PRMPTCHK;              /* CALL PROMPT ROUTINE   */ 00947000
         BAL   @14,PRMPTCHK                                        0391 00948000
*               IF PROMPT = '0'B THEN       /* IS THERE NO PROMPT?   */ 00949000
         TM    PROMPT(TOMWREG),B'10000000'                         0392 00950000
         BNZ   @RF00392                                            0392 00951000
*                 DO;                       /* SEND SPACE-BACKSPACE  */ 00952000
*                   RU(BYTECNT:BYTECNT+1) = '4016'X;               0394 00953000
         L     @15,BYTECNT(,TOMWREG)                               0394 00954000
         ALR   @15,TOMWREG                                         0394 00955000
         MVC   RU-1(2,@15),@CB02804                                0394 00956000
*                   BYTECNT = BYTECNT + 2;  /* INCREMENT BYTE COUNT  */ 00957000
         L     @15,BYTECNT(,TOMWREG)                               0395 00958000
         AL    @15,@CF00076                                        0395 00959000
         ST    @15,BYTECNT(,TOMWREG)                               0395 00960000
*                   PROMPT = '1'B;          /* SIMILAR TO A PROMPT   */ 00961000
         OI    PROMPT(TOMWREG),B'10000000'                         0396 00962000
*                 END;                                             0397 00963000
*               ELSE;                       /* PROMPT                */ 00964000
@RF00392 DS    0H                                                  0399 00965000
*             END;                                                 0399 00966000
*           ELSE                                                   0400 00967000
*             IF TSTPRMPT = '0'B THEN;      /* NO PROMPT CHECKING?   */ 00968000
         B     @RC00387                                            0400 00969000
@RF00387 TM    TSTPRMPT(TOMWREG),B'00000010'                       0400 00970000
         BZ    @RT00400                                            0400 00971000
*             ELSE                          /* TEST FOR PROMPTING    */ 00972000
*             IF TSBSPIT = '0'B &           /* PROMPTING NOT PURGED? */ 00973000
*                TSBAUTON='1'B &            /* PROMPTING REQUESTED?  */ 00974000
*                TSBSTAUT='1'B THEN         /* PROMPT USER?          */ 00975000
         TM    TSBSPIT(TSBREG),B'00100000'                         0402 00976000
         BNZ   @RF00402                                            0402 00977000
         TM    TSBAUTON(TSBREG),B'01000100'                        0402 00978000
         BNO   @RF00402                                            0402 00979000
*               IF BYTECNT = 1 THEN         /* IS RU EMPTY?          */ 00980000
         CLC   BYTECNT(4,TOMWREG),@CF00064                         0403 00981000
         BNE   @RF00403                                            0403 00982000
*                 DO;                                              0404 00983000
*                   TSTPRMPT = '0'B;        /* RESET TEST-PROMPT SW  */ 00984000
         NI    TSTPRMPT(TOMWREG),B'11111101'                       0405 00985000
*                   CALL PRMPTCHK;          /* CALL PROMPT ROUTINE   */ 00986000
         BAL   @14,PRMPTCHK                                        0406 00987000
*                 END;                                             0407 00988000
*               ELSE                        /* RU IS NOT EMPTY       */ 00989000
*                 IF TVWADOOQ = '0'B THEN   /* IS OUTPUT QUEUE EMPTY?*/ 00990000
         B     @RC00403                                            0408 00991000
@RF00403 TM    TVWADOOQ(TVWAREG),B'01000000'                       0408 00992000
         BNZ   @RF00408                                            0408 00993000
*                   IF (257-BYTECNT) > 9 THEN /* ROOM IN RU?         */ 00994000
         LA    @15,257                                             0409 00995000
         SL    @15,BYTECNT(,TOMWREG)                               0409 00996000
         C     @15,@CF01008                                        0409 00997000
         BNH   @RF00409                                            0409 00998000
*                     DO;                                          0410 00999000
*                       CALL PRMPTCHK;      /* CALL PROMPT ROUTINE   */ 01000000
         BAL   @14,PRMPTCHK                                        0411 01001000
*                       TSTPRMPT = '0'B;    /* RESET TEST-PROMPT SW  */ 01002000
         NI    TSTPRMPT(TOMWREG),B'11111101'                       0412 01003000
*                       PROMPT = '0'B;      /* RESET PROMPT SWITCH   */ 01004000
         NI    PROMPT(TOMWREG),B'01111111'                         0413 01005000
*                     END;                                         0414 01006000
*                   ELSE                    /* NO ROOM IN RU         */ 01007000
*                     DO;                                          0415 01008000
         B     @RC00409                                            0415 01009000
@RF00409 DS    0H                                                  0416 01010000
*                       SENDPRMT = '1'B;    /* SEND PROMPT LATER     */ 01011000
         OI    SENDPRMT(TOMWREG),B'00001000'                       0416 01012000
*                       TSTPRMPT = '1'B;    /* TEST PROMPT LATER     */ 01013000
         OI    TSTPRMPT(TOMWREG),B'00000010'                       0417 01014000
*                       IF RPLCHN = BOC |   /* BEGINNING OF CHAIN?   */ 01015000
*                          RPLCHN = MOC THEN  /* MIDDLE OF CHAIN?    */ 01016000
         LA    @15,16                                              0418 01017000
         ALR   @15,RPLREG                                          0418 01018000
         CLI   RPLCHN(@15),X'80'                                   0418 01019000
         BE    @RT00418                                            0418 01020000
         CLI   RPLCHN(@15),X'40'                                   0418 01021000
         BNE   @RF00418                                            0418 01022000
@RT00418 DS    0H                                                  0419 01023000
*                         RPLCHN = MOC;     /* MOC                   */ 01024000
         MVI   RPLCHN+16(RPLREG),X'40'                             0419 01025000
*                       ELSE                /* OC OR EOC             */ 01026000
*                         RPLCHN = BOC;     /* BOC                   */ 01027000
         B     @RC00418                                            0420 01028000
@RF00418 MVI   RPLCHN+16(RPLREG),X'80'                             0420 01029000
*                       RPLVTFL2 = SCHEDNEG;                       0421 01030000
@RC00418 MVI   RPLVTFL2+16(RPLREG),X'84'                           0421 01031000
*                       NOTNOW = '1'B;      /* CHAIN ELT DETERMINED  */ 01032000
         OI    NOTNOW(TOMWREG),B'00000100'                         0422 01033000
*                     END;                                         0423 01034000
*                 ELSE;                     /* MESSAGE ON QUEUE      */ 01035000
@RF00408 DS    0H                                                  0425 01036000
*             ELSE                          /* NO PROMPT             */ 01037000
*               DO;                         /* RESET SWITCHES        */ 01038000
         B     @RC00402                                            0425 01039000
@RF00402 DS    0H                                                  0426 01040000
*                 TSTPRMPT = '0'B;          /* RESET TEST-PROMPT SW  */ 01041000
*                 PSENT = '0'B;             /* RESET SWITCH  OZ11996 */ 01042000
         NI    TSTPRMPT(TOMWREG),B'11110101'                       0427 01043000
*               END;                        /* END OF RESET          */ 01044000
*           /*********************************************************/ 01045000
*           /* IF RU IS EMPTY, DO NOT REPEAT PROCESS.                */ 01046000
*           /*********************************************************/ 01047000
*           IF BYTECNT = 1 THEN             /* RU EMPTY?             */ 01048000
@RC00402 DS    0H                                                  0429 01049000
@RT00400 DS    0H                                                  0429 01050000
@RC00387 CLC   BYTECNT(4,TOMWREG),@CF00064                         0429 01051000
         BNE   @RF00429                                            0429 01052000
*             AGAIN = '0'B;                 /* END CHAINING PROCESS  */ 01053000
         NI    AGAIN(TOMWREG),B'11111110'                          0430 01054000
*           ELSE                            /* RU NOT EMPTY          */ 01055000
*             DO;                           /* DO THE FOLLOWING      */ 01056000
*                                                                  0431 01057000
         B     @RC00429                                            0431 01058000
@RF00429 DS    0H                                                  0432 01059000
*               /*****************************************************/ 01060000
*               /* IF USER-TRANSLATION OR ASCII-TRANSLATION IS       */ 01061000
*               /* INDICATED, CALL TRANSLATION ROUTINE.              */ 01062000
*               /*****************************************************/ 01063000
*               IF TVWATRAN = '1'B |        /* DO USER TRANSLATION?  */ 01064000
*                  TSBXASCI='1'B THEN       /* DO ASCII TRANSLATION? */ 01065000
         TM    TVWATRAN(TVWAREG),B'00000010'                       0432 01066000
         BO    @RT00432                                            0432 01067000
         L     @01,TSBEXTNT(,TSBREG)                               0432 01068000
         TM    TSBXASCI(@01),B'10000000'                           0432 01069000
         BNO   @RF00432                                            0432 01070000
@RT00432 DS    0H                                                  0433 01071000
*                 CALL TRANSL8;             /* TRANSLATE DATA        */ 01072000
         BAL   @14,TRANSL8                                         0433 01073000
*               ELSE;                       /* DO NOT TRANSLATE      */ 01074000
@RF00432 DS    0H                                                  0435 01075000
*               IF NOTNOW = '1'B THEN;      /* CHAIN-ELT DETERMINED? */ 01076000
         TM    NOTNOW(TOMWREG),B'00000100'                         0435 01077000
         BO    @RT00435                                            0435 01078000
*               ELSE                        /* DETERMINE CHAIN-ELT   */ 01079000
*               /*****************************************************/ 01080000
*               /* (A) IF MORE OF THE CURRENT MESSAGE IS LEFT TO BE  */ 01081000
*               /*     PROCESSED,                                    */ 01082000
*               /* (B) IF THERE ARE MORE MESSAGES ON THE QUEUE AND   */ 01083000
*               /*     BOTH THE CURRENT MESSAGE AND THE NEXT MESSAGE */ 01084000
*               /*     ARE NOT CROSS-MEMORY, BREAKIN, AND CONTROL, OR*/ 01085000
*               /* (C) IF GLOBAL ERROR                               */ 01086000
*               /*****************************************************/ 01087000
*               IF PROMPT = '0'B &   /* NOT PROMPT MESSAGE?          */ 01088000
*                 (MOR='1'B |        /* MIDDLE OF A TPUT?            */ 01089000
*                 (XC='0'B &         /* CURRENT TPUT IS NOT CROSS- 0437 01090000
*                                       MEMORY, NOT BREAKIN, AND NOT    01091000
*                                       CONTROL?                     */ 01092000
*                  MORMSGS='1'B &    /* MORE MESSAGES ON QUEUE?      */ 01093000
*                  NXC='0'B &        /* NEXT TPUT IS NOT CROSS-MEMORY,  01094000
*                                       NOT BREAKIN, AND NOT CONTROL?*/ 01095000
*                  SPEC='0'B) |      /* MESSAGE FITS IN CHAIN?       */ 01096000
*                  ERMG = '1'B) THEN /* GLOBAL ERROR MESSAGE?        */ 01097000
         TM    PROMPT(TOMWREG),B'10000000'                         0437 01098000
         BNZ   @RF00437                                            0437 01099000
         TM    MOR(TOMWREG),B'10000000'                            0437 01100000
         BO    @RT00437                                            0437 01101000
         TM    MORMSGS(TOMWREG),B'00010000'                        0437 01102000
         BNO   @GL00013                                            0437 01103000
         TM    XC(TOMWREG),B'01100000'                             0437 01104000
         BNZ   @GL00013                                            0437 01105000
         TM    SPEC(TOMWREG),B'00100000'                           0437 01106000
         BZ    @RT00437                                            0437 01107000
@GL00013 TM    ERMG(TOMWREG),B'00001000'                           0437 01108000
         BNO   @RF00437                                            0437 01109000
@RT00437 DS    0H                                                  0438 01110000
*                 /***************************************************/ 01111000
*                 /* IF ONLY ONE RU PER CHAIN OR GLOBAL ERROR        */ 01112000
*                 /* SITUATION, TURN ON ONLY-CHAIN INDICATOR.        */ 01113000
*                 /***************************************************/ 01114000
*                 IF CHAINSZE = 1 |         /* ONLY CHAIN SITUATION? */ 01115000
*                    ERMG='1'B THEN         /* GLOBAL ERROR MESSAGE? */ 01116000
         CLI   CHAINSZE(TOMWREG),1                                 0438 01117000
         BE    @RT00438                                            0438 01118000
         TM    ERMG(TOMWREG),B'00001000'                           0438 01119000
         BNO   @RF00438                                            0438 01120000
@RT00438 DS    0H                                                  0439 01121000
*                   DO;                     /* BEGIN OC PROCESSING   */ 01122000
*                    RPLCHN = OC;           /* ONLY CHAIN            */ 01123000
         LA    @15,16                                              0440 01124000
         ALR   @15,RPLREG                                          0440 01125000
         MVI   RPLCHN(@15),X'10'                                   0440 01126000
*                    RPLVTFL2 = RESPPOS;    /* POST=RESP AND       0441 01127000
*                                             RESPOND=(NEX,FME,NRRN) */ 01128000
         MVI   RPLVTFL2(@15),X'00'                                 0441 01129000
*                    CHAINSZE = TVWACHNL;   /* RESET CHAIN SIZE      */ 01130000
         IC    @15,TVWACHNL(,TVWAREG)                              0442 01131000
         STC   @15,CHAINSZE(,TOMWREG)                              0442 01132000
*                    RUCOUNT = CHAINSZE;    /* RESET RU COUNT        */ 01133000
         IC    @15,CHAINSZE(,TOMWREG)                              0443 01134000
         STC   @15,RUCOUNT(,TOMWREG)                               0443 01135000
*                   END;                    /* END OF OC PROCESSING  */ 01136000
*                 ELSE                      /* BOC, EOC, OR MOC      */ 01137000
*                   /*************************************************/ 01138000
*                   /* IF THIS IS THE FIRST RU IN THIS CHAIN,        */ 01139000
*                   /* TURN ON BEGINNING-OF-CHAIN INDICATOR.         */ 01140000
*                   /*************************************************/ 01141000
*                   IF RUCOUNT=CHAINSZE THEN /* BEGINNING OF CHAIN?  */ 01142000
         B     @RC00438                                            0445 01143000
@RF00438 CLC   RUCOUNT(1,TOMWREG),CHAINSZE(TOMWREG)                0445 01144000
         BNE   @RF00445                                            0445 01145000
*                     DO;                   /* BEGIN BOC PROCESSING  */ 01146000
*                       RPLCHN = BOC;       /* BEGINNING-OF-CHAIN    */ 01147000
         LA    @15,16                                              0447 01148000
         ALR   @15,RPLREG                                          0447 01149000
         MVI   RPLCHN(@15),X'80'                                   0447 01150000
*                       RPLVTFL2 = SCHEDNEG;   /* POST=SCHED AND   0448 01151000
*                                              RESPOND=(EX,FME,NRRN) */ 01152000
         MVI   RPLVTFL2(@15),X'84'                                 0448 01153000
*                       RUCOUNT = RUCOUNT - 1;                     0449 01154000
         SLR   @15,@15                                             0449 01155000
         IC    @15,RUCOUNT(,TOMWREG)                               0449 01156000
         BCTR  @15,0                                               0449 01157000
         STC   @15,RUCOUNT(,TOMWREG)                               0449 01158000
*                     END;                  /* END OF BOC PROCESSING */ 01159000
*                   ELSE                    /* EOC OR MOC            */ 01160000
*                     /***********************************************/ 01161000
*                     /* IF THIS IS THE LAST RU IN THE CHAIN,        */ 01162000
*                     /* TURN ON THE END-OF-CHAIN INDICATOR.         */ 01163000
*                     /***********************************************/ 01164000
*                     IF RUCOUNT=1 THEN     /* END OF CHAIN?         */ 01165000
         B     @RC00445                                            0451 01166000
@RF00445 CLI   RUCOUNT(TOMWREG),1                                  0451 01167000
         BNE   @RF00451                                            0451 01168000
*                       DO;                 /* BEGIN EOC PROCESSING  */ 01169000
*                         RPLCHN = EOC;     /* END-OF-CHAIN          */ 01170000
         LA    @15,16                                              0453 01171000
         ALR   @15,RPLREG                                          0453 01172000
         MVI   RPLCHN(@15),X'20'                                   0453 01173000
*                         RPLVTFL2 = RESPPOS;  /* POST=RESP AND    0454 01174000
*                                              RESPOND=(NEX,FME,NRRN)*/ 01175000
         MVI   RPLVTFL2(@15),X'00'                                 0454 01176000
*                         CHAINSZE = TVWACHNL; /* RESET CHAIN SIZE   */ 01177000
         IC    @15,TVWACHNL(,TVWAREG)                              0455 01178000
         STC   @15,CHAINSZE(,TOMWREG)                              0455 01179000
*                         RUCOUNT = CHAINSZE;  /* RESET RU COUNT     */ 01180000
         IC    @15,CHAINSZE(,TOMWREG)                              0456 01181000
         STC   @15,RUCOUNT(,TOMWREG)                               0456 01182000
*                       END;                /* END OF EOC PROCESSING */ 01183000
*                     ELSE                  /* MOC                   */ 01184000
*                       DO;                 /* BEGIN MOC PROCESSING  */ 01185000
         B     @RC00451                                            0458 01186000
@RF00451 DS    0H                                                  0459 01187000
*                         RPLCHN = MOC;     /* MIDDLE-OF-CHAIN       */ 01188000
         LA    @15,16                                              0459 01189000
         ALR   @15,RPLREG                                          0459 01190000
         MVI   RPLCHN(@15),X'40'                                   0459 01191000
*                         RPLVTFL2 = SCHEDNEG; /* POST=SCHED AND   0460 01192000
*                                              RESPOND=(EX,FME,NRRN) */ 01193000
         MVI   RPLVTFL2(@15),X'84'                                 0460 01194000
*                         RUCOUNT = RUCOUNT - 1;                   0461 01195000
         SLR   @15,@15                                             0461 01196000
         IC    @15,RUCOUNT(,TOMWREG)                               0461 01197000
         BCTR  @15,0                                               0461 01198000
         STC   @15,RUCOUNT(,TOMWREG)                               0461 01199000
*                       END;                /* END OF MOC PROCESSING */ 01200000
*               ELSE                        /* END CHAIN             */ 01201000
*                 DO;                       /* EOC OR OC PROCESSING  */ 01202000
         B     @RC00437                                            0463 01203000
@RF00437 DS    0H                                                  0464 01204000
*                   IF RPLCHN = BOC |       /* BEGINNING OF CHAIN?   */ 01205000
*                      RPLCHN=MOC THEN      /* MIDDLE OF CHAIN?      */ 01206000
         LA    @15,16                                              0464 01207000
         ALR   @15,RPLREG                                          0464 01208000
         CLI   RPLCHN(@15),X'80'                                   0464 01209000
         BE    @RT00464                                            0464 01210000
         CLI   RPLCHN(@15),X'40'                                   0464 01211000
         BNE   @RF00464                                            0464 01212000
@RT00464 DS    0H                                                  0465 01213000
*                     DO;                   /* BEGIN EOC PROCESSING  */ 01214000
*                       RPLCHN = EOC;       /* END-OF-CHAIN          */ 01215000
         LA    @15,16                                              0466 01216000
         ALR   @15,RPLREG                                          0466 01217000
         MVI   RPLCHN(@15),X'20'                                   0466 01218000
*                       RPLVTFL2 = RESPPOS; /* POST=RESP AND       0467 01219000
*                                              RESPOND=(NEX,FME,NRRN)*/ 01220000
         MVI   RPLVTFL2(@15),X'00'                                 0467 01221000
*                       PROMPT = '0'B;      /* RESET PROMPT SWITCH   */ 01222000
         NI    PROMPT(TOMWREG),B'01111111'                         0468 01223000
*                     END;                  /* END EOC PROCESSING    */ 01224000
*                   ELSE                    /* ONLY CHAIN            */ 01225000
*                     DO;                   /* BEGIN OC PROCESSING   */ 01226000
         B     @RC00464                                            0470 01227000
@RF00464 DS    0H                                                  0471 01228000
*                       RPLCHN = OC;        /* ONLY CHAIN            */ 01229000
         LA    @15,16                                              0471 01230000
         ALR   @15,RPLREG                                          0471 01231000
         MVI   RPLCHN(@15),X'10'                                   0471 01232000
*                       RPLVTFL2 = RESPPOS; /* POST=RESP AND       0472 01233000
*                                              RESPOND=(NEX,FME,NRRN)*/ 01234000
         MVI   RPLVTFL2(@15),X'00'                                 0472 01235000
*                     END;                  /* END OF OC PROCESSING  */ 01236000
*                                                                  0473 01237000
*                   CHAINSZE = TVWACHNL;    /* RESET CHAIN SIZE      */ 01238000
@RC00464 IC    @15,TVWACHNL(,TVWAREG)                              0474 01239000
         STC   @15,CHAINSZE(,TOMWREG)                              0474 01240000
*                   RUCOUNT = CHAINSZE;     /* RESET RU COUNT        */ 01241000
*                                                                  0475 01242000
         IC    @15,CHAINSZE(,TOMWREG)                              0475 01243000
         STC   @15,RUCOUNT(,TOMWREG)                               0475 01244000
*                 END;                                             0476 01245000
*                                                                  0476 01246000
*               CALL BLDEND;                                       0477 01247000
*                                                                  0477 01248000
@RC00437 DS    0H                                                  0477 01249000
@RT00435 BAL   @14,BLDEND                                          0477 01250000
*             END;                                                 0478 01251000
*                                                                  0478 01252000
*           END BLDMID;                     /* END OF BLDMID         */ 01253000
@EL00005 DS    0H                                                  0479 01254000
@EF00005 DS    0H                                                  0479 01255000
@ER00005 L     @14,@SA00005                                        0479 01256000
         BR    @14                                                 0479 01257000
         EJECT                                                          01258000
*BLDEND:    PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0480 01259000
*                                                                  0480 01260000
BLDEND   ST    @14,@SA00006                                        0480 01261000
*           /*********************************************************/ 01262000
*           /*                                                       */ 01263000
*           /* PROCEDURE - BLDEND                                    */ 01264000
*           /*                                                       */ 01265000
*           /* FUNCTION - (A) DETERMINE IF A TERMWAIT SYSEVENT IS TO */ 01266000
*           /*                IS ISSUED.                             */ 01267000
*           /*            (B) CALL SENDRU TO SEND RU.                */ 01268000
*           /*            (C) IF SEND IS SUCCESSFUL,                 */ 01269000
*           /*                (1) CONSIDER GLOBAL-ERROR INDICATION,  */ 01270000
*           /*                (2) HANDLE TPUT-HOLD SITUATION,        */ 01271000
*           /*                (3) DELETE MESSAGE(S),                 */ 01272000
*           /*                (4) CHECK IF THERE ARE MORE MESSAGES   */ 01273000
*           /*                    ON QUEUE.                          */ 01274000
*           /*                                                       */ 01275000
*           /*********************************************************/ 01276000
*                                                                  0481 01277000
*           RFY (REG0,REG1) RSTD;           /* RESTRICT REGISTERS 0,1*/ 01278000
*           MPSTSOIR='0'B;                  /* TURN OFF SOIR @ZA26553*/ 01279000
*           MPSTSOIW='0'B;                  /* TURN OFF SOIW @ZA26553*/ 01280000
         L     @15,PSAAOLD                                         0483 01281000
         L     @15,ASCBASXB(,@15)                                  0483 01282000
         L     @15,ASXBMPST(,@15)                                  0483 01283000
         NI    MPSTSOIR(@15),B'00111111'                           0483 01284000
*           IF (RPLCHN=EOC |                /* END OF CHAIN?         */ 01285000
*               RPLCHN=OC) &                /* ONLY CHAIN?           */ 01286000
*               TVWADOOQ='0'B &             /* NO MESSAGE ON QUEUE?  */ 01287000
*               TVWABKMG='0'B THEN          /* NO BREAK-IN MESSAGE?  */ 01288000
         LA    @15,16                                              0484 01289000
         ALR   @15,RPLREG                                          0484 01290000
         CLI   RPLCHN(@15),X'20'                                   0484 01291000
         BE    @GL00019                                            0484 01292000
         CLI   RPLCHN(@15),X'10'                                   0484 01293000
         BNE   @RF00484                                            0484 01294000
@GL00019 TM    TVWADOOQ(TVWAREG),B'01000000'                       0484 01295000
         BNZ   @RF00484                                            0484 01296000
         TM    TVWABKMG(TVWAREG),B'00000100'                       0484 01297000
         BNZ   @RF00484                                            0484 01298000
*             DO;                           /* CHECK OWAIT           */ 01299000
*               IF TSBOWAIT = '1'B THEN     /* OWAIT?        @ZA17004*/ 01300000
         TM    TSBOWAIT(TSBREG),B'00100000'                        0486 01301000
         BNO   @RF00486                                            0486 01302000
*                 DO;                       /* ISSUE SYSEVENT 22     */ 01303000
*                   REG0 = ASCBASID;        /* ASID                  */ 01304000
         L     @15,PSAAOLD                                         0488 01305000
         LH    REG0,ASCBASID(,@15)                                 0488 01306000
         N     REG0,@CF02998                                       0488 01307000
*                   REG1 = TPUT;            /* TPUT SATISFIED        */ 01308000
         L     REG1,@CF02008                                       0489 01309000
*                   GEN REFS(ASCBASID,CVTOPTE,CVTPTR,CVT)          0490 01310000
*                       SETS(REG0,REG14,REG15);                    0490 01311000
         SYSEVENT TGETTPUT,ASID=(REG0),ENTRY=BRANCH                     01312000
*                 END;                      /* END OF SYSEVENT 22    */ 01313000
*               ELSE;                       /* NOT OWAIT             */ 01314000
@RF00486 DS    0H                                                  0493 01315000
*               IF TSBOWAIT = '1'B |        /* OWAIT?                */ 01316000
*                 (TSBIWAIT = '1'B &        /* IWAIT?                */ 01317000
*                 (TVWADOOQ='1'B |          /* MESSAGE ON QUEUE?     */ 01318000
*                  TSTPRMPT = '1'B)) THEN   /* CHECK PROMPT?         */ 01319000
         TM    TSBOWAIT(TSBREG),B'00100000'                        0493 01320000
         BO    @RT00493                                            0493 01321000
         TM    TSBIWAIT(TSBREG),B'01000000'                        0493 01322000
         BNO   @RF00493                                            0493 01323000
         TM    TVWADOOQ(TVWAREG),B'01000000'                       0493 01324000
         BO    @RT00493                                            0493 01325000
         TM    TSTPRMPT(TOMWREG),B'00000010'                       0493 01326000
         BNO   @RF00493                                            0493 01327000
@RT00493 DS    0H                                                  0494 01328000
*                 DO;                                              0494 01329000
*                   SEVENT = '1'B;          /* ISSUE SYSEVENT 02     */ 01330000
         OI    SEVENT(TOMWREG),B'10000000'                         0495 01331000
*                   REG1 = TPUT;            /* OUTPUT TERMINAL WAIT  */ 01332000
         L     REG1,@CF02008                                       0496 01333000
*                 END;                      /* END OF OUTPUT CASE    */ 01334000
*               ELSE                        /* NOT OUTPUT SITUATION  */ 01335000
*                 IF TSBIWAIT = '1'B THEN   /* IWAIT?                */ 01336000
         B     @RC00493                                            0498 01337000
@RF00493 TM    TSBIWAIT(TSBREG),B'01000000'                        0498 01338000
         BNO   @RF00498                                            0498 01339000
*                   DO;                                            0499 01340000
*                     SEVENT = '0'B;        /* NO SYSEVENT   @ZA24418*/ 01341000
         NI    SEVENT(TOMWREG),B'01111111'                         0500 01342000
*                     MPSTSOIR = '1'B;      /* INDICATE IWAIT TO VTAM*/ 01343000
         L     @15,PSAAOLD                                         0501 01344000
         L     @15,ASCBASXB(,@15)                                  0501 01345000
         L     @15,ASXBMPST(,@15)                                  0501 01346000
         OI    MPSTSOIR(@15),B'01000000'                           0501 01347000
*                     TVWAISYS = '1'B;      /* IWAIT SYSEVENT OZ12002*/ 01348000
         OI    TVWAISYS(TVWAREG),B'10000000'                       0502 01349000
*                   END;                    /* END OF INPUT SITUATION*/ 01350000
*                 ELSE                      /* NOT OWAIT - NOT IWAIT */ 01351000
*                   SEVENT = '0'B;          /* NO SYSEVENT           */ 01352000
         B     @RC00498                                            0504 01353000
@RF00498 NI    SEVENT(TOMWREG),B'01111111'                         0504 01354000
*               IF SEVENT = '1'B THEN       /* SYSEVENT 02?          */ 01355000
@RC00498 DS    0H                                                  0505 01356000
@RC00493 TM    SEVENT(TOMWREG),B'10000000'                         0505 01357000
         BNO   @RF00505                                            0505 01358000
*                 DO;                       /* PROCESS SYSEVENT 02   */ 01359000
*                   REG0 = ASCBASID;        /* ASID                  */ 01360000
         L     @15,PSAAOLD                                         0507 01361000
         LH    REG0,ASCBASID(,@15)                                 0507 01362000
         N     REG0,@CF02998                                       0507 01363000
*                   GEN REFS(ASCBASID,CVTOPTE,CVTPTR,CVT)          0508 01364000
*                       SETS(REG0,REG14,REG15);                    0508 01365000
         SYSEVENT TERMWAIT,ASID=(REG0),ENTRY=BRANCH                     01366000
*                 END;                      /* END OF SYSEVENT 02    */ 01367000
*               ELSE;                       /* NO SYSEVENT           */ 01368000
@RF00505 DS    0H                                                  0511 01369000
*             END;                          /* END OF WAIT CHECK     */ 01370000
*           ELSE;                                                  0512 01371000
*                                                                  0512 01372000
@RF00484 DS    0H                                                  0513 01373000
*           IF RPLCHN = BOC &               /* BEGINNING OF CHAIN?   */ 01374000
*              TVWARCRS='1'B THEN           /* RESP. BEING RECEIVED? */ 01375000
         LA    @15,16                                              0513 01376000
         ALR   @15,RPLREG                                          0513 01377000
         CLI   RPLCHN(@15),X'80'                                   0513 01378000
         BNE   @RF00513                                            0513 01379000
         TM    TVWARCRS(TVWAREG),B'00000010'                       0513 01380000
         BNO   @RF00513                                            0513 01381000
*             DO;                           /* RESP. BEING RECEIVED  */ 01382000
*               RPLNFSYN = '1'B;            /* RTYPE=NDFSYN          */ 01383000
*               RPLDFASY = '0'B;            /* RTYPE=NDFASY          */ 01384000
         OI    RPLNFSYN(@15),B'00000100'                           0516 01385000
         NI    RPLDFASY(@15),B'11111101'                           0516 01386000
*               TVWARCRS = '0'B;            /* DO NOT RECEIVE RESP.  */ 01387000
         NI    TVWARCRS(TVWAREG),B'11111101'                       0517 01388000
*               CALL RCVRSET;               /* RESETSR               */ 01389000
         BAL   @14,RCVRSET                                         0518 01390000
*             END;                          /* END OF RESETSR        */ 01391000
*           ELSE;                           /* DO NOTHING            */ 01392000
*                                                                  0520 01393000
@RF00513 DS    0H                                                  0521 01394000
*           IF PROMPT = '1'B THEN           /* PROMPT MESSAGE?       */ 01395000
         TM    PROMPT(TOMWREG),B'10000000'                         0521 01396000
         BNO   @RF00521                                            0521 01397000
*             DO;                           /* DO THE FOLLOWING      */ 01398000
*               IF RPLCHN=OC &              /* ONLY CHAIN?           */ 01399000
*                  NOTNOW='0'B THEN         /* ONLY PROMPT IN RU?    */ 01400000
         LA    @15,16                                              0523 01401000
         ALR   @15,RPLREG                                          0523 01402000
         CLI   RPLCHN(@15),X'10'                                   0523 01403000
         BNE   @RF00523                                            0523 01404000
         TM    NOTNOW(TOMWREG),B'00000100'                         0523 01405000
         BNZ   @RF00523                                            0523 01406000
*                 DO;                       /* DO THE FOLLOWING      */ 01407000
*                   RPLVTFL2 = SCHEDNEG;    /* POST=SCHED            */ 01408000
         MVI   RPLVTFL2(@15),X'84'                                 0525 01409000
*                   IF TVWARCRS='0'B THEN   /* RESPONSES ^ RECEIVED? */ 01410000
         TM    TVWARCRS(TVWAREG),B'00000010'                       0526 01411000
         BNZ   @RF00526                                            0526 01412000
*                     DO;                   /* RECEIVED              */ 01413000
*                       RPLNFSYN = '0'B;    /* RTYPE=DFSYN           */ 01414000
*                       RPLDFASY = '1'B;    /* RTYPE=DFASY           */ 01415000
         OI    RPLDFASY(@15),B'00000010'                           0529 01416000
         NI    RPLNFSYN(@15),B'11111011'                           0529 01417000
*                       TVWARCRS = '1'B;    /* RECEIVE RESPONSES     */ 01418000
         OI    TVWARCRS(TVWAREG),B'00000010'                       0530 01419000
*                       CALL RCVRSET;       /* RESETSR               */ 01420000
         BAL   @14,RCVRSET                                         0531 01421000
*                     END;                  /* END OF RESETSR        */ 01422000
*                   ELSE;                   /* DO NOTHING            */ 01423000
@RF00526 DS    0H                                                  0534 01424000
*                 END;                      /* END OC PROCESSING     */ 01425000
*               ELSE;                       /* BOC, MOC, OR EOC      */ 01426000
@RF00523 DS    0H                                                  0536 01427000
*               PROMPT = '0'B;              /* PROMPT MESSAGE HANDLED*/ 01428000
         NI    PROMPT(TOMWREG),B'01111111'                         0536 01429000
*             END;                          /* END OF PROMPT HANDLING*/ 01430000
*           ELSE;                           /* NOT PROMPT SITUATION  */ 01431000
*                                                                  0538 01432000
@RF00521 DS    0H                                                  0539 01433000
*           RFY (REG0,REG1) UNRSTD;         /* UNRESTRICT REG. 0,1   */ 01434000
*                                                                  0539 01435000
*           NEC = '1'B;                     /* SEND DATA             */ 01436000
         OI    NEC(TOMWREG),B'00000100'                            0540 01437000
*           DO WHILE (NEC = '1'B);                                 0541 01438000
         B     @DE00541                                            0541 01439000
@DL00541 DS    0H                                                  0542 01440000
*             CALL SENDRU;                  /* CALL SEND-DATA ROUTINE*/ 01441000
         BAL   @14,SENDRU                                          0542 01442000
*           END;                                                   0543 01443000
*                                                                  0543 01444000
@DE00541 TM    NEC(TOMWREG),B'00000100'                            0543 01445000
         BO    @DL00541                                            0543 01446000
*           /*********************************************************/ 01447000
*           /* IF THE GLOBAL-ERROR INDICATOR IS ON BUT THE ATTENTION */ 01448000
*           /* COUNTERS ARE ZERO AND THERE IS NO TIM-ERROR MESSAGE,  */ 01449000
*           /* TURN OFF THE GLOBAL-ERROR SWITCH.                     */ 01450000
*           /*********************************************************/ 01451000
*           IF TVWAGERR = '1'B THEN         /* GLOBAL ERROR?         */ 01452000
         TM    TVWAGERR(TVWAREG),B'00010000'                       0544 01453000
         BNO   @RF00544                                            0544 01454000
*             IF TVWAATTN = 0 &             /* NO ATTENTIONS?        */ 01455000
*                TVWAAIGN='0'B &            /* NO ATTENTION IGNORED? */ 01456000
*                TVWAERMG='0'B THEN         /* NO TIM-ERROR MESSAGE? */ 01457000
         CLI   TVWAATTN(TVWAREG),0                                 0545 01458000
         BNE   @RF00545                                            0545 01459000
         TM    TVWAAIGN(TVWAREG),B'00100000'                       0545 01460000
         BNZ   @RF00545                                            0545 01461000
         TM    TVWAERMG(TVWAREG),B'00001000'                       0545 01462000
         BNZ   @RF00545                                            0545 01463000
*               TVWAGERR = '0'B;            /* RESET ERROR SWITCH    */ 01464000
         NI    TVWAGERR(TVWAREG),B'11101111'                       0546 01465000
*             ELSE;                         /* GLOBAL ERROR          */ 01466000
@RF00545 DS    0H                                                  0548 01467000
*           ELSE;                           /* NO GLOBAL ERROR       */ 01468000
@RF00544 DS    0H                                                  0549 01469000
*           /*********************************************************/ 01470000
*           /* IF PROMPT WAS NOT SENT AND PROMPTING IS IN EFFECT,    */ 01471000
*           /* TEST FOR PROMPTING.                                   */ 01472000
*           /*********************************************************/ 01473000
*           IF PSENT = '0'B &               /* NO PROMPT SENT?       */ 01474000
*              TSBSPIT = '0'B &             /* PROMPTING NOT PURGED? */ 01475000
*              TSBAUTON='1'B &              /* PROMPTING REQUESTED?  */ 01476000
*              TSBSTAUT='1'B THEN           /* PROMPT USER?          */ 01477000
         TM    PSENT(TOMWREG),B'00001000'                          0549 01478000
         BNZ   @RF00549                                            0549 01479000
         TM    TSBSPIT(TSBREG),B'00100000'                         0549 01480000
         BNZ   @RF00549                                            0549 01481000
         TM    TSBAUTON(TSBREG),B'01000100'                        0549 01482000
         BNO   @RF00549                                            0549 01483000
*             TSTPRMPT = '1'B;              /* TEST PROMPT           */ 01484000
         OI    TSTPRMPT(TOMWREG),B'00000010'                       0550 01485000
*           ELSE                                                   0551 01486000
*             PSENT = '0'B;                 /* RESET SWITCH   OZ1196 */ 01487000
         B     @RC00549                                            0551 01488000
@RF00549 NI    PSENT(TOMWREG),B'11110111'                          0551 01489000
*           /*********************************************************/ 01490000
*           /* IF ERROR ENCOUNTERED, THEN BYPASS THE FOLLOWING.      */ 01491000
*           /*********************************************************/ 01492000
*           IF BYPASS = '1'B THEN;          /* BYPASS THE FOLLOWING? */ 01493000
@RC00549 TM    BYPASS(TOMWREG),B'00000001'                         0552 01494000
         BO    @RT00552                                            0552 01495000
*           ELSE                            /* DO THE FOLLOWING      */ 01496000
*               /*****************************************************/ 01497000
*               /* IF END-OF-CHAIN OR ONLY CHAIN, DO THE FOLLOWING   */ 01498000
*               /*****************************************************/ 01499000
*               IF RPLCHN=EOC |             /* END OF CHAIN?         */ 01500000
*                  RPLCHN=OC THEN           /* ONLY CHAIN?           */ 01501000
         LA    @15,16                                              0554 01502000
         ALR   @15,RPLREG                                          0554 01503000
         CLI   RPLCHN(@15),X'20'                                   0554 01504000
         BE    @RT00554                                            0554 01505000
         CLI   RPLCHN(@15),X'10'                                   0554 01506000
         BNE   @RF00554                                            0554 01507000
@RT00554 DS    0H                                                  0555 01508000
*                 DO;                                              0555 01509000
*                   IF RETRYMSG='0'B THEN   /* NO RETRY MESSAGE SENT?   01510000
*                                                            @ZM21462*/ 01511000
         TM    RETRYMSG(TOMWREG),B'00001000'                       0556 01512000
         BNZ   @RF00556                                            0556 01513000
*                     RETRY = 0;            /* RESET RETRY COUNT     */ 01514000
         MVI   RETRY(TOMWREG),X'00'                                0557 01515000
*                   ELSE                    /* RETRY MESSAGE SENT  0558 01516000
*                                                            @ZM21462*/ 01517000
*                     RETRYMSG='0'B;        /* RESET RETRY-MESSAGE 0558 01518000
*                                              FLAG          @ZM21462*/ 01519000
*                                                                  0558 01520000
         B     @RC00556                                            0558 01521000
@RF00556 NI    RETRYMSG(TOMWREG),B'11110111'                       0558 01522000
*                   /*************************************************/ 01523000
*                   /* IF TPUT-HOLD, CALL POST ROUTINE.              */ 01524000
*                   /*************************************************/ 01525000
*                   IF HLD = '1'B THEN      /* TPUT HOLD?            */ 01526000
@RC00556 TM    HLD(TOMWREG),B'01000000'                            0559 01527000
         BNO   @RF00559                                            0559 01528000
*                     CALL POSTROUT;        /* CALL POST ROUTINE     */ 01529000
         BAL   @14,POSTROUT                                        0560 01530000
*                   ELSE;                   /* NOT HOLD SITUATION    */ 01531000
*                                                                  0561 01532000
@RF00559 DS    0H                                                  0562 01533000
*                   /*************************************************/ 01534000
*                   /* IF NO MESSAGE FROM THE QUEUE WAS PROCESSED,   */ 01535000
*                   /* SKIP THE FOLLOWING.                           */ 01536000
*                   /*************************************************/ 01537000
*                   IF SKIP = '1'B THEN;    /* SKIP THE FOLLOWING?   */ 01538000
         TM    SKIP(TOMWREG),B'00000010'                           0562 01539000
         BO    @RT00562                                            0562 01540000
*                   ELSE                    /* DO THE FOLLOWING      */ 01541000
*                     DO;                   /* DELETE MESSAGE(S)     */ 01542000
*                                                                  0564 01543000
*                       /*********************************************/ 01544000
*                       /* DELETE MESSAGE(S) FROM THE QUEUE.         */ 01545000
*                       /*********************************************/ 01546000
*                       OPREQ = DELETO;     /* DELETE MSG FROM QUEUE */ 01547000
         MVI   OPREQ(TOMWREG),X'03'                                0565 01548000
*                       CALL IKTQMOUT(OPARMS);                     0566 01549000
*                                                                  0566 01550000
         LA    @15,OPARMS(,TOMWREG)                                0566 01551000
         ST    @15,@AL00001                                        0566 01552000
         L     @01,CVTPTR                                          0566 01553000
         L     @01,CVTTCASP(,@01)                                  0566 01554000
         L     @15,TCASOQM(,@01)                                   0566 01555000
         LA    @01,@AL00001                                        0566 01556000
         BALR  @14,@15                                             0566 01557000
*                       /*********************************************/ 01558000
*                       /* IF MORE MESSAGES LEFT ON THE QUEUE,       */ 01559000
*                       /* LEAVE MESSAGE SWITCH ON.                  */ 01560000
*                       /* OTHERWISE, TURN OFF MESSAGE SWITCH.       */ 01561000
*                       /*********************************************/ 01562000
*                       IF OPRC=MORQMSGS THEN;                     0567 01563000
         CLI   OPRC(TOMWREG),1                                     0567 01564000
         BE    @RT00567                                            0567 01565000
*                                           /* MORE MESSAGE ON QUEUE?*/ 01566000
*                       ELSE                /* NO MESSAGE ON QUEUE   */ 01567000
*                         DO;               /* TURN OFF SWITCHES     */ 01568000
*                           MSG = '0'B;     /* NO MESSAGE LEFT       */ 01569000
         NI    MSG(TOMWREG),B'11111011'                            0570 01570000
*                           MOR = '0'B;     /* NO MESSAGE LEFT       */ 01571000
         NI    MOR(TOMWREG),B'01111111'                            0571 01572000
*                         END;              /* SWITCHES TURNED OFF   */ 01573000
*                     END;                  /* END MESSAGE DELETION  */ 01574000
*                                                                  0573 01575000
*                 END;                      /* END EOC-OC PROCESSING */ 01576000
*                                                                  0574 01577000
*               ELSE;                       /* BOC-MOC SITUATION     */ 01578000
*                                                                  0575 01579000
@RF00554 DS    0H                                                  0576 01580000
*           END BLDEND;                     /* END OF BLDEND         */ 01581000
@EL00006 DS    0H                                                  0576 01582000
@EF00006 DS    0H                                                  0576 01583000
@ER00006 L     @14,@SA00006                                        0576 01584000
         BR    @14                                                 0576 01585000
         EJECT                                                          01586000
*FIN:       PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0577 01587000
*                                                                  0577 01588000
FIN      ST    @14,@SA00007                                        0577 01589000
*           /*********************************************************/ 01590000
*           /*                                                       */ 01591000
*           /* PROCEDURE - FIN                                       */ 01592000
*           /*                                                       */ 01593000
*           /* FUNCTION - IF CHAINING PROCESS NEEDS TO BE HALTED,    */ 01594000
*           /*            (A) CHECK IF CURRENT CHAIN NEEDS TO BE     */ 01595000
*           /*                CANCELED,                              */ 01596000
*           /*            (B) CHECK IF PARTIAL MESSAGE (DUE TO       */ 01597000
*           /*                BREAK-IN) NEEDS TO BE SENT BACK TO THE */ 01598000
*           /*                TERMINAL, AND                          */ 01599000
*           /*            (C) CALL CHANGE-DIRECTION ROUTINE IF       */ 01600000
*           /*                THERE IS NO PARTIAL MESSAGE.           */ 01601000
*           /*                                                       */ 01602000
*           /*********************************************************/ 01603000
*                                                                  0578 01604000
*           /*********************************************************/ 01605000
*           /* IF BUILD-CHAIN PROCESS IS TO BE REPEATED,             */ 01606000
*           /* OMIT THE FOLLOWING.                                   */ 01607000
*           /*********************************************************/ 01608000
*           IF AGAIN = '1'B THEN;     /* NOT FINAL PROCESSING?       */ 01609000
         TM    AGAIN(TOMWREG),B'00000001'                          0578 01610000
         BO    @RT00578                                            0578 01611000
*           ELSE                      /* FINAL PROCESSING            */ 01612000
*             DO;                     /* BEGIN FINAL PROCESSING      */ 01613000
*                                                                  0580 01614000
*               /*****************************************************/ 01615000
*               /* CHECK IF CURRENT CHAIN NEEDS TO BE CANCELED.      */ 01616000
*               /*****************************************************/ 01617000
*               CALL CHKOCEOC;        /* CANCEL CHAIN IF NECESSARY   */ 01618000
*                                                                  0581 01619000
         BAL   @14,CHKOCEOC                                        0581 01620000
*               /*****************************************************/ 01621000
*               /* IF BREAK-IN HAS OCCURRED, CALL BREAK-MESSAGE      */ 01622000
*               /* ROUTINE.                                          */ 01623000
*               /*****************************************************/ 01624000
*               SIGSENT = '0'B;       /* RESET SIGNAL SWITCH         */ 01625000
         NI    SIGSENT(TOMWREG),B'11101111'                        0582 01626000
*               IF TVWABKMG='1'B THEN /* BREAK IN OCCURRED?          */ 01627000
         TM    TVWABKMG(TVWAREG),B'00000100'                       0583 01628000
         BNO   @RF00583                                            0583 01629000
*                 CALL BKMGROUT;      /* HANDLE BREAK-IN SITUATION   */ 01630000
         BAL   @14,BKMGROUT                                        0584 01631000
*               ELSE                                               0585 01632000
*                 /***************************************************/ 01633000
*                 /* IF CHANGE-DIRECTION HAS BEEN RECEIVED,          */ 01634000
*                 /* CALL CHANGE-DIRECTION ROUTINE.                  */ 01635000
*                 /***************************************************/ 01636000
*                 IF TVWASCD='1'B THEN /* CHANGE DIRECTION RECEIVED? */ 01637000
         B     @RC00583                                            0585 01638000
@RF00583 TM    TVWASCD(TVWAREG),B'00100000'                        0585 01639000
         BNO   @RF00585                                            0585 01640000
*                   CALL SCDROUT;     /* SEND SPACE-BACKSPACE        */ 01641000
         BAL   @14,SCDROUT                                         0586 01642000
*                 ELSE                /* NOTHING ELSE TO PROCESS     */ 01643000
*                   TSBIFLSH = '0'B;  /* TURN OFF TSBIFLSH SWITCH    */ 01644000
*                                                                  0587 01645000
         B     @RC00585                                            0587 01646000
@RF00585 NI    TSBIFLSH(TSBREG),B'11110111'                        0587 01647000
*             END;                    /* END OF PROCESSING           */ 01648000
*                                                                  0588 01649000
*           END FIN;                  /* END OF FIN                  */ 01650000
@EL00007 DS    0H                                                  0589 01651000
@EF00007 DS    0H                                                  0589 01652000
@ER00007 L     @14,@SA00007                                        0589 01653000
         BR    @14                                                 0589 01654000
         EJECT                                                          01655000
*CHKOCEOC:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0590 01656000
*                                                                  0590 01657000
CHKOCEOC ST    @14,@SA00008                                        0590 01658000
*           /*********************************************************/ 01659000
*           /*                                                       */ 01660000
*           /* PROCEDURE - CHKOCEOC                                  */ 01661000
*           /*                                                       */ 01662000
*           /* FUNCTION - TO CANCEL CHAIN IF THE LAST CHAIN-ELEMENT  */ 01663000
*           /*            SENT WAS A BEGINNING-OF-CHAIN OR A         */ 01664000
*           /*            MIDDLE-OF-CHAIN.                           */ 01665000
*           /*                                                       */ 01666000
*           /*********************************************************/ 01667000
*                                                                  0591 01668000
*           IF RPLCHN = BOC |              /* BEGINNING OF CHAIN?    */ 01669000
*              RPLCHN=MOC THEN             /* MIDDLE OF CHAIN?       */ 01670000
         LA    @15,16                                              0591 01671000
         ALR   @15,RPLREG                                          0591 01672000
         CLI   RPLCHN(@15),X'80'                                   0591 01673000
         BE    @RT00591                                            0591 01674000
         CLI   RPLCHN(@15),X'40'                                   0591 01675000
         BNE   @RF00591                                            0591 01676000
@RT00591 DS    0H                                                  0592 01677000
*             DO;                          /* CANCEL CHAIN           */ 01678000
*               RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;     01679000
*               MPSTSOIR='0'B;             /* RESET IWAIT SYSEVENT 0594 01680000
*                                             REQUEST FLAG           */ 01681000
*               MPSTSOIW='0'B;             /* RESET IWAIT SYSEVENT 0595 01682000
*                                             FLAG                   */ 01683000
         L     @04,PSAAOLD                                         0595 01684000
         L     @04,ASCBASXB(,@04)                                  0595 01685000
         L     @04,ASXBMPST(,@04)                                  0595 01686000
         NI    MPSTSOIR(@04),B'00111111'                           0595 01687000
*               WRK2 = ADDR(IFGRPL);       /* RPL ADDRESS            */ 01688000
         LR    WRK2,RPLREG                                         0596 01689000
*               RPLCHN = OC;               /* USE ONLY CHAIN @ZM20858*/ 01690000
         MVI   RPLCHN+16(RPLREG),X'10'                             0597 01691000
*               GENERATE REFS(FRRPTR,FRRS,FRRSCURR,FRRSLAST,FRRSELEN,   01692000
*                             FRRSFRRA,FRRSENTR,FRRSPARM,PSA,PSACSTK,   01693000
*                             PSALSFCC,PSALITA,FLC)                0598 01694000
*                        SETS(WRK2,WRK3,REGPARM,REG1,REG13,REG14,  0598 01695000
*                             REG15);                              0598 01696000
*                                                                  0598 01697000
       SETLOCK RELEASE,                                               CC01698000
               TYPE=LOCAL,                                            CC01699000
               REGS=USE,                                              CC01700000
               RELATED=(RPL)                                            01701000
       SEND    RPL=(WRK2),                                            CC01702000
               CONTROL=CANCEL                                           01703000
       SETFRR  A,FRRAD=(FRRPTR),PARMAD=(REGPARM),WRKREGS=(WRK2,WRK3)    01704000
       SETLOCK OBTAIN,                                                CC01705000
               TYPE=LOCAL,                                            CC01706000
               MODE=UNCOND,                                           CC01707000
               REGS=USE,                                              CC01708000
               RELATED=(RPL)                                            01709000
*               FRRPARM=REGPARM;           /* SAVE ADDRESS OF      0599 01710000
*                                              PARAMETER AREA      0599 01711000
*                                              PROVIDED BY         0599 01712000
*                                              SETFRR MACRO  @ZM20856*/ 01713000
         ST    REGPARM,FRRPARM                                     0599 01714000
*               RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) UNRSTD;   01715000
*                                                                  0600 01716000
*               CALL INITFRR;              /* CALL FRR INIT  @ZM20856*/ 01717000
         BAL   @14,INITFRR                                         0601 01718000
*               AGAIN = '1'B;              /* CONTINUE CHAINING      */ 01719000
*               MSG = '1'B;                /* POSSIBLY MSG ON QUEUE  */ 01720000
         OI    AGAIN(TOMWREG),B'00000101'                          0603 01721000
*             END;                         /* CHAIN CANCELED         */ 01722000
*           ELSE;                          /* CHAIN ALREADY ENDED    */ 01723000
*                                                                  0605 01724000
@RF00591 DS    0H                                                  0606 01725000
*           MOR = '0'B;                    /* END OF MESSAGE         */ 01726000
         NI    MOR(TOMWREG),B'01111111'                            0606 01727000
*           SPEC = '0'B;                   /* NOT SPECIAL CONDITION  */ 01728000
*           SENDPRMT = '0'B;               /* RESET SEND-PROMPT SW   */ 01729000
*           NOTNOW = '0'B;                 /* RESET SWITCH           */ 01730000
         NI    SPEC(TOMWREG),B'11010011'                           0609 01731000
*           RPLCHN = OC;                   /* RESET CHAIN ELEMENT    */ 01732000
         MVI   RPLCHN+16(RPLREG),X'10'                             0610 01733000
*           CHAINSZE=TVWACHNL;             /* RESET CHAIN SIZE       */ 01734000
         IC    @15,TVWACHNL(,TVWAREG)                              0611 01735000
         STC   @15,CHAINSZE(,TOMWREG)                              0611 01736000
*           RUCOUNT=CHAINSZE;              /* RESET RU COUNT         */ 01737000
*                                                                  0612 01738000
         IC    @15,CHAINSZE(,TOMWREG)                              0612 01739000
         STC   @15,RUCOUNT(,TOMWREG)                               0612 01740000
*           END CHKOCEOC;                  /* END OF CHKOCEOC        */ 01741000
@EL00008 DS    0H                                                  0613 01742000
@EF00008 DS    0H                                                  0613 01743000
@ER00008 L     @14,@SA00008                                        0613 01744000
         BR    @14                                                 0613 01745000
         EJECT                                                          01746000
*ATTNROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0614 01747000
*                                                                  0614 01748000
ATTNROUT ST    @14,12(,@13)                                        0614 01749000
*           /*********************************************************/ 01750000
*           /*                                                       */ 01751000
*           /* PROCEDURE - ATTNROUT                                  */ 01752000
*           /*                                                       */ 01753000
*           /* FUNCTION - TO MOVE ATTENTION AND ATTENTION-IGNORED    */ 01754000
*           /*            COMBINATIONS INTO THE RU.                  */ 01755000
*           /*            THE ATTENTION COUNTER (TVWAATTN) AND THE   */ 01756000
*           /*            ATTENTION-IGNORED INDICATOR (TVWAAIGN) ARE */ 01757000
*           /*            SET BY IKTTIMRT.  FOR EACH ATTENTION COUNT,*/ 01758000
*           /*            THE EXCLAMATION-POINT CHARACTER (X'5A')    */ 01759000
*           /*            AND THE SCS NEW-LINE CHARACTER (X'15') ARE */ 01760000
*           /*            MOVED INTO THE RU.  WHEN ATTENTION-IGNORED */ 01761000
*           /*            IS INDICATED, THE EXCLAMATION-POINT AND I  */ 01762000
*           /*            CHARACTERS (X'5AC9') AND THE SCS NEW-LINE  */ 01763000
*           /*            CHARACTER (X'15') ARE MOVED INTO THE RU.   */ 01764000
*           /*            SINCE THE RU CONSISTS OF A MAXIMUM OF 256  */ 01765000
*           /*            BYTES AND SINCE AN ATTENTION-IGNORED       */ 01766000
*           /*            COMBINATION (X'5AC914') REQUIRES 3 BYTES,  */ 01767000
*           /*            THERE CAN BE AT MOST 126 ATTENTION         */ 01768000
*           /*            COMBINATIONS (X'5A15') IN THE RU.  IF THE  */ 01769000
*           /*            ATTENTION COUNT IS GREATER THAN 126, AFTER */ 01770000
*           /*            126 ATTENTION COMBINATIONS HAVE BEEN MOVED */ 01771000
*           /*            INTO THE RU, THE ATTENTION COUNTER WILL BE */ 01772000
*           /*            SET TO ZERO.                               */ 01773000
*           /*                                                       */ 01774000
*           /*********************************************************/ 01775000
*                                                                  0615 01776000
*           IF TVWAATTN > 0 THEN        /* ATTENTION?                */ 01777000
         CLI   TVWAATTN(TVWAREG),0                                 0615 01778000
         BNH   @RF00615                                            0615 01779000
*             DO;                       /* DO ATTENTION PROCESSING   */ 01780000
*                                                                  0616 01781000
*               /*****************************************************/ 01782000
*               /* FOR EACH NONZERO ATTENTION COUNT BUT NO MORE      */ 01783000
*               /* THAN 126, MOVE THE EXCLAMATION-POINT CHARACTER    */ 01784000
*               /* FOLLOWED BY THE NEW-LINE CHARACTER INTO THE RU.   */ 01785000
*               /*****************************************************/ 01786000
*               TVWAATTN = MIN(TVWAATTN,126);                      0617 01787000
         SLR   @15,@15                                             0617 01788000
         IC    @15,TVWAATTN(,TVWAREG)                              0617 01789000
         LA    @14,126                                             0617 01790000
         CR    @15,@14                                             0617 01791000
         BNH   *+6                                                      01792000
         LR    @15,@14                                             0617 01793000
         STC   @15,TVWAATTN(,TVWAREG)                              0617 01794000
*               DO I=1 TO TVWAATTN;                                0618 01795000
         LA    @15,1                                               0618 01796000
         B     @DE00618                                            0618 01797000
@DL00618 DS    0H                                                  0619 01798000
*                  RU(BYTECNT:BYTECNT+1) = '5A15'X;                0619 01799000
         L     @15,BYTECNT(,TOMWREG)                               0619 01800000
         ALR   @15,TOMWREG                                         0619 01801000
         MVC   RU-1(2,@15),@CB02826                                0619 01802000
*                  BYTECNT = BYTECNT + 2;                          0620 01803000
         L     @15,BYTECNT(,TOMWREG)                               0620 01804000
         AL    @15,@CF00076                                        0620 01805000
         ST    @15,BYTECNT(,TOMWREG)                               0620 01806000
*               END;                                               0621 01807000
*                                                                  0621 01808000
         LA    @15,1                                               0621 01809000
         AL    @15,I(,TOMWREG)                                     0621 01810000
@DE00618 ST    @15,I(,TOMWREG)                                     0621 01811000
         SLR   @14,@14                                             0621 01812000
         IC    @14,TVWAATTN(,TVWAREG)                              0621 01813000
         CR    @15,@14                                             0621 01814000
         BNH   @DL00618                                            0621 01815000
*               TVWAATTN = 0;           /* CLEAR ATTENTION COUNTER.  */ 01816000
         MVI   TVWAATTN(TVWAREG),X'00'                             0622 01817000
*             END;                      /* END ATTENTION PROCESSING  */ 01818000
*           ELSE;                       /* NOT ATTENTION SITUATION   */ 01819000
*                                                                  0624 01820000
@RF00615 DS    0H                                                  0625 01821000
*           IF TVWAAIGN = '1'B THEN     /* ATTENTION IGNORED?        */ 01822000
*                                                                  0625 01823000
         TM    TVWAAIGN(TVWAREG),B'00100000'                       0625 01824000
         BNO   @RF00625                                            0625 01825000
*             /*******************************************************/ 01826000
*             /* MOVE THE EXCLAMATION-POINT AND I CHARACTERS FOLLOWED*/ 01827000
*             /* BY THE SCS NEW-LINE CHARACTER TO THE RU.  CLEAR THE */ 01828000
*             /* ATTENTION-IGNORED INDICATOR.                        */ 01829000
*             /*******************************************************/ 01830000
*                                                                  0626 01831000
*             DO;                       /* PROCESS ATTENTION-IGNORED */ 01832000
*               RU(BYTECNT:BYTECNT+2) = '5AC915'X;                 0627 01833000
         L     @15,BYTECNT(,TOMWREG)                               0627 01834000
         ALR   @15,TOMWREG                                         0627 01835000
         MVC   RU-1(3,@15),@CB02827                                0627 01836000
*               BYTECNT = BYTECNT + 3;  /* UPDATE BYTE POSITION      */ 01837000
         L     @15,BYTECNT(,TOMWREG)                               0628 01838000
         AL    @15,@CF00291                                        0628 01839000
         ST    @15,BYTECNT(,TOMWREG)                               0628 01840000
*               TVWAAIGN = '0'B;        /* RESET IGNORED SWITCH      */ 01841000
         NI    TVWAAIGN(TVWAREG),B'11011111'                       0629 01842000
*             END;                      /* END PROCESSING            */ 01843000
*                                                                  0630 01844000
*           ELSE;                       /* NOT ATTENTION-IGNORED     */ 01845000
*                                                                  0631 01846000
@RF00625 DS    0H                                                  0632 01847000
*           END ATTNROUT;               /* END OF ATTNROUT           */ 01848000
@EL00009 DS    0H                                                  0632 01849000
@EF00009 DS    0H                                                  0632 01850000
@ER00009 L     @14,12(,@13)                                        0632 01851000
         BR    @14                                                 0632 01852000
         EJECT                                                          01853000
*EDITMSG:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0633 01854000
*                                                                  0633 01855000
EDITMSG  ST    @14,@SA00010                                        0633 01856000
*           /*********************************************************/ 01857000
*           /*                                                       */ 01858000
*           /* PROCEDURE - EDITMSG                                   */ 01859000
*           /*                                                       */ 01860000
*           /* FUNCTION - TO EDIT MESSAGE AND PLACE THE RESULT INTO  */ 01861000
*           /*            THE RU.                                    */ 01862000
*           /*                                                       */ 01863000
*           /*********************************************************/ 01864000
*                                                                  0634 01865000
*           BUFPTR = OPBUFADR;             /* ADDRESS OF MESSAGE     */ 01866000
         L     @15,OPBUFADR(,TOMWREG)                              0634 01867000
         ST    @15,BUFPTR(,TOMWREG)                                0634 01868000
*           SIZE =  OPBFSZ;                /* SIZE OF MESSAGE        */ 01869000
*                                                                  0635 01870000
         LH    @15,OPBFSZ(,TOMWREG)                                0635 01871000
         ST    @15,SIZE(,TOMWREG)                                  0635 01872000
*           /*********************************************************/ 01873000
*           /* IF START-WITH-NEW-LINE-CHARACTER IS INDICATED,        */ 01874000
*           /* PLACE ADD NEW-LINE CHARACTER INTO THE RU.             */ 01875000
*           /*********************************************************/ 01876000
*           IF SWNL = '1'B THEN            /* NEW-LINE SITUATION?    */ 01877000
         TM    SWNL(TOMWREG),B'01000000'                           0636 01878000
         BNO   @RF00636                                            0636 01879000
*             DO;                          /* BEGIN NL PROCESSING    */ 01880000
*               SWNL = '0'B;               /* RESET NEW-LINE SWITCH  */ 01881000
         NI    SWNL(TOMWREG),B'10111111'                           0638 01882000
*               RU(BYTECNT) = NL;          /* NEXT LINE              */ 01883000
         L     @15,BYTECNT(,TOMWREG)                               0639 01884000
         ALR   @15,TOMWREG                                         0639 01885000
         MVC   RU-1(1,@15),NL                                      0639 01886000
*               BYTECNT = BYTECNT + 1;     /* NEXT BYTE POSITION     */ 01887000
         L     @15,BYTECNT(,TOMWREG)                               0640 01888000
         AL    @15,@CF00064                                        0640 01889000
         ST    @15,BYTECNT(,TOMWREG)                               0640 01890000
*             END;                         /* END NL PROCESSING      */ 01891000
*           ELSE;                          /* NOT NEW-LINE SITUATION */ 01892000
*                                                                  0642 01893000
@RF00636 DS    0H                                                  0643 01894000
*           /*********************************************************/ 01895000
*           /* IF THERE IS AN INSTALLATION EXIT FOR EDITING,         */ 01896000
*           /* ADDR(IKTRTX1) WILL NOT BE ZERO.  THE INSTALLATION     */ 01897000
*           /* EXIT EDIT ROUTINE WILL RETURN A ZERO RETURN CODE IF   */ 01898000
*           /* NORMAL EDITING IS TO BE PERFORMED.                    */ 01899000
*           /*********************************************************/ 01900000
*                                                                  0643 01901000
*           RFY REG0 RSTD;                 /* RESTRICT REGISTER 0    */ 01902000
*           IF ADDR(IKTRTX1) = 0 THEN      /* NO USER EXIT?          */ 01903000
         L     @01,@CV02710                                        0644 01904000
         LTR   @01,@01                                             0644 01905000
         BNZ   @RF00644                                            0644 01906000
*             NORMEDIT = '1'B;             /* DO NORMAL EDIT         */ 01907000
         OI    NORMEDIT(TOMWREG),B'00100000'                       0645 01908000
*           ELSE                           /* INSTALLATION EXIT      */ 01909000
*             DO;                          /* DO THE FOLLOWING       */ 01910000
         B     @RC00644                                            0646 01911000
@RF00644 DS    0H                                                  0647 01912000
*               REG0 = ADDR(OPARMSA);      /* PARAMETER LIST ADDRESS */ 01913000
         LA    REG0,OPARMSA(,TOMWREG)                              0647 01914000
*               OPARMSA = ADDR(OPARMS);    /* OPARMS ADDRESS         */ 01915000
         LA    @01,OPARMS(,TOMWREG)                                0648 01916000
         ST    @01,OPARMSA(,TOMWREG)                               0648 01917000
*               BYTECNTA = ADDR(BYTECNT);  /* BYTECNT ADDRESS        */ 01918000
         LA    @01,BYTECNT(,TOMWREG)                               0649 01919000
         ST    @01,BYTECNTA(,TOMWREG)                              0649 01920000
*               BUFPTRA = ADDR(BUFPTR);    /* BUFPTR ADDRESS         */ 01921000
         LA    @01,BUFPTR(,TOMWREG)                                0650 01922000
         ST    @01,BUFPTRA(,TOMWREG)                               0650 01923000
*               RUADDR = ADDR(RU);         /* RU ADDRESS             */ 01924000
         LA    @01,RU(,TOMWREG)                                    0651 01925000
         ST    @01,RUADDR(,TOMWREG)                                0651 01926000
*               CHARCNTA = ADDR(CHARCNT);  /* CHARCNT ADDRESS        */ 01927000
         LA    @01,CHARCNT(,TOMWREG)                               0652 01928000
         ST    @01,CHARCNTA(,TOMWREG)                              0652 01929000
*               BITVALA = ADDR(BITVALU0);  /* BITVALU0 ADDRESS       */ 01930000
         LA    @01,BITVALU0(,TOMWREG)                              0653 01931000
         ST    @01,BITVALA(,TOMWREG)                               0653 01932000
*               LASTPARM = '8'X;           /* LAST PARAMETER         */ 01933000
         LA    @01,8                                               0654 01934000
         STC   @01,LASTPARM(,TOMWREG)                              0654 01935000
*               TSBADDR = ASCBTSB;         /* TSB ADDRESS            */ 01936000
         L     @01,PSAAOLD                                         0655 01937000
         MVC   TSBADDR(3,TOMWREG),ASCBTSB+1(@01)                   0655 01938000
*               CALL IKTRTX1;              /* CALL INSTALLATION EXIT */ 01939000
         L     @15,@CV02710                                        0656 01940000
         BALR  @14,@15                                             0656 01941000
*               RFY RTNCDE RSTD;           /* RESTRICT CODE REGISTER */ 01942000
*               IF RTNCDE = 0 THEN         /* DO NORMAL EDIT?        */ 01943000
         LTR   RTNCDE,RTNCDE                                       0658 01944000
         BNZ   @RF00658                                            0658 01945000
*                 NORMEDIT = '1'B;         /* DO NORMAL EDIT         */ 01946000
         OI    NORMEDIT(TOMWREG),B'00100000'                       0659 01947000
*               ELSE                       /* NOT NORMAL EDIT CASE   */ 01948000
*                 NORMEDIT = '0'B;         /* DO NOT DO NORMAL EDIT  */ 01949000
         B     @RC00658                                            0660 01950000
@RF00658 NI    NORMEDIT(TOMWREG),B'11011111'                       0660 01951000
*               RFY RTNCDE UNRSTD;         /* UNRESTRICT CODE REG    */ 01952000
@RC00658 DS    0H                                                  0662 01953000
*             END;                         /* END OF USER EXIT       */ 01954000
*           RFY REG0 UNRSTD;               /* UNRESTRICT REGISTER 0  */ 01955000
@RC00644 DS    0H                                                  0664 01956000
*           IF NORMEDIT = '1'B THEN        /* DO NORMAL EDIT?        */ 01957000
         TM    NORMEDIT(TOMWREG),B'00100000'                       0664 01958000
         BNO   @RF00664                                            0664 01959000
*             /*******************************************************/ 01960000
*             /* IF CONTROL OPTION, CALL CNTRLOPT TO EDIT DATA AND   */ 01961000
*             /* PLACE THE RESULT INTO THE RU.                       */ 01962000
*             /*******************************************************/ 01963000
*             IF OPEDIT = '10'B THEN       /* CONTROL TPUT?          */ 01964000
         TM    OPEDIT(TOMWREG),B'00100000'                         0665 01965000
         BNO   @RF00665                                            0665 01966000
         TM    OPEDIT(TOMWREG),B'00010000'                         0665 01967000
         BNZ   @RF00665                                            0665 01968000
*               CALL CNTRLOPT;             /* CALL CONTROL ROUTINE   */ 01969000
         BAL   @14,CNTRLOPT                                        0666 01970000
*             ELSE                         /* NOT CONTROL OPTION     */ 01971000
*               DO;                        /* EDIT-ASIS OPTION       */ 01972000
         B     @RC00665                                            0667 01973000
@RF00665 DS    0H                                                  0668 01974000
*                 CALL EDITASIS;           /* CALL EDIT-ASIS ROUTINE */ 01975000
         BAL   @14,EDITASIS                                        0668 01976000
*                 /***************************************************/ 01977000
*                 /* IF THE LINE SIZE IS GREATER THAN OR EQUAL TO    */ 01978000
*                 /* 132, MOVE EDITED DATA INTO RU.                  */ 01979000
*                 /* OTHERWISE, CALL INSERTNL TO INSERT NEW-LINE     */ 01980000
*                 /* CHARACTERS INTO THE EDITED DATA AND TO MOVE THE */ 01981000
*                 /* RESULT INTO THE RU.                             */ 01982000
*                 /***************************************************/ 01983000
*                 IF TSBLNSZ >=  132 THEN  /* LINE SIZE >= 132?      */ 01984000
         CLI   TSBLNSZ(TSBREG),132                                 0669 01985000
         BL    @RF00669                                            0669 01986000
*                   /*************************************************/ 01987000
*                   /* MOVE DATA FROM THE WORKSPACE INTO THE RU.     */ 01988000
*                   /*************************************************/ 01989000
*                   DO;                    /* DO THE FOLLOWING       */ 01990000
*                     RU(BYTECNT:BYTECNT+LIMIT-1) = WKSP(1:LIMIT); 0671 01991000
         L     @15,BYTECNT(,TOMWREG)                               0671 01992000
         ALR   @15,TOMWREG                                         0671 01993000
         L     @14,LIMIT(,TOMWREG)                                 0671 01994000
         LR    @05,@14                                             0671 01995000
         BCTR  @05,0                                               0671 01996000
         EX    @05,@SM02999                                        0671 01997000
*                     BYTECNT=BYTECNT+LIMIT; /* INCREMENT RU POSITION*/ 01998000
         L     @15,BYTECNT(,TOMWREG)                               0672 01999000
         ALR   @15,@14                                             0672 02000000
         ST    @15,BYTECNT(,TOMWREG)                               0672 02001000
*                     IF SIZE = LIMIT THEN /* END OF MESSAGE?        */ 02002000
         C     @14,SIZE(,TOMWREG)                                  0673 02003000
         BNE   @RF00673                                            0673 02004000
*                       MOR = '0'B;        /* END OF MESSAGE         */ 02005000
         NI    MOR(TOMWREG),B'01111111'                            0674 02006000
*                     ELSE                 /* MIDDLE OF MESSAGE      */ 02007000
*                       DO;                /* UPDATE MESSAGE POINTER */ 02008000
         B     @RC00673                                            0675 02009000
@RF00673 DS    0H                                                  0676 02010000
*                         MOR = '1'B;      /* NOT END OF MESSAGE     */ 02011000
         OI    MOR(TOMWREG),B'10000000'                            0676 02012000
*                         BUFPTR = BUFPTR + LIMIT;                 0677 02013000
         L     @15,BUFPTR(,TOMWREG)                                0677 02014000
         AL    @15,LIMIT(,TOMWREG)                                 0677 02015000
         ST    @15,BUFPTR(,TOMWREG)                                0677 02016000
*                       END;               /* MESSAGE POINTER UPDATED*/ 02017000
*                     IF MOR = '0'B &      /* END OF MESSAGE?        */ 02018000
*                       (OPEDIT = '00'B |  /* EDIT TPUT?             */ 02019000
*                        OPBRK='1'B |      /* BREAK TPUT?            */ 02020000
*                        OPASID='1'B) THEN /* CROSS-MEMORY TPUT?     */ 02021000
@RC00673 TM    MOR(TOMWREG),B'10000000'                            0679 02022000
         BNZ   @RF00679                                            0679 02023000
         TM    OPEDIT(TOMWREG),B'00110000'                         0679 02024000
         BZ    @RT00679                                            0679 02025000
         TM    OPBRK(TOMWREG),B'01001000'                          0679 02026000
         BZ    @RF00679                                            0679 02027000
@RT00679 DS    0H                                                  0680 02028000
*                       SWNL = '1'B;       /* START ON NEW LINE      */ 02029000
         OI    SWNL(TOMWREG),B'01000000'                           0680 02030000
*                     ELSE;                /* REMAIN ON SAME LINE    */ 02031000
@RF00679 DS    0H                                                  0682 02032000
*                   END;                   /* EDITED DATA IN RU      */ 02033000
*                 ELSE                     /* LINE SIZE < 132        */ 02034000
*                   DO;                    /* DO NEW-LINE PROCESSING */ 02035000
         B     @RC00669                                            0683 02036000
@RF00669 DS    0H                                                  0684 02037000
*                     CALL INSERTNL;       /* INSERT NL CHARACTERS   */ 02038000
         BAL   @14,INSERTNL                                        0684 02039000
*                     IF MOR = '1'B THEN   /* MIDDLE OF MESSAGE?     */ 02040000
         TM    MOR(TOMWREG),B'10000000'                            0685 02041000
         BNO   @RF00685                                            0685 02042000
*                       BUFPTR = BUFPTR + I - 1;                   0686 02043000
         L     @15,BUFPTR(,TOMWREG)                                0686 02044000
         AL    @15,I(,TOMWREG)                                     0686 02045000
         BCTR  @15,0                                               0686 02046000
         ST    @15,BUFPTR(,TOMWREG)                                0686 02047000
*                     ELSE;                /* END OF MESSAGE         */ 02048000
@RF00685 DS    0H                                                  0688 02049000
*                   END;                   /* END NEW-LINE PROCESSING*/ 02050000
*               END;                       /* END NORMAL EDITING     */ 02051000
*           ELSE;                          /* NO NORMAL EDITING      */ 02052000
*                                                                  0690 02053000
@RF00664 DS    0H                                                  0691 02054000
*           END EDITMSG;                   /* END OF EDITMSG         */ 02055000
@EL00010 DS    0H                                                  0691 02056000
@EF00010 DS    0H                                                  0691 02057000
@ER00010 L     @14,@SA00010                                        0691 02058000
         BR    @14                                                 0691 02059000
         EJECT                                                          02060000
*CNTRLOPT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0692 02061000
*                                                                  0692 02062000
CNTRLOPT ST    @14,12(,@13)                                        0692 02063000
*           /*********************************************************/ 02064000
*           /*                                                       */ 02065000
*           /* PROCEDURE - CNTRLOPT                                  */ 02066000
*           /*                                                       */ 02067000
*           /* FUNCTION - TO EDIT MESSAGE ACCORDING TO THE CONTROL   */ 02068000
*           /*            OPTION AND TO PLACE THE RESULT INTO THE    */ 02069000
*           /*            RU.  ONLY BYPASS AND RESTORE CHARACTERS    */ 02070000
*           /*            ARE VALID.                                 */ 02071000
*           /*                                                       */ 02072000
*           /*********************************************************/ 02073000
*                                                                  0693 02074000
*           LIMIT = MIN(257-BYTECNT,SIZE); /* BYTES TO BE EDITED     */ 02075000
         LA    @15,257                                             0693 02076000
         SL    @15,BYTECNT(,TOMWREG)                               0693 02077000
         L     @14,SIZE(,TOMWREG)                                  0693 02078000
         CR    @15,@14                                             0693 02079000
         BNH   *+6                                                      02080000
         LR    @15,@14                                             0693 02081000
         ST    @15,LIMIT(,TOMWREG)                                 0693 02082000
*           I = 1;                         /* INITIALIZE INDEX       */ 02083000
         MVC   I(4,TOMWREG),@CF00064                               0694 02084000
*           DO WHILE(I <= LIMIT);                                  0695 02085000
         B     @DE00695                                            0695 02086000
@DL00695 DS    0H                                                  0696 02087000
*              IF BUFFER(I) = BYP |        /* BYPASS CHARACTER?      */ 02088000
*                 BUFFER(I) = RES THEN     /* RESTORE CHARACTER?     */ 02089000
         L     @15,I(,TOMWREG)                                     0696 02090000
         L     @14,BUFPTR(,TOMWREG)                                0696 02091000
         ALR   @15,@14                                             0696 02092000
         BCTR  @15,0                                               0696 02093000
         CLC   BUFFER(1,@15),BYP                                   0696 02094000
         BE    @RT00696                                            0696 02095000
         L     @15,I(,TOMWREG)                                     0696 02096000
         ALR   @14,@15                                             0696 02097000
         BCTR  @14,0                                               0696 02098000
         CLC   BUFFER(1,@14),RES                                   0696 02099000
         BNE   @RF00696                                            0696 02100000
@RT00696 DS    0H                                                  0697 02101000
*                DO;                       /* DO THE FOLLOWING       */ 02102000
*                  RU(BYTECNT)=BUFFER(I);  /* MOVE IN CONTROL CHAR.  */ 02103000
         L     @15,BYTECNT(,TOMWREG)                               0698 02104000
         ALR   @15,TOMWREG                                         0698 02105000
         L     @01,I(,TOMWREG)                                     0698 02106000
         L     @14,BUFPTR(,TOMWREG)                                0698 02107000
         ALR   @14,@01                                             0698 02108000
         BCTR  @14,0                                               0698 02109000
         MVC   RU-1(1,@15),BUFFER(@14)                             0698 02110000
*                  BYTECNT = BYTECNT + 1;  /* NEXT BYTE POSITION     */ 02111000
         L     @15,BYTECNT(,TOMWREG)                               0699 02112000
         AL    @15,@CF00064                                        0699 02113000
         ST    @15,BYTECNT(,TOMWREG)                               0699 02114000
*                END;                      /* CONTROL CHAR. IN RU    */ 02115000
*              ELSE;                       /* NOT CONTROL CHARACTER  */ 02116000
@RF00696 DS    0H                                                  0702 02117000
*              I = I + 1;                  /* NEXT BUFFER POSITION   */ 02118000
         LA    @15,1                                               0702 02119000
         AL    @15,I(,TOMWREG)                                     0702 02120000
         ST    @15,I(,TOMWREG)                                     0702 02121000
*           END;                           /* END OF SEARCH          */ 02122000
@DE00695 L     @15,LIMIT(,TOMWREG)                                 0703 02123000
         C     @15,I(,TOMWREG)                                     0703 02124000
         BNL   @DL00695                                            0703 02125000
*           BUFPTR = BUFPTR + LIMIT;       /* UPDATE BUFFER ADDRESS  */ 02126000
         L     @14,BUFPTR(,TOMWREG)                                0704 02127000
         ALR   @14,@15                                             0704 02128000
         ST    @14,BUFPTR(,TOMWREG)                                0704 02129000
*           IF SIZE = LIMIT THEN           /* END OF MESSAGE?        */ 02130000
         C     @15,SIZE(,TOMWREG)                                  0705 02131000
         BNE   @RF00705                                            0705 02132000
*             MOR = '0'B;                  /* END OF MESSAGE         */ 02133000
         NI    MOR(TOMWREG),B'01111111'                            0706 02134000
*           ELSE                           /* NOT END OF MESSAGE     */ 02135000
*             MOR = '1'B;                  /* NOT END OF MESSAGE     */ 02136000
         B     @RC00705                                            0707 02137000
@RF00705 OI    MOR(TOMWREG),B'10000000'                            0707 02138000
*           IF BYTECNT = 1 THEN            /* RU EMPTY?              */ 02139000
@RC00705 CLC   BYTECNT(4,TOMWREG),@CF00064                         0708 02140000
         BNE   @RF00708                                            0708 02141000
*             DO;                                                  0709 02142000
*               RU(1:2) = '4016'X;         /* SPACE AND BACKSPACE    */ 02143000
         MVC   RU(2,TOMWREG),@CB02804                              0710 02144000
*               BYTECNT = 3;               /* NEXT AVAILABLE BYTE    */ 02145000
         MVC   BYTECNT(4,TOMWREG),@CF00291                         0711 02146000
*             END;                                                 0712 02147000
*           ELSE;                          /* RU IS NOT EMPTY        */ 02148000
*                                                                  0713 02149000
@RF00708 DS    0H                                                  0714 02150000
*           END CNTRLOPT;                  /* END OF CNTRLOPT        */ 02151000
@EL00011 DS    0H                                                  0714 02152000
@EF00011 DS    0H                                                  0714 02153000
@ER00011 L     @14,12(,@13)                                        0714 02154000
         BR    @14                                                 0714 02155000
         EJECT                                                          02156000
*EDITASIS:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0715 02157000
*                                                                  0715 02158000
EDITASIS ST    @14,12(,@13)                                        0715 02159000
*    /****************************************************************/ 02160000
*    /*                                                              */ 02161000
*    /*        PROCEDURE - EDITASIS                                  */ 02162000
*    /*                                                              */ 02163000
*    /*        FUNCTION - TO MOVE AS MUCH OF THE MESSAGE (BUT NO     */ 02164000
*    /*                   MORE THAN THERE IS ROOM IN THE RU) INTO    */ 02165000
*    /*                   THE WORKSPACE AND TO EDIT ACCORDING TO THE */ 02166000
*    /*                   TPUT-ASIS OR THE TPUT-EDIT OPTION.    THE  */ 02167000
*    /*                   TPUT-FULLSCR OPTION IS TREATED AS A        */ 02168000
*    /*                   TPUT-ASIS OPTION.   FOR THE TPUT-EDIT      */ 02169000
*    /*                   OPTION, SET HORIZONTAL FORMAT AND SET      */ 02170000
*    /*                   VERTICAL FORMAT STRINGS ARE REPLACED BY    */ 02171000
*    /*                   COLONS (X'7A').                            */ 02172000
*    /*        NOTES - SET HORIZONTAL FORMAT IS X'2BC1', WHICH IS    */ 02173000
*    /*                FMT (=X'2B') CONCATENATED WITH THE CHARACTER  */ 02174000
*    /*                A (=X'C1').  SET VERTICAL FORMAT IS X'2BC2',  */ 02175000
*    /*                WHICH IS FMT (=X'2B') CONCATENATED WITH THE   */ 02176000
*    /*                CHARACTER B (=X'C2').  THE SET HORIZONTAL     */ 02177000
*    /*                (VERTICAL) FORMAT TWO-BYTE CODE IS FOLLOWED   */ 02178000
*    /*                BY A ONE-BYTE COUNT (CNT).  THE ONE-BYTE      */ 02179000
*    /*                COUNT (CNT) IS THE NUMBER OF BYTES TO THE END */ 02180000
*    /*                OF THE SET HORIZONTAL (VERTICAL) FORMAT       */ 02181000
*    /*                STRING, INCLUDING THE BYTE-COUNT.  IN         */ 02182000
*    /*                WHAT FOLLOWS, SHF (=X'C1') IS THE CHARACTER   */ 02183000
*    /*                A TO REPRESENT SET HORIZONTAL FORMAT AND SVF  */ 02184000
*    /*                (=X'C2') IS THE CHARACTER B TO REPRESENT SET  */ 02185000
*    /*                VERTICAL FORMAT.                              */ 02186000
*    /*                                                              */ 02187000
*    /*        SET HORIZONTAL/VERTICAL FORMAT:                       */ 02188000
*    /*                                                              */ 02189000
*    /*        *************************                   ********* */ 02190000
*    /*        *       *   A   *       *                   *       * */ 02191000
*    /*        * F M T *  O R  * C N T *      *  *  *      *       * */ 02192000
*    /*        *       *   B   *       *                   *       * */ 02193000
*    /*        *************************                   ********* */ 02194000
*    /*                         *                                 *  */ 02195000
*    /*                        *********       C N T       ********* */ 02196000
*    /*                         *                                 *  */ 02197000
*    /****************************************************************/ 02198000
*                                                                  0716 02199000
*           /*********************************************************/ 02200000
*           /* MOVE AS MUCH OF THE MESSAGE (BUT NO MORE THAN THERE   */ 02201000
*           /* IS ROOM IN THE RU) INTO THE WORKSPACE.  THE WORKSPACE */ 02202000
*           /* CONSISTS OF 256 BYTES.                                */ 02203000
*           /*********************************************************/ 02204000
*                                                                  0716 02205000
*           LIMIT = MIN(257-BYTECNT,SIZE);    /* BYTES TO BE EDITED  */ 02206000
         LA    @15,257                                             0716 02207000
         SL    @15,BYTECNT(,TOMWREG)                               0716 02208000
         L     @14,SIZE(,TOMWREG)                                  0716 02209000
         CR    @15,@14                                             0716 02210000
         BNH   *+6                                                      02211000
         LR    @15,@14                                             0716 02212000
         ST    @15,LIMIT(,TOMWREG)                                 0716 02213000
*           WKSP(1:LIMIT) = BUFFER(1:LIMIT);  /* MESSAGE IN WORKSPACE*/ 02214000
*                                                                  0717 02215000
         BCTR  @15,0                                               0717 02216000
         L     @01,BUFPTR(,TOMWREG)                                0717 02217000
         EX    @15,@SM03001                                        0717 02218000
*           /*********************************************************/ 02219000
*           /* L IS THE BYTE-POSITION OF THE LEFT-MOST BYTE THAT HAS */ 02220000
*           /* NOT BEEN TRANSLATED OR EDITED.                        */ 02221000
*           /* IF THERE IS AN FMT CHARACTER, THEN R IS THE POSITION  */ 02222000
*           /* OF THE FIRST OCCURRENCE OF THE CHARACTER FMT AFTER    */ 02223000
*           /* THE POSITION L.                                       */ 02224000
*           /*********************************************************/ 02225000
*                                                                  0718 02226000
*           L = 1;                            /* INIT. LEFT POSITION */ 02227000
         LA    @15,1                                               0718 02228000
         ST    @15,L(,TOMWREG)                                     0718 02229000
*           R = 1;                            /* INIT. RIGHT INDEX   */ 02230000
*                                                                  0719 02231000
         ST    @15,R(,TOMWREG)                                     0719 02232000
*           /*********************************************************/ 02233000
*           /* SEARCH FOR THE FIRST OCCURRENCE OF THE FMT CHARACTER. */ 02234000
*           /* IF AN FMT CHARACTER IS FOUND, TRANSLATE UP TO THE     */ 02235000
*           /* FMT CHARACTER USING EITHER THE EDITAB OR ASISTAB      */ 02236000
*           /* TABLE.  OTHERWISE, TRANSLATE TO THE END OF WHAT IS IN */ 02237000
*           /* THE WORKSPACE (WKSP).                                 */ 02238000
*           /* IF THE TPUT-EDIT OPTION IS BEING CONSIDERED, IF THE   */ 02239000
*           /* CHARACTER AFTER FMT IS NOT AN 'A' AND NOT A 'B', IF   */ 02240000
*           /* A FUNCTION ERROR HAS OCCURRED AND AN SVF IS BEING     */ 02241000
*           /* CONSIDERED, OR IF A PARAMETER ERROR HAS OCCURRED,     */ 02242000
*           /* THEN REPLACE THE FMT STRING WITH COLONS.  OTHERWISE,  */ 02243000
*           /* LEAVE THE FMT STRING INTACT.  HOWEVER, IF THE FMT     */ 02244000
*           /* CHARACTER OCCURS IN THE LAST POSITION OF THE MESSAGE, */ 02245000
*           /* REPLACE IT WITH A COLON, OR IF THE FMT CHARACTER      */ 02246000
*           /* OCCURS IN THE SECOND TO THE LAST POSITION OF THE      */ 02247000
*           /* MESSAGE, REPLACE THE LAST TWO BYTES WITH COLONS.      */ 02248000
*           /* REPEAT THE ABOVE-MENTIONED STEPS UNTIL EVERYTHING     */ 02249000
*           /* THAT IS IN THE WORKSPACE HAS BEEN EXAMINED.           */ 02250000
*           /*********************************************************/ 02251000
*           RFY (REG1,REG2) RSTD;             /* RESTRICT REGS. 1,2  */ 02252000
*           DO WHILE(R <= LIMIT);                                  0721 02253000
         B     @DE00721                                            0721 02254000
@DL00721 DS    0H                                                  0722 02255000
*             OUTOFRNG = '0'B;                /* OUT-OF-RANGE SWITCH */ 02256000
         NI    OUTOFRNG(TOMWREG),B'10111111'                       0722 02257000
*             REG1 = 0;                       /* CLEAR ADDRESS REG.  */ 02258000
         SLR   REG1,REG1                                           0723 02259000
*             TRT(WKSP(L:LIMIT),FMTTAB);      /* SEARCH FOR FMT CHAR.*/ 02260000
         L     @03,L(,TOMWREG)                                     0724 02261000
         ALR   @03,TOMWREG                                         0724 02262000
         L     @15,LIMIT(,TOMWREG)                                 0724 02263000
         SL    @15,L(,TOMWREG)                                     0724 02264000
         EX    @15,@SB03003                                        0724 02265000
*             BC(8,NOFMT);                    /* BRANCH IF NO FMT    */ 02266000
         BC    8,NOFMT                                             0725 02267000
*                 R = REG1 - ADDR(WKSP) + 1;  /* FMT CHAR. POSITION  */ 02268000
         LA    @03,WKSP(,TOMWREG)                                  0726 02269000
         LCR   @03,@03                                             0726 02270000
         ALR   @03,REG1                                            0726 02271000
         AL    @03,@CF00064                                        0726 02272000
         ST    @03,R(,TOMWREG)                                     0726 02273000
*                 IF R > L THEN               /* NOT AT BEGINNING?   */ 02274000
         L     @15,L(,TOMWREG)                                     0727 02275000
         CR    @03,@15                                             0727 02276000
         BNH   @RF00727                                            0727 02277000
*                   IF OPEDIT = '00'B THEN    /* EDIT TPUT?          */ 02278000
         TM    OPEDIT(TOMWREG),B'00110000'                         0728 02279000
         BNZ   @RF00728                                            0728 02280000
*                     TR(WKSP(L:R-1),EDITAB); /* TRANSLATE           */ 02281000
         ALR   @15,TOMWREG                                         0729 02282000
         L     @03,R(,TOMWREG)                                     0729 02283000
         SL    @03,L(,TOMWREG)                                     0729 02284000
         BCTR  @03,0                                               0729 02285000
         EX    @03,@SB03005                                        0729 02286000
*                   ELSE                      /* NOT EDIT TPUT       */ 02287000
*                     TR(WKSP(L:R-1),ASISTAB);                     0730 02288000
         B     @RC00728                                            0730 02289000
@RF00728 L     @03,L(,TOMWREG)                                     0730 02290000
         ALR   @03,TOMWREG                                         0730 02291000
         L     @15,R(,TOMWREG)                                     0730 02292000
         SL    @15,L(,TOMWREG)                                     0730 02293000
         BCTR  @15,0                                               0730 02294000
         EX    @15,@SB03007                                        0730 02295000
*                 ELSE;                       /* AT BEGINNING        */ 02296000
@RF00727 DS    0H                                                  0732 02297000
*                 CNT = WKSP(R+2);            /* PARAMETER COUNT     */ 02298000
@RC00727 L     @03,R(,TOMWREG)                                     0732 02299000
         SLR   @00,@00                                             0732 02300000
         IC    @00,WKSP+1(@03,TOMWREG)                             0732 02301000
         ST    @00,CNT(,TOMWREG)                                   0732 02302000
*                 IF CNT > 136 |              /* CHECK COUNT         */ 02303000
*                    CNT = 0 THEN             /* COUNT OUT OF RANGE? */ 02304000
         C     @00,@CF02846                                        0733 02305000
         BH    @RT00733                                            0733 02306000
         LTR   @00,@00                                             0733 02307000
         BNZ   @RF00733                                            0733 02308000
@RT00733 DS    0H                                                  0734 02309000
*                   DO;                       /* SET SWITCHES        */ 02310000
*                     OUTOFRNG = '1'B;        /* OUT OF RANGE        */ 02311000
         OI    OUTOFRNG(TOMWREG),B'01000000'                       0735 02312000
*                     CNT = 1;                /* RESET COUNT         */ 02313000
         MVC   CNT(4,TOMWREG),@CF00064                             0736 02314000
*                   END;                      /* SWITCHES SET        */ 02315000
*                 ELSE;                       /* COUNT IS VALID      */ 02316000
@RF00733 DS    0H                                                  0739 02317000
*                 IF LIMIT >= (R+CNT+1) THEN  /* FMT STRING FITS?    */ 02318000
*                                                                  0739 02319000
         L     @03,R(,TOMWREG)                                     0739 02320000
         LR    @00,@03                                             0739 02321000
         AL    @00,CNT(,TOMWREG)                                   0739 02322000
         AL    @00,@CF00064                                        0739 02323000
         C     @00,LIMIT(,TOMWREG)                                 0739 02324000
         BH    @RF00739                                            0739 02325000
*                   /*************************************************/ 02326000
*                   /* IF THE EDIT OPTION IS IN EFFECT, IF THE       */ 02327000
*                   /* CHARACTER AFTER FMT IS NOT AN 'A' AND NOT     */ 02328000
*                   /* A 'B', IF A FUNCTION ERROR HAS OCCURRED AND   */ 02329000
*                   /* AN SVF IS BEING CONSIDERED, IF A PARAMETER    */ 02330000
*                   /* ERROR OCCURRED, OR IF A PARAMETER IS OUT OF   */ 02331000
*                   /* RANGE, REPLACE THE FMT STRING WITH COLONS.    */ 02332000
*                   /* OTHERWISE, LEAVE THE FMT STRING INTACT.       */ 02333000
*                   /*************************************************/ 02334000
*                   IF OPEDIT='00'B |         /* EDIT TPUT?          */ 02335000
*                     (WKSP(R+1)^=SHF &       /* NOT SHF?            */ 02336000
*                      WKSP(R+1)^=SVF) |      /* NOT SVF?            */ 02337000
*                     (FCNERR='1'B &          /* FUNCTION NOT      0740 02338000
*                                                SUPPORTED?          */ 02339000
*                      WKSP(R+1)=SVF) |       /* SVF?                */ 02340000
*                      PARMERR='1'B |         /* PARAMETER ERROR?    */ 02341000
*                      OUTOFRNG='1'B THEN     /* PARAMETER OUT OF  0740 02342000
*                                                RANGE?              */ 02343000
         TM    OPEDIT(TOMWREG),B'00110000'                         0740 02344000
         BZ    @RT00740                                            0740 02345000
         ALR   @03,TOMWREG                                         0740 02346000
         CLI   WKSP(@03),C'A'                                      0740 02347000
         BE    @GL00038                                            0740 02348000
         L     @03,R(,TOMWREG)                                     0740 02349000
         ALR   @03,TOMWREG                                         0740 02350000
         CLI   WKSP(@03),C'B'                                      0740 02351000
         BNE   @RT00740                                            0740 02352000
@GL00038 TM    FCNERR(TOMWREG),B'00100000'                         0740 02353000
         BNO   @GL00037                                            0740 02354000
         L     @03,R(,TOMWREG)                                     0740 02355000
         ALR   @03,TOMWREG                                         0740 02356000
         CLI   WKSP(@03),C'B'                                      0740 02357000
         BE    @RT00740                                            0740 02358000
@GL00037 TM    PARMERR(TOMWREG),B'00010000'                        0740 02359000
         BO    @RT00740                                            0740 02360000
         TM    OUTOFRNG(TOMWREG),B'01000000'                       0740 02361000
         BNO   @RF00740                                            0740 02362000
@RT00740 DS    0H                                                  0741 02363000
*                     DO;                     /* REPLACE FMT STRING  */ 02364000
*                       /*********************************************/ 02365000
*                       /* REPLACE FMT STRING WITH COLONS.           */ 02366000
*                       /*********************************************/ 02367000
*                       DO I=1 TO (CNT+2);                         0742 02368000
         LA    @03,1                                               0742 02369000
         B     @DE00742                                            0742 02370000
@DL00742 DS    0H                                                  0743 02371000
*                         WKSP(R) = COLON;    /* REPLACE WITH COLON  */ 02372000
         L     @03,R(,TOMWREG)                                     0743 02373000
         ALR   @03,TOMWREG                                         0743 02374000
         MVC   WKSP-1(1,@03),COLON                                 0743 02375000
*                         R = R + 1;          /* NEXT BYTE POSITION  */ 02376000
         L     @03,R(,TOMWREG)                                     0744 02377000
         AL    @03,@CF00064                                        0744 02378000
         ST    @03,R(,TOMWREG)                                     0744 02379000
*                       END;                                       0745 02380000
         LA    @03,1                                               0745 02381000
         AL    @03,I(,TOMWREG)                                     0745 02382000
@DE00742 ST    @03,I(,TOMWREG)                                     0745 02383000
         LA    @00,2                                               0745 02384000
         AL    @00,CNT(,TOMWREG)                                   0745 02385000
         CR    @03,@00                                             0745 02386000
         BNH   @DL00742                                            0745 02387000
*                       L = R;                /* RESET LEFT INDEX    */ 02388000
         L     @03,R(,TOMWREG)                                     0746 02389000
         ST    @03,L(,TOMWREG)                                     0746 02390000
*                     END;                    /* END OF REPLACEMENT  */ 02391000
*                   ELSE                      /* KEEP FMT STRING     */ 02392000
*                     /***********************************************/ 02393000
*                     /* LEAVE FMT STRING INTACT.                    */ 02394000
*                     /***********************************************/ 02395000
*                     DO;                     /* KEEP FMT STRING     */ 02396000
         B     @RC00740                                            0748 02397000
@RF00740 DS    0H                                                  0749 02398000
*                       R = R + CNT + 2;      /* INCREMENT BYTE POS. */ 02399000
         L     @03,R(,TOMWREG)                                     0749 02400000
         AL    @03,CNT(,TOMWREG)                                   0749 02401000
         AL    @03,@CF00076                                        0749 02402000
         ST    @03,R(,TOMWREG)                                     0749 02403000
*                       L = R;                /* RESET LEFT INDEX    */ 02404000
         ST    @03,L(,TOMWREG)                                     0750 02405000
*                     END;                    /* FMT STRING KEPT     */ 02406000
*                 ELSE                        /* FMT STRING TOO LARGE*/ 02407000
*                   /*************************************************/ 02408000
*                   /* IF PART OF FMT STRING IS MISSING,             */ 02409000
*                   /* REPLACE WITH COLONS.                          */ 02410000
*                   /* OTHERWISE, DO NOT CONSIDER FMT STRING AT      */ 02411000
*                   /* THIS TIME.                                    */ 02412000
*                   /*************************************************/ 02413000
*                   IF LIMIT = SIZE  THEN     /* FMT STRING INVALID? */ 02414000
         B     @RC00739                                            0752 02415000
@RF00739 CLC   LIMIT(4,TOMWREG),SIZE(TOMWREG)                      0752 02416000
         BNE   @RF00752                                            0752 02417000
*                     DO WHILE (R <= SIZE);                        0753 02418000
         B     @DE00753                                            0753 02419000
@DL00753 DS    0H                                                  0754 02420000
*                       WKSP(R) = COLON;      /* REPLACE WITH COLON  */ 02421000
         L     @03,R(,TOMWREG)                                     0754 02422000
         ALR   @03,TOMWREG                                         0754 02423000
         MVC   WKSP-1(1,@03),COLON                                 0754 02424000
*                       R = R + 1;            /* NEXT BYTE POSITION  */ 02425000
         L     @03,R(,TOMWREG)                                     0755 02426000
         AL    @03,@CF00064                                        0755 02427000
         ST    @03,R(,TOMWREG)                                     0755 02428000
*                     END;                                         0756 02429000
@DE00753 L     @03,R(,TOMWREG)                                     0756 02430000
         C     @03,SIZE(,TOMWREG)                                  0756 02431000
         BNH   @DL00753                                            0756 02432000
*                   ELSE                      /* FMT STRING VALID    */ 02433000
*                     LIMIT = R - 1;          /* CONSIDER LATER      */ 02434000
         B     @RC00752                                            0757 02435000
@RF00752 L     @03,R(,TOMWREG)                                     0757 02436000
         BCTR  @03,0                                               0757 02437000
         ST    @03,LIMIT(,TOMWREG)                                 0757 02438000
*             R = R - 1;                      /* RESET BYTE POSITION */ 02439000
@RC00752 DS    0H                                                  0758 02440000
@RC00739 L     @03,R(,TOMWREG)                                     0758 02441000
         BCTR  @03,0                                               0758 02442000
         ST    @03,R(,TOMWREG)                                     0758 02443000
*             BC(15,NEXT);                                         0759 02444000
         BC    15,NEXT                                             0759 02445000
*NOFMT:       R = LIMIT;                      /* NO FMT CHARACTER    */ 02446000
NOFMT    L     @03,LIMIT(,TOMWREG)                                 0760 02447000
         ST    @03,R(,TOMWREG)                                     0760 02448000
*                 IF OPEDIT = '00'B THEN      /* EDIT TPUT?          */ 02449000
         TM    OPEDIT(TOMWREG),B'00110000'                         0761 02450000
         BNZ   @RF00761                                            0761 02451000
*                   TR(WKSP(L:R),EDITAB);     /* TRANSLATE           */ 02452000
         L     @03,L(,TOMWREG)                                     0762 02453000
         ALR   @03,TOMWREG                                         0762 02454000
         L     @15,R(,TOMWREG)                                     0762 02455000
         SL    @15,L(,TOMWREG)                                     0762 02456000
         EX    @15,@SB03009                                        0762 02457000
*                 ELSE                        /* NOT EDIT TPUT       */ 02458000
*                   TR(WKSP(L:R),ASISTAB);    /* TRANSLATE           */ 02459000
         B     @RC00761                                            0763 02460000
@RF00761 L     @03,L(,TOMWREG)                                     0763 02461000
         ALR   @03,TOMWREG                                         0763 02462000
         L     @15,R(,TOMWREG)                                     0763 02463000
         SL    @15,L(,TOMWREG)                                     0763 02464000
         EX    @15,@SB03007                                        0763 02465000
*NEXT:          R = R + 1;                    /* NEXT BYTE POSITION  */ 02466000
*                                                                  0764 02467000
@RC00761 DS    0H                                                  0764 02468000
NEXT     LA    @03,1                                               0764 02469000
         AL    @03,R(,TOMWREG)                                     0764 02470000
         ST    @03,R(,TOMWREG)                                     0764 02471000
*           END;                                                   0765 02472000
@DE00721 L     @03,R(,TOMWREG)                                     0765 02473000
         C     @03,LIMIT(,TOMWREG)                                 0765 02474000
         BNH   @DL00721                                            0765 02475000
*           RFY (REG1,REG2) UNRSTD;           /* UNRESTRICT REGS. 1,2*/ 02476000
*           FCNERR = '0'B;                    /* RESET FUNCTION-NOT-    02477000
*                                                SUPPORTED SWITCH    */ 02478000
*           PARMERR = '0'B;                   /* RESET PARAMETER-ERROR  02479000
*                                                SWITCH              */ 02480000
*                                                                  0768 02481000
         NI    FCNERR(TOMWREG),B'11001111'                         0768 02482000
*           END EDITASIS;                     /* END OF EDITASIS     */ 02483000
@EL00012 DS    0H                                                  0769 02484000
@EF00012 DS    0H                                                  0769 02485000
@ER00012 L     @14,12(,@13)                                        0769 02486000
         BR    @14                                                 0769 02487000
         EJECT                                                          02488000
*TRANSL8:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0770 02489000
*                                                                  0770 02490000
TRANSL8  ST    @14,12(,@13)                                        0770 02491000
*           /*********************************************************/ 02492000
*           /*                                                       */ 02493000
*           /* PROCEDURE - TRANSL8                                   */ 02494000
*           /*                                                       */ 02495000
*           /* FUNCTION - TO TRANSLATE CONTENTS OF RU, USING EITHER  */ 02496000
*           /*            USER-TRANSLATE TABLE OR ASCII-TRANSLATE    */ 02497000
*           /*            TABLE.                                     */ 02498000
*           /*                                                       */ 02499000
*           /*********************************************************/ 02500000
*                                                                  0771 02501000
*IF BYTECNT=1 THEN              /* RU EMPTY?                @ZA19882 */ 02502000
         CLC   BYTECNT(4,TOMWREG),@CF00064                         0771 02503000
         BNE   @RF00771                                            0771 02504000
*  DO;                          /* YES, SET UP FOR NULL RU  @ZA19882 */ 02505000
*    RU(1:2)='4016'X;           /* SPACE-BACKSPACE          @ZA19882 */ 02506000
         MVC   RU(2,TOMWREG),@CB02804                              0773 02507000
*    BYTECNT=3;                 /* NEXT AVAILABLE BYTE      @ZA19882 */ 02508000
         MVC   BYTECNT(4,TOMWREG),@CF00291                         0774 02509000
*  END;                         /* END OF NULL RU SETUP     @ZA19882 */ 02510000
*ELSE;                          /* THE RU IS NOT EMPTY      @ZA19882 */ 02511000
@RF00771 DS    0H                                                  0777 02512000
*RFY (REG1,REG2) RSTD;          /* RESTRICT REGISTERS 1 & 2 @ZA19882 */ 02513000
*L=1;                           /* SET LEFT INDEX TO 1      @ZA19882 */ 02514000
         MVC   L(4,TOMWREG),@CF00064                               0778 02515000
*LIMIT=BYTECNT-1;               /* DATA LENGTH              @ZA19882 */ 02516000
         L     @03,BYTECNT(,TOMWREG)                               0779 02517000
         BCTR  @03,0                                               0779 02518000
         ST    @03,LIMIT(,TOMWREG)                                 0779 02519000
*DO WHILE (L<=LIMIT);           /* LOOP THROUGH DATA IN RU  @ZA19882 */ 02520000
         B     @DE00780                                            0780 02521000
@DL00780 DS    0H                                                  0781 02522000
*  R=LIMIT;                     /* SET THE RIGHT INDEX      @ZA19882 */ 02523000
         L     @03,LIMIT(,TOMWREG)                                 0781 02524000
         ST    @03,R(,TOMWREG)                                     0781 02525000
*  REG1=0;                      /* INITIALIZE REGISTER 1    @ZA19882 */ 02526000
         SLR   REG1,REG1                                           0782 02527000
*  REG2=0;                      /* INITIALIZE REGISTER 2    @ZA19882 */ 02528000
         SLR   REG2,REG2                                           0783 02529000
*  TRT(RU(L:R),CNTRLTAB);       /* SEARCH FOR CONTROL CHAR. @ZA19882 */ 02530000
         L     @03,L(,TOMWREG)                                     0784 02531000
         ALR   @03,TOMWREG                                         0784 02532000
         L     @15,R(,TOMWREG)                                     0784 02533000
         SL    @15,L(,TOMWREG)                                     0784 02534000
         EX    @15,@SB03011                                        0784 02535000
*  BC(8,NOCNTRLC);              /* BRANCH IF NO CNTL CHAR   @ZA19882 */ 02536000
         BC    8,NOCNTRLC                                          0785 02537000
*  R=REG1-ADDR(RU(L));          /* INDEX BEFORE CONTROL CHAR@ZA19882 */ 02538000
         L     @03,L(,TOMWREG)                                     0786 02539000
         LA    @00,RU-1(@03,TOMWREG)                               0786 02540000
         LCR   @00,@00                                             0786 02541000
         ALR   @00,REG1                                            0786 02542000
         ST    @00,R(,TOMWREG)                                     0786 02543000
*  IF L<=R THEN                 /* LEFT <= RIGHT INDEX?     @ZA19882 */ 02544000
         CR    @03,@00                                             0787 02545000
         BH    @RF00787                                            0787 02546000
*    DO;                        /* YES, BEGIN TRANS. CHECKS @ZA19882 */ 02547000
*NOCNTRLC:                                                         0789 02548000
*      IF TVWATRAN='1'B THEN    /* USER TRANSLATION?        @ZA19882 */ 02549000
NOCNTRLC TM    TVWATRAN(TVWAREG),B'00000010'                       0789 02550000
         BNO   @RF00789                                            0789 02551000
*        TR(RU(L:R),USRTRANS);  /* DO USER TRANSLATION      @ZA19882 */ 02552000
         L     @03,L(,TOMWREG)                                     0790 02553000
         ALR   @03,TOMWREG                                         0790 02554000
         L     @15,R(,TOMWREG)                                     0790 02555000
         SL    @15,L(,TOMWREG)                                     0790 02556000
         L     @14,TVWATABO(,TVWAREG)                              0790 02557000
         EX    @15,@SB03013                                        0790 02558000
*      ELSE;                    /* NOT USER TRANSLATION     @ZA19882 */ 02559000
@RF00789 DS    0H                                                  0792 02560000
*      IF TSBXASCI='1'B THEN    /* ASCII?                   @ZA19882 */ 02561000
         L     @03,TSBEXTNT(,TSBREG)                               0792 02562000
         TM    TSBXASCI(@03),B'10000000'                           0792 02563000
         BNO   @RF00792                                            0792 02564000
*        IF REG2=0 THEN         /* YES, AND NO CONTROL CHAR @ZA19882 */ 02565000
         LTR   REG2,REG2                                           0793 02566000
         BNZ   @RF00793                                            0793 02567000
*          TR(RU(L:R),ASCIITAB);/* TRANSLATE INTO ASCII     @ZA19882 */ 02568000
         L     @03,L(,TOMWREG)                                     0794 02569000
         ALR   @03,TOMWREG                                         0794 02570000
         L     @15,R(,TOMWREG)                                     0794 02571000
         SL    @15,L(,TOMWREG)                                     0794 02572000
         L     @14,TVWAATBO(,TVWAREG)                              0794 02573000
         EX    @15,@SB03015                                        0794 02574000
*        ELSE                   /* CONTROL CHARACTER        @ZA19882 */ 02575000
*          IF REG2=FMT THEN     /* FORMAT CHARACTER         @ZA19882 */ 02576000
         B     @RC00793                                            0795 02577000
@RF00793 SLR   @03,@03                                             0795 02578000
         IC    @03,FMT                                             0795 02579000
         CR    REG2,@03                                            0795 02580000
         BNE   @RF00795                                            0795 02581000
*            TR(RU(L:R+2),ASCIITAB); /* INCLUDE FMT A/B     @ZA19882 */ 02582000
         L     @03,L(,TOMWREG)                                     0796 02583000
         ALR   @03,TOMWREG                                         0796 02584000
         L     @15,R(,TOMWREG)                                     0796 02585000
         SL    @15,L(,TOMWREG)                                     0796 02586000
         AL    @15,@CF00076                                        0796 02587000
         L     @14,TVWAATBO(,TVWAREG)                              0796 02588000
         EX    @15,@SB03015                                        0796 02589000
*          ELSE                 /* NOT FORMAT CHARACTER     @ZA19882 */ 02590000
*            TR(RU(L:R+1),ASCIITAB); /* INCLUDE CNTL CHAR   @ZA19882 */ 02591000
         B     @RC00795                                            0797 02592000
@RF00795 L     @03,L(,TOMWREG)                                     0797 02593000
         ALR   @03,TOMWREG                                         0797 02594000
         L     @15,R(,TOMWREG)                                     0797 02595000
         SL    @15,L(,TOMWREG)                                     0797 02596000
         AL    @15,@CF00064                                        0797 02597000
         L     @14,TVWAATBO(,TVWAREG)                              0797 02598000
         EX    @15,@SB03015                                        0797 02599000
*      ELSE;                    /* NOT ASCII                @ZA19882 */ 02600000
@RF00792 DS    0H                                                  0799 02601000
*    END;                       /* END TRANSLATION CHECKS   @ZA19882 */ 02602000
*  ELSE;                        /* LEFT INDEX > RIGHT INDEX @ZA19882 */ 02603000
@RF00787 DS    0H                                                  0801 02604000
*  IF REG2=0 THEN               /* NO CONTROL CHAR FOUND?   @ZA19882 */ 02605000
@RC00787 LTR   REG2,REG2                                           0801 02606000
         BNZ   @RF00801                                            0801 02607000
*    L=L+R;                     /* INCLUDE END OF DATA      @ZA19882 */ 02608000
         L     @03,L(,TOMWREG)                                     0802 02609000
         AL    @03,R(,TOMWREG)                                     0802 02610000
         ST    @03,L(,TOMWREG)                                     0802 02611000
*  ELSE                         /* CONTROL CHAR. WAS FOUND  @ZA19882 */ 02612000
*    IF REG2=FMT THEN           /* FORMAT CHARACTER         @ZA19882 */ 02613000
         B     @RC00801                                            0803 02614000
@RF00801 SLR   @03,@03                                             0803 02615000
         IC    @03,FMT                                             0803 02616000
         CR    REG2,@03                                            0803 02617000
         BNE   @RF00803                                            0803 02618000
*      L=R+RU(R+3)+3;           /* INCLUDE FORMAT STRING    @ZA19882 */ 02619000
         L     @03,R(,TOMWREG)                                     0804 02620000
         SLR   @00,@00                                             0804 02621000
         IC    @00,RU+2(@03,TOMWREG)                               0804 02622000
         ALR   @00,@03                                             0804 02623000
         AL    @00,@CF00291                                        0804 02624000
         ST    @00,L(,TOMWREG)                                     0804 02625000
*    ELSE                       /* NOT FORMAT CHARACTER     @ZA19882 */ 02626000
*      L=R+2;                   /* INCLUDE CONTROL CHARACTER@ZA19882 */ 02627000
         B     @RC00803                                            0805 02628000
@RF00803 LA    @03,2                                               0805 02629000
         AL    @03,R(,TOMWREG)                                     0805 02630000
         ST    @03,L(,TOMWREG)                                     0805 02631000
*END;                           /* END OF TRANSLATION LOOP  @ZA19882 */ 02632000
@RC00803 DS    0H                                                  0806 02633000
@RC00801 DS    0H                                                  0806 02634000
@DE00780 L     @03,L(,TOMWREG)                                     0806 02635000
         C     @03,LIMIT(,TOMWREG)                                 0806 02636000
         BNH   @DL00780                                            0806 02637000
*RFY (REG1,REG2) UNRSTD;        /* FREE REGISTERS 1 & 2     @ZA19882 */ 02638000
*                                                                  0807 02639000
*END TRANSL8;                   /* END OF TRANSL8                    */ 02640000
@EL00013 DS    0H                                                  0808 02641000
@EF00013 DS    0H                                                  0808 02642000
@ER00013 L     @14,12(,@13)                                        0808 02643000
         BR    @14                                                 0808 02644000
         EJECT                                                          02645000
*INSERTNL:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0809 02646000
*                                                                  0809 02647000
INSERTNL ST    @14,12(,@13)                                        0809 02648000
*           /*********************************************************/ 02649000
*           /*                                                       */ 02650000
*           /* PROCEDURE - INSERTNL                                  */ 02651000
*           /*                                                       */ 02652000
*           /* FUNCTION - TO INSERT NEW-LINE CHARACTERS INTO THE     */ 02653000
*           /*            THE EDITED DATA AND TO PLACE THE RESULT    */ 02654000
*           /*            INTO THE RU.                               */ 02655000
*           /*                                                       */ 02656000
*           /*********************************************************/ 02657000
*                                                                  0810 02658000
*           I = 1;                             /* INITIALIZE INDEX   */ 02659000
*                                                                  0810 02660000
         MVC   I(4,TOMWREG),@CF00064                               0810 02661000
*           DO WHILE (BYTECNT < 257 & I <= LIMIT);                 0811 02662000
*                                                                  0811 02663000
         B     @DE00811                                            0811 02664000
@DL00811 DS    0H                                                  0812 02665000
*             IF WKSP(I) = FMT THEN            /* FMT CHARACTER?     */ 02666000
         L     @15,I(,TOMWREG)                                     0812 02667000
         ALR   @15,TOMWREG                                         0812 02668000
         CLC   WKSP-1(1,@15),FMT                                   0812 02669000
         BNE   @RF00812                                            0812 02670000
*               DO;                            /* PROCESS FMT STRING */ 02671000
*                 CNT = WKSP(I+2);             /* PARAMETER COUNT    */ 02672000
*                                                                  0814 02673000
         L     @15,I(,TOMWREG)                                     0814 02674000
         SLR   @14,@14                                             0814 02675000
         IC    @14,WKSP+1(@15,TOMWREG)                             0814 02676000
         ST    @14,CNT(,TOMWREG)                                   0814 02677000
*                 /***************************************************/ 02678000
*                 /* IF THE FMT-STRING FITS INTO THE RU,             */ 02679000
*                 /* MOVE THE FMT-STRING INTO THE RU.                */ 02680000
*                 /* OTHERWISE, DO NOT PROCESS THE FMT-STRING AT     */ 02681000
*                 /* THIS TIME.                                      */ 02682000
*                 /***************************************************/ 02683000
*                 IF BYTECNT+CNT+1 < 257 THEN  /* FMT STRING FITS?   */ 02684000
         LA    @05,1                                               0815 02685000
         L     @04,BYTECNT(,TOMWREG)                               0815 02686000
         LR    @03,@04                                             0815 02687000
         ALR   @03,@14                                             0815 02688000
         LR    @02,@03                                             0815 02689000
         ALR   @02,@05                                             0815 02690000
         C     @02,@CF02797                                        0815 02691000
         BNL   @RF00815                                            0815 02692000
*                   DO;                        /* PLACE STRING IN RU */ 02693000
*                     RU(BYTECNT:BYTECNT+CNT+1) = WKSP(I:I+CNT+1); 0817 02694000
         ALR   @04,TOMWREG                                         0817 02695000
         ALR   @05,@14                                             0817 02696000
         ALR   @15,TOMWREG                                         0817 02697000
         EX    @05,@SM03017                                        0817 02698000
*                     I = I + CNT + 2;         /* UPDATE INDEX       */ 02699000
         LA    @02,2                                               0818 02700000
         L     @15,I(,TOMWREG)                                     0818 02701000
         ALR   @15,@14                                             0818 02702000
         ALR   @15,@02                                             0818 02703000
         ST    @15,I(,TOMWREG)                                     0818 02704000
*                     BYTECNT=BYTECNT+CNT+2;   /* UPDATE RU POSITION */ 02705000
         ALR   @03,@02                                             0819 02706000
         ST    @03,BYTECNT(,TOMWREG)                               0819 02707000
*                     SIZE = SIZE - (CNT + 2); /* DECREMENT COUNTER  */ 02708000
         ALR   @14,@02                                             0820 02709000
         LCR   @14,@14                                             0820 02710000
         AL    @14,SIZE(,TOMWREG)                                  0820 02711000
         ST    @14,SIZE(,TOMWREG)                                  0820 02712000
*                   END;                       /* FMT STRING MOVED   */ 02713000
*                 ELSE                         /* FMT STRING TOO BIG */ 02714000
*                   LIMIT = I - 1;             /* EXCLUDE FMT STRING */ 02715000
*                                                                  0822 02716000
         B     @RC00815                                            0822 02717000
@RF00815 L     @15,I(,TOMWREG)                                     0822 02718000
         BCTR  @15,0                                               0822 02719000
         ST    @15,LIMIT(,TOMWREG)                                 0822 02720000
*               END;                           /* END OF FMT STRING  */ 02721000
*             ELSE                             /* NOT A FMT CHARACTER*/ 02722000
*               DO;                            /* PROCESS CHARACTER  */ 02723000
         B     @RC00812                                            0824 02724000
@RF00812 DS    0H                                                  0825 02725000
*                 RU(BYTECNT) = WKSP(I);       /* PLACE CHAR. IN RU  */ 02726000
         L     @15,BYTECNT(,TOMWREG)                               0825 02727000
         ALR   @15,TOMWREG                                         0825 02728000
         L     @14,I(,TOMWREG)                                     0825 02729000
         ALR   @14,TOMWREG                                         0825 02730000
         MVC   RU-1(1,@15),WKSP-1(@14)                             0825 02731000
*                 I = I + 1;                   /* NEXT INDEX POSITION*/ 02732000
         L     @15,I(,TOMWREG)                                     0826 02733000
         AL    @15,@CF00064                                        0826 02734000
         ST    @15,I(,TOMWREG)                                     0826 02735000
*                 IF RU(BYTECNT) < '40'X THEN  /* CONTROL CHARACTER? */ 02736000
         L     @15,BYTECNT(,TOMWREG)                               0827 02737000
         ALR   @15,TOMWREG                                         0827 02738000
         CLI   RU-1(@15),X'40'                                     0827 02739000
         BNL   @RF00827                                            0827 02740000
*                   /*************************************************/ 02741000
*                   /* WHEN THE BACKSPACE CHARACTER IS ENCOUNTERED,  */ 02742000
*                   /* DECREMENT THE PRINTABLE-CHARACTER COUNT BY    */ 02743000
*                   /* ONE UNLESS THE COUNT IS ALREADY ZERO.         */ 02744000
*                   /*************************************************/ 02745000
*                   IF RU(BYTECNT)=BKSPACE THEN /* BACKSPACE?        */ 02746000
         L     @15,BYTECNT(,TOMWREG)                               0828 02747000
         ALR   @15,TOMWREG                                         0828 02748000
         CLC   RU-1(1,@15),BKSPACE                                 0828 02749000
         BNE   @RF00828                                            0828 02750000
*                     IF CHARCNT > 0 THEN      /* COUNT > 0?         */ 02751000
         L     @15,CHARCNT(,TOMWREG)                               0829 02752000
         LTR   @15,@15                                             0829 02753000
         BNP   @RF00829                                            0829 02754000
*                       CHARCNT = CHARCNT - 1; /* DECREMENT COUNT    */ 02755000
         BCTR  @15,0                                               0830 02756000
         ST    @15,CHARCNT(,TOMWREG)                               0830 02757000
*                     ELSE;                    /* LEAVE COUNT ALONE  */ 02758000
@RF00829 DS    0H                                                  0832 02759000
*                   ELSE                       /* NOT BACKSPACE CHAR.*/ 02760000
*                     IF RU(BYTECNT) = HTAB |  /* HORIZONTAL TAB?    */ 02761000
*                        RU(BYTECNT) = FF |    /* FORM FEED?         */ 02762000
*                        RU(BYTECNT) = NL |    /* NEW LINE?          */ 02763000
*                        RU(BYTECNT) = CR |    /* CARRIAGE RETURN?   */ 02764000
*                        RU(BYTECNT) = IRS THEN /* INTERCHANGE RECORD   02765000
*                                                 SEPARATOR?         */ 02766000
         B     @RC00828                                            0832 02767000
@RF00828 L     @15,BYTECNT(,TOMWREG)                               0832 02768000
         ALR   @15,TOMWREG                                         0832 02769000
         CLC   RU-1(1,@15),HTAB                                    0832 02770000
         BE    @RT00832                                            0832 02771000
         L     @15,BYTECNT(,TOMWREG)                               0832 02772000
         ALR   @15,TOMWREG                                         0832 02773000
         CLC   RU-1(1,@15),FF                                      0832 02774000
         BE    @RT00832                                            0832 02775000
         L     @15,BYTECNT(,TOMWREG)                               0832 02776000
         ALR   @15,TOMWREG                                         0832 02777000
         CLC   RU-1(1,@15),NL                                      0832 02778000
         BE    @RT00832                                            0832 02779000
         L     @15,BYTECNT(,TOMWREG)                               0832 02780000
         ALR   @15,TOMWREG                                         0832 02781000
         CLC   RU-1(1,@15),CR                                      0832 02782000
         BE    @RT00832                                            0832 02783000
         L     @15,BYTECNT(,TOMWREG)                               0832 02784000
         ALR   @15,TOMWREG                                         0832 02785000
         CLC   RU-1(1,@15),IRS                                     0832 02786000
         BNE   @RF00832                                            0832 02787000
@RT00832 DS    0H                                                  0833 02788000
*                       CHARCNT = 0;           /* RESET COUNT        */ 02789000
         SLR   @15,@15                                             0833 02790000
         ST    @15,CHARCNT(,TOMWREG)                               0833 02791000
*                     ELSE;                                        0834 02792000
@RF00832 DS    0H                                                  0835 02793000
*                 ELSE                         /* NOT CONTROL CHAR.  */ 02794000
*                   CHARCNT = CHARCNT + 1;     /* INCREMENT COUNT    */ 02795000
         B     @RC00827                                            0835 02796000
@RF00827 LA    @15,1                                               0835 02797000
         AL    @15,CHARCNT(,TOMWREG)                               0835 02798000
         ST    @15,CHARCNT(,TOMWREG)                               0835 02799000
*                 BYTECNT = BYTECNT + 1;       /* NEXT BYTE POSITION */ 02800000
@RC00827 LA    @15,1                                               0836 02801000
         AL    @15,BYTECNT(,TOMWREG)                               0836 02802000
         ST    @15,BYTECNT(,TOMWREG)                               0836 02803000
*                 SIZE = SIZE - 1;             /* DECREMENT COUNTER  */ 02804000
         L     @15,SIZE(,TOMWREG)                                  0837 02805000
         BCTR  @15,0                                               0837 02806000
         ST    @15,SIZE(,TOMWREG)                                  0837 02807000
*               END;                                               0838 02808000
*             IF SIZE = 0 THEN                 /* END OF MESSAGE?    */ 02809000
@RC00812 L     @15,SIZE(,TOMWREG)                                  0839 02810000
         LTR   @15,@15                                             0839 02811000
         BNZ   @RF00839                                            0839 02812000
*               /*****************************************************/ 02813000
*               /* THE FOLLOWING HANDLES END OF MESSAGE.             */ 02814000
*               /*****************************************************/ 02815000
*               DO;                                                0840 02816000
*                 MOR = '0'B;                  /* END OF MESSAGE     */ 02817000
         NI    MOR(TOMWREG),B'01111111'                            0841 02818000
*                 /***************************************************/ 02819000
*                 /* A NEW-LINE CHARACTER IS APPENDED TO THE END     */ 02820000
*                 /* OF EACH TPUT-EDIT MESSAGE OR TO THE END OF A    */ 02821000
*                 /* MESSAGE WHEN PRINTABLE-CHARACTER COUNT EQUALS   */ 02822000
*                 /* LINE SIZE.                                      */ 02823000
*                 /***************************************************/ 02824000
*                 IF OPEDIT = '00'B |          /* EDIT TPUT?         */ 02825000
*                    CHARCNT=TSBLNSZ |         /* END OF LINE?       */ 02826000
*                    OPBRK = '1'B |            /* BREAK TPUT?        */ 02827000
*                    OPASID='1'B THEN          /* CROSS MEMORY TPUT? */ 02828000
         TM    OPEDIT(TOMWREG),B'00110000'                         0842 02829000
         BZ    @RT00842                                            0842 02830000
         L     @15,CHARCNT(,TOMWREG)                               0842 02831000
         SLR   @14,@14                                             0842 02832000
         IC    @14,TSBLNSZ(,TSBREG)                                0842 02833000
         CR    @15,@14                                             0842 02834000
         BE    @RT00842                                            0842 02835000
         TM    OPBRK(TOMWREG),B'01001000'                          0842 02836000
         BZ    @RF00842                                            0842 02837000
@RT00842 DS    0H                                                  0843 02838000
*                   DO;                        /* DO NL PROCESSING   */ 02839000
*                     IF BYTECNT = 257 THEN    /* RU FULL?           */ 02840000
         CLC   BYTECNT(4,TOMWREG),@CF02797                         0844 02841000
         BNE   @RF00844                                            0844 02842000
*                       SWNL = '1'B;           /* SET NEW-LINE SWITCH*/ 02843000
         OI    SWNL(TOMWREG),B'01000000'                           0845 02844000
*                     ELSE                     /* RU NOT FULL        */ 02845000
*                       DO;                    /* PLACE NL IN RU     */ 02846000
         B     @RC00844                                            0846 02847000
@RF00844 DS    0H                                                  0847 02848000
*                         RU(BYTECNT) = NL;    /* NEXT LINE          */ 02849000
         L     @15,BYTECNT(,TOMWREG)                               0847 02850000
         ALR   @15,TOMWREG                                         0847 02851000
         MVC   RU-1(1,@15),NL                                      0847 02852000
*                         BYTECNT = BYTECNT + 1;                   0848 02853000
         L     @15,BYTECNT(,TOMWREG)                               0848 02854000
         AL    @15,@CF00064                                        0848 02855000
         ST    @15,BYTECNT(,TOMWREG)                               0848 02856000
*                       END;                   /* NL PLACED IN RU    */ 02857000
*                     CHARCNT = 0;             /* RESET CHAR. COUNT  */ 02858000
@RC00844 SLR   @15,@15                                             0850 02859000
         ST    @15,CHARCNT(,TOMWREG)                               0850 02860000
*                   END;                       /* END NL PROCESSING  */ 02861000
*                 ELSE;                        /* DO NOTHING         */ 02862000
@RF00842 DS    0H                                                  0853 02863000
*               END;                                               0853 02864000
*             ELSE                             /* MIDDLE OF MESSAGE  */ 02865000
*               /*****************************************************/ 02866000
*               /* INSERT A NEW-LINE CHARACTER WHEN LINESIZE IS      */ 02867000
*               /* REACHED.                                          */ 02868000
*               /*****************************************************/ 02869000
*               IF BYTECNT = 257 THEN          /* RU FULL?           */ 02870000
         B     @RC00839                                            0854 02871000
@RF00839 CLC   BYTECNT(4,TOMWREG),@CF02797                         0854 02872000
         BNE   @RF00854                                            0854 02873000
*                 DO;                                              0855 02874000
*                   MOR = '1'B;                /* MIDDLE OF MESSAGE  */ 02875000
         OI    MOR(TOMWREG),B'10000000'                            0856 02876000
*                   IF CHARCNT = TSBLNSZ THEN  /* COUNT = LINE SIZE? */ 02877000
         L     @15,CHARCNT(,TOMWREG)                               0857 02878000
         SLR   @14,@14                                             0857 02879000
         IC    @14,TSBLNSZ(,TSBREG)                                0857 02880000
         CR    @15,@14                                             0857 02881000
         BNE   @RF00857                                            0857 02882000
*                     DO;                      /* DO NL PROCESSING   */ 02883000
*                       SWNL = '1'B;           /* SET NEW-LINE SWITCH*/ 02884000
         OI    SWNL(TOMWREG),B'01000000'                           0859 02885000
*                       CHARCNT = 0;           /* RESET CHAR. COUNT  */ 02886000
         SLR   @15,@15                                             0860 02887000
         ST    @15,CHARCNT(,TOMWREG)                               0860 02888000
*                     END;                     /* END NL PROCESSING  */ 02889000
*                   ELSE;                      /* COUNT ^= LINE SIZE */ 02890000
@RF00857 DS    0H                                                  0863 02891000
*                 END;                                             0863 02892000
*               ELSE                           /* RU NOT FULL        */ 02893000
*                 IF CHARCNT = TSBLNSZ THEN    /* COUNT = LINE SIZE? */ 02894000
         B     @RC00854                                            0864 02895000
@RF00854 L     @15,CHARCNT(,TOMWREG)                               0864 02896000
         SLR   @14,@14                                             0864 02897000
         IC    @14,TSBLNSZ(,TSBREG)                                0864 02898000
         CR    @15,@14                                             0864 02899000
         BNE   @RF00864                                            0864 02900000
*                   DO;                        /* DO NL PROCESSING   */ 02901000
*                     CHARCNT = 0;             /* RESET CHAR. COUNT  */ 02902000
         SLR   @15,@15                                             0866 02903000
         ST    @15,CHARCNT(,TOMWREG)                               0866 02904000
*                     RU(BYTECNT) = NL;        /* PLACE NL IN RU     */ 02905000
         L     @15,BYTECNT(,TOMWREG)                               0867 02906000
         ALR   @15,TOMWREG                                         0867 02907000
         MVC   RU-1(1,@15),NL                                      0867 02908000
*                     BYTECNT = BYTECNT + 1;   /* NEXT BYTE POSITION */ 02909000
         L     @15,BYTECNT(,TOMWREG)                               0868 02910000
         AL    @15,@CF00064                                        0868 02911000
         ST    @15,BYTECNT(,TOMWREG)                               0868 02912000
*                     IF BYTECNT = 257 THEN    /* RU FULL?           */ 02913000
         C     @15,@CF02797                                        0869 02914000
         BNE   @RF00869                                            0869 02915000
*                       MOR = '1'B;            /* MIDDLE OF MESSAGE  */ 02916000
         OI    MOR(TOMWREG),B'10000000'                            0870 02917000
*                     ELSE;                    /* RU NOT FULL        */ 02918000
@RF00869 DS    0H                                                  0872 02919000
*                   END;                       /* END NL PROCESSING  */ 02920000
*                 ELSE;                        /* COUNT ^= LINE SIZE */ 02921000
@RF00864 DS    0H                                                  0874 02922000
*           END;                                                   0874 02923000
*                                                                  0874 02924000
@RC00854 DS    0H                                                  0874 02925000
@RC00839 DS    0H                                                  0874 02926000
@DE00811 L     @15,BYTECNT(,TOMWREG)                               0874 02927000
         C     @15,@CF02797                                        0874 02928000
         BNL   @DC00811                                            0874 02929000
         L     @15,I(,TOMWREG)                                     0874 02930000
         C     @15,LIMIT(,TOMWREG)                                 0874 02931000
         BNH   @DL00811                                            0874 02932000
@DC00811 DS    0H                                                  0875 02933000
*           END INSERTNL;                      /* END OF INSERTNL    */ 02934000
@EL00014 DS    0H                                                  0875 02935000
@EF00014 DS    0H                                                  0875 02936000
@ER00014 L     @14,12(,@13)                                        0875 02937000
         BR    @14                                                 0875 02938000
         EJECT                                                          02939000
*SENDRU:    PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0876 02940000
*                                                                  0876 02941000
SENDRU   ST    @14,@SA00015                                        0876 02942000
*           /*********************************************************/ 02943000
*           /*                                                       */ 02944000
*           /* PROCEDURE - SENDRU                                    */ 02945000
*           /*                                                       */ 02946000
*           /* FUNCTION - TO SEND DATA TO THE TERMINAL.              */ 02947000
*           /*            IF THE SEND WAS NOT SUCCESSFUL, THE        */ 02948000
*           /*            CHECK-RESPONSE ROUTINE WILL BE CALLED.     */ 02949000
*           /*                                                       */ 02950000
*           /*********************************************************/ 02951000
*                                                                  0877 02952000
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/  02953000
*CKMC0004:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856 02954000
**/            FRWACKPT(2)=ADDR(CKMC0004); /* SAVE ADDRESS    @ZM20856  02955000
*/           END;       /* CHECK POINT        @ZM20856*/           0878 02956000
*                                                                  0878 02957000
CKMC0004 L     @15,TVWAFRWO(,TVWAREG)                              0878 02958000
         STM   REG0,REG15,FRWACKRG(@15)                            0878 02959000
         LA    @14,CKMC0004                                        0879 02960000
         ST    @14,FRWACKPT+4(,@15)                                0879 02961000
*           /*********************************************************/ 02962000
*           /* IF NOT IN BRACKET STATE AND BEGINNING OF CHAIN OR ONLY*/ 02963000
*           /* CHAIN, SET RPL BRACKET FIELD TO BEGIN-BRACKET.        */ 02964000
*           /*********************************************************/ 02965000
*           IF TVWAINB='0'B &          /* NOT BRACKET STATE  @ZM20858*/ 02966000
*              (RPLCHN = BOC |         /* BEGINNING OF CHAIN?        */ 02967000
*               RPLCHN=OC) THEN        /* ONLY CHAIN?                */ 02968000
         TM    TVWAINB(TVWAREG),B'00000100'                        0881 02969000
         BNZ   @RF00881                                            0881 02970000
         LA    @15,16                                              0881 02971000
         ALR   @15,RPLREG                                          0881 02972000
         CLI   RPLCHN(@15),X'80'                                   0881 02973000
         BE    @RT00881                                            0881 02974000
         CLI   RPLCHN(@15),X'10'                                   0881 02975000
         BNE   @RF00881                                            0881 02976000
@RT00881 DS    0H                                                  0882 02977000
*             DO;                      /* DO BEGIN-BRACKET PROCESSING*/ 02978000
*               TVWAINB = '1'B;        /* RESET BRACKET-STATE@ZM20858*/ 02979000
         OI    TVWAINB(TVWAREG),B'00000100'                        0883 02980000
*               TVWATOBB='1'B;         /* BEG BRACKET ON SEND@ZM20858*/ 02981000
         OI    TVWATOBB(TVWAREG),B'00000100'                       0884 02982000
*               RPLRH3 = BB;           /* SEND BEGIN BRACKET         */ 02983000
         MVI   RPLRH3+16(RPLREG),X'80'                             0885 02984000
*             END;                     /* END BB PROCESSING          */ 02985000
*           ELSE                       /* NOT BB OR MOC OR EOC       */ 02986000
*             DO;                      /*                    @ZM20858*/ 02987000
         B     @RC00881                                            0887 02988000
@RF00881 DS    0H                                                  0888 02989000
*               TVWATOBB='0'B;         /* BEGIN BRACKET NOT ON SEND     02990000
*                                                            @ZM20858*/ 02991000
         NI    TVWATOBB(TVWAREG),B'11111011'                       0888 02992000
*               RPLRH3 = '00'X;        /* DO NOT SEND BEGIN BRACKET  */ 02993000
         MVI   RPLRH3+16(RPLREG),X'00'                             0889 02994000
*             END;                     /*                    @ZM20858*/ 02995000
*                                                                  0890 02996000
*           IF TSBXASCI = '1'B THEN    /* IS IT ASCII CODE?          */ 02997000
@RC00881 L     @01,TSBEXTNT(,TSBREG)                               0891 02998000
         TM    TSBXASCI(@01),B'10000000'                           0891 02999000
         BNO   @RF00891                                            0891 03000000
*             RPLCSI = '1'B;           /* ASCII                      */ 03001000
         OI    RPLCSI+16(RPLREG),B'00001000'                       0892 03002000
*           ELSE                       /* NO                         */ 03003000
*             RPLCSI = '0'B;           /* EBCDIC                     */ 03004000
*                                                                  0893 03005000
         B     @RC00891                                            0893 03006000
@RF00891 NI    RPLCSI+16(RPLREG),B'11110111'                       0893 03007000
*           RPLRLEN = BYTECNT - 1;     /* LENGTH OF MESSAGE          */ 03008000
@RC00891 L     @15,BYTECNT(,TOMWREG)                               0894 03009000
         BCTR  @15,0                                               0894 03010000
         ST    @15,RPLRLEN(,RPLREG)                                0894 03011000
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    0895 03012000
*           TVWAIOP='1'B;              /* TURN ON I/O PENDING BIT  0896 03013000
*                                                            @ZA24418*/ 03014000
         OI    TVWAIOP(TVWAREG),B'00100000'                        0896 03015000
*           WRK2 = ADDR(IFGRPL);       /* RPL ADDRESS                */ 03016000
         LR    WRK2,RPLREG                                         0897 03017000
*           SRPLCHN = RPLCHN;          /* SAVE CHAIN ELEMENT         */ 03018000
*                                                                  0898 03019000
         MVC   SRPLCHN(1,TOMWREG),RPLCHN+16(RPLREG)                0898 03020000
*           /*********************************************************/ 03021000
*           /* THE FOLLOWING GENERATED CODE CONTAINS CODE TO SAVE    */ 03022000
*           /* REGS 14-1 IN THE SAVE AREA. REGS 15 AND 0 ARE THE REGS*/ 03023000
*           /* OF SPECIFIC INTEREST FOR MAINTAINING VTAM RETURN CODES*/ 03024000
*           /* FROM THE SEND. THE STM,LM SEQUENCE IS USED FOR SPEED  */ 03025000
*           /*********************************************************/ 03026000
*           GENERATE REFS(BYTECNT,FRRPTR,FRRS,FRRSCURR,FRRSLAST,FLC,    03027000
*                         PSALSFCC,PSA,FRRSELEN,PSACSTK,FRRSFRRA,  0899 03028000
*                         FRRSENTR,FRRSPARM,PSALITA)               0899 03029000
*                    SETS(WRK2,WRK3,REGPARM,REG1,REG13,REG14,REG15,     03030000
*                         REG0);                                   0899 03031000
*                                                                  0899 03032000
       SETLOCK RELEASE,                                               CC03033000
               TYPE=LOCAL,                                            CC03034000
               REGS=USE,                                              CC03035000
               RELATED=(RPL)                                            03036000
       SEND    RPL=(WRK2),                                            CC03037000
               CONTROL=DATA                                             03038000
         STM   REG14,REG1,12(REG13)      SAVE REGS 15,0       @ZM20858  03039000
       SETFRR  A,                                                     CC03040000
               FRRAD=(FRRPTR),                                        CC03041000
               PARMAD=(REGPARM),                                      CC03042000
               WRKREGS=(WRK2,WRK3)                                      03043000
       SETLOCK OBTAIN,                                                CC03044000
               TYPE=LOCAL,                                            CC03045000
               MODE=UNCOND,                                           CC03046000
               REGS=USE,                                              CC03047000
               RELATED=(RPL)                                            03048000
         LM    REG14,REG1,12(REG13)      RESTORE REGS 15,0  @ZM20858    03049000
*           FRRPARM=REGPARM;           /* SAVE ADDRESS OF PARAMETER     03050000
*                                         AREA PROVIDED BY SETFRR  0900 03051000
*                                         MACRO              @ZM20856*/ 03052000
*                                                                  0900 03053000
         ST    REGPARM,FRRPARM                                     0900 03054000
*          RFY (WRK2,WRK3,REGPARM,REG1,REG14,REG15) UNRSTD;        0901 03055000
*                                                                  0901 03056000
*           CALL INITFRR;              /* CALL FRR INIT      @ZM20856*/ 03057000
         BAL   @14,INITFRR                                         0902 03058000
*           RFY GENRC RSTD;            /* RESTRICT RETURN-CODE REG.  */ 03059000
*           RPLCHN = SRPLCHN;          /* RESTORE CHAIN ELEMENT      */ 03060000
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                0904 03061000
*           TVWASCD = '0'B;            /* RESET CHANGE-DIRECTION BIT */ 03062000
         NI    TVWASCD(TVWAREG),B'11011111'                        0905 03063000
*           TVWAISYS = '0'B;           /* RESET I-SYS SWITCH  0Z12002*/ 03064000
*           TVWAIOP='0'B;              /* RESET I/O PENDING BIT    0907 03065000
*                                                            @ZA24418*/ 03066000
*                                                                  0907 03067000
         NI    TVWAISYS(TVWAREG),B'01011111'                       0907 03068000
*           /*********************************************************/ 03069000
*           /* IF THE VTAM GENERAL RETURN CODE IS ZERO,              */ 03070000
*           /* THEN DO NOT RESEND.                                   */ 03071000
*           /* OTHERWISE, CALL CHECK-RESPONSE ROUTINE.               */ 03072000
*           /*********************************************************/ 03073000
*           IF GENRC = 0 THEN          /* REQUEST ACCEPTED?          */ 03074000
         LTR   GENRC,GENRC                                         0908 03075000
         BNZ   @RF00908                                            0908 03076000
*             NEC = '0'B;              /* NOT NECESSARY TO RESEND    */ 03077000
         NI    NEC(TOMWREG),B'11111011'                            0909 03078000
*           ELSE                       /* REQUEST REJECTED           */ 03079000
*             CALL CHKRESP;            /* CHECK RESPONSE             */ 03080000
*                                                                  0910 03081000
         B     @RC00908                                            0910 03082000
@RF00908 BAL   @14,CHKRESP                                         0910 03083000
*           RFY (GENRC,REG0) UNRSTD;   /* FREE UP REGS       @ZM20858*/ 03084000
*                                                                  0911 03085000
*           END SENDRU;                /* END OF SENDRU              */ 03086000
@EL00015 DS    0H                                                  0912 03087000
@EF00015 DS    0H                                                  0912 03088000
@ER00015 L     @14,@SA00015                                        0912 03089000
         BR    @14                                                 0912 03090000
         EJECT                                                          03091000
*RCVRSET:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0913 03092000
*                                                                  0913 03093000
RCVRSET  ST    @14,@SA00016                                        0913 03094000
*           /*********************************************************/ 03095000
*           /*                                                       */ 03096000
*           /* PROCEDURE - RCVRSET                                   */ 03097000
*           /*                                                       */ 03098000
*           /* FUNCTION - TO RELEASE THE LOCAL LOCK, TO ISSUE A      */ 03099000
*           /*            RESETSR, TO SET THE FRR, AND TO OBTAIN THE */ 03100000
*           /*            LOCAL LOCK                                 */ 03101000
*           /*                                                       */ 03102000
*           /*********************************************************/ 03103000
*                                                                  0914 03104000
*           RFY (WRK2,WRK3,REGPARM) RSTD;                          0914 03105000
*           WRK2 = ADDR(IFGRPL);        /* RPL ADDRESS               */ 03106000
         LR    WRK2,RPLREG                                         0915 03107000
*           SRPLCHN = RPLCHN;           /* SAVE CHAIN ELEMENT        */ 03108000
         LA    @04,16                                              0916 03109000
         ALR   @04,RPLREG                                          0916 03110000
         MVC   SRPLCHN(1,TOMWREG),RPLCHN(@04)                      0916 03111000
*           RPLRRESP = '1'B;            /* RTYPE=RESP                */ 03112000
*                                                                  0917 03113000
         OI    RPLRRESP(@04),B'00001000'                           0917 03114000
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,PSA,   03115000
*                         FRRSELEN,PSACSTK,FRRSFRRA,FRRSENTR,FRRSPARM,  03116000
*                         PSALITA,FLC)                             0918 03117000
*                    SETS(WRK2,WRK3,REGPARM,REG0,REG1,REG13,REG14, 0918 03118000
*                         REG15);                                  0918 03119000
*                                                                  0918 03120000
       SETLOCK RELEASE,                                               CC03121000
               TYPE=LOCAL,                                            CC03122000
               REGS=USE,                                              CC03123000
               RELATED=('RELEASE LOCAL LOCK')                           03124000
       RESETSR RPL=(WRK2)                                               03125000
       SETFRR  A,                                                     CC03126000
               FRRAD=(FRRPTR),                                        CC03127000
               PARMAD=(REGPARM),                                      CC03128000
               WRKREGS=(WRK2,WRK3)                                      03129000
       SETLOCK OBTAIN,                                                CC03130000
               TYPE=LOCAL,                                            CC03131000
               MODE=UNCOND,                                           CC03132000
               REGS=USE,                                              CC03133000
               RELATED=('OBTAIN LOCAL LOCK')                            03134000
*           FRRPARM=REGPARM;               /* SAVE ADDRESS OF      0919 03135000
*                                              PARAMETER AREA      0919 03136000
*                                              PROVIDED BY         0919 03137000
*                                              SETFRR MACRO  @ZM20856*/ 03138000
         ST    REGPARM,FRRPARM                                     0919 03139000
*           RFY (WRK2,WRK3,REGPARM) UNRSTD;                        0920 03140000
*                                                                  0920 03141000
*           CALL INITFRR;                  /* CALL FRR INIT  @ZM20856*/ 03142000
         BAL   @14,INITFRR                                         0921 03143000
*           RPLCHN = SRPLCHN;              /* RESTORE CHAIN ELEMENT  */ 03144000
*                                                                  0922 03145000
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                0922 03146000
*           END RCVRSET;                   /* END OF RCVRSET         */ 03147000
@EL00016 DS    0H                                                  0923 03148000
@EF00016 DS    0H                                                  0923 03149000
@ER00016 L     @14,@SA00016                                        0923 03150000
         BR    @14                                                 0923 03151000
         EJECT                                                          03152000
*CHKRESP:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0924 03153000
*                                                                  0924 03154000
CHKRESP  ST    @14,@SA00017                                        0924 03155000
*    /****************************************************************/ 03156000
*    /*                                                              */ 03157000
*    /*        PROCEDURE - CHKRESP                                   */ 03158000
*    /*                                                              */ 03159000
*    /*        FUNCTION - TO DETERMINE THE COURSE OF ACTION WHEN A   */ 03160000
*    /*                   REQUEST IS REJECTED BY VTAM.               */ 03161000
*    /*                   A.  CASE WHEN THE VTAM GENERAL RETURN CODE */ 03162000
*    /*                       IS 4:                                  */ 03163000
*    /*                       1. IF THE REQUEST WAS CANCELED BY A    */ 03164000
*    /*                          PRIOR EXCEPTION MESSAGE (RTNCD=12   */ 03165000
*    /*                          AND FDBK2=13), CALL ISSUERCV TO     */ 03166000
*    /*                          A RECEIVE TO OBTAIN THE RESPONSE.   */ 03167000
*    /*                       2. IF THE INCOMING RESPONSE INDICATES  */ 03168000
*    /*                          AN EXCEPTION CONDITION (RTNCD=4 AND */ 03169000
*    /*                          FDBK2=4), CALL CHKSENSE TO CHECK    */ 03170000
*    /*                          SENSE INFORMATION.                  */ 03171000
*    /*                       3. IF RPL FIELD IS INVALID, CALL       */ 03172000
*    /*                          REBLDRPL TO REBUILD THE RPL.        */ 03173000
*    /*                       4. WHEN THE REQUEST WAS CANCELED       */ 03174000
*    /*                          BECAUSE OF A VTAM TEMPORARY STORAGE */ 03175000
*    /*                          CONDITION OR A CLEAR INDICATOR      */ 03176000
*    /*                          (RTNCD=8 AND FDBK2=0 OR RTNCD=12    */ 03177000
*    /*                          AND FDBKW=12), CALL REISSUE TO      */ 03178000
*    /*                          RETRY THE REQUEST.                  */ 03179000
*    /*                       5. WHEN COMMUNICATION WITH THE         */ 03180000
*    /*                          TERMINAL IS NOT POSSIBLE, CALL      */ 03181000
*    /*                          FINPROC TO FREE THE TOM WORK AREA   */ 03182000
*    /*                          AND SRB AND TO CLEAR THE POINTERS   */ 03183000
*    /*                          TO THE TOM WORK AREA AND SRB.       */ 03184000
*    /*                                                              */ 03185000
*    /****************************************************************/ 03186000
*                                                                  0925 03187000
*           RFY (GENRC,REG0) RSTD;         /* RESTRICT REGS  @ZM21327*/ 03188000
*            DO;    /* CHECKPOINT REGISTERS AND THE ADDRESS @ZM20856*/  03189000
*CKMC0005:     STM(REG0,REG15,FRWACKRG); /* SAVE ALL REGISTERS @ZM20856 03190000
**/            FRWACKPT(2)=ADDR(CKMC0005); /* SAVE ADDRESS    @ZM20856  03191000
*/           END;           /* CHECK POINT    @ZM20856*/           0927 03192000
CKMC0005 L     @14,TVWAFRWO(,TVWAREG)                              0927 03193000
         STM   REG0,REG15,FRWACKRG(@14)                            0927 03194000
         LA    @01,CKMC0005                                        0928 03195000
         ST    @01,FRWACKPT+4(,@14)                                0928 03196000
*           CHK = '1'B;                    /* CHECK RESPONSE         */ 03197000
*                                                                  0930 03198000
         OI    CHK(TOMWREG),B'00000001'                            0930 03199000
*           DO WHILE (CHK = '1'B);                                 0931 03200000
*                                                                  0931 03201000
         B     @DE00931                                            0931 03202000
@DL00931 DS    0H                                                  0932 03203000
*             CHK = '0'B;                  /* RESET CHECK SWITCH     */ 03204000
*                                                                  0932 03205000
         NI    CHK(TOMWREG),B'11111110'                            0932 03206000
*            /********************************************************/ 03207000
*            /* CHECK VTAM IMMEDIATE RETURN CODES            @ZM20858*/ 03208000
*            /********************************************************/ 03209000
*            IF REG15=32 |              /* INVALID RPL OR    @ZM20858*/ 03210000
*              (REG15=4 & REG0=24) THEN /* VTAM NOT ACTIVE   @ZM20858*/ 03211000
         C     REG15,@CF00742                                      0933 03212000
         BE    @RT00933                                            0933 03213000
         C     REG15,@CF00056                                      0933 03214000
         BNE   @RF00933                                            0933 03215000
         C     REG0,@CF00073                                       0933 03216000
         BNE   @RF00933                                            0933 03217000
@RT00933 DS    0H                                                  0934 03218000
*              CALL REBLDRPL;       /* REBUILD RPL AND RETRY @ZM20858*/ 03219000
         BAL   @14,REBLDRPL                                        0934 03220000
*            ELSE                   /* IMMED RETURN CODE OK  @ZM20858*/ 03221000
*              DO;                                                 0935 03222000
*                                                                  0935 03223000
         B     @RC00933                                            0935 03224000
@RF00933 DS    0H                                                  0936 03225000
*           /*********************************************************/ 03226000
*           /* WHEN FURTHER COMMUNICATION WITH THE TERMINAL IS NOT   */ 03227000
*           /* POSSIBLE, DO A CLEAN EXIT.                            */ 03228000
*           /*********************************************************/ 03229000
*           IF (RPLRTNCD=12 & (RPLFDB2=2 |    /*REQUEST RESET@ZM20858*/ 03230000
*                              RPLFDB2=7 |    /*RECOVERY IN PROGRESS    03231000
*                                                            @ZM20858*/ 03232000
*                              RPLFDB2=8 |    /*RECORD TERM RESTARTED   03233000
*                                               AFTER FAIL   @ZM20858*/ 03234000
*                              RPLFDB2=9 |    /*OPNDST CANCELED BY 0936 03235000
*                                               CLSDST       @ZM20858*/ 03236000
*                              RPLFDB2=11)) | /*CLSDST OCCURD@ZM20858*/ 03237000
*              (RPLRTNCD=20 &                                      0936 03238000
*              (RPLFDB2=18 | RPLFDB2=65)) | /* 65-NO SDT ISSUED    0936 03239000
*                                                            @ZA17888*/ 03240000
*              (RPLRTNCD=16 & (RPLFDB2=3 |  /*VTAM HALTING   @ZM20858*/ 03241000
*                              RPLFDB2=5 |  /*PERM PATH FAIL @ZM20858*/ 03242000
*                              RPLFDB2=6 |  /*AUTO NET SHUTD @ZM20858*/ 03243000
*                              RPLFDB2=7 |  /*VARY DEACT IMM @ZM20858*/ 03244000
*                              RPLFDB2=9 |  /*TERMINATE SELF @ZM20858*/ 03245000
*                              RPLFDB2=15)) /*VTAM BUFR OVFLW@ZM20858*/ 03246000
*              THEN                        /* COMMUNICATION SEVERED  */ 03247000
         CLI   RPLRTNCD(RPLREG),12                                 0936 03248000
         BNE   @GL00054                                            0936 03249000
         CLI   RPLFDB2(RPLREG),2                                   0936 03250000
         BE    @RT00936                                            0936 03251000
         CLI   RPLFDB2(RPLREG),7                                   0936 03252000
         BE    @RT00936                                            0936 03253000
         CLI   RPLFDB2(RPLREG),8                                   0936 03254000
         BE    @RT00936                                            0936 03255000
         CLI   RPLFDB2(RPLREG),9                                   0936 03256000
         BE    @RT00936                                            0936 03257000
         CLI   RPLFDB2(RPLREG),11                                  0936 03258000
         BE    @RT00936                                            0936 03259000
@GL00054 CLI   RPLRTNCD(RPLREG),20                                 0936 03260000
         BNE   @GL00053                                            0936 03261000
         CLI   RPLFDB2(RPLREG),18                                  0936 03262000
         BE    @RT00936                                            0936 03263000
         CLI   RPLFDB2(RPLREG),65                                  0936 03264000
         BE    @RT00936                                            0936 03265000
@GL00053 CLI   RPLRTNCD(RPLREG),16                                 0936 03266000
         BNE   @RF00936                                            0936 03267000
         CLI   RPLFDB2(RPLREG),3                                   0936 03268000
         BE    @RT00936                                            0936 03269000
         CLI   RPLFDB2(RPLREG),5                                   0936 03270000
         BE    @RT00936                                            0936 03271000
         CLI   RPLFDB2(RPLREG),6                                   0936 03272000
         BE    @RT00936                                            0936 03273000
         CLI   RPLFDB2(RPLREG),7                                   0936 03274000
         BE    @RT00936                                            0936 03275000
         CLI   RPLFDB2(RPLREG),9                                   0936 03276000
         BE    @RT00936                                            0936 03277000
         CLI   RPLFDB2(RPLREG),15                                  0936 03278000
         BNE   @RF00936                                            0936 03279000
@RT00936 DS    0H                                                  0937 03280000
*                 CALL FINPROC;            /* DO A CLEAN EXIT        */ 03281000
         BAL   @14,FINPROC                                         0937 03282000
*           ELSE                                                   0938 03283000
*              IF GENRC = 4 THEN           /* GENERAL RETURN CODE 4? */ 03284000
         B     @RC00936                                            0938 03285000
@RF00936 C     GENRC,@CF00056                                      0938 03286000
         BNE   @RF00938                                            0938 03287000
*               /*****************************************************/ 03288000
*               /* IF REQUEST CANCELED BY A PRIOR EXCEPTION MESSAGE, */ 03289000
*               /* ISSUE A RECEIVE.                                  */ 03290000
*               /*****************************************************/ 03291000
*               IF RPLRTNCD=12 & RPLFDB2=13 THEN                   0939 03292000
         CLI   RPLRTNCD(RPLREG),12                                 0939 03293000
         BNE   @RF00939                                            0939 03294000
         CLI   RPLFDB2(RPLREG),13                                  0939 03295000
         BNE   @RF00939                                            0939 03296000
*                                          /* PRIOR EXCEPTION MESSAGE*/ 03297000
*                 CALL ISSUERCV;           /* ISSUE RECEIVE MACRO    */ 03298000
         BAL   @14,ISSUERCV                                        0940 03299000
*               ELSE                                               0941 03300000
*                 /***************************************************/ 03301000
*                 /* IF SENSE INFORMATION PROVIDED,                  */ 03302000
*                 /* CHECK SENSE INFORMATION.                        */ 03303000
*                 /***************************************************/ 03304000
*                 IF RPLRTNCD=4 & RPLFDB2=4 THEN                   0941 03305000
         B     @RC00939                                            0941 03306000
@RF00939 CLI   RPLRTNCD(RPLREG),4                                  0941 03307000
         BNE   @RF00941                                            0941 03308000
         CLI   RPLFDB2(RPLREG),4                                   0941 03309000
         BNE   @RF00941                                            0941 03310000
*                                          /* EXCEPTION OCCURRED     */ 03311000
*                   CALL CHKSENSE;         /* CHECK SENSE INFORMATION*/ 03312000
         BAL   @14,CHKSENSE                                        0942 03313000
*                 ELSE                                             0943 03314000
*                   /*************************************************/ 03315000
*                   /* IF RPL FIELD INVALID, REBUILD RPL.            */ 03316000
*                   /*************************************************/ 03317000
*                   IF RPLRTNCD=20 &                               0943 03318000
*                     ((RPLFDB2<=64 & RPLFDB2^=18) | RPLFDB2=93) THEN   03319000
         B     @RC00941                                            0943 03320000
@RF00941 CLI   RPLRTNCD(RPLREG),20                                 0943 03321000
         BNE   @RF00943                                            0943 03322000
         CLI   RPLFDB2(RPLREG),64                                  0943 03323000
         BH    @GL00071                                            0943 03324000
         CLI   RPLFDB2(RPLREG),18                                  0943 03325000
         BNE   @RT00943                                            0943 03326000
@GL00071 CLI   RPLFDB2(RPLREG),93                                  0943 03327000
         BNE   @RF00943                                            0943 03328000
@RT00943 DS    0H                                                  0944 03329000
*                                          /* RPL FIELD INVALID      */ 03330000
*                     CALL REBLDRPL;       /* REBUILD RPL            */ 03331000
         BAL   @14,REBLDRPL                                        0944 03332000
*                   ELSE                                           0945 03333000
*                     /***********************************************/ 03334000
*                     /* IF VTAM TEMPORARY STORAGE SHORTAGE OR       */ 03335000
*                     /* REQUEST CANCELED BY CLEAR INDICATOR,        */ 03336000
*                     /* REISSUE.                                    */ 03337000
*                     /***********************************************/ 03338000
*                     IF (RPLRTNCD=8 & RPLFDB2=0) |                0945 03339000
*                        (RPLRTNCD=12 & RPLFDB2=12) THEN           0945 03340000
         B     @RC00943                                            0945 03341000
@RF00943 CLI   RPLRTNCD(RPLREG),8                                  0945 03342000
         BNE   @GL00073                                            0945 03343000
         CLI   RPLFDB2(RPLREG),0                                   0945 03344000
         BE    @RT00945                                            0945 03345000
@GL00073 CLI   RPLRTNCD(RPLREG),12                                 0945 03346000
         BNE   @RF00945                                            0945 03347000
         CLI   RPLFDB2(RPLREG),12                                  0945 03348000
         BNE   @RF00945                                            0945 03349000
@RT00945 DS    0H                                                  0946 03350000
*                                          /* VTAM STORAGE SHORTAGE  */ 03351000
*                       CALL REISSUE;      /* REISSUE SEND MACRO     */ 03352000
         BAL   @14,REISSUE                                         0946 03353000
*                     ELSE                                         0947 03354000
*                       /*********************************************/ 03355000
*                       /* ALL OTHERS, REFRESH AND RETRY     @ZM20858*/ 03356000
*                       /*********************************************/ 03357000
*                       CALL REBLDRPL;   /* REFRESH RPL      @ZM20858*/ 03358000
         B     @RC00945                                            0947 03359000
@RF00945 BAL   @14,REBLDRPL                                        0947 03360000
*             ELSE                                                 0948 03361000
*               /*****************************************************/ 03362000
*               /* FOR CATASTROPHIC ERRS, ABEND. RETRY OTHERS@ZM20858*/ 03363000
*               /*****************************************************/ 03364000
*               IF RPLRTNCD=16 THEN        /* SEVERE ERROR   @ZM20858*/ 03365000
         B     @RC00938                                            0948 03366000
@RF00938 CLI   RPLRTNCD(RPLREG),16                                 0948 03367000
         BNE   @RF00948                                            0948 03368000
*                 CALL EXITFRR;            /* CALL ABEND RTN @ZM20856*/ 03369000
         BAL   @14,EXITFRR                                         0949 03370000
*               ELSE                       /* NOT SEVERE ERR @ZM20858*/ 03371000
*                 CALL REBLDRPL;           /* REFRESH, RETRY @ZM20858*/ 03372000
*                                                                  0950 03373000
         B     @RC00948                                            0950 03374000
@RF00948 BAL   @14,REBLDRPL                                        0950 03375000
*           END;                                                   0951 03376000
@RC00948 DS    0H                                                  0951 03377000
@RC00938 DS    0H                                                  0951 03378000
@RC00936 DS    0H                                                  0952 03379000
*           END;                                                   0952 03380000
@RC00933 DS    0H                                                  0952 03381000
@DE00931 TM    CHK(TOMWREG),B'00000001'                            0952 03382000
         BO    @DL00931                                            0952 03383000
*           RFY (GENRC,REG0) UNRSTD;                               0953 03384000
*                                                                  0953 03385000
*           END CHKRESP;                   /* END OF CHKRESP         */ 03386000
@EL00017 DS    0H                                                  0954 03387000
@EF00017 DS    0H                                                  0954 03388000
@ER00017 L     @14,@SA00017                                        0954 03389000
         BR    @14                                                 0954 03390000
         EJECT                                                          03391000
*ISSUERCV:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0955 03392000
*                                                                  0955 03393000
ISSUERCV ST    @14,@SA00018                                        0955 03394000
*           /*********************************************************/ 03395000
*           /*                                                       */ 03396000
*           /* PROCEDURE - ISSUERCV                                  */ 03397000
*           /*                                                       */ 03398000
*           /* FUNCTION - TO ISSUE A RECEIVE TO OBTAIN A RESPONSE.   */ 03399000
*           /*                                                       */ 03400000
*           /*********************************************************/ 03401000
*                                                                  0956 03402000
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    0956 03403000
*           SRPLCHN = RPLCHN;               /* SAVE CHAIN ELEMENT    */ 03404000
         MVC   SRPLCHN(1,TOMWREG),RPLCHN+16(RPLREG)                0957 03405000
*           WRK2 = ADDR(IFGRPL);            /* ADDRESS OF RPL        */ 03406000
*                                                                  0958 03407000
         LR    WRK2,RPLREG                                         0958 03408000
*           /*********************************************************/ 03409000
*           /* THE FOLLOWING GENERATED CODE CONTAINS CODE TO SAVE    */ 03410000
*           /* REGS 14-1 IN THE SAVE AREA. REGS 15 AND 0 ARE THE REGS*/ 03411000
*           /* OF SPECIFIC INTEREST FOR MAINTAINING VTAM RETURN CODES*/ 03412000
*           /* FROM THE RECEIVE.THE STM,LM SEQUENCE IS USED FOR SPEED*/ 03413000
*           /************************************************@ZM20858*/ 03414000
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,PSA,   03415000
*                         FRRSELEN,PSACSTK,FRRSFRRA,FRRSENTR,FRRSPARM,  03416000
*                         PSALITA,FLC)                             0959 03417000
*                    SETS(WRK2,WRK3,REGPARM,REG1,REG13,REG14,REG15);    03418000
       SETLOCK RELEASE,                                               CC03419000
               TYPE=LOCAL,                                            CC03420000
               REGS=USE,                                              CC03421000
               RELATED=('RELEASE LOCAL LOCK')                           03422000
       RECEIVE RPL=(WRK2),                                            CC03423000
               RTYPE=(NDFSYN,NDFASY,RESP)                               03424000
         STM   REG14,REG1,12(REG13)       SAVE REGS 15,0      @ZM20858  03425000
       SETFRR  A,                                                     CC03426000
               FRRAD=(FRRPTR),                                        CC03427000
               PARMAD=(REGPARM),                                      CC03428000
               WRKREGS=(WRK2,WRK3)                                      03429000
       SETLOCK OBTAIN,                                                CC03430000
               TYPE=LOCAL,                                            CC03431000
               MODE=UNCOND,                                           CC03432000
               REGS=USE,                                              CC03433000
               RELATED=('OBTAIN LOCAL LOCK')                            03434000
         LM    REG14,REG1,12(REG13)       RESTORE REGS 15,0   @ZM20858  03435000
*           /*********************************************************/ 03436000
*           /* THE RETURN CODES FROM THE RECEIVE NOW IN REGS 15 AND  */ 03437000
*           /* 0 WILL BE CHECKED IN THE CHKRESP PROCEDURE    @ZM20858*/ 03438000
*           /*********************************************************/ 03439000
*                                                                  0960 03440000
*           FRRPARM=REGPARM;               /* SAVE ADDRESS OF      0960 03441000
*                                             PARAMETER AREA       0960 03442000
*                                             PROVIDED BY          0960 03443000
*                                             SETFRR MACRO   @ZM20856*/ 03444000
         ST    REGPARM,FRRPARM                                     0960 03445000
*           RFY REG1 UNRSTD;               /* FREE REG 1     @ZM20856*/ 03446000
*           CALL INITFRR;                  /* CALL FRR INIT  @ZM20856*/ 03447000
         BAL   @14,INITFRR                                         0962 03448000
*           CHK = '1'B;                    /* CHECK RESPONSE AGAIN   */ 03449000
         OI    CHK(TOMWREG),B'00000001'                            0963 03450000
*           RPLCHN =  SRPLCHN;             /* RESTORE CHAIN ELEMENT  */ 03451000
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                0964 03452000
*           RFY (WRK2,WRK3,REGPARM,REG0,REG14,REG15) UNRSTD;       0965 03453000
*                                          /* FREE UP REGS   @ZM20858*/ 03454000
*           END ISSUERCV;                  /* END OF ISSUERCV        */ 03455000
@EL00018 DS    0H                                                  0966 03456000
@EF00018 DS    0H                                                  0966 03457000
@ER00018 L     @14,@SA00018                                        0966 03458000
         BR    @14                                                 0966 03459000
         EJECT                                                          03460000
*CHKSENSE:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0967 03461000
*                                                                  0967 03462000
CHKSENSE ST    @14,@SA00019                                        0967 03463000
*    /****************************************************************/ 03464000
*    /*                                                              */ 03465000
*    /*        PROCEDURE - CHKSENSE                                  */ 03466000
*    /*                                                              */ 03467000
*    /*        FUNCTION - TO CHECK THE SENSE INFORMATION OF THE RPL  */ 03468000
*    /*                   SSENSEO FIELD.                             */ 03469000
*    /*                   (1) FOR BUFFER CONTENTION (X'081B'), CALL  */ 03470000
*    /*                       BFCN.                                  */ 03471000
*    /*                   (2) FOR CANCEL (X'0811'), CALL CNCL.       */ 03472000
*    /*                   (3) FOR INTERVENTION REQUIRED (X'0802'),   */ 03473000
*    /*                       CALL PAPEROUT.                         */ 03474000
*    /*                   (4) FOR  BRACKET BID REJECT OR             */ 03475000
*    /*                       FOR  BRACKET STATE ERROR (X'2003'),    */ 03476000
*    /*                       CALL FIXIT.                    @ZA27108*/ 03477000
*    /*                   (5) FOR CHAINING ERROR (X'2002'),          */ 03478000
*    /*                       CALL FIXIT.                    @ZA27108*/ 03479000
*    /*                   (6) FOR FUNCTION NOT SUPPORTED (X'1003'),  */ 03480000
*    /*                       SET FCNERR TO 1                @ZA27108*/ 03481000
*    /*                       (TO BE CHECKED BY THE PROCEDURE        */ 03482000
*    /*                       EDITASIS), AND CALL FIXIT.             */ 03483000
*    /*                   (7) FOR PARAMETER ERROR (X'1005'),         */ 03484000
*    /*                       SET PARMERR TO 1               @ZA27108*/ 03485000
*    /*                       (TO BE CHECKED BY THE PROCEDURE        */ 03486000
*    /*                       EDITASIS), AND CALL FIXIT.             */ 03487000
*    /*                   (8) FOR OTHER CASES, AN ABEND WILL BE      */ 03488000
*    /*                       ISSUED.                                */ 03489000
*    /*                                                              */ 03490000
*    /****************************************************************/ 03491000
*                                                                  0968 03492000
*           /*********************************************************/ 03493000
*           /* BUFFER CONTENTION                                     */ 03494000
*           /*********************************************************/ 03495000
*                                                                  0968 03496000
*           IF RPLSSNSI = '081B'X THEN                             0968 03497000
         CLC   RPLSSNSI(2,RPLREG),@CB02886                         0968 03498000
         BNE   @RF00968                                            0968 03499000
*             CALL BFCN;                                           0969 03500000
         BAL   @14,BFCN                                            0969 03501000
*           ELSE                                                   0970 03502000
*                                                                  0970 03503000
*             /*******************************************************/ 03504000
*             /* CANCEL                                              */ 03505000
*             /*******************************************************/ 03506000
*                                                                  0970 03507000
*             IF RPLSSNSI = '0811'X THEN                           0970 03508000
         B     @RC00968                                            0970 03509000
@RF00968 CLC   RPLSSNSI(2,RPLREG),@CB02888                         0970 03510000
         BNE   @RF00970                                            0970 03511000
*               CALL CNCL;                                         0971 03512000
         BAL   @14,CNCL                                            0971 03513000
*             ELSE                                                 0972 03514000
*                                                                  0972 03515000
*               /*****************************************************/ 03516000
*               /* INTERVENTION REQUIRED                             */ 03517000
*               /*****************************************************/ 03518000
*                                                                  0972 03519000
*               IF RPLSSNSI = '0802'X THEN                         0972 03520000
         B     @RC00970                                            0972 03521000
@RF00970 CLC   RPLSSNSI(2,RPLREG),@CB02890                         0972 03522000
         BNE   @RF00972                                            0972 03523000
*                 CALL PAPEROUT;                                   0973 03524000
         BAL   @14,PAPEROUT                                        0973 03525000
*               ELSE                                               0974 03526000
*                                                                  0974 03527000
*                 /***************************************************/ 03528000
*                 /* BRACKET ERROR OR BRACKET STATE ERROR    @ZA27108*/ 03529000
*                 /***************************************************/ 03530000
*                                                                  0974 03531000
*                 IF RPLSSNSI = '0813'X |  /* BRACKET ERROR  @ZA27108*/ 03532000
*                    RPLSSNSI = '080B'X |  /* BRACKET ERROR  @ZA27108*/ 03533000
*                    RPLSSNSI = '2003'X /*BRACKET STATE ERROR@ZA27108*/ 03534000
*                 THEN                                             0974 03535000
         B     @RC00972                                            0974 03536000
@RF00972 CLC   RPLSSNSI(2,RPLREG),@CB02892                         0974 03537000
         BE    @RT00974                                            0974 03538000
         CLC   RPLSSNSI(2,RPLREG),@CB02893                         0974 03539000
         BE    @RT00974                                            0974 03540000
         CLC   RPLSSNSI(2,RPLREG),@CB02894                         0974 03541000
         BNE   @RF00974                                            0974 03542000
@RT00974 DS    0H                                                  0975 03543000
*                   DO;                                            0975 03544000
*                     IF TVWATOBB='0'B THEN /* BEG BRKT ^SENT@ZM20858*/ 03545000
         TM    TVWATOBB(TVWAREG),B'00000100'                       0976 03546000
         BNZ   @RF00976                                            0976 03547000
*                       TVWAINB='0'B;  /* SEND BEGIN BRACKET @ZM20858*/ 03548000
         NI    TVWAINB(TVWAREG),B'11111011'                        0977 03549000
*                     ELSE;                                        0978 03550000
@RF00976 DS    0H                                                  0979 03551000
*                     CALL FIXIT;                                  0979 03552000
         BAL   @14,FIXIT                                           0979 03553000
*                   END;                                           0980 03554000
*                 ELSE                                             0981 03555000
*                                                                  0981 03556000
*                     /***********************************************/ 03557000
*                     /* CHAINING ERROR                              */ 03558000
*                     /***********************************************/ 03559000
*                                                                  0981 03560000
*                     IF RPLSSNSI = '2002'X THEN                   0981 03561000
         B     @RC00974                                            0981 03562000
@RF00974 CLC   RPLSSNSI(2,RPLREG),@CB02896                         0981 03563000
         BNE   @RF00981                                            0981 03564000
*                         CALL  FIXIT;                             0982 03565000
         BAL   @14,FIXIT                                           0982 03566000
*                     ELSE                                         0983 03567000
*                                                                  0983 03568000
*                       /*********************************************/ 03569000
*                       /* FUNCTION NOT SUPPORTED - SVF              */ 03570000
*                       /*********************************************/ 03571000
*                                                                  0983 03572000
*                       IF RPLSSNSI = '1003'X THEN                 0983 03573000
         B     @RC00981                                            0983 03574000
@RF00981 CLC   RPLSSNSI(2,RPLREG),@CB02897                         0983 03575000
         BNE   @RF00983                                            0983 03576000
*                         DO;                                      0984 03577000
*                           FCNERR = '1'B;                         0985 03578000
         OI    FCNERR(TOMWREG),B'00100000'                         0985 03579000
*                           CALL FIXIT;                            0986 03580000
         BAL   @14,FIXIT                                           0986 03581000
*                         END;                                     0987 03582000
*                       ELSE                                       0988 03583000
*                                                                  0988 03584000
*                         /*******************************************/ 03585000
*                         /* PARAMETER ERROR                         */ 03586000
*                         /*******************************************/ 03587000
*                                                                  0988 03588000
*                         IF RPLSSNSI = '1005'X THEN               0988 03589000
         B     @RC00983                                            0988 03590000
@RF00983 CLC   RPLSSNSI(2,RPLREG),@CB02898                         0988 03591000
         BNE   @RF00988                                            0988 03592000
*                           DO;                                    0989 03593000
*                             PARMERR = '1'B;                      0990 03594000
         OI    PARMERR(TOMWREG),B'00010000'                        0990 03595000
*                             CALL  FIXIT;                         0991 03596000
         BAL   @14,FIXIT                                           0991 03597000
*                           END;                                   0992 03598000
*                                                                  0992 03599000
*                         ELSE                                     0993 03600000
*                             CALL REBLDRPL; /*REFRESH AND RETRY   0993 03601000
*                                              OTHERS        @ZM20858*/ 03602000
*                                                                  0993 03603000
         B     @RC00988                                            0993 03604000
@RF00988 BAL   @14,REBLDRPL                                        0993 03605000
*           END  CHKSENSE;                   /* END OF CHKSENSE      */ 03606000
@EL00019 DS    0H                                                  0994 03607000
@EF00019 DS    0H                                                  0994 03608000
@ER00019 L     @14,@SA00019                                        0994 03609000
         BR    @14                                                 0994 03610000
         EJECT                                                          03611000
*REBLDRPL:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     0995 03612000
*                                                                  0995 03613000
REBLDRPL ST    @14,@SA00020                                        0995 03614000
*           /*********************************************************/ 03615000
*           /*                                                       */ 03616000
*           /* PROCEDURE - REBLDRPL                                  */ 03617000
*           /*                                                       */ 03618000
*           /* FUNCTION - TO REBUILD THE RPL                         */ 03619000
*           /*                                                       */ 03620000
*           /*********************************************************/ 03621000
*                                                                  0996 03622000
*           RETRY  = RETRY + 1;      /* INCREMENT RETRY COUNT        */ 03623000
*                                                                  0996 03624000
         LA    @15,1                                               0996 03625000
         SLR   @14,@14                                             0996 03626000
         IC    @14,RETRY(,TOMWREG)                                 0996 03627000
         ALR   @15,@14                                             0996 03628000
         STC   @15,RETRY(,TOMWREG)                                 0996 03629000
*           IF RETRY > 3 THEN        /* ABEND SITUATION?             */ 03630000
         CLI   RETRY(TOMWREG),3                                    0997 03631000
         BNH   @RF00997                                            0997 03632000
*             CALL EXITFRR;          /* CALL ABEND ROUTINE   @ZM20856*/ 03633000
         BAL   @14,EXITFRR                                         0998 03634000
*           ELSE                     /* RETRY SITUATION              */ 03635000
*             DO;                    /* DO NOT ABEND                 */ 03636000
*                                                                  0999 03637000
         B     @RC00997                                            0999 03638000
@RF00997 DS    0H                                                  1000 03639000
*               IFGRPL = DUMMYRPL;   /* REBUILD RPL                  */ 03640000
         MVC   IFGRPL(112,RPLREG),DUMMYRPL                         1000 03641000
*               RPLAREA = ADDR(RU);  /* RU ADDRESS IN RPL DATA AREA  */ 03642000
         LA    @15,RU(,TOMWREG)                                    1001 03643000
         ST    @15,RPLAREA(,RPLREG)                                1001 03644000
*               RPLDACB = TVWAACB;   /* ACB ADDRESS                  */ 03645000
         L     @15,TVWAACB(,TVWAREG)                               1002 03646000
         ST    @15,RPLDACB(,RPLREG)                                1002 03647000
*               RPLARG = NIBCID;     /* CID                          */ 03648000
         L     @01,TVWANIB(,TVWAREG)                               1003 03649000
         L     @15,NIBCID(,@01)                                    1003 03650000
         ST    @15,RPLARG(,RPLREG)                                 1003 03651000
*               RPLNIB = '0'B;       /* CID IN RPLARG FIELD          */ 03652000
         NI    RPLNIB(RPLREG),B'11111011'                          1004 03653000
*               NEC = '0'B;          /* NOT NECESSARY TO RESEND RU   */ 03654000
         NI    NEC(TOMWREG),B'11111011'                            1005 03655000
*               BYPASS = '1'B;       /* BYPASS REST OF BLDEND        */ 03656000
         OI    BYPASS(TOMWREG),B'00000001'                         1006 03657000
*               CHARCNT = 0;         /* RESET PRINTABLE CHAR. COUNT  */ 03658000
         SLR   @15,@15                                             1007 03659000
         ST    @15,CHARCNT(,TOMWREG)                               1007 03660000
*               RETRYMSG = '1'B;     /* TURN ON RETRY MESSAGE SWITCH */ 03661000
         OI    RETRYMSG(TOMWREG),B'00001000'                       1008 03662000
*               CALL CHKOCEOC;       /* CANCEL CHAIN IF NECESSARY    */ 03663000
*                                                                  1009 03664000
*                                                                  1009 03665000
         BAL   @14,CHKOCEOC                                        1009 03666000
*               /*****************************************************/ 03667000
*               /* RESET MESSAGE POINTER.                            */ 03668000
*               /*****************************************************/ 03669000
*               OPREQ = RESET;       /* RESET MESSAGE POINTER        */ 03670000
         MVI   OPREQ(TOMWREG),X'07'                                1010 03671000
*               CALL IKTQMOUT(OPARMS);                             1011 03672000
*                                                                  1011 03673000
         LA    @15,OPARMS(,TOMWREG)                                1011 03674000
         ST    @15,@AL00001                                        1011 03675000
         L     @01,CVTPTR                                          1011 03676000
         L     @01,CVTTCASP(,@01)                                  1011 03677000
         L     @15,TCASOQM(,@01)                                   1011 03678000
         LA    @01,@AL00001                                        1011 03679000
         BALR  @14,@15                                             1011 03680000
*             END;                   /* END OF RETRY SITUATION       */ 03681000
*                                                                  1012 03682000
*           END REBLDRPL;            /* END OF REBLDRPL              */ 03683000
@EL00020 DS    0H                                                  1013 03684000
@EF00020 DS    0H                                                  1013 03685000
@ER00020 L     @14,@SA00020                                        1013 03686000
         BR    @14                                                 1013 03687000
         EJECT                                                          03688000
*REISSUE:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1014 03689000
*                                                                  1014 03690000
REISSUE  ST    @14,@SA00021                                        1014 03691000
*           /*********************************************************/ 03692000
*           /*                                                       */ 03693000
*           /* PROCEDURE - REISSUE                                   */ 03694000
*           /*                                                       */ 03695000
*           /* FUNCTION - TO ESTABLISH CONDITIONS FOR RETRY ATTEMPT  */ 03696000
*           /*                                                       */ 03697000
*           /*********************************************************/ 03698000
*                                                                  1015 03699000
*           RETRY = RETRY + 1;         /* INCREMENT RETRY COUNT      */ 03700000
*                                                                  1015 03701000
         LA    @15,1                                               1015 03702000
         SLR   @14,@14                                             1015 03703000
         IC    @14,RETRY(,TOMWREG)                                 1015 03704000
         ALR   @15,@14                                             1015 03705000
         STC   @15,RETRY(,TOMWREG)                                 1015 03706000
*           IF RETRY > 3 THEN          /* ABEND SITUATION?           */ 03707000
         CLI   RETRY(TOMWREG),3                                    1016 03708000
         BNH   @RF01016                                            1016 03709000
*             CALL EXITFRR;            /* CALL ABEND ROUTINE @ZM20856*/ 03710000
         BAL   @14,EXITFRR                                         1017 03711000
*           ELSE                       /* RETRY SITUATION            */ 03712000
*             DO;                      /* PREPARE FOR RETRY          */ 03713000
         B     @RC01016                                            1018 03714000
@RF01016 DS    0H                                                  1019 03715000
*               CALL CHKOCEOC;         /* CANCEL CHAIN IF NECESSARY  */ 03716000
         BAL   @14,CHKOCEOC                                        1019 03717000
*               RPLVTFL2 = RESPPOS;    /* POST=RESP AND            1020 03718000
*                                         RESPOND=(NEX,FME,NRRN)     */ 03719000
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1020 03720000
*             END;                     /* END OF RETRY SITUATION     */ 03721000
*                                                                  1021 03722000
*           END REISSUE;               /* END OF REISSUE             */ 03723000
@EL00021 DS    0H                                                  1022 03724000
@EF00021 DS    0H                                                  1022 03725000
@ER00021 L     @14,@SA00021                                        1022 03726000
         BR    @14                                                 1022 03727000
         EJECT                                                          03728000
*BFCN:      PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1023 03729000
*                                                                  1023 03730000
BFCN     ST    @14,@SA00022                                        1023 03731000
*           /*********************************************************/ 03732000
*           /*                                                       */ 03733000
*           /* PROCEDURE - BFCN                                      */ 03734000
*           /*                                                       */ 03735000
*           /* FUNCTION - TO HANDLE BUFFER CONTENTION SITUATION      */ 03736000
*           /*                                                       */ 03737000
*           /*********************************************************/ 03738000
*                                                                  1024 03739000
*           SWNL = '1'B;                  /* START ON NEW LINE       */ 03740000
         OI    SWNL(TOMWREG),B'01000000'                           1024 03741000
*           CHARCNT = 0;                  /* RESET PRINT.-CHAR. COUNT*/ 03742000
         SLR   @15,@15                                             1025 03743000
         ST    @15,CHARCNT(,TOMWREG)                               1025 03744000
*           CALL CHKOCEOC;                /* CANCEL CHAIN IF NEC.    */ 03745000
*                                                                  1026 03746000
         BAL   @14,CHKOCEOC                                        1026 03747000
*           IF TVWARTRY = '1'B THEN       /* RETRY SITUATION?        */ 03748000
         TM    TVWARTRY(TVWAREG),B'00000010'                       1027 03749000
         BNO   @RF01027                                            1027 03750000
*             DO;                         /* DO THE FOLLOWING        */ 03751000
*               TVWARTRY = '0'B;          /* RESET RETRY SWITCH      */ 03752000
         NI    TVWARTRY(TVWAREG),B'11111101'                       1029 03753000
*               /*****************************************************/ 03754000
*               /* IF GLOBAL ERROR, RESEND RU.  OTHERWISE, RESET     */ 03755000
*               /* MESSAGE POINTER AND TRY AGAIN.                    */ 03756000
*               /*****************************************************/ 03757000
*               IF ERMG = '1'B THEN;      /* IF GLOBAL ERROR       1030 03758000
*                                            RESEND GLOBAL ERROR MSG */ 03759000
         TM    ERMG(TOMWREG),B'00001000'                           1030 03760000
         BO    @RT01030                                            1030 03761000
*               ELSE                      /* NOT GLOBAL ERROR        */ 03762000
*                 DO;                     /* DO THE FOLLOWING        */ 03763000
*                   OPREQ = RESET;        /* RESET MESSAGE POINTER   */ 03764000
         MVI   OPREQ(TOMWREG),X'07'                                1033 03765000
*                   CALL IKTQMOUT(OPARMS);                         1034 03766000
         LA    @15,OPARMS(,TOMWREG)                                1034 03767000
         ST    @15,@AL00001                                        1034 03768000
         L     @01,CVTPTR                                          1034 03769000
         L     @01,CVTTCASP(,@01)                                  1034 03770000
         L     @15,TCASOQM(,@01)                                   1034 03771000
         LA    @01,@AL00001                                        1034 03772000
         BALR  @14,@15                                             1034 03773000
*                   BYPASS = '1'B;        /* BYPASS REST OF BLDEND   */ 03774000
         OI    BYPASS(TOMWREG),B'00000001'                         1035 03775000
*                   NEC = '0'B;           /* DO NOT RESEND           */ 03776000
         NI    NEC(TOMWREG),B'11111011'                            1036 03777000
*                 END;                                             1037 03778000
*             END;                        /* END OF RETRY SITUATION  */ 03779000
*           ELSE                          /* NOT RETRY SITUATION     */ 03780000
*             /*******************************************************/ 03781000
*             /* IF GLOBAL ERROR, SEND SIGNAL AND RESEND RU.         */ 03782000
*             /*******************************************************/ 03783000
*             IF ERMG = '1'B THEN         /* GLOBAL ERROR?           */ 03784000
         B     @RC01027                                            1039 03785000
@RF01027 TM    ERMG(TOMWREG),B'00001000'                           1039 03786000
         BNO   @RF01039                                            1039 03787000
*               CALL SENDSIG;             /* SEND SIGNAL             */ 03788000
         BAL   @14,SENDSIG                                         1040 03789000
*             ELSE                        /* NOT GLOBAL ERROR        */ 03790000
*               DO;                       /* DO THE FOLLOWING        */ 03791000
         B     @RC01039                                            1041 03792000
@RF01039 DS    0H                                                  1042 03793000
*                 OPREQ = RESET;          /* RESET MESSAGE POINTER   */ 03794000
         MVI   OPREQ(TOMWREG),X'07'                                1042 03795000
*                 CALL IKTQMOUT(OPARMS);  /* CALL QUEUE MANAGER      */ 03796000
         LA    @15,OPARMS(,TOMWREG)                                1043 03797000
         ST    @15,@AL00001                                        1043 03798000
         L     @01,CVTPTR                                          1043 03799000
         L     @01,CVTTCASP(,@01)                                  1043 03800000
         L     @15,TCASOQM(,@01)                                   1043 03801000
         LA    @01,@AL00001                                        1043 03802000
         BALR  @14,@15                                             1043 03803000
*                 NEC = '0'B;             /* DO NOT RESEND RU        */ 03804000
         NI    NEC(TOMWREG),B'11111011'                            1044 03805000
*                 BYPASS = '1'B;          /* BYPASS REST OF BLDEND   */ 03806000
         OI    BYPASS(TOMWREG),B'00000001'                         1045 03807000
*                 /***************************************************/ 03808000
*                 /* IF THERE IS A BREAK-IN MESSAGE ON THE QUEUE OR  */ 03809000
*                 /* IF A BREAK-IN MESSAGE IS BEING PROCESSED, DO    */ 03810000
*                 /* THE FOLLOWING.                                  */ 03811000
*                 /***************************************************/ 03812000
*                 IF TVWABIR = '1'B |       /* BREAK TPUT ON QUEUE?  */ 03813000
*                    BRK='1'B THEN          /* CURRENT TPUT A BREAK? */ 03814000
         TM    TVWABIR(TVWAREG),B'00000001'                        1046 03815000
         BO    @RT01046                                            1046 03816000
         TM    BRK(TOMWREG),B'10000000'                            1046 03817000
         BNO   @RF01046                                            1046 03818000
@RT01046 DS    0H                                                  1047 03819000
*                   DO;                     /* HANDLE BREAK-IN CASE  */ 03820000
*                     TVWABRIN = '1'B;      /* BREAK-IN SITUATION    */ 03821000
         OI    TVWABRIN(TVWAREG),B'10000000'                       1048 03822000
*                     BRK = '0'B;           /* RESET BREAK SWITCH    */ 03823000
         NI    BRK(TOMWREG),B'01111111'                            1049 03824000
*                     CALL SENDSIG;         /* SEND SIGNAL           */ 03825000
         BAL   @14,SENDSIG                                         1050 03826000
*                     SIGSENT = '1'B;       /* SIGNAL SENT           */ 03827000
         OI    SIGSENT(TOMWREG),B'00010000'                        1051 03828000
*                     /***********************************************/ 03829000
*                     /* IF CHANGE-DIRECTION RECEIVED, TRY AGAIN.    */ 03830000
*                     /* OTHERWISE, EXIT.                            */ 03831000
*                     /***********************************************/ 03832000
*                     IF TVWASCD = '1'B THEN /* CHANGE DIRECTION?    */ 03833000
         TM    TVWASCD(TVWAREG),B'00100000'                        1052 03834000
         BNO   @RF01052                                            1052 03835000
*                       TVWASCD = '0'B;     /* RESET DIRECTION SWITCH*/ 03836000
         NI    TVWASCD(TVWAREG),B'11011111'                        1053 03837000
*                     ELSE                  /* NOT CHANGE DIRECTION  */ 03838000
*                       DO;                                        1054 03839000
         B     @RC01052                                            1054 03840000
@RF01052 DS    0H                                                  1055 03841000
*                         AGAIN = '0'B;     /* STOP CHAINING PROCESS */ 03842000
         NI    AGAIN(TOMWREG),B'11111110'                          1055 03843000
*                         TVWATAS = '1'B;   /* TOM NOT AVAILABLE     */ 03844000
         OI    TVWATAS(TVWAREG),B'00100000'                        1056 03845000
*                         TVWABKMG = '0'B;  /* NO BREAK-IN MESSAGE   */ 03846000
         NI    TVWABKMG(TVWAREG),B'11111011'                       1057 03847000
*                         SIGSENT = '0'B;   /* RESET SIGNAL SWITCH   */ 03848000
         NI    SIGSENT(TOMWREG),B'11101111'                        1058 03849000
*                         XIT = '1'B;       /* EXIT                  */ 03850000
         OI    XIT(TOMWREG),B'00000100'                            1059 03851000
*                       END;                                       1060 03852000
*                   END;                                           1061 03853000
*                 ELSE                                             1062 03854000
*                   /*************************************************/ 03855000
*                   /* WHEN NO BREAK-IN MESSAGE INVOLVED, EXIT.      */ 03856000
*                   /*************************************************/ 03857000
*                   DO;                                            1062 03858000
         B     @RC01046                                            1062 03859000
@RF01046 DS    0H                                                  1063 03860000
*                     TVWABKMG = '0'B;      /* NO BREAK-IN MESSAGE   */ 03861000
         NI    TVWABKMG(TVWAREG),B'11111011'                       1063 03862000
*                     SIGSENT = '0'B;       /* RESET SIGNAL SWITCH   */ 03863000
         NI    SIGSENT(TOMWREG),B'11101111'                        1064 03864000
*                     TVWATAS = '1'B;       /* TOM NOT AVAILABLE     */ 03865000
         OI    TVWATAS(TVWAREG),B'00100000'                        1065 03866000
*                     AGAIN = '0'B;         /* STOP CHAINING PROCESS */ 03867000
         NI    AGAIN(TOMWREG),B'11111110'                          1066 03868000
*                     XIT = '1'B;           /* EXIT                  */ 03869000
         OI    XIT(TOMWREG),B'00000100'                            1067 03870000
*                     TVWABFC = '1'B;       /* BUFFER CONTENTION     */ 03871000
         OI    TVWABFC(TVWAREG),B'10000000'                        1068 03872000
*                   END;                                           1069 03873000
*               END;                                               1070 03874000
*                                                                  1070 03875000
*           END BFCN;                       /* END OF BFCN           */ 03876000
@EL00022 DS    0H                                                  1071 03877000
@EF00022 DS    0H                                                  1071 03878000
@ER00022 L     @14,@SA00022                                        1071 03879000
         BR    @14                                                 1071 03880000
         EJECT                                                          03881000
*CNCL:      PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1072 03882000
*                                                                  1072 03883000
CNCL     ST    @14,@SA00023                                        1072 03884000
*           /*********************************************************/ 03885000
*           /*                                                       */ 03886000
*           /* PROCEDURE - CNCL                                      */ 03887000
*           /*                                                       */ 03888000
*           /* FUNCTION  -    CALL CHKOCEOC SO THAT THE CURRENT      */ 03889000
*           /*                CHAIN WILL BE CANCELED IF THE LAST     */ 03890000
*           /*                CHAIN-ELEMENT SENT WAS A BEGINNING OF  */ 03891000
*           /*                CHAIN OR A MIDDLE OF CHAIN.            */ 03892000
*           /*                                                       */ 03893000
*           /*********************************************************/ 03894000
*                                                                  1073 03895000
*           RETRY = 0;            /* RESET RETRY COUNT               */ 03896000
         MVI   RETRY(TOMWREG),X'00'                                1073 03897000
*           RETRYMSG='0'B;        /* RESET RETRY-MESSAGE FLAG      1074 03898000
*                                                            @ZM21462*/ 03899000
         NI    RETRYMSG(TOMWREG),B'11110111'                       1074 03900000
*           SWNL = '1'B;          /* START NEXT MESSAGE ON NEW LINE  */ 03901000
         OI    SWNL(TOMWREG),B'01000000'                           1075 03902000
*           CHARCNT = 0;          /* RESET PRINTABLE CHARACTER COUNT */ 03903000
         SLR   @15,@15                                             1076 03904000
         ST    @15,CHARCNT(,TOMWREG)                               1076 03905000
*           CALL CHKOCEOC;        /* CANCEL CHAIN IF NECESSARY       */ 03906000
*                                                                  1077 03907000
         BAL   @14,CHKOCEOC                                        1077 03908000
*           IF TVWADOOQ='1'B THEN /* MESSAGE ON QUEUE?               */ 03909000
         TM    TVWADOOQ(TVWAREG),B'01000000'                       1078 03910000
         BNO   @RF01078                                            1078 03911000
*             NEC = '0'B;         /* DO NOT RESEND RU                */ 03912000
         NI    NEC(TOMWREG),B'11111011'                            1079 03913000
*           ELSE                  /* NO MESSAGE ON QUEUE             */ 03914000
*             DO;                 /* SEND SPACE-BACKSPACE AS OC      */ 03915000
         B     @RC01078                                            1080 03916000
@RF01078 DS    0H                                                  1081 03917000
*               NEC = '1'B;       /* DO ANOTHER SEND                 */ 03918000
         OI    NEC(TOMWREG),B'00000100'                            1081 03919000
*               RU(1:2)='4016'X;  /* SPACE-BACKSPACE                 */ 03920000
         MVC   RU(2,TOMWREG),@CB02804                              1082 03921000
*               BYTECNT = 3;      /* NEXT AVAILABLE BYTE POSITION    */ 03922000
         MVC   BYTECNT(4,TOMWREG),@CF00291                         1083 03923000
*               RPLVTFL2 = RESPPOS;                                1084 03924000
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1084 03925000
*             END;                                                 1085 03926000
*                                                                  1085 03927000
*           END CNCL;             /* END OF CNCL                     */ 03928000
@EL00023 DS    0H                                                  1086 03929000
@EF00023 DS    0H                                                  1086 03930000
@ER00023 L     @14,@SA00023                                        1086 03931000
         BR    @14                                                 1086 03932000
         EJECT                                                          03933000
*PAPEROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1087 03934000
*                                                                  1087 03935000
PAPEROUT ST    @14,@SA00024                                        1087 03936000
*           /*********************************************************/ 03937000
*           /*                                                       */ 03938000
*           /* PROCEDURE - PAPEROUT                                  */ 03939000
*           /*                                                       */ 03940000
*           /* FUNCTION - TO HANDLE OUT-OF-PAPER CONDITION           */ 03941000
*           /*                                                       */ 03942000
*           /*********************************************************/ 03943000
*                                                                  1088 03944000
*           CHARCNT = 0;          /* RESET PRINTABLE CHARACTER COUNT */ 03945000
         SLR   @15,@15                                             1088 03946000
         ST    @15,CHARCNT(,TOMWREG)                               1088 03947000
*           SWNL = '1'B;          /* START NEXT MESSAGE ON NEW LINE  */ 03948000
         OI    SWNL(TOMWREG),B'01000000'                           1089 03949000
*           CALL CHKOCEOC;        /* CANCEL CHAIN IF NECESSARY       */ 03950000
*                                                                  1090 03951000
         BAL   @14,CHKOCEOC                                        1090 03952000
*           IF TVWARTRY='1'B THEN /* RETRY SITUATION?                */ 03953000
         TM    TVWARTRY(TVWAREG),B'00000010'                       1091 03954000
         BNO   @RF01091                                            1091 03955000
*             DO;                 /* DO THE FOLLOWING                */ 03956000
*               TVWARTRY = '0'B;  /* RESET RETRY SWITCH              */ 03957000
*                                                                  1093 03958000
         NI    TVWARTRY(TVWAREG),B'11111101'                       1093 03959000
*               /*****************************************************/ 03960000
*               /* IF GLOBAL ERROR, RESEND RU.                       */ 03961000
*               /* OTHERWISE, RESET MESSAGE POINTER AND TRY AGAIN.   */ 03962000
*               /*****************************************************/ 03963000
*               IF ERMG='1'B THEN; /* IF GLOBAL ERROR, RESEND RU.    */ 03964000
         TM    ERMG(TOMWREG),B'00001000'                           1094 03965000
         BO    @RT01094                                            1094 03966000
*               ELSE              /* NOT GLOBAL ERROR                */ 03967000
*                 DO;             /* DO THE FOLLOWING                */ 03968000
*                   OPREQ = RESET;         /* RESET MESSAGE POINTER  */ 03969000
         MVI   OPREQ(TOMWREG),X'07'                                1097 03970000
*                   CALL IKTQMOUT(OPARMS); /* CALL QUEUE MANAGER     */ 03971000
         LA    @15,OPARMS(,TOMWREG)                                1098 03972000
         ST    @15,@AL00001                                        1098 03973000
         L     @01,CVTPTR                                          1098 03974000
         L     @01,CVTTCASP(,@01)                                  1098 03975000
         L     @15,TCASOQM(,@01)                                   1098 03976000
         LA    @01,@AL00001                                        1098 03977000
         BALR  @14,@15                                             1098 03978000
*                   BYPASS = '1'B;         /* BYPASS REST OF BLDEND  */ 03979000
         OI    BYPASS(TOMWREG),B'00000001'                         1099 03980000
*                   NEC = '0'B;   /* DO NOT RESEND RU                */ 03981000
         NI    NEC(TOMWREG),B'11111011'                            1100 03982000
*                 END;                                             1101 03983000
*             END;                /* END OF RETRY SITUATION          */ 03984000
*           ELSE                  /* NOT RETRY SITUATION             */ 03985000
*             DO;                 /* DO THE FOLLOWING                */ 03986000
         B     @RC01091                                            1103 03987000
@RF01091 DS    0H                                                  1104 03988000
*               OPREQ = RESET;    /* RESET MESSAGE POINTER           */ 03989000
         MVI   OPREQ(TOMWREG),X'07'                                1104 03990000
*               CALL IKTQMOUT(OPARMS);                             1105 03991000
         LA    @15,OPARMS(,TOMWREG)                                1105 03992000
         ST    @15,@AL00001                                        1105 03993000
         L     @01,CVTPTR                                          1105 03994000
         L     @01,CVTTCASP(,@01)                                  1105 03995000
         L     @15,TCASOQM(,@01)                                   1105 03996000
         LA    @01,@AL00001                                        1105 03997000
         BALR  @14,@15                                             1105 03998000
*               NEC = '0'B;       /* DO NOT RESEND RU                */ 03999000
         NI    NEC(TOMWREG),B'11111011'                            1106 04000000
*               BYPASS = '1'B;    /* BYPASS REST OF BLDEND           */ 04001000
         OI    BYPASS(TOMWREG),B'00000001'                         1107 04002000
*               TVWATAS = '1'B;   /* TOM IS NOT AVAILABLE            */ 04003000
*               TVWAOOPS = '1'B;  /* OUT OF PAPER CONDITION          */ 04004000
         OI    TVWATAS(TVWAREG),B'00100001'                        1109 04005000
*               AGAIN = '0'B;     /* STOP CHAINING PROCESS           */ 04006000
         NI    AGAIN(TOMWREG),B'11111110'                          1110 04007000
*               XIT = '1'B;       /* EXIT                            */ 04008000
         OI    XIT(TOMWREG),B'00000100'                            1111 04009000
*             END;                /* END OF NON-RETRY SITUATION      */ 04010000
*                                                                  1112 04011000
*           END PAPEROUT;         /* END OF PAPEROUT                 */ 04012000
@EL00024 DS    0H                                                  1113 04013000
@EF00024 DS    0H                                                  1113 04014000
@ER00024 L     @14,@SA00024                                        1113 04015000
         BR    @14                                                 1113 04016000
         EJECT                                                          04017000
*FIXIT:     PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1114 04018000
*                                                                  1114 04019000
FIXIT    ST    @14,@SA00025                                        1114 04020000
*           /*********************************************************/ 04021000
*           /*                                                       */ 04022000
*           /* PROCEDURE - FIXIT                                     */ 04023000
*           /*                                                       */ 04024000
*           /* FUNCTION - TO HANDLE BRACKET BID REJECT, BRACKET      */ 04025000
*           /*            STATE ERROR, CHAINING ERROR, FUNCTION NOT  */ 04026000
*           /*            SUPPORTED, AND PARAMETER ERROR.            */ 04027000
*           /*                                                       */ 04028000
*           /*********************************************************/ 04029000
*                                                                  1115 04030000
*           RETRY = RETRY + 1;      /* INCREMENT RETRY COUNT         */ 04031000
*                                                                  1115 04032000
         LA    @15,1                                               1115 04033000
         SLR   @14,@14                                             1115 04034000
         IC    @14,RETRY(,TOMWREG)                                 1115 04035000
         ALR   @15,@14                                             1115 04036000
         STC   @15,RETRY(,TOMWREG)                                 1115 04037000
*           IF RETRY > 3 THEN       /* ABEND SITUATION?              */ 04038000
         CLI   RETRY(TOMWREG),3                                    1116 04039000
         BNH   @RF01116                                            1116 04040000
*             CALL EXITFRR;         /* CALL ABEND ROUTINE    @ZM20856*/ 04041000
         BAL   @14,EXITFRR                                         1117 04042000
*           ELSE                    /* RETRY SITUATION               */ 04043000
*             DO;                   /* DO THE FOLLOWING              */ 04044000
         B     @RC01116                                            1118 04045000
@RF01116 DS    0H                                                  1119 04046000
*               NEC = '0'B;         /* NOT NECESSARY TO RESEND       */ 04047000
         NI    NEC(TOMWREG),B'11111011'                            1119 04048000
*               CHARCNT = 0;        /* RESET PRINTABLE CHAR. COUNT   */ 04049000
         SLR   @15,@15                                             1120 04050000
         ST    @15,CHARCNT(,TOMWREG)                               1120 04051000
*               BYPASS = '1'B;      /* BYPASS REST OF BLDEND         */ 04052000
         OI    BYPASS(TOMWREG),B'00000001'                         1121 04053000
*               CALL CHKOCEOC;      /* CANCEL CHAIN IF NECESSARY     */ 04054000
         BAL   @14,CHKOCEOC                                        1122 04055000
*               OPREQ = RESET;      /* RESET MESSAGE POINTER         */ 04056000
         MVI   OPREQ(TOMWREG),X'07'                                1123 04057000
*               CALL IKTQMOUT(OPARMS);                             1124 04058000
         LA    @15,OPARMS(,TOMWREG)                                1124 04059000
         ST    @15,@AL00001                                        1124 04060000
         L     @01,CVTPTR                                          1124 04061000
         L     @01,CVTTCASP(,@01)                                  1124 04062000
         L     @15,TCASOQM(,@01)                                   1124 04063000
         LA    @01,@AL00001                                        1124 04064000
         BALR  @14,@15                                             1124 04065000
*               RETRYMSG = '1'B;    /* RETRY MESSAGE TO BE SEND      */ 04066000
         OI    RETRYMSG(TOMWREG),B'00001000'                       1125 04067000
*             END;                  /* END OF RETRY SITUATION        */ 04068000
*                                                                  1126 04069000
*           END FIXIT;              /* END OF FIXIT                  */ 04070000
@EL00025 DS    0H                                                  1127 04071000
@EF00025 DS    0H                                                  1127 04072000
@ER00025 L     @14,@SA00025                                        1127 04073000
         BR    @14                                                 1127 04074000
         EJECT                                                          04075000
*SENDSIG:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1128 04076000
*                                                                  1128 04077000
SENDSIG  ST    @14,@SA00026                                        1128 04078000
*           /*********************************************************/ 04079000
*           /*                                                       */ 04080000
*           /* PROCEDURE - SENDSIG                                   */ 04081000
*           /*                                                       */ 04082000
*           /* FUNCTION - TO SEND SIGNAL                             */ 04083000
*           /*                                                       */ 04084000
*           /*********************************************************/ 04085000
*                                                                  1129 04086000
*           /*********************************************************/ 04087000
*           /* A.  RELEASE THE LOCAL LOCK.                           */ 04088000
*           /* B.  SEND SIGNAL.                                      */ 04089000
*           /* C.  RESET THE FRR.                                    */ 04090000
*           /* D.  OBTAIN THE LOCAL LOCK.                            */ 04091000
*           /*********************************************************/ 04092000
*                                                                  1129 04093000
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) RSTD;    1129 04094000
*           MPSTSOIR='0'B;             /* RESET IWAIT SYSEVENT     1130 04095000
*                                         REQUEST FLAG               */ 04096000
*           MPSTSOIW='0'B;             /* RESET IWAIT SYSEVENT FLAG  */ 04097000
         L     @04,PSAAOLD                                         1131 04098000
         L     @04,ASCBASXB(,@04)                                  1131 04099000
         L     @04,ASXBMPST(,@04)                                  1131 04100000
         NI    MPSTSOIR(@04),B'00111111'                           1131 04101000
*           SRPLCHN = RPLCHN;          /* SAVE CHAIN ELEMENT         */ 04102000
         MVC   SRPLCHN(1,TOMWREG),RPLCHN+16(RPLREG)                1132 04103000
*           WRK2 = ADDR(IFGRPL);       /* RPL ADDRESS                */ 04104000
*                                                                  1133 04105000
         LR    WRK2,RPLREG                                         1133 04106000
*           GENERATE REFS(FRRPTR,FRRSCURR,FRRS,FRRSLAST,PSALSFCC,PSA,   04107000
*                         FRRSELEN,PSACSTK,FRRSFRRA,FRRSENTR,FRRSPARM,  04108000
*                         PSALITA,FLC)                             1134 04109000
*                    SETS(WRK2,WRK3,REGPARM,REG0,REG1,REG13,REG14, 1134 04110000
*                         REG15);                                  1134 04111000
*                                                                  1134 04112000
       SETLOCK RELEASE,                                               CC04113000
               TYPE=LOCAL,                                            CC04114000
               REGS=USE,                                              CC04115000
               RELATED=(RPL)                                            04116000
       SEND    RPL=(WRK2),                                            CC04117000
               STYPE=REQ,                                             CC04118000
               OPTCD=(SYN,CS),                              @ZA24528  CC04119000
               CONTROL=SIGNAL                                           04120000
       SETFRR  A,                                                     CC04121000
               FRRAD=(FRRPTR),                                        CC04122000
               PARMAD=(REGPARM),                                      CC04123000
               WRKREGS=(WRK2,WRK3)                                      04124000
       SETLOCK OBTAIN,                                                CC04125000
               TYPE=LOCAL,                                            CC04126000
               MODE=UNCOND,                                           CC04127000
               REGS=USE,                                              CC04128000
               RELATED=(RPL)                                            04129000
*           FRRPARM=REGPARM;           /* SAVE ADDRESS OF PARAMETER     04130000
*                                         AREA PROVIDED BY SETFRR  1135 04131000
*                                         MACRO              @ZM20856*/ 04132000
         ST    REGPARM,FRRPARM                                     1135 04133000
*           RFY (WRK2,WRK3,REGPARM,REG0,REG1,REG14,REG15) UNRSTD;  1136 04134000
*                                                                  1136 04135000
*           CALL INITFRR;              /* CALL FRR INIT      @ZM20856*/ 04136000
         BAL   @14,INITFRR                                         1137 04137000
*           RPLFMHDR='0'B;             /* RESET FORMAT HDR   @ZA26553*/ 04138000
         NI    RPLFMHDR(RPLREG),B'11111110'                        1138 04139000
*           RPLCHN = SRPLCHN;          /* RESTORE CHAIN ELEMENT      */ 04140000
*                                                                  1139 04141000
         MVC   RPLCHN+16(1,RPLREG),SRPLCHN(TOMWREG)                1139 04142000
*           END SENDSIG;               /* END OF SENDSIG             */ 04143000
@EL00026 DS    0H                                                  1140 04144000
@EF00026 DS    0H                                                  1140 04145000
@ER00026 L     @14,@SA00026                                        1140 04146000
         BR    @14                                                 1140 04147000
         EJECT                                                          04148000
*POSTROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1141 04149000
*                                                                  1141 04150000
POSTROUT ST    @14,@SA00027                                        1141 04151000
*           /*********************************************************/ 04152000
*           /*                                                       */ 04153000
*           /* PROCEDURE - POSTROUT                                  */ 04154000
*           /*                                                       */ 04155000
*           /* FUNCTION - CALL STATUS TO RESET ALL TASKS IN STEP     */ 04156000
*           /*            THAT ARE SUSPENDED FOR TCBOWAIT.  STATUS   */ 04157000
*           /*            IS BRANCH-ENTERED WHILE THE LOCAL LOCK IS  */ 04158000
*           /*            IS HELD.                                   */ 04159000
*           /*            THE FOLLOWING CODE REQUIRES PREVIOUS       */ 04160000
*           /*            ADDRESSABILITY TO THE SCVT TO OBTAIN THE   */ 04161000
*           /*            ADDRESS OF STATUS AND THE ASCB TO OBTAIN   */ 04162000
*           /*            THE ASID.                                  */ 04163000
*           /*                                                       */ 04164000
*           /*********************************************************/ 04165000
*                                                                  1142 04166000
*           RFY WRK2 RSTD;              /* RESTRICT WORK REGISTER    */ 04167000
*           WRK2 = TOMWREG;             /* SAVE ADDRESS OF WORK AREA */ 04168000
*                                                                  1143 04169000
         LR    WRK2,TOMWREG                                        1143 04170000
*           HLD = '0'B;                 /* RESET HOLD SWITCH         */ 04171000
         NI    HLD(TOMWREG),B'10111111'                            1144 04172000
*           IF TSBOWAIT = '1'B THEN     /* OWAIT?                    */ 04173000
         TM    TSBOWAIT(TSBREG),B'00100000'                        1145 04174000
         BNO   @RF01145                                            1145 04175000
*             DO;                       /* BEGIN OWAIT PROCESSING    */ 04176000
*               TSBOWAIT = '0'B;        /* RESET OWAIT SWITCH        */ 04177000
         NI    TSBOWAIT(TSBREG),B'11011111'                        1147 04178000
*               RFY(REG0,REG1,REG13) RSTD;                         1148 04179000
*                                                                  1148 04180000
*               /*****************************************************/ 04181000
*               /* PLACE ASID IN THE UPPER HALF OF REGISTER 0 AND    */ 04182000
*               /* ENTRY CODE (ALL TASKS IN STEP) IN LOWER HALF OF   */ 04183000
*               /* REGISTER 0.                                       */ 04184000
*               /*****************************************************/ 04185000
*                                                                  1149 04186000
*               REG0=8;                                            1149 04187000
         LA    REG0,8                                              1149 04188000
*               REG1='80000000'X;       /* RESET INDICATED           */ 04189000
         L     REG1,@CF02008                                       1150 04190000
*               REG13='0400'X;          /* TCBOWAIT BEING MANIPULATED*/ 04191000
         LA    REG13,1024                                          1151 04192000
*               CALL STATUS;            /* CALL STATUS               */ 04193000
         L     @03,CVTPTR                                          1152 04194000
         L     @03,CVTABEND(,@03)                                  1152 04195000
         L     @15,SCVTSTAT(,@03)                                  1152 04196000
         BALR  @14,@15                                             1152 04197000
*               RFY(REG0,REG1,REG13) UNRSTD;                       1153 04198000
*             END;                      /* END OF OWAIT PROCESSING   */ 04199000
*           ELSE;                       /* NOT OWAIT SITUATION       */ 04200000
@RF01145 DS    0H                                                  1156 04201000
*           TOMWREG = WRK2;             /* RESTORE WORK AREA ADDRESS */ 04202000
         LR    TOMWREG,WRK2                                        1156 04203000
*           RFY WRK2 UNRSTD;            /* UNRESTRICT WORK REGISTER  */ 04204000
*                                                                  1157 04205000
*           END POSTROUT;               /* END OF POSTROUT           */ 04206000
@EL00027 DS    0H                                                  1158 04207000
@EF00027 DS    0H                                                  1158 04208000
@ER00027 L     @14,@SA00027                                        1158 04209000
         BR    @14                                                 1158 04210000
         EJECT                                                          04211000
*PRMPTCHK:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1159 04212000
*                                                                  1159 04213000
PRMPTCHK ST    @14,@SA00028                                        1159 04214000
*           /*********************************************************/ 04215000
*           /*                                                       */ 04216000
*           /* PROCEDURE - PRMPTCHK                                  */ 04217000
*           /*                                                       */ 04218000
*           /* FUNCTION - TO CHECK FOR AUTO-PROMPTING                */ 04219000
*           /*                                                       */ 04220000
*           /*********************************************************/ 04221000
*                                                                  1160 04222000
*           /*********************************************************/ 04223000
*           /* IF TCLEARQ HAS STOPPED PROMPTING, DO NOTHING.         */ 04224000
*           /*********************************************************/ 04225000
*           IF TSBSPIT = '1'B THEN;                                1160 04226000
         TM    TSBSPIT(TSBREG),B'00100000'                         1160 04227000
         BO    @RT01160                                            1160 04228000
*           ELSE                                                   1162 04229000
*             /*******************************************************/ 04230000
*             /* IF AUTO-PROMPTING HAS BEEN REQUESTED, PROCEED.      */ 04231000
*             /*******************************************************/ 04232000
*             IF TSBAUTON = '1'B THEN                              1162 04233000
         TM    TSBAUTON(TSBREG),B'01000000'                        1162 04234000
         BNO   @RF01162                                            1162 04235000
*               /*****************************************************/ 04236000
*               /* IF USER IS TO BE PROMPTED, CONTINUE.              */ 04237000
*               /*****************************************************/ 04238000
*               IF TSBSTAUT = '1'B THEN                            1163 04239000
         TM    TSBSTAUT(TSBREG),B'00000100'                        1163 04240000
         BNO   @RF01163                                            1163 04241000
*                 /***************************************************/ 04242000
*                 /* IF LINE-NUMBER PROMPTING,                       */ 04243000
*                 /* CALL LINE-NUMBER CONVERSION ROUTINE.            */ 04244000
*                 /***************************************************/ 04245000
*                 DO;                                              1164 04246000
*                   PROMPT = '1'B;            /* PROMPT MESSAGE      */ 04247000
         OI    PROMPT(TOMWREG),B'10000000'                         1165 04248000
*                   PSENT = '1'B;             /* PROMPT TO BE SENT   */ 04249000
         OI    PSENT(TOMWREG),B'00001000'                          1166 04250000
*                   IF TSBAULST = '1'B THEN   /* LINE PROMPT?        */ 04251000
         TM    TSBAULST(TSBREG),B'00010000'                        1167 04252000
         BNO   @RF01167                                            1167 04253000
*                     CALL CNVRT;             /* CONVERT LINE NUMBER */ 04254000
         BAL   @14,CNVRT                                           1168 04255000
*                   ELSE                      /* CHARACTER PROMPT    */ 04256000
*                     /***********************************************/ 04257000
*                     /* IF CHARACTER PROMPTING, MOVE UNDERSCORE     */ 04258000
*                     /* CHARACTER FOLLOWED BY BACKSPACE INTO RU     */ 04259000
*                     /* (FOUND IN THE TWO HIGH-ORDER BYTES OF       */ 04260000
*                     /* TSBAUTOS).                                  */ 04261000
*                     /***********************************************/ 04262000
*                     DO;                                          1169 04263000
         B     @RC01167                                            1169 04264000
@RF01167 DS    0H                                                  1170 04265000
*                       RU(BYTECNT:BYTECNT+1)=CHARPRMT;            1170 04266000
         L     @15,BYTECNT(,TOMWREG)                               1170 04267000
         ALR   @15,TOMWREG                                         1170 04268000
         MVC   RU-1(2,@15),CHARPRMT(TSBREG)                        1170 04269000
*                       BYTECNT = BYTECNT+2;                       1171 04270000
         L     @15,BYTECNT(,TOMWREG)                               1171 04271000
         AL    @15,@CF00076                                        1171 04272000
         ST    @15,BYTECNT(,TOMWREG)                               1171 04273000
*                     END;                                         1172 04274000
*                 END;                                             1173 04275000
*               ELSE;                                              1174 04276000
@RF01163 DS    0H                                                  1175 04277000
*             ELSE;                                                1175 04278000
*                                                                  1175 04279000
@RF01162 DS    0H                                                  1176 04280000
*           END PRMPTCHK; /* END OF PRMPTCHK                         */ 04281000
@EL00028 DS    0H                                                  1176 04282000
@EF00028 DS    0H                                                  1176 04283000
@ER00028 L     @14,@SA00028                                        1176 04284000
         BR    @14                                                 1176 04285000
         EJECT                                                          04286000
*CNVRT:     PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1177 04287000
*                                                                  1177 04288000
CNVRT    ST    @14,12(,@13)                                        1177 04289000
*           /*********************************************************/ 04290000
*           /*                                                       */ 04291000
*           /* PROCEDURE - CNVRT                                     */ 04292000
*           /*                                                       */ 04293000
*           /* FUNCTION - TO CONVERT 8-DIGIT LINE NUMBER INTO        */ 04294000
*           /*            EDCDIC, TO SUPPRESS LEADING ZEROS (UP TO   */ 04295000
*           /*            3), AND TO FOLLOW THE LINE NUMBER WITH A   */ 04296000
*           /*            SPACE (BLANK).                             */ 04297000
*           /*                                                       */ 04298000
*           /*********************************************************/ 04299000
*                                                                  1178 04300000
*           CVD(TSBAUTOS,PACKAREA);  /* CONVERT LINE NO. TO DECIMAL  */ 04301000
         L     @15,TSBAUTOS(,TSBREG)                               1178 04302000
         CVD   @15,PACKAREA(,TOMWREG)                              1178 04303000
*           UNPK(UNPKAREA,PACKAREA); /* UNPACK LINE NUMBER           */ 04304000
         UNPK  UNPKAREA(8,TOMWREG),PACKAREA(8,TOMWREG)             1179 04305000
*           NIB1 = '1'B;             /* CHANGE SIGN NIBBLE           */ 04306000
*           NIB2 = '1'B;             /* CHANGE SIGN NIBBLE           */ 04307000
*           NIB3 = '1'B;             /* CHANGE SIGN NIBBLE           */ 04308000
*           NIB4 = '1'B;             /* CHANGE SIGN NIBBLE           */ 04309000
*                                                                  1183 04310000
         OI    NIB1(TOMWREG),B'11110000'                           1183 04311000
*           /*********************************************************/ 04312000
*           /* SINCE LEADING ZEROS (UP TO 3) ARE SUPPRESSED, FIND    */ 04313000
*           /* THE INDEX (POSITION) OF THE LEFT-MOST DIGIT TO BE     */ 04314000
*           /* OUTPUT.                                               */ 04315000
*           /*********************************************************/ 04316000
*           DO I=1 TO 3 WHILE(UNPKAREA(I) = 'F0'X);                1184 04317000
         LA    @15,1                                               1184 04318000
         ST    @15,I(,TOMWREG)                                     1184 04319000
@DL01184 L     @01,I(,TOMWREG)                                     1184 04320000
         ALR   @01,TOMWREG                                         1184 04321000
         CLI   UNPKAREA-1(@01),X'F0'                               1184 04322000
         BNE   @DC01184                                            1184 04323000
*           END;                                                   1185 04324000
*                                                                  1185 04325000
         LA    @15,1                                               1185 04326000
         AL    @15,I(,TOMWREG)                                     1185 04327000
         ST    @15,I(,TOMWREG)                                     1185 04328000
         C     @15,@CF00291                                        1185 04329000
         BNH   @DL01184                                            1185 04330000
@DC01184 DS    0H                                                  1186 04331000
*           /*********************************************************/ 04332000
*           /* MOVE LINE NUMBER INTO RU.                             */ 04333000
*           /*********************************************************/ 04334000
*           RU(BYTECNT:BYTECNT+8-I)                                1186 04335000
*             = UNPKAREA(I:8);       /* PLACE LINE NUMBER INTO RU    */ 04336000
*                                                                  1186 04337000
         L     @15,BYTECNT(,TOMWREG)                               1186 04338000
         ALR   @15,TOMWREG                                         1186 04339000
         L     @14,BYTECNT(,TOMWREG)                               1186 04340000
         LA    @05,8                                               1186 04341000
         ALR   @05,@14                                             1186 04342000
         L     @04,I(,TOMWREG)                                     1186 04343000
         SLR   @05,@04                                             1186 04344000
         SLR   @05,@14                                             1186 04345000
         ALR   @04,TOMWREG                                         1186 04346000
         EX    @05,@SM03020                                        1186 04347000
*           BYTECNT = BYTECNT + 9 - I;                             1187 04348000
*                                                                  1187 04349000
         AL    @14,@CF01008                                        1187 04350000
         L     @15,I(,TOMWREG)                                     1187 04351000
         SLR   @14,@15                                             1187 04352000
         ST    @14,BYTECNT(,TOMWREG)                               1187 04353000
*           /*********************************************************/ 04354000
*           /* ADD A SPACE (BLANK) AFTER THE LINE NUMBER.            */ 04355000
*           /*********************************************************/ 04356000
*           RU(BYTECNT) = BLANK;     /* SPACE                        */ 04357000
*                                                                  1188 04358000
         ALR   @14,TOMWREG                                         1188 04359000
         MVI   RU-1(@14),X'40'                                     1188 04360000
*           BYTECNT = BYTECNT + 1;   /* NEXT BYTE POSITION           */ 04361000
*                                                                  1189 04362000
         L     @15,BYTECNT(,TOMWREG)                               1189 04363000
         AL    @15,@CF00064                                        1189 04364000
         ST    @15,BYTECNT(,TOMWREG)                               1189 04365000
*           END CNVRT;               /* END OF CNVRT                 */ 04366000
@EL00029 DS    0H                                                  1190 04367000
@EF00029 DS    0H                                                  1190 04368000
@ER00029 L     @14,12(,@13)                                        1190 04369000
         BR    @14                                                 1190 04370000
         EJECT                                                          04371000
*SCDROUT:   PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1191 04372000
*                                                                  1191 04373000
SCDROUT  ST    @14,@SA00030                                        1191 04374000
*           /*********************************************************/ 04375000
*           /*                                                       */ 04376000
*           /* PROCEDURE - SCDROUT                                   */ 04377000
*           /*                                                       */ 04378000
*           /* FUNCTION - TO SEND SPACE-BACKSPACE AS ONLY CHAIN WHEN */ 04379000
*           /*            CHANGE-DIRECTION RECEIVED AND NOTHING TO   */ 04380000
*           /*            OUTPUT.                                    */ 04381000
*           /*                                                       */ 04382000
*           /*********************************************************/ 04383000
*                                                                  1192 04384000
*           RU(1:2) = '4016'X;  /* SPACE - BACKSPACE                 */ 04385000
         MVC   RU(2,TOMWREG),@CB02804                              1192 04386000
*           BYTECNT = 3;        /* NEXT BYTE                         */ 04387000
         MVC   BYTECNT(4,TOMWREG),@CF00291                         1193 04388000
*           RPLVTFL2 = RESPPOS; /* POST=RESP AND                     */ 04389000
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1194 04390000
*                               /* RESPOND=(NEX,FME,NRRN)            */ 04391000
*           CHARCNT = 0;        /* RESET PRINTABLE-CHARACTER COUNT   */ 04392000
         SLR   @15,@15                                             1195 04393000
         ST    @15,CHARCNT(,TOMWREG)                               1195 04394000
*           TVWASCD = '0'B;     /* RESET CHANGE-DIRECTION SWITCH     */ 04395000
         NI    TVWASCD(TVWAREG),B'11011111'                        1196 04396000
*           AGAIN = '1'B;       /* GO THROUGH BLDCHAIN AGAIN         */ 04397000
*           MSG = '1'B;         /* POSSIBLE ANOTHER MESSAGE ON QUEUE */ 04398000
         OI    AGAIN(TOMWREG),B'00000101'                          1198 04399000
*           CALL SENDRU;        /* SEND RU AS ONLY CHAIN             */ 04400000
*                                                                  1199 04401000
         BAL   @14,SENDRU                                          1199 04402000
*           END SCDROUT;        /* END OF SCDROUT                    */ 04403000
@EL00030 DS    0H                                                  1200 04404000
@EF00030 DS    0H                                                  1200 04405000
@ER00030 L     @14,@SA00030                                        1200 04406000
         BR    @14                                                 1200 04407000
         EJECT                                                          04408000
*BKMGROUT:  PROCEDURE OPTIONS(SAVE(BRNCHREG));                     1201 04409000
*                                                                  1201 04410000
BKMGROUT ST    @14,@SA00031                                        1201 04411000
*    /****************************************************************/ 04412000
*    /*                                                              */ 04413000
*    /*        PROCEDURE - BKMGROUT                                  */ 04414000
*    /*                                                              */ 04415000
*    /*        FUNCTION - TO TRANSMIT A PARTIAL MESSAGE (THAT WAS    */ 04416000
*    /*                   BEING KEYED-IN AT THE TERMINAL WHEN A      */ 04417000
*    /*                   BREAK-IN OCCURRED) BACK TO THE TERMINAL.   */ 04418000
*    /*                                                              */ 04419000
*    /****************************************************************/ 04420000
*                                                                  1202 04421000
*           IF SWNL = '1'B THEN /* NEW LINE?                         */ 04422000
         TM    SWNL(TOMWREG),B'01000000'                           1202 04423000
         BNO   @RF01202                                            1202 04424000
*             DO;               /* DO NEW-LINE PROCESSING            */ 04425000
*               SWNL = '0'B;    /* RESET NEW-LINE SWITCH             */ 04426000
         NI    SWNL(TOMWREG),B'10111111'                           1204 04427000
*               RU(BYTECNT) = NL;                                  1205 04428000
         L     @15,BYTECNT(,TOMWREG)                               1205 04429000
         ALR   @15,TOMWREG                                         1205 04430000
         MVC   RU-1(1,@15),NL                                      1205 04431000
*               BYTECNT = BYTECNT + 1;                             1206 04432000
         L     @15,BYTECNT(,TOMWREG)                               1206 04433000
         AL    @15,@CF00064                                        1206 04434000
         ST    @15,BYTECNT(,TOMWREG)                               1206 04435000
*             END;              /* END OF NEW-LINE PROCESSING        */ 04436000
*           ELSE;               /* SAME LINE                         */ 04437000
*                                                                  1208 04438000
@RF01202 DS    0H                                                  1209 04439000
*           /*********************************************************/ 04440000
*           /* ISSUE MESSAGE 'REENTER DATA BEGINNING WITH' SINCE, AS */ 04441000
*           /* A RESULT OF A BREAK_IN CONDITION, THE PARTIAL LINE    */ 04442000
*           /* MUST BE REENTERED TO BE VALID INPUT.                  */ 04443000
*           /*********************************************************/ 04444000
*           I = REENTDTA;       /* REENTER-DATA MESSAGE              */ 04445000
         LA    @15,6                                               1209 04446000
         ST    @15,I(,TOMWREG)                                     1209 04447000
*           RU(BYTECNT:BYTECNT+MSGSIZE-1) = MSGDATA(1:MSGSIZE);    1210 04448000
         L     @14,BYTECNT(,TOMWREG)                               1210 04449000
         ALR   @14,TOMWREG                                         1210 04450000
         SLA   @15,2                                               1210 04451000
         L     @01,CVTPTR                                          1210 04452000
         L     @01,CVTTCASP(,@01)                                  1210 04453000
         L     @01,TCASMSGS(,@01)                                  1210 04454000
         AL    @01,@CF02987                                        1210 04455000
         L     @15,MSGADR(@15,@01)                                 1210 04456000
         LH    @05,MSGSIZE(,@15)                                   1210 04457000
         LR    @04,@05                                             1210 04458000
         BCTR  @04,0                                               1210 04459000
         EX    @04,@SM03022                                        1210 04460000
*           BYTECNT = BYTECNT + MSGSIZE;                           1211 04461000
         L     @04,BYTECNT(,TOMWREG)                               1211 04462000
         ALR   @04,@05                                             1211 04463000
         ST    @04,BYTECNT(,TOMWREG)                               1211 04464000
*           RU(BYTECNT) = NL;   /* NEXT LINE                         */ 04465000
         ALR   @04,TOMWREG                                         1212 04466000
         MVC   RU-1(1,@04),NL                                      1212 04467000
*           BYTECNT = BYTECNT + 1;                                 1213 04468000
*                                                                  1213 04469000
         LA    @15,1                                               1213 04470000
         L     @14,BYTECNT(,TOMWREG)                               1213 04471000
         ALR   @14,@15                                             1213 04472000
         ST    @14,BYTECNT(,TOMWREG)                               1213 04473000
*           /*********************************************************/ 04474000
*           /* MOVE PARTIAL MESSAGE INTO THE RU.                     */ 04475000
*           /*********************************************************/ 04476000
*           RU(BYTECNT:BYTECNT+TVWATQL1-1) = MESSAGE(1:TVWATQL1);  1214 04477000
*                                                                  1214 04478000
         ALR   @14,TOMWREG                                         1214 04479000
         SLR   @05,@05                                             1214 04480000
         IC    @05,TVWATQL1(,TVWAREG)                              1214 04481000
         LR    @04,@05                                             1214 04482000
         BCTR  @04,0                                               1214 04483000
         L     @01,TVWATOPQ(,TVWAREG)                              1214 04484000
         EX    @04,@SM03024                                        1214 04485000
*           /*********************************************************/ 04486000
*           /* INCREMENT BYTE-COUNT BY THE LENGTH OF THE PARTIAL     */ 04487000
*           /* MESSAGE.                                              */ 04488000
*           /*********************************************************/ 04489000
*           BYTECNT = BYTECNT + TVWATQL1;                          1215 04490000
*                                                                  1215 04491000
         L     @14,BYTECNT(,TOMWREG)                               1215 04492000
         ALR   @14,@05                                             1215 04493000
         ST    @14,BYTECNT(,TOMWREG)                               1215 04494000
*           RU(BYTECNT) = NL;   /* NEXT LINE                         */ 04495000
         ALR   @14,TOMWREG                                         1216 04496000
         MVC   RU-1(1,@14),NL                                      1216 04497000
*           BYTECNT=BYTECNT+1;  /* INCREMENT RU POSITION             */ 04498000
         L     @14,BYTECNT(,TOMWREG)                               1217 04499000
         ALR   @14,@15                                             1217 04500000
         ST    @14,BYTECNT(,TOMWREG)                               1217 04501000
*           TVWABKMG = '0'B;    /* RESET BREAK-MESSAGE SWITCH        */ 04502000
         NI    TVWABKMG(TVWAREG),B'11111011'                       1218 04503000
*           AGAIN = '1'B;       /* DO CHAINING PROCESS AGAIN         */ 04504000
*           MSG = '1'B;         /* POSSIBLY MESSAGE ON QUEUE         */ 04505000
         OI    AGAIN(TOMWREG),B'00000101'                          1220 04506000
*           CHARCNT = 0;        /* RESET PRINTABLE-CHARACTER COUNT   */ 04507000
         SLR   @15,@15                                             1221 04508000
         ST    @15,CHARCNT(,TOMWREG)                               1221 04509000
*           RPLVTFL2 = RESPPOS; /* POST=RESP AND                     */ 04510000
         MVI   RPLVTFL2+16(RPLREG),X'00'                           1222 04511000
*                               /* RESPOND=(NEX,FME,NRRN)            */ 04512000
*           CALL SENDRU;        /* SEND RU                           */ 04513000
*                                                                  1223 04514000
         BAL   @14,SENDRU                                          1223 04515000
*           END BKMGROUT;       /* END OF BKMGROUT                   */ 04516000
@EL00031 DS    0H                                                  1224 04517000
@EF00031 DS    0H                                                  1224 04518000
@ER00031 L     @14,@SA00031                                        1224 04519000
         BR    @14                                                 1224 04520000
         EJECT                                                          04521000
*INITFRR: PROCEDURE OPTIONS(PARMREG);                              1225 04522000
*                                                                  1225 04523000
INITFRR  STM   @14,@12,12(@13)                                     1225 04524000
*RFY IKTFRPRM BASED(FRRPARM);       /* BASE FRR PARAMETERS   @ZM20856*/ 04525000
*IKTFRPRM=IKTFRPRM && IKTFRPRM;     /* ZERO CONTROL BLOCK STORAGE  1227 04526000
*                                                            @ZM20856*/ 04527000
         L     @15,FRRPARM                                         1227 04528000
         XC    IKTFRPRM(24,@15),IKTFRPRM(@15)                      1227 04529000
*FRPRPLAD=ADDR(IFGRPL);             /* INITIALIZE RPL ADDRESS      1228 04530000
*                                                            @ZM21178*/ 04531000
         ST    RPLREG,FRPRPLAD(,@15)                               1228 04532000
*FRPRETRY=ADDR(FRWARTRY);           /* INITIALIZE FRR PARM WITH    1229 04533000
*                                      OF RETRY INFORMATION  @ZM20856*/ 04534000
         L     @14,TVWAFRWO(,TVWAREG)                              1229 04535000
         LA    @05,FRWARTRY(,@14)                                  1229 04536000
         ST    @05,FRPRETRY(,@15)                                  1229 04537000
*RFY INFODSCT BASED(ADDR(FRWARTRY));/* BASE INFORMATION DSECT      1230 04538000
*                                      ON RETRY AREA         @ZM20856*/ 04539000
*INFOREGS=ADDR(RETRYREG);           /* INITIALIZE ADDRESS OF RETRY 1231 04540000
*                                      REGISTER SAVE AREA ADDRESS  1231 04541000
*                                                            @ZM20856*/ 04542000
         LA    @05,8                                               1231 04543000
         ALR   @05,@14                                             1231 04544000
         LA    @04,RETRYREG                                        1231 04545000
         ST    @04,INFOREGS(,@05)                                  1231 04546000
*INFOADDR=ADDR(FRRENTRY);           /* INITIALIZE RETRY ADDR @ZM20856*/ 04547000
         LA    @04,FRRENTRY                                        1232 04548000
         ST    @04,INFOADDR(,@05)                                  1232 04549000
*RFY INFODSCT BASED(ADDR(FRWACKPT));/* BASE INFORMATION DSECT      1233 04550000
*                                      ON CHECK POINT AREA   @ZM20856*/ 04551000
*FRPCKINF=ADDR(FRWACKPT);           /* INITIALIZE POINTER TO ADDRESS    04552000
*                                      OF CHECK POINT AREA   @ZM20856*/ 04553000
         ST    @14,FRPCKINF(,@15)                                  1234 04554000
*INFOREGS=ADDR(FRWACKRG);           /* INITIALIZE POINTER TO CHECK 1235 04555000
*                                      POINT REGISTER SAVE AREA    1235 04556000
*                                                            @ZM20856*/ 04557000
         LA    @05,FRWACKRG(,@14)                                  1235 04558000
         ST    @05,INFOREGS(,@14)                                  1235 04559000
*FRPXITPT=ADDR(FRWAEXIT);           /* INITIALIZE POINTER TO EXIT  1236 04560000
*                                      INFORMATION AREA      @ZM20856*/ 04561000
         LA    @05,FRWAEXIT(,@14)                                  1236 04562000
         ST    @05,FRPXITPT(,@15)                                  1236 04563000
*RFY INFODSCT BASED(ADDR(FRWAEXIT));/* BASE INFORMATION DSECT ON EXIT   04564000
*                                      INFORMATION AREA      @ZM20856*/ 04565000
*INFOREGS=ADDR(FRWAEXRG);           /* INITIALIZE POINTER TO EXIT  1238 04566000
*                                      REGISTER SAVE AREA ADDRESS  1238 04567000
*                                                            @ZM20856*/ 04568000
         LA    @05,16                                              1238 04569000
         ALR   @05,@14                                             1238 04570000
         LA    @04,FRWAEXRG(,@14)                                  1238 04571000
         ST    @04,INFOREGS(,@05)                                  1238 04572000
*INFOADDR=ADDR(IKTEXIT);            /* INITIALIZE POINTER TO ADDRESS    04573000
*                                      OF EXIT ROUTINE       @ZM21235*/ 04574000
         L     @01,CVTPTR                                          1239 04575000
         L     @01,CVTTCASP(,@01)                                  1239 04576000
         L     @04,TCASEXIT(,@01)                                  1239 04577000
         ST    @04,INFOADDR(,@05)                                  1239 04578000
*PLXEXITA=SAVE14;                   /* SET SRB EXIT ADDRESS  @ZM21235*/ 04579000
         L     @05,SAVE14(,TOMWREG)                                1240 04580000
         ST    @05,PLXEXITA                                        1240 04581000
*PLXTOMLN=VALTOMLN;                 /* SET TOM LENGTH        @ZM21235*/ 04582000
         MVC   PLXTOMLN(4),@CF02765                                1241 04583000
*PLXTOTLN=VALTOTLN;                 /* SET TOTAL AREA LENGTH @ZM21235*/ 04584000
         SLR   @05,@05                                             1242 04585000
         ST    @05,PLXTOTLN                                        1242 04586000
*RFY                                                               1243 04587000
*  REG1 RSTD;                       /* PARAMETER POINTER     @ZM21235*/ 04588000
*REG1=ADDR(PLXPARMS);               /* ADDRESS PARAMETER LIST      1244 04589000
*                                                            @ZM21235*/ 04590000
         LA    REG1,PLXPARMS                                       1244 04591000
*STM(REG0,REG15,FRWAEXRG);          /* SAVE REGISTERS FOR USE BY   1245 04592000
*                                      EXIT ROUTINE          @ZM20856*/ 04593000
         STM   REG0,REG15,FRWAEXRG(@14)                            1245 04594000
*RFY                                                               1246 04595000
*  REG1 UNRSTD;                     /* PARAMETER POINTER     @ZM21235*/ 04596000
*FRPOMNGR='1'B;                     /* INDICATE OUTPUT MANAGER     1247 04597000
*                                                            @ZM20856*/ 04598000
         OI    FRPOMNGR(@15),B'10000000'                           1247 04599000
*FRPCONST=ADDR(CONSAREA);           /* INITIALIZE THE FRR PARAMETER TO  04600000
*                                      THE ADDRESS OF THE CONSTANT 1248 04601000
*                                      AREA                  @ZM20856*/ 04602000
         LA    @14,CONSAREA                                        1248 04603000
         ST    @14,FRPCONST(,@15)                                  1248 04604000
*END INITFRR;                       /* END OF INITFRR        @ZM20856*/ 04605000
@EL00032 DS    0H                                                  1249 04606000
@EF00032 DS    0H                                                  1249 04607000
@ER00032 LM    @14,@12,12(@13)                                     1249 04608000
         BR    @14                                                 1249 04609000
         EJECT                                                          04610000
*EXITFRR:  PROCEDURE OPTIONS(NOSAVEAREA);                          1250 04611000
*                                                                  1250 04612000
EXITFRR  STM   @14,@12,12(@13)                                     1250 04613000
*RFY IKTLTCB BASED(ADDR(RPLUSFLD)); /* BASE LOSTERM FLAGS ON       1251 04614000
*                                      RPL USER FIELD        @ZM20856*/ 04615000
*IKTLTCB=0;                         /* ZERO USER FIELD       @ZM20856*/ 04616000
         LA    @15,92                                              1252 04617000
         ALR   @15,RPLREG                                          1252 04618000
         SLR   @14,@14                                             1252 04619000
         STCM  @14,15,IKTLTCB(@15)                                 1252 04620000
*LTCBIOER='1'B;                     /* TURN ON I/O ERROR BIT @ZM20856*/ 04621000
         OI    LTCBIOER(@15),B'10000000'                           1253 04622000
*RFY                                                               1254 04623000
*  REG15 RSTD;                      /* RESTRICT REGISTER 15  @ZM21142*/ 04624000
*REG15=REASONCD;                    /* REASON CODE           @ZM21142*/ 04625000
         L     REG15,REASONCD                                      1255 04626000
*GEN EXIT                                                          1256 04627000
*    (ABEND X'0AB',,,SYSTEM);       /* ISSUE ABEND           @ZM20856*/ 04628000
*                                                                  1256 04629000
         ABEND X'0AB',,,SYSTEM                                          04630000
*END EXITFRR;                       /* END OF EXITFRR        @ZM20856*/ 04631000
@EL00033 DS    0H                                                  1257 04632000
@EF00033 DS    0H                                                  1257 04633000
@ER00033 LM    @14,@12,12(@13)                                     1257 04634000
         BR    @14                                                 1257 04635000
@PB00033 DS    0H                                                  1257 04636000
         EJECT                                                          04637000
*END IKTTOMRT                       /* END OF IKTTOMRT               */ 04638000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04639000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 04640000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        * 04641000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                        * 04642000
*/*%INCLUDE SYSLIB  (ISTRPLFB)                                        * 04643000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        * 04644000
*/*%INCLUDE SYSLIB  (IHAASCB )                                        * 04645000
*/*%INCLUDE SYSLIB  (IHAASXB )                                        * 04646000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                        * 04647000
*/*%INCLUDE SYSLIB  (IHASCVT )                                        * 04648000
*/*%INCLUDE SYSLIB  (IHASRB  )                                        * 04649000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                        * 04650000
*/*%INCLUDE SYSLIB  (IKJTSB  )                                        * 04651000
*/*%INCLUDE SYSLIB  (IKTTSBX )                                        * 04652000
*/*%INCLUDE SYSLIB  (IKTEQU  )                                        * 04653000
*/*%INCLUDE SYSLIB  (IKTFRPRM)                                        * 04654000
*/*%INCLUDE SYSLIB  (IKTFRRWA)                                        * 04655000
*/*%INCLUDE SYSLIB  (IKTLTCB )                                        * 04656000
*/*%INCLUDE SYSLIB  (IKTTCAST)                                        * 04657000
*/*%INCLUDE SYSLIB  (IKTTVWA )                                        * 04658000
*/*%INCLUDE SYSLIB  (ISTPAB  )                                        * 04659000
*/*%INCLUDE SYSLIB  (ISTDYPAB)                                        * 04660000
*/*%INCLUDE SYSLIB  (ISTMPST )                                        * 04661000
*/*%INCLUDE SYSLIB  (IKTOPARM)                                        * 04662000
*;                                                                 1258 04663000
@DATA    DS    0H                                                       04664000
@SM02988 MVC   RU-1(0,@14),MSGDATA(@05)                                 04665000
@SM02999 MVC   RU-1(0,@15),WKSP(TOMWREG)                                04666000
@SM03001 MVC   WKSP(0,TOMWREG),BUFFER(@01)                              04667000
@SB03003 TRT   WKSP-1(0,@03),FMTTAB                                     04668000
@SB03005 TR    WKSP-1(0,@15),EDITAB                                     04669000
@SB03007 TR    WKSP-1(0,@03),ASISTAB                                    04670000
@SB03009 TR    WKSP-1(0,@03),EDITAB                                     04671000
@SB03011 TRT   RU-1(0,@03),CNTRLTAB                                     04672000
@SB03013 TR    RU-1(0,@03),USRTRANS(@14)                                04673000
@SB03015 TR    RU-1(0,@03),ASCIITAB(@14)                                04674000
@SM03017 MVC   RU-1(0,@04),WKSP-1(@15)                                  04675000
@SM03020 MVC   RU-1(0,@15),UNPKAREA-1(@04)                              04676000
@SM03022 MVC   RU-1(0,@14),MSGDATA(@15)                                 04677000
@SM03024 MVC   RU-1(0,@14),MESSAGE(@01)                                 04678000
@DATD    DSECT                                                          04679000
         DS    0F                                                       04680000
@SA00001 DS    18F                                                      04681000
@SA00002 DS    1F                                                       04682000
@SA00008 DS    1F                                                       04683000
@SA00004 DS    1F                                                       04684000
@SA00005 DS    1F                                                       04685000
@SA00007 DS    1F                                                       04686000
@SA00010 DS    1F                                                       04687000
@SA00028 DS    1F                                                       04688000
@SA00006 DS    1F                                                       04689000
@SA00016 DS    1F                                                       04690000
@SA00015 DS    1F                                                       04691000
@SA00027 DS    1F                                                       04692000
@SA00031 DS    1F                                                       04693000
@SA00030 DS    1F                                                       04694000
@SA00017 DS    1F                                                       04695000
@SA00020 DS    1F                                                       04696000
@SA00018 DS    1F                                                       04697000
@SA00019 DS    1F                                                       04698000
@SA00021 DS    1F                                                       04699000
@SA00022 DS    1F                                                       04700000
@SA00023 DS    1F                                                       04701000
@SA00024 DS    1F                                                       04702000
@SA00025 DS    1F                                                       04703000
@SA00026 DS    1F                                                       04704000
@AL00001 DS    1A                                                       04705000
IKTTOMRT CSECT                                                          04706000
         DS    0F                                                       04707000
@CF00064 DC    F'1'                                                     04708000
@CF00076 DC    F'2'                                                     04709000
@CF00291 DC    F'3'                                                     04710000
@CF00056 DC    F'4'                                                     04711000
@CF01008 DC    F'9'                                                     04712000
@CF00073 DC    F'24'                                                    04713000
@CF00742 DC    F'32'                                                    04714000
@CF02846 DC    F'136'                                                   04715000
@CF00684 DC    F'256'                                                   04716000
@CF02797 DC    F'257'                                                   04717000
@CF02765 DC    F'5192'                                                  04718000
@CF02987 DC    F'-4'                                                    04719000
@CF02008 DC    XL4'80000000'                                            04720000
@CF02998 DC    XL4'0000FFFF'                                            04721000
@DATD    DSECT                                                          04722000
         DS    0D                                                       04723000
FRRPARM  DS    A                                                        04724000
@NM00282 DS    CL12                                                     04725000
         ORG   @NM00282                                                 04726000
RPLSAVE  DS    AL4                                                      04727000
TSBSAVE  DS    AL4                                                      04728000
TVWASAVE DS    AL4                                                      04729000
         ORG   @NM00282+12                                              04730000
RETRYREG DS    CL64                                                     04731000
PLXPARMS DS    CL12                                                     04732000
         ORG   PLXPARMS                                                 04733000
PLXEXITA DS    AL4                                                      04734000
PLXTOMLN DS    FL4                                                      04735000
PLXTOTLN DS    FL4                                                      04736000
         ORG   PLXPARMS+12                                              04737000
IKTTOMRT CSECT                                                          04738000
         NOPR  ((@ENDDATD-@DATD)/321*16)                                04739000
         DS    0F                                                       04740000
@SIZDATD DC    AL1(0)                                                   04741000
         DC    AL3(@ENDDATD-@DATD)                                      04742000
@CV02710 DC    V(IKTRTX1)                                               04743000
         DS    0D                                                       04744000
@CB02827 DC    X'5AC915'                                                04745000
@CB02804 DC    X'4016'                                                  04746000
@CB02826 DC    X'5A15'                                                  04747000
@CB02886 DC    X'081B'                                                  04748000
@CB02888 DC    X'0811'                                                  04749000
@CB02890 DC    X'0802'                                                  04750000
@CB02892 DC    X'0813'                                                  04751000
@CB02893 DC    X'080B'                                                  04752000
@CB02894 DC    X'2003'                                                  04753000
@CB02896 DC    X'2002'                                                  04754000
@CB02897 DC    X'1003'                                                  04755000
@CB02898 DC    X'1005'                                                  04756000
ASISTAB  DS    CL256                                                    04757000
         ORG   ASISTAB                                                  04758000
@NM00153 DC    X'7A7A7A7A7A'                                            04759000
HTAB     DC    X'05'                                                    04760000
@NM00154 DC    X'7A7A7A7A7A'                                            04761000
VTAB     DC    X'0B'                                                    04762000
FF       DC    X'0C'                                                    04763000
CR       DC    X'0D'                                                    04764000
@NM00155 DC    X'7A7A7A7A7A7A'                                          04765000
RES      DC    X'14'                                                    04766000
NL       DC    X'15'                                                    04767000
BKSPACE  DC    X'16'                                                    04768000
@NM00156 DC    X'7A7A7A7A7A7A7A'                                        04769000
IRS      DC    X'1E'                                                    04770000
@NM00157 DC    X'7A7A7A7A7A'                                            04771000
BYP      DC    X'24'                                                    04772000
LF       DC    X'25'                                                    04773000
@NM00158 DC    X'7A7A7A7A7A'                                            04774000
FMT      DC    X'2B'                                                    04775000
@NM00159 DC    X'7A7A7A7A'                                              04776000
@NM00160 DC    X'7A7A7A7A7A7A7A7A'                                      04777000
@NM00161 DC    X'7A7A7A7A7A7A7A7A'                                      04778000
@NM00162 DC    X'4041424344454647'                                      04779000
@NM00163 DC    X'48494A4B4C4D4E4F'                                      04780000
@NM00164 DC    X'5051525354555657'                                      04781000
@NM00165 DC    X'58595A5B5C5D5E5F'                                      04782000
@NM00166 DC    X'6061626364656667'                                      04783000
@NM00167 DC    X'68696A6B6C6D6E6F'                                      04784000
@NM00168 DC    X'70717273747576777879'                                  04785000
COLON    DC    X'7A'                                                    04786000
@NM00169 DC    X'7B7C7D7E7F'                                            04787000
@NM00170 DC    X'8081828384858687'                                      04788000
@NM00171 DC    X'88898A8B8C8D8E8F'                                      04789000
@NM00172 DC    X'9091929394959697'                                      04790000
@NM00173 DC    X'98999A9B9C9D9E9F'                                      04791000
@NM00174 DC    X'A0A1A2A3A4A5A6A7'                                      04792000
@NM00175 DC    X'A8A9AAABACADAEAF'                                      04793000
@NM00176 DC    X'B0B1B2B3B4B5B6B7'                                      04794000
@NM00177 DC    X'B8B9BABBBCBDBEBF'                                      04795000
@NM00178 DC    X'C0C1C2C3C4C5C6C7'                                      04796000
@NM00179 DC    X'C8C9CACBCCCDCECF'                                      04797000
@NM00180 DC    X'D0D1D2D3D4D5D6D7'                                      04798000
@NM00181 DC    X'D8D9DADBDCDDDEDF'                                      04799000
@NM00182 DC    X'E0E1E2E3E4E5E6E7'                                      04800000
@NM00183 DC    X'E8E9EAEBECEDEEEF'                                      04801000
@NM00184 DC    X'F0F1F2F3F4F5F6F7'                                      04802000
@NM00185 DC    X'F8F9FAFBFCFDFEFF'                                      04803000
         ORG   ASISTAB+256                                              04804000
EDITAB   DS    CL256                                                    04805000
         ORG   EDITAB                                                   04806000
@NM00186 DC    X'7A7A7A7A7A7A7A7A'                                      04807000
@NM00187 DC    X'7A7A7A7A7A7A7A7A'                                      04808000
@NM00188 DC    X'7A7A7A7A7A7A167A'                                      04809000
@NM00189 DC    X'7A7A7A7A7A7A7A7A'                                      04810000
@NM00190 DC    X'7A7A7A7A7A7A7A7A'                                      04811000
@NM00191 DC    X'7A7A7A7A7A7A7A7A'                                      04812000
@NM00192 DC    X'7A7A7A7A7A7A7A7A'                                      04813000
@NM00193 DC    X'7A7A7A7A7A7A7A7A'                                      04814000
@NM00194 DC    X'4041424344454647'                                      04815000
@NM00195 DC    X'48494A4B4C4D4E4F'                                      04816000
@NM00196 DC    X'5051525354555657'                                      04817000
@NM00197 DC    X'58595A5B5C5D5E5F'                                      04818000
@NM00198 DC    X'6061626364656667'                                      04819000
@NM00199 DC    X'68696A6B6C6D6E6F'                                      04820000
@NM00200 DC    X'7071727374757677'                                      04821000
@NM00201 DC    X'78797A7B7C7D7E7F'                                      04822000
@NM00202 DC    X'8081828384858687'                                      04823000
@NM00203 DC    X'88898A8B8C8D8E8F'                                      04824000
@NM00204 DC    X'9091929394959697'                                      04825000
@NM00205 DC    X'98999A9B9C9D9E9F'                                      04826000
@NM00206 DC    X'A0A1A2A3A4A5A6A7'                                      04827000
@NM00207 DC    X'A8A9AAABACADAEAF'                                      04828000
@NM00208 DC    X'B0B1B2B3B4B5B6B7'                                      04829000
@NM00209 DC    X'B8B9BABBBCBDBEBF'                                      04830000
@NM00210 DC    X'C0C1C2C3C4C5C6C7'                                      04831000
@NM00211 DC    X'C8C9CACBCCCDCECF'                                      04832000
@NM00212 DC    X'D0D1D2D3D4D5D6D7'                                      04833000
@NM00213 DC    X'D8D9DADBDCDDDEDF'                                      04834000
@NM00214 DC    X'E0E1E2E3E4E5E6E7'                                      04835000
@NM00215 DC    X'E8E9EAEBECEDEEEF'                                      04836000
@NM00216 DC    X'F0F1F2F3F4F5F6F7'                                      04837000
@NM00217 DC    X'F8F9FAFBFCFDFEFF'                                      04838000
         ORG   EDITAB+256                                               04839000
FMTTAB   DS    CL256                                                    04840000
         ORG   FMTTAB                                                   04841000
@NM00218 DC    X'0000000000000000'                                      04842000
@NM00219 DC    X'0000000000000000'                                      04843000
@NM00220 DC    X'0000000000000000'                                      04844000
@NM00221 DC    X'0000000000000000'                                      04845000
@NM00222 DC    X'0000000000000000'                                      04846000
@NM00223 DC    X'0000002B00000000'                                      04847000
@NM00224 DC    X'0000000000000000'                                      04848000
@NM00225 DC    X'0000000000000000'                                      04849000
@NM00226 DC    X'0000000000000000'                                      04850000
@NM00227 DC    X'0000000000000000'                                      04851000
@NM00228 DC    X'0000000000000000'                                      04852000
@NM00229 DC    X'0000000000000000'                                      04853000
@NM00230 DC    X'0000000000000000'                                      04854000
@NM00231 DC    X'0000000000000000'                                      04855000
@NM00232 DC    X'0000000000000000'                                      04856000
@NM00233 DC    X'0000000000000000'                                      04857000
@NM00234 DC    X'0000000000000000'                                      04858000
@NM00235 DC    X'0000000000000000'                                      04859000
@NM00236 DC    X'0000000000000000'                                      04860000
@NM00237 DC    X'0000000000000000'                                      04861000
@NM00238 DC    X'0000000000000000'                                      04862000
@NM00239 DC    X'0000000000000000'                                      04863000
@NM00240 DC    X'0000000000000000'                                      04864000
@NM00241 DC    X'0000000000000000'                                      04865000
@NM00242 DC    X'0000000000000000'                                      04866000
@NM00243 DC    X'0000000000000000'                                      04867000
@NM00244 DC    X'0000000000000000'                                      04868000
@NM00245 DC    X'0000000000000000'                                      04869000
@NM00246 DC    X'0000000000000000'                                      04870000
@NM00247 DC    X'0000000000000000'                                      04871000
@NM00248 DC    X'0000000000000000'                                      04872000
@NM00249 DC    X'0000000000000000'                                      04873000
         ORG   FMTTAB+256                                               04874000
CNTRLTAB DS    CL256                                                    04875000
         ORG   CNTRLTAB                                                 04876000
@NM00250 DC    X'0000000000050000'                                      04877000
@NM00251 DC    X'0000000B0C0D0000'                                      04878000
@NM00252 DC    X'0000000014151600'                                      04879000
@NM00253 DC    X'0000000000001E00'                                      04880000
@NM00254 DC    X'0000000024250000'                                      04881000
@NM00255 DC    X'0000002B00000000'                                      04882000
@NM00256 DC    X'0000000000000000'                                      04883000
@NM00257 DC    X'0000000000000000'                                      04884000
@NM00258 DC    X'0000000000000000'                                      04885000
@NM00259 DC    X'0000000000000000'                                      04886000
@NM00260 DC    X'0000000000000000'                                      04887000
@NM00261 DC    X'0000000000000000'                                      04888000
@NM00262 DC    X'0000000000000000'                                      04889000
@NM00263 DC    X'0000000000000000'                                      04890000
@NM00264 DC    X'0000000000000000'                                      04891000
@NM00265 DC    X'0000000000000000'                                      04892000
@NM00266 DC    X'0000000000000000'                                      04893000
@NM00267 DC    X'0000000000000000'                                      04894000
@NM00268 DC    X'0000000000000000'                                      04895000
@NM00269 DC    X'0000000000000000'                                      04896000
@NM00270 DC    X'0000000000000000'                                      04897000
@NM00271 DC    X'0000000000000000'                                      04898000
@NM00272 DC    X'0000000000000000'                                      04899000
@NM00273 DC    X'0000000000000000'                                      04900000
@NM00274 DC    X'0000000000000000'                                      04901000
@NM00275 DC    X'0000000000000000'                                      04902000
@NM00276 DC    X'0000000000000000'                                      04903000
@NM00277 DC    X'0000000000000000'                                      04904000
@NM00278 DC    X'0000000000000000'                                      04905000
@NM00279 DC    X'0000000000000000'                                      04906000
@NM00280 DC    X'0000000000000000'                                      04907000
@NM00281 DC    X'0000000000000000'                                      04908000
         ORG   CNTRLTAB+256                                             04909000
         DS    CL3                                                      04910000
CONSAREA DS    CL28                                                     04911000
         ORG   CONSAREA                                                 04912000
CSECTNME DC    CL8'IKTTOMRT'                                            04913000
FRRNAME  DC    CL8'IKTIOFRR'                                            04914000
LOADNAME DC    CL8'IKTIOM01'                                            04915000
REASONCD DC    XL4'102'                                                 04916000
         ORG   CONSAREA+28                                              04917000
PATCH    DC    130F'0'                                                  04918000
IKTTOMRT CSECT                                                          04919000
DUMMYRPL RPL   AM=VTAM,                                               CC04920000
               STYPE=REQ,                                             CC04921000
               OPTCD=(CS,SYN,SPEC,Q),                                 CC04922000
               BRANCH=YES                                               04923000
@DATD    DSECT                                                          04924000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04925000
@ENDDATD EQU   *                                                        04926000
IKTTOMRT CSECT                                                          04927000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04928000
@01      EQU   01                                                       04929000
@02      EQU   02                                                       04930000
@03      EQU   03                                                       04931000
@04      EQU   04                                                       04932000
@05      EQU   05                                                       04933000
@06      EQU   06                                                       04934000
@07      EQU   07                                                       04935000
@08      EQU   08                                                       04936000
@09      EQU   09                                                       04937000
@10      EQU   10                                                       04938000
@11      EQU   11                                                       04939000
@12      EQU   12                                                       04940000
@13      EQU   13                                                       04941000
@14      EQU   14                                                       04942000
@15      EQU   15                                                       04943000
BASEREGA EQU   @08                                                      04944000
BASEREGB EQU   @09                                                      04945000
BASEREGC EQU   @10                                                      04946000
TOMWREG  EQU   @13                                                      04947000
RTOMW    EQU   @01                                                      04948000
WRK2     EQU   @02                                                      04949000
WRK3     EQU   @03                                                      04950000
REGPARM  EQU   @05                                                      04951000
FRRPTR   EQU   @06                                                      04952000
RPLREG   EQU   @07                                                      04953000
TVWAREG  EQU   @11                                                      04954000
TSBREG   EQU   @12                                                      04955000
BRNCHREG EQU   @14                                                      04956000
GENRC    EQU   @15                                                      04957000
RTNCDE   EQU   @15                                                      04958000
REG0     EQU   @00                                                      04959000
REG1     EQU   @01                                                      04960000
REG2     EQU   @02                                                      04961000
REG13    EQU   @13                                                      04962000
REG14    EQU   @14                                                      04963000
REG15    EQU   @15                                                      04964000
ASCBREG  EQU   @07                                                      04965000
REG10    EQU   @10                                                      04966000
REG11    EQU   @11                                                      04967000
REG3     EQU   @03                                                      04968000
REG5     EQU   @05                                                      04969000
REG6     EQU   @06                                                      04970000
TCBREG   EQU   @04                                                      04971000
PSA      EQU   0                                                        04972000
FLCRNPSW EQU   PSA                                                      04973000
FLCROPSW EQU   PSA+8                                                    04974000
FLCICCW2 EQU   PSA+16                                                   04975000
FLCCVT   EQU   FLCICCW2                                                 04976000
PSAEEPSW EQU   PSA+132                                                  04977000
PSAESPSW EQU   PSA+136                                                  04978000
FLCSVILC EQU   PSAESPSW+1                                               04979000
PSAEPPSW EQU   PSA+140                                                  04980000
FLCPIILC EQU   PSAEPPSW+1                                               04981000
FLCPICOD EQU   PSAEPPSW+2                                               04982000
PSAPICOD EQU   FLCPICOD+1                                               04983000
FLCTEA   EQU   PSAEPPSW+4                                               04984000
FLCPER   EQU   PSA+152                                                  04985000
FLCMCLA  EQU   PSA+168                                                  04986000
FLCIOEL  EQU   FLCMCLA+4                                                04987000
FLCIOA   EQU   FLCMCLA+16                                               04988000
FLCFSA   EQU   FLCMCLA+80                                               04989000
PSAAOLD  EQU   PSA+548                                                  04990000
PSASUPER EQU   PSA+552                                                  04991000
PSASUP1  EQU   PSASUPER                                                 04992000
PSASUP2  EQU   PSASUPER+1                                               04993000
PSASUP3  EQU   PSASUPER+2                                               04994000
PSASUP4  EQU   PSASUPER+3                                               04995000
PSACLHT  EQU   PSA+640                                                  04996000
PSALKSA  EQU   PSA+696                                                  04997000
PSAHLHI  EQU   PSA+760                                                  04998000
PSALITA  EQU   PSA+764                                                  04999000
PSADSSFL EQU   PSA+836                                                  05000000
PSADSSF1 EQU   PSADSSFL                                                 05001000
PSADSSF3 EQU   PSADSSFL+2                                               05002000
PSADSSF4 EQU   PSADSSFL+3                                               05003000
PSARSVT  EQU   PSA+896                                                  05004000
PSALSFCC EQU   PSA+1012                                                 05005000
CVTMAP   EQU   0                                                        05006000
CVT      EQU   CVTMAP                                                   05007000
CVTDAR   EQU   CVTMAP+72                                                05008000
CVTFLGS1 EQU   CVTDAR                                                   05009000
CVTDCB   EQU   CVTMAP+116                                               05010000
CVTIERLC EQU   CVTMAP+144                                               05011000
CVT0PT01 EQU   CVTMAP+152                                               05012000
CVTOPTA  EQU   CVTMAP+182                                               05013000
CVTOPTB  EQU   CVTMAP+183                                               05014000
CVTABEND EQU   CVTMAP+200                                               05015000
CVTGTF   EQU   CVTMAP+236                                               05016000
CVTGTFST EQU   CVTGTF                                                   05017000
CVTGTFS  EQU   CVTGTFST                                                 05018000
CVTSTATE EQU   CVTGTFST                                                 05019000
CVTTMODE EQU   CVTGTFST                                                 05020000
CVTFORM  EQU   CVTGTFST                                                 05021000
CVTAQAVT EQU   CVTMAP+240                                               05022000
CVTTCMFG EQU   CVTAQAVT                                                 05023000
CVTVOLM2 EQU   CVTMAP+244                                               05024000
CVTTATA  EQU   CVTVOLM2                                                 05025000
CVTTSKS  EQU   CVTTATA                                                  05026000
CVTVOLF2 EQU   CVTTSKS                                                  05027000
CVTTAT   EQU   CVTTATA+1                                                05028000
CVTATER  EQU   CVTMAP+248                                               05029000
CVTEXT1  EQU   CVTMAP+252                                               05030000
CVTPURG  EQU   CVTMAP+260                                               05031000
CVTQMSG  EQU   CVTMAP+268                                               05032000
CVTDMSR  EQU   CVTMAP+272                                               05033000
CVTRSV37 EQU   CVTDMSR                                                  05034000
CVTDMSRF EQU   CVTRSV37                                                 05035000
CVTERPV  EQU   CVTMAP+316                                               05036000
CVTINTLA EQU   CVTMAP+320                                               05037000
CVTAPF   EQU   CVTMAP+324                                               05038000
CVTEXT2  EQU   CVTMAP+328                                               05039000
CVTHJES  EQU   CVTMAP+332                                               05040000
CVTPGSIA EQU   CVTMAP+348                                               05041000
CVTA1F1  EQU   CVTMAP+356                                               05042000
CVTSYSK  EQU   CVTMAP+357                                               05043000
CVTVOLM1 EQU   CVTMAP+380                                               05044000
CVTVOLF1 EQU   CVTVOLM1                                                 05045000
CVTATMCT EQU   CVTMAP+388                                               05046000
CVTXTNT1 EQU   0                                                        05047000
CVTXTNT2 EQU   0                                                        05048000
CVTDSSV  EQU   CVTXTNT2                                                 05049000
CVTFLGBT EQU   CVTXTNT2+5                                               05050000
CVTQID   EQU   CVTXTNT2+24                                              05051000
CVTSHS   EQU   CVTXTNT2+40                                              05052000
CVTRV400 EQU   CVTXTNT2+52                                              05053000
CVTRV409 EQU   CVTXTNT2+53                                              05054000
CVTATCVT EQU   CVTXTNT2+64                                              05055000
CVTRV429 EQU   CVTXTNT2+84                                              05056000
CVTRV438 EQU   CVTXTNT2+85                                              05057000
CVTRV457 EQU   CVTXTNT2+112                                             05058000
CVTRV466 EQU   CVTXTNT2+113                                             05059000
CVTFIX   EQU   0                                                        05060000
CVTRELNO EQU   CVTFIX+252                                               05061000
IFGRPL   EQU   0                                                        05062000
RPLCOMN  EQU   IFGRPL                                                   05063000
RPLIDWD  EQU   RPLCOMN                                                  05064000
RPLLEN   EQU   RPLIDWD+3                                                05065000
RPLECB   EQU   RPLCOMN+8                                                05066000
RPLFDBWD EQU   RPLCOMN+12                                               05067000
RPLFDBK  EQU   RPLFDBWD+1                                               05068000
RPLRTNCD EQU   RPLFDBK                                                  05069000
RPLCNDCD EQU   RPLFDBK+1                                                05070000
RPLCMPON EQU   RPLCNDCD                                                 05071000
RPLFDB2  EQU   RPLCMPON                                                 05072000
RPLERRCD EQU   RPLCNDCD+1                                               05073000
RPLFDB3  EQU   RPLERRCD                                                 05074000
RPLKEYLE EQU   RPLCOMN+16                                               05075000
RPLDACB  EQU   RPLCOMN+24                                               05076000
RPLAREA  EQU   RPLCOMN+32                                               05077000
RPLARG   EQU   RPLCOMN+36                                               05078000
RPLOPTCD EQU   RPLCOMN+40                                               05079000
RPLOPT1  EQU   RPLOPTCD                                                 05080000
RPLECBSW EQU   RPLOPT1                                                  05081000
RPLOPT2  EQU   RPLOPTCD+1                                               05082000
RPLADR   EQU   RPLOPT2                                                  05083000
RPLOPT3  EQU   RPLOPTCD+2                                               05084000
RPLOPT4  EQU   RPLOPTCD+3                                               05085000
RPLNXTRP EQU   RPLCOMN+44                                               05086000
RPLRLEN  EQU   RPLCOMN+48                                               05087000
RPLOPTC2 EQU   RPLCOMN+56                                               05088000
RPLOPT5  EQU   RPLOPTC2                                                 05089000
RPLWRTYP EQU   RPLOPT5                                                  05090000
RPLOPT6  EQU   RPLOPTC2+1                                               05091000
RPLUNTYP EQU   RPLOPT6                                                  05092000
RPLOPT7  EQU   RPLOPTC2+2                                               05093000
RPLCNOPT EQU   RPLOPT7                                                  05094000
RPLOPT8  EQU   RPLOPTC2+3                                               05095000
RPLRBAR  EQU   RPLCOMN+60                                               05096000
RPLAIXID EQU   RPLRBAR+2                                                05097000
RPLEXTDS EQU   RPLCOMN+68                                               05098000
RPLEXTD1 EQU   RPLEXTDS                                                 05099000
RPLNIB   EQU   RPLEXTD1                                                 05100000
RPLVTEXT EQU   IFGRPL+76                                                05101000
RPLFDBK2 EQU   RPLVTEXT+12                                              05102000
RPLSSNSI EQU   RPLFDBK2                                                 05103000
RPLDSB   EQU   RPLSSNSI                                                 05104000
RPLDSB1  EQU   RPLDSB                                                   05105000
RPLSSEI  EQU   RPLDSB1                                                  05106000
RPLDSB2  EQU   RPLDSB+1                                                 05107000
RPLUSNSI EQU   RPLFDBK2+2                                               05108000
RPLUSFLD EQU   RPLVTEXT+16                                              05109000
RPLOPTC3 EQU   RPLVTEXT+20                                              05110000
RPLOPT9  EQU   RPLOPTC3                                                 05111000
RPLOPT10 EQU   RPLOPTC3+1                                               05112000
RPLOPT11 EQU   RPLOPTC3+2                                               05113000
RPLOPT12 EQU   RPLOPTC3+3                                               05114000
RPLFMHDR EQU   RPLOPT12                                                 05115000
RPLOSENS EQU   RPLVTEXT+24                                              05116000
RPLSSNSO EQU   RPLOSENS                                                 05117000
RPLSSEO  EQU   RPLSSNSO                                                 05118000
RPLOF16  EQU   0                                                        05119000
RPLRH3   EQU   RPLOF16                                                  05120000
RPLCSI   EQU   RPLRH3                                                   05121000
RPLSRTYP EQU   RPLOF16+1                                                05122000
RPLSTYPE EQU   RPLSRTYP                                                 05123000
RPLRTYPE EQU   RPLSRTYP                                                 05124000
RPLRRESP EQU   RPLRTYPE                                                 05125000
RPLNFSYN EQU   RPLRTYPE                                                 05126000
RPLDFASY EQU   RPLRTYPE                                                 05127000
RPLCHN   EQU   RPLOF16+2                                                05128000
RPLVTFL1 EQU   RPLOF16+3                                                05129000
RPLVTFL2 EQU   RPLOF16+4                                                05130000
RPLPOSTV EQU   RPLVTFL2                                                 05131000
RPLRESP  EQU   RPLVTFL2                                                 05132000
RPLCNTRL EQU   RPLOF16+5                                                05133000
RPLCNTDF EQU   RPLCNTRL                                                 05134000
RPLCNTDC EQU   RPLCNTRL+1                                               05135000
RPLCNTSC EQU   RPLCNTRL+2                                               05136000
RPLOF60  EQU   0                                                        05137000
RPLOBSQ  EQU   RPLOF60+4                                                05138000
RPLIBSQ  EQU   RPLOF60+5                                                05139000
ASCB     EQU   0                                                        05140000
ASCBSUPC EQU   ASCB+16                                                  05141000
ASCBASID EQU   ASCB+36                                                  05142000
ASCBTSB  EQU   ASCB+60                                                  05143000
ASCBFW1  EQU   ASCB+100                                                 05144000
ASCBRCTF EQU   ASCBFW1+2                                                05145000
ASCBFLG1 EQU   ASCBFW1+3                                                05146000
ASCBASXB EQU   ASCB+108                                                 05147000
ASCBDSP1 EQU   ASCB+114                                                 05148000
ASCBFLG2 EQU   ASCB+115                                                 05149000
ASCBLKGP EQU   ASCB+128                                                 05150000
ASCBSRQ  EQU   ASCB+180                                                 05151000
ASCBSRQ1 EQU   ASCBSRQ                                                  05152000
ASCBSRQ2 EQU   ASCBSRQ+1                                                05153000
ASCBSRQ3 EQU   ASCBSRQ+2                                                05154000
ASCBSRQ4 EQU   ASCBSRQ+3                                                05155000
ASXB     EQU   0                                                        05156000
ASXBMPST EQU   ASXB+16                                                  05157000
ASXBAEQ  EQU   ASXB+168                                                 05158000
ASXBCASW EQU   ASXB+216                                                 05159000
ASXBCRB1 EQU   ASXBCASW                                                 05160000
FRRS     EQU   0                                                        05161000
FRRSHEAD EQU   FRRS                                                     05162000
FRRSEMP  EQU   FRRSHEAD                                                 05163000
FRRSLAST EQU   FRRSHEAD+4                                               05164000
FRRSELEN EQU   FRRSHEAD+8                                               05165000
FRRSCURR EQU   FRRSHEAD+12                                              05166000
FRRSENTR EQU   0                                                        05167000
FRRSFRRA EQU   FRRSENTR                                                 05168000
FRRSFLGS EQU   FRRSENTR+4                                               05169000
FRRSFLG1 EQU   FRRSFLGS                                                 05170000
FRRSPARM EQU   FRRSENTR+8                                               05171000
SCVTSECT EQU   0                                                        05172000
SCVTSTAT EQU   SCVTSECT+148                                             05173000
SRBSECT  EQU   0                                                        05174000
SRBFLC   EQU   SRBSECT+12                                               05175000
WSAG     EQU   0                                                        05176000
TSB      EQU   0                                                        05177000
TSBASCBA EQU   TSB                                                      05178000
TSBSTAT  EQU   TSBASCBA                                                 05179000
TSBFLG1  EQU   TSB+4                                                    05180000
TSBIFLSH EQU   TSBFLG1                                                  05181000
TSBLNSZ  EQU   TSB+8                                                    05182000
TSBFLG2  EQU   TSB+16                                                   05183000
TSBAUTON EQU   TSBFLG2                                                  05184000
TSBAULST EQU   TSBFLG2                                                  05185000
TSBSTAUT EQU   TSBFLG2                                                  05186000
TSBFLG3  EQU   TSB+24                                                   05187000
TSBSPIT  EQU   TSBFLG3                                                  05188000
TSBFLG5  EQU   TSB+25                                                   05189000
TSBTERMC EQU   TSB+26                                                   05190000
TSBTERM1 EQU   TSBTERMC                                                 05191000
TSBTERM2 EQU   TSBTERMC+1                                               05192000
TSBSTCC  EQU   TSB+34                                                   05193000
TSBFLG4  EQU   TSB+41                                                   05194000
TSBIWAIT EQU   TSBFLG4                                                  05195000
TSBOWAIT EQU   TSBFLG4                                                  05196000
TSBAUTOS EQU   TSB+48                                                   05197000
TSBRCB   EQU   TSB+64                                                   05198000
TSBLINKA EQU   TSBRCB+4                                                 05199000
TSBTPOST EQU   TSB+72                                                   05200000
TSBTPFLG EQU   TSBTPOST                                                 05201000
TSBMINL  EQU   TSB+84                                                   05202000
TSBEXTNT EQU   TSB+96                                                   05203000
TSBX     EQU   0                                                        05204000
TSBXFLG1 EQU   TSBX+32                                                  05205000
TSBXASCI EQU   TSBXFLG1                                                 05206000
TSBXTVWA EQU   TSBX+36                                                  05207000
TSBXTERM EQU   TSBX+72                                                  05208000
IKTFRPRM EQU   0                                                        05209000
FRPCKINF EQU   IKTFRPRM                                                 05210000
FRPCONST EQU   IKTFRPRM+4                                               05211000
FRPRETRY EQU   IKTFRPRM+8                                               05212000
FRPXITPT EQU   IKTFRPRM+12                                              05213000
FRPRPLAD EQU   IKTFRPRM+16                                              05214000
FRPFRFLG EQU   IKTFRPRM+20                                              05215000
FRPOMNGR EQU   FRPFRFLG                                                 05216000
IKTFRRWA EQU   0                                                        05217000
FRWACKPT EQU   IKTFRRWA                                                 05218000
FRWARTRY EQU   IKTFRRWA+8                                               05219000
FRWAEXIT EQU   IKTFRRWA+16                                              05220000
FRWACKRG EQU   IKTFRRWA+24                                              05221000
FRWAEXRG EQU   IKTFRRWA+88                                              05222000
FRWAFLGS EQU   IKTFRRWA+152                                             05223000
FRWAFL1  EQU   FRWAFLGS                                                 05224000
IKTLTCB  EQU   0                                                        05225000
LTCBFLAG EQU   IKTLTCB+3                                                05226000
LTCBIOER EQU   LTCBFLAG                                                 05227000
TCAST    EQU   0                                                        05228000
TCASUSER EQU   TCAST+4                                                  05229000
TCASMSGS EQU   TCAST+52                                                 05230000
TCASFRR  EQU   TCAST+56                                                 05231000
TCASOQM  EQU   TCAST+76                                                 05232000
TCASEXIT EQU   TCAST+80                                                 05233000
TCASFLG1 EQU   TCAST+88                                                 05234000
TCASFLG2 EQU   TCAST+89                                                 05235000
TVWA     EQU   0                                                        05236000
TVWATOMW EQU   TVWA+12                                                  05237000
TVWATOPQ EQU   TVWA+16                                                  05238000
TVWACHNL EQU   TVWA+84                                                  05239000
TVWAATTN EQU   TVWA+85                                                  05240000
TVWATQL1 EQU   TVWA+86                                                  05241000
TVWAACB  EQU   TVWA+88                                                  05242000
TVWANIB  EQU   TVWA+92                                                  05243000
TVWAFLG7 EQU   TVWA+110                                                 05244000
TVWATOBB EQU   TVWAFLG7                                                 05245000
TVWAECBL EQU   TVWA+120                                                 05246000
TVWADLST EQU   TVWA+132                                                 05247000
TVWAFLG1 EQU   TVWA+144                                                 05248000
TVWATIS  EQU   TVWAFLG1                                                 05249000
TVWATAS  EQU   TVWAFLG1                                                 05250000
TVWATID  EQU   TVWAFLG1                                                 05251000
TVWALTE  EQU   TVWAFLG1                                                 05252000
TVWAOOPS EQU   TVWAFLG1                                                 05253000
TVWAFLG2 EQU   TVWA+145                                                 05254000
TVWABFC  EQU   TVWAFLG2                                                 05255000
TVWASCD  EQU   TVWAFLG2                                                 05256000
TVWAGERR EQU   TVWAFLG2                                                 05257000
TVWAERMG EQU   TVWAFLG2                                                 05258000
TVWABKMG EQU   TVWAFLG2                                                 05259000
TVWARTRY EQU   TVWAFLG2                                                 05260000
TVWABIR  EQU   TVWAFLG2                                                 05261000
TVWAFLG3 EQU   TVWA+146                                                 05262000
TVWABRIN EQU   TVWAFLG3                                                 05263000
TVWAAIGN EQU   TVWAFLG3                                                 05264000
TVWATRAN EQU   TVWAFLG3                                                 05265000
TVWAFLG4 EQU   TVWA+147                                                 05266000
TVWADOOQ EQU   TVWAFLG4                                                 05267000
TVWARCRS EQU   TVWAFLG4                                                 05268000
TVWAFLG5 EQU   TVWA+150                                                 05269000
TVWATIR  EQU   TVWAFLG5                                                 05270000
TVWATABO EQU   TVWA+156                                                 05271000
TVWAATBO EQU   TVWA+172                                                 05272000
TVWAFLG6 EQU   TVWA+182                                                 05273000
TVWAISYS EQU   TVWAFLG6                                                 05274000
TVWAIOP  EQU   TVWAFLG6                                                 05275000
TVWAINB  EQU   TVWAFLG6                                                 05276000
TVWAFRWO EQU   TVWA+188                                                 05277000
ISTPAB   EQU   0                                                        05278000
PABWQCHN EQU   ISTPAB                                                   05279000
PABWEQA  EQU   PABWQCHN                                                 05280000
PABCHAIN EQU   PABWQCHN+4                                               05281000
PABRPHFG EQU   ISTPAB+12                                                05282000
PABFLAGS EQU   PABRPHFG                                                 05283000
PABERLCK EQU   PABFLAGS                                                 05284000
PABERRLK EQU   PABERLCK                                                 05285000
ISTDYPAB EQU   0                                                        05286000
ISTMPST  EQU   0                                                        05287000
MPSRSV07 EQU   ISTMPST+4                                                05288000
MPSTSOIW EQU   MPSRSV07                                                 05289000
MPSTSOIR EQU   MPSRSV07                                                 05290000
MPSRQUE  EQU   ISTMPST+8                                                05291000
MPSFLGA  EQU   ISTMPST+12                                               05292000
MPSCRA   EQU   ISTMPST+24                                               05293000
MPSCRACT EQU   MPSCRA+4                                                 05294000
MPSSRB   EQU   ISTMPST+32                                               05295000
MPSSRBCT EQU   MPSSRB+4                                                 05296000
MPSCRPL  EQU   ISTMPST+40                                               05297000
MPSRPLCT EQU   MPSCRPL+4                                                05298000
ISTPROCD EQU   0                                                        05299000
PROPROC  EQU   ISTPROCD                                                 05300000
PROPROC1 EQU   PROPROC                                                  05301000
PROPROC2 EQU   PROPROC+1                                                05302000
PROPROC3 EQU   PROPROC+2                                                05303000
PROPROC4 EQU   PROPROC+3                                                05304000
PROPROCS EQU   0                                                        05305000
PROSETMS EQU   PROPROCS+1                                               05306000
PROSETM2 EQU   PROSETMS                                                 05307000
PROSETM3 EQU   PROSETMS+1                                               05308000
PROSETM4 EQU   PROSETMS+2                                               05309000
ISTDEVCH EQU   0                                                        05310000
DEVSHCH  EQU   ISTDEVCH                                                 05311000
DEVCHAR  EQU   DEVSHCH                                                  05312000
DEVTCODE EQU   ISTDEVCH+1                                               05313000
DEVFLAGS EQU   ISTDEVCH+3                                               05314000
DEVFCCTL EQU   DEVFLAGS                                                 05315000
DEVCHAR3 EQU   DEVFLAGS                                                 05316000
ISTNIB   EQU   0                                                        05317000
NIBCID   EQU   ISTNIB+4                                                 05318000
NIBFLGS  EQU   ISTNIB+40                                                05319000
NIBFLG1  EQU   NIBFLGS                                                  05320000
WORKAREA EQU   320                                                      05321000
OPARMS   EQU   WORKAREA                                                 05322000
OPBUFADR EQU   OPARMS                                                   05323000
OPREQ    EQU   OPARMS+4                                                 05324000
OPRC     EQU   OPARMS+5                                                 05325000
OPBFSZ   EQU   OPARMS+6                                                 05326000
OPFLAGS  EQU   OPARMS+8                                                 05327000
OPOPTNS  EQU   OPFLAGS+1                                                05328000
OPHOLD   EQU   OPOPTNS                                                  05329000
OPBRK    EQU   OPOPTNS                                                  05330000
OPEDIT   EQU   OPOPTNS                                                  05331000
OPASID   EQU   OPOPTNS                                                  05332000
OPNXBFSZ EQU   OPARMS+14                                                05333000
OPNXFLGS EQU   OPARMS+16                                                05334000
OPNXBRK  EQU   OPNXFLGS+1                                               05335000
OPNXEDIT EQU   OPNXFLGS+1                                               05336000
OPNXASID EQU   OPNXFLGS+1                                               05337000
BUFPTR   EQU   WORKAREA+20                                              05338000
OPARMSA  EQU   WORKAREA+28                                              05339000
BYTECNTA EQU   WORKAREA+32                                              05340000
BUFPTRA  EQU   WORKAREA+36                                              05341000
RUADDR   EQU   WORKAREA+40                                              05342000
CHARCNTA EQU   WORKAREA+44                                              05343000
BITVALA  EQU   WORKAREA+48                                              05344000
@NM00141 EQU   WORKAREA+52                                              05345000
LASTPARM EQU   @NM00141                                                 05346000
TSBADDR  EQU   @NM00141+1                                               05347000
WKSP     EQU   WORKAREA+56                                              05348000
RU       EQU   WORKAREA+312                                             05349000
PACKAREA EQU   WORKAREA+568                                             05350000
UNPKAREA EQU   WORKAREA+576                                             05351000
@NM00143 EQU   UNPKAREA+7                                               05352000
NIB1     EQU   @NM00143                                                 05353000
NIB2     EQU   @NM00143                                                 05354000
NIB3     EQU   @NM00143                                                 05355000
NIB4     EQU   @NM00143                                                 05356000
INDICES  EQU   WORKAREA+584                                             05357000
I        EQU   INDICES                                                  05358000
L        EQU   INDICES+4                                                05359000
R        EQU   INDICES+8                                                05360000
ESTIMATE EQU   WORKAREA+596                                             05361000
SIZE     EQU   WORKAREA+600                                             05362000
BYTECNT  EQU   WORKAREA+604                                             05363000
CHARCNT  EQU   WORKAREA+608                                             05364000
LIMIT    EQU   WORKAREA+612                                             05365000
CNT      EQU   WORKAREA+616                                             05366000
RETRY    EQU   WORKAREA+625                                             05367000
CHAINSZE EQU   WORKAREA+626                                             05368000
RUCOUNT  EQU   WORKAREA+627                                             05369000
BITVAR   EQU   WORKAREA+628                                             05370000
SRPLCHN  EQU   BITVAR                                                   05371000
BITVALU0 EQU   BITVAR+1                                                 05372000
MOR      EQU   BITVALU0                                                 05373000
HLD      EQU   BITVALU0                                                 05374000
FCNERR   EQU   BITVALU0                                                 05375000
PARMERR  EQU   BITVALU0                                                 05376000
RETRYMSG EQU   BITVALU0                                                 05377000
XIT      EQU   BITVALU0                                                 05378000
BITVAL00 EQU   BITVAR+2                                                 05379000
BRK      EQU   BITVAL00                                                 05380000
XC       EQU   BITVAL00                                                 05381000
NXC      EQU   BITVAL00                                                 05382000
MORMSGS  EQU   BITVAL00                                                 05383000
ERMG     EQU   BITVAL00                                                 05384000
SKIP     EQU   BITVAL00                                                 05385000
BYPASS   EQU   BITVAL00                                                 05386000
BITVALU1 EQU   BITVAR+3                                                 05387000
PSENT    EQU   BITVALU1                                                 05388000
MSG      EQU   BITVALU1                                                 05389000
TSTPRMPT EQU   BITVALU1                                                 05390000
AGAIN    EQU   BITVALU1                                                 05391000
MORBITS  EQU   BITVAR+4                                                 05392000
SEVENT   EQU   MORBITS                                                  05393000
OUTOFRNG EQU   MORBITS                                                  05394000
NORMEDIT EQU   MORBITS                                                  05395000
TIME1    EQU   MORBITS                                                  05396000
NEC      EQU   MORBITS                                                  05397000
REPEAT   EQU   MORBITS                                                  05398000
CHK      EQU   MORBITS                                                  05399000
HELPBITS EQU   BITVAR+5                                                 05400000
PROMPT   EQU   HELPBITS                                                 05401000
SWNL     EQU   HELPBITS                                                 05402000
SPEC     EQU   HELPBITS                                                 05403000
SIGSENT  EQU   HELPBITS                                                 05404000
SENDPRMT EQU   HELPBITS                                                 05405000
NOTNOW   EQU   HELPBITS                                                 05406000
SAVE14   EQU   WORKAREA+636                                             05407000
INFODSCT EQU   0                                                        05408000
INFOREGS EQU   INFODSCT                                                 05409000
INFOADDR EQU   INFODSCT+4                                               05410000
@NM00283 EQU   0                                                        05411000
MSGSIZE  EQU   @NM00283                                                 05412000
MSGDATA  EQU   @NM00283+2                                               05413000
MSGADR   EQU   0                                                        05414000
ASCIITAB EQU   0                                                        05415000
BUFFER   EQU   0                                                        05416000
IKTIOFRR EQU   0                                                        05417000
IKTQMOUT EQU   0                                                        05418000
MESSAGE  EQU   0                                                        05419000
STATUS   EQU   0                                                        05420000
USRTRANS EQU   0                                                        05421000
IKTEXIT  EQU   0                                                        05422000
ISTRPL   EQU   0                                                        05423000
POST     EQU   0                                                        05424000
CVTPTR   EQU   FLCCVT                                                   05425000
CVTS01   EQU   CVTPGSIA                                                 05426000
CVTLPDIA EQU   CVTS01+12                                                05427000
CVTDIRST EQU   CVTLPDIA                                                 05428000
CVTSLIDA EQU   CVTS01+24                                                05429000
CVTCTLFG EQU   CVTS01+50                                                05430000
CVTOPTE  EQU   CVTS01+188                                               05431000
CVTSPSA  EQU   CVTS01+336                                               05432000
CVTRV210 EQU   CVTS01+424                                               05433000
CVTRV219 EQU   CVTS01+425                                               05434000
CVTRV228 EQU   CVTS01+426                                               05435000
CVTRV237 EQU   CVTS01+427                                               05436000
CVTMFRTR EQU   CVTS01+452                                               05437000
CVTRV262 EQU   CVTS01+468                                               05438000
CVTRV271 EQU   CVTS01+469                                               05439000
CVTRV280 EQU   CVTS01+470                                               05440000
CVTRV289 EQU   CVTS01+471                                               05441000
CVTGSDA  EQU   CVTS01+600                                               05442000
CVTTCASP EQU   CVTS01+664                                               05443000
FLC      EQU   PSA                                                      05444000
PSARSVTE EQU   PSARSVT                                                  05445000
PSACSTK  EQU   PSARSVTE                                                 05446000
ASXBPTR  EQU   ASCBASXB                                                 05447000
CHARPRMT EQU   TSBAUTOS                                                 05448000
SRB      EQU   SRBSECT                                                  05449000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05450000
PSARSAV  EQU   PSARSVTE+60                                              05451000
PSARSTK  EQU   PSARSVTE+56                                              05452000
PSAESAV3 EQU   PSARSVTE+52                                              05453000
PSAESTK3 EQU   PSARSVTE+48                                              05454000
PSAESAV2 EQU   PSARSVTE+44                                              05455000
PSAESTK2 EQU   PSARSVTE+40                                              05456000
PSAESAV1 EQU   PSARSVTE+36                                              05457000
PSAESTK1 EQU   PSARSVTE+32                                              05458000
PSAPSAV  EQU   PSARSVTE+28                                              05459000
PSAPSTK  EQU   PSARSVTE+24                                              05460000
PSAMSAV  EQU   PSARSVTE+20                                              05461000
PSAMSTK  EQU   PSARSVTE+16                                              05462000
PSASSAV  EQU   PSARSVTE+12                                              05463000
PSASSTK  EQU   PSARSVTE+8                                               05464000
PSANSTK  EQU   PSARSVTE+4                                               05465000
CVTRV628 EQU   CVTS01+728                                               05466000
CVTRV627 EQU   CVTS01+724                                               05467000
CVTRV626 EQU   CVTS01+720                                               05468000
CVTRV625 EQU   CVTS01+716                                               05469000
CVTRV624 EQU   CVTS01+712                                               05470000
CVTRV623 EQU   CVTS01+708                                               05471000
CVTRV622 EQU   CVTS01+704                                               05472000
CVTRV621 EQU   CVTS01+700                                               05473000
CVTRV620 EQU   CVTS01+696                                               05474000
CVTRV619 EQU   CVTS01+692                                               05475000
CVTRV618 EQU   CVTS01+688                                               05476000
CVTRV617 EQU   CVTS01+684                                               05477000
CVTRV616 EQU   CVTS01+680                                               05478000
CVTRV615 EQU   CVTS01+676                                               05479000
CVTRV614 EQU   CVTS01+672                                               05480000
CVTRV613 EQU   CVTS01+668                                               05481000
CVT0PT03 EQU   CVTS01+660                                               05482000
CVT0PT0E EQU   CVTS01+656                                               05483000
CVTIRM   EQU   CVTS01+652                                               05484000
CVTCGK   EQU   CVTS01+648                                               05485000
CVTRV607 EQU   CVTS01+644                                               05486000
CVTRV606 EQU   CVTS01+640                                               05487000
CVTRV605 EQU   CVTS01+636                                               05488000
CVTRV604 EQU   CVTS01+632                                               05489000
CVTEFF02 EQU   CVTS01+628                                               05490000
CVTCBBR  EQU   CVTS01+624                                               05491000
CVTSSCR  EQU   CVTS01+620                                               05492000
CVTEVENT EQU   CVTS01+616                                               05493000
CVTCRCA  EQU   CVTS01+612                                               05494000
CVTTPIO  EQU   CVTS01+608                                               05495000
CVTADV   EQU   CVTS01+604                                               05496000
CVTGSDAB EQU   CVTGSDA                                                  05497000
CVTQV3   EQU   CVTS01+596                                               05498000
CVTQV2   EQU   CVTS01+592                                               05499000
CVTQV1   EQU   CVTS01+588                                               05500000
CVTRPT   EQU   CVTS01+584                                               05501000
CVTSSRB  EQU   CVTS01+580                                               05502000
CVTCSDRL EQU   CVTS01+576                                               05503000
CVTEXP1  EQU   CVTS01+572                                               05504000
CVTRMPMT EQU   CVTS01+568                                               05505000
CVTRMPTT EQU   CVTS01+564                                               05506000
CVTVPSA  EQU   CVTS01+560                                               05507000
CVTVSTOP EQU   CVTS01+556                                               05508000
CVTGTFR8 EQU   CVTS01+552                                               05509000
CVTQUIT  EQU   CVTS01+548                                               05510000
CVTVACR  EQU   CVTS01+544                                               05511000
CVTWTCB  EQU   CVTS01+540                                               05512000
CVTSTPRS EQU   CVTS01+536                                               05513000
CVT0PT02 EQU   CVTS01+532                                               05514000
CVTDARCM EQU   CVTS01+528                                               05515000
CVTIRECM EQU   CVTS01+524                                               05516000
CVTJRECM EQU   CVTS01+520                                               05517000
CVTVEMS0 EQU   CVTS01+516                                               05518000
CVTSPFRR EQU   CVTS01+512                                               05519000
CVTRLSTG EQU   CVTS01+508                                               05520000
CVT0TC0A EQU   CVTS01+504                                               05521000
CVTGMBR  EQU   CVTS01+500                                               05522000
CVTLFRM  EQU   CVTS01+496                                               05523000
CVTRMBR  EQU   CVTS01+492                                               05524000
CVTVIOP  EQU   CVTS01+488                                               05525000
CVTRV307 EQU   CVTS01+486                                               05526000
CVTRV306 EQU   CVTS01+484                                               05527000
CVTRV305 EQU   CVTS01+482                                               05528000
CVTRV304 EQU   CVTS01+480                                               05529000
CVTRV303 EQU   CVTS01+478                                               05530000
CVTRV302 EQU   CVTS01+476                                               05531000
CVTTRCA  EQU   CVTS01+472                                               05532000
CVTRV297 EQU   CVTRV289                                                 05533000
CVTRV296 EQU   CVTRV289                                                 05534000
CVTRV295 EQU   CVTRV289                                                 05535000
CVTRV294 EQU   CVTRV289                                                 05536000
CVTRV293 EQU   CVTRV289                                                 05537000
CVTRV292 EQU   CVTRV289                                                 05538000
CVTRV291 EQU   CVTRV289                                                 05539000
CVTRV290 EQU   CVTRV289                                                 05540000
CVTRV288 EQU   CVTRV280                                                 05541000
CVTRV287 EQU   CVTRV280                                                 05542000
CVTRV286 EQU   CVTRV280                                                 05543000
CVTRV285 EQU   CVTRV280                                                 05544000
CVTRV284 EQU   CVTRV280                                                 05545000
CVTRV283 EQU   CVTRV280                                                 05546000
CVTRV282 EQU   CVTRV280                                                 05547000
CVTRV281 EQU   CVTRV280                                                 05548000
CVTRV279 EQU   CVTRV271                                                 05549000
CVTRV278 EQU   CVTRV271                                                 05550000
CVTRV277 EQU   CVTRV271                                                 05551000
CVTRV276 EQU   CVTRV271                                                 05552000
CVTRV275 EQU   CVTRV271                                                 05553000
CVTRV274 EQU   CVTRV271                                                 05554000
CVTRV273 EQU   CVTRV271                                                 05555000
CVTRV272 EQU   CVTRV271                                                 05556000
CVTRV270 EQU   CVTRV262                                                 05557000
CVTRV269 EQU   CVTRV262                                                 05558000
CVTRV268 EQU   CVTRV262                                                 05559000
CVTRV267 EQU   CVTRV262                                                 05560000
CVTRV266 EQU   CVTRV262                                                 05561000
CVTRV265 EQU   CVTRV262                                                 05562000
CVTRV264 EQU   CVTRV262                                                 05563000
CVTRV263 EQU   CVTRV262                                                 05564000
CVTVFP   EQU   CVTS01+464                                               05565000
CVTVSI   EQU   CVTS01+460                                               05566000
CVTVPSIB EQU   CVTS01+456                                               05567000
CVTMFACT EQU   CVTMFRTR                                                 05568000
CVTMFCTL EQU   CVTS01+448                                               05569000
CVTPVBP  EQU   CVTS01+444                                               05570000
CVTPWI   EQU   CVTS01+440                                               05571000
CVTRV254 EQU   CVTS01+438                                               05572000
CVTRV253 EQU   CVTS01+436                                               05573000
CVTRV252 EQU   CVTS01+434                                               05574000
CVTRV251 EQU   CVTS01+433                                               05575000
CVTRV250 EQU   CVTS01+432                                               05576000
CVTRV249 EQU   CVTS01+431                                               05577000
CVTRV248 EQU   CVTS01+430                                               05578000
CVTRV247 EQU   CVTS01+429                                               05579000
CVTRV246 EQU   CVTS01+428                                               05580000
CVTRV245 EQU   CVTRV237                                                 05581000
CVTRV244 EQU   CVTRV237                                                 05582000
CVTRV243 EQU   CVTRV237                                                 05583000
CVTRV242 EQU   CVTRV237                                                 05584000
CVTRV241 EQU   CVTRV237                                                 05585000
CVTRV240 EQU   CVTRV237                                                 05586000
CVTRV239 EQU   CVTRV237                                                 05587000
CVTRV238 EQU   CVTRV237                                                 05588000
CVTRV236 EQU   CVTRV228                                                 05589000
CVTRV235 EQU   CVTRV228                                                 05590000
CVTRV234 EQU   CVTRV228                                                 05591000
CVTRV233 EQU   CVTRV228                                                 05592000
CVTRV232 EQU   CVTRV228                                                 05593000
CVTRV231 EQU   CVTRV228                                                 05594000
CVTRV230 EQU   CVTRV228                                                 05595000
CVTRV229 EQU   CVTRV228                                                 05596000
CVTRV227 EQU   CVTRV219                                                 05597000
CVTRV226 EQU   CVTRV219                                                 05598000
CVTRV225 EQU   CVTRV219                                                 05599000
CVTRV224 EQU   CVTRV219                                                 05600000
CVTRV223 EQU   CVTRV219                                                 05601000
CVTRV222 EQU   CVTRV219                                                 05602000
CVTRV221 EQU   CVTRV219                                                 05603000
CVTRV220 EQU   CVTRV219                                                 05604000
CVTRV218 EQU   CVTRV210                                                 05605000
CVTRV217 EQU   CVTRV210                                                 05606000
CVTRV216 EQU   CVTRV210                                                 05607000
CVTRV215 EQU   CVTRV210                                                 05608000
CVTRV214 EQU   CVTRV210                                                 05609000
CVTRV213 EQU   CVTRV210                                                 05610000
CVTRV212 EQU   CVTRV210                                                 05611000
CVTRV211 EQU   CVTRV210                                                 05612000
CVTLCCAT EQU   CVTS01+420                                               05613000
CVTPCCAT EQU   CVTS01+416                                               05614000
CVTIPCRP EQU   CVTS01+412                                               05615000
CVTIPCRI EQU   CVTS01+408                                               05616000
CVTIPCDS EQU   CVTS01+404                                               05617000
CVTAIDVT EQU   CVTS01+400                                               05618000
CVTSSAP  EQU   CVTS01+396                                               05619000
CVTEHCIR EQU   CVTS01+392                                               05620000
CVTEHDEF EQU   CVTS01+388                                               05621000
CVTDAIR  EQU   CVTS01+384                                               05622000
CVTPERFM EQU   CVTS01+380                                               05623000
CVT044R2 EQU   CVTS01+376                                               05624000
CVTFETCH EQU   CVTS01+372                                               05625000
CVTRSTWD EQU   CVTS01+368                                               05626000
CVTSPOST EQU   CVTS01+364                                               05627000
CVTIOBP  EQU   CVTS01+360                                               05628000
CVTASMVT EQU   CVTS01+356                                               05629000
CVTRECRQ EQU   CVTS01+352                                               05630000
CVTWSAC  EQU   CVTS01+348                                               05631000
CVTRV149 EQU   CVTS01+344                                               05632000
CVTWSAL  EQU   CVTS01+340                                               05633000
CVTGLMN  EQU   CVTS01+332                                               05634000
CVTVEAC0 EQU   CVTS01+328                                               05635000
CVT062R1 EQU   CVTS01+324                                               05636000
CVTRPOST EQU   CVTS01+320                                               05637000
CVTDQIQE EQU   CVTS01+316                                               05638000
CVTCSD   EQU   CVTS01+312                                               05639000
CVTLKRMA EQU   CVTS01+308                                               05640000
CVTRSPIE EQU   CVTS01+304                                               05641000
CVTRENQ  EQU   CVTS01+300                                               05642000
CVTLQCB  EQU   CVTS01+296                                               05643000
CVTFQCB  EQU   CVTS01+292                                               05644000
CVTQCS01 EQU   CVTS01+288                                               05645000
CVTAPFT  EQU   CVTS01+284                                               05646000
CVTPARRL EQU   CVTS01+280                                               05647000
CVTVWAIT EQU   CVTS01+276                                               05648000
CVTGSPL  EQU   CVTS01+272                                               05649000
CVTLSMQ  EQU   CVTS01+268                                               05650000
CVTGSMQ  EQU   CVTS01+264                                               05651000
CVTEXPRO EQU   CVTS01+260                                               05652000
CVTOPCTP EQU   CVTS01+256                                               05653000
CVTSIC   EQU   CVTS01+252                                               05654000
CVTTPIOS EQU   CVTS01+248                                               05655000
CVTRTMS  EQU   CVTS01+244                                               05656000
CVTSDBF  EQU   CVTS01+240                                               05657000
CVTSCBP  EQU   CVTS01+236                                               05658000
CVTSDMP  EQU   CVTS01+232                                               05659000
CVTSV60  EQU   CVTS01+228                                               05660000
CVTRTMCT EQU   CVTS01+224                                               05661000
CVTASCBL EQU   CVTS01+220                                               05662000
CVTASCBH EQU   CVTS01+216                                               05663000
CVTGDA   EQU   CVTS01+212                                               05664000
CVTASVT  EQU   CVTS01+208                                               05665000
CVTVVMDI EQU   CVTS01+204                                               05666000
CVTAQTOP EQU   CVTS01+200                                               05667000
CVTIOSCS EQU   CVTS01+196                                               05668000
CVTSDRM  EQU   CVTS01+192                                               05669000
CVTSTXU  EQU   CVTS01+184                                               05670000
CVTQUIS  EQU   CVTS01+180                                               05671000
CVTPARS  EQU   CVTS01+176                                               05672000
CVTS1EE  EQU   CVTS01+172                                               05673000
CVTFRAS  EQU   CVTS01+168                                               05674000
CVTQSAS  EQU   CVTS01+164                                               05675000
CVTCRAS  EQU   CVTS01+160                                               05676000
CVTCRMN  EQU   CVTS01+156                                               05677000
CVTDELCP EQU   CVTS01+152                                               05678000
CVTFRECL EQU   CVTS01+148                                               05679000
CVTGETCL EQU   CVTS01+144                                               05680000
CVTBLDCP EQU   CVTS01+140                                               05681000
CVTAUTHL EQU   CVTS01+136                                               05682000
CVTSCAN  EQU   CVTS01+132                                               05683000
CVTRV144 EQU   CVTS01+130                                               05684000
CVTMAXMP EQU   CVTS01+128                                               05685000
CVTSTCK  EQU   CVTS01+124                                               05686000
CVTRV139 EQU   CVTS01+123                                               05687000
CVTDSSAC EQU   CVTS01+122                                               05688000
CVTRV513 EQU   CVTS01+121                                               05689000
CVTIOSPL EQU   CVTS01+120                                               05690000
CVTPTGT  EQU   CVTS01+116                                               05691000
CVTCSPIE EQU   CVTS01+112                                               05692000
CVTSMFEX EQU   CVTS01+108                                               05693000
CVTOLT0A EQU   CVTS01+104                                               05694000
CVTSRBRT EQU   CVTS01+100                                               05695000
CVTPUTL  EQU   CVTS01+96                                                05696000
CVTASCRL EQU   CVTS01+92                                                05697000
CVTASCRF EQU   CVTS01+88                                                05698000
CVTRV326 EQU   CVTS01+84                                                05699000
CVTRV325 EQU   CVTS01+80                                                05700000
CVTRV324 EQU   CVTS01+76                                                05701000
CVT0VL01 EQU   CVTS01+72                                                05702000
CVTSHRVM EQU   CVTS01+68                                                05703000
CVTRV332 EQU   CVTS01+64                                                05704000
CVTTAS   EQU   CVTS01+60                                                05705000
CVTRSCN  EQU   CVTS01+56                                                05706000
CVTTRAC2 EQU   CVTS01+54                                                05707000
CVTTRACE EQU   CVTS01+52                                                05708000
CVTAPG   EQU   CVTS01+51                                                05709000
CVTSDTRC EQU   CVTCTLFG                                                 05710000
CVTGTRCE EQU   CVTCTLFG                                                 05711000
CVTNOMP  EQU   CVTCTLFG                                                 05712000
CVTRSV79 EQU   CVTCTLFG                                                 05713000
CVTDSTAT EQU   CVTCTLFG                                                 05714000
CVTRSV78 EQU   CVTCTLFG                                                 05715000
CVTRV333 EQU   CVTCTLFG                                                 05716000
CVTRV323 EQU   CVTCTLFG                                                 05717000
CVTSPVLK EQU   CVTS01+49                                                05718000
CVTRSV77 EQU   CVTS01+48                                                05719000
CVTRV331 EQU   CVTS01+44                                                05720000
CVTRV330 EQU   CVTS01+40                                                05721000
CVTRV329 EQU   CVTS01+36                                                05722000
CVTRV328 EQU   CVTS01+32                                                05723000
CVTRV322 EQU   CVTS01+28                                                05724000
CVTSLID  EQU   CVTSLIDA+1                                               05725000
CVTSYLK  EQU   CVTSLIDA                                                 05726000
CVTRV321 EQU   CVTS01+20                                                05727000
CVTRV320 EQU   CVTS01+16                                                05728000
CVTLPDIR EQU   CVTLPDIA+1                                               05729000
CVTRSV69 EQU   CVTDIRST                                                 05730000
CVTRSV68 EQU   CVTDIRST                                                 05731000
CVTRSV67 EQU   CVTDIRST                                                 05732000
CVTRSV66 EQU   CVTDIRST                                                 05733000
CVTRSV65 EQU   CVTDIRST                                                 05734000
CVTRSV64 EQU   CVTDIRST                                                 05735000
CVTRSV63 EQU   CVTDIRST                                                 05736000
CVTDICOM EQU   CVTDIRST                                                 05737000
CVTPVTP  EQU   CVTS01+8                                                 05738000
CVTLPDSR EQU   CVTS01+4                                                 05739000
CVTGETL  EQU   CVTS01                                                   05740000
@NM00152 EQU   BITVAR+6                                                 05741000
@NM00151 EQU   HELPBITS                                                 05742000
@NM00150 EQU   MORBITS                                                  05743000
@NM00149 EQU   BITVALU1                                                 05744000
@NM00148 EQU   BITVAL00                                                 05745000
@NM00147 EQU   BITVALU0                                                 05746000
@NM00146 EQU   WORKAREA+624                                             05747000
@NM00145 EQU   WORKAREA+620                                             05748000
@NM00144 EQU   @NM00143                                                 05749000
@NM00142 EQU   UNPKAREA                                                 05750000
@NM00140 EQU   WORKAREA+24                                              05751000
@NM00139 EQU   OPNXFLGS+3                                               05752000
@NM00138 EQU   OPNXFLGS+2                                               05753000
@NM00137 EQU   OPNXFLGS+1                                               05754000
OPNXHOLD EQU   OPNXFLGS+1                                               05755000
@NM00136 EQU   OPNXFLGS                                                 05756000
OPNXADTP EQU   OPNXFLGS                                                 05757000
OPNXALC  EQU   OPNXFLGS                                                 05758000
@NM00135 EQU   OPARMS+12                                                05759000
@NM00134 EQU   OPFLAGS+3                                                05760000
@NM00133 EQU   OPFLAGS+2                                                05761000
@NM00132 EQU   OPOPTNS                                                  05762000
@NM00131 EQU   OPFLAGS                                                  05763000
OPADTOP  EQU   OPFLAGS                                                  05764000
OPALLOC  EQU   OPFLAGS                                                  05765000
NIBRESV  EQU   ISTNIB+60                                                05766000
NIBNDAR  EQU   ISTNIB+56                                                05767000
NIBLMODE EQU   ISTNIB+48                                                05768000
NIBEXLST EQU   ISTNIB+44                                                05769000
NIBLIMIT EQU   ISTNIB+42                                                05770000
@NM00130 EQU   ISTNIB+41                                                05771000
@NM00129 EQU   NIBFLG1                                                  05772000
@NM00128 EQU   NIBFLG1                                                  05773000
@NM00127 EQU   NIBFLG1                                                  05774000
@NM00126 EQU   NIBFLG1                                                  05775000
NIBSHLTP EQU   NIBFLG1                                                  05776000
NIBSDAPP EQU   NIBFLG1                                                  05777000
NIBCON   EQU   NIBFLG1                                                  05778000
NIBLAST  EQU   NIBFLG1                                                  05779000
NIBPROCD EQU   ISTNIB+36                                                05780000
NIBDEVCH EQU   ISTNIB+28                                                05781000
NIBMODE  EQU   ISTNIB+20                                                05782000
NIBSYM   EQU   ISTNIB+12                                                05783000
NIBUSER  EQU   ISTNIB+8                                                 05784000
NIBLEN   EQU   ISTNIB+3                                                 05785000
NIBCONDN EQU   ISTNIB+2                                                 05786000
NIBRSV01 EQU   ISTNIB+1                                                 05787000
NIBID    EQU   ISTNIB                                                   05788000
DEVRSV03 EQU   ISTDEVCH+5                                               05789000
DEVPHYSA EQU   ISTDEVCH+4                                               05790000
DEVCSLPN EQU   DEVCHAR3                                                 05791000
DEVCSTCL EQU   DEVCHAR3                                                 05792000
DEVCCHEK EQU   DEVCHAR3                                                 05793000
DEVCATTN EQU   DEVCHAR3                                                 05794000
DEVCSWL  EQU   DEVFCCTL                                                 05795000
DEVCRVB  EQU   DEVFCCTL                                                 05796000
DEVCSSL  EQU   DEVFCCTL                                                 05797000
DEVCBSC  EQU   DEVFCCTL                                                 05798000
DEVMCODE EQU   ISTDEVCH+2                                               05799000
DEVCHAR2 EQU   DEVTCODE                                                 05800000
DEVRSV01 EQU   DEVCHAR                                                  05801000
DEVCCTL  EQU   DEVCHAR                                                  05802000
DEVNNSPT EQU   DEVCHAR                                                  05803000
DEVSPS   EQU   DEVCHAR                                                  05804000
DEVSUBND EQU   DEVCHAR                                                  05805000
DEVCONVR EQU   DEVCHAR                                                  05806000
DEVOTPUT EQU   DEVCHAR                                                  05807000
DEVINPUT EQU   DEVCHAR                                                  05808000
PROSRDEF EQU   PROSETM4                                                 05809000
PRORSV47 EQU   PROSETM4                                                 05810000
PROSCON  EQU   PROSETM4                                                 05811000
PRORSV46 EQU   PROSETM3                                                 05812000
PROSMONT EQU   PROSETM3                                                 05813000
PRORSV45 EQU   PROSETM3                                                 05814000
PROSNTO  EQU   PROSETM3                                                 05815000
PRORSV44 EQU   PROSETM3                                                 05816000
PRORSV43 EQU   PROSETM2                                                 05817000
PROSNTFL EQU   PROSETM2                                                 05818000
PRORSV42 EQU   PROSETM2                                                 05819000
PRORSV41 EQU   PROPROCS                                                 05820000
PROMODC  EQU   PROPROC4                                                 05821000
PROMODT  EQU   PROPROC4                                                 05822000
PROMODM  EQU   PROPROC4                                                 05823000
PROMODB  EQU   PROPROC4                                                 05824000
PRORSV14 EQU   PROPROC4                                                 05825000
PRORSV13 EQU   PROPROC4                                                 05826000
PRORSV12 EQU   PROPROC4                                                 05827000
PROEIB   EQU   PROPROC4                                                 05828000
PROMONT3 EQU   PROPROC3                                                 05829000
PROMONT2 EQU   PROPROC3                                                 05830000
PROMONIT EQU   PROPROC3                                                 05831000
PROSUBLK EQU   PROPROC3                                                 05832000
PRONTO   EQU   PROPROC3                                                 05833000
PROLGIN  EQU   PROPROC3                                                 05834000
PROERPI  EQU   PROPROC3                                                 05835000
PRORSV07 EQU   PROPROC3                                                 05836000
PROCFTX  EQU   PROPROC2                                                 05837000
PROEMLC  EQU   PROPROC2                                                 05838000
PRONTFL  EQU   PROPROC2                                                 05839000
PRORSV05 EQU   PROPROC2                                                 05840000
PRORSV04 EQU   PROPROC2                                                 05841000
PROLGOT  EQU   PROPROC2                                                 05842000
PROERPO  EQU   PROPROC2                                                 05843000
PRORSV03 EQU   PROPROC2                                                 05844000
PRORPLC  EQU   PROPROC1                                                 05845000
PROCS    EQU   PROPROC1                                                 05846000
PROCA    EQU   PROPROC1                                                 05847000
PRORESPX EQU   PROPROC1                                                 05848000
PRODFASY EQU   PROPROC1                                                 05849000
PROXPOPT EQU   PROPROC1                                                 05850000
PROTRUNC EQU   PROPROC1                                                 05851000
PROASYIP EQU   PROPROC1                                                 05852000
MPSSRB1  EQU   ISTMPST+172                                              05853000
MPSSAVE  EQU   ISTMPST+140                                              05854000
MPSMQLBP EQU   ISTMPST+136                                              05855000
MPSSYSRT EQU   ISTMPST+132                                              05856000
MPSQEL   EQU   ISTMPST+128                                              05857000
MPSDBTBL EQU   ISTMPST+124                                              05858000
MPSASCB  EQU   ISTMPST+120                                              05859000
MPSTPPAB EQU   ISTMPST+88                                               05860000
MPSSMPAB EQU   ISTMPST+56                                               05861000
MPSSMRPH EQU   ISTMPST+52                                               05862000
MPSSRB55 EQU   ISTMPST+48                                               05863000
MPSRPLAC EQU   MPSRPLCT+2                                               05864000
MPSRPLRC EQU   MPSRPLCT                                                 05865000
MPSCRPLQ EQU   MPSCRPL                                                  05866000
MPSSRBAC EQU   MPSSRBCT+2                                               05867000
MPSSRBRC EQU   MPSSRBCT                                                 05868000
MPSSRBQ  EQU   MPSSRB                                                   05869000
MPSCRAAC EQU   MPSCRACT+2                                               05870000
MPSCRARC EQU   MPSCRACT                                                 05871000
MPSCRAQ  EQU   MPSCRA                                                   05872000
MPSMPSTP EQU   ISTMPST+20                                               05873000
MPSPSTCT EQU   ISTMPST+16                                               05874000
MPSASID  EQU   MPSFLGA+2                                                05875000
MPSRSV02 EQU   MPSFLGA+1                                                05876000
MPSPSTAB EQU   MPSFLGA                                                  05877000
MPSRSV01 EQU   MPSFLGA                                                  05878000
MPSTPBU  EQU   MPSFLGA                                                  05879000
MPMEMTRM EQU   MPSFLGA                                                  05880000
MPSAUTH  EQU   MPSFLGA                                                  05881000
MPSCRAO  EQU   MPSFLGA                                                  05882000
MPSSRBO  EQU   MPSFLGA                                                  05883000
MPSRQUEG EQU   MPSRQUE                                                  05884000
MPSID    EQU   ISTMPST                                                  05885000
DYPPAB   EQU   ISTDYPAB+16                                              05886000
DYPRSV01 EQU   ISTDYPAB+12                                              05887000
DYPTSKID EQU   ISTDYPAB+8                                               05888000
DYPCHAIN EQU   ISTDYPAB+4                                               05889000
DYPFLGS  EQU   ISTDYPAB+2                                               05890000
DYPLNGTH EQU   ISTDYPAB+1                                               05891000
DYPTYPE  EQU   ISTDYPAB                                                 05892000
PABRPHA  EQU   PABRPHFG+1                                               05893000
PABNODQ  EQU   PABFLAGS                                                 05894000
PABINHBT EQU   PABFLAGS                                                 05895000
PABERLOK EQU   PABERRLK                                                 05896000
PABSSN   EQU   PABFLAGS                                                 05897000
PABDYNAM EQU   PABFLAGS                                                 05898000
PABNORPR EQU   PABFLAGS                                                 05899000
PABPRIOR EQU   PABFLAGS                                                 05900000
PABAPYP  EQU   PABFLAGS                                                 05901000
PABDVTA  EQU   ISTPAB+9                                                 05902000
PABOFFST EQU   ISTPAB+8                                                 05903000
PABCHNGP EQU   PABCHAIN+1                                               05904000
PABRSV02 EQU   PABCHAIN                                                 05905000
PABDELAY EQU   PABCHAIN                                                 05906000
PABRUNNG EQU   PABCHAIN                                                 05907000
PABRESET EQU   PABCHAIN                                                 05908000
PABUNCON EQU   PABCHAIN                                                 05909000
PABCDP   EQU   PABCHAIN                                                 05910000
PABRESCH EQU   PABCHAIN                                                 05911000
PABCHNG  EQU   PABCHAIN                                                 05912000
PABWEQP  EQU   PABWEQA+1                                                05913000
PABRSV01 EQU   PABWEQA                                                  05914000
PABWEQG  EQU   PABWEQA                                                  05915000
TVWAEND  EQU   TVWA+216                                                 05916000
@NM00125 EQU   TVWA+208                                                 05917000
TVWAUSRA EQU   TVWA+200                                                 05918000
@NM00124 EQU   TVWA+192                                                 05919000
TVWAFRWI EQU   TVWA+184                                                 05920000
TVWARSHW EQU   TVWA+183                                                 05921000
@NM00123 EQU   TVWAFLG6                                                 05922000
TVWAFMEW EQU   TVWAFLG6                                                 05923000
TVWARCDT EQU   TVWAFLG6                                                 05924000
TVWAIOTR EQU   TVWAFLG6                                                 05925000
@NM00122 EQU   TVWA+180                                                 05926000
TVWAQMLB EQU   TVWA+176                                                 05927000
TVWAATBI EQU   TVWA+168                                                 05928000
TVWATRNM EQU   TVWA+160                                                 05929000
TVWATABI EQU   TVWA+152                                                 05930000
TVWALNCT EQU   TVWA+151                                                 05931000
TVWAP1ST EQU   TVWAFLG5                                                 05932000
TVWAPRMT EQU   TVWAFLG5                                                 05933000
TVWANFSP EQU   TVWAFLG5                                                 05934000
TVWAFSW  EQU   TVWAFLG5                                                 05935000
TVWAWO   EQU   TVWAFLG5                                                 05936000
TVWAFSM  EQU   TVWAFLG5                                                 05937000
TVWASCAN EQU   TVWAFLG5                                                 05938000
@NM00121 EQU   TVWA+148                                                 05939000
TVWADARC EQU   TVWAFLG4                                                 05940000
TVWAQMEV EQU   TVWAFLG4                                                 05941000
TVWAFLSC EQU   TVWAFLG4                                                 05942000
TVWANOFB EQU   TVWAFLG4                                                 05943000
TVWAKBDL EQU   TVWAFLG4                                                 05944000
TVWAFMSC EQU   TVWAFLG4                                                 05945000
TVWATRDF EQU   TVWAFLG3                                                 05946000
TVWAQLBU EQU   TVWAFLG3                                                 05947000
TVWAQMIO EQU   TVWAFLG3                                                 05948000
TVWAQMRT EQU   TVWAFLG3                                                 05949000
TVWASDSG EQU   TVWAFLG3                                                 05950000
TVWAPGN  EQU   TVWAFLG2                                                 05951000
TVWAULK  EQU   TVWAFLG1                                                 05952000
TVWAXSCD EQU   TVWAFLG1                                                 05953000
TVWATOD  EQU   TVWAFLG1                                                 05954000
TVWADIN3 EQU   TVWADLST+8                                               05955000
TVWADIN2 EQU   TVWADLST+4                                               05956000
TVWADIN1 EQU   TVWADLST                                                 05957000
TVWAECB3 EQU   TVWAECBL+8                                               05958000
TVWAECB2 EQU   TVWAECBL+4                                               05959000
TVWAECB1 EQU   TVWAECBL                                                 05960000
TVWATECB EQU   TVWA+116                                                 05961000
TVWAECB  EQU   TVWA+112                                                 05962000
TVWALNSV EQU   TVWA+111                                                 05963000
@NM00120 EQU   TVWAFLG7                                                 05964000
TVWACHSE EQU   TVWAFLG7                                                 05965000
TVWARISW EQU   TVWAFLG7                                                 05966000
TVWARET  EQU   TVWAFLG7                                                 05967000
TVWARDBF EQU   TVWAFLG7                                                 05968000
TVWASND1 EQU   TVWAFLG7                                                 05969000
TVWABKPG EQU   TVWAFLG7                                                 05970000
TVWAVSZ  EQU   TVWA+108                                                 05971000
TVWAVST  EQU   TVWA+104                                                 05972000
TVWAEXL  EQU   TVWA+100                                                 05973000
TVWARPL  EQU   TVWA+96                                                  05974000
TVWATQL2 EQU   TVWA+87                                                  05975000
TVWALBUF EQU   TVWA+80                                                  05976000
TVWAHBUF EQU   TVWA+76                                                  05977000
TVWACLSZ EQU   TVWA+74                                                  05978000
TVWARTR  EQU   TVWA+72                                                  05979000
TVWAGMPT EQU   TVWA+68                                                  05980000
TVWATCB  EQU   TVWA+64                                                  05981000
TVWAUSMN EQU   TVWA+60                                                  05982000
TVWACPID EQU   TVWA+56                                                  05983000
TVWAEOQ  EQU   TVWA+52                                                  05984000
TVWANOM  EQU   TVWA+48                                                  05985000
TVWABOQ  EQU   TVWA+44                                                  05986000
TVWAEIQ  EQU   TVWA+40                                                  05987000
TVWANIM  EQU   TVWA+36                                                  05988000
TVWABIQ  EQU   TVWA+32                                                  05989000
TVWAQMWA EQU   TVWA+28                                                  05990000
TVWALLWA EQU   TVWA+24                                                  05991000
TVWABFPT EQU   TVWA+20                                                  05992000
TVWATIMW EQU   TVWA+8                                                   05993000
TVWAPPL  EQU   TVWA                                                     05994000
TCASTEND EQU   TCAST+136                                                05995000
TCASDUMP EQU   TCAST+132                                                05996000
TCASSCHD EQU   TCAST+128                                                05997000
TCASTPND EQU   TCAST+124                                                05998000
TCASOMJR EQU   TCAST+120                                                05999000
@NM00119 EQU   TCAST+118                                                06000000
TCASBR14 EQU   TCAST+116                                                06001000
TCASATTN EQU   TCAST+112                                                06002000
TCASASCI EQU   TCAST+108                                                06003000
TCASTTQH EQU   TCAST+104                                                06004000
@NM00118 EQU   TCAST+102                                                06005000
@NM00117 EQU   TCAST+100                                                06006000
@NM00116 EQU   TCAST+98                                                 06007000
@NM00115 EQU   TCAST+96                                                 06008000
TCASASCB EQU   TCAST+92                                                 06009000
@NM00114 EQU   TCAST+90                                                 06010000
@NM00113 EQU   TCASFLG2                                                 06011000
@NM00112 EQU   TCASFLG1                                                 06012000
TCASNACT EQU   TCASFLG1                                                 06013000
TCASVSD  EQU   TCASFLG1                                                 06014000
TCASABND EQU   TCASFLG1                                                 06015000
TCASMDSW EQU   TCASFLG1                                                 06016000
TCASBKMD EQU   TCASFLG1                                                 06017000
TCASLTE  EQU   TCAST+84                                                 06018000
TCASIQM  EQU   TCAST+72                                                 06019000
TCASTSB  EQU   TCAST+68                                                 06020000
TCASTTL  EQU   TCAST+64                                                 06021000
TCASWA   EQU   TCAST+60                                                 06022000
TCASDATO EQU   TCAST+48                                                 06023000
TCASDATI EQU   TCAST+44                                                 06024000
TCASXECB EQU   TCAST+40                                                 06025000
TCASTID  EQU   TCAST+32                                                 06026000
@NM00111 EQU   TCAST+31                                                 06027000
TCASCHNL EQU   TCAST+30                                                 06028000
TCASCRSZ EQU   TCAST+28                                                 06029000
TCASLBUF EQU   TCAST+24                                                 06030000
TCASHBUF EQU   TCAST+20                                                 06031000
TCASCLSZ EQU   TCAST+18                                                 06032000
TCASRCON EQU   TCAST+16                                                 06033000
TCASACBP EQU   TCAST+8                                                  06034000
TCASUMAX EQU   TCASUSER+2                                               06035000
TCASUSEC EQU   TCASUSER                                                 06036000
TCASID   EQU   TCAST                                                    06037000
@NM00110 EQU   LTCBFLAG                                                 06038000
LTCBRCUR EQU   LTCBFLAG                                                 06039000
@NM00109 EQU   IKTLTCB                                                  06040000
@NM00108 EQU   FRWAFLGS+1                                               06041000
@NM00107 EQU   FRWAFL1                                                  06042000
FRWAPCRE EQU   FRWAFL1                                                  06043000
@NM00106 EQU   IKTFRPRM+21                                              06044000
@NM00105 EQU   FRPFRFLG                                                 06045000
FRPIMNGR EQU   FRPFRFLG                                                 06046000
TSBXEND  EQU   TSBX+120                                                 06047000
@NM00104 EQU   TSBX+116                                                 06048000
TSBXBIND EQU   TSBX+80                                                  06049000
TSBXRPL  EQU   TSBX+76                                                  06050000
TSBXTMBF EQU   TSBXTERM+2                                               06051000
@NM00103 EQU   TSBXTERM+1                                               06052000
TSBXTMTP EQU   TSBXTERM                                                 06053000
TSBXAIND EQU   TSBX+70                                                  06054000
TSBXRSZO EQU   TSBX+69                                                  06055000
TSBXRSZI EQU   TSBX+68                                                  06056000
TSBXLBUF EQU   TSBX+64                                                  06057000
TSBXCSAP EQU   TSBX+60                                                  06058000
TSBXSRB  EQU   TSBX+56                                                  06059000
TSBXSRBI EQU   TSBX+52                                                  06060000
@NM00102 EQU   TSBX+48                                                  06061000
TSBXTOM  EQU   TSBX+44                                                  06062000
TSBXTIM  EQU   TSBX+40                                                  06063000
@NM00101 EQU   TSBX+33                                                  06064000
@NM00100 EQU   TSBXFLG1                                                 06065000
TSBXWREC EQU   TSBXFLG1                                                 06066000
TSBXLOGF EQU   TSBXFLG1                                                 06067000
TSBXACTV EQU   TSBXFLG1                                                 06068000
TSBXUID  EQU   TSBX+24                                                  06069000
@NM00099 EQU   TSBX+16                                                  06070000
@NM00098 EQU   TSBX+12                                                  06071000
TSBXECB  EQU   TSBX+8                                                   06072000
TSBXBCK  EQU   TSBX+4                                                   06073000
TSBXFWD  EQU   TSBX                                                     06074000
TSBEND   EQU   TSB+120                                                  06075000
TSBSF1   EQU   TSB+112                                                  06076000
TSBTRMID EQU   TSB+104                                                  06077000
TSBALTC  EQU   TSB+103                                                  06078000
TSBALTR  EQU   TSB+102                                                  06079000
TSBPRMC  EQU   TSB+101                                                  06080000
TSBPRMR  EQU   TSB+100                                                  06081000
TSBPSWD  EQU   TSB+88                                                   06082000
TSBLECB  EQU   TSBMINL                                                  06083000
TSBLINE  EQU   TSB+82                                                   06084000
TSBSTAX  EQU   TSB+81                                                   06085000
TSBATTNC EQU   TSB+80                                                   06086000
TSBF1V   EQU   TSBTPOST+7                                               06087000
TSBF1M   EQU   TSBTPOST+6                                               06088000
TSBF2V   EQU   TSBTPOST+5                                               06089000
TSBF2M   EQU   TSBTPOST+4                                               06090000
TSBFLAGV EQU   TSBTPOST+3                                               06091000
TSBFLAGM EQU   TSBTPOST+2                                               06092000
TSBSBASV EQU   TSBTPOST+1                                               06093000
@NM00097 EQU   TSBTPFLG                                                 06094000
@NM00096 EQU   TSBTPFLG                                                 06095000
@NM00095 EQU   TSBTPFLG                                                 06096000
@NM00094 EQU   TSBTPFLG                                                 06097000
TSBNEWID EQU   TSBTPFLG                                                 06098000
TSBTPAYI EQU   TSBTPFLG                                                 06099000
TSBTPQCB EQU   TSBTPFLG                                                 06100000
TSBPOSTO EQU   TSBTPFLG                                                 06101000
TSBLINKB EQU   TSBLINKA+1                                               06102000
TSBPRI   EQU   TSBLINKA                                                 06103000
TSBRQCB  EQU   TSBRCB                                                   06104000
TSBCTCB  EQU   TSB+60                                                   06105000
TSBERSDS EQU   TSB+56                                                   06106000
TSBAUTOI EQU   TSB+52                                                   06107000
TSBATNCC EQU   TSB+44                                                   06108000
TSBASRCE EQU   TSB+42                                                   06109000
TSBHLDL  EQU   TSBFLG4                                                  06110000
TSBGETBF EQU   TSBFLG4                                                  06111000
TSBCANC  EQU   TSBFLG4                                                  06112000
TSBHOLD  EQU   TSBFLG4                                                  06113000
TSBHUNG  EQU   TSBFLG4                                                  06114000
TSBOCAB  EQU   TSBFLG4                                                  06115000
TSBLNNO  EQU   TSB+40                                                   06116000
TSBATNTC EQU   TSB+38                                                   06117000
TSBATNLC EQU   TSB+36                                                   06118000
TSBCHDCC EQU   TSBSTCC+1                                                06119000
TSBLNDCC EQU   TSBSTCC                                                  06120000
TSBWTJID EQU   TSB+32                                                   06121000
TSBECB   EQU   TSB+28                                                   06122000
TSBC1050 EQU   TSBTERM2                                                 06123000
@NM00093 EQU   TSBTERM2                                                 06124000
@NM00092 EQU   TSBTERM2                                                 06125000
@NM00091 EQU   TSBTERM2                                                 06126000
@NM00090 EQU   TSBTERM2                                                 06127000
TSBCTWX  EQU   TSBTERM2                                                 06128000
@NM00089 EQU   TSBTERM2                                                 06129000
@NM00088 EQU   TSBTERM2                                                 06130000
@NM00087 EQU   TSBTERM1                                                 06131000
@NM00086 EQU   TSBTERM1                                                 06132000
@NM00085 EQU   TSBTERM1                                                 06133000
TSBC2741 EQU   TSBTERM1                                                 06134000
TSBC5041 EQU   TSBTERM1                                                 06135000
TSBCATTN EQU   TSBTERM1                                                 06136000
TSBCBRK  EQU   TSBTERM1                                                 06137000
TSBCIHBN EQU   TSBTERM1                                                 06138000
TSBVTAM  EQU   TSBFLG5                                                  06139000
TSBKEYS  EQU   TSBFLG5                                                  06140000
@NM00084 EQU   TSBFLG5                                                  06141000
TSBATMP  EQU   TSBFLG5                                                  06142000
TSBNFLOP EQU   TSBFLG3                                                  06143000
TSBNOBRK EQU   TSBFLG3                                                  06144000
TSBTPUT  EQU   TSBFLG3                                                  06145000
TSBAWOIP EQU   TSBFLG3                                                  06146000
TSBNBKSP EQU   TSBFLG3                                                  06147000
TSBTJMSG EQU   TSBFLG3                                                  06148000
TSBATTN  EQU   TSBFLG3                                                  06149000
TSBIBFP  EQU   TSB+21                                                   06150000
TSBNIBF  EQU   TSB+20                                                   06151000
TSBITBFP EQU   TSB+17                                                   06152000
TSBSATN2 EQU   TSBFLG2                                                  06153000
TSBSATN1 EQU   TSBFLG2                                                  06154000
TSBAUTOC EQU   TSBFLG2                                                  06155000
TSBBRKIN EQU   TSBFLG2                                                  06156000
TSBBIPI  EQU   TSBFLG2                                                  06157000
TSBOBFP  EQU   TSB+13                                                   06158000
TSBNOBF  EQU   TSB+12                                                   06159000
TSBOTBFP EQU   TSB+9                                                    06160000
TSBWTCB  EQU   TSB+5                                                    06161000
TSBTJBF  EQU   TSBFLG1                                                  06162000
TSBTJIP  EQU   TSBFLG1                                                  06163000
TSBTJOW  EQU   TSBFLG1                                                  06164000
TSBWOWIP EQU   TSBFLG1                                                  06165000
TSBOWIP  EQU   TSBFLG1                                                  06166000
TSBOFLSH EQU   TSBFLG1                                                  06167000
TSBANSR  EQU   TSBFLG1                                                  06168000
TSBASCB  EQU   TSBASCBA+1                                               06169000
TSBATNLD EQU   TSBSTAT                                                  06170000
TSB3270  EQU   TSBSTAT                                                  06171000
TSBDISC  EQU   TSBSTAT                                                  06172000
TSBITOFF EQU   TSBSTAT                                                  06173000
TSBNOBUF EQU   TSBSTAT                                                  06174000
TSBDSPLY EQU   TSBSTAT                                                  06175000
TSBLWAIT EQU   TSBSTAT                                                  06176000
TSBINUSE EQU   TSBSTAT                                                  06177000
WSAGSCHE EQU   WSAG+40                                                  06178000
WSAGREST EQU   WSAG+36                                                  06179000
WSAGNQDQ EQU   WSAG+32                                                  06180000
WSAGMEMT EQU   WSAG+28                                                  06181000
WSAGOPTM EQU   WSAG+24                                                  06182000
WSAGSTAT EQU   WSAG+20                                                  06183000
WSAGEMS0 EQU   WSAG+16                                                  06184000
WSAGSSRS EQU   WSAG+12                                                  06185000
WSAGRSM  EQU   WSAG+8                                                   06186000
WSAGGMFM EQU   WSAG+4                                                   06187000
WSAGPGIO EQU   WSAG                                                     06188000
@NM00083 EQU   SRBSECT+40                                               06189000
@NM00082 EQU   SRBSECT+38                                               06190000
SRBPRIOR EQU   SRBSECT+37                                               06191000
SRBPKF   EQU   SRBSECT+36                                               06192000
SRBSAVE  EQU   SRBSECT+32                                               06193000
SRBPARM  EQU   SRBSECT+28                                               06194000
SRBRMTR  EQU   SRBSECT+24                                               06195000
SRBEP    EQU   SRBSECT+20                                               06196000
SRBPTCB  EQU   SRBFLC+4                                                 06197000
SRBPASID EQU   SRBFLC+2                                                 06198000
SRBCPAFF EQU   SRBFLC                                                   06199000
SRBASCB  EQU   SRBSECT+8                                                06200000
SRBFLNK  EQU   SRBSECT+4                                                06201000
SRBID    EQU   SRBSECT                                                  06202000
@NM00081 EQU   SCVTSECT+180                                             06203000
@NM00080 EQU   SCVTSECT+176                                             06204000
SCVTPIQE EQU   SCVTSECT+172                                             06205000
@NM00079 EQU   SCVTSECT+168                                             06206000
SCVTPTRM EQU   SCVTSECT+164                                             06207000
@NM00078 EQU   SCVTSECT+160                                             06208000
@NM00077 EQU   SCVTSECT+156                                             06209000
SCVTQCBR EQU   SCVTSECT+152                                             06210000
@NM00076 EQU   SCVTSECT+144                                             06211000
SCVTTQE  EQU   SCVTSECT+140                                             06212000
@NM00075 EQU   SCVTSECT+136                                             06213000
SCVTSVCT EQU   SCVTSECT+132                                             06214000
@NM00074 EQU   SCVTSECT+128                                             06215000
@NM00073 EQU   SCVTSECT+124                                             06216000
SCVTRXLQ EQU   SCVTSECT+120                                             06217000
@NM00072 EQU   SCVTSECT+116                                             06218000
SCVTCTCB EQU   SCVTSECT+112                                             06219000
@NM00071 EQU   SCVTSECT+108                                             06220000
@NM00070 EQU   SCVTSECT+104                                             06221000
@NM00069 EQU   SCVTSECT+100                                             06222000
@NM00068 EQU   SCVTSECT+96                                              06223000
SCVTCOMM EQU   SCVTSECT+92                                              06224000
@NM00067 EQU   SCVTSECT+88                                              06225000
@NM00066 EQU   SCVTSECT+84                                              06226000
@NM00065 EQU   SCVTSECT+80                                              06227000
@NM00064 EQU   SCVTSECT+76                                              06228000
@NM00063 EQU   SCVTSECT+72                                              06229000
SCVTGMBR EQU   SCVTSECT+68                                              06230000
SCVTRPTR EQU   SCVTSECT+64                                              06231000
SCVTHSKP EQU   SCVTSECT+60                                              06232000
@NM00062 EQU   SCVTSECT+56                                              06233000
@NM00061 EQU   SCVTSECT+52                                              06234000
SCVTLFRM EQU   SCVTSECT+48                                              06235000
SCVTCDCL EQU   SCVTSECT+44                                              06236000
@NM00060 EQU   SCVTSECT+40                                              06237000
SCVTRACE EQU   SCVTSECT+36                                              06238000
@NM00059 EQU   SCVTSECT+32                                              06239000
SCVTRMBR EQU   SCVTSECT+28                                              06240000
@NM00058 EQU   SCVTSECT+24                                              06241000
@NM00057 EQU   SCVTSECT+20                                              06242000
@NM00056 EQU   SCVTSECT+16                                              06243000
@NM00055 EQU   SCVTSECT+14                                              06244000
SCVTBR14 EQU   SCVTSECT+12                                              06245000
SCVTSPET EQU   SCVTSECT+8                                               06246000
SCVTPGWR EQU   SCVTSECT+4                                               06247000
SCVTPGTM EQU   SCVTSECT                                                 06248000
@NM00054 EQU   FRRSFLGS+1                                               06249000
@NM00053 EQU   FRRSFLG1                                                 06250000
FRRSRCUR EQU   FRRSFLG1                                                 06251000
FRRSENTS EQU   FRRS+84                                                  06252000
FRRSRTMW EQU   FRRS+16                                                  06253000
ASXBEND  EQU   ASXB+232                                                 06254000
ASXBRV25 EQU   ASXB+228                                                 06255000
ASXBRV24 EQU   ASXB+224                                                 06256000
ASXBPT0E EQU   ASXB+220                                                 06257000
ASXBCRB4 EQU   ASXBCASW+3                                               06258000
ASXBCRB3 EQU   ASXBCASW+2                                               06259000
ASXBCRB2 EQU   ASXBCASW+1                                               06260000
ASXBCR06 EQU   ASXBCRB1                                                 06261000
ASXBCR05 EQU   ASXBCRB1                                                 06262000
ASXBCR04 EQU   ASXBCRB1                                                 06263000
ASXBCR03 EQU   ASXBCRB1                                                 06264000
ASXBCR02 EQU   ASXBCRB1                                                 06265000
ASXBCR01 EQU   ASXBCRB1                                                 06266000
ASXBTFD  EQU   ASXBCRB1                                                 06267000
ASXBPIP  EQU   ASXBCRB1                                                 06268000
ASXBCTDC EQU   ASXB+212                                                 06269000
ASXBTDCB EQU   ASXB+208                                                 06270000
ASXBRV19 EQU   ASXB+204                                                 06271000
ASXBRV18 EQU   ASXB+200                                                 06272000
ASXBRV17 EQU   ASXB+196                                                 06273000
ASXBRV16 EQU   ASXB+192                                                 06274000
ASXBLSRB EQU   ASXBAEQ+20                                               06275000
ASXBFSRB EQU   ASXBAEQ+16                                               06276000
ASXBLRQE EQU   ASXBAEQ+12                                               06277000
ASXBFRQE EQU   ASXBAEQ+8                                                06278000
ASXBLIQE EQU   ASXBAEQ+4                                                06279000
ASXBFIQE EQU   ASXBAEQ                                                  06280000
ASXBETSK EQU   ASXB+164                                                 06281000
ASXBSIRB EQU   ASXB+160                                                 06282000
ASXBPSWD EQU   ASXB+152                                                 06283000
ASXBPRG  EQU   ASXB+136                                                 06284000
ASXBRV26 EQU   ASXB+132                                                 06285000
ASXBOUSB EQU   ASXB+128                                                 06286000
ASXBDDR  EQU   ASXB+124                                                 06287000
ASXBRCTD EQU   ASXB+120                                                 06288000
ASXBRSMD EQU   ASXB+116                                                 06289000
ASXBSPSA EQU   ASXB+112                                                 06290000
ASXBFRWA EQU   ASXB+108                                                 06291000
ASXBFLSA EQU   ASXB+36                                                  06292000
ASXBIHSA EQU   ASXB+32                                                  06293000
ASXBRV15 EQU   ASXB+28                                                  06294000
ASXBRV14 EQU   ASXB+24                                                  06295000
ASXBLWA  EQU   ASXB+20                                                  06296000
ASXBRS00 EQU   ASXB+14                                                  06297000
ASXBTCBS EQU   ASXB+12                                                  06298000
ASXBLTCB EQU   ASXB+8                                                   06299000
ASXBFTCB EQU   ASXB+4                                                   06300000
ASXBASXB EQU   ASXB                                                     06301000
ASXBEGIN EQU   ASXB                                                     06302000
ASCBEND  EQU   ASCB+208                                                 06303000
ASCBSRBT EQU   ASCB+200                                                 06304000
ASCBSWTL EQU   ASCB+196                                                 06305000
ASCBRS14 EQU   ASCB+195                                                 06306000
ASCBSMCT EQU   ASCB+194                                                 06307000
ASCBRS12 EQU   ASCB+192                                                 06308000
ASCBPCTT EQU   ASCB+188                                                 06309000
ASCBVGTT EQU   ASCB+184                                                 06310000
ASCBRV43 EQU   ASCBSRQ4                                                 06311000
ASCBRV42 EQU   ASCBSRQ4                                                 06312000
ASCBRV41 EQU   ASCBSRQ4                                                 06313000
ASCBRV40 EQU   ASCBSRQ4                                                 06314000
ASCBRV39 EQU   ASCBSRQ4                                                 06315000
ASCBRV38 EQU   ASCBSRQ4                                                 06316000
ASCBRV37 EQU   ASCBSRQ4                                                 06317000
ASCBRV36 EQU   ASCBSRQ4                                                 06318000
ASCBRV35 EQU   ASCBSRQ3                                                 06319000
ASCBRV34 EQU   ASCBSRQ3                                                 06320000
ASCBRV33 EQU   ASCBSRQ3                                                 06321000
ASCBRV32 EQU   ASCBSRQ3                                                 06322000
ASCBRV31 EQU   ASCBSRQ3                                                 06323000
ASCBRV30 EQU   ASCBSRQ3                                                 06324000
ASCBRV29 EQU   ASCBSRQ3                                                 06325000
ASCBRV28 EQU   ASCBSRQ3                                                 06326000
ASCBRV27 EQU   ASCBSRQ2                                                 06327000
ASCBRV26 EQU   ASCBSRQ2                                                 06328000
ASCBRV25 EQU   ASCBSRQ2                                                 06329000
ASCBRV24 EQU   ASCBSRQ2                                                 06330000
ASCBRV23 EQU   ASCBSRQ2                                                 06331000
ASCBRV22 EQU   ASCBSRQ2                                                 06332000
ASCBRV21 EQU   ASCBSRQ2                                                 06333000
ASCBRV20 EQU   ASCBSRQ2                                                 06334000
ASCBRV19 EQU   ASCBSRQ1                                                 06335000
ASCBRV18 EQU   ASCBSRQ1                                                 06336000
ASCBRV17 EQU   ASCBSRQ1                                                 06337000
ASCBRV16 EQU   ASCBSRQ1                                                 06338000
ASCBRV15 EQU   ASCBSRQ1                                                 06339000
ASCBRV14 EQU   ASCBSRQ1                                                 06340000
ASCBRV13 EQU   ASCBSRQ1                                                 06341000
ASCBSTA  EQU   ASCBSRQ1                                                 06342000
ASCBJBNS EQU   ASCB+176                                                 06343000
ASCBJBNI EQU   ASCB+172                                                 06344000
ASCBMCC  EQU   ASCB+168                                                 06345000
ASCBRTWA EQU   ASCB+164                                                 06346000
ASCBIQEA EQU   ASCB+160                                                 06347000
ASCBXMPQ EQU   ASCB+156                                                 06348000
ASCBRS01 EQU   ASCB+154                                                 06349000
ASCBFMCT EQU   ASCB+152                                                 06350000
ASCBOUXB EQU   ASCB+148                                                 06351000
ASCBOUCB EQU   ASCB+144                                                 06352000
ASCBMECB EQU   ASCB+140                                                 06353000
ASCBQECB EQU   ASCB+136                                                 06354000
ASCBLSQH EQU   ASCBLKGP+4                                               06355000
ASCBLOCK EQU   ASCBLKGP                                                 06356000
ASCBTCBS EQU   ASCB+124                                                 06357000
ASCBNVSC EQU   ASCB+122                                                 06358000
ASCBVSC  EQU   ASCB+120                                                 06359000
ASCBSRBS EQU   ASCB+118                                                 06360000
ASCBSSRB EQU   ASCB+116                                                 06361000
ASCBRV06 EQU   ASCBFLG2                                                 06362000
ASCBRV05 EQU   ASCBFLG2                                                 06363000
ASCBRV04 EQU   ASCBFLG2                                                 06364000
ASCBSNQS EQU   ASCBFLG2                                                 06365000
ASCBS2S  EQU   ASCBFLG2                                                 06366000
ASCBCEXT EQU   ASCBFLG2                                                 06367000
ASCBPXMT EQU   ASCBFLG2                                                 06368000
ASCBXMPT EQU   ASCBFLG2                                                 06369000
ASCBRF07 EQU   ASCBDSP1                                                 06370000
ASCBRF06 EQU   ASCBDSP1                                                 06371000
ASCBRF05 EQU   ASCBDSP1                                                 06372000
ASCBRF04 EQU   ASCBDSP1                                                 06373000
ASCBRF03 EQU   ASCBDSP1                                                 06374000
ASCBRF02 EQU   ASCBDSP1                                                 06375000
ASCBFAIL EQU   ASCBDSP1                                                 06376000
ASCBNOQ  EQU   ASCBDSP1                                                 06377000
ASCBSWCT EQU   ASCB+112                                                 06378000
ASCBTMCH EQU   ASCB+104                                                 06379000
ASCBNSWP EQU   ASCBFLG1                                                 06380000
ASCBTYP1 EQU   ASCBFLG1                                                 06381000
ASCBSTND EQU   ASCBFLG1                                                 06382000
ASCBABNT EQU   ASCBFLG1                                                 06383000
ASCBTERM EQU   ASCBFLG1                                                 06384000
ASCBS3S  EQU   ASCBFLG1                                                 06385000
ASCBCMSH EQU   ASCBFLG1                                                 06386000
ASCBTOFF EQU   ASCBFLG1                                                 06387000
ASCBRF01 EQU   ASCBRCTF                                                 06388000
ASCBTMLW EQU   ASCBRCTF                                                 06389000
ASCBOUT  EQU   ASCBRCTF                                                 06390000
ASCBWAIT EQU   ASCBRCTF                                                 06391000
ASCBRV08 EQU   ASCBRCTF                                                 06392000
ASCBFQU  EQU   ASCBRCTF                                                 06393000
ASCBFRS  EQU   ASCBRCTF                                                 06394000
ASCBTMNO EQU   ASCBRCTF                                                 06395000
ASCBAFFN EQU   ASCBFW1                                                  06396000
ASCBDUMP EQU   ASCB+96                                                  06397000
ASCBQSVC EQU   ASCB+92                                                  06398000
ASCBUBET EQU   ASCB+88                                                  06399000
ASCBECB  EQU   ASCB+84                                                  06400000
ASCBJSTL EQU   ASCB+80                                                  06401000
ASCBEWST EQU   ASCB+72                                                  06402000
ASCBEJST EQU   ASCB+64                                                  06403000
ASCBCSCB EQU   ASCB+56                                                  06404000
ASCBRSM  EQU   ASCB+52                                                  06405000
ASCBLDA  EQU   ASCB+48                                                  06406000
ASCBSTOR EQU   ASCB+44                                                  06407000
ASCBDP   EQU   ASCB+43                                                  06408000
ASCBRV07 EQU   ASCB+42                                                  06409000
ASCBIOSM EQU   ASCB+40                                                  06410000
ASCBSEQN EQU   ASCB+38                                                  06411000
ASCBCPUS EQU   ASCB+32                                                  06412000
ASCBSPL  EQU   ASCB+28                                                  06413000
ASCBIOSP EQU   ASCB+24                                                  06414000
ASCBSYNC EQU   ASCBSUPC+4                                               06415000
ASCBSVRB EQU   ASCBSUPC                                                 06416000
ASCBCMSF EQU   ASCB+12                                                  06417000
ASCBBWDP EQU   ASCB+8                                                   06418000
ASCBFWDP EQU   ASCB+4                                                   06419000
ASCBASCB EQU   ASCB                                                     06420000
ASCBEGIN EQU   ASCB                                                     06421000
RPLSEQNO EQU   RPLOF60+6                                                06422000
@NM00028 EQU   RPLIBSQ                                                  06423000
RPLIINV  EQU   RPLIBSQ                                                  06424000
RPLINEG  EQU   RPLIBSQ                                                  06425000
RPLIPOS  EQU   RPLIBSQ                                                  06426000
RPLIIGN  EQU   RPLIBSQ                                                  06427000
RPLIRSET EQU   RPLIBSQ                                                  06428000
RPLITST  EQU   RPLIBSQ                                                  06429000
RPLISET  EQU   RPLIBSQ                                                  06430000
@NM00027 EQU   RPLOBSQ                                                  06431000
RPLOINV  EQU   RPLOBSQ                                                  06432000
RPLONEG  EQU   RPLOBSQ                                                  06433000
RPLOPOS  EQU   RPLOBSQ                                                  06434000
RPLOIGN  EQU   RPLOBSQ                                                  06435000
RPLORSET EQU   RPLOBSQ                                                  06436000
RPLOTST  EQU   RPLOBSQ                                                  06437000
RPLOSET  EQU   RPLOBSQ                                                  06438000
RPLIBSQV EQU   RPLOF60+2                                                06439000
RPLOBSQV EQU   RPLOF60                                                  06440000
@NM00026 EQU   RPLCNTSC                                                 06441000
RPLRSHUT EQU   RPLCNTSC                                                 06442000
RPLRQR   EQU   RPLCNTSC                                                 06443000
RPLSHUTC EQU   RPLCNTSC                                                 06444000
RPLSHUTD EQU   RPLCNTSC                                                 06445000
RPLSTSN  EQU   RPLCNTSC                                                 06446000
RPLCLEAR EQU   RPLCNTSC                                                 06447000
RPLSDT   EQU   RPLCNTSC                                                 06448000
@NM00025 EQU   RPLCNTDC                                                 06449000
RPLSIGNL EQU   RPLCNTDC                                                 06450000
RPLLUS   EQU   RPLCNTDC                                                 06451000
RPLRTR   EQU   RPLCNTDC                                                 06452000
RPLBID   EQU   RPLCNTDC                                                 06453000
@NM00024 EQU   RPLCNTDF                                                 06454000
RPLQI    EQU   RPLCNTDF                                                 06455000
RPLRELQ  EQU   RPLCNTDF                                                 06456000
RPLCHASE EQU   RPLCNTDF                                                 06457000
RPLQEC   EQU   RPLCNTDF                                                 06458000
RPLQC    EQU   RPLCNTDF                                                 06459000
RPLCNCEL EQU   RPLCNTDF                                                 06460000
RPLDATA  EQU   RPLCNTDF                                                 06461000
RPLRRN   EQU   RPLRESP                                                  06462000
RPLNFME  EQU   RPLRESP                                                  06463000
RPLEX    EQU   RPLRESP                                                  06464000
@NM00023 EQU   RPLRESP                                                  06465000
@NM00022 EQU   RPLPOSTV                                                 06466000
RPLSCHED EQU   RPLPOSTV                                                 06467000
@NM00021 EQU   RPLVTFL1                                                 06468000
RPLAUTUS EQU   RPLVTFL1                                                 06469000
RPLVTUSE EQU   RPLVTFL1                                                 06470000
@NM00020 EQU   RPLVTFL1                                                 06471000
@NM00019 EQU   RPLCHN                                                   06472000
RPLONLY  EQU   RPLCHN                                                   06473000
RPLLAST  EQU   RPLCHN                                                   06474000
RPLMIDLE EQU   RPLCHN                                                   06475000
RPLFIRST EQU   RPLCHN                                                   06476000
@NM00018 EQU   RPLRTYPE                                                 06477000
@NM00017 EQU   RPLSTYPE                                                 06478000
RPLSRESP EQU   RPLSTYPE                                                 06479000
@NM00016 EQU   RPLRH3                                                   06480000
RPLCHREQ EQU   RPLRH3                                                   06481000
RPLCMD   EQU   RPLRH3                                                   06482000
RPLEB    EQU   RPLRH3                                                   06483000
RPLBB    EQU   RPLRH3                                                   06484000
RPLSIGDA EQU   RPLVTEXT+32                                              06485000
RPLSAV13 EQU   RPLVTEXT+28                                              06486000
RPLUSNSO EQU   RPLOSENS+2                                               06487000
RPLSSMO  EQU   RPLSSNSO+1                                               06488000
@NM00015 EQU   RPLSSEO                                                  06489000
RPLRRO   EQU   RPLSSEO                                                  06490000
RPLFIO   EQU   RPLSSEO                                                  06491000
RPLSTATO EQU   RPLSSEO                                                  06492000
RPLCPMO  EQU   RPLSSEO                                                  06493000
@NM00014 EQU   RPLSSEO                                                  06494000
@NM00013 EQU   RPLOPT12                                                 06495000
@NM00012 EQU   RPLOPT12                                                 06496000
@NM00011 EQU   RPLOPT12                                                 06497000
RPLNIBTK EQU   RPLOPT12                                                 06498000
RPLTRUNC EQU   RPLOPT12                                                 06499000
RPLKEEP  EQU   RPLOPT12                                                 06500000
@NM00010 EQU   RPLOPT12                                                 06501000
RPLRSVE8 EQU   RPLOPT11                                                 06502000
RPLRSVE7 EQU   RPLOPT11                                                 06503000
RPLRSVE6 EQU   RPLOPT11                                                 06504000
RPLRSVE5 EQU   RPLOPT11                                                 06505000
RPLRSVE4 EQU   RPLOPT11                                                 06506000
RPLSTOP  EQU   RPLOPT11                                                 06507000
RPLSTART EQU   RPLOPT11                                                 06508000
RPLQUIES EQU   RPLOPT11                                                 06509000
RPLRSVI6 EQU   RPLOPT10                                                 06510000
RPLRSVI5 EQU   RPLOPT10                                                 06511000
RPLRSVI4 EQU   RPLOPT10                                                 06512000
RPLRSVI3 EQU   RPLOPT10                                                 06513000
RPLRSVI2 EQU   RPLOPT10                                                 06514000
RPLSPARM EQU   RPLOPT10                                                 06515000
RPLDSPLY EQU   RPLOPT10                                                 06516000
RPLBSCID EQU   RPLOPT10                                                 06517000
RPLTOPL  EQU   RPLOPT9                                                  06518000
RPLCIDE  EQU   RPLOPT9                                                  06519000
RPLRNNM  EQU   RPLOPT9                                                  06520000
RPLAPPST EQU   RPLOPT9                                                  06521000
RPLCOUNT EQU   RPLOPT9                                                  06522000
RPLTERMS EQU   RPLOPT9                                                  06523000
RPLDEVCH EQU   RPLOPT9                                                  06524000
RPLLOGON EQU   RPLOPT9                                                  06525000
RPLESR2  EQU   RPLUSNSI+1                                               06526000
RPLESR1  EQU   RPLUSNSI                                                 06527000
RPLSSMI  EQU   RPLDSB2                                                  06528000
@NM00009 EQU   RPLSSEI                                                  06529000
RPLRRI   EQU   RPLSSEI                                                  06530000
RPLFII   EQU   RPLSSEI                                                  06531000
RPLSTATI EQU   RPLSSEI                                                  06532000
RPLCPMI  EQU   RPLSSEI                                                  06533000
RPLPATHI EQU   RPLSSEI                                                  06534000
RPLARCLN EQU   RPLVTEXT+8                                               06535000
RPLAARLN EQU   RPLVTEXT+4                                               06536000
RPLAAREA EQU   RPLVTEXT                                                 06537000
RPLERMSA EQU   RPLCOMN+72                                               06538000
RPLEMLEN EQU   RPLCOMN+70                                               06539000
RPLACTIV EQU   RPLCOMN+69                                               06540000
RPLBRANC EQU   RPLEXTD1                                                 06541000
@NM00008 EQU   RPLEXTD1                                                 06542000
RPLEXIT  EQU   RPLEXTD1                                                 06543000
RPLNEXIT EQU   RPLEXTD1                                                 06544000
RPLEXSCH EQU   RPLEXTD1                                                 06545000
RPLDDDD  EQU   RPLRBAR+4                                                06546000
@NM00007 EQU   RPLRBAR+3                                                06547000
@NM00006 EQU   RPLAIXID                                                 06548000
RPLAXPKP EQU   RPLAIXID                                                 06549000
RPLAIXPC EQU   RPLRBAR                                                  06550000
RPLRSV88 EQU   RPLOPT8                                                  06551000
RPLUNCON EQU   RPLOPT8                                                  06552000
RPLACTV  EQU   RPLOPT8                                                  06553000
RPLSESS  EQU   RPLOPT8                                                  06554000
RPLPEND  EQU   RPLOPT8                                                  06555000
RPLODPRM EQU   RPLOPT8                                                  06556000
RPLODACP EQU   RPLOPT8                                                  06557000
RPLODACQ EQU   RPLOPT8                                                  06558000
RPLRSV78 EQU   RPLOPT7                                                  06559000
RPLTCRNO EQU   RPLOPT7                                                  06560000
RPLRLSOP EQU   RPLOPT7                                                  06561000
RPLTPOST EQU   RPLOPT7                                                  06562000
RPLQOPT  EQU   RPLOPT7                                                  06563000
RPLCNIMM EQU   RPLCNOPT                                                 06564000
RPLCNANY EQU   RPLCNOPT                                                 06565000
RPLCNALL EQU   RPLCNOPT                                                 06566000
RPLRSV68 EQU   RPLOPT6                                                  06567000
RPLRSV67 EQU   RPLOPT6                                                  06568000
RPLLOCK  EQU   RPLOPT6                                                  06569000
RPLNCOND EQU   RPLOPT6                                                  06570000
RPLCOND  EQU   RPLOPT6                                                  06571000
RPLEOT   EQU   RPLUNTYP                                                 06572000
RPLEOM   EQU   RPLUNTYP                                                 06573000
RPLEOB   EQU   RPLUNTYP                                                 06574000
RPLWROPT EQU   RPLOPT5                                                  06575000
RPLNODE  EQU   RPLOPT5                                                  06576000
RPLERACE EQU   RPLWRTYP                                                 06577000
RPLEAU   EQU   RPLWRTYP                                                 06578000
RPLNERAS EQU   RPLWRTYP                                                 06579000
RPLPSOPT EQU   RPLOPT5                                                  06580000
@NM00005 EQU   RPLOPT5                                                  06581000
RPLDLGIN EQU   RPLOPT5                                                  06582000
RPLBUFL  EQU   RPLCOMN+52                                               06583000
RPLCHAIN EQU   RPLNXTRP                                                 06584000
RPLBOP   EQU   RPLOPT4                                                  06585000
@NM00004 EQU   RPLOPT4                                                  06586000
RPLMKFRM EQU   RPLOPT4                                                  06587000
RPLENDTR EQU   RPLOPT4                                                  06588000
RPLALIGN EQU   RPLOPT3                                                  06589000
RPLFMT   EQU   RPLOPT3                                                  06590000
RPLFLD   EQU   RPLOPT3                                                  06591000
RPLVFY   EQU   RPLOPT3                                                  06592000
RPLBLK   EQU   RPLOPT3                                                  06593000
RPLSFORM EQU   RPLOPT3                                                  06594000
RPLEODS  EQU   RPLOPT3                                                  06595000
RPLNSP   EQU   RPLOPT2                                                  06596000
RPLUPD   EQU   RPLOPT2                                                  06597000
@NM00003 EQU   RPLOPT2                                                  06598000
RPLLRD   EQU   RPLOPT2                                                  06599000
RPLBWD   EQU   RPLOPT2                                                  06600000
RPLCNV   EQU   RPLOPT2                                                  06601000
RPLADD   EQU   RPLADR                                                   06602000
RPLKEY   EQU   RPLOPT2                                                  06603000
RPLECBIN EQU   RPLECBSW                                                 06604000
RPLGEN   EQU   RPLOPT1                                                  06605000
RPLKGE   EQU   RPLOPT1                                                  06606000
RPLASY   EQU   RPLOPT1                                                  06607000
RPLSKP   EQU   RPLOPT1                                                  06608000
RPLSEQ   EQU   RPLOPT1                                                  06609000
RPLDIR   EQU   RPLOPT1                                                  06610000
RPLLOC   EQU   RPLOPT1                                                  06611000
RPLDAF   EQU   RPLARG+2                                                 06612000
RPLSAF   EQU   RPLARG                                                   06613000
RPLTCBPT EQU   RPLCOMN+28                                               06614000
RPLCCHAR EQU   RPLCOMN+20                                               06615000
RPLSTRID EQU   RPLCOMN+18                                               06616000
RPLKEYL  EQU   RPLKEYLE                                                 06617000
RPLRDSOH EQU   RPLFDB3                                                  06618000
RPLRLG   EQU   RPLFDB3                                                  06619000
RPLLGFRC EQU   RPLFDB3                                                  06620000
RPLREOT  EQU   RPLFDB3                                                  06621000
RPLREOM  EQU   RPLFDB3                                                  06622000
RPLREOB  EQU   RPLFDB3                                                  06623000
RPLSV32  EQU   RPLFDB3                                                  06624000
RPLUINPT EQU   RPLFDB3                                                  06625000
RPLSTSAV EQU   RPLFDB2                                                  06626000
RPLCUERR EQU   RPLFDB2                                                  06627000
RPLDLGFL EQU   RPLFDB2                                                  06628000
RPLIOERR EQU   RPLFDB2                                                  06629000
RPLDVUNS EQU   RPLFDB2                                                  06630000
RPLATND  EQU   RPLFDB2                                                  06631000
RPLRVID  EQU   RPLFDB2                                                  06632000
RPLERLK  EQU   RPLFDB2                                                  06633000
RPLERREG EQU   RPLRTNCD                                                 06634000
RPLSTAT  EQU   RPLFDBWD                                                 06635000
RPLPOST  EQU   RPLECB                                                   06636000
RPLWAIT  EQU   RPLECB                                                   06637000
RPLPLHPT EQU   RPLCOMN+4                                                06638000
RPLLEN2  EQU   RPLLEN                                                   06639000
RPLREQ   EQU   RPLIDWD+2                                                06640000
RPLSTYP  EQU   RPLIDWD+1                                                06641000
RPLID    EQU   RPLIDWD                                                  06642000
CVTLEVL  EQU   CVTRELNO+2                                               06643000
CVTNUMB  EQU   CVTRELNO                                                 06644000
CVTMDL   EQU   CVTFIX+250                                               06645000
@NM00002 EQU   CVTFIX+248                                               06646000
@NM00001 EQU   CVTFIX                                                   06647000
CVTRV482 EQU   CVTXTNT2+128                                             06648000
CVTRV481 EQU   CVTXTNT2+124                                             06649000
CVTRV480 EQU   CVTXTNT2+120                                             06650000
CVTRV479 EQU   CVTXTNT2+118                                             06651000
CVTRV478 EQU   CVTXTNT2+117                                             06652000
CVTRV477 EQU   CVTXTNT2+116                                             06653000
CVTRV476 EQU   CVTXTNT2+115                                             06654000
CVTRV475 EQU   CVTXTNT2+114                                             06655000
CVTRV474 EQU   CVTRV466                                                 06656000
CVTRV473 EQU   CVTRV466                                                 06657000
CVTRV472 EQU   CVTRV466                                                 06658000
CVTRV471 EQU   CVTRV466                                                 06659000
CVTRV470 EQU   CVTRV466                                                 06660000
CVTRV469 EQU   CVTRV466                                                 06661000
CVTRV468 EQU   CVTRV466                                                 06662000
CVTRV467 EQU   CVTRV466                                                 06663000
CVTRV465 EQU   CVTRV457                                                 06664000
CVTRV464 EQU   CVTRV457                                                 06665000
CVTRV463 EQU   CVTRV457                                                 06666000
CVTRV462 EQU   CVTRV457                                                 06667000
CVTRV461 EQU   CVTRV457                                                 06668000
CVTRV460 EQU   CVTRV457                                                 06669000
CVTRV459 EQU   CVTRV457                                                 06670000
CVTRV458 EQU   CVTRV457                                                 06671000
CVTRV456 EQU   CVTXTNT2+108                                             06672000
CVTRV455 EQU   CVTXTNT2+104                                             06673000
CVTRV454 EQU   CVTXTNT2+100                                             06674000
CVTRV453 EQU   CVTXTNT2+96                                              06675000
CVTRV452 EQU   CVTXTNT2+94                                              06676000
CVTRV451 EQU   CVTXTNT2+92                                              06677000
CVTRV450 EQU   CVTXTNT2+90                                              06678000
CVTRV449 EQU   CVTXTNT2+88                                              06679000
CVTRV448 EQU   CVTXTNT2+87                                              06680000
CVTRV447 EQU   CVTXTNT2+86                                              06681000
CVTRV446 EQU   CVTRV438                                                 06682000
CVTRV445 EQU   CVTRV438                                                 06683000
CVTRV444 EQU   CVTRV438                                                 06684000
CVTRV443 EQU   CVTRV438                                                 06685000
CVTRV442 EQU   CVTRV438                                                 06686000
CVTRV441 EQU   CVTRV438                                                 06687000
CVTRV440 EQU   CVTRV438                                                 06688000
CVTRV439 EQU   CVTRV438                                                 06689000
CVTRV437 EQU   CVTRV429                                                 06690000
CVTRV436 EQU   CVTRV429                                                 06691000
CVTRV435 EQU   CVTRV429                                                 06692000
CVTRV434 EQU   CVTRV429                                                 06693000
CVTRV433 EQU   CVTRV429                                                 06694000
CVTRV432 EQU   CVTRV429                                                 06695000
CVTRV431 EQU   CVTRV429                                                 06696000
CVTRV430 EQU   CVTRV429                                                 06697000
CVTRV428 EQU   CVTXTNT2+80                                              06698000
CVTRV427 EQU   CVTXTNT2+76                                              06699000
CVTRV426 EQU   CVTXTNT2+72                                              06700000
CVTRV425 EQU   CVTXTNT2+68                                              06701000
CVTATACT EQU   CVTATCVT                                                 06702000
CVTRV423 EQU   CVTXTNT2+62                                              06703000
CVTRV422 EQU   CVTXTNT2+60                                              06704000
CVTRV421 EQU   CVTXTNT2+58                                              06705000
CVTRV420 EQU   CVTXTNT2+56                                              06706000
CVTRV419 EQU   CVTXTNT2+55                                              06707000
CVTRV418 EQU   CVTXTNT2+54                                              06708000
CVTRV417 EQU   CVTRV409                                                 06709000
CVTRV416 EQU   CVTRV409                                                 06710000
CVTRV415 EQU   CVTRV409                                                 06711000
CVTRV414 EQU   CVTRV409                                                 06712000
CVTRV413 EQU   CVTRV409                                                 06713000
CVTRV412 EQU   CVTRV409                                                 06714000
CVTRV411 EQU   CVTRV409                                                 06715000
CVTRV410 EQU   CVTRV409                                                 06716000
CVTRV408 EQU   CVTRV400                                                 06717000
CVTRV407 EQU   CVTRV400                                                 06718000
CVTRV406 EQU   CVTRV400                                                 06719000
CVTRV405 EQU   CVTRV400                                                 06720000
CVTRV404 EQU   CVTRV400                                                 06721000
CVTRV403 EQU   CVTRV400                                                 06722000
CVTRV402 EQU   CVTRV400                                                 06723000
CVTRV401 EQU   CVTRV400                                                 06724000
CVTICB   EQU   CVTXTNT2+48                                              06725000
CVTSKTA  EQU   CVTXTNT2+44                                              06726000
CVTSHSB  EQU   CVTSHS                                                   06727000
CVTRSV98 EQU   CVTXTNT2+36                                              06728000
CVTRSV97 EQU   CVTXTNT2+34                                              06729000
CVTRSV96 EQU   CVTXTNT2+32                                              06730000
CVTOLTEP EQU   CVTXTNT2+28                                              06731000
CVTQIDA  EQU   CVTQID+1                                                 06732000
CVTRSV95 EQU   CVTQID                                                   06733000
CVTRSV94 EQU   CVTXTNT2+20                                              06734000
CVTRSV93 EQU   CVTXTNT2+16                                              06735000
CVTRSV92 EQU   CVTXTNT2+12                                              06736000
CVTDEBVR EQU   CVTXTNT2+8                                               06737000
CVTRSV91 EQU   CVTXTNT2+6                                               06738000
CVTRSV9H EQU   CVTFLGBT                                                 06739000
CVTRSV9G EQU   CVTFLGBT                                                 06740000
CVTRSV9F EQU   CVTFLGBT                                                 06741000
CVTRSV9E EQU   CVTFLGBT                                                 06742000
CVTRSV9D EQU   CVTFLGBT                                                 06743000
CVTRSV9C EQU   CVTFLGBT                                                 06744000
CVTVME   EQU   CVTFLGBT                                                 06745000
CVTNPE   EQU   CVTFLGBT                                                 06746000
CVTNUCLS EQU   CVTXTNT2+4                                               06747000
CVTDSSVA EQU   CVTDSSV+1                                                06748000
CVTRSV89 EQU   CVTDSSV                                                  06749000
CVTRSV88 EQU   CVTXTNT1+8                                               06750000
CVTRSV87 EQU   CVTXTNT1+4                                               06751000
CVTFACHN EQU   CVTXTNT1                                                 06752000
CVTRV488 EQU   CVTMAP+412                                               06753000
CVTRV487 EQU   CVTMAP+408                                               06754000
CVTRV486 EQU   CVTMAP+404                                               06755000
CVTRV485 EQU   CVTMAP+400                                               06756000
CVTACTAP EQU   CVTMAP+396                                               06757000
CVTAUTH  EQU   CVTMAP+392                                               06758000
CVTATMCA EQU   CVTATMCT+1                                               06759000
CVTATMST EQU   CVTATMCT                                                 06760000
CVTRSV61 EQU   CVTMAP+384                                               06761000
CVTVOLT1 EQU   CVTVOLM1+1                                               06762000
CVTVOLI1 EQU   CVTVOLF1                                                 06763000
CVTSTOA  EQU   CVTMAP+376                                               06764000
CVTRSV58 EQU   CVTMAP+374                                               06765000
CVTRSV57 EQU   CVTMAP+372                                               06766000
CVTDDCE  EQU   CVTMAP+368                                               06767000
CVTPNWFR EQU   CVTMAP+364                                               06768000
CVTSMF   EQU   CVTMAP+360                                               06769000
CVTSULK  EQU   CVTMAP+358                                               06770000
CVTSLKO  EQU   CVTSYSK                                                  06771000
CVTSLKP  EQU   CVTSYSK                                                  06772000
CVTSLKQ  EQU   CVTSYSK                                                  06773000
CVTSLKR  EQU   CVTSYSK                                                  06774000
CVTRSV56 EQU   CVTSYSK                                                  06775000
CVTRSV55 EQU   CVTSYSK                                                  06776000
CVTRSV54 EQU   CVTSYSK                                                  06777000
CVTRSV53 EQU   CVTSYSK                                                  06778000
CVTRSV52 EQU   CVTA1F1                                                  06779000
CVTRSV51 EQU   CVTA1F1                                                  06780000
CVTRSV50 EQU   CVTA1F1                                                  06781000
CVTRSV49 EQU   CVTA1F1                                                  06782000
CVTRSV48 EQU   CVTA1F1                                                  06783000
CVTRSV47 EQU   CVTA1F1                                                  06784000
CVTSRSW  EQU   CVTA1F1                                                  06785000
CVTPFSW  EQU   CVTA1F1                                                  06786000
CVTPCVT  EQU   CVTMAP+352                                               06787000
CVTRSV46 EQU   CVTMAP+344                                               06788000
CVTRSV45 EQU   CVTMAP+340                                               06789000
CVTRSV44 EQU   CVTMAP+338                                               06790000
CVTRSV43 EQU   CVTMAP+336                                               06791000
CVTHJESA EQU   CVTHJES+1                                                06792000
CVTRSV42 EQU   CVTHJES                                                  06793000
CVTEXT2A EQU   CVTEXT2+1                                                06794000
CVTRSV41 EQU   CVTEXT2                                                  06795000
CVTAPFA  EQU   CVTAPF+1                                                 06796000
CVTRSV40 EQU   CVTAPF                                                   06797000
CVTRV518 EQU   CVTINTLA                                                 06798000
CVTRV517 EQU   CVTERPV                                                  06799000
CVTEORM  EQU   CVTMAP+312                                               06800000
CVTMCHPR EQU   CVTMAP+308                                               06801000
CVTTZ    EQU   CVTMAP+304                                               06802000
CVTJEPS  EQU   CVTMAP+300                                               06803000
CVTJESCT EQU   CVTMAP+296                                               06804000
CVTMODE  EQU   CVTMAP+292                                               06805000
CVTPTRV  EQU   CVTMAP+288                                               06806000
CVTREAL  EQU   CVTMAP+284                                               06807000
CVTRSV39 EQU   CVTMAP+280                                               06808000
CVTRSV38 EQU   CVTMAP+276                                               06809000
CVTDMSRA EQU   CVTDMSR+1                                                06810000
CVTRV634 EQU   CVTDMSRF                                                 06811000
CVTRV633 EQU   CVTDMSRF                                                 06812000
CVTRV632 EQU   CVTDMSRF                                                 06813000
CVTRV631 EQU   CVTDMSRF                                                 06814000
CVTRV630 EQU   CVTDMSRF                                                 06815000
CVTRV629 EQU   CVTDMSRF                                                 06816000
CVTUDUMP EQU   CVTDMSRF                                                 06817000
CVTSDUMP EQU   CVTDMSRF                                                 06818000
CVTQMSGA EQU   CVTQMSG+1                                                06819000
CVTRSV36 EQU   CVTQMSG                                                  06820000
CVTAMFF  EQU   CVTMAP+264                                               06821000
CVTPURGA EQU   CVTPURG+1                                                06822000
CVTRSV35 EQU   CVTPURG                                                  06823000
CVTCBSP  EQU   CVTMAP+256                                               06824000
CVTATERA EQU   CVTATER+1                                                06825000
CVTSYST  EQU   CVTATER                                                  06826000
CVTVOLT2 EQU   CVTTAT                                                   06827000
CVTVOLI2 EQU   CVTVOLF2                                                 06828000
CVTAQAVB EQU   CVTAQAVT+1                                               06829000
CVTRSV34 EQU   CVTTCMFG                                                 06830000
CVTRSV33 EQU   CVTTCMFG                                                 06831000
CVTRSV32 EQU   CVTTCMFG                                                 06832000
CVTRSV31 EQU   CVTTCMFG                                                 06833000
CVTRSV30 EQU   CVTTCMFG                                                 06834000
CVTRSV29 EQU   CVTTCMFG                                                 06835000
CVTRSV28 EQU   CVTTCMFG                                                 06836000
CVTTCRDY EQU   CVTTCMFG                                                 06837000
CVTGTFA  EQU   CVTGTF+1                                                 06838000
CVTRSV27 EQU   CVTGTFST                                                 06839000
CVTRNIO  EQU   CVTGTFST                                                 06840000
CVTUSR   EQU   CVTGTFST                                                 06841000
CVTRV318 EQU   CVTFORM                                                  06842000
CVTRV317 EQU   CVTTMODE                                                 06843000
CVTRV316 EQU   CVTSTATE                                                 06844000
CVTRV315 EQU   CVTGTFS                                                  06845000
CVTGTFAV EQU   CVTGTFS                                                  06846000
CVT0SCR1 EQU   CVTMAP+232                                               06847000
CVTRV515 EQU   CVTMAP+228                                               06848000
CVTRMS   EQU   CVTMAP+224                                               06849000
CVTPATCH EQU   CVTMAP+220                                               06850000
CVTTSCE  EQU   CVTMAP+216                                               06851000
CVTLNKSC EQU   CVTMAP+214                                               06852000
CVTQABST EQU   CVTMAP+212                                               06853000
CVTMDLDS EQU   CVTMAP+208                                               06854000
CVTUSER  EQU   CVTMAP+204                                               06855000
CVTSMCA  EQU   CVTMAP+196                                               06856000
CVTRSV18 EQU   CVTMAP+192                                               06857000
CVTQLPAQ EQU   CVTMAP+188                                               06858000
CVTQCDSR EQU   CVTMAP+184                                               06859000
CVTRSV17 EQU   CVTOPTB                                                  06860000
CVTRSV16 EQU   CVTOPTB                                                  06861000
CVTFP    EQU   CVTOPTB                                                  06862000
CVTAPTHR EQU   CVTOPTB                                                  06863000
CVTNLOG  EQU   CVTOPTB                                                  06864000
CVTTOD   EQU   CVTOPTB                                                  06865000
CVTCTIMS EQU   CVTOPTB                                                  06866000
CVTPROT  EQU   CVTOPTB                                                  06867000
CVTXPFP  EQU   CVTOPTA                                                  06868000
CVTASCII EQU   CVTOPTA                                                  06869000
CVTRSV13 EQU   CVTOPTA                                                  06870000
CVTRSV12 EQU   CVTOPTA                                                  06871000
CVTNIP   EQU   CVTOPTA                                                  06872000
CVTDDR   EQU   CVTOPTA                                                  06873000
CVTAPR   EQU   CVTOPTA                                                  06874000
CVTCCH   EQU   CVTOPTA                                                  06875000
CVTSNCTR EQU   CVTMAP+180                                               06876000
CVTQMWR  EQU   CVTMAP+176                                               06877000
CVTQOCR  EQU   CVTMAP+172                                               06878000
CVT1EF00 EQU   CVTMAP+168                                               06879000
CVTMZ00  EQU   CVTMAP+164                                               06880000
CVTHEAD  EQU   CVTMAP+160                                               06881000
CVTRSV11 EQU   CVTMAP+156                                               06882000
CVTMSER  EQU   CVTMAP+148                                               06883000
CVTRV516 EQU   CVTIERLC                                                 06884000
CVTILCH  EQU   CVTMAP+140                                               06885000
CVT0DS   EQU   CVTMAP+136                                               06886000
CVTFBOSV EQU   CVTMAP+132                                               06887000
CVTNUCB  EQU   CVTMAP+128                                               06888000
CVTIXAVL EQU   CVTMAP+124                                               06889000
CVTIOQET EQU   CVTMAP+120                                               06890000
CVTDCBA  EQU   CVTMAP+117                                               06891000
CVTMVS2  EQU   CVTDCB                                                   06892000
CVT6DAT  EQU   CVTDCB                                                   06893000
CVT4MPS  EQU   CVTDCB                                                   06894000
CVTRSV09 EQU   CVTDCB                                                   06895000
CVT4MS1  EQU   CVTDCB                                                   06896000
CVT2SPS  EQU   CVTDCB                                                   06897000
CVT1SSS  EQU   CVTDCB                                                   06898000
CVTRSV08 EQU   CVTDCB                                                   06899000
CVTSTB   EQU   CVTMAP+112                                               06900000
CVTQTD00 EQU   CVTMAP+108                                               06901000
CVTQTE00 EQU   CVTMAP+104                                               06902000
CVTCUCB  EQU   CVTMAP+100                                               06903000
CVTSJQ   EQU   CVTMAP+96                                                06904000
CVTPBLDL EQU   CVTMAP+92                                                06905000
CVTTPC   EQU   CVTMAP+88                                                06906000
CVTSVDCB EQU   CVTMAP+84                                                06907000
CVTBRET  EQU   CVTMAP+82                                                06908000
CVTEXIT  EQU   CVTMAP+80                                                06909000
CVT0FN00 EQU   CVTMAP+76                                                06910000
CVTDARA  EQU   CVTDAR+1                                                 06911000
CVTRSV07 EQU   CVTFLGS1                                                 06912000
CVTRSV06 EQU   CVTFLGS1                                                 06913000
CVTRSV05 EQU   CVTFLGS1                                                 06914000
CVTRSV04 EQU   CVTFLGS1                                                 06915000
CVTRSV03 EQU   CVTFLGS1                                                 06916000
CVTRSV02 EQU   CVTFLGS1                                                 06917000
CVTRSV01 EQU   CVTFLGS1                                                 06918000
CVTDMPLK EQU   CVTFLGS1                                                 06919000
CVTXITP  EQU   CVTMAP+68                                                06920000
CVTZDTAB EQU   CVTMAP+64                                                06921000
CVTMSLT  EQU   CVTMAP+60                                                06922000
CVTDATE  EQU   CVTMAP+56                                                06923000
CVTBTERM EQU   CVTMAP+52                                                06924000
CVTSYSAD EQU   CVTMAP+48                                                06925000
CVTXTLER EQU   CVTMAP+44                                                06926000
CVTILK2  EQU   CVTMAP+40                                                06927000
CVTILK1  EQU   CVTMAP+36                                                06928000
CVTPRLTV EQU   CVTMAP+32                                                06929000
CVTPCNVT EQU   CVTMAP+28                                                06930000
CVT0VL00 EQU   CVTMAP+24                                                06931000
CVTXAPG  EQU   CVTMAP+20                                                06932000
CVTBUF   EQU   CVTMAP+16                                                06933000
CVTJOB   EQU   CVTMAP+12                                                06934000
CVTLINK  EQU   CVTMAP+8                                                 06935000
CVT0EF00 EQU   CVTMAP+4                                                 06936000
CVTTCBP  EQU   CVTMAP                                                   06937000
@NM00052 EQU   PSA+3668                                                 06938000
PSASTAK  EQU   PSA+3072                                                 06939000
@NM00051 EQU   PSA+1048                                                 06940000
PSAUSEND EQU   PSA+1048                                                 06941000
PSARV062 EQU   PSA+1044                                                 06942000
PSACDAL  EQU   PSA+1040                                                 06943000
PSAWTCOD EQU   PSA+1036                                                 06944000
PSAATCVT EQU   PSA+1032                                                 06945000
PSAPCPSW EQU   PSA+1024                                                 06946000
PSAPIR2  EQU   PSA+1020                                                 06947000
PSARV059 EQU   PSA+1018                                                 06948000
PSASVC13 EQU   PSA+1016                                                 06949000
PSASFACC EQU   PSA+1008                                                 06950000
PSASTOP  EQU   PSA+992                                                  06951000
PSASTART EQU   PSA+976                                                  06952000
PSARSPSW EQU   PSA+968                                                  06953000
PSASRPSW EQU   PSA+960                                                  06954000
PSARV045 EQU   PSA+892                                                  06955000
PSARV044 EQU   PSA+888                                                  06956000
PSARV043 EQU   PSA+884                                                  06957000
PSARV042 EQU   PSA+880                                                  06958000
PSARV041 EQU   PSA+876                                                  06959000
PSARV040 EQU   PSA+872                                                  06960000
PSARV025 EQU   PSA+868                                                  06961000
PSADSSED EQU   PSA+868                                                  06962000
PSADSSPR EQU   PSA+864                                                  06963000
PSADSSFW EQU   PSA+860                                                  06964000
PSADSS14 EQU   PSA+856                                                  06965000
PSADSSPP EQU   PSA+848                                                  06966000
PSADSSRP EQU   PSA+840                                                  06967000
PSADSS05 EQU   PSADSSF4                                                 06968000
PSADSS10 EQU   PSADSSF4                                                 06969000
PSADSSVE EQU   PSADSSF4                                                 06970000
PSADSSDE EQU   PSADSSF4                                                 06971000
PSADSSC0 EQU   PSADSSF4                                                 06972000
PSADSSIE EQU   PSADSSF4                                                 06973000
PSADSS12 EQU   PSADSSF4                                                 06974000
PSADSSRC EQU   PSADSSF4                                                 06975000
PSARV057 EQU   PSADSSF3                                                 06976000
PSARV056 EQU   PSADSSF3                                                 06977000
PSARV055 EQU   PSADSSF3                                                 06978000
PSADSSMC EQU   PSADSSF3                                                 06979000
PSADSSRW EQU   PSADSSF3                                                 06980000
PSADSSNM EQU   PSADSSF3                                                 06981000
PSADSSES EQU   PSADSSF3                                                 06982000
PSADSSGP EQU   PSADSSF3                                                 06983000
PSADSSF2 EQU   PSADSSFL+1                                               06984000
PSADSSPI EQU   PSADSSF1                                                 06985000
PSADSSOI EQU   PSADSSF1                                                 06986000
PSADSSSP EQU   PSADSSF1                                                 06987000
PSADSSTP EQU   PSADSSF1                                                 06988000
PSADSSDW EQU   PSADSSF1                                                 06989000
PSADSSDD EQU   PSADSSF1                                                 06990000
PSADSSDM EQU   PSADSSF1                                                 06991000
PSADSSMV EQU   PSADSSF1                                                 06992000
PSADSSTS EQU   PSA+816                                                  06993000
PSADSSWK EQU   PSA+812                                                  06994000
PSADSSR3 EQU   PSA+808                                                  06995000
PSADSSR2 EQU   PSA+804                                                  06996000
PSADSSRS EQU   PSA+800                                                  06997000
PSASTOR  EQU   PSA+796                                                  06998000
PSACPUSA EQU   PSA+794                                                  06999000
PSAVSTAP EQU   PSA+792                                                  07000000
PSAWKVAP EQU   PSA+788                                                  07001000
PSAWKRAP EQU   PSA+784                                                  07002000
PSAMCHIC EQU   PSA+783                                                  07003000
PSARV061 EQU   PSA+782                                                  07004000
PSASYMSK EQU   PSA+781                                                  07005000
PSAMCHFL EQU   PSA+780                                                  07006000
PSACR0   EQU   PSA+776                                                  07007000
PSAPSWSV EQU   PSA+768                                                  07008000
PSACLHS  EQU   PSAHLHI                                                  07009000
PSALKR15 EQU   PSALKSA+60                                               07010000
PSALKR14 EQU   PSALKSA+56                                               07011000
PSALKR13 EQU   PSALKSA+52                                               07012000
PSALKR12 EQU   PSALKSA+48                                               07013000
PSALKR11 EQU   PSALKSA+44                                               07014000
PSALKR10 EQU   PSALKSA+40                                               07015000
PSALKR9  EQU   PSALKSA+36                                               07016000
PSALKR8  EQU   PSALKSA+32                                               07017000
PSALKR7  EQU   PSALKSA+28                                               07018000
PSALKR6  EQU   PSALKSA+24                                               07019000
PSALKR5  EQU   PSALKSA+20                                               07020000
PSALKR4  EQU   PSALKSA+16                                               07021000
PSALKR3  EQU   PSALKSA+12                                               07022000
PSALKR2  EQU   PSALKSA+8                                                07023000
PSALKR1  EQU   PSALKSA+4                                                07024000
PSALKR0  EQU   PSALKSA                                                  07025000
PSARV023 EQU   PSACLHT+52                                               07026000
PSALOCAL EQU   PSACLHT+48                                               07027000
PSACMSL  EQU   PSACLHT+44                                               07028000
PSAOPTL  EQU   PSACLHT+40                                               07029000
PSATPACL EQU   PSACLHT+36                                               07030000
PSATPDNL EQU   PSACLHT+32                                               07031000
PSATPNCL EQU   PSACLHT+28                                               07032000
PSAIOSLL EQU   PSACLHT+24                                               07033000
PSAIOSUL EQU   PSACLHT+20                                               07034000
PSAIOSCL EQU   PSACLHT+16                                               07035000
PSAIOSSL EQU   PSACLHT+12                                               07036000
PSASALCL EQU   PSACLHT+8                                                07037000
PSAASML  EQU   PSACLHT+4                                                07038000
PSADISPL EQU   PSACLHT                                                  07039000
PSASRSA  EQU   PSA+636                                                  07040000
PSARV050 EQU   PSA+634                                                  07041000
PSADSSGO EQU   PSA+633                                                  07042000
PSARECUR EQU   PSA+632                                                  07043000
PSAHLHIS EQU   PSA+628                                                  07044000
PSAIPCSA EQU   PSA+624                                                  07045000
@NM00050 EQU   PSA+621                                                  07046000
PSAIPCDM EQU   PSA+620                                                  07047000
PSAIPCD  EQU   PSA+616                                                  07048000
@NM00049 EQU   PSA+613                                                  07049000
PSAIPCRM EQU   PSA+612                                                  07050000
PSAIPCR  EQU   PSA+608                                                  07051000
PSAMCHEX EQU   PSA+600                                                  07052000
PSAMPSW  EQU   PSA+592                                                  07053000
PSAEXPS2 EQU   PSA+584                                                  07054000
PSAEXPS1 EQU   PSA+576                                                  07055000
PSAPIREG EQU   PSA+572                                                  07056000
PSARSREG EQU   PSA+568                                                  07057000
PSAGPREG EQU   PSA+556                                                  07058000
PSARV022 EQU   PSASUP4                                                  07059000
PSARV021 EQU   PSASUP4                                                  07060000
PSARV020 EQU   PSASUP4                                                  07061000
PSARV019 EQU   PSASUP4                                                  07062000
PSARV018 EQU   PSASUP4                                                  07063000
PSARV017 EQU   PSASUP4                                                  07064000
PSARV016 EQU   PSASUP4                                                  07065000
PSARV015 EQU   PSASUP4                                                  07066000
PSARV014 EQU   PSASUP3                                                  07067000
PSARV013 EQU   PSASUP3                                                  07068000
PSARV012 EQU   PSASUP3                                                  07069000
PSARV011 EQU   PSASUP3                                                  07070000
PSASPR   EQU   PSASUP3                                                  07071000
PSAPSREG EQU   PSASUP3                                                  07072000
PSAPI2   EQU   PSASUP3                                                  07073000
PSAIOSUP EQU   PSASUP3                                                  07074000
PSALCR   EQU   PSASUP2                                                  07075000
PSARTM   EQU   PSASUP2                                                  07076000
PSAACR   EQU   PSASUP2                                                  07077000
PSAIPCE2 EQU   PSASUP2                                                  07078000
PSAIPCES EQU   PSASUP2                                                  07079000
PSAIPCEC EQU   PSASUP2                                                  07080000
PSAGTF   EQU   PSASUP2                                                  07081000
PSAIPCRI EQU   PSASUP2                                                  07082000
PSARV063 EQU   PSASUP1                                                  07083000
PSATCTL  EQU   PSASUP1                                                  07084000
PSADISP  EQU   PSASUP1                                                  07085000
PSALOCK  EQU   PSASUP1                                                  07086000
PSAPI    EQU   PSASUP1                                                  07087000
PSAEXT   EQU   PSASUP1                                                  07088000
PSASVC   EQU   PSASUP1                                                  07089000
PSAIO    EQU   PSASUP1                                                  07090000
PSAANEW  EQU   PSA+544                                                  07091000
PSATOLD  EQU   PSA+540                                                  07092000
PSATNEW  EQU   PSA+536                                                  07093000
PSALCCAR EQU   PSA+532                                                  07094000
PSALCCAV EQU   PSA+528                                                  07095000
PSAPCCAR EQU   PSA+524                                                  07096000
PSAPCCAV EQU   PSA+520                                                  07097000
PSACPULA EQU   PSA+518                                                  07098000
PSACPUPA EQU   PSA+516                                                  07099000
PSAPSA   EQU   PSA+512                                                  07100000
FLCHDEND EQU   PSA+512                                                  07101000
FLCCRSAV EQU   FLCMCLA+280                                              07102000
FLCGRSAV EQU   FLCMCLA+216                                              07103000
FLCFPSAV EQU   FLCMCLA+184                                              07104000
FLCFLA   EQU   FLCMCLA+88                                               07105000
FLCRGNCD EQU   FLCMCLA+84                                               07106000
FLCFSAA  EQU   FLCFSA+1                                                 07107000
@NM00048 EQU   FLCFSA                                                   07108000
@NM00047 EQU   FLCMCLA+72                                               07109000
FLCMCIC  EQU   FLCMCLA+64                                               07110000
@NM00046 EQU   FLCMCLA+20                                               07111000
FLCIOAA  EQU   FLCIOA+1                                                 07112000
@NM00045 EQU   FLCIOA                                                   07113000
@NM00044 EQU   FLCMCLA+15                                               07114000
@NM00043 EQU   FLCMCLA+14                                               07115000
@NM00042 EQU   FLCMCLA+12                                               07116000
FLCLCL   EQU   FLCMCLA+8                                                07117000
FLCIOELA EQU   FLCIOEL+1                                                07118000
@NM00041 EQU   FLCIOEL                                                  07119000
FLCCHNID EQU   FLCMCLA                                                  07120000
@NM00040 EQU   PSA+160                                                  07121000
FLCMTRCD EQU   PSA+157                                                  07122000
@NM00039 EQU   PSA+156                                                  07123000
FLCPERA  EQU   FLCPER+1                                                 07124000
@NM00038 EQU   FLCPER                                                   07125000
@NM00037 EQU   PSA+151                                                  07126000
FLCPERCD EQU   PSA+150                                                  07127000
FLCMCNUM EQU   PSA+149                                                  07128000
@NM00036 EQU   PSA+148                                                  07129000
FLCTEAA  EQU   FLCTEA+1                                                 07130000
@NM00035 EQU   FLCTEA                                                   07131000
PSAPIPC  EQU   PSAPICOD                                                 07132000
PSAPIMC  EQU   PSAPICOD                                                 07133000
PSAPIPER EQU   PSAPICOD                                                 07134000
PSARV049 EQU   FLCPICOD                                                 07135000
FLCPILCB EQU   FLCPIILC                                                 07136000
@NM00034 EQU   FLCPIILC                                                 07137000
@NM00033 EQU   PSAEPPSW                                                 07138000
FLCSVCN  EQU   PSAESPSW+2                                               07139000
FLCSILCB EQU   FLCSVILC                                                 07140000
@NM00032 EQU   FLCSVILC                                                 07141000
@NM00031 EQU   PSAESPSW                                                 07142000
FLCEICOD EQU   PSAEEPSW+2                                               07143000
PSASPAD  EQU   PSAEEPSW                                                 07144000
@NM00030 EQU   PSA+128                                                  07145000
FLCINPSW EQU   PSA+120                                                  07146000
FLCMNPSW EQU   PSA+112                                                  07147000
FLCPNPSW EQU   PSA+104                                                  07148000
FLCSNPSW EQU   PSA+96                                                   07149000
FLCENPSW EQU   PSA+88                                                   07150000
FLCTRACE EQU   PSA+84                                                   07151000
FLCTIMER EQU   PSA+80                                                   07152000
FLCCVT2  EQU   PSA+76                                                   07153000
FLCCAW   EQU   PSA+72                                                   07154000
FLCCSW   EQU   PSA+64                                                   07155000
FLCIOPSW EQU   PSA+56                                                   07156000
FLCMOPSW EQU   PSA+48                                                   07157000
FLCPOPSW EQU   PSA+40                                                   07158000
FLCSOPSW EQU   PSA+32                                                   07159000
FLCEOPSW EQU   PSA+24                                                   07160000
@NM00029 EQU   FLCICCW2+4                                               07161000
FLCICCW1 EQU   FLCROPSW                                                 07162000
FLCIPPSW EQU   FLCRNPSW                                                 07163000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      07164000
@RC00216 EQU   @RC00207                                                 07165000
@RC00268 EQU   @RC00267                                                 07166000
@RC00361 EQU   @RC00358                                                 07167000
@RT00287 EQU   @EL00004                                                 07168000
@RC00319 EQU   @EL00004                                                 07169000
@RC00408 EQU   @RC00402                                                 07170000
@RC00403 EQU   @RC00402                                                 07171000
@RC00451 EQU   @RC00437                                                 07172000
@RC00445 EQU   @RC00437                                                 07173000
@RC00438 EQU   @RC00437                                                 07174000
@RC00429 EQU   @EL00005                                                 07175000
@RC00554 EQU   @EL00006                                                 07176000
@RT00552 EQU   @EL00006                                                 07177000
@RT00578 EQU   @EL00007                                                 07178000
@RC00585 EQU   @EL00007                                                 07179000
@RC00583 EQU   @EL00007                                                 07180000
@RC00664 EQU   @EL00010                                                 07181000
@RC00728 EQU   @RC00727                                                 07182000
@RC00740 EQU   @RC00739                                                 07183000
@RC00792 EQU   @RC00787                                                 07184000
@RC00815 EQU   @RC00812                                                 07185000
@RC00828 EQU   @RC00827                                                 07186000
@RC00908 EQU   @EL00015                                                 07187000
@RC00945 EQU   @RC00938                                                 07188000
@RC00943 EQU   @RC00938                                                 07189000
@RC00941 EQU   @RC00938                                                 07190000
@RC00939 EQU   @RC00938                                                 07191000
@RC00988 EQU   @EL00019                                                 07192000
@RC00983 EQU   @EL00019                                                 07193000
@RC00981 EQU   @EL00019                                                 07194000
@RC00974 EQU   @EL00019                                                 07195000
@RC00972 EQU   @EL00019                                                 07196000
@RC00970 EQU   @EL00019                                                 07197000
@RC00968 EQU   @EL00019                                                 07198000
@RC00997 EQU   @EL00020                                                 07199000
@RC01016 EQU   @EL00021                                                 07200000
@RC01039 EQU   @EL00022                                                 07201000
@RC01027 EQU   @EL00022                                                 07202000
@RC01046 EQU   @EL00022                                                 07203000
@RC01078 EQU   @EL00023                                                 07204000
@RC01091 EQU   @EL00024                                                 07205000
@RC01116 EQU   @EL00025                                                 07206000
@RC01162 EQU   @EL00028                                                 07207000
@RT01160 EQU   @EL00028                                                 07208000
@PB00032 EQU   @PB00033                                                 07209000
@RT00269 EQU   @RC00268                                                 07210000
@RC00327 EQU   @RC00319                                                 07211000
@RC00409 EQU   @RC00408                                                 07212000
@RT00562 EQU   @RC00554                                                 07213000
@RT00567 EQU   @RC00554                                                 07214000
@RC00665 EQU   @RC00664                                                 07215000
@RC00669 EQU   @RC00664                                                 07216000
@RC00795 EQU   @RC00792                                                 07217000
@RC00793 EQU   @RC00792                                                 07218000
@RT01030 EQU   @RC01027                                                 07219000
@RC01052 EQU   @RC01046                                                 07220000
@RT01094 EQU   @RC01091                                                 07221000
@RC01163 EQU   @RC01162                                                 07222000
@PB00031 EQU   @PB00032                                                 07223000
@RC01167 EQU   @RC01163                                                 07224000
@PB00030 EQU   @PB00031                                                 07225000
@PB00029 EQU   @PB00030                                                 07226000
@PB00028 EQU   @PB00029                                                 07227000
@PB00027 EQU   @PB00028                                                 07228000
@PB00026 EQU   @PB00027                                                 07229000
@PB00025 EQU   @PB00026                                                 07230000
@PB00024 EQU   @PB00025                                                 07231000
@PB00023 EQU   @PB00024                                                 07232000
@PB00022 EQU   @PB00023                                                 07233000
@PB00021 EQU   @PB00022                                                 07234000
@PB00020 EQU   @PB00021                                                 07235000
@PB00019 EQU   @PB00020                                                 07236000
@PB00018 EQU   @PB00019                                                 07237000
@PB00017 EQU   @PB00018                                                 07238000
@PB00016 EQU   @PB00017                                                 07239000
@PB00015 EQU   @PB00016                                                 07240000
@PB00014 EQU   @PB00015                                                 07241000
@PB00013 EQU   @PB00014                                                 07242000
@PB00012 EQU   @PB00013                                                 07243000
@PB00011 EQU   @PB00012                                                 07244000
@PB00010 EQU   @PB00011                                                 07245000
@PB00009 EQU   @PB00010                                                 07246000
@PB00008 EQU   @PB00009                                                 07247000
@PB00007 EQU   @PB00008                                                 07248000
@PB00006 EQU   @PB00007                                                 07249000
@PB00005 EQU   @PB00006                                                 07250000
@PB00004 EQU   @PB00005                                                 07251000
@PB00003 EQU   @PB00004                                                 07252000
@PB00002 EQU   @PB00003                                                 07253000
@ENDDATA EQU   *                                                        07254000
         END   IKTTOMRT,(C'PLS1953',0701,78045)                         07255000
