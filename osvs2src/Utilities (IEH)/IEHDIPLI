         TITLE 'IEHDIPLI-PUT STANDALONE DUMP ON TRACK ZERO'             00050000
IEHDIPLI CSECT                                                          00100000
*********************************************************************** 00110099
*                                                                       00114099
*                    FIXES THIS MODULE                                  00118099
*                    LATEST FIRST.                                      00122099
*                                                                       00126099
*********************************************************************** 00130099
*                                                                       00134099
*C 64700                             SU32 ONLY                 @ZA25515 00138099
*A 88744-88756,329350                SU32 ONLY                 @ZA25515 00142099
*                                                                       00146099
*  NO DELETEION                      SU32                      @G32DSPD 00150099
*                                                                       00154099
*C 65000                             ONLY MVS                  @ZA04429 00158099
*A 64600-64700,137508                ONLY MVS                  @ZA04429 00162099
*                                                                       00166099
*                                                               YM4605  00170099
*********************************************************************   00174099
      EJECT                                                             00178099
*FUNCTION/OPERATION                                                 *   00200000
*   THE IEHDIPLI FUNCTION OF IEHDASDR WRITES THREE TO FIVE RECORDS  *   00250000
*   ON TRACK ZERO OF AN INITIALIZED 2314, 2305, 333X, 3340,    MADRID   00300032
*   OR 3350 VOLUME.                                            MADRID   00310032
*   IF PURGE=YES IS SPECIFIED ON THE IEHDASDR CONTROL CARD          *   00350000
*   ANY PREVIOUSLY WRITTEN RECORDS PAST RECORD THREE WILL BE        *   00400000
*   OVERWRITTEN,THIS INCLUDES ANY ADDITIONAL RECORDS IN THE VOLUME  *   00450000
*   LABEL SET,IPLTEXT,IMDSADMP TEXT,ETC.  IF PURGE =NO IS           *   00500000
*   SPECIFIED(OR DEFAULTED) THE FUNCTION PERFORMS AS FOLLOWS;       *   00550000
*                                                                   *   00600000
*      IF THE TODD DEVICE IS A 2314 AND THE LABEL SET CONTAINS MORE *   00650000
*      THAN THE VOL1 RECORD,THE FUNCTION TERMINATES WITH THE        *   00700000
*      APPROPRIATE MESSAGE TO SYSPRINT. IF NO ADDITIONAL RECORDS ARE*   00750000
*      PRESENT IN THE LABEL SET, THE FUNCTION PROCEEDS.             *   00800000
*                                                                   *   00850000
*      IF THE TODD DEVICE IS 2305, 333X, 3340, OR 3350,        MADRID   00900032
*      THE FUNCTION                                            MADRID   00910032
*      REPLACES THE EXISTING IPL1 AND IPL2 RECORDS WITH USER INPUT  *   00950000
*      RECORDS 1 AND 2. USER INPUT RECORDS 3 THRU 5 FOLLOW THE      *   01000032
*      VOLUME LABEL SET.                                            *   01050000
*                                                              @G32DSPD 01060032
*   RACF AUTHORIZATION REQUIRED (UPDATE) TO PUT IPL TEXT ON    @G32DSPD 01070032
*   VOLUMES THAT ARE DEFINED TO RACF.                          @G32DSPD 01080032
*                                                                   *   01100000
*ENTRY POINT---THE ONLY ENTRY POINT IS IEHDIPLI AND CONTROL IS      *   01150000
*      ALWAYS RECEIVED FROM IEHDASDS.                               *   01200000
*                                                                   *   01250000
*EXITS----NORMAL----A SUCESSFUL COMPLETION RESULTS IN A RETURN TO   *   01300000
*      THE MONITOR WITH A RETURN CODE OF 0 AND A COMPLETE MSG IN    *   01350000
*      THE MSG DATA SET.                                            *   01400000
*EXTERNAL ROUTINES---                                               *   01450000
*      IEHDMSGB--VIA LINK                                           *   01500000
*      IEHDPRNT--VIA LINK                                           *   01550000
*                                                                   *   01600000
*********************************************************************   01650000
*   REGISTER EQUATES                                                    01700000
GR0      EQU   0                                                        01750000
GR1      EQU   1                                                        01800000
GR2      EQU   2                                                        01850000
GR3      EQU   3                                                        01900000
GR4      EQU   4                                                        01950000
GR5      EQU   5                                                        02000000
GR6      EQU   6                                                        02050000
GR7      EQU   7                                                        02100000
GR8      EQU   8                                                        02150000
GR9      EQU   9                                                        02200000
GR10     EQU   10                                                       02250000
GR11     EQU   11                                                       02300000
GR12     EQU   12                                                       02350000
GR13     EQU   13                                                       02400000
GR14     EQU   14                                                       02450000
GR15     EQU   15                                                       02500000
WORKBASE EQU   12                                                       02550000
BASEREG  EQU   11                                                       02600000
         SPACE                                                          02650000
*   DEVICE TYPE EQUATES                                                 02700000
DA       EQU   X'20'                                                    02750000
D2314    EQU   X'08'                    2314                            02800000
D23051   EQU   X'06'                    2305-1                          02850000
D23052   EQU   X'07'                    2305-2                          02900000
D3330    EQU   X'09'                    3330                            02950000
WINCH    EQU   X'0A'                    3340                    XM3772  02960003
D2301    EQU   X'02'                    2301                            03000000
         SPACE                                                          03050000
EXCODE   EQU   X'87'                    EXIT LIST CODE                  03100000
OFOUR    EQU   X'04'                    FMT 4 DSNAME                    03150000
NOEOF    EQU   X'7F'                    FLAG TO NOT WRITE EOF ON CLOSE  03200000
NOWRITE  EQU   X'08'                    DONT WRITE JFCB                 03250000
DOPEN    EQU   X'10'                    SUCCESSFUL OPEN                 03300000
FOUR     EQU   4                        CONSTANT 4                      03350000
FOUR0    EQU   X'40'                   STATUS FOR INCORRECT LENGTH      03400000
IPLREC   EQU   24+144                   SIZE OF IPL1 & IPL2 RECORDS     03450000
THREE    EQU   3                        VALUE THREE                     03500000
L8       EQU   8                        LENGTH OF 8                     03550000
D3       EQU   3                        DISPLACEMENT OF 3        M4720  03560000
D7       EQU   7                        DISPLACEMENT OF 7               03600000
GOOD     EQU   X'7F'                    OH RETURN FROM EXCP             03650000
ERROFF   EQU   X'3F'                    TURNS OFF ERROR FLG IN DCBIFLGS 03700000
IENHEX   EQU   X'0A'                    VALUE HEX 10                    03750000
PERMERR  EQU   X'41'                    PERMANENT EXCP ERROR            03800000
UNITCHC  EQU   X'02'                    CSW UNIT CHECK CONDITION        03860000
ONE      EQU   1                                                        03900000
SENS08   EQU   X'08'                    NO REL FOUND SENSE              03950000
VOLVTOC  EQU   11                       DISP OF VTOC PTR IN VOL1 LABEL  04000000
FIVE     EQU   5                                                        04050000
NAMEDISP EQU   8                        DISPL OF NAME IN MESSAGE        04100000
RET0     EQU   0                        RETURN CODE OF ZERO             04150000
RET8     EQU   8                                                        04200000
DISPZERO EQU   0                        DISPLACEMENT ZERO               04250000
DISP1    EQU   1                       DISPLACEMENT OF 1                04300000
DISP2    EQU   2                       DISPLACEMENT OF 2                04350000
DISP19   EQU   19                       DISPLACEMENT                    04400000
DISP49   EQU   49                       DISPLACEMENT                    04450000
L3       EQU   3                        LENGTH 3                YM4605  04500002
L4       EQU   4                        LENGTH 4                        04510002
L5       EQU   5                        LENGTH 5                        04550000
L11      EQU   11                       LENGTH 11                       04600000
L6       EQU   6                        LENGTH 6                        04650000
L43      EQU   43                       LENGTH 43                       04700000
L78      EQU   78                       LENGTH OF 78                    04750000
KEYL0    EQU   X'00'                    2314 IPL3,4,5 KEY LENGTH        04760000
ATE      EQU   X'08'                    2314 WRITE CKD CCW CNT          04770000
REC4     EQU   X'04'                    RECORD NUMBER                   04800000
REC5     EQU   X'05'                    RECORD NUMBER                   04850000
REC6     EQU   X'06'                    RECORD NUMBER                   04900000
OTHREE   EQU   X'03'                    VALUE THREE HEX                 04950000
TWLV     EQU   X'0C'                    NON 2314 WRITE CKD CCW CNT      04960000
TWO      EQU   2                        VALUE TWO                       05000000
SERDISP  EQU   40                       DISP OF SERIAL # IN MESSAGE     05050000
SEARDISP EQU   38                       DISPLACEMENT INTO IPL2 RECORD   05100000
*                                       OF THE SEARCH ADDRESS.          05150000
WTDATA   EQU   X'05'                    WRITE DATA COMMAND CODE         05200000
BIGREC   EQU   X'10'                    GREATER THAN 2K INPUT REC       05250000
CCSILI   EQU   X'40'                    SET CMD CHAIN                   05300000
ENDCCW   EQU   X'00'                    SET TO END CCW CHAIN            05350000
CCWMASK  EQU   X'07'                    MASK TO STORE ADDR IN CCW       05400000
VOLIDOFF EQU   62                       VOLID OFFSET FOR IEH852 YM4605  05410002
UNITOFF  EQU   69                       IEH852 UCBNAME OFFSET   YM4605  05420002
JOBNOFF  EQU   74                       IEH852 JOBNAME OFFSET   YM4605  05430002
STEPOFF  EQU   84                       IEH852 STEPNAME OFFSET  YM4605  05440002
*********************************************************************** 05450000
*   MESSAGE EQUATES                                                   * 05500000
*                                                                     * 05550000
*********************************************************************** 05600000
MESSG6   EQU   6                                                        05650000
MESSG5   EQU   5                                                        05700000
MESSG10  EQU   10                                                       05750000
MESSG13  EQU   13                                                       05800000
MESSG14  EQU   14                                                       05850000
MESSG34  EQU   34                                                       05900000
MESSG99  EQU   99                                                       05950000
MESSG70  EQU   70                                                       06000000
MESSG71  EQU   71                                                       06050000
MESSG72  EQU   72                                                       06100000
MSG66I   EQU   66                       IEH866I OFFSET         @G32DSPD 06110032
         SPACE                                                          06150000
         USING WORK,WORKBASE            SET UP WORK AREA BASE           06200000
         USING FUNCBLK,GR10             SET UP FUNCTION BLOCK BASE      06250000
         USING IEHMAIN,BASEREG          SET UP PROGRAM BASE             06300000
         SPACE                                                          06350000
IEHMAIN  SAVE  (14,12),T,IEHDIPLI       SAVE REGISTER FOR CALLER        06400000
         LR    BASEREG,GR15             ESTABLISH PROGRAM ADDRESSABILIT 06450000
         B     APARNO                   BRANCH AROUND APAR NO  @ZA04429 06460032
         DC    C'SU32 OZ25515'          LAST FIX THIS MOD      @ZA25515 06470099
APARNO   LA    GR7,IPLISAV              SAVE AREA ADDRESS      @ZA04429 06500032
         ST    GR7,L8(GR13)             ADDR OF NEW AREA TO OLD         06550000
         ST    GR13,FOUR(GR7)           ADDR OF OLD AREA TO NEW         06600000
         LR    GR13,GR7                 LOAD SAVE AREA ADDR             06650000
         SPACE                                                          06700000
         L     GR4,TUCBPTR              ADDR OF UCB                     06750000
         USING UCB,GR4                                                  06800000
*   CHECK FOR ACCEPTABLE DEVICE                                         06850000
         TM    UCBTBYT3,DA              DIRECT ACCESS DEVICE ?          06900000
         BZ    BADEVICE                 NO- PREPARE FOR ERROR RETURN    06950000
         CLI   UCBTBYT4,D23051          DEVICE A 2305-1?                07100000
         BL    NOTOKDEV                 BRANCH IF LOW          XL03145  07150003
         SPACE                                                          07500000
DEVOK    EQU   *                                                        07550000
         TM    SRTESTAT,SRTESYSR        IS THIS VOLUME SYSTEM RESIDENT  07600000
         BO    BADDEV                   YES-SET UP ERROR MESSAGE        07650000
*********************************************************************** 07700000
*                                                                     * 07750000
*   THIS ROUTINE OPENS THE OUTPUT DATA CONTROL BLOCK. THE OPEN        * 07800000
*   IS PERFORMED ON THE FORMAT FOUR DSCB OF THE VTOC                  * 07850000
*                                                                     * 07900000
*********************************************************************** 07950000
         LA    GR5,OUTDCB               OUTPUT DCB ADDRESS              08000000
         USING IHADCB,GR5                                               08050000
         MVC   DCBDDNAM,DDNAME2         PUT DDNAME IN DCB               08100000
         MVC   OPENLST+ONE(THREE),WRDCBAD+ONE   DCB ADDRESS TO LIST     08150000
         LA    GR9,RDBUFF               BUFFER ADDR TO READ JFCB        08200000
         ST    GR9,LIST                 STORE ADDRESS IN LIST           08250000
         MVI   LIST,EXCODE              EXIT LIST CODE                  08300000
         RDJFCB MF=(E,OPENLST)                                          08350000
         USING JFCB,GR9                                                 08400000
         MVI   JFCBDSNM,OFOUR           SET DSNAME FIELD FOR            08450000
         MVC   JFCBDSNM+ONE(L43),JFCBDSNM  FORMAT 4 DSCB                08500000
         MVI   JFCBTSDM,NOWRITE         STOP WRITE OF JFCB AT OPEN      08550000
         OPEN  MF=(E,OPENLST),TYPE=J                                    08600000
         TM    DCBOFLGS,DOPEN           WAS OPEN SUCCESSFUL             08650000
         BZ    NOOPEN                   NO GIVE AN ERROR MESSAGE        08700000
         BAL   GR7,WTOR                 PROMPT OPER             YL02912 08710002
         LA    GR7,OUTIOB               IOB ADDRESS                     08750000
         ST    GR7,DCBIOBAD             IN DCB                          08800000
         DROP  GR9                                                      08850000
*********************************************************************** 08852032
*       THIS SECTION OF CODE TEST THE RACF AUTHORIZATION OF THE USER. * 08854032
*  THE USER MUST HAVE UPDATE AUTHORITY IN ORDER TO PUT IPL TEXT ON    * 08856032
*  THE PACK IF THE PACK IS RACF DEFINED. IF RACF IS NOT ACTIVE  IN    * 08858032
*  THE SYSTEM AUTHORIZATION CHECKS ARE NOT MADE.                      * 08860032
*********************************************************************** 08862032
         L     GR9,CVTPTR              GET CVT PTR             @G32DSPD 08864032
         USING CVT,GR9                                         @G32DSPD 08866032
         L     GR9,CVTRAC              GET RACF POINTER        @G32DSPD 08868032
         DROP  GR9                                             @G32DSPD 08870032
         LTR   GR9,GR9                 TEST RACF POINTER       @G32DSPD 08872032
         BZ    NULLRACF                NULL IF RACF NOT ACTIVE @G32DSPD 08874032
         USING RCVT,GR9                DO CHECK IF RACF IS     @ZA25515 08874499
         TM    RCVTSTA1,RCVTDASD       CURRENT.                @ZA25515 08874899
         BZ    NULLRACF                NO NOT CURRENT          @ZA25515 08875299
         DROP  GR9                     YES DO RACHECK          @ZA25515 08875699
         MVC   RACVOL,UCBVOLI          GET VOLID FROM UCB      @G32DSPD 08876032
         RACHECK ATTR=UPDATE,ENTITY=RACVOL,CLASS='DASDVOL'     @G32DSPD 08878032
         CLM   GR15,B'0001',RC8        TEST FOR UNAUTHORIZED   @G32DSPD 08880032
         BE    UNAUTH                  YES,GO TERMINATE        @G32DSPD 08882032
NULLRACF EQU   *                                               @G32DSPD 08884032
         SPACE 2                                               @G32DSPD 08886032
*   READ IN THE VOLUME LABEL TO VERIFY THAT THE OUTPUT VOLUME           08900000
*   IS NOT A DOS VOLUME WITH THE VTOC ON CYL 0 TRACK 0.                 08950000
         LA    GR7,RDVOL1               CCW ADDRESS                     09000000
         ST    GR7,OUTCCWA              PUT IN IOB                      09050000
         XC    OUTSEEK(L8),OUTSEEK      SET IOB SEEK FIELD TO           09100000
*                                       CYL 0 TRACK 0                   09150000
         EXCP  OUTIOB                                                   09200000
         WAIT  ECB=OUTECB                                               09250000
         CLI   OUTECB,GOOD              OK RETURN ?                     09300000
         BNE   IOERR                    BRANCH IF NO                    09350000
         CLC   VOL1BUF(L4),VOL1         GOOD VOL1 RECORD         M4720  09360000
         BNE   IOERR                    NO, PUT OUT ERROR MESS   M4720  09370000
         OC    VOL1BUF+VOLVTOC(L4),VOL1BUF+VOLVTOC  VTOC ON      YM3041 09400002
*                                       CYL 0, HEAD 0 ?                 09450002
         BZ    DOSVOLER                 BRANCH IF ZERO                  09500000
         SPACE                                                          09550000
*   IS PURGE = YES SPECIFIED?                                           09600000
         TM    SEQSW+ONE,PURGE          PURGE=YES SPECIFIED?            09650000
         BNO   RDLABELS                 NO-BRANCH TO READ VOL LABEL SET 09700000
*   INITIALIZE THE SEARCH ADDRESS FOR THE IPL2 RECORD TO RECORD 4.      09750000
         MVI   SEARCHAD+FOUR,OFOUR      SET REC # TO FOUR               09800000
         MVI   SLAST+FOUR,OTHREE        SET REC # FOR OUTPUT SEARCH.    09850000
*   INSERT RECORD NUMBER IN OUTPUT CCW COUNT FIELDS                     09900000
         MVI   IPLCK3R,REC4             RECORD FOUR IN CCW COUNT FIELD  09950000
         MVI   IPLCK4R,REC5             RECORD FIVE IN CCW COUNT FIELD  10000000
         MVI   IPLCK5R,REC6             RECORD SIX IN CCW COUNT FIELD   10050000
*   OPEN INPUT DCB AND GET CORE FOR INPUT RECORDS.                      10100000
*   THE NUMBER OF BYTES FOR INPUT BUFFER EQUALS 3 TIMES THE             10150000
*   DCBBLKSI PLUS 24 PLUS 144, ALL ROUNDED TO AD WORD BOUNDARY.         10200000
OPENIN   EQU   *                                                        10250000
         LA    GR5,INDCB                ADDRESS OF INPUT DCB            10300000
         MVC   DCBDDNAM(L8),DDNAME1     MOVE DDNAME INTO DCB            10350000
         OPEN  INDCB                    OPEN INPUT DCB                  10400000
         TM    DCBOFLGS,DOPEN           SUCCESSFUL OPEN?                10450000
         BZ    NOOPENIN                 NO - PRINT MESSAGE              10500000
         L     GR3,GETLEN               LOAD LENGTH FOR GETMAIN         10550000
         GETMAIN R,LV=(GR3)                                             10600000
         LR    GR6,GR1                  SAVE BUFFER ADDRIN GR6          10650000
         SR    GR3,GR3                  INITIALIZE FOR RECORD COUNT     10700000
         ST    GR1,COREADR              SAVE ADDRESS OF GOTTEN CORE     10750000
         BAL   GR9,GETIN                BRANCH TO READ 1ST REC          10800000
         CLC   DCBLRECL,TWFOUR+DISP2    LENGTH = 24?                    10850000
         BNE   LENERR                   NO-BRANCH-WRONG LENGTH          10900000
         STCM  GR1,CCWMASK,ADDR1+DISP1  STORE DATA ADDR IN CCW          10950000
         AH    GR6,DCBLRECL             ADD REC LENGTH TO BUFFER PTR.   11000000
         BAL   GR9,GETIN                GET RECORD 2.                   11050000
         CLC   DCBLRECL,ONE44           LENGTH = 144                    11100000
         BNE   LENERR                   NO-BRANCH-WRONG LENGTH          11150000
         STCM  GR1,CCWMASK,ADDR2+DISP1  STORE DATA ADDR IN CCW          11200000
         MVC   SEARDISP(L5,GR1),SEARCHAD MOVE SEARCH ADDR TO IPL2       11250000
         AH    GR6,DCBLRECL             ADD REC LENGTH TO BUFFER PTR    11300000
         BAL   GR9,GETIN                READ 3RD RECORD.                11350000
         ST    GR1,ADDR3                STORE DATA ADDR IN CCW.         11400000
         AH    GR6,DCBLRECL             ADD REC LENGTH TO BUFFER PTR    11450000
         MVC   DLEN3,DCBLRECL           MOVE REC LENGTH INTO OUTPUT CCW 11500000
         MVC   IPLCK3L,DCBLRECL         MOVE REC LENGTH TO OUTPUT COUNT 11550000
         MVI   FLAG3,CCSILI             SET CC IN CCW                   11600000
         XC    LARGREC,LARGREC          SET FLAG TO ZERO                11650000
         CLC   DCBLRECL,TWOK            INPUT REC > 2048 BYTES?         11700000
         BNH   GETFOUR                  BRANCH IF LOW OR EQ             11750000
         OI    LARGREC,BIGREC           SET 2 REC MAX FLAG IF HIGH      11800000
GETFOUR  EQU   *                                                        11850000
         BAL   GR9,GETIN                GET 4TH RECORD                  11900000
         ST    GR1,ADDR4                STORE DATA ADDR IN CCW.         11950000
         AH    GR6,DCBLRECL             ADD REC LENGTH TO BUFFER PTR    12000000
         MVC   DLEN4,DCBLRECL           MOVE REC LENGTH INTO OUTPUT CCW 12050000
         MVC   IPLCK4L,DCBLRECL         MOVE REC LENGTH TO OUTPUT COUNT 12100000
         MVI   FLAG4,CCSILI             SET CC IN CCW                   12150000
         CLC   DCBLRECL,TWOK            INPUT REC > 2048 BYTES?         12200000
         BH    ENDIN                    PRETEND EOF AFTER 4 RECS        12250000
*                                       IF REC > 2048                   12300000
         TM    LARGREC,BIGREC           WAS 2 REC SWITCH SET BY REC 4?  12350000
         BO    ENDIN                    PRETEND EOF AFTER 4 RECS IF     12400000
*                                       ANY > 2048 BYTES                12450000
         BAL   GR9,GETIN                GET 5TH RECORD                  12500000
         ST    GR1,ADDR5                STORE DATA ADDR IN CCW          12550000
         MVC   DLEN5,DCBLRECL           MOVE REC LENGTH INTO OUTPUT CCW 12600000
         MVC   IPLCK5L,DCBLRECL         MOVE REC LENGTH TO OUTPUT COUNT 12650000
         CLC   DCBLRECL,TWOK            INPUT REC > 2048 BYTES?         12700000
         BH    LENERR                   TOO LARGE IF > 2048             12750000
WRITOUT  EQU   *                                                        12800000
         LA    GR5,OUTDCB               DCB ADDRESS                     12850000
         LA    GR9,CCWOUT               STORE CCW ADDRESS               12900000
         ST    GR9,OUTCCWA              IN IOB                          12950000
         XC    OUTSEEK(L8),OUTSEEK      INIT IOB SEEK TO CYL 0 HEAD 0   13000000
         L     GR4,TUCBPTR              LOAD UCB ADDR OF O/P DEVICE     13010000
         CLI   UCBTBYT4,D2314           THIS A 2314 DEVICE              13030000
         BE    SET2314                  YES, BRCH                       13040000
         MVI   IPLCHKL3,REC4            SET IPL3 KEY LENGTH FLD         13042000
         MVI   IPLCHKL4,REC4            SET IPL4 KEY LENGTH FLD         13044000
         MVI   IPLCHKL5,REC4            SET IPL5 KEY LENGTH FLD         13046000
         MVI   CCWOUT3+D7,TWLV          SET IPL3 CCW CNT FLD            13046400
         MVI   CCWOUT4+D7,TWLV          SET IPL4 CCW CNT FLD            13046800
         MVI   CCWOUT5+D7,TWLV          SET IPL5 CCW CNT FLD            13047200
DOIT     EQU   *                                                        13048000
         EXCP  OUTIOB                                                   13050000
         WAIT  ECB=OUTECB                                               13100000
         CLI   OUTECB,GOOD              GOOD RETURN FROM I/O ?          13150000
         BNE   IOERR                    NO-BRANCH                       13200000
FINISH   EQU   *                        SET UP SUCCESSFUL COMPLETION    13250000
*                                       MESSAGE                         13300000
         LA    GR1,MESSG6               MESSAGE NUMBER                  13350000
         BAL   GR9,MSGBLD              GO BUILD MESSAGE                 13400000
         MVC   0(L8,GR1),DDNAME2        PUT DDNAME IN MESSAGE           13450000
         MVC   SERDISP(L6,GR1),UCBVOLI    PUT SERIAL NUMBER IN MESSAGE  13500000
         L     GR4,TUCBPTR              ADDRESS OF UCB                  13550000
         MVC   MESS+NAMEDISP(NAMELEN),NAME MODULE NAME IN MESSAGE       13600000
         LA    GR9,GOODRTN                                              13650000
         B     MSGPRNT                  GO PRINT MESSAGE                13700000
         EJECT                                                          13700102
*********************************************************************** 13700802
*        THE FOLLOWING ROUTINE WILL PROMPT THE OPERATOR TO              13701202
*        ALLOW PROCESSING TO CONTINUE.                                  13701602
*********************************************************************** 13701702
WTOR     EQU   *                                                YL02912 13701802
         USING UCB,GR3                                                  13701902
         L     GR3,TUCBPTR              GET TODD UCB ADDR       YL02192 13706402
         MVC   PUTMSG+VOLIDOFF(L6),SRTEVOLI VOLID TO MESS 852   YM4605  13710402
         MVC   PUTMSG+UNITOFF(L3),UCBNAME   UNIT ADDR TO MSG    YM4605  13710802
         L     GR3,CVTPTR               GET CVT ADDR            YL02912 13710902
         USING CVT,GR3                                                  13714702
         L     GR3,CVTTCBP              GET CURRENT TCB ADDR    YL02912 13716702
         L     GR3,L4(GR3)              INCRE TO CURRENT TCB    YL02912 13716802
         USING TIOT,GR3                                                 13717102
         L     GR3,TIOTOFF(GR3)         GET TIOT PTR            YL02912 13717502
         MVC   PUTMSG+JOBNOFF(L8),TIOCNJOB JOBNAME TO MSG        YM4605 13717902
         MVC   PUTMSG+STEPOFF(L8),TIOCSTEP MOVE STEPNAME TO MSG  YM4605 13718302
         DROP  GR3                                                      13726402
PUTMSG   WTOR  'IEH852D REQUEST PERMISSION TO PUT IPL-TEXT ON VVVVVV/CU*13729602
               U, JJJJJJJJ, SSSSSSSS',REPLY,1,DSKECB,                  *13732802
               ROUTCDE=(4),DESC=(2)                                     13736002
         TM    DSKECB,COMPLETE          ANWSER YET ?            YL02192 13739202
         BO    OK                       YES, AVOID WAIT         YL02192 13742402
         WAIT ECB=DSKECB                                                13745602
OK       EQU   *                                                YL02912 13748802
         MVI   DSKECB,X'00'             CLEAR FIRST ECB BYTE   @ZA04429 13750832
         CLI   REPLY,C'U'               OPERATOR SAY USE IT ?   YL02192 13752002
         BE    XIT7                     YES, RETURN ON REG 7    YL02192 13755202
         CLI   REPLY,C'T'               OPER SAY DONT USE ?     YL02192 13758402
         BNE   PUTMSG                   RE=ISSUE MSG            YL02192 13761602
         B     SETCODE                  SET RC=8                YL02912 13764802
XIT7     BR    GR7                      EXIT                    YL02912 13768002
SET2314  EQU   *                                                        13771202
         MVI   IPLCHKL3,KEYL0           SET IPL3 KEY LENGTH FLD         13774402
         MVI   IPLCHKL4,KEYL0           SET IPL4 KEY LENGTH FLD         13777602
         MVI   IPLCHKL5,KEYL0           SET IPL5 KEY LENGTH FLD         13780802
         MVI   CCWOUT3+D7,ATE           SET IPL3 CCW CNT FLD            13784002
         MVI   CCWOUT4+D7,ATE           SET IPL4 CCW CNT FLD            13787202
         MVI   CCWOUT5+D7,ATE           SET IPL5 CCW CNT FLD            13790402
         B     DOIT                     GO ISSUE EXCP                   13793602
MSGBLD   EQU   *                                                        13796802
         LINK  EP=IEHDMSGB              GO CONSTRUT MESSAGE             13800000
         BR    GR9                      RETURN                          13850000
MSGPRNT  EQU   *                                                        13900000
         LINK  EP=IEHDPRNT              GO PRINT MESSAGE                13950000
         BR    GR9                      RETURN                          14000000
*********************************************************************** 14050000
*                                                                     * 14100000
*   READ THE VOLUME LABEL SET AND DETERMINE HOW MANY                  * 14150000
*   LABELS IT CONTAINS. THEN SET THE SEARCH ADDRESS                   * 14200000
*   OF THE OUTPUT CCW CHAIN TO THE LAST VOLUME LABEL IN THE           * 14250000
*   SET.                                                              * 14300000
*                                                                     * 14350000
*********************************************************************** 14400000
RDLABELS EQU   *                                                        14450000
         LA    GR9,RDVOLX               ADDRESS OF CCW CHAIN     M4720  14500000
         ST    GR9,OUTCCWA              STORE IN IOB                    14550000
         XC    OUTSEEK(L8),OUTSEEK      INIT IOB SEEK FIELD TO ZEROS    14600000
         MVI   OUTSEEK+D7,REC4          SET SEEK ADDR FOR VOL2-8 M4720  14600400
         LA    GR9,VOL1                 SETUP VOLX BASE REG      M4720  14602000
         USING VOLX,GR9                 ISSUE USING FOR DSECT    M4720  14604000
*        VOL1 - VOL8 CONSTANTS MUST BE IN CONSEQUTIVE LOCATIONS  M4720  14606000
SEEKVOLX EQU   *                                                 M4720  14610000
         LA    GR9,L4(GR9)              INCRE VOLX BASE REG      M4720  14620000
         EXCP  OUTIOB                                                   14650000
         WAIT  ECB=OUTECB                                               14700000
         CLI   OUTECB,GOOD              OK RETURN ?                     14750000
         BE    TSTVOLX                  BRANCH IF YES.           M4720  14800000
         CLI   OUTECB,PERMERR           PERM ERROR ?                    14850000
         BE    UNITCHK                  YES, GO CHK FOR UNIT CHK M4720  14860000
         B     IOERR                    NO - MUST BE UNHANDLEABLE       14900000
TSTVOLX  EQU   *                                                 M4720  14902000
         CLC   VOL1BUF(L4),VOLX         GOOD VOL2-8 LABEL        M4720  14904000
         BNE   SETCCW2                  NO, BRCH                 M4720  14906000
         CLC   VOLX(L4),VOL8            THIS THE LAST USER LAB   M4720  14908000
         BE    SETCCW1                  YES, BRCH                M4720  14908800
         SR    GR7,GR7                  ZERO WORK REG            M4720  14909200
         IC    GR7,OUTSEEK+D7           GET # OF LAST REC READ   M4720  14909600
         LA    GR7,1(GR7)               INCRE IT BY 1            M4720  14909700
         STC   GR7,OUTSEEK+D7           UPDATE SEEK ADDR         M4720  14909800
         B     SEEKVOLX                 GO READ NEXT VOL2-8 REC  M4720  14909900
         DROP  GR9                                               M4720  14923200
UNITCHK  EQU   *                                                 M4720  14936700
         TM    OUTSTAT+FOUR,UNITCHC     DID UNIT CHECK OCCUR?           14950000
         BNO   CHECKMOR                 NO - CHECK FOR WRONG LENGTH     15000000
         TM    OUTSENS+ONE,SENS08       NO RECORD FOUND?         M4720  15050000
         BO    SETCCW2                  YES - SET OUTPUT CCW'S          15100000
         B     IOERR                    UNSOLVABLE PROBLEM              15150000
CHECKMOR EQU   *                                                        15200000
         TM    OUTSTAT+FIVE,FOUR0       WRONG LENGTH RECORD?            15250000
         BNO   IOERR                    BRANCH TO I/O ERROR ROUT IF NO. 15300000
SETCCW2  EQU   *                                                        15350000
         NI    DCBIFLGS,ERROFF          TURN OFF PERM ERROR FLAG        15400000
         SR    GR7,GR7                  ZERO WORK REG            M4720  15450000
         IC    GR7,OUTSEEK+D7           GET LAST REC SOUGHT      M4720  15500000
TST2314  EQU   *                                                XM6295  15510000
         S     GR7,FFOUR                SUBTRACT 4 TO FIND DISPL M4720  15550000
*                                       PAST VOL1 RECORD         M4720  15600000
         CLI   UCBTBYT4,WINCH           3340 DEVICE ?           XM3772  15650003
         BNE   T2314                    NO, BRCH                XM3772  15700003
         CH    GR7,TWOO                 DO WE HAVE ONLY TWO     XM3772  15750003
*                                       USER VOLUME LABELS ?    XM3772  15800003
         BH    TOMANY                   NO, MORE THAN TWO       XM3772  15850003
         B     SETCCW2A                 ONLY 2 USER LABELS, BRCH XM3772 15900003
T2314    EQU   *                                                XM3772  15950003
         CLI   UCBTBYT4,D2314          VOLUME A 2314 ?                  16050000
         BNE   SETCCW2A                NO, CONTINUE                     16100000
         LTR   GR7,GR7                 YES, ANY ADDITIONAL LABELS ?     16150000
         BNZ   TOMANY                  BRANCH TO ERROR IF YES           16200000
SETCCW2A LA    GR7,FOUR(GR7)            ADD 4 TO ALLOW FOR IPL1, IPL2,  16250000
*                                       AND VOL1 RECORDS AND POINT      16300000
*                                       PAST THE LAST LABEL IN THE      16350000
*                                       LABEL SET.                      16400000
         SPACE                                                          16450000
SETCCW3  EQU   *                                                        16500000
         STC   GR7,SEARCHAD+FOUR        SAVE REC # TO BE PUT IN         16550000
*                                       SEARCH ADDRESS OF IPL2 RECORD.  16600000
         BCTR  GR7,GR0                  SUBTRACT ONE FROM REC # TO      16650000
*                                       POINT TO LAST LABEL IN VOL      16700000
*                                       LABEL SET.                      16750000
         STC   GR7,SLAST+FOUR           STORE REC # IN SEARCH ADDR      16800000
*                                       FOR OUTPUT CCW'S                16850000
         LA    GR7,ONE(GR7)             CALC REC # OF 3RD OUTPUT REC    16900000
         STC   GR7,IPLCK3R              STORE IN COUNT FIELD            16950000
         LA    GR7,ONE(GR7)             CALC REC # OF 4TH OUTPUT REC    17000000
         STC   GR7,IPLCK4R              STORE IN COUNT FIELD            17050000
         LA    GR7,ONE(GR7)             CALC REC # OF 5TH OUTPUT REC    17100000
         STC   GR7,IPLCK5R              STORE IN COUNT FIELD            17150000
         B     OPENIN                   BRANCH TO OPEN INPUT DCB        17200000
*   CONTROL BRANCHES HERE IF LABEL SET HAS EIGHT RECORDS.               17250000
SETCCW1  EQU   *                                                        17300000
         LA    GR7,L11                  REC NO. FOR IPL2 SEARCH ADDR    17350000
         B     TST2314                  GO TEST FOR 2314        XM6295  17400000
GOODRTN  EQU   *                                                        17450000
         LA    GR15,RET0                LOAD RETURN CODE                17500000
         L     GR3,PTRCFUNC             PICK UP PTR TO CURRENT FUNC.    17550000
         MVI   DISPZERO(GR3),COMPLETE   SET COMPLETE                    17600000
         B     ENDUP                    GO TO CLOSE                     17650000
IOERR    EQU   *                                                        17700000
         LA    GR1,MESSG13              I/O ERROR MESSAGE #.            17750000
         BAL   GR9,MSGBLD               BUILD MESSAGE                   17800000
         SYNADAF ACSMETH=EXCP,PARM1=OUTIOB                              17850000
         MVC   MESS+DISP19(L78),DISP49(GR1) PUT I/O INFO IN BUFFER      17900000
         SYNADRLS                                                       17950000
ERRPRNT  BAL   GR9,MSGPRNT              GO PRINT ERROR MESSAGE          18000000
SETCODE  LA    GR15,RET8                SET UP RETURN CODE ERROR        18050000
         LA    GR2,RET8                 SET RETURN CODE                 18100000
         LA    GR5,INDCB                INPUT DCB ADDRESS               18150000
         TM    DCBOFLGS,DOPEN           IS INPUT DCB OPEN?              18200000
         BNO   CLOSOUT                  IF NOT , DONT CLOSE IT          18250000
ENDUP    EQU   *                                                        18300000
         LR    GR2,GR15                 SAVE RETURN CODE                18350000
         L     GR3,GETLEN               NUMBER OF BYTES TO FREE         18400000
         L     GR6,COREADR              ADDRESS OF GOTTEN CORE          18450000
         FREEMAIN R,LV=(GR3),A=(GR6)                                    18500000
CLOSIN   CLOSE INDCB                    CLOSE INPUT DCB                 18550000
CLOSOUT  LA    GR5,OUTDCB               POINT TO OUTPUT DCB             18600000
         NI    DCBWRITE,NOEOF           PREVENT WRITE OF EOF            18650000
         CLOSE OUTDCB                                                   18700000
         SPACE                                                          18750000
         LR    GR15,GR2                 RESTORE RETURN CODE             18800000
GOBACK   L     GR13,IPLISAV+FOUR                                        18850000
         RETURN (14,12),T,RC=(15)       RETURN WIHT PROPER CODE         18900000
*   GET A RECORD FROM THE INPUT DATA SET -- MOVE MODE.                  18950000
*   REGISTER 6 MUST POINT TO THE INPUT AREA. REG 3 COUNTS RECORDS.      19000000
*   REGISTER 9 IS THE RETURN REGISTER.                                  19050000
         SPACE                                                          19100000
GETIN    EQU   *                                                        19150000
         GET   INDCB,(GR6)                                              19200000
         LA    GR3,ONE(GR3)             INCREMENT INPUT REC COUNT       19250000
         BR    GR9                      RETURN TO CALLER.               19300000
*  END OF DATA ROUTINE IS BRANCHED TO WHEN EOF IS REACHED ON            19350000
*   INPUT.                                                              19400000
*   ON ENTRY REGISTER 3 CONTAINS THE COUNT OF INPUT RECORDS             19450000
         SPACE                                                          19500000
ENDIN    EQU   *                                                        19550000
         CH    GR3,HTHREE               MINIMUM 3 RECORDS ?             19600000
         BL    LENERR                   NO - BRANCH - TOO FEW RECORDS   19650000
         BNE   INIT5                    START INIT OF TRACK ZERO        19700000
         MVI   FLAG3,ENDCCW             SET TO STOP OUTPUT AFTER 3 REC  19750000
         B     WRITOUT                  GO WRITE OUTPUT RECS            19800000
INIT5    EQU   *                                                        19850000
         MVI   FLAG4,ENDCCW             SET TO STOP OUTPUT AFTER REC 4  19900000
         B     WRITOUT                  GO WRITE TRACK 0                19950000
NOOPEN   EQU   *                                                        20000000
         LA    GR1,MESSG5               BAD OPEN  ON OUTPUT DCB         20050000
         B     ERRSET                   GO TO ERROR                     20100000
NOOPENIN EQU   *                                                        20150000
         LA    GR1,MESSG5               MESSAGE NUMBER                  20200000
         BAL   GR9,MSGBLD               GO BUILD MESSAGE                20250000
         MVC   DISPZERO(L8,GR1),DDNAME1 PUT DDNAME IN MESSAGE           20300000
PRINTERR BAL   GR9,MSGPRNT              GO PRINT MESSAGE                20350000
         LA    GR2,RET8                 RETURN CODE                     20400000
         B     CLOSOUT                  CLOSE OUTPUT DCB AND RETURN     20450000
BADEVICE EQU   *                                                        20500000
         LA    GR1,MESSG10              INCORRECT DEVICE                20550000
ERRSET   EQU   *                                                        20600000
         BAL   GR9,MSGBLD               GO BUILD MESSAGE                20650000
         MVC   DISPZERO(L8,GR1),DDNAME2 PUT DDNAME IN MESSAGE           20700000
         B     PRINTMSG                 PRINT MSG                       20750000
BADDEV   EQU   *                                                        20800000
         LA    GR1,MESSG14              DEVICE IS SYTEM RESIDENCE       20850000
         BAL   GR9,MSGBLD               GO BUILD MESSAGE                20900000
         MVC   DISPZERO(L8,GR1),DDNAME2 PUT DD NAME IN MESSAGE          20950000
         B     PRINTMSG                 GO PRINT MESSAGE                21000000
NOTOKDEV EQU   *                        DEVICE NOT SUPPORTED            21050000
         LA    GR15,MESSG34             LOAD MESSAGE #                  21100000
         BAL   GR9,MSGBLD               GO BUILD MESSAGE                21150000
         MVC   DISPZERO(L8,GR1),DDNAME2 PUT DD NAME IN MESSAGE          21200000
         B     PRINTMSG                 GO PRINT MESSAGE                21250000
PRINTMSG EQU   *                                                        21300000
         BAL   GR9,MSGPRNT              GO PRINT MESSAGE                21350000
         LA    GR15,RET8                RETURN CODE                     21400000
         B     GOBACK                   BRANCH TO RETURN                21450000
TOMANY   EQU   *                        USER HAS >1 LABEL ON 2314       21500000
*                                       AND PURGE NOT REQUESTED         21550000
         LA    GR1,MESSG71             LOAD MESSAGE NUMBER              21600000
         BAL   GR9,MSGBLD               GO BUILD MESSAGE                21650000
         MVC   DISPZERO(L8,GR1),DDNAME2 MOVE DDNAME TO MESSAGE          21700000
         B     PRINTERR                 GO PRINT MESSAGE                21750000
LENERR   EQU   *                       INPUT NOT MIN 3 RECS OR          21800000
*                                       WRONG LENGTH RECORDS            21850000
         LA    GR1,MESSG70             LOAD MESSAGE NUMBER              21900000
         BAL   GR9,MSGBLD              GO BUILD MESSAGE                 21950000
         MVC   DISPZERO(L8,GR1),DDNAME1 PUT DDNAME IN MESSAGE           22000000
         B     ERRPRNT                 GO PRINT MESSAGE                 22050000
DOSVOLER EQU   *                        DOS VOLUME HAS VTOC ON          22100000
*                                       CYL 0 TRK 0.                    22150000
         LA    GR1,MESSG72              MESSAGE NUMBER                  22200000
         BAL   GR9,MSGBLD               GO BUILD MESSAGE                22250000
         MVC   DISPZERO(L8,GR1),DDNAME2 PUT DDNAME IN MESSAGE           22300000
         B     PRINTERR                 GO PRINT MESSAGE                22350000
* RACF AUTHORIZATION HAS FAILED PRINT MESSAGE AND TERMINATE    @G32DSPD 22351032
UNAUTH   LA    GR1,MSG66I              SET FOR MSG IEH866I     @G32DSPD 22352032
         BAL   GR9,MSGBLD              GO GET MESSAGE TEXT     @G32DSPD 22353032
         MVC   0(L'PUTIPLNM,GR1),PUTIPLNM  INDICATE PUTIPL     @G32DSPD 22354032
         MVC   20(L'DDNAME2,GR1),DDNAME2  INDICATE DDNAME      @G32DSPD 22355032
         B     PRINTMSG                GO PRINT MESSAGE        @G32DSPD 22356032
TWOO     DC    H'2'                     NO. OF ALLOWABLE USER   XM3772  22360003
*                                       VOLUME LABELS FOR 3340. XM3772  22370003
LIST     DS    0F                       FOR REAN IN JFCB                22400000
         DC    X'87'                   LIST                             22450000
         DC    AL3(0)                  LIST                             22500000
OPENLST  RDJFCB (,(OUTPUT)),MF=L       PARMAMETER LIST FOR OPEN         22550000
RACVOL   DS    CL6                      VOLSER TO RACHECK      @G32DSPD 22552032
RC8      DC    AL1(8)                   NOT DEFINED RACHECK    @G32DSPD 22562032
PUTIPLNM DC    C'PUTIPL'                IEH866I FUNCTION TEXT  @G32DSPD 22572032
         SPACE                                                          22600000
*   CHANNEL PROGRAM TO READ IN VOLUME LABEL OF OUTPUT VOLUME.           22650000
         DS    0D                                                       22700000
RDVOL1   CCW   X'31',VOL1ID,X'60',5     SEARCH ID ON VOL1 RECORD M4720  22750000
         CCW   X'08',RDVOL1,0,0         TIC                             22800000
         CCW   X'06',VOL1BUF,0,80       READ VOLUME LABEL RECORD        22850000
         SPACE                                                          22900000
*   CHANNEL PROGRAM TO LOCATE LAST LABEL OF VOLUME LABEL SET ON         22950000
*   TRACK 0. A MAXIMUM OF 8 ARE ALLOWED                                 23000000
         DS    0D                       ALIGN ON DOUBLE WORD            23050000
RDVOLX   CCW   X'31',OUTSEEK+D3,X'60',5 SEARCH ID ON VOL2-8 REC  M4720  23060000
         CCW   X'08',RDVOLX,0,0         TIC                      M4720  23070000
         CCW   X'06',VOL1BUF,X'20',4    READ VOLUME LABEL RECORD M4720  23080000
         SPACE                                                          23130000
OUTDCB   DCB   MACRF=(E),DSORG=PS,IOBAD=OUTIOB,                        X26950000
               DEVD=DA,EOEA=P8,EXLST=LIST,SIOA=P7,PGFX=YES       YM3011 27000000
         DS    0F                                                       27050000
TIOTOFF  EQU   12                       OFFSET TO TIOT          YL02912 27052002
REPLY    DS    F                        AREA FOR OPER REPLY     YL02192 27060002
DSKECB   DC    F'0'                     WTOR ECB FOR IEH852     YL02912 27070002
OUTECB   DC    F'0'                     ECB                             27100000
OUTIOB   DS    0F                       IOB                             27150000
OUTFLAG1 DC    XL1'42'                  CMD CHAIN, UNRELATED            27200000
OUTFLAG2 DC    XL1'00'                  IOB FLAG BYTE 2                 27250000
OUTSENS  DC    H'0'                     SENSE BYTES                     27300000
OUTECBA  DC    A(OUTECB)                ECB ADDRESS                     27350000
OUTSTAT  DC    2F'0'                    CSW STATUS                      27400000
OUTCCWA  DC    A(RDVOLX)                ADDR OF CCW LIST         M4720  27450000
OUTDCBA  DC    A(OUTDCB)                ADDR OF DCB                     27500000
         DC    F'0'                     RESTART ADDRESS                 27550000
         DC    H'1'                     BLK CNT INCREMENT               27600000
         DC    H'0'                     ERROR COUNT                     27650000
OUTSEEK  DC    2F'0'                    MBBCCHHR                        27700000
*   CCWS TO WRITE THREE TO FIVE RECORDS ON TRACK ZERO, CYL ZERO.        27750000
         SPACE                                                          27800000
CCWOUT   DS    0D                                                       27850000
         DC    X'31'                    SEARCH R1 ID EQUAL              27900000
         DC    AL3(SIDR1)               ADDR                            27950000
         DC    X'60000005'              FLAGS                           28000000
         DC    X'08'                    TIC                             28050000
         DC    AL3(CCWOUT)              ADDR                            28100000
         DC    F'0'                     DUMMY                           28150000
ADDR1    DC    X'05'                    WRITE DATA                      28200000
         DC    AL3(0)                   ADDR                            28250000
         DC    X'40000018'              FLAGS                           28300000
CCWOUT2  DC    X'31'                    SEARCH ID OF REC 2              28350000
         DC    AL3(SIDR2)               ADDR                            28400000
         DC    X'60000005'              FLAGS                           28450000
         DC    X'08'                    TIC                             28500000
         DC    AL3(CCWOUT2)             ADDR                            28550000
         DC    F'0'                     DUMMY                           28600000
ADDR2    DC    X'05'                    WRITE DATA                      28650000
         DC    AL3(0)                   ADDR                            28700000
         DC    X'40000090'              FLAGS                           28750000
CCWOUTS  DC    X'31'                    SEARCH ID OF LAST VOL LABEL     28800000
         DC    AL3(SLAST)               ADDR                            28850000
         DC    X'60000005'              FLAGS                           28900000
         DC    X'08'                    TIC                             28950000
         DC    AL3(CCWOUTS)             ADDR                            29000000
         DC    F'0'                     DUMMY                           29050000
CCWOUT3  DC    X'1D'                    WRITE THIRD OUTPUT RECORD       29100000
         DC    AL3(IPLCK3)              ADDR                            29150000
         DC    X'A0000008'              FLAGS                           29200000
ADDR3    DC    X'1D'                    CHAIN DATA                      29250000
         DC    AL3(0)                   ADDR                            29300000
FLAG3    DC    X'4000'                  FLAGS                           29350000
DLEN3    DC    H'0'                     DATA LENGTH                     29400000
         SPACE                                                          29450000
CCWOUT4  DC    X'1D'                    WRITE FOURTH OUTPUT RECORD      29500000
         DC    AL3(IPLCK4)              ADDR                            29550000
         DC    X'A0000008'              FLAGS                           29600000
ADDR4    DC    X'1D'                    CHAIN DATA                      29650000
         DC    AL3(0)                   ADDR                            29700000
FLAG4    DC    X'4000'                  FLAGS                           29750000
DLEN4    DC    H'0'                     DATA LENGTH                     29800000
         SPACE                                                          29850000
CCWOUT5  DC    X'1D'                    WRITE FIFTH OUT PUT RECORD      29900000
         DC    AL3(IPLCK5)              ADDR                            29950000
         DC    X'A0000008'              FLAGS                           30000000
ADDR5    DC    X'1D'                    CHAIN DATA                      30050000
         DC    AL3(0)                   ADDR                            30100000
         DC    X'0000'                  FLAGS                           30150000
DLEN5    DC    H'0'                     DATA LENGTH                     30200000
*   COUNT AND KEY FIELDS FOR OUTPUT TO CYL 0 TRACK 0.                   30250000
         SPACE                                                          30300000
IPLCK1   DC    XL8'0000000001040018'    COUNT FIELD IPL1                30350000
IPLK1    DC    CL4'IPL1'                KEY IPL1                        30400000
IPLCK2   DC    XL8'0000000002040090'    COUNT IPL2                      30450000
IPLK2    DC    CL4'IPL2'                KEY IPL2                        30500000
IPLCK3   DC    XL4'00000000'            CCHH                            30550000
IPLCK3R  DC    X'00'                    REC NO.                         30600000
IPLCHKL3 DC    X'00'                    KEY LENGTH                      30650000
IPLCK3L  DC    X'0000'                  DATA LENGTH                     30700000
IPLK3    DC    CL4'IPL3'                KEY VALUE FOR IPL3              30710000
         SPACE                                                          30750000
IPLCK4   DC    XL4'00000000'            CCHH                            30800000
IPLCK4R  DC    X'00'                    REC NO.                         30850000
IPLCHKL4 DC    X'00'                    KEY LENGTH                      30900000
IPLCK4L  DC    X'0000'                  DATA LENGTH                     30950000
IPLK4    DC    CL4'IPL4'                KEY VALUE FOR IPL4              30960000
         SPACE                                                          31000000
IPLCK5   DC    XL4'00000000'            CCHH                            31050000
IPLCK5R  DC    X'00'                    REC. NO.                        31100000
IPLCHKL5 DC    X'00'                    KEY LENGTH                      31150000
IPLCK5L  DC    X'0000'                  DATA LENGTH                     31200000
IPLK5    DC    CL4'IPL5'                KEY VALUE FOR IPL5              31210000
         SPACE                                                          31250000
INDCB    DCB   BLKSIZE=3072,DSORG=PS,EODAD=ENDIN,                      X31300000
               MACRF=GM,RECFM=U                                         31350000
NAME     DC    C'PUTIPL OF'             MODULE NAME CONSTANT            31400000
NAMELEN  EQU   *-NAME                   LENGTH OF NAME                  31450000
VOL1BUF  DS    20F                      VOLUME LABEL BUFFER             31500000
VOL1ID   DC    XL5'0000000003'          ID OF VOLUME LABEL              31550000
VOL1     DC    CL4'VOL1'                KEY OF VOLUME LABEL             31600000
VOL2     DC    CL4'VOL2'                KEY OF VOL2 LABEL               31650000
VOL3     DC    CL4'VOL3'                KEY OF VOL3 LABEL               31700000
VOL4     DC    CL4'VOL4'                KEY OF VOL4 LABEL               31750000
VOL5     DC    CL4'VOL5'                KEY OF VOL5 LABEL               31800000
VOL6     DC    CL4'VOL6'                KEY OF VOL6 LABEL               31850000
VOL7     DC    CL4'VOL7'                KEY OF VOL7 LABEL               31900000
VOL8     DC    CL4'VOL8'                KEY OF VOL8 LABEL               31950000
SEARCHAD DC    XL5'00'                  SEARCH ADDRESS                  32000000
IPLISAV  DS    18F                      SAVE AREA                       32050000
WRDCBAD  DC    A(OUTDCB)                ADDR                            32100000
GETLEN   DC    F'8000'                  LENGTH FOR GETMAIN FOR INPUT    32150000
*                                       BUFFER                          32200000
SIDR1    DC    XL5'0000000001'          SEARCH ARGUMENT FOR CCW         32250000
SIDR2    DC    XL5'0000000002'          SEARCH ARGUMENT                 32300000
SLAST    DC    XL5'00'                  SEARCH ARGUMENT FOR OUTPUT CCW  32350000
HEIGHT   DC    H'8'                     HALFWORD - VALUE 8              32400000
TWFOUR   DC    F'24'                    FULLWORD VALUE 24               32450000
ONE44    DC    H'144'                   HALFWORD VALUE 144              32500000
HTHREE   DC    H'3'                     HALFWORD VALUE THREE            32550000
FFOUR    DC    F'4'                     FULLWORD VALUE FOUR      M4720  32560000
HFIVE    DC    H'5'                     HALFWORD VALUE 5                32600000
LEN08    DC    H'8'                     HALFWORD VALUE 8                32650000
TWOK     DC    H'2048'                  USED FOR LRECL COMPARE          32700000
ZERODATA DC    CL8'0'                   FULLWORD                        32750000
COREADR  DS    F                        SAVE ADDR OF GOTTEN CORE HERE   32800000
PATCHA   DS    50F                      PATCH AREA FOR PROGRAM          32850000
         EJECT                                                          32900099
         IEHDBLKS                                                       32907099
         EJECT                                                          32914099
         IEHDWORK                                                       32921099
         EJECT                                                          32928099
         ICHPRCVT                                              @ZA25515 32935099
         EJECT                                                          32942099
         IECDSECS CVT,TIOT,EXPAND=YES                                   32960002
UCB      DSECT                                                          33000000
         IEFUCBOB                                                       33050000
JFCB     DSECT                                                          33100000
         IEFJFCBN                                                       33150000
         DCBD  DSORG=PS                                                 33200000
VOLX     DSECT                          FOR VOL2 - 8 CONSTANTS   M4720  33210000
         DS    CL4                                               M4720  33230000
         END                                                            33250000
