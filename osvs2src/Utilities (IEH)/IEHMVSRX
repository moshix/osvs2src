 TITLE 'IEHMVSRX-DCB CONSTRUCTION FOR IEHMOVE LOAD MODULE ESY'          00010017
*TITLE -IEHMVSRX                                                        00020017
*FUNCTION /OPERATION: THIS ROUTINE HANDLES THE BUILDING OF THE DCB'S  * 00040000
*FOR THE FROM AND TO DATA SETS, OPENING THOSE DATA SETS, AND          * 00060000
*HANDLING THE FROMDD AND TODD KEYWORDS                                * 00080000
*ENTRY POINTS: IEHMVESX                                               * 00100000
*INPUT: INFORMATION IN MOVE/COPY COMMUNICATIONS TABLE                 * 00120000
*OUTPUT 'FROM' OCB                                                    * 00140000
*'TO' DCB                                                             * 00160000
*EXTERNAL ROUTINES: MESSAGE WRITER                                      00180000
*EXITS-NORMAL RETURN TO CALLING MODULE-IEHMVSSY                       * 00200000
*ERRORS: NONE                                                         * 00220000
*TABLES/WORK AREAS: MOVE/COPY COMMUNICATIONS TABLE                    * 00240000
*ATTRIBUTES: REUSEABLE                                                * 00260000
*NOTES: PART OF LOAD MODULE IEHMVESY                                  * 00264002
*                                                                       00268002
IEHDCBDM CSECT                                                          00269004
*A046410-046530,046700,077601-077602                           @ZA09158 00270004
*C013400,048600                                                @ZA09158 00271004
*A049890-049900                                                @ZA04377 00272103
*A049244-049266                                                @ZA01249 00272302
*D049244-049264                                                @ZA01249 00272602
*C049150,049170                                                @ZA01243 00273002
*A043613-043614                                                @ZA01229 00274002
*C027400                                                       @ZA01234 00276002
*A043680-043686                                                @YA02622 00283102
*D043680-043684                                                @YA02622 00283202
*D051300-051600                                                @YA02612 00283502
*A049150                                                       @YA02545 00284002
*C049170                                                       @YA02545 00285002
*D049150-049154                                                @YA02545 00286002
*D078000                                                        OY01176 00290102
*A005560,078000-078185,024930-024960                            OY01176 00290202
*A043604-043699                                                  A52003 00290422
*A077604-077607                                                  A52003 00290822
*A068200                                                         A99999 00292022
*A029400                                                         A48772 00310122
*A057000,058000                                                  A45188 00310422
*A029400,D033200,A045200,D048800                                 A45179 00310822
*A017020-017500                                                 OY01174 00311402
* 033800,049240                                                  A38744 00312021
*A009860-009920,049103-049190,067810-067920,076406-076568        A37919 00313022
*C067800,073200,073800,075600,076400,077600                      A37919 00314022
* 027640                                                                00315020
 TITLE 'IEHMVSRX-IEHMOVE BUILD/OPEN TO/FROM DCB,USE TODD/FROMDD'   1308 00320014
* --CODE ADDED BECAUSE OF FIX FOR DATA MANAGEMENT APAR 26725     A26725 00340019
*  (OPEN SVC ROUTINE WILL ISSUE TYPE 013 ABEND IF TRACK-OVERFLOW A26725 00340119
*   BIT IS ON IN DCB FOR DEVICE WHICH DOESN'T SUPPORT TRACK-     A26725 00340219
*   OVERFLOW)                                                    A26725 00340319
* 043680-043720                                                 PTM0125 00340519
* 065800-066000                                                  A21645 00340819
*                                                                  UL0H 00341017
*0057023800-024000,024800-025400,027200,041000-042000,043200,      UL0H 00342017
*         064600,069200                                            UL0H 00343017
*                                                                  UL0H 00344017
*0057043600                                                        4128 00352017
*0057025600-025800                                                 8461 00356017
*031400,047200                                                   A27726 00360019
*027800,037400-037600,043800,049720-049920,051700                 19030 00364019
*--ANY STATEMENTS FLAGGED 19030 PERTAIN TO VARIABLE SPANNED RECORD--    00368019
*--SUPPORT FOR BDAM DATA SETS                                           00372019
*                             REGISTER NOTATION AND USAGE               00380000
*                                                                       00400000
R0       EQU   0                        PARAM REG                       00420000
R1       EQU   1                        PARAM REG                       00440000
R3       EQU   3                        WORK REG                        00460000
R4       EQU   4                        WORK REG                        00480000
R5       EQU   5                        WORK REG                        00500000
R6       EQU   6                        WORK REG                        00520000
R7       EQU   7                        BASE FOR DCB                    00540000
R2       EQU   2                       WORK REG                    VS0H 00546017
R8       EQU   8                       WORK REG                    UL0H 00552017
R9       EQU   9                                                OY01176 00556002
R10      EQU   10                       BASE FOR JFCB                   00560000
R11      EQU   11                       BASE FOR IEHMVESX               00580000
R12      EQU   12                       BASE FOR COMMUNICATION AREA     00600000
R13      EQU   13                      SAVE REG                         00620000
R14      EQU   14                       RETURN REG                      00640000
R15      EQU   15                       ENTRY POINT REG                 00660000
*                                                                       00680000
*                                                                       00700000
*                             EQUATES                                   00720000
*                                                                       00740000
OPEN     EQU   X'10'                                             A38744 00750021
SELECT   EQU   X'02'                                                    00760000
FROMKEY  EQU   X'02'                                                    00780000
LOADUNLD EQU   X'03'                                                    00800000
DASD     EQU   X'20'                                                    00820000
TOKEYWRD EQU   X'40'                                                    00840000
PREALLOC EQU   X'08'                                                    00860000
FIVE     EQU   X'05'                                                    00880000
ZERO     EQU   X'00'                                                    00900000
TRKOFLOW EQU   X'DF'                    MASK TO 'AND' OFF        A26725 00905019
*                                        TRACK-OVERFLOW BIT IN   A26725 00910019
*                                        DCB RECFM BYTE          A26725 00915019
BLANK    EQU   X'40'                                                    00920000
CATALOG  EQU   X'04'                                                    00940000
LOAD     EQU   X'02'                                                    00960000
UNLOAD   EQU   X'01'                                                    00980000
RLSE     EQU   X'04'                   DEFAULT RELEASE           A37919 00986022
RLSEREQ  EQU   X'80'                   EXPLICIT RELEASE          A37919 00992022
TIOTDDNA EQU   X'04'                   TIOT DDNAME              YL026VC 00994002
*                                                                       01000000
*                                                                       01020000
*                             EXTRN AND ENTRY STATEMENTS                01040000
*                                                                       01060000
         ENTRY IEHMVESX                                                 01080000
         EXTRN MSG                                                      01100000
         EXTRN PREABORT                                                 01120000
*                                                                       01140000
*                                                                       01160000
*                             ASSEMBLER USING STATEMENTS                01180000
*                                                                       01200000
         USING IEHMVESX,R11                                             01220000
         USING IEHMVV,R12                                               01240000
         USING IHADCB,R7                                                01260000
         USING JFCBX,R10                                                01280000
         USING IECSDSL1,R12                                             01300000
         USING DEBBASIC,R3                                      YL026VC 01302002
         USING DEBAVT,R2                                        YL026VC 01304002
         USING DEBXTN,R4                                        YL026VC 01306002
         USING DSAB,R5                                          YL026VC 01308002
         USING TCB,R6                                           YL026VC 01310002
         USING IEZJSCB,R8                                       YL026VC 01312002
         USING QDB,R9                                           YL026VC 01314002
*                                                                       01320000
IEHMVESX SAVE  (14,12),T,IEHMVSRX-OZ09158                      @ZA09158 01340004
         LR    R11,R15                  SET UP ADDRESSABILITY FOR ESX   01360000
         IEHPRE (14,1),TFC                                              01380000
         CLI   IEHMVV22,FIVE            DOES THE FROM VOLUME LIST       01400000
*                                       INDICATE THAT MORE THAN 5       01420000
*                                       VOLUMES ARE INVOLVED IN THIS    01440000
*                                       REQUEST?                        01460000
         BH    ABORT                    YES. TERMINATE THIS REQUEST,    01480000
*                                       PRINT MESSAGE INDICATING        01500000
*                                       PROGRAM DOES NOT HANDLE MORE    01520000
*                                       THAN 5 VOLUMES AND CAUSE CONTRO 01540000
*                                       TO RETURN FOR ANOTHER REQUEST.  01560000
         CLI   IEHMVV23,FIVE            DOES THE TO VOLUME LIST         01580000
*                                       INDICATE THAT MORE THAN 5       01600000
*                                       VOLUMES ARE INVOLVED IN THIS    01620000
*                                       REQUEST?                        01640000
         BH    ABORT                    YES. TERMINATE THIS REQUEST AS  01660000
*                                       ABOVE.                          01680000
*                                       OTHERWISE CONTINUE PROCESSING   01700000
*                                       THIS REQUEST                    01720000
*                                                                       01740000
*                                                                       01760000
         TM    IEHMVV20+3,PREALLOC      HAS THE TO DATA SET BEEN        01780000
*                                       PREALLOCATED?                   01800000
         BZ    CONT                     NO.                             01820000
         MVC    SAVRECFM(1),IEHMVV31                                    01840000
         MVI    IEHMVV31,X'00'                                          01860000
*                                       SET HAS BEEN PREALLOCATED, THE  01880000
*                                       DSCB HAS BEEN READ INTO THE     01900000
*                                       VOLATILE WORK AREA. IT IS       01920000
*                                       NECESSARY TO SAVE THE RECORD    01940000
*                                       FORMAT FOR USE BY THE ROUTINE   01960000
*                                       GIVEN CONTROL BY OPENJ DURING   01980000
*                                       PROCESSING OF THE TO DCB.       02000000
CONT     DS    0H                       CONTINUE NORMAL PROCESSING      02020000
         L     R4,IEHMVV30                                              02040000
         LTR   R4,R4                    HAS FROM DCB BEEN BUILT?        02060000
         BNE   TODCBB                   YES. GO TO BUILD TO DCB         02080000
         TM    IEHMVV20,CATALOG         IS THIS A CATALOG FUNCTION?     02100000
         BO    CATDCBB                 YES. BUILD SPECIAL DCB           02120000
         L     R4,IEHMVV30+8            GET DSCB POINTER                02140000
         LH    R0,DS1DSORG-DS1DSNAM(R0,R4)                              02160000
*                                       GET DSORG FROM DSCB AND PASS    02180000
*                                       TO DCBBUILDER                   02200000
GOCAT    DS    0H                                                       02220000
         LA    R1,0                     PASS INPUT CODE TO DCBBUILDER   02240000
         L     R15,DCBB                                                 02260000
         BALR  R14,R15                  LINK WITH DCBBUILDER            02280000
         ST    R7,IEHMVV30              SAVE DCB POINTER                02300000
         LA    R10,IEHMVV00             SET UP ADDRESSABILITY FOR JFCB  02320000
         L     R4,IEHMVV30+12           GET DDNAME POINTER              02340000
         MVC   DCBDDNAM(8),0(R4)        MOVE DDNAME TO DCB              02360000
         LA    R4,IEHMVV70              GET EXIT LIST ADDRESS      UL0H 02380017
         O     R4,DCBEXLST              PICK UP HIGH ORDER BYTE    UL0H 02400017
         ST    R4,DCBEXLST              FROM EXIT LIST FIELD IN         02420000
*                                       DCB AND STORE IT WITH EXIT      02440000
*                                       LIST ADDRESS IN DCB             02460000
         ST    R10,UDCBJFCB             SET UP JFCB EXIT LIST ADDR UL0H 02470017
         MVI   UDCBJFCB,X'87'             AND ACTIVATE ENTRY       UL0H 02480017
         MVC   UDCBDCBE(4),DCBXX        SET UP DCB EXIT LIST ADDR  UL0H 02490017
         MVC   UDCBIHLE(4),ADIHLR ADDR.INPUT HEADER-LABEL ROUT. OY01176 02493002
         MVI   UDCBIHLE,X'01'    INDICATE INPUT HEADER LABEL    OY01176 02496002
         CLI   UDCBOHLE,X'00'           IS OHLE INACTIVE           UL0H 02500017
         BE    SETLABSW                 YES, CONTINUE              UL0H 02510017
         MVC   UDCBOHLE(4),XXOHLE       NO, SET UP OHLE LIST ADDR  UL0H 02520017
SETLABSW DS    0H                                                  UL0H 02530017
         MVI   IEHMVV72+8,X'01'         SET 1ST LABEL SWITCH       UL0H 02540017
         XC    IEHMVV72+4(4),IEHMVV72+4 CLEAR CURRENT LABEL POINTERUL0H 02550017
         TM    IEHMVV20+3,FROMKEY       WAS FROMDD KEYWORD SPECIFIED?   02600000
         BO    FROMDD                   YES. GO TO MOVE FROM DDNAME     02620000
*                                       INTO DCB AND READ JFCB          02640000
         MVI   IEHMVV00,ZERO            NO. BUILD JFCB                  02660000
         MVC   IEHMVV00+1(175),IEHMVV00                                 02680000
*                                                                       02700000
         MVI   JFCBLTYP,X'0A'          INDICATE STAND. USER LBLS   UL0H 02720017
         MVI   JFCBIND2,X'40'         AND OLD DATA SET IN JFCB @ZA01234 02740002
*                                                                       02760000
FROMBACK EQU   *                                                        02760620
         TM    JFCBLTYP,SL          STANDARD LABEL               A32041 02761220
         BNO   BDAMTST            *B IF NOT- USE EXISTING RECFM  A32041 02761820
*                                                         BLKSIZEA32041 02762420
*                                                    AND LRECL   A32041 02763020
*                                                                A32041 02763620
         XC    JFCDSORG(1),JFCDSORG   ELSE ZERO OUT JFCB FIELDS  A32041 02764220
         XC    JFCRECFM(1),JFCRECFM      SO THE DCB FIELDS       A32041 02764820
         XC    JFCLRECL(2),JFCLRECL    WILL BE FILLED FROM THE   A32041 02765420
         XC    JFCBLKSI(2),JFCBLKSI    STANDARD LABEL            A32041 02766020
*                                                                A32041 02766620
BDAMTST  L     R4,IEHMVV30+8         ADDRESS OF FROM DSCB        A32041 02767220
         TM    82(R4),X'20'       IS DATA SET BDAM                19030 02768019
         BNO   FROMCONT           NO                              19030 02772019
         TM    84(R4),X'48'       IS THE RECFM VS                 19030 02776019
         BNO   FROMCONT           NO                              19030 02780019
         OI    50(R7),X'01'    TURN ON CHECK RTN BIT              19030 02784019
         OI    JFCBFTEK,X'20'     SET BUFTEK TO 'R'               19030 02788019
FROMCONT L     R4,IEHMVV21        GET DSNAME POINTER              19030 02792019
         MVC   JFCBDSNM(44),0(R4)       MOVE DSNAME INTO THE JFCB       02800000
         L     R4,IEHMVV30+12                                           02820000
         MVC   DCBDDNAM(8),0(R4)        RELOAD DDNAME TO THE DCB        02840000
         MVI   JFCBELNM,BLANK                                           02860000
         MVC   JFCBELNM+1(7),JFCBELNM SET ELEMENT NAME IN JFCB          02880000
*                                       TO BLANKS                       02900000
         LA    R6,JFCBVOLS              GET POINTER TO JFCB             02920000
*                                       VOLUME LIST                     02940000
         MVI   0(R6),X'40'                                       A45179 02950022
         MVC   1(29,R6),0(R6)         BLANK JFCBVOLS             A45179 02952022
         SR    R5,R5                                                    02960000
         IC    R5,IEHMVV22              GET VOLUME COUNT                02980000
         LA    R3,5                    LIMIT MOVE TO MAXIMUM OF         03000000
*                                       FIVE VOLUMES                    03020000
         L     R4,IEHMVV22              GET POINTER TO VOLUME LIST      03040000
         MVC   JFCBFLSQ(2),10(R4)       MOVE IN FILE SEQUENCE NUMBER    03060000
VOLIDLP  DS    0H                                                       03080000
         MVC   0(6,R6),4(R4)            MOVE IN VOLUME SERIAL NUMBER    03100000
         LA    R6,6(R6)                                                 03120000
         LA    R4,17(R4)    ADJUST TO NEXT VOLUME NUMBER IN LIST A27726 03140019
         BCT   R3,NVOLIDS               HAVE FIVE VOLUME NUMBERS        03160000
*                                       BENN MOVED?                     03180000
         MVI   JFCBNVOL,FIVE            YES.                            03200000
         B     FDDRTN                                                   03220000
NVOLIDS  BCT   R5,VOLIDLP               HAVE ALL THE VOLUME NUMBERS     03240000
*                                       BEEN MOVED?                     03260000
         MVC   JFCBNVOL(1),IEHMVV22     YES. MOVE IN ACTUAL VOLUME      03280000
*                                       COUNT                           03300000
FDDRTN   DS    0H                                                       03340000
         MVI   79(7),X'01'   INITIALIZE DCBEOBR FIELD TO DC A(1)  12574 03350015
         MVC   JFCBDSNM+53(3),IEHMVV82        MOVE TTR IN JFCB   S21042 03352021
         XC    IEHMVV82(3),IEHMVV82       AFTER THAT, CLEAR FIELDS21042 03354021
         OPEN  ((R7),INPUT),TYPE=J                                      03360000
         TM    DCBOFLGS-IHADCB(R7),OPEN SUCCESSFUL OPEN          A38744 03370021
         BO    OPENFROM                 YES CONTINUE             A38744 03380021
         MVI   IEHMVV61,X'26'           NO INDICATE MSG NUMBER   A38744 03390021
         B     ABEND                    AND TERMINATE THE REQ    A38744 03392021
OPENFROM OI    IEHMVV10-4,X'80'         INDICATE FROMDCB OPENED  A38744 03394021
         CLI   IEHMVV10-5,X'00'         IS THERE A MESSAGE TO BE        03400000
*                                       PRINTED?                        03420000
         BE    NOMSS                    NO. SKIP LINK TO MESSAGE WRITER 03440000
         IC    R4,IEHMVV61                                              03460000
         MVC   IEHMVV61(1),IEHMVV10-5   SET MESSAGE CODE                03480000
         L     R15,ADMSG                                                03500000
         BALR  R14,R15                  AND LINK TO MSG WRITER          03520000
         STC   R4,IEHMVV61              RESET MSG BYTE                  03540000
NOMSS    DS    0H                                                       03560000
         CLI   IEHMVV74+4,X'FF'         I/O ERR IN U.L. EXIT RTN   UL0H 03565017
         BE    IOERRMSG                 YES, TELL USER             UL0H 03570017
ERMSGRET DS    0H                                                       03575017
TODCBB   DS    0H             ENTRY POINT FOR BUILDING TO DCB           03580000
         TM    IEHMVV20+1,LOADUNLD      IS THIS BOTH LOAD AND UNLOAD    03600000
*                                       CONDITION?                      03620000
         BO    BBLLUU                   YES. USE SPECIAL DCB            03640000
         TM    IEHMVV20+1,UNLOAD        NO. IS THIS UNLOAD CONDITION?   03660000
         BO    UNDCBB                   YES                             03680000
         TM    IEHMVV20,CATALOG         NO. IS THIS CATALOG FUNCTION?   03700000
         BO    MYMDCB                   YES.                            03720000
TODCBB1  DS    0H                                                  VS0H 03730017
         L     R4,IEHMVV30+8      ADDR OF 'FROM' DSCB             19030 03734019
         TM    82(R4),X'20'       IS THIS A BDAM DATA SET         19030 03738019
         BNO   TURNOFF            NO                              19030 03742019
         TM    84(R4),X'48'       IS THIS A VS DATA SET           19030 03746019
         BNO   TURNOFF            NO                              19030 03750019
         TM    IEHMVV20+1,UNLOAD  IS THIS AN UNLOAD SITUATION     19030 03754019
         BO    REGSET             YES, ALLOW UNLOAD OF VS DATA    19030 03758019
TURNOFF  NI    IEHMVV20+1,X'FE'   TURN OFF UNLOAD SWITCH          19030 03762019
         LH    R0,DS1DSORG-DS1DSNAM(R0,R4)                              03770017
*                                       GET DSORG FROM DSCB             03780000
SETUNB   LA    R1,1                     PASS OUTPUT CODE TO             03800000
*                                       DCBBUILDER                      03820000
         L     R15,DCBB                                                 03840000
         BALR  R14,R15                  LINK TO DCBBUILDER              03860000
         ST    R7,IEHMVV31              SAVE DCB ADDRESS                03880000
         TM    IEHMVV20+1,LOADUNLD      LOAD AND UNLOAD CONDITION?      03900000
         BO    LLUUBB                   YES. RESOLVE BLOCKSIZES         03920000
RLLUUBB  DS    0H                                                       03940000
         L     R4,IEHMVV23+4            GET VOLUME LIST POINTER         03960000
         CLI   2(R4),DASD               IS TO DEVICE DA?                03980000
         BNE   NEDASD                   NO                              04000000
OKNE     DS    0H                                                       04020000
         LA    R10,IEHMVV00             SET UP ADDRESSABILITY FOR JFCB  04040000
         L     R4,IEHMVV31+8                                            04060000
         MVC   DCBDDNAM(8),0(R4)        MOVE DDNAME TO THE DCB          04080000
         LA    R4,IEHMVV70              GET EXIT LIST ADDRESS      UL0H 04090017
         O     R4,DCBEXLST              PICK UP HIGH ORDER BYTE    UL0H 04100017
         ST    R4,DCBEXLST                FROM EXIT LIST FIELD     UL0H 04110017
         ST    R10,UDCBJFCB             SET UP JFCB EXIT LIST ADDR UL0H 04120017
         MVI   UDCBJFCB,X'87'             AND ACTIVATE ENTRY       UL0H 04130017
         MVC   UDCBDCBE(4),XXXT         SET UP DCB EXIT LIST ADDR  UL0H 04140017
         CLI   UDCBOHLE,X'00'           IS OHLE INACTIVE           UL0H 04150017
         BE    LABSWSET                 YES, CONTINUE              UL0H 04160017
         MVC   UDCBOHLE(4),XXOHLE       NO, SET UP OHLE LIST ADDR  UL0H 04170017
LABSWSET DS    0H                                                  UL0H 04180017
         MVI   IEHMVV72+8,X'01'         SET 1ST LABEL SWITCH       UL0H 04190017
         XC    IEHMVV72+4(4),IEHMVV72+4 CLEAR CURRENT LABEL POINTERUL0H 04200017
         TM    IEHMVV20+3,TOKEYWRD      WAS TODD KEYWORD SPECIFIED?     04220000
         BO    TODD                     YES. GO TO READ JFCB            04240000
*                                                                       04260000
         MVI   IEHMVV00,ZERO            NO. BUILD NEW JFCB              04280000
         MVC   IEHMVV00+1(175),IEHMVV00                                 04300000
         MVI   JFCBLTYP,X'02'          INDICATE S L              A48589 04320022
         TM    UDCBITLE,X'03'          USER LABELS FOUND         A48589 04330022
         BNO   NOSUL                   NO  CONTINUE              A48589 04332022
         OI    JFCBLTYP,X'08'          YES  INDICATE IT          A48589 04334022
NOSUL    DS    0H                                                A48589 04336022
         MVI   JFCBIND2,X'40'           AND OLD DATA SET IN JFCB        04340000
TOBACK   DS    0H                                                       04360000
         ST    R1,SAVEREG1           SAVE REG1 FOR TIME MACRO    A52003 04360422
         TM    IEHMVV20,X'80'        MOVE-OPERATION              A52003 04360822
         BO    KEEPCDT               BRANCH,IF YES - NO CHANGE   A52003 04361222
         TM    IEHMVV20+3,X'08'        PREALLOCATED DATA SET   @ZA01229 04361302
         BO    RESET                   YES                     @ZA01229 04361402
         TIME  ,                     GET CURRENT CREATION-DATE   A52003 04361622
         XC    DW,DW                 CLEAR CONVERSION-AREA       A52003 04361722
         LR    R4,R1                 GET DATE IN REG4            A52003 04361822
         STH   R1,DW+6               STORE DDDF                  A52003 04361922
         CVB   R1,DW                 CONVERT IT TO BINARY        A52003 04362322
         STH   R1,DW+6               STORE IT IN ALIGNED AREA    A52003 04362722
         MVC   JFCBCRDT+1(2),DW+6    MOVE IT INTO THE JFCB       A52003 04363122
         SRDL  R4,4                  PUT X'F' INTO REG5          A52003 04363522
         SRL   R4,12                 REMOVE 'DDD'                A52003 04363922
         SLDL  R4,4                  PUT YYF IN REG4             A52003 04364422
         STH   R4,DW+6               STORE 'YYF' INTO CONV.AREA  A52003 04364822
         CVB   R1,DW                 CONVERT IT TO BINARY        A52003 04365222
         STC   R1,JFCBCRDT           STORE IT INTO JFCB          A52003 04365622
         B     TSTEXPDT              TEST EXPIRATION-DATE        A52003 04365722
KEEPCDT  L     R4,IEHMVV30+8         GET ADDR. FROM-DSCB         A52003 04365822
         MVC   JFCBCRDT(3),53(R4)    COPY EXISTING CREATIONDATE  A52003 04365922
TSTEXPDT CLC   JFCBXPDT(3),ZEROS       EXPDT SPEC IN DD-CARD   @YA02622 04368002
         BNE   RESET                   YES KEEP IT             @YA02622 04368202
         TM    IEHMVV20+3,X'08'        PREALLOCATED DATA SET   @YA02622 04368402
         BO    RESET                   YES KEEP EXPDT          @YA02622 04368602
         L     R4,IEHMVV30+8         IF NO, COPY IT FROM DSCB    A52003 04368822
         MVC   JFCBXPDT(3),56(R4)                                A52003 04369222
RESET    L     R1,SAVEREG1           RESET REG1                  A52003 04369622
         XC    JFCRECFM(1),JFCRECFM  CLEAR RECFM OF JFCB         A52003 04369722
         XC    JFCBLKSI(4),JFCBLKSI  CLEAR BLOCKSIZE + LRECL     A52003 04369822
         L     R4,IEHMVV30+8         GET ADDRESS OF FROM-DSCB    A52003 04369922
         TM    82(R4),X'20'       IS THIS A BDAM DATA SET         19030 04370019
         BNO   TOCONT             NO                              19030 04374019
         TM    84(R4),X'48'       IS THE RECFM VS                 19030 04378019
         BNO   TOCONT             NO                              19030 04382019
         OI    JFCBFTEK,X'20'     SET BUFTEK TO 'R'               19030 04386019
TOCONT   L     R4,IEHMVV31+8      ADDR OF DDNAME                  19030 04390019
         MVC   DCBDDNAM(8),0(R4)        MOVE DDNAME TO DCB              04400000
         L     R4,IEHMVV21+4                                            04420000
         MVC   JFCBDSNM(44),0(R4)       MOVE DSNAME TO JFCB             04440000
         MVI   JFCBELNM,BLANK                                           04460000
         MVC   JFCBELNM+1(7),JFCBELNM SET ELEMENT NAME TO BLANKS        04480000
         LA    R6,JFCBVOLS              GET VOLUME LIST POINTER         04500000
*                                       IN JFCB                         04520000
         MVI   0(R6),X'40'                                       A45179 04530022
         MVC   1(29,R6),0(R6)         BLANK JFCBVOLS             A45179 04532022
         SR    R5,R5                                                    04540000
         IC    R5,IEHMVV23+4            GET VOLUME COUNT                04560000
         LA    R3,5                     SET MAXIMUM COUNT OF VOLUME     04580000
*                                       NUMBERS TO BE MOVED             04600000
         L     R4,IEHMVV23+4                                            04620000
         MVC   JFCBFLSQ(2),10(R4)                                       04640000
         CLI   2(R4),X'80'             IS TO VOL TAPE          @ZA09158 04641004
         BNE   V1                      NO                      @ZA09158 04642004
         CLC   4(6,R4),BLANKS          IS TO VOL SER BLANK     @ZA09158 04643004
         BE    V5                      YES                     @ZA09158 04644004
         CLC   4(6,R4),SCRTCH          IS TO VOL SER SCRTCH    @ZA09158 04645004
         BNE   V1                      NO                      @ZA09158 04646004
V5       L     R1,IEHMVV31+8           DDNAME ADDRESS IN TIOT  @ZA09158 04647004
         SR    R4,R4                   CLEAR REG4              @ZA09158 04648004
         ICM   R4,3,14(R1)             GET UCB ADDRESS         @ZA09158 04649004
         CLI   27(R4),X'00' SHOULD FILE ONE BE WRITTEN         @ZA09158 04650004
         BE    V1                      YES                     @ZA09158 04651004
         MVC   0(6,R6),28(R4)          MOVE VOL SER TO JFCB    @ZA09158 04652004
         B     V4                                              @ZA09158 04653004
V1       DS    0H                                                       04660000
         L     R4,IEHMVV23+4           ACTIVE TO VOLUME        @ZA09158 04670004
         MVC   0(6,R6),4(R4)            MOVE VOLUME SERIAL TO JFCB      04680000
         LA    R6,6(R6)                                                 04700000
         LA    R4,17(R4)    ADJUST TO NEXT VOLUME NUMBER IN LIST A27726 04720019
         BCT   R3,V2                    HAVE FIVE VOLUME NUMBERS        04740000
*                                       BEEN MOVED?                     04760000
         MVI   JFCBNVOL,FIVE            YES                             04780000
         B     V3                                                       04800000
V2       BCT   R5,V1                    HAVE ALL VOLUME NUMBERS         04820000
*                                       BEEN MOVED?                     04840000
V4       MVC   JFCBNVOL(1),IEHMVV23+4  MOVE VOL COUNT TO JFCB  @ZA09158 04860004
V3       DS    0H                                                       04900000
         MVI   79(7),X'01'   INITIALIZE DCBEOBR FIELD TO DC A(1)  12574 04910015
         MVC   JFCBDSNM+53(3),IEHMVV82+4 MOVE TTR IN JFCB        S21042 04912022
         XC    IEHMVV82+4(3),IEHMVV82+4 AND CLEAR THE FIELD      S21042 04912222
         TM    IEHMVV20,X'04'          MOVE/COPY CATALOG         A37919 04912422
         BO    NORLSE                  *B IF YES-NO RELEASE      A37919 04912622
*                                      (DS1LSTAR IS MEANING-     A37919 04912822
*                                      LESS IN A CATALOG DSCB    A37919 04913022
         TM    DCBDSORG,X'20'          DSORG=DA                  A37919 04913222
         BZ    TESTU                   *B IF NOT                 A37919 04913422
         TM    DCBRECFM,X'40'          RECFM=V(B)(S)(T)          A37919 04913622
         BZ    TESTU                   *B IF NOT                 A37919 04913822
         TM    DCBRECFM,X'80'          SAME QUESTION             A37919 04914022
         BZ    NORLSE                  *B IF YES-NO RLSE         A37919 04914222
*                                      BECAUSE OF ANY EXISTING   A37919 04914422
*                                      RELATIVE TRACK ADDRESSING A37919 04914622
*                                      SCHEME)                   A37919 04914822
TESTU    TM    IEHMVV10-4,RLSE         DEFAULT ALLOC TO BE     @ZA01243 04915002
*                                      RELEASED AT CLOSE         A37919 04915622
         BZ    EXPL                    *B IF NOT                 A37919 04915822
         TM    IEHMVV20+3,PREALLOC     PREALLOCATION             A37919 04916022
         BO    EXPL                    *B IF YES-NO DEFAULT RLSE A37919 04916222
         B     SETRLSE                 *B TO APPLY DEFAULT RLSE  A37919 04916422
EXPL     TM    IEHMVV20+5,RLSEREQ      RLSE EXPLICITLY           A37919 04916622
         BZ    NORLSE                  *B IF NOT                 A37919 04916822
SETRLSE  OI    JFCBIND1,JFCRLSE        RELEASE UNUSED SPACE    @ZA01243 04917002
*                                      AT CLOSE                  A37919 04917222
         B     SETOFF                  *B TO CLEANUP             A37919 04917422
NORLSE   NI    JFCBIND1,X'FF'-JFCBRLSE INDIC NO RELEASE          A37919 04917622
SETOFF   NI    IEHMVV10-4,X'FF'-RLSE   SETOFF DEFAULT RLSE       A37919 04917822
*                                      FOR REUSABILITY           A37919 04918022
*                                                                A37919 04918222
*        IF THE FROM DATA SET IS A CHECKPOINT DATA SET ON A     YL026VC 04918402
*        SECURE VOLUME, THEN INITIALIZE THE TO DATA SET AS A    YL026VC 04918602
*        CHECKPOINT DATA SET                                    YL026VC 04918802
         STM   R4,R6,SCSV1              SAVE REGS               YL026VC 04918902
         STM   R8,R9,SCSV2              SAVE REGS               YL026VC 04919002
         L     R7,IEHMVV30              GET FROM DCB ADDRESS    YL026VC 04919202
         L     R3,DCBDEBAD              GET DEB ADDRESS         YL026VC 04919402
         L     R2,DEBAPPAD              GET DEB AVT ADDRESS     YL026VC 04919602
         L     R4,DEBXTNP               GET DEB EXTENSION ADDR  YL026VC 04919802
         L     R5,DEBXDSAB              GET DSAB ADDRESS        YL026VC 04920002
         TM    DSABFLG4,DSABCKVL        SECURE VOLUME           YL026VC 04920202
         BO    CSSEC                    YES                     YL026VC 04920402
         NI    IEHMVV30,X'FD'           CLEAR FROM SECURE FLAG  YL026VC 04920602
         B     OPNTO                    OPEN TO D/S             YL026VC 04920802
CSSEC    OI    IEHMVV30,X'02'           SET FROM SECURE FLAG    YL026VC 04921002
         TM    JFCBIND2,X'C0'           TO D/S HAVE DISP OF NEW YL026VC 04921202
         BZ    OPNTO                    NO - OPEN TO D/S        YL026VC 04921402
         L     R6,DEBTCBAD              GET TCB ADDRESS         YL026VC 04921602
         L     R8,TCBJSCB               GET JSCB ADDRESS        YL026VC 04921702
         L     R9,JSCDSABQ              GET DSAB QUEUE ADDRESS  YL026VC 04921802
         L     R5,QDBFELMP              GET FIRST DSAB ADDRESS  YL026VC 04922002
TIENSR   L     R2,DSABTIOT              GET TIOT DD ENTRY       YL026VC 04922202
         CLC   TIOTDDNA(8,R2),DCBDDNAM  TO DDNAME               YL026VC 04922402
         BE    TIEFND                   YES - THIS IS DSAB      YL026VC 04922602
*                                       FOR TO D/S              YL026VC 04922802
         L     R5,DSABFCHN              GET NEXT DSAB ADDRESS   YL026VC 04923002
         LTR   R5,R5                    LAST DSAB IN QUEUE      YL026VC 04923202
         BNZ   TIENSR                   NO - CONTINUE SEARCH    YL026VC 04923402
         B     OPNTO                    NO DSAB FOR TO DDNAME   YL026VC 04923602
TIEFND   MODESET EXTKEY=SUPR,SAVEKEY=(2) GET INTO DSAB KEY      YL026VC 04923802
         OI    DSABFLG4,DSABCKDS        SET CHECKPOINT FLAG     YL026VC 04924002
         MODESET KEYADDR=(2)            RESET KEY               YL026VC 04924202
OPNTO    TM    IEHMVV20+1,UNLOAD        UNLOAD SITUATION       @ZA01249 04924402
         BO    SKPOPTCD                 YES                    @ZA01249 04924602
         L     R7,IEHMVV31              GET TO DCB ADDRESS     @ZA01249 04924802
         L     R8,IEHMVV30+8            GET ADDR. FROM DSCB    @ZA01249 04925002
         MVC   52(1,R7),85(R8)          MOVE THE OPTCD-BYTE    @ZA01249 04925202
*                                       TO OUTPUT DCB          @ZA01249 04925402
SKPOPTCD L     R7,IEHMVV31             GET TO DCB ADDRESS      @ZA01249 04925602
         OPEN  ((R7),OUTPUT),TYPE=J                            @ZA01249 04925802
         TM    DCBOFLGS-IHADCB(R7),OPEN OPEN SUCCESSFUL        @ZA01249 04926002
         BO    OPENTO                  YES CONTINUE            @ZA01249 04926202
         MVI   IEHMVV61,X'28'          NO INDICATE MSG NUMBER  @ZA01249 04926402
         B     ABEND                   AND TERMINATE THE REQ   @ZA01249 04926602
OPENTO   OI    IEHMVV10-4,X'40'         INDICATE TO  DCB OPENED  A38744 04926821
         MVI   UDCBIHLE,X'00'          DEACTIVATE INHDR LBL EXIT   UL0H 04928017
         MVI   UDCBOHLE,X'00'          DEACTIVATE OUTHDR LBL EXIT  UL0H 04932017
*                                                               YL026VC 04932202
*        TERMINATE REQUEST IF FROM ADN TO DATA SETS DO NOT      YL026VC 04932402
*        HAVE THE SAME CHECKPOINT SECURE STATUS                 YL026VC 04932602
*                                                               YL026VC 04932802
         L     R3,DCBDEBAD             GET TO DEB ADDRESS       YL026VC 04933002
         L     R2,DEBAPPAD             GET DEB AVT ADDRESS      YL026VC 04933202
         L     R4,DEBXTNP              GET DEB EXTENSION ADDR   YL026VC 04933402
         L     R5,DEBXDSAB             GET DSAB ADDRESS         YL026VC 04933602
         TM    DSABFLG4,DSABCKVL       SECURE VOLUME            YL026VC 04933802
         BO    CSSEC2                  YES                      YL026VC 04934002
         NI    IEHMVV30,X'FE'          CLEAR TO SECURE FLAG     YL026VC 04934202
         B     CSCRTST                 TEST SECURE STATUS       YL026VC 04934402
CSSEC2   OI    IEHMVV30,X'01'          SET TO SECURE FLAG       YL026VC 04934602
CSCRTST  LM    R4,R6,SCSV1              RESTORE REGS            YL026VC 04934702
         LM    R8,R9,SCSV2              RESTORE REGS            YL026VC 04934802
         TM    IEHMVV30,X'02'           FROM D/S SECURE         YL026VC 04934902
         BO    CSCRT2                  YES                      YL026VC 04935002
         TM    IEHMVV30,X'01'          TO D/S SECURE            YL026VC 04935202
         BZ    CSCROK                  NO - PROCEED W/REQUEST   YL026VC 04935402
         MVI   IEHMVV61,X'2C'          INDICATE MSG NUMBER      YL026VC 04935602
         B     ABEND                   TERMINATE REQUEST        YL026VC 04935802
CSCRT2   TM    IEHMVV30,X'01'          TO D/S SECURE            YL026VC 04936002
         BO    CSCROK                  YES - PROCEED W/REQUEST  YL026VC 04936202
         MVI   IEHMVV61,X'2E'          INDICATE MSG NUMBER      YL026VC 04936402
         B     ABEND                   TERMINATE REQUEST        YL026VC 04936602
CSCROK   NI    IEHMVV30,X'FC'          CLEAR SECURE FLAGS       YL026VC 04936802
*                                                                  VS0H 04937002
*  THE FOLLOWING CHECKS ARE MADE TO DETERMINE WHETHER A VS OR VBS  VS0H 04940017
*  DATA SET CAN BE MOVED/COPIED FROM DA TO TAPE. NORMALLY A DATA   VS0H 04944017
*  SET ON DA WITH KEYS IS UNLOADED WHEN 'TO' DEVICE IS TAPE.  VS   VS0H 04948017
*  AND VBS DATA SETS MAY NOT BE UNLOADED.  IF THE FROM DATA SET HASVS0H 04952017
*  A RECFM=VS OR VBS, IF THE FROM DEVICE IS DA, AND THERE ARE KEYS VS0H 04956017
*  PRESENT; AND IF THE TO DEVICE IS TAPE, A MESSAGE WILL BE GIVEN  VS0H 04960017
*  TO INDICATE THE DATA SET WILL NOT BE MOVED/COPIED/UNLOADED.     VS0H 04964017
*                                                                  VS0H 04968017
         L     R1,IEHMVV30             GET FROM DCB ADDRESS        VS0H 04970017
         TM    36(R1),X'58'     TEST 'FROM' DCB FOR VBS           19030 04973019
         BO    BDAMCHK          VBS DATA SET.GO TEST KEY          19030 04976019
BDAMCHK  TM    36(R1),X'48'     TEST 'FROM' DCB FOR VS            19030 04979019
         BNO   NORMCODE         NOT A SPANNED DATA SET            19030 04982019
         TM    26(R1),X'20'     TES FOR BDAM DSORG                19030 04985019
         BO    NORMCODE         ALL BDAM VS PROCESSING            19030 04988019
         TM    17(R1),X'80'            FROM TAPE               @ZA04377 04989003
         BO    NORMCODE                YES DO NOT CHECK KEY    @ZA04377 04990003
TESTKEY  CLI   16(R1),X'00'     FROM DATA SET KEYLEN=0            19030 04991019
         BE    NORMCODE                YES, NO PROBLEM             VS0H 04996017
         L     R2,IEHMVV31             GET TO DCB ADDRESS          VS0H 05000017
         TM    17(R2),X'20'            TO DEVICE DIRECT ACCESS     VS0H 05004017
         BC    1,ANYKEYTO              YES, STILL NO PROBLEM       VS0H 05008017
         MVI   IEHMVV61,X'0D'          SET CODE TO GIVE MSG, ABORT VS0H 05012017
         B     ABEND                   GO GIVE CONTROL TO PREABORT VS0H 05016017
ANYKEYTO CLI   16(R2),X'00'            TO DATA SET KEYLEN=0        VS0H 05020017
         BE    KEYERR                  ERROR, BOTH DATA SETS       VS0H 05024017
*                                      MUST HAVE KEYS              VS0H 05028017
         CLC   16(1,R2),16(R1)         TO, FROM KEYLENS EQUAL      VS0H 05032017
         BE    NORMCODE                YES                         VS0H 05036017
KEYERR   MVI   IEHMVV61,X'0F'          UNEQUAL KEYLENS,ERROR       VS0H 05040017
         B     ABEND                   SET  MSG CODE, GIVE MSG     VS0H 05044017
NORMCODE B     PROCEED                 NORMAL PROCEDURE            VS0H 05048017
MYMDCB   DS    0H                                                       05052017
         L     R4,IEHMVV23+4           GET VOLUME LIST POINTER          05056017
         CLI   2(R4),DASD              IS TO DEVICE DA                  05060017
         BE    PROCEED                 YES, EXIT.                       05064017
         OI    IEHMVV20+1,UNLOAD       SET UNLOAD BIT                   05068017
UNDCBB   DS    0H                       AND GO TO BUILD DCB FOR         05100000
*                                       UNLOAD CONDITION                05120000
         TM    IEHMVV20+1,LOADUNLD IS THIS BOTH LOAD AND UNLOAD    3826 05123018
         BO    BBLLUU              YES, BUILD SPECIAL DCB          3826 05126018
REGSET   LA    R0,1               PASS SPECIAL DSORG TO DCB BLDR  19030 05170019
*                                      DCB BUILDER                 VS0H 05180017
         B     SETUNB                                                   05190017
BBLLUU   SR    R0,R0                    PASS SPECIAL DSORG CODE TO      05200000
         B     SETUNB                   DCBBUILDER FOR LOAD/UNLOAD      05220000
*                                       SITUATION                       05240000
LLUUBB   MVI   DCBLRECL+1,X'50'         SET LOGICAL RECORD LENGTH       05260000
*                                       IN DCB AT 80                    05280000
         MVI   DCBRECFM,X'90'           SET RECORD FORMAT TO FIXED      05300000
*                                       AND STANDARD                    05320000
         L     R5,IEHMVV23                                              05340000
         MVI   DCBBLKSI+1,X'50'         MOVE IN BLOCK SIZE OF 80        05360000
         CLI   2(R5),X'08'              IS TO DEVICE UNIT RECORD?       05380000
         BE    RLLUUBB                  YES. RETURN TO NORMAL FLOW      05400000
         MVI   DCBBLKSI+1,X'20'         MOVE IN BLOCKSIZE OF 800        05420000
         MVI   DCBBLKSI,X'03'           WHEN TO DEVICE IS NOT           05440000
         B     RLLUUBB                  UNIT RECORD                     05460000
CATDCBB  DS    0H                                                       05480000
         LA    R0,2                     GET SPECIAL DSORG CODE FOR      05500000
         B     GOCAT                    CATALOG OPERATION AND PASS IT   05520000
*                                       TO DCBBUILDER                   05540000
PROCEED  DS    0H                                                       05560000
         IEHPOST  (14,1),TFC                                            05580000
*                                                                       05600000
*                                                                       05620000
         RETURN  (14,12), T                                             05640000
FROMDD   DS    0H                       IF FROMDD SPECIFIED MOVE        05660000
         L     R1,IEHMVV28              FROMDDNAME TO THE DCB           05680000
         MVC   DCBDDNAM(8),0(R1)        SO THAT JFCB CAN BE READ        05700022
         BAL   R5,SCANTIOT             RETURN IF DDNAME FOUND    A45188 05710022
         RDJFCB ((R7))                  READ FROM JFCB           A45188 05759922
         B     FROMBACK                 RETURN TO FILL IN JFCB          05770022
TODD     DS    0H                      IF TODD SPECIFIED MOVE           05772022
         L     R1,IEHMVV28+4            TODDNAME TO THE DCB SO THAT     05780000
         MVC   DCBDDNAM(8),0(R1)        CORRECT JFCB WILL BE READ       05800000
         BAL   R5,SCANTIOT             RETURN IF DDNAME FOUND    A45188 05802022
         RDJFCB ((R7))                                                  05804022
         B     TOBACK                  RETURN TO FILL IN JBCB           05806022
SCANTIOT DS    0H                                                A45188 05808022
         L     R4,16                    FIND ADDR CVT            A45188 05810022
         L     R4,0(R4)                FIND TCB POINTERS         A45188 05811022
         L     R4,4(R4)                 FIND TCB ADDR            A45188 05812022
         L     R4,12(R4)                FIND TIOT ADDR           A45188 05814022
         LA    R4,24(R4)                FIND FIRST DD ENTRY      A45188 05816022
NEXTDD2  SR    R6,R6                                             A45188 05818022
         IC    R6,0(R4)                 FIND ENTRY LENGTH        A45188 05818422
         CLC   4(8,R4),0(R1)            DDNAME FOUND             A45188 05818822
         BCR   8,R5                    YES RETURN                A45188 05819322
         AR    R4,R6                    NO GO TO NEXT ENTRY      A45188 05819622
         L     R6,0(R4)                                          A45188 05819722
         LTR   R6,R6                    END OF TIOT              A45188 05819822
         BNZ   NEXTDD2                 NO COMPARE NEXT ONE       A45188 05819922
         MVI   IEHMVV61,X'2A'           YES INDIC MSG NBR        A45188 05826622
         B     ABEND                    AND TERMINATE THE REQ    A45188 05828622
RDTOJFCB DS    0H                                                A45188 05830622
NEDASD   DS    0H                                                       05860000
         TM    IEHMVV20+1,UNLOAD        IS THIS AN UNLOAD SITUATION?    05880000
         BO    OKNE                     YES. RETURN TO BUILDING DCB     05900000
*                                                                       05920000
         TM    IEHMVV20+1,LOAD          IS THIS ALOAD SITUATION ?       05940000
         BO    XLOADX                   YES. GO TO RESOLVE BLOCKSIZE    05960000
*                                       AND RECORD FORMAT FOR LOAD      05980000
         L     R4,IEHMVV30                                              06000000
         L     R5,IEHMVV31              GET POINTERS TO FROM AND TO     06020000
*                                       DCBS                            06040000
         MVC   DCBBLKSI-IHADCB(2,R5),DCBBLKSI-IHADCB(R4)                06060000
*                                       MAKE BLOCKSIZE OF FROM AND TO   06080000
*                                       DCB EQUAL                       06100000
*                                       MAKE RECORD LENGTH AND FORMAT   06120000
*                                       OF BOTH DCBS EQUAL              06140000
         MVC   DCBLRECL-IHADCB(2,R5),DCBLRECL-IHADCB(R4)                06160000
         MVC   DCBRECFM-IHADCB(1,R5),DCBRECFM-IHADCB(R4)                06180000
         NI    DCBRECFM-IHADCB(R5),TRKOFLOW  TURN OFF TRACK-     A26725 06183019
*                                        OVERFLOW BIT IN TO      A26725 06186019
*                                        DCB'S RECFM BYTE (TAPES A26725 06189019
*                                        CANNOT HAVE TRACK-      A26725 06192019
*                                        OVERFLOW RECFM)         A26725 06195019
         B     OKNE                     RETURN TO BUILDING DCB          06200000
XLOADX   DS    0H             THIS ENTRY  POINT IS USED  TO MOVE        06220000
*                             BLOCKSIZE, RECORD LENGTH AND FORMAT       06240000
*                             FROM  THE  DSCB  TO THE  TO DCB           06260000
*                             IN  LOAD  SITUATIONS ONLY                 06280000
         L     R5,IEHMVV31                                              06300000
         L     R4,IEHMVV30+8            GET POINTERS TO TO DCB AND      06320000
*                                       FROM  DSCB                      06340000
         MVC   DCBBLKSI-IHADCB(2,R5),DS1BLKL-DS1DSNAM(R4)               06360000
         MVC   DCBLRECL-IHADCB(2,R5),DS1LRECL-DS1DSNAM(R4)              06380000
         MVC   DCBRECFM-IHADCB(1,R5),DS1RECFM-DS1DSNAM(R4)              06400000
         NI    DCBRECFM-IHADCB(R5),TRKOFLOW  TURN OFF TRACK-     A26725 06403019
*                                        OVERFLOW BIT IN TO      A26725 06406019
*                                        DCB'S RECFM BYTE (TAPES A26725 06409019
*                                        CANNOT HAVE TRACK-      A26725 06412019
*                                        OVERFLOW RECFM)         A26725 06415019
         B     OKNE                     RETURN  TO BUILDING DCB         06420000
         DS    0F                                                       06440000
DCBXX    DC    X'05'                   DCB EXIT LIST ENTRY FOR     UL0H 06460017
         DC    AL3(MYEXIT)              FROM DCB                        06480000
ZZZ      DC    X'0000'                                                  06500000
MYEXIT   DS    0H                                                       06520000
         CLC   DCBDSORG(2),BDAM                                         06540000
         BNE   CBLK                                                     06560000
         TM    DCBRECFM,X'40'    RECFM  U  OR  V                 A21645 06580018
         BO    CBLK                                              A21645 06600018
         OI    DCBOPTCD,RBA            INDICATE USE OF RELATIVE         06620000
*              BLOCK ADDRESSING FOR FIXED LENGTH RECORDS FOR            06640000
*              BDAM.    THIS MUST BE USED TO MOVE TRACK OVERFLOW        06660000
*              BDAM DATA SETS.                                          06680000
FIXED    EQU   X'80'                                                    06700000
RBA      EQU   X'01'                                                    06720000
CBLK     CLC   DCBBLKSI(2),ZZZ         IS BLKSIZE ZEROX                 06740000
         BE    CHBLK                    YES  GO TO CHANGE IT            06760000
DCBRTN   RETURN RC=0                    NO  RETURN TO OPEN J            06780000
CHBLK    DS    0H                                                       06800000
         MVI   IEHMVV10-5,X'05'         SET MESSAGE BYTE                06810022
         MVI   DCBBLKSI,X'0A'                                           06820000
         CLI   DCBRECFM,X'00'          RECFM SPECIFIED           A99999 06830022
         BNE   DCBRTN                  YES  RETURN TO OPEN       A99999 06832022
         MVI   DCBRECFM,X'C0'          NO  MAKE IT UNDEFINED     A99999 06840022
         B     DCBRTN                   RETURN TO OPEN J                06880000
         DS    0F                                                       06900000
XXXT     DC    X'05'                   DCB EXIT LIST ENTRY FOR     UL0H 06920017
         DC    AL3(MYTOEXIT)            TO DCB                          06940000
MYTOEXIT DS    0H             ENTRY POINT GIVEN CONTROL BY OPENJ        06960000
*                             FOR PROCESSING THE TO DCB                 06980000
         L     R4,IEHMVV30                                              07000000
         CLC   DCBBLKSI(2),ZZZ          IS BLOCK SIZE ZERO?             07020000
         BNE   AROUND                   NO. GO TO TEST DSORG            07040000
         TM    IEHMVV20+1,LOAD         WILL THIS REQUEST RESULT IN A    07060000
*                                        LOADED PDS ON THE              07080000
*                                        RECEIVING VOLUME               07100000
         BNO   MVBLK                                            OY01174 07104002
         L     R4,IEHMVV30+8           FROMDSCB ADDR            OY01174 07108002
         CLC   DS1BLKL-DS1DSNAM(2,R4),ZZZ  IF BLKSIZE ZERO      OY01174 07112002
         BNE   JLDCBSET                GO MOVE DCB PARAMETERS   OY01174 07116002
         MVI   DCBBLKSI,X'0A'          ELSE TAKE DEFAULTBLKSI   OY01174 07120002
         MVI   DCBRECFM,X'C0'           AND DEFAULT RECFM       OY01174 07130002
*                                      FROM THE FROM DSCB       OY01174 07140002
         OI    JFCBTSDM,X'01'      INDICATE DSCB COMPLETE       OY01174 07145002
         B     DCBRTN              GO RETURN TO OPEN            OY01174 07150002
MVBLK    EQU   *                                                OY01174 07155002
         MVC   DCBBLKSI(2),DCBBLKSI-IHADCB(R4)                          07160000
*                                       IF BLOCKSIZE IS ZERO, MOVE      07180000
*                                       BLOCKSIZE AND RECORD LENGTH     07200000
*                                       FROM THE FROM DCB TO THE TO DCB 07220000
         MVC   DCBLRECL(2),DCBLRECL-IHADCB(R4)                          07240000
AROUND   CLC   DCBDSORG(2),BDAM         IS TO DSORG BDAM?               07260000
         BNE   TESTTO                   NO. GO TO TEST FOR PREALLOCATE  07280000
DONE     CLC   DCBRECFM(1),ZZZ     IS THE RECFM ZERO               1308 07300014
         BNE   DCBRTN              BRANCH IF NOT ZERO                   07320000
         MVC   DCBRECFM(1),DCBRECFM-IHADCB(R4)                          07340000
*                                  USE RECORD FORMAT OF FROM DCB        07360000
         B     DCBRTN                   RETURN TO OPEN                  07380000
TESTTO   TM    IEHMVV20+3,PREALLOC      HAS THE TO DATA SET BEEN        07400000
*                                       PREALLOCATED?                   07420000
         BZ    DONE                     NO. GO TO FILL IN RECORD FORMAT 07440000
*                                       FIELD AND RETURN TO OPEN        07460000
         TM    IEHMVV20,X'08'           CHECK FOR PDS KEYWORD           07480000
         BO    DONE                IF YES, GO CHECK FOR RECFM      1308 07500014
         MVC   DCBRECFM(1),SAVRECFM   IF NO, USE THE SAVED RECFM   1308 07520014
         CLI    DCBRECFM,X'00'             IS NEW RECFM SPECIFIED       07540000
         BNE    DCBRTN                  YES USE NEW RECFM               07560000
         MVC    DCBRECFM(1),DCBRECFM-IHADCB(R4)   NO MOVE IN OLD RECFM  07580000
*                                       SAVED FROM THE TO DSCB TO FILL  07600000
*                                       IN THE TO DCB                   07620000
         B     DCBRTN                   RETURN TO OPEN                  07640000
JLDCBSET L     R4,IEHMVV30+8           GET PNTR TO FROM DSCB            07660000
*                                      AND FILL IN DCB FIELDS           07680000
         MVC   DCBBLKSI(2),86(R4)                                       07700000
         MVC   DCBRECFM(1),84(R4)                                       07720000
         MVC   DCBLRECL(2),88(R4)                                       07740000
         B     DCBRTN                                                   07760000
BLANKS   DC    CL6'      '                                     @ZA09158 07760104
SCRTCH   DC    CL6'SCRTCH'                                     @ZA09158 07760204
DW       DS    D                                                 A52003 07760422
SAVEREG1 DS    F                                                 A52003 07760522
ZEROS    DC    X'000000'                                         A52003 07760622
ALLZEROS DC    F'0'                                              A52003 07760722
XXOHLE   DC    X'02'                    OUTPUT HEADER LABEL        UL0H 07760917
         DC    AL3(OHLR)                  ROUTINE EXIT             UL0H 07761217
*                                                                  UL0H 07761517
OHLR     DS    0H                                                  UL0H 07761817
OFFSET1  EQU   OHLR-IEHMVESX                                       UL0H 07762117
* USER OUTPUT HEADER LABEL ROUTINE ENTERED FROM OPENJ OF OUTPUT DCBUL0H 07762417
*                                                                  UL0H 07762717
         LA    R8,OFFSET1              SET UP                      UL0H 07763017
         SR    R15,R8                  ADDRESSABILITY              UL0H 07763317
         LR    R11,R15                 FOR EXIT ROUTINE            UL0H 07763617
         CLI   IEHMVV72+8,X'01'         FIRST LABEL SWITCH ON      UL0H 07763917
         BNE   PROVIDE                  NO, PROVIDE NEXT LABEL     UL0H 07764217
         CLC   IEHMVV72(4),ALLZEROS     YES, LABELS IN GOTTEN CORE UL0H 07764517
         BE    IGNORE                   NO, IGNORE LABEL REQUEST   UL0H 07764817
         MVC   IEHMVV72+4(4),IEHMVV72   INITIALIZE LABEL POINTER   UL0H 07765117
         MVI   IEHMVV72+8,X'00'         CLEAR 1ST LABEL SWITCH     UL0H 07765417
PROVIDE  DS    0H                                                  UL0H 07765717
         TM    8(R1),X'80'             I/O ERROR FLG ON IN PARMLST UL0H 07766017
         BO    IOERR                   YES, GIVE MESSAGE           UL0H 07766317
         CLI   IEHMVV72+12,X'00'       LABEL COUNT AT ZERO         UL0H 07766617
         BE    FRECORE                 YES, NO LABELS, FREE CORE   UL0H 07766917
         L     R8,IEHMVV72+4            GET ADDR OF CURRENT LABEL  UL0H 07767217
         L     R15,0(R1)               GET ADDR OF OPEN LBL BUFFER UL0H 07767517
         MVC   0(80,R15),0(R8)         MOVE LABEL TO OUTPUT BUFFER UL0H 07767817
         LA    R8,80(0,R8)              UPDATE POINTER TO NEXT     UL0H 07768117
         ST    R8,IEHMVV72+4              LABEL AND SAVE POINTER   UL0H 07768417
         SR    R15,R15                  REDUCE                     UL0H 07768717
         IC    R15,IEHMVV72+12            USER                     UL0H 07769017
         BCTR  R15,R0                       LABEL                  UL0H 07769317
         STC   R15,IEHMVV72+12                COUNT                UL0H 07769617
*                                                                  UL0H 07769917
         LA    R15,8                    RETURN CODE 8 TO OPEN FOR  UL0H 07770217
         BR    R14                        ANOTHER LABEL            UL0H 07770517
*                                                                  UL0H 07770817
FRECORE  DS    0H                                                  UL0H 07771117
         L     R8,IEHMVV72              GET ADDR OF GOTTEN CORE    UL0H 07771417
         FREEMAIN R,LV=640,A=(R8)       FREE GOTTEN CORE           UL0H 07771717
         XC    IEHMVV72(8),IEHMVV72     RESET POINTERS             UL0H 07772017
*                                                                  UL0H 07772317
IGNORE   DS    0H                                                  UL0H 07772617
         SR    R15,R15                  RETURN CODE 0 TO OPEN TO   UL0H 07772917
         BR    R14                        IGNORE LABELS            UL0H 07773217
*                                                                  UL0H 07773517
*                                                                  UL0H 07773817
*     GIVE MESSAGE--I/O ERROR WRITING USER OUTPUT HEADER LABELS    UL0H 07774117
*                                                                  UL0H 07774417
IOERR    DS    0H                                                  UL0H 07774717
         OI    IEHMVV74+4,X'FF'         YES, SET FLAG TO OUTPUT    UL0H 07775017
*                                        MSG AFTER OPEN/CLOSE/EOV  UL0H 07775317
         B     FRECORE                  GO FREE GOTTEN CORE        UL0H 07775617
*                                                                       07775917
IOERRMSG DS    0H                                                  UL0H 07776217
         OI    IEHMVV74+4,X'00'         CLEAR I/O ERROR FLAG       UL0H 07776517
         SR    R4,R4                    CLEAR REG 4                UL0H 07776817
         IC    R4,IEHMVV61             SAVE CURRENT MSG CODE       UL0H 07777117
         MVI   IEHMVV61,X'0B'          MOVE IN CODE FOR THIS MSG   UL0H 07777417
         L     R15,ADMSG               GET ADDR OF MSG WRITER      UL0H 07777717
         BALR  R14,R15                 AND GO GIVE MSG             UL0H 07778017
         STC   R4,IEHMVV61             RESTORE TO PREV. VALUE      UL0H 07778317
         B     ERMSGRET                 RETURN TO INLINE PROCESSINGUL0H 07778617
*                                                                       07780000
ADIHLR   DC    X'01'             INPUT HEADER LABEL ROUTINE     OY01176 07800002
         DC    AL3(IHLR)         DCB-EXLIST ENTRY               OY01176 07800502
IHLR     DS    0H                                               OY01176 07801002
OFFSET   EQU   IHLR-IEHMVESX                                    OY01176 07801502
         LA    R8,OFFSET         SET UP                         OY01176 07802002
         SR    R15,R8            ADDRESSABILITY                 OY01176 07802502
         LR    R11,R15           FOR EXIT ROUTINE               OY01176 07803002
         L     R8,0(R1)          GET ADDR. OF LABEL BUFFERAREA  OY01176 07803502
         LTR   R8,R8             ARE USER LABELS PRESENT        OY01176 07804002
         BNE   CHKIOERR          YES,IS I/O-ERROR INDICATED     OY01176 07804502
NOLABEL  SR    R15,R15           NO,RETURN TO OPEN,RETURNCODE 0 OY01176 07805002
         BR    R14                                              OY01176 07805502
CHKIOERR DS    0H                                               OY01176 07806002
         TM    8(R1),X'80'       PERM.ERROR SHOWN IN PARMLIST   OY01176 07806502
         BC    14,CORAVAIL       NO,SEE IF CORE GOTTEN YET      OY01176 07807002
LABLERR  DS    0H                                               OY01176 07807502
         OI    IEHMVV74+4,X'FF'  YES,SET FLAG TO OUTPUT MSG     OY01176 07808002
         MVI   UDCBIHLE,X'00'    DEACTIVATE HEADER LABEL ENTRIES Y01176 07808502
         MVI   UDCBOHLE,X'00'    IN DCB-EXIT LIST               OY01176 07809002
         OI    IEHMVV20+2,X'40'  TELL ESN TO PUT OUT MSG        OY01176 07809502
         BR    R14               RETURN TO OPENJ                OY01176 07810002
CORAVAIL DS    0H                                               OY01176 07810502
         CLC   IEHMVV72(4),ALLZEROS WAS CORE GOTTEN FOR LABELS  OY01176 07811002
         BNE   SAVLABEL          ADDR.NOT ZERO,CORE GOTTEN      OY01176 07811502
         GETMAIN R,LV=640        GET CORE IF NECESSARY          OY01176 07812002
         ST    R1,IEHMVV72       SAVE ADDR.OF GOTTEN CORE       OY01176 07812502
         MVC   IEHMVV72+4(4),IEHMVV72 SAVE PTR TO LABELSAVEAREA OY01176 07813002
SAVLABEL DS    0H                                               OY01176 07813502
         L     R9,IEHMVV72+4     GET ADDR.CURRENT LBL-SAVEAREA  OY01176 07814002
         MVC   0(80,R9),0(R8)    MOVE LBL TO AREA FROM LABELBF  OY01176 07814502
         LA    R9,80(R9)         UPDATE PTR TO NEXT AREA        OY01176 07815002
         ST    R9,IEHMVV72+4     STORE UPDATED PTR              OY01176 07815502
         SR    R9,R9                                            OY01176 07816002
         IC    R9,IEHMVV72+12    PICK UP COUNT OF LABELS        OY01176 07816502
         LA    R9,1(R9)          INCREMENT COUNT BY 1           OY01176 07817002
         STC   R9,IEHMVV72+12    STORE UPDATED COUNT            OY01176 07817502
         LA    R15,4             RETCODE 4 TO GET ADDIT.LABELS  OY01176 07818002
         BR    R14               RETURN TO OPENJ-ROUTINE        OY01176 07818502
ABORT    DS    0H             THIS ENTRY POINT IS USED TO ABNORMALLY    07820000
*                             TERMINATE A REQUEST WHICH INVOLVES MORE   07840000
*                             THAN 5 VOLUMES.                           07860000
         MVI   IEHMVV61,X'07'           SET MESSAGE CODE TO PRINT MSG   07880000
*                                       INDICATING WHY THIS REQUEST IS  07900000
*                                       BEING TERMINATED.               07920000
ABEND    L     R14,PREAB                                                07940000
         BR    R14                      GOTO PREABORT ROUTINE WHICH     07960000
*                                       PRINTS MSG, CLOSES THE FROM AND 07980000
*                                       TO DCBS IF THEY HAVE BEEN       08000000
*                                       OPENED, AND RETURNS CONTROL TO  08020000
*                                       IEHMVESH IF THERE IS ANOTHER    08040000
*                                       REQUEST OR TO IEHMVESK IF THERE 08060000
*                                       ARE NO MORE REQUESTS.           08080000
*                                                                       08100000
*                                                                       08120000
*                                                                       08140000
*                             DCB BUILDER ROUTINE                       08160000
*********************************************************************** 08180000
*    THIS ROUTINE FORMATS A DCB FOR THE FROM AND TO DATA SETS         * 08200000
* ACCORDING TO THE DATA SET ORGANIZATION INDICATED IN REGISTER 0      * 08220000
*    THE ROUTINE USES THE CODE IN REGISTER 0 TO SEARCH A TABLE        * 08240000
* FOR THE APPROPRIATE DCB FORMAT.                                     * 08260000
*    IF THE ORGANIZATION REQUESTED IS INVALID, THE REQUEST IS         * 08280000
* TERMINATED.  IF THE SOURCE DATA SET IS NOT A PHYSICAL SEQUENTIAL,   * 08300000
* PARTITIONED, OR DIRECT ACCESS(BDAM) DATA SET, IT CANNOT BE PROCESSED* 08320000
* BY THE UTILITY PROGRAM.                                             * 08340000
*                                                                     * 08360000
*                                                                     * 08380000
* INPUT:            REG 0 CONTAINS DSORG CODE                         * 08400000
*                   REG1 INDICATES WHETHER DCB IS FOR                 * 08420000
*                          INPUT OR OUTPUT.                           * 08440000
*                                                                     * 08460000
*                           0 = INPUT                                 * 08480000
*                           1 = OUTPUT                                * 08500000
*                                                                     * 08520000
*                                                                     * 08540000
* OUTPUT:           REG7  CONTAINS POINTER TO DCB                     * 08560000
*                                                                     * 08580000
*                                                                     * 08600000
*    DCBS ARE BUILT IN THE PERMANENT WORK AREA AND EACH TIME          * 08620000
* A DCB IS BUILT, THE POINTER TO THE BEGINNING OF THE                 * 08640000
* PERMANENT WORK AREA IS DISPLACED BY THE LENGTH OF THE DCB           * 08660000
*                                                                     * 08680000
*                                                                     * 08700000
* ERRORS       INVALID DSORG.  REQUEST IS TERMINATED.                 * 08720000
*                                                                     * 08740000
*                                                                     * 08760000
* ENTRY POINT: DCBBUILD                                               * 08780000
*********************************************************************** 08800000
*                                                                       08820000
*                                                                       08840000
         ENTRY DCBBUILD                                                 08860000
DCBBUILD DS    0H             ENTRY POINT TO DCB BUILDER ROUTINE        08880000
         USING DCBBUILD,R15             SET UP ADDRESSABILITY.R15       08900000
*                                       LOADED BY CALLING ROUTINE       08920000
         LA    R4,SCHTABLE              GET ADDRESS OF DSORG TABLE      08940000
*                                       AND FIND DSORG REQUESTED        08960000
BBLOOP   CH    R0,0(R4)                 IS THIS THE DSORG NEEDED?       08980000
         BE    BBFND                    YES. GO TO FILL IN DCB FIELDS   09000000
         CLI   0(R4),X'FF'              NO. IS THIS END OF TABLE?       09020000
         BE    BBEND                    YES. GO TO LOAD ERROR CODE      09040000
         LA    R4,6(R4)                 NO. INCREMENT TABLE POINTER     09060000
         B     BBLOOP                   AND RETURN TO SEARCH AGAIN.     09080000
BBEND    DS    0H            ENTRY POINT FOR ABORTING REQUEST IF        09100000
*                            DSORG IS INVALID.  FOR THE PURPOSES OF     09120000
*                            THIS PROGRAM, THE DSORG IS INVALID IF IT   09140000
*                            IS NOT PS, BDAM, OR BPAM.                  09160000
         MVI   IEHMVV61,X'09'          SET MSG CODE INVALID DSORG AND   09180000
*                                      ABORT REQUEST                    09200000
         B     ABEND                                                    09220000
*                                                                       09240000
*                                                                       09260000
BBFND    DS    0H             ENTRY POINT WHEN CORRECT DSORG HAS        09280000
*                             BEEN FOUND. DCB DISPLACEMENTS ARE         09300000
*                             COMPUTED HERE AND DCB FIELDS ARE          09320000
*                             FILLED IN.                                09340000
*                                                                       09360000
         L     R7,IEHMVV10              GET POINTER TO BEGINNING        09380000
*                                       OF PERMANENT WORK AREA          09400000
         LH    R5,4(R4)                 GET DCB LENGTH FROM DSORG       09420000
*                                       TABLE.                          09440000
         LA    R10,0(R5,R7)             ADJUST PERMANENT WORK AREA      09460000
*                                       POINTER BY DCB LENGTH.          09480000
         ST    R10,IEHMVV10                                             09500000
         EX    R5,ZERDCB                ZERO OUT DCB AREA.              09520000
         LH    R4,2(R4)                 PICKUP RELATIVE DISPLACEMENT    09540000
*                                       OF DCB ENTRY TABLE FROM         09560000
*                                       SEARCH TABLE AND                09580000
         LA    R5,TOPTAB                                                09600000
         LA    R5,0(R4,R5)              AND USE IT TO CALCULATE         09620000
*                                       POINTER TO THE DCB FIELDS       09640000
*                                       TO BE FILLED IN.                09660000
*                                                                       09680000
BBGO     DS    0H             ENTRY POINT OF LOOP WHICH FILLS IN        09700000
*                             THE DCB FROM CONTROL FIELDS IN            09720000
*                             THE DCB ENTRY TABLE.                      09740000
         CLI   0(R5),X'FF'              IS THIS THE END OF DCB          09760000
*                                       ENTRY TABLE?                    09780000
         BE    BBDONE                   YES. DCB HAS BEEN BUILT.        09800000
*                                       RETURN TO CALLING ROUTINE       09820000
         SR    R4,R4                    NO.                             09840000
         IC    R4,0(R5)                 GET RELATIVE POSITION OF DCB    09860000
*                                       FIELD TO BE FILLED              09880000
         SR    R3,R3                    GET LENGTH OF DCB FIELD         09900000
         IC    R3,1(R5)                 TO BE FILLED                    09920000
*                                                                       09940000
         LR    R10,R3                   HOLD FIELD LENGTH FOR LATER USE 09960000
         BCTR  R10,R0                   REDUCE FIELD LENGTH BY ONE      09980000
*                                       FOR CORRECT MOVE LENGTH         10000000
         LA    R6,2(R5)                 ADJUST POINTER TO THE DCB       10020000
*                                       ENTRY TABLE TO THE FIELD TO     10040000
*                                       BE MOVED.                       10060000
         LTR   R1,R1                    IS THIS DCB FOR INPUT?          10080000
         BZ    BBMOVE                   YES.                            10100000
         LA    R6,0(R3,R6)              NO. ADJUST POINTER TO OUTPUT    10120000
*                                       FLAG FIELD                      10140000
BBMOVE   DS    0H             ENTRY POINT FOR MOVE OPERATION            10160000
*                             AND LOOP MODIFICATION.                    10180000
         LA    R4,0(R4,R7)              CALCULATE POINTER TO FIELD      10200000
*                                       TO BE FILLED                    10220000
         EX    R10,BBM                  MOVE ENTRY FROM DCB ENTRY       10240000
*                                       TABLE TO THE DCB                10260000
         LA    R5,2(R5,R3)              ADJUST DCB ENTRY TABLE          10280000
         LA    R5,0(R5,R3)              POINTER TO NEXT FIELD TO        10300000
*                                       BE MOVED.                       10320000
         B     BBGO                     RETURN TO BEGINNING OF          10340000
*                                       LOOP                            10360000
BBDONE   DS    0H             EXIT LABEL                                10380000
         BR    R14                      NORMAL RETURN                   10400000
*                                                                       10420000
ZERDCB   XC    0(1,R7),0(R7)            ZERO OUT DCB AREA               10440000
BBM      MVC   0(1,R4),0(R6)            MOVE FIELD FROM DCB ENTRY       10460000
*                                       TABLE TO DCB BEING BUILT.       10480000
         DROP  R15                                                      10500000
ADMSG    DC    A(MSG)                   EXTERNAL REFERENCE.             10520000
PREAB    DC    A(PREABORT)              EXTERNAL REFERENCE              10540000
SCSV1    DS    3F                                               YL026VC 10542002
SCSV2    DS    2F                                               YL026VC 10544002
BDAM     DC    X'2000'                                                  10560000
SL       EQU   X'02'       INDICATES STANDARD LABEL              A32041 10570020
SAVRECFM DS    CL1                                                      10580000
         DS    CL1                                                      10600000
         EJECT                                                          10620000
SCHTABLE EQU   *                                                        10640000
         DC    X'4000'                  PS                              10660000
         DC    AL2(PSXXX-TOPTAB)                                        10680000
     DC   FL2'120'                                                      10700000
         DC    X'2000'                  BDAM                            10720000
         DC    AL2(BDAMXXX-TOPTAB)                                      10740000
    DC   FL2'120'                                                       10760000
         DC    X'0200'                  POS                             10780000
         DC    AL2(PDSXXX-TOPTAB)                                       10800000
    DC   FL2'120'                                                       10820000
         DC    X'0001'                  UNLOAD                          10840000
         DC    AL2(UNLDXXX-TOPTAB)                                      10860000
    DC  FL2'120'                                                        10880000
         DC    X'0000'                                                  10900000
         DC    AL2(PSXXX-TOPTAB)                                        10920000
      DC   FL2'120'                                                     10940000
         DC    X'0002'                                                  10960000
         DC    AL2(CATDCB-TOPTAB)                                       10980000
         DC    FL2'120'                                                 11000000
         DC    X'FFFF'                                                  11020000
TOPTAB   EQU   *                        TOP OF DCB ENTRY TABLE          11040000
CATDCB   EQU   *                                                        11060000
         DC    AL1(DCBDSORG-IHADCB)                                     11080000
         DC    X'02'                                                    11100000
         DC    X'4000'                                                  11120000
         DC    X'4000'                                                  11140000
         DC    AL1(DCBOFLGS-IHADCB)                                     11160000
         DC    X'01'                                                    11180000
         DC    X'02'                                                    11200000
         DC    X'02'                                                    11220000
         DC    AL1(DCBMACR-IHADCB)                                      11240000
         DC    X'02'                                                    11260000
       DC    X'2400'                                                    11280000
         DC    X'0020'                                                  11300000
         DC    AL1(DCBBLKSI-IHADCB)                                     11320000
         DC    X'02'                                                    11340000
         DC    X'0100'                                                  11360000
         DC    X'0100'                                                  11380000
         DC    AL1(DCBKEYLE-IHADCB)                                     11400000
         DC    X'01'                                                    11420000
         DC    X'08'                                                    11440000
         DC    X'08'                                                    11460000
         DC    AL1(DCBRECFM-IHADCB)                                     11480000
         DC    X'01'                                                    11500000
         DC    X'81'                                                    11520000
         DC    X'81'                                                    11540000
         DC    X'FF'                                                    11560000
PSXXX    EQU   *                        START OF PS DCB ENTRIES         11580000
         DC    AL1(DCBDSORG-IHADCB)                                     11600000
         DC    X'02'                                                    11620000
         DC    X'4000'                                                  11640000
         DC    X'4000'                                                  11660000
         DC    AL1(DCBOFLGS-IHADCB)                                     11680000
         DC    X'01'                                                    11700000
         DC    X'02'                                                    11720000
         DC    X'02'                                                    11740000
         DC    AL1(DCBMACR-IHADCB)                                      11760000
         DC    X'02'                                                    11780000
         DC    X'2000'                                                  11800000
         DC    X'0020'                                                  11820000
         DC    X'FF'                    END OF PS DCB ENTRIES           11840000
BDAMXXX  EQU   *                        START OF BDAM DCB ENTRIES       11860000
         DC    AL1(DCBDSORG-IHADCB)                                     11880000
         DC    X'02'                                                    11900000
         DC    X'2000'                                                  11920000
         DC    X'4000'                                                  11940000
         DC    AL1(DCBMACR-IHADCB)                                      11960000
         DC    X'02'                                                    11980000
         DC    X'2800'                                                  12000000
         DC    X'0028'                                                  12020000
         DC    AL1(DCBOFLGS-IHADCB)                                     12040000
         DC    X'01'                                                    12060000
         DC    X'02'                                                    12080000
         DC    X'02'                                                    12100000
         DC    AL1(DCBOPTCD-IHADCB)                                     12120000
         DC    X'01'                                                    12140000
         DC    X'10'                                                    12160000
         DC    X'00'                                                    12180000
         DC    AL1(DCBDSORG-IHADCB)                                     12200000
         DC    X'02'                                                    12220000
         DC    X'2000'                                                  12240000
         DC    X'4000'                                                  12260000
         DC    AL1(DCBMACR-IHADCB)                                      12280000
         DC    X'02'                                                    12300000
         DC    X'2800'                                                  12320000
         DC    X'0028'                                                  12340000
         DC    AL1(DCBOFLGS-IHADCB)                                     12360000
         DC    X'01'                                                    12380000
         DC    X'02'                                                    12400000
         DC    X'02'                                                    12420000
         DC    AL1(DCBOPTCD-IHADCB)                                     12440000
         DC    X'01'                                                    12460000
         DC    X'10'                                                    12480000
         DC    X'00'                                                    12500000
         DC    X'FF'                    END OF BDAM DCB ENTRIES         12520000
UNLDXXX  EQU   *                        START OF UNLOAD DCB ENTRIES     12540000
         DC    AL1(DCBDSORG-IHADCB)                                     12560000
         DC    X'02'                                                    12580000
         DC    X'4000'                                                  12600000
         DC    X'4000'                                                  12620000
         DC    AL1(DCBBUFNO-IHADCB)                                     12640000
         DC    X'04'                                                    12660000
         DC    X'00000001'                                              12680000
         DC    X'00000001'                                              12700000
         DC    AL1(DCBBUFL-IHADCB)                                      12720000
         DC    X'02'                                                    12740000
         DC    X'0000'                                                  12760000
         DC    X'0320'                                                  12780000
         DC    AL1(DCBBFTEK-IHADCB)                                     12800000
         DC    X'01'                                                    12820000
         DC    X'00'                                                    12840000
         DC    X'40'                                                    12860000
         DC    AL1(DCBBLKSI-IHADCB)                                     12880000
         DC    X'02'                                                    12900000
         DC    X'0000'                                                  12920000
         DC    X'0320'                                                  12940000
         DC    AL1(DCBLRECL-IHADCB)                                     12960000
         DC    X'02'                                                    12980000
         DC    X'0000'                                                  13000000
         DC    X'0050'                                                  13020000
         DC    AL1(DCBRECFM-IHADCB)                                     13040000
         DC    X'01'                                                    13060000
         DC    X'C0'                                                    13080000
     DC   X'90'                                                         13100000
         DC    AL1(DCBMACR-IHADCB)                                      13120000
         DC    X'02'                                                    13140000
         DC    X'2000'                                                  13160000
         DC    X'4848'                                                  13180000
         DC    AL1(DCBOFLGS-IHADCB)                                     13200000
         DC    X'01'                                                    13220000
         DC    X'02'                                                    13240000
         DC    X'02'                                                    13260000
         DC    X'FF'                    END OF UNLOAD DCB ENTRIES       13280000
PDSXXX   EQU   *                                                        13300000
         DC    AL1(DCBDSORG-IHADCB)          DSORG FIELD                13320000
         DC    X'02'                         LENGTH                     13340000
         DC    X'0200'                       PDS FROM                   13360000
         DC    X'0200'                       PDS TO                     13380000
         DC    AL1(DCBMACR-IHADCB)           MACR                       13400000
         DC    X'02'                                                    13420000
         DC    X'2400'                                                  13440000
         DC    X'0024'                                                  13460000
         DC    AL1(DCBOFLGS-IHADCB)                                     13480000
         DC    X'01'                                                    13500000
         DC    X'02'                                                    13520000
         DC    X'02'                                                    13540000
         DC    X'FF'                                                    13560000
DCBB     DC    A(DCBBUILD)                                              13580000
         DCBD  DSORG=(PS,IS,DA,PO)                                      13600000
         EJECT                                                          13620000
JFCBX    DSECT                                                          13640000
         IEFJFCBN                                                       13660000
XLIST    DS    2F                                                       13680000
*                             EXIT  LIST  SPACE  ALLOCATION             13700000
         IEHMVV                                                         13720000
         ORG   IEHMVV70                                            UL0H 13726017
         IEHDCBXL                                                  UL0H 13732017
         ORG   IEHMVV00                                                 13740000
         IECSDSL1 (1)                                                   13760000
         IKJTCB LIST=YES                                        YL026VC 13762002
         IEZJSCB                                                YL026VC 13764002
         IHAQDB                                                 YL026VC 13766002
         IHADSAB                                                YL026VC 13768002
         IEZDEB LIST=YES                                        YL026VC 13770002
         END                                                            13780000
