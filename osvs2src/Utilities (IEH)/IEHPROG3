   TITLE  'IEHPROGM - IEHPROG3  MESSAGE WRITER MODULE'                  00050002
*********************************************************************** 00100002
*                                                                     * 00150002
* MODULE NAME -- IEHPROG3                                      YL026VC* 00160002
*                                                              YL026VC* 00170002
* DESCRIPTIVE NAME -- IEHPROGM MESSAGE WRITER MODULE           YL026VC* 00180002
*                                                              YL026VC* 00190002
* COPYRIGHT -- NONE                                            YL026VC* 00192002
*                                                              YL026VC* 00194002
* STATUS -- 'IEHPROG3'  OS/VS2 PROLOGUE MODIFICATION           YL026VC* 00200002
*    NOVEMBER 1972                                             YL026VC* 00250002
*                                                              YL026VC* 00260002
* FUNCTION -- THIS MODULE IS THE GENERALIZED MESSAGE WRITER FOR       * 00300002
*    IEHPROGM.                                                        * 00350002
*                                                                     * 00400002
* ENTRY POINTS --                                                     * 00450002
*         IEHPROG3 IS THE ONLY ENTRY POINT FOR THIS MODULE.  IT IS    * 00500002
*    USED WHETHER DIAGNOSTIC MESSAGES OR INFORMATIONAL MESSAGES       * 00550002
*    ARE TO BE PRINTED.                                               * 00600002
*                                                                     * 00650002
* INPUT --INPUT TO IEHPROG3 IS TWOFOLD.  FIRST, REGISTER 0 WILL       * 00700002
*    CONTAIN ALL INFORMATION AS TO WHETHER THE MESSAGE TO BE          * 00750002
*    PRINTED IS AN INFORMATIONAL MESSAGE OR A DIAGNOSTIC MESSAGE,     * 00800002
*    AND SECONDLY, IF THE MESSAGE IS INFORMATIONAL THE MESSAGE        * 00850002
*    TEXT WILL RESIDE IN AN AREA IN A COMMUNICATION REGION.  IF THE   * 00900002
*    MESSAGE IS IN THIS COMMUNICATION AREA, REGISTER 0 WILL CONTAIN   * 00950002
*    INFORMATION TO DETERMINE WHERE THE MESSAGE IS LOCATED.           * 01000002
*                                                                     * 01050002
* OUTPUT -- THE OUTPUT FROM THIS PART OF IEHPROGM IS THE WRITING      * 01100002
*    OR PRINTING OF THE MESSAGE REQUESTS FROM THE OTHER MODULES       * 01150002
*    OF IEHPROGM.                                                     * 01200002
*                                                                     * 01250002
* EXTERNAL REFERENCES -- THIS ROUTINE HAS NO EXTERNAL ROUTINES.       * 01300002
*                                                                     * 01350002
* EXITS, NORMAL -- THIS MODULE DOES A BRANCH ON REGISTER 15 TO        * 01400002
*    RETURN TO ITS CALLING MODULE.                                    * 01450002
*                                                                     * 01500002
* EXITS, ERROR -- THIS MODULE DOES A BRANCH ON REGISTER 15 TO         * 01550002
*    RETURN TO ITS CALLING MODULE.                                    * 01600002
*                                                                     * 01650002
* TABLES/WORK AREA --                                                 * 01700002
*    DSECT IS A COMMON COMMUNICATIONS AND WORK AREA POINTED TO BY     * 01750002
*    REGISTER 12 AND DESCRIBED BY A DSECT NAMED DSECT AND BEGINNING   * 01800002
*    IEHECHAR.                                                        * 01850002
*    MSGADS IS A TABLE THAT IS SPLIT INTO TWO GENERAL PARTS.  THE     * 01900002
*    FIRST PART IS A TABLE OF ADDRESS CONSTANTS OF THE MESSAGES       * 01950002
*    THEMSELVES.  THE MESSAGES THEN MAKE UP THE SECOND PART OF THE    * 02000002
*    TABLE.  ALSO INTEGRATED WITHIN THE TABLE OF ADCONS ARE           * 02050002
*    INSTRUCTIONS WHICH ARE EXECUTED IF THE MESSAGE REQUESTS          * 02100002
*    ARE FOR INFORMATIONAL MESSAGES.                                  * 02150002
*                                                                     * 02200002
* ATTRIBUTES -- THIS MODULE OPERATES AS ONE LEG OF AN OVERLAY         * 02250002
*    STRUCTURE.                                                       * 02300002
*                                                                     * 02350002
* CHARACTER CODE DEPENDENCY -- THIS MODULE MUST BE ASSEMBLED IN       * 02400002
*    EBCDIC AND RUN IN EBCDIC TO INSURE COLLATING SEQUENCE AND        * 02450002
*    INTERNAL REPRESENTATION OF CERTAIN CHARACTERS.                   * 02500002
*                                                                     * 02550002
* NOTES -- APPROXIMATELY 3400 BYTES OF STORAGE ARE REQUIRED FOR       * 02600002
*    CODE.                                                            * 02650002
*                                                                     * 02700002
* CHANGE ACTIVITY -- FOLLOWS PROLOGUE                          YL026VC* 02710002
*                                                              YL026VC* 02720002
*********************************************************************** 02750002
IEHPROG3 CSECT                                                    M2838 02800002
*             VS2 SU32 DELETIONS                               @G32DSFS 02802032
*D129740,241890-241910,241930-241960                           @G32DSFS 02804032
*                                                              @G32DSFS 02806032
*C234000-234100                                                 YL026VC 02810002
*A87240                                                          YM5077 02850002
*A45000,70366-70426                                              A57261 02900002
*A44500,70354-70370                                              YM5076 02950002
*C400,14800                                                       M2838 03000002
*A44000,70310-70370                                              A50977 03050002
*                                                                  I276 03100002
*1051070200                                                        BS0H 03150002
*2353                                                              DT0I 03200002
*                                                                A23466 03250002
*                                                                A25564 03300002
*                                                                A24020 03350002
*                                                                A28562 03400002
*                                                                A28552 03450002
*A1600-1940,2600,27100-27200                                    YL026VC 03460002
*C2000-2500                                                     YL026VC 03470002
*A 198500                                                       YA01707 03480002
*C 198500,199500                                                YA01707 03490002
*A 1981000                                                     @ZA01675 03491002
*D 199000                                                      @ZA01675 03491102
*C234000-234100                                                @VS30028 03492003
*                                                              @Z40RSDS 03494032
*                   *****     REGISTER  USAGE     *****                 03500002
ZERO     EQU   0        ----------------------------------------        03550002
R1       EQU   12                                                       03600002
R2       EQU   2                                                        03650002
R3       EQU   3             REGISTERS ZERO THROUGH                     03700002
R4       EQU   4             TEN ARE WORK REGISTERS                     03750002
R5       EQU   5                                                        03800002
R6       EQU   6             REGESTERS ELEVEN AND                       03850002
R7       EQU   7             TWELVE ARE BASE REGISTERS                  03900002
R8       EQU   8             FOR THE PROGRAN AND THE                    03950002
R9       EQU   9             DUMMY SECTION RESPECTIVELY                 04000002
R10      EQU   10                                                       04050002
RB       EQU   11            THIRTEEN POINTS TO A REGISTER              04100002
RBD      EQU   12                                                       04150002
SAVEREG  EQU   13            SAVE AREA                                  04200002
RETURN   EQU   14                                                       04250002
LINKREG  EQU   15            FIFTEEN AND FOURTEEN ARE LINK              04300002
PARAMREG EQU   0             AND RETURN REGISTERS RESPECTIVELY          04350002
LISTREG  EQU   1        -----------------------------------------       04400002
*                                                                       04450002
         USING IEHECHAR,R1                                              04500002
         SAVE  (14,12)            SAVE REGISTERS                  M2838 04550002
         ST    PARAMREG,IEHERSAV  SAVE PARAMETER LIST             M2838 04600002
         BALR  RB,0                ESTABLISH ADDRESSABILITY             04650002
         USING *,RB                                                     04700002
         ST    SAVEREG,SAVEREG3+4 KEEP OLD SAVE AREA              M2838 04750002
         LA    SAVEREG,SAVEREG3   ESTABLISH NEW SAVE AREA         M2838 04800002
         TM    IEHERSAV+1,X'02'                                         04850002
         BZ    NOSEARCH                                                 04900002
         LA    R2,MSGOUT+110       FIND  DISPLACEMENT NEEDED            04950002
         LA    R3,112                                                   05000002
         CLI   0(R2),C' '          TO  PLACE THIS MESSAGE               05050002
         BNE   *+10                                                     05100002
         BCTR  R2,0                2 BYTES ABOVE THE LAST               05150002
         BCT   R3,*-10                                                  05200002
         STC   R3,IEHERSAV+2       CHARACTER IN THE OUTPUT AREA         05250002
NOSEARCH EQU   *                                                        05300002
         LA    R4,255                                                   05350002
         NR    R4,PARAMREG                                              05400002
         LA    R5,MSGADS                                                05450002
        SLA   R4,2          MSG NUM. TIMES 4 AND SET CONDITION CODE     05500002
         BZ    WRITENOW                MSG IS IN OUT AREA WRITE IT      05550002
         AR    R4,R5                                                    05600002
         LA    R8,WTO              BE PREPARED FOR A WTO                05650002
         L     6,0(R4)             IF WE DO NOT HAVE AN ADCON           05700002
         TM    0(R4),X'41'         FOR THE MESSAGE                      05750002
         BZ    *+8                 EXECUTE THE LOAD ADDRESS             05800002
         EX    0,0(R4)             TO GET IT.                           05850002
         SR    R4,R4               CLEAR REGISTER 4                     05900002
         IC    R4,0(R6)            PUT MESSAGE LENGTH INTO IT           05950002
         SR    R7,R7                                                    06000002
         IC    R7,IEHERSAV+2                                            06050002
         LA    R7,MSGOUT(R7)                                            06100002
         EX    R4,MOVEMSG                                               06150002
         TM    IEHERSAV+1,X'01'   SHOULD WE WRITE THIS MESSAGE ?        06200002
         BO    MSGEXIT            NO --- BRANCH                         06250002
WRITENOW LA    R2,MSGOUT-1                                              06300002
         MVI   MSGOUT-1,C' '       SET ASA FOR SINGLE SPACE             06350002
         EX    0,WRITEIT                                                06400002
         MVC   MSGOUT(121),MSGOUT-1     CLEAR THE BUFFER                06450002
         LH    R3,LINECNT                                               06500002
         LA    R3,1(R3)                                                 06550002
         CH    R3,MAXLINES                                              06600002
         BH    EJECT                                                    06650002
         STH   R3,LINECNT                                               06700002
         B     CLEARMSG                                                 06750002
WRITEIT  BAL   R5,*+4                                                   06800002
         PUT   UTOUTDCB,(R2)                                            06850002
         BR    R5                                                       06900002
EJECT    EQU   *                                                        06950002
         LA    R2,WRITEHDR                                              07000002
         EX    0,WRITEIT           WRITE HEADER AND SPACE FORMS         07050002
         MVI   LINECNT+1,X'04'     RESET LINE COUNT TO 4                07100002
         PACK  DBLWORD(8),PAGENUM(4)                                    07150002
         CVB   R5,DBLWORD                                               07200002
         LA    R5,1(R5)                                                 07250002
         CVD   R5,DBLWORD                                               07300002
         UNPK  PAGENUM(4),DBLWORD(8)                                    07350002
         OI    PAGENUM+3,X'F0'                                          07400002
         B     UPTHREE             GO SPACE THE FORMS                   07450002
SPACE    LH    R3,LINECNT                                               07500002
         LA    R3,3(R3)            IF A TRIPPLE SPACE WILL              07550002
         CH    R3,MAXLINES         CAUSE AN OVERFLOW                    07600002
         BNL   EJECT               GO TO THE EJECT ROUTINE              07650002
         STH   R3,LINECNT               --OTHERWIZE--                   07700002
UPTHREE  MVI   MSGOUT-1,C'-'       SET ASA FOR TRIPLE SPACE             07750002
         LA    R2,MSGOUT-1                                              07800002
         EX    0,WRITEIT           GIVE THE SPACE COMMAND               07850002
         B     CLEARMSG            TAKE THE EXIT                        07900002
WTO      LH    LISTREG,0(LISTREG)  GET DISPLACEMENT TO PROPER WTO       07950002
         LA    LISTREG,MSGADS(LISTREG)  GET ADDRESS OF PROPER WTO       08000002
         WTO   MF=(E,(1))               WRITE TO THE OPERATOR           08050002
         B     MSGEXIT                  ......EXIT......                08100002
CLEARMSG MVI   MSGOUT,C' '                                              08150002
         MVC   MSGOUT+1(119),MSGOUT    CLEAR THE OUTPUT AREA            08200002
MSGEXIT  L     SAVEREG,SAVEREG3+4 RETRIEVE OLD SAVE AREA          M2838 08250002
         LM    14,12,12(13)       RESTORE REGS                    M2838 08300002
         L     PARAMREG,IEHERSAV  RESTORE PARAMETERS              M2838 08350002
         L     15,DECB2+4               GET RETURN ADDRESS              08400002
         BR    15                                                       08450002
MOVEMSG  MVC   0(1,R7),1(R6)                                            08500002
         DS    0F                                                       08550002
MSGADS   EQU   *-4                                                      08600002
         DC    A(MSG3)        FOR A 1 WRITE MSG 3                       08650002
         DC    A(MSG2)                                                  08700002
         DC    A(MSG3)                                                  08750002
         DC    A(MSG4)                                                  08800002
*              THESE INSERTS TO ALLOW GETTING DYNAMIC MESSAGES          08850002
         LA    R6,FNSA                                                  08900002
         LA    R6,KWSA                                                  08950002
         LA    R6,PARAM2-1                                              09000002
         LA    R6,PARAM4-1                                              09050002
         DC    A(MSG9)                                                  09100002
         DC    A(MSG3)        FOR A10 WRITE MSG 3                       09150002
         DC    A(MSG11)                                                 09200002
         DC    A(MSG12)                                                 09250002
         DC    A(0)           NO SUCH MESSAGE                           09300002
         DC    AL4(MSG14)                                               09350002
         DC    AL4(MSG15)                                               09400002
         DC    AL4(MSG16)                                               09450002
         DC    AL4(MSG17)                                               09500002
         DC    A(0)           NO SUCH MESSAGE                           09550002
        DC    AL4(MSG19)                                                09600002
         DC    A(MSG20)                                                 09650002
         DC    A(MSG21)                                                 09700002
         DC    A(MSG22)                                                 09750002
         DC    A(MSG23)                                                 09800002
         DC    A(MSG24)                                                 09850002
         DC    A(MSG25)                                                 09900002
         DC    A(MSG26)                                                 09950002
         DC    A(MSG27)                                                 10000002
         DC    A(MSG28)                                                 10050002
         DC    A(MSG29)                                                 10100002
         DC    A(MSG30)                                                 10150002
         DC    A(MSG31)                                                 10200002
         DC    A(MSG32)                                                 10250002
         DC    A(MSG33)                                                 10300002
         DC    A(MSG34)                                                 10350002
         DC    A(MSG35)                                                 10400002
         DC    A(MSG36)                                                 10450002
         DC    A(MSG37)                                                 10500002
         DC    A(MSG38)                                                 10550002
         DC    A(MSG39)                                                 10600002
         DC    A(MSG40)                                                 10650002
         DC    A(MSG41)                                                 10700002
         DC    A(MSG42)                                                 10750002
         DC    A(MSG43)                                                 10800002
         DC    A(MSG44)                                                 10850002
         DC    A(MSG45)                                                 10900002
         DC    A(MSG46)                                                 10950002
         DC    A(MSG47)                                                 11000002
         BAL   6,EJECT                 FORCE A SKIP TO ONE              11050002
         BAL   6,SPACE                 TRIPLE SPACE                     11100002
         DC    A(MSG50)                                                 11150002
         BALR  LISTREG,R8          51 WRITE ON CONSOLE....WTO1          11200002
         DC    AL2(WTO1-MSGADS)                                         11250002
         BALR  LISTREG,R8          52 WRITE ON CONSOLE....WTO2          11300002
         DC    AL2(WTO2-MSGADS)                                         11350002
         DC    A(MSG53)                 I/O ERROR ON SYSIN              11400002
         DC    A(MSG54)                                                 11450002
         DC    A(MSG55)                                            BS0H 11500002
         DC    A(MSG56)                                            BS0H 11550002
         DC    A(MSG57)                                          A23466 11600002
         DC    A(MSG58)                                          A24020 11650002
         DC    A(MSG59)                                          A28552 11700002
*                                                                S21046 11750002
*   THE FOLLOWING ADDRESSES REFER TO THE DIAGNOSTIC MESSAGES     S21046 11800002
*   PRODUCED THROUGH ERROR CONDITIONS OCCURING IN PROTECT        S21046 11850002
*                                                                S21046 11900002
         DC    A(MSG60)                                          S21046 11950002
         DC    A(MSG61)                                          S21046 12000002
         DC    A(MSG62)                                          S21046 12050002
         DC    A(MSG63)                                          S21046 12100002
         DC    A(MSG64)                                          S21046 12150002
         DC    A(MSG65)                                          S21046 12200002
         DC    A(MSG66)                                          S21046 12250002
         DC    A(MSG67)                                          S21046 12300002
*                                                                A31333 12350002
*   THE FOLLOWING MESSAGE NUMBERS REFER TO A DIAGNOSTIC MESSAGE  A31333 12400002
*   PRODUCED BY A RETURN CODE FROM CATALOG                       A31333 12450002
*                                                                A31333 12500002
         DC    A(MSG68)                                          A31333 12550002
         DC    A(MSG69)                                          A31333 12600002
*  THE FOLLOWING TWO MESSAGES ARE A RESULT OF ERROR CONDITIONS   A33374 12650002
* IN THE STOW ROUTINE.                                           A33374 12700002
         DC    A(MSG70)                DATA SET NOT OPEN         A33374 12750002
         DC    A(MSG71)                GETMAIN FAILED IN STOW    A33374 12800002
         DC    A(MSG72)           SCRATCH VTOC FAILED TO FIND DS A50977 12850002
         DC    A(MSG73)           PDS DIRECTORY FULL             YM5076 12900002
         DC    A(MSG74)           ZERO VOL CNT OR BAD LIST       A57261 12950002
*                                                              @VS30028 12952003
* THE FOLLOWING MESSAGES ARE A RESULT OF ERROR CONDITIONS      @VS30028 12954003
* IN SCRATCH OR RENAME.                                        @VS30028 12956003
*                                                              @VS30028 12958003
         DC    A(MSG75)                DATA SET OPEN           @VS30028 12960003
         DC    A(MSG76)                VOLUME NOT MOUNTED      @VS30028 12970003
         DC    A(MSG77)                INVALID AUTHORIZATION   @Z40RSDS*12971032
                                       TO SECURITY PROFILE     @Z40RSRJ 12971232
         DC    A(MSG78)                UNABLE TO RENAME        @Z40RSRJ*12972032
                                       SECURITY PROFILE        @Z40RSRJ 12972232
         EJECT                                                 @VS30028 12998003
MSG2     DC    AL1(MSG3-MSG2-2)                                         13000002
         DC    C' IEH201I  INVALID REQUEST..'                           13050002
         DC    CL19'. STATEMENT IGNORED'                                13100002
MSG3     DC    AL1(MSG4-MSG3-2)                                         13150002
         DC    C'IEH202I  INVALID KEYWORD '                             13200002
         DC    CL27'OR CONTROL STATEMENT SYNTAX'                        13250002
MSG4     DC    AL1(MSG5-MSG4-2)                                         13300002
         DC    CL30'AN UNDEFINED ERROR CODE HAS BE'                     13350002
         DC    CL11'EN RETURNED'                                        13400002
MSG5     EQU   *                                                        13450002
MSG9     DC    AL1(MSG10-MSG9-2)                                        13500002
         DC    CL32'NORMAL END OF TASK RETURNED FROM'                   13550002
MSG10    EQU   *                                                        13600002
MSG11    DC    AL1(MSG12-MSG11-2)                                       13650002
         DC    C' IEH203I  '                                            13700002
         DC    CL30'THE SYSCTLG DATA SET IS NOT AV'                     13750002
         DC    CL23'AILABLE OR FORMS A LOOP'                            13800002
MSG12    DC    AL1(MSG13-MSG12-2)                                       13850002
         DC    C' IEH204I  '                                            13900002
         DC    CL31'STATUS OF THE REQUESTED TASK CA'                    13950002
         DC    CL19'N NOT BE DETERMINED'                                14000002
MSG13    EQU   *                                                        14050002
MSG14    DC    AL1(MSG15-MSG14-2)                                       14100002
         DC    C' IEH205I  '                                            14150002
         DC    CL30'INFORMATION IN CONTROL STATMEN'                     14200002
         DC    CL14'T IS REDUNDANT'                                     14250002
MSG15    DC    AL1(MSG16-MSG15-2)                                       14300002
         DC    CL14'NOT SUFFICIENT'                                     14350002
MSG16    DC    AL1(MSG17-MSG16-2)                                       14400002
         DC    CL30'THE REQUESTED PROGRAM FUNCTION'                     14450002
         DC    CL20' HAS NOT BEEN CALLED'                               14500002
MSG17    DC    AL1(MSG18-MSG17-2)                                       14550002
         DC    C' ... UNUSUAL END'                                      14600002
MSG18    EQU   *                                                        14650002
MSG19    DC    AL1(MSG20-MSG19-2)                                       14700002
         DC    C' IEH206I  '                                            14750002
         DC    C'CVOL IS NOT DIRECT ACCESS'                             14800002
MSG20    DC    AL1(MSG21-MSG20-2)                                       14850002
         DC    C' IEH207I  '                                            14900002
         DC    CL26'STATUS OF USERS REQUEST TO'                         14950002
MSG21    DC    AL1(MSG22-MSG21-2)                                       15000002
         DC    CL10'DATA SET'                                           15050002
MSG22    DC    AL1(MSG23-MSG22-2)                                       15100002
         DC    CL30'VOLUME I.D.     ACTION TAKEN  '                     15150002
         DC    CL32'   REASON FOR TAKING THIS ACTION'                   15200002
         DC    CL25'                    ERROR'                          15250002
MSG23    DC    AL1(MSG24-MSG23-2)                                       15300002
         DC    CL13'USERS REQUEST'                                      15350002
MSG24    DC    AL1(MSG25-MSG24-2)                                       15400002
         DC    C'DATA SET OR MEMBER NOT FOUND'                          15450002
MSG25    DC    AL1(MSG26-MSG25-2)                                       15500002
         DC    CL30'CORRECT PASSWORD NOT AVAILABLE'                     15550002
MSG26    DC    AL1(MSG27-MSG26-2)                                       15600002
         DC    CL26'PURGE DATE HAS NOT EXPIRED'                         15650002
MSG27    DC    AL1(MSG28-MSG27-2)                                       15700002
         DC    CL25'THE SPECIFIED NEW NAME IS'                          15750002
         DC    CL16' ALREADY PRESENT'                                   15800002
MSG28    DC    AL1(MSG29-MSG28-2)                                       15850002
         DC    CL4'NONE'                                                15900002
MSG29    DC    AL1(MSG30-MSG29-2)                                       15950002
         DC    CL31'PERMANENT I/O ERROR ENCOUNTERED'                    16000002
MSG30    DC    AL1(MSG31-MSG30-2)                                       16050002
         DC    CL43'END OF LISTING OF DATA SETS TO BE SCRATCHED' A25564 16100002
         DC    CL11' OR RENAMED'                                 A25564 16150002
MSG31    DC    AL1(MSG32-MSG31-2)                                       16200002
         DC    CL11'UTILITY END'                                        16250002
MSG32    DC    AL1(MSG33-MSG32-2)                                       16300002
         DC    CL27'DATA SET NAME'                                      16350002
MSG33    DC    AL1(MSG34-MSG33-2)                                       16400002
         DC    CL30'SCRATCH THE VOLUME TABLE OF CO'                     16450002
         DC    CL6'NTENTS'                                              16500002
MSG34    DC    AL1(MSG35-MSG34-2)                                       16550002
         DC    CL19'END OF SCRATCH VTOC'                                16600002
MSG35    DC    AL1(MSG36-MSG35-2)                                       16650002
         DC    C' IEH208I  LIST TRUNCATED TO '                          16700002
         DC    CL25'1 VOLUME FOR SCRATCH VTOC'                          16750002
MSG36    DC    AL1(MSG37-MSG36-2)                                       16800002
         DC    C' IEH209I  '                                            16850002
         DC    CL26'STATUS OF USERS REQUEST TO'                         16900002
MSG37    DC    AL1(MSG38-MSG37-2)                                       16950002
         DC    C' IEH210I  YOUR REQUEST CANNOT'                         17000002
         DC    CL16' BE SERVICED....'                                   17050002
MSG38    DC    AL1(MSG39-MSG38-2)                                       17100002
         DC    CL23'IS A CATALOGED DATA SET'                            17150002
MSG39    DC    AL1(MSG40-MSG39-2)                                       17200002
         DC    CL32'THE INDEX SPECIFIED IS NOT EMPTY'                   17250002
         DC    CL16' OR HAS AN ALIAS'                                   17300002
MSG40    DC    AL1(MSG41-MSG40-2)                                       17350002
         DC    CL29'NO SPACE AVAILIBLE TO SYSCTLG'                      17400002
MSG41    DC    AL1(MSG42-MSG41-2)                                       17450002
         DC    CL28'IS NOT A VALID DATA SET NAME'                       17500002
MSG42    DC    AL1(MSG43-MSG42-2)                                       17550002
         DC    CL27'WITHIN THE SYSCTLG DATA SET'                        17600002
MSG43    DC    AL1(MSG44-MSG43-2)                                       17650002
         DC    CL27'IS CURRENTLY AN INDEX LEVEL'                        17700002
MSG44    DC    AL1(MSG45-MSG44-2)                                       17750002
         DC    CL32'THE IMPLIED INDEX STRUCTURE DOES'                   17800002
         DC    CL10' NOT EXIST'                                         17850002
MSG45    DC    AL1(MSG46-MSG45-2)                                       17900002
         DC    CL29'A DATA SET EXISTS WITHIN THE '                      17950002
         DC    CL29'SPECIFIED LIST OF INDEX NAMES'                      18000002
MSG46    DC    AL1(MSG47-MSG46-2)                                       18050002
         DC    CL24'A SYNTAX ERROR EXISTS IN'                           18100002
MSG47    DC    AL1(MSG48-MSG47-2)                                       18150002
         DC    CL27'IS NOT A CATALOGED DATA SET'                        18200002
MSG48    EQU   *                                                        18250002
MSG50    DC    AL1(MSG51-MSG50-2)                                       18300002
         DC    C' IEH211I  '                                            18350002
         DC    CL30'REQUIRED VOLUME COULD NOT BE M'                     18400002
         DC    CL6'OUNTED'                                              18450002
MSG51    EQU   *                                                        18500002
WTO1     WTO  'IEH002I SYNAD EXIT FROM SYSPRINT- TASK TERMINATED',MF=L  18550002
WTO2     WTO  'IEH005I PROGRAM INTERRUPT ... TASK TERMINATED',MF=L      18600002
MSG53    DC    AL1(MSG54-MSG53-2)                                       18650002
         DC    C' IEH212I  I/O ERROR ON THE SY'                         18700002
         DC    C'SIN DATA SET --- JOB TERMINATED'                       18750002
MSG54    DC    AL1(MSG55-MSG54-2)                                       18800002
         DC    CL30'IT IS INVALID --OR-- IT IS NOT'                     18850002
         DC    CL28' PROPER WITHIN YOUR PRESENT '                       18900002
         DC    CL17'CATALOG STRUCTURE'                                  18950002
MSG55    DC    AL1(MSG56-MSG55-2)                                  BS0H 19000002
         DC    C' IEH213I  '                                       BS0H 19050002
         DC    CL32' JOB TERMINATED -- INVALID BLOCK'              BS0H 19100002
         DC    CL28'SIZE SPECIFIED IN SYSIN DCB '                  BS0H 19150002
MSG56    DC    AL1(MSG57-MSG56-2)                                  BS0H 19200002
         DC    C' IEH216I  '                                     A28562 19250002
         DC    CL32' SYSIN CANNOT BE OPENED -- CHECK'              BS0H 19300002
         DC    CL14' SYSIN DD CARD'                                BS0H 19350002
MSG57    DC    AL1(MSG58-MSG57-2)                                A23466 19400002
         DC    C' IEH214I  '                                     A23466 19450002
         DC    CL38' CONTINUATION CARD EXPECTED---REQUESTS'      A23466 19500002
         DC    CL19' CANNOT BE SERVICED'                         A23466 19550002
MSG58    DC    AL1(MSG59-MSG58-2)                                A24020 19600002
         DC    C' IEH215I  '                                     A24020 19650002
         DC    CL42' SYNTAX ERROR ENCOUNTERED IN NAME FIELD OF'  A24020 19700002
         DC    CL42' CONTROL STATEMENT-PROCESSING IS CONTINUED'  A24020 19750002
MSG59    DC    AL1(MSG60-MSG59-2)      LENGTH OF ENTRY           A28552 19800002
         DC    C' IEH217I  '                                   @ZA01675 19810002
         DC    CL42'ERROR ENCOUNTERED IN A NAME, INDEX, ALIAS,' YA01707 19850002
         DC    CL42' OR MEMBER FIELD OF THE CONTROL STATEMENT ' YA01707 19870002
         DC    CL18'.. REQUEST IGNORED'                         YA01707 19950002
*                                                                S21046 20000002
*   MESSAGE 60 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 20050002
*                                                                S21046 20100002
MSG60    DC    AL1(MSG61-MSG60-2)                                S21046 20150002
         DC    C' IEH223I '                                      S21046 20200002
         DC    CL37' THE PASSWORD DATA SET DOES NOT EXIST'       S21046 20250002
*                                                                S21046 20300002
*   MESSAGE 61 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 20350002
*                                                                S21046 20400002
MSG61    DC    AL1(MSG62-MSG61-2)                                S21046 20450002
         DC    C' IEH224I '                                      S21046 20500002
         DC    CL39'WARNING ... UNABLE TO ALTER PROTECTION '     S21046 20550002
         DC    CL24'STATUS OF TAPE DATA SETS'                    S21046 20600002
*                                                                S21046 20650002
*   MESSAGE 62 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 20700002
*                                                                S21046 20750002
MSG62    DC    AL1(MSG63-MSG62-2)                                S21046 20800002
         DC    C' IEH225I '                                      S21046 20850002
         DC    CL31' DUPLICATE ENTRY EXISTS IN THE '             S21046 20900002
         DC    CL17'PASSWORD DATA SET'                           S21046 20950002
*                                                                S21046 21000002
*   MESSAGE 63 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 21050002
*                                                                S21046 21100002
MSG63    DC    AL1(MSG64-MSG63-2)                                S21046 21150002
         DC    C' IEH218I '                                      S21046 21200002
         DC    CL41' JOB TERMINATED --- FIVE INVALID PASSWORD'   S21046 21250002
         DC    CL15'S WERE SUPPLIED'                             S21046 21300002
*                                                                S21046 21350002
*   MESSAGE 64 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 21400002
*                                                                S21046 21450002
MSG64    DC    AL1(MSG65-MSG64-2)                                S21046 21500002
         DC    C' IEH222I '                                      S21046 21550002
         DC    CL37'UNABLE TO ALTER PROTECTION STATUS OF '       S21046 21600002
         DC    CL8'DATA SET'                                     S21046 21650002
*                                                                S21046 21700002
*   MESSAGE 65 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 21750002
*                                                                S21046 21800002
MSG65    DC    AL1(MSG66-MSG65-2)                                S21046 21850002
         DC    C' IEH219I '                                      S21046 21900002
         DC    CL31' I/O ERROR IN PASSWORD DATA SET'             S21046 21950002
*                                                                S21046 22000002
*   MESSAGE 66 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 22050002
*                                                                S21046 22100002
MSG66    DC    AL1(MSG67-MSG66-2)                                S21046 22150002
         DC    C' IEH221I '                                      S21046 22200002
         DC    CL31' THE PASSWORD DATA SET IS FULL'              S21046 22250002
*                                                                S21046 22300002
*   MESSAGE 67 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 22350002
*                                                                S21046 22400002
MSG67    DC    AL1(MSG68-MSG67-2)                                S21046 22450002
         DC    C' IEH229I '                                      S21046 22500002
         DC    CL32' INVALID PARAMETER IN PARM FIELD'            S21046 22550002
         DC    CL13' OF EXEC CARD'                               S21046 22600002
*                                                                A31333 22650002
*   MESSAGE 68 IS PRODUCED BY A RETURN CODE FROM CATALOG         A31333 22700002
*                                                                A31333 22750002
MSG68    DC   AL1(MSG69-MSG68-2)                                 A31333 22800002
         DC    C' IEH230I '                                      A31333 22850002
*                                                                A31333 22900002
*   MESSAGE 69 IS PRODUCED BY A RETURN CODE FROM CATALOG         A31333 22950002
*                                                                A31333 23000002
         DC    C' VTOC NOT CONVERTED FROM DOS TO OS '            A31333 23050002
MSG69    DC    AL1(MSG70-MSG69-2)                                A31333 23100002
         DC    C'          DATA SET NOT CATALOGUED OR INDEX'     A31333 23150002
         DC    C' NOT BUILT'                                     A31333 23200002
*  VTOC OR DIRECTORY OF PDS COULD NOT BE OPENED                  A33374 23250002
MSG70    EQU   *                                                 A33374 23300002
         DC    AL1(MSG71-MSG70-2)                                A33374 23350002
         DC    C'VTOC OR DIRECTORY OPEN FAILED'                @VS30028 23400003
*  CONDITIONAL GETMAIN FAILED IN STOW                            A33374 23450002
MSG71    EQU   *                                                 A33374 23500002
         DC    AL1(MSG72-MSG71-2)                                A33374 23550002
         DC    C'INSUFFICIENT CORE, CONDITIONAL GETMAIN FAILED'  A33374 23600002
*     SCRATCH FAILED TO FIND A VTOC ENTRY DURING SCRATCH  VTOC   A50977 23650002
MSG72    DC    AL1(MSG73-MSG72-2)                                A50977 23700002
         DC    CL37'ERROR IN VTOC ENTRY-UNABLE TO SCRATCH'       A50977 23750002
*     STOW FOUND A FULL PDS DIRECTORY                            YM5076 23800002
MSG73    DC    AL1(MSG74-MSG73-2)                                YM5076 23850002
         DC    CL21'PDS DIRECTORY IS FULL'                       YM5076 23900002
*        VOLUME COUNT IS ZERO OR LIST NOT IN REGION              A57261 23950002
MSG74    EQU   *                                                 A57261 24000002
         DC    AL1(MSG75-MSG74-2)                                A57261 24050002
         DC    C'VOL COUNT IS ZERO OR LIST NOT IN REGION'        A57261 24100002
*                                                              @VS30028 24110003
*   MESSAGE 75 IS PRODUCED BY A RETURN CODE FROM SCRATCH OR    @VS30028 24120003
*   RENAME (IF THE DATA SET TO BE SCRATCHED/RENAMED WAS OPEN)  @VS30028 24130003
*   AND IS PRINTED AS PART OF MESSAGE IEH207I OR IEH209I.      @VS30028 24132003
*                                                              @VS30028 24140003
MSG75    EQU   *                                                 A57261 24150002
         DC    AL1(MSG76-MSG75-2)      MESSAGE LENGTH - 1      @VS30028 24152003
         DC    C'DATA SET WAS OPEN'    MESSAGE TEXT            @VS30028 24154003
*                                                              @VS30028 24156003
*   MESSAGE 76 IS PRODUCED BY A RETURN CODE FROM SCRATCH       @VS30028 24158003
*   WHEN THE VOLUME COULD NOT BE VERIFIED AS MOUNTED AND       @VS30028 24160003
*   IS PRINTED AS PART OF MESSAGE IEH209I.                     @VS30028 24161003
*                                                              @VS30028 24162003
MSG76    EQU   *                       MESSAGE NUMBER 76       @VS30028 24164003
         DC    AL1(MSG77-MSG76-2)      MESSAGE LENGTH - 1      @VS30028 24166003
         DC    C'VOLUME NOT MOUNTED'   MESSAGE TEXT            @VS30028 24168003
*                                                              @Z40RSDS 24170032
*   MESSAGE 77 IS PRODUCED BY A RETURN CODE FROM SCRATCH       @Z40RSDS 24172032
*   AND IS PRINTED AS PART OF MESSAGE IEH207I OR IEH209I.      @Z40RSDS 24173032
*                                                              @Z40RSDS 24174032
MSG77    EQU   *                       MESSAGE NUMBER 77       @VS30028 24178003
         DC    AL1(MSG78-MSG77-2)      MESSAGE LENGTH - 1      @Z40RSDS 24179032
         DC    C'INVALID AUTHORIZATION TO SECURITY PROFILE'    @Z40RSRJ 24180032
*                                                              @Z40RSDS 24181032
*   MESSAGE 78 IS PRODUCED BY A RETURN CODE FROM RENAME        @Z40RSDS 24182032
*   AND IS PRINTED AS PART OF MESSAGE IEH207I.                 @Z40RSDS 24183032
*                                                              @Z40RSDS 24184032
MSG78    EQU   *                       MESSAGE NUMBER 78       @Z40RSDS 24185032
         DC    AL1(MSG80-MSG78-2)      MESSAGE LENGTH - 1      @G32DSFS 24186032
         DC    C'UNABLE TO RENAME SECURITY PROFILE'  MSG TEXT  @Z40RSRJ 24188032
*                                                              @Z40RSDS 24190032
*   MESSAGE 79 HAS BEEN DELETED                                @G32DSFS 24192032
*                                                              @G32DSFS 24194032
MSG80    EQU   *                       MESSAGE NUMBER 80       @G32DSFS 24196032
         EJECT                                                 @VS30028 24198003
DSECT    DSECT                                                          24200002
IEHECHAR DS    C         CHARACTER TO BE SCANNED FOR                    24250002
IEHECOND DS    C         CONDITION CODE TO STOP ON                      24300002
IEHECODE DS    C                                                        24350002
IEHEARGL DS    C                                                        24400002
IEHESTT  DS    F                                                        24450002
IEHESTP  DS    F                                                        24500002
IEHEFND  DS    F                                                        24550002
IEHETBL  DS    F                                                        24600002
IEHEFUN  DS    F                                                        24650002
IEHESCNX DS    3F                                                       24700002
IEHEMAC1 DS    7F                 PARAMETER LIST                 S21046 24750002
IEHEMAC2 DS    6F                                                       24800002
IEHESTIN DS    F                                                        24850002
IEHENDIN DS    F                                                        24900002
IEHECCNT DS    2C                                                       24950002
IEHESW1  DS    C                                                        25000002
DUPSW    DS    2C                 SWITCHES FOR TEST OF DUPLICATE S21046 25050002
*                                 PARAMETERS                     S21046 25100002
PPARAMSW DS    CL2                                                      25150002
IEHESW5  DS    C                                                        25200002
IEHESW6  DS    C                                                        25250002
IEHECALL DS    F                                                        25300002
         DS    0D                                                       25350002
DBLWORD  DS    F                                                        25400002
FULLWORD DS    F                                                        25450002
         DS    0D                                                       25500002
DECB1    DS    24X                                                      25550002
DECB2    DS    24X                                                      25600002
VOLISTAD DS    F                                                        25650002
MATRIXIU DS    F                                                        25700002
VDTIU    DS    F                                                        25750002
VOLPAREN DS    FL2                                                      25800002
VSRCM    DS    2X                                                       25850002
VDSA     DS    X                                                        25900002
DFLG     DS    X                                                   BS0H 25950002
DFLAG    DS    X                                                   BS0H 26000002
         DS    0F                                                       26050002
FLSTADDR DS    F                                                        26100002
FNSA     DS    12X                                                      26150002
KWSA     DS    12X                                                      26200002
SCANRET  DS    F                                                        26250002
MARESAR  DS    72X                                                      26300002
IEHESPC  DS    XL20                                                     26350002
         DS    XL20                                                     26400002
IEHERSAV DS    64X                                                      26450002
PASSUNIT DS    5X                                                  DT0I 26500002
MOUNTSW  DS    X                                                   DT0I 26550002
TABLEAD  DS    F                  ADDRESS OF DEVICE NAME TABLE     I276 26600002
IEHESW2  DS    X                  PROTECT SWITCHES               S21046 26650002
*                                 BIT 1=1 IF WE ARE TO PRINT     S21046 26700002
*                                        CONTROL CARDS           S21046 26750002
*                                 BIT 3=1 INDICATES FIRST QUOTE  S21046 26800002
*                                        IN SCAN FOR DATA        S21046 26850002
*                                        OPERATION IS FOUND      S21046 26900002
*                                 BIT 4= 1 IF WTOR SETUP IS DONE S21046 26950002
*                                 BIT 6=1 IF FIRST PARM ENTRY    S21046 27000002
*                                 WAS VALID                      S21046 27050002
*                                 BIT 7=1 IF INVALID PARM ENTRY  S21046 27100002
*                                 MSG HAS BEEN PRINTED           S21046 27150002
PASWDCT1 DS    1X                 NUMBER OF PROMPTS FOR PASWORD1 S21046 27200002
PASWDCT3 DS    1X                 NUMBER OF PROMPTS FOR CPASWORD S21046 27250002
TOTALPS  DS    1X                 TOTAL NO OF OPERATOR REPLIES   S21046 27300002
WTORECB  DS   1F                  EVENT CONTROL BLOCK FOR WTOR   S21046 27350002
TIOTADRS DS    1F                 TIOT ADDRESS FOR WTOR          S21046 27400002
CCNAME   DS    8C                 NAME OFF CONTROL CARD          S21046 27450002
WTORLIST WTOR  'IEH220A JOBNAMES, STEPNAME, CARDNAME, REPLY WITH PASSWOX27500002
               RD',,8,WTORECB,ROUTCDE=(9),DESC=2,MF=L            S21046 27550002
EXTRACTO EXTRACT ,'S',FIELDS=(TIOT),MF=L                         S21046 27600002
DCBAREA  DS    0F                                                       27650002
UTINDCB  DCB   DSORG=PS,MACRF=(GM)                                      27700002
CODELIST DC    C'.,=()   '        SPECIAL CHARACTERS CODED BY SCAN      27750002
MAXLINES DC    FL2'45'             MAXIMUM LINES PER PAGE               27800002
LINECNT  DC    FL2'0'              LINE COUNT FIELD                     27850002
SKIP21   DC    X'8B'               SKIP TO 1 COMMAND                    27900002
WRITEHDR DC    X'19'               SPACE 3 AFTER PRINT                  27950002
HEADER   DC    CL30'MODIFY....VERSION BETA-1......'                     28000002
         DC    CL30'LAST UPDATED....JULY 11  10 PM'                     28050002
         DC    CL30'                              '                     28100002
         DC    CL30'               PAGE 001       '                     28150002
PAGENUM  EQU   HEADER+110                                               28200002
DDNAMES  DS    3CL8                     FOR THREE DD NAMES              28250002
UTOUTDCB DCB   DSORG=PS,MACRF=(PM)                                      28300002
         DS    2F                                                       28350002
IEHESAT  DS    150X                                                     28400002
READBASE DC    F'0'                                                     28450002
PARAM1   DS    44X                                                      28500002
         DS    F              FOR  LENGTH OF  PARAM2                    28550002
PARAM2   DS    44X                                                      28600002
         DS    F                   FOR LENGTH OF PARAM3                 28650002
PARAM3   DS    44X                                                      28700002
PARAM5   DS    2F                 CPASWORD PARAMETER             S21046 28750002
PARAM6   DS    151F               VOL IDS PARAMETER              S21046 28800002
PARAM7   DS    2F                 PASSWORD2 PARAMETER            S21046 28850002
PARAM8   DS    80X                DATA PARAMETER                 S21046 28900002
DUMMY    DS    1F                 TEMPORARY STORAGE FIELD        S21046 28950002
PROTCTAD DS    1F                 ADDRESS OF WHERE TO PUT NEXT   S21046 29000002
*                                 VOL ID IN PARAM6 FOR PROTECT   S21046 29050002
FINUSE   DS    F                   ADDR OF DC LIST IN USE               29100002
DCSAVEAD DS    F                   SAVE AREA FOR ADDR OF DC LIST        29150002
INPUT    DS    40F                 TWO CARD INPUT AREA                  29200002
MSGOUT   DS    30F                 MSG OUTPUT AREA                      29250002
         DS    F                                                        29300002
         DS    0D                                                       29350002
PARAM4   DS    151F                FOR A VOLUME LIST                    29400002
EOCORE   EQU   *-12                                                     29450002
         ORG   PARAM4+20                                                29500002
VTOCDCB2 DS    0F                                                       29550002
DCB4VTOC DCB   DDNAME=VTOC,                                            .29600002
               DSORG=PS,                                               .29650002
               MACRF=R,                                                .29700002
               KEYLEN=44,                                              .29750002
               BLKSIZE=1,                                              .29800002
               RECFM=U,                                                .29850002
               EODAD=VTOCEND,                                          .29900002
               SYNAD=VTOCERR,                                          .29950002
               EXLST=VTOCEND                                            30000002
JFCB     DS    24D                                                      30050002
*        THE FOLLOWING ORG STATEMENT IS FLAGGED                  YM5077 30100002
         ORG                                                            30150002
SAVEREG2 DS    72X                SECONDARY SAVE AREA             M2838 30200002
SAVEREG3 DS    72X                THIRD LEVEL SAVE AREA           M2838 30250002
         ORG                                                            30300002
VTOCSW   EQU   JFCB+50                                                  30350002
VTOCDECB EQU   JFCB+60                                                  30400002
JFCBVOL  EQU   JFCB+118                                                 30450002
EXLST2   EQU   DCB4VTOC+36                                              30500002
FORMATID EQU   PARAM2+44                                                30550002
BLANK    EQU   64                                                       30600002
READTOO  EQU   INPUT+72                                                 30650002
COL16    EQU   READTOO+15                                               30700002
COL72    EQU   READTOO+71                                               30750002
MIDDLE   EQU   READTOO-1                                                30800002
WARE2PUT EQU   IEHEMAC1-4                                               30850002
SYSINEND EQU   *                                                        30900002
VTOCEND  EQU   *                                                        30950002
VTOCERR  EQU   *                                                        31000002
         END                                                            31050002
