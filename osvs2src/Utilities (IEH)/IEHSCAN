 TITLE 'IEHSCAN-IEHINITT SCAN MODULE'                              1581 00005014
 TITLE 'IEHSCAN-IEHINITT SCAN MODULE'                              1581 00010014
*TITLE 'IEHSCAN' SCAN CARD IMAGE FOR PARAMETERS SPECIFIED             * 00020000
*STATUS: CHANGE LEVEL 000                                             * 00040000
*FUNCTION/OPERATION: TO SCAN AN 80 BYTE AREA IN CORE AND PASS BACK A  * 00060000
* TITLE:                                                                00159202
*    'IEHSCAN' SCAN CARD IMAGE FOR PARAMETERS SPECIFIED                 00160802
* STATUS:                                                               00162402
*    CHANGE LEVEL 000                                                   00164002
* FUNCTION/OPERATION:                                                   00165602
*    TO SCAN AN 80 BYTE AREA IN CORE AND PASS BACK A POINTER            00167202
*    TO THE PARAMETER, ITS LENGTH AND AN INDICATION AS TO WHAT          00168802
*    IT IS                                                              00170402
* ENTRY POINTS:                                                         00172002
*    THE ONLY ENTRY POINT IS IEHSCAN TO SCAN THE 80 BYTE                00173602
*    CARD IMAGE                                                         00175202
* INPUT:                                                                00176802
*    REGISTER 13 POINTS TO THE WORK AREA,                               00178402
*    REGISTER 14 POINTS TO THE RETURN ADDRESS OF THE CALLING ROUTINE,   00180002
*    REGISTER 15 POINTS TO THE ENTRY POINT                              00200002
* OUTPUT:                                                               00220002
*    REGISTER 1 POINTS TO THE ITEM SCANNED,                             00230002
*    REGISTER 2 CONTAINS ITS LENGTH,                                    00232002
*    REGISTER 3 POINTS TO THE START OF THE NEXT SCAN.            S20038 00234002
*    THE FLAG BYTE 'SWITCHRD' INDICATES SYNTAX ERROR,                   00240002
*    BYPASS, END OF FILE, INITIAL ENTRY, COMMAND WORD, KEYWORD,         00260002
*    OR PARAMETER.                                                      00280002
*    ANOTHER BIT IN THE WORK AREA INDICATES DDNAME                      00300002
* EXTERNAL REFERENCES:                                                  00312002
*    IEHPRNT  - PRINT ROUTINE. PRINT OUT EACH CARD IMAGE SCANNED        00320002
* EXITS, NORMAL:                                                        00360002
*    CONTROL IS RETURNED TO THE CALLER                                  00370002
* EXITS, ERROR:                                                         00372002
*    THE ERROR BIT IS SET BEFORE CONTROL IS RETURNED                    00380002
* TABLES/WORK AREAS:                                                    00400002
*    WORK AREA IS SET UP IN CALLING ROUTINE AND PASSED                  00410002
*    TO SCAN                                                            00420002
* ATTRIBUTES:                                                           00440002
*    REENTRANT                                                          00440402
* CHARACTER CODE DEPENDENCY -                                    S20038 00442020
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL       S20038 00444020
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS       S20038 00446020
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE CODING HAS S20038 00448020
*    BEEN ARRANGED SO THAT REDEFINITION OF 'CHARACTER' CONSTANTS,S20038 00450020
*    BY REASSEMBLY, WILL RESULT IN A CORRECT MODULE FOR THE NEW  S20038 00452020
*    DEFINITIONS.                                                S20038 00454020
* NOTES:                                                                00454402
*    THE MICROFICHE FLAG 'M2840' REPRESENTS A GENERAL CLEANUP OF  M2840 00454802
*    ALL IEHINITT MODULES, WITH SPECIAL EMPHASIS ON REMOVAL OF    M2840 00455202
*    DEAD AND REDUNDANT CODE FROM THE MODULE IEHSCAN.  THE FLAG   M2840 00455602
*    ALSO REPRESENTS PARAMETERIZATION OF ABSOLUTE VALUES FOR      M2840 00455702
*    CROSS-REFERENCE PURPOSES, AND THE ADDITION OF COMMENTS       M2840 00455802
*    TO A NUMBER OF SOURCE STATEMENTS.                            M2840 00455902
         EJECT                                                          00456002
IEHSCAN  CSECT                                                          00460014
*A025500-025584,121100-121300                                  @ZA16491 00462099
*D038200-038400                                                @ZA16474 00470099
*2558068200                                                        3660 00480015
* 136000                                                         S20038 00490020
         USING IEHCDSCN,SCANBASE       ESTABLISH ADDRESSIBILITY   M2840 00500002
         USING WORK,WORKREG            ADDR OF COMMON WORK AREA   M2840 00520002
IEHCDSCN SAVE  (14,12),T,IEHSCAN-OZ16491 SAVE REGISTERS        @ZA16491 00540099
         LR    SCANBASE,R15            LOAD BASE REGISTER         M2840 00560002
         ST    R13,GPSAVE+4            SAVE CALLER'S REG 13       M2840 00580002
         MVC   REODAD,EODA             INSERT EODAD ROUTINE       M2840 00600002
         MVC   RSYNAD,SYNAD            INSERT SYNAD IN READ DCB   M2840 00610002
         LA    COL71REG,COL71          ADDR OF COLUMN 71 OF CARD  M2840 00620002
         L     NEXTCOL,DISP12          SAVED START OF NEXT SCAN   M2840 00640002
         NI    SWITCHRD,BIT0OFF        RESET ERROR BIT            M2840 00660002
         TM    SWITCHRD,BIT3           TEST FIRST ENTRY BIT             00680000
         BC    OFF,KIRSCD              FIRST ENTRY OR NEW SET     M2840 00700002
         TM    SWITCHRD,BIT1           TEST BYPASS BIT                  00720000
         BC    ON,KBYPO1               JUST READ AND PRINT CARDS  M2840 00740002
         TM    DISP5,BIT4              TEST READ CARD SWITCH            00760000
         BC    ON,KGTCD                READ AND PROCESS CARD      M2840 00780002
         TM    SWITCHRD,BIT7           COMMENT BIT ON            SM5216 00830002
         BNO   KPFOL                   CONTINUE CHECKING         SM5216 00880002
         OI    SWITCHRD,BIT1           SET BYPASS                SM5216 00890002
         NI    SWITCHRD,X'FF'-BIT6     SET OFF PARAM FOLLOW BIT  SM5216 00890402
         B     KGTCD                   READ AND PRINT CARDS      SM5216 00892002
KPFOL    TM    DISP5,BIT2              TEST PARAM FOLLOW SWITCH         00900000
         BC    ON,SCANR                SCAN FOR KEYWORD OR PARAM  M2840 00920002
         TM    DISP5,BIT1              TEST CONTINUE SWITCH             00940000
         BC    ON,KCONT                SCAN FOR COMMAND WORD      M2840 00960002
         TM    DISP10,BIT5             IS NAME BIT ON?            M2840 00962002
         BO    GETCMD                  YES, HAVE NAME, GET CMD    M2840 00964002
         EJECT                                                          00970002
*                                                                       01000000
*   THIS ROUTINE CHECKS FOR A NAME AND SETS THE POINTER TO         1581 01020014
*   THE FIRST BLANK COLUMN                                         1581 01040014
*                                                                  1581 01060014
         LA    NEXTCOL,COL2            LOAD ADDRESS OF BEGIN COL  M2840 01070002
KNAME    CLI   0(NEXTCOL),BLANKCOL     IS NEXT COLUMN BLANK?      M2840 01080002
         BE    HAVENAME                YES, END OF DDNAME, BRANCH M2840 01100002
         CR    NEXTCOL,COL71REG        NEXT COLUMN COLUMN 71?     M2840 01140002
         BE    KINVALD                 YES, SET UP AS ERROR       M2840 01160002
         LA    NEXTCOL,BUMP1(I0,NEXTCOL) INCREMENT TO NEXT COLUMN M2840 01180002
         B     KNAME                   BRANCH BACK TO CHECK FOR   M2840 01200002
*                                         END OF DDNAME           M2840 01220002
HAVENAME LA    STARTCOL,CARD           CALCULATE LENGTH OF DDNAME M2840 01280002
         LR    LENGTH,NEXTCOL          ADDRESS OF FIRST BLANK COL M2840 01320002
         SR    LENGTH,STARTCOL         CALCULATE LENGTH           M2840 01340002
         OI    DISP10,BIT5             TURN ON NAME BIT                 01400000
         B     KPASS                   RETURN DDNAME TO CALLER    M2840 01420002
*                                                                       01430002
GETCMD   MVI   DISP10,NULL             CLEAR CURRENT DELIM (NAME) M2840 01440002
         OI    DISP5,BIT5              SET COMMAND CONTROL SWITCH       01480000
         OI    SWITCHRD,BIT4           SET COMMAND BIT                  01500000
*                                                                       01540000
*                  THIS SECTION ADJUSTS THE POINTER TO THE FIRST CHAR   01560000
*                     OF COMMAND, IF NO COMMAND FOUND COL 71 SET BYPASS 01580000
*                     BIT                                               01600000
STARTCMD CLI   0(NEXTCOL),BLANKCOL     IS COLUMN BLANK            M2840 01640002
         BNE   SCAN                    NO, FIRST CHAR OF CMD WORD M2840 01660002
         CR    NEXTCOL,COL71REG        IS THIS COLUMN 71          M2840 01680002
         BE    KINVALD                 YES, SET UP AS ERROR       M2840 01700002
         LA    NEXTCOL,BUMP1(I0,NEXTCOL)  ADJUST PTR TO NEXT COL  M2840 01720002
         B     STARTCMD                EXAMINE NEXT COLUMN        M2840 01740002
         EJECT                                                          01759802
KCONT    LA    NEXTCOL,COL16           SET PTR TO CONTINUE COLUMN M2840 01759902
*                                                                       01773302
*                  RESET SWITCHRD CONTROLS, RESET EXIT CONTROLS SAVE    01780000
*                     LAST DELIMITER AND CLEAR DELIMITER INDICATOR      01800000
*                                                                       01820000
SCANR    NI    SWITCHRD,RESET1         RESET COMMAND BIT                01840000
SCAN     NI    SWITCHRD,RESET2         RESET ALL BITS BUT ERROR AND     01860000
*                                         FIRST ENTRY                   01880000
         NI    DISP5,BIT8              RESET ALL SWITCHES BUT COMMAND   01900000
*                                         CONTROL SWITCH                01920000
SCANPP   MVC   DISP11,DISP10           SAVE CURRENT IN LAST DELIM M2840 01940002
         NI    DISP10,NULL             CLEAR CURRENT DELIMITER    M2840 01960002
*                                                                       02000000
*                  THIS ROUTINE SCANS CARD UNTIL DELIMITER IS FOUND     02020000
*                     SAVES ADDRESS OF FIRST CHAR, COMPUTES LENGTH,     02040000
*                     SET BIT IN EXIT CONTROL IF DELIM IS IN END  COL   02060000
*                     OR BEFORE END COL                                 02080000
*                                                                       02100000
         SR    LENGTH,LENGTH           SET LENGTH = ZERO          M2840 02140002
         LR    STARTCOL,NEXTCOL        START SCAN WHERE LEFT OFF  M2840 02180002
KOMPAR   CLI   0(NEXTCOL),KSPLT        IS CHAR A DELIMITER        M2840 02200002
         BC    LOW,KFIND               YES, BRANCH                M2840 02220002
KOMPARA  LA    LENGTH,BUMP1(I0,LENGTH) ADD ONE TO LENGTH          M2840 02240002
         CR    NEXTCOL,COL71REG        IS THIS COLUMN 71?         M2840 02260002
         BE    KPART                   YES, PARTIAL PARM, BRANCH  M2840 02280002
KOMPARS  LA    NEXTCOL,BUMP1(I0,NEXTCOL)  ADJUST PTR TO NEXT COL  M2840 02300002
         B     KOMPAR                  KEEP LOOKING FOR DELIMETER M2840 02320002
*                                                                       02340000
*                  KFIND CHECKS FOR DELIMITER OF PERIOD OR MINUS IF     02360000
*                     PRESENT RETURNS TO SCAN ROUTINE, TESTS END COLUMN 02380000
*                     IF DELIMITER IS IN END COL SET CC2 BIT IF BEFORE  02400000
*                     END COL SET CC1 BIT AND GOES TO TEST DELIMITER    02420000
*                     ROUTINE                                           02440000
*                                                                       02460000
KFIND    CLI   0(NEXTCOL),PERIOD       IS DELIMETER A PERIOD?     M2840 02480002
         BE    KOMPARA                 IGNORE, GO LOOK FOR DELIM  M2840 02500002
         CLI   0(NEXTCOL),MINUS        IS DELIMITER MINUS SIGN?   M2840 02520002
         BE    KOMPARA                 IGNORE, GO LOOK FOR DELIM  M2840 02540002
         CLI   0(NEXTCOL),DOLLAR      IS DELIMITER DOLLAR SIGN @ZA16491 02550099
         BE    KOMPARA               IGNORE, GO LOOK FOR DELIM @ZA16491 02552099
         CLI   0(NEXTCOL),NUMB         IS DELIMITER NUMB SIGN  @ZA16491 02554099
         BE    KOMPARA               IGNORE, GO LOOK FOR DELIM @ZA16491 02556099
         CLI   0(NEXTCOL),AT           IS DELIMITER AT SIGN    @ZA16491 02558099
         BE    KOMPARA               IGNORE, GO LOOK FOR DELIM @ZA16491 02558499
         CR    NEXTCOL,COL71REG        IS THIS COLUMN 71?         M2840 02560002
         BC    NO,TESTPAR              NO, GO CHECK LENGTH        M2840 02580002
         TM    DISP5,BIT3              IS PARTIAL PARAM SWITCH ON       02620000
         BO    KINVALD                 IF ON LENGTH IS TOO LONG   M2840 02640002
*                                                                       02880000
*                  TESTPAR CHECKS FOR PRESENCE OF PARTIAL PARAMETER     02900000
*                                                                       02960000
TESTPAR  TM    DISP5,BIT3              IS PARTIAL PARAMETER SWITCH ON   02980000
         BO    KPPAR                   YES, GO HANDLE PART PARAM  M2840 03000002
*                                                                       03100000
*                  DELIM CHECKS FOR VALID DELIMETERS AND BRANCHES TO    03120000
*                     ROUTINE TO SET CONTROL SWITCHES                   03140000
*                     IF INVALID DELIMITER IS FOUND BRANCH TO KINVAL    03160000
*                                                                       03180000
DELIM    CLI   0(NEXTCOL),EQUAL        DELIMETER EQUAL SIGN?      M2840 03200002
         BE    KEY1                    GO HANDLE VALUE AS KEYWORD M2840 03220002
         CLI   0(NEXTCOL),COMMA        DELIMETER A COMMA?         M2840 03240002
         BE    PARAMC                  GO HANDLE VALUE AS PARAM   M2840 03260002
         CLI   0(NEXTCOL),APOST        DELIMETER APOSTROPHE?      M2840 03280002
         BE    PARMAPT                 GO HANDLE AS OWNER         M2840 03300002
         CLI   0(NEXTCOL),BLANKCOL     DELIMETER A BLANK          M2840 03320002
         BE    PARBLANK                GO HANDLE VALUE AS PARAM   M2840 03340002
*                                                                 M2840 03350002
*                  INVALID DELIMETER FOUND                        M2840 03352002
*                     SET 'ERROR' FOR IEHINITT (MESSAGE IS        M2840 03354002
*                     'INVALID CONTROL STATEMENT')                M2840 03356002
*                                                                 M2840 03360002
*                                                                       03362002
KINVALD  OI    SWITCHRD,BIT0+BIT1      SET ERROR BIT & BYPASS     M2840 03370002
         B     KPASS                   RETURN ERROR TO CALLER     M2840 03372002
         EJECT                                                          03382002
*                                                                       03393302
*                  KIRSCO IS THE FIRST ENTRY ROUTINE WHICH CLEARS       03400000
*                     CONTROL SWITCHES TO ZERO FOR FIRST READ           03420000
*                     GOES TO READ A CARD ROUTINE                       03440000
*                                                                       03460000
KIRSCD   OI    SWITCHRD,BIT3           SET FIRST ENTRY SWITCH           03480000
         SR    NEXTCOL,NEXTCOL         CLEAR LAST COL PTR AND     M2840 03500002
         ST    NEXTCOL,DISP5           DISP5,DISP8,DISP10,DISP11  M2840 03520002
         MVI   DISP8,FOXFOX            INDICATE FIRST ENTRY             03560002
*                                                                       03580000
*                  KGTCD READS A CARD INTO INPUT AREA IF LAST CARD      03600000
*                     HAS BEEN READ GO TO KEOF IF NOT GO TO KGTGDR      03620000
*                                                                       03640000
KGTCD    L     R1,READAD               GET ADDRESS OF SYSIN DCB   M2840 03660002
         LA    R1,0(I0,R1)             CLEAR HIGH-ORDER BYTE      M2840 03680002
         LA    R0,CARD                 LOAD ADDRESS OF INPUT AREA       03700000
         LA    R13,GPSAVE              POINT AT IEHSCAN SAVE AREA M2840 03720002
         GET   (R1),(R0)               READ A CARD                      03740000
         CLI   DISP8,FOXFOX            IS THIS THE FIRST CARD     M2840 03760002
         BNE   PRNT                    BRANCH ON NO               M2840 03780002
         MVI   DISP8,NULL              RESET FIRST ENTRY BYTE     M2840 03800002
PRNT     BAL   LINKREG,KPRNT           BRANCH TO PRINT OUT CARD   M2840 03860002
*                                                                       03880000
*                  KGTCDR                                               03900002
*                      TEST BYPASS BIT IF ON                            03920002
*                     GO TO KBYPO IF OFF GO TO ROUTINE TO TEST ENTRY    03940000
*                     CONTROL SWITCH                                    03960000
*                                                                       03980000
KGTCDR   MVI   DISP8,NULL                                               04000002
         TM    SWITCHRD,BIT1           IS BYPASS SWITCH ON        M2840 04080002
         BO    KBYPO1                  JUST READ AND PRINT CARDS  M2840 04100002
         B     KPFOL                   HOUSEKEEP, LOOK FOR DELIM  M2840 04120002
         EJECT                                                          04130002
*                                                                       04140000
KEY1     OI    SWITCHRD,BIT5           SET KEYWORD BIT                  04150002
         OI    DISP10,BIT0             SET DELIM EQUAL SIGN BIT         04152002
         B     DECID1                  CHECK FOR VALIDITY         M2840 04154002
*                                                                       04154402
PARAMC   OI    SWITCHRD,BIT6           SET PARAMETER BIT                04156002
         OI    DISP10,BIT1             SET DELIM COMMA BIT              04158002
*                                                                       04158102
DECID1   LTR   LENGTH,LENGTH           IS LENGTH EQUAL ZERO       M2840 04158402
         BC    8,KINVALD               NO KEYWORD OR VALUE, ERROR M2840 04158502
         OI    DISP5,BIT2              SET PARM FOLLOWS SWITCH          04162202
         CR    NEXTCOL,COL71REG        DELIMITER IN COLUMN 71     M2840 04166702
         BNE   KPASS                   DELIMITER OKAY, RETURN     M2840 04170402
         CLI   COL72,BLANKCOL          IS COLUMN 72 BLANK         M2840 04174102
         BE    KINVALD                 SHOULD CONTINUE, ERROR     M2840 04177802
         OI    DISP5,CONT              SET READ CARD AND CONTINUE M2840 04181502
         B     KPASS                   RETURN KEYWORD OR PARAM    M2840 04185202
*                                                                       04188902
*                  PARBLANK IS ENTERED IF DELIMITER WAS A BLANK         04192602
*                     CHECK FOR PRESENCE OF COMMAND WORD IF COMMAND     04196302
*                     ADJUST POINTER TO NEXT NON BLANK COLUMN           04200000
*                     CHECK LENGTH IF NOT ZERO SET BYPAS SWITCH         04220000
*                     IF ZERO AND PRECEEDED BY COMMA READ NEXT CARD     04240000
*                                                                       04260000
PARBLANK TM    DISP5,BIT5              IS COMMAND CONTROL SWITCH ON     04280000
         BO    KPCMD                   BRANCH IF YES             M2840  04300002
         OI    SWITCHRD,BIT6           SET PARMETER BIT                 04320000
         OI    DISP10,BIT4             SET BLANK DELIMETER BIT          04340000
*                                                                       04360000
*                  DECID2 CHECK THE EXIT CONTROL SWITCH AND DELIMITERS  04380002
*                     INDICATOR TO SET CORRECT ENTRY SWITCHES AND       04400000
*                     INFORMATION FOR USER PROGRAM                      04420000
*                                                                       04440000
DECID2   LTR   LENGTH,LENGTH           IS LENGTH EQUAL ZERO       M2840 04450002
         BC    7,NOTZERO               NOT ZERO, BRANCH           M2840 04452002
         TM    DISP11,BIT1             PREVIOUS DELIM COMMA       M2840 04454002
         BNO   KINVALD                 NOT COMMA, ERROR           M2840 04456002
         CLI   COL72,BLANKCOL          COLUMN 72 BLANK            M2840 04458002
         BE    KINVALD                 SHOULD CONTINUE, ERROR     M2840 04458402
         OI    DISP5,CONT              SET READ CARD AND CONTINUE M2840 04458802
         B     KGTCD                   READ ANOTHER CARD         SM5216 04459202
NOTZERO  CLI   COL72,BLANKCOL          ANY CONTINUATION          SM5216 04509202
         BNE   SETREAD                 NO, SET UP TO RETURN      SM5216 04519202
         OI    SWITCHRD,BIT1           SET BYPASS                SM5216 04559202
         B     KPASS                   RETURN PARAMETER          SM5216 04609202
KBYPO1   CLI   COL72,BLANKCOL          IS COLUMN 72 BLANK        SM5216 04659202
         BNE   KGTCD                   NO, KEEP READING CARDS    SM5216 04709202
         B     KPASS                   RETURN PARAMETER           M2840 04759202
SETREAD  OI    SWITCHRD,BIT7           SET ON COMMENT BIT        SM5216 04809202
         B     KPASS                   RETURN PARAMETER          SM5216 04859202
         EJECT                                                          06550002
*                                                                       06720000
*                                                                       06740000
*                                                                       06800000
KPRNT    TM    POPENFLG,BIT3           IS PRINT DCB OPEN, IF NOT  M2840 06806002
         BCR   8,LINKREG               THEN SKIP PRINTING         M2840 06812002
         MVI   MSGTEXT,BLANKCOL        SET UP BLANK CLEAR CHAR    M2840 06840002
         MVC   MSGTEXT+D1(L119),MSGTEXT  CLEAR BUFFER TO BLANKS   M2840 06860002
         MVC   MSGTEXT(L'CARD),CARD    MOVE CARD IMAGE            M2840 06900002
         ST    NEXTCOL,SAVEZ           SAVE LAST COL SCANNED      M2840 06920002
         LA    NEXTCOL,MSGWTR          POINTER TO PRINT LINE      M2840 06940002
         LA    R13,GPSAVE              PTR TO IEHSCAN SAVE AREA   M2840 06942002
         ST    R12,8(R13)              SAVE PTR TO START OF WORK  M2840 06950002
         LA    R12,COMTAB              LOAD PTR WITHIN WORK       M2840 06960002
         LINK  EP=IEHPRNT              PRINT CARD JUST READ       M2840 07060002
         L     R12,8(R13)              RESTORE PTR TO WORK START  M2840 07112002
         L     NEXTCOL,SAVEZ           RESTORE LAST COL SCANNED   M2840 07120002
         TM    SWITCH2,BIT7            IS PERM ABORT BIT ON       M2840 07140002
         BO    KINVALD                 SET UP FOR ERROR           M2840 07160002
         BR    LINKREG                 RETURN TO CALLING ROUTINE  M2840 07180002
*                                                                       07200000
         EJECT                                                          07250002
*                                                                       07500000
*                                                                       07520000
KPART    TM    DISP5,BIT3              IS PARTIAL PARM SWITCH ON        07540000
         BO    KINVALD                 TOO LONG, ERROR            M2840 07560002
KPTERR   OI    DISP5,BIT3              SET PARTIAL PARM BIT             07600000
         CLI   COL72,BLANKCOL          IS COLUMN 72 BLANK         M2840 07610002
         BE    KLAST                   YES, BLANK, BRANCH         M2840 07640002
         MVI   PARMKEEP,BLANKCOL       CLEAR FIRST BYTE           M2840 07660002
         MVC   PARMKEEP+D1(L43),PARMKEEP   CLEAR REMAINDER        M2840 07680002
         STC   LENGTH,PARMLNG          LENGTH OF PARTIAL PARM     M2840 07700002
         BCTR  LENGTH,REG0             ADJUST LENGTH FOR MOVE     M2840 07720002
         EX    LENGTH,MOVEP            MOVE PARTIAL PARM TO SAVE  M2840 07740002
         OI    DISP5,BIT1                                               07760000
         B     KGTCD                   GO READ ANOTHER CARD       M2840 07792002
KLAST    OI    SWITCHRD,BIT6           SET PARM BIT                     07794002
KBYPS    OI    SWITCHRD,BIT1           SET BYPASS SWITCH                07796002
         B     KPASS                   RETURN PARAM TO CALLER     M2840 07798002
*                                                                       07840000
*                                                                       07860000
KPPAR    SR    PPWRKREG,PPWRKREG       CLEAR REG                  M2840 07880002
         IC    PPWRKREG,PARMLNG        PICK UP PARTIAL LENGTH     M2840 07900002
         AR    PPWRKREG,LENGTH         ADD SECOND PART LENGTH     M2840 07920002
         C     PPWRKREG,FOUR4          IS TOTAL GREATER THAN 44   M2840 07940002
         BH    KINVALD                 YES, TOO LONG, ERROR       M2840 07960002
         LTR   LENGTH,LENGTH           SECOND HALF LENGTH = 0     M2840 07970002
         BC    8,KOMPL                 TOTAL PARAM IN FIRST HALF  M2840 07972002
         SR    PPWRKREG,PPWRKREG       CLEAR WORK REGISTER        M2840 08040002
         IC    PPWRKREG,PARMLNG        GET PARTIAL PARM LENGTH    M2840 08060002
         LA    WRKREG,PARMKEEP         ADDR OF PARTIAL SAVE AREA  M2840 08080002
         AR    PPWRKREG,WRKREG         ADDR OF START SECOND HALF  M2840 08100002
         BCTR  LENGTH,REG0             DECREASE LENGTH BY 1       M2840 08120002
         EX    LENGTH,MOVPP            EXECUTE MOVE INSTRUCTION   M2840 08140002
         LA    LENGTH,BUMP1(I0,LENGTH) RESTORE ORIGINAL LENGTH    M2840 08160002
KOMPL    SR    PPWRKREG,PPWRKREG       CLEAR WORK REGISTER        M2840 08180002
         IC    PPWRKREG,PARMLNG        GET FIRST PART OF LENGTH   M2840 08200002
         AR    LENGTH,PPWRKREG         ADD PART LENGTH TO LENGTH  M2840 08220002
         LA    STARTCOL,PARMKEEP       PICK UP ADDR OF SAVE AREA  M2840 08240002
         MVC   DISP11(1),DISP10        SAVE LAST DELIM INDICATOR        08320000
         NI    DISP10,RESET0           CLEAR CURRENT DELIM FLAG   M2840 08340002
         NI    DISP5,RESET6            RESET PARTIAL PARM SWITCH        08360000
         B     DELIM                   GO CHECK FOR VALID DELIM   M2840 08380002
         EJECT                                                          08390002
*                                                                       08400000
*                                                                       08420000
KPASS    LA    NEXTCOL,BUMP1(I0,NEXTCOL)  ADJUST PTR TO NEXT COL  M2840 08440002
KPASS1   NI    DISP5,X'EB'                                              08460000
         ST    STARTCOL,PARMPTR        FIRST CHAR OF THIS SCAN    M2840 08480002
         ST    NEXTCOL,DISP12          START OF NEXT SCAN         M2840 08500002
         ST    LENGTH,LNGPARM          LENGTH OF PARAMETER        M2840 08520002
KPASS2   L     R13,GPSAVE+4                                        9837 08540001
         RETURN (14,12),T              RETURN TO CALLER           M2840 08560002
*                                                                       08580000
*                                                                       08600000
KPCMD    LA    NEXTCOL,BUMP1(I0,NEXTCOL)  ADJUST PTR TO START OF NEXT   08620002
         CLI   0(NEXTCOL),BLANKCOL     THIS CHARACTER A BLANK     M2840 08640002
         BNE   KPCMA                   END OF BLANKS AFTER CMD    M2840 08660002
         CR    NEXTCOL,COL71REG        ALL BLANKS TO COL 71       M2840 08680002
         BE    KINVALD                 NO PARAM IN CARD, ERROR    M2840 08700002
         B     KPCMD                   KEEP LOOKING FOR NON-BLANK M2840 08720002
*                                                                       08740000
*                                                                       08760000
KPCMA    BCTR  NEXTCOL,REG0            POINT AT LAST BLANK        M2840 08820002
PRFOL    OI    DISP5,BIT2              SET PARM FOLLOW TO ENTRY CONTROL 09050002
         B     KPASS                   RETURN TO CALLER           M2840 09052002
*                                                                       09060000
         EJECT                                                          09110002
*                                                                       09180000
*                                                                       09200000
*                                                                       09220000
*                  THIS ROUTINE CHECKS FOR A SECOND APOSTROPHY AS A     09240000
*                     DELIMETER FOR THE OWNER FIELD                     09260000
*                                                                       09280000
PARMAPT  CLI   KEY,BIT2                WAS KEYWORD OWNER          M2840 09290002
         BNE   KINVALD                 INVALID APOSTROPHES, ERROR M2840 09292002
         OI    DISP11,BIT5             SET FIRST TIME BIT         M2840 09300002
         LA    OWNRREG,OWNRHOLD        PTR=START OF OWNER HOLD    M2840 09310002
         SR    BYTECTR,BYTECTR         ZERO OUT OWNER BYTE CNTR   M2840 09320002
ONWARD   CR    NEXTCOL,COL71REG        IS THIS COLUMN 71?         M2840 09360002
         BC    4,EVRONWRD              BRANCH IF NO               M2840 09380002
         CLI   COL72,BLANKCOL          IS CARD CONTINUED          M2840 09400002
         BE    KINVALD                 BRANCH FOR ERROR IF NO     M2840 09420002
         L     R1,READAD               GET THE NEXT CARD TO FINISH      09440000
         LA    R1,0(I0,R1)                PICKING UP THE OWNER FIELD    09460002
         LA    R0,CARD                 CARD WORK AREA             M2840 09480002
         LA    R13,GPSAVE              PTR TO IEHSCAN SAVE AREA   M2840 09500002
         GET   (R1),(R0)               READ A RECORD              M2840 09520002
         BAL   LINKREG,KPRNT           PRINT OUT  NEW CARD IMAGE  M2840 09560002
         LA    NEXTCOL,COL15           START TO SCAN NEW CARD     M2840 09600002
EVRONWRD LA    NEXTCOL,BUMP1(I0,NEXTCOL)  INCREMENT TO NEXT CHAR  M2840 09620002
         CLI   0(NEXTCOL),APOST        THIS CHAR AN APOSTROPHE    M2840 09640002
         BE    PAIRS                   BRANCH IF YES              M2840 09660002
MOVEONE  MVC   0(1,OWNRREG),0(NEXTCOL) MOVE A CHAR TO OWNER HOLD  M2840 09680002
         NI    DISP11,FOXBAKER         TURN OFF FIRST TIME BIT    M2840 09700002
         LA    OWNRREG,BUMP1(I0,OWNRREG) INCREMENT OWNER HOLD PTR M2840 09710002
         LA    BYTECTR,BUMP1(I0,BYTECTR) INCREMENT OWNER BYTE CNT M2840 09720002
         LA    OWNFULL,OWNRHOLD+14     IS OWNER HOLD FULL         M2840 09730002
         CR    OWNRREG,OWNFULL                                    M2840 09760002
         BC    2,KINVALD               BRANCH ON YES              M2840 09780002
         B     ONWARD                  GO EXAMINE NEXT CHAR       M2840 09800002
PAIRS    TM    DISP11,BIT5             IS THIS THE FIRST TIME     M2840 09820002
         BZ    TWOAPST                 BRANCH IF NO               M2840 09840002
         NI    DISP11,FOXBAKER         TURN OFF FIRST TIME BIT    M2840 09860002
         LA    NEXTCOL,BUMP1(I0,NEXTCOL)  POINT AT NEXT COL       M2840 09880002
         TM    0(NEXTCOL),APOST        ERROR IF ONLY TWO APOSTROPHIES   09900002
         BC    12,KINVALD                 AT BEGINNING OF OWNER NAME    09920002
         B     MOVEONE                 MOVE APOSTROPHE TO HOLD    M2840 09940002
TWOAPST  LA    NEXTCOL,BUMP1(I0,NEXTCOL)  POINT AT NEXT COL       M2840 09960002
         CLI   0(NEXTCOL),APOST        SECOND APOSTROPHE          M2840 09980002
         BE    MOVEONE                 END OF OWNER NAME FIELD    M2840 10000002
         NI    KEY,NULL                TURN OFF OWNER NAME BIT    M2840 10020002
         OI    SWITCHAL,OWNRSW         FLAG OWNER PARM SPECIFIED S20038 10026020
         ST    BYTECTR,OWNRLNG         SAVE OWNER PARM LENGTH     M2840 10032002
         CLI   0(NEXTCOL),COMMA        DELIMITER A COMMA          M2840 10040002
         BE    SETCOM                  YES, BRANCH                M2840 10060002
         CLI   0(NEXTCOL),BLANKCOL     DELIMITER A BLANK          M2840 10080002
         BE    SETEND                  YES, END OF SCAN           M2840 10100002
         B     KINVALD                 SET ERROR INDICATOR        M2840 10120002
*                                                                       10130002
SETCOM   OI    DISP10,BIT1             SCAN FOR KEYWORD           M2840 10140002
KPAFOL   LA    NEXTCOL,BUMP1(I0,NEXTCOL)  POINT AT NEXT COL       M2840 10160002
         B     SCANR                                                    10180000
*                                                                       10190002
SETEND   OI    SWITCHRD,BIT1           END OF SCAN, SET BYPASS    M2840 10200002
         CLI   COL72,BLANKCOL          IS COLUMN 72 BLANK?              10210002
         BE    KPASS1                  YES, END OF SCAN                 10260002
         B     KGTCD                   READ ANOTHER CARD                10320002
*                                                                       10360000
*                                                                       10380000
KEOF     MVI   SWITCHRD,BIT2           SET END OF FILE BIT ONLY   M2840 10420002
         B     KPASS                   RETURN TO CALLING PROGRAM  M2840 10440002
*                                                                       10460000
*                                                                       10480000
*                                                                       10620000
*                                                                       10640000
KSYNAD   OI    DISP11,BIT7             INDICATE SYNAD WAS ENTERED  9837 10645002
         MVI   RC,RCODE16              SET RETURN CODE OF 16      M2840 10650002
         B     KPASS2                                              9837 10655014
*                                                                       10660000
*                                                                       10680000
MOVEP    MVC   PARMKEEP(1),0(STARTCOL)                                  10700002
MOVPP    MVC   0(1,PPWRKREG),0(STARTCOL)                                10720002
EODA     DC    AL3(KEOF)                                                10760000
FOUR4    DC    F'44'                                                    10780000
SYNAD    DC    AL3(KSYNAD)             SYNAD FOR SYSIN DCB         9837 10810014
*                                                                S20038 10815020
         ORG   *+200                   MAINTENANCE AREA FOR PGM  S20038 10820020
         EJECT                                                          10822002
*                                                                S20038 10825020
* REGISTER ALLOCATION, INSTRUCTION MASK AND BIT SETTINGS         S20038 10830020
*                                                                S20038 10835020
EODAD    EQU   33                                                       10840000
REG0     EQU   0                                                        10850002
R0       EQU   0                                                        10860000
R1       EQU   1                                                        10880000
STARTCOL EQU   1                                                        10890002
LENGTH   EQU   2                                                        10910002
R3       EQU   3                                                        10920000
NEXTCOL  EQU   3                       PTR TO NEXT COL OF SCAN    M2840 10930002
OWNFULL  EQU   4                                                        10940002
PPWRKREG EQU   4                       PARTIAL PARAMETER WORK REG M2840 10950002
R5       EQU   5                                                        10960000
COL71REG EQU   5                       ADDR OF COL 71 OF CARD     M2840 10970002
BYTECTR  EQU   6                                                        10980002
OWNRREG  EQU   7                                                        11000002
WRKREG   EQU   8                                                        11020002
R9       EQU   9                                                        11040000
LINKREG  EQU   9                       LINK TO PRINT SUBROUTINE   M2840 11050002
WORKREG  EQU   10                      PTR TO GETMAIN WORK AREA   M2840 11060002
SCANBASE EQU   11                      BASE REGISTER FOR IEHSCAN  M2840 11080002
R12      EQU   12                                                       11100000
R13      EQU   13                                                       11120000
R14      EQU   14                                                       11140000
R15      EQU   15                                                       11160000
BUMP1    EQU   1                       INCREMENT REG WITH LD ADDR M2840 11170002
I0       EQU   0                       INDEX REG 0 FOR LD ADDR    M2840 11172002
BIT0     EQU   X'80'                   SET ERROR, CC0                   11180000
BIT1     EQU   X'40'                   SET BYPASS,CONT,CC1              11200000
BIT2     EQU   X'20'                   SET EOF, PARM FOLLOW, CC2        11220000
BIT3     EQU   X'10'                   SET FIRST ENTRY, PARTIAL PARM    11240000
BIT4     EQU   X'08'                   SET COMMAND,READ CARD COL 72 B   11260000
BIT5     EQU   X'04'                   SET KEYWORD,CSWITCH,COL 72 NB    11280000
BIT6     EQU   X'02'                   SET PARM LNG GTR 0               11300000
BIT7     EQU   X'01'                   SET PARM LNG = 0                 11320000
BIT8     EQU   X'14'                                                    11340000
BIT0OFF  EQU   X'7F'                   RESET BIT 0                M2840 11350002
RESET0   EQU   X'00'                                                    11380000
RESET1   EQU   X'F7'                   RESET COMMAND,RDCD,COL 72 BLANK  11400000
RESET2   EQU   X'98'                                                    11420000
RESET6   EQU   X'EF'                                                    11500000
RESET10  EQU   X'0C'                                                    11580000
NULL     EQU   X'00'                   RESET SINGLE BYTE SWITCH   M2840 11630002
CONT     EQU   X'48'                                                    11660000
ON       EQU   1                                                        11680000
OFF      EQU   8                                                        11700000
YES      EQU   8                                                        11760000
NO       EQU   7                                                        11780000
ZERO     EQU   8                                                        11820000
SAME     EQU   8                                                        11840000
KSPLT    EQU   X'7F'                                                    11860000
LOW      EQU   4                                                        11880000
EQUAL    EQU   X'7E'                                                    11960000
COMMA    EQU   X'6B'                                                    11980000
BLANKCOL EQU   X'40'                                                    12000000
APOST    EQU   X'7D'                                                    12020000
PERIOD   EQU   X'4B'                                                    12040000
MINUS    EQU   X'60'                                                    12060000
DOLLAR   EQU   X'5B'                   '$' ACCEPTABLE          @ZA16491 12110099
NUMB     EQU   X'7B'                   '#' ACCEPTABLE          @ZA16491 12120099
AT       EQU   X'7C'                   '@' ACCEPTABLE          @ZA16491 12130099
MSKE     EQU   X'42'                                                    12160000
OWNRSW   EQU   X'40'                   OWNER PARM SPECIFIED      S20038 12244020
RCODE16  EQU   X'10'                   RETURN CODE OF 16          M2840 12244402
FOXBAKER EQU   X'FB'                   RESET OWNER FIRST TIME SWITCH    12244802
FOXFOX   EQU   X'FF'                   FIRST ENTRY (OR NEW SET)   M2840 12245202
D1       EQU   1                       DISPLACEMENT               M2840 12245602
L43      EQU   43                      DISPLACEMENT               M2840 12249402
L119     EQU   119                     LENGTH                     M2840 12253402
         EJECT                                                          12257202
*                                                                S20038 12261002
* WORKING STORAGE FOR SCAN MODULE IS A COMMON AREA SHARED BY THE S20038 12264802
* CONTROL MODULE AND THE PRINT MODULE.                           S20038 12268602
*                                                                S20038 12272402
         SPACE 3                                                        12276202
WORK     DSECT 0F                                                       13773202
FIRST    DS    0F                                                       13783202
*                                                                       13793202
*                  THE FOLLOWING AREA DESCRIBES THE VOLUME        M2840 13803202
*                       LABEL (80 BYTES) AND DUMMY HDR1           M2840 13813202
*                       RECORD (80 BYTES).  THESE AREAS           M2840 13815202
*                       MUST BE CONTIGUOUS                        M2840 13817202
*                                                                       13819202
LABEL    DS    0CL80                   MUST BE                   S20038 13821202
VOL1     DS    CL4                     CONSTANT VOL1 FIELD        M2840 13821602
SERIAL   DS    CL6                     VOLUME SERIAL FIELD        M2840 13822002
SECURITY DS    CL1                     VOLUME SECURITY FIELD      M2840 13822402
         DS    CL69                    NOT REFERENCED             M2840 13822802
DUMMYHDR DS    CL80                    CONTIGUOUS                S20038 13822902
*                                                                       13823002
*                  THE FOLLOWING AREA DESCRIBES THE LIST          M2840 13823102
*                       PASSED TO THE LABEL SVC.  THE AREA        M2840 13873102
*                       MUST BE CONTIGUOUS AND MUST BE            M2840 13883102
*                       ALIGNED ON A FULLWORD BOUNDARY            M2840 13893102
*                                                                       13903102
SVCLST   DS    0CL20                   FIVE WORD PARM LIST        M2840 13913102
SVCRUNOP DS    CL3                     REWIND/REWIND-UNLOAD       M2840 13915102
SVCUCB   DS    CL1                     UCB INDICATOR              M2840 13917102
SVCDDPTR DS    CL4                     POINTER TO DDNAME          M2840 13919102
SVCLBLPT DS    CL4                     PTR TO LABEL/DUMMY HEADER  M2840 13921102
         DS    CL8                                                      13921502
*                                                                       13921902
HOMEJFCB DS    CL176                   INPUT AREA FOR RDJFCB      M2840 13922302
*                                                                       13922702
CARD     DS    CL80                    SCANNED CARD INPUT AREA    M2840 13922802
COL2     EQU   CARD+1                  POSITION 2 OF CDS          M2840 13935302
COL15    EQU   CARD+14                 POSITION 15 OF CDS         M2840 13945302
COL16    EQU   CARD+15                 POSITION 16 OF CDS         M2840 13947302
COL71    EQU   CARD+70                 POSITION 71 OF CDS         M2840 13947702
COL72    EQU   CARD+71                 POSITION 72 OF CDS         M2840 13947802
*                                                                       13948002
DISP12   DS    F                       SAVE FOR START NEXT SCAN   M2840 13960502
PARMPTR  DS    F                       PTR TO START PASSED PARM   M2840 13973002
LNGPARM  DS    F                       LENGTH OF PASSED PARAM     M2840 13983002
COMTAB   DS    0F                                                       13993002
READAD   DS    F                       ADDRESS OF READ DCB        M2840 14003002
PRINTAD  DS    F                       ADDRESS OF PRINT DCB       M2840 14013002
JFLSTAD  DS    F                       ADDR OF HOMEJFCB (READIN)  M2840 14015002
AGO      DS    F                       ADDR DUMMY DCB FOR RDJFCB  M2840 14017002
JFCBLST  DS    F                                                        14019002
*                                                                 M2840 14021002
*                  MESSAGE LINE, INCLUDING PAGE AND LINE COUNT    M2840 14021402
*                                                                 M2840 14021802
MSGWTR   DS    0CL128                                             M2840 14022202
CC       DS    CL1                     CARRIAGE CONTROL (ASA)     M2840 14022602
MSGTEXT  DS    CL120                   PRINT LINE                 M2840 14022702
MFILL1   DS    CL1                     NOT REFERENCED             M2840 14022802
PAGENUM  DS    CL2                     STARTING PAGE NUMBER       M2840 14022902
LINETOT  DS    CL2                     TOTAL LINES PER PAGE       M2840 14072902
LINELEFT DS    CL2                     LINES NOT YET PRINTED      M2840 14082902
*                                                                 M2840 14092902
SAVE     DS    18F                     IEHINITT SAVE AREA         M2840 14102902
GPSAVE   DS    18F                     IEHSCAN SAVE AREA          M2840 14112902
SAVEX    DS    18F                     IEHPRNT SAVE AREA          M2840 14114902
SAVEY    DS    2F                                                       14116902
SAVEZ    DS    1F                                                       14118902
MYSAVE   EQU   SAVEY                   3 FULLWORD SAVE AREA       M2840 14120902
TCB      DS    1F                      TCB/UCB PTR SAVE AREA      M2840 14121302
*                                                                 M2840 14121702
*                  PRINT DCB                                      M2840 14122102
*                                                                 M2840 14122502
PRINT    DS    0CL96                                              M2840 14122602
PFILL1   DS    CL40                    NOT REFERENCED             M2840 14122702
PDDNAME  DS    CL8                     DDNAME BEFORE OPEN         M2840 14122802
POPENFLG DS    CL1                     OPEN FLAG                  M2840 14172802
PFILL2   DS    CL8                     NOT REFERENCED             M2840 14182802
PSYNAD   DS    CL3                     PRINTER SYNAD ADDRESS      M2840 14192802
PFILL3   DS    CL2                     NOT REFERENCED             M2840 14202802
PBLKSZ   DS    CL2                     BLOCKSIZE                  M2840 14212802
PFILL4   DS    CL18                    NOT REFERENCED             M2840 14214802
PLRECL   DS    CL2                     RECORD LENGTH              M2840 14216802
PFILL5   DS    CL12                    NOT REFERENCED             M2840 14218802
*                                                                 M2840 14220802
*                  READ DCB                                       M2840 14221202
*                                                                 M2840 14221602
READ     DS    0CL96                                              M2840 14222002
RFILL1   DS    CL33                    NOT REFERENCED             M2840 14222402
REODAD   DS    CL3                     END OF DATA ADDRESS        M2840 14222502
RFILL2   DS    CL4                     NOT REFERENCED             M2840 14222602
RDDNAME  DS    CL8                     DDNAME BEFORE OPEN         M2840 14222702
ROPENFLG DS    CL1                     OPEN FLAG                  M2840 14272702
RFILL3   DS    CL8                     NOT REFERENCED             M2840 14282702
RSYNAD   DS    CL3                     SYNAD ADDRESS              M2840 14292702
RFILL4   DS    CL36                    NOT REFERENCED             M2840 14302702
*                                                                       14312702
*                  THE AREAS HERE AND THERE ARE WORK AREAS USED   M2840 14314702
*                       FOR PACKING, UNPACKING, CONVERTING TO     M2840 14316702
*                       DECIMAL, CONVERTING TO BIANRY, FIELD      M2840 14318702
*                       ADJUSTMENT, AND OTHER WORK PURPOSES.      M2840 14320702
*                                                                       14321102
D        DS    0D                                                       14321502
HERE     DS    CL10                                                     14321902
THERE    DS    CL12                                               10432 14322302
*                                                                       14322402
VALFLGS  DS    CL1                     VALID FLAGS               A46764 14322502
VALCOMP  DS    CL1                     DENSITY WORK AREA         A46764 14322602
DISP5    DS    CL1                     IEHSCAN SWITCH BYTE              14421002
DISP8    DS    CL1                     IEHSCAN SWITCH BYTE              14421402
DISP10   DS    CL1                     IEHSCAN CURRENT DELIM            14421802
DISP11   DS    CL1                     IEHSCAN PREVIOUS DELIM           14422202
*                                                                       14432202
*                  LABEL DCB                                            14442202
*                       NOTE: THE ONLY FIELDS THAT APPLY TO             14442302
*                       THE DCB ARE GO, DDNAME, AND DCBFLAGS            14442402
*                       THESE FIELDS MUST BE AT +36, +40, AND           14445702
*                       +48 RESPECTIVELY.                               14447702
*                                                                       14448102
*                       THE REMAINDER OF THE FIELDS ARE WORK AREA       14448502
*                                                                       14448902
LBLDCB   DS    0CL96                   DUMMY DCB                        14449202
SWITCHRD DS    CL1                     IEHSCAN PASSBACK INDICATOR M2840 14452502
PARMLNG  DS    CL1                     PARTIAL PARM LENGTH HOLD   M2840 14462502
SWITCHAL DS    CL1                     SWITCH FOR ASCII LABEL    S20038 14472502
KEY      DS    CL1                                                      14482502
OWNRLNG  DS    F                       HOLD FOR OWNER LENGTH     S20038 14492502
OWNRHOLD DS    CL14                    HOLD FOR OWNER PARM       S20038 14502502
DFLG     DS    X                                                   BS0H 14512502
DFLAG    DS    X                                                   BS0H 14514502
LASTDD   DS    CL8                     SAVE PREVIOUS DDNAME.      15673 14516502
RC       DS    CL1                     RETURN CODE SAVE AREA      M2840 14518502
SWITCH2  DS    CL1                                                      14520502
NUMTPS   DS    CL1                                                      14520902
UCBNUM   DS    CL1                                                      14521302
GO       DC    F'0'                    SAVE AREA FOR EXLIST             14521702
DDNAM    DS    CL8                     SAVE AREA FOR DDNAME       M2840 14522102
         DC    F'0'                    SAVE AREA FOR DCBFLG,DCBMACR     14522202
PARMKEEP DS    CL44                    PARAMETER SAVE AREA        M2840 14522302
*                                                                       14522402
UCBAREA  DS    CL176                   UCB PTRS FROM DD CARD     A23445 14572402
PARMERR  DS    X                       LINECNT & PAGECNT ERROR    M2840 14582402
LAST     DS    0H                                                       14592402
         END                                                            14622402
