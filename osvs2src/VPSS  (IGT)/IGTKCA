TKCA     TITLE 'IGTKCA -- TRANSLATE VPSS CHANNEL PROGRAM               *00001000
                        '                                               00002000
IGTKCA   CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IGTKCA    77.286'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @07,0                                            01S0001 00010000
@PSTART  LA    @08,4095(,@07)                                   01S0001 00011000
         USING @PSTART,@07                                      01S0001 00012000
         USING @PSTART+4095,@08                                 01S0001 00013000
*   RAPRLPTR=R1P;                   /* SAVE APRL ADDRESS             */ 00014000
         LR    RAPRLPTR,R1P                                     01S0179 00015000
*   RFY                                                         01S0180 00016000
*     APCT BASED(APCTPTR);          /* TELL                          */ 00017000
*   RFY                                                         01S0181 00018000
*     APDX BASED(RAPDXPTR);         /* COMPILER                      */ 00019000
*   RFY                                                         01S0182 00020000
*     APRL BASED(RAPRLPTR);         /* OF POINTERS.                  */ 00021000
*   RFY                                                         01S0183 00022000
*     DEBBASIC BASED(RDEBPTR);      /* DEB,APDX,APCT OK BY DEBCHK    */ 00023000
*   RFY                                                         01S0184 00024000
*     R1P UNRSTD;                   /* FINISHED WITH INPUT REG       */ 00025000
*   GEN(MODESET EXTKEY=DATAMGT)                                 01S0185 00026000
*   NOREFS NOSETS;                  /* RUN IN DATA MANAGEMENT KEY    */ 00027000
         MODESET EXTKEY=DATAMGT                                         00028000
         EJECT                                                          00029000
*                                                               01S0186 00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* ACQUIRE SAVEAREA/WORKAREA. INITIALIZE PL/S WORKAREA.          */ 00033000
*   /*                                                               */ 00034000
*   /*****************************************************************/ 00035000
*                                                               01S0186 00036000
*   DO;                             /* START OF CODE SEGMENT         */ 00037000
*                                                               02S0186 00038000
*     /***************************************************************/ 00039000
*     /*                                                             */ 00040000
*     /* ISSUE CONDITIONAL GETMAIN FOR SA-WA. ALLOW FOR CONSTRUCTED  */ 00041000
*     /* CONTROL BLOCKS (ACQUIRED BY 'IGTYGSTK'). ALLOW FOR FINAL    */ 00042000
*     /* COPY AT END OF AREA BY FREEING HALF THE EXTRA SPACE. THIS   */ 00043000
*     /* MINIMIZES STORAGE FRAGMENTATION SINCE STORAGE IS OBTAINED   */ 00044000
*     /* FROM THE HIGH END.                                          */ 00045000
*     /*                                                             */ 00046000
*     /***************************************************************/ 00047000
*                                                               02S0187 00048000
*     RFY                                                       02S0187 00049000
*      (RLV,                        /* GETMAIN LENGTH                */ 00050000
*       RADDR,                      /* ACQUIRED STORAGE ADDRESS      */ 00051000
*       R1P,                        /* ACQUIRED STORAGE ADDRESS      */ 00052000
*       R15F) RSTD;                 /* GETMAIN RETURN CODE           */ 00053000
*     RLV=(CPGSIZE+                 /* PL/S WORKAREA PLUS            */ 00054000
*         2*CTOTAL);                /* TWICE CONTROL BLOCK SIZE      */ 00055000
         L     RLV,@CF04211                                     02S0188 00056000
*     GEN REFS(RLV);                                            02S0189 00057000
*                                   /*                                  00058000
         GETMAIN RC,               CONDITIONAL REQUEST                 *00059000
               LV=(RLV),           REQUIRED LENGTH                     *00060000
               SP=CSPWORK,         SUBPOOL                             *00061000
               BNDRY=PAGE          PAGE BOUNDARY                        00062000
*     IF R15F^=0 THEN               /* IF STORAGE NOT ACQUIRED,      */ 00063000
         LTR   R15F,R15F                                        02S0190 00064000
         BZ    @RF00190                                         02S0190 00065000
*       DO;                         /* THEN SET ERROR FLAGS & EXIT.  */ 00066000
*         SPKA(DEBPROTG);           /* USER (APRL) KEY               */ 00067000
         SLR   @14,@14                                          02S0192 00068000
         IC    @14,DEBPROTG(,RDEBPTR)                           02S0192 00069000
         SPKA  0(@14)                                           02S0192 00070000
*         APRLRCT=APCCTLOG;         /* LOGICAL ERROR                 */ 00071000
         MVI   APRLRCT(RAPRLPTR),X'08'                          02S0193 00072000
*         APRLRCC=APCCI;            /* DETECTED BY I/O PROCESSOR     */ 00073000
         MVI   APRLRCC(RAPRLPTR),X'05'                          02S0194 00074000
*         APRLRCN=APCCI002;         /* INDIVIDUAL NUMBER             */ 00075000
         MVI   APRLRCN(RAPRLPTR),X'02'                          02S0195 00076000
*         APRLMSGN=APCMI002;        /* NO STORAGE                    */ 00077000
         MVC   APRLMSGN(2,RAPRLPTR),@CH01949                    02S0196 00078000
*         APRLVALN=APCMK049;        /* SUBPOOL NUMBER                */ 00079000
         MVC   APRLVALN(2,RAPRLPTR),@CH02060                    02S0197 00080000
*         R15F=APCCRERR;            /* REGISTER 15 ERROR VALUE       */ 00081000
         LA    R15F,8                                           02S0198 00082000
*         SVC(3);                   /* EXIT BACK TO CALLER           */ 00083000
         SVC   3                                                02S0199 00084000
*         GEN NOREFS NOSETS EXIT;                               02S0200 00085000
*                                   /*                                  00086000
*                                  NO CODE -- TELL PL/S THAT SVC 3      00087000
*                                  * DOES NOT RETURN CONTROL.           00088000
*       END;                        /* ERROR PROCESSED               */ 00089000
*                                                               02S0202 00090000
*     /***************************************************************/ 00091000
*     /*                                                             */ 00092000
*     /* FREEMAIN HIGH END OF ACQUIRED STORAGE. MAY BE RE-USED FOR   */ 00093000
*     /* PERMANENT COPIES (MINIMIZE STORAGE FRAGMENTATION).          */ 00094000
*     /*                                                             */ 00095000
*     /***************************************************************/ 00096000
*                                                               02S0202 00097000
*     RFY                                                       02S0202 00098000
*       R0F RSTD;                   /* REQUIRED REGISTER             */ 00099000
@RF00190 DS    0H                                               02S0203 00100000
*     RADDR=R1P;                    /* SAVE ADDR ACQUIRED STORAGE    */ 00101000
         LR    RADDR,R1P                                        02S0203 00102000
*     RLV=RLV-CTOTAL;               /* WILL FREE 'CTOTAL' BYTES      */ 00103000
         L     @14,@CF03933                                     02S0204 00104000
         SLR   RLV,@14                                          02S0204 00105000
*     R1P=R1P+RLV;                  /* POINT TO AREA TO FREE         */ 00106000
         ALR   R1P,RLV                                          02S0205 00107000
*     R0F=CTOTAL;                   /* LENGTH TO FREE                */ 00108000
         LR    R0F,@14                                          02S0206 00109000
*     GEN;                                                      02S0207 00110000
*                                   /*                                  00111000
         FREEMAIN RU,              FREE EXCESS STORAGE                 *00112000
               LV=(0),             * LENGTH = CTOTAL                   *00113000
               A=(1),              * FREE HI-END OF AREA               *00114000
               SP=CSPWORK          * SUBPOOL                            00115000
*     RFY                                                       02S0208 00116000
*      (R0F,                                                    02S0208 00117000
*       R1P,                                                    02S0208 00118000
*       R15F) UNRSTD;               /* FINISHED WITH REGISTERS       */ 00119000
*                                                               02S0208 00120000
*     /***************************************************************/ 00121000
*     /*                                                             */ 00122000
*     /* CALL IGTUAF TO BUILD A SAVEAREA-WORKAREA. INPUT IS: BYTE-0  */ 00123000
*     /* OF R0 = SUBPOOL, BYTES 1-3 OF R0 = LENGTH, R1 HAS DYNAMIC   */ 00124000
*     /* STORAGE ADDRESS. ON RETURN, R1 HAS ADDRESS OF APSC.         */ 00125000
*     /*                                                             */ 00126000
*     /***************************************************************/ 00127000
*                                                               02S0209 00128000
*     RFY                                                       02S0209 00129000
*      (R0F,                                                    02S0209 00130000
*       R1P) RSTD;                  /* REQUIRED REGISTERS            */ 00131000
*     R0F=CSPWORK*'01000000'X+RLV;  /* SUBPOOL + LENGTH IF SUBPOOL      00132000
*                                      NOT CONSTANT, USE 'SLL' TO       00133000
*                                      KEEP HI-BIT SET RIGHT         */ 00134000
         LR    R0F,RLV                                          02S0210 00135000
         AL    R0F,@CF04212                                     02S0210 00136000
*     R1P=RADDR;                    /* ADDRESS OF DYNAMIC AREA       */ 00137000
         LR    R1P,RADDR                                        02S0211 00138000
*     CALL APCVZUAF;                /* BUILD VPSS STORAGE BLOCKS     */ 00139000
         L     @15,APCTZUAF(,APCTPTR)                           02S0212 00140000
         BALR  @14,@15                                          02S0212 00141000
*     RFY                                                       02S0213 00142000
*      (RLV,                                                    02S0213 00143000
*       RADDR) UNRSTD;              /* FINISHED WITH THESE           */ 00144000
*     R0F=(APSVLN+APSCLN+@SIZDATD+7)/* PL/S WORKAREA + SAVEAREA      */ 00145000
*         &'0000FFF8'X;             /* ROUNDED TO DOUBLE-WORD        */ 00146000
         LA    R0F,95                                           02S0214 00147000
         AL    R0F,@SIZDATD                                     02S0214 00148000
         N     R0F,@CF03963                                     02S0214 00149000
*     R1P->APSCCRSZ=R0F;            /* SAVE THE SIZE                 */ 00150000
         STH   R0F,APSCCRSZ(,R1P)                               02S0215 00151000
*     R1P=R1P+APSCLN;               /* POINT TO APSV                 */ 00152000
         LA    R1P,8(,R1P)                                      02S0216 00153000
*     RFY                                                       02S0217 00154000
*       R0F UNRSTD;                 /* FINISHED WITH REGISTER        */ 00155000
*     R1P->APSVPREV=0;              /* NO PREVIOUS APSV              */ 00156000
         SLR   @10,@10                                          02S0218 00157000
         ST    @10,APSVPREV(,R1P)                               02S0218 00158000
*     APSVPTR=R1P;                  /* POINT TO APSV                 */ 00159000
         LR    APSVPTR,R1P                                      02S0219 00160000
*     RFY                                                       02S0220 00161000
*       R1P UNRSTD;                 /* FINISHED WITH REGISTER        */ 00162000
*     RFY                                                       02S0221 00163000
*       APDATA RSTD;                /* ESTABLISH DYNAMIC AREA        */ 00164000
*     APDATA=ADDR(APSV)+APSVLN;     /* BASE. TELL ASSEMBLER TOO.     */ 00165000
         LA    APDATA,80(,APSVPTR)                              02S0222 00166000
*     GEN(USING @DATD,APDATA)                                   02S0223 00167000
*     NOSETS REFS(APDATA);          /* IS AFTER SAVEAREA             */ 00168000
*                                                               02S0223 00169000
         USING @DATD,APDATA                                             00170000
*     /***************************************************************/ 00171000
*     /*                                                             */ 00172000
*     /* SAVE REGISTER POINTERS IN WORKAREA. THIS ALLOWS FOR PL/S    */ 00173000
*     /* REGISTER OPTIMIZATION.                                      */ 00174000
*     /*                                                             */ 00175000
*     /***************************************************************/ 00176000
*                                                               02S0224 00177000
*     DAPRLPTR=RAPRLPTR;            /* ADDRESS OF INPUT APRL         */ 00178000
         ST    RAPRLPTR,DAPRLPTR                                02S0224 00179000
*     DDEBPTR=RDEBPTR;              /* ADDRESS OF ASSOCIATED DEB     */ 00180000
         LR    DDEBPTR,RDEBPTR                                  02S0225 00181000
*     DAPDXPTR=RAPDXPTR;            /* ADDRESS OF APDX FOR DEB       */ 00182000
         ST    RAPDXPTR,DAPDXPTR                                02S0226 00183000
*     RFY                                                       02S0227 00184000
*       APRL BASED(DAPRLPTR);       /* TELL COMPILER OF              */ 00185000
*     RFY                                                       02S0228 00186000
*       DEBBASIC BASED(DDEBPTR);    /* THESE POINTERS                */ 00187000
*     RFY                                                       02S0229 00188000
*       APDX BASED(DAPDXPTR);       /* FOR LATER USE.                */ 00189000
*     DUSERKEY=DEBPROTG;            /* SAVE USER PROTECT KEY (THIS IS   00190000
*                                      KEY OF OPEN REQUESTOR).       */ 00191000
         MVC   DUSERKEY(1),DEBPROTG(DDEBPTR)                    02S0230 00192000
*     RFY                                                       02S0231 00193000
*      (RDEBPTR,                                                02S0231 00194000
*       RAPDXPTR,                                               02S0231 00195000
*       RAPRLPTR) UNRSTD;           /* VALUES NOW SAVED              */ 00196000
*   END;                            /* END OF CODE SEGMENT           */ 00197000
         EJECT                                                          00198000
*                                                               01S0233 00199000
*   /*****************************************************************/ 00200000
*   /*                                                               */ 00201000
*   /* INITIALIZE THE RECOVERY AREA AND ISSUE AN ESTAE TO COVER THIS */ 00202000
*   /* PROGRAM'S PROCESSING.                                         */ 00203000
*   /*                                                               */ 00204000
*   /*****************************************************************/ 00205000
*                                                               01S0233 00206000
*   DO;                             /* START OF CODE SEGMENT         */ 00207000
*                                                               02S0233 00208000
*     /***************************************************************/ 00209000
*     /*                                                             */ 00210000
*     /* ESTABLISH RECOVERY ENVIRONMENT. THIS EXIT WILL GAIN CONTROL */ 00211000
*     /* IF AN ABEND OCCURS. A DUMP IS TAKEN, THE APPROPRIATE ERROR  */ 00212000
*     /* FLAGS SET, AND CONTROL PASSED TO THE CLEANUP ROUTINE TO     */ 00213000
*     /* RELEASE RESOURCES BEFORE RETURNING TO THE CALLER.           */ 00214000
*     /*                                                             */ 00215000
*     /***************************************************************/ 00216000
*                                                               02S0234 00217000
*                                                               02S0234 00218000
*     /***************************************************************/ 00219000
*     /*                                                             */ 00220000
*     /* BUILD ESTAE/FRR EXIT PARAMETER LIST                         */ 00221000
*     /*                                                             */ 00222000
*     /***************************************************************/ 00223000
*                                                               02S0234 00224000
*     DRCSWS=DRCSWS&&DRCSWS;        /* CLEAR RECOVERY SWITCHES       */ 00225000
         XC    DRCSWS(2),DRCSWS                                 02S0234 00226000
*     GEN(MVC   DXSTAE,CXSTAE)                                  02S0235 00227000
*     REFS(CXSTAE) SETS(DXSTAE);    /* INITIALIZE ESTAE PARM LIST    */ 00228000
         MVC   DXSTAE,CXSTAE                                            00229000
*     RFY                                                       02S0236 00230000
*      (R0P,                                                    02S0236 00231000
*       R1F,                                                    02S0236 00232000
*       R14P,                                                   02S0236 00233000
*       R15F) RSTD;                 /* INITIALIZE APES BLOCK         */ 00234000
*     R0P=ADDR(APES);               /* TO ZEROS                      */ 00235000
         LA    R0P,APES                                         02S0237 00236000
*     R1F=LENGTH(APES);             /* USE MVCL TO                   */ 00237000
         LA    R1F,648                                          02S0238 00238000
*     R15F=0;                       /* CLEAR, SINCE FIELD            */ 00239000
         SLR   R15F,R15F                                        02S0239 00240000
*     MVCL(R0P,R14P);               /* MORE THAN 256 BYTES LONG      */ 00241000
         MVCL  R0P,R14P                                         02S0240 00242000
*     RFY                                                       02S0241 00243000
*      (R0P,                                                    02S0241 00244000
*       R1F,                                                    02S0241 00245000
*       R14P,                                                   02S0241 00246000
*       R15F) UNRSTD;               /* FINISHED WITH MVCL REGS       */ 00247000
*     APESID=APESIDC;               /* IN-CORE ID                    */ 00248000
         MVC   APESID(4),@CC03810                               02S0242 00249000
*     APESADDR=ADDR(APES);          /* ESTAE PARM VALUE              */ 00250000
         LA    @04,APES                                         02S0243 00251000
         ST    @04,APESADDR                                     02S0243 00252000
*     APESAPMV=ADDR(CMBRXZZZ);      /* MESSAGE INDEX TABLE           */ 00253000
         LA    @04,CMBRXZZZ                                     02S0244 00254000
         ST    @04,APESAPMV                                     02S0244 00255000
*     APESMXCD=CERRN99;             /* MAXIMUM APESCODE VALUE        */ 00256000
         MVI   APESMXCD,X'21'                                   02S0245 00257000
*     APESFDMP=BON;                 /* DUMP ON ERROR                 */ 00258000
*     APESFREC=BON;                 /* RECORD ON LOGREC              */ 00259000
*     APESFSDP=BON;                 /* SDUMP ON ERROR                */ 00260000
         OI    APESFDMP,B'11100000'                             02S0248 00261000
*     APESMOD='IGTKCA  ';           /* MODULE IN CONTROL             */ 00262000
         MVC   APESMOD(8),@CC03972                              02S0249 00263000
*     APESPROC='IGTKCA  ';          /* CSECT IN CONTROL              */ 00264000
         MVC   APESPROC(8),@CC03972                             02S0250 00265000
*     APESFRR='        ';           /* NO FRR ID                     */ 00266000
         MVC   APESFRR(8),@CC03973                              02S0251 00267000
*     APESREGP=ADDR(APESREGZ);      /* DEFAULT REGISTER SAVEAREA     */ 00268000
         LA    @04,APESREGZ                                     02S0252 00269000
         ST    @04,APESREGP                                     02S0252 00270000
*     RFY                                                       02S0253 00271000
*      (R15P) RSTD;                 /* SET REGISTER 15 TO            */ 00272000
*     R15P=ADDR(CANESTAE);          /* BACKOUT ROUTINE               */ 00273000
         LA    R15P,CANESTAE                                    02S0254 00274000
*     STM(R0F,R15F,APESREGZ);       /* SAVE REGISTERS FOR RETRY      */ 00275000
         STM   R0F,R15F,APESREGZ                                02S0255 00276000
*     RFY                                                       02S0256 00277000
*       R15P UNRSTD;                /* FINISHED WITH 15              */ 00278000
*     APESCODE=CERRN99;             /* 'UNKNOWN' ERROR               */ 00279000
         MVI   APESCODE,X'21'                                   02S0257 00280000
*     RFY                                                       02S0258 00281000
*       RIGTUKA RSTD;               /* POINTS TO EXIT ROUTINE        */ 00282000
*     RIGTUKA=ADDR(APCVZUKA);       /* (IGTUKA).                     */ 00283000
         L     RIGTUKA,APCTZUKA(,APCTPTR)                       02S0259 00284000
*     GEN REFS(APESADDR,APSVPTR,DXSTAE,RIGTUKA,FLCCVT,PSA,CVTSV60,      00285000
*         CVTMAP) SETS(DXSTAE);                                 02S0260 00286000
*                                   /*                                  00287000
         IGTYSTAE (RIGTUKA),       IGTUKA IS EXIT ROUTINE              *00288000
               PARAM=APESADDR,     ADDR OF APES IS PARAMETER LIST      *00289000
               BRANCH=YES,         BRANCH ENTRY                        *00290000
               SVEAREA=(APSVPTR),  USE REGISTER 13 SAVEAREA            *00291000
               KEY=5,              CURRENTLY IN KEY-5 - RESET          *00292000
               MF=(E,DXSTAE)       EXECUTE FORM OF THE MACRO            00293000
*     RFY                                                       02S0261 00294000
*      (R15F) RSTD;                 /* ESTAE RETURN CODE             */ 00295000
*     RFY                                                       02S0262 00296000
*       RIGTUKA UNRSTD;             /* DONE WITH EXIT POINTER        */ 00297000
*     IF R15F^=0 THEN               /* IF ESTAE FAILED,              */ 00298000
         LTR   R15F,R15F                                        02S0263 00299000
         BZ    @RF00263                                         02S0263 00300000
*       DO;                         /* THEN                          */ 00301000
*                                                               02S0264 00302000
*         /***********************************************************/ 00303000
*         /*                                                         */ 00304000
*         /* CONVERT THE ERROR CODE (APESCOD1) TO APRL ERROR CODES   */ 00305000
*         /*                                                         */ 00306000
*         /***********************************************************/ 00307000
*                                                               02S0265 00308000
*         APESCOD1=CERRN01;         /* SET ERROR CODE AND            */ 00309000
         MVI   APESCOD1,X'01'                                   02S0265 00310000
*         CALL SETAPRL;             /* CONVERT APESCOD1 TO APRL CODES*/ 00311000
         BAL   @14,SETAPRL                                      02S0266 00312000
*         SPKA(DUSERKEY);           /* SWITCH TO USER'S KEY          */ 00313000
         SLR   @14,@14                                          02S0267 00314000
         IC    @14,DUSERKEY                                     02S0267 00315000
         SPKA  0(@14)                                           02S0267 00316000
*         DAPRLPTR->APRLRCT=ADDR(DAPRL)->APRLRCT;/* MOVE VALUES      */ 00317000
         L     @14,DAPRLPTR                                     02S0268 00318000
         LA    @09,DAPRL                                        02S0268 00319000
         IC    @04,APRLRCT(,@09)                                02S0268 00320000
         STC   @04,APRLRCT(,@14)                                02S0268 00321000
*         DAPRLPTR->APRLRCC=ADDR(DAPRL)->APRLRCC;/* FROM PROTECTED   */ 00322000
         IC    @04,APRLRCC(,@09)                                02S0269 00323000
         STC   @04,APRLRCC(,@14)                                02S0269 00324000
*         DAPRLPTR->APRLRCN=ADDR(DAPRL)->APRLRCN;/* APRL (DAPRL)     */ 00325000
         IC    @04,APRLRCN(,@09)                                02S0270 00326000
         STC   @04,APRLRCN(,@14)                                02S0270 00327000
*         DAPRLPTR->APRLMSGN=ADDR(DAPRL)->APRLMSGN;/* TO USER APRL   */ 00328000
         LH    @04,APRLMSGN(,@09)                               02S0271 00329000
         STH   @04,APRLMSGN(,@14)                               02S0271 00330000
*         DAPRLPTR->APRLVALN=ADDR(DAPRL)->APRLVALN;/* MUST RUN IN    */ 00331000
         LH    @09,APRLVALN(,@09)                               02S0272 00332000
         STH   @09,APRLVALN(,@14)                               02S0272 00333000
*         GEN(MODESET EXTKEY=DATAMGT)                           02S0273 00334000
*         NOREFS NOSETS;            /* USER KEY.                     */ 00335000
         MODESET EXTKEY=DATAMGT                                         00336000
*         GOTO EXIT;                /* GO TO PROGRAM EXIT LOGIC      */ 00337000
         B     EXIT                                             02S0274 00338000
*       END;                        /* ERROR PROCESSED               */ 00339000
*     RFY                                                       02S0276 00340000
*       R15F UNRSTD;                /* ESTAE RETURN CODE PROCESSED   */ 00341000
@RF00263 DS    0H                                               02S0277 00342000
*   END;                            /* ESTAE ENVIRONMENT SET         */ 00343000
         EJECT                                                          00344000
*                                                               01S0278 00345000
*   /*****************************************************************/ 00346000
*   /*                                                               */ 00347000
*   /* COPY THE REQUIRED PORTIONS OF THE USER'S APRL TO A PROTECTED  */ 00348000
*   /* AREA.                                                         */ 00349000
*   /*                                                               */ 00350000
*   /*****************************************************************/ 00351000
*                                                               01S0278 00352000
*   DO;                                                         02S0278 00353000
*                                                               02S0278 00354000
*     /***************************************************************/ 00355000
*     /*                                                             */ 00356000
*     /* COPY THE USER'S APRL TO A PROTECTED COPY. THIS ALLOWS       */ 00357000
*     /* REFERENCE TO A STABLE COPY AND ELIMINATES HAVING TO SWITCH  */ 00358000
*     /* PROTECT KEYS TO REFERENCE THE APRL. ONLY THOSE FIELDS       */ 00359000
*     /* REQUIRED FOR PROCESSING ARE COPIED. IF AN ERROR OCCURS      */ 00360000
*     /* REFERENCING THE APRL, THE ESTAE WILL INTERCEPT THE FAILURE. */ 00361000
*     /* AN ERROR CODE WILL BE RETURNED TO THE CALLER INDICATING THE */ 00362000
*     /* FAILURE. THEN MERGE THE VALUES SPECIFIED IN THE APDS INTO   */ 00363000
*     /* THE APRL.                                                   */ 00364000
*     /*                                                             */ 00365000
*     /***************************************************************/ 00366000
*                                                               02S0279 00367000
*     DAPRL=DAPRL&&DAPRL;           /* CLEAR INTERNAL APRL AREA      */ 00368000
         XC    DAPRL(80),DAPRL                                  02S0279 00369000
*     APESCODE=CERRN02;             /* ERROR CODE - BAD APRL         */ 00370000
         MVI   APESCODE,X'02'                                   02S0280 00371000
*     APESFSDP=BOFF;                /* NO SDUMP ON ERROR             */ 00372000
         NI    APESFSDP,B'11011111'                             02S0281 00373000
*     SPKA(DUSERKEY);               /* SWITCH TO USER'S KEY          */ 00374000
         SLR   @04,@04                                          02S0282 00375000
         IC    @04,DUSERKEY                                     02S0282 00376000
         SPKA  0(@04)                                           02S0282 00377000
*     RFY                                                       02S0283 00378000
*      (R0F,                                                    02S0283 00379000
*       R1F,                                                    02S0283 00380000
*       R14F,                                                   02S0283 00381000
*       R15F) RSTD;                 /* COPY REGISTERS                */ 00382000
*     R0F=DAPRLPTR->APRLOPTS;       /* HOLD OPTION SWITCHES          */ 00383000
         L     @04,DAPRLPTR                                     02S0284 00384000
         L     R0F,APRLOPTS(,@04)                               02S0284 00385000
*     R1F=DAPRLPTR->APRLOPTZ;       /* HOLD OPTION SWITCHES          */ 00386000
         L     R1F,APRLOPTZ(,@04)                               02S0285 00387000
*     R14F=DAPRLPTR->APRLCCW;       /* ADDR USER'S CHANNEL PGM       */ 00388000
         L     R14F,APRLCCW(,@04)                               02S0286 00389000
*     R15F=DAPRLPTR->APRLUSER;      /* INSTALLATION FIELD            */ 00390000
         L     R15F,APRLUSER(,@04)                              02S0287 00391000
*     GEN(MODESET EXTKEY=DATAMGT)                               02S0288 00392000
*     NOREFS NOSETS;                /* RESUME NORMAL KEY             */ 00393000
         MODESET EXTKEY=DATAMGT                                         00394000
*     APESCODE=CERRN99;             /* IS VPSS FAULT.                */ 00395000
         MVI   APESCODE,X'21'                                   02S0289 00396000
*     APESFSDP=BON;                 /* SDUMP WANTED AGAIN            */ 00397000
         OI    APESFSDP,B'00100000'                             02S0290 00398000
*     DAPRLXPT=ADDR(DAPRL);         /* INITIALIZE POINTER TO COPY    */ 00399000
         LA    @04,DAPRL                                        02S0291 00400000
         ST    @04,DAPRLXPT                                     02S0291 00401000
*     RFY                                                       02S0292 00402000
*       APRL BASED(DAPRLXPT);       /* OF APRL.              @ZA26916*/ 00403000
*     APRLOPTS=R0F;                 /* SAVE OPTION SWITCHES          */ 00404000
         ST    R0F,APRLOPTS(,@04)                               02S0293 00405000
*     APRLOPTZ=R1F;                 /* SAVE OPTION SWITCHES          */ 00406000
         ST    R1F,APRLOPTZ(,@04)                               02S0294 00407000
*     APRLCCW=R14F;                 /* SAVE USER'S CHANNEL PGM ADDR  */ 00408000
         ST    R14F,APRLCCW(,@04)                               02S0295 00409000
*     APRLUSER=R15F;                /* INSTALLATION FIELD            */ 00410000
         ST    R15F,APRLUSER(,@04)                              02S0296 00411000
*     RFY                                                       02S0297 00412000
*      (R0F,                                                    02S0297 00413000
*       R1F,                                                    02S0297 00414000
*       R14F,                                                   02S0297 00415000
*       R15F) UNRSTD;               /* FINISHED WITH REGISTERS       */ 00416000
*     APRLID=APRLIDC;               /* IN-CORE ID FOR DUMP           */ 00417000
         MVC   APRLID(4,@04),@CC01912                           02S0298 00418000
*     APESRTRY=ADDR(RESTAPRL);      /* ON ERROR, RESTORE USER'S APRL */ 00419000
         LA    @15,RESTAPRL                                     02S0299 00420000
         L     @14,APESREGP                                     02S0299 00421000
         ST    @15,APESRTRY(,@14)                               02S0299 00422000
*     IF APRLXIO=BON THEN           /* IF APRL INDICATES THAT        */ 00423000
         TM    APRLXIO(@04),B'00000100'                         02S0300 00424000
         BNO   @RF00300                                         02S0300 00425000
*       DO;                         /* APIO ALREADY EXISTS, IS ERROR */ 00426000
*         APESCODE=CERRN26;         /* SET ERROR CODE                */ 00427000
         MVI   APESCODE,X'1A'                                   02S0302 00428000
*         APESFSDP=BOFF;            /* SDUMP NOT WANTED              */ 00429000
         NI    APESFSDP,B'11011111'                             02S0303 00430000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       00431000
*                                      PASS CONTROL TO THE (E)STAE OR   00432000
*                                      FRR EXIT ROUTINE.             */ 00433000
*           DO;                     /* ABEND(APCTABND)               */ 00434000
*             RESPECIFY                                         02S0306 00435000
*              (GPR01F) RESTRICTED;                             02S0306 00436000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 00437000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0307 00438000
*             SVC(13);              /* ISSUE ABEND SVC               */ 00439000
         SVC   13                                               02S0308 00440000
*             RESPECIFY                                         02S0309 00441000
*              (GPR01F) UNRESTRICTED;                           02S0309 00442000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 00443000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S0311 00444000
*                                                  /* NO CODE           00445000
*         END;                      /* ABEND ISSUED                  */ 00446000
*       END;                        /* ERROR CONDITION PROCESSED     */ 00447000
*                                                               02S0313 00448000
*     /***************************************************************/ 00449000
*     /*                                                             */ 00450000
*     /* MERGE APDS VALUES INTO THE APRL                             */ 00451000
*     /*                                                             */ 00452000
*     /***************************************************************/ 00453000
*                                                               02S0314 00454000
*     IF APDSPGFX=APDSPGFY THEN     /* IF PAGES TO BE FIXED AT XLTE  */ 00455000
@RF00300 L     @04,DAPDXPTR                                     02S0314 00456000
         L     @04,APDXAPDS(,@04)                               02S0314 00457000
         CLI   APDSPGFX(@04),2                                  02S0314 00458000
         BNE   @RF00314                                         02S0314 00459000
*       APRLPGFX=BOFF;              /* INDICATE IN APRL COPY.        */ 00460000
         L     @04,DAPRLXPT                                     02S0315 00461000
         NI    APRLPGFX(@04),B'11111110'                        02S0315 00462000
*     ELSE                          /* OTHERWISE --                  */ 00463000
*       IF APDSPGFX=APDSPGFN THEN   /* IF PAGES NOT TO BE FIXED AT   */ 00464000
         B     @RC00314                                         02S0316 00465000
@RF00314 L     @04,DAPDXPTR                                     02S0316 00466000
         L     @04,APDXAPDS(,@04)                               02S0316 00467000
         CLI   APDSPGFX(@04),1                                  02S0316 00468000
         BNE   @RF00316                                         02S0316 00469000
*         APRLPGFX=BON;             /* XLTE, INDICATE IN APRL COPY.  */ 00470000
         L     @04,DAPRLXPT                                     02S0317 00471000
         OI    APRLPGFX(@04),B'00000001'                        02S0317 00472000
*       ELSE                                                    02S0318 00473000
*         ;                         /* OTHERWISE -- KEEP APRL VALUE. */ 00474000
@RF00316 DS    0H                                               02S0319 00475000
*     IF APRLRXLT=BON THEN          /* IF CHANNEL PGM TO BE  @ZA26916*/ 00476000
@RC00314 L     @04,DAPRLXPT                                     02S0319 00477000
         TM    APRLRXLT(@04),B'00000100'                        02S0319 00478000
         BNO   @RF00319                                         02S0319 00479000
*       APRLPGFX=BON;               /* RE-TRANSLATED EACH I/O, MUST     00480000
*                                      PAGE FIX AT EXECUTION.        */ 00481000
         OI    APRLPGFX(@04),B'00000001'                        02S0320 00482000
*     IF APDSDUMP=APDSDMPY THEN     /* IF DUMP OF USER ERRORS WANTED */ 00483000
@RF00319 L     @04,DAPDXPTR                                     02S0321 00484000
         L     @04,APDXAPDS(,@04)                               02S0321 00485000
         CLI   APDSDUMP(@04),2                                  02S0321 00486000
         BNE   @RF00321                                         02S0321 00487000
*       APRLDUMP=BON;               /* SHOW DUMP TO BE TAKEN.        */ 00488000
         L     @04,DAPRLXPT                                     02S0322 00489000
         OI    APRLDUMP(@04),B'00000010'                        02S0322 00490000
*     ELSE                          /* OTHERWISE --                  */ 00491000
*       IF APDSDUMP=APDSDMPN THEN   /* IF DUMP OF USER ERRORS NOT    */ 00492000
         B     @RC00321                                         02S0323 00493000
@RF00321 L     @04,DAPDXPTR                                     02S0323 00494000
         L     @04,APDXAPDS(,@04)                               02S0323 00495000
         CLI   APDSDUMP(@04),1                                  02S0323 00496000
         BNE   @RF00323                                         02S0323 00497000
*         APRLDUMP=BOFF;            /* WANTED, INDICATE IN APRL.     */ 00498000
         L     @04,DAPRLXPT                                     02S0324 00499000
         NI    APRLDUMP(@04),B'11111101'                        02S0324 00500000
*       ELSE                                                    02S0325 00501000
*         ;                         /* OTHERWISE -- KEEP APRL VALUE. */ 00502000
@RF00323 DS    0H                                               02S0326 00503000
*   END;                            /* APRL COPIED                   */ 00504000
@RC00321 DS    0H                                               02S0327 00505000
         EJECT                                                          00506000
*                                                               01S0327 00507000
*   /*****************************************************************/ 00508000
*   /*                                                               */ 00509000
*   /* BUILD A TEMPORARY APIO (INCLUDES IOSB AND SRB).               */ 00510000
*   /*                                                               */ 00511000
*   /*****************************************************************/ 00512000
*                                                               01S0327 00513000
*   DO;                             /* START OF CODE SEGMENT         */ 00514000
*                                                               02S0327 00515000
*     /***************************************************************/ 00516000
*     /*                                                             */ 00517000
*     /* BUILD A TEMPORARY APIO (INCLUDING IOSB AND SRB) IN WORKING  */ 00518000
*     /* STORAGE. THIS APIO WILL LATER BE MOVED INTO THE REAL APIO.  */ 00519000
*     /* THIS HAS TWO BENEFITS: (1) ALLOWS ROUTINES TO ACT LIKE THE  */ 00520000
*     /* REAL APIO EXISTS, (2) THIS REFRESHING OF THE REAL APIO      */ 00521000
*     /* MINIMIZES THE EFFECT OF AN OVERLAID APIO IN CSA (ONLY THE   */ 00522000
*     /* CURRENT USER WOULD BE FAILED, NOT ALL USER'S OF THE APIO).  */ 00523000
*     /*                                                             */ 00524000
*     /***************************************************************/ 00525000
*                                                               02S0328 00526000
*     RFY                                                       02S0328 00527000
*       RAPIOPTR RSTD;              /* USE REGISTER BASE FOR         */ 00528000
*     RAPIOPTR=ADDR(DAPIO);         /* OPTIMIZATION. BUILD IN        */ 00529000
         LA    RAPIOPTR,DAPIO                                   02S0329 00530000
*     RFY                                                       02S0330 00531000
*       APIO BASED(RAPIOPTR);       /* PL/S WORKAREA.                */ 00532000
*     RFY                                                       02S0331 00533000
*      (R0P,                                                    02S0331 00534000
*       R14P,                                                   02S0331 00535000
*       R1F,                                                    02S0331 00536000
*       R15F) RSTD;                 /* MVCL REGISTERS                */ 00537000
*     R0P=ADDR(APIO);               /* START OF AREA TO CLEAR        */ 00538000
         LR    R0P,RAPIOPTR                                     02S0332 00539000
*     R1F=APIOLN;                   /* LENGTH OF APIO                */ 00540000
         LA    R1F,424                                          02S0333 00541000
*     R15F=0;                       /* MOVE NOTHING. INITIALIZE TO 0 */ 00542000
         SLR   R15F,R15F                                        02S0334 00543000
*     MVCL(R0P,R14P);               /* INITIALIZE APIO TO ZEROS.     */ 00544000
         MVCL  R0P,R14P                                         02S0335 00545000
*     RFY                                                       02S0336 00546000
*      (R0P,                                                    02S0336 00547000
*       R14P,                                                   02S0336 00548000
*       R1F,                                                    02S0336 00549000
*       R15F) UNRSTD;               /* DONE WITH MVCL REGISTERS      */ 00550000
*                                                               02S0336 00551000
*     /***************************************************************/ 00552000
*     /*                                                             */ 00553000
*     /* INITIALIZE IOSB (1ST PART OF APIO).                         */ 00554000
*     /*                                                             */ 00555000
*     /***************************************************************/ 00556000
*                                                               02S0337 00557000
*     IOSCCHN=BON;                  /* COMMAND CHAINING USED         */ 00558000
         OI    IOSCCHN(RAPIOPTR),B'01000000'                    02S0337 00559000
*     IOSDVRID=IOSVPSID;            /* VPSS DRIVER ID                */ 00560000
         MVI   IOSDVRID(RAPIOPTR),X'0B'                         02S0338 00561000
*     IOSASID=ASCBASID;             /* ADDR SPACE IS TO SCHEDULE AT     00562000
*                                      I/O COMPLETION (OURS).        */ 00563000
         L     @04,ASCBPTR                                      02S0339 00564000
         MVC   IOSASID(2,RAPIOPTR),ASCBASID(@04)                02S0339 00565000
*     IOSPGAD=ADDR(APCVZKBC);       /* I/O TERMINATION ROUTINE  02S0340 00566000
*                                      (IGTKBC). ISSUES POST/RESUME. */ 00567000
         L     @04,APCTZKBC(,APCTPTR)                           02S0340 00568000
         ST    @04,IOSPGAD(,RAPIOPTR)                           02S0340 00569000
*     IOSPKEY='00'X;                /* TERMINATION ROUTINE EXECUTES     00570000
*                                      KEY 0.                        */ 00571000
         MVI   IOSPKEY(RAPIOPTR),X'00'                          02S0341 00572000
*     IOSDEP=BON;                   /* POST AT DEVICE END - NOT 02S0342 00573000
*                                      CHANNEL END.                  */ 00574000
*     IOSPSLL=BON;                  /* LOCAL LOCK NOT REQUIRED FOR      00575000
*                                      POST STATUS PROCESSING.       */ 00576000
*     IOSTSLL=BON;                  /* LOCAL LOCK NOT REQUIRED FOR      00577000
*                                      I/O TERMINATION (IGTKBC) 02S0344 00578000
*                                      PROCESSING.                   */ 00579000
         OI    IOSDEP(RAPIOPTR),B'01010100'                     02S0344 00580000
*     IOSSRB=ADDR(SRB);             /* SRB BACK POINTER. NOTE: THIS     00581000
*                                      IS TEMPORARY SRB.             */ 00582000
         LA    @04,128                                          02S0345 00583000
         ALR   @04,RAPIOPTR                                     02S0345 00584000
         ST    @04,IOSSRB(,RAPIOPTR)                            02S0345 00585000
*     IOSNRM=APCTZKBE;              /* NORMAL END APPENDAGE          */ 00586000
         L     @04,APCTZKBE(,APCTPTR)                           02S0346 00587000
         ST    @04,IOSNRM(,RAPIOPTR)                            02S0346 00588000
*     IOSABN=APCTZKBD;              /* ABNORMAL END APPENDAGE        */ 00589000
         L     @04,APCTZKBD(,APCTPTR)                           02S0347 00590000
         ST    @04,IOSABN(,RAPIOPTR)                            02S0347 00591000
*     IOSDIE=ADDR(APCVZKBB);        /* DISABLED INTERRUPT EXIT  02S0348 00592000
*                                      (IGTKBB). THIS ROUTINE IS USED   00593000
*                                      TO BYPASS THE IOS POST STATUS    00594000
*                                      PROCESSING BY SCHEDULING THE     00595000
*                                      TERMINATION ROUTINE DIRECTLY. */ 00596000
         L     @04,APCTZKBB(,APCTPTR)                           02S0348 00597000
         ST    @04,IOSDIE(,RAPIOPTR)                            02S0348 00598000
*     IOSNOTRS=BON;                 /* DIE DOES NOT REFERENCE USER'S    00599000
*                                      PRIVATE AREA (CSA ONLY). 02S0349 00600000
*                                      THEREFORE IOS DOES NOT HAVE TO   00601000
*                                      TRAS BEFORE CALLING DIE (CACHE   00602000
*                                      HIT IMPROVEMENT).             */ 00603000
         OI    IOSNOTRS(RAPIOPTR),B'00100000'                   02S0349 00604000
*     IOSDSID=ADDR(DEBBASIC);       /* PURGE ID IS DEB ADDRESS       */ 00605000
         ST    DDEBPTR,IOSDSID(,RAPIOPTR)                       02S0350 00606000
*     IOSCKEY=DUSERKEY&'F0'X;       /* CHANNEL PGM PROTECT KEY IS THE   00607000
*                                      USER'S PROTECT KEY. ONLY BITS    00608000
*                                      0-3 USED. 4-7 MUST BE ZERO.   */ 00609000
         MVC   IOSCKEY(1,RAPIOPTR),DUSERKEY                     02S0351 00610000
         NI    IOSCKEY(RAPIOPTR),X'F0'                          02S0351 00611000
*     IF APDSOWN=BON THEN           /* IF THIS IS EXCLUSIVE USER,    */ 00612000
         L     @04,DAPDXPTR                                     02S0352 00613000
         L     @04,APDXAPDS(,@04)                               02S0352 00614000
         TM    APDSOWN(@04),B'10000000'                         02S0352 00615000
         BNO   @RF00352                                         02S0352 00616000
*       IOSUCB=APDSAPUB->APUBUCB;   /* THEN UCB ADDRESS KNOWN.       */ 00617000
*                                                               02S0353 00618000
         L     @04,APDSAPUB(,@04)                               02S0353 00619000
         L     @04,APUBUCB(,@04)                                02S0353 00620000
         ST    @04,IOSUCB(,RAPIOPTR)                            02S0353 00621000
*     /***************************************************************/ 00622000
*     /*                                                             */ 00623000
*     /* INITIALIZE SRB (2ND PART OF APIO)                           */ 00624000
*     /*                                                             */ 00625000
*     /***************************************************************/ 00626000
*                                                               02S0354 00627000
*     SRBID='SRB ';                 /* IN-CORE ID                    */ 00628000
@RF00352 LA    @04,128                                          02S0354 00629000
         ALR   @04,RAPIOPTR                                     02S0354 00630000
         MVC   SRBID(4,@04),@CC03986                            02S0354 00631000
*     SRBASCB=ADDR(ASCB);           /* ADDR SPACE TO SCHEDULE (OURS).*/ 00632000
         L     @02,ASCBPTR                                      02S0355 00633000
         ST    @02,SRBASCB(,@04)                                02S0355 00634000
*     SRBCPAFF=ASCBAFFN;            /* CPU AFFINITY MASK (SAME AS       00635000
*                                      USER'S).                      */ 00636000
         MVC   SRBCPAFF(2,@04),ASCBAFFN(@02)                    02S0356 00637000
*     SRBPASID=ASCBASID;            /* PURGEDQ ASID (OURS)           */ 00638000
         LH    @02,ASCBASID(,@02)                               02S0357 00639000
         N     @02,@CF04247                                     02S0357 00640000
         STH   @02,SRBPASID(,@04)                               02S0357 00641000
*     SRBPTCB=DEBTCBB;              /* PURGEDQ TCB IS TCB WHICH 02S0358 00642000
*                                      OPEN'ED THE ACB.              */ 00643000
         L     @02,DEBTCBB-1(,DDEBPTR)                          02S0358 00644000
         LA    @02,0(,@02)                                      02S0358 00645000
         ST    @02,SRBPTCB(,@04)                                02S0358 00646000
*     SRBEP=ADDR(APCVZKBC);         /* SRB SCHEDULED TO VPSS I/O        00647000
*                                      TERMINATION ROUTINE (IGTKBC). */ 00648000
         L     @02,APCTZKBC(,APCTPTR)                           02S0359 00649000
         ST    @02,SRBEP(,@04)                                  02S0359 00650000
*     SRBRMTR=IOCPRGID;             /* PURGEDQ TERMINATION ROUTINE   */ 00651000
         L     @02,CVTPTR                                       02S0360 00652000
         L     @02,IOCOMPTR(,@02)                               02S0360 00653000
         L     @02,IOCPRGID(,@02)                               02S0360 00654000
         ST    @02,SRBRMTR(,@04)                                02S0360 00655000
*     SRBPARM=ADDR(IOSB);           /* REGISTER 1 INPUT TO IGTKBC IS    00656000
*                                      THE ADDR OF THE ASSOCIATED       00657000
*                                      IOSB. THIS MAKES DIE SCHEDULED   00658000
*                                      SRB APPEAR AS CALL FROM POST     00659000
*                                      STATUS TO THE TERMINATION        00660000
*                                      ROUTINE.                      */ 00661000
         ST    RAPIOPTR,SRBPARM(,@04)                           02S0361 00662000
*     SRBPKF='00'X;                 /* IGTKBC ENTERED IN KEY-0       */ 00663000
*                                                               02S0362 00664000
         MVI   SRBPKF(@04),X'00'                                02S0362 00665000
*     /***************************************************************/ 00666000
*     /*                                                             */ 00667000
*     /* BUILD REST OF APIO                                          */ 00668000
*     /*                                                             */ 00669000
*     /***************************************************************/ 00670000
*                                                               02S0363 00671000
*     APIOID=APIOIDC;               /* IN-CORE ID                    */ 00672000
         MVC   APIOID(4,RAPIOPTR),@CC03144                      02S0363 00673000
*     APIOSIZE=LENGTH(APIO);        /* LENGTH OF THE APIO            */ 00674000
         MVC   APIOSIZE(2,RAPIOPTR),@CH03134                    02S0364 00675000
*     APIOAPCT=ADDR(APCT);          /* SAVE APCT ADDRESS             */ 00676000
         ST    APCTPTR,APIOAPCT(,RAPIOPTR)                      02S0365 00677000
*     DO;                           /* START OF CODE                 */ 00678000
*                                                               03S0366 00679000
*       /*************************************************************/ 00680000
*       /*                                                           */ 00681000
*       /* IDENTIFY THE APIO USING A "1-UP" NUMBER FROM THE APCT     */ 00682000
*       /* (APCTCSCT). MUST USE COMPARE-AND-SWAP TO INSURE           */ 00683000
*       /* UNIQUENESS. ONLY THE LOW ORDER TWO BYTES OF THE COUNTER   */ 00684000
*       /* ARE USED.                                                 */ 00685000
*       /*                                                           */ 00686000
*       /*************************************************************/ 00687000
*                                                               03S0367 00688000
*       RFY                                                     03S0367 00689000
*        (R0F,                                                  03S0367 00690000
*         R1F) RSTD;                /* CS REGISTERS                  */ 00691000
*       R0F=APCTCSCT;               /* CURRENT COUNT                 */ 00692000
         L     R0F,APCTCSCT(,APCTPTR)                           03S0368 00693000
*IDAPIOCS:                          /* COMPARE-AND-SWAP RETRY POINT  */ 00694000
*       R1F=R0F+1;                  /* INCREMENT COUNT               */ 00695000
IDAPIOCS LA    R1F,1                                            03S0369 00696000
         ALR   R1F,R0F                                          03S0369 00697000
*       GEN(MODESET EXTKEY=SCHED)                               03S0370 00698000
*       NOREFS NOSETS;              /* SWITCH TO APCT KEY            */ 00699000
         MODESET EXTKEY=SCHED                                           00700000
*       CS(R0F,R1F,APCTCSCT);       /* TRY TO UPDATE COUNT           */ 00701000
         CS    R0F,@01,APCTCSCT(APCTPTR)                        03S0371 00702000
*       BC(7,IDAPIOCS);             /* IF CS FAILED, RETRY           */ 00703000
         BC    7,IDAPIOCS                                       03S0372 00704000
*       GEN(MODESET EXTKEY=DATAMGT)                             03S0373 00705000
*       NOREFS NOSETS;              /* RESUME NORMAL KEY             */ 00706000
         MODESET EXTKEY=DATAMGT                                         00707000
*       APIONBRX=R1F;               /* SAVE UNIQUE NUMBER IN APIO    */ 00708000
         STH   R1F,APIONBRX(,RAPIOPTR)                          03S0374 00709000
*       RFY                                                     03S0375 00710000
*        (R0F,                                                  03S0375 00711000
*         R1F) UNRSTD;              /* DONE WITH REGISTERS           */ 00712000
*     END;                          /* APIO UNIQUELY IDENTIFIED      */ 00713000
*     APIODEB=ADDR(DEBBASIC);       /* DEB ADDRESS                   */ 00714000
         ST    DDEBPTR,APIODEB(,RAPIOPTR)                       02S0377 00715000
*     APIORGN=APDSREG;              /* REQUIRED 3838 REGION SIZE (1K    00716000
*                                      UNITS).                       */ 00717000
         L     @04,DAPDXPTR                                     02S0378 00718000
         L     @04,APDXAPDS(,@04)                               02S0378 00719000
         L     @02,APDSREG(,@04)                                02S0378 00720000
         ST    @02,APIORGN(,RAPIOPTR)                           02S0378 00721000
*     APIOASCB=PSAAOLD;             /* ASSOCIATED ASCB (CURRENT)     */ 00722000
         L     @02,PSAAOLD                                      02S0379 00723000
         ST    @02,APIOASCB(,RAPIOPTR)                          02S0379 00724000
*     APIOTERM=ADDR(APCVZKBC);      /* TERMINATION ROUTINE           */ 00725000
         L     @02,APCTZKBC(,APCTPTR)                           02S0380 00726000
         ST    @02,APIOTERM(,RAPIOPTR)                          02S0380 00727000
*     APIOECB=ADDR(DAPRLPTR->APRLECB);/* ADDR OF I/O ECB TO POST     */ 00728000
         L     @02,DAPRLPTR                                     02S0381 00729000
         LA    @02,APRLECB(,@02)                                02S0381 00730000
         ST    @02,APIOECB(,RAPIOPTR)                           02S0381 00731000
*     APIOUCCW=APRLCCW;             /* USER'S CHANNEL PGM ADDR       */ 00732000
         L     @02,DAPRLXPT                                     02S0382 00733000
         L     @02,APRLCCW(,@02)                                02S0382 00734000
         ST    @02,APIOUCCW(,RAPIOPTR)                          02S0382 00735000
*     IF APDSOWN=BON THEN           /* IF THIS IS AN EXCLUSIVE USER, */ 00736000
         TM    APDSOWN(@04),B'10000000'                         02S0383 00737000
         BNO   @RF00383                                         02S0383 00738000
*       DO;                         /* SET THE FOLLOWING FIELDS --   */ 00739000
*         APIOAPUB=APDSAPUB;        /* APUB ADDRESS FOR I/O KNOWN    */ 00740000
         L     @04,APDSAPUB(,@04)                               02S0385 00741000
         ST    @04,APIOAPUB(,RAPIOPTR)                          02S0385 00742000
*         APIOEXCL=BON;             /* SHOW EXCLUSIVE REQUESTOR      */ 00743000
         OI    APIOEXCL(RAPIOPTR),B'10000000'                   02S0386 00744000
*       END;                        /* EXCLUSIVE INDICATORS SET      */ 00745000
*     IF APRLPGFX=BOFF THEN         /* IF PAGE FIX AT XLTE WANTED    */ 00746000
@RF00383 L     @04,DAPRLXPT                                     02S0388 00747000
         TM    APRLPGFX(@04),B'00000001'                        02S0388 00748000
         BNZ   @RF00388                                         02S0388 00749000
*       APIOFXED=BON;               /* SHOW PAGES ALREADY FIXED      */ 00750000
         OI    APIOFXED(RAPIOPTR),B'10000000'                   02S0389 00751000
*     IF APRLRXLT=BON THEN          /* COPY RE-TRANSLATE FLAG        */ 00752000
@RF00388 L     @04,DAPRLXPT                                     02S0390 00753000
         TM    APRLRXLT(@04),B'00000100'                        02S0390 00754000
         BNO   @RF00390                                         02S0390 00755000
*       APIORXLT=BON;               /* TO THE APIO.          @ZA26916*/ 00756000
         OI    APIORXLT(RAPIOPTR),B'00010000'                   02S0391 00757000
*     IF APRLDUMP=BON THEN          /* IF DUMP WANTED ON USER ERROR  */ 00758000
@RF00390 L     @04,DAPRLXPT                                     02S0392 00759000
         TM    APRLDUMP(@04),B'00000010'                        02S0392 00760000
         BNO   @RF00392                                         02S0392 00761000
*       APIODUMP=BON;               /* SET SWITCH IN THE APIO.       */ 00762000
*                                                               02S0393 00763000
         OI    APIODUMP(RAPIOPTR),B'00001000'                   02S0393 00764000
*     /***************************************************************/ 00765000
*     /*                                                             */ 00766000
*     /* TEMPORARY APIO INITIALIZED WITH KNOWN DATA.                 */ 00767000
*     /*                                                             */ 00768000
*     /***************************************************************/ 00769000
*                                                               02S0394 00770000
*     RFY                                                       02S0394 00771000
*       APIO BASED(ADDR(DAPIO));    /* TELL COMPILER THAT APIO IS    */ 00772000
@RF00392 DS    0H                                               02S0395 00773000
*     RFY                                                       02S0395 00774000
*       RAPIOPTR UNRSTD;            /* IN PL/S WORKAREA.             */ 00775000
*   END;                            /* END OF CODE SEGMENT           */ 00776000
         EJECT                                                          00777000
*                                                               01S0397 00778000
*   /*****************************************************************/ 00779000
*   /*                                                               */ 00780000
*   /* COPY THE USER'S CHANNEL PROGRAM TO A PROTECTED AREA.          */ 00781000
*   /*                                                               */ 00782000
*   /*****************************************************************/ 00783000
*                                                               01S0397 00784000
*   DO;                                                         02S0397 00785000
*                                                               02S0397 00786000
*     /***************************************************************/ 00787000
*     /*                                                             */ 00788000
*     /* COPY THE USER'S CHANNEL PROGRAM TO A PROTECTED AREA. THE    */ 00789000
*     /* CHANNEL PROGRAM MUST FIT IN ONE PAGE. IF AN ERROR OCCURS    */ 00790000
*     /* REFERENCING THE USER'S CCWS, THE ESTAE WILL INTERCEPT THE   */ 00791000
*     /* FAILURE. AN ERROR CODE WILL BE RETURNED TO THE CALLER       */ 00792000
*     /* INDICATING THE FAILURE.                                     */ 00793000
*     /*                                                             */ 00794000
*     /***************************************************************/ 00795000
*                                                               02S0398 00796000
*     RFY                                                       02S0398 00797000
*       R1P RSTD;                   /* GET CCW HOLD AREA             */ 00798000
*     APESCODE=CERRN20;             /* NO SP-230 STORAGE ERROR       */ 00799000
         MVI   APESCODE,X'14'                                   02S0399 00800000
*     DO;                           /* IGTYGSTK LV(CPGSIZE)          */ 00801000
*       RFY                                                     02S0401 00802000
*         GPR00F RSTD;              /* NEEDED REGISTER               */ 00803000
*       GPR00F=CPGSIZE;             /* SET REG 0 TO REQUIRED LENGTH  */ 00804000
         L     GPR00F,@CF03922                                  02S0402 00805000
*       CALL APCVZUAD;              /* OBTAIN A DYNAMIC AREA         */ 00806000
         L     @15,APCTZUAD(,APCTPTR)                           02S0403 00807000
         BALR  @14,@15                                          02S0403 00808000
*       RFY                                                     02S0404 00809000
*        (GPR00F) UNRSTD;           /* FINISHED WITH REGISTERS       */ 00810000
*     END;                          /* REG_1 -> ACQUIRED DYNAMIC AREA*/ 00811000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 00812000
         MVI   APESCODE,X'21'                                   02S0406 00813000
*     DCCWBEG=R1P+LENGTH(PROCDATA); /* START OF AREA. 1ST ENTRY 02S0407 00814000
*                                      RESERVED FOR PROCESS DATA (1ST   00815000
*                                      CCW DATA).                    */ 00816000
         LA    @04,8                                            02S0407 00817000
         ALR   @04,R1P                                          02S0407 00818000
         ST    @04,DCCWBEG                                      02S0407 00819000
*     DCCWEND=R1P+CPGSIZE;          /* END OF AREA                   */ 00820000
         LR    @00,R1P                                          02S0408 00821000
         AL    @00,@CF03922                                     02S0408 00822000
         ST    @00,DCCWEND                                      02S0408 00823000
*     DCCWCUR=DCCWBEG;              /* CURRENT (NEXT AVAILABLE) SLOT */ 00824000
         LR    DCCWCUR,@04                                      02S0409 00825000
*     RFY                                                       02S0410 00826000
*       R1P UNRSTD;                 /* FINISHED WITH REGISTER        */ 00827000
*     IF(APRLCCW&'00000007'X)^=0 THEN/* IF USER CCW CHAIN NOT        */ 00828000
         L     @04,DAPRLXPT                                     02S0411 00829000
         L     @04,APRLCCW(,@04)                                02S0411 00830000
         N     @04,@CF03994                                     02S0411 00831000
         LTR   @04,@04                                          02S0411 00832000
         BZ    @RF00411                                         02S0411 00833000
*       DO;                         /* ON DOUBLEWORD BNDRY, IS ERROR */ 00834000
*         APESCODE=CERRN14;         /* SET ERROR CODE                */ 00835000
         MVI   APESCODE,X'0E'                                   02S0413 00836000
*         APESFSDP=BOFF;            /* NO SDUMP                      */ 00837000
         NI    APESFSDP,B'11011111'                             02S0414 00838000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       00839000
*                                      PASS CONTROL TO THE (E)STAE OR   00840000
*                                      FRR EXIT ROUTINE.             */ 00841000
*           DO;                     /* ABEND(APCTABND)               */ 00842000
*             RESPECIFY                                         02S0417 00843000
*              (GPR01F) RESTRICTED;                             02S0417 00844000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 00845000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0418 00846000
*             SVC(13);              /* ISSUE ABEND SVC               */ 00847000
         SVC   13                                               02S0419 00848000
*             RESPECIFY                                         02S0420 00849000
*              (GPR01F) UNRESTRICTED;                           02S0420 00850000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 00851000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S0422 00852000
*                                                  /* NO CODE           00853000
*         END;                      /* ABEND ISSUED                  */ 00854000
*       END;                        /* ERROR CONDITION PROCESSED     */ 00855000
*     RFY                                                       02S0425 00856000
*       R14P RSTD;                  /* POINT TO BEGINNING OF         */ 00857000
@RF00411 DS    0H                                               02S0426 00858000
*     R14P=APRLCCW;                 /* USER'S CHANNEL PROGRAM        */ 00859000
         L     @04,DAPRLXPT                                     02S0426 00860000
         L     R14P,APRLCCW(,@04)                               02S0426 00861000
*     RFY                                                       02S0427 00862000
*       R15F RSTD;                  /* HOLD USER'S PROTECT KEY       */ 00863000
*     R15F=DUSERKEY;                /* FOR KEY CHANGE.               */ 00864000
         SLR   R15F,R15F                                        02S0428 00865000
         IC    R15F,DUSERKEY                                    02S0428 00866000
*     DO R14P=R14P BY LENGTH(CCW)   /* SCAN USER'S CCWS UNTIL        */ 00867000
*           WHILE(DCCWCUR<DCCWEND); /* ENTIRE PAGE FILLED.           */ 00868000
         B     @DE00429                                         02S0429 00869000
@DL00429 DS    0H                                               02S0430 00870000
*       APESCODE=CERRN03;           /* REFERENCING USER'S STORAGE.   */ 00871000
         MVI   APESCODE,X'03'                                   02S0430 00872000
*       APESFSDP=BOFF;              /* NO SDUMP ON ERROR             */ 00873000
         NI    APESFSDP,B'11011111'                             02S0431 00874000
*       SPKA(R15F);                 /* USER'S KEY                    */ 00875000
         SPKA  0(R15F)                                          02S0432 00876000
*       RFY                                                     02S0433 00877000
*        (R0F,                                                  02S0433 00878000
*         R1F) RSTD;                /* HOLD DATA REGISTERS           */ 00879000
*       LM(R0F,R1F,R14P->CCW);      /* HOLD USER'S CCW               */ 00880000
         LM    R0F,R1F,CCW(R14P)                                02S0434 00881000
*       GEN(MODESET EXTKEY=DATAMGT)                             02S0435 00882000
*       NOREFS NOSETS;              /* RESUME DATA MANAGEMENT KEY    */ 00883000
         MODESET EXTKEY=DATAMGT                                         00884000
*       APESCODE=CERRN99;           /* ERROR CODE                    */ 00885000
         MVI   APESCODE,X'21'                                   02S0436 00886000
*       APESFSDP=BON;               /* RESUME SDUMP COVERAGE         */ 00887000
         OI    APESFSDP,B'00100000'                             02S0437 00888000
*       STM(R0F,R1F,DCCWCUR->CCW);  /* SAVE CCW IN PROTECTED AREA    */ 00889000
         STM   R0F,R1F,CCW(DCCWCUR)                             02S0438 00890000
*       RFY                                                     02S0439 00891000
*        (R0F,                                                  02S0439 00892000
*         R1F) UNRSTD;              /* FINISHED WITH REGISTERS       */ 00893000
*       IF DCCWCUR->CCWFCC=BOFF&    /* IN NO CHAINING (DATA OR       */ 00894000
*           DCCWCUR->CCWFCD=BOFF THEN/* COMMAND) IS END OF           */ 00895000
         TM    CCWFCC(DCCWCUR),B'11000000'                      02S0440 00896000
         BNZ   @RF00440                                         02S0440 00897000
*         DO;                       /* CHANNEL PROGRAM.              */ 00898000
*           DCCWCUR=DCCWCUR+LENGTH(CCW);/* POINT PAST CCW            */ 00899000
         LA    DCCWCUR,8(,DCCWCUR)                              02S0442 00900000
*           GOTO SAVECCW1;          /* GET OUT OF LOOP               */ 00901000
         B     SAVECCW1                                         02S0443 00902000
*         END;                      /* END OF CHANNEL PGM.           */ 00903000
*       DCCWCUR=DCCWCUR+LENGTH(CCW);/* UPDATE TO NEXT SLOT           */ 00904000
@RF00440 LA    DCCWCUR,8(,DCCWCUR)                              02S0445 00905000
*     END;                          /* CONTINUE SCAN & MOVE          */ 00906000
         LA    R14P,8(,R14P)                                    02S0446 00907000
@DE00429 C     DCCWCUR,DCCWEND                                  02S0446 00908000
         BL    @DL00429                                         02S0446 00909000
*     RFY                                                       02S0447 00910000
*      (R14P,                                                   02S0447 00911000
*       R15F) UNRSTD;               /* FINISHED WITH REGISTERS       */ 00912000
*                                                               02S0447 00913000
*     /***************************************************************/ 00914000
*     /*                                                             */ 00915000
*     /* CHANNEL PROGRAM TOO LONG. SET ERROR INDICATOR AND EXIT      */ 00916000
*     /*                                                             */ 00917000
*     /***************************************************************/ 00918000
*                                                               02S0448 00919000
*     APESCODE=CERRN04;             /* SET ERROR CODE                */ 00920000
         MVI   APESCODE,X'04'                                   02S0448 00921000
*     APESFSDP=BOFF;                /* NO SDUMP                      */ 00922000
         NI    APESFSDP,B'11011111'                             02S0449 00923000
*     DO;                           /* FORCE ABEND TO LOG ERROR &       00924000
*                                      PASS CONTROL TO THE (E)STAE OR   00925000
*                                      FRR EXIT ROUTINE.             */ 00926000
*       DO;                         /* ABEND(APCTABND)               */ 00927000
*         RESPECIFY                                             02S0452 00928000
*          (GPR01F) RESTRICTED;                                 02S0452 00929000
*         GPR01F=APCTABND;          /* COMP CODE IN REG 1            */ 00930000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0453 00931000
*         SVC(13);                  /* ISSUE ABEND SVC               */ 00932000
         SVC   13                                               02S0454 00933000
*         RESPECIFY                                             02S0455 00934000
*          (GPR01F) UNRESTRICTED;                               02S0455 00935000
*       END;                        /* ABEND(APCTABND) FORCE ABEND   */ 00936000
*       GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);            02S0457 00937000
*                                                  /* NO CODE           00938000
*     END;                          /* ABEND ISSUED                  */ 00939000
*                                                               02S0458 00940000
*     /***************************************************************/ 00941000
*     /*                                                             */ 00942000
*     /* CHANNEL PROGRAM COPIED. FREE EXCESS STORAGE.                */ 00943000
*     /*                                                             */ 00944000
*     /***************************************************************/ 00945000
*                                                               02S0459 00946000
*SAVECCW1:                          /* NO CCW CHAINING EXIT          */ 00947000
*     IF DCCWEND-DCCWCUR>0 THEN     /* IF CHANNEL PROGRAM LESS       */ 00948000
SAVECCW1 L     @04,DCCWEND                                      02S0459 00949000
         SLR   @04,DCCWCUR                                      02S0459 00950000
         LTR   @04,@04                                          02S0459 00951000
         BNP   @RF00459                                         02S0459 00952000
*       DO;                         /* THAN MAX, FREE EXCESS.        */ 00953000
*         APESCODE=CERRN16;         /* SHOW FREEMAIN FAILED          */ 00954000
         MVI   APESCODE,X'10'                                   02S0461 00955000
*         DO;                       /* IGTYFSTK                 02S0462 00956000
*                                      LV(DCCWEND-DCCWCUR)A(DCCWCUR) */ 00957000
*           RFY                                                 02S0463 00958000
*             GPR00F RSTD;          /* REG 0 SET TO AREA LENGTH      */ 00959000
*           GPR00F=DCCWEND-DCCWCUR; /* SET REG 0 TO LENGTH OF AREA TO   00960000
*                                      FREE                          */ 00961000
         LR    GPR00F,@04                                       02S0464 00962000
*           CALL APCVZUAE;          /* FREE THE DYNAMIC AREA         */ 00963000
         L     @15,APCTZUAE(,APCTPTR)                           02S0465 00964000
         BALR  @14,@15                                          02S0465 00965000
*           RFY                                                 02S0466 00966000
*             GPR00F UNRSTD;        /* FINISHED WITH REG 0           */ 00967000
*         END;                      /* DYNAMIC AREA FREED STARTING      00968000
*                                      POINT                         */ 00969000
*         APESCODE=CERRN99;         /* RESET ERROR CODE              */ 00970000
         MVI   APESCODE,X'21'                                   02S0468 00971000
*         DCCWEND=DCCWCUR;          /* ADJUST ENDING POINT           */ 00972000
         ST    DCCWCUR,DCCWEND                                  02S0469 00973000
*       END;                        /* EXCESS SPACE FREED            */ 00974000
*     DCCWSZ=DCCWEND-(DCCWBEG-LENGTH(PROCDATA));/* SIZE OF CCW AREA     00975000
*                                      (INCLUDING PROCESS DATA)      */ 00976000
@RF00459 L     @04,DCCWBEG                                      02S0471 00977000
         LA    @15,8                                            02S0471 00978000
         SLR   @15,@04                                          02S0471 00979000
         AL    @15,DCCWEND                                      02S0471 00980000
         ST    @15,DCCWSZ                                       02S0471 00981000
*   END;                            /* USER PGM COPIED.              */ 00982000
         EJECT                                                          00983000
*                                                               01S0473 00984000
*   /*****************************************************************/ 00985000
*   /*                                                               */ 00986000
*   /* VALIDATE CHANNEL PROGRAM.                                     */ 00987000
*   /*                                                               */ 00988000
*   /*****************************************************************/ 00989000
*                                                               01S0473 00990000
*   DO;                             /* START OF CODE SEGMENT         */ 00991000
*                                                               02S0473 00992000
*     /***************************************************************/ 00993000
*     /*                                                             */ 00994000
*     /* VALIDATE THE USER'S CHANNEL PROGRAM. SINCE THE PROGRAM HAS  */ 00995000
*     /* BEEN COPIED TO PROTECTED STORAGE, TIME DEPENDANT            */ 00996000
*     /* MODIFICATION SECURITY PROBLEMS HAVE BEEN ELIMINATED.        */ 00997000
*     /*                                                             */ 00998000
*     /***************************************************************/ 00999000
*                                                               02S0474 01000000
*     DCCWCUR=DCCWBEG;              /* 1ST CCW ADDRESS               */ 01001000
         LR    DCCWCUR,@04                                      02S0474 01002000
*     RFY                                                       02S0475 01003000
*       PROCDATA BASED(ADDR(DPROCDTA));/* TEMPORARY COPY             */ 01004000
*     PROCDATA=PROCDATA&&PROCDATA;  /* CLEAR PROCESS DATA            */ 01005000
         LA    @04,DPROCDTA                                     02S0476 01006000
         XC    PROCDATA(8,@04),PROCDATA(@04)                    02S0476 01007000
*     PROCCNT=-1;                   /* WRITE OF APCI NOT COUNTED     */ 01008000
*                                                               02S0477 01009000
         MVC   PROCCNT(2,@04),@CH04000                          02S0477 01010000
*     /***************************************************************/ 01011000
*     /*                                                             */ 01012000
*     /* SCAN ALL CCWS                                               */ 01013000
*     /*                                                             */ 01014000
*     /***************************************************************/ 01015000
*                                                               02S0478 01016000
*     DO DCCWCUR=DCCWCUR BY LENGTH(CCW)/* LOOP THRU                  */ 01017000
*           WHILE(DCCWCUR<DCCWEND); /* ALL CCWS                      */ 01018000
*                                                               02S0478 01019000
         B     @DE00478                                         02S0478 01020000
@DL00478 DS    0H                                               02S0479 01021000
*       /*************************************************************/ 01022000
*       /*                                                           */ 01023000
*       /* INSURE UNUSED BITS IN CCW OFF.                            */ 01024000
*       /*                                                           */ 01025000
*       /*************************************************************/ 01026000
*                                                               02S0479 01027000
*       IF CCWFSKIP=BON|            /* SUPPRESS I/O TRANSFER         */ 01028000
*           CCWFPCI=BON|            /* PROGRAM CONTROLLED INTERRUPT  */ 01029000
*           CCWFIDA=BON|            /* INDIRECT ADDRESS LIST         */ 01030000
*           CCWFB6=BON|             /* RESERVED                      */ 01031000
*           CCWFB7=BON|             /* RESERVED                      */ 01032000
*           (CCWFSLI=BON&           /* OR SUPPRESS INCORRECT LENGTH  */ 01033000
*           CCWOP^=CPROCOP) THEN    /* (ALLOWED FOR NOP)             */ 01034000
         TM    CCWFSKIP(DCCWCUR),B'00011111'                    02S0479 01035000
         BNZ   @RT00479                                         02S0479 01036000
         TM    CCWFSLI(DCCWCUR),B'00100000'                     02S0479 01037000
         BNO   @RF00479                                         02S0479 01038000
         CLI   CCWOP(DCCWCUR),15                                02S0479 01039000
         BE    @RF00479                                         02S0479 01040000
@RT00479 DS    0H                                               02S0480 01041000
*         DO;                       /* IF ANY ARE ON,                */ 01042000
*           APESFSDP=BOFF;          /* NO SDUMP WANTED,              */ 01043000
         NI    APESFSDP,B'11011111'                             02S0481 01044000
*           APESCODE=CERRN06;       /* SET ERROR FLAG AND            */ 01045000
         MVI   APESCODE,X'06'                                   02S0482 01046000
*           DO;                     /* FORCE ABEND TO LOG ERROR &       01047000
*                                      PASS CONTROL TO THE (E)STAE OR   01048000
*                                      FRR EXIT ROUTINE.             */ 01049000
*             DO;                   /* ABEND(APCTABND)               */ 01050000
*               RESPECIFY                                       02S0485 01051000
*                (GPR01F) RESTRICTED;                           02S0485 01052000
*               GPR01F=APCTABND;    /* COMP CODE IN REG 1            */ 01053000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0486 01054000
*               SVC(13);            /* ISSUE ABEND SVC               */ 01055000
         SVC   13                                               02S0487 01056000
*               RESPECIFY                                       02S0488 01057000
*                (GPR01F) UNRESTRICTED;                         02S0488 01058000
*             END;                  /* ABEND(APCTABND) FORCE ABEND   */ 01059000
*             GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      02S0490 01060000
*                                                  /* NO CODE           01061000
*           END;                    /* ABEND ISSUED                  */ 01062000
*         END;                      /* ERROR PROCESSED               */ 01063000
*                                                               02S0492 01064000
*       /*************************************************************/ 01065000
*       /*                                                           */ 01066000
*       /* VALIDATE OP-CODE. MUST BE READ, WRITE, PROCESS, OR NOP. IF*/ 01067000
*       /* PROCESS, MUST BE THE FIRST COMMAND. IF NOP, MUST BE THE   */ 01068000
*       /* LAST COMMAND. SET FLAG IN DOPTYPE TO INDICATE THE OP-CODE.*/ 01069000
*       /*                                                           */ 01070000
*       /*************************************************************/ 01071000
*                                                               02S0493 01072000
*       DOPTYPE=''X;                /* CLEAR INDICATORS              */ 01073000
@RF00479 MVI   DOPTYPE,X'00'                                    02S0493 01074000
*       IF CCWOP=CREADOP THEN       /* SEE IF READ. IF SO,           */ 01075000
         CLI   CCWOP(DCCWCUR),2                                 02S0494 01076000
         BNE   @RF00494                                         02S0494 01077000
*         DOPREAD=BON;              /* SET FLAG INDICATOR.           */ 01078000
         OI    DOPREAD,B'10000000'                              02S0495 01079000
*       ELSE                        /* OTHERWISE --                  */ 01080000
*         IF CCWOP=CWRITEOP THEN    /* SEE IF WRITE. IF SO,          */ 01081000
         B     @RC00494                                         02S0496 01082000
@RF00494 CLI   CCWOP(DCCWCUR),1                                 02S0496 01083000
         BNE   @RF00496                                         02S0496 01084000
*           DOPWRITE=BON;           /* SET FLAG INDICATOR.           */ 01085000
         OI    DOPWRITE,B'01000000'                             02S0497 01086000
*         ELSE                      /* OTHERWISE --                  */ 01087000
*           IF CCWOP=CPROCOP THEN   /* SEE IF PROCESS. IF SO,        */ 01088000
         B     @RC00496                                         02S0498 01089000
@RF00496 CLI   CCWOP(DCCWCUR),15                                02S0498 01090000
         BNE   @RF00498                                         02S0498 01091000
*             DO;                   /* SET FLAG INDICATOR.           */ 01092000
*               DOPPROC=BON;        /* THEN INSURE THE PROCESS       */ 01093000
         OI    DOPPROC,B'00100000'                              02S0500 01094000
*               IF DCCWCUR^=DCCWBEG THEN/* COMMAND IS FIRST.         */ 01095000
         C     DCCWCUR,DCCWBEG                                  02S0501 01096000
         BE    @RF00501                                         02S0501 01097000
*                 DO;               /* IF NOT, IS ERROR.             */ 01098000
*                   APESCODE=CERRN07;/* SET ERROR FLAG.              */ 01099000
         MVI   APESCODE,X'07'                                   02S0503 01100000
*                   APESFSDP=BOFF;  /* NO SDUMP WANTED               */ 01101000
         NI    APESFSDP,B'11011111'                             02S0504 01102000
*                   DO;             /* FORCE ABEND TO LOG ERROR &       01103000
*                                      PASS CONTROL TO THE (E)STAE OR   01104000
*                                      FRR EXIT ROUTINE.             */ 01105000
*                     DO;           /* ABEND(APCTABND)               */ 01106000
*                       RESPECIFY                               02S0507 01107000
*                        (GPR01F) RESTRICTED;                   02S0507 01108000
*                       GPR01F=APCTABND;/* COMP CODE IN REG 1        */ 01109000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0508 01110000
*                       SVC(13);    /* ISSUE ABEND SVC               */ 01111000
         SVC   13                                               02S0509 01112000
*                       RESPECIFY                               02S0510 01113000
*                        (GPR01F) UNRESTRICTED;                 02S0510 01114000
*                     END;          /* ABEND(APCTABND) FORCE ABEND   */ 01115000
*                     GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      01116000
*                                                  /* NO CODE           01117000
*                   END;            /* ABEND ISSUED                  */ 01118000
*                 END;              /* ERROR PROCESSED.              */ 01119000
*             END;                  /* PROCESS CMD HANDLED.          */ 01120000
*           ELSE                    /* OTHERWISE --                  */ 01121000
*             IF CCWOP=CNOPOP THEN  /* IF NOP COMMAND, THEN          */ 01122000
         B     @RC00498                                         02S0516 01123000
@RF00498 CLI   CCWOP(DCCWCUR),3                                 02S0516 01124000
         BNE   @RF00516                                         02S0516 01125000
*               DO;                 /* SET FLAG INDICATOR.           */ 01126000
*                 DOPNOP=BON;       /* ALSO INSURE NOP IS LAST       */ 01127000
         OI    DOPNOP,B'00010000'                               02S0518 01128000
*                 IF DCCWCUR+LENGTH(CCW)^=DCCWEND THEN/* COMMAND     */ 01129000
         LA    @04,8                                            02S0519 01130000
         ALR   @04,DCCWCUR                                      02S0519 01131000
         C     @04,DCCWEND                                      02S0519 01132000
         BE    @RF00519                                         02S0519 01133000
*                   DO;             /* IN CHAIN. IF NOT, IS ERROR.   */ 01134000
*                     APESCODE=CERRN08;/* SET ERROR INDICATOR        */ 01135000
         MVI   APESCODE,X'08'                                   02S0521 01136000
*                     DO;           /* FORCE ABEND TO LOG ERROR &       01137000
*                                      PASS CONTROL TO THE (E)STAE OR   01138000
*                                      FRR EXIT ROUTINE.             */ 01139000
*                       DO;         /* ABEND(APCTABND)               */ 01140000
*                         RESPECIFY                             02S0524 01141000
*                          (GPR01F) RESTRICTED;                 02S0524 01142000
*                         GPR01F=APCTABND;/* COMP CODE IN REG 1      */ 01143000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0525 01144000
*                         SVC(13);  /* ISSUE ABEND SVC               */ 01145000
         SVC   13                                               02S0526 01146000
*                         RESPECIFY                             02S0527 01147000
*                          (GPR01F) UNRESTRICTED;               02S0527 01148000
*                       END;        /* ABEND(APCTABND) FORCE ABEND   */ 01149000
*                       GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);    01150000
*                                                  /* NO CODE           01151000
*                     END;          /* ABEND ISSUED                  */ 01152000
*                   END;            /* ERROR PROCESSED.              */ 01153000
*               END;                /* NOP PROCESSED.                */ 01154000
*             ELSE                  /* INVALID OP-CODE SPECIFIED     */ 01155000
*               DO;                 /* IN VPSS CHANNEL PROGRAM.      */ 01156000
         B     @RC00516                                         02S0533 01157000
@RF00516 DS    0H                                               02S0534 01158000
*                 APESFSDP=BOFF;    /* SDUMP NOT REQUIRED            */ 01159000
         NI    APESFSDP,B'11011111'                             02S0534 01160000
*                 APESCODE=CERRN19; /* SET ERROR CODE                */ 01161000
         MVI   APESCODE,X'13'                                   02S0535 01162000
*                 DO;               /* FORCE ABEND TO LOG ERROR &       01163000
*                                      PASS CONTROL TO THE (E)STAE OR   01164000
*                                      FRR EXIT ROUTINE.             */ 01165000
*                   DO;             /* ABEND(APCTABND)               */ 01166000
*                     RESPECIFY                                 02S0538 01167000
*                      (GPR01F) RESTRICTED;                     02S0538 01168000
*                     GPR01F=APCTABND;/* COMP CODE IN REG 1          */ 01169000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0539 01170000
*                     SVC(13);      /* ISSUE ABEND SVC               */ 01171000
         SVC   13                                               02S0540 01172000
*                     RESPECIFY                                 02S0541 01173000
*                      (GPR01F) UNRESTRICTED;                   02S0541 01174000
*                   END;            /* ABEND(APCTABND) FORCE ABEND   */ 01175000
*                   GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        01176000
*                                                  /* NO CODE           01177000
*                 END;              /* ABEND ISSUED                  */ 01178000
*               END;                /* ERROR PROCESSED.              */ 01179000
*                                                               02S0545 01180000
*       /*************************************************************/ 01181000
*       /*                                                           */ 01182000
*       /* INSURE DATA-CHAINING AND COMMAND CHAINING BOTH NOT        */ 01183000
*       /* SPECIFIED. ALTHOUGH VALID TO S/370 CHANNELS, VPSS SHOULD  */ 01184000
*       /* NOT BUILD THIS CONDITION. IF DATA CHAINING SPECIFIED,     */ 01185000
*       /* PROPOGATE THE COMMAND CODE TO THE NEXT CCW. THIS OP-CODE  */ 01186000
*       /* IS USED BY THE TRANSLATOR, NOT THE S/370 CHANNEL.         */ 01187000
*       /*                                                           */ 01188000
*       /*************************************************************/ 01189000
*                                                               02S0546 01190000
*       IF CCWFCD=BON THEN          /* IF DATA CHAINING REQUESTED.   */ 01191000
@RC00516 DS    0H                                               02S0546 01192000
@RC00498 DS    0H                                               02S0546 01193000
@RC00496 DS    0H                                               02S0546 01194000
@RC00494 TM    CCWFCD(DCCWCUR),B'10000000'                      02S0546 01195000
         BNO   @RF00546                                         02S0546 01196000
*         DO;                       /* THEN PROPOGATE OP-CODE TO     */ 01197000
*           EVAL(DCCWCUR+LENGTH(CCW))->CCWOP=CCWOP;/* NEXT CCW.      */ 01198000
         LA    @04,8                                            02S0548 01199000
         ALR   @04,DCCWCUR                                      02S0548 01200000
         IC    @15,CCWOP(,DCCWCUR)                              02S0548 01201000
         STC   @15,CCWOP(,@04)                                  02S0548 01202000
*           IOSDCHN=BON;            /* SHOW DATA CHAINING USED       */ 01203000
         LA    @04,DAPIO                                        02S0549 01204000
         OI    IOSDCHN(@04),B'10000000'                         02S0549 01205000
*           IF CCWFCC=BON THEN      /* IF COMMAND CHAINING ALSO      */ 01206000
         TM    CCWFCC(DCCWCUR),B'01000000'                      02S0550 01207000
         BNO   @RF00550                                         02S0550 01208000
*             DO;                   /* REQUESTED, IS ERROR.          */ 01209000
*               APESFSDP=BOFF;      /* SDUMP NOT WANTED              */ 01210000
         NI    APESFSDP,B'11011111'                             02S0552 01211000
*               APESCODE=CERRN09;   /* SET ERROR INDICATOR AND       */ 01212000
         MVI   APESCODE,X'09'                                   02S0553 01213000
*               DO;                 /* FORCE ABEND TO LOG ERROR &       01214000
*                                      PASS CONTROL TO THE (E)STAE OR   01215000
*                                      FRR EXIT ROUTINE.             */ 01216000
*                 DO;               /* ABEND(APCTABND)               */ 01217000
*                   RESPECIFY                                   02S0556 01218000
*                    (GPR01F) RESTRICTED;                       02S0556 01219000
*                   GPR01F=APCTABND;/* COMP CODE IN REG 1            */ 01220000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0557 01221000
*                   SVC(13);        /* ISSUE ABEND SVC               */ 01222000
         SVC   13                                               02S0558 01223000
*                   RESPECIFY                                   02S0559 01224000
*                    (GPR01F) UNRESTRICTED;                     02S0559 01225000
*                 END;              /* ABEND(APCTABND) FORCE ABEND   */ 01226000
*                 GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);  02S0561 01227000
*                                                  /* NO CODE           01228000
*               END;                /* ABEND ISSUED                  */ 01229000
*             END;                  /* ERROR PROCESSED               */ 01230000
*           IF APIORXLT=BON THEN    /* IF RE-TRANSLATION REQUESTED   */ 01231000
@RF00550 LA    @04,DAPIO                                        02S0564 01232000
         TM    APIORXLT(@04),B'00010000'                        02S0564 01233000
         BNO   @RF00564                                         02S0564 01234000
*             DO;                   /* DATA CHAINING NOT ALLOWED.    */ 01235000
*               APESFSDP=BOFF;      /* NO SDUMP              @ZA26916*/ 01236000
         NI    APESFSDP,B'11011111'                             02S0566 01237000
*               APESCODE=CERRN06;   /* ERROR CODE            @ZA26916*/ 01238000
         MVI   APESCODE,X'06'                                   02S0567 01239000
*               DO;                 /* FORCE ABEND TO LOG ERROR &       01240000
*                                      PASS CONTROL TO THE (E)STAE OR   01241000
*                                      FRR EXIT ROUTINE.             */ 01242000
*                 DO;               /* ABEND(APCTABND)               */ 01243000
*                   RESPECIFY                                   02S0570 01244000
*                    (GPR01F) RESTRICTED;                       02S0570 01245000
*                   GPR01F=APCTABND;/* COMP CODE IN REG 1            */ 01246000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0571 01247000
*                   SVC(13);        /* ISSUE ABEND SVC               */ 01248000
         SVC   13                                               02S0572 01249000
*                   RESPECIFY                                   02S0573 01250000
*                    (GPR01F) UNRESTRICTED;                     02S0573 01251000
*                 END;              /* ABEND(APCTABND) FORCE ABEND   */ 01252000
*                 GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);  02S0575 01253000
*                                                  /* NO CODE           01254000
*               END;                /* ABEND ISSUED                  */ 01255000
*             END;                  /* ERROR PROCESSED       @ZA26916*/ 01256000
*         END;                      /* CHAINING PROCESSED.           */ 01257000
*                                                               02S0578 01258000
@RF00564 DS    0H                                               02S0579 01259000
*       /*************************************************************/ 01260000
*       /*                                                           */ 01261000
*       /* PROCESS READ AND WRITE COMMANDS                           */ 01262000
*       /*                                                           */ 01263000
*       /*************************************************************/ 01264000
*                                                               02S0579 01265000
*       IF DOPREAD=BON|             /* IF READ OR WRITE COMMAND      */ 01266000
*           DOPWRITE=BON THEN       /* (SAME PROCESSING)             */ 01267000
@RF00546 TM    DOPREAD,B'11000000'                              02S0579 01268000
         BZ    @RF00579                                         02S0579 01269000
*         DO;                       /* THEN DO --                    */ 01270000
*           IF CCWFCD=BOFF THEN     /* IF NOT DATA CHAINED, UP NUMBER*/ 01271000
         TM    CCWFCD(DCCWCUR),B'10000000'                      02S0581 01272000
         BNZ   @RF00581                                         02S0581 01273000
*             PROCCNT=PROCCNT+1;    /* OF UNIQUE READ/WRITE CCWS     */ 01274000
         LA    @04,DPROCDTA                                     02S0582 01275000
         LA    @15,1                                            02S0582 01276000
         AH    @15,PROCCNT(,@04)                                02S0582 01277000
         STH   @15,PROCCNT(,@04)                                02S0582 01278000
*           IF APIORXLT=BOFF|       /* IF NOT RE-TRANSLATION,        */ 01279000
*               PROCCNT=0 THEN      /* OR IS WRITE OF CIT -- @ZA26916*/ 01280000
@RF00581 LA    @04,DAPIO                                        02S0583 01281000
         TM    APIORXLT(@04),B'00010000'                        02S0583 01282000
         BZ    @RT00583                                         02S0583 01283000
         LA    @04,DPROCDTA                                     02S0583 01284000
         LH    @04,PROCCNT(,@04)                                02S0583 01285000
         LTR   @04,@04                                          02S0583 01286000
         BNZ   @RF00583                                         02S0583 01287000
@RT00583 DS    0H                                               02S0584 01288000
*             DO;                   /* THEN VALIDATE CCW.    @ZA26916*/ 01289000
*               IF CCWBCNT=0|       /* INSURE NON-ZERO TRANSFER      */ 01290000
*                   (CCWBCNT&'0003'X)^=0 THEN/* COUNT. MUST ALSO     */ 01291000
         LH    @04,CCWBCNT(,DCCWCUR)                            02S0585 01292000
         N     @04,@CF04247                                     02S0585 01293000
         LTR   @04,@04                                          02S0585 01294000
         BZ    @RT00585                                         02S0585 01295000
         N     @04,@CF04003                                     02S0585 01296000
         LTR   @04,@04                                          02S0585 01297000
         BZ    @RF00585                                         02S0585 01298000
@RT00585 DS    0H                                               02S0586 01299000
*                 DO;               /* TRANSMIT WHOLE NUMBER OF      */ 01300000
*                   APESCODE=CERRN10;/* WORDS (3838 REQUIREMENT).    */ 01301000
         MVI   APESCODE,X'0A'                                   02S0587 01302000
*                   APESFSDP=BOFF;  /* SDUMP NOT REQUIRED            */ 01303000
         NI    APESFSDP,B'11011111'                             02S0588 01304000
*                   DO;             /* FORCE ABEND TO LOG ERROR &       01305000
*                                      PASS CONTROL TO THE (E)STAE OR   01306000
*                                      FRR EXIT ROUTINE.             */ 01307000
*                     DO;           /* ABEND(APCTABND)               */ 01308000
*                       RESPECIFY                               02S0591 01309000
*                        (GPR01F) RESTRICTED;                   02S0591 01310000
*                       GPR01F=APCTABND;/* COMP CODE IN REG 1        */ 01311000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0592 01312000
*                       SVC(13);    /* ISSUE ABEND SVC               */ 01313000
         SVC   13                                               02S0593 01314000
*                       RESPECIFY                               02S0594 01315000
*                        (GPR01F) UNRESTRICTED;                 02S0594 01316000
*                     END;          /* ABEND(APCTABND) FORCE ABEND   */ 01317000
*                     GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      01318000
*                                                  /* NO CODE           01319000
*                   END;            /* ABEND ISSUED                  */ 01320000
*                 END;              /* ERROR PROCESSED.              */ 01321000
*               RFY                                             02S0599 01322000
*                (R0F,                                          02S0599 01323000
*                 R1P) RSTD;        /* REFERENCE USER DATA FIELD     */ 01324000
@RF00585 DS    0H                                               02S0600 01325000
*               R1P=CCWDATA;        /* TO INSURE VALID. USE UPDATE   */ 01326000
         L     R1P,CCWDATA-1(,DCCWCUR)                          02S0600 01327000
         LA    R1P,0(,R1P)                                      02S0600 01328000
*               R0F=CCWBCNT;        /* INSTRUCTION TO INSURE IN      */ 01329000
         LH    R0F,CCWBCNT(,DCCWCUR)                            02S0601 01330000
         N     R0F,@CF04247                                     02S0601 01331000
*               CALL REFSTOR;       /* USER PROTECT KEY.             */ 01332000
         BAL   @14,REFSTOR                                      02S0602 01333000
*               RFY                                             02S0603 01334000
*                (R0F,                                          02S0603 01335000
*                 R1P) UNRSTD;      /* FINISHED WITH REGISTERS       */ 01336000
*             END;                  /* CCW VALIDATED         @ZA26916*/ 01337000
*         END;                      /* READ/WRITE PROCESSED.         */ 01338000
*       ELSE                        /* IF NOT READ/WRITE,            */ 01339000
*         IF DOPPROC=BON THEN       /* IF PROCESS COMMAND,           */ 01340000
         B     @RC00579                                         02S0606 01341000
@RF00579 TM    DOPPROC,B'00100000'                              02S0606 01342000
         BNO   @RF00606                                         02S0606 01343000
*           DO;                     /* THEN --                       */ 01344000
*             CCWDATA=DCCWBEG-LENGTH(PROCDATA);/* WRITE FROM PREFIX     01345000
*                                      TO CHANNEL PROGRAM.           */ 01346000
         LA    @04,8                                            02S0608 01347000
         L     @15,DCCWBEG                                      02S0608 01348000
         SLR   @15,@04                                          02S0608 01349000
         STCM  @15,7,CCWDATA(DCCWCUR)                           02S0608 01350000
*             CCWBCNT=LENGTH(PROCDATA);/* LENGTH OF WRITE.           */ 01351000
         STH   @04,CCWBCNT(,DCCWCUR)                            02S0609 01352000
*           END;                    /* PROCESS CMD HANDLED.          */ 01353000
*         ELSE                      /* IF NOT READ/WRITE/PROCESS,    */ 01354000
*           DO;                     /* MUST BE NOP.                  */ 01355000
         B     @RC00606                                         02S0611 01356000
@RF00606 DS    0H                                               02S0612 01357000
*             CCWBCNT=1;            /* INSURE NON-ZERO COUNT.        */ 01358000
         MVC   CCWBCNT(2,DCCWCUR),@CH00068                      02S0612 01359000
*             CCWFSLI=BON;          /* INGORE INCORRECT LENGTH       */ 01360000
         OI    CCWFSLI(DCCWCUR),B'00100000'                     02S0613 01361000
*           END;                    /* NOP COMMAND HANDLED.          */ 01362000
*     END;                          /* ALL CCWS CHECKED              */ 01363000
*                                                               02S0615 01364000
@RC00606 DS    0H                                               02S0615 01365000
@RC00579 AL    DCCWCUR,@CF00037                                 02S0615 01366000
@DE00478 L     @04,DCCWEND                                      02S0615 01367000
         CR    DCCWCUR,@04                                      02S0615 01368000
         BL    @DL00478                                         02S0615 01369000
*     /***************************************************************/ 01370000
*     /*                                                             */ 01371000
*     /* ALL CCWS NOW VALIDIATED. INSURE AT LEAST 3 CCWS. IF NOT, IS */ 01372000
*     /* ERROR. ALSO INSURE FIRST CCW IS PROCESS, SECOND IS WRITE,   */ 01373000
*     /* AND LAST IS NOP. PREVIOUS CHECKS HAVE INSURED NO MORE THAN  */ 01374000
*     /* ONE PROCESS AND ONE NOP.                                    */ 01375000
*     /*                                                             */ 01376000
*     /***************************************************************/ 01377000
*                                                               02S0616 01378000
*     DCCWCT=(DCCWEND-DCCWBEG)/LENGTH(CCW);/* NUMBER OF CCWS.        */ 01379000
         LR    @00,@04                                          02S0616 01380000
         SL    @00,DCCWBEG                                      02S0616 01381000
         SRDA  @00,32                                           02S0616 01382000
         D     @00,@CF00037                                     02S0616 01383000
         ST    @01,DCCWCT                                       02S0616 01384000
*     IF DCCWCT<3 THEN              /* IF LESS THAN 3 CCWS,          */ 01385000
         C     @01,@CF00073                                     02S0617 01386000
         BNL   @RF00617                                         02S0617 01387000
*       DO;                         /* IS ERROR, SO --               */ 01388000
*         APESFSDP=BOFF;            /* SDUMP NOT WANTED              */ 01389000
         NI    APESFSDP,B'11011111'                             02S0619 01390000
*         APESCODE=CERRN05;         /* SET ERROR CODE AND            */ 01391000
         MVI   APESCODE,X'05'                                   02S0620 01392000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       01393000
*                                      PASS CONTROL TO THE (E)STAE OR   01394000
*                                      FRR EXIT ROUTINE.             */ 01395000
*           DO;                     /* ABEND(APCTABND)               */ 01396000
*             RESPECIFY                                         02S0623 01397000
*              (GPR01F) RESTRICTED;                             02S0623 01398000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 01399000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0624 01400000
*             SVC(13);              /* ISSUE ABEND SVC               */ 01401000
         SVC   13                                               02S0625 01402000
*             RESPECIFY                                         02S0626 01403000
*              (GPR01F) UNRESTRICTED;                           02S0626 01404000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 01405000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S0628 01406000
*                                                  /* NO CODE           01407000
*         END;                      /* ABEND ISSUED                  */ 01408000
*       END;                        /* ERROR PROCESSED.              */ 01409000
*     IF DCCWCT=3 THEN              /* IF ONLY 3 CCWS, NO REASON     */ 01410000
@RF00617 CLC   DCCWCT(4),@CF00073                               02S0631 01411000
         BNE   @RF00631                                         02S0631 01412000
*       APIORXLT=BOFF;              /* TO RE-TRANSLATE (NO USER I/O) */ 01413000
         LA    @04,DAPIO                                        02S0632 01414000
         NI    APIORXLT(@04),B'11101111'                        02S0632 01415000
*     IF DCCWBEG->CCWOP^=CPROCOP|   /* PROCESS FIRST                 */ 01416000
*         EVAL(DCCWBEG+LENGTH(CCW))->CCWOP^=CWRITEOP|/* THEN WRITE   */ 01417000
*         EVAL(DCCWEND-LENGTH(CCW))->CCWOP^=CNOPOP THEN/* NOP LAST   */ 01418000
@RF00631 L     @04,DCCWBEG                                      02S0633 01419000
         CLI   CCWOP(@04),15                                    02S0633 01420000
         BNE   @RT00633                                         02S0633 01421000
         LA    @15,8                                            02S0633 01422000
         ALR   @04,@15                                          02S0633 01423000
         CLI   CCWOP(@04),1                                     02S0633 01424000
         BNE   @RT00633                                         02S0633 01425000
         LCR   @15,@15                                          02S0633 01426000
         AL    @15,DCCWEND                                      02S0633 01427000
         CLI   CCWOP(@15),3                                     02S0633 01428000
         BE    @RF00633                                         02S0633 01429000
@RT00633 DS    0H                                               02S0634 01430000
*       DO;                         /* IF NOT TRUE, THEN ERROR.      */ 01431000
*         APESFSDP=BOFF;            /* SDUMP NOT WANTED              */ 01432000
         NI    APESFSDP,B'11011111'                             02S0635 01433000
*         APESCODE=CERRN11;         /* ERROR CODE                    */ 01434000
         MVI   APESCODE,X'0B'                                   02S0636 01435000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       01436000
*                                      PASS CONTROL TO THE (E)STAE OR   01437000
*                                      FRR EXIT ROUTINE.             */ 01438000
*           DO;                     /* ABEND(APCTABND)               */ 01439000
*             RESPECIFY                                         02S0639 01440000
*              (GPR01F) RESTRICTED;                             02S0639 01441000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 01442000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0640 01443000
*             SVC(13);              /* ISSUE ABEND SVC               */ 01444000
         SVC   13                                               02S0641 01445000
*             RESPECIFY                                         02S0642 01446000
*              (GPR01F) UNRESTRICTED;                           02S0642 01447000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 01448000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S0644 01449000
*                                                  /* NO CODE           01450000
*         END;                      /* ABEND ISSUED                  */ 01451000
*       END;                        /* ERROR PROCESSED.              */ 01452000
*                                                               02S0646 01453000
*     /***************************************************************/ 01454000
*     /*                                                             */ 01455000
*     /* UPDATE PROCESS DATA AND THE APIO.                           */ 01456000
*     /*                                                             */ 01457000
*     /***************************************************************/ 01458000
*                                                               02S0647 01459000
*     APIOAPCI=EVAL(DCCWBEG+LENGTH(CCW))/* ADDRESS OF APCI           */ 01460000
*         ->CCWDATA;                /* (POINTED TO BY 2ND CCW)       */ 01461000
@RF00633 LA    @04,DAPIO                                        02S0647 01462000
         L     @15,DCCWBEG                                      02S0647 01463000
         LA    @14,8                                            02S0647 01464000
         LR    @11,@15                                          02S0647 01465000
         ALR   @11,@14                                          02S0647 01466000
         L     @11,CCWDATA-1(,@11)                              02S0647 01467000
         LA    @11,0(,@11)                                      02S0647 01468000
         ST    @11,APIOAPCI(,@04)                               02S0647 01469000
*     APIOCISZ=EVAL(DCCWBEG+LENGTH(CCW))/* APCI SIZE                 */ 01470000
*         ->CCWBCNT;                /* (IN BYTES)                    */ 01471000
         ALR   @15,@14                                          02S0648 01472000
         LH    @15,CCWBCNT(,@15)                                02S0648 01473000
         N     @15,@CF04247                                     02S0648 01474000
         STH   @15,APIOCISZ(,@04)                               02S0648 01475000
*     PROCCISZ=APIOCISZ/2;          /* 3838 NEEDS SIZE IN HALFWORDS  */ 01476000
         LA    @14,DPROCDTA                                     02S0649 01477000
         LA    @11,2                                            02S0649 01478000
         LR    @00,@15                                          02S0649 01479000
         SRDA  @00,32                                           02S0649 01480000
         DR    @00,@11                                          02S0649 01481000
         STH   @01,PROCCISZ(,@14)                               02S0649 01482000
*     PROCOFS=APIORGN*(C1K/4)-      /* OFFSET IN 3838 BULK STORAGE   */ 01483000
*         PROCCISZ/2;               /* TO APCI HOLD AREA (KEEP IN       01484000
*                                      HIGH END OF PARTITION).       */ 01485000
         L     @04,APIORGN(,@04)                                02S0650 01486000
         SLA   @04,8                                            02S0650 01487000
         LR    @02,@01                                          02S0650 01488000
         SRDA  @02,32                                           02S0650 01489000
         DR    @02,@11                                          02S0650 01490000
         SLR   @04,@03                                          02S0650 01491000
         ST    @04,PROCOFS(,@14)                                02S0650 01492000
*     IF PROCOFS<0 THEN             /* INSURE APCI NOT LARGER THAN   */ 01493000
         LTR   @04,@04                                          02S0651 01494000
         BNM   @RF00651                                         02S0651 01495000
*       DO;                         /* PARTITION SIZE (IS ERROR).    */ 01496000
*         APESCODE=CERRN31;         /* SEE ERROR CODE AND GO LOG     */ 01497000
         MVI   APESCODE,X'1F'                                   02S0653 01498000
*         APESFSDP=BOFF;            /* SDUMP NOT REQUIRED            */ 01499000
         NI    APESFSDP,B'11011111'                             02S0654 01500000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       01501000
*                                      PASS CONTROL TO THE (E)STAE OR   01502000
*                                      FRR EXIT ROUTINE.             */ 01503000
*           DO;                     /* ABEND(APCTABND)               */ 01504000
*             RESPECIFY                                         02S0657 01505000
*              (GPR01F) RESTRICTED;                             02S0657 01506000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 01507000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0658 01508000
*             SVC(13);              /* ISSUE ABEND SVC               */ 01509000
         SVC   13                                               02S0659 01510000
*             RESPECIFY                                         02S0660 01511000
*              (GPR01F) UNRESTRICTED;                           02S0660 01512000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 01513000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S0662 01514000
*                                                  /* NO CODE           01515000
*         END;                      /* ABEND ISSUED                  */ 01516000
*       END;                        /* ERROR PROCESSED               */ 01517000
*   END;                            /* CCW CHAIN VALIDATED           */ 01518000
@RF00651 DS    0H                                               02S0666 01519000
         EJECT                                                          01520000
*                                                               01S0666 01521000
*   /*****************************************************************/ 01522000
*   /*                                                               */ 01523000
*   /* GET TEMPORARY STORAGE FOR APXL, IDALS AND PGFIX LIST.         */ 01524000
*   /*                                                               */ 01525000
*   /*****************************************************************/ 01526000
*                                                               01S0666 01527000
*   DO;                             /* START OF CODE SEGMENT         */ 01528000
*                                                               02S0666 01529000
*     /***************************************************************/ 01530000
*     /*                                                             */ 01531000
*     /* GET TEMPORARY STORAGE FOR APXL, IDALS AND VSL LIST. THIS    */ 01532000
*     /* STORAGE IS OBTAINED FROM THE DYNAMIC WORKAREA EXTENSION. THE*/ 01533000
*     /* MAXIMUM POSSIBLE SIZE REQUIRED IS OBTAINED. NO PAGE         */ 01534000
*     /* ALIGNMENT REQUIREMENTS EXIST FOR THESE TEMPORARY AREAS.     */ 01535000
*     /* INITIALIZE POINTERS TO THE BEGINNING AND END OF EACH AREA.  */ 01536000
*     /*                                                             */ 01537000
*     /***************************************************************/ 01538000
*                                                               02S0667 01539000
*     DIDALSZ=((DCCWCT-2)/(CPGSIZE  /* MAXIMUM IDAL SIZE. ASSUME EACH*/ 01540000
*         /(((CMAXIOSZ+CIOXSZ-2)/CIOXSZ+1)*/* CCW USES MAX.  @ZA26916*/ 01541000
*         LENGTH(IDAL)))+1)*CPGSIZE;/* ALSO FIX MIN NUMBER IDALS/PG. */ 01542000
         L     @00,DCCWCT                                       02S0667 01543000
         BCTR  @00,0                                            02S0667 01544000
         BCTR  @00,0                                            02S0667 01545000
         SRDA  @00,32                                           02S0667 01546000
         D     @00,@CF00043                                     02S0667 01547000
         AL    @01,@CF00068                                     02S0667 01548000
         SLA   @01,12                                           02S0667 01549000
         ST    @01,DIDALSZ                                      02S0667 01550000
*     IF DIDALSZ>APCTKCAX THEN      /* DO NOT OBTAIN MORE THAN       */ 01551000
         LH    @04,APCTKCAX(,APCTPTR)                           02S0668 01552000
         N     @04,@CF04247                                     02S0668 01553000
         CR    @01,@04                                          02S0668 01554000
         BNH   @RF00668                                         02S0668 01555000
*       DIDALSZ=APCTKCAX;           /* INSTALLATION ALLOWS           */ 01556000
         ST    @04,DIDALSZ                                      02S0669 01557000
*     IF DIDALSZ>'00006E00'X THEN   /* DO NOT OBTAIN MORE THAN       */ 01558000
@RF00668 L     @04,@CF04005                                     02S0670 01559000
         C     @04,DIDALSZ                                      02S0670 01560000
         BNL   @RF00670                                         02S0670 01561000
*       DIDALSZ='00006E00'X;        /* MAX INTERNAL GETMAIN CAN DO.  */ 01562000
         ST    @04,DIDALSZ                                      02S0671 01563000
*     DVSLSZ=((DCCWCT-2)+20)*       /* MAX VSL SIZE (ONE PER CCW     */ 01564000
*         LENGTH(VSL);              /* DATA AREA PLUS EXTRAS FOR CCW    01565000
*                                      CHAIN, IDALS, ETC.).          */ 01566000
@RF00670 LA    @04,18                                           02S0672 01567000
         AL    @04,DCCWCT                                       02S0672 01568000
         SLA   @04,3                                            02S0672 01569000
         ST    @04,DVSLSZ                                       02S0672 01570000
*     IF DVSLSZ>APCTKCAX THEN       /* DO NOT OBTAIN MORE THAN       */ 01571000
         LH    @15,APCTKCAX(,APCTPTR)                           02S0673 01572000
         N     @15,@CF04247                                     02S0673 01573000
         CR    @04,@15                                          02S0673 01574000
         BNH   @RF00673                                         02S0673 01575000
*       DVSLSZ=APCTKCAX;            /* INSTALLATION ALLOWS           */ 01576000
         ST    @15,DVSLSZ                                       02S0674 01577000
*     IF DVSLSZ>'00006E00'X THEN    /* DO NOT OBTAIN MORE THAN       */ 01578000
@RF00673 L     @04,@CF04005                                     02S0675 01579000
         C     @04,DVSLSZ                                       02S0675 01580000
         BNL   @RF00675                                         02S0675 01581000
*       DVSLSZ='00006E00'X;         /* MAX INTERNAL GETMAIN CAN DO.  */ 01582000
         ST    @04,DVSLSZ                                       02S0676 01583000
*     DAPXLSZ=((DCCWCT-2)*          /* MAXIMUM APRL SIZE     @ZA26916*/ 01584000
*         ((CMAXIOSZ+CIOXSZ-2)/CIOXSZ+1)/* =                 @ZA26916*/ 01585000
*         +DCCWCT+20)*APXLLN1       /* 1 PER IDAL, 1 PER CCW,        */ 01586000
*         +APXLLN0;                 /* PLUS 1 FOR IOSB, ETC. ALSO       01587000
*                                      ALLOW FOR APXL HEADER         */ 01588000
@RF00675 L     @04,DCCWCT                                       02S0677 01589000
         LR    @15,@04                                          02S0677 01590000
         BCTR  @15,0                                            02S0677 01591000
         BCTR  @15,0                                            02S0677 01592000
         MH    @15,@CH02030                                     02S0677 01593000
         ALR   @15,@04                                          02S0677 01594000
         AL    @15,@CF01711                                     02S0677 01595000
         SLA   @15,3                                            02S0677 01596000
         AL    @15,@CF00090                                     02S0677 01597000
         ST    @15,DAPXLSZ                                      02S0677 01598000
*     IF DAPXLSZ>APCTKCAX THEN      /* DO NOT OBTAIN MORE THAN       */ 01599000
         LH    @04,APCTKCAX(,APCTPTR)                           02S0678 01600000
         N     @04,@CF04247                                     02S0678 01601000
         CR    @15,@04                                          02S0678 01602000
         BNH   @RF00678                                         02S0678 01603000
*       DAPXLSZ=APCTKCAX;           /* INSTALLATION ALLOWS           */ 01604000
         ST    @04,DAPXLSZ                                      02S0679 01605000
*     IF DAPXLSZ>'00006E00'X THEN   /* DO NOT OBTAIN MORE THAN       */ 01606000
@RF00678 L     @04,@CF04005                                     02S0680 01607000
         C     @04,DAPXLSZ                                      02S0680 01608000
         BNL   @RF00680                                         02S0680 01609000
*       DAPXLSZ='00006E00'X;        /* MAX INTERNAL GETMAIN CAN DO.  */ 01610000
         ST    @04,DAPXLSZ                                      02S0681 01611000
*     RFY                                                       02S0682 01612000
*       R1P RSTD;                   /* GETMAIN AREA POINTER          */ 01613000
@RF00680 DS    0H                                               02S0683 01614000
*     APESCODE=CERRN20;             /* ERROR CODE IF NO STORAGE      */ 01615000
         MVI   APESCODE,X'14'                                   02S0683 01616000
*     DO;                           /* IGTYGSTK LV(DIDALSZ)          */ 01617000
*       RFY                                                     02S0685 01618000
*         GPR00F RSTD;              /* NEEDED REGISTER               */ 01619000
*       GPR00F=DIDALSZ;             /* SET REG 0 TO REQUIRED LENGTH  */ 01620000
         L     GPR00F,DIDALSZ                                   02S0686 01621000
*       CALL APCVZUAD;              /* OBTAIN A DYNAMIC AREA         */ 01622000
         L     @15,APCTZUAD(,APCTPTR)                           02S0687 01623000
         BALR  @14,@15                                          02S0687 01624000
*       RFY                                                     02S0688 01625000
*        (GPR00F) UNRSTD;           /* FINISHED WITH REGISTERS       */ 01626000
*     END;                          /* REG_1 -> ACQUIRED DYNAMIC AREA   01627000
*                                      GET IDAL STORAGE              */ 01628000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 01629000
         MVI   APESCODE,X'21'                                   02S0690 01630000
*     DIDALBEG=R1P;                 /* START OF IDAL AREA            */ 01631000
         ST    R1P,DIDALBEG                                     02S0691 01632000
*     DIDALCUR=R1P;                 /* CURRENT IDAL ENTRY            */ 01633000
         ST    R1P,DIDALCUR                                     02S0692 01634000
*     DIDALEND=R1P+DIDALSZ;         /* END OF IDAL WORKAREA          */ 01635000
         LR    @04,R1P                                          02S0693 01636000
         AL    @04,DIDALSZ                                      02S0693 01637000
         ST    @04,DIDALEND                                     02S0693 01638000
*     APESCODE=CERRN20;             /* ERROR CODE IF NO STORAGE      */ 01639000
         MVI   APESCODE,X'14'                                   02S0694 01640000
*     DO;                           /* IGTYGSTK LV(DVSLSZ)           */ 01641000
*       RFY                                                     02S0696 01642000
*         GPR00F RSTD;              /* NEEDED REGISTER               */ 01643000
*       GPR00F=DVSLSZ;              /* SET REG 0 TO REQUIRED LENGTH  */ 01644000
         L     GPR00F,DVSLSZ                                    02S0697 01645000
*       CALL APCVZUAD;              /* OBTAIN A DYNAMIC AREA         */ 01646000
         L     @15,APCTZUAD(,APCTPTR)                           02S0698 01647000
         BALR  @14,@15                                          02S0698 01648000
*       RFY                                                     02S0699 01649000
*        (GPR00F) UNRSTD;           /* FINISHED WITH REGISTERS       */ 01650000
*     END;                          /* REG_1 -> ACQUIRED DYNAMIC AREA   01651000
*                                      GET STORAGE                   */ 01652000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 01653000
         MVI   APESCODE,X'21'                                   02S0701 01654000
*     DVSLBEG=R1P;                  /* START OF WORKAREA             */ 01655000
         ST    R1P,DVSLBEG                                      02S0702 01656000
*     DVSLCUR=R1P;                  /* CURRENT PGFIX ENTRY           */ 01657000
         ST    R1P,DVSLCUR                                      02S0703 01658000
*     DVSLEND=R1P+DVSLSZ;           /* END OF PGFIX/PGFREE VSL AREA  */ 01659000
         LR    @04,R1P                                          02S0704 01660000
         AL    @04,DVSLSZ                                       02S0704 01661000
         ST    @04,DVSLEND                                      02S0704 01662000
*     APESCODE=CERRN20;             /* ERROR CODE IF NO STORAGE      */ 01663000
         MVI   APESCODE,X'14'                                   02S0705 01664000
*     DO;                           /* IGTYGSTK LV(DAPXLSZ)          */ 01665000
*       RFY                                                     02S0707 01666000
*         GPR00F RSTD;              /* NEEDED REGISTER               */ 01667000
*       GPR00F=DAPXLSZ;             /* SET REG 0 TO REQUIRED LENGTH  */ 01668000
         L     GPR00F,DAPXLSZ                                   02S0708 01669000
*       CALL APCVZUAD;              /* OBTAIN A DYNAMIC AREA         */ 01670000
         L     @15,APCTZUAD(,APCTPTR)                           02S0709 01671000
         BALR  @14,@15                                          02S0709 01672000
*       RFY                                                     02S0710 01673000
*        (GPR00F) UNRSTD;           /* FINISHED WITH REGISTERS       */ 01674000
*     END;                          /* REG_1 -> ACQUIRED DYNAMIC AREA   01675000
*                                      GET APXL WORKAREA             */ 01676000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 01677000
         MVI   APESCODE,X'21'                                   02S0712 01678000
*     DAPXLBEG=R1P;                 /* START OF AREA                 */ 01679000
         ST    R1P,DAPXLBEG                                     02S0713 01680000
*     DAPXLCUR=R1P+APXLLN0;         /* CURRENT APXL ENTRY (SKIP HDR) */ 01681000
         LA    @04,24                                           02S0714 01682000
         ALR   @04,R1P                                          02S0714 01683000
         ST    @04,DAPXLCUR                                     02S0714 01684000
*     DAPXLEND=R1P+DAPXLSZ;         /* END OF APXL WORKAREA          */ 01685000
         LR    @04,R1P                                          02S0715 01686000
         AL    @04,DAPXLSZ                                      02S0715 01687000
         ST    @04,DAPXLEND                                     02S0715 01688000
*     R1P->APXL(1:APXLLN0)=R1P->APXL(1:APXLLN0)&&R1P->APXL(1:APXLLN0);  01689000
         XC    APXL(24,R1P),APXL(R1P)                           02S0716 01690000
*                                   /* CLEAR APXL HEADER             */ 01691000
*     R1P->APXLID=APXLIDC;          /* IN-CORE ID                    */ 01692000
         MVC   APXLID(4,R1P),@CC03436                           02S0717 01693000
*     RFY                                                       02S0718 01694000
*       R1P UNRSTD;                 /* FINISHED WITH POINTER         */ 01695000
*   END;                            /* WORKAREAS OBTAINED            */ 01696000
         EJECT                                                          01697000
*                                                               01S0720 01698000
*   /*****************************************************************/ 01699000
*   /*                                                               */ 01700000
*   /* BUILD TRANSLATED CHANNEL PROGRAM USING TEMPORARY WORKAREAS    */ 01701000
*   /*                                                               */ 01702000
*   /*****************************************************************/ 01703000
*                                                               01S0720 01704000
*   DO;                                                         02S0720 01705000
*                                                               02S0720 01706000
*     /***************************************************************/ 01707000
*     /*                                                             */ 01708000
*     /* BUILD A TRANSLATED CHANNEL PROGRAM IN TEMPORARY WORKAREAS.  */ 01709000
*     /* ALLOW FOR CCWS AT START OF PAGE. ACT LIKE SEVERAL IDALS     */ 01710000
*     /* ALREADY BUILT. INSURE IDALS FOR SAME CCW DO NOT CROSS A PAGE*/ 01711000
*     /* BOUNDARY.                                                   */ 01712000
*     /*                                                             */ 01713000
*     /***************************************************************/ 01714000
*                                                               02S0721 01715000
*     DIDALCT=(DCCWEND-DCCWBEG+LENGTH(PROCDATA))/* ALLOW FOR CCWS    */ 01716000
*         /LENGTH(IDAL);            /* AT START OF PAGE.             */ 01717000
*                                                               02S0721 01718000
         L     @04,DCCWBEG                                      02S0721 01719000
         L     @00,DCCWEND                                      02S0721 01720000
         SLR   @00,@04                                          02S0721 01721000
         AL    @00,@CF00037                                     02S0721 01722000
         SRDA  @00,32                                           02S0721 01723000
         D     @00,@CF00045                                     02S0721 01724000
         ST    @01,DIDALCT                                      02S0721 01725000
*     /***************************************************************/ 01726000
*     /*                                                             */ 01727000
*     /* ADD ENTRY TO APXL TO SAVE REAL CHANNEL PROGRAM ADDRESS IN   */ 01728000
*     /* IOSB. NOTE THAT THIS ENTRY POINTS TO FAKE IOSB. THIS MUST BE*/ 01729000
*     /* THE FIRST APXL ENTRY SINCE IT IS LATER MODIFIED TO POINT TO */ 01730000
*     /* THE REAL IOSB.                                              */ 01731000
*     /*                                                             */ 01732000
*     /***************************************************************/ 01733000
*                                                               02S0722 01734000
*     RFY                                                       02S0722 01735000
*      (R0P,                                                    02S0722 01736000
*       R1P) RSTD;                  /* REQUIRED REGISTERS            */ 01737000
*     R0P=DCCWBEG;                  /* ADDRESS TO TRANSLATE          */ 01738000
         LR    R0P,@04                                          02S0723 01739000
*     R1P=ADDR(IOSRST);             /* STORE IN IOSB                 */ 01740000
         LA    R1P,DAPIO                                        02S0724 01741000
         LA    R1P,IOSRST(,R1P)                                 02S0724 01742000
*     CALL ADDAPXL;                 /* ADD THE ENTRY.                */ 01743000
         BAL   @14,ADDAPXL                                      02S0725 01744000
*     RFY                                                       02S0726 01745000
*      (R0P,                                                    02S0726 01746000
*       R1P) UNRSTD;                /* FINISHED WITH THESE REGISTERS */ 01747000
*                                                               02S0726 01748000
*     /***************************************************************/ 01749000
*     /*                                                             */ 01750000
*     /* ADD DUMMY ENTRY TO PAGE-FIX LIST. THIS WILL CONTAIN ENTRY TO*/ 01751000
*     /* FIX THE CHANNEL PROGRAM AND THE ASSOCIATED IDALS. INSURE    */ 01752000
*     /* THAT THIS ENTRY SORTS FIRST IN THE TABLE AND IS NOT COMBINED*/ 01753000
*     /* WITH OTHER ENTRIES.                                         */ 01754000
*     /*                                                             */ 01755000
*     /***************************************************************/ 01756000
*                                                               02S0727 01757000
*     RFY                                                       02S0727 01758000
*      (R0P,                                                    02S0727 01759000
*       R1F) RSTD;                  /* REQUIRED REGISTERS            */ 01760000
*     R0P=0;                        /* START AT LOCATION 0           */ 01761000
         SLR   R0P,R0P                                          02S0728 01762000
*     R1F=0;                        /* NO LENGTH                     */ 01763000
         SLR   R1F,R1F                                          02S0729 01764000
*     CALL ADDVSL;                  /* ADD DUMMY ENTRY               */ 01765000
         BAL   @14,ADDVSL                                       02S0730 01766000
*     RFY                                                       02S0731 01767000
*      (R0P,                                                    02S0731 01768000
*       R1F) UNRSTD;                /* FINISHED WITH REGISTERS       */ 01769000
*     DEXTVSL=0;                    /* INITIALIZE EXTRA ENTRY        */ 01770000
         SLR   @15,@15                                          02S0732 01771000
         ST    @15,DEXTVSL                                      02S0732 01772000
*     DEXTAPXL=0;                   /* COUNTERS FOR RE-TRANSLATE.    */ 01773000
         SLR   DEXTAPXL,DEXTAPXL                                02S0733 01774000
*     DO DCCWCUR=DCCWBEG BY LENGTH(CCW)/* SCAN ALL CCWS UP TO THE    */ 01775000
*           WHILE(CCWOP^=CNOPOP);   /* NOP. (LAST COMMAND).          */ 01776000
         L     DCCWCUR,DCCWBEG                                  02S0734 01777000
         B     @DE00734                                         02S0734 01778000
@DL00734 DS    0H                                               02S0735 01779000
*       CALL CHKOLAP;               /* FIND CHANNEL PGM I/O OVERLAP  */ 01780000
         BAL   @14,CHKOLAP                                      02S0735 01781000
*       RFY                                                     02S0736 01782000
*        (R0P,                                                  02S0736 01783000
*         R1F) RSTD;                /* WORK REGISTERS                */ 01784000
*       R0P=CCWDATA;                /* START OF I/O BUFFER           */ 01785000
         L     R0P,CCWDATA-1(,DCCWCUR)                          02S0737 01786000
         ICM   R0P,8,@CB01727                                   02S0737 01787000
*       R1F=CCWBCNT;                /* LENGTH OF I/O BUFFER          */ 01788000
         LH    R1F,CCWBCNT(,DCCWCUR)                            02S0738 01789000
         N     R1F,@CF04247                                     02S0738 01790000
*       IF DSW0FCCW=BOFF&           /* IF NOT FAKE (RE-TRANSLATE)    */ 01791000
*           ((R0P+R1F-1)&CRNDPGDN)= /* CCW, & DATA AREA WITHIN 1     */ 01792000
*           (R0P&CRNDPGDN) THEN     /* PAGE, THEN DO NOT NEED IDAL   */ 01793000
         TM    DSW0FCCW,B'10000000'                             02S0739 01794000
         BNZ   @RF00739                                         02S0739 01795000
         L     @15,@CF03929                                     02S0739 01796000
         LR    @14,R0P                                          02S0739 01797000
         ALR   @14,R1F                                          02S0739 01798000
         BCTR  @14,0                                            02S0739 01799000
         NR    @14,@15                                          02S0739 01800000
         NR    @15,R0P                                          02S0739 01801000
         CR    @14,@15                                          02S0739 01802000
         BNE   @RF00739                                         02S0739 01803000
*         DO;                       /* SUPPORT FOR THIS CCW.         */ 01804000
*           IF CCWOP^=CPROCOP THEN  /* PGFIX I/O BUFFER IF NOT PROC. */ 01805000
         CLI   CCWOP(DCCWCUR),15                                02S0741 01806000
         BE    @RF00741                                         02S0741 01807000
*             CALL ADDVSL;          /* (PROCESS DATA FIXED WITH CCWS)*/ 01808000
         BAL   @14,ADDVSL                                       02S0742 01809000
*           R1P=ADDR(CCWDATA);      /* ADD APXL ENTRY FOR I/O DATA   */ 01810000
@RF00741 LA    R1P,CCWDATA(,DCCWCUR)                            02S0743 01811000
*           CALL ADDAPXL;           /* POINTER IN CCW.               */ 01812000
         BAL   @14,ADDAPXL                                      02S0744 01813000
*         END;                      /* NON-IDAL CCW PROCESSED.       */ 01814000
*       ELSE                        /* IF I/O BUFFER SPANS A PAGE    */ 01815000
*         DO;                       /* OR IS FAKE CCW, THEN --       */ 01816000
         B     @RC00739                                         02S0746 01817000
@RF00739 DS    0H                                               02S0747 01818000
*           CALL ADDVSL;            /* PGFIX I/O BUFFER              */ 01819000
         BAL   @14,ADDVSL                                       02S0747 01820000
*           CALL ADDIDAL;           /* BUILD IDAL FOR CCW            */ 01821000
         BAL   @14,ADDIDAL                                      02S0748 01822000
*         END;                      /* IDAL CCW PROCESSED            */ 01823000
*       RFY                                                     02S0750 01824000
*        (R0P,                                                  02S0750 01825000
*         R1F) UNRSTD;              /* FINISHED WITH POINTERS        */ 01826000
@RC00739 DS    0H                                               02S0751 01827000
*       IF APIORXLT=BON&            /* IF RE-TRANSLATION REQUESTED   */ 01828000
*           DSW0FCCW=BOFF&          /* AND HAVE NOT FOUND 1ST FAKE   */ 01829000
*           DCCWCUR=DCCWBEG+        /* AND POINTING AT CIT WRITE,    */ 01830000
*           LENGTH(CCW) THEN        /* THEN NEXT CCW IS 1ST  @ZA26916*/ 01831000
         LA    @15,DAPIO                                        02S0751 01832000
         TM    APIORXLT(@15),B'00010000'                        02S0751 01833000
         BNO   @RF00751                                         02S0751 01834000
         TM    DSW0FCCW,B'10000000'                             02S0751 01835000
         BNZ   @RF00751                                         02S0751 01836000
         LA    @15,8                                            02S0751 01837000
         AL    @15,DCCWBEG                                      02S0751 01838000
         CR    DCCWCUR,@15                                      02S0751 01839000
         BNE   @RF00751                                         02S0751 01840000
*         DO;                       /* FAKE CCW.             @ZA26916*/ 01841000
*           DSW0FCCW=BON;           /* SHOW REMAINING CCWS ARE FAKE  */ 01842000
         OI    DSW0FCCW,B'10000000'                             02S0753 01843000
*           DAPXLBEG->APXLIDAL=DAPXLCUR;/* APXL ENTRY FOR 1ST   02S0754 01844000
*                                      RE-TRANSLATE CCW IDAL ENTRY   */ 01845000
         L     @15,DAPXLCUR                                     02S0754 01846000
         L     @14,DAPXLBEG                                     02S0754 01847000
         ST    @15,APXLIDAL(,@14)                               02S0754 01848000
*         END;                      /*                       @ZA26916*/ 01849000
*     END;                          /* SCAN ALL CCWS                 */ 01850000
*                                                               02S0756 01851000
@RF00751 AL    DCCWCUR,@CF00037                                 02S0756 01852000
@DE00734 CLI   CCWOP(DCCWCUR),3                                 02S0756 01853000
         BNE   @DL00734                                         02S0756 01854000
*     /***************************************************************/ 01855000
*     /*                                                             */ 01856000
*     /* CHANNEL PROGRAM TRANSLATED                                  */ 01857000
*     /*                                                             */ 01858000
*     /***************************************************************/ 01859000
*                                                               02S0757 01860000
*                                                               02S0757 01861000
*     /***************************************************************/ 01862000
*     /*                                                             */ 01863000
*     /* SET ENDING ADDRESSES OF IDAL, PGFIX, AND APXL TABLES TO END */ 01864000
*     /* OF THE USED PORTIONS. ALSO SET CCW BEGINNING ADDRESS TO     */ 01865000
*     /* INCLUDE PROCESS-COMMAND DATA (PROCDATA).                    */ 01866000
*     /*                                                             */ 01867000
*     /***************************************************************/ 01868000
*                                                               02S0757 01869000
*     DIDALEND=DIDALCUR;            /* IDAL END                      */ 01870000
         L     @15,DIDALCUR                                     02S0757 01871000
         ST    @15,DIDALEND                                     02S0757 01872000
*     DIDALSZ=DIDALEND-DIDALBEG;    /* IDAL SIZE                     */ 01873000
         SL    @15,DIDALBEG                                     02S0758 01874000
         ST    @15,DIDALSZ                                      02S0758 01875000
*     DAPXLEND=DAPXLCUR;            /* APXL END                      */ 01876000
         L     @15,DAPXLCUR                                     02S0759 01877000
         ST    @15,DAPXLEND                                     02S0759 01878000
*     DAPXLSZ=DAPXLEND-DAPXLBEG;    /* APXL SIZE                     */ 01879000
         SL    @15,DAPXLBEG                                     02S0760 01880000
         ST    @15,DAPXLSZ                                      02S0760 01881000
*     DVSLEND=DVSLCUR;              /* PGFIX END                     */ 01882000
         L     @15,DVSLCUR                                      02S0761 01883000
         ST    @15,DVSLEND                                      02S0761 01884000
*     DVSLSZ=DVSLEND-DVSLBEG;       /* VSL SIZE                      */ 01885000
         SL    @15,DVSLBEG                                      02S0762 01886000
         ST    @15,DVSLSZ                                       02S0762 01887000
*     DCCWBEG=DCCWBEG-LENGTH(PROCDATA);/* COUNT PROCESS DATA         */ 01888000
         L     @15,DCCWBEG                                      02S0763 01889000
         SL    @15,@CF00037                                     02S0763 01890000
         ST    @15,DCCWBEG                                      02S0763 01891000
*     DCCWBEG->PROCDATA=PROCDATA;   /* SAVE PROCESS DATA             */ 01892000
         LA    @14,DPROCDTA                                     02S0764 01893000
         MVC   PROCDATA(8,@15),PROCDATA(@14)                    02S0764 01894000
*     RFY                                                       02S0765 01895000
*       PROCDATA;                   /* PROCESS DATA BUILT            */ 01896000
*   END;                                                        02S0766 01897000
         EJECT                                                          01898000
*                                                               01S0767 01899000
*   /*****************************************************************/ 01900000
*   /*                                                               */ 01901000
*   /* SORT AND COMBINE THE PGFIX/PGFREE VSL ENTRIES                 */ 01902000
*   /*                                                               */ 01903000
*   /*****************************************************************/ 01904000
*                                                               01S0767 01905000
*   CALL SORTVSL;                   /* SORT/MERGE VSL ENTRIES        */ 01906000
         BAL   @14,SORTVSL                                      01S0767 01907000
*                                                               01S0768 01908000
*   /*****************************************************************/ 01909000
*   /*                                                               */ 01910000
*   /* GET THE LOCAL LOCK. REQUIRED TO SYNCHRONIZE APDX PROCESSING.  */ 01911000
*   /* THIS LOCK MUST BE MAINTAINED UNTIL THE APIO IS BUILT AND ITS  */ 01912000
*   /* ADDRESS PLACED IN THE APDX (IE TRANSLATION PROCESSING         */ 01913000
*   /* COMPLETE).                                                    */ 01914000
*   /*                                                               */ 01915000
*   /*****************************************************************/ 01916000
*                                                               01S0768 01917000
*   CALL GETLLCK;                   /* GET THE LOCAL LOCK            */ 01918000
*                                                               01S0768 01919000
         BAL   @14,GETLLCK                                      01S0768 01920000
*   /*****************************************************************/ 01921000
*   /*                                                               */ 01922000
*   /* INSURE THE INPUT DEB IS STILL VALID (KEEPING THE LOCAL LOCK   */ 01923000
*   /* INSURES THE DEB NOW REMAINS STABLE).                          */ 01924000
*   /*                                                               */ 01925000
*   /*****************************************************************/ 01926000
*                                                               01S0769 01927000
*   DO;                             /* INSURE THE DEB IS STILL HERE  */ 01928000
*                                                               02S0769 01929000
*     /***************************************************************/ 01930000
*     /*                                                             */ 01931000
*     /* INSURE THE DEB IS STILL ON THE DEB CHAIN (CLOSE NOT ISSUED).*/ 01932000
*     /* SINCE THE LOCAL LOCK IS OWNED, ONCE THE DEB IS VALIDATED, IT*/ 01933000
*     /* CANNOT BE FREED AS LONG AS THE LOCK IS HELD. IF THE LOCK IS */ 01934000
*     /* RELEASED, ANOTHER DEBCHK MUST BE PERFORMED.                 */ 01935000
*     /*                                                             */ 01936000
*     /***************************************************************/ 01937000
*                                                               02S0770 01938000
*     STM(R10F,R11F,DSUPVSVE);      /* SAVE DESTROYED REGISTERS      */ 01939000
         STM   R10F,R11F,DSUPVSVE                               02S0770 01940000
*     RFY                                                       02S0771 01941000
*      (R10P,                                                   02S0771 01942000
*       R1P,                                                    02S0771 01943000
*       R15P) RSTD;                 /* DEBCHK INPUT REGISTERS        */ 01944000
*     R1P=DDEBPTR;                  /* ADDRESS OF DEB TO VERIFY      */ 01945000
         LR    R1P,DDEBPTR                                      02S0772 01946000
*     R10P=PSATOLD;                 /* TCB TO CHECK. MAY NOT BE TCB     01947000
*                                      WHICH OPENED ACB, BUT IS SAME    01948000
*                                      TCB STRUCTURE.                */ 01949000
         L     R10P,PSATOLD                                     02S0773 01950000
*     R15P=CVTDEBVR;                /* DEBCHK BRANCH ENTRY POINT     */ 01951000
         L     @11,CVTPTR                                       02S0774 01952000
         L     @11,CVTEXT2(,@11)                                02S0774 01953000
         L     R15P,CVTDEBVR(,@11)                              02S0774 01954000
*     APESCODE=CERRN23;             /* DEBCHK FAILURE CODE           */ 01955000
         MVI   APESCODE,X'17'                                   02S0775 01956000
*     GEN REFS(R15P,R1P,R10P) SETS(R10P,R11P,R15P);             02S0776 01957000
*                                   /*                                  01958000
         CALL  (15)                CALL DEBCHK ROUTINE                  01959000
         NOP   *-*                 + 0 -- DEB VALID (R15=0)             01960000
*                                  + 4 -- DEB INVALID (R15=4)           01961000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 01962000
         MVI   APESCODE,X'21'                                   02S0777 01963000
*     LM(R10F,R11F,DSUPVSVE);       /* RELOAD DESTROYED REGISTERS    */ 01964000
         LM    R10F,R11F,DSUPVSVE                               02S0778 01965000
*     IF R15F^=0|                   /* IF DEBCHK FAILED, OR DEB      */ 01966000
*         APDXSOPN=BOFF THEN        /* IN PROCESS OF BEING CLOSED,   */ 01967000
         LTR   R15F,R15F                                        02S0779 01968000
         BNZ   @RT00779                                         02S0779 01969000
         L     @14,DAPDXPTR                                     02S0779 01970000
         TM    APDXSOPN(@14),B'10000000'                        02S0779 01971000
         BNZ   @RF00779                                         02S0779 01972000
@RT00779 DS    0H                                               02S0780 01973000
*       DO;                         /* THEN SET ERROR CODE AND STOP  */ 01974000
*         APESCODE=CERRN23;         /* ERROR NUMBER                  */ 01975000
         MVI   APESCODE,X'17'                                   02S0781 01976000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       01977000
*                                      PASS CONTROL TO THE (E)STAE OR   01978000
*                                      FRR EXIT ROUTINE.             */ 01979000
*           DO;                     /* ABEND(APCTABND)               */ 01980000
*             RESPECIFY                                         02S0784 01981000
*              (GPR01F) RESTRICTED;                             02S0784 01982000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 01983000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0785 01984000
*             SVC(13);              /* ISSUE ABEND SVC               */ 01985000
         SVC   13                                               02S0786 01986000
*             RESPECIFY                                         02S0787 01987000
*              (GPR01F) UNRESTRICTED;                           02S0787 01988000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 01989000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S0789 01990000
*                                                  /* NO CODE           01991000
*         END;                      /* ABEND ISSUED                  */ 01992000
*       END;                        /* ERROR PROCESSED               */ 01993000
*     RFY                                                       02S0792 01994000
*      (R10P,                                                   02S0792 01995000
*       R1P,                                                    02S0792 01996000
*       R15P) UNRSTD;               /* FINISHED WITH REGISTERS       */ 01997000
@RF00779 DS    0H                                               02S0793 01998000
*   END;                            /* END OF CODE                   */ 01999000
         EJECT                                                          02000000
*                                                               01S0794 02001000
*   /*****************************************************************/ 02002000
*   /*                                                               */ 02003000
*   /* FIND AN EMPTY APDXAPIO SLOT TO HOLD THE ADDRESS OF THE        */ 02004000
*   /* ASSOCIATED APIO.                                              */ 02005000
*   /*                                                               */ 02006000
*   /*****************************************************************/ 02007000
*                                                               01S0794 02008000
*   DO;                             /* START OF CODE SEGMENT         */ 02009000
*                                                               02S0794 02010000
*     /***************************************************************/ 02011000
*     /*                                                             */ 02012000
*     /* LOCATE AN AVAILABLE APDX SLOT TO SAVE THE ADDRESS OF THE    */ 02013000
*     /* ACQUIRED APIO. IF NONE IS AVAILABLE, THE USER HAS EXCEEDED  */ 02014000
*     /* HIS SPECIFIED LIMIT. THEREFORE SET AN ERROR CODE AND EXIT.  */ 02015000
*     /* THE LOCAL LOCK MUST BE HELD ACROSS THIS PROCESSING AND NOT  */ 02016000
*     /* RELEASED UNTIL APDXAPIO IS FILLED-IN TO SERIALIZE           */ 02017000
*     /* PROCESSING.                                                 */ 02018000
*     /*                                                             */ 02019000
*     /***************************************************************/ 02020000
*                                                               02S0795 02021000
*     DO DAPIOCT0=APDXIOCT TO 1 BY-1/* SCAN ALL APDXAPIO ENTRIES     */ 02022000
*           WHILE(APDXAPIO(DAPIOCT0)^=0);/* FOR 0 SLOT (AVAILABLE).  */ 02023000
         L     @01,DAPDXPTR                                     02S0795 02024000
         LH    @15,APDXIOCT(,@01)                               02S0795 02025000
         ST    @15,DAPIOCT0                                     02S0795 02026000
         B     @DE00795                                         02S0795 02027000
@DL00795 LR    @14,@15                                          02S0795 02028000
         SLA   @14,2                                            02S0795 02029000
         L     @01,DAPDXPTR                                     02S0795 02030000
         L     @14,APDXAPIO-4(@14,@01)                          02S0795 02031000
         LTR   @14,@14                                          02S0795 02032000
         BZ    @DC00795                                         02S0795 02033000
*     END;                          /* ALL SLOTS FULL OR ENTRY FOUND */ 02034000
         BCTR  @15,0                                            02S0796 02035000
         ST    @15,DAPIOCT0                                     02S0796 02036000
@DE00795 LTR   @15,@15                                          02S0796 02037000
         BP    @DL00795                                         02S0796 02038000
@DC00795 DS    0H                                               02S0797 02039000
*     IF DAPIOCT0=0 THEN            /* IF ALL APDXAPIO SLOTS FULL    */ 02040000
         L     @15,DAPIOCT0                                     02S0797 02041000
         LTR   @15,@15                                          02S0797 02042000
         BNZ   @RF00797                                         02S0797 02043000
*       DO;                         /* THEN SET ERROR FLAG AND STOP. */ 02044000
*         APESCODE=CERRN25;         /* ERROR NUMBER                  */ 02045000
         MVI   APESCODE,X'19'                                   02S0799 02046000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       02047000
*                                      PASS CONTROL TO THE (E)STAE OR   02048000
*                                      FRR EXIT ROUTINE.             */ 02049000
*           DO;                     /* ABEND(APCTABND)               */ 02050000
*             RESPECIFY                                         02S0802 02051000
*              (GPR01F) RESTRICTED;                             02S0802 02052000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 02053000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0803 02054000
*             SVC(13);              /* ISSUE ABEND SVC               */ 02055000
         SVC   13                                               02S0804 02056000
*             RESPECIFY                                         02S0805 02057000
*              (GPR01F) UNRESTRICTED;                           02S0805 02058000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 02059000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S0807 02060000
*                                                  /* NO CODE           02061000
*         END;                      /* ABEND ISSUED                  */ 02062000
*       END;                        /* ERROR PROCESSED               */ 02063000
*     APRLAPIO=DAPIOCT0;            /* SAVE APDX INDEX IN FAKE APRL. */ 02064000
@RF00797 L     @15,DAPRLXPT                                     02S0810 02065000
         L     @14,DAPIOCT0                                     02S0810 02066000
         ST    @14,APRLAPIO(,@15)                               02S0810 02067000
*     APRLXIO=BON;                  /* SHOW APRLAPIO INDEX VALID.    */ 02068000
         OI    APRLXIO(@15),B'00000100'                         02S0811 02069000
*   END;                            /* END OF CODE SEGMENT           */ 02070000
         EJECT                                                          02071000
*                                                               01S0813 02072000
*   /*****************************************************************/ 02073000
*   /*                                                               */ 02074000
*   /* ACQUIRE STORAGE FOR FINAL COPY OF CONTROL BLOCKS              */ 02075000
*   /*                                                               */ 02076000
*   /*****************************************************************/ 02077000
*                                                               01S0813 02078000
*   DO;                             /* START OF CODE SEGMENT         */ 02079000
*                                                               02S0813 02080000
*     /***************************************************************/ 02081000
*     /*                                                             */ 02082000
*     /* ACQUIRE STORAGE FOR PERMANENT COPY OF THE CCWS, IDALS, APXLS*/ 02083000
*     /* AND VSLS. IF THE TOTAL REQUIRED STORAGE IS LESS THAN 1 PAGE,*/ 02084000
*     /* ATTEMPT TO ACQUIRE THE STORAGE FROM AN EXISTING PAGE. IF    */ 02085000
*     /* THIS FAILS OR THE REQUIREMENTS EXCEED A PAGE, ISSUE THE     */ 02086000
*     /* GETMAIN WITH PAGE ALIGNMENT SPECIFIED.                      */ 02087000
*     /*                                                             */ 02088000
*     /***************************************************************/ 02089000
*                                                               02S0814 02090000
*     APIOGMAD=0;                   /* INSURE STORAGE ADDR 0         */ 02091000
         LA    @15,DAPIO                                        02S0814 02092000
         SLR   @14,@14                                          02S0814 02093000
         ST    @14,APIOGMAD(,@15)                               02S0814 02094000
*     DRCGM2=BON;                   /* SHOW STORAGE MUST BE FREED       02095000
*                                      DURING RECOVERY PROCESSING    */ 02096000
*                                                               02S0815 02097000
         OI    DRCGM2,B'01000000'                               02S0815 02098000
*     /***************************************************************/ 02099000
*     /*                                                             */ 02100000
*     /* BUILD IGTUAG CONTROL BLOCK                                  */ 02101000
*     /*                                                             */ 02102000
*     /***************************************************************/ 02103000
*                                                               02S0816 02104000
*     RFY                                                       02S0816 02105000
*      (R1P) RSTD;                  /* INTERFACE REGISTER            */ 02106000
*     R1P=ADDR(DAPGF);              /* POINT TO IGTUAG INPUT         */ 02107000
         LA    R1P,DAPGF                                        02S0817 02108000
*     RFY                                                       02S0818 02109000
*       APGF BASED(R1P);            /* TELL THE COMPILER             */ 02110000
*     APGF=APGF&&APGF;              /* CLEAR UNUSED FIELDS           */ 02111000
         XC    APGF(16,R1P),APGF(R1P)                           02S0819 02112000
*     APGFXSP=APXLSP;               /* SUBPOOL REQUIRED              */ 02113000
         MVI   APGFXSP(R1P),X'E6'                               02S0820 02114000
*     APGFXKEY=APXLKEY;             /* KEY                           */ 02115000
         MVI   APGFXKEY(R1P),X'05'                              02S0821 02116000
*     APGFSUNC=BON;                 /* UNCONDITIONAL GETMAIN         */ 02117000
*     APGFSLCK=BON;                 /* SHOW LOCAL LOCK OWNED         */ 02118000
*     APGFSINL=BON;                 /* USE INDIRECT POINTERS FOR     */ 02119000
*     APGFSINA=BON;                 /* LENGTH AND ADDRESS. USED BY      02120000
*                                      RECOVERY.                     */ 02121000
*     APGFSTCB=BON;                 /* ASSOCIATE STORAGE WITH        */ 02122000
         OI    APGFSUNC(R1P),B'11001110'                        02S0826 02123000
*     APGFTCB=DEBTCBB;              /* TCB WHICH OPENED THE ACB.     */ 02124000
         L     @00,DEBTCBB-1(,DDEBPTR)                          02S0827 02125000
         ICM   @00,8,@CB01727                                   02S0827 02126000
         ST    @00,APGFTCB(,R1P)                                02S0827 02127000
*     APGFXADR=ADDR(APIOGMAD);      /* SAVE ADDRESS HERE             */ 02128000
         LA    @09,APIOGMAD(,@15)                               02S0828 02129000
         ST    @09,APGFXADR(,R1P)                               02S0828 02130000
*     APGFXLN=ADDR(APIOGMSZ);       /* SAVE LENGTH HERE              */ 02131000
         LA    @09,APIOGMSZ(,@15)                               02S0829 02132000
         ST    @09,APGFXLN(,R1P)                                02S0829 02133000
*     APIOGMSZ=DCCWSZ+              /* NEED STORAGE FOR CHANNEL PGM, */ 02134000
*         ((DIDALSZ+7)&'FFFFFFF8'X)+/* IDALS FOR INDIRECT I/O        */ 02135000
*         DAPXLSZ+                  /* APXL ENTRIES FOR V->R CONVERT,*/ 02136000
*         DVSLSZ+                   /* & VSL ENTRIES FOR PGFIX/PGFREE*/ 02137000
*         DEXTVSL+                  /* ALSO NEED SPACE FOR RE-TRANS  */ 02138000
*         DEXTAPXL;                 /* APXL & VSL ENTRIES.   @ZA26916*/ 02139000
*                                                               02S0830 02140000
         LA    @09,7                                            02S0830 02141000
         AL    @09,DIDALSZ                                      02S0830 02142000
         N     @09,@CF04017                                     02S0830 02143000
         AL    @09,DCCWSZ                                       02S0830 02144000
         AL    @09,DAPXLSZ                                      02S0830 02145000
         AL    @09,DVSLSZ                                       02S0830 02146000
         AL    @09,DEXTVSL                                      02S0830 02147000
         ALR   @09,DEXTAPXL                                     02S0830 02148000
         ST    @09,APIOGMSZ(,@15)                               02S0830 02149000
*     /***************************************************************/ 02150000
*     /*                                                             */ 02151000
*     /* OBTAIN THE REQUIRED STORAGE                                 */ 02152000
*     /*                                                             */ 02153000
*     /***************************************************************/ 02154000
*                                                               02S0831 02155000
*     IF APIOGMSZ<CPGSIZE THEN      /* IF LESS THAN 1 PAGE           */ 02156000
         C     @09,@CF03922                                     02S0831 02157000
         BNL   @RF00831                                         02S0831 02158000
*       DO;                         /* REQUESTED, TRY EXISTING PAGE  */ 02159000
*         APESCODE=CERRN20;         /* ERROR CODE IF GETMAIN FAILS   */ 02160000
         MVI   APESCODE,X'14'                                   02S0833 02161000
*         CALL APCVZUAG;            /* FOR THE ALLOCATION.           */ 02162000
         L     @15,APCTZUAG(,APCTPTR)                           02S0834 02163000
         BALR  @14,@15                                          02S0834 02164000
*         APESCODE=CERRN99;         /* RESET ERROR CODE              */ 02165000
         MVI   APESCODE,X'21'                                   02S0835 02166000
*         IF(APIOGMAD&CRNDPGDN)=    /* SEE IF ACQUIRED STORAGE IN    */ 02167000
*             ((APIOGMAD+APIOGMSZ-1)&CRNDPGDN) THEN/* ONE PAGE. IF      02168000
*                                      SO,                           */ 02169000
         L     @09,@CF03929                                     02S0836 02170000
         LA    @15,DAPIO                                        02S0836 02171000
         L     @14,APIOGMAD(,@15)                               02S0836 02172000
         LR    @00,@14                                          02S0836 02173000
         NR    @00,@09                                          02S0836 02174000
         AL    @14,APIOGMSZ(,@15)                               02S0836 02175000
         BCTR  @14,0                                            02S0836 02176000
         NR    @14,@09                                          02S0836 02177000
         CR    @00,@14                                          02S0836 02178000
         BE    @RT00836                                         02S0836 02179000
*           GOTO PGETST01;          /* SKIP FURTHER PROCESSING.      */ 02180000
*         APGFSFRE=BON;             /* IF SPANS PAGES, FREE THE      */ 02181000
         OI    APGFSFRE(R1P),B'00000001'                        02S0838 02182000
*         APESCODE=CERRN16;         /* ERROR CODE IF FREEMAIN FAILS  */ 02183000
         MVI   APESCODE,X'10'                                   02S0839 02184000
*         CALL APCVZUAG;            /* STORAGE AND FORCE PAGE ALIGN. */ 02185000
         L     @15,APCTZUAG(,APCTPTR)                           02S0840 02186000
         BALR  @14,@15                                          02S0840 02187000
*         APESCODE=CERRN99;         /* RESET ERROR CODE              */ 02188000
         MVI   APESCODE,X'21'                                   02S0841 02189000
*         APGFSFRE=BOFF;            /* RESET FREEMAIN SWITCH.        */ 02190000
         NI    APGFSFRE(R1P),B'11111110'                        02S0842 02191000
*       END;                        /* NON-PAGE ALIGNED TRIED.       */ 02192000
*     APGFSPGE=BON;                 /* PAGE BOUNDARY WANTED          */ 02193000
@RF00831 OI    APGFSPGE(R1P),B'00010000'                        02S0844 02194000
*     APESCODE=CERRN20;             /* GETMAIN FAILURE CODE          */ 02195000
         MVI   APESCODE,X'14'                                   02S0845 02196000
*     CALL APCVZUAG;                /* ISSUE GETMAIN                 */ 02197000
         L     @15,APCTZUAG(,APCTPTR)                           02S0846 02198000
         BALR  @14,@15                                          02S0846 02199000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 02200000
         MVI   APESCODE,X'21'                                   02S0847 02201000
*PGETST01:                          /* STORAGE ACQUIRED              */ 02202000
*                                                               02S0848 02203000
*     /***************************************************************/ 02204000
*     /*                                                             */ 02205000
*     /* STORAGE ACQUIRED. DIVIDE STORAGE AMONG REQUIRED CONTROL     */ 02206000
*     /* BLOCKS. ALSO CALCULATE THE SIGNED QUANTITY TO BE ADDED TO   */ 02207000
*     /* ADDRESSES TO CONVERT FROM TEMPORARY STORAGE BLOCKS TO REAL  */ 02208000
*     /* STORAGE BLOCKS.                                             */ 02209000
*     /*                                                             */ 02210000
*     /***************************************************************/ 02211000
*                                                               02S0848 02212000
*     R1P=APIOGMAD;                 /* ADDRESS ACQUIRED STORAGE      */ 02213000
PGETST01 LA    @09,DAPIO                                        02S0848 02214000
         L     R1P,APIOGMAD(,@09)                               02S0848 02215000
*     RFY                                                       02S0849 02216000
*       APGF;                       /* DONE WITH APGF.               */ 02217000
*     DCCWACT=R1P;                  /* BEGINNING OF CCWS             */ 02218000
         ST    R1P,DCCWACT                                      02S0850 02219000
*     DCCWDIF=R1P-DCCWBEG;          /* CONVERSION VALUE              */ 02220000
         LR    @09,R1P                                          02S0851 02221000
         SL    @09,DCCWBEG                                      02S0851 02222000
         ST    @09,DCCWDIF                                      02S0851 02223000
*     R1P=R1P+DCCWSZ;               /* SKIP CCW AREA                 */ 02224000
         AL    R1P,DCCWSZ                                       02S0852 02225000
*     DIDALACT=R1P;                 /* BEGINNING OF IDAL ENTRIES     */ 02226000
         ST    R1P,DIDALACT                                     02S0853 02227000
*     DIDALDIF=R1P-DIDALBEG;        /* CONVERSION VALUE              */ 02228000
         LR    @09,R1P                                          02S0854 02229000
         SL    @09,DIDALBEG                                     02S0854 02230000
         ST    @09,DIDALDIF                                     02S0854 02231000
*     R1P=R1P+((DIDALSZ+7)&'FFFFFFF8'X);/* SKIP IDAL AREA            */ 02232000
         LA    @09,7                                            02S0855 02233000
         AL    @09,DIDALSZ                                      02S0855 02234000
         N     @09,@CF04017                                     02S0855 02235000
         ALR   R1P,@09                                          02S0855 02236000
*     DAPXLACT=R1P;                 /* BEGINNING OF APXL ENTRIES     */ 02237000
         ST    R1P,DAPXLACT                                     02S0856 02238000
*     DAPXLDIF=R1P-DAPXLBEG;        /* CONVERSION VALUE              */ 02239000
         LR    @09,R1P                                          02S0857 02240000
         SL    @09,DAPXLBEG                                     02S0857 02241000
         ST    @09,DAPXLDIF                                     02S0857 02242000
*     R1P=R1P+DAPXLSZ+DEXTAPXL;     /* SKIP APXL AREA        @ZA26916   02243000
*                                      (ALSO RE-TRANSLATE ENTRIES)   */ 02244000
         LR    @09,R1P                                          02S0858 02245000
         AL    @09,DAPXLSZ                                      02S0858 02246000
         ALR   @09,DEXTAPXL                                     02S0858 02247000
         LR    R1P,@09                                          02S0858 02248000
*     DVSLACT=R1P;                  /* BEGINNING OF VSL ENTRIES      */ 02249000
         ST    R1P,DVSLACT                                      02S0859 02250000
*     DVSLDIF=R1P-DVSLBEG;          /* CONVERSION VALUE              */ 02251000
         LR    @09,R1P                                          02S0860 02252000
         SL    @09,DVSLBEG                                      02S0860 02253000
         ST    @09,DVSLDIF                                      02S0860 02254000
*     RFY                                                       02S0861 02255000
*       R1P UNRSTD;                 /* FINISHED WITH REGISTER        */ 02256000
*   END;                            /* PERMANENT STORAGE ACQUIRED    */ 02257000
         EJECT                                                          02258000
*                                                               01S0863 02259000
*   /*****************************************************************/ 02260000
*   /*                                                               */ 02261000
*   /* MOVE CONTROL BLOCKS FROM TEMPORARY STORAGE TO PERMANENT       */ 02262000
*   /* STORAGE LOCATIONS                                             */ 02263000
*   /*                                                               */ 02264000
*   /*****************************************************************/ 02265000
*                                                               01S0863 02266000
*   DO;                             /* START OF CODE SEGMENT         */ 02267000
*                                                               02S0863 02268000
*     /***************************************************************/ 02269000
*     /*                                                             */ 02270000
*     /* MOVE CCWS, IDALS, APXL AND VSLS FROM TEMPORARY STORAGE TO   */ 02271000
*     /* PERMANENT LOCATIONS. ALSO MODIFY POINTERS TO THESE TEMPORARY*/ 02272000
*     /* AREAS TO POINT TO THE REAL CONTROL BLOCKS.                  */ 02273000
*     /*                                                             */ 02274000
*     /***************************************************************/ 02275000
*                                                               02S0864 02276000
*                                                               02S0864 02277000
*     /***************************************************************/ 02278000
*     /*                                                             */ 02279000
*     /* USE MVCL TO MOVE EACH CONTROL BLOCK                         */ 02280000
*     /*                                                             */ 02281000
*     /***************************************************************/ 02282000
*                                                               02S0864 02283000
*     RFY                                                       02S0864 02284000
*       DXXXXBLK BASED(DXXXXPTR);   /* SCAN POINTER                  */ 02285000
*     DO DXXXXPTR=ADDR(DCCWBLK) TO ADDR(DVSLBLK)/* PROCESS EACH      */ 02286000
*           BY LENGTH(DXXXXBLK);    /* BLOCK TYPE                    */ 02287000
         LA    DXXXXPTR,DCCWBLK                                 02S0865 02288000
         B     @DE00865                                         02S0865 02289000
@DL00865 DS    0H                                               02S0866 02290000
*       RFY                                                     02S0866 02291000
*        (R0P,                                                  02S0866 02292000
*         R14P,                                                 02S0866 02293000
*         R1F,                                                  02S0866 02294000
*         R15F) RSTD;               /* MVCL REGISTERS                */ 02295000
*       R0P=DXXXXBEG;               /* FROM ADDRESS                  */ 02296000
         L     R0P,DXXXXBEG(,DXXXXPTR)                          02S0867 02297000
*       R1F=DXXXXSZ;                /* MOVE LENGTH                   */ 02298000
         L     R1F,DXXXXSZ(,DXXXXPTR)                           02S0868 02299000
*       R14P=DXXXXACT;              /* TO ADDRESS                    */ 02300000
         L     R14P,DXXXXACT(,DXXXXPTR)                         02S0869 02301000
*       R15F=R1F;                   /* MOVE LENGTH                   */ 02302000
         LR    R15F,R1F                                         02S0870 02303000
*       MVCL(R14P,R0P);             /* MOVE IT                       */ 02304000
         MVCL  R14P,R0P                                         02S0871 02305000
*       RFY                                                     02S0872 02306000
*        (R0P,                                                  02S0872 02307000
*         R14P,                                                 02S0872 02308000
*         R1F,                                                  02S0872 02309000
*         R15F) UNRSTD;             /* FINISHED WITH REGISTERS       */ 02310000
*     END;                          /* DO ALL BLOCKS                 */ 02311000
         AL    DXXXXPTR,@CF01967                                02S0873 02312000
@DE00865 LA    @09,DVSLBLK                                      02S0873 02313000
         CR    DXXXXPTR,@09                                     02S0873 02314000
         BNH   @DL00865                                         02S0873 02315000
*     RFY                                                       02S0874 02316000
*       DXXXXBLK;                   /* NO LONGER ADDRESSED           */ 02317000
*                                                               02S0874 02318000
*     /***************************************************************/ 02319000
*     /*                                                             */ 02320000
*     /* CHANGE APXL ENTRIES TO POINT TO REAL COPIES OF THE CONTROL  */ 02321000
*     /* BLOCKS JUST BUILT.                                          */ 02322000
*     /*                                                             */ 02323000
*     /***************************************************************/ 02324000
*                                                               02S0875 02325000
*     STM(R0F,R15F,DSUPVSVE);       /* SAVE REGISTERS OVER THIS RTN  */ 02326000
         STM   R0F,R15F,DSUPVSVE                                02S0875 02327000
*     RFY                                                       02S0876 02328000
*      (R0F,                                                    02S0876 02329000
*       R1P,                                                    02S0876 02330000
*       R14F,                                                   02S0876 02331000
*       R15P,                                                   02S0876 02332000
*       R2P,                                                    02S0876 02333000
*       R3P,                                                    02S0876 02334000
*       R4P) RSTD;                  /* BXLE REGS & COMP.             */ 02335000
*                                                               02S0876 02336000
*     /***************************************************************/ 02337000
*     /*                                                             */ 02338000
*     /* BUILD BXLE REGISTERS                                        */ 02339000
*     /*                                                             */ 02340000
*     /***************************************************************/ 02341000
*                                                               02S0877 02342000
*     R0F=LENGTH(APXLADDV);         /* DELTA FOR APXL ENTRIES        */ 02343000
         LA    R0F,4                                            02S0877 02344000
*     R1P=DAPXLACT+DAPXLSZ-R0F;     /* LAST APXL ENTRY ADDRESS       */ 02345000
         L     @09,DAPXLACT                                     02S0878 02346000
         LR    R1P,@09                                          02S0878 02347000
         AL    R1P,DAPXLSZ                                      02S0878 02348000
         SLR   R1P,R0F                                          02S0878 02349000
*     R2P=DAPXLACT+APXLLN0;         /* FIRST APXL ADDRESS (SKIP HDR) */ 02350000
         LA    @09,24(,@09)                                     02S0879 02351000
         LR    R2P,@09                                          02S0879 02352000
*     R14F=LENGTH(DXXXXBLK);        /* DELTA FOR DXXXXBLK            */ 02353000
         LA    R14F,28                                          02S0880 02354000
*     R15P=ADDR(DVSLBLK);           /* LAST DXXXXBLK ADDRESS         */ 02355000
*                                                               02S0881 02356000
         LA    R15P,DVSLBLK                                     02S0881 02357000
*     /***************************************************************/ 02358000
*     /*                                                             */ 02359000
*     /* SCAN ALL APXL ENTRIES (BOTH ADDRESSES)                      */ 02360000
*     /*                                                             */ 02361000
*     /***************************************************************/ 02362000
*                                                               02S0882 02363000
*     DO;                           /* COPYBLK1 BXLE                 */ 02364000
*COPYBLK1:                          /* BXLE RETRY POINT              */ 02365000
*       R4P=R2P->APXLADVB;          /* VALUE TO CONVERT (APXLADVB OR    02366000
*                                      APXLADLB).                    */ 02367000
*                                                               02S0883 02368000
COPYBLK1 L     R4P,APXLADVB-1(,R2P)                             02S0883 02369000
         LA    R4P,0(,R4P)                                      02S0883 02370000
*       /*************************************************************/ 02371000
*       /*                                                           */ 02372000
*       /* SCAN DXXXXBLK ENTRIES. IF THE ADDRESS IN R4P POINTS TO A  */ 02373000
*       /* MOVED CONTROL BLOCK, CHANGE THE ADDRESS SAVED IN THE APXL */ 02374000
*       /* ENTRY (LOW THREE BYTES ONLY).                             */ 02375000
*       /*                                                           */ 02376000
*       /*************************************************************/ 02377000
*                                                               02S0884 02378000
*       R3P=ADDR(DCCWBLK);          /* FIRST BLOCK TO CHECK          */ 02379000
         LA    R3P,DCCWBLK                                      02S0884 02380000
*       RFY                                                     02S0885 02381000
*         DXXXXBLK BASED(R3P);                                  02S0885 02382000
*       DO;                         /* COPYBLK2 BXLE                 */ 02383000
*COPYBLK2:                          /* BXLE RETRY                    */ 02384000
*         IF R4P>=DXXXXBEG&         /* IF APXL POINTS TO TEMPORARY   */ 02385000
*             R4P<DXXXXEND THEN     /* CONTROL BLOCK, THEN ADD       */ 02386000
COPYBLK2 C     R4P,DXXXXBEG(,R3P)                               02S0887 02387000
         BL    @RF00887                                         02S0887 02388000
         C     R4P,DXXXXEND(,R3P)                               02S0887 02389000
         BNL   @RF00887                                         02S0887 02390000
*           DO;                     /* DIFFERENCE VALUE TO FORCE     */ 02391000
*             R2P->APXLADVB=        /* POINTER TO NEW CONTROL BLOCK  */ 02392000
*                 R4P+DXXXXDIF;     /* (MAY BE APXLADVB OR APXLADLB).*/ 02393000
         LR    @09,R4P                                          02S0889 02394000
         AL    @09,DXXXXDIF(,R3P)                               02S0889 02395000
         STCM  @09,7,APXLADVB(R2P)                              02S0889 02396000
*             GOTO COPYBLK3;        /* NOTE: MUST ONLY CHANGE        */ 02397000
         B     COPYBLK3                                         02S0890 02398000
*           END;                    /* LOW-ORDER THREE BYTES.        */ 02399000
*         GEN(BXLE R3P,R14F,COPYBLK2)/* CONTINUE SCAN IF NO MATCH    */ 02400000
*         REFS(R14F,R15P)           /* FOR THIS CONTROL BLOCK.       */ 02401000
*             SETS(R3P) FLOWS(COPYBLK2) SEQFLOW;                02S0892 02402000
@RF00887 DS    0H                                               02S0892 02403000
         BXLE R3P,R14F,COPYBLK2                                         02404000
*       END;                        /* COPYBLK2 BXLE END             */ 02405000
*       RFY                                                     02S0894 02406000
*         DXXXXBLK;                 /* FINISHED WITH POINTER         */ 02407000
*                                                               02S0894 02408000
*       /*************************************************************/ 02409000
*       /*                                                           */ 02410000
*       /* APXL ADDRESS MODIFIED IF REQUIRED. DO NEXT APXL VALUE.    */ 02411000
*       /*                                                           */ 02412000
*       /*************************************************************/ 02413000
*                                                               02S0895 02414000
*COPYBLK3:                          /* APXL MODIFIED BRANCH POINT    */ 02415000
*       GEN(BXLE  R2P,R0F,COPYBLK1) /* CONTINUE MODIFICATION         */ 02416000
*       REFS(R0F,R1P)               /* USING NEXT APXL ADDRESS.      */ 02417000
*           SETS(R2P)               /* DO UNTIL ALL ENTRIES          */ 02418000
*           FLOWS(COPYBLK1)         /* HAVE BEEN PROCESSED.          */ 02419000
*           SEQFLOW;                                            02S0895 02420000
COPYBLK3 BXLE  R2P,R0F,COPYBLK1                                         02421000
*     END;                          /* COPYBLK1 BXLE END             */ 02422000
*                                                               02S0896 02423000
*     /***************************************************************/ 02424000
*     /*                                                             */ 02425000
*     /* ALL ENTRIES CONVERTED.                                      */ 02426000
*     /*                                                             */ 02427000
*     /***************************************************************/ 02428000
*                                                               02S0897 02429000
*     RFY                                                       02S0897 02430000
*      (R0F,                                                    02S0897 02431000
*       R1P,                                                    02S0897 02432000
*       R14F,                                                   02S0897 02433000
*       R15P,                                                   02S0897 02434000
*       R2P,                                                    02S0897 02435000
*       R3P,                                                    02S0897 02436000
*       R4P) UNRSTD;                /* DONE WITH REGS.               */ 02437000
*     LM(R0F,R15F,DSUPVSVE);        /* RELOAD REGISTERS              */ 02438000
*                                                               02S0898 02439000
         LM    R0F,R15F,DSUPVSVE                                02S0898 02440000
*     /***************************************************************/ 02441000
*     /*                                                             */ 02442000
*     /* UPDATE THE INITIAL VSL ENTRY TO REFLECT THE CHANNEL PROGRAM */ 02443000
*     /* AND THE ASSOCIATED IDALS.                                   */ 02444000
*     /*                                                             */ 02445000
*     /***************************************************************/ 02446000
*                                                               02S0899 02447000
*     DVSLACT->VSLSTRTA=DCCWACT;    /* FIX START OF CHANNEL PGM      */ 02448000
         L     @09,DCCWACT                                      02S0899 02449000
         L     @04,DVSLACT                                      02S0899 02450000
         STCM  @09,7,VSLSTRTA(@04)                              02S0899 02451000
*     DVSLACT->VSLEND1A=DAPXLACT;   /* THROUGH END OF IDALS          */ 02452000
*                                                               02S0900 02453000
         L     @15,DAPXLACT                                     02S0900 02454000
         STCM  @15,7,VSLEND1A(@04)                              02S0900 02455000
*     /***************************************************************/ 02456000
*     /*                                                             */ 02457000
*     /* UPDATE THE APIO (INCLUDES THE IOSB AND THE SRB) TO REFLECT  */ 02458000
*     /* THE ACTUAL CHANNEL PROGRAM LOCATION.                        */ 02459000
*     /*                                                             */ 02460000
*     /***************************************************************/ 02461000
*                                                               02S0901 02462000
*     RFY                                                       02S0901 02463000
*       RAPIOPTR RSTD;              /* USE REGISTER POINTER TO       */ 02464000
*     RAPIOPTR=ADDR(DAPIO);         /* THE APIO TO IMPROVE GENERATED */ 02465000
         LA    @14,DAPIO                                        02S0902 02466000
         LR    RAPIOPTR,@14                                     02S0902 02467000
*     RFY                                                       02S0903 02468000
*       APIO BASED(RAPIOPTR);       /* PL/S CODE.                    */ 02469000
*     IOSVST=DCCWACT+LENGTH(PROCDATA);/* CHANNEL PGM ADDR            */ 02470000
         LA    @02,8                                            02S0904 02471000
         ALR   @09,@02                                          02S0904 02472000
         ST    @09,IOSVST(,RAPIOPTR)                            02S0904 02473000
*     APIOCCW=IOSVST;               /* CHANNEL PGM ADDR              */ 02474000
         ST    @09,APIOCCW(,RAPIOPTR)                           02S0905 02475000
*     APIOPGFX=DVSLACT;             /* FIRST VSL ENTRY               */ 02476000
         ST    @04,APIOPGFX(,RAPIOPTR)                          02S0906 02477000
*     APIOPGFL=DVSLACT+DVSLSZ-LENGTH(VSL);/* LAST VSL ENTRY          */ 02478000
         AL    @04,DVSLSZ                                       02S0907 02479000
         SLR   @04,@02                                          02S0907 02480000
         ST    @04,APIOPGFL(,RAPIOPTR)                          02S0907 02481000
*     APIOAPXL=DAPXLACT;            /* ADDRESS OF APXL TABLE         */ 02482000
         ST    @15,APIOAPXL(,RAPIOPTR)                          02S0908 02483000
*     APIOGMSP=APXLSP;              /* APIOGMAD SUBPOOL      @ZA26916*/ 02484000
         MVI   APIOGMSP(RAPIOPTR),X'E6'                         02S0909 02485000
*     RFY                                                       02S0910 02486000
*       APIO BASED(ADDR(DAPIO));    /* FINISHED WITH APIO UPDATE.    */ 02487000
*     RFY                                                       02S0911 02488000
*       RAPIOPTR UNRSTD;            /* RELEASE REGISTER POINTER      */ 02489000
*     DAPXLACT->APXLLAST=DAPXLACT+  /* ADDRESS OF LAST APXL ENTRY    */ 02490000
*         DAPXLSZ-APXLLN1-          /* MINUS LENGTH OF HEADER.       */ 02491000
*         APXLLN0;                  /* USED IN BXLE TO CONVERT V->R. */ 02492000
         L     @09,DAPXLSZ                                      02S0912 02493000
         LR    @04,@15                                          02S0912 02494000
         ALR   @04,@09                                          02S0912 02495000
         SL    @04,@CF00126                                     02S0912 02496000
         ST    @04,APXLLAST(,@15)                               02S0912 02497000
*   END;                            /* FINAL CONTROL BLOCKS BUILT.   */ 02498000
*                                                               02S0913 02499000
*   /*****************************************************************/ 02500000
*   /*                                                               */ 02501000
*   /* IF RE-TRANSLATION REQUESTED (APIORXLT+1),             @ZA26916*/ 02502000
*   /* UPDATE REQUIRED POINTERS TO THE NEW BLOCKS.           @ZA26916*/ 02503000
*   /*                                                               */ 02504000
*   /*****************************************************************/ 02505000
*                                                               02S0914 02506000
*   IF APIORXLT=BON THEN            /* IF RETRANSLATION REQUESTED,   */ 02507000
         TM    APIORXLT(@14),B'00010000'                        02S0914 02508000
         BNO   @RF00914                                         02S0914 02509000
*     DO;                           /* THEN UPDATE POINTERS  @ZA26916*/ 02510000
*       APIOPGFF=APIOPGFL+LENGTH(VSL);/* 1ST FREE VSL ENTRY          */ 02511000
         AL    @02,APIOPGFL(,@14)                               02S0916 02512000
         ST    @02,APIOPGFF(,@14)                               02S0916 02513000
*       DAPXLACT->APXLFREE=DAPXLSZ+DAPXLACT;/* 1ST FREE APXL         */ 02514000
         ALR   @09,@15                                          02S0917 02515000
         ST    @09,APXLFREE(,@15)                               02S0917 02516000
*       DAPXLACT->APXLIDAL=DAPXLACT->APXLIDAL/* 1ST IDAL POINTER     */ 02517000
*           +DAPXLDIF;              /* FOR RE-TRANSLATION            */ 02518000
         L     @09,APXLIDAL(,@15)                               02S0918 02519000
         AL    @09,DAPXLDIF                                     02S0918 02520000
         ST    @09,APXLIDAL(,@15)                               02S0918 02521000
*     END;                          /* POINTERS ADJUSTED FOR RE-TRANS*/ 02522000
         EJECT                                                          02523000
*                                                               01S0920 02524000
*   /*****************************************************************/ 02525000
*   /*                                                               */ 02526000
*   /* PAGE-FIX THE CONTROL BLOCKS IF REQUESTED.                     */ 02527000
*   /*                                                               */ 02528000
*   /*****************************************************************/ 02529000
*                                                               01S0920 02530000
*   DO;                             /* START OF CODE SEGMENT         */ 02531000
*                                                               02S0920 02532000
@RF00914 DS    0H                                               02S0921 02533000
*     /***************************************************************/ 02534000
*     /*                                                             */ 02535000
*     /* IF BUFFERS TO BE FIXED AT TRANSLATION TIME (APIOFXED=1),    */ 02536000
*     /* THEN ISSUE A LONG-TERM PAGE FIX FOR THE BUFFERS AND THE     */ 02537000
*     /* CHANNEL PROGRAM. THIS IS ACCOMPLISHED IN TWO STEPS: (1) FIX */ 02538000
*     /* THE VSL ENTRIES, (2) FIX THE PAGES POINTED TO BY THE VSL.   */ 02539000
*     /* NOTE: TO ISSUE A LIST FORM PGFIX, THE VSL MUST ITSELF BE    */ 02540000
*     /* FIXED.                                                      */ 02541000
*     /*                                                             */ 02542000
*     /***************************************************************/ 02543000
*                                                               02S0921 02544000
*     IF APIOFXED=BON THEN          /* PGFIX AT TRANSLATION ?        */ 02545000
         LA    @09,DAPIO                                        02S0921 02546000
         TM    APIOFXED(@09),B'10000000'                        02S0921 02547000
         BNO   @RF00921                                         02S0921 02548000
*       DO;                         /* YES -- THEN CONTINUE          */ 02549000
*                                                               02S0922 02550000
*         /***********************************************************/ 02551000
*         /*                                                         */ 02552000
*         /* PAGE FIX THE VSL ENTRIES                                */ 02553000
*         /*                                                         */ 02554000
*         /***********************************************************/ 02555000
*                                                               02S0923 02556000
*         RFY                                                   02S0923 02557000
*          (R0P,                                                02S0923 02558000
*           R1P,                                                02S0923 02559000
*           R2P,                                                02S0923 02560000
*           R4P) RSTD;              /* PGFIX REGISTERS               */ 02561000
*         DECB=0;                   /* ECB TO POST. CLEAR WAIT/POST  */ 02562000
         SLR   @03,@03                                          02S0924 02563000
         ST    @03,DECB                                         02S0924 02564000
*         R0P=ADDR(DECB);           /* ECB TO POST (NOT WAITED ON)   */ 02565000
         LA    R0P,DECB                                         02S0925 02566000
*         R1P=APIOPGFX|             /* START OF VSL ENTRIES          */ 02567000
*             '42000000'X;          /* SHOW PGFIX + LONG-TERM,  02S0926 02568000
*                                      REGISTER FORMAT (BIT0=0).     */ 02569000
         L     R1P,APIOPGFX(,@09)                               02S0926 02570000
         O     R1P,@CF04034                                     02S0926 02571000
*         R2P=APIOPGFL+LENGTH(VSL)| /* END OF VSL ENTRIES + 1        */ 02572000
*             '80000000'X;          /* ALSO SHOW END-OF-LIST         */ 02573000
         LA    R2P,8                                            02S0927 02574000
         AL    R2P,APIOPGFL(,@09)                               02S0927 02575000
         O     R2P,@CF04035                                     02S0927 02576000
*         R4P=SRBPTCB;              /* TCB WHICH OPENED ACB.         */ 02577000
         L     R4P,SRBPTCB+128(,@09)                            02S0928 02578000
*         APESCODE=CERRN15;         /* PGFIX ERROR CODE              */ 02579000
         MVI   APESCODE,X'0F'                                   02S0929 02580000
*         GEN(MODESET EXTKEY=ZERO)                              02S0930 02581000
*         NOREFS NOSETS;            /* PSI REQUIRES KEY-0            */ 02582000
         MODESET EXTKEY=ZERO                                            02583000
*         CALL IEAVPSI;             /* FIX REQUIRED PAGES            */ 02584000
         L     @09,CVTPTR                                       02S0931 02585000
         L     @15,CVTVPSIB(,@09)                               02S0931 02586000
         BALR  @14,@15                                          02S0931 02587000
*         RFY                                                   02S0932 02588000
*          (R0P,                                                02S0932 02589000
*           R4P) UNRSTD;            /* KEEP VSL POINTERS             */ 02590000
*         RFY                                                   02S0933 02591000
*          (R15F) RSTD;             /* PSI RETURN CODE               */ 02592000
*         GEN(MODESET EXTKEY=DATAMGT)                           02S0934 02593000
*         NOREFS NOSETS;            /* RESUME NORMAL KEY             */ 02594000
         MODESET EXTKEY=DATAMGT                                         02595000
*         APESCODE=CERRN99;         /* RESET ERROR CODE              */ 02596000
         MVI   APESCODE,X'21'                                   02S0935 02597000
*         IF R15F=CPGFIXIP THEN     /* IF PAGE-IN IN PROGRESS        */ 02598000
         C     R15F,@CF00037                                    02S0936 02599000
         BNE   @RF00936                                         02S0936 02600000
*           DO;                     /* REFERENCE PAGES TO FORCE IN.  */ 02601000
*             RFY                                               02S0938 02602000
*               R15F UNRSTD;        /* DONOT NEED RETURN CODE NOW    */ 02603000
*             DRCPF1=BON;           /* SHOW PGFREE REQUIRED DURING      02604000
*                                      RECOVERY                      */ 02605000
         OI    DRCPF1,B'00001000'                               02S0939 02606000
*             R1P=R1P&CRNDPGDN;     /* ROUND START ADDR TO PAGE BNDRY*/ 02607000
         L     @09,@CF03929                                     02S0940 02608000
         NR    R1P,@09                                          02S0940 02609000
*             R2P=(R2P+CRNDPGUP)&   /* ROUND ENDING ADDRESS UP       */ 02610000
*                 CRNDPGDN;         /* TO PAGE BOUNDARY.             */ 02611000
         LA    @04,4095                                         02S0941 02612000
         ALR   @04,R2P                                          02S0941 02613000
         NR    @04,@09                                          02S0941 02614000
         LR    R2P,@04                                          02S0941 02615000
*             DO UNTIL(R1P=R2P);    /* REFERENCE ALL PAGES           */ 02616000
@DL00942 DS    0H                                               02S0943 02617000
*               APESCODE=CERRN15;   /* SET ERROR CODE                */ 02618000
         MVI   APESCODE,X'0F'                                   02S0943 02619000
*               GEN(CLI   0(R1P),*-*)                           02S0944 02620000
*               NOSETS REFS(R1P);   /* PAGE FIXED AFTER INSTRUCTION  */ 02621000
         CLI   0(R1P),*-*                                               02622000
*               APESCODE=CERRN99;   /* RESET NORMAL ERROR CODE       */ 02623000
         MVI   APESCODE,X'21'                                   02S0945 02624000
*               R1P=R1P+CPGSIZE;    /* NEXT PAGE                     */ 02625000
         AL    R1P,@CF03922                                     02S0946 02626000
*             END;                  /* ALL PAGES NOW REFERENCED      */ 02627000
@DE00942 CR    R1P,R2P                                          02S0947 02628000
         BNE   @DL00942                                         02S0947 02629000
*             RFY                                               02S0948 02630000
*               R15F RSTD;          /* ACT LIKE RETURN CODE = 0      */ 02631000
*             R15F=0;               /* PGFIX COMPLETED OK            */ 02632000
         SLR   R15F,R15F                                        02S0949 02633000
*           END;                    /* STORAGE NOW FIXED             */ 02634000
*         RFY                                                   02S0951 02635000
*          (R1P,                                                02S0951 02636000
*           R2P) UNRSTD;            /* FINISHED WITH VSL POINTERS    */ 02637000
*                                                               02S0951 02638000
@RF00936 DS    0H                                               02S0952 02639000
*         /***********************************************************/ 02640000
*         /*                                                         */ 02641000
*         /* PAGE FIX COMPLETE OR ERROR DETECTED. CHECK REGISTER 15  */ 02642000
*         /* AND TERMINATE IF AN ERROR HAS BEEN DETECTED.            */ 02643000
*         /*                                                         */ 02644000
*         /***********************************************************/ 02645000
*                                                               02S0952 02646000
*         IF R15F^=0 THEN           /* IF PGFIX FAILED               */ 02647000
         LTR   R15F,R15F                                        02S0952 02648000
         BZ    @RF00952                                         02S0952 02649000
*           DO;                     /* (NON-ZERO RETURN CODE)        */ 02650000
*             APESCODE=CERRN15;     /* SET ERROR CODE                */ 02651000
         MVI   APESCODE,X'0F'                                   02S0954 02652000
*             DO;                   /* FORCE ABEND TO LOG ERROR &       02653000
*                                      PASS CONTROL TO THE (E)STAE OR   02654000
*                                      FRR EXIT ROUTINE.             */ 02655000
*               DO;                 /* ABEND(APCTABND)               */ 02656000
*                 RESPECIFY                                     02S0957 02657000
*                  (GPR01F) RESTRICTED;                         02S0957 02658000
*                 GPR01F=APCTABND;  /* COMP CODE IN REG 1            */ 02659000
         L     GPR01F,APCTABND(,APCTPTR)                        02S0958 02660000
*                 SVC(13);          /* ISSUE ABEND SVC               */ 02661000
         SVC   13                                               02S0959 02662000
*                 RESPECIFY                                     02S0960 02663000
*                  (GPR01F) UNRESTRICTED;                       02S0960 02664000
*               END;                /* ABEND(APCTABND) FORCE ABEND   */ 02665000
*               GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);    02S0962 02666000
*                                                  /* NO CODE           02667000
*             END;                  /* ABEND ISSUED                  */ 02668000
*           END;                    /* ERROR PROCESSED               */ 02669000
*         RFY                                                   02S0965 02670000
*           R15F UNRSTD;            /* FINISHED WITH RETURN CODE     */ 02671000
@RF00952 DS    0H                                               02S0966 02672000
*         DRCPF1=BON;               /* SHOW PGFREE REQUIRED DURING      02673000
*                                      RECOVERY PROCESSING.          */ 02674000
         OI    DRCPF1,B'00001000'                               02S0966 02675000
*         RFY                                                   02S0967 02676000
*          (R0P,                                                02S0967 02677000
*           R1P,                                                02S0967 02678000
*           R4P) RSTD;              /* PGFIX INPUT REGISTERS         */ 02679000
*         DECB=0;                   /* INITIALIZE THE PSI ECB        */ 02680000
         SLR   @09,@09                                          02S0968 02681000
         ST    @09,DECB                                         02S0968 02682000
*         R0P=ADDR(DECB);           /* ECB TO POST (NOT WAITED ON)   */ 02683000
         LA    R0P,DECB                                         02S0969 02684000
*         R1P=APIOPGFX|             /* POINT TO VSL LIST AND         */ 02685000
*             '80000000'X;          /* SHOW LIST (BIT0=1).           */ 02686000
         LA    @09,DAPIO                                        02S0970 02687000
         L     R1P,APIOPGFX(,@09)                               02S0970 02688000
         O     R1P,@CF04035                                     02S0970 02689000
*         R1P->VSLFLAG1='00'X;      /* SET OPTION BYTE               */ 02690000
         MVI   VSLFLAG1(R1P),X'00'                              02S0971 02691000
*         R1P->VSLFIX=BON;          /* TO SHOW LONG TERM             */ 02692000
*         R1P->VSLONG=BON;          /* PAGE FIX REQUEST.             */ 02693000
         OI    VSLFIX(R1P),B'01000010'                          02S0973 02694000
*         R4P=SRBPTCB;              /* TCB FOR FOE (DEBTCBB).        */ 02695000
         L     R4P,SRBPTCB+128(,@09)                            02S0974 02696000
*         APESCODE=CERRN15;         /* PGFIX ERROR CODE              */ 02697000
         MVI   APESCODE,X'0F'                                   02S0975 02698000
*         GEN(MODESET EXTKEY=ZERO)                              02S0976 02699000
*         NOREFS NOSETS;            /* PSI REQUIRES KEY-0            */ 02700000
         MODESET EXTKEY=ZERO                                            02701000
*         CALL IEAVPSI;             /* FIX REQUIRED PAGES            */ 02702000
         L     @09,CVTPTR                                       02S0977 02703000
         L     @15,CVTVPSIB(,@09)                               02S0977 02704000
         BALR  @14,@15                                          02S0977 02705000
*         RFY                                                   02S0978 02706000
*          (R0P,                                                02S0978 02707000
*           R1P,                                                02S0978 02708000
*           R4P) UNRSTD;            /* FINISHED WITH REGISTERS       */ 02709000
*         RFY                                                   02S0979 02710000
*          (R15F) RSTD;             /* PSI RETURN CODE               */ 02711000
*         GEN(MODESET EXTKEY=DATAMGT)                           02S0980 02712000
*         NOREFS NOSETS;            /* RESUME NORMAL KEY             */ 02713000
         MODESET EXTKEY=DATAMGT                                         02714000
*         APESCODE=CERRN99;         /* RESET ERROR CODE              */ 02715000
         MVI   APESCODE,X'21'                                   02S0981 02716000
*         IF R15F=CPGFIXIP THEN     /* IF PAGE-IN IN PROGRESS        */ 02717000
         C     R15F,@CF00037                                    02S0982 02718000
         BNE   @RF00982                                         02S0982 02719000
*           DO;                     /* REFERENCE PAGES TO FORCE IN.  */ 02720000
*             RFY                                               02S0984 02721000
*               R15F UNRSTD;        /* DONOT NEED RETURN CODE NOW    */ 02722000
*             DRCPF2=BON;           /* SHOW PGFREE REQUIRED IN  02S0985 02723000
*                                      RECOVERY PROCESSING           */ 02724000
         OI    DRCPF2,B'00000100'                               02S0985 02725000
*             RFY                                               02S0986 02726000
*               RVSLPTR RSTD;       /* VSL SCAN REGISTER             */ 02727000
*             RFY                                               02S0987 02728000
*               VSL BASED(RVSLPTR); /* TELL COMPILER OF POINTER      */ 02729000
*             DO RVSLPTR=APIOPGFX BY LENGTH(VSL)/* PROCESS ALL       */ 02730000
*                   TO APIOPGFL;    /* VSL ENTRIES.                  */ 02731000
         LA    @09,DAPIO                                        02S0988 02732000
         L     RVSLPTR,APIOPGFX(,@09)                           02S0988 02733000
         B     @DE00988                                         02S0988 02734000
@DL00988 DS    0H                                               02S0989 02735000
*               RFY                                             02S0989 02736000
*                (R1P,                                          02S0989 02737000
*                 R15P,                                         02S0989 02738000
*                 R14F) RSTD;       /* BXLE REGISTERS                */ 02739000
*               R1P=VSLSTRT&        /* ROUND STARTING ADDRESS DOWN   */ 02740000
*                   CRNDPGDN;       /* TO PAGE BOUNDARY              */ 02741000
         L     @09,@CF03929                                     02S0990 02742000
         L     R1P,VSLSTRT(,RVSLPTR)                            02S0990 02743000
         NR    R1P,@09                                          02S0990 02744000
*               R15P=(VSLEND&CRNDPGDN)/* SET ENDING ADDRESS TO LAST  */ 02745000
*                   -1;             /* BYTE OF THE LAST PAGE TO FIX. */ 02746000
         N     @09,VSLEND(,RVSLPTR)                             02S0991 02747000
         BCTR  @09,0                                            02S0991 02748000
         LR    R15P,@09                                         02S0991 02749000
*               R14F=CPGSIZE;       /* PAGE SIZE FOR BXLE.           */ 02750000
         L     R14F,@CF03922                                    02S0992 02751000
*               DO;                 /* REFERENCE ALL PAGES           */ 02752000
*ISSUEFX1:                          /* BXLE LOOP POINT               */ 02753000
*                 APESCODE=CERRN15; /* ERROR CODE                    */ 02754000
ISSUEFX1 MVI   APESCODE,X'0F'                                   02S0994 02755000
*                 GEN REFS(R1P);                                02S0995 02756000
*                                   /*                                  02757000
         MODESET EXTKEY=ZERO       PREVENT FETCH PROTECT                02758000
         CLI   0(R1P),*-*          PAGE FIXED AFTER INSTRUCTION DONE    02759000
         MODESET EXTKEY=DATAMGT    RESUME NORMAL PROCESSING KEY         02760000
*                 APESCODE=CERRN99; /* RESUME ERROR CODE             */ 02761000
         MVI   APESCODE,X'21'                                   02S0996 02762000
*                 GEN(BXLE  R1P,R14F,ISSUEFX1)                  02S0997 02763000
*                 REFS(R1P,R14F,R15P) SETS(R1P) FLOWS(ISSUEFX1) SEQFLOW 02764000
*                     ;             /* LOOP THRU ALL PAGES           */ 02765000
         BXLE  R1P,R14F,ISSUEFX1                                        02766000
*               END;                /* VSL ENTRY PROCESSED           */ 02767000
*               RFY                                             02S0999 02768000
*                (R1P,                                          02S0999 02769000
*                 R15P,                                         02S0999 02770000
*                 R14F) UNRSTD;     /* DONE WITH BXLE REGISTERS      */ 02771000
*             END;                  /* ALL PAGES REFERENCED          */ 02772000
         AL    RVSLPTR,@CF00037                                 02S1000 02773000
@DE00988 LA    @09,DAPIO                                        02S1000 02774000
         C     RVSLPTR,APIOPGFL(,@09)                           02S1000 02775000
         BNH   @DL00988                                         02S1000 02776000
*             RFY                                               02S1001 02777000
*               VSL;                /* DONE WITH VSL FORMAT          */ 02778000
*             RFY                                               02S1002 02779000
*              (RVSLPTR) UNRSTD;    /* DONE WITH VSL SCANNER         */ 02780000
*             RFY                                               02S1003 02781000
*               R15F RSTD;          /* PAGE FIX RETURN CODE          */ 02782000
*             R15F=0;               /* SHOW PGFIX WORKED             */ 02783000
         SLR   R15F,R15F                                        02S1004 02784000
*           END;                    /* PAGE-IN COMPLETE              */ 02785000
*         IF R15F^=0 THEN           /* IF PGFIX FAILED               */ 02786000
@RF00982 LTR   R15F,R15F                                        02S1006 02787000
         BZ    @RF01006                                         02S1006 02788000
*           DO;                     /* (NON-ZERO RETURN CODE)        */ 02789000
*             APESCODE=CERRN15;     /* SET ERROR CODE                */ 02790000
         MVI   APESCODE,X'0F'                                   02S1008 02791000
*             DO;                   /* FORCE ABEND TO LOG ERROR &       02792000
*                                      PASS CONTROL TO THE (E)STAE OR   02793000
*                                      FRR EXIT ROUTINE.             */ 02794000
*               DO;                 /* ABEND(APCTABND)               */ 02795000
*                 RESPECIFY                                     02S1011 02796000
*                  (GPR01F) RESTRICTED;                         02S1011 02797000
*                 GPR01F=APCTABND;  /* COMP CODE IN REG 1            */ 02798000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1012 02799000
*                 SVC(13);          /* ISSUE ABEND SVC               */ 02800000
         SVC   13                                               02S1013 02801000
*                 RESPECIFY                                     02S1014 02802000
*                  (GPR01F) UNRESTRICTED;                       02S1014 02803000
*               END;                /* ABEND(APCTABND) FORCE ABEND   */ 02804000
*               GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);    02S1016 02805000
*                                                  /* NO CODE           02806000
*             END;                  /* ABEND ISSUED                  */ 02807000
*           END;                    /* ERROR PROCESSED               */ 02808000
*         RFY                                                   02S1019 02809000
*           R15F UNRSTD;            /* FINISHED WITH RETURN CODE     */ 02810000
@RF01006 DS    0H                                               02S1020 02811000
*         DRCPF2=BON;               /* SHOW PGFREE REQUIRED DURING      02812000
*                                      RECOVERY                      */ 02813000
         OI    DRCPF2,B'00000100'                               02S1020 02814000
*       END;                        /* BUFFER PAGE FIX COMPLETE      */ 02815000
*   END;                            /* END OF CODE SEGMENT           */ 02816000
@RF00921 DS    0H                                               02S1023 02817000
         EJECT                                                          02818000
*                                                               01S1023 02819000
*   /*****************************************************************/ 02820000
*   /*                                                               */ 02821000
*   /* OBTAIN AND INITIALIZE AN IOSB (REAL VERSION)                  */ 02822000
*   /*                                                               */ 02823000
*   /*****************************************************************/ 02824000
*                                                               01S1023 02825000
*   DO;                             /* START OF CODE SEGMENT         */ 02826000
*                                                               02S1023 02827000
*     /***************************************************************/ 02828000
*     /*                                                             */ 02829000
*     /* ACQUIRE AN APIO FROM THE POOL OF APIOS. IF NONE AVAILABLE,  */ 02830000
*     /* GETMAIN A NEW APIO, ADD TO THE CHAIN OF APIOS, AND RETRY THE*/ 02831000
*     /* PROCESSING. AFTER THE APIO IS OBTAINED, MOVE THE DATA FROM  */ 02832000
*     /* THE TEMPORARY APIO TO THE REAL APIO. THE LOCAL LOCK MUST BE */ 02833000
*     /* HELD TO SERIALIZE PROCESSING. TO SCAN THE APIO CHAIN        */ 02834000
*     /* REQUIRES THE CMS LOCK.                                      */ 02835000
*     /*                                                             */ 02836000
*     /***************************************************************/ 02837000
*                                                               02S1024 02838000
*                                                               02S1024 02839000
*     /***************************************************************/ 02840000
*     /*                                                             */ 02841000
*     /* UPDATE APVU TO INDICATE THIS ADDRESS SPACE REQUIRES APIO    */ 02842000
*     /* END-OF-TASK SUPPORT (IGTJDM).                               */ 02843000
*     /*                                                             */ 02844000
*     /***************************************************************/ 02845000
*                                                               02S1024 02846000
*     GEN(MODESET EXTKEY=SCHED)                                 02S1024 02847000
*     NOREFS NOSETS;                /* SWITCH TO APVU KEY            */ 02848000
         MODESET EXTKEY=SCHED                                           02849000
*     APVUAPIO(ASCBASID)=BON;       /* SHOW APIO ACQUIRED            */ 02850000
         L     @01,ASCBPTR                                      02S1025 02851000
         LH    @11,ASCBASID(,@01)                               02S1025 02852000
         N     @11,@CF04247                                     02S1025 02853000
         SLA   @11,2                                            02S1025 02854000
         L     @01,APCTAPVU(,APCTPTR)                           02S1025 02855000
         ALR   @01,@11                                          02S1025 02856000
         LA    @15,APVUAPIO-4(,@01)                             02S1025 02857000
         LR    @14,@15                                          02S1025 02858000
         LA    @09,3                                            02S1025 02859000
         NR    @14,@09                                          02S1025 02860000
         LCR   @14,@14                                          02S1025 02861000
         ALR   @15,@14                                          02S1025 02862000
         L     @09,0(,@15)                                      02S1025 02863000
@GL00012 LR    @04,@09                                          02S1025 02864000
         O     @04,@CB04253+3(@14)                              02S1025 02865000
         CS    @09,@04,0(@15)                                   02S1025 02866000
         BNE   @GL00012                                         02S1025 02867000
*     GEN(MODESET EXTKEY=DATAMGT)                               02S1026 02868000
*     NOREFS NOSETS;                /* RESUME STANDARD KEY           */ 02869000
         MODESET EXTKEY=DATAMGT                                         02870000
*     DAPIOPTR=0;                   /* NO APIO FOUND YET             */ 02871000
         SLR   @09,@09                                          02S1027 02872000
         ST    @09,DAPIOPTR                                     02S1027 02873000
*     DRCIO1=BON;                   /* RELEASE APIO IF ERROR         */ 02874000
         OI    DRCIO1,B'00010000'                               02S1028 02875000
*     CALL GETXLCK;                 /* GET THE CMS LOCK              */ 02876000
*                                                               02S1029 02877000
         BAL   @14,GETXLCK                                      02S1029 02878000
*     /***************************************************************/ 02879000
*     /*                                                             */ 02880000
*     /* MODIFY APESREGS TO CALL SUBROUTINE 'FIXAPIO' IF AN ERROR    */ 02881000
*     /* OCCURS SCANNING THE APIO CHAIN. 'FIXAPIO' WILL REPAIR THE   */ 02882000
*     /* CHAIN AND RETURN CONTROL TO THIS ROUTINE. THE APES ERROR    */ 02883000
*     /* FLAG WILL NOT BE RESET. REGISTER 13 MUST POINT TO AN        */ 02884000
*     /* AVAILABLE SAVEAREA. REGISTER 15 MUST CONTAIN THE ADDRESS OF */ 02885000
*     /* 'FIXAPIO', AND REGISTER 14 MUST CONTAIN THE RETURN ADDRESS  */ 02886000
*     /* (GETAPIO1). GETAPIO1 MUST RESET REGISTERS 14 AND 15 IN      */ 02887000
*     /* APESREGS BEFORE RESETTING THE APES RECURSION FLAG. ALSO     */ 02888000
*     /* REGISTERS 0, 1, 14, AND 15 WILL BE INVALID ACROSS A RETRY.  */ 02889000
*     /*                                                             */ 02890000
*     /***************************************************************/ 02891000
*                                                               02S1030 02892000
*     DRETRY(01)=APESREGF;          /* SAVE CURRENT APESREGS         */ 02893000
         L     @09,APESREGP                                     02S1030 02894000
         L     @04,APESREGF(,@09)                               02S1030 02895000
         ST    @04,DRETRY                                       02S1030 02896000
*     DRETRY(02)=APESREGE;          /* FOR REGISTERS 14 & 15.        */ 02897000
         L     @04,APESREGE(,@09)                               02S1031 02898000
         ST    @04,DRETRY+4                                     02S1031 02899000
*     APESREGE=ADDR(GETAPIO1);      /* RETRY APIO SCAN POINT         */ 02900000
         LA    @04,GETAPIO1                                     02S1032 02901000
         ST    @04,APESREGE(,@09)                               02S1032 02902000
*     APESREGF=ADDR(FIXAPIO);       /* RECOVERY ROUTINE              */ 02903000
         LA    @04,FIXAPIO                                      02S1033 02904000
         ST    @04,APESREGF(,@09)                               02S1033 02905000
*     GOTO GETAPIO2;                /* SKIP RETRY PROCESSING         */ 02906000
         B     GETAPIO2                                         02S1034 02907000
*GETAPIO1:                          /* RETRY APIO SCAN               */ 02908000
*     DO;                           /* ENTRY FROM ESTAE/FRR RETRY    */ 02909000
*                                                               02S1035 02910000
GETAPIO1 DS    0H                                               02S1036 02911000
*       /*************************************************************/ 02912000
*       /*                                                           */ 02913000
*       /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE*/ 02914000
*       /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN       */ 02915000
*       /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION  */ 02916000
*       /* MEMORY OF CURRENT REGISTER VALUES                         */ 02917000
*       /*                                                           */ 02918000
*       /*************************************************************/ 02919000
*                                                               02S1036 02920000
*       RFY                                                     02S1036 02921000
*        (R0RSTD,                                               02S1036 02922000
*         R1RSTD,                                               02S1036 02923000
*         R2RSTD,                                               02S1036 02924000
*         R3RSTD,                                               02S1036 02925000
*         R4RSTD,                                               02S1036 02926000
*         R5RSTD,                   /* 6-7 BASES                     */ 02927000
*         R8RSTD,                                               02S1036 02928000
*         R9RSTD,                                               02S1036 02929000
*         R10RSTD,                                              02S1036 02930000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 02931000
*         R14RSTD,                                              02S1036 02932000
*         R15RSTD) RSTD;            /* KEEP PL/S FROM CARRYING DATA  */ 02933000
*       GEN(MODESET EXTKEY=DATAMGT);/* SWITCH TO STANDARD KEY (5)    */ 02934000
         MODESET EXTKEY=DATAMGT                                         02935000
*       RFY                                                     02S1038 02936000
*        (R0RSTD,                                               02S1038 02937000
*         R1RSTD,                                               02S1038 02938000
*         R2RSTD,                                               02S1038 02939000
*         R3RSTD,                                               02S1038 02940000
*         R4RSTD,                                               02S1038 02941000
*         R5RSTD,                   /* 6-7 BASES                     */ 02942000
*         R8RSTD,                                               02S1038 02943000
*         R9RSTD,                                               02S1038 02944000
*         R10RSTD,                                              02S1038 02945000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 02946000
*         R14RSTD,                                              02S1038 02947000
*         R15RSTD) UNRSTD;          /* ALLOW PL/S TO USE REGS AGAIN  */ 02948000
*     END;                          /* RETRY ENVIRONMENT SET         */ 02949000
*     APESREGF=DRETRY(01);          /* RESTORE ORIGINAL              */ 02950000
         L     @09,APESREGP                                     02S1040 02951000
         L     @04,DRETRY                                       02S1040 02952000
         ST    @04,APESREGF(,@09)                               02S1040 02953000
*     APESREGE=DRETRY(02);          /* REGISTERS 14 & 15             */ 02954000
         L     @04,DRETRY+4                                     02S1041 02955000
         ST    @04,APESREGE(,@09)                               02S1041 02956000
*     DO;                           /* ERROR RECOVERY COMPLETE       */ 02957000
*       APESFPRV=BOFF;              /* RESET RECURSION FLAG.         */ 02958000
         NI    APESFPRV,B'10111111'                             02S1043 02959000
*       APESCODE=CERRN99;           /* RESET ERROR CODE              */ 02960000
         MVI   APESCODE,X'21'                                   02S1044 02961000
*       APESFDMP=BON;               /* RESET DUMP/LOG FLAGS          */ 02962000
*       APESFREC=BON;               /* TO THEIR NORMAL VALUES        */ 02963000
*       APESFSDP=BON;               /* (ALL ON)                      */ 02964000
         OI    APESFDMP,B'11100000'                             02S1047 02965000
*     END;                          /* ALL INDICATORS RESET 2ND ABEND   02966000
*                                      TERMINATES REQUEST            */ 02967000
*     APESCOD1=0;                   /* RESET ERROR INDICATOR         */ 02968000
         MVI   APESCOD1,X'00'                                   02S1049 02969000
*GETAPIO2:                          /* FIRST PASS START              */ 02970000
*     APESCODE=CERRN27;             /* INVALID APIO CHAIN INDICATOR  */ 02971000
GETAPIO2 MVI   APESCODE,X'1B'                                   02S1050 02972000
*     RFY                                                       02S1051 02973000
*      (RAPIOPTR) RSTD;             /* APIO POINTER                  */ 02974000
*     RAPIOPTR=APCTAPIO;            /* FIRST APIO                    */ 02975000
         L     RAPIOPTR,APCTAPIO(,APCTPTR)                      02S1052 02976000
*     RFY                                                       02S1053 02977000
*       APIO BASED(RAPIOPTR);       /* TELL PL/S OF REGISTER POINTER */ 02978000
*     DO WHILE((RAPIOPTR^=0)&       /* SCAN UNTIL END OF CHAIN OR    */ 02979000
*           ((APIOID^=APIOIDC)|(APIOASCB^=0)));/* VALID GOOD APIO    */ 02980000
         B     @DE01054                                         02S1054 02981000
@DL01054 DS    0H                                               02S1055 02982000
*       GEN NOREFS NOSETS FLOWS(GETAPIO1,FIXAPIO) SEQFLOW;      02S1055 02983000
*                                        /* PLS ERROR FLOW -- NO CODE   02984000
*       IF APIOID^=APIOIDC THEN     /* IF INVALID APIO ID, THEN LOG  */ 02985000
         CLC   APIOID(4,RAPIOPTR),@CC03144                      02S1056 02986000
         BE    @RF01056                                         02S1056 02987000
*         DO;                       /* FORCE ABEND TO LOG ERROR &       02988000
*                                      PASS CONTROL TO THE (E)STAE OR   02989000
*                                      FRR EXIT ROUTINE.             */ 02990000
*           DO;                     /* ABEND(APCTABND)               */ 02991000
*             RESPECIFY                                         02S1059 02992000
*              (GPR01F) RESTRICTED;                             02S1059 02993000
*             GPR01F=APCTABND;      /* COMP CODE IN REG 1            */ 02994000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1060 02995000
*             SVC(13);              /* ISSUE ABEND SVC               */ 02996000
         SVC   13                                               02S1061 02997000
*             RESPECIFY                                         02S1062 02998000
*              (GPR01F) UNRESTRICTED;                           02S1062 02999000
*           END;                    /* ABEND(APCTABND) FORCE ABEND   */ 03000000
*           GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);        02S1064 03001000
*                                                  /* NO CODE           03002000
*         END;                      /* ABEND ISSUED                  */ 03003000
*       RAPIOPTR=APIOAPIO;          /* (APIOASCB=0) FOUND            */ 03004000
@RF01056 L     RAPIOPTR,APIOAPIO(,RAPIOPTR)                     02S1066 03005000
*     END;                          /* RAPIOPTR = ADDR(APIO) OR 0.   */ 03006000
@DE01054 SLR   @09,@09                                          02S1067 03007000
         CR    RAPIOPTR,@09                                     02S1067 03008000
         BE    @DC01054                                         02S1067 03009000
         CLC   APIOID(4,RAPIOPTR),@CC03144                      02S1067 03010000
         BNE   @DL01054                                         02S1067 03011000
         C     @09,APIOASCB(,RAPIOPTR)                          02S1067 03012000
         BNE   @DL01054                                         02S1067 03013000
@DC01054 DS    0H                                               02S1068 03014000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 03015000
         MVI   APESCODE,X'21'                                   02S1068 03016000
*     APESREGF=DRETRY(01);          /* RESTORE INITIAL ERROR REGS    */ 03017000
         L     @09,APESREGP                                     02S1069 03018000
         L     @04,DRETRY                                       02S1069 03019000
         ST    @04,APESREGF(,@09)                               02S1069 03020000
*     APESREGE=DRETRY(02);          /* (14 & 15)                     */ 03021000
*                                                               02S1070 03022000
         L     @04,DRETRY+4                                     02S1070 03023000
         ST    @04,APESREGE(,@09)                               02S1070 03024000
*     /***************************************************************/ 03025000
*     /*                                                             */ 03026000
*     /* IF NO APIO ENTRIES AVAILABLE, ACQUIRE AND INITIALIZE A NEW  */ 03027000
*     /* APIO. THEN PLACE ON THE APIO QUEUE. USE THIS NEW APIO FOR   */ 03028000
*     /* FURTHER PROCESSING.                                         */ 03029000
*     /*                                                             */ 03030000
*     /***************************************************************/ 03031000
*                                                               02S1071 03032000
*     DAPIOPTR=RAPIOPTR;            /* SAVE APIO ADDRESS OR 0        */ 03033000
         ST    RAPIOPTR,DAPIOPTR                                02S1071 03034000
*     IF RAPIOPTR=0 THEN            /* IF FREE APIO NOT FOUND        */ 03035000
         LTR   RAPIOPTR,RAPIOPTR                                02S1072 03036000
         BNZ   @RF01072                                         02S1072 03037000
*       DO;                         /* THEN MUST GETMAIN A NEW ONE   */ 03038000
*         CALL FREEXLCK;            /* RELEASE THE CMS LOCK          */ 03039000
*                                                               02S1074 03040000
         BAL   @14,FREEXLCK                                     02S1074 03041000
*         /***********************************************************/ 03042000
*         /*                                                         */ 03043000
*         /* ISSUE GETMAIN FOR FIXED GLOBAL STORAGE FOR NEW APIO.    */ 03044000
*         /* THEN CHAIN TO APIO QUEUE.                               */ 03045000
*         /*                                                         */ 03046000
*         /***********************************************************/ 03047000
*                                                               02S1075 03048000
*         DRCGM3=BON;               /* FREEMAIN APIO IF ERROR        */ 03049000
         OI    DRCGM3,B'00100000'                               02S1075 03050000
*         RFY                                                   02S1076 03051000
*           R1P RSTD;               /* IGTUAG INTERFACE REGISTER     */ 03052000
*         R1P=ADDR(DAPGF);          /* POINT TO WORKAREA             */ 03053000
         LA    R1P,DAPGF                                        02S1077 03054000
*         RFY                                                   02S1078 03055000
*           APGF BASED(R1P);        /* TELL COMPILER                 */ 03056000
*         APGF=APGF&&APGF;          /* CLEAR UNUSED FIELDS           */ 03057000
         XC    APGF(16,R1P),APGF(R1P)                           02S1079 03058000
*         APGFXSP=APIOSP;           /* SUBPOOL                       */ 03059000
         MVI   APGFXSP(R1P),X'E4'                               02S1080 03060000
*         APGFXLN=APIOLN;           /* LENGTH                        */ 03061000
         MVC   APGFXLN(4,R1P),@CF03134                          02S1081 03062000
*         APGFXKEY=APIOKEY;         /* KEY                           */ 03063000
         MVI   APGFXKEY(R1P),X'05'                              02S1082 03064000
*         APGFSUNC=BON;             /* UNCONDITIONAL GETMAIN         */ 03065000
*         APGFSLCK=BON;             /* SHOW LOCAL LOCK ALREADY OWNED */ 03066000
*         APGFSCLR=BON;             /* CLEAR ACQUIRED STORAGE        */ 03067000
*         APGFSINA=BON;             /* INDIRECT ADDRESS POINTER      */ 03068000
         OI    APGFSUNC(R1P),B'10101010'                        02S1086 03069000
*         APGFXADR=ADDR(DAPIOPTR);  /* WHERE TO SAVE STORAGE ADDR.   */ 03070000
         LA    @09,DAPIOPTR                                     02S1087 03071000
         ST    @09,APGFXADR(,R1P)                               02S1087 03072000
*         APESCODE=CERRN17;         /* ERROR CODE IF GETMAIN FAILS   */ 03073000
         MVI   APESCODE,X'11'                                   02S1088 03074000
*         CALL APCVZUAG;            /* GETMAIN STORAGE               */ 03075000
         L     @15,APCTZUAG(,APCTPTR)                           02S1089 03076000
         BALR  @14,@15                                          02S1089 03077000
*         APESCODE=CERRN99;         /* RESET ERROR CODE              */ 03078000
         MVI   APESCODE,X'21'                                   02S1090 03079000
*         RFY                                                   02S1091 03080000
*           R1P;                    /* DONE WITH IGTUAG INPUT        */ 03081000
*         RFY                                                   02S1092 03082000
*           APGF;                   /* TELL THE COMPILER             */ 03083000
*         CALL GETXLCK;             /* ACQUIRED CMS LOCK TO UPDATE      03084000
*                                      APIO CHAIN.                   */ 03085000
         BAL   @14,GETXLCK                                      02S1093 03086000
*         RAPIOPTR=DAPIOPTR;        /* POINT TO NEW APIO             */ 03087000
         L     RAPIOPTR,DAPIOPTR                                02S1094 03088000
*         APIOID=APIOIDC;           /* HEADER ID REQUIRED FOR CHAIN     03089000
*                                      VALIDATION.                   */ 03090000
         MVC   APIOID(4,RAPIOPTR),@CC03144                      02S1095 03091000
*         DRCGM3=BOFF;              /* DO NOT FREE APIO. IS BEING       03092000
*                                      MADE PART OF APIO CHAIN       */ 03093000
*                                                               02S1096 03094000
         NI    DRCGM3,B'11011111'                               02S1096 03095000
*         /***********************************************************/ 03096000
*         /*                                                         */ 03097000
*         /* MODIFY APESREGS TO CALL SUBROUTINE 'FIXAPIO' IF AN ERROR*/ 03098000
*         /* OCCURS UPDATING THE APIO CHAIN. 'FIXAPIO' WILL REPAIR   */ 03099000
*         /* THE CHAIN AND RETURN CONTROL TO THIS ROUTINE. THE APES  */ 03100000
*         /* ERROR FLAG WILL NOT BE RESET. REGISTER 13 MUST POINT TO */ 03101000
*         /* AN AVAILABLE SAVEAREA. REGISTER 15 MUST CONTAIN THE     */ 03102000
*         /* ADDRESS OF 'FIXAPIO', AND REGISTER 14 MUST CONTAIN THE  */ 03103000
*         /* RETURN ADDRESS (GETAPIO3). GETAPIO3 MUST RESET REGISTERS*/ 03104000
*         /* 14 AND 15 IN APESREGS BEFORE RESETTING THE APES         */ 03105000
*         /* RECURSION FLAG. ALSO REGISTERS 0, 1, 14, AND 15 WILL BE */ 03106000
*         /* INVALID ACROSS A RETRY.                                 */ 03107000
*         /*                                                         */ 03108000
*         /***********************************************************/ 03109000
*                                                               02S1097 03110000
*         DRETRY(01)=APESREGF;      /* SAVE CURRENT APESREGS         */ 03111000
         L     @09,APESREGP                                     02S1097 03112000
         L     @04,APESREGF(,@09)                               02S1097 03113000
         ST    @04,DRETRY                                       02S1097 03114000
*         DRETRY(02)=APESREGE;      /* FOR REGISTERS 14 & 15.        */ 03115000
         L     @04,APESREGE(,@09)                               02S1098 03116000
         ST    @04,DRETRY+4                                     02S1098 03117000
*         APESREGE=ADDR(GETAPIO3);  /* RETRY APIO SCAN POINT         */ 03118000
         LA    @04,GETAPIO3                                     02S1099 03119000
         ST    @04,APESREGE(,@09)                               02S1099 03120000
*         APESREGF=ADDR(FIXAPIO);   /* RECOVERY ROUTINE              */ 03121000
         LA    @04,FIXAPIO                                      02S1100 03122000
         ST    @04,APESREGF(,@09)                               02S1100 03123000
*         GOTO GETAPIO4;            /* SKIP RETRY PROCESSING         */ 03124000
         B     GETAPIO4                                         02S1101 03125000
*GETAPIO3:                          /* RETRY APIO CHAIN UPDATE       */ 03126000
*         DO;                       /* ENTRY FROM ESTAE/FRR RETRY    */ 03127000
*                                                               02S1102 03128000
GETAPIO3 DS    0H                                               02S1103 03129000
*           /*********************************************************/ 03130000
*           /*                                                       */ 03131000
*           /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT   */ 03132000
*           /* INSURE REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT     */ 03133000
*           /* SAVED IN APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S  */ 03134000
*           /* OPTIMIZATION MEMORY OF CURRENT REGISTER VALUES        */ 03135000
*           /*                                                       */ 03136000
*           /*********************************************************/ 03137000
*                                                               02S1103 03138000
*           RFY                                                 02S1103 03139000
*            (R0RSTD,                                           02S1103 03140000
*             R1RSTD,                                           02S1103 03141000
*             R2RSTD,                                           02S1103 03142000
*             R3RSTD,                                           02S1103 03143000
*             R4RSTD,                                           02S1103 03144000
*             R5RSTD,               /* 6-7 BASES                     */ 03145000
*             R8RSTD,                                           02S1103 03146000
*             R9RSTD,                                           02S1103 03147000
*             R10RSTD,                                          02S1103 03148000
*             R11RSTD,              /* 12-13 APCT/APSV PTRS          */ 03149000
*             R14RSTD,                                          02S1103 03150000
*             R15RSTD) RSTD;        /* KEEP PL/S FROM CARRYING DATA  */ 03151000
*           GEN(MODESET EXTKEY=DATAMGT);/* SWITCH TO STANDARD KEY (5)*/ 03152000
         MODESET EXTKEY=DATAMGT                                         03153000
*           RFY                                                 02S1105 03154000
*            (R0RSTD,                                           02S1105 03155000
*             R1RSTD,                                           02S1105 03156000
*             R2RSTD,                                           02S1105 03157000
*             R3RSTD,                                           02S1105 03158000
*             R4RSTD,                                           02S1105 03159000
*             R5RSTD,               /* 6-7 BASES                     */ 03160000
*             R8RSTD,                                           02S1105 03161000
*             R9RSTD,                                           02S1105 03162000
*             R10RSTD,                                          02S1105 03163000
*             R11RSTD,              /* 12-13 APCT/APSV PTRS          */ 03164000
*             R14RSTD,                                          02S1105 03165000
*             R15RSTD) UNRSTD;      /* ALLOW PL/S TO USE REGS AGAIN  */ 03166000
*         END;                      /* RETRY ENVIRONMENT SET         */ 03167000
*         APESREGF=DRETRY(01);      /* RESTORE ORIGINAL              */ 03168000
         L     @09,APESREGP                                     02S1107 03169000
         L     @04,DRETRY                                       02S1107 03170000
         ST    @04,APESREGF(,@09)                               02S1107 03171000
*         APESREGE=DRETRY(02);      /* REGISTERS 14 & 15             */ 03172000
         L     @04,DRETRY+4                                     02S1108 03173000
         ST    @04,APESREGE(,@09)                               02S1108 03174000
*         DO;                       /* ERROR RECOVERY COMPLETE       */ 03175000
*           APESFPRV=BOFF;          /* RESET RECURSION FLAG.         */ 03176000
         NI    APESFPRV,B'10111111'                             02S1110 03177000
*           APESCODE=CERRN99;       /* RESET ERROR CODE              */ 03178000
         MVI   APESCODE,X'21'                                   02S1111 03179000
*           APESFDMP=BON;           /* RESET DUMP/LOG FLAGS          */ 03180000
*           APESFREC=BON;           /* TO THEIR NORMAL VALUES        */ 03181000
*           APESFSDP=BON;           /* (ALL ON)                      */ 03182000
         OI    APESFDMP,B'11100000'                             02S1114 03183000
*         END;                      /* ALL INDICATORS RESET 2ND ABEND   03184000
*                                      TERMINATES REQUEST            */ 03185000
*         APESCOD1=0;               /* NO ERROR EXISTS               */ 03186000
         MVI   APESCOD1,X'00'                                   02S1116 03187000
*GETAPIO4:                          /* FIRST PASS START              */ 03188000
*         GEN NOREFS NOSETS FLOWS(GETAPIO3,FIXAPIO) SEQFLOW;    02S1117 03189000
GETAPIO4 DS    0H                                               02S1117 03190000
*                                            /* ERROR FLOW--NO CODE     03191000
*         APESCODE=CERRN27;         /* INVALID APIO CHAIN            */ 03192000
         MVI   APESCODE,X'1B'                                   02S1118 03193000
*         IF APCTAPIO^=0 THEN       /* POINT PREVIOUS APIO (IF ANY)  */ 03194000
         L     @09,APCTAPIO(,APCTPTR)                           02S1119 03195000
         LTR   @09,@09                                          02S1119 03196000
         BZ    @RF01119                                         02S1119 03197000
*           APCTAPIO->APIOIOAP=RAPIOPTR;/* AT THIS NEW APIO.         */ 03198000
         ST    RAPIOPTR,APIOIOAP(,@09)                          02S1120 03199000
*         APIOAPIO=APCTAPIO;        /* POINT NEW APIO AT PREV. APIO  */ 03200000
@RF01119 L     @09,APCTAPIO(,APCTPTR)                           02S1121 03201000
         ST    @09,APIOAPIO(,RAPIOPTR)                          02S1121 03202000
*         GEN(MODESET EXTKEY=SCHED)                             02S1122 03203000
*         NOREFS NOSETS;            /* SWITCH TO APCT KEY            */ 03204000
         MODESET EXTKEY=SCHED                                           03205000
*         IF APCTIOAP=0 THEN        /* IF THIS IS ONLY APIO, THEN    */ 03206000
         L     @09,APCTIOAP(,APCTPTR)                           02S1123 03207000
         LTR   @09,@09                                          02S1123 03208000
         BNZ   @RF01123                                         02S1123 03209000
*           APCTIOAP=RAPIOPTR;      /* LAST APIO IS ALSO THIS APIO.  */ 03210000
         ST    RAPIOPTR,APCTIOAP(,APCTPTR)                      02S1124 03211000
*         APCTAPIO=RAPIOPTR;        /* NEW APIO NOW FIRST APIO.      */ 03212000
@RF01123 ST    RAPIOPTR,APCTAPIO(,APCTPTR)                      02S1125 03213000
*         GEN(MODESET EXTKEY=DATAMGT)                           02S1126 03214000
*         NOREFS NOSETS;            /* RESUME NORMAL KEY             */ 03215000
         MODESET EXTKEY=DATAMGT                                         03216000
*         APESREGF=DRETRY(01);      /* RESTORE ORIGINAL RECOVERY     */ 03217000
         L     @09,APESREGP                                     02S1127 03218000
         L     @04,DRETRY                                       02S1127 03219000
         ST    @04,APESREGF(,@09)                               02S1127 03220000
*         APESREGE=DRETRY(02);      /* REGISTERS (14 & 15)           */ 03221000
         L     @04,DRETRY+4                                     02S1128 03222000
         ST    @04,APESREGE(,@09)                               02S1128 03223000
*         APESCODE=CERRN99;         /* RESET ERROR CODE              */ 03224000
         MVI   APESCODE,X'21'                                   02S1129 03225000
*       END;                        /* APIO NOW LOCATED. POINTED TO     03226000
*                                      BY RAPIOPTR.                  */ 03227000
*                                                               02S1130 03228000
*     /***************************************************************/ 03229000
*     /*                                                             */ 03230000
*     /* APIO NOW ACQUIRED IN GLOBAL STORAGE. UPDATE THEN APXL TO    */ 03231000
*     /* POINT TO THIS APIO AND UPDATE THE FAKE APIO WITH INFORMATION*/ 03232000
*     /* ABOUT THE REAL APIO.                                        */ 03233000
*     /*                                                             */ 03234000
*     /***************************************************************/ 03235000
*                                                               02S1131 03236000
*     EVAL(DAPXLACT+APXLLN0)->APXLADLB=/* FIRST ENTRY WILL SAVE      */ 03237000
*         ADDR(IOSRST);             /* ADDR OF REAL CHANNEL PGM IN      03238000
*                                      THE IOSB.                     */ 03239000
@RF01072 L     @09,DAPXLACT                                     02S1131 03240000
         LA    @04,24                                           02S1131 03241000
         ALR   @04,@09                                          02S1131 03242000
         LA    @02,IOSRST(,RAPIOPTR)                            02S1131 03243000
         STCM  @02,7,APXLADLB(@04)                              02S1131 03244000
*     EVAL(ADDR(DAPIO)+EVAL(ADDR(APIOIOSB)-ADDR(APIO)))->/* IOSB WILL*/ 03245000
*         IOSSRB=ADDR(APIOSRB);     /* POINT TO THE SRB.             */ 03246000
         LA    @04,DAPIO                                        02S1132 03247000
         LR    @02,RAPIOPTR                                     02S1132 03248000
         SLR   @02,RAPIOPTR                                     02S1132 03249000
         ALR   @02,@04                                          02S1132 03250000
         LA    @15,APIOSRB(,RAPIOPTR)                           02S1132 03251000
         ST    @15,IOSSRB(,@02)                                 02S1132 03252000
*     EVAL(ADDR(DAPIO)+EVAL(ADDR(APIOSRB)-ADDR(APIO)))->/* SRB PARM     03253000
*                                      IS                            */ 03254000
*         SRBPARM=ADDR(IOSB);       /* ADDRESS OF IOSB. THIS MAKES      03255000
*                                      DIE SCHEDULED SRB LOOK LIKE      03256000
*                                      POST STATUS CALL TO IGTKBC.   */ 03257000
         LA    @02,128                                          02S1133 03258000
         ALR   @02,@04                                          02S1133 03259000
         ST    RAPIOPTR,SRBPARM(,@02)                           02S1133 03260000
*     ADDR(DAPIO)->APIOVCSW=ADDR(IOSCC);/* ADDR CSW STORE AREA       */ 03261000
         LA    @02,IOSCC(,RAPIOPTR)                             02S1134 03262000
         ST    @02,APIOVCSW(,@04)                               02S1134 03263000
*     ADDR(DAPIO)->APIOAPXL=DAPXLACT;/* ADDR OF APXL TABLE           */ 03264000
         ST    @09,APIOAPXL(,@04)                               02S1135 03265000
*     ADDR(DAPIO)->APIOAPIO=APIOAPIO;/* NEXT APIO POINTER            */ 03266000
         L     @09,APIOAPIO(,RAPIOPTR)                          02S1136 03267000
         ST    @09,APIOAPIO(,@04)                               02S1136 03268000
*     ADDR(DAPIO)->APIOIOAP=APIOIOAP;/* PREVIOUS APIO PTR (=0)       */ 03269000
*                                                               02S1137 03270000
         L     @09,APIOIOAP(,RAPIOPTR)                          02S1137 03271000
         ST    @09,APIOIOAP(,@04)                               02S1137 03272000
*     /***************************************************************/ 03273000
*     /*                                                             */ 03274000
*     /* MOVE THE FAKE APIO TO THE REAL APIO.                        */ 03275000
*     /*                                                             */ 03276000
*     /***************************************************************/ 03277000
*                                                               02S1138 03278000
*     DRETRY(01)=APESREGF;          /* SAVE CURRENT APESREGS         */ 03279000
         L     @09,APESREGP                                     02S1138 03280000
         L     @04,APESREGF(,@09)                               02S1138 03281000
         ST    @04,DRETRY                                       02S1138 03282000
*     DRETRY(02)=APESREGE;          /* FOR REGISTERS 14 & 15.        */ 03283000
         L     @04,APESREGE(,@09)                               02S1139 03284000
         ST    @04,DRETRY+4                                     02S1139 03285000
*     APESREGE=ADDR(GETAPIO5);      /* RETRY APIO SCAN POINT         */ 03286000
         LA    @04,GETAPIO5                                     02S1140 03287000
         ST    @04,APESREGE(,@09)                               02S1140 03288000
*     APESREGF=ADDR(FIXAPIO);       /* RECOVERY ROUTINE              */ 03289000
         LA    @04,FIXAPIO                                      02S1141 03290000
         ST    @04,APESREGF(,@09)                               02S1141 03291000
*     GOTO GETAPIO6;                /* SKIP RETRY PROCESSING         */ 03292000
         B     GETAPIO6                                         02S1142 03293000
*GETAPIO5:                          /* RETRY APIO MVCL               */ 03294000
*     DO;                           /* ENTRY FROM ESTAE/FRR RETRY    */ 03295000
*                                                               02S1143 03296000
GETAPIO5 DS    0H                                               02S1144 03297000
*       /*************************************************************/ 03298000
*       /*                                                           */ 03299000
*       /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE*/ 03300000
*       /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN       */ 03301000
*       /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION  */ 03302000
*       /* MEMORY OF CURRENT REGISTER VALUES                         */ 03303000
*       /*                                                           */ 03304000
*       /*************************************************************/ 03305000
*                                                               02S1144 03306000
*       RFY                                                     02S1144 03307000
*        (R0RSTD,                                               02S1144 03308000
*         R1RSTD,                                               02S1144 03309000
*         R2RSTD,                                               02S1144 03310000
*         R3RSTD,                                               02S1144 03311000
*         R4RSTD,                                               02S1144 03312000
*         R5RSTD,                   /* 6-7 BASES                     */ 03313000
*         R8RSTD,                                               02S1144 03314000
*         R9RSTD,                                               02S1144 03315000
*         R10RSTD,                                              02S1144 03316000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 03317000
*         R14RSTD,                                              02S1144 03318000
*         R15RSTD) RSTD;            /* KEEP PL/S FROM CARRYING DATA  */ 03319000
*       GEN(MODESET EXTKEY=DATAMGT);/* SWITCH TO STANDARD KEY (5)    */ 03320000
         MODESET EXTKEY=DATAMGT                                         03321000
*       RFY                                                     02S1146 03322000
*        (R0RSTD,                                               02S1146 03323000
*         R1RSTD,                                               02S1146 03324000
*         R2RSTD,                                               02S1146 03325000
*         R3RSTD,                                               02S1146 03326000
*         R4RSTD,                                               02S1146 03327000
*         R5RSTD,                   /* 6-7 BASES                     */ 03328000
*         R8RSTD,                                               02S1146 03329000
*         R9RSTD,                                               02S1146 03330000
*         R10RSTD,                                              02S1146 03331000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 03332000
*         R14RSTD,                                              02S1146 03333000
*         R15RSTD) UNRSTD;          /* ALLOW PL/S TO USE REGS AGAIN  */ 03334000
*     END;                          /* RETRY ENVIRONMENT SET         */ 03335000
*     APESREGF=DRETRY(01);          /* RESTORE ORIGINAL              */ 03336000
         L     @09,APESREGP                                     02S1148 03337000
         L     @04,DRETRY                                       02S1148 03338000
         ST    @04,APESREGF(,@09)                               02S1148 03339000
*     APESREGE=DRETRY(02);          /* REGISTERS 14 & 15             */ 03340000
         L     @04,DRETRY+4                                     02S1149 03341000
         ST    @04,APESREGE(,@09)                               02S1149 03342000
*     DO;                           /* ERROR RECOVERY COMPLETE       */ 03343000
*       APESFPRV=BOFF;              /* RESET RECURSION FLAG.         */ 03344000
         NI    APESFPRV,B'10111111'                             02S1151 03345000
*       APESCODE=CERRN99;           /* RESET ERROR CODE              */ 03346000
         MVI   APESCODE,X'21'                                   02S1152 03347000
*       APESFDMP=BON;               /* RESET DUMP/LOG FLAGS          */ 03348000
*       APESFREC=BON;               /* TO THEIR NORMAL VALUES        */ 03349000
*       APESFSDP=BON;               /* (ALL ON)                      */ 03350000
         OI    APESFDMP,B'11100000'                             02S1155 03351000
*     END;                          /* ALL INDICATORS RESET          */ 03352000
*     APESCODE=CERRN27;             /* SHOW APIO CHAIN PROBLEM       */ 03353000
         MVI   APESCODE,X'1B'                                   02S1157 03354000
*     DO;                           /* FORCE ABEND TO LOG ERROR &       03355000
*                                      PASS CONTROL TO THE (E)STAE OR   03356000
*                                      FRR EXIT ROUTINE.             */ 03357000
*       DO;                         /* ABEND(APCTABND)               */ 03358000
*         RESPECIFY                                             02S1160 03359000
*          (GPR01F) RESTRICTED;                                 02S1160 03360000
*         GPR01F=APCTABND;          /* COMP CODE IN REG 1            */ 03361000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1161 03362000
*         SVC(13);                  /* ISSUE ABEND SVC               */ 03363000
         SVC   13                                               02S1162 03364000
*         RESPECIFY                                             02S1163 03365000
*          (GPR01F) UNRESTRICTED;                               02S1163 03366000
*       END;                        /* ABEND(APCTABND) FORCE ABEND   */ 03367000
*       GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);            02S1165 03368000
*                                                  /* NO CODE           03369000
*     END;                          /* ABEND ISSUED                  */ 03370000
*GETAPIO6:                          /* MVCL REAL APIO START          */ 03371000
*     GEN NOREFS NOSETS FLOWS(GETAPIO5,FIXAPIO) SEQFLOW;        02S1167 03372000
GETAPIO6 DS    0H                                               02S1167 03373000
*                                        /* PLS ERROR FLOW--NO CODE     03374000
*     APESCODE=CERRN27;             /* INVALID APIO CHAIN INDICATOR  */ 03375000
         MVI   APESCODE,X'1B'                                   02S1168 03376000
*     RFY                                                       02S1169 03377000
*      (R0P,                                                    02S1169 03378000
*       R1F,                                                    02S1169 03379000
*       R14P,                                                   02S1169 03380000
*       R15F) RSTD;                 /* MVCL REGISTERS                */ 03381000
*     R0P=RAPIOPTR;                 /* ADDRESS OF REAL APIO          */ 03382000
         LR    R0P,RAPIOPTR                                     02S1170 03383000
*     R1F=APIOLN;                   /* LENGTH OF APIO                */ 03384000
         LA    R1F,424                                          02S1171 03385000
*     R14P=ADDR(DAPIO);             /* ADDRESS OF FAKE APIO          */ 03386000
         LA    R14P,DAPIO                                       02S1172 03387000
*     R15F=R1F;                     /* LENGTH OF APIO.               */ 03388000
         LR    R15F,R1F                                         02S1173 03389000
*     MVCL(R0P,R14P);               /* MOVE APIO TO GLOBAL STORAGE.  */ 03390000
         MVCL  R0P,R14P                                         02S1174 03391000
*     RFY                                                       02S1175 03392000
*      (R0P,                                                    02S1175 03393000
*       R1F,                                                    02S1175 03394000
*       R14P,                                                   02S1175 03395000
*       R15F) UNRSTD;               /* DONE WITH MVCL REGISTERS      */ 03396000
*     APESREGF=DRETRY(01);          /* RESTORE ORIGINAL RECOVERY     */ 03397000
         L     @09,APESREGP                                     02S1176 03398000
         L     @04,DRETRY                                       02S1176 03399000
         ST    @04,APESREGF(,@09)                               02S1176 03400000
*     APESREGE=DRETRY(02);          /* REGISTERS (14 & 15)           */ 03401000
         L     @04,DRETRY+4                                     02S1177 03402000
         ST    @04,APESREGE(,@09)                               02S1177 03403000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 03404000
*                                                               02S1178 03405000
         MVI   APESCODE,X'21'                                   02S1178 03406000
*     /***************************************************************/ 03407000
*     /*                                                             */ 03408000
*     /* SAVE THE ADDRESS OF THE APIO IN THE APDX.                   */ 03409000
*     /*                                                             */ 03410000
*     /***************************************************************/ 03411000
*                                                               02S1179 03412000
*     APDXAPIO(DAPIOCT0)=RAPIOPTR;  /* SAVE IN AN OPEN APDX SLOT.    */ 03413000
*                                                               02S1179 03414000
         L     @09,DAPIOCT0                                     02S1179 03415000
         SLA   @09,2                                            02S1179 03416000
         L     @04,DAPDXPTR                                     02S1179 03417000
         ST    RAPIOPTR,APDXAPIO-4(@09,@04)                     02S1179 03418000
*     /***************************************************************/ 03419000
*     /*                                                             */ 03420000
*     /* THE APIO NOW BUILT AND CHAINED TO THE APIO CHAIN. RELEASE   */ 03421000
*     /* THE CMS LOCK.                                               */ 03422000
*     /*                                                             */ 03423000
*     /***************************************************************/ 03424000
*                                                               02S1180 03425000
*     RFY                                                       02S1180 03426000
*       APIO BASED(ADDR(DAPIO));    /* USE COPY FOR REFERENCE,  02S1180 03427000
*                                      DAPIOPTR POINTS TO REAL APIO  */ 03428000
*     RFY                                                       02S1181 03429000
*       RAPIOPTR UNRSTD;            /* FINISHED WITH REGISTER        */ 03430000
*     CALL FREEXLCK;                /* RELEASE THE CMS LOCK          */ 03431000
         BAL   @14,FREEXLCK                                     02S1182 03432000
*     DRCIO1=BOFF;                  /* IF ERROR OCCURS, DO NOT       */ 03433000
*     DRCPF2=BOFF;                  /* RELEASE RESOURCES SINCE       */ 03434000
*     DRCPF1=BOFF;                  /* 'RLSE' CALL WILL NOW          */ 03435000
*     DRCGM2=BOFF;                  /* FUNCTION (APDXAPIO SET).      */ 03436000
         NI    DRCIO1,B'10100011'                               02S1186 03437000
*   END;                            /* END OF CODE                   */ 03438000
         EJECT                                                          03439000
*                                                               01S1188 03440000
*   /*****************************************************************/ 03441000
*   /*                                                               */ 03442000
*   /* UPDATE THE SMF RECORD (APMF)                                  */ 03443000
*   /*                                                               */ 03444000
*   /*****************************************************************/ 03445000
*                                                               01S1188 03446000
*   DO;                             /* START OF CODE SEGMENT         */ 03447000
*                                                               02S1188 03448000
*     /***************************************************************/ 03449000
*     /*                                                             */ 03450000
*     /* UPDATE THE APMF (SMF RECORD). IF AN ERROR OCCURS, FLAG THE  */ 03451000
*     /* APMF AS SUSPECT, BUT DO NOT TERMINATE THE REQUEST. THE LOCAL*/ 03452000
*     /* LOCK IS HELD TO SERIALIZE THIS PROCESSING.                  */ 03453000
*     /*                                                             */ 03454000
*     /***************************************************************/ 03455000
*                                                               02S1189 03456000
*     DAPMFCT1=0;                   /* NUMBER APIO PGFIX AT XLTE     */ 03457000
         SLR   DAPMFCT1,DAPMFCT1                                02S1189 03458000
*     DAPMFCT2=0;                   /* NUMBER APIO PGFIX AT I/O      */ 03459000
         SLR   DAPMFCT2,DAPMFCT2                                02S1190 03460000
*     DAPMFCT3=0;                   /* NUMBER OF RE-TRANSLATE APIOS  */ 03461000
         SLR   DAPMFCT3,DAPMFCT3                                02S1191 03462000
*     DO DAPMFCT0=APDXIOCT TO 1 BY-1;/* SCAN ALL APIO ENTRIES        */ 03463000
         L     @09,DAPDXPTR                                     02S1192 03464000
         LH    DAPMFCT0,APDXIOCT(,@09)                          02S1192 03465000
         B     @DE01192                                         02S1192 03466000
@DL01192 DS    0H                                               02S1193 03467000
*       IF APDXAPIO(DAPMFCT0)^=0 THEN/* IF APIO EXISTS FOR THIS SLOT */ 03468000
         LR    @11,DAPMFCT0                                     02S1193 03469000
         SLA   @11,2                                            02S1193 03470000
         L     @09,DAPDXPTR                                     02S1193 03471000
         L     @11,APDXAPIO-4(@11,@09)                          02S1193 03472000
         LTR   @11,@11                                          02S1193 03473000
         BZ    @RF01193                                         02S1193 03474000
*         IF(APDXAPIO(DAPMFCT0))->APIOFXED=BON THEN/* UPDATE COUNT   */ 03475000
         TM    APIOFXED(@11),B'10000000'                        02S1194 03476000
         BNO   @RF01194                                         02S1194 03477000
*           DAPMFCT1=DAPMFCT1+1;    /* OF APIOS. USE COUNT FOR PGFIX */ 03478000
         AL    DAPMFCT1,@CF00068                                02S1195 03479000
*         ELSE                      /* AT TRANSLATION (CT1) OR       */ 03480000
*           IF(APDXAPIO(DAPMFCT0))->APIORXLT=BON THEN/* RE-TRANSLATE */ 03481000
         B     @RC01194                                         02S1196 03482000
@RF01194 LR    @11,DAPMFCT0                                     02S1196 03483000
         SLA   @11,2                                            02S1196 03484000
         L     @09,DAPDXPTR                                     02S1196 03485000
         L     @11,APDXAPIO-4(@11,@09)                          02S1196 03486000
         TM    APIORXLT(@11),B'00010000'                        02S1196 03487000
         BNO   @RF01196                                         02S1196 03488000
*             DAPMFCT3=DAPMFCT3+1;  /* AT EXECUTION (CT3)    @ZA26916*/ 03489000
         AL    DAPMFCT3,@CF00068                                02S1197 03490000
*           ELSE                    /* OR                    @ZA26916*/ 03491000
*             DAPMFCT2=DAPMFCT2+1;  /* I/O EXECUTION (CT2).          */ 03492000
         B     @RC01196                                         02S1198 03493000
@RF01196 AL    DAPMFCT2,@CF00068                                02S1198 03494000
*     END;                          /* SCAN ALL APDXAPIO SLOTS       */ 03495000
@RC01196 DS    0H                                               02S1199 03496000
@RC01194 DS    0H                                               02S1199 03497000
@RF01193 BCTR  DAPMFCT0,0                                       02S1199 03498000
@DE01192 LTR   DAPMFCT0,DAPMFCT0                                02S1199 03499000
         BP    @DL01192                                         02S1199 03500000
*     DRETRY(03)=APESRTRY;          /* SAVE CURRENT RETRY POINT      */ 03501000
         L     @09,APESREGP                                     02S1200 03502000
         L     @15,APESRTRY(,@09)                               02S1200 03503000
         ST    @15,DRETRY+8                                     02S1200 03504000
*     APESRTRY=ADDR(SETSMF1);       /* CHANGE RECOVERY POINT         */ 03505000
         LA    @15,SETSMF1                                      02S1201 03506000
         ST    @15,APESRTRY(,@09)                               02S1201 03507000
*     APESCODE=CERRN32;             /* ERROR CODE                    */ 03508000
         MVI   APESCODE,X'20'                                   02S1202 03509000
*     GEN NOREFS NOSETS FLOWS(SETSMF1) SEQFLOW;                 02S1203 03510000
*                                   /* SHOW ERROR FLOW TO PL/S          03511000
*     GEN(MODESET EXTKEY=ZERO)                                  02S1204 03512000
*     NOREFS NOSETS;                /* SWITCH TO APMF ZERO (0)       */ 03513000
         MODESET EXTKEY=ZERO                                            03514000
*     APMFXRQT=APMFXRQT+1;          /* INCREMENT NO. XLTE REQUESTS   */ 03515000
         L     @09,DAPDXPTR                                     02S1205 03516000
         L     @09,APDXAPMF(,@09)                               02S1205 03517000
         LA    @15,1                                            02S1205 03518000
         LH    @14,APMFXRQT(,@09)                               02S1205 03519000
         ALR   @14,@15                                          02S1205 03520000
         STH   @14,APMFXRQT(,@09)                               02S1205 03521000
*     IF ADDR(DAPIO)->APIOFXED=BON THEN/* INCREMENT NO. OF REQUESTS  */ 03522000
         LA    @14,DAPIO                                        02S1206 03523000
         TM    APIOFXED(@14),B'10000000'                        02S1206 03524000
         BNO   @RF01206                                         02S1206 03525000
*       APMFXRQX=APMFXRQX+1;        /* WITH PGFIX AT TRANSLATION     */ 03526000
         AH    @15,APMFXRQX(,@09)                               02S1207 03527000
         STH   @15,APMFXRQX(,@09)                               02S1207 03528000
*     ELSE                          /* OR                            */ 03529000
*       IF ADDR(DAPIO)->APIORXLT=BON THEN/* RE-TRANSLATION AT I/O    */ 03530000
         B     @RC01206                                         02S1208 03531000
@RF01206 LA    @09,DAPIO                                        02S1208 03532000
         TM    APIORXLT(@09),B'00010000'                        02S1208 03533000
         BNO   @RF01208                                         02S1208 03534000
*         APMFXRQR=APMFXRQR+1;      /* EXECUTION             @ZA26916*/ 03535000
         L     @09,DAPDXPTR                                     02S1209 03536000
         L     @09,APDXAPMF(,@09)                               02S1209 03537000
         LA    @15,1                                            02S1209 03538000
         AH    @15,APMFXRQR(,@09)                               02S1209 03539000
         STH   @15,APMFXRQR(,@09)                               02S1209 03540000
*       ELSE                        /* OR                    @ZA26916*/ 03541000
*         APMFXRQI=APMFXRQI;        /* WITH PGFIX AT I/O.            */ 03542000
         B     @RC01208                                         02S1210 03543000
@RF01208 L     @09,DAPDXPTR                                     02S1210 03544000
         L     @09,APDXAPMF(,@09)                               02S1210 03545000
         LH    @15,APMFXRQI(,@09)                               02S1210 03546000
         STH   @15,APMFXRQI(,@09)                               02S1210 03547000
*     IF APMFXMXX<DAPMFCT1 THEN     /* SET APMFXMXX = MAX REQUESTS   */ 03548000
@RC01208 DS    0H                                               02S1211 03549000
@RC01206 L     @09,DAPDXPTR                                     02S1211 03550000
         L     @09,APDXAPMF(,@09)                               02S1211 03551000
         CH    DAPMFCT1,APMFXMXX(,@09)                          02S1211 03552000
         BNH   @RF01211                                         02S1211 03553000
*       APMFXMXX=DAPMFCT1;          /* WITH PGFIX AT XLTE OUTSTANDING*/ 03554000
         STH   DAPMFCT1,APMFXMXX(,@09)                          02S1212 03555000
*     IF APMFXMXI<DAPMFCT2 THEN     /* SET APMFXMXI = MAX REQUESTS   */ 03556000
@RF01211 L     @09,DAPDXPTR                                     02S1213 03557000
         L     @09,APDXAPMF(,@09)                               02S1213 03558000
         CH    DAPMFCT2,APMFXMXI(,@09)                          02S1213 03559000
         BNH   @RF01213                                         02S1213 03560000
*       APMFXMXI=DAPMFCT2;          /* WITH PGFIX AT I/O OUTSTANDING.*/ 03561000
         STH   DAPMFCT2,APMFXMXI(,@09)                          02S1214 03562000
*     IF APMFXMXR<DAPMFCT3 THEN     /* SET APMFXMXR = MAX REQUESTS   */ 03563000
@RF01213 L     @09,DAPDXPTR                                     02S1215 03564000
         L     @09,APDXAPMF(,@09)                               02S1215 03565000
         CH    DAPMFCT3,APMFXMXR(,@09)                          02S1215 03566000
         BNH   @RF01215                                         02S1215 03567000
*       APMFXMXR=DAPMFCT3;          /* WITH RE-TRANSLATION SPECIFIED */ 03568000
         STH   DAPMFCT3,APMFXMXR(,@09)                          02S1216 03569000
*     IF APMFXMXT<(DAPMFCT1+DAPMFCT2+DAPMFCT3) THEN/* SET APMFXMXX   */ 03570000
@RF01215 L     @09,DAPDXPTR                                     02S1217 03571000
         L     @09,APDXAPMF(,@09)                               02S1217 03572000
         LR    @15,DAPMFCT1                                     02S1217 03573000
         ALR   @15,DAPMFCT2                                     02S1217 03574000
         ALR   @15,DAPMFCT3                                     02S1217 03575000
         CH    @15,APMFXMXT(,@09)                               02S1217 03576000
         BNH   @RF01217                                         02S1217 03577000
*       APMFXMXT=DAPMFCT1+DAPMFCT2+DAPMFCT3;/* = MAX REQUESTS   02S1218 03578000
*                                      OUTSTANDING           @ZA26916*/ 03579000
         STH   @15,APMFXMXT(,@09)                               02S1218 03580000
*     GOTO SETSMF2;                 /* SKIP SMF RECOVERY             */ 03581000
*                                                               02S1219 03582000
         B     SETSMF2                                          02S1219 03583000
*     /***************************************************************/ 03584000
*     /*                                                             */ 03585000
*     /* SMF RECOVERY -- INDICATE IN SMF HEADER THAT DATA IS SUSPECT */ 03586000
*     /*                                                             */ 03587000
*     /***************************************************************/ 03588000
*                                                               02S1220 03589000
*SETSMF1:                           /* SMF UPDATE RECOVERY           */ 03590000
*     DO;                           /* ENTRY FROM ESTAE/FRR RETRY    */ 03591000
*                                                               02S1220 03592000
SETSMF1  DS    0H                                               02S1221 03593000
*       /*************************************************************/ 03594000
*       /*                                                           */ 03595000
*       /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE*/ 03596000
*       /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN       */ 03597000
*       /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION  */ 03598000
*       /* MEMORY OF CURRENT REGISTER VALUES                         */ 03599000
*       /*                                                           */ 03600000
*       /*************************************************************/ 03601000
*                                                               02S1221 03602000
*       RFY                                                     02S1221 03603000
*        (R0RSTD,                                               02S1221 03604000
*         R1RSTD,                                               02S1221 03605000
*         R2RSTD,                                               02S1221 03606000
*         R3RSTD,                                               02S1221 03607000
*         R4RSTD,                                               02S1221 03608000
*         R5RSTD,                   /* 6-7 BASES                     */ 03609000
*         R8RSTD,                                               02S1221 03610000
*         R9RSTD,                                               02S1221 03611000
*         R10RSTD,                                              02S1221 03612000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 03613000
*         R14RSTD,                                              02S1221 03614000
*         R15RSTD) RSTD;            /* KEEP PL/S FROM CARRYING DATA  */ 03615000
*       GEN(MODESET EXTKEY=DATAMGT);/* SWITCH TO STANDARD KEY (5)    */ 03616000
         MODESET EXTKEY=DATAMGT                                         03617000
*       RFY                                                     02S1223 03618000
*        (R0RSTD,                                               02S1223 03619000
*         R1RSTD,                                               02S1223 03620000
*         R2RSTD,                                               02S1223 03621000
*         R3RSTD,                                               02S1223 03622000
*         R4RSTD,                                               02S1223 03623000
*         R5RSTD,                   /* 6-7 BASES                     */ 03624000
*         R8RSTD,                                               02S1223 03625000
*         R9RSTD,                                               02S1223 03626000
*         R10RSTD,                                              02S1223 03627000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 03628000
*         R14RSTD,                                              02S1223 03629000
*         R15RSTD) UNRSTD;          /* ALLOW PL/S TO USE REGS AGAIN  */ 03630000
*     END;                          /* RETRY ENVIRONMENT SET         */ 03631000
*     APESRTRY=DRETRY(03);          /* NORMAL RECOVERY EXIT          */ 03632000
         L     @09,DRETRY+8                                     02S1225 03633000
         L     @04,APESREGP                                     02S1225 03634000
         ST    @09,APESRTRY(,@04)                               02S1225 03635000
*     DO;                           /* ERROR RECOVERY COMPLETE       */ 03636000
*       APESFPRV=BOFF;              /* RESET RECURSION FLAG.         */ 03637000
         NI    APESFPRV,B'10111111'                             02S1227 03638000
*       APESCODE=CERRN99;           /* RESET ERROR CODE              */ 03639000
         MVI   APESCODE,X'21'                                   02S1228 03640000
*       APESFDMP=BON;               /* RESET DUMP/LOG FLAGS          */ 03641000
*       APESFREC=BON;               /* TO THEIR NORMAL VALUES        */ 03642000
*       APESFSDP=BON;               /* (ALL ON)                      */ 03643000
         OI    APESFDMP,B'11100000'                             02S1231 03644000
*     END;                          /* ALL INDICATORS RESET          */ 03645000
*     APESCOD1=0;                   /* RESET ERROR CODE              */ 03646000
         MVI   APESCOD1,X'00'                                   02S1233 03647000
*     GEN(MODESET EXTKEY=ZERO)                                  02S1234 03648000
*     NOREFS NOSETS;                /* APMF KEY (0)                  */ 03649000
         MODESET EXTKEY=ZERO                                            03650000
*     APMFHISX=BON;                 /* SHOW SYSTEM DATA SUSPECT      */ 03651000
         L     @09,DAPDXPTR                                     02S1235 03652000
         L     @09,APDXAPMF(,@09)                               02S1235 03653000
         OI    APMFHISX(@09),B'01000000'                        02S1235 03654000
*     GEN(MODESET EXTKEY=DATAMGT)                               02S1236 03655000
*     NOREFS NOSETS;                /* NORMAL KEY                    */ 03656000
         MODESET EXTKEY=DATAMGT                                         03657000
*SETSMF2:                           /* SMF RECORD UPDATED            */ 03658000
*                                                               02S1237 03659000
*     /***************************************************************/ 03660000
*     /*                                                             */ 03661000
*     /* SMF RECORD UPDATED. RESTORE NORMAL RECOVERY ENVIRONMENT     */ 03662000
*     /*                                                             */ 03663000
*     /***************************************************************/ 03664000
*                                                               02S1237 03665000
*     APESRTRY=DRETRY(03);          /* NORMAL RECOVERY EXIT          */ 03666000
SETSMF2  L     @09,DRETRY+8                                     02S1237 03667000
         L     @04,APESREGP                                     02S1237 03668000
         ST    @09,APESRTRY(,@04)                               02S1237 03669000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 03670000
         MVI   APESCODE,X'21'                                   02S1238 03671000
*   END;                            /* END OF CODE SEGMENT           */ 03672000
         EJECT                                                          03673000
*                                                               01S1240 03674000
*   /*****************************************************************/ 03675000
*   /*                                                               */ 03676000
*   /* RELEASE THE LOCAL LOCK. ALL CRITICAL PROCESSING COMPLETE.     */ 03677000
*   /*                                                               */ 03678000
*   /*****************************************************************/ 03679000
*                                                               01S1240 03680000
*   CALL FREELLCK;                  /* RELEASE THE LOCAL LOCK        */ 03681000
         BAL   @14,FREELLCK                                     01S1240 03682000
*RESTAPRL:                          /* UPDATE USER'S APRL RETRY POINT*/ 03683000
*                                                               01S1241 03684000
*   /*****************************************************************/ 03685000
*   /*                                                               */ 03686000
*   /* SET THE RETURN CODE AND UPDATE THE USER'S APRL.               */ 03687000
*   /*                                                               */ 03688000
*   /*****************************************************************/ 03689000
*                                                               01S1241 03690000
*   DO;                             /* ENTRY FROM ESTAE/FRR RETRY    */ 03691000
*                                                               01S1241 03692000
RESTAPRL DS    0H                                               01S1242 03693000
*     /***************************************************************/ 03694000
*     /*                                                             */ 03695000
*     /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE  */ 03696000
*     /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN         */ 03697000
*     /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION    */ 03698000
*     /* MEMORY OF CURRENT REGISTER VALUES                           */ 03699000
*     /*                                                             */ 03700000
*     /***************************************************************/ 03701000
*                                                               01S1242 03702000
*     RFY                                                       01S1242 03703000
*      (R0RSTD,                                                 01S1242 03704000
*       R1RSTD,                                                 01S1242 03705000
*       R2RSTD,                                                 01S1242 03706000
*       R3RSTD,                                                 01S1242 03707000
*       R4RSTD,                                                 01S1242 03708000
*       R5RSTD,                     /* 6-7 BASES                     */ 03709000
*       R8RSTD,                                                 01S1242 03710000
*       R9RSTD,                                                 01S1242 03711000
*       R10RSTD,                                                01S1242 03712000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 03713000
*       R14RSTD,                                                01S1242 03714000
*       R15RSTD) RSTD;              /* KEEP PL/S FROM CARRYING DATA  */ 03715000
*     GEN(MODESET EXTKEY=DATAMGT);  /* SWITCH TO STANDARD KEY (5)    */ 03716000
         MODESET EXTKEY=DATAMGT                                         03717000
*     RFY                                                       01S1244 03718000
*      (R0RSTD,                                                 01S1244 03719000
*       R1RSTD,                                                 01S1244 03720000
*       R2RSTD,                                                 01S1244 03721000
*       R3RSTD,                                                 01S1244 03722000
*       R4RSTD,                                                 01S1244 03723000
*       R5RSTD,                     /* 6-7 BASES                     */ 03724000
*       R8RSTD,                                                 01S1244 03725000
*       R9RSTD,                                                 01S1244 03726000
*       R10RSTD,                                                01S1244 03727000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 03728000
*       R14RSTD,                                                01S1244 03729000
*       R15RSTD) UNRSTD;            /* ALLOW PL/S TO USE REGS AGAIN  */ 03730000
*   END;                            /* RETRY ENVIRONMENT SET         */ 03731000
*   APESRTRY=ADDR(CANESTAE);        /* PREVENT LOOP UPDATING APRL    */ 03732000
         LA    @09,CANESTAE                                     01S1246 03733000
         L     @04,APESREGP                                     01S1246 03734000
         ST    @09,APESRTRY(,@04)                               01S1246 03735000
*   DO;                             /* ERROR RECOVERY COMPLETE       */ 03736000
*     APESFPRV=BOFF;                /* RESET RECURSION FLAG.         */ 03737000
         NI    APESFPRV,B'10111111'                             01S1248 03738000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 03739000
         MVI   APESCODE,X'21'                                   01S1249 03740000
*     APESFDMP=BON;                 /* RESET DUMP/LOG FLAGS          */ 03741000
*     APESFREC=BON;                 /* TO THEIR NORMAL VALUES        */ 03742000
*     APESFSDP=BON;                 /* (ALL ON)                      */ 03743000
         OI    APESFDMP,B'11100000'                             01S1252 03744000
*   END;                            /* ALL INDICATORS RESET          */ 03745000
*   DO;                             /* START OF CODE SEGMENT         */ 03746000
*                                                               02S1254 03747000
*     /***************************************************************/ 03748000
*     /*                                                             */ 03749000
*     /* MOVE THE UPDATED PORTIONS OF THE APRL BACK TO THE USER'S    */ 03750000
*     /* COPY OF THE APRL. INCLUDED IN THE UPDATES ARE THE INDEX TO  */ 03751000
*     /* FIND THE APIO AS WELL AS APDX OVERRIDES OF VALUES SPECIFIED */ 03752000
*     /* IN THE APRL. IF AN ABEND OCCURS, IT SHOULD BE CONSIDERED A  */ 03753000
*     /* USER ERROR.                                                 */ 03754000
*     /*                                                             */ 03755000
*     /***************************************************************/ 03756000
*                                                               02S1255 03757000
*     CALL SETAPRL;                 /* APESCOD1 -> APRL VALUES       */ 03758000
         BAL   @14,SETAPRL                                      02S1255 03759000
*     APESCODE=CERRN02;             /* ERROR CODE -- BAD APRL        */ 03760000
         MVI   APESCODE,X'02'                                   02S1256 03761000
*     APESFSDP=BOFF;                /* SDUMP NOT REQUIRED            */ 03762000
         NI    APESFSDP,B'11011111'                             02S1257 03763000
*     SPKA(DUSERKEY);               /* SWITCH TO THE USER'S KEY      */ 03764000
         SLR   @09,@09                                          02S1258 03765000
         IC    @09,DUSERKEY                                     02S1258 03766000
         SPKA  0(@09)                                           02S1258 03767000
*     DAPRLPTR->APRLAPIO=APRLAPIO;  /* POINT APRL AT APIO (VIA APDX) */ 03768000
         L     @09,DAPRLPTR                                     02S1259 03769000
         L     @04,DAPRLXPT                                     02S1259 03770000
         L     @15,APRLAPIO(,@04)                               02S1259 03771000
         ST    @15,APRLAPIO(,@09)                               02S1259 03772000
*     DAPRLPTR->APRLOPTS=APRLOPTS;  /* RESTORE UPDATED OPTION FLAGS  */ 03773000
         MVC   APRLOPTS(4,@09),APRLOPTS(@04)                    02S1260 03774000
*     DAPRLPTR->APRLOPTZ=APRLOPTZ;  /* (APDS MERGE & PROCESSING)     */ 03775000
         MVC   APRLOPTZ(4,@09),APRLOPTZ(@04)                    02S1261 03776000
*     DAPRLPTR->APRLUSER=APRLUSER;  /* RESTORE INSTALLATION FIELD    */ 03777000
         L     @15,APRLUSER(,@04)                               02S1262 03778000
         ST    @15,APRLUSER(,@09)                               02S1262 03779000
*     DAPRLPTR->APRLFDBK=APRLFDBK;  /* RESTORE ERROR CODE (OR 0)     */ 03780000
         L     @15,APRLFDBK(,@04)                               02S1263 03781000
         ST    @15,APRLFDBK(,@09)                               02S1263 03782000
*     DAPRLPTR->APRLMSGN=APRLMSGN;  /* ERROR MSG NUMBER (OR 0)       */ 03783000
         LH    @15,APRLMSGN(,@04)                               02S1264 03784000
         STH   @15,APRLMSGN(,@09)                               02S1264 03785000
*     DAPRLPTR->APRLVALN=APRLVALN;  /* KEYWORD FOR ERROR MSG (OR 0)  */ 03786000
         LH    @04,APRLVALN(,@04)                               02S1265 03787000
         STH   @04,APRLVALN(,@09)                               02S1265 03788000
*     GEN(MODESET EXTKEY=DATAMGT)                               02S1266 03789000
*     NOREFS NOSETS;                /* RESUME THE NORMAL KEY         */ 03790000
         MODESET EXTKEY=DATAMGT                                         03791000
*     APESCODE=CERRN99;             /* DEFAULT ERROR CODE            */ 03792000
         MVI   APESCODE,X'21'                                   02S1267 03793000
*     APESFSDP=BON;                 /* RESET SDUMP REQUIRED          */ 03794000
         OI    APESFSDP,B'00100000'                             02S1268 03795000
*   END;                            /* END OF CODE SEGMENT           */ 03796000
*CANESTAE:                          /* CANCEL ESTAE (RETRY POINT)    */ 03797000
*                                                               01S1270 03798000
*   /*****************************************************************/ 03799000
*   /*                                                               */ 03800000
*   /* PROCESSING COMPLETE. DELETE THE ESTAE RECOVERY PROTECTION. THE*/ 03801000
*   /* REMAINING CODE (FREE THE WORKAREA AND SET THE REGISTER RETURN */ 03802000
*   /* CODE) IS NOT CRITCAL TO SYSTEM PERFORMANCE AND IS NOT REQUIRED*/ 03803000
*   /* TO BE UNDER THE ESTAE UMBRELLA.                               */ 03804000
*   /*                                                               */ 03805000
*   /*****************************************************************/ 03806000
*                                                               01S1270 03807000
*   DO;                             /* ENTRY FROM ESTAE/FRR RETRY    */ 03808000
*                                                               01S1270 03809000
CANESTAE DS    0H                                               01S1271 03810000
*     /***************************************************************/ 03811000
*     /*                                                             */ 03812000
*     /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE  */ 03813000
*     /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN         */ 03814000
*     /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION    */ 03815000
*     /* MEMORY OF CURRENT REGISTER VALUES                           */ 03816000
*     /*                                                             */ 03817000
*     /***************************************************************/ 03818000
*                                                               01S1271 03819000
*     RFY                                                       01S1271 03820000
*      (R0RSTD,                                                 01S1271 03821000
*       R1RSTD,                                                 01S1271 03822000
*       R2RSTD,                                                 01S1271 03823000
*       R3RSTD,                                                 01S1271 03824000
*       R4RSTD,                                                 01S1271 03825000
*       R5RSTD,                     /* 6-7 BASES                     */ 03826000
*       R8RSTD,                                                 01S1271 03827000
*       R9RSTD,                                                 01S1271 03828000
*       R10RSTD,                                                01S1271 03829000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 03830000
*       R14RSTD,                                                01S1271 03831000
*       R15RSTD) RSTD;              /* KEEP PL/S FROM CARRYING DATA  */ 03832000
*     GEN(MODESET EXTKEY=DATAMGT);  /* SWITCH TO STANDARD KEY (5)    */ 03833000
         MODESET EXTKEY=DATAMGT                                         03834000
*     RFY                                                       01S1273 03835000
*      (R0RSTD,                                                 01S1273 03836000
*       R1RSTD,                                                 01S1273 03837000
*       R2RSTD,                                                 01S1273 03838000
*       R3RSTD,                                                 01S1273 03839000
*       R4RSTD,                                                 01S1273 03840000
*       R5RSTD,                     /* 6-7 BASES                     */ 03841000
*       R8RSTD,                                                 01S1273 03842000
*       R9RSTD,                                                 01S1273 03843000
*       R10RSTD,                                                01S1273 03844000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 03845000
*       R14RSTD,                                                01S1273 03846000
*       R15RSTD) UNRSTD;            /* ALLOW PL/S TO USE REGS AGAIN  */ 03847000
*   END;                            /* RETRY ENVIRONMENT SET         */ 03848000
*   GEN REFS(FLCCVT,PSA,CVTSV60,CVTMAP,APSVPTR);                01S1275 03849000
*                                                /*                     03850000
         IGTYSTAE 0,                  CANCEL THE ESTAE ENVIRONMENT     *03851000
               BRANCH=YES,            BRANCH ENTRY USED                *03852000
               SVEAREA=(APSVPTR),     USE REGISTER 13 SAVEAREA         *03853000
               KEY=5                  CURRENTLY IN KEY-5 -- RESET       03854000
*EXIT:                              /* FREE SAVEAREA AND EXIT        */ 03855000
*                                                               01S1276 03856000
*   /*****************************************************************/ 03857000
*   /*                                                               */ 03858000
*   /* FREE THE SAVEAREA/WORKAREA USED FOR PROCESSING                */ 03859000
*   /*                                                               */ 03860000
*   /*****************************************************************/ 03861000
*                                                               01S1276 03862000
*   DO;                             /* ENTRY FROM ESTAE/FRR RETRY    */ 03863000
*                                                               01S1276 03864000
EXIT     DS    0H                                               01S1277 03865000
*     /***************************************************************/ 03866000
*     /*                                                             */ 03867000
*     /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE  */ 03868000
*     /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN         */ 03869000
*     /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION    */ 03870000
*     /* MEMORY OF CURRENT REGISTER VALUES                           */ 03871000
*     /*                                                             */ 03872000
*     /***************************************************************/ 03873000
*                                                               01S1277 03874000
*     RFY                                                       01S1277 03875000
*      (R0RSTD,                                                 01S1277 03876000
*       R1RSTD,                                                 01S1277 03877000
*       R2RSTD,                                                 01S1277 03878000
*       R3RSTD,                                                 01S1277 03879000
*       R4RSTD,                                                 01S1277 03880000
*       R5RSTD,                     /* 6-7 BASES                     */ 03881000
*       R8RSTD,                                                 01S1277 03882000
*       R9RSTD,                                                 01S1277 03883000
*       R10RSTD,                                                01S1277 03884000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 03885000
*       R14RSTD,                                                01S1277 03886000
*       R15RSTD) RSTD;              /* KEEP PL/S FROM CARRYING DATA  */ 03887000
*     GEN(MODESET EXTKEY=DATAMGT);  /* SWITCH TO STANDARD KEY (5)    */ 03888000
         MODESET EXTKEY=DATAMGT                                         03889000
*     RFY                                                       01S1279 03890000
*      (R0RSTD,                                                 01S1279 03891000
*       R1RSTD,                                                 01S1279 03892000
*       R2RSTD,                                                 01S1279 03893000
*       R3RSTD,                                                 01S1279 03894000
*       R4RSTD,                                                 01S1279 03895000
*       R5RSTD,                     /* 6-7 BASES                     */ 03896000
*       R8RSTD,                                                 01S1279 03897000
*       R9RSTD,                                                 01S1279 03898000
*       R10RSTD,                                                01S1279 03899000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 03900000
*       R14RSTD,                                                01S1279 03901000
*       R15RSTD) UNRSTD;            /* ALLOW PL/S TO USE REGS AGAIN  */ 03902000
*   END;                            /* RETRY ENVIRONMENT SET         */ 03903000
*   RFY                                                         01S1281 03904000
*     RERRCODE RSTD;                /* SET ERROR CODE                */ 03905000
*   RERRCODE=0;                     /* NORMAL ERROR CODE             */ 03906000
         SLR   RERRCODE,RERRCODE                                01S1282 03907000
*   IF APESCOD1^=0 THEN             /* IF ERROR DETECTED,            */ 03908000
         CLI   APESCOD1,0                                       01S1283 03909000
         BE    @RF01283                                         01S1283 03910000
*     RERRCODE=APCCRERR;            /* SET ERROR VALUE FOR REG 15.   */ 03911000
         LA    RERRCODE,8                                       01S1284 03912000
*   DO;                             /* IGTYFSV A(APSV)               */ 03913000
@RF01283 DS    0H                                               01S1286 03914000
*     RFY                                                       01S1286 03915000
*       GPR01P RSTD;                /* REG 1 SET TO AREA ADDRESS     */ 03916000
*     GPR01P=ADDR(APSV);            /* SET REG 1 TO ADDR OF AREA TO     03917000
*                                      FREE                          */ 03918000
         LR    GPR01P,APSVPTR                                   01S1287 03919000
*     CALL APCVZUAC;                /* FREE THE SAVEAREA-WORKAREA    */ 03920000
         L     @15,APCTZUAC(,APCTPTR)                           01S1288 03921000
         BALR  @14,@15                                          01S1288 03922000
*     RFY                                                       01S1289 03923000
*       GPR01P UNRSTD;              /* FINISHED WITH REG 1           */ 03924000
*   END;                            /* SAVEAREA-WORKAREA FREED FREE     03925000
*                                      THE SAVEAREA/WORKAREA         */ 03926000
*   RFY                                                         01S1291 03927000
*     R15F RSTD;                    /* RETURN CODE REGISTER          */ 03928000
*   R15F=RERRCODE;                  /* PUT RETURN CODE IN REGISTER 15*/ 03929000
         LR    R15F,RERRCODE                                    01S1292 03930000
*   SVC(3);                         /* RETURN TO THE DISPATCHER      */ 03931000
         SVC   3                                                01S1293 03932000
*   GEN NOREFS NOSETS EXIT;                                     01S1294 03933000
*                                  /*                                   03934000
*                                   NO CODE - SHOW THAT SVC 3 DOES      03935000
*                                   * NOT RETURN CONTROL                03936000
*   RFY                                                         01S1295 03937000
*    (RERRCODE,                                                 01S1295 03938000
*     R15F) UNRSTD;                 /* FINISHED WITH REGISTERS       */ 03939000
*                                                               01S1295 03940000
*   /*****************************************************************/ 03941000
*   /*                                                               */ 03942000
*   /* END OF MAINLINE CODE                                          */ 03943000
*   /*                                                               */ 03944000
*   /*****************************************************************/ 03945000
*                                                               01S1296 03946000
         EJECT                                                          03947000
*                                                               01S1296 03948000
*   /*****************************************************************/ 03949000
*   /*                                                               */ 03950000
*   /* ERROR RECOVERY BACK-OUT PROCESSING ROUTINE.                   */ 03951000
*   /*                                                               */ 03952000
*   /*****************************************************************/ 03953000
*                                                               01S1296 03954000
*RECOVER:                           /* (E)STAE RETRY ROUTINE         */ 03955000
*   DO;                             /* RECOVERY/BACKOUT LOGIC        */ 03956000
*                                                               02S1296 03957000
RECOVER  DS    0H                                               02S1297 03958000
*     /***************************************************************/ 03959000
*     /*                                                             */ 03960000
*     /* THIS ROUTINE IS THE (E)STAE RECOVERY ROUTINE. IT IS ALSO THE*/ 03961000
*     /* FRR RECOVERY ROUTINE. SOME ERRORS CAUSE THIS ROUTINE TO GAIN*/ 03962000
*     /* CONTROL DIRECTLY (IE AN ABEND) HAS NOT OCCURRED). THEREFORE */ 03963000
*     /* THIS ROUTINE MUST RELEASE CRITICAL RESOURCES AND SET THE    */ 03964000
*     /* APPROPRIATE ERROR FLAGS IN THE USER'S APRL. THEN CONTROL IS */ 03965000
*     /* PASSED TO THE NORMAL EXIT LOGIC.                            */ 03966000
*     /*                                                             */ 03967000
*     /***************************************************************/ 03968000
*                                                               02S1297 03969000
*     DO;                           /* ENTRY FROM ESTAE/FRR RETRY    */ 03970000
*                                                               02S1297 03971000
*       /*************************************************************/ 03972000
*       /*                                                           */ 03973000
*       /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE*/ 03974000
*       /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN       */ 03975000
*       /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION  */ 03976000
*       /* MEMORY OF CURRENT REGISTER VALUES                         */ 03977000
*       /*                                                           */ 03978000
*       /*************************************************************/ 03979000
*                                                               02S1298 03980000
*       RFY                                                     02S1298 03981000
*        (R0RSTD,                                               02S1298 03982000
*         R1RSTD,                                               02S1298 03983000
*         R2RSTD,                                               02S1298 03984000
*         R3RSTD,                                               02S1298 03985000
*         R4RSTD,                                               02S1298 03986000
*         R5RSTD,                   /* 6-7 BASES                     */ 03987000
*         R8RSTD,                                               02S1298 03988000
*         R9RSTD,                                               02S1298 03989000
*         R10RSTD,                                              02S1298 03990000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 03991000
*         R14RSTD,                                              02S1298 03992000
*         R15RSTD) RSTD;            /* KEEP PL/S FROM CARRYING DATA  */ 03993000
*       GEN(MODESET EXTKEY=DATAMGT);/* SWITCH TO STANDARD KEY (5)    */ 03994000
         MODESET EXTKEY=DATAMGT                                         03995000
*       RFY                                                     02S1300 03996000
*        (R0RSTD,                                               02S1300 03997000
*         R1RSTD,                                               02S1300 03998000
*         R2RSTD,                                               02S1300 03999000
*         R3RSTD,                                               02S1300 04000000
*         R4RSTD,                                               02S1300 04001000
*         R5RSTD,                   /* 6-7 BASES                     */ 04002000
*         R8RSTD,                                               02S1300 04003000
*         R9RSTD,                                               02S1300 04004000
*         R10RSTD,                                              02S1300 04005000
*         R11RSTD,                  /* 12-13 APCT/APSV PTRS          */ 04006000
*         R14RSTD,                                              02S1300 04007000
*         R15RSTD) UNRSTD;          /* ALLOW PL/S TO USE REGS AGAIN  */ 04008000
*     END;                          /* RETRY ENVIRONMENT SET         */ 04009000
*                                                               02S1301 04010000
*     /***************************************************************/ 04011000
*     /*                                                             */ 04012000
*     /* FREE NEW APIO IF ACQUIRED BUT NOT CHAINED TO APCTAPIO Q     */ 04013000
*     /*                                                             */ 04014000
*     /***************************************************************/ 04015000
*                                                               02S1302 04016000
*     IF DRCGM3=BON&                /* IF GETMAIN ISSUED, AND        */ 04017000
*         DAPIOPTR^=0 THEN          /* STORAGE ACQUIRED, THEN        */ 04018000
         TM    DRCGM3,B'00100000'                               02S1302 04019000
         BNO   @RF01302                                         02S1302 04020000
         L     @09,DAPIOPTR                                     02S1302 04021000
         LTR   @09,@09                                          02S1302 04022000
         BZ    @RF01302                                         02S1302 04023000
*       DO;                         /* FREE IT.                      */ 04024000
*         RFY                                                   02S1304 04025000
*           APIO BASED(DAPIOPTR);   /* ADDRESS OF APIO               */ 04026000
*         DRCGM3=BOFF;              /* PREVENT RECURSION             */ 04027000
         NI    DRCGM3,B'11011111'                               02S1305 04028000
*         DO;                       /* ERROR RECOVERY COMPLETE       */ 04029000
*           APESFPRV=BOFF;          /* RESET RECURSION FLAG.         */ 04030000
         NI    APESFPRV,B'10111111'                             02S1307 04031000
*           APESCODE=CERRN99;       /* RESET ERROR CODE              */ 04032000
         MVI   APESCODE,X'21'                                   02S1308 04033000
*           APESFDMP=BON;           /* RESET DUMP/LOG FLAGS          */ 04034000
*           APESFREC=BON;           /* TO THEIR NORMAL VALUES        */ 04035000
*           APESFSDP=BON;           /* (ALL ON)                      */ 04036000
         OI    APESFDMP,B'11100000'                             02S1311 04037000
*         END;                      /* ALL INDICATORS RESET          */ 04038000
*         RFY                                                   02S1313 04039000
*           R1P RSTD;               /* BUILD IGTUAG PARAMETER LIST   */ 04040000
*         R1P=ADDR(DAPGF);          /* POINT TO WORKAREA             */ 04041000
         LA    R1P,DAPGF                                        02S1314 04042000
*         RFY                                                   02S1315 04043000
*           APGF BASED(R1P);        /* TELL PL/S                     */ 04044000
*         APGF=APGF&&APGF;          /* CLEAR UNUSED FIELDS           */ 04045000
         XC    APGF(16,R1P),APGF(R1P)                           02S1316 04046000
*         APGFXSP=APIOSP;           /* SUBPOOL                       */ 04047000
         MVI   APGFXSP(R1P),X'E4'                               02S1317 04048000
*         APGFXKEY=APIOKEY;         /* KEY                           */ 04049000
         MVI   APGFXKEY(R1P),X'05'                              02S1318 04050000
*         APGFXLN=APIOLN;           /* LENGTH                        */ 04051000
         MVC   APGFXLN(4,R1P),@CF03134                          02S1319 04052000
*         APGFSUNC=BON;             /* UNCONDITIONAL FREEMAIN        */ 04053000
*         APGFSLCK=BON;             /* LOCAL LOCK OWNED              */ 04054000
*         APGFSFRE=BON;             /* FREEMAIN WANTED               */ 04055000
*         APGFSINA=BON;             /* INDIRECT ADDRESS POINTER      */ 04056000
         OI    APGFSUNC(R1P),B'10001011'                        02S1323 04057000
*         APGFXADR=ADDR(DAPIOPTR);  /* DAPIOPTR CONTAINS ADDRESS     */ 04058000
         LA    @09,DAPIOPTR                                     02S1324 04059000
         ST    @09,APGFXADR(,R1P)                               02S1324 04060000
*         CALL APCVZUAG;            /* FREE THE APIO                 */ 04061000
         L     @15,APCTZUAG(,APCTPTR)                           02S1325 04062000
         BALR  @14,@15                                          02S1325 04063000
*         RFY                                                   02S1326 04064000
*           R1P UNRSTD;             /* FINISHED WITH IGTUAG INPUT    */ 04065000
*         RFY                                                   02S1327 04066000
*           APIO BASED(ADDR(DAPIO));/* USE COPY -- REAL ONE GONE     */ 04067000
*       END;                        /* NEW APIO RELEASED             */ 04068000
*                                                               02S1328 04069000
*     /***************************************************************/ 04070000
*     /*                                                             */ 04071000
*     /* IF APIO SELECTED, RELEASE IT AND RESET APDXAPIO VALUE       */ 04072000
*     /*                                                             */ 04073000
*     /***************************************************************/ 04074000
*                                                               02S1329 04075000
*     IF DRCIO1=BON&                /* IF SELECTION STARTED          */ 04076000
*         DAPIOPTR^=0 THEN          /* AND APIO FOUND,               */ 04077000
@RF01302 TM    DRCIO1,B'00010000'                               02S1329 04078000
         BNO   @RF01329                                         02S1329 04079000
         L     @09,DAPIOPTR                                     02S1329 04080000
         SLR   @04,@04                                          02S1329 04081000
         CR    @09,@04                                          02S1329 04082000
         BE    @RF01329                                         02S1329 04083000
*       DO;                         /* RELEASE IT NOW.               */ 04084000
*         RFY                                                   02S1331 04085000
*           APIO BASED(DAPIOPTR);   /* REAL APIO ADDRESS             */ 04086000
*         DRCIO1=BOFF;              /* PREVENT RECURSION             */ 04087000
         NI    DRCIO1,B'11101111'                               02S1332 04088000
*         DO;                       /* ERROR RECOVERY COMPLETE       */ 04089000
*           APESFPRV=BOFF;          /* RESET RECURSION FLAG.         */ 04090000
         NI    APESFPRV,B'10111111'                             02S1334 04091000
*           APESCODE=CERRN99;       /* RESET ERROR CODE              */ 04092000
         MVI   APESCODE,X'21'                                   02S1335 04093000
*           APESFDMP=BON;           /* RESET DUMP/LOG FLAGS          */ 04094000
*           APESFREC=BON;           /* TO THEIR NORMAL VALUES        */ 04095000
*           APESFSDP=BON;           /* (ALL ON)                      */ 04096000
         OI    APESFDMP,B'11100000'                             02S1338 04097000
*         END;                      /* ALL INDICATORS RESET          */ 04098000
*         APIOASCB=0;               /* RELEASE THE APIO              */ 04099000
         ST    @04,APIOASCB(,@09)                               02S1340 04100000
*         DAPIOPTR=0;               /* SHOW NOT OWNED                */ 04101000
         ST    @04,DAPIOPTR                                     02S1341 04102000
*         APDXAPIO(DAPIOCT0)=0;     /* INSURE 'RLSE' WON'T TRY       */ 04103000
         L     @09,DAPIOCT0                                     02S1342 04104000
         SLA   @09,2                                            02S1342 04105000
         L     @01,DAPDXPTR                                     02S1342 04106000
         ST    @04,APDXAPIO-4(@09,@01)                          02S1342 04107000
*         RFY                                                   02S1343 04108000
*           APIO BASED(ADDR(DAPIO));/* USE COPY -- REAL ONE GONE     */ 04109000
*       END;                        /* APIO RELEASED                 */ 04110000
*     RFY                                                       02S1345 04111000
*       APIO BASED(ADDR(DAPIO));    /* USE COPY. REAL APIO RELEASED  */ 04112000
*                                                               02S1345 04113000
@RF01329 DS    0H                                               02S1346 04114000
*     /***************************************************************/ 04115000
*     /*                                                             */ 04116000
*     /* FREE CMS LOCK, IF OWNED                                     */ 04117000
*     /*                                                             */ 04118000
*     /***************************************************************/ 04119000
*                                                               02S1346 04120000
*     IF APESFXLK=BON THEN          /* IF CMS LOCK OWNED,            */ 04121000
         TM    APESFXLK,B'00010000'                             02S1346 04122000
         BNO   @RF01346                                         02S1346 04123000
*       DO;                         /* THEN RELEASE IT.              */ 04124000
*         CALL FREEXLCK;            /* RELEASE CMS LOCK              */ 04125000
         BAL   @14,FREEXLCK                                     02S1348 04126000
*         DO;                       /* ERROR RECOVERY COMPLETE       */ 04127000
*           APESFPRV=BOFF;          /* RESET RECURSION FLAG.         */ 04128000
         NI    APESFPRV,B'10111111'                             02S1350 04129000
*           APESCODE=CERRN99;       /* RESET ERROR CODE              */ 04130000
         MVI   APESCODE,X'21'                                   02S1351 04131000
*           APESFDMP=BON;           /* RESET DUMP/LOG FLAGS          */ 04132000
*           APESFREC=BON;           /* TO THEIR NORMAL VALUES        */ 04133000
*           APESFSDP=BON;           /* (ALL ON)                      */ 04134000
         OI    APESFDMP,B'11100000'                             02S1354 04135000
*         END;                      /* ALL INDICATORS RESET          */ 04136000
*       END;                        /* CMS LOCK RELEASED             */ 04137000
*                                                               02S1356 04138000
*     /***************************************************************/ 04139000
*     /*                                                             */ 04140000
*     /* IF USER BUFFERS FIXED, THEN RELEASE NOW                     */ 04141000
*     /*                                                             */ 04142000
*     /***************************************************************/ 04143000
*                                                               02S1357 04144000
*     IF DRCPF2=BON THEN            /* IF PGFIX ISSUED,              */ 04145000
@RF01346 TM    DRCPF2,B'00000100'                               02S1357 04146000
         BNO   @RF01357                                         02S1357 04147000
*       DO;                         /* MUST FREE NOW                 */ 04148000
*         DRCPF2=BOFF;              /* PREVENT RECURSION             */ 04149000
         NI    DRCPF2,B'11111011'                               02S1359 04150000
*         DO;                       /* ERROR RECOVERY COMPLETE       */ 04151000
*           APESFPRV=BOFF;          /* RESET RECURSION FLAG.         */ 04152000
         NI    APESFPRV,B'10111111'                             02S1361 04153000
*           APESCODE=CERRN99;       /* RESET ERROR CODE              */ 04154000
         MVI   APESCODE,X'21'                                   02S1362 04155000
*           APESFDMP=BON;           /* RESET DUMP/LOG FLAGS          */ 04156000
*           APESFREC=BON;           /* TO THEIR NORMAL VALUES        */ 04157000
*           APESFSDP=BON;           /* (ALL ON)                      */ 04158000
         OI    APESFDMP,B'11100000'                             02S1365 04159000
*         END;                      /* ALL INDICATORS RESET          */ 04160000
*         RFY                                                   02S1367 04161000
*          (R0P,                                                02S1367 04162000
*           R1P,                                                02S1367 04163000
*           R4P) RSTD;              /* PGFREE REGS                   */ 04164000
*         R0P=ADDR(DECB);           /* ECB USED BY PGFIX             */ 04165000
         LA    R0P,DECB                                         02S1368 04166000
*         R1P=APIOPGFX|             /* PGFREE LIST                   */ 04167000
*             '80000000'X;          /* SHOW LIST FORMAT              */ 04168000
         LA    @09,DAPIO                                        02S1369 04169000
         L     R1P,APIOPGFX(,@09)                               02S1369 04170000
         O     R1P,@CF04035                                     02S1369 04171000
*         R1P->VSLFLAG1='00'X;      /* CLEAR FLAGS                   */ 04172000
         MVI   VSLFLAG1(R1P),X'00'                              02S1370 04173000
*         R1P->VSLFREE=BON;         /* SHOW PGFREE                   */ 04174000
         OI    VSLFREE(R1P),B'00100000'                         02S1371 04175000
*         R4P=SRBPTCB;              /* TCB WHICH OPENED ACB          */ 04176000
         L     R4P,SRBPTCB+128(,@09)                            02S1372 04177000
*         GEN(MODESET EXTKEY=ZERO)                              02S1373 04178000
*         NOREFS NOSETS;            /* PGFIX KEY MUST BE 0           */ 04179000
         MODESET EXTKEY=ZERO                                            04180000
*         CALL IEAVPSI;             /* FREE BUFFERS                  */ 04181000
         L     @09,CVTPTR                                       02S1374 04182000
         L     @15,CVTVPSIB(,@09)                               02S1374 04183000
         BALR  @14,@15                                          02S1374 04184000
*         RFY                                                   02S1375 04185000
*          (R0P,                                                02S1375 04186000
*           R1P,                                                02S1375 04187000
*           R4P) UNRSTD;            /* DONE WITH PGFREE REGISTERS    */ 04188000
*         GEN(MODESET EXTKEY=DATAMGT)                           02S1376 04189000
*         NOREFS NOSETS;                                        02S1376 04190000
         MODESET EXTKEY=DATAMGT                                         04191000
*         RFY                                                   02S1377 04192000
*           R15F RSTD;              /* RETURN CODE                   */ 04193000
*         IF R15F^=0 THEN           /* IF PGFREE ERROR,              */ 04194000
         LTR   R15F,R15F                                        02S1378 04195000
         BZ    @RF01378                                         02S1378 04196000
*           DO;                     /* FORCE ABEND TO LOG ERROR &       04197000
*                                      PASS CONTROL TO THE (E)STAE OR   04198000
*                                      FRR EXIT ROUTINE.             */ 04199000
*             DO;                   /* ABEND(APCTABND)               */ 04200000
*               RESPECIFY                                       02S1381 04201000
*                (GPR01F) RESTRICTED;                           02S1381 04202000
*               GPR01F=APCTABND;    /* COMP CODE IN REG 1            */ 04203000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1382 04204000
*               SVC(13);            /* ISSUE ABEND SVC               */ 04205000
         SVC   13                                               02S1383 04206000
*               RESPECIFY                                       02S1384 04207000
*                (GPR01F) UNRESTRICTED;                         02S1384 04208000
*             END;                  /* ABEND(APCTABND) FORCE ABEND   */ 04209000
*             GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      02S1386 04210000
*                                                  /* NO CODE           04211000
*           END;                    /* ABEND ISSUED                  */ 04212000
*         RFY                                                   02S1388 04213000
*           R15F UNRSTD;            /* DONE WITH RETURN CODE         */ 04214000
@RF01378 DS    0H                                               02S1389 04215000
*       END;                        /* PGFREE PROCESSED              */ 04216000
*                                                               02S1389 04217000
*     /***************************************************************/ 04218000
*     /*                                                             */ 04219000
*     /* IF VSL ENTRIES FIXED, THEN RELEASE NOW                      */ 04220000
*     /*                                                             */ 04221000
*     /***************************************************************/ 04222000
*                                                               02S1390 04223000
*     IF DRCPF1=BON THEN            /* IF VSL ENTRIES HAVE BEEN      */ 04224000
@RF01357 TM    DRCPF1,B'00001000'                               02S1390 04225000
         BNO   @RF01390                                         02S1390 04226000
*       DO;                         /* FIXED, RELEASE NOW.           */ 04227000
*         DRCPF1=BOFF;              /* PREVENT RECURSION             */ 04228000
         NI    DRCPF1,B'11110111'                               02S1392 04229000
*         DO;                       /* ERROR RECOVERY COMPLETE       */ 04230000
*           APESFPRV=BOFF;          /* RESET RECURSION FLAG.         */ 04231000
         NI    APESFPRV,B'10111111'                             02S1394 04232000
*           APESCODE=CERRN99;       /* RESET ERROR CODE              */ 04233000
         MVI   APESCODE,X'21'                                   02S1395 04234000
*           APESFDMP=BON;           /* RESET DUMP/LOG FLAGS          */ 04235000
*           APESFREC=BON;           /* TO THEIR NORMAL VALUES        */ 04236000
*           APESFSDP=BON;           /* (ALL ON)                      */ 04237000
         OI    APESFDMP,B'11100000'                             02S1398 04238000
*         END;                      /* ALL INDICATORS RESET          */ 04239000
*         RFY                                                   02S1400 04240000
*          (R0P,                                                02S1400 04241000
*           R1P,                                                02S1400 04242000
*           R2P,                                                02S1400 04243000
*           R4P) RSTD;              /* PGFREE REGISTERS              */ 04244000
*         R0P=ADDR(DECB);           /* ECB USED BY PGFIX             */ 04245000
         LA    R0P,DECB                                         02S1401 04246000
*         R1P=APIOPGFX|             /* FREE VSL ENTRIES. SHOW PGFREE */ 04247000
*             '20000000'X;          /* & REGISTER FORM (BIT0=0).     */ 04248000
         LA    @09,DAPIO                                        02S1402 04249000
         L     R1P,APIOPGFX(,@09)                               02S1402 04250000
         O     R1P,@CF04092                                     02S1402 04251000
*         R2P=(APIOPGFL+LENGTH(VSL))|/* END OF VSL ENTRIES + 1       */ 04252000
*             '80000000'X;          /* SHOW END OF LIST.             */ 04253000
         LA    R2P,8                                            02S1403 04254000
         AL    R2P,APIOPGFL(,@09)                               02S1403 04255000
         O     R2P,@CF04035                                     02S1403 04256000
*         R4P=SRBPTCB;              /* TCB WHICH OPENED ACB          */ 04257000
         L     R4P,SRBPTCB+128(,@09)                            02S1404 04258000
*         GEN(MODESET EXTKEY=ZERO)                              02S1405 04259000
*         NOREFS NOSETS;            /* PGFREE REQUIRES KEY-0         */ 04260000
         MODESET EXTKEY=ZERO                                            04261000
*         CALL IEAVPSI;             /* FREE THE PAGES                */ 04262000
         L     @09,CVTPTR                                       02S1406 04263000
         L     @15,CVTVPSIB(,@09)                               02S1406 04264000
         BALR  @14,@15                                          02S1406 04265000
*         RFY                                                   02S1407 04266000
*          (R0P,                                                02S1407 04267000
*           R1P,                                                02S1407 04268000
*           R2P,                                                02S1407 04269000
*           R4P) UNRSTD;            /* DONE WITH REGS                */ 04270000
*         RFY                                                   02S1408 04271000
*           R15F RSTD;              /* PSI RETURN CODE               */ 04272000
*         GEN(MODESET EXTKEY=DATAMGT)                           02S1409 04273000
*         NOREFS NOSETS;            /* NORMAL KEY                    */ 04274000
         MODESET EXTKEY=DATAMGT                                         04275000
*         IF R15F^=0 THEN           /* IF ERROR DETECTED,            */ 04276000
         LTR   R15F,R15F                                        02S1410 04277000
         BZ    @RF01410                                         02S1410 04278000
*           DO;                     /* FORCE ABEND TO LOG ERROR &       04279000
*                                      PASS CONTROL TO THE (E)STAE OR   04280000
*                                      FRR EXIT ROUTINE.             */ 04281000
*             DO;                   /* ABEND(APCTABND)               */ 04282000
*               RESPECIFY                                       02S1413 04283000
*                (GPR01F) RESTRICTED;                           02S1413 04284000
*               GPR01F=APCTABND;    /* COMP CODE IN REG 1            */ 04285000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1414 04286000
*               SVC(13);            /* ISSUE ABEND SVC               */ 04287000
         SVC   13                                               02S1415 04288000
*               RESPECIFY                                       02S1416 04289000
*                (GPR01F) UNRESTRICTED;                         02S1416 04290000
*             END;                  /* ABEND(APCTABND) FORCE ABEND   */ 04291000
*             GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      02S1418 04292000
*                                                  /* NO CODE           04293000
*           END;                    /* ABEND ISSUED                  */ 04294000
*         RFY                                                   02S1420 04295000
*           R15F UNRSTD;            /* RETURN CODE PROCESSED         */ 04296000
@RF01410 DS    0H                                               02S1421 04297000
*       END;                        /* VSL ENTRIES RELEASED          */ 04298000
*                                                               02S1421 04299000
*     /***************************************************************/ 04300000
*     /*                                                             */ 04301000
*     /* IF PERMANENT STORAGE FOR CCWS, ETC. ACQUIRED, FREE THEM.    */ 04302000
*     /*                                                             */ 04303000
*     /***************************************************************/ 04304000
*                                                               02S1422 04305000
*     IF DRCGM2=BON&                /* IF STORAGE FOR CCWS           */ 04306000
*         APIOGMAD^=0 THEN          /* APXL, ETC. ACQUIRED           */ 04307000
@RF01390 TM    DRCGM2,B'01000000'                               02S1422 04308000
         BNO   @RF01422                                         02S1422 04309000
         LA    @09,DAPIO                                        02S1422 04310000
         L     @04,APIOGMAD(,@09)                               02S1422 04311000
         LTR   @04,@04                                          02S1422 04312000
         BZ    @RF01422                                         02S1422 04313000
*       DO;                         /* THEN FREE NOW.                */ 04314000
*         DRCGM2=BOFF;              /* PREVENT RECURSION             */ 04315000
         NI    DRCGM2,B'10111111'                               02S1424 04316000
*         DO;                       /* ERROR RECOVERY COMPLETE       */ 04317000
*           APESFPRV=BOFF;          /* RESET RECURSION FLAG.         */ 04318000
         NI    APESFPRV,B'10111111'                             02S1426 04319000
*           APESCODE=CERRN99;       /* RESET ERROR CODE              */ 04320000
         MVI   APESCODE,X'21'                                   02S1427 04321000
*           APESFDMP=BON;           /* RESET DUMP/LOG FLAGS          */ 04322000
*           APESFREC=BON;           /* TO THEIR NORMAL VALUES        */ 04323000
*           APESFSDP=BON;           /* (ALL ON)                      */ 04324000
         OI    APESFDMP,B'11100000'                             02S1430 04325000
*         END;                      /* ALL INDICATORS RESET          */ 04326000
*         RFY                                                   02S1432 04327000
*           R1P RSTD;               /* BUILD INTERFACE               */ 04328000
*         RFY                                                   02S1433 04329000
*           APGF BASED(R1P);        /* IGTUAG.                       */ 04330000
*         APGF=APGF&&APGF;          /* RESET FIELDS                  */ 04331000
         XC    APGF(16,R1P),APGF(R1P)                           02S1434 04332000
*         APGFXSP=APXLSP;           /* SUBPOOL                       */ 04333000
         MVI   APGFXSP(R1P),X'E6'                               02S1435 04334000
*         APGFXKEY=APXLKEY;         /* KEY                           */ 04335000
         MVI   APGFXKEY(R1P),X'05'                              02S1436 04336000
*         APGFXLN=APIOGMS1;         /* SIZE                          */ 04337000
         LH    @04,APIOGMS1(,@09)                               02S1437 04338000
         ST    @04,APGFXLN(,R1P)                                02S1437 04339000
*         APGFXADR=ADDR(APIOGMAD);  /* ADDRESS OF AREA (INDIRECT)    */ 04340000
         LA    @09,APIOGMAD(,@09)                               02S1438 04341000
         ST    @09,APGFXADR(,R1P)                               02S1438 04342000
*         APGFSUNC=BON;             /* UNCONDITIONAL FREEMAIN        */ 04343000
*         APGFSLCK=BON;             /* LOCAL LOCK OWNED              */ 04344000
*         APGFSFRE=BON;             /* FREEMAIN WANTED               */ 04345000
*         APGFSINA=BON;             /* INDIRECT ADDRESSING FOR XADR  */ 04346000
         OI    APGFSUNC(R1P),B'10001011'                        02S1442 04347000
*         CALL APCVZUAG;            /* ISSUE THE FREEMAIN            */ 04348000
         L     @15,APCTZUAG(,APCTPTR)                           02S1443 04349000
         BALR  @14,@15                                          02S1443 04350000
*         RFY                                                   02S1444 04351000
*           R1P UNRSTD;             /* DONE WITH APGF,               */ 04352000
*         RFY                                                   02S1445 04353000
*           APGF;                   /* THE IGTUAG PARAMETER LIST     */ 04354000
*       END;                        /* STORAGE RELEASED              */ 04355000
*                                                               02S1446 04356000
*     /***************************************************************/ 04357000
*     /*                                                             */ 04358000
*     /* UPDATE THE APRL (PROTECTED COPY) TO ELIMINATE INDICATIONS   */ 04359000
*     /* THAT THE TRANSLATION WORKED                                 */ 04360000
*     /*                                                             */ 04361000
*     /***************************************************************/ 04362000
*                                                               02S1447 04363000
*     ADDR(DAPRL)->APRLAPIO=0;      /* CLEAR APIO INDEX              */ 04364000
@RF01422 LA    @09,DAPRL                                        02S1447 04365000
         SLR   @04,@04                                          02S1447 04366000
         ST    @04,APRLAPIO(,@09)                               02S1447 04367000
*     ADDR(DAPRL)->APRLXIO=BOFF;    /* APRL NOTR TRANSLATED          */ 04368000
         NI    APRLXIO(@09),B'11111011'                         02S1448 04369000
*   END;                            /* END OF CODE SECTION           */ 04370000
*   GOTO RESTAPRL;                  /* UPDATE THE USER'S APRL AND       04371000
*                                      EXIT                          */ 04372000
         B     RESTAPRL                                         01S1450 04373000
         EJECT                                                          04374000
*                                                               01S1451 04375000
*   /*****************************************************************/ 04376000
*   /*                                                               */ 04377000
*   /* INTERNAL SUBROUTINES                                          */ 04378000
*   /*                                                               */ 04379000
*   /*****************************************************************/ 04380000
*                                                               01S1451 04381000
*REFSTOR:                           /* VERIFY THAT STORAGE           */ 04382000
*   PROC                            /* IS VALID AND IN THE           */ 04383000
*       OPTIONS(PARMREG,NOSAVEAREA);/* USER'S PROTECT KEY            */ 04384000
*                                                               02S1451 04385000
REFSTOR  STM   @14,@12,12(@13)                                  02S1451 04386000
*   /*****************************************************************/ 04387000
*   /*                                                               */ 04388000
*   /* INSURE THE SPECIFIED STORAGE IS OWNED BY THE USER. ON INPUT,  */ 04389000
*   /* REGISTER 1 HAS THE STARTING ADDRESS TO CHECK, AND REGISTER 0  */ 04390000
*   /* HAS THE LENGTH TO CHECK. SWITCH TO THE USER'S KEY AND UPDATE  */ 04391000
*   /* EACH PAGE. UPDATE THE STORAGE WITH ITS CURRENT CONTENTS SO THE*/ 04392000
*   /* STORAGE IS NOT ACTUALLY MODIFIED.                             */ 04393000
*   /*                                                               */ 04394000
*   /*****************************************************************/ 04395000
*                                                               02S1452 04396000
*   RFY                                                         02S1452 04397000
*    (R1P,                                                      02S1452 04398000
*     R0F) RSTD;                    /* INPUT REGISTERS               */ 04399000
*   R0F=(R1P+R0F-1)&CRNDPGDN;       /* LAST PAGE TO CHECK            */ 04400000
         L     @09,@CF03929                                     02S1453 04401000
         LR    @04,R1P                                          02S1453 04402000
         ALR   @04,R0F                                          02S1453 04403000
         BCTR  @04,0                                            02S1453 04404000
         NR    @04,@09                                          02S1453 04405000
         LR    R0F,@04                                          02S1453 04406000
*   R1P=R1P&CRNDPGDN;               /* FIRST PAGE TO CHECK           */ 04407000
         NR    R1P,@09                                          02S1454 04408000
*   APESCODE=CERRN21;               /* SET ERROR CODE                */ 04409000
         MVI   APESCODE,X'15'                                   02S1455 04410000
*   APESFSDP=BOFF;                  /* SDUMP NOT NEEDED              */ 04411000
         NI    APESFSDP,B'11011111'                             02S1456 04412000
*   SPKA(DUSERKEY);                 /* SWITCH TO THE USER'S KEY      */ 04413000
         SLR   @09,@09                                          02S1457 04414000
         IC    @09,DUSERKEY                                     02S1457 04415000
         SPKA  0(@09)                                           02S1457 04416000
*   DO R1P=R1P BY CPGSIZE TO R0F;   /* CHECK EACH PAGE               */ 04417000
         B     @DE01458                                         02S1458 04418000
@DL01458 DS    0H                                               02S1459 04419000
*     RFY                                                       02S1459 04420000
*       R14F RSTD;                  /* USE COMPARE-AND-SWAP TO       */ 04421000
*     R14F=R1P->I031F;              /* 'UPDATE' EACH PAGE (NO        */ 04422000
         L     R14F,I031F(,R1P)                                 02S1460 04423000
*REFSTOR1:                          /* UPDATE ACTUALLY MADE)         */ 04424000
*     CS(R14F,R14F,R1P->I031F);     /* IN CASE MP. NOTE: STORAGE     */ 04425000
REFSTOR1 CS    R14F,@14,I031F(R1P)                              02S1461 04426000
*     BC(7,REFSTOR1);               /* IN SAME PAGE, NOT REQUIRED    */ 04427000
         BC    7,REFSTOR1                                       02S1462 04428000
*     RFY                           /* TO BE PART OF THE CCW BUFFER. */ 04429000
*       R14F UNRSTD;                /* 0C4 IF BAD BUFFER             */ 04430000
*   END;                            /* CONTINUE LOOP                 */ 04431000
         AL    R1P,@CF03922                                     02S1464 04432000
@DE01458 CR    R1P,R0F                                          02S1464 04433000
         BNH   @DL01458                                         02S1464 04434000
*   RFY                                                         02S1465 04435000
*    (R0P,                                                      02S1465 04436000
*     R1F) UNRSTD;                  /* FINISHED WITH REGISTERS       */ 04437000
*   GEN(MODESET EXTKEY=DATAMGT)                                 02S1466 04438000
*   NOREFS NOSETS;                  /* RESUME NORMAL KEY             */ 04439000
         MODESET EXTKEY=DATAMGT                                         04440000
*   APESCODE=CERRN99;               /* RESET ERROR CODE              */ 04441000
         MVI   APESCODE,X'21'                                   02S1467 04442000
*   APESFSDP=BON;                   /* RESET SDUMP INDICATOR         */ 04443000
         OI    APESFSDP,B'00100000'                             02S1468 04444000
*   RETURN;                         /* RETURN -- STORAGE OK          */ 04445000
@EL00002 DS    0H                                               02S1469 04446000
@EF00002 DS    0H                                               02S1469 04447000
@ER00002 LM    @14,@12,12(@13)                                  02S1469 04448000
         BR    @14                                              02S1469 04449000
*   END;                            /* END OF PROCEDURE              */ 04450000
         EJECT                                                          04451000
*ADDVSL:                            /* ADD PGFIX/PGFREE VSL ENTRY    */ 04452000
*   PROC                            /* REGISTERS 0 & 1 HAVE INPUT    */ 04453000
*       OPTIONS(PARMREG,            /* PRESERVE REGISTERS 0 & 1      */ 04454000
*       NOSAVEAREA);                /* DO NOT CALL ANYONE.           */ 04455000
*                                                               02S1471 04456000
ADDVSL   STM   @14,@12,12(@13)                                  02S1471 04457000
*   /*****************************************************************/ 04458000
*   /*                                                               */ 04459000
*   /* ADD AN ENTRY TO THE PGFIX/PGFREE LIST. ON ENTRY, REGISTER 0   */ 04460000
*   /* CONTAINS THE STARTING ADDRESS & REGISTER 1 THE LENGTH OF THE  */ 04461000
*   /* AREA TO FIX. IF THE NEW ENTRY DOES NOT FIT IN THE PAGE-FIX    */ 04462000
*   /* LIST, SET AN ERROR FLAG & TERMINATE THE REQUEST. OTHERWISE THE*/ 04463000
*   /* NEW ENTRY IS ADDED TO THE VSL TABLE. THE START/END ADDRESSES  */ 04464000
*   /* OF THE VIRTUAL STORAGE TO BE FIXED ARE ROUNDED TO PAGE        */ 04465000
*   /* BOUNDARIES (USED BY SORTVSL TO BUILD FINAL PGFIX/PGFREE LIST).*/ 04466000
*   /*                                                               */ 04467000
*   /*****************************************************************/ 04468000
*                                                               02S1472 04469000
*   IF DSW0FCCW=BOFF THEN           /* IF NOT FAKE CCW (RE-TRANS)    */ 04470000
         TM    DSW0FCCW,B'10000000'                             02S1472 04471000
         BNZ   @RF01472                                         02S1472 04472000
*     DO;                           /* ADD VSL ENTRY.        @ZA26916*/ 04473000
*       RFY                                                     02S1474 04474000
*         VSL BASED(DVSLCUR);       /* PGFIX/PGFREE ENTRY OVERLAY    */ 04475000
*       IF ADDR(VSL)>=DVSLEND THEN  /* IF PAST VSL WORKAREA, SET     */ 04476000
         CLC   DVSLCUR(4),DVSLEND                               02S1475 04477000
         BL    @RF01475                                         02S1475 04478000
*         DO;                       /* ERROR INDICATOR AND           */ 04479000
*           APESCODE=CERRN18;       /* GO TO THE                     */ 04480000
         MVI   APESCODE,X'12'                                   02S1477 04481000
*           DO;                     /* FORCE ABEND TO LOG ERROR &       04482000
*                                      PASS CONTROL TO THE (E)STAE OR   04483000
*                                      FRR EXIT ROUTINE.             */ 04484000
*             DO;                   /* ABEND(APCTABND)               */ 04485000
*               RESPECIFY                                       02S1480 04486000
*                (GPR01F) RESTRICTED;                           02S1480 04487000
*               GPR01F=APCTABND;    /* COMP CODE IN REG 1            */ 04488000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1481 04489000
*               SVC(13);            /* ISSUE ABEND SVC               */ 04490000
         SVC   13                                               02S1482 04491000
*               RESPECIFY                                       02S1483 04492000
*                (GPR01F) UNRESTRICTED;                         02S1483 04493000
*             END;                  /* ABEND(APCTABND) FORCE ABEND   */ 04494000
*             GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      02S1485 04495000
*                                                  /* NO CODE           04496000
*           END;                    /* ABEND ISSUED                  */ 04497000
*         END;                      /* ERROR PROCESSED.              */ 04498000
*       ELSE                        /* IF NEW VSL ENTRY FITS, THEN   */ 04499000
*         DO;                       /* ADD TO LIST AND CLEAR FLAGS   */ 04500000
@RF01475 DS    0H                                               02S1489 04501000
*           VSLSTRT=R0P&CRNDPGDN;   /* STARTING ADDRESS ROUNDED DOWN    04502000
*                                      TO PAGE BOUNDARY.             */ 04503000
         L     @09,DVSLCUR                                      02S1489 04504000
         L     @04,@CF03929                                     02S1489 04505000
         LR    @15,R0P                                          02S1489 04506000
         NR    @15,@04                                          02S1489 04507000
         ST    @15,VSLSTRT(,@09)                                02S1489 04508000
*           VSLEND=(R0P+R1P+CRNDPGUP)&/* ENDING ADDRESS ROUNDED      */ 04509000
*               CRNDPGDN;           /* UP TO PAGE BOUNDARY.          */ 04510000
         LR    @15,R0P                                          02S1490 04511000
         ALR   @15,R1P                                          02S1490 04512000
         AL    @15,@CF03931                                     02S1490 04513000
         NR    @15,@04                                          02S1490 04514000
         ST    @15,VSLEND(,@09)                                 02S1490 04515000
*           DVSLCUR=ADDR(VSL)+LENGTH(VSL);/* NEXT VSL SLOT           */ 04516000
         AL    @09,@CF00037                                     02S1491 04517000
         ST    @09,DVSLCUR                                      02S1491 04518000
*         END;                      /* VSL ENTRY ADDED               */ 04519000
*     END;                          /* ENTRY ADDED.          @ZA26916*/ 04520000
*   ELSE                            /* IF RE-TRANS CCW, JUST @ZA26916*/ 04521000
*     DEXTVSL=DEXTVSL+LENGTH(VSL);  /* CALCULATE REQUIRED SPACE.     */ 04522000
         B     @RC01472                                         02S1494 04523000
@RF01472 LA    @09,8                                            02S1494 04524000
         AL    @09,DEXTVSL                                      02S1494 04525000
         ST    @09,DEXTVSL                                      02S1494 04526000
*   RETURN;                         /* RETURN TO CALLER              */ 04527000
@EL00003 DS    0H                                               02S1495 04528000
@EF00003 DS    0H                                               02S1495 04529000
@ER00003 LM    @14,@12,12(@13)                                  02S1495 04530000
         BR    @14                                              02S1495 04531000
*   RFY                                                         02S1496 04532000
*    (R0P,                                                      02S1496 04533000
*     R1P) UNRSTD;                  /* FINISHED WITH REGISTERS       */ 04534000
*   RFY                                                         02S1497 04535000
*     VSL;                          /* FINISHED WITH VSL OVERLAY     */ 04536000
*   END ADDVSL;                     /* END INTERNAL SUBROUTINE       */ 04537000
         B     @EL00003                                         02S1498 04538000
         EJECT                                                          04539000
*SORTVSL:                           /* BUILD REAL VSL TABLE          */ 04540000
*   PROC                            /* FOR PGFIX/PGFREE PROCESSING   */ 04541000
*       OPTIONS(NOSAVEAREA,         /* CALL NO ONE                   */ 04542000
*       NOPARMREG);                 /* REGS 0&1 NOT USED             */ 04543000
*                                                               02S1499 04544000
SORTVSL  STM   @14,@12,12(@13)                                  02S1499 04545000
*   /*****************************************************************/ 04546000
*   /*                                                               */ 04547000
*   /* TAKE THE PGFIX LIST ALREADY CONSTRUCTED AND BUILD AN EFFICIENT*/ 04548000
*   /* LIST. REMOVE DUPLICATE ENTRIES AND COMBINE ADJACENT ENTRIES.  */ 04549000
*   /* SET THE END-OF-LIST INDICATOR IN THE LAST ENTRY. ON INPUT,    */ 04550000
*   /* DVSLBEG POINTS TO THE FIRST ENTRY, AND DVSLEND THE FIRST      */ 04551000
*   /* AVAILABLE SLOT. ON EXIT, SET DVSLSZ TO THE SIZE OF THE PGFIX  */ 04552000
*   /* (VSL) LIST.                                                   */ 04553000
*   /*                                                               */ 04554000
*   /*****************************************************************/ 04555000
*                                                               02S1500 04556000
*                                                               02S1500 04557000
*   /*****************************************************************/ 04558000
*   /*                                                               */ 04559000
*   /* SORT ENTRIES IN ASCENDING SEQUENCE (VSLSTRT FIELD)            */ 04560000
*   /*                                                               */ 04561000
*   /*****************************************************************/ 04562000
*                                                               02S1500 04563000
*   RFY                             /* SORT REGISTERS                */ 04564000
*    (R0F,                          /* INTERCHANGE SWITCH            */ 04565000
*     R1P,                          /* NEXT ENTRY                    */ 04566000
*     R14P,                         /* SCANNER                       */ 04567000
*     R15P) RSTD;                   /* LAST ENTRY                    */ 04568000
*   R15P=DVSLEND-LENGTH(VSL);       /* LAST ENTRY                    */ 04569000
         L     R15P,DVSLEND                                     02S1501 04570000
         SL    R15P,@CF00037                                    02S1501 04571000
*   DO                              /* CONTINUE SORT UNTIL           */ 04572000
*         UNTIL(R0F=0|              /* NO INTERCHANGES LAST PASS     */ 04573000
*         R15P=DVSLBEG);            /* OR ONLY 1 ENTRY LEFT.         */ 04574000
@DL01502 DS    0H                                               02S1503 04575000
*     R14P=DVSLBEG;                 /* FIRST ENTRY                   */ 04576000
         L     R14P,DVSLBEG                                     02S1503 04577000
*     R0F=0;                        /* NO INTERCHANGES SO FAR        */ 04578000
         SLR   R0F,R0F                                          02S1504 04579000
*     DO UNTIL(R14P=R15P);          /* SCAN UNTIL LAST ENTRY         */ 04580000
@DL01505 DS    0H                                               02S1506 04581000
*       R1P=R14P+LENGTH(VSL);       /* NEXT VSL ENTRY                */ 04582000
         LA    R1P,8(,R14P)                                     02S1506 04583000
*       IF R14P->VSLSTRT>           /* IF CURRENT START > THAN       */ 04584000
*           R1P->VSLSTRT THEN       /* NEXT START,                   */ 04585000
         CLC   VSLSTRT(4,R14P),VSLSTRT(R1P)                     02S1507 04586000
         BNH   @RF01507                                         02S1507 04587000
*         DO;                       /* THEN MUST INTERCHANGE.        */ 04588000
*           R14P->VSL=R14P->VSL&&   /* USE THREE                     */ 04589000
*               R1P->VSL;           /* EXCLUSIVE OR'S                */ 04590000
         XC    VSL(8,R14P),VSL(R1P)                             02S1509 04591000
*           R1P->VSL=R1P->VSL&&     /* (XC) TO INTERCHANGE           */ 04592000
*               R14P->VSL;          /* THE CONTENTS OF THE           */ 04593000
         XC    VSL(8,R1P),VSL(R14P)                             02S1510 04594000
*           R14P->VSL=R14P->VSL&&   /* TWO VSL ENTRIES               */ 04595000
*               R1P->VSL;           /* THEN SHOW THAT                */ 04596000
         XC    VSL(8,R14P),VSL(R1P)                             02S1511 04597000
*           R0F=R0F-1;              /* INTERCHANGE MADE              */ 04598000
         BCTR  R0F,0                                            02S1512 04599000
*         END;                      /* I+1_ENTRY >= I_ENTRY          */ 04600000
*       R14P=R1P;                   /* R14P = ADDR(NEXT_ENTRY)       */ 04601000
@RF01507 LR    R14P,R1P                                         02S1514 04602000
*     END;                          /* R15P-> VSL HIGHEST ADDRESS    */ 04603000
@DE01505 CR    R14P,R15P                                        02S1515 04604000
         BNE   @DL01505                                         02S1515 04605000
*     R15P=R15P-LENGTH(VSL);        /* ONLY SORT PREVIOUS ENTRIES    */ 04606000
         SL    R15P,@CF00037                                    02S1516 04607000
*   END;                            /* ENTRIES SORTED.               */ 04608000
@DE01502 LTR   R0F,R0F                                          02S1517 04609000
         BZ    @DC01502                                         02S1517 04610000
         C     R15P,DVSLBEG                                     02S1517 04611000
         BNE   @DL01502                                         02S1517 04612000
@DC01502 DS    0H                                               02S1518 04613000
*   RFY                                                         02S1518 04614000
*    (R0F,                                                      02S1518 04615000
*     R1P,                                                      02S1518 04616000
*     R14P,                                                     02S1518 04617000
*     R15P) UNRSTD;                 /* FINISHED WITH REGISTERS       */ 04618000
*                                                               02S1519 04619000
*   /*****************************************************************/ 04620000
*   /*                                                               */ 04621000
*   /* SCAN THE VSL ENTRIES CHECKING FOR THE STARTING ADDRESS IN     */ 04622000
*   /* ENTRY N+1 <= ENDING ADDRESS IN ENTRY N. IF FOUND, SET THE     */ 04623000
*   /* ENDING ADDRESS IN ENTRY N EQUAL THE MAXIMUM OF THE ENDING     */ 04624000
*   /* ADDRESSES IN ENTRIES N AND N+1. THEN ELIMINATE ENTRY N+1.     */ 04625000
*   /*                                                               */ 04626000
*   /*****************************************************************/ 04627000
*                                                               02S1519 04628000
*   RFY                                                         02S1519 04629000
*    (R1F,                          /* VSL SIZE                      */ 04630000
*     R14P,                         /* CURRENT VSL ENTRY             */ 04631000
*     R15P,                         /* 'FROM' VSL ENTRY              */ 04632000
*     R0P) RSTD;                    /* END OF VSL ENTRIES ADDRESS    */ 04633000
*   R14P=DVSLBEG;                   /* INITIAL VSL ENTRY             */ 04634000
         L     R14P,DVSLBEG                                     02S1520 04635000
*   R1F=LENGTH(VSL);                /* VSL ENTRY LENGTH              */ 04636000
         LA    R1F,8                                            02S1521 04637000
*   R0P=DVSLEND;                    /* END-OF-VSL ENTRIES POINTER    */ 04638000
         L     R0P,DVSLEND                                      02S1522 04639000
*   R15P=R14P+R1F;                  /* 'FROM' IS SECOND VSL ENTRY    */ 04640000
         LR    R15P,R14P                                        02S1523 04641000
         ALR   R15P,R1F                                         02S1523 04642000
*   DO UNTIL(R15P=R0P);             /* SCAN ALL VSL ENTRIES          */ 04643000
@DL01524 DS    0H                                               02S1525 04644000
*     IF R15P->VSLSTRT<=            /* IF START N+1 <= END OF N,     */ 04645000
*         R14P->VSLEND THEN         /* THEN SET                      */ 04646000
         L     @09,VSLEND(,R14P)                                02S1525 04647000
         C     @09,VSLSTRT(,R15P)                               02S1525 04648000
         BL    @RF01525                                         02S1525 04649000
*       IF R15P->VSLEND>            /* END OF ENTRY N =              */ 04650000
*           R14P->VSLEND THEN       /* MAXIMUM OF END IN ENTRIES     */ 04651000
         L     @04,VSLEND(,R15P)                                02S1526 04652000
         CR    @04,@09                                          02S1526 04653000
         BNH   @RF01526                                         02S1526 04654000
*         R14P->VSLEND=R15P->VSLEND;/* N AND N+1.                    */ 04655000
         ST    @04,VSLEND(,R14P)                                02S1527 04656000
*       ELSE                                                    02S1528 04657000
*         ;                         /* IF START OF N+1 > END OF      */ 04658000
@RF01526 DS    0H                                               02S1529 04659000
*     ELSE                          /* ENTRY N, THEN FINISHED        */ 04660000
*       DO;                         /* WITH ENTRY N. COPY ENTRY      */ 04661000
         B     @RC01525                                         02S1529 04662000
@RF01525 DS    0H                                               02S1530 04663000
*         R14P=R14P+R1F;            /* N+1 TO SLOT AFTER ENTRY       */ 04664000
         ALR   R14P,R1F                                         02S1530 04665000
*         R14P->VSL=R15P->VSL;      /* N. WILL PGRFORM SAME PROCESS  */ 04666000
         MVC   VSL(8,R14P),VSL(R15P)                            02S1531 04667000
*       END;                        /* AS ABOVE.                     */ 04668000
*     R15P=R15P+R1F;                /* N+1 MERGED OR COPIED          */ 04669000
@RC01525 ALR   R15P,R1F                                         02S1533 04670000
*   END;                            /* CONTINUE THRU ALL VSL SLOTS.  */ 04671000
*                                                               02S1534 04672000
@DE01524 CR    R15P,R0P                                         02S1534 04673000
         BNE   @DL01524                                         02S1534 04674000
*   /*****************************************************************/ 04675000
*   /*                                                               */ 04676000
*   /* COMPRESSED LIST BUILT. REGISTER R14P POINTS TO LAST ENTRY.    */ 04677000
*   /*                                                               */ 04678000
*   /*****************************************************************/ 04679000
*                                                               02S1535 04680000
*   IF APIORXLT=BOFF THEN           /* IF NOT RE-TRANS, SET END-OF-  */ 04681000
         LA    @09,DAPIO                                        02S1535 04682000
         TM    APIORXLT(@09),B'00010000'                        02S1535 04683000
         BNZ   @RF01535                                         02S1535 04684000
*     R14P->VSLAST=BON;             /* LIST. RE-TRANS ADDS MORE.     */ 04685000
         OI    VSLAST(R14P),B'10000000'                         02S1536 04686000
*   DVSLEND=R14P+R1F;               /* NEW END OF VSL POINTER        */ 04687000
@RF01535 LR    @09,R14P                                         02S1537 04688000
         ALR   @09,R1F                                          02S1537 04689000
         ST    @09,DVSLEND                                      02S1537 04690000
*   RFY                                                         02S1538 04691000
*    (R0P,                                                      02S1538 04692000
*     R1F,                                                      02S1538 04693000
*     R14P,                                                     02S1538 04694000
*     R15P) UNRSTD;                 /* FINISHED WITH REGISTERS       */ 04695000
*                                                               02S1538 04696000
*   /*****************************************************************/ 04697000
*   /*                                                               */ 04698000
*   /* SET DVSLSZ = REQUIRED VSL SIZE                                */ 04699000
*   /*                                                               */ 04700000
*   /*****************************************************************/ 04701000
*                                                               02S1539 04702000
*   DVSLSZ=DVSLEND-DVSLBEG;         /* VSL SIZE                      */ 04703000
         SL    @09,DVSLBEG                                      02S1539 04704000
         ST    @09,DVSLSZ                                       02S1539 04705000
*   RETURN;                         /* RETURN TO CALLER              */ 04706000
@EL00004 DS    0H                                               02S1540 04707000
@EF00004 DS    0H                                               02S1540 04708000
@ER00004 LM    @14,@12,12(@13)                                  02S1540 04709000
         BR    @14                                              02S1540 04710000
*   END SORTVSL;                    /* REAL VSL BUILT                */ 04711000
         EJECT                                                          04712000
*ADDIDAL:                           /* PROVIDE IDAL SUPPORT          */ 04713000
*   PROC                            /* FOR A CCW.                    */ 04714000
*       OPTIONS(NOPARMREG);         /* R0/R1 NOT SET ON INPUT        */ 04715000
*                                                               02S1542 04716000
ADDIDAL  STM   @14,@03,@SA00005                                 02S1542 04717000
         STM   @05,@12,@SA00005+24                              02S1542 04718000
*   /*****************************************************************/ 04719000
*   /*                                                               */ 04720000
*   /* CCW POINTED TO BY 'DCCWCUR' REQUIRES IDAL SUPPORT. BUILD THE  */ 04721000
*   /* NEEDED IDAL ENTRIES AND POINT THE CCW AT THE IDAL. ALSO ADD   */ 04722000
*   /* THE REQUIRED APXL ENTRIES.                                    */ 04723000
*   /*                                                               */ 04724000
*   /*****************************************************************/ 04725000
*                                                               02S1543 04726000
*   CCWFIDA=BON;                    /* SHOW CCW POINTS TO IDAL       */ 04727000
         OI    CCWFIDA(DCCWCUR),B'00000100'                     02S1543 04728000
*   IF DSW0FCCW=BON THEN            /* IF FAKE (RE-TRANSLATE) CCW,   */ 04729000
         TM    DSW0FCCW,B'10000000'                             02S1544 04730000
         BNO   @RF01544                                         02S1544 04731000
*     DIDALCT0=(CMAXIOSZ+CIOXSZ-2)/CIOXSZ+1;/* USE MAX SIZE  @ZA26916*/ 04732000
         LA    DIDALCT0,33                                      02S1545 04733000
*   ELSE                            /* OTHERWISE CALCULATE ACTUAL    */ 04734000
*     DIDALCT0=(((CCWDATA+CCWBCNT-1)&CRNDIXDN)/* NUMBER OF IDAL      */ 04735000
*         -(CCWDATA&CRNDIXDN))/CIOXSZ+1;/* ENTRIES NEEDED.           */ 04736000
*                                                               02S1546 04737000
         B     @RC01544                                         02S1546 04738000
@RF01544 L     @09,@CF03927                                     02S1546 04739000
         L     @15,CCWDATA-1(,DCCWCUR)                          02S1546 04740000
         LA    @15,0(,@15)                                      02S1546 04741000
         LH    @00,CCWBCNT(,DCCWCUR)                            02S1546 04742000
         N     @00,@CF04247                                     02S1546 04743000
         ALR   @00,@15                                          02S1546 04744000
         BCTR  @00,0                                            02S1546 04745000
         NR    @00,@09                                          02S1546 04746000
         NR    @15,@09                                          02S1546 04747000
         SLR   @00,@15                                          02S1546 04748000
         SRL   @00,11                                           02S1546 04749000
         AL    @00,@CF00068                                     02S1546 04750000
         LR    DIDALCT0,@00                                     02S1546 04751000
*   /*****************************************************************/ 04752000
*   /*                                                               */ 04753000
*   /* INSURE IDALS FIT IN CURRENT PAGE. IF NOT, SKIP ENOUGH IDALS TO*/ 04754000
*   /* BE ON A NEW PAGE. RESET DIDALCT IF NEW PAGE                   */ 04755000
*   /*                                                               */ 04756000
*   /*****************************************************************/ 04757000
*                                                               02S1547 04758000
*   DIDALCT1=CPGSIZE/LENGTH(IDAL)-DIDALCT;/* NUMBER IDAL SLOTS LEFT     04759000
*                                      IN THIS PAGE.                 */ 04760000
@RC01544 LA    DIDALCT1,1024                                    02S1547 04761000
         SL    DIDALCT1,DIDALCT                                 02S1547 04762000
*   IF DIDALCT1<DIDALCT0 THEN       /* IF NOT ENOUGH SLOTS FOR THIS  */ 04763000
         CR    DIDALCT1,DIDALCT0                                02S1548 04764000
         BNL   @RF01548                                         02S1548 04765000
*     DO;                           /* ENTRY, THEN START ON NEW PAGE */ 04766000
*       DIDALCUR=DIDALCUR+DIDALCT1*LENGTH(IDAL);/* PT TO NEW PAGE    */ 04767000
         LR    @09,DIDALCT1                                     02S1550 04768000
         SLA   @09,2                                            02S1550 04769000
         AL    @09,DIDALCUR                                     02S1550 04770000
         ST    @09,DIDALCUR                                     02S1550 04771000
*       DIDALCT=0;                  /* NO IDAL ENTRIES ON THIS PAGE  */ 04772000
         SLR   @09,@09                                          02S1551 04773000
         ST    @09,DIDALCT                                      02S1551 04774000
*     END;                          /* NEW PAGE ESTABLISHED          */ 04775000
*                                                               02S1552 04776000
*   /*****************************************************************/ 04777000
*   /*                                                               */ 04778000
*   /* INSURE IDAL TABLE DOES NOT OVERFLOW                           */ 04779000
*   /*                                                               */ 04780000
*   /*****************************************************************/ 04781000
*                                                               02S1553 04782000
*   IF DIDALCUR+DIDALCT0*LENGTH(IDAL)>/* IF OVERFLOW OF IDAL         */ 04783000
*       DIDALEND THEN               /* TABLE, SET ERROR FLAG AND     */ 04784000
@RF01548 LR    @09,DIDALCT0                                     02S1553 04785000
         SLA   @09,2                                            02S1553 04786000
         AL    @09,DIDALCUR                                     02S1553 04787000
         C     @09,DIDALEND                                     02S1553 04788000
         BNH   @RF01553                                         02S1553 04789000
*     DO;                           /* GOTO BACKOUT LOGIC.           */ 04790000
*       APESCODE=CERRN13;           /* NOTE: THIS ERROR SHOULD NOT   */ 04791000
         MVI   APESCODE,X'0D'                                   02S1555 04792000
*       DO;                         /* FORCE ABEND TO LOG ERROR &       04793000
*                                      PASS CONTROL TO THE (E)STAE OR   04794000
*                                      FRR EXIT ROUTINE.             */ 04795000
*         DO;                       /* ABEND(APCTABND)               */ 04796000
*           RESPECIFY                                           02S1558 04797000
*            (GPR01F) RESTRICTED;                               02S1558 04798000
*           GPR01F=APCTABND;        /* COMP CODE IN REG 1            */ 04799000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1559 04800000
*           SVC(13);                /* ISSUE ABEND SVC               */ 04801000
         SVC   13                                               02S1560 04802000
*           RESPECIFY                                           02S1561 04803000
*            (GPR01F) UNRESTRICTED;                             02S1561 04804000
*         END;                      /* ABEND(APCTABND) FORCE ABEND   */ 04805000
*         GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);          02S1563 04806000
*                                                  /* NO CODE           04807000
*       END;                        /* ABEND ISSUED                  */ 04808000
*     END;                          /* ERROR PROCESSED               */ 04809000
*                                                               02S1565 04810000
*   /*****************************************************************/ 04811000
*   /*                                                               */ 04812000
*   /* ADD APXL ENTRIES FOR EACH IDAL SLOT.                  @ZA26916*/ 04813000
*   /* IF NOT FAKE (RE-TRANSLATE) CCW, BUILD THE ACTUAL ENTRIES. IF A*/ 04814000
*   /* FAKE CCW, JUST INCREASE THE EXTRA APXL SPACE REQUIRED.        */ 04815000
*   /*                                                               */ 04816000
*   /*****************************************************************/ 04817000
*                                                               02S1566 04818000
*   IF DSW0FCCW=BON THEN            /* IF FAKE CCW, JUST CALCULATE   */ 04819000
@RF01553 TM    DSW0FCCW,B'10000000'                             02S1566 04820000
         BNO   @RF01566                                         02S1566 04821000
*     DEXTAPXL=DEXTAPXL+DIDALCT0*APXLLN1;/* REQUIRED SPACE.          */ 04822000
         LR    @09,DIDALCT0                                     02S1567 04823000
         SLA   @09,3                                            02S1567 04824000
         ALR   DEXTAPXL,@09                                     02S1567 04825000
*   ELSE                                                        02S1568 04826000
*     DO;                           /* BUILD ACTUAL ENTRIES. @ZA26916*/ 04827000
         B     @RC01566                                         02S1568 04828000
@RF01566 DS    0H                                               02S1569 04829000
*       RFY                                                     02S1569 04830000
*        (R1P,                                                  02S1569 04831000
*         R0P) RSTD;                /* INTERFACE REGISTERS           */ 04832000
*       R0P=CCWDATA;                /* CCW BUFFER (DATA) ADDRESS     */ 04833000
         L     R0P,CCWDATA-1(,DCCWCUR)                          02S1570 04834000
         ICM   R0P,8,@CB01727                                   02S1570 04835000
*       R1P=DIDALCUR;               /* FIRST IDAL SLOT               */ 04836000
         L     R1P,DIDALCUR                                     02S1571 04837000
*       DO DIDALCT2=DIDALCT0 TO 1 BY-1;/* ENOUGH IDAL ENTRIES FOR    */ 04838000
         LR    DIDALCT2,DIDALCT0                                02S1572 04839000
         B     @DE01572                                         02S1572 04840000
@DL01572 DS    0H                                               02S1573 04841000
*         R1P->I001C='00'X;         /* ENTIRE I/O BUFFER.            */ 04842000
         MVI   I001C(R1P),X'00'                                 02S1573 04843000
*         CALL ADDAPXL;             /* BUILD APXL ENTRY              */ 04844000
         BAL   @14,ADDAPXL                                      02S1574 04845000
*         R1P=R1P+LENGTH(IDAL);     /* NEXT IDAL ENTRY SLOT          */ 04846000
         LA    R1P,4(,R1P)                                      02S1575 04847000
*         R0P=(R0P+CIOXSZ)&CRNDIXDN;/* IDAL ENTRY POINTS TO NEXT PAGE*/ 04848000
         LA    @09,2048                                         02S1576 04849000
         ALR   @09,R0P                                          02S1576 04850000
         N     @09,@CF03927                                     02S1576 04851000
         LR    R0P,@09                                          02S1576 04852000
*       END;                        /* APXL BUILT FOR IDAL.          */ 04853000
         BCTR  DIDALCT2,0                                       02S1577 04854000
@DE01572 LTR   DIDALCT2,DIDALCT2                                02S1577 04855000
         BP    @DL01572                                         02S1577 04856000
*     END;                          /* APXL IDAL ENTRIES PROCESSED   */ 04857000
*                                                               02S1578 04858000
*   /*****************************************************************/ 04859000
*   /*                                                               */ 04860000
*   /* ADD APXL ENTRY TO POINT CCW AT IDAL                           */ 04861000
*   /*                                                               */ 04862000
*   /*****************************************************************/ 04863000
*                                                               02S1579 04864000
*   R0P=DIDALCUR;                   /* POINT CCW AT 1ST IDAL SLOT    */ 04865000
@RC01566 L     R0P,DIDALCUR                                     02S1579 04866000
*   R1P=ADDR(CCWDATA);              /* STORE IN CCW DATA FIELD       */ 04867000
         LA    R1P,CCWDATA(,DCCWCUR)                            02S1580 04868000
*   CALL ADDAPXL;                   /* ADD IT                        */ 04869000
         BAL   @14,ADDAPXL                                      02S1581 04870000
*   RFY                                                         02S1582 04871000
*    (R1P,                                                      02S1582 04872000
*     R0P) UNRSTD;                  /* FINISHED WITH REGISTERS       */ 04873000
*                                                               02S1582 04874000
*   /*****************************************************************/ 04875000
*   /*                                                               */ 04876000
*   /* UPDATE DIDALCT AND DIDALCUR TO REFLECT USED SLOTS             */ 04877000
*   /*                                                               */ 04878000
*   /*****************************************************************/ 04879000
*                                                               02S1583 04880000
*   DIDALCT=DIDALCT+DIDALCT0;       /* NUMBER SLOTS USED THIS PAGE   */ 04881000
         LR    @09,DIDALCT0                                     02S1583 04882000
         AL    @09,DIDALCT                                      02S1583 04883000
         ST    @09,DIDALCT                                      02S1583 04884000
*   DIDALCUR=DIDALCUR+DIDALCT0*LENGTH(IDAL);/* NEXT FREE SLOT        */ 04885000
         LR    @09,DIDALCT0                                     02S1584 04886000
         SLA   @09,2                                            02S1584 04887000
         AL    @09,DIDALCUR                                     02S1584 04888000
         ST    @09,DIDALCUR                                     02S1584 04889000
*   END ADDIDAL;                    /* IDAL BUILT. RETURN.           */ 04890000
@EL00005 DS    0H                                               02S1585 04891000
@EF00005 DS    0H                                               02S1585 04892000
@ER00005 LM    @14,@03,@SA00005                                 02S1585 04893000
         LM    @05,@12,@SA00005+24                              02S1585 04894000
         BR    @14                                              02S1585 04895000
         EJECT                                                          04896000
*ADDAPXL:                           /* ADD ENTRY TO APXL TABLE       */ 04897000
*   PROC                            /* INTERNAL SUBROUTINE           */ 04898000
*       OPTIONS(PARMREG,            /* REGISTERS 0/1 HAVE INPUT      */ 04899000
*       NOSAVEAREA);                /* CALL NO ONE                   */ 04900000
*                                                               02S1586 04901000
ADDAPXL  STM   @14,@12,12(@13)                                  02S1586 04902000
*   /*****************************************************************/ 04903000
*   /*                                                               */ 04904000
*   /* ADD AN ENTRY TO THE APXL TABLE. ON ENTRY, REGISTER 0 CONTAINS */ 04905000
*   /* THE ADDRESS TO TRANSLATE, AND REGISTER 1 HAS THE ADDRESS WHERE*/ 04906000
*   /* THE TRANSLATED ADDRESS IS TO BE STORED (FULLWORD). SAVE THE   */ 04907000
*   /* HI-ORDER BYTE OF THE MODIFIED FIELD IN THE HI-ORDER BYTE OF   */ 04908000
*   /* REGISTER 1. IF WILL BE USED TO RESET THE HI-BYTE WHEN THE REAL*/ 04909000
*   /* ADDRESS IS PLACED IN THE REQUESTED FIELD.                     */ 04910000
*   /*                                                               */ 04911000
*   /*****************************************************************/ 04912000
*                                                               02S1587 04913000
*   RFY                                                         02S1587 04914000
*    (R0P,                                                      02S1587 04915000
*     R1P) RSTD;                    /* REQUIRED REGISTERS            */ 04916000
*   IF DAPXLCUR>=DAPXLEND THEN      /* IF APXL WORKAREA FULL         */ 04917000
         CLC   DAPXLCUR(4),DAPXLEND                             02S1588 04918000
         BL    @RF01588                                         02S1588 04919000
*     DO;                           /* (SHOULD NOT HAPPEN),          */ 04920000
*       APESCODE=CERRN12;           /* THEN                          */ 04921000
         MVI   APESCODE,X'0C'                                   02S1590 04922000
*       DO;                         /* FORCE ABEND TO LOG ERROR &       04923000
*                                      PASS CONTROL TO THE (E)STAE OR   04924000
*                                      FRR EXIT ROUTINE.             */ 04925000
*         DO;                       /* ABEND(APCTABND)               */ 04926000
*           RESPECIFY                                           02S1593 04927000
*            (GPR01F) RESTRICTED;                               02S1593 04928000
*           GPR01F=APCTABND;        /* COMP CODE IN REG 1            */ 04929000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1594 04930000
*           SVC(13);                /* ISSUE ABEND SVC               */ 04931000
         SVC   13                                               02S1595 04932000
*           RESPECIFY                                           02S1596 04933000
*            (GPR01F) UNRESTRICTED;                             02S1596 04934000
*         END;                      /* ABEND(APCTABND) FORCE ABEND   */ 04935000
*         GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);          02S1598 04936000
*                                                  /* NO CODE           04937000
*       END;                        /* ABEND ISSUED                  */ 04938000
*     END;                          /* QUIT.                         */ 04939000
*   RFY                                                         02S1601 04940000
*     APXL BASED(DAPXLCUR);         /* APXL POINTER                  */ 04941000
@RF01588 DS    0H                                               02S1602 04942000
*   R1P=R1P&'FFFFFFFC'X;            /* ROUND DOWN TO FULLWORD        */ 04943000
         N     R1P,@CF04115                                     02S1602 04944000
*   GEN(ICM   R1P,B'1000',0(R1P))   /* SAVE HI-BYTE FOR LATER        */ 04945000
*   REFS(R1P) SETS(R1P);            /* RESTORE AFTER LRA             */ 04946000
         ICM   R1P,B'1000',0(R1P)                                       04947000
*   APXLADDV=R0P;                   /* ADDR TO ISSUE LRA FOR         */ 04948000
         L     @09,DAPXLCUR                                     02S1604 04949000
         ST    R0P,APXLADDV(,@09)                               02S1604 04950000
*   APXLADDL=R1P;                   /* WHERE TO SAVE REAL ADDR       */ 04951000
         ST    R1P,APXLADDL(,@09)                               02S1605 04952000
*   DAPXLCUR=ADDR(APXL)+APXLLN1;    /* NEXT APXL SLOT                */ 04953000
         AL    @09,@CF00037                                     02S1606 04954000
         ST    @09,DAPXLCUR                                     02S1606 04955000
*   RFY                                                         02S1607 04956000
*     APXL;                         /* FINISHED WITH APXL            */ 04957000
*   RFY                                                         02S1608 04958000
*    (R0P,                                                      02S1608 04959000
*     R1P) UNRSTD;                  /* FINISHED WITH REGS            */ 04960000
*   END ADDAPXL;                    /* RETURN TO CALLER              */ 04961000
@EL00006 DS    0H                                               02S1609 04962000
@EF00006 DS    0H                                               02S1609 04963000
@ER00006 LM    @14,@12,12(@13)                                  02S1609 04964000
         BR    @14                                              02S1609 04965000
         EJECT                                                          04966000
*CHKOLAP:                           /* FIND FIRST 'READ' CCW WHICH   */ 04967000
*   PROC;                           /* OVERLAYS 'WRITE' CCW DATA.    */ 04968000
*                                                               02S1610 04969000
CHKOLAP  STM   @14,@12,12(@13)                                  02S1610 04970000
*   /*****************************************************************/ 04971000
*   /*                                                               */ 04972000
*   /* CHECK FOR CHANNEL PROGRAM I/O OVERLAY. FIND THE FIRST 'READ'  */ 04973000
*   /* CCW WHOSE I/O AREA OVERLAPS A PREVIOUS 'WRITE' CCW I/O AREA.  */ 04974000
*   /* IF FOUND, THE CHANNEL PROGRAM MAY NOT BE RETRIED IF IT FAILS  */ 04975000
*   /* HERE (OR FUTHER ON). THE CHANNEL PROGRAM MAY BE RESTARTED     */ 04976000
*   /* HOWEVER. SET APIOOLAP TO THE OFFSET INTO THE CHANNEL PROGRAM  */ 04977000
*   /* OF THE 1ST CCW WHICH PREVENTS THE CHANNEL PROGRAM FROM BEING  */ 04978000
*   /* RETRIED (SHARED PORT ONLY).                                   */ 04979000
*   /*                                                               */ 04980000
*   /*****************************************************************/ 04981000
*                                                               02S1611 04982000
*   IF CCWOP=CREADOP&               /* IF 'READ' CCW AND             */ 04983000
*       APIOOLAP=0 THEN             /* OVERLAP NOT YET FOUND,        */ 04984000
         CLI   CCWOP(DCCWCUR),2                                 02S1611 04985000
         BNE   @RF01611                                         02S1611 04986000
         LA    @09,DAPIO                                        02S1611 04987000
         LH    @04,APIOOLAP(,@09)                               02S1611 04988000
         LTR   @04,@04                                          02S1611 04989000
         BNZ   @RF01611                                         02S1611 04990000
*     IF DSW0FCCW=BON THEN          /* IF FAKE CCW, CONSIDER IT      */ 04991000
         TM    DSW0FCCW,B'10000000'                             02S1612 04992000
         BNO   @RF01612                                         02S1612 04993000
*       APIOOLAP=ADDR(CCW)-DCCWBEG; /* OVERLAPPING SINCE MODIFIABLE  */ 04994000
         LR    @04,DCCWCUR                                      02S1613 04995000
         SL    @04,DCCWBEG                                      02S1613 04996000
         STH   @04,APIOOLAP(,@09)                               02S1613 04997000
*     ELSE                          /* OTHERWISE --          @ZA26916*/ 04998000
*       DO;                         /* SCAN FOR OVERLAY NOW.         */ 04999000
         B     @RC01612                                         02S1614 05000000
@RF01612 DS    0H                                               02S1615 05001000
*         RFY                                                   02S1615 05002000
*          (R14P,                                               02S1615 05003000
*           R15P,                                               02S1615 05004000
*           R1P) RSTD;              /* SCAN REGISTERS                */ 05005000
*         R14P=CCWDATA;             /* START OF I/O BUFFER           */ 05006000
         L     @09,CCWDATA-1(,DCCWCUR)                          02S1616 05007000
         LA    @09,0(,@09)                                      02S1616 05008000
         LR    R14P,@09                                         02S1616 05009000
*         R15P=CCWDATA+CCWBCNT-1;   /* ADDRESS OF LAST BYTE          */ 05010000
         LH    R15P,CCWBCNT(,DCCWCUR)                           02S1617 05011000
         N     R15P,@CF04247                                    02S1617 05012000
         ALR   @09,R15P                                         02S1617 05013000
         BCTR  @09,0                                            02S1617 05014000
         LR    R15P,@09                                         02S1617 05015000
*         DO R1P=DCCWBEG BY LENGTH(CCW)/* SCAN PREVIOUS              */ 05016000
*               WHILE(R1P<DCCWCUR); /* CCWS FOR SAME I/O AREA.       */ 05017000
         L     R1P,DCCWBEG                                      02S1618 05018000
         B     @DE01618                                         02S1618 05019000
@DL01618 DS    0H                                               02S1619 05020000
*           IF(R1P->CCWOP=CWRITEOP)&/* IF WRITE CCW AND              */ 05021000
*               ((R1P->CCWDATA>=R14P&/* EITHER START OF BUFFER       */ 05022000
*               R1P->CCWDATA<=R15P)|/* OVERLAPS NEW CCW I/O AREA     */ 05023000
*               ((R1P->CCWDATA)+(R1P->CCWBCNT)-1>=R14P&/* OR END     */ 05024000
*               (R1P->CCWDATA)+(R1P->CCWBCNT)-1<=R15P)) THEN/* OF    */ 05025000
         CLI   CCWOP(R1P),1                                     02S1619 05026000
         BNE   @RF01619                                         02S1619 05027000
         L     @09,CCWDATA-1(,R1P)                              02S1619 05028000
         LA    @09,0(,@09)                                      02S1619 05029000
         CR    @09,R14P                                         02S1619 05030000
         BL    @GL00021                                         02S1619 05031000
         CR    @09,R15P                                         02S1619 05032000
         BNH   @RT01619                                         02S1619 05033000
@GL00021 L     @09,CCWDATA-1(,R1P)                              02S1619 05034000
         LA    @09,0(,@09)                                      02S1619 05035000
         LH    @04,CCWBCNT(,R1P)                                02S1619 05036000
         N     @04,@CF04247                                     02S1619 05037000
         ALR   @09,@04                                          02S1619 05038000
         BCTR  @09,0                                            02S1619 05039000
         CR    @09,R14P                                         02S1619 05040000
         BL    @RF01619                                         02S1619 05041000
         CR    @09,R15P                                         02S1619 05042000
         BH    @RF01619                                         02S1619 05043000
@RT01619 DS    0H                                               02S1620 05044000
*             DO;                   /* BUFFER OVERLAPS, IS 1ST CCW   */ 05045000
*               APIOOLAP=ADDR(CCW)-DCCWBEG;/* CAUSING I/O DATA       */ 05046000
         LA    @09,DAPIO                                        02S1621 05047000
         LR    @04,DCCWCUR                                      02S1621 05048000
         SL    @04,DCCWBEG                                      02S1621 05049000
         STH   @04,APIOOLAP(,@09)                               02S1621 05050000
*               RETURN;             /* OVERLAY. SAVE OFFSET & RETURN.*/ 05051000
@EL00007 DS    0H                                               02S1622 05052000
@EF00007 DS    0H                                               02S1622 05053000
@ER00007 LM    @14,@12,12(@13)                                  02S1622 05054000
         BR    @14                                              02S1622 05055000
*             END;                  /* OVERLAP DETECTED AND NOTED.   */ 05056000
*         END;                      /* CONTINUE OVERLAY SCAN         */ 05057000
@RF01619 AL    R1P,@CF00037                                     02S1624 05058000
@DE01618 CR    R1P,DCCWCUR                                      02S1624 05059000
         BL    @DL01618                                         02S1624 05060000
*         RFY                                                   02S1625 05061000
*          (R14P,                                               02S1625 05062000
*           R15P,                                               02S1625 05063000
*           R1P) UNRSTD;            /* SCAN REGISTERS                */ 05064000
*       END;                        /* NO OVERLAP SO FAR             */ 05065000
*   END CHKOLAP;                    /* OVERLAP CHECKED               */ 05066000
         B     @EL00007                                         02S1627 05067000
         EJECT                                                          05068000
*SETAPRL:                           /* CONVERT APESCOD1 INTO APRL    */ 05069000
*   PROC;                           /* ERROR INDICATORS              */ 05070000
*                                                               02S1628 05071000
SETAPRL  STM   @14,@12,12(@13)                                  02S1628 05072000
*   /*****************************************************************/ 05073000
*   /*                                                               */ 05074000
*   /* TAKE THE ERROR CODE (APESCOD1) AND CONVERT IT INTO ERRORS     */ 05075000
*   /* CODES WHICH ARE MOVED INTO THE APRL (PROTECTED COPY).         */ 05076000
*   /*                                                               */ 05077000
*   /*****************************************************************/ 05078000
*                                                               02S1629 05079000
*   RFY                                                         02S1629 05080000
*     APRL BASED(DAPRLXPT);         /* USE PROTECTED COPY    @ZA26916*/ 05081000
*   IF APESCOD1^=0 THEN             /* IF NON-ZERO CODE, THEN        */ 05082000
         CLI   APESCOD1,0                                       02S1630 05083000
         BE    @RF01630                                         02S1630 05084000
*     DO;                           /* BUILD APRL ERROR VALUES.      */ 05085000
*       IF APESCOD1>CERRN99 THEN    /* IF INVALID VALUE, USE         */ 05086000
         CLI   APESCOD1,33                                      02S1632 05087000
         BNH   @RF01632                                         02S1632 05088000
*         APESCOD1=CERRN99;         /* 'INDETERMINATE' ERROR VALUE.  */ 05089000
         MVI   APESCOD1,X'21'                                   02S1633 05090000
*       APRLRCT=CMBXRCT(APESCOD1);  /* ERROR TYPE                    */ 05091000
@RF01632 L     @09,DAPRLXPT                                     02S1634 05092000
         SLR   @04,@04                                          02S1634 05093000
         IC    @04,APESCOD1                                     02S1634 05094000
         SLA   @04,3                                            02S1634 05095000
         SLR   @15,@15                                          02S1634 05096000
         IC    @15,CMBXRCT-8(@04)                               02S1634 05097000
         STC   @15,APRLRCT(,@09)                                02S1634 05098000
*       APRLRCC=APCCI;              /* ERROR COMPONENT (IO)          */ 05099000
         MVI   APRLRCC(@09),X'05'                               02S1635 05100000
*       APRLRCN=CMBXRCN(APESCOD1);  /* UNIQUE ERROR NUMBER           */ 05101000
         LH    @15,CMBXRCN-8(@04)                               02S1636 05102000
         STC   @15,APRLRCN(,@09)                                02S1636 05103000
*       APRLMSGN=CMBRMT(APESCOD1);  /* IGTMBR MESSAGE NUMBER         */ 05104000
         LH    @15,CMBRMT-8(@04)                                02S1637 05105000
         STH   @15,APRLMSGN(,@09)                               02S1637 05106000
*       APRLVALN=CMBRKT(APESCOD1);  /* IGTMBR KEYWORD NUMBER         */ 05107000
         LH    @04,CMBRKT-8(@04)                                02S1638 05108000
         STH   @04,APRLVALN(,@09)                               02S1638 05109000
*     END;                          /* ERROR CODES SET               */ 05110000
*   RETURN;                         /* RETURN TO CALLER              */ 05111000
@EL00008 DS    0H                                               02S1640 05112000
@EF00008 DS    0H                                               02S1640 05113000
@ER00008 LM    @14,@12,12(@13)                                  02S1640 05114000
         BR    @14                                              02S1640 05115000
*   RFY                                                         02S1641 05116000
*     APRL BASED(DAPRLXPT);         /* USE PROTECTED COPY    @ZA26916*/ 05117000
*   END SETAPRL;                    /* END OF SUBROUTINE             */ 05118000
         B     @EL00008                                         02S1642 05119000
         EJECT                                                          05120000
*GETLLCK:                           /* GET THE LOCAL LOCK AND        */ 05121000
*   PROC OPTIONS(NOSAVEAREA);       /* ESTABLISH FRR ENVIRONMENT     */ 05122000
*                                                               02S1643 05123000
GETLLCK  STM   @14,@12,12(@13)                                  02S1643 05124000
*   /*****************************************************************/ 05125000
*   /*                                                               */ 05126000
*   /* GET THE LOCAL LOCK. THEN ISSUE A SETFRR TO PROVIDE RECOVERY   */ 05127000
*   /* SUPPORT. THE SAME PARAMETERS AS AVAILABLE TO AN ESTAE (IF ANY)*/ 05128000
*   /* ARE PASSED ('APES' BLOCK)                                     */ 05129000
*   /*                                                               */ 05130000
*   /*****************************************************************/ 05131000
*                                                               02S1644 05132000
*                                                               02S1644 05133000
*   /*****************************************************************/ 05134000
*   /*                                                               */ 05135000
*   /* GET THE LOCAL LOCK                                            */ 05136000
*   /*                                                               */ 05137000
*   /*****************************************************************/ 05138000
*                                                               02S1644 05139000
*   STM(R11F,R13F,DSUPVSVE);        /* SAVE DESTROYED REGISTERS      */ 05140000
         STM   R11F,R13F,DSUPVSVE                               02S1644 05141000
*   APESCODE=CERRN22;               /* SET ERROR CODE                */ 05142000
         MVI   APESCODE,X'16'                                   02S1645 05143000
*   GEN REFS(PSALITA,FLC) SETS(R11F,R12F,R13F,R14F);            02S1646 05144000
*                                   /*                                  05145000
         MODESET EXTKEY=ZERO       SETLOCK REQUIRES KEY-0               05146000
         SETLOCK OBTAIN,           ACQUIRE THE                         *05147000
               TYPE=LOCAL,         * LOCAL LOCK                        *05148000
               MODE=UNCOND,        * UNCONDITIONALLY.                  *05149000
               RELATED=(FREELLCK,APESFLLK) * R13 HAS RETURN CODE        05150000
         MODESET EXTKEY=DATAMGT    RESUME STANDARD KEY                  05151000
*   RFY                                                         02S1647 05152000
*     R15F RSTD;                    /* HOLDS SETLOCK RETURN CODE     */ 05153000
*   R15F=R13F;                      /* SAVE SETLOCK RETURN CODE      */ 05154000
         LR    R15F,R13F                                        02S1648 05155000
*   APESCODE=CERRN99;               /* RESET ERROR CODE              */ 05156000
         MVI   APESCODE,X'21'                                   02S1649 05157000
*   LM(R11F,R13F,DSUPVSVE);         /* RELOAD DESTROYED REGISTERS    */ 05158000
*                                                               02S1650 05159000
         LM    R11F,R13F,DSUPVSVE                               02S1650 05160000
*   /*****************************************************************/ 05161000
*   /*                                                               */ 05162000
*   /* INSURE LOCK ACQUIRED. ABEND IF NOT                            */ 05163000
*   /*                                                               */ 05164000
*   /*****************************************************************/ 05165000
*                                                               02S1651 05166000
*   IF R15F^=0 THEN                 /* IF SETLOCK FAILED,            */ 05167000
         LTR   R15F,R15F                                        02S1651 05168000
         BZ    @RF01651                                         02S1651 05169000
*     DO;                           /* THEN TERMINATE PROCESSING     */ 05170000
*       APESCODE=CERRN22;           /* SET ERROR CODE                */ 05171000
         MVI   APESCODE,X'16'                                   02S1653 05172000
*       DO;                         /* FORCE ABEND TO LOG ERROR &       05173000
*                                      PASS CONTROL TO THE (E)STAE OR   05174000
*                                      FRR EXIT ROUTINE.             */ 05175000
*         DO;                       /* ABEND(APCTABND)               */ 05176000
*           RESPECIFY                                           02S1656 05177000
*            (GPR01F) RESTRICTED;                               02S1656 05178000
*           GPR01F=APCTABND;        /* COMP CODE IN REG 1            */ 05179000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1657 05180000
*           SVC(13);                /* ISSUE ABEND SVC               */ 05181000
         SVC   13                                               02S1658 05182000
*           RESPECIFY                                           02S1659 05183000
*            (GPR01F) UNRESTRICTED;                             02S1659 05184000
*         END;                      /* ABEND(APCTABND) FORCE ABEND   */ 05185000
*         GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);          02S1661 05186000
*                                                  /* NO CODE           05187000
*       END;                        /* ABEND ISSUED                  */ 05188000
*     END;                          /* ERROR PROCESSED               */ 05189000
*   RFY                                                         02S1664 05190000
*     R15F UNRSTD;                  /* FINISHED WITH RETURN CODE     */ 05191000
@RF01651 DS    0H                                               02S1665 05192000
*   APESFLLK=BON;                   /* SHOW LOCAL LOCK OWNED         */ 05193000
*                                                               02S1665 05194000
         OI    APESFLLK,B'00100000'                             02S1665 05195000
*   /*****************************************************************/ 05196000
*   /*                                                               */ 05197000
*   /* ISSUE SETFRR TO COVER THE PROCESSING. PARAMETER LIST IS 'APES'*/ 05198000
*   /* BLOCK. THE EXIT ROUTINE CAN PROCESS BOTH (E)STAE AND FRR      */ 05199000
*   /* ENTRIES.                                                      */ 05200000
*   /*                                                               */ 05201000
*   /*****************************************************************/ 05202000
*                                                               02S1666 05203000
*   APESCODE=CERRN30;               /* SETFRR ERROR CODE             */ 05204000
         MVI   APESCODE,X'1E'                                   02S1666 05205000
*   RFY                                                         02S1667 05206000
*     R15P RSTD;                    /* SETFRR SETS TO PARM LIST      */ 05207000
*   GEN REFS(PSA,PSACSTK,PSALSFCC,APCTZUKA,APCT,APCTPTR,FRRSFRRA,       05208000
*       FRRSENTR,FRRSPARM,FRRSCURR,FRRSLAST,FRRS) SETS(R14F,R15F,R15P); 05209000
*                                   /*                                  05210000
         MODESET EXTKEY=ZERO       SETFRR REQUIRES KEY-0                05211000
         SETFRR A,FRRAD=APCTZUKA-APCT(,APCTPTR), IGTUKA IS EXIT ROUTINE*05212000
               PARMAD=(R15P),      * SAVE @ 6-WORD PARM FIELD HERE     *05213000
               CLEAR=NO,           * DO NOT CLEAR PARM FIELD           *05214000
               WRKREGS=(R14F,R15F), * WORK REGISTERS                   *05215000
               RELATED=(FREELLCK,APES) * APES IS INPUT                  05216000
*   R15P->I031P=ADDR(APES);         /* 1ST WORD OF PARM LIST IS 02S1669 05217000
*                                      ADDRESS OF 'APES'             */ 05218000
         LA    @14,APES                                         02S1669 05219000
         ST    @14,I031P(,R15P)                                 02S1669 05220000
*   RFY                                                         02S1670 05221000
*     R15P UNRSTD;                  /* SETFRR PARM FIELD SET         */ 05222000
*   GEN(MODESET EXTKEY=DATAMGT)                                 02S1671 05223000
*   NOREFS NOSETS;                  /* RESUME STANDARD KEY           */ 05224000
         MODESET EXTKEY=DATAMGT                                         05225000
*   APESCODE=CERRN99;               /* RESET ERROR CODE              */ 05226000
         MVI   APESCODE,X'21'                                   02S1672 05227000
*   APESFFRR=BON;                   /* SHOW SETFRR ISSUED            */ 05228000
*                                                               02S1673 05229000
         OI    APESFFRR,B'10000000'                             02S1673 05230000
*   /*****************************************************************/ 05231000
*   /*                                                               */ 05232000
*   /* PROCESSING COMPLETE. RETURN TO CALLER                         */ 05233000
*   /*                                                               */ 05234000
*   /*****************************************************************/ 05235000
*                                                               02S1674 05236000
*   RETURN;                         /* RETURN TO CALLER              */ 05237000
@EL00009 DS    0H                                               02S1674 05238000
@EF00009 DS    0H                                               02S1674 05239000
@ER00009 LM    @14,@12,12(@13)                                  02S1674 05240000
         BR    @14                                              02S1674 05241000
*   END GETLLCK;                    /* END OF SUBROUTINE             */ 05242000
         EJECT                                                          05243000
*FREELLCK:                          /* RELEASE THE LOCAL LOCK        */ 05244000
*   PROC OPTIONS(NOSAVEAREA);       /* CANCEL THE FRR ENVIRONMENT    */ 05245000
*                                                               02S1676 05246000
FREELLCK STM   @14,@12,12(@13)                                  02S1676 05247000
*   /*****************************************************************/ 05248000
*   /*                                                               */ 05249000
*   /* CANCEL THE CURRENT FRR (SET BY GETLLCK). THEN RELEASE THE     */ 05250000
*   /* LOCAL LOCK.                                                   */ 05251000
*   /*                                                               */ 05252000
*   /*****************************************************************/ 05253000
*                                                               02S1677 05254000
*                                                               02S1677 05255000
*   /*****************************************************************/ 05256000
*   /*                                                               */ 05257000
*   /* CANCEL THE RECOVERY ENVIRONMENT                               */ 05258000
*   /*                                                               */ 05259000
*   /*****************************************************************/ 05260000
*                                                               02S1677 05261000
*   IF APESFFRR=BON THEN            /* IF SETFRR ISSUED,             */ 05262000
         TM    APESFFRR,B'10000000'                             02S1677 05263000
         BNO   @RF01677                                         02S1677 05264000
*     DO;                           /* THEN CANCEL IT.               */ 05265000
*       APESFFRR=BOFF;              /* SHOW NOT IN FRR               */ 05266000
         NI    APESFFRR,B'01111111'                             02S1679 05267000
*       APESCODE=CERRN30;           /* ERROR CODE                    */ 05268000
         MVI   APESCODE,X'1E'                                   02S1680 05269000
*       GEN REFS(PSA,PSACSTK,FRRS,FRRSCURR,FRRSEMP,FRRSELEN,FRRSCURR)   05270000
*           SETS(R14F,R15F);                                    02S1681 05271000
*                                   /*                                  05272000
         MODESET EXTKEY=ZERO       SETFRR REQUIRES KEY-0                05273000
         SETFRR D,                 CANCEL THE CURRENT ENTRY            *05274000
               WRKREGS=(R14F,R15F), * WORK REGISTERS                   *05275000
               RELATED=(GETLLCK,APES) * APES WAS INPUT                  05276000
         MODESET EXTKEY=DATAMGT    RESUME STANDARD KEY                  05277000
*       APESCODE=CERRN99;           /* RESET ERROR CODE              */ 05278000
         MVI   APESCODE,X'21'                                   02S1682 05279000
*     END;                          /* FRR CANCELLED                 */ 05280000
*                                                               02S1683 05281000
*   /*****************************************************************/ 05282000
*   /*                                                               */ 05283000
*   /* RELEASE THE LOCAL LOCK                                        */ 05284000
*   /*                                                               */ 05285000
*   /*****************************************************************/ 05286000
*                                                               02S1684 05287000
*   IF APESFLLK=BON THEN            /* IF LOCAL LOCK OWNED,          */ 05288000
@RF01677 TM    APESFLLK,B'00100000'                             02S1684 05289000
         BNO   @RF01684                                         02S1684 05290000
*     DO;                           /* THEN RELEASE IT.              */ 05291000
*       STM(R11F,R13F,DSUPVSVE);    /* SAVE DESTROYED REGISTERS      */ 05292000
         STM   R11F,R13F,DSUPVSVE                               02S1686 05293000
*       APESCODE=CERRN28;           /* SET ERROR CODE                */ 05294000
         MVI   APESCODE,X'1C'                                   02S1687 05295000
*       GEN REFS(PSALITA,FLC) SETS(R11F,R12F,R13F,R14F);        02S1688 05296000
*                                      /*                               05297000
         MODESET EXTKEY=ZERO       SETLOCK REQUIRES KEY-0               05298000
         SETLOCK RELEASE,          RELEASE THE                         *05299000
               TYPE=LOCAL,         * LOCAL LOCK                        *05300000
               RELATED=(GETLLCK,APESFLLK) * R13 HAS RETURN CODE         05301000
         MODESET EXTKEY=DATAMGT    RESUME STANDARD KEY                  05302000
*       RFY                                                     02S1689 05303000
*         R15F RSTD;                /* WILL HOLD SETLOCK RETURN CODE */ 05304000
*       APESCODE=CERRN99;           /* RESET ERROR CODE              */ 05305000
         MVI   APESCODE,X'21'                                   02S1690 05306000
*       R15F=R13F;                  /* HOLD RETURN CODE              */ 05307000
         LR    R15F,R13F                                        02S1691 05308000
*       LM(R11F,R13F,DSUPVSVE);     /* RESTORE DESTROYED REGISTERS   */ 05309000
         LM    R11F,R13F,DSUPVSVE                               02S1692 05310000
*       IF R15F^=0 THEN             /* IF SETLOCK FAILED,            */ 05311000
         LTR   R15F,R15F                                        02S1693 05312000
         BZ    @RF01693                                         02S1693 05313000
*         DO;                       /* THEN LOG AND TERMINATE.       */ 05314000
*           APESCODE=CERRN29;       /* SET ERROR CODE                */ 05315000
         MVI   APESCODE,X'1D'                                   02S1695 05316000
*           DO;                     /* FORCE ABEND TO LOG ERROR &       05317000
*                                      PASS CONTROL TO THE (E)STAE OR   05318000
*                                      FRR EXIT ROUTINE.             */ 05319000
*             DO;                   /* ABEND(APCTABND)               */ 05320000
*               RESPECIFY                                       02S1698 05321000
*                (GPR01F) RESTRICTED;                           02S1698 05322000
*               GPR01F=APCTABND;    /* COMP CODE IN REG 1            */ 05323000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1699 05324000
*               SVC(13);            /* ISSUE ABEND SVC               */ 05325000
         SVC   13                                               02S1700 05326000
*               RESPECIFY                                       02S1701 05327000
*                (GPR01F) UNRESTRICTED;                         02S1701 05328000
*             END;                  /* ABEND(APCTABND) FORCE ABEND   */ 05329000
*             GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      02S1703 05330000
*                                                  /* NO CODE           05331000
*           END;                    /* ABEND ISSUED                  */ 05332000
*         END;                      /* ERROR PROCESSED               */ 05333000
*       RFY                                                     02S1706 05334000
*         R15F UNRSTD;              /* DONE WITH RETURN CODE         */ 05335000
@RF01693 DS    0H                                               02S1707 05336000
*       APESFLLK=BOFF;              /* SHOW LOCK NOT OWNED           */ 05337000
         NI    APESFLLK,B'11011111'                             02S1707 05338000
*     END;                          /* LOCK RELEASED                 */ 05339000
*                                                               02S1708 05340000
*   /*****************************************************************/ 05341000
*   /*                                                               */ 05342000
*   /* PROCESSING COMPLETE. RETURN TO THE CALLER.                    */ 05343000
*   /*                                                               */ 05344000
*   /*****************************************************************/ 05345000
*                                                               02S1709 05346000
*   RETURN;                         /* RETURN TO THE CALLER          */ 05347000
@EL00010 DS    0H                                               02S1709 05348000
@EF00010 DS    0H                                               02S1709 05349000
@ER00010 LM    @14,@12,12(@13)                                  02S1709 05350000
         BR    @14                                              02S1709 05351000
*   END FREELLCK;                   /* END OF SUBROUTINE             */ 05352000
         B     @EL00010                                         02S1710 05353000
         EJECT                                                          05354000
*GETXLCK:                           /* GET THE CROSS MEMORY SERVICES */ 05355000
*   PROC OPTIONS(NOSAVEAREA);       /* (CMS) LOCK.                   */ 05356000
*                                                               02S1711 05357000
GETXLCK  STM   @14,@12,12(@13)                                  02S1711 05358000
*   /*****************************************************************/ 05359000
*   /*                                                               */ 05360000
*   /* GET THE CMS LOCK. NOTE THAT THE LOCAL LOCK MUST BE OWNED.     */ 05361000
*   /*                                                               */ 05362000
*   /*****************************************************************/ 05363000
*                                                               02S1712 05364000
*   STM(R11F,R13F,DSUPVSVE);        /* SAVE DESTROYED REGISTERS      */ 05365000
         STM   R11F,R13F,DSUPVSVE                               02S1712 05366000
*   APESCODE=CERRN24;               /* SET ERROR CODE                */ 05367000
         MVI   APESCODE,X'18'                                   02S1713 05368000
*   GEN REFS(PSALITA,FLC) SETS(R11F,R12F,R13F,R14F);            02S1714 05369000
*                                   /*                                  05370000
         MODESET EXTKEY=ZERO       SETLOCK REQUIRES KEY-0               05371000
         SETLOCK OBTAIN,           ACQUIRE THE                         *05372000
               TYPE=CMS,           * CMS LOCK                          *05373000
               MODE=UNCOND,        * UNCONDITIONALLY.                  *05374000
               RELATED=(FREEXLCK,APESFXLK) * R13 HAS RETURN CODE        05375000
         MODESET EXTKEY=DATAMGT    RESUME STANDARD KEY                  05376000
*   RFY                                                         02S1715 05377000
*     R15F RSTD;                    /* HOLDS SETLOCK RETURN CODE     */ 05378000
*   R15F=R13F;                      /* SAVE SETLOCK RETURN CODE      */ 05379000
         LR    R15F,R13F                                        02S1716 05380000
*   APESCODE=CERRN99;               /* RESET ERROR CODE              */ 05381000
         MVI   APESCODE,X'21'                                   02S1717 05382000
*   LM(R11F,R13F,DSUPVSVE);         /* RELOAD DESTROYED REGISTERS    */ 05383000
*                                                               02S1718 05384000
         LM    R11F,R13F,DSUPVSVE                               02S1718 05385000
*   /*****************************************************************/ 05386000
*   /*                                                               */ 05387000
*   /* INSURE LOCK ACQUIRED. ABEND IF NOT                            */ 05388000
*   /*                                                               */ 05389000
*   /*****************************************************************/ 05390000
*                                                               02S1719 05391000
*   IF R15F^=0 THEN                 /* IF SETLOCK FAILED,            */ 05392000
         LTR   R15F,R15F                                        02S1719 05393000
         BZ    @RF01719                                         02S1719 05394000
*     DO;                           /* THEN TERMINATE PROCESSING     */ 05395000
*       APESCODE=CERRN24;           /* SET ERROR CODE                */ 05396000
         MVI   APESCODE,X'18'                                   02S1721 05397000
*       DO;                         /* FORCE ABEND TO LOG ERROR &       05398000
*                                      PASS CONTROL TO THE (E)STAE OR   05399000
*                                      FRR EXIT ROUTINE.             */ 05400000
*         DO;                       /* ABEND(APCTABND)               */ 05401000
*           RESPECIFY                                           02S1724 05402000
*            (GPR01F) RESTRICTED;                               02S1724 05403000
*           GPR01F=APCTABND;        /* COMP CODE IN REG 1            */ 05404000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1725 05405000
*           SVC(13);                /* ISSUE ABEND SVC               */ 05406000
         SVC   13                                               02S1726 05407000
*           RESPECIFY                                           02S1727 05408000
*            (GPR01F) UNRESTRICTED;                             02S1727 05409000
*         END;                      /* ABEND(APCTABND) FORCE ABEND   */ 05410000
*         GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);          02S1729 05411000
*                                                  /* NO CODE           05412000
*       END;                        /* ABEND ISSUED                  */ 05413000
*     END;                          /* ERROR PROCESSED               */ 05414000
*   RFY                                                         02S1732 05415000
*     R15F UNRSTD;                  /* FINISHED WITH RETURN CODE     */ 05416000
*                                                               02S1732 05417000
@RF01719 DS    0H                                               02S1733 05418000
*   /*****************************************************************/ 05419000
*   /*                                                               */ 05420000
*   /* PROCESSING COMPLETE. RETURN TO CALLER                         */ 05421000
*   /*                                                               */ 05422000
*   /*****************************************************************/ 05423000
*                                                               02S1733 05424000
*   APESFXLK=BON;                   /* SHOW CMS LOCK OWNED           */ 05425000
         OI    APESFXLK,B'00010000'                             02S1733 05426000
*   RETURN;                         /* RETURN TO CALLER              */ 05427000
@EL00011 DS    0H                                               02S1734 05428000
@EF00011 DS    0H                                               02S1734 05429000
@ER00011 LM    @14,@12,12(@13)                                  02S1734 05430000
         BR    @14                                              02S1734 05431000
*   END GETXLCK;                    /* END OF SUBROUTINE             */ 05432000
         EJECT                                                          05433000
*FREEXLCK:                          /* RELEASE THE CROSS MEMORY      */ 05434000
*   PROC OPTIONS(NOSAVEAREA);       /* SERVICES LOCK                 */ 05435000
*                                                               02S1736 05436000
FREEXLCK STM   @14,@12,12(@13)                                  02S1736 05437000
*   /*****************************************************************/ 05438000
*   /*                                                               */ 05439000
*   /* RELEASE THE CROSS MEMORY SERVICES (CMS) LOCK. WAS ACQUIRED BY */ 05440000
*   /* GETXLCK.                                                      */ 05441000
*   /*                                                               */ 05442000
*   /*****************************************************************/ 05443000
*                                                               02S1737 05444000
*   IF APESFXLK=BON THEN            /* IF CMS LOCK OWNED,            */ 05445000
         TM    APESFXLK,B'00010000'                             02S1737 05446000
         BNO   @RF01737                                         02S1737 05447000
*     DO;                           /* THEN RELEASE IT.              */ 05448000
*       STM(R11F,R13F,DSUPVSVE);    /* SAVE DESTROYED REGISTERS      */ 05449000
         STM   R11F,R13F,DSUPVSVE                               02S1739 05450000
*       APESCODE=CERRN29;           /* SET ERROR CODE                */ 05451000
         MVI   APESCODE,X'1D'                                   02S1740 05452000
*       GEN REFS(PSALITA,FLC) SETS(R11F,R12F,R13F,R14F);        02S1741 05453000
*                                      /*                               05454000
         MODESET EXTKEY=ZERO       SETLOCK REQUIRES KEY-0               05455000
         SETLOCK RELEASE,          RELEASE THE                         *05456000
               TYPE=CMS,           * CMS LOCK                          *05457000
               RELATED=(GETXLCK,APESFXLK) * R13 HAS RETURN CODE         05458000
         MODESET EXTKEY=DATAMGT    RESUME STANDARD KEY                  05459000
*       RFY                                                     02S1742 05460000
*         R15F RSTD;                /* WILL HOLD SETLOCK RETURN CODE */ 05461000
*       APESCODE=CERRN99;           /* RESET ERROR CODE              */ 05462000
         MVI   APESCODE,X'21'                                   02S1743 05463000
*       R15F=R13F;                  /* HOLD RETURN CODE              */ 05464000
         LR    R15F,R13F                                        02S1744 05465000
*       LM(R11F,R13F,DSUPVSVE);     /* RESTORE DESTROYED REGISTERS   */ 05466000
         LM    R11F,R13F,DSUPVSVE                               02S1745 05467000
*       IF R15F^=0 THEN             /* IF SETLOCK FAILED,            */ 05468000
         LTR   R15F,R15F                                        02S1746 05469000
         BZ    @RF01746                                         02S1746 05470000
*         DO;                       /* THEN LOG AND TERMINATE.       */ 05471000
*           APESCODE=CERRN29;       /* SET ERROR CODE                */ 05472000
         MVI   APESCODE,X'1D'                                   02S1748 05473000
*           DO;                     /* FORCE ABEND TO LOG ERROR &       05474000
*                                      PASS CONTROL TO THE (E)STAE OR   05475000
*                                      FRR EXIT ROUTINE.             */ 05476000
*             DO;                   /* ABEND(APCTABND)               */ 05477000
*               RESPECIFY                                       02S1751 05478000
*                (GPR01F) RESTRICTED;                           02S1751 05479000
*               GPR01F=APCTABND;    /* COMP CODE IN REG 1            */ 05480000
         L     GPR01F,APCTABND(,APCTPTR)                        02S1752 05481000
*               SVC(13);            /* ISSUE ABEND SVC               */ 05482000
         SVC   13                                               02S1753 05483000
*               RESPECIFY                                       02S1754 05484000
*                (GPR01F) UNRESTRICTED;                         02S1754 05485000
*             END;                  /* ABEND(APCTABND) FORCE ABEND   */ 05486000
*             GEN NOREFS NOSETS NOSEQFLOW FLOWS(APCVZUKA);      02S1756 05487000
*                                                  /* NO CODE           05488000
*           END;                    /* ABEND ISSUED                  */ 05489000
*         END;                      /* ERROR PROCESSED               */ 05490000
*       RFY                                                     02S1759 05491000
*         R15F UNRSTD;              /* DONE WITH RETURN CODE         */ 05492000
@RF01746 DS    0H                                               02S1760 05493000
*       APESFXLK=BOFF;              /* SHOW LOCK NOT OWNED           */ 05494000
         NI    APESFXLK,B'11101111'                             02S1760 05495000
*     END;                          /* LOCK RELEASED                 */ 05496000
*                                                               02S1761 05497000
*   /*****************************************************************/ 05498000
*   /*                                                               */ 05499000
*   /* PROCESSING COMPLETE. RETURN TO THE CALLER.                    */ 05500000
*   /*                                                               */ 05501000
*   /*****************************************************************/ 05502000
*                                                               02S1762 05503000
*   RETURN;                         /* RETURN TO THE CALLER          */ 05504000
@EL00012 DS    0H                                               02S1762 05505000
@EF00012 DS    0H                                               02S1762 05506000
@ER00012 LM    @14,@12,12(@13)                                  02S1762 05507000
         BR    @14                                              02S1762 05508000
*   END FREEXLCK;                   /* END OF SUBROUTINE             */ 05509000
         B     @EL00012                                         02S1763 05510000
         EJECT                                                          05511000
*FIXAPIO:                           /* REPAIR THE APIO CHAIN         */ 05512000
*   PROC;                           /* ENTERED IN KEY-0              */ 05513000
*                                                               02S1764 05514000
FIXAPIO  STM   @14,@12,@SA00013                                 02S1764 05515000
*   /*****************************************************************/ 05516000
*   /*                                                               */ 05517000
*   /* ENTERED WHEN AN ERROR OCCURS SCANNING OR UPDATING THE APIO    */ 05518000
*   /* CHAIN. THIS ROUTINE WILL ATTEMPT TO REPAIR THE CHAIN. IF      */ 05519000
*   /* REPAIR IS IMPOSSIBLE, THE QUEUE HEADERS AND RESET TO ZERO,    */ 05520000
*   /* THUS ELIMINATING THE ENTIRE APIO QUEUE. CONTROL THEN RETURNS  */ 05521000
*   /* TO CALL QUEUE USER (RETURN ADDRESS CONTAINED IN REGISTER 14). */ 05522000
*   /* CONTROL MUST BE RETURNED IN KEY-5, WITH THE RECURSION FLAG    */ 05523000
*   /* (APESPREV) SET ON. THIS PREVENTS RECURSION LOOPING IF THE     */ 05524000
*   /* CALLER HAS A PROBLEM (RATHER THAN AN INVALID APIO QUEUE). ON  */ 05525000
*   /* ENTRY, THE LOCAL AND CMS LOCKS MUST BE OWNED (THIS IS A       */ 05526000
*   /* REQUIREMENT FOR TASKS UPDATING THE APIO QUEUE).               */ 05527000
*   /*                                                               */ 05528000
*   /*****************************************************************/ 05529000
*                                                               02S1765 05530000
*                                                               02S1765 05531000
*   /*****************************************************************/ 05532000
*   /*                                                               */ 05533000
*   /* SAVE CURRENT RECOVERY ENVIRONMENT. SET RETRY FOR 'FIXAPIO1',  */ 05534000
*   /* WHICH ELIMINATES THE APIO CHAIN.                              */ 05535000
*   /*                                                               */ 05536000
*   /*****************************************************************/ 05537000
*                                                               02S1765 05538000
*   GEN(MODESET EXTKEY=DATAMGT)                                 02S1765 05539000
*   NOREFS NOSETS;                  /* NORMAL KEY                    */ 05540000
         MODESET EXTKEY=DATAMGT                                         05541000
*   DRETRY(10)=APESRTRY;            /* SAVE CURRENT RETRY POINT      */ 05542000
         L     @09,APESREGP                                     02S1766 05543000
         L     @04,APESRTRY(,@09)                               02S1766 05544000
         ST    @04,DRETRY+36                                    02S1766 05545000
*   APESRTRY=ADDR(FIXAPIO1);        /* NEW RETRY -- ELIMINATE APIO   */ 05546000
         LA    @04,FIXAPIO1                                     02S1767 05547000
         ST    @04,APESRTRY(,@09)                               02S1767 05548000
*   GEN NOREFS NOSETS SEQFLOW FLOWS(FIXAPIO1);                  02S1768 05549000
*                                   /* NO CODE -- SHOW FIXAPIO1 USED    05550000
*   DO;                             /* ERROR RECOVERY COMPLETE       */ 05551000
*     APESFPRV=BOFF;                /* RESET RECURSION FLAG.         */ 05552000
         NI    APESFPRV,B'10111111'                             02S1770 05553000
*     APESCODE=CERRN99;             /* RESET ERROR CODE              */ 05554000
         MVI   APESCODE,X'21'                                   02S1771 05555000
*     APESFDMP=BON;                 /* RESET DUMP/LOG FLAGS          */ 05556000
*     APESFREC=BON;                 /* TO THEIR NORMAL VALUES        */ 05557000
*     APESFSDP=BON;                 /* (ALL ON)                      */ 05558000
         OI    APESFDMP,B'11100000'                             02S1774 05559000
*   END;                            /* ALL INDICATORS RESET          */ 05560000
*                                                               02S1775 05561000
*   /*****************************************************************/ 05562000
*   /*                                                               */ 05563000
*   /* BUILD Q-VERIFICATION BLOCK                                    */ 05564000
*   /*                                                               */ 05565000
*   /*****************************************************************/ 05566000
*                                                               02S1776 05567000
*   QVPL=QVPL&&QVPL;                /* RESET ALL FIELDS              */ 05568000
         XC    QVPL(40),QVPL                                    02S1776 05569000
*   QVPLEVR=ADDR(FIXAPIOV);         /* APIO VERIFICATION ROUTINE     */ 05570000
         LA    @09,FIXAPIOV                                     02S1777 05571000
         ST    @09,QVPLEVR                                      02S1777 05572000
*   QVPLWKA=ADDR(DFXAPIOW);         /* Q-VERIFICATION WORKAREA       */ 05573000
         LA    @09,DFXAPIOW                                     02S1778 05574000
         ST    @09,QVPLWKA                                      02S1778 05575000
*   QVPLHDR=ADDR(APCTAPIO);         /* Q-HEADER (FORWARD)            */ 05576000
         LA    @09,APCTAPIO(,APCTPTR)                           02S1779 05577000
         ST    @09,QVPLHDR                                      02S1779 05578000
*   QVPLFPTR=ADDR(APIOAPIO)-ADDR(APIO);/* FORWARD POINTER OFFSET     */ 05579000
         MVC   QVPLFPTR(2),@CH04216                             02S1780 05580000
*   QVPLTRLR=ADDR(APCTIOAP);        /* Q-HEADER (BACKWARD)           */ 05581000
         LA    @09,APCTIOAP(,APCTPTR)                           02S1781 05582000
         ST    @09,QVPLTRLR                                     02S1781 05583000
*   QVPLBPTR=ADDR(APIOIOAP)-ADDR(APIO);/* BACK CHAIN OFFSET          */ 05584000
*                                                               02S1782 05585000
         MVC   QVPLBPTR(2),@CH04217                             02S1782 05586000
*   /*****************************************************************/ 05587000
*   /*                                                               */ 05588000
*   /* CALL IEAVEQV3 -- DOUBLE THREADED CHAIN VERIFICATION           */ 05589000
*   /*                                                               */ 05590000
*   /*****************************************************************/ 05591000
*                                                               02S1783 05592000
*   RFY                                                         02S1783 05593000
*     R1P RSTD;                     /* INPUT REGISTER                */ 05594000
*   R1P=ADDR(QVPL);                 /* IEAVEQV3 PARM AREA            */ 05595000
         LA    R1P,QVPL                                         02S1784 05596000
*   GEN(MODESET EXTKEY=ZERO)                                    02S1785 05597000
*   NOREFS NOSETS;                  /* APCT (KEY-1) & APIO (KEY-5)      05598000
*                                      UPDATE REQUIRES KEY-0         */ 05599000
         MODESET EXTKEY=ZERO                                            05600000
*   CALL IEAVEQV3;                  /* VERIFY QUEUE                  */ 05601000
         L     @09,CVTPTR                                       02S1786 05602000
         L     @15,CVTQV3(,@09)                                 02S1786 05603000
         BALR  @14,@15                                          02S1786 05604000
*   GEN NOREFS NOSETS FLOWS(FIXAPIOV) SEQFLOW;                  02S1787 05605000
*                                   /* NO CODE - SHOW FIXAPIOV USED     05606000
*   RFY                                                         02S1788 05607000
*     R1P UNRSTD;                   /* FINISHED WITH PARMS           */ 05608000
*   GEN(MODESET EXTKEY=DATAMGT)                                 02S1789 05609000
*   NOREFS NOSETS;                  /* NORMAL KEY                    */ 05610000
         MODESET EXTKEY=DATAMGT                                         05611000
*   APESFPRV=BON;                   /* RESET ERROR STATUS            */ 05612000
         OI    APESFPRV,B'01000000'                             02S1790 05613000
*   APESRTRY=DRETRY(10);            /* RESET RECOVERY ADDRESS        */ 05614000
         L     @09,DRETRY+36                                    02S1791 05615000
         L     @04,APESREGP                                     02S1791 05616000
         ST    @09,APESRTRY(,@04)                               02S1791 05617000
*   RETURN;                                                     02S1792 05618000
@EL00013 DS    0H                                               02S1792 05619000
@EF00013 DS    0H                                               02S1792 05620000
@ER00013 LM    @14,@12,@SA00013                                 02S1792 05621000
         BR    @14                                              02S1792 05622000
*FIXAPIOV:                          /* APIO VERIFICATION EXIT        */ 05623000
*   PROC OPTIONS(NOSAVE,            /* R13 SAVEAREA NOT AVAILABLE    */ 05624000
*       NOSAVEAREA);                /* NO DYNAMIC AREA POINTER       */ 05625000
*                                                               02S1793 05626000
FIXAPIOV DS    0H                                               02S1794 05627000
*   /*****************************************************************/ 05628000
*   /*                                                               */ 05629000
*   /* FOLLOWING INTERNAL PROCEDURE GIVEN CONTROL BY IEAVEQV3 TO     */ 05630000
*   /* VERIFY THAT THE CONTROL BLOCK POINTED TO BY REGISTER 0 IS AN  */ 05631000
*   /* APIO. THIS ROUTINE MUST INSURE THAT A PROGRAM CHECK DOES NOT  */ 05632000
*   /* OCCUR. ON EXIT REGISTER 15 INDICATE IF THE BLOCK IS VALID     */ 05633000
*   /* (0=YES, 8=NO). REGISTERS 8-14 MUST BE RETURNED UNCHANGED.     */ 05634000
*   /* OTHERS ARE VOLITILE.                                          */ 05635000
*   /*                                                               */ 05636000
*   /*****************************************************************/ 05637000
*                                                               02S1794 05638000
*   RFY                                                         02S1794 05639000
*    (R0P,                          /* APIO ADDRESS                  */ 05640000
*     R8P,                                                      02S1794 05641000
*     R9P,                                                      02S1794 05642000
*     R10P,                                                     02S1794 05643000
*     R11P,                                                     02S1794 05644000
*     R12P,                                                     02S1794 05645000
*     R13P,                         /* MUST REMAIN UNCHANGED         */ 05646000
*     R14P,                         /* RETURN ADDRESS                */ 05647000
*     R15P) RSTD;                   /* INPUT ADDRESS (APIOFIXV)      */ 05648000
*   GEN REFS(R15P,APCODE,FIXAPIOV) SETS(APCODE);                02S1795 05649000
*                                   /* USING ENVIRONMENT                05650000
         PUSH  USING               SAVE CURRENT USING STATUS            05651000
         DROP  ,                   DROP ALL BASE REGISTERS              05652000
         LR    APCODE,R15P         PUT ENTRY POINT IN BASE REGISTER     05653000
         USING FIXAPIOV,APCODE     TELL ASSEMBLER                       05654000
*   RFY                                                         02S1796 05655000
*     R15P UNRSTD;                  /* DONE WITH TEMPORARY BASE      */ 05656000
*   RFY                                                         02S1797 05657000
*    (R1P,                                                      02S1797 05658000
*     R2P,                                                      02S1797 05659000
*     R15F) RSTD;                   /* REQUIRED REGISTERS            */ 05660000
*   R1P=R0P&'FFFFFFF8'X;            /* APIO ADDRESS IN USEABLE REG      05661000
*                                      (INSURE DOUBLEWORD ALIGNED)   */ 05662000
         LR    R1P,R0P                                          02S1798 05663000
         N     R1P,@CF04017                                     02S1798 05664000
*   RFY                                                         02S1799 05665000
*     APIO BASED(R1P);              /* TELL PL/S                     */ 05666000
*                                                               02S1799 05667000
*   /*****************************************************************/ 05668000
*   /*                                                               */ 05669000
*   /* FOLLOWING CHECKS USED TO VERIFY APIO -- (1) APIO IN REAL      */ 05670000
*   /* STORAGE, (2) APIO IN KEY-5, NON-FETCH PROTECTED STORAGE, AND  */ 05671000
*   /* (3) APIOID HAS 'APIO'. CARE IS TAKEN TO INSURE THAT A PROGRAM */ 05672000
*   /* CHECK DOES NOT OCCUR VERIFYING THE APIO.                      */ 05673000
*   /*                                                               */ 05674000
*   /*****************************************************************/ 05675000
*                                                               02S1800 05676000
*   R15F=8;                         /* ERROR RETURN CODE             */ 05677000
         LA    R15F,8                                           02S1800 05678000
*   IF R1P=R0P THEN                 /* INSURE APIO WAS DOUBLE WORD   */ 05679000
         CR    R1P,R0P                                          02S1801 05680000
         BNE   @RF01801                                         02S1801 05681000
*     DO;                           /* ALIGNED. IF NOT IS ERROR.     */ 05682000
*       GEN(LRA   R0P,0(,R1P))                                  02S1803 05683000
*       REFS(R1P) SETS(R0P);        /* SEE IF IN STORAGE             */ 05684000
         LRA   R0P,0(,R1P)                                              05685000
*       BC(7,FIXAPIOZ);             /* NO--NOT APIO                  */ 05686000
         BC    7,FIXAPIOZ                                       02S1804 05687000
*       DO;                         /* (TREAT ABOVE AS IF)           */ 05688000
*         R0P=R0P&'FFFFF800'X;      /* HARDWARE PAGE BDY (2K)        */ 05689000
         N     R0P,@CF04153                                     02S1806 05690000
*         GEN(ISK   R0P,R0P)                                    02S1807 05691000
*         REFS(R0P) SETS(R0P);      /* STORAGE KEY                   */ 05692000
         ISK   R0P,R0P                                                  05693000
*         R0P=R0P&'000000F8'X;      /* LEAVE ACCESS CODE, FETCH AUTH */ 05694000
         N     R0P,@CF04154                                     02S1808 05695000
*         IF R0P=16*APIOKEY THEN    /* MUST BE KEY OF APIO AND       */ 05696000
         C     R0P,@CF01907                                     02S1809 05697000
         BNE   @RF01809                                         02S1809 05698000
*           DO;                     /* NOT FETCH PROTECTED.          */ 05699000
*             R2P=ADDR(APIOSIZE);   /* INSURE 'APIOSIZE' FIELD       */ 05700000
         LA    R2P,APIOSIZE(,R1P)                               02S1811 05701000
*             GEN(LRA   R0P,0(,R2P))                            02S1812 05702000
*             REFS(R2P) SETS(R0P);  /* IS REFERENCABLE               */ 05703000
         LRA   R0P,0(,R2P)                                              05704000
*             BC(7,FIXAPIOZ);       /* (KEY CHECK NOT REQUIRED)      */ 05705000
         BC    7,FIXAPIOZ                                       02S1813 05706000
*             DO;                   /* TREAT ABOVE AS 'IF'           */ 05707000
*               R2P=ADDR(APIO)+APIOSIZE/* SET R2P = ADDR             */ 05708000
*                   -1;             /* OF LAST BYTE IN APIO          */ 05709000
         LR    R2P,R1P                                          02S1815 05710000
         AH    R2P,APIOSIZE(,R1P)                               02S1815 05711000
         BCTR  R2P,0                                            02S1815 05712000
*               GEN(LRA   R0P,0(,R1P))                          02S1816 05713000
*               REFS(R1P) SETS(R0P);/* REPEAT ABOVE CHECKS           */ 05714000
         LRA   R0P,0(,R1P)                                              05715000
*               BC(7,FIXAPIOZ);     /* TO INSURE THAT THE ENTIRE     */ 05716000
         BC    7,FIXAPIOZ                                       02S1817 05717000
*               DO;                 /* APIO (LESS THAN 2K) EXISTS    */ 05718000
*                 R0P=R0P&'FFFFF800'X;/* IN VALID STORAGE.           */ 05719000
         N     R0P,@CF04153                                     02S1819 05720000
*                 GEN(ISK   R0P,R0P)                            02S1820 05721000
*                 REFS(R0P) SETS(R0P);/* IF NOT,                     */ 05722000
         ISK   R0P,R0P                                                  05723000
*                 R0P=R0P&'000000F8'X;/* IS ERROR.                   */ 05724000
         N     R0P,@CF04154                                     02S1821 05725000
*                 IF R0P=16*APIOKEY THEN/* IF OK SO FAR,             */ 05726000
         C     R0P,@CF01907                                     02S1822 05727000
         BNE   @RF01822                                         02S1822 05728000
*                   IF APIOID=APIOIDC THEN/* THEN CAN                */ 05729000
         CLC   APIOID(4,R1P),@CC03144                           02S1823 05730000
         BNE   @RF01823                                         02S1823 05731000
*                     R15F=0;       /* REFERENCE THE APIO.           */ 05732000
         SLR   R15F,R15F                                        02S1824 05733000
*               END;                /* INSURE THAT THE APIO          */ 05734000
@RF01823 DS    0H                                               02S1825 05735000
@RF01822 DS    0H                                               02S1826 05736000
*             END;                  /* HEADER ID IS ALSO VALID       */ 05737000
*           END;                    /* (THIS CHECKS FOR OVERLAID     */ 05738000
*       END;                        /* APIO).                        */ 05739000
@RF01809 DS    0H                                               02S1829 05740000
*     END;                          /* R15F INDICATES IF BAD APIO.   */ 05741000
*   RFY                                                         02S1830 05742000
*     APIO BASED(ADDR(DAPIO));      /* USE DUMMY COPY AGAIN          */ 05743000
@RF01801 DS    0H                                               02S1831 05744000
*FIXAPIOZ:                                                      02S1831 05745000
*   ;                               /* APIO VERIFIED                 */ 05746000
*                                                               02S1831 05747000
FIXAPIOZ DS    0H                                               02S1832 05748000
*   /*****************************************************************/ 05749000
*   /*                                                               */ 05750000
*   /* REGISTER 15 SET (0/8). RETURN TO Q-VERIFICATION.              */ 05751000
*   /*                                                               */ 05752000
*   /*****************************************************************/ 05753000
*                                                               02S1832 05754000
*   GEN(POP   USING)                                            02S1832 05755000
*   NOREFS NOSETS;                  /* RESTORE USING STATUS          */ 05756000
         POP   USING                                                    05757000
*   RETURN;                         /* RETURN TO Q-VERIFICATION      */ 05758000
@EL00014 DS    0H                                               02S1833 05759000
@EF00014 DS    0H                                               02S1833 05760000
@ER00014 BR    @14                                              02S1833 05761000
*   RFY                                                         02S1834 05762000
*     APIO BASED(ADDR(DAPIO));      /* USE COPY                      */ 05763000
*   RFY                                                         02S1835 05764000
*    (R0P,                                                      02S1835 05765000
*     R8P,                                                      02S1835 05766000
*     R9P,                                                      02S1835 05767000
*     R10P,                                                     02S1835 05768000
*     R11P,                                                     02S1835 05769000
*     R12P,                                                     02S1835 05770000
*     R13P,                                                     02S1835 05771000
*     R14P,                                                     02S1835 05772000
*     R1P,                                                      02S1835 05773000
*     R2P,                                                      02S1835 05774000
*     R15F) UNRSTD;                                             02S1835 05775000
*   END FIXAPIOV;                   /* END OF APIO VERIFICATION EXIT */ 05776000
*FIXAPIO1:                          /* APIO QUEUE VERIFICATION RETRY */ 05777000
*                                                               02S1837 05778000
*   /*****************************************************************/ 05779000
*   /*                                                               */ 05780000
*   /* FOLLOWING ROUTINE GETS CONTROL IF AN ABEND OCCURS DURING QUEUE*/ 05781000
*   /* VERIFICATION. THE APIO CHAIN IS 'PATCHED' BY ELIMINATING ALL  */ 05782000
*   /* ENTRIES.                                                      */ 05783000
*   /*                                                               */ 05784000
*   /*****************************************************************/ 05785000
*                                                               02S1837 05786000
*   DO;                             /* ENTRY FROM ESTAE/FRR RETRY    */ 05787000
*                                                               02S1837 05788000
FIXAPIO1 DS    0H                                               02S1838 05789000
*     /***************************************************************/ 05790000
*     /*                                                             */ 05791000
*     /* ENTRY FROM ESTAE/FRR RETRY (IGTUKA). RETRY DOES NOT INSURE  */ 05792000
*     /* REGISTERS 0-5, 8-11, 14-15 VALID SINCE NOT SAVED IN         */ 05793000
*     /* APESREGS. ISSUE DUMMY RESTRICT TO WIPE PL/S OPTIMIZATION    */ 05794000
*     /* MEMORY OF CURRENT REGISTER VALUES                           */ 05795000
*     /*                                                             */ 05796000
*     /***************************************************************/ 05797000
*                                                               02S1838 05798000
*     RFY                                                       02S1838 05799000
*      (R0RSTD,                                                 02S1838 05800000
*       R1RSTD,                                                 02S1838 05801000
*       R2RSTD,                                                 02S1838 05802000
*       R3RSTD,                                                 02S1838 05803000
*       R4RSTD,                                                 02S1838 05804000
*       R5RSTD,                     /* 6-7 BASES                     */ 05805000
*       R8RSTD,                                                 02S1838 05806000
*       R9RSTD,                                                 02S1838 05807000
*       R10RSTD,                                                02S1838 05808000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 05809000
*       R14RSTD,                                                02S1838 05810000
*       R15RSTD) RSTD;              /* KEEP PL/S FROM CARRYING DATA  */ 05811000
*     GEN(MODESET EXTKEY=DATAMGT);  /* SWITCH TO STANDARD KEY (5)    */ 05812000
         MODESET EXTKEY=DATAMGT                                         05813000
*     RFY                                                       02S1840 05814000
*      (R0RSTD,                                                 02S1840 05815000
*       R1RSTD,                                                 02S1840 05816000
*       R2RSTD,                                                 02S1840 05817000
*       R3RSTD,                                                 02S1840 05818000
*       R4RSTD,                                                 02S1840 05819000
*       R5RSTD,                     /* 6-7 BASES                     */ 05820000
*       R8RSTD,                                                 02S1840 05821000
*       R9RSTD,                                                 02S1840 05822000
*       R10RSTD,                                                02S1840 05823000
*       R11RSTD,                    /* 12-13 APCT/APSV PTRS          */ 05824000
*       R14RSTD,                                                02S1840 05825000
*       R15RSTD) UNRSTD;            /* ALLOW PL/S TO USE REGS AGAIN  */ 05826000
*   END;                            /* RETRY ENVIRONMENT SET         */ 05827000
*   APESRTRY=DRETRY(10);            /* RESTORE ORIGINAL RECOVERY ADDR*/ 05828000
         L     @09,DRETRY+36                                    02S1842 05829000
         L     @04,APESREGP                                     02S1842 05830000
         ST    @09,APESRTRY(,@04)                               02S1842 05831000
*   GEN(MODESET EXTKEY=SCHED)                                   02S1843 05832000
*   NOREFS NOSETS;                  /* SWITCH TO APCT KEY            */ 05833000
         MODESET EXTKEY=SCHED                                           05834000
*   APCTAPIO=0;                     /* CLEAR THE APIO CHAIN          */ 05835000
         SLR   @09,@09                                          02S1844 05836000
         ST    @09,APCTAPIO(,APCTPTR)                           02S1844 05837000
*   APCTIOAP=0;                     /* HEADERS (FORWARD AND BACKWARD)*/ 05838000
         ST    @09,APCTIOAP(,APCTPTR)                           02S1845 05839000
*   GEN(MODESET EXTKEY=DATAMGT)                                 02S1846 05840000
*   NOREFS NOSETS;                  /* RESUME STANDARD KEY           */ 05841000
         MODESET EXTKEY=DATAMGT                                         05842000
*   RETURN;                         /* RETURN TO CALLER.             */ 05843000
         B     @EL00013                                         02S1847 05844000
*   END;                            /* END OF CODE                   */ 05845000
         EJECT                                                          05846000
*                                   /* IGTXEPLG                      */ 05847000
*                                                               01S1849 05848000
*   /*****************************************************************/ 05849000
*   /*                                                               */ 05850000
*   /* SYSTEM DECLARES                                               */ 05851000
*   /*                                                               */ 05852000
*   /*****************************************************************/ 05853000
*                                                               01S1849 05854000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 05855000
*     GPR00F FIXED(31) REG(0),                                  01S1849 05856000
*     GPR01F FIXED(31) REG(1),                                  01S1849 05857000
*     GPR01P PTR(31) REG(1);                                    01S1849 05858000
*   DECLARE                         /* COMMON VARIABLES              */ 05859000
*     I256C CHAR(256) BASED,                                    01S1850 05860000
*     I031F FIXED(31) BASED,                                    01S1850 05861000
*     I031P PTR(31) BASED,                                      01S1850 05862000
*     I015F FIXED(15) BASED,                                    01S1850 05863000
*     I015P PTR(15) BASED,                                      01S1850 05864000
*     I008P PTR(8) BASED,                                       01S1850 05865000
*     I001C CHAR(1) BASED;                                      01S1850 05866000
*                                                               01S1851 05867000
*   /*****************************************************************/ 05868000
*   /*                                                               */ 05869000
*   /* MODULE PATCH AREA                                             */ 05870000
*   /*                                                               */ 05871000
*   /*****************************************************************/ 05872000
*                                                               01S1851 05873000
*   DCL                                                         01S1851 05874000
*     APPATCH CHAR(*) INT STATIC LOCAL GEND;                    01S1851 05875000
*   GENERATE DATA DEFS(APPATCH);                                01S1852 05876000
*                                                               01S1853 05877000
*   /*****************************************************************/ 05878000
*   /*                                                               */ 05879000
*   /* GENERAL REGISTER DECLARES                                     */ 05880000
*   /*                                                               */ 05881000
*   /*****************************************************************/ 05882000
*                                                               01S1853 05883000
*   DCL                                                         01S1853 05884000
*     R0F FIXED(31) REG(0),                                     01S1853 05885000
*     R0P PTR(24) REG(0),                                       01S1853 05886000
*     R0RSTD PTR(31) REG(0),                                    01S1853 05887000
*     R1F FIXED(31) REG(1),                                     01S1853 05888000
*     R1P PTR(24) REG(1),                                       01S1853 05889000
*     R1RSTD PTR(31) REG(1),                                    01S1853 05890000
*     R2F FIXED(31) REG(2),                                     01S1853 05891000
*     R2P PTR(24) REG(2),                                       01S1853 05892000
*     R2RSTD PTR(31) REG(2),                                    01S1853 05893000
*     R3F FIXED(31) REG(3),                                     01S1853 05894000
*     R3P PTR(24) REG(3),                                       01S1853 05895000
*     R3RSTD PTR(31) REG(3),                                    01S1853 05896000
*     R4F FIXED(31) REG(4),                                     01S1853 05897000
*     R4P PTR(24) REG(4),                                       01S1853 05898000
*     R4RSTD PTR(31) REG(4),                                    01S1853 05899000
*     R5F FIXED(31) REG(5),                                     01S1853 05900000
*     R5P PTR(24) REG(5),                                       01S1853 05901000
*     R5RSTD PTR(31) REG(5),                                    01S1853 05902000
*     R6F FIXED(31) REG(6),                                     01S1853 05903000
*     R6P PTR(24) REG(6),                                       01S1853 05904000
*     R6RSTD PTR(31) REG(6),                                    01S1853 05905000
*     R7F FIXED(31) REG(7),                                     01S1853 05906000
*     R7P PTR(24) REG(7),                                       01S1853 05907000
*     R7RSTD PTR(31) REG(7),                                    01S1853 05908000
*     R8F FIXED(31) REG(8),                                     01S1853 05909000
*     R8P PTR(24) REG(8),                                       01S1853 05910000
*     R8RSTD PTR(31) REG(8),                                    01S1853 05911000
*     R9F FIXED(31) REG(9),                                     01S1853 05912000
*     R9P PTR(24) REG(9),                                       01S1853 05913000
*     R9RSTD PTR(31) REG(9),                                    01S1853 05914000
*     R10F FIXED(31) REG(10),                                   01S1853 05915000
*     R10P PTR(24) REG(10),                                     01S1853 05916000
*     R10RSTD PTR(31) REG(10),                                  01S1853 05917000
*     R11F FIXED(31) REG(11),                                   01S1853 05918000
*     R11P PTR(24) REG(11),                                     01S1853 05919000
*     R11RSTD PTR(31) REG(11),                                  01S1853 05920000
*     R12F FIXED(31) REG(12),                                   01S1853 05921000
*     R12P PTR(24) REG(12),                                     01S1853 05922000
*     R12RSTD PTR(31) REG(12),                                  01S1853 05923000
*     R13F FIXED(31) REG(13),                                   01S1853 05924000
*     R13P PTR(24) REG(13),                                     01S1853 05925000
*     R13RSTD PTR(31) REG(13),                                  01S1853 05926000
*     R14F FIXED(31) REG(14),                                   01S1853 05927000
*     R14P PTR(24) REG(14),                                     01S1853 05928000
*     R14RSTD PTR(31) REG(14),                                  01S1853 05929000
*     R15F FIXED(31) REG(15),                                   01S1853 05930000
*     R15P PTR(24) REG(15),                                     01S1853 05931000
*     R15RSTD PTR(31) REG(15),                                  01S1853 05932000
*                                                               01S1853 05933000
*     /***************************************************************/ 05934000
*     /*                                                             */ 05935000
*     /* VPSS CONTROL BLOCK POINTER DECLARES                         */ 05936000
*     /*                                                             */ 05937000
*     /***************************************************************/ 05938000
*                                                               01S1853 05939000
*     APSMPTR PTR(24) REG(01),      /* STORAGE MANAGEMENT BLOCK 01S1853 05940000
*                                      (SUGGESTED POINTER)           */ 05941000
*     APSCPTR PTR(24) REG(01),      /* STORAGE MANAGEMENT CONTROL       05942000
*                                      WORD (SUGGESTED POINTER)      */ 05943000
*     APINPTR PTR(24) REG(01),      /* USER'S INPUT PARAMETER LIST      05944000
*                                      (SUGGESTED POINTER)           */ 05945000
*/*                                                                  */ 05946000
*                                                               01S1853 05947000
*     APDATA PTR(24) REG(06),       /* ADDRESS OF DYNAMIC DATA  01S1853 05948000
*                                      WORKAREA (DATAREG)            */ 05949000
*     APCODE PTR(24) REG(07),       /* PROGRAM CODE BASE REGISTER       05950000
*                                      (CODEREG)                     */ 05951000
*     APDEBPTR PTR(24) REG(08),     /* VPSS DEB (SUGGESTED POINTER)  */ 05952000
*     APNPPTR PTR(24) REG(08),      /* SUBSYSTEM INITIALIZATION 01S1853 05953000
*                                      WORKAREA BLOCK (ONLY USED BY     05954000
*                                      SUBSYSTEM INITIALIZATION)     */ 05955000
*     APRLPTR PTR(24) REG(08),      /* VPSS ACB REQUEST LIST    01S1853 05956000
*                                      (SUGGESTED POINTER)           */ 05957000
*     APCIPTR PTR(24) REG(08),      /* 3838 CONTROL TABLE (SUGGESTED    05958000
*                                      POINTER)                      */ 05959000
*     APCWPTR PTR(24) REG(08),      /* CALL INTERFACE WORKAREA  01S1853 05960000
*                                      (SUGGESTED POINTER)           */ 05961000
*     APERPTR PTR(24) REG(08),      /* ERP/IO APPENDAGE WORKAREA        05962000
*                                      (SUGGESTED POINTER)           */ 05963000
*     APACBPTR PTR(24) REG(09),     /* VPSS ACB (SUGGESTED POINTER)  */ 05964000
*     APCQPTR PTR(24) REG(09),      /* COMMAND QUEUE ELEMENT    01S1853 05965000
*                                      (SUGGESTED POINTER)           */ 05966000
*     APOTPTR PTR(24) REG(09),      /* OPTION TABLE (SUGGESTED  01S1853 05967000
*                                      POINTER)                      */ 05968000
*     APIOPTR PTR(24) REG(10),      /* I/O ELEMENT (SUGGESTED   01S1853 05969000
*                                      POINTER)                      */ 05970000
*     APEXLPTR PTR(24) REG(10),     /* VPSS EXLST (SUGGESTED POINTER)*/ 05971000
*     APUBPTR PTR(24) REG(10),      /* UNIT BLOCK (SUGGESTED POINTER)*/ 05972000
*     APAXPTR PTR(24) REG(10),      /* VPSS ACB EXTENSION (SUGGESTED    05973000
*                                      POINTER)                      */ 05974000
*     APCPPTR PTR(24) REG(10),      /* VPSS CALL PROCESSING     01S1853 05975000
*                                      INDICATORS (SUGGESTED POINTER)*/ 05976000
*     APOCPTR PTR(24) REG(10),      /* VPSS OPEN/CLOSE SUBSYSTEM        05977000
*                                      WORKAREA (REQUIRED POINTER)   */ 05978000
*     APATPTR PTR(24) REG(11),      /* VPSS ACB TABLE (SUGGESTED        05979000
*                                      POINTER)                      */ 05980000
*     APLBPTR PTR(24) REG(11),      /* LABEL RESOLUTION TABLE   01S1853 05981000
*                                      (SUGGESTED POINTER)           */ 05982000
*     APUTPTR PTR(24) REG(11),      /* USER TABLE (SUGGESTED POINTER)*/ 05983000
*     APDSPTR PTR(24) REG(11),      /* VPSS DATASET ENTRY (SUGGESTED    05984000
*                                      POINTER)                      */ 05985000
*     APXLPTR PTR(24) REG(11),      /* TRANSLATION TABLE (SUGGESTED     05986000
*                                      POINTER)                      */ 05987000
*     APDXPTR PTR(24) REG(11),      /* VPSS DEB EXTENSION (SUGGESTED    05988000
*                                      POINTER)                      */ 05989000
*     APCTPTR PTR(24) REG(12) RSTD, /* CONTROL TABLE (REQUIRED  01S1853 05990000
*                                      POINTER)                      */ 05991000
*     APSVPTR PTR(24) REG(13) RSTD, /* OS/VPSS SAVEAREA/WORKAREA        05992000
*                                      (REQUIRED POINTER)            */ 05993000
*     APRETURN PTR(24) REG(14),     /* RETURN ADDRESS FOR SUBROUTINE    05994000
*                                      LINKAGE                       */ 05995000
*     APENTRY PTR(24) REG(15),      /* SUBROUTINE ENTRY POINT LINKAGE*/ 05996000
*     APRCODE PTR(24) REG(15);      /* CONTAINS SUBROUTINE RETURN       05997000
*                                      CODE                          */ 05998000
*                                                               01S1854 05999000
*   /*****************************************************************/ 06000000
*   /*                                                               */ 06001000
*   /* USER REGISTER DECLARES                                        */ 06002000
*   /*                                                               */ 06003000
*   /*****************************************************************/ 06004000
*                                                               01S1854 06005000
*   DCL                             /* LOCAL REGISTERS               */ 06006000
*     RDEBPTR PTR(24) REG(02),      /* DEB POINTER SET ON INPUT      */ 06007000
*     RAPDXPTR PTR(24) REG(11),     /* APDX POINTER SET ON INPUT     */ 06008000
*     RAPRLPTR PTR(24) REG(05),     /* HOLD INPUT APRL ADDRESS       */ 06009000
*     RLV FIXED(31) REG(03),        /* HOLD GETMAIN/FREEMAIN LENGTH  */ 06010000
*     RADDR PTR(24) REG(04),        /* HOLD GETMAIN/FREEMAIN ADDRESS */ 06011000
*     RIGTUKA PTR(24) REG(02),      /* ESTAE EXIT POINTER (IGTUKA)   */ 06012000
*     RAPESPTR PTR(24) REG(03),     /* POINTS TO STAE WORKAREA       */ 06013000
*     RAPIOPTR PTR(24) REG(03),     /* POINTS TO APIO DURING BUILD   */ 06014000
*     RVSLPTR PTR(24) REG(03),      /* VSL ENTRY SCANNER             */ 06015000
*     DCCWCUR PTR(24) REG(05)       /* POINTER TO CURRENT CCW. TREAT */ 06016000
*         RSTD,                     /* AS PART OF DCCWBLK. MADE A       06017000
*                                      REGISTER FOR PERFORMANCE.     */ 06018000
*     RERRCODE FIXED(31) REG(03),   /* HOLDS REGISTER 15 RETURN CODE */ 06019000
*     APCODE1 PTR(24) REG(08);      /* ADDITIONAL BASE REGISTER      */ 06020000
*   END IGTKCA                      /* END OF MODULE                 */ 06021000
*                                                               01S1855 06022000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06023000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06024000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06025000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06026000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06027000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06028000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06029000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06030000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06031000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06032000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06033000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06034000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06035000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06036000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06037000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06038000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06039000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06040000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06041000
*/*%INCLUDE SYSLIB  (IGTXSYSI)                                       */ 06042000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 06043000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 06044000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 06045000
*/*%INCLUDE SYSLIB  (IHASUBIT)                                       */ 06046000
*/*%INCLUDE SYSLIB  (IECDIOCM)                                       */ 06047000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 06048000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */ 06049000
*/*%INCLUDE SYSLIB  (IECDIOSB)                                       */ 06050000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 06051000
*/*%INCLUDE SYSLIB  (IHAVSL  )                                       */ 06052000
*/*%INCLUDE SYSLIB  (IGTXAPRL)                                       */ 06053000
*/*%INCLUDE SYSLIB  (IGTXAPCC)                                       */ 06054000
*/*%INCLUDE SYSLIB  (IGTXAPCM)                                       */ 06055000
*/*%INCLUDE SYSLIB  (IGTXAPCT)                                       */ 06056000
*/*%INCLUDE SYSLIB  (IGTXAPCV)                                       */ 06057000
*/*%INCLUDE SYSLIB  (IGTXAPDS)                                       */ 06058000
*/*%INCLUDE SYSLIB  (IGTXAPDX)                                       */ 06059000
*/*%INCLUDE SYSLIB  (IGTXAPGF)                                       */ 06060000
*/*%INCLUDE SYSLIB  (IGTXAPIO)                                       */ 06061000
*/*%INCLUDE SYSLIB  (IGTXAPMF)                                       */ 06062000
*/*%INCLUDE SYSLIB  (IGTXAPMV)                                       */ 06063000
*/*%INCLUDE SYSLIB  (IGTXAPSC)                                       */ 06064000
*/*%INCLUDE SYSLIB  (IGTXAPSM)                                       */ 06065000
*/*%INCLUDE SYSLIB  (IGTXAPSV)                                       */ 06066000
*/*%INCLUDE SYSLIB  (IGTXAPUB)                                       */ 06067000
*/*%INCLUDE SYSLIB  (IGTXAPVU)                                       */ 06068000
*/*%INCLUDE SYSLIB  (IGTXAPXL)                                       */ 06069000
*/*%INCLUDE SYSLIB  (IHAQVPL )                                       */ 06070000
*/*%INCLUDE SYSLIB  (IGTXAPES)                                       */ 06071000
*/*%INCLUDE SYSUT5  (BSAWA   )                                       */ 06072000
*/*%INCLUDE SYSUT5  (INITSTAE)                                       */ 06073000
*/*%INCLUDE SYSUT5  (SAVEAPRL)                                       */ 06074000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06075000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06076000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06077000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06078000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06079000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06080000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06081000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06082000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06083000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06084000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06085000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06086000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06087000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06088000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06089000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06090000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06091000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06092000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06093000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06094000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06095000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06096000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06097000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06098000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06099000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06100000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06101000
*/*%INCLUDE SYSUT5  (DOSTAE  )                                       */ 06102000
*/*%INCLUDE SYSUT5  (TBLDAPIO)                                       */ 06103000
*/*%INCLUDE SYSUT5  (IDAPIO  )                                       */ 06104000
*/*%INCLUDE SYSUT5  (SAVECCWS)                                       */ 06105000
*/*%INCLUDE SYSUT5  (VALPGM  )                                       */ 06106000
*/*%INCLUDE SYSUT5  (TGETSTOR)                                       */ 06107000
*/*%INCLUDE SYSUT5  (XLTEPGM )                                       */ 06108000
*/*%INCLUDE SYSUT5  (DEBCHK  )                                       */ 06109000
*/*%INCLUDE SYSUT5  (GETAPDX )                                       */ 06110000
*/*%INCLUDE SYSUT5  (PGETSTOR)                                       */ 06111000
*/*%INCLUDE SYSUT5  (COPYBLKS)                                       */ 06112000
*/*%INCLUDE SYSUT5  (ISSUEFIX)                                       */ 06113000
*/*%INCLUDE SYSUT5  (GETAPIO )                                       */ 06114000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06115000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06116000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06117000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06118000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06119000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06120000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06121000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06122000
*/*%INCLUDE SYSUT5  (CLRREGS )                                       */ 06123000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06124000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06125000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06126000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06127000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06128000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06129000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06130000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06131000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06132000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06133000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06134000
*/*%INCLUDE SYSUT5  (CLRSTAE )                                       */ 06135000
*/*%INCLUDE SYSUT5  (SETSMF  )                                       */ 06136000
*/*%INCLUDE SYSUT5  (RESTAPRL)                                       */ 06137000
*/*%INCLUDE SYSUT5  (RECOVER )                                       */ 06138000
*/*%INCLUDE SYSUT5  (SUBRTNS )                                       */ 06139000
*/*%INCLUDE SYSUT5  (REFSTOR )                                       */ 06140000
*/*%INCLUDE SYSUT5  (ADDVSL  )                                       */ 06141000
*/*%INCLUDE SYSUT5  (SORTVSL )                                       */ 06142000
*/*%INCLUDE SYSUT5  (ADDIDAL )                                       */ 06143000
*/*%INCLUDE SYSUT5  (ADDAPXL )                                       */ 06144000
*/*%INCLUDE SYSUT5  (CHKOLAP )                                       */ 06145000
*/*%INCLUDE SYSUT5  (SETAPRL )                                       */ 06146000
*/*%INCLUDE SYSUT5  (GETLLCK )                                       */ 06147000
*/*%INCLUDE SYSUT5  (FREELLCK)                                       */ 06148000
*/*%INCLUDE SYSUT5  (GETXLCK )                                       */ 06149000
*/*%INCLUDE SYSUT5  (FREEXLCK)                                       */ 06150000
*/*%INCLUDE SYSUT5  (FIXAPIO )                                       */ 06151000
*                                                               01S1855 06152000
*       ;                                                       01S1855 06153000
@EL00001 DS    0H                                               01S1855 06154000
@EF00001 DS    0H                                               01S1855 06155000
@ER00001 BR    @14                                              01S1855 06156000
@DATA    DS    0H                                                       06157000
@CH01949 DC    H'18'                                                    06158000
@CH02030 DC    H'33'                                                    06159000
@CH02060 DC    H'49'                                                    06160000
@CH04216 DC    H'200'                                                   06161000
@CH04217 DC    H'240'                                                   06162000
@CH04000 DC    H'-1'                                                    06163000
@DATD    DSECT                                                          06164000
         DS    0F                                                       06165000
@SA00005 DS    14F                                                      06166000
@SA00013 DS    15F                                                      06167000
IGTKCA   CSECT                                                          06168000
         DS    0F                                                       06169000
@CF00068 DC    F'1'                                                     06170000
@CH00068 EQU   @CF00068+2                                               06171000
@CF00073 DC    F'3'                                                     06172000
@CF00045 DC    F'4'                                                     06173000
@CF00037 DC    F'8'                                                     06174000
@CF01711 DC    F'20'                                                    06175000
@CF00090 DC    F'24'                                                    06176000
@CF01967 DC    F'28'                                                    06177000
@CF00043 DC    F'31'                                                    06178000
@CF00126 DC    F'32'                                                    06179000
@CF01907 DC    F'80'                                                    06180000
@CF03134 DC    F'424'                                                   06181000
@CH03134 EQU   @CF03134+2                                               06182000
@CF03931 DC    F'4095'                                                  06183000
@CF03922 DC    F'4096'                                                  06184000
@CF03933 DC    F'20480'                                                 06185000
@CF04211 DC    F'45056'                                                 06186000
@CF04212 DC    F'-436207616'                                            06187000
@CF03927 DC    XL4'00FFF800'                                            06188000
@CF03929 DC    XL4'00FFF000'                                            06189000
@CF03963 DC    XL4'0000FFF8'                                            06190000
@CF03994 DC    XL4'00000007'                                            06191000
@CF04005 DC    XL4'00006E00'                                            06192000
@CF04017 DC    XL4'FFFFFFF8'                                            06193000
@CF04034 DC    XL4'42000000'                                            06194000
@CF04035 DC    XL4'80000000'                                            06195000
@CF04092 DC    XL4'20000000'                                            06196000
@CF04115 DC    XL4'FFFFFFFC'                                            06197000
@CF04153 DC    XL4'FFFFF800'                                            06198000
@CF04154 DC    XL4'000000F8'                                            06199000
@CF04247 DC    XL4'0000FFFF'                                            06200000
@CF04003 DC    XL4'0003'                                                06201000
@DATD    DSECT                                                          06202000
         DS    0D                                                       06203000
DECB     DS    F                                                        06204000
DAPRLPTR DS    A                                                        06205000
DAPDXPTR DS    A                                                        06206000
DAPIOPTR DS    A                                                        06207000
DAPIOCT0 DS    F                                                        06208000
DEXTVSL  DS    F                                                        06209000
DAPRLXPT DS    A                                                        06210000
DFXAPIO  DS    CL80                                                     06211000
         ORG   DFXAPIO                                                  06212000
QVPL     DS    CL40                                                     06213000
         ORG   QVPL                                                     06214000
QVPLTYP3 DS    CL40                                                     06215000
         ORG   QVPLTYP3                                                 06216000
QVPLTYP2 DS    CL33                                                     06217000
         ORG   QVPLTYP2                                                 06218000
QVPLTYP1 DS    CL28                                                     06219000
         ORG   QVPLTYP1                                                 06220000
QVPLEVR  DS    AL4                                                      06221000
QVPLODA  DS    AL4                                                      06222000
QVPLWKA  DS    AL4                                                      06223000
QVPLNOEL DS    AL4                                                      06224000
QVPLHDR  DS    AL4                                                      06225000
QVPLHF   DS    CL4                                                      06226000
         ORG   QVPLHF                                                   06227000
QVPLFLGH DS    CL1                                                      06228000
         ORG   QVPLFLGH                                                 06229000
QVPLHD3  DS    BL1                                                      06230000
QVPLRES1 EQU   QVPLFLGH+0                                               06231000
         ORG   QVPLHF+1                                                 06232000
QVPLFLGF DS    CL1                                                      06233000
         ORG   QVPLFLGF                                                 06234000
QVPLFP3  DS    BL1                                                      06235000
QVPLRES2 EQU   QVPLFLGF+0                                               06236000
         ORG   QVPLHF+2                                                 06237000
QVPLFPTR DS    FL2                                                      06238000
         ORG   QVPLTYP1+24                                              06239000
QVPLLELM DS    AL4                                                      06240000
         ORG   QVPLTYP2+28                                              06241000
QVPLTRLR DS    AL4                                                      06242000
QVPLTB   DS    CL4                                                      06243000
         ORG   QVPLTB                                                   06244000
QVPLFLGT DS    CL1                                                      06245000
         ORG   QVPLFLGT                                                 06246000
QVPLTR3  DS    BL1                                                      06247000
QVPLRES3 EQU   QVPLFLGT+0                                               06248000
         ORG   QVPLTB+1                                                 06249000
QVPLFLGB DS    CL1                                                      06250000
         ORG   QVPLFLGB                                                 06251000
QVPLBP3  DS    BL1                                                      06252000
QVPLRES4 EQU   QVPLFLGB+0                                               06253000
         ORG   QVPLTB+2                                                 06254000
QVPLBPTR DS    FL2                                                      06255000
         ORG   QVPLTYP2+36                                              06256000
QVPLFELM DS    AL4                                                      06257000
         ORG   DFXAPIO+40                                               06258000
DFXAPIOW DS    CL40                                                     06259000
         ORG   DFXAPIO+80                                               06260000
         DS    CL4                                                      06261000
APES     DS    CL648                                                    06262000
         ORG   APES                                                     06263000
APESID   DS    CL4                                                      06264000
APESUSER DS    FL4                                                      06265000
APESADDR DS    AL4                                                      06266000
APESAPMV DS    AL4                                                      06267000
APESFLGS DS    BL2                                                      06268000
         ORG   APESFLGS                                                 06269000
APESFLG0 DS    BL1                                                      06270000
         ORG   APESFLG0                                                 06271000
APESFDMP DS    BL1                                                      06272000
APESFREC EQU   APESFLG0+0                                               06273000
APESFSDP EQU   APESFLG0+0                                               06274000
@NM00367 EQU   APESFLG0+0                                               06275000
APESFRTY EQU   APESFLG0+0                                               06276000
APESFEXR EQU   APESFLG0+0                                               06277000
@NM00368 EQU   APESFLG0+0                                               06278000
         ORG   APESFLGS+1                                               06279000
APESFLG1 DS    BL1                                                      06280000
         ORG   APESFLG1                                                 06281000
APESFFRR DS    BL1                                                      06282000
APESFPRV EQU   APESFLG1+0                                               06283000
APESFLLK EQU   APESFLG1+0                                               06284000
APESFXLK EQU   APESFLG1+0                                               06285000
APESFGM  EQU   APESFLG1+0                                               06286000
APESFSDI EQU   APESFLG1+0                                               06287000
APESFSTE EQU   APESFLG1+0                                               06288000
APESUPSC EQU   APESFLG1+0                                               06289000
         ORG   APES+18                                                  06290000
APESSUID DS    BL1                                                      06291000
         ORG   APESSUID                                                 06292000
APESSU33 DS    BL1                                                      06293000
@NM00369 EQU   APESSUID+0                                               06294000
         ORG   APES+19                                                  06295000
APESCODE DS    FL1                                                      06296000
APESCOD1 DS    FL1                                                      06297000
APESCNTR DS    FL1                                                      06298000
APESMXCD DS    FL1                                                      06299000
@NM00370 DS    FL1                                                      06300000
@NM00371 DS    AL4                                                      06301000
@NM00372 DS    AL4                                                      06302000
@NM00373 DS    AL4                                                      06303000
APESEXRA DS    AL4                                                      06304000
APESR14S DS    AL4                                                      06305000
APESREGP DS    AL4                                                      06306000
APESREGZ DS    CL64                                                     06307000
APESMOD  DS    CL8                                                      06308000
APESPROC DS    CL8                                                      06309000
APESFRR  DS    CL8                                                      06310000
APESSDWA DS    CL512                                                    06311000
         ORG   APES+648                                                 06312000
@NM00376 DS    CL112                                                    06313000
         ORG   @NM00376                                                 06314000
DCCWBLK  DS    CL28                                                     06315000
         ORG   DCCWBLK                                                  06316000
DCCWBEG  DS    AL4                                                      06317000
DCCWEND  DS    AL4                                                      06318000
@NM00377 DS    AL4                                                      06319000
DCCWSZ   DS    FL4                                                      06320000
DCCWCT   DS    FL4                                                      06321000
DCCWACT  DS    AL4                                                      06322000
DCCWDIF  DS    FL4                                                      06323000
         ORG   @NM00376+28                                              06324000
DIDALBLK DS    CL28                                                     06325000
         ORG   DIDALBLK                                                 06326000
DIDALBEG DS    AL4                                                      06327000
DIDALEND DS    AL4                                                      06328000
DIDALCUR DS    AL4                                                      06329000
DIDALSZ  DS    FL4                                                      06330000
DIDALCT  DS    FL4                                                      06331000
DIDALACT DS    AL4                                                      06332000
DIDALDIF DS    FL4                                                      06333000
         ORG   @NM00376+56                                              06334000
DAPXLBLK DS    CL28                                                     06335000
         ORG   DAPXLBLK                                                 06336000
DAPXLBEG DS    AL4                                                      06337000
DAPXLEND DS    AL4                                                      06338000
DAPXLCUR DS    AL4                                                      06339000
DAPXLSZ  DS    FL4                                                      06340000
DAPXLCT  DS    FL4                                                      06341000
DAPXLACT DS    AL4                                                      06342000
DAPXLDIF DS    FL4                                                      06343000
         ORG   @NM00376+84                                              06344000
DVSLBLK  DS    CL28                                                     06345000
         ORG   DVSLBLK                                                  06346000
DVSLBEG  DS    AL4                                                      06347000
DVSLEND  DS    AL4                                                      06348000
DVSLCUR  DS    AL4                                                      06349000
DVSLSZ   DS    FL4                                                      06350000
DVSLCT   DS    FL4                                                      06351000
DVSLACT  DS    AL4                                                      06352000
DVSLDIF  DS    FL4                                                      06353000
         ORG   @NM00376+112                                             06354000
DOPTYPE  DS    BL1                                                      06355000
         ORG   DOPTYPE                                                  06356000
DOPREAD  DS    BL1                                                      06357000
DOPWRITE EQU   DOPTYPE+0                                                06358000
DOPPROC  EQU   DOPTYPE+0                                                06359000
DOPNOP   EQU   DOPTYPE+0                                                06360000
@NM00378 EQU   DOPTYPE+0                                                06361000
         ORG   DOPTYPE+1                                                06362000
DRCSWS   DS    CL2                                                      06363000
         ORG   DRCSWS                                                   06364000
DRCSW0   DS    BL1                                                      06365000
         ORG   DRCSW0                                                   06366000
@NM00379 DS    BL1                                                      06367000
DRCGM2   EQU   DRCSW0+0                                                 06368000
DRCGM3   EQU   DRCSW0+0                                                 06369000
DRCIO1   EQU   DRCSW0+0                                                 06370000
DRCPF1   EQU   DRCSW0+0                                                 06371000
DRCPF2   EQU   DRCSW0+0                                                 06372000
@NM00380 EQU   DRCSW0+0                                                 06373000
@NM00381 EQU   DRCSW0+0                                                 06374000
         ORG   DRCSWS+1                                                 06375000
DRCSW1   DS    BL1                                                      06376000
         ORG   DRCSW1                                                   06377000
@NM00382 DS    BL1                                                      06378000
@NM00383 EQU   DRCSW1+0                                                 06379000
@NM00384 EQU   DRCSW1+0                                                 06380000
@NM00385 EQU   DRCSW1+0                                                 06381000
@NM00386 EQU   DRCSW1+0                                                 06382000
@NM00387 EQU   DRCSW1+0                                                 06383000
@NM00388 EQU   DRCSW1+0                                                 06384000
@NM00389 EQU   DRCSW1+0                                                 06385000
         ORG   DRCSWS+2                                                 06386000
DSWS     DS    CL1                                                      06387000
         ORG   DSWS                                                     06388000
DSW0     DS    BL1                                                      06389000
         ORG   DSW0                                                     06390000
DSW0FCCW DS    BL1                                                      06391000
@NM00390 EQU   DSW0+0                                                   06392000
@NM00391 EQU   DSW0+0                                                   06393000
@NM00392 EQU   DSW0+0                                                   06394000
@NM00393 EQU   DSW0+0                                                   06395000
@NM00394 EQU   DSW0+0                                                   06396000
@NM00395 EQU   DSW0+0                                                   06397000
@NM00396 EQU   DSW0+0                                                   06398000
         ORG   DSWS+1                                                   06399000
         DS    CL4                                                      06400000
DPROCDTA DS    CL8                                                      06401000
DAPIO    DS    CL424                                                    06402000
DAPGF    DS    CL16                                                     06403000
DAPRL    DS    CL80                                                     06404000
DSUPVSVE DS    CL64                                                     06405000
DUSERKEY DS    CL1                                                      06406000
         DS    CL3                                                      06407000
DRETRY   DS    10A                                                      06408000
IGTKCA   CSECT                                                          06409000
         DS    0F                                                       06410000
@SIZDATD DC    AL1(0)                                                   06411000
         DC    AL3(@ENDDATD-@DATD)                                      06412000
         DS    0D                                                       06413000
@CC03972 DC    C'IGTKCA  '                                              06414000
@CC03973 DC    C'        '                                              06415000
@CC01912 DC    C'APRL'                                                  06416000
@CC03144 DC    C'APIO'                                                  06417000
@CC03436 DC    C'APXL'                                                  06418000
@CC03810 DC    C'APES'                                                  06419000
@CC03986 DC    C'SRB '                                                  06420000
@CB01727 DC    X'00'                                                    06421000
@CB04253 DC    B'000000000000000000000000001000000000000000000000000000C06422000
               00'                                                      06423000
CMBRXZZZ DS    CL264                                                    06424000
         ORG   CMBRXZZZ                                                 06425000
@NM00167 DS    CL8                                                      06426000
         ORG   @NM00167                                                 06427000
@NM00168 DC    H'33'                                                    06428000
@NM00169 DC    H'60'                                                    06429000
@NM00170 DC    AL1(0)                                                   06430000
@NM00171 DC    AL1(8)                                                   06431000
@NM00172 DC    H'31'                                                    06432000
         ORG   CMBRXZZZ+8                                               06433000
@NM00173 DS    CL8                                                      06434000
         ORG   @NM00173                                                 06435000
@NM00174 DC    H'35'                                                    06436000
@NM00175 DC    H'52'                                                    06437000
@NM00176 DC    AL1(0)                                                   06438000
@NM00177 DC    AL1(4)                                                   06439000
@NM00178 DC    H'32'                                                    06440000
         ORG   CMBRXZZZ+16                                              06441000
@NM00179 DS    CL8                                                      06442000
         ORG   @NM00179                                                 06443000
@NM00180 DC    H'35'                                                    06444000
@NM00181 DC    H'61'                                                    06445000
@NM00182 DC    AL1(0)                                                   06446000
@NM00183 DC    AL1(4)                                                   06447000
@NM00184 DC    H'33'                                                    06448000
         ORG   CMBRXZZZ+24                                              06449000
@NM00185 DS    CL8                                                      06450000
         ORG   @NM00185                                                 06451000
@NM00186 DC    H'39'                                                    06452000
@NM00187 DC    H'61'                                                    06453000
@NM00188 DC    AL1(0)                                                   06454000
@NM00189 DC    AL1(8)                                                   06455000
@NM00190 DC    H'34'                                                    06456000
         ORG   CMBRXZZZ+32                                              06457000
@NM00191 DS    CL8                                                      06458000
         ORG   @NM00191                                                 06459000
@NM00192 DC    H'21'                                                    06460000
@NM00193 DC    H'61'                                                    06461000
@NM00194 DC    AL1(0)                                                   06462000
@NM00195 DC    AL1(8)                                                   06463000
@NM00196 DC    H'35'                                                    06464000
         ORG   CMBRXZZZ+40                                              06465000
@NM00197 DS    CL8                                                      06466000
         ORG   @NM00197                                                 06467000
@NM00198 DC    H'21'                                                    06468000
@NM00199 DC    H'61'                                                    06469000
@NM00200 DC    AL1(0)                                                   06470000
@NM00201 DC    AL1(4)                                                   06471000
@NM00202 DC    H'36'                                                    06472000
         ORG   CMBRXZZZ+48                                              06473000
@NM00203 DS    CL8                                                      06474000
         ORG   @NM00203                                                 06475000
@NM00204 DC    H'21'                                                    06476000
@NM00205 DC    H'61'                                                    06477000
@NM00206 DC    AL1(0)                                                   06478000
@NM00207 DC    AL1(4)                                                   06479000
@NM00208 DC    H'37'                                                    06480000
         ORG   CMBRXZZZ+56                                              06481000
@NM00209 DS    CL8                                                      06482000
         ORG   @NM00209                                                 06483000
@NM00210 DC    H'21'                                                    06484000
@NM00211 DC    H'61'                                                    06485000
@NM00212 DC    AL1(0)                                                   06486000
@NM00213 DC    AL1(4)                                                   06487000
@NM00214 DC    H'38'                                                    06488000
         ORG   CMBRXZZZ+64                                              06489000
@NM00215 DS    CL8                                                      06490000
         ORG   @NM00215                                                 06491000
@NM00216 DC    H'21'                                                    06492000
@NM00217 DC    H'61'                                                    06493000
@NM00218 DC    AL1(0)                                                   06494000
@NM00219 DC    AL1(4)                                                   06495000
@NM00220 DC    H'39'                                                    06496000
         ORG   CMBRXZZZ+72                                              06497000
@NM00221 DS    CL8                                                      06498000
         ORG   @NM00221                                                 06499000
@NM00222 DC    H'21'                                                    06500000
@NM00223 DC    H'61'                                                    06501000
@NM00224 DC    AL1(0)                                                   06502000
@NM00225 DC    AL1(4)                                                   06503000
@NM00226 DC    H'40'                                                    06504000
         ORG   CMBRXZZZ+80                                              06505000
@NM00227 DS    CL8                                                      06506000
         ORG   @NM00227                                                 06507000
@NM00228 DC    H'21'                                                    06508000
@NM00229 DC    H'61'                                                    06509000
@NM00230 DC    AL1(0)                                                   06510000
@NM00231 DC    AL1(8)                                                   06511000
@NM00232 DC    H'41'                                                    06512000
         ORG   CMBRXZZZ+88                                              06513000
@NM00233 DS    CL8                                                      06514000
         ORG   @NM00233                                                 06515000
@NM00234 DC    H'39'                                                    06516000
@NM00235 DC    H'63'                                                    06517000
@NM00236 DC    AL1(0)                                                   06518000
@NM00237 DC    AL1(8)                                                   06519000
@NM00238 DC    H'42'                                                    06520000
         ORG   CMBRXZZZ+96                                              06521000
@NM00239 DS    CL8                                                      06522000
         ORG   @NM00239                                                 06523000
@NM00240 DC    H'39'                                                    06524000
@NM00241 DC    H'66'                                                    06525000
@NM00242 DC    AL1(0)                                                   06526000
@NM00243 DC    AL1(8)                                                   06527000
@NM00244 DC    H'43'                                                    06528000
         ORG   CMBRXZZZ+104                                             06529000
@NM00245 DS    CL8                                                      06530000
         ORG   @NM00245                                                 06531000
@NM00246 DC    H'26'                                                    06532000
@NM00247 DC    H'61'                                                    06533000
@NM00248 DC    AL1(0)                                                   06534000
@NM00249 DC    AL1(4)                                                   06535000
@NM00250 DC    H'44'                                                    06536000
         ORG   CMBRXZZZ+112                                             06537000
@NM00251 DS    CL8                                                      06538000
         ORG   @NM00251                                                 06539000
@NM00252 DC    H'33'                                                    06540000
@NM00253 DC    H'57'                                                    06541000
@NM00254 DC    AL1(0)                                                   06542000
@NM00255 DC    AL1(8)                                                   06543000
@NM00256 DC    H'45'                                                    06544000
         ORG   CMBRXZZZ+120                                             06545000
@NM00257 DS    CL8                                                      06546000
         ORG   @NM00257                                                 06547000
@NM00258 DC    H'33'                                                    06548000
@NM00259 DC    H'54'                                                    06549000
@NM00260 DC    AL1(0)                                                   06550000
@NM00261 DC    AL1(8)                                                   06551000
@NM00262 DC    H'46'                                                    06552000
         ORG   CMBRXZZZ+128                                             06553000
@NM00263 DS    CL8                                                      06554000
         ORG   @NM00263                                                 06555000
@NM00264 DC    H'18'                                                    06556000
@NM00265 DC    H'62'                                                    06557000
@NM00266 DC    AL1(0)                                                   06558000
@NM00267 DC    AL1(8)                                                   06559000
@NM00268 DC    H'47'                                                    06560000
         ORG   CMBRXZZZ+136                                             06561000
@NM00269 DS    CL8                                                      06562000
         ORG   @NM00269                                                 06563000
@NM00270 DC    H'39'                                                    06564000
@NM00271 DC    H'64'                                                    06565000
@NM00272 DC    AL1(0)                                                   06566000
@NM00273 DC    AL1(8)                                                   06567000
@NM00274 DC    H'48'                                                    06568000
         ORG   CMBRXZZZ+144                                             06569000
@NM00275 DS    CL8                                                      06570000
         ORG   @NM00275                                                 06571000
@NM00276 DC    H'21'                                                    06572000
@NM00277 DC    H'61'                                                    06573000
@NM00278 DC    AL1(0)                                                   06574000
@NM00279 DC    AL1(4)                                                   06575000
@NM00280 DC    H'49'                                                    06576000
         ORG   CMBRXZZZ+152                                             06577000
@NM00281 DS    CL8                                                      06578000
         ORG   @NM00281                                                 06579000
@NM00282 DC    H'18'                                                    06580000
@NM00283 DC    H'49'                                                    06581000
@NM00284 DC    AL1(0)                                                   06582000
@NM00285 DC    AL1(8)                                                   06583000
@NM00286 DC    H'50'                                                    06584000
         ORG   CMBRXZZZ+160                                             06585000
@NM00287 DS    CL8                                                      06586000
         ORG   @NM00287                                                 06587000
@NM00288 DC    H'21'                                                    06588000
@NM00289 DC    H'61'                                                    06589000
@NM00290 DC    AL1(0)                                                   06590000
@NM00291 DC    AL1(4)                                                   06591000
@NM00292 DC    H'51'                                                    06592000
         ORG   CMBRXZZZ+168                                             06593000
@NM00293 DS    CL8                                                      06594000
         ORG   @NM00293                                                 06595000
@NM00294 DC    H'33'                                                    06596000
@NM00295 DC    H'56'                                                    06597000
@NM00296 DC    AL1(0)                                                   06598000
@NM00297 DC    AL1(8)                                                   06599000
@NM00298 DC    H'52'                                                    06600000
         ORG   CMBRXZZZ+176                                             06601000
@NM00299 DS    CL8                                                      06602000
         ORG   @NM00299                                                 06603000
@NM00300 DC    H'33'                                                    06604000
@NM00301 DC    H'53'                                                    06605000
@NM00302 DC    AL1(0)                                                   06606000
@NM00303 DC    AL1(8)                                                   06607000
@NM00304 DC    H'53'                                                    06608000
         ORG   CMBRXZZZ+184                                             06609000
@NM00305 DS    CL8                                                      06610000
         ORG   @NM00305                                                 06611000
@NM00306 DC    H'33'                                                    06612000
@NM00307 DC    H'56'                                                    06613000
@NM00308 DC    AL1(0)                                                   06614000
@NM00309 DC    AL1(8)                                                   06615000
@NM00310 DC    H'54'                                                    06616000
         ORG   CMBRXZZZ+192                                             06617000
@NM00311 DS    CL8                                                      06618000
         ORG   @NM00311                                                 06619000
@NM00312 DC    H'39'                                                    06620000
@NM00313 DC    H'0'                                                     06621000
@NM00314 DC    AL1(0)                                                   06622000
@NM00315 DC    AL1(8)                                                   06623000
@NM00316 DC    H'55'                                                    06624000
         ORG   CMBRXZZZ+200                                             06625000
@NM00317 DS    CL8                                                      06626000
         ORG   @NM00317                                                 06627000
@NM00318 DC    H'34'                                                    06628000
@NM00319 DC    H'0'                                                     06629000
@NM00320 DC    AL1(0)                                                   06630000
@NM00321 DC    AL1(8)                                                   06631000
@NM00322 DC    H'56'                                                    06632000
         ORG   CMBRXZZZ+208                                             06633000
@NM00323 DS    CL8                                                      06634000
         ORG   @NM00323                                                 06635000
@NM00324 DC    H'21'                                                    06636000
@NM00325 DC    H'45'                                                    06637000
@NM00326 DC    AL1(0)                                                   06638000
@NM00327 DC    AL1(4)                                                   06639000
@NM00328 DC    H'57'                                                    06640000
         ORG   CMBRXZZZ+216                                             06641000
@NM00329 DS    CL8                                                      06642000
         ORG   @NM00329                                                 06643000
@NM00330 DC    H'33'                                                    06644000
@NM00331 DC    H'56'                                                    06645000
@NM00332 DC    AL1(0)                                                   06646000
@NM00333 DC    AL1(8)                                                   06647000
@NM00334 DC    H'58'                                                    06648000
         ORG   CMBRXZZZ+224                                             06649000
@NM00335 DS    CL8                                                      06650000
         ORG   @NM00335                                                 06651000
@NM00336 DC    H'33'                                                    06652000
@NM00337 DC    H'56'                                                    06653000
@NM00338 DC    AL1(0)                                                   06654000
@NM00339 DC    AL1(8)                                                   06655000
@NM00340 DC    H'59'                                                    06656000
         ORG   CMBRXZZZ+232                                             06657000
@NM00341 DS    CL8                                                      06658000
         ORG   @NM00341                                                 06659000
@NM00342 DC    H'33'                                                    06660000
@NM00343 DC    H'59'                                                    06661000
@NM00344 DC    AL1(0)                                                   06662000
@NM00345 DC    AL1(8)                                                   06663000
@NM00346 DC    H'60'                                                    06664000
         ORG   CMBRXZZZ+240                                             06665000
@NM00347 DS    CL8                                                      06666000
         ORG   @NM00347                                                 06667000
@NM00348 DC    H'39'                                                    06668000
@NM00349 DC    H'67'                                                    06669000
@NM00350 DC    AL1(0)                                                   06670000
@NM00351 DC    AL1(8)                                                   06671000
@NM00352 DC    H'61'                                                    06672000
         ORG   CMBRXZZZ+248                                             06673000
@NM00353 DS    CL8                                                      06674000
         ORG   @NM00353                                                 06675000
@NM00354 DC    H'35'                                                    06676000
@NM00355 DC    H'68'                                                    06677000
@NM00356 DC    AL1(0)                                                   06678000
@NM00357 DC    AL1(4)                                                   06679000
@NM00358 DC    H'62'                                                    06680000
         ORG   CMBRXZZZ+256                                             06681000
@NM00359 DS    CL8                                                      06682000
         ORG   @NM00359                                                 06683000
@NM00360 DC    H'36'                                                    06684000
@NM00361 DC    H'0'                                                     06685000
@NM00362 DC    AL1(0)                                                   06686000
@NM00363 DC    AL1(8)                                                   06687000
@NM00364 DC    H'79'                                                    06688000
         ORG   CMBRXZZZ+264                                             06689000
@DATD    DSECT                                                          06690000
DXSTAE1  IGTYSTAE MF=L                 LIST FORMAT OF THE MACRO         06691000
DXSTAE   EQU   DXSTAE1,*-DXSTAE1,C'C'  MAKE DXSTAE START AT ESTAE      *06692000
                                       MACRO & COVER ENTIRE EXPANSION   06693000
IGTKCA   CSECT                                                          06694000
CXSTAE1  IGTYSTAE ,                    EXIT ROUTINE                    *06695000
               PURGE=NONE,             NO I/O PURGE                    *06696000
               ASYNCH=NO,              NO ASYNCHRONOUS EXITS           *06697000
               TERM=YES,               ALWAYS GAIN CONTROL             *06698000
               MF=L                    LIST FORMAT OF THE MACRO         06699000
CXSTAE   EQU   CXSTAE1,*-CXSTAE1,C'C'  MAKE CXSTAE START AT ESTAE      *06700000
                                       MACRO & COVER ENTIRE EXPANSION   06701000
@DATD    DSECT                                                          06702000
*                                     /*                                06703000
CSPWORK  EQU   230                   WORKAREA SUBPOOL                   06704000
IGTKCA   CSECT                                                          06705000
*                                   /* GENERATE PATCH                   06706000
         IGTXZAP ,                 GENERATE PATCH AREA                  06707000
@DATD    DSECT                                                          06708000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06709000
@ENDDATD EQU   *                                                        06710000
IGTKCA   CSECT                                                          06711000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06712000
@01      EQU   01                                                       06713000
@02      EQU   02                                                       06714000
@03      EQU   03                                                       06715000
@04      EQU   04                                                       06716000
@05      EQU   05                                                       06717000
@06      EQU   06                                                       06718000
@07      EQU   07                                                       06719000
@08      EQU   08                                                       06720000
@09      EQU   09                                                       06721000
@10      EQU   10                                                       06722000
@11      EQU   11                                                       06723000
@12      EQU   12                                                       06724000
@13      EQU   13                                                       06725000
@14      EQU   14                                                       06726000
@15      EQU   15                                                       06727000
DAPMFCT3 EQU   @04                                                      06728000
DAPMFCT2 EQU   @03                                                      06729000
DAPMFCT1 EQU   @02                                                      06730000
DAPMFCT0 EQU   @10                                                      06731000
DEXTAPXL EQU   @04                                                      06732000
DXXXXPTR EQU   @02                                                      06733000
DIDALCT2 EQU   @03                                                      06734000
DIDALCT1 EQU   @03                                                      06735000
DIDALCT0 EQU   @02                                                      06736000
DDEBPTR  EQU   @09                                                      06737000
APCODE   EQU   @07                                                      06738000
APCODE1  EQU   @08                                                      06739000
FRRSPTR  EQU   @00                                                      06740000
FRREPTR  EQU   @00                                                      06741000
DEBPTR   EQU   @00                                                      06742000
DEBDAPTR EQU   @00                                                      06743000
DEBEXPTR EQU   @00                                                      06744000
DEBSBPTR EQU   @00                                                      06745000
IOSBPTR  EQU   @00                                                      06746000
SRBPTR   EQU   @00                                                      06747000
VSLPTR   EQU   @00                                                      06748000
APCTPTR  EQU   @12                                                      06749000
APSVPTR  EQU   @13                                                      06750000
DCCWCUR  EQU   @05                                                      06751000
RDEBPTR  EQU   @02                                                      06752000
RAPDXPTR EQU   @11                                                      06753000
RAPRLPTR EQU   @05                                                      06754000
R1P      EQU   @01                                                      06755000
RLV      EQU   @03                                                      06756000
RADDR    EQU   @04                                                      06757000
R15F     EQU   @15                                                      06758000
R0F      EQU   @00                                                      06759000
APDATA   EQU   @06                                                      06760000
R0P      EQU   @00                                                      06761000
R1F      EQU   @01                                                      06762000
R14P     EQU   @14                                                      06763000
R15P     EQU   @15                                                      06764000
RIGTUKA  EQU   @02                                                      06765000
R14F     EQU   @14                                                      06766000
GPR01F   EQU   @01                                                      06767000
RAPIOPTR EQU   @03                                                      06768000
GPR00F   EQU   @00                                                      06769000
R10F     EQU   @10                                                      06770000
R11F     EQU   @11                                                      06771000
R10P     EQU   @10                                                      06772000
R11P     EQU   @11                                                      06773000
R2P      EQU   @02                                                      06774000
R3P      EQU   @03                                                      06775000
R4P      EQU   @04                                                      06776000
RVSLPTR  EQU   @03                                                      06777000
R0RSTD   EQU   @00                                                      06778000
R1RSTD   EQU   @01                                                      06779000
R2RSTD   EQU   @02                                                      06780000
R3RSTD   EQU   @03                                                      06781000
R4RSTD   EQU   @04                                                      06782000
R5RSTD   EQU   @05                                                      06783000
R8RSTD   EQU   @08                                                      06784000
R9RSTD   EQU   @09                                                      06785000
R10RSTD  EQU   @10                                                      06786000
R11RSTD  EQU   @11                                                      06787000
R14RSTD  EQU   @14                                                      06788000
R15RSTD  EQU   @15                                                      06789000
RERRCODE EQU   @03                                                      06790000
GPR01P   EQU   @01                                                      06791000
R13F     EQU   @13                                                      06792000
R12F     EQU   @12                                                      06793000
R8P      EQU   @08                                                      06794000
R9P      EQU   @09                                                      06795000
R12P     EQU   @12                                                      06796000
R13P     EQU   @13                                                      06797000
APACBPTR EQU   @09                                                      06798000
APATPTR  EQU   @11                                                      06799000
APAXPTR  EQU   @10                                                      06800000
APCIPTR  EQU   @08                                                      06801000
APCPPTR  EQU   @10                                                      06802000
APCQPTR  EQU   @09                                                      06803000
APCWPTR  EQU   @08                                                      06804000
APDEBPTR EQU   @08                                                      06805000
APDSPTR  EQU   @11                                                      06806000
APDXPTR  EQU   @11                                                      06807000
APENTRY  EQU   @15                                                      06808000
APERPTR  EQU   @08                                                      06809000
APEXLPTR EQU   @10                                                      06810000
APINPTR  EQU   @01                                                      06811000
APIOPTR  EQU   @10                                                      06812000
APLBPTR  EQU   @11                                                      06813000
APNPPTR  EQU   @08                                                      06814000
APOCPTR  EQU   @10                                                      06815000
APOTPTR  EQU   @09                                                      06816000
APRCODE  EQU   @15                                                      06817000
APRETURN EQU   @14                                                      06818000
APRLPTR  EQU   @08                                                      06819000
APSCPTR  EQU   @01                                                      06820000
APSMPTR  EQU   @01                                                      06821000
APUBPTR  EQU   @10                                                      06822000
APUTPTR  EQU   @11                                                      06823000
APXLPTR  EQU   @11                                                      06824000
RAPESPTR EQU   @03                                                      06825000
R12RSTD  EQU   @12                                                      06826000
R13RSTD  EQU   @13                                                      06827000
R2F      EQU   @02                                                      06828000
R3F      EQU   @03                                                      06829000
R4F      EQU   @04                                                      06830000
R5F      EQU   @05                                                      06831000
R5P      EQU   @05                                                      06832000
R6F      EQU   @06                                                      06833000
R6P      EQU   @06                                                      06834000
R6RSTD   EQU   @06                                                      06835000
R7F      EQU   @07                                                      06836000
R7P      EQU   @07                                                      06837000
R7RSTD   EQU   @07                                                      06838000
R8F      EQU   @08                                                      06839000
R9F      EQU   @09                                                      06840000
PSA      EQU   0                                                        06841000
FLCRNPSW EQU   PSA                                                      06842000
FLCROPSW EQU   PSA+8                                                    06843000
FLCICCW2 EQU   PSA+16                                                   06844000
FLCCVT   EQU   FLCICCW2                                                 06845000
PSAEEPSW EQU   PSA+132                                                  06846000
PSAESPSW EQU   PSA+136                                                  06847000
FLCSVILC EQU   PSAESPSW+1                                               06848000
PSAEPPSW EQU   PSA+140                                                  06849000
FLCPIILC EQU   PSAEPPSW+1                                               06850000
FLCPICOD EQU   PSAEPPSW+2                                               06851000
PSAPICOD EQU   FLCPICOD+1                                               06852000
FLCTEA   EQU   PSAEPPSW+4                                               06853000
FLCPER   EQU   PSA+152                                                  06854000
FLCMCLA  EQU   PSA+168                                                  06855000
FLCIOEL  EQU   FLCMCLA+4                                                06856000
FLCIOA   EQU   FLCMCLA+16                                               06857000
FLCFSA   EQU   FLCMCLA+80                                               06858000
PSATOLD  EQU   PSA+540                                                  06859000
PSAAOLD  EQU   PSA+548                                                  06860000
PSASUPER EQU   PSA+552                                                  06861000
PSASUP1  EQU   PSASUPER                                                 06862000
PSASUP2  EQU   PSASUPER+1                                               06863000
PSASUP3  EQU   PSASUPER+2                                               06864000
PSASUP4  EQU   PSASUPER+3                                               06865000
PSACLHT  EQU   PSA+640                                                  06866000
PSALKSA  EQU   PSA+696                                                  06867000
PSAHLHI  EQU   PSA+760                                                  06868000
PSALITA  EQU   PSA+764                                                  06869000
PSADSSFL EQU   PSA+836                                                  06870000
PSADSSF1 EQU   PSADSSFL                                                 06871000
PSADSSF3 EQU   PSADSSFL+2                                               06872000
PSADSSF4 EQU   PSADSSFL+3                                               06873000
PSARSVT  EQU   PSA+896                                                  06874000
PSALSFCC EQU   PSA+1012                                                 06875000
CVTMAP   EQU   0                                                        06876000
CVTDAR   EQU   CVTMAP+72                                                06877000
CVTFLGS1 EQU   CVTDAR                                                   06878000
CVTDCB   EQU   CVTMAP+116                                               06879000
CVTIOQET EQU   CVTMAP+120                                               06880000
CVTIXAVL EQU   CVTMAP+124                                               06881000
CVTIERLC EQU   CVTMAP+144                                               06882000
CVTHEAD  EQU   CVTMAP+160                                               06883000
CVTSV76C EQU   CVTHEAD                                                  06884000
CVTOPTA  EQU   CVTMAP+182                                               06885000
CVTOPTB  EQU   CVTMAP+183                                               06886000
CVTGTF   EQU   CVTMAP+236                                               06887000
CVTGTFST EQU   CVTGTF                                                   06888000
CVTGTFS  EQU   CVTGTFST                                                 06889000
CVTSTATE EQU   CVTGTFST                                                 06890000
CVTTMODE EQU   CVTGTFST                                                 06891000
CVTFORM  EQU   CVTGTFST                                                 06892000
CVTAQAVT EQU   CVTMAP+240                                               06893000
CVTTCMFG EQU   CVTAQAVT                                                 06894000
CVTVOLM2 EQU   CVTMAP+244                                               06895000
CVTTATA  EQU   CVTVOLM2                                                 06896000
CVTTSKS  EQU   CVTTATA                                                  06897000
CVTVOLF2 EQU   CVTTSKS                                                  06898000
CVTTAT   EQU   CVTTATA+1                                                06899000
CVTATER  EQU   CVTMAP+248                                               06900000
CVTEXT1  EQU   CVTMAP+252                                               06901000
CVTPURG  EQU   CVTMAP+260                                               06902000
CVTQMSG  EQU   CVTMAP+268                                               06903000
CVTDMSR  EQU   CVTMAP+272                                               06904000
CVTRSV37 EQU   CVTDMSR                                                  06905000
CVTDMSRF EQU   CVTRSV37                                                 06906000
CVTERPV  EQU   CVTMAP+316                                               06907000
CVTINTLA EQU   CVTMAP+320                                               06908000
CVTAPF   EQU   CVTMAP+324                                               06909000
CVTEXT2  EQU   CVTMAP+328                                               06910000
CVTHJES  EQU   CVTMAP+332                                               06911000
CVTPGSIA EQU   CVTMAP+348                                               06912000
CVTA1F1  EQU   CVTMAP+356                                               06913000
CVTSYSK  EQU   CVTMAP+357                                               06914000
CVTVOLM1 EQU   CVTMAP+380                                               06915000
CVTVOLF1 EQU   CVTVOLM1                                                 06916000
CVTATMCT EQU   CVTMAP+388                                               06917000
CVTXTNT1 EQU   0                                                        06918000
CVTXTNT2 EQU   0                                                        06919000
CVTDSSV  EQU   CVTXTNT2                                                 06920000
CVTFLGBT EQU   CVTXTNT2+5                                               06921000
CVTDEBVR EQU   CVTXTNT2+8                                               06922000
CVTQID   EQU   CVTXTNT2+24                                              06923000
CVTRV400 EQU   CVTXTNT2+52                                              06924000
CVTRV409 EQU   CVTXTNT2+53                                              06925000
CVTATCVT EQU   CVTXTNT2+64                                              06926000
CVTRV429 EQU   CVTXTNT2+84                                              06927000
CVTRV438 EQU   CVTXTNT2+85                                              06928000
CVTRV457 EQU   CVTXTNT2+112                                             06929000
CVTRV466 EQU   CVTXTNT2+113                                             06930000
CVTFIX   EQU   0                                                        06931000
CVTRELNO EQU   CVTFIX+252                                               06932000
IEAVPSI  EQU   0                                                        06933000
IEAVEQV3 EQU   0                                                        06934000
FRRS     EQU   0                                                        06935000
FRRSHEAD EQU   FRRS                                                     06936000
FRRSEMP  EQU   FRRSHEAD                                                 06937000
FRRSLAST EQU   FRRSHEAD+4                                               06938000
FRRSELEN EQU   FRRSHEAD+8                                               06939000
FRRSCURR EQU   FRRSHEAD+12                                              06940000
FRRSENTR EQU   0                                                        06941000
FRRSFRRA EQU   FRRSENTR                                                 06942000
FRRSFLGS EQU   FRRSENTR+4                                               06943000
FRRSFLG1 EQU   FRRSFLGS                                                 06944000
FRRSPARM EQU   FRRSENTR+8                                               06945000
SUBITS   EQU   0                                                        06946000
SUBYTE1  EQU   SUBITS                                                   06947000
SUBYTE2  EQU   SUBITS+1                                                 06948000
SUBYTE3  EQU   SUBITS+2                                                 06949000
SUBYTE4  EQU   SUBITS+3                                                 06950000
SUBYTE5  EQU   SUBITS+4                                                 06951000
SUBYTE6  EQU   SUBITS+5                                                 06952000
SUBYTE7  EQU   SUBITS+6                                                 06953000
SUBYTE8  EQU   SUBITS+7                                                 06954000
SUBYTE9  EQU   SUBITS+8                                                 06955000
SUBYTE10 EQU   SUBITS+9                                                 06956000
SUBYTE11 EQU   SUBITS+10                                                06957000
SUBYTE12 EQU   SUBITS+11                                                06958000
SUBYTE13 EQU   SUBITS+12                                                06959000
IOCOM    EQU   0                                                        06960000
IOCPRGID EQU   IOCOM+44                                                 06961000
ASCB     EQU   0                                                        06962000
ASCBSUPC EQU   ASCB+16                                                  06963000
ASCBASID EQU   ASCB+36                                                  06964000
ASCBRSM  EQU   ASCB+52                                                  06965000
ASCBRSMF EQU   ASCBRSM                                                  06966000
ASCBFW1  EQU   ASCB+100                                                 06967000
ASCBAFFN EQU   ASCBFW1                                                  06968000
ASCBRCTF EQU   ASCBFW1+2                                                06969000
ASCBFLG1 EQU   ASCBFW1+3                                                06970000
ASCBDSP1 EQU   ASCB+114                                                 06971000
ASCBFLG2 EQU   ASCB+115                                                 06972000
ASCBLKGP EQU   ASCB+128                                                 06973000
ASCBSRQ  EQU   ASCB+180                                                 06974000
ASCBSRQ1 EQU   ASCBSRQ                                                  06975000
ASCBSRQ2 EQU   ASCBSRQ+1                                                06976000
ASCBSRQ3 EQU   ASCBSRQ+2                                                06977000
ASCBSRQ4 EQU   ASCBSRQ+3                                                06978000
DEBBASIC EQU   0                                                        06979000
DEBTCBAD EQU   DEBBASIC                                                 06980000
DEBTCBB  EQU   DEBTCBAD+1                                               06981000
DEBDEBAD EQU   DEBBASIC+4                                               06982000
DEBIRBAD EQU   DEBBASIC+8                                               06983000
DEBOFLGS EQU   DEBIRBAD                                                 06984000
DEBOPATB EQU   DEBBASIC+12                                              06985000
DEBFLGS1 EQU   DEBBASIC+14                                              06986000
DEBUSRPG EQU   DEBBASIC+16                                              06987000
DEBRRQ   EQU   DEBBASIC+20                                              06988000
DEBECBAD EQU   DEBRRQ                                                   06989000
DEBDCBAD EQU   DEBBASIC+24                                              06990000
DEBPROTG EQU   DEBDCBAD                                                 06991000
DEBAPPAD EQU   DEBBASIC+28                                              06992000
DEBBASND EQU   DEBBASIC+32                                              06993000
DEBDASD  EQU   0                                                        06994000
DEBUCBAD EQU   DEBDASD                                                  06995000
DEBACSMD EQU   0                                                        06996000
DEBVOLSQ EQU   DEBACSMD                                                 06997000
DEBVOLBT EQU   DEBVOLSQ                                                 06998000
DEBDSNM  EQU   DEBACSMD+4                                               06999000
DEBUTSAA EQU   DEBDSNM                                                  07000000
DEBACS01 EQU   0                                                        07001000
DEBDSNAM EQU   DEBACS01                                                 07002000
DEBACS02 EQU   0                                                        07003000
DEBDBLK  EQU   DEBACS02                                                 07004000
DEBACS03 EQU   0                                                        07005000
DEBACS04 EQU   0                                                        07006000
DEBTBFRA EQU   DEBACS04                                                 07007000
DEBTCCWA EQU   DEBACS04+4                                               07008000
DEBACS05 EQU   0                                                        07009000
DEBFUCBA EQU   DEBACS05                                                 07010000
DEBLUCBA EQU   DEBACS05+4                                               07011000
DEBACS06 EQU   0                                                        07012000
DEBACS07 EQU   0                                                        07013000
DEBACS08 EQU   0                                                        07014000
DEBSUBNM EQU   0                                                        07015000
DEB      EQU   0                                                        07016000
DEBAVT   EQU   DEB                                                      07017000
DEBEOEA  EQU   DEBAVT                                                   07018000
DEBEOEAB EQU   DEBEOEA                                                  07019000
DEBSIOA  EQU   DEBAVT+4                                                 07020000
DEBSIOAB EQU   DEBSIOA                                                  07021000
DEBPCIA  EQU   DEBAVT+8                                                 07022000
DEBPCIAB EQU   DEBPCIA                                                  07023000
DEBCEA   EQU   DEBAVT+12                                                07024000
DEBCEAB  EQU   DEBCEA                                                   07025000
DEBXCEA  EQU   DEBAVT+16                                                07026000
DEBXCEAB EQU   DEBXCEA                                                  07027000
DEBPREFX EQU   DEB+20                                                   07028000
DEBXTNP  EQU   DEBPREFX+8                                               07029000
DEBXTN   EQU   0                                                        07030000
DEBXFLG1 EQU   DEBXTN+2                                                 07031000
IOSB     EQU   0                                                        07032000
IOSFLA   EQU   IOSB                                                     07033000
IOSACHN  EQU   IOSFLA                                                   07034000
IOSDCHN  EQU   IOSACHN                                                  07035000
IOSCCHN  EQU   IOSACHN                                                  07036000
IOSFLB   EQU   IOSB+1                                                   07037000
IOSNOTRS EQU   IOSFLB                                                   07038000
IOSFLC   EQU   IOSB+2                                                   07039000
IOSDVALT EQU   IOSFLC                                                   07040000
IOSDVRID EQU   IOSB+4                                                   07041000
IOSASID  EQU   IOSB+6                                                   07042000
IOSPGAD  EQU   IOSB+8                                                   07043000
IOSPKEY  EQU   IOSB+12                                                  07044000
IOSOPT   EQU   IOSB+14                                                  07045000
IOSDEP   EQU   IOSOPT                                                   07046000
IOSPSLL  EQU   IOSOPT                                                   07047000
IOSTSLL  EQU   IOSOPT                                                   07048000
IOSOPT2  EQU   IOSB+15                                                  07049000
IOSUCB   EQU   IOSB+16                                                  07050000
@NM00034 EQU   IOSB+20                                                  07051000
IOSCC    EQU   @NM00034                                                 07052000
IOSCSW   EQU   @NM00034+1                                               07053000
IOSTATUS EQU   IOSCSW+3                                                 07054000
IOSSRB   EQU   IOSB+28                                                  07055000
IOSIPIB  EQU   IOSB+44                                                  07056000
IOSNRM   EQU   IOSB+60                                                  07057000
IOSABN   EQU   IOSB+64                                                  07058000
IOSDIE   EQU   IOSB+68                                                  07059000
IOSRST   EQU   IOSB+72                                                  07060000
IOSVST   EQU   IOSB+76                                                  07061000
IOSDSID  EQU   IOSB+80                                                  07062000
IOSPATH  EQU   IOSB+86                                                  07063000
IOSCHN   EQU   IOSPATH                                                  07064000
IOSCKEY  EQU   IOSB+89                                                  07065000
IOSEEKA  EQU   IOSB+100                                                 07066000
IOSCCHH  EQU   IOSEEKA+3                                                07067000
IOSSKHH  EQU   IOSCCHH+2                                                07068000
SRBSECT  EQU   0                                                        07069000
SRB      EQU   SRBSECT                                                  07070000
SRBID    EQU   SRB                                                      07071000
SRBASCB  EQU   SRB+8                                                    07072000
SRBFLC   EQU   SRB+12                                                   07073000
SRBCPAFF EQU   SRBFLC                                                   07074000
SRBPASID EQU   SRBFLC+2                                                 07075000
SRBPTCB  EQU   SRBFLC+4                                                 07076000
SRBEP    EQU   SRB+20                                                   07077000
SRBRMTR  EQU   SRB+24                                                   07078000
SRBPARM  EQU   SRB+28                                                   07079000
SRBPKF   EQU   SRB+36                                                   07080000
VSL      EQU   0                                                        07081000
VSLSTRT  EQU   VSL                                                      07082000
VSLFLAG1 EQU   VSLSTRT                                                  07083000
VSLFIX   EQU   VSLFLAG1                                                 07084000
VSLFREE  EQU   VSLFLAG1                                                 07085000
VSLONG   EQU   VSLFLAG1                                                 07086000
VSLSTRTA EQU   VSLSTRT+1                                                07087000
VSLEND   EQU   VSL+4                                                    07088000
VSLFLAG2 EQU   VSLEND                                                   07089000
VSLAST   EQU   VSLFLAG2                                                 07090000
VSLEND1A EQU   VSLEND+1                                                 07091000
APRL     EQU   0                                                        07092000
APRLID   EQU   APRL                                                     07093000
APRLUSER EQU   APRL+4                                                   07094000
APRLECB  EQU   APRL+8                                                   07095000
APRLECBC EQU   APRLECB                                                  07096000
APRLFDBK EQU   APRL+12                                                  07097000
APRLRCT  EQU   APRLFDBK+1                                               07098000
APRLRCC  EQU   APRLFDBK+2                                               07099000
APRLRCN  EQU   APRLFDBK+3                                               07100000
APRLMSGN EQU   APRL+16                                                  07101000
APRLVALN EQU   APRL+18                                                  07102000
APRLAPIO EQU   APRL+32                                                  07103000
APRLCCW  EQU   APRL+36                                                  07104000
APRLOPTS EQU   APRL+40                                                  07105000
APRLOPT0 EQU   APRLOPTS                                                 07106000
APRLXIO  EQU   APRLOPT0                                                 07107000
APRLOPT1 EQU   APRLOPTS+1                                               07108000
APRLOPT2 EQU   APRLOPTS+2                                               07109000
APRLOPT3 EQU   APRLOPTS+3                                               07110000
APRLOPTZ EQU   APRL+56                                                  07111000
APRLOPT4 EQU   APRLOPTZ                                                 07112000
APRLOPT5 EQU   APRLOPTZ+1                                               07113000
APRLOPT6 EQU   APRLOPTZ+2                                               07114000
APRLOPT7 EQU   APRLOPTZ+3                                               07115000
APRLRXLT EQU   APRLOPT7                                                 07116000
APRLDUMP EQU   APRLOPT7                                                 07117000
APRLPGFX EQU   APRLOPT7                                                 07118000
APRLEXTS EQU   APRL+68                                                  07119000
APCT     EQU   0                                                        07120000
APCTENQM EQU   APCT+12                                                  07121000
APCTSMIN EQU   APCT+32                                                  07122000
APCTSMAD EQU   APCT+36                                                  07123000
APCTZ@@@ EQU   APCT+40                                                  07124000
APCTU@@@ EQU   APCT+440                                                 07125000
APCTBR14 EQU   APCT+840                                                 07126000
APCTERRS EQU   APCT+876                                                 07127000
@NM00070 EQU   APCT+936                                                 07128000
APCTSTAT EQU   @NM00070                                                 07129000
APCTPRSW EQU   @NM00070+1                                               07130000
APCTAPCQ EQU   APCT+944                                                 07131000
APCTCQAQ EQU   APCT+952                                                 07132000
APCTCSCT EQU   APCT+1060                                                07133000
APCTAPIO EQU   APCT+1064                                                07134000
APCTABND EQU   APCT+1072                                                07135000
APCTKCAX EQU   APCT+1076                                                07136000
APCTIOAP EQU   APCT+1100                                                07137000
APCTZ@@1 EQU   APCT+1120                                                07138000
APCTAPVU EQU   APCT+1520                                                07139000
APCVZUAC EQU   0                                                        07140000
APCVZUAD EQU   0                                                        07141000
APCVZUAE EQU   0                                                        07142000
APCVZUAF EQU   0                                                        07143000
APCVZUAG EQU   0                                                        07144000
APCVZUKA EQU   0                                                        07145000
APCVZKBB EQU   0                                                        07146000
APCVZKBC EQU   0                                                        07147000
APDS     EQU   0                                                        07148000
APDSTD   EQU   APDS+16                                                  07149000
APDSAPUB EQU   APDS+48                                                  07150000
APDSREG  EQU   APDS+56                                                  07151000
APDSFLGS EQU   APDS+64                                                  07152000
APDSFLG0 EQU   APDSFLGS                                                 07153000
APDSOWN  EQU   APDSFLG0                                                 07154000
APDSFLG1 EQU   APDSFLGS+1                                               07155000
APDSPGFX EQU   APDS+66                                                  07156000
APDSDUMP EQU   APDS+67                                                  07157000
APDX     EQU   0                                                        07158000
APDXAPDS EQU   APDX+12                                                  07159000
APDX252A EQU   APDX+28                                                  07160000
APDXAPMF EQU   APDX252A                                                 07161000
APDXDXL  EQU   APDX+32                                                  07162000
APDXIOCT EQU   APDX+128                                                 07163000
APDXSWS  EQU   APDX+130                                                 07164000
APDXSW0  EQU   APDXSWS                                                  07165000
APDXSOPN EQU   APDXSW0                                                  07166000
APDXSW1  EQU   APDXSWS+1                                                07167000
APDXAPIO EQU   APDX+136                                                 07168000
APGF     EQU   0                                                        07169000
APGFSW   EQU   APGF                                                     07170000
APGFSINA EQU   APGFSW                                                   07171000
APGFSINL EQU   APGFSW                                                   07172000
APGFSCLR EQU   APGFSW                                                   07173000
APGFSPGE EQU   APGFSW                                                   07174000
APGFSLCK EQU   APGFSW                                                   07175000
APGFSTCB EQU   APGFSW                                                   07176000
APGFSUNC EQU   APGFSW                                                   07177000
APGFSFRE EQU   APGFSW                                                   07178000
APGFXSP  EQU   APGF+2                                                   07179000
APGFXKEY EQU   APGF+3                                                   07180000
APGFXADR EQU   APGF+4                                                   07181000
APGFXLN  EQU   APGF+8                                                   07182000
APGFTCB  EQU   APGF+12                                                  07183000
APIO     EQU   0                                                        07184000
APIOIOCB EQU   APIO                                                     07185000
APIOID   EQU   APIO+192                                                 07186000
APIOAPIO EQU   APIO+200                                                 07187000
APIOAPUB EQU   APIO+204                                                 07188000
APIOVCSW EQU   APIO+208                                                 07189000
APIOAPXL EQU   APIO+212                                                 07190000
APIODEB  EQU   APIO+216                                                 07191000
APIOCCW  EQU   APIO+220                                                 07192000
APIOAPCI EQU   APIO+224                                                 07193000
APIOPGFX EQU   APIO+228                                                 07194000
APIOPGFL EQU   APIO+232                                                 07195000
APIORGN  EQU   APIO+236                                                 07196000
APIOIOAP EQU   APIO+240                                                 07197000
APIOOLAP EQU   APIO+244                                                 07198000
APIOFLGS EQU   APIO+248                                                 07199000
APIOFLGA EQU   APIOFLGS                                                 07200000
APIOFLG0 EQU   APIOFLGA                                                 07201000
APIOFXED EQU   APIOFLG0                                                 07202000
APIORXLT EQU   APIOFLG0                                                 07203000
APIOFLG2 EQU   APIOFLGA+2                                               07204000
APIOEXCL EQU   APIOFLG2                                                 07205000
APIODUMP EQU   APIOFLG2                                                 07206000
APIOFLG3 EQU   APIOFLGA+3                                               07207000
APIOFLGB EQU   APIOFLGS+4                                               07208000
APIOFLG7 EQU   APIOFLGB+3                                               07209000
APIOINDX EQU   APIO+288                                                 07210000
APIOSAVE EQU   APIOINDX                                                 07211000
APIOASCB EQU   APIO+348                                                 07212000
APIOTERM EQU   APIO+352                                                 07213000
APIOECB  EQU   APIO+356                                                 07214000
APIOTR   EQU   APIO+360                                                 07215000
APIOSIZE EQU   APIO+368                                                 07216000
APIOCISZ EQU   APIO+370                                                 07217000
APIOGMAD EQU   APIO+372                                                 07218000
APIOGMSZ EQU   APIO+376                                                 07219000
APIOGMSP EQU   APIOGMSZ                                                 07220000
APIOGMS1 EQU   APIOGMSZ+2                                               07221000
APIOAPCT EQU   APIO+380                                                 07222000
APIONBR  EQU   APIO+384                                                 07223000
APIONBRX EQU   APIONBR                                                  07224000
APIOPGFF EQU   APIO+400                                                 07225000
APIOUCCW EQU   APIO+404                                                 07226000
APMF     EQU   0                                                        07227000
APMFH    EQU   APMF                                                     07228000
APMFHSTY EQU   APMFH+4                                                  07229000
APMFHSWS EQU   APMFH+46                                                 07230000
APMFHSW0 EQU   APMFHSWS                                                 07231000
APMFHISX EQU   APMFHSW0                                                 07232000
APMFA    EQU   APMF+64                                                  07233000
APMFASW  EQU   APMFA+12                                                 07234000
APMFASW0 EQU   APMFASW                                                  07235000
APMFO    EQU   APMF+104                                                 07236000
APMFC    EQU   APMF+136                                                 07237000
APMFX    EQU   APMF+160                                                 07238000
APMFXRQT EQU   APMFX                                                    07239000
APMFXRQX EQU   APMFX+2                                                  07240000
APMFXRQI EQU   APMFX+4                                                  07241000
APMFXMXT EQU   APMFX+6                                                  07242000
APMFXMXX EQU   APMFX+8                                                  07243000
APMFXMXI EQU   APMFX+10                                                 07244000
APMFXRQR EQU   APMFX+12                                                 07245000
APMFXMXR EQU   APMFX+14                                                 07246000
APMFI    EQU   APMF+192                                                 07247000
APMV     EQU   0                                                        07248000
APMVHDR  EQU   APMV                                                     07249000
APMVHKWD EQU   APMVHDR+4                                                07250000
APMVHMSG EQU   APMVHDR+8                                                07251000
APMVKWD  EQU   0                                                        07252000
APMVMSG  EQU   0                                                        07253000
APSC     EQU   0                                                        07254000
APSCCRSZ EQU   APSC+2                                                   07255000
APSM     EQU   0                                                        07256000
APSMSIZE EQU   APSM+4                                                   07257000
APSV     EQU   0                                                        07258000
APSVPREV EQU   APSV+4                                                   07259000
APSVREGS EQU   APSV+12                                                  07260000
APUB     EQU   0                                                        07261000
APUBUCB  EQU   APUB+28                                                  07262000
APUBERRS EQU   APUB+52                                                  07263000
APUBALFG EQU   APUB+80                                                  07264000
APUBALF0 EQU   APUBALFG                                                 07265000
APUBALF1 EQU   APUBALFG+1                                               07266000
APUBALF2 EQU   APUBALFG+2                                               07267000
APUBALF3 EQU   APUBALFG+3                                               07268000
APUBSTAT EQU   APUB+84                                                  07269000
APUBIOFG EQU   APUB+88                                                  07270000
APUBIOF0 EQU   APUBIOFG                                                 07271000
APUBIOF1 EQU   APUBIOFG+1                                               07272000
APUBIOF2 EQU   APUBIOFG+2                                               07273000
APUBIOF3 EQU   APUBIOFG+3                                               07274000
APUBDCB  EQU   APUB+96                                                  07275000
APVU     EQU   0                                                        07276000
APVUSPLN EQU   APVU+8                                                   07277000
APVUAUSE EQU   APVU+3040                                                07278000
APVUAPIO EQU   APVUAUSE                                                 07279000
APXL     EQU   0                                                        07280000
APXLID   EQU   APXL                                                     07281000
APXLLAST EQU   APXL+8                                                   07282000
APXLFREE EQU   APXL+12                                                  07283000
APXLIDAL EQU   APXL+16                                                  07284000
PROCDATA EQU   0                                                        07285000
PROCCNT  EQU   PROCDATA                                                 07286000
PROCCISZ EQU   PROCDATA+2                                               07287000
PROCOFS  EQU   PROCDATA+4                                               07288000
DXXXXBLK EQU   0                                                        07289000
DXXXXBEG EQU   DXXXXBLK                                                 07290000
DXXXXEND EQU   DXXXXBLK+4                                               07291000
DXXXXSZ  EQU   DXXXXBLK+12                                              07292000
DXXXXACT EQU   DXXXXBLK+20                                              07293000
DXXXXDIF EQU   DXXXXBLK+24                                              07294000
IDAL     EQU   0                                                        07295000
CCW      EQU   0                                                        07296000
CCWOP    EQU   CCW                                                      07297000
CCWDATA  EQU   CCW+1                                                    07298000
CCWFLAGS EQU   CCW+4                                                    07299000
CCWFCD   EQU   CCWFLAGS                                                 07300000
CCWFCC   EQU   CCWFLAGS                                                 07301000
CCWFSLI  EQU   CCWFLAGS                                                 07302000
CCWFSKIP EQU   CCWFLAGS                                                 07303000
CCWFPCI  EQU   CCWFLAGS                                                 07304000
CCWFIDA  EQU   CCWFLAGS                                                 07305000
CCWFB6   EQU   CCWFLAGS                                                 07306000
CCWFB7   EQU   CCWFLAGS                                                 07307000
CCWBCNT  EQU   CCW+6                                                    07308000
APESREGS EQU   0                                                        07309000
APESREGE EQU   APESREGS+56                                              07310000
APESREGF EQU   APESREGS+60                                              07311000
APESRTRY EQU   APESREGF                                                 07312000
APESMV   EQU   0                                                        07313000
I031F    EQU   0                                                        07314000
I001C    EQU   0                                                        07315000
I031P    EQU   0                                                        07316000
APCVZDAL EQU   0                                                        07317000
APCVZDAP EQU   0                                                        07318000
APCVZDBK EQU   0                                                        07319000
APCVZDDA EQU   0                                                        07320000
APCVZDDQ EQU   0                                                        07321000
APCVZDEQ EQU   0                                                        07322000
APCVZDID EQU   0                                                        07323000
APCVZDIO EQU   0                                                        07324000
APCVZDIP EQU   0                                                        07325000
APCVZDMD EQU   0                                                        07326000
APCVZDMM EQU   0                                                        07327000
APCVZDQR EQU   0                                                        07328000
APCVZDRI EQU   0                                                        07329000
APCVZDUA EQU   0                                                        07330000
APCVZDUL EQU   0                                                        07331000
APCVZDWI EQU   0                                                        07332000
APCVZDWT EQU   0                                                        07333000
APCVZDX1 EQU   0                                                        07334000
APCVZDX2 EQU   0                                                        07335000
APCVZDX3 EQU   0                                                        07336000
APCVZDX4 EQU   0                                                        07337000
APCVZD10 EQU   0                                                        07338000
APCVZD20 EQU   0                                                        07339000
APCVZD4E EQU   0                                                        07340000
APCVZD40 EQU   0                                                        07341000
APCVZD41 EQU   0                                                        07342000
APCVZD42 EQU   0                                                        07343000
APCVZD43 EQU   0                                                        07344000
APCVZD44 EQU   0                                                        07345000
APCVZD45 EQU   0                                                        07346000
APCVZD46 EQU   0                                                        07347000
APCVZD47 EQU   0                                                        07348000
APCVZD48 EQU   0                                                        07349000
APCVZD49 EQU   0                                                        07350000
APCVZD60 EQU   0                                                        07351000
APCVZD80 EQU   0                                                        07352000
APCVZD81 EQU   0                                                        07353000
APCVZD82 EQU   0                                                        07354000
APCVZD83 EQU   0                                                        07355000
APCVZJAA EQU   0                                                        07356000
APCVZJAD EQU   0                                                        07357000
APCVZJAG EQU   0                                                        07358000
APCVZJAJ EQU   0                                                        07359000
APCVZJAM EQU   0                                                        07360000
APCVZJAP EQU   0                                                        07361000
APCVZJAX EQU   0                                                        07362000
APCVZJAY EQU   0                                                        07363000
APCVZJBA EQU   0                                                        07364000
APCVZJBD EQU   0                                                        07365000
APCVZJBG EQU   0                                                        07366000
APCVZJBJ EQU   0                                                        07367000
APCVZJBM EQU   0                                                        07368000
APCVZJDA EQU   0                                                        07369000
APCVZJDD EQU   0                                                        07370000
APCVZJDG EQU   0                                                        07371000
APCVZJDJ EQU   0                                                        07372000
APCVZJDM EQU   0                                                        07373000
APCVZJHC EQU   0                                                        07374000
APCVZJHE EQU   0                                                        07375000
APCVZJHF EQU   0                                                        07376000
APCVZJHO EQU   0                                                        07377000
APCVZJHQ EQU   0                                                        07378000
APCVZJHR EQU   0                                                        07379000
APCVZJHT EQU   0                                                        07380000
APCVZJHW EQU   0                                                        07381000
APCVZJH0 EQU   0                                                        07382000
APCVZJH6 EQU   0                                                        07383000
APCVZJI0 EQU   0                                                        07384000
APCVZJI3 EQU   0                                                        07385000
APCVZJJ0 EQU   0                                                        07386000
APCVZKAA EQU   0                                                        07387000
APCVZKBA EQU   0                                                        07388000
APCVZKBD EQU   0                                                        07389000
APCVZKBE EQU   0                                                        07390000
APCVZKBF EQU   0                                                        07391000
APCVZKCA EQU   0                                                        07392000
APCVZKDA EQU   0                                                        07393000
APCVZKGA EQU   0                                                        07394000
APCVZKGB EQU   0                                                        07395000
APCVZKGC EQU   0                                                        07396000
APCVZKGD EQU   0                                                        07397000
APCVZLCA EQU   0                                                        07398000
APCVZLCB EQU   0                                                        07399000
APCVZMBA EQU   0                                                        07400000
APCVZMBD EQU   0                                                        07401000
APCVZMBG EQU   0                                                        07402000
APCVZMBH EQU   0                                                        07403000
APCVZMBK EQU   0                                                        07404000
APCVZMBM EQU   0                                                        07405000
APCVZMIB EQU   0                                                        07406000
APCVZMIC EQU   0                                                        07407000
APCVZMIF EQU   0                                                        07408000
APCVZMJB EQU   0                                                        07409000
APCVZMJC EQU   0                                                        07410000
APCVZMJH EQU   0                                                        07411000
APCVZMJI EQU   0                                                        07412000
APCVZMMA EQU   0                                                        07413000
APCVZUAA EQU   0                                                        07414000
APCVZUAB EQU   0                                                        07415000
APCVZUBB EQU   0                                                        07416000
APCVZUFA EQU   0                                                        07417000
APCVZUHA EQU   0                                                        07418000
APCVZUHB EQU   0                                                        07419000
APCVZUJA EQU   0                                                        07420000
APCV1CMD EQU   0                                                        07421000
APCV1JAA EQU   0                                                        07422000
APCV1JBJ EQU   0                                                        07423000
APCV1JHC EQU   0                                                        07424000
APCV1JHL EQU   0                                                        07425000
APCV1JHT EQU   0                                                        07426000
APCV1MAB EQU   0                                                        07427000
APCV1MBD EQU   0                                                        07428000
APCV2JHC EQU   0                                                        07429000
APCV2JHL EQU   0                                                        07430000
APCV2MBD EQU   0                                                        07431000
I008P    EQU   0                                                        07432000
I015F    EQU   0                                                        07433000
I015P    EQU   0                                                        07434000
I256C    EQU   0                                                        07435000
FLC      EQU   PSA                                                      07436000
PSARSVTE EQU   PSARSVT                                                  07437000
PSACSTK  EQU   PSARSVTE                                                 07438000
CVTPTR   EQU   FLCCVT                                                   07439000
CVTS01   EQU   CVTPGSIA                                                 07440000
CVTLPDIA EQU   CVTS01+12                                                07441000
CVTDIRST EQU   CVTLPDIA                                                 07442000
CVTSLIDA EQU   CVTS01+24                                                07443000
CVTCTLFG EQU   CVTS01+50                                                07444000
CVTSV60  EQU   CVTS01+228                                               07445000
CVTRV210 EQU   CVTS01+424                                               07446000
CVTRV219 EQU   CVTS01+425                                               07447000
CVTRV228 EQU   CVTS01+426                                               07448000
CVTRV237 EQU   CVTS01+427                                               07449000
CVTMFRTR EQU   CVTS01+452                                               07450000
CVTVPSIB EQU   CVTS01+456                                               07451000
CVTRV262 EQU   CVTS01+468                                               07452000
CVTRV271 EQU   CVTS01+469                                               07453000
CVTRV280 EQU   CVTS01+470                                               07454000
CVTRV289 EQU   CVTS01+471                                               07455000
CVTQV3   EQU   CVTS01+596                                               07456000
CVTGSDA  EQU   CVTS01+600                                               07457000
CVTIHASU EQU   CVTS01+696                                               07458000
IOCOMPTR EQU   CVTIXAVL                                                 07459000
ASCBPTR  EQU   PSAAOLD                                                  07460000
DEBBAS02 EQU   DEBBASND                                                 07461000
DEBDDS1  EQU   DEBBAS02                                                 07462000
DEBSUCBA EQU   DEBDDS1                                                  07463000
DEBDEVED EQU   DEBDDS1+4                                                07464000
DEBRDCB  EQU   DEBDDS1+4                                                07465000
DEBPDCB  EQU   DEBDDS1+8                                                07466000
DEBWDCB  EQU   DEBDDS1+12                                               07467000
DEBACS09 EQU   DEBDEVED                                                 07468000
DEBASC09 EQU   DEBACS09                                                 07469000
DEBEAMFG EQU   DEBASC09+3                                               07470000
DEBDSID  EQU   DEBASC09+4                                               07471000
DEBEOD   EQU   DEBASC09+12                                              07472000
DEBBOE   EQU   DEBEOD                                                   07473000
DEBEODRV EQU   DEBBOE                                                   07474000
DEBEODTT EQU   DEBBOE+1                                                 07475000
DEBEOD0  EQU   DEBBOE+2                                                 07476000
DEBEODSS EQU   DEBBOE+3                                                 07477000
DEBBAS01 EQU   DEBBASND                                                 07478000
DEBISAM  EQU   DEBBAS01                                                 07479000
DEBFIEAD EQU   DEBISAM                                                  07480000
DEBFPEAD EQU   DEBISAM+4                                                07481000
DEBFOEAD EQU   DEBISAM+8                                                07482000
DEBEXPT  EQU   DEBISAM+12                                               07483000
DEBRPSID EQU   DEBEXPT                                                  07484000
IOSATTSC EQU   IOSIPIB                                                  07485000
IOSWTOWA EQU   IOSIPIB                                                  07486000
IOSPCISC EQU   IOSIPIB                                                  07487000
APCTZ    EQU   APCTZ@@@                                                 07488000
APCTZUAA EQU   APCTZ                                                    07489000
APCTZUAB EQU   APCTZ+4                                                  07490000
APCTZUAC EQU   APCTZ+8                                                  07491000
APCTZUAD EQU   APCTZ+12                                                 07492000
APCTZUAE EQU   APCTZ+16                                                 07493000
APCTZUBB EQU   APCTZ+24                                                 07494000
APCTZD10 EQU   APCTZ+28                                                 07495000
APCTZD20 EQU   APCTZ+32                                                 07496000
APCTZD40 EQU   APCTZ+36                                                 07497000
APCTZD41 EQU   APCTZ+40                                                 07498000
APCTZD42 EQU   APCTZ+44                                                 07499000
APCTZD43 EQU   APCTZ+48                                                 07500000
APCTZD44 EQU   APCTZ+52                                                 07501000
APCTZD45 EQU   APCTZ+56                                                 07502000
APCTZD46 EQU   APCTZ+60                                                 07503000
APCTZD47 EQU   APCTZ+64                                                 07504000
APCTZD48 EQU   APCTZ+68                                                 07505000
APCTZD49 EQU   APCTZ+72                                                 07506000
APCTZD60 EQU   APCTZ+76                                                 07507000
APCTZD80 EQU   APCTZ+80                                                 07508000
APCTZD4E EQU   APCTZ+84                                                 07509000
APCTZMBA EQU   APCTZ+88                                                 07510000
APCTZMBD EQU   APCTZ+92                                                 07511000
APCTZMBG EQU   APCTZ+96                                                 07512000
APCTZMBR EQU   APCTZ+100                                                07513000
APCTZDX1 EQU   APCTZ+104                                                07514000
APCTZDX2 EQU   APCTZ+108                                                07515000
APCTZDX3 EQU   APCTZ+112                                                07516000
APCTZDX4 EQU   APCTZ+116                                                07517000
APCTZMBH EQU   APCTZ+120                                                07518000
APCTZMBK EQU   APCTZ+124                                                07519000
APCTZMBM EQU   APCTZ+128                                                07520000
APCTZMJB EQU   APCTZ+132                                                07521000
APCTZMJC EQU   APCTZ+136                                                07522000
APCTZMJH EQU   APCTZ+140                                                07523000
APCTZMMA EQU   APCTZ+144                                                07524000
APCTZDMD EQU   APCTZ+148                                                07525000
APCTZD81 EQU   APCTZ+152                                                07526000
APCTZDID EQU   APCTZ+156                                                07527000
APCTZDRI EQU   APCTZ+160                                                07528000
APCTZMJI EQU   APCTZ+164                                                07529000
APCTZDWT EQU   APCTZ+168                                                07530000
APCTZDMM EQU   APCTZ+172                                                07531000
APCTZDAL EQU   APCTZ+176                                                07532000
APCTZDBK EQU   APCTZ+180                                                07533000
APCTZDIP EQU   APCTZ+184                                                07534000
APCTZDDA EQU   APCTZ+188                                                07535000
APCTZDUL EQU   APCTZ+192                                                07536000
APCTZDEQ EQU   APCTZ+196                                                07537000
APCTZDDQ EQU   APCTZ+200                                                07538000
APCTZDUA EQU   APCTZ+204                                                07539000
APCTZUAF EQU   APCTZ+208                                                07540000
APCTZUAG EQU   APCTZ+212                                                07541000
APCTZDIO EQU   APCTZ+216                                                07542000
APCTZUHA EQU   APCTZ+220                                                07543000
APCTZUHB EQU   APCTZ+224                                                07544000
APCTZJAA EQU   APCTZ+232                                                07545000
APCTZJAD EQU   APCTZ+236                                                07546000
APCTZJAG EQU   APCTZ+240                                                07547000
APCTZJAJ EQU   APCTZ+244                                                07548000
APCTZJAM EQU   APCTZ+248                                                07549000
APCTZJAP EQU   APCTZ+252                                                07550000
APCTZJAY EQU   APCTZ+256                                                07551000
APCTZUFA EQU   APCTZ+260                                                07552000
APCTZUJA EQU   APCTZ+264                                                07553000
APCTZDAP EQU   APCTZ+268                                                07554000
APCTZKAA EQU   APCTZ+272                                                07555000
APCTZD82 EQU   APCTZ+276                                                07556000
APCTZMIB EQU   APCTZ+280                                                07557000
APCTZMIC EQU   APCTZ+284                                                07558000
APCTZD83 EQU   APCTZ+288                                                07559000
APCTZMIF EQU   APCTZ+296                                                07560000
APCTZJH0 EQU   APCTZ+300                                                07561000
APCTZJI0 EQU   APCTZ+304                                                07562000
APCTZJI3 EQU   APCTZ+308                                                07563000
APCTZJJ0 EQU   APCTZ+312                                                07564000
APCTZJBA EQU   APCTZ+316                                                07565000
APCTZJBD EQU   APCTZ+320                                                07566000
APCTZJBG EQU   APCTZ+324                                                07567000
APCTZJBJ EQU   APCTZ+328                                                07568000
APCTZJBM EQU   APCTZ+332                                                07569000
APCTZKCA EQU   APCTZ+340                                                07570000
APCTZKDA EQU   APCTZ+344                                                07571000
APCTZJDA EQU   APCTZ+356                                                07572000
APCTZJDJ EQU   APCTZ+360                                                07573000
APCTZJH6 EQU   APCTZ+364                                                07574000
APCTZJHO EQU   APCTZ+368                                                07575000
APCTZJHF EQU   APCTZ+372                                                07576000
APCTZJHE EQU   APCTZ+376                                                07577000
APCTZDQR EQU   APCTZ+380                                                07578000
APCTZJHR EQU   APCTZ+384                                                07579000
APCTZJHT EQU   APCTZ+388                                                07580000
APCTZJHW EQU   APCTZ+392                                                07581000
APCTZ1   EQU   APCTZ@@1                                                 07582000
APCTZKBA EQU   APCTZ1                                                   07583000
APCTZKBC EQU   APCTZ1+4                                                 07584000
APCTZKBB EQU   APCTZ1+8                                                 07585000
APCTZJHC EQU   APCTZ1+20                                                07586000
APCTZJHQ EQU   APCTZ1+24                                                07587000
APCTZKBD EQU   APCTZ1+28                                                07588000
APCTZKBE EQU   APCTZ1+40                                                07589000
APCTZUKA EQU   APCTZ1+56                                                07590000
APCTZKBF EQU   APCTZ1+60                                                07591000
APCTZJDD EQU   APCTZ1+64                                                07592000
APCTZJDG EQU   APCTZ1+68                                                07593000
APCTZJDM EQU   APCTZ1+72                                                07594000
APCTZLCA EQU   APCTZ1+76                                                07595000
APCTZLCB EQU   APCTZ1+80                                                07596000
APCTZDWI EQU   APCTZ1+84                                                07597000
APCTZJAX EQU   APCTZ1+88                                                07598000
APCTZKGA EQU   APCTZ1+92                                                07599000
APCTZKGB EQU   APCTZ1+96                                                07600000
APCTZKGC EQU   APCTZ1+100                                               07601000
APCTZKGD EQU   APCTZ1+104                                               07602000
APCTU    EQU   APCTU@@@                                                 07603000
APCT1MAB EQU   APCTU                                                    07604000
APCT1MBD EQU   APCTU+4                                                  07605000
APCT2MBD EQU   APCTU+8                                                  07606000
APCT1CMD EQU   APCTU+12                                                 07607000
APCT1JAA EQU   APCTU+20                                                 07608000
APCT1JHC EQU   APCTU+24                                                 07609000
APCT2JHC EQU   APCTU+28                                                 07610000
APCT1JHT EQU   APCTU+32                                                 07611000
APCT1JHL EQU   APCTU+36                                                 07612000
APCT2JHL EQU   APCTU+40                                                 07613000
APCT1JBJ EQU   APCTU+44                                                 07614000
@NM00124 EQU   APIOIOCB                                                 07615000
APIOIOSB EQU   @NM00124                                                 07616000
APIOSRB  EQU   @NM00124+128                                             07617000
@NM00125 EQU   APIOIOCB                                                 07618000
@NM00166 EQU   APXL                                                     07619000
APXLADDR EQU   @NM00166                                                 07620000
APXLADDV EQU   APXLADDR                                                 07621000
APXLADVB EQU   APXLADDV+1                                               07622000
APXLADDL EQU   APXLADDR+4                                               07623000
APXLADLB EQU   APXLADDL+1                                               07624000
CMBRX    EQU   CMBRXZZZ                                                 07625000
CMBRMT   EQU   CMBRX                                                    07626000
CMBRKT   EQU   CMBRX+2                                                  07627000
CMBXRCT  EQU   CMBRX+5                                                  07628000
CMBXRCN  EQU   CMBRX+6                                                  07629000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07630000
@NM00365 EQU   CMBRX+4                                                  07631000
APXLADL0 EQU   APXLADDL                                                 07632000
APXLADV0 EQU   APXLADDV                                                 07633000
APIOIOB  EQU   @NM00125+160                                             07634000
@NM00126 EQU   @NM00125                                                 07635000
@NM00102 EQU   APCTU+48                                                 07636000
APCT1MBM EQU   APCTU+16                                                 07637000
@NM00101 EQU   APCTZ1+108                                               07638000
@NM00100 EQU   APCTZ1+52                                                07639000
@NM00099 EQU   APCTZ1+48                                                07640000
@NM00098 EQU   APCTZ1+44                                                07641000
@NM00097 EQU   APCTZ1+36                                                07642000
@NM00096 EQU   APCTZ1+32                                                07643000
@NM00095 EQU   APCTZ1+16                                                07644000
@NM00094 EQU   APCTZ1+12                                                07645000
@NM00093 EQU   APCTZ+396                                                07646000
@NM00092 EQU   APCTZ+352                                                07647000
@NM00091 EQU   APCTZ+348                                                07648000
@NM00090 EQU   APCTZ+336                                                07649000
@NM00089 EQU   APCTZ+292                                                07650000
APCTZJFA EQU   APCTZ+228                                                07651000
@NM00088 EQU   APCTZ+20                                                 07652000
IOSPCIWA EQU   IOSPCISC+44                                              07653000
IOSPCIRS EQU   IOSPCISC+8                                               07654000
@NM00039 EQU   IOSPCISC+4                                               07655000
@NM00038 EQU   IOSPCISC                                                 07656000
IOSWRNDR EQU   IOSWTOWA+4                                               07657000
IOSWTOPT EQU   IOSWTOWA+3                                               07658000
IOSWTOCP EQU   IOSWTOWA+2                                               07659000
IOSWTOCH EQU   IOSWTOWA                                                 07660000
IOSATTWA EQU   IOSATTSC+40                                              07661000
@NM00037 EQU   IOSATTSC+24                                              07662000
IOSATTSN EQU   IOSATTSC                                                 07663000
DEBEXPTA EQU   DEBEXPT+1                                                07664000
DEBRSV12 EQU   DEBRPSID                                                 07665000
DEBRSV11 EQU   DEBRPSID                                                 07666000
DEBRSV10 EQU   DEBRPSID                                                 07667000
DEBRSV09 EQU   DEBRPSID                                                 07668000
DEBRPSAP EQU   DEBRPSID                                                 07669000
DEBRPSO  EQU   DEBRPSID                                                 07670000
DEBRPSI  EQU   DEBRPSID                                                 07671000
DEBRPSP  EQU   DEBRPSID                                                 07672000
DEBFOEB  EQU   DEBFOEAD+1                                               07673000
DEBNOEE  EQU   DEBFOEAD                                                 07674000
DEBFPEB  EQU   DEBFPEAD+1                                               07675000
DEBNPEE  EQU   DEBFPEAD                                                 07676000
DEBFIEB  EQU   DEBFIEAD+1                                               07677000
DEBNIEE  EQU   DEBFIEAD                                                 07678000
DEBBOESS EQU   DEBEODSS                                                 07679000
DEBBOE0  EQU   DEBEOD0                                                  07680000
DEBBOETT EQU   DEBEODTT                                                 07681000
DEBBOERV EQU   DEBEODRV                                                 07682000
DEBRV008 EQU   DEBDSID+7                                                07683000
DEBWTPTI EQU   DEBDSID+6                                                07684000
DEBEXDTE EQU   DEBDSID                                                  07685000
DEBRV007 EQU   DEBEAMFG                                                 07686000
DEBRV006 EQU   DEBEAMFG                                                 07687000
DEBRV005 EQU   DEBEAMFG                                                 07688000
DEBRV004 EQU   DEBEAMFG                                                 07689000
DEBSECVL EQU   DEBEAMFG                                                 07690000
DEBVAMSG EQU   DEBEAMFG                                                 07691000
DEBDSOPN EQU   DEBEAMFG                                                 07692000
DEBMULTI EQU   DEBEAMFG                                                 07693000
DEBVSEQU EQU   DEBASC09+2                                               07694000
DEBDSSQL EQU   DEBASC09+1                                               07695000
DEBVOLAC EQU   DEBASC09                                                 07696000
DEBWDCBA EQU   DEBWDCB+1                                                07697000
DEBRSV08 EQU   DEBWDCB                                                  07698000
DEBPDCBA EQU   DEBPDCB+1                                                07699000
DEBRSV07 EQU   DEBPDCB                                                  07700000
DEBRDCBA EQU   DEBRDCB+1                                                07701000
DEBRSV06 EQU   DEBRDCB                                                  07702000
DEBSUCBB EQU   DEBSUCBA+1                                               07703000
DEBSDVM  EQU   DEBSUCBA                                                 07704000
CVTRV628 EQU   CVTS01+728                                               07705000
CVTRV627 EQU   CVTS01+724                                               07706000
CVTRV626 EQU   CVTS01+720                                               07707000
CVTRV625 EQU   CVTS01+716                                               07708000
CVTRV624 EQU   CVTS01+712                                               07709000
CVTRV623 EQU   CVTS01+708                                               07710000
CVTRV622 EQU   CVTS01+704                                               07711000
CVTRV621 EQU   CVTS01+700                                               07712000
CVTSUSP  EQU   CVTS01+692                                               07713000
CVTT6SVC EQU   CVTS01+688                                               07714000
CVTCDAL  EQU   CVTS01+684                                               07715000
CVTTCTL  EQU   CVTS01+680                                               07716000
CVTRSUME EQU   CVTS01+676                                               07717000
CVTJTERM EQU   CVTS01+672                                               07718000
CVTASMRM EQU   CVTS01+668                                               07719000
CVTTCASP EQU   CVTS01+664                                               07720000
CVT0PT03 EQU   CVTS01+660                                               07721000
CVT0PT0E EQU   CVTS01+656                                               07722000
CVTRV609 EQU   CVTS01+652                                               07723000
CVTCGK   EQU   CVTS01+648                                               07724000
CVTRAC   EQU   CVTS01+644                                               07725000
CVTRV606 EQU   CVTS01+640                                               07726000
CVTRV605 EQU   CVTS01+636                                               07727000
CVTRV604 EQU   CVTS01+632                                               07728000
CVTEFF02 EQU   CVTS01+628                                               07729000
CVTCBBR  EQU   CVTS01+624                                               07730000
CVTSSCR  EQU   CVTS01+620                                               07731000
CVTEVENT EQU   CVTS01+616                                               07732000
CVTCRCA  EQU   CVTS01+612                                               07733000
CVTTPIO  EQU   CVTS01+608                                               07734000
CVTADV   EQU   CVTS01+604                                               07735000
CVTGSDAB EQU   CVTGSDA                                                  07736000
CVTQV2   EQU   CVTS01+592                                               07737000
CVTQV1   EQU   CVTS01+588                                               07738000
CVTRPT   EQU   CVTS01+584                                               07739000
CVTSSRB  EQU   CVTS01+580                                               07740000
CVTCSDRL EQU   CVTS01+576                                               07741000
CVTEXP1  EQU   CVTS01+572                                               07742000
CVTRMPMT EQU   CVTS01+568                                               07743000
CVTRMPTT EQU   CVTS01+564                                               07744000
CVTVPSA  EQU   CVTS01+560                                               07745000
CVTVSTOP EQU   CVTS01+556                                               07746000
CVTGTFR8 EQU   CVTS01+552                                               07747000
CVTQUIT  EQU   CVTS01+548                                               07748000
CVTVACR  EQU   CVTS01+544                                               07749000
CVTWTCB  EQU   CVTS01+540                                               07750000
CVTSTPRS EQU   CVTS01+536                                               07751000
CVT0PT02 EQU   CVTS01+532                                               07752000
CVTDARCM EQU   CVTS01+528                                               07753000
CVTIRECM EQU   CVTS01+524                                               07754000
CVTJRECM EQU   CVTS01+520                                               07755000
CVTVEMS0 EQU   CVTS01+516                                               07756000
CVTSPFRR EQU   CVTS01+512                                               07757000
CVTRLSTG EQU   CVTS01+508                                               07758000
CVT0TC0A EQU   CVTS01+504                                               07759000
CVTGMBR  EQU   CVTS01+500                                               07760000
CVTLFRM  EQU   CVTS01+496                                               07761000
CVTRMBR  EQU   CVTS01+492                                               07762000
CVTVIOP  EQU   CVTS01+488                                               07763000
CVTRV307 EQU   CVTS01+486                                               07764000
CVTRV306 EQU   CVTS01+484                                               07765000
CVTRV305 EQU   CVTS01+482                                               07766000
CVTRV304 EQU   CVTS01+480                                               07767000
CVTRV303 EQU   CVTS01+478                                               07768000
CVTRV302 EQU   CVTS01+476                                               07769000
CVTTRCA  EQU   CVTS01+472                                               07770000
CVTRV297 EQU   CVTRV289                                                 07771000
CVTRV296 EQU   CVTRV289                                                 07772000
CVTRV295 EQU   CVTRV289                                                 07773000
CVTRV294 EQU   CVTRV289                                                 07774000
CVTRV293 EQU   CVTRV289                                                 07775000
CVTRV292 EQU   CVTRV289                                                 07776000
CVTRV291 EQU   CVTRV289                                                 07777000
CVTRV290 EQU   CVTRV289                                                 07778000
CVTRV288 EQU   CVTRV280                                                 07779000
CVTRV287 EQU   CVTRV280                                                 07780000
CVTRV286 EQU   CVTRV280                                                 07781000
CVTRV285 EQU   CVTRV280                                                 07782000
CVTRV284 EQU   CVTRV280                                                 07783000
CVTRV283 EQU   CVTRV280                                                 07784000
CVTRV282 EQU   CVTRV280                                                 07785000
CVTRV281 EQU   CVTRV280                                                 07786000
CVTRV279 EQU   CVTRV271                                                 07787000
CVTRV278 EQU   CVTRV271                                                 07788000
CVTRV277 EQU   CVTRV271                                                 07789000
CVTRV276 EQU   CVTRV271                                                 07790000
CVTRV275 EQU   CVTRV271                                                 07791000
CVTRV274 EQU   CVTRV271                                                 07792000
CVTRV273 EQU   CVTRV271                                                 07793000
CVTRV272 EQU   CVTRV271                                                 07794000
CVTRV270 EQU   CVTRV262                                                 07795000
CVTRV269 EQU   CVTRV262                                                 07796000
CVTRV268 EQU   CVTRV262                                                 07797000
CVTRV267 EQU   CVTRV262                                                 07798000
CVTRV266 EQU   CVTRV262                                                 07799000
CVTRV265 EQU   CVTRV262                                                 07800000
CVTRV264 EQU   CVTRV262                                                 07801000
CVTRV263 EQU   CVTRV262                                                 07802000
CVTVFP   EQU   CVTS01+464                                               07803000
CVTVSI   EQU   CVTS01+460                                               07804000
CVTMFACT EQU   CVTMFRTR                                                 07805000
CVTMFCTL EQU   CVTS01+448                                               07806000
CVTPVBP  EQU   CVTS01+444                                               07807000
CVTPWI   EQU   CVTS01+440                                               07808000
CVTRV254 EQU   CVTS01+438                                               07809000
CVTRV253 EQU   CVTS01+436                                               07810000
CVTRV252 EQU   CVTS01+434                                               07811000
CVTRV251 EQU   CVTS01+433                                               07812000
CVTRV250 EQU   CVTS01+432                                               07813000
CVTRV249 EQU   CVTS01+431                                               07814000
CVTRV248 EQU   CVTS01+430                                               07815000
CVTRV247 EQU   CVTS01+429                                               07816000
CVTRV246 EQU   CVTS01+428                                               07817000
CVTRV245 EQU   CVTRV237                                                 07818000
CVTRV244 EQU   CVTRV237                                                 07819000
CVTRV243 EQU   CVTRV237                                                 07820000
CVTRV242 EQU   CVTRV237                                                 07821000
CVTRV241 EQU   CVTRV237                                                 07822000
CVTRV240 EQU   CVTRV237                                                 07823000
CVTRV239 EQU   CVTRV237                                                 07824000
CVTRV238 EQU   CVTRV237                                                 07825000
CVTRV236 EQU   CVTRV228                                                 07826000
CVTRV235 EQU   CVTRV228                                                 07827000
CVTRV234 EQU   CVTRV228                                                 07828000
CVTRV233 EQU   CVTRV228                                                 07829000
CVTRV232 EQU   CVTRV228                                                 07830000
CVTRV231 EQU   CVTRV228                                                 07831000
CVTRV230 EQU   CVTRV228                                                 07832000
CVTRV229 EQU   CVTRV228                                                 07833000
CVTRV227 EQU   CVTRV219                                                 07834000
CVTRV226 EQU   CVTRV219                                                 07835000
CVTRV225 EQU   CVTRV219                                                 07836000
CVTRV224 EQU   CVTRV219                                                 07837000
CVTRV223 EQU   CVTRV219                                                 07838000
CVTRV222 EQU   CVTRV219                                                 07839000
CVTRV221 EQU   CVTRV219                                                 07840000
CVTRV220 EQU   CVTRV219                                                 07841000
CVTRV218 EQU   CVTRV210                                                 07842000
CVTRV217 EQU   CVTRV210                                                 07843000
CVTRV216 EQU   CVTRV210                                                 07844000
CVTRV215 EQU   CVTRV210                                                 07845000
CVTRV214 EQU   CVTRV210                                                 07846000
CVTRV213 EQU   CVTRV210                                                 07847000
CVTRV212 EQU   CVTRV210                                                 07848000
CVTRV211 EQU   CVTRV210                                                 07849000
CVTLCCAT EQU   CVTS01+420                                               07850000
CVTPCCAT EQU   CVTS01+416                                               07851000
CVTIPCRP EQU   CVTS01+412                                               07852000
CVTIPCRI EQU   CVTS01+408                                               07853000
CVTIPCDS EQU   CVTS01+404                                               07854000
CVTAIDVT EQU   CVTS01+400                                               07855000
CVTSSAP  EQU   CVTS01+396                                               07856000
CVTEHCIR EQU   CVTS01+392                                               07857000
CVTEHDEF EQU   CVTS01+388                                               07858000
CVTDAIR  EQU   CVTS01+384                                               07859000
CVTPERFM EQU   CVTS01+380                                               07860000
CVT044R2 EQU   CVTS01+376                                               07861000
CVTFETCH EQU   CVTS01+372                                               07862000
CVTRSTWD EQU   CVTS01+368                                               07863000
CVTSPOST EQU   CVTS01+364                                               07864000
CVTIOBP  EQU   CVTS01+360                                               07865000
CVTASMVT EQU   CVTS01+356                                               07866000
CVTRECRQ EQU   CVTS01+352                                               07867000
CVTWSAC  EQU   CVTS01+348                                               07868000
CVTRV149 EQU   CVTS01+344                                               07869000
CVTWSAL  EQU   CVTS01+340                                               07870000
CVTSPSA  EQU   CVTS01+336                                               07871000
CVTGLMN  EQU   CVTS01+332                                               07872000
CVTVEAC0 EQU   CVTS01+328                                               07873000
CVT062R1 EQU   CVTS01+324                                               07874000
CVTRPOST EQU   CVTS01+320                                               07875000
CVTDQIQE EQU   CVTS01+316                                               07876000
CVTCSD   EQU   CVTS01+312                                               07877000
CVTLKRMA EQU   CVTS01+308                                               07878000
CVTRSPIE EQU   CVTS01+304                                               07879000
CVTRENQ  EQU   CVTS01+300                                               07880000
CVTLQCB  EQU   CVTS01+296                                               07881000
CVTFQCB  EQU   CVTS01+292                                               07882000
CVTQCS01 EQU   CVTS01+288                                               07883000
CVTAPFT  EQU   CVTS01+284                                               07884000
CVTPARRL EQU   CVTS01+280                                               07885000
CVTVWAIT EQU   CVTS01+276                                               07886000
CVTGSPL  EQU   CVTS01+272                                               07887000
CVTLSMQ  EQU   CVTS01+268                                               07888000
CVTGSMQ  EQU   CVTS01+264                                               07889000
CVTEXPRO EQU   CVTS01+260                                               07890000
CVTOPCTP EQU   CVTS01+256                                               07891000
CVTSIC   EQU   CVTS01+252                                               07892000
CVTTPIOS EQU   CVTS01+248                                               07893000
CVTRTMS  EQU   CVTS01+244                                               07894000
CVTSDBF  EQU   CVTS01+240                                               07895000
CVTSCBP  EQU   CVTS01+236                                               07896000
CVTSDMP  EQU   CVTS01+232                                               07897000
CVTRTMCT EQU   CVTS01+224                                               07898000
CVTASCBL EQU   CVTS01+220                                               07899000
CVTASCBH EQU   CVTS01+216                                               07900000
CVTGDA   EQU   CVTS01+212                                               07901000
CVTASVT  EQU   CVTS01+208                                               07902000
CVTVVMDI EQU   CVTS01+204                                               07903000
CVTAQTOP EQU   CVTS01+200                                               07904000
CVTIOSCS EQU   CVTS01+196                                               07905000
CVTSDRM  EQU   CVTS01+192                                               07906000
CVTOPTE  EQU   CVTS01+188                                               07907000
CVTSTXU  EQU   CVTS01+184                                               07908000
CVTQUIS  EQU   CVTS01+180                                               07909000
CVTPARS  EQU   CVTS01+176                                               07910000
CVTS1EE  EQU   CVTS01+172                                               07911000
CVTFRAS  EQU   CVTS01+168                                               07912000
CVTQSAS  EQU   CVTS01+164                                               07913000
CVTCRAS  EQU   CVTS01+160                                               07914000
CVTCRMN  EQU   CVTS01+156                                               07915000
CVTDELCP EQU   CVTS01+152                                               07916000
CVTFRECL EQU   CVTS01+148                                               07917000
CVTGETCL EQU   CVTS01+144                                               07918000
CVTBLDCP EQU   CVTS01+140                                               07919000
CVTAUTHL EQU   CVTS01+136                                               07920000
CVTSCAN  EQU   CVTS01+132                                               07921000
CVTRV144 EQU   CVTS01+130                                               07922000
CVTMAXMP EQU   CVTS01+128                                               07923000
CVTSTCK  EQU   CVTS01+124                                               07924000
CVTRV139 EQU   CVTS01+123                                               07925000
CVTDSSAC EQU   CVTS01+122                                               07926000
CVTRV513 EQU   CVTS01+121                                               07927000
CVTIOSPL EQU   CVTS01+120                                               07928000
CVTPTGT  EQU   CVTS01+116                                               07929000
CVTCSPIE EQU   CVTS01+112                                               07930000
CVTSMFEX EQU   CVTS01+108                                               07931000
CVTOLT0A EQU   CVTS01+104                                               07932000
CVTSRBRT EQU   CVTS01+100                                               07933000
CVTPUTL  EQU   CVTS01+96                                                07934000
CVTASCRL EQU   CVTS01+92                                                07935000
CVTASCRF EQU   CVTS01+88                                                07936000
CVTRV326 EQU   CVTS01+84                                                07937000
CVTRV325 EQU   CVTS01+80                                                07938000
CVTRV324 EQU   CVTS01+76                                                07939000
CVT0VL01 EQU   CVTS01+72                                                07940000
CVTSHRVM EQU   CVTS01+68                                                07941000
CVTRV332 EQU   CVTS01+64                                                07942000
CVTTAS   EQU   CVTS01+60                                                07943000
CVTRSCN  EQU   CVTS01+56                                                07944000
CVTTRAC2 EQU   CVTS01+54                                                07945000
CVTTRACE EQU   CVTS01+52                                                07946000
CVTAPG   EQU   CVTS01+51                                                07947000
CVTSDTRC EQU   CVTCTLFG                                                 07948000
CVTGTRCE EQU   CVTCTLFG                                                 07949000
CVTNOMP  EQU   CVTCTLFG                                                 07950000
CVTRSV79 EQU   CVTCTLFG                                                 07951000
CVTDSTAT EQU   CVTCTLFG                                                 07952000
CVTRSV78 EQU   CVTCTLFG                                                 07953000
CVTRV333 EQU   CVTCTLFG                                                 07954000
CVTRV323 EQU   CVTCTLFG                                                 07955000
CVTSPVLK EQU   CVTS01+49                                                07956000
CVTRSV77 EQU   CVTS01+48                                                07957000
CVTRV331 EQU   CVTS01+44                                                07958000
CVTRV330 EQU   CVTS01+40                                                07959000
CVTRV329 EQU   CVTS01+36                                                07960000
CVTRV328 EQU   CVTS01+32                                                07961000
CVTRV322 EQU   CVTS01+28                                                07962000
CVTSLID  EQU   CVTSLIDA+1                                               07963000
CVTSYLK  EQU   CVTSLIDA                                                 07964000
CVTRV321 EQU   CVTS01+20                                                07965000
CVTRV320 EQU   CVTS01+16                                                07966000
CVTLPDIR EQU   CVTLPDIA+1                                               07967000
CVTRSV69 EQU   CVTDIRST                                                 07968000
CVTRSV68 EQU   CVTDIRST                                                 07969000
CVTRSV67 EQU   CVTDIRST                                                 07970000
CVTRSV66 EQU   CVTDIRST                                                 07971000
CVTRSV65 EQU   CVTDIRST                                                 07972000
CVTRSV64 EQU   CVTDIRST                                                 07973000
CVTRSV63 EQU   CVTDIRST                                                 07974000
CVTDICOM EQU   CVTDIRST                                                 07975000
CVTPVTP  EQU   CVTS01+8                                                 07976000
CVTLPDSR EQU   CVTS01+4                                                 07977000
CVTGETL  EQU   CVTS01                                                   07978000
PSARSAV  EQU   PSARSVTE+60                                              07979000
PSARSTK  EQU   PSARSVTE+56                                              07980000
PSAESAV3 EQU   PSARSVTE+52                                              07981000
PSAESTK3 EQU   PSARSVTE+48                                              07982000
PSAESAV2 EQU   PSARSVTE+44                                              07983000
PSAESTK2 EQU   PSARSVTE+40                                              07984000
PSAESAV1 EQU   PSARSVTE+36                                              07985000
PSAESTK1 EQU   PSARSVTE+32                                              07986000
PSAPSAV  EQU   PSARSVTE+28                                              07987000
PSAPSTK  EQU   PSARSVTE+24                                              07988000
PSAMSAV  EQU   PSARSVTE+20                                              07989000
PSAMSTK  EQU   PSARSVTE+16                                              07990000
PSASSAV  EQU   PSARSVTE+12                                              07991000
PSASSTK  EQU   PSARSVTE+8                                               07992000
PSANSTK  EQU   PSARSVTE+4                                               07993000
@NM00375 EQU   APESMV+6                                                 07994000
@NM00374 EQU   APESMV+4                                                 07995000
APESMVKW EQU   APESMV+2                                                 07996000
APESMVMS EQU   APESMV                                                   07997000
APESREGD EQU   APESREGS+52                                              07998000
APESREGC EQU   APESREGS+48                                              07999000
APESREGB EQU   APESREGS+44                                              08000000
APESREGA EQU   APESREGS+40                                              08001000
APESREG9 EQU   APESREGS+36                                              08002000
APESREG8 EQU   APESREGS+32                                              08003000
APESREG7 EQU   APESREGS+28                                              08004000
APESREG6 EQU   APESREGS+24                                              08005000
APESREG5 EQU   APESREGS+20                                              08006000
APESREG4 EQU   APESREGS+16                                              08007000
APESREG3 EQU   APESREGS+12                                              08008000
APESREG2 EQU   APESREGS+8                                               08009000
APESREG1 EQU   APESREGS+4                                               08010000
APESREG0 EQU   APESREGS                                                 08011000
@NM00366 EQU   CCW+5                                                    08012000
DXXXXCT  EQU   DXXXXBLK+16                                              08013000
DXXXXCUR EQU   DXXXXBLK+8                                               08014000
@NM00165 EQU   APXL+20                                                  08015000
APXLUSER EQU   APXL+4                                                   08016000
@NM00164 EQU   APVU+3040                                                08017000
@NM00163 EQU   APVUAUSE                                                 08018000
APVUMON  EQU   APVUAUSE                                                 08019000
APVUVUSE EQU   APVUAUSE                                                 08020000
APVUWORK EQU   APVU+40                                                  08021000
@NM00162 EQU   APVU+16                                                  08022000
@NM00161 EQU   APVU+14                                                  08023000
APVUANUM EQU   APVU+12                                                  08024000
APVULEN  EQU   APVUSPLN+1                                               08025000
APVUSPNO EQU   APVUSPLN                                                 08026000
APVUUSER EQU   APVU+4                                                   08027000
APVUID   EQU   APVU                                                     08028000
@NM00160 EQU   APUB+120                                                 08029000
@NM00159 EQU   APUB+112                                                 08030000
APUBJBNM EQU   APUB+104                                                 08031000
APUBSIZE EQU   APUB+102                                                 08032000
APUBRSVD EQU   APUB+100                                                 08033000
APUBASCB EQU   APUBDCB                                                  08034000
@NM00158 EQU   APUBIOFG+4                                               08035000
@NM00157 EQU   APUBIOF3                                                 08036000
APUBISHR EQU   APUBIOF3                                                 08037000
APUBIRIP EQU   APUBIOF3                                                 08038000
@NM00156 EQU   APUBIOF2                                                 08039000
APUBIEXC EQU   APUBIOF2                                                 08040000
@NM00155 EQU   APUBIOF1                                                 08041000
APUBIIPL EQU   APUBIOF1                                                 08042000
APUBIERR EQU   APUBIOF1                                                 08043000
@NM00154 EQU   APUBIOF0                                                 08044000
APUBICNL EQU   APUBIOF0                                                 08045000
APUBINRG EQU   APUBIOF0                                                 08046000
APUBIDAB EQU   APUBIOF0                                                 08047000
APUBIDWN EQU   APUBIOF0                                                 08048000
@NM00153 EQU   APUB+85                                                  08049000
@NM00152 EQU   APUBSTAT                                                 08050000
APUBQISC EQU   APUBSTAT                                                 08051000
APUBPDMP EQU   APUBSTAT                                                 08052000
APUBFDMP EQU   APUBSTAT                                                 08053000
APUBRIPL EQU   APUBSTAT                                                 08054000
@NM00151 EQU   APUBALF3                                                 08055000
APUBSCAL EQU   APUBALF3                                                 08056000
APUBSCAV EQU   APUBALF3                                                 08057000
APUBBIST EQU   APUBALF3                                                 08058000
APUBBTST EQU   APUBALF3                                                 08059000
@NM00150 EQU   APUBALF2                                                 08060000
APUBBIER EQU   APUBALF2                                                 08061000
APUBBOPT EQU   APUBALF2                                                 08062000
APUBBREQ EQU   APUBALF2                                                 08063000
APUBBYT1 EQU   APUBALF2                                                 08064000
@NM00149 EQU   APUBALF1                                                 08065000
APUBUNLP EQU   APUBALF1                                                 08066000
APUBDSBP EQU   APUBALF1                                                 08067000
APUBBERR EQU   APUBALF1                                                 08068000
APUBUNLD EQU   APUBALF1                                                 08069000
APUBDSBL EQU   APUBALF1                                                 08070000
APUBZRGN EQU   APUBALF1                                                 08071000
@NM00148 EQU   APUBALF0                                                 08072000
APUBOWN  EQU   APUBALF0                                                 08073000
APUBSBCH EQU   APUBALF0                                                 08074000
APUBCPU  EQU   APUB+78                                                  08075000
APUBINIT EQU   APUB+76                                                  08076000
APUBIPL  EQU   APUB+74                                                  08077000
APUBERRJ EQU   APUBERRS+20                                              08078000
APUBERRD EQU   APUBERRS+18                                              08079000
APUBERRC EQU   APUBERRS+16                                              08080000
APUBERRB EQU   APUBERRS+14                                              08081000
APUBERRA EQU   APUBERRS+12                                              08082000
APUBERR9 EQU   APUBERRS+10                                              08083000
APUBERR3 EQU   APUBERRS+8                                               08084000
APUBERR2 EQU   APUBERRS+6                                               08085000
APUBERR1 EQU   APUBERRS+4                                               08086000
APUBERR0 EQU   APUBERRS+2                                               08087000
@NM00147 EQU   APUBERRS                                                 08088000
@NM00146 EQU   APUB+50                                                  08089000
APUBRGN  EQU   APUB+48                                                  08090000
APUBERRT EQU   APUB+44                                                  08091000
APUBMSTP EQU   APUB+40                                                  08092000
APUBUBAP EQU   APUB+36                                                  08093000
APUBAPDS EQU   APUB+32                                                  08094000
APUBIOCT EQU   APUB+24                                                  08095000
APUBAPCT EQU   APUB+20                                                  08096000
APUBUSER EQU   APUB+16                                                  08097000
APUBNXIO EQU   APUB+12                                                  08098000
APUBMSTR EQU   APUB+8                                                   08099000
APUBAPUB EQU   APUB+4                                                   08100000
APUBID   EQU   APUB                                                     08101000
APSVWORK EQU   APSV+80                                                  08102000
@NM00145 EQU   APSV+80                                                  08103000
APSVFREE EQU   APSV+76                                                  08104000
APSVAPSM EQU   APSV+72                                                  08105000
APSVRG12 EQU   APSVREGS+56                                              08106000
APSVRG11 EQU   APSVREGS+52                                              08107000
APSVRG10 EQU   APSVREGS+48                                              08108000
APSVRG9  EQU   APSVREGS+44                                              08109000
APSVRG8  EQU   APSVREGS+40                                              08110000
APSVRG7  EQU   APSVREGS+36                                              08111000
APSVRG6  EQU   APSVREGS+32                                              08112000
APSVRG5  EQU   APSVREGS+28                                              08113000
APSVRG4  EQU   APSVREGS+24                                              08114000
APSVRG3  EQU   APSVREGS+20                                              08115000
APSVRG2  EQU   APSVREGS+16                                              08116000
APSVRG1  EQU   APSVREGS+12                                              08117000
APSVRG0  EQU   APSVREGS+8                                               08118000
APSVRG15 EQU   APSVREGS+4                                               08119000
APSVRG14 EQU   APSVREGS                                                 08120000
APSVNEXT EQU   APSV+8                                                   08121000
APSVAPSC EQU   APSV                                                     08122000
@NM00144 EQU   APSM+88                                                  08123000
APSMSAVE EQU   APSM+24                                                  08124000
@NM00143 EQU   APSM+24                                                  08125000
APSMREGS EQU   APSM+20                                                  08126000
APSMAPSV EQU   APSM+16                                                  08127000
APSMPREV EQU   APSM+12                                                  08128000
APSMNEXT EQU   APSM+8                                                   08129000
APSMSIZ1 EQU   APSMSIZE+2                                               08130000
@NM00142 EQU   APSMSIZE+1                                               08131000
APSMSPID EQU   APSMSIZE                                                 08132000
APSMID   EQU   APSM                                                     08133000
@NM00141 EQU   APSC+8                                                   08134000
APSCAPSC EQU   APSC+4                                                   08135000
APSCMXSZ EQU   APSC                                                     08136000
APMVMMSG EQU   APMVMSG+4                                                08137000
APMVMNBR EQU   APMVMSG                                                  08138000
APMVKKWD EQU   APMVKWD+4                                                08139000
APMVKNBR EQU   APMVKWD                                                  08140000
APMVHEM  EQU   APMVHDR                                                  08141000
APMFUSR  EQU   APMFI+32                                                 08142000
@NM00140 EQU   APMFI+24                                                 08143000
APMFIFXR EQU   APMFI+20                                                 08144000
APMFIERR EQU   APMFI+16                                                 08145000
APMFIFXX EQU   APMFI+12                                                 08146000
APMFIFXI EQU   APMFI+8                                                  08147000
APMFISYN EQU   APMFI+4                                                  08148000
APMFIASY EQU   APMFI                                                    08149000
@NM00139 EQU   APMFX+16                                                 08150000
@NM00138 EQU   APMFC+8                                                  08151000
APMFCDTE EQU   APMFC+4                                                  08152000
APMFCTME EQU   APMFC                                                    08153000
@NM00137 EQU   APMFO+16                                                 08154000
@NM00136 EQU   APMFO+12                                                 08155000
@NM00135 EQU   APMFO+10                                                 08156000
APMFOSTR EQU   APMFO+8                                                  08157000
APMFODTE EQU   APMFO+4                                                  08158000
APMFOTME EQU   APMFO                                                    08159000
@NM00134 EQU   APMFA+16                                                 08160000
@NM00133 EQU   APMFA+14                                                 08161000
APMFASW1 EQU   APMFASW+1                                                08162000
@NM00132 EQU   APMFASW0                                                 08163000
APMFAOWN EQU   APMFASW0                                                 08164000
APMFAUBR EQU   APMFA+8                                                  08165000
APMFAUCB EQU   APMFA+5                                                  08166000
APMFAPGF EQU   APMFA+4                                                  08167000
APMFARGN EQU   APMFA                                                    08168000
@NM00131 EQU   APMFH+56                                                 08169000
@NM00130 EQU   APMFH+54                                                 08170000
APMFHSZI EQU   APMFH+52                                                 08171000
APMFHSZH EQU   APMFH+50                                                 08172000
@NM00129 EQU   APMFH+48                                                 08173000
APMFHSW1 EQU   APMFHSWS+1                                               08174000
@NM00128 EQU   APMFHSW0                                                 08175000
APMFHIIX EQU   APMFHSW0                                                 08176000
APMFHSUB EQU   APMFH+42                                                 08177000
APMFHUID EQU   APMFH+34                                                 08178000
APMFHRDT EQU   APMFH+30                                                 08179000
APMFHRST EQU   APMFH+26                                                 08180000
APMFHJNM EQU   APMFH+18                                                 08181000
APMFHMOD EQU   APMFH+16                                                 08182000
APMFHSID EQU   APMFH+14                                                 08183000
APMFHDTE EQU   APMFH+10                                                 08184000
APMFHTME EQU   APMFH+6                                                  08185000
APMFHRTY EQU   APMFH+5                                                  08186000
APMFHVS1 EQU   APMFHSTY                                                 08187000
APMFHVS2 EQU   APMFHSTY                                                 08188000
@NM00127 EQU   APMFHSTY                                                 08189000
APMFHSEG EQU   APMFH+2                                                  08190000
APMFHSZ  EQU   APMFH                                                    08191000
@NM00123 EQU   APIO+424                                                 08192000
@NM00122 EQU   APIO+408                                                 08193000
APIOTMEE EQU   APIO+396                                                 08194000
APIOTMES EQU   APIO+392                                                 08195000
APIOXTME EQU   APIO+388                                                 08196000
APIONBRI EQU   APIONBR+2                                                08197000
@NM00121 EQU   APIOGMSZ+1                                               08198000
APIORB   EQU   APIOTR+4                                                 08199000
APIOTCB  EQU   APIOTR                                                   08200000
APIOTCSW EQU   APIOSAVE                                                 08201000
APIOSNSE EQU   APIO+256                                                 08202000
APIOACTV EQU   APIOFLG7                                                 08203000
APIOFLG6 EQU   APIOFLGB+2                                               08204000
APIOFLG5 EQU   APIOFLGB+1                                               08205000
APIOFLG4 EQU   APIOFLGB                                                 08206000
@NM00120 EQU   APIOFLG3                                                 08207000
APIOPGFS EQU   APIOFLG3                                                 08208000
APIOPGIP EQU   APIOFLG3                                                 08209000
APIORSME EQU   APIOFLG3                                                 08210000
APIORET  EQU   APIOFLG3                                                 08211000
APIONPST EQU   APIOFLG3                                                 08212000
APIOIOCT EQU   APIOFLG3                                                 08213000
@NM00119 EQU   APIOFLG2                                                 08214000
APIODMPT EQU   APIOFLG2                                                 08215000
APIOCSWT EQU   APIOFLG2                                                 08216000
APIOVINX EQU   APIOFLG2                                                 08217000
APIOVSNS EQU   APIOFLG2                                                 08218000
APIOFLG1 EQU   APIOFLGA+1                                               08219000
@NM00118 EQU   APIOFLG0                                                 08220000
APIOSU50 EQU   APIOFLG0                                                 08221000
APIOSYNC EQU   APIOFLG0                                                 08222000
@NM00117 EQU   APIO+246                                                 08223000
APIOUSER EQU   APIO+196                                                 08224000
@NM00116 EQU   APGF+16                                                  08225000
APGFINIT EQU   APGF+1                                                   08226000
@NM00115 EQU   APDX+136                                                 08227000
@NM00114 EQU   APDX+133                                                 08228000
@NM00113 EQU   APDX+132                                                 08229000
@NM00112 EQU   APDXSW1                                                  08230000
@NM00111 EQU   APDXSW0                                                  08231000
APDXSSMF EQU   APDXSW0                                                  08232000
APDXSEOT EQU   APDXSW0                                                  08233000
@NM00110 EQU   APDX+52                                                  08234000
@NM00109 EQU   APDX+50                                                  08235000
APDXNDMP EQU   APDX+48                                                  08236000
APDXDEB  EQU   APDX+44                                                  08237000
APDXAPOC EQU   APDX+40                                                  08238000
APDXDXA  EQU   APDX+36                                                  08239000
APDXSIZE EQU   APDXDXL+2                                                08240000
@NM00108 EQU   APDXDXL                                                  08241000
APDX252L EQU   APDX+24                                                  08242000
APDX000A EQU   APDX+20                                                  08243000
APDX000L EQU   APDX+16                                                  08244000
APDXAPCT EQU   APDX+8                                                   08245000
APDXUSER EQU   APDX+4                                                   08246000
APDXID   EQU   APDX                                                     08247000
@NM00107 EQU   APDS+144                                                 08248000
@NM00106 EQU   APDS+100                                                 08249000
APDSAPEP EQU   APDS+96                                                  08250000
@NM00105 EQU   APDS+94                                                  08251000
APDSSIZE EQU   APDS+92                                                  08252000
APDSJBNM EQU   APDS+84                                                  08253000
APDSITCB EQU   APDS+80                                                  08254000
APDSMSK  EQU   APDS+72                                                  08255000
@NM00104 EQU   APDS+69                                                  08256000
APDSIOFS EQU   APDS+68                                                  08257000
@NM00103 EQU   APDSFLG1                                                 08258000
APDSFRST EQU   APDSFLG1                                                 08259000
APDSSLPS EQU   APDSFLG0                                                 08260000
APDSLSR  EQU   APDSFLG0                                                 08261000
APDSIER  EQU   APDSFLG0                                                 08262000
APDSARS  EQU   APDSFLG0                                                 08263000
APDSVPER EQU   APDSFLG0                                                 08264000
APDSVLER EQU   APDSFLG0                                                 08265000
APDSTPGM EQU   APDSFLG0                                                 08266000
APDSDSAP EQU   APDS+60                                                  08267000
APDSASCB EQU   APDS+52                                                  08268000
APDSPERR EQU   APDS+40                                                  08269000
APDSLERR EQU   APDS+32                                                  08270000
APDSDDNM EQU   APDS+24                                                  08271000
APDSDEB  EQU   APDSTD+4                                                 08272000
APDSTCB  EQU   APDSTD                                                   08273000
APDSAPCT EQU   APDS+12                                                  08274000
APDSUSER EQU   APDS+8                                                   08275000
APDSAPDS EQU   APDS+4                                                   08276000
APDSID   EQU   APDS                                                     08277000
@NM00087 EQU   APCT+1556                                                08278000
APCTSVCT EQU   APCT+1552                                                08279000
APCTDAVT EQU   APCT+1548                                                08280000
APCTLOGL EQU   APCT+1544                                                08281000
@NM00086 EQU   APCT+1540                                                08282000
APCTDMPU EQU   APCT+1536                                                08283000
APCTDMPM EQU   APCT+1532                                                08284000
APCTNDMP EQU   APCT+1530                                                08285000
APCTASID EQU   APCT+1528                                                08286000
APCTLGPG EQU   APCT+1526                                                08287000
APCTLGLN EQU   APCT+1524                                                08288000
APCTABR  EQU   APCT+1116                                                08289000
APCTACTR EQU   APCT+1112                                                08290000
APCTLOGD EQU   APCT+1108                                                08291000
APCTDCLD EQU   APCT+1104                                                08292000
@NM00085 EQU   APCT+1080                                                08293000
@NM00084 EQU   APCT+1078                                                08294000
@NM00083 EQU   APCT+1068                                                08295000
APCTSTDF EQU   APCT+1056                                                08296000
APCTSTMX EQU   APCT+1052                                                08297000
APCTRGMX EQU   APCT+1048                                                08298000
APCTSIZE EQU   APCT+1046                                                08299000
APCTCTUB EQU   APCT+1045                                                08300000
APCTMFID EQU   APCT+1044                                                08301000
APCTMFSZ EQU   APCT+1040                                                08302000
APCTCRTN EQU   APCT+1036                                                08303000
APCTAPCP EQU   APCT+1032                                                08304000
APCTAMNA EQU   APCT+1028                                                08305000
APCTEMNA EQU   APCT+1024                                                08306000
APCTAALP EQU   APCT+1020                                                08307000
APCTEALP EQU   APCT+1016                                                08308000
@NM00082 EQU   APCT+1012                                                08309000
@NM00081 EQU   APCT+1008                                                08310000
@NM00080 EQU   APCT+1004                                                08311000
APCTEIPL EQU   APCT+1000                                                08312000
@NM00079 EQU   APCT+996                                                 08313000
@NM00078 EQU   APCT+992                                                 08314000
@NM00077 EQU   APCT+988                                                 08315000
@NM00076 EQU   APCT+984                                                 08316000
@NM00075 EQU   APCT+980                                                 08317000
APCTECPW EQU   APCT+976                                                 08318000
APCTEULD EQU   APCT+972                                                 08319000
APCTECPT EQU   APCT+968                                                 08320000
APCTEALC EQU   APCT+964                                                 08321000
APCTECBL EQU   APCT+960                                                 08322000
APCTECIT EQU   APCT+956                                                 08323000
APCTCQAF EQU   APCTCQAQ                                                 08324000
APCTCQL  EQU   APCTAPCQ+4                                               08325000
APCTCQF  EQU   APCTAPCQ                                                 08326000
APCTCQLK EQU   APCT+940                                                 08327000
@NM00074 EQU   @NM00070+2                                               08328000
@NM00073 EQU   APCTPRSW                                                 08329000
APCTAPST EQU   APCTPRSW                                                 08330000
@NM00072 EQU   APCTPRSW                                                 08331000
@NM00071 EQU   APCTSTAT                                                 08332000
APCTWARM EQU   APCTSTAT                                                 08333000
APCTTERM EQU   APCTSTAT                                                 08334000
APCTHALT EQU   APCTSTAT                                                 08335000
APCTQSCE EQU   APCTSTAT                                                 08336000
APCTSTRT EQU   APCTSTAT                                                 08337000
APCTACT  EQU   APCTSTAT                                                 08338000
APCTVUNX EQU   APCT+935                                                 08339000
APCTSOUT EQU   APCT+934                                                 08340000
APCTDAID EQU   APCT+933                                                 08341000
APCTSV34 EQU   APCT+932                                                 08342000
APCTMJOB EQU   APCT+928                                                 08343000
APCTTCB  EQU   APCT+924                                                 08344000
APCTASCB EQU   APCT+920                                                 08345000
APCTDCNW EQU   APCT+918                                                 08346000
APCTDCNR EQU   APCT+916                                                 08347000
@NM00069 EQU   APCT+912                                                 08348000
@NM00068 EQU   APCT+908                                                 08349000
@NM00067 EQU   APCT+904                                                 08350000
@NM00066 EQU   APCT+900                                                 08351000
@NM00065 EQU   APCTERRS+22                                              08352000
APCTERTJ EQU   APCTERRS+20                                              08353000
APCTERTD EQU   APCTERRS+18                                              08354000
APCTERTC EQU   APCTERRS+16                                              08355000
APCTERTB EQU   APCTERRS+14                                              08356000
APCTERTA EQU   APCTERRS+12                                              08357000
APCTERT9 EQU   APCTERRS+10                                              08358000
APCTERT3 EQU   APCTERRS+8                                               08359000
APCTERT2 EQU   APCTERRS+6                                               08360000
APCTERT1 EQU   APCTERRS+4                                               08361000
APCTERT0 EQU   APCTERRS+2                                               08362000
APCTERTT EQU   APCTERRS                                                 08363000
APCTDSAP EQU   APCT+872                                                 08364000
APCTISUB EQU   APCT+868                                                 08365000
APCTUBAP EQU   APCT+864                                                 08366000
APCTAPDS EQU   APCT+860                                                 08367000
APCTUBIC EQU   APCT+856                                                 08368000
APCTUBIS EQU   APCT+852                                                 08369000
APCTAPUB EQU   APCT+848                                                 08370000
APCTUBLK EQU   APCT+844                                                 08371000
APCTBR1A EQU   APCTBR14+2                                               08372000
@NM00064 EQU   APCTBR14                                                 08373000
APCTSMSZ EQU   APCTSMAD+2                                               08374000
@NM00063 EQU   APCTSMAD+1                                               08375000
@NM00062 EQU   APCTSMAD                                                 08376000
APCTSMIS EQU   APCTSMIN+2                                               08377000
@NM00061 EQU   APCTSMIN+1                                               08378000
APCTSMSP EQU   APCTSMIN                                                 08379000
@NM00060 EQU   APCT+30                                                  08380000
APCTLINE EQU   APCT+28                                                  08381000
APCTLBSZ EQU   APCT+24                                                  08382000
APCTREG  EQU   APCT+20                                                  08383000
APCTSSID EQU   APCTENQM+4                                               08384000
@NM00059 EQU   APCTENQM                                                 08385000
APCTSSVT EQU   APCT+8                                                   08386000
APCTUSER EQU   APCT+4                                                   08387000
APCTID   EQU   APCT                                                     08388000
@NM00058 EQU   APRL+80                                                  08389000
@NM00057 EQU   APRL+76                                                  08390000
APRLEMSP EQU   APRL+72                                                  08391000
APRLEMSL EQU   APRL+70                                                  08392000
APRLACTV EQU   APRL+69                                                  08393000
@NM00056 EQU   APRLEXTS                                                 08394000
APRLEXTA EQU   APRLEXTS                                                 08395000
@NM00055 EQU   APRL+60                                                  08396000
@NM00054 EQU   APRLOPT7                                                 08397000
@NM00053 EQU   APRLOPT6                                                 08398000
@NM00052 EQU   APRLOPT5                                                 08399000
@NM00051 EQU   APRLOPT4                                                 08400000
@NM00050 EQU   APRL+52                                                  08401000
@NM00049 EQU   APRL+48                                                  08402000
APRLAPRL EQU   APRL+44                                                  08403000
@NM00048 EQU   APRLOPT3                                                 08404000
@NM00047 EQU   APRLOPT2                                                 08405000
@NM00046 EQU   APRLOPT1                                                 08406000
APRLNRC  EQU   APRLOPT0                                                 08407000
@NM00045 EQU   APRLOPT0                                                 08408000
APRLASY  EQU   APRLOPT0                                                 08409000
@NM00044 EQU   APRLOPT0                                                 08410000
APRLTCB  EQU   APRL+28                                                  08411000
APRLACB  EQU   APRL+24                                                  08412000
APRLURCP EQU   APRL+20                                                  08413000
@NM00043 EQU   APRLFDBK                                                 08414000
APRLECBA EQU   APRLECB+1                                                08415000
@NM00042 EQU   APRLECBC                                                 08416000
APRLECBP EQU   APRLECBC                                                 08417000
APRLECBW EQU   APRLECBC                                                 08418000
VSLEXTRS EQU   VSLFLAG2                                                 08419000
VSLKEPRL EQU   VSLFLAG2                                                 08420000
VSLPGOUT EQU   VSLFLAG2                                                 08421000
VSLRSV3  EQU   VSLFLAG2                                                 08422000
VSLERR   EQU   VSLFLAG2                                                 08423000
VSLRAO   EQU   VSLFLAG2                                                 08424000
VSLNULL  EQU   VSLFLAG2                                                 08425000
VSLRSV2  EQU   VSLFLAG1                                                 08426000
VSLRSV1  EQU   VSLFLAG1                                                 08427000
VSLRLS   EQU   VSLFLAG1                                                 08428000
VSLOAD   EQU   VSLFLAG1                                                 08429000
VSLCONT  EQU   VSLFLAG1                                                 08430000
@NM00041 EQU   SRB+40                                                   08431000
@NM00040 EQU   SRB+38                                                   08432000
SRBPRIOR EQU   SRB+37                                                   08433000
SRBSAVE  EQU   SRB+32                                                   08434000
SRBFLNK  EQU   SRB+4                                                    08435000
IOSEND   EQU   IOSB+108                                                 08436000
IOSSKR   EQU   IOSEEKA+7                                                08437000
IOSSKH2  EQU   IOSSKHH+1                                                08438000
IOSSKH1  EQU   IOSSKHH                                                  08439000
IOSSKCC  EQU   IOSCCHH                                                  08440000
IOSSKBB  EQU   IOSEEKA+1                                                08441000
IOSSKM   EQU   IOSEEKA                                                  08442000
IOSEEK   EQU   IOSB+92                                                  08443000
IOSMDM   EQU   IOSB+91                                                  08444000
IOSMDB   EQU   IOSB+90                                                  08445000
IOSCKEY7 EQU   IOSCKEY                                                  08446000
IOSCKEY6 EQU   IOSCKEY                                                  08447000
IOSCKEY5 EQU   IOSCKEY                                                  08448000
IOSCKEY4 EQU   IOSCKEY                                                  08449000
@NM00036 EQU   IOSCKEY                                                  08450000
IOSFMSK  EQU   IOSB+88                                                  08451000
IOSCUDEV EQU   IOSPATH+1                                                08452000
@NM00035 EQU   IOSCHN                                                   08453000
IOSPATH3 EQU   IOSCHN                                                   08454000
IOSPATH2 EQU   IOSCHN                                                   08455000
IOSEXP   EQU   IOSCHN                                                   08456000
IOSGDP   EQU   IOSCHN                                                   08457000
IOSAFF   EQU   IOSB+85                                                  08458000
IOSRSS1B EQU   IOSB+84                                                  08459000
IOSPCI   EQU   IOSB+56                                                  08460000
IOSERP   EQU   IOSB+52                                                  08461000
IOSPCHN  EQU   IOSB+48                                                  08462000
IOSSNS   EQU   IOSB+42                                                  08463000
IOSAPMSK EQU   IOSB+40                                                  08464000
IOSRES4A EQU   IOSB+36                                                  08465000
IOSUSE   EQU   IOSB+32                                                  08466000
IOSCSWRC EQU   IOSCSW+5                                                 08467000
IOSTSB   EQU   IOSTATUS+1                                               08468000
IOSTSA   EQU   IOSTATUS                                                 08469000
IOSCSWCA EQU   IOSCSW                                                   08470000
IOSOPT2X EQU   IOSOPT2                                                  08471000
IOSIGP   EQU   IOSOPT2                                                  08472000
IOSHTP   EQU   IOSOPT2                                                  08473000
IOSRELSE EQU   IOSOPT                                                   08474000
IOSAPR   EQU   IOSOPT                                                   08475000
IOSNERP  EQU   IOSOPT                                                   08476000
IOSQISCE EQU   IOSOPT                                                   08477000
IOSBYP   EQU   IOSOPT                                                   08478000
IOSCOD   EQU   IOSB+13                                                  08479000
IOSPKY7  EQU   IOSPKEY                                                  08480000
IOSPGDPX EQU   IOSPKEY                                                  08481000
IOSIDR   EQU   IOSPKEY                                                  08482000
IOSLCL   EQU   IOSPKEY                                                  08483000
@NM00033 EQU   IOSPKEY                                                  08484000
IOSPRLVL EQU   IOSB+5                                                   08485000
IOSPROC  EQU   IOSB+3                                                   08486000
IOSFLC7  EQU   IOSFLC                                                   08487000
IOSCTCNR EQU   IOSFLC                                                   08488000
IOSRWAIT EQU   IOSFLC                                                   08489000
IOSTP    EQU   IOSFLC                                                   08490000
IOSCC3WE EQU   IOSFLC                                                   08491000
IOSVERIF EQU   IOSDVALT                                                 08492000
IOSDVMNT EQU   IOSFLC                                                   08493000
IOSLOG   EQU   IOSFLB                                                   08494000
IOSBDCST EQU   IOSFLB                                                   08495000
IOSMSG   EQU   IOSFLB                                                   08496000
IOSFLB4  EQU   IOSFLB                                                   08497000
IOSFLB3  EQU   IOSFLB                                                   08498000
IOSSDR   EQU   IOSFLB                                                   08499000
IOSDIESE EQU   IOSFLB                                                   08500000
IOSIOSB  EQU   IOSFLA                                                   08501000
IOSDOM   EQU   IOSFLA                                                   08502000
IOSEX    EQU   IOSFLA                                                   08503000
IOSSMDB  EQU   IOSFLA                                                   08504000
IOSSMDA  EQU   IOSFLA                                                   08505000
IOSERR   EQU   IOSFLA                                                   08506000
DEBXSAMB EQU   DEBXTN+28                                                08507000
DEBXOPNJ EQU   DEBXTN+24                                                08508000
DEBXXARG EQU   DEBXTN+20                                                08509000
DEBXMCF2 EQU   DEBXTN+19                                                08510000
DEBXMCF1 EQU   DEBXTN+18                                                08511000
DEBXDSO2 EQU   DEBXTN+17                                                08512000
DEBXDSO1 EQU   DEBXTN+16                                                08513000
DEBXDBPR EQU   DEBXTN+12                                                08514000
DEBXDCBM EQU   DEBXTN+8                                                 08515000
DEBXDSAB EQU   DEBXTN+4                                                 08516000
DEBXRV48 EQU   DEBXTN+3                                                 08517000
DEBXRV47 EQU   DEBXFLG1                                                 08518000
DEBXRV46 EQU   DEBXFLG1                                                 08519000
DEBXRV45 EQU   DEBXFLG1                                                 08520000
DEBXRV44 EQU   DEBXFLG1                                                 08521000
DEBXRV43 EQU   DEBXFLG1                                                 08522000
DEBXDSSI EQU   DEBXFLG1                                                 08523000
DEBXTSKC EQU   DEBXFLG1                                                 08524000
DEBXCDCB EQU   DEBXFLG1                                                 08525000
DEBXLNGH EQU   DEBXTN                                                   08526000
DEBTBLOF EQU   DEBPREFX+14                                              08527000
DEBAMTYP EQU   DEBPREFX+13                                              08528000
DEBLNGTH EQU   DEBPREFX+12                                              08529000
DEBDCBMK EQU   DEBXTNP                                                  08530000
DEBDSCBA EQU   DEBPREFX+1                                               08531000
DEBWKARA EQU   DEBPREFX                                                 08532000
DEBXCEAD EQU   DEBXCEA+1                                                08533000
DEBXCENP EQU   DEBXCEAB                                                 08534000
DEBRSV35 EQU   DEBXCEAB                                                 08535000
DEBRSV34 EQU   DEBXCEAB                                                 08536000
DEBRSV33 EQU   DEBXCEAB                                                 08537000
DEBRSV32 EQU   DEBXCEAB                                                 08538000
DEBCEAD  EQU   DEBCEA+1                                                 08539000
DEBCENP  EQU   DEBCEAB                                                  08540000
DEBRSV31 EQU   DEBCEAB                                                  08541000
DEBRSV30 EQU   DEBCEAB                                                  08542000
DEBRSV29 EQU   DEBCEAB                                                  08543000
DEBRSV28 EQU   DEBCEAB                                                  08544000
DEBPCIAD EQU   DEBPCIA+1                                                08545000
DEBPCINP EQU   DEBPCIAB                                                 08546000
DEBRSV27 EQU   DEBPCIAB                                                 08547000
DEBRSV26 EQU   DEBPCIAB                                                 08548000
DEBRSV25 EQU   DEBPCIAB                                                 08549000
DEBRSV24 EQU   DEBPCIAB                                                 08550000
DEBSIOAD EQU   DEBSIOA+1                                                08551000
DEBSIONP EQU   DEBSIOAB                                                 08552000
DEBFIX   EQU   DEBSIOAB                                                 08553000
DEBIOVR  EQU   DEBSIOAB                                                 08554000
DEBSIOX  EQU   DEBSIOAB                                                 08555000
DEBPGFX  EQU   DEBSIOAB                                                 08556000
DEBEOEAD EQU   DEBEOEA+1                                                08557000
DEBEOENP EQU   DEBEOEAB                                                 08558000
DEBRSV22 EQU   DEBEOEAB                                                 08559000
DEBRSV21 EQU   DEBEOEAB                                                 08560000
DEBRSV20 EQU   DEBEOEAB                                                 08561000
DEBESMVR EQU   DEBEOEAB                                                 08562000
DEBSUBID EQU   DEBSUBNM                                                 08563000
DEBSIOA2 EQU   DEBACS08+24                                              08564000
DEBRPSIO EQU   DEBACS08+20                                              08565000
DEBFREED EQU   DEBACS08+16                                              08566000
@NM00032 EQU   DEBACS08+12                                              08567000
@NM00031 EQU   DEBACS08+8                                               08568000
DEBDISAD EQU   DEBACS08+4                                               08569000
@NM00030 EQU   DEBACS08                                                 08570000
DEBRPSST EQU   DEBACS07+64                                              08571000
DEBARECK EQU   DEBACS07+60                                              08572000
DEBAREWT EQU   DEBACS07+56                                              08573000
DEBACHK  EQU   DEBACS07+52                                              08574000
DEBAWRIT EQU   DEBACS07+48                                              08575000
DEBASETL EQU   DEBACS07+44                                              08576000
DEBAREAD EQU   DEBACS07+40                                              08577000
DEBCRECK EQU   DEBACS07+36                                              08578000
DEBCREWT EQU   DEBACS07+32                                              08579000
DEBCCHK  EQU   DEBACS07+28                                              08580000
DEBCWRIT EQU   DEBACS07+24                                              08581000
DEBCSETL EQU   DEBACS07+20                                              08582000
DEBCREAD EQU   DEBACS07+16                                              08583000
DEBWKPT5 EQU   DEBACS07+12                                              08584000
DEBWKPT4 EQU   DEBACS07+8                                               08585000
DEBGET   EQU   DEBACS07+4                                               08586000
@NM00029 EQU   DEBACS07                                                 08587000
DEBPUT   EQU   DEBACS06+4                                               08588000
DEBDCBFA EQU   DEBACS06                                                 08589000
DEBLUCBB EQU   DEBLUCBA+1                                               08590000
DEBRSV18 EQU   DEBLUCBA                                                 08591000
DEBFUCBB EQU   DEBFUCBA+1                                               08592000
DEBRSV17 EQU   DEBFUCBA                                                 08593000
DEBTCCWB EQU   DEBTCCWA+1                                               08594000
DEBRSV16 EQU   DEBTCCWA                                                 08595000
DEBTBFRB EQU   DEBTBFRA+1                                               08596000
DEBRSV15 EQU   DEBTBFRA                                                 08597000
DEBDBPEF EQU   DEBACS03+8                                               08598000
DEBDBPP  EQU   DEBACS03+4                                               08599000
DEBDTPP  EQU   DEBACS03                                                 08600000
DEBDBPE  EQU   DEBDBLK+1                                                08601000
DEBDBPT  EQU   DEBDBLK                                                  08602000
DEBEXTNM EQU   DEBDSNAM                                                 08603000
DEBLRECL EQU   DEBACSMD+14                                              08604000
DEBBLKSI EQU   DEBACSMD+12                                              08605000
DEBRSV14 EQU   DEBDSNM+4                                                08606000
DEBUTSAB EQU   DEBUTSAA+1                                               08607000
DEBRSV13 EQU   DEBUTSAA                                                 08608000
DEBVOLNM EQU   DEBACSMD+2                                               08609000
DEBVLSEQ EQU   DEBVOLSQ+1                                               08610000
DEBRSV42 EQU   DEBVOLBT                                                 08611000
DEBRSV41 EQU   DEBVOLBT                                                 08612000
DEBRSV40 EQU   DEBVOLBT                                                 08613000
DEBRSV39 EQU   DEBVOLBT                                                 08614000
DEBRSV38 EQU   DEBVOLBT                                                 08615000
DEBRSV37 EQU   DEBVOLBT                                                 08616000
DEBRSV36 EQU   DEBVOLBT                                                 08617000
DEBEXFUL EQU   DEBVOLBT                                                 08618000
DEBNMTRK EQU   DEBDASD+14                                               08619000
DEBENDHH EQU   DEBDASD+12                                               08620000
DEBENDCC EQU   DEBDASD+10                                               08621000
DEBSTRHH EQU   DEBDASD+8                                                08622000
DEBSTRCC EQU   DEBDASD+6                                                08623000
DEBBINUM EQU   DEBDASD+4                                                08624000
DEBUCBA  EQU   DEBUCBAD+1                                               08625000
DEBDVMOD EQU   DEBUCBAD                                                 08626000
DEBAPPB  EQU   DEBAPPAD+1                                               08627000
DEBEXSCL EQU   DEBAPPAD                                                 08628000
DEBDCBB  EQU   DEBDCBAD+1                                               08629000
DEBDEBID EQU   DEBPROTG                                                 08630000
DEBECBB  EQU   DEBECBAD+1                                               08631000
DEBPRIOR EQU   DEBECBAD                                                 08632000
DEBUSRPB EQU   DEBUSRPG+1                                               08633000
DEBNMEXT EQU   DEBUSRPG                                                 08634000
DEBRSV05 EQU   DEBBASIC+15                                              08635000
DEBXTNIN EQU   DEBFLGS1                                                 08636000
DEBAPFIN EQU   DEBFLGS1                                                 08637000
DEBF1CEV EQU   DEBFLGS1                                                 08638000
DEBCINDI EQU   DEBFLGS1                                                 08639000
DEBRSV02 EQU   DEBFLGS1                                                 08640000
DEBRSIOA EQU   DEBFLGS1                                                 08641000
DEBEOFDF EQU   DEBFLGS1                                                 08642000
DEBPWCKD EQU   DEBFLGS1                                                 08643000
DEBQSCNT EQU   DEBBASIC+13                                              08644000
DEBACCS  EQU   DEBOPATB                                                 08645000
DEBPOSIT EQU   DEBOPATB                                                 08646000
DEBZERO  EQU   DEBOPATB                                                 08647000
DEBABEND EQU   DEBOPATB                                                 08648000
DEBIRBB  EQU   DEBIRBAD+1                                               08649000
DEBRERR  EQU   DEBOFLGS                                                 08650000
DEBLABEL EQU   DEBOFLGS                                                 08651000
DEBSPLIT EQU   DEBOFLGS                                                 08652000
DEBDCB   EQU   DEBOFLGS                                                 08653000
DEBRLSE  EQU   DEBOFLGS                                                 08654000
DEBEOF   EQU   DEBOFLGS                                                 08655000
DEBDISP  EQU   DEBOFLGS                                                 08656000
DEBDEBB  EQU   DEBDEBAD+1                                               08657000
DEBAMLNG EQU   DEBDEBAD                                                 08658000
DEBNMSUB EQU   DEBTCBAD                                                 08659000
ASCBEND  EQU   ASCB+208                                                 08660000
ASCBSRBT EQU   ASCB+200                                                 08661000
ASCBSWTL EQU   ASCB+196                                                 08662000
ASCBRS14 EQU   ASCB+195                                                 08663000
ASCBSMCT EQU   ASCB+194                                                 08664000
ASCBRS12 EQU   ASCB+192                                                 08665000
ASCBPCTT EQU   ASCB+188                                                 08666000
ASCBVGTT EQU   ASCB+184                                                 08667000
ASCBRV43 EQU   ASCBSRQ4                                                 08668000
ASCBRV42 EQU   ASCBSRQ4                                                 08669000
ASCBRV41 EQU   ASCBSRQ4                                                 08670000
ASCBRV40 EQU   ASCBSRQ4                                                 08671000
ASCBRV39 EQU   ASCBSRQ4                                                 08672000
ASCBRV38 EQU   ASCBSRQ4                                                 08673000
ASCBRV37 EQU   ASCBSRQ4                                                 08674000
ASCBRV36 EQU   ASCBSRQ4                                                 08675000
ASCBRV35 EQU   ASCBSRQ3                                                 08676000
ASCBRV34 EQU   ASCBSRQ3                                                 08677000
ASCBRV33 EQU   ASCBSRQ3                                                 08678000
ASCBRV32 EQU   ASCBSRQ3                                                 08679000
ASCBRV31 EQU   ASCBSRQ3                                                 08680000
ASCBRV30 EQU   ASCBSRQ3                                                 08681000
ASCBRV29 EQU   ASCBSRQ3                                                 08682000
ASCBRV28 EQU   ASCBSRQ3                                                 08683000
ASCBRV27 EQU   ASCBSRQ2                                                 08684000
ASCBRV26 EQU   ASCBSRQ2                                                 08685000
ASCBRV25 EQU   ASCBSRQ2                                                 08686000
ASCBRV24 EQU   ASCBSRQ2                                                 08687000
ASCBRV23 EQU   ASCBSRQ2                                                 08688000
ASCBRV22 EQU   ASCBSRQ2                                                 08689000
ASCBRV21 EQU   ASCBSRQ2                                                 08690000
ASCBRV20 EQU   ASCBSRQ2                                                 08691000
ASCBRV19 EQU   ASCBSRQ1                                                 08692000
ASCBRV18 EQU   ASCBSRQ1                                                 08693000
ASCBRV17 EQU   ASCBSRQ1                                                 08694000
ASCBRV16 EQU   ASCBSRQ1                                                 08695000
ASCBRV15 EQU   ASCBSRQ1                                                 08696000
ASCBRV14 EQU   ASCBSRQ1                                                 08697000
ASCBRV13 EQU   ASCBSRQ1                                                 08698000
ASCBSTA  EQU   ASCBSRQ1                                                 08699000
ASCBJBNS EQU   ASCB+176                                                 08700000
ASCBJBNI EQU   ASCB+172                                                 08701000
ASCBMCC  EQU   ASCB+168                                                 08702000
ASCBRTWA EQU   ASCB+164                                                 08703000
ASCBIQEA EQU   ASCB+160                                                 08704000
ASCBXMPQ EQU   ASCB+156                                                 08705000
ASCBRS01 EQU   ASCB+154                                                 08706000
ASCBFMCT EQU   ASCB+152                                                 08707000
ASCBOUXB EQU   ASCB+148                                                 08708000
ASCBOUCB EQU   ASCB+144                                                 08709000
ASCBMECB EQU   ASCB+140                                                 08710000
ASCBQECB EQU   ASCB+136                                                 08711000
ASCBLSQH EQU   ASCBLKGP+4                                               08712000
ASCBLOCK EQU   ASCBLKGP                                                 08713000
ASCBTCBS EQU   ASCB+124                                                 08714000
ASCBNVSC EQU   ASCB+122                                                 08715000
ASCBVSC  EQU   ASCB+120                                                 08716000
ASCBSRBS EQU   ASCB+118                                                 08717000
ASCBSSRB EQU   ASCB+116                                                 08718000
ASCBRV06 EQU   ASCBFLG2                                                 08719000
ASCBRV05 EQU   ASCBFLG2                                                 08720000
ASCBRV04 EQU   ASCBFLG2                                                 08721000
ASCBSNQS EQU   ASCBFLG2                                                 08722000
ASCBS2S  EQU   ASCBFLG2                                                 08723000
ASCBCEXT EQU   ASCBFLG2                                                 08724000
ASCBPXMT EQU   ASCBFLG2                                                 08725000
ASCBXMPT EQU   ASCBFLG2                                                 08726000
ASCBRF07 EQU   ASCBDSP1                                                 08727000
ASCBRF06 EQU   ASCBDSP1                                                 08728000
ASCBRF05 EQU   ASCBDSP1                                                 08729000
ASCBRF04 EQU   ASCBDSP1                                                 08730000
ASCBRF03 EQU   ASCBDSP1                                                 08731000
ASCBRF02 EQU   ASCBDSP1                                                 08732000
ASCBFAIL EQU   ASCBDSP1                                                 08733000
ASCBNOQ  EQU   ASCBDSP1                                                 08734000
ASCBSWCT EQU   ASCB+112                                                 08735000
ASCBASXB EQU   ASCB+108                                                 08736000
ASCBTMCH EQU   ASCB+104                                                 08737000
ASCBNSWP EQU   ASCBFLG1                                                 08738000
ASCBTYP1 EQU   ASCBFLG1                                                 08739000
ASCBSTND EQU   ASCBFLG1                                                 08740000
ASCBABNT EQU   ASCBFLG1                                                 08741000
ASCBTERM EQU   ASCBFLG1                                                 08742000
ASCBS3S  EQU   ASCBFLG1                                                 08743000
ASCBCMSH EQU   ASCBFLG1                                                 08744000
ASCBTOFF EQU   ASCBFLG1                                                 08745000
ASCBRF01 EQU   ASCBRCTF                                                 08746000
ASCBTMLW EQU   ASCBRCTF                                                 08747000
ASCBOUT  EQU   ASCBRCTF                                                 08748000
ASCBWAIT EQU   ASCBRCTF                                                 08749000
ASCBRV08 EQU   ASCBRCTF                                                 08750000
ASCBFQU  EQU   ASCBRCTF                                                 08751000
ASCBFRS  EQU   ASCBRCTF                                                 08752000
ASCBTMNO EQU   ASCBRCTF                                                 08753000
ASCBDUMP EQU   ASCB+96                                                  08754000
ASCBRV44 EQU   ASCB+92                                                  08755000
ASCBUBET EQU   ASCB+88                                                  08756000
ASCBECB  EQU   ASCB+84                                                  08757000
ASCBJSTL EQU   ASCB+80                                                  08758000
ASCBEWST EQU   ASCB+72                                                  08759000
ASCBEJST EQU   ASCB+64                                                  08760000
ASCBTSB  EQU   ASCB+60                                                  08761000
ASCBCSCB EQU   ASCB+56                                                  08762000
ASCBRSMA EQU   ASCBRSM+1                                                08763000
ASCBRV54 EQU   ASCBRSMF                                                 08764000
ASCBRV53 EQU   ASCBRSMF                                                 08765000
ASCBRV52 EQU   ASCBRSMF                                                 08766000
ASCBRV51 EQU   ASCBRSMF                                                 08767000
ASCBVEQR EQU   ASCBRSMF                                                 08768000
ASCBN2LP EQU   ASCBRSMF                                                 08769000
ASCB1LPU EQU   ASCBRSMF                                                 08770000
ASCB2LPU EQU   ASCBRSMF                                                 08771000
ASCBLDA  EQU   ASCB+48                                                  08772000
ASCBSTOR EQU   ASCB+44                                                  08773000
ASCBDP   EQU   ASCB+43                                                  08774000
ASCBRV07 EQU   ASCB+42                                                  08775000
ASCBIOSM EQU   ASCB+40                                                  08776000
ASCBSEQN EQU   ASCB+38                                                  08777000
ASCBCPUS EQU   ASCB+32                                                  08778000
ASCBSPL  EQU   ASCB+28                                                  08779000
ASCBIOSP EQU   ASCB+24                                                  08780000
ASCBSYNC EQU   ASCBSUPC+4                                               08781000
ASCBSVRB EQU   ASCBSUPC                                                 08782000
ASCBCMSF EQU   ASCB+12                                                  08783000
ASCBBWDP EQU   ASCB+8                                                   08784000
ASCBFWDP EQU   ASCB+4                                                   08785000
ASCBASCB EQU   ASCB                                                     08786000
ASCBEGIN EQU   ASCB                                                     08787000
IOCOEND  EQU   IOCOM+128                                                08788000
IOCPATCH EQU   IOCOM+124                                                08789000
IOCUCBBM EQU   IOCOM+120                                                08790000
IOCQCNT  EQU   IOCOM+116                                                08791000
IOCIOSDQ EQU   IOCOM+112                                                08792000
IOCIOSEQ EQU   IOCOM+108                                                08793000
IOCSVCF  EQU   IOCOM+104                                                08794000
IOCTCCW  EQU   IOCOM+100                                                08795000
IOCRSVTB EQU   IOCOM+96                                                 08796000
IOCMFCNT EQU   IOCOM+92                                                 08797000
IOCMFHK  EQU   IOCOM+88                                                 08798000
IOCGENA  EQU   IOCOM+84                                                 08799000
IOCCCH   EQU   IOCOM+80                                                 08800000
IOCASYNQ EQU   IOCOM+76                                                 08801000
IOCLCHTB EQU   IOCOM+72                                                 08802000
IOCATTBL EQU   IOCOM+68                                                 08803000
IOCOMEX  EQU   IOCOM+64                                                 08804000
IOCSYNCH EQU   IOCOM+56                                                 08805000
IOCCATLK EQU   IOCOM+48                                                 08806000
IOCIOSCP EQU   IOCOM+40                                                 08807000
IOCORMGT EQU   IOCOM+36                                                 08808000
IOCVOID  EQU   IOCOM+32                                                 08809000
IOCSTIO  EQU   IOCOM+28                                                 08810000
IOCSCOMP EQU   IOCOM+24                                                 08811000
IOCHD160 EQU   IOCOM+20                                                 08812000
IOCINT   EQU   IOCOM+16                                                 08813000
IOCCTBL  EQU   IOCOM+12                                                 08814000
IOCHIO   EQU   IOCOM+8                                                  08815000
IOCPST   EQU   IOCOM+4                                                  08816000
IOCPGCT  EQU   IOCOM+2                                                  08817000
IOCVOICT EQU   IOCOM                                                    08818000
SURV104  EQU   SUBITS+13                                                08819000
SURV103  EQU   SUBYTE13                                                 08820000
SURV102  EQU   SUBYTE13                                                 08821000
SURV101  EQU   SUBYTE13                                                 08822000
SU100BT  EQU   SUBYTE13                                                 08823000
SU99BIT  EQU   SUBYTE13                                                 08824000
SU98BIT  EQU   SUBYTE13                                                 08825000
SU97BIT  EQU   SUBYTE13                                                 08826000
SU96BIT  EQU   SUBYTE13                                                 08827000
SU95BIT  EQU   SUBYTE12                                                 08828000
SU94BIT  EQU   SUBYTE12                                                 08829000
SU93BIT  EQU   SUBYTE12                                                 08830000
SU92BIT  EQU   SUBYTE12                                                 08831000
SU91BIT  EQU   SUBYTE12                                                 08832000
SU90BIT  EQU   SUBYTE12                                                 08833000
SU89BIT  EQU   SUBYTE12                                                 08834000
SU88BIT  EQU   SUBYTE12                                                 08835000
SU87BIT  EQU   SUBYTE11                                                 08836000
SU86BIT  EQU   SUBYTE11                                                 08837000
SU85BIT  EQU   SUBYTE11                                                 08838000
SU84BIT  EQU   SUBYTE11                                                 08839000
SU83BIT  EQU   SUBYTE11                                                 08840000
SU82BIT  EQU   SUBYTE11                                                 08841000
SU81BIT  EQU   SUBYTE11                                                 08842000
SU80BIT  EQU   SUBYTE11                                                 08843000
SU79BIT  EQU   SUBYTE10                                                 08844000
SU78BIT  EQU   SUBYTE10                                                 08845000
SU77BIT  EQU   SUBYTE10                                                 08846000
SU76BIT  EQU   SUBYTE10                                                 08847000
SU75BIT  EQU   SUBYTE10                                                 08848000
SU74BIT  EQU   SUBYTE10                                                 08849000
SU73BIT  EQU   SUBYTE10                                                 08850000
SU72BIT  EQU   SUBYTE10                                                 08851000
SU71BIT  EQU   SUBYTE9                                                  08852000
SU70BIT  EQU   SUBYTE9                                                  08853000
SU69BIT  EQU   SUBYTE9                                                  08854000
SU68BIT  EQU   SUBYTE9                                                  08855000
SU67BIT  EQU   SUBYTE9                                                  08856000
SU66BIT  EQU   SUBYTE9                                                  08857000
SU65BIT  EQU   SUBYTE9                                                  08858000
SU64BIT  EQU   SUBYTE9                                                  08859000
SU63BIT  EQU   SUBYTE8                                                  08860000
SU62BIT  EQU   SUBYTE8                                                  08861000
SU61BIT  EQU   SUBYTE8                                                  08862000
SU60BIT  EQU   SUBYTE8                                                  08863000
SU59BIT  EQU   SUBYTE8                                                  08864000
SU58BIT  EQU   SUBYTE8                                                  08865000
SU57BIT  EQU   SUBYTE8                                                  08866000
SU56BIT  EQU   SUBYTE8                                                  08867000
SU55BIT  EQU   SUBYTE7                                                  08868000
SU54BIT  EQU   SUBYTE7                                                  08869000
SU53BIT  EQU   SUBYTE7                                                  08870000
SU52BIT  EQU   SUBYTE7                                                  08871000
SU51BIT  EQU   SUBYTE7                                                  08872000
SU50BIT  EQU   SUBYTE7                                                  08873000
SU49BIT  EQU   SUBYTE7                                                  08874000
SU48BIT  EQU   SUBYTE7                                                  08875000
SU47BIT  EQU   SUBYTE6                                                  08876000
SU46BIT  EQU   SUBYTE6                                                  08877000
SU45BIT  EQU   SUBYTE6                                                  08878000
SU44BIT  EQU   SUBYTE6                                                  08879000
SU43BIT  EQU   SUBYTE6                                                  08880000
SU42BIT  EQU   SUBYTE6                                                  08881000
SU41BIT  EQU   SUBYTE6                                                  08882000
SU40BIT  EQU   SUBYTE6                                                  08883000
SU39BIT  EQU   SUBYTE5                                                  08884000
SU38BIT  EQU   SUBYTE5                                                  08885000
SU37BIT  EQU   SUBYTE5                                                  08886000
SU36BIT  EQU   SUBYTE5                                                  08887000
SU35BIT  EQU   SUBYTE5                                                  08888000
SU34BIT  EQU   SUBYTE5                                                  08889000
SU33BIT  EQU   SUBYTE5                                                  08890000
SU32BIT  EQU   SUBYTE5                                                  08891000
SU31BIT  EQU   SUBYTE4                                                  08892000
SU30BIT  EQU   SUBYTE4                                                  08893000
SU29BIT  EQU   SUBYTE4                                                  08894000
SU28BIT  EQU   SUBYTE4                                                  08895000
SU27BIT  EQU   SUBYTE4                                                  08896000
SU26BIT  EQU   SUBYTE4                                                  08897000
SU25BIT  EQU   SUBYTE4                                                  08898000
SU24BIT  EQU   SUBYTE4                                                  08899000
SU23BIT  EQU   SUBYTE3                                                  08900000
SU22BIT  EQU   SUBYTE3                                                  08901000
SU21BIT  EQU   SUBYTE3                                                  08902000
SU20BIT  EQU   SUBYTE3                                                  08903000
SU19BIT  EQU   SUBYTE3                                                  08904000
SU18BIT  EQU   SUBYTE3                                                  08905000
SU17BIT  EQU   SUBYTE3                                                  08906000
SU16BIT  EQU   SUBYTE3                                                  08907000
SU15BIT  EQU   SUBYTE2                                                  08908000
SU14BIT  EQU   SUBYTE2                                                  08909000
SU13BIT  EQU   SUBYTE2                                                  08910000
SU12BIT  EQU   SUBYTE2                                                  08911000
SU11BIT  EQU   SUBYTE2                                                  08912000
SU10BIT  EQU   SUBYTE2                                                  08913000
SU9BIT   EQU   SUBYTE2                                                  08914000
SU8BIT   EQU   SUBYTE2                                                  08915000
SU7BIT   EQU   SUBYTE1                                                  08916000
SU6BIT   EQU   SUBYTE1                                                  08917000
SU5BIT   EQU   SUBYTE1                                                  08918000
SU4BIT   EQU   SUBYTE1                                                  08919000
SU3BIT   EQU   SUBYTE1                                                  08920000
SU2BIT   EQU   SUBYTE1                                                  08921000
SU1BIT   EQU   SUBYTE1                                                  08922000
SU0BIT   EQU   SUBYTE1                                                  08923000
@NM00028 EQU   FRRSFLGS+1                                               08924000
@NM00027 EQU   FRRSFLG1                                                 08925000
FRRSNEST EQU   FRRSFLG1                                                 08926000
FRRSRCUR EQU   FRRSFLG1                                                 08927000
FRRSENTS EQU   FRRS+84                                                  08928000
FRRSRTMW EQU   FRRS+16                                                  08929000
CVTLEVL  EQU   CVTRELNO+2                                               08930000
CVTNUMB  EQU   CVTRELNO                                                 08931000
CVTMDL   EQU   CVTFIX+250                                               08932000
@NM00026 EQU   CVTFIX+248                                               08933000
@NM00025 EQU   CVTFIX                                                   08934000
CVTRV482 EQU   CVTXTNT2+128                                             08935000
CVTRV481 EQU   CVTXTNT2+124                                             08936000
CVTRV480 EQU   CVTXTNT2+120                                             08937000
CVTRV479 EQU   CVTXTNT2+118                                             08938000
CVTRV478 EQU   CVTXTNT2+117                                             08939000
CVTRV477 EQU   CVTXTNT2+116                                             08940000
CVTRV476 EQU   CVTXTNT2+115                                             08941000
CVTRV475 EQU   CVTXTNT2+114                                             08942000
CVTRV474 EQU   CVTRV466                                                 08943000
CVTRV473 EQU   CVTRV466                                                 08944000
CVTRV472 EQU   CVTRV466                                                 08945000
CVTRV471 EQU   CVTRV466                                                 08946000
CVTRV470 EQU   CVTRV466                                                 08947000
CVTRV469 EQU   CVTRV466                                                 08948000
CVTRV468 EQU   CVTRV466                                                 08949000
CVTRV467 EQU   CVTRV466                                                 08950000
CVTRV465 EQU   CVTRV457                                                 08951000
CVTRV464 EQU   CVTRV457                                                 08952000
CVTRV463 EQU   CVTRV457                                                 08953000
CVTRV462 EQU   CVTRV457                                                 08954000
CVTRV461 EQU   CVTRV457                                                 08955000
CVTRV460 EQU   CVTRV457                                                 08956000
CVTRV459 EQU   CVTRV457                                                 08957000
CVTRV458 EQU   CVTRV457                                                 08958000
CVTRV456 EQU   CVTXTNT2+108                                             08959000
CVTRV455 EQU   CVTXTNT2+104                                             08960000
CVTRV454 EQU   CVTXTNT2+100                                             08961000
CVTRV453 EQU   CVTXTNT2+96                                              08962000
CVTRV452 EQU   CVTXTNT2+94                                              08963000
CVTRV451 EQU   CVTXTNT2+92                                              08964000
CVTRV450 EQU   CVTXTNT2+90                                              08965000
CVTRV449 EQU   CVTXTNT2+88                                              08966000
CVTRV448 EQU   CVTXTNT2+87                                              08967000
CVTRV447 EQU   CVTXTNT2+86                                              08968000
CVTRV446 EQU   CVTRV438                                                 08969000
CVTRV445 EQU   CVTRV438                                                 08970000
CVTRV444 EQU   CVTRV438                                                 08971000
CVTRV443 EQU   CVTRV438                                                 08972000
CVTRV442 EQU   CVTRV438                                                 08973000
CVTRV441 EQU   CVTRV438                                                 08974000
CVTRV440 EQU   CVTRV438                                                 08975000
CVTRV439 EQU   CVTRV438                                                 08976000
CVTRV437 EQU   CVTRV429                                                 08977000
CVTRV436 EQU   CVTRV429                                                 08978000
CVTRV435 EQU   CVTRV429                                                 08979000
CVTRV434 EQU   CVTRV429                                                 08980000
CVTRV433 EQU   CVTRV429                                                 08981000
CVTRV432 EQU   CVTRV429                                                 08982000
CVTRV431 EQU   CVTRV429                                                 08983000
CVTRV430 EQU   CVTRV429                                                 08984000
CVTRV428 EQU   CVTXTNT2+80                                              08985000
CVTRV427 EQU   CVTXTNT2+76                                              08986000
CVTRV426 EQU   CVTXTNT2+72                                              08987000
CVTRV425 EQU   CVTXTNT2+68                                              08988000
CVTATACT EQU   CVTATCVT                                                 08989000
CVTRV423 EQU   CVTXTNT2+62                                              08990000
CVTRV422 EQU   CVTXTNT2+60                                              08991000
CVTRV421 EQU   CVTXTNT2+58                                              08992000
CVTRV420 EQU   CVTXTNT2+56                                              08993000
CVTRV419 EQU   CVTXTNT2+55                                              08994000
CVTRV418 EQU   CVTXTNT2+54                                              08995000
CVTRV417 EQU   CVTRV409                                                 08996000
CVTRV416 EQU   CVTRV409                                                 08997000
CVTRV415 EQU   CVTRV409                                                 08998000
CVTRV414 EQU   CVTRV409                                                 08999000
CVTRV413 EQU   CVTRV409                                                 09000000
CVTRV412 EQU   CVTRV409                                                 09001000
CVTRV411 EQU   CVTRV409                                                 09002000
CVTRV410 EQU   CVTRV409                                                 09003000
CVTRV408 EQU   CVTRV400                                                 09004000
CVTRV407 EQU   CVTRV400                                                 09005000
CVTRV406 EQU   CVTRV400                                                 09006000
CVTRV405 EQU   CVTRV400                                                 09007000
CVTRV404 EQU   CVTRV400                                                 09008000
CVTRV403 EQU   CVTRV400                                                 09009000
CVTRV402 EQU   CVTRV400                                                 09010000
CVTRV401 EQU   CVTRV400                                                 09011000
CVTICB   EQU   CVTXTNT2+48                                              09012000
CVTSKTA  EQU   CVTXTNT2+44                                              09013000
CVTRSV99 EQU   CVTXTNT2+40                                              09014000
CVTRSV98 EQU   CVTXTNT2+36                                              09015000
CVTRSV97 EQU   CVTXTNT2+34                                              09016000
CVTRSV96 EQU   CVTXTNT2+32                                              09017000
CVTOLTEP EQU   CVTXTNT2+28                                              09018000
CVTQIDA  EQU   CVTQID+1                                                 09019000
CVTRSV95 EQU   CVTQID                                                   09020000
CVTRSV94 EQU   CVTXTNT2+20                                              09021000
CVTRSV93 EQU   CVTXTNT2+16                                              09022000
CVTRSV92 EQU   CVTXTNT2+12                                              09023000
CVTRSV91 EQU   CVTXTNT2+6                                               09024000
CVTRSV9H EQU   CVTFLGBT                                                 09025000
CVTRSV9G EQU   CVTFLGBT                                                 09026000
CVTRSV9F EQU   CVTFLGBT                                                 09027000
CVTRSV9E EQU   CVTFLGBT                                                 09028000
CVTRSV9D EQU   CVTFLGBT                                                 09029000
CVTRSV9C EQU   CVTFLGBT                                                 09030000
CVTVME   EQU   CVTFLGBT                                                 09031000
CVTNPE   EQU   CVTFLGBT                                                 09032000
CVTNUCLS EQU   CVTXTNT2+4                                               09033000
CVTDSSVA EQU   CVTDSSV+1                                                09034000
CVTRSV89 EQU   CVTDSSV                                                  09035000
CVTRSV88 EQU   CVTXTNT1+8                                               09036000
CVTRSV87 EQU   CVTXTNT1+4                                               09037000
CVTFACHN EQU   CVTXTNT1                                                 09038000
CVTRV488 EQU   CVTMAP+412                                               09039000
CVTRV487 EQU   CVTMAP+408                                               09040000
CVTRV486 EQU   CVTMAP+404                                               09041000
CVTRV485 EQU   CVTMAP+400                                               09042000
CVTACTAP EQU   CVTMAP+396                                               09043000
CVTAUTH  EQU   CVTMAP+392                                               09044000
CVTATMCA EQU   CVTATMCT+1                                               09045000
CVTATMST EQU   CVTATMCT                                                 09046000
CVTRSV61 EQU   CVTMAP+384                                               09047000
CVTVOLT1 EQU   CVTVOLM1+1                                               09048000
CVTVOLI1 EQU   CVTVOLF1                                                 09049000
CVTSTOA  EQU   CVTMAP+376                                               09050000
CVTRSV58 EQU   CVTMAP+374                                               09051000
CVTRSV57 EQU   CVTMAP+372                                               09052000
CVTDDCE  EQU   CVTMAP+368                                               09053000
CVTPNWFR EQU   CVTMAP+364                                               09054000
CVTSMF   EQU   CVTMAP+360                                               09055000
CVTSULK  EQU   CVTMAP+358                                               09056000
CVTSLKO  EQU   CVTSYSK                                                  09057000
CVTSLKP  EQU   CVTSYSK                                                  09058000
CVTSLKQ  EQU   CVTSYSK                                                  09059000
CVTSLKR  EQU   CVTSYSK                                                  09060000
CVTRSV56 EQU   CVTSYSK                                                  09061000
CVTRSV55 EQU   CVTSYSK                                                  09062000
CVTRSV54 EQU   CVTSYSK                                                  09063000
CVTRSV53 EQU   CVTSYSK                                                  09064000
CVTRSV52 EQU   CVTA1F1                                                  09065000
CVTRSV51 EQU   CVTA1F1                                                  09066000
CVTRSV50 EQU   CVTA1F1                                                  09067000
CVTRSV49 EQU   CVTA1F1                                                  09068000
CVTRSV48 EQU   CVTA1F1                                                  09069000
CVTRSV47 EQU   CVTA1F1                                                  09070000
CVTSRSW  EQU   CVTA1F1                                                  09071000
CVTPFSW  EQU   CVTA1F1                                                  09072000
CVTPCVT  EQU   CVTMAP+352                                               09073000
CVTRSV46 EQU   CVTMAP+344                                               09074000
CVTRSV45 EQU   CVTMAP+340                                               09075000
CVTRSV44 EQU   CVTMAP+338                                               09076000
CVTRSV43 EQU   CVTMAP+336                                               09077000
CVTHJESA EQU   CVTHJES+1                                                09078000
CVTRSV42 EQU   CVTHJES                                                  09079000
CVTEXT2A EQU   CVTEXT2+1                                                09080000
CVTRSV41 EQU   CVTEXT2                                                  09081000
CVTAPFA  EQU   CVTAPF+1                                                 09082000
CVTRSV40 EQU   CVTAPF                                                   09083000
CVTRV518 EQU   CVTINTLA                                                 09084000
CVTRV517 EQU   CVTERPV                                                  09085000
CVTEORM  EQU   CVTMAP+312                                               09086000
CVTMCHPR EQU   CVTMAP+308                                               09087000
CVTTZ    EQU   CVTMAP+304                                               09088000
CVTJEPS  EQU   CVTMAP+300                                               09089000
CVTJESCT EQU   CVTMAP+296                                               09090000
CVTMODE  EQU   CVTMAP+292                                               09091000
CVTPTRV  EQU   CVTMAP+288                                               09092000
CVTREAL  EQU   CVTMAP+284                                               09093000
CVTRSV39 EQU   CVTMAP+280                                               09094000
CVTRSV38 EQU   CVTMAP+276                                               09095000
CVTDMSRA EQU   CVTDMSR+1                                                09096000
CVTRV634 EQU   CVTDMSRF                                                 09097000
CVTRV633 EQU   CVTDMSRF                                                 09098000
CVTRV632 EQU   CVTDMSRF                                                 09099000
CVTRV631 EQU   CVTDMSRF                                                 09100000
CVTRV630 EQU   CVTDMSRF                                                 09101000
CVTRV629 EQU   CVTDMSRF                                                 09102000
CVTUDUMP EQU   CVTDMSRF                                                 09103000
CVTSDUMP EQU   CVTDMSRF                                                 09104000
CVTQMSGA EQU   CVTQMSG+1                                                09105000
CVTRSV36 EQU   CVTQMSG                                                  09106000
CVTAMFF  EQU   CVTMAP+264                                               09107000
CVTPURGA EQU   CVTPURG+1                                                09108000
CVTRSV35 EQU   CVTPURG                                                  09109000
CVTCBSP  EQU   CVTMAP+256                                               09110000
CVTATERA EQU   CVTATER+1                                                09111000
CVTSYST  EQU   CVTATER                                                  09112000
CVTVOLT2 EQU   CVTTAT                                                   09113000
CVTVOLI2 EQU   CVTVOLF2                                                 09114000
CVTAQAVB EQU   CVTAQAVT+1                                               09115000
CVTRSV34 EQU   CVTTCMFG                                                 09116000
CVTRSV33 EQU   CVTTCMFG                                                 09117000
CVTRSV32 EQU   CVTTCMFG                                                 09118000
CVTRSV31 EQU   CVTTCMFG                                                 09119000
CVTRSV30 EQU   CVTTCMFG                                                 09120000
CVTRSV29 EQU   CVTTCMFG                                                 09121000
CVTLDEV  EQU   CVTTCMFG                                                 09122000
CVTTCRDY EQU   CVTTCMFG                                                 09123000
CVTGTFA  EQU   CVTGTF+1                                                 09124000
CVTRSV27 EQU   CVTGTFST                                                 09125000
CVTRNIO  EQU   CVTGTFST                                                 09126000
CVTUSR   EQU   CVTGTFST                                                 09127000
CVTRV318 EQU   CVTFORM                                                  09128000
CVTRV317 EQU   CVTTMODE                                                 09129000
CVTRV316 EQU   CVTSTATE                                                 09130000
CVTRV315 EQU   CVTGTFS                                                  09131000
CVTGTFAV EQU   CVTGTFS                                                  09132000
CVT0SCR1 EQU   CVTMAP+232                                               09133000
CVTRV515 EQU   CVTMAP+228                                               09134000
CVTRMS   EQU   CVTMAP+224                                               09135000
CVTPATCH EQU   CVTMAP+220                                               09136000
CVTTSCE  EQU   CVTMAP+216                                               09137000
CVTLNKSC EQU   CVTMAP+214                                               09138000
CVTQABST EQU   CVTMAP+212                                               09139000
CVTMDLDS EQU   CVTMAP+208                                               09140000
CVTUSER  EQU   CVTMAP+204                                               09141000
CVTABEND EQU   CVTMAP+200                                               09142000
CVTSMCA  EQU   CVTMAP+196                                               09143000
CVTRSV18 EQU   CVTMAP+192                                               09144000
CVTQLPAQ EQU   CVTMAP+188                                               09145000
CVTQCDSR EQU   CVTMAP+184                                               09146000
CVTRSV17 EQU   CVTOPTB                                                  09147000
CVTRSV16 EQU   CVTOPTB                                                  09148000
CVTFP    EQU   CVTOPTB                                                  09149000
CVTAPTHR EQU   CVTOPTB                                                  09150000
CVTNLOG  EQU   CVTOPTB                                                  09151000
CVTTOD   EQU   CVTOPTB                                                  09152000
CVTCTIMS EQU   CVTOPTB                                                  09153000
CVTPROT  EQU   CVTOPTB                                                  09154000
CVTXPFP  EQU   CVTOPTA                                                  09155000
CVTASCII EQU   CVTOPTA                                                  09156000
CVTRSV13 EQU   CVTOPTA                                                  09157000
CVTRSV12 EQU   CVTOPTA                                                  09158000
CVTNIP   EQU   CVTOPTA                                                  09159000
CVTDDR   EQU   CVTOPTA                                                  09160000
CVTAPR   EQU   CVTOPTA                                                  09161000
CVTCCH   EQU   CVTOPTA                                                  09162000
CVTSNCTR EQU   CVTMAP+180                                               09163000
CVTQMWR  EQU   CVTMAP+176                                               09164000
CVTQOCR  EQU   CVTMAP+172                                               09165000
CVT1EF00 EQU   CVTMAP+168                                               09166000
CVTMZ00  EQU   CVTMAP+164                                               09167000
CVTSV76Q EQU   CVTSV76C                                                 09168000
CVTRSV11 EQU   CVTMAP+156                                               09169000
CVT0PT01 EQU   CVTMAP+152                                               09170000
CVTMSER  EQU   CVTMAP+148                                               09171000
CVTRV516 EQU   CVTIERLC                                                 09172000
CVTILCH  EQU   CVTMAP+140                                               09173000
CVT0DS   EQU   CVTMAP+136                                               09174000
CVTFBOSV EQU   CVTMAP+132                                               09175000
CVTNUCB  EQU   CVTMAP+128                                               09176000
CVTSV76M EQU   CVTIOQET                                                 09177000
CVTDCBA  EQU   CVTMAP+117                                               09178000
CVTMVS2  EQU   CVTDCB                                                   09179000
CVT6DAT  EQU   CVTDCB                                                   09180000
CVT4MPS  EQU   CVTDCB                                                   09181000
CVTRSV09 EQU   CVTDCB                                                   09182000
CVT4MS1  EQU   CVTDCB                                                   09183000
CVT2SPS  EQU   CVTDCB                                                   09184000
CVT1SSS  EQU   CVTDCB                                                   09185000
CVTRSV08 EQU   CVTDCB                                                   09186000
CVTSTB   EQU   CVTMAP+112                                               09187000
CVTQTD00 EQU   CVTMAP+108                                               09188000
CVTQTE00 EQU   CVTMAP+104                                               09189000
CVTCUCB  EQU   CVTMAP+100                                               09190000
CVTSJQ   EQU   CVTMAP+96                                                09191000
CVTPBLDL EQU   CVTMAP+92                                                09192000
CVTTPC   EQU   CVTMAP+88                                                09193000
CVTSVDCB EQU   CVTMAP+84                                                09194000
CVTBRET  EQU   CVTMAP+82                                                09195000
CVTEXIT  EQU   CVTMAP+80                                                09196000
CVT0FN00 EQU   CVTMAP+76                                                09197000
CVTDARA  EQU   CVTDAR+1                                                 09198000
CVTRSV07 EQU   CVTFLGS1                                                 09199000
CVTRSV06 EQU   CVTFLGS1                                                 09200000
CVTRSV05 EQU   CVTFLGS1                                                 09201000
CVTRSV04 EQU   CVTFLGS1                                                 09202000
CVTRSV03 EQU   CVTFLGS1                                                 09203000
CVTRSV02 EQU   CVTFLGS1                                                 09204000
CVTRSV01 EQU   CVTFLGS1                                                 09205000
CVTDMPLK EQU   CVTFLGS1                                                 09206000
CVTXITP  EQU   CVTMAP+68                                                09207000
CVTZDTAB EQU   CVTMAP+64                                                09208000
CVTMSLT  EQU   CVTMAP+60                                                09209000
CVTDATE  EQU   CVTMAP+56                                                09210000
CVTBTERM EQU   CVTMAP+52                                                09211000
CVTSYSAD EQU   CVTMAP+48                                                09212000
CVTXTLER EQU   CVTMAP+44                                                09213000
CVTILK2  EQU   CVTMAP+40                                                09214000
CVTILK1  EQU   CVTMAP+36                                                09215000
CVTPRLTV EQU   CVTMAP+32                                                09216000
CVTPCNVT EQU   CVTMAP+28                                                09217000
CVT0VL00 EQU   CVTMAP+24                                                09218000
CVTXAPG  EQU   CVTMAP+20                                                09219000
CVTBUF   EQU   CVTMAP+16                                                09220000
CVTJOB   EQU   CVTMAP+12                                                09221000
CVTLINK  EQU   CVTMAP+8                                                 09222000
CVT0EF00 EQU   CVTMAP+4                                                 09223000
CVTTCBP  EQU   CVTMAP                                                   09224000
CVT      EQU   CVTMAP                                                   09225000
@NM00024 EQU   PSA+3668                                                 09226000
PSASTAK  EQU   PSA+3072                                                 09227000
@NM00023 EQU   PSA+1048                                                 09228000
PSAUSEND EQU   PSA+1048                                                 09229000
PSARV062 EQU   PSA+1044                                                 09230000
PSACDAL  EQU   PSA+1040                                                 09231000
PSAWTCOD EQU   PSA+1036                                                 09232000
PSAATCVT EQU   PSA+1032                                                 09233000
PSAPCPSW EQU   PSA+1024                                                 09234000
PSAPIR2  EQU   PSA+1020                                                 09235000
PSARV059 EQU   PSA+1018                                                 09236000
PSASVC13 EQU   PSA+1016                                                 09237000
PSASFACC EQU   PSA+1008                                                 09238000
PSASTOP  EQU   PSA+992                                                  09239000
PSASTART EQU   PSA+976                                                  09240000
PSARSPSW EQU   PSA+968                                                  09241000
PSASRPSW EQU   PSA+960                                                  09242000
PSARV045 EQU   PSA+892                                                  09243000
PSARV044 EQU   PSA+888                                                  09244000
PSARV043 EQU   PSA+884                                                  09245000
PSARV042 EQU   PSA+880                                                  09246000
PSARV041 EQU   PSA+876                                                  09247000
PSARV040 EQU   PSA+872                                                  09248000
PSARV025 EQU   PSA+868                                                  09249000
PSADSSED EQU   PSA+868                                                  09250000
PSADSSPR EQU   PSA+864                                                  09251000
PSADSSFW EQU   PSA+860                                                  09252000
PSADSS14 EQU   PSA+856                                                  09253000
PSADSSPP EQU   PSA+848                                                  09254000
PSADSSRP EQU   PSA+840                                                  09255000
PSADSS05 EQU   PSADSSF4                                                 09256000
PSADSS10 EQU   PSADSSF4                                                 09257000
PSADSSVE EQU   PSADSSF4                                                 09258000
PSADSSDE EQU   PSADSSF4                                                 09259000
PSADSSC0 EQU   PSADSSF4                                                 09260000
PSADSSIE EQU   PSADSSF4                                                 09261000
PSADSS12 EQU   PSADSSF4                                                 09262000
PSADSSRC EQU   PSADSSF4                                                 09263000
PSARV057 EQU   PSADSSF3                                                 09264000
PSARV056 EQU   PSADSSF3                                                 09265000
PSARV055 EQU   PSADSSF3                                                 09266000
PSADSSMC EQU   PSADSSF3                                                 09267000
PSADSSRW EQU   PSADSSF3                                                 09268000
PSADSSNM EQU   PSADSSF3                                                 09269000
PSADSSES EQU   PSADSSF3                                                 09270000
PSADSSGP EQU   PSADSSF3                                                 09271000
PSADSSF2 EQU   PSADSSFL+1                                               09272000
PSADSSPI EQU   PSADSSF1                                                 09273000
PSADSSOI EQU   PSADSSF1                                                 09274000
PSADSSSP EQU   PSADSSF1                                                 09275000
PSADSSTP EQU   PSADSSF1                                                 09276000
PSADSSDW EQU   PSADSSF1                                                 09277000
PSADSSDD EQU   PSADSSF1                                                 09278000
PSADSSDM EQU   PSADSSF1                                                 09279000
PSADSSMV EQU   PSADSSF1                                                 09280000
PSADSSTS EQU   PSA+816                                                  09281000
PSADSSWK EQU   PSA+812                                                  09282000
PSADSSR3 EQU   PSA+808                                                  09283000
PSADSSR2 EQU   PSA+804                                                  09284000
PSADSSRS EQU   PSA+800                                                  09285000
PSASTOR  EQU   PSA+796                                                  09286000
PSACPUSA EQU   PSA+794                                                  09287000
PSAVSTAP EQU   PSA+792                                                  09288000
PSAWKVAP EQU   PSA+788                                                  09289000
PSAWKRAP EQU   PSA+784                                                  09290000
PSAMCHIC EQU   PSA+783                                                  09291000
PSARV061 EQU   PSA+782                                                  09292000
PSASYMSK EQU   PSA+781                                                  09293000
PSAMCHFL EQU   PSA+780                                                  09294000
PSACR0   EQU   PSA+776                                                  09295000
PSAPSWSV EQU   PSA+768                                                  09296000
PSACLHS  EQU   PSAHLHI                                                  09297000
PSALKR15 EQU   PSALKSA+60                                               09298000
PSALKR14 EQU   PSALKSA+56                                               09299000
PSALKR13 EQU   PSALKSA+52                                               09300000
PSALKR12 EQU   PSALKSA+48                                               09301000
PSALKR11 EQU   PSALKSA+44                                               09302000
PSALKR10 EQU   PSALKSA+40                                               09303000
PSALKR9  EQU   PSALKSA+36                                               09304000
PSALKR8  EQU   PSALKSA+32                                               09305000
PSALKR7  EQU   PSALKSA+28                                               09306000
PSALKR6  EQU   PSALKSA+24                                               09307000
PSALKR5  EQU   PSALKSA+20                                               09308000
PSALKR4  EQU   PSALKSA+16                                               09309000
PSALKR3  EQU   PSALKSA+12                                               09310000
PSALKR2  EQU   PSALKSA+8                                                09311000
PSALKR1  EQU   PSALKSA+4                                                09312000
PSALKR0  EQU   PSALKSA                                                  09313000
PSARV023 EQU   PSACLHT+52                                               09314000
PSALOCAL EQU   PSACLHT+48                                               09315000
PSACMSL  EQU   PSACLHT+44                                               09316000
PSAOPTL  EQU   PSACLHT+40                                               09317000
PSATPACL EQU   PSACLHT+36                                               09318000
PSATPDNL EQU   PSACLHT+32                                               09319000
PSATPNCL EQU   PSACLHT+28                                               09320000
PSAIOSLL EQU   PSACLHT+24                                               09321000
PSAIOSUL EQU   PSACLHT+20                                               09322000
PSAIOSCL EQU   PSACLHT+16                                               09323000
PSAIOSSL EQU   PSACLHT+12                                               09324000
PSASALCL EQU   PSACLHT+8                                                09325000
PSAASML  EQU   PSACLHT+4                                                09326000
PSADISPL EQU   PSACLHT                                                  09327000
PSASRSA  EQU   PSA+636                                                  09328000
PSARV050 EQU   PSA+634                                                  09329000
PSADSSGO EQU   PSA+633                                                  09330000
PSARECUR EQU   PSA+632                                                  09331000
PSAHLHIS EQU   PSA+628                                                  09332000
PSAIPCSA EQU   PSA+624                                                  09333000
@NM00022 EQU   PSA+621                                                  09334000
PSAIPCDM EQU   PSA+620                                                  09335000
PSAIPCD  EQU   PSA+616                                                  09336000
@NM00021 EQU   PSA+613                                                  09337000
PSAIPCRM EQU   PSA+612                                                  09338000
PSAIPCR  EQU   PSA+608                                                  09339000
PSAMCHEX EQU   PSA+600                                                  09340000
PSAMPSW  EQU   PSA+592                                                  09341000
PSAEXPS2 EQU   PSA+584                                                  09342000
PSAEXPS1 EQU   PSA+576                                                  09343000
PSAPIREG EQU   PSA+572                                                  09344000
PSARSREG EQU   PSA+568                                                  09345000
PSAGPREG EQU   PSA+556                                                  09346000
PSARV022 EQU   PSASUP4                                                  09347000
PSARV021 EQU   PSASUP4                                                  09348000
PSARV020 EQU   PSASUP4                                                  09349000
PSARV019 EQU   PSASUP4                                                  09350000
PSARV018 EQU   PSASUP4                                                  09351000
PSARV017 EQU   PSASUP4                                                  09352000
PSARV016 EQU   PSASUP4                                                  09353000
PSARV015 EQU   PSASUP4                                                  09354000
PSARV014 EQU   PSASUP3                                                  09355000
PSARV013 EQU   PSASUP3                                                  09356000
PSARV012 EQU   PSASUP3                                                  09357000
PSAESTA  EQU   PSASUP3                                                  09358000
PSASPR   EQU   PSASUP3                                                  09359000
PSAPSREG EQU   PSASUP3                                                  09360000
PSAPI2   EQU   PSASUP3                                                  09361000
PSAIOSUP EQU   PSASUP3                                                  09362000
PSALCR   EQU   PSASUP2                                                  09363000
PSARTM   EQU   PSASUP2                                                  09364000
PSAACR   EQU   PSASUP2                                                  09365000
PSAIPCE2 EQU   PSASUP2                                                  09366000
PSAIPCES EQU   PSASUP2                                                  09367000
PSAIPCEC EQU   PSASUP2                                                  09368000
PSAGTF   EQU   PSASUP2                                                  09369000
PSAIPCRI EQU   PSASUP2                                                  09370000
PSATYPE6 EQU   PSASUP1                                                  09371000
PSATCTL  EQU   PSASUP1                                                  09372000
PSADISP  EQU   PSASUP1                                                  09373000
PSALOCK  EQU   PSASUP1                                                  09374000
PSAPI    EQU   PSASUP1                                                  09375000
PSAEXT   EQU   PSASUP1                                                  09376000
PSASVC   EQU   PSASUP1                                                  09377000
PSAIO    EQU   PSASUP1                                                  09378000
PSAANEW  EQU   PSA+544                                                  09379000
PSATNEW  EQU   PSA+536                                                  09380000
PSALCCAR EQU   PSA+532                                                  09381000
PSALCCAV EQU   PSA+528                                                  09382000
PSAPCCAR EQU   PSA+524                                                  09383000
PSAPCCAV EQU   PSA+520                                                  09384000
PSACPULA EQU   PSA+518                                                  09385000
PSACPUPA EQU   PSA+516                                                  09386000
PSAPSA   EQU   PSA+512                                                  09387000
FLCHDEND EQU   PSA+512                                                  09388000
FLCCRSAV EQU   FLCMCLA+280                                              09389000
FLCGRSAV EQU   FLCMCLA+216                                              09390000
FLCFPSAV EQU   FLCMCLA+184                                              09391000
FLCFLA   EQU   FLCMCLA+88                                               09392000
FLCRGNCD EQU   FLCMCLA+84                                               09393000
FLCFSAA  EQU   FLCFSA+1                                                 09394000
@NM00020 EQU   FLCFSA                                                   09395000
@NM00019 EQU   FLCMCLA+72                                               09396000
FLCMCIC  EQU   FLCMCLA+64                                               09397000
@NM00018 EQU   FLCMCLA+20                                               09398000
FLCIOAA  EQU   FLCIOA+1                                                 09399000
@NM00017 EQU   FLCIOA                                                   09400000
@NM00016 EQU   FLCMCLA+15                                               09401000
@NM00015 EQU   FLCMCLA+14                                               09402000
@NM00014 EQU   FLCMCLA+12                                               09403000
FLCLCL   EQU   FLCMCLA+8                                                09404000
FLCIOELA EQU   FLCIOEL+1                                                09405000
@NM00013 EQU   FLCIOEL                                                  09406000
FLCCHNID EQU   FLCMCLA                                                  09407000
@NM00012 EQU   PSA+160                                                  09408000
FLCMTRCD EQU   PSA+157                                                  09409000
@NM00011 EQU   PSA+156                                                  09410000
FLCPERA  EQU   FLCPER+1                                                 09411000
@NM00010 EQU   FLCPER                                                   09412000
@NM00009 EQU   PSA+151                                                  09413000
FLCPERCD EQU   PSA+150                                                  09414000
FLCMCNUM EQU   PSA+149                                                  09415000
@NM00008 EQU   PSA+148                                                  09416000
FLCTEAA  EQU   FLCTEA+1                                                 09417000
@NM00007 EQU   FLCTEA                                                   09418000
PSAPIPC  EQU   PSAPICOD                                                 09419000
PSAPIMC  EQU   PSAPICOD                                                 09420000
PSAPIPER EQU   PSAPICOD                                                 09421000
PSARV049 EQU   FLCPICOD                                                 09422000
FLCPILCB EQU   FLCPIILC                                                 09423000
@NM00006 EQU   FLCPIILC                                                 09424000
@NM00005 EQU   PSAEPPSW                                                 09425000
FLCSVCN  EQU   PSAESPSW+2                                               09426000
FLCSILCB EQU   FLCSVILC                                                 09427000
@NM00004 EQU   FLCSVILC                                                 09428000
@NM00003 EQU   PSAESPSW                                                 09429000
FLCEICOD EQU   PSAEEPSW+2                                               09430000
PSASPAD  EQU   PSAEEPSW                                                 09431000
@NM00002 EQU   PSA+128                                                  09432000
FLCINPSW EQU   PSA+120                                                  09433000
FLCMNPSW EQU   PSA+112                                                  09434000
FLCPNPSW EQU   PSA+104                                                  09435000
FLCSNPSW EQU   PSA+96                                                   09436000
FLCENPSW EQU   PSA+88                                                   09437000
FLCTRACE EQU   PSA+84                                                   09438000
FLCTIMER EQU   PSA+80                                                   09439000
FLCCVT2  EQU   PSA+76                                                   09440000
FLCCAW   EQU   PSA+72                                                   09441000
FLCCSW   EQU   PSA+64                                                   09442000
FLCIOPSW EQU   PSA+56                                                   09443000
FLCMOPSW EQU   PSA+48                                                   09444000
FLCPOPSW EQU   PSA+40                                                   09445000
FLCSOPSW EQU   PSA+32                                                   09446000
FLCEOPSW EQU   PSA+24                                                   09447000
@NM00001 EQU   FLCICCW2+4                                               09448000
FLCICCW1 EQU   FLCROPSW                                                 09449000
FLCIPPSW EQU   FLCRNPSW                                                 09450000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09451000
@RF00501 EQU   @RC00498                                                 09452000
@RF00519 EQU   @RC00516                                                 09453000
@RF00583 EQU   @RC00579                                                 09454000
@RT00836 EQU   PGETST01                                                 09455000
@RF01217 EQU   SETSMF2                                                  09456000
@RC01472 EQU   @EL00003                                                 09457000
@RC01612 EQU   @EL00007                                                 09458000
@RF01611 EQU   @EL00007                                                 09459000
@RF01630 EQU   @EL00008                                                 09460000
@RF01684 EQU   @EL00010                                                 09461000
@RF01737 EQU   @EL00012                                                 09462000
@ENDDATA EQU   *                                                        09463000
         END   IGTKCA,(C'PLS1936',0701,77286)                           09464000
