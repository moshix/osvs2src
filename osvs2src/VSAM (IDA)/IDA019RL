         TITLE 'IDA019RL - VSAM  D A T A   M O D I F Y                 *00001000
                        '                                               00002000
IDA019RL CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IDA019RL  78.188'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
         IDASVR14                                                       00013000
*   IF RPLREQ=RPLPUT                /* IS THIS UPDATE REQUEST        */ 00014000
*     THEN                          /* YES, CONTINUE                 */ 00015000
         CLI   RPLREQ(RRPL),1                                      0160 00016000
         BNE   @RF00160                                            0160 00017000
*     DO;                           /* IS THIS A KEYED               */ 00018000
*       IF AMDDST='1'B              /* SEQUENTIAL                    */ 00019000
*         THEN                      /* DATA SET                      */ 00020000
         L     @10,AMBDSB(,RAMB)                                   0162 00021000
         TM    AMDDST(@10),B'10000000'                             0162 00022000
         BNO   @RF00162                                            0162 00023000
*         DO;                       /* YES                           */ 00024000
*           IF RPLAREA->AMDATA(AMDRKP+1:/* TEST THE KEY IN THE       */ 00025000
*               AMDRKP+AMDKEYLN)^=PLHKEY/* USERS AREA AGAINST THE    */ 00026000
*               (1:AMDKEYLN)        /* KEY IN THE BUFFER             */ 00027000
*             THEN                  /* KEYS ARE DIFFERENT            */ 00028000
         LH    @09,AMDRKP(,@10)                                    0164 00029000
         L     @15,RPLAREA(,RRPL)                                  0164 00030000
         L     @14,PLHKEYPT(,RPLH)                                 0164 00031000
         LH    @10,AMDKEYLN(,@10)                                  0164 00032000
         BCTR  @10,0                                               0164 00033000
         ALR   @15,@09                                             0164 00034000
         EX    @10,@SC01036                                        0164 00035000
         BE    @RF00164                                            0164 00036000
*             DO;                   /* SET ERROR INDICATORS          */ 00037000
*               RPLERREG='08'X;     /* IN REGISTER AND               */ 00038000
         MVI   RPLERREG(RRPL),X'08'                                0166 00039000
*               RPLERRCD=RPLKEYCH;  /* USERS RPL                     */ 00040000
         MVI   RPLERRCD(RRPL),X'60'                                0167 00041000
*               GEN(IDARST14);      /* RESTORE REG 14                */ 00042000
         IDARST14                                                       00043000
*               RETURN;             /* RETURN TO CALLER              */ 00044000
@EL00001 DS    0H                                                  0169 00045000
@EF00001 DS    0H                                                  0169 00046000
@ER00001 BR    @14                                                 0169 00047000
*             END;                  /*                               */ 00048000
*         END;                      /*                               */ 00049000
@RF00164 DS    0H                                                  0172 00050000
*       IF RPLRLEN^=PLHLRECL        /* CHECK NEW RECORD              */ 00051000
*         THEN                      /* AGAINST OLD FOR SIZE          */ 00052000
@RF00162 L     @10,RPLRLEN(,RRPL)                                  0172 00053000
         C     @10,PLHLRECL(,RPLH)                                 0172 00054000
         BE    @RF00172                                            0172 00055000
*         DO;                       /* DIFFERENCE                    */ 00056000
*           IF AMDDST='1'B          /* IS THIS A KEYED SEQ DS        */ 00057000
*             THEN                  /* YES, BEGIN ROUTINE TO         */ 00058000
         L     @09,AMBDSB(,RAMB)                                   0174 00059000
         TM    AMDDST(@09),B'10000000'                             0174 00060000
         BNO   @RF00174                                            0174 00061000
*             DO;                   /* UPDATE WITH LENGTH CHNG       */ 00062000
*               IF RPLRLEN<AMDRKP+AMDKEYLN|/* CHECK LENGTH           */ 00063000
*                   RPLRLEN>AMDLRECL THEN/* AGAINST MIN & MAX LGTH.  */ 00064000
         LH    @00,AMDRKP(,@09)                                    0176 00065000
         AH    @00,AMDKEYLN(,@09)                                  0176 00066000
         CR    @10,@00                                             0176 00067000
         BL    @RT00176                                            0176 00068000
         C     @10,AMDLRECL(,@09)                                  0176 00069000
         BNH   @RF00176                                            0176 00070000
@RT00176 DS    0H                                                  0177 00071000
*                 DO;               /* FAILED THE TEST, SO           */ 00072000
*                   RPLERREG='08'X; /* SHOW LOG ERROR IN RPL         */ 00073000
         MVI   RPLERREG(RRPL),X'08'                                0178 00074000
*                   RPLERRCD=RPLINLEN;/* SHOW ERROR TYPE IN RPL      */ 00075000
         MVI   RPLERRCD(RRPL),X'6C'                                0179 00076000
*                   GEN(IDARST14);  /* RESTORE REG 14                */ 00077000
         IDARST14                                                       00078000
*                   RETURN;         /* RETURN TO CALLER              */ 00079000
         B     @EL00001                                            0181 00080000
*                 END;              /*                               */ 00081000
*               GO TO ERSE;         /* FIRST, ERASE OLD RECD.        */ 00082000
         B     ERSE                                                0183 00083000
*             END;                  /*                               */ 00084000
*           ELSE                    /* CHRON SEQ. DATA SET           */ 00085000
*             DO;                   /* SO SET ERROR INDICATORS       */ 00086000
@RF00174 DS    0H                                                  0186 00087000
*               RPLERREG='08'X;     /* IN REGISTER AND               */ 00088000
         MVI   RPLERREG(RRPL),X'08'                                0186 00089000
*               RPLERRCD=RPLDLCER;  /* USERS RPL                     */ 00090000
         MVI   RPLERRCD(RRPL),X'64'                                0187 00091000
*               GEN(IDARST14);      /* RESTORE REG 14 AND            */ 00092000
         IDARST14                                                       00093000
*               RETURN;             /* RETURN TO CALLER              */ 00094000
         B     @EL00001                                            0189 00095000
*             END;                  /*                               */ 00096000
*         END;                      /*                               */ 00097000
*       ELSE                        /* RECORD SIZE IS THE SAME       */ 00098000
*         DO;                       /*                               */ 00099000
@RF00172 DS    0H                                                  0193 00100000
*           IF PLHLRECL>AMDCINV-    /* IS OLD RECORD         @ZA02289*/ 00101000
*               LENGTH(IDACIDF)-    /* A SPANNED             @ZA02289*/ 00102000
*               LENGTH(IDARDF) THEN /* RECORD                @ZA02289*/ 00103000
         L     @10,AMBDSB(,RAMB)                                   0193 00104000
         L     @10,AMDCINV(,@10)                                   0193 00105000
         SL    @10,@CF00199                                        0193 00106000
         C     @10,PLHLRECL(,RPLH)                                 0193 00107000
         BNL   @RF00193                                            0193 00108000
*             DO;                   /* YES                   @ZA02289*/ 00109000
*I01:                                                              0195 00110000
*               DO;                 /* IDACALL(IDA019RS)             */ 00111000
I01      DS    0H                                                  0196 00112000
*                 CALL IDA019RS;    /* EXIT TO IDA019RS              */ 00113000
         L     @15,@CV00970                                        0196 00114000
         BALR  @14,@15                                             0196 00115000
*                 GEN(BALR @11,0);  /* LOAD ADDR OF REENTRY          */ 00116000
         BALR @11,0                                                     00117000
*                 GEN(USING *,@11); /* ESTABLISH ADDRESSING          */ 00118000
         USING *,@11                                                    00119000
*                 GEN(L     @11,=A(@PSTART));/* RELOAD BASE          */ 00120000
         L     @11,=A(@PSTART)                                          00121000
*                 GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING     */ 00122000
         USING @PSTART,@11                                              00123000
*               END I01;            /*                       @ZA02289*/ 00124000
*               GEN(IDARST14);      /* RESTORE REG 14        @ZA02289*/ 00125000
         IDARST14                                                       00126000
*               RETURN;             /* BACK TO CALLER        @ZA02289*/ 00127000
         B     @EL00001                                            0203 00128000
*             END;                  /*                       @ZA02289*/ 00129000
*           RESPECIFY                                              0205 00130000
*            (RWORK5) RSTD;         /* PROTECT RWORK5                */ 00131000
@RF00193 DS    0H                                                  0206 00132000
*           RWORK2=PLHRECP;         /* SET TO ADDRESS                */ 00133000
         L     RWORK2,PLHRECP(,RPLH)                               0206 00134000
*           RWORK4=RPLAREA;         /* SET FROM ADDRESS              */ 00135000
         L     RWORK4,RPLAREA(,RRPL)                               0207 00136000
*           RWORK3=PLHLRECL;        /* SET MOVE                      */ 00137000
         L     RWORK3,PLHLRECL(,RPLH)                              0208 00138000
*           RWORK5=RWORK3;          /* LENGTH                        */ 00139000
         LR    RWORK5,RWORK3                                       0209 00140000
*           GEN(MVCL  RWORK2,RWORK4);/* MOVE RECORD FROM USER AREA TO   00141000
*                                      BUFFER                        */ 00142000
         MVCL  RWORK2,RWORK4                                            00143000
*         END;                      /*                               */ 00144000
*     END;                          /*                               */ 00145000
*   ELSE                            /* FOLLOWING DO CODE TAKES       */ 00146000
*     DO;                           /* CARE OF THE ERASE CASE        */ 00147000
         B     @RC00160                                            0213 00148000
@RF00160 DS    0H                                                  0214 00149000
*       IF AMDDST='1'B THEN         /* IS THIS A KEYED DS            */ 00150000
         L     @10,AMBDSB(,RAMB)                                   0214 00151000
         TM    AMDDST(@10),B'10000000'                             0214 00152000
         BNO   @RF00214                                            0214 00153000
*ERSE:                                                             0215 00154000
*         DO;                       /* YES, ERASE IS VALID           */ 00155000
ERSE     DS    0H                                                  0216 00156000
*           IF PLHLRECL>AMDCINV-    /* IS RECORD TO BE@ZA02289       */ 00157000
*               LENGTH(IDACIDF)-    /* ERASED A              @ZA02289*/ 00158000
*               LENGTH(IDARDF)      /* SPANNED RECORD        @ZA02289*/ 00159000
*             THEN                  /*                       @ZA02289*/ 00160000
         L     @10,AMBDSB(,RAMB)                                   0216 00161000
         L     @10,AMDCINV(,@10)                                   0216 00162000
         SL    @10,@CF00199                                        0216 00163000
         C     @10,PLHLRECL(,RPLH)                                 0216 00164000
         BNL   @RF00216                                            0216 00165000
*             DO;                   /* YES                   @ZA02289*/ 00166000
*I02:                                                              0218 00167000
*               DO;                 /* IDACALL(IDA019RS)             */ 00168000
I02      DS    0H                                                  0219 00169000
*                 CALL IDA019RS;    /* EXIT TO IDA019RS              */ 00170000
         L     @15,@CV00970                                        0219 00171000
         BALR  @14,@15                                             0219 00172000
*                 GEN(BALR @11,0);  /* LOAD ADDR OF REENTRY          */ 00173000
         BALR @11,0                                                     00174000
*                 GEN(USING *,@11); /* ESTABLISH ADDRESSING          */ 00175000
         USING *,@11                                                    00176000
*                 GEN(L     @11,=A(@PSTART));/* RELOAD BASE          */ 00177000
         L     @11,=A(@PSTART)                                          00178000
*                 GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING     */ 00179000
         USING @PSTART,@11                                              00180000
*               END I02;            /* GO TO SPANNED RECORD ERASE  0224 00181000
*                                      MODULE                @ZA02289*/ 00182000
*               GEN(IDARST14);      /* RESTORE R14           @ZA02289*/ 00183000
         IDARST14                                                       00184000
*               RETURN;             /* RETURN                @ZA02289*/ 00185000
         B     @EL00001                                            0226 00186000
*             END;                  /*                       @ZA02289*/ 00187000
*           IF RPLREQ=RPLPUT THEN   /* UPDATE                @ZA02289*/ 00188000
@RF00216 CLI   RPLREQ(RRPL),1                                      0228 00189000
         BNE   @RF00228                                            0228 00190000
*             DO;                   /* YES                   @ZA02289*/ 00191000
*               IF RPLRLEN>AMDCINV- /* IS THE NEW            @ZA02289*/ 00192000
*                   LENGTH(IDACIDF)-/* RECORD                @ZA02289*/ 00193000
*                   LENGTH(IDARDF) THEN/* SPANNED            @ZA02289*/ 00194000
         L     @10,AMBDSB(,RAMB)                                   0230 00195000
         L     @10,AMDCINV(,@10)                                   0230 00196000
         SL    @10,@CF00199                                        0230 00197000
         C     @10,RPLRLEN(,RRPL)                                  0230 00198000
         BNL   @RF00230                                            0230 00199000
*                 DO;               /* YES                   @ZA02289*/ 00200000
*                   DO WHILE BUFCBAD^=PLHRECP|/* LOOP UNTIL  @ZA02289*/ 00201000
*                         PLHFSP^=BUFCBAD+PLHLRECL;/* ONLY ONE RECORD   00202000
*                                      REMAINS               @ZA02289*/ 00203000
         B     @DE00232                                            0232 00204000
@DL00232 DS    0H                                                  0233 00205000
*                     CALL SPLITCI; /* GO SPLIT              @ZA02289*/ 00206000
         BAL   @14,SPLITCI                                         0233 00207000
*                   END;            /*                       @ZA02289*/ 00208000
@DE00232 L     @10,PLHDBUFC(,RPLH)                                 0234 00209000
         L     @10,BUFCBAD(,@10)                                   0234 00210000
         C     @10,PLHRECP(,RPLH)                                  0234 00211000
         BNE   @DL00232                                            0234 00212000
         AL    @10,PLHLRECL(,RPLH)                                 0234 00213000
         C     @10,PLHFSP(,RPLH)                                   0234 00214000
         BNE   @DL00232                                            0234 00215000
*I03:                                                              0235 00216000
*                   DO;             /* IDACALL(IDA019RM)             */ 00217000
I03      DS    0H                                                  0236 00218000
*                     CALL IDA019RM;/* EXIT TO IDA019RM              */ 00219000
         L     @15,@CV00969                                        0236 00220000
         BALR  @14,@15                                             0236 00221000
*                     GEN(BALR @11,0);/* LOAD ADDR OF REENTRY        */ 00222000
         BALR @11,0                                                     00223000
*                     GEN(USING *,@11);/* ESTABLISH ADDRESSING       */ 00224000
         USING *,@11                                                    00225000
*                     GEN(L     @11,=A(@PSTART));/* RELOAD BASE      */ 00226000
         L     @11,=A(@PSTART)                                          00227000
*                     GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING */ 00228000
         USING @PSTART,@11                                              00229000
*                   END I03;        /* INSERT RECORD         @ZA02289*/ 00230000
*                   GEN(IDARST14);  /* RESTORE R14           @ZA02289*/ 00231000
         IDARST14                                                       00232000
*                   RETURN;         /* BACK TO CALLER        @ZA02289*/ 00233000
         B     @EL00001                                            0243 00234000
*                 END;              /*                       @ZA02289*/ 00235000
*               RWORK1=BUFCBAD+AMDCINV-/* POINT TO           @ZA02289*/ 00236000
*                   LENGTH(IDACIDF);/* CIDF                  @ZA02289*/ 00237000
@RF00230 L     @10,PLHDBUFC(,RPLH)                                 0245 00238000
         L     @15,AMBDSB(,RAMB)                                   0245 00239000
         L     RWORK1,BUFCBAD(,@10)                                0245 00240000
         AL    RWORK1,AMDCINV(,@15)                                0245 00241000
         SL    RWORK1,@CF00067                                     0245 00242000
*               RESPECIFY                                          0246 00243000
*                 IDACIDF BASED(RWORK1);/*                   @ZA28995*/ 00244000
*               DO WHILE RPLRLEN-PLHLRECL>CIDFLL|/* IF NO ROOM FOR 0247 00245000
*                                      INCREASED LENGTH      @ZA28995*/ 00246000
*                     (PLHRDFP->RDFREPL=ON&/* REPEATED RDFS  @ZA28995*/ 00247000
*                     RPLRLEN-PLHLRECL+3*LENGTH(IDARDF)>CIDFLL);/* 0247 00248000
*                                      AND NO ROOM MAX RDFS  @ZA28995*/ 00249000
         B     @DE00247                                            0247 00250000
@DL00247 DS    0H                                                  0248 00251000
*                 CALL SPLITCI;     /* SPLIT CI              @ZA28995*/ 00252000
         BAL   @14,SPLITCI                                         0248 00253000
*                 RWORK1=BUFCBAD+AMDCINV-LENGTH(IDACIDF);/*  @ZA28995*/ 00254000
         L     @10,PLHDBUFC(,RPLH)                                 0249 00255000
         L     @15,AMBDSB(,RAMB)                                   0249 00256000
         L     RWORK1,BUFCBAD(,@10)                                0249 00257000
         AL    RWORK1,AMDCINV(,@15)                                0249 00258000
         SL    RWORK1,@CF00067                                     0249 00259000
*               END;                /*                       @ZA28995*/ 00260000
@DE00247 L     @10,RPLRLEN(,RRPL)                                  0250 00261000
         SL    @10,PLHLRECL(,RPLH)                                 0250 00262000
         LH    @15,CIDFLL(,RWORK1)                                 0250 00263000
         CR    @10,@15                                             0250 00264000
         BH    @DL00247                                            0250 00265000
         L     @14,PLHRDFP(,RPLH)                                  0250 00266000
         TM    RDFREPL(@14),B'00001000'                            0250 00267000
         BNO   @DC00247                                            0250 00268000
         AL    @10,@CF00224                                        0250 00269000
         CR    @10,@15                                             0250 00270000
         BH    @DL00247                                            0250 00271000
@DC00247 DS    0H                                                  0251 00272000
*               RESPECIFY                                          0251 00273000
*                 IDACIDF BASED;    /*                       @ZA28995*/ 00274000
*             END;                  /*                       @ZA02289*/ 00275000
*           RWORK1=BUFCBAD+AMDCINV-LENGTH(IDACIDF);/*        @ZA30400*/ 00276000
@RF00228 L     @10,PLHDBUFC(,RPLH)                                 0253 00277000
         L     @15,AMBDSB(,RAMB)                                   0253 00278000
         L     RWORK1,BUFCBAD(,@10)                                0253 00279000
         AL    RWORK1,AMDCINV(,@15)                                0253 00280000
         SL    RWORK1,@CF00067                                     0253 00281000
*           IF PLHRECP+PLHLRECL^=PLHFSP THEN/* IS CURRENT RECORD     */ 00282000
         L     @10,PLHRECP(,RPLH)                                  0254 00283000
         L     @15,PLHLRECL(,RPLH)                                 0254 00284000
         LR    @00,@10                                             0254 00285000
         ALR   @00,@15                                             0254 00286000
         L     @14,PLHFSP(,RPLH)                                   0254 00287000
         CR    @00,@14                                             0254 00288000
         BE    @RF00254                                            0254 00289000
*             DO;                   /* LAST IN THE BUFFER -NO        */ 00290000
*               RWORK3=PLHFSP-PLHRECP-PLHLRECL;/* COMPUTE MOVE LEN   */ 00291000
         SLR   @14,@10                                             0256 00292000
         SLR   @14,@15                                             0256 00293000
         LR    RWORK3,@14                                          0256 00294000
*               RESPECIFY                                          0257 00295000
*                (RWORK0) RSTD;     /*                               */ 00296000
*               RWORK0=RWORK3;      /* SAVE MOVE LENGTH              */ 00297000
         LR    RWORK0,RWORK3                                       0258 00298000
*               RWORK5=RWORK3;      /* SET MOVE LENGTH               */ 00299000
         LR    RWORK5,RWORK3                                       0259 00300000
*               RWORK2=PLHRECP;     /* SET 'TO' ADDRESS              */ 00301000
         LR    RWORK2,@10                                          0260 00302000
*               RWORK4=RWORK2+PLHLRECL;/* SET 'FROM' ADDRESS         */ 00303000
         ALR   @15,RWORK2                                          0261 00304000
         LR    RWORK4,@15                                          0261 00305000
*               GEN(MVCL  RWORK2,RWORK4);/* MOVE RECORDS TO LEFT     */ 00306000
         MVCL  RWORK2,RWORK4                                            00307000
*               RESPECIFY                                          0263 00308000
*                (RWORK2,                                          0263 00309000
*                 RWORK3,                                          0263 00310000
*                 RWORK4,                                          0263 00311000
*                 RWORK5) UNRSTD;                                  0263 00312000
*               IF AMBJRN=ON THEN   /* IS JOURNAL EXIT SET ON        */ 00313000
         TM    AMBJRN(RAMB),B'00000010'                            0264 00314000
         BNO   @RF00264                                            0264 00315000
*                 DO;               /* YES                           */ 00316000
*                   PLHJNRBA=BUFCDDDD+/* SET NEW RBA IN JOURNAL      */ 00317000
*                       (PLHRECP-BUFCBAD);/* EXIT PARAMETER LIST     */ 00318000
         L     @10,PLHDBUFC(,RPLH)                                 0266 00319000
         L     @15,BUFCDDDD(,@10)                                  0266 00320000
         L     @14,PLHRECP(,RPLH)                                  0266 00321000
         L     @10,BUFCBAD(,@10)                                   0266 00322000
         LR    @09,@14                                             0266 00323000
         SLR   @09,@10                                             0266 00324000
         ALR   @09,@15                                             0266 00325000
         ST    @09,PLHJNRBA(,RPLH)                                 0266 00326000
*                   PLHJORBA=BUFCDDDD+((PLHRECP/* SET OLD RBA IN     */ 00327000
*                       +PLHLRECL)-BUFCBAD);/* PARAMETER LIST        */ 00328000
         AL    @14,PLHLRECL(,RPLH)                                 0267 00329000
         SLR   @14,@10                                             0267 00330000
         ALR   @15,@14                                             0267 00331000
         ST    @15,PLHJORBA(,RPLH)                                 0267 00332000
*                   PLHJRNLL=RWORK0;/* SET LENGTH IN PARM LIST       */ 00333000
         ST    RWORK0,PLHJRNLL(,RPLH)                              0268 00334000
*                   RESPECIFY                                      0269 00335000
*                    (RWORK0) UNRSTD;/*                              */ 00336000
*                   PLHJCODE=PLHJRBAC;/* SET RBA CHANGE IN LIST      */ 00337000
         MVI   PLHJCODE(RPLH),B'00001100'                          0270 00338000
*I04:                                                              0271 00339000
*                   DO;             /* IDACALL(IDATJXIT)             */ 00340000
I04      DS    0H                                                  0272 00341000
*                     CALL IDATJXIT;/* EXIT TO IDATJXIT              */ 00342000
         L     @15,@CV00968                                        0272 00343000
         BALR  @14,@15                                             0272 00344000
*                     GEN(BALR @11,0);/* LOAD ADDR OF REENTRY        */ 00345000
         BALR @11,0                                                     00346000
*                     GEN(USING *,@11);/* ESTABLISH ADDRESSING       */ 00347000
         USING *,@11                                                    00348000
*                     GEN(L     @11,=A(@PSTART));/* RELOAD BASE      */ 00349000
         L     @11,=A(@PSTART)                                          00350000
*                     GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING */ 00351000
         USING @PSTART,@11                                              00352000
*                   END I04;        /* GO TO JOURNAL ROUTINE         */ 00353000
*                   RESPECIFY                                      0278 00354000
*                    (RWORK1) RSTD; /*                               */ 00355000
*                   RWORK1=BUFCBAD+AMDCINV-/* REESTABLISH ADDRESS OF */ 00356000
*                       LENGTH(IDACIDF);/* CIDF                      */ 00357000
         L     @10,PLHDBUFC(,RPLH)                                 0279 00358000
         L     @15,AMBDSB(,RAMB)                                   0279 00359000
         L     RWORK1,BUFCBAD(,@10)                                0279 00360000
         AL    RWORK1,AMDCINV(,@15)                                0279 00361000
         SL    RWORK1,@CF00067                                     0279 00362000
*                 END;              /*                               */ 00363000
*             END;                  /*                               */ 00364000
@RF00264 DS    0H                                                  0282 00365000
*           DO;                     /*                               */ 00366000
@RF00254 DS    0H                                                  0283 00367000
*             RWORK1->CIDFOSET=RWORK1->CIDFOSET/* REDUCE FS DISP     */ 00368000
*                 -PLHLRECL;        /* IN CIDF BY RECD LNTH          */ 00369000
         L     @10,PLHLRECL(,RPLH)                                 0283 00370000
         LH    @00,CIDFOSET(,RWORK1)                               0283 00371000
         SLR   @00,@10                                             0283 00372000
         STH   @00,CIDFOSET(,RWORK1)                               0283 00373000
*             PLHFSP=PLHFSP-PLHLRECL;/* ADJUST FS PTR IN PLH         */ 00374000
         L     @00,PLHFSP(,RPLH)                                   0284 00375000
         SLR   @00,@10                                             0284 00376000
         ST    @00,PLHFSP(,RPLH)                                   0284 00377000
*             RESPECIFY                                            0285 00378000
*              (RWORK2,                                            0285 00379000
*               RWORK3,                                            0285 00380000
*               RWORK4,                                            0285 00381000
*               RWORK5) RSTD;       /*                               */ 00382000
*             RWORK2=PLHFSP;        /* POINT TO NEW FS ORIGIN        */ 00383000
         LR    RWORK2,@00                                          0286 00384000
*             RWORK3=PLHLRECL;      /* GET LENGTH OF RECORD          */ 00385000
         LR    RWORK3,@10                                          0287 00386000
*             RWORK5=ZERO;          /* SET FOR STORING ZERO          */ 00387000
         SLR   RWORK5,RWORK5                                       0288 00388000
*             GEN(MVCL  RWORK2,RWORK4);/* CLEAR OUT RESIDUE          */ 00389000
         MVCL  RWORK2,RWORK4                                            00390000
*             RESPECIFY                                            0290 00391000
*              (RWORK2,                                            0290 00392000
*               RWORK3,                                            0290 00393000
*               RWORK4,                                            0290 00394000
*               RWORK5) UNRSTD;     /*                               */ 00395000
*             RESPECIFY                                            0291 00396000
*              (RWORK0) RSTD;       /*                               */ 00397000
*             RWORK0=PLHLRECL;      /* BEGIN TO SUM FREE SPACE     0292 00398000
*                                      CHANGES                       */ 00399000
         L     RWORK0,PLHLRECL(,RPLH)                              0292 00400000
*           END;                    /*                               */ 00401000
*           IF PLHRDFP->RDFREPL=ON& /* IS CURRENT RDF A RECD         */ 00402000
*               PLHRDFP->RDFLL>TWO THEN/* COUNT WITH COUNT > 2       */ 00403000
         L     @10,PLHRDFP(,RPLH)                                  0294 00404000
         TM    RDFREPL(@10),B'00001000'                            0294 00405000
         BNO   @RF00294                                            0294 00406000
         SLR   @15,@15                                             0294 00407000
         ICM   @15,3,RDFLL(@10)                                    0294 00408000
         C     @15,@CF00146                                        0294 00409000
         BNH   @RF00294                                            0294 00410000
*             DO;                   /* YES                           */ 00411000
*               PLHRDFP->RDFLL=PLHRDFP->/* REDUCE COUNT IN RDF       */ 00412000
*                   RDFLL-ONE;      /* BY ONE                        */ 00413000
         BCTR  @15,0                                               0296 00414000
         STCM  @15,3,RDFLL(@10)                                    0296 00415000
*               IF PLHBWD=OFF THEN  /* BACKWARD DIRECTION    @ZA02289*/ 00416000
         TM    PLHBWD(RPLH),B'00010000'                            0297 00417000
         BNZ   @RF00297                                            0297 00418000
*                 DO;               /* NO, FORWARD           @ZA02289*/ 00419000
*                   PLHNOADV=ON;    /* SHOW PLH WAS ADVANCED         */ 00420000
         OI    PLHNOADV(RPLH),B'00001000'                          0299 00421000
*                   IF PLHRDFC=ONE THEN/* IS IT ONE OX03728          */ 00422000
         CLC   PLHRDFC(2,RPLH),@CH00053                            0300 00423000
         BNE   @RF00300                                            0300 00424000
*                     DO;           /*                               */ 00425000
*                       PLHRDFP=PLHRDFP-LENGTH(IDARDF);/* BUMP PTR   */ 00426000
         SL    @10,@CF00159                                        0302 00427000
         ST    @10,PLHRDFP(,RPLH)                                  0302 00428000
*                       GO TO BUFEND;/* GO CHECK BUFEND X03728       */ 00429000
         B     BUFEND                                              0303 00430000
*                     END;          /* OX03728                       */ 00431000
*                   ELSE            /*                               */ 00432000
*                     PLHRDFC=PLHRDFC-ONE;/* REDUCE PLH CNT 3728     */ 00433000
@RF00300 LH    @10,PLHRDFC(,RPLH)                                  0305 00434000
         BCTR  @10,0                                               0305 00435000
         STH   @10,PLHRDFC(,RPLH)                                  0305 00436000
*                 END;              /*                       @ZA02289*/ 00437000
*               ELSE                /* BACKWARD              @ZA02289*/ 00438000
*                 DO;               /*                       @ZA02289*/ 00439000
         B     @RC00297                                            0307 00440000
@RF00297 DS    0H                                                  0308 00441000
*                   IF RPLREQ=RPLPUT THEN/* PUT REQUEST      @ZA02289*/ 00442000
         CLI   RPLREQ(RRPL),1                                      0308 00443000
         BNE   @RF00308                                            0308 00444000
*                     DO;           /* SET POSITION          @ZA02289*/ 00445000
*                       IF PLHRDFC=ONE THEN/* COUNT EQUAL 1  @ZA02289*/ 00446000
         CLC   PLHRDFC(2,RPLH),@CH00053                            0310 00447000
         BNE   @RF00310                                            0310 00448000
*                         PLHRDFC=PLHRDFP->RDFLL;/* YES, SET COUNT 0311 00449000
*                                                            @ZA02289*/ 00450000
         L     @10,PLHRDFP(,RPLH)                                  0311 00451000
         MVC   PLHRDFC(2,RPLH),RDFLL(@10)                          0311 00452000
*                       ELSE        /* COUNT NOT ONE         @ZA02289*/ 00453000
*                         DO;       /*                       @ZA02289*/ 00454000
         B     @RC00310                                            0312 00455000
@RF00310 DS    0H                                                  0313 00456000
*                           IF PLHRDFC=PLHRDFP->RDFLL+ONE&PLHRECP< 0313 00457000
*                               PLHFSP THEN/* POINTING TO END OF   0313 00458000
*                                      GROUP AND NOT LAST RECORD   0313 00459000
*                                                            @ZA02289*/ 00460000
         L     @10,PLHRDFP(,RPLH)                                  0313 00461000
         LA    @15,1                                               0313 00462000
         SLR   @14,@14                                             0313 00463000
         ICM   @14,3,RDFLL(@10)                                    0313 00464000
         ALR   @15,@14                                             0313 00465000
         CH    @15,PLHRDFC(,RPLH)                                  0313 00466000
         BNE   @RF00313                                            0313 00467000
         CLC   PLHRECP(4,RPLH),PLHFSP(RPLH)                        0313 00468000
         BNL   @RF00313                                            0313 00469000
*                             DO;   /* YES                   @ZA02289*/ 00470000
*                               PLHRDFP=PLHRDFP-/* MOVE TO THE     0315 00471000
*                                                            @ZA02289*/ 00472000
*                                   LENGTH(IDARDF);/* NEXT RDF     0315 00473000
*                                                            @ZA02289*/ 00474000
         LA    @15,3                                               0315 00475000
         SLR   @10,@15                                             0315 00476000
         ST    @10,PLHRDFP(,RPLH)                                  0315 00477000
*                               PLHLRECL=PLHRDFP->RDFLL;/* SET LL  0316 00478000
*                                                            @ZA02289*/ 00479000
         SLR   @14,@14                                             0316 00480000
         ICM   @14,3,RDFLL(@10)                                    0316 00481000
         ST    @14,PLHLRECL(,RPLH)                                 0316 00482000
*                               IF PLHRDFP->RDFCTNU=ON THEN/*      0317 00483000
*                                      GROUP@ZA02289                 */ 00484000
         TM    RDFCTNU(@10),B'01000000'                            0317 00485000
         BNO   @RF00317                                            0317 00486000
*                                 DO;/* YES                  @ZA02289*/ 00487000
*                                   PLHRDFP=PLHRDFP-LENGTH(IDARDF);/*   00488000
*                                      MOVE TO COUNT RDF     @ZA02289*/ 00489000
         SLR   @10,@15                                             0319 00490000
         ST    @10,PLHRDFP(,RPLH)                                  0319 00491000
*                                   PLHRDFC=PLHRDFP->RDFLL;/* SET  0320 00492000
*                                      COUNT IN PLH          @ZA02289*/ 00493000
         MVC   PLHRDFC(2,RPLH),RDFLL(@10)                          0320 00494000
*                                 END;/*                     @ZA02289*/ 00495000
*                               ELSE/*                       @ZA02289*/ 00496000
*                                 PLHRDFC=ONE;/* COUNT TO 1  @ZA02289*/ 00497000
         B     @RC00317                                            0322 00498000
@RF00317 MVC   PLHRDFC(2,RPLH),@CH00053                            0322 00499000
*                             END;  /*                       @ZA02289*/ 00500000
*                           ELSE    /*                       @ZA02289*/ 00501000
*                             PLHRDFC=PLHRDFP->RDFLL-/* REDUCE COUNT    00502000
*                                                            @ZA02289*/ 00503000
*                                 PLHRDFC+ONE;/*             @ZA02289*/ 00504000
         B     @RC00313                                            0324 00505000
@RF00313 L     @10,PLHRDFP(,RPLH)                                  0324 00506000
         SLR   @15,@15                                             0324 00507000
         ICM   @15,3,RDFLL(@10)                                    0324 00508000
         SH    @15,PLHRDFC(,RPLH)                                  0324 00509000
         AL    @15,@CF00053                                        0324 00510000
         STH   @15,PLHRDFC(,RPLH)                                  0324 00511000
*                         END;      /*                       @ZA02289*/ 00512000
*                     END;          /*                       @ZA02289*/ 00513000
*                 END;              /*                       @ZA02289*/ 00514000
*             END;                  /*                               */ 00515000
*           ELSE                    /*                               */ 00516000
*             DO;                   /*                               */ 00517000
         B     @RC00294                                            0329 00518000
@RF00294 DS    0H                                                  0330 00519000
*               IF PLHRDFP->RDFREPL=ON&/* IS CURRENT RDF A RECD      */ 00520000
*                   PLHRDFP->RDFLL=ONE THEN/* COUNT WITH COUNT = 1   */ 00521000
         L     @10,PLHRDFP(,RPLH)                                  0330 00522000
         TM    RDFREPL(@10),B'00001000'                            0330 00523000
         BNO   @RF00330                                            0330 00524000
         CLC   RDFLL(2,@10),@CH00053                               0330 00525000
         BNE   @RF00330                                            0330 00526000
*                 DO;               /* YES                           */ 00527000
*                   RESPECIFY                                      0332 00528000
*                    (RWORK2,                                      0332 00529000
*                     RWORK3) RSTD; /*                               */ 00530000
*                   RWORK3=PLHRDFP+LENGTH(IDARDF);/* SET 'TO' ADDRESS   00531000
*                                      ONE RDF TO THE RIGHT          */ 00532000
         LA    @15,3                                               0333 00533000
         LR    RWORK3,@10                                          0333 00534000
         ALR   RWORK3,@15                                          0333 00535000
*                   RWORK2=PLHRDFP-LENGTH(IDARDF);/* SET           0334 00536000
*                                      'FROM'ADDRESS ONE RDF TO THE     00537000
*                                      LEFT                          */ 00538000
         SLR   @10,@15                                             0334 00539000
         LR    RWORK2,@10                                          0334 00540000
*                   RWORK0=RWORK0+TWO*LENGTH(IDARDF);/* INCREASE FREE   00541000
*                                      SPACE BY TWO RDFS             */ 00542000
         AL    RWORK0,@CF00221                                     0335 00543000
*                   PLHRDFP=RWORK3; /* UPDATE RDF POINTER TO NEXT RDF   00544000
*                                      ON RIGHT                      */ 00545000
         ST    RWORK3,PLHRDFP(,RPLH)                               0336 00546000
*                 END;              /*                               */ 00547000
*               ELSE                /*                               */ 00548000
*                 DO;               /*                               */ 00549000
         B     @RC00330                                            0338 00550000
@RF00330 DS    0H                                                  0339 00551000
*                   RWORK3=PLHRDFP; /* SET 'TO' AT CURRENT POS       */ 00552000
         L     @10,PLHRDFP(,RPLH)                                  0339 00553000
         LR    RWORK3,@10                                          0339 00554000
*                   RWORK2=PLHRDFP-LENGTH(IDARDF);/* SET 'FROM' ONE     00555000
*                                      RDF TO THE LEFT               */ 00556000
         LA    @15,3                                               0340 00557000
         LR    RWORK2,@10                                          0340 00558000
         SLR   RWORK2,@15                                          0340 00559000
*                   RWORK0=RWORK0+LENGTH(IDARDF);/* ONE RDF TO FS    */ 00560000
         ALR   RWORK0,@15                                          0341 00561000
*                   IF PLHRDFP->RDFREPL=ON&/* IS RDF A COUNT RDF WITH*/ 00562000
*                       PLHRDFP->RDFLL=TWO THEN/* THE COUNT AT 2     */ 00563000
         TM    RDFREPL(@10),B'00001000'                            0342 00564000
         BNO   @RF00342                                            0342 00565000
         CLC   RDFLL(2,@10),@CH00146                               0342 00566000
         BNE   @RF00342                                            0342 00567000
*                     DO;           /* YES                           */ 00568000
*                       PLHRDFP=PLHRDFP+LENGTH(IDARDF);/* MOVE RDF 0344 00569000
*                                      PTR ONE RDF TO RIGHT AND      */ 00570000
         ALR   @10,@15                                             0344 00571000
         ST    @10,PLHRDFP(,RPLH)                                  0344 00572000
*                       PLHRDFP->RDFCTNU=OFF;/* RESET CONTINUATION 0345 00573000
*                                      BIT                           */ 00574000
         NI    RDFCTNU(@10),B'10111111'                            0345 00575000
*                       IF(PLHBWD=OFF&PLHRDFC=ONE)|/* NEED TO      0346 00576000
*                                                            @ZA02289*/ 00577000
*                           (PLHBWD=ON&PLHRDFC=TWO/* MOVE RDF      0346 00578000
*                                                            @ZA02289*/ 00579000
*                           &PLHFSP^=PLHRECP) THEN/* TO LEFT @ZA02289*/ 00580000
         TM    PLHBWD(RPLH),B'00010000'                            0346 00581000
         BNZ   @GL00009                                            0346 00582000
         CLC   PLHRDFC(2,RPLH),@CH00053                            0346 00583000
         BE    @RT00346                                            0346 00584000
@GL00009 TM    PLHBWD(RPLH),B'00010000'                            0346 00585000
         BNO   @RF00346                                            0346 00586000
         CLC   PLHRDFC(2,RPLH),@CH00146                            0346 00587000
         BNE   @RF00346                                            0346 00588000
         CLC   PLHFSP(4,RPLH),PLHRECP(RPLH)                        0346 00589000
         BE    @RF00346                                            0346 00590000
@RT00346 DS    0H                                                  0347 00591000
*                         DO;       /* POINTER-YES           @ZA02289*/ 00592000
*                           PLHRDFP=PLHRDFP-LENGTH(IDARDF);/* MOVE 0348 00593000
*                                      LEFT                  @ZA02289*/ 00594000
         L     @10,PLHRDFP(,RPLH)                                  0348 00595000
         SL    @10,@CF00159                                        0348 00596000
         ST    @10,PLHRDFP(,RPLH)                                  0348 00597000
*                         END;      /*                       @ZA02289*/ 00598000
*                     END;          /*                               */ 00599000
@RF00346 DS    0H                                                  0351 00600000
*                 END;              /*                               */ 00601000
@RF00342 DS    0H                                                  0352 00602000
*               RESPECIFY                                          0352 00603000
*                (RWORK4,                                          0352 00604000
*                 RWORK5) RSTD;     /*                               */ 00605000
@RC00330 DS    0H                                                  0353 00606000
*               GEN(LA  RWORK4,7);  /* SET MASK FOR ICM INST.        */ 00607000
         LA  RWORK4,7                                                   00608000
*               RWORK5=PLHFSP+PLHLRECL+/* SET LIMIT TO 1ST BYTE      */ 00609000
*                   RWORK1->CIDFLL; /* AFTER FREESPACE               */ 00610000
         L     RWORK5,PLHFSP(,RPLH)                                0354 00611000
         AL    RWORK5,PLHLRECL(,RPLH)                              0354 00612000
         AH    RWORK5,CIDFLL(,RWORK1)                              0354 00613000
*               DO WHILE RWORK2^<RWORK5;/* LOOP UNTIL 'FROM' ADD.  0355 00614000
*                                      FALLS INTO FREESPACE          */ 00615000
         B     @DE00355                                            0355 00616000
@DL00355 DS    0H                                                  0356 00617000
*                 GEN(EX  RWORK4,GETRDF);/* PICK UP AN RDF AND PUT   */ 00618000
         EX  RWORK4,GETRDF                                              00619000
*                 GEN(EX  RWORK4,PUTRDF);/* IT IN NEW LOCATION       */ 00620000
         EX  RWORK4,PUTRDF                                              00621000
*                 RWORK2=RWORK2-LENGTH(IDARDF);/* ADJUST 'FROM' ADDR.*/ 00622000
         LA    @10,3                                               0358 00623000
         SLR   RWORK2,@10                                          0358 00624000
*                 RWORK3=RWORK3-LENGTH(IDARDF);/* ADJUST 'TO' ADDRESS*/ 00625000
         SLR   RWORK3,@10                                          0359 00626000
*               END;                /*                               */ 00627000
@DE00355 CLR   RWORK2,RWORK5                                       0360 00628000
         BNL   @DL00355                                            0360 00629000
*               RWORK2=RWORK5;      /* POINT TO PREVIOUS LEFTMOST RDF*/ 00630000
         LR    RWORK2,RWORK5                                       0361 00631000
*               RWORK3=RWORK0-PLHLRECL;/* GET LENGTH OF RDF MOVE     */ 00632000
         LR    RWORK3,RWORK0                                       0362 00633000
         SL    RWORK3,PLHLRECL(,RPLH)                              0362 00634000
*               RWORK5=ZERO;        /* SET TO STORE ZERO             */ 00635000
         SLR   RWORK5,RWORK5                                       0363 00636000
*               GEN(MVCL  RWORK2,RWORK4);/* ERASE RESIDUE RDF        */ 00637000
         MVCL  RWORK2,RWORK4                                            00638000
*               RESPECIFY                                          0365 00639000
*                (RWORK2,                                          0365 00640000
*                 RWORK3,                                          0365 00641000
*                 RWORK4,                                          0365 00642000
*                 RWORK5) UNRSTD;   /*                               */ 00643000
*               IF PLHBWD=OFF|RPLREQ=RPLPUT THEN/* FORWARD DIRECTION    00644000
*                                      OR PUT                @ZA02289*/ 00645000
         TM    PLHBWD(RPLH),B'00010000'                            0366 00646000
         BZ    @RT00366                                            0366 00647000
         CLI   RPLREQ(RRPL),1                                      0366 00648000
         BNE   @RF00366                                            0366 00649000
@RT00366 DS    0H                                                  0367 00650000
*                 DO;               /* YES                   @ZA02289*/ 00651000
*BUFEND:                                                           0368 00652000
*                   IF PLHRECP^<PLHFSP&PLHBWD=OFF THEN/* ARE WE AT 0368 00653000
*                                      END AND FORWARD       @ZA02289*/ 00654000
BUFEND   CLC   PLHRECP(4,RPLH),PLHFSP(RPLH)                        0368 00655000
         BL    @RF00368                                            0368 00656000
         TM    PLHBWD(RPLH),B'00010000'                            0368 00657000
         BNZ   @RF00368                                            0368 00658000
*                     DO;           /* YES                           */ 00659000
*                       PLHNOADV=OFF;/* SHOW PLH NOT ADVANCED        */ 00660000
         NI    PLHNOADV(RPLH),B'11110111'                          0370 00661000
*                       PLHLRECL=ZERO;/* SHOW NO RECORD LENGTH       */ 00662000
         SLR   @10,@10                                             0371 00663000
         ST    @10,PLHLRECL(,RPLH)                                 0371 00664000
*                     END;          /*                               */ 00665000
*                   ELSE            /*                               */ 00666000
*                     DO;           /*                               */ 00667000
         B     @RC00368                                            0373 00668000
@RF00368 DS    0H                                                  0374 00669000
*                       PLHLRECL=PLHRDFP->RDFLL;/* SET PLH RECORD  0374 00670000
*                                      LENGTH FROM RDF               */ 00671000
         L     @10,PLHRDFP(,RPLH)                                  0374 00672000
         SLR   @15,@15                                             0374 00673000
         ICM   @15,3,RDFLL(@10)                                    0374 00674000
         ST    @15,PLHLRECL(,RPLH)                                 0374 00675000
*                       IF PLHRDFP->RDFCTNU=ON THEN/* IS THIS A    0375 00676000
*                                      REPLICATED RDF                */ 00677000
         TM    RDFCTNU(@10),B'01000000'                            0375 00678000
         BNO   @RF00375                                            0375 00679000
*                         DO;       /* YES, MOVE RDF POINTER         */ 00680000
*                           PLHRDFP=PLHRDFP-LENGTH(IDARDF);/* TO RDF    00681000
*                                      WITH CT                       */ 00682000
         SL    @10,@CF00159                                        0377 00683000
         ST    @10,PLHRDFP(,RPLH)                                  0377 00684000
*                           PLHRDFC=PLHRDFP->RDFLL;/* SET PLH RECORD    00685000
*                                      COUNT FROM RDF COUNT          */ 00686000
         MVC   PLHRDFC(2,RPLH),RDFLL(@10)                          0378 00687000
*                         END;      /*                               */ 00688000
*                       ELSE        /* FOR NON REPLICATED RDF        */ 00689000
*                         DO;       /* SET COUNT IN                  */ 00690000
         B     @RC00375                                            0380 00691000
@RF00375 DS    0H                                                  0381 00692000
*                           PLHRDFC=ONE;/* PLH TO ONE                */ 00693000
         MVC   PLHRDFC(2,RPLH),@CH00053                            0381 00694000
*                         END;      /*                               */ 00695000
*                       IF PLHBWD=OFF THEN/* IF FORWARD      @ZA02289*/ 00696000
@RC00375 TM    PLHBWD(RPLH),B'00010000'                            0383 00697000
         BNZ   @RF00383                                            0383 00698000
*                         PLHNOADV=ON;/* SHOW PLH ADVANCED           */ 00699000
         OI    PLHNOADV(RPLH),B'00001000'                          0384 00700000
*                     END;          /*                               */ 00701000
@RF00383 DS    0H                                                  0386 00702000
*                 END;              /*                       @ZA02289*/ 00703000
@RC00368 DS    0H                                                  0387 00704000
*             END;                  /*                               */ 00705000
@RF00366 DS    0H                                                  0388 00706000
*           RWORK1->CIDFLL=RWORK1->CIDFLL/* UPDATE FREE SPACE        */ 00707000
*               +RWORK0;            /* LENGTH IN CIDF                */ 00708000
@RC00294 LR    @10,RWORK0                                          0388 00709000
         LH    @15,CIDFLL(,RWORK1)                                 0388 00710000
         ALR   @10,@15                                             0388 00711000
         STH   @10,CIDFLL(,RWORK1)                                 0388 00712000
*           IF RPLREQ=RPLPUT THEN   /* IS THIS AN UPDATE REQ.        */ 00713000
         CLI   RPLREQ(RRPL),1                                      0389 00714000
         BNE   @RF00389                                            0389 00715000
*             DO;                   /* YES                           */ 00716000
*               BUFXORBA=BUFCDDDD;  /* EXCL OUT RBA          @ZA17187*/ 00717000
         L     @10,PLHDBUFC(,RPLH)                                 0391 00718000
         L     @15,BUFCDDDD(,@10)                                  0391 00719000
         ST    @15,BUFXORBA(,@10)                                  0391 00720000
*               DO;                 /* SET UPDATED BFR               */ 00721000
*                 BUFCORBA=BUFCDDDD;                               0393 00722000
         ST    @15,BUFCORBA(,@10)                                  0393 00723000
*                 BUFCMW=ON;                                       0394 00724000
         OI    BUFCMW(@10),B'10000000'                             0394 00725000
*               END;                /* SET UPDATE WRITE              */ 00726000
*I06:                                                              0396 00727000
*               DO;                 /* IDACALL(IDA019RM)             */ 00728000
I06      DS    0H                                                  0397 00729000
*                 CALL IDA019RM;    /* EXIT TO IDA019RM              */ 00730000
         L     @15,@CV00969                                        0397 00731000
         BALR  @14,@15                                             0397 00732000
*                 GEN(BALR @11,0);  /* LOAD ADDR OF REENTRY          */ 00733000
         BALR @11,0                                                     00734000
*                 GEN(USING *,@11); /* ESTABLISH ADDRESSING          */ 00735000
         USING *,@11                                                    00736000
*                 GEN(L     @11,=A(@PSTART));/* RELOAD BASE          */ 00737000
         L     @11,=A(@PSTART)                                          00738000
*                 GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING     */ 00739000
         USING @PSTART,@11                                              00740000
*               END I06;            /* CALL DATA INSERT              */ 00741000
*               GEN(IDARST14);      /* RESTORE REG 14                */ 00742000
         IDARST14                                                       00743000
*               RETURN;             /* RETURN TO CALLER              */ 00744000
         B     @EL00001                                            0404 00745000
*             END;                  /*                               */ 00746000
*         END;                      /*                               */ 00747000
*       ELSE                        /* ILLEGAL FUNCTION OF           */ 00748000
*         DO;                       /* ERASE WITH CHRON SEQ DS       */ 00749000
         B     @RC00214                                            0407 00750000
@RF00214 DS    0H                                                  0408 00751000
*           RPLERREG='08'X;         /* SO SET ERROR INDICATORS       */ 00752000
         MVI   RPLERREG(RRPL),X'08'                                0408 00753000
*           RPLERRCD=RPLERSER;      /* IN REGISTER AND RPL           */ 00754000
         MVI   RPLERRCD(RRPL),X'50'                                0409 00755000
*           GEN(IDARST14);          /* RESTORE REG14 AND             */ 00756000
         IDARST14                                                       00757000
*           RETURN;                 /* RETURN TO CALLER              */ 00758000
         B     @EL00001                                            0411 00759000
*         END;                                                     0412 00760000
*     END;                                                         0413 00761000
@RC00214 DS    0H                                                  0414 00762000
*   BUFXORBA=BUFCDDDD;              /* EXCL OUT RBA          @ZA17187*/ 00763000
@RC00160 L     @10,PLHDBUFC(,RPLH)                                 0414 00764000
         L     @15,BUFCDDDD(,@10)                                  0414 00765000
         ST    @15,BUFXORBA(,@10)                                  0414 00766000
*   DO;                             /* SET UPDATED BFR               */ 00767000
*     BUFCORBA=BUFCDDDD;                                           0416 00768000
         ST    @15,BUFCORBA(,@10)                                  0416 00769000
*     BUFCMW=ON;                                                   0417 00770000
         OI    BUFCMW(@10),B'10000000'                             0417 00771000
*   END;                            /* SET UPDATE WRITE              */ 00772000
*   GEN(IDARST14);                  /* RESTORE REG 14                */ 00773000
         IDARST14                                                       00774000
*   RETURN;                         /*                               */ 00775000
         B     @EL00001                                            0420 00776000
*                                                                  0421 00777000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00778000
*/*    SPLITCI SUBROUTINE                                    @ZA02289*/ 00779000
*/*     FUNCTION:                                            @ZA02289*/ 00780000
*/*      OBTAINS DIWA                                        @ZA02289*/ 00781000
*/*      SETS ARDB IN PLH                                    @ZA02289*/ 00782000
*/*      CALLS CI SPLIT                                      @ZA02289*/ 00783000
*/*      FREES DIWA                                          @ZA02289*/ 00784000
*/*      CHECKS FOR ERRORS                                   @ZA02289*/ 00785000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00786000
*                                                                  0421 00787000
*SPLITCI:                           /* NAME                  @ZA02289*/ 00788000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/* PROCEDURE             @ZA02289*/ 00789000
SPLITCI  DS    0H                                                  0422 00790000
*   GEN(IDASVR14);                  /* SAVE R14              @ZA02289*/ 00791000
         IDASVR14                                                       00792000
*   IF AMBLSR=ON|AMBGSR=ON THEN     /* SHARED RESOURSES      @ZA02289*/ 00793000
         TM    AMBLSR(RAMB),B'01100000'                            0423 00794000
         BZ    @RF00423                                            0423 00795000
*     DO;                           /* YES                   @ZA02289*/ 00796000
*       RBUFC=PLHIBUFC;             /* POINT TO SEQ SET      @ZA02289*/ 00797000
         L     RBUFC,PLHIBUFC(,RPLH)                               0425 00798000
*       IF RBUFC^=ZERO THEN         /* OWNED BY PLH          @ZA02289*/ 00799000
         LTR   RBUFC,RBUFC                                         0426 00800000
         BZ    @RF00426                                            0426 00801000
*I08:                                                              0427 00802000
*         DO;                       /* IDACALL(IDAFREEB)             */ 00803000
I08      DS    0H                                                  0428 00804000
*           CALL IDAFREEB;          /* EXIT TO IDAFREEB              */ 00805000
         L     @15,@CV00974                                        0428 00806000
         BALR  @14,@15                                             0428 00807000
*           GEN(BALR @11,0);        /* LOAD ADDR OF REENTRY          */ 00808000
         BALR @11,0                                                     00809000
*           GEN(USING *,@11);       /* ESTABLISH ADDRESSING          */ 00810000
         USING *,@11                                                    00811000
*           GEN(L     @11,=A(@PSTART));/* RELOAD BASE                */ 00812000
         L     @11,=A(@PSTART)                                          00813000
*           GEN(USING @PSTART,@11); /* ESTABLISH ADDRESSING          */ 00814000
         USING @PSTART,@11                                              00815000
*         END I08;                  /* YES, FREE IT          @ZA02289*/ 00816000
*     END;                          /*                       @ZA02289*/ 00817000
@RF00426 DS    0H                                                  0435 00818000
*LOCKDIWA:                          /* LOCK DIWA             @ZA02289*/ 00819000
*   RPARM1=ADDR(DIWATV);            /* POINT TO LOCK BYTE    @ZA02289*/ 00820000
@RF00423 DS    0H                                                  0435 00821000
LOCKDIWA L     RPARM1,AMBIWA(,RAMB)                                0435 00822000
         LA    RPARM1,DIWATV(,RPARM1)                              0435 00823000
*   GEN(TS 0(RPARM1));              /* TEST AND SET          @ZA02289*/ 00824000
         TS 0(RPARM1)                                                   00825000
*   BC(8,HAVEDIWA);                 /* OBTAINED DIWA         @ZA02289*/ 00826000
         BC    8,HAVEDIWA                                          0437 00827000
*   RFY                                                            0438 00828000
*     RWORK0 RSTD;                  /*                       @ZA02289*/ 00829000
*   RWORK0=DEFR0;                   /* DATA INSERT REQUEST   @ZA02289*/ 00830000
         SLR   RWORK0,RWORK0                                       0439 00831000
*I09:                                                              0440 00832000
*   DO;                             /* IDACALL(IDADRQ)               */ 00833000
I09      DS    0H                                                  0441 00834000
*     CALL IDADRQ;                  /* EXIT TO IDADRQ                */ 00835000
         L     @15,@CV00972                                        0441 00836000
         BALR  @14,@15                                             0441 00837000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00838000
         BALR @11,0                                                     00839000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00840000
         USING *,@11                                                    00841000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00842000
         L     @11,=A(@PSTART)                                          00843000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00844000
         USING @PSTART,@11                                              00845000
*   END I09;                        /* GO DEFER              @ZA02289*/ 00846000
*   GO TO LOCKDIWA;                 /* TRY AGAIN             @ZA02289*/ 00847000
         B     LOCKDIWA                                            0447 00848000
*   RFY                                                            0448 00849000
*     RWORK0 UNRSTD;                /*                       @ZA02289*/ 00850000
*HAVEDIWA:                          /* HAVE DIWA             @ZA02289*/ 00851000
*   DIWPLH=RPLH;                    /* IDENTIFY LOCKING PLH  @ZA32757*/ 00852000
HAVEDIWA L     @10,AMBIWA(,RAMB)                                   0449 00853000
         ST    RPLH,DIWPLH(,@10)                                   0449 00854000
*   IF PLHIBUFC=ZERO THEN           /* NEED SEQ SET          @ZA02289*/ 00855000
         L     @10,PLHIBUFC(,RPLH)                                 0450 00856000
         LTR   @10,@10                                             0450 00857000
         BNZ   @RF00450                                            0450 00858000
*     DO;                           /* YES                   @ZA02289*/ 00859000
*       RAMB=AMBLIX;                /* POINT TO INDEX        @ZA02289*/ 00860000
         L     @10,RPLDACB(,RRPL)                                  0452 00861000
         L     @10,ACBAMBL(,@10)                                   0452 00862000
         L     RAMB,AMBLIX(,@10)                                   0452 00863000
*       RPARM1=ADDR(PLHIXSPL);      /* POINT TO PARM LIST    @ZA02289*/ 00864000
         LA    RPARM1,PLHIXSPL(,RPLH)                              0453 00865000
*       RPARM1->IXSILN=ONE;         /* SET LEVEL AT 1        @ZA02289*/ 00866000
         MVI   IXSILN(RPARM1),X'01'                                0454 00867000
*       PLHSSR=ON;                  /* SHOW SEQ SET          @ZA02289*/ 00868000
         OI    PLHSSR(RPLH),B'00010000'                            0455 00869000
*       RPARM1=PLHSSRBA;            /* SET RBA               @ZA02289*/ 00870000
         L     RPARM1,PLHSSRBA(,RPLH)                              0456 00871000
*I10:                                                              0457 00872000
*       DO;                         /* IDACALL(IDAGRB)               */ 00873000
I10      DS    0H                                                  0458 00874000
*         CALL IDAGRB;              /* EXIT TO IDAGRB                */ 00875000
         L     @15,@CV00975                                        0458 00876000
         BALR  @14,@15                                             0458 00877000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00878000
         BALR @11,0                                                     00879000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00880000
         USING *,@11                                                    00881000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00882000
         L     @11,=A(@PSTART)                                          00883000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00884000
         USING @PSTART,@11                                              00885000
*       END I10;                    /* READ SEQ SET          @ZA02289*/ 00886000
*       RAMB=AMBLDTA;               /* RESET AMB             @ZA02289*/ 00887000
         L     @10,RPLDACB(,RRPL)                                  0464 00888000
         L     @10,ACBAMBL(,@10)                                   0464 00889000
         L     RAMB,AMBLDTA(,@10)                                  0464 00890000
*       IF RPLERREG^=ZERO THEN      /* ERROR                 @ZA02289*/ 00891000
         CLI   RPLERREG(RRPL),0                                    0465 00892000
         BE    @RF00465                                            0465 00893000
*         DO;                       /* YES                   @ZA02289*/ 00894000
*           DIWATV=ZERO;            /* RELEASE DIWA          @ZA02289*/ 00895000
         L     @10,AMBIWA(,RAMB)                                   0467 00896000
         MVI   DIWATV(@10),X'00'                                   0467 00897000
*           GEN(IDARST14);          /* POINT TO CALLER       @ZA02289*/ 00898000
         IDARST14                                                       00899000
*           GEN(IDARST14);          /* CALLERS CALLER        @ZA02289*/ 00900000
         IDARST14                                                       00901000
*           RETURN;                 /* OUT                   @ZA02289*/ 00902000
@EL00002 DS    0H                                                  0470 00903000
@EF00002 DS    0H                                                  0470 00904000
@ER00002 BR    @14                                                 0470 00905000
*         END;                      /*                       @ZA02289*/ 00906000
*     END;                          /*                       @ZA02289*/ 00907000
@RF00465 DS    0H                                                  0473 00908000
*   IF PLHARDB=ZERO THEN            /* IF NO ARDB IN         @ZA02289*/ 00909000
@RF00450 L     @10,PLHARDB(,RPLH)                                  0473 00910000
         LTR   @10,@10                                             0473 00911000
         BNZ   @RF00473                                            0473 00912000
*     PLHARDB=AMDPARDB;             /* PLH, SET ONE          @ZA02289*/ 00913000
         L     @10,AMBDSB(,RAMB)                                   0474 00914000
         L     @10,AMDPARDB(,@10)                                  0474 00915000
         ST    @10,PLHARDB(,RPLH)                                  0474 00916000
*   IF AMDRANGE=ON THEN             /* NEED KR CHECK         @ZA02289*/ 00917000
@RF00473 L     @10,AMBDSB(,RAMB)                                   0475 00918000
         TM    AMDRANGE(@10),B'00000100'                           0475 00919000
         BNO   @RF00475                                            0475 00920000
*     DO;                           /* YES                   @ZA02289*/ 00921000
*       RWORK1=RPLAREA+AMDRKP;      /* POINT TO KEY          @ZA02289*/ 00922000
         LH    RWORK1,AMDRKP(,@10)                                 0477 00923000
         AL    RWORK1,RPLAREA(,RRPL)                               0477 00924000
*       RFY                                                        0478 00925000
*         RWORK2 RSTD;              /*                       @ZA02289*/ 00926000
*       RWORK2=AMDKEYLN;            /* GET KEY LENGTH        @ZA02289*/ 00927000
         LH    RWORK2,AMDKEYLN(,@10)                               0479 00928000
*I11:                                                              0480 00929000
*       DO;                         /* IDACALL(IDACHKKR)             */ 00930000
I11      DS    0H                                                  0481 00931000
*         CALL IDACHKKR;            /* EXIT TO IDACHKKR              */ 00932000
         L     @15,@CV00973                                        0481 00933000
         BALR  @14,@15                                             0481 00934000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00935000
         BALR @11,0                                                     00936000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00937000
         USING *,@11                                                    00938000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00939000
         L     @11,=A(@PSTART)                                          00940000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00941000
         USING @PSTART,@11                                              00942000
*       END I11;                    /* GO CHECK              @ZA02289*/ 00943000
*       RFY                                                        0487 00944000
*         RWORK2 UNRSTD;            /*                       @ZA02289*/ 00945000
*       IF RPLERREG^=ZERO THEN      /* ERROR ON KR           @ZA02289*/ 00946000
         CLI   RPLERREG(RRPL),0                                    0488 00947000
         BE    @RF00488                                            0488 00948000
*         DO;                       /* YES                   @ZA02289*/ 00949000
*           DIWATV=ZERO;            /* RELEASE DIWA          @ZA02289*/ 00950000
         L     @10,AMBIWA(,RAMB)                                   0490 00951000
         MVI   DIWATV(@10),X'00'                                   0490 00952000
*           GEN(IDARST14);          /* R14 TO CALLER         @ZA02289*/ 00953000
         IDARST14                                                       00954000
*           GEN(IDARST14);          /* R14 TO CALLERS CALLER @ZA02289*/ 00955000
         IDARST14                                                       00956000
*           RETURN;                 /* LEAVE NOW             @ZA02289*/ 00957000
         B     @EL00002                                            0493 00958000
*         END;                      /*                       @ZA02289*/ 00959000
*     END;                          /*                       @ZA02289*/ 00960000
@RF00488 DS    0H                                                  0496 00961000
*I12:                                                              0496 00962000
*   DO;                             /* IDACALL(IDA019RE)             */ 00963000
@RF00475 DS    0H                                                  0496 00964000
I12      DS    0H                                                  0497 00965000
*     CALL IDA019RE;                /* EXIT TO IDA019RE              */ 00966000
         L     @15,@CV00971                                        0497 00967000
         BALR  @14,@15                                             0497 00968000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00969000
         BALR @11,0                                                     00970000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00971000
         USING *,@11                                                    00972000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00973000
         L     @11,=A(@PSTART)                                          00974000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00975000
         USING @PSTART,@11                                              00976000
*   END I12;                        /* SPLIT CI              @ZA02289*/ 00977000
*   DIWATV=ZERO;                    /* RELEASE DIWA          @ZA02289*/ 00978000
         L     @10,AMBIWA(,RAMB)                                   0503 00979000
         MVI   DIWATV(@10),X'00'                                   0503 00980000
*   GEN(BR    @00);                 /* ASSURE UPDATE         @ZA02289*/ 00981000
         BR    @00                                                      00982000
*   GEN(IDARST14);                  /* R14 TO CALLER         @ZA02289*/ 00983000
         IDARST14                                                       00984000
*   IF RPLERREG^=ZERO THEN          /* ERROR                 @ZA02289*/ 00985000
         CLI   RPLERREG(RRPL),0                                    0506 00986000
         BE    @RF00506                                            0506 00987000
*     DO;                           /* YES                   @ZA02289*/ 00988000
*       GEN(IDARST14);              /* R14 TO CALLERS CALLER @ZA02289*/ 00989000
         IDARST14                                                       00990000
*       RETURN;                     /* LEAVE NOW             @ZA02289*/ 00991000
         B     @EL00002                                            0509 00992000
*     END;                          /*                       @ZA02289*/ 00993000
*   END SPLITCI;                    /*                       @ZA02289*/ 00994000
         B     @EL00002                                            0511 00995000
*   GEN;                                                           0512 00996000
GETRDF   ICM   RPARM1,@00,@00(RWORK2)      /*                        */ 00997000
PUTRDF   STCM  RPARM1,@00,@00(RWORK3)      /*                        */ 00998000
*   GEN(IDAPATCH);                  /* ESTABLISH PATCH SPACE         */ 00999000
         IDAPATCH                                                       01000000
*   END IDA019RL                                                   0514 01001000
*                                                                  0514 01002000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01003000
*/*%INCLUDE SYSLIB  (IDAREGS )                                       */ 01004000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 01005000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 01006000
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */ 01007000
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */ 01008000
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */ 01009000
*/*%INCLUDE SYSLIB  (IDACIDF )                                       */ 01010000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */ 01011000
*/*%INCLUDE SYSLIB  (IDAARDB )                                       */ 01012000
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */ 01013000
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */ 01014000
*/*%INCLUDE SYSLIB  (IDADIWA )                                       */ 01015000
*/*%INCLUDE SYSLIB  (LCGPLSSW)                                       */ 01016000
*/*%INCLUDE SYSLIB  (IDAIXSPL)                                       */ 01017000
*/*%INCLUDE SYSLIB  (IDARDF  )                                       */ 01018000
*                                                                  0514 01019000
*       ;                                                          0514 01020000
         B     @EL00001                                            0514 01021000
@DATA    DS    0H                                                       01022000
@SC01036 CLC   AMDATA(0,@15),PLHKEY(@14)                                01023000
@DATD    DSECT                                                          01024000
         DS    0F                                                       01025000
IDA019RL CSECT                                                          01026000
         DS    0F                                                       01027000
@CF00053 DC    F'1'                                                     01028000
@CH00053 EQU   @CF00053+2                                               01029000
@CF00146 DC    F'2'                                                     01030000
@CH00146 EQU   @CF00146+2                                               01031000
@CF00159 DC    F'3'                                                     01032000
@CF00067 DC    F'4'                                                     01033000
@CF00221 DC    F'6'                                                     01034000
@CF00199 DC    F'7'                                                     01035000
@CF00224 DC    F'9'                                                     01036000
@DATD    DSECT                                                          01037000
         DS    0D                                                       01038000
IDA019RL CSECT                                                          01039000
         DS    0F                                                       01040000
@SIZDATD DC    AL1(0)                                                   01041000
         DC    AL3(@ENDDATD-@DATD)                                      01042000
@CV00968 DC    V(IDATJXIT)                                              01043000
@CV00969 DC    V(IDA019RM)                                              01044000
@CV00970 DC    V(IDA019RS)                                              01045000
@CV00971 DC    V(IDA019RE)                                              01046000
@CV00972 DC    V(IDADRQ)                                                01047000
@CV00973 DC    V(IDACHKKR)                                              01048000
@CV00974 DC    V(IDAFREEB)                                              01049000
@CV00975 DC    V(IDAGRB)                                                01050000
         DS    0D                                                       01051000
HWORD4   DC    H'4'                                                     01052000
@DATD    DSECT                                                          01053000
*                                                          /*@X04SVLC*/ 01054000
RDFCTNUA EQU   X'40'                    COMPLEX RDF INDICATOR           01055000
RDFCTNUX EQU   X'FF'-RDFCTNUA           RESET COMPLEX MASK              01056000
RDFREPLA EQU   X'08'                    COUNT RDF INDICATOR             01057000
RDFREPLX EQU   X'FF'-RDFREPLA           RESET COUNT MASK                01058000
RDFEMPTI EQU   X'04'                    EMPTY RECORD       /*@X04SVLC*/ 01059000
RDFLEN   EQU   3                        LENGTH OF RDF                   01060000
RDFLLOFF EQU   1                        OFFSET WITHIN RDF TO LL         01061000
RDFSGLR  EQU   X'00'                   MASK FOR SINGLE RECORD RDF       01062000
RDFGRP   EQU   RDFCTNUA                 MASK FOR LL RDF OF A GROUP RDF  01063000
RDFCNT   EQU   RDFREPLA                 MASK FOR COUNT RDF              01064000
@DATD    DSECT                                                          01065000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01066000
@ENDDATD EQU   *                                                        01067000
IDA019RL CSECT                                                          01068000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01069000
@01      EQU   01                                                       01070000
@02      EQU   02                                                       01071000
@03      EQU   03                                                       01072000
@04      EQU   04                                                       01073000
@05      EQU   05                                                       01074000
@06      EQU   06                                                       01075000
@07      EQU   07                                                       01076000
@08      EQU   08                                                       01077000
@09      EQU   09                                                       01078000
@10      EQU   10                                                       01079000
@11      EQU   11                                                       01080000
@12      EQU   12                                                       01081000
@13      EQU   13                                                       01082000
@14      EQU   14                                                       01083000
@15      EQU   15                                                       01084000
RWORK0   EQU   @00                                                      01085000
RRPL     EQU   @01                                                      01086000
RPLH     EQU   @02                                                      01087000
RAMB     EQU   @03                                                      01088000
RBUFC    EQU   @04                                                      01089000
RWORK1   EQU   @05                                                      01090000
RWORK2   EQU   @06                                                      01091000
RWORK3   EQU   @07                                                      01092000
RWORK4   EQU   @08                                                      01093000
RWORK5   EQU   @09                                                      01094000
RPARM1   EQU   @12                                                      01095000
R1       EQU   @01                                                      01096000
R10      EQU   @10                                                      01097000
R11      EQU   @11                                                      01098000
R13      EQU   @13                                                      01099000
R14      EQU   @14                                                      01100000
R15      EQU   @15                                                      01101000
IFGRPL   EQU   0                                                        01102000
RPLCOMN  EQU   IFGRPL                                                   01103000
RPLIDWD  EQU   RPLCOMN                                                  01104000
RPLREQ   EQU   RPLIDWD+2                                                01105000
RPLLEN   EQU   RPLIDWD+3                                                01106000
RPLECB   EQU   RPLCOMN+8                                                01107000
RPLFDBWD EQU   RPLCOMN+12                                               01108000
RPLFDBK  EQU   RPLFDBWD+1                                               01109000
RPLRTNCD EQU   RPLFDBK                                                  01110000
RPLERREG EQU   RPLRTNCD                                                 01111000
RPLCNDCD EQU   RPLFDBK+1                                                01112000
RPLCMPON EQU   RPLCNDCD                                                 01113000
RPLFDB2  EQU   RPLCMPON                                                 01114000
RPLERRCD EQU   RPLCNDCD+1                                               01115000
RPLFDB3  EQU   RPLERRCD                                                 01116000
RPLKEYLE EQU   RPLCOMN+16                                               01117000
RPLDACB  EQU   RPLCOMN+24                                               01118000
RPLAREA  EQU   RPLCOMN+32                                               01119000
RPLARG   EQU   RPLCOMN+36                                               01120000
RPLOPTCD EQU   RPLCOMN+40                                               01121000
RPLOPT1  EQU   RPLOPTCD                                                 01122000
RPLECBSW EQU   RPLOPT1                                                  01123000
RPLOPT2  EQU   RPLOPTCD+1                                               01124000
RPLADR   EQU   RPLOPT2                                                  01125000
RPLOPT3  EQU   RPLOPTCD+2                                               01126000
RPLNXTRP EQU   RPLCOMN+44                                               01127000
RPLRLEN  EQU   RPLCOMN+48                                               01128000
RPLOPTC2 EQU   RPLCOMN+56                                               01129000
RPLOPT5  EQU   RPLOPTC2                                                 01130000
RPLWRTYP EQU   RPLOPT5                                                  01131000
RPLOPT6  EQU   RPLOPTC2+1                                               01132000
RPLUNTYP EQU   RPLOPT6                                                  01133000
RPLOPT7  EQU   RPLOPTC2+2                                               01134000
RPLCNOPT EQU   RPLOPT7                                                  01135000
RPLOPT8  EQU   RPLOPTC2+3                                               01136000
RPLRBAR  EQU   RPLCOMN+60                                               01137000
RPLAIXID EQU   RPLRBAR+2                                                01138000
RPLEXTDS EQU   RPLCOMN+68                                               01139000
RPLEXTD1 EQU   RPLEXTDS                                                 01140000
IFGACB   EQU   0                                                        01141000
ACBCOMN  EQU   IFGACB                                                   01142000
ACBLENG  EQU   ACBCOMN+2                                                01143000
ACBLENG2 EQU   ACBLENG                                                  01144000
ACBAMBL  EQU   ACBCOMN+4                                                01145000
ACBJWA   EQU   ACBAMBL                                                  01146000
ACBMACRF EQU   ACBCOMN+12                                               01147000
ACBMACR1 EQU   ACBMACRF                                                 01148000
ACBADR   EQU   ACBMACR1                                                 01149000
ACBCNV   EQU   ACBMACR1                                                 01150000
ACBMACR2 EQU   ACBMACRF+1                                               01151000
ACBBUFPL EQU   ACBCOMN+20                                               01152000
ACBMACR3 EQU   ACBBUFPL                                                 01153000
ACBRECFM EQU   ACBCOMN+24                                               01154000
ACBCCTYP EQU   ACBCOMN+25                                               01155000
ACBOPT   EQU   ACBCOMN+26                                               01156000
ACBDSORG EQU   ACBOPT                                                   01157000
ACBCROPS EQU   ACBDSORG                                                 01158000
ACBEXLST EQU   ACBCOMN+36                                               01159000
ACBDDNM  EQU   ACBCOMN+40                                               01160000
ACBAMETH EQU   ACBDDNM+3                                                01161000
ACBOFLGS EQU   ACBCOMN+48                                               01162000
ACBEXFG  EQU   ACBOFLGS                                                 01163000
ACBIOSFG EQU   ACBOFLGS                                                 01164000
ACBINFLG EQU   ACBCOMN+50                                               01165000
ACBUJFCB EQU   ACBCOMN+52                                               01166000
ACBBLKSZ EQU   ACBCOMN+60                                               01167000
IDAAMBL  EQU   0                                                        01168000
AMBLEOV  EQU   IDAAMBL+12                                               01169000
AMBLEFLG EQU   AMBLEOV                                                  01170000
AMBLDDNM EQU   IDAAMBL+16                                               01171000
AMBLIDF  EQU   AMBLDDNM                                                 01172000
AMBLQ    EQU   AMBLIDF+7                                                01173000
AMBLVC   EQU   IDAAMBL+28                                               01174000
AMBLTYPE EQU   IDAAMBL+30                                               01175000
AMBLSHAR EQU   IDAAMBL+33                                               01176000
AMBLFLG1 EQU   IDAAMBL+35                                               01177000
AMBLFLG2 EQU   IDAAMBL+36                                               01178000
AMBLDTA  EQU   IDAAMBL+52                                               01179000
AMBLIX   EQU   IDAAMBL+56                                               01180000
IDAPLHDR EQU   0                                                        01181000
IDAPLH   EQU   0                                                        01182000
PLHFLG1  EQU   IDAPLH+2                                                 01183000
PLHSSR   EQU   PLHFLG1                                                  01184000
PLHFLG2  EQU   IDAPLH+3                                                 01185000
PLHEFLGS EQU   IDAPLH+4                                                 01186000
PLHNOADV EQU   PLHEFLGS                                                 01187000
PLHFLG3  EQU   IDAPLH+6                                                 01188000
PLHBWD   EQU   PLHFLG3                                                  01189000
PLHAFLGS EQU   IDAPLH+7                                                 01190000
PLHCRBA  EQU   IDAPLH+28                                                01191000
PLHJORBA EQU   PLHCRBA                                                  01192000
PLHJRNLL EQU   IDAPLH+32                                                01193000
PLHJNRBA EQU   IDAPLH+36                                                01194000
PLHJCODE EQU   IDAPLH+40                                                01195000
PLHRSCS  EQU   IDAPLH+43                                                01196000
PLHARDB  EQU   IDAPLH+44                                                01197000
PLHLRECL EQU   IDAPLH+48                                                01198000
PLHDBUFC EQU   IDAPLH+52                                                01199000
PLHRECP  EQU   IDAPLH+60                                                01200000
PLHFSP   EQU   IDAPLH+64                                                01201000
PLHRDFP  EQU   IDAPLH+68                                                01202000
PLHRDFC  EQU   IDAPLH+72                                                01203000
PLHDIOB  EQU   IDAPLH+76                                                01204000
PLHRETO  EQU   IDAPLH+116                                               01205000
PLHRET1  EQU   IDAPLH+120                                               01206000
PLHEOVPT EQU   IDAPLH+180                                               01207000
PLHIBUFC EQU   IDAPLH+188                                               01208000
PLHIXSPL EQU   IDAPLH+200                                               01209000
PLHSSRBA EQU   PLHIXSPL                                                 01210000
PLHWAX   EQU   IDAPLH+232                                               01211000
PLHKEYPT EQU   IDAPLH+248                                               01212000
PLHTMRPL EQU   IDAPLH+265                                               01213000
PLHEND   EQU   IDAPLH+280                                               01214000
PLHKEY   EQU   0                                                        01215000
IDABUFDR EQU   0                                                        01216000
BUFDRCIX EQU   IDABUFDR+9                                               01217000
BUFDRFLG EQU   IDABUFDR+11                                              01218000
IDABUFC  EQU   0                                                        01219000
BUFCAVL  EQU   IDABUFC                                                  01220000
BUFCFLG1 EQU   IDABUFC+1                                                01221000
BUFCIOFL EQU   IDABUFC+2                                                01222000
BUFCMW   EQU   BUFCIOFL                                                 01223000
BUFCFLG2 EQU   IDABUFC+3                                                01224000
BUFCPLH  EQU   IDABUFC+4                                                01225000
BUFCDDDD EQU   IDABUFC+8                                                01226000
BUFCORBA EQU   IDABUFC+12                                               01227000
BUFCBAD  EQU   IDABUFC+20                                               01228000
BUFCINV  EQU   IDABUFC+28                                               01229000
BUFXORBA EQU   IDABUFC+44                                               01230000
IDACIDF  EQU   0                                                        01231000
CIDFOSET EQU   IDACIDF                                                  01232000
CIDFLL   EQU   IDACIDF+2                                                01233000
IDAAMDSB EQU   0                                                        01234000
AMDATTR  EQU   IDAAMDSB+1                                               01235000
AMDDST   EQU   AMDATTR                                                  01236000
AMDRANGE EQU   AMDATTR                                                  01237000
AMDNEST  EQU   IDAAMDSB+4                                               01238000
AMDRKP   EQU   IDAAMDSB+6                                               01239000
AMDKEYLN EQU   IDAAMDSB+8                                               01240000
AMDCINV  EQU   IDAAMDSB+20                                              01241000
AMDLRECL EQU   IDAAMDSB+24                                              01242000
AMDHLRBA EQU   IDAAMDSB+28                                              01243000
AMDSSRBA EQU   IDAAMDSB+32                                              01244000
AMDPARDB EQU   IDAAMDSB+36                                              01245000
AMDATTR3 EQU   IDAAMDSB+40                                              01246000
AMDSTAT  EQU   IDAAMDSB+48                                              01247000
IDAARDB  EQU   0                                                        01248000
ARDTYPE  EQU   IDAARDB+1                                                01249000
ARDPRF   EQU   IDAARDB+28                                               01250000
IDAAMB   EQU   0                                                        01251000
AMBDSB   EQU   IDAAMB+20                                                01252000
AMBEOVR  EQU   IDAAMB+24                                                01253000
AMBFLG0  EQU   AMBEOVR                                                  01254000
AMBFLG1  EQU   IDAAMB+25                                                01255000
AMBJRN   EQU   AMBFLG1                                                  01256000
AMBDSORG EQU   IDAAMB+26                                                01257000
AMBIOBAD EQU   IDAAMB+28                                                01258000
AMBINFL  EQU   IDAAMB+42                                                01259000
AMBDEBPT EQU   IDAAMB+44                                                01260000
AMBOFLGS EQU   IDAAMB+48                                                01261000
AMBFLG2  EQU   IDAAMB+49                                                01262000
AMBEOVPT EQU   IDAAMB+56                                                01263000
AMBIWA   EQU   IDAAMB+64                                                01264000
AMBCSWD1 EQU   IDAAMB+84                                                01265000
AMBAFLG  EQU   AMBCSWD1                                                 01266000
AMBLSR   EQU   AMBAFLG                                                  01267000
AMBGSR   EQU   AMBAFLG                                                  01268000
IDADIWA  EQU   0                                                        01269000
DIWATV   EQU   IDADIWA+1                                                01270000
DIWFLG1  EQU   IDADIWA+4                                                01271000
DIWFLG2  EQU   IDADIWA+5                                                01272000
DIWPLH   EQU   IDADIWA+16                                               01273000
DIWSAVE  EQU   IDADIWA+28                                               01274000
IDAIXSPL EQU   0                                                        01275000
IXSILN   EQU   IDAIXSPL+13                                              01276000
IXSBFLG  EQU   IDAIXSPL+17                                              01277000
IDARDF   EQU   0                                                        01278000
RDFRBYTE EQU   IDARDF                                                   01279000
RDFCTNU  EQU   RDFRBYTE                                                 01280000
RDFSEG   EQU   RDFRBYTE                                                 01281000
RDFREPL  EQU   RDFRBYTE                                                 01282000
RDFLL    EQU   IDARDF+1                                                 01283000
IDADATA  EQU   0                                                        01284000
AMDATA   EQU   IDADATA                                                  01285000
IDAKEY   EQU   0                                                        01286000
PLHPDL   EQU   0                                                        01287000
PLHPDLE  EQU   0                                                        01288000
PLHRRN   EQU   0                                                        01289000
PLHEXTEN EQU   PLHEND                                                   01290000
PLHBMWRK EQU   PLHEXTEN+5                                               01291000
BUFCRSC1 EQU   BUFCAVL                                                  01292000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01293000
PLHBMSV5 EQU   PLHEXTEN+24                                              01294000
PLHBMSV4 EQU   PLHEXTEN+20                                              01295000
PLHBMSV3 EQU   PLHEXTEN+16                                              01296000
PLHBMSV2 EQU   PLHEXTEN+12                                              01297000
PLHBMSV1 EQU   PLHEXTEN+8                                               01298000
PLHRDCNT EQU   PLHEXTEN+6                                               01299000
PLHBMSOV EQU   PLHBMWRK                                                 01300000
PLHBEUC  EQU   PLHBMWRK                                                 01301000
PLHBMRDF EQU   PLHBMWRK                                                 01302000
@NM00030 EQU   PLHEXTEN+4                                               01303000
PLHRESR1 EQU   PLHEXTEN                                                 01304000
KEY      EQU   IDAKEY                                                   01305000
RDFEMPTY EQU   RDFRBYTE                                                 01306000
RDF1ST   EQU   RDFSEG                                                   01307000
RDFNOT1  EQU   RDFSEG                                                   01308000
RDFTYPE  EQU   RDFRBYTE                                                 01309000
IXSLEP   EQU   IDAIXSPL+28                                              01310000
IXSSEP   EQU   IDAIXSPL+24                                              01311000
IXSHEP   EQU   IDAIXSPL+20                                              01312000
IXSPEC   EQU   IDAIXSPL+19                                              01313000
IXSEKON  EQU   IDAIXSPL+18                                              01314000
@NM00061 EQU   IXSBFLG                                                  01315000
IXSLELV  EQU   IXSBFLG                                                  01316000
IXSSSRH  EQU   IXSBFLG                                                  01317000
IXSNOSR  EQU   IDAIXSPL+16                                              01318000
IXSKLEN  EQU   IDAIXSPL+14                                              01319000
IXSTLN   EQU   IDAIXSPL+12                                              01320000
IXSARG   EQU   IDAIXSPL+8                                               01321000
IXSBUFC  EQU   IDAIXSPL+4                                               01322000
IXSSTRBA EQU   IDAIXSPL                                                 01323000
@NM00060 EQU   IDADIWA+92                                               01324000
@NM00059 EQU   IDADIWA+88                                               01325000
@NM00058 EQU   IDADIWA+84                                               01326000
@NM00057 EQU   IDADIWA+80                                               01327000
@NM00056 EQU   IDADIWA+76                                               01328000
@NM00055 EQU   IDADIWA+72                                               01329000
@NM00054 EQU   IDADIWA+68                                               01330000
@NM00053 EQU   IDADIWA+64                                               01331000
@NM00052 EQU   IDADIWA+60                                               01332000
@NM00051 EQU   IDADIWA+56                                               01333000
DIWINRBA EQU   IDADIWA+52                                               01334000
DIWRKCT  EQU   IDADIWA+48                                               01335000
DIWSAVE5 EQU   DIWSAVE+16                                               01336000
DIWSAVE4 EQU   DIWSAVE+12                                               01337000
DIWSAVE3 EQU   DIWSAVE+8                                                01338000
DIWSAVE2 EQU   DIWSAVE+4                                                01339000
DIWSAVE1 EQU   DIWSAVE                                                  01340000
DIWSPLTP EQU   IDADIWA+24                                               01341000
DIWBUFC  EQU   IDADIWA+20                                               01342000
DIWHRBA  EQU   IDADIWA+12                                               01343000
DIWLRBA  EQU   IDADIWA+8                                                01344000
@NM00050 EQU   IDADIWA+6                                                01345000
DIWFSPF  EQU   DIWFLG2                                                  01346000
DIW1ST   EQU   DIWFLG1                                                  01347000
DIWNOT1  EQU   DIWFLG1                                                  01348000
DIWSHIFT EQU   DIWFLG1                                                  01349000
DIWGSPC  EQU   DIWFLG1                                                  01350000
DIWEOKR  EQU   DIWFLG1                                                  01351000
DIWPFERR EQU   DIWFLG1                                                  01352000
DIWCISPL EQU   DIWFLG1                                                  01353000
DIWCAS   EQU   DIWFLG1                                                  01354000
DIWLEN   EQU   IDADIWA+2                                                01355000
DIWID    EQU   IDADIWA                                                  01356000
AMBTRACE EQU   IDAAMB+120                                               01357000
AMBVIOT  EQU   IDAAMB+116                                               01358000
AMBSZCP  EQU   IDAAMB+114                                               01359000
AMBSZFW  EQU   IDAAMB+112                                               01360000
AMBSZWR  EQU   IDAAMB+110                                               01361000
AMBSZRD  EQU   IDAAMB+108                                               01362000
AMBEXEX  EQU   IDAAMB+100                                               01363000
AMBWSHD  EQU   IDAAMB+96                                                01364000
AMBCPA   EQU   IDAAMB+92                                                01365000
AMBBM2SH EQU   IDAAMB+88                                                01366000
AMBRDCNT EQU   AMBCSWD1+2                                               01367000
@NM00049 EQU   AMBCSWD1+1                                               01368000
@NM00048 EQU   AMBAFLG                                                  01369000
AMBCFX   EQU   AMBAFLG                                                  01370000
AMBSIS   EQU   AMBAFLG                                                  01371000
AMBDFR   EQU   AMBAFLG                                                  01372000
AMBICI   EQU   AMBAFLG                                                  01373000
@NM00047 EQU   AMBAFLG                                                  01374000
AMBUPLH  EQU   IDAAMB+80                                                01375000
AMBPAMBL EQU   IDAAMB+76                                                01376000
AMBPIXP  EQU   IDAAMB+72                                                01377000
@NM00046 EQU   IDAAMB+68                                                01378000
AMBWKA   EQU   IDAAMB+60                                                01379000
AMBAMBXN EQU   AMBEOVPT                                                 01380000
AMBEDB   EQU   IDAAMB+52                                                01381000
AMBRPT   EQU   IDAAMB+50                                                01382000
AMBPUG   EQU   AMBFLG2                                                  01383000
AMBBUSY  EQU   AMBOFLGS                                                 01384000
AMBEXFG  EQU   AMBOFLGS                                                 01385000
@NM00045 EQU   AMBOFLGS                                                 01386000
AMBOPEN  EQU   AMBOFLGS                                                 01387000
@NM00044 EQU   AMBOFLGS                                                 01388000
AMBDEBAD EQU   AMBDEBPT+1                                               01389000
AMBIFLGS EQU   AMBDEBPT                                                 01390000
AMBAMETH EQU   IDAAMB+43                                                01391000
AMBUPX   EQU   AMBINFL                                                  01392000
AMBUCRA  EQU   AMBINFL                                                  01393000
AMBSCRA  EQU   AMBINFL                                                  01394000
AMBCAT   EQU   AMBINFL                                                  01395000
@NM00043 EQU   AMBINFL                                                  01396000
@NM00042 EQU   AMBINFL                                                  01397000
AMBTIOT  EQU   IDAAMB+40                                                01398000
@NM00041 EQU   IDAAMB+38                                                01399000
AMBDDSN  EQU   IDAAMB+35                                                01400000
AMBCDSN  EQU   IDAAMB+32                                                01401000
AMBIOMB  EQU   AMBIOBAD                                                 01402000
@NM00040 EQU   AMBDSORG+1                                               01403000
AMBDORGA EQU   AMBDSORG+1                                               01404000
@NM00039 EQU   AMBDSORG                                                 01405000
AMBINBUF EQU   AMBFLG1                                                  01406000
AMBUBF   EQU   AMBFLG1                                                  01407000
AMBSPEED EQU   AMBFLG1                                                  01408000
AMBPCAT  EQU   AMBFLG1                                                  01409000
AMBMCAT  EQU   AMBFLG1                                                  01410000
AMBTYPE  EQU   AMBFLG1                                                  01411000
AMBCREAT EQU   AMBFLG1                                                  01412000
@NM00038 EQU   AMBFLG0                                                  01413000
AMBPSDS  EQU   AMBFLG0                                                  01414000
AMBCACB  EQU   IDAAMB+16                                                01415000
AMBPH    EQU   IDAAMB+12                                                01416000
AMBBUFC  EQU   IDAAMB+8                                                 01417000
AMBLINK  EQU   IDAAMB+4                                                 01418000
AMBLEN   EQU   IDAAMB+2                                                 01419000
AMBRSC   EQU   IDAAMB+1                                                 01420000
AMBID    EQU   IDAAMB                                                   01421000
ARDKEYS  EQU   IDAARDB+29                                               01422000
@NM00037 EQU   ARDPRF                                                   01423000
ARDPRFMT EQU   ARDPRF                                                   01424000
ARDPRSS  EQU   ARDPRF                                                   01425000
ARDRELNO EQU   IDAARDB+26                                               01426000
ARDVOLSR EQU   IDAARDB+20                                               01427000
ARDERBA  EQU   IDAARDB+16                                               01428000
ARDHRBA  EQU   IDAARDB+12                                               01429000
ARDHKRBA EQU   IDAARDB+8                                                01430000
ARDNPTR  EQU   IDAARDB+4                                                01431000
ARDLEN   EQU   IDAARDB+2                                                01432000
ARDUSED  EQU   ARDTYPE                                                  01433000
ARDEOD   EQU   ARDTYPE                                                  01434000
ARDUOVFL EQU   ARDTYPE                                                  01435000
ARDSS    EQU   ARDTYPE                                                  01436000
ARDHLI   EQU   ARDTYPE                                                  01437000
ARDKR    EQU   ARDTYPE                                                  01438000
ARDID    EQU   IDAARDB                                                  01439000
AMDEXCP  EQU   AMDSTAT+44                                               01440000
AMDNCAS  EQU   AMDSTAT+40                                               01441000
AMDNCIS  EQU   AMDSTAT+36                                               01442000
AMDASPA  EQU   AMDSTAT+32                                               01443000
AMDRETR  EQU   AMDSTAT+28                                               01444000
AMDUPR   EQU   AMDSTAT+24                                               01445000
AMDIREC  EQU   AMDSTAT+20                                               01446000
AMDDELR  EQU   AMDSTAT+16                                               01447000
AMDNLR   EQU   AMDSTAT+12                                               01448000
AMDNEXT  EQU   AMDSTAT+10                                               01449000
AMDNIL   EQU   AMDSTAT+8                                                01450000
AMDSTSP  EQU   AMDSTAT                                                  01451000
@NM00036 EQU   IDAAMDSB+41                                              01452000
@NM00035 EQU   AMDATTR3                                                 01453000
AMDLM    EQU   AMDATTR3                                                 01454000
AMDWAIT  EQU   AMDATTR3                                                 01455000
AMDBIND  EQU   AMDATTR3                                                 01456000
AMDFAULT EQU   AMDATTR3                                                 01457000
AMDUNQ   EQU   AMDATTR3                                                 01458000
AMDMAXRR EQU   AMDSSRBA                                                 01459000
AMDNSLOT EQU   AMDHLRBA                                                 01460000
AMDFSCI  EQU   IDAAMDSB+16                                              01461000
AMDFSCA  EQU   IDAAMDSB+14                                              01462000
AMDCIPCA EQU   IDAAMDSB+12                                              01463000
AMDPCTCI EQU   IDAAMDSB+11                                              01464000
AMDPCTCA EQU   IDAAMDSB+10                                              01465000
AMDAXRKP EQU   AMDNEST                                                  01466000
AMDLEN   EQU   IDAAMDSB+2                                               01467000
AMDSPAN  EQU   AMDATTR                                                  01468000
AMDRRDS  EQU   AMDATTR                                                  01469000
AMDORDER EQU   AMDATTR                                                  01470000
AMDREPL  EQU   AMDATTR                                                  01471000
AMDSDT   EQU   AMDATTR                                                  01472000
AMDWCK   EQU   AMDATTR                                                  01473000
AMDSBID  EQU   IDAAMDSB                                                 01474000
@NM00034 EQU   CIDFLL                                                   01475000
CIDFBUSY EQU   CIDFLL                                                   01476000
BUFCEND  EQU   IDABUFC+64                                               01477000
BUFCUCDN EQU   IDABUFC+60                                               01478000
BUFCUCUP EQU   IDABUFC+56                                               01479000
BUFCMDBT EQU   IDABUFC+52                                               01480000
BUFCHAIN EQU   IDABUFC+48                                               01481000
BUFXIRBA EQU   IDABUFC+40                                               01482000
BUFCNXT2 EQU   IDABUFC+37                                               01483000
BUFCIDXL EQU   IDABUFC+36                                               01484000
BUFCDSPC EQU   IDABUFC+32                                               01485000
BUFCWLEN EQU   BUFCINV                                                  01486000
BUFCNXT1 EQU   IDABUFC+24                                               01487000
BUFCCPA  EQU   IDABUFC+16                                               01488000
BUFCAMB  EQU   BUFCPLH                                                  01489000
@NM00033 EQU   BUFCFLG2                                                 01490000
BUFCEOD  EQU   BUFCFLG2                                                 01491000
BUFCBSYW EQU   BUFCFLG2                                                 01492000
BUFCBSYR EQU   BUFCFLG2                                                 01493000
BUFCNLAS EQU   BUFCFLG2                                                 01494000
BUFCXDDR EQU   BUFCFLG2                                                 01495000
BUFCFIX  EQU   BUFCIOFL                                                 01496000
BUFCPFCP EQU   BUFCIOFL                                                 01497000
BUFCXEDB EQU   BUFCIOFL                                                 01498000
BUFCWC   EQU   BUFCIOFL                                                 01499000
BUFCREAL EQU   BUFCIOFL                                                 01500000
BUFCRRD  EQU   BUFCIOFL                                                 01501000
BUFCFMT  EQU   BUFCIOFL                                                 01502000
BUFCEPT  EQU   BUFCFLG1                                                 01503000
BUFCEXC  EQU   BUFCFLG1                                                 01504000
BUFCVAL  EQU   BUFCFLG1                                                 01505000
BUFCER2  EQU   BUFCFLG1                                                 01506000
BUFCER1  EQU   BUFCFLG1                                                 01507000
BUFCINS  EQU   BUFCFLG1                                                 01508000
BUFCSEG  EQU   BUFCFLG1                                                 01509000
BUFCUPG  EQU   BUFCFLG1                                                 01510000
BUFCUCNT EQU   BUFCAVL                                                  01511000
@NM00032 EQU   IDABUFDR+16                                              01512000
BUFDBUFC EQU   IDABUFDR+12                                              01513000
@NM00031 EQU   BUFDRFLG                                                 01514000
BUFDRAVL EQU   BUFDRFLG                                                 01515000
BUFDRREL EQU   BUFDRFLG                                                 01516000
BUFDRTSB EQU   IDABUFDR+10                                              01517000
BUFDRMAX EQU   BUFDRCIX                                                 01518000
BUFDRPFN EQU   IDABUFDR+8                                               01519000
BUFDRPFB EQU   IDABUFDR+4                                               01520000
BUFDRLEN EQU   IDABUFDR+2                                               01521000
BUFDRNO  EQU   IDABUFDR+1                                               01522000
BUFDRID  EQU   IDABUFDR                                                 01523000
PLHERRET EQU   IDAPLH+276                                               01524000
PLHASCB  EQU   IDAPLH+272                                               01525000
PLHECB   EQU   IDAPLH+268                                               01526000
@NM00029 EQU   IDAPLH+266                                               01527000
@NM00028 EQU   PLHTMRPL                                                 01528000
PLHTMIOB EQU   PLHTMRPL                                                 01529000
PLHTMINX EQU   PLHTMRPL                                                 01530000
PLHTMDTA EQU   PLHTMRPL                                                 01531000
PLHTMDIW EQU   PLHTMRPL                                                 01532000
PLHTMBUF EQU   PLHTMRPL                                                 01533000
PLHTERM  EQU   PLHTMRPL                                                 01534000
PLHDRMSK EQU   IDAPLH+264                                               01535000
PLHR13   EQU   IDAPLH+260                                               01536000
PLHPARM1 EQU   IDAPLH+256                                               01537000
PLHDRRSC EQU   IDAPLH+252                                               01538000
PLHSLRBA EQU   IDAPLH+244                                               01539000
PLHSRCSG EQU   IDAPLH+242                                               01540000
PLHNOSEG EQU   IDAPLH+240                                               01541000
PLHLLOR  EQU   IDAPLH+236                                               01542000
PLHXPLH  EQU   PLHWAX                                                   01543000
@NM00027 EQU   PLHIXSPL+8                                               01544000
PLHIXBFC EQU   PLHIXSPL+4                                               01545000
PLHHIREC EQU   PLHSSRBA                                                 01546000
PLHISPLP EQU   IDAPLH+196                                               01547000
PLHRBUFC EQU   IDAPLH+192                                               01548000
PLHNRBA  EQU   IDAPLH+184                                               01549000
PLHDDDD  EQU   PLHEOVPT                                                 01550000
PLHAR14  EQU   IDAPLH+176                                               01551000
@NM00026 EQU   IDAPLH+172                                               01552000
@NM00025 EQU   IDAPLH+168                                               01553000
PLHASAVE EQU   IDAPLH+164                                               01554000
PLHRETOS EQU   IDAPLH+118                                               01555000
PLHCHAIN EQU   IDAPLH+112                                               01556000
PLHAMB   EQU   IDAPLH+108                                               01557000
PLHSAVE6 EQU   IDAPLH+104                                               01558000
PLHSAVE5 EQU   IDAPLH+100                                               01559000
PLHSAVE4 EQU   IDAPLH+96                                                01560000
PLHSAVE3 EQU   IDAPLH+92                                                01561000
PLHSAVE2 EQU   IDAPLH+88                                                01562000
PLHSAVE1 EQU   IDAPLH+84                                                01563000
PLHARET  EQU   IDAPLH+80                                                01564000
PLHIIOB  EQU   PLHDIOB                                                  01565000
PLHSRSID EQU   IDAPLH+74                                                01566000
PLHNBUFC EQU   IDAPLH+56                                                01567000
@NM00024 EQU   PLHRSCS                                                  01568000
PLHDBPER EQU   PLHRSCS                                                  01569000
PLHDSERR EQU   PLHRSCS                                                  01570000
PLHASYER EQU   PLHRSCS                                                  01571000
@NM00023 EQU   PLHRSCS                                                  01572000
PLHBUFHD EQU   PLHRSCS                                                  01573000
PLHINEOV EQU   PLHRSCS                                                  01574000
PLHEOVR  EQU   IDAPLH+42                                                01575000
PLHRCODE EQU   IDAPLH+41                                                01576000
PLHUCODE EQU   PLHJCODE                                                 01577000
PLHUPECB EQU   PLHJORBA                                                 01578000
PLHDSIDA EQU   IDAPLH+24                                                01579000
PLHCRPL  EQU   IDAPLH+20                                                01580000
PLHMRPL  EQU   IDAPLH+16                                                01581000
PLHBFRNO EQU   IDAPLH+15                                                01582000
PLHFRCNT EQU   IDAPLH+14                                                01583000
PLHRMIN  EQU   IDAPLH+13                                                01584000
PLHDSTYP EQU   IDAPLH+12                                                01585000
PLHACB   EQU   IDAPLH+8                                                 01586000
PLHRAE   EQU   PLHAFLGS                                                 01587000
PLHRABWD EQU   PLHAFLGS                                                 01588000
PLHIOSID EQU   PLHAFLGS                                                 01589000
PLHDBDC  EQU   PLHAFLGS                                                 01590000
PLHVAMB  EQU   PLHAFLGS                                                 01591000
PLHIOSRQ EQU   PLHAFLGS                                                 01592000
PLHDRLM  EQU   PLHAFLGS                                                 01593000
PLHEOVDF EQU   PLHFLG3                                                  01594000
PLHRVRS  EQU   PLHFLG3                                                  01595000
PLHSLVLD EQU   PLHFLG3                                                  01596000
PLHRAHD  EQU   PLHFLG3                                                  01597000
PLHSRBSG EQU   PLHFLG3                                                  01598000
@NM00022 EQU   PLHEFLGS+1                                               01599000
PLHRSTRT EQU   PLHEFLGS+1                                               01600000
PLHDSCAN EQU   PLHEFLGS                                                 01601000
PLHINVAL EQU   PLHEFLGS                                                 01602000
PLHEODX  EQU   PLHEFLGS                                                 01603000
PLHSRINV EQU   PLHEFLGS                                                 01604000
PLHSKPER EQU   PLHEFLGS                                                 01605000
PLH1ST   EQU   PLHEFLGS                                                 01606000
PLHNOSPC EQU   PLHEFLGS                                                 01607000
PLHIWAIT EQU   PLHFLG2                                                  01608000
PLHSVADV EQU   PLHFLG2                                                  01609000
PLHCIINS EQU   PLHFLG2                                                  01610000
PLHKRE   EQU   PLHFLG2                                                  01611000
PLHADDTE EQU   PLHFLG2                                                  01612000
PLHKEYMD EQU   PLHFLG2                                                  01613000
PLHSQINS EQU   PLHFLG2                                                  01614000
PLHUPD   EQU   PLHFLG2                                                  01615000
@NM00021 EQU   PLHFLG1                                                  01616000
PLHDRPND EQU   PLHFLG1                                                  01617000
PLHASYRQ EQU   PLHFLG1                                                  01618000
PLHRDEXC EQU   PLHFLG1                                                  01619000
PLHASKBF EQU   PLHFLG1                                                  01620000
PLHENDRQ EQU   PLHFLG1                                                  01621000
PLHEOVW  EQU   PLHFLG1                                                  01622000
PLHATV   EQU   IDAPLH+1                                                 01623000
PLHAVL   EQU   IDAPLH                                                   01624000
PLHIOSDQ EQU   IDAPLHDR+12                                              01625000
PLHDRCUR EQU   IDAPLHDR+10                                              01626000
PLHDRMAX EQU   IDAPLHDR+8                                               01627000
PLHDRREQ EQU   IDAPLHDR+4                                               01628000
PLHELTH  EQU   IDAPLHDR+2                                               01629000
PLHCNT   EQU   IDAPLHDR+1                                               01630000
PLHID    EQU   IDAPLHDR                                                 01631000
AMBLCMB  EQU   IDAAMBL+64                                               01632000
AMBLBIB  EQU   IDAAMBL+60                                               01633000
AMBLMIDS EQU   IDAAMBL+42                                               01634000
AMBLNIDS EQU   IDAAMBL+41                                               01635000
@NM00020 EQU   IDAAMBL+40                                               01636000
AMBLNUM  EQU   IDAAMBL+38                                               01637000
AMBLNST  EQU   IDAAMBL+37                                               01638000
@NM00019 EQU   AMBLFLG2                                                 01639000
AMBLSTAG EQU   AMBLFLG2                                                 01640000
@NM00018 EQU   AMBLFLG2                                                 01641000
AMBLDUMY EQU   AMBLFLG1                                                 01642000
AMBLCAT  EQU   AMBLFLG1                                                 01643000
AMBLUCRA EQU   AMBLFLG1                                                 01644000
AMBLSCRA EQU   AMBLFLG1                                                 01645000
AMBLVVIC EQU   AMBLFLG1                                                 01646000
AMBLUPD  EQU   AMBLFLG1                                                 01647000
AMBLCINV EQU   AMBLFLG1                                                 01648000
AMBLFULL EQU   AMBLFLG1                                                 01649000
AMBLLEN  EQU   IDAAMBL+34                                               01650000
@NM00017 EQU   AMBLSHAR                                                 01651000
AMBLWRIT EQU   AMBLSHAR                                                 01652000
AMBLCATO EQU   AMBLSHAR                                                 01653000
AMBLPRIM EQU   AMBLSHAR                                                 01654000
AMBLID   EQU   IDAAMBL+32                                               01655000
@NM00016 EQU   IDAAMBL+31                                               01656000
@NM00015 EQU   AMBLTYPE                                                 01657000
AMBLFIX  EQU   AMBLTYPE                                                 01658000
AMBLBASE EQU   AMBLTYPE                                                 01659000
AMBLAIX  EQU   AMBLTYPE                                                 01660000
AMBLUPGR EQU   AMBLTYPE                                                 01661000
AMBLPATH EQU   AMBLTYPE                                                 01662000
AMBLENO  EQU   AMBLVC+1                                                 01663000
AMBLVRT  EQU   AMBLVC                                                   01664000
AMBLXPT  EQU   IDAAMBL+24                                               01665000
AMBLDFR  EQU   AMBLQ                                                    01666000
AMBLESDS EQU   AMBLQ                                                    01667000
AMBLKSDS EQU   AMBLQ                                                    01668000
AMBLUBF  EQU   AMBLQ                                                    01669000
AMBLFSTP EQU   AMBLQ                                                    01670000
AMBLLSR  EQU   AMBLQ                                                    01671000
AMBLGSR  EQU   AMBLQ                                                    01672000
AMBLDDC  EQU   AMBLQ                                                    01673000
AMBLDCI  EQU   AMBLIDF+4                                                01674000
AMBLCACB EQU   AMBLIDF                                                  01675000
@NM00014 EQU   AMBLEOV+2                                                01676000
AMBLCOMP EQU   AMBLEOV+1                                                01677000
AMBLESET EQU   AMBLEFLG                                                 01678000
AMBLWAIT EQU   AMBLEFLG                                                 01679000
AMBLACB  EQU   IDAAMBL+8                                                01680000
AMBLSCHN EQU   IDAAMBL+4                                                01681000
AMBLPCHN EQU   IDAAMBL                                                  01682000
ACBAPID  EQU   ACBCOMN+72                                               01683000
ACBCBMWA EQU   ACBCOMN+68                                               01684000
ACBUAPTR EQU   ACBCOMN+64                                               01685000
ACBLRECL EQU   ACBCOMN+62                                               01686000
ACBMSGLN EQU   ACBBLKSZ                                                 01687000
ACBBUFSP EQU   ACBCOMN+56                                               01688000
@NM00013 EQU   ACBUJFCB+1                                               01689000
ACBOPTN  EQU   ACBUJFCB                                                 01690000
ACBVVIC  EQU   ACBINFLG                                                 01691000
ACBUCRA  EQU   ACBINFLG                                                 01692000
ACBSCRA  EQU   ACBINFLG                                                 01693000
ACBCAT   EQU   ACBINFLG                                                 01694000
ACBIJRQE EQU   ACBINFLG                                                 01695000
ACBJEPS  EQU   ACBINFLG                                                 01696000
@NM00012 EQU   ACBINFLG                                                 01697000
ACBERFLG EQU   ACBCOMN+49                                               01698000
ACBBUSY  EQU   ACBIOSFG                                                 01699000
ACBLOCK  EQU   ACBEXFG                                                  01700000
@NM00011 EQU   ACBOFLGS                                                 01701000
ACBDSERR EQU   ACBOFLGS                                                 01702000
ACBOPEN  EQU   ACBOFLGS                                                 01703000
ACBEOV   EQU   ACBOFLGS                                                 01704000
@NM00010 EQU   ACBOFLGS                                                 01705000
ACBDEB   EQU   ACBDDNM+5                                                01706000
ACBERFL  EQU   ACBDDNM+4                                                01707000
ACBAM    EQU   ACBAMETH                                                 01708000
ACBINFL  EQU   ACBDDNM+2                                                01709000
ACBTIOT  EQU   ACBDDNM                                                  01710000
ACBUEL   EQU   ACBEXLST                                                 01711000
ACBPASSW EQU   ACBCOMN+32                                               01712000
ACBMSGAR EQU   ACBCOMN+28                                               01713000
@NM00009 EQU   ACBDSORG+1                                               01714000
ACBDORGA EQU   ACBDSORG+1                                               01715000
@NM00008 EQU   ACBDSORG                                                 01716000
ACBCRNRE EQU   ACBCROPS                                                 01717000
ACBCRNCK EQU   ACBCROPS                                                 01718000
ACBASA   EQU   ACBCCTYP                                                 01719000
@NM00007 EQU   ACBCCTYP                                                 01720000
ACBRECAF EQU   ACBRECFM                                                 01721000
ACBJBUF  EQU   ACBBUFPL+2                                               01722000
ACBMACR4 EQU   ACBBUFPL+1                                               01723000
@NM00006 EQU   ACBMACR3                                                 01724000
ACBNCFX  EQU   ACBMACR3                                                 01725000
ACBSIS   EQU   ACBMACR3                                                 01726000
ACBDFR   EQU   ACBMACR3                                                 01727000
ACBICI   EQU   ACBMACR3                                                 01728000
ACBGSR   EQU   ACBMACR3                                                 01729000
ACBLSR   EQU   ACBMACR3                                                 01730000
@NM00005 EQU   ACBMACR3                                                 01731000
ACBBUFNI EQU   ACBCOMN+18                                               01732000
ACBBUFND EQU   ACBCOMN+16                                               01733000
ACBSTRNO EQU   ACBCOMN+15                                               01734000
ACBBSTNO EQU   ACBCOMN+14                                               01735000
ACBAIX   EQU   ACBMACR2                                                 01736000
ACBDSN   EQU   ACBMACR2                                                 01737000
ACBRST   EQU   ACBMACR2                                                 01738000
ACBLOGON EQU   ACBMACR2                                                 01739000
ACBSKP   EQU   ACBMACR2                                                 01740000
@NM00004 EQU   ACBMACR2                                                 01741000
ACBUBF   EQU   ACBMACR1                                                 01742000
ACBOUT   EQU   ACBMACR1                                                 01743000
ACBIN    EQU   ACBMACR1                                                 01744000
ACBDIR   EQU   ACBMACR1                                                 01745000
ACBSEQ   EQU   ACBMACR1                                                 01746000
ACBBLK   EQU   ACBCNV                                                   01747000
ACBADD   EQU   ACBADR                                                   01748000
ACBKEY   EQU   ACBMACR1                                                 01749000
ACBINRTN EQU   ACBCOMN+8                                                01750000
ACBIBCT  EQU   ACBJWA                                                   01751000
ACBLEN2  EQU   ACBLENG2                                                 01752000
ACBSTYP  EQU   ACBCOMN+1                                                01753000
ACBID    EQU   ACBCOMN                                                  01754000
RPLERMSA EQU   RPLCOMN+72                                               01755000
RPLEMLEN EQU   RPLCOMN+70                                               01756000
RPLACTIV EQU   RPLCOMN+69                                               01757000
RPLBRANC EQU   RPLEXTD1                                                 01758000
RPLNIB   EQU   RPLEXTD1                                                 01759000
@NM00003 EQU   RPLEXTD1                                                 01760000
RPLEXIT  EQU   RPLEXTD1                                                 01761000
RPLNEXIT EQU   RPLEXTD1                                                 01762000
RPLEXSCH EQU   RPLEXTD1                                                 01763000
RPLDDDD  EQU   RPLRBAR+4                                                01764000
@NM00002 EQU   RPLRBAR+3                                                01765000
@NM00001 EQU   RPLAIXID                                                 01766000
RPLAXPKP EQU   RPLAIXID                                                 01767000
RPLAIXPC EQU   RPLRBAR                                                  01768000
RPLRSV88 EQU   RPLOPT8                                                  01769000
RPLUNCON EQU   RPLOPT8                                                  01770000
RPLACTV  EQU   RPLOPT8                                                  01771000
RPLSESS  EQU   RPLOPT8                                                  01772000
RPLPEND  EQU   RPLOPT8                                                  01773000
RPLODPRM EQU   RPLOPT8                                                  01774000
RPLODACP EQU   RPLOPT8                                                  01775000
RPLODACQ EQU   RPLOPT8                                                  01776000
RPLRSV78 EQU   RPLOPT7                                                  01777000
RPLRSV77 EQU   RPLOPT7                                                  01778000
RPLRLSOP EQU   RPLOPT7                                                  01779000
RPLTPOST EQU   RPLOPT7                                                  01780000
RPLQOPT  EQU   RPLOPT7                                                  01781000
RPLCNIMM EQU   RPLCNOPT                                                 01782000
RPLCNANY EQU   RPLCNOPT                                                 01783000
RPLCNALL EQU   RPLCNOPT                                                 01784000
RPLRSV68 EQU   RPLOPT6                                                  01785000
RPLRSV67 EQU   RPLOPT6                                                  01786000
RPLLOCK  EQU   RPLOPT6                                                  01787000
RPLNCOND EQU   RPLOPT6                                                  01788000
RPLCOND  EQU   RPLOPT6                                                  01789000
RPLEOT   EQU   RPLUNTYP                                                 01790000
RPLEOM   EQU   RPLUNTYP                                                 01791000
RPLEOB   EQU   RPLUNTYP                                                 01792000
RPLWROPT EQU   RPLOPT5                                                  01793000
RPLNODE  EQU   RPLOPT5                                                  01794000
RPLERACE EQU   RPLWRTYP                                                 01795000
RPLEAU   EQU   RPLWRTYP                                                 01796000
RPLNERAS EQU   RPLWRTYP                                                 01797000
RPLPSOPT EQU   RPLOPT5                                                  01798000
RPLSSNIN EQU   RPLOPT5                                                  01799000
RPLDLGIN EQU   RPLOPT5                                                  01800000
RPLBUFL  EQU   RPLCOMN+52                                               01801000
RPLCHAIN EQU   RPLNXTRP                                                 01802000
RPLOPT4  EQU   RPLOPTCD+3                                               01803000
RPLALIGN EQU   RPLOPT3                                                  01804000
RPLFMT   EQU   RPLOPT3                                                  01805000
RPLFLD   EQU   RPLOPT3                                                  01806000
RPLVFY   EQU   RPLOPT3                                                  01807000
RPLBLK   EQU   RPLOPT3                                                  01808000
RPLSFORM EQU   RPLOPT3                                                  01809000
RPLEODS  EQU   RPLOPT3                                                  01810000
RPLNSP   EQU   RPLOPT2                                                  01811000
RPLUPD   EQU   RPLOPT2                                                  01812000
RPLWAITX EQU   RPLOPT2                                                  01813000
RPLLRD   EQU   RPLOPT2                                                  01814000
RPLBWD   EQU   RPLOPT2                                                  01815000
RPLCNV   EQU   RPLOPT2                                                  01816000
RPLADD   EQU   RPLADR                                                   01817000
RPLKEY   EQU   RPLOPT2                                                  01818000
RPLECBIN EQU   RPLECBSW                                                 01819000
RPLGEN   EQU   RPLOPT1                                                  01820000
RPLKGE   EQU   RPLOPT1                                                  01821000
RPLASY   EQU   RPLOPT1                                                  01822000
RPLSKP   EQU   RPLOPT1                                                  01823000
RPLSEQ   EQU   RPLOPT1                                                  01824000
RPLDIR   EQU   RPLOPT1                                                  01825000
RPLLOC   EQU   RPLOPT1                                                  01826000
RPLDAF   EQU   RPLARG+2                                                 01827000
RPLSAF   EQU   RPLARG                                                   01828000
RPLTCBPT EQU   RPLCOMN+28                                               01829000
RPLCCHAR EQU   RPLCOMN+20                                               01830000
RPLSTRID EQU   RPLCOMN+18                                               01831000
RPLKEYL  EQU   RPLKEYLE                                                 01832000
RPLRDSOH EQU   RPLFDB3                                                  01833000
RPLRLG   EQU   RPLFDB3                                                  01834000
RPLLGFRC EQU   RPLFDB3                                                  01835000
RPLREOT  EQU   RPLFDB3                                                  01836000
RPLREOM  EQU   RPLFDB3                                                  01837000
RPLREOB  EQU   RPLFDB3                                                  01838000
RPLSV32  EQU   RPLFDB3                                                  01839000
RPLUINPT EQU   RPLFDB3                                                  01840000
RPLSTSAV EQU   RPLFDB2                                                  01841000
RPLCUERR EQU   RPLFDB2                                                  01842000
RPLDLGFL EQU   RPLFDB2                                                  01843000
RPLIOERR EQU   RPLFDB2                                                  01844000
RPLDVUNS EQU   RPLFDB2                                                  01845000
RPLATND  EQU   RPLFDB2                                                  01846000
RPLRVID  EQU   RPLFDB2                                                  01847000
RPLERLK  EQU   RPLFDB2                                                  01848000
RPLSTAT  EQU   RPLFDBWD                                                 01849000
RPLPOST  EQU   RPLECB                                                   01850000
RPLWAIT  EQU   RPLECB                                                   01851000
RPLPLHPT EQU   RPLCOMN+4                                                01852000
RPLLEN2  EQU   RPLLEN                                                   01853000
RPLSTYP  EQU   RPLIDWD+1                                                01854000
RPLID    EQU   RPLIDWD                                                  01855000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01856000
@RF00176 EQU   ERSE                                                     01857000
@RC00297 EQU   @RC00294                                                 01858000
@RF00308 EQU   @RC00294                                                 01859000
@RC00310 EQU   @RC00294                                                 01860000
@RC00313 EQU   @RC00294                                                 01861000
@RF00389 EQU   @RC00214                                                 01862000
@RF00506 EQU   @EL00002                                                 01863000
@RC00317 EQU   @RC00313                                                 01864000
@ENDDATA EQU   *                                                        01865000
         END   IDA019RL,(C'PLS1841',0701,78188)                         01866000
