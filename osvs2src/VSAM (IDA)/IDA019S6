         TITLE 'IDA019S6 - CONTROL INTERVAL REBUILD                    *00001000
                        '                                               00002000
IDA019S6 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IDA019S6  78.172'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
*                                                                  0170 00013000
         IDASVR14                                                       00014000
*   /*****************************************************************/ 00015000
*   /*                                                               */ 00016000
*   /* SYNCHRONIZE WITH ANY OUTSTANDING CONTROL INTERVAL SPLITS BY   */ 00017000
*   /* OBTAINING CONTROL OF THE DIWA                                 */ 00018000
*   /*                                                               */ 00019000
*   /*****************************************************************/ 00020000
*                                                                  0171 00021000
*LOCKDIWA:                                                         0171 00022000
*   RAMB=AMBLDTA;                   /* POINT TO DATA AMB             */ 00023000
LOCKDIWA L     @10,RPLDACB(,RRPL)                                  0171 00024000
         L     @10,ACBAMBL(,@10)                                   0171 00025000
         L     RAMB,AMBLDTA(,@10)                                  0171 00026000
*   TS(DIWATV);                     /* SEE IF RESOURCE IS AVAILABLE  */ 00027000
         L     @10,AMBIWA(,RAMB)                                   0172 00028000
         TS    DIWATV(@10)                                         0172 00029000
*   BC(8,LOCKED);                   /* BRANCH IF DIWA WAS OBTAINED   */ 00030000
         BC    8,LOCKED                                            0173 00031000
*   RESPECIFY                                                      0174 00032000
*     RWORK0 RESTRICTED;            /* GET PARAMETER REGISTER        */ 00033000
*   RWORK0=DEFR0;                   /* SET DEFER PARAMETER           */ 00034000
*                                                                  0175 00035000
         SLR   RWORK0,RWORK0                                       0175 00036000
*   /*****************************************************************/ 00037000
*   /*                                                               */ 00038000
*   /* DEFER THE REQUEST UNTIL THE DIWA IS AVAILABLE                 */ 00039000
*   /*                                                               */ 00040000
*   /*****************************************************************/ 00041000
*                                                                  0176 00042000
*I01:                                                              0176 00043000
*   DO;                             /* IDACALL(IDADRQ)               */ 00044000
I01      DS    0H                                                  0177 00045000
*     CALL IDADRQ;                  /* EXIT TO IDADRQ                */ 00046000
         L     @15,@CV01046                                        0177 00047000
         BALR  @14,@15                                             0177 00048000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00049000
         BALR @11,0                                                     00050000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00051000
         USING *,@11                                                    00052000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00053000
         L     @11,=A(@PSTART)                                          00054000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00055000
         USING @PSTART,@11                                              00056000
*   END I01;                        /* DEFER REQUEST                 */ 00057000
*   GO TO LOCKDIWA;                 /* RETRY RESOURCE                */ 00058000
         B     LOCKDIWA                                            0183 00059000
*   RESPECIFY                                                      0184 00060000
*     RWORK0 UNRESTRICTED;          /* RELEASE PARAMETER REGISTER    */ 00061000
*LOCKED:                                                           0185 00062000
*                                                                  0185 00063000
*   /*****************************************************************/ 00064000
*   /*                                                               */ 00065000
*   /* IDA019S6 NOW OWNS THE DIWA SO CONTINUE PROCESSING             */ 00066000
*   /*                                                               */ 00067000
*   /*****************************************************************/ 00068000
*                                                                  0185 00069000
*   DIWPLH=ADDR(IDAPLH);            /* NOTE WHO HAS DIWA RESOURCE    */ 00070000
LOCKED   L     @10,AMBIWA(,RAMB)                                   0185 00071000
         ST    RPLH,DIWPLH(,@10)                                   0185 00072000
*   RBUFC=PLHDBUFC;                 /* ADDRESSABILITY TO DATA BUFC   */ 00073000
         L     RBUFC,PLHDBUFC(,RPLH)                               0186 00074000
*   RPLDDDD=BUFCDDDD;               /* PASS RBA OF CI TO USER        */ 00075000
         L     @05,BUFCDDDD(,RBUFC)                                0187 00076000
         ST    @05,RPLDDDD(,RRPL)                                  0187 00077000
*                                                                  0188 00078000
*   /*****************************************************************/ 00079000
*   /*                                                               */ 00080000
*   /* IF SHARED RESOURCES GET THE DATA BUFFER FOR EXCLUSIVE CONTROL */ 00081000
*   /*                                                               */ 00082000
*   /*****************************************************************/ 00083000
*                                                                  0188 00084000
*   IF PLHDBDC=ON&BUFCEXC=OFF THEN  /* SHARED RESOURCES & ^ EXC CNTL */ 00085000
         TM    PLHDBDC(RPLH),B'00010000'                           0188 00086000
         BNO   @RF00188                                            0188 00087000
         TM    BUFCEXC(RBUFC),B'00000010'                          0188 00088000
         BNZ   @RF00188                                            0188 00089000
*     DO;                           /* YES, TRY TO GET EXCLUSIVE CTL */ 00090000
*       DIWSAVE2=IDABUFC(1:4);      /* SET UP COMPARE WORD           */ 00091000
         ICM   @05,15,IDABUFC(RBUFC)                               0190 00092000
         ST    @05,DIWSAVE2(,@10)                                  0190 00093000
*       ADDR(DIWSAVE2)->BUFCUCNT=ONE;/* SET USE COUNT TO ONE         */ 00094000
         MVI   BUFCUCNT+32(@10),X'01'                              0191 00095000
*       DIWSAVE3=DIWSAVE2;          /* SET UP SWAP WORD              */ 00096000
         ST    @05,DIWSAVE3(,@10)                                  0192 00097000
*       ADDR(DIWSAVE3)->BUFCUCNT=ONE;/* SET USE COUNT TO ONE         */ 00098000
         AL    @10,@CF00766                                        0193 00099000
         MVI   BUFCUCNT(@10),X'01'                                 0193 00100000
*       ADDR(DIWSAVE3)->BUFCEXC=ON; /* SET EXCLUSIVE CONTROL FLAG    */ 00101000
*                                                                  0194 00102000
         OI    BUFCEXC(@10),B'00000010'                            0194 00103000
*       /*************************************************************/ 00104000
*       /*                                                           */ 00105000
*       /* GET THE DATA BUFFER IN EXCLUSIVE CONTROL                  */ 00106000
*       /*                                                           */ 00107000
*       /*************************************************************/ 00108000
*                                                                  0195 00109000
*       CS(DIWSAVE2,DIWSAVE3,IDABUFC(1:4));/* SWAP IN EXCLUSIVE CNTL */ 00110000
         L     @10,AMBIWA(,RAMB)                                   0195 00111000
         L     @05,DIWSAVE2(,@10)                                  0195 00112000
         L     @10,AMBIWA(,RAMB)                                   0195 00113000
         L     @10,DIWSAVE3(,@10)                                  0195 00114000
         CS    @05,@10,IDABUFC(RBUFC)                              0195 00115000
         BZ    @BC00195                                            0195 00116000
         BALR  @10,0                                               0195 00117000
         L     @15,AMBIWA(,RAMB)                                   0195 00118000
         SPM   @10                                                 0195 00119000
         ST    @05,DIWSAVE2(,@15)                                  0195 00120000
@BC00195 DS    0H                                                  0196 00121000
*       IF BUFCEXC=OFF THEN         /* BUFFER IN EXCLUSIVE CONTROL?  */ 00122000
         TM    BUFCEXC(RBUFC),B'00000010'                          0196 00123000
         BNZ   @RF00196                                            0196 00124000
*         DO;                       /* NO, CONTROL INTERVAL IN ERROR */ 00125000
*           PLHSKPER=ON;            /* CI IN ERROR - SKIP            */ 00126000
         OI    PLHSKPER(RPLH),B'00100000'                          0198 00127000
*           RPLERREG='08'X;         /* SET LOGICAL ERROR             */ 00128000
         MVI   RPLERREG(RRPL),X'08'                                0199 00129000
*           RPLERRCD=RPLINCNV;      /* SET INVALID CONTROL INTERVAL  */ 00130000
         MVI   RPLERRCD(RRPL),X'9C'                                0200 00131000
*         END;                      /* END - CONTROL INTERVAL IN ERR */ 00132000
*     END;                          /* END - GET EXCLUSIVE CONTROL   */ 00133000
@RF00196 DS    0H                                                  0203 00134000
*                                                                  0203 00135000
*   /*****************************************************************/ 00136000
*   /*                                                               */ 00137000
*   /* CI SPLIT QUIESCED SINCE DIWA HAS BEEN OBTAINED                */ 00138000
*   /*                                                               */ 00139000
*   /*****************************************************************/ 00140000
*                                                                  0203 00141000
*   IF RPLERREG=ZERO&CIDFBUSY=ON THEN/* NO ERRORS & SPLIT INCOMPLETE */ 00142000
@RF00188 CLI   RPLERREG(RRPL),0                                    0203 00143000
         BNE   @RF00203                                            0203 00144000
         L     @10,AMBDSB(,RAMB)                                   0203 00145000
         L     @05,BUFCBAD(,RBUFC)                                 0203 00146000
         AL    @05,AMDCINV(,@10)                                   0203 00147000
         BCTR  @05,0                                               0203 00148000
         BCTR  @05,0                                               0203 00149000
         TM    CIDFBUSY-2(@05),B'10000000'                         0203 00150000
         BNO   @RF00203                                            0203 00151000
*     IF RPLKEY=ON THEN             /* IS REQUEST FOR KEYED ACCESS   */ 00152000
         TM    RPLKEY(RRPL),B'10000000'                            0204 00153000
         BNO   @RF00204                                            0204 00154000
*       DO;                         /* YES, FIX DATA BUFFER          */ 00155000
*                                                                  0205 00156000
*         /***********************************************************/ 00157000
*         /*                                                         */ 00158000
*         /* CHECK THE DATA CI FOR A VALID FORMAT                    */ 00159000
*         /*                                                         */ 00160000
*         /***********************************************************/ 00161000
*                                                                  0206 00162000
*         CALL VALIDCI;             /* CALL VALIDATE CI              */ 00163000
*                                                                  0206 00164000
         BAL   @14,VALIDCI                                         0206 00165000
*         /***********************************************************/ 00166000
*         /*                                                         */ 00167000
*         /* CORRECT THE DATA CONTROL INTERVAL                       */ 00168000
*         /*                                                         */ 00169000
*         /***********************************************************/ 00170000
*                                                                  0207 00171000
*         CALL FIXCI;               /* CORRECT THE DATA CI BUFFER    */ 00172000
         BAL   @14,FIXCI                                           0207 00173000
*         IF RPLERREG=ZERO&         /* IF NO ERRORS AND              */ 00174000
*             PLHRDEXC=ON&          /* BUFFER IN EXCLUSIVE CONTROL   */ 00175000
*             AMBLWRIT=ON THEN      /* AND OUTPUT IS ALLOWED         */ 00176000
         CLI   RPLERREG(RRPL),0                                    0208 00177000
         BNE   @RF00208                                            0208 00178000
         TM    PLHRDEXC(RPLH),B'00001000'                          0208 00179000
         BNO   @RF00208                                            0208 00180000
         L     @10,RPLDACB(,RRPL)                                  0208 00181000
         L     @10,ACBAMBL(,@10)                                   0208 00182000
         TM    AMBLWRIT(@10),B'00100000'                           0208 00183000
         BNO   @RF00208                                            0208 00184000
*           DO;                     /* WRITE THE DATA CI             */ 00185000
*             BUFCMW=ON;            /* BUFFER TO BE WRITTEN          */ 00186000
         OI    BUFCMW(RBUFC),B'10000000'                           0210 00187000
*             BUFCORBA=BUFCDDDD;    /* SET THE OUTPUT RBA            */ 00188000
*                                                                  0211 00189000
         L     @10,BUFCDDDD(,RBUFC)                                0211 00190000
         ST    @10,BUFCORBA(,RBUFC)                                0211 00191000
*             /*******************************************************/ 00192000
*             /*                                                     */ 00193000
*             /* WRITE THE BUFFER                                    */ 00194000
*             /*                                                     */ 00195000
*             /*******************************************************/ 00196000
*                                                                  0212 00197000
*I02:                                                              0212 00198000
*             DO;                   /* IDACALL(IDAWRBFR)             */ 00199000
I02      DS    0H                                                  0213 00200000
*               CALL IDAWRBFR;      /* EXIT TO IDAWRBFR              */ 00201000
         L     @15,@CV01047                                        0213 00202000
         BALR  @14,@15                                             0213 00203000
*               GEN(BALR @11,0);    /* LOAD ADDR OF REENTRY          */ 00204000
         BALR @11,0                                                     00205000
*               GEN(USING *,@11);   /* ESTABLISH ADDRESSING          */ 00206000
         USING *,@11                                                    00207000
*               GEN(L     @11,=A(@PSTART));/* RELOAD BASE            */ 00208000
         L     @11,=A(@PSTART)                                          00209000
*               GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING       */ 00210000
         USING @PSTART,@11                                              00211000
*             END I02;              /* WRITE THE BUFFER              */ 00212000
*           END;                    /* END - WRITE THE DATA CI       */ 00213000
*       END;                        /* END - CORRECT THE DATA CI     */ 00214000
*                                                                  0221 00215000
*/********************************************************************/ 00216000
*/*                                                                  */ 00217000
*/*   PROCESSING FOR ADDRESSED ACCESS                                */ 00218000
*/*                                                                  */ 00219000
*/********************************************************************/ 00220000
*                                                                  0221 00221000
*     ELSE                          /* ADDRESSED PROCESSING          */ 00222000
*       IF RPLUPD=ON|RPLREQ=RPLPUT THEN/* IS REQUEST FOR UPD OR PUT  */ 00223000
         B     @RC00204                                            0221 00224000
@RF00204 TM    RPLUPD(RRPL),B'00000010'                            0221 00225000
         BO    @RT00221                                            0221 00226000
         CLI   RPLREQ(RRPL),1                                      0221 00227000
         BNE   @RF00221                                            0221 00228000
@RT00221 DS    0H                                                  0222 00229000
*         DO;                       /* YES, ERROR SITUATION          */ 00230000
*           RPLERREG='08'X;         /* SET LOGICAL ERROR             */ 00231000
         MVI   RPLERREG(RRPL),X'08'                                0223 00232000
*           RPLERRCD=RPLINCNV;      /* SET INVALID CONTROL INTERVAL  */ 00233000
         MVI   RPLERRCD(RRPL),X'9C'                                0224 00234000
*           PLHSKPER=ON;            /* CI IN ERROR - SKIP            */ 00235000
         OI    PLHSKPER(RPLH),B'00100000'                          0225 00236000
*         END;                      /* END - PUT OR UPDATE           */ 00237000
*       ELSE                        /* NOT OUTPUT SITUATION SO       */ 00238000
*         DO;                       /* ALLOW CI TO BE READ           */ 00239000
         B     @RC00221                                            0227 00240000
@RF00221 DS    0H                                                  0228 00241000
*           BUFCVAL=OFF;            /* INVALIDATE BUFC               */ 00242000
         NI    BUFCVAL(RBUFC),B'11111011'                          0228 00243000
*           RPLERRCD=RPLCIWNG;      /* WARNING, INTERRUPTED CI SPLIT */ 00244000
         MVI   RPLERRCD(RRPL),X'1C'                                0229 00245000
*           CALL VALIDCI;           /* VALIDATE THE CIDF AND RDFS    */ 00246000
         BAL   @14,VALIDCI                                         0230 00247000
*           CIDFBUSY=OFF;           /* SET BUSY INDICATOR OFF        */ 00248000
         L     @10,AMBDSB(,RAMB)                                   0231 00249000
         L     @05,BUFCBAD(,RBUFC)                                 0231 00250000
         AL    @05,AMDCINV(,@10)                                   0231 00251000
         BCTR  @05,0                                               0231 00252000
         BCTR  @05,0                                               0231 00253000
         NI    CIDFBUSY-2(@05),B'01111111'                         0231 00254000
*         END;                      /* END - ALLOW CI TO BE READ     */ 00255000
*                                                                  0232 00256000
*   /*****************************************************************/ 00257000
*   /*                                                               */ 00258000
*   /* REESTABLISH THE EXCLUSIVE CONTROL STATUS OF THE DATA BUFFER   */ 00259000
*   /* AND RETURN TO THE CALLER FOR BOTH KEYED AND ADDRESSED ACCESS. */ 00260000
*   /*                                                               */ 00261000
*   /*****************************************************************/ 00262000
*                                                                  0233 00263000
*   IF PLHRDEXC=OFF THEN            /* IF READ EXCLUSIVE OFF         */ 00264000
@RC00221 DS    0H                                                  0233 00265000
@RC00204 DS    0H                                                  0233 00266000
@RF00203 TM    PLHRDEXC(RPLH),B'00001000'                          0233 00267000
         BNZ   @RF00233                                            0233 00268000
*     BUFCEXC=OFF;                  /* RELEASE EXCLUSIVE CONTROL     */ 00269000
         NI    BUFCEXC(RBUFC),B'11111101'                          0234 00270000
*   DIWATV=ZERO;                    /* RELEASE THE DIWA              */ 00271000
@RF00233 L     @10,AMBIWA(,RAMB)                                   0235 00272000
         MVI   DIWATV(@10),X'00'                                   0235 00273000
*   CALL EXIT;                      /* RETURN                        */ 00274000
         BAL   @14,EXIT                                            0236 00275000
*VALIDCI:                                                          0237 00276000
*                                                                  0237 00277000
*/********************************************************************/ 00278000
*/*                                                                  */ 00279000
*/*   FUNCTION - VALIDATE THE DATA CONTROL INTERVAL.                 */ 00280000
*/*                                                                  */ 00281000
*/*   INPUT    - PLHDBUFC POINTS TO THE INTERRUPTED CI.              */ 00282000
*/*              THE DATA BUFFER IS IN EXCLUSIVE CONTROL.            */ 00283000
*/*                                                                  */ 00284000
*/*   OUTPUT   - THE RETURN CODE IS IN RPLERREG AND RPLERRCD.        */ 00285000
*/*              PLHFSP POINTS TO THE DATA CI FREE SPACE.            */ 00286000
*/*                                                                  */ 00287000
*/********************************************************************/ 00288000
*                                                                  0237 00289000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0237 00290000
         B     @PB00002                                            0237 00291000
VALIDCI  DS    0H                                                  0238 00292000
*   GEN(IDASVR14);                  /* SAVE REGISTER 14 IN PLH       */ 00293000
*                                                                  0238 00294000
         IDASVR14                                                       00295000
*   /*****************************************************************/ 00296000
*   /*                                                               */ 00297000
*   /* VALIDATE THE CIDF                                             */ 00298000
*   /*                                                               */ 00299000
*   /*****************************************************************/ 00300000
*                                                                  0239 00301000
*   RBUFC=PLHDBUFC;                 /* ADDRESSABILITY TO DATA BUFC   */ 00302000
         L     RBUFC,PLHDBUFC(,RPLH)                               0239 00303000
*   CIDFBUSY=OFF;                   /* TURN OFF THE BUSY BIT         */ 00304000
         LA    @10,4                                               0240 00305000
         L     @05,AMBDSB(,RAMB)                                   0240 00306000
         L     @05,AMDCINV(,@05)                                   0240 00307000
         L     @15,BUFCBAD(,RBUFC)                                 0240 00308000
         ALR   @15,@05                                             0240 00309000
         SLR   @15,@10                                             0240 00310000
         NI    CIDFBUSY(@15),B'01111111'                           0240 00311000
*   IF FSO<ZERO|                    /* IF FREE SPACE OFFSET NEGATIVE */ 00312000
*       (FSO+FSL)>(AMDCINV-LENGTH(IDACIDF))/* OR FREE SPACE INVALID  */ 00313000
*     THEN                                                         0241 00314000
         LH    @14,FSO(,@15)                                       0241 00315000
         LTR   @14,@14                                             0241 00316000
         BM    @RT00241                                            0241 00317000
         AH    @14,FSL(,@15)                                       0241 00318000
         SLR   @05,@10                                             0241 00319000
         CR    @14,@05                                             0241 00320000
         BNH   @RF00241                                            0241 00321000
@RT00241 DS    0H                                                  0242 00322000
*     CALL ERREXIT;                 /* CIDF IN ERROR, RETURN         */ 00323000
*                                                                  0242 00324000
         BAL   @14,ERREXIT                                         0242 00325000
*   /*****************************************************************/ 00326000
*   /*                                                               */ 00327000
*   /* VALIDATE THE DATA BY MAKING SURE THAT THE RDF'S ARE CONSISTENT*/ 00328000
*   /* WITH THE FREE SPACE OFFSET AND LENGTH IN THE CIDF             */ 00329000
*   /*                                                               */ 00330000
*   /*****************************************************************/ 00331000
*                                                                  0243 00332000
*   S6NOKEY=ON;                     /* NO PREVIOUS KEY               */ 00333000
@RF00241 L     @10,AMBIWA(,RAMB)                                   0243 00334000
         OI    S6NOKEY(@10),B'10000000'                            0243 00335000
*   PLHRECP=BUFCBAD;                /* BEGINNING OF CI               */ 00336000
         L     @10,BUFCBAD(,RBUFC)                                 0244 00337000
         ST    @10,PLHRECP(,RPLH)                                  0244 00338000
*   PLHFSP=BUFCBAD+CIDFOSET;        /* SET FREE SPACE POINTER        */ 00339000
         L     @05,AMBDSB(,RAMB)                                   0245 00340000
         LR    @15,@10                                             0245 00341000
         AL    @15,AMDCINV(,@05)                                   0245 00342000
         SL    @15,@CF00089                                        0245 00343000
         AH    @10,CIDFOSET(,@15)                                  0245 00344000
         ST    @10,PLHFSP(,RPLH)                                   0245 00345000
*   PLHRDFP=ADDR(IDACIDF);          /* POSITION TO THE CIDF          */ 00346000
         ST    @15,PLHRDFP(,RPLH)                                  0246 00347000
*   PLHRDFC=ONE;                    /* INITIALIZE RDF REPL COUNT     */ 00348000
         MVC   PLHRDFC(2,RPLH),@CH00051                            0247 00349000
*   PLHLRECL=ZERO;                  /* NO PREVIOUS RECORD IN THIS CI */ 00350000
         SLR   @10,@10                                             0248 00351000
         ST    @10,PLHLRECL(,RPLH)                                 0248 00352000
*   DO WHILE PLHRECP<PLHFSP;        /* DO WHILE NOT IN FREE SPACE    */ 00353000
         B     @DE00249                                            0249 00354000
@DL00249 DS    0H                                                  0250 00355000
*     CALL ADVRDF;                  /* ADVANCE THE PLH TO NEXT RDF   */ 00356000
         BAL   @14,ADVRDF                                          0250 00357000
*     IF RDFNOT1=ON|RDF1ST=ON THEN  /* IS THE RDF FOR SPANNED RECORD */ 00358000
         L     @10,PLHRDFP(,RPLH)                                  0251 00359000
         TM    RDFNOT1(@10),B'00110000'                            0251 00360000
         BZ    @RF00251                                            0251 00361000
*       CALL ERREXIT;               /* YES, INVALID CI - RETURN      */ 00362000
         BAL   @14,ERREXIT                                         0252 00363000
*     IF S6NOKEY=ON THEN            /* IF NO PREVIOUS KEY (RECORD)   */ 00364000
@RF00251 L     @10,AMBIWA(,RAMB)                                   0253 00365000
         TM    S6NOKEY(@10),B'10000000'                            0253 00366000
         BNO   @RF00253                                            0253 00367000
*       S6NOKEY=OFF;                /* INDICATE A PREVIOUS KEY       */ 00368000
         NI    S6NOKEY(@10),B'01111111'                            0254 00369000
*     ELSE                          /* IF THERE IS A PREVIOUS KEY    */ 00370000
*       IF KEY(1:AMDKEYLN)^>RPARM1->KEY(1:AMDKEYLN)/* IS CURRENT KEY */ 00371000
*         THEN                      /* GREATER THAN THE PREVIOUS KEY */ 00372000
         B     @RC00253                                            0255 00373000
@RF00253 L     @10,AMBDSB(,RAMB)                                   0255 00374000
         LH    @05,AMDRKP(,@10)                                    0255 00375000
         AL    @05,PLHRECP(,RPLH)                                  0255 00376000
         LH    @10,AMDKEYLN(,@10)                                  0255 00377000
         BCTR  @10,0                                               0255 00378000
         EX    @10,@SC01093                                        0255 00379000
         BH    @RF00255                                            0255 00380000
*         CALL ERREXIT;             /* NO, THEN INVALID CI - RETURN  */ 00381000
         BAL   @14,ERREXIT                                         0256 00382000
*     RPARM1=ADDR(KEY);             /* SAVE ADDRESS OF CURRENT KEY   */ 00383000
@RF00255 DS    0H                                                  0257 00384000
@RC00253 L     @10,AMBDSB(,RAMB)                                   0257 00385000
         LH    @05,AMDRKP(,@10)                                    0257 00386000
         L     RPARM1,PLHRECP(,RPLH)                               0257 00387000
         ALR   RPARM1,@05                                          0257 00388000
*     IF PLHLRECL<AMDRKP+AMDKEYLN THEN/* IS NEXT RECORD POINTER OK   */ 00389000
         AH    @05,AMDKEYLN(,@10)                                  0258 00390000
         C     @05,PLHLRECL(,RPLH)                                 0258 00391000
         BNH   @RF00258                                            0258 00392000
*       CALL ERREXIT;               /* NO, EXIT - INVALID CI         */ 00393000
         BAL   @14,ERREXIT                                         0259 00394000
*     PLHRECP=PLHRECP+PLHLRECL;     /* ADVANCE CURRENT RECORD POINTER*/ 00395000
@RF00258 L     @10,PLHRECP(,RPLH)                                  0260 00396000
         AL    @10,PLHLRECL(,RPLH)                                 0260 00397000
         ST    @10,PLHRECP(,RPLH)                                  0260 00398000
*   END;                            /* END - NOT IN FREE SPACE       */ 00399000
*                                                                  0261 00400000
@DE00249 L     @10,PLHRECP(,RPLH)                                  0261 00401000
         L     @05,PLHFSP(,RPLH)                                   0261 00402000
         CR    @10,@05                                             0261 00403000
         BL    @DL00249                                            0261 00404000
*   /*****************************************************************/ 00405000
*   /*                                                               */ 00406000
*   /* MAKE SURE THAT THE ENDING VALUES ARE CORRECT                  */ 00407000
*   /*                                                               */ 00408000
*   /*****************************************************************/ 00409000
*                                                                  0262 00410000
*   IF PLHRECP^=PLHFSP|             /* IF FREE SPACE DOES NOT START     00411000
*                                      AT THE END OF LAST RECORD OR  */ 00412000
*       PLHRDFP^=PLHFSP+CIDFLL|     /* IF FREE SPACE DOES NOT END AT    00413000
*                                      THE START OF LAST RDF OR      */ 00414000
*       PLHRDFC^=ONE THEN           /* IF A GROUP RDF HAS NOT BEEN 0262 00415000
*                                      DECREMENTED TO ONE            */ 00416000
         CR    @10,@05                                             0262 00417000
         BNE   @RT00262                                            0262 00418000
         L     @10,AMBDSB(,RAMB)                                   0262 00419000
         L     @15,BUFCBAD(,RBUFC)                                 0262 00420000
         AL    @15,AMDCINV(,@10)                                   0262 00421000
         BCTR  @15,0                                               0262 00422000
         BCTR  @15,0                                               0262 00423000
         AH    @05,CIDFLL-2(,@15)                                  0262 00424000
         C     @05,PLHRDFP(,RPLH)                                  0262 00425000
         BNE   @RT00262                                            0262 00426000
         CLC   PLHRDFC(2,RPLH),@CH00051                            0262 00427000
         BE    @RF00262                                            0262 00428000
@RT00262 DS    0H                                                  0263 00429000
*     CALL ERREXIT;                 /* ANY OF THE ABOVE, ERROR EXIT  */ 00430000
*                                                                  0263 00431000
         BAL   @14,ERREXIT                                         0263 00432000
*   /*****************************************************************/ 00433000
*   /*                                                               */ 00434000
*   /* IN CASE ANY ERRORS OCCUR PRIOR TO FIXCI, SET THE BUSY FLAG ON */ 00435000
*   /*                                                               */ 00436000
*   /*****************************************************************/ 00437000
*                                                                  0264 00438000
*   ELSE                            /* NO ERROR,                     */ 00439000
*     CIDFBUSY=ON;                  /* SET CIDFBUSY ON               */ 00440000
         B     @RC00262                                            0264 00441000
@RF00262 L     @10,AMBDSB(,RAMB)                                   0264 00442000
         L     @05,BUFCBAD(,RBUFC)                                 0264 00443000
         AL    @05,AMDCINV(,@10)                                   0264 00444000
         BCTR  @05,0                                               0264 00445000
         BCTR  @05,0                                               0264 00446000
         OI    CIDFBUSY-2(@05),B'10000000'                         0264 00447000
*   CALL EXIT;                      /* EXIT FROM VALIDATE DATA CI    */ 00448000
@RC00262 BAL   @14,EXIT                                            0265 00449000
*   END VALIDCI;                    /* END - VALIDATE DATA CI        */ 00450000
@EL00002 DS    0H                                                  0266 00451000
@EF00002 DS    0H                                                  0266 00452000
@ER00002 BR    @14                                                 0266 00453000
*FIXCI:                                                            0267 00454000
*                                                                  0267 00455000
*/********************************************************************/ 00456000
*/*                                                                  */ 00457000
*/*   FUNCTION - REMOVE ANY DUPLICATE RECORDS FROM THE DATA          */ 00458000
*/*              CONTROL INTERVAL.                                   */ 00459000
*/*                                                                  */ 00460000
*/*   INPUT    - PLHDBUFC POINTS TO THE INTERRUPTED BUFC.            */ 00461000
*/*              PLHFSP POINTS TO THE DATA CI FREE SPACE.            */ 00462000
*/*              DIWA IS LOCKED.                                     */ 00463000
*/*              THE DATA BUFFER IS IN EXCLUSIVE CONTROL FOR SHARED  */ 00464000
*/*                RESOURCES.                                        */ 00465000
*/*                                                                  */ 00466000
*/*   OUTPUT   - RBUFC POINTS TO THE CURRENT BUFC.                   */ 00467000
*/*              THE RETURN CODE IS IN RPLERREG AND RPLERRCD.        */ 00468000
*/*                                                                  */ 00469000
*/********************************************************************/ 00470000
*                                                                  0267 00471000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0267 00472000
FIXCI    DS    0H                                                  0268 00473000
*   GEN(IDASVR14);                  /* SAVE REGISTER 14 IN PLH       */ 00474000
         IDASVR14                                                       00475000
*   RBUFC=PLHDBUFC;                 /* POINT TO THE DATA BUFC        */ 00476000
         L     RBUFC,PLHDBUFC(,RPLH)                               0269 00477000
*   PLHRECP=BUFCBAD;                /* BEGINNING OF CI               */ 00478000
         L     @10,BUFCBAD(,RBUFC)                                 0270 00479000
         ST    @10,PLHRECP(,RPLH)                                  0270 00480000
*   PLHRDFP=ADDR(IDACIDF);          /* POSITION TO THE CIDF          */ 00481000
         L     @05,AMBDSB(,RAMB)                                   0271 00482000
         AL    @10,AMDCINV(,@05)                                   0271 00483000
         SL    @10,@CF00089                                        0271 00484000
         ST    @10,PLHRDFP(,RPLH)                                  0271 00485000
*   CIDFBUSY=OFF;                   /* SET BUSY OFF WHILE PROCESSING */ 00486000
         NI    CIDFBUSY(@10),B'01111111'                           0272 00487000
*   PLHRDFC=ONE;                    /* INITIALIZE RDF REPL COUNT     */ 00488000
         MVC   PLHRDFC(2,RPLH),@CH00051                            0273 00489000
*   CALL ADVRDF;                    /* ADVANCE TO THE FIRST RDF      */ 00490000
*                                                                  0274 00491000
         BAL   @14,ADVRDF                                          0274 00492000
*   /*****************************************************************/ 00493000
*   /*                                                               */ 00494000
*   /* INITIALIZE INPUT REGISTERS TO THE SCIB ROUTINE                */ 00495000
*   /*                                                               */ 00496000
*   /*****************************************************************/ 00497000
*                                                                  0275 00498000
*   RESPECIFY                                                      0275 00499000
*     RWORK3 RESTRICTED;            /* RESTRICT REG FOR SCIB         */ 00500000
*   RBUFC=PLHIBUFC->BUFCBAD;        /* POINT TO INDEX BUFFER         */ 00501000
         L     @10,PLHIBUFC(,RPLH)                                 0276 00502000
         L     RBUFC,BUFCBAD(,@10)                                 0276 00503000
*   RWORK3=ADDR(IMWISWKA);          /* INDEX SEARCH PARAMETER LIST   */ 00504000
*                                                                  0277 00505000
         L     @10,RPLDACB(,RRPL)                                  0277 00506000
         L     @10,ACBAMBL(,@10)                                   0277 00507000
         L     @10,AMBLIX(,@10)                                    0277 00508000
         L     @10,AMBIWA(,@10)                                    0277 00509000
         L     RWORK3,ICWCHN(,@10)                                 0277 00510000
         LA    RWORK3,IMWISWKA(,RWORK3)                            0277 00511000
*   /*****************************************************************/ 00512000
*   /*                                                               */ 00513000
*   /* VERIFY THAT THE KEY OF EACH RECORD IN THE CONTROL INTERVAL    */ 00514000
*   /* BELONGS IN THE CI BY CALLING IDA019RC (SCIB).                 */ 00515000
*   /*                                                               */ 00516000
*   /*****************************************************************/ 00517000
*                                                                  0278 00518000
*   DO WHILE PLHRECP<PLHFSP;        /* DO WHILE NOT IN FREE SPACE    */ 00519000
         B     @DE00278                                            0278 00520000
@DL00278 DS    0H                                                  0279 00521000
*     RPARM1=PLHRECP+AMDRKP;        /* POINT TO THE CURRENT KEY      */ 00522000
         L     @10,AMBDSB(,RAMB)                                   0279 00523000
         LH    RPARM1,AMDRKP(,@10)                                 0279 00524000
         AL    RPARM1,PLHRECP(,RPLH)                               0279 00525000
*                                                                  0280 00526000
*     /***************************************************************/ 00527000
*     /*                                                             */ 00528000
*     /* CALL SCIB, SEARCH COMPRESSED INDEX BLOCK                    */ 00529000
*     /*                                                             */ 00530000
*     /***************************************************************/ 00531000
*                                                                  0280 00532000
*I03:                                                              0280 00533000
*     DO;                           /* IDACALL(IDA019RC)             */ 00534000
I03      DS    0H                                                  0281 00535000
*       CALL IDA019RC;              /* EXIT TO IDA019RC              */ 00536000
         L     @15,@CV01048                                        0281 00537000
         BALR  @14,@15                                             0281 00538000
*       GEN(BALR @11,0);            /* LOAD ADDR OF REENTRY          */ 00539000
         BALR @11,0                                                     00540000
*       GEN(USING *,@11);           /* ESTABLISH ADDRESSING          */ 00541000
         USING *,@11                                                    00542000
*       GEN(L     @11,=A(@PSTART)); /* RELOAD BASE                   */ 00543000
         L     @11,=A(@PSTART)                                          00544000
*       GEN(USING @PSTART,@11);     /* ESTABLISH ADDRESSING          */ 00545000
         USING @PSTART,@11                                              00546000
*     END I03;                      /* CALL SCIB                     */ 00547000
*     RESPECIFY                                                    0287 00548000
*      (RWORK2,                                                    0287 00549000
*       RWORK4,                                                    0287 00550000
*       RWORK5,                                                    0287 00551000
*       R15) RESTRICTED;                                           0287 00552000
*     IF R15^=ZERO&                 /* RECORD NOT IN THIS CI         */ 00553000
*         R15^=FOUR THEN            /* RECORD NOT IN ANY CA          */ 00554000
         LTR   R15,R15                                             0288 00555000
         BZ    @RF00288                                            0288 00556000
         CH    R15,FOUR                                            0288 00557000
         BE    @RF00288                                            0288 00558000
*       CALL ERREXIT;               /* CALL ERROR                    */ 00559000
         BAL   @14,ERREXIT                                         0289 00560000
*     IF R15=ZERO THEN              /* WAS THE KEY LOCATED?          */ 00561000
@RF00288 LTR   R15,R15                                             0290 00562000
         BNZ   @RF00290                                            0290 00563000
*       DO;                         /* YES, CALCULATE RBA OF CI      */ 00564000
*         RWORK4=ADDR(IBFLP3);      /* GET ADDRESS OF RELATIVE CI #  */ 00565000
         L     RWORK4,IXSHEP(,RWORK3)                              0292 00566000
         LA    RWORK4,IBFLP3(,RWORK4)                              0292 00567000
*         RWORK5=IXHPTLS;           /* GET MASK FOR ICM INSTRUCTION  */ 00568000
         SLR   RWORK5,RWORK5                                       0293 00569000
         IC    RWORK5,IXHPTLS(,RBUFC)                              0293 00570000
*         RWORK2=ZERO;              /* CLEAR FOR INSERT OF CI #      */ 00571000
         SLR   RWORK2,RWORK2                                       0294 00572000
*         GEN FLOWS(INSERT) REFS(RWORK4,RWORK5) SETS(RWORK2)       0295 00573000
*             (EX    RWORK5,INSERT);/* EXECUTE ICM INTO RWORK2       */ 00574000
         EX    RWORK5,INSERT                                            00575000
*       END;                        /* END - CALCULATE RBA           */ 00576000
*     RESPECIFY                                                    0297 00577000
*      (RWORK4,                                                    0297 00578000
*       RWORK5) UNRESTRICTED;                                      0297 00579000
*                                                                  0297 00580000
@RF00290 DS    0H                                                  0298 00581000
*     /***************************************************************/ 00582000
*     /*                                                             */ 00583000
*     /* IF THE KEY IS NOT IN THE CURRENT CI, ERASE THE CURRENT      */ 00584000
*     /* RECORD AND ALL HIGHER KEY RECORDS THAT ARE IN THE CI.       */ 00585000
*     /*                                                             */ 00586000
*     /***************************************************************/ 00587000
*                                                                  0298 00588000
*     IF R15=FOUR|                  /* RECORD NOT IN THIS CA         */ 00589000
*         PLHDBUFC->BUFCDDDD^=RWORK2*AMDCINV+IXHBRBA/* OR EXPECTED 0298 00590000
*                                      RBA                           */ 00591000
*       THEN                        /* NOT EQUAL THE ACTUAL?         */ 00592000
         CH    R15,FOUR                                            0298 00593000
         BE    @RT00298                                            0298 00594000
         L     @14,PLHDBUFC(,RPLH)                                 0298 00595000
         L     @10,AMBDSB(,RAMB)                                   0298 00596000
         LR    @09,RWORK2                                          0298 00597000
         M     @08,AMDCINV(,@10)                                   0298 00598000
         AL    @09,IXHBRBA(,RBUFC)                                 0298 00599000
         CL    @09,BUFCDDDD(,@14)                                  0298 00600000
         BE    @RF00298                                            0298 00601000
@RT00298 DS    0H                                                  0299 00602000
*       DO;                         /* YES, PREPARE TO ERASE RECORDS */ 00603000
*         RBUFC=PLHDBUFC;           /* POINT TO THE DATA BUFC        */ 00604000
         L     RBUFC,PLHDBUFC(,RPLH)                               0300 00605000
*         IF PLHRECP-BUFCBAD=ZERO THEN/* FIRST RECORD IN THE CI?     */ 00606000
         L     @14,PLHRECP(,RPLH)                                  0301 00607000
         SL    @14,BUFCBAD(,RBUFC)                                 0301 00608000
         LTR   @14,@14                                             0301 00609000
         BNZ   @RF00301                                            0301 00610000
*           CALL ERREXIT;           /* YES, INVALID CONTROL INTERVAL */ 00611000
         BAL   @14,ERREXIT                                         0302 00612000
*         ELSE                      /* NOT FIRST RECORD IN CI SO     */ 00613000
*           RWORK3=PLHRECP-BUFCBAD; /* FREE SPACE OFFSET             */ 00614000
*                                                                  0303 00615000
         B     @RC00301                                            0303 00616000
@RF00301 L     RWORK3,PLHRECP(,RPLH)                               0303 00617000
         SL    RWORK3,BUFCBAD(,RBUFC)                              0303 00618000
*         /***********************************************************/ 00619000
*         /*                                                         */ 00620000
*         /* SET UP THE PLH TO ERASE DUPLICATE DATA FROM THE CI      */ 00621000
*         /*                                                         */ 00622000
*         /***********************************************************/ 00623000
*                                                                  0304 00624000
*         PLHFSP=PLHRECP;           /* SET THE FREE SPACE POINTER    */ 00625000
@RC00301 L     @14,PLHRECP(,RPLH)                                  0304 00626000
         ST    @14,PLHFSP(,RPLH)                                   0304 00627000
*         IF RDFREPL=ON THEN        /* RDFLL = REPLICATION COUNT ?   */ 00628000
         L     @14,PLHRDFP(,RPLH)                                  0305 00629000
         TM    RDFREPL(@14),B'00001000'                            0305 00630000
         BNO   @RF00305                                            0305 00631000
*           DO;                     /* YES, ADJUST REPLICATED RDF    */ 00632000
*             RDFLL=RDFLL-PLHRDFC;  /* DECREMENT BY CURRENT COUNT    */ 00633000
         SLR   @10,@10                                             0307 00634000
         ICM   @10,3,RDFLL(@14)                                    0307 00635000
         SH    @10,PLHRDFC(,RPLH)                                  0307 00636000
         STCM  @10,3,RDFLL(@14)                                    0307 00637000
*             IF RDFLL=ZERO THEN    /* IS THE COUNT NOW ZERO?        */ 00638000
         LTR   @10,@10                                             0308 00639000
         BNZ   @RF00308                                            0308 00640000
*               PLHRDFP=PLHRDFP+2*LENGTH(IDARDF);/* YES, REMOVE RDFS */ 00641000
         AL    @14,@CF00370                                        0309 00642000
         ST    @14,PLHRDFP(,RPLH)                                  0309 00643000
*             IF RDFLL=ONE THEN     /* IS THE COUNT NOW ONE?         */ 00644000
@RF00308 L     @14,PLHRDFP(,RPLH)                                  0310 00645000
         CLC   RDFLL(2,@14),@CH00051                               0310 00646000
         BNE   @RF00310                                            0310 00647000
*               DO;                 /* YES, CONVRT TO SINGLE         */ 00648000
*                 PLHRDFP=PLHRDFP+LENGTH(IDARDF);/* REMOVE SECOND OF    00649000
*                                      GROUP                         */ 00650000
         AL    @14,@CF00063                                        0312 00651000
         ST    @14,PLHRDFP(,RPLH)                                  0312 00652000
*                 RDFCTNU=OFF;      /* RESET CONTROL INDICATOR       */ 00653000
         NI    RDFCTNU(@14),B'10111111'                            0313 00654000
*               END;                /* END CONVERT TO SINGLE         */ 00655000
*           END;                    /* END - REPLICATED RDFS         */ 00656000
*         ELSE                      /* NOT REPLICATED RECORDS        */ 00657000
*           PLHRDFP=PLHRDFP+LENGTH(IDARDF);/* SO REMOVE THE RDF      */ 00658000
*                                                                  0316 00659000
         B     @RC00305                                            0316 00660000
@RF00305 LA    @14,3                                               0316 00661000
         AL    @14,PLHRDFP(,RPLH)                                  0316 00662000
         ST    @14,PLHRDFP(,RPLH)                                  0316 00663000
*         /***********************************************************/ 00664000
*         /*                                                         */ 00665000
*         /* ERASE THE DUPLICATE DATA FROM THE CONTROL INTERVAL      */ 00666000
*         /*                                                         */ 00667000
*         /***********************************************************/ 00668000
*                                                                  0317 00669000
*         RESPECIFY                                                0317 00670000
*          (RWORK4,                                                0317 00671000
*           RWORK5) RESTRICTED;                                    0317 00672000
@RC00305 DS    0H                                                  0318 00673000
*         RWORK4=PLHRECP;           /* START OF AREA TO BE CLEARED   */ 00674000
         L     @14,PLHRECP(,RPLH)                                  0318 00675000
         LR    RWORK4,@14                                          0318 00676000
*         RWORK5=PLHRDFP-PLHRECP;   /* LENGTH OF AREA TO BE CLEARED  */ 00677000
         LCR   @14,@14                                             0319 00678000
         AL    @14,PLHRDFP(,RPLH)                                  0319 00679000
         LR    RWORK5,@14                                          0319 00680000
*         CIDFOSET=RWORK3;          /* ESTABLISH FREE SPACE OFFSET   */ 00681000
         L     @14,AMBDSB(,RAMB)                                   0320 00682000
         L     @10,BUFCBAD(,RBUFC)                                 0320 00683000
         AL    @10,AMDCINV(,@14)                                   0320 00684000
         SL    @10,@CF00089                                        0320 00685000
         STH   RWORK3,CIDFOSET(,@10)                               0320 00686000
*         CIDFLL=RWORK5;            /* ESTABLISH FREE SPACE LENGTH   */ 00687000
         STH   RWORK5,CIDFLL(,@10)                                 0321 00688000
*         R15=ZERO;                 /* R15 IS ZERO TO CLEAR AREA     */ 00689000
         SLR   R15,R15                                             0322 00690000
*         MVCL(RWORK4,R14);         /* CLEAR THE CI FREE SPACE       */ 00691000
         MVCL  RWORK4,R14                                          0323 00692000
*         RESPECIFY                                                0324 00693000
*          (RWORK4,                                                0324 00694000
*           RWORK5) UNRESTRICTED;                                  0324 00695000
*       END;                        /* END - ERASE PROCESSING        */ 00696000
*     ELSE                          /* EXPECTED EQUALS ACTUAL        */ 00697000
*       DO;                         /* ADVANCE RDF & RECORD POINTERS */ 00698000
         B     @RC00298                                            0326 00699000
@RF00298 DS    0H                                                  0327 00700000
*         PLHRECP=PLHRECP+PLHLRECL; /* ADVANCE TO NEXT RECORD        */ 00701000
         L     @14,PLHRECP(,RPLH)                                  0327 00702000
         AL    @14,PLHLRECL(,RPLH)                                 0327 00703000
         ST    @14,PLHRECP(,RPLH)                                  0327 00704000
*         CALL ADVRDF;              /* ADVANCE TO THE NEXT RDF       */ 00705000
         BAL   @14,ADVRDF                                          0328 00706000
*       END;                        /* END - ADVANCE POINTERS        */ 00707000
*     RESPECIFY                                                    0330 00708000
*      (RWORK2,                                                    0330 00709000
*       R15) UNRESTRICTED;                                         0330 00710000
@RC00298 DS    0H                                                  0331 00711000
*   END;                            /* END - WHILE NOT IN FREE SPACE */ 00712000
@DE00278 CLC   PLHRECP(4,RPLH),PLHFSP(RPLH)                        0331 00713000
         BL    @DL00278                                            0331 00714000
*   RESPECIFY                                                      0332 00715000
*     RWORK3 UNRESTRICTED;          /* RELEASE REGISTER FOR SCIB     */ 00716000
*   RBUFC=PLHDBUFC;                 /* RBUFC POINTS TO DATA BUFC     */ 00717000
         L     RBUFC,PLHDBUFC(,RPLH)                               0333 00718000
*   CALL EXIT;                      /* EXIT TO MAIN ROUTINE          */ 00719000
*                                                                  0334 00720000
         BAL   @14,EXIT                                            0334 00721000
*   /*****************************************************************/ 00722000
*   /*                                                               */ 00723000
*   /* INSERT-CHARACTER-UNDER-MASK INSTRUCTION USED TO PROCESS INDEX */ 00724000
*   /*                                                               */ 00725000
*   /*****************************************************************/ 00726000
*                                                                  0335 00727000
*INSERT:                                                           0335 00728000
*   GEN(ICM   RWORK2,0,0(RWORK4));  /* INSERT RELATIVE CI NUMBER     */ 00729000
INSERT   ICM   RWORK2,0,0(RWORK4)                                       00730000
*   END FIXCI;                                                     0336 00731000
@EL00003 DS    0H                                                  0336 00732000
@EF00003 DS    0H                                                  0336 00733000
@ER00003 BR    @14                                                 0336 00734000
*ADVRDF:                                                           0337 00735000
*                                                                  0337 00736000
*/********************************************************************/ 00737000
*/*                                                                  */ 00738000
*/*   FUNCTION - ADVANCES THE PLHRDFC AND PLHRDFP FIELDS TO THE      */ 00739000
*/*              NEXT LOGICAL RDF.                                   */ 00740000
*/*                                                                  */ 00741000
*/*   INPUT    - RPLH POINTS TO THE PLH.                             */ 00742000
*/*              PLHLRECL CONTAINS THE LENGTH OF THE PREVIOUS RECORD.*/ 00743000
*/*              PLHRDFC CONTAINS THE CURRENT RDF REPLICATION COUNT. */ 00744000
*/*              PLHRDFP POINTS TO THE CURRENT RDF.                  */ 00745000
*/*                                                                  */ 00746000
*/*   OUTPUT   - PLHLRECL CONTAINS THE LENGTH OF THE CURRENT RECORD. */ 00747000
*/*              PLHRDFC AND PLHRDFP HAVE BEEN ADVANCED.             */ 00748000
*/*                                                                  */ 00749000
*/********************************************************************/ 00750000
*                                                                  0337 00751000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0337 00752000
ADVRDF   DS    0H                                                  0338 00753000
*   RESPECIFY                                                      0338 00754000
*    (RWORK1,                                                      0338 00755000
*     R14) RESTRICTED;              /* RESTRICT REGISTERS            */ 00756000
*   RESPECIFY                                                      0339 00757000
*     IDARDF BASED(RWORK1);         /* RDF POINTER FOR ADVRDF        */ 00758000
*   RWORK1=PLHRDFP;                 /* ADDRESSABILITY TO THE RDF     */ 00759000
         L     RWORK1,PLHRDFP(,RPLH)                               0340 00760000
*   IF PLHRDFC>ONE THEN             /* IF REPLICATION COUNT > ONE    */ 00761000
         LH    @15,PLHRDFC(,RPLH)                                  0341 00762000
         C     @15,@CF00051                                        0341 00763000
         BNH   @RF00341                                            0341 00764000
*     PLHRDFC=PLHRDFC-ONE;          /* DECREMENT THE COUNT           */ 00765000
         BCTR  @15,0                                               0342 00766000
         STH   @15,PLHRDFC(,RPLH)                                  0342 00767000
*   ELSE                            /* IF REPLICATION COUNT < TWO    */ 00768000
*     DO;                           /* ADVANCE THE RDF POINTER       */ 00769000
         B     @RC00341                                            0343 00770000
@RF00341 DS    0H                                                  0344 00771000
*       RWORK1=RWORK1-LENGTH(IDARDF);/* MOVE TO THE NEXT RDF         */ 00772000
         LA    @15,3                                               0344 00773000
         SLR   RWORK1,@15                                          0344 00774000
*       PLHLRECL=RDFLL;             /* UPDATE THE RECORD LENGTH      */ 00775000
         SLR   @10,@10                                             0345 00776000
         ICM   @10,3,RDFLL(RWORK1)                                 0345 00777000
         ST    @10,PLHLRECL(,RPLH)                                 0345 00778000
*       IF RDFCTNU=ON THEN          /* IS THIS A GROUP RDF?          */ 00779000
         TM    RDFCTNU(RWORK1),B'01000000'                         0346 00780000
         BNO   @RF00346                                            0346 00781000
*         DO;                       /* YES                           */ 00782000
*           RWORK1=RWORK1-LENGTH(IDARDF);/* MOVE TO THE NEXT RDF     */ 00783000
         SLR   RWORK1,@15                                          0348 00784000
*           PLHRDFC=RDFLL;          /* SET THE RECORD COUNT          */ 00785000
         MVC   PLHRDFC(2,RPLH),RDFLL(RWORK1)                       0349 00786000
*         END;                      /* END - GROUP RDF               */ 00787000
*       PLHRDFP=RWORK1;             /* SET NEW RDF POINTER           */ 00788000
@RF00346 ST    RWORK1,PLHRDFP(,RPLH)                               0351 00789000
*     END;                          /* END - ADVANCE RDF POINTER     */ 00790000
*   RESPECIFY                                                      0353 00791000
*     IDARDF BASED(PLHRDFP);        /* RESET RDF BASING              */ 00792000
*   RESPECIFY                                                      0354 00793000
*    (RWORK1,                                                      0354 00794000
*     R14) UNRESTRICTED;            /* RELEASE REGISTERS AND         */ 00795000
*   END ADVRDF;                     /* RETURN                        */ 00796000
@EL00004 DS    0H                                                  0355 00797000
@EF00004 DS    0H                                                  0355 00798000
@ER00004 BR    @14                                                 0355 00799000
*EXIT:                                                             0356 00800000
*                                                                  0356 00801000
*/********************************************************************/ 00802000
*/*                                                                  */ 00803000
*/*   FUNCTION - RESTORES REGISTER 14 FROM PLH PUSHDOWN LIST AND     */ 00804000
*/*               RETURNS.                                           */ 00805000
*/*                                                                  */ 00806000
*/********************************************************************/ 00807000
*                                                                  0356 00808000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0356 00809000
EXIT     DS    0H                                                  0357 00810000
*   PLHNOADV=OFF;                   /* CALLER MUST SET POSITIONING   */ 00811000
         NI    PLHNOADV(RPLH),B'11110111'                          0357 00812000
*   GEN REFS(HWORD4)(IDARST14);     /* RESTORE REGISTER 14           */ 00813000
         IDARST14                                                       00814000
*   END EXIT;                       /* RETURN                        */ 00815000
@EL00005 DS    0H                                                  0359 00816000
@EF00005 DS    0H                                                  0359 00817000
@ER00005 BR    @14                                                 0359 00818000
*ERREXIT:                                                          0360 00819000
*                                                                  0360 00820000
*/********************************************************************/ 00821000
*/*                                                                  */ 00822000
*/*   FUNCTION - PERFORMS ERROR PROCESSING FOR AN INVALID CONTROL    */ 00823000
*/*              INTERVAL AND RETURNS TO THE CALLING ROUTINE.        */ 00824000
*/*                                                                  */ 00825000
*/********************************************************************/ 00826000
*                                                                  0360 00827000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0360 00828000
ERREXIT  DS    0H                                                  0361 00829000
*   CIDFBUSY=ON;                    /* TURN THE BUSY BIT ON AGAIN    */ 00830000
         L     @10,AMBDSB(,RAMB)                                   0361 00831000
         L     @05,BUFCBAD(,RBUFC)                                 0361 00832000
         AL    @05,AMDCINV(,@10)                                   0361 00833000
         BCTR  @05,0                                               0361 00834000
         BCTR  @05,0                                               0361 00835000
         OI    CIDFBUSY-2(@05),B'10000000'                         0361 00836000
*   PLHSKPER=ON;                    /* CI IN ERROR - SKIP            */ 00837000
         OI    PLHSKPER(RPLH),B'00100000'                          0362 00838000
*   RPLERREG='08'X;                 /* SET LOGICAL ERROR             */ 00839000
         MVI   RPLERREG(RRPL),X'08'                                0363 00840000
*   RPLERRCD=RPLINCNV;              /* SET INVALID CONTROL INTERVAL  */ 00841000
         MVI   RPLERRCD(RRPL),X'9C'                                0364 00842000
*   GEN(IDARST14);                  /* RESTORE REGISTER 14           */ 00843000
         IDARST14                                                       00844000
*   END ERREXIT;                    /* RETURN, CI IS IN ERROR        */ 00845000
@EL00006 DS    0H                                                  0366 00846000
@EF00006 DS    0H                                                  0366 00847000
@ER00006 BR    @14                                                 0366 00848000
@PB00006 DS    0H                                                  0367 00849000
*   GEN(IDAPATCH);                  /* DEFINE A PATCH SPACE          */ 00850000
         IDAPATCH                                                       00851000
*   END IDA019S6                                                   0368 00852000
*                                                                  0368 00853000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00854000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 00855000
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */ 00856000
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */ 00857000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */ 00858000
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */ 00859000
*/*%INCLUDE SYSLIB  (IDACIDF )                                       */ 00860000
*/*%INCLUDE SYSLIB  (IDADIWA )                                       */ 00861000
*/*%INCLUDE SYSLIB  (IDAICWA )                                       */ 00862000
*/*%INCLUDE SYSLIB  (IDAIMWA )                                       */ 00863000
*/*%INCLUDE SYSLIB  (IDAIRD  )                                       */ 00864000
*/*%INCLUDE SYSLIB  (IDAIXSPL)                                       */ 00865000
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */ 00866000
*/*%INCLUDE SYSLIB  (IDARDF  )                                       */ 00867000
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */ 00868000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 00869000
*/*%INCLUDE SYSLIB  (IDAREGS )                                       */ 00870000
*                                                                  0368 00871000
*       ;                                                          0368 00872000
@EL00001 DS    0H                                                  0368 00873000
@EF00001 DS    0H                                                  0368 00874000
@ER00001 BR    @14                                                 0368 00875000
@DATA    DS    0H                                                       00876000
@SC01093 CLC   KEY(0,@05),KEY(RPARM1)                                   00877000
@DATD    DSECT                                                          00878000
         DS    0F                                                       00879000
IDA019S6 CSECT                                                          00880000
         DS    0F                                                       00881000
@CF00051 DC    F'1'                                                     00882000
@CH00051 EQU   @CF00051+2                                               00883000
@CF00063 DC    F'3'                                                     00884000
@CF00089 DC    F'4'                                                     00885000
@CF00370 DC    F'6'                                                     00886000
@CF00766 DC    F'36'                                                    00887000
@DATD    DSECT                                                          00888000
         DS    0D                                                       00889000
IDA019S6 CSECT                                                          00890000
         NOPR  ((@ENDDATD-@DATD)*16)                                    00891000
         DS    0F                                                       00892000
@SIZDATD DC    AL1(0)                                                   00893000
         DC    AL3(@ENDDATD-@DATD)                                      00894000
@CV01046 DC    V(IDADRQ)                                                00895000
@CV01047 DC    V(IDAWRBFR)                                              00896000
@CV01048 DC    V(IDA019RC)                                              00897000
         DS    0D                                                       00898000
FOUR     DC    H'4'                                                     00899000
HWORD4   DC    H'4'                                                     00900000
@DATD    DSECT                                                          00901000
*                                                          /*@X04SVLC*/ 00902000
RDFCTNUA EQU   X'40'                    COMPLEX RDF INDICATOR           00903000
RDFCTNUX EQU   X'FF'-RDFCTNUA           RESET COMPLEX MASK              00904000
RDFREPLA EQU   X'08'                    COUNT RDF INDICATOR             00905000
RDFREPLX EQU   X'FF'-RDFREPLA           RESET COUNT MASK                00906000
RDFEMPTI EQU   X'04'                    EMPTY RECORD       /*@X04SVLC*/ 00907000
RDFLEN   EQU   3                        LENGTH OF RDF                   00908000
RDFLLOFF EQU   1                        OFFSET WITHIN RDF TO LL         00909000
RDFSGLR  EQU   X'00'                   MASK FOR SINGLE RECORD RDF       00910000
RDFGRP   EQU   RDFCTNUA                 MASK FOR LL RDF OF A GROUP RDF  00911000
RDFCNT   EQU   RDFREPLA                 MASK FOR COUNT RDF              00912000
@DATD    DSECT                                                          00913000
@ENDDATD EQU   *                                                        00914000
IDA019S6 CSECT                                                          00915000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00916000
@01      EQU   01                                                       00917000
@02      EQU   02                                                       00918000
@03      EQU   03                                                       00919000
@04      EQU   04                                                       00920000
@05      EQU   05                                                       00921000
@06      EQU   06                                                       00922000
@07      EQU   07                                                       00923000
@08      EQU   08                                                       00924000
@09      EQU   09                                                       00925000
@10      EQU   10                                                       00926000
@11      EQU   11                                                       00927000
@12      EQU   12                                                       00928000
@13      EQU   13                                                       00929000
@14      EQU   14                                                       00930000
@15      EQU   15                                                       00931000
RWORK0   EQU   @00                                                      00932000
RRPL     EQU   @01                                                      00933000
RPLH     EQU   @02                                                      00934000
RAMB     EQU   @03                                                      00935000
RBUFC    EQU   @04                                                      00936000
RWORK1   EQU   @05                                                      00937000
RWORK2   EQU   @06                                                      00938000
RWORK3   EQU   @07                                                      00939000
RWORK4   EQU   @08                                                      00940000
RWORK5   EQU   @09                                                      00941000
RPARM1   EQU   @12                                                      00942000
R14      EQU   @14                                                      00943000
R15      EQU   @15                                                      00944000
R1       EQU   @01                                                      00945000
R10      EQU   @10                                                      00946000
R11      EQU   @11                                                      00947000
R13      EQU   @13                                                      00948000
IFGACB   EQU   0                                                        00949000
ACBCOMN  EQU   IFGACB                                                   00950000
ACBLENG  EQU   ACBCOMN+2                                                00951000
ACBLENG2 EQU   ACBLENG                                                  00952000
ACBAMBL  EQU   ACBCOMN+4                                                00953000
ACBJWA   EQU   ACBAMBL                                                  00954000
ACBMACRF EQU   ACBCOMN+12                                               00955000
ACBMACR1 EQU   ACBMACRF                                                 00956000
ACBADR   EQU   ACBMACR1                                                 00957000
ACBCNV   EQU   ACBMACR1                                                 00958000
ACBMACR2 EQU   ACBMACRF+1                                               00959000
ACBBUFPL EQU   ACBCOMN+20                                               00960000
ACBMACR3 EQU   ACBBUFPL                                                 00961000
ACBRECFM EQU   ACBCOMN+24                                               00962000
ACBCCTYP EQU   ACBCOMN+25                                               00963000
ACBOPT   EQU   ACBCOMN+26                                               00964000
ACBDSORG EQU   ACBOPT                                                   00965000
ACBCROPS EQU   ACBDSORG                                                 00966000
ACBEXLST EQU   ACBCOMN+36                                               00967000
ACBDDNM  EQU   ACBCOMN+40                                               00968000
ACBAMETH EQU   ACBDDNM+3                                                00969000
ACBOFLGS EQU   ACBCOMN+48                                               00970000
ACBEXFG  EQU   ACBOFLGS                                                 00971000
ACBIOSFG EQU   ACBOFLGS                                                 00972000
ACBINFLG EQU   ACBCOMN+50                                               00973000
ACBUJFCB EQU   ACBCOMN+52                                               00974000
ACBBLKSZ EQU   ACBCOMN+60                                               00975000
IDAAMB   EQU   0                                                        00976000
AMBDSB   EQU   IDAAMB+20                                                00977000
AMBEOVR  EQU   IDAAMB+24                                                00978000
AMBFLG0  EQU   AMBEOVR                                                  00979000
AMBFLG1  EQU   IDAAMB+25                                                00980000
AMBDSORG EQU   IDAAMB+26                                                00981000
AMBIOBAD EQU   IDAAMB+28                                                00982000
AMBINFL  EQU   IDAAMB+42                                                00983000
AMBDEBPT EQU   IDAAMB+44                                                00984000
AMBOFLGS EQU   IDAAMB+48                                                00985000
AMBFLG2  EQU   IDAAMB+49                                                00986000
AMBEOVPT EQU   IDAAMB+56                                                00987000
AMBIWA   EQU   IDAAMB+64                                                00988000
AMBCSWD1 EQU   IDAAMB+84                                                00989000
AMBAFLG  EQU   AMBCSWD1                                                 00990000
IDAAMBL  EQU   0                                                        00991000
AMBLEOV  EQU   IDAAMBL+12                                               00992000
AMBLEFLG EQU   AMBLEOV                                                  00993000
AMBLDDNM EQU   IDAAMBL+16                                               00994000
AMBLIDF  EQU   AMBLDDNM                                                 00995000
AMBLQ    EQU   AMBLIDF+7                                                00996000
AMBLVC   EQU   IDAAMBL+28                                               00997000
AMBLTYPE EQU   IDAAMBL+30                                               00998000
AMBLSHAR EQU   IDAAMBL+33                                               00999000
AMBLWRIT EQU   AMBLSHAR                                                 01000000
AMBLFLG1 EQU   IDAAMBL+35                                               01001000
AMBLFLG2 EQU   IDAAMBL+36                                               01002000
AMBLDTA  EQU   IDAAMBL+52                                               01003000
AMBLIX   EQU   IDAAMBL+56                                               01004000
IDAAMDSB EQU   0                                                        01005000
AMDATTR  EQU   IDAAMDSB+1                                               01006000
AMDNEST  EQU   IDAAMDSB+4                                               01007000
AMDRKP   EQU   IDAAMDSB+6                                               01008000
AMDKEYLN EQU   IDAAMDSB+8                                               01009000
AMDCINV  EQU   IDAAMDSB+20                                              01010000
AMDHLRBA EQU   IDAAMDSB+28                                              01011000
AMDSSRBA EQU   IDAAMDSB+32                                              01012000
AMDATTR3 EQU   IDAAMDSB+40                                              01013000
AMDSTAT  EQU   IDAAMDSB+48                                              01014000
IDABUFDR EQU   0                                                        01015000
BUFDRCIX EQU   IDABUFDR+9                                               01016000
BUFDRFLG EQU   IDABUFDR+11                                              01017000
IDABUFC  EQU   0                                                        01018000
BUFCAVL  EQU   IDABUFC                                                  01019000
BUFCUCNT EQU   BUFCAVL                                                  01020000
BUFCFLG1 EQU   IDABUFC+1                                                01021000
BUFCVAL  EQU   BUFCFLG1                                                 01022000
BUFCEXC  EQU   BUFCFLG1                                                 01023000
BUFCIOFL EQU   IDABUFC+2                                                01024000
BUFCMW   EQU   BUFCIOFL                                                 01025000
BUFCFLG2 EQU   IDABUFC+3                                                01026000
BUFCPLH  EQU   IDABUFC+4                                                01027000
BUFCDDDD EQU   IDABUFC+8                                                01028000
BUFCORBA EQU   IDABUFC+12                                               01029000
BUFCBAD  EQU   IDABUFC+20                                               01030000
BUFCINV  EQU   IDABUFC+28                                               01031000
IDACIDF  EQU   0                                                        01032000
CIDFOSET EQU   IDACIDF                                                  01033000
CIDFLL   EQU   IDACIDF+2                                                01034000
CIDFBUSY EQU   CIDFLL                                                   01035000
IDADIWA  EQU   0                                                        01036000
DIWATV   EQU   IDADIWA+1                                                01037000
DIWFLG1  EQU   IDADIWA+4                                                01038000
DIWFLG2  EQU   IDADIWA+5                                                01039000
DIWPLH   EQU   IDADIWA+16                                               01040000
DIWSAVE  EQU   IDADIWA+28                                               01041000
DIWSAVE1 EQU   DIWSAVE                                                  01042000
DIWSAVE2 EQU   DIWSAVE+4                                                01043000
DIWSAVE3 EQU   DIWSAVE+8                                                01044000
IDAICWA  EQU   0                                                        01045000
ICWFLG1  EQU   IDAICWA+1                                                01046000
ICWCHN   EQU   IDAICWA+4                                                01047000
IDAIMWA  EQU   0                                                        01048000
IMWFLAGS EQU   IDAIMWA+1                                                01049000
IMWISWKA EQU   IDAIMWA+8                                                01050000
IDAIXH   EQU   0                                                        01051000
IXHPTLS  EQU   IDAIXH+3                                                 01052000
IXHBRBA  EQU   IDAIXH+4                                                 01053000
IDAIBFLP EQU   0                                                        01054000
IBFLP3   EQU   IDAIBFLP+2                                               01055000
IBFLP2   EQU   IBFLP3                                                   01056000
IDASELL  EQU   0                                                        01057000
IDAIXK   EQU   0                                                        01058000
IDAIXSPL EQU   0                                                        01059000
IXSBFLG  EQU   IDAIXSPL+17                                              01060000
IXSHEP   EQU   IDAIXSPL+20                                              01061000
IDAPLHDR EQU   0                                                        01062000
IDAPLH   EQU   0                                                        01063000
PLHFLG1  EQU   IDAPLH+2                                                 01064000
PLHRDEXC EQU   PLHFLG1                                                  01065000
PLHFLG2  EQU   IDAPLH+3                                                 01066000
PLHEFLGS EQU   IDAPLH+4                                                 01067000
PLHSKPER EQU   PLHEFLGS                                                 01068000
PLHNOADV EQU   PLHEFLGS                                                 01069000
PLHFLG3  EQU   IDAPLH+6                                                 01070000
PLHAFLGS EQU   IDAPLH+7                                                 01071000
PLHDBDC  EQU   PLHAFLGS                                                 01072000
PLHCRBA  EQU   IDAPLH+28                                                01073000
PLHJORBA EQU   PLHCRBA                                                  01074000
PLHJCODE EQU   IDAPLH+40                                                01075000
PLHLRECL EQU   IDAPLH+48                                                01076000
PLHDBUFC EQU   IDAPLH+52                                                01077000
PLHRECP  EQU   IDAPLH+60                                                01078000
PLHFSP   EQU   IDAPLH+64                                                01079000
PLHRDFP  EQU   IDAPLH+68                                                01080000
PLHRDFC  EQU   IDAPLH+72                                                01081000
PLHDIOB  EQU   IDAPLH+76                                                01082000
PLHRETO  EQU   IDAPLH+116                                               01083000
PLHRET1  EQU   IDAPLH+120                                               01084000
PLHEOVPT EQU   IDAPLH+180                                               01085000
PLHIBUFC EQU   IDAPLH+188                                               01086000
PLHIXSPL EQU   IDAPLH+200                                               01087000
PLHSSRBA EQU   PLHIXSPL                                                 01088000
PLHWAX   EQU   IDAPLH+232                                               01089000
PLHKEYPT EQU   IDAPLH+248                                               01090000
PLHEND   EQU   IDAPLH+280                                               01091000
IDARDF   EQU   0                                                        01092000
RDFRBYTE EQU   IDARDF                                                   01093000
RDFCTNU  EQU   RDFRBYTE                                                 01094000
RDFSEG   EQU   RDFRBYTE                                                 01095000
RDFNOT1  EQU   RDFSEG                                                   01096000
RDF1ST   EQU   RDFSEG                                                   01097000
RDFREPL  EQU   RDFRBYTE                                                 01098000
RDFLL    EQU   IDARDF+1                                                 01099000
IDADATA  EQU   0                                                        01100000
IDAKEY   EQU   0                                                        01101000
KEY      EQU   IDAKEY                                                   01102000
IFGRPL   EQU   0                                                        01103000
RPLCOMN  EQU   IFGRPL                                                   01104000
RPLIDWD  EQU   RPLCOMN                                                  01105000
RPLREQ   EQU   RPLIDWD+2                                                01106000
RPLLEN   EQU   RPLIDWD+3                                                01107000
RPLECB   EQU   RPLCOMN+8                                                01108000
RPLFDBWD EQU   RPLCOMN+12                                               01109000
RPLFDBK  EQU   RPLFDBWD+1                                               01110000
RPLRTNCD EQU   RPLFDBK                                                  01111000
RPLERREG EQU   RPLRTNCD                                                 01112000
RPLCNDCD EQU   RPLFDBK+1                                                01113000
RPLCMPON EQU   RPLCNDCD                                                 01114000
RPLFDB2  EQU   RPLCMPON                                                 01115000
RPLERRCD EQU   RPLCNDCD+1                                               01116000
RPLFDB3  EQU   RPLERRCD                                                 01117000
RPLKEYLE EQU   RPLCOMN+16                                               01118000
RPLDACB  EQU   RPLCOMN+24                                               01119000
RPLARG   EQU   RPLCOMN+36                                               01120000
RPLOPTCD EQU   RPLCOMN+40                                               01121000
RPLOPT1  EQU   RPLOPTCD                                                 01122000
RPLECBSW EQU   RPLOPT1                                                  01123000
RPLOPT2  EQU   RPLOPTCD+1                                               01124000
RPLKEY   EQU   RPLOPT2                                                  01125000
RPLADR   EQU   RPLOPT2                                                  01126000
RPLUPD   EQU   RPLOPT2                                                  01127000
RPLOPT3  EQU   RPLOPTCD+2                                               01128000
RPLNXTRP EQU   RPLCOMN+44                                               01129000
RPLOPTC2 EQU   RPLCOMN+56                                               01130000
RPLOPT5  EQU   RPLOPTC2                                                 01131000
RPLWRTYP EQU   RPLOPT5                                                  01132000
RPLOPT6  EQU   RPLOPTC2+1                                               01133000
RPLUNTYP EQU   RPLOPT6                                                  01134000
RPLOPT7  EQU   RPLOPTC2+2                                               01135000
RPLCNOPT EQU   RPLOPT7                                                  01136000
RPLOPT8  EQU   RPLOPTC2+3                                               01137000
RPLRBAR  EQU   RPLCOMN+60                                               01138000
RPLAIXID EQU   RPLRBAR+2                                                01139000
RPLDDDD  EQU   RPLRBAR+4                                                01140000
RPLEXTDS EQU   RPLCOMN+68                                               01141000
RPLEXTD1 EQU   RPLEXTDS                                                 01142000
ICWKEY2  EQU   0                                                        01143000
ICWKEY3  EQU   0                                                        01144000
PLHKEY   EQU   0                                                        01145000
PLHPDL   EQU   0                                                        01146000
PLHPDLE  EQU   0                                                        01147000
PLHRRN   EQU   0                                                        01148000
FSO      EQU   CIDFOSET                                                 01149000
FSL      EQU   CIDFLL                                                   01150000
PLHEXTEN EQU   PLHEND                                                   01151000
PLHBMWRK EQU   PLHEXTEN+5                                               01152000
@NM00061 EQU   DIWSAVE1                                                 01153000
S6FLAGS  EQU   @NM00061                                                 01154000
S6NOKEY  EQU   S6FLAGS                                                  01155000
BUFCRSC1 EQU   BUFCAVL                                                  01156000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01157000
PLHBMSV5 EQU   PLHEXTEN+24                                              01158000
PLHBMSV4 EQU   PLHEXTEN+20                                              01159000
PLHBMSV3 EQU   PLHEXTEN+16                                              01160000
PLHBMSV2 EQU   PLHEXTEN+12                                              01161000
PLHBMSV1 EQU   PLHEXTEN+8                                               01162000
PLHRDCNT EQU   PLHEXTEN+6                                               01163000
PLHBMSOV EQU   PLHBMWRK                                                 01164000
PLHBEUC  EQU   PLHBMWRK                                                 01165000
PLHBMRDF EQU   PLHBMWRK                                                 01166000
@NM00057 EQU   PLHEXTEN+4                                               01167000
PLHRESR1 EQU   PLHEXTEN                                                 01168000
RPLERMSA EQU   RPLCOMN+72                                               01169000
RPLEMLEN EQU   RPLCOMN+70                                               01170000
RPLACTIV EQU   RPLCOMN+69                                               01171000
RPLBRANC EQU   RPLEXTD1                                                 01172000
RPLNIB   EQU   RPLEXTD1                                                 01173000
@NM00060 EQU   RPLEXTD1                                                 01174000
RPLEXIT  EQU   RPLEXTD1                                                 01175000
RPLNEXIT EQU   RPLEXTD1                                                 01176000
RPLEXSCH EQU   RPLEXTD1                                                 01177000
@NM00059 EQU   RPLRBAR+3                                                01178000
@NM00058 EQU   RPLAIXID                                                 01179000
RPLAXPKP EQU   RPLAIXID                                                 01180000
RPLAIXPC EQU   RPLRBAR                                                  01181000
RPLRSV88 EQU   RPLOPT8                                                  01182000
RPLUNCON EQU   RPLOPT8                                                  01183000
RPLACTV  EQU   RPLOPT8                                                  01184000
RPLSESS  EQU   RPLOPT8                                                  01185000
RPLPEND  EQU   RPLOPT8                                                  01186000
RPLODPRM EQU   RPLOPT8                                                  01187000
RPLODACP EQU   RPLOPT8                                                  01188000
RPLODACQ EQU   RPLOPT8                                                  01189000
RPLRSV78 EQU   RPLOPT7                                                  01190000
RPLRSV77 EQU   RPLOPT7                                                  01191000
RPLRLSOP EQU   RPLOPT7                                                  01192000
RPLTPOST EQU   RPLOPT7                                                  01193000
RPLQOPT  EQU   RPLOPT7                                                  01194000
RPLCNIMM EQU   RPLCNOPT                                                 01195000
RPLCNANY EQU   RPLCNOPT                                                 01196000
RPLCNALL EQU   RPLCNOPT                                                 01197000
RPLRSV68 EQU   RPLOPT6                                                  01198000
RPLRSV67 EQU   RPLOPT6                                                  01199000
RPLLOCK  EQU   RPLOPT6                                                  01200000
RPLNCOND EQU   RPLOPT6                                                  01201000
RPLCOND  EQU   RPLOPT6                                                  01202000
RPLEOT   EQU   RPLUNTYP                                                 01203000
RPLEOM   EQU   RPLUNTYP                                                 01204000
RPLEOB   EQU   RPLUNTYP                                                 01205000
RPLWROPT EQU   RPLOPT5                                                  01206000
RPLNODE  EQU   RPLOPT5                                                  01207000
RPLERACE EQU   RPLWRTYP                                                 01208000
RPLEAU   EQU   RPLWRTYP                                                 01209000
RPLNERAS EQU   RPLWRTYP                                                 01210000
RPLPSOPT EQU   RPLOPT5                                                  01211000
RPLSSNIN EQU   RPLOPT5                                                  01212000
RPLDLGIN EQU   RPLOPT5                                                  01213000
RPLBUFL  EQU   RPLCOMN+52                                               01214000
RPLRLEN  EQU   RPLCOMN+48                                               01215000
RPLCHAIN EQU   RPLNXTRP                                                 01216000
RPLOPT4  EQU   RPLOPTCD+3                                               01217000
RPLALIGN EQU   RPLOPT3                                                  01218000
RPLFMT   EQU   RPLOPT3                                                  01219000
RPLFLD   EQU   RPLOPT3                                                  01220000
RPLVFY   EQU   RPLOPT3                                                  01221000
RPLBLK   EQU   RPLOPT3                                                  01222000
RPLSFORM EQU   RPLOPT3                                                  01223000
RPLEODS  EQU   RPLOPT3                                                  01224000
RPLNSP   EQU   RPLOPT2                                                  01225000
RPLWAITX EQU   RPLOPT2                                                  01226000
RPLLRD   EQU   RPLOPT2                                                  01227000
RPLBWD   EQU   RPLOPT2                                                  01228000
RPLCNV   EQU   RPLOPT2                                                  01229000
RPLADD   EQU   RPLADR                                                   01230000
RPLECBIN EQU   RPLECBSW                                                 01231000
RPLGEN   EQU   RPLOPT1                                                  01232000
RPLKGE   EQU   RPLOPT1                                                  01233000
RPLASY   EQU   RPLOPT1                                                  01234000
RPLSKP   EQU   RPLOPT1                                                  01235000
RPLSEQ   EQU   RPLOPT1                                                  01236000
RPLDIR   EQU   RPLOPT1                                                  01237000
RPLLOC   EQU   RPLOPT1                                                  01238000
RPLDAF   EQU   RPLARG+2                                                 01239000
RPLSAF   EQU   RPLARG                                                   01240000
RPLAREA  EQU   RPLCOMN+32                                               01241000
RPLTCBPT EQU   RPLCOMN+28                                               01242000
RPLCCHAR EQU   RPLCOMN+20                                               01243000
RPLSTRID EQU   RPLCOMN+18                                               01244000
RPLKEYL  EQU   RPLKEYLE                                                 01245000
RPLRDSOH EQU   RPLFDB3                                                  01246000
RPLRLG   EQU   RPLFDB3                                                  01247000
RPLLGFRC EQU   RPLFDB3                                                  01248000
RPLREOT  EQU   RPLFDB3                                                  01249000
RPLREOM  EQU   RPLFDB3                                                  01250000
RPLREOB  EQU   RPLFDB3                                                  01251000
RPLSV32  EQU   RPLFDB3                                                  01252000
RPLUINPT EQU   RPLFDB3                                                  01253000
RPLSTSAV EQU   RPLFDB2                                                  01254000
RPLCUERR EQU   RPLFDB2                                                  01255000
RPLDLGFL EQU   RPLFDB2                                                  01256000
RPLIOERR EQU   RPLFDB2                                                  01257000
RPLDVUNS EQU   RPLFDB2                                                  01258000
RPLATND  EQU   RPLFDB2                                                  01259000
RPLRVID  EQU   RPLFDB2                                                  01260000
RPLERLK  EQU   RPLFDB2                                                  01261000
RPLSTAT  EQU   RPLFDBWD                                                 01262000
RPLPOST  EQU   RPLECB                                                   01263000
RPLWAIT  EQU   RPLECB                                                   01264000
RPLPLHPT EQU   RPLCOMN+4                                                01265000
RPLLEN2  EQU   RPLLEN                                                   01266000
RPLSTYP  EQU   RPLIDWD+1                                                01267000
RPLID    EQU   RPLIDWD                                                  01268000
AMDATA   EQU   IDADATA                                                  01269000
RDFEMPTY EQU   RDFRBYTE                                                 01270000
RDFTYPE  EQU   RDFRBYTE                                                 01271000
PLHERRET EQU   IDAPLH+276                                               01272000
PLHASCB  EQU   IDAPLH+272                                               01273000
PLHECB   EQU   IDAPLH+268                                               01274000
@NM00056 EQU   IDAPLH+265                                               01275000
PLHDRMSK EQU   IDAPLH+264                                               01276000
PLHR13   EQU   IDAPLH+260                                               01277000
PLHPARM1 EQU   IDAPLH+256                                               01278000
PLHDRRSC EQU   IDAPLH+252                                               01279000
PLHSLRBA EQU   IDAPLH+244                                               01280000
PLHSRCSG EQU   IDAPLH+242                                               01281000
PLHNOSEG EQU   IDAPLH+240                                               01282000
PLHLLOR  EQU   IDAPLH+236                                               01283000
PLHXPLH  EQU   PLHWAX                                                   01284000
@NM00055 EQU   PLHIXSPL+8                                               01285000
PLHIXBFC EQU   PLHIXSPL+4                                               01286000
PLHHIREC EQU   PLHSSRBA                                                 01287000
PLHISPLP EQU   IDAPLH+196                                               01288000
PLHRBUFC EQU   IDAPLH+192                                               01289000
PLHNRBA  EQU   IDAPLH+184                                               01290000
PLHDDDD  EQU   PLHEOVPT                                                 01291000
PLHAR14  EQU   IDAPLH+176                                               01292000
@NM00054 EQU   IDAPLH+172                                               01293000
@NM00053 EQU   IDAPLH+168                                               01294000
PLHASAVE EQU   IDAPLH+164                                               01295000
PLHRETOS EQU   IDAPLH+118                                               01296000
PLHCHAIN EQU   IDAPLH+112                                               01297000
PLHAMB   EQU   IDAPLH+108                                               01298000
PLHSAVE6 EQU   IDAPLH+104                                               01299000
PLHSAVE5 EQU   IDAPLH+100                                               01300000
PLHSAVE4 EQU   IDAPLH+96                                                01301000
PLHSAVE3 EQU   IDAPLH+92                                                01302000
PLHSAVE2 EQU   IDAPLH+88                                                01303000
PLHSAVE1 EQU   IDAPLH+84                                                01304000
PLHARET  EQU   IDAPLH+80                                                01305000
PLHIIOB  EQU   PLHDIOB                                                  01306000
PLHSRSID EQU   IDAPLH+74                                                01307000
PLHNBUFC EQU   IDAPLH+56                                                01308000
PLHARDB  EQU   IDAPLH+44                                                01309000
@NM00052 EQU   IDAPLH+43                                                01310000
PLHEOVR  EQU   IDAPLH+42                                                01311000
PLHRCODE EQU   IDAPLH+41                                                01312000
PLHUCODE EQU   PLHJCODE                                                 01313000
PLHJNRBA EQU   IDAPLH+36                                                01314000
PLHJRNLL EQU   IDAPLH+32                                                01315000
PLHUPECB EQU   PLHJORBA                                                 01316000
PLHDSIDA EQU   IDAPLH+24                                                01317000
PLHCRPL  EQU   IDAPLH+20                                                01318000
PLHMRPL  EQU   IDAPLH+16                                                01319000
PLHBFRNO EQU   IDAPLH+15                                                01320000
PLHFRCNT EQU   IDAPLH+14                                                01321000
PLHRMIN  EQU   IDAPLH+13                                                01322000
PLHDSTYP EQU   IDAPLH+12                                                01323000
PLHACB   EQU   IDAPLH+8                                                 01324000
PLHRAE   EQU   PLHAFLGS                                                 01325000
PLHRABWD EQU   PLHAFLGS                                                 01326000
PLHIOSID EQU   PLHAFLGS                                                 01327000
PLHVAMB  EQU   PLHAFLGS                                                 01328000
PLHIOSRQ EQU   PLHAFLGS                                                 01329000
PLHDRLM  EQU   PLHAFLGS                                                 01330000
PLHEOVDF EQU   PLHFLG3                                                  01331000
PLHRVRS  EQU   PLHFLG3                                                  01332000
PLHBWD   EQU   PLHFLG3                                                  01333000
PLHSLVLD EQU   PLHFLG3                                                  01334000
PLHRAHD  EQU   PLHFLG3                                                  01335000
PLHSRBSG EQU   PLHFLG3                                                  01336000
@NM00051 EQU   PLHEFLGS+1                                               01337000
PLHRSTRT EQU   PLHEFLGS+1                                               01338000
PLHDSCAN EQU   PLHEFLGS                                                 01339000
PLHINVAL EQU   PLHEFLGS                                                 01340000
PLHEODX  EQU   PLHEFLGS                                                 01341000
PLHSRINV EQU   PLHEFLGS                                                 01342000
PLH1ST   EQU   PLHEFLGS                                                 01343000
PLHNOSPC EQU   PLHEFLGS                                                 01344000
PLHIWAIT EQU   PLHFLG2                                                  01345000
PLHSVADV EQU   PLHFLG2                                                  01346000
PLHCIINS EQU   PLHFLG2                                                  01347000
PLHKRE   EQU   PLHFLG2                                                  01348000
PLHADDTE EQU   PLHFLG2                                                  01349000
PLHKEYMD EQU   PLHFLG2                                                  01350000
PLHSQINS EQU   PLHFLG2                                                  01351000
PLHUPD   EQU   PLHFLG2                                                  01352000
@NM00050 EQU   PLHFLG1                                                  01353000
PLHDRPND EQU   PLHFLG1                                                  01354000
PLHASYRQ EQU   PLHFLG1                                                  01355000
PLHSSR   EQU   PLHFLG1                                                  01356000
PLHASKBF EQU   PLHFLG1                                                  01357000
PLHENDRQ EQU   PLHFLG1                                                  01358000
PLHEOVW  EQU   PLHFLG1                                                  01359000
PLHATV   EQU   IDAPLH+1                                                 01360000
PLHAVL   EQU   IDAPLH                                                   01361000
PLHIOSDQ EQU   IDAPLHDR+12                                              01362000
PLHDRCUR EQU   IDAPLHDR+10                                              01363000
PLHDRMAX EQU   IDAPLHDR+8                                               01364000
PLHDRREQ EQU   IDAPLHDR+4                                               01365000
PLHELTH  EQU   IDAPLHDR+2                                               01366000
PLHCNT   EQU   IDAPLHDR+1                                               01367000
PLHID    EQU   IDAPLHDR                                                 01368000
IXSLEP   EQU   IDAIXSPL+28                                              01369000
IXSSEP   EQU   IDAIXSPL+24                                              01370000
IXSPEC   EQU   IDAIXSPL+19                                              01371000
IXSEKON  EQU   IDAIXSPL+18                                              01372000
@NM00049 EQU   IXSBFLG                                                  01373000
IXSLELV  EQU   IXSBFLG                                                  01374000
IXSSSRH  EQU   IXSBFLG                                                  01375000
IXSNOSR  EQU   IDAIXSPL+16                                              01376000
IXSKLEN  EQU   IDAIXSPL+14                                              01377000
IXSILN   EQU   IDAIXSPL+13                                              01378000
IXSTLN   EQU   IDAIXSPL+12                                              01379000
IXSARG   EQU   IDAIXSPL+8                                               01380000
IXSBUFC  EQU   IDAIXSPL+4                                               01381000
IXSSTRBA EQU   IDAIXSPL                                                 01382000
IXKEY    EQU   IDAIXK                                                   01383000
IXSELL   EQU   IDASELL                                                  01384000
IBFLP1   EQU   IBFLP2                                                   01385000
IBFLPL   EQU   IDAIBFLP+1                                               01386000
IBFLPF   EQU   IDAIBFLP                                                 01387000
IXHSEO   EQU   IDAIXH+22                                                01388000
IXHLEO   EQU   IDAIXH+20                                                01389000
IXHFSO   EQU   IDAIXH+18                                                01390000
IXHFLGS  EQU   IDAIXH+17                                                01391000
IXHLV    EQU   IDAIXH+16                                                01392000
IXHXX    EQU   IDAIXH+12                                                01393000
IXHHP    EQU   IDAIXH+8                                                 01394000
IXHFLPLN EQU   IDAIXH+2                                                 01395000
IXHLL    EQU   IDAIXH                                                   01396000
IMWKEY1  EQU   IDAIMWA+76                                               01397000
@NM00048 EQU   IDAIMWA+72                                               01398000
IMWNSOFF EQU   IDAIMWA+70                                               01399000
IMWCIMVN EQU   IDAIMWA+68                                               01400000
@NM00047 EQU   IDAIMWA+67                                               01401000
IMWSVIEL EQU   IDAIMWA+66                                               01402000
IMWIEL   EQU   IDAIMWA+65                                               01403000
IMWFGAIN EQU   IDAIMWA+64                                               01404000
IMWBUFP  EQU   IDAIMWA+60                                               01405000
IMWLBUFC EQU   IDAIMWA+56                                               01406000
IMWIPTR  EQU   IDAIMWA+52                                               01407000
IMWXPTR  EQU   IDAIMWA+48                                               01408000
IMWIKEYP EQU   IDAIMWA+44                                               01409000
IMWXKEYP EQU   IDAIMWA+40                                               01410000
IMWIXSP  EQU   IDAIMWA+4                                                01411000
IMWLEN   EQU   IDAIMWA+2                                                01412000
IMWBSE   EQU   IMWFLAGS                                                 01413000
IMWRIPL  EQU   IMWFLAGS                                                 01414000
IMWNEWHL EQU   IMWFLAGS                                                 01415000
IMWID    EQU   IDAIMWA                                                  01416000
ICWKEY1  EQU   IDAICWA+60                                               01417000
ICWCERP  EQU   IDAICWA+59                                               01418000
ICWCEL   EQU   IDAICWA+58                                               01419000
ICWCEF   EQU   IDAICWA+57                                               01420000
ICWCER   EQU   IDAICWA+56                                               01421000
ICWPTL   EQU   IDAICWA+55                                               01422000
ICWREQ   EQU   IDAICWA+54                                               01423000
ICWCRSEG EQU   IDAICWA+52                                               01424000
ICWNOSEG EQU   IDAICWA+50                                               01425000
ICWNEST  EQU   IDAICWA+48                                               01426000
ICWKEY3L EQU   IDAICWA+46                                               01427000
ICWKEY2L EQU   IDAICWA+44                                               01428000
ICWKEY1L EQU   IDAICWA+42                                               01429000
ICWLN    EQU   IDAICWA+40                                               01430000
ICWARDBP EQU   IDAICWA+36                                               01431000
ICWTPTR  EQU   IDAICWA+32                                               01432000
ICWTBASE EQU   IDAICWA+28                                               01433000
ICWADD   EQU   IDAICWA+24                                               01434000
ICWSCNT  EQU   IDAICWA+22                                               01435000
ICWPSEO  EQU   IDAICWA+20                                               01436000
ICWPRBA  EQU   IDAICWA+16                                               01437000
ICWCRBA  EQU   IDAICWA+12                                               01438000
ICWBUFC  EQU   IDAICWA+8                                                01439000
ICWLEN   EQU   IDAICWA+2                                                01440000
ICWENDRQ EQU   ICWFLG1                                                  01441000
ICWSPLIT EQU   ICWFLG1                                                  01442000
ICWKRDS  EQU   ICWFLG1                                                  01443000
ICWVNE   EQU   ICWFLG1                                                  01444000
ICWVSE   EQU   ICWFLG1                                                  01445000
ICWRBAOK EQU   ICWFLG1                                                  01446000
ICWWAGM  EQU   ICWFLG1                                                  01447000
ICWWNF   EQU   ICWFLG1                                                  01448000
ICWID    EQU   IDAICWA                                                  01449000
@NM00046 EQU   IDADIWA+92                                               01450000
@NM00045 EQU   IDADIWA+88                                               01451000
@NM00044 EQU   IDADIWA+84                                               01452000
@NM00043 EQU   IDADIWA+80                                               01453000
@NM00042 EQU   IDADIWA+76                                               01454000
@NM00041 EQU   IDADIWA+72                                               01455000
@NM00040 EQU   IDADIWA+68                                               01456000
@NM00039 EQU   IDADIWA+64                                               01457000
@NM00038 EQU   IDADIWA+60                                               01458000
@NM00037 EQU   IDADIWA+56                                               01459000
DIWINRBA EQU   IDADIWA+52                                               01460000
DIWRKCT  EQU   IDADIWA+48                                               01461000
DIWSAVE5 EQU   DIWSAVE+16                                               01462000
DIWSAVE4 EQU   DIWSAVE+12                                               01463000
DIWSPLTP EQU   IDADIWA+24                                               01464000
DIWBUFC  EQU   IDADIWA+20                                               01465000
DIWHRBA  EQU   IDADIWA+12                                               01466000
DIWLRBA  EQU   IDADIWA+8                                                01467000
@NM00036 EQU   IDADIWA+6                                                01468000
DIWFSPF  EQU   DIWFLG2                                                  01469000
DIW1ST   EQU   DIWFLG1                                                  01470000
DIWNOT1  EQU   DIWFLG1                                                  01471000
DIWSHIFT EQU   DIWFLG1                                                  01472000
DIWGSPC  EQU   DIWFLG1                                                  01473000
DIWEOKR  EQU   DIWFLG1                                                  01474000
DIWPFERR EQU   DIWFLG1                                                  01475000
DIWCISPL EQU   DIWFLG1                                                  01476000
DIWCAS   EQU   DIWFLG1                                                  01477000
DIWLEN   EQU   IDADIWA+2                                                01478000
DIWID    EQU   IDADIWA                                                  01479000
@NM00035 EQU   CIDFLL                                                   01480000
BUFCEND  EQU   IDABUFC+64                                               01481000
BUFCUCDN EQU   IDABUFC+60                                               01482000
BUFCUCUP EQU   IDABUFC+56                                               01483000
BUFCMDBT EQU   IDABUFC+52                                               01484000
BUFCHAIN EQU   IDABUFC+48                                               01485000
BUFXORBA EQU   IDABUFC+44                                               01486000
BUFXIRBA EQU   IDABUFC+40                                               01487000
BUFCNXT2 EQU   IDABUFC+37                                               01488000
BUFCIDXL EQU   IDABUFC+36                                               01489000
BUFCDSPC EQU   IDABUFC+32                                               01490000
BUFCWLEN EQU   BUFCINV                                                  01491000
BUFCNXT1 EQU   IDABUFC+24                                               01492000
BUFCCPA  EQU   IDABUFC+16                                               01493000
BUFCAMB  EQU   BUFCPLH                                                  01494000
@NM00034 EQU   BUFCFLG2                                                 01495000
BUFCEOD  EQU   BUFCFLG2                                                 01496000
BUFCBSYW EQU   BUFCFLG2                                                 01497000
BUFCBSYR EQU   BUFCFLG2                                                 01498000
BUFCNLAS EQU   BUFCFLG2                                                 01499000
BUFCXDDR EQU   BUFCFLG2                                                 01500000
BUFCFIX  EQU   BUFCIOFL                                                 01501000
BUFCPFCP EQU   BUFCIOFL                                                 01502000
BUFCXEDB EQU   BUFCIOFL                                                 01503000
BUFCWC   EQU   BUFCIOFL                                                 01504000
BUFCREAL EQU   BUFCIOFL                                                 01505000
BUFCRRD  EQU   BUFCIOFL                                                 01506000
BUFCFMT  EQU   BUFCIOFL                                                 01507000
BUFCEPT  EQU   BUFCFLG1                                                 01508000
BUFCER2  EQU   BUFCFLG1                                                 01509000
BUFCER1  EQU   BUFCFLG1                                                 01510000
BUFCINS  EQU   BUFCFLG1                                                 01511000
BUFCSEG  EQU   BUFCFLG1                                                 01512000
BUFCUPG  EQU   BUFCFLG1                                                 01513000
@NM00033 EQU   IDABUFDR+16                                              01514000
BUFDBUFC EQU   IDABUFDR+12                                              01515000
@NM00032 EQU   BUFDRFLG                                                 01516000
BUFDRAVL EQU   BUFDRFLG                                                 01517000
BUFDRREL EQU   BUFDRFLG                                                 01518000
BUFDRTSB EQU   IDABUFDR+10                                              01519000
BUFDRMAX EQU   BUFDRCIX                                                 01520000
BUFDRPFN EQU   IDABUFDR+8                                               01521000
BUFDRPFB EQU   IDABUFDR+4                                               01522000
BUFDRLEN EQU   IDABUFDR+2                                               01523000
BUFDRNO  EQU   IDABUFDR+1                                               01524000
BUFDRID  EQU   IDABUFDR                                                 01525000
AMDEXCP  EQU   AMDSTAT+44                                               01526000
AMDNCAS  EQU   AMDSTAT+40                                               01527000
AMDNCIS  EQU   AMDSTAT+36                                               01528000
AMDASPA  EQU   AMDSTAT+32                                               01529000
AMDRETR  EQU   AMDSTAT+28                                               01530000
AMDUPR   EQU   AMDSTAT+24                                               01531000
AMDIREC  EQU   AMDSTAT+20                                               01532000
AMDDELR  EQU   AMDSTAT+16                                               01533000
AMDNLR   EQU   AMDSTAT+12                                               01534000
AMDNEXT  EQU   AMDSTAT+10                                               01535000
AMDNIL   EQU   AMDSTAT+8                                                01536000
AMDSTSP  EQU   AMDSTAT                                                  01537000
@NM00031 EQU   IDAAMDSB+41                                              01538000
@NM00030 EQU   AMDATTR3                                                 01539000
AMDLM    EQU   AMDATTR3                                                 01540000
AMDWAIT  EQU   AMDATTR3                                                 01541000
AMDBIND  EQU   AMDATTR3                                                 01542000
AMDFAULT EQU   AMDATTR3                                                 01543000
AMDUNQ   EQU   AMDATTR3                                                 01544000
AMDPARDB EQU   IDAAMDSB+36                                              01545000
AMDMAXRR EQU   AMDSSRBA                                                 01546000
AMDNSLOT EQU   AMDHLRBA                                                 01547000
AMDLRECL EQU   IDAAMDSB+24                                              01548000
AMDFSCI  EQU   IDAAMDSB+16                                              01549000
AMDFSCA  EQU   IDAAMDSB+14                                              01550000
AMDCIPCA EQU   IDAAMDSB+12                                              01551000
AMDPCTCI EQU   IDAAMDSB+11                                              01552000
AMDPCTCA EQU   IDAAMDSB+10                                              01553000
AMDAXRKP EQU   AMDNEST                                                  01554000
AMDLEN   EQU   IDAAMDSB+2                                               01555000
AMDSPAN  EQU   AMDATTR                                                  01556000
AMDRRDS  EQU   AMDATTR                                                  01557000
AMDRANGE EQU   AMDATTR                                                  01558000
AMDORDER EQU   AMDATTR                                                  01559000
AMDREPL  EQU   AMDATTR                                                  01560000
AMDSDT   EQU   AMDATTR                                                  01561000
AMDWCK   EQU   AMDATTR                                                  01562000
AMDDST   EQU   AMDATTR                                                  01563000
AMDSBID  EQU   IDAAMDSB                                                 01564000
AMBLCMB  EQU   IDAAMBL+64                                               01565000
AMBLBIB  EQU   IDAAMBL+60                                               01566000
AMBLMIDS EQU   IDAAMBL+42                                               01567000
AMBLNIDS EQU   IDAAMBL+41                                               01568000
@NM00029 EQU   IDAAMBL+40                                               01569000
AMBLNUM  EQU   IDAAMBL+38                                               01570000
AMBLNST  EQU   IDAAMBL+37                                               01571000
@NM00028 EQU   AMBLFLG2                                                 01572000
AMBLSTAG EQU   AMBLFLG2                                                 01573000
@NM00027 EQU   AMBLFLG2                                                 01574000
AMBLDUMY EQU   AMBLFLG1                                                 01575000
AMBLCAT  EQU   AMBLFLG1                                                 01576000
AMBLUCRA EQU   AMBLFLG1                                                 01577000
AMBLSCRA EQU   AMBLFLG1                                                 01578000
AMBLVVIC EQU   AMBLFLG1                                                 01579000
AMBLUPD  EQU   AMBLFLG1                                                 01580000
AMBLCINV EQU   AMBLFLG1                                                 01581000
AMBLFULL EQU   AMBLFLG1                                                 01582000
AMBLLEN  EQU   IDAAMBL+34                                               01583000
@NM00026 EQU   AMBLSHAR                                                 01584000
AMBLCATO EQU   AMBLSHAR                                                 01585000
AMBLPRIM EQU   AMBLSHAR                                                 01586000
AMBLID   EQU   IDAAMBL+32                                               01587000
@NM00025 EQU   IDAAMBL+31                                               01588000
@NM00024 EQU   AMBLTYPE                                                 01589000
AMBLFIX  EQU   AMBLTYPE                                                 01590000
AMBLBASE EQU   AMBLTYPE                                                 01591000
AMBLAIX  EQU   AMBLTYPE                                                 01592000
AMBLUPGR EQU   AMBLTYPE                                                 01593000
AMBLPATH EQU   AMBLTYPE                                                 01594000
AMBLENO  EQU   AMBLVC+1                                                 01595000
AMBLVRT  EQU   AMBLVC                                                   01596000
AMBLXPT  EQU   IDAAMBL+24                                               01597000
AMBLDFR  EQU   AMBLQ                                                    01598000
AMBLESDS EQU   AMBLQ                                                    01599000
AMBLKSDS EQU   AMBLQ                                                    01600000
AMBLUBF  EQU   AMBLQ                                                    01601000
AMBLFSTP EQU   AMBLQ                                                    01602000
AMBLLSR  EQU   AMBLQ                                                    01603000
AMBLGSR  EQU   AMBLQ                                                    01604000
AMBLDDC  EQU   AMBLQ                                                    01605000
AMBLDCI  EQU   AMBLIDF+4                                                01606000
AMBLCACB EQU   AMBLIDF                                                  01607000
@NM00023 EQU   AMBLEOV+2                                                01608000
AMBLCOMP EQU   AMBLEOV+1                                                01609000
AMBLESET EQU   AMBLEFLG                                                 01610000
AMBLWAIT EQU   AMBLEFLG                                                 01611000
AMBLACB  EQU   IDAAMBL+8                                                01612000
AMBLSCHN EQU   IDAAMBL+4                                                01613000
AMBLPCHN EQU   IDAAMBL                                                  01614000
AMBTRACE EQU   IDAAMB+120                                               01615000
AMBVIOT  EQU   IDAAMB+116                                               01616000
AMBSZCP  EQU   IDAAMB+114                                               01617000
AMBSZFW  EQU   IDAAMB+112                                               01618000
AMBSZWR  EQU   IDAAMB+110                                               01619000
AMBSZRD  EQU   IDAAMB+108                                               01620000
AMBEXEX  EQU   IDAAMB+100                                               01621000
AMBWSHD  EQU   IDAAMB+96                                                01622000
AMBCPA   EQU   IDAAMB+92                                                01623000
AMBBM2SH EQU   IDAAMB+88                                                01624000
AMBRDCNT EQU   AMBCSWD1+2                                               01625000
@NM00022 EQU   AMBCSWD1+1                                               01626000
@NM00021 EQU   AMBAFLG                                                  01627000
AMBCFX   EQU   AMBAFLG                                                  01628000
AMBSIS   EQU   AMBAFLG                                                  01629000
AMBDFR   EQU   AMBAFLG                                                  01630000
AMBICI   EQU   AMBAFLG                                                  01631000
AMBGSR   EQU   AMBAFLG                                                  01632000
AMBLSR   EQU   AMBAFLG                                                  01633000
@NM00020 EQU   AMBAFLG                                                  01634000
AMBUPLH  EQU   IDAAMB+80                                                01635000
AMBPAMBL EQU   IDAAMB+76                                                01636000
AMBPIXP  EQU   IDAAMB+72                                                01637000
@NM00019 EQU   IDAAMB+68                                                01638000
AMBWKA   EQU   IDAAMB+60                                                01639000
AMBAMBXN EQU   AMBEOVPT                                                 01640000
AMBEDB   EQU   IDAAMB+52                                                01641000
AMBRPT   EQU   IDAAMB+50                                                01642000
AMBPUG   EQU   AMBFLG2                                                  01643000
AMBBUSY  EQU   AMBOFLGS                                                 01644000
AMBEXFG  EQU   AMBOFLGS                                                 01645000
@NM00018 EQU   AMBOFLGS                                                 01646000
AMBOPEN  EQU   AMBOFLGS                                                 01647000
@NM00017 EQU   AMBOFLGS                                                 01648000
AMBDEBAD EQU   AMBDEBPT+1                                               01649000
AMBIFLGS EQU   AMBDEBPT                                                 01650000
AMBAMETH EQU   IDAAMB+43                                                01651000
AMBUPX   EQU   AMBINFL                                                  01652000
AMBUCRA  EQU   AMBINFL                                                  01653000
AMBSCRA  EQU   AMBINFL                                                  01654000
AMBCAT   EQU   AMBINFL                                                  01655000
@NM00016 EQU   AMBINFL                                                  01656000
@NM00015 EQU   AMBINFL                                                  01657000
AMBTIOT  EQU   IDAAMB+40                                                01658000
@NM00014 EQU   IDAAMB+38                                                01659000
AMBDDSN  EQU   IDAAMB+35                                                01660000
AMBCDSN  EQU   IDAAMB+32                                                01661000
AMBIOMB  EQU   AMBIOBAD                                                 01662000
@NM00013 EQU   AMBDSORG+1                                               01663000
AMBDORGA EQU   AMBDSORG+1                                               01664000
@NM00012 EQU   AMBDSORG                                                 01665000
AMBINBUF EQU   AMBFLG1                                                  01666000
AMBJRN   EQU   AMBFLG1                                                  01667000
AMBUBF   EQU   AMBFLG1                                                  01668000
AMBSPEED EQU   AMBFLG1                                                  01669000
AMBPCAT  EQU   AMBFLG1                                                  01670000
AMBMCAT  EQU   AMBFLG1                                                  01671000
AMBTYPE  EQU   AMBFLG1                                                  01672000
AMBCREAT EQU   AMBFLG1                                                  01673000
@NM00011 EQU   AMBFLG0                                                  01674000
AMBPSDS  EQU   AMBFLG0                                                  01675000
AMBCACB  EQU   IDAAMB+16                                                01676000
AMBPH    EQU   IDAAMB+12                                                01677000
AMBBUFC  EQU   IDAAMB+8                                                 01678000
AMBLINK  EQU   IDAAMB+4                                                 01679000
AMBLEN   EQU   IDAAMB+2                                                 01680000
AMBRSC   EQU   IDAAMB+1                                                 01681000
AMBID    EQU   IDAAMB                                                   01682000
ACBAPID  EQU   ACBCOMN+72                                               01683000
ACBCBMWA EQU   ACBCOMN+68                                               01684000
ACBUAPTR EQU   ACBCOMN+64                                               01685000
ACBLRECL EQU   ACBCOMN+62                                               01686000
ACBMSGLN EQU   ACBBLKSZ                                                 01687000
ACBBUFSP EQU   ACBCOMN+56                                               01688000
@NM00010 EQU   ACBUJFCB+1                                               01689000
ACBOPTN  EQU   ACBUJFCB                                                 01690000
ACBVVIC  EQU   ACBINFLG                                                 01691000
ACBUCRA  EQU   ACBINFLG                                                 01692000
ACBSCRA  EQU   ACBINFLG                                                 01693000
ACBCAT   EQU   ACBINFLG                                                 01694000
ACBIJRQE EQU   ACBINFLG                                                 01695000
ACBJEPS  EQU   ACBINFLG                                                 01696000
@NM00009 EQU   ACBINFLG                                                 01697000
ACBERFLG EQU   ACBCOMN+49                                               01698000
ACBBUSY  EQU   ACBIOSFG                                                 01699000
ACBLOCK  EQU   ACBEXFG                                                  01700000
@NM00008 EQU   ACBOFLGS                                                 01701000
ACBDSERR EQU   ACBOFLGS                                                 01702000
ACBOPEN  EQU   ACBOFLGS                                                 01703000
ACBEOV   EQU   ACBOFLGS                                                 01704000
@NM00007 EQU   ACBOFLGS                                                 01705000
ACBDEB   EQU   ACBDDNM+5                                                01706000
ACBERFL  EQU   ACBDDNM+4                                                01707000
ACBAM    EQU   ACBAMETH                                                 01708000
ACBINFL  EQU   ACBDDNM+2                                                01709000
ACBTIOT  EQU   ACBDDNM                                                  01710000
ACBUEL   EQU   ACBEXLST                                                 01711000
ACBPASSW EQU   ACBCOMN+32                                               01712000
ACBMSGAR EQU   ACBCOMN+28                                               01713000
@NM00006 EQU   ACBDSORG+1                                               01714000
ACBDORGA EQU   ACBDSORG+1                                               01715000
@NM00005 EQU   ACBDSORG                                                 01716000
ACBCRNRE EQU   ACBCROPS                                                 01717000
ACBCRNCK EQU   ACBCROPS                                                 01718000
ACBASA   EQU   ACBCCTYP                                                 01719000
@NM00004 EQU   ACBCCTYP                                                 01720000
ACBRECAF EQU   ACBRECFM                                                 01721000
ACBJBUF  EQU   ACBBUFPL+2                                               01722000
ACBMACR4 EQU   ACBBUFPL+1                                               01723000
@NM00003 EQU   ACBMACR3                                                 01724000
ACBNCFX  EQU   ACBMACR3                                                 01725000
ACBSIS   EQU   ACBMACR3                                                 01726000
ACBDFR   EQU   ACBMACR3                                                 01727000
ACBICI   EQU   ACBMACR3                                                 01728000
ACBGSR   EQU   ACBMACR3                                                 01729000
ACBLSR   EQU   ACBMACR3                                                 01730000
@NM00002 EQU   ACBMACR3                                                 01731000
ACBBUFNI EQU   ACBCOMN+18                                               01732000
ACBBUFND EQU   ACBCOMN+16                                               01733000
ACBSTRNO EQU   ACBCOMN+15                                               01734000
ACBBSTNO EQU   ACBCOMN+14                                               01735000
ACBAIX   EQU   ACBMACR2                                                 01736000
ACBDSN   EQU   ACBMACR2                                                 01737000
ACBRST   EQU   ACBMACR2                                                 01738000
ACBLOGON EQU   ACBMACR2                                                 01739000
ACBSKP   EQU   ACBMACR2                                                 01740000
@NM00001 EQU   ACBMACR2                                                 01741000
ACBUBF   EQU   ACBMACR1                                                 01742000
ACBOUT   EQU   ACBMACR1                                                 01743000
ACBIN    EQU   ACBMACR1                                                 01744000
ACBDIR   EQU   ACBMACR1                                                 01745000
ACBSEQ   EQU   ACBMACR1                                                 01746000
ACBBLK   EQU   ACBCNV                                                   01747000
ACBADD   EQU   ACBADR                                                   01748000
ACBKEY   EQU   ACBMACR1                                                 01749000
ACBINRTN EQU   ACBCOMN+8                                                01750000
ACBIBCT  EQU   ACBJWA                                                   01751000
ACBLEN2  EQU   ACBLENG2                                                 01752000
ACBSTYP  EQU   ACBCOMN+1                                                01753000
ACBID    EQU   ACBCOMN                                                  01754000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01755000
@RF00208 EQU   @RC00204                                                 01756000
@RF00310 EQU   @RC00305                                                 01757000
@RC00341 EQU   @EL00004                                                 01758000
@PB00005 EQU   @PB00006                                                 01759000
@PB00004 EQU   @PB00005                                                 01760000
@PB00003 EQU   @PB00004                                                 01761000
@PB00002 EQU   @PB00003                                                 01762000
@ENDDATA EQU   *                                                        01763000
         END   IDA019S6,(C'PLS2232',0701,78172)                         01764000
