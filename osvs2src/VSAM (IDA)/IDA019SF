         TITLE 'IDA019SF--CONTROL AREA SPLIT SPANNED RECORD            *00001000
                        '                                               00002000
IDA019SF CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IDA019SF  78.172'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
         IDASVR14                                                       00013000
*   RAMB=AMBLDTA;                   /* POINT TO DATA AMB.            */ 00014000
         L     @10,RPLDACB(,RRPL)                                  0169 00015000
         L     @10,ACBAMBL(,@10)                                   0169 00016000
         L     RAMB,AMBLDTA(,@10)                                  0169 00017000
*   DIW1ST=OFF;                     /* CLEAR BEG OF SEQ SET FLAG.    */ 00018000
         L     @10,AMBIWA(,RAMB)                                   0170 00019000
         NI    DIW1ST(@10),B'11111110'                             0170 00020000
*   DIWFSPF=OFF;                    /* CLEAR NO SPLIT FLAG.          */ 00021000
         NI    DIWFSPF(@10),B'01111111'                            0171 00022000
*   RBUFC=PLHIBUFC;                 /* POINT TO IX BUFC OF CUR SEQ 0172 00023000
*                                      SET.                          */ 00024000
         L     RBUFC,PLHIBUFC(,RPLH)                               0172 00025000
*   RPARM1=IXHPTLS;                 /* GET RBA PTR MASK.             */ 00026000
         L     @10,BUFCBAD(,RBUFC)                                 0173 00027000
         SLR   RPARM1,RPARM1                                       0173 00028000
         IC    RPARM1,IXHPTLS(,@10)                                0173 00029000
*   RWORK2=BUFCBAD+IXHLL-IXHFLPLN;  /* POINT TO 1ST SEG ENTRY OF SR     00030000
*                                      ENTRY.                        */ 00031000
         LH    RWORK2,IXHLL(,@10)                                  0174 00032000
         N     RWORK2,@CF01121                                     0174 00033000
         ALR   RWORK2,@10                                          0174 00034000
         SLR   @05,@05                                             0174 00035000
         IC    @05,IXHFLPLN(,@10)                                  0174 00036000
         SLR   RWORK2,@05                                          0174 00037000
*   GEN(EX RPARM1,ICMINS);          /* GET DATA RBA MULTIPLIER.      */ 00038000
         EX RPARM1,ICMINS                                               00039000
*   RPARM1=RPARM1*AMDCINV+IXHBRBA;  /* GET DATA CI RBA.              */ 00040000
         L     @10,AMBDSB(,RAMB)                                   0176 00041000
         LR    @15,RPARM1                                          0176 00042000
         M     @14,AMDCINV(,@10)                                   0176 00043000
         L     @10,BUFCBAD(,RBUFC)                                 0176 00044000
         AL    @15,IXHBRBA(,@10)                                   0176 00045000
         LR    RPARM1,@15                                          0176 00046000
*I01:                                                              0177 00047000
*   DO;                             /* IDACALL(IDAGRB)               */ 00048000
I01      DS    0H                                                  0178 00049000
*     CALL IDAGRB;                  /* EXIT TO IDAGRB                */ 00050000
         L     @15,@CV01043                                        0178 00051000
         BALR  @14,@15                                             0178 00052000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00053000
         BALR @11,0                                                     00054000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00055000
         USING *,@11                                                    00056000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00057000
         L     @11,=A(@PSTART)                                          00058000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00059000
         USING @PSTART,@11                                              00060000
*   END I01;                        /* GET DATA IP BFR-1ST SEG.      */ 00061000
*   IF RPLERREG^='00'X THEN         /* ERROR.                        */ 00062000
         CLI   RPLERREG(RRPL),0                                    0184 00063000
         BNE   @RT00184                                            0184 00064000
*     GOTO SFEXIT;                  /* RETURN.                       */ 00065000
*   RAMB=AMBLIX;                    /* POINT TO IX AMB.              */ 00066000
         L     @10,RPLDACB(,RRPL)                                  0186 00067000
         L     @10,ACBAMBL(,@10)                                   0186 00068000
         L     RAMB,AMBLIX(,@10)                                   0186 00069000
*   RBUFC=PLHIBUFC;                 /* POINT TO INDEX BUFC.          */ 00070000
         L     RBUFC,PLHIBUFC(,RPLH)                               0187 00071000
*   ICWCRBA=BUFCDDDD;               /* SAVE RBA OF CUR. SEQ SET REC-    00072000
*                                      WILL BE IN ICWPRBA AFTER CALL    00073000
*                                      IDANEWRD.                     */ 00074000
         L     @10,AMBIWA(,RAMB)                                   0188 00075000
         L     @05,BUFCDDDD(,RBUFC)                                0188 00076000
         ST    @05,ICWCRBA(,@10)                                   0188 00077000
*   ICWTPTR=IXHHP;                  /* SAVE HORIZ PTR OF CUR. SEQ SET   00078000
*                                      RECORD.                       */ 00079000
         L     @05,BUFCBAD(,RBUFC)                                 0189 00080000
         L     @15,IXHHP(,@05)                                     0189 00081000
         ST    @15,ICWTPTR(,@10)                                   0189 00082000
*   RWORK2=BUFCBAD+IXHLEO;          /* POINT TO LAST ENTRY OF CUR. 0190 00083000
*                                      SEQ RECORD.                   */ 00084000
         LH    RWORK2,IXHLEO(,@05)                                 0190 00085000
         ALR   RWORK2,@05                                          0190 00086000
*   RWORK3=RWORK2->IBFLPL;          /* GET L BYTE.                   */ 00087000
         SLR   RWORK3,RWORK3                                       0191 00088000
         IC    RWORK3,IBFLPL(,RWORK2)                              0191 00089000
*   ICWKEY1L=RWORK3;                /* SAVE L BYTE.                  */ 00090000
         STH   RWORK3,ICWKEY1L(,@10)                               0192 00091000
*   RWORK4=RWORK2-RWORK3;           /* POINT TO START OF KEY         */ 00092000
         LR    RWORK4,RWORK2                                       0193 00093000
         SLR   RWORK4,RWORK3                                       0193 00094000
*   RWORK0=RWORK3;                  /* SAVE LENGTH                   */ 00095000
         LR    RWORK0,RWORK3                                       0194 00096000
*   RWORK2=ADDR(ICWKEY1);           /* SET 'TO' ADDRESS              */ 00097000
         LA    RWORK2,ICWKEY1(,@10)                                0195 00098000
*   RWORK5=RWORK3;                  /* SET MOVE LENGTH               */ 00099000
         LR    RWORK5,RWORK3                                       0196 00100000
*   GEN(MVCL RWORK2,RWORK4);        /* SAVE KEY OF ENTRY             */ 00101000
         MVCL RWORK2,RWORK4                                             00102000
*   RWORK3=AMDKEYLN-RWORK0;         /* PAD LENGTH.                   */ 00103000
         L     @10,AMBDSB(,RAMB)                                   0198 00104000
         LH    RWORK3,AMDKEYLN(,@10)                               0198 00105000
         SLR   RWORK3,RWORK0                                       0198 00106000
*   RWORK5='FF000000'X;             /* PAD CHAR.                     */ 00107000
         L     RWORK5,@CF01072                                     0199 00108000
*   GEN(MVCL RWORK2,RWORK4);        /* PAD KEY WITH F'S.             */ 00109000
         MVCL RWORK2,RWORK4                                             00110000
*   RWORK2=PLHKEYPT;                /* SET TO ADDRESS.               */ 00111000
         L     RWORK2,PLHKEYPT(,RPLH)                              0201 00112000
*   RWORK3=AMDKEYLN;                /* SET TO LENGTH.                */ 00113000
         L     @10,AMBDSB(,RAMB)                                   0202 00114000
         LH    RWORK3,AMDKEYLN(,@10)                               0202 00115000
*   RWORK5=RWORK3;                  /* SET FROM LENGTH.              */ 00116000
         LR    RWORK5,RWORK3                                       0203 00117000
*   IF ICWKEY1L=ZERO THEN           /* L=0, DUMMY ENTRY.             */ 00118000
         L     @10,AMBIWA(,RAMB)                                   0204 00119000
         LH    @10,ICWKEY1L(,@10)                                  0204 00120000
         LTR   @10,@10                                             0204 00121000
         BNZ   @RF00204                                            0204 00122000
*     RWORK4=ADDR(ARDKEYS)+RWORK3;  /* USE ARDB HI-KEY.              */ 00123000
         L     RWORK4,PLHARDB(,RPLH)                               0205 00124000
         LA    RWORK4,ARDKEYS(,RWORK4)                             0205 00125000
         ALR   RWORK4,RWORK3                                       0205 00126000
*   ELSE                            /* NOT DUMMY ENTRY.              */ 00127000
*     RWORK4=ADDR(ICWKEY1);         /* USE ICWKEY1 KEY.              */ 00128000
         B     @RC00204                                            0206 00129000
@RF00204 L     RWORK4,AMBIWA(,RAMB)                                0206 00130000
         LA    RWORK4,ICWKEY1(,RWORK4)                             0206 00131000
*   GEN(MVCL RWORK2,RWORK4);        /* PUT KEY IN PLH KEY.           */ 00132000
@RC00204 DS    0H                                                  0207 00133000
         MVCL RWORK2,RWORK4                                             00134000
*   RFY                                                            0208 00135000
*    (RWORK0,                                                      0208 00136000
*     RWORK2,                                                      0208 00137000
*     RWORK3,                                                      0208 00138000
*     RWORK4,                                                      0208 00139000
*     RWORK5) UNRSTD;               /* FREE REGS.                    */ 00140000
*   ICWLN=ONE;                      /* SET INDEX LEVEL NO.           */ 00141000
         L     @10,AMBIWA(,RAMB)                                   0209 00142000
         MVC   ICWLN(2,@10),@CH00047                               0209 00143000
*   ICWADD=ADDR(IDAICWA);           /* POINT TO CURRENT ICWA.        */ 00144000
         ST    @10,ICWADD(,@10)                                    0210 00145000
*   IF AMDRANGE=ON THEN             /* IF KEY RANGE DATA SET         */ 00146000
         L     @05,AMBDSB(,RAMB)                                   0211 00147000
         TM    AMDRANGE(@05),B'00000100'                           0211 00148000
         BNO   @RF00211                                            0211 00149000
*     ICWKRDS=ON;                   /* MARK WORK AREA                */ 00150000
         OI    ICWKRDS(@10),B'00000100'                            0212 00151000
*   RBUFC=PLHIBUFC;                 /* POINT TO INDEX BUFC.          */ 00152000
@RF00211 L     RBUFC,PLHIBUFC(,RPLH)                               0213 00153000
*I02:                                                              0214 00154000
*   DO;                             /* IDACALL(IDAFREEB)             */ 00155000
I02      DS    0H                                                  0215 00156000
*     CALL IDAFREEB;                /* EXIT TO IDAFREEB              */ 00157000
         L     @15,@CV01044                                        0215 00158000
         BALR  @14,@15                                             0215 00159000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00160000
         BALR @11,0                                                     00161000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00162000
         USING *,@11                                                    00163000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00164000
         L     @11,=A(@PSTART)                                          00165000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00166000
         USING @PSTART,@11                                              00167000
*   END I02;                        /* FREE INDEX BUFC.              */ 00168000
*I03:                                                              0221 00169000
*   DO;                             /* IDACALL(IDANEWRD)             */ 00170000
I03      DS    0H                                                  0222 00171000
*     CALL IDANEWRD;                /* EXIT TO IDANEWRD              */ 00172000
         L     @15,@CV01050                                        0222 00173000
         BALR  @14,@15                                             0222 00174000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00175000
         BALR @11,0                                                     00176000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00177000
         USING *,@11                                                    00178000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00179000
         L     @11,=A(@PSTART)                                          00180000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00181000
         USING @PSTART,@11                                              00182000
*   END I03;                        /* GET NEW INDEX RECRORD         */ 00183000
*   IF RPLERREG^='00'X THEN         /* ERROR.                        */ 00184000
         CLI   RPLERREG(RRPL),0                                    0228 00185000
         BNE   @RT00228                                            0228 00186000
*     GOTO SFEXIT;                  /* RETURN.                       */ 00187000
*   RFY                                                            0230 00188000
*     RWORK2 RSTD;                  /* GET WORK REG.                 */ 00189000
*   RWORK2=ADDR(IMWISWKA);          /* POINT TO INDEX WORK AREA.     */ 00190000
         L     @10,AMBIWA(,RAMB)                                   0231 00191000
         L     RWORK2,ICWCHN(,@10)                                 0231 00192000
         LA    RWORK2,IMWISWKA(,RWORK2)                            0231 00193000
*   RBUFC=RWORK2->IXSBUFC;          /* POINT TO NEW REC. BUFC.       */ 00194000
         L     RBUFC,IXSBUFC(,RWORK2)                              0232 00195000
*   RFY                                                            0233 00196000
*     RWORK2 UNRSTD;                /* FREE WORK REG.                */ 00197000
*   RPARM1=AMBLDTA->AMBDSB->AMDCIPCA;/* GET CI PER CA.               */ 00198000
         L     @05,RPLDACB(,RRPL)                                  0234 00199000
         L     @05,ACBAMBL(,@05)                                   0234 00200000
         L     @05,AMBLDTA(,@05)                                   0234 00201000
         L     @05,AMBDSB(,@05)                                    0234 00202000
         LH    RPARM1,AMDCIPCA(,@05)                               0234 00203000
*   IF RPARM1^>K256 THEN            /* CI/CA LTE 256.                */ 00204000
         C     RPARM1,@CF01041                                     0235 00205000
         BH    @RF00235                                            0235 00206000
*     DO;                           /*                               */ 00207000
*       ICWPTL=ONE;                 /* SET PTR LENGTH.               */ 00208000
         MVI   ICWPTL(@10),X'01'                                   0237 00209000
*       IXHPTLS='01'X;              /* SET PTR LENGTH MASK.          */ 00210000
         L     @10,BUFCBAD(,RBUFC)                                 0238 00211000
         MVI   IXHPTLS(@10),X'01'                                  0238 00212000
*     END;                          /*                               */ 00213000
*   ELSE                            /* CI/CA GT 256.                 */ 00214000
*     DO;                           /*                               */ 00215000
         B     @RC00235                                            0240 00216000
@RF00235 DS    0H                                                  0241 00217000
*       ICWPTL=TWO;                 /* SET PTR LENGTH.               */ 00218000
         L     @10,AMBIWA(,RAMB)                                   0241 00219000
         MVI   ICWPTL(@10),X'02'                                   0241 00220000
*       IXHPTLS='03'X;              /* SET PTR LENGTH MASK.          */ 00221000
         L     @10,BUFCBAD(,RBUFC)                                 0242 00222000
         MVI   IXHPTLS(@10),X'03'                                  0242 00223000
*     END;                          /*                               */ 00224000
*   IXHFLPLN=ICWPTL+LENGTH(IBFLPF)+LENGTH(IBFLPL);/* SET F,L,PTR   0244 00225000
*                                      TOTAL LENGTH.                 */ 00226000
@RC00235 L     @10,BUFCBAD(,RBUFC)                                 0244 00227000
         L     @05,AMBIWA(,RAMB)                                   0244 00228000
         LA    @00,2                                               0244 00229000
         SLR   @15,@15                                             0244 00230000
         IC    @15,ICWPTL(,@05)                                    0244 00231000
         ALR   @00,@15                                             0244 00232000
         STC   @00,IXHFLPLN(,@10)                                  0244 00233000
*   RFY                                                            0245 00234000
*    (RWORK2,                                                      0245 00235000
*     RWORK3) RSTD;                 /* GET WORK REGS.                */ 00236000
*   RWORK3=IXHPTLS;                 /* PICK UP PTR MASK.             */ 00237000
         SLR   RWORK3,RWORK3                                       0246 00238000
         IC    RWORK3,IXHPTLS(,@10)                                0246 00239000
*   RWORK2=IMWBUFP+LENGTH(IDAIXH);  /* POINT BEYOND HEADER.          */ 00240000
         L     @10,ICWCHN(,@05)                                    0247 00241000
         LA    RWORK2,24                                           0247 00242000
         AL    RWORK2,IMWBUFP(,@10)                                0247 00243000
*   DO RPARM1=RPARM1-1 BY-1 TO 1;   /* LOOP SETTING FS PTRS.         */ 00244000
         LR    @10,RPARM1                                          0248 00245000
         BCTR  @10,0                                               0248 00246000
         LR    RPARM1,@10                                          0248 00247000
         B     @DE00248                                            0248 00248000
@DL00248 DS    0H                                                  0249 00249000
*     GEN(EX RWORK3,STOREPT);       /* STORE POINTER VALUE.          */ 00250000
         EX RWORK3,STOREPT                                              00251000
*     RWORK2=RWORK2+ICWPTL;         /* NEXT POINTER LOCATION         */ 00252000
         L     @10,AMBIWA(,RAMB)                                   0250 00253000
         SLR   @05,@05                                             0250 00254000
         IC    @05,ICWPTL(,@10)                                    0250 00255000
         ALR   RWORK2,@05                                          0250 00256000
*   END;                            /*                               */ 00257000
         BCTR  RPARM1,0                                            0251 00258000
@DE00248 LTR   RPARM1,RPARM1                                       0251 00259000
         BP    @DL00248                                            0251 00260000
*   IXHFSO=RWORK2-IMWBUFP;          /* SET OFFSET TO FS.             */ 00261000
         L     @10,BUFCBAD(,RBUFC)                                 0252 00262000
         L     @05,AMBIWA(,RAMB)                                   0252 00263000
         L     @15,ICWCHN(,@05)                                    0252 00264000
         LR    @00,RWORK2                                          0252 00265000
         SL    @00,IMWBUFP(,@15)                                   0252 00266000
         STH   @00,IXHFSO(,@10)                                    0252 00267000
*   IXHLEO=IXHLL-IXHFLPLN;          /* POINT TO LAST ENTRY.          */ 00268000
         LH    @00,IXHLL(,@10)                                     0253 00269000
         N     @00,@CF01121                                        0253 00270000
         SLR   @15,@15                                             0253 00271000
         IC    @15,IXHFLPLN(,@10)                                  0253 00272000
         SLR   @00,@15                                             0253 00273000
         STH   @00,IXHLEO(,@10)                                    0253 00274000
*   IXHSEO=IXHLEO;                  /* POINT TO SECTION.             */ 00275000
         STH   @00,IXHSEO(,@10)                                    0254 00276000
*   IXHLV=ONE;                      /* SET LEVEL NO.                 */ 00277000
         MVI   IXHLV(@10),X'01'                                    0255 00278000
*   IXHBRBA=ICWTBASE;               /* SET BASE DATA RBA.            */ 00279000
         L     @00,ICWTBASE(,@05)                                  0256 00280000
         ST    @00,IXHBRBA(,@10)                                   0256 00281000
*   ICWTBASE=ICWCRBA;               /* SAVE RBA OF NEW SEQ. SET REC. */ 00282000
         L     @10,ICWCRBA(,@05)                                   0257 00283000
         ST    @10,ICWTBASE(,@05)                                  0257 00284000
*   IF(RPLAREA+AMDRKP)->KEY(1:AMDKEYLN)<(PLHDBUFC->BUFCBAD+AMDRKP)->KEY 00285000
*       (1:AMDKEYLN) THEN           /* USER KEY IS LT DATA BUFFER  0258 00286000
*                                      KEY.                          */ 00287000
         L     @10,AMBDSB(,RAMB)                                   0258 00288000
         LH    @05,AMDRKP(,@10)                                    0258 00289000
         L     @15,RPLAREA(,RRPL)                                  0258 00290000
         ALR   @15,@05                                             0258 00291000
         L     @14,PLHDBUFC(,RPLH)                                 0258 00292000
         AL    @05,BUFCBAD(,@14)                                   0258 00293000
         LH    @10,AMDKEYLN(,@10)                                  0258 00294000
         LR    @14,@10                                             0258 00295000
         BCTR  @14,0                                               0258 00296000
         EX    @14,@SC01122                                        0258 00297000
         BNL   @RF00258                                            0258 00298000
*     DO;                           /* PROCESS USER KEY LT.          */ 00299000
*/* BUILD KEY IN NEW SEQ SET RECORD - REAR COMPRESS USER KEY AGAINST */ 00300000
*/*   DATA BUFFER KEY.                                               */ 00301000
*                                                                  0260 00302000
*       RFY                                                        0260 00303000
*        (RWORK4,                                                  0260 00304000
*         RWORK5) RSTD;             /* GET WORK REGS.                */ 00305000
*       RWORK2=RPLAREA+AMDRKP;      /* POINT TO USER KEY.            */ 00306000
         LR    RWORK2,@15                                          0261 00307000
*       RWORK4=PLHDBUFC->BUFCBAD+AMDRKP;/* POINT TO DATA BFR KEY.    */ 00308000
         LR    RWORK4,@05                                          0262 00309000
*       RWORK3=AMDKEYLN;            /* COMPARE LENGTH = KEY LENGTH.  */ 00310000
         LR    RWORK3,@10                                          0263 00311000
*       RWORK5=RWORK3;              /* SET COMPARE LENGTH.           */ 00312000
         LR    RWORK5,RWORK3                                       0264 00313000
*       GEN(CLCL RWORK2,RWORK4);    /* COMPARE USER KEY TO DATA BFR     00314000
*                                      KEY.                          */ 00315000
         CLCL RWORK2,RWORK4                                             00316000
*       RWORK4=AMDKEYLN-RWORK3+ONE; /* INSERT KEY LENGTH = NO. EQUAL    00317000
*                                      CHARS. + 1.                   */ 00318000
         L     @10,AMBDSB(,RAMB)                                   0266 00319000
         LH    RWORK4,AMDKEYLN(,@10)                               0266 00320000
         SLR   RWORK4,RWORK3                                       0266 00321000
         AL    RWORK4,@CF00047                                     0266 00322000
*       RWORK2=BUFCBAD+IXHLL-IXHFLPLN;/* POINT TO 1ST ENTRY OF NEW 0267 00323000
*                                      SEQ. SET RECORD.              */ 00324000
         L     @05,BUFCBAD(,RBUFC)                                 0267 00325000
         LH    RWORK2,IXHLL(,@05)                                  0267 00326000
         N     RWORK2,@CF01121                                     0267 00327000
         ALR   RWORK2,@05                                          0267 00328000
         SLR   @00,@00                                             0267 00329000
         IC    @00,IXHFLPLN(,@05)                                  0267 00330000
         SLR   RWORK2,@00                                          0267 00331000
*       RWORK2->IBFLPL=RWORK4;      /* SET L BYTE OF ENTRY.          */ 00332000
         STC   RWORK4,IBFLPL(,RWORK2)                              0268 00333000
*       RWORK2=RWORK2-RWORK4;       /* POINT TO START OF KEY IN    0269 00334000
*                                      ENTRY.                        */ 00335000
         SLR   RWORK2,RWORK4                                       0269 00336000
*       RWORK2->KEY(1:RWORK4)=(RPLAREA+AMDRKP)->KEY(1:RWORK4);/* MOVE   00337000
*                                      REAR COMPRESSED KEY TO SEQ  0270 00338000
*                                      SET.                          */ 00339000
         LR    @15,RWORK4                                          0270 00340000
         BCTR  @15,0                                               0270 00341000
         LH    @10,AMDRKP(,@10)                                    0270 00342000
         AL    @10,RPLAREA(,RRPL)                                  0270 00343000
         EX    @15,@SM01124                                        0270 00344000
*       ICWKEY1(1:RWORK4)=(RPLAREA+AMDRKP)->KEY(1:RWORK4);/* SAVE  0271 00345000
*                                      INSERT KEY.                   */ 00346000
         L     @14,AMBIWA(,RAMB)                                   0271 00347000
         EX    @15,@SM01126                                        0271 00348000
*       ICWKEY1L=RWORK4;            /* SAVE INSERT KEY LENGTH.       */ 00349000
         STH   RWORK4,ICWKEY1L(,@14)                               0272 00350000
*       RFY                                                        0273 00351000
*        (RWORK2,                                                  0273 00352000
*         RWORK3,                                                  0273 00353000
*         RWORK4,                                                  0273 00354000
*         RWORK5) UNRSTD;           /* FREE WORK REGS.               */ 00355000
*       IXHHP=ICWPRBA;              /* SET HORIZ PTR TO CUR SEQ SET     00356000
*                                      RECORD.                       */ 00357000
         L     @10,ICWPRBA(,@14)                                   0274 00358000
         ST    @10,IXHHP(,@05)                                     0274 00359000
*       RPARM1=ICWCRBA;             /* RBA OF NEW SEQ SET            */ 00360000
         L     RPARM1,ICWCRBA(,@14)                                0275 00361000
*       DO;                         /* SET OUTPUT RBA                */ 00362000
*         BUFCORBA=RPARM1;                                         0277 00363000
         ST    RPARM1,BUFCORBA(,RBUFC)                             0277 00364000
*         BUFCMW=ON;                /* SET MUST WRITE                */ 00365000
         OI    BUFCMW(RBUFC),B'10000000'                           0278 00366000
*       END;                        /* SET BUFC MW & ORBA.           */ 00367000
*       BUFCDDDD=RPARM1;            /* SET BUFC INPUT RBA.           */ 00368000
         ST    RPARM1,BUFCDDDD(,RBUFC)                             0280 00369000
*       BUFXIRBA=RPARM1;            /* SET BUFC EXCL RBA.            */ 00370000
         ST    RPARM1,BUFXIRBA(,RBUFC)                             0281 00371000
*       BUFCVAL=ON;                 /* SET BUFC VALID.               */ 00372000
         OI    BUFCVAL(RBUFC),B'00000100'                          0282 00373000
*I05:                                                              0283 00374000
*       DO;                         /* IDACALL(IDAWRBFR)             */ 00375000
I05      DS    0H                                                  0284 00376000
*         CALL IDAWRBFR;            /* EXIT TO IDAWRBFR              */ 00377000
         L     @15,@CV01049                                        0284 00378000
         BALR  @14,@15                                             0284 00379000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00380000
         BALR @11,0                                                     00381000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00382000
         USING *,@11                                                    00383000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00384000
         L     @11,=A(@PSTART)                                          00385000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00386000
         USING @PSTART,@11                                              00387000
*       END I05;                    /* WRITE NEW SEQ SET RECORD.     */ 00388000
*       IF RPLERREG^='00'X THEN     /* ERROR.                        */ 00389000
         CLI   RPLERREG(RRPL),0                                    0290 00390000
         BNE   @RT00290                                            0290 00391000
*         GOTO SFEXIT;              /* RETURN.                       */ 00392000
*I06:                                                              0292 00393000
*       DO;                         /* IDACALL(IDA019RV)             */ 00394000
I06      DS    0H                                                  0293 00395000
*         CALL IDA019RV;            /* EXIT TO IDA019RV              */ 00396000
         L     @15,@CV01046                                        0293 00397000
         BALR  @14,@15                                             0293 00398000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00399000
         BALR @11,0                                                     00400000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00401000
         USING *,@11                                                    00402000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00403000
         L     @11,=A(@PSTART)                                          00404000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00405000
         USING @PSTART,@11                                              00406000
*       END I06;                    /* LOCATE PREVIOUS SEQ SET RECORD   00407000
*                                      RBA.                          */ 00408000
*       RFY                                                        0299 00409000
*         R15 RSTD;                 /* PROTECT REG 15                */ 00410000
*       IF RPLERREG^='00'X THEN     /* ERROR.                        */ 00411000
         CLI   RPLERREG(RRPL),0                                    0300 00412000
         BNE   @RT00300                                            0300 00413000
*         GOTO SFEXIT;              /* RETURN.                       */ 00414000
*       IF R15=ZERO THEN            /* PREVIOUS SEQ. SET REC FOUND.  */ 00415000
         LTR   R15,R15                                             0302 00416000
         BNZ   @RF00302                                            0302 00417000
*         DO;                       /* CHAIN PREV. SEQ. SET REC.     */ 00418000
*           RFY                                                    0304 00419000
*             R15 UNRSTD;           /* RELEASE REG 15                */ 00420000
*           IXHHP=ICWCRBA;          /* SET HORIZ PTR TO NEW SEQ SET     00421000
*                                      RECORD.                       */ 00422000
         L     @10,BUFCBAD(,RBUFC)                                 0305 00423000
         L     @05,AMBIWA(,RAMB)                                   0305 00424000
         L     @05,ICWCRBA(,@05)                                   0305 00425000
         ST    @05,IXHHP(,@10)                                     0305 00426000
*           RPARM1=BUFCDDDD;        /* RBA OF BUFFER.                */ 00427000
         L     RPARM1,BUFCDDDD(,RBUFC)                             0306 00428000
*           DO;                     /* SET OUTPUT RBA                */ 00429000
*             BUFCORBA=RPARM1;                                     0308 00430000
         ST    RPARM1,BUFCORBA(,RBUFC)                             0308 00431000
*             BUFCMW=ON;            /* SET MUST WRITE                */ 00432000
         OI    BUFCMW(RBUFC),B'10000000'                           0309 00433000
*           END;                    /* SET BUFC MW & ORBA.           */ 00434000
*I08:                                                              0311 00435000
*           DO;                     /* IDACALL(IDAWRBFR)             */ 00436000
I08      DS    0H                                                  0312 00437000
*             CALL IDAWRBFR;        /* EXIT TO IDAWRBFR              */ 00438000
         L     @15,@CV01049                                        0312 00439000
         BALR  @14,@15                                             0312 00440000
*             GEN(BALR @11,0);      /* LOAD ADDR OF REENTRY          */ 00441000
         BALR @11,0                                                     00442000
*             GEN(USING *,@11);     /* ESTABLISH ADDRESSING          */ 00443000
         USING *,@11                                                    00444000
*             GEN(L     @11,=A(@PSTART));/* RELOAD BASE              */ 00445000
         L     @11,=A(@PSTART)                                          00446000
*             GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING         */ 00447000
         USING @PSTART,@11                                              00448000
*           END I08;                /* REWRITE PREV SEQ SET REC      */ 00449000
*           IF RPLERREG^='00'X THEN /* ERROR.                        */ 00450000
         CLI   RPLERREG(RRPL),0                                    0318 00451000
         BNE   @RT00318                                            0318 00452000
*             GOTO SFEXIT;          /* RETURN.                       */ 00453000
*         END;                      /* END CHAIN PREV. SEQ SET REC.  */ 00454000
*       RFY                                                        0321 00455000
*        (RWORK1,                                                  0321 00456000
*         RWORK2) RSTD;             /* GET WORK REGS.                */ 00457000
@RF00302 DS    0H                                                  0322 00458000
*       IF ICWPRBA=AMDSSRBA THEN    /* CUR SEQ SET REC = 1ST SEQ SET    00459000
*                                      REC.                          */ 00460000
         L     @10,AMBIWA(,RAMB)                                   0322 00461000
         L     @07,AMBDSB(,RAMB)                                   0322 00462000
         CLC   ICWPRBA(4,@10),AMDSSRBA(@07)                        0322 00463000
         BNE   @RF00322                                            0322 00464000
*         DO;                       /* UPDATE CATALOG.               */ 00465000
*           AMDSSRBA=ICWCRBA;       /* 1ST SEQ SET REC = NEW SEQ SET    00466000
*                                      REC.                          */ 00467000
         L     @10,ICWCRBA(,@10)                                   0324 00468000
         ST    @10,AMDSSRBA(,@07)                                  0324 00469000
*           PLHEOVR=AMBEOVUC;       /* SET UPDATE CATALOG REQ CODE.  */ 00470000
         MVI   PLHEOVR(RPLH),B'00000100'                           0325 00471000
*I09:                                                              0326 00472000
*           DO;                     /* IDACALL(IDAEOVIF)             */ 00473000
I09      DS    0H                                                  0327 00474000
*             CALL IDAEOVIF;        /* EXIT TO IDAEOVIF              */ 00475000
         L     @15,@CV01051                                        0327 00476000
         BALR  @14,@15                                             0327 00477000
*             GEN(BALR @11,0);      /* LOAD ADDR OF REENTRY          */ 00478000
         BALR @11,0                                                     00479000
*             GEN(USING *,@11);     /* ESTABLISH ADDRESSING          */ 00480000
         USING *,@11                                                    00481000
*             GEN(L     @11,=A(@PSTART));/* RELOAD BASE              */ 00482000
         L     @11,=A(@PSTART)                                          00483000
*             GEN(USING @PSTART,@11);/* ESTABLISH ADDRESSING         */ 00484000
         USING @PSTART,@11                                              00485000
*           END I09;                /* CALL EOV INTERFACE.           */ 00486000
*           AMBLDTA->AMBIWA->DIW1ST=ON;/* INDICATE NEW SEQ SET RCD IS   00487000
*                                      AT BEG.                       */ 00488000
         L     @10,RPLDACB(,RRPL)                                  0333 00489000
         L     @10,ACBAMBL(,@10)                                   0333 00490000
         L     @10,AMBLDTA(,@10)                                   0333 00491000
         L     @10,AMBIWA(,@10)                                    0333 00492000
         OI    DIW1ST(@10),B'00000001'                             0333 00493000
*         END;                      /* END UPDATE CATALOG.           */ 00494000
*       AMBLDTA->AMBIWA->DIWSAVE4=ONE;/* INDICATE NEW SEQ SET BEFORE    00495000
*                                      CUR                           */ 00496000
@RF00322 L     @10,RPLDACB(,RRPL)                                  0335 00497000
         L     @10,ACBAMBL(,@10)                                   0335 00498000
         L     @10,AMBLDTA(,@10)                                   0335 00499000
         L     @10,AMBIWA(,@10)                                    0335 00500000
         MVC   DIWSAVE4(4,@10),@CF00047                            0335 00501000
*     END;                          /* END USER KEY LT.              */ 00502000
*   ELSE                            /* USER KEY GT DATA BUFFER KEY.  */ 00503000
*     DO;                           /* PROCESS USER KEY GT.          */ 00504000
         B     @RC00258                                            0337 00505000
@RF00258 DS    0H                                                  0338 00506000
*       RWORK2=BUFCBAD+IXHLL-IXHFLPLN;/* POINT TO 1ST ENTRY OF NEW 0338 00507000
*                                      SEQ SET RECORD.               */ 00508000
         L     @10,BUFCBAD(,RBUFC)                                 0338 00509000
         LH    RWORK2,IXHLL(,@10)                                  0338 00510000
         N     RWORK2,@CF01121                                     0338 00511000
         ALR   RWORK2,@10                                          0338 00512000
         SLR   @00,@00                                             0338 00513000
         IC    @00,IXHFLPLN(,@10)                                  0338 00514000
         SLR   RWORK2,@00                                          0338 00515000
*       RFY                                                        0339 00516000
*        (RWORK3,                                                  0339 00517000
*         RWORK4,                                                  0339 00518000
*         RWORK5) RSTD;             /*                               */ 00519000
*       RWORK3=ICWKEY1L;            /* GET SAVED L BYTE.             */ 00520000
         L     @10,AMBIWA(,RAMB)                                   0340 00521000
         LH    RWORK3,ICWKEY1L(,@10)                               0340 00522000
*       RWORK2->IBFLPL=RWORK3;      /* MOVE SAVED L BYTE TO NEW ENTRY*/ 00523000
         STC   RWORK3,IBFLPL(,RWORK2)                              0341 00524000
*       RWORK2=RWORK2-RWORK3;       /* POINT TO START OF KEY IN    0342 00525000
*                                      ENTRY.                        */ 00526000
         SLR   RWORK2,RWORK3                                       0342 00527000
*       RWORK4=ADDR(ICWKEY1);       /* SET FROM ADDRESS              */ 00528000
         LA    RWORK4,ICWKEY1(,@10)                                0343 00529000
*       RWORK5=RWORK3;              /* SET LENGTH FOR MVCL           */ 00530000
         LR    RWORK5,RWORK3                                       0344 00531000
*       GEN(MVCL RWORK2,RWORK4);    /* MOVE SAVED KEY TO NEW ENTRY.  */ 00532000
         MVCL RWORK2,RWORK4                                             00533000
*       RFY                                                        0346 00534000
*        (RWORK1,                                                  0346 00535000
*         RWORK2,                                                  0346 00536000
*         RWORK3,                                                  0346 00537000
*         RWORK4,                                                  0346 00538000
*         RWORK5) UNRSTD;           /* FREE REGS                     */ 00539000
*       IXHHP=ICWTPTR;              /* SET HORIZ PTR SAME AS CUR SEQ    00540000
*                                      SET.                          */ 00541000
         L     @10,BUFCBAD(,RBUFC)                                 0347 00542000
         L     @05,AMBIWA(,RAMB)                                   0347 00543000
         L     @00,ICWTPTR(,@05)                                   0347 00544000
         ST    @00,IXHHP(,@10)                                     0347 00545000
*       RPARM1=ICWCRBA;             /* RBA OF NEW SEQ SET.           */ 00546000
         L     RPARM1,ICWCRBA(,@05)                                0348 00547000
*       DO;                         /* SET OUTPUT RBA                */ 00548000
*         BUFCORBA=RPARM1;                                         0350 00549000
         ST    RPARM1,BUFCORBA(,RBUFC)                             0350 00550000
*         BUFCMW=ON;                /* SET MUST WRITE                */ 00551000
         OI    BUFCMW(RBUFC),B'10000000'                           0351 00552000
*       END;                        /* SET BUFC MW & ORBA.           */ 00553000
*       BUFCDDDD=RPARM1;            /* SET BUFC INPUT RBA.           */ 00554000
         ST    RPARM1,BUFCDDDD(,RBUFC)                             0353 00555000
*       BUFXIRBA=RPARM1;            /* SET BUFC EXCL. RBA.           */ 00556000
         ST    RPARM1,BUFXIRBA(,RBUFC)                             0354 00557000
*       BUFCVAL=ON;                 /* SET BUFC VALID.               */ 00558000
         OI    BUFCVAL(RBUFC),B'00000100'                          0355 00559000
*I11:                                                              0356 00560000
*       DO;                         /* IDACALL(IDAWRBFR)             */ 00561000
I11      DS    0H                                                  0357 00562000
*         CALL IDAWRBFR;            /* EXIT TO IDAWRBFR              */ 00563000
         L     @15,@CV01049                                        0357 00564000
         BALR  @14,@15                                             0357 00565000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00566000
         BALR @11,0                                                     00567000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00568000
         USING *,@11                                                    00569000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00570000
         L     @11,=A(@PSTART)                                          00571000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00572000
         USING @PSTART,@11                                              00573000
*       END I11;                    /* WRITE NEW SEQ SET.            */ 00574000
*       IF RPLERREG^='00'X THEN     /* ERROR.                        */ 00575000
         CLI   RPLERREG(RRPL),0                                    0363 00576000
         BNE   @RT00363                                            0363 00577000
*         GOTO SFEXIT;              /* RETURN.                       */ 00578000
*       PLHSSR=ON;                  /* SET PLH SEQ. SET REQ.         */ 00579000
         OI    PLHSSR(RPLH),B'00010000'                            0365 00580000
*       RPARM1=ICWPRBA;             /* RBA OF CUR SEQ SET.           */ 00581000
         L     @10,AMBIWA(,RAMB)                                   0366 00582000
         L     RPARM1,ICWPRBA(,@10)                                0366 00583000
*I12:                                                              0367 00584000
*       DO;                         /* IDACALL(IDAGRB)               */ 00585000
I12      DS    0H                                                  0368 00586000
*         CALL IDAGRB;              /* EXIT TO IDAGRB                */ 00587000
         L     @15,@CV01043                                        0368 00588000
         BALR  @14,@15                                             0368 00589000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00590000
         BALR @11,0                                                     00591000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00592000
         USING *,@11                                                    00593000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00594000
         L     @11,=A(@PSTART)                                          00595000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00596000
         USING @PSTART,@11                                              00597000
*       END I12;                    /* GET CUR SEQ SET REC.          */ 00598000
*       IF RPLERREG^='00'X THEN     /* ERROR.                        */ 00599000
         CLI   RPLERREG(RRPL),0                                    0374 00600000
         BNE   @RT00374                                            0374 00601000
*         GOTO SFEXIT;              /* RETURN.                       */ 00602000
*       IXHHP=ICWCRBA;              /* SET HORIZ PTR TO NEW SEQ SET     00603000
*                                      RECORD.                       */ 00604000
         L     @10,BUFCBAD(,RBUFC)                                 0376 00605000
         L     @05,AMBIWA(,RAMB)                                   0376 00606000
         L     @05,ICWCRBA(,@05)                                   0376 00607000
         ST    @05,IXHHP(,@10)                                     0376 00608000
*/* REBUILD KEY IN CURRENT SEQ. SET RECORD. REAR COMPRESS DATA       */ 00609000
*/*   BUFFER KEY AGAINST USER KEY. CURRENT SEQ. SET RECORD HAS ONLY  */ 00610000
*/*   1 DATA RECORD ENTRY & IS A SPANNED RECORD.                     */ 00611000
*                                                                  0377 00612000
*       RFY                                                        0377 00613000
*        (RWORK2,                                                  0377 00614000
*         RWORK3,                                                  0377 00615000
*         RWORK5) RSTD;             /* GET WORK REGS.                */ 00616000
*       RWORK2=BUFCBAD+IXHLEO;      /* POINT TO LAST ENTRY IN CUR  0378 00617000
*                                      SEQ. SET RECORD.              */ 00618000
         LH    RWORK2,IXHLEO(,@10)                                 0378 00619000
         ALR   RWORK2,@10                                          0378 00620000
*       RWORK3=RWORK2->IBFLPL;      /* GET L BYTE OF ENTRY.          */ 00621000
         SLR   RWORK3,RWORK3                                       0379 00622000
         IC    RWORK3,IBFLPL(,RWORK2)                              0379 00623000
*       RWORK2=RWORK2-RWORK3;       /* POINT TO START OF KEY.        */ 00624000
         SLR   RWORK2,RWORK3                                       0380 00625000
*       RWORK5=ZERO;                /* PAD CHAR.                     */ 00626000
         SLR   RWORK5,RWORK5                                       0381 00627000
*       GEN(MVCL RWORK2,RWORK4);    /* ZERO OUT KEY IN ENTRY.        */ 00628000
         MVCL RWORK2,RWORK4                                             00629000
*       RFY                                                        0383 00630000
*         RWORK4 RSTD;              /* GET WORK REG.                 */ 00631000
*       RWORK2=RPLAREA+AMDRKP;      /* POINT TO USER KEY.            */ 00632000
         L     @10,AMBDSB(,RAMB)                                   0384 00633000
         LH    @05,AMDRKP(,@10)                                    0384 00634000
         L     RWORK2,RPLAREA(,RRPL)                               0384 00635000
         ALR   RWORK2,@05                                          0384 00636000
*       RWORK4=PLHDBUFC->BUFCBAD+AMDRKP;/* POINT TO DATA BFR KEY.    */ 00637000
         L     @15,PLHDBUFC(,RPLH)                                 0385 00638000
         AL    @05,BUFCBAD(,@15)                                   0385 00639000
         LR    RWORK4,@05                                          0385 00640000
*       RWORK3=AMDKEYLN;            /* COMPARE LENGTH = KEY LENGTH.  */ 00641000
         LH    RWORK3,AMDKEYLN(,@10)                               0386 00642000
*       RWORK5=RWORK3;              /* SET COMPARE LENGTH.           */ 00643000
         LR    RWORK5,RWORK3                                       0387 00644000
*       GEN(CLCL RWORK2,RWORK4);    /* COMPARE USER KEY TO DATA BFR     00645000
*                                      KEY.                          */ 00646000
         CLCL RWORK2,RWORK4                                             00647000
*       RWORK4=AMDKEYLN-RWORK3+ONE; /* INSERT KEY LENGTH = NO. EQUAL    00648000
*                                      CHARS. + 1.                   */ 00649000
         L     @10,AMBDSB(,RAMB)                                   0389 00650000
         LH    RWORK4,AMDKEYLN(,@10)                               0389 00651000
         SLR   RWORK4,RWORK3                                       0389 00652000
         AL    RWORK4,@CF00047                                     0389 00653000
*       RWORK2=BUFCBAD+IXHLEO;      /* POINT TO LAST ENTRY IN CUR. 0390 00654000
*                                      SEQ. SET REC.                 */ 00655000
         L     @05,BUFCBAD(,RBUFC)                                 0390 00656000
         LH    RWORK2,IXHLEO(,@05)                                 0390 00657000
         ALR   RWORK2,@05                                          0390 00658000
*       RWORK2->IBFLPL=RWORK4;      /* SET L BYTE OF NEW KEY.        */ 00659000
         STC   RWORK4,IBFLPL(,RWORK2)                              0391 00660000
*       RWORK2=RWORK2-RWORK4;       /* POINT TO START OF KEY IN ENTRY*/ 00661000
         SLR   RWORK2,RWORK4                                       0392 00662000
*       RWORK3=PLHDBUFC->BUFCBAD+AMDRKP;/* POINT TO START OF KEY IN     00663000
*                                      DATA BUFFER.                  */ 00664000
         L     @05,PLHDBUFC(,RPLH)                                 0393 00665000
         LH    RWORK3,AMDRKP(,@10)                                 0393 00666000
         AL    RWORK3,BUFCBAD(,@05)                                0393 00667000
*       RWORK2->KEY(1:RWORK4)=RWORK3->KEY(1:RWORK4);/* MOVE REAR   0394 00668000
*                                      COMPRESSED KEY TO SEQ. SET.   */ 00669000
         LR    @10,RWORK4                                          0394 00670000
         BCTR  @10,0                                               0394 00671000
         EX    @10,@SM01129                                        0394 00672000
*       ICWKEY1(1:RWORK4)=RWORK3->KEY(1:RWORK4);/* SAVE INSERT KEY.  */ 00673000
         L     @05,AMBIWA(,RAMB)                                   0395 00674000
         EX    @10,@SM01131                                        0395 00675000
*       ICWKEY1L=RWORK4;            /* SAVE INSERT KEY LENGTH.       */ 00676000
         STH   RWORK4,ICWKEY1L(,@05)                               0396 00677000
*       RFY                                                        0397 00678000
*        (RWORK2,                                                  0397 00679000
*         RWORK3,                                                  0397 00680000
*         RWORK4,                                                  0397 00681000
*         RWORK5) UNRSTD;           /* FREE WORK REGS.               */ 00682000
*       RPARM1=BUFCDDDD;            /* RBA OF BUFFER.                */ 00683000
         L     RPARM1,BUFCDDDD(,RBUFC)                             0398 00684000
*       DO;                         /* SET OUTPUT RBA                */ 00685000
*         BUFCORBA=RPARM1;                                         0400 00686000
         ST    RPARM1,BUFCORBA(,RBUFC)                             0400 00687000
*         BUFCMW=ON;                /* SET MUST WRITE                */ 00688000
         OI    BUFCMW(RBUFC),B'10000000'                           0401 00689000
*       END;                        /* SET BUFC OUTPUT RBA & MW.     */ 00690000
*I14:                                                              0403 00691000
*       DO;                         /* IDACALL(IDAWRBFR)             */ 00692000
I14      DS    0H                                                  0404 00693000
*         CALL IDAWRBFR;            /* EXIT TO IDAWRBFR              */ 00694000
         L     @15,@CV01049                                        0404 00695000
         BALR  @14,@15                                             0404 00696000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00697000
         BALR @11,0                                                     00698000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00699000
         USING *,@11                                                    00700000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00701000
         L     @11,=A(@PSTART)                                          00702000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00703000
         USING @PSTART,@11                                              00704000
*       END I14;                    /* REWRITE CUR SEQ SET.          */ 00705000
*       IF RPLERREG^='00'X THEN     /* ERROR.                        */ 00706000
         CLI   RPLERREG(RRPL),0                                    0410 00707000
         BNE   @RT00410                                            0410 00708000
*         GOTO SFEXIT;              /* RETURN.                       */ 00709000
*       AMBLDTA->AMBIWA->DIWSAVE4=ZERO;/* INDICATE NEW SEQ SET AFTER    00710000
*                                      CUR.                          */ 00711000
         L     @10,RPLDACB(,RRPL)                                  0412 00712000
         L     @10,ACBAMBL(,@10)                                   0412 00713000
         L     @10,AMBLDTA(,@10)                                   0412 00714000
         L     @10,AMBIWA(,@10)                                    0412 00715000
         SLR   @05,@05                                             0412 00716000
         ST    @05,DIWSAVE4(,@10)                                  0412 00717000
*     END;                          /* END USER KEY GT.              */ 00718000
*/* UPGRADE INDEX -                                                  */ 00719000
*/*       ICWPRBA=CUR SEQ SET RBA                                    */ 00720000
*/*       ICWCRBA=NEW SEQ SET RBA                                    */ 00721000
*                                                                  0414 00722000
*I15:                                                              0414 00723000
*   DO;                             /* IDACALL(IDAHLINS)             */ 00724000
@RC00258 DS    0H                                                  0414 00725000
I15      DS    0H                                                  0415 00726000
*     CALL IDAHLINS;                /* EXIT TO IDAHLINS              */ 00727000
         L     @15,@CV01047                                        0415 00728000
         BALR  @14,@15                                             0415 00729000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00730000
         BALR @11,0                                                     00731000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00732000
         USING *,@11                                                    00733000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00734000
         L     @11,=A(@PSTART)                                          00735000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00736000
         USING @PSTART,@11                                              00737000
*   END I15;                        /* CALL INDEX UPGRADE.           */ 00738000
*   IF RPLERREG^='00'X THEN         /* ERROR.                        */ 00739000
         CLI   RPLERREG(RRPL),0                                    0421 00740000
         BNE   @RT00421                                            0421 00741000
*     GOTO SFEXIT;                  /* RETURN.                       */ 00742000
*   IF AMBLDTA->AMBIWA->DIWFSPF=ON&AMBLDTA->AMBIWA->DIW1ST=ON THEN/*    00743000
*                                      2ND LEVEL DIDN'T SPLIT & AT 0423 00744000
*                                      BEG OF SEQ SET.               */ 00745000
         L     @10,RPLDACB(,RRPL)                                  0423 00746000
         L     @10,ACBAMBL(,@10)                                   0423 00747000
         L     @10,AMBLDTA(,@10)                                   0423 00748000
         L     @10,AMBIWA(,@10)                                    0423 00749000
         TM    DIWFSPF(@10),B'10000000'                            0423 00750000
         BNO   @RF00423                                            0423 00751000
         TM    DIW1ST(@10),B'00000001'                             0423 00752000
         BNO   @RF00423                                            0423 00753000
*     DO;                           /* CHANGE 2ND LEVEL PTR.         */ 00754000
*       RPARM1=AMBLDTA->AMBIWA->DIWSAVE1;/* RBA OF 2ND LEVEL IX RCD. */ 00755000
         L     RPARM1,DIWSAVE1(,@10)                               0425 00756000
*I16:                                                              0426 00757000
*       DO;                         /* IDACALL(IDAGRB)               */ 00758000
I16      DS    0H                                                  0427 00759000
*         CALL IDAGRB;              /* EXIT TO IDAGRB                */ 00760000
         L     @15,@CV01043                                        0427 00761000
         BALR  @14,@15                                             0427 00762000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00763000
         BALR @11,0                                                     00764000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00765000
         USING *,@11                                                    00766000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00767000
         L     @11,=A(@PSTART)                                          00768000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00769000
         USING @PSTART,@11                                              00770000
*       END I16;                    /* READ 2ND LEVEL IX RCD.        */ 00771000
*       IF RPLERREG^='00'X THEN     /* ERROR.                        */ 00772000
         CLI   RPLERREG(RRPL),0                                    0433 00773000
         BNE   @RT00433                                            0433 00774000
*         GOTO SFEXIT;              /* RETURN.                       */ 00775000
*       RFY                                                        0435 00776000
*        (RWORK2,                                                  0435 00777000
*         RWORK3) RSTD;             /* GET WORK REGS.                */ 00778000
*       RWORK2=BUFCBAD+IXHLL-IXHFLPLN;/* POINT TO 1ST ENTRY.         */ 00779000
         L     @10,BUFCBAD(,RBUFC)                                 0436 00780000
         LH    RWORK2,IXHLL(,@10)                                  0436 00781000
         N     RWORK2,@CF01121                                     0436 00782000
         ALR   RWORK2,@10                                          0436 00783000
         SLR   @05,@05                                             0436 00784000
         IC    @05,IXHFLPLN(,@10)                                  0436 00785000
         SLR   RWORK2,@05                                          0436 00786000
*       RWORK3=ICWTBASE/AMDCINV;    /* CALC RBA MULTI OF NEW SEQ SET.*/ 00787000
         L     @05,AMBIWA(,RAMB)                                   0437 00788000
         L     @15,AMBDSB(,RAMB)                                   0437 00789000
         L     @09,ICWTBASE(,@05)                                  0437 00790000
         SLR   @08,@08                                             0437 00791000
         D     @08,AMDCINV(,@15)                                   0437 00792000
         LR    RWORK3,@09                                          0437 00793000
*       RPARM1=IXHPTLS;             /* GET RBA PTR MASK.             */ 00794000
         SLR   RPARM1,RPARM1                                       0438 00795000
         IC    RPARM1,IXHPTLS(,@10)                                0438 00796000
*       GEN(EX RPARM1,STCMPTR);     /* STORE PTR IN 2ND LEVEL IX RCD.*/ 00797000
         EX RPARM1,STCMPTR                                              00798000
*       RPARM1=BUFCDDDD;            /* RBA OF BUFFER.                */ 00799000
         L     RPARM1,BUFCDDDD(,RBUFC)                             0440 00800000
*       DO;                         /* SET OUTPUT RBA                */ 00801000
*         BUFCORBA=RPARM1;                                         0442 00802000
         ST    RPARM1,BUFCORBA(,RBUFC)                             0442 00803000
*         BUFCMW=ON;                /* SET MUST WRITE                */ 00804000
         OI    BUFCMW(RBUFC),B'10000000'                           0443 00805000
*       END;                        /* SET BUFC MW & ORBA.           */ 00806000
*I18:                                                              0445 00807000
*       DO;                         /* IDACALL(IDAWRBFR)             */ 00808000
I18      DS    0H                                                  0446 00809000
*         CALL IDAWRBFR;            /* EXIT TO IDAWRBFR              */ 00810000
         L     @15,@CV01049                                        0446 00811000
         BALR  @14,@15                                             0446 00812000
*         GEN(BALR @11,0);          /* LOAD ADDR OF REENTRY          */ 00813000
         BALR @11,0                                                     00814000
*         GEN(USING *,@11);         /* ESTABLISH ADDRESSING          */ 00815000
         USING *,@11                                                    00816000
*         GEN(L     @11,=A(@PSTART));/* RELOAD BASE                  */ 00817000
         L     @11,=A(@PSTART)                                          00818000
*         GEN(USING @PSTART,@11);   /* ESTABLISH ADDRESSING          */ 00819000
         USING @PSTART,@11                                              00820000
*       END I18;                    /* REWRITE 2ND LVL IX RCD.       */ 00821000
*       IF RPLERREG^='00'X THEN     /* ERROR.                        */ 00822000
         CLI   RPLERREG(RRPL),0                                    0452 00823000
         BNE   @RT00452                                            0452 00824000
*         GOTO SFEXIT;              /* RETURN.                       */ 00825000
*       RFY                                                        0454 00826000
*        (RWORK2,                                                  0454 00827000
*         RWORK3) UNRSTD;           /* FREE WORK REGS.               */ 00828000
*     END;                          /* END CHANGE 2ND LEVEL PTR.     */ 00829000
*   RAMB=AMBLDTA;                   /* POINT TO DATA AMB.            */ 00830000
@RF00423 L     @10,RPLDACB(,RRPL)                                  0456 00831000
         L     @10,ACBAMBL(,@10)                                   0456 00832000
         L     RAMB,AMBLDTA(,@10)                                  0456 00833000
*   RBUFC=ZERO;                     /* SET PARM FOR ALL.             */ 00834000
         SLR   RBUFC,RBUFC                                         0457 00835000
*I19:                                                              0458 00836000
*   DO;                             /* IDACALL(IDASBF)               */ 00837000
I19      DS    0H                                                  0459 00838000
*     CALL IDASBF;                  /* EXIT TO IDASBF                */ 00839000
         L     @15,@CV01052                                        0459 00840000
         BALR  @14,@15                                             0459 00841000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00842000
         BALR @11,0                                                     00843000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00844000
         USING *,@11                                                    00845000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00846000
         L     @11,=A(@PSTART)                                          00847000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00848000
         USING @PSTART,@11                                              00849000
*   END I19;                        /* SUBTRACT BUFFERS.             */ 00850000
*   IF RPLERREG^='00'X THEN         /* IF I/O ERROR.                 */ 00851000
         CLI   RPLERREG(RRPL),0                                    0465 00852000
         BNE   @RT00465                                            0465 00853000
*     GOTO SFEXIT;                  /* TERMINATE.                    */ 00854000
*   PLHASKBF=ON;                    /* SET BFR REQUEST.              */ 00855000
         OI    PLHASKBF(RPLH),B'00100000'                          0467 00856000
*   RPARM1=ZERO;                    /* SET PARM FOR MAX.             */ 00857000
         SLR   RPARM1,RPARM1                                       0468 00858000
*I20:                                                              0469 00859000
*   DO;                             /* IDACALL(IDAABF)               */ 00860000
I20      DS    0H                                                  0470 00861000
*     CALL IDAABF;                  /* EXIT TO IDAABF                */ 00862000
         L     @15,@CV01048                                        0470 00863000
         BALR  @14,@15                                             0470 00864000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00865000
         BALR @11,0                                                     00866000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00867000
         USING *,@11                                                    00868000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00869000
         L     @11,=A(@PSTART)                                          00870000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00871000
         USING @PSTART,@11                                              00872000
*   END I20;                        /* ADD BUFFERS.                  */ 00873000
*I21:                                                              0476 00874000
*   DO;                             /* IDACALL(IDAGNNFL)             */ 00875000
I21      DS    0H                                                  0477 00876000
*     CALL IDAGNNFL;                /* EXIT TO IDAGNNFL              */ 00877000
         L     @15,@CV01042                                        0477 00878000
         BALR  @14,@15                                             0477 00879000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00880000
         BALR @11,0                                                     00881000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00882000
         USING *,@11                                                    00883000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00884000
         L     @11,=A(@PSTART)                                          00885000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00886000
         USING @PSTART,@11                                              00887000
*   END I21;                        /* GET NEXT NO FILL.             */ 00888000
*   IF RPLERREG^='00'X THEN         /* ERROR.                        */ 00889000
         CLI   RPLERREG(RRPL),0                                    0483 00890000
         BNE   @RT00483                                            0483 00891000
*     GOTO SFEXIT;                  /* RETURN.                       */ 00892000
*   RPARM1=DIWSAVE2;                /* RBA OF 1ST CI IN NEW CA.      */ 00893000
         L     @10,AMBIWA(,RAMB)                                   0485 00894000
         L     RPARM1,DIWSAVE2(,@10)                               0485 00895000
*   DO;                             /* SET OUTPUT RBA                */ 00896000
*     BUFCORBA=RPARM1;                                             0487 00897000
         ST    RPARM1,BUFCORBA(,RBUFC)                             0487 00898000
*     BUFCMW=ON;                    /* SET MUST WRITE                */ 00899000
         OI    BUFCMW(RBUFC),B'10000000'                           0488 00900000
*   END;                            /* SET BUFC MW & ORBA.           */ 00901000
*   BUFCDDDD=BUFCORBA;              /* SET BUFC INPUT RBA.           */ 00902000
         L     @10,BUFCORBA(,RBUFC)                                0490 00903000
         ST    @10,BUFCDDDD(,RBUFC)                                0490 00904000
*   BUFXIRBA=BUFCORBA;              /* SET EXCL INPUT RBA.           */ 00905000
         ST    @10,BUFXIRBA(,RBUFC)                                0491 00906000
*   BUFCVAL=ON;                     /* SET BUFC VALID.               */ 00907000
*   BUFCEXC=ON;                     /* SET BUFC EXCL.                */ 00908000
         OI    BUFCVAL(RBUFC),B'00000110'                          0493 00909000
*   CALL BFRFS;                     /* SET FS IN BUFFER.             */ 00910000
         BAL   @14,BFRFS                                           0494 00911000
*   PLHRECP=BUFCBAD;                /* SET PLH RECORD PTR.           */ 00912000
         L     @10,BUFCBAD(,RBUFC)                                 0495 00913000
         ST    @10,PLHRECP(,RPLH)                                  0495 00914000
*   PLHFSP=BUFCBAD;                 /* POINT TO FS - BFR ALL FREE.   */ 00915000
         ST    @10,PLHFSP(,RPLH)                                   0496 00916000
*   PLHRDFP=BUFCBAD+AMDCINV-LENGTH(IDACIDF);/* SET RDF PTR - NO RDF'S*/ 00917000
         L     @05,AMBDSB(,RAMB)                                   0497 00918000
         AL    @10,AMDCINV(,@05)                                   0497 00919000
         SL    @10,@CF00036                                        0497 00920000
         ST    @10,PLHRDFP(,RPLH)                                  0497 00921000
*   IF PLHADDTE=ON THEN             /* ADD TO END.                   */ 00922000
         TM    PLHADDTE(RPLH),B'00010000'                          0498 00923000
         BNO   @RF00498                                            0498 00924000
*     ARDHKRBA=DIWSAVE2;            /* UPDATE HI-KEY RBA.            */ 00925000
         L     @10,PLHARDB(,RPLH)                                  0499 00926000
         L     @05,AMBIWA(,RAMB)                                   0499 00927000
         L     @05,DIWSAVE2(,@05)                                  0499 00928000
         ST    @05,ARDHKRBA(,@10)                                  0499 00929000
*   IF RPLRLEN<=AMDCINV-LENGTH(IDACIDF)-LENGTH(IDARDF) THEN/* NOT  0500 00930000
*                                      SPANNED RECORD.               */ 00931000
@RF00498 L     @10,AMBDSB(,RAMB)                                   0500 00932000
         L     @10,AMDCINV(,@10)                                   0500 00933000
         SL    @10,@CF00170                                        0500 00934000
         C     @10,RPLRLEN(,RRPL)                                  0500 00935000
         BL    @RF00500                                            0500 00936000
*I23:                                                              0501 00937000
*     DO;                           /* IDACALL(IDA019RM)             */ 00938000
I23      DS    0H                                                  0502 00939000
*       CALL IDA019RM;              /* EXIT TO IDA019RM              */ 00940000
         L     @15,@CV01045                                        0502 00941000
         BALR  @14,@15                                             0502 00942000
*       GEN(BALR @11,0);            /* LOAD ADDR OF REENTRY          */ 00943000
         BALR @11,0                                                     00944000
*       GEN(USING *,@11);           /* ESTABLISH ADDRESSING          */ 00945000
         USING *,@11                                                    00946000
*       GEN(L     @11,=A(@PSTART)); /* RELOAD BASE                   */ 00947000
         L     @11,=A(@PSTART)                                          00948000
*       GEN(USING @PSTART,@11);     /* ESTABLISH ADDRESSING          */ 00949000
         USING @PSTART,@11                                              00950000
*     END I23;                      /* CALL DATA INSERT.             */ 00951000
*   RAMB=AMBLIX;                    /* POINT TO INDEX AMB.           */ 00952000
@RF00500 L     @10,RPLDACB(,RRPL)                                  0508 00953000
         L     @10,ACBAMBL(,@10)                                   0508 00954000
         L     RAMB,AMBLIX(,@10)                                   0508 00955000
*   PLHSSR=ON;                      /* SET PLH SEQ. SET REQ.         */ 00956000
         OI    PLHSSR(RPLH),B'00010000'                            0509 00957000
*   RPARM1=ICWTBASE;                /* SET RBA OF NEW SEQ. SET REC.  */ 00958000
         L     @10,AMBIWA(,RAMB)                                   0510 00959000
         L     RPARM1,ICWTBASE(,@10)                               0510 00960000
*   PLHSSRBA=RPARM1;                /* INIT. PLH SEQ. SET RBA.       */ 00961000
         ST    RPARM1,PLHSSRBA(,RPLH)                              0511 00962000
*I24:                                                              0512 00963000
*   DO;                             /* IDACALL(IDAGRB)               */ 00964000
I24      DS    0H                                                  0513 00965000
*     CALL IDAGRB;                  /* EXIT TO IDAGRB                */ 00966000
         L     @15,@CV01043                                        0513 00967000
         BALR  @14,@15                                             0513 00968000
*     GEN(BALR @11,0);              /* LOAD ADDR OF REENTRY          */ 00969000
         BALR @11,0                                                     00970000
*     GEN(USING *,@11);             /* ESTABLISH ADDRESSING          */ 00971000
         USING *,@11                                                    00972000
*     GEN(L     @11,=A(@PSTART));   /* RELOAD BASE                   */ 00973000
         L     @11,=A(@PSTART)                                          00974000
*     GEN(USING @PSTART,@11);       /* ESTABLISH ADDRESSING          */ 00975000
         USING @PSTART,@11                                              00976000
*   END I24;                        /* READ NEW SEQ. SET REC.        */ 00977000
*   IF RPLERREG^='00'X THEN         /* ERROR.                        */ 00978000
         CLI   RPLERREG(RRPL),0                                    0519 00979000
         BNE   @RT00519                                            0519 00980000
*     GOTO SFEXIT;                  /* RETURN.                       */ 00981000
*   RFY                                                            0521 00982000
*     IDAIXSPL BASED(PLHISPLP);     /* BASE IXSPL ON PLH IXSPL.      */ 00983000
*   RFY                                                            0522 00984000
*    (RWORK2,                                                      0522 00985000
*     RWORK3) RSTD;                 /* GET WORK REGS.                */ 00986000
*   RWORK2=PLHIBUFC->BUFCBAD;       /* POINT TO INDEX BUFFER.        */ 00987000
         L     @10,PLHIBUFC(,RPLH)                                 0523 00988000
         L     RWORK2,BUFCBAD(,@10)                                0523 00989000
*   RWORK3=RWORK2+RWORK2->IXHLL-RWORK2->IXHFLPLN;/* POINT TO 1ST   0524 00990000
*                                      INDEX ENTRY.                  */ 00991000
         LR    RWORK3,RWORK2                                       0524 00992000
         LH    @10,IXHLL(,RWORK2)                                  0524 00993000
         N     @10,@CF01121                                        0524 00994000
         ALR   RWORK3,@10                                          0524 00995000
         SLR   @10,@10                                             0524 00996000
         IC    @10,IXHFLPLN(,RWORK2)                               0524 00997000
         SLR   RWORK3,@10                                          0524 00998000
*   IXSHEP=RWORK3;                  /* SET CURRENT POINTER.          */ 00999000
         L     @10,PLHISPLP(,RPLH)                                 0525 01000000
         ST    RWORK3,IXSHEP(,@10)                                 0525 01001000
*   IXSSEP=RWORK3;                  /* SET SECTION POINTER.          */ 01002000
         ST    RWORK3,IXSSEP(,@10)                                 0526 01003000
*   IXSLEP=RWORK3;                  /* SET LOW POINTER.              */ 01004000
         ST    RWORK3,IXSLEP(,@10)                                 0527 01005000
*   RFY                                                            0528 01006000
*    (RWORK2,                                                      0528 01007000
*     RWORK3) UNRSTD;               /* FREE WORK REGS.               */ 01008000
*   RFY                                                            0529 01009000
*     IDAIXSPL BASED(IMWIXSP);      /* RESET IXSPL BASE.             */ 01010000
*   RPARM1=ONE;                     /* INDICATE TO RE, SPLIT OR    0530 01011000
*                                      INSERT NOT REQUIRED.          */ 01012000
         LA    RPARM1,1                                            0530 01013000
*SFEXIT:                                                           0531 01014000
*   RAMB=AMBLDTA;                   /* AMB TO DATA BLOCKS            */ 01015000
SFEXIT   L     @10,RPLDACB(,RRPL)                                  0531 01016000
         L     @10,ACBAMBL(,@10)                                   0531 01017000
         L     RAMB,AMBLDTA(,@10)                                  0531 01018000
*   DIW1ST=OFF;                     /* CLEAR BEG OF SEQ SET FLAG.    */ 01019000
         L     @10,AMBIWA(,RAMB)                                   0532 01020000
         NI    DIW1ST(@10),B'11111110'                             0532 01021000
*   DIWFSPF=OFF;                    /* CLEAR NO SPLIT FLAG.          */ 01022000
         NI    DIWFSPF(@10),B'01111111'                            0533 01023000
*   GEN(IDARST14);                  /* RESTORE REG 14.               */ 01024000
         IDARST14                                                       01025000
*   RETURN;                         /* RETURN.                       */ 01026000
@EL00001 DS    0H                                                  0535 01027000
@EF00001 DS    0H                                                  0535 01028000
@ER00001 BR    @14                                                 0535 01029000
*   GEN;                                                           0536 01030000
STCMPTR  STCM  RWORK3,@00,IBFLP3(RWORK2)  STORE 1,2, OR 3 BYTE RBA PTR  01031000
ICMINS   ICM   RPARM1,@00,IBFLP3(RWORK2)  GET 1,2, OR 3 BYTE RBA PTR    01032000
*                                                                  0537 01033000
*   /*****************************************************************/ 01034000
*   /*                                                               */ 01035000
*   /* BUFFER FREE SPACE --- INPUT - RBUFC. SETS BUFFER TO FREE      */ 01036000
*   /* SPACE.                                                        */ 01037000
*   /*                                                               */ 01038000
*   /*****************************************************************/ 01039000
*                                                                  0537 01040000
*BFRFS:                                                            0537 01041000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */ 01042000
         B     @PB00002                                            0537 01043000
BFRFS    DS    0H                                                  0538 01044000
*   RFY                                                            0538 01045000
*     R14 RSTD;                     /* SAVE RETURN REG.              */ 01046000
*   RFY                                                            0539 01047000
*    (RWORK2,                                                      0539 01048000
*     RWORK3,                                                      0539 01049000
*     RWORK5) RSTD;                 /* GET WORK REGS.                */ 01050000
*   RWORK2=BUFCBAD;                 /* TO ADDRESS.                   */ 01051000
         L     RWORK2,BUFCBAD(,RBUFC)                              0540 01052000
*   RWORK3=AMDCINV;                 /* TO LENGTH.                    */ 01053000
         L     @15,AMBDSB(,RAMB)                                   0541 01054000
         L     RWORK3,AMDCINV(,@15)                                0541 01055000
*   RWORK5=ZERO;                    /* PAD CHAR.                     */ 01056000
         SLR   RWORK5,RWORK5                                       0542 01057000
*   GEN(MVCL RWORK2,RWORK4);        /* ZERO BUFFER.                  */ 01058000
         MVCL RWORK2,RWORK4                                             01059000
*   RWORK3=AMDCINV-LENGTH(IDACIDF); /* GET FS COUNT.                 */ 01060000
         L     @15,AMBDSB(,RAMB)                                   0544 01061000
         L     RWORK3,AMDCINV(,@15)                                0544 01062000
         SL    RWORK3,@CF00036                                     0544 01063000
*   RWORK5=BUFCBAD+RWORK3;          /* POINT TO CIDF.                */ 01064000
         LR    RWORK5,RWORK3                                       0545 01065000
         AL    RWORK5,BUFCBAD(,RBUFC)                              0545 01066000
*   RWORK5->CIDFLL=RWORK3;          /* SET CIDF FS LENGTH.           */ 01067000
         STH   RWORK3,CIDFLL(,RWORK5)                              0546 01068000
*   RFY                                                            0547 01069000
*    (RWORK2,                                                      0547 01070000
*     RWORK3,                                                      0547 01071000
*     RWORK5) UNRSTD;               /* FREE WORK REGS.               */ 01072000
*   RETURN;                         /* RETURN TO CALLER.             */ 01073000
@EL00002 DS    0H                                                  0548 01074000
@EF00002 DS    0H                                                  0548 01075000
@ER00002 BR    @14                                                 0548 01076000
*   RFY                                                            0549 01077000
*     R14 UNRSTD;                   /* FREE RETURN REG.              */ 01078000
*   END BFRFS;                      /* END PROC. BFRFS.              */ 01079000
@PB00002 DS    0H                                                  0551 01080000
*   GEN;                                                           0551 01081000
STOREPT  STCM  RPARM1,@00,@00(RWORK2)       STORE FS PTR.               01082000
*   GEN(IDAPATCH);                  /* DEFINE PATCH AREA             */ 01083000
         IDAPATCH                                                       01084000
*   END IDA019SF                    /* END OF CA SR SPLIT.           */ 01085000
*                                                                  0553 01086000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01087000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 01088000
*/*%INCLUDE SYSLIB  (IDARMRCD)                                       */ 01089000
*/*%INCLUDE SYSLIB  (IDAREGS )                                       */ 01090000
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */ 01091000
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */ 01092000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 01093000
*/*%INCLUDE SYSLIB  (IDADIWA )                                       */ 01094000
*/*%INCLUDE SYSLIB  (IDAPLH  )                                       */ 01095000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */ 01096000
*/*%INCLUDE SYSLIB  (IDABUFC )                                       */ 01097000
*/*%INCLUDE SYSLIB  (IDAARDB )                                       */ 01098000
*/*%INCLUDE SYSLIB  (IDAIRD  )                                       */ 01099000
*/*%INCLUDE SYSLIB  (IDAIXSPL)                                       */ 01100000
*/*%INCLUDE SYSLIB  (IDAICWA )                                       */ 01101000
*/*%INCLUDE SYSLIB  (IDAIMWA )                                       */ 01102000
*/*%INCLUDE SYSLIB  (IDACIDF )                                       */ 01103000
*/*%INCLUDE SYSLIB  (IDARDF  )                                       */ 01104000
*                                                                  0553 01105000
*       ;                                                          0553 01106000
         B     @EL00001                                            0553 01107000
@DATA    DS    0H                                                       01108000
@SC01122 CLC   KEY(0,@15),KEY(@05)                                      01109000
@SM01124 MVC   KEY(0,RWORK2),KEY(@10)                                   01110000
@SM01126 MVC   ICWKEY1(0,@14),KEY(@10)                                  01111000
@SM01129 MVC   KEY(0,RWORK2),KEY(RWORK3)                                01112000
@SM01131 MVC   ICWKEY1(0,@05),KEY(RWORK3)                               01113000
@DATD    DSECT                                                          01114000
         DS    0F                                                       01115000
IDA019SF CSECT                                                          01116000
         DS    0F                                                       01117000
@CF00047 DC    F'1'                                                     01118000
@CH00047 EQU   @CF00047+2                                               01119000
@CF00036 DC    F'4'                                                     01120000
@CF00170 DC    F'7'                                                     01121000
@CF01041 DC    F'256'                                                   01122000
@CF01072 DC    XL4'FF000000'                                            01123000
@CF01121 DC    XL4'0000FFFF'                                            01124000
@DATD    DSECT                                                          01125000
         DS    0D                                                       01126000
IDA019SF CSECT                                                          01127000
         DS    0F                                                       01128000
@SIZDATD DC    AL1(0)                                                   01129000
         DC    AL3(@ENDDATD-@DATD)                                      01130000
@CV01042 DC    V(IDAGNNFL)                                              01131000
@CV01043 DC    V(IDAGRB)                                                01132000
@CV01044 DC    V(IDAFREEB)                                              01133000
@CV01045 DC    V(IDA019RM)                                              01134000
@CV01046 DC    V(IDA019RV)                                              01135000
@CV01047 DC    V(IDAHLINS)                                              01136000
@CV01048 DC    V(IDAABF)                                                01137000
@CV01049 DC    V(IDAWRBFR)                                              01138000
@CV01050 DC    V(IDANEWRD)                                              01139000
@CV01051 DC    V(IDAEOVIF)                                              01140000
@CV01052 DC    V(IDASBF)                                                01141000
         DS    0D                                                       01142000
HWORD4   DC    H'4'                                                     01143000
@DATD    DSECT                                                          01144000
*                                                          /*@X04SVLC*/ 01145000
RDFCTNUA EQU   X'40'                    COMPLEX RDF INDICATOR           01146000
RDFCTNUX EQU   X'FF'-RDFCTNUA           RESET COMPLEX MASK              01147000
RDFREPLA EQU   X'08'                    COUNT RDF INDICATOR             01148000
RDFREPLX EQU   X'FF'-RDFREPLA           RESET COUNT MASK                01149000
RDFEMPTI EQU   X'04'                    EMPTY RECORD       /*@X04SVLC*/ 01150000
RDFLEN   EQU   3                        LENGTH OF RDF                   01151000
RDFLLOFF EQU   1                        OFFSET WITHIN RDF TO LL         01152000
RDFSGLR  EQU   X'00'                   MASK FOR SINGLE RECORD RDF       01153000
RDFGRP   EQU   RDFCTNUA                 MASK FOR LL RDF OF A GROUP RDF  01154000
RDFCNT   EQU   RDFREPLA                 MASK FOR COUNT RDF              01155000
@DATD    DSECT                                                          01156000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01157000
@ENDDATD EQU   *                                                        01158000
IDA019SF CSECT                                                          01159000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01160000
@01      EQU   01                                                       01161000
@02      EQU   02                                                       01162000
@03      EQU   03                                                       01163000
@04      EQU   04                                                       01164000
@05      EQU   05                                                       01165000
@06      EQU   06                                                       01166000
@07      EQU   07                                                       01167000
@08      EQU   08                                                       01168000
@09      EQU   09                                                       01169000
@10      EQU   10                                                       01170000
@11      EQU   11                                                       01171000
@12      EQU   12                                                       01172000
@13      EQU   13                                                       01173000
@14      EQU   14                                                       01174000
@15      EQU   15                                                       01175000
RWORK0   EQU   @00                                                      01176000
RRPL     EQU   @01                                                      01177000
RPLH     EQU   @02                                                      01178000
RAMB     EQU   @03                                                      01179000
RBUFC    EQU   @04                                                      01180000
RWORK1   EQU   @05                                                      01181000
RWORK2   EQU   @06                                                      01182000
RWORK3   EQU   @07                                                      01183000
RWORK4   EQU   @08                                                      01184000
RWORK5   EQU   @09                                                      01185000
RPARM1   EQU   @12                                                      01186000
R14      EQU   @14                                                      01187000
R15      EQU   @15                                                      01188000
R1       EQU   @01                                                      01189000
R10      EQU   @10                                                      01190000
R11      EQU   @11                                                      01191000
R13      EQU   @13                                                      01192000
IFGRPL   EQU   0                                                        01193000
RPLCOMN  EQU   IFGRPL                                                   01194000
RPLIDWD  EQU   RPLCOMN                                                  01195000
RPLLEN   EQU   RPLIDWD+3                                                01196000
RPLECB   EQU   RPLCOMN+8                                                01197000
RPLFDBWD EQU   RPLCOMN+12                                               01198000
RPLFDBK  EQU   RPLFDBWD+1                                               01199000
RPLRTNCD EQU   RPLFDBK                                                  01200000
RPLERREG EQU   RPLRTNCD                                                 01201000
RPLCNDCD EQU   RPLFDBK+1                                                01202000
RPLCMPON EQU   RPLCNDCD                                                 01203000
RPLFDB2  EQU   RPLCMPON                                                 01204000
RPLERRCD EQU   RPLCNDCD+1                                               01205000
RPLFDB3  EQU   RPLERRCD                                                 01206000
RPLKEYLE EQU   RPLCOMN+16                                               01207000
RPLDACB  EQU   RPLCOMN+24                                               01208000
RPLAREA  EQU   RPLCOMN+32                                               01209000
RPLARG   EQU   RPLCOMN+36                                               01210000
RPLOPTCD EQU   RPLCOMN+40                                               01211000
RPLOPT1  EQU   RPLOPTCD                                                 01212000
RPLECBSW EQU   RPLOPT1                                                  01213000
RPLOPT2  EQU   RPLOPTCD+1                                               01214000
RPLADR   EQU   RPLOPT2                                                  01215000
RPLOPT3  EQU   RPLOPTCD+2                                               01216000
RPLNXTRP EQU   RPLCOMN+44                                               01217000
RPLRLEN  EQU   RPLCOMN+48                                               01218000
RPLOPTC2 EQU   RPLCOMN+56                                               01219000
RPLOPT5  EQU   RPLOPTC2                                                 01220000
RPLWRTYP EQU   RPLOPT5                                                  01221000
RPLOPT6  EQU   RPLOPTC2+1                                               01222000
RPLUNTYP EQU   RPLOPT6                                                  01223000
RPLOPT7  EQU   RPLOPTC2+2                                               01224000
RPLCNOPT EQU   RPLOPT7                                                  01225000
RPLOPT8  EQU   RPLOPTC2+3                                               01226000
RPLRBAR  EQU   RPLCOMN+60                                               01227000
RPLAIXID EQU   RPLRBAR+2                                                01228000
RPLEXTDS EQU   RPLCOMN+68                                               01229000
RPLEXTD1 EQU   RPLEXTDS                                                 01230000
IDAAMB   EQU   0                                                        01231000
AMBBUFC  EQU   IDAAMB+8                                                 01232000
AMBDSB   EQU   IDAAMB+20                                                01233000
AMBEOVR  EQU   IDAAMB+24                                                01234000
AMBFLG0  EQU   AMBEOVR                                                  01235000
AMBFLG1  EQU   IDAAMB+25                                                01236000
AMBDSORG EQU   IDAAMB+26                                                01237000
AMBIOBAD EQU   IDAAMB+28                                                01238000
AMBINFL  EQU   IDAAMB+42                                                01239000
AMBDEBPT EQU   IDAAMB+44                                                01240000
AMBOFLGS EQU   IDAAMB+48                                                01241000
AMBFLG2  EQU   IDAAMB+49                                                01242000
AMBEOVPT EQU   IDAAMB+56                                                01243000
AMBIWA   EQU   IDAAMB+64                                                01244000
AMBCSWD1 EQU   IDAAMB+84                                                01245000
AMBAFLG  EQU   AMBCSWD1                                                 01246000
IDAAMBL  EQU   0                                                        01247000
AMBLEOV  EQU   IDAAMBL+12                                               01248000
AMBLEFLG EQU   AMBLEOV                                                  01249000
AMBLDDNM EQU   IDAAMBL+16                                               01250000
AMBLIDF  EQU   AMBLDDNM                                                 01251000
AMBLQ    EQU   AMBLIDF+7                                                01252000
AMBLVC   EQU   IDAAMBL+28                                               01253000
AMBLTYPE EQU   IDAAMBL+30                                               01254000
AMBLSHAR EQU   IDAAMBL+33                                               01255000
AMBLFLG1 EQU   IDAAMBL+35                                               01256000
AMBLFLG2 EQU   IDAAMBL+36                                               01257000
AMBLDTA  EQU   IDAAMBL+52                                               01258000
AMBLIX   EQU   IDAAMBL+56                                               01259000
IFGACB   EQU   0                                                        01260000
ACBCOMN  EQU   IFGACB                                                   01261000
ACBLENG  EQU   ACBCOMN+2                                                01262000
ACBLENG2 EQU   ACBLENG                                                  01263000
ACBAMBL  EQU   ACBCOMN+4                                                01264000
ACBJWA   EQU   ACBAMBL                                                  01265000
ACBMACRF EQU   ACBCOMN+12                                               01266000
ACBMACR1 EQU   ACBMACRF                                                 01267000
ACBADR   EQU   ACBMACR1                                                 01268000
ACBCNV   EQU   ACBMACR1                                                 01269000
ACBMACR2 EQU   ACBMACRF+1                                               01270000
ACBBUFPL EQU   ACBCOMN+20                                               01271000
ACBMACR3 EQU   ACBBUFPL                                                 01272000
ACBRECFM EQU   ACBCOMN+24                                               01273000
ACBCCTYP EQU   ACBCOMN+25                                               01274000
ACBOPT   EQU   ACBCOMN+26                                               01275000
ACBDSORG EQU   ACBOPT                                                   01276000
ACBCROPS EQU   ACBDSORG                                                 01277000
ACBEXLST EQU   ACBCOMN+36                                               01278000
ACBDDNM  EQU   ACBCOMN+40                                               01279000
ACBAMETH EQU   ACBDDNM+3                                                01280000
ACBOFLGS EQU   ACBCOMN+48                                               01281000
ACBEXFG  EQU   ACBOFLGS                                                 01282000
ACBIOSFG EQU   ACBOFLGS                                                 01283000
ACBINFLG EQU   ACBCOMN+50                                               01284000
ACBUJFCB EQU   ACBCOMN+52                                               01285000
ACBBLKSZ EQU   ACBCOMN+60                                               01286000
IDADIWA  EQU   0                                                        01287000
DIWFLG1  EQU   IDADIWA+4                                                01288000
DIW1ST   EQU   DIWFLG1                                                  01289000
DIWFLG2  EQU   IDADIWA+5                                                01290000
DIWFSPF  EQU   DIWFLG2                                                  01291000
DIWSAVE  EQU   IDADIWA+28                                               01292000
DIWSAVE1 EQU   DIWSAVE                                                  01293000
DIWSAVE2 EQU   DIWSAVE+4                                                01294000
DIWSAVE4 EQU   DIWSAVE+12                                               01295000
IDAPLHDR EQU   0                                                        01296000
IDAPLH   EQU   0                                                        01297000
PLHFLG1  EQU   IDAPLH+2                                                 01298000
PLHASKBF EQU   PLHFLG1                                                  01299000
PLHSSR   EQU   PLHFLG1                                                  01300000
PLHFLG2  EQU   IDAPLH+3                                                 01301000
PLHADDTE EQU   PLHFLG2                                                  01302000
PLHEFLGS EQU   IDAPLH+4                                                 01303000
PLHFLG3  EQU   IDAPLH+6                                                 01304000
PLHAFLGS EQU   IDAPLH+7                                                 01305000
PLHCRBA  EQU   IDAPLH+28                                                01306000
PLHJORBA EQU   PLHCRBA                                                  01307000
PLHJCODE EQU   IDAPLH+40                                                01308000
PLHEOVR  EQU   IDAPLH+42                                                01309000
PLHARDB  EQU   IDAPLH+44                                                01310000
PLHDBUFC EQU   IDAPLH+52                                                01311000
PLHRECP  EQU   IDAPLH+60                                                01312000
PLHFSP   EQU   IDAPLH+64                                                01313000
PLHRDFP  EQU   IDAPLH+68                                                01314000
PLHDIOB  EQU   IDAPLH+76                                                01315000
PLHRETO  EQU   IDAPLH+116                                               01316000
PLHRET1  EQU   IDAPLH+120                                               01317000
PLHEOVPT EQU   IDAPLH+180                                               01318000
PLHIBUFC EQU   IDAPLH+188                                               01319000
PLHISPLP EQU   IDAPLH+196                                               01320000
PLHIXSPL EQU   IDAPLH+200                                               01321000
PLHSSRBA EQU   PLHIXSPL                                                 01322000
PLHWAX   EQU   IDAPLH+232                                               01323000
PLHKEYPT EQU   IDAPLH+248                                               01324000
PLHEND   EQU   IDAPLH+280                                               01325000
IDAAMDSB EQU   0                                                        01326000
AMDATTR  EQU   IDAAMDSB+1                                               01327000
AMDRANGE EQU   AMDATTR                                                  01328000
AMDNEST  EQU   IDAAMDSB+4                                               01329000
AMDRKP   EQU   IDAAMDSB+6                                               01330000
AMDKEYLN EQU   IDAAMDSB+8                                               01331000
AMDCIPCA EQU   IDAAMDSB+12                                              01332000
AMDCINV  EQU   IDAAMDSB+20                                              01333000
AMDHLRBA EQU   IDAAMDSB+28                                              01334000
AMDSSRBA EQU   IDAAMDSB+32                                              01335000
AMDATTR3 EQU   IDAAMDSB+40                                              01336000
AMDSTAT  EQU   IDAAMDSB+48                                              01337000
IDABUFDR EQU   0                                                        01338000
BUFDRCIX EQU   IDABUFDR+9                                               01339000
BUFDRFLG EQU   IDABUFDR+11                                              01340000
IDABUFC  EQU   0                                                        01341000
BUFCAVL  EQU   IDABUFC                                                  01342000
BUFCFLG1 EQU   IDABUFC+1                                                01343000
BUFCVAL  EQU   BUFCFLG1                                                 01344000
BUFCEXC  EQU   BUFCFLG1                                                 01345000
BUFCIOFL EQU   IDABUFC+2                                                01346000
BUFCMW   EQU   BUFCIOFL                                                 01347000
BUFCFLG2 EQU   IDABUFC+3                                                01348000
BUFCPLH  EQU   IDABUFC+4                                                01349000
BUFCDDDD EQU   IDABUFC+8                                                01350000
BUFCORBA EQU   IDABUFC+12                                               01351000
BUFCBAD  EQU   IDABUFC+20                                               01352000
BUFCINV  EQU   IDABUFC+28                                               01353000
BUFXIRBA EQU   IDABUFC+40                                               01354000
IDAARDB  EQU   0                                                        01355000
ARDTYPE  EQU   IDAARDB+1                                                01356000
ARDHKRBA EQU   IDAARDB+8                                                01357000
ARDPRF   EQU   IDAARDB+28                                               01358000
ARDKEYS  EQU   IDAARDB+29                                               01359000
IDAIXH   EQU   0                                                        01360000
IXHLL    EQU   IDAIXH                                                   01361000
IXHFLPLN EQU   IDAIXH+2                                                 01362000
IXHPTLS  EQU   IDAIXH+3                                                 01363000
IXHBRBA  EQU   IDAIXH+4                                                 01364000
IXHHP    EQU   IDAIXH+8                                                 01365000
IXHLV    EQU   IDAIXH+16                                                01366000
IXHFSO   EQU   IDAIXH+18                                                01367000
IXHLEO   EQU   IDAIXH+20                                                01368000
IXHSEO   EQU   IDAIXH+22                                                01369000
IDAIBFLP EQU   0                                                        01370000
IBFLPF   EQU   IDAIBFLP                                                 01371000
IBFLPL   EQU   IDAIBFLP+1                                               01372000
IBFLP3   EQU   IDAIBFLP+2                                               01373000
IBFLP2   EQU   IBFLP3                                                   01374000
IDASELL  EQU   0                                                        01375000
IDAIXK   EQU   0                                                        01376000
IDAIXSPL EQU   0                                                        01377000
IXSBUFC  EQU   IDAIXSPL+4                                               01378000
IXSBFLG  EQU   IDAIXSPL+17                                              01379000
IXSHEP   EQU   IDAIXSPL+20                                              01380000
IXSSEP   EQU   IDAIXSPL+24                                              01381000
IXSLEP   EQU   IDAIXSPL+28                                              01382000
IDAICWA  EQU   0                                                        01383000
ICWFLG1  EQU   IDAICWA+1                                                01384000
ICWKRDS  EQU   ICWFLG1                                                  01385000
ICWCHN   EQU   IDAICWA+4                                                01386000
ICWCRBA  EQU   IDAICWA+12                                               01387000
ICWPRBA  EQU   IDAICWA+16                                               01388000
ICWADD   EQU   IDAICWA+24                                               01389000
ICWTBASE EQU   IDAICWA+28                                               01390000
ICWTPTR  EQU   IDAICWA+32                                               01391000
ICWLN    EQU   IDAICWA+40                                               01392000
ICWKEY1L EQU   IDAICWA+42                                               01393000
ICWPTL   EQU   IDAICWA+55                                               01394000
ICWKEY1  EQU   IDAICWA+60                                               01395000
IDAIMWA  EQU   0                                                        01396000
IMWFLAGS EQU   IDAIMWA+1                                                01397000
IMWIXSP  EQU   IDAIMWA+4                                                01398000
IMWISWKA EQU   IDAIMWA+8                                                01399000
IMWBUFP  EQU   IDAIMWA+60                                               01400000
IDACIDF  EQU   0                                                        01401000
CIDFLL   EQU   IDACIDF+2                                                01402000
IDARDF   EQU   0                                                        01403000
RDFRBYTE EQU   IDARDF                                                   01404000
RDFSEG   EQU   RDFRBYTE                                                 01405000
IDADATA  EQU   0                                                        01406000
IDAKEY   EQU   0                                                        01407000
KEY      EQU   IDAKEY                                                   01408000
ICWKEY2  EQU   0                                                        01409000
ICWKEY3  EQU   0                                                        01410000
PLHKEY   EQU   0                                                        01411000
PLHPDL   EQU   0                                                        01412000
PLHPDLE  EQU   0                                                        01413000
PLHRRN   EQU   0                                                        01414000
PLHEXTEN EQU   PLHEND                                                   01415000
PLHBMWRK EQU   PLHEXTEN+5                                               01416000
BUFCRSC1 EQU   BUFCAVL                                                  01417000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01418000
PLHBMSV5 EQU   PLHEXTEN+24                                              01419000
PLHBMSV4 EQU   PLHEXTEN+20                                              01420000
PLHBMSV3 EQU   PLHEXTEN+16                                              01421000
PLHBMSV2 EQU   PLHEXTEN+12                                              01422000
PLHBMSV1 EQU   PLHEXTEN+8                                               01423000
PLHRDCNT EQU   PLHEXTEN+6                                               01424000
PLHBMSOV EQU   PLHBMWRK                                                 01425000
PLHBEUC  EQU   PLHBMWRK                                                 01426000
PLHBMRDF EQU   PLHBMWRK                                                 01427000
@NM00051 EQU   PLHEXTEN+4                                               01428000
PLHRESR1 EQU   PLHEXTEN                                                 01429000
AMDATA   EQU   IDADATA                                                  01430000
RDFLL    EQU   IDARDF+1                                                 01431000
RDFEMPTY EQU   RDFRBYTE                                                 01432000
RDFREPL  EQU   RDFRBYTE                                                 01433000
RDF1ST   EQU   RDFSEG                                                   01434000
RDFNOT1  EQU   RDFSEG                                                   01435000
RDFCTNU  EQU   RDFRBYTE                                                 01436000
RDFTYPE  EQU   RDFRBYTE                                                 01437000
@NM00061 EQU   CIDFLL                                                   01438000
CIDFBUSY EQU   CIDFLL                                                   01439000
CIDFOSET EQU   IDACIDF                                                  01440000
IMWKEY1  EQU   IDAIMWA+76                                               01441000
@NM00060 EQU   IDAIMWA+72                                               01442000
IMWNSOFF EQU   IDAIMWA+70                                               01443000
IMWCIMVN EQU   IDAIMWA+68                                               01444000
@NM00059 EQU   IDAIMWA+67                                               01445000
IMWSVIEL EQU   IDAIMWA+66                                               01446000
IMWIEL   EQU   IDAIMWA+65                                               01447000
IMWFGAIN EQU   IDAIMWA+64                                               01448000
IMWLBUFC EQU   IDAIMWA+56                                               01449000
IMWIPTR  EQU   IDAIMWA+52                                               01450000
IMWXPTR  EQU   IDAIMWA+48                                               01451000
IMWIKEYP EQU   IDAIMWA+44                                               01452000
IMWXKEYP EQU   IDAIMWA+40                                               01453000
IMWLEN   EQU   IDAIMWA+2                                                01454000
IMWBSE   EQU   IMWFLAGS                                                 01455000
IMWRIPL  EQU   IMWFLAGS                                                 01456000
IMWNEWHL EQU   IMWFLAGS                                                 01457000
IMWID    EQU   IDAIMWA                                                  01458000
ICWCERP  EQU   IDAICWA+59                                               01459000
ICWCEL   EQU   IDAICWA+58                                               01460000
ICWCEF   EQU   IDAICWA+57                                               01461000
ICWCER   EQU   IDAICWA+56                                               01462000
ICWREQ   EQU   IDAICWA+54                                               01463000
ICWCRSEG EQU   IDAICWA+52                                               01464000
ICWNOSEG EQU   IDAICWA+50                                               01465000
ICWNEST  EQU   IDAICWA+48                                               01466000
ICWKEY3L EQU   IDAICWA+46                                               01467000
ICWKEY2L EQU   IDAICWA+44                                               01468000
ICWARDBP EQU   IDAICWA+36                                               01469000
ICWSCNT  EQU   IDAICWA+22                                               01470000
ICWPSEO  EQU   IDAICWA+20                                               01471000
ICWBUFC  EQU   IDAICWA+8                                                01472000
ICWLEN   EQU   IDAICWA+2                                                01473000
ICWENDRQ EQU   ICWFLG1                                                  01474000
ICWSPLIT EQU   ICWFLG1                                                  01475000
ICWVNE   EQU   ICWFLG1                                                  01476000
ICWVSE   EQU   ICWFLG1                                                  01477000
ICWRBAOK EQU   ICWFLG1                                                  01478000
ICWWAGM  EQU   ICWFLG1                                                  01479000
ICWWNF   EQU   ICWFLG1                                                  01480000
ICWID    EQU   IDAICWA                                                  01481000
IXSPEC   EQU   IDAIXSPL+19                                              01482000
IXSEKON  EQU   IDAIXSPL+18                                              01483000
@NM00058 EQU   IXSBFLG                                                  01484000
IXSLELV  EQU   IXSBFLG                                                  01485000
IXSSSRH  EQU   IXSBFLG                                                  01486000
IXSNOSR  EQU   IDAIXSPL+16                                              01487000
IXSKLEN  EQU   IDAIXSPL+14                                              01488000
IXSILN   EQU   IDAIXSPL+13                                              01489000
IXSTLN   EQU   IDAIXSPL+12                                              01490000
IXSARG   EQU   IDAIXSPL+8                                               01491000
IXSSTRBA EQU   IDAIXSPL                                                 01492000
IXKEY    EQU   IDAIXK                                                   01493000
IXSELL   EQU   IDASELL                                                  01494000
IBFLP1   EQU   IBFLP2                                                   01495000
IXHFLGS  EQU   IDAIXH+17                                                01496000
IXHXX    EQU   IDAIXH+12                                                01497000
@NM00057 EQU   ARDPRF                                                   01498000
ARDPRFMT EQU   ARDPRF                                                   01499000
ARDPRSS  EQU   ARDPRF                                                   01500000
ARDRELNO EQU   IDAARDB+26                                               01501000
ARDVOLSR EQU   IDAARDB+20                                               01502000
ARDERBA  EQU   IDAARDB+16                                               01503000
ARDHRBA  EQU   IDAARDB+12                                               01504000
ARDNPTR  EQU   IDAARDB+4                                                01505000
ARDLEN   EQU   IDAARDB+2                                                01506000
ARDUSED  EQU   ARDTYPE                                                  01507000
ARDEOD   EQU   ARDTYPE                                                  01508000
ARDUOVFL EQU   ARDTYPE                                                  01509000
ARDSS    EQU   ARDTYPE                                                  01510000
ARDHLI   EQU   ARDTYPE                                                  01511000
ARDKR    EQU   ARDTYPE                                                  01512000
ARDID    EQU   IDAARDB                                                  01513000
BUFCEND  EQU   IDABUFC+64                                               01514000
BUFCUCDN EQU   IDABUFC+60                                               01515000
BUFCUCUP EQU   IDABUFC+56                                               01516000
BUFCMDBT EQU   IDABUFC+52                                               01517000
BUFCHAIN EQU   IDABUFC+48                                               01518000
BUFXORBA EQU   IDABUFC+44                                               01519000
BUFCNXT2 EQU   IDABUFC+37                                               01520000
BUFCIDXL EQU   IDABUFC+36                                               01521000
BUFCDSPC EQU   IDABUFC+32                                               01522000
BUFCWLEN EQU   BUFCINV                                                  01523000
BUFCNXT1 EQU   IDABUFC+24                                               01524000
BUFCCPA  EQU   IDABUFC+16                                               01525000
BUFCAMB  EQU   BUFCPLH                                                  01526000
@NM00056 EQU   BUFCFLG2                                                 01527000
BUFCEOD  EQU   BUFCFLG2                                                 01528000
BUFCBSYW EQU   BUFCFLG2                                                 01529000
BUFCBSYR EQU   BUFCFLG2                                                 01530000
BUFCNLAS EQU   BUFCFLG2                                                 01531000
BUFCXDDR EQU   BUFCFLG2                                                 01532000
BUFCFIX  EQU   BUFCIOFL                                                 01533000
BUFCPFCP EQU   BUFCIOFL                                                 01534000
BUFCXEDB EQU   BUFCIOFL                                                 01535000
BUFCWC   EQU   BUFCIOFL                                                 01536000
BUFCREAL EQU   BUFCIOFL                                                 01537000
BUFCRRD  EQU   BUFCIOFL                                                 01538000
BUFCFMT  EQU   BUFCIOFL                                                 01539000
BUFCEPT  EQU   BUFCFLG1                                                 01540000
BUFCER2  EQU   BUFCFLG1                                                 01541000
BUFCER1  EQU   BUFCFLG1                                                 01542000
BUFCINS  EQU   BUFCFLG1                                                 01543000
BUFCSEG  EQU   BUFCFLG1                                                 01544000
BUFCUPG  EQU   BUFCFLG1                                                 01545000
BUFCUCNT EQU   BUFCAVL                                                  01546000
@NM00055 EQU   IDABUFDR+16                                              01547000
BUFDBUFC EQU   IDABUFDR+12                                              01548000
@NM00054 EQU   BUFDRFLG                                                 01549000
BUFDRAVL EQU   BUFDRFLG                                                 01550000
BUFDRREL EQU   BUFDRFLG                                                 01551000
BUFDRTSB EQU   IDABUFDR+10                                              01552000
BUFDRMAX EQU   BUFDRCIX                                                 01553000
BUFDRPFN EQU   IDABUFDR+8                                               01554000
BUFDRPFB EQU   IDABUFDR+4                                               01555000
BUFDRLEN EQU   IDABUFDR+2                                               01556000
BUFDRNO  EQU   IDABUFDR+1                                               01557000
BUFDRID  EQU   IDABUFDR                                                 01558000
AMDEXCP  EQU   AMDSTAT+44                                               01559000
AMDNCAS  EQU   AMDSTAT+40                                               01560000
AMDNCIS  EQU   AMDSTAT+36                                               01561000
AMDASPA  EQU   AMDSTAT+32                                               01562000
AMDRETR  EQU   AMDSTAT+28                                               01563000
AMDUPR   EQU   AMDSTAT+24                                               01564000
AMDIREC  EQU   AMDSTAT+20                                               01565000
AMDDELR  EQU   AMDSTAT+16                                               01566000
AMDNLR   EQU   AMDSTAT+12                                               01567000
AMDNEXT  EQU   AMDSTAT+10                                               01568000
AMDNIL   EQU   AMDSTAT+8                                                01569000
AMDSTSP  EQU   AMDSTAT                                                  01570000
@NM00053 EQU   IDAAMDSB+41                                              01571000
@NM00052 EQU   AMDATTR3                                                 01572000
AMDLM    EQU   AMDATTR3                                                 01573000
AMDWAIT  EQU   AMDATTR3                                                 01574000
AMDBIND  EQU   AMDATTR3                                                 01575000
AMDFAULT EQU   AMDATTR3                                                 01576000
AMDUNQ   EQU   AMDATTR3                                                 01577000
AMDPARDB EQU   IDAAMDSB+36                                              01578000
AMDMAXRR EQU   AMDSSRBA                                                 01579000
AMDNSLOT EQU   AMDHLRBA                                                 01580000
AMDLRECL EQU   IDAAMDSB+24                                              01581000
AMDFSCI  EQU   IDAAMDSB+16                                              01582000
AMDFSCA  EQU   IDAAMDSB+14                                              01583000
AMDPCTCI EQU   IDAAMDSB+11                                              01584000
AMDPCTCA EQU   IDAAMDSB+10                                              01585000
AMDAXRKP EQU   AMDNEST                                                  01586000
AMDLEN   EQU   IDAAMDSB+2                                               01587000
AMDSPAN  EQU   AMDATTR                                                  01588000
AMDRRDS  EQU   AMDATTR                                                  01589000
AMDORDER EQU   AMDATTR                                                  01590000
AMDREPL  EQU   AMDATTR                                                  01591000
AMDSDT   EQU   AMDATTR                                                  01592000
AMDWCK   EQU   AMDATTR                                                  01593000
AMDDST   EQU   AMDATTR                                                  01594000
AMDSBID  EQU   IDAAMDSB                                                 01595000
PLHERRET EQU   IDAPLH+276                                               01596000
PLHASCB  EQU   IDAPLH+272                                               01597000
PLHECB   EQU   IDAPLH+268                                               01598000
@NM00050 EQU   IDAPLH+265                                               01599000
PLHDRMSK EQU   IDAPLH+264                                               01600000
PLHR13   EQU   IDAPLH+260                                               01601000
PLHPARM1 EQU   IDAPLH+256                                               01602000
PLHDRRSC EQU   IDAPLH+252                                               01603000
PLHSLRBA EQU   IDAPLH+244                                               01604000
PLHSRCSG EQU   IDAPLH+242                                               01605000
PLHNOSEG EQU   IDAPLH+240                                               01606000
PLHLLOR  EQU   IDAPLH+236                                               01607000
PLHXPLH  EQU   PLHWAX                                                   01608000
@NM00049 EQU   PLHIXSPL+8                                               01609000
PLHIXBFC EQU   PLHIXSPL+4                                               01610000
PLHHIREC EQU   PLHSSRBA                                                 01611000
PLHRBUFC EQU   IDAPLH+192                                               01612000
PLHNRBA  EQU   IDAPLH+184                                               01613000
PLHDDDD  EQU   PLHEOVPT                                                 01614000
PLHAR14  EQU   IDAPLH+176                                               01615000
@NM00048 EQU   IDAPLH+172                                               01616000
@NM00047 EQU   IDAPLH+168                                               01617000
PLHASAVE EQU   IDAPLH+164                                               01618000
PLHRETOS EQU   IDAPLH+118                                               01619000
PLHCHAIN EQU   IDAPLH+112                                               01620000
PLHAMB   EQU   IDAPLH+108                                               01621000
PLHSAVE6 EQU   IDAPLH+104                                               01622000
PLHSAVE5 EQU   IDAPLH+100                                               01623000
PLHSAVE4 EQU   IDAPLH+96                                                01624000
PLHSAVE3 EQU   IDAPLH+92                                                01625000
PLHSAVE2 EQU   IDAPLH+88                                                01626000
PLHSAVE1 EQU   IDAPLH+84                                                01627000
PLHARET  EQU   IDAPLH+80                                                01628000
PLHIIOB  EQU   PLHDIOB                                                  01629000
PLHSRSID EQU   IDAPLH+74                                                01630000
PLHRDFC  EQU   IDAPLH+72                                                01631000
PLHNBUFC EQU   IDAPLH+56                                                01632000
PLHLRECL EQU   IDAPLH+48                                                01633000
@NM00046 EQU   IDAPLH+43                                                01634000
PLHRCODE EQU   IDAPLH+41                                                01635000
PLHUCODE EQU   PLHJCODE                                                 01636000
PLHJNRBA EQU   IDAPLH+36                                                01637000
PLHJRNLL EQU   IDAPLH+32                                                01638000
PLHUPECB EQU   PLHJORBA                                                 01639000
PLHDSIDA EQU   IDAPLH+24                                                01640000
PLHCRPL  EQU   IDAPLH+20                                                01641000
PLHMRPL  EQU   IDAPLH+16                                                01642000
PLHBFRNO EQU   IDAPLH+15                                                01643000
PLHFRCNT EQU   IDAPLH+14                                                01644000
PLHRMIN  EQU   IDAPLH+13                                                01645000
PLHDSTYP EQU   IDAPLH+12                                                01646000
PLHACB   EQU   IDAPLH+8                                                 01647000
PLHRAE   EQU   PLHAFLGS                                                 01648000
PLHRABWD EQU   PLHAFLGS                                                 01649000
PLHIOSID EQU   PLHAFLGS                                                 01650000
PLHDBDC  EQU   PLHAFLGS                                                 01651000
PLHVAMB  EQU   PLHAFLGS                                                 01652000
PLHIOSRQ EQU   PLHAFLGS                                                 01653000
PLHDRLM  EQU   PLHAFLGS                                                 01654000
PLHEOVDF EQU   PLHFLG3                                                  01655000
PLHRVRS  EQU   PLHFLG3                                                  01656000
PLHBWD   EQU   PLHFLG3                                                  01657000
PLHSLVLD EQU   PLHFLG3                                                  01658000
PLHRAHD  EQU   PLHFLG3                                                  01659000
PLHSRBSG EQU   PLHFLG3                                                  01660000
@NM00045 EQU   PLHEFLGS+1                                               01661000
PLHRSTRT EQU   PLHEFLGS+1                                               01662000
PLHDSCAN EQU   PLHEFLGS                                                 01663000
PLHINVAL EQU   PLHEFLGS                                                 01664000
PLHEODX  EQU   PLHEFLGS                                                 01665000
PLHNOADV EQU   PLHEFLGS                                                 01666000
PLHSRINV EQU   PLHEFLGS                                                 01667000
PLHSKPER EQU   PLHEFLGS                                                 01668000
PLH1ST   EQU   PLHEFLGS                                                 01669000
PLHNOSPC EQU   PLHEFLGS                                                 01670000
PLHIWAIT EQU   PLHFLG2                                                  01671000
PLHSVADV EQU   PLHFLG2                                                  01672000
PLHCIINS EQU   PLHFLG2                                                  01673000
PLHKRE   EQU   PLHFLG2                                                  01674000
PLHKEYMD EQU   PLHFLG2                                                  01675000
PLHSQINS EQU   PLHFLG2                                                  01676000
PLHUPD   EQU   PLHFLG2                                                  01677000
@NM00044 EQU   PLHFLG1                                                  01678000
PLHDRPND EQU   PLHFLG1                                                  01679000
PLHASYRQ EQU   PLHFLG1                                                  01680000
PLHRDEXC EQU   PLHFLG1                                                  01681000
PLHENDRQ EQU   PLHFLG1                                                  01682000
PLHEOVW  EQU   PLHFLG1                                                  01683000
PLHATV   EQU   IDAPLH+1                                                 01684000
PLHAVL   EQU   IDAPLH                                                   01685000
PLHIOSDQ EQU   IDAPLHDR+12                                              01686000
PLHDRCUR EQU   IDAPLHDR+10                                              01687000
PLHDRMAX EQU   IDAPLHDR+8                                               01688000
PLHDRREQ EQU   IDAPLHDR+4                                               01689000
PLHELTH  EQU   IDAPLHDR+2                                               01690000
PLHCNT   EQU   IDAPLHDR+1                                               01691000
PLHID    EQU   IDAPLHDR                                                 01692000
@NM00043 EQU   IDADIWA+92                                               01693000
@NM00042 EQU   IDADIWA+88                                               01694000
@NM00041 EQU   IDADIWA+84                                               01695000
@NM00040 EQU   IDADIWA+80                                               01696000
@NM00039 EQU   IDADIWA+76                                               01697000
@NM00038 EQU   IDADIWA+72                                               01698000
@NM00037 EQU   IDADIWA+68                                               01699000
@NM00036 EQU   IDADIWA+64                                               01700000
@NM00035 EQU   IDADIWA+60                                               01701000
@NM00034 EQU   IDADIWA+56                                               01702000
DIWINRBA EQU   IDADIWA+52                                               01703000
DIWRKCT  EQU   IDADIWA+48                                               01704000
DIWSAVE5 EQU   DIWSAVE+16                                               01705000
DIWSAVE3 EQU   DIWSAVE+8                                                01706000
DIWSPLTP EQU   IDADIWA+24                                               01707000
DIWBUFC  EQU   IDADIWA+20                                               01708000
DIWPLH   EQU   IDADIWA+16                                               01709000
DIWHRBA  EQU   IDADIWA+12                                               01710000
DIWLRBA  EQU   IDADIWA+8                                                01711000
@NM00033 EQU   IDADIWA+6                                                01712000
DIWNOT1  EQU   DIWFLG1                                                  01713000
DIWSHIFT EQU   DIWFLG1                                                  01714000
DIWGSPC  EQU   DIWFLG1                                                  01715000
DIWEOKR  EQU   DIWFLG1                                                  01716000
DIWPFERR EQU   DIWFLG1                                                  01717000
DIWCISPL EQU   DIWFLG1                                                  01718000
DIWCAS   EQU   DIWFLG1                                                  01719000
DIWLEN   EQU   IDADIWA+2                                                01720000
DIWATV   EQU   IDADIWA+1                                                01721000
DIWID    EQU   IDADIWA                                                  01722000
ACBAPID  EQU   ACBCOMN+72                                               01723000
ACBCBMWA EQU   ACBCOMN+68                                               01724000
ACBUAPTR EQU   ACBCOMN+64                                               01725000
ACBLRECL EQU   ACBCOMN+62                                               01726000
ACBMSGLN EQU   ACBBLKSZ                                                 01727000
ACBBUFSP EQU   ACBCOMN+56                                               01728000
@NM00032 EQU   ACBUJFCB+1                                               01729000
ACBOPTN  EQU   ACBUJFCB                                                 01730000
ACBVVIC  EQU   ACBINFLG                                                 01731000
ACBUCRA  EQU   ACBINFLG                                                 01732000
ACBSCRA  EQU   ACBINFLG                                                 01733000
ACBCAT   EQU   ACBINFLG                                                 01734000
ACBIJRQE EQU   ACBINFLG                                                 01735000
ACBJEPS  EQU   ACBINFLG                                                 01736000
@NM00031 EQU   ACBINFLG                                                 01737000
ACBERFLG EQU   ACBCOMN+49                                               01738000
ACBBUSY  EQU   ACBIOSFG                                                 01739000
ACBLOCK  EQU   ACBEXFG                                                  01740000
@NM00030 EQU   ACBOFLGS                                                 01741000
ACBDSERR EQU   ACBOFLGS                                                 01742000
ACBOPEN  EQU   ACBOFLGS                                                 01743000
ACBEOV   EQU   ACBOFLGS                                                 01744000
@NM00029 EQU   ACBOFLGS                                                 01745000
ACBDEB   EQU   ACBDDNM+5                                                01746000
ACBERFL  EQU   ACBDDNM+4                                                01747000
ACBAM    EQU   ACBAMETH                                                 01748000
ACBINFL  EQU   ACBDDNM+2                                                01749000
ACBTIOT  EQU   ACBDDNM                                                  01750000
ACBUEL   EQU   ACBEXLST                                                 01751000
ACBPASSW EQU   ACBCOMN+32                                               01752000
ACBMSGAR EQU   ACBCOMN+28                                               01753000
@NM00028 EQU   ACBDSORG+1                                               01754000
ACBDORGA EQU   ACBDSORG+1                                               01755000
@NM00027 EQU   ACBDSORG                                                 01756000
ACBCRNRE EQU   ACBCROPS                                                 01757000
ACBCRNCK EQU   ACBCROPS                                                 01758000
ACBASA   EQU   ACBCCTYP                                                 01759000
@NM00026 EQU   ACBCCTYP                                                 01760000
ACBRECAF EQU   ACBRECFM                                                 01761000
ACBJBUF  EQU   ACBBUFPL+2                                               01762000
ACBMACR4 EQU   ACBBUFPL+1                                               01763000
@NM00025 EQU   ACBMACR3                                                 01764000
ACBNCFX  EQU   ACBMACR3                                                 01765000
ACBSIS   EQU   ACBMACR3                                                 01766000
ACBDFR   EQU   ACBMACR3                                                 01767000
ACBICI   EQU   ACBMACR3                                                 01768000
ACBGSR   EQU   ACBMACR3                                                 01769000
ACBLSR   EQU   ACBMACR3                                                 01770000
@NM00024 EQU   ACBMACR3                                                 01771000
ACBBUFNI EQU   ACBCOMN+18                                               01772000
ACBBUFND EQU   ACBCOMN+16                                               01773000
ACBSTRNO EQU   ACBCOMN+15                                               01774000
ACBBSTNO EQU   ACBCOMN+14                                               01775000
ACBAIX   EQU   ACBMACR2                                                 01776000
ACBDSN   EQU   ACBMACR2                                                 01777000
ACBRST   EQU   ACBMACR2                                                 01778000
ACBLOGON EQU   ACBMACR2                                                 01779000
ACBSKP   EQU   ACBMACR2                                                 01780000
@NM00023 EQU   ACBMACR2                                                 01781000
ACBUBF   EQU   ACBMACR1                                                 01782000
ACBOUT   EQU   ACBMACR1                                                 01783000
ACBIN    EQU   ACBMACR1                                                 01784000
ACBDIR   EQU   ACBMACR1                                                 01785000
ACBSEQ   EQU   ACBMACR1                                                 01786000
ACBBLK   EQU   ACBCNV                                                   01787000
ACBADD   EQU   ACBADR                                                   01788000
ACBKEY   EQU   ACBMACR1                                                 01789000
ACBINRTN EQU   ACBCOMN+8                                                01790000
ACBIBCT  EQU   ACBJWA                                                   01791000
ACBLEN2  EQU   ACBLENG2                                                 01792000
ACBSTYP  EQU   ACBCOMN+1                                                01793000
ACBID    EQU   ACBCOMN                                                  01794000
AMBLCMB  EQU   IDAAMBL+64                                               01795000
AMBLBIB  EQU   IDAAMBL+60                                               01796000
AMBLMIDS EQU   IDAAMBL+42                                               01797000
AMBLNIDS EQU   IDAAMBL+41                                               01798000
@NM00022 EQU   IDAAMBL+40                                               01799000
AMBLNUM  EQU   IDAAMBL+38                                               01800000
AMBLNST  EQU   IDAAMBL+37                                               01801000
@NM00021 EQU   AMBLFLG2                                                 01802000
AMBLSTAG EQU   AMBLFLG2                                                 01803000
@NM00020 EQU   AMBLFLG2                                                 01804000
AMBLDUMY EQU   AMBLFLG1                                                 01805000
AMBLCAT  EQU   AMBLFLG1                                                 01806000
AMBLUCRA EQU   AMBLFLG1                                                 01807000
AMBLSCRA EQU   AMBLFLG1                                                 01808000
AMBLVVIC EQU   AMBLFLG1                                                 01809000
AMBLUPD  EQU   AMBLFLG1                                                 01810000
AMBLCINV EQU   AMBLFLG1                                                 01811000
AMBLFULL EQU   AMBLFLG1                                                 01812000
AMBLLEN  EQU   IDAAMBL+34                                               01813000
@NM00019 EQU   AMBLSHAR                                                 01814000
AMBLWRIT EQU   AMBLSHAR                                                 01815000
AMBLCATO EQU   AMBLSHAR                                                 01816000
AMBLPRIM EQU   AMBLSHAR                                                 01817000
AMBLID   EQU   IDAAMBL+32                                               01818000
@NM00018 EQU   IDAAMBL+31                                               01819000
@NM00017 EQU   AMBLTYPE                                                 01820000
AMBLFIX  EQU   AMBLTYPE                                                 01821000
AMBLBASE EQU   AMBLTYPE                                                 01822000
AMBLAIX  EQU   AMBLTYPE                                                 01823000
AMBLUPGR EQU   AMBLTYPE                                                 01824000
AMBLPATH EQU   AMBLTYPE                                                 01825000
AMBLENO  EQU   AMBLVC+1                                                 01826000
AMBLVRT  EQU   AMBLVC                                                   01827000
AMBLXPT  EQU   IDAAMBL+24                                               01828000
AMBLDFR  EQU   AMBLQ                                                    01829000
AMBLESDS EQU   AMBLQ                                                    01830000
AMBLKSDS EQU   AMBLQ                                                    01831000
AMBLUBF  EQU   AMBLQ                                                    01832000
AMBLFSTP EQU   AMBLQ                                                    01833000
AMBLLSR  EQU   AMBLQ                                                    01834000
AMBLGSR  EQU   AMBLQ                                                    01835000
AMBLDDC  EQU   AMBLQ                                                    01836000
AMBLDCI  EQU   AMBLIDF+4                                                01837000
AMBLCACB EQU   AMBLIDF                                                  01838000
@NM00016 EQU   AMBLEOV+2                                                01839000
AMBLCOMP EQU   AMBLEOV+1                                                01840000
AMBLESET EQU   AMBLEFLG                                                 01841000
AMBLWAIT EQU   AMBLEFLG                                                 01842000
AMBLACB  EQU   IDAAMBL+8                                                01843000
AMBLSCHN EQU   IDAAMBL+4                                                01844000
AMBLPCHN EQU   IDAAMBL                                                  01845000
AMBTRACE EQU   IDAAMB+120                                               01846000
AMBVIOT  EQU   IDAAMB+116                                               01847000
AMBSZCP  EQU   IDAAMB+114                                               01848000
AMBSZFW  EQU   IDAAMB+112                                               01849000
AMBSZWR  EQU   IDAAMB+110                                               01850000
AMBSZRD  EQU   IDAAMB+108                                               01851000
AMBEXEX  EQU   IDAAMB+100                                               01852000
AMBWSHD  EQU   IDAAMB+96                                                01853000
AMBCPA   EQU   IDAAMB+92                                                01854000
AMBBM2SH EQU   IDAAMB+88                                                01855000
AMBRDCNT EQU   AMBCSWD1+2                                               01856000
@NM00015 EQU   AMBCSWD1+1                                               01857000
@NM00014 EQU   AMBAFLG                                                  01858000
AMBCFX   EQU   AMBAFLG                                                  01859000
AMBSIS   EQU   AMBAFLG                                                  01860000
AMBDFR   EQU   AMBAFLG                                                  01861000
AMBICI   EQU   AMBAFLG                                                  01862000
AMBGSR   EQU   AMBAFLG                                                  01863000
AMBLSR   EQU   AMBAFLG                                                  01864000
@NM00013 EQU   AMBAFLG                                                  01865000
AMBUPLH  EQU   IDAAMB+80                                                01866000
AMBPAMBL EQU   IDAAMB+76                                                01867000
AMBPIXP  EQU   IDAAMB+72                                                01868000
@NM00012 EQU   IDAAMB+68                                                01869000
AMBWKA   EQU   IDAAMB+60                                                01870000
AMBAMBXN EQU   AMBEOVPT                                                 01871000
AMBEDB   EQU   IDAAMB+52                                                01872000
AMBRPT   EQU   IDAAMB+50                                                01873000
AMBPUG   EQU   AMBFLG2                                                  01874000
AMBBUSY  EQU   AMBOFLGS                                                 01875000
AMBEXFG  EQU   AMBOFLGS                                                 01876000
@NM00011 EQU   AMBOFLGS                                                 01877000
AMBOPEN  EQU   AMBOFLGS                                                 01878000
@NM00010 EQU   AMBOFLGS                                                 01879000
AMBDEBAD EQU   AMBDEBPT+1                                               01880000
AMBIFLGS EQU   AMBDEBPT                                                 01881000
AMBAMETH EQU   IDAAMB+43                                                01882000
AMBUPX   EQU   AMBINFL                                                  01883000
AMBUCRA  EQU   AMBINFL                                                  01884000
AMBSCRA  EQU   AMBINFL                                                  01885000
AMBCAT   EQU   AMBINFL                                                  01886000
@NM00009 EQU   AMBINFL                                                  01887000
@NM00008 EQU   AMBINFL                                                  01888000
AMBTIOT  EQU   IDAAMB+40                                                01889000
@NM00007 EQU   IDAAMB+38                                                01890000
AMBDDSN  EQU   IDAAMB+35                                                01891000
AMBCDSN  EQU   IDAAMB+32                                                01892000
AMBIOMB  EQU   AMBIOBAD                                                 01893000
@NM00006 EQU   AMBDSORG+1                                               01894000
AMBDORGA EQU   AMBDSORG+1                                               01895000
@NM00005 EQU   AMBDSORG                                                 01896000
AMBINBUF EQU   AMBFLG1                                                  01897000
AMBJRN   EQU   AMBFLG1                                                  01898000
AMBUBF   EQU   AMBFLG1                                                  01899000
AMBSPEED EQU   AMBFLG1                                                  01900000
AMBPCAT  EQU   AMBFLG1                                                  01901000
AMBMCAT  EQU   AMBFLG1                                                  01902000
AMBTYPE  EQU   AMBFLG1                                                  01903000
AMBCREAT EQU   AMBFLG1                                                  01904000
@NM00004 EQU   AMBFLG0                                                  01905000
AMBPSDS  EQU   AMBFLG0                                                  01906000
AMBCACB  EQU   IDAAMB+16                                                01907000
AMBPH    EQU   IDAAMB+12                                                01908000
AMBLINK  EQU   IDAAMB+4                                                 01909000
AMBLEN   EQU   IDAAMB+2                                                 01910000
AMBRSC   EQU   IDAAMB+1                                                 01911000
AMBID    EQU   IDAAMB                                                   01912000
RPLERMSA EQU   RPLCOMN+72                                               01913000
RPLEMLEN EQU   RPLCOMN+70                                               01914000
RPLACTIV EQU   RPLCOMN+69                                               01915000
RPLBRANC EQU   RPLEXTD1                                                 01916000
RPLNIB   EQU   RPLEXTD1                                                 01917000
@NM00003 EQU   RPLEXTD1                                                 01918000
RPLEXIT  EQU   RPLEXTD1                                                 01919000
RPLNEXIT EQU   RPLEXTD1                                                 01920000
RPLEXSCH EQU   RPLEXTD1                                                 01921000
RPLDDDD  EQU   RPLRBAR+4                                                01922000
@NM00002 EQU   RPLRBAR+3                                                01923000
@NM00001 EQU   RPLAIXID                                                 01924000
RPLAXPKP EQU   RPLAIXID                                                 01925000
RPLAIXPC EQU   RPLRBAR                                                  01926000
RPLRSV88 EQU   RPLOPT8                                                  01927000
RPLUNCON EQU   RPLOPT8                                                  01928000
RPLACTV  EQU   RPLOPT8                                                  01929000
RPLSESS  EQU   RPLOPT8                                                  01930000
RPLPEND  EQU   RPLOPT8                                                  01931000
RPLODPRM EQU   RPLOPT8                                                  01932000
RPLODACP EQU   RPLOPT8                                                  01933000
RPLODACQ EQU   RPLOPT8                                                  01934000
RPLRSV78 EQU   RPLOPT7                                                  01935000
RPLRSV77 EQU   RPLOPT7                                                  01936000
RPLRLSOP EQU   RPLOPT7                                                  01937000
RPLTPOST EQU   RPLOPT7                                                  01938000
RPLQOPT  EQU   RPLOPT7                                                  01939000
RPLCNIMM EQU   RPLCNOPT                                                 01940000
RPLCNANY EQU   RPLCNOPT                                                 01941000
RPLCNALL EQU   RPLCNOPT                                                 01942000
RPLRSV68 EQU   RPLOPT6                                                  01943000
RPLRSV67 EQU   RPLOPT6                                                  01944000
RPLLOCK  EQU   RPLOPT6                                                  01945000
RPLNCOND EQU   RPLOPT6                                                  01946000
RPLCOND  EQU   RPLOPT6                                                  01947000
RPLEOT   EQU   RPLUNTYP                                                 01948000
RPLEOM   EQU   RPLUNTYP                                                 01949000
RPLEOB   EQU   RPLUNTYP                                                 01950000
RPLWROPT EQU   RPLOPT5                                                  01951000
RPLNODE  EQU   RPLOPT5                                                  01952000
RPLERACE EQU   RPLWRTYP                                                 01953000
RPLEAU   EQU   RPLWRTYP                                                 01954000
RPLNERAS EQU   RPLWRTYP                                                 01955000
RPLPSOPT EQU   RPLOPT5                                                  01956000
RPLSSNIN EQU   RPLOPT5                                                  01957000
RPLDLGIN EQU   RPLOPT5                                                  01958000
RPLBUFL  EQU   RPLCOMN+52                                               01959000
RPLCHAIN EQU   RPLNXTRP                                                 01960000
RPLOPT4  EQU   RPLOPTCD+3                                               01961000
RPLALIGN EQU   RPLOPT3                                                  01962000
RPLFMT   EQU   RPLOPT3                                                  01963000
RPLFLD   EQU   RPLOPT3                                                  01964000
RPLVFY   EQU   RPLOPT3                                                  01965000
RPLBLK   EQU   RPLOPT3                                                  01966000
RPLSFORM EQU   RPLOPT3                                                  01967000
RPLEODS  EQU   RPLOPT3                                                  01968000
RPLNSP   EQU   RPLOPT2                                                  01969000
RPLUPD   EQU   RPLOPT2                                                  01970000
RPLWAITX EQU   RPLOPT2                                                  01971000
RPLLRD   EQU   RPLOPT2                                                  01972000
RPLBWD   EQU   RPLOPT2                                                  01973000
RPLCNV   EQU   RPLOPT2                                                  01974000
RPLADD   EQU   RPLADR                                                   01975000
RPLKEY   EQU   RPLOPT2                                                  01976000
RPLECBIN EQU   RPLECBSW                                                 01977000
RPLGEN   EQU   RPLOPT1                                                  01978000
RPLKGE   EQU   RPLOPT1                                                  01979000
RPLASY   EQU   RPLOPT1                                                  01980000
RPLSKP   EQU   RPLOPT1                                                  01981000
RPLSEQ   EQU   RPLOPT1                                                  01982000
RPLDIR   EQU   RPLOPT1                                                  01983000
RPLLOC   EQU   RPLOPT1                                                  01984000
RPLDAF   EQU   RPLARG+2                                                 01985000
RPLSAF   EQU   RPLARG                                                   01986000
RPLTCBPT EQU   RPLCOMN+28                                               01987000
RPLCCHAR EQU   RPLCOMN+20                                               01988000
RPLSTRID EQU   RPLCOMN+18                                               01989000
RPLKEYL  EQU   RPLKEYLE                                                 01990000
RPLRDSOH EQU   RPLFDB3                                                  01991000
RPLRLG   EQU   RPLFDB3                                                  01992000
RPLLGFRC EQU   RPLFDB3                                                  01993000
RPLREOT  EQU   RPLFDB3                                                  01994000
RPLREOM  EQU   RPLFDB3                                                  01995000
RPLREOB  EQU   RPLFDB3                                                  01996000
RPLSV32  EQU   RPLFDB3                                                  01997000
RPLUINPT EQU   RPLFDB3                                                  01998000
RPLSTSAV EQU   RPLFDB2                                                  01999000
RPLCUERR EQU   RPLFDB2                                                  02000000
RPLDLGFL EQU   RPLFDB2                                                  02001000
RPLIOERR EQU   RPLFDB2                                                  02002000
RPLDVUNS EQU   RPLFDB2                                                  02003000
RPLATND  EQU   RPLFDB2                                                  02004000
RPLRVID  EQU   RPLFDB2                                                  02005000
RPLERLK  EQU   RPLFDB2                                                  02006000
RPLSTAT  EQU   RPLFDBWD                                                 02007000
RPLPOST  EQU   RPLECB                                                   02008000
RPLWAIT  EQU   RPLECB                                                   02009000
RPLPLHPT EQU   RPLCOMN+4                                                02010000
RPLLEN2  EQU   RPLLEN                                                   02011000
RPLREQ   EQU   RPLIDWD+2                                                02012000
RPLSTYP  EQU   RPLIDWD+1                                                02013000
RPLID    EQU   RPLIDWD                                                  02014000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02015000
@RT00184 EQU   SFEXIT                                                   02016000
@RT00228 EQU   SFEXIT                                                   02017000
@RT00290 EQU   SFEXIT                                                   02018000
@RT00300 EQU   SFEXIT                                                   02019000
@RT00318 EQU   SFEXIT                                                   02020000
@RT00363 EQU   SFEXIT                                                   02021000
@RT00374 EQU   SFEXIT                                                   02022000
@RT00410 EQU   SFEXIT                                                   02023000
@RT00421 EQU   SFEXIT                                                   02024000
@RT00433 EQU   SFEXIT                                                   02025000
@RT00452 EQU   SFEXIT                                                   02026000
@RT00465 EQU   SFEXIT                                                   02027000
@RT00483 EQU   SFEXIT                                                   02028000
@RT00519 EQU   SFEXIT                                                   02029000
@ENDDATA EQU   *                                                        02030000
         END   IDA019SF,(C'PLS2227',0701,78172)                         02031000
