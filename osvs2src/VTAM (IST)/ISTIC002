         TITLE 'COMMUNICATIONS INTERVAL MODULE - ISTIC002              *00001000
                        '                                               00002000
ISTIC002 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ISTIC002  76.244'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
*                                                                  0056 00014000
*/********************************************************************/ 00015000
*                                                                  0057 00016000
*   R15=R13;                        /* SET BACKSAVE PTR              */ 00017000
         LR    R15,R13                                             0057 00018000
*   R13=ADDR(SVEIC002);             /* SET PTR TO SAVE AREA          */ 00019000
         LA    R13,SVEIC002(,WAPTR)                                0058 00020000
*   BACKSAVE(3)=R13;                /* CHAIN AREAS TOGETHER          */ 00021000
         ST    R13,BACKSAVE+8(,R15)                                0059 00022000
*   SVEIC002(2)=R15;                                               0060 00023000
         ST    R15,SVEIC002+4(,WAPTR)                              0060 00024000
*   RCAPTR=$RCA;                                                   0061 00025000
*                                                                  0061 00026000
         L     RCAPTR,$RCA(,WAPTR)                                 0061 00027000
*/********************************************************************/ 00028000
*/* CHECK FOR SPECIAL CONDITION WHERE CI IS RE-ENTERED AFTER HAVING  */ 00029000
*/* ONCE EXITED TO THE OLT AFTER CAT ERROR OCCURRED. IN THIS CASE    */ 00030000
*/* THERE HAS ALREADY BEEN EITHER A DEVICE CHANGE OR TEST CHANGE     */ 00031000
*/* ENTERED. NOW PROCEED TO DECODE THIS ENTRY.                       */ 00032000
*/********************************************************************/ 00033000
*                                                                  0062 00034000
*   IF $CATERR=ON&$CATMSG=OFF THEN  /* IF $CATERR IS ON BUT          */ 00035000
         TM    $CATERR(WAPTR),B'00100000'                          0062 00036000
         BNO   @RF00062                                            0062 00037000
         TM    $CATMSG(WAPTR),B'00000100'                          0062 00038000
         BNZ   @RF00062                                            0062 00039000
*     DO;                           /* $CATMSG IS OFF, THEN RESET    */ 00040000
*       $CATERR=OFF;                /* $CATERR FLAG AND PROCEED TO   */ 00041000
         NI    $CATERR(WAPTR),B'11011111'                          0064 00042000
*       GO TO I02C0160;             /* DECODE PRIOR INPUT.           */ 00043000
         B     I02C0160                                            0065 00044000
*     END;                                                         0066 00045000
*   $TSTDEVP=OFF;                   /* RESET PERMISSION REQUIRED     */ 00046000
@RF00062 DS    0H                                                  0068 00047000
*   $APRQPER=OFF;                   /* SWITCHES (TEST DEVS AND AP)   */ 00048000
         NI    $TSTDEVP(WAPTR),B'10011111'                         0068 00049000
*/********************************************************************/ 00050000
*/*   OUTPUT OPTIONS ARE MESSAGE                                     */ 00051000
*/********************************************************************/ 00052000
*                                                                  0069 00053000
*I02C0005:                                                         0069 00054000
*   $CIREQ=OFF;                     /* RESET CI REQUIRED FLAG        */ 00055000
I02C0005 NI    $CIREQ(WAPTR),B'11111110'                           0069 00056000
*   IF $LGON=ON THEN                /* CHECK FOR INITIAL ENTRY       */ 00057000
         TM    $LGON(WAPTR),B'01000000'                            0070 00058000
         BNO   @RF00070                                            0070 00059000
*     DO;                                                          0071 00060000
*                                                                  0071 00061000
*/********************************************************************/ 00062000
*/* IF THIS IS THE INITIAL ENTRY TO CI MODULE FOR THIS USER OR       */ 00063000
*/* CONTROL HAS BEEN TRANSFERRED TO A NEW CT, OUTPUT THE MESSAGE     */ 00064000
*/* 102I OLTS RUNNING WITH TOLTEP REL. XX.                           */ 00065000
*/********************************************************************/ 00066000
*                                                                  0072 00067000
*       $LGON=OFF;                                                 0072 00068000
         NI    $LGON(WAPTR),B'10111111'                            0072 00069000
*       IF $SYSMN(1,1:8)^='SYS CON ' THEN/* SYSTEM CONSOL    @D32JPFR*/ 00070000
         CLC   $SYSMN(8,WAPTR),@CC00760                            0073 00071000
         BE    @RF00073                                            0073 00072000
*         DO;                       /* NO                    @D32JPFR*/ 00073000
*           TEMPFLGS='0A'X;         /* SET REMOTE FLG        @D32JPFR*/ 00074000
         MVI   TEMPFLGS(WAPTR),X'0A'                               0075 00075000
*           CTNAME=$SYSMN(1,1:8);   /* PICK UP NAME          @D32JPFR*/ 00076000
         MVC   CTNAME(8,WAPTR),$SYSMN(WAPTR)                       0076 00077000
*           CALL I02C1000;          /* VERIFY AND CHK DEV CHARS    0077 00078000
*                                                            @D32JPFR*/ 00079000
         BAL   @14,I02C1000                                        0077 00080000
*           IF R15^=0 THEN          /* BAD RC                @D32JPFR*/ 00081000
         LTR   R15,R15                                             0078 00082000
         BZ    @RF00078                                            0078 00083000
*             DO;                   /* YES                   @D32JPFR*/ 00084000
*               $INBUFR(1:8)=$SYSMN(1);/* PUT NAME IN MSG    @D32JPFR*/ 00085000
         MVC   $INBUFR(8,WAPTR),$SYSMN(WAPTR)                      0080 00086000
*               IF R15=4 THEN       /* ALREADY IN USE        @D32JPFR*/ 00087000
         C     R15,@CF00068                                        0081 00088000
         BNE   @RF00081                                            0081 00089000
*                 $INBUFR(9:29)=M923FILL(2);/* YES           @D32JPFR*/ 00090000
         MVI   $INBUFR+28(WAPTR),C' '                              0082 00091000
         MVC   $INBUFR+8(20,WAPTR),M923FILL+20                     0082 00092000
*               ELSE                /* RC MUST = 8           @D32JPFR*/ 00093000
*                 $INBUFR(9:29)=M923FILL(1);/* INVALID DEV CHARS   0083 00094000
*                                                            @D32JPFR*/ 00095000
*                                                                  0083 00096000
         B     @RC00081                                            0083 00097000
@RF00081 MVI   $INBUFR+28(WAPTR),C' '                              0083 00098000
         MVC   $INBUFR+8(20,WAPTR),M923FILL                        0083 00099000
*               /*****************************************************/ 00100000
*               /*                                                   */ 00101000
*               /* TCEC MSGN(923)DIR(NET)SUB(YES) INVOKED            */ 00102000
*               /*                                                   */ 00103000
*               /*****************************************************/ 00104000
*                                                                  0084 00105000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00106000
@RC00081 OI    $TCECM(WAPTR),B'00000001'                           0084 00107000
*               R1=ADDR($TCA11);    /* SET UP PARM LIST $TR          */ 00108000
         LA    R1,$TCA11                                           0085 00109000
*               CALL #EXIT;         /* CALL CECOM                    */ 00110000
         L     @15,#EXITA(,WAPTR)                                  0086 00111000
         BALR  @14,@15                                             0086 00112000
*               DCL                                                0087 00113000
*                 1 $TCA11,         /* TCEC PARM LIST                */ 00114000
*                  2 $TCB11 FIXED(32) INIT(923),/* MSG NUMBER        */ 00115000
*                  2 $TCC11 FIXED(32) INIT(0),/* INCT LEN            */ 00116000
*                  2 $TCD11 BIT(8) INIT('10001000'B),/* FLAG         */ 00117000
*                  2 $TCE11 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00118000
*               GOTO I02C0092;      /* RETURN                @D32JPFR*/ 00119000
         B     I02C0092                                            0088 00120000
*             END;                  /*                       @D32JPFR*/ 00121000
*           $RNINFO(3)=CTPTRS;      /* SAVE INFO FROM SC030  @D32JPFR*/ 00122000
@RF00078 MVC   $RNINFO+136(9,WAPTR),CTPTRS(WAPTR)                  0090 00123000
*           $OPCOM=OFF;             /* TURN OFF OPERATOR COMM FLG  0091 00124000
*                                                            @D32JPFR*/ 00125000
         NI    $OPCOM(WAPTR),B'01111111'                           0091 00126000
*           $DEVFEAT(1)=SVEIC00A(1);/* PUT DEV CHARS IN TABLE      0092 00127000
*                                                            @D32JPFR*/ 00128000
         MVC   $DEVFEAT(4,WAPTR),SVEIC00A(WAPTR)                   0092 00129000
*           $DEVFLG5(1)=$DEVFLG5(1)|FLAG5;/* MOVE FLAG DATA TO     0093 00130000
*                                      DEVTABLE              @D32JPFR*/ 00131000
*                                                                  0093 00132000
         OC    $DEVFLG5(1,WAPTR),FLAG5(WAPTR)                      0093 00133000
*           /*********************************************************/ 00134000
*           /*                                                       */ 00135000
*           /* TCEC MSGN(102) INVOKED                                */ 00136000
*           /*                                                       */ 00137000
*           /*********************************************************/ 00138000
*                                                                  0094 00139000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00140000
         OI    $TCECM(WAPTR),B'00000001'                           0094 00141000
*           R1=ADDR($TCA12);        /* SET UP PARM LIST $TR          */ 00142000
         LA    R1,$TCA12                                           0095 00143000
*           CALL #EXIT;             /* CALL CECOM                    */ 00144000
         L     @15,#EXITA(,WAPTR)                                  0096 00145000
         BALR  @14,@15                                             0096 00146000
*           DCL                                                    0097 00147000
*             1 $TCA12,             /* TCEC PARM LIST                */ 00148000
*              2 $TCB12 FIXED(32) INIT(102),/* MSG NUMBER            */ 00149000
*              2 $TCC12 FIXED(32) INIT(0),/* INCT LEN                */ 00150000
*              2 $TCD12 BIT(8) INIT('00000000'B),/* FLAG             */ 00151000
*              2 $TCE12 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK     */ 00152000
*           $INBUFR=$SYSMN(1);      /* GET NAME FOR MSG      @D32JPFR*/ 00153000
*                                                                  0098 00154000
         MVI   $INBUFR+8(WAPTR),C' '                               0098 00155000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0098 00156000
         MVC   $INBUFR(8,WAPTR),$SYSMN(WAPTR)                      0098 00157000
*           /*********************************************************/ 00158000
*           /*                                                       */ 00159000
*           /* TCEC MSGN(920)DIR(NET)INCT(61)SUB(YES) INVOKED        */ 00160000
*           /*                                                       */ 00161000
*           /*********************************************************/ 00162000
*                                                                  0099 00163000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00164000
         OI    $TCECM(WAPTR),B'00000001'                           0099 00165000
*           R1=ADDR($TCA13);        /* SET UP PARM LIST $TR          */ 00166000
         LA    R1,$TCA13                                           0100 00167000
*           CALL #EXIT;             /* CALL CECOM                    */ 00168000
         L     @15,#EXITA(,WAPTR)                                  0101 00169000
         BALR  @14,@15                                             0101 00170000
*           DCL                                                    0102 00171000
*             1 $TCA13,             /* TCEC PARM LIST                */ 00172000
*              2 $TCB13 FIXED(32) INIT(920),/* MSG NUMBER            */ 00173000
*              2 $TCC13 FIXED(32) INIT(61),/* INCT LEN               */ 00174000
*              2 $TCD13 BIT(8) INIT('11001000'B),/* FLAG             */ 00175000
*              2 $TCE13 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK     */ 00176000
*           CALL I02C2000;          /* PROCESS RESPONSE      @D32JPFR*/ 00177000
         BAL   @14,I02C2000                                        0103 00178000
*           IF R15=4 THEN           /* IF RESPONSE = NO      @D32JPFR*/ 00179000
         C     R15,@CF00068                                        0104 00180000
         BE    @RT00104                                            0104 00181000
*             GOTO I02C0092;        /* RETURN                @D32JPFR*/ 00182000
*         END;                      /*                       @D32JPFR*/ 00183000
*       ELSE                                                       0107 00184000
*         DO;                       /* PUT OUT MSG TO SYSCON @ZD10886*/ 00185000
*                                                                  0107 00186000
         B     @RC00073                                            0107 00187000
@RF00073 DS    0H                                                  0108 00188000
*           /*********************************************************/ 00189000
*           /*                                                       */ 00190000
*           /* TCEC MSGN(102) INVOKED                                */ 00191000
*           /*                                                       */ 00192000
*           /*********************************************************/ 00193000
*                                                                  0108 00194000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00195000
         OI    $TCECM(WAPTR),B'00000001'                           0108 00196000
*           R1=ADDR($TCA14);        /* SET UP PARM LIST $TR          */ 00197000
         LA    R1,$TCA14                                           0109 00198000
*           CALL #EXIT;             /* CALL CECOM                    */ 00199000
         L     @15,#EXITA(,WAPTR)                                  0110 00200000
         BALR  @14,@15                                             0110 00201000
*           DCL                                                    0111 00202000
*             1 $TCA14,             /* TCEC PARM LIST                */ 00203000
*              2 $TCB14 FIXED(32) INIT(102),/* MSG NUMBER            */ 00204000
*              2 $TCC14 FIXED(32) INIT(0),/* INCT LEN                */ 00205000
*              2 $TCD14 BIT(8) INIT('00000000'B),/* FLAG             */ 00206000
*              2 $TCE14 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK     */ 00207000
*         END;                                                     0112 00208000
*     END;                                                         0113 00209000
@RC00073 DS    0H                                                  0114 00210000
*I02C0007:                                                         0114 00211000
*   $OPTMSG=ON;                                                    0114 00212000
@RF00070 DS    0H                                                  0114 00213000
I02C0007 OI    $OPTMSG(WAPTR),B'10000000'                          0114 00214000
*   CALL ISTIC005;                  /* GO ISSUE OPTIONS ARE... MSG   */ 00215000
         L     @15,@CV00795                                        0115 00216000
         BALR  @14,@15                                             0115 00217000
*/********************************************************************/ 00218000
*/*    ISSUE  105D  MESSAGE.                                         */ 00219000
*/********************************************************************/ 00220000
*                                                                  0116 00221000
*I02C0010:                                                         0116 00222000
*                                                                  0116 00223000
*   /*****************************************************************/ 00224000
*   /*                                                               */ 00225000
*   /* TCEC MSGN(105)INCT(61) INVOKED                                */ 00226000
*   /*                                                               */ 00227000
*   /*****************************************************************/ 00228000
*                                                                  0116 00229000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00230000
I02C0010 OI    $TCECM(WAPTR),B'00000001'                           0116 00231000
*   R1=ADDR($TCA15);                /* SET UP PARM LIST $TR          */ 00232000
         LA    R1,$TCA15                                           0117 00233000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00234000
         L     @15,#EXITA(,WAPTR)                                  0118 00235000
         BALR  @14,@15                                             0118 00236000
*   DCL                                                            0119 00237000
*     1 $TCA15,                     /* TCEC PARM LIST                */ 00238000
*      2 $TCB15 FIXED(32) INIT(105),/* MSG NUMBER                    */ 00239000
*      2 $TCC15 FIXED(32) INIT(61), /* INCT LEN                      */ 00240000
*      2 $TCD15 BIT(8) INIT('01000000'B),/* FLAG                     */ 00241000
*      2 $TCE15 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE ENTER    00242000
*                                      D/T/O/ MSG.                   */ 00243000
*   $CIREQ=OFF;                     /* SET CIREQ OFF         @D32JPFR*/ 00244000
         NI    $CIREQ(WAPTR),B'11111110'                           0120 00245000
*I02C0020:                                                         0121 00246000
*   $DTORESP=$INBUFR;                                              0121 00247000
I02C0020 MVC   $DTORESP(64,WAPTR),$INBUFR(WAPTR)                   0121 00248000
*   $DEVERR=OFF;                    /* RESET DEV FIELD ERROR FLAG    */ 00249000
*   $TSTERR=OFF;                    /* RESET TEST FLD ERROR FLAG     */ 00250000
*   $OPTERR=OFF;                    /* RESET OPT FIELD ERROR FLAG    */ 00251000
         NI    $DEVERR(WAPTR),B'00111011'                          0124 00252000
*/********************************************************************/ 00253000
*/*  $DTORESP CONTAINS INCOUNT IN FIRST BYTE, UP TO 61 CHARACTERS OF */ 00254000
*/* OPERATOR RESPONSE.                                               */ 00255000
*/********************************************************************/ 00256000
*                                                                  0125 00257000
*   X=0;                                                           0125 00258000
         SLR   X,X                                                 0125 00259000
*   DO I=2 TO $DTORESP(1:1)+1;      /* CHECK REPLY FOR EXACTLY       */ 00260000
         LA    I,2                                                 0126 00261000
         B     @DE00126                                            0126 00262000
@DL00126 DS    0H                                                  0127 00263000
*     IF $DTORESP(I)='/' THEN       /* THREE SLASHES                 */ 00264000
         LR    @14,WAPTR                                           0127 00265000
         ALR   @14,I                                               0127 00266000
         CLI   $DTORESP-1(@14),C'/'                                0127 00267000
         BNE   @RF00127                                            0127 00268000
*       X=X+1;                      /* ADD SLASH COUNT               */ 00269000
         AL    X,@CF00072                                          0128 00270000
*     ELSE                                                         0129 00271000
*       ;                                                          0129 00272000
@RF00127 DS    0H                                                  0130 00273000
*   END;                                                           0130 00274000
         AL    I,@CF00072                                          0130 00275000
@DE00126 LA    @14,1                                               0130 00276000
         SLR   @11,@11                                             0130 00277000
         IC    @11,$DTORESP(,WAPTR)                                0130 00278000
         ALR   @14,@11                                             0130 00279000
         CR    I,@14                                               0130 00280000
         BNH   @DL00126                                            0130 00281000
*   IF X=3 THEN                     /* (MEANING EXACTLY 3 SLASHES  0131 00282000
*                                      FOUND)                        */ 00283000
         C     X,@CF00081                                          0131 00284000
         BNE   @RF00131                                            0131 00285000
*/********************************************************************/ 00286000
*/* IF THREE SLASHES FOUND, THEN PUT ADDRESSES IN $SLASHAD ARRAY.    */ 00287000
*/********************************************************************/ 00288000
*                                                                  0132 00289000
*     DO;                                                          0132 00290000
*       X=0;                                                       0133 00291000
         SLR   X,X                                                 0133 00292000
*       DO I=2 TO $DTORESP(1:1)+1;                                 0134 00293000
         LA    I,2                                                 0134 00294000
         B     @DE00134                                            0134 00295000
@DL00134 DS    0H                                                  0135 00296000
*         IF $DTORESP(I)='/' THEN                                  0135 00297000
         LR    @14,WAPTR                                           0135 00298000
         ALR   @14,I                                               0135 00299000
         CLI   $DTORESP-1(@14),C'/'                                0135 00300000
         BNE   @RF00135                                            0135 00301000
*           DO;                                                    0136 00302000
*             X=X+1;                                               0137 00303000
         AL    X,@CF00072                                          0137 00304000
*             $SLASHAD(X)=ADDR($DTORESP(I));                       0138 00305000
         LR    @14,X                                               0138 00306000
         SLA   @14,2                                               0138 00307000
         LA    @11,$DTORESP-1(I,WAPTR)                             0138 00308000
         ST    @11,$SLASHAD-4(@14,WAPTR)                           0138 00309000
*           END;                                                   0139 00310000
*         ELSE                                                     0140 00311000
*           ;                                                      0140 00312000
@RF00135 DS    0H                                                  0141 00313000
*       END;                                                       0141 00314000
         AL    I,@CF00072                                          0141 00315000
@DE00134 LA    @14,1                                               0141 00316000
         SLR   @11,@11                                             0141 00317000
         IC    @11,$DTORESP(,WAPTR)                                0141 00318000
         ALR   @14,@11                                             0141 00319000
         CR    I,@14                                               0141 00320000
         BNH   @DL00134                                            0141 00321000
*     END;                                                         0142 00322000
*   ELSE                            /* WORK AREA.                    */ 00323000
*     DO;                                                          0143 00324000
         B     @RC00131                                            0143 00325000
@RF00131 DS    0H                                                  0144 00326000
*       IF X>0 THEN                 /* CHECK FOR SLASH COUNT >0      */ 00327000
         LTR   X,X                                                 0144 00328000
         BNP   @RF00144                                            0144 00329000
*         DO;                                                      0145 00330000
*                                                                  0145 00331000
*/********************************************************************/ 00332000
*/* INPUT CONTAINS 1 OR MORE SLASHES (BUT NOT EXACTLY 3) THEN OUTPUT */ 00333000
*/* MESSAGE -106I INPUT DATA DOES NOT CONTAIN 3 SLASHES-             */ 00334000
*/********************************************************************/ 00335000
*                                                                  0146 00336000
*           /*********************************************************/ 00337000
*           /*                                                       */ 00338000
*           /* TCEC MSGN(106) INVOKED                                */ 00339000
*           /*                                                       */ 00340000
*           /*********************************************************/ 00341000
*                                                                  0146 00342000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00343000
         OI    $TCECM(WAPTR),B'00000001'                           0146 00344000
*           R1=ADDR($TCA16);        /* SET UP PARM LIST $TR          */ 00345000
         LA    R1,$TCA16                                           0147 00346000
*           CALL #EXIT;             /* CALL CECOM                    */ 00347000
         L     @15,#EXITA(,WAPTR)                                  0148 00348000
         BALR  @14,@15                                             0148 00349000
*           DCL                                                    0149 00350000
*             1 $TCA16,             /* TCEC PARM LIST                */ 00351000
*              2 $TCB16 FIXED(32) INIT(106),/* MSG NUMBER            */ 00352000
*              2 $TCC16 FIXED(32) INIT(0),/* INCT LEN                */ 00353000
*              2 $TCD16 BIT(8) INIT('00000000'B),/* FLAG             */ 00354000
*              2 $TCE16 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK   0149 00355000
*                                      ISSUE 106I MESSAGE.           */ 00356000
*           GO TO I02C0010;         /* GO RE-ISSUE 105D MESSAGE.     */ 00357000
         B     I02C0010                                            0150 00358000
*         END;                                                     0151 00359000
*       ELSE                                                       0152 00360000
*         ;                                                        0152 00361000
*                                                                  0152 00362000
@RF00144 DS    0H                                                  0153 00363000
*/********************************************************************/ 00364000
*/* NO SLASHES IN RESPONSE - THEN TRY FOR VALID VERB REQUESTS.       */ 00365000
*/********************************************************************/ 00366000
*                                                                  0153 00367000
*I02C0080:                                                         0153 00368000
*       $DEVCHNG=OFF;               /* RESET DEV CHANGE FLAG         */ 00369000
I02C0080 DS    0H                                                  0154 00370000
*       $TESTCNG=OFF;               /* RESET TEST CHANGE FLAG        */ 00371000
*       $OPTCHNG=OFF;               /* RESET OPT CHANGE FLAG         */ 00372000
         NI    $DEVCHNG(WAPTR),B'11000111'                         0155 00373000
*/********************************************************************/ 00374000
*/* CHECK LENGTH OF RESPONSE - MUST EQUAL LENGTH OF SELECTED VERB.   */ 00375000
*/********************************************************************/ 00376000
*                                                                  0156 00377000
*       IF DTCOUNT=4 THEN           /* CHECK FOR LENGTH 4 VERBS      */ 00378000
         CLI   DTCOUNT(WAPTR),4                                    0156 00379000
         BNE   @RF00156                                            0156 00380000
*         DO;                                                      0157 00381000
*                                                                  0157 00382000
*/********************************************************************/ 00383000
*/*                 CHECK FOR DUMP REQUEST                           */ 00384000
*/********************************************************************/ 00385000
*                                                                  0158 00386000
*           IF $DTORESP(2:5)^='DUMP' THEN                          0158 00387000
         CLC   $DTORESP+1(4,WAPTR),@CC00815                        0158 00388000
         BNE   @RT00158                                            0158 00389000
*             GO TO I02C0090;                                      0159 00390000
*           IF $OPCOM=ON            /* CHECK FOR CT=SYSTEM CNSL      */ 00391000
*               &$ALTPRTR=OFF THEN  /* AND NO ALT PRINTER            */ 00392000
         TM    $OPCOM(WAPTR),B'10000000'                           0160 00393000
         BNO   @RF00160                                            0160 00394000
         TM    $ALTPRTR(WAPTR),B'00000010'                         0160 00395000
         BNZ   @RF00160                                            0160 00396000
*             DO;                                                  0161 00397000
*                                                                  0161 00398000
*               /*****************************************************/ 00399000
*               /*                                                   */ 00400000
*               /* TCEC MSGN(546) INVOKED                            */ 00401000
*               /*                                                   */ 00402000
*               /*****************************************************/ 00403000
*                                                                  0162 00404000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00405000
         OI    $TCECM(WAPTR),B'00000001'                           0162 00406000
*               R1=ADDR($TCA17);    /* SET UP PARM LIST $TR          */ 00407000
         LA    R1,$TCA17                                           0163 00408000
*               CALL #EXIT;         /* CALL CECOM                    */ 00409000
         L     @15,#EXITA(,WAPTR)                                  0164 00410000
         BALR  @14,@15                                             0164 00411000
*               DCL                                                0165 00412000
*                 1 $TCA17,         /* TCEC PARM LIST                */ 00413000
*                  2 $TCB17 FIXED(32) INIT(546),/* MSG NUMBER        */ 00414000
*                  2 $TCC17 FIXED(32) INIT(0),/* INCT LEN            */ 00415000
*                  2 $TCD17 BIT(8) INIT('00000000'B),/* FLAG         */ 00416000
*                  2 $TCE17 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00417000
*               GO TO I02C0010;     /* GO RE-ISSUE 105D MESSAGE      */ 00418000
         B     I02C0010                                            0166 00419000
*             END;                                                 0167 00420000
*           ELSE                                                   0168 00421000
*             DO;                                                  0168 00422000
@RF00160 DS    0H                                                  0169 00423000
*               CALL ISTTC037;      /* CALL DUMP FUNCTION.           */ 00424000
         L     @15,@CV00823                                        0169 00425000
         BALR  @14,@15                                             0169 00426000
*               GO TO I02C0010;     /* GO RE-ISSUE 105D MESSAGE.     */ 00427000
         B     I02C0010                                            0170 00428000
*             END;                                                 0171 00429000
*                                                                  0171 00430000
*/********************************************************************/ 00431000
*/*                 CHECK FOR TALK REQUEST                           */ 00432000
*/********************************************************************/ 00433000
*                                                                  0172 00434000
*I02C0090:                                                         0172 00435000
*           IF $DTORESP(2:5)='TALK' THEN                           0172 00436000
I02C0090 CLC   $DTORESP+1(4,WAPTR),@CC00824                        0172 00437000
         BNE   @RF00172                                            0172 00438000
*             DO;                                                  0173 00439000
*                                                                  0173 00440000
*/********************************************************************/ 00441000
*/*   DETERMINE IF AN OLT IS ACTIVE AND HAS THE TALK CAPABILITY.     */ 00442000
*/********************************************************************/ 00443000
*                                                                  0174 00444000
*               IF $DYCOM=ON&$OLTACT=ON THEN                       0174 00445000
         TM    $DYCOM(WAPTR),B'00000001'                           0174 00446000
         BNO   @RF00174                                            0174 00447000
         TM    $OLTACT(WAPTR),B'00000001'                          0174 00448000
         BNO   @RF00174                                            0174 00449000
*                 DO;                                              0175 00450000
*                   $TALK=ON;       /* SET $TALK FLAG IN SCT.        */ 00451000
         OI    $TALK(WAPTR),B'10000000'                            0176 00452000
*                   GO TO I02C0230; /* RETURN TO ACTIVE OLT.         */ 00453000
         B     I02C0230                                            0177 00454000
*                 END;                                             0178 00455000
*               ELSE                                               0179 00456000
*                 ;                                                0179 00457000
@RF00174 DS    0H                                                  0180 00458000
*               DO;                                                0180 00459000
*                                                                  0180 00460000
*/********************************************************************/ 00461000
*/* OUTPUT MESSAGE 166I OLT DOES NOT HAVE TALK CAPABILITY.           */ 00462000
*/********************************************************************/ 00463000
*                                                                  0181 00464000
*                 /***************************************************/ 00465000
*                 /*                                                 */ 00466000
*                 /* TCEC MSGN(166) INVOKED                          */ 00467000
*                 /*                                                 */ 00468000
*                 /***************************************************/ 00469000
*                                                                  0181 00470000
*                 $TCECM='1'B;      /* SET TCEC SW IN RCA            */ 00471000
         OI    $TCECM(WAPTR),B'00000001'                           0181 00472000
*                 R1=ADDR($TCA18);  /* SET UP PARM LIST $TR          */ 00473000
         LA    R1,$TCA18                                           0182 00474000
*                 CALL #EXIT;       /* CALL CECOM                    */ 00475000
         L     @15,#EXITA(,WAPTR)                                  0183 00476000
         BALR  @14,@15                                             0183 00477000
*                 DCL                                              0184 00478000
*                   1 $TCA18,       /* TCEC PARM LIST                */ 00479000
*                    2 $TCB18 FIXED(32) INIT(166),/* MSG NUMBER      */ 00480000
*                    2 $TCC18 FIXED(32) INIT(0),/* INCT LEN          */ 00481000
*                    2 $TCD18 BIT(8) INIT('00000000'B),/* FLAG       */ 00482000
*                    2 $TCE18 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE  0184 00483000
*                                      MASK                          */ 00484000
*                 GO TO I02C0010;   /* RE-ISSUE 105D MSG.            */ 00485000
         B     I02C0010                                            0185 00486000
*               END;                                               0186 00487000
*             END;                                                 0187 00488000
*           ELSE                                                   0188 00489000
*             GO TO I02C0120;       /* GO CHECK FOR CT=              */ 00490000
*         END;                                                     0189 00491000
*       ELSE                                                       0190 00492000
*         ;                                                        0190 00493000
@RF00156 DS    0H                                                  0191 00494000
*       IF DTCOUNT=6 THEN           /* CHECK VERBS OF LENGTH 6       */ 00495000
         CLI   DTCOUNT(WAPTR),6                                    0191 00496000
         BNE   @RF00191                                            0191 00497000
*         DO;                                                      0192 00498000
*                                                                  0192 00499000
*/********************************************************************/ 00500000
*/*                   CHECK FOR CANCEL REQUEST                       */ 00501000
*/********************************************************************/ 00502000
*                                                                  0193 00503000
*           IF $DTORESP(2:7)='CANCEL' THEN                         0193 00504000
         CLC   $DTORESP+1(6,WAPTR),@CC00834                        0193 00505000
         BNE   @RF00193                                            0193 00506000
*             DO;                                                  0194 00507000
*I02C0092:                          /*                       @D32JPFR*/ 00508000
*               $CANCEL=ON;         /* INDICATE CANCEL IN PROGRESS   */ 00509000
I02C0092 OI    $CANCEL(WAPTR),B'00000010'                          0195 00510000
*               CALL C14C0020;      /* CALL LOGOFF, NO RETURN.       */ 00511000
         L     @15,@CV00836                                        0196 00512000
         BALR  @14,@15                                             0196 00513000
*             END;                                                 0197 00514000
*           ELSE                                                   0198 00515000
*             ;                                                    0198 00516000
*                                                                  0198 00517000
@RF00193 DS    0H                                                  0199 00518000
*/********************************************************************/ 00519000
*/*                   CHECK FOR PROMPT REQUEST                       */ 00520000
*/********************************************************************/ 00521000
*                                                                  0199 00522000
*           IF $DTORESP(2:7)='PROMPT' THEN                         0199 00523000
         CLC   $DTORESP+1(6,WAPTR),@CC00837                        0199 00524000
         BE    @RT00199                                            0199 00525000
*             GO TO I02C0110;       /* GO ISSUE PROMPT MSGS          */ 00526000
*           ELSE                                                   0201 00527000
*             ;                                                    0201 00528000
*                                                                  0201 00529000
*/********************************************************************/ 00530000
*/*                 CHECK FOR UPDATE REQUEST                         */ 00531000
*/********************************************************************/ 00532000
*                                                                  0202 00533000
*           IF $DTORESP(2:7)^='UPDATE' THEN                        0202 00534000
         CLC   $DTORESP+1(6,WAPTR),@CC00839                        0202 00535000
         BNE   @RT00202                                            0202 00536000
*             GO TO I02C0120;       /* GO CHECK FOR CT=TERM INPUT    */ 00537000
*/********************************************************************/ 00538000
*/* CHECK FOR NON-DOS SYSTEM BEFORE ALLOWING UPDATE.                 */ 00539000
*/* IF THE NUMBER OF TOLTEP USERS IS GREATER THAN 1, UPDATE FUNCTION */ 00540000
*/* IS UNAVAILABLE AT THIS TIME.                                     */ 00541000
*/********************************************************************/ 00542000
*                                                                  0204 00543000
*           $UPDATE=ON;             /*                       @DA04680*/ 00544000
         OI    $UPDATE(RCAPTR),B'10000000'                         0204 00545000
*           IF $USECNT>1|$DRIVER='87'X THEN                        0205 00546000
         LH    @14,$USECNT(,RCAPTR)                                0205 00547000
         C     @14,@CF00072                                        0205 00548000
         BH    @RT00205                                            0205 00549000
         CLI   $DRIVER(WAPTR),X'87'                                0205 00550000
         BNE   @RF00205                                            0205 00551000
@RT00205 DS    0H                                                  0206 00552000
*             DO;                                                  0206 00553000
*               $UPDATE=OFF;        /*                       @DA04680*/ 00554000
*                                                                  0207 00555000
         NI    $UPDATE(RCAPTR),B'01111111'                         0207 00556000
*               /*****************************************************/ 00557000
*               /*                                                   */ 00558000
*               /* TCEC MSGN(551)MSGMSK('40000000'X) INVOKED         */ 00559000
*               /*                                                   */ 00560000
*               /*****************************************************/ 00561000
*                                                                  0208 00562000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00563000
         OI    $TCECM(WAPTR),B'00000001'                           0208 00564000
*               R1=ADDR($TCA19);    /* SET UP PARM LIST $TR          */ 00565000
         LA    R1,$TCA19                                           0209 00566000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00567000
         L     @15,@CV00842                                        0210 00568000
         BALR  @14,@15                                             0210 00569000
*               DCL                                                0211 00570000
*                 1 $TCA19,         /* TCEC PARM LIST                */ 00571000
*                  2 $TCB19 FIXED(32) INIT(551),/* MSG NUMBER        */ 00572000
*                  2 $TCC19 FIXED(32) INIT(0),/* INCT LEN            */ 00573000
*                  2 $TCD19 BIT(8) INIT('00000000'B),/* FLAG         */ 00574000
*                  2 $TCE19 CHAR(4) INIT('40000000'X);/* MSSAGE MASK */ 00575000
*               GO TO I02C0010;     /* REISSUE 105D MESSAGE          */ 00576000
         B     I02C0010                                            0212 00577000
*             END;                                                 0213 00578000
*                                                                  0213 00579000
*/********************************************************************/ 00580000
*/*            ASK NETWORK OPERATOR PERMISSION TO UPDATE             */ 00581000
*/********************************************************************/ 00582000
*                                                                  0214 00583000
*           IF $OPCOM=ON THEN       /* IF CT IS SAME AS SYSTEM     0214 00584000
*                                      CONSOLE, NO NEED FOR        0214 00585000
*                                      PERMISSION.                   */ 00586000
@RF00205 TM    $OPCOM(WAPTR),B'10000000'                           0214 00587000
         BO    @RT00214                                            0214 00588000
*             GO TO I02C0100;                                      0215 00589000
*           $INBUFR(1:8)=$SYSMN(1); /* CT NAME TO MESSAGE            */ 00590000
*                                                                  0216 00591000
         MVC   $INBUFR(8,WAPTR),$SYSMN(WAPTR)                      0216 00592000
*           /*********************************************************/ 00593000
*           /*                                                       */ 00594000
*           /* TCEC MSGN(550)INCT(61)SUB(YES)DIR(NET) INVOKED        */ 00595000
*           /*                                                       */ 00596000
*           /*********************************************************/ 00597000
*                                                                  0217 00598000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00599000
         OI    $TCECM(WAPTR),B'00000001'                           0217 00600000
*           R1=ADDR($TCA20);        /* SET UP PARM LIST $TR          */ 00601000
         LA    R1,$TCA20                                           0218 00602000
*           CALL #EXIT;             /* CALL CECOM                    */ 00603000
         L     @15,#EXITA(,WAPTR)                                  0219 00604000
         BALR  @14,@15                                             0219 00605000
*           DCL                                                    0220 00606000
*             1 $TCA20,             /* TCEC PARM LIST                */ 00607000
*              2 $TCB20 FIXED(32) INIT(550),/* MSG NUMBER            */ 00608000
*              2 $TCC20 FIXED(32) INIT(61),/* INCT LEN               */ 00609000
*              2 $TCD20 BIT(8) INIT('11001000'B),/* FLAG             */ 00610000
*              2 $TCE20 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK     */ 00611000
*I02C0095:                                                         0221 00612000
*           IF^($INBUFR(2)='Y'      /* IF INPUT IS NOT Y OR N        */ 00613000
*               |$INBUFR(2)='N')|($INBUFR(1)>1&$INBUFR(3)^=',') THEN    00614000
I02C0095 CLI   $INBUFR+1(WAPTR),C'Y'                               0221 00615000
         BE    @GL00005                                            0221 00616000
         CLI   $INBUFR+1(WAPTR),C'N'                               0221 00617000
         BNE   @RT00221                                            0221 00618000
@GL00005 CLI   $INBUFR(WAPTR),1                                    0221 00619000
         BNH   @RF00221                                            0221 00620000
         CLI   $INBUFR+2(WAPTR),C','                               0221 00621000
         BE    @RF00221                                            0221 00622000
@RT00221 DS    0H                                                  0222 00623000
*             DO;                                                  0222 00624000
*                                                                  0222 00625000
*/********************************************************************/ 00626000
*/* OUTPUT 299D INCORRECT RESPONSE MESSAGE IF INPUT IS NOT           */ 00627000
*/* ACCEPTABLE.                                                      */ 00628000
*/********************************************************************/ 00629000
*                                                                  0223 00630000
*               /*****************************************************/ 00631000
*               /*                                                   */ 00632000
*               /* TCEC MSGN(299)INCT(61)DIR(NET) INVOKED            */ 00633000
*               /*                                                   */ 00634000
*               /*****************************************************/ 00635000
*                                                                  0223 00636000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00637000
         OI    $TCECM(WAPTR),B'00000001'                           0223 00638000
*               R1=ADDR($TCA21);    /* SET UP PARM LIST $TR          */ 00639000
         LA    R1,$TCA21                                           0224 00640000
*               CALL #EXIT;         /* CALL CECOM                    */ 00641000
         L     @15,#EXITA(,WAPTR)                                  0225 00642000
         BALR  @14,@15                                             0225 00643000
*               DCL                                                0226 00644000
*                 1 $TCA21,         /* TCEC PARM LIST                */ 00645000
*                  2 $TCB21 FIXED(32) INIT(299),/* MSG NUMBER        */ 00646000
*                  2 $TCC21 FIXED(32) INIT(61),/* INCT LEN           */ 00647000
*                  2 $TCD21 BIT(8) INIT('01001000'B),/* FLAG         */ 00648000
*                  2 $TCE21 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00649000
*               GO TO I02C0095;     /* GO DECODE REPLY               */ 00650000
         B     I02C0095                                            0227 00651000
*             END;                                                 0228 00652000
*           ELSE                                                   0229 00653000
*             DO;                                                  0229 00654000
@RF00221 DS    0H                                                  0230 00655000
*               T463C=T463B;        /* MOVE INBUFFER DATA            */ 00656000
         MVC   @TS00001(61),T463B(WAPTR)                           0230 00657000
         MVC   T463C(61,WAPTR),@TS00001                            0230 00658000
*               T463A='550';        /* INSERT MSG NUMBER             */ 00659000
         MVC   T463A(3,WAPTR),@CC00868                             0231 00660000
*               IF $INBUFR(5)=',' THEN                             0232 00661000
         CLI   $INBUFR+4(WAPTR),C','                               0232 00662000
         BNE   @RF00232                                            0232 00663000
*                 DO;                                              0233 00664000
*                                                                  0233 00665000
*                   /*************************************************/ 00666000
*                   /*                                               */ 00667000
*                   /* TCEC MSGN(463)SUB(YES)MSGMSK('C0000000'X)     */ 00668000
*                   /* INVOKED                                       */ 00669000
*                   /*                                               */ 00670000
*                   /*************************************************/ 00671000
*                                                                  0234 00672000
*                   $TCECM='1'B;    /* SET TCEC SW IN RCA            */ 00673000
         OI    $TCECM(WAPTR),B'00000001'                           0234 00674000
*                   R1=ADDR($TCA22);/* SET UP PARM LIST $TR          */ 00675000
         LA    R1,$TCA22                                           0235 00676000
*                   CALL S20CEC03;  /* CALL TCEC-MULTIPLE LN         */ 00677000
         L     @15,@CV00842                                        0236 00678000
         BALR  @14,@15                                             0236 00679000
*                   DCL                                            0237 00680000
*                     1 $TCA22,     /* TCEC PARM LIST                */ 00681000
*                      2 $TCB22 FIXED(32) INIT(463),/* MSG NUMBER    */ 00682000
*                      2 $TCC22 FIXED(32) INIT(0),/* INCT LEN        */ 00683000
*                      2 $TCD22 BIT(8) INIT('10000000'B),/* FLAG     */ 00684000
*                      2 $TCE22 CHAR(4) INIT('C0000000'X);/* MSSAGE     00685000
*                                      MASK                          */ 00686000
*                 END;                                             0238 00687000
*               IF $INBUFR(4)='N' THEN                             0239 00688000
@RF00232 CLI   $INBUFR+3(WAPTR),C'N'                               0239 00689000
         BNE   @RF00239                                            0239 00690000
*                 DO;                                              0240 00691000
*                                                                  0240 00692000
*                   /*************************************************/ 00693000
*                   /*                                               */ 00694000
*                   /* TCEC MSGN(254) INVOKED                        */ 00695000
*                   /*                                               */ 00696000
*                   /*************************************************/ 00697000
*                                                                  0241 00698000
*                   $TCECM='1'B;    /* SET TCEC SW IN RCA            */ 00699000
         OI    $TCECM(WAPTR),B'00000001'                           0241 00700000
*                   R1=ADDR($TCA23);/* SET UP PARM LIST $TR          */ 00701000
         LA    R1,$TCA23                                           0242 00702000
*                   CALL #EXIT;     /* CALL CECOM                    */ 00703000
         L     @15,#EXITA(,WAPTR)                                  0243 00704000
         BALR  @14,@15                                             0243 00705000
*                   DCL                                            0244 00706000
*                     1 $TCA23,     /* TCEC PARM LIST                */ 00707000
*                      2 $TCB23 FIXED(32) INIT(254),/* MSG NUMBER    */ 00708000
*                      2 $TCC23 FIXED(32) INIT(0),/* INCT LEN        */ 00709000
*                      2 $TCD23 BIT(8) INIT('00000000'B),/* FLAG     */ 00710000
*                      2 $TCE23 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE     00711000
*                                      MASK                          */ 00712000
*                   $UPDATE=OFF;    /*                       @DA04680*/ 00713000
         NI    $UPDATE(RCAPTR),B'01111111'                         0245 00714000
*                   GO TO I02C0010;                                0246 00715000
         B     I02C0010                                            0246 00716000
*                 END;                                             0247 00717000
*I02C0100:                                                         0248 00718000
*                                                                  0248 00719000
*/********************************************************************/ 00720000
*/* IF THIS IS NOT THE INITIAL D/T/O/ ENTRY, THEN CALL DTERM TO CLEAN*/ 00721000
*/* UP ANY POSSIBLE ACTIVE TEST OR DEVICES (ALL TEST DEVICES WILL BE */ 00722000
*/* RELEASED.)                                                       */ 00723000
*/********************************************************************/ 00724000
*                                                                  0248 00725000
*               CALL ISTTC035;                                     0248 00726000
@RF00239 DS    0H                                                  0248 00727000
I02C0100 L     @15,@CV00883                                        0248 00728000
         BALR  @14,@15                                             0248 00729000
*               CALL ISTIC006;      /* CALL THE UPDATE MODULES       */ 00730000
         L     @15,@CV00885                                        0249 00731000
         BALR  @14,@15                                             0249 00732000
*/****************************************************************** */ 00733000
*/* RESET VALID DEVICE AND TEST FIELD INDICATORS TO FORCE            */ 00734000
*/* REDEFINITION OF THESE FIELDS.                                    */ 00735000
*/****************************************************************** */ 00736000
*                                                                  0250 00737000
*               $VALDDEV=OFF;                                      0250 00738000
*               $VALDTST=OFF;       /* SET UPDATE INACTIVE           */ 00739000
         NI    $VALDDEV(WAPTR),B'11110011'                         0251 00740000
*               $UPDATE=OFF;        /* RE-ISSUE 105D MESSAGE         */ 00741000
         NI    $UPDATE(RCAPTR),B'01111111'                         0252 00742000
*               GO TO I02C0010;                                    0253 00743000
         B     I02C0010                                            0253 00744000
*             END;                                                 0254 00745000
*         END;                      /* END OF CHECK FOR VERBS OF   0255 00746000
*                                      LENGTH SIX                    */ 00747000
*       IF DTCOUNT=10 THEN          /* CHECK VERB OF LENGTH 10.      */ 00748000
@RF00191 CLI   DTCOUNT(WAPTR),10                                   0256 00749000
         BNE   @RF00256                                            0256 00750000
*         DO;                                                      0257 00751000
*                                                                  0257 00752000
*/********************************************************************/ 00753000
*/*                 CHECK FOR PROMPT ALL REQUEST                     */ 00754000
*/********************************************************************/ 00755000
*                                                                  0258 00756000
*           IF $DTORESP(2:11)='PROMPT ALL' THEN                    0258 00757000
         CLC   $DTORESP+1(10,WAPTR),@CC00888                       0258 00758000
         BNE   @RF00258                                            0258 00759000
*             DO;                                                  0259 00760000
*I02C0110:                                                         0260 00761000
*                                                                  0260 00762000
*               /*****************************************************/ 00763000
*               /*                                                   */ 00764000
*               /* TCEC MSGN(147)MSGMSK('FFFFFFFF'X) INVOKED         */ 00765000
*               /*                                                   */ 00766000
*               /*****************************************************/ 00767000
*                                                                  0260 00768000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00769000
I02C0110 OI    $TCECM(WAPTR),B'00000001'                           0260 00770000
*               R1=ADDR($TCA24);    /* SET UP PARM LIST $TR          */ 00771000
         LA    R1,$TCA24                                           0261 00772000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00773000
         L     @15,@CV00842                                        0262 00774000
         BALR  @14,@15                                             0262 00775000
*               DCL                                                0263 00776000
*                 1 $TCA24,         /* TCEC PARM LIST                */ 00777000
*                  2 $TCB24 FIXED(32) INIT(147),/* MSG NUMBER        */ 00778000
*                  2 $TCC24 FIXED(32) INIT(0),/* INCT LEN            */ 00779000
*                  2 $TCD24 BIT(8) INIT('00000000'B),/* FLAG         */ 00780000
*                  2 $TCE24 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00781000
*                                                                  0263 00782000
*               /*****************************************************/ 00783000
*               /*                                                   */ 00784000
*               /* TCEC MSGN(148)MSGMSK('FFFFFFFF'X) INVOKED         */ 00785000
*               /*                                                   */ 00786000
*               /*****************************************************/ 00787000
*                                                                  0264 00788000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00789000
         OI    $TCECM(WAPTR),B'00000001'                           0264 00790000
*               R1=ADDR($TCA25);    /* SET UP PARM LIST $TR          */ 00791000
         LA    R1,$TCA25                                           0265 00792000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00793000
         L     @15,@CV00842                                        0266 00794000
         BALR  @14,@15                                             0266 00795000
*               DCL                                                0267 00796000
*                 1 $TCA25,         /* TCEC PARM LIST                */ 00797000
*                  2 $TCB25 FIXED(32) INIT(148),/* MSG NUMBER        */ 00798000
*                  2 $TCC25 FIXED(32) INIT(0),/* INCT LEN            */ 00799000
*                  2 $TCD25 BIT(8) INIT('00000000'B),/* FLAG         */ 00800000
*                  2 $TCE25 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00801000
*                                                                  0267 00802000
*               /*****************************************************/ 00803000
*               /*                                                   */ 00804000
*               /* TCEC MSGN(149)MSGMSK('FFFFFFFF'X) INVOKED         */ 00805000
*               /*                                                   */ 00806000
*               /*****************************************************/ 00807000
*                                                                  0268 00808000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00809000
         OI    $TCECM(WAPTR),B'00000001'                           0268 00810000
*               R1=ADDR($TCA26);    /* SET UP PARM LIST $TR          */ 00811000
         LA    R1,$TCA26                                           0269 00812000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00813000
         L     @15,@CV00842                                        0270 00814000
         BALR  @14,@15                                             0270 00815000
*               DCL                                                0271 00816000
*                 1 $TCA26,         /* TCEC PARM LIST                */ 00817000
*                  2 $TCB26 FIXED(32) INIT(149),/* MSG NUMBER        */ 00818000
*                  2 $TCC26 FIXED(32) INIT(0),/* INCT LEN            */ 00819000
*                  2 $TCD26 BIT(8) INIT('00000000'B),/* FLAG         */ 00820000
*                  2 $TCE26 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00821000
*                                                                  0271 00822000
*               /*****************************************************/ 00823000
*               /*                                                   */ 00824000
*               /* TCEC MSGN(141)MSGMSK('FFFFFFFF'X) INVOKED         */ 00825000
*               /*                                                   */ 00826000
*               /*****************************************************/ 00827000
*                                                                  0272 00828000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00829000
         OI    $TCECM(WAPTR),B'00000001'                           0272 00830000
*               R1=ADDR($TCA27);    /* SET UP PARM LIST $TR          */ 00831000
         LA    R1,$TCA27                                           0273 00832000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00833000
         L     @15,@CV00842                                        0274 00834000
         BALR  @14,@15                                             0274 00835000
*               DCL                                                0275 00836000
*                 1 $TCA27,         /* TCEC PARM LIST                */ 00837000
*                  2 $TCB27 FIXED(32) INIT(141),/* MSG NUMBER        */ 00838000
*                  2 $TCC27 FIXED(32) INIT(0),/* INCT LEN            */ 00839000
*                  2 $TCD27 BIT(8) INIT('00000000'B),/* FLAG         */ 00840000
*                  2 $TCE27 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00841000
*               GO TO I02C0010;     /* GO RE-ISSUE 105D MESSAGE      */ 00842000
         B     I02C0010                                            0276 00843000
*             END;                                                 0277 00844000
*           ELSE                                                   0278 00845000
*             ;                                                    0278 00846000
@RF00258 DS    0H                                                  0279 00847000
*           IF $DTORESP(2:11)='PROMPT DEV' THEN                    0279 00848000
         CLC   $DTORESP+1(10,WAPTR),@CC00914                       0279 00849000
         BNE   @RF00279                                            0279 00850000
*             DO;                                                  0280 00851000
*                                                                  0280 00852000
*               /*****************************************************/ 00853000
*               /*                                                   */ 00854000
*               /* TCEC MSGN(147)MSGMSK('FFFFFFFF'X) INVOKED         */ 00855000
*               /*                                                   */ 00856000
*               /*****************************************************/ 00857000
*                                                                  0281 00858000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00859000
         OI    $TCECM(WAPTR),B'00000001'                           0281 00860000
*               R1=ADDR($TCA28);    /* SET UP PARM LIST $TR          */ 00861000
         LA    R1,$TCA28                                           0282 00862000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00863000
         L     @15,@CV00842                                        0283 00864000
         BALR  @14,@15                                             0283 00865000
*               DCL                                                0284 00866000
*                 1 $TCA28,         /* TCEC PARM LIST                */ 00867000
*                  2 $TCB28 FIXED(32) INIT(147),/* MSG NUMBER        */ 00868000
*                  2 $TCC28 FIXED(32) INIT(0),/* INCT LEN            */ 00869000
*                  2 $TCD28 BIT(8) INIT('00000000'B),/* FLAG         */ 00870000
*                  2 $TCE28 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00871000
*               GO TO I02C0010;     /* GO RE-ISSUE 105D MESSAGE      */ 00872000
         B     I02C0010                                            0285 00873000
*             END;                                                 0286 00874000
*           ELSE                                                   0287 00875000
*             ;                                                    0287 00876000
@RF00279 DS    0H                                                  0288 00877000
*           IF $DTORESP(2:11)='PROMPT OPT' THEN                    0288 00878000
         CLC   $DTORESP+1(10,WAPTR),@CC00921                       0288 00879000
         BNE   @RF00288                                            0288 00880000
*             DO;                                                  0289 00881000
*                                                                  0289 00882000
*               /*****************************************************/ 00883000
*               /*                                                   */ 00884000
*               /* TCEC MSGN(149)MSGMSK('FFFFFFFF'X) INVOKED         */ 00885000
*               /*                                                   */ 00886000
*               /*****************************************************/ 00887000
*                                                                  0290 00888000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00889000
         OI    $TCECM(WAPTR),B'00000001'                           0290 00890000
*               R1=ADDR($TCA29);    /* SET UP PARM LIST $TR          */ 00891000
         LA    R1,$TCA29                                           0291 00892000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00893000
         L     @15,@CV00842                                        0292 00894000
         BALR  @14,@15                                             0292 00895000
*               DCL                                                0293 00896000
*                 1 $TCA29,         /* TCEC PARM LIST                */ 00897000
*                  2 $TCB29 FIXED(32) INIT(149),/* MSG NUMBER        */ 00898000
*                  2 $TCC29 FIXED(32) INIT(0),/* INCT LEN            */ 00899000
*                  2 $TCD29 BIT(8) INIT('00000000'B),/* FLAG         */ 00900000
*                  2 $TCE29 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00901000
*               GO TO I02C0010;     /* GO RE-ISSUE 105D MESSAGE      */ 00902000
         B     I02C0010                                            0294 00903000
*             END;                                                 0295 00904000
*           ELSE                                                   0296 00905000
*             GO TO I02C0120;       /* CO CHECK FOR CT=.             */ 00906000
*         END;                                                     0297 00907000
*       ELSE                                                       0298 00908000
*         ;                                                        0298 00909000
*                                                                  0298 00910000
@RF00256 DS    0H                                                  0299 00911000
*/********************************************************************/ 00912000
*/*                 CHECK FOR PROMPT TEST REQUEST                    */ 00913000
*/********************************************************************/ 00914000
*                                                                  0299 00915000
*       IF DTCOUNT=11 THEN          /* CHECK LENGTH 11 VERBS.        */ 00916000
         CLI   DTCOUNT(WAPTR),11                                   0299 00917000
         BNE   @RF00299                                            0299 00918000
*         DO;                                                      0300 00919000
*           IF $DTORESP(2:12)='PROMPT TEST' THEN                   0301 00920000
         CLC   $DTORESP+1(11,WAPTR),@CC00928                       0301 00921000
         BNE   @RF00301                                            0301 00922000
*             DO;                                                  0302 00923000
*                                                                  0302 00924000
*               /*****************************************************/ 00925000
*               /*                                                   */ 00926000
*               /* TCEC MSGN(148)MSGMSK('FFFFFFFF'X) INVOKED         */ 00927000
*               /*                                                   */ 00928000
*               /*****************************************************/ 00929000
*                                                                  0303 00930000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00931000
         OI    $TCECM(WAPTR),B'00000001'                           0303 00932000
*               R1=ADDR($TCA30);    /* SET UP PARM LIST $TR          */ 00933000
         LA    R1,$TCA30                                           0304 00934000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00935000
         L     @15,@CV00842                                        0305 00936000
         BALR  @14,@15                                             0305 00937000
*               DCL                                                0306 00938000
*                 1 $TCA30,         /* TCEC PARM LIST                */ 00939000
*                  2 $TCB30 FIXED(32) INIT(148),/* MSG NUMBER        */ 00940000
*                  2 $TCC30 FIXED(32) INIT(0),/* INCT LEN            */ 00941000
*                  2 $TCD30 BIT(8) INIT('00000000'B),/* FLAG         */ 00942000
*                  2 $TCE30 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00943000
*               GO TO I02C0010;     /* GO RE-ISSUE 105D MESSAGE      */ 00944000
         B     I02C0010                                            0307 00945000
*             END;                                                 0308 00946000
*           IF $DTORESP(2:12)='PROMPT VERB' THEN                   0309 00947000
*                                                                  0309 00948000
@RF00301 CLC   $DTORESP+1(11,WAPTR),@CC00935                       0309 00949000
         BNE   @RF00309                                            0309 00950000
*/********************************************************************/ 00951000
*/*               CHECK FOR PROMPT VERB REQUEST                      */ 00952000
*/********************************************************************/ 00953000
*                                                                  0310 00954000
*             DO;                                                  0310 00955000
*                                                                  0310 00956000
*               /*****************************************************/ 00957000
*               /*                                                   */ 00958000
*               /* TCEC MSGN(141)MSGMSK('FFFFFFFF'X) INVOKED         */ 00959000
*               /*                                                   */ 00960000
*               /*****************************************************/ 00961000
*                                                                  0311 00962000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 00963000
         OI    $TCECM(WAPTR),B'00000001'                           0311 00964000
*               R1=ADDR($TCA31);    /* SET UP PARM LIST $TR          */ 00965000
         LA    R1,$TCA31                                           0312 00966000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 00967000
         L     @15,@CV00842                                        0313 00968000
         BALR  @14,@15                                             0313 00969000
*               DCL                                                0314 00970000
*                 1 $TCA31,         /* TCEC PARM LIST                */ 00971000
*                  2 $TCB31 FIXED(32) INIT(141),/* MSG NUMBER        */ 00972000
*                  2 $TCC31 FIXED(32) INIT(0),/* INCT LEN            */ 00973000
*                  2 $TCD31 BIT(8) INIT('00000000'B),/* FLAG         */ 00974000
*                  2 $TCE31 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 00975000
*               GO TO I02C0010;     /* GO REISSUE 105D MESSAGE       */ 00976000
         B     I02C0010                                            0315 00977000
*             END;                                                 0316 00978000
*           ELSE                                                   0317 00979000
*             GO TO I02C0120;       /* GO CHECK FOR CT=.             */ 00980000
*         END;                                                     0318 00981000
*       ELSE                                                       0319 00982000
*         ;                                                        0319 00983000
*                                                                  0319 00984000
@RF00299 DS    0H                                                  0320 00985000
*/********************************************************************/ 00986000
*/*                      CHECK FOR CT=NEWCT                          */ 00987000
*/********************************************************************/ 00988000
*                                                                  0320 00989000
*I02C0120:                                                         0320 00990000
*       IF $DTORESP(2:4)^='CT=' THEN                               0320 00991000
I02C0120 CLC   $DTORESP+1(3,WAPTR),@CC00942                        0320 00992000
         BNE   @RT00320                                            0320 00993000
*         GO TO I02C0150;                                          0321 00994000
*       I=$DTORESP(1:1)+1;          /* POINTER TO LAST INPUT CHAR    */ 00995000
         LA    I,1                                                 0322 00996000
         SLR   @14,@14                                             0322 00997000
         IC    @14,$DTORESP(,WAPTR)                                0322 00998000
         ALR   I,@14                                               0322 00999000
*/********************************************************************/ 01000000
*/* CT NAME IS CHECKED FOR VALID LENGTH (FROM 1 TO 8 CHARACTERS)     */ 01001000
*/********************************************************************/ 01002000
*                                                                  0323 01003000
*       IF I<5|I>12 THEN            /* VALID LENGTH IS 1 TO 8        */ 01004000
         C     I,@CF00348                                          0323 01005000
         BL    @RT00323                                            0323 01006000
         C     I,@CF00134                                          0323 01007000
         BH    @RT00323                                            0323 01008000
*         GO TO I02C0150;           /* GO ISSUE 299D MESSAGE         */ 01009000
*       IF $DTORESP(5:5)>'EF'X      /* IS FIRST CHAR NUMERIC         */ 01010000
*           &$DTORESP(5:5)<'FA'X THEN                              0325 01011000
         CLI   $DTORESP+4(WAPTR),X'EF'                             0325 01012000
         BNH   @RF00325                                            0325 01013000
         CLI   $DTORESP+4(WAPTR),X'FA'                             0325 01014000
         BNL   @RF00325                                            0325 01015000
*         DO;                                                      0326 01016000
*                                                                  0326 01017000
*/****************************************************************** */ 01018000
*/*              CT=TERMINAL IS IN UNIT ADDRESS FORMAT               */ 01019000
*/****************************************************************** */ 01020000
*                                                                  0327 01021000
*           CTNAME='00000000';      /* INITIALIZE 8 BYTES TO FO      */ 01022000
         MVC   CTNAME(8,WAPTR),@CC00947                            0327 01023000
*           CTNAME((13-I):8)=$DTORESP(5:I);                        0328 01024000
         LA    @14,13                                              0328 01025000
         SLR   @14,I                                               0328 01026000
         ST    @14,@TF00001                                        0328 01027000
         ALR   @14,WAPTR                                           0328 01028000
         LA    @11,8                                               0328 01029000
         SL    @11,@TF00001                                        0328 01030000
         MVC   @TS00001(8),$DTORESP+4(WAPTR)                       0328 01031000
         EX    @11,@SM01138                                        0328 01032000
*           TEMPFLGS='00'X;         /* INDICATE UNIT ADDRESS         */ 01033000
*                                                                  0329 01034000
         MVI   TEMPFLGS(WAPTR),X'00'                               0329 01035000
*           /*********************************************************/ 01036000
*           /*                                                       */ 01037000
*           /* ITACONV FROM(CTNAME)TO(CDSUAD)TYPE(EH)COUNT(8) INVOKED*/ 01038000
*           /*                                                       */ 01039000
*           /*********************************************************/ 01040000
*                                                                  0330 01041000
*           DCL                                                    0330 01042000
*             1 ITATCPRM BDY(WORD), /* CONVERT PARAMETER LIST        */ 01043000
*              2 * CHAR(4) INIT('0102F4F1'X),                      0330 01044000
*              2 ITATCFR PTR,       /* ADDRESS OF FROM FIELD         */ 01045000
*              2 ITATCTO PTR,       /* ADDRESS OF TO FIELD           */ 01046000
*              2 * BIT(8) INIT(0),  /* FLAGS FOR CONVERT MODULE      */ 01047000
*               3 ITATCTP BIT(1),   /* TYPE OF CONVERT REQUIRED      */ 01048000
*              2 ITATCNT FIXED(8);  /* NUMBER OF BYTES TO CONVERT    */ 01049000
*           ITATCFR=ADDR(CTNAME);   /* SET THE FROM ADDRESS          */ 01050000
         LA    @14,CTNAME(,WAPTR)                                  0331 01051000
         ST    @14,ITATCFR                                         0331 01052000
*           ITATCTO=ADDR(CDSUAD);   /* SET THE TO ADDRESS            */ 01053000
         LA    @14,CDSUAD(,WAPTR)                                  0332 01054000
         ST    @14,ITATCTO                                         0332 01055000
*           ITATCTP='0'B;           /* SET THE TYPE OF CONVERT BIT   */ 01056000
         NI    ITATCTP,B'01111111'                                 0333 01057000
*           ITATCNT=8;              /* GIVE THE CONVERT BYTE COUNT   */ 01058000
         MVI   ITATCNT,X'08'                                       0334 01059000
*           R1=ADDR(ITATCPRM);      /* POINT TO CONVERT PARM LIST    */ 01060000
         LA    R1,ITATCPRM                                         0335 01061000
*           CALL ISTSC021;          /* CALL CONVERT DIRECTLY         */ 01062000
         L     @15,@CV00957                                        0336 01063000
         BALR  @14,@15                                             0336 01064000
*           IF R15^=0 THEN          /* IF CONVERT FAILED             */ 01065000
         LTR   R15,R15                                             0337 01066000
         BNZ   @RT00337                                            0337 01067000
*             GO TO I02C0150;       /* GO ISSUE 299D MESSAGE         */ 01068000
*         END;                                                     0339 01069000
*       ELSE                                                       0340 01070000
*         DO;                                                      0340 01071000
*                                                                  0340 01072000
         B     @RC00325                                            0340 01073000
@RF00325 DS    0H                                                  0341 01074000
*/****************************************************************** */ 01075000
*/*        CT=TERMINAL INPUT IS A SYMBOLIC NAME, NOT A UNIT ADDRESS  */ 01076000
*/****************************************************************** */ 01077000
*                                                                  0341 01078000
*           TEMPFLGS='0A'X;         /* INDICATE SYMBOLIC NAME        */ 01079000
         MVI   TEMPFLGS(WAPTR),X'0A'                               0341 01080000
*           CTNAME=$DTORESP(5:I);   /* SAVE SYMBOLIC NAME            */ 01081000
         LR    @14,I                                               0342 01082000
         SL    @14,@CF00348                                        0342 01083000
         MVC   @TS00001(8),$DTORESP+4(WAPTR)                       0342 01084000
         MVI   CTNAME+1(WAPTR),C' '                                0342 01085000
         MVC   CTNAME+2(6,WAPTR),CTNAME+1(WAPTR)                   0342 01086000
         EX    @14,@SM01140                                        0342 01087000
*         END;                                                     0343 01088000
*       $CTMSGNM=$DTORESP(5:I);     /* SAVE CT NAME FOR MESSAGES     */ 01089000
@RC00325 LR    @14,I                                               0344 01090000
         SL    @14,@CF00348                                        0344 01091000
         MVC   @TS00001(8),$DTORESP+4(WAPTR)                       0344 01092000
         MVI   $CTMSGNM+1(WAPTR),C' '                              0344 01093000
         MVC   $CTMSGNM+2(6,WAPTR),$CTMSGNM+1(WAPTR)               0344 01094000
         EX    @14,@SM01142                                        0344 01095000
*       CALL I02C1000;              /* CALL VERIFY FUNCTION  @D32JPFR*/ 01096000
         BAL   @14,I02C1000                                        0345 01097000
*/****************************************************************** */ 01098000
*/* IF NEWCT = PRESENT CT, IGNORE INPUT, GO BACK TO ISSUE 105D MSG.  */ 01099000
*/****************************************************************** */ 01100000
*                                                                  0346 01101000
*       IF R15=4|                   /* BAD RC FROM VERIFY    @D32JPFR*/ 01102000
*           $CTMSGNM=$SYSMN(1) THEN                                0346 01103000
         C     R15,@CF00068                                        0346 01104000
         BE    @RT00346                                            0346 01105000
         CLC   $CTMSGNM(8,WAPTR),$SYSMN(WAPTR)                     0346 01106000
         BE    @RT00346                                            0346 01107000
*         GO TO I02C0010;           /* GO RE-ISSUE 105D MESSAGE      */ 01108000
*       IF R15=8 THEN                                              0348 01109000
         C     R15,@CF00054                                        0348 01110000
         BNE   @RF00348                                            0348 01111000
*         DO;                                                      0349 01112000
*           $INBUFR=$CTMSGNM;                                      0350 01113000
*                                                                  0350 01114000
         MVI   $INBUFR+8(WAPTR),C' '                               0350 01115000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0350 01116000
         MVC   $INBUFR(8,WAPTR),$CTMSGNM(WAPTR)                    0350 01117000
*           /*********************************************************/ 01118000
*           /*                                                       */ 01119000
*           /* TCEC MSGN(460)SUB(YES)MSGMSK('20000000'X) INVOKED     */ 01120000
*           /*                                                       */ 01121000
*           /*********************************************************/ 01122000
*                                                                  0351 01123000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 01124000
         OI    $TCECM(WAPTR),B'00000001'                           0351 01125000
*           R1=ADDR($TCA33);        /* SET UP PARM LIST $TR          */ 01126000
         LA    R1,$TCA33                                           0352 01127000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 01128000
         L     @15,@CV00842                                        0353 01129000
         BALR  @14,@15                                             0353 01130000
*           DCL                                                    0354 01131000
*             1 $TCA33,             /* TCEC PARM LIST                */ 01132000
*              2 $TCB33 FIXED(32) INIT(460),/* MSG NUMBER            */ 01133000
*              2 $TCC33 FIXED(32) INIT(0),/* INCT LEN                */ 01134000
*              2 $TCD33 BIT(8) INIT('10000000'B),/* FLAG             */ 01135000
*              2 $TCE33 CHAR(4) INIT('20000000'X);/* MSSAGE MASK     */ 01136000
*           GO TO I02C0010;         /* GO RE-ISSUE 105D MESSAGE      */ 01137000
         B     I02C0010                                            0355 01138000
*         END;                                                     0356 01139000
*                                                                  0356 01140000
*/****************************************************************** */ 01141000
*/* REQUEST NETWORK CONTROLLERS PERMISSION TO USE NEW CT             */ 01142000
*/****************************************************************** */ 01143000
*                                                                  0357 01144000
*       IF $OPCOM=ON THEN           /* IF NETWORK CONTROLLER IS SAME */ 01145000
@RF00348 TM    $OPCOM(WAPTR),B'10000000'                           0357 01146000
         BO    @RT00357                                            0357 01147000
*         GO TO I02C0140;           /* AS SYSTEM CONSOLE, DO NOT ASK    01148000
*                                      PERMISSION FOR DEVICES        */ 01149000
*       $INBUFR=$SYSMN(1);                                         0359 01150000
         MVI   $INBUFR+8(WAPTR),C' '                               0359 01151000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0359 01152000
         MVC   $INBUFR(8,WAPTR),$SYSMN(WAPTR)                      0359 01153000
*       $INBUFR(9:16)=$CTMSGNM;                                    0360 01154000
*                                                                  0360 01155000
         MVC   $INBUFR+8(8,WAPTR),$CTMSGNM(WAPTR)                  0360 01156000
*       /*************************************************************/ 01157000
*       /*                                                           */ 01158000
*       /* TCEC MSGN(462)DIR(NET)INCT(61)SUB(YES) INVOKED            */ 01159000
*       /*                                                           */ 01160000
*       /*************************************************************/ 01161000
*                                                                  0361 01162000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01163000
         OI    $TCECM(WAPTR),B'00000001'                           0361 01164000
*       R1=ADDR($TCA34);            /* SET UP PARM LIST $TR          */ 01165000
         LA    R1,$TCA34                                           0362 01166000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01167000
         L     @15,#EXITA(,WAPTR)                                  0363 01168000
         BALR  @14,@15                                             0363 01169000
*       DCL                                                        0364 01170000
*         1 $TCA34,                 /* TCEC PARM LIST                */ 01171000
*          2 $TCB34 FIXED(32) INIT(462),/* MSG NUMBER                */ 01172000
*          2 $TCC34 FIXED(32) INIT(61),/* INCT LEN                   */ 01173000
*          2 $TCD34 BIT(8) INIT('11001000'B),/* FLAG                 */ 01174000
*          2 $TCE34 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01175000
*       CALL I02C2000;              /* PROCESS RESPONSE      @D32JPFR*/ 01176000
         BAL   @14,I02C2000                                        0365 01177000
*       IF R15=4 THEN               /* RESPONSE = NO         @D32JPFR*/ 01178000
         C     R15,@CF00068                                        0366 01179000
         BE    @RT00366                                            0366 01180000
*         GOTO I02C0010;            /* REISSUE 105D MSG      @D32JPFR*/ 01181000
*I02C0130:                                                         0368 01182000
*I02C0140:                                                         0368 01183000
*                                                                  0368 01184000
*/****************************************************************** */ 01185000
*/* RELEASE ALL TEST DEVICES FROM DEVICE TABLE.                      */ 01186000
*/****************************************************************** */ 01187000
*                                                                  0368 01188000
*       CALL ISTTC035;                                             0368 01189000
*                                                                  0368 01190000
I02C0130 DS    0H                                                  0368 01191000
I02C0140 L     @15,@CV00883                                        0368 01192000
         BALR  @14,@15                                             0368 01193000
*/********************************************************************/ 01194000
*/*                        ACQUIRE NEW CT FROM VTAM.                 */ 01195000
*/********************************************************************/ 01196000
*                                                                  0369 01197000
*       $DEVTBLE(3)=($DEVTBLE(3)&&$DEVTBLE(3));/* ZERO TAB ENTRY     */ 01198000
         XC    $DEVTBLE+136(68,WAPTR),$DEVTBLE+136(WAPTR)          0369 01199000
*       $SYSMN(3)=$CTMSGNM;         /* NEW CT SYMBOLIC NAME TO 1ST TT*/ 01200000
         MVC   $SYSMN+136(8,WAPTR),$CTMSGNM(WAPTR)                 0370 01201000
*       $CTNAME=$CTMSGNM;           /* SAVE NEW CTNAME IN RCA        */ 01202000
         MVC   $CTNAME(8,RCAPTR),$CTMSGNM(WAPTR)                   0371 01203000
*       $RNINFO(3)=CTPTRS;          /* RDT POINTERS TO DEVICE ENTRY  */ 01204000
         MVC   $RNINFO+136(9,WAPTR),CTPTRS(WAPTR)                  0372 01205000
*       $DEVFEAT(3)=SVEIC00A(1);    /* SAVE DEV CHARS        @D32JPFR*/ 01206000
         MVC   $DEVFEAT+136(4,WAPTR),SVEIC00A(WAPTR)               0373 01207000
*       $DEVCNTS=3;                 /* ADJUST DEV COUNT TO ALLOW ACQ    01208000
*                                      TO                            */ 01209000
*                                                                  0374 01210000
         MVC   $DEVCNTS(2,WAPTR),@CH00081                          0374 01211000
*       /*************************************************************/ 01212000
*       /*                                                           */ 01213000
*       /* ACQUIRE THE NEW CT.                                       */ 01214000
*       /*                                                           */ 01215000
*       /*************************************************************/ 01216000
*                                                                  0375 01217000
*       $DEVCHNG=ON;                                               0375 01218000
         OI    $DEVCHNG(WAPTR),B'00010000'                         0375 01219000
*       R1=ADDR(ACQCTPRM);          /* POINTER TO ACQCT PARM LIST    */ 01220000
         LA    R1,ACQCTPRM                                         0376 01221000
*       CALL #EXIT;                 /* CALL ACQUISITION FUNCTION.    */ 01222000
         L     @15,#EXITA(,WAPTR)                                  0377 01223000
         BALR  @14,@15                                             0377 01224000
*       $DEVCHNG=OFF;                                              0378 01225000
         NI    $DEVCHNG(WAPTR),B'11101111'                         0378 01226000
*       IF R15^=0 THEN              /* IF RETURN CODE NOT ZERO       */ 01227000
         LTR   R15,R15                                             0379 01228000
         BNZ   @RT00379                                            0379 01229000
*         GO TO I02C0010;           /* RE-ISSUE 105D MESSAGE         */ 01230000
*/****************************************************************** */ 01231000
*/*    OUTPUT MESSAGE 461I CTRL SHIFTED BY XXXXXXXX TO YYYYYYYY.     */ 01232000
*/****************************************************************** */ 01233000
*                                                                  0381 01234000
*       $INBUFR=$SYSMN(1);                                         0381 01235000
         MVI   $INBUFR+8(WAPTR),C' '                               0381 01236000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0381 01237000
         MVC   $INBUFR(8,WAPTR),$SYSMN(WAPTR)                      0381 01238000
*       $INBUFR(9:16)=$CTMSGNM;                                    0382 01239000
*                                                                  0382 01240000
         MVC   $INBUFR+8(8,WAPTR),$CTMSGNM(WAPTR)                  0382 01241000
*       /*************************************************************/ 01242000
*       /*                                                           */ 01243000
*       /* TCEC MSGN(461)SUB(YES) INVOKED                            */ 01244000
*       /*                                                           */ 01245000
*       /*************************************************************/ 01246000
*                                                                  0383 01247000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01248000
         OI    $TCECM(WAPTR),B'00000001'                           0383 01249000
*       R1=ADDR($TCA35);            /* SET UP PARM LIST $TR          */ 01250000
         LA    R1,$TCA35                                           0384 01251000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01252000
         L     @15,#EXITA(,WAPTR)                                  0385 01253000
         BALR  @14,@15                                             0385 01254000
*       DCL                                                        0386 01255000
*         1 $TCA35,                 /* TCEC PARM LIST                */ 01256000
*          2 $TCB35 FIXED(32) INIT(461),/* MSG NUMBER                */ 01257000
*          2 $TCC35 FIXED(32) INIT(0),/* INCT LEN                    */ 01258000
*          2 $TCD35 BIT(8) INIT('10000000'B),/* FLAG                 */ 01259000
*          2 $TCE35 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01260000
*/********************************************************************/ 01261000
*/* RELEASE THE OLD CT AND AP (IF ANY EXISTED)                       */ 01262000
*/********************************************************************/ 01263000
*                                                                  0387 01264000
*       $CTMSGNM=$SYSMN(1);         /* SAVE OLD CT NAME FOR MSG      */ 01265000
         MVC   $CTMSGNM(8,WAPTR),$SYSMN(WAPTR)                     0387 01266000
*       R1=ADDR(RELPARM);           /* SET UP PARAMETER POINTER      */ 01267000
         LA    R1,RELPARM                                          0388 01268000
*       RELDEV=ADDR($SYSMN(1));                                    0389 01269000
         LA    @14,$SYSMN(,WAPTR)                                  0389 01270000
         ST    @14,RELDEV                                          0389 01271000
*       RELFLG='80'X;               /* RELEASE CT AND AP FUNCTION    */ 01272000
         MVI   RELFLG,X'80'                                        0390 01273000
*       CALL #EXIT;                 /* CALL RELEASE FUNCTION         */ 01274000
         L     @15,#EXITA(,WAPTR)                                  0391 01275000
         BALR  @14,@15                                             0391 01276000
*       RELDEV=ADDR($SYSMN(2));                                    0392 01277000
         LA    @14,$SYSMN+68(,WAPTR)                               0392 01278000
         ST    @14,RELDEV                                          0392 01279000
*       CALL #EXIT;                                                0393 01280000
         L     @15,#EXITA(,WAPTR)                                  0393 01281000
         BALR  @14,@15                                             0393 01282000
*       $DEVTBLE(1)=$DEVTBLE(3);    /* MAKE DEVICE THE CT ENTRY    0394 01283000
*                                                            @D32JPPW*/ 01284000
         MVC   $DEVTBLE(68,WAPTR),$DEVTBLE+136(WAPTR)              0394 01285000
*       $DEVCNTS=2;                 /* REDUCE COUNT SO IT IS NOT A 0395 01286000
*                                      TEST DEVICE           @D32JPPW*/ 01287000
         MVC   $DEVCNTS(2,WAPTR),@CH00137                          0395 01288000
*       $OPCOM=OFF;                 /* IF HE WAS THE OPERATOR, HE IS    01289000
*                                      NO MORE               @D32JPPW*/ 01290000
         NI    $OPCOM(WAPTR),B'01111111'                           0396 01291000
*/****************************************************************** */ 01292000
*/*   OUTPUT  MESSAGE 461I CTRL SHIFTED BY XXXXXXXX TO YYYYYYYY      */ 01293000
*/****************************************************************** */ 01294000
*                                                                  0397 01295000
*       $INBUFR=$CTMSGNM;           /* NAME OF OLD CT                */ 01296000
         MVI   $INBUFR+8(WAPTR),C' '                               0397 01297000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0397 01298000
         MVC   $INBUFR(8,WAPTR),$CTMSGNM(WAPTR)                    0397 01299000
*       $INBUFR(9:16)=$SYSMN(1);    /* NEW CT NAME                   */ 01300000
*                                                                  0398 01301000
         MVC   $INBUFR+8(8,WAPTR),$SYSMN(WAPTR)                    0398 01302000
*       /*************************************************************/ 01303000
*       /*                                                           */ 01304000
*       /* TCEC MSGN(461)SUB(YES) INVOKED                            */ 01305000
*       /*                                                           */ 01306000
*       /*************************************************************/ 01307000
*                                                                  0399 01308000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01309000
         OI    $TCECM(WAPTR),B'00000001'                           0399 01310000
*       R1=ADDR($TCA36);            /* SET UP PARM LIST $TR          */ 01311000
         LA    R1,$TCA36                                           0400 01312000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01313000
         L     @15,#EXITA(,WAPTR)                                  0401 01314000
         BALR  @14,@15                                             0401 01315000
*       DCL                                                        0402 01316000
*         1 $TCA36,                 /* TCEC PARM LIST                */ 01317000
*          2 $TCB36 FIXED(32) INIT(461),/* MSG NUMBER                */ 01318000
*          2 $TCC36 FIXED(32) INIT(0),/* INCT LEN                    */ 01319000
*          2 $TCD36 BIT(8) INIT('10000000'B),/* FLAG                 */ 01320000
*          2 $TCE36 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01321000
*       GO TO I02C0005;             /* GO RE-ISSUE OPTIONS ARE MSG.  */ 01322000
         B     I02C0005                                            0403 01323000
*/****************************************************************** */ 01324000
*/*      OUTPUT MESSAGE 299D INCORRECT REPLY, (TWO WAY MESSAGE)      */ 01325000
*/****************************************************************** */ 01326000
*                                                                  0404 01327000
*I02C0150:                                                         0404 01328000
*                                                                  0404 01329000
*       /*************************************************************/ 01330000
*       /*                                                           */ 01331000
*       /* TCEC MSGN(299)INCT(61) INVOKED                            */ 01332000
*       /*                                                           */ 01333000
*       /*************************************************************/ 01334000
*                                                                  0404 01335000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01336000
I02C0150 OI    $TCECM(WAPTR),B'00000001'                           0404 01337000
*       R1=ADDR($TCA37);            /* SET UP PARM LIST $TR          */ 01338000
         LA    R1,$TCA37                                           0405 01339000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01340000
         L     @15,#EXITA(,WAPTR)                                  0406 01341000
         BALR  @14,@15                                             0406 01342000
*       DCL                                                        0407 01343000
*         1 $TCA37,                 /* TCEC PARM LIST                */ 01344000
*          2 $TCB37 FIXED(32) INIT(299),/* MSG NUMBER                */ 01345000
*          2 $TCC37 FIXED(32) INIT(61),/* INCT LEN                   */ 01346000
*          2 $TCD37 BIT(8) INIT('01000000'B),/* FLAG                 */ 01347000
*          2 $TCE37 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01348000
*       GO TO I02C0020;             /* GO CHECK RESPONSE             */ 01349000
         B     I02C0020                                            0408 01350000
*     END;                          /* END OF ALL VERB TESTS         */ 01351000
*/********************************************************************/ 01352000
*/* TEST FOR A REQUEST ENTERED IN DEV, TST AND OPTIONS FIELDS.       */ 01353000
*/********************************************************************/ 01354000
*                                                                  0410 01355000
*   IF ADDR($DTORESP)+1^=$SLASHAD(1) THEN/* IF NOT EQUAL THEN        */ 01356000
@RC00131 LA    @14,$DTORESP(,WAPTR)                                0410 01357000
         AL    @14,@CF00072                                        0410 01358000
         C     @14,$SLASHAD(,WAPTR)                                0410 01359000
         BE    @RF00410                                            0410 01360000
*     $DEVCHNG=ON;                  /* INDICATE DEV CHANGE ENTERED   */ 01361000
         OI    $DEVCHNG(WAPTR),B'00010000'                         0411 01362000
*   ELSE                                                           0412 01363000
*     $DEVCHNG=OFF;                                                0412 01364000
         B     @RC00410                                            0412 01365000
@RF00410 NI    $DEVCHNG(WAPTR),B'11101111'                         0412 01366000
*   IF $SLASHAD(1)+1^=$SLASHAD(2) THEN/* IF TEST FLD SLASH           */ 01367000
@RC00410 LA    @14,1                                               0413 01368000
         AL    @14,$SLASHAD(,WAPTR)                                0413 01369000
         C     @14,$SLASHAD+4(,WAPTR)                              0413 01370000
         BE    @RF00413                                            0413 01371000
*     $TESTCNG=ON;                  /* IS NOT ADJACENT TO OPT FLD    */ 01372000
         OI    $TESTCNG(WAPTR),B'00100000'                         0414 01373000
*   ELSE                                                           0415 01374000
*     $TESTCNG=OFF;                 /* INDICATE TST CHANGE ENTERED   */ 01375000
         B     @RC00413                                            0415 01376000
@RF00413 NI    $TESTCNG(WAPTR),B'11011111'                         0415 01377000
*   IF $SLASHAD(2)+1^=$SLASHAD(3) THEN                             0416 01378000
@RC00413 LA    @14,1                                               0416 01379000
         AL    @14,$SLASHAD+4(,WAPTR)                              0416 01380000
         C     @14,$SLASHAD+8(,WAPTR)                              0416 01381000
         BE    @RF00416                                            0416 01382000
*     $OPTCHNG=ON;                                                 0417 01383000
         OI    $OPTCHNG(WAPTR),B'00001000'                         0417 01384000
*   ELSE                                                           0418 01385000
*     $OPTCHNG=OFF;                                                0418 01386000
*                                                                  0418 01387000
         B     @RC00416                                            0418 01388000
@RF00416 NI    $OPTCHNG(WAPTR),B'11110111'                         0418 01389000
*/****************************************************************** */ 01390000
*/*HANDLE THE SPECIAL CASE WHERE CI WAS CALLED BY DPRINT AS A RESULT */ 01391000
*/* OF DPRINT MESSAGE OUTPUT WITH THE $CATERR FLAG ON. IF $CATERR    */ 01392000
*/* AND $CATMSG FLAGS ARE BOTH ON THEN RESET THE $CATMSG FLAG AND    */ 01393000
*/* RETURN TO THE OLT.                                               */ 01394000
*/********************************************************************  01395000
*                                                                    */ 01396000
*                                                                  0419 01397000
*   IF $CATERR=ON&$CATMSG=ON&($DEVCHNG=ON|$TESTCNG=ON) THEN        0419 01398000
@RC00416 TM    $CATERR(WAPTR),B'00100000'                          0419 01399000
         BNO   @RF00419                                            0419 01400000
         TM    $CATMSG(WAPTR),B'00000100'                          0419 01401000
         BNO   @RF00419                                            0419 01402000
         TM    $DEVCHNG(WAPTR),B'00110000'                         0419 01403000
         BNZ   @RT00419                                            0419 01404000
*     GO TO I02C0230;                                              0420 01405000
*   ELSE                                                           0421 01406000
*     ;                                                            0421 01407000
*                                                                  0421 01408000
@RF00419 DS    0H                                                  0422 01409000
*/********************************************************************/ 01410000
*/* IF A DEVICE OR TEST CHANGE HAS BEEN MADE, DTERM IS CALLED TO     */ 01411000
*/* RELEASE ANY ACTIVE DEVICES AND TERMINATE THE CURRENT TEST.       */ 01412000
*/********************************************************************/ 01413000
*                                                                  0422 01414000
*I02C0160:                                                         0422 01415000
*   IF $DEVCHNG=OFF&$TESTCNG=ON THEN                               0422 01416000
I02C0160 TM    $TESTCNG(WAPTR),B'00100000'                         0422 01417000
         BNO   @RF00422                                            0422 01418000
         TM    $DEVCHNG(WAPTR),B'00010000'                         0422 01419000
         BNZ   @RF00422                                            0422 01420000
*     $NORELDV=ON;                                                 0423 01421000
         OI    $NORELDV(WAPTR),B'00000010'                         0423 01422000
*   ELSE                                                           0424 01423000
*     ;                                                            0424 01424000
@RF00422 DS    0H                                                  0425 01425000
*   IF($DEVCHNG=ON|$TESTCNG=ON) THEN                               0425 01426000
*                                                                  0425 01427000
         TM    $DEVCHNG(WAPTR),B'00110000'                         0425 01428000
         BZ    @RF00425                                            0425 01429000
*/********************************************************************/ 01430000
*/* IF THIS IS NOT THE FIRST D/T/O/ ENTRY THEN DTERM IS CALLED TO    */ 01431000
*/* CLEAN UP ANY ACTIVE TEST OR DEVICES (ALL TEST DEVICES ARE        */ 01432000
*/* RELEASED.)                                                       */ 01433000
*/********************************************************************/ 01434000
*                                                                  0426 01435000
*     CALL ISTTC035;                                               0426 01436000
*                                                                  0426 01437000
         L     @15,@CV00883                                        0426 01438000
         BALR  @14,@15                                             0426 01439000
*/********************************************************************/ 01440000
*/*SAVE DEV FIELD FOR USE IN PERMISSION REQUIRED MSG TO NETWORK OP.  */ 01441000
*/********************************************************************/ 01442000
*                                                                  0427 01443000
*   IF $DEVCHNG=ON THEN             /* CK FOR GHNG IN DEVICE FLD     */ 01444000
@RF00425 TM    $DEVCHNG(WAPTR),B'00010000'                         0427 01445000
         BNO   @RF00427                                            0427 01446000
*     DO;                                                          0428 01447000
*       IF $DTORESP(2:6)^='.NDR/'   /* DONT SAVE .NDR INPUT          */ 01448000
*           &$DTORESP(2:3)^='*/' THEN/* DONT SAVE * INPUT            */ 01449000
         CLC   $DTORESP+1(5,WAPTR),@CC00994                        0429 01450000
         BE    @RF00429                                            0429 01451000
         CLC   $DTORESP+1(2,WAPTR),@CC00995                        0429 01452000
         BE    @RF00429                                            0429 01453000
*         DO;                                                      0430 01454000
*           I=$SLASHAD(1)-ADDR($DTORESP);/* LENGTH OF DEV FIELD      */ 01455000
         LA    I,$DTORESP(,WAPTR)                                  0431 01456000
         LCR   I,I                                                 0431 01457000
         AL    I,$SLASHAD(,WAPTR)                                  0431 01458000
*           $TSTDEVP=ON;            /* INDICATE MESSAGE REQUESTING 0432 01459000
*                                      NETWORK CONTROLLER PERMISSION    01460000
*                                      REQUIRED.                     */ 01461000
         OI    $TSTDEVP(WAPTR),B'00100000'                         0432 01462000
*         END;                                                     0433 01463000
*       ELSE                                                       0434 01464000
*         $TSTDEVP=OFF;             /* RESET DEVICE ENTRY REQUIRES 0434 01465000
*                                      PERMISSION FLAG.              */ 01466000
         B     @RC00429                                            0434 01467000
@RF00429 NI    $TSTDEVP(WAPTR),B'11011111'                         0434 01468000
*       $DEVERR=OFF;                /* RESET DEVICE ERROR FLAG.      */ 01469000
@RC00429 NI    $DEVERR(WAPTR),B'01111111'                          0435 01470000
*       CALL ISTIC003;              /* CALL DEVICE DECODE FUNCTION   */ 01471000
         L     @15,@CV00996                                        0436 01472000
         BALR  @14,@15                                             0436 01473000
*     END;                                                         0437 01474000
*   IF $TESTCNG=ON THEN             /* IF TEST FIELD ENTERED,        */ 01475000
@RF00427 TM    $TESTCNG(WAPTR),B'00100000'                         0438 01476000
         BNO   @RF00438                                            0438 01477000
*     DO;                                                          0439 01478000
*       $TSTERR=OFF;                /* RESET TEST ERROR FLAG         */ 01479000
         NI    $TSTERR(WAPTR),B'10111111'                          0440 01480000
*       CALL ISTIC004;              /* CALL TEST DECODE.             */ 01481000
         L     @15,@CV00997                                        0441 01482000
         BALR  @14,@15                                             0441 01483000
*     END;                                                         0442 01484000
*   ELSE                                                           0443 01485000
*     ;                                                            0443 01486000
@RF00438 DS    0H                                                  0444 01487000
*   IF $OPTCHNG=ON THEN             /* IF OPTIONS FIELD ENTERED,     */ 01488000
         TM    $OPTCHNG(WAPTR),B'00001000'                         0444 01489000
         BNO   @RF00444                                            0444 01490000
*     DO;                                                          0445 01491000
*       $OPTERR=OFF;                /* RESET OPTIONS ERROR FLAG.     */ 01492000
         NI    $OPTERR(WAPTR),B'11111011'                          0446 01493000
*       CALL ISTIC005;              /* CALL OPTIONS DECODE           */ 01494000
         L     @15,@CV00795                                        0447 01495000
         BALR  @14,@15                                             0447 01496000
*     END;                                                         0448 01497000
*                                                                  0448 01498000
*/********************************************************************/ 01499000
*/* CHECK FOR INVALID SLASH RESPONSE (RESULTS IF SLASH ENTERED FOR A */ 01500000
*/* FIELD WHICH HAS NOT HAD A PRIOR VALID ENTRY).                    */ 01501000
*/********************************************************************/ 01502000
*                                                                  0449 01503000
*I02C0170:                                                         0449 01504000
*   IF $DEVCHNG=OFF&$VALDDEV=OFF THEN/* IF NO DEV ENTERED            */ 01505000
@RF00444 DS    0H                                                  0449 01506000
I02C0170 TM    $DEVCHNG(WAPTR),B'00010000'                         0449 01507000
         BNZ   @RF00449                                            0449 01508000
         TM    $VALDDEV(WAPTR),B'00001000'                         0449 01509000
         BNZ   @RF00449                                            0449 01510000
*/********************************************************************/ 01511000
*/* IF THERE IS NO DEVICE CHANGE AND NO PRIOR VALID DEVICE THEN      */ 01512000
*/* INDICATE DEVICE FIELD ERROR.                                     */ 01513000
*/********************************************************************/ 01514000
*                                                                  0450 01515000
*     DO;                                                          0450 01516000
*       $DEVERR=ON;                 /* INDICATE DEV FIELD ERROR.     */ 01517000
*                                                                  0451 01518000
         OI    $DEVERR(WAPTR),B'10000000'                          0451 01519000
*       /*************************************************************/ 01520000
*       /*                                                           */ 01521000
*       /* TCEC MSGN(170)MSGMSK('80000000'X) INVOKED                 */ 01522000
*       /*                                                           */ 01523000
*       /*************************************************************/ 01524000
*                                                                  0452 01525000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01526000
         OI    $TCECM(WAPTR),B'00000001'                           0452 01527000
*       R1=ADDR($TCA38);            /* SET UP PARM LIST $TR          */ 01528000
         LA    R1,$TCA38                                           0453 01529000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 01530000
         L     @15,@CV00842                                        0454 01531000
         BALR  @14,@15                                             0454 01532000
*       DCL                                                        0455 01533000
*         1 $TCA38,                 /* TCEC PARM LIST                */ 01534000
*          2 $TCB38 FIXED(32) INIT(170),/* MSG NUMBER                */ 01535000
*          2 $TCC38 FIXED(32) INIT(0),/* INCT LEN                    */ 01536000
*          2 $TCD38 BIT(8) INIT('00000000'B),/* FLAG                 */ 01537000
*          2 $TCE38 CHAR(4) INIT('80000000'X);/* MSSAGE MASK         */ 01538000
*     END;                                                         0456 01539000
*   IF $TESTCNG=OFF&$VALDTST=OFF THEN                              0457 01540000
@RF00449 TM    $TESTCNG(WAPTR),B'00100000'                         0457 01541000
         BNZ   @RF00457                                            0457 01542000
         TM    $VALDTST(WAPTR),B'00000100'                         0457 01543000
         BNZ   @RF00457                                            0457 01544000
*     DO;                                                          0458 01545000
*       $TSTERR=ON;                 /* SET TEST FIELD ERROR FLAG.    */ 01546000
*                                                                  0459 01547000
         OI    $TSTERR(WAPTR),B'01000000'                          0459 01548000
*       /*************************************************************/ 01549000
*       /*                                                           */ 01550000
*       /* TCEC MSGN(170)MSGMSK('40000000'X) INVOKED                 */ 01551000
*       /*                                                           */ 01552000
*       /*************************************************************/ 01553000
*                                                                  0460 01554000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01555000
         OI    $TCECM(WAPTR),B'00000001'                           0460 01556000
*       R1=ADDR($TCA39);            /* SET UP PARM LIST $TR          */ 01557000
         LA    R1,$TCA39                                           0461 01558000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 01559000
         L     @15,@CV00842                                        0462 01560000
         BALR  @14,@15                                             0462 01561000
*       DCL                                                        0463 01562000
*         1 $TCA39,                 /* TCEC PARM LIST                */ 01563000
*          2 $TCB39 FIXED(32) INIT(170),/* MSG NUMBER                */ 01564000
*          2 $TCC39 FIXED(32) INIT(0),/* INCT LEN                    */ 01565000
*          2 $TCD39 BIT(8) INIT('00000000'B),/* FLAG                 */ 01566000
*          2 $TCE39 CHAR(4) INIT('40000000'X);/* MSSAGE MASK         */ 01567000
*     END;                                                         0464 01568000
*   IF $DEVERR=OFF&$TSTERR=OFF&$OPTERR=OFF THEN                    0465 01569000
@RF00457 TM    $DEVERR(WAPTR),B'11000100'                          0465 01570000
         BZ    @RT00465                                            0465 01571000
*     GO TO I02C0180;                                              0466 01572000
*   ELSE                                                           0467 01573000
*     ;                                                            0467 01574000
*                                                                  0467 01575000
@RF00465 DS    0H                                                  0468 01576000
*   /*****************************************************************/ 01577000
*   /*                                                               */ 01578000
*   /* TCEC MSGN(161) INVOKED                                        */ 01579000
*   /*                                                               */ 01580000
*   /*****************************************************************/ 01581000
*                                                                  0468 01582000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 01583000
         OI    $TCECM(WAPTR),B'00000001'                           0468 01584000
*   R1=ADDR($TCA40);                /* SET UP PARM LIST $TR          */ 01585000
         LA    R1,$TCA40                                           0469 01586000
*   CALL #EXIT;                     /* CALL CECOM                    */ 01587000
         L     @15,#EXITA(,WAPTR)                                  0470 01588000
         BALR  @14,@15                                             0470 01589000
*   DCL                                                            0471 01590000
*     1 $TCA40,                     /* TCEC PARM LIST                */ 01591000
*      2 $TCB40 FIXED(32) INIT(161),/* MSG NUMBER                    */ 01592000
*      2 $TCC40 FIXED(32) INIT(0),  /* INCT LEN                      */ 01593000
*      2 $TCD40 BIT(8) INIT('00000000'B),/* FLAG                     */ 01594000
*      2 $TCE40 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK MSG IS FOR     01595000
*                                      HELP ENTER PROMT              */ 01596000
*/********************************************************************/ 01597000
*/* ASSEMBLE D/T/O/ PORTION OF MSG TO INDICATE WHICH FIELDS ARE TO BE*/ 01598000
*/* INCLUDED IN RESPONSE.                                            */ 01599000
*/********************************************************************/ 01600000
*                                                                  0472 01601000
*   $INBUFR(1:6)='////  ';          /* INITIALIZE $INBUFR.           */ 01602000
         MVC   $INBUFR(6,WAPTR),@CC01019                           0472 01603000
*   I=1;                                                           0473 01604000
         LA    I,1                                                 0473 01605000
*   IF $DEVERR=ON THEN              /* CHECK FOR 'D' REQUIRED.       */ 01606000
         TM    $DEVERR(WAPTR),B'10000000'                          0474 01607000
         BNO   @RF00474                                            0474 01608000
*     DO;                                                          0475 01609000
*       $INBUFR(I:I)='D';                                          0476 01610000
         LR    @14,WAPTR                                           0476 01611000
         ALR   @14,I                                               0476 01612000
         MVI   $INBUFR-1(@14),C'D'                                 0476 01613000
*       I=I+2;                                                     0477 01614000
         AL    I,@CF00137                                          0477 01615000
*     END;                                                         0478 01616000
*   ELSE                                                           0479 01617000
*     I=I+1;                                                       0479 01618000
         B     @RC00474                                            0479 01619000
@RF00474 AL    I,@CF00072                                          0479 01620000
*   IF $TSTERR=ON THEN              /* CHECK FOR 'T' REQUIRED.       */ 01621000
@RC00474 TM    $TSTERR(WAPTR),B'01000000'                          0480 01622000
         BNO   @RF00480                                            0480 01623000
*     DO;                                                          0481 01624000
*       $INBUFR(I:I+3)='T//';                                      0482 01625000
         LR    @14,WAPTR                                           0482 01626000
         ALR   @14,I                                               0482 01627000
         MVI   $INBUFR+2(@14),C' '                                 0482 01628000
         MVC   $INBUFR-1(3,@14),@CC01021                           0482 01629000
*       I=I+2;                                                     0483 01630000
         AL    I,@CF00137                                          0483 01631000
*     END;                                                         0484 01632000
*   ELSE                                                           0485 01633000
*     I=I+1;                                                       0485 01634000
         B     @RC00480                                            0485 01635000
@RF00480 AL    I,@CF00072                                          0485 01636000
*   IF $OPTERR=ON THEN              /* CHECK FOR 'O' REQUIRED.       */ 01637000
@RC00480 TM    $OPTERR(WAPTR),B'00000100'                          0486 01638000
         BNO   @RF00486                                            0486 01639000
*     $INBUFR(I:I)='O/';                                           0487 01640000
         LR    @14,WAPTR                                           0487 01641000
         ALR   @14,I                                               0487 01642000
         MVI   $INBUFR-1(@14),C'O'                                 0487 01643000
*   ELSE                                                           0488 01644000
*     ;                                                            0488 01645000
*                                                                  0488 01646000
@RF00486 DS    0H                                                  0489 01647000
*/********************************************************************/ 01648000
*/* IF THERE IS AT LEAST ONE VALID DEVICE AND ONE VALID TEST, THEN   */ 01649000
*/* THE 464I MESSAGE IS ISSUED TO ALLOW THE OPERATOR THE OPTION OF   */ 01650000
*/* TESTING WITH THE SUBSET OF DEVICES OR TEST WHICH WERE DECODED    */ 01651000
*/* AND ACCEPTED, OR CORRECTING HIS ENTRY.                           */ 01652000
*/********************************************************************/ 01653000
*                                                                  0489 01654000
*   IF $VALDDEV=ON                  /* IF A VALID DEVICE EXISTS      */ 01655000
*       &$VALDTST=ON THEN           /* AND A VALID TEST EXISTS       */ 01656000
         TM    $VALDDEV(WAPTR),B'00001100'                         0489 01657000
         BNO   @RF00489                                            0489 01658000
*     DO;                                                          0490 01659000
*                                                                  0490 01660000
*       /*************************************************************/ 01661000
*       /*                                                           */ 01662000
*       /* TCEC MSGN(464)SUB(YES) INVOKED                            */ 01663000
*       /*                                                           */ 01664000
*       /*************************************************************/ 01665000
*                                                                  0491 01666000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01667000
         OI    $TCECM(WAPTR),B'00000001'                           0491 01668000
*       R1=ADDR($TCA41);            /* SET UP PARM LIST $TR          */ 01669000
         LA    R1,$TCA41                                           0492 01670000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01671000
         L     @15,#EXITA(,WAPTR)                                  0493 01672000
         BALR  @14,@15                                             0493 01673000
*       DCL                                                        0494 01674000
*         1 $TCA41,                 /* TCEC PARM LIST                */ 01675000
*          2 $TCB41 FIXED(32) INIT(464),/* MSG NUMBER                */ 01676000
*          2 $TCC41 FIXED(32) INIT(0),/* INCT LEN                    */ 01677000
*          2 $TCD41 BIT(8) INIT('10000000'B),/* FLAG                 */ 01678000
*          2 $TCE41 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01679000
*       GO TO I02C0010;             /* RE-ISSUE 105D MESSAGE         */ 01680000
         B     I02C0010                                            0495 01681000
*     END;                                                         0496 01682000
*                                                                  0496 01683000
*   /*****************************************************************/ 01684000
*   /*                                                               */ 01685000
*   /* TCEC MSGN(223)SUB(YES) INVOKED                                */ 01686000
*   /*                                                               */ 01687000
*   /*****************************************************************/ 01688000
*                                                                  0497 01689000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 01690000
@RF00489 OI    $TCECM(WAPTR),B'00000001'                           0497 01691000
*   R1=ADDR($TCA42);                /* SET UP PARM LIST $TR          */ 01692000
         LA    R1,$TCA42                                           0498 01693000
*   CALL #EXIT;                     /* CALL CECOM                    */ 01694000
         L     @15,#EXITA(,WAPTR)                                  0499 01695000
         BALR  @14,@15                                             0499 01696000
*   DCL                                                            0500 01697000
*     1 $TCA42,                     /* TCEC PARM LIST                */ 01698000
*      2 $TCB42 FIXED(32) INIT(223),/* MSG NUMBER                    */ 01699000
*      2 $TCC42 FIXED(32) INIT(0),  /* INCT LEN                      */ 01700000
*      2 $TCD42 BIT(8) INIT('10000000'B),/* FLAG                     */ 01701000
*      2 $TCE42 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK MSG TEXT IS    01702000
*                                      RE-ENTER FIELDS IN ERROR.   0500 01703000
*                                      FORMAT IS D/T/O/ (VARIABLE  0500 01704000
*                                      PORTION                       */ 01705000
*   GO TO I02C0010;                 /* GO RE-ISSUE 105D MESSAGE      */ 01706000
         B     I02C0010                                            0501 01707000
*/********************************************************************/ 01708000
*/* ALL DEVICES HAVE BEEN PUT INTO DEVICE TABLE, NOW CHECK FOR       */ 01709000
*/* ALTERNATE PRINTER CONFLICTS.                                     */ 01710000
*/********************************************************************/ 01711000
*                                                                  0502 01712000
*I02C0180:                                                         0502 01713000
*   DO I=3 TO $DEVCNTS;                                            0502 01714000
I02C0180 LA    I,3                                                 0502 01715000
         B     @DE00502                                            0502 01716000
@DL00502 DS    0H                                                  0503 01717000
*     IF $APRQPER=ON                /* IF A NEW AP HAS BEEN ENTERED     01718000
*                                      CK IT                         */ 01719000
*         &$SYSMN(I)=$APNAME|$ALTPRTR=ON/* CHECK OLD ALTERNATE     0503 01720000
*                                      PRINTER                       */ 01721000
*         &$SYSMN(I)=$SYSMN(2) THEN                                0503 01722000
         TM    $APRQPER(WAPTR),B'01000000'                         0503 01723000
         BNO   @GL00016                                            0503 01724000
         LR    @14,I                                               0503 01725000
         MH    @14,@CH00373                                        0503 01726000
         ALR   @14,WAPTR                                           0503 01727000
         CLC   $SYSMN-68(8,@14),$APNAME(WAPTR)                     0503 01728000
         BE    @RT00503                                            0503 01729000
@GL00016 TM    $ALTPRTR(WAPTR),B'00000010'                         0503 01730000
         BNO   @RF00503                                            0503 01731000
         LR    @14,I                                               0503 01732000
         MH    @14,@CH00373                                        0503 01733000
         ALR   @14,WAPTR                                           0503 01734000
         CLC   $SYSMN-68(8,@14),$SYSMN+68(WAPTR)                   0503 01735000
         BNE   @RF00503                                            0503 01736000
@RT00503 DS    0H                                                  0504 01737000
*       DO;                                                        0504 01738000
*                                                                  0504 01739000
*         /***********************************************************/ 01740000
*         /*                                                         */ 01741000
*         /* TCEC MSGN(465)MSGMSK('80000000'X) INVOKED               */ 01742000
*         /*                                                         */ 01743000
*         /***********************************************************/ 01744000
*                                                                  0505 01745000
*         $TCECM='1'B;              /* SET TCEC SW IN RCA            */ 01746000
         OI    $TCECM(WAPTR),B'00000001'                           0505 01747000
*         R1=ADDR($TCA43);          /* SET UP PARM LIST $TR          */ 01748000
         LA    R1,$TCA43                                           0506 01749000
*         CALL S20CEC03;            /* CALL TCEC-MULTIPLE LN         */ 01750000
         L     @15,@CV00842                                        0507 01751000
         BALR  @14,@15                                             0507 01752000
*         DCL                                                      0508 01753000
*           1 $TCA43,               /* TCEC PARM LIST                */ 01754000
*            2 $TCB43 FIXED(32) INIT(465),/* MSG NUMBER              */ 01755000
*            2 $TCC43 FIXED(32) INIT(0),/* INCT LEN                  */ 01756000
*            2 $TCD43 BIT(8) INIT('00000000'B),                    0508 01757000
*                                                                  0508 01758000
*/*  FLAG                                                            */ 01759000
*                                                                  0508 01760000
*            2 $TCE43 CHAR(4) INIT('80000000'X);/* MSSAGE MASK       */ 01761000
*         $VALDDEV=OFF;             /* RESET VALID DEVICE INDICATOR  */ 01762000
         NI    $VALDDEV(WAPTR),B'11110111'                         0509 01763000
*         GO TO I02C0010;           /* GO RE-ISSUE 105D MESSAGE      */ 01764000
         B     I02C0010                                            0510 01765000
*       END;                                                       0511 01766000
*   END;                                                           0512 01767000
*                                                                  0512 01768000
@RF00503 AL    I,@CF00072                                          0512 01769000
@DE00502 CH    I,$DEVCNTS(,WAPTR)                                  0512 01770000
         BNH   @DL00502                                            0512 01771000
*/********************************************************************/ 01772000
*                                                                  0513 01773000
*   IF $OPCOM=ON THEN               /* IF CT SAME AS SYSCON          */ 01774000
         TM    $OPCOM(WAPTR),B'10000000'                           0513 01775000
         BO    @RT00513                                            0513 01776000
*     GO TO I02C0220;               /* NO NEED TO ASK PERMISSION.    */ 01777000
*/********************************************************************/ 01778000
*/* DETERMINE IF THERE ARE ANY TEST DEVICES REQUIRING PERMISSION.    */ 01779000
*/********************************************************************/ 01780000
*                                                                  0515 01781000
*   X=0;                                                           0515 01782000
         SLR   X,X                                                 0515 01783000
*   IF $TSTDEVP=ON THEN             /* IF ANY NEW DEVS ENTERED       */ 01784000
         TM    $TSTDEVP(WAPTR),B'00100000'                         0516 01785000
         BNO   @RF00516                                            0516 01786000
*     DO I=3 TO $DEVCNTS;                                          0517 01787000
*                                                                  0517 01788000
         LA    I,3                                                 0517 01789000
         B     @DE00517                                            0517 01790000
@DL00517 DS    0H                                                  0518 01791000
*/********************************************************************/ 01792000
*/* CHECK FOR TEST TERMINAL EQUAL TO CT, IF SO, NO NEED TO ASK       */ 01793000
*/* PERMISSION UNLESS TERMINAL IS DATA PROTECTED IN CDS.             */ 01794000
*/********************************************************************/ 01795000
*                                                                  0518 01796000
*       IF^($SYSMN(I)=$SYSMN(1))|$DEVFPM(I)=ON THEN                0518 01797000
         LR    @14,I                                               0518 01798000
         MH    @14,@CH00373                                        0518 01799000
         ST    @14,@TF00001                                        0518 01800000
         ALR   @14,WAPTR                                           0518 01801000
         CLC   $SYSMN-68(8,@14),$SYSMN(WAPTR)                      0518 01802000
         BNE   @RT00518                                            0518 01803000
         LR    @14,WAPTR                                           0518 01804000
         AL    @14,@TF00001                                        0518 01805000
         TM    $DEVFPM-68(@14),B'10000000'                         0518 01806000
         BNO   @RF00518                                            0518 01807000
@RT00518 DS    0H                                                  0519 01808000
*         X=X+1;                                                   0519 01809000
         AL    X,@CF00072                                          0519 01810000
*     END;                                                         0520 01811000
@RF00518 AL    I,@CF00072                                          0520 01812000
@DE00517 CH    I,$DEVCNTS(,WAPTR)                                  0520 01813000
         BNH   @DL00517                                            0520 01814000
*   IF $DEVCNTS=3&                  /* TEST FOR CT=TT ALONE          */ 01815000
*       $APRQPER=OFF&               /* AND NO AP REQ                 */ 01816000
*       $SYSMN(3)=$SYSMN(1) THEN                                   0521 01817000
@RF00516 CLC   $DEVCNTS(2,WAPTR),@CH00081                          0521 01818000
         BNE   @RF00521                                            0521 01819000
         TM    $APRQPER(WAPTR),B'01000000'                         0521 01820000
         BNZ   @RF00521                                            0521 01821000
         CLC   $SYSMN+136(8,WAPTR),$SYSMN(WAPTR)                   0521 01822000
         BE    @RT00521                                            0521 01823000
*     GOTO I02C0220;                /* IF YES SKIP PERMISSION        */ 01824000
*/********************************************************************/ 01825000
*/*IF AP WAS ENTERED OR TEST DEVICES WERE ENTERED, CHECK WITH NETWORK*/ 01826000
*/*  OPERATOR FOR PERMISSION TO USE THESE DEVICES FOR TEST.          */ 01827000
*/********************************************************************/ 01828000
*                                                                  0523 01829000
*   IF $APRQPER=ON|(X>0             /* AP OR DEVICE CHANGE OCCURRED  */ 01830000
*       &$TSTDEVP=ON) THEN                                         0523 01831000
@RF00521 TM    $APRQPER(WAPTR),B'01000000'                         0523 01832000
         BO    @RT00523                                            0523 01833000
         LTR   X,X                                                 0523 01834000
         BNP   @RF00523                                            0523 01835000
         TM    $TSTDEVP(WAPTR),B'00100000'                         0523 01836000
         BNO   @RF00523                                            0523 01837000
@RT00523 DS    0H                                                  0524 01838000
*     DO;                                                          0524 01839000
*                                                                  0524 01840000
*/********************************************************************/ 01841000
*/*  SET UP MESSAGE WITH CT NAME FOLLOWED BY AP NAME (IF NEW AP)     */ 01842000
*/********************************************************************/ 01843000
*                                                                  0525 01844000
*       $INBUFR='';                 /* CLEAR $INBUFR TO BLANKS       */ 01845000
         MVI   $INBUFR(WAPTR),C' '                                 0525 01846000
         MVC   $INBUFR+1(79,WAPTR),$INBUFR(WAPTR)                  0525 01847000
*       $INBUFR(1:8)=$SYSMN(1);     /* MOVE CTRL TERMINAL NAME TO  0526 01848000
*                                      MESSAGE TEXT.                 */ 01849000
         MVC   $INBUFR(8,WAPTR),$SYSMN(WAPTR)                      0526 01850000
*       IF $APRQPER=ON THEN         /* IF AP HAS CHANGED, THEN       */ 01851000
         TM    $APRQPER(WAPTR),B'01000000'                         0527 01852000
         BNO   @RF00527                                            0527 01853000
*         $INBUFR(9:16)=$APNAME;    /* MOVE NEW AP NAME INTO MSG.    */ 01854000
         MVC   $INBUFR+8(8,WAPTR),$APNAME(WAPTR)                   0528 01855000
*       ELSE                                                       0529 01856000
*         $INBUFR(9:16)='        '; /* BLANK OUT AP NAME             */ 01857000
*                                                                  0529 01858000
         B     @RC00527                                            0529 01859000
@RF00527 MVC   $INBUFR+8(8,WAPTR),@CC01044                         0529 01860000
*       /*************************************************************/ 01861000
*       /*                                                           */ 01862000
*       /* TCEC MSGN(247)DIR(NET)MSGMSK('80000000'X)SUB(YES) INVOKED */ 01863000
*       /*                                                           */ 01864000
*       /*************************************************************/ 01865000
*                                                                  0530 01866000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01867000
@RC00527 OI    $TCECM(WAPTR),B'00000001'                           0530 01868000
*       R1=ADDR($TCA44);            /* SET UP PARM LIST $TR          */ 01869000
         LA    R1,$TCA44                                           0531 01870000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 01871000
         L     @15,@CV00842                                        0532 01872000
         BALR  @14,@15                                             0532 01873000
*       DCL                                                        0533 01874000
*         1 $TCA44,                 /* TCEC PARM LIST                */ 01875000
*          2 $TCB44 FIXED(32) INIT(247),/* MSG NUMBER                */ 01876000
*          2 $TCC44 FIXED(32) INIT(0),/* INCT LEN                    */ 01877000
*          2 $TCD44 BIT(8) INIT('10001000'B),/* FLAG                 */ 01878000
*          2 $TCE44 CHAR(4) INIT('80000000'X);                     0533 01879000
*                                                                  0533 01880000
*/* MSSAGE MASK                                                      */ 01881000
*                                                                  0534 01882000
*I02C0190:                                                         0534 01883000
*       DO I=3 TO $DEVCNTS;                                        0534 01884000
I02C0190 LA    I,3                                                 0534 01885000
         B     @DE00534                                            0534 01886000
@DL00534 DS    0H                                                  0535 01887000
*         IF^($SYSMN(I)=$SYSMN(1))  /* IF NOT CT=TT                  */ 01888000
*             |$DEVFPM(I)=ON THEN   /* OR ANYDEV FILE PROT           */ 01889000
         LR    @14,I                                               0535 01890000
         MH    @14,@CH00373                                        0535 01891000
         ST    @14,@TF00001                                        0535 01892000
         ALR   @14,WAPTR                                           0535 01893000
         CLC   $SYSMN-68(8,@14),$SYSMN(WAPTR)                      0535 01894000
         BNE   @RT00535                                            0535 01895000
         LR    @14,WAPTR                                           0535 01896000
         AL    @14,@TF00001                                        0535 01897000
         TM    $DEVFPM-68(@14),B'10000000'                         0535 01898000
         BNO   @RF00535                                            0535 01899000
@RT00535 DS    0H                                                  0536 01900000
*           DO;                                                    0536 01901000
*             $INBUFR='';                                          0537 01902000
         MVI   $INBUFR(WAPTR),C' '                                 0537 01903000
         MVC   $INBUFR+1(79,WAPTR),$INBUFR(WAPTR)                  0537 01904000
*             $INBUFR(1:8)=$SYSMN(I);                              0538 01905000
         LR    @14,I                                               0538 01906000
         MH    @14,@CH00373                                        0538 01907000
         ST    @14,@TF00001                                        0538 01908000
         ALR   @14,WAPTR                                           0538 01909000
         MVC   $INBUFR(8,WAPTR),$SYSMN-68(@14)                     0538 01910000
*             IF $DEVFPM(I)=ON THEN                                0539 01911000
         LR    @14,WAPTR                                           0539 01912000
         AL    @14,@TF00001                                        0539 01913000
         TM    $DEVFPM-68(@14),B'10000000'                         0539 01914000
         BNO   @RF00539                                            0539 01915000
*               $INBUFR(10:22)='**PROTECTED**';                    0540 01916000
*                                                                  0540 01917000
         MVC   $INBUFR+9(13,WAPTR),@CC01054                        0540 01918000
*             /*******************************************************/ 01919000
*             /*                                                     */ 01920000
*             /* TCEC MSGN(247)SUB(YES)MSGMSK('40000000'X)DIR(NET)   */ 01921000
*             /* INVOKED                                             */ 01922000
*             /*                                                     */ 01923000
*             /*******************************************************/ 01924000
*                                                                  0541 01925000
*             $TCECM='1'B;          /* SET TCEC SW IN RCA            */ 01926000
@RF00539 OI    $TCECM(WAPTR),B'00000001'                           0541 01927000
*             R1=ADDR($TCA45);      /* SET UP PARM LIST $TR          */ 01928000
         LA    R1,$TCA45                                           0542 01929000
*             CALL S20CEC03;        /* CALL TCEC-MULTIPLE LN         */ 01930000
         L     @15,@CV00842                                        0543 01931000
         BALR  @14,@15                                             0543 01932000
*             DCL                                                  0544 01933000
*               1 $TCA45,           /* TCEC PARM LIST                */ 01934000
*                2 $TCB45 FIXED(32) INIT(247),/* MSG NUMBER          */ 01935000
*                2 $TCC45 FIXED(32) INIT(0),/* INCT LEN              */ 01936000
*                2 $TCD45 BIT(8) INIT('10001000'B),/* FLAG           */ 01937000
*                2 $TCE45 CHAR(4) INIT('40000000'X);/* MSSAGE MASK   */ 01938000
*           END;                                                   0545 01939000
*       END;                                                       0546 01940000
*                                                                  0546 01941000
@RF00535 AL    I,@CF00072                                          0546 01942000
@DE00534 CH    I,$DEVCNTS(,WAPTR)                                  0546 01943000
         BNH   @DL00534                                            0546 01944000
*       /*************************************************************/ 01945000
*       /*                                                           */ 01946000
*       /* TCEC MSGN(247)MSGMSK('20000000'X)DIR(NET)INCT(61) INVOKED */ 01947000
*       /*                                                           */ 01948000
*       /*************************************************************/ 01949000
*                                                                  0547 01950000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01951000
         OI    $TCECM(WAPTR),B'00000001'                           0547 01952000
*       R1=ADDR($TCA46);            /* SET UP PARM LIST $TR          */ 01953000
         LA    R1,$TCA46                                           0548 01954000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 01955000
         L     @15,@CV00842                                        0549 01956000
         BALR  @14,@15                                             0549 01957000
*       DCL                                                        0550 01958000
*         1 $TCA46,                 /* TCEC PARM LIST                */ 01959000
*          2 $TCB46 FIXED(32) INIT(247),/* MSG NUMBER                */ 01960000
*          2 $TCC46 FIXED(32) INIT(61),/* INCT LEN                   */ 01961000
*          2 $TCD46 BIT(8) INIT('01001000'B),/* FLAG                 */ 01962000
*          2 $TCE46 CHAR(4) INIT('20000000'X);/* MSSAGE MASK         */ 01963000
*I02C0210:                                                         0551 01964000
*       IF^($INBUFR(2)='Y'|$INBUFR(2)='N')|($INBUFR(1)>1&$INBUFR(3)^=', 01965000
*           ) THEN                                                 0551 01966000
I02C0210 CLI   $INBUFR+1(WAPTR),C'Y'                               0551 01967000
         BE    @GL00025                                            0551 01968000
         CLI   $INBUFR+1(WAPTR),C'N'                               0551 01969000
         BNE   @RT00551                                            0551 01970000
@GL00025 CLI   $INBUFR(WAPTR),1                                    0551 01971000
         BNH   @RF00551                                            0551 01972000
         CLI   $INBUFR+2(WAPTR),C','                               0551 01973000
         BE    @RF00551                                            0551 01974000
@RT00551 DS    0H                                                  0552 01975000
*         DO;                                                      0552 01976000
*                                                                  0552 01977000
*           /*********************************************************/ 01978000
*           /*                                                       */ 01979000
*           /* TCEC MSGN(299)INCT(61)DIR(NET) INVOKED                */ 01980000
*           /*                                                       */ 01981000
*           /*********************************************************/ 01982000
*                                                                  0553 01983000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 01984000
         OI    $TCECM(WAPTR),B'00000001'                           0553 01985000
*           R1=ADDR($TCA47);        /* SET UP PARM LIST $TR          */ 01986000
         LA    R1,$TCA47                                           0554 01987000
*           CALL #EXIT;             /* CALL CECOM                    */ 01988000
         L     @15,#EXITA(,WAPTR)                                  0555 01989000
         BALR  @14,@15                                             0555 01990000
*           DCL                                                    0556 01991000
*             1 $TCA47,             /* TCEC PARM LIST                */ 01992000
*              2 $TCB47 FIXED(32) INIT(299),/* MSG NUMBER            */ 01993000
*              2 $TCC47 FIXED(32) INIT(61),/* INCT LEN               */ 01994000
*              2 $TCD47 BIT(8) INIT('01001000'B),/* FLAG             */ 01995000
*              2 $TCE47 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK     */ 01996000
*           GO TO I02C0210;                                        0557 01997000
         B     I02C0210                                            0557 01998000
*         END;                                                     0558 01999000
*       ELSE                                                       0559 02000000
*         DO;                                                      0559 02001000
@RF00551 DS    0H                                                  0560 02002000
*           T463C=T463B;                                           0560 02003000
         MVC   @TS00001(61),T463B(WAPTR)                           0560 02004000
         MVC   T463C(61,WAPTR),@TS00001                            0560 02005000
*           T463A='247';                                           0561 02006000
         MVC   T463A(3,WAPTR),@CC01073                             0561 02007000
*           IF $INBUFR(5)=',' THEN                                 0562 02008000
         CLI   $INBUFR+4(WAPTR),C','                               0562 02009000
         BNE   @RF00562                                            0562 02010000
*             DO;                                                  0563 02011000
*                                                                  0563 02012000
*               /*****************************************************/ 02013000
*               /*                                                   */ 02014000
*               /* TCEC MSGN(463)SUB(YES)MSGMSK('C0000000'X) INVOKED */ 02015000
*               /*                                                   */ 02016000
*               /*****************************************************/ 02017000
*                                                                  0564 02018000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 02019000
         OI    $TCECM(WAPTR),B'00000001'                           0564 02020000
*               R1=ADDR($TCA48);    /* SET UP PARM LIST $TR          */ 02021000
         LA    R1,$TCA48                                           0565 02022000
*               CALL S20CEC03;      /* CALL TCEC-MULTIPLE LN         */ 02023000
         L     @15,@CV00842                                        0566 02024000
         BALR  @14,@15                                             0566 02025000
*               DCL                                                0567 02026000
*                 1 $TCA48,         /* TCEC PARM LIST                */ 02027000
*                  2 $TCB48 FIXED(32) INIT(463),/* MSG NUMBER        */ 02028000
*                  2 $TCC48 FIXED(32) INIT(0),/* INCT LEN            */ 02029000
*                  2 $TCD48 BIT(8) INIT('10000000'B),/* FLAG         */ 02030000
*                  2 $TCE48 CHAR(4) INIT('C0000000'X);/* MSSAGE MASK */ 02031000
*             END;                                                 0568 02032000
*           IF $INBUFR(4)='N' THEN                                 0569 02033000
@RF00562 CLI   $INBUFR+3(WAPTR),C'N'                               0569 02034000
         BNE   @RF00569                                            0569 02035000
*             DO;                                                  0570 02036000
*                                                                  0570 02037000
*               /*****************************************************/ 02038000
*               /*                                                   */ 02039000
*               /* TCEC MSGN(254) INVOKED                            */ 02040000
*               /*                                                   */ 02041000
*               /*****************************************************/ 02042000
*                                                                  0571 02043000
*               $TCECM='1'B;        /* SET TCEC SW IN RCA            */ 02044000
         OI    $TCECM(WAPTR),B'00000001'                           0571 02045000
*               R1=ADDR($TCA49);    /* SET UP PARM LIST $TR          */ 02046000
         LA    R1,$TCA49                                           0572 02047000
*               CALL #EXIT;         /* CALL CECOM                    */ 02048000
         L     @15,#EXITA(,WAPTR)                                  0573 02049000
         BALR  @14,@15                                             0573 02050000
*               DCL                                                0574 02051000
*                 1 $TCA49,         /* TCEC PARM LIST                */ 02052000
*                  2 $TCB49 FIXED(32) INIT(254),/* MSG NUMBER        */ 02053000
*                  2 $TCC49 FIXED(32) INIT(0),/* INCT LEN            */ 02054000
*                  2 $TCD49 BIT(8) INIT('00000000'B),/* FLAG         */ 02055000
*                  2 $TCE49 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK */ 02056000
*               GO TO I02C0010;                                    0575 02057000
         B     I02C0010                                            0575 02058000
*             END;                                                 0576 02059000
*         END;                                                     0577 02060000
@RF00569 DS    0H                                                  0578 02061000
*I02C0220:                                                         0578 02062000
*       $TSTDEVP=OFF;                                              0578 02063000
*                                                                  0578 02064000
I02C0220 NI    $TSTDEVP(WAPTR),B'11011111'                         0578 02065000
*/****************************************************************** */ 02066000
*/*     TEST DEVICES ARE ACCEPTABLE, NOW ACQUIRE THE NEW DEVICE(S)   */ 02067000
*/********************************************************************/ 02068000
*                                                                  0579 02069000
*       $OPNDCNT=OFF;                                              0579 02070000
         SLR   @14,@14                                             0579 02071000
         STH   @14,$OPNDCNT(,WAPTR)                                0579 02072000
*       $OPISCNT=OFF;               /* RESET FOR ACQUSITION          */ 02073000
         STH   @14,$OPISCNT(,WAPTR)                                0580 02074000
*       R1=ADDR(ACQPARM);           /* SET UP PARAMETER POINTER      */ 02075000
         LA    R1,ACQPARM                                          0581 02076000
*       CTPARMB='40'X;              /* ACQUIRE ALL DEVICES           */ 02077000
         MVI   CTPARMB(WAPTR),X'40'                                0582 02078000
*       CALL #EXIT;                 /* CALL ACQUISITION FUNCTION     */ 02079000
         L     @15,#EXITA(,WAPTR)                                  0583 02080000
         BALR  @14,@15                                             0583 02081000
*/********************************************************************/ 02082000
*/* CHECK FOR NON-ZERO RETURN CODE - INDICATING THAT EITHER THERE    */ 02083000
*/* WERE NO TEST DEVICES AVAILABLE, OR NOT ALL REQUESTED DEVICES     */ 02084000
*/* WERE ACQUIRED AND THE CT OPERATOR ENTERED N FOR NO IN RESPONSE   */ 02085000
*/* TO THE 381 MESSAGE DURING ACQUISITION.                           */ 02086000
*/********************************************************************/ 02087000
*                                                                  0584 02088000
*       IF R15^=0 THEN                                             0584 02089000
         LTR   R15,R15                                             0584 02090000
         BNZ   @RT00584                                            0584 02091000
*         GO TO I02C0007;                                          0585 02092000
*                                                                  0585 02093000
*/********************************************************************/ 02094000
*/* EITHER ALL REQUESTED DEVICES WERE ACQUIRED OR SOME WERE          */ 02095000
*/* ACQUIRED AND P FOR PROCEED WAS ENTERED BY THE CT OPERATOR IN     */ 02096000
*/* RESPONSE TO THE 381 MESSAGE DURING ACQUISITION. NOW INITIALIZE   */ 02097000
*/* THE REQUIRED AREAS AND PROCEED TO TEST.                          */ 02098000
*/********************************************************************/ 02099000
*                                                                  0586 02100000
*       IF $NEWAP=ON THEN                                          0586 02101000
         TM    $NEWAP(WAPTR),B'00000001'                           0586 02102000
         BNO   @RF00586                                            0586 02103000
*         DO;                                                      0587 02104000
*           RPLPTR=ADDR($TLTRPL2);  /* AP RPL                        */ 02105000
         LA    RPLPTR,$TLTRPL2(,WAPTR)                             0588 02106000
*           $NEWAP=OFF;                                            0589 02107000
         NI    $NEWAP(WAPTR),B'11111110'                           0589 02108000
*           $NOTDEV(2)=OFF;         /* AP DEV ENTRY VAL              */ 02109000
         NI    $NOTDEV+68(WAPTR),B'01111111'                       0590 02110000
*           $ALTPRTR=ON;                                           0591 02111000
         OI    $ALTPRTR(WAPTR),B'00000010'                         0591 02112000
*           $APRQPER=OFF;                                          0592 02113000
         NI    $APRQPER(WAPTR),B'10111111'                         0592 02114000
*         END;                                                     0593 02115000
*     END;                                                         0594 02116000
*                                                                  0594 02117000
@RF00586 DS    0H                                                  0595 02118000
*/********************************************************************/ 02119000
*/* IF NEITHER A DEVICE NOR TEST CHANGE OCCURRED AT THIS COMM.       */ 02120000
*/* INTERVAL, RETURN IS TO THE CALLER (OLT). OTHERWISE SCHEDULER IS  */ 02121000
*/* CALLED.                                                          */ 02122000
*/********************************************************************/ 02123000
*                                                                  0595 02124000
*   IF $DEVCHNG=OFF&$TESTCNG=OFF&$OLTACT=ON THEN                   0595 02125000
@RF00523 TM    $OLTACT(WAPTR),B'00000001'                          0595 02126000
         BNO   @RF00595                                            0595 02127000
         TM    $DEVCHNG(WAPTR),B'00110000'                         0595 02128000
         BNZ   @RF00595                                            0595 02129000
*     DO;                                                          0596 02130000
*       $CATERR=OFF;                /* RESET CAT ERROR FLAG          */ 02131000
         NI    $CATERR(WAPTR),B'11011111'                          0597 02132000
*       GOTO I02C0230;                                             0598 02133000
         B     I02C0230                                            0598 02134000
*     END;                                                         0599 02135000
*   ELSE                                                           0600 02136000
*     ;                                                            0600 02137000
@RF00595 DS    0H                                                  0601 02138000
*   DO;                                                            0601 02139000
*     R0=0;                                                        0602 02140000
         SLR   R0,R0                                               0602 02141000
*     CALL ISTCC010;                                               0603 02142000
         L     @15,@CV01086                                        0603 02143000
         BALR  @14,@15                                             0603 02144000
*   END;                                                           0604 02145000
*I02C0230:                                                         0605 02146000
*   ;                                                              0605 02147000
I02C0230 DS    0H                                                  0606 02148000
*   $CATMSG=OFF;                    /* RESET CATASTROPHIC MESSAGE HAS   02149000
*                                      BEEN                          */ 02150000
*                                                                  0606 02151000
         NI    $CATMSG(WAPTR),B'11111011'                          0606 02152000
*   /*****************************************************************/ 02153000
*   /*                                                               */ 02154000
*   /* ISSUED FLAG.                                                  */ 02155000
*   /*                                                               */ 02156000
*   /*****************************************************************/ 02157000
*                                                                  0607 02158000
*   R13=SVEIC002(2);                /* RESET R13 TO ORIG POINT       */ 02159000
         L     R13,SVEIC002+4(,WAPTR)                              0607 02160000
*   RETURN;                         /* RETURN TO CALLER      @D32JPFR*/ 02161000
@EL00001 DS    0H                                                  0608 02162000
@EF00001 DS    0H                                                  0608 02163000
@ER00001 LM    @14,@12,12(@13)                                     0608 02164000
         BR    @14                                                 0608 02165000
*I02C2000:                                                         0609 02166000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0609 02167000
I02C2000 DS    0H                                                  0610 02168000
*   R4=R14;                         /* SAVE THE RETURN POINT         */ 02169000
         LR    R4,R14                                              0610 02170000
*I02C2100:                                                         0611 02171000
*   IF^($INBUFR(2)='Y'|$INBUFR(2)='N')|($INBUFR(1)>1&$INBUFR(3)^=',')   02172000
*     THEN                                                         0611 02173000
I02C2100 CLI   $INBUFR+1(WAPTR),C'Y'                               0611 02174000
         BE    @GL00028                                            0611 02175000
         CLI   $INBUFR+1(WAPTR),C'N'                               0611 02176000
         BNE   @RT00611                                            0611 02177000
@GL00028 CLI   $INBUFR(WAPTR),1                                    0611 02178000
         BNH   @RF00611                                            0611 02179000
         CLI   $INBUFR+2(WAPTR),C','                               0611 02180000
         BE    @RF00611                                            0611 02181000
@RT00611 DS    0H                                                  0612 02182000
*     DO;                                                          0612 02183000
*                                                                  0612 02184000
*       /*************************************************************/ 02185000
*       /*                                                           */ 02186000
*       /* TCEC MSGN(299)INCT(61)DIR(NET) INVOKED                    */ 02187000
*       /*                                                           */ 02188000
*       /*************************************************************/ 02189000
*                                                                  0613 02190000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 02191000
         OI    $TCECM(WAPTR),B'00000001'                           0613 02192000
*       R1=ADDR($TCA50);            /* SET UP PARM LIST $TR          */ 02193000
         LA    R1,$TCA50                                           0614 02194000
*       CALL #EXIT;                 /* CALL CECOM                    */ 02195000
         L     @15,#EXITA(,WAPTR)                                  0615 02196000
         BALR  @14,@15                                             0615 02197000
*       DCL                                                        0616 02198000
*         1 $TCA50,                 /* TCEC PARM LIST                */ 02199000
*          2 $TCB50 FIXED(32) INIT(299),/* MSG NUMBER                */ 02200000
*          2 $TCC50 FIXED(32) INIT(61),/* INCT LEN                   */ 02201000
*          2 $TCD50 BIT(8) INIT('01001000'B),/* FLAG                 */ 02202000
*          2 $TCE50 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 02203000
*       GO TO I02C2100;             /* GO DECODE INPUT               */ 02204000
         B     I02C2100                                            0617 02205000
*     END;                                                         0618 02206000
*   ELSE                                                           0619 02207000
*     DO;                                                          0619 02208000
@RF00611 DS    0H                                                  0620 02209000
*       T463C=T463B;                /* MOVE MESSAGE OVER             */ 02210000
         MVC   @TS00001(61),T463B(WAPTR)                           0620 02211000
         MVC   T463C(61,WAPTR),@TS00001                            0620 02212000
*       T463A='462';                /* INSERT MESSAGE ID             */ 02213000
         MVC   T463A(3,WAPTR),@CC01098                             0621 02214000
*       IF $INBUFR(5)=',' THEN                                     0622 02215000
         CLI   $INBUFR+4(WAPTR),C','                               0622 02216000
         BNE   @RF00622                                            0622 02217000
*         DO;                                                      0623 02218000
*                                                                  0623 02219000
*           /*********************************************************/ 02220000
*           /*                                                       */ 02221000
*           /* TCEC MSGN(463)SUB(YES)MSGMSK('C0000000'X) INVOKED     */ 02222000
*           /*                                                       */ 02223000
*           /*********************************************************/ 02224000
*                                                                  0624 02225000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 02226000
         OI    $TCECM(WAPTR),B'00000001'                           0624 02227000
*           R1=ADDR($TCA51);        /* SET UP PARM LIST $TR          */ 02228000
         LA    R1,$TCA51                                           0625 02229000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 02230000
         L     @15,@CV00842                                        0626 02231000
         BALR  @14,@15                                             0626 02232000
*           DCL                                                    0627 02233000
*             1 $TCA51,             /* TCEC PARM LIST                */ 02234000
*              2 $TCB51 FIXED(32) INIT(463),/* MSG NUMBER            */ 02235000
*              2 $TCC51 FIXED(32) INIT(0),/* INCT LEN                */ 02236000
*              2 $TCD51 BIT(8) INIT('10000000'B),                  0627 02237000
*                                                                  0627 02238000
*/* FLAG                                                             */ 02239000
*                                                                  0627 02240000
*              2 $TCE51 CHAR(4) INIT('C0000000'X);/* MSSAGE MASK     */ 02241000
*         END;                                                     0628 02242000
*       IF $INBUFR(4)='N' THEN                                     0629 02243000
@RF00622 CLI   $INBUFR+3(WAPTR),C'N'                               0629 02244000
         BNE   @RF00629                                            0629 02245000
*         DO;                                                      0630 02246000
*                                                                  0630 02247000
*/****************************************************************** */ 02248000
*/*      ISSUE MESSAGE -NETWORK CONTROLLER DENIED USE OF DEVICES-    */ 02249000
*/****************************************************************** */ 02250000
*                                                                  0631 02251000
*           /*********************************************************/ 02252000
*           /*                                                       */ 02253000
*           /* TCEC MSGN(254) INVOKED                                */ 02254000
*           /*                                                       */ 02255000
*           /*********************************************************/ 02256000
*                                                                  0631 02257000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 02258000
         OI    $TCECM(WAPTR),B'00000001'                           0631 02259000
*           R1=ADDR($TCA52);        /* SET UP PARM LIST $TR          */ 02260000
         LA    R1,$TCA52                                           0632 02261000
*           CALL #EXIT;             /* CALL CECOM                    */ 02262000
         L     @15,#EXITA(,WAPTR)                                  0633 02263000
         BALR  @14,@15                                             0633 02264000
*           DCL                                                    0634 02265000
*             1 $TCA52,             /* TCEC PARM LIST                */ 02266000
*              2 $TCB52 FIXED(32) INIT(254),/* MSG NUMBER            */ 02267000
*              2 $TCC52 FIXED(32) INIT(0),/* INCT LEN                */ 02268000
*              2 $TCD52 BIT(8) INIT('00000000'B),/* FLAG             */ 02269000
*              2 $TCE52 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK     */ 02270000
*           R15=4;                  /* SET BAD RC            @D32JPFR*/ 02271000
         LA    R15,4                                               0635 02272000
*         END;                                                     0636 02273000
*     END;                                                         0637 02274000
@RF00629 DS    0H                                                  0638 02275000
*   R14=R4;                         /* RESTORE THE RETURN POINT      */ 02276000
         LR    R14,R4                                              0638 02277000
*   END I02C2000;                                                  0639 02278000
*                                                                  0639 02279000
@EL00002 DS    0H                                                  0639 02280000
@EF00002 DS    0H                                                  0639 02281000
@ER00002 BR    @14                                                 0639 02282000
*/****************************************************************** */ 02283000
*/*                 DETERMINE IF NEW CT IS KNOWN TO VTAM             */ 02284000
*/****************************************************************** */ 02285000
*                                                                  0640 02286000
*I02C1000:                                                         0640 02287000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0640 02288000
I02C1000 DS    0H                                                  0641 02289000
*   R4=R14;                         /* SAVE THE RETURN POINT         */ 02290000
         LR    R4,R14                                              0641 02291000
*   R1=ADDR(CTPARM);                /* SET UP PARAMETER POINTER      */ 02292000
         LA    R1,CTPARM(,WAPTR)                                   0642 02293000
*   CTPARMA=ADDR(TEMPCDS);          /* SET UP POINTER TO FAKE CDS    */ 02294000
         LA    @14,TEMPCDS(,WAPTR)                                 0643 02295000
         ST    @14,CTPARMA(,WAPTR)                                 0643 02296000
*   CTPARMB='20'X;                  /* VERIFY AND RETURN DEVICE    0644 02297000
*                                      CHARACTERISTICS ALSO OUTPUT 0644 02298000
*                                      MSG IF DEVICE IS EITHER IN  0644 02299000
*                                      OTHER USERS DEV TABLE OR NOT     02300000
*                                      KNOWN TO VTAM.                */ 02301000
         MVI   CTPARMB(WAPTR),X'20'                                0644 02302000
*   CALL ISTSC030;                  /* CALL ACQ/VERIFY FUNCTION      */ 02303000
         L     @15,@CV01113                                        0645 02304000
         BALR  @14,@15                                             0645 02305000
*   CTPTRS=DEVDATA;                                                0646 02306000
         MVC   CTPTRS(9,WAPTR),DEVDATA(WAPTR)                      0646 02307000
*   IF R15^=0 THEN                  /* CHECK FOR NON-ZERO RET CODE   */ 02308000
         LTR   R15,R15                                             0647 02309000
         BZ    @RF00647                                            0647 02310000
*     DO;                           /* ERROR FROM VERIFY     @D32JPFR*/ 02311000
*       R15=4;                      /* GO RE-ISSUE 105D MESSAGE      */ 02312000
         LA    R15,4                                               0649 02313000
*       GOTO I02C1100;              /* RETURN TO CALLER      @D32JPFR*/ 02314000
         B     I02C1100                                            0650 02315000
*     END;                          /*                       @D32JPFR*/ 02316000
*   $CTMSGNM=AQCTNAME;              /* SAVE DEVICE NAME RETURNED FROM   02317000
*                                      VTAM.                         */ 02318000
@RF00647 L     @14,ACQSYMN(,WAPTR)                                 0652 02319000
         MVC   $CTMSGNM(8,WAPTR),AQCTNAME(@14)                     0652 02320000
*   SVEIC00A(1)=DEVCHAR;            /* SAVE NEW CT DEV CHARS.        */ 02321000
         L     @14,ACQCHAR(,WAPTR)                                 0653 02322000
         MVC   SVEIC00A(4,WAPTR),DEVCHAR(@14)                      0653 02323000
*/********************************************************************/ 02324000
*/* DETERMINE IF NEW CT HAS REQUIRED DEVICE CHARACTERISTICS (MUST    */ 02325000
*/* BE CAPABLE OF ALPHA-NUMERIC INPUT.)                              */ 02326000
*/********************************************************************/ 02327000
*                                                                  0654 02328000
*   R1=ACQCHAR;                     /* POINTER TO DEV CHARACTERISTICS*/ 02329000
         LR    R1,@14                                              0654 02330000
*   CALL I00C0200;                  /* CALL SUBROUTINE TO DETERMINE     02331000
*                                      IF THIS DEVICE OK AS CT       */ 02332000
         L     @15,@CV01115                                        0655 02333000
         BALR  @14,@15                                             0655 02334000
*   IF R15^=0 THEN                  /* CHK RET CODE          @D32JPFR*/ 02335000
         LTR   R15,R15                                             0656 02336000
         BZ    @RF00656                                            0656 02337000
*     R15=8;                        /* SET BAD RC            @D32JPFR*/ 02338000
         LA    R15,8                                               0657 02339000
*I02C1100:                          /* RETURN TO CALLER      @D32JPFR*/ 02340000
*   R14=R4;                         /* RESTORE THE RETRUN POINT      */ 02341000
@RF00656 DS    0H                                                  0658 02342000
I02C1100 LR    R14,R4                                              0658 02343000
*   END I02C1000;                   /* END OF CT CHECK               */ 02344000
@EL00003 DS    0H                                                  0659 02345000
@EF00003 DS    0H                                                  0659 02346000
@ER00003 BR    @14                                                 0659 02347000
*/* TPEPILOG                                                         */ 02348000
*                                                                  0660 02349000
*   GEN(PRINT OFF);                                                0660 02350000
         PRINT OFF                                                      02351000
*   GEN(PRINT ON);                                                 0661 02352000
*                                                                  0661 02353000
         PRINT ON                                                       02354000
*/* END OF TPEPILOG                                                  */ 02355000
*/* ATDSPLY   INVOKED.                                               */ 02356000
*/********************************************************************/ 02357000
*/* THE FOLLOWING ATBUILD INCLUSIONS HAVE BEEN MADE IN THIS          */ 02358000
*/* COMPILATION:                                                     */ 02359000
*/*             ISTTIE                                               */ 02360000
*/********************************************************************/ 02361000
*/* END OF ATDSPLY.                                                  */ 02362000
*                                                                  0662 02363000
*   END;                                                           0662 02364000
         B     @EL00001                                            0662 02365000
@DATA    DS    0H                                                       02366000
@CH00373 DC    H'68'                                                    02367000
@SM01138 MVC   CTNAME-1(0,@14),@TS00001                                 02368000
@SM01140 MVC   CTNAME(0,WAPTR),@TS00001                                 02369000
@SM01142 MVC   $CTMSGNM(0,WAPTR),@TS00001                               02370000
         DS    0F                                                       02371000
@TF00001 DS    F                                                        02372000
         DS    0F                                                       02373000
@CF00072 DC    F'1'                                                     02374000
@CF00137 DC    F'2'                                                     02375000
@CH00137 EQU   @CF00137+2                                               02376000
@CF00081 DC    F'3'                                                     02377000
@CH00081 EQU   @CF00081+2                                               02378000
@CF00068 DC    F'4'                                                     02379000
@CF00348 DC    F'5'                                                     02380000
@CF00054 DC    F'8'                                                     02381000
@CF00134 DC    F'12'                                                    02382000
@CV00795 DC    V(ISTIC005)                                              02383000
@CV00823 DC    V(ISTTC037)                                              02384000
@CV00836 DC    V(C14C0020)                                              02385000
@CV00842 DC    V(S20CEC03)                                              02386000
@CV00883 DC    V(ISTTC035)                                              02387000
@CV00885 DC    V(ISTIC006)                                              02388000
@CV00957 DC    V(ISTSC021)                                              02389000
@CV00996 DC    V(ISTIC003)                                              02390000
@CV00997 DC    V(ISTIC004)                                              02391000
@CV01086 DC    V(ISTCC010)                                              02392000
@CV01113 DC    V(ISTSC030)                                              02393000
@CV01115 DC    V(I00C0200)                                              02394000
         DS    0D                                                       02395000
@TS00001 DS    CL61                                                     02396000
@CC01054 DC    C'**PROTECTED**'                                         02397000
@CC00928 DC    C'PROMPT TEST'                                           02398000
@CC00935 DC    C'PROMPT VERB'                                           02399000
@CC00888 DC    C'PROMPT ALL'                                            02400000
@CC00914 DC    C'PROMPT DEV'                                            02401000
@CC00921 DC    C'PROMPT OPT'                                            02402000
@CC00760 DC    C'SYS CON '                                              02403000
@CC00947 DC    C'00000000'                                              02404000
@CC01044 DC    C'        '                                              02405000
@CC00834 DC    C'CANCEL'                                                02406000
@CC00837 EQU   @CC00928                                                 02407000
@CC00839 DC    C'UPDATE'                                                02408000
@CC01019 DC    C'////  '                                                02409000
@CC00994 DC    C'.NDR/'                                                 02410000
@CC00815 DC    C'DUMP'                                                  02411000
@CC00824 DC    C'TALK'                                                  02412000
@CC00868 DC    C'550'                                                   02413000
@CC00942 DC    C'CT='                                                   02414000
@CC01021 DC    C'T//'                                                   02415000
@CC01073 DC    C'247'                                                   02416000
@CC01098 DC    C'462'                                                   02417000
@CC00995 DC    C'*/'                                                    02418000
         DS    CL2                                                      02419000
ACQCTPRM DS    CL9                                                      02420000
         ORG   ACQCTPRM                                                 02421000
@NM00056 DC    XL4'0102F3F0'                                            02422000
@NM00057 DC    F'0'                                                     02423000
@NM00058 DC    B'01100000'                                              02424000
         ORG   ACQCTPRM+9                                               02425000
         DS    CL3                                                      02426000
ACQPARM  DS    CL9                                                      02427000
         ORG   ACQPARM                                                  02428000
ACQID    DC    XL4'0102F3F0'                                            02429000
@NM00059 DC    XL4'00000000'                                            02430000
@NM00060 DC    B'01000000'                                              02431000
         ORG   ACQPARM+9                                                02432000
         DS    CL3                                                      02433000
RELPARM  DS    CL9                                                      02434000
         ORG   RELPARM                                                  02435000
RELID    DC    XL4'0102F3F1'                                            02436000
RELDEV   DC    XL4'00000000'                                            02437000
RELFLG   DC    B'01000000'                                              02438000
         ORG   RELPARM+9                                                02439000
         DS    CL3                                                      02440000
CTTIE    DS    CL16                                                     02441000
$TCA11   DS    CL13                                                     02442000
         ORG   $TCA11                                                   02443000
$TCB11   DC    A(923)                                                   02444000
$TCC11   DC    A(0)                                                     02445000
$TCD11   DC    B'10001000'                                              02446000
$TCE11   DC    X'FFFFFFFF'                                              02447000
         ORG   $TCA11+13                                                02448000
         DS    CL3                                                      02449000
$TCA12   DS    CL13                                                     02450000
         ORG   $TCA12                                                   02451000
$TCB12   DC    A(102)                                                   02452000
$TCC12   DC    A(0)                                                     02453000
$TCD12   DC    B'00000000'                                              02454000
$TCE12   DC    X'FFFFFFFF'                                              02455000
         ORG   $TCA12+13                                                02456000
         DS    CL3                                                      02457000
$TCA13   DS    CL13                                                     02458000
         ORG   $TCA13                                                   02459000
$TCB13   DC    A(920)                                                   02460000
$TCC13   DC    A(61)                                                    02461000
$TCD13   DC    B'11001000'                                              02462000
$TCE13   DC    X'FFFFFFFF'                                              02463000
         ORG   $TCA13+13                                                02464000
         DS    CL3                                                      02465000
$TCA14   DS    CL13                                                     02466000
         ORG   $TCA14                                                   02467000
$TCB14   DC    A(102)                                                   02468000
$TCC14   DC    A(0)                                                     02469000
$TCD14   DC    B'00000000'                                              02470000
$TCE14   DC    X'FFFFFFFF'                                              02471000
         ORG   $TCA14+13                                                02472000
         DS    CL3                                                      02473000
$TCA15   DS    CL13                                                     02474000
         ORG   $TCA15                                                   02475000
$TCB15   DC    A(105)                                                   02476000
$TCC15   DC    A(61)                                                    02477000
$TCD15   DC    B'01000000'                                              02478000
$TCE15   DC    X'FFFFFFFF'                                              02479000
         ORG   $TCA15+13                                                02480000
         DS    CL3                                                      02481000
$TCA16   DS    CL13                                                     02482000
         ORG   $TCA16                                                   02483000
$TCB16   DC    A(106)                                                   02484000
$TCC16   DC    A(0)                                                     02485000
$TCD16   DC    B'00000000'                                              02486000
$TCE16   DC    X'FFFFFFFF'                                              02487000
         ORG   $TCA16+13                                                02488000
         DS    CL3                                                      02489000
$TCA17   DS    CL13                                                     02490000
         ORG   $TCA17                                                   02491000
$TCB17   DC    A(546)                                                   02492000
$TCC17   DC    A(0)                                                     02493000
$TCD17   DC    B'00000000'                                              02494000
$TCE17   DC    X'FFFFFFFF'                                              02495000
         ORG   $TCA17+13                                                02496000
         DS    CL3                                                      02497000
$TCA18   DS    CL13                                                     02498000
         ORG   $TCA18                                                   02499000
$TCB18   DC    A(166)                                                   02500000
$TCC18   DC    A(0)                                                     02501000
$TCD18   DC    B'00000000'                                              02502000
$TCE18   DC    X'FFFFFFFF'                                              02503000
         ORG   $TCA18+13                                                02504000
         DS    CL3                                                      02505000
$TCA19   DS    CL13                                                     02506000
         ORG   $TCA19                                                   02507000
$TCB19   DC    A(551)                                                   02508000
$TCC19   DC    A(0)                                                     02509000
$TCD19   DC    B'00000000'                                              02510000
$TCE19   DC    X'40000000'                                              02511000
         ORG   $TCA19+13                                                02512000
         DS    CL3                                                      02513000
$TCA20   DS    CL13                                                     02514000
         ORG   $TCA20                                                   02515000
$TCB20   DC    A(550)                                                   02516000
$TCC20   DC    A(61)                                                    02517000
$TCD20   DC    B'11001000'                                              02518000
$TCE20   DC    X'FFFFFFFF'                                              02519000
         ORG   $TCA20+13                                                02520000
         DS    CL3                                                      02521000
$TCA21   DS    CL13                                                     02522000
         ORG   $TCA21                                                   02523000
$TCB21   DC    A(299)                                                   02524000
$TCC21   DC    A(61)                                                    02525000
$TCD21   DC    B'01001000'                                              02526000
$TCE21   DC    X'FFFFFFFF'                                              02527000
         ORG   $TCA21+13                                                02528000
         DS    CL3                                                      02529000
$TCA22   DS    CL13                                                     02530000
         ORG   $TCA22                                                   02531000
$TCB22   DC    A(463)                                                   02532000
$TCC22   DC    A(0)                                                     02533000
$TCD22   DC    B'10000000'                                              02534000
$TCE22   DC    X'C0000000'                                              02535000
         ORG   $TCA22+13                                                02536000
         DS    CL3                                                      02537000
$TCA23   DS    CL13                                                     02538000
         ORG   $TCA23                                                   02539000
$TCB23   DC    A(254)                                                   02540000
$TCC23   DC    A(0)                                                     02541000
$TCD23   DC    B'00000000'                                              02542000
$TCE23   DC    X'FFFFFFFF'                                              02543000
         ORG   $TCA23+13                                                02544000
         DS    CL3                                                      02545000
$TCA24   DS    CL13                                                     02546000
         ORG   $TCA24                                                   02547000
$TCB24   DC    A(147)                                                   02548000
$TCC24   DC    A(0)                                                     02549000
$TCD24   DC    B'00000000'                                              02550000
$TCE24   DC    X'FFFFFFFF'                                              02551000
         ORG   $TCA24+13                                                02552000
         DS    CL3                                                      02553000
$TCA25   DS    CL13                                                     02554000
         ORG   $TCA25                                                   02555000
$TCB25   DC    A(148)                                                   02556000
$TCC25   DC    A(0)                                                     02557000
$TCD25   DC    B'00000000'                                              02558000
$TCE25   DC    X'FFFFFFFF'                                              02559000
         ORG   $TCA25+13                                                02560000
         DS    CL3                                                      02561000
$TCA26   DS    CL13                                                     02562000
         ORG   $TCA26                                                   02563000
$TCB26   DC    A(149)                                                   02564000
$TCC26   DC    A(0)                                                     02565000
$TCD26   DC    B'00000000'                                              02566000
$TCE26   DC    X'FFFFFFFF'                                              02567000
         ORG   $TCA26+13                                                02568000
         DS    CL3                                                      02569000
$TCA27   DS    CL13                                                     02570000
         ORG   $TCA27                                                   02571000
$TCB27   DC    A(141)                                                   02572000
$TCC27   DC    A(0)                                                     02573000
$TCD27   DC    B'00000000'                                              02574000
$TCE27   DC    X'FFFFFFFF'                                              02575000
         ORG   $TCA27+13                                                02576000
         DS    CL3                                                      02577000
$TCA28   DS    CL13                                                     02578000
         ORG   $TCA28                                                   02579000
$TCB28   DC    A(147)                                                   02580000
$TCC28   DC    A(0)                                                     02581000
$TCD28   DC    B'00000000'                                              02582000
$TCE28   DC    X'FFFFFFFF'                                              02583000
         ORG   $TCA28+13                                                02584000
         DS    CL3                                                      02585000
$TCA29   DS    CL13                                                     02586000
         ORG   $TCA29                                                   02587000
$TCB29   DC    A(149)                                                   02588000
$TCC29   DC    A(0)                                                     02589000
$TCD29   DC    B'00000000'                                              02590000
$TCE29   DC    X'FFFFFFFF'                                              02591000
         ORG   $TCA29+13                                                02592000
         DS    CL3                                                      02593000
$TCA30   DS    CL13                                                     02594000
         ORG   $TCA30                                                   02595000
$TCB30   DC    A(148)                                                   02596000
$TCC30   DC    A(0)                                                     02597000
$TCD30   DC    B'00000000'                                              02598000
$TCE30   DC    X'FFFFFFFF'                                              02599000
         ORG   $TCA30+13                                                02600000
         DS    CL3                                                      02601000
$TCA31   DS    CL13                                                     02602000
         ORG   $TCA31                                                   02603000
$TCB31   DC    A(141)                                                   02604000
$TCC31   DC    A(0)                                                     02605000
$TCD31   DC    B'00000000'                                              02606000
$TCE31   DC    X'FFFFFFFF'                                              02607000
         ORG   $TCA31+13                                                02608000
         DS    CL3                                                      02609000
ITATCPRM DS    CL14                                                     02610000
         ORG   ITATCPRM                                                 02611000
@NM00061 DC    X'0102F4F1'                                              02612000
ITATCFR  DS    AL4                                                      02613000
ITATCTO  DS    AL4                                                      02614000
@NM00062 DC    AL1(0)                                                   02615000
         ORG   @NM00062                                                 02616000
ITATCTP  DS    BL1                                                      02617000
         ORG   ITATCPRM+13                                              02618000
ITATCNT  DS    FL1                                                      02619000
         ORG   ITATCPRM+14                                              02620000
         DS    CL2                                                      02621000
$TCA33   DS    CL13                                                     02622000
         ORG   $TCA33                                                   02623000
$TCB33   DC    A(460)                                                   02624000
$TCC33   DC    A(0)                                                     02625000
$TCD33   DC    B'10000000'                                              02626000
$TCE33   DC    X'20000000'                                              02627000
         ORG   $TCA33+13                                                02628000
         DS    CL3                                                      02629000
$TCA34   DS    CL13                                                     02630000
         ORG   $TCA34                                                   02631000
$TCB34   DC    A(462)                                                   02632000
$TCC34   DC    A(61)                                                    02633000
$TCD34   DC    B'11001000'                                              02634000
$TCE34   DC    X'FFFFFFFF'                                              02635000
         ORG   $TCA34+13                                                02636000
         DS    CL3                                                      02637000
$TCA35   DS    CL13                                                     02638000
         ORG   $TCA35                                                   02639000
$TCB35   DC    A(461)                                                   02640000
$TCC35   DC    A(0)                                                     02641000
$TCD35   DC    B'10000000'                                              02642000
$TCE35   DC    X'FFFFFFFF'                                              02643000
         ORG   $TCA35+13                                                02644000
         DS    CL3                                                      02645000
$TCA36   DS    CL13                                                     02646000
         ORG   $TCA36                                                   02647000
$TCB36   DC    A(461)                                                   02648000
$TCC36   DC    A(0)                                                     02649000
$TCD36   DC    B'10000000'                                              02650000
$TCE36   DC    X'FFFFFFFF'                                              02651000
         ORG   $TCA36+13                                                02652000
         DS    CL3                                                      02653000
$TCA37   DS    CL13                                                     02654000
         ORG   $TCA37                                                   02655000
$TCB37   DC    A(299)                                                   02656000
$TCC37   DC    A(61)                                                    02657000
$TCD37   DC    B'01000000'                                              02658000
$TCE37   DC    X'FFFFFFFF'                                              02659000
         ORG   $TCA37+13                                                02660000
         DS    CL3                                                      02661000
$TCA38   DS    CL13                                                     02662000
         ORG   $TCA38                                                   02663000
$TCB38   DC    A(170)                                                   02664000
$TCC38   DC    A(0)                                                     02665000
$TCD38   DC    B'00000000'                                              02666000
$TCE38   DC    X'80000000'                                              02667000
         ORG   $TCA38+13                                                02668000
         DS    CL3                                                      02669000
$TCA39   DS    CL13                                                     02670000
         ORG   $TCA39                                                   02671000
$TCB39   DC    A(170)                                                   02672000
$TCC39   DC    A(0)                                                     02673000
$TCD39   DC    B'00000000'                                              02674000
$TCE39   DC    X'40000000'                                              02675000
         ORG   $TCA39+13                                                02676000
         DS    CL3                                                      02677000
$TCA40   DS    CL13                                                     02678000
         ORG   $TCA40                                                   02679000
$TCB40   DC    A(161)                                                   02680000
$TCC40   DC    A(0)                                                     02681000
$TCD40   DC    B'00000000'                                              02682000
$TCE40   DC    X'FFFFFFFF'                                              02683000
         ORG   $TCA40+13                                                02684000
         DS    CL3                                                      02685000
$TCA41   DS    CL13                                                     02686000
         ORG   $TCA41                                                   02687000
$TCB41   DC    A(464)                                                   02688000
$TCC41   DC    A(0)                                                     02689000
$TCD41   DC    B'10000000'                                              02690000
$TCE41   DC    X'FFFFFFFF'                                              02691000
         ORG   $TCA41+13                                                02692000
         DS    CL3                                                      02693000
$TCA42   DS    CL13                                                     02694000
         ORG   $TCA42                                                   02695000
$TCB42   DC    A(223)                                                   02696000
$TCC42   DC    A(0)                                                     02697000
$TCD42   DC    B'10000000'                                              02698000
$TCE42   DC    X'FFFFFFFF'                                              02699000
         ORG   $TCA42+13                                                02700000
         DS    CL3                                                      02701000
$TCA43   DS    CL13                                                     02702000
         ORG   $TCA43                                                   02703000
$TCB43   DC    A(465)                                                   02704000
$TCC43   DC    A(0)                                                     02705000
$TCD43   DC    B'00000000'                                              02706000
$TCE43   DC    X'80000000'                                              02707000
         ORG   $TCA43+13                                                02708000
         DS    CL3                                                      02709000
$TCA44   DS    CL13                                                     02710000
         ORG   $TCA44                                                   02711000
$TCB44   DC    A(247)                                                   02712000
$TCC44   DC    A(0)                                                     02713000
$TCD44   DC    B'10001000'                                              02714000
$TCE44   DC    X'80000000'                                              02715000
         ORG   $TCA44+13                                                02716000
         DS    CL3                                                      02717000
$TCA45   DS    CL13                                                     02718000
         ORG   $TCA45                                                   02719000
$TCB45   DC    A(247)                                                   02720000
$TCC45   DC    A(0)                                                     02721000
$TCD45   DC    B'10001000'                                              02722000
$TCE45   DC    X'40000000'                                              02723000
         ORG   $TCA45+13                                                02724000
         DS    CL3                                                      02725000
$TCA46   DS    CL13                                                     02726000
         ORG   $TCA46                                                   02727000
$TCB46   DC    A(247)                                                   02728000
$TCC46   DC    A(61)                                                    02729000
$TCD46   DC    B'01001000'                                              02730000
$TCE46   DC    X'20000000'                                              02731000
         ORG   $TCA46+13                                                02732000
         DS    CL3                                                      02733000
$TCA47   DS    CL13                                                     02734000
         ORG   $TCA47                                                   02735000
$TCB47   DC    A(299)                                                   02736000
$TCC47   DC    A(61)                                                    02737000
$TCD47   DC    B'01001000'                                              02738000
$TCE47   DC    X'FFFFFFFF'                                              02739000
         ORG   $TCA47+13                                                02740000
         DS    CL3                                                      02741000
$TCA48   DS    CL13                                                     02742000
         ORG   $TCA48                                                   02743000
$TCB48   DC    A(463)                                                   02744000
$TCC48   DC    A(0)                                                     02745000
$TCD48   DC    B'10000000'                                              02746000
$TCE48   DC    X'C0000000'                                              02747000
         ORG   $TCA48+13                                                02748000
         DS    CL3                                                      02749000
$TCA49   DS    CL13                                                     02750000
         ORG   $TCA49                                                   02751000
$TCB49   DC    A(254)                                                   02752000
$TCC49   DC    A(0)                                                     02753000
$TCD49   DC    B'00000000'                                              02754000
$TCE49   DC    X'FFFFFFFF'                                              02755000
         ORG   $TCA49+13                                                02756000
         DS    CL3                                                      02757000
$TCA50   DS    CL13                                                     02758000
         ORG   $TCA50                                                   02759000
$TCB50   DC    A(299)                                                   02760000
$TCC50   DC    A(61)                                                    02761000
$TCD50   DC    B'01001000'                                              02762000
$TCE50   DC    X'FFFFFFFF'                                              02763000
         ORG   $TCA50+13                                                02764000
         DS    CL3                                                      02765000
$TCA51   DS    CL13                                                     02766000
         ORG   $TCA51                                                   02767000
$TCB51   DC    A(463)                                                   02768000
$TCC51   DC    A(0)                                                     02769000
$TCD51   DC    B'10000000'                                              02770000
$TCE51   DC    X'C0000000'                                              02771000
         ORG   $TCA51+13                                                02772000
         DS    CL3                                                      02773000
$TCA52   DS    CL13                                                     02774000
         ORG   $TCA52                                                   02775000
$TCB52   DC    A(254)                                                   02776000
$TCC52   DC    A(0)                                                     02777000
$TCD52   DC    B'00000000'                                              02778000
$TCE52   DC    X'FFFFFFFF'                                              02779000
         ORG   $TCA52+13                                                02780000
         DS    CL3                                                      02781000
CTSAVE   DS    CL64                                                     02782000
M923FILL DC    CL20' INVALID DEVICE TYPE'                               02783000
         DC    CL20' IN USE BY ISTOLTEP '                               02784000
PATCH    DC    55F'0'                                                   02785000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02786000
@01      EQU   01                                                       02787000
@02      EQU   02                                                       02788000
@03      EQU   03                                                       02789000
@04      EQU   04                                                       02790000
@05      EQU   05                                                       02791000
@06      EQU   06                                                       02792000
@07      EQU   07                                                       02793000
@08      EQU   08                                                       02794000
@09      EQU   09                                                       02795000
@10      EQU   10                                                       02796000
@11      EQU   11                                                       02797000
@12      EQU   12                                                       02798000
@13      EQU   13                                                       02799000
@14      EQU   14                                                       02800000
@15      EQU   15                                                       02801000
RPLPTR   EQU   @10                                                      02802000
RCAPTR   EQU   @03                                                      02803000
WAPTR    EQU   @02                                                      02804000
R0       EQU   @00                                                      02805000
R1       EQU   @01                                                      02806000
R4       EQU   @04                                                      02807000
X        EQU   @06                                                      02808000
I        EQU   @07                                                      02809000
R5       EQU   @05                                                      02810000
R13      EQU   @13                                                      02811000
R14      EQU   @14                                                      02812000
R15      EQU   @15                                                      02813000
$RCAAREA EQU   0                                                        02814000
$POINTER EQU   $RCAAREA+100                                             02815000
$TRTBLA  EQU   $POINTER+124                                             02816000
$CTNAME  EQU   $POINTER+132                                             02817000
$CONSTNT EQU   $RCAAREA+244                                             02818000
$USECNT  EQU   $CONSTNT                                                 02819000
$RCAFLG  EQU   $RCAAREA+604                                             02820000
$UPDATE  EQU   $RCAFLG                                                  02821000
TOLTEPWA EQU   0                                                        02822000
$SCTTBLE EQU   TOLTEPWA                                                 02823000
$TESTOPT EQU   $SCTTBLE+2                                               02824000
$ERROPT  EQU   $SCTTBLE+3                                               02825000
$CATERR  EQU   $ERROPT                                                  02826000
$DRIVER  EQU   $SCTTBLE+6                                               02827000
$PDEVFLG EQU   $SCTTBLE+10                                              02828000
$CDSFLGS EQU   $SCTTBLE+11                                              02829000
$CDS8T19 EQU   $SCTTBLE+20                                              02830000
$EXECFLG EQU   $SCTTBLE+33                                              02831000
$OLTFLGS EQU   $SCTTBLE+36                                              02832000
$DYCOM   EQU   $OLTFLGS                                                 02833000
$OLTFLG2 EQU   $SCTTBLE+37                                              02834000
$TALK    EQU   $OLTFLG2                                                 02835000
$TOTFLG1 EQU   $SCTTBLE+38                                              02836000
$ROUTMSK EQU   $SCTTBLE+40                                              02837000
$CDA     EQU   TOLTEPWA+100                                             02838000
$SLASHAD EQU   $CDA+32                                                  02839000
$RCA     EQU   $CDA+44                                                  02840000
$OLTPTR  EQU   $CDA+52                                                  02841000
$HIMOREC EQU   $CDA+60                                                  02842000
$OPNDCNT EQU   $CDA+112                                                 02843000
$OPISCNT EQU   $CDA+114                                                 02844000
$COMMFLG EQU   TOLTEPWA+224                                             02845000
$FLAG1   EQU   $COMMFLG                                                 02846000
$TESTCNG EQU   $FLAG1                                                   02847000
$DEVCHNG EQU   $FLAG1                                                   02848000
$OPTCHNG EQU   $FLAG1                                                   02849000
$NORELDV EQU   $FLAG1                                                   02850000
$OLTACT  EQU   $FLAG1                                                   02851000
$FLAG2   EQU   $COMMFLG+1                                               02852000
$VALDDEV EQU   $FLAG2                                                   02853000
$VALDTST EQU   $FLAG2                                                   02854000
$FLAG3   EQU   $COMMFLG+2                                               02855000
$DEVERR  EQU   $FLAG3                                                   02856000
$TSTERR  EQU   $FLAG3                                                   02857000
$OPTERR  EQU   $FLAG3                                                   02858000
$ALTPRTR EQU   $FLAG3                                                   02859000
$NEWAP   EQU   $FLAG3                                                   02860000
$FLAG4   EQU   $COMMFLG+3                                               02861000
$OPCOM   EQU   $FLAG4                                                   02862000
$APRQPER EQU   $FLAG4                                                   02863000
$TSTDEVP EQU   $FLAG4                                                   02864000
$FLAG5   EQU   $COMMFLG+4                                               02865000
$EOJ     EQU   $FLAG5                                                   02866000
$CANCEL  EQU   $EOJ                                                     02867000
$FLAG6   EQU   $COMMFLG+5                                               02868000
$ABNDBIT EQU   $FLAG6                                                   02869000
$CIREQ   EQU   $FLAG6                                                   02870000
$FLAG7   EQU   $COMMFLG+6                                               02871000
$FLAG8   EQU   $COMMFLG+7                                               02872000
$TCECM   EQU   $FLAG8                                                   02873000
$FLAG9   EQU   $COMMFLG+8                                               02874000
$FLAG10  EQU   $COMMFLG+9                                               02875000
$FLAG11  EQU   $COMMFLG+10                                              02876000
$FLAG12  EQU   $COMMFLG+11                                              02877000
$OPTMSG  EQU   $FLAG12                                                  02878000
$FLAG13  EQU   $COMMFLG+12                                              02879000
$LGON    EQU   $FLAG13                                                  02880000
$CATMSG  EQU   $FLAG13                                                  02881000
$DEVTBLE EQU   TOLTEPWA+240                                             02882000
$DEVCDS  EQU   $DEVTBLE                                                 02883000
$DEVUNAD EQU   $DEVCDS                                                  02884000
@NM00039 EQU   $DEVUNAD+2                                               02885000
$DEVFEAT EQU   $DEVCDS+4                                                02886000
$DEVCDSF EQU   $DEVCDS+9                                                02887000
$DEVFPM  EQU   $DEVCDSF                                                 02888000
$DEVSDCF EQU   $DEVCDS+10                                               02889000
$$SYMNME EQU   $DEVCDS+12                                               02890000
$DEVFLG1 EQU   $DEVTBLE+20                                              02891000
$EVNCPLT EQU   $DEVFLG1                                                 02892000
$ATTNEXP EQU   $DEVFLG1                                                 02893000
$INTOCC  EQU   $DEVFLG1                                                 02894000
$DEVFLG2 EQU   $DEVTBLE+21                                              02895000
$DEVTECB EQU   $DEVTBLE+22                                              02896000
$OPIS    EQU   $DEVTECB                                                 02897000
$OPND    EQU   $DEVTECB+2                                               02898000
$DEVFLG3 EQU   $DEVTBLE+27                                              02899000
$NOTDEV  EQU   $DEVFLG3                                                 02900000
$SIOFLG  EQU   $DEVFLG3                                                 02901000
$SYSMN   EQU   $DEVTBLE+28                                              02902000
$IFTOUT  EQU   $DEVTBLE+36                                              02903000
$DEVSESP EQU   $IFTOUT                                                  02904000
$SSCPDAF EQU   $IFTOUT+6                                                02905000
$LDNCBPT EQU   $DEVTBLE+48                                              02906000
$RNINFO  EQU   $DEVTBLE+56                                              02907000
$DEVFLG5 EQU   $RNINFO+8                                                02908000
$DEVFLG4 EQU   $DEVTBLE+65                                              02909000
$DEVCNTS EQU   TOLTEPWA+1464                                            02910000
$SLTBL   EQU   TOLTEPWA+1468                                            02911000
$RUNTEST EQU   $SLTBL+13                                                02912000
$TESTFLG EQU   $SLTBL+21                                                02913000
$SECLST  EQU   $SLTBL+22                                                02914000
$TLTRPL2 EQU   TOLTEPWA+1736                                            02915000
$INBUFR  EQU   TOLTEPWA+2104                                            02916000
$WORK    EQU   TOLTEPWA+2376                                            02917000
#EXITA   EQU   TOLTEPWA+2632                                            02918000
$CCOMDAT EQU   TOLTEPWA+2644                                            02919000
$CFLGS   EQU   $CCOMDAT+16                                              02920000
$24FEMSG EQU   TOLTEPWA+2681                                            02921000
$24CATMG EQU   $24FEMSG+11                                              02922000
$APNAME  EQU   TOLTEPWA+2704                                            02923000
$DTORESP EQU   TOLTEPWA+2712                                            02924000
@NM00048 EQU   TOLTEPWA+2776                                            02925000
$OUNTPTR EQU   @NM00048+4                                               02926000
$NSPTR   EQU   $OUNTPTR                                                 02927000
$NSCNT   EQU   @NM00048+10                                              02928000
$ENXX    EQU   @NM00048+15                                              02929000
$IMITX   EQU   $ENXX                                                    02930000
SVESC033 EQU   TOLTEPWA+3160                                            02931000
SVECC013 EQU   TOLTEPWA+3232                                            02932000
SVEIC002 EQU   TOLTEPWA+3520                                            02933000
SVEIC003 EQU   TOLTEPWA+3592                                            02934000
SVESC022 EQU   TOLTEPWA+3736                                            02935000
SVECC011 EQU   TOLTEPWA+4024                                            02936000
#EXIT    EQU   0                                                        02937000
CDSMAP   EQU   0                                                        02938000
CDSMFCT  EQU   CDSMAP+4                                                 02939000
CDSFEAT  EQU   CDSMFCT+1                                                02940000
CDSFLAG  EQU   CDSMAP+9                                                 02941000
ISTTIE   EQU   0                                                        02942000
TIETIEA  EQU   ISTTIE+4                                                 02943000
TIESNA   EQU   ISTTIE+8                                                 02944000
TIERPHA  EQU   ISTTIE+12                                                02945000
AQCTNAME EQU   0                                                        02946000
DEVCHAR  EQU   0                                                        02947000
BACKSAVE EQU   0                                                        02948000
$TRTBL   EQU   0                                                        02949000
SVEIC00A EQU   SVEIC003                                                 02950000
DTCOUNT  EQU   $DTORESP                                                 02951000
MSG247   EQU   $INBUFR                                                  02952000
ACQRESP  EQU   $WORK                                                    02953000
ACQSYMN  EQU   ACQRESP                                                  02954000
ACQCHAR  EQU   ACQRESP+4                                                02955000
DEVDATA  EQU   ACQRESP+8                                                02956000
XBUFR    EQU   $WORK                                                    02957000
CTPTRS   EQU   XBUFR+104                                                02958000
FLAG5    EQU   CTPTRS+8                                                 02959000
@NM00055 EQU   $DTORESP+16                                              02960000
$CTMSGNM EQU   @NM00055                                                 02961000
TEMPCDS  EQU   @NM00055+8                                               02962000
CDSUAD   EQU   TEMPCDS                                                  02963000
TEMPFLGS EQU   TEMPCDS+9                                                02964000
CTNAME   EQU   TEMPCDS+12                                               02965000
CTPARM   EQU   @NM00055+28                                              02966000
CTPARMA  EQU   CTPARM                                                   02967000
CTPARMB  EQU   CTPARM+4                                                 02968000
T463X    EQU   $INBUFR                                                  02969000
T463A    EQU   T463X                                                    02970000
T463C    EQU   T463X+3                                                  02971000
T463Y    EQU   $INBUFR                                                  02972000
T463B    EQU   T463Y+1                                                  02973000
INCOUNT  EQU   $INBUFR                                                  02974000
SVECC012 EQU   SVESC022                                                 02975000
SVEIC004 EQU   SVEIC003                                                 02976000
SVEIC005 EQU   SVEIC003                                                 02977000
SVESC02A EQU   SVESC022                                                 02978000
SVESC02B EQU   SVESC022                                                 02979000
SVESC02D EQU   SVESC022                                                 02980000
SVESC02E EQU   SVESC022                                                 02981000
SVESC02F EQU   SVECC013                                                 02982000
SVESC024 EQU   SVESC022                                                 02983000
SVESC027 EQU   SVESC022                                                 02984000
SVESC029 EQU   SVESC033                                                 02985000
SVESC031 EQU   SVECC013                                                 02986000
SVESC032 EQU   SVECC011                                                 02987000
SVETC037 EQU   SVEIC003                                                 02988000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02989000
T463YA   EQU   T463Y                                                    02990000
TEMPB    EQU   TEMPCDS+10                                               02991000
TEMPA    EQU   TEMPCDS+4                                                02992000
@NM00054 EQU   CTPTRS                                                   02993000
@NM00053 EQU   XBUFR+72                                                 02994000
CTCID    EQU   XBUFR+64                                                 02995000
XBD      EQU   XBUFR                                                    02996000
TESTDV   EQU   MSG247                                                   02997000
TIEPTR2  EQU   TIERPHA                                                  02998000
TIEPTR1  EQU   TIESNA                                                   02999000
TIEGATE  EQU   TIETIEA                                                  03000000
TIEREQ   EQU   ISTTIE+3                                                 03001000
TIERETCD EQU   ISTTIE+2                                                 03002000
TIELNGTH EQU   ISTTIE+1                                                 03003000
TIETYPE  EQU   ISTTIE                                                   03004000
CDSEXARA EQU   CDSMAP+20                                                03005000
CDSSYMBN EQU   CDSMAP+12                                                03006000
CDSEXTM  EQU   CDSFLAG+2                                                03007000
CDSEXTB  EQU   CDSFLAG+2                                                03008000
CDSTMERB EQU   CDSFLAG+2                                                03009000
@NM00052 EQU   CDSFLAG+1                                                03010000
CDSDVPRO EQU   CDSFLAG+1                                                03011000
CDSNTPRI EQU   CDSFLAG+1                                                03012000
CDSLINCN EQU   CDSFLAG                                                  03013000
CDSREMSY EQU   CDSFLAG                                                  03014000
CDS2CHAN EQU   CDSFLAG                                                  03015000
CDSSYMB  EQU   CDSFLAG                                                  03016000
CDSEXTPR EQU   CDSFLAG                                                  03017000
CDSFEVOL EQU   CDSFLAG                                                  03018000
CDSSHAR  EQU   CDSFLAG                                                  03019000
CDSFPMD  EQU   CDSFLAG                                                  03020000
CDSBYTCT EQU   CDSMAP+8                                                 03021000
CDSTYPE  EQU   CDSMFCT+3                                                03022000
CDSCLASS EQU   CDSMFCT+2                                                03023000
@NM00051 EQU   CDSFEAT                                                  03024000
CDSDEVM  EQU   CDSFEAT                                                  03025000
CDSDEVT  EQU   CDSFEAT                                                  03026000
CDSASCII EQU   CDSFEAT                                                  03027000
CDSMODEL EQU   CDSMFCT                                                  03028000
CDSUA    EQU   CDSMAP                                                   03029000
SVECC010 EQU   TOLTEPWA+3952                                            03030000
SVETC035 EQU   TOLTEPWA+3880                                            03031000
SVESC030 EQU   TOLTEPWA+3808                                            03032000
SVESC020 EQU   TOLTEPWA+3664                                            03033000
SVECC014 EQU   TOLTEPWA+3376                                            03034000
SVESC120 EQU   TOLTEPWA+3304                                            03035000
SVESC025 EQU   TOLTEPWA+3088                                            03036000
@NM00050 EQU   TOLTEPWA+2980                                            03037000
$RPLERR  EQU   TOLTEPWA+2977                                            03038000
@NM00049 EQU   TOLTEPWA+2976                                            03039000
$R13PR3  EQU   TOLTEPWA+2972                                            03040000
$CEINT2  EQU   TOLTEPWA+2968                                            03041000
$CEINT1  EQU   TOLTEPWA+2964                                            03042000
$MSGGET  EQU   TOLTEPWA+2960                                            03043000
$ACQLIST EQU   TOLTEPWA+2956                                            03044000
$R4SAVE1 EQU   TOLTEPWA+2952                                            03045000
$CLSISS  EQU   TOLTEPWA+2950                                            03046000
$CLSCNT  EQU   TOLTEPWA+2948                                            03047000
$CUTABLE EQU   TOLTEPWA+2868                                            03048000
$BUFSZ2  EQU   TOLTEPWA+2864                                            03049000
$RESID2  EQU   TOLTEPWA+2860                                            03050000
$OLTCCW2 EQU   TOLTEPWA+2856                                            03051000
$ENDBFR2 EQU   TOLTEPWA+2852                                            03052000
$1STBFR2 EQU   TOLTEPWA+2848                                            03053000
$TECB2   EQU   TOLTEPWA+2844                                            03054000
$BUFSZ1  EQU   TOLTEPWA+2840                                            03055000
$RESID1  EQU   TOLTEPWA+2836                                            03056000
$OLTCCW1 EQU   TOLTEPWA+2832                                            03057000
$ENDBFR1 EQU   TOLTEPWA+2828                                            03058000
$1STBFR1 EQU   TOLTEPWA+2824                                            03059000
$TECB1   EQU   TOLTEPWA+2820                                            03060000
$WAITIME EQU   TOLTEPWA+2816                                            03061000
$TRTN#   EQU   TOLTEPWA+2815                                            03062000
$WIODEV  EQU   TOLTEPWA+2814                                            03063000
$RQSTSZE EQU   TOLTEPWA+2812                                            03064000
$RQSTPTR EQU   TOLTEPWA+2808                                            03065000
$R4SAVE  EQU   TOLTEPWA+2804                                            03066000
$PARTADR EQU   TOLTEPWA+2800                                            03067000
$TBSDATA EQU   TOLTEPWA+2796                                            03068000
$CTWIDTH EQU   TOLTEPWA+2795                                            03069000
$CTLINE  EQU   TOLTEPWA+2794                                            03070000
$APWIDTH EQU   TOLTEPWA+2793                                            03071000
$APLINE  EQU   TOLTEPWA+2792                                            03072000
$INDEX   EQU   $IMITX                                                   03073000
$UMXX    EQU   @NM00048+14                                              03074000
$NSXX    EQU   @NM00048+12                                              03075000
$ATACNT  EQU   $NSCNT                                                   03076000
$CTR     EQU   @NM00048+8                                               03077000
$ATAPTR  EQU   $NSPTR                                                   03078000
$DDRPTR  EQU   @NM00048                                                 03079000
$24SYMNE EQU   $24CATMG+4                                               03080000
$24DEVAD EQU   $24CATMG                                                 03081000
$24RTN#  EQU   $24FEMSG+8                                               03082000
$ESECTID EQU   $24FEMSG                                                 03083000
$24FLGS  EQU   TOLTEPWA+2680                                            03084000
$24SAVE2 EQU   TOLTEPWA+2676                                            03085000
$24SAVE1 EQU   TOLTEPWA+2672                                            03086000
$24UNADR EQU   TOLTEPWA+2668                                            03087000
$24SAV13 EQU   TOLTEPWA+2664                                            03088000
$24RETCD EQU   TOLTEPWA+2663                                            03089000
$MACID   EQU   TOLTEPWA+2661                                            03090000
$CSPARE  EQU   $CFLGS                                                   03091000
$C2WAY   EQU   $CFLGS                                                   03092000
$CINCT   EQU   $CCOMDAT+12                                              03093000
$CINADR  EQU   $CCOMDAT+8                                               03094000
$COUTCT  EQU   $CCOMDAT+4                                               03095000
$COUTAD  EQU   $CCOMDAT                                                 03096000
ROOTLOC  EQU   TOLTEPWA+2640                                            03097000
$RETREG  EQU   TOLTEPWA+2636                                            03098000
$EXTA    EQU   TOLTEPWA+2320                                            03099000
$PASSONA EQU   TOLTEPWA+2264                                            03100000
$TRMINPT EQU   TOLTEPWA+2184                                            03101000
$BUFFER  EQU   TOLTEPWA+1976                                            03102000
$TLTRPL3 EQU   TOLTEPWA+1856                                            03103000
$TLTRPL1 EQU   TOLTEPWA+1616                                            03104000
@NM00047 EQU   $SLTBL+135                                               03105000
$HIGHRTN EQU   $SLTBL+134                                               03106000
$PRIMADR EQU   $SLTBL+130                                               03107000
$CTSTPT  EQU   $SLTBL+128                                               03108000
$TSTCNT  EQU   $SLTBL+126                                               03109000
$SECFLGS EQU   $SECLST+3                                                03110000
$SECTION EQU   $SECLST                                                  03111000
$SECACT  EQU   $TESTFLG                                                 03112000
$CANTRUN EQU   $TESTFLG                                                 03113000
$FINAL   EQU   $TESTFLG                                                 03114000
$TESTSUF EQU   $RUNTEST+5                                               03115000
$TESTNUM EQU   $RUNTEST+1                                               03116000
$LETPRF  EQU   $RUNTEST                                                 03117000
$SYMBOLC EQU   $SLTBL+5                                                 03118000
$FAMILY  EQU   $SLTBL                                                   03119000
$CDEVPT  EQU   TOLTEPWA+1466                                            03120000
$FEEDBCK EQU   $DEVTBLE+66                                              03121000
$WTISUED EQU   $DEVFLG4                                                 03122000
$EXIOISD EQU   $DEVFLG4                                                 03123000
$REMWRIT EQU   $DEVFLG4                                                 03124000
$REMDONE EQU   $DEVFLG4                                                 03125000
$2NDUSED EQU   $DEVFLG4                                                 03126000
$1STUSED EQU   $DEVFLG4                                                 03127000
$IGLXIFB EQU   $DEVFLG4                                                 03128000
$EXIOLV3 EQU   $DEVFLG4                                                 03129000
@NM00046 EQU   $DEVFLG5                                                 03130000
$ASCII   EQU   $DEVFLG5                                                 03131000
$DEVLU   EQU   $DEVFLG5                                                 03132000
$OPNDFAL EQU   $DEVFLG5                                                 03133000
$ACQNCB  EQU   $DEVFLG5                                                 03134000
$REMOTE  EQU   $DEVFLG5                                                 03135000
$ENDNODE EQU   $DEVFLG5                                                 03136000
$LINENME EQU   $RNINFO                                                  03137000
$CID     EQU   $DEVTBLE+52                                              03138000
$DVCOL   EQU   $LDNCBPT+2                                               03139000
$DVROW   EQU   $LDNCBPT                                                 03140000
$NCSPLP  EQU   $DEVTBLE+44                                              03141000
$DVLN    EQU   $SSCPDAF                                                 03142000
$DAF     EQU   $DEVSESP+4                                               03143000
$VARYPAB EQU   $DEVSESP                                                 03144000
@NM00045 EQU   $DEVFLG3                                                 03145000
$CLRSNT  EQU   $DEVFLG3                                                 03146000
$OLTERR  EQU   $DEVFLG3                                                 03147000
$SRTEST  EQU   $DEVFLG3                                                 03148000
$DVSNDOK EQU   $SIOFLG                                                  03149000
$POLLREQ EQU   $DEVFLG3                                                 03150000
$ACQRED  EQU   $DEVFLG3                                                 03151000
$DVINCT  EQU   $DEVTBLE+26                                              03152000
$DVBRKST EQU   $OPND+1                                                  03153000
$DVBRKSN EQU   $OPND                                                    03154000
$DVSEQNO EQU   $OPIS                                                    03155000
$CEINTRP EQU   $DEVFLG2                                                 03156000
$TESTMDE EQU   $DEVFLG2                                                 03157000
$DEVALOC EQU   $DEVFLG2                                                 03158000
$ALLDATA EQU   $DEVFLG2                                                 03159000
$ENDCNTL EQU   $DEVFLG2                                                 03160000
$CTLDEV  EQU   $DEVFLG2                                                 03161000
$NOCDS   EQU   $DEVFLG2                                                 03162000
$DATAIN  EQU   $DEVFLG2                                                 03163000
$PRIMARY EQU   $DEVFLG1                                                 03164000
$DVCTBYT EQU   $INTOCC                                                  03165000
$DEVACT  EQU   $DEVFLG1                                                 03166000
$DVLGMDE EQU   $ATTNEXP                                                 03167000
$DVSPRM  EQU   $EVNCPLT                                                 03168000
$GRABBED EQU   $DEVFLG1                                                 03169000
$CATASTR EQU   $DEVFLG1                                                 03170000
$LETGO   EQU   $DEVFLG1                                                 03171000
$CURELEM EQU   $$SYMNME+4                                               03172000
$MSGOTSD EQU   $$SYMNME                                                 03173000
$EXTDEV  EQU   $DEVCDS+11                                               03174000
@NM00044 EQU   $DEVSDCF                                                 03175000
$NOTPRIM EQU   $DEVSDCF                                                 03176000
@NM00043 EQU   $DEVCDSF                                                 03177000
@NM00042 EQU   $DEVCDSF                                                 03178000
@NM00041 EQU   $DEVCDSF                                                 03179000
$CDSNAME EQU   $DEVCDSF                                                 03180000
$EXTRN   EQU   $DEVCDSF                                                 03181000
$CEVOLUM EQU   $DEVCDSF                                                 03182000
$SHARD   EQU   $DEVCDSF                                                 03183000
$DEVCNT  EQU   $DEVCDS+8                                                03184000
$DEVTYPE EQU   $DEVFEAT+3                                               03185000
$DEVCLAS EQU   $DEVFEAT+2                                               03186000
$DEVFRRS EQU   $DEVFEAT+1                                               03187000
$DEVMOD  EQU   $DEVFEAT                                                 03188000
$DEVRDGT EQU   @NM00039+1                                               03189000
$DEVCTLU EQU   @NM00039+1                                               03190000
$DEVCHAN EQU   @NM00039                                                 03191000
@NM00040 EQU   @NM00039                                                 03192000
$CTINDX  EQU   $DEVUNAD                                                 03193000
$FLAG16  EQU   $COMMFLG+15                                              03194000
$FLAG15  EQU   $COMMFLG+14                                              03195000
$FLAG14  EQU   $COMMFLG+13                                              03196000
$TEP2ND  EQU   $FLAG13                                                  03197000
$TEP1ST  EQU   $FLAG13                                                  03198000
$PRMPTSW EQU   $FLAG13                                                  03199000
$DEVENT  EQU   $FLAG13                                                  03200000
$OLTMACC EQU   $FLAG13                                                  03201000
$CTLOGON EQU   $FLAG13                                                  03202000
@NM00038 EQU   $FLAG12                                                  03203000
$VARYINP EQU   $FLAG12                                                  03204000
$ENDTEST EQU   $FLAG12                                                  03205000
$VRYHRD  EQU   $FLAG12                                                  03206000
$VRYSFT  EQU   $FLAG12                                                  03207000
$POSTFLG EQU   $FLAG12                                                  03208000
$FEORCAT EQU   $FLAG11                                                  03209000
@NM00037 EQU   $FLAG11                                                  03210000
@NM00036 EQU   $FLAG10                                                  03211000
$INBND   EQU   $FLAG10                                                  03212000
$WAITFLG EQU   $FLAG10                                                  03213000
$DPRINT  EQU   $FLAG10                                                  03214000
$HOLD    EQU   $FLAG9                                                   03215000
$NOTRRCH EQU   $FLAG9                                                   03216000
@NM00035 EQU   $FLAG9                                                   03217000
$COPY    EQU   $FLAG9                                                   03218000
$LSTLNSW EQU   $FLAG9                                                   03219000
$MULLNSW EQU   $FLAG9                                                   03220000
$REMSW   EQU   $FLAG9                                                   03221000
$IGRES   EQU   $FLAG9                                                   03222000
$VS2     EQU   $FLAG8                                                   03223000
$VS1     EQU   $FLAG8                                                   03224000
$EDOS    EQU   $FLAG8                                                   03225000
@NM00034 EQU   $FLAG8                                                   03226000
$TWOWAY  EQU   $FLAG8                                                   03227000
@NM00033 EQU   $FLAG8                                                   03228000
$RCVMSG  EQU   $FLAG7                                                   03229000
$RCVRFLG EQU   $FLAG7                                                   03230000
$SNDRFLG EQU   $FLAG7                                                   03231000
$LDOIS   EQU   $FLAG7                                                   03232000
$DCONTCT EQU   $FLAG7                                                   03233000
$EXIOWAT EQU   $FLAG7                                                   03234000
$2NDDATA EQU   $FLAG7                                                   03235000
$1STDATA EQU   $FLAG7                                                   03236000
$ABTERM  EQU   $ABNDBIT                                                 03237000
$FSTMCIS EQU   $FLAG6                                                   03238000
$DISCREQ EQU   $FLAG6                                                   03239000
$DISCISS EQU   $FLAG6                                                   03240000
$CHANGE  EQU   $FLAG6                                                   03241000
$CTERROR EQU   $FLAG6                                                   03242000
$RECAL11 EQU   $FLAG6                                                   03243000
@NM00032 EQU   $FLAG5                                                   03244000
$PROGCK  EQU   $CANCEL                                                  03245000
$PRINTAP EQU   $FLAG5                                                   03246000
@NM00031 EQU   $FLAG5                                                   03247000
$MSG922  EQU   $FLAG5                                                   03248000
$CT924   EQU   $FLAG5                                                   03249000
$FSTCAT  EQU   $FLAG5                                                   03250000
$FSTFE   EQU   $FLAG5                                                   03251000
$ACTOPND EQU   $FLAG4                                                   03252000
$ACQCUTT EQU   $FLAG4                                                   03253000
$CLSSACT EQU   $FLAG4                                                   03254000
$BACKINT EQU   $FLAG4                                                   03255000
$DMSGSW  EQU   $FLAG4                                                   03256000
$PRTONLY EQU   $FLAG3                                                   03257000
$REQSTOR EQU   $FLAG3                                                   03258000
$LOGOFFE EQU   $FLAG3                                                   03259000
$PARTIAL EQU   $FLAG2                                                   03260000
$NRMTERM EQU   $FLAG2                                                   03261000
$DBLSLSH EQU   $FLAG2                                                   03262000
$NDR     EQU   $FLAG2                                                   03263000
@NM00030 EQU   $FLAG2                                                   03264000
@NM00029 EQU   $FLAG1                                                   03265000
$CNSLFG  EQU   $FLAG1                                                   03266000
$TEP3RD  EQU   $FLAG1                                                   03267000
@NM00028 EQU   $CDA+120                                                 03268000
$CUCNT   EQU   $CDA+118                                                 03269000
@NM00027 EQU   $CDA+117                                                 03270000
$PRTFORM EQU   $CDA+116                                                 03271000
$GETMSZE EQU   $CDA+110                                                 03272000
$GRCNTS  EQU   $CDA+108                                                 03273000
$CTLCNT  EQU   $CDA+106                                                 03274000
$ACTLVL  EQU   $CDA+105                                                 03275000
$PRNTLVL EQU   $CDA+104                                                 03276000
$ERRCNTA EQU   $CDA+102                                                 03277000
$TLCNT   EQU   $CDA+100                                                 03278000
$TIMEALW EQU   $CDA+96                                                  03279000
$PTRAREA EQU   $CDA+92                                                  03280000
$GETMPTR EQU   $CDA+88                                                  03281000
$R13PTRT EQU   $CDA+84                                                  03282000
$R13PTR  EQU   $CDA+80                                                  03283000
$TEPEND  EQU   $CDA+76                                                  03284000
$PLINKDL EQU   $CDA+72                                                  03285000
$TEPBEGN EQU   $CDA+68                                                  03286000
$FRELPTR EQU   $CDA+64                                                  03287000
$HIGHADR EQU   $HIMOREC                                                 03288000
$LOMOREC EQU   $CDA+56                                                  03289000
$LOWADDR EQU   $OLTPTR                                                  03290000
$ENDCOMM EQU   $CDA+48                                                  03291000
$COMMON  EQU   $RCA                                                     03292000
$PASSON  EQU   $CDA+28                                                  03293000
$TOLBRTB EQU   $CDA+24                                                  03294000
$SCTPTR8 EQU   $CDA+20                                                  03295000
$SCTPTR  EQU   $CDA+16                                                  03296000
$TBWDPTR EQU   $CDA+12                                                  03297000
$TFWDPTR EQU   $CDA+8                                                   03298000
@NM00026 EQU   $CDA                                                     03299000
@NM00025 EQU   $SCTTBLE+98                                              03300000
$SCTLWTC EQU   $SCTTBLE+96                                              03301000
$SCTLWTA EQU   $SCTTBLE+92                                              03302000
#EXT     EQU   $SCTTBLE+88                                              03303000
#PASS    EQU   $SCTTBLE+84                                              03304000
#TABLE   EQU   $SCTTBLE+80                                              03305000
#MSGIDAC EQU   $SCTTBLE+78                                              03306000
@NM00024 EQU   $SCTTBLE+71                                              03307000
$RETMASK EQU   $SCTTBLE+70                                              03308000
$R249255 EQU   $ROUTMSK+29                                              03309000
$R241248 EQU   $ROUTMSK+28                                              03310000
$R233240 EQU   $ROUTMSK+27                                              03311000
$R225232 EQU   $ROUTMSK+26                                              03312000
$R217224 EQU   $ROUTMSK+25                                              03313000
$R209216 EQU   $ROUTMSK+24                                              03314000
$R201208 EQU   $ROUTMSK+23                                              03315000
$R193200 EQU   $ROUTMSK+22                                              03316000
$R185192 EQU   $ROUTMSK+21                                              03317000
$R177184 EQU   $ROUTMSK+20                                              03318000
$R169176 EQU   $ROUTMSK+19                                              03319000
$R161168 EQU   $ROUTMSK+18                                              03320000
$R153160 EQU   $ROUTMSK+17                                              03321000
$R145152 EQU   $ROUTMSK+16                                              03322000
$R137144 EQU   $ROUTMSK+15                                              03323000
$R129136 EQU   $ROUTMSK+14                                              03324000
$R121128 EQU   $ROUTMSK+13                                              03325000
$R113120 EQU   $ROUTMSK+12                                              03326000
$R105112 EQU   $ROUTMSK+11                                              03327000
$R097104 EQU   $ROUTMSK+10                                              03328000
$R089096 EQU   $ROUTMSK+9                                               03329000
$R081088 EQU   $ROUTMSK+8                                               03330000
$R073080 EQU   $ROUTMSK+7                                               03331000
$R065072 EQU   $ROUTMSK+6                                               03332000
$R057064 EQU   $ROUTMSK+5                                               03333000
$R049056 EQU   $ROUTMSK+4                                               03334000
$R041048 EQU   $ROUTMSK+3                                               03335000
$R033040 EQU   $ROUTMSK+2                                               03336000
$R025032 EQU   $ROUTMSK+1                                               03337000
$R017024 EQU   $ROUTMSK                                                 03338000
$TOTFLG2 EQU   $SCTTBLE+39                                              03339000
@NM00023 EQU   $TOTFLG1                                                 03340000
@NM00022 EQU   $TOTFLG1                                                 03341000
@NM00021 EQU   $TOTFLG1                                                 03342000
$CURELOD EQU   $TOTFLG1                                                 03343000
$CTEQTT  EQU   $TOTFLG1                                                 03344000
@NM00020 EQU   $TOTFLG1                                                 03345000
@NM00019 EQU   $TOTFLG1                                                 03346000
$LINESHR EQU   $TOTFLG1                                                 03347000
@NM00018 EQU   $OLTFLG2                                                 03348000
@NM00017 EQU   $OLTFLG2                                                 03349000
@NM00016 EQU   $OLTFLG2                                                 03350000
@NM00015 EQU   $OLTFLG2                                                 03351000
@NM00014 EQU   $OLTFLG2                                                 03352000
@NM00013 EQU   $OLTFLG2                                                 03353000
@NM00012 EQU   $OLTFLG2                                                 03354000
@NM00011 EQU   $OLTFLGS                                                 03355000
$TRACE   EQU   $OLTFLGS                                                 03356000
$RETCODE EQU   $OLTFLGS                                                 03357000
$CONTCB  EQU   $OLTFLGS                                                 03358000
$RETAIN  EQU   $OLTFLGS                                                 03359000
$CLEANRT EQU   $OLTFLGS                                                 03360000
$MANINTV EQU   $OLTFLGS                                                 03361000
$OLTSIZE EQU   $SCTTBLE+34                                              03362000
$QSCTMOD EQU   $EXECFLG                                                 03363000
$CTRLMOD EQU   $EXECFLG                                                 03364000
$CLEANUP EQU   $EXECFLG                                                 03365000
$LSTPDEV EQU   $EXECFLG                                                 03366000
$ERRCNT  EQU   $EXECFLG                                                 03367000
$RTNSLCT EQU   $EXECFLG                                                 03368000
$MULTDEV EQU   $EXECFLG                                                 03369000
@NM00010 EQU   $EXECFLG                                                 03370000
$RMSKCNT EQU   $SCTTBLE+32                                              03371000
$SYNAME  EQU   $CDS8T19+4                                               03372000
$EXTSIG  EQU   $CDS8T19+3                                               03373000
$CDFLGS  EQU   $CDS8T19+1                                               03374000
$CDSCNT  EQU   $CDS8T19                                                 03375000
$PDEVDSC EQU   $SCTTBLE+16                                              03376000
$PDEVADR EQU   $SCTTBLE+12                                              03377000
$COMMCN  EQU   $CDSFLGS                                                 03378000
$CUSTSYM EQU   $CDSFLGS                                                 03379000
$TWOCHSW EQU   $CDSFLGS                                                 03380000
$SYMNAME EQU   $CDSFLGS                                                 03381000
$EXTINTC EQU   $CDSFLGS                                                 03382000
$CEVOL   EQU   $CDSFLGS                                                 03383000
$SHARED  EQU   $CDSFLGS                                                 03384000
$FPM     EQU   $CDSFLGS                                                 03385000
$LASTSUB EQU   $PDEVFLG                                                 03386000
@NM00009 EQU   $PDEVFLG                                                 03387000
@NM00008 EQU   $PDEVFLG                                                 03388000
@NM00007 EQU   $PDEVFLG                                                 03389000
$LASTDEV EQU   $PDEVFLG                                                 03390000
@NM00006 EQU   $PDEVFLG                                                 03391000
$EXFILPT EQU   $PDEVFLG                                                 03392000
$FPMOLD  EQU   $PDEVFLG                                                 03393000
$TSSSYM  EQU   $SCTTBLE+8                                               03394000
$SCTLEVL EQU   $SCTTBLE+7                                               03395000
$RT0916  EQU   $SCTTBLE+5                                               03396000
$RT0108  EQU   $SCTTBLE+4                                               03397000
$LOOPTST EQU   $ERROPT                                                  03398000
$LOOPERR EQU   $ERROPT                                                  03399000
$NERRPRT EQU   $ERROPT                                                  03400000
$NOCNTRL EQU   $ERROPT                                                  03401000
$ALTPRNT EQU   $ERROPT                                                  03402000
$ASTERIK EQU   $ERROPT                                                  03403000
$TESTERR EQU   $ERROPT                                                  03404000
$FSTCOMM EQU   $TESTOPT                                                 03405000
$INDEFLP EQU   $TESTOPT                                                 03406000
$NOPRT   EQU   $TESTOPT                                                 03407000
$PARAPRT EQU   $TESTOPT                                                 03408000
@NM00005 EQU   $TESTOPT                                                 03409000
$ERRLPCT EQU   $SCTTBLE                                                 03410000
$TLTEND  EQU   $RCAAREA+936                                             03411000
$EXITSAV EQU   $RCAAREA+864                                             03412000
$TRASCII EQU   $RCAAREA+608                                             03413000
@NM00004 EQU   $RCAAREA+605                                             03414000
$VTAMEND EQU   $RCAFLG                                                  03415000
$TPPOSTD EQU   $RCAFLG                                                  03416000
$NEWCT   EQU   $RCAFLG                                                  03417000
$ABNDALL EQU   $RCAFLG                                                  03418000
$CUTESTB EQU   $RCAFLG                                                  03419000
$CONSOLE EQU   $RCAFLG                                                  03420000
$TPLOGON EQU   $RCAFLG                                                  03421000
$DEVAREA EQU   $RCAAREA+600                                             03422000
$CTDVAR  EQU   $RCAAREA+596                                             03423000
$BUFFS   EQU   $RCAAREA+464                                             03424000
$TLTNIB  EQU   $CONSTNT+140                                             03425000
$TLTPRPL EQU   $CONSTNT+20                                              03426000
@NM00003 EQU   $CONSTNT+4                                               03427000
@NM00002 EQU   $CONSTNT+2                                               03428000
$CURRTWA EQU   $POINTER+140                                             03429000
$CTARGX  EQU   $POINTER+128                                             03430000
$COMINT  EQU   $POINTER+120                                             03431000
$QUEHNDL EQU   $POINTER+116                                             03432000
@NM00001 EQU   $POINTER+36                                              03433000
$RTNPTR  EQU   $POINTER+32                                              03434000
$TLTECB2 EQU   $POINTER+28                                              03435000
$TLTECB1 EQU   $POINTER+24                                              03436000
$CLEANP  EQU   $POINTER+20                                              03437000
$ABEND   EQU   $POINTER+16                                              03438000
$LSTAREA EQU   $POINTER+12                                              03439000
$FSTAREA EQU   $POINTER+8                                               03440000
$CVTSAVE EQU   $POINTER+4                                               03441000
$TOLTEP  EQU   $POINTER                                                 03442000
$TLTACB  EQU   $RCAAREA                                                 03443000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03444000
@RT00104 EQU   I02C0092                                                 03445000
@RT00158 EQU   I02C0090                                                 03446000
@RF00172 EQU   I02C0120                                                 03447000
@RT00199 EQU   I02C0110                                                 03448000
@RT00202 EQU   I02C0120                                                 03449000
@RT00214 EQU   I02C0100                                                 03450000
@RF00288 EQU   I02C0120                                                 03451000
@RF00309 EQU   I02C0120                                                 03452000
@RT00320 EQU   I02C0150                                                 03453000
@RT00323 EQU   I02C0150                                                 03454000
@RT00337 EQU   I02C0150                                                 03455000
@RT00346 EQU   I02C0010                                                 03456000
@RT00357 EQU   I02C0140                                                 03457000
@RT00366 EQU   I02C0010                                                 03458000
@RT00379 EQU   I02C0010                                                 03459000
@RT00419 EQU   I02C0230                                                 03460000
@RT00465 EQU   I02C0180                                                 03461000
@RT00513 EQU   I02C0220                                                 03462000
@RT00521 EQU   I02C0220                                                 03463000
@RT00584 EQU   I02C0007                                                 03464000
@ENDDATA EQU   *                                                        03465000
         END   ISTIC002,(C'PLS0905',0701,76244)                         03466000
