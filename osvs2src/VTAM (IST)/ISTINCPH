         TITLE 'ISTINCPH - PARAMETER HANDLER ROUTINE                   *00001000
                        '                                               00002000
*REGS(0,1,2,3,4,15)LINKREGS(5,6,7,12)INCLUDES(ISTPHROA)*/          0001 00003000
ISTINCPH CSECT ,                                                   0001 00004000
@MAINENT DS    0H                                                  0001 00005000
         USING *,@15                                               0001 00006000
         B     @PROLOG                                             0001 00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'ISTINCPH  78.009'                                 0001 00009000
         DROP  @15                                                      00010000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00011000
         BALR  @11,0                                               0001 00012000
@PSTART  DS    0H                                                  0001 00013000
         USING @PSTART,@11                                         0001 00014000
*    DO;                                                           0002 00015000
*/* ATBUILD (ISTPHROA)  */                                         0003 00016000
*/*       VTAM  PARAMETER HANDLER (ISTINCPH) OUTPUT AREA              * 00017000
*/*  INITIAL LEVEL                                     001 08/02/74  */ 00018000
*DECLARE 1 ISTPHROA BASED BDY(WORD),                               0003 00019000
*         2 PHROALEN FIXED(31),        /* TOTAL LENGTH OF PHR OUTPUT    00020000
*                                         AREA                        * 00021000
*         2 PHROADTA CHAR(*) BDY(WORD); /* PHR OUTPUT AREA DATA       * 00022000
*                                                                  0003 00023000
*DECLARE 1 PHRFN1OA DEFINED(PHROADTA),   /* FUNCTION 1 OUTPUT      0004 00024000
*                                          AREA                       * 00025000
*         2 PHRF1SAD PTR(31),            /* POINTER TO SUB-PARAMETER  * 00026000
*         2 PHRF1SLN FIXED(31);          /* LENGTH OF SUB-PARAMETER   * 00027000
*                                                                  0004 00028000
*DECLARE 1 PHRFN2OA DEFINED(PHROADTA),   /* FUNCTION 2 OUTPUT AREA    * 00029000
*         2 PHRF2NVL FIXED(31),          /* NUMBER OF OUTPUT VALUES   * 00030000
*         2 PHRF2VAL(*) FIXED(31),       /* ARRAY OF OUTPUT VALUES    * 00031000
*          3 PHRF2OFS FIXED(15),         /* OFFSET INTO SIFT AREA     * 00032000
*          3 PHRF2FLG BIT(8),            /* FLAG BYTE                 * 00033000
*           4 PHRF2GP BIT(1),            /* USE MLCPTR0 AS BASE       * 00034000
*           4 PHRF2LN BIT(1),            /* USE MLCPTR1 AS BASE       * 00035000
*           4 PHRF2CL BIT(1),            /* USE MLCPTR2 AS BASE       * 00036000
*           4 PHRF2TR BIT(1),            /* USE MLCPTR3 AS BASE       * 00037000
*           4 *       BIT(1),            /* RESERVED                  * 00038000
*           4 PHRF2ON BIT(1),            /* SET ON UNDER PHRF2MSK     * 00039000
*           4 PHRF2OFF BIT(1),           /* SET OFF UNDER PHRF2MSK    * 00040000
*           4 PHRF2MV BIT(1),            /* MOVE PHRF2MSK TO AREA     * 00041000
*          3 PHRF2MSK BIT(8);            /* BIT PATTERN TO PROCESS    * 00042000
*                                                                  0005 00043000
*DECLARE 1 PHRF34OA DEFINED(PHROADTA),   /* FUNCTIONS 3+4 OUTPUT AREA * 00044000
*         2 PHRF34NS FIXED(31),          /* NUMBER OF SUB-PARAMETERS  * 00045000
*         2 PHRF34EN(*),                 /* OUTPUT AREA ARRAY ENTRY   * 00046000
*          3 PHRF34VF BIT(8),            /* VALIDITY FLAGS            * 00047000
*          3 * BIT(8),                   /* RESERVED                  * 00048000
*          3 PHRF34SL FIXED(15),         /* LENGTH OF SUBPARAMETER    * 00049000
*          3 PHRF34SP CHAR(8);           /* SUBPARAMETER STRING       * 00050000
*                                                                  0006 00051000
*DECLARE 1 PHRFN5OA DEFINED(PHROADTA),   /* FUNCTION 5 OUTPUT AREA    * 00052000
*         2 PHRF5NSP FIXED(31),          /* NUMBER OF SUB-PARAMETERS  * 00053000
*         2 PHRF5ENT(*),                 /* OUTPUT AREA ARRAY ENTRY   * 00054000
*          3 PHRF5VF BIT(8),             /* VALIDITY FLAGS            * 00055000
*          3 * BIT(8),                   /* RESERVED                  * 00056000
*          3 PHRF5SL FIXED(15),          /* LENGTH OF SUB-PARAMETER   * 00057000
*          3 PHRF5SPT PTR(31);           /* POINTER TO SUB-PARAMETER  * 00058000
*                                                                  0007 00059000
*DECLARE 1 PHRFN7OA DEFINED(PHROADTA),   /* FUNCTION 7 OUTPUT AREA    * 00060000
*         2 PHRF7NSP FIXED(31),          /* NUMBER OF SUB-PARAMETERS  * 00061000
*         2 PHRF7NUM(*) BIN(8);         /* ARRAY OF ONE-BYTE VALUES  */ 00062000
*                                                                  0008 00063000
*DECLARE 1 PHRFN8OA DEFINED(PHROADTA),   /* FUNCTION 8 OUTPUT AREA    * 00064000
*          2 PHRF8NSP FIXED(31),         /* NUMBER OF SUB PARAMETERS  * 00065000
*          2 PHRF8ENT(*),                /* OUTPUT AREA ARRAY ENTRY   * 00066000
*            3 PHRF8FLG BIT(8),          /* FLAG BYTE                 * 00067000
*              4 PHRF8DFT BIT(1),        /* SUB-PARM DEFAULTED        * 00068000
*              4 *        BIT(7),        /* RESERVED                  * 00069000
*            3 PHRF8NUM BIN(8);          /* ONE-BYTE VALUE            * 00070000
*                                                                  0009 00071000
*/*       VALIDITY ERROR FLAGS SET BY FUNCTIONS IN OUTPUT AREA        * 00072000
*DECLARE PHRVFAOK BIT(8) CONSTANT('00'X);/* NO ERRORS IN SUB-PARAMETER* 00073000
*DECLARE PHRVFNA1 BIT(8) CONSTANT('10'X);/* FIRST CHAR. NOT ALPHABETIC* 00074000
*DECLARE PHRVFNAN BIT(8) CONSTANT('20'X);/* ALL CHARS. NOT ALPHANUM   * 00075000
*DECLARE PHRVFNNN BIT(8) CONSTANT('40'X);/* ALL CHARS. NOT NUMERIC    * 00076000
*/* END OF ATBUILD */                                              0014 00077000
*   DCL GPR05F FIXED(31) REG(05);                                  0014 00078000
*   DCL GPR05P PTR(31)   REG(05);                                  0015 00079000
*   DCL GPR06F FIXED(31) REG(06);                                  0016 00080000
*   DCL GPR06P PTR(31)   REG(06);                                  0017 00081000
*   DCL GPR07F FIXED(31) REG(07);                                  0018 00082000
*   DCL GPR07P PTR(31)   REG(07);                                  0019 00083000
*   DCL GPR12F FIXED(31) REG(12);                                  0020 00084000
*   DCL GPR12P PTR(31)   REG(12);                                  0021 00085000
*   DCL GPR14F FIXED(31) REG(14);                                  0022 00086000
*   DCL GPR14P PTR(31)   REG(14);                                  0023 00087000
*   DCL GPR00F FIXED(31) REG(00);                                  0024 00088000
*   DCL GPR00P PTR(31)   REG(00);                                  0025 00089000
*   DCL GPR01F FIXED(31) REG(01);                                  0026 00090000
*   DCL GPR01P PTR(31)   REG(01);                                  0027 00091000
*   DCL GPR02F FIXED(31) REG(02);                                  0028 00092000
*   DCL GPR02P PTR(31)   REG(02);                                  0029 00093000
*   DCL GPR03F FIXED(31) REG(03);                                  0030 00094000
*   DCL GPR03P PTR(31)   REG(03);                                  0031 00095000
*   DCL GPR04F FIXED(31) REG(04);                                  0032 00096000
*   DCL GPR04P PTR(31)   REG(04);                                  0033 00097000
*   DCL GPR15F FIXED(31) REG(15);                                  0034 00098000
*   DCL GPR15P PTR(31)   REG(15);                                  0035 00099000
*   RFY (GPR00P,GPR01P,GPR02P,GPR03P,GPR04P,GPR05P,GPR06P,GPR07P,GPR12P 00100000
*GPR14P,GPR15P) RSTD;                                              0036 00101000
*                                                                  0036 00102000
*   END ;                                                          0037 00103000
*/*A-000000-999999                                           @DL29HBN*/ 00104000
*   RFY                                                            0038 00105000
*     ISTPHROA BASED(GPR02P);                                      0038 00106000
*                                                                  0039 00107000
*/*      KEYWORD TABLE INPUT FORMAT                                  */ 00108000
*                                                                  0039 00109000
*                                                                  0039 00110000
*   DCL                                                            0039 00111000
*     1 CPHKWDTB BDY(BYTE)BASED(CPHTABAD),                         0039 00112000
*     (2 CPHENTNO,                  /* NUMBER OF ENTRIES             */ 00113000
*      2 CPHENTLN)                  /* LENGTH OF 1 ENTRY             */ 00114000
*            FIXED(15)BDY(BYTE),                                   0039 00115000
*      2 CPHTABEN(*),               /* TABLE ENTRY FORMAT            */ 00116000
*       3 CPHKEYWD CHAR(8),         /* KEYWORD NAME                  */ 00117000
*       3 CPHFUNBT CHAR(5);         /* FUNCTION BYTE/VALUE           */ 00118000
*   DCL                                                            0040 00119000
*     1 CPHSUBVL CHAR(5)BDY(BYTE),  /* SUB-TABLE VALUE               */ 00120000
*      2 CPHVALBT BIT(8),           /* VALIDITY FLAGS & FUNCT. NO    */ 00121000
*       3 * BIT(1),                 /* RESERVED                      */ 00122000
*       3 CPHFUNNU BIT(1),          /* CHECK NUMERIC CHAR            */ 00123000
*       3 CPHFUNAN BIT(1),          /* CHECK ALPHANUM CHS            */ 00124000
*       3 CPHFUNFC BIT(1),          /* CHECK ALPHA 1ST CH            */ 00125000
*       3 CPHFUNNO BIT(4),          /* FUNCTION NUMBER               */ 00126000
*      2 CPHVALUE PTR(31)BDY(BYTE); /* VALUE                         */ 00127000
*                                                                  0040 00128000
*   DCL CPHF2VAL (*) BIT(32) DEFINED(PHRF2VAL);  /*TO ALLOW MVC  */     00129000
*   DCL CPHSBVL1 BIT(32) DEFINED(CPHSUBVL);  /*ALSO TO ALLOW MVC*/ 0042 00130000
*                                                                  0042 00131000
*/*      FUNCTION NUMBER VALUES                                      */ 00132000
*                                                                  0043 00133000
*   DCL                                                            0043 00134000
*    (CPHFUN01 CONSTANT('0001'B),   /* FUNCTION NO. 1                */ 00135000
*     CPHFUN02 CONSTANT('0010'B),   /* FUNCTION NO. 2                */ 00136000
*     CPHFUN03 CONSTANT('0011'B),   /* FUNCTION NO. 3                */ 00137000
*     CPHFUN04 CONSTANT('0100'B),   /* FUNCTION NO. 4                */ 00138000
*     CPHFUN05 CONSTANT('0101'B),   /* FUNCTION NO. 5                */ 00139000
*     CPHFUN06 CONSTANT('0110'B),   /* FUNCTION NO. 6                */ 00140000
*     CPHFUN07 CONSTANT('0111'B),   /* FUNCTION NO. 7                */ 00141000
*     CPHFUN08 CONSTANT('1000'B))  /*FUNCTION 8              @D32CKKA*/ 00142000
*         BIT(4);                                                  0043 00143000
*                                                                  0043 00144000
*/*         TRANSLATE-AND-TEST TABLE USED TO SCAN FOR DELIMITERS     */ 00145000
*                                                                  0044 00146000
*   DCL                                                            0044 00147000
*     CPHTRTB STATIC LOCAL CHAR(256)GENERATED;             /*@DM39361*/ 00148000
*   GEN DATA DEFS(CPHTRTB);                                        0045 00149000
*                                                                  0045 00150000
*/*         TRT TABLE FOR VALIDITY CHECK SUBROUTINE                  */ 00151000
*                                                                  0046 00152000
*   DCL                                                            0046 00153000
*     CPHVTRTB STATIC LOCAL CHAR(256)GENERATED;            /*@DM39361*/ 00154000
*   GEN DATA DEFS(CPHVTRTB);                                       0047 00155000
*                                                                  0047 00156000
*/*      TRANSITION MATRIX FOR CONTEXT SUB-PROCESSORS                */ 00157000
*                                                                  0048 00158000
*   DCL                                                            0048 00159000
*     CPHSCNTB(7,7)PTR(31) STATIC LOCAL /*TABLE STORAGE      @DM39361*/ 00160000
*         INIT                      /* SEE DESCRIPTION OF TABLE IN 0048 00161000
*                                      CHARTS                        */ 00162000
*         (ADDR(CPHCSP13),ADDR(CPHCSP01),ADDR(CPHCSP01),ADDR(CPHCSP01), 00163000
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP01),ADDR(CPHCSP02),  00164000
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),  00165000
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP10),ADDR(CPHCSP10),  00166000
*         ADDR(CPHCSP04),ADDR(CPHCSP04),ADDR(CPHCSP05),ADDR(CPHCSP13),  00167000
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP06),ADDR(CPHCSP06),  00168000
*         ADDR(CPHCSP06),ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),  00169000
*         ADDR(CPHCSP07),ADDR(CPHCSP12),ADDR(CPHCSP07),ADDR(CPHCSP12),  00170000
*         ADDR(CPHCSP08),ADDR(CPHCSP08),ADDR(CPHCSP12),ADDR(CPHCSP12),  00171000
*         ADDR(CPHCSP09),ADDR(CPHCSP09),ADDR(CPHCSP09),ADDR(CPHCSP12),  00172000
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP10),ADDR(CPHCSP10),  00173000
*         ADDR(CPHCSP10),ADDR(CPHCSP12),ADDR(CPHCSP14),ADDR(CPHCSP10),  00174000
*         ADDR(CPHCSP13));                                         0048 00175000
*                                                                  0048 00176000
*/*   SUB-PARAMTER POINTER BLOCK FOR FUNCTION 2                      */ 00177000
*                                                                  0049 00178000
*   DCL                                                            0049 00179000
*     1 CPHPNTBK BASED(CPHVALUE)BDY(BYTE),                         0049 00180000
*      2 CPHSBVAL FIXED(31)BDY(BYTE),/* KWD RTN. ADDRESS             */ 00181000
*      2 CPHSBTAB PTR(31)BDY(BYTE); /* SUBPARM TBL                   */ 00182000
*                                                                  0049 00183000
*/*      INLINE DATA AREA AND LOCK                           @DM39361*/ 00184000
*   DCL                                                            0050 00185000
*     CPHLOCK BIT(8) INIT(0) STATIC LOCAL;                 /*@DM39361*/ 00186000
*   DCL                                                            0051 00187000
*     STATICFD BDY(WORD) CHAR(116) STATIC LOCAL;           /*@ZA27161*/ 00188000
*                                                                  0051 00189000
*                                                                  0051 00190000
*/*      SUB-PROCESSOR ENTRY POINT LOCATOR                           */ 00191000
*                                                                  0052 00192000
*   DCL                                                            0052 00193000
*     CPHSCNPT PTR(31);                                            0052 00194000
*                                                                  0052 00195000
*/*     LOCAL POINTERS USED FOR WORKING STORAGE                      */ 00196000
*                                                                  0053 00197000
*                                                                  0053 00198000
*   DCL                                                            0053 00199000
*    (CPHOANDX,                     /* OUTPUT AREA ENTRY INDEX       */ 00200000
*     CPHOALIM)FIXED(31);           /* MAX NO. OF OUTPUT AREA ENT    */ 00201000
*   DCL CPHINSVA PTR(31);           /* SVA FOR INPUT SVADDR  @DM39361*/ 00202000
*   DCL CPHSCN00 PTR(31);           /* CPHSUBSC R00 SVA      @ZA27161*/ 00203000
*   DCL CPHSCN02 PTR(31);           /* CPHSUBSC R02 SVA      @ZA27161*/ 00204000
*   DCL CPHVCK01 PTR(31);           /* CPHVALCK R01 SVA      @ZA27161*/ 00205000
*   DCL CPHVCK02 PTR(31);           /* CPHVALCK R02 SVA      @ZA27161*/ 00206000
*   DCL                                                            0059 00207000
*    (CPHTCHAR,                     /* TRT CODE FOR LAST CHAR.       */ 00208000
*     CPHLCHAR)FIXED(8);            /* TRT CODE FOR PREVIOUS CHAR    */ 00209000
*   DCL                                                            0060 00210000
*    (CPHSPLEN,                     /* SUB-PARAMETER LENGTH          */ 00211000
*     CPHKWLEN,                     /* KEYWORD LENGTH                */ 00212000
*     CPHPARCT,                     /* PARENTHESES COUNT             */ 00213000
*     CPHSBPAR,                     /* SUBPARM START PARENS. COUNT   */ 00214000
*     CPHENCTR)FIXED(15);           /* TABLE SEARCH ENTRY COUNT      */ 00215000
*   DCL                                                            0061 00216000
*     CPHSBYTE CHAR(*)BASED;        /* (A) BYTE(S) IN SCANNED STR    */ 00217000
*   DCL                                                            0062 00218000
*     CPHARGUM CHAR(8);             /* SEARCH ARGUMENT (CPHTBLSC)    */ 00219000
*   DCL                                                            0063 00220000
*     CPHDECHX CHAR(3);             /*HOLD AREA FOR CPHSUB07 @DM39361*/ 00221000
*   DCL                                                            0064 00222000
*     1 CPHVALFG BIT(8),            /* VALIDITY ERROR FLAGS          */ 00223000
*      2 * BIT(1),                  /* RESERVED                      */ 00224000
*      2 CPHVALNU BIT(1),           /* CHARACTERS NOT NUMERIC        */ 00225000
*      2 CPHVALAN BIT(1),           /* CHARS. NOT ALPHANUMERIC       */ 00226000
*      2 CPHVALFC BIT(1),           /* 1ST CHAR. NOT ALPHANUMERIC    */ 00227000
*      2 * BIT(4);                  /* RESERVED                      */ 00228000
*   DCL                                                            0065 00229000
*    (CPHTABAD,                     /* POINTER TO KWD TABLE ENTRY    */ 00230000
*     CPHTABSV)PTR(31);             /* POINTER TO KWD TABLE START    */ 00231000
*   DCL                                                            0066 00232000
*    (CPHKWPTR,                     /* POINTER TO START OF KEYWD     */ 00233000
*     CPHTRTSV,                     /* POINTER TO START OF    SUBPARM*/ 00234000
*     CPHVALPS,                     /* VALCHK SAVE AREA FOR PTR      */ 00235000
*     CPHSPPTR)PTR(31);             /* SUB-PARAMETER POINTER         */ 00236000
*   DCL                                                            0067 00237000
*     1 CPHFLAGS BIT(8),            /* ** PHR LOGIC CONTROL FLAGS*   */ 00238000
*      2 * BIT(1),                  /* RESERVED                      */ 00239000
*      2 CPHCONT BIT(1),            /* TRT CONTINUE FLAG             */ 00240000
*      2 CPHKWSCN BIT(1),           /* SCANNING STRING FOR KWD       */ 00241000
*      2 CPHENDST BIT(1),           /* END OF STRING WAS HIT         */ 00242000
*      2 CPHENDSP BIT(1),           /* END OF SUB-PARM WAS HIT       */ 00243000
*      2 CPHLSTSP BIT(1),           /* LAST SUB-PARAMETER WAS HIT    */ 00244000
*      2 CPHSLIST BIT(1),           /* SUB PARM LIST ENCOUNTERED     */ 00245000
*      2 CPHSYNER BIT(1);           /* SYNTAX ERROR HAS OCCURRED     */ 00246000
*   DCL                                                            0068 00247000
*     1 CPHFLAG2 BIT(8),            /* ADDITIONAL CONTROL FLAGS      */ 00248000
*      2 CPHOFLOW BIT(1),           /* OUTPUT AREA OVERFLOW          */ 00249000
*      2 CPHFUNER BIT(1),           /* FUNCTION ERROR                */ 00250000
*      2 CPHARGNF BIT(1),           /* ARGUMENT NOT FOUND-TBL SCH    */ 00251000
*      2 * BIT(5);                  /* RESERVED                      */ 00252000
*   DCL GPR13P PTR(31) REG(13) RSTD; /*                      @ZA27161*/ 00253000
*                                                                  0070 00254000
*/*         EXECUTABLE CODE SECTION                                  */ 00255000
*         GPR03P=GPR13P;                 /*SAVE CALLER'S SVA @DM30219*/ 00256000
         LR    GPR03P,GPR13P                                       0070 00257000
*         GPR13P=ADDR(STATICFD);         /*USE INLINE SVA    @DM39361*/ 00258000
         LA    GPR13P,STATICFD                                     0071 00259000
*         GEN REFS(CPHLOCK)(TS CPHLOCK); /*INLINE DATA AREA IN     0072 00260000
*                                          USE ?             @DM39361*/ 00261000
         TS CPHLOCK                                                     00262000
*         BC(8,USEINLIN);                /* NO-USE INLINE AREA     0073 00263000
*                                                            @DM39361*/ 00264000
         BC    8,USEINLIN                                          0073 00265000
*GEN SETS(GPR00P,GPR01P,GPR04P,GPR15F,GPR05P,GPR06P,GPR07P)        0074 00266000
*    REFS(GPR03P);                                         /*@VS45824*/ 00267000
          LM   4,7,36(3)                                                00268000
          L    0,@SIZDATD                                               00269000
          LA   1,48(3)                                                  00270000
          ST   1,40(3)                                                  00271000
          LA   1,36(3)                                                  00272000
          GETMAIN EC,LV=(0),SP=0,MF=(E,(1))                             00273000
*        IF GPR15F=0                                               0075 00274000
*              THEN DO;                                    /*@DM39361*/ 00275000
         LTR   GPR15F,GPR15F                                       0075 00276000
         BNZ   @RF00075                                            0075 00277000
*        GEN SETS(GPR13P,GPR00P,GPR01P)                            0077 00278000
*            REFS(GPR04P,GPR05P,GPR06P,GPR07P,GPR03P);     /*@VS45113*/ 00279000
          LM   0,1,20(3)                                                00280000
          L   13,48(3)                                                  00281000
          STM 4,7,36(3)                                                 00282000
          USING @DATD,13                                                00283000
*USEINLIN:                                                         0078 00284000
*CPHINSVA=GPR03P;                   /* SAVE INPUT SAVE AREA  @DM39361*/ 00285000
*                                                                  0078 00286000
USEINLIN ST    GPR03P,CPHINSVA                                     0078 00287000
*CPHPARCT=0;         /*INIT. PARENS. COUNT (CPHPARCT) TO 0        */    00288000
         SLR   @10,@10                                             0079 00289000
         STH   @10,CPHPARCT                                        0079 00290000
*/*   R0=TABLE ADDR R1=KEYWORD ADDR R2=OUTPUT AREA ADDR              */ 00291000
*CPHFLAGS='00'X;            /*  RESET CPHFLAGS*/                   0080 00292000
         MVI   CPHFLAGS,X'00'                                      0080 00293000
*CPHFLAG2='00'X;                                                   0081 00294000
         MVI   CPHFLAG2,X'00'                                      0081 00295000
*CPHKWSCN='1'B;             /*   SET CPHKWSCN = 1*/                0082 00296000
         OI    CPHKWSCN,B'00100000'                                0082 00297000
*CPHLCHAR='06'X;            /*   CPHLCHAR = X'06' (START OF KWD)*/ 0083 00298000
         MVI   CPHLCHAR,X'06'                                      0083 00299000
* /*ICALL(CPHSUBSC)*/                                              0084 00300000
*  DO;                                                             0084 00301000
* CALL CPHSUBSC;                                                   0085 00302000
*                                                                  0085 00303000
         BAL   @14,CPHSUBSC                                        0085 00304000
* END ;           /*   GO TO LOCATE KEYWORD */                     0086 00305000
*                   /* KWD ADD IN CPHKWPTR, KWD LENGTH IN CPHKWLEN   */ 00306000
*IF CPHSYNER='1'B            /*SYNTAX ERR */                       0087 00307000
*   THEN                        /*YES */                           0087 00308000
         TM    CPHSYNER,B'00000001'                                0087 00309000
         BNO   @RF00087                                            0087 00310000
*     GPR01P=GPR01P+1;           /*UPDATE REG1*/                   0088 00311000
         AL    GPR01P,@CF00048                                     0088 00312000
*   ELSE DO;                     /*NOT SYNTAX ERR */               0089 00313000
         B     @RC00087                                            0089 00314000
@RF00087 DS    0H                                                  0090 00315000
*     IF CPHENDST='1'B       /*END OF STRING*/                     0090 00316000
*        THEN;               /*YES END OF STRING*/                 0090 00317000
         TM    CPHENDST,B'00010000'                                0090 00318000
         BO    @RT00090                                            0090 00319000
*        ELSE DO;            /*NOT END OF STRING*/                 0092 00320000
*         IF CPHKWLEN>8           /*KWD LONGER THAN 8*/            0093 00321000
*          THEN                  /*YES */                          0093 00322000
         LH    @10,CPHKWLEN                                        0093 00323000
         C     @10,@CF00046                                        0093 00324000
         BNH   @RF00093                                            0093 00325000
*             CPHARGNF='1'B;         /*  SET ARGUMENT NOT FOUND*/  0094 00326000
         OI    CPHARGNF,B'00100000'                                0094 00327000
*          ELSE DO;                  /*NOT LONGER THAN 8*/         0095 00328000
         B     @RC00093                                            0095 00329000
@RF00093 DS    0H                                                  0096 00330000
*             CPHARGUM=' ';         /*CLEAR SEARCH ARG*/           0096 00331000
         MVI   CPHARGUM+1,C' '                                     0096 00332000
         MVC   CPHARGUM+2(6),CPHARGUM+1                            0096 00333000
         MVI   CPHARGUM,C' '                                       0096 00334000
*                               /* MOVE KWD TO CPHARGUM (SEARCH ARG)*/  00335000
*             CPHARGUM(1:CPHKWLEN)=CPHKWPTR->CPHSBYTE(1:CPHKWLEN); 0097 00336000
         LH    @10,CPHKWLEN                                        0097 00337000
         BCTR  @10,0                                               0097 00338000
         L     @09,CPHKWPTR                                        0097 00339000
         EX    @10,@SM00427                                        0097 00340000
*             CPHTABAD=GPR00P;  /*GET ADDR OF KWD TABLE*/          0098 00341000
         ST    GPR00P,CPHTABAD                                     0098 00342000
*              /*ICALL(CPHTBLSC)*/                                 0099 00343000
*               DO;                                                0099 00344000
*              CALL CPHTBLSC;                                      0100 00345000
*                                                                  0100 00346000
         BAL   @14,CPHTBLSC                                        0100 00347000
*              END ;  /* SEARCH KWD TABLE FOR KWD */               0101 00348000
*             IF CPHARGNF='0'B    /*WAS ARG FOUND*/                0102 00349000
*                THEN DO;         /*YES */                         0102 00350000
         TM    CPHARGNF,B'00100000'                                0102 00351000
         BNZ   @RF00102                                            0102 00352000
*                                 /* WAS IT  FUNCT. 0 WITH PARMS*/ 0104 00353000
*                  IF CPHFUNNO='0000'B&CPHTCHAR='01'X              0104 00354000
*                     THEN       /*YES*/                           0104 00355000
         TM    CPHFUNNO,B'00001111'                                0104 00356000
         BNZ   @RF00104                                            0104 00357000
         CLI   CPHTCHAR,1                                          0104 00358000
         BNE   @RF00104                                            0104 00359000
*                        CPHFUNER='1'B;    /* SET FUNCTION ERROR FLAG*/ 00360000
         OI    CPHFUNER,B'01000000'                                0105 00361000
*                     ELSE DO;       /*NOT FUNC 0 WITH PARMS*/     0106 00362000
         B     @RC00104                                            0106 00363000
@RF00104 DS    0H                                                  0107 00364000
*                             /* NOT FUNCT. 0 AND POSITIONAL KEYWD   */ 00365000
*                        IF CPHFUNNO^='0000'B&CPHTCHAR^='01'X      0107 00366000
*                           THEN      /*YES*/                      0107 00367000
         TM    CPHFUNNO,B'00001111'                                0107 00368000
         BZ    @RF00107                                            0107 00369000
         CLI   CPHTCHAR,1                                          0107 00370000
         BE    @RF00107                                            0107 00371000
*                             CPHSYNER='1'B; /* SET SYNTAX ERROR */     00372000
         OI    CPHSYNER,B'00000001'                                0108 00373000
*                           ELSE DO;/*NOT SYNTAX ERROR*/           0109 00374000
         B     @RC00107                                            0109 00375000
@RF00107 DS    0H                                                  0110 00376000
*                            GPR00F=CPHVALUE; /*GET ENT VALUE*/    0110 00377000
         ICM   GPR00F,15,CPHVALUE                                  0110 00378000
*                            IF CPHFUNNO=CPHFUN01 /*FUNCT 1*/      0111 00379000
*                               THEN   /*YES FUNC 1*/              0111 00380000
         TM    CPHFUNNO,B'00000001'                                0111 00381000
         BNO   @RF00111                                            0111 00382000
         TM    CPHFUNNO,B'00001110'                                0111 00383000
         BNZ   @RF00111                                            0111 00384000
*                                  /*ICALL(CPHSUB01)*/             0112 00385000
*                                   DO;                            0112 00386000
*                                  CALL CPHSUB01;                  0113 00387000
*                                                                  0113 00388000
         BAL   @14,CPHSUB01                                        0113 00389000
*                                  END ;/*CALL FUNCT 1 RTN*/       0114 00390000
*                               ELSE DO;   /*NOT FUNCT 1*/         0115 00391000
         B     @RC00111                                            0115 00392000
@RF00111 DS    0H                                                  0116 00393000
*                                 IF CPHFUNNO=CPHFUN02 /*FUNCT 2*/ 0116 00394000
*                                  THEN  /*YES FUNC2*/             0116 00395000
         TM    CPHFUNNO,B'00000010'                                0116 00396000
         BNO   @RF00116                                            0116 00397000
         TM    CPHFUNNO,B'00001101'                                0116 00398000
         BNZ   @RF00116                                            0116 00399000
*                                    /*ICALL(CPHSUB02)*/           0117 00400000
*                                     DO;                          0117 00401000
*                                    CALL CPHSUB02;                0118 00402000
*                                                                  0118 00403000
         BAL   @14,CPHSUB02                                        0118 00404000
*                                    END ;/*CALL FUNCT2 */         0119 00405000
*                                  ELSE DO;  /*NOT FUNCT 2*/       0120 00406000
         B     @RC00116                                            0120 00407000
@RF00116 DS    0H                                                  0121 00408000
*                                    IF CPHFUNNO=CPHFUN03 | /*FUNCT 3*/ 00409000
*                                       CPHFUNNO=CPHFUN04   /*OR 4*/    00410000
*                                     THEN     /*YES 3 OR 4*/      0121 00411000
         TM    CPHFUNNO,B'00000011'                                0121 00412000
         BNO   @GL00003                                            0121 00413000
         TM    CPHFUNNO,B'00001100'                                0121 00414000
         BZ    @RT00121                                            0121 00415000
@GL00003 TM    CPHFUNNO,B'00000100'                                0121 00416000
         BNO   @RF00121                                            0121 00417000
         TM    CPHFUNNO,B'00001011'                                0121 00418000
         BNZ   @RF00121                                            0121 00419000
@RT00121 DS    0H                                                  0122 00420000
*                                            /*CALL FUNCT 3/4 RTN*/     00421000
*                                         /*ICALL(CPHSUB34)*/      0122 00422000
*                                          DO;                     0122 00423000
*                                         CALL CPHSUB34;           0123 00424000
*                                                                  0123 00425000
         BAL   @14,CPHSUB34                                        0123 00426000
*                                         END ;                    0124 00427000
*                                     ELSE DO;  /*NOT 3/4*/        0125 00428000
         B     @RC00121                                            0125 00429000
@RF00121 DS    0H                                                  0126 00430000
*                                        IF CPHFUNNO=CPHFUN05/*FUNC 5*/ 00431000
*                                           THEN  /*YES CALL FUNC 5*/   00432000
         TM    CPHFUNNO,B'00000101'                                0126 00433000
         BNO   @RF00126                                            0126 00434000
         TM    CPHFUNNO,B'00001010'                                0126 00435000
         BNZ   @RF00126                                            0126 00436000
*                                               /*ICALL(CPHSUB05)*/     00437000
*                                                DO;               0127 00438000
*                                               CALL CPHSUB05;     0128 00439000
*                                                                  0128 00440000
         BAL   @14,CPHSUB05                                        0128 00441000
*                                               END ;              0129 00442000
*                                           ELSE DO;/*NOT FUNC5*/  0130 00443000
         B     @RC00126                                            0130 00444000
@RF00126 DS    0H                                                  0131 00445000
*                                           /*IF IT FUNC6*/        0131 00446000
*                                              IF CPHFUNNO=CPHFUN06     00447000
*                                                 THEN /*YES*/     0131 00448000
         TM    CPHFUNNO,B'00000110'                                0131 00449000
         BNO   @RF00131                                            0131 00450000
         TM    CPHFUNNO,B'00001001'                                0131 00451000
         BNZ   @RF00131                                            0131 00452000
*                                         /*CALL FUNCT 6 RTN*/     0132 00453000
*                                                     /*ICALL(CPHSUB06) 00454000
*/                                                                 0132 00455000
*                                                      DO;         0132 00456000
*                                                     CALL CPHSUB06;    00457000
*                                                                  0133 00458000
         BAL   @14,CPHSUB06                                        0133 00459000
*                                                     END ;        0134 00460000
*                                                 ELSE DO; /*NOT 6*/    00461000
         B     @RC00131                                            0135 00462000
@RF00131 DS    0H                                                  0136 00463000
*                                                 /*IS IT FUNC 7 OR 8*/ 00464000
*                                                 IF CPHFUNNO=CPHFUN07  00465000
*                                                 | CPHFUNNO=CPHFUN08   00466000
*                                                          /*@D32CKKA*/ 00467000
*                                                    THEN /*YES*/  0136 00468000
         TM    CPHFUNNO,B'00000111'                                0136 00469000
         BNO   @GL00004                                            0136 00470000
         TM    CPHFUNNO,B'00001000'                                0136 00471000
         BZ    @RT00136                                            0136 00472000
@GL00004 TM    CPHFUNNO,B'00001000'                                0136 00473000
         BNO   @RF00136                                            0136 00474000
         TM    CPHFUNNO,B'00000111'                                0136 00475000
         BNZ   @RF00136                                            0136 00476000
@RT00136 DS    0H                                                  0137 00477000
*                                                /*CALL FUNC 7/8 */     00478000
*                                                      /*ICALL(CPHSUB07 00479000
**/                                                                0137 00480000
*                                                       DO;        0137 00481000
*                                                      CALL CPHSUB07;   00482000
*                                                                  0138 00483000
         BAL   @14,CPHSUB07                                        0138 00484000
*                                                      END ;       0139 00485000
*                                                     ELSE;/*NOT 7,8*/  00486000
@RF00136 DS    0H                                                  0141 00487000
*                                                 END; /*END NOT 6*/    00488000
*                                           END;  /*END NOT FUNC 5*/    00489000
*                                     END;  /*END NOT FUNCT 3/4*/  0143 00490000
*                                 END;      /*END NOT FUNCT2*/     0144 00491000
*                                END;       /*END NOT FUNCT 1*/    0145 00492000
*                            END;          /*END NOT SYNTAX ERROR*/     00493000
*                     END;                 /*END NOT FUNCT ERROR*/ 0147 00494000
*                END;                      /*END ARG FOUND*/       0148 00495000
*                ELSE;                     /*ARG NOT FOUND*/       0149 00496000
@RF00102 DS    0H                                                  0150 00497000
*          END;              /*END NOT LONGER THAN 8*/             0150 00498000
@RC00102 DS    0H                                                  0151 00499000
*        END;                /*END NOT END OF STRING*/             0151 00500000
@RC00093 DS    0H                                                  0152 00501000
*    END;                  /*END NOT SYNTAX ERROR */               0152 00502000
@RT00090 DS    0H                                                  0153 00503000
*   IF CPHARGNF='1'B|CPHFUNER='1'B|CPHOFLOW='1'B /*NON-TERM ERRORS*/    00504000
*     THEN DO;               /*YES NON TERMINATING ERRORS*/        0153 00505000
@RC00087 TM    CPHARGNF,B'11100000'                                0153 00506000
         BZ    @RF00153                                            0153 00507000
*                              /* DO WHILE ERROR AND END NOT HIT     */ 00508000
*       DO WHILE(CPHLSTSP='0'B&CPHSYNER='0'B&CPHENDST='0'B);       0155 00509000
         B     @DE00155                                            0155 00510000
@DL00155 DS    0H                                                  0156 00511000
*          /*ICALL(CPHSUBSC)*/                                     0156 00512000
*           DO;                                                    0156 00513000
*          CALL CPHSUBSC;                                          0157 00514000
*                                                                  0157 00515000
         BAL   @14,CPHSUBSC                                        0157 00516000
*          END ;   /* SCAN OVER PARAMETER LIST            */       0158 00517000
*       END;                  /*END DO WHILE */                    0159 00518000
@DE00155 TM    CPHLSTSP,B'00010101'                                0159 00519000
         BZ    @DL00155                                            0159 00520000
*     END;                    /*END ERRORS CODE*/                  0160 00521000
*     ELSE;                   /*NO NON-TERMINATING ERRORS*/        0161 00522000
@RF00153 DS    0H                                                  0162 00523000
*   IF CPHSYNER='1'B          /*SYNTAX ERROR*/                     0162 00524000
*     THEN                     /*YES */                            0162 00525000
         TM    CPHSYNER,B'00000001'                                0162 00526000
         BNO   @RF00162                                            0162 00527000
*        GPR15F=12;            /*SET RTN CODE */                   0163 00528000
         LA    GPR15F,12                                           0163 00529000
*     ELSE DO;                 /*NOT SYNTAX ERROR*/                0164 00530000
         B     @RC00162                                            0164 00531000
@RF00162 DS    0H                                                  0165 00532000
*       IF CPHARGNF='1'B       /*ARG NOT FOUND ERROR*/             0165 00533000
*          THEN                /*YES */                            0165 00534000
         TM    CPHARGNF,B'00100000'                                0165 00535000
         BNO   @RF00165                                            0165 00536000
*             GPR15F=4;        /*SET RETURN CODE*/                 0166 00537000
         LA    GPR15F,4                                            0166 00538000
*          ELSE DO;            /*NOT ARG NOT FOUND ERROR*/         0167 00539000
         B     @RC00165                                            0167 00540000
@RF00165 DS    0H                                                  0168 00541000
*             IF CPHFUNER='1'B /*FUNCT ERROR*/                     0168 00542000
*                THEN          /*YES*/                             0168 00543000
         TM    CPHFUNER,B'01000000'                                0168 00544000
         BNO   @RF00168                                            0168 00545000
*                   GPR15F=16;  /*SET RETURN CODE*/                0169 00546000
         LA    GPR15F,16                                           0169 00547000
*                ELSE DO;      /*NOT FUNCT ERROR*/                 0170 00548000
         B     @RC00168                                            0170 00549000
@RF00168 DS    0H                                                  0171 00550000
*                   IF CPHOFLOW='1'B /*OVERFLOW*/                  0171 00551000
*                      THEN    /*YES*/                             0171 00552000
         TM    CPHOFLOW,B'10000000'                                0171 00553000
         BNO   @RF00171                                            0171 00554000
*                         GPR15F=20;  /*SET RETURN CODE*/          0172 00555000
         LA    GPR15F,20                                           0172 00556000
*                      ELSE DO;  /*NOT OVER FLOW*/                 0173 00557000
         B     @RC00171                                            0173 00558000
@RF00171 DS    0H                                                  0174 00559000
*                         IF CPHENDST='1'B /*END OF STRING*/       0174 00560000
*                            THEN   /*YES*/                        0174 00561000
         TM    CPHENDST,B'00010000'                                0174 00562000
         BNO   @RF00174                                            0174 00563000
*                               GPR15F=8; /*SET RETURN CODE*/      0175 00564000
         LA    GPR15F,8                                            0175 00565000
*                            ELSE   /*NO ERRORS*/                  0176 00566000
*                               GPR15F=0; /*SET RETURN CODE*/      0176 00567000
         B     @RC00174                                            0176 00568000
@RF00174 SLR   GPR15F,GPR15F                                       0176 00569000
*                      END;   /*END NOT OVERFLOW*/                 0177 00570000
@RC00174 DS    0H                                                  0178 00571000
*                END;    /*END NOT FUNCTION ERROR*/                0178 00572000
@RC00171 DS    0H                                                  0179 00573000
*          END;          /*END NOT ARG NOT FOUND ERROR*/           0179 00574000
@RC00168 DS    0H                                                  0180 00575000
*     END;               /*END NOT SYNTAX ERROR*/                  0180 00576000
@RC00165 DS    0H                                                  0181 00577000
*        GPR03P=CPHINSVA;  /*PICK UP CALLER'S SVA ADDRESS    @DM39361*/ 00578000
@RC00162 L     GPR03P,CPHINSVA                                     0181 00579000
*   GEN REFS(GPR15F,GPR00P,GPR01P,GPR13P)                          0182 00580000
*       (STM  15,1,16(3));  /*STORE OUTPUT REGS FOR CALLER   @DM39361*/ 00581000
         STM  15,1,16(3)                                                00582000
*        IF GPR13P=ADDR(STATICFD)                                  0183 00583000
*          THEN CPHLOCK='00'X; /*RESET INLINE DATA LOCK      @DM39361*/ 00584000
         LA    @10,STATICFD                                        0183 00585000
         CR    GPR13P,@10                                          0183 00586000
         BNE   @RF00183                                            0183 00587000
         MVI   CPHLOCK,X'00'                                       0184 00588000
*          ELSE DO;            /*ELSE RELEASE DYN DATA AREA  @DM39361*/ 00589000
         B     @RC00183                                            0185 00590000
@RF00183 DS    0H                                                  0186 00591000
*        GEN SETS(GPR00P) SETS(GPR13P);                    /*@DM39361*/ 00592000
         L    0,@SIZDATD                                                00593000
         FREEMAIN  R,LV=(0),A=(13)                                      00594000
*          END;                                            /*@DM39361*/ 00595000
*        GPR13P=GPR03P;    /*PUT CALLER'S SVA ADDR IN R13    @DM39361*/ 00596000
@RC00183 LR    GPR13P,GPR03P                                       0188 00597000
* END;                   /*SAVE AREA GOTTEN OK               @DM39361*/ 00598000
* ELSE DO;               /*SAVE AREA NOT OBTAINED            @DM39361*/ 00599000
         B     @RC00075                                            0190 00600000
@RF00075 DS    0H                                                  0191 00601000
*   GPR15F=20;           /* OVERFLOW RETURN CODE             @DM39361*/ 00602000
         LA    GPR15F,20                                           0191 00603000
*   GPR13P=GPR03P;       /*RESTORE CALLER'S SVA ADDR         @DM39361*/ 00604000
         LR    GPR13P,GPR03P                                       0192 00605000
* GEN REFS(GPR15P,GPR13P)                                          0193 00606000
*     (ST 15,16(13));    /*SAVE RETURN CODE FOR CALLER       @DM39361*/ 00607000
         ST 15,16(13)                                                   00608000
* GEN REFS(GPR04P,GPR05P,GPR13P,GPR06P,GPR07P);            /*@VS45113*/ 00609000
         STM 4,7,36(13)                                                 00610000
* END;                   /*SAVE AREA NOT OBTAINED            @DM39361*/ 00611000
*/*CPHSUB01:03A2 E                                 */              0196 00612000
*/*******************************************************************/  00613000
*/*                                                                 */  00614000
*/*   CPHSUB01: FUNCTION 1 ROUTINE                                  */  00615000
*/*                                                                 */  00616000
*/*******************************************************************/  00617000
*   CPHSUB01: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0196 00618000
         B     @PB00002                                            0196 00619000
CPHSUB01 DS    0H                                                  0197 00620000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0197 00621000
*    DO;                                                           0197 00622000
*   CMZX9904 = GPR14P;                                             0198 00623000
*                                                                  0198 00624000
         LR    CMZX9904,GPR14P                                     0198 00625000
*   END ;                                                          0199 00626000
*      /*   R1=PARM STRING POINTER R2=OUTPUT AREA ADDRESS       */ 0200 00627000
*    /*ICALL(CPHSUBSC)*/                                           0200 00628000
*     DO;                                                          0200 00629000
*    CALL CPHSUBSC;                                                0201 00630000
*                                                                  0201 00631000
         BAL   @14,CPHSUBSC                                        0201 00632000
*    END ;     /*LOCATE NEXT SUBPARAMETER*/                        0202 00633000
*          /* CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*/   0203 00634000
*   IF CPHSYNER='1'B      /*SYNTAX ERROR */                        0203 00635000
*      THEN;              /*YES */                                 0203 00636000
         TM    CPHSYNER,B'00000001'                                0203 00637000
         BO    @RT00203                                            0203 00638000
*      ELSE DO;           /*NOT SYNTAX ERROR*/                     0205 00639000
*         PHRF1SAD=CPHSPPTR;/*SUBPARM PTR IN OUTPUT AREA*/         0206 00640000
         L     @10,CPHSPPTR                                        0206 00641000
         ST    @10,PHRF1SAD(,GPR02P)                               0206 00642000
*         PHRF1SLN=CPHSPLEN;/*SUBPARM LENGTH IN OUTPUT AREA*/      0207 00643000
         LH    @09,CPHSPLEN                                        0207 00644000
         ST    @09,PHRF1SLN(,GPR02P)                               0207 00645000
*         IF EVAL(CPHSPPTR-1)->CPHSBYTE(1)='(' /*LAST CHAR '('*/   0208 00646000
*            THEN DO;          /*YES LEFT PAREN*/                  0208 00647000
         LR    @09,@10                                             0208 00648000
         BCTR  @09,0                                               0208 00649000
         CLI   CPHSBYTE(@09),C'('                                  0208 00650000
         BNE   @RF00208                                            0208 00651000
*                /* GET ADDRESS OF LAST CHAR (CPHSPPTR MINUS 1)*/  0210 00652000
*               EVAL(CPHSPPTR-1)->CPHSBYTE(1)=' ';/*SET TO BLANK*/ 0210 00653000
         BCTR  @10,0                                               0210 00654000
         MVI   CPHSBYTE(@10),C' '                                  0210 00655000
*            END;            /*END LEFT PAREN CODE*/               0211 00656000
*            ELSE;           /*NOT LEFT PAREN*/                    0212 00657000
@RF00208 DS    0H                                                  0213 00658000
*FUN1LOOP:                                                         0213 00659000
*         DO WHILE(CPHSYNER='0'B&CPHLSTSP='0'B);/*LOOK FOR ','*/   0213 00660000
FUN1LOOP B     @DE00213                                            0213 00661000
@DL00213 DS    0H                                                  0214 00662000
*            IF GPR01P->CPHSBYTE(1) = ','   /* COMMA FOUND? */     0214 00663000
*               THEN   /* YES */                                   0214 00664000
         CLI   CPHSBYTE(GPR01P),C','                               0214 00665000
         BNE   @RF00214                                            0214 00666000
*                  PHRF1SLN = PHRF1SLN + 1;  /*ACCOUNT FOR COMMA */     00667000
         LA    @10,1                                               0215 00668000
         AL    @10,PHRF1SLN(,GPR02P)                               0215 00669000
         ST    @10,PHRF1SLN(,GPR02P)                               0215 00670000
*               ELSE;           /* NO STRING COUNT UPDATE */       0216 00671000
@RF00214 DS    0H                                                  0217 00672000
*             /*ICALL(CPHSUBSC)*/                                  0217 00673000
*              DO;                                                 0217 00674000
*             CALL CPHSUBSC;                                       0218 00675000
*                                                                  0218 00676000
         BAL   @14,CPHSUBSC                                        0218 00677000
*             END ;    /* LOCATE NEXT SUBPARAMETER*/               0219 00678000
*            PHRF1SLN=PHRF1SLN+CPHSPLEN; /*ADD SUBPARM LENGTH*/    0220 00679000
         LH    @10,CPHSPLEN                                        0220 00680000
         AL    @10,PHRF1SLN(,GPR02P)                               0220 00681000
         ST    @10,PHRF1SLN(,GPR02P)                               0220 00682000
*            CPHSPLEN = 0; /* ZAP COUNT TO AVOID DOUBLE UPDATES */ 0221 00683000
         SLR   @10,@10                                             0221 00684000
         STH   @10,CPHSPLEN                                        0221 00685000
*         END FUN1LOOP;                                            0222 00686000
@DE00213 TM    CPHSYNER,B'00000101'                                0222 00687000
         BZ    @DL00213                                            0222 00688000
*         IF CPHSYNER='1'B /*SYNTAX ERROR*/                        0223 00689000
*            THEN;         /*YES*/                                 0223 00690000
         TM    CPHSYNER,B'00000001'                                0223 00691000
         BO    @RT00223                                            0223 00692000
*            ELSE DO;      /*NOT SYNTAX ERROR*/                    0225 00693000
*                       /* CHECK LAST BYTE OF PARM LIST SCANNED */ 0226 00694000
*              IF EVAL(PHRF1SAD+PHRF1SLN)->CPHSBYTE(1)=')'/*LAST ')'*/  00695000
*                 THEN DO;      /*YES LAST CAHR IS RT PAREN*/      0226 00696000
         L     @10,PHRF1SAD(,GPR02P)                               0226 00697000
         L     @09,PHRF1SLN(,GPR02P)                               0226 00698000
         LR    @08,@10                                             0226 00699000
         ALR   @08,@09                                             0226 00700000
         CLI   CPHSBYTE(@08),C')'                                  0226 00701000
         BNE   @RF00226                                            0226 00702000
*            /*GET ADDRESS OF LAST CHAR (SUBPARM PTR PLUS STRING LEN)*/ 00703000
*                     /*   MOVE 'BLANK' INTO THAT CHAR OF PARM STRING*/ 00704000
*                    EVAL(PHRF1SAD+PHRF1SLN)->CPHSBYTE(1)=' ';     0228 00705000
         ALR   @10,@09                                             0228 00706000
         MVI   CPHSBYTE(@10),C' '                                  0228 00707000
*                 END;    /*END RT PAREN CODE*/                    0229 00708000
*                 ELSE;   /*NOT RT PAREN*/                         0230 00709000
@RF00226 DS    0H                                                  0231 00710000
*            END;         /*END NOT SYNTAX ERROR FROM COMMA SCAN*/ 0231 00711000
*      END;               /*END NOT SYNTAX ERROR FROM NXT PARM*/   0232 00712000
@RT00223 DS    0H                                                  0233 00713000
*    /*CMZPEND*/                                                   0233 00714000
*     DO;                                                          0233 00715000
@RT00203 DS    0H                                                  0234 00716000
*    GPR14P = CMZX9904;                                            0234 00717000
*                                                                  0234 00718000
         LR    GPR14P,CMZX9904                                     0234 00719000
*    END ;                                                         0235 00720000
*    END CPHSUB01;                                                 0236 00721000
@EL00002 DS    0H                                                  0236 00722000
@EF00002 DS    0H                                                  0236 00723000
@ER00002 BR    @14                                                 0236 00724000
*/********************************************************************/ 00725000
*/*                                                                  */ 00726000
*/*      CPHSUB02: FUNCTION 2 ROUTINE                                */ 00727000
*/*                                                                  */ 00728000
*/********************************************************************/ 00729000
*   CPHSUB02: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0237 00730000
CPHSUB02 DS    0H                                                  0238 00731000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0238 00732000
*    DO;                                                           0238 00733000
*   CMZX9905 = GPR14P;                                             0239 00734000
*                                                                  0239 00735000
         LR    CMZX9905,GPR14P                                     0239 00736000
*   END ;                                                          0240 00737000
*  /* R0=PTR BLK ADDRESS R1=PARM STRING POINTER R2=OUTPUT AREA PTR*/    00738000
*   PHRF2NVL=0;                 /* RESET COUNT FIELD  */           0241 00739000
         SLR   @10,@10                                             0241 00740000
         ST    @10,PHRF2NVL(,GPR02P)                               0241 00741000
*                               /* RESET COUNT LIMIT  */           0242 00742000
*   CPHOALIM=(PHROALEN-(ADDR(PHRF2VAL(1))-GPR02P))/LENGTH(PHRF2VAL(1)); 00743000
         LA    @10,PHRF2VAL(,GPR02P)                               0242 00744000
         SLR   @10,GPR02P                                          0242 00745000
         LR    @08,@10                                             0242 00746000
         LCR   @08,@08                                             0242 00747000
         AL    @08,PHROALEN(,GPR02P)                               0242 00748000
         SRDA  @08,32                                              0242 00749000
         D     @08,@CF00128                                        0242 00750000
         ST    @09,CPHOALIM                                        0242 00751000
*LOOP2:                                                            0243 00752000
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHSYNER='0'B&   0243 00753000
*         CPHFUNER='0'B);    /*GET ALL SUBPARMS WHILE NOT A SYNTAX*/    00754000
LOOP2    LA    @10,1                                               0243 00755000
         B     @DE00243                                            0243 00756000
@DL00243 TM    CPHLSTSP,B'00000101'                                0243 00757000
         BNZ   @DC00243                                            0243 00758000
         TM    CPHFUNER,B'01000000'                                0243 00759000
         BNZ   @DC00243                                            0243 00760000
*                                       /*ERROR AND NOT END OF STRING*/ 00761000
*      /*ICALL(CPHSUBSC)*/                                         0244 00762000
*      F2LOOP: DO;                                                 0244 00763000
F2LOOP   DS    0H                                                  0245 00764000
*      CALL CPHSUBSC;                                              0245 00765000
*                                                                  0245 00766000
         BAL   @14,CPHSUBSC                                        0245 00767000
*      END F2LOOP;           /*LOCATE NEXT SUBPARAM */             0246 00768000
*                 /* CPHSPPTR= SUBPARAM PTR, CPHSPLEN= SUBPARAM LNGTH*/ 00769000
*      IF CPHSYNER='1'B           /*SYNTAX ERROR*/                 0247 00770000
*          THEN;                  /*YES*/                          0247 00771000
         TM    CPHSYNER,B'00000001'                                0247 00772000
         BO    @RT00247                                            0247 00773000
*          ELSE DO;               /*NOT SYNTAX ERROR*/             0249 00774000
*             CPHTABAD=GPR00P->CPHSBTAB;  /*GET TABLE ADDR*/       0250 00775000
         LR    @10,GPR00P                                          0250 00776000
         MVC   CPHTABAD(4),CPHSBTAB(@10)                           0250 00777000
*             IF CPHSPLEN>8 /*SUB PARM TOO LONG*/                  0251 00778000
*                THEN        /*YES*/                               0251 00779000
         LH    @10,CPHSPLEN                                        0251 00780000
         C     @10,@CF00046                                        0251 00781000
         BNH   @RF00251                                            0251 00782000
*                   CPHFUNER='1'B;    /*SET FUNCTION ERROR*/       0252 00783000
         OI    CPHFUNER,B'01000000'                                0252 00784000
*                ELSE DO;         /*NOT TOO LONG*/                 0253 00785000
         B     @RC00251                                            0253 00786000
@RF00251 DS    0H                                                  0254 00787000
*                   IF CPHSPLEN=0   /*WAS SUB PARM DEFAULTED*/     0254 00788000
*                      THEN       /*YES*/                          0254 00789000
         SLR   @10,@10                                             0254 00790000
         CH    @10,CPHSPLEN                                        0254 00791000
         BNE   @RF00254                                            0254 00792000
*                         PHRF2VAL(CPHOANDX)=0;/*NEXT ENTRY EQUAL ZERO* 00793000
         L     @09,CPHOANDX                                        0255 00794000
         SLA   @09,2                                               0255 00795000
         ST    @10,PHRF2VAL-4(@09,GPR02P)                          0255 00796000
*                       ELSE DO;   /*NOT DEFAULTED*/               0256 00797000
         B     @RC00254                                            0256 00798000
@RF00254 DS    0H                                                  0257 00799000
*                                      /*PUT PARM IN SEARCH ARG*/  0257 00800000
*                          CPHARGUM=CPHSPPTR->CPHSBYTE(1:CPHSPLEN);     00801000
         MVI   CPHARGUM+1,C' '                                     0257 00802000
         MVC   CPHARGUM+2(6),CPHARGUM+1                            0257 00803000
         LH    @10,CPHSPLEN                                        0257 00804000
         BCTR  @10,0                                               0257 00805000
         L     @09,CPHSPPTR                                        0257 00806000
         EX    @10,@SM00427                                        0257 00807000
*                           /*ICALL(CPHTBLSC)*/                    0258 00808000
*                            DO;                                   0258 00809000
*                           CALL CPHTBLSC;                         0259 00810000
*                                                                  0259 00811000
         BAL   @14,CPHTBLSC                                        0259 00812000
*                           END ;  /*SEARCH SUBPARM TABLE*/        0260 00813000
*                          IF CPHARGNF='0'B     /*WAS ARG FOUND*/  0261 00814000
*                             THEN          /*YES*/                0261 00815000
         TM    CPHARGNF,B'00100000'                                0261 00816000
         BNZ   @RF00261                                            0261 00817000
*                                /* STORE TABLE ENTRY INTO OUTPUT AREA* 00818000
*                                MVC(CPHF2VAL(CPHOANDX),CPHSBVL1); 0262 00819000
         L     @10,CPHOANDX                                        0262 00820000
         SLA   @10,2                                               0262 00821000
         ALR   @10,GPR02P                                          0262 00822000
         MVC   CPHF2VAL-4(4,@10),CPHSBVL1                          0262 00823000
*                             ELSE DO;   /*ARG NOT FOUND*/         0263 00824000
         B     @RC00261                                            0263 00825000
@RF00261 DS    0H                                                  0264 00826000
*                          /*  STORE 'FF'S IN NEXT WORD OF OUTPUT AREA* 00827000
*                                PHRF2VAL(CPHOANDX)=-1;            0264 00828000
         L     @10,CPHOANDX                                        0264 00829000
         SLA   @10,2                                               0264 00830000
         SLR   @09,@09                                             0264 00831000
         BCTR  @09,0                                               0264 00832000
         ST    @09,PHRF2VAL-4(@10,GPR02P)                          0264 00833000
*                                CPHARGNF='0'B; /*RESET ARG NOT FOUND*/ 00834000
         NI    CPHARGNF,B'11011111'                                0265 00835000
*                             END;       /*END ARG NOT FOUND*/     0266 00836000
*                       END;             /*END NOT DEFAULTED*/     0267 00837000
@RC00261 DS    0H                                                  0268 00838000
*                   PHRF2NVL=PHRF2NVL+1;/*INCR COUNT*/             0268 00839000
@RC00254 LA    @10,1                                               0268 00840000
         AL    @10,PHRF2NVL(,GPR02P)                               0268 00841000
         ST    @10,PHRF2NVL(,GPR02P)                               0268 00842000
*                END;             /*END NOT TOO LONG*/             0269 00843000
*          END;                   /*END NOT SYNTAX ERROR*/         0270 00844000
@RC00251 DS    0H                                                  0271 00845000
*   END LOOP2;                    /*END DO WHILE*/                 0271 00846000
@RT00247 LA    @10,1                                               0271 00847000
         AL    @10,CPHOANDX                                        0271 00848000
@DE00243 ST    @10,CPHOANDX                                        0271 00849000
         C     @10,CPHOALIM                                        0271 00850000
         BNH   @DL00243                                            0271 00851000
@DC00243 DS    0H                                                  0272 00852000
*   IF CPHOANDX>CPHOALIM&CPHLSTSP='0'B /*OVER FLOW AND NOT END*/   0272 00853000
*      THEN                                     /*YES*/            0272 00854000
         L     @10,CPHOANDX                                        0272 00855000
         C     @10,CPHOALIM                                        0272 00856000
         BNH   @RF00272                                            0272 00857000
         TM    CPHLSTSP,B'00000100'                                0272 00858000
         BNZ   @RF00272                                            0272 00859000
*         CPHOFLOW='1'B;           /*SET OVERFLOW */               0273 00860000
         OI    CPHOFLOW,B'10000000'                                0273 00861000
*      ELSE DO;                    /*NOT OVERFLOW*/                0274 00862000
         B     @RC00272                                            0274 00863000
@RF00272 DS    0H                                                  0275 00864000
*         IF CPHSYNER='0'B&CPHFUNER='0'B /*SYNTAX OR FUNCT ERR*/   0275 00865000
*            THEN                  /*NO*/                          0275 00866000
         TM    CPHSYNER,B'00000001'                                0275 00867000
         BNZ   @RF00275                                            0275 00868000
         TM    CPHFUNER,B'01000000'                                0275 00869000
         BNZ   @RF00275                                            0275 00870000
*               GPR00P=GPR00P->CPHSBVAL; /*SET R0 =ADDR OF RTN*/   0276 00871000
         LR    @10,GPR00P                                          0276 00872000
         ICM   GPR00P,15,CPHSBVAL(@10)                             0276 00873000
*            ELSE;                 /*YES SYNTAX OR FUNCT ERR*/     0277 00874000
@RF00275 DS    0H                                                  0278 00875000
*      END;                         /*END NOT OVERFLOW*/           0278 00876000
*    /*CMZPEND*/                                                   0279 00877000
*     DO;                                                          0279 00878000
@RC00272 DS    0H                                                  0280 00879000
*    GPR14P = CMZX9905;                                            0280 00880000
*                                                                  0280 00881000
         LR    GPR14P,CMZX9905                                     0280 00882000
*    END ;                                                         0281 00883000
*    END CPHSUB02;                                                 0282 00884000
@EL00003 DS    0H                                                  0282 00885000
@EF00003 DS    0H                                                  0282 00886000
@ER00003 BR    @14                                                 0282 00887000
*/********************************************************************/ 00888000
*/*                                                                  */ 00889000
*/*      CPHSUB34: FUNCTION 3, 4 ROUTINE                             */ 00890000
*/*                                                                  */ 00891000
*/********************************************************************/ 00892000
*                                                                  0283 00893000
*   CPHSUB34: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0283 00894000
CPHSUB34 DS    0H                                                  0284 00895000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0284 00896000
*    DO;                                                           0284 00897000
*   CMZX9906 = GPR14P;                                             0285 00898000
*                                                                  0285 00899000
         LR    CMZX9906,GPR14P                                     0285 00900000
*   END ;                                                          0286 00901000
*                   /*  R1=PARM STRING PTR R2=OUTPUT AREA PTR*/    0287 00902000
*            /*RESET COUNT FIELD AND LIMIT OF OUTPUT AREA AND CPHOALIM* 00903000
*   PHRF34NS=0;                                                    0287 00904000
         SLR   @10,@10                                             0287 00905000
         ST    @10,PHRF34NS(,GPR02P)                               0287 00906000
*   CPHOALIM=(PHROALEN-(ADDR(PHRF34EN(1))-GPR02P))/LENGTH(PHRF34EN);    00907000
         LA    @10,PHRF34EN(,GPR02P)                               0288 00908000
         SLR   @10,GPR02P                                          0288 00909000
         LR    @08,@10                                             0288 00910000
         LCR   @08,@08                                             0288 00911000
         AL    @08,PHROALEN(,GPR02P)                               0288 00912000
         SRDA  @08,32                                              0288 00913000
         D     @08,@CF00237                                        0288 00914000
         ST    @09,CPHOALIM                                        0288 00915000
*             /*PROCESS ENTRIES WHILE NO ERRORS*/                  0289 00916000
*LOOP34:                                                           0289 00917000
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHFUNER='0'B&   0289 00918000
*         CPHSYNER='0'B);                                          0289 00919000
LOOP34   LA    @10,1                                               0289 00920000
         B     @DE00289                                            0289 00921000
@DL00289 TM    CPHLSTSP,B'00000100'                                0289 00922000
         BNZ   @DC00289                                            0289 00923000
         TM    CPHFUNER,B'01000000'                                0289 00924000
         BNZ   @DC00289                                            0289 00925000
         TM    CPHSYNER,B'00000001'                                0289 00926000
         BNZ   @DC00289                                            0289 00927000
*      /*ICALL(CPHSUBSC)*/                                         0290 00928000
*      F34LOOP: DO;                                                0290 00929000
F34LOOP  DS    0H                                                  0291 00930000
*      CALL CPHSUBSC;                                              0291 00931000
*                                                                  0291 00932000
         BAL   @14,CPHSUBSC                                        0291 00933000
*      END F34LOOP;            /*  LOCATE NEXT SUBPARAM*/          0292 00934000
*      IF CPHSYNER='1'B         /* SYNTAX ERROR*/                  0293 00935000
*         THEN;                   /*YES*/                          0293 00936000
         TM    CPHSYNER,B'00000001'                                0293 00937000
         BO    @RT00293                                            0293 00938000
*         ELSE DO;                 /*NOT SYNTAX ERROR*/            0295 00939000
*            IF CPHSPLEN>8         /*PARM TOO LONG*/               0296 00940000
*               THEN               /*YES*/                         0296 00941000
         LH    @10,CPHSPLEN                                        0296 00942000
         C     @10,@CF00046                                        0296 00943000
         BNH   @RF00296                                            0296 00944000
*                  CPHFUNER='1'B;  /*SET FUNCTION ERROR*/          0297 00945000
         OI    CPHFUNER,B'01000000'                                0297 00946000
*               ELSE DO;           /*NOT TOO LONG*/                0298 00947000
         B     @RC00296                                            0298 00948000
@RF00296 DS    0H                                                  0299 00949000
*                  IF CPHSPLEN=0   /*WAS PARM DEFAULTED*/          0299 00950000
*                     THEN DO;     /*YES*/                         0299 00951000
         LH    @10,CPHSPLEN                                        0299 00952000
         LTR   @10,@10                                             0299 00953000
         BNZ   @RF00299                                            0299 00954000
*                        IF CPHFUNNO=CPHFUN03 /*FUNCT 3*/          0301 00955000
*                           THEN    /*YES*/                        0301 00956000
         TM    CPHFUNNO,B'00000011'                                0301 00957000
         BNO   @RF00301                                            0301 00958000
         TM    CPHFUNNO,B'00001100'                                0301 00959000
         BNZ   @RF00301                                            0301 00960000
*                              PHRF34SP(CPHOANDX)=' ';/*SET TO BLANKS*/ 00961000
         L     @10,CPHOANDX                                        0302 00962000
         MH    @10,@CH00237                                        0302 00963000
         ALR   @10,GPR02P                                          0302 00964000
         MVI   PHRF34SP-11(@10),C' '                               0302 00965000
         MVC   PHRF34SP-10(6,@10),PHRF34SP-11(@10)                 0302 00966000
         MVI   PHRF34SP-12(@10),C' '                               0302 00967000
*                           ELSE    /*NO NOT FUNCT 3*/             0303 00968000
*                              PHRF34SP(CPHOANDX)='00000000';/*ST TO 0* 00969000
         B     @RC00301                                            0303 00970000
@RF00301 L     @10,CPHOANDX                                        0303 00971000
         MH    @10,@CH00237                                        0303 00972000
         ALR   @10,GPR02P                                          0303 00973000
         MVC   PHRF34SP-12(8,@10),@CC00269                         0303 00974000
*                     END;    /*END DEFAULTED*/                    0304 00975000
*                     ELSE DO;     /*NOT DEFAULTED*/               0305 00976000
         B     @RC00299                                            0305 00977000
@RF00299 DS    0H                                                  0306 00978000
*                         /*ICALL(CPHVALCK)*/                      0306 00979000
*                          DO;                                     0306 00980000
*                         CALL CPHVALCK;                           0307 00981000
*                                                                  0307 00982000
         BAL   @14,CPHVALCK                                        0307 00983000
*                         END ; /*CK VALIDITY OF PARM*/            0308 00984000
*                        PHRF34VF(CPHOANDX)=CPHVALFG;/*SET VAL FLG*/    00985000
         L     @10,CPHOANDX                                        0309 00986000
         MH    @10,@CH00237                                        0309 00987000
         ST    @10,@TF00001                                        0309 00988000
         ALR   @10,GPR02P                                          0309 00989000
         AL    @10,@CF00433                                        0309 00990000
         MVC   PHRF34VF-8(1,@10),CPHVALFG                          0309 00991000
*                        IF CPHFUNNO=CPHFUN03 /*FUNCT 3*/          0310 00992000
*                           THEN DO;          /*YES*/              0310 00993000
         TM    CPHFUNNO,B'00000011'                                0310 00994000
         BNO   @RF00310                                            0310 00995000
         TM    CPHFUNNO,B'00001100'                                0310 00996000
         BNZ   @RF00310                                            0310 00997000
*                              PHRF34SP(CPHOANDX)=' ';/*INIT TO BLANK*/ 00998000
         LR    @10,GPR02P                                          0312 00999000
         AL    @10,@TF00001                                        0312 01000000
         MVI   PHRF34SP-11(@10),C' '                               0312 01001000
         MVC   PHRF34SP-10(6,@10),PHRF34SP-11(@10)                 0312 01002000
         MVI   PHRF34SP-12(@10),C' '                               0312 01003000
*                    /* MOVE SUBPARAM TO PHRF34SP(*) LEFT JUSTIFIED*/   01004000
*                                     /*PADDED WITH BLANKS (8 CHAR) */  01005000
*                              PHRF34SP(CPHOANDX,1:CPHSPLEN)=      0313 01006000
*                                CPHSPPTR->CPHSBYTE(1:CPHSPLEN);   0313 01007000
         LR    @10,GPR02P                                          0313 01008000
         AL    @10,@TF00001                                        0313 01009000
         LH    @09,CPHSPLEN                                        0313 01010000
         BCTR  @09,0                                               0313 01011000
         L     @08,CPHSPPTR                                        0313 01012000
         EX    @09,@SM00434                                        0313 01013000
*                           END;              /*END FUNCT 3*/      0314 01014000
*                           ELSE DO;   /*NOT FUNCT 3*/             0315 01015000
         B     @RC00310                                            0315 01016000
@RF00310 DS    0H                                                  0316 01017000
*                              /*  INIT PHRF34SP(*) TO EBCDIC ZEROS*/   01018000
*                              PHRF34SP(CPHOANDX)='00000000';      0316 01019000
         L     @10,CPHOANDX                                        0316 01020000
         MH    @10,@CH00237                                        0316 01021000
         ST    @10,@TF00001                                        0316 01022000
         ALR   @10,GPR02P                                          0316 01023000
         MVC   PHRF34SP-12(8,@10),@CC00269                         0316 01024000
*               /* MOVE SUBPARAM TO PHRF34SP(*) RIGHT JUSTIFIED PADDED* 01025000
*                                        /*WITH ZEROS (8 CHARS)*/  0317 01026000
*                              PHRF34SP(CPHOANDX,9-CPHSPLEN:8)=    0317 01027000
*                              CPHSPPTR->CPHSBYTE(1:CPHSPLEN);     0317 01028000
         LA    @10,9                                               0317 01029000
         SH    @10,CPHSPLEN                                        0317 01030000
         L     @09,@TF00001                                        0317 01031000
         ALR   @09,@10                                             0317 01032000
         ALR   @09,GPR02P                                          0317 01033000
         AL    @09,@CF00260                                        0317 01034000
         LCR   @10,@10                                             0317 01035000
         AL    @10,@CF00046                                        0317 01036000
         L     @08,CPHSPPTR                                        0317 01037000
         EX    @10,@SM00436                                        0317 01038000
*                           END;        /*END NOT FUNCT 3*/        0318 01039000
*                     END;              /*END NOT DEFAULTED*/      0319 01040000
@RC00310 DS    0H                                                  0320 01041000
*                  PHRF34SL(CPHOANDX)=CPHSPLEN;/*PUT LEN IN OUT AREA*/  01042000
@RC00299 L     @10,CPHOANDX                                        0320 01043000
         MH    @10,@CH00237                                        0320 01044000
         LH    @09,CPHSPLEN                                        0320 01045000
         AL    @10,@CF00438                                        0320 01046000
         STH   @09,PHRF34SL-10(@10,GPR02P)                         0320 01047000
*                  PHRF34NS=PHRF34NS+1;       /*INC NO. SUBPARM*/  0321 01048000
         LA    @10,1                                               0321 01049000
         AL    @10,PHRF34NS(,GPR02P)                               0321 01050000
         ST    @10,PHRF34NS(,GPR02P)                               0321 01051000
*               END;           /*END NOT TOO LONG*/                0322 01052000
*         END;                 /*END NOT SYNTAX ERROR*/            0323 01053000
@RC00296 DS    0H                                                  0324 01054000
*   END LOOP34;                /*END DO WHILE*/                    0324 01055000
@RT00293 LA    @10,1                                               0324 01056000
         AL    @10,CPHOANDX                                        0324 01057000
@DE00289 ST    @10,CPHOANDX                                        0324 01058000
         C     @10,CPHOALIM                                        0324 01059000
         BNH   @DL00289                                            0324 01060000
@DC00289 DS    0H                                                  0325 01061000
*   IF CPHOANDX>CPHOALIM&CPHLSTSP='0'B /*OVERFLOW AND NOT END*/    0325 01062000
*      THEN                    /*YES*/                             0325 01063000
         L     @10,CPHOANDX                                        0325 01064000
         C     @10,CPHOALIM                                        0325 01065000
         BNH   @RF00325                                            0325 01066000
         TM    CPHLSTSP,B'00000100'                                0325 01067000
         BNZ   @RF00325                                            0325 01068000
*         CPHOFLOW='1'B;       /*SET OVERFLOW FLG*/                0326 01069000
         OI    CPHOFLOW,B'10000000'                                0326 01070000
*      ELSE;                   /*NOT OVER FLOW*/                   0327 01071000
@RF00325 DS    0H                                                  0328 01072000
*    /*CMZPEND*/                                                   0328 01073000
*     DO;                                                          0328 01074000
*    GPR14P = CMZX9906;                                            0329 01075000
*                                                                  0329 01076000
         LR    GPR14P,CMZX9906                                     0329 01077000
*    END ;                                                         0330 01078000
*    END CPHSUB34;                                                 0331 01079000
@EL00004 DS    0H                                                  0331 01080000
@EF00004 DS    0H                                                  0331 01081000
@ER00004 BR    @14                                                 0331 01082000
*/********************************************************************/ 01083000
*/*                                                                  */ 01084000
*/*        CPHSUB05: FUNCTION 5 ROUTINE                              */ 01085000
*/*                                                                  */ 01086000
*/********************************************************************/ 01087000
*                                                                  0332 01088000
*  CPHSUB05: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                   0332 01089000
CPHSUB05 DS    0H                                                  0333 01090000
*  /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                        0333 01091000
*   DO;                                                            0333 01092000
*  CMZX9907 = GPR14P;                                              0334 01093000
*                                                                  0334 01094000
         LR    CMZX9907,GPR14P                                     0334 01095000
*  END ;                                                           0335 01096000
*                      /* R1=PARM STRING PTR R2=OUTPUT AREA PTR*/  0336 01097000
*/*  RESET COUNT FIELD AND LIMIT OF OUTPUT AREA (PHRF5NSP & CPHOALIM)*/ 01098000
*   PHRF5NSP=0;                                                    0336 01099000
         SLR   @10,@10                                             0336 01100000
         ST    @10,PHRF5NSP(,GPR02P)                               0336 01101000
*   CPHOALIM=(PHROALEN-(ADDR(PHRF5ENT(1))-GPR02P))/LENGTH(PHRF5ENT);    01102000
         LA    @10,PHRF5ENT(,GPR02P)                               0337 01103000
         SLR   @10,GPR02P                                          0337 01104000
         LR    @08,@10                                             0337 01105000
         LCR   @08,@08                                             0337 01106000
         AL    @08,PHROALEN(,GPR02P)                               0337 01107000
         SRDA  @08,32                                              0337 01108000
         D     @08,@CF00046                                        0337 01109000
         ST    @09,CPHOALIM                                        0337 01110000
*             /*PROCESS ENTRIES WHILE NO ERRORS*/                  0338 01111000
*LOOP5:                                                            0338 01112000
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHSYNER='0'B);  0338 01113000
LOOP5    LA    @10,1                                               0338 01114000
         B     @DE00338                                            0338 01115000
@DL00338 TM    CPHLSTSP,B'00000101'                                0338 01116000
         BNZ   @DC00338                                            0338 01117000
*      /*ICALL(CPHSUBSC)*/                                         0339 01118000
*      F5LOOP: DO;                                                 0339 01119000
F5LOOP   DS    0H                                                  0340 01120000
*      CALL CPHSUBSC;                                              0340 01121000
*                                                                  0340 01122000
         BAL   @14,CPHSUBSC                                        0340 01123000
*      END F5LOOP;     /* LOCATE NEXT SUBPARAM*/                   0341 01124000
*                  /*CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*/ 01125000
*      IF CPHSYNER='1'B         /* SYNTAX ERROR */                 0342 01126000
*         THEN;                 /*YES  */                          0342 01127000
         TM    CPHSYNER,B'00000001'                                0342 01128000
         BO    @RT00342                                            0342 01129000
*         ELSE DO;            /* NOT SYNTAX ERROR*/                0344 01130000
*            IF CPHSPPTR=0     /*PARM DEFAULTED*/                  0345 01131000
*               THEN;          /*YES*/                             0345 01132000
         L     @10,CPHSPPTR                                        0345 01133000
         LTR   @10,@10                                             0345 01134000
         BZ    @RT00345                                            0345 01135000
*               ELSE DO;             /*NOT DEFAULTED*/             0347 01136000
*                   /*ICALL(CPHVALCK)*/                            0348 01137000
*                    DO;                                           0348 01138000
*                   CALL CPHVALCK;                                 0349 01139000
*                                                                  0349 01140000
         BAL   @14,CPHVALCK                                        0349 01141000
*                   END ;  /* CHECK SUBPARAM VALIDITY*/            0350 01142000
*                  PHRF5VF(CPHOANDX)=CPHVALFG;/*SET VAL FLGS IN OUTARA* 01143000
         L     @10,CPHOANDX                                        0351 01144000
         SLA   @10,3                                               0351 01145000
         ALR   @10,GPR02P                                          0351 01146000
         MVC   PHRF5VF-8(1,@10),CPHVALFG                           0351 01147000
*               END;                 /*END NOT DEFAULTED*/         0352 01148000
*            PHRF5SL(CPHOANDX)=CPHSPLEN;/*SET LENGTH IN OUT AREA*/ 0353 01149000
@RT00345 L     @10,CPHOANDX                                        0353 01150000
         SLA   @10,3                                               0353 01151000
         LH    @09,CPHSPLEN                                        0353 01152000
         STH   @09,PHRF5SL-8(@10,GPR02P)                           0353 01153000
*            PHRF5SPT(CPHOANDX)=CPHSPPTR;/*PUT PTR IN OUT AREA*/   0354 01154000
         L     @09,CPHSPPTR                                        0354 01155000
         ST    @09,PHRF5SPT-8(@10,GPR02P)                          0354 01156000
*            PHRF5NSP=PHRF5NSP+1;   /*INCR COUNT*/                 0355 01157000
         LA    @10,1                                               0355 01158000
         AL    @10,PHRF5NSP(,GPR02P)                               0355 01159000
         ST    @10,PHRF5NSP(,GPR02P)                               0355 01160000
*         END;                  /*END NOT SYNTAX ERROR*/           0356 01161000
*   END LOOP5;                  /*END DO WHILE*/                   0357 01162000
@RT00342 LA    @10,1                                               0357 01163000
         AL    @10,CPHOANDX                                        0357 01164000
@DE00338 ST    @10,CPHOANDX                                        0357 01165000
         C     @10,CPHOALIM                                        0357 01166000
         BNH   @DL00338                                            0357 01167000
@DC00338 DS    0H                                                  0358 01168000
*   IF CPHOANDX>CPHOALIM /*OVER FLOW AND NOT END OF LIST*/         0358 01169000
*      THEN                     /*YES */                           0358 01170000
         L     @10,CPHOANDX                                        0358 01171000
         C     @10,CPHOALIM                                        0358 01172000
         BNH   @RF00358                                            0358 01173000
*         CPHOFLOW='1'B;        /*SET OVERFLOW FLAG*/              0359 01174000
         OI    CPHOFLOW,B'10000000'                                0359 01175000
*      ELSE;                    /*NOT OVERFLOW*/                   0360 01176000
@RF00358 DS    0H                                                  0361 01177000
*    /*CMZPEND*/                                                   0361 01178000
*     DO;                                                          0361 01179000
*    GPR14P = CMZX9907;                                            0362 01180000
*                                                                  0362 01181000
         LR    GPR14P,CMZX9907                                     0362 01182000
*    END ;                                                         0363 01183000
*    END CPHSUB05;                                                 0364 01184000
@EL00005 DS    0H                                                  0364 01185000
@EF00005 DS    0H                                                  0364 01186000
@ER00005 BR    @14                                                 0364 01187000
*/********************************************************************/ 01188000
*/*                                                                  */ 01189000
*/*        CPHSUB06: FUNCTION 6 ROUTINE                              */ 01190000
*/*                                                                  */ 01191000
*/********************************************************************/ 01192000
*   CPHSUB06: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0365 01193000
CPHSUB06 DS    0H                                                  0366 01194000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0366 01195000
*    DO;                                                           0366 01196000
*   CMZX9908 = GPR14P;                                             0367 01197000
*                                                                  0367 01198000
         LR    CMZX9908,GPR14P                                     0367 01199000
*   END ;                                                          0368 01200000
*                            /* R1=PARM STRING POINTER */          0369 01201000
*   DO WHILE (CPHLSTSP='0'B & CPHSYNER='0'B);    /*PROCESS PARMS*/ 0369 01202000
         B     @DE00369                                            0369 01203000
@DL00369 DS    0H                                                  0370 01204000
*     /*ICALL(CPHSUBSC)*/                                          0370 01205000
*     F6LOOP: DO;                                                  0370 01206000
F6LOOP   DS    0H                                                  0371 01207000
*     CALL CPHSUBSC;                                               0371 01208000
*                                                                  0371 01209000
         BAL   @14,CPHSUBSC                                        0371 01210000
*     END F6LOOP;   /*LOCATE NEXT SUBPARAM              */         0372 01211000
*   END;                   /*END DO WHILE*/                        0373 01212000
@DE00369 TM    CPHLSTSP,B'00000101'                                0373 01213000
         BZ    @DL00369                                            0373 01214000
*    /*CMZPEND*/                                                   0374 01215000
*     DO;                                                          0374 01216000
*    GPR14P = CMZX9908;                                            0375 01217000
*                                                                  0375 01218000
         LR    GPR14P,CMZX9908                                     0375 01219000
*    END ;                                                         0376 01220000
*    END CPHSUB06;                                                 0377 01221000
@EL00006 DS    0H                                                  0377 01222000
@EF00006 DS    0H                                                  0377 01223000
@ER00006 BR    @14                                                 0377 01224000
*/*******************************************************************/  01225000
*/*                                                                  */ 01226000
*/*       CPHSUB07: FUNCTIONS 7 AND 8 ROUTINE                        */ 01227000
*/*                                                                  */ 01228000
*/********************************************************************/ 01229000
*                                                                  0378 01230000
*   CPHSUB07: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0378 01231000
CPHSUB07 DS    0H                                                  0379 01232000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0379 01233000
*    DO;                                                           0379 01234000
*   CMZX9909 = GPR14P;                                             0380 01235000
*                                                                  0380 01236000
         LR    CMZX9909,GPR14P                                     0380 01237000
*   END ;                                                          0381 01238000
* /*RESET COUNT FIELD AND LIMIT IN OUTPUT AREA (PHRF7NSP & CPHOALIM)*/  01239000
* IF CPHFUNNO=CPHFUN07 THEN DO;                            /*@D32CKKA*/ 01240000
         TM    CPHFUNNO,B'00000111'                                0382 01241000
         BNO   @RF00382                                            0382 01242000
         TM    CPHFUNNO,B'00001000'                                0382 01243000
         BNZ   @RF00382                                            0382 01244000
*   PHRF7NSP=0;                                                    0384 01245000
         SLR   @10,@10                                             0384 01246000
         ST    @10,PHRF7NSP(,GPR02P)                               0384 01247000
*   CPHOALIM=(PHROALEN-(ADDR(PHRF7NUM(1))-GPR02P))/LENGTH(PHRF7NUM);    01248000
         LA    @10,PHRF7NUM(,GPR02P)                               0385 01249000
         SLR   @10,GPR02P                                          0385 01250000
         LCR   @10,@10                                             0385 01251000
         AL    @10,PHROALEN(,GPR02P)                               0385 01252000
         ST    @10,CPHOALIM                                        0385 01253000
*    END;                                                  /*@D32CKKA*/ 01254000
* ELSE DO;                          /*DO SAME FOR FUNCTION 8 @D32CKKA*/ 01255000
         B     @RC00382                                            0387 01256000
@RF00382 DS    0H                                                  0388 01257000
*   PHRF8NSP=0;                                            /*@D32CKKA*/ 01258000
         SLR   @10,@10                                             0388 01259000
         ST    @10,PHRF8NSP(,GPR02P)                               0388 01260000
*   CPHOALIM=(PHROALEN-(ADDR(PHRF8ENT(1))-GPR02P))/LENGTH(PHRF8ENT);    01261000
         LA    @10,PHRF8ENT(,GPR02P)                               0389 01262000
         SLR   @10,GPR02P                                          0389 01263000
         LR    @08,@10                                             0389 01264000
         LCR   @08,@08                                             0389 01265000
         AL    @08,PHROALEN(,GPR02P)                               0389 01266000
         SRDA  @08,32                                              0389 01267000
         D     @08,@CF00313                                        0389 01268000
         ST    @09,CPHOALIM                                        0389 01269000
*    END;                                                  /*@D32CKKA*/ 01270000
*                      /*  R1=PARM STRING PTR R2=OUTPUT AREA PTR*/ 0391 01271000
*LOOP7:                                                            0391 01272000
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHFUNER='0'B&   0391 01273000
*         CPHSYNER='0'B);/*PROCESS ENTRIES*/                       0391 01274000
@RC00382 DS    0H                                                  0391 01275000
LOOP7    LA    @10,1                                               0391 01276000
         B     @DE00391                                            0391 01277000
@DL00391 TM    CPHLSTSP,B'00000100'                                0391 01278000
         BNZ   @DC00391                                            0391 01279000
         TM    CPHFUNER,B'01000000'                                0391 01280000
         BNZ   @DC00391                                            0391 01281000
         TM    CPHSYNER,B'00000001'                                0391 01282000
         BNZ   @DC00391                                            0391 01283000
*      /*ICALL(CPHSUBSC)*/                                         0392 01284000
*      F7LOOP: DO;                                                 0392 01285000
F7LOOP   DS    0H                                                  0393 01286000
*      CALL CPHSUBSC;                                              0393 01287000
*                                                                  0393 01288000
         BAL   @14,CPHSUBSC                                        0393 01289000
*      END F7LOOP;            /* LOCATE NEXT SUBPARAM*/            0394 01290000
*                  /* CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH* 01291000
*      IF CPHSYNER='1'B              /*SYNTAX ERROR*/              0395 01292000
*         THEN;                     /*YES */                       0395 01293000
         TM    CPHSYNER,B'00000001'                                0395 01294000
         BO    @RT00395                                            0395 01295000
*         ELSE DO;                   /*NOT SYNTAX ERROR*/          0397 01296000
*            CPHVALBT=CPHVALBT|'40'X;   /*CHECK FOR NUMERICS @DM12920*/ 01297000
         OI    CPHVALBT,X'40'                                      0398 01298000
*            IF CPHSPPTR*CPHSPLEN=0 /*SUB PARM DEFAULTED*/         0399 01299000
*             THEN IF CPHFUNNO=CPHFUN07  /*DEFAULTED AND F7  @D32CKKA*/ 01300000
         L     @10,CPHSPPTR                                        0399 01301000
         MH    @10,CPHSPLEN                                        0399 01302000
         LTR   @10,@10                                             0399 01303000
         BNZ   @RF00399                                            0399 01304000
*               THEN CPHFUNER='1'B;  /*SET FUNCTION ERROR    @D32CKKA*/ 01305000
         TM    CPHFUNNO,B'00000111'                                0400 01306000
         BNO   @RF00400                                            0400 01307000
         TM    CPHFUNNO,B'00001000'                                0400 01308000
         BNZ   @RF00400                                            0400 01309000
         OI    CPHFUNER,B'01000000'                                0401 01310000
*               ELSE DO;               /*DEFAULTED AND FUNC8 @D32CKKA*/ 01311000
         B     @RC00400                                            0402 01312000
@RF00400 DS    0H                                                  0403 01313000
*                 PHRF8DFT(CPHOANDX)='1'B;  /*DEFAULT FLG ON @D32CKKA*/ 01314000
         L     @10,CPHOANDX                                        0403 01315000
         ALR   @10,@10                                             0403 01316000
         ST    @10,@TF00001                                        0403 01317000
         ALR   @10,GPR02P                                          0403 01318000
         OI    PHRF8DFT-2(@10),B'10000000'                         0403 01319000
*                 PHRF8NSP=PHRF8NSP+1;   /*INC SUBPARM COUNT @D32CKKA*/ 01320000
         LA    @10,1                                               0404 01321000
         AL    @10,PHRF8NSP(,GPR02P)                               0404 01322000
         ST    @10,PHRF8NSP(,GPR02P)                               0404 01323000
*                 PHRF8NUM(CPHOANDX)='00'X;    /*CLEAR VALUE @D32CKKA*/ 01324000
         SLR   @10,@10                                             0405 01325000
         L     @09,@TF00001                                        0405 01326000
         STC   @10,PHRF8NUM-2(@09,GPR02P)                          0405 01327000
*                 END;                                     /*@D32CKKA*/ 01328000
*               ELSE DO;       /*NOT DEFAULTED*/                   0407 01329000
         B     @RC00399                                            0407 01330000
@RF00399 DS    0H                                                  0408 01331000
*                   /*ICALL(CPHVALCK)*/                            0408 01332000
*                    DO;                                           0408 01333000
*                   CALL CPHVALCK;                                 0409 01334000
*                                                                  0409 01335000
         BAL   @14,CPHVALCK                                        0409 01336000
*                   END ;     /*CHECK SUBPARAM FOR NUMERIC*/       0410 01337000
*                  IF CPHVALNU='1'B |  /*NOT NUMERIC         @DM10621*/ 01338000
*                     CPHVALAN='1'B /*OR NOT ALPHA NUMERIC   @DM10621*/ 01339000
*                     THEN               /*YES*/                   0411 01340000
         TM    CPHVALNU,B'01100000'                                0411 01341000
         BZ    @RF00411                                            0411 01342000
*                        CPHFUNER='1'B;   /*SET FUNCTION ERROR*/   0412 01343000
         OI    CPHFUNER,B'01000000'                                0412 01344000
*                     ELSE DO;   /*NOT AN ERROR*/                  0413 01345000
         B     @RC00411                                            0413 01346000
@RF00411 DS    0H                                                  0414 01347000
*                        IF CPHSPLEN>3 /*GR THAN 3 CHAR*/          0414 01348000
*                           THEN      /*YES*/                      0414 01349000
         LH    @10,CPHSPLEN                                        0414 01350000
         C     @10,@CF00193                                        0414 01351000
         BNH   @RF00414                                            0414 01352000
*                              CPHFUNER='1'B;  /*SET FUNCT ERROR*/ 0415 01353000
         OI    CPHFUNER,B'01000000'                                0415 01354000
*                           ELSE DO;  /*NOT GR TAHN 3*/            0416 01355000
         B     @RC00414                                            0416 01356000
@RF00414 DS    0H                                                  0417 01357000
*                               /* CONVERT DECIMAL SUBPARAM TO HEX*/    01358000
*                              CPHDECHX='000';/* INIT HOLD AREA     */  01359000
         MVC   CPHDECHX(3),@CC00294                                0417 01360000
*                              CPHDECHX(4-CPHSPLEN:3)=     /*MOVE NO.*/ 01361000
*                              CPHSPPTR->CPHSBYTE(1:CPHSPLEN);     0418 01362000
         LA    @10,4                                               0418 01363000
         SH    @10,CPHSPLEN                                        0418 01364000
         LA    @09,CPHDECHX-1(@10)                                 0418 01365000
         LCR   @10,@10                                             0418 01366000
         AL    @10,@CF00193                                        0418 01367000
         L     @08,CPHSPPTR                                        0418 01368000
         EX    @10,@SM00439                                        0418 01369000
*                              PACK(CPHDECHX,CPHDECHX);            0419 01370000
         PACK  CPHDECHX(3),CPHDECHX(3)                             0419 01371000
*                                     /* PACK EBCDIC TO DIGITS + SIGN*/ 01372000
*                              CVB(GPR15F,CPHDECHX);               0420 01373000
         XC    @TS00001(8),@TS00001                                0420 01374000
         MVC   @TS00001+5(3),CPHDECHX                              0420 01375000
         CVB   GPR15F,@TS00001                                     0420 01376000
*                                     /* PUT HEX VALUE IN REGISTER 1*/  01377000
*                              IF GPR15F>255 /*PARM GR THAN 255*/  0421 01378000
*                                 THEN    /*YES*/                  0421 01379000
         C     GPR15F,@CF00297                                     0421 01380000
         BNH   @RF00421                                            0421 01381000
*                                    CPHFUNER='1'B;/*SET FUNCTION ERR*/ 01382000
         OI    CPHFUNER,B'01000000'                                0422 01383000
*                                   ELSE IF CPHFUNNO=CPHFUN07      0423 01384000
*                                    THEN DO;             /*@D32CKKA*/  01385000
         B     @RC00421                                            0423 01386000
@RF00421 TM    CPHFUNNO,B'00000111'                                0423 01387000
         BNO   @RF00423                                            0423 01388000
         TM    CPHFUNNO,B'00001000'                                0423 01389000
         BNZ   @RF00423                                            0423 01390000
*                                   /* MOVE HEX BYTE TO OUTPUT AREA*/   01391000
*                                     PHRF7NUM(CPHOANDX)=GPR15F;   0425 01392000
         L     @10,CPHOANDX                                        0425 01393000
         STC   GPR15F,PHRF7NUM-1(@10,GPR02P)                       0425 01394000
*                                     PHRF7NSP=PHRF7NSP+1;/*INCR CNT*/  01395000
         LA    @10,1                                               0426 01396000
         AL    @10,PHRF7NSP(,GPR02P)                               0426 01397000
         ST    @10,PHRF7NSP(,GPR02P)                               0426 01398000
*                                     END;  /*END FUNC 7 @D32CKKA*/     01399000
*                                    ELSE DO; /*FUNC 8 @D32CKKA*/  0428 01400000
         B     @RC00423                                            0428 01401000
@RF00423 DS    0H                                                  0429 01402000
*                                      /*MOVE DATA TO OUTPUT AREA*/     01403000
*                                     PHRF8NUM(CPHOANDX)=GPR15F;   0429 01404000
         L     @10,CPHOANDX                                        0429 01405000
         ALR   @10,@10                                             0429 01406000
         STC   GPR15F,PHRF8NUM-2(@10,GPR02P)                       0429 01407000
*                                     PHRF8NSP=PHRF8NSP+1; /*@D32CKKA*/ 01408000
         LA    @09,1                                               0430 01409000
         AL    @09,PHRF8NSP(,GPR02P)                               0430 01410000
         ST    @09,PHRF8NSP(,GPR02P)                               0430 01411000
*                                     PHRF8DFT(CPHOANDX)='0'B;     0431 01412000
         ALR   @10,GPR02P                                          0431 01413000
         NI    PHRF8DFT-2(@10),B'01111111'                         0431 01414000
*                                     /*INC NUMBER OF PARMS AND CLEAR*/ 01415000
*                                     /*DEFAULT FLAG        @D32CKKA*/  01416000
*                                     END; /*END FUNC 8 @D32CKKA*/ 0432 01417000
*                           END;         /*END NOT GR THAN 3*/     0433 01418000
@RC00423 DS    0H                                                  0433 01419000
@RC00421 DS    0H                                                  0434 01420000
*                     END;               /*END NO ERRORS*/         0434 01421000
@RC00414 DS    0H                                                  0435 01422000
*               END;                     /*END NOT DEFAULTED*/     0435 01423000
@RC00411 DS    0H                                                  0436 01424000
*         END;                           /*END NOT SYNTAX ERROR*/  0436 01425000
@RC00399 DS    0H                                                  0437 01426000
*   END LOOP7;                            /*END DO WHILE*/         0437 01427000
@RT00395 LA    @10,1                                               0437 01428000
         AL    @10,CPHOANDX                                        0437 01429000
@DE00391 ST    @10,CPHOANDX                                        0437 01430000
         C     @10,CPHOALIM                                        0437 01431000
         BNH   @DL00391                                            0437 01432000
@DC00391 DS    0H                                                  0438 01433000
*   IF CPHOANDX>CPHOALIM                 /*OVERFLOW*/              0438 01434000
*      THEN                             /*YES*/                    0438 01435000
         L     @10,CPHOANDX                                        0438 01436000
         C     @10,CPHOALIM                                        0438 01437000
         BNH   @RF00438                                            0438 01438000
*         CPHOFLOW='1'B;                /*SET OVERFLOW FLG*/       0439 01439000
         OI    CPHOFLOW,B'10000000'                                0439 01440000
*      ELSE;                            /*NOT OVERFLOW*/           0440 01441000
@RF00438 DS    0H                                                  0441 01442000
*  /*CMZPEND*/                                                     0441 01443000
*   DO;                                                            0441 01444000
*  GPR14P = CMZX9909;                                              0442 01445000
*                                                                  0442 01446000
         LR    GPR14P,CMZX9909                                     0442 01447000
*  END ;                                                           0443 01448000
*  END CPHSUB07;                                                   0444 01449000
@EL00007 DS    0H                                                  0444 01450000
@EF00007 DS    0H                                                  0444 01451000
@ER00007 BR    @14                                                 0444 01452000
*/********************************************************************/ 01453000
*/*                                                                  */ 01454000
*/*      CPHTBLSC: TABLE SEARCH ROUTINE                              */ 01455000
*/*                                                                  */ 01456000
*/********************************************************************/ 01457000
*   CPHTBLSC: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0445 01458000
CPHTBLSC DS    0H                                                  0446 01459000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0446 01460000
*    DO;                                                           0446 01461000
*   CMZX9903 = GPR14P;                                             0447 01462000
*                                                                  0447 01463000
         LR    CMZX9903,GPR14P                                     0447 01464000
*   END ;                                                          0448 01465000
*   CPHTABSV=CPHTABAD;         /*SAVE TABLE PTR IN CPHTABSV*/      0449 01466000
         L     @10,CPHTABAD                                        0449 01467000
         ST    @10,CPHTABSV                                        0449 01468000
*   CPHARGNF='1'B;          /*INIT ARG NOT FOUND ON*/              0450 01469000
         OI    CPHARGNF,B'00100000'                                0450 01470000
*TBLOOP:                    /*SEARCH FOR ARG*/                     0451 01471000
*   DO CPHENCTR=1 TO CPHTABSV->CPHENTNO WHILE(CPHARGNF='1'B);      0451 01472000
TBLOOP   LA    @10,1                                               0451 01473000
         B     @DE00451                                            0451 01474000
@DL00451 TM    CPHARGNF,B'00100000'                                0451 01475000
         BNO   @DC00451                                            0451 01476000
*      IF CPHKEYWD(1)=CPHARGUM /*IS THIS THE CORRECT ONE*/         0452 01477000
*         THEN DO;             /*YES*/                             0452 01478000
         L     @10,CPHTABAD                                        0452 01479000
         CLC   CPHKEYWD(8,@10),CPHARGUM                            0452 01480000
         BNE   @RF00452                                            0452 01481000
*            CPHSUBVL(1:CPHTABSV->CPHENTLN-8)=CPHFUNBT(1,1:CPHTABSV->   01482000
*             CPHENTLN-8);    /*MOVE ENTRY MINUS FIRST 8*/         0454 01483000
         L     @09,CPHTABSV                                        0454 01484000
         ICM   @09,12,CPHENTLN(@09)                                0454 01485000
         SRA   @09,16                                              0454 01486000
         SL    @09,@CF00271                                        0454 01487000
         EX    @09,@SM00442                                        0454 01488000
*            CPHARGNF='0'B;    /*RESET ARG NOT FOUND FLG*/         0455 01489000
         NI    CPHARGNF,B'11011111'                                0455 01490000
*         END;                 /*END CORRECT ENTRY*/               0456 01491000
*         ELSE                 /*NOT CORRECT ENTRY*/               0457 01492000
*            CPHTABAD=CPHTABSV->CPHENTLN+CPHTABAD;/*GET NEXT ENTRY*/    01493000
         B     @RC00452                                            0457 01494000
@RF00452 L     @10,CPHTABSV                                        0457 01495000
         ICM   @10,12,CPHENTLN(@10)                                0457 01496000
         SRA   @10,16                                              0457 01497000
         AL    @10,CPHTABAD                                        0457 01498000
         ST    @10,CPHTABAD                                        0457 01499000
*   END TBLOOP;                                                    0458 01500000
@RC00452 LA    @10,1                                               0458 01501000
         AH    @10,CPHENCTR                                        0458 01502000
@DE00451 STH   @10,CPHENCTR                                        0458 01503000
         L     @09,CPHTABSV                                        0458 01504000
         ICM   @09,12,CPHENTNO(@09)                                0458 01505000
         SRA   @09,16                                              0458 01506000
         CR    @10,@09                                             0458 01507000
         BNH   @DL00451                                            0458 01508000
@DC00451 DS    0H                                                  0459 01509000
*   /*CMZPEND*/                                                    0459 01510000
*   TBR: DO;                                                       0459 01511000
TBR      DS    0H                                                  0460 01512000
*   GPR14P = CMZX9903;                                             0460 01513000
*                                                                  0460 01514000
         LR    GPR14P,CMZX9903                                     0460 01515000
*   END TBR;                                                       0461 01516000
*   END CPHTBLSC;                                                  0462 01517000
@EL00008 DS    0H                                                  0462 01518000
@EF00008 DS    0H                                                  0462 01519000
@ER00008 BR    @14                                                 0462 01520000
*/********************************************************************/ 01521000
*/*                                                                  */ 01522000
*/*      CPHVALCK: VALIDITY CHECK ROUTINE                            */ 01523000
*/*                                                                  */ 01524000
*/********************************************************************/ 01525000
*                                                                  0463 01526000
*   CPHVALCK: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0463 01527000
CPHVALCK DS    0H                                                  0464 01528000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0464 01529000
*    DO;                                                           0464 01530000
*   CMZX9910 = GPR14P;                                             0465 01531000
*                                                                  0465 01532000
         LR    CMZX9910,GPR14P                                     0465 01533000
*   END ;                  /*@ZA27161*/                            0466 01534000
*   CPHVCK01=GPR01P;           /* SAVE REG01                 @ZA27161*/ 01535000
         ST    GPR01P,CPHVCK01                                     0467 01536000
*   CPHVCK02=GPR02P;           /* SAVE REG02                 @ZA27161*/ 01537000
         ST    GPR02P,CPHVCK02                                     0468 01538000
*   CPHVALFG='00'X;            /* RESET ERROR INDICATORS*/         0469 01539000
         MVI   CPHVALFG,X'00'                                      0469 01540000
*   IF CPHVALBT(1:4)='0000'B   /*VAL CHECKING CALLED FOR*/         0470 01541000
*      THEN;                   /*NO*/                              0470 01542000
         TM    CPHVALBT,B'11110000'                                0470 01543000
         BZ    @RT00470                                            0470 01544000
*      ELSE DO;                /*YES*/                             0472 01545000
*         CPHVALPS=1;           /*INIT SUBPARAM STRING POINTER*/   0473 01546000
         MVC   CPHVALPS(4),@CF00048                                0473 01547000
*         IF CPHFUNFC='1'B   /*CK 1ST CHAR ALPHA*/                 0474 01548000
*            THEN DO;           /*YES*/                            0474 01549000
         TM    CPHFUNFC,B'00010000'                                0474 01550000
         BNO   @RF00474                                            0474 01551000
*                          /* TRT CHAR. TO CLASSIFY TYPE*/         0476 01552000
*               GPR02F=0;     /* INIT TRT CODE REGISTER TO ZERO*/  0476 01553000
         SLR   GPR02F,GPR02F                                       0476 01554000
*               TRT(CPHSPPTR->CPHSBYTE(1),CPHVTRTB);               0477 01555000
         L     @10,CPHSPPTR                                        0477 01556000
         TRT   CPHSBYTE(1,@10),CPHVTRTB                            0477 01557000
*               IF GPR02F=1    /*IS CHAR ALPHA*/                   0478 01558000
*                  THEN DO;             /*YES*/                    0478 01559000
         LA    @10,1                                               0478 01560000
         CR    GPR02F,@10                                          0478 01561000
         BNE   @RF00478                                            0478 01562000
*                     IF CPHFUNAN='1'B /*CK ALPHA NUMERIC*/        0480 01563000
*                        THEN                 /*YES*/              0480 01564000
         TM    CPHFUNAN,B'00100000'                                0480 01565000
         BNO   @RF00480                                            0480 01566000
*                           CPHVALPS=CPHVALPS+1;/*INCR CHAR PTR*/  0481 01567000
         AL    @10,CPHVALPS                                        0481 01568000
         ST    @10,CPHVALPS                                        0481 01569000
*                         ELSE   /*NOT CK ALPHA NUMERIC*/          0482 01570000
*                            CPHVALPS=CPHSPLEN+1; /*SET END*/      0482 01571000
         B     @RC00480                                            0482 01572000
@RF00480 LA    @10,1                                               0482 01573000
         AH    @10,CPHSPLEN                                        0482 01574000
         ST    @10,CPHVALPS                                        0482 01575000
*                  END;        /*END CHAR ALPHA*/                  0483 01576000
*                  ELSE        /*NOT ALPHA*/                       0484 01577000
*                     CPHVALFC='1'B;         /* SET ERROR INDICATOR*/   01578000
         B     @RC00478                                            0484 01579000
@RF00478 OI    CPHVALFC,B'00010000'                                0484 01580000
*            END;               /*END CK FIRST CHAR ALPHA*/        0485 01581000
*            ELSE;              /*NOT CK FIRST ALPHA*/             0486 01582000
@RF00474 DS    0H                                                  0487 01583000
*                             /*VAL CK ENTRY*/                     0487 01584000
*VALLOOP:                                                          0487 01585000
*       DO CPHVALPS=CPHVALPS TO CPHSPLEN WHILE(CPHVALFG='00'X);    0487 01586000
@RC00474 DS    0H                                                  0487 01587000
VALLOOP  L     @10,CPHVALPS                                        0487 01588000
         B     @DE00487                                            0487 01589000
@DL00487 CLI   CPHVALFG,X'00'                                      0487 01590000
         BNE   @DC00487                                            0487 01591000
*          /* TRT CHAR. AT CPHVALPS USING CPHVTRTB TO FIND TYPE   */    01592000
*         GPR02F=0;             /*INIT TRT CODE REG TO 0*/         0488 01593000
         SLR   GPR02F,GPR02F                                       0488 01594000
*         TRT(CPHSPPTR->CPHSBYTE(CPHVALPS),CPHVTRTB);              0489 01595000
         L     @10,CPHSPPTR                                        0489 01596000
         AL    @10,CPHVALPS                                        0489 01597000
         AL    @10,@CF00260                                        0489 01598000
         TRT   CPHSBYTE(1,@10),CPHVTRTB                            0489 01599000
*         IF GPR02F=1           /*IS CHAR ALPHA*/                  0490 01600000
*             THEN DO;          /*YES*/                            0490 01601000
         C     GPR02F,@CF00048                                     0490 01602000
         BNE   @RF00490                                            0490 01603000
*                IF CPHFUNNU='1'B /*CHECK NUMERIC*/                0492 01604000
*                   THEN                /*YES*/                    0492 01605000
         TM    CPHFUNNU,B'01000000'                                0492 01606000
         BNO   @RF00492                                            0492 01607000
*                      CPHVALNU='1'B;   /*SET ERROR FLG*/          0493 01608000
         OI    CPHVALNU,B'01000000'                                0493 01609000
*                    ELSE;          /*NOT CHECK NUMERIC*/          0494 01610000
@RF00492 DS    0H                                                  0495 01611000
*             END;                 /*END CHAR ALPHA*/              0495 01612000
*             ELSE DO;           /*CHAR NOT ALPHA*/                0496 01613000
         B     @RC00490                                            0496 01614000
@RF00490 DS    0H                                                  0497 01615000
*                IF GPR02F=2  /*IS CHAR NUMERIC*/                  0497 01616000
*                   THEN;       /*YES*/                            0497 01617000
         C     GPR02F,@CF00313                                     0497 01618000
         BE    @RT00497                                            0497 01619000
*                   ELSE        /*NO*/                             0499 01620000
*                      CPHVALAN='1'B; /*SET ERROR FLG*/            0499 01621000
         OI    CPHVALAN,B'00100000'                                0499 01622000
*             END;              /*END CHAR NOT ALPHA*/             0500 01623000
@RT00497 DS    0H                                                  0501 01624000
*       END VALLOOP;                                               0501 01625000
@RC00490 LA    @10,1                                               0501 01626000
         AL    @10,CPHVALPS                                        0501 01627000
         ST    @10,CPHVALPS                                        0501 01628000
@DE00487 CH    @10,CPHSPLEN                                        0501 01629000
         BNH   @DL00487                                            0501 01630000
@DC00487 DS    0H                                                  0502 01631000
*     END;                                                         0502 01632000
*   GPR01P=CPHVCK01;           /* RESTORE REG01              @ZA27161*/ 01633000
@RT00470 L     GPR01P,CPHVCK01                                     0503 01634000
*   GPR02P=CPHVCK02;           /* RESTORE REG02              @ZA27161*/ 01635000
         L     GPR02P,CPHVCK02                                     0504 01636000
*   /*CMZPEND*/                                                    0505 01637000
*   VALR: DO;                                                      0505 01638000
VALR     DS    0H                                                  0506 01639000
*   GPR14P = CMZX9910;                                             0506 01640000
*                                                                  0506 01641000
         LR    GPR14P,CMZX9910                                     0506 01642000
*   END VALR;                                                      0507 01643000
*   END CPHVALCK;                                                  0508 01644000
@EL00009 DS    0H                                                  0508 01645000
@EF00009 DS    0H                                                  0508 01646000
@ER00009 BR    @14                                                 0508 01647000
*/********************************************************************/ 01648000
*/*                                                                  */ 01649000
*/*       CPHSUBSC: SUBPARAMETER SCAN ROUTINE                        */ 01650000
*/*                                                                  */ 01651000
*/********************************************************************/ 01652000
*                                                                  0509 01653000
*   CPHSUBSC: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0509 01654000
CPHSUBSC DS    0H                                                  0510 01655000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0510 01656000
*    DO;                                                           0510 01657000
*   CMZX9902 = GPR14P;                                             0511 01658000
*                                                                  0511 01659000
         LR    CMZX9902,GPR14P                                     0511 01660000
*   END ;                  /*@ZA27161*/                            0512 01661000
*   CPHSCN00=GPR00P;           /* SAVE REG00                 @ZA27161*/ 01662000
         ST    GPR00P,CPHSCN00                                     0513 01663000
*   CPHSCN02=GPR02P;           /* SAVE REG02                 @ZA27161*/ 01664000
         ST    GPR02P,CPHSCN02                                     0514 01665000
*                              /*  REG1= ADDR OF PARM STRING*/     0515 01666000
*   CPHTCHAR=0;                /*   SET CPHTCHAR = X'00'*/         0515 01667000
         MVI   CPHTCHAR,X'00'                                      0515 01668000
*                 /* RESET CPHENDSP, CPHSPLEN, CPHSBPAR, AND CPHSPPTR*/ 01669000
*   CPHSPLEN=0;                                                    0516 01670000
         SLR   @10,@10                                             0516 01671000
         STH   @10,CPHSPLEN                                        0516 01672000
*   CPHSPPTR=0;                                                    0517 01673000
         ST    @10,CPHSPPTR                                        0517 01674000
*   CPHENDSP='0'B;                                                 0518 01675000
         NI    CPHENDSP,B'11110111'                                0518 01676000
*   CPHSBPAR=0;                                                    0519 01677000
         STH   @10,CPHSBPAR                                        0519 01678000
*   IF GPR01P->CPHSBYTE(1)=' '&CPHKWSCN='1'B /*BLNK IN SCAN*/      0520 01679000
*      THEN                  /*YES BLANK WHILE SCANNING*/          0520 01680000
         CLI   CPHSBYTE(GPR01P),C' '                               0520 01681000
         BNE   @RF00520                                            0520 01682000
         TM    CPHKWSCN,B'00100000'                                0520 01683000
         BNO   @RF00520                                            0520 01684000
*         CPHENDST='1'B;     /*SET STRING EXHAUSTED*/              0521 01685000
         OI    CPHENDST,B'00010000'                                0521 01686000
*      ELSE DO;              /*NOT STRING EXHAUSTED*/              0522 01687000
         B     @RC00520                                            0522 01688000
@RF00520 DS    0H                                                  0523 01689000
*SS1:                                                              0523 01690000
*         IF CPHKWSCN='1'B   /*ARE WE SCANNING A KWD*/             0523 01691000
*            THEN            /*YES*/                               0523 01692000
SS1      TM    CPHKWSCN,B'00100000'                                0523 01693000
         BNO   @RF00523                                            0523 01694000
*               CPHKWPTR=GPR01P; /*PUT STRING PTR IN WKPTR*/       0524 01695000
         ST    GPR01P,CPHKWPTR                                     0524 01696000
*            ELSE;               /*NOT KWD SCAN*/                  0525 01697000
@RF00523 DS    0H                                                  0526 01698000
*SS5:                                       /*DOWHILE NOT END OF SCAN*/ 01699000
*         DO WHILE(CPHENDSP='0'B&CPHSYNER='0'B)|(CPHLSTSP='1'B &   0526 01700000
*             CPHSLIST='1'B&CPHSYNER='0'B);                        0526 01701000
SS5      B     @DE00526                                            0526 01702000
@DL00526 DS    0H                                                  0527 01703000
*            /*ICALL(CPHSBTRT)*/                                   0527 01704000
*             DO;                                                  0527 01705000
*            CALL CPHSBTRT;                                        0528 01706000
*                                                                  0528 01707000
         BAL   @14,CPHSBTRT                                        0528 01708000
*            END ;          /* TRT:SCAN TO NEXT DELIMITER*/        0529 01709000
*            CPHTCHAR=GPR02F;       /*SAVE CHAR CODE IN TCHAR*/    0530 01710000
         STC   GPR02F,CPHTCHAR                                     0530 01711000
*                  /* CALCULATE TABLE INDEX FROM CPHTCHAR & CPHLCHAR*/  01712000
*            CPHSCNPT=CPHSCNTB(CPHTCHAR+1,CPHLCHAR+1);             0531 01713000
         SLR   @10,@10                                             0531 01714000
         IC    @10,CPHTCHAR                                        0531 01715000
         MH    @10,@CH00080                                        0531 01716000
         SLR   @09,@09                                             0531 01717000
         IC    @09,CPHLCHAR                                        0531 01718000
         ALR   @10,@09                                             0531 01719000
         SLA   @10,2                                               0531 01720000
         L     @10,CPHSCNTB(@10)                                   0531 01721000
         ST    @10,CPHSCNPT                                        0531 01722000
*             /*ICALL(CPHSCNPT)FLOWS(CPHCSP01,CPHCSP02,CPHCSP03,CPHCSP0 01723000
*,CPHCSP05,CPHCSP06,CPHCSP07,CPHCSP08,CPHCSP13,CPHCSP09,CPHCSP10,CPHCSP 01724000
*2,CPHCSP14)*/                                                     0532 01725000
*              DO;                                                 0532 01726000
*             DCL CMZP0157 BASED ENTRY VALRG (CPHCSP01,CPHCSP02,CPHCSP0 01727000
*,CPHCSP04,CPHCSP05,CPHCSP06,CPHCSP07,CPHCSP08,CPHCSP13,CPHCSP09,CPHCSP 01728000
*0,CPHCSP12,CPHCSP14) ;                                            0533 01729000
*             CALL CPHSCNPT-> CMZP0157 ;                           0534 01730000
*                                                                  0534 01731000
         LR    @15,@10                                             0534 01732000
         BALR  @14,@15                                             0534 01733000
*             END ;  /* GO TO SUB-PROCESSOR*/                      0535 01734000
*            IF CPHSYNER='1'B|CPHTCHAR=6 /*SYNTAX ERR OR BLNK CHAR*/    01735000
*               THEN;                /*YES*/                       0536 01736000
         TM    CPHSYNER,B'00000001'                                0536 01737000
         BO    @RT00536                                            0536 01738000
         CLI   CPHTCHAR,6                                          0536 01739000
         BE    @RT00536                                            0536 01740000
*               ELSE DO;             /*NOT SYNTAX OR BLANK*/       0538 01741000
*                  CPHLCHAR=CPHTCHAR; /*PUT CURRENT  CHAR IN LAST CHAR* 01742000
         MVC   CPHLCHAR(1),CPHTCHAR                                0539 01743000
*                  GPR01P=GPR01P+1;   /*INCREMENT STRING PTR*/     0540 01744000
         AL    GPR01P,@CF00048                                     0540 01745000
*                END;                 /*END NOT SYNTAX OR BLANK*/  0541 01746000
*         END SS5;                    /*END DO WHILE*/             0542 01747000
@RT00536 DS    0H                                                  0542 01748000
@DE00526 TM    CPHENDSP,B'00001001'                                0542 01749000
         BZ    @DL00526                                            0542 01750000
         TM    CPHLSTSP,B'00000110'                                0542 01751000
         BNO   @DC00526                                            0542 01752000
         TM    CPHSYNER,B'00000001'                                0542 01753000
         BZ    @DL00526                                            0542 01754000
@DC00526 DS    0H                                                  0543 01755000
*      END;                           /*END NOT STRING EXHAUSTED*/ 0543 01756000
*/*******************************************************************/  01757000
*/*                                                                 */  01758000
*/*      CPHSBTRT: TRANSLATE AND TEST ROUTINE                       */  01759000
*/*                                                                 */  01760000
*/*******************************************************************/  01761000
*                                                                  0544 01762000
*   CPHSBTRT: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0544 01763000
         B     @PB00011                                            0544 01764000
CPHSBTRT DS    0H                                                  0545 01765000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0545 01766000
*    DO;                                                           0545 01767000
*   CMZX9911 = GPR14P;                                             0546 01768000
*                                                                  0546 01769000
         LR    CMZX9911,GPR14P                                     0546 01770000
*   END ;                                                          0547 01771000
*   CPHCONT='1'B;               /* SET CONTINUE FLAG*/             0548 01772000
         OI    CPHCONT,B'01000000'                                 0548 01773000
*   CPHTRTSV=GPR01P;              /*    SAVE START PTR   */        0549 01774000
         ST    GPR01P,CPHTRTSV                                     0549 01775000
*   GPR03P=GPR01P;               /*  SET R3 = INPUT PARM STRING PTR*/   01776000
         LR    GPR03P,GPR01P                                       0550 01777000
*TR3:                                                              0551 01778000
*   DO WHILE(CPHCONT='1'B);       /* SCAN 256 BYTES FOR A DELIMITER*/   01779000
TR3      B     @DE00551                                            0551 01780000
@DL00551 DS    0H                                                  0552 01781000
*      GPR02F=0;                  /*CLEAR OUTPUT CODE REG*/        0552 01782000
         SLR   GPR02F,GPR02F                                       0552 01783000
*      TRT(GPR03P->CPHSBYTE(1:256),CPHTRTB);     /*TRANSLATE AND TEST*/ 01784000
         TRT   CPHSBYTE(256,GPR03P),CPHTRTB                        0553 01785000
*                                    /* NOTE: DELIMITERS ARE  )(,= */   01786000
*                              /*QUOTE OR BLANK CODE IN REG2 AFTER TRT* 01787000
*       IF GPR02F^=0                  /*  DELIMITER FOUND */       0554 01788000
*          THEN                         /*YES*/                    0554 01789000
         LTR   GPR02F,GPR02F                                       0554 01790000
         BZ    @RF00554                                            0554 01791000
*             CPHCONT='0'B;            /*RESET CONTINUE FLAG*/     0555 01792000
         NI    CPHCONT,B'10111111'                                 0555 01793000
*          ELSE                        /*NO DELIMITER YET*/        0556 01794000
*             GPR03P=GPR03P+256;     /* PREPARE TO SCAN NEXT 256 BYTES* 01795000
         B     @RC00554                                            0556 01796000
@RF00554 AL    GPR03P,@CF00150                                     0556 01797000
*   END TR3;                          /*END DO WHILE*/             0557 01798000
@RC00554 DS    0H                                                  0557 01799000
@DE00551 TM    CPHCONT,B'01000000'                                 0557 01800000
         BO    @DL00551                                            0557 01801000
*                                      /* R1= DELIM ADDR*/         0558 01802000
*   GPR04P=GPR01P-CPHTRTSV;             /*SET R4 = LEN OF SUB PARM*/    01803000
         L     @10,CPHTRTSV                                        0558 01804000
         LR    GPR04P,GPR01P                                       0558 01805000
         SLR   GPR04P,@10                                          0558 01806000
*   GPR03P=CPHTRTSV;                     /* RESTORE START PTR*/    0559 01807000
         LR    GPR03P,@10                                          0559 01808000
*   IF GPR01P^=CPHTRTSV                  /*WAS DELIMITER FIRST CHAR*/   01809000
*      THEN DO;                          /*NO*/                    0560 01810000
         CR    GPR01P,@10                                          0560 01811000
         BE    @RF00560                                            0560 01812000
*         GPR02F=0;                      /*SET NON DILIMITER CODE*/     01813000
         SLR   GPR02F,GPR02F                                       0562 01814000
*         GPR01P=GPR01P-1;           /*DECREMENT STRING PTR*/      0563 01815000
         BCTR  GPR01P,0                                            0563 01816000
*      END;                           /*END NOT FIRST SCANNED*/    0564 01817000
*      ELSE;                          /*YES FIRST CHAR WAS DELIMITER*/  01818000
@RF00560 DS    0H                                                  0566 01819000
*   /*CMZPEND*/                                                    0566 01820000
*   TR5: DO;                                                       0566 01821000
TR5      DS    0H                                                  0567 01822000
*   GPR14P = CMZX9911;                                             0567 01823000
*                                                                  0567 01824000
         LR    GPR14P,CMZX9911                                     0567 01825000
*   END TR5;                                                       0568 01826000
*   END CPHSBTRT;                                                  0569 01827000
@EL00011 DS    0H                                                  0569 01828000
@EF00011 DS    0H                                                  0569 01829000
@ER00011 BR    @14                                                 0569 01830000
*/********************************************************************/ 01831000
*/*                                                                  */ 01832000
*/*        CPHCSP01: STORE SUBPARM PTR & LENGTH                      */ 01833000
*/*                                                                  */ 01834000
*/********************************************************************/ 01835000
*                                                                  0570 01836000
*   CPHCSP01: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0570 01837000
CPHCSP01 DS    0H                                                  0571 01838000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0571 01839000
*    DO;                                                           0571 01840000
*   CMZX9912 = GPR14P;                                             0572 01841000
*                                                                  0572 01842000
         LR    CMZX9912,GPR14P                                     0572 01843000
*   END ;                                                          0573 01844000
*   IF CPHSPPTR^=0           /* START SUBPARM PTR ALREADY SET*/    0574 01845000
*       THEN;                /* YES */                             0574 01846000
         L     @10,CPHSPPTR                                        0574 01847000
         LTR   @10,@10                                             0574 01848000
         BNZ   @RT00574                                            0574 01849000
*       ELSE                 /*NO*/                                0576 01850000
*          CPHSPPTR=GPR03P;  /*SAVE PARM STRING PTR*/              0576 01851000
         ST    GPR03P,CPHSPPTR                                     0576 01852000
*   CPHSPLEN=GPR04P+CPHSPLEN;  /*ADD LENGTH OF SUB PARM */         0577 01853000
@RT00574 LR    @10,GPR04P                                          0577 01854000
         AH    @10,CPHSPLEN                                        0577 01855000
         STH   @10,CPHSPLEN                                        0577 01856000
*    /*CMZPEND*/                                                   0578 01857000
*     DO;                                                          0578 01858000
*    GPR14P = CMZX9912;                                            0579 01859000
*                                                                  0579 01860000
         LR    GPR14P,CMZX9912                                     0579 01861000
*    END ;                                                         0580 01862000
*    END CPHCSP01;                                                 0581 01863000
@EL00012 DS    0H                                                  0581 01864000
@EF00012 DS    0H                                                  0581 01865000
@ER00012 BR    @14                                                 0581 01866000
*/********************************************************************/ 01867000
*/*                                                                  */ 01868000
*/*        CPHCSP02: END OF KEYWORD A                                */ 01869000
*/*                                                                  */ 01870000
*/********************************************************************/ 01871000
*                                                                  0582 01872000
*   CPHCSP02: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0582 01873000
CPHCSP02 DS    0H                                                  0583 01874000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0583 01875000
*    DO;                                                           0583 01876000
*   CMZX9913 = GPR14P;                                             0584 01877000
*                                                                  0584 01878000
         LR    CMZX9913,GPR14P                                     0584 01879000
*   END ;                                                          0585 01880000
*   IF CPHKWSCN='1'B                  /*KWD SCAN ON*/              0586 01881000
*      THEN DO;                       /*YES */                     0586 01882000
         TM    CPHKWSCN,B'00100000'                                0586 01883000
         BNO   @RF00586                                            0586 01884000
*         CPHKWLEN=CPHSPLEN;          /*SET KWD LEN = SUB PARM LEN*/    01885000
         LH    @10,CPHSPLEN                                        0588 01886000
         STH   @10,CPHKWLEN                                        0588 01887000
*         CPHKWSCN='0'B;              /*   RESET KWD SCAN FLAG*/   0589 01888000
*         CPHENDSP='1'B;               /*    SET END OF SUBPARM*/  0590 01889000
         OI    CPHENDSP,B'00001000'                                0590 01890000
         NI    CPHKWSCN,B'11011111'                                0590 01891000
*      END;                            /*END KWD SCAN*/            0591 01892000
*      ELSE DO;                        /*NOT KWD SCAN*/            0592 01893000
         B     @RC00586                                            0592 01894000
@RF00586 DS    0H                                                  0593 01895000
*P2A:                                                              0593 01896000
*         IF CPHPARCT=0                /*BALANCED PARENS*/         0593 01897000
*            THEN                      /* YES */                   0593 01898000
P2A      LH    @10,CPHPARCT                                        0593 01899000
         LTR   @10,@10                                             0593 01900000
         BNZ   @RF00593                                            0593 01901000
*               CPHSYNER='1'B;         /*SET SYNTAX ERROR*/        0594 01902000
         OI    CPHSYNER,B'00000001'                                0594 01903000
*            ELSE                      /*NOT BALANCED PARENS*/     0595 01904000
*               CPHSPLEN=CPHSPLEN+1;   /*UP SUB PARM LEN BY 1*/    0595 01905000
         B     @RC00593                                            0595 01906000
@RF00593 LA    @10,1                                               0595 01907000
         AH    @10,CPHSPLEN                                        0595 01908000
         STH   @10,CPHSPLEN                                        0595 01909000
*      END;                            /*END NOT KWD SCAN*/        0596 01910000
@RC00593 DS    0H                                                  0597 01911000
*   /*CMZPEND*/                                                    0597 01912000
*   P2C: DO;                                                       0597 01913000
@RC00586 DS    0H                                                  0597 01914000
P2C      DS    0H                                                  0598 01915000
*   GPR14P = CMZX9913;                                             0598 01916000
*                                                                  0598 01917000
         LR    GPR14P,CMZX9913                                     0598 01918000
*   END P2C;                                                       0599 01919000
*   END CPHCSP02;                                                  0600 01920000
@EL00013 DS    0H                                                  0600 01921000
@EF00013 DS    0H                                                  0600 01922000
@ER00013 BR    @14                                                 0600 01923000
*/********************************************************************/ 01924000
*/*                                                                  */ 01925000
*/*         CPHCSP03: CHECK FOR LAST SUBPARM                         */ 01926000
*/*                                                                  */ 01927000
*/********************************************************************/ 01928000
*                                                                  0601 01929000
*   CPHCSP03: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0601 01930000
CPHCSP03 DS    0H                                                  0602 01931000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0602 01932000
*    DO;                                                           0602 01933000
*   CMZX9914 = GPR14P;                                             0603 01934000
*                                                                  0603 01935000
         LR    CMZX9914,GPR14P                                     0603 01936000
*   END ;                                                          0604 01937000
*    /*ICALL(CPHCSP13)*/                                           0605 01938000
*     DO;                                                          0605 01939000
*    CALL CPHCSP13;                                                0606 01940000
*                                                                  0606 01941000
         BAL   @14,CPHCSP13                                        0606 01942000
*    END ;                 /*CHECK FOR END OF SUBPARM*/            0607 01943000
*   IF CPHPARCT=0                     /*BALANCED PARENS*/          0608 01944000
*      THEN                           /* YES */                    0608 01945000
         LH    @10,CPHPARCT                                        0608 01946000
         LTR   @10,@10                                             0608 01947000
         BNZ   @RF00608                                            0608 01948000
*         CPHLSTSP='1'B;              /*SET LAST SUB PARM */       0609 01949000
         OI    CPHLSTSP,B'00000100'                                0609 01950000
*      ELSE;                          /*NOT LAST SUB PARM*/        0610 01951000
@RF00608 DS    0H                                                  0611 01952000
*   /*CMZPEND*/                                                    0611 01953000
*   P3A: DO;                                                       0611 01954000
P3A      DS    0H                                                  0612 01955000
*   GPR14P = CMZX9914;                                             0612 01956000
*                                                                  0612 01957000
         LR    GPR14P,CMZX9914                                     0612 01958000
*   END P3A;                                                       0613 01959000
*   END CPHCSP03;                                                  0614 01960000
@EL00014 DS    0H                                                  0614 01961000
@EF00014 DS    0H                                                  0614 01962000
@ER00014 BR    @14                                                 0614 01963000
*/********************************************************************/ 01964000
*/*                                                                  */ 01965000
*/*     CPHCSP04: END OF SUBPARM A                                   */ 01966000
*/*                                                                  */ 01967000
*/********************************************************************/ 01968000
*                                                                  0615 01969000
*   CPHCSP04: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0615 01970000
CPHCSP04 DS    0H                                                  0616 01971000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0616 01972000
*    DO;                                                           0616 01973000
*   CMZX9915 = GPR14P;                                             0617 01974000
*                                                                  0617 01975000
         LR    CMZX9915,GPR14P                                     0617 01976000
*   END ;                                                          0618 01977000
*   IF CPHPARCT=0               /*BALANCED PARENS*/                0619 01978000
*      THEN                      /* YES */                         0619 01979000
         LH    @10,CPHPARCT                                        0619 01980000
         LTR   @10,@10                                             0619 01981000
         BNZ   @RF00619                                            0619 01982000
*         CPHSYNER='1'B;         /*SET SYNTAX ERROR*/              0620 01983000
         OI    CPHSYNER,B'00000001'                                0620 01984000
*      ELSE DO;                  /*NOT BALANCED PARENS*/           0621 01985000
         B     @RC00619                                            0621 01986000
@RF00619 DS    0H                                                  0622 01987000
*          /*ICALL(CPHCSP13)*/                                     0622 01988000
*           DO;                                                    0622 01989000
*          CALL CPHCSP13;                                          0623 01990000
*                                                                  0623 01991000
         BAL   @14,CPHCSP13                                        0623 01992000
*          END ;       /*  CHECK FOR END OF SUBPARM*/              0624 01993000
*         /*ICALL(CPHCSP01)*/                                      0625 01994000
*         P4A: DO;                                                 0625 01995000
P4A      DS    0H                                                  0626 01996000
*         CALL CPHCSP01;                                           0626 01997000
*                                                                  0626 01998000
         BAL   @14,CPHCSP01                                        0626 01999000
*         END P4A;            /*  STORE PTR AND LENGTH*/           0627 02000000
*      END;                        /*END NOT BALANCED PARENS*/     0628 02001000
*   /*CMZPEND*/                                                    0629 02002000
*   P4B: DO;                                                       0629 02003000
@RC00619 DS    0H                                                  0629 02004000
P4B      DS    0H                                                  0630 02005000
*   GPR14P = CMZX9915;                                             0630 02006000
*                                                                  0630 02007000
         LR    GPR14P,CMZX9915                                     0630 02008000
*   END P4B;                                                       0631 02009000
*   END CPHCSP04;                                                  0632 02010000
@EL00015 DS    0H                                                  0632 02011000
@EF00015 DS    0H                                                  0632 02012000
@ER00015 BR    @14                                                 0632 02013000
*/********************************************************************/ 02014000
*/*                                                                  */ 02015000
*/*      CPHCSP05: END OF SUBPARM LIST                               */ 02016000
*/*                                                                  */ 02017000
*/********************************************************************/ 02018000
*                                                                  0633 02019000
*   CPHCSP05: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0633 02020000
CPHCSP05 DS    0H                                                  0634 02021000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0634 02022000
*    DO;                                                           0634 02023000
*   CMZX9916 = GPR14P;                                             0635 02024000
*                                                                  0635 02025000
         LR    CMZX9916,GPR14P                                     0635 02026000
*   END ;                                                          0636 02027000
*   IF CPHPARCT=0                 /*PARENS. BALANCED*/             0637 02028000
*      THEN                           /* YES */                    0637 02029000
         LH    @10,CPHPARCT                                        0637 02030000
         LTR   @10,@10                                             0637 02031000
         BNZ   @RF00637                                            0637 02032000
*         CPHSLIST='0'B;               /* RESET SUBPARM. LIST FLAG*/    02033000
         NI    CPHSLIST,B'11111101'                                0638 02034000
*      ELSE;                           /* NO */                    0639 02035000
@RF00637 DS    0H                                                  0640 02036000
*   /*CMZPEND*/                                                    0640 02037000
*   P5A: DO;                                                       0640 02038000
P5A      DS    0H                                                  0641 02039000
*   GPR14P = CMZX9916;                                             0641 02040000
*                                                                  0641 02041000
         LR    GPR14P,CMZX9916                                     0641 02042000
*   END P5A;                                                       0642 02043000
*   END CPHCSP05;                                                  0643 02044000
@EL00016 DS    0H                                                  0643 02045000
@EF00016 DS    0H                                                  0643 02046000
@ER00016 BR    @14                                                 0643 02047000
*/********************************************************************/ 02048000
*/*                                                                  */ 02049000
*/*         CPHCSP06: INCREASE PAREN COUNTER                         */ 02050000
*/*                                                                  */ 02051000
*/********************************************************************/ 02052000
*                                                                  0644 02053000
*   CPHCSP06: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0644 02054000
CPHCSP06 DS    0H                                                  0645 02055000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0645 02056000
*    DO;                                                           0645 02057000
*   CMZX9917 = GPR14P;                                             0646 02058000
*                                                                  0646 02059000
         LR    CMZX9917,GPR14P                                     0646 02060000
*   END ;                                                          0647 02061000
*   IF CPHPARCT>0&CPHSBPAR=0 /*PAREN CNT GT 0 AND SUB PAREN CNT 0*/     02062000
*      THEN DO;               /* YES */                            0648 02063000
         LH    @10,CPHPARCT                                        0648 02064000
         SLR   @09,@09                                             0648 02065000
         CR    @10,@09                                             0648 02066000
         BNH   @RF00648                                            0648 02067000
         CH    @09,CPHSBPAR                                        0648 02068000
         BNE   @RF00648                                            0648 02069000
*         CPHSBPAR=CPHPARCT;  /*SET SUBPARM START PARENS. COUNT*/  0650 02070000
         STH   @10,CPHSBPAR                                        0650 02071000
*         CPHSPPTR=GPR01P;       /* FLAG LEFT PARENTHESIS AS START */   02072000
         ST    GPR01P,CPHSPPTR                                     0651 02073000
*                                /*    OF SUBPARM                    */ 02074000
*      END;                   /*END PAREN CNT GT 0*/               0652 02075000
*      ELSE;                  /*PAREN CNT NOT GT 0 */              0653 02076000
@RF00648 DS    0H                                                  0654 02077000
*   CPHPARCT=CPHPARCT+1;       /* INCREASE PAREN COUNTER BY 1*/    0654 02078000
         LA    @10,1                                               0654 02079000
         AH    @10,CPHPARCT                                        0654 02080000
         STH   @10,CPHPARCT                                        0654 02081000
*   CPHSLIST='1'B;             /*   SET SUBPARM LIST FLAG*/        0655 02082000
         OI    CPHSLIST,B'00000010'                                0655 02083000
*    /*CMZPEND*/                                                   0656 02084000
*     DO;                                                          0656 02085000
*    GPR14P = CMZX9917;                                            0657 02086000
*                                                                  0657 02087000
         LR    GPR14P,CMZX9917                                     0657 02088000
*    END ;                                                         0658 02089000
*    END CPHCSP06;                                                 0659 02090000
@EL00017 DS    0H                                                  0659 02091000
@EF00017 DS    0H                                                  0659 02092000
@ER00017 BR    @14                                                 0659 02093000
*/********************************************************************/ 02094000
*/*                                                                  */ 02095000
*/*         CPHCSP07: END OF SUBPARM C                               */ 02096000
*/*                                                                  */ 02097000
*/********************************************************************/ 02098000
*                                                                  0660 02099000
*   CPHCSP07: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0660 02100000
CPHCSP07 DS    0H                                                  0661 02101000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0661 02102000
*    DO;                                                           0661 02103000
*   CMZX9918 = GPR14P;                                             0662 02104000
*                                                                  0662 02105000
         LR    CMZX9918,GPR14P                                     0662 02106000
*   END ;                                                          0663 02107000
*    /*ICALL(CPHCSP08)*/                                           0664 02108000
*     DO;                                                          0664 02109000
*    CALL CPHCSP08;                                                0665 02110000
*                                                                  0665 02111000
         BAL   @14,CPHCSP08                                        0665 02112000
*    END ;                /* CHECK FOR BALANCED PARENS*/           0666 02113000
*   IF CPHSYNER='1'B                 /*SYNTAX ERROR*/              0667 02114000
*      THEN ;                        /* YES */                     0667 02115000
         TM    CPHSYNER,B'00000001'                                0667 02116000
         BO    @RT00667                                            0667 02117000
*      ELSE                          /* NO */                      0669 02118000
*         /*ICALL(CPHCSP03)*/                                      0669 02119000
*          DO;                                                     0669 02120000
*         CALL CPHCSP03;                                           0670 02121000
*                                                                  0670 02122000
         BAL   @14,CPHCSP03                                        0670 02123000
*         END ;           /*   CHECK FOR LAST SUB-PARM*/           0671 02124000
*   /*CMZPEND*/                                                    0672 02125000
*   P7A: DO;                                                       0672 02126000
@RT00667 DS    0H                                                  0672 02127000
P7A      DS    0H                                                  0673 02128000
*   GPR14P = CMZX9918;                                             0673 02129000
*                                                                  0673 02130000
         LR    GPR14P,CMZX9918                                     0673 02131000
*   END P7A;                                                       0674 02132000
*   END CPHCSP07;                                                  0675 02133000
@EL00018 DS    0H                                                  0675 02134000
@EF00018 DS    0H                                                  0675 02135000
@ER00018 BR    @14                                                 0675 02136000
*/********************************************************************/ 02137000
*/*                                                                  */ 02138000
*/*          CPHCSP08: DECREASE PAREN COUNTER                        */ 02139000
*/*                                                                  */ 02140000
*/********************************************************************/ 02141000
*                                                                  0676 02142000
*   CPHCSP08: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0676 02143000
CPHCSP08 DS    0H                                                  0677 02144000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0677 02145000
*    DO;                                                           0677 02146000
*   CMZX9919 = GPR14P;                                             0678 02147000
*                                                                  0678 02148000
         LR    CMZX9919,GPR14P                                     0678 02149000
*   END ;                                                          0679 02150000
*   CPHPARCT=CPHPARCT-1;      /*DECREMENT PAREN CNT*/              0680 02151000
         LH    @10,CPHPARCT                                        0680 02152000
         BCTR  @10,0                                               0680 02153000
         STH   @10,CPHPARCT                                        0680 02154000
*   IF CPHPARCT<0            /*CPHPARCT LESS THAN 0*/              0681 02155000
*      THEN                   /* YES */                            0681 02156000
         LTR   @10,@10                                             0681 02157000
         BNM   @RF00681                                            0681 02158000
*         CPHSYNER='1'B;      /*SET SYNTAX ERROR*/                 0682 02159000
         OI    CPHSYNER,B'00000001'                                0682 02160000
*      ELSE;                  /* NO */                             0683 02161000
@RF00681 DS    0H                                                  0684 02162000
*   IF CPHSBPAR=0             /*SUB PAREN CNT 0*/                  0684 02163000
*      THEN DO;               /*YES */                             0684 02164000
         SLR   @10,@10                                             0684 02165000
         CH    @10,CPHSBPAR                                        0684 02166000
         BNE   @RF00684                                            0684 02167000
*         CPHENDSP='1'B;        /*SET END OF SUBPARM */            0686 02168000
         OI    CPHENDSP,B'00001000'                                0686 02169000
*         IF CPHSPPTR=0       /*SUB PARM PTR 0 */                  0687 02170000
*            THEN;            /*YES */                             0687 02171000
         C     @10,CPHSPPTR                                        0687 02172000
         BE    @RT00687                                            0687 02173000
*            ELSE             /* NO */                             0689 02174000
*               CPHSPLEN=GPR01P-CPHSPPTR;  /*SET TOTAL SUBPARM LENGTH*/ 02175000
         LR    @10,GPR01P                                          0689 02176000
         SL    @10,CPHSPPTR                                        0689 02177000
         STH   @10,CPHSPLEN                                        0689 02178000
*      END;                   /*END SUB PAREN CNT 0*/              0690 02179000
*      ELSE DO;               /*SUB PAREN CNT NOT 0*/              0691 02180000
         B     @RC00684                                            0691 02181000
@RF00684 DS    0H                                                  0692 02182000
*         IF CPHSBPAR=CPHPARCT    /*SUBPARM START COUNT EQUAL CURRENT*/ 02183000
*            THEN DO;                                              0692 02184000
         CLC   CPHSBPAR(2),CPHPARCT                                0692 02185000
         BNE   @RF00692                                            0692 02186000
*               CPHSBPAR=0;     /*SET SUB APREN CNT TO 0*/         0694 02187000
         SLR   @10,@10                                             0694 02188000
         STH   @10,CPHSBPAR                                        0694 02189000
*               CPHENDSP='1'B;    /* SET END OF SUBPARM*/          0695 02190000
         OI    CPHENDSP,B'00001000'                                0695 02191000
*               CPHSPLEN=GPR01P-CPHSPPTR+1; /*SET TOTAL SUBPARM LENGTH* 02192000
         LR    @10,GPR01P                                          0696 02193000
         SL    @10,CPHSPPTR                                        0696 02194000
         AL    @10,@CF00048                                        0696 02195000
         STH   @10,CPHSPLEN                                        0696 02196000
*            END;                 /*END SUB PARM STRT =CURRENT*/   0697 02197000
*            ELSE;                /*NOT  EQUAL*/                   0698 02198000
@RF00692 DS    0H                                                  0699 02199000
*      END;                    /*END SUB PAREN CNT NOT 0*/         0699 02200000
*   /*CMZPEND*/                                                    0700 02201000
*   P8A: DO;                                                       0700 02202000
@RC00684 DS    0H                                                  0700 02203000
P8A      DS    0H                                                  0701 02204000
*   GPR14P = CMZX9919;                                             0701 02205000
*                                                                  0701 02206000
         LR    GPR14P,CMZX9919                                     0701 02207000
*   END P8A;                                                       0702 02208000
*   END CPHCSP08;                                                  0703 02209000
@EL00019 DS    0H                                                  0703 02210000
@EF00019 DS    0H                                                  0703 02211000
@ER00019 BR    @14                                                 0703 02212000
*/********************************************************************/ 02213000
*/*                                                                  */ 02214000
*/*         CPHCSP09: SCAN TO NEXT QUOTE                             */ 02215000
*/*                                                                  */ 02216000
*/********************************************************************/ 02217000
*                                                                  0704 02218000
*   CPHCSP09: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0704 02219000
CPHCSP09 DS    0H                                                  0705 02220000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0705 02221000
*    DO;                                                           0705 02222000
*   CMZX9921 = GPR14P;                                             0706 02223000
*                                                                  0706 02224000
         LR    CMZX9921,GPR14P                                     0706 02225000
*   END ;                                                          0707 02226000
*   GPR03P=GPR03P+1;          /* INCREASE PARM STRING PTR BY 1*/   0708 02227000
         AL    GPR03P,@CF00048                                     0708 02228000
*   CPHSPPTR=GPR03P;             /*   STORE IN CPHSPPTR*/          0709 02229000
         ST    GPR03P,CPHSPPTR                                     0709 02230000
*   GPR02F=0;                       /* INITIALIZE TRT CODE REGISTER  */ 02231000
         SLR   GPR02F,GPR02F                                       0710 02232000
*   DO WHILE GPR02F^=5;            /*SCAN FOR QUOTE*/              0711 02233000
         B     @DE00711                                            0711 02234000
@DL00711 DS    0H                                                  0712 02235000
*     /*ICALL(CPHSBTRT)*/                                          0712 02236000
*     P9A: DO;                                                     0712 02237000
P9A      DS    0H                                                  0713 02238000
*     CALL CPHSBTRT;                                               0713 02239000
*                                                                  0713 02240000
         BAL   @14,CPHSBTRT                                        0713 02241000
*     END P9A;            /*   TRT:SCAN TO NEXT DELIMITER*/        0714 02242000
*   END;                            /*END DO WHILE*/               0715 02243000
@DE00711 C     GPR02F,@CF00120                                     0715 02244000
         BNE   @DL00711                                            0715 02245000
*   CPHSPLEN=GPR01P-CPHSPPTR;      /*SAVE SUB PARM LENGTH*/        0716 02246000
         LR    @10,GPR01P                                          0716 02247000
         SL    @10,CPHSPPTR                                        0716 02248000
         STH   @10,CPHSPLEN                                        0716 02249000
*   CPHTCHAR=5;                   /*SET TCHAR = QUOTE CODE*/       0717 02250000
         MVI   CPHTCHAR,X'05'                                      0717 02251000
*   /*CMZPEND*/                                                    0718 02252000
*   P9B: DO;                                                       0718 02253000
P9B      DS    0H                                                  0719 02254000
*   GPR14P = CMZX9921;                                             0719 02255000
*                                                                  0719 02256000
         LR    GPR14P,CMZX9921                                     0719 02257000
*   END P9B;                                                       0720 02258000
*   END CPHCSP09;                                                  0721 02259000
@EL00020 DS    0H                                                  0721 02260000
@EF00020 DS    0H                                                  0721 02261000
@ER00020 BR    @14                                                 0721 02262000
*/********************************************************************/ 02263000
*/*                                                                  */ 02264000
*/*       CPHCSP10: END OF KEYWORD B OR SUBPARM                      */ 02265000
*/*                                                                  */ 02266000
*/********************************************************************/ 02267000
*                                                                  0722 02268000
*   CPHCSP10: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0722 02269000
CPHCSP10 DS    0H                                                  0723 02270000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0723 02271000
*    DO;                                                           0723 02272000
*   CMZX9922 = GPR14P;                                             0724 02273000
*                                                                  0724 02274000
         LR    CMZX9922,GPR14P                                     0724 02275000
*   END ;                                                          0725 02276000
*    /*ICALL(CPHCSP03)*/                                           0726 02277000
*     DO;                                                          0726 02278000
*    CALL CPHCSP03;                                                0727 02279000
*                                                                  0727 02280000
         BAL   @14,CPHCSP03                                        0727 02281000
*    END ;              /* CHECK FOR LAST SUBPARM */               0728 02282000
*   IF CPHLSTSP='1'B               /*LAST SUB PARM*/               0729 02283000
*      THEN DO;                    /* YES */                       0729 02284000
         TM    CPHLSTSP,B'00000100'                                0729 02285000
         BNO   @RF00729                                            0729 02286000
*         CPHENDSP='1'B;            /*   SET END OF SUBPARM */     0731 02287000
*         CPHKWSCN='0'B;            /*    RESET KWD SCAN FLAG*/    0732 02288000
         OI    CPHENDSP,B'00001000'                                0732 02289000
         NI    CPHKWSCN,B'11011111'                                0732 02290000
*         CPHKWLEN=CPHSPLEN;        /*SET KWD LENGTH*/             0733 02291000
         LH    @10,CPHSPLEN                                        0733 02292000
         STH   @10,CPHKWLEN                                        0733 02293000
*      END;                         /*END LAST SUB PARM*/          0734 02294000
*      ELSE DO;                     /*NOT LAST SUB PARM*/          0735 02295000
         B     @RC00729                                            0735 02296000
@RF00729 DS    0H                                                  0736 02297000
*         IF CPHKWSCN='1'B | CPHTCHAR=6 /*IN KWD SCAN OR BLAKN CHAR*/   02298000
*            THEN                 /* YES */                        0736 02299000
         TM    CPHKWSCN,B'00100000'                                0736 02300000
         BO    @RT00736                                            0736 02301000
         CLI   CPHTCHAR,6                                          0736 02302000
         BNE   @RF00736                                            0736 02303000
@RT00736 DS    0H                                                  0737 02304000
*               CPHSYNER='1'B;    /*SET SYNTAX ERROR*/             0737 02305000
         OI    CPHSYNER,B'00000001'                                0737 02306000
*            ELSE;                /*NOT KWD SCAN MODE*/            0738 02307000
@RF00736 DS    0H                                                  0739 02308000
*      END;                        /*END NOT LAST SUB PARM*/       0739 02309000
*   /*CMZPEND*/                                                    0740 02310000
*   P10B: DO;                                                      0740 02311000
@RC00729 DS    0H                                                  0740 02312000
P10B     DS    0H                                                  0741 02313000
*   GPR14P = CMZX9922;                                             0741 02314000
*                                                                  0741 02315000
         LR    GPR14P,CMZX9922                                     0741 02316000
*   END P10B;                                                      0742 02317000
*   END CPHCSP10;                                                  0743 02318000
@EL00021 DS    0H                                                  0743 02319000
@EF00021 DS    0H                                                  0743 02320000
@ER00021 BR    @14                                                 0743 02321000
*/********************************************************************/ 02322000
*/*                                                                  */ 02323000
*/*          CPHCSP12: SYNTAX ERROR                                  */ 02324000
*/*                                                                  */ 02325000
*/********************************************************************/ 02326000
*                                                                  0744 02327000
*   CPHCSP12: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0744 02328000
CPHCSP12 DS    0H                                                  0745 02329000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0745 02330000
*    DO;                                                           0745 02331000
*   CMZX9923 = GPR14P;                                             0746 02332000
*                                                                  0746 02333000
         LR    CMZX9923,GPR14P                                     0746 02334000
*   END ;                                                          0747 02335000
*   CPHSYNER='1'B;                       /*SET SYNTAX ERROR FLAG*/ 0748 02336000
         OI    CPHSYNER,B'00000001'                                0748 02337000
*    /*CMZPEND*/                                                   0749 02338000
*     DO;                                                          0749 02339000
*    GPR14P = CMZX9923;                                            0750 02340000
*                                                                  0750 02341000
         LR    GPR14P,CMZX9923                                     0750 02342000
*    END ;                                                         0751 02343000
*    END CPHCSP12;                                                 0752 02344000
@EL00022 DS    0H                                                  0752 02345000
@EF00022 DS    0H                                                  0752 02346000
@ER00022 BR    @14                                                 0752 02347000
*/********************************************************************/ 02348000
*/*                                                                  */ 02349000
*/*           CPHCSP13: CHECK FOR END OF SUBPARM                     */ 02350000
*/*                                                                  */ 02351000
*/********************************************************************/ 02352000
*                                                                  0753 02353000
*   CPHCSP13: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0753 02354000
CPHCSP13 DS    0H                                                  0754 02355000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0754 02356000
*    DO;                                                           0754 02357000
*   CMZX9920 = GPR14P;                                             0755 02358000
*                                                                  0755 02359000
         ST    GPR14P,CMZX9920                                     0755 02360000
*   END ;                                                          0756 02361000
*   IF CPHSBPAR=0                   /*IN NESTED SUB PARM*/         0757 02362000
*      THEN                          /* NO */                      0757 02363000
         LH    @10,CPHSBPAR                                        0757 02364000
         LTR   @10,@10                                             0757 02365000
         BNZ   @RF00757                                            0757 02366000
*         CPHENDSP='1'B;             /*SET END OF SUBPARM*/        0758 02367000
         OI    CPHENDSP,B'00001000'                                0758 02368000
*      ELSE;                         /*IN NESTED SUB PARM*/        0759 02369000
@RF00757 DS    0H                                                  0760 02370000
*   /*CMZPEND*/                                                    0760 02371000
*   P13A: DO;                                                      0760 02372000
P13A     DS    0H                                                  0761 02373000
*   GPR14P = CMZX9920;                                             0761 02374000
*                                                                  0761 02375000
         L     GPR14P,CMZX9920                                     0761 02376000
*   END P13A;                                                      0762 02377000
*   END CPHCSP13;                                                  0763 02378000
@EL00023 DS    0H                                                  0763 02379000
@EF00023 DS    0H                                                  0763 02380000
@ER00023 BR    @14                                                 0763 02381000
*/********************************************************************/ 02382000
*/*                                                                  */ 02383000
*/*        CPHCSP14: END OF LAST SUBPARM LIST                        */ 02384000
*/*                                                                  */ 02385000
*/********************************************************************/ 02386000
*                                                                  0764 02387000
*   CPHCSP14: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0764 02388000
CPHCSP14 DS    0H                                                  0765 02389000
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0765 02390000
*    DO;                                                           0765 02391000
*   CMZX9924 = GPR14P;                                             0766 02392000
*                                                                  0766 02393000
         LR    CMZX9924,GPR14P                                     0766 02394000
*   END ;                                                          0767 02395000
*   CPHSLIST='0'B;                   /*  RESET SUBPARM LIST FLAG */     02396000
         NI    CPHSLIST,B'11111101'                                0768 02397000
*    /*ICALL(CPHCSP03)*/                                           0769 02398000
*     DO;                                                          0769 02399000
*    CALL CPHCSP03;                                                0770 02400000
*                                                                  0770 02401000
         BAL   @14,CPHCSP03                                        0770 02402000
*    END ;                 /*  CHECK FOR END OF SUBPARMS*/         0771 02403000
*   IF CPHPARCT=0                  /*   BALANCED PARENS.*/         0772 02404000
*      THEN;                       /* YES */                       0772 02405000
         LH    @10,CPHPARCT                                        0772 02406000
         LTR   @10,@10                                             0772 02407000
         BZ    @RT00772                                            0772 02408000
*      ELSE                         /*NOT BALANCED PARENS*/        0774 02409000
*         CPHSYNER='1'B;             /* SET SYNTAX ERROR FLAG*/    0774 02410000
         OI    CPHSYNER,B'00000001'                                0774 02411000
*   /*CMZPEND*/                                                    0775 02412000
*   P14A: DO;                                                      0775 02413000
@RT00772 DS    0H                                                  0775 02414000
P14A     DS    0H                                                  0776 02415000
*   GPR14P = CMZX9924;                                             0776 02416000
*                                                                  0776 02417000
         LR    GPR14P,CMZX9924                                     0776 02418000
*   END P14A;                                                      0777 02419000
*   END CPHCSP14;                                                  0778 02420000
@EL00024 DS    0H                                                  0778 02421000
@EF00024 DS    0H                                                  0778 02422000
@ER00024 BR    @14                                                 0778 02423000
@PB00024 DS    0H                                                  0779 02424000
*   GPR00P=CPHSCN00;           /* RESTORE REG00              @ZA27161*/ 02425000
         L     GPR00P,CPHSCN00                                     0779 02426000
*   GPR02P=CPHSCN02;           /* RESTORE REG02              @ZA27161*/ 02427000
         L     GPR02P,CPHSCN02                                     0780 02428000
*   /*CMZPEND*/                                                    0781 02429000
*    DO;                                                           0781 02430000
*   GPR14P = CMZX9902;                                             0782 02431000
*                                                                  0782 02432000
         LR    GPR14P,CMZX9902                                     0782 02433000
*   END ;                                                          0783 02434000
*   END CPHSUBSC;                                                  0784 02435000
*                                                                  0784 02436000
@EL00010 DS    0H                                                  0784 02437000
@EF00010 DS    0H                                                  0784 02438000
@ER00010 BR    @14                                                 0784 02439000
@PB00010 DS    0H                                                  0785 02440000
*/* TPEPILOG   */                                                  0785 02441000
* GEN (PRINT OFF);                                                 0785 02442000
*                                                                  0785 02443000
         PRINT OFF                                                      02444000
* GEN (PRINT ON);                                                  0786 02445000
         PRINT ON                                                       02446000
*/* END OF TPEPILOG */                                             0787 02447000
*/* ATDSPLY   INVOKED. */                                          0787 02448000
*/********************************************************************/ 02449000
*/* THE FOLLOWING ATBUILD INCLUSIONS HAVE BEEN MADE IN THIS          */ 02450000
*/* COMPILATION:                                                     */ 02451000
*/*             ISTPHROA                                             */ 02452000
*/********************************************************************/ 02453000
*/* END OF ATDSPLY. */                                             0787 02454000
*  /*CMZPEND*/                                                     0787 02455000
*   DO;                                                            0787 02456000
*  DCL CMZX9902 REG(6) PTR(31);                                    0788 02457000
*  DCL CMZX9903 REG(6) PTR(31);                                    0789 02458000
*  DCL CMZX9904 REG(5) PTR(31);                                    0790 02459000
*  DCL CMZX9905 REG(5) PTR(31);                                    0791 02460000
*  DCL CMZX9906 REG(5) PTR(31);                                    0792 02461000
*  DCL CMZX9907 REG(5) PTR(31);                                    0793 02462000
*  DCL CMZX9908 REG(5) PTR(31);                                    0794 02463000
*  DCL CMZX9909 REG(5) PTR(31);                                    0795 02464000
*  DCL CMZX9910 REG(6) PTR(31);                                    0796 02465000
*  DCL CMZX9911 REG(12) PTR(31);                                   0797 02466000
*  DCL CMZX9912 REG(12) PTR(31);                                   0798 02467000
*  DCL CMZX9913 REG(7) PTR(31);                                    0799 02468000
*  DCL CMZX9914 REG(12) PTR(31);                                   0800 02469000
*  DCL CMZX9915 REG(7) PTR(31);                                    0801 02470000
*  DCL CMZX9916 REG(7) PTR(31);                                    0802 02471000
*  DCL CMZX9917 REG(7) PTR(31);                                    0803 02472000
*  DCL CMZX9918 REG(7) PTR(31);                                    0804 02473000
*  DCL CMZX9919 REG(12) PTR(31);                                   0805 02474000
*  /*PROC0012 INSUFFICIENT LINK REGISTERS*/                        0806 02475000
*  DCL CMZX9920 PTR(31);                                           0806 02476000
*  DCL CMZX9921 REG(7) PTR(31);                                    0807 02477000
*  DCL CMZX9922 REG(7) PTR(31);                                    0808 02478000
*  DCL CMZX9923 REG(7) PTR(31);                                    0809 02479000
*  DCL CMZX9924 REG(7) PTR(31);                                    0810 02480000
*  RFY (GPR00P,GPR01P,GPR02P,GPR03P,GPR04P,GPR05P,GPR06P,GPR07P,GPR12P, 02481000
*PR14P,GPR15P) UNRSTD;                                             0811 02482000
*  END ;                                                           0812 02483000
*  END ISTINCPH;                                                   0813 02484000
@EL00001 DS    0H                                                  0813 02485000
@EF00001 DS    0H                                                  0813 02486000
@ER00001 LM    @14,@12,12(@13)                                     0813 02487000
         BR    @14                                                 0813 02488000
@DATA    DS    0H                                                       02489000
@CH00080 DC    H'7'                                                     02490000
@SM00427 MVC   CPHARGUM(0),CPHSBYTE(@09)                                02491000
@SM00434 MVC   PHRF34SP-12(0,@10),CPHSBYTE(@08)                         02492000
@SM00436 MVC   PHRF34SP-12(0,@09),CPHSBYTE(@08)                         02493000
@SM00439 MVC   0(0,@09),CPHSBYTE(@08)                                   02494000
@SM00442 MVC   CPHSUBVL(0),CPHFUNBT(@10)                                02495000
@DATD    DSECT                                                          02496000
         DS    0F                                                       02497000
@TF00001 DS    F                                                        02498000
ISTINCPH CSECT                                                          02499000
         DS    0F                                                       02500000
@CF00048 DC    F'1'                                                     02501000
@CF00313 DC    F'2'                                                     02502000
@CF00193 DC    F'3'                                                     02503000
@CF00128 DC    F'4'                                                     02504000
@CF00120 DC    F'5'                                                     02505000
@CF00046 DC    F'8'                                                     02506000
@CF00271 DC    F'9'                                                     02507000
@CF00237 DC    F'12'                                                    02508000
@CH00237 EQU   @CF00237+2                                               02509000
@CF00297 DC    F'255'                                                   02510000
@CF00150 DC    F'256'                                                   02511000
@CF00433 DC    F'-4'                                                    02512000
@CF00438 DC    F'-2'                                                    02513000
@CF00260 DC    F'-1'                                                    02514000
@DATD    DSECT                                                          02515000
         DS    0D                                                       02516000
CPHTABAD DS    A                                                        02517000
CPHSCNPT DS    A                                                        02518000
CPHOANDX DS    F                                                        02519000
CPHOALIM DS    F                                                        02520000
CPHINSVA DS    A                                                        02521000
CPHSCN00 DS    A                                                        02522000
CPHSCN02 DS    A                                                        02523000
CPHVCK01 DS    A                                                        02524000
CPHVCK02 DS    A                                                        02525000
CPHTABSV DS    A                                                        02526000
CPHKWPTR DS    A                                                        02527000
CPHTRTSV DS    A                                                        02528000
CPHVALPS DS    A                                                        02529000
CPHSPPTR DS    A                                                        02530000
CMZX9920 DS    A                                                        02531000
CPHSPLEN DS    H                                                        02532000
CPHKWLEN DS    H                                                        02533000
CPHPARCT DS    H                                                        02534000
CPHSBPAR DS    H                                                        02535000
CPHENCTR DS    H                                                        02536000
CPHTCHAR DS    FL1                                                      02537000
CPHLCHAR DS    FL1                                                      02538000
         DS    0D                                                       02539000
@TS00001 DS    CL8                                                      02540000
CPHSUBVL DS    CL5                                                      02541000
         ORG   CPHSUBVL                                                 02542000
CPHVALBT DS    BL1                                                      02543000
         ORG   CPHVALBT                                                 02544000
@NM00005 DS    BL1                                                      02545000
CPHFUNNU EQU   CPHVALBT+0                                               02546000
CPHFUNAN EQU   CPHVALBT+0                                               02547000
CPHFUNFC EQU   CPHVALBT+0                                               02548000
CPHFUNNO EQU   CPHVALBT+0                                               02549000
         ORG   CPHSUBVL+1                                               02550000
CPHVALUE DS    AL4                                                      02551000
         ORG   CPHSUBVL+5                                               02552000
CPHARGUM DS    CL8                                                      02553000
CPHDECHX DS    CL3                                                      02554000
CPHVALFG DS    BL1                                                      02555000
         ORG   CPHVALFG                                                 02556000
@NM00006 DS    BL1                                                      02557000
CPHVALNU EQU   CPHVALFG+0                                               02558000
CPHVALAN EQU   CPHVALFG+0                                               02559000
CPHVALFC EQU   CPHVALFG+0                                               02560000
@NM00007 EQU   CPHVALFG+0                                               02561000
         ORG   CPHVALFG+1                                               02562000
CPHFLAGS DS    BL1                                                      02563000
         ORG   CPHFLAGS                                                 02564000
@NM00008 DS    BL1                                                      02565000
CPHCONT  EQU   CPHFLAGS+0                                               02566000
CPHKWSCN EQU   CPHFLAGS+0                                               02567000
CPHENDST EQU   CPHFLAGS+0                                               02568000
CPHENDSP EQU   CPHFLAGS+0                                               02569000
CPHLSTSP EQU   CPHFLAGS+0                                               02570000
CPHSLIST EQU   CPHFLAGS+0                                               02571000
CPHSYNER EQU   CPHFLAGS+0                                               02572000
         ORG   CPHFLAGS+1                                               02573000
CPHFLAG2 DS    BL1                                                      02574000
         ORG   CPHFLAG2                                                 02575000
CPHOFLOW DS    BL1                                                      02576000
CPHFUNER EQU   CPHFLAG2+0                                               02577000
CPHARGNF EQU   CPHFLAG2+0                                               02578000
@NM00009 EQU   CPHFLAG2+0                                               02579000
         ORG   CPHFLAG2+1                                               02580000
ISTINCPH CSECT                                                          02581000
         DS    0F                                                       02582000
@SIZDATD DC    AL1(0)                                                   02583000
         DC    AL3(@ENDDATD-@DATD)                                      02584000
         DS    0D                                                       02585000
@CC00269 DC    C'00000000'                                              02586000
@CC00294 EQU   @CC00269                                                 02587000
CPHLOCK  DC    AL1(0)                                                   02588000
         DS    CL3                                                      02589000
STATICFD DS    CL116                                                    02590000
CPHSCNTB DC    AL4(CPHCSP13)                                            02591000
         DC    AL4(CPHCSP01)                                            02592000
         DC    AL4(CPHCSP01)                                            02593000
         DC    AL4(CPHCSP01)                                            02594000
         DC    AL4(CPHCSP12)                                            02595000
         DC    AL4(CPHCSP12)                                            02596000
         DC    AL4(CPHCSP01)                                            02597000
         DC    AL4(CPHCSP02)                                            02598000
         DC    AL4(CPHCSP12)                                            02599000
         DC    AL4(CPHCSP12)                                            02600000
         DC    AL4(CPHCSP12)                                            02601000
         DC    AL4(CPHCSP12)                                            02602000
         DC    AL4(CPHCSP12)                                            02603000
         DC    AL4(CPHCSP12)                                            02604000
         DC    AL4(CPHCSP10)                                            02605000
         DC    AL4(CPHCSP10)                                            02606000
         DC    AL4(CPHCSP04)                                            02607000
         DC    AL4(CPHCSP04)                                            02608000
         DC    AL4(CPHCSP05)                                            02609000
         DC    AL4(CPHCSP13)                                            02610000
         DC    AL4(CPHCSP12)                                            02611000
         DC    AL4(CPHCSP12)                                            02612000
         DC    AL4(CPHCSP06)                                            02613000
         DC    AL4(CPHCSP06)                                            02614000
         DC    AL4(CPHCSP06)                                            02615000
         DC    AL4(CPHCSP12)                                            02616000
         DC    AL4(CPHCSP12)                                            02617000
         DC    AL4(CPHCSP12)                                            02618000
         DC    AL4(CPHCSP07)                                            02619000
         DC    AL4(CPHCSP12)                                            02620000
         DC    AL4(CPHCSP07)                                            02621000
         DC    AL4(CPHCSP12)                                            02622000
         DC    AL4(CPHCSP08)                                            02623000
         DC    AL4(CPHCSP08)                                            02624000
         DC    AL4(CPHCSP12)                                            02625000
         DC    AL4(CPHCSP12)                                            02626000
         DC    AL4(CPHCSP09)                                            02627000
         DC    AL4(CPHCSP09)                                            02628000
         DC    AL4(CPHCSP09)                                            02629000
         DC    AL4(CPHCSP12)                                            02630000
         DC    AL4(CPHCSP12)                                            02631000
         DC    AL4(CPHCSP12)                                            02632000
         DC    AL4(CPHCSP10)                                            02633000
         DC    AL4(CPHCSP10)                                            02634000
         DC    AL4(CPHCSP10)                                            02635000
         DC    AL4(CPHCSP12)                                            02636000
         DC    AL4(CPHCSP14)                                            02637000
         DC    AL4(CPHCSP10)                                            02638000
         DC    AL4(CPHCSP13)                                            02639000
ISTINCPH CSECT                                                          02640000
CPHTRTB    DC    XL256'00'          INIT ALL CODES TO NON-DELIMITER     02641000
            ORG   CPHTRTB+C' '       RE-ORIGIN TO BLANK                 02642000
            DC    X'06'              SCAN CODE = '06'X                  02643000
            ORG   CPHTRTB+C','       RE-ORIGIN TO COMMA                 02644000
            DC    X'02'              SCAN CODE = '02'X                  02645000
            ORG   CPHTRTB+C'('       RE-ORIGIN TO LEFT PARENTHESIS      02646000
            DC    X'03'              SCAN CODE = '03'X                  02647000
            ORG   CPHTRTB+C')'       RE-ORIGIN TO RIGHT PARENTHESIS     02648000
            DC    X'04'              SCAN CODE = '04'X                  02649000
            ORG   CPHTRTB+C''''      RE-ORIGIN TO QUOTE MARK            02650000
            DC    X'05'              SCAN CODE = '05'X                  02651000
            ORG   CPHTRTB+C'='       RE-ORIGIN TO EQUAL SIGN            02652000
            DC    X'01'              SCAN CODE = '01'X                  02653000
            ORG             ,        CONTINUE WITH STORAGE DEFINITION   02654000
ISTINCPH CSECT                                                          02655000
CPHVTRTB  DC    XL256'04'           DEFAULT CODE = '04'X                02656000
           ORG   CPHVTRTB+C'A'       RE-ORIGIN TO ALPHABETICS           02657000
           DC    9X'01'              A-I CODE = '01'X                   02658000
           ORG   CPHVTRTB+C'J'       RE-ORIGIN TO NEXT ALPHA GROUP      02659000
           DC    9X'01'              J-R CODE = '01'X                   02660000
           ORG   CPHVTRTB+C'S'       RE-ORIGIN TO LAST ALPHA GROUP      02661000
           DC    8X'01'              S-Z CODE = '01'X                   02662000
           ORG   CPHVTRTB+C'$'       RE-ORIGIN TO NATIONAL CHARACTERS   02663000
           DC    X'01'               ALPHA CODE = '01'X                 02664000
           ORG   CPHVTRTB+C'@'       ANOTHER NATIONAL CHARACTER         02665000
           DC    X'01'               ALPHA CODE = '01'X                 02666000
           ORG   CPHVTRTB+X'7B'      RE-ORIGIN TO POUND SIGN            02667000
           DC    X'01'               ALPHA CODE = '01'X                 02668000
           ORG   CPHVTRTB+C'0'       RE-ORIGIN TO NUMERICS              02669000
           DC    10X'02'             NUMERIC CODE = '02'X               02670000
           ORG         ,             CONTINUE STORAGE DEFINITION        02671000
@DATD    DSECT                                                          02672000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02673000
@ENDDATD EQU   *                                                        02674000
ISTINCPH CSECT                                                          02675000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02676000
@01      EQU   01                                                       02677000
@02      EQU   02                                                       02678000
@03      EQU   03                                                       02679000
@04      EQU   04                                                       02680000
@05      EQU   05                                                       02681000
@06      EQU   06                                                       02682000
@07      EQU   07                                                       02683000
@08      EQU   08                                                       02684000
@09      EQU   09                                                       02685000
@10      EQU   10                                                       02686000
@11      EQU   11                                                       02687000
@12      EQU   12                                                       02688000
@13      EQU   13                                                       02689000
@14      EQU   14                                                       02690000
@15      EQU   15                                                       02691000
GPR05P   EQU   @05                                                      02692000
GPR06P   EQU   @06                                                      02693000
GPR07P   EQU   @07                                                      02694000
GPR12P   EQU   @12                                                      02695000
GPR14P   EQU   @14                                                      02696000
GPR00F   EQU   @00                                                      02697000
GPR00P   EQU   @00                                                      02698000
GPR01P   EQU   @01                                                      02699000
GPR02F   EQU   @02                                                      02700000
GPR02P   EQU   @02                                                      02701000
GPR03P   EQU   @03                                                      02702000
GPR04P   EQU   @04                                                      02703000
GPR15F   EQU   @15                                                      02704000
GPR15P   EQU   @15                                                      02705000
GPR13P   EQU   @13                                                      02706000
CMZX9904 EQU   @05                                                      02707000
CMZX9905 EQU   @05                                                      02708000
CMZX9906 EQU   @05                                                      02709000
CMZX9907 EQU   @05                                                      02710000
CMZX9908 EQU   @05                                                      02711000
CMZX9909 EQU   @05                                                      02712000
CMZX9903 EQU   @06                                                      02713000
CMZX9910 EQU   @06                                                      02714000
CMZX9902 EQU   @06                                                      02715000
CMZX9911 EQU   @12                                                      02716000
CMZX9912 EQU   @12                                                      02717000
CMZX9913 EQU   @07                                                      02718000
CMZX9914 EQU   @12                                                      02719000
CMZX9915 EQU   @07                                                      02720000
CMZX9916 EQU   @07                                                      02721000
CMZX9917 EQU   @07                                                      02722000
CMZX9918 EQU   @07                                                      02723000
CMZX9919 EQU   @12                                                      02724000
CMZX9921 EQU   @07                                                      02725000
CMZX9922 EQU   @07                                                      02726000
CMZX9923 EQU   @07                                                      02727000
CMZX9924 EQU   @07                                                      02728000
GPR01F   EQU   @01                                                      02729000
GPR03F   EQU   @03                                                      02730000
GPR04F   EQU   @04                                                      02731000
GPR05F   EQU   @05                                                      02732000
GPR06F   EQU   @06                                                      02733000
GPR07F   EQU   @07                                                      02734000
GPR12F   EQU   @12                                                      02735000
GPR14F   EQU   @14                                                      02736000
ISTPHROA EQU   0                                                        02737000
PHROALEN EQU   ISTPHROA                                                 02738000
PHROADTA EQU   ISTPHROA+4                                               02739000
CPHKWDTB EQU   0                                                        02740000
CPHENTNO EQU   CPHKWDTB                                                 02741000
CPHENTLN EQU   CPHKWDTB+2                                               02742000
CPHTABEN EQU   CPHKWDTB+4                                               02743000
CPHKEYWD EQU   CPHTABEN                                                 02744000
CPHFUNBT EQU   CPHTABEN+8                                               02745000
CPHPNTBK EQU   0                                                        02746000
CPHSBVAL EQU   CPHPNTBK                                                 02747000
CPHSBTAB EQU   CPHPNTBK+4                                               02748000
CPHSBYTE EQU   0                                                        02749000
CMZP0157 EQU   0                                                        02750000
PHRFN1OA EQU   PHROADTA                                                 02751000
PHRF1SAD EQU   PHRFN1OA                                                 02752000
PHRF1SLN EQU   PHRFN1OA+4                                               02753000
PHRFN2OA EQU   PHROADTA                                                 02754000
PHRF2NVL EQU   PHRFN2OA                                                 02755000
PHRF2VAL EQU   PHRFN2OA+4                                               02756000
PHRF2FLG EQU   PHRF2VAL+2                                               02757000
PHRF34OA EQU   PHROADTA                                                 02758000
PHRF34NS EQU   PHRF34OA                                                 02759000
PHRF34EN EQU   PHRF34OA+4                                               02760000
PHRF34VF EQU   PHRF34EN                                                 02761000
PHRF34SL EQU   PHRF34EN+2                                               02762000
PHRF34SP EQU   PHRF34EN+4                                               02763000
PHRFN5OA EQU   PHROADTA                                                 02764000
PHRF5NSP EQU   PHRFN5OA                                                 02765000
PHRF5ENT EQU   PHRFN5OA+4                                               02766000
PHRF5VF  EQU   PHRF5ENT                                                 02767000
PHRF5SL  EQU   PHRF5ENT+2                                               02768000
PHRF5SPT EQU   PHRF5ENT+4                                               02769000
PHRFN7OA EQU   PHROADTA                                                 02770000
PHRF7NSP EQU   PHRFN7OA                                                 02771000
PHRF7NUM EQU   PHRFN7OA+4                                               02772000
PHRFN8OA EQU   PHROADTA                                                 02773000
PHRF8NSP EQU   PHRFN8OA                                                 02774000
PHRF8ENT EQU   PHRFN8OA+4                                               02775000
PHRF8FLG EQU   PHRF8ENT                                                 02776000
PHRF8DFT EQU   PHRF8FLG                                                 02777000
PHRF8NUM EQU   PHRF8ENT+1                                               02778000
CPHF2VAL EQU   PHRF2VAL                                                 02779000
CPHSBVL1 EQU   CPHSUBVL                                                 02780000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02781000
@NM00004 EQU   PHRF8FLG                                                 02782000
@NM00003 EQU   PHRF5ENT+1                                               02783000
@NM00002 EQU   PHRF34EN+1                                               02784000
PHRF2MSK EQU   PHRF2VAL+3                                               02785000
PHRF2MV  EQU   PHRF2FLG                                                 02786000
PHRF2OFF EQU   PHRF2FLG                                                 02787000
PHRF2ON  EQU   PHRF2FLG                                                 02788000
@NM00001 EQU   PHRF2FLG                                                 02789000
PHRF2TR  EQU   PHRF2FLG                                                 02790000
PHRF2CL  EQU   PHRF2FLG                                                 02791000
PHRF2LN  EQU   PHRF2FLG                                                 02792000
PHRF2GP  EQU   PHRF2FLG                                                 02793000
PHRF2OFS EQU   PHRF2VAL                                                 02794000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02795000
@RC00104 EQU   @RC00102                                                 02796000
@RC00107 EQU   @RC00102                                                 02797000
@RC00111 EQU   @RC00102                                                 02798000
@RC00116 EQU   @RC00102                                                 02799000
@RC00121 EQU   @RC00102                                                 02800000
@RC00126 EQU   @RC00102                                                 02801000
@RC00131 EQU   @RC00102                                                 02802000
@RC00301 EQU   @RC00299                                                 02803000
@RC00400 EQU   @RC00399                                                 02804000
@RC00478 EQU   @RC00474                                                 02805000
@PB00009 EQU   @PB00010                                                 02806000
@RT00687 EQU   @RC00684                                                 02807000
@PB00023 EQU   @PB00024                                                 02808000
@PB00008 EQU   @PB00009                                                 02809000
@RC00480 EQU   @RC00478                                                 02810000
@PB00022 EQU   @PB00023                                                 02811000
@PB00007 EQU   @PB00008                                                 02812000
@PB00021 EQU   @PB00022                                                 02813000
@PB00006 EQU   @PB00007                                                 02814000
@PB00020 EQU   @PB00021                                                 02815000
@PB00005 EQU   @PB00006                                                 02816000
@PB00019 EQU   @PB00020                                                 02817000
@PB00004 EQU   @PB00005                                                 02818000
@PB00018 EQU   @PB00019                                                 02819000
@PB00003 EQU   @PB00004                                                 02820000
@PB00017 EQU   @PB00018                                                 02821000
@PB00002 EQU   @PB00003                                                 02822000
@PB00016 EQU   @PB00017                                                 02823000
@RC00075 EQU   @PB00002                                                 02824000
@PB00015 EQU   @PB00016                                                 02825000
@PB00014 EQU   @PB00015                                                 02826000
@PB00013 EQU   @PB00014                                                 02827000
@PB00012 EQU   @PB00013                                                 02828000
@PB00011 EQU   @PB00012                                                 02829000
@RC00520 EQU   @PB00011                                                 02830000
@ENDDATA EQU   *                                                        02831000
         END   ISTINCPH,(C'PLS1705',0603,78009)                         02832000
