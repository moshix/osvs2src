         TITLE 'ISTSC02A,GRAB. ACTIVATES SECONDARY DEVICES FOR OLTS    *00001000
                        '                                               00002000
ISTSC02A CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ISTSC02A  75.177'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         STM   @00,@12,20(@13)                                     0001 00011000
         BALR  @04,0                                               0001 00012000
@PSTART  DS    0H                                                  0001 00013000
         USING @PSTART,@04                                         0001 00014000
*                                                                  0049 00015000
*/********************************************************************/ 00016000
*/*      INITIAL  PREPARATIONS                                       */ 00017000
*/********************************************************************/ 00018000
*                                                                  0050 00019000
*S2AC0010:                                                         0050 00020000
*   ;                                                              0050 00021000
S2AC0010 DS    0H                                                  0051 00022000
*   R15=R13;                        /* SET PTR TO BACKSAVE DSECT     */ 00023000
         LR    R15,R13                                             0051 00024000
*   R13=ADDR(SVESC02A);             /* SET PTR TO SAVE AREA          */ 00025000
         LA    R13,SVESC02A(,WAPTR)                                0052 00026000
*   BACKSAVE(3)=R13;                /* CHAIN SAVE AREA TOGETHER      */ 00027000
         ST    R13,BACKSAVE+8(,R15)                                0053 00028000
*   SVESC02A(2)=R15;                                               0054 00029000
         ST    R15,SVESC02A+4(,WAPTR)                              0054 00030000
*   GRAMAP=R1;                      /* GET PARAMETER LIST            */ 00031000
         LR    GRAMAP,R1                                           0055 00032000
*   AFLAGS='C0'X;                   /* TURN ON FLAGS                 */ 00033000
         MVI   AFLAGS,X'C0'                                        0056 00034000
*/****************************************************************** */ 00035000
*/*      DETERMINE IF ANY DEVICES ARE AVAILABLE                      */ 00036000
*/****************************************************************** */ 00037000
*                                                                  0057 00038000
*   IF $DEVCNTS<3                   /* ANY DEVICES AVAILABLE         */ 00039000
*     THEN                                                         0057 00040000
         LH    @14,$DEVCNTS(,WAPTR)                                0057 00041000
         C     @14,@CF00050                                        0057 00042000
         BNL   @RF00057                                            0057 00043000
*     DO;                           /* IF NO,                        */ 00044000
*       R15=4;                      /* RET. CODE OF4                 */ 00045000
         LA    R15,4                                               0059 00046000
*       GOTO S2AC0190;                                             0060 00047000
         B     S2AC0190                                            0060 00048000
*     END;                                                         0061 00049000
*   IF $DEVCNTS<4                   /* ANY SECONDARY DEVICES         */ 00050000
*     THEN                                                         0062 00051000
@RF00057 LH    @14,$DEVCNTS(,WAPTR)                                0062 00052000
         C     @14,@CF00032                                        0062 00053000
         BNL   @RF00062                                            0062 00054000
*     DO;                           /* IF NO,                        */ 00055000
*       R15=12;                     /* RET CODE OF 12                */ 00056000
         LA    R15,12                                              0064 00057000
*       GOTO S2AC0190;                                             0065 00058000
         B     S2AC0190                                            0065 00059000
*     END;                                                         0066 00060000
*   L3=$GRCNTS+1;                   /* GET ACTIVE GRABBED DEV        */ 00061000
@RF00062 LA    @14,1                                               0067 00062000
         LH    @12,$GRCNTS(,WAPTR)                                 0067 00063000
         LR    L3,@12                                              0067 00064000
         ALR   L3,@14                                              0067 00065000
*   IF $GRCNTS=0                    /* IF COUNT 0.                   */ 00066000
*     THEN                                                         0068 00067000
         LTR   @12,@12                                             0068 00068000
         BNZ   @RF00068                                            0068 00069000
*     L3=$CDEVPT+1;                 /* GET DEV AFTER PRIMARY         */ 00070000
         AH    @14,$CDEVPT(,WAPTR)                                 0069 00071000
         LR    L3,@14                                              0069 00072000
*   L4=$DEVCNTS;                    /* GET HIGHEST COUNT             */ 00073000
@RF00068 LH    L4,$DEVCNTS(,WAPTR)                                 0070 00074000
*/****************************************************************** */ 00075000
*/*      SEARCH DEVICE ENTRY TABLE FOR AN AVAILABLE DEVICE           */ 00076000
*/****************************************************************** */ 00077000
*                                                                  0071 00078000
*S2AC0030:                                                         0071 00079000
*   ;                                                              0071 00080000
S2AC0030 DS    0H                                                  0072 00081000
*   DO I=L3 TO L4;                                                 0072 00082000
         LR    I,L3                                                0072 00083000
         B     @DE00072                                            0072 00084000
@DL00072 DS    0H                                                  0073 00085000
*     IF $NOTDEV(I)='1'B|           /* CHECK FOR REAL DEV            */ 00086000
*         $ACQRED(I)='0'B           /* OR INSURE DEV WAS ACQ         */ 00087000
*       THEN                        /* BR IF NOT DEV OR ACQ          */ 00088000
         LA    @14,68                                              0073 00089000
         LR    @01,I                                               0073 00090000
         MR    @00,@14                                             0073 00091000
         ST    @01,@TF00001                                        0073 00092000
         ALR   @01,WAPTR                                           0073 00093000
         TM    $NOTDEV-68(@01),B'10000000'                         0073 00094000
         BNZ   @RT00073                                            0073 00095000
         TM    $ACQRED-68(@01),B'01000000'                         0073 00096000
         BNO   @RT00073                                            0073 00097000
*       GOTO S2AC0150;                                             0074 00098000
*     IF $LETGO(I)='1'B|$GRABBED(I)='1'B|$PRIMARY(I)='1'B THEN     0075 00099000
         LR    @12,WAPTR                                           0075 00100000
         AL    @12,@TF00001                                        0075 00101000
         TM    $LETGO-68(@12),B'10100001'                          0075 00102000
         BNZ   @RT00075                                            0075 00103000
*       GOTO S2AC0150;              /* CAN THIS DEVICE BE GRABBED NO,   00104000
*                                      IF ANY BIT ON                 */ 00105000
*/****************************************************************** */ 00106000
*/*   DETERMINE IF CALLER WANTED SPECIAL DEVICE CHARACTERISTICS      */ 00107000
*/****************************************************************** */ 00108000
*                                                                  0077 00109000
*     IF $GRABFLG=<3                /* ANY CTRL PARAMETERS           */ 00110000
*       THEN                                                       0077 00111000
         CLI   $GRABFLG(GRAMAP),3                                  0077 00112000
         BNH   @RT00077                                            0077 00113000
*       GOTO S2AC0090;              /* BR IF NO                      */ 00114000
*/****************************************************************** */ 00115000
*/*      REQUEST FOR DIFFERENT CONTROL UNIT ADDRESS                  */ 00116000
*/****************************************************************** */ 00117000
*                                                                  0079 00118000
*     IF $GRABDCH='0'B              /* REQ FOR DIFF CHANNEL          */ 00119000
*       THEN                                                       0079 00120000
         TM    $GRABDCH(GRAMAP),B'10000000'                        0079 00121000
         BZ    @RT00079                                            0079 00122000
*       GOTO S2AC0210;              /* BR IF NO                      */ 00123000
*     IF($DEVUNAD(I)&CHMASK)=($DEVUNAD($CDEVPT)&CHMASK)/* ARE      0081 00124000
*                                      CHANNELS DIFFERENT            */ 00125000
*       THEN                                                       0081 00126000
         L     @12,CHMASK                                          0081 00127000
         L     @06,@TF00001                                        0081 00128000
         L     @06,$DEVUNAD-68(@06,WAPTR)                          0081 00129000
         NR    @06,@12                                             0081 00130000
         MH    @14,$CDEVPT(,WAPTR)                                 0081 00131000
         N     @12,$DEVUNAD-68(@14,WAPTR)                          0081 00132000
         CLR   @06,@12                                             0081 00133000
         BE    @RT00081                                            0081 00134000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00135000
*/****************************************************************** */ 00136000
*/*      REQUEST FOR DIFFERENT CHANNEL UNIT ADDRESS                  */ 00137000
*/****************************************************************** */ 00138000
*                                                                  0083 00139000
*S2AC0050:                                                         0083 00140000
*     ;                                                            0083 00141000
S2AC0050 DS    0H                                                  0084 00142000
*     IF $GRABDCU='0'B              /* REQ. FOR DIFF CONTROL UNIT    */ 00143000
*       THEN                                                       0084 00144000
         TM    $GRABDCU(GRAMAP),B'00100000'                        0084 00145000
         BZ    @RT00084                                            0084 00146000
*       GOTO S2AC0230;              /* BR IF NO                      */ 00147000
*     IF($DEVUNAD(I)&CUMASK)=($DEVUNAD($CDEVPT)&CUMASK)/* ARE CONTROL   00148000
*                                      UNITS DIFF                    */ 00149000
*       THEN                                                       0086 00150000
         L     @14,CUMASK                                          0086 00151000
         LA    @12,68                                              0086 00152000
         LR    @01,I                                               0086 00153000
         MR    @00,@12                                             0086 00154000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0086 00155000
         NR    @06,@14                                             0086 00156000
         MH    @12,$CDEVPT(,WAPTR)                                 0086 00157000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0086 00158000
         CLR   @06,@14                                             0086 00159000
         BE    @RT00086                                            0086 00160000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00161000
*/****************************************************************** */ 00162000
*/*      REQUEST FOR DEFFERENT DEVICE ADDRESS                        */ 00163000
*/****************************************************************** */ 00164000
*                                                                  0088 00165000
*S2AC0070:                                                         0088 00166000
*     ;                                                            0088 00167000
S2AC0070 DS    0H                                                  0089 00168000
*     IF $GRABDDV='0'B              /* REQ FOR DIFF DEVICES          */ 00169000
*       THEN                                                       0089 00170000
         TM    $GRABDDV(GRAMAP),B'00001000'                        0089 00171000
         BZ    @RT00089                                            0089 00172000
*       GOTO S2AC0250;              /* BR IF NO                      */ 00173000
*     IF($DEVUNAD(I)&DVMASK)=($DEVUNAD($CDEVPT)&DVMASK)/* ARE DEVICES   00174000
*                                      DIFFERENT                     */ 00175000
*       THEN                                                       0091 00176000
         L     @14,DVMASK                                          0091 00177000
         LA    @12,68                                              0091 00178000
         LR    @01,I                                               0091 00179000
         MR    @00,@12                                             0091 00180000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0091 00181000
         NR    @06,@14                                             0091 00182000
         MH    @12,$CDEVPT(,WAPTR)                                 0091 00183000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0091 00184000
         CLR   @06,@14                                             0091 00185000
         BE    @RT00091                                            0091 00186000
*       GOTO S2AC0150;              /* BR IF YES                     */ 00187000
*/****************************************************************** */ 00188000
*/*      REQUEST FOR SPECIFIC DEVICE CLASS                           */ 00189000
*/****************************************************************** */ 00190000
*                                                                  0093 00191000
*S2AC0090:                                                         0093 00192000
*     ;                                                            0093 00193000
S2AC0090 DS    0H                                                  0094 00194000
*     IF $GRABCLA='1'B              /* REQ FOR DEV CLASS             */ 00195000
*       THEN                                                       0094 00196000
         TM    $GRABCLA(GRAMAP),B'00000010'                        0094 00197000
         BO    @RT00094                                            0094 00198000
*       GOTO S2AC0110;              /* BR IF NO                      */ 00199000
*     IF $DEVCLAS(I)^=$GRABCLS      /* DO CLASS MATCH                */ 00200000
*       THEN                                                       0096 00201000
         LR    @14,I                                               0096 00202000
         MH    @14,@CH00086                                        0096 00203000
         ALR   @14,WAPTR                                           0096 00204000
         CLC   $DEVCLAS-68(1,@14),$GRABCLS(GRAMAP)                 0096 00205000
         BNE   @RT00096                                            0096 00206000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00207000
*/****************************************************************** */ 00208000
*/*      REQUEST FOR SPECIFIC UNIT TYPE                              */ 00209000
*/****************************************************************** */ 00210000
*                                                                  0098 00211000
*S2AC0110:                                                         0098 00212000
*     ;                                                            0098 00213000
S2AC0110 DS    0H                                                  0099 00214000
*     IF $GRABUNT='1'B              /* REQ. FOR UNIT TYPE            */ 00215000
*       THEN                                                       0099 00216000
         TM    $GRABUNT(GRAMAP),B'00000001'                        0099 00217000
         BO    @RT00099                                            0099 00218000
*       GOTO S2AC0130;              /* BR IF NO                      */ 00219000
*     IF $DEVTYPE(I)^=$GRABTYP      /* DO TYPE MATCH                 */ 00220000
*       THEN                                                       0101 00221000
         LR    @14,I                                               0101 00222000
         MH    @14,@CH00086                                        0101 00223000
         ALR   @14,WAPTR                                           0101 00224000
         CLC   $DEVTYPE-68(1,@14),$GRABTYP(GRAMAP)                 0101 00225000
         BNE   @RT00101                                            0101 00226000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00227000
*/****************************************************************** */ 00228000
*/*      GET GRAB DEVICE ACQUIRED                                    */ 00229000
*/****************************************************************** */ 00230000
*                                                                  0103 00231000
*S2AC0130:                                                         0103 00232000
*     ;                                                            0103 00233000
S2AC0130 DS    0H                                                  0104 00234000
*     CDSPTR=ADDR($DEVTBLE(I));     /* GET CDS ADDR                  */ 00235000
         LR    @14,I                                               0104 00236000
         MH    @14,@CH00086                                        0104 00237000
         LA    @14,$DEVTBLE-68(@14,WAPTR)                          0104 00238000
         ST    @14,CDSPTR                                          0104 00239000
*     GOTO S2AC0170;                /* GO MOVE IN THE CDS INFO       */ 00240000
         B     S2AC0170                                            0105 00241000
*S2AC0150:                                                         0106 00242000
*   END;                                                           0106 00243000
S2AC0150 AL    I,@CF00071                                          0106 00244000
@DE00072 CR    I,L4                                                0106 00245000
         BNH   @DL00072                                            0106 00246000
*   IF L3=3                         /* HAS 2ND LOOP BEEN DONE        */ 00247000
*     THEN                                                         0107 00248000
         C     L3,@CF00050                                         0107 00249000
         BNE   @RF00107                                            0107 00250000
*     DO;                           /* IF YES                        */ 00251000
*       R15=8;                      /* DEVICE CANNOT BE FOUND        */ 00252000
         LA    R15,8                                               0109 00253000
*       GOTO S2AC0190;              /* SET RETURN CODE TO 8          */ 00254000
         B     S2AC0190                                            0110 00255000
*     END;                                                         0111 00256000
*   L4=L3-1;                        /* SET COUNTS FOR 2ND LOOP       */ 00257000
@RF00107 LR    L4,L3                                               0112 00258000
         BCTR  L4,0                                                0112 00259000
*   L3=3;                                                          0113 00260000
         LA    L3,3                                                0113 00261000
*   GOTO S2AC0030;                                                 0114 00262000
*                                                                  0114 00263000
         B     S2AC0030                                            0114 00264000
*/****************************************************************** */ 00265000
*/*      GRAB SUCCESSFUL, MOVE IN CDS INFO INTO CALLERS BUFFER       */ 00266000
*/****************************************************************** */ 00267000
*                                                                  0115 00268000
*S2AC0170:                                                         0115 00269000
*   ;                                                              0115 00270000
S2AC0170 DS    0H                                                  0116 00271000
*   R15=0;                          /* SET RET CODE TO 0             */ 00272000
         SLR   R15,R15                                             0116 00273000
*   $GRCNTS=I;                      /* MOVE IN NEW GRABBED DEV       */ 00274000
         STH   I,$GRCNTS(,WAPTR)                                   0117 00275000
*   $GRABBED(I)='1'B;               /* SET GRAB BIT                  */ 00276000
         LR    @14,I                                               0118 00277000
         MH    @14,@CH00086                                        0118 00278000
         ST    @14,@TF00001                                        0118 00279000
         ALR   @14,WAPTR                                           0118 00280000
         OI    $GRABBED-68(@14),B'00100000'                        0118 00281000
*   INPUTBUF(1:$GRABCNT)=($DEVTBLE(I,1:$GRABCNT));                 0119 00282000
         L     @14,$GRABCDS(,GRAMAP)                               0119 00283000
         SLR   @12,@12                                             0119 00284000
         IC    @12,$GRABCNT(,GRAMAP)                               0119 00285000
         BCTR  @12,0                                               0119 00286000
         LR    @06,WAPTR                                           0119 00287000
         AL    @06,@TF00001                                        0119 00288000
         EX    @12,@SM00410                                        0119 00289000
*   IF $GRABCNT<12                  /* IS COUNT LESS THAN 12         */ 00290000
*     THEN                                                         0120 00291000
         CLI   $GRABCNT(GRAMAP),12                                 0120 00292000
         BNL   @RF00120                                            0120 00293000
*     DO;                           /* IF YES,IS CDS OR EXT. ON      */ 00294000
*       IF $CDSNAME(I)='1'B|$EXTRN(I)='1'B THEN                    0122 00295000
         LR    @14,WAPTR                                           0122 00296000
         AL    @14,@TF00001                                        0122 00297000
         TM    $CDSNAME-68(@14),B'00011000'                        0122 00298000
         BZ    @RF00122                                            0122 00299000
*         R15=20;                   /* IF YES, SET RET CODE TO 14    */ 00300000
         LA    R15,20                                              0123 00301000
*     END;                                                         0124 00302000
@RF00122 DS    0H                                                  0125 00303000
*   IF $GRABCNT<20                  /* IS COUNT LESS THAN 20         */ 00304000
*     THEN                                                         0125 00305000
@RF00120 CLI   $GRABCNT(GRAMAP),20                                 0125 00306000
         BNL   @RF00125                                            0125 00307000
*     DO;                           /* IF YES                        */ 00308000
*       IF $CDSNAME(I)='1'B         /* IS SYMO NAME ON               */ 00309000
*         THEN                                                     0127 00310000
         LR    @14,I                                               0127 00311000
         MH    @14,@CH00086                                        0127 00312000
         ALR   @14,WAPTR                                           0127 00313000
         TM    $CDSNAME-68(@14),B'00001000'                        0127 00314000
         BNO   @RF00127                                            0127 00315000
*         R15=20;                   /* IF YES, RETURN CODE14         */ 00316000
         LA    R15,20                                              0128 00317000
*     END;                                                         0129 00318000
@RF00127 DS    0H                                                  0130 00319000
*S2AC0190:                                                         0130 00320000
*   ;                                                              0130 00321000
@RF00125 DS    0H                                                  0130 00322000
S2AC0190 DS    0H                                                  0131 00323000
*   R13=SVESC02A(2);                                               0131 00324000
         L     R13,SVESC02A+4(,WAPTR)                              0131 00325000
*   RETURN;                                                        0132 00326000
*                                                                  0132 00327000
@EL00001 DS    0H                                                  0132 00328000
@EF00001 DS    0H                                                  0132 00329000
@ER00001 L     @14,12(,@13)                                        0132 00330000
         LM    @00,@12,20(@13)                                     0132 00331000
         BR    @14                                                 0132 00332000
*/****************************************************************** */ 00333000
*/*       REQUEST FOR SAME CHANNEL ADDRESS                           */ 00334000
*/****************************************************************** */ 00335000
*                                                                  0133 00336000
*S2AC0210:                                                         0133 00337000
*   ;                                                              0133 00338000
S2AC0210 DS    0H                                                  0134 00339000
*   IF $GRABSCH='0'B                /* REQ. FOR SAME CHANNEL         */ 00340000
*     THEN                                                         0134 00341000
         TM    $GRABSCH(GRAMAP),B'01000000'                        0134 00342000
         BZ    @RT00134                                            0134 00343000
*     GOTO S2AC0050;                /* BR IF NO                      */ 00344000
*   IF($DEVUNAD(I)&CHMASK)=($DEVUNAD($CDEVPT)&CHMASK)/* DO CHANNELS     00345000
*                                      MATCH                         */ 00346000
*     THEN                                                         0136 00347000
         L     @14,CHMASK                                          0136 00348000
         LA    @12,68                                              0136 00349000
         LR    @01,I                                               0136 00350000
         MR    @00,@12                                             0136 00351000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0136 00352000
         NR    @06,@14                                             0136 00353000
         MH    @12,$CDEVPT(,WAPTR)                                 0136 00354000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0136 00355000
         CLR   @06,@14                                             0136 00356000
         BE    @RT00136                                            0136 00357000
*     GOTO S2AC0050;                /* BR IF YES                     */ 00358000
*   GOTO S2AC0150;                                                 0138 00359000
*                                                                  0138 00360000
         B     S2AC0150                                            0138 00361000
*/****************************************************************** */ 00362000
*/*      REQUEST FOR SAME CONTROL UNIT ADDRESS                       */ 00363000
*/****************************************************************** */ 00364000
*                                                                  0139 00365000
*S2AC0230:                                                         0139 00366000
*   ;                                                              0139 00367000
S2AC0230 DS    0H                                                  0140 00368000
*   IF $GRABSCU='0'B                /* REQ FOR SAME CONTROL UNIT     */ 00369000
*     THEN                                                         0140 00370000
         TM    $GRABSCU(GRAMAP),B'00010000'                        0140 00371000
         BZ    @RT00140                                            0140 00372000
*     GOTO S2AC0070;                /* BR IF NO                      */ 00373000
*   IF($DEVUNAD(I)&CUMASK)=($DEVUNAD($CDEVPT)&CUMASK)/* DO CONTROL 0142 00374000
*                                      UNITS MATCH                   */ 00375000
*     THEN                                                         0142 00376000
         L     @14,CUMASK                                          0142 00377000
         LA    @12,68                                              0142 00378000
         LR    @01,I                                               0142 00379000
         MR    @00,@12                                             0142 00380000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0142 00381000
         NR    @06,@14                                             0142 00382000
         MH    @12,$CDEVPT(,WAPTR)                                 0142 00383000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0142 00384000
         CLR   @06,@14                                             0142 00385000
         BE    @RT00142                                            0142 00386000
*     GOTO S2AC0070;                /* BR IF YES                     */ 00387000
*   GOTO S2AC0150;                                                 0144 00388000
*                                                                  0144 00389000
         B     S2AC0150                                            0144 00390000
*/****************************************************************** */ 00391000
*/*      REQUEST FOR SAME DEVICE ADDRESS                             */ 00392000
*/****************************************************************** */ 00393000
*                                                                  0145 00394000
*S2AC0250:                                                         0145 00395000
*   ;                                                              0145 00396000
S2AC0250 DS    0H                                                  0146 00397000
*   IF $GRABSDV='0'B                /* REQ FOR SAME DEVICE           */ 00398000
*     THEN                                                         0146 00399000
         TM    $GRABSDV(GRAMAP),B'00000100'                        0146 00400000
         BZ    @RT00146                                            0146 00401000
*     GOTO S2AC0090;                /* BR IF NO                      */ 00402000
*   IF($DEVUNAD(I)&DVMASK)=($DEVUNAD($CDEVPT)&DVMASK)/* DO DEVICES 0148 00403000
*                                      MATCH                         */ 00404000
*     THEN                                                         0148 00405000
         L     @14,DVMASK                                          0148 00406000
         LA    @12,68                                              0148 00407000
         LR    @01,I                                               0148 00408000
         MR    @00,@12                                             0148 00409000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0148 00410000
         NR    @06,@14                                             0148 00411000
         MH    @12,$CDEVPT(,WAPTR)                                 0148 00412000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0148 00413000
         CLR   @06,@14                                             0148 00414000
         BE    @RT00148                                            0148 00415000
*     GOTO S2AC0090;                /* BR IF YES                     */ 00416000
*   GOTO S2AC0150;                                                 0150 00417000
*                                                                  0150 00418000
         B     S2AC0150                                            0150 00419000
*/* ATDSPLY   INVOKED.                                               */ 00420000
*/********************************************************************/ 00421000
*/* THERE HAVE BEEN NO ATBUILD INCLUSIONS IN THIS COMPILATION.       */ 00422000
*/********************************************************************/ 00423000
*/* END OF ATDSPLY.                                                  */ 00424000
*                                                                  0151 00425000
*   END;                                                           0151 00426000
@DATA    DS    0H                                                       00427000
@CH00086 DC    H'68'                                                    00428000
@SM00410 MVC   INPUTBUF(0,@14),$DEVTBLE-68(@06)                         00429000
         DS    0F                                                       00430000
@TF00001 DS    F                                                        00431000
         DS    0F                                                       00432000
@CF00071 DC    F'1'                                                     00433000
@CF00050 DC    F'3'                                                     00434000
@CF00032 DC    F'4'                                                     00435000
         DS    0D                                                       00436000
CHMASK   DC    XL4'0F00'                                                00437000
CUMASK   DC    XL4'00F0'                                                00438000
DVMASK   DC    XL4'000F'                                                00439000
ACQPRMLT DS    CL5                                                      00440000
         ORG   ACQPRMLT                                                 00441000
CDSPTR   DS    AL4                                                      00442000
AFLAGS   DC    AL1(192)                                                 00443000
         ORG   AFLAGS                                                   00444000
TSTMSK   DS    BL1                                                      00445000
ACQVER   EQU   AFLAGS+0                                                 00446000
@NM00015 EQU   AFLAGS+0                                                 00447000
         ORG   ACQPRMLT+5                                               00448000
         DS    CL3                                                      00449000
PATCH    DC    20F'0'                                                   00450000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00451000
@01      EQU   01                                                       00452000
@02      EQU   02                                                       00453000
@03      EQU   03                                                       00454000
@04      EQU   04                                                       00455000
@05      EQU   05                                                       00456000
@06      EQU   06                                                       00457000
@07      EQU   07                                                       00458000
@08      EQU   08                                                       00459000
@09      EQU   09                                                       00460000
@10      EQU   10                                                       00461000
@11      EQU   11                                                       00462000
@12      EQU   12                                                       00463000
@13      EQU   13                                                       00464000
@14      EQU   14                                                       00465000
@15      EQU   15                                                       00466000
L4       EQU   @09                                                      00467000
L3       EQU   @08                                                      00468000
I        EQU   @03                                                      00469000
GRAMAP   EQU   @07                                                      00470000
WAPTR    EQU   @02                                                      00471000
R1       EQU   @01                                                      00472000
R13      EQU   @13                                                      00473000
R15      EQU   @15                                                      00474000
R0       EQU   @00                                                      00475000
R10      EQU   @10                                                      00476000
R11      EQU   @11                                                      00477000
R12      EQU   @12                                                      00478000
R14      EQU   @14                                                      00479000
R2       EQU   @02                                                      00480000
R3       EQU   @03                                                      00481000
R4       EQU   @04                                                      00482000
R5       EQU   @05                                                      00483000
R6       EQU   @06                                                      00484000
R7       EQU   @07                                                      00485000
R8       EQU   @08                                                      00486000
R9       EQU   @09                                                      00487000
TOLTEPWA EQU   0                                                        00488000
$CDA     EQU   TOLTEPWA+100                                             00489000
$RCA     EQU   $CDA+44                                                  00490000
$OLTPTR  EQU   $CDA+52                                                  00491000
$HIMOREC EQU   $CDA+60                                                  00492000
$GRCNTS  EQU   $CDA+108                                                 00493000
$DEVTBLE EQU   TOLTEPWA+240                                             00494000
$DEVCDS  EQU   $DEVTBLE                                                 00495000
$DEVUNAD EQU   $DEVCDS                                                  00496000
@NM00004 EQU   $DEVUNAD+2                                               00497000
$DEVFEAT EQU   $DEVCDS+4                                                00498000
$DEVCLAS EQU   $DEVFEAT+2                                               00499000
$DEVTYPE EQU   $DEVFEAT+3                                               00500000
$DEVCDSF EQU   $DEVCDS+9                                                00501000
$EXTRN   EQU   $DEVCDSF                                                 00502000
$CDSNAME EQU   $DEVCDSF                                                 00503000
$DEVSDCF EQU   $DEVCDS+10                                               00504000
$$SYMNME EQU   $DEVCDS+12                                               00505000
$DEVFLG1 EQU   $DEVTBLE+20                                              00506000
$LETGO   EQU   $DEVFLG1                                                 00507000
$GRABBED EQU   $DEVFLG1                                                 00508000
$EVNCPLT EQU   $DEVFLG1                                                 00509000
$ATTNEXP EQU   $DEVFLG1                                                 00510000
$INTOCC  EQU   $DEVFLG1                                                 00511000
$PRIMARY EQU   $DEVFLG1                                                 00512000
$DEVFLG2 EQU   $DEVTBLE+21                                              00513000
$DEVTECB EQU   $DEVTBLE+22                                              00514000
$OPIS    EQU   $DEVTECB                                                 00515000
$OPND    EQU   $DEVTECB+2                                               00516000
$DEVFLG3 EQU   $DEVTBLE+27                                              00517000
$NOTDEV  EQU   $DEVFLG3                                                 00518000
$ACQRED  EQU   $DEVFLG3                                                 00519000
$SIOFLG  EQU   $DEVFLG3                                                 00520000
$IFTOUT  EQU   $DEVTBLE+36                                              00521000
$DEVSESP EQU   $IFTOUT                                                  00522000
$SSCPDAF EQU   $IFTOUT+6                                                00523000
$LDNCBPT EQU   $DEVTBLE+48                                              00524000
$RNINFO  EQU   $DEVTBLE+56                                              00525000
$DEVFLG5 EQU   $RNINFO+8                                                00526000
$DEVFLG4 EQU   $DEVTBLE+65                                              00527000
$DEVCNTS EQU   TOLTEPWA+1464                                            00528000
$CDEVPT  EQU   TOLTEPWA+1466                                            00529000
#EXITA   EQU   TOLTEPWA+2632                                            00530000
$CCOMDAT EQU   TOLTEPWA+2644                                            00531000
$CFLGS   EQU   $CCOMDAT+16                                              00532000
$24FEMSG EQU   TOLTEPWA+2681                                            00533000
$24CATMG EQU   $24FEMSG+11                                              00534000
@NM00012 EQU   TOLTEPWA+2776                                            00535000
$OUNTPTR EQU   @NM00012+4                                               00536000
$NSPTR   EQU   $OUNTPTR                                                 00537000
$NSCNT   EQU   @NM00012+10                                              00538000
$ENXX    EQU   @NM00012+15                                              00539000
$IMITX   EQU   $ENXX                                                    00540000
SVECC013 EQU   TOLTEPWA+3232                                            00541000
SVEIC003 EQU   TOLTEPWA+3592                                            00542000
SVESC022 EQU   TOLTEPWA+3736                                            00543000
SVECC011 EQU   TOLTEPWA+4024                                            00544000
GRABMAP  EQU   0                                                        00545000
$GRABCDS EQU   GRABMAP+4                                                00546000
$GRABFLG EQU   GRABMAP+8                                                00547000
$GRABDCH EQU   $GRABFLG                                                 00548000
$GRABSCH EQU   $GRABFLG                                                 00549000
$GRABDCU EQU   $GRABFLG                                                 00550000
$GRABSCU EQU   $GRABFLG                                                 00551000
$GRABDDV EQU   $GRABFLG                                                 00552000
$GRABSDV EQU   $GRABFLG                                                 00553000
$GRABCLA EQU   $GRABFLG                                                 00554000
$GRABUNT EQU   $GRABFLG                                                 00555000
$GRABCLS EQU   GRABMAP+9                                                00556000
$GRABTYP EQU   GRABMAP+10                                               00557000
$GRABCNT EQU   GRABMAP+11                                               00558000
BACKSAVE EQU   0                                                        00559000
INPUTBUF EQU   0                                                        00560000
#EXIT    EQU   0                                                        00561000
SVESC02A EQU   SVESC022                                                 00562000
SVECC012 EQU   SVESC022                                                 00563000
SVEIC00A EQU   SVEIC003                                                 00564000
SVEIC004 EQU   SVEIC003                                                 00565000
SVEIC005 EQU   SVEIC003                                                 00566000
SVESC02B EQU   SVESC022                                                 00567000
SVESC02D EQU   SVESC022                                                 00568000
SVESC02E EQU   SVESC022                                                 00569000
SVESC02F EQU   SVECC013                                                 00570000
SVESC024 EQU   SVESC022                                                 00571000
SVESC025 EQU   SVESC022                                                 00572000
SVESC027 EQU   SVESC022                                                 00573000
SVESC029 EQU   SVESC022                                                 00574000
SVESC031 EQU   SVECC013                                                 00575000
SVESC032 EQU   SVECC011                                                 00576000
SVETC037 EQU   SVEIC003                                                 00577000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00578000
$GRBIDNT EQU   GRABMAP+2                                                00579000
$GRBLEVL EQU   GRABMAP+1                                                00580000
$GRBTRMG EQU   GRABMAP                                                  00581000
SVECC010 EQU   TOLTEPWA+3952                                            00582000
SVETC035 EQU   TOLTEPWA+3880                                            00583000
SVESC030 EQU   TOLTEPWA+3808                                            00584000
SVESC020 EQU   TOLTEPWA+3664                                            00585000
SVEIC002 EQU   TOLTEPWA+3520                                            00586000
SVECC014 EQU   TOLTEPWA+3376                                            00587000
SVESC120 EQU   TOLTEPWA+3304                                            00588000
SVESC033 EQU   TOLTEPWA+3160                                            00589000
@NM00014 EQU   TOLTEPWA+2980                                            00590000
$RPLERR  EQU   TOLTEPWA+2977                                            00591000
@NM00013 EQU   TOLTEPWA+2976                                            00592000
$R13PR3  EQU   TOLTEPWA+2972                                            00593000
$CEINT2  EQU   TOLTEPWA+2968                                            00594000
$CEINT1  EQU   TOLTEPWA+2964                                            00595000
$MSGGET  EQU   TOLTEPWA+2960                                            00596000
$ACQLIST EQU   TOLTEPWA+2956                                            00597000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00598000
$CLSISS  EQU   TOLTEPWA+2950                                            00599000
$CLSCNT  EQU   TOLTEPWA+2948                                            00600000
$CUTABLE EQU   TOLTEPWA+2868                                            00601000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00602000
$RESID2  EQU   TOLTEPWA+2860                                            00603000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00604000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00605000
$1STBFR2 EQU   TOLTEPWA+2848                                            00606000
$TECB2   EQU   TOLTEPWA+2844                                            00607000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00608000
$RESID1  EQU   TOLTEPWA+2836                                            00609000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00610000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00611000
$1STBFR1 EQU   TOLTEPWA+2824                                            00612000
$TECB1   EQU   TOLTEPWA+2820                                            00613000
$WAITIME EQU   TOLTEPWA+2816                                            00614000
$TRTN#   EQU   TOLTEPWA+2815                                            00615000
$WIODEV  EQU   TOLTEPWA+2814                                            00616000
$RQSTSZE EQU   TOLTEPWA+2812                                            00617000
$RQSTPTR EQU   TOLTEPWA+2808                                            00618000
$R4SAVE  EQU   TOLTEPWA+2804                                            00619000
$PARTADR EQU   TOLTEPWA+2800                                            00620000
$TBSDATA EQU   TOLTEPWA+2796                                            00621000
$CTWIDTH EQU   TOLTEPWA+2795                                            00622000
$CTLINE  EQU   TOLTEPWA+2794                                            00623000
$APWIDTH EQU   TOLTEPWA+2793                                            00624000
$APLINE  EQU   TOLTEPWA+2792                                            00625000
$INDEX   EQU   $IMITX                                                   00626000
$UMXX    EQU   @NM00012+14                                              00627000
$NSXX    EQU   @NM00012+12                                              00628000
$ATACNT  EQU   $NSCNT                                                   00629000
$CTR     EQU   @NM00012+8                                               00630000
$ATAPTR  EQU   $NSPTR                                                   00631000
$DDRPTR  EQU   @NM00012                                                 00632000
$DTORESP EQU   TOLTEPWA+2712                                            00633000
$APNAME  EQU   TOLTEPWA+2704                                            00634000
$24SYMNE EQU   $24CATMG+4                                               00635000
$24DEVAD EQU   $24CATMG                                                 00636000
$24RTN#  EQU   $24FEMSG+8                                               00637000
$ESECTID EQU   $24FEMSG                                                 00638000
$24FLGS  EQU   TOLTEPWA+2680                                            00639000
$24SAVE2 EQU   TOLTEPWA+2676                                            00640000
$24SAVE1 EQU   TOLTEPWA+2672                                            00641000
$24UNADR EQU   TOLTEPWA+2668                                            00642000
$24SAV13 EQU   TOLTEPWA+2664                                            00643000
$24RETCD EQU   TOLTEPWA+2663                                            00644000
$MACID   EQU   TOLTEPWA+2661                                            00645000
$CSPARE  EQU   $CFLGS                                                   00646000
$C2WAY   EQU   $CFLGS                                                   00647000
$CINCT   EQU   $CCOMDAT+12                                              00648000
$CINADR  EQU   $CCOMDAT+8                                               00649000
$COUTCT  EQU   $CCOMDAT+4                                               00650000
$COUTAD  EQU   $CCOMDAT                                                 00651000
ROOTLOC  EQU   TOLTEPWA+2640                                            00652000
$RETREG  EQU   TOLTEPWA+2636                                            00653000
$WORK    EQU   TOLTEPWA+2376                                            00654000
$EXTA    EQU   TOLTEPWA+2320                                            00655000
$PASSONA EQU   TOLTEPWA+2264                                            00656000
$TRMINPT EQU   TOLTEPWA+2184                                            00657000
$INBUFR  EQU   TOLTEPWA+2104                                            00658000
$BUFFER  EQU   TOLTEPWA+1976                                            00659000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00660000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00661000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00662000
$SLTBL   EQU   TOLTEPWA+1468                                            00663000
$FEEDBCK EQU   $DEVTBLE+66                                              00664000
$WTISUED EQU   $DEVFLG4                                                 00665000
$EXIOISD EQU   $DEVFLG4                                                 00666000
$REMWRIT EQU   $DEVFLG4                                                 00667000
$REMDONE EQU   $DEVFLG4                                                 00668000
$2NDUSED EQU   $DEVFLG4                                                 00669000
$1STUSED EQU   $DEVFLG4                                                 00670000
$IGLXIFB EQU   $DEVFLG4                                                 00671000
$EXIOLV3 EQU   $DEVFLG4                                                 00672000
@NM00011 EQU   $DEVFLG5                                                 00673000
$ASCII   EQU   $DEVFLG5                                                 00674000
$DEVLU   EQU   $DEVFLG5                                                 00675000
$OPNDFAL EQU   $DEVFLG5                                                 00676000
$ACQNCB  EQU   $DEVFLG5                                                 00677000
$REMOTE  EQU   $DEVFLG5                                                 00678000
$ENDNODE EQU   $DEVFLG5                                                 00679000
$LINENME EQU   $RNINFO                                                  00680000
$CID     EQU   $DEVTBLE+52                                              00681000
$DVCOL   EQU   $LDNCBPT+2                                               00682000
$DVROW   EQU   $LDNCBPT                                                 00683000
$NCSPLP  EQU   $DEVTBLE+44                                              00684000
$DVLN    EQU   $SSCPDAF                                                 00685000
$DAF     EQU   $DEVSESP+4                                               00686000
$VARYPAB EQU   $DEVSESP                                                 00687000
$SYSMN   EQU   $DEVTBLE+28                                              00688000
@NM00010 EQU   $DEVFLG3                                                 00689000
$CLRSNT  EQU   $DEVFLG3                                                 00690000
$OLTERR  EQU   $DEVFLG3                                                 00691000
$SRTEST  EQU   $DEVFLG3                                                 00692000
$DVSNDOK EQU   $SIOFLG                                                  00693000
$POLLREQ EQU   $DEVFLG3                                                 00694000
$DVINCT  EQU   $DEVTBLE+26                                              00695000
$DVBRKST EQU   $OPND+1                                                  00696000
$DVBRKSN EQU   $OPND                                                    00697000
$DVSEQNO EQU   $OPIS                                                    00698000
$CEINTRP EQU   $DEVFLG2                                                 00699000
$TESTMDE EQU   $DEVFLG2                                                 00700000
$DEVALOC EQU   $DEVFLG2                                                 00701000
$ALLDATA EQU   $DEVFLG2                                                 00702000
$ENDCNTL EQU   $DEVFLG2                                                 00703000
$CTLDEV  EQU   $DEVFLG2                                                 00704000
$NOCDS   EQU   $DEVFLG2                                                 00705000
$DATAIN  EQU   $DEVFLG2                                                 00706000
$DVCTBYT EQU   $INTOCC                                                  00707000
$DEVACT  EQU   $DEVFLG1                                                 00708000
$DVLGMDE EQU   $ATTNEXP                                                 00709000
$DVSPRM  EQU   $EVNCPLT                                                 00710000
$CATASTR EQU   $DEVFLG1                                                 00711000
$CURELEM EQU   $$SYMNME+4                                               00712000
$MSGOTSD EQU   $$SYMNME                                                 00713000
$EXTDEV  EQU   $DEVCDS+11                                               00714000
@NM00009 EQU   $DEVSDCF                                                 00715000
$NOTPRIM EQU   $DEVSDCF                                                 00716000
@NM00008 EQU   $DEVCDSF                                                 00717000
@NM00007 EQU   $DEVCDSF                                                 00718000
@NM00006 EQU   $DEVCDSF                                                 00719000
$CEVOLUM EQU   $DEVCDSF                                                 00720000
$SHARD   EQU   $DEVCDSF                                                 00721000
$DEVFPM  EQU   $DEVCDSF                                                 00722000
$DEVCNT  EQU   $DEVCDS+8                                                00723000
$DEVFRRS EQU   $DEVFEAT+1                                               00724000
$DEVMOD  EQU   $DEVFEAT                                                 00725000
$DEVRDGT EQU   @NM00004+1                                               00726000
$DEVCTLU EQU   @NM00004+1                                               00727000
$DEVCHAN EQU   @NM00004                                                 00728000
@NM00005 EQU   @NM00004                                                 00729000
$CTINDX  EQU   $DEVUNAD                                                 00730000
$COMMFLG EQU   TOLTEPWA+224                                             00731000
@NM00003 EQU   $CDA+120                                                 00732000
$CUCNT   EQU   $CDA+118                                                 00733000
@NM00002 EQU   $CDA+117                                                 00734000
$PRTFORM EQU   $CDA+116                                                 00735000
$OPISCNT EQU   $CDA+114                                                 00736000
$OPNDCNT EQU   $CDA+112                                                 00737000
$GETMSZE EQU   $CDA+110                                                 00738000
$CTLCNT  EQU   $CDA+106                                                 00739000
$ACTLVL  EQU   $CDA+105                                                 00740000
$PRNTLVL EQU   $CDA+104                                                 00741000
$ERRCNTA EQU   $CDA+102                                                 00742000
$TLCNT   EQU   $CDA+100                                                 00743000
$TIMEALW EQU   $CDA+96                                                  00744000
$PTRAREA EQU   $CDA+92                                                  00745000
$GETMPTR EQU   $CDA+88                                                  00746000
$R13PTRT EQU   $CDA+84                                                  00747000
$R13PTR  EQU   $CDA+80                                                  00748000
$TEPEND  EQU   $CDA+76                                                  00749000
$PLINKDL EQU   $CDA+72                                                  00750000
$TEPBEGN EQU   $CDA+68                                                  00751000
$FRELPTR EQU   $CDA+64                                                  00752000
$HIGHADR EQU   $HIMOREC                                                 00753000
$LOMOREC EQU   $CDA+56                                                  00754000
$LOWADDR EQU   $OLTPTR                                                  00755000
$ENDCOMM EQU   $CDA+48                                                  00756000
$COMMON  EQU   $RCA                                                     00757000
$SLASHAD EQU   $CDA+32                                                  00758000
$PASSON  EQU   $CDA+28                                                  00759000
$TOLBRTB EQU   $CDA+24                                                  00760000
$SCTPTR8 EQU   $CDA+20                                                  00761000
$SCTPTR  EQU   $CDA+16                                                  00762000
$TBWDPTR EQU   $CDA+12                                                  00763000
$TFWDPTR EQU   $CDA+8                                                   00764000
@NM00001 EQU   $CDA                                                     00765000
$SCTTBLE EQU   TOLTEPWA                                                 00766000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00767000
@RT00073 EQU   S2AC0150                                                 00768000
@RT00075 EQU   S2AC0150                                                 00769000
@RT00077 EQU   S2AC0090                                                 00770000
@RT00079 EQU   S2AC0210                                                 00771000
@RT00081 EQU   S2AC0150                                                 00772000
@RT00084 EQU   S2AC0230                                                 00773000
@RT00086 EQU   S2AC0150                                                 00774000
@RT00089 EQU   S2AC0250                                                 00775000
@RT00091 EQU   S2AC0150                                                 00776000
@RT00094 EQU   S2AC0110                                                 00777000
@RT00096 EQU   S2AC0150                                                 00778000
@RT00099 EQU   S2AC0130                                                 00779000
@RT00101 EQU   S2AC0150                                                 00780000
@RT00134 EQU   S2AC0050                                                 00781000
@RT00136 EQU   S2AC0050                                                 00782000
@RT00140 EQU   S2AC0070                                                 00783000
@RT00142 EQU   S2AC0070                                                 00784000
@RT00146 EQU   S2AC0090                                                 00785000
@RT00148 EQU   S2AC0090                                                 00786000
@ENDDATA EQU   *                                                        00787000
         END   ISTSC02A,(C'PLS2030',0701,75177)                         00788000
