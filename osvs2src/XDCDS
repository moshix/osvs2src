         MACRO                                                          00100000
&ID      XDCDS &DUMMY,&TESTRAN=NO,&DIAG=NO,&LEVEL=1                     00200000
         GBLC  &COMPNM                  COMPONENT NAME                  00300000
         LCLC  &NM                      MODULE NAME                     00400000
         JHEAD 'SYMBOL RESOLUTION PHASE DC/DS EVALUATION',             ,00500000
               PHASEID=&ID,                                            ,00600000
               LEVEL=&LEVEL                                             00700000
&NM      SETC  '&COMPNM&ID'                                             00800000
*TITLE-  ASSEMBLER SYMBOL RESOLUTION PHASE DC/DS EVALUATION ROUTINE   * 00900000
*                                                                     * 01000000
*FUNCTION/OPERATION-                                                  * 01100000
*        EVALUATE OPERANDS OF ASSEMBLER OPERATION STATEMENTS DC, DS,  * 01150000
*   AND DXD, AND LITERALS IN MACHINE OPERATION STATEMENTS AND THE     * 01160000
*   LITERAL POOL.  WHEN EVALUATING A DC, DS, OR DXD STATEMENT, THE    * 01170000
*   LOCATION COUNTER IS INCREMENTED AND ALIGNED AS NECESSARY.  WHEN   * 01180000
*   EVALUATING A LITERAL IN THE MACHINE OPERATION STATEMENT, THE      * 01190000
*   OBJECT LENGTH IS RETURNED.  WHEN SCANNING A LITERAL IN THE        * 01192000
*   LITERAL POOL, A SYMBOL REFERENCE RECORD IS GENERATED FOR EACH     * 01194000
*   SYMBOL APPEARING IN THE LITERAL.                                  * 01196000
         AIF   ('&TESTRAN' NE 'YES').TEST16                             01198000
*        PUNCH 'SYM' ITEMS.                                           * 01198400
.TEST16  ANOP                                                           01198800
*                                                                     * 01200000
*ENTRY POINT-                                                         * 01300000
         ENTRY &NM.01                                                 * 01400000
*                                                                     * 01500000
*INPUT-                                                               * 01600000
*        REGISTER R5 IS THE POINTER TO THE FIRST CHARACTER TO BE      * 01650000
*   EVALUATED.                                                        * 01660000
*                                                                     * 01700000
*OUTPUT-                                                              * 01800000
*        REGISTER R14 IS THE POINTER TO THE CHARACTER WHICH LOGICALLY * 01850000
*   TERMINATED THE EVALUATION.                                        * 01860000
*        REGISTER R15 CONTAINS THE OBJECT LENGTH OF THE LITERAL IN    * 01870000
*   THE MACHINE OPERATION STATEMENT.                                  * 01880000
*        SYMBOL REFERENCE RECORDS ON 'JOUTFILE'.                      * 01890000
         AIF   ('&TESTRAN' NE 'YES').TEST17                             01892000
*        'SYM' ITEMS ON THE PUNCH FILES.                              * 01894000
.TEST17  ANOP                                                           01896000
*                                                                     * 01900000
*EXTERNAL ROUTINES-                                                   * 01950000
*        QCON-     ROUTINE IN X4E TO PROCESS SYMBOLS ENCOUNTERED IN   * 01960000
*                  Q-TYPE ADDRESS CONSTANTS.                          * 01970000
*        VCON-     ROUTINE IN X4E TO PROCESS SYMBOLS ENCOUNTERED IN   * 01980000
*                  V-TYPE ADDRESS CONSTANTS.                          * 01990000
*        EVAL-     ROUTINE IN X4V TO EVALUATE EXPRESSIONS.            * 01992000
*        REFER-    ROUTINE IN X4E TO OUTPUT SYMBOL REFERENCE RECORDS  * 01994000
*                  FOR LITERALS IN THE LITERAL POOL.                  * 01996000
*        ENTER-    ROUTINE IN X4S TO ENTER THE NAME OF A DC OR DS     * 01998000
*                  STATEMENT IN THE SYMBOL TABLE.                     * 01998400
*                                                                     * 01998800
*EXITS, NORMAL-                                                       * 02000000
*        RETURN TO THE CALLING ROUTINE.                               * 02050000
*                                                                     * 02100000
*EXITS, ERROR-                                                        * 02200000
*        RETURN TO THE CALLING ROUTINE.                               * 02250000
*                                                                     * 02300000
*TABLES/WORK AREAS-                                                   * 02400000
*        DCDSWORK- AN AREA DEFINED IN DSECT 'ICOMMON' AND USED AS     * 02450000
*                  WORK STORAGE EXCLUSIVELY BY THIS ROUTINE.          * 02460000
*                                                                     * 02500000
*ATTRIBUTES-                                                          * 02600000
*        REFRESHABLE.                                                 * 02700000
*                                                                     * 02800000
*NOTES-                                                               * 02900000
*                                                                     * 03600000
         EJECT                                                          03700000
         COPY  JCOMMON                                                  03800000
         EJECT                                                          03900000
         COPY  JTEXT                                                    04000000
         EJECT                                                          04100000
         COPY  ICOMMON                                                  04200000
         EJECT                                                          04300000
JTEXT    DSECT ,                                                        04400000
         ORG   JTEXT                    OVERLAY                         04500000
         COPY  RSYMRCD                                                  04600000
         EJECT                                                          04700000
* VS1 RELEASE 3.1 CHANGES                                               04750003
*A060500,060600                                                 OX04107 04760003
*A445500,445600                                                 OX04090 04770003
*A058500,058600                                                 OX05810 04780003
*D060500,060600                                                 OX05810 04790003
*A058100,058200                                                 OY06131 04792003
*D445500-445600                                                @OX07274 04794005
&NM.00   CSECT                                                          04800000
         JMODID                                                         04900000
&NM.01   CONTENTS                                                       05000000
         USING &NM.01,R8                                                05100000
         EJECT                                                          05200000
DCSCAN   BALR  R14,R7                   SAVE REGISTERS IN STACK         05300000
         LR    R8,R12                   BASE REGISTER                   05400000
         ST    R15,LEVELPTR             STACK LEVEL POINTER             05500000
         XC    DCDSWORK,DCDSWORK        INITIALIZATION                  05600000
         SET   SDZDUPF,OFF              CLEAR ZERO DUPF SW              05650000
         LA    R2,D1                    BUMPER                          05700000
         STH   R2,LATTRSAV              LENGTH ATTRIBUTE                05710000
         MVC   DCDSMODE,TYPECALL        ESD INHIBIT FLAG                05800000
         TM    TYPECALL,LTCALL          TEST FOR LITERAL        OY06131 05810003
         BO    NEWOPRN                  BR OVER OPERAND TST     OY06131 05820003
         TM    RFLDI,RFIELDX            ANY OPERAND             OX05810 05850003
         BZ    DCABORT                  INVALID - NOOPERAND     OX05810 05860003
NEWOPRN  SET   (NOESDS,LMOD,BMOD,SMOD),OFF   INITIAL SETTING            05900000
         ST    R2,DUPFAC                DEFAULT DUPLICATION FACTOR      06000000
         CLI   CHAR1,J9                 TEST FOR DUPLICATION FACTOR     06100000
         BH    DUPF                     NOT DECIMAL SELF-DEFINING       06200000
         BAL   R3,EXPR                  EVALUATE VALUE                  06300000
         BAL   R3,SETUP                 GO SET UP DUPLICATION FACTOR    06400000
         LTR   R11,R11                       CHECK FOR SELFDEF ZERO     06450000
         BNZ   TYPE                          IF NOT BRANCH              06460000
         SET   SDZDUPF,ON                    IND DUPF SELF DEF ZERO     06470000
         B     TYPE                     READY TO ANALYZE TYPE           06500000
DUPF     CLI   CHAR1,JLPARN             SEE IF EXPRESSION               06600000
         BNE   TYPE                     OMITTED FIELD                   06700000
         ST    R5,ADUPFAC               SAVE ADDRESS OF EXPRESSION      06800000
         BAL   R3,EXPR1                 EVALUATE EXPRESSION             06900000
TYPE     CLI   CHAR1,JZ                 TEST FOR VALID TYPE             07000000
         BH    DCABORT                  INVALID TYPE                    07100000
         TRT   CHAR1,DCTABLE            EXAMINE CLOSELY                 07200000
         BZ    DCABORT                  ILLEGAL TYPE                    07300000
         LA    R2,DCTYPES(R2)           POINT TO SWITCH CODE            07400000
         MVC   DCSWORK,D0(R2)           MOVE SWITCH CODE TO WORK AREA   07500000
         AIF   ('&TESTRAN' NE 'YES').TEST07                             07600000
         MVC   DATATYPE,CHAR1           SAVE TYPE                       07700000
.TEST07  LA    R2,D1                    INCREMENT                       07800000
         AR    R5,R2                    ADVANCE COLUMN POINTER          07900000
         CLI   CHAR1,JL                 SEE IF LENGTH MODIFIER          08000000
         BNE   NOLN                     NO LENGTH MODIFIER              08100000
         SET   DXDALIGN,OFF             SET DXD ALIGNMENT FACTOR        08200000
         SET   LMOD,ON                  INDICATE LENGTH MODIFIED        08300000
         AR    R5,R2                    BUMP COLUMN POINTER             08400000
         CLI   CHAR1,JPERIOD            SEE IF BIT LENGTH               08500000
         BNE   LNGM                     NO BIT LENGTH MODIFIER          08600000
         SET   BMOD,ON                  INDICATE BIT LENGTH MODIFIER    08700000
         AR    R5,R2                    BUMP COLUMN POINTER             08800000
         GOIF  BITLN,OFF=DCABORT        BIT LENGTH NOT ALLOWED          08900000
         L     R15,ELCTR                GET CURRENT LOCATION COUNTER    09000000
         B     LNGM1                    PUSH                            09100000
LNGM     GOIF  LTCALL,ON=LNGM3          SEE IF LITERAL                  09200000
         BAL   R1,ADDBIT                ADD RESIDUAL BITS               09300000
         ST    R15,ELCTR                UPDATE LOCATION COUNTER         09400000
LNGM1    BAL   R3,NOLN2                 GO MAKE SYMBOL TABLE ENTRY      09500000
LNGM3    CLI   CHAR1,J9                 SEE IF DECIMAL SELF DEFINING    09600000
         BH    LNGM4                    SKIP IF NOT                     09700000
         BAL   R3,EXPR                  EVALUATE                        09800000
         B     LNGM5                    CONTINUE                        09900000
LNGM4    CLI   CHAR1,JLPARN             MUST BEGIN WITH THIS            10000000
         BNE   DCABORT                  INTOLERABLE                     10100000
         BAL   R3,EXPR1                 EVALUATE                        10200000
LNGM5    BNE   DCABORT                  MUST BE ABSOLUTE                10300000
         GOIF  BMOD,ON=LNGM6            SKIP IF BIT LENGTH              10400000
         SLA   R11,D3                   CONVERT TO BITS                 10500000
         BO    DCABORT                  TOO MANY BITS                   10600000
LNGM6    CL    R11,=FS3'65535'          TEST FOR ABSOLUTE MAXIMUM       10700000
         BH    DCABORT                  TOO LONG                        10800000
         CLI   SCADDR,XBCON-SCAD        SEE IF B-, C-, OR X-TYPE        10900000
         BNE   LNGM7                    SKIP IF NOT                     11000000
         GOIF  DSCALL,ON=LNGM8          SKIP IF MAXIMUM LENGTH ALLOWED  11100000
LNGM7    CH    R11,MAXLN                TEST FOR MAXIMUM ALLOWED        11200000
         BH    DCABORT                  TOO LONG                        11300000
LNGM8    LR    R14,R2                   CLEAR                           11400000
         IC    R14,MINLN                GET MINIMUM LENGTH              11500000
         CR    R11,R14                  SEE IF ENOUGH                   11600000
         BL    DCABORT                  NOPE                            11700000
         BAL   R9,AGAIN1                SET UP LENGTH ATTRIBUTE         11800000
         SPACE                                                          11900000
EMOD     CLI   CHAR1,JS                 SEE IF SCALE MODIFIER           12000000
         BAL   R3,MODS                  SCAN EXPRESSION                 12100000
         AIF   ('&TESTRAN' NE 'YES').TEST14                             12200000
         BNE   EMOD1                    NO VALID SCALE MODIFIER         12300000
         LTR   R11,R11                  SEE IF SCALE ACTUALLY MODIFIED  12400000
         BZ    EMOD1                    NOPE                            12500000
         SET   SCALING,ON               INDICATE SCAL MODIFIER          12600000
         STH   R11,SCALE                SCALE MODIFIER                  12700000
.TEST14  ANOP                                                           12800000
EMOD1    CLI   CHAR1,JE                 SEE IF EXPONENT MODIFIER        12900000
         BAL   R3,MODS                  EVALUATE EXPRESSION             13000000
         CLC   CHAR1,LFDEL              SEE IF CONSTANTS SUBFIELD       13100000
         BNE   NOCON                    IS OMITTED                      13200000
         AR    R5,R2                    BUMP COLUMN POINTER             13300000
         AIF   ('&TESTRAN' NE 'YES').TEST13                             13400000
         ST    R5,XPARM                 SAVE COLUMN POINTER             13500000
.TEST13  SR    R4,R4                    CLEAR REGISTER                  13600000
         LR    R15,R4                   CLEAR                           13700000
         IC    R15,SCADDR               GET ADDRESS OF SCAN ROUTINE     13800000
         B     SCAD(R15)                GO SCAN CONSTANTS               13900000
         SPACE                                                          14000000
DMOD     C     R2,ADSYM                 SEE IF WE HAVE EVERYTHING       14010000
         BL    EMOD                     NO, JUST A LITTLE BIT LONGER    14020000
         BAL   R9,AGAIN2                EVALUATE THE DUPLICATION FACTOR 14030000
         B     EMOD                     GO ON                           14040000
         SPACE                                                          14050000
NOLN     LR    R11,R2                   CLEAR REGISTER                  14100000
         IC    R11,DCALIGN              GET IMPLIED ALIGNMENT           14200000
         LR    R10,R11                  SAVE                            14300000
         GOIF  TYPEL,OFF=NOLN1          SKIP IF NOT TYPE L              14400000
         AR    R11,R11                  LENGTH OF TYPE L                14500000
NOLN1    STH   R11,LATTR                LENGTH ATTRIBUTE                14600000
         SLL   R11,D3                   MULTIPLY BY EIGHT               14650000
         ST    R11,CONLNG               LENGTH OF ONE CONSTANT IN BITS  14670000
         LA    R3,DMOD                  EXIT TIME ROUTINE ADDRESS       14730000
         GOIF  LTCALL,ON=(R3)           SKIP IF LITERAL                 14800000
         BAL   R1,ADDBIT                ROUND FOR BIT                   14900000
         GOIF  SDZDUPF,ON=NOLN15        ALWAYS ALIGN IF DUPF SELF DEF 0 14910000
         GOIF  JALGN,OFF=NOLNX          DONT ALIGN IF OPTION IS OFF     14950000
NOLN15   LCR   R1,R10                   GET ALIDNMENT MASK              15000000
         BCTR  R10,0                    ROUND                           15100000
         AIF   ('&TESTRAN' NE 'YES').TEST15                             15110000
         LR    R0,R15                   SAVE                            15120000
.TEST15  AR    R15,R10                  ADD CURRENT LOCATION COUNTER    15200000
         NR    R15,R1                   ROUND                           15300000
         AIF   ('&TESTRAN' NE 'YES').TEST02                             15400000
         TM    ETYPE,ETYPEXD            SEE IF DXD                      15500000
         BO    NOLNX                    DXD, NO TESTRAN OUTPUT          15600000
         STM   R9,R1,TERMS              SAVE REGISTERS                  15700000
         SR    R15,R0                   SEE IF BYTES SKIPPED            15800000
         BE    NOLNY                    NO BYTES SKIPPED                15900000
         SET   TSPACE                   ITEM TYPE                       16000000
         MVC   ADDRESS,ELCTR+D1         ADDRESS OF BYTES SKIPPED        16100000
         STC   R15,NAME                 NUMBER OF BYTES SKIPPED         16200000
         LA    R10,D5                   LENGTH OF OUTPUT ITEM           16300000
         GOTO  SYMPUNCH                 GO TO OUTPUT ROUTINE            16400000
NOLNY    LM    R9,R1,TERMS              RESTORE REGISTERS               16500000
.TEST02  ANOP                                                           16600000
NOLNX    ST    R15,ELCTR                NEW ADDRESS                     16700000
         GOIF  DXDALIGN,OFF=NOLN2       SEE IF DXD ALIGNMENT SET        16800000
         SET   DXDALIGN,OFF             INDICATE SET                    16900000
         ST    R10,EHILC                SET DXD ALIGNMENT               17000000
         AIF   ('&TESTRAN' NE 'YES').TEST04                             17100000
NOLN2    SET   TDATA                    ORGANIZATION                    17200000
         MVC   ADDRESS,ELCTR+D1         ADDRESS                         17300000
         GOIF  DEFNAME,OFF=(R3)         RETURN IF NO NAME               17400000
         MVC   NAME,RNAME               NAME                            17500000
         TR    NAME,JTRTABLE            TRANSLATE NAME                  17600000
         IC    R1,RFLDI                 LENGTH OF SYMBOL                17700000
         N     R1,=F'7'                 LENGTH OF SYMBOL                17800000
         LA    R1,BIT0(,R1)             ORGANIZATION                    17900000
         STC   R1,ORGBYTE               ORGANIZATION                    18000000
         AGO   .TEST05                                                  18100000
.TEST04  ANOP                                                           18200000
NOLN2    GOIF  DEFNAME,OFF=(R3)         RETURN IF NO NAME               18300000
.TEST05  ANOP                                                           18400000
         SET   DEFNAME,OFF              INDICATE NO SYMBOL TABLE ENTRY  18500000
         ST    R15,RLCTR                VALUE                           18600000
         MVC   RLNGQ,LATTR              LENGTH ATTRIBUTE                18700000
         LR    R10,R4                   PARAMETER                       18800000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           18900000
         BNE   NOLN4                    ALREADY IN SYMBOL TABLE         19000000
         GOIF  LMOD,ON=NOLN3            SKIP IF LENGTH MODIFIER PRESENT 19100000
         CLI   SCADDR,XBCON-SCAD        SKIP B-, C-, P-, X-, AND Z-TYPE 19200000
         BHR   R3                       BRANCH IF HIGH                  19300000
NOLN3    ST    R14,ADSYM                SAVE SYMBOL TABLE ENTRY ADDRESS 19400000
         SET   LNGDEF,ON                INDICATE LENGTH NOT DEFINED     19500000
         BR    R3                       RETURN                          19600000
NOLN4    SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     19700000
         BR    R3                       RETURN                          19800000
         SPACE                                                          19900000
NOCON    GOIF  DSCALL,OFF=DCABORT       CONSTANT SUBFIELD IS REQUIRED   20000000
         L     R4,CONLNG                INFERS ONE CONSTANT             20100000
         STH   R2,CONCT                 ONE CONSTANT ASSUMED            20150000
         LR    R11,R2                   ONE                             20160000
         BAL   R9,AGAIN3                CATCHUP                         20170000
         SPACE                                                          20200000
ENDOPRN  CLI   CHAR1,JBLANK             SEE IF VALID DELIMITER          20300000
         BE    ENDOPRN1                 SKIP IF YES                     20400000
         CLI   CHAR1,JCOMMA             SEE IF VALID DELIMITER          20500000
         BNE   DCABORT                  OH, OH                          20600000
ENDOPRN1 LR    R15,R4                   LENGTH OF CONSTANT OR CONSTANTS 20700000
         L     R1,DUPFAC                DUPLICATION FACTOR              20800000
         MR    R14,R1                   TIMES LENGTH OF CONSTANT        20900000
         LTR   R14,R14                  TEST FOR OVERFLOW               21000000
         BNZ   DCABORT                  OVERFLOWED                      21100000
         CL    R15,=FS3'16777215'       SEE IF TOO LONG                 21200000
         BH    DCABORT                  TOO LONG                        21300000
         AH    R15,BITADD               ADD RESIDUAL BITS               21400000
         D     R14,=F'8'                GET LENGTH IN BYTES             21500000
         GOIF  LTCALL,OFF=ENDOPRN2      SEE IF LITERAL                  21600000
ENDOPRN9 LTR   R14,R14                  RESIDUAL                        21700000
         LR    R14,R5                   RETURN COLUMN POINTER           21800000
         BE    EXIT                     FINIS IF NONE                   21900000
         AR    R15,R2                   ANY OVER COUNTS AS ONE          22000000
         B     EXIT                     FINIS                           22100000
ENDOPRN2 DS    0H                       PIVOT                           22200000
         AIF   ('&TESTRAN' NE 'YES').TEST00                             22300000
         TM    ETYPE,ETYPEXD            SEE IF DXD                      22400000
         BO    TESTRAN                  SKIP IF SO                      22500000
ENDOPRN8 STM   R9,R1,TERMS              SAVE REGISTERS                  22600000
         CLI   DCALIGN,D1               SEE IF B, C, P, X, OR Z-TYPE    22630000
         BH    ENDOPRN3                 BRANCH IF NOT                   22660000
         GOIF  LMOD,OFF=ENDOPRN5        SKIP IF EXPLICIT LENGTH         22700000
ENDOPRN3 MH    R1,CONCT                 TIMES NUMBER OF CONSTANTS       22800000
         L     R0,CONLNG                GET LENGTH                      22840000
         AH    R0,BITADD                PLUS ANY RESIDUAL               22880000
         LR    R4,R0                    FAKE IT                         22888000
ENDOPRN5 LR    R0,R4                    GET IT                          23600000
         SR    R0,R2                    MINUS ONE                       23700000
         SRL   R0,D3                    OVER EIGHT                      23800000
         STM   R0,R1,LENGTH             LENGTH AND MULTIPLICITY         23900000
         CR    R1,R2                    SEE IF ONE                      23940000
         BE    ENDOPRN4                 SKIP IF YES                     23980000
         SET   MULTIPLE,ON              TURN MULTIPLE ON                23988000
ENDOPRN4 LA    R10,NAME                 OUTPUT POINTER                  23996000
         LA    R11,NAME-D6              REFERENCE                       24100000
         GOIF  LABEL,ON=TESTRAN1        SKIP IF NO NAME                 24200000
         IC    R10,ORGBYTE              GET NAME LENGTH                 24300000
         N     R10,=F'7'                ISOLATE LENGTH CODE             24400000
         LA    R10,NAME+D1(R10)         POINT PAST NAME                 24500000
TESTRAN1 TR    DATATYPE,DATABLE         TRANSLATE DATA TYPE             24600000
         MVC   D0(D1,R10),DATATYPE      MOVE DATA TYPE                  24700000
         MVC   D1(D1,R10),LENGTH+D3     LENGTH                          24800000
         CLI   SCADDR,XBCON-SCAD        SEE IF X-, B-, OR C-TYPE        24900000
         BNE   TESTRAN2                 SKIP IF NOT                     25000000
         MVC   D1(D2,R10),LENGTH+D2     LENGTH                          25100000
         AR    R10,R2                   BUMP POINTER                    25200000
TESTRAN2 GOIF  MULTIPLE,OFF=TESTRAN3    SEE IF MULTIPLICITY PRESENT     25300000
         MVC   D2(D3,R10),MULTIP+D1     MULTIPLICITY                    25400000
         LA    R10,D3(,R10)             BUMP POINTER                    25500000
TESTRAN3 GOIF  SCALING,OFF=TESTRAN4     SEE IF SCALED                   25600000
         MVC   D2(D2,R10),SCALE         SCALE                           25700000
         LA    R10,D2(,R10)             BUMP POINTER                    25800000
TESTRAN4 SR    R10,R11                  GET LENGTH OF OUTPUT ITEM       25900000
         GOTO  SYMPUNCH                 GO TO OUTPUT ROUTINE            26000000
         LA    R9,TESTRAN7              ADDRESS OF NEXT ROUTINE         26100000
         GOIF  CLUSTER,OFF=(R9)         SEE IF SUB-CLUSTER              26200000
         BALR  R14,R7                   PUSH DOWN ONE LEVEL             26300000
         TS    SCADDR                   TOUGH SKIDDING                  26400000
         L     R5,XPARM                 PICK UP COLUMN POINTER          26500000
         MVC   NAME(D1),DATATYPE        DATA TYPE                       26600000
TESTRAN5 MVI   ORGBYTE,TDATA+CLUSTER    ORGANIZATION                    26700000
         BAL   R3,PZCON                 SCAN SUB-CLUSTER                26800000
         LR    R3,R11                   LENGTH                          26900000
         BCTR  R11,D0                   MINUS ONE                       27000000
         STC   R11,NAME+D1              LENGTH                          27100000
         LA    R10,D6                   LENGTH OF TESTRAN ITEM          27200000
         LCR   R0,R0                    SEE IF SCALE                    27300000
         BNP   TESTRAN6                 NO                              27400000
         LA    R10,D8                   LENGTH OF ITEM WITH SCALE       27500000
         STH   R0,NAME+D2               SCALE MODIFIER                  27600000
         SET   SCALING,ON               INDICATE SCALE                  27700000
TESTRAN6 GOTO  SYMPUNCH                 OUTPUT TESTRAN ITEM             27800000
         CLI   CHAR1,JQUOTE             SEE IF ALL DONE                 27900000
         BE    EXIT                     FINIS                           28000000
         AR    R5,R2                    BUMP COLUMN POINTER             28100000
         AL    R3,ORGBYTE               NEXT ADDRESS                    28200000
         ST    R3,ORGBYTE               NEXT ADDRESS                    28300000
         B     TESTRAN5                 GO AGAIN                        28400000
TESTRAN7 LM    R9,R1,TERMS              RESTORE REGISTERS               28500000
.TEST00  ANOP                                                           28600000
TESTRAN  STH   R14,BITADD               RESIDUAL TO NEXT BYTE           28700000
         LH    R0,OPCNT                 GET COUNT OF OPERANDS           28800000
         LTR   R0,R0                    SEE IF FIRST OPERAND            28900000
         BNE   ENDOPRN7                 NOPE                            29000000
         MVC   LATTRSAV,LATTR           LENGTH ATTRIBUTE                29100000
ENDOPRN7 AR    R0,R2                    COUNT OPERANDS                  29200000
         STH   R0,OPCNT                 AND SAVE                        29300000
         AL    R15,ELCTR                UPDATE LOCATION COUNTER         29400000
         ST    R15,ELCTR                SAVE                            29500000
         CLI   CHAR1,JBLANK             SEE IF END                      29600000
         BNE   ENDOPRN6                 SKIP IF NOT                     29700000
         BAL   R1,ADDBIT1               TACK ON ANY RESIDUAL            29800000
         ST    R15,ELCTR                SAVE                            29900000
         B     EXIT                     FINIS                           30000000
ENDOPRN6 AR    R5,R2                    BUMP COLUMN POINTER             30100000
         XC    DCWORK,DCWORK            REINITIALIZE WORK AREA          30200000
         B     NEWOPRN                  FULL SPEED AHEAD                30300000
         SPACE                                                          30400000
AGAIN    SLL   R11,D3                   MULTIPLY BY EIGHT               30500000
AGAIN1   ST    R11,CONLNG               LENGTH OF ONE CONSTANT          30600000
         LA    R11,D7(,R11)             ROUND                           30700000
         SRL   R11,D3                   LENGTH ATTRIBUTE IN BYTES       30800000
         CH    R2,LATTR                 SEE IF LENGTH ATTRIBUTE SET     30900000
         BNHR  R9                       RETURN IF ALREADY SET           31000000
         STH   R11,LATTR                SET LENGTH ATTRIBUTE            31100000
AGAIN3   L     R14,ADSYM                POINTS TO SYMBOL TABLE ENTRY    31200000
         LTR   R14,R14                  SEE IF LENGTH ATTRIBUTE DEFINED 31300000
         BZ    AGAIN2                   NO                              31400000
         STH   R11,SLNGQ                LENGTH ATTRIBUTE                31500000
         SET   LNGDEF,OFF               LENGTH ATTRIBUTE DEFINED        31600000
         SR    R14,R14                  ZERO REGISTER                   31700000
         ST    R14,ADSYM                INDICATE COMPLETE               31800000
AGAIN2   BALR  R14,R7                   PUSH DOWN A LEVEL               31900000
         L     R5,ADUPFAC               GET ADDRESS OF EXPRESSION       32000000
         LTR   R5,R5                    SEE IF AVAILABLE                32100000
         BZ    EXIT                     NONE                            32200000
         LR    R4,R11                   SAVE                            32300000
         SET   SUBLIST,ON               EVALUATE WHAT'S INSIDE PARENS   32350000
         BAL   R3,EXPR3                 EVALUATE EXPRESSION             32400000
         BAL   R3,SETUP                 APPRAISE VALUE                  32500000
         LR    R11,R4                   RESTORE                         32600000
         B     EXIT                     RETURN                          32700000
         SPACE                                                          32800000
EXPR     MVI   SELFDEFN,D0              SELF DEFINING TERM              32900000
EXPR1    SET   SUBLIST,ON               INDICATE MODE OF SCAN           33000000
EXPR2    SET   DCOP,ON                  INDICATE IN DC                  33100000
EXPR3    GOTO  EVAL                     GO EVALUATE                     33200000
         BO    DCABORT                  SYNTACTIC ERRORS                33300000
         LR    R5,R14                   UPDATE COLUMN POINTER           33400000
         BR    R3                       RETURN                          33500000
         SPACE                                                          33600000
SETUP    BNE   DCABORT                  INVALID DUPLICATION FACTOR      33700000
         ST    R11,DUPFAC               MODIFY DUPLICATION FACTOR       33800000
         LTR   R11,R11                  TEST CHARACTERISTIC             33900000
         BCR   D2,R3                    RETURN IF POSITIVE              34000000
         BM    DCABORT                  INTOLERABLE                     34100000
         SET   NOESDS,ON                INDICATE NO ESD                 34200000
         BR    R3                       RETURN                          34300000
         SPACE                                                          34400000
ADDBIT   L     R15,ELCTR                GET CURRENT LOCATION COUNTER    34500000
ADDBIT1  CLI   BITADD+D1,D0             SEE IF RESIDUAL LEFT OVER       34600000
         BCR   D8,R1                    LEAVE IF NONE                   34700000
         AR    R15,R2                   BUMP BY ONE                     34800000
         MVI   BITADD+D1,D0             ZERO COUNT                      34900000
         BR    R1                       RETURN                          35000000
         SPACE                                                          35100000
MODS     BCR   D7,R3                    RETURN IF OMITTED               35200000
         GOIF  ESMOD,OFF=DCABORT        ERROR IF NOT ALLOWED            35300000
         AR    R5,R2                    BUMP COLUMN POINTER             35400000
         CLI   CHAR1,JMINUS             SEE IF MINUS SIGN               35500000
         BE    MODS1                    BYPASS                          35600000
         CLI   CHAR1,JPLUS              SEE IF PLUS SIGN                35700000
         BNE   MODS2                    SKIP IF NOT                     35800000
MODS1    AR    R5,R2                    BUMP COLUMN POINTER             35900000
MODS2    CLI   CHAR1,J9                 SEE IF SELF-DEFINING VALUE      36000000
         BNH   EXPR                     EVALUATE                        36100000
         CLI   CHAR1,JLPARN             SEE IF LEFT PARENTHESIS         36200000
         BE    EXPR1                    EVALUATE                        36300000
         B     DCABORT                  ERROR                           36400000
         SPACE                                                          36500000
DCABORT  SR    R15,R15                  INDICATE ERROR                  36600000
         MVC   JCLVLPTR,LEVELPTR        RESTORE STACK LEVEL POINTER     36700000
         BZ    EXIT                     RETURN                          36800000
         EJECT                                                          36900000
PZEND    LCR   R11,R11                  SEE IF NULL CONSTANT            37000000
         BNP   DCABORT                  ERROR IF NULL CONSTANT          37100000
         GOIF  TYPEZ,ON=PZEND1          SKIP IF ZONED TYPE              37200000
         LA    R11,D2(,R11)             COMPUTE LENGTH FOR PACKED TYPE  37300000
         SRL   R11,D1                   COMPUTE LENGTH FOR PACKED TYPE  37400000
PZEND1   CH    R11,=H'16'               CHECK LENGTH OF CONSTANT        37500000
         BH    DCABORT                  ERROR IF MORE THAN 16 BYTES     37600000
         AIF   ('&TESTRAN' NE 'YES').TEST09                             37700000
         CLI   SCADDR,PZCON-SCAD        SEE IF CLUSTER SCAN             37800000
         BNER  R3                       SUB CLUSTER                     37900000
         GOIF  SMOD,ON=PZEND2           SEE IF SCALE SET                38000000
         SET   SMOD,ON                  INDICATE SCALE SET              38100000
         LCR   R0,R0                    TEST FOR SCALE                  38200000
         BNP   PZEND2                   NO SCALE                        38300000
         STH   R0,SCALE                 SAVE SCALE                      38400000
         SET   SCALING,ON               SCALE INDICATOR IN ORG BYTE     38500000
.TEST09  ANOP                                                           38600000
PZEND2   BAL   R3,SCANDEL               END OF ONE CONSTANT             38700000
         AIF   ('&TESTRAN' NE 'YES').TEST08                             38800000
         GOIF  LMOD,ON=PZCON            SEE IF EXPLICIT LENGTH          38900000
         SET   (MULTIPLE,CLUSTER),ON    INDICATE CLUSTER ITEM           39000000
         SET   SCALING,OFF              DEFER SCALE                     39050000
.TEST08  ANOP                                                           39100000
PZCON    MVI   PERIOD,D0                ALLOW ONE PERIOD                39200000
         AIF   ('&TESTRAN' NE 'YES').TEST10                             39300000
         SR    R1,R1                    ZERO                            39400000
         LR    R0,R2                    ONE                             39500000
.TEST10  LR    R11,R2                   INITIALIZE DIGIT COUNT          39600000
         CLI   CHAR1,JMINUS             CHECK FOR OPTIONAL MINUS SIGN   39700000
         BE    PZCON1                   STEP PAST IF PRESENT            39800000
         CLI   CHAR1,JPLUS              CHECK FOR OPTIONAL PLUS SIGN    39900000
         BNE   PZCON2                   SKIP IF NOT PRESENT             40000000
PZCON1   AR    R5,R2                    ADVANCE COLUMN POINTER          40100000
PZCON2   SR    R11,R2                   KEEP COUNT OF DIGITS            40200000
         AIF   ('&TESTRAN' NE 'YES').TEST11                             40300000
         SR    R0,R1                    COUNT SCALE                     40400000
.TEST11  CLI   CHAR1,J9                 SEE IF VALID DECIMAL DIGIT      40500000
         BNH   PZCON1                   LOOP IF YES                     40600000
         CLI   CHAR1,JPERIOD            CHECK FOR DECIMAL POINT         40700000
         BNE   PZEND                    END-OF-CONSTANT ENCOUNTERED     40800000
         AR    R11,R2                   PERIODS DO NOT COUNT            40900000
         TS    PERIOD                   SEE IF PERIOD ALLOWED           41000000
         AIF   ('&TESTRAN' NE 'YES').TEST12                             41100000
         LR    R1,R2                    BUMPER                          41200000
.TEST12  BZ    PZCON1                   ALLOW                           41300000
         B     DCABORT                  MORE THAN ONE SPELLS ERROR      41400000
         SPACE                                                          41500000
XBEND    SRA   R11,D3                   GET COUNT IN BYTES              41600000
         LCR   R11,R11                  GET ABSOLUTE COUNT              41700000
         BNP   DCABORT                  NULL CONSTANT                   41800000
         BAL   R3,SCANDEL               TEST FOR END-OF-OPERAND         41900000
XBCON    L     R3,OPNEND                POINT TO END OF OPERAND         42000000
         SR    R11,R11                  INITIALIZE ACCUMULATOR          42100000
XBCON1   CLC   CHAR1,HILIMIT            TEST FOR VALID DIGIT            42200000
         BH    XBEND                    MAY BE END OF CONSTANT          42300000
         CLI   CHAR1,JQUOTE             SEE IF A QUOTE                  42400000
         BNE   TSTAM                    SKIP IF NOT                     42500000
         CLI   CHAR2,JQUOTE             SEE IF PAIRED QUOTES            42600000
         BNE   XBEND                    END-OF-CONSTANT ENCOUNTERED     42700000
         B     TSTAM1                   PAIRED QUOTES                   42800000
         SPACE                                                          42900000
ADEND    BAL   R3,SCANDEL1              TEST FOR END-OF-OPERAND         43000000
ADCON    MVC   SUBFIELD,DCSWTCH         SUBFIELD ALLOWED/DISALLOWED     43100000
ADCON1   BAL   R3,EXPR2                 SCAN EXPRESSION                 43200000
         CLI   CHAR1,JLPARN             SUBFIELD ENCOUNTERED            43300000
         BNE   ADEND                    SKIP IF NO SUBFIELD             43400000
         TS    SUBFIELD                 SUBFIELD ALLOWED HERE           43500000
         BZ    EXPR1                    SCAN EXPRESSION                 43600000
         B     DCABORT                  ERROR IF SUBFIELD NOT ALLOWED   43700000
         EJECT                                                          43800000
QQEND    GOIF  (NOESD,NOESDS),ANY=QQEND1     SKIP IF ESD NOT OPTIONED   43900000
         GOTO  QCON                     GO CREATE ESD ENTRY             44000000
QQEND1   BAL   R3,SCANDEL1              END OF CONSTANT PROCESSING      44100000
QQCON    BAL   R3,SYMSCAN               SCAN SYMBOL                     44200000
         B     QQEND                    LOOP                            44300000
         SPACE                                                          44400000
VVEND    GOIF  (NOESD,NOESDS),ANY=VVEND1     SKIP IF NO ESD             44500000
         GOTO  VCON                     GO MAKE ESD ENTRY               44600000
VVEND1   BAL   R3,SCANDEL1              END OF CONSTANT PROCESSING      44700000
VVCON    BAL   R3,SYMSCAN               SCAN FOR SYMBOL                 44800000
         LH    R14,SYMCOUNT             COUNT OF SYMBOLS                44900000
         BCTR  R14,R0                   MINUS ONE                       45000000
         SRDL  R14,D3                   GET BYTE                        45100000
         SRL   R15,D29                  AND BIT                         45200000
         LA    R1,BIT0                  GET BIT MASK                    45300000
         SRL   R1,D0(R15)               SET UP BIT MASK                 45400000
         LA    R15,VEETABLE(R14)        POINT TO ARRAY                  45500000
         EX    R1,VVCON1                INDICATE V-CON                  45600000
         B     VVEND                    SKIP                            45700000
VVCON1   OI    D0(R15),D0               EXECUTED INSTRUCTION            45800000
         SPACE                                                          45900000
FDEND    BAL   R3,SCANDEL1              TEST FOR END-OF-OPERAND         46000000
FDCON    STH   R2,PERIOD                ALLOW PERIOD AND EXPONENT       46100000
FDCON1   LR    R11,R2                   INITIALIZE DIGIT COUNT          46200000
         CLI   CHAR1,JMINUS             SEE IF MINUS SIGN               46300000
         BE    FDCON2                   BUMP COLUMN POINTER IF YES      46400000
         CLI   CHAR1,JPLUS              SEE IF PLUS SIGN                46500000
         BNE   FDCON3                   SKIP IF NOT                     46600000
FDCON2   AR    R5,R2                    ADVANCE COLUMN POINTER          46700000
FDCON3   SR    R11,R2                   COUNT DECIMAL DIGITS            46800000
         CLI   CHAR1,JA                 SEE IF DECIMAL DIGIT            46900000
         BL    FDCON2                   LOOP FOR DECIMAL DIGITS         47000000
         CLI   CHAR1,JPERIOD            SEE IF PERIOD                   47100000
         BNE   FDCON4                   SKIP IF NOT                     47200000
         AR    R11,R2                   RESET COUNT                     47300000
         TS    PERIOD                   PERIOD ALLOWED                  47400000
         BZ    FDCON2                   GO IF PERIOD ALLOWED            47500000
         B     DCABORT                  ERROR IF PERIOD NOT ALLOWED     47600000
FDCON4   LTR   R11,R11                  SEE IF ANY VALID DECIMAL DIGITS 47700000
         BNM   DCABORT                  ERROR IF NO DIGITS              47800000
         CLI   CHAR1,JE                 SEE IF EXPONENT SPECIFIED       47900000
         BNE   FDEND                    SKIP IF NO EXPONENT SPECIFIED   48000000
         AR    R5,R2                    POINT PAST DELIMITER            48100000
         TS    PERIOD                   INDICATE PERIOD NOT ALLOWED     48200000
         TS    EXPONENT                 SEE IF EXPONENT ALLOWED         48300000
         BZ    FDCON1                   SCAN EXPONENT FIELD             48400000
         B     DCABORT                  ERROR IF MORE THAN ONE EXPONENT 48500000
         SPACE                                                          48600000
TSTAM    CLI   CHAR1,JAMPER             SEE IF AN AMPERSAND             48700000
         BNE   TSTAM2                   SKIP IF NOT                     48800000
         CLI   CHAR2,JAMPER             SEE IF PAIRED AMPERSANDS        48900000
         BNE   DCABORT                  ERROR IF AMPERSANDS NOT PAIRED  49000000
TSTAM1   AR    R5,R2                    ADVANCE COLUMN POINTER          49100000
TSTAM2   SH    R11,BITINCR              COUNT BITS IN ACCUMULATOR       49200000
         BXLE  R5,R2,XBCON1             REPEAT PROCEDURE                49300000
         B     DCABORT                  SYNTAX ERROR IF NO DELIMITER    49400000
         SPACE                                                          49500000
SCANDEL  GOIF  LMOD,ON=SCANDEL1         SKIP IF EXPLICIT LENGTH         49600000
         TM    DCALIGN,BIT7             SEE IF B-, C-, P-, X-, Z-TYPE   49700000
         BZ    SCANDEL0                 SKIP IF NOT                     49800000
         XI    DCALIGN,BIT7             ALLOW ONCE ONLY                 49900000
         MVI   LATTR+D1,D0              ALLOW                           50000000
SCANDEL0 BAL   R9,AGAIN                 SET LENGTH ATTRIBUTE            50100000
SCANDEL1 AL    R4,CONLNG                ACCUMULATE LENGTH OF CONSTANT   50200000
         LR    R14,R5                   SAVE COLUMN POINTER             50300000
         AR    R5,R2                    ADVANCE COLUMN POINTER          50400000
         AIF   ('&TESTRAN' NE 'YES').TEST06                             50500000
         LH    R0,CONCT                 COUNT NUMBER OF CONSTANTS       50600000
         AR    R0,R2                    COUNT                           50700000
         STH   R0,CONCT                 SAVE                            50800000
.TEST06  ANOP                                                           50900000
         CLC   CHAR1-CHAR1(,R14),RTDEL  SEE IF VALID DELIMITER          51000000
         BE    ENDOPRN                  END-OF-OPERAND ENCOUNTERED      51100000
         CLI   CHAR1-CHAR1(R14),JCOMMA  CHECK FOR MULTIPLE CONSTANTS    51200000
         BCR   D8,R3                    REPEAT FOR MULTIPLE CONSTANTS   51300000
         B     DCABORT                  INVALID DELIMITER               51400000
         SPACE                                                          51500000
SYMSCAN  CLI   CHAR1,JAT                SEE IF VALID CHARACTER          51600000
         BH    DCABORT                  INVALID CHARACTER               51700000
         CLI   CHAR1,JA                 SEE IF VALID CHARACTER          51800000
         BL    DCABORT                  INVALID CHARACTER               51900000
         LR    R14,R5                   SAVE SYMBOL POINTER             52000000
SYMSCAN1 AR    R5,R2                    LOOK AT NEXT CHARACTER          52100000
         CLI   CHAR1,JEQUAL             SEE IF DELIMITER                52200000
         BL    SYMSCAN1                 LOOP FOR DELIMITER              52300000
         CLI   CHAR1,JRPARN             TEST FOR VALID DELIMITER        52400000
         BE    SYMSCAN2                 VALID DELIMITER                 52500000
         CLI   CHAR1,JCOMMA             TEST FOR ALTERNATE DELIMITER    52600000
         BNE   DCABORT                  INVALID DELIMITER               52700000
SYMSCAN2 LR    R15,R5                   SAVE POINTER                    52800000
         SR    R15,R14                  GET LENGTH OF SYMBOL            52900000
         CH    R15,=H'8'                SEE IF NOT TOO LONG             53000000
         BH    DCABORT                  SYMBOL TOO LONG                 53100000
         SR    R15,R2                   GET MACHINE LENGTH              53200000
         MVC   XNAME,=8AL1(JBLANK)      PAD WITH BLANKS                 53300000
         EX    R15,MOVENAME             ISOLATE NAME                    53400000
         LH    R14,SYMCOUNT             GET SYMBOL COUNT                53500000
         AR    R14,R2                   INCREMENT BY ONE                53600000
         STH   R14,SYMCOUNT             PASS                            53700000
         GOIF  LTORGSCN,OFF=(R3)        RETURN IF THROUGH               53800000
         GOIF  MODE2,ON=(R3)            CHECK MODE                      53900000
         CLI   SCADDR,VVCON-SCAD        SEE IF V-TYPE ADDRESS CONSTANT  54000000
         BNE   SYMSCAN3                 NEAH                            54100000
         OI    XNAME,BIT0               PERMUTE NAME TO INTERNAL FORM   54200000
SYMSCAN3 GOTO  REFER                    PUT OUT RECORD                  54300000
         BR    R3                       RETURN                          54400000
         SPACE                                                          54500000
MOVENAME MVC   XNAME(0),CHAR1-CHAR1(R14)     EXECUTED INSTRUCTION       54600000
         SPACE                                                          54700000
DCTYPES  EQU   *-1                      SWITCH CODE FOR DATA TYPES    X 54800000
ACON     DC    AL1(B'10000000',JLPARN,JRPARN,ADCON-SCAD,4,1),HL2'32'  X 54900000
BCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,XBCON-SCAD,1,1),HL2'2048,1'55000000
               ',AL1(J1)                                              X 55100000
CCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,XBCON-SCAD,1,1),HL2'2048,8'55200000
               ',AL1(X'FF')                                           X 55300000
DCON     DC    AL1(B'11000000',JQUOTE,JQUOTE,FDCON-SCAD,8,1),HL2'64'  X 55400000
ECON     DC    AL1(B'11000000',JQUOTE,JQUOTE,FDCON-SCAD,4,1),HL2'64'  X 55500000
HCON     DC    AL1(B'11000000',JQUOTE,JQUOTE,FDCON-SCAD,2,1),HL2'64'  X 55600000
LCON     DC    AL1(B'11100000',JQUOTE,JQUOTE,FDCON-SCAD,8,1),HL2'128' X 55700000
PCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,PZCON-SCAD,1,1),HL2'128' X 55800000
QCON     DC    AL1(B'00000000',JLPARN,JRPARN,QQCON-SCAD,4,8),HL2'32'  X 55900000
SCON     DC    AL1(B'00000000',JLPARN,JRPARN,ADCON-SCAD,2,16),HL2'16' X 56000000
VCON     DC    AL1(B'00010000',JLPARN,JRPARN,VVCON-SCAD,4,24),HL2'32' X 56100000
XCON     DC    AL1(B'10000000',JQUOTE,JQUOTE,XBCON-SCAD,1,1),HL2'2048,4'56200000
               ',AL1(JF)                                              X 56300000
YCON     DC    AL1(B'10000000',JLPARN,JRPARN,ADCON-SCAD,2,1),HL2'16'  X 56400000
ZCON     DC    AL1(B'10001000',JQUOTE,JQUOTE,PZCON-SCAD,1,1),HL2'128' X 56500000
         SPACE                                                          56600000
DCTABLE  EQU   *                        DATA TYPE TABLE                 56700000
         DC    10YL1(ILLEGAL-DCTYPES)   0-9 INVALID DC/DS TYPES         56800000
         DC    YL1(ACON-DCTYPES)        A-TYPE ADDRESS                  56900000
         DC    YL1(BCON-DCTYPES)        BINARY                          57000000
         DC    YL1(CCON-DCTYPES)        CHARACTER                       57100000
         DC    YL1(DCON-DCTYPES)        DOUBLE PRECISION FLOATING POINT 57200000
         DC    YL1(ECON-DCTYPES)        SINGLE PRECISION FLOATING POINT 57300000
         DC    YL1(FCON-DCTYPES)        FULLWORD FIXED POINT            57400000
         DC    YL1(GCON-DCTYPES)        G-ILLEGAL DC/DS TYPE            57500000
         DC    YL1(HCON-DCTYPES)        HALFWORD FIXED POINT            57600000
         DC    YL1(ICON-DCTYPES)        I-ILLEGAL DC/DS TYPE            57700000
         DC    YL1(JCON-DCTYPES)        J-ILLEGAL DC/DS TYPE            57800000
         DC    YL1(KCON-DCTYPES)        K-ILLEGAL DC/DS TYPE            57900000
         DC    YL1(LCON-DCTYPES)        EXTRA LONG PRECISION FLT POINT  58000000
         DC    YL1(MCON-DCTYPES)        M-ILLEGAL DC/DS TYPE            58100000
         DC    YL1(NCON-DCTYPES)        N-ILLEGAL DC/DS TYPE            58200000
         DC    YL1(OCON-DCTYPES)        O-ILLEGAL DC/DS TYPE            58300000
         DC    YL1(PCON-DCTYPES)        PACKED DECIMAL                  58400000
         DC    YL1(QCON-DCTYPES)        Q-TYPE ADDRESS                  58500000
         DC    YL1(RCON-DCTYPES)        R-ILLEGAL DC/DS TYPE            58600000
         DC    YL1(SCON-DCTYPES)        S-TYPE ADDRESS                  58700000
         DC    YL1(TCON-DCTYPES)        T-ILLEGAL DC/DS TYPE            58800000
         DC    YL1(UCON-DCTYPES)        U-ILLEGAL DC/DS TYPE            58900000
         DC    YL1(VCON-DCTYPES)        V-TYPE ADDRESS                  59000000
         DC    YL1(WCON-DCTYPES)        W-INVALID DC/DS TYPE            59100000
         DC    YL1(XCON-DCTYPES)        HEXADECIMAL                     59200000
         DC    YL1(YCON-DCTYPES)        Y-TYPE ADDRESS                  59300000
         DC    YL1(ZCON-DCTYPES)        ZONED DECIMAL                   59400000
         SPACE                                                          59500000
SCAD     EQU   PZCON                    PIVOT                           59600000
FCON     EQU   ECON                     SAME AS E-TYPE                  59700000
ILLEGAL  EQU   DCTYPES                  ILLEGAL DC/DS TYPE              59800000
GCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              59900000
ICON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60000000
JCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60100000
KCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60200000
MCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60300000
NCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60400000
OCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60500000
RCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60600000
TCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60700000
UCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60800000
WCON     EQU   ILLEGAL                  ILLEGAL DC/DS TYPE              60900000
         SPACE                                                          61000000
XDSCAN   BALR  R14,R7                   SAVE REGISTERS IN STACK         61100000
         LR    R6,R10                   FAKE CURRENT CONTROL SECTION    61200000
         MVC   RESDI(D6),EESDI          PASS ESDID                      61300000
         MVI   TYPECALL,DSCALL+DXDALIGN+NOESD     PARAMETERS            61400000
         BALR  R9,R12                   SCAN OPERAND                    61500000
         B     EXIT                     RETURN                          61600000
         AIF   ('&TESTRAN' NE 'YES').MEND                               61700000
         SPACE                                                          61800000
SYMPUNCH BALR  R14,R7                   SAVE REGISTERS                  61900000
         LR    R8,R12                   SET UP BASE REGISTER            62000000
         LR    R2,R10                   LENGTH PARAMETER                62100000
         LA    R3,ORGBYTE               LOAD ADDRESS OF ORGBYTE INTO R3 62200000
         LM    R10,R12,SYMCARD          GET ADDRESS OF CARD BUFFER      62300000
         LTR   R12,R12                  SEE IF ROOM LEFT ON CARD        62400000
         BZ    GETCARD                  NO MORE ROOM                    62500000
         CR    R12,R2                   SEE IF ENOUGH ROOM              62600000
         BNL   SYMOVE                   ENOUGH, MOVE IT                 62700000
         SR    R2,R12                   DO WHAT WE CAN                  62800000
         BCTR  R12,D0                   MOVE LENGTH                     62900000
         EX    R12,SYMOVA               MOVE IT IN                      63000000
         LA    R3,D1(R3,R12)            POINT TO THE STUFF NOT MOVED    63100000
         MVI   D11(R11),D2*D28          LENGTH OF TESTRAN DATA          63200000
GETCARD  JPUNCH  SEQ=YES                GET A BUFFER                    63300000
         MVC   D0(D4,R11),=AL1(X'02',JS,JY,JM)    'SYM' CARD IDENTIFIER 63400000
         TR    D1(71,R11),JTRTABLE      TRANSLATE TO EXTERNAL FORMAT    63500000
         MVI   D10(R11),D0              INITIALIZE DATA LENGTH          63600000
         LA    R12,D28*D2               LENGTH OF TESTRAN DATA ALLOWED  63700000
         LR    R10,R11                  ADDRESS OF FIRST BYTE OF DATA   63800000
SYMOVE   SR    R12,R2                   USING UP THIS MUCH              63900000
         BCTR  R2,D0                    MACHINE LENGTH                  64000000
         EX    R2,SYMOVA                MOVE IT                         64100000
         LA    R10,D1(R10,R2)           POINT TO NEXT AVAILABLE COLUMN  64200000
         STM   R10,R12,SYMCARD          SAVE THE GARBAGE                64300000
         SLR   R10,R11                  GET DATA LENGTH                 64400000
         STC   R10,D11(,R11)            INDICATE DATA LENGTH ON CARD    64500000
         B     EXIT                     BUG OUT                         64600000
SYMOVA   MVC   D16(D0,R10),D0(R3)       EXECUTED INSTRUCTION            64700000
         SPACE                                                          64800000
DATABLE  EQU   *-D10                    TESTRAN DATA TYPE TABLE         64900000
         DC    AL1(DTYPEA)              A-TYPE                          65000000
         DC    AL1(DTYPEB)              B-TYPE                          65100000
         DC    AL1(DTYPEC)              C-TYPE                          65200000
         DC    AL1(DTYPED)              D-TYPE                          65300000
         DC    AL1(DTYPEE)              E-TYPE                          65400000
         DC    AL1(DTYPEF)              F-TYPE                          65500000
         DC    AL1(0)                   INVALID                         65600000
         DC    AL1(DTYPEH)              H-TYPE                          65700000
         DC    AL3(0)                   INVALID                         65800000
         DC    AL1(DTYPEL)              L-TYPE                          65900000
         DC    AL3(0)                   INVALID                         66000000
         DC    AL1(DTYPEP)              P-TYPE                          66100000
         DC    AL1(DTYPEQ)              Q-TYPE                          66200000
         DC    AL1(0)                   INVALID                         66300000
         DC    AL1(DTYPES)              S-TYPE                          66400000
         DC    AL2(0)                   INVALID                         66500000
         DC    AL1(DTYPEV)              V-TYPE                          66600000
         DC    AL1(0)                   INVALID                         66700000
         DC    AL1(DTYPEX)              X-TYPE                          66800000
         DC    AL1(DTYPEY)              Y-TYPE                          66900000
         DC    AL1(DTYPEZ)              Z-TYPE                          67000000
.MEND    MEND                                                           67100000
