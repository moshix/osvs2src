         MACRO                                                          00080000
&ID      XFOUR &DUMMY,&TESTRAN=NO,&DIAG=NO,&LEVEL=1                     00160000
         GBLC  &COMPNM                  COMPONENT NAME                  00240000
         LCLC  &NM                      MODULE NAME                     00320000
         JHEAD 'SYMBOL RESOLUTION PHASE MAIN LINE CONTROL',            ,00400000
               PHASEID=&ID,                                            ,00480000
               LEVEL=&LEVEL                                             00560000
&NM      SETC  '&COMPNM'.'&ID'                                          00640000
*TITLE-  ASSEMBLER SYMBOL RESOLUTION PHASE                            * 00720000
*                                                                     * 00800000
*FUNCTION/OPERATION-                                                  * 00880000
*        RESOLVE SYMBOLS FOR THE ASSEMBLY PHASE                       * 00960000
*        GENERATE THE EXTERNAL SYMBOL DICTIONARY (ESD)                * 01040000
*        PUNCH RECORDS GENERATED BY 'PUNCH' AND 'REPRO' STATEMENTS    * 01120000
*   BEFORE THE ESD                                                    * 01200000
         AIF   ('&TESTRAN' NE 'YES').PCH                                01280000
*        PUNCH TESTRAN RECORDS                                        * 01360000
.PCH     ANOP                                                           01440000
*                                                                     * 01520000
*ENTRY POINT-                                                         * 01600000
         ENTRY &NM.01                                                 * 01680000
*                                                                     * 01760000
*INPUT-                                                               * 01840000
*        A FILE CREATED BY THE MACRO GENERATOR PHASE CONSISTING OF    * 01920000
*   THE FOLLOWING TYPES OF RECORDS-                                   * 02000000
*        (1)  RECORDS GENERATED BY 'PUNCH' AND 'REPRO' STATEMENTS     * 02080000
*             BEFORE THE ESD                                          * 02160000
*        (2)  SYMBOL DEFINITIONS                                      * 02240000
*        (3)  SYMBOL REFERENCES                                       * 02320000
*        (4)  LITERALS                                                * 02400000
*        (5)  ASSEMBLER OPERATIONS AFFECTING THE ESD OR STORAGE       * 02480000
*             ASSIGNMENT (START, CSECT, DSECT, COM, DXD, ENTRY,       * 02560000
*             EXTRN, WXTRN, EQU, ORG, LTORG, CNOP, DC, DS, END)       * 02640000
*                                                                     * 02720000
*OUTPUT-                                                              * 02800000
*        'PUNCH' AND 'REPRO'  RECORDS ON THE PUNCH FILES              * 02880000
*        THE ESD ON THE PRINT AND PUNCH FILES                         * 02960000
*        THE SYMBOL FILE TO THE ASSEMBLY PHASE                        * 03040000
         AIF   ('&TESTRAN' NE 'YES').PCH2                               03120000
*        TESTRAN RECORDS TO THE PUNCH FILES                           * 03200000
.PCH2    ANOP                                                           03280000
*                                                                     * 03360000
*EXTERNAL ROUTINES-                                                   * 03440000
         AIF   ('&TESTRAN' NE 'YES').EXTRN                              03520000
         EXTRN &COMPNM.X4N01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V01  03600000
         AGO   .EXTRN1                                                  03680000
.EXTRN   EXTRN &COMPNM.X4D01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V01  03760000
.EXTRN1  ANOP                                                           03840000
*             BLDESD-    BUILD CONTROL SECTION ENTRY IN ESD           * 03920000
*             DCSCAN-    EVALUATE DC/DS OPERANDS AND LITERALS         * 04000000
*             XDSCAN-    EVALUATE DXD OPERANDS                        * 04050000
*             ENTRY-     PROCESS ENTRY POINT SYMBOL                   * 04080000
*             EVAL-      EVALUATE EXPRESSION                          * 04160000
*             EXTRN-     PROCESS EXTERNAL REFERENCE SYMBOL            * 04240000
*             FIND-      FIND AN ENTRY IN THE SYMBOL TABLE            * 04320000
*             GETESD-    GET AN ESD ENTRY                             * 04400000
*             MAKESD-    OUTPUT THE ESD                               * 04480000
*             SUBSET-    SUBSET THE SYMBOL TABLE                      * 04560000
*                                                                     * 04640000
*        ROUTINES IN THE CONTROLLER TO PERFORM INPUT/OUTPUT AND OTHER * 04720000
*   SYSTEM DEPENDENT FUNCTIONS-                                       * 04800000
*             JCHECK-    WAIT FOR COMPLETION OF A JREAD OR JWRITE     * 04880000
*             JFRECORE-  RELEASE MAIN STORAGE ALLOCATED BY JGETCORE   * 04960000
*             JGETCORE-  ALLOCATE MAIN STORAGE FOR WORK AREA          * 05040000
*             JGETL-     READ LOGICAL RECORD (LOCATE MODE)            * 05120000
*             JNOTE-     PROVIDE RECORD POSITION                      * 05200000
*             JPOINT-    POSITION TO A RECORD                         * 05280000
*             JPUTL-     WRITE LOGICAL RECORD (LOCATE MODE)           * 05360000
*             JPUTM-     WRITE LOGICAL RECORD (MOVE MODE)             * 05440000
*             JREAD-     READ PHYSICAL RECORD                         * 05520000
*             JWRITE-    WRITE PHYSICAL RECORD                        * 05600000
*                                                                     * 05680000
*EXITS, NORMAL-                                                       * 05760000
*        EXITS TO THE CONTROLLER                                      * 05840000
*                                                                     * 05920000
*EXITS, ERROR-                                                        * 06000000
*        NONE                                                         * 06080000
*                                                                     * 06160000
*TABLES/WORK AREAS-                                                   * 06240000
*        WORK AREA ALLOCATED BY JGETCORE ROUTINE IN THE CONTROLLER    * 06320000
*                                                                     * 06400000
*ATTRIBUTES-                                                          * 06480000
*        REFRESHABLE                                                  * 06560000
*                                                                     * 06640000
*NOTES-                                                               * 06720000
*                                                                     * 06800000
         EJECT                                                          06880000
         COPY  JCOMMON                                                  06960000
         EJECT                                                          07040000
         COPY  JTEXT                                                    07120000
         EJECT                                                          07200000
         COPY  ICOMMON                                                  07280000
         EJECT                                                          07360000
JTEXT    DSECT ,                                                        07440000
         ORG   JTEXT                    OVERLAY                         07520000
         COPY  RSYMRCD                                                  07600000
         EJECT                                                          07680000
* VS1 RELEASE 3.1 CHANGES                                               07730003
*A413300-413520                                                 OX00873 07730405
*C413600                                                        OX00873 07732005
*D257600                                                        OX04097 07734005
*C258400                                                        OX04097 07736005
*A478100-478400                                                 OY02611 07738005
*D479200                                                        OY02611 07738405
*A494700-495920                                                 OY02611 07738805
*A487700-487900,602100-602300                                  @OX07274 07739205
*C488000,602400                                                @OX07274 07739605
*C487900,586400,602100                                         @OX10361 07739705
*A586900-587100                                                @OX10361 07740105
*A338100-338320                                                @OY08064 07741705
*C337600                                                       @OY08064 07742105
*C341600                                                       @PI01040 07743705
*A342100-342200                                                @PI01040 07745705
*A257300                                                       @OY09620 07747705
*C255400,260000                                                @OY09620 07748105
*D478100-478200,495700-495920                                  @OX09723 07758106
*C478400,495200,608800                                         @OX09723 07758506
*A554900,558100,494900-495160,495700,608500-608700             @OX09723 07758906
*A309300-309800                                                @OY10603 07759006
*C256800                                                       @OZ07355 07759406
*C496000                                                       @AX14216 07759506
*C495120                                                       @AZ16488 07759900
*A448100,448200                                                @AZ18392 07760000
&NM.00   CSECT                                                          07780000
         JMODID                                                         07840000
         USING &NM.01,R12                                               07920000
&NM.01   DS    0H                       PHASE ENTRY                     08000000
I        LA    R14,IIII                 DEFINE ENTRY                    08080000
II       JSAVE BASE=NO                  PUSH REGISTERS                  08160000
         BR    R14                      PROCEED                         08240000
III      JRETURN                        PHASE EXIT                      08320000
         AIF   ('&TESTRAN' NE 'YES').X4DA                               08400000
         DC    A(&COMPNM.X4N01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V0X08480000
               1)                       EXTERNAL ROUTINE BASE           08560000
         AGO   .X4NA                                                    08640000
.X4DA    DC    A(&COMPNM.X4D01,&COMPNM.X4E01,&COMPNM.X4S01,&COMPNM.X4V0X08720000
               1)                       EXTERNAL ROUTINE BASE           08800000
.X4NA    ANOP                                                           08880000
IIII     LR    R8,R12                   BASE REGISTER                   08960000
         DROP  R12                                                      09040000
         USING &NM.01,R8                                                09120000
         SPACE                                                          09200000
*                        INITIALIZATION                               * 09280000
         SPACE                                                          09360000
         LH    R11,=Y(MAXDBL)                                           09440000
         JGETCORE  MINDBL=MINDBL,MAXDBL=(R11)  GET STORAGE              09520000
         LR    R7,R10                   INITIALIZE COMMON AREA BASE     09600000
         XC    D0*256(256,R7),D0*256(R7)                                09760000
         XC    D1*256(256,R7),D1*256(R7)                                09840000
         XC    D2*256(256,R7),D2*256(R7)                                09920000
         XC    D3*256(256,R7),D3*256(R7)                                10000000
         XC    D4*256(256,R7),D4*256(R7)                                10080000
         XC    D5*256(256,R7),D5*256(R7)                                10160000
         XC    D6*256(256,R7),D6*256(R7)                                10260000
         XC    D7*256(256,R7),D7*256(R7)                                10310000
         MVC   SAVE(IIII-II),II         INITIALIZE COMMON               10480000
*                                                                       10530000
*        INITIALIZE WORK AREA FOR SYMBOL TABLE ROUTINES                 10540000
*                                                                       10550000
         AR    R11,R10                  POINT TO END OF COMMON          10560000
         LR    R14,R11                  FIRST SYMBOL TABLE ENTRY        10610000
         LR    R15,R11                  X                               10620000
         LH    R0,=H'-20'               INCREMENT                       10630000
         LA    R1,ENDOFCOM+D20*D2       LAST SYMBOL TABLE ENTRY         10700000
         STM   R14,R1,SYMDIMEN          X                               10720000
*                                                                       11090000
*        INITIALIZE WORK AREA FOR LITERAL PROCESSING                    11100000
*                                                                       11110000
         LA    R10,ENDOFCOM             END-OF-COMMON                   11112000
         LA    R11,ENDOFCOM+D20         FIRST LITERAL ENTRY             11114000
         STM   R10,R11,LATADD           ADDRESS OF ADJUSTMENT TABLE     11120000
*                                                                       11330000
*        INITIALIZE WORK AREA FOR ESD PROCESSING                        11340000
*                                                                       11350000
         L     R15,=Y(D20*D16+D4,0)     BLOCK LENGTH                    11352000
         LA    R14,ESDBLK1+D4           GET ADDRESS OF FIRST BLOCK      11360000
         STM   R14,R15,ESDBLK1          PUT IN PARAMETER FOR READ/WRITE 11440000
         LA    R14,ESDBLK2+D4           GET ADDRESS OF SECOND BLOCK     11520000
         STM   R14,R15,ESDBLK2          PUT IN PARAMETER FOR READ/WRITE 11600000
         MVI   HIDESDID,DSW             ORGIN OF DSECT ESDID            11920000
*                                                                       11930000
*        INITIALIZE WORK AREA FOR EXPRESSION EVALUATION ROUTINE         11970000
*                                                                       11980000
         LA    R14,TERMS                START OF TERMS STACK            11990000
         LA    R15,RLIST                START OF RELOCATABILITY STACK   12000000
         LA    R0,OPRNS-D1              START OF OPERATOR STACK         12050000
         STM   R14,R0,ATPTR             X                               12400000
         TS    SELFDEFN                 ASSUMED INITIAL SETTING         12480000
         MVI   CLCLNG+D1,D1             LENGTH ATTRIBUTE OF ASTERISK    12560000
         SPACE                                                          12610000
         LA    R14,ESDBLK1              ADDRESS OF ONE BLOCK            12690000
         LA    R15,ESDBLK2              ADDRESS OF OTHER BLOCK          12770000
         STM   R14,R15,JFWORD1          STORE BOTH                      12850000
         MVC   NOTELIST(D8),JFWORD1     INITIALIZE FIRST ESD BLOCK      12930000
         MVC   NOTELIST+D9(D8),JFWORD2  INITIALIZE OTHER ESD BLOCK      13010000
         MVI   NOTELIST+L'JNOTEVAL,X'01'     X                          13120000
         MVI   NOTELIST+L'JNOTEVAL*2+1,X'01' X                          13440000
         LA    R6,ESDBLK1+D8            DUMMY POINTER                   13520000
         SPACE                                                          13600000
*TITLE-  GETNEXT                                                      * 13680000
*                                                                     * 13760000
*FUNCTION/OPERATION-                                                  * 13840000
*        THIS ROUTINE IS THE MAIN LINE CONTROL AND DRIVER FOR THE     * 13920000
*   SYMBOL RESOLUTION PHASE.  THIS ROUTINE GETS THE NEXT LOGICAL      * 14000000
*   RECORD FROM THE CURRENT INPUT FILE AND PASSES CONTROL TO ONE OF   * 14080000
*   THE FUNCTIONAL ROUTINES FOR PROCESSING.  THE FUNCTIONAL ROUTINE   * 14160000
*   SELECTED IS DEPENDENT UPON THE RECORD TYPE AND THE CURRENT MODE.  * 14240000
*   IF IN PASS ONE ASSIGNMENT MODE, THIS ROUTINE ALSO ADJUSTS THE     * 14320000
*   CURRENT LOCATION COUNTER AND SETS UP THE OPERAND COLUMN POINTER.  * 14400000
*                                                                     * 14480000
*INPUT-  NONE                                                         * 14560000
*                                                                     * 14640000
*OUTPUT- REGISTER R3 CONTAINS THE CURRENT LOCATION COUNTER VALUE.     * 14720000
*        REGISTER R4 IS A POINTER TO THE INPUT RECORD.                * 14800000
*        REGISTER R5 IS A POINTER TO THE OPERAND FILED.               * 14880000
*                                                                     * 14960000
         SPACE                                                          15040000
GETNEXT  LH    R10,JINFILE              GET ADDRESS OF INPUT FILE       15120000
         JGETL FILE=(R10)               GET NEXT RECORD                 15200000
         LR    R4,R11                   RECORD POINTER                  15280000
         SR    R1,R1                    CLEAR REGISTER                  15360000
         IC    R1,JTIOP1                GET RECORD TYPE                 15440000
         AR    R1,R1                    GET INDEX                       15520000
         LH    R2,MODE                  GET MODE                        15600000
         L     R2,RADIX(R2)             GET RADIX                       15680000
         SH    R2,D0(R1,R2)             GET ROUTINE VECTOR              15760000
         GOIF  (MODE1,MODE2)            SEE IF PASS 1 ASSIGNMENT MODE   15840000
         BNER  R2                       GO TO RESPECTIVE ROUTINES IF NO 15920000
* DO NOT MOVE INPUT RECORD IF SYMBOL OVERFLOW HAS NOT OCCURED           16000000
         GOIF IOFLO,OFF=DONTMOVE                                        16050000
* DO NOT MOVE REFERENCE RECORD                                          16060000
         GOIF JTIOP,JTSYMBL,EQ=DONTMOVE                                 16070000
         LH    R1,JTRLI                 RECORD LENGTH                   16072000
         LA    R3,INPUTBUF              BUFFER ADDRESS                  16074000
         CH    R1,ADMAXMVC              EXECUTE MOVE IF                 16076000
         BNH   MOVEX                    LESS THAN MAX MOVE LENGTH       16078000
         SH    R1,ADMAXMVC              SUBTRACT MOVED BYTES            16078400
         MVC   D0(MAXMVC,R3),D0(R4)     MOVE MAX LENGTH                 16078800
         LA    R4,MAXMVC(,R4)           BUMP FROM ADDRESS               16079200
         LA    R3,MAXMVC(,R3)           BUMP TO ADDRESS                 16079600
MOVEX    BCTR  R1,R0                    MINUS ONE FOR EXECUTE           16079700
         EX    R1,MVCIM                 EXECUTE MOVE INSTRUCTION        16079800
         LA    R4,INPUTBUF              POINT TO LOGICAL RECORD         16079900
DONTMOVE GOIF  RFIELDX,OFF=LOCTR1       SKIP IF NO OPERAND              16106600
         LA    R5,RLNGA                 POINT TO OPERAND                16133300
         GOIF  RFIELDN,OFF=LOCTR        SKIP IF NO NAME                 16160000
         LA    R5,RLNGB                 POINT TO OPERAND                16240000
LOCTR    SR    R1,R1                    CLEAR REGISTER                  16320000
         IC    R1,CHAR1                 GET OPERAND LENGTH              16400000
         LA    R5,CHAR2(R1)             POINT TO END-OF-OPERAND         16480000
         ST    R5,OPNEND                NOTE IT                         16560000
         SR    R5,R1                    POINT TO BEGINNING-OF-OPERAND   16640000
LOCTR1   GOIF  JDEF,OFF=(R2)            SKIP UPDATE LOCATION COUNTER    16720000
         SET   JDEF,OFF                 RESET INDICATOR                 16800000
         L     R3,ELCTR                 GET CURRENT LOCATION COUNTER    16880000
         NC    RLCTR,RLCTR              SEE IF BYTES SKIPPED            16960000
         BZ    LOCTR2                   NO, PROCEED                     17040000
         BAL   R9,ALIGN1                ALIGN TO HALFWORD BOUNDARY      17120000
         DC    H'-2,1'                  ALIGNMENT PARAMETERS            17200000
         AL    R3,RLCTR                 ADD NUMBER OF BYTES SKIPPED     17280000
         ST    R3,ELCTR                 UPDATE CURRENT LOCATION COUNTER 17360000
LOCTR2   MVC   RESDI(D6),EESDI          PASS CURRENT LOCATION COUNTER   17440000
         BR    R2                       GO TO RESPECTIVE ROUTINE        17520000
         SPACE                                                          17600000
MAXMVC   EQU   256                      MAX MOVE LENGTH                 17650000
ADMAXMVC DC    H'256'                   MAX MOVE LENGTH                 17660000
MVCIM    MVC   D0(*-*,R3),D0(R4)        MOVE LOGICAL RECORD             17670000
         SPACE                                                          17672000
INPC     LA    R10,HICESDID             GET PARAMETER                   17680000
         MVC   XPARM,CSTPARM            PASS PARAMETERS                 17760000
         GOTO  BLDESD                   BUILD ESD ENTRY                 17840000
         LR    R6,R10                   MAKE CONTROL SECTION CURRENT    17920000
         AIF   ('&TESTRAN' NE 'YES').INPC                               18000000
         BAL   R9,ESDPUNCH              OUTPUT TESTRAN ITEM             18080000
.INPC    B     EPILOGUE                 FINIS                           18160000
         SPACE                                                          18240000
SEARCH   GOIF  (RFIELDN,PRIORDEF),NOTMIX=TRANSFER                       18320000
         LR    R10,R4                   PASS RECORD POINTER             18400000
         GOTO  FIND                     LOOKUP IN SYMBOL TABLE          18480000
         BNE   TRANSFER                 NOT FOUND                       18560000
         GOIF  ESDNRSW,ON=TRANSFER      DEFER FLAGGING                  18640000
         SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     18720000
         B     TRANSFER                 OUTPUT RECORD                   18800000
         SPACE                                                          18880000
EOFIIS   SET   MODE1,OFF                INDICATE END OF SUBSTITUTION    18960000
         SET   IOFLO,ON                 INDICATE TABLE OVERFLOWED       19040000
         GOIF  STBLOFLO                 SEE IF SUBSETTED                19140000
         GOTO  SUBSET                   SUBSET                          19240000
         L     R0,SYMDIMEN+D4           GET ADDRESS                     19340000
         SH    R0,=H'1024'              MARGIN                          19440000
         C     R0,LATEND                SEE IF OVERLAPPING LITERAL POOL 19760000
         BNL   GETNEXT                  ENOUGH ROOM                     19840000
         MVI   JPRTONLY,JPRONLY         SET FLUSH CONDITION             19920000
         SET   (MODE1,MODE2),ON         SET EXIT CONDITION              20000000
         B     BUGOUT                   JUST LIKE IT SAYS               20080000
         SPACE                                                          20120000
REHASH   GOIF  STBLOFLO                 SEE IF SUBSETTED                20160000
         GOTO  SUBSET                   SUBSET                          20200000
         LR    R10,R4                   POINTER                         20210000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           20240000
         B     GETNEXT                  FINIS                           20280000
         SPACE                                                          20320000
START    SR    R0,R0                    ZERO                            20400000
         CH    R0,FSTCSECT              SEE IF FIRST CSECT              20480000
         BNE   CSECT                    ILLEGAL START IF NOT FIRST      20560000
         GOIF  RFIELDX,OFF=START1       NO OPERAND                      20640000
         CLC   CHAR1(D2),=AL1(JCOMMA,JBLANK) LOOK FOR NULL OPERAND      20660000
         BE    START1                   A CLEAN START, VRRRRRRRROM      20680000
         GOTO  EVAL                     EVALUATE OPERAND                20720000
         BNZ   CSECT                    ERROR                           20800000
         GOIF  LOCTREF,ON=CSECT         LOCATION COUNTER REFERENCE      20880000
         LA    R11,D7(,R11)             ROUND TO DOUBLE WORD BOUNDARY   20960000
         ST    R11,STARTLOC             SAVE                            21040000
START1   OI    RFLGB,BIT0               INDICATE VALID START CARD       21120000
         SPACE                                                          21200000
CSECT    L     R11,CSTPARM              GET PARAMETER                   21280000
CSECT1   LA    R10,HICESDID             X                               21360000
CSECT2   ST    R11,XPARM                PASS                            21440000
         GOTO  BLDESD                   GO MAKE ESD ENTRY               21520000
         LR    R6,R10                                                   21600000
         MVC   RESDI(L'RESDI+L'RLCTR),EESDI                             21680000
         BAL   R9,WRITE2                WRITE CROSS-REFERENCE RECORD    21760000
         AIF   ('&TESTRAN' NE 'YES').CSECT                              21840000
         BAL   R9,ESDPUNCH              OUTPUT TESTRAN ITEM             21920000
.CSECT   B     EPILOGUE                 FINIS                           22000000
         SPACE                                                          22080000
DSECT    L     R11,DSTPARM              GET PARAMETER                   22160000
         LA    R10,HIDESDID                                             22240000
         B     CSECT2                                                   22320000
         SPACE                                                          22400000
COM      L     R11,COMPARM              GET PARAMETER                   22480000
         B     CSECT1                   COMMON ROUTINE                  22560000
         SPACE                                                          22640000
REPRO    JPUNCH  SEQ=NO                 GET PUNCH BUFFER                22720000
         SR    R15,R15                  CLEAR REGISTER                  22800000
         IC    R15,RESDI                GET OPERAND LENGTH              22880000
         LTR   R15,R15                  SEE IF LENGTH OF OPERAND ZERO   22960000
         BE    GETNEXT                  FINIS IF SO                     23040000
         LR    R14,R15                  CLEAR REGISTER                  23120000
         IC    R14,RFLDI                GET OUTPUT COLUMN POINTER       23200000
         BCTR  R14,0                    DECREMENT BY ONE                23280000
         BCTR  R15,0                    DECREMENT BY ONE                23360000
         AR    R11,R14                  POINT TO OUTPUT COLUMN          23440000
         EX    R15,REPRO1               MOVE IN OPERAND                 23520000
         B     GETNEXT                  FINIS                           23600000
REPRO1   MVC   D0(D0,R11),RESDI+D1      EXECUTED INSTRUCTION            23680000
         SPACE                                                          23760000
PUNCH    LA    R2,D1                    INCREMENT                       23840000
         SR    R3,R3                    ZERO REGISTER                   23920000
         IC    R3,RESDI                 OPERAND LENGTH                  24000000
         CLI   RESDI,D3                 CHECK IF NULLSTRING             24020000
         BL    GETNEXT                  ERROR IF SO                     24040000
         AR    R3,R4                    POINT TO END OF OPERAND         24080000
         BCTR  R3,D0                    MINUS ONE                       24160000
         LR    R5,R4                    POINT TO BEGINNING OF OPERAND   24240000
         CLI   D7(R5),JQUOTE            MUST BEGIN WITH A QUOTE         24320000
         BNE   GETNEXT                  ERROR IF NOT                    24400000
PUNCH1   BXH   R5,R2,GETNEXT            POINT TO NEXT CHARACTER         24480000
PUNCH2   CLI   D7(R5),JQUOTE            SEE IF CHARACTER A QUOTE        24560000
         BNE   PUNCH6                   NOT A QUOTE                     24640000
         BXLE  R5,R2,PUNCH4             A QUOTE, SEE IF PAIRED QUOTES   24720000
PUNCH3   JPUNCH  SEQ=NO                 DEL BY A TRAIL QUOTE            24800006
         LA    R4,D3(,R4)               GET OPERAND LENGTH              24880000
         SR    R5,R4                    GET LENGTH OF OPERAND           24960000
         BM    GETNEXT                  NULL QUOTES                     25040000
         LA    R1,D9*D9-D2              79                              25120000
         CR    R1,R5                    SEE IF MORE THAN 80 CHARACTERS  25200000
         BNL   PONCHO                   LESS THAN 80                    25280000
         LR    R5,R1                    OPERNAD TOO LONG                25360000
PONCHO   EX    R5,PUNCH8                MOVE IN PUNCH OPERAND           25440000
         B     GETNEXT                  FINIS                           25520000
PUNCH4   CLI   D7(R5),JQUOTE            SEE IF PAIRED QUOTES            25600000
         BNE   GETNEXT                   NOT PAIRED ', FINIS   @OZ07355 25680006
PUNCH5   BCTR  R3,D0                    OP IS 1 LESS           @OY09620 25730005
         LR    R1,R3                    POINT TO 2:ND OF PAIR   OX04097 25840005
         SR    R1,R5                    GET LENGTH OF OPERAND REMAINDER 25920000
         BM    GETNEXT                  NO ENDING QUOTE        @OY09620 26000005
         EX    R1,PUNCH9                MAKE PAIR TO APPEAR AS ONE      26080000
         B     PUNCH2                   LOOP                            26160000
PUNCH6   CLI   D7(R5),JAMPER            SEE I& AN AMPERSAND             26240000
         BNE   PUNCH1                   JUST AN ORDINARY CHARACTER      26320000
         BXH   R5,R2,GETNEXT            POINT TO NEXT CHARACTER         26400000
         CLI   D7(R5),JAMPER            SEE IF PAINER AMPERSANDS        26480000
         BE    PUNCH5                   IT HAD BETTER BE                26560000
         B     GETNEXT                  OR OTHERWISE IT IS IN ERROR     26640000
PUNCH8   MVC   D0(D0,R11),D5(R4)        MOVE OPERAND ONTO CARD          26960000
PUNCH9   MVC   D7(D0,R5),D8(R5)         OVERLAP THE REDUNDANT ONE       27040000
         SPACE                                                          27120000
DC       MVI   TYPECALL,DCCALL+DEFNAME  PARAMETER                       27200000
         GOIF  (DSW2,CSW2),NONE=DC1     ESD SUPPRESSION                 27280000
         OI    TYPECALL,NOESD           SUPPRESS ESD PROCESSING         27360000
DC1      GOIF  (RFIELDN,PRIORDEF),MIX=DC2    NAME PREVIOUSLY DEFINED    27440000
         SET   DEFNAME,OFF              NO NAME DEFINITION              27520000
DC2      GOTO  DCSCAN                                                   27600000
         LH    R0,LATTRSAV                                              27680000
         GOIF  RFIELDN,OFF=DC3          SKIP IF NO NAME                 27760000
         STH   R0,RLNGQ                 PASS                            27840000
DC3      MVC   RFLGA,OPCNT+D1           NUMBER OF GOOD OPERANDS         27920000
B52      BAL   R9,WRITE2                WRITE RECORD                    28000000
         B     EPILOGUE                 FINIS                           28080000
         SPACE                                                          28160000
DS       MVI   TYPECALL,DSCALL+DEFNAME+NOESD PARAMETER                  28240000
         B     DC1                      VINTAGE                         28320000
         SPACE                                                          28400000
ENTRY    GOTO  ENTRY                    GO TO ROUTINE                   28480000
         B     TRANSFER                 WRITE ON OUTPUT FILE            28560000
         SPACE                                                          28640000
EXTRN    MVI   RTYPE,ETYPEER            TYPE                            28720000
EXTRN1   MVI   RFLGB,ESDNRSW            SWITCH                          28800000
         GOTO  EXTRN                    GO TO ROUTINE                   28880000
         B     TRANSFER                 WRITE ON OUTPUT FILE            28960000
         SPACE                                                          29040000
WXTRN    MVI   RTYPE,ETYPEWX            TYPE                            29120000
         B     EXTRN1                   TREAT AS EXTRN                  29200000
         SPACE                                                          29280000
DXD      GOIF  RFIELDN,OFF=GETNEXT      LIKELY                          29360000
         MVI   RFLGA,D0                                                 29440000
         LR    R10,R4                                                   29520000
         GOTO  FIND                                                     29600000
         BNZ   DXD1                                                     29680000
         GOIF  ENTRYSW,ON=DXD1                                          29760000
         SET   PRIORDEF,ON                                              29840000
DXD1     LA    R0,D1                                                    29920000
         STH   R0,RLNGQ                                                 30000000
         SR    R0,R0                                                    30080000
         ST    R0,RLCTR                                                 30160000
         GOIF  PRIORDEF,ON=B52                                          30240000
         GOIF  RFIELDX,OFF=B52                                          30320000
         MVC   XPARM,DXDPARM            PASS PARAMETERS                 30400000
         LA    R10,HICESDID             PASS ESDID                      30480000
         GOTO  BLDESD                   MAKE ESD ENTRY                  30560000
         GOTO  XDSCAN                   SCAN OPERAND                    30640000
         B     DC3                      BON VOYAGE                      30720000
         SPACE                                                          30800000
EQU      LA    R3,WRITE                 EXIT TIME ADDRESS               30880000
         XC    REFCOUNT,REFCOUNT        RESET COUNT            @OY10603 30930006
         XC    SYMCOUNT,SYMCOUNT        RESET COUNT            @OY10603 30980006
         XC    RESDI(D6),RESDI                                          31080000
         GOIF  RFIELDN,OFF=(R3)                                         31300000
         MVC   RLNGQ,=H'1'              LENGTH ATTRIBUTE OF *           31360000
         BAL   R2,EQU1                  EVALUATE EXPRESSION(S)          31440000
         GOIF  PRIORDEF,ON=(R3)         EXIT IF PREVIOUSLY DEFINED      31520000
         LR    R10,R4                   PASS POINTER                    31600000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           31680000
         BER   R3                       OK                              31760000
         SET   PRIORDEF,ON              INDICATE PREVIOUSLY DEFINED     31840000
         BR    R3                       GO ANYWAY                       31920000
EQU1     GOIF  RFIELDX,OFF=(R2)         NO OPERAND, DEFAULT TO *        32000000
         CLI   CHAR1,JCOMMA             FIRST OPERAND PRESENT           32080000
         BE    EQU4                     YEAH                            32160000
         GOTO  EVAL                     EVALUATE FIRST OPERAND          32240000
         BOR   R2                       SYNTACTIC ERROR                 32320000
         BALR  R1,D0                    SAVE CONDITION CODE             32400000
         CLI   D0(R14),JBLANK           SEE IF VALID END OF OPERAND     32480000
         BE    EQU2                     YEAH                            32560000
         CLI   D0(R14),JCOMMA           THIS IS OK ALSO                 32640000
         BNER  R2                       OTHERWISE, A NO-NO              32720000
EQU2     LR    R5,R14                   COLUMN POINTER                  32800000
         SPM   R1                       SET CONDITION CODE              32880000
         BL    EQU3                     BADDIE                          32960000
         AIF   ('&TESTRAN' NE 'YES').EQUX                               33040000
         BZ    EQUABS                   BRANCH IF ABSOLUTE OPND         33060000
         LA    R3,XREF3                 EXIT IF SIMPLY RELOCATABLE      33080000
EQUABS   STH   R10,RESDI                ESDID                           33100000
         AGO   .EQUY                                                    33120000
.EQUX    STH   R10,RESDI                ESDID                           33140000
.EQUY    ST    R11,RLCTR                VALUE                           33160000
EQU3     MVC   RLNGQ,IMPLNG             LENGTH ATTRIBUTE                33200000
         MVC   RFLGB,EVALSW1            TATTLE TALE                     33240000
         CLI   CHAR1,JBLANK             END OF EVALUATION               33280000
         BER   R2                       YUP                             33360000
EQU4     LA    R5,CHAR2                 POINT TO NEXT CHARACTER         33440000
         CLI   CHAR1,JCOMMA             NULL OPERAND                    33520000
         BER   R2                       YES                             33600000
         GOTO  EVAL                     EVALUATE SECOND OPERAND         33680000
         BE    EQU6                     OK                     @OY08064 33760005
         GOIF  NOTDEFN,OFF=(R2)         ERROR - UNDEF SYMB ?   @OY08064 33810005
         SET   EQUF1,ON                 MARK IT IN RECORD      @OY08064 33820005
         BR    R2                       AND RETURN             @OY08064 33830005
EQU6     EQU   *                                               @OY08064 33832005
         CLI   D0(R14),JBLANK           SEE IF PROPERLY DELIMITED       33840000
         BE    EQU5                     YES                             33920000
         CLI   D0(R14),JCOMMA           THIS IS OK ALSO                 34000000
         BNER  R2                       THIS ISN'T                      34080000
EQU5     EQU   *                                               @OY01040 34160005
         SET   EQUF1,ON                 MARK IN CASE OF ERROR  @PI01040 34210005
         CL    R11,=F'65535'            SEE IF WITHIN ALLOWANCE@PI01040 34220005
         BHR   R2                       NOPE                            34240000
         SET   EQUF1,OFF                ALL RIGHT              @PI01040 34290005
         STH   R11,RLNGQ                LANGTH ATTRIBUTE OVERRIDDEN     34320000
         BR    R2                       RETURN                          34400000
         SPACE                                                          34480000
CNOP     BAL   R9,ALIGN                 ALIGN TO HALFWORD BOUNDARY      34560000
         DC    H'-2,1'                  ALIGNMENT PARAMETERS            34640000
         ST    R3,RLCTR                 UPDATE CURRENT LOCATION COUNTER 34720000
         BAL   R9,XREF                  CROSS REFERENCE NAME FIELD      34800000
         AIF   ('&TESTRAN' NE 'YES').CNOPY                              34880000
         BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             34960000
.CNOPY   GOIF  RFIELDX,OFF=EPILOGUE     NO OPERAND, NO GOOD             35040000
         GOTO  EVAL                     EVALUATE FIRST OPERAND          35120000
         BNE   EPILOGUE                 MUST BE ABSOLUTE                35200000
         CLI   D0(R14),JCOMMA           SEE IF THERE'S A SECOND OPERAND 35280000
         BNE   EPILOGUE                 TUBE IT IF NONE                 35360000
         LR    R2,R11                   SAVE VALUE OF FIRST OPERAND     35440000
         N     R11,=F'1'                SEE IF FIRST OPERAND IS ODD     35520000
         BNZ   EPILOGUE                 THAT'S ODD, TOO BAD             35600000
         LA    R5,D1(,R14)              POINT TO SECOND OF TWO OPERANDS 35680000
         GOTO  EVAL                     EVALUATE SECOND OPERAND         35760000
         BNE   EPILOGUE                 INVALID UNLESS IT'S ABSOLUTE    35840000
         CLI   D0(R14),JBLANK           LOOK FOR VALID DELIMITER        35920000
         BNE   EPILOGUE                 MUST BE A BLANK                 36000000
         LCR   R10,R11                  ALIGNMENT MASK                  36080000
         CL    R10,=F'-4'               FULLWORD                        36160000
         BE    CNOP1                    SKIP IF SO                      36240000
         CL    R10,=F'-8,4'             DOUBLEWORD                      36320000
         BNE   EPILOGUE                 8                               36400000
CNOP1    CLR   R2,R11                   FIRST OPERAND MUST BE SMALLER   36480000
         BNL   EPILOGUE                 OF THE TWO TO BE VALID          36560000
         NR    R3,R10                   TO SPECIFIED BOUNDARY           36640000
         AR    R3,R2                    ADD VALUE OF FIRST OPERAND      36720000
         C     R3,ELCTR                 THE RESULT SHOULD BE GREATER    36800000
         BNL   CNOP2                    THAN THE ORIGINAL VALUE         36880000
         AR    R3,R11                   OTHERWISE ADD ON SECOND OPERAND 36960000
CNOP2    ST    R3,ELCTR                 THIS IS THE NEW LOCATION        37040000
         B     EPILOGUE                 FINIS                           37120000
         SPACE                                                          37200000
ORG      BAL   R9,XREF                  CROSS REFERENCE NAME FIELD      37280000
         AIF   ('&TESTRAN' NE 'YES').ORGY                               37360000
         BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             37440000
.ORGY    LH    R10,JOUTFILE             OUTPUT FILE ADDRESS             37520000
         LA    R11,D12                  LENGTH OF RECORD                37600000
         JPUTL FILE=(R10),BUFREQ=(R11)  GET OUTPUT BUFFER               37680000
         GOIF  RFIELDX                  SEE IF THERE'S AN OPERAND       37760000
         LR    R4,R11                   RECORD POINTER                  37840000
         MVC   JTRLI(D6),LOCRCD         ADJUSTMENT RECORD               37920000
         MVC   RESDI(D6),EESDI          CURRENT ESDID AND VALUE         38000000
         BZ    ORG1                     GO TO ORG BLANK                 38080000
         CLI   CHAR1,JCOMMA             SEE IF NULL OPERAND             38160000
         BE    ORG1                     X                               38240000
         GOTO  EVAL                     EVALUATE OPERAND                38320000
         BNH   EPILOGUE                 NOT SIMPLY RELOCATABLE          38400000
         CLI   D0(R14),JBLANK           CHECK FOR PROPER DELIMITER      38480000
         BNE   EPILOGUE                 BAD DELIMITER                   38560000
         CH    R10,EESDI                SEE IF IN THIS CONTROL SECTION  38640000
         BNE   EPILOGUE                 OUT OF CONTROL, SECTIONWISE     38720000
         LTR   R11,R11                  SEE IF NEGATIVE                 38800000
         BM    EPILOGUE                 NEGATIVE, OUT OF CONTROL        38880000
         CL    R3,EHILC                 SEE IF NECESSARY TO SAVE VALUE  38960000
         BNH   ORG2                     NOPE                            39040000
         ST    R3,EHILC                 SAVE CURRENT LOCATION COUNTER   39120000
         B     ORG2                     CONTINUE                        39200000
ORG1     L     R11,EHILC                GET SAVED HIGHEST ADDRESS       39280000
         CLR   R3,R11                   SEE IF HIGHER THAN CURRENT      39360000
         BNL   ORG3                     INEFFECTIVE                     39440000
ORG2     ST    R11,ELCTR                MODIFY ADDRESS TO NEW VALUE     39520000
         ST    R11,RLCTR                PASS IN RECORD                  39600000
ORG3     MVI   RFLGB,GOODORG            INDICATE ERROR FREE ORG         39680000
GOODORG  EQU   BIT0                     X                               39760000
         B     EPILOGUE                 FINIS                           39840000
         SPACE                                                          39920000
SYMBL    LH    R14,REFCOUNT             GET COUNT                       40000000
         CH    R14,SYMCOUNT             COMPARE TO TOTAL                40080000
         BNL   SYMBOL                   SKIP IF NOT APPLICABLE          40160000
         LA    R15,D1(,R14)             BUMP COUNT                      40240000
         STH   R15,REFCOUNT             UPDATE COUNT                    40320000
         SRDL  R14,D3                   FIRST SUBSCRIPT IN R14          40400000
         SRL   R15,D29                  SECOND SUBSCRIPT IN R15         40480000
         LA    R1,BIT0                  INITIAL MASK                    40560000
         SRL   R1,D0(R15)               ADDRESS BIT                     40640000
         LA    R15,VEETABLE(R14)        ADDRESS BYTE                    40720000
         EX    R1,TMINST                SEE IF V-CON SYMBOL             40800000
         BZ    SYMBOL                   SKIP IF NOT                     40880000
         OI    RNAME,BIT0               FUDGE                           40960000
         SPACE                                                          41040000
SYMBOL   LR    R10,R4                   PARAMETER                       41120000
         GOTO  FIND                     LOOKUP IN SYMBOL TABLE          41200000
         BNE   TRANSFER                 NO FURTHER                      41280000
         CLI   JSW0033,MODE2            MODE 1S                 OX00873 41330002
         BNE   SYMBOL05                 NO,BRANCH               OX00873 41340002
         TM    RNAME,BIT0               TEST IF VCON BIT ON     OX00873 41350002
         BO    TRANSFER                 YES                     OX00873 41352002
SYMBOL05 GOIF  ENTRYSW,ON=TRANSFER      UNDEFINED ENTRY SYMBOL  OX00873 41360002
         SET   DEFINED,ON               INDICATE DEFINED                41440000
         MVC   RFLGB,SFLGS              PASS FLAGS                      41520000
         MVC   RESDI(L'RESDI+L'RLCTR),SESDI  PASS ESDID AND VALUE       41600000
         LA    R15,1                    PASS LENGTH ATTRIBUTE           41680000
         GOIF  ESDNRSW,ON=SYMBOL1       SEE IF EXTERNAL NAME            41760000
         LH    R15,SLNGQ                GET LENGTH ATTRIBUTE            41840000
SYMBOL1  STH   R15,RLNGQ                PASS LENGTH ATTRIBUTE           41920000
         GOIF  MODE1,OFF=SYMBOL2                                        42000000
         GOIF  MODE2,ON=ADJUST,ELSE=SYMBOL3                             42080000
SYMBOL2  SET   PRIORDEF,ON                                              42160000
         NI    RNAME,BITFF-BIT0                                         42240000
SYMBOL3  MVI   JTIOP1,JTADJII                                           42320000
         B     TRANSFER                 OUTPUT RECORD                   42400000
         SPACE                                                          42480000
CXD      BAL   R9,ALIGN1                ALIGN TO FULLWORD BOUNDARY      42560000
         DC    H'-4,3'                  ALIGNMENT PARAMETERS            42640000
         LA    R1,D4                    LENGTH ATTRIBUTE                42720000
         AIF   ('&TESTRAN' NE 'YES').CXD                                42800000
         ST    R3,RLCTR                 VALUE OF SYMBOL                 42880000
         BAL   R9,XREF1                 CROSS-REFERENCE NAME, IF ANY    42960000
         SET   TDATA                    INDICATE TESTRAN ITEM TYPE      43040000
         BAL   R9,ANYPUNCH              OUTPUT TESTRAN ITEM             43120000
         LA    R10,D2                   LENGTH                          43200000
         MVC   ORGBYTE(D2),=AL1(DTYPEA,D3)   DATA TYPE AND LENGTH       43280000
         BAL   R9,SYMPUNCH              OUTPUT TESTRAN ITEM             43360000
         B     EPILOGUE                 FINIS                           43440000
         AGO   .CXD1                                                    43520000
.CXD     B     MACHOP1                  SKIP                            43600000
.CXD1    SPACE                                                          43680000
CCW      BAL   R9,ALIGN                 ALIGN TO DOUBLEWORD BOUNDARY    43760000
         DC    H'-8,7'                  ALIGNMENT PARAMETERS            43840000
         LA    R1,D8                    LENGTH ATTRIBUTE                43920000
         AIF   ('&TESTRAN' NE 'YES').CCW                                44000000
         ST    R3,RLCTR                 VALUE OF SYMBOL                 44080000
         BAL   R9,XREF1                 CROSS-REFERENCE NAME, IF ANY    44160000
         SET   TCCW                     INDICATE TESTRAN ITEM TYPE      44240000
         BAL   R9,ANYPUNCH              OUTPUT TESTRAN ITEM             44320000
         B     EPILOGUE                 FINIS                           44400000
         AGO   .CCW1                                                    44480000
.CCW     B     MACHOP1                  SKIP                            44560000
.CCW1    SPACE                                                          44640000
MACHOP   BAL   R9,ALIGN                 ALIGN TO HALFWORD BOUNDARY      44720000
         DC    H'-2,1'                  ALIGNMENT PARAMETERS            44800000
         XC    REFCOUNT,REFCOUNT        ZERO REFCOUNT          @AZ18392 44810000
         XC    SYMCOUNT,SYMCOUNT        ZERO SYMCOUNT          @AZ18392 44820000
         GOIF  RFIELDN,OFF=MACHOP1      TEST IF NAME IS PRESENT         44850000
         LH    R1,RLNGQ                 LENGTH ATTRIBUTE                44880000
MACHOP1  ST    R3,RLCTR                 LOCATION COUNTER VALUE          44960000
         BAL   R9,XREF1                 CROSS-REFERENCE NAME, IF ANY    45040000
         AIF   ('&TESTRAN' NE 'YES').MACHOP                             45120000
         SET   TMOP                                                     45200000
         BAL   R9,MOPPUNCH              OUTPUT TESTRAN ITEM             45280000
.MACHOP  B     EPILOGUE                 FINIS                           45360000
         SPACE                                                          45440000
LITERAL  MVI   TYPECALL,LTCALL+NOESD    PASS PARAMETERS                 45520000
         GOTO  DCSCAN                   DETERMINE LITERAL OBJECT LENGTH 45600000
         SR    R3,R3                    DISPLACEMENT                    45680000
         LTR   R2,R15                   LENGTH OF LITERAL               45760000
         BZ    LITRPUT                  BAD IF ZERO OBJECT LENGTH       45840000
         N     R2,=F'7'                 GET MODULO SUM                  45920000
         IC    R2,INDEX(R2)             USE IT TO GET INDEX VALUE       46000000
         SR    R14,R5                   FIND LITERAL SOURCE LENGTH      46080000
         BCTR  R5,0                     POINT TO LENGTH INDICATOR       46160000
         STC   R14,CHAR1                MODIFY LITERAL SOURCE LENGTH    46240000
         CH    R14,JLITLNG              SEE IF LONGER                   46320000
         BNH   LITERAL4                 NOPE                            46400000
         STH   R14,JLITLNG              SAVE LONGER LENGTH              46480000
LITERAL4 SR    R0,R0                    ZERO R2                         46560000
         GOIF  DLOCTREF,OFF=LITERAL1    SKIP IF SO                      46640000
         LA    R0,D6                    LOCATION COUNTER REFERENCED     46720000
LITERAL1 LA    R3,LATA8-D4(R2)          POINT TO RESPECTIVE CHAIN       46800000
LITERAL2 LR    R1,R3                    TUCK ON CHAIN                   46880000
         L     R3,D0(,R1)               LOOK AT THE NEXT ENTRY          46960000
         LTR   R3,R3                    SEE IF AT THE END OF THE ROPE   47040000
         BZ    LITERAL3                 GO PUT IN ENTRY IF SO           47120000
         LTR   R0,R0                    IF LOCATION COUNTER REFERENCED  47200000
         BNZ   LITERAL2                 DON'T LOOK AT IT                47280000
         EX    R14,LITCLC               LOOK AT THIS LITERAL ENTRY      47360000
         BNE   LITERAL2                 SKIP IF NOT THE SAME            47440000
         L     R3,D4(,R3)               GET DISPLACEMENT OF THE ENTRY   47520000
         SLL   R14,D16                  LENGTH                          47600000
         OR    R2,R14                   LENGTH                          47680000
         B     LITRPUT                  PUT OUT THIS RECORD             47760000
LITERAL3 LM    R11,R12,LATADD           GET LITERAL POOL ADDR  @OX09723 47840006
         LA    R9,41(R12,R14)           ESTIMATE LENGTH OF ENTRY        47890006
         CL    R9,SYMDIMEN+4            SEE IF ENOUGH ROOM              48080000
         BH    LITRFULL                 NOT ENOUGH                      48160000
         XC    D0(D4,R12),D0(R12)       ZERO CHAIN POINTER              48240000
         ST    R12,D0(,R1)              CHAIN POINTER                   48320000
         L     R3,D0(R2,R11)            OBJECT LENGTH OF THIS CHAIN     48400000
         AR    R15,R3                   ADD ON LENGTH OF THIS LITERAL   48480000
         ST    R3,D4(,R12)              PUT ONE INTO THE LITERAL POOL   48560000
         ST    R15,D0(R2,R11)           THE OTHER IN ADJUSTMENT TABLE   48640000
         MVC   D10(D6,R12),EESDI        SAVE LOCATION COUNTER           48720005
         TM    XPARM,XDUMMY             TEST IF IN DSECT       @OX07274 48770005
         BZ    LITERAL5                 NO, CSECT              @OX07274 48780005
         OI    D8(R12),INDSECT          RESIDES IN DSECT       @OX10361 48790005
LITERAL5 STH   R0,D8(,R12)              INDICATE LOC COUNTER   @OX07274 48800005
         AR    R12,R0                   BUMP PAST LOCATION COUNTER      48880000
         EX    R14,LITMVC               MOVE IN LITERAL SOURCE          48960000
         AR    R12,R14                  POINT PAST LITERAL SOURCE       49040000
         SLL   R14,D16                  MOVE TO HIGH ORDER BYTE         49120000
         OR    R2,R14                   INSERT IN OUTPUT RECORD         49200000
         MVI   D11(R12),JBLANK          INSERT A BLANK                  49280000
         LA    R12,D15(,R12)            ROUND TO FULLWORD BOUNDARY      49360000
         N     R12,=F'-4'               ROUND TO FULLWORD BOUNDARY      49440000
         LR    R11,R12                  SAVE CHAINPTR          @OX09723 49490006
         L     R10,LATEND               LOAD OLD PTR           @OX09723 49500006
         SR    R11,R10                  SEE IF RECORD          @OX09723 49510006
         C     R11,=F'41'               LONG ENOUGH            @OZ16488 49512000
         BNL   LITERAL6                 IF NOT LEAVE           @OX09723 49514006
         LA    R12,D4(R12)              MARGINE FOR SYMBOL TBL @OX09723 49516006
LITERAL6 ST    R12,LATADD+D4            SAVE ADDRESS OF NEXT   @OX09723,49520006
                                        POOL ENTRY             @OX09723 49570006
         LA    R12,41(,R12)             LEAVE MARGINE          @AX14216 49600006
         ST    R12,SYMDIMEN+D12         LIMIT FOR SYMBOL TABLE          49680000
LITRPUT  LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         49760000
         JPUTL FILE=(R10),BUFREQ=12     GET OUTPUT BUFFER               49840000
         STM   R2,R3,D4(R11)            PASS INDEX AND DISPLACEMENT     49920000
         MVC   D0(D5,R11),LITRCD        RECORD HEADER                   50000000
         LH    R0,LATTR                 LENGTH ATTRIBUTE                50080000
         BCTR  R0,D0                    MINUS ONE                       50160000
         STC   R0,D2(,R11)              TO RECORD                       50240000
         MVC   D3(D1,R11),SYMCOUNT+D1   SYMBOL COUNT                    50320000
         AIF   ('&DIAG' EQ 'NO').DUMP00                                 50400000
.DUMP00  B     EPILOGUE                 CLEANUP                         50720000
LITRFULL SET   STBLOFLO,ON              INDICATE SYMBOL TABLE FULL      50800000
         BAL   R9,EPILOG                CLEANUP                         50880000
         LH    R10,JOUTFILE             OUTPUT FILE ADDRESS             50960000
         LR    R11,R4                   OUTPUT RECORD POINTER           51040000
         JPUTM FILE=(R10),ADDR=(R11)    WRITE RECORD                    51120000
         B     GETNEXT                  GET NEXT                        51200000
         SPACE                                                          51280000
ENDING   NC    LATA8(D16),LATA8         LITERAL POOL EMPTY              51360000
         BZ    LTORG2                   X                               51440000
         LH    R10,FSTCSECT             ASCENDSION NUMBER               51520000
         LTR   R10,R10                  SEE IF ONE                      51600000
         BZ    ENDING0                  CAN'T DO MUCH FOR THIS GUY      51680000
         SPACE                                                          51760000
*NOTE-   THE FIRST CONTROL SECTION, IF ANY, IS RESUMED AT ITS HIGHEST * 51840000
*   ADDRESS WHEN END OF FILE IS DETECTED IN PASS 1 ASSIGNMENT MODE    * 51920000
*   AND THE LITERAL POOL IS NOT EMPTY.                                * 52000000
         GOTO  GETESD                   RESUMPTION                      52080000
         LR    R6,R10                   RESUME SECTION                  52180000
         AIF   ('&TESTRAN' NE 'YES').ENDING2                            52400000
         BAL   R9,ESDPUNCH              OUTPUT TESTRAN ITEM             52560000
.ENDING2 ANOP                                                           52640000
ENDING0  LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         52720000
         JPUTM FILE=(R10),ADDR=LOCRCD   RESUMPTION RECORD               52800000
         LM    R2,R3,ELCTR              CURRENT AND HIGHEST SAVED       52880000
         CLR   R2,R3                    SEE WHICH IS GREATER            52960000
         BNH   GRRRRRRR                 R3 IS                           53040000
         LR    R3,R2                    YOU'RE THE GREATEST             53120000
GRRRRRRR ST    R3,ELCTR                 SAVE                            53200000
         MVC   D6(D6,R11),EESDI         PASS LOCATION COUNTER TO LINO   53280000
         SPACE                                                          53360000
LTORG    BAL   R9,ALIGN1                ALIGN TO DOUBLEWORD BOUNDARY    53440000
         DC    H'-8,7'                  ALIGNMENT PARAMETERS            53520000
         GOIF  JTEOFII,EQUAL=LTORG2     SKIP IF FORCED LTORG            53600000
         ST    R3,RLCTR                 ADDRESS                         53680000
         BAL   R9,XREF                  RECORD                          53760000
         AIF   ('&TESTRAN' NE 'YES').LTORG                              53840000
         BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             53920000
.LTORG   ANOP                                                           54000000
LTORG2   SR    R2,R2                    CLEAR REGISTER                  54080000
         NC    LATA8(D16),LATA8         SEE IF CLEAN POOL               54160000
         BE    ENDING1                  SKIP IF NOT DIRTY POOL          54240000
         L     R10,LATADD               GET POINTER TO LITERAL TABLE    54320000
         LH    R14,EESDI                GET ESDID                       54400000
         LR    R15,R3                   GET LOCATION COUNTER VALUE      54480000
         LM    R0,R3,D4(R10)            GET LITERAL TABLE               54560000
         AR    R0,R15                   ADDRESS OF 4-CHAIN              54640000
         AR    R1,R0                    ADDRESS OF 2-CHAIN              54720000
         AR    R2,R1                    ADDRESS OF 1-CHAIN              54800000
         AR    R3,R2                    ADDRESS OF END-OF-LITERAL-POOL  54880000
         AIF   ('&DIAG' EQ 'NO').DUMP02                                 54960000
.DUMP02  STM   R14,R2,D0(10)            LITERAL ADJUSTMENT TABLE        55280000
         ST    R3,ELCTR                 SAVE LOCATION COUNTER           55360000
LCSAVE   MVC   LOCTRSAV,EESDI           SAVE LOCATION COUNTER AND ESDID 55440000
         SET   LITEND,ON                TO INFORM LTDUMP       @OX09723 55490006
         LM    R2,R3,=F'-8,4'           INDEX                           55520000
LTORG3   L     R5,LATA2(R2)             PASS ONE END OF A CHAIN         55600000
         BAL   R9,LTDUMP                DUMP OUT CHAIN                  55680000
         BXLE  R2,R3,LTORG3             ONE CHAIN AT A TIME             55760000
         SET   LITEND,OFF                                      @OX09723 55810006
LCRESTOR MVC   EESDI(D6),LOCTRSAV       RESTORE ESDID AND VALUE         55840000
         L     R10,LATADD               RECLAIM ADDRESS                 55920000
         LA    R2,D20                   LENGTH OF ONE LITERAL TABLE     56000000
         AR    R10,R2                   POINT TO NEXT TABLE             56080000
         LA    R11,D20(,R10)            POINT TO FRESH LITERAL POOL     56160000
         STM   R10,R11,LATADD           HERE WE GO AGAIN                56240000
         XC    LATA8(D16),LATA8         CLEAN OUT LITERAL POOL          56320000
         XC    D0(D20,R10),D0(R10)      CLEAR LITERAL TABLE             56400000
ENDING1  LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         56480000
         LA    R11,D8                   RECORD LENGTH                   56560000
         JPUTL FILE=(R10),BUFREQ=(R11)  GET BUFFER                      56640000
         MVC   D0(D6,R11),EOFRCD        RECORD HEADER                   56720000
         MVI   D4(R11),JTLTEND          RECORD TYPE                     56800000
         STH   R2,D6(,R11)              PASS INCREMENT TO PASS II       56880000
         GOIF  JTEOFII,NOTEQ=EPILOGUE   SKIP IF NOT FORCED LTORG        56960000
         L     R14,LATADD               POINT TO THE END OF TABLES      57040000
         LA    R2,ENDOFCOM              POINT TO THE BEGINNING          57120000
         SR    R14,R2                   GET THE LENGTH                  57200000
         LA    R3,LATA8                 POINT TO NEW ADDRESS OF TABLE   57280000
         LA    R4,LATA8(R14)            THE END OF NEW TABLE            57360000
         STM   R3,R4,LATADD             BEGINNING OF BOTH TABLES        57440000
         BNP   ENDOFILE                 DON'T MOVE IF NO LITERALS       57520000
ENDING2  BCTR  R14,0                    GET MOVE LENGTH                 57600000
         EX    R14,LITMVC2              MOVE LITERAL ADJUSTMENT TABLE   57680000
         SRDL  R14,D8                   EXECUTED AMOUNT TO REGISTER 15  57760000
         SRL   R15,D24                  AMOUNT MOVED                    57840000
         LA    R3,D1(R3,R15)            POINT TO NEXT SEGMENT           57920000
         LA    R2,D1(R2,R15)            POINT TO NEXT SEGMENT           58000000
         SLA   R14,D8                   AMOUNT REMAINING NOT MOVED      58080000
         BZ    ENDOFILE                 GO IF TASK COMPLETED            58160000
         B     ENDING2                  REPEAT IF NOT                   58240000
         SPACE                                                          58320000
LTDUMP   BALR  R14,R7                   SAVE REGISTERS                  58400000
LTDUMP1  LTR   R4,R5                    SEE IF AT END-OF-CHAIN          58480000
         BZ    EXIT                     FINIS IF SO                     58560000
         SR    R3,R3                    BUMP PAST LOC CNTR     @OX10361 58640005
         IC    R3,D9(,R4)               COMPUTE LENGTH TO-     @OX10361 58690005
         AR    R5,R3                    LITERAL TEXT IN REC    @OX10361 58700005
INDSECT  EQU   BIT0                     LIT DEF IN DSECT       @OX10361 58710005
         SR    R3,R3                    ZERO REGISTER                   58720000
         GOIF  MODE2,ON=LTDUMP2         SKIP IF CHAINING MODE           58800000
         SR    R2,R2                    CLEAR REGISTER                  58880000
         IC    R2,D10(,R5)              GET LITERAL SOURCE LENGTH       58960000
         LA    R2,D1(,R2)               LENGTH                          59040000
         LA    R3,D13(,R2)              LENGTH                          59120000
         LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         59200000
         JPUTL FILE=(R10),BUFREQ=(R3)   GET OUTPUT BUFFER               59280000
         STH   R3,D0(,R11)              RECORD LENGTH                   59360000
         MVC   D2(D6,R11),LOCRCD+D2     RECORD HEADER                   59440000
         EX    R2,LITMVC1               MOVE IN LITERAL SOURCE          59520000
         LR    R3,R11                   SAVE POINTER                    59600000
         MVI   TYPECALL,LTCALL+LTORGSCN PASS PARAMETERS                 59680000
         CR    R4,R5                    SEE IF LOCATION COUNTER         59760000
         BE    LTDUMP3                  NO                              59840000
         MVC   D6(D6,R11),D10(R4)       PASS LOCATION COUNTER           59920000
         B     LTDUMP3                  SKIP                            60000000
LTDUMP2  MVI   TYPECALL,LTCALL+LTORGSCN+NOESD     PASS PARAMETERS       60080000
LTDUMP3  MVC   EESDI(D6),D10(R4)        LOCATION COUNTER                60160000
         TM    D8(R4),INDSECT           TEST IF REF IN DSECT   @OX10361 60210005
         BZ    LTDUMP4                  NO                     @OX07274 60220005
         MVI   TYPECALL,LTCALL+LTORGSCN+NOESD PASS PARAM       @OX07274 60230005
LTDUMP4  LA    R5,D11(,R5)              TEXT POINTER           @OX07274 60240005
         AIF   ('&DIAG' EQ 'NO').DUMP04                                 60320000
.DUMP04  GOTO  DCSCAN                   SCAN LITERAL SOURCE ONCE MORE   60640000
         MVI   TYPECALL,D0              CLEAR PARAMETER                 60680000
         SR    R0,R0                    ZERO ZERO                       60720000
         STH   R0,SYMCOUNT              RESET SYMBOL COUNT              60800000
         GOIF  (STBLOFLO,LITEND),NOTALL=LTDUMP5 USE LIT POOL   @OX09723 60850006
         LA    R5,D20(R4)               ADD 20 FOR X4S         @OX09723 60860006
         ST    R5,SYMDIMEN+D4           NEW POINTER            @OX09723 60870006
LTDUMP5  L     R5,D0(,R4)               GET CHAIN POINTER               60880006
         LTR   R3,R3                    SEE IF LENGTH ATTRIBUTE DEFINED 60960000
         BE    LTDUMP1                  SKIP IF NOT NEEDED              61040000
         IC    R0,LATTR+D1              GET LENGTH ATTRIBUTE            61120000
         BCTR  R0,D0                    MINUS ONE                       61200000
         STC   R0,D2(,R3)               TO OUTPUT RECORD                61280000
         B     LTDUMP1                  TAKE IT FROM THE TOP            61520000
         SPACE                                                          61600000
LTORGII  L     R14,LATADD               ADJUSTMENT TABLE ADDRESS        61680000
         AH    R14,RESDI                INCREMENT                       61760000
         ST    R14,LATADD               UPDATE                          61840000
         B     TRANSFER                 FINIS                           61920000
         SPACE                                                          62000000
LITRII   LH    R10,RESDI                ADJUSTMENT INDEX                62080000
         LTR   R10,R10                  SEE IF VALID DEFINITION         62160000
         BZ    TRANSFER                 BAD LITERAL                     62240000
         L     R14,LATADD               LITERAL ADJUSTMENT TABLE        62320000
         L     R11,D0(R10,R14)          ADJUSTMENT FACTOR, POOL ADDRESS 62400000
         A     R11,RLCTR                LITERAL'S DISPLACEMENT IN CHAIN 62480000
         ST    R11,RLCTR                ADJUSTED LITERAL ADDRESS        62560000
         LH    R10,D2(,R14)             ESDID OF LITERAL POOL           62640000
         STH   R10,RESDI                ADJUSTED LITERAL ESDID          62720000
         AIF   ('&DIAG' EQ 'NO').DUMP06                                 62800000
.DUMP06  SPACE                                                          63120000
ADJUST   LH    R10,RESDI                ESDID                           63200000
         L     R11,RLCTR                OFFSET                          63280000
         LM    R14,R1,ADJINDEX          ADJUSTMENT PARAMETERS           63360000
ADJUST2  BXLE  R14,R15,TRANSFER         STEP INDEX                      63440000
         CH    R10,D0(R1,R14)           SEE IF ADJUSTMENT ENTRY         63520000
         BNE   ADJUST2                  GO AGAIN IF NOT                 63600000
         LH    R10,D2(R1,R14)           GET ADJUSTED ESDID              63680000
         STH   R10,RESDI                PASS IN RECORD                  63760000
         A     R11,D4(R1,R14)           ADD ADJUSTMENT FACTOR           63840000
         ST    R11,RLCTR                PASS IN RECORD                  63920000
         SPACE                                                          64000000
TRANSFER LH    R10,JOUTFILE             ADDRESS OF OUTPUT FILE          64080000
         LR    R11,R4                   OUTPUT RECORD ADDRESS           64320000
         JPUTM FILE=(R10),ADDR=(R11)    OUTPUT RECORD                   64400000
         B     EPILOGUE                 CHECK SYMBOL TABLE OVERFLOW     64480000
         SPACE                                                          64880000
ALIGN1   TM    JPARM2,JALGN             TEST ALIGN OPTION               64900000
         BZ    D4(,R9)                  RETURN TO MAINLINE IF OFF       64920000
ALIGN    LH    R0,D0(,R9)               GET ALIGN MASK                  64960000
         AH    R3,D2(,R9)               EXCESS FOR ALIGNMENT            65040000
         NR    R3,R0                    ROUND TO SPECIFIC BOUNDARY      65120000
         AIF   ('&TESTRAN' NE 'YES').ALIGN                              65200000
         LR    R0,R3                    GET NEW LOCATION COUNTER        65280000
         S     R0,ELCTR                 GET NUMBER OF BYTES SKIPPED     65360000
         MVC   ADDRESS,ELCTR+D1         ADDRESS                         65440000
         ST    R3,ELCTR                 UPDATE CURRENT LOCATION COUNTER 65520000
         LA    R9,D4(,R9)               PASS RETURN ADDRESS             65600000
         BER   R9                       NO BYTES SKIPPED                65680000
         SET   TSPACE                   ORGINIZATION BYTE               65760000
         STC   R0,NAME                  LENGTH, NUMBER OF BYTES SKIPPED 65840000
         LA    R10,D5                   LENGTH OF SPACE RECORD          65920000
         B     SYMPUNCH                 PUT OUTPUT ONTO 'SYM' CARD      66000000
         AGO   .ALIGN1                                                  66080000
.ALIGN   ST    R3,ELCTR                 UPDATE CURRENT LOCATION COUNTER 66160000
         B     D4(,R9)                  RETURN TO MAINLINE              66240000
.ALIGN1  SPACE                                                          66320000
XREF     LA    R1,D1                    ASSUME LENGTH ATTRIBUTE IS ONE  66400000
XREF1    GOIF  RFIELDN,OFF=(R9)         BUG OUT IF NOT NAMED            66480000
         STH   R1,RLNGQ                 PASS LENGTH ATTRIBUTE           66560000
         BALR  R14,R7                   PUSH REGISTERS                  66640000
         GOIF  PRIORDEF,ON=WRITE3       CHECK IF PREVIOUSLY DEFINED     66720000
         LR    R10,R4                   PASS RECORD POINTER             66800000
         GOTO  ENTER                    ENTER IN SYMBOL TABLE           66880000
         BE    WRITE3                   ENTERED SUCCESSFULLY            66960000
         SET   PRIORDEF,ON              INDICATE SYMBOL ALREADY DEFINED 67040000
         B     WRITE3                   SNEAK IN THE BACK DOOR          67120000
         AIF   ('&TESTRAN' NE 'YES').WRITE                              67200000
XREF3    BAL   R9,MISPUNCH              OUTPUT TESTRAN ITEM             67280000
.WRITE   SPACE                                                          67360000
WRITE    LA    R9,EPILOGUE              DEFINE EXIT                     67520000
WRITE1   GOIF  RFIELDN,OFF=(R9)         GIVE UP IF NOT NAMED            67600000
WRITE2   BALR  R14,R7                   PUSH REGISTERS                  67680000
WRITE3   LA    R2,D24                   CROSS-REFERENCE RECORD LENGTH   67760000
         GOIF  RFIELDN,ON=RECL22        TEST IF NAME IS PRESENT         67810000
         LA    R2,D12                   RECORD LENGTH WITHOUT NAME      67820000
RECL22   LH    R10,JOUTFILE                                             67840000
         LR    R11,R2                                                   67920000
         JPUTL FILE=(R10),BUFREQ=(R11)                                  68000000
         SH    R2,=AL2(D3)              GET MOVE LENGTH                 68050000
         EX    R2,MOVEREC               MOVE RECORD TO OUTPUT FILE      68060000
         STH   R2,D0(,R11)                                              68160000
         MVI   JTIOP1-JTRLI(R11),JTADJII                                68240000
         B     EXIT                     RETURN                          68480000
MOVEREC  MVC   D2(,R11),D2(R4)          MOVE RECORD TO OUTPUT FILE      68530000
         SPACE                                                          68560000
EPILOGUE BAL   R9,EPILOG                CLEANUP ROUTINE                 68640000
         B     GETNEXT                  CONTINUE                        68720000
EPILOG   BALR  R14,R7                   SAVE REGISTERS                  68800000
         GOIF  STBLOFLO,OFF=GET         IS SYMBOL TABLE FULL            68880000
         GOIF  MODE1,ON=GET                                             68920000
         GOIF  MODE2,ON=GET             CHECK IF 1S MODE                68940000
         SET   MODE2,ON                 CHANGE MODE                     68960000
         LM    R2,R3,=F'-8,4'           LOAD UP WITH INDEX              69040000
         EX    R0,LCSAVE                SAVE LOCATION COUNTER           69120000
EPILOOP  L     R5,LATA2(R2)             GET ONE END OF CHAIN            69200000
         BAL   R9,LTDUMP                DUMP OUT THE SYMBOLS            69280000
         BXLE  R2,R3,EPILOOP            DO IT TO ALL FOUR CHAINS        69360000
         EX    R0,LCRESTOR              RESTORE LOCATION COUNTER        69440000
         LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         69520000
         JPUTM FILE=(R10),ADDR=EOFRCD   PUT OUT AN END-OF-FILE RECORD   69600000
GET      GOIF  INOTE,OFF=EXIT                                           69680000
         SET   INOTE,OFF                RESET CONDITION                 69760000
         LH    R10,JINFILE              GET INPUT FILE ADDRESS          69840000
         JPOINT  FILE=(R10),ADDR=INOTEVAL,NEXT=GET                      69920000
         B     EXIT                     FINIS                           70000000
         SPACE                                                          70080000
MAKESD   GOTO  MAKESD                   GO TO MAKE ESD                  70160000
         B     GETNEXT                                                  70240000
         SPACE                                                          70320000
ENDOFILE LH    R10,JOUTFILE             GET OUTPUT FILE ADDRESS         70400000
         LA    R11,EOFRCD               POINT TO END-OF-FILE            70480000
         JPUTM FILE=(R10),ADDR=(R11)    WRITE ONE LAST RECORD           70560000
BUGOUT   LH    R10,JOUTFILE             GET FILE ADDRESS                70640000
         JPOINT  FILE=(R10),NEXT=START  POINT TO BEGINNING OF FILE      70720000
         LH    R10,JINFILE              GET ADDRESS OF CURRENT INPUT    70800000
         MVC   JINFILE,JOUTFILE         OLD OUTPUT FILE BECOMES INPUT   70880000
         STH   R10,JOUTFILE             OLD INPUT FILE BECOMES OUTPUT   70960000
         JPOINT  FILE=(R10),NEXT=START  POINT TO BEGINNING OF OUTPUT    71040000
         AIF   ('&DIAG' EQ 'NO').DUMP08                                 71120000
.DUMP08  SET   (MODE1,MODE2),FLIP       CHANGY, CHANGY                  71920000
         GOIF  (MODE1,MODE2),MIX=GETNEXT,ALL=MAKESD                     72000000
         LR    R10,R7                   POINT TO COMMON                 72080000
         JFRECORE  ADDR=(R10)           FREE IT UP                      72160000
         B     III                      PHASE EXIT                      72240000
         AIF   ('&TESTRAN' EQ 'NO').TEST80                              72320000
         EJECT                                                          72400000
*TITLE-  ESDPUNCH                                                     * 72480000
*                                                                     * 72560000
*FUNCTION/OPERATION-                                                  * 72640000
*        FORMAT TESTRAN ITEMS FOR ROUTINE 'SYMPUNCH'.                 * 72720000
*                                                                     * 72800000
*INPUT-  REGISTER R6 POINTS TO AN ESD CONTROL SECTION ENTRY.          * 72880000
*                                                                     * 72960000
*OUTPUT- TESTRAN ITEMS IN STORAGE FOR ROUTINE 'SYMPUNCH'.             * 73040000
*                                                                     * 73120000
         SPACE                                                          73200000
MISPUNCH SET   TMIS                     ORGANIZATION BYTE               73280000
MOPPUNCH GOIF  (RFIELDN,PRIORDEF)       TEST                            73360000
         BNMR  R9                       RETURN                          73440000
ANYPUNCH LA    R10,D4                   LENGTH OF ITEM ASSUMED          73520000
         MVC   ADDRESS,RLCTR+D1         ADDRESS                         73600000
         GOIF  RFIELDN,OFF=SYMPUNCH     FINISHED IF NO NAME             73680000
         MVC   NAME,RNAME               MOVE NAME                       73760000
         IC    R10,RFLDI                GET NAME LENGTH BITS            73840000
         N     R10,=F'7'                KEEP LENGTH BITS ONLY           73920000
         LA    R10,D5(,R10)             LENGTH OF ITEM CONFIRMED        74000000
         B     STORELNG                 CONTINUE                        74080000
ESDPUNCH CLC   XSSAV,EESDI              SEE IF ACTUAL                   74110000
         BER   R9                       YEAH                            74140000
         MVC   XSSAV,EESDI              SAVE                            74170000
         LA    R10,D4                   LENGTH                          74200000
         MVC   ORGBYTE,ETYPE            ORGINIZATION BYTE               74240000
         TR    ORGBYTE,=AL1(TCSECT,0,0,0,TCSECT,TCOM,0,0,TDSECT)        74320000
         XC    ADDRESS,ADDRESS          ADDRESS                         74400000
         CLI   ENAME,JA                 SEE IF NAMED                    74480000
         BL    SYMPUNCH                 NAMELESS                        74560000
         MVC   NAME,ENAME               MOVE IN NAME                    74640000
         LA    R10,EITEM+D13            POINT TO LAST CHARACTER         74720000
LOOPLOOP BCTR  R10,0                    LOOK AT NEXT CHARACTER          74800000
         CLI   ENAME-EITEM-D5(R10),JBLANK    SEE IF PADDED              74880000
         BE    LOOPLOOP                 LOOP ON FALSIES                 74960000
         SR    R10,R6                   FIND THE LENGTH OF THE NAME     75040000
STORELNG LA    R1,BIT4-D5(,R10)         RIG MASK                        75120000
         EX    R1,SOKITUMI              INDICATE NAME PRESENT           75200000
         TR    NAME,JTRTABLE            TRANSLATE NAME                  75280000
         SPACE                                                          75360000
SYMPUNCH STM   R9,R1,TERMS              SAVE REGISTERS                  75440000
         GOTO  SYMPUNCH                 GO TO OUTPUT ROUTINE            75520000
         LM    R9,R1,TERMS              RESTORE REGOSTERS               75600000
         BR    R9                       RETURN                          75680000
         SPACE                                                          75760000
SOKITUMI XI    ORGBYTE,D0               EXECUTED INSTRUCTION            75840000
.TEST80  SPACE                                                          75920000
         DS    0F                                                       76000000
CSTPARM  DC    AL1(ESDNRSW+CSECTSW+DSECTSW+XENTRY,ETYPEPC,ETYPESD,0)    76080000
DSTPARM  DC    AL1(ESDNRSW+DSCOMSW+DSECTSW+XDUMMY,ETYPEDS,ETYPEDS,CSW)  76160000
COMPARM  DC    AL1(ESDNRSW+DSCOMSW+CSECTSW,ETYPECM,ETYPECM,CSW)         76240000
DXDPARM  DC    AL1(ESDNRSW+DSCOMSW+DSECTSW,ETYPEXD,ETYPEXD,DSW)         76320000
EOFRCD   DC    H'8',AL1(JPSOP,0,JTEOFII,0)   END-OF-FILE RECORD         76400000
LOCRCD   DC    HL2'12',AL1(JPSOP,0,JTADJII,0),HL2'0'   LITERAL DC       76480000
LITRCD   DC    HL2'12',AL1(JPSOP,0,JTLITII,0)     LITERAL RECORD HEADER 76560000
INDEX    DC    AL1(4,16,12,16,8,16,12,16)    LITERAL HASH INDEX         76640000
TMINST   TM    D0(R15),D0               EXECUTED INSTRUCTION            76720000
LITCLC   CLC   D10(D0,R3),CHAR1         EXECUTED INSTRUCTION            76800000
LITMVC   MVC   D10(D0,R12),CHAR1        EXECUTED INSTRUCTION            76880000
LITMVC1  MVC   D12(D0,R11),D10(R5)      EXECUTED INSTRUCTION            76960000
LITMVC2  MVC   D0(D0,R3),D0(R2)         EXECUTED INSTRUCTION            77040000
         SPACE                                                          77120000
RADIX    DC    A(IA,IS,IIS,IIA)         MODES                           77200000
IA       EQU   *-2*JTPREP               PASS 1 ASSIGNMENT MODE          77520000
         ORG   IA+2*JTPREP              TABLE INDEX                     77600000
         DC    Y(IA-REPRO)              ROUTINE VECTOR                  77680000
         ORG   IA+2*JTPPCH              TABLE INDEX                     77760000
         DC    Y(IA-PUNCH)              ROUTINE VECTOR                  77840000
         ORG   IA+2*JTINPC              TABLE INDEX                     77920000
         DC    Y(IA-INPC)               ROUTINE VECTOR                  78000000
         ORG   IA+2*JTPMOP              TABLE INDEX                     78080000
         DC    Y(IA-MACHOP)             ROUTINE VECTOR                  78160000
         ORG   IA+2*JTEND               TABLE INDEX                     78240000
         DC    Y(IA-GETNEXT)            ROUTINE VECTOR                  78320000
         ORG   IA+2*JTDXD               TABLE INDEX                     78400000
         DC    Y(IA-DXD)                ROUTINE VECTOR                  78480000
         ORG   IA+2*JTEQU               TABLE INDEX                     78560000
         DC    Y(IA-EQU)                ROUTINE VECTOR                  78640000
         ORG   IA+2*JTORG               TABLE INDEX                     78720000
         DC    Y(IA-ORG)                ROUTINE VECTOR                  78800000
         ORG   IA+2*JTCNOP              TABLE INDEX                     78880000
         DC    Y(IA-CNOP)               ROUTINE VECTOR                  78960000
         ORG   IA+2*JTCCW               TABLE INDEX                     79040000
         DC    Y(IA-CCW)                ROUTINE VECTOR                  79120000
         ORG   IA+2*JTDC                TABLE INDEX                     79200000
         DC    Y(IA-DC)                 ROUTINE VECTOR                  79280000
         ORG   IA+2*JTDS                TABLE INDEX                     79360000
         DC    Y(IA-DS)                 ROUTINE VECTOR                  79440000
         ORG   IA+2*JTSTART             TABLE INDEX                     79520000
         DC    Y(IA-START)              ROUTINE VECTOR                  79600000
         ORG   IA+2*JTCSECT             TABLE INDEX                     79680000
         DC    Y(IA-CSECT)              ROUTINE VECTOR                  79760000
         ORG   IA+2*JTDSECT             TABLE INDEX                     79840000
         DC    Y(IA-DSECT)              ROUTINE VECTOR                  79920000
         ORG   IA+2*JTCOM               TABLE INDEX                     80000000
         DC    Y(IA-COM)                ROUTINE VECTOR                  80080000
         ORG   IA+2*JTENTRY             TABLE INDEX                     80160000
         DC    Y(IA-ENTRY)              ROUTINE VECTOR                  80240000
         ORG   IA+2*JTEXTRN             TABLE INDEX                     80320000
         DC    Y(IA-EXTRN)              ROUTINE VECTOR                  80400000
         ORG   IA+2*JTWXTRN             TABLE INDEX                     80480000
         DC    Y(IA-WXTRN)              ROUTINE VECTOR                  80560000
         ORG   IA+2*JTCXD               TABLE INDEX                     80640000
         DC    Y(IA-CXD)                ROUTINE VECTOR                  80720000
         ORG   IA+2*JTLTORG             TABLE INDEX                     80800000
         DC    Y(IA-LTORG)              ROUTINE VECTOR                  80880000
         ORG   IA+2*JTLITR              TABLE INDEX                     80960000
         DC    Y(IA-LITERAL)            ROUTINE VECTOR                  81040000
         ORG   IA+2*JTSYMBL             TABLE INDEX                     81120000
         DC    Y(IA-SYMBL)              ROUTINE VECTOR                  81200000
         ORG   IA+2*JTEOFII             TABLE INDEX                     81760000
         DC    Y(IA-ENDING)             ROUTINE VECTOR                  81840000
         ORG   IA+2*JTADJII             TABLE INDEX                     81890000
         DC    Y(IA-TRANSFER)           ROUTINE VECTOR                  81940000
         ORG   IA+2*JTPASS              TABLE INDEX                     81990000
         DC    Y(IA-TRANSFER)           ROUTINE VECTOR                  82040000
         ORG   ,                        END-OF-TABLE                    82080000
IS       EQU   *-2*JTPMOP               PASS 1 SUBSTITUTION MODE        82160000
         ORG   IS+2*JTPMOP              TABLE INDEX                     82720000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  82800000
         ORG   IS+2*JTEND               TABLE INDEX                     82880000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  82960000
         ORG   IS+2*JTDXD               TABLE INDEX                     83040000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83120000
         ORG   IS+2*JTEQU               TABLE INDEX                     83200000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83280000
         ORG   IS+2*JTORG               TABLE INDEX                     83360000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83440000
         ORG   IS+2*JTCNOP              TABLE INDEX                     83520000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83600000
         ORG   IS+2*JTCCW               TABLE INDEX                     83680000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83760000
         ORG   IS+2*JTDC                TABLE INDEX                     83840000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  83920000
         ORG   IS+2*JTDS                TABLE INDEX                     84000000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84080000
         ORG   IS+2*JTSTART             TABLE INDEX                     84160000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84240000
         ORG   IS+2*JTCSECT             TABLE INDEX                     84320000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84400000
         ORG   IS+2*JTDSECT             TABLE INDEX                     84480000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84560000
         ORG   IS+2*JTCOM               TABLE INDEX                     84640000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  84720000
         ORG   IS+2*JTENTRY             TABLE INDEX                     84800000
         DC    Y(IS-ENTRY)              ROUTINE VECTOR                  84880000
         ORG   IS+2*JTEXTRN             TABLE INDEX                     84960000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85040000
         ORG   IS+2*JTWXTRN             TABLE INDEX                     85120000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85200000
         ORG   IS+2*JTCXD               TABLE INDEX                     85280000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85360000
         ORG   IS+2*JTLTORG             TABLE INDEX                     85440000
         DC    Y(IS-SEARCH)             ROUTINE VECTOR                  85520000
         ORG   IS+2*JTLITR              TABLE INDEX                     85600000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  85680000
         ORG   IS+2*JTSYMBL             TABLE INDEX                     85760000
         DC    Y(IS-SYMBL)              ROUTINE VECTOR                  85840000
         ORG   IS+2*JTEOFII             TABLE INDEX                     86400000
         DC    Y(IS-ENDOFILE)           ROUTINE VECTOR                  86480000
         ORG   IS+2*JTADJII             TABLE INDEX                     86530000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  86580000
         ORG   IS+2*JTPASS              TABLE INDEX                     86630000
         DC    Y(IS-TRANSFER)           ROUTINE VECTOR                  86680000
         ORG   ,                        END-OF-TABLE                    86720000
IIS      EQU   *-2*JTSYMBL              PASS 2 SUBSTITUTION MODE        86800000
         ORG   IIS+2*JTSYMBL            TABLE INDEX                     86880000
         DC    Y(IIS-SYMBOL)            ROUTINE VECTOR                  86960000
         ORG   IIS+2*JTEOFII            TABLE INDEX                     87010000
         DC    Y(IIS-EOFIIS)            ROUTINE VECTOR                  87020000
         ORG   IIS+2*JTLITII            TABLE INDEX                     87200000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87280000
         ORG   IIS+2*JTLTEND            TABLE INDEX                     87360000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87440000
         ORG   IIS+2*JTADJII            TABLE INDEX                     87490000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87500000
         ORG   IIS+2*JTPASS             TABLE INDEX                     87680000
         DC    Y(IIS-TRANSFER)          ROUTINE VECTOR                  87760000
         ORG   IIS+2*JTSYMII            TABLE INDEX                     87840000
         DC    Y(IIS-REHASH)            ROUTINE VECTOR                  87920000
         ORG   ,                        END-OF-TABLE                    88000000
IIA      EQU   *-2*JTSYMBL              PASS 2 ADJUSTMENT MODE          88080000
         ORG   IIA+2*JTSYMBL            TABLE INDEX                     88160000
         DC    Y(IIA-SYMBOL)            ROUTINE VECTOR                  88240000
         ORG   IIA+2*JTEOFII            TABLE INDEX                     88290000
         DC    Y(IIA-BUGOUT)            ROUTINE VECTOR                  88300000
         ORG   IIA+2*JTLITII            TABLE INDEX                     88480000
         DC    Y(IIA-LITRII)            ROUTINE VECTOR                  88560000
         ORG   IIA+2*JTLTEND            TABLE INDEX                     88640000
         DC    Y(IIA-LTORGII)           ROUTINE VECTOR                  88720000
         ORG   IIA+2*JTADJII            TABLE INDEX                     88770000
         DC    Y(IIA-ADJUST)            ROUTINE VECTOR                  88780000
         ORG   IIA+2*JTPASS             TABLE INDEX                     88960000
         DC    Y(IIA-TRANSFER)          ROUTINE VECTOR                  89040000
         ORG   ,                        END-OF-TABLE                    89120000
         SPACE                                                          89200000
         MEND                                                           89280000
